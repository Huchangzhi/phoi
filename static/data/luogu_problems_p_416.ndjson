{"pid": "P9438", "type": "P", "difficulty": 5, "samples": [["2 3 3 1 0 0\n1\n2", "8"], ["2 3 3 1 0 0\n3\n3 5 7", "4 0 0"], ["7 3 0 0\n3\n49 1 343", "1 0 1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "洛谷月赛"], "title": "『XYGOI round1』好多数", "background": "小 X 在和小 L 一起玩。他们走到了公园，发现了一棵长得很奇怪的参天大树。这棵树，按照 OIer 们的习惯，它有一个明显特征，那就是**严重右偏**。", "description": "小 X 想到了另外一个东西，也是严重右偏的。\n\n首先，他写下一个数字 $n$。  \n\n接着，对于所有 $n$ 的因数 $x\\notin\\{1,n\\}$，让 $x$ 从小到大的成为 $n$ 的儿子节点。 \n\n递归的建这棵树，这棵树就建成了。小 X 把这棵树称为一个“$n$ 号数学树”。小 X 想知道，给定 $q$ 个正整数 $x$，它在 $n$ 号数学树出现了几次。  \n\n因为 $n$ 很大，他只能告诉你 $n$ 的质因数分解。  \n\n答案对 $998244353$ 取模。", "inputFormat": "第一行若干对整数 $(a_i,b_i)$，表示 $n=\\prod a_i^{b_i}$，以 `0 0` 结尾。题目保证，$a_i$ 是质数，$b_i\\in N^*$。\n\n第二行一个整数，表示 $q$，含义如题面所示。  \n\n第三行 $q$ 个整数，代表这组数据的 $q$ 次询问。", "outputFormat": "输出一行 $q$ 个整数，表示每个询问的答案对 $998244353$ 取模的结果。", "hint": "样例解释：前两组数据均为 $24$ 号数学树。这棵树绘制以后如下：\n![](https://cdn.luogu.com.cn/upload/image_hosting/ejrhdnv3.png)   \n\n其中，$2$ 出现了 $8$ 次，$3$ 出现了 $4$ 次，$5,7$ 则没有出现过。  \n\n对于第三组数据，你需要注意 $343$ 在 $343$ 号数学树的树根出现了一次，$1$ 不会在数学树中出现。  \n\n| Subtask | $n$ | $q$ | 保证 $n$ 是质数的幂 | 分值 |\n|:-:|:-:|:-:|:-:|:-:|\n|0|$\\le 10^3$|$\\le 20$|Yes|10|\n|1|$\\le 10^6$|$\\le 20$|No|10|\n|2|$\\sum b_i\\le5000$|$\\le 20$|Yes|40|\n|3|$\\sum b_i\\le5000$|$\\le 20$|No|40| \n\n对于 $100\\%$ 的数据，$1\\le b_i \\le 5000$，$\\sum b_i\\le5000$，$2\\le a_i\\le 10^9$，$1\\le x\\le 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『XYGOI round1』好多数", "background": "小 X 在和小 L 一起玩。他们走到了公园，发现了一棵长得很奇怪的参天大树。这棵树，按照 OIer 们的习惯，它有一个明显特征，那就是**严重右偏**。", "description": "小 X 想到了另外一个东西，也是严重右偏的。\n\n首先，他写下一个数字 $n$。  \n\n接着，对于所有 $n$ 的因数 $x\\notin\\{1,n\\}$，让 $x$ 从小到大的成为 $n$ 的儿子节点。 \n\n递归的建这棵树，这棵树就建成了。小 X 把这棵树称为一个“$n$ 号数学树”。小 X 想知道，给定 $q$ 个正整数 $x$，它在 $n$ 号数学树出现了几次。  \n\n因为 $n$ 很大，他只能告诉你 $n$ 的质因数分解。  \n\n答案对 $998244353$ 取模。", "inputFormat": "第一行若干对整数 $(a_i,b_i)$，表示 $n=\\prod a_i^{b_i}$，以 `0 0` 结尾。题目保证，$a_i$ 是质数，$b_i\\in N^*$。\n\n第二行一个整数，表示 $q$，含义如题面所示。  \n\n第三行 $q$ 个整数，代表这组数据的 $q$ 次询问。", "outputFormat": "输出一行 $q$ 个整数，表示每个询问的答案对 $998244353$ 取模的结果。", "hint": "样例解释：前两组数据均为 $24$ 号数学树。这棵树绘制以后如下：\n![](https://cdn.luogu.com.cn/upload/image_hosting/ejrhdnv3.png)   \n\n其中，$2$ 出现了 $8$ 次，$3$ 出现了 $4$ 次，$5,7$ 则没有出现过。  \n\n对于第三组数据，你需要注意 $343$ 在 $343$ 号数学树的树根出现了一次，$1$ 不会在数学树中出现。  \n\n| Subtask | $n$ | $q$ | 保证 $n$ 是质数的幂 | 分值 |\n|:-:|:-:|:-:|:-:|:-:|\n|0|$\\le 10^3$|$\\le 20$|Yes|10|\n|1|$\\le 10^6$|$\\le 20$|No|10|\n|2|$\\sum b_i\\le5000$|$\\le 20$|Yes|40|\n|3|$\\sum b_i\\le5000$|$\\le 20$|No|40| \n\n对于 $100\\%$ 的数据，$1\\le b_i \\le 5000$，$\\sum b_i\\le5000$，$2\\le a_i\\le 10^9$，$1\\le x\\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P9439", "type": "P", "difficulty": 5, "samples": [["6 6 3\n1 1 3 3 1 1 3 2 2\n0 2 6 3 1 1 3 2 2 6 4 5 3 4 2\n1 -1 4 1 3 2 4 3 5 4 6\n", "..#...\n.#.#..\n#.#.#.\n.#.#.#\n..#.#.\n...#..\n\n..#...\n.#.#..\n#.#.#.\n.#.#.#\n..#.#.\n...#..\n"], ["5 4 2\n1 0 6 1 1 4 1 2 2 5 2 2 3 3 4\n0 -1 7 1 1 4 1 5 2 2 3 3 4 4 4 5 4\n", "#..#.\n.#..#\n.#...\n..###\n\n##.##\n.##.#\n.###.\n..###\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "ICPC", "WF"], "title": "[ICPC 2021 WF] Crystal Crosswind", "background": "", "description": "You are part of a scientific team developing a new technique to image crystal structures at the molecular level. The technique involves blowing a very fine wind over the surface of the crystal at various angles to detect boundaries (indicated by molecules that are exposed to the wind). This is repeated with different wind directions and the boundaries observed for each direction are recorded. Your team has already collected the data, but – as is often the case with applied science – now the real work, analysis, must begin.\n\nFor a given crystal, you will receive the directions in which wind blew over the surface, and the locations of all boundaries encountered by each of these winds. For a wind blowing in direction ($w_x, w_y$), a boundary is defined as a location ($x, y$) such that a molecule exists at ($x, y$) and no molecule exists at ($x-w_x, y-w_y$). Note that for technical reasons $w_x$ and $w_y$ are not necessarily relatively prime.\n\nThe data might not uniquely determine the structure of the crystal. You must find the two unique structures with the minimal and maximal number of molecules consistent with the observations.\n\nFor example, in the first sample input, nine different molecules are directly encountered by the given winds. There must be a molecule at location ($3, 3$) because otherwise ($4, 2$) would be a boundary for the third wind. For similar reasons, there must be molecules at ($4, 4$) and ($5, 5$). There cannot be any further molecules as they would result in additional observations for some of the winds.", "inputFormat": "The first line of input contains three integers $d_x$, $d_y$, and $k$, where $d_x$ and $d_y$ ($1 \\leq d_x, d_y \\leq 10^3$) are the maximum dimensions of the crystal structure, and $k (1 \\leq k \\leq 10)$ is the number of times wind was blown over the crystal.\n\nEach of the remaining $k$ lines specifies the data for one wind. These lines each start with two integers $w_x$ and $w_y$ ($-d_x \\leq w_x \\leq d_x$ and $-d_y \\leq w_y \\leq d_y$, but not both zero) denoting the direction of the wind. Then comes an integer $b$ ($0 \\leq b \\leq 10^5$) giving the number of boundaries encountered by this wind. The line finishes with $b$ distinct pairs of integers $x,y$ ($1 \\leq x \\leq d_x$ and $1 \\leq y \\leq d_y$) listing each observed boundary.\n\nYou may assume the input is consistent with at least one crystal and that no molecules exist outside the specified dimensions.", "outputFormat": "Output two textual representations of the crystal structure separated by an empty line. Each structure has $d_y$ rows of $d_x$ characters, with the top-left corner corresponding to location ($1, 1$). The first is the structure with the minimal number of molecules consistent with the observations, the second is the maximal one. Use '#' for a location where a molecule exists and '.' for a location where no molecule exists.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Crystal Crosswind", "background": "", "description": "You are part of a scientific team developing a new technique to image crystal structures at the molecular level. The technique involves blowing a very fine wind over the surface of the crystal at various angles to detect boundaries (indicated by molecules that are exposed to the wind). This is repeated with different wind directions and the boundaries observed for each direction are recorded. Your team has already collected the data, but – as is often the case with applied science – now the real work, analysis, must begin.\n\nFor a given crystal, you will receive the directions in which wind blew over the surface, and the locations of all boundaries encountered by each of these winds. For a wind blowing in direction ($w_x, w_y$), a boundary is defined as a location ($x, y$) such that a molecule exists at ($x, y$) and no molecule exists at ($x-w_x, y-w_y$). Note that for technical reasons $w_x$ and $w_y$ are not necessarily relatively prime.\n\nThe data might not uniquely determine the structure of the crystal. You must find the two unique structures with the minimal and maximal number of molecules consistent with the observations.\n\nFor example, in the first sample input, nine different molecules are directly encountered by the given winds. There must be a molecule at location ($3, 3$) because otherwise ($4, 2$) would be a boundary for the third wind. For similar reasons, there must be molecules at ($4, 4$) and ($5, 5$). There cannot be any further molecules as they would result in additional observations for some of the winds.", "inputFormat": "The first line of input contains three integers $d_x$, $d_y$, and $k$, where $d_x$ and $d_y$ ($1 \\leq d_x, d_y \\leq 10^3$) are the maximum dimensions of the crystal structure, and $k (1 \\leq k \\leq 10)$ is the number of times wind was blown over the crystal.\n\nEach of the remaining $k$ lines specifies the data for one wind. These lines each start with two integers $w_x$ and $w_y$ ($-d_x \\leq w_x \\leq d_x$ and $-d_y \\leq w_y \\leq d_y$, but not both zero) denoting the direction of the wind. Then comes an integer $b$ ($0 \\leq b \\leq 10^5$) giving the number of boundaries encountered by this wind. The line finishes with $b$ distinct pairs of integers $x,y$ ($1 \\leq x \\leq d_x$ and $1 \\leq y \\leq d_y$) listing each observed boundary.\n\nYou may assume the input is consistent with at least one crystal and that no molecules exist outside the specified dimensions.", "outputFormat": "Output two textual representations of the crystal structure separated by an empty line. Each structure has $d_y$ rows of $d_x$ characters, with the top-left corner corresponding to location ($1, 1$). The first is the structure with the minimal number of molecules consistent with the observations, the second is the maximal one. Use '#' for a location where a molecule exists and '.' for a location where no molecule exists.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Crystal Crosswind", "background": "", "description": "你是一个科学团队中的一员，正在开发一种在分子级别上成像晶体结构的新技术。这种技术涉及在晶体表面吹送一股非常微弱的风，并以不同的角度吹送，以便检测边界（通过暴露给风的分子来表示）。这个过程会重复进行，每个吹送方向的边界都会被记录下来。你的团队已经收集到了数据，但是如同大多数应用科学一样，现在真正的工作，即分析工作必须开始。\n\n对于给定的晶体，你将接收到风以不同方向吹送过晶体表面的数据，以及每个风吹过时遇到的所有边界的位置。对于在方向（$w_x, w_y$）吹送的风，边界被定义为位置（$x, y$），使得一个分子位于（$x, y$），并且没有分子位于（$x-w_x, y-w_y$）。请注意，出于技术原因，$w_x$ 和 $w_y$ 不一定互质。\n\n这些数据可能无法唯一确定晶体的结构。你必须找到两个与观测数据一致且分子数最少和最多的晶体结构。\n\n例如，在第一个示例输入中，通过给定的风，出现了9个不同的分子。必须有一个在位置（$3, 3$）处的分子，否则（$4, 2$）将成为第三股风的边界。出于类似的原因，必须在位置（$4, 4$）和（$5, 5$）处有分子。不能再有其他分子，因为它们会导致一些风的附加观测结果。", "inputFormat": "输入的第一行包含三个整数 $d_x$、$d_y$ 和 $k$，其中 $d_x$ 和 $d_y$（$1 \\leq d_x, d_y \\leq 10^3$）是晶体结构的最大尺寸，$k$（$1 \\leq k \\leq 10$）是风吹过晶体的次数。\n\n接下来的 $k$ 行中，每一行都描述了一次吹风的数据。第一对整数 $w_x$ 和 $w_y$（$-d_x \\leq w_x \\leq d_x$，$-d_y \\leq w_y \\leq d_y$，但不能同时为零）表示风的方向。然后是一个整数 $b$（$0 \\leq b \\leq 10^5$），表示这股风遇到的边界数量。接下来的 $b$ 对不同的整数 $x$、$y$（$1 \\leq x \\leq d_x$，$1 \\leq y \\leq d_y$）表示每个观测到的边界。\n\n你可以假设输入数据与至少一个晶体是一致的，并且没有分子存在于指定尺寸范围之外。", "outputFormat": "输出两个晶体结构的文本表示，两个结构之间用一个空行分隔。每个结构有 $d_y$ 行，每行有 $d_x$ 个字符，左上角对应位置（$1, 1$）。第一个结构是与观测结果一致的包含最少分子数量的结构，第二个结构是包含最多分子数量的结构。使用 '#' 表示分子存在的位置，使用 '.' 表示分子不存在的位置。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9440", "type": "P", "difficulty": 6, "samples": [["5 4\n1 2 3\n1 3 1\n3 4 4\n3 5 2\n1 2 4\n1 4 2\n5 2 1\n4 3 1\n", "15\n17\nimpossible\n12\n"], ["7 4\n1 2 1\n1 3 1\n1 4 1\n1 5 1\n1 6 1\n1 7 1\n1 2 3\n5 4 1\n3 1 4\n2 4 5\n", "11\nimpossible\n10\n10\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "ICPC", "WF"], "title": "[ICPC 2021 WF] Dungeon Crawler", "background": "", "description": "Alice and Bob are in charge of testing a new escape room! In this escape room, customers are trapped in a dungeon and have to explore the entire area. The dungeon consists of $n$ rooms connected by exactly $n-1$ corridors. It is possible to travel between any pair of rooms using these corridors.\n\nTwo of the dungeon rooms are special. One of these rooms contains a protective idol known as the \"helix key´´. A different room contains a nasty \"dome trap´´, which prevents the player from moving once activated. Entering the room with the trap before acquiring the key will result in the player being trapped in the dungeon forever. The player cannot start in the same room as the key or the trap.\n\nThere are $q$ different scenarios that Alice and Bob wish to examine. In the $i^{th}$ scenario, the player starts in room $s_i$, the key is in room $k_i$, and the trap is in room $t_i$. For each scenario, compute the minimum amount of time needed to explore the entire dungeon without getting trapped.", "inputFormat": "The first line of input contains two integers $n$ and $q$, where $n$ ($3 \\leq n \\leq 2000$) is the number of rooms and $q$ ($1 \\leq q \\leq 200000$) is the number of scenarios to consider. Rooms are numbered from $1$ to $n$. The next $n-1$ lines each contain three integers $u$, $v$, and $w$ indicating that there is a corridor between rooms $u$ and $v$ ($1 \\leq u, v \\leq n, u \\neq v$) that takes time $w$ ($1 \\leq w \\leq 10^9$) to traverse.\n\nThen follow $q$ lines: the $i^{th}$ of these lines contains three distinct integers $s_i$, $k_i$, and $t_i$ ($1 \\leq s_i, k_i, t_i \\leq n$) indicating the room where the player starts, the room with the key, and the room with the trap, respectively.", "outputFormat": "For each scenario, output the minimum amount of time needed to visit every room at least once. If it is impossible to visit every room at least once, output $\\texttt{impossible}$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Dungeon Crawler", "background": "", "description": "Alice and Bob are in charge of testing a new escape room! In this escape room, customers are trapped in a dungeon and have to explore the entire area. The dungeon consists of $n$ rooms connected by exactly $n-1$ corridors. It is possible to travel between any pair of rooms using these corridors.\n\nTwo of the dungeon rooms are special. One of these rooms contains a protective idol known as the \"helix key´´. A different room contains a nasty \"dome trap´´, which prevents the player from moving once activated. Entering the room with the trap before acquiring the key will result in the player being trapped in the dungeon forever. The player cannot start in the same room as the key or the trap.\n\nThere are $q$ different scenarios that Alice and Bob wish to examine. In the $i^{th}$ scenario, the player starts in room $s_i$, the key is in room $k_i$, and the trap is in room $t_i$. For each scenario, compute the minimum amount of time needed to explore the entire dungeon without getting trapped.", "inputFormat": "The first line of input contains two integers $n$ and $q$, where $n$ ($3 \\leq n \\leq 2000$) is the number of rooms and $q$ ($1 \\leq q \\leq 200000$) is the number of scenarios to consider. Rooms are numbered from $1$ to $n$. The next $n-1$ lines each contain three integers $u$, $v$, and $w$ indicating that there is a corridor between rooms $u$ and $v$ ($1 \\leq u, v \\leq n, u \\neq v$) that takes time $w$ ($1 \\leq w \\leq 10^9$) to traverse.\n\nThen follow $q$ lines: the $i^{th}$ of these lines contains three distinct integers $s_i$, $k_i$, and $t_i$ ($1 \\leq s_i, k_i, t_i \\leq n$) indicating the room where the player starts, the room with the key, and the room with the trap, respectively.", "outputFormat": "For each scenario, output the minimum amount of time needed to visit every room at least once. If it is impossible to visit every room at least once, output $\\texttt{impossible}$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Dungeon Crawler", "background": "", "description": "有一棵 $n$ 个结点的树，边带权。你可以从一个结点通过边移动到一个相邻的结点，花费等同于边权的时间。\n\n其中，有两个特殊结点，一个结点里有钥匙，一个结点里有陷阱。你只有先获得钥匙，才能进入陷阱所在的结点。\n\n现有 $q$ 组询问，在第 $i$ 组询问中，你要从第 $s_i$ 号结点出发，钥匙在第 $k_i$ 号结点，陷阱在第 $t_i$ 号结点。你需要对于每组询问回答遍历整棵树所需的最短时间。题目保证你不会在钥匙所在的结点或者陷阱所在的结点出发。如果不可能遍历整棵树，输出 `impossible`。", "inputFormat": "第一行两个整数 $n,q$，含义如题目所述。\n\n接下来 $n-1$ 行，每行三个整数 $u,v,w$，表示有一条连接结点 $u,v$，权值为 $w$ 的边。\n\n接下来 $q$ 行，每行三个整数 $s_i,k_i,t_i$，含义如题目所述。\n\n$3\\le n\\le 2000$，$1\\le q \\le 2\\times10^5$，$1\\le u,v\\le n,u\\ne v$，$1\\le w\\le 10^9$，$1\\le s_i,k_i,t_i\\le n$。", "outputFormat": "对于每组询问，输出一行，包含一个整数表示答案，或者输出 `impossible` 表示无解。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9441", "type": "P", "difficulty": 5, "samples": [["8 51000\n", "1 2"], ["6 91000\n", "2 3\n"], ["10 1000000000000000000\n", "impossible\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "ICPC", "WF"], "title": "[ICPC 2021 WF] Fair Division", "background": "", "description": "After sailing the Seven Seas and raiding many ships, Cap'n Red and his crew of fellow pirates are finally ready to divide their loot. According to ancient traditions, the crew stands in a circle ordered by a strict pirate hierarchy. Cap'n Red starts by taking a fraction $f$ of the loot and passing the remainder on to the next pirate. That pirate takes the same fraction $f$ of the loot left over by the previous pirate and passes the remainder on to the following pirate. Each pirate behaves in the same way, taking a fraction $f$ of what is left and passing on the rest. The last pirate in the hierarchy passes the remainder on to Cap'n Red, who starts another round of this \"fair\" division, and so on, indefinitely.\n\nFortunately, pirates in the 21st century can use a computer to avoid this lengthy process and constant nitpicking when the fraction $f$ does not exactly divide the loot at some step. You have been captured by the pirates and asked to come up with a suitable fraction $f$. As an incentive, Cap'n Red has promised to leave you alive if you succeed.\n\nThe fraction $f$ needs to be a rational number strictly between $0$ and $1$. It is not necessary that $f$ exactly divides the loot remaining at any step of the round-robin process described above. However, the total loot that would be assigned to each pirate by carrying out this process infinitely needs to be an integer.", "inputFormat": "The input contains one line with two integers $n$ and $m$, where $n$ ($6 \\leq n \\leq 10^6$) is the number of pirates including Cap'n Red and $m$ ($1 \\leq m \\leq 10^{18}$) is the total value of their loot.", "outputFormat": "Output one line with two positive integers $p$ and $q$, where $f = \\frac{p}{q}$ as specified above. If there are multiple suitable fractions, choose one with the smallest $q$. Among multiple suitable fractions with the same smallest $q$ choose the one with the smallest $p$. If there is no suitable fraction, output $\\texttt{impossible}$ instead and hope for mercy.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Fair Division", "background": "", "description": "After sailing the Seven Seas and raiding many ships, Cap'n Red and his crew of fellow pirates are finally ready to divide their loot. According to ancient traditions, the crew stands in a circle ordered by a strict pirate hierarchy. Cap'n Red starts by taking a fraction $f$ of the loot and passing the remainder on to the next pirate. That pirate takes the same fraction $f$ of the loot left over by the previous pirate and passes the remainder on to the following pirate. Each pirate behaves in the same way, taking a fraction $f$ of what is left and passing on the rest. The last pirate in the hierarchy passes the remainder on to Cap'n Red, who starts another round of this \"fair\" division, and so on, indefinitely.\n\nFortunately, pirates in the 21st century can use a computer to avoid this lengthy process and constant nitpicking when the fraction $f$ does not exactly divide the loot at some step. You have been captured by the pirates and asked to come up with a suitable fraction $f$. As an incentive, Cap'n Red has promised to leave you alive if you succeed.\n\nThe fraction $f$ needs to be a rational number strictly between $0$ and $1$. It is not necessary that $f$ exactly divides the loot remaining at any step of the round-robin process described above. However, the total loot that would be assigned to each pirate by carrying out this process infinitely needs to be an integer.", "inputFormat": "The input contains one line with two integers $n$ and $m$, where $n$ ($6 \\leq n \\leq 10^6$) is the number of pirates including Cap'n Red and $m$ ($1 \\leq m \\leq 10^{18}$) is the total value of their loot.", "outputFormat": "Output one line with two positive integers $p$ and $q$, where $f = \\frac{p}{q}$ as specified above. If there are multiple suitable fractions, choose one with the smallest $q$. Among multiple suitable fractions with the same smallest $q$ choose the one with the smallest $p$. If there is no suitable fraction, output $\\texttt{impossible}$ instead and hope for mercy.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Fair Division", "background": "", "description": "$n$ 个人按如下的方式分 $m$ 块钱：先指定一个分数 $f$，$n$ 个人围成一圈，第一个人先拿走总钱数的 $f$，把剩下的钱给第二个人，然后第二个人拿走剩余钱数的 $f$，把剩下的钱交给第三个人...每一个人都从剩余的钱中拿走剩余钱数的 $f$，然后把钱交给下一个人。这种操作可以无限进行下去。\n\n现在给定 $n,m$，你需要构造 $f=\\dfrac{p}{q}$，使得 $0<f<1$，并且在分钱无限进行下去之后，最终每个人拿到的钱都是整数。如果有多解，你构造的解需要在 $q$ 尽可能小的情况下 $p$ 尽可能小。如果无解，输出 `impossible`。\n\n$6\\le n\\le 10^6$，$1\\le m\\le 10^{18}$。", "inputFormat": "仅一行两个整数 $n,m$，含义如题目所述。", "outputFormat": "如果有解，输出一行两个整数 $p,q$，分别是你构造的分数 $f$ 的分子和分母。\n\n如果无解，输出 `impossible`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9442", "type": "P", "difficulty": 7, "samples": [["8\n0 0\n20 0\n20 30\n60 30\n60 0\n80 0\n80 50\n0 50\n10 10\n70 10\n", "58.137767414995\n"], ["11\n0 0\n4 0\n4 1\n5 1\n5 0\n7 0\n7 2\n3 2\n3 1\n2 2\n0 2\n1 1\n6 1\n", "2.000000000000\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "Special Judge", "ICPC", "WF"], "title": "[ICPC 2021 WF] Guardians of the Gallery", "background": "", "description": "Your local art gallery is about to host an exciting new exhibition of sculptures by world-renowned artists, and the gallery expects to attract thousands of visitors. Unfortunately, the exhibition might also attract the wrong kind of visitors, namely burglars who intend to steal the works of art. In the past, the gallery directors did not worry much about this problem, since their permanent collection is, to be honest, not really worth stealing.\n\nThe gallery consists of rooms, and each sculpture in the new exhibition will be placed in a different room. Each room has a security guard and an alarm to monitor the artwork. When an alarm sounds, the guard will run (without leaving the room) from their post to a position where they can see the sculpture directly. This is to check whether the sculpture has in fact been stolen, or whether this is yet another false alarm.\n\nTo figure out where to best station the security guard, the gallery directors would like to know how long it takes for the guard to see a given sculpture. They hope that you can help!\n\nEvery room is on a single floor, and the layout of the walls can be approximated by a simple polygon. The locations of the guard and the sculpture are distinct points strictly inside the polygon. The sculpture is circular, with a negligibly small (but positive) radius. To verify that the sculpture is still present, the guard needs to be able to see at least half of it.\n\nFigure D.1 illustrates two examples. In each case, the guard starts at the blue square on the left, and the sculpture is located at the red circle on the right. The dotted blue line shows the optimal path for the guard to move. Once the guard reaches the location marked by the green diamond, half of the sculpture can be seen.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ugrzp1ry.png)", "inputFormat": "The first line of input contains an integer $n$ ($3 \\leq n \\leq 100$), the number of vertices that describe the polygon. This is followed by $n$ lines each containing two integers $x$ and $y$ ($0 \\leq x,y \\leq 1000$), giving the coordinates of the polygon vertices in counterclockwise order. The next line contains two integers $x_g$ and $y_g$, which specify the location of the guard. Finally, the last line contains two integers $x_s$ and $y_s$, which specify the location of the center of the sculpture. The polygon is simple, that is, its vertices are distinct and no two edges of the polygon intersect or touch, other than consecutive edges which touch at their common vertex. In addition, no two consecutive edges are collinear.", "outputFormat": "Output the minimum distance that the guard has to move to be able to see at least half the sculpture. Your answer must have an absolute or relative error of at most $10^{-6}$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Guardians of the Gallery", "background": "", "description": "Your local art gallery is about to host an exciting new exhibition of sculptures by world-renowned artists, and the gallery expects to attract thousands of visitors. Unfortunately, the exhibition might also attract the wrong kind of visitors, namely burglars who intend to steal the works of art. In the past, the gallery directors did not worry much about this problem, since their permanent collection is, to be honest, not really worth stealing.\n\nThe gallery consists of rooms, and each sculpture in the new exhibition will be placed in a different room. Each room has a security guard and an alarm to monitor the artwork. When an alarm sounds, the guard will run (without leaving the room) from their post to a position where they can see the sculpture directly. This is to check whether the sculpture has in fact been stolen, or whether this is yet another false alarm.\n\nTo figure out where to best station the security guard, the gallery directors would like to know how long it takes for the guard to see a given sculpture. They hope that you can help!\n\nEvery room is on a single floor, and the layout of the walls can be approximated by a simple polygon. The locations of the guard and the sculpture are distinct points strictly inside the polygon. The sculpture is circular, with a negligibly small (but positive) radius. To verify that the sculpture is still present, the guard needs to be able to see at least half of it.\n\nFigure D.1 illustrates two examples. In each case, the guard starts at the blue square on the left, and the sculpture is located at the red circle on the right. The dotted blue line shows the optimal path for the guard to move. Once the guard reaches the location marked by the green diamond, half of the sculpture can be seen.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ugrzp1ry.png)", "inputFormat": "The first line of input contains an integer $n$ ($3 \\leq n \\leq 100$), the number of vertices that describe the polygon. This is followed by $n$ lines each containing two integers $x$ and $y$ ($0 \\leq x,y \\leq 1000$), giving the coordinates of the polygon vertices in counterclockwise order. The next line contains two integers $x_g$ and $y_g$, which specify the location of the guard. Finally, the last line contains two integers $x_s$ and $y_s$, which specify the location of the center of the sculpture. The polygon is simple, that is, its vertices are distinct and no two edges of the polygon intersect or touch, other than consecutive edges which touch at their common vertex. In addition, no two consecutive edges are collinear.", "outputFormat": "Output the minimum distance that the guard has to move to be able to see at least half the sculpture. Your answer must have an absolute or relative error of at most $10^{-6}$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Guardians of the Gallery", "background": "", "description": "#### 简要题意\n给定封闭的 $n$ 边形不透明墙壁和其中两个点 $A, B$. 其中，$B$ 是一个半径充分小但大于 $0$ 的透明圆的圆心, 墙壁厚度可视为 $0$. 求所有能直接观察到 $\\odot B$ 的至少一半的位置中, 与点 $A$ 距离的最小值.", "inputFormat": "第一行, 一个整数 $n$.\n\n随后 $n$ 行, 每行两个整数 $x_i, y_i$, 依次表示其顶点的坐标。\n\n随后一行, 两个整数 $x_A, y_A$, 表示点 $A$ 的坐标.\n\n最后一行, 两个整数 $x_B, y_B$, 表示圆心 $B$ 的坐标.", "outputFormat": "一行，一个实数，表示最小距离。与标准答案误差不超过 $10^{-6}$ 即可判为正确。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9443", "type": "P", "difficulty": 6, "samples": [["4 1 28\n", "0.960000000000\n"], ["3 3 5 12 3\n", "0.854385964912\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "Special Judge", "ICPC", "WF"], "title": "[ICPC 2021 WF] Hand of the Free Marked", "background": "", "description": "![](https://cdn.luogu.com.cn/upload/image_hosting/kdojyok4.png)\n\nExample placement of cards for $k = 5$\n\nThere is a fairly well-known mentalism trick known as the Fitch Cheney trick. From a deck of $n$ playing cards, $k$ are selected uniformly at random and given to an assistant while the magician is out of the room. The assistant places $k-1$ of the selected cards on a table, face up, and the single remaining card face down. The cards are placed in a single row with the face-down card at the end (see the picture for an example). The magician enters the room, looks at the cards on the table, and announces what the $k^{th}$ card is, although its face is hidden. The trick is typically done with $n=52$ and $k=5$.\n\nThe assistant uses two ways of passing information to the magician. First, they can pick which one of the $k$ cards to keep hidden. Second, they can rearrange the other $k-1$ cards in a specific way. For the case $n=52$ and $k=5$ both techniques are needed, since there are only $24$ ways of rearranging four cards, which is not enough to reliably signal the fifth card. It is an interesting exercise to come up with a simple, easy-to-remember strategy for executing this trick, but right now you have another concern.\n\nYou were planning to perform this trick today, but just now you have learned that the deck has more cards than you expected. The trick may be impossible! In desperation, you have decided to cheat a little. You have $m$ distinguishable ways of marking the backs of the playing cards. You have marked the backs of all $n$ cards, allowing you to narrow down the possibilities for the $k^{th}$ card. For example, if there are $6$ cards marked with a particular method, and you see that the back of the $k^{th}$ card is marked with that method, you know it must be one of those $6$ cards.\n\nDetermine the probability that you will successfully guess the $k^{th}$ card, assuming you and the assistant execute an optimal (but likely very complicated!) strategy.", "inputFormat": "The input contains one line with several integers. The first integer gives $k$ ($2 \\leq k \\leq 10$), the number of cards that will be selected. The second integer gives $m$ ($1 \\leq m \\leq 10$), the number of ways of marking the cards. The line is completed by $m$ positive integers, giving the number of cards marked with each distinct method. The sum of these $m$ integers is $n$ ($k \\leq n \\leq 10^9$), which is the size of the deck.", "outputFormat": "Output the highest possible probability of guessing the $k^{th}$ card correctly, accurate up to an absolute error of $10^{-9}$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Hand of the Free Marked", "background": "", "description": "![](https://cdn.luogu.com.cn/upload/image_hosting/kdojyok4.png)\n\nExample placement of cards for $k = 5$\n\nThere is a fairly well-known mentalism trick known as the Fitch Cheney trick. From a deck of $n$ playing cards, $k$ are selected uniformly at random and given to an assistant while the magician is out of the room. The assistant places $k-1$ of the selected cards on a table, face up, and the single remaining card face down. The cards are placed in a single row with the face-down card at the end (see the picture for an example). The magician enters the room, looks at the cards on the table, and announces what the $k^{th}$ card is, although its face is hidden. The trick is typically done with $n=52$ and $k=5$.\n\nThe assistant uses two ways of passing information to the magician. First, they can pick which one of the $k$ cards to keep hidden. Second, they can rearrange the other $k-1$ cards in a specific way. For the case $n=52$ and $k=5$ both techniques are needed, since there are only $24$ ways of rearranging four cards, which is not enough to reliably signal the fifth card. It is an interesting exercise to come up with a simple, easy-to-remember strategy for executing this trick, but right now you have another concern.\n\nYou were planning to perform this trick today, but just now you have learned that the deck has more cards than you expected. The trick may be impossible! In desperation, you have decided to cheat a little. You have $m$ distinguishable ways of marking the backs of the playing cards. You have marked the backs of all $n$ cards, allowing you to narrow down the possibilities for the $k^{th}$ card. For example, if there are $6$ cards marked with a particular method, and you see that the back of the $k^{th}$ card is marked with that method, you know it must be one of those $6$ cards.\n\nDetermine the probability that you will successfully guess the $k^{th}$ card, assuming you and the assistant execute an optimal (but likely very complicated!) strategy.", "inputFormat": "The input contains one line with several integers. The first integer gives $k$ ($2 \\leq k \\leq 10$), the number of cards that will be selected. The second integer gives $m$ ($1 \\leq m \\leq 10$), the number of ways of marking the cards. The line is completed by $m$ positive integers, giving the number of cards marked with each distinct method. The sum of these $m$ integers is $n$ ($k \\leq n \\leq 10^9$), which is the size of the deck.", "outputFormat": "Output the highest possible probability of guessing the $k^{th}$ card correctly, accurate up to an absolute error of $10^{-9}$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Hand of the Free Marked", "background": "", "description": "#### 简要题意\n两个人 $A, B$ 玩一个游戏。规则如下 :\n\n$A$ 有 $n$ 张互不相同的牌. 它们的**背面**有 $m$ 种不同的样式, 第 $i$ 种牌有 $a_i$ 张. 二人都对这套牌非常了解. 保证 $\\sum\\limits^{m}_{i=1}{a_i} = n$.\n\n$B$ 在 $A$ 不在场的情况下从中随机抽出 $k$ 张, 然后选择一张牌倒置在桌面上. 然后 $B$ 可以以任意顺序重新排列其他牌并在桌面上依次排开, 并将倒置的牌放在序列的末尾. $A$ 和 $B$ 可以在游戏之前约定通过其他牌的排列顺序传递的信息.\n\n随后 $A$ 需要根据桌面上牌的排列和倒置牌的背面说出倒置的牌具体是哪一张. 双方的目标都是使 $A$ 说出正确的牌。\n\n现在给定 $m, a_i$ 和 $k$, 求二人均采取最佳策略的情况下, $A$ 的成功率是多少.", "inputFormat": "输入仅一行, 首先是两个整数 $k, m$, 然后是 $m$ 个整数 $a_i$.", "outputFormat": "一行, 一个实数, 表示答案. 答案与标准答案的差不超过 $10^{-9}$ 即判为正确.", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9444", "type": "P", "difficulty": 6, "samples": [["3 2\n3\n20 30\n50 50\n10 50\n4\n40 20\n60 10\n75 20\n60 30\n4\n45 60\n55 55\n60 60\n55 65\n0 30 20 78 70 5\n55 0 20 70 60 10\n", "48.031693036\n"], ["1 1\n4\n0 0\n10 0\n10 10\n0 10\n5 5 10 15 5 10\n", "impossible\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2021", "Special Judge", "ICPC", "WF"], "title": "[ICPC 2021 WF] Islands from the Sky", "background": "", "description": "You might never have heard of the island group of Iceepeecee, but that suits their inhabitants just fine. Located in a remote part of the South Pacific, they are truly off the beaten track, without any regular air or sea traffic, and they have remained a tropical paradise with unspoiled local fauna and flora.\n\nBeing off the map is great when you don't want to be overrun by hordes of tourists, but not so ideal when you actually do need a map for some reason. One such reason came up recently: Iceepeecee's central government needs an exact map of the islands to apportion government funds. Even tropical paradises need money, so Iceepeecee needs a map!\n\nThe easiest way to create a map would be an aerial survey. After dismissing chartering planes as too expensive, building an air balloon as too dangerous, and fitting carrier pigeons with cameras as too cruel to animals, they had a brilliant idea. Even with its remote location, there are still plenty of commercial airplanes crossing the skies above Iceepeecee. What if one mounted cameras on flights that are already scheduled to fly anyway? That would be a cheap solution to the problem!\n\nIceepeecee's plan is to install line-scan cameras on the planes. These cameras point straight downwards and collect images one line segment at a time, orthogonal to the flight path. The photographed line segment will be determined by the altitude that the plane is flying at, and the camera's aperture angle $\\theta$ (see Figure F.1). Greater angles $\\theta$ mean that the camera can see more, but also that the camera is more expensive.\n\nMoreover, Iceepeecee wants to make sure that each island is observed in its entirety by at least one flight. That means it is not sufficient that an island is only partially photographed by multiple flights, even if the combination of the photographs covers the whole island.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/99wwtofi.png)\n\nFigure F.1: A view of the plane, shown head-on. Its camera points downward and can see the part of the ground underneath the plane that is shown in green. How much is visible depends on the aperture angle $\\theta$.\n  \nFlight paths follow straight line segments in three-dimensional space, that is, ($x_1, y_1, z_1$) $-$ ($x_2, y_2, z_2$) (see Figure F.2), where the $z$-coordinates give the altitude of the plane. Photographs are taken only along these line segments.\n\nGiven the location of their islands and flights, Iceepeecee wants to find the smallest aperture angle $\\theta$ that allows for a successful survey. Can you help?\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3pdn3q1b.png)\n\nFigure F.2: Three islands (shown in black) and two flight paths (red and green). Altitudes are not shown. The shaded areas represent the ground visible on the two flight paths for an optimally chosen $\\theta$. This corresponds to the first sample input.Three islands (shown in black) and two flight paths (red and green). Altitudes are not shown. The shaded areas represent the ground visible on the two flight paths for an optimally chosen $\\theta$. This corresponds to the first sample input.", "inputFormat": "The input describes a set of islands and flight paths. It starts with a line containing two integers $n$ and $m$, the number $n$ of islands, and the number $m$ of flight paths, respectively ($1 \\leq n,m \\leq 100$). This is followed by descriptions of the $n$ islands. Each island description starts with a line containing a single integer $n_i$, the number of vertices of the polygon describing the $i^{th}$ island ($3 \\leq n_i \\leq 100$). It is followed by $n_i$ lines, each containing two integers $x_{ij}$, $y_{ij}$ ($|x_{ij}|, |y_{ij}| \\leq 10^6$), specifying the vertices for the $i^{th}$ island in counterclockwise order. Each island's polygon is simple, that is, its vertices are distinct and no two edges of the polygon intersect or touch, other than consecutive edges which touch at their common vertex. Different islands do not intersect or touch.\n\nThe input concludes with another $m$ lines, each describing a flight path. Each such line contains six integers $x_1$, $y_1$, $z_1$, $x_2$, $y_2$, $z_2$ ($|x_i|, |y_i|, |z_i| \\leq 10^6$, $z_i &gt; 0$ and ($x_1, y_1$) $\\neq$ ($x_2, y_2$)). They specify that a flight takes place from ($x_1, y_1, z_1$) to ($x_2, y_2, z_2$).", "outputFormat": "Output the smallest angle $\\theta$ (in degrees) that allows for a complete survey of the islands with the given flights. The answer should be exact to an absolute or relative error of $10^{-6}$. If there is no such angle, then output $\\texttt{impossible}$. The input is chosen such that if the coordinates of the island vertices are changed by at most $\\pm 10^{-8}$, then the answer will not change more than the allowed rounding error.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Islands from the Sky", "background": "", "description": "You might never have heard of the island group of Iceepeecee, but that suits their inhabitants just fine. Located in a remote part of the South Pacific, they are truly off the beaten track, without any regular air or sea traffic, and they have remained a tropical paradise with unspoiled local fauna and flora.\n\nBeing off the map is great when you don't want to be overrun by hordes of tourists, but not so ideal when you actually do need a map for some reason. One such reason came up recently: Iceepeecee's central government needs an exact map of the islands to apportion government funds. Even tropical paradises need money, so Iceepeecee needs a map!\n\nThe easiest way to create a map would be an aerial survey. After dismissing chartering planes as too expensive, building an air balloon as too dangerous, and fitting carrier pigeons with cameras as too cruel to animals, they had a brilliant idea. Even with its remote location, there are still plenty of commercial airplanes crossing the skies above Iceepeecee. What if one mounted cameras on flights that are already scheduled to fly anyway? That would be a cheap solution to the problem!\n\nIceepeecee's plan is to install line-scan cameras on the planes. These cameras point straight downwards and collect images one line segment at a time, orthogonal to the flight path. The photographed line segment will be determined by the altitude that the plane is flying at, and the camera's aperture angle $\\theta$ (see Figure F.1). Greater angles $\\theta$ mean that the camera can see more, but also that the camera is more expensive.\n\nMoreover, Iceepeecee wants to make sure that each island is observed in its entirety by at least one flight. That means it is not sufficient that an island is only partially photographed by multiple flights, even if the combination of the photographs covers the whole island.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/99wwtofi.png)\n\nFigure F.1: A view of the plane, shown head-on. Its camera points downward and can see the part of the ground underneath the plane that is shown in green. How much is visible depends on the aperture angle $\\theta$.\n  \nFlight paths follow straight line segments in three-dimensional space, that is, ($x_1, y_1, z_1$) $-$ ($x_2, y_2, z_2$) (see Figure F.2), where the $z$-coordinates give the altitude of the plane. Photographs are taken only along these line segments.\n\nGiven the location of their islands and flights, Iceepeecee wants to find the smallest aperture angle $\\theta$ that allows for a successful survey. Can you help?\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3pdn3q1b.png)\n\nFigure F.2: Three islands (shown in black) and two flight paths (red and green). Altitudes are not shown. The shaded areas represent the ground visible on the two flight paths for an optimally chosen $\\theta$. This corresponds to the first sample input.Three islands (shown in black) and two flight paths (red and green). Altitudes are not shown. The shaded areas represent the ground visible on the two flight paths for an optimally chosen $\\theta$. This corresponds to the first sample input.", "inputFormat": "The input describes a set of islands and flight paths. It starts with a line containing two integers $n$ and $m$, the number $n$ of islands, and the number $m$ of flight paths, respectively ($1 \\leq n,m \\leq 100$). This is followed by descriptions of the $n$ islands. Each island description starts with a line containing a single integer $n_i$, the number of vertices of the polygon describing the $i^{th}$ island ($3 \\leq n_i \\leq 100$). It is followed by $n_i$ lines, each containing two integers $x_{ij}$, $y_{ij}$ ($|x_{ij}|, |y_{ij}| \\leq 10^6$), specifying the vertices for the $i^{th}$ island in counterclockwise order. Each island's polygon is simple, that is, its vertices are distinct and no two edges of the polygon intersect or touch, other than consecutive edges which touch at their common vertex. Different islands do not intersect or touch.\n\nThe input concludes with another $m$ lines, each describing a flight path. Each such line contains six integers $x_1$, $y_1$, $z_1$, $x_2$, $y_2$, $z_2$ ($|x_i|, |y_i|, |z_i| \\leq 10^6$, $z_i &gt; 0$ and ($x_1, y_1$) $\\neq$ ($x_2, y_2$)). They specify that a flight takes place from ($x_1, y_1, z_1$) to ($x_2, y_2, z_2$).", "outputFormat": "Output the smallest angle $\\theta$ (in degrees) that allows for a complete survey of the islands with the given flights. The answer should be exact to an absolute or relative error of $10^{-6}$. If there is no such angle, then output $\\texttt{impossible}$. The input is chosen such that if the coordinates of the island vertices are changed by at most $\\pm 10^{-8}$, then the answer will not change more than the allowed rounding error.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Islands from the Sky", "background": "", "description": "你可能从未听说过 Iceepeecee 群岛，但这正是他们的居民所希望的。位于南太平洋的一个偏远地区，它们真正远离人迹罕至的地方，没有任何定期的空中或海上交通，仍然是一个未受破坏的热带天堂，拥有未受破坏的当地动植物。\n\n当你不想被成群的游客淹没时，远离地图是很好的，但当你确实需要地图时就不太理想了。最近出现了一个这样的原因：Iceepeecee 的中央政府需要一个精确的岛屿地图来分配政府资金。即使是热带天堂也需要钱，所以 Iceepeecee 需要一张地图！\n\n创建地图的最简单方法是航空测量。在认为包机太贵、建造气球太危险、给信鸽装上相机对动物太残忍之后，他们有了一个绝妙的主意。即使在这个偏远的地方，仍然有很多商业飞机飞过 Iceepeecee 上空。如果在已经计划飞行的航班上安装相机呢？这将是一个解决问题的廉价方案！\n\nIceepeecee 的计划是在飞机上安装线扫描相机。这些相机垂直向下拍摄，每次收集一条线段的图像，与飞行路径正交。拍摄的线段将由飞机的飞行高度和相机的光圈角度 $\\theta$ 决定（见图 F.1）。更大的角度 $\\theta$ 意味着相机可以看到更多，但也意味着相机更贵。\n\n此外，Iceepeecee 希望确保每个岛屿都能被至少一次航班完整观察到。这意味着不够仅仅通过多次航班部分拍摄到一个岛屿，即使这些照片的组合覆盖了整个岛屿。\n\n图 F.1：飞机的正面视图。其相机向下拍摄，可以看到飞机下方的绿色部分。可见的范围取决于光圈角度 $\\theta$。\n\n飞行路径在三维空间中沿直线段，即 ($x_1, y_1, z_1$) $-$ ($x_2, y_2, z_2$)（见图 F.2），其中 $z$ 坐标给出飞机的高度。照片仅在这些线段上拍摄。\n\n给定他们的岛屿和航班的位置，Iceepeecee 想要找到允许成功测量的最小光圈角度 $\\theta$。你能帮忙吗？\n\n图 F.2：三个岛屿（以黑色显示）和两条飞行路径（红色和绿色）。未显示高度。阴影区域表示在最佳选择的 $\\theta$ 下两条飞行路径上可见的地面。这对应于第一个样例输入。", "inputFormat": "输入描述了一组岛屿和飞行路径。首先是一行包含两个整数 $n$ 和 $m$，分别表示岛屿的数量 $n$ 和飞行路径的数量 $m$（$1 \\leq n,m \\leq 100$）。接下来是 $n$ 个岛屿的描述。每个岛屿描述以一行开始，包含一个整数 $n_i$，表示描述第 $i$ 个岛屿的多边形的顶点数（$3 \\leq n_i \\leq 100$）。接下来是 $n_i$ 行，每行包含两个整数 $x_{ij}$，$y_{ij}$（$|x_{ij}|, |y_{ij}| \\leq 10^6$），按逆时针顺序指定第 $i$ 个岛屿的顶点。每个岛屿的多边形是简单的，即其顶点是不同的，且多边形的边不相交或接触，除了相邻的边在其公共顶点处接触。不同的岛屿不相交或接触。\n\n输入以另外 $m$ 行结束，每行描述一条飞行路径。每行包含六个整数 $x_1$，$y_1$，$z_1$，$x_2$，$y_2$，$z_2$（$|x_i|, |y_i|, |z_i| \\leq 10^6$，$z_i > 0$ 且 ($x_1, y_1$) $\neq$ ($x_2, y_2$)）。它们指定了一次从 ($x_1, y_1, z_1$) 到 ($x_2, y_2, z_2$) 的飞行。", "outputFormat": "输出允许使用给定航班对岛屿进行完整测量的最小角度 $\\theta$（以度为单位）。答案应精确到绝对或相对误差 $10^{-6}$。如果没有这样的角度，则输出 $\\texttt{impossible}$。输入被选择为，如果岛屿顶点的坐标最多改变 $\\pm 10^{-8}$，则答案不会超过允许的舍入误差。", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9445", "type": "P", "difficulty": 6, "samples": [["2 2\n1 0\n0 1\n3 4\n1 2 1 2\n2 1 1 1\n2 2 1 3\n", "3\n1 1\n1 3\n2 2\n"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "ICPC", "WF"], "title": "[ICPC 2021 WF] Mosaic Browsing", "background": "", "description": "The International Center for the Preservation of Ceramics (ICPC) is searching for motifs in some ancient mosaics. According to the ICPC's definition, a $\\textit{mosaic}$ is a rectangular grid where each grid square contains a colored tile. A $\\textit{motif}$ is similar to a mosaic but some of the grid squares can be empty. Figure G.1 shows an example motif and mosaic.\n\nThe rows of an $r_q \\times c_q$ mosaic are numbered $1$ to $r_q$ from top to bottom, and the columns are numbered $1$ to $c_q$ from left to right.\n\nA contiguous rectangular subgrid of the mosaic matches the motif if every tile of the motif matches the color of the corresponding tile of the subgrid. Formally, an $r_p \\times c_p$ motif appears in an $r_q \\times c_q$ mosaic at position ($r$, $c$) if for all $1 \\leq i \\leq r_p$, $1 \\leq j \\leq c_p$, the tile ($r+i-1$, $c+j-1$) exists in the mosaic and either the square ($i$, $j$) in the motif is empty or the tile at ($i$, $j$) in the motif has the same color as the tile at ($r+i-1$, $c+j-1$) in the mosaic.\n\nGiven the full motif and mosaic, find all occurrences of the motif in the mosaic.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0n7urywk.png)\n\nFigure G.1: Motif (left) and mosaic (right) of Sample Input 1.", "inputFormat": "The first line of input contains two integers $r_p$ and $c_p$, where $r_p$ and $c_p$ ($1 \\leq r_p, c_p \\leq 1000$) are the number of rows and columns in the motif. Then $r_p$ lines follow, each with $c_p$ integers in the range $[0, 100]$, denoting the color of the motif at that position. A value of $0$ denotes an empty square.\n\nThe next line of input contains two integers $r_q$ and $c_q$ where $r_q$ and $c_q$ ($1 \\leq r_q, c_q \\leq 1000$) are the number of rows and columns in the mosaic. Then $r_q$ lines follow, each with $c_q$ integers in the range $[1, 100]$, denoting the color of the mosaic at that position.", "outputFormat": "On the first line, output $k$, the total number of matches. Then output $k$ lines, each of the form $r c$ where $r$ is the row and $c$ is the column of the top left tile of the match. Sort matches by increasing $r$, breaking ties by increasing $c$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Mosaic Browsing", "background": "", "description": "The International Center for the Preservation of Ceramics (ICPC) is searching for motifs in some ancient mosaics. According to the ICPC's definition, a $\\textit{mosaic}$ is a rectangular grid where each grid square contains a colored tile. A $\\textit{motif}$ is similar to a mosaic but some of the grid squares can be empty. Figure G.1 shows an example motif and mosaic.\n\nThe rows of an $r_q \\times c_q$ mosaic are numbered $1$ to $r_q$ from top to bottom, and the columns are numbered $1$ to $c_q$ from left to right.\n\nA contiguous rectangular subgrid of the mosaic matches the motif if every tile of the motif matches the color of the corresponding tile of the subgrid. Formally, an $r_p \\times c_p$ motif appears in an $r_q \\times c_q$ mosaic at position ($r$, $c$) if for all $1 \\leq i \\leq r_p$, $1 \\leq j \\leq c_p$, the tile ($r+i-1$, $c+j-1$) exists in the mosaic and either the square ($i$, $j$) in the motif is empty or the tile at ($i$, $j$) in the motif has the same color as the tile at ($r+i-1$, $c+j-1$) in the mosaic.\n\nGiven the full motif and mosaic, find all occurrences of the motif in the mosaic.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0n7urywk.png)\n\nFigure G.1: Motif (left) and mosaic (right) of Sample Input 1.", "inputFormat": "The first line of input contains two integers $r_p$ and $c_p$, where $r_p$ and $c_p$ ($1 \\leq r_p, c_p \\leq 1000$) are the number of rows and columns in the motif. Then $r_p$ lines follow, each with $c_p$ integers in the range $[0, 100]$, denoting the color of the motif at that position. A value of $0$ denotes an empty square.\n\nThe next line of input contains two integers $r_q$ and $c_q$ where $r_q$ and $c_q$ ($1 \\leq r_q, c_q \\leq 1000$) are the number of rows and columns in the mosaic. Then $r_q$ lines follow, each with $c_q$ integers in the range $[1, 100]$, denoting the color of the mosaic at that position.", "outputFormat": "On the first line, output $k$, the total number of matches. Then output $k$ lines, each of the form $r c$ where $r$ is the row and $c$ is the column of the top left tile of the match. Sort matches by increasing $r$, breaking ties by increasing $c$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Mosaic Browsing", "background": "", "description": "#### 简要题意\n给出两个矩阵, 其中第二个矩阵所有元素非 $0$.\n\n定义第一个矩阵在第二个矩阵中的坐标 $(l, r)$ 处「出现」, 当且仅当存在一种方式任意修改第一个矩阵所有为 $0$ 的元素后, 第一个矩阵的左上角在第二个矩阵的对应位置坐标为 $(l, r)$ 时可以与第二个矩阵的一部分完全重合.\n\n求第一个矩阵在第二个矩阵中所有「出现」的位置和总「出现」次数。", "inputFormat": "第一行, 两个整数 $r_p, c_p$, 表示第一个矩阵的行数和列数.\n\n接下来 $r_p$ 行, 每行 $c_p$ 个整数, 描述第一个矩阵.\n\n接下来一行, 两个整数 $r_q, c_q$, 表示第二个矩阵的行数和列数.\n\n接下来 $r_q$ 行，每行 $c_q$ 个整数, 描述第二个矩阵.", "outputFormat": "第一行, 一个整数 $k$, 表示「出现」的总次数.\n\n接下来 $k$ 行, 每行两个整数 $x, y$, 表示每一次「出现」的坐标. 如果有多个, 请以 $x$ 为第一关键字, $y$ 为第二关键字升序排序后输出。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9446", "type": "P", "difficulty": 5, "samples": [["2\n())())()\n((()\n", "2\n1"], ["5\n(\n))\n((\n))\n(\n", "1\n5\n3\n4\n2\n"], ["2\n((\n)\n", "impossible\n"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "2021", "Special Judge", "排序", "ICPC", "WF"], "title": "[ICPC 2021 WF] Prehistoric Programs", "background": "", "description": "Archaeologists have discovered exciting clay tablets in deep layers of Alutila Cave. Nobody was able to decipher the script on the tablets, except for two symbols that seem to describe nested structures not unlike opening and closing parentheses in LISP. Could it be that humans wrote programs thousands of years ago?\n\nTaken together, the tablets appear to describe a great piece of work $-$ perhaps a program, or an epic, or even tax records! Unsurprisingly, after such a long time, the tablets are in a state of disorder. Your job is to arrange them into a sequence so that the resulting work has a properly nested parenthesis structure. Considering only opening and closing parentheses, a properly nested structure is either\n\n- $()$, or\n- $(A)$, where $A$ is a properly nested structure, or\n- $AB$, where $A$ and $B$ are properly nested structures.", "inputFormat": "The first line of input contains one integer $n$ ($1 \\leq n \\leq 10^6$), the number of tablets. Each of the remaining $n$ lines describes a tablet, and contains a non-empty string of opening and closing parentheses; symbols unrelated to the nesting structure are omitted. The strings are numbered from $1$ to $n$ in the order that they appear in the input. The input contains at most $10^7$ parentheses.", "outputFormat": "Output a permutation of the numbers from $1$ to $n$ such that concatenating the strings in this order results in a properly nested structure. If this happens for multiple permutations, any one of them will be accepted. If there is no such permutation, output $\\texttt{impossible}$ instead.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Prehistoric Programs", "background": "", "description": "Archaeologists have discovered exciting clay tablets in deep layers of Alutila Cave. Nobody was able to decipher the script on the tablets, except for two symbols that seem to describe nested structures not unlike opening and closing parentheses in LISP. Could it be that humans wrote programs thousands of years ago?\n\nTaken together, the tablets appear to describe a great piece of work $-$ perhaps a program, or an epic, or even tax records! Unsurprisingly, after such a long time, the tablets are in a state of disorder. Your job is to arrange them into a sequence so that the resulting work has a properly nested parenthesis structure. Considering only opening and closing parentheses, a properly nested structure is either\n\n- $()$, or\n- $(A)$, where $A$ is a properly nested structure, or\n- $AB$, where $A$ and $B$ are properly nested structures.", "inputFormat": "The first line of input contains one integer $n$ ($1 \\leq n \\leq 10^6$), the number of tablets. Each of the remaining $n$ lines describes a tablet, and contains a non-empty string of opening and closing parentheses; symbols unrelated to the nesting structure are omitted. The strings are numbered from $1$ to $n$ in the order that they appear in the input. The input contains at most $10^7$ parentheses.", "outputFormat": "Output a permutation of the numbers from $1$ to $n$ such that concatenating the strings in this order results in a properly nested structure. If this happens for multiple permutations, any one of them will be accepted. If there is no such permutation, output $\\texttt{impossible}$ instead.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Prehistoric Programs", "background": "", "description": "考古学家在 Alutila 洞穴的深层发现了令人兴奋的粘土板。除了两个似乎描述嵌套结构的符号（类似于 LISP 中的开括号和闭括号）外，没有人能够破译粘土板上的文字。难道几千年前人类就已经在编写程序了吗？\n\n综合来看，这些粘土板似乎描述了一项伟大的作品——可能是一个程序，或者是一部史诗，甚至是税务记录！不出所料，经过这么长时间，粘土板已经处于无序状态。你的任务是将它们排列成一个序列，使得结果作品具有正确嵌套的括号结构。仅考虑开括号和闭括号，一个正确嵌套的结构要么是\n\n- $()$，或者\n- $(A)$，其中 $A$ 是一个正确嵌套的结构，或者\n- $AB$，其中 $A$ 和 $B$ 是正确嵌套的结构。", "inputFormat": "输入的第一行包含一个整数 $n$ ($1 \\leq n \\leq 10^6$)，表示粘土板的数量。接下来的 $n$ 行中的每一行描述一个粘土板，并包含一个非空的开括号和闭括号字符串；与嵌套结构无关的符号被省略。字符串按照它们在输入中出现的顺序从 $1$ 到 $n$ 编号。输入中最多包含 $10^7$ 个括号。", "outputFormat": "输出一个从 $1$ 到 $n$ 的数字排列，使得按此顺序连接字符串后形成一个正确嵌套的结构。如果存在多个排列满足条件，任何一个都可以接受。如果没有这样的排列，输出 $\\texttt{impossible}$。", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9447", "type": "P", "difficulty": 6, "samples": [["7 5 6\n2 1\n4 3\n6 3\n8 7\n10 5\n", "2\n1\n1\n1\n0\n1\n2\n"], ["4 4 2\n1 1\n2 2\n3 3\n4 4\n", "1\n1\n0\n1\n"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "ICPC", "WF"], "title": "[ICPC 2021 WF] Spider Walk", "background": "", "description": "Charlotte the spider sits at the center of her spiderweb, which consists of a series of silken straight strands that go from the center to the outer boundary of the web. Charlotte's web also has bridges, each of which connects two adjacent strands. The two endpoints of a bridge always have the same distance to the center of the spiderweb.\n\nWhen Charlotte has finished a late-night feasting in the center and wants to retreat to some corner, she walks to the edge on autopilot. To do this, she picks a starting strand, and walks along it until she meets the first bridge on that strand. She will cross the bridge and go to the other strand, and then keeps walking outwards until she meets another bridge. Then she will cross that bridge, and repeat this process, until there are no more bridges on the current strand, and then she will walk to the end of the current strand. Note that Charlotte must cross all the bridges that she meets. Figure I.1 illustrates one path Charlotte could take.\n\nCharlotte's favorite corner to sleep in during the daytime is at the end of strand $s$. For each possible starting strand, she wants to know the minimum number of bridges to add to the original web in order to end at $s$. Charlotte can add a bridge at any point along the strand, as long as the added bridge does not touch any other bridge. The two endpoints of any added bridge must have the same distance to the center of the spiderweb, and the bridge must connect two adjacent strands.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7nb4cy7c.png)\n\nFigure I.1: The path starting from strand 4 on the spiderweb in Sample Input 1.", "inputFormat": "The first line of input has three integers $n$, $m$, and $s$, where $n$ ($3 \\leq n \\leq 200000$) is the number of strands, m ($0 \\leq m \\leq 500000$) is the number of bridges, and $s$ ($1 \\leq s \\leq n$) is Charlotte's favorite strand. Strands are labeled from $1$ to $n$ in counterclockwise order. Each of the remaining $m$ lines contains two integers $d$ and $t$ describing a bridge, where $d$ ($1 \\leq d \\leq 10^9$) is the bridge's distance from the center of the spiderweb and $t$ ($1 \\leq t \\leq n$) is the first strand of the bridge in counterclockwise order. Specifically, if $1 \\leq t &lt; n$, then the bridge connects strands $t$ and $t+1$. If $t = n$, then the bridge connects strands $1$ and $n$. All bridge distances $d$ are distinct.", "outputFormat": "Output $n$ lines, where the $i^{th}$ line is the minimum number of bridges Charlotte needs to add in order to end at strand $s$ after walking on autopilot from strand $i$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Spider Walk", "background": "", "description": "Charlotte the spider sits at the center of her spiderweb, which consists of a series of silken straight strands that go from the center to the outer boundary of the web. Charlotte's web also has bridges, each of which connects two adjacent strands. The two endpoints of a bridge always have the same distance to the center of the spiderweb.\n\nWhen Charlotte has finished a late-night feasting in the center and wants to retreat to some corner, she walks to the edge on autopilot. To do this, she picks a starting strand, and walks along it until she meets the first bridge on that strand. She will cross the bridge and go to the other strand, and then keeps walking outwards until she meets another bridge. Then she will cross that bridge, and repeat this process, until there are no more bridges on the current strand, and then she will walk to the end of the current strand. Note that Charlotte must cross all the bridges that she meets. Figure I.1 illustrates one path Charlotte could take.\n\nCharlotte's favorite corner to sleep in during the daytime is at the end of strand $s$. For each possible starting strand, she wants to know the minimum number of bridges to add to the original web in order to end at $s$. Charlotte can add a bridge at any point along the strand, as long as the added bridge does not touch any other bridge. The two endpoints of any added bridge must have the same distance to the center of the spiderweb, and the bridge must connect two adjacent strands.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7nb4cy7c.png)\n\nFigure I.1: The path starting from strand 4 on the spiderweb in Sample Input 1.", "inputFormat": "The first line of input has three integers $n$, $m$, and $s$, where $n$ ($3 \\leq n \\leq 200000$) is the number of strands, m ($0 \\leq m \\leq 500000$) is the number of bridges, and $s$ ($1 \\leq s \\leq n$) is Charlotte's favorite strand. Strands are labeled from $1$ to $n$ in counterclockwise order. Each of the remaining $m$ lines contains two integers $d$ and $t$ describing a bridge, where $d$ ($1 \\leq d \\leq 10^9$) is the bridge's distance from the center of the spiderweb and $t$ ($1 \\leq t \\leq n$) is the first strand of the bridge in counterclockwise order. Specifically, if $1 \\leq t &lt; n$, then the bridge connects strands $t$ and $t+1$. If $t = n$, then the bridge connects strands $1$ and $n$. All bridge distances $d$ are distinct.", "outputFormat": "Output $n$ lines, where the $i^{th}$ line is the minimum number of bridges Charlotte needs to add in order to end at strand $s$ after walking on autopilot from strand $i$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Spider Walk", "background": "", "description": "夏洛特蜘蛛坐在她的蜘蛛网中心，蜘蛛网由一系列从中心延伸到外边界的丝线组成。夏洛特的网还有桥，每座桥连接两条相邻的丝线。桥的两个端点到蜘蛛网中心的距离总是相同。\n\n当夏洛特在中心享用完深夜的盛宴后想要撤退到某个角落时，她会自动驾驶地走到边缘。为此，她选择一条起始丝线，并沿着它走，直到遇到这条丝线上的第一座桥。她会穿过桥到另一条丝线上，然后继续向外走，直到遇到另一座桥。然后她会穿过那座桥，并重复这个过程，直到当前丝线上没有更多的桥，然后她会走到当前丝线的末端。注意，夏洛特必须穿过她遇到的所有桥。图 I.1 展示了夏洛特可能走的一条路径。\n\n夏洛特白天最喜欢睡觉的角落在丝线 $s$ 的末端。对于每个可能的起始丝线，她想知道为了最终到达 $s$，需要在原始网中添加的最少桥数。夏洛特可以在丝线的任何一点添加桥，只要添加的桥不接触任何其他桥。任何添加的桥的两个端点必须到蜘蛛网中心的距离相同，并且桥必须连接两条相邻的丝线。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7nb4cy7c.png)\n\n图 I.1：在示例输入 1 中从丝线 4 开始的路径。", "inputFormat": "输入的第一行包含三个整数 $n$、$m$ 和 $s$，其中 $n$ ($3 \\leq n \\leq 200000$) 是丝线的数量，$m$ ($0 \\leq m \\leq 500000$) 是桥的数量，$s$ ($1 \\leq s \\leq n$) 是夏洛特最喜欢的丝线。丝线按逆时针顺序从 $1$ 到 $n$ 标记。接下来的 $m$ 行中的每一行包含两个整数 $d$ 和 $t$ 描述一座桥，其中 $d$ ($1 \\leq d \\leq 10^9$) 是桥到蜘蛛网中心的距离，$t$ ($1 \\leq t \\leq n$) 是桥的第一条丝线的逆时针顺序。具体来说，如果 $1 \\leq t < n$，则桥连接丝线 $t$ 和 $t+1$。如果 $t = n$，则桥连接丝线 $1$ 和 $n$。所有桥的距离 $d$ 都是不同的。", "outputFormat": "输出 $n$ 行，其中第 $i$ 行是夏洛特需要添加的最少桥数，以便在从丝线 $i$ 自动驾驶行走后最终到达丝线 $s$。", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9448", "type": "P", "difficulty": 4, "samples": [["200 2 2\nS 1 2 3\nM 3 2 4\n4 99\n4 100\n", "100\n99\n"], ["100 3 6\nS 1 4 2\nS 2 3 5\nM 3 4 6\n6 48\n6 49\n6 50\n6 51\n6 52\n5 25\n", "47\n98\n49\n51\n53\n100\n"], ["2 3 3\nS 1 2 3\nS 3 4 5\nM 5 2 6\n3 1\n5 1\n6 2\n", "2\nnone\nnone\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "ICPC", "WF"], "title": "[ICPC 2021 WF] Splitstream", "background": "", "description": "A splitstream system is an acyclic network of nodes that processes finite sequences of numbers. There are two types of nodes (illustrated in Figure J.1):\n\n- A *split* node takes a sequence of numbers as input and distributes them alternatingly to its two outputs. The first number goes to output $1$, the second to output $2$, the third to output $1$, the fourth to output $2$, and so on, in this order.</li>\n- A *merge** node takes two sequences of numbers as input and merges them alternatingly to form its single output. The output contains the first number from input $1$, then the first from input $2$, then the second from input $1$, then the second from input $2$, and so on. If one of the input sequences is shorter than the other, then the remaining numbers from the longer sequence are simply transmitted without being merged after the shorter sequence has been exhausted.</li>\n\n ![](https://cdn.luogu.com.cn/upload/image_hosting/e0gr6wa3.png)\n  \n  Figure J.1: Illustration of how split and merge nodes work.\n  \nThe overall network has one input, which is the sequence of positive integers $1, 2, 3, \\ldots, m$. Any output of any node can be queried. A query will seek to identify the $k^{th}$ number in the sequence of numbers for a given output and a given $k$. Your task is to implement such queries efficiently.", "inputFormat": "The first line of input contains three integers $m$, $n$, and $q$, where $m$ ($1 \\leq m \\leq 10^9$) is the length of the input sequence, $n$ ($1 \\leq n \\leq 10^4$) is the number of nodes, and $q$ ($1 \\leq q \\leq 10^3$) is the number of queries.\n\nThe next $n$ lines describe the network, one node per line. A split node has the format $\\texttt{S} \\ x \\ y \\ z$, where $x$, $y$ and $z$ identify its input, first output and second output, respectively. A merge node has the format $\\texttt{M} \\ x \\ y \\ z$, where $x$, $y$ and $z$ identify its first input, second input and output, respectively. Identifiers $x$, $y$ and $z$ are distinct positive integers. The overall input is identified by $1$, and the remaining input/output identifiers form a consecutive sequence beginning at $2$. Every input identifier except $1$ appears as exactly one output. Every output identifier appears as the input of at most one node.\n\nEach of the next $q$ lines describes a query. Each query consists of two integers $x$ and $k$, where $x$ ($2 \\leq x \\leq 10^5$) is a valid output identifier and $k$ ($1 \\leq k \\leq 10^9$) is the index of the desired number in that sequence. Indexing in a sequence starts with $1$.", "outputFormat": "For each query $x$ and $k$ output one line with the $k^{th}$ number in the output sequence identified by $x$, or $\\texttt{none}$ if there is no element with that index number.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Splitstream", "background": "", "description": "A splitstream system is an acyclic network of nodes that processes finite sequences of numbers. There are two types of nodes (illustrated in Figure J.1):\n\n- A *split* node takes a sequence of numbers as input and distributes them alternatingly to its two outputs. The first number goes to output $1$, the second to output $2$, the third to output $1$, the fourth to output $2$, and so on, in this order.</li>\n- A *merge** node takes two sequences of numbers as input and merges them alternatingly to form its single output. The output contains the first number from input $1$, then the first from input $2$, then the second from input $1$, then the second from input $2$, and so on. If one of the input sequences is shorter than the other, then the remaining numbers from the longer sequence are simply transmitted without being merged after the shorter sequence has been exhausted.</li>\n\n ![](https://cdn.luogu.com.cn/upload/image_hosting/e0gr6wa3.png)\n  \n  Figure J.1: Illustration of how split and merge nodes work.\n  \nThe overall network has one input, which is the sequence of positive integers $1, 2, 3, \\ldots, m$. Any output of any node can be queried. A query will seek to identify the $k^{th}$ number in the sequence of numbers for a given output and a given $k$. Your task is to implement such queries efficiently.", "inputFormat": "The first line of input contains three integers $m$, $n$, and $q$, where $m$ ($1 \\leq m \\leq 10^9$) is the length of the input sequence, $n$ ($1 \\leq n \\leq 10^4$) is the number of nodes, and $q$ ($1 \\leq q \\leq 10^3$) is the number of queries.\n\nThe next $n$ lines describe the network, one node per line. A split node has the format $\\texttt{S} \\ x \\ y \\ z$, where $x$, $y$ and $z$ identify its input, first output and second output, respectively. A merge node has the format $\\texttt{M} \\ x \\ y \\ z$, where $x$, $y$ and $z$ identify its first input, second input and output, respectively. Identifiers $x$, $y$ and $z$ are distinct positive integers. The overall input is identified by $1$, and the remaining input/output identifiers form a consecutive sequence beginning at $2$. Every input identifier except $1$ appears as exactly one output. Every output identifier appears as the input of at most one node.\n\nEach of the next $q$ lines describes a query. Each query consists of two integers $x$ and $k$, where $x$ ($2 \\leq x \\leq 10^5$) is a valid output identifier and $k$ ($1 \\leq k \\leq 10^9$) is the index of the desired number in that sequence. Indexing in a sequence starts with $1$.", "outputFormat": "For each query $x$ and $k$ output one line with the $k^{th}$ number in the output sequence identified by $x$, or $\\texttt{none}$ if there is no element with that index number.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Splitstream", "background": "", "description": "### 题意\n有一个有 $n$ 个节点的传输数字序列的网络，其中有两种节点：拆分节点和合并节点。拆分节点会将输入序列中的数字交替插入两个输出序列中，合并节点会交替将两个输入序列中的数字插入输出序列中。例如：\n\n$\\{1,2,3,4,5\\}$ 拆分得 $\\{1,3,5\\}$ 和 $\\{2,4\\}$。\n\n$\\{2,4\\}$ 和 $\\{1,3,5\\}$ 合并得 $\\{2,1,4,3,5\\}$。\n\n在网络中，除 $1$ 号外每一个结点的每一个输入端都连接着另一个节点的输出端,$1$ 号节点的输入端为总输入端，每一个输出端不一定连接着另一个节点的输入端。每一个输出端都有着从 $2$ 开始的正整数编号。\n\n将一个数字序列 $\\{1,2,\\cdots,m\\}$ 从 $1$ 号节点的输入端输入网络，你需要求出编号为  $x$ 的输出端输出的序列中的第 $k$ 个数字。", "inputFormat": "第一行三个整数 $n,m,q$。分别表示结点的个数、输入序列为 $\\{1,2,\\cdots,m\\}$、查询的次数。\n\n接下来 $n$ 行，每行一个字母开头，接着是三个整数 $x,y,z$。若字母为 $S$，则表示这是一个拆分节点，$x$ 是它的输入端所连接的输出端编号，$y,z$ 是它的两个输出端的编号；若字母为 $M$，则表示这是一个合并节点，$x,y$ 是它的两个输入端所连接的输出端的编号，$z$ 是它的输出端编号。\n\n再接下来 $q$ 行，每行两个整数 $x,k$，意义如题意中所述。", "outputFormat": "对于每一次询问，输出其对应的回答。若答案不存在，输出 `none`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9449", "type": "P", "difficulty": 7, "samples": [["4\n3 2 3 4\n0 10 1\n0 3 6\n0 2 7\n", "169"], ["8\n3 4 2 5\n2 3 8\n0 -3 9\n0 -5 -7\n2 6 7\n0 1 4\n0 -3 -1\n0 1 4\n", "314"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "ICPC", "WF"], "title": "[ICPC 2021 WF] Take On Meme", "background": "", "description": "The Internet can be so fickle. You work for a small ad agency, Mimi's Mammoth Memes. Your ad campaigns are very cheap, and rely on the hope of producing the next hit viral meme. Unfortunately, the last four hundred or so memes have failed to take off, despite having been precisely engineered to appeal to every single person on Earth. You're not sure what exactly went wrong, but you've decided to try a new approach: crowd sourcing!\n\nAccording to your scientific meme theory, all memes can be rated from $-\\infty$ to $\\infty$ on two scales: xanthochromism, and yellowishness, also known as ($x$, $y$) values. Obviously (you think), the best memes are memorable for being particularly xanthochromic, yellowish, unxanthochromic, or unyellowish. You feel that the \"quality\" of any meme is directly measurable as its squared Euclidean distance ($x^2 + y^2$) from the Base Meme ($0$, $0$), otherwise known as All Your Base.\n\nTo produce the ultimate viral meme, you'll be taking your company's last few failed memes and throwing them into a tournament, decided by online voting. The tournament can be represented as a rooted tree. Input memes come in at the leaves, and at each internal node, a vote will be held among its $k$ child memes ($x_1$, $y_1$), $\\ldots$, ($x_k$, $y_k$). After the vote, all the memes will be horrifically mangled and merged into a brand new meme, specifically calculated to emphasize the winner and de-emphasize all the losers: the resultant $x$ value will be $$ \\sum_{i=1}^{k} w_i \\cdot x_i, $$ where $w_i$ is $1$ if the $i^{th}$ child won, and $-1$ otherwise. The $y$ value is computed similarly. This new meme will move on to the next vote in the tournament $-$ or, if there is no parent, it will be declared the champion and the ultimate meme!\n\nYou already have the structure of the tournament planned out, including all the input memes and the internal voting nodes. What is the largest possible quality for any meme that the tournament could produce?", "inputFormat": "The first line of input contains an integer $n$ ($1 \\leq n \\leq 10^4$), giving the total number of nodes in the tournament tree. The next $n$ lines each describe a single tree node indexed from $1$ to $n$. The line for node $i$ starts with an integer $k_i$ ($0 \\leq k_i \\leq 100$), the number of children of that node. If $k_i$ is $0$, then node $i$ is an input meme and there will be two more integers $x_i$ and $y_i$ ($-10^3 \\leq x_i, yi \\leq 10^3$) describing it. If $k_i &gt; 0$, then $k_i$ different integers $j$ ($i &lt; j \\leq n$) will follow, giving the indices of the $k_i$ nodes entering this voting step.\n\nAll input memes will eventually be merged into the final output meme at node $1$. The complete tree will have a height of no more than $10$.", "outputFormat": "Output the largest possible quality for the champion meme at node $1$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Take On Meme", "background": "", "description": "The Internet can be so fickle. You work for a small ad agency, Mimi's Mammoth Memes. Your ad campaigns are very cheap, and rely on the hope of producing the next hit viral meme. Unfortunately, the last four hundred or so memes have failed to take off, despite having been precisely engineered to appeal to every single person on Earth. You're not sure what exactly went wrong, but you've decided to try a new approach: crowd sourcing!\n\nAccording to your scientific meme theory, all memes can be rated from $-\\infty$ to $\\infty$ on two scales: xanthochromism, and yellowishness, also known as ($x$, $y$) values. Obviously (you think), the best memes are memorable for being particularly xanthochromic, yellowish, unxanthochromic, or unyellowish. You feel that the \"quality\" of any meme is directly measurable as its squared Euclidean distance ($x^2 + y^2$) from the Base Meme ($0$, $0$), otherwise known as All Your Base.\n\nTo produce the ultimate viral meme, you'll be taking your company's last few failed memes and throwing them into a tournament, decided by online voting. The tournament can be represented as a rooted tree. Input memes come in at the leaves, and at each internal node, a vote will be held among its $k$ child memes ($x_1$, $y_1$), $\\ldots$, ($x_k$, $y_k$). After the vote, all the memes will be horrifically mangled and merged into a brand new meme, specifically calculated to emphasize the winner and de-emphasize all the losers: the resultant $x$ value will be $$ \\sum_{i=1}^{k} w_i \\cdot x_i, $$ where $w_i$ is $1$ if the $i^{th}$ child won, and $-1$ otherwise. The $y$ value is computed similarly. This new meme will move on to the next vote in the tournament $-$ or, if there is no parent, it will be declared the champion and the ultimate meme!\n\nYou already have the structure of the tournament planned out, including all the input memes and the internal voting nodes. What is the largest possible quality for any meme that the tournament could produce?", "inputFormat": "The first line of input contains an integer $n$ ($1 \\leq n \\leq 10^4$), giving the total number of nodes in the tournament tree. The next $n$ lines each describe a single tree node indexed from $1$ to $n$. The line for node $i$ starts with an integer $k_i$ ($0 \\leq k_i \\leq 100$), the number of children of that node. If $k_i$ is $0$, then node $i$ is an input meme and there will be two more integers $x_i$ and $y_i$ ($-10^3 \\leq x_i, yi \\leq 10^3$) describing it. If $k_i &gt; 0$, then $k_i$ different integers $j$ ($i &lt; j \\leq n$) will follow, giving the indices of the $k_i$ nodes entering this voting step.\n\nAll input memes will eventually be merged into the final output meme at node $1$. The complete tree will have a height of no more than $10$.", "outputFormat": "Output the largest possible quality for the champion meme at node $1$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Take On Meme", "background": "", "description": "众所周知，互联网的走红规律总是难以捉摸。你就职于一家名为 Mimi's Mammoth Memes 的小型广告公司。你们的广告策略非常经济实惠，全靠碰运气，使得下一个爆红的病毒式梗图诞生。然而，尽管你们精心设计过，最近的四百多个梗图却无一火爆。你对问题的具体原因并不十分清楚，但决定尝试一种全新的方法：众包创意！\n\n根据你的梗图科学理论，所有梗图都可以在两个维度上被评分，分别是鲜艳度和泛黄程度，简称为 $(x, y)$ 值。显然（你这样认为），最出众的梗图要么特别鲜艳，要么特别不鲜艳，要么特别泛黄，要么特别不泛黄。你认为，一个梗图的“质量”可以直接通过它和基础梗图 $(0, 0)$ 的欧几里得距离平方来衡量，即计算 $(x^2 + y^2)$。\n\n为了创造出终极病毒式梗图，你将把公司最近几个不成功的梗图放入一个通过在线投票来决胜负的锦标赛中。这个锦标赛可以用一棵有根树来表示。输入梗图位于叶子节点，在每个内部节点，针对其 $k$ 个子梗图 $(x_1, y_1),\\cdots, (x_k, y_k)$ 进行投票。投票后，梗图将经历恐怖的扭曲并合并成一个新梗图，特别突出了胜者并削弱了所有的败者：得到的 $x$ 值为 \n\n$$ \\sum_{i=1}^{k} w_i \\cdot x_i, $$ \n\n其中当第 $i$ 个梗图获胜时，$w_i$ 为 $1$，否则为 $-1$。$y$ 值的计算方式相同。该新梗图将进入锦标赛下一轮的投票——如果它没有父节点，则会被宣布为冠军，也就是最终的完美梗图！\n\n你已经设计好了锦标赛的结构，包括所有输入的梗图和内部的投票节点。那么，该锦标赛可能产生的梗图质量的最大值是多少？", "inputFormat": "输入的第一行包含一个整数 $n$ ($1 \\leq n \\leq 10^4$)，表示锦标赛树中的节点总数。接下来的 $n$ 行，每行描述一个编号从 $1$ 到 $n$ 的节点。对于节点 $i$，这一行先出现一个整数 $k_i$ ($0 \\leq k_i \\leq 100$)，表示该节点的子节点数。如果 $k_i$ 为 0，则表明节点 $i$ 是一个输入梗图，并包含两个额外整数 $x_i$ 和 $y_i$ ($-10^3 \\leq x_i, y_i \\leq 10^3$)，描述该梗图的特征值。如果 $k_i > 0$，则接下来会出现 $k_i$ 个不同的整数 $j$ ($i < j \\leq n$)，表示参与这一投票步骤的节点索引。\n\n所有输入的梗图将最终被合并为节点 $1$ 中的最终输出梗图。整个树的高度不会超过 $10$。", "outputFormat": "输出节点 $1$ 的冠军梗图的最大可能质量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9450", "type": "P", "difficulty": 5, "samples": [["5 5\n....X\n.X...\n.....\nX..X.\n..X..\n", "9.960000000\n18\n(1,4) (4,5)\n"], ["5 1\n..XX.\n", "4.600000000\n7\n(1,1) (5,1)\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "Special Judge", "ICPC", "WF"], "title": "[ICPC 2021 WF] Where Am I?", "background": "", "description": "Who am I? What am I? Why am I? These are all difficult questions that have kept philosophers reliably busy over the past millennia. But when it comes to \"Where am I\", then, well, modern smartphones and GPS satellites have pretty much taken the excitement out of that question.\n\nTo add insult to the injury of newly unemployed spatial philosophers formerly pondering the \"where\" question, the Instant Cartographic Positioning Company (ICPC) has decided to run a demonstration of just how much more powerful a GPS is compared to old-fashioned maps. Their argument is that maps are useful only if you already know where you are, but much less so if you start at an unknown location.\n\nFor this demonstration, the ICPC has created a test area that is arranged as an unbounded Cartesian grid. Most grid cells are empty, but a finite number of cells have a marker at their center (see Figure L.1(a) for an example with five marked cells). All empty grid cells look the same, and all cells with markers look the same. Suppose you are given a map of the test area (that is, the positions of all the markers), and you are placed at an (unknown to you) grid cell. How long will it take you to find out where you actually are? ICPC's answer is clear: potentially a very, very long time, while a GPS would give you the answer instantly. But how long exactly?\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ydxjurja.png)\n\nFigure L.1: Sample grid and the order in which test subjects explore the grid.\n\nIn the trial, test subjects will explore their environment by following an expanding clockwise spiral whose first few steps are shown in Figure L.1(b). The starting cell is labeled \"0\", and the numbers show the order in which other cells are visited. The test subjects can see a marker only if they are at its grid cell, and they will stop their exploration as soon as they know where they are based on the grid cells that they have seen so far. That means that the observed sequence of empty and marked grid cells could have begun only at a single possible starting position. The grid is unbounded, but the exploration will be finite since once a test subject has seen all markers on the grid, they'll definitely know where they are.\n\nHaving hundreds of test subjects literally running in circles can be expensive, so the ICPC figures that writing a simulation will be cheaper and faster. Maybe you can help?", "inputFormat": "The input describes a single grid. It starts with a line containing two integers $d_x$ , $d_y$ ($1 \\leq d_x, d_y \\leq 100$). The following $d_y$ lines contain $d_x$ characters each, and describe part of the test grid. The $i^{th}$ character of the $j^{th}$ line of this grid description specifies the contents of the grid cell at coordinate ($i$, $d_y-j+1$). The character is either '$\\texttt{.}$' or '$\\texttt{X}$', meaning that the cell is either empty, or contains a marker, respectively.\n\nThe total number of markers in the grid will be between $1$ and $100$, inclusive. All grid cells outside the range described by the input are empty.", "outputFormat": "\nIn ICPC's experiment, a test subject knows they will start at some position ($x$, $y$) with $1 \\leq x \\leq d_x$, $1 \\leq y \\leq d_y$.\n\nOutput three lines. The first line should have the expected number of steps needed to identify the starting position, assuming that the starting position is chosen uniformly at random. This number needs to be exact to within an absolute error of $10^{-3}$.\n\nThe second line should have the maximum number of steps necessary until one can identify the starting position.\n\nThe third line should list all starting coordinates ($x$, $y$) that require that maximum number of steps. The coordinates should be sorted by increasing $y$-coordinates, and then (if the $y$-coordinates are the same) by increasing $x$-coordinates.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 WF] Where Am I?", "background": "", "description": "Who am I? What am I? Why am I? These are all difficult questions that have kept philosophers reliably busy over the past millennia. But when it comes to \"Where am I\", then, well, modern smartphones and GPS satellites have pretty much taken the excitement out of that question.\n\nTo add insult to the injury of newly unemployed spatial philosophers formerly pondering the \"where\" question, the Instant Cartographic Positioning Company (ICPC) has decided to run a demonstration of just how much more powerful a GPS is compared to old-fashioned maps. Their argument is that maps are useful only if you already know where you are, but much less so if you start at an unknown location.\n\nFor this demonstration, the ICPC has created a test area that is arranged as an unbounded Cartesian grid. Most grid cells are empty, but a finite number of cells have a marker at their center (see Figure L.1(a) for an example with five marked cells). All empty grid cells look the same, and all cells with markers look the same. Suppose you are given a map of the test area (that is, the positions of all the markers), and you are placed at an (unknown to you) grid cell. How long will it take you to find out where you actually are? ICPC's answer is clear: potentially a very, very long time, while a GPS would give you the answer instantly. But how long exactly?\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ydxjurja.png)\n\nFigure L.1: Sample grid and the order in which test subjects explore the grid.\n\nIn the trial, test subjects will explore their environment by following an expanding clockwise spiral whose first few steps are shown in Figure L.1(b). The starting cell is labeled \"0\", and the numbers show the order in which other cells are visited. The test subjects can see a marker only if they are at its grid cell, and they will stop their exploration as soon as they know where they are based on the grid cells that they have seen so far. That means that the observed sequence of empty and marked grid cells could have begun only at a single possible starting position. The grid is unbounded, but the exploration will be finite since once a test subject has seen all markers on the grid, they'll definitely know where they are.\n\nHaving hundreds of test subjects literally running in circles can be expensive, so the ICPC figures that writing a simulation will be cheaper and faster. Maybe you can help?", "inputFormat": "The input describes a single grid. It starts with a line containing two integers $d_x$ , $d_y$ ($1 \\leq d_x, d_y \\leq 100$). The following $d_y$ lines contain $d_x$ characters each, and describe part of the test grid. The $i^{th}$ character of the $j^{th}$ line of this grid description specifies the contents of the grid cell at coordinate ($i$, $d_y-j+1$). The character is either '$\\texttt{.}$' or '$\\texttt{X}$', meaning that the cell is either empty, or contains a marker, respectively.\n\nThe total number of markers in the grid will be between $1$ and $100$, inclusive. All grid cells outside the range described by the input are empty.", "outputFormat": "\nIn ICPC's experiment, a test subject knows they will start at some position ($x$, $y$) with $1 \\leq x \\leq d_x$, $1 \\leq y \\leq d_y$.\n\nOutput three lines. The first line should have the expected number of steps needed to identify the starting position, assuming that the starting position is chosen uniformly at random. This number needs to be exact to within an absolute error of $10^{-3}$.\n\nThe second line should have the maximum number of steps necessary until one can identify the starting position.\n\nThe third line should list all starting coordinates ($x$, $y$) that require that maximum number of steps. The coordinates should be sorted by increasing $y$-coordinates, and then (if the $y$-coordinates are the same) by increasing $x$-coordinates.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 WF] Where Am I?", "background": "", "description": "我是谁？我是什么？我为什么存在？这些都是让哲学家们在过去的千年里一直忙碌的问题。但是当谈到“我在哪里”时，现代智能手机和 GPS 卫星几乎已经让这个问题失去了吸引力。\n\n为了给那些曾经思考“我在哪里”问题的空间哲学家们再添一层伤害，“即时制图定位公司”（ICPC）决定进行一次演示，以展示 GPS 比传统地图强大得多。他们的论点是，地图只有在你已经知道自己在哪里时才有用，但如果你从一个未知位置开始，地图的用处就小得多了。\n\n在这次演示中，ICPC 创建了一个测试区域，该区域被布置成一个无限的笛卡尔网格。大多数网格单元是空的，但有限数量的单元在其中心有一个标记（参见图 L.1(a) 中的五个标记单元的示例）。所有空网格单元看起来都一样，所有带标记的单元也看起来都一样。假设你得到了测试区域的地图（即所有标记的位置），并且你被放置在一个（你不知道的）网格单元上。你需要多长时间才能找到你实际所在的位置？ICPC 的答案很明确：可能需要很长很长的时间，而 GPS 会立即给你答案。但究竟需要多长时间呢？\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ydxjurja.png)\n\n在试验中，测试对象将通过遵循一个顺时针扩展的螺旋形来探索他们的环境，其前几步如图 L.1(b) 所示。起始单元标记为“0”，数字显示了访问其他单元的顺序。测试对象只有在其网格单元上才能看到标记，并且一旦他们根据迄今为止看到的网格单元知道自己在哪里，他们就会停止探索。这意味着观察到的空和标记网格单元的序列只能从一个可能的起始位置开始。网格是无限的，但探索将是有限的，因为一旦测试对象看到了网格上的所有标记，他们就一定知道自己在哪里。\n\n让数百名测试对象字面意义上地绕圈跑可能会很昂贵，所以 ICPC 认为编写一个模拟程序会更便宜更快。也许你可以帮忙？", "inputFormat": "输入描述一个单一的网格。首先是一行包含两个整数 $d_x$ 和 $d_y$ ($1 \\leq d_x, d_y \\leq 100$)。接下来的 $d_y$ 行每行包含 $d_x$ 个字符，描述测试网格的一部分。网格描述的第 $j$ 行的第 $i$ 个字符指定了坐标 ($i$, $d_y-j+1$) 处网格单元的内容。字符要么是 '$\\texttt{.}$'，要么是 '$\\texttt{X}$'，分别表示单元是空的或者包含一个标记。\n\n网格中的标记总数将在 $1$ 到 $100$ 之间（含）变化。输入描述范围之外的所有网格单元都是空的。", "outputFormat": "在 ICPC 的实验中，测试对象知道他们将从某个位置 ($x$, $y$) 开始，其中 $1 \\leq x \\leq d_x$，$1 \\leq y \\leq d_y$。\n\n输出三行。第一行应包含识别起始位置所需的期望步数，假设起始位置是均匀随机选择的。这个数字需要精确到绝对误差 $10^{-3}$ 以内。\n\n第二行应包含识别起始位置所需的最大步数。\n\n第三行应列出所有需要最大步数的起始坐标 ($x$, $y$)。坐标应按 $y$ 坐标递增排序，如果 $y$ 坐标相同，则按 $x$ 坐标递增排序。", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9451", "type": "P", "difficulty": 2, "samples": [["3\n1\n4\n6", "2\n5\n8"], ["1\n7", "No,Commander"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["位运算"], "title": "[ZSHOI-R1] 新概念报数", "background": "Div.2 A 要什么背景？", "description": "现在 Xttttr 和他的 npy 玩起了报数游戏，但是他们非常喜欢 $2$ 这个数字，于是制定了如下规则：\n\n- 如果一个数 $a$ 满足 $\\operatorname{popcount}(a) \\geq 3$，那么这个数字是非法的，对方需要回答 ``No,Commander``。\n- 否则，这个数是合法的，对方需要回答下一个合法的数。\n\n坐在旁边的你当然不知道游戏的乐趣，你只想知道某次报数之后对方应该回答什么。", "inputFormat": "第一行一个正整数 $T$，表示询问的次数。\n\n后面 $T$ 行，每行一个自然数 $a$，表示这次询问中某一方报出的数字。\n", "outputFormat": "$T$ 行，每行一个正整数或字符串，表示本次询问中对方所应该回答的。", "hint": "对于 $20\\%$ 的数据，保证 $T\\leq 100$，$a \\leq 10^4$。\n\n对于另外 $20\\%$ 的数据，保证 $a$ 是合法的数字。\n\n对于另外 $20\\%$ 的数据，保证 $a$ 在值域内均匀随机。\n\n对于 $100\\%$ 的数据，$1\\leq T \\leq 10^5$，$0\\leq a<2^{63}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZSHOI-R1] 新概念报数", "background": "Div.2 A 要什么背景？", "description": "现在 Xttttr 和他的 npy 玩起了报数游戏，但是他们非常喜欢 $2$ 这个数字，于是制定了如下规则：\n\n- 如果一个数 $a$ 满足 $\\operatorname{popcount}(a) \\geq 3$，那么这个数字是非法的，对方需要回答 ``No,Commander``。\n- 否则，这个数是合法的，对方需要回答下一个合法的数。\n\n坐在旁边的你当然不知道游戏的乐趣，你只想知道某次报数之后对方应该回答什么。", "inputFormat": "第一行一个正整数 $T$，表示询问的次数。\n\n后面 $T$ 行，每行一个自然数 $a$，表示这次询问中某一方报出的数字。\n", "outputFormat": "$T$ 行，每行一个正整数或字符串，表示本次询问中对方所应该回答的。", "hint": "对于 $20\\%$ 的数据，保证 $T\\leq 100$，$a \\leq 10^4$。\n\n对于另外 $20\\%$ 的数据，保证 $a$ 是合法的数字。\n\n对于另外 $20\\%$ 的数据，保证 $a$ 在值域内均匀随机。\n\n对于 $100\\%$ 的数据，$1\\leq T \\leq 10^5$，$0\\leq a<2^{63}$。", "locale": "zh-CN"}}}
{"pid": "P9452", "type": "P", "difficulty": 5, "samples": [["3\n1 2 3", "5\nA B\nA B\nA C\nB C\nB C"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["Special Judge"], "title": "[ZSHOI-R1] 河外塔（加强版）", "background": "河内塔（又称汉诺塔）问题，就是在一块木板上有三个立柱，在柱 1 上放着三个圆盘，小的在上面，大的在下面（初始状态）。让被试将在柱 1 上的三个圆盘移到柱 3 上面（目标状态）。条件是：每次只能移动任何一个柱子上面的一个圆盘，但大的圆盘不能放在小的圆盘上。\n\n通用问题解决者的解决过程即是手段——目的分析的策略。", "description": "但是，你可能没有听过河外塔问题。虽然但是，好像并没有河外塔问题。于是，伟大的 X_Xy 决定创造一个河外塔问题。\n\n既然是河内塔问题的延申，就得有些一样的东西：有三个柱子 \n$A$，$B$ 和 $C$ ，以及 $n$ 个圆盘，其中编号为 $i$ 的圆盘的半径长为 $i$，这些圆盘最开始都在 $A$ 上，最终都要顺序（即从上往下从小到大）地移到 $C$ 上。\n\n既然是河内塔问题的延伸，就得有些不同的东西：最开始在 $A$ 上面的圆盘并不是顺序的，由于这个限制，我们也不在意移动过程中的顺序，也就意味着你可以将一个大的圆盘放在小的圆盘上。\n\n但是 X_Xy 很懒，他只想让你操作至多 $10^6$ 次。", "inputFormat": "输入共两行。\n\n第一行有一个数 $n$，表示圆盘的数量。\n\n第二行有 $n$ 个数，表示 $A$ 上所有的圆盘**从上往下**的标号，保证圆盘构成一个 $1\\sim n$ 的排列。", "outputFormat": "共若干行。\n\n第一行有一个数 $tot$，表示你的操作数。\n\n接下来的第 $2$ 到第 $tot$ 行，每行两个用空格隔开的大写字母，第 $i+1$ 行表示你的第 $i$ 次操作是从某立柱移到了另一个上。", "hint": "对于所有数据点：$1\\leqslant n \\leqslant 4\\times 10^4$\n\n| 数据点 | n |\n| :----------: | :----------: |\n| 1~2 | $\\leqslant 10$ |\n| 3~4 | $\\leqslant 200$ |\n| 5~7 | $\\leqslant 3\\times 10^4 $ |\n| 8~10 | $\\leqslant 4\\times 10^4 $ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZSHOI-R1] 河外塔（加强版）", "background": "河内塔（又称汉诺塔）问题，就是在一块木板上有三个立柱，在柱 1 上放着三个圆盘，小的在上面，大的在下面（初始状态）。让被试将在柱 1 上的三个圆盘移到柱 3 上面（目标状态）。条件是：每次只能移动任何一个柱子上面的一个圆盘，但大的圆盘不能放在小的圆盘上。\n\n通用问题解决者的解决过程即是手段——目的分析的策略。", "description": "但是，你可能没有听过河外塔问题。虽然但是，好像并没有河外塔问题。于是，伟大的 X_Xy 决定创造一个河外塔问题。\n\n既然是河内塔问题的延申，就得有些一样的东西：有三个柱子 \n$A$，$B$ 和 $C$ ，以及 $n$ 个圆盘，其中编号为 $i$ 的圆盘的半径长为 $i$，这些圆盘最开始都在 $A$ 上，最终都要顺序（即从上往下从小到大）地移到 $C$ 上。\n\n既然是河内塔问题的延伸，就得有些不同的东西：最开始在 $A$ 上面的圆盘并不是顺序的，由于这个限制，我们也不在意移动过程中的顺序，也就意味着你可以将一个大的圆盘放在小的圆盘上。\n\n但是 X_Xy 很懒，他只想让你操作至多 $10^6$ 次。", "inputFormat": "输入共两行。\n\n第一行有一个数 $n$，表示圆盘的数量。\n\n第二行有 $n$ 个数，表示 $A$ 上所有的圆盘**从上往下**的标号，保证圆盘构成一个 $1\\sim n$ 的排列。", "outputFormat": "共若干行。\n\n第一行有一个数 $tot$，表示你的操作数。\n\n接下来的第 $2$ 到第 $tot$ 行，每行两个用空格隔开的大写字母，第 $i+1$ 行表示你的第 $i$ 次操作是从某立柱移到了另一个上。", "hint": "对于所有数据点：$1\\leqslant n \\leqslant 4\\times 10^4$\n\n| 数据点 | n |\n| :----------: | :----------: |\n| 1~2 | $\\leqslant 10$ |\n| 3~4 | $\\leqslant 200$ |\n| 5~7 | $\\leqslant 3\\times 10^4 $ |\n| 8~10 | $\\leqslant 4\\times 10^4 $ |", "locale": "zh-CN"}}}
{"pid": "P9453", "type": "P", "difficulty": 5, "samples": [["7 3\n6 7 6 6 6 5 4\n6 6 6", "7"], ["8 6\n4 4 2 2 4 4 2 2\n4 4 4 4 2 2", "2"], ["8 7\n3 3 3 2 2 2 1 1\n3 3 3 2 2 2 1", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "[ZSHOI-R1] 有效打击", "background": "打腻了原版的 Boss，FyFive 决定做一个 Hollow Knight Mod Boss，名字叫“成功冠军”。", "description": "和原本的失败冠军类似，成功冠军也有一个不能回魂的大盔甲。但是成功冠军更难的地方在于：它的盔甲需要以特定的打击方式才能造成伤害，可以造成伤害的打击序列被称作“有效打击”。\n\n作为 Mod Boss 的设计者，FyFive 设置了一个可以造成有效打击的“标准序列”。为了降低操作难度，当打击顺序与标准序列“相似”时，即可造成有效打击。在这里“相似”的定义是，对于一个打击序列，将所有相同打击的连续段的长度同时进行放缩，可以得到另一个序列，则称这两个序列是“相似”的。\n\n例如：\n- ``112244`` 和 ``111222444`` 是相似的，\n- ``111333`` 和 ``13`` 也是相似的，\n- ``226`` 和 ``226`` 也是相似的，\n- ``33889`` 和 ``33388899`` 则不是相似的。\n\n由于 Boss 还处在调整标准序列的阶段，所以 FyFive 将 Boss 的血量调到了无穷大，但这样他就没办法通过比较初始血量和最终血量来计算他的打击序列在当前标准序列下能造成多少次有效打击，所以请万能的你来帮帮 FyFive 吧！\n\n**注意**：对于可能出现的同时造成多次有效打击的情况，会造成多次有效打击，比如当打击序列为 ``11`` 时，若标准序列为 ``1``，则这个打击序列会造成 $3$ 次有效打击，因为第一个 ``1`` 和第二个 ``1`` 均与标准序列相似，同时 ``11`` 也与标准序列相似。若标准序列为 ``11``则也有 $3$ 次有效打击。若标准序列为 ``12``，则不会造成有效打击。同理，当打击序列为 ``6666``，标准序列为 ``66`` 时，则一共会造成 $10$ 次有效打击。\n\n#### 形式化的，\n>定义：若序列 $\\Alpha$ 为 \n> $$\\underbrace{AA...A}_{a_1个}\\underbrace{BB...B}_{a_2个}\\underbrace{CC...C}_{a_3个}...$$\n> 序列 $\\Beta$ 为 \n> $$\\underbrace{AA...A}_{b_1个}\\underbrace{BB...B}_{b_2个}\\underbrace{CC...C}_{b_3个}...$$\n> 其中 $A,B,C,a_1,a_2,a_3,...,b_1,b_2,b_3,...\\in N_+$。\n>\n> 若有 $\\frac{a_1}{b_1}=\\frac{a_2}{b_2}=\\frac{a_3}{b_3}=...=k\\ , k>0$，则称 $\\Alpha$ 与 $\\Beta$ 互为相似序列。\n>\n> 特别的，长度为 $0$ 的序列不与任何序列成相似序列。\n>\n> 不难证明此定义下序列间的相似具有传递性。\n\n求给定的序列 $A$ 中有多少个子串与给定序列 $B$ 互为相似序列。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数，表示打击序列 $A$，数之间用空格隔开。\n\n第三行 $m$ 个整数，表示标准序列 $B$，数之间用空格隔开。", "outputFormat": "一行一个正整数，表示造成的有效打击总数。", "hint": "数据范围：\n\n| 数据点 | n | m | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| 1~2 | $\\leq 20000$ | $\\leq 20000$ | 无 |\n| 3~4 | $\\leq 5 \\times 10^6$ | $\\leq 5 \\times 10^6$ | A |\n| 5~6 | $\\leq 5 \\times 10^6$ | $\\leq 5 \\times 10^6$ | B |\n| 7~10 | $\\leq 5 \\times 10^6$ | $\\leq 5 \\times 10^6$ | C |\n\n对于 $100\\%$ 的数据，保证有 $\\forall\\ i\\in[1,n]$，$1\\leq A_i \\leq 7$；$\\forall\\ i\\in[1,m]$，$1\\leq B_i\\leq 7$。\n\n对于 $100\\%$ 的数据，保证 $1\\leq n,m\\leq 5 \\times 10^6$。\n\n特殊性质 A：保证 $\\forall\\ i,j\\in [1,m]，B_i=B_j$。\n\n特殊性质 B：保证有且仅有一个 $k\\in[1,m-1]$，使得 $\\forall \\ i,j\\in[1,k]$，$B_i=B_j$；$\\forall \\ i,j\\in[k+1,m]$，$B_i=B_j$。\n\n特殊性质 C：保证第 $10$ 个点中 $n,m \\leq 5\\times 10^5$，且其他点中连续段仅有不超过 $100$ 种不同的长度。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZSHOI-R1] 有效打击", "background": "打腻了原版的 Boss，FyFive 决定做一个 Hollow Knight Mod Boss，名字叫“成功冠军”。", "description": "和原本的失败冠军类似，成功冠军也有一个不能回魂的大盔甲。但是成功冠军更难的地方在于：它的盔甲需要以特定的打击方式才能造成伤害，可以造成伤害的打击序列被称作“有效打击”。\n\n作为 Mod Boss 的设计者，FyFive 设置了一个可以造成有效打击的“标准序列”。为了降低操作难度，当打击顺序与标准序列“相似”时，即可造成有效打击。在这里“相似”的定义是，对于一个打击序列，将所有相同打击的连续段的长度同时进行放缩，可以得到另一个序列，则称这两个序列是“相似”的。\n\n例如：\n- ``112244`` 和 ``111222444`` 是相似的，\n- ``111333`` 和 ``13`` 也是相似的，\n- ``226`` 和 ``226`` 也是相似的，\n- ``33889`` 和 ``33388899`` 则不是相似的。\n\n由于 Boss 还处在调整标准序列的阶段，所以 FyFive 将 Boss 的血量调到了无穷大，但这样他就没办法通过比较初始血量和最终血量来计算他的打击序列在当前标准序列下能造成多少次有效打击，所以请万能的你来帮帮 FyFive 吧！\n\n**注意**：对于可能出现的同时造成多次有效打击的情况，会造成多次有效打击，比如当打击序列为 ``11`` 时，若标准序列为 ``1``，则这个打击序列会造成 $3$ 次有效打击，因为第一个 ``1`` 和第二个 ``1`` 均与标准序列相似，同时 ``11`` 也与标准序列相似。若标准序列为 ``11``则也有 $3$ 次有效打击。若标准序列为 ``12``，则不会造成有效打击。同理，当打击序列为 ``6666``，标准序列为 ``66`` 时，则一共会造成 $10$ 次有效打击。\n\n#### 形式化的，\n>定义：若序列 $\\Alpha$ 为 \n> $$\\underbrace{AA...A}_{a_1个}\\underbrace{BB...B}_{a_2个}\\underbrace{CC...C}_{a_3个}...$$\n> 序列 $\\Beta$ 为 \n> $$\\underbrace{AA...A}_{b_1个}\\underbrace{BB...B}_{b_2个}\\underbrace{CC...C}_{b_3个}...$$\n> 其中 $A,B,C,a_1,a_2,a_3,...,b_1,b_2,b_3,...\\in N_+$。\n>\n> 若有 $\\frac{a_1}{b_1}=\\frac{a_2}{b_2}=\\frac{a_3}{b_3}=...=k\\ , k>0$，则称 $\\Alpha$ 与 $\\Beta$ 互为相似序列。\n>\n> 特别的，长度为 $0$ 的序列不与任何序列成相似序列。\n>\n> 不难证明此定义下序列间的相似具有传递性。\n\n求给定的序列 $A$ 中有多少个子串与给定序列 $B$ 互为相似序列。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数，表示打击序列 $A$，数之间用空格隔开。\n\n第三行 $m$ 个整数，表示标准序列 $B$，数之间用空格隔开。", "outputFormat": "一行一个正整数，表示造成的有效打击总数。", "hint": "数据范围：\n\n| 数据点 | n | m | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| 1~2 | $\\leq 20000$ | $\\leq 20000$ | 无 |\n| 3~4 | $\\leq 5 \\times 10^6$ | $\\leq 5 \\times 10^6$ | A |\n| 5~6 | $\\leq 5 \\times 10^6$ | $\\leq 5 \\times 10^6$ | B |\n| 7~10 | $\\leq 5 \\times 10^6$ | $\\leq 5 \\times 10^6$ | C |\n\n对于 $100\\%$ 的数据，保证有 $\\forall\\ i\\in[1,n]$，$1\\leq A_i \\leq 7$；$\\forall\\ i\\in[1,m]$，$1\\leq B_i\\leq 7$。\n\n对于 $100\\%$ 的数据，保证 $1\\leq n,m\\leq 5 \\times 10^6$。\n\n特殊性质 A：保证 $\\forall\\ i,j\\in [1,m]，B_i=B_j$。\n\n特殊性质 B：保证有且仅有一个 $k\\in[1,m-1]$，使得 $\\forall \\ i,j\\in[1,k]$，$B_i=B_j$；$\\forall \\ i,j\\in[k+1,m]$，$B_i=B_j$。\n\n特殊性质 C：保证第 $10$ 个点中 $n,m \\leq 5\\times 10^5$，且其他点中连续段仅有不超过 $100$ 种不同的长度。", "locale": "zh-CN"}}}
{"pid": "P9454", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2\n2 3", "1 2 3 \n"], ["4 3\n1 2\n2 3\n2 4\n", "1 2 499122180 499122180 \n"], ["5 7\n5 4\n2 4\n4 3\n1 3\n1 2\n1 4\n1 5\n", "1 249561092 249561092 249561091 249561092 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "期望"], "title": "[ZSHOI-R1] 巡城", "background": "在 X 国国王多年的建设之下，她的国家发生了质的蜕变，从众多 $n$ 座城市却只有 $n-1$ 条道路的国家中脱颖而出。也就是说，X 国不再是一棵树了，而是一张图。", "description": "国王为了能够集中自己的权力，稳固城邦，她对国家道路设计要求十分严苛，**任何两个城市之间的路径至多只有一条不经过首都**，虽然但是，没有人知道为什么这样能够更好地稳固 X 国。\n\n有一天，X 国国王决定巡视所有的城市，她通过无线电在巡城前一天向所有的城市通知了这个好消息。热情的群众们也积极地做出了响应，准备迎接国王的到来。\n\n国王一天只能造访一座城市，而且第一天她会从首都开始。\n\n在之后的每一天，她会随机从与她所在城市直接相连的城市中**等概率**地选择一个她**没有前往过的城市**前往。如果不存在这样的城市，她会立即**原路返回**，从她来这个城市的路回去，再重复上述操作，因为有携带宇宙射线的传送门，这个过程**不消耗时间**。\n\n爱戴她的群众们想要知道，他们的国王第一次到达他们所在城市的日期（她造访首都的那一天为 $1$，之后每一天一次加 $1$）的期望是多少，答案对 $998244353$ 取模。\n\n保证城市构成的图是连通图，无自环与重边，且首都编号为 $1$。", "inputFormat": "第一行有两个数 $n,m$，代表X国的城市数和路径数。\n\n接下来的 $m$ 行，每行两个数 $u,v$ 表示城市的一条路径。", "outputFormat": "共 $1$ 行，$n$ 个数。\n\n第 $i$ 个数代表 $i$ 号城市的期望。", "hint": "对于所有的数据点，$1\\leqslant n\\leqslant 5 \\times 10^5$，$1\\leqslant m \\leqslant 6 \\times 10^5$。\n| 数据点 | n | m |\n| :----------: | :----------: | :----------: |\n| 1~2 | $5$ | $7$ |\n| 3~5 | $\\leqslant10^4$ | $n-1$ |\n| 6~8 | $\\leqslant10^4$ | $n$ |\n| 9~10 | $\\leqslant10^4$ | $2n-3$ |\n| 11~15 | $\\leqslant10^4$ | $\\leqslant2\\times10^4$ |\n| 16~20 | $\\leqslant5\\times10^5$ | $\\leqslant6\\times10^5$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZSHOI-R1] 巡城", "background": "在 X 国国王多年的建设之下，她的国家发生了质的蜕变，从众多 $n$ 座城市却只有 $n-1$ 条道路的国家中脱颖而出。也就是说，X 国不再是一棵树了，而是一张图。", "description": "国王为了能够集中自己的权力，稳固城邦，她对国家道路设计要求十分严苛，**任何两个城市之间的路径至多只有一条不经过首都**，虽然但是，没有人知道为什么这样能够更好地稳固 X 国。\n\n有一天，X 国国王决定巡视所有的城市，她通过无线电在巡城前一天向所有的城市通知了这个好消息。热情的群众们也积极地做出了响应，准备迎接国王的到来。\n\n国王一天只能造访一座城市，而且第一天她会从首都开始。\n\n在之后的每一天，她会随机从与她所在城市直接相连的城市中**等概率**地选择一个她**没有前往过的城市**前往。如果不存在这样的城市，她会立即**原路返回**，从她来这个城市的路回去，再重复上述操作，因为有携带宇宙射线的传送门，这个过程**不消耗时间**。\n\n爱戴她的群众们想要知道，他们的国王第一次到达他们所在城市的日期（她造访首都的那一天为 $1$，之后每一天一次加 $1$）的期望是多少，答案对 $998244353$ 取模。\n\n保证城市构成的图是连通图，无自环与重边，且首都编号为 $1$。", "inputFormat": "第一行有两个数 $n,m$，代表X国的城市数和路径数。\n\n接下来的 $m$ 行，每行两个数 $u,v$ 表示城市的一条路径。", "outputFormat": "共 $1$ 行，$n$ 个数。\n\n第 $i$ 个数代表 $i$ 号城市的期望。", "hint": "对于所有的数据点，$1\\leqslant n\\leqslant 5 \\times 10^5$，$1\\leqslant m \\leqslant 6 \\times 10^5$。\n| 数据点 | n | m |\n| :----------: | :----------: | :----------: |\n| 1~2 | $5$ | $7$ |\n| 3~5 | $\\leqslant10^4$ | $n-1$ |\n| 6~8 | $\\leqslant10^4$ | $n$ |\n| 9~10 | $\\leqslant10^4$ | $2n-3$ |\n| 11~15 | $\\leqslant10^4$ | $\\leqslant2\\times10^4$ |\n| 16~20 | $\\leqslant5\\times10^5$ | $\\leqslant6\\times10^5$ |", "locale": "zh-CN"}}}
{"pid": "P9455", "type": "P", "difficulty": 2, "samples": [["10\n2 3\n5 0\n6 3\n7 2\n8 0\n10 0\n13 2\n14 4\n15 4\n18 2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "O2优化", "语言月赛"], "title": "[入门赛 #14] 塔台超频 (Hard Version)", "background": "", "description": "在一条笔直的马路上有 $n$ 个塔台，它们被依次标号为 $1, 2, \\cdots, n$，分别处于距离马路起点 $a _ 1, a _ 2, \\cdots, a _ n$（$a _ 1 < a _ 2 < \\cdots < a _ n$）的位置。\n\n每个塔台初始时有一个通讯半径 $b _ 1, b _ 2, \\cdots, b _ n$，这代表，对于 $i$ 号塔台，其可以与 $[a _ i - b _ i, a _ i + b _ i]$ 范围内的塔台通讯。\n\n需要特别注意，对于两个塔台 A、B，当且仅当 A 塔台的**位置**处在 B 塔台的通讯范围内，B 塔台才能向 A 塔台传递信号。请注意这里不是「二者的通讯范围重合，即可通讯」。\n\n现在你可以对这些塔台进行超频。具体的，你可以指定一个电压 $k$，之后**所有**塔台都会被加上 $k$ 的电压，通讯半径都会增大 $k$。这里的 $k$ 仅可为非负整数。\n\n现在要求你通过超频，使信号可以从 $1$ 号塔台传输到 $n$ 号塔台，路径不限（即，无论如何，只需要让信号从 $1$ 号塔台到达 $n$ 号塔台即可）。但是由于不合理的超频会较严重地磨损塔台，因此你想要尽可能降低超频的电压。\n\n请你计算出，为了达到以上目的，塔台超频需要的最小电压是多少。", "inputFormat": "输入共 $n + 1$ 行。\n\n第一行为一个整数 $n$，代表塔台的数量。  \n接下来 $n$ 行，每行两个整数 $a _ i, b _ i$，分别代表各个塔台的位置和初始通讯半径。", "outputFormat": "输出共一行一个整数，代表为了达到目的，塔台超频需要的最小电压。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $2 \\leq n \\leq 5 \\times 10 ^ 5$，$0 \\leq a _ i, b _ i \\leq 10 ^ 9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[入门赛 #14] 塔台超频 (Hard Version)", "background": "", "description": "在一条笔直的马路上有 $n$ 个塔台，它们被依次标号为 $1, 2, \\cdots, n$，分别处于距离马路起点 $a _ 1, a _ 2, \\cdots, a _ n$（$a _ 1 < a _ 2 < \\cdots < a _ n$）的位置。\n\n每个塔台初始时有一个通讯半径 $b _ 1, b _ 2, \\cdots, b _ n$，这代表，对于 $i$ 号塔台，其可以与 $[a _ i - b _ i, a _ i + b _ i]$ 范围内的塔台通讯。\n\n需要特别注意，对于两个塔台 A、B，当且仅当 A 塔台的**位置**处在 B 塔台的通讯范围内，B 塔台才能向 A 塔台传递信号。请注意这里不是「二者的通讯范围重合，即可通讯」。\n\n现在你可以对这些塔台进行超频。具体的，你可以指定一个电压 $k$，之后**所有**塔台都会被加上 $k$ 的电压，通讯半径都会增大 $k$。这里的 $k$ 仅可为非负整数。\n\n现在要求你通过超频，使信号可以从 $1$ 号塔台传输到 $n$ 号塔台，路径不限（即，无论如何，只需要让信号从 $1$ 号塔台到达 $n$ 号塔台即可）。但是由于不合理的超频会较严重地磨损塔台，因此你想要尽可能降低超频的电压。\n\n请你计算出，为了达到以上目的，塔台超频需要的最小电压是多少。", "inputFormat": "输入共 $n + 1$ 行。\n\n第一行为一个整数 $n$，代表塔台的数量。  \n接下来 $n$ 行，每行两个整数 $a _ i, b _ i$，分别代表各个塔台的位置和初始通讯半径。", "outputFormat": "输出共一行一个整数，代表为了达到目的，塔台超频需要的最小电压。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $2 \\leq n \\leq 5 \\times 10 ^ 5$，$0 \\leq a _ i, b _ i \\leq 10 ^ 9$。", "locale": "zh-CN"}}}
{"pid": "P9456", "type": "P", "difficulty": 2, "samples": [["3 3 3\n1 0 0\n0 0 0\n0 0 0\n1 0 0\n0 0 1\n0 0 1\n0 0 0\n0 1 0\n0 0 0", "0 1 0\n1 1 1\n1 0 0\n0 1 0\n1 0 1\n0 0 1\n0 1 1\n0 1 0\n1 0 0"], ["4 6 3\n0 0 0 0 0 1\n0 0 0 0 0 1\n0 0 1 0 0 0\n0 0 0 0 0 0\n0 1 0 0 0 0\n0 0 1 0 0 1\n0 0 0 0 0 0\n1 0 0 0 0 1\n0 0 0 0 0 0\n0 1 0 0 1 0\n0 0 0 0 0 1\n1 0 0 0 0 1", "0 1 1 1\n1 1 0 1\n1 1 1 0\n1 1 0 0 1 1\n1 0 0 1 1 1\n1 0 0 1 0 0\n1 1 1 1\n0 1 0 0\n0 0 0 0\n0 1 1 0\n1 1 0 0\n0 0 0 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "O2优化", "语言月赛"], "title": "[入门赛 #14] Three-View Projection (Hard Version)", "background": "", "description": "> 全文与 $x, y, z$ 轴/方向有关的内容均基于以下的 $x, y, z$ 轴、位置及观测方向。观测者站在如图所示的位置，正在向着 $y$ 轴（绿线）正方向（箭头方向）观测。  \n> ![](https://cdn.luogu.com.cn/upload/image_hosting/05erek0j.png)\n\n现在有一个长、宽、高（沿 $x, y, z$ 轴延展的长度）为 $n \\text{ cm}, m \\text{ cm}, k \\text{ cm}$ 的长方体区域。我们将这片区域划分为 $n \\times m \\times k$ 个小格子。每个小格子中可以放置一个边长为 $1 \\text{ cm}$ 的小正方体。\n\n我们使用一个整数三元组 $(x, y, z)$ 来表示一个格子在空间中的位置，其代表从左往右数第 $x$ 个，从前往后数第 $y$ 个，从下往上第 $z$ 个格子。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0yu909tc.png)\n\n例如，上图展示的 $3 \\times 3 \\times 3$ 区域中，按照观测者的位置，可以发现红蓝线（$x, z$ 轴）所在的面为前面，蓝绿线（$y, z$ 轴）所在的面为左面，红绿线（$x, y$ 轴）所在的面为下面，五个小正方体的位置分别为 $(1, 1, 1), (1, 1, 2), (2, 3, 2), (3, 3, 2), (2, 2, 3)$。\n\n三视图是观测者从上面（从上往下）、左面（从左往右）、正面（从前往后）三个不同角度观察同一个空间几何体而画出的图形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p72x1i3q.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6ucamb9o.png)\n\n例如，以上是示例区域的三视图。\n\n现在，给定一个区域及其中的正方体排布情况，请你帮助计算出这个区域的三视图。", "inputFormat": "输入共 $n \\times k + 1$ 行。\n\n第一行为三个整数 $n, m, k$，代表长方形区域的长、宽、高。  \n接下来 $n \\times k$ 行，每行 $m$ 个整数。其中，将其每 $n$ 行分为一组，第 $x$ 组第 $y$ 行（即第 $(x - 1) \\times n + y$ 行）第 $z$ 列的整数 $a _ {x, y, z}$ 代表 $(y, z, x)$ 处格子的情况，若 $a _ {x, y, z} = 1$，代表该格子有小正方体；否则，代表该格子没有小正方体。", "outputFormat": "输出共 $2k + m$ 行。\n\n前 $k$ 行，每行 $n$ 个整数，代表**自上而下自左至右**正视图的情况。如果正视图中某个位置有填充，则输出 $1$，否则输出 $0$。同一行整数之间两两以一个空格隔开。  \n接下来 $k$ 行，每行 $m$ 个整数，代表**自上而下自后至前**左视图的情况。如果左视图中某个位置有填充，则输出 $1$，否则输出 $0$。同一行整数之间两两以一个空格隔开。  \n接下来 $m$ 行，每行 $n$ 个整数，代表**自后至前自左至右**俯视图的情况。如果俯视图中某个位置有填充，则输出 $1$，否则输出 $0$。同一行整数之间两两以一个空格隔开。  \n\n**以上方向均基于观测者初始站立位置及方向。如果对输出的顺序有疑惑，请参照样例辅助理解。**", "hint": "### 样例 1 解释\n\n样例 1 即为题目中的示例。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ho4l901w.png)\n\n### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n, m, k \\leq 200$，$0 \\leq a _ {x, y, z} \\leq 1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[入门赛 #14] Three-View Projection (Hard Version)", "background": "", "description": "> 全文与 $x, y, z$ 轴/方向有关的内容均基于以下的 $x, y, z$ 轴、位置及观测方向。观测者站在如图所示的位置，正在向着 $y$ 轴（绿线）正方向（箭头方向）观测。  \n> ![](https://cdn.luogu.com.cn/upload/image_hosting/05erek0j.png)\n\n现在有一个长、宽、高（沿 $x, y, z$ 轴延展的长度）为 $n \\text{ cm}, m \\text{ cm}, k \\text{ cm}$ 的长方体区域。我们将这片区域划分为 $n \\times m \\times k$ 个小格子。每个小格子中可以放置一个边长为 $1 \\text{ cm}$ 的小正方体。\n\n我们使用一个整数三元组 $(x, y, z)$ 来表示一个格子在空间中的位置，其代表从左往右数第 $x$ 个，从前往后数第 $y$ 个，从下往上第 $z$ 个格子。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0yu909tc.png)\n\n例如，上图展示的 $3 \\times 3 \\times 3$ 区域中，按照观测者的位置，可以发现红蓝线（$x, z$ 轴）所在的面为前面，蓝绿线（$y, z$ 轴）所在的面为左面，红绿线（$x, y$ 轴）所在的面为下面，五个小正方体的位置分别为 $(1, 1, 1), (1, 1, 2), (2, 3, 2), (3, 3, 2), (2, 2, 3)$。\n\n三视图是观测者从上面（从上往下）、左面（从左往右）、正面（从前往后）三个不同角度观察同一个空间几何体而画出的图形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p72x1i3q.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6ucamb9o.png)\n\n例如，以上是示例区域的三视图。\n\n现在，给定一个区域及其中的正方体排布情况，请你帮助计算出这个区域的三视图。", "inputFormat": "输入共 $n \\times k + 1$ 行。\n\n第一行为三个整数 $n, m, k$，代表长方形区域的长、宽、高。  \n接下来 $n \\times k$ 行，每行 $m$ 个整数。其中，将其每 $n$ 行分为一组，第 $x$ 组第 $y$ 行（即第 $(x - 1) \\times n + y$ 行）第 $z$ 列的整数 $a _ {x, y, z}$ 代表 $(y, z, x)$ 处格子的情况，若 $a _ {x, y, z} = 1$，代表该格子有小正方体；否则，代表该格子没有小正方体。", "outputFormat": "输出共 $2k + m$ 行。\n\n前 $k$ 行，每行 $n$ 个整数，代表**自上而下自左至右**正视图的情况。如果正视图中某个位置有填充，则输出 $1$，否则输出 $0$。同一行整数之间两两以一个空格隔开。  \n接下来 $k$ 行，每行 $m$ 个整数，代表**自上而下自后至前**左视图的情况。如果左视图中某个位置有填充，则输出 $1$，否则输出 $0$。同一行整数之间两两以一个空格隔开。  \n接下来 $m$ 行，每行 $n$ 个整数，代表**自后至前自左至右**俯视图的情况。如果俯视图中某个位置有填充，则输出 $1$，否则输出 $0$。同一行整数之间两两以一个空格隔开。  \n\n**以上方向均基于观测者初始站立位置及方向。如果对输出的顺序有疑惑，请参照样例辅助理解。**", "hint": "### 样例 1 解释\n\n样例 1 即为题目中的示例。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ho4l901w.png)\n\n### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n, m, k \\leq 200$，$0 \\leq a _ {x, y, z} \\leq 1$。", "locale": "zh-CN"}}}
{"pid": "P9457", "type": "P", "difficulty": 3, "samples": [["2 3 1\n1 2 3\n4 5 6\n", "3"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "O2优化", "语言月赛"], "title": "[入门赛 #14] 魔法少女扶苏 (Hard Version)", "background": "", "description": "给定一个 $n$ 行 $m$ 列的数字矩阵，第 $i$ 行第 $j$ 列的数称为 $a_{i,j}$。\n\n扶苏可以释放任意多次魔法，每次施放魔法，矩阵里的**每个**数字都会被减去 $1$。\n\n现在扶苏想知道，她至少需要释放几次魔法，才能让矩阵中存在至少 $k$ 个位置 $(x, y)$，满足 $a_{x, y}$ 大于或等于它所在行和列的元素之和。\n\n形式化地，你需要计算最小的魔法释放次数使得施放魔法后存在至少 $k$ 个位置 $(x, y)$，满足 $a_{x, y} \\geq \\sum \\limits _{i = 1}^n a_{i,y} + \\sum \\limits _{i = 1}^m a_{x,i}$。", "inputFormat": "第一行是三个整数，表示矩阵的行数 $n$，列数 $m$ 和要求符合条件的位置个数 $k$。\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行的第 $j$ 个整数表示初始的 $a_{i,j}$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n\n释放 $3$ 次魔法后，矩阵变为\n\n$$\\begin{matrix}-2 & -1 & 0\\\\1& 2&3\\\\\\end{matrix}$$\n\n于是 $a_{1,1} = -2 > (-1) + (-3) = \\sum\\limits_{i =1}^n a_{i,1} + \\sum\\limits_{i = 1}^m a_{1, i}$。\n\n### 数据规模与约定\n\n- 对 $100\\%$ 的数据，保证 $1 \\leq n, m \\leq 3 \\times 10^3$，$1 \\leq k \\leq n \\times m$，$0 \\leq a_i \\leq 10^{11}$。\n\n### 提示\n\n**请使用合理的读入方式，避免超时。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[入门赛 #14] 魔法少女扶苏 (Hard Version)", "background": "", "description": "给定一个 $n$ 行 $m$ 列的数字矩阵，第 $i$ 行第 $j$ 列的数称为 $a_{i,j}$。\n\n扶苏可以释放任意多次魔法，每次施放魔法，矩阵里的**每个**数字都会被减去 $1$。\n\n现在扶苏想知道，她至少需要释放几次魔法，才能让矩阵中存在至少 $k$ 个位置 $(x, y)$，满足 $a_{x, y}$ 大于或等于它所在行和列的元素之和。\n\n形式化地，你需要计算最小的魔法释放次数使得施放魔法后存在至少 $k$ 个位置 $(x, y)$，满足 $a_{x, y} \\geq \\sum \\limits _{i = 1}^n a_{i,y} + \\sum \\limits _{i = 1}^m a_{x,i}$。", "inputFormat": "第一行是三个整数，表示矩阵的行数 $n$，列数 $m$ 和要求符合条件的位置个数 $k$。\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行的第 $j$ 个整数表示初始的 $a_{i,j}$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n\n释放 $3$ 次魔法后，矩阵变为\n\n$$\\begin{matrix}-2 & -1 & 0\\\\1& 2&3\\\\\\end{matrix}$$\n\n于是 $a_{1,1} = -2 > (-1) + (-3) = \\sum\\limits_{i =1}^n a_{i,1} + \\sum\\limits_{i = 1}^m a_{1, i}$。\n\n### 数据规模与约定\n\n- 对 $100\\%$ 的数据，保证 $1 \\leq n, m \\leq 3 \\times 10^3$，$1 \\leq k \\leq n \\times m$，$0 \\leq a_i \\leq 10^{11}$。\n\n### 提示\n\n**请使用合理的读入方式，避免超时。**", "locale": "zh-CN"}}}
