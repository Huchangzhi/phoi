{"pid": "P9479", "type": "P", "difficulty": 7, "samples": [["0 3\n1 2 1\n\n2 2 1\n1\n2 2 0\n1", "3\n16\n15"], ["见附件中的 tree/tree2.in。", "见附件中的 tree/tree2.ans。"], ["见附件中的 tree/tree3.in。", "见附件中的 tree/tree3.ans。"], ["见附件中的 tree/tree4.in。", "见附件中的 tree/tree4.ans。"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2023", "NOI", "O2优化", "虚树", "状压 DP"], "title": "[NOI2023] 桂花树", "background": "", "description": "小 B 八年前看到的桂花树是一棵 $n$ 个节点的树 $T$，**保证 $T$ 的非根结点的父亲的编号小于自己**。给定整数 $k$，称一棵 $(n+m)$ 个节点的有根树 $T^{\\prime}$ 是繁荣的，当且仅当以下所有条件满足：\n\n1. 对于任意满足 $1 \\le i,j \\le n$ 的 $(i,j)$，在树 $T$ 和树 $T^{\\prime}$ 上，节点 $i$ 和 $j$ 的最近公共祖先编号相同。\n2. 对于任意满足 $1 \\le i,j \\le n + m$ 的 $(i,j)$，在树 $T^{\\prime}$ 上，节点 $i$ 和 $j$ 的最近公共祖先编号不超过 $\\max(i,j)+k$。\n\n**注意题目中所有树的节点均从 $1$ 开始编号，且根结点编号为 $1$。$T^{\\prime}$ 不需要满足非根结点的父亲编号小于自己。**\n\n小 B 想知道有多少棵 $(n+m)$ 个节点的树是繁荣的，认为两棵树不同当且仅当存在某一个节点在两棵树上的父亲不同。你只输出方案数在模 $(10^9+7)$ 意义下的值。", "inputFormat": "**本题有多组测试数据。**\n\n输入的第一行包含两个整数 $c,t$，分别表示测试点编号和测试数据组数。$c=0$ 表示该测试点为样例。\n\n接下来依次输入每组测试数据，对于每组测试数据：\n\n输入的第一行包含三个整数 $n,m,k$。\n\n输入的第二行包含 $n-1$ 个整数 $f_2,f_3,\\dots,f_n$，其中 $f_i$ 表示 $T$ 中节点 $i$ 的父亲节点编号。", "outputFormat": "对于每组测试数据输出一行一个整数，表示繁荣的树的数量在模 $(10^9+7)$ 意义下的答案。", "hint": "**【样例解释 #1】**\n\n对于样例中的第一组测试数据，有三棵合法的树，其每个节点的的父亲构成的序列 $\\{f_2,f_3\\}$ 分别为 $\\{1,1\\}$、$\\{3,1\\}$、$\\{1,2\\}$。注意这组测试数据的第二行为空行。\n\n对于样例中的第二组、第三组测试数据，共有 $16$ 棵树满足第一个条件，其中只有父亲序列为 $\\{4,4,1\\}$ 的树在第三组测试数据中不满足第二个条件。\n\n**【样例解释 #2】**\n\n该组样例满足 $n \\le 100$，五组测试数据中 $m$ 分别不超过 $0, 1, 1, 2, 2$。\n\n**【样例解释 #3】**\n\n该组样例满足 $k = 0$，五组测试数据中前两组测试数据满足 $n = 1$，第一、三、四组测试数据满足 $n, m \\le 100$。\n\n**【样例解释 #4】**\n\n该组样例前两组测试数据满足 $n = 1$，第一、三、四组测试数据满足 $n, m \\le 100$。\n\n**【数据范围】**\n\n对于所有测试数据保证：$1 \\le t \\le 15$，$1 \\le n \\le 3 \\times 10^4$，$0 \\le m \\le 3000$，$0 \\le k \\le 10$，$1 \\le f_i \\le i - 1$。\n\n| 测试点编号 | $n \\le$ | $m \\le $| $k \\le $|\n| :--: | :--: | :--: | :--: |\n| $1,2$ | $4$|$4$|$10$|\n|$3$|$3\\times 10^4$|$0$|$10$|\n|$4$|$10^2$|$1$|$10$|\n|$5$|$3 \\times 10^4$|$1$|$10$|\n|$6$|$10^2$|$2$|$10$|\n|$7$|$3\\times 10^4$|$2$|$10$|\n|$8,9$|$1$|$10^2$|$0$|\n|$10$|$1$|$3,000$|$0$|\n|$11$|$1$|$10^2$|$10$|\n|$12$|$1$|$3,000$|$10$|\n|$13,14$|$10^2$|$10^2$|$0$|\n|$15,16$|$3\\times 10^4$|$3,000$|$0$|\n|$17,18$|$10^2$|$10^2$|$10$|\n|$19,20$|$3\\times 10^4$|$3,000$|$10$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2023] 桂花树", "background": "", "description": "小 B 八年前看到的桂花树是一棵 $n$ 个节点的树 $T$，**保证 $T$ 的非根结点的父亲的编号小于自己**。给定整数 $k$，称一棵 $(n+m)$ 个节点的有根树 $T^{\\prime}$ 是繁荣的，当且仅当以下所有条件满足：\n\n1. 对于任意满足 $1 \\le i,j \\le n$ 的 $(i,j)$，在树 $T$ 和树 $T^{\\prime}$ 上，节点 $i$ 和 $j$ 的最近公共祖先编号相同。\n2. 对于任意满足 $1 \\le i,j \\le n + m$ 的 $(i,j)$，在树 $T^{\\prime}$ 上，节点 $i$ 和 $j$ 的最近公共祖先编号不超过 $\\max(i,j)+k$。\n\n**注意题目中所有树的节点均从 $1$ 开始编号，且根结点编号为 $1$。$T^{\\prime}$ 不需要满足非根结点的父亲编号小于自己。**\n\n小 B 想知道有多少棵 $(n+m)$ 个节点的树是繁荣的，认为两棵树不同当且仅当存在某一个节点在两棵树上的父亲不同。你只输出方案数在模 $(10^9+7)$ 意义下的值。", "inputFormat": "**本题有多组测试数据。**\n\n输入的第一行包含两个整数 $c,t$，分别表示测试点编号和测试数据组数。$c=0$ 表示该测试点为样例。\n\n接下来依次输入每组测试数据，对于每组测试数据：\n\n输入的第一行包含三个整数 $n,m,k$。\n\n输入的第二行包含 $n-1$ 个整数 $f_2,f_3,\\dots,f_n$，其中 $f_i$ 表示 $T$ 中节点 $i$ 的父亲节点编号。", "outputFormat": "对于每组测试数据输出一行一个整数，表示繁荣的树的数量在模 $(10^9+7)$ 意义下的答案。", "hint": "**【样例解释 #1】**\n\n对于样例中的第一组测试数据，有三棵合法的树，其每个节点的的父亲构成的序列 $\\{f_2,f_3\\}$ 分别为 $\\{1,1\\}$、$\\{3,1\\}$、$\\{1,2\\}$。注意这组测试数据的第二行为空行。\n\n对于样例中的第二组、第三组测试数据，共有 $16$ 棵树满足第一个条件，其中只有父亲序列为 $\\{4,4,1\\}$ 的树在第三组测试数据中不满足第二个条件。\n\n**【样例解释 #2】**\n\n该组样例满足 $n \\le 100$，五组测试数据中 $m$ 分别不超过 $0, 1, 1, 2, 2$。\n\n**【样例解释 #3】**\n\n该组样例满足 $k = 0$，五组测试数据中前两组测试数据满足 $n = 1$，第一、三、四组测试数据满足 $n, m \\le 100$。\n\n**【样例解释 #4】**\n\n该组样例前两组测试数据满足 $n = 1$，第一、三、四组测试数据满足 $n, m \\le 100$。\n\n**【数据范围】**\n\n对于所有测试数据保证：$1 \\le t \\le 15$，$1 \\le n \\le 3 \\times 10^4$，$0 \\le m \\le 3000$，$0 \\le k \\le 10$，$1 \\le f_i \\le i - 1$。\n\n| 测试点编号 | $n \\le$ | $m \\le $| $k \\le $|\n| :--: | :--: | :--: | :--: |\n| $1,2$ | $4$|$4$|$10$|\n|$3$|$3\\times 10^4$|$0$|$10$|\n|$4$|$10^2$|$1$|$10$|\n|$5$|$3 \\times 10^4$|$1$|$10$|\n|$6$|$10^2$|$2$|$10$|\n|$7$|$3\\times 10^4$|$2$|$10$|\n|$8,9$|$1$|$10^2$|$0$|\n|$10$|$1$|$3,000$|$0$|\n|$11$|$1$|$10^2$|$10$|\n|$12$|$1$|$3,000$|$10$|\n|$13,14$|$10^2$|$10^2$|$0$|\n|$15,16$|$3\\times 10^4$|$3,000$|$0$|\n|$17,18$|$10^2$|$10^2$|$10$|\n|$19,20$|$3\\times 10^4$|$3,000$|$10$|", "locale": "zh-CN"}}}
{"pid": "P9480", "type": "P", "difficulty": 7, "samples": [["0\n4 2 2\n1 2\n2 3\n3 4\n1 3\n2 4\n2 3\n", "3\n"], ["见附件中的 dfs/dfs2.in。", "见附件中的 dfs/dfs2.ans。"], ["见附件中的 dfs/dfs3.in。", "见附件中的 dfs/dfs3.ans。"], ["见附件中的 dfs/dfs4.in。", "见附件中的 dfs/dfs4.ans。"], ["见附件中的 dfs/dfs5.in。", "见附件中的 dfs/dfs5.ans。"], ["见附件中的 dfs/dfs6.in。", "见附件中的 dfs/dfs6.ans。"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "2023", "NOI", "离散化", "O2优化", "动态规划优化", "树形 DP", "容斥原理"], "title": "[NOI2023] 深搜", "background": "", "description": "深度优先搜索是一种常见的搜索算法。通过此算法，我们可以从一个无重边、无自环的无向连通图 $G = (V, E)$，和某个出发点 $s$，得到一棵树 $T$。\n\n算法的流程描述如下:\n\n1. 将栈 $S$ 设置为空，并令 $T = (V, \\emptyset)$，即 $T$ 的边集初始为空。\n2. 首先将出发点 $s$ 压入 $S$ 中。\n3. 访问栈顶节点 $u$，并将 $u$ 标记为“已访问的”。\n4. 如果存在与 $u$ 相邻且未被访问的节点，则**任意地**从这些节点中挑选一个记为 $v$。我们将边 $(u, v)$ 加入 $T$ 的边集中，并将 $v$ 压入栈 $S$ 中，然后**回到步骤 3**。若不存在这样的节点，则从栈中弹出节点 $u$。\n\n可以证明，当图 $G$ 为连通图时，该算法会得到图的某一棵生成树 $T$。但**算法得到的树 $T$ 可能不是唯一的，它取决于搜索的顺序，也就是算法的第 4 步所选取的顶点**。指定出发点 $s$ 后，如果能够选取一种特定的搜索顺序，使得算法得到的树恰好是 $T$，则我们称 **$T$ 是 $G$ 的一棵 $s$-dfs 树**。\n\n现在给定一棵 $n$ 个顶点的树 $T$，顶点编号为 $1 \\sim n$，并额外给出 $m$ 条边。我们保证这 $m$ 条边两两不同，连接不同的顶点，且与 $T$ 中的 $n - 1$ 条树边两两不同。我们称额外给出的 $m$ 条边为**非树边**。在这 $n$ 个顶点中，我们指定了恰好 $k$ 个顶点作为**关键点**。\n\n现在你想知道，有多少种选取这 $m$ 条非树边的方法（可以全部不选），使得：将 $T$ 的边与被选中的非树边构成图 $G$ 之后，存在某个**关键点** $s$，使得 $T$ 是 $G$ 的一棵 $s$-dfs 树。\n\n由于答案可能十分巨大，你只需要输出方案数在模 $(10 ^ 9 + 7)$ 意义下的值。", "inputFormat": "输入的第一行包含一个整数 $c$，表示测试点编号。$c = 0$ 表示该测试点为样例。\n\n输入的第二行包含三个正整数 $n, m, k$，分别表示顶点个数，非树边的数量，关键点的数量。\n\n接下来 $n - 1$ 行，每行包含两个正整数 $u, v$ 表示树 $T$ 的一条边。保证这 $n - 1$ 条边构成了一棵树。\n\n接下来 $m$ 行，每行包含两个正整数 $a, b$ 表示一条非树边。保证 $(a, b)$ 不与树上的边重合，且没有重边。\n\n输入的最后一行包含 $k$ 个正整数 $s_1, s_2, \\dots, s_k$，表示 $k$ 个关键点的编号。保证 $s_1, s_2, \\dots, s_k$ 互不相同。", "outputFormat": "输出一行包含一个非负整数，表示方案数在模 $(10 ^ 9 + 7)$ 意义下的值。", "hint": "**【样例解释 #1】**\n\n在这个样例中，有三种选取非树边的方法：只选取边 $(1, 3)$，只选取边 $(2, 4)$，或不选取任何条非树边。\n\n如果只选取边 $(1, 3)$，或者不选取任何一条非树边，则我们发现 $T$ 都是图 $G$ 的 $3$-dfs 树。指定的搜索顺序如下：\n1. 将 $3$ 放入栈 $S$ 中。此时 $S = [3]$。\n2. 将 $3$ 标记为“已访问的”。\n3. 由于 $3$ 与 $2$ 相连，且 $2$ 是“未访问的”，将 $2$ 放入栈 $S$ 中，并将 $(3, 2)$ 加入树 $T$ 中，此时 $S = [3, 2]$。\n4. 将 $2$ 标记为“已访问的”。\n5. 由于 $2$ 与 $1$ 相连，且 $1$ 是“未访问的”，将 $1$ 放入栈 $S$ 中，并将 $(2, 1)$ 加入树 $T$ 中，此时 $S = [3, 2, 1]$。\n6. 由于与 $1$ 相邻的点都是“已访问的”，将 $1$ 弹出栈，此时 $S = [3, 2]$。\n7. 由于与 $2$ 相邻的点都是“已访问的”，将 $2$ 弹出栈，此时 $S = [3]$。\n8. 由于 $3$ 与 $4$ 相连，且 $4$ 是“未访问的”，将 $4$ 放入栈 $S$ 中，并将 $(3, 4)$ 加入树 $T$ 中，此时 $S = [3, 4]$。\n9. 由于与 $4$ 相连的点都是“已访问的”，将 $4$ 弹出栈，此时 $S = [3]$。\n10. 由于与 $3$ 相连的点都是“己访问的”，将 $3$ 弹出栈，此时 $S$重新变为空。\n\n如果只选取边 $(2, 4)$，则我们可以说明 $T$ 是图 $G$ 的 $2$-dfs 树。指定的搜索顺序如下：\n\n1. 将 $2$ 放入栈 $S$ 中。此时 $S = [2]$。\n2. 将 $2$ 标记为“已访问的”。\n3. 由于 $2$ 与 $3$ 相连，且 $3$ 是“未访问的”，将 $3$ 放入栈 $S$ 中，并将 $(2, 3)$ 加入树 $T$ 中，此时 $S = [2, 3]$。\n4. 将 $3$ 标记为“已访问的”。\n5. 由于 $3$ 与 $4$ 相连，且 $4$ 是“未访问的”，将 $4$ 放入栈 $S$ 中，并将 $(3, 4)$ 加入树 $T$ 中，此时 $S = [2, 3, 4]$。\n6. 由于与 $4$ 相邻的点都是“己访问的”，将 $4$ 弹出栈，此时 $S = [2, 3]$。\n7. 由于与 $3$ 相邻的点都是“已访问的”，将 $3$ 弹出栈，此时 $S= [2]$。\n8. 由于 $2$ 与 $1$ 相连，且 $1$ 是“未访问的”，将 $1$ 放入栈 $S$ 中，并将 $(2, 1)$ 加入树 $T$ 中，此时 $S = [2, 1]$。\n9. 由于与 $1$ 相连的点都是“已访问的”，将 $1$ 弹出栈此时 $S = [2]$。\n10. 由于与 $2$ 相连的点都是“已访问的”，将 $2$ 弹出栈，此时 $S$ 重新变为空。\n\n**【样例解释 #2】**\n\n这个样例满足测试点 $4 \\sim 6$ 的约束条件。\n\n**【样例解释 #3】**\n\n这个样例满足测试点 $10 \\sim 11$ 的约束条件。\n\n**【样例解释 #4】**\n\n这个样例满足测试点 $12 \\sim 13$ 的约束条件。\n\n**【样例解释 #5】**\n\n这个样例满足测试点 $14 \\sim 16$ 的约束条件。\n\n**【样例解释 #6】**\n\n这个样例满足测试点 $23 \\sim 24$ 的约束条件。\n\n**【数据范围】**\n\n对于所有测试数据保证：$1 \\le k \\le n \\le 5 \\times 10 ^ 5$，$1 \\le m \\le 5 \\times 10 ^ 5$。\n\n|测试点编号|$n \\le$|$m \\le$|$k \\le$|特殊性质|\n|:-:|:-:|:-:|:-:|:-:|\n|$1 \\sim 3$|$6$|$6$|$n$|无|\n|$4 \\sim 6$|$15$|$15$|$6$|无|\n|$7 \\sim 9$|$300$|$300$|$6$|无|\n|$10 \\sim 11$|$300$|$300$|$n$|A|\n|$12 \\sim 13$|$300$|$300$|$n$|B|\n|$14 \\sim 16$|$300$|$300$|$n$|无|\n|$17 \\sim 18$|$2 \\times 10 ^ 5$|$2 \\times 10 ^ 5$|$n$|A|\n|$19 \\sim 21$|$2 \\times 10 ^ 5$|$2 \\times 10 ^ 5$|$n$|B|\n|$22$|$2 \\times 10 ^ 5$|$2 \\times 10 ^ 5$|$n$|无|\n|$23 \\sim 25$|$5 \\times 10 ^ 5$|$5 \\times 10 ^ 5$|$n$|无|\n\n特殊性质 A：保证在 $T$ 中，$i$ 号点与 $i + 1$ 号点相连（$1 \\le i < n$）。\n\n特殊性质 B：保证若将 $T$ 的边与所有 $m$ 条非树边构成一个图 $G$，则 $T$ 是 $G$ 的棵 $1$-dfs 树。\n\n**请注意，$1$ 号点不一定是 $k$ 个关键点之一。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2023] 深搜", "background": "", "description": "深度优先搜索是一种常见的搜索算法。通过此算法，我们可以从一个无重边、无自环的无向连通图 $G = (V, E)$，和某个出发点 $s$，得到一棵树 $T$。\n\n算法的流程描述如下:\n\n1. 将栈 $S$ 设置为空，并令 $T = (V, \\emptyset)$，即 $T$ 的边集初始为空。\n2. 首先将出发点 $s$ 压入 $S$ 中。\n3. 访问栈顶节点 $u$，并将 $u$ 标记为“已访问的”。\n4. 如果存在与 $u$ 相邻且未被访问的节点，则**任意地**从这些节点中挑选一个记为 $v$。我们将边 $(u, v)$ 加入 $T$ 的边集中，并将 $v$ 压入栈 $S$ 中，然后**回到步骤 3**。若不存在这样的节点，则从栈中弹出节点 $u$。\n\n可以证明，当图 $G$ 为连通图时，该算法会得到图的某一棵生成树 $T$。但**算法得到的树 $T$ 可能不是唯一的，它取决于搜索的顺序，也就是算法的第 4 步所选取的顶点**。指定出发点 $s$ 后，如果能够选取一种特定的搜索顺序，使得算法得到的树恰好是 $T$，则我们称 **$T$ 是 $G$ 的一棵 $s$-dfs 树**。\n\n现在给定一棵 $n$ 个顶点的树 $T$，顶点编号为 $1 \\sim n$，并额外给出 $m$ 条边。我们保证这 $m$ 条边两两不同，连接不同的顶点，且与 $T$ 中的 $n - 1$ 条树边两两不同。我们称额外给出的 $m$ 条边为**非树边**。在这 $n$ 个顶点中，我们指定了恰好 $k$ 个顶点作为**关键点**。\n\n现在你想知道，有多少种选取这 $m$ 条非树边的方法（可以全部不选），使得：将 $T$ 的边与被选中的非树边构成图 $G$ 之后，存在某个**关键点** $s$，使得 $T$ 是 $G$ 的一棵 $s$-dfs 树。\n\n由于答案可能十分巨大，你只需要输出方案数在模 $(10 ^ 9 + 7)$ 意义下的值。", "inputFormat": "输入的第一行包含一个整数 $c$，表示测试点编号。$c = 0$ 表示该测试点为样例。\n\n输入的第二行包含三个正整数 $n, m, k$，分别表示顶点个数，非树边的数量，关键点的数量。\n\n接下来 $n - 1$ 行，每行包含两个正整数 $u, v$ 表示树 $T$ 的一条边。保证这 $n - 1$ 条边构成了一棵树。\n\n接下来 $m$ 行，每行包含两个正整数 $a, b$ 表示一条非树边。保证 $(a, b)$ 不与树上的边重合，且没有重边。\n\n输入的最后一行包含 $k$ 个正整数 $s_1, s_2, \\dots, s_k$，表示 $k$ 个关键点的编号。保证 $s_1, s_2, \\dots, s_k$ 互不相同。", "outputFormat": "输出一行包含一个非负整数，表示方案数在模 $(10 ^ 9 + 7)$ 意义下的值。", "hint": "**【样例解释 #1】**\n\n在这个样例中，有三种选取非树边的方法：只选取边 $(1, 3)$，只选取边 $(2, 4)$，或不选取任何条非树边。\n\n如果只选取边 $(1, 3)$，或者不选取任何一条非树边，则我们发现 $T$ 都是图 $G$ 的 $3$-dfs 树。指定的搜索顺序如下：\n1. 将 $3$ 放入栈 $S$ 中。此时 $S = [3]$。\n2. 将 $3$ 标记为“已访问的”。\n3. 由于 $3$ 与 $2$ 相连，且 $2$ 是“未访问的”，将 $2$ 放入栈 $S$ 中，并将 $(3, 2)$ 加入树 $T$ 中，此时 $S = [3, 2]$。\n4. 将 $2$ 标记为“已访问的”。\n5. 由于 $2$ 与 $1$ 相连，且 $1$ 是“未访问的”，将 $1$ 放入栈 $S$ 中，并将 $(2, 1)$ 加入树 $T$ 中，此时 $S = [3, 2, 1]$。\n6. 由于与 $1$ 相邻的点都是“已访问的”，将 $1$ 弹出栈，此时 $S = [3, 2]$。\n7. 由于与 $2$ 相邻的点都是“已访问的”，将 $2$ 弹出栈，此时 $S = [3]$。\n8. 由于 $3$ 与 $4$ 相连，且 $4$ 是“未访问的”，将 $4$ 放入栈 $S$ 中，并将 $(3, 4)$ 加入树 $T$ 中，此时 $S = [3, 4]$。\n9. 由于与 $4$ 相连的点都是“已访问的”，将 $4$ 弹出栈，此时 $S = [3]$。\n10. 由于与 $3$ 相连的点都是“己访问的”，将 $3$ 弹出栈，此时 $S$重新变为空。\n\n如果只选取边 $(2, 4)$，则我们可以说明 $T$ 是图 $G$ 的 $2$-dfs 树。指定的搜索顺序如下：\n\n1. 将 $2$ 放入栈 $S$ 中。此时 $S = [2]$。\n2. 将 $2$ 标记为“已访问的”。\n3. 由于 $2$ 与 $3$ 相连，且 $3$ 是“未访问的”，将 $3$ 放入栈 $S$ 中，并将 $(2, 3)$ 加入树 $T$ 中，此时 $S = [2, 3]$。\n4. 将 $3$ 标记为“已访问的”。\n5. 由于 $3$ 与 $4$ 相连，且 $4$ 是“未访问的”，将 $4$ 放入栈 $S$ 中，并将 $(3, 4)$ 加入树 $T$ 中，此时 $S = [2, 3, 4]$。\n6. 由于与 $4$ 相邻的点都是“己访问的”，将 $4$ 弹出栈，此时 $S = [2, 3]$。\n7. 由于与 $3$ 相邻的点都是“已访问的”，将 $3$ 弹出栈，此时 $S= [2]$。\n8. 由于 $2$ 与 $1$ 相连，且 $1$ 是“未访问的”，将 $1$ 放入栈 $S$ 中，并将 $(2, 1)$ 加入树 $T$ 中，此时 $S = [2, 1]$。\n9. 由于与 $1$ 相连的点都是“已访问的”，将 $1$ 弹出栈此时 $S = [2]$。\n10. 由于与 $2$ 相连的点都是“已访问的”，将 $2$ 弹出栈，此时 $S$ 重新变为空。\n\n**【样例解释 #2】**\n\n这个样例满足测试点 $4 \\sim 6$ 的约束条件。\n\n**【样例解释 #3】**\n\n这个样例满足测试点 $10 \\sim 11$ 的约束条件。\n\n**【样例解释 #4】**\n\n这个样例满足测试点 $12 \\sim 13$ 的约束条件。\n\n**【样例解释 #5】**\n\n这个样例满足测试点 $14 \\sim 16$ 的约束条件。\n\n**【样例解释 #6】**\n\n这个样例满足测试点 $23 \\sim 24$ 的约束条件。\n\n**【数据范围】**\n\n对于所有测试数据保证：$1 \\le k \\le n \\le 5 \\times 10 ^ 5$，$1 \\le m \\le 5 \\times 10 ^ 5$。\n\n|测试点编号|$n \\le$|$m \\le$|$k \\le$|特殊性质|\n|:-:|:-:|:-:|:-:|:-:|\n|$1 \\sim 3$|$6$|$6$|$n$|无|\n|$4 \\sim 6$|$15$|$15$|$6$|无|\n|$7 \\sim 9$|$300$|$300$|$6$|无|\n|$10 \\sim 11$|$300$|$300$|$n$|A|\n|$12 \\sim 13$|$300$|$300$|$n$|B|\n|$14 \\sim 16$|$300$|$300$|$n$|无|\n|$17 \\sim 18$|$2 \\times 10 ^ 5$|$2 \\times 10 ^ 5$|$n$|A|\n|$19 \\sim 21$|$2 \\times 10 ^ 5$|$2 \\times 10 ^ 5$|$n$|B|\n|$22$|$2 \\times 10 ^ 5$|$2 \\times 10 ^ 5$|$n$|无|\n|$23 \\sim 25$|$5 \\times 10 ^ 5$|$5 \\times 10 ^ 5$|$n$|无|\n\n特殊性质 A：保证在 $T$ 中，$i$ 号点与 $i + 1$ 号点相连（$1 \\le i < n$）。\n\n特殊性质 B：保证若将 $T$ 的边与所有 $m$ 条非树边构成一个图 $G$，则 $T$ 是 $G$ 的棵 $1$-dfs 树。\n\n**请注意，$1$ 号点不一定是 $k$ 个关键点之一。**", "locale": "zh-CN"}}}
{"pid": "P9481", "type": "P", "difficulty": 6, "samples": [["2 1\n2 1\n1 2 2", "8"], ["见附件中的 trade/trade2.in。", "见附件中的 trade/trade2.ans。"], ["见附件中的 trade/trade3.in。", "见附件中的 trade/trade3.ans。"], ["见附件中的 trade/trade4.in。", "见附件中的 trade/trade4.ans。"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "NOI", "O2优化"], "title": "[NOI2023] 贸易", "background": "", "description": "近年来，A 国的商贸发展迅猛，但国内的道路建设却跟不上步伐，明显成为了人们贸易往来的限制，管理者为此费尽了心思。\n\n具体而言，A 国共有 $2^n-1$ 个城市，其中 $1$ 号城市为首都。对于所有的非首都城市 $i$，都有一条**单向**道路从城市 $i$ 出发，到达城市 $\\lfloor \\frac{i}{2} \\rfloor$。为方便起见，称这样的道路为“第一类道路”，称城市 $\\lfloor \\frac{i}{2} \\rfloor$ 为城市 $i$ 的“上级城市”。\n\n除此之外，还有 $m$ 条**单向**道路，设其中第 $i$ 条道路从城市 $u_i$ 出发，到达城市 $v_i$，这样的道路都有一个特殊性质：从城市 $v_i$ 出发，沿着第一类道路不断向“上级城市”走去，最终总能走到城市 $u_i$。称这样的道路为“第二类道路”。\n\n每一条道路都有相应的长度值。由此，对于 A 国的任意两个城市 $x$ 和 $y$，都可以计算出从城市 $x$ 出发，沿道路走到城市 $y$，所经过的道路的长度之和的最小值，将这一数值记为 $dist(x,y)$。但由于 A 国的道路建设存在严重缺陷，从城市 $x$ 出发可能根本到达不了城市 $y$，此时定义 $dist(x,y)=0$。同时一个城市出发到自己是不需要经过任何道路的，因此定义 $dist(x,x)=0$。\n\n现在管理者希望计算出这些 $dist(x,y)$ 的值，以便合理衡量人们贸易往来的便捷程度。但由于 A 国的城市数量太多，将这些值一一列出的工作量太大，因此管理者只希望求出所有 $dist(x,y)$ 值之和，也就是 $\\sum_{x=1}^{2^n-1}{\\sum_{y=1}^{2^n-1}{dist(x,y)}}$，并希望请你来帮忙。", "inputFormat": "输入的第一行包含两个正整数 $n$ 和 $m$。\n\n输入的第二行包含 $2^n-2$ 个正整数，第 $i$ 个数 $a_i$ 表示从城市 $i+1$ 出发, 到达城市 $\\lfloor \\frac{i+1}{2} \\rfloor$ 的“第一类道路”的长度。\n\n接下来的 $m$ 行，每行包含三个正整数 $u,v,w$，描述了一条从城市 $u$ 到城市 $v$ 的“第二类道路”, 其长度为 $w$。", "outputFormat": "输出一行一个正整数，表示对应的答案。由于答案可能很大, 你只需要输出模 $998244353$ 意义下的答案即可。", "hint": "**【数据范围】**\n\n对于所有测试数据保证：$2 \\le n \\le 18$，$1 \\le m \\le 2 ^ n$，$1 \\le u, v \\le 2 ^ n - 1$，$1 \\le a_i, w \\le 10 ^ 9$。\n\n::cute-table{tuack}\n\n| 测试点编号 | $n$ | $m$ | 是否有特殊性质 |\n| :---: | :---: | :---: | :---: |\n| $1\\sim 2$ | $=8$ | $\\le 256$ | 否 |\n| $3\\sim 4$ | $=9$ | $\\le 512$ | ^ |\n| $5\\sim 8$ | $=12$ | $\\le 4,096$ | ^ |\n| $9$ | $=16$ | $\\le 10$ |  ^|\n| $10$ | ^ | $\\le 50$ | ^ |\n| $11$ | ^ | $\\le 100$ | ^ |\n| $12$ | ^ | $\\le 65,536$ | 是 |\n| $13\\sim 15$ | ^ | ^ | 否 |\n| $16\\sim 17$ | $=18$ | $\\le 262,144$ | 是 |\n| $18\\sim 20$ | ^ | ^ | 否 |\n\n特殊性质：保证每一条“第二类道路”都是从首都（城市 $1$）出发。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2023] 贸易", "background": "", "description": "近年来，A 国的商贸发展迅猛，但国内的道路建设却跟不上步伐，明显成为了人们贸易往来的限制，管理者为此费尽了心思。\n\n具体而言，A 国共有 $2^n-1$ 个城市，其中 $1$ 号城市为首都。对于所有的非首都城市 $i$，都有一条**单向**道路从城市 $i$ 出发，到达城市 $\\lfloor \\frac{i}{2} \\rfloor$。为方便起见，称这样的道路为“第一类道路”，称城市 $\\lfloor \\frac{i}{2} \\rfloor$ 为城市 $i$ 的“上级城市”。\n\n除此之外，还有 $m$ 条**单向**道路，设其中第 $i$ 条道路从城市 $u_i$ 出发，到达城市 $v_i$，这样的道路都有一个特殊性质：从城市 $v_i$ 出发，沿着第一类道路不断向“上级城市”走去，最终总能走到城市 $u_i$。称这样的道路为“第二类道路”。\n\n每一条道路都有相应的长度值。由此，对于 A 国的任意两个城市 $x$ 和 $y$，都可以计算出从城市 $x$ 出发，沿道路走到城市 $y$，所经过的道路的长度之和的最小值，将这一数值记为 $dist(x,y)$。但由于 A 国的道路建设存在严重缺陷，从城市 $x$ 出发可能根本到达不了城市 $y$，此时定义 $dist(x,y)=0$。同时一个城市出发到自己是不需要经过任何道路的，因此定义 $dist(x,x)=0$。\n\n现在管理者希望计算出这些 $dist(x,y)$ 的值，以便合理衡量人们贸易往来的便捷程度。但由于 A 国的城市数量太多，将这些值一一列出的工作量太大，因此管理者只希望求出所有 $dist(x,y)$ 值之和，也就是 $\\sum_{x=1}^{2^n-1}{\\sum_{y=1}^{2^n-1}{dist(x,y)}}$，并希望请你来帮忙。", "inputFormat": "输入的第一行包含两个正整数 $n$ 和 $m$。\n\n输入的第二行包含 $2^n-2$ 个正整数，第 $i$ 个数 $a_i$ 表示从城市 $i+1$ 出发, 到达城市 $\\lfloor \\frac{i+1}{2} \\rfloor$ 的“第一类道路”的长度。\n\n接下来的 $m$ 行，每行包含三个正整数 $u,v,w$，描述了一条从城市 $u$ 到城市 $v$ 的“第二类道路”, 其长度为 $w$。", "outputFormat": "输出一行一个正整数，表示对应的答案。由于答案可能很大, 你只需要输出模 $998244353$ 意义下的答案即可。", "hint": "**【数据范围】**\n\n对于所有测试数据保证：$2 \\le n \\le 18$，$1 \\le m \\le 2 ^ n$，$1 \\le u, v \\le 2 ^ n - 1$，$1 \\le a_i, w \\le 10 ^ 9$。\n\n::cute-table{tuack}\n\n| 测试点编号 | $n$ | $m$ | 是否有特殊性质 |\n| :---: | :---: | :---: | :---: |\n| $1\\sim 2$ | $=8$ | $\\le 256$ | 否 |\n| $3\\sim 4$ | $=9$ | $\\le 512$ | ^ |\n| $5\\sim 8$ | $=12$ | $\\le 4,096$ | ^ |\n| $9$ | $=16$ | $\\le 10$ |  ^|\n| $10$ | ^ | $\\le 50$ | ^ |\n| $11$ | ^ | $\\le 100$ | ^ |\n| $12$ | ^ | $\\le 65,536$ | 是 |\n| $13\\sim 15$ | ^ | ^ | 否 |\n| $16\\sim 17$ | $=18$ | $\\le 262,144$ | 是 |\n| $18\\sim 20$ | ^ | ^ | 否 |\n\n特殊性质：保证每一条“第二类道路”都是从首都（城市 $1$）出发。", "locale": "zh-CN"}}}
{"pid": "P9482", "type": "P", "difficulty": 6, "samples": [["0 2\n9 3\nabacababa\n1 4\n2 4\n3 3\n9 3\nabaabaaba\n1 4\n2 4\n3 3\n", "4\n0\n3\n2\n0\n2\n"], ["见附件中的 string/string2.in。", "见附件中的 string/string2.ans。"], ["见附件中的 string/string3.in。", "见附件中的 string/string3.ans。"], ["见附件中的 string/string4.in。", "见附件中的 string/string4.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "树状数组", "2023", "NOI", "O2优化", "哈希 hashing", "后缀数组 SA", "Manacher 算法", "bitset"], "title": "[NOI2023] 字符串", "background": "", "description": "小 Y 是一名大学生，最近正在研究字符串方向的问题。\n\n小 Y 了解到关于字符串的如下定义:\n\n- 给定一个长度为 $n$ 的字符串 $s[1: n]$，我们定义其子串 $s[l: r]$（$1 \\leq l \\leq r \\leq n$）为选择 $s[l], s[l+1], \\dots, s[r]$, 将其顺次拼接得到的新字符串。\n- 给定一个长度为 $n$ 的字符串 $s[1: n]$，我们定义其翻转后的结果 $R(s)$ 为将 $s[n], s[n-1], \\dots, s[1]$ 顺次拼接，也就是将字符串反序拼接得到的字符串。\n- 给定两个长度均为 $n$ 的字符串 $a[1: n], b[1: n]$，我们定义 $a$ 的字典序小于 $b$ 当且仅当存在 $1 \\leq i \\leq n$，使得对于任意 $1 \\leq j < i$，$a[j] = b[j]$，且 $a[i] < b[i]$。\n\n在了解了上述定义后，小 Y 想到了这样的问题:\n\n给定一个长度为 $n$ 的字符串 $s[1: n]$。有 $q$ 次询问，每次询问给定两个参数 $i, r$。你需要求出有多少 $l$，满足如下条件:\n- $1 \\leq l \\leq r$。\n- $s[i: i+l-1]$ 字典序小于 $R(s[i+l: i+2l-1])$。\n\n小 Y 想求助你帮忙解决这一问题。", "inputFormat": "**本题有多组测试数据。**\n\n输入的第一行包含两个整数 $c, t$，分别表示测试点编号和测试数据组数。$c=0$ 表示该测试点为样例。\n\n接下来依次输入每组测试数据，对于每组测试数据：\n\n输入的第一行包含两个正整数 $n, q$，表示字符串长度和询问次数。\n\n输入的第二行包含一个长度为 $n$ 的仅包含小写字母的字符串 $s$。\n\n输入的接下来 $q$ 行，每行包含两个正整数 $i, r$。表示一次询问，保证 $i+2r-1 \\leq n$。", "outputFormat": "对于每一组测试数据的每一次询问，输出一行一个整数，表示满足条件的 $l$ 的个数。", "hint": "**【样例解释 #1】**\n\n对于第一组数据的第一组询问：\n- $l = 1$ 时，$s[i: i + l - 1] = \\texttt{a}$，$R(s[i + l: i + 2l - 1]) = \\texttt{b}$。\n- $l = 2$ 时，$s[i: i + l - 1] = \\texttt{ab}$，$R(s[i + l: i + 2l - 1]) = \\texttt{ca}$。\n- $l = 3$ 时，$s[i: i + l - 1] = \\texttt{aba}$，$R(s[i + l: i + 2l - 1]) = \\texttt{bac}$。\n- $l = 4$ 时，$s[i: i + l - 1] = \\texttt{abac}$，$R(s[i + l: i + 2l - 1]) = \\texttt{baba}$。\n\n这四种情况中，$s[i: i + l - 1]$ 的字典序均小于 $R(s[i + l: i + 2l - 1])$。因此答案为 $4$。\n\n**【样例解释 #2】**\n\n该样例数据范围满足测试点 $5$。\n\n**【样例解释 #4】**\n\n该样例数据范围满足测试点 $24 \\sim 25$。\n\n**【数据范围】**\n\n对于所有测试数据保证：$1 \\le t \\le 5$，$1 \\le n \\le 10 ^ 5$，$1 \\le q \\le 10 ^ 5$，$1 \\le i + 2r - 1 \\le n $，字符串 $s$ 仅包含小写字母。\n\n|测试点编号|$n \\le$|$q \\le$|特殊性质|\n|:-:|:-:|:-:|:-:|\n|$1$|$5$|$5$|A|\n|$2$|$10$|$10$|A|\n|$3$|$20$|$20$|A|\n|$4$|$50$|$50$|A|\n|$5$|$10^2$|$10^2$|A|\n|$6$|$10^3$|$10^3$|无|\n|$7$|$2,000$|$2,000$|无|\n|$8$|$3,000$|$3,000$|无|\n|$9$|$4,000$|$4,000$|无|\n|$10$|$23,333$|$23,333$|A|\n|$11$|$5 \\times 10 ^ 4$|$5 \\times 10 ^ 4$|A|\n|$12$|$75,000$|$75,000$|A|\n|$13$|$9 \\times 10 ^ 4$|$9 \\times 10 ^ 4$|A|\n|$14$|$10 ^ 5$|$10 ^ 5$|A|\n|$15$|$23,333$|$23,333$|B|\n|$16$|$75,000$|$75,000$|B|\n|$17$|$9 \\times 10 ^ 4$|$9 \\times 10 ^ 4$|B|\n|$18$|$10 ^ 5$|$10 ^ 5$|B|\n|$19$|$23,333$|$23,333$|无|\n|$20$|$5 \\times 10 ^ 4$|$5 \\times 10 ^ 4$|无|\n|$21$|$75,000$|$75,000$|无|\n|$22$|$9 \\times 10 ^ 4$|$9 \\times 10 ^ 4$|无|\n|$23$|$95,000$|$95,000$|无|\n|$24 \\sim 25$|$10 ^ 5$|$10 ^ 5$|无|\n\n特殊性质 A：保证字符串中仅包含字符 $\\texttt{a}$ 和 $\\texttt{b}$，且每个字符独立等概率地在 $\\texttt{a}$ 和 $\\texttt{b}$ 中选择。\n\n特殊性质 B：保证字符串中的相邻字符互不相同。\n\n**在洛谷上，本题 Subtask 1 中为 hack 数据，保证 $c=25$**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2023] 字符串", "background": "", "description": "小 Y 是一名大学生，最近正在研究字符串方向的问题。\n\n小 Y 了解到关于字符串的如下定义:\n\n- 给定一个长度为 $n$ 的字符串 $s[1: n]$，我们定义其子串 $s[l: r]$（$1 \\leq l \\leq r \\leq n$）为选择 $s[l], s[l+1], \\dots, s[r]$, 将其顺次拼接得到的新字符串。\n- 给定一个长度为 $n$ 的字符串 $s[1: n]$，我们定义其翻转后的结果 $R(s)$ 为将 $s[n], s[n-1], \\dots, s[1]$ 顺次拼接，也就是将字符串反序拼接得到的字符串。\n- 给定两个长度均为 $n$ 的字符串 $a[1: n], b[1: n]$，我们定义 $a$ 的字典序小于 $b$ 当且仅当存在 $1 \\leq i \\leq n$，使得对于任意 $1 \\leq j < i$，$a[j] = b[j]$，且 $a[i] < b[i]$。\n\n在了解了上述定义后，小 Y 想到了这样的问题:\n\n给定一个长度为 $n$ 的字符串 $s[1: n]$。有 $q$ 次询问，每次询问给定两个参数 $i, r$。你需要求出有多少 $l$，满足如下条件:\n- $1 \\leq l \\leq r$。\n- $s[i: i+l-1]$ 字典序小于 $R(s[i+l: i+2l-1])$。\n\n小 Y 想求助你帮忙解决这一问题。", "inputFormat": "**本题有多组测试数据。**\n\n输入的第一行包含两个整数 $c, t$，分别表示测试点编号和测试数据组数。$c=0$ 表示该测试点为样例。\n\n接下来依次输入每组测试数据，对于每组测试数据：\n\n输入的第一行包含两个正整数 $n, q$，表示字符串长度和询问次数。\n\n输入的第二行包含一个长度为 $n$ 的仅包含小写字母的字符串 $s$。\n\n输入的接下来 $q$ 行，每行包含两个正整数 $i, r$。表示一次询问，保证 $i+2r-1 \\leq n$。", "outputFormat": "对于每一组测试数据的每一次询问，输出一行一个整数，表示满足条件的 $l$ 的个数。", "hint": "**【样例解释 #1】**\n\n对于第一组数据的第一组询问：\n- $l = 1$ 时，$s[i: i + l - 1] = \\texttt{a}$，$R(s[i + l: i + 2l - 1]) = \\texttt{b}$。\n- $l = 2$ 时，$s[i: i + l - 1] = \\texttt{ab}$，$R(s[i + l: i + 2l - 1]) = \\texttt{ca}$。\n- $l = 3$ 时，$s[i: i + l - 1] = \\texttt{aba}$，$R(s[i + l: i + 2l - 1]) = \\texttt{bac}$。\n- $l = 4$ 时，$s[i: i + l - 1] = \\texttt{abac}$，$R(s[i + l: i + 2l - 1]) = \\texttt{baba}$。\n\n这四种情况中，$s[i: i + l - 1]$ 的字典序均小于 $R(s[i + l: i + 2l - 1])$。因此答案为 $4$。\n\n**【样例解释 #2】**\n\n该样例数据范围满足测试点 $5$。\n\n**【样例解释 #4】**\n\n该样例数据范围满足测试点 $24 \\sim 25$。\n\n**【数据范围】**\n\n对于所有测试数据保证：$1 \\le t \\le 5$，$1 \\le n \\le 10 ^ 5$，$1 \\le q \\le 10 ^ 5$，$1 \\le i + 2r - 1 \\le n $，字符串 $s$ 仅包含小写字母。\n\n|测试点编号|$n \\le$|$q \\le$|特殊性质|\n|:-:|:-:|:-:|:-:|\n|$1$|$5$|$5$|A|\n|$2$|$10$|$10$|A|\n|$3$|$20$|$20$|A|\n|$4$|$50$|$50$|A|\n|$5$|$10^2$|$10^2$|A|\n|$6$|$10^3$|$10^3$|无|\n|$7$|$2,000$|$2,000$|无|\n|$8$|$3,000$|$3,000$|无|\n|$9$|$4,000$|$4,000$|无|\n|$10$|$23,333$|$23,333$|A|\n|$11$|$5 \\times 10 ^ 4$|$5 \\times 10 ^ 4$|A|\n|$12$|$75,000$|$75,000$|A|\n|$13$|$9 \\times 10 ^ 4$|$9 \\times 10 ^ 4$|A|\n|$14$|$10 ^ 5$|$10 ^ 5$|A|\n|$15$|$23,333$|$23,333$|B|\n|$16$|$75,000$|$75,000$|B|\n|$17$|$9 \\times 10 ^ 4$|$9 \\times 10 ^ 4$|B|\n|$18$|$10 ^ 5$|$10 ^ 5$|B|\n|$19$|$23,333$|$23,333$|无|\n|$20$|$5 \\times 10 ^ 4$|$5 \\times 10 ^ 4$|无|\n|$21$|$75,000$|$75,000$|无|\n|$22$|$9 \\times 10 ^ 4$|$9 \\times 10 ^ 4$|无|\n|$23$|$95,000$|$95,000$|无|\n|$24 \\sim 25$|$10 ^ 5$|$10 ^ 5$|无|\n\n特殊性质 A：保证字符串中仅包含字符 $\\texttt{a}$ 和 $\\texttt{b}$，且每个字符独立等概率地在 $\\texttt{a}$ 和 $\\texttt{b}$ 中选择。\n\n特殊性质 B：保证字符串中的相邻字符互不相同。\n\n**在洛谷上，本题 Subtask 1 中为 hack 数据，保证 $c=25$**。", "locale": "zh-CN"}}}
{"pid": "P9483", "type": "P", "difficulty": 7, "samples": [["1\n4\n1 1 1 1\n", "6\n"], ["见附件中的 book/book2.in。", "见附件中的 book/book2.ans。"], ["见附件中的 book/book3.in。", "见附件中的 book/book3.ans。"], ["见附件中的 book/book4.in。", "见附件中的 book/book4.ans。"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["搜索", "2023", "NOI", "O2优化"], "title": "[NOI2023] 合并书本", "background": "", "description": "小 C 有 $n$ 本书，每本书都有一个重量，他决定把它们合并成一摞。\n\n每一次合并小 C 可以把一摞书放到另一摞书上面，使得它们合并到一摞。如果小 C 把第 $i$ 摞书放到第 $j$ 摞书上面，小 C 需要消耗的体力为**第 $i$ 摞书的重量**加上**两摞书的磨损值之和**。\n\n初始时每本书自成一摞且磨损值均为 $0$。每当小 C 将两摞书合并后，形成的新的一摞书的磨损值为合并前的两摞书的磨损值的**较大值的两倍再加一**，重量为合并前的两摞书的**重量之和**。\n\n你的任务是设计出合并的次序方案，使小 C 耗费的体力最少，并输出这个最小的体力耗费值。", "inputFormat": "**本题有多组测试数据。**\n\n输入的第一行包含一个正整数 $t$，表示数据组数。\n\n接下来依次输入每组测试数据，对于每组测试数据：\n\n输入的第一行包含一个正整数 $n$，表示有 $n$ 本书。\n\n输入的第二行包含 $n$ 个正整数，第 $i$ 个数 $w_i$ 表示第 $i$ 本书的重量。", "outputFormat": "对于每组测试数据输出一行一个整数，表示将 $n$ 本书合并成一摞需要消耗的最少体力。", "hint": "**【样例解释 #1】**\n\n如果小 C 将 $4$ 本书两两合并再将得到的两摞合并成一摞，那么前两次需要消耗的体力值各为 $1$。第三次将一摞重量为 $2$ 的书放到另一摞上面，两摞书磨损值各为 $1$，需要消耗的体力为 $2 + 1 + 1 = 4$。\n\n因此如果选择这个方案，小 C 耗费的体力只有 $1 + 1 + 4 = 6$。\n\n可以证明，在上述例子中，$6$ 为最小的体力耗费值。\n\n**【数据范围】**\n\n对于所有测试数据保证：$1 \\le t \\le 10$，$1 \\le n \\le 100$，$1 \\le w_i \\le 10 ^ 9$。\n\n|测试点编号|$n \\le$|是否有特殊性质|\n|:-:|:-:|:-:|\n|$1 \\sim 2$|$7$|否|\n|$3$|$11$|否|\n|$4$|$13$|否|\n|$5 \\sim 6$|$22$|否|\n|$7 \\sim 8$|$28$|否|\n|$9 \\sim 13$|$50$|否|\n|$14$|$60$|否|\n|$15$|$70$|否|\n|$16$|$80$|否|\n|$17 \\sim 18$|$100$|是|\n|$19 \\sim 20$|$100$|否|\n\n特殊性质：保证 $w_i = 1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2023] 合并书本", "background": "", "description": "小 C 有 $n$ 本书，每本书都有一个重量，他决定把它们合并成一摞。\n\n每一次合并小 C 可以把一摞书放到另一摞书上面，使得它们合并到一摞。如果小 C 把第 $i$ 摞书放到第 $j$ 摞书上面，小 C 需要消耗的体力为**第 $i$ 摞书的重量**加上**两摞书的磨损值之和**。\n\n初始时每本书自成一摞且磨损值均为 $0$。每当小 C 将两摞书合并后，形成的新的一摞书的磨损值为合并前的两摞书的磨损值的**较大值的两倍再加一**，重量为合并前的两摞书的**重量之和**。\n\n你的任务是设计出合并的次序方案，使小 C 耗费的体力最少，并输出这个最小的体力耗费值。", "inputFormat": "**本题有多组测试数据。**\n\n输入的第一行包含一个正整数 $t$，表示数据组数。\n\n接下来依次输入每组测试数据，对于每组测试数据：\n\n输入的第一行包含一个正整数 $n$，表示有 $n$ 本书。\n\n输入的第二行包含 $n$ 个正整数，第 $i$ 个数 $w_i$ 表示第 $i$ 本书的重量。", "outputFormat": "对于每组测试数据输出一行一个整数，表示将 $n$ 本书合并成一摞需要消耗的最少体力。", "hint": "**【样例解释 #1】**\n\n如果小 C 将 $4$ 本书两两合并再将得到的两摞合并成一摞，那么前两次需要消耗的体力值各为 $1$。第三次将一摞重量为 $2$ 的书放到另一摞上面，两摞书磨损值各为 $1$，需要消耗的体力为 $2 + 1 + 1 = 4$。\n\n因此如果选择这个方案，小 C 耗费的体力只有 $1 + 1 + 4 = 6$。\n\n可以证明，在上述例子中，$6$ 为最小的体力耗费值。\n\n**【数据范围】**\n\n对于所有测试数据保证：$1 \\le t \\le 10$，$1 \\le n \\le 100$，$1 \\le w_i \\le 10 ^ 9$。\n\n|测试点编号|$n \\le$|是否有特殊性质|\n|:-:|:-:|:-:|\n|$1 \\sim 2$|$7$|否|\n|$3$|$11$|否|\n|$4$|$13$|否|\n|$5 \\sim 6$|$22$|否|\n|$7 \\sim 8$|$28$|否|\n|$9 \\sim 13$|$50$|否|\n|$14$|$60$|否|\n|$15$|$70$|否|\n|$16$|$80$|否|\n|$17 \\sim 18$|$100$|是|\n|$19 \\sim 20$|$100$|否|\n\n特殊性质：保证 $w_i = 1$。", "locale": "zh-CN"}}}
{"pid": "P9484", "type": "P", "difficulty": 2, "samples": [["1\n6 4\n1 4\n3 5\n2 5\n2 4", "3\n6\n5\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536]}, "tags": ["搜索", "数学", "贪心", "数论", "洛谷原创", "O2优化", "最短路", "最大公约数 gcd"], "title": "「LAOI-1」GCD", "background": "", "description": "一张图有 $n$ 个节点，编号为 $1,2,3,\\dots,n$。其中 $i$ 号节点会向 $j$ 号节点连一条边权为 $|i-j|$ 的无向边，当且仅当 $\\gcd(i,j)=i,\\operatorname{lcm}(i,j)=j$ 时连边。现询问 $q$ 次，每次询问求 $x$ 到 $y$ 的最短路径。", "inputFormat": "第一行一个 $T$，表示数据组数。\n\n每组数据的第一行两个正整数 $n,q$，表示节点数和询问次数。\n\n接下来 $q$ 行，每行两个正整数 $x,y$，表示起点和终点。", "outputFormat": "对于每组询问，输出一个正整数。相邻两个输出以换行符隔开。", "hint": "注意时空限制，本题不捆绑。\n\n对于 $40\\%$ 的数据，$T,n,q\\le100$;\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^6$，$1\\le n,q\\le10^6$，$1\\le x,y\\le n$，$1\\le \\sum n,\\sum q\\le10^6$。\n\n**请使用更快的 IO 方式**。\n\nupdata on 2024/8/8：\n\n时限上调到 1000ms。/yun", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「LAOI-1」GCD", "background": "", "description": "一张图有 $n$ 个节点，编号为 $1,2,3,\\dots,n$。其中 $i$ 号节点会向 $j$ 号节点连一条边权为 $|i-j|$ 的无向边，当且仅当 $\\gcd(i,j)=i,\\operatorname{lcm}(i,j)=j$ 时连边。现询问 $q$ 次，每次询问求 $x$ 到 $y$ 的最短路径。", "inputFormat": "第一行一个 $T$，表示数据组数。\n\n每组数据的第一行两个正整数 $n,q$，表示节点数和询问次数。\n\n接下来 $q$ 行，每行两个正整数 $x,y$，表示起点和终点。", "outputFormat": "对于每组询问，输出一个正整数。相邻两个输出以换行符隔开。", "hint": "注意时空限制，本题不捆绑。\n\n对于 $40\\%$ 的数据，$T,n,q\\le100$;\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^6$，$1\\le n,q\\le10^6$，$1\\le x,y\\le n$，$1\\le \\sum n,\\sum q\\le10^6$。\n\n**请使用更快的 IO 方式**。\n\nupdata on 2024/8/8：\n\n时限上调到 1000ms。/yun", "locale": "zh-CN"}}}
{"pid": "P9485", "type": "P", "difficulty": 4, "samples": [["3\n6\n3 2 1 1 2 3\n6\n1 1 4 5 1 4\n6\n1 9 1 9 8 10", "2\n0\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "洛谷原创", "O2优化", "前缀和"], "title": "「LAOI-1」积水", "background": "", "description": "\n\n地表坑洼不平，每当暴雨来临地面上都会有一个个水洼。   \n又有一场暴雨即将来临，你决定改造地面来减少积水。     \n地面可抽象为一个长度为 $n$ 的正整数序列 $a$，其中 $a_i$ 表示当地的海拔高度。       \n下暴雨时将会汇聚在低洼处无法向两侧流走，比如一个序列 $a=[3,1,5,1,2,3]$。     \n在下雨后的积水如图所示（有 $5$ 格积水）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/79on2oe3.png)\n\n由于人手不足，现在只来得及改变一个地方的海拔高度为任意正整数。\n\n问改造后积水最少有几格。\n\n\n\n\n", "inputFormat": "第一行一个整数 $T$。    \n接下来共 $T$ 组数据，每组数据占两行。     \n对于每组数据，第一行一个整数 $n$，表示序列长度。     \n第二行 $n$ 个整数，表示序列 $a$。", "outputFormat": "对于每组数据输出一行一个整数，最小的积水格数。", "hint": "对于前 $5\\%$ 的数据，$1\\le n\\le 5$。       \n对于前 $20\\%$ 的数据，$1\\le \\sum  n\\le 550$，$1\\le a_i\\le 500$。     \n对于前 $35\\%$ 的数据，$1\\le \\sum n\\le 5050$，$1\\le a_i\\le 5000$。    \n对于前 $50\\%$ 的数据，$1\\le \\sum n\\le 5050$，$1\\le a_i \\le 10^9$。  \n对于 $100\\%$ 的数据，$1\\le n,\\sum n\\le 10^6$，$1\\le a_i\\le 10^9$。\n\n保证 $1\\le T\\le 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「LAOI-1」积水", "background": "", "description": "\n\n地表坑洼不平，每当暴雨来临地面上都会有一个个水洼。   \n又有一场暴雨即将来临，你决定改造地面来减少积水。     \n地面可抽象为一个长度为 $n$ 的正整数序列 $a$，其中 $a_i$ 表示当地的海拔高度。       \n下暴雨时将会汇聚在低洼处无法向两侧流走，比如一个序列 $a=[3,1,5,1,2,3]$。     \n在下雨后的积水如图所示（有 $5$ 格积水）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/79on2oe3.png)\n\n由于人手不足，现在只来得及改变一个地方的海拔高度为任意正整数。\n\n问改造后积水最少有几格。\n\n\n\n\n", "inputFormat": "第一行一个整数 $T$。    \n接下来共 $T$ 组数据，每组数据占两行。     \n对于每组数据，第一行一个整数 $n$，表示序列长度。     \n第二行 $n$ 个整数，表示序列 $a$。", "outputFormat": "对于每组数据输出一行一个整数，最小的积水格数。", "hint": "对于前 $5\\%$ 的数据，$1\\le n\\le 5$。       \n对于前 $20\\%$ 的数据，$1\\le \\sum  n\\le 550$，$1\\le a_i\\le 500$。     \n对于前 $35\\%$ 的数据，$1\\le \\sum n\\le 5050$，$1\\le a_i\\le 5000$。    \n对于前 $50\\%$ 的数据，$1\\le \\sum n\\le 5050$，$1\\le a_i \\le 10^9$。  \n对于 $100\\%$ 的数据，$1\\le n,\\sum n\\le 10^6$，$1\\le a_i\\le 10^9$。\n\n保证 $1\\le T\\le 10^4$。", "locale": "zh-CN"}}}
{"pid": "P9486", "type": "P", "difficulty": 4, "samples": [["6 0\n2 2 2\n3 2 2\n4 2 2\n7 2 3\n13 2 6\n14 2 6", "Yes\nYes\nNo\nYes\nYes\nNo"], ["6 0\n4 3 2\n5 3 3\n13 3 5\n13 3 6\n5 100 1000000000000\n123454204 4321 97", "Yes\nNo\nYes\nNo\nYes\nNo"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创"], "title": "「LAOI-1」Bash Game-Plus", "background": "", "description": ">巴什博弈：有一堆 $n$ 个物品，两名玩家轮流从中拿取物品。每次至少拿 $1$ 个，至多拿 $m$ 个，不能不拿，最终将物品拿完者获胜。\n\n我们给这个游戏增加一些规则：\n\n有一堆 $n$ 个物品，甲和乙轮流从中拿取物品，甲先拿。每次至少拿 $1$ 个，至多拿 $m$ 个，最终将物品拿完者获胜。    \n现在新加入一条规则：**也可以不拿**，但每当有一名玩家选择不拿物品时，接下来的 $k$ 次操作中两名玩家都不可以不拿。\n\n举个例子，当 $k=3$ 时，如果甲在某一次操作中没有拿物品，那么接下来乙、甲、乙三轮都必须拿至少 $1$ 件物品。然后又轮到甲了，这次甲就可以再次选择不拿。\n\n甲乙两人一共进行了 $t$ 次游戏。对于每次游戏，你需要告诉甲他有没有必胜策略。", "inputFormat": "第一行两个正整数 $t,op$。$op=1$ 时取消新增加的规则，但是也需要正常读入 $k$。\n\n接下来的 $t$ 行，每行三个正整数 $n,m,k$。", "outputFormat": "对于每轮游戏，如果甲有必胜策略，那么输出 `Yes`。否则输出 `No`。", "hint": "| Subtask | 得分 | $t$ | $op$ | $n\\le$ | $m\\le$ | $k\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $2$ | $100000$ | $1$ | $10^{18}$ | $10^{18}$ | $k=114514$ |  |\n| $1$ | $2$ | $99994$ | $0$ | $10^{18}$ | $10^{18}$ | $k=1$ |  |\n| $2$ | $9$ | $99995$ | $0$ | $10^{18}$ | $10^{18}$ | $3$ |  |\n| $3$ | $5$ | $99996$ | $0$ | $10^{18}$ | $10^{18}$ | $k\\ge n$ |  |\n| $4$ | $10$ | $50$ | $0$ | $50$ | $50$ | $10^{18}$ |  |\n| $5$ | $13$ | $99997$ | $0$ | $100$ | $100$ | $10^{18}$ |  |\n| $6$ | $16$ | $99998$ | $0$ | $400$ | $400$ | $10^{18}$ | $A$ |\n| $7$ | $10$ | $99999$ | $0$ | $5000$ | $5000$ | $10^{18}$ |  |\n| $8$ | $31$ | $100000$ | $0$ | $10^{18}$ | $10^{18}$ | $10^{18}$ |  |\n| $9$ | ~~45~~ $2$ | $99993$ | $0$ | $10^{18}$ | $10^{18}$ | $10^{18}$ | 不可以，总司令 |\n\n特殊性质 $A$ ：所有 $m$ 相等。\n\n对于所有数据：$t\\le10^5$，$1\\le n,m,k\\le10^{18}$\n\n不保证数据随机。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「LAOI-1」Bash Game-Plus", "background": "", "description": ">巴什博弈：有一堆 $n$ 个物品，两名玩家轮流从中拿取物品。每次至少拿 $1$ 个，至多拿 $m$ 个，不能不拿，最终将物品拿完者获胜。\n\n我们给这个游戏增加一些规则：\n\n有一堆 $n$ 个物品，甲和乙轮流从中拿取物品，甲先拿。每次至少拿 $1$ 个，至多拿 $m$ 个，最终将物品拿完者获胜。    \n现在新加入一条规则：**也可以不拿**，但每当有一名玩家选择不拿物品时，接下来的 $k$ 次操作中两名玩家都不可以不拿。\n\n举个例子，当 $k=3$ 时，如果甲在某一次操作中没有拿物品，那么接下来乙、甲、乙三轮都必须拿至少 $1$ 件物品。然后又轮到甲了，这次甲就可以再次选择不拿。\n\n甲乙两人一共进行了 $t$ 次游戏。对于每次游戏，你需要告诉甲他有没有必胜策略。", "inputFormat": "第一行两个正整数 $t,op$。$op=1$ 时取消新增加的规则，但是也需要正常读入 $k$。\n\n接下来的 $t$ 行，每行三个正整数 $n,m,k$。", "outputFormat": "对于每轮游戏，如果甲有必胜策略，那么输出 `Yes`。否则输出 `No`。", "hint": "| Subtask | 得分 | $t$ | $op$ | $n\\le$ | $m\\le$ | $k\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $2$ | $100000$ | $1$ | $10^{18}$ | $10^{18}$ | $k=114514$ |  |\n| $1$ | $2$ | $99994$ | $0$ | $10^{18}$ | $10^{18}$ | $k=1$ |  |\n| $2$ | $9$ | $99995$ | $0$ | $10^{18}$ | $10^{18}$ | $3$ |  |\n| $3$ | $5$ | $99996$ | $0$ | $10^{18}$ | $10^{18}$ | $k\\ge n$ |  |\n| $4$ | $10$ | $50$ | $0$ | $50$ | $50$ | $10^{18}$ |  |\n| $5$ | $13$ | $99997$ | $0$ | $100$ | $100$ | $10^{18}$ |  |\n| $6$ | $16$ | $99998$ | $0$ | $400$ | $400$ | $10^{18}$ | $A$ |\n| $7$ | $10$ | $99999$ | $0$ | $5000$ | $5000$ | $10^{18}$ |  |\n| $8$ | $31$ | $100000$ | $0$ | $10^{18}$ | $10^{18}$ | $10^{18}$ |  |\n| $9$ | ~~45~~ $2$ | $99993$ | $0$ | $10^{18}$ | $10^{18}$ | $10^{18}$ | 不可以，总司令 |\n\n特殊性质 $A$ ：所有 $m$ 相等。\n\n对于所有数据：$t\\le10^5$，$1\\le n,m,k\\le10^{18}$\n\n不保证数据随机。", "locale": "zh-CN"}}}
{"pid": "P9487", "type": "P", "difficulty": 5, "samples": [["7 1\n1 1 1 1 1 1 1\n1 2 3\n3 6 -4\n2 5 2\n1 3 6\n2 4 1\n3 7 5\n4 7", "8"], ["10 10\n786755 -687509 368192 154769 647117 -713535 337677 913223 -389809 -824004 \n1 2 -785875\n1 3 -77082\n1 4 -973070\n3 5 -97388\n2 6 -112274\n3 7 657757\n4 8 741733\n3 9 5656\n4 10 -35190\n3 3\n3 10\n7 3\n5 1\n2 10\n10 10\n1 6\n7 2\n8 9\n9 1\n", "971424\n-1257332\n1309101\n3420605\n-2313033\n-2567048\n-2467802\n352646\n759321\n1368370\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "倍增", "洛谷原创", "O2优化", "树形 DP", "树链剖分", "ST 表", "分类讨论"], "title": "「LAOI-1」小熊游景点", "background": "", "description": "小熊的地图上有 $n$ 个景点，每个景点有分数 $s_i$。\n\n$n-1$ 个点对之间有双向直达的公交线路，每条线路有收费 $w_i$。\n\n现在小熊在 $a$ 景点，总司令在 $b$ 景点，他们要**沿简单路径**在 $a\\to b$ 路径上的 $p$ 景点汇合，然后**沿简单路径**一起去 $q$ 景点。（$q$ 为任意点，每个人不会游览两次 $p$ 景点）\n\n$m$ 次询问，给定 $a,b$，求 $p,q$，使得小熊和总司令花费之和最小的前提下他们经过的景点分数之和最大，输出他们经过的景点分数之和。（指小熊经过的景点分数之和 $+$ 总司令经过的景点分数之和）\n\n**重复经过的线路收费重复计算，重复经过的景点分数重复计算。**", "inputFormat": "第一行两个整数 $n,m$。分别表示景点个数和询问次数。\n\n接下来一行 $n$ 个整数 第 $i$ 个整数 $s_i$ 表示第 $i$ 个景点的权值。\n\n接下来 $n-1$ 行，每行 $3$ 个整数 $u,v,w$，表示 $u$ 节点和 $v$ 节点之间有一条收费 $w$ 的双向公交路线。\n\n接下来 $m$ 行，每行两个整数 $a$ 和 $b$，表示小熊和总司令所在的景点位置。", "outputFormat": "对于每组询问，每行输出一个整数表示结果。", "hint": "### 样例说明\n对于第一组样例，小熊的地图如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ktyzyrx7.png)\n\n其中 $a=4,b=7$，令 $p=3,q=6$。\n\n小熊的路径为 $4\\to2\\to1\\to3\\to6$，花费之和为 $1+3+6+(-4)=6$，景点分数之和为 $1+1+1+1+1=5$。\n\n总司令的路径为 $7\\to3\\to6$，花费之和为 $5+(-4)=1$，景点分数之和为 $1+1+1=3$。\n\n小熊和总司令花费之和为 $6+1=7$，经过的景点分数之和为 $5+3=8$。\n\n可以证明此时小熊和总司令花费之和最小的前提下他们经过的景点分数之和最大。\n\n------------\n\n### 数据范围\n**本题采用捆绑测试。**\n\n| Subtask | $n,m$ | $s_i,w_i$ | 特殊性质 | 分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=3\\times10^5$ | $\\in\\lbrack0,10^6\\rbrack$ | 无 | $10$ |\n| $2$ | $=3\\times10^5$ | $\\in\\lbrack-10^6,10^6\\rbrack$ | 小熊的地图是一条链 | $10$ |\n| $3$ | $=3\\times10^2$ | $\\in\\lbrack-10^6,10^6\\rbrack$ | 无 | $5$ |\n| $4$ | $=3\\times10^3$ | $\\in\\lbrack-10^6,10^6\\rbrack$ | 无 | $15$ |\n| $5$ | $\\le 3\\times10^5$ | $\\in\\lbrack-10^6,10^6\\rbrack$ | 无 | $60$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 3\\times 10^5$，$\\vert s_i\\vert,\\vert w_i\\vert\\le10^6$，小熊的地图是一棵树。\n\n（小熊都可以游览景点了，公交价格和景点分数怎么不可以是负数呢？）", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「LAOI-1」小熊游景点", "background": "", "description": "小熊的地图上有 $n$ 个景点，每个景点有分数 $s_i$。\n\n$n-1$ 个点对之间有双向直达的公交线路，每条线路有收费 $w_i$。\n\n现在小熊在 $a$ 景点，总司令在 $b$ 景点，他们要**沿简单路径**在 $a\\to b$ 路径上的 $p$ 景点汇合，然后**沿简单路径**一起去 $q$ 景点。（$q$ 为任意点，每个人不会游览两次 $p$ 景点）\n\n$m$ 次询问，给定 $a,b$，求 $p,q$，使得小熊和总司令花费之和最小的前提下他们经过的景点分数之和最大，输出他们经过的景点分数之和。（指小熊经过的景点分数之和 $+$ 总司令经过的景点分数之和）\n\n**重复经过的线路收费重复计算，重复经过的景点分数重复计算。**", "inputFormat": "第一行两个整数 $n,m$。分别表示景点个数和询问次数。\n\n接下来一行 $n$ 个整数 第 $i$ 个整数 $s_i$ 表示第 $i$ 个景点的权值。\n\n接下来 $n-1$ 行，每行 $3$ 个整数 $u,v,w$，表示 $u$ 节点和 $v$ 节点之间有一条收费 $w$ 的双向公交路线。\n\n接下来 $m$ 行，每行两个整数 $a$ 和 $b$，表示小熊和总司令所在的景点位置。", "outputFormat": "对于每组询问，每行输出一个整数表示结果。", "hint": "### 样例说明\n对于第一组样例，小熊的地图如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ktyzyrx7.png)\n\n其中 $a=4,b=7$，令 $p=3,q=6$。\n\n小熊的路径为 $4\\to2\\to1\\to3\\to6$，花费之和为 $1+3+6+(-4)=6$，景点分数之和为 $1+1+1+1+1=5$。\n\n总司令的路径为 $7\\to3\\to6$，花费之和为 $5+(-4)=1$，景点分数之和为 $1+1+1=3$。\n\n小熊和总司令花费之和为 $6+1=7$，经过的景点分数之和为 $5+3=8$。\n\n可以证明此时小熊和总司令花费之和最小的前提下他们经过的景点分数之和最大。\n\n------------\n\n### 数据范围\n**本题采用捆绑测试。**\n\n| Subtask | $n,m$ | $s_i,w_i$ | 特殊性质 | 分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=3\\times10^5$ | $\\in\\lbrack0,10^6\\rbrack$ | 无 | $10$ |\n| $2$ | $=3\\times10^5$ | $\\in\\lbrack-10^6,10^6\\rbrack$ | 小熊的地图是一条链 | $10$ |\n| $3$ | $=3\\times10^2$ | $\\in\\lbrack-10^6,10^6\\rbrack$ | 无 | $5$ |\n| $4$ | $=3\\times10^3$ | $\\in\\lbrack-10^6,10^6\\rbrack$ | 无 | $15$ |\n| $5$ | $\\le 3\\times10^5$ | $\\in\\lbrack-10^6,10^6\\rbrack$ | 无 | $60$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 3\\times 10^5$，$\\vert s_i\\vert,\\vert w_i\\vert\\le10^6$，小熊的地图是一棵树。\n\n（小熊都可以游览景点了，公交价格和景点分数怎么不可以是负数呢？）", "locale": "zh-CN"}}}
{"pid": "P9488", "type": "P", "difficulty": 4, "samples": [["4", "4"], ["30", "183"], ["100", "1916"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "ZHY 的生成树", "background": "", "description": "ZHY 有一个 $n$ 个点的完全图，点 $u$ 与点 $v$ 的距离为 $\\gcd(u,v)$，求这个完全图的最大生成树的边权之和。", "inputFormat": "一个正整数 $n$。", "outputFormat": "一个整数，表示这个最大生成树的边权之和。", "hint": "**本题采用捆绑测试。**\n\n$\\text{Subtask}$ $0\\kern{3pt}$(10pts)：$n\\le 5$。\n\n$\\text{Subtask}$ $1\\kern{3pt}$(20pts)：$n\\le 1000$。\n\n$\\text{Subtask}$ $2\\kern{3pt}$(30pts)：$n\\le 10^{6}$。\n\n$\\text{Subtask}$ $3\\kern{3pt}$(40pts)：$n\\le 10^{7}$。\n\n对于所有测试数据，$1\\le n \\le 10^{7}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "ZHY 的生成树", "background": "", "description": "ZHY 有一个 $n$ 个点的完全图，点 $u$ 与点 $v$ 的距离为 $\\gcd(u,v)$，求这个完全图的最大生成树的边权之和。", "inputFormat": "一个正整数 $n$。", "outputFormat": "一个整数，表示这个最大生成树的边权之和。", "hint": "**本题采用捆绑测试。**\n\n$\\text{Subtask}$ $0\\kern{3pt}$(10pts)：$n\\le 5$。\n\n$\\text{Subtask}$ $1\\kern{3pt}$(20pts)：$n\\le 1000$。\n\n$\\text{Subtask}$ $2\\kern{3pt}$(30pts)：$n\\le 10^{6}$。\n\n$\\text{Subtask}$ $3\\kern{3pt}$(40pts)：$n\\le 10^{7}$。\n\n对于所有测试数据，$1\\le n \\le 10^{7}$。", "locale": "zh-CN"}}}
{"pid": "P9489", "type": "P", "difficulty": 5, "samples": [["2 5 10\n2 3", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "O2优化", "容斥原理"], "title": "ZHY 的表示法", "background": "", "description": "ZHY 称一个正整数 $x$ 是**可被表示的**，当且仅当存在一个实数 $y$，满足 $\\lfloor \\frac y {x_1} \\rfloor+\\lfloor \\frac y {x_2} \\rfloor+\\cdots + \\lfloor \\frac y {x_n} \\rfloor=x$。现在，ZHY 想知道区间 $[l,r]$ 中有多少个正整数是可被表示的。", "inputFormat": "第一行三个正整数 $n,l,r$。\n\n第二行 $n$ 个正整数 $x_1,x_2,\\cdots,x_n$。", "outputFormat": "一行一个整数表示答案。", "hint": "**样例解释**\n\n当 $x=5$ 时，取 $y=6$ 成立。  \n当 $x=6$ 时，取 $y=8$ 成立。  \n当 $x=7$ 时，取 $y=9$ 成立。  \n当 $x=8$ 时，取 $y=10$ 成立。  \n当 $x=10$ 时，取 $y=12$ 成立。  \n\n故 $5,6,7,8,10$ 是可被表示的，可以证明，对于任意实数 $y$，$\\lfloor \\frac y {2} \\rfloor+\\lfloor \\frac y {3} \\rfloor\\ne 9$。故答案为 $5$。\n\n----\n\n**数据范围**\n\n对于 $30\\%$ 的数据，$l \\le r \\le 10^5$。\n\n对于另外 $10\\%$ 的数据，$n=1$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 25$，$1 \\le l \\le r \\le 10^9$，$1 \\le x_1,x_2,\\cdots,x_n \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "ZHY 的表示法", "background": "", "description": "ZHY 称一个正整数 $x$ 是**可被表示的**，当且仅当存在一个实数 $y$，满足 $\\lfloor \\frac y {x_1} \\rfloor+\\lfloor \\frac y {x_2} \\rfloor+\\cdots + \\lfloor \\frac y {x_n} \\rfloor=x$。现在，ZHY 想知道区间 $[l,r]$ 中有多少个正整数是可被表示的。", "inputFormat": "第一行三个正整数 $n,l,r$。\n\n第二行 $n$ 个正整数 $x_1,x_2,\\cdots,x_n$。", "outputFormat": "一行一个整数表示答案。", "hint": "**样例解释**\n\n当 $x=5$ 时，取 $y=6$ 成立。  \n当 $x=6$ 时，取 $y=8$ 成立。  \n当 $x=7$ 时，取 $y=9$ 成立。  \n当 $x=8$ 时，取 $y=10$ 成立。  \n当 $x=10$ 时，取 $y=12$ 成立。  \n\n故 $5,6,7,8,10$ 是可被表示的，可以证明，对于任意实数 $y$，$\\lfloor \\frac y {2} \\rfloor+\\lfloor \\frac y {3} \\rfloor\\ne 9$。故答案为 $5$。\n\n----\n\n**数据范围**\n\n对于 $30\\%$ 的数据，$l \\le r \\le 10^5$。\n\n对于另外 $10\\%$ 的数据，$n=1$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 25$，$1 \\le l \\le r \\le 10^9$，$1 \\le x_1,x_2,\\cdots,x_n \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P9490", "type": "P", "difficulty": 6, "samples": [["3 2 2\n1 1 1\n2 2 0\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "递推", "O2优化", "分类讨论"], "title": "ZHY 的矩阵", "background": "", "description": "ZHY 的记忆中有一个 $k$ 行 $n$ 列的 01 矩阵 $A$，满足下列条件：\n\n- 每一列都至多有一个 $1$。\n- 每行相邻的两个 $1$ 所在的两列夹出的 $k$ 行的矩形（包括这两列）内至少有三个 $1$。\n\n突然，ZHY 想起来了矩阵中 $x$ 个位置的值。请你计算有多少种填充 $A$ 的剩余位置的方案，使得 $A$ 满足条件。\n\n----\n\n形式化的讲，设 $A$ 第 $i$ 行第 $j$ 列的数为 $A_{i,j}$，则 $A$ 满足下列条件：\n\n- 对于 $\\forall i \\in [1,k],\\kern{2pt}j \\in [1,n]$，$A_{i,j} \\in \\{0,1\\}$。\n\n- 对于 $\\forall i \\in [1,n]$，$\\displaystyle\\sum_{j=1}^{k} A_{j,i}\\le 1$。\n\n- 对于 $\\forall i,j \\in [1,n],\\kern{2pt}p \\in [1,k]$ 且 $j>i$，若有 $A_{p,i}=A_{p,j}=1,\\displaystyle \\sum_{x=i}^{j}A_{p,x}=2$，则有 $\\Big(\\displaystyle \\sum_{x=1}^{k} \\sum_{y=i}^{j} A_{x,y}\\Big) \\ge 3$。\n\n- 对于 $\\forall i\\in[1,x]$，有 $A_{a_{i},b_{i}}=c_{i}$。\n\n由于答案可能很大，你只需告诉 ZHY 答案对 $10^{9}+7$ 取模的结果。定义两个矩阵 $A,A'$ 不同，当且仅当存在 $i\\in[1,k]$，$j\\in[1,n]$ 满足 $A_{i,j}\\ne A'_{i,j}$。", "inputFormat": "第一行三个整数，表示 $n,k,x$。\n\n接下来 $x$ 行，每行三个整数 $a_{i},b_{i},c_{i}$。", "outputFormat": "一行一个整数，表示答案。", "hint": "**样例解释**\n\n满足条件的矩阵只有以下 $2$ 种：\n\n$$\n\\begin{Bmatrix}\n1&0&0\\\\\n0&0&0\n\\end{Bmatrix}\n$$\n\n$$\n\\begin{Bmatrix}\n1&0&0\\\\\n0&0&1\n\\end{Bmatrix}\n$$\n\n----\n\n\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask} \\kern{2pt} \\mathrm{id}$ | $n$ | $x$ | 特殊性质 | 分值 |\n| :-----: | :-----: | :-----: | :-----: | :-----: |\n| $0$ | $\\le 8$ | $\\le 8$ | $k=2$ | $12$ |\n| $1$ | $\\le 2 \\times 10^{5}$ | $\\le 2\\times 10^{5}$ | 无 | $26$ |\n| $2$ | $\\le 10^{9}$ | $=0$ | 无 | $23$ |\n| $3$ | $\\le 10^{9}$ | $\\le 2\\times 10^{5}$ | $c_{i}=1$ | $15$ |\n| $4$ | $\\le 10^{9}$ | $\\le 2\\times 10^{5}$ | 无 | $24$ |\n\n对于所有数据，$1 \\le n \\le 10^{9}$，$0 \\le x \\le 2\\times 10^{5}$，$2\\le k \\le 100$。$1 \\le a_{i} \\le k$，$1 \\le b_{i} \\le n$，$c_{i} \\in \\{0,1\\}$。保证不存在一对 $i,j \\in [1,x],\\kern{2pt}i\\neq j$，满足 $a_{i}=a_{j},\\kern{2pt}b_{i}=b_{j}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "ZHY 的矩阵", "background": "", "description": "ZHY 的记忆中有一个 $k$ 行 $n$ 列的 01 矩阵 $A$，满足下列条件：\n\n- 每一列都至多有一个 $1$。\n- 每行相邻的两个 $1$ 所在的两列夹出的 $k$ 行的矩形（包括这两列）内至少有三个 $1$。\n\n突然，ZHY 想起来了矩阵中 $x$ 个位置的值。请你计算有多少种填充 $A$ 的剩余位置的方案，使得 $A$ 满足条件。\n\n----\n\n形式化的讲，设 $A$ 第 $i$ 行第 $j$ 列的数为 $A_{i,j}$，则 $A$ 满足下列条件：\n\n- 对于 $\\forall i \\in [1,k],\\kern{2pt}j \\in [1,n]$，$A_{i,j} \\in \\{0,1\\}$。\n\n- 对于 $\\forall i \\in [1,n]$，$\\displaystyle\\sum_{j=1}^{k} A_{j,i}\\le 1$。\n\n- 对于 $\\forall i,j \\in [1,n],\\kern{2pt}p \\in [1,k]$ 且 $j>i$，若有 $A_{p,i}=A_{p,j}=1,\\displaystyle \\sum_{x=i}^{j}A_{p,x}=2$，则有 $\\Big(\\displaystyle \\sum_{x=1}^{k} \\sum_{y=i}^{j} A_{x,y}\\Big) \\ge 3$。\n\n- 对于 $\\forall i\\in[1,x]$，有 $A_{a_{i},b_{i}}=c_{i}$。\n\n由于答案可能很大，你只需告诉 ZHY 答案对 $10^{9}+7$ 取模的结果。定义两个矩阵 $A,A'$ 不同，当且仅当存在 $i\\in[1,k]$，$j\\in[1,n]$ 满足 $A_{i,j}\\ne A'_{i,j}$。", "inputFormat": "第一行三个整数，表示 $n,k,x$。\n\n接下来 $x$ 行，每行三个整数 $a_{i},b_{i},c_{i}$。", "outputFormat": "一行一个整数，表示答案。", "hint": "**样例解释**\n\n满足条件的矩阵只有以下 $2$ 种：\n\n$$\n\\begin{Bmatrix}\n1&0&0\\\\\n0&0&0\n\\end{Bmatrix}\n$$\n\n$$\n\\begin{Bmatrix}\n1&0&0\\\\\n0&0&1\n\\end{Bmatrix}\n$$\n\n----\n\n\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask} \\kern{2pt} \\mathrm{id}$ | $n$ | $x$ | 特殊性质 | 分值 |\n| :-----: | :-----: | :-----: | :-----: | :-----: |\n| $0$ | $\\le 8$ | $\\le 8$ | $k=2$ | $12$ |\n| $1$ | $\\le 2 \\times 10^{5}$ | $\\le 2\\times 10^{5}$ | 无 | $26$ |\n| $2$ | $\\le 10^{9}$ | $=0$ | 无 | $23$ |\n| $3$ | $\\le 10^{9}$ | $\\le 2\\times 10^{5}$ | $c_{i}=1$ | $15$ |\n| $4$ | $\\le 10^{9}$ | $\\le 2\\times 10^{5}$ | 无 | $24$ |\n\n对于所有数据，$1 \\le n \\le 10^{9}$，$0 \\le x \\le 2\\times 10^{5}$，$2\\le k \\le 100$。$1 \\le a_{i} \\le k$，$1 \\le b_{i} \\le n$，$c_{i} \\in \\{0,1\\}$。保证不存在一对 $i,j \\in [1,x],\\kern{2pt}i\\neq j$，满足 $a_{i}=a_{j},\\kern{2pt}b_{i}=b_{j}$。", "locale": "zh-CN"}}}
{"pid": "P9491", "type": "P", "difficulty": 5, "samples": [["3 2 2\n1 3\n2 6\n4 8\n1 3 5\n2 7 9", "13\n18\n26"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["树状数组", "O2优化"], "title": "ZHY 的集合", "background": "## 赛后时限改为 1s。\n\nZHY 又一次在赛时看错题了。\n[](T341514)", "description": "对于两个集合大小为 $x$ 的集合 $A,B$，满足 $A\\cap B=\\varnothing$（空集），ZHY 定义 $f(A,B)$ 如下：\n\n- 设 $C=A\\cup B$。将 $C$ 中的元素从小到大排序。\n\n- $f(A,B)=\\displaystyle \\sum_{i=1}^x C_i$。\n\n现在，ZHY 有 $n$ 个大小为 $m$ 的集合 $S_1,S_2,\\cdots,S_n$，他想知道 $\\displaystyle \\sum_{i=1}^n\\sum_{j=i + 1}^n f(S_i,S_j)$ 是多少。\n\n然而，ZHY 并不满足于此。于是他又进行了 $q$ 次修改操作，每次操作会重新给定一个集合。请你在每次修改后都输出一次答案，即 $\\displaystyle \\sum_{i=1}^n\\sum_{j=i + 1}^n f(S_i,S_j)$。保证任意时刻任意一个集合中元素两两不同，保证任意时刻任意两个集合的交为空。", "inputFormat": "第一行三个整数 $n,m,q$。\n\n第 $2$ 行到第 $n+1$ 行，每行 $m$ 个整数，描述集合 $S_1,S_2,\\cdots,S_n$。第 $i+1$ 行的 $m$ 个数为集合 $S_i$ 中的 $m$ 个整数。\n\n随后 $q$ 行，每行第一个整数为 $x$，表示将要修改的集合的编号。随后 $m$ 个数表示新的 $S_x$ 中的 $m$ 个整数。", "outputFormat": "第一行一个整数表示初始时的答案。\n\n随后 $q$ 行，每行一个整数表示每次修改后的答案。", "hint": "**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask} \\kern{2pt} \\mathrm{id}$ | $n$ | $m$ | $q$ | 分值 |\n| :-----: | :-----: | :-----: | :-----: | :-----: |\n| $0$ | $\\le 100$ | $\\le 10$ | $\\le 10$ | $7$ |\n| $1$ | $\\le 100$ | $\\le 100$ | $\\le 100$ | $11$ |\n| $2$ | $\\le 10^3$ | $\\le 100$ | $\\le 10^3$ | $7$ |\n| $3$ | $\\le 10^4$ | $\\le 100$ | $=0$ | $15$ |\n| $4$ | $\\le 10^4$ | $\\le 100$ | $\\le 10^3$ | $27$ |\n| $5$ | $\\le 10^4$ | $\\le 100$ | $\\le 10^4$ | $33$ |\n\n对于所有数据，$0 \\le n, q \\le 10^4$，$1 \\le m \\le 100$，$1 \\le S_{i,j} \\le 10^9$。保证任意时刻对于 $\\forall i\\in [1,n],\\kern{2pt}j \\in [1,m],\\kern{2pt}i' \\in[1,n],\\kern{2pt}j'\\in [1,m]$，若 $i \\ne i'$ 或 $j \\ne j'$，则 $S_{i,j} \\ne S_{i',j'}。$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "ZHY 的集合", "background": "## 赛后时限改为 1s。\n\nZHY 又一次在赛时看错题了。\n[](T341514)", "description": "对于两个集合大小为 $x$ 的集合 $A,B$，满足 $A\\cap B=\\varnothing$（空集），ZHY 定义 $f(A,B)$ 如下：\n\n- 设 $C=A\\cup B$。将 $C$ 中的元素从小到大排序。\n\n- $f(A,B)=\\displaystyle \\sum_{i=1}^x C_i$。\n\n现在，ZHY 有 $n$ 个大小为 $m$ 的集合 $S_1,S_2,\\cdots,S_n$，他想知道 $\\displaystyle \\sum_{i=1}^n\\sum_{j=i + 1}^n f(S_i,S_j)$ 是多少。\n\n然而，ZHY 并不满足于此。于是他又进行了 $q$ 次修改操作，每次操作会重新给定一个集合。请你在每次修改后都输出一次答案，即 $\\displaystyle \\sum_{i=1}^n\\sum_{j=i + 1}^n f(S_i,S_j)$。保证任意时刻任意一个集合中元素两两不同，保证任意时刻任意两个集合的交为空。", "inputFormat": "第一行三个整数 $n,m,q$。\n\n第 $2$ 行到第 $n+1$ 行，每行 $m$ 个整数，描述集合 $S_1,S_2,\\cdots,S_n$。第 $i+1$ 行的 $m$ 个数为集合 $S_i$ 中的 $m$ 个整数。\n\n随后 $q$ 行，每行第一个整数为 $x$，表示将要修改的集合的编号。随后 $m$ 个数表示新的 $S_x$ 中的 $m$ 个整数。", "outputFormat": "第一行一个整数表示初始时的答案。\n\n随后 $q$ 行，每行一个整数表示每次修改后的答案。", "hint": "**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask} \\kern{2pt} \\mathrm{id}$ | $n$ | $m$ | $q$ | 分值 |\n| :-----: | :-----: | :-----: | :-----: | :-----: |\n| $0$ | $\\le 100$ | $\\le 10$ | $\\le 10$ | $7$ |\n| $1$ | $\\le 100$ | $\\le 100$ | $\\le 100$ | $11$ |\n| $2$ | $\\le 10^3$ | $\\le 100$ | $\\le 10^3$ | $7$ |\n| $3$ | $\\le 10^4$ | $\\le 100$ | $=0$ | $15$ |\n| $4$ | $\\le 10^4$ | $\\le 100$ | $\\le 10^3$ | $27$ |\n| $5$ | $\\le 10^4$ | $\\le 100$ | $\\le 10^4$ | $33$ |\n\n对于所有数据，$0 \\le n, q \\le 10^4$，$1 \\le m \\le 100$，$1 \\le S_{i,j} \\le 10^9$。保证任意时刻对于 $\\forall i\\in [1,n],\\kern{2pt}j \\in [1,m],\\kern{2pt}i' \\in[1,n],\\kern{2pt}j'\\in [1,m]$，若 $i \\ne i'$ 或 $j \\ne j'$，则 $S_{i,j} \\ne S_{i',j'}。$", "locale": "zh-CN"}}}
{"pid": "P9492", "type": "P", "difficulty": 2, "samples": [["2\n5 1 2 1 2 1\n7 1 2 1 1 2 1 0", "NO\nYES"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "洛谷原创", "O2优化", "构造"], "title": "「SFCOI-3」进行一个拆的解", "background": "**公告：Subtask 0 数据有误，现已更改。**\n\n------------\n\n三岁的小明非常不喜欢完整的东西，他甚至连序列都想要拆掉。", "description": "给定序列 $a_1\\dots a_n$，小明想要把它拆成两个子段 $[1, l][l + 1, n](1 \\leq l \\lt n)$，即 $a_1\\dots a_l$ 和 $a_{l+1}\\dots a_n$。\n\n由于小明强迫症很严重，他不希望对于这两个子段，其中一个是另一个的 **子序列**，换句话说，他不希望其中一个子段可以通过删掉若干（可能为 $0$）个元素变成另一个。\n\n在父母出门的时候，小明终于找到了把序列拆开的机会！所以，他想知道，是否存在一种拆解的方式满足：任意一个子段都不是另一个子段的子序列。", "inputFormat": "第一行一个整数 $T$，表示小明总共要拆解 $T$ 个序列。接下来 $T$ 行，每行描述一个序列：\n\n+ 每行第一个整数 $n$，表示序列长度；\n+ 接下来 $n$ 个整数，依次代表序列中每一个数。", "outputFormat": "输出共 $T$ 行。\n\n对于每轮游戏，若存在满足条件的序列，输出 `YES`，否则输出 `NO`。", "hint": "### 样例解释\n\n对于第一个序列，所有拆分方式有：\n\n- $\\lbrace 1 \\rbrace,\\lbrace 2,1,2,1 \\rbrace$。\n- $\\lbrace 1,2 \\rbrace,\\lbrace 1,2,1 \\rbrace$。\n- $\\lbrace 1,2,1 \\rbrace,\\lbrace 2,1 \\rbrace$。\n- $\\lbrace 1,2,1,2 \\rbrace,\\lbrace 1 \\rbrace$。\n\n从任何地方拆开都是不合法的——较短的那个序列都是另一个序列的子序列。\n\n对于第二个序列，其中一种合理的拆分方式为 \n$\\lbrace 1,2,1,1,2 \\rbrace,\\lbrace 1,0 \\rbrace$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n- Subtask 0（15 points）：$a_i = 0$。\n- Subtask 1（15 points）：$n = 10$，保证数据随机生成。\n- Subtask 2（30 points）：$n$ 为偶数。\n- Subtask 3（40 points）：无特殊限制。\n\n对于所有数据，$1\\leq T \\leq 10^5$，$2 \\leq n \\leq 10^5$，$1 \\leq \\sum n \\leq 10^6$，$0 \\leq a_i \\leq 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SFCOI-3」进行一个拆的解", "background": "**公告：Subtask 0 数据有误，现已更改。**\n\n------------\n\n三岁的小明非常不喜欢完整的东西，他甚至连序列都想要拆掉。", "description": "给定序列 $a_1\\dots a_n$，小明想要把它拆成两个子段 $[1, l][l + 1, n](1 \\leq l \\lt n)$，即 $a_1\\dots a_l$ 和 $a_{l+1}\\dots a_n$。\n\n由于小明强迫症很严重，他不希望对于这两个子段，其中一个是另一个的 **子序列**，换句话说，他不希望其中一个子段可以通过删掉若干（可能为 $0$）个元素变成另一个。\n\n在父母出门的时候，小明终于找到了把序列拆开的机会！所以，他想知道，是否存在一种拆解的方式满足：任意一个子段都不是另一个子段的子序列。", "inputFormat": "第一行一个整数 $T$，表示小明总共要拆解 $T$ 个序列。接下来 $T$ 行，每行描述一个序列：\n\n+ 每行第一个整数 $n$，表示序列长度；\n+ 接下来 $n$ 个整数，依次代表序列中每一个数。", "outputFormat": "输出共 $T$ 行。\n\n对于每轮游戏，若存在满足条件的序列，输出 `YES`，否则输出 `NO`。", "hint": "### 样例解释\n\n对于第一个序列，所有拆分方式有：\n\n- $\\lbrace 1 \\rbrace,\\lbrace 2,1,2,1 \\rbrace$。\n- $\\lbrace 1,2 \\rbrace,\\lbrace 1,2,1 \\rbrace$。\n- $\\lbrace 1,2,1 \\rbrace,\\lbrace 2,1 \\rbrace$。\n- $\\lbrace 1,2,1,2 \\rbrace,\\lbrace 1 \\rbrace$。\n\n从任何地方拆开都是不合法的——较短的那个序列都是另一个序列的子序列。\n\n对于第二个序列，其中一种合理的拆分方式为 \n$\\lbrace 1,2,1,1,2 \\rbrace,\\lbrace 1,0 \\rbrace$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n- Subtask 0（15 points）：$a_i = 0$。\n- Subtask 1（15 points）：$n = 10$，保证数据随机生成。\n- Subtask 2（30 points）：$n$ 为偶数。\n- Subtask 3（40 points）：无特殊限制。\n\n对于所有数据，$1\\leq T \\leq 10^5$，$2 \\leq n \\leq 10^5$，$1 \\leq \\sum n \\leq 10^6$，$0 \\leq a_i \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P9493", "type": "P", "difficulty": 5, "samples": [["4\n4\n1 1 3 3\n5\n2 1 3 3 4\n6\n1 1 2 5 4 5\n10\n3 2 3 4 7 6 8 8 8 9", "4\n12\n8\n96"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["动态规划 DP", "2023", "洛谷原创", "O2优化", "区间 DP"], "title": "「SFCOI-3」进行一个列的排", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/8v9kbxjs.png)\n\n（其实这题原来叫 I must say No，不过出于某些显然的原因就改题目名了 /kk）\n\nYou must say Yes.\n\n（题目背景图片来自 Phigros 曲绘，如有侵权，请告知出题人。）", "description": "小 R 有一个长度为 $n$ 的排列 $p_1\\dots p_n$。换句话说，$p_1\\dots p_n$ 包含 $0 \\sim (n - 1)$ 之间的数，并且满足对于 $0 \\sim (n - 1)$ 这 $n$ 个数，每个数在 $p$ 中出现且仅出现一次。\n\n小 R 有 $n$ 个限制，其中第 $i(0 \\leq i \\leq n - 1)$ 个用一个![](cnm,shabierLeasier)**正整数** $L_i$ 描述，表示至少有一个长度为 $L_i$ 的区间 $[l, r]$（即 $r - l + 1 = L_i$）满足 $\\operatorname{mex}_{k=l}^r p_k = i$。\n\n小 R 丢失了排列 $p_1\\dots p_n$，不过幸运的是她仍然记得这 $n$ 条限制。请你帮她求出总共有多少个初始的合法排列，答案对 $998244353$ 取模。", "inputFormat": "**本题每个测试点有多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。对于每组数据：\n\n+ 第一行一个整数 $n$。\n+ 第二行 $n$ 个整数依次表示 $L_0\\dots L_{n-1}$。", "outputFormat": "共 $T$ 行，每行一个整数表示答案。", "hint": "### 定义\n\n+ 一个序列的 $\\operatorname{mex}$ 是其中没有出现过的最小非负整数，如 $\\operatorname{mex}\\{1, 3, 4\\} = 0$，$\\operatorname{mex}\\{0, 1, 1, 2, 5\\} = 3$，$\\operatorname{mex}\\{3, 1, 0, 2\\} = 4$。\n\n### 数据规模与约定\n\n+ Subtask 0（10 pts）：$n \\leq 10$。\n+ Subtask 1（30 pts）：$n \\leq 18$。\n+ Subtask 2（15 pts）：$n \\leq 300$。\n+ Subtask 3（45 pts）：无特殊限制。\n\n对于所有数据，$1 \\leq T \\leq 10$，$1 \\leq n \\leq 5 \\times 10^3$，$1 \\leq L_i \\leq n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SFCOI-3」进行一个列的排", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/8v9kbxjs.png)\n\n（其实这题原来叫 I must say No，不过出于某些显然的原因就改题目名了 /kk）\n\nYou must say Yes.\n\n（题目背景图片来自 Phigros 曲绘，如有侵权，请告知出题人。）", "description": "小 R 有一个长度为 $n$ 的排列 $p_1\\dots p_n$。换句话说，$p_1\\dots p_n$ 包含 $0 \\sim (n - 1)$ 之间的数，并且满足对于 $0 \\sim (n - 1)$ 这 $n$ 个数，每个数在 $p$ 中出现且仅出现一次。\n\n小 R 有 $n$ 个限制，其中第 $i(0 \\leq i \\leq n - 1)$ 个用一个![](cnm,shabierLeasier)**正整数** $L_i$ 描述，表示至少有一个长度为 $L_i$ 的区间 $[l, r]$（即 $r - l + 1 = L_i$）满足 $\\operatorname{mex}_{k=l}^r p_k = i$。\n\n小 R 丢失了排列 $p_1\\dots p_n$，不过幸运的是她仍然记得这 $n$ 条限制。请你帮她求出总共有多少个初始的合法排列，答案对 $998244353$ 取模。", "inputFormat": "**本题每个测试点有多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。对于每组数据：\n\n+ 第一行一个整数 $n$。\n+ 第二行 $n$ 个整数依次表示 $L_0\\dots L_{n-1}$。", "outputFormat": "共 $T$ 行，每行一个整数表示答案。", "hint": "### 定义\n\n+ 一个序列的 $\\operatorname{mex}$ 是其中没有出现过的最小非负整数，如 $\\operatorname{mex}\\{1, 3, 4\\} = 0$，$\\operatorname{mex}\\{0, 1, 1, 2, 5\\} = 3$，$\\operatorname{mex}\\{3, 1, 0, 2\\} = 4$。\n\n### 数据规模与约定\n\n+ Subtask 0（10 pts）：$n \\leq 10$。\n+ Subtask 1（30 pts）：$n \\leq 18$。\n+ Subtask 2（15 pts）：$n \\leq 300$。\n+ Subtask 3（45 pts）：无特殊限制。\n\n对于所有数据，$1 \\leq T \\leq 10$，$1 \\leq n \\leq 5 \\times 10^3$，$1 \\leq L_i \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P9494", "type": "P", "difficulty": 6, "samples": [["4 10\n1 1 4\n5 -1 4\n1 9 19\n8 -1 10\n1 1 11\n2 2 4\n3 3 5\n4 4 14\n1 2 1\n2 3 9\n3 4 1\n1 3 9\n2 4 8\n1 4 10", "0\n0\n19\n10\n4\n23\n19\n23\n23\n23"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["倍增", "平衡树", "2023", "洛谷原创", "O2优化", "差分"], "title": "「SFCOI-3」进行一个走的行", "background": "**公告：注意存在 $l_i > r_i$ 的情况，此时操作无效。**\n\n------------\n\n小 L 热衷于行走。", "description": "小 L 来到了一处景点，他想要在这里的主干道上行走。\n\n主干道上有若干关键点，他可以将其抽象为一个长为 $n$ 的序列 $a$，每个 $a_i$ 都是一个三元组，可以表示为 $(l_i, r_i, v_i)$，其具体含义形如：\n\n- 若 $r_i = -1$，表示一个需要买票进入的景点，票价为 $l_i$ 代币，游览完成后他会得到 $v_i$ 的愉悦值。\n- 若 $r_i \\neq -1$，表示一个礼品派发点，若他持有的代币面值之和 $x$ 满足 $l_i \\leq x \\leq r_i$，他可以领取一份礼品，并会得到 $v_i$ 的愉悦值。\n\n他打算在这条主干道上行走 $m$ 次，每次他给出了行走起点 $l$ 和终点 $r$，一开始他持有的代币面值之和为 $x$，初始愉悦值为 $0$。\n\n他将从 $l$ 开始向右依次经过 $i \\in [l, r]$，他会做如下操作：\n\n- 若 $r_i = -1$，如果他持有的代币在支付完当前景点门票费用后还有剩余，他会游览这个景点。\n- 若 $r_i \\neq -1$，如果可以，他会领取一份礼品。\n\n请你帮他快速求出每次行走结束后他的愉悦值。", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $n$ 行，其中第 $i$ 行有三个整数 $l_i, r_i, v_i$；\n\n接下来 $m$ 行，每行三个整数 $l, r, x$，表示一个询问。", "outputFormat": "$m$ 行，每行一个整数，表示行走结束后他的愉悦值。", "hint": "**本题开启捆绑测试。**\n\n- Subtask 1（10 pts）：$1 \\leq n, m \\leq 5 \\times 10^3$。\n- Subtask 2（10 pts）：$r_i \\neq -1$。\n- Subtask 3（20 pts）：$r_i = -1$。\n- Subtask 4（10 pts）：$1 \\leq n, m \\leq 7.5 \\times 10^4$，性质 A。\n- Subtask 5（20 pts）：$1 \\leq n, m \\leq 7.5 \\times 10^4$。\n- Subtask 6（10 pts）：数据在范围内随机生成，性质 B。\n- Subtask 7（20 pts）：无特殊限制。\n\n性质 A：$1 \\leq l_i \\leq 7.5 \\times 10^4$，$r_i = -1$ 或 $1 \\leq r_i \\leq 7.5 \\times 10^4$，$1 \\leq x \\leq 7.5 \\times 10^4$。\n\n性质 B：$r_i = -1$ 时 $1 \\leq l_i \\leq 2 \\times 10^5$。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\leq n, m \\leq 2 \\times 10^5$。\n- $1 \\leq l_i \\leq 10^9$，$r_i = -1$ 或 $1 \\leq r_i \\leq 10^9$。\n- $1 \\leq v_i \\leq 10^9$。\n- $1 \\leq l \\leq r \\leq n$，$1 \\leq x \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SFCOI-3」进行一个走的行", "background": "**公告：注意存在 $l_i > r_i$ 的情况，此时操作无效。**\n\n------------\n\n小 L 热衷于行走。", "description": "小 L 来到了一处景点，他想要在这里的主干道上行走。\n\n主干道上有若干关键点，他可以将其抽象为一个长为 $n$ 的序列 $a$，每个 $a_i$ 都是一个三元组，可以表示为 $(l_i, r_i, v_i)$，其具体含义形如：\n\n- 若 $r_i = -1$，表示一个需要买票进入的景点，票价为 $l_i$ 代币，游览完成后他会得到 $v_i$ 的愉悦值。\n- 若 $r_i \\neq -1$，表示一个礼品派发点，若他持有的代币面值之和 $x$ 满足 $l_i \\leq x \\leq r_i$，他可以领取一份礼品，并会得到 $v_i$ 的愉悦值。\n\n他打算在这条主干道上行走 $m$ 次，每次他给出了行走起点 $l$ 和终点 $r$，一开始他持有的代币面值之和为 $x$，初始愉悦值为 $0$。\n\n他将从 $l$ 开始向右依次经过 $i \\in [l, r]$，他会做如下操作：\n\n- 若 $r_i = -1$，如果他持有的代币在支付完当前景点门票费用后还有剩余，他会游览这个景点。\n- 若 $r_i \\neq -1$，如果可以，他会领取一份礼品。\n\n请你帮他快速求出每次行走结束后他的愉悦值。", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $n$ 行，其中第 $i$ 行有三个整数 $l_i, r_i, v_i$；\n\n接下来 $m$ 行，每行三个整数 $l, r, x$，表示一个询问。", "outputFormat": "$m$ 行，每行一个整数，表示行走结束后他的愉悦值。", "hint": "**本题开启捆绑测试。**\n\n- Subtask 1（10 pts）：$1 \\leq n, m \\leq 5 \\times 10^3$。\n- Subtask 2（10 pts）：$r_i \\neq -1$。\n- Subtask 3（20 pts）：$r_i = -1$。\n- Subtask 4（10 pts）：$1 \\leq n, m \\leq 7.5 \\times 10^4$，性质 A。\n- Subtask 5（20 pts）：$1 \\leq n, m \\leq 7.5 \\times 10^4$。\n- Subtask 6（10 pts）：数据在范围内随机生成，性质 B。\n- Subtask 7（20 pts）：无特殊限制。\n\n性质 A：$1 \\leq l_i \\leq 7.5 \\times 10^4$，$r_i = -1$ 或 $1 \\leq r_i \\leq 7.5 \\times 10^4$，$1 \\leq x \\leq 7.5 \\times 10^4$。\n\n性质 B：$r_i = -1$ 时 $1 \\leq l_i \\leq 2 \\times 10^5$。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\leq n, m \\leq 2 \\times 10^5$。\n- $1 \\leq l_i \\leq 10^9$，$r_i = -1$ 或 $1 \\leq r_i \\leq 10^9$。\n- $1 \\leq v_i \\leq 10^9$。\n- $1 \\leq l \\leq r \\leq n$，$1 \\leq x \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P9495", "type": "P", "difficulty": 7, "samples": [["4\n5\n1 0 1 0 1\n5\n1 0 0 1 1\n9\n0 0 0 0 0 0 0 0 0\n13\n0 1 0 0 1 0 1 0 0 0 0 0 0\n", "1\n2\n5\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2023", "洛谷原创", "O2优化", "构造", "Ad-hoc"], "title": "「SFCOI-3」进行一个魔的除 I", "background": "终于，勇士打败了魔王，他把走投无路的魔王困在了一个房间里。\n\n魔王拥有在黑暗中随意穿行的能力，所以勇士只有把房间里所有的灯全部打开，才能找到魔王，最终彻底消灭他。", "description": "房间中共有 $n$ 盏灯，初始状态可以用 $a_1\\dots a_n$ 表示，其中 $\\tt 0$ 表示这盏灯初始是关闭的，$\\tt 1$ 表示这盏灯初始是打开的。\n\n从第一天早晨开始，魔王与勇士轮流行动：\n\n- 每天早晨，魔王可以选择 **连续的** 两盏灯，将它们的状态全部设定为 $\\tt 0$；\n- 每天晚上，勇士可以选择 **任意的** 至多三盏灯，将它们的状态全部设定为 $\\tt 1$。\n\n每次行动时选择的灯在设定前的状态任意。\n\n假设双方均采用最优策略，不会进行任何不利于自己的行动。勇士想知道，**最少** 需要多少天（也即，他最少需要多少次操作）才能将所有灯状态设定为 $\\tt 1$——这样，他才能抓到可恶的魔王，迎娶美丽的公主。", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n+ 第一行一个整数 $n$，表示灯的总数。\n+ 第二行共 $n$ 个数，依次表示 $a_1\\dots a_n$。", "outputFormat": "对于每组数据，一行一个整数，代表勇士抓到魔王所需要的最少天数。\n\n特别地，如果勇士不需要任何操作，输出 $0$ 即可。", "hint": "### 样例解释 1\n\n+ 第一天早晨，魔王关闭第 $1{,}2$ 两盏灯；\n+ 第一天晚上，勇士打开 $1{,}2{,}4$ 三盏灯。\n\n### 样例解释 2\n\n+ 第一天早晨，魔王关闭第 $4{,}5$ 两盏灯；\n+ 第一天晚上，勇士打开 $2{,}3{,}4$ 三盏灯。\n+ 第二天早晨，魔王关闭第 $1{,}2$ 两盏灯；\n+ 第二天晚上，勇士打开 $1{,}2{,}5$ 三盏灯。\n\n### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n- Subtask 0（10 points）：$n \\leq 10$，$T \\leq 2046$。\n- Subtask 1（30 points）：$ n \\leq 2000$。\n- Subtask 2（10 points）：初始所有灯都是关闭的。 \n- Subtask 3（20 points）：数据随机生成。\n- Subtask 4（30 points）：无特殊限制。\n\n对于所有数据，$1 \\leq T \\leq 10^6$，$1 \\leq n \\leq 10^6$，$1 \\leq \\sum n \\leq 3 \\times 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SFCOI-3」进行一个魔的除 I", "background": "终于，勇士打败了魔王，他把走投无路的魔王困在了一个房间里。\n\n魔王拥有在黑暗中随意穿行的能力，所以勇士只有把房间里所有的灯全部打开，才能找到魔王，最终彻底消灭他。", "description": "房间中共有 $n$ 盏灯，初始状态可以用 $a_1\\dots a_n$ 表示，其中 $\\tt 0$ 表示这盏灯初始是关闭的，$\\tt 1$ 表示这盏灯初始是打开的。\n\n从第一天早晨开始，魔王与勇士轮流行动：\n\n- 每天早晨，魔王可以选择 **连续的** 两盏灯，将它们的状态全部设定为 $\\tt 0$；\n- 每天晚上，勇士可以选择 **任意的** 至多三盏灯，将它们的状态全部设定为 $\\tt 1$。\n\n每次行动时选择的灯在设定前的状态任意。\n\n假设双方均采用最优策略，不会进行任何不利于自己的行动。勇士想知道，**最少** 需要多少天（也即，他最少需要多少次操作）才能将所有灯状态设定为 $\\tt 1$——这样，他才能抓到可恶的魔王，迎娶美丽的公主。", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n+ 第一行一个整数 $n$，表示灯的总数。\n+ 第二行共 $n$ 个数，依次表示 $a_1\\dots a_n$。", "outputFormat": "对于每组数据，一行一个整数，代表勇士抓到魔王所需要的最少天数。\n\n特别地，如果勇士不需要任何操作，输出 $0$ 即可。", "hint": "### 样例解释 1\n\n+ 第一天早晨，魔王关闭第 $1{,}2$ 两盏灯；\n+ 第一天晚上，勇士打开 $1{,}2{,}4$ 三盏灯。\n\n### 样例解释 2\n\n+ 第一天早晨，魔王关闭第 $4{,}5$ 两盏灯；\n+ 第一天晚上，勇士打开 $2{,}3{,}4$ 三盏灯。\n+ 第二天早晨，魔王关闭第 $1{,}2$ 两盏灯；\n+ 第二天晚上，勇士打开 $1{,}2{,}5$ 三盏灯。\n\n### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n- Subtask 0（10 points）：$n \\leq 10$，$T \\leq 2046$。\n- Subtask 1（30 points）：$ n \\leq 2000$。\n- Subtask 2（10 points）：初始所有灯都是关闭的。 \n- Subtask 3（20 points）：数据随机生成。\n- Subtask 4（30 points）：无特殊限制。\n\n对于所有数据，$1 \\leq T \\leq 10^6$，$1 \\leq n \\leq 10^6$，$1 \\leq \\sum n \\leq 3 \\times 10^6$。", "locale": "zh-CN"}}}
{"pid": "P9496", "type": "P", "difficulty": 1, "samples": [["3\n1 1\n4 5\n1 4", "0\n1\n2"]], "limits": {"time": [1000, 1000, 1000], "memory": [131072, 131072, 131072]}, "tags": ["洛谷原创", "O2优化", "位运算", "洛谷月赛"], "title": "「RiOI-2」hacker", "background": "在小树丛边坐落着一个幻想的城堡。这里是 E 国的领地，而小 E，则是 E 国之王。\n\n现在，伟大的 E 国之王正在披挂出征。\n\n不过听说 E 国之王遇见了两个叫 ACCEPT 和 BOTH 的人，他们是谁？", "description": "现在有正整数 $n$，有以下操作；\n\n- 「ACCEPT」。花费 $1$ 的代价，将 $n$ [二进制](https://oi-wiki.org/math/base/#%E4%BA%8C%E8%BF%9B%E5%88%B6)**按位或**上 一个正整数。\n- 「BOTH」。花费 $1$ 的代价，将 $n$ [二进制](https://oi-wiki.org/math/base/#%E4%BA%8C%E8%BF%9B%E5%88%B6)**按位与**上 一个正整数。\n\n两种操作均可使用多次（或不用），请求出将 $n$ 变为 $m$ 最小的代价。\n\n[帮助：什么是按位与和按位或](https://oi-wiki.org/math/bit/#%E4%B8%8E%E6%88%96%E5%BC%82%E6%88%96)", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 行，每行两个正整数 $n, m$ 以空格隔开。", "outputFormat": "输出 $T$ 行，每行一个整数，表示答案。", "hint": "### 样例解释\n\n+ 对于 $n = 1$，$m = 1$，不需要任何操作。\n+ 对于 $n = 4$，$m = 5$，一种可行的方案为使用「ACCEPT $1$」。\n+ 对于 $n = 1$，$m = 4$，一种可行的方案为依次使用「ACCEPT $998{,}244{,}853$」和「BOTH $14$」。\n\n### 数据规模与约定\n\n**本题开启捆绑测试。**\n\n| $\\text{Subtask}$ | 分值 | $T \\leq$ | $n, m \\leq$ |\n| :--------------: | :--: | :------: | :---------: |\n| $0$ | $30$ | $100$ | $100$ |\n| $1$ | $70$ | $2\\times 10^5$ | $10^{18}$ |\n\n对于所有数据，$1\\le T\\le2\\times 10^5$，$1\\le n,m\\le10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RiOI-2」hacker", "background": "在小树丛边坐落着一个幻想的城堡。这里是 E 国的领地，而小 E，则是 E 国之王。\n\n现在，伟大的 E 国之王正在披挂出征。\n\n不过听说 E 国之王遇见了两个叫 ACCEPT 和 BOTH 的人，他们是谁？", "description": "现在有正整数 $n$，有以下操作；\n\n- 「ACCEPT」。花费 $1$ 的代价，将 $n$ [二进制](https://oi-wiki.org/math/base/#%E4%BA%8C%E8%BF%9B%E5%88%B6)**按位或**上 一个正整数。\n- 「BOTH」。花费 $1$ 的代价，将 $n$ [二进制](https://oi-wiki.org/math/base/#%E4%BA%8C%E8%BF%9B%E5%88%B6)**按位与**上 一个正整数。\n\n两种操作均可使用多次（或不用），请求出将 $n$ 变为 $m$ 最小的代价。\n\n[帮助：什么是按位与和按位或](https://oi-wiki.org/math/bit/#%E4%B8%8E%E6%88%96%E5%BC%82%E6%88%96)", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 行，每行两个正整数 $n, m$ 以空格隔开。", "outputFormat": "输出 $T$ 行，每行一个整数，表示答案。", "hint": "### 样例解释\n\n+ 对于 $n = 1$，$m = 1$，不需要任何操作。\n+ 对于 $n = 4$，$m = 5$，一种可行的方案为使用「ACCEPT $1$」。\n+ 对于 $n = 1$，$m = 4$，一种可行的方案为依次使用「ACCEPT $998{,}244{,}853$」和「BOTH $14$」。\n\n### 数据规模与约定\n\n**本题开启捆绑测试。**\n\n| $\\text{Subtask}$ | 分值 | $T \\leq$ | $n, m \\leq$ |\n| :--------------: | :--: | :------: | :---------: |\n| $0$ | $30$ | $100$ | $100$ |\n| $1$ | $70$ | $2\\times 10^5$ | $10^{18}$ |\n\n对于所有数据，$1\\le T\\le2\\times 10^5$，$1\\le n,m\\le10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P9497", "type": "P", "difficulty": 2, "samples": [["3 3\n9 9 8\n2 4 4\n3 5 3\n5\n9\n10", "3\n2\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "二分", "洛谷原创", "O2优化", "排序", "洛谷月赛"], "title": "「RiOI-2」weight", "background": "在小树林间坐落着一个幻想的城堡。这里是 E 国的领地，而小 E，则是 E 国之王。\n\n树木，是 E 国抵挡袭击的法宝。树木越高，越能蒙蔽敌人的视线。\n\n可是，随着自然条件的退化，小 E 却不知怎么处理。怎么办呢？", "description": "给定一个 $n$ 行 $n$ 列 的矩阵 $a$。\n\n有 $q$ 组询问，每次给定一个 $v$，请将矩阵每一行任意重排（可以不重排），最大化**最大值不小于** $v$（也就是说，至少有一个不小于 $v$ 的数）的列数。请输出这个列数。\n\n询问之间相互独立。换言之，每次询问前可以重新排列。\n", "inputFormat": "第一行两个正整数 $n, q$。\n\n第 $2\\sim n+1$ 行，每行 $n$ 个正整数，表示矩阵 $a$。\n\n接下来 $q$ 行每行一个正整数 $v$，表示一次询问。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "### 样例解释\n\n原矩阵为 $\\begin{bmatrix}9&9&8\\\\2&4&4\\\\3&5&3\\end{bmatrix}$。\n\n对于第一次询问，每一列的最大值 $9,9,8$ 均不小于 $v=5$，所以每一列都符合条件，答案为 $3$。显然无论怎么重排都不可能超过 $3$ 列（因为总共只有 $3$ 列），所以答案为 $3$。\n\n### 数据规模与约定\n\n**本题开启捆绑测试。**\n\n| $\\text{Subtask}$ | 分值 | $n \\leq$ | $q \\leq$ |\n| :--------------: | :--: | :------: | :------: |\n| $0$ | $10$ | $3$ | $10$ |\n| $1$ | $40$ | $100$ | $10^3$ |\n| $2$ | $50$ | $10^3$ | $5\\times 10^5$ |\n\n对于所有数据，$1 \\leq n \\leq 10^3$，$1 \\leq q \\leq 5\\times 10^5$，$1 \\leq a_{i,j}, v \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RiOI-2」weight", "background": "在小树林间坐落着一个幻想的城堡。这里是 E 国的领地，而小 E，则是 E 国之王。\n\n树木，是 E 国抵挡袭击的法宝。树木越高，越能蒙蔽敌人的视线。\n\n可是，随着自然条件的退化，小 E 却不知怎么处理。怎么办呢？", "description": "给定一个 $n$ 行 $n$ 列 的矩阵 $a$。\n\n有 $q$ 组询问，每次给定一个 $v$，请将矩阵每一行任意重排（可以不重排），最大化**最大值不小于** $v$（也就是说，至少有一个不小于 $v$ 的数）的列数。请输出这个列数。\n\n询问之间相互独立。换言之，每次询问前可以重新排列。\n", "inputFormat": "第一行两个正整数 $n, q$。\n\n第 $2\\sim n+1$ 行，每行 $n$ 个正整数，表示矩阵 $a$。\n\n接下来 $q$ 行每行一个正整数 $v$，表示一次询问。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "### 样例解释\n\n原矩阵为 $\\begin{bmatrix}9&9&8\\\\2&4&4\\\\3&5&3\\end{bmatrix}$。\n\n对于第一次询问，每一列的最大值 $9,9,8$ 均不小于 $v=5$，所以每一列都符合条件，答案为 $3$。显然无论怎么重排都不可能超过 $3$ 列（因为总共只有 $3$ 列），所以答案为 $3$。\n\n### 数据规模与约定\n\n**本题开启捆绑测试。**\n\n| $\\text{Subtask}$ | 分值 | $n \\leq$ | $q \\leq$ |\n| :--------------: | :--: | :------: | :------: |\n| $0$ | $10$ | $3$ | $10$ |\n| $1$ | $40$ | $100$ | $10^3$ |\n| $2$ | $50$ | $10^3$ | $5\\times 10^5$ |\n\n对于所有数据，$1 \\leq n \\leq 10^3$，$1 \\leq q \\leq 5\\times 10^5$，$1 \\leq a_{i,j}, v \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P9498", "type": "P", "difficulty": 3, "samples": [["6\n1 2\n1 3\n2 4\n2 5\n2 6", "0 1 1 1 0 0"], ["5\n1 2\n1 3\n2 4\n2 5", "-1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "构造", "洛谷月赛"], "title": "「RiOI-2」equals", "background": "在小树上坐落着一个幻想的城堡。这里是 E 国的领地，而小 E，则是 E 国之王。\n\n为了打造一个完美的 E 国，他需要明辨是非，走向正义。\n\n但是，他似乎有些太理想了。有时并没有一个完美的准则。是黑是白，谁能分辨？", "description": "给定一棵 $n$ 个结点，以 $1$ 为根的树，定义一个结点的深度 $d_i$ 表示它到根结点的简单路径上的结点个数。\n\n你需要给每个结点黑白染色，满足黑色结点的深度和等于白色结点的深度和。设 $c_i = \\{0, 1\\}$ 分别代表编号为 $i$ 的结点为黑色或白色，那么这即 $\\displaystyle\\sum_{c_i=0}d_i=\\sum_{c_i=1}d_i$。\n\n若无解，仅输出一行一个整数 $-1$。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n - 1$ 行，每行两个整数 $u_i, v_i$，表示树上编号为 $u_i$ 的结点与编号为 $v_i$ 的结点之间有一条边。保证给出的边不重复。", "outputFormat": "若有解，则输出一行 $n$ 个数 $c_1\\dots c_n$。\n\n若无解，仅输出一行一个整数 $-1$。\n\n**本题开启 Special Judge，只要你的方案满足条件或正确判断无解即可拿到本测试点的分数。**", "hint": "### 样例解释\n\n对于第一组数据，每个结点的深度分别是 $d=[1,2,2,3,3,3]$。黑色结点的深度和为 $d_1+d_5+d_6=1+3+3=7$，白色结点的深度和为 $d_2+d_3+d_4=2+2+3=7$。它们相等，所以样例输出是正确的。可能的正确输出包括但不限于样例输出、`0 1 1 0 0 1`，`1 0 0 1 0 1` 等。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\rm Subtask$ | 分值 | $n\\le $ | 特殊性质 |\n| :-----------: | :--: | :-----: | :------: |\n| $0$ | $5$ | $20$ | / |\n| $1$ | $15$ | $500$ | / |\n| $2$ | $20$ | $5\\times 10^3$ | / |\n| $3$ | $10$ | / | $n$ 为偶数 |\n| $4$ | $5$ | / | 树为菊花图（不保证根为菊花中心） |\n| $5$ | $5$ | / | 树为一条链（不保证根为链的端点） |\n| $6$ | $40$ | / | / |\n\n斜杠表示这一栏无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le u_i,v_i\\le n$，输入数据构成一棵树。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RiOI-2」equals", "background": "在小树上坐落着一个幻想的城堡。这里是 E 国的领地，而小 E，则是 E 国之王。\n\n为了打造一个完美的 E 国，他需要明辨是非，走向正义。\n\n但是，他似乎有些太理想了。有时并没有一个完美的准则。是黑是白，谁能分辨？", "description": "给定一棵 $n$ 个结点，以 $1$ 为根的树，定义一个结点的深度 $d_i$ 表示它到根结点的简单路径上的结点个数。\n\n你需要给每个结点黑白染色，满足黑色结点的深度和等于白色结点的深度和。设 $c_i = \\{0, 1\\}$ 分别代表编号为 $i$ 的结点为黑色或白色，那么这即 $\\displaystyle\\sum_{c_i=0}d_i=\\sum_{c_i=1}d_i$。\n\n若无解，仅输出一行一个整数 $-1$。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n - 1$ 行，每行两个整数 $u_i, v_i$，表示树上编号为 $u_i$ 的结点与编号为 $v_i$ 的结点之间有一条边。保证给出的边不重复。", "outputFormat": "若有解，则输出一行 $n$ 个数 $c_1\\dots c_n$。\n\n若无解，仅输出一行一个整数 $-1$。\n\n**本题开启 Special Judge，只要你的方案满足条件或正确判断无解即可拿到本测试点的分数。**", "hint": "### 样例解释\n\n对于第一组数据，每个结点的深度分别是 $d=[1,2,2,3,3,3]$。黑色结点的深度和为 $d_1+d_5+d_6=1+3+3=7$，白色结点的深度和为 $d_2+d_3+d_4=2+2+3=7$。它们相等，所以样例输出是正确的。可能的正确输出包括但不限于样例输出、`0 1 1 0 0 1`，`1 0 0 1 0 1` 等。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\rm Subtask$ | 分值 | $n\\le $ | 特殊性质 |\n| :-----------: | :--: | :-----: | :------: |\n| $0$ | $5$ | $20$ | / |\n| $1$ | $15$ | $500$ | / |\n| $2$ | $20$ | $5\\times 10^3$ | / |\n| $3$ | $10$ | / | $n$ 为偶数 |\n| $4$ | $5$ | / | 树为菊花图（不保证根为菊花中心） |\n| $5$ | $5$ | / | 树为一条链（不保证根为链的端点） |\n| $6$ | $40$ | / | / |\n\n斜杠表示这一栏无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le u_i,v_i\\le n$，输入数据构成一棵树。", "locale": "zh-CN"}}}
