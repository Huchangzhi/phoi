{"pid": "P5299", "type": "P", "difficulty": 6, "samples": [["2\n2 3 2\n2 3\n1 2\n10 16 14\n2 3 4 5 6 7 8 9 10 11\n1 2 3 4 5 6 7 8 9 10", "19\n253973805"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018"], "title": "[PKUWC2018] Slay the Spire", "background": null, "description": "九条可怜在玩一个很好玩的策略游戏：Slay the Spire，一开始九条可怜的卡组里有 $2n$ 张牌，每张牌上都写着一个数字$w_i$，一共有两种类型的牌，每种类型各 $n$ 张：\n\n1. 攻击牌：打出后对对方造成等于牌上的数字的伤害。\n\n2. 强化牌：打出后，假设该强化牌上的数字为 $x$，则其他剩下的**攻击牌**的数字都会乘上 $x$。**保证强化牌上的数字都大于 1**。\n\n现在九条可怜会等概率随机从卡组中抽出 $m$ 张牌，由于费用限制，九条可怜最多打出 $k$ 张牌，假设九条可怜永远都会采取能造成最多伤害的策略，求她期望造成多少伤害。\n\n假设答案为 $\\text{ans}$ ，你只需要输出\n\n$$\\left (\\text{ans}\\times \\frac{(2n)!}{m!(2n-m)!}\\right) ~\\bmod 998244353$$\n\n即可。其中 $x!$ 表示 $\\prod_{i=1}^{x}i$，特别地，$0!=1$ 。", "inputFormat": "第一行一个正整数 $T$ 表示数据组数\n\n接下来对于每组数据：\n\n第一行三个正整数 $n,m,k$\n\n第二行 $n$ 个正整数 $w_i$，表示每张强化牌上的数值。\n\n第三行 $n$ 个正整数 $w_i$，表示每张攻击牌上的数值。", "outputFormat": "输出 $T$ 行，每行一个非负整数表示每组数据的答案。", "hint": "#### 样例解释\n例如九条可怜抽到了攻击牌 $\\{1,2\\}$ 和强化牌 $\\{3\\}$，那最优策略是先用掉强化牌 $3$，此时攻击牌的数值变成 $\\{3,6\\}$，然后打出 $6$。\n\n\n#### 数据范围\n\n对于所有数据，有 $1\\leq k\\leq m\\leq 2n\\leq 3000$，且$1\\leq w_i\\leq 10^8$。\n\n**保证强化牌上的数字都大于 1**。\n\n以下 $(\\sum 2n)$ 表示对于输入中所有数据的$2n$的和。\n\n对于 $10\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 10$\n\n对于 $20\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 100$\n\n对于 $30\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 500$\n\n另有 $20\\%$ 的数据，满足所有攻击牌的数值相同。\n\n另有 $20\\%$ 的数据，满足 $m=k$。\n\n对于 $100\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 3000$", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Slay the Spire", "background": "", "description": "Jiutiao Kelian is playing a very interesting strategy game: Slay the Spire. At the beginning, her deck contains $2n$ cards. Each card has a number $w_i$ written on it. There are two types of cards, with $n$ cards of each type:\n\n1. Attack cards: After playing one, it deals damage equal to the number on the card.\n\n2. Buff cards: After playing one, suppose the number on this buff card is $x$. Then the numbers on all remaining **attack cards** will be multiplied by $x$. **It is guaranteed that the numbers on buff cards are all greater than 1**.\n\nNow Jiutiao Kelian will randomly draw $m$ cards from the deck with equal probability. Due to energy limits, she can play at most $k$ cards. Assume she always uses the strategy that can deal the maximum damage. Find the expected damage she can deal.\n\nSuppose the answer is $\\text{ans}$. You only need to output\n\n$$\\left (\\text{ans}\\times \\frac{(2n)!}{m!(2n-m)!}\\right) ~\\bmod 998244353$$\n\nHere, $x!$ means $\\prod_{i=1}^{x}i$. In particular, $0!=1$.", "inputFormat": "The first line contains a positive integer $T$, denoting the number of test cases.\n\nFor each test case:\n\nThe first line contains three positive integers $n,m,k$.\n\nThe second line contains $n$ positive integers $w_i$, representing the values on each buff card.\n\nThe third line contains $n$ positive integers $w_i$, representing the values on each attack card.", "outputFormat": "Output $T$ lines. Each line contains a non-negative integer, representing the answer for each test case.", "hint": "#### Sample Explanation\n\nFor example, Jiutiao Kelian draws attack cards $\\{1,2\\}$ and a buff card $\\{3\\}$. The optimal strategy is to play the buff card $3$ first. Then the values of the attack cards become $\\{3,6\\}$, and then she plays $6$.\n\n#### Constraints\n\nFor all testdata, $1\\leq k\\leq m\\leq 2n\\leq 3000$, and $1\\leq w_i\\leq 10^8$.\n\n**It is guaranteed that the numbers on buff cards are all greater than 1**.\n\nLet $(\\sum 2n)$ denote the sum of $2n$ over all test cases in the input.\n\nFor $10\\%$ of the testdata, $1\\leq \\sum 2n\\leq 10$.\n\nFor $20\\%$ of the testdata, $1\\leq \\sum 2n\\leq 100$.\n\nFor $30\\%$ of the testdata, $1\\leq \\sum 2n\\leq 500$.\n\nFor another $20\\%$ of the testdata, all attack cards have the same value.\n\nFor another $20\\%$ of the testdata, $m=k$.\n\nFor $100\\%$ of the testdata, $1\\leq \\sum 2n\\leq 3000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] Slay the Spire", "background": null, "description": "九条可怜在玩一个很好玩的策略游戏：Slay the Spire，一开始九条可怜的卡组里有 $2n$ 张牌，每张牌上都写着一个数字$w_i$，一共有两种类型的牌，每种类型各 $n$ 张：\n\n1. 攻击牌：打出后对对方造成等于牌上的数字的伤害。\n\n2. 强化牌：打出后，假设该强化牌上的数字为 $x$，则其他剩下的**攻击牌**的数字都会乘上 $x$。**保证强化牌上的数字都大于 1**。\n\n现在九条可怜会等概率随机从卡组中抽出 $m$ 张牌，由于费用限制，九条可怜最多打出 $k$ 张牌，假设九条可怜永远都会采取能造成最多伤害的策略，求她期望造成多少伤害。\n\n假设答案为 $\\text{ans}$ ，你只需要输出\n\n$$\\left (\\text{ans}\\times \\frac{(2n)!}{m!(2n-m)!}\\right) ~\\bmod 998244353$$\n\n即可。其中 $x!$ 表示 $\\prod_{i=1}^{x}i$，特别地，$0!=1$ 。", "inputFormat": "第一行一个正整数 $T$ 表示数据组数\n\n接下来对于每组数据：\n\n第一行三个正整数 $n,m,k$\n\n第二行 $n$ 个正整数 $w_i$，表示每张强化牌上的数值。\n\n第三行 $n$ 个正整数 $w_i$，表示每张攻击牌上的数值。", "outputFormat": "输出 $T$ 行，每行一个非负整数表示每组数据的答案。", "hint": "#### 样例解释\n例如九条可怜抽到了攻击牌 $\\{1,2\\}$ 和强化牌 $\\{3\\}$，那最优策略是先用掉强化牌 $3$，此时攻击牌的数值变成 $\\{3,6\\}$，然后打出 $6$。\n\n\n#### 数据范围\n\n对于所有数据，有 $1\\leq k\\leq m\\leq 2n\\leq 3000$，且$1\\leq w_i\\leq 10^8$。\n\n**保证强化牌上的数字都大于 1**。\n\n以下 $(\\sum 2n)$ 表示对于输入中所有数据的$2n$的和。\n\n对于 $10\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 10$\n\n对于 $20\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 100$\n\n对于 $30\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 500$\n\n另有 $20\\%$ 的数据，满足所有攻击牌的数值相同。\n\n另有 $20\\%$ 的数据，满足 $m=k$。\n\n对于 $100\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 3000$", "locale": "zh-CN"}}}
{"pid": "P5300", "type": "P", "difficulty": 5, "samples": [["3\n1 0 0\n0 0 0\n0 0 0", "1 9"], ["3\n1 2 3\n4 5 6\n7 8 9", "73 314"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "贵州", "广西", "位运算", "单调栈"], "title": "[GXOI/GZOI2019] 与或和", "background": "", "description": "Freda 学习了位运算和矩阵以后，决定对这种简洁而优美的运算，以及蕴含深邃空间的结构进行更加深入的研究。\n\n对于一个由非负整数构成的矩阵，她定义矩阵的 $\\texttt{AND}$ 值为矩阵中所有数二进制 $\\texttt{AND(\\&)}$ 的运算结果；定义矩阵的 $\\texttt{OR}$ 值为矩阵中所有数二进制 $\\texttt{OR(|)}$ 的运算结果。\n\n给定一个 $N \\times N$ 的矩阵，她希望求出：\n1. 该矩阵的所有子矩阵的 $\\texttt{AND}$ 值之和（所有子矩阵 $\\texttt{AND}$ 值相加的结果）。\n2. 该矩阵的所有子矩阵的 $\\texttt{OR}$ 值之和（所有子矩阵 $\\texttt{OR}$ 值相加的结果）。\n\n接下来的剧情你应该已经猜到——Freda 并不想花费时间解决如此简单的问题，所以这个问题就交给你了。\n\n由于答案可能非常的大，你只需要输出答案对 $1,000,000,007 (10^9 + 7)$ 取模后的结果。", "inputFormat": "输入文件的第一行是一个正整数 $N$，表示矩阵的尺寸。\n\n接下来 $N$ 行，每行 $N$ 个自然数，代表矩阵的一行。相邻两个自然数之间由一个或多个空格隔开。", "outputFormat": "输出只有一行，包含两个用空格隔开的整数，第一个应为所有子矩阵 $\\texttt{AND}$ 值之和除以 $10^9 + 7$ 的余数，第二个应为所有子矩阵 $\\texttt{OR}$ 值之和除以 $10^9 + 7$ 的余数。", "hint": "### 样例1解释\n\n该 $3 \\times 3$ 矩阵共有 $9$ 个 $1 \\times 1$ 子矩阵、$6$ 个 $1 \\times 2$ 子矩阵、$6$ 个 $2 \\times 1$ 子矩阵、$4$ 个 $2 \\times 2$ 子矩阵、3 个 $1 \\times 3$ 子矩阵、$3$ 个 $3 \\times 1$ 子矩阵、$2$ 个 $2 \\times 3$ 子矩阵、$2$ 个 $3 \\times 2$ 子矩阵和 $1$ 个 $3 \\times 3$ 子矩阵。  \n只有一个子矩阵（仅由第一行第一列的那个元素构成的 $1 \\times 1$ 矩阵）$\\texttt{AND}$ 值为 $1$，其余子矩阵的 $\\texttt{AND}$ 值均为 $0$，总和为 $1$。  \n包含第一行第一列那个元素的子矩阵有 $9$ 个，它们的 $\\texttt{OR}$ 值为 $1$，其余子矩阵的 $\\texttt{OR}$ 值为 $0$，总和为 $9$。\n\n### 数据范围\n\n|测试点编号|$n$ 的规模|矩阵中的自然数|\n|:-:|:-:|:-:|\n|$1$|$1 \\le n \\le 10$|$\\le 100$|\n|$2$|$1 \\le n \\le 10$|$\\le 100$|\n|$3$|$1 \\le n \\le 100$|$\\le 100$|\n|$4$|$1 \\le n \\le 100$|$\\le 100$|\n|$5$|$1 \\le n \\le 100$|$\\le 100$|\n|$6$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$7$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$8$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$9$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$10$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n\n另外有一组不计分的 hack 数据，放在 subtask 1 中，数据范围与测试点 $6 \\sim 10$ 一致。", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] AND and OR Sum", "background": "", "description": "After learning bitwise operations and matrices, Freda decided to further study these simple and elegant operations, as well as the structures that contain profound spaces.\n\nFor a matrix consisting of non-negative integers, she defines the $\\texttt{AND}$ value of the matrix as the result of applying bitwise $\\texttt{AND(\\&)}$ to all numbers in the matrix; she defines the $\\texttt{OR}$ value of the matrix as the result of applying bitwise $\\texttt{OR(|)}$ to all numbers in the matrix.\n\nGiven an $N \\times N$ matrix, she wants to compute:\n1. The sum of the $\\texttt{AND}$ values of all submatrices (the result of adding up the $\\texttt{AND}$ values of all submatrices).\n2. The sum of the $\\texttt{OR}$ values of all submatrices (the result of adding up the $\\texttt{OR}$ values of all submatrices).\n\nYou can probably guess what happens next—Freda does not want to spend time solving such a simple problem, so she leaves it to you.\n\nSince the answer may be very large, you only need to output the result modulo $1,000,000,007 (10^9 + 7)$.", "inputFormat": "The first line of the input file contains a positive integer $N$, which denotes the size of the matrix.\n\nThe next $N$ lines each contain $N$ natural numbers, representing one row of the matrix. Any two adjacent natural numbers are separated by one or more spaces.", "outputFormat": "Output a single line containing two integers separated by a space. The first should be the remainder when the sum of $\\texttt{AND}$ values of all submatrices is taken modulo $10^9 + 7$, and the second should be the remainder when the sum of $\\texttt{OR}$ values of all submatrices is taken modulo $10^9 + 7$.", "hint": "### Explanation of Sample 1\n\nThis $3 \\times 3$ matrix has $9$ submatrices of size $1 \\times 1$, $6$ submatrices of size $1 \\times 2$, $6$ submatrices of size $2 \\times 1$, $4$ submatrices of size $2 \\times 2$, $3$ submatrices of size $1 \\times 3$, $3$ submatrices of size $3 \\times 1$, $2$ submatrices of size $2 \\times 3$, $2$ submatrices of size $3 \\times 2$, and $1$ submatrix of size $3 \\times 3$.  \nOnly one submatrix (the $1 \\times 1$ matrix consisting only of the element in the first row and first column) has an $\\texttt{AND}$ value of $1$; all other submatrices have an $\\texttt{AND}$ value of $0$, so the total sum is $1$.  \nThere are $9$ submatrices that contain the element in the first row and first column. Their $\\texttt{OR}$ value is $1$, while all other submatrices have an $\\texttt{OR}$ value of $0$, so the total sum is $9$.\n\n### Constraints\n\n|Test Point ID|Scale of $n$|Natural numbers in the matrix|\n|:-:|:-:|:-:|\n|$1$|$1 \\le n \\le 10$|$\\le 100$|\n|$2$|$1 \\le n \\le 10$|$\\le 100$|\n|$3$|$1 \\le n \\le 100$|$\\le 100$|\n|$4$|$1 \\le n \\le 100$|$\\le 100$|\n|$5$|$1 \\le n \\le 100$|$\\le 100$|\n|$6$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$7$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$8$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$9$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$10$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n\nIn addition, there is a set of unscored hack testdata placed in subtask 1, with the same constraints as test points $6 \\sim 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 与或和", "background": "", "description": "Freda 学习了位运算和矩阵以后，决定对这种简洁而优美的运算，以及蕴含深邃空间的结构进行更加深入的研究。\n\n对于一个由非负整数构成的矩阵，她定义矩阵的 $\\texttt{AND}$ 值为矩阵中所有数二进制 $\\texttt{AND(\\&)}$ 的运算结果；定义矩阵的 $\\texttt{OR}$ 值为矩阵中所有数二进制 $\\texttt{OR(|)}$ 的运算结果。\n\n给定一个 $N \\times N$ 的矩阵，她希望求出：\n1. 该矩阵的所有子矩阵的 $\\texttt{AND}$ 值之和（所有子矩阵 $\\texttt{AND}$ 值相加的结果）。\n2. 该矩阵的所有子矩阵的 $\\texttt{OR}$ 值之和（所有子矩阵 $\\texttt{OR}$ 值相加的结果）。\n\n接下来的剧情你应该已经猜到——Freda 并不想花费时间解决如此简单的问题，所以这个问题就交给你了。\n\n由于答案可能非常的大，你只需要输出答案对 $1,000,000,007 (10^9 + 7)$ 取模后的结果。", "inputFormat": "输入文件的第一行是一个正整数 $N$，表示矩阵的尺寸。\n\n接下来 $N$ 行，每行 $N$ 个自然数，代表矩阵的一行。相邻两个自然数之间由一个或多个空格隔开。", "outputFormat": "输出只有一行，包含两个用空格隔开的整数，第一个应为所有子矩阵 $\\texttt{AND}$ 值之和除以 $10^9 + 7$ 的余数，第二个应为所有子矩阵 $\\texttt{OR}$ 值之和除以 $10^9 + 7$ 的余数。", "hint": "### 样例1解释\n\n该 $3 \\times 3$ 矩阵共有 $9$ 个 $1 \\times 1$ 子矩阵、$6$ 个 $1 \\times 2$ 子矩阵、$6$ 个 $2 \\times 1$ 子矩阵、$4$ 个 $2 \\times 2$ 子矩阵、3 个 $1 \\times 3$ 子矩阵、$3$ 个 $3 \\times 1$ 子矩阵、$2$ 个 $2 \\times 3$ 子矩阵、$2$ 个 $3 \\times 2$ 子矩阵和 $1$ 个 $3 \\times 3$ 子矩阵。  \n只有一个子矩阵（仅由第一行第一列的那个元素构成的 $1 \\times 1$ 矩阵）$\\texttt{AND}$ 值为 $1$，其余子矩阵的 $\\texttt{AND}$ 值均为 $0$，总和为 $1$。  \n包含第一行第一列那个元素的子矩阵有 $9$ 个，它们的 $\\texttt{OR}$ 值为 $1$，其余子矩阵的 $\\texttt{OR}$ 值为 $0$，总和为 $9$。\n\n### 数据范围\n\n|测试点编号|$n$ 的规模|矩阵中的自然数|\n|:-:|:-:|:-:|\n|$1$|$1 \\le n \\le 10$|$\\le 100$|\n|$2$|$1 \\le n \\le 10$|$\\le 100$|\n|$3$|$1 \\le n \\le 100$|$\\le 100$|\n|$4$|$1 \\le n \\le 100$|$\\le 100$|\n|$5$|$1 \\le n \\le 100$|$\\le 100$|\n|$6$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$7$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$8$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$9$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$10$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n\n另外有一组不计分的 hack 数据，放在 subtask 1 中，数据范围与测试点 $6 \\sim 10$ 一致。", "locale": "zh-CN"}}}
{"pid": "P5301", "type": "P", "difficulty": 6, "samples": [["2\n0\n0\n7m 4p 2s 7s 6p 8s 7p 5s 9s 9s 1p 5m 9m 5s 4p 5s E 1p 6s 5p B 4m 6m W 6p 6s E 9s 5p 2s 8s 8p 4m 3s 9m 5p 3s 2s 6s 8s 8p 6p 5m 4s 3m 4s 5s 4s 6m 9s 6p N 5m 7s 4m 2m 2s 6s 3m 7p B B N 1m 3m B 8p F 7p 0\nW 4p N 3m 2m B 9m 3p 1p 6p S 4s 5p 8s 4m 5s 2s 3s 0", "1308622848\n127401984"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "贵州", "广西"], "title": "[GXOI/GZOI2019] 宝牌一大堆", "background": "", "description": "麻将是一种传统的博弈游戏，由 $4$ 名玩家参与，轮流摸牌、打牌。在竞技比赛中主要有国标麻将（中国）和立直麻将（日本）两大规则。本题采用一种特别的规则——「宝牌一大堆」规则。\n\n#### 牌型\n一副麻将由 $136$ 张牌组成，其中包含 $34$ 种不同的牌，每种各有 $4$ 张。这 $34$ 种牌分别是：  \n一万到九万、一索到九索、一筒到九筒、东、南、西、北、中、白、发。\n\n![doraippai1.png](https://cdn.luogu.com.cn/upload/pic/56677.png)\n\n它们可以组合成不同的牌型：\n- 顺子：$3$ 张数字连续的万，或 $3$ 张数字连续的索，或 $3$ 张数字连续的筒。\n- 刻子：$3$ 张完全一样的牌。\n- 杠子：$4$ 张完全一样的牌。\n- 雀头：$2$ 张完全一样的牌。\n\n其中顺子和刻子统称为面子。\n\n#### 和牌\n手牌（一名玩家持有的牌）宣告胜利的状况称为「和牌」。\n- 当玩家持有 $14$ 张牌，并且满足以下三个条件之一时，判定为「和牌」：\n  1. 存在一种方案，使得这 $14$ 张牌可以分成 $4$ 组面子、$1$ 组雀头，简记为「$3 \\times 4 + 2$」。\n  2. 存在一种方案，使得这 $14$ 张牌可以分成 $7$ 组**不同的**雀头，称为「七对子」。\n  3. 这 $14$ 张牌**仅由**一万、九万、一索、九索、一筒、九筒、东、南、西、北、中、白、发这 $13$ 种牌组成，并且这 $13$ 种牌**每种至少有 $1$ 张**，称为「国士无双」。\n- 当玩家持有 $15$ 张牌，并且存在一种方案，使得这 $15$ 张牌可以分成 $1$ 组杠子、$3$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $16$ 张牌，并且存在一种方案，使得这 $16$ 张牌可以分成 $2$ 组杠子、$2$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $17$ 张牌，并且存在一种方案，使得这 $17$ 张牌可以分成 $3$ 组杠子、$1$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $18$ 张牌，并且存在一种方案，使得这 $18$ 张牌可以分成 $4$ 组杠子、$1$ 组雀头，判定为和牌。\n\n#### 宝牌\n每局游戏还会指定若干张「宝牌」，和牌时，手牌中的每张宝牌会使收益翻一番（会在接下来详细介绍）。\n\n#### 达成分数\n由于可以「和牌」的手牌很多，可以给每种判定为「和牌」的手牌定义一个「达成分数」，这个分数等于从所有尚未打出的牌中选出若干张，能够组成该手牌的方法数，再乘上手牌中 $2$ 的「宝牌数」次方。  \n该分数综合考虑了和牌几率与和牌收益，理论上以分数较高的手牌为目标较好。\n\n例如下图手牌显然是可以「和牌」的，如果目前场上还剩 $3$ 张一万、$4$ 张九万，以及二到八万各 $2$ 张没有打出，宝牌为九万，那么下图手牌的「达成分数」就是 $C_3^3 C_4^3 C_2^2 (C_2^1)^6 2^3 = 2048$，其中 $C$ 表示组合数。\n\n![doraippai2.png](https://cdn.luogu.com.cn/upload/pic/56678.png)\n\n特别地，「七对子」和牌的手牌，达成分数额外乘 $7$。「国士无双」和牌的手牌，达成分数额外乘 $13$。\n\n有一天，小 L，小 Y，小 I 和小 W 正在打麻将，路过的雪野和看到了所有已经打出的牌，但不知道任何一名玩家的手牌。也许你已经猜到了下面的剧情—\n—雪野和想知道在所有尚未打出的牌中，「达成分数」最高的可以「和牌」的手牌有多少分，但是她还要观看麻将比赛，所以这个问题就交给你了。", "inputFormat": "每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。\n\n每组数据包含两行，第一行给出场上已经打出的牌，第二行给出该局的所有宝牌。\n\n规定用 $\\texttt{1m},\\texttt{2m},\\dots,\\texttt{9m}$ 代表万，$\\texttt{1p},\\texttt{2p},\\dots,\\texttt{9p}$ 代表筒，$\\texttt{1s},\\texttt{2s},\\dots,\\texttt{9s}$ 代表索，$\\texttt E,\\texttt S,\\texttt W,\\texttt N$ 代表东、南、西、北，$\\texttt Z,\\texttt B,\\texttt F$ 代表中、白、发，相邻两张牌之间用一个空格隔开，每行的末尾有一个单独的 $0$ 代表结束。", "outputFormat": "输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示最高分数。", "hint": "### 样例解释\n\n在第一组数据中，没有打出过任何牌，没有宝牌，和「国士无双」分数最高，为 $13 \\times 6 \\times 4^{12}$。  \n和「$3 \\times 4 + 2$」和「七对子」的分数为 $100663296$ 和 $1959552$。\n\n在第二组数据中，和「$3 \\times 4 + 2$」分数最高，为 $127401984$，可以得到该分数的手牌之一为「$\\texttt{1m2m3m 7m8m9m 1p2p3p 3p4p5p SS}$」。  \n和「七对子」的分数为 $125411328$，不存在和「国士无双」的可能。\n\n### 数据范围\n\n保证已经打出的牌必定是合法的牌，且每种不超过 $4$ 张。宝牌不会重复给出。\n\n|测试点编号|$T$ 的规模|已经打出的牌|宝牌数|\n|:-:|:-:|:-:|:-:|\n|$1$|$T = 10$|无特殊限制|$\\le 20$ 张|\n|$2$|$T = 100$|至少包括所有数字为三到七的牌|$\\le 20$ 张|\n|$3$|$T = 500$|每种至少 $2$ 张|$\\le 20$ 张|\n|$4$|$T = 500$|每种至少 $3$ 张|$\\le 20$ 张|\n|$5$|$T = 500$|无特殊限制|$0$ 张|\n|$6$|$T = 1,000$|无特殊限制|$0$ 张|\n|$7$|$T = 1,000$|无特殊限制|$\\le 20$ 张|\n|$8$|$T = 1,500$|无特殊限制|$\\le 20$ 张|\n|$9$|$T = 2,000$|无特殊限制|$\\le 20$ 张|\n|$10$|$T = 2,500$|无特殊限制|$\\le 20$ 张|", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] A Pile of Dora Tiles", "background": "", "description": "Mahjong is a traditional board game played by $4$ players, who take turns drawing and discarding tiles. In competitive matches, the two main rulesets are Chinese Official Mahjong (China) and Riichi Mahjong (Japan). This problem uses a special ruleset: “A Pile of Dora Tiles”.\n\n#### Tile Types\nA full mahjong set contains $136$ tiles, including $34$ different types of tiles, with $4$ copies of each type. These $34$ types are:  \n$1$-man to $9$-man, $1$-sou to $9$-sou, $1$-pin to $9$-pin, East, South, West, North, Red, White, Green.\n\n![doraippai1.png](https://cdn.luogu.com.cn/upload/pic/56677.png)\n\nThey can form different groups:\n- Sequence: $3$ consecutive number tiles in manzu, or $3$ consecutive number tiles in souzu, or $3$ consecutive number tiles in pinzu.\n- Triplet: $3$ identical tiles.\n- Quad: $4$ identical tiles.\n- Pair: $2$ identical tiles.\n\nSequences and triplets are collectively called melds.\n\n#### Winning Hand\nA hand (the tiles held by one player) that declares victory is called a “winning hand”.\n- When a player holds $14$ tiles and satisfies one of the following three conditions, it is a winning hand:\n  1. There exists a way to split these $14$ tiles into $4$ melds and $1$ pair, denoted as “$3 \\times 4 + 2$”.\n  2. There exists a way to split these $14$ tiles into $7$ **distinct** pairs, called “Seven Pairs”.\n  3. These $14$ tiles consist **only of** the following $13$ tile types: $1$-man, $9$-man, $1$-sou, $9$-sou, $1$-pin, $9$-pin, East, South, West, North, Red, White, Green; and among these $13$ types, **each type appears at least once**. This is called “Thirteen Orphans”.\n- When a player holds $15$ tiles and there exists a way to split these $15$ tiles into $1$ quad, $3$ melds, and $1$ pair, it is a winning hand.\n- When a player holds $16$ tiles and there exists a way to split these $16$ tiles into $2$ quads, $2$ melds, and $1$ pair, it is a winning hand.\n- When a player holds $17$ tiles and there exists a way to split these $17$ tiles into $3$ quads, $1$ meld, and $1$ pair, it is a winning hand.\n- When a player holds $18$ tiles and there exists a way to split these $18$ tiles into $4$ quads and $1$ pair, it is a winning hand.\n\n#### Dora Tiles\nIn each round, several “dora tiles” are also specified. When you win, each dora tile in your hand doubles the payoff (explained in detail below).\n\n#### Achieved Score\nSince there are many possible winning hands, we define an “achieved score” for each winning hand. This score equals: the number of ways to choose some tiles from all tiles that have not been discarded yet such that they form this hand, multiplied by $2^{(\\text{number of dora tiles in the hand})}$.  \nThis score considers both the chance to win and the payoff after winning. In theory, it is better to aim for hands with higher scores.\n\nFor example, the hand shown below is clearly a winning hand. If there are still $3$ copies of $1$-man, $4$ copies of $9$-man, and $2$ copies of each of $2$-man through $8$-man not yet discarded on the table, and the dora tile is $9$-man, then the achieved score of the hand below is $C_3^3 C_4^3 C_2^2 (C_2^1)^6 2^3 = 2048$, where $C$ denotes the binomial coefficient.\n\n![doraippai2.png](https://cdn.luogu.com.cn/upload/pic/56678.png)\n\nIn particular, for a “Seven Pairs” winning hand, the achieved score is additionally multiplied by $7$.  \nFor a “Thirteen Orphans” winning hand, the achieved score is additionally multiplied by $13$.\n\nOne day, Xiao L, Xiao Y, Xiao I, and Xiao W were playing mahjong. Yukino Wakana, who happened to pass by, saw all the tiles that had already been discarded, but did not know any player’s hand. Perhaps you have already guessed what happens next—  \n—Yukino Wakana wants to know, among all tiles not yet discarded, what is the maximum achieved score of any winning hand. But she still needs to watch the mahjong match, so she leaves this problem to you.", "inputFormat": "Each test point contains multiple test cases. The first line is an integer $T$, the number of test cases. Note that the test cases are independent.\n\nEach test case consists of two lines. The first line gives the tiles already discarded on the table, and the second line gives all dora tiles for this round.\n\nWe use $\\texttt{1m},\\texttt{2m},\\dots,\\texttt{9m}$ for manzu, $\\texttt{1p},\\texttt{2p},\\dots,\\texttt{9p}$ for pinzu, $\\texttt{1s},\\texttt{2s},\\dots,\\texttt{9s}$ for souzu, $\\texttt E,\\texttt S,\\texttt W,\\texttt N$ for East, South, West, North, and $\\texttt Z,\\texttt B,\\texttt F$ for Red, White, Green. Adjacent tiles are separated by a single space, and each line ends with a standalone $0$ indicating the end.", "outputFormat": "The output should contain $T$ lines. For each test case, output one integer, the maximum score.", "hint": "### Sample Explanation\n\nIn the first test case, no tiles have been discarded, and there are no dora tiles. “Thirteen Orphans” has the highest score, which is $13 \\times 6 \\times 4^{12}$.  \nThe scores for “$3 \\times 4 + 2$” and “Seven Pairs” are $100663296$ and $1959552$, respectively.\n\nIn the second test case, “$3 \\times 4 + 2$” has the highest score, which is $127401984$. One hand that achieves this score is “$\\texttt{1m2m3m 7m8m9m 1p2p3p 3p4p5p SS}$”.  \nThe score for “Seven Pairs” is $125411328$, and it is impossible to form “Thirteen Orphans”.\n\n### Constraints\n\nIt is guaranteed that the discarded tiles are always legal tiles, and for each type there are no more than $4$ copies. Dora tiles are given without repetition.\n\n|Test Point ID|Scale of $T$|Discarded Tiles|Number of Dora Tiles|\n|:-:|:-:|:-:|:-:|\n|$1$|$T = 10$|No special restrictions|$\\le 20$ tiles|\n|$2$|$T = 100$|Includes at least all number tiles from $3$ to $7$|$\\le 20$ tiles|\n|$3$|$T = 500$|At least $2$ copies of each type|$\\le 20$ tiles|\n|$4$|$T = 500$|At least $3$ copies of each type|$\\le 20$ tiles|\n|$5$|$T = 500$|No special restrictions|$0$ tiles|\n|$6$|$T = 1,000$|No special restrictions|$0$ tiles|\n|$7$|$T = 1,000$|No special restrictions|$\\le 20$ tiles|\n|$8$|$T = 1,500$|No special restrictions|$\\le 20$ tiles|\n|$9$|$T = 2,000$|No special restrictions|$\\le 20$ tiles|\n|$10$|$T = 2,500$|No special restrictions|$\\le 20$ tiles|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 宝牌一大堆", "background": "", "description": "麻将是一种传统的博弈游戏，由 $4$ 名玩家参与，轮流摸牌、打牌。在竞技比赛中主要有国标麻将（中国）和立直麻将（日本）两大规则。本题采用一种特别的规则——「宝牌一大堆」规则。\n\n#### 牌型\n一副麻将由 $136$ 张牌组成，其中包含 $34$ 种不同的牌，每种各有 $4$ 张。这 $34$ 种牌分别是：  \n一万到九万、一索到九索、一筒到九筒、东、南、西、北、中、白、发。\n\n![doraippai1.png](https://cdn.luogu.com.cn/upload/pic/56677.png)\n\n它们可以组合成不同的牌型：\n- 顺子：$3$ 张数字连续的万，或 $3$ 张数字连续的索，或 $3$ 张数字连续的筒。\n- 刻子：$3$ 张完全一样的牌。\n- 杠子：$4$ 张完全一样的牌。\n- 雀头：$2$ 张完全一样的牌。\n\n其中顺子和刻子统称为面子。\n\n#### 和牌\n手牌（一名玩家持有的牌）宣告胜利的状况称为「和牌」。\n- 当玩家持有 $14$ 张牌，并且满足以下三个条件之一时，判定为「和牌」：\n  1. 存在一种方案，使得这 $14$ 张牌可以分成 $4$ 组面子、$1$ 组雀头，简记为「$3 \\times 4 + 2$」。\n  2. 存在一种方案，使得这 $14$ 张牌可以分成 $7$ 组**不同的**雀头，称为「七对子」。\n  3. 这 $14$ 张牌**仅由**一万、九万、一索、九索、一筒、九筒、东、南、西、北、中、白、发这 $13$ 种牌组成，并且这 $13$ 种牌**每种至少有 $1$ 张**，称为「国士无双」。\n- 当玩家持有 $15$ 张牌，并且存在一种方案，使得这 $15$ 张牌可以分成 $1$ 组杠子、$3$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $16$ 张牌，并且存在一种方案，使得这 $16$ 张牌可以分成 $2$ 组杠子、$2$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $17$ 张牌，并且存在一种方案，使得这 $17$ 张牌可以分成 $3$ 组杠子、$1$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $18$ 张牌，并且存在一种方案，使得这 $18$ 张牌可以分成 $4$ 组杠子、$1$ 组雀头，判定为和牌。\n\n#### 宝牌\n每局游戏还会指定若干张「宝牌」，和牌时，手牌中的每张宝牌会使收益翻一番（会在接下来详细介绍）。\n\n#### 达成分数\n由于可以「和牌」的手牌很多，可以给每种判定为「和牌」的手牌定义一个「达成分数」，这个分数等于从所有尚未打出的牌中选出若干张，能够组成该手牌的方法数，再乘上手牌中 $2$ 的「宝牌数」次方。  \n该分数综合考虑了和牌几率与和牌收益，理论上以分数较高的手牌为目标较好。\n\n例如下图手牌显然是可以「和牌」的，如果目前场上还剩 $3$ 张一万、$4$ 张九万，以及二到八万各 $2$ 张没有打出，宝牌为九万，那么下图手牌的「达成分数」就是 $C_3^3 C_4^3 C_2^2 (C_2^1)^6 2^3 = 2048$，其中 $C$ 表示组合数。\n\n![doraippai2.png](https://cdn.luogu.com.cn/upload/pic/56678.png)\n\n特别地，「七对子」和牌的手牌，达成分数额外乘 $7$。「国士无双」和牌的手牌，达成分数额外乘 $13$。\n\n有一天，小 L，小 Y，小 I 和小 W 正在打麻将，路过的雪野和看到了所有已经打出的牌，但不知道任何一名玩家的手牌。也许你已经猜到了下面的剧情—\n—雪野和想知道在所有尚未打出的牌中，「达成分数」最高的可以「和牌」的手牌有多少分，但是她还要观看麻将比赛，所以这个问题就交给你了。", "inputFormat": "每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。\n\n每组数据包含两行，第一行给出场上已经打出的牌，第二行给出该局的所有宝牌。\n\n规定用 $\\texttt{1m},\\texttt{2m},\\dots,\\texttt{9m}$ 代表万，$\\texttt{1p},\\texttt{2p},\\dots,\\texttt{9p}$ 代表筒，$\\texttt{1s},\\texttt{2s},\\dots,\\texttt{9s}$ 代表索，$\\texttt E,\\texttt S,\\texttt W,\\texttt N$ 代表东、南、西、北，$\\texttt Z,\\texttt B,\\texttt F$ 代表中、白、发，相邻两张牌之间用一个空格隔开，每行的末尾有一个单独的 $0$ 代表结束。", "outputFormat": "输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示最高分数。", "hint": "### 样例解释\n\n在第一组数据中，没有打出过任何牌，没有宝牌，和「国士无双」分数最高，为 $13 \\times 6 \\times 4^{12}$。  \n和「$3 \\times 4 + 2$」和「七对子」的分数为 $100663296$ 和 $1959552$。\n\n在第二组数据中，和「$3 \\times 4 + 2$」分数最高，为 $127401984$，可以得到该分数的手牌之一为「$\\texttt{1m2m3m 7m8m9m 1p2p3p 3p4p5p SS}$」。  \n和「七对子」的分数为 $125411328$，不存在和「国士无双」的可能。\n\n### 数据范围\n\n保证已经打出的牌必定是合法的牌，且每种不超过 $4$ 张。宝牌不会重复给出。\n\n|测试点编号|$T$ 的规模|已经打出的牌|宝牌数|\n|:-:|:-:|:-:|:-:|\n|$1$|$T = 10$|无特殊限制|$\\le 20$ 张|\n|$2$|$T = 100$|至少包括所有数字为三到七的牌|$\\le 20$ 张|\n|$3$|$T = 500$|每种至少 $2$ 张|$\\le 20$ 张|\n|$4$|$T = 500$|每种至少 $3$ 张|$\\le 20$ 张|\n|$5$|$T = 500$|无特殊限制|$0$ 张|\n|$6$|$T = 1,000$|无特殊限制|$0$ 张|\n|$7$|$T = 1,000$|无特殊限制|$\\le 20$ 张|\n|$8$|$T = 1,500$|无特殊限制|$\\le 20$ 张|\n|$9$|$T = 2,000$|无特殊限制|$\\le 20$ 张|\n|$10$|$T = 2,500$|无特殊限制|$\\le 20$ 张|", "locale": "zh-CN"}}}
{"pid": "P5302", "type": "P", "difficulty": 7, "samples": [["4 1 2 3 1 6\n1 2 3 4\n4 1 3 2\n2\n3 3 1\n5 2 2", "13 15"], ["10 73 28 13 0 100\n2 9 16 25 29 34 43 46 52 58\n8 25 35 52 41 5 16 3 19 48\n5\n46 40 1\n37 27 5\n67 34 1\n65 28 4\n29 38 1", "989 1619"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["计算几何", "2019", "各省省选", "离散化", "贵州", "广西", "扫描线"], "title": "[GXOI/GZOI2019] 特技飞行", "background": "", "description": "公元 $9012$ 年，Z 市的航空基地计划举行一场特技飞行表演。表演的场地可以看作一个二维平面直角坐标系，其中横坐标代表着水平位置，纵坐标代表着飞行高度。\n\n在最初的计划中，这 $n$ 架飞机首先会飞行到起点 $x = x_{st}$ 处，其中第 $i$ 架飞机在起点处的高度为 $y_{i,0}$。它们的目标是终点 $x = x_{ed}$ 处，其中第 $i$ 架飞机在终点处的高度应为 $y_{i,1}$。因此，每架飞机可以看作坐标系中的一个点，它的航线是从 $(x_{st},y_{i,0})$ 出发、到 $(x_{ed},y_{i,1})$ 结束的一条线段，如下图所示。\n\n![aerobatics1.png](https://cdn.luogu.com.cn/upload/pic/56679.png)\n\n这 $n$ 架飞机同时出发且始终保持一定的对地速度。因此，对于任意两条交叉的航线（线段），对应的两架飞机必然会同时到达交点处——这就是它们进行特技表演的时刻。它们将会偏转机翼，展现以极近的距离「擦身而过」特技，然后**继续保持各自的航线**。\n\n航空基地最近还研究了一种新的特技「对向交换」。当两架飞机到达交点处时，之前正在下降的那架立即转为执行抬升动作，之前正在上升的那架则执行一次空翻，两架飞机一上一下、机腹对机腹，同样以极近的距离经过交点，然后**互相交换接下来的航线**。\n\n我们不必关心特技动作在物理上究竟是如何实现的，飞机仍然看作一个点，在两种特技动作下，航线的变化如下图所示（$y_{i,1}'$ 表示交换航线后第 $i$ 架飞机在终点的新高度）。容易发现，「对向交换」会使它们的航线变为折线，并**保持它们在纵坐标上的相对顺序**；而「擦身而过」会**改变它们在纵坐标上的相对顺序**。\n\n![aerobatics2.png](https://cdn.luogu.com.cn/upload/pic/56680.png)\n\n现在，观看表演的嘉宾团提出了一个苛刻的要求——在终点 $x = x_{ed}$ 处，按照高度排序，$n$ 架飞机的相对顺序必须与 $x = x_{st}$ 处的相对顺序一致。嘉宾团还给「对向交换」特技和「擦身而过」特技分别评定了难度系数 $a$ 和 $b$，每次「对向交换」特技可以获得 $a$ 的分数，每次「擦身而过」特技可以获得 $b$ 的分数。\n\n除此以外，嘉宾团共有 $k$ 名成员，第 $i$ 名成员会乘热气球停留在位置 $(p_i,q_i)$ 处，具有 $r_i$ 的观测距离，可以观测到区域 $|x - p_i| + |y - q_i| \\le r_i$ 里的所有特技。  \n若某个交点处的特技被**一名或多名**嘉宾观测到，则可以获得 $c$ 的额外加分。  \n注意：**特技无论是否被观测到，均可以获得 $a$ 或者 $b$ 的得分**。\n\n下图是对本题第一幅图 $4$ 条航线 $4$ 个交点的一种满足要求的安排，包括 $2$ 次「对向交换」、$2$ 次「擦身而过」，$3$ 项特技被观测到，得分 $2a + 2b + 3c$。为了方便观察，图中展现「对向交换」特技的交点稍稍有些分离。\n\n![aerobatics3.png](https://cdn.luogu.com.cn/upload/pic/56681.png)\n\n在这次的剧情里，你成为了 Z 市航空基地的规划员，你可以决定在每个交点处是执行「对向交换」还是「擦身而过」。你被要求在保证嘉宾团要求的前提下，计算整个特技表演的可能得到的最低和最高分数。", "inputFormat": "第一行包含六个非负整数 $n,a,b,c,x_{st},x_{ed}$，分别表示航线（线段）总数、「对向交换」特技的得分、「擦身而过」特技的得分、观测对表演的额外分、飞行起点的横坐标、飞行终点的横坐标。\n\n第二行包含 $n$ 个非负整数 $y_{i,0}$，其中第 $i$ 个数表示第 $i$ 条航线起点的纵坐标，保证按照从低到高的顺序给出，即 $y_{i,0} < y_{i + 1,0}$。\n\n第三行包含 $n$ 个非负整数 $y_{i,1}$，其中第 $i$ 个数表示第 $i$ 条航线终点的纵坐标。\n\n第四行包含一个非负整数 $k$，表示嘉宾的数量。\n\n接下来 $k$ 行每行三个非负整数 $p_i,q_i,r_i$，分别表示第 $i$ 名嘉宾所在位置的横、纵坐标与观测距离。\n\n输入数据对于所有航线（线段）在直线 $x = x_{st}$ 和 $x = x_{ed}$ 之间的交点总数也有一些限制，详见「数据范围与提示」。", "outputFormat": "输出只有一行，包含两个整数，表示整个特技飞行表演的可能得到的最低和最高分数，中间用一个空格隔开。", "hint": "### 样例1解释\n\n该样例的航线就是题目描述的图中所画的情况，只是嘉宾所在的位置稍有不同。  \n最低得分的表演方案是在所有交点处均采用「对向交换」特技，得分 $4a + 3c = 13$。  \n最高得分的表演方案与题目描述的图中所画的情况一致，得分 $2a + 2b + 3c = 15$。\n\n### 数据范围\n\n不存在三条或三条以上的线段交于同一点。  \n所有坐标和 $r_i$ 均为 $5 \\times 10^7$ 以内的非负整数。  \n$y_{i,0} < y_{i + 1,0}$，$y_{i,1}$ 各不相同。  \n$x_{st} < p_i < x_{ed},1 ≤ a,b,c ≤ 10^3$。\n\n|测试点编号|$n,k$ 的规模|交点数的规模|约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$n,k \\le 15$|$\\le 40$|无|\n|$2$|$n,k \\le 15$|$\\le 40$|无|\n|$3$|$n,k \\le 15$|$\\le 40$|无|\n|$4$|$n,k \\le 15$|$\\le 40$|无|\n|$5$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$6$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$7$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$8$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$9$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$10$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$11$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$12$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$13$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$14$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$15$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$16$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$17$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$18$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$19$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$20$|$n,k \\le 100,000$|$\\le 500,000$|无|", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] Aerobatic Flight", "background": "", "description": "In the year $9012$, the aviation base of City Z plans to hold an aerobatic flight show. The show venue can be seen as a 2D Cartesian coordinate system, where the $x$-coordinate represents the horizontal position and the $y$-coordinate represents the flight altitude.\n\nIn the initial plan, these $n$ aircraft will first fly to the starting line $x = x_{st}$. For aircraft $i$, its altitude at the start is $y_{i,0}$. Their destination is the ending line $x = x_{ed}$, where aircraft $i$ should be at altitude $y_{i,1}$. Therefore, each aircraft can be viewed as a point in the coordinate system, and its route is a line segment starting from $(x_{st}, y_{i,0})$ and ending at $(x_{ed}, y_{i,1})$, as shown below.\n\n![aerobatics1.png](https://cdn.luogu.com.cn/upload/pic/56679.png)\n\nAll $n$ aircraft depart at the same time and always maintain a constant ground speed. Therefore, for any two intersecting routes (segments), the two corresponding aircraft will 반드시 reach the intersection point at the same time—this is the moment they perform an aerobatic stunt. They will bank their wings and perform a close “pass-by” stunt, and then **continue along their own routes**.\n\nThe aviation base has also recently developed a new stunt called “head-on swap”. When two aircraft reach the intersection point, the one that was descending immediately starts climbing, while the one that was climbing performs a flip. The two aircraft pass the intersection point one above the other, belly to belly, also at a very close distance, and then **swap their remaining routes**.\n\nWe do not need to care how these stunts are physically achieved. Aircraft are still treated as points. Under these two stunts, the route changes are shown below ($y_{i,1}'$ denotes the new ending altitude of aircraft $i$ after swapping routes). It is easy to see that “head-on swap” turns their routes into polylines and **keeps their relative order in the $y$-coordinate**; while “pass-by” **changes their relative order in the $y$-coordinate**.\n\n![aerobatics2.png](https://cdn.luogu.com.cn/upload/pic/56680.png)\n\nNow, the visiting guests提出 a strict requirement: at the ending line $x = x_{ed}$, when sorting by altitude, the relative order of the $n$ aircraft must be the same as the relative order at $x = x_{st}$. The guests also assign difficulty coefficients $a$ and $b$ to the “head-on swap” stunt and the “pass-by” stunt, respectively. Each “head-on swap” gives a score of $a$, and each “pass-by” gives a score of $b$.\n\nIn addition, there are $k$ guests. Guest $i$ stays in a hot-air balloon at position $(p_i, q_i)$ and has an observation range $r_i$, so they can observe all stunts within the region $|x - p_i| + |y - q_i| \\le r_i$.  \nIf a stunt at some intersection point is observed by **one or more** guests, an extra bonus score of $c$ is obtained.  \nNote: **Whether or not a stunt is observed, it still earns the score $a$ or $b$.**\n\nThe figure below shows, for the $4$ routes and $4$ intersections in the first figure, one arrangement that meets the requirement: it includes $2$ “head-on swap” stunts, $2$ “pass-by” stunts, and $3$ stunts are observed, for a total score of $2a + 2b + 3c$. For easier viewing, the intersections where “head-on swap” occurs are drawn slightly separated.\n\n![aerobatics3.png](https://cdn.luogu.com.cn/upload/pic/56681.png)\n\nIn this story, you are the planner of City Z’s aviation base. You can decide, at each intersection point, whether to perform “head-on swap” or “pass-by”. You are required, while ensuring the guests’ requirement, to compute the minimum and maximum total scores that the whole aerobatic show can achieve.", "inputFormat": "The first line contains six non-negative integers $n, a, b, c, x_{st}, x_{ed}$, representing the total number of routes (segments), the score for the “head-on swap” stunt, the score for the “pass-by” stunt, the extra bonus for being observed, the $x$-coordinate of the starting line, and the $x$-coordinate of the ending line.\n\nThe second line contains $n$ non-negative integers $y_{i,0}$. The $i$-th number is the $y$-coordinate of the start point of route $i$. It is guaranteed that they are given in increasing order, i.e. $y_{i,0} < y_{i + 1,0}$.\n\nThe third line contains $n$ non-negative integers $y_{i,1}$. The $i$-th number is the $y$-coordinate of the end point of route $i$.\n\nThe fourth line contains a non-negative integer $k$, the number of guests.\n\nThe next $k$ lines each contain three non-negative integers $p_i, q_i, r_i$, representing the $x$-coordinate, $y$-coordinate, and observation range of guest $i$.\n\nThe input also imposes some limits on the total number of intersection points of all routes (segments) between the lines $x = x_{st}$ and $x = x_{ed}$. See “Constraints and Hint” for details.", "outputFormat": "Output only one line containing two integers: the minimum and maximum possible total scores of the whole aerobatic show, separated by a space.", "hint": "### Sample 1 Explanation\n\nThe routes in this sample are exactly those shown in the figure in the statement, except that the guests’ positions are slightly different.  \nThe minimum-score plan uses the “head-on swap” stunt at all intersection points, with score $4a + 3c = 13$.  \nThe maximum-score plan is the same as the one shown in the figure in the statement, with score $2a + 2b + 3c = 15$.\n\n### Constraints\n\nNo three or more segments intersect at the same point.  \nAll coordinates and $r_i$ are non-negative integers not exceeding $5 \\times 10^7$.  \n$y_{i,0} < y_{i + 1,0}$, and all $y_{i,1}$ are distinct.  \n$x_{st} < p_i < x_{ed}, 1 \\le a, b, c \\le 10^3$.\n\n|Test Point ID|Scale of $n, k$|Scale of number of intersections|Notes|\n|:-:|:-:|:-:|:-:|\n|$1$|$n, k \\le 15$|$\\le 40$|None|\n|$2$|$n, k \\le 15$|$\\le 40$|None|\n|$3$|$n, k \\le 15$|$\\le 40$|None|\n|$4$|$n, k \\le 15$|$\\le 40$|None|\n|$5$|$n \\le 30,000, k \\le 100$|$\\le 200,000$|None|\n|$6$|$n \\le 30,000, k \\le 100$|$\\le 200,000$|None|\n|$7$|$n \\le 30,000, k \\le 100$|$\\le 200,000$|None|\n|$8$|$n \\le 30,000, k \\le 100$|$\\le 200,000$|None|\n|$9$|$n, k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$10$|$n, k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$11$|$n, k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$12$|$n, k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$13$|$n, k \\le 50,000$|$\\le 250,000$|None|\n|$14$|$n, k \\le 50,000$|$\\le 250,000$|None|\n|$15$|$n, k \\le 50,000$|$\\le 250,000$|None|\n|$16$|$n, k \\le 50,000$|$\\le 250,000$|None|\n|$17$|$n, k \\le 100,000$|$\\le 500,000$|None|\n|$18$|$n, k \\le 100,000$|$\\le 500,000$|None|\n|$19$|$n, k \\le 100,000$|$\\le 500,000$|None|\n|$20$|$n, k \\le 100,000$|$\\le 500,000$|None|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 特技飞行", "background": "", "description": "公元 $9012$ 年，Z 市的航空基地计划举行一场特技飞行表演。表演的场地可以看作一个二维平面直角坐标系，其中横坐标代表着水平位置，纵坐标代表着飞行高度。\n\n在最初的计划中，这 $n$ 架飞机首先会飞行到起点 $x = x_{st}$ 处，其中第 $i$ 架飞机在起点处的高度为 $y_{i,0}$。它们的目标是终点 $x = x_{ed}$ 处，其中第 $i$ 架飞机在终点处的高度应为 $y_{i,1}$。因此，每架飞机可以看作坐标系中的一个点，它的航线是从 $(x_{st},y_{i,0})$ 出发、到 $(x_{ed},y_{i,1})$ 结束的一条线段，如下图所示。\n\n![aerobatics1.png](https://cdn.luogu.com.cn/upload/pic/56679.png)\n\n这 $n$ 架飞机同时出发且始终保持一定的对地速度。因此，对于任意两条交叉的航线（线段），对应的两架飞机必然会同时到达交点处——这就是它们进行特技表演的时刻。它们将会偏转机翼，展现以极近的距离「擦身而过」特技，然后**继续保持各自的航线**。\n\n航空基地最近还研究了一种新的特技「对向交换」。当两架飞机到达交点处时，之前正在下降的那架立即转为执行抬升动作，之前正在上升的那架则执行一次空翻，两架飞机一上一下、机腹对机腹，同样以极近的距离经过交点，然后**互相交换接下来的航线**。\n\n我们不必关心特技动作在物理上究竟是如何实现的，飞机仍然看作一个点，在两种特技动作下，航线的变化如下图所示（$y_{i,1}'$ 表示交换航线后第 $i$ 架飞机在终点的新高度）。容易发现，「对向交换」会使它们的航线变为折线，并**保持它们在纵坐标上的相对顺序**；而「擦身而过」会**改变它们在纵坐标上的相对顺序**。\n\n![aerobatics2.png](https://cdn.luogu.com.cn/upload/pic/56680.png)\n\n现在，观看表演的嘉宾团提出了一个苛刻的要求——在终点 $x = x_{ed}$ 处，按照高度排序，$n$ 架飞机的相对顺序必须与 $x = x_{st}$ 处的相对顺序一致。嘉宾团还给「对向交换」特技和「擦身而过」特技分别评定了难度系数 $a$ 和 $b$，每次「对向交换」特技可以获得 $a$ 的分数，每次「擦身而过」特技可以获得 $b$ 的分数。\n\n除此以外，嘉宾团共有 $k$ 名成员，第 $i$ 名成员会乘热气球停留在位置 $(p_i,q_i)$ 处，具有 $r_i$ 的观测距离，可以观测到区域 $|x - p_i| + |y - q_i| \\le r_i$ 里的所有特技。  \n若某个交点处的特技被**一名或多名**嘉宾观测到，则可以获得 $c$ 的额外加分。  \n注意：**特技无论是否被观测到，均可以获得 $a$ 或者 $b$ 的得分**。\n\n下图是对本题第一幅图 $4$ 条航线 $4$ 个交点的一种满足要求的安排，包括 $2$ 次「对向交换」、$2$ 次「擦身而过」，$3$ 项特技被观测到，得分 $2a + 2b + 3c$。为了方便观察，图中展现「对向交换」特技的交点稍稍有些分离。\n\n![aerobatics3.png](https://cdn.luogu.com.cn/upload/pic/56681.png)\n\n在这次的剧情里，你成为了 Z 市航空基地的规划员，你可以决定在每个交点处是执行「对向交换」还是「擦身而过」。你被要求在保证嘉宾团要求的前提下，计算整个特技表演的可能得到的最低和最高分数。", "inputFormat": "第一行包含六个非负整数 $n,a,b,c,x_{st},x_{ed}$，分别表示航线（线段）总数、「对向交换」特技的得分、「擦身而过」特技的得分、观测对表演的额外分、飞行起点的横坐标、飞行终点的横坐标。\n\n第二行包含 $n$ 个非负整数 $y_{i,0}$，其中第 $i$ 个数表示第 $i$ 条航线起点的纵坐标，保证按照从低到高的顺序给出，即 $y_{i,0} < y_{i + 1,0}$。\n\n第三行包含 $n$ 个非负整数 $y_{i,1}$，其中第 $i$ 个数表示第 $i$ 条航线终点的纵坐标。\n\n第四行包含一个非负整数 $k$，表示嘉宾的数量。\n\n接下来 $k$ 行每行三个非负整数 $p_i,q_i,r_i$，分别表示第 $i$ 名嘉宾所在位置的横、纵坐标与观测距离。\n\n输入数据对于所有航线（线段）在直线 $x = x_{st}$ 和 $x = x_{ed}$ 之间的交点总数也有一些限制，详见「数据范围与提示」。", "outputFormat": "输出只有一行，包含两个整数，表示整个特技飞行表演的可能得到的最低和最高分数，中间用一个空格隔开。", "hint": "### 样例1解释\n\n该样例的航线就是题目描述的图中所画的情况，只是嘉宾所在的位置稍有不同。  \n最低得分的表演方案是在所有交点处均采用「对向交换」特技，得分 $4a + 3c = 13$。  \n最高得分的表演方案与题目描述的图中所画的情况一致，得分 $2a + 2b + 3c = 15$。\n\n### 数据范围\n\n不存在三条或三条以上的线段交于同一点。  \n所有坐标和 $r_i$ 均为 $5 \\times 10^7$ 以内的非负整数。  \n$y_{i,0} < y_{i + 1,0}$，$y_{i,1}$ 各不相同。  \n$x_{st} < p_i < x_{ed},1 ≤ a,b,c ≤ 10^3$。\n\n|测试点编号|$n,k$ 的规模|交点数的规模|约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$n,k \\le 15$|$\\le 40$|无|\n|$2$|$n,k \\le 15$|$\\le 40$|无|\n|$3$|$n,k \\le 15$|$\\le 40$|无|\n|$4$|$n,k \\le 15$|$\\le 40$|无|\n|$5$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$6$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$7$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$8$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$9$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$10$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$11$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$12$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$13$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$14$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$15$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$16$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$17$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$18$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$19$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$20$|$n,k \\le 100,000$|$\\le 500,000$|无|", "locale": "zh-CN"}}}
{"pid": "P5303", "type": "P", "difficulty": 6, "samples": [["3\n1\n2\n4", "0\n0\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "贵州", "广西"], "title": "[GXOI/GZOI2019] 逼死强迫症", "background": "", "description": "ITX351 要铺一条 $2 \\times N$ 的路，为此他购买了 $N$ 块 $2 \\times 1$ 的方砖。可是其中一块砖在运送的过程中从中间裂开了，变成了两块 $1 \\times 1$ 的砖块！  \nITX351 由此产生了一个邪恶的想法：他想要在这条路上故意把两块 $1 \\times 1$ 的砖块分开铺，**不让两块砖有相邻的边**，其他砖块可以随意铺，直到整条路铺满。这样一定可以逼死自身强迫症 sea5！\n\n也许下面的剧情你已经猜到了——他为此兴奋不已，以至于无法敲键盘。于是，他请你帮忙计算一下，有多少种方案可以让自己的阴谋得逞。", "inputFormat": "每个测试点包含多组数据，输入文件的第一行是一个正整数 $T$，表示数据的组数。注意各组数据之间是独立无关的。\n\n接下来 $T$ 行，每行包含一个正整数 $N$，代表一组数据中路的长度。", "outputFormat": "输出应包含 $T$ 行，对于每组数据，输出一个正整数，表示满足条件的方案数。\n\n由于答案可能非常的大，你只需要输出答案对 $1000000007 (10^9 + 7)$ 取模后的结果。", "hint": "样例中 $ N=4 $ 解释见下图：\n\n![](https://cdn.luogu.com.cn/upload/pic/56734.png)\n\n### 数据范围\n\n|测试点编号|$N$ 的规模|$T$ 的规模|\n|:-:|:-:|:-:|\n|$1$|$N \\le 10$|$T \\le 10$|\n|$2$|$N \\le 10$|$T \\le 10$|\n|$3$|$N \\le 10^5$|$T \\le 50$|\n|$4$|$N \\le 10^5$|$T \\le 50$|\n|$5$|$N \\le 10^5$|$T \\le 50$|\n|$6$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$7$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$8$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$9$|$N \\le 2 \\times 10^9$|$T \\le 500$|\n|$10$|$N \\le 2 \\times 10^9$|$T \\le 500$|", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] Forcing OCD to Death", "background": "", "description": "ITX351 wants to pave a $2 \\times N$ road, so he bought $N$ $2 \\times 1$ bricks. However, one brick cracked in the middle during transportation and became two $1 \\times 1$ blocks.  \nThis gave ITX351 an evil idea: he wants to deliberately place the two $1 \\times 1$ blocks separately on the road, **making sure the two blocks do not share any adjacent edge**. The other bricks can be placed in any way, until the whole road is fully covered. This will surely drive his own OCD (sea5) crazy!\n\nMaybe you have already guessed what happens next—he got so excited that he could not type anymore. So he asks you to help compute how many different ways there are to make his plot succeed.", "inputFormat": "Each test point contains multiple test cases. The first line of the input file is a positive integer $T$, which denotes the number of test cases. Note that different test cases are independent.\n\nThe next $T$ lines each contain a positive integer $N$, representing the length of the road in that test case.", "outputFormat": "The output should contain $T$ lines. For each test case, output a positive integer, representing the number of valid tilings that satisfy the condition.\n\nSince the answer may be very large, you only need to output the result modulo $1000000007 (10^9 + 7)$.", "hint": "For the sample, the explanation for $N = 4$ is shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/pic/56734.png)\n\n### Constraints\n\n|Test point ID|Scale of $N$|Scale of $T$|\n|:-:|:-:|:-:|\n|$1$|$N \\le 10$|$T \\le 10$|\n|$2$|$N \\le 10$|$T \\le 10$|\n|$3$|$N \\le 10^5$|$T \\le 50$|\n|$4$|$N \\le 10^5$|$T \\le 50$|\n|$5$|$N \\le 10^5$|$T \\le 50$|\n|$6$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$7$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$8$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$9$|$N \\le 2 \\times 10^9$|$T \\le 500$|\n|$10$|$N \\le 2 \\times 10^9$|$T \\le 500$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 逼死强迫症", "background": "", "description": "ITX351 要铺一条 $2 \\times N$ 的路，为此他购买了 $N$ 块 $2 \\times 1$ 的方砖。可是其中一块砖在运送的过程中从中间裂开了，变成了两块 $1 \\times 1$ 的砖块！  \nITX351 由此产生了一个邪恶的想法：他想要在这条路上故意把两块 $1 \\times 1$ 的砖块分开铺，**不让两块砖有相邻的边**，其他砖块可以随意铺，直到整条路铺满。这样一定可以逼死自身强迫症 sea5！\n\n也许下面的剧情你已经猜到了——他为此兴奋不已，以至于无法敲键盘。于是，他请你帮忙计算一下，有多少种方案可以让自己的阴谋得逞。", "inputFormat": "每个测试点包含多组数据，输入文件的第一行是一个正整数 $T$，表示数据的组数。注意各组数据之间是独立无关的。\n\n接下来 $T$ 行，每行包含一个正整数 $N$，代表一组数据中路的长度。", "outputFormat": "输出应包含 $T$ 行，对于每组数据，输出一个正整数，表示满足条件的方案数。\n\n由于答案可能非常的大，你只需要输出答案对 $1000000007 (10^9 + 7)$ 取模后的结果。", "hint": "样例中 $ N=4 $ 解释见下图：\n\n![](https://cdn.luogu.com.cn/upload/pic/56734.png)\n\n### 数据范围\n\n|测试点编号|$N$ 的规模|$T$ 的规模|\n|:-:|:-:|:-:|\n|$1$|$N \\le 10$|$T \\le 10$|\n|$2$|$N \\le 10$|$T \\le 10$|\n|$3$|$N \\le 10^5$|$T \\le 50$|\n|$4$|$N \\le 10^5$|$T \\le 50$|\n|$5$|$N \\le 10^5$|$T \\le 50$|\n|$6$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$7$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$8$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$9$|$N \\le 2 \\times 10^9$|$T \\le 500$|\n|$10$|$N \\le 2 \\times 10^9$|$T \\le 500$|", "locale": "zh-CN"}}}
{"pid": "P5304", "type": "P", "difficulty": 5, "samples": [["2\n6 7 3\n1 5 3\n2 3 5\n1 4 3\n5 3 2\n4 6 5\n4 3 7\n5 6 4\n1 3 6\n7 7 4\n5 3 10\n6 2 7\n1 2 6\n5 4 2\n4 3 4\n1 7 3\n7 2 4\n1 2 5 3", "5\n6\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "各省省选", "最短路", "贵州", "广西", "进制"], "title": "[GXOI/GZOI2019] 旅行者", "background": "", "description": "J 国有 $n$ 座城市，这些城市之间通过 $m$ 条单向道路相连，已知每条道路的长度。\n\n一次，居住在 J 国的 Rainbow 邀请 Vani 来作客。不过，作为一名资深的旅行者，Vani 只对 J 国的 $k$ 座历史悠久、自然风景独特的城市感兴趣。  \n为了提升旅行的体验，Vani 想要知道他感兴趣的城市之间「两两最短路」的最小值（即在他感兴趣的城市中，最近的一对的最短距离）。\n\n也许下面的剧情你已经猜到了—— Vani 这几天还要忙着去其他地方游山玩水，就请你帮他解决这个问题吧。", "inputFormat": "每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。\n\n对于每组数据，第一行包含三个正整数 $n,m,k$，表示 J 国的 $n$ 座城市（从 $1 \\sim n$ 编号），$m$ 条道路，Vani 感兴趣的城市的个数 $k$。\n\n接下来 $m$ 行，每行包括 $3$ 个正整数 $x,y,z$，表示从第 $x$ 号城市到第 $y$ 号城市有一条长度为 $z$ 的单向道路。注意 $x,y$ 可能相等，一对 $x,y$ 也可能重复出现。\n\n接下来一行包括 $k$ 个正整数，表示 Vani 感兴趣的城市的编号。", "outputFormat": "输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示 $k$ 座城市之间两两最短路的最小值。", "hint": "### 样例解释\n对于第一组数据，$1$ 到 $3$ 最短路为 $5$；$1$ 到 $6$ 最短路为 $7$；$3,6$ 无法到达，所以最近的两点为 $1,3$，最近的距离为 $5$。\n\n对于第二组数据，$1$ 到 $2$ 最短路为 $6$；$5$ 到 $3$ 最短路为 $6$；其余的点均无法互相达，所以最近的两点为 $1,2$ 和 $5,3$，最近的距离为 $6$。\n\n### 数据范围\n\n$2 \\le k \\le n$，$1 \\le x,y \\le n$，$1 \\le z \\le 2 \\times 10^9$，$T \\leq 5$。\n\n|测试点编号|$n$ 的规模|$m$ 的规模|约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1,000$|$\\le 5,000$|无|\n|$2$|$\\le 1,000$|$\\le 5,000$|无|\n|$3$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$4$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$5$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$6$|$\\le 100,000$|$\\le 500,000$|无|\n|$7$|$\\le 100,000$|$\\le 500,000$|无|\n|$8$|$\\le 100,000$|$\\le 500,000$|无|\n|$9$|$\\le 100,000$|$\\le 500,000$|无|\n|$10$|$\\le 100,000$|$\\le 500,000$|无|\n\n2024-12-18 管理员注：[在测试点五中可能存在自环](https://www.luogu.com.cn/discuss/1022672)。", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] Traveler", "background": "", "description": "Country J has $n$ cities, connected by $m$ one-way roads. The length of each road is known.\n\nOne day, Rainbow, who lives in Country J, invites Vani to visit. However, as an experienced traveler, Vani is only interested in $k$ cities in Country J that have a long history and unique natural scenery.  \nTo improve the travel experience, Vani wants to know the minimum value among the “pairwise shortest paths” between the cities he is interested in (that is, among all pairs of cities he is interested in, the shortest-path distance of the closest pair).\n\nYou may have already guessed the story — Vani will be busy traveling elsewhere these days, so please help him solve this problem.", "inputFormat": "Each test point contains multiple test cases. The first line is an integer $T$, the number of test cases. Note that the test cases are independent of each other.\n\nFor each test case, the first line contains three positive integers $n, m, k$, representing $n$ cities in Country J (numbered from $1 \\sim n$), $m$ roads, and the number $k$ of cities that Vani is interested in.\n\nThe next $m$ lines each contain $3$ positive integers $x, y, z$, indicating that there is a one-way road from city $x$ to city $y$ with length $z$. Note that $x$ and $y$ may be equal, and the same pair $(x, y)$ may appear multiple times.\n\nThe next line contains $k$ positive integers, the indices of the cities that Vani is interested in.", "outputFormat": "The output should contain $T$ lines. For each test case, output one integer: the minimum value among the pairwise shortest-path distances between the $k$ cities.", "hint": "### Sample Explanation\n\nFor the first test case, the shortest path from $1$ to $3$ is $5$; from $1$ to $6$ is $7$; $3$ and $6$ cannot reach each other. So the closest pair is $1, 3$, and the minimum distance is $5$.\n\nFor the second test case, the shortest path from $1$ to $2$ is $6$; from $5$ to $3$ is $6$; all other pairs of points cannot reach each other. So the closest pairs are $1, 2$ and $5, 3$, and the minimum distance is $6$.\n\n### Constraints\n\n$2 \\le k \\le n$, $1 \\le x, y \\le n$, $1 \\le z \\le 2 \\times 10^9$, $T \\leq 5$.\n\n|Test Point ID|Scale of $n$|Scale of $m$|Notes|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1,000$|$\\le 5,000$|None|\n|$2$|$\\le 1,000$|$\\le 5,000$|None|\n|$3$|$\\le 100,000$|$\\le 500,000$|The graph is guaranteed to be a directed acyclic graph|\n|$4$|$\\le 100,000$|$\\le 500,000$|The graph is guaranteed to be a directed acyclic graph|\n|$5$|$\\le 100,000$|$\\le 500,000$|The graph is guaranteed to be a directed acyclic graph|\n|$6$|$\\le 100,000$|$\\le 500,000$|None|\n|$7$|$\\le 100,000$|$\\le 500,000$|None|\n|$8$|$\\le 100,000$|$\\le 500,000$|None|\n|$9$|$\\le 100,000$|$\\le 500,000$|None|\n|$10$|$\\le 100,000$|$\\le 500,000$|None|\n\nAdmin note on 2024-12-18: [There may be self-loops in test point 5](https://www.luogu.com.cn/discuss/1022672)。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 旅行者", "background": "", "description": "J 国有 $n$ 座城市，这些城市之间通过 $m$ 条单向道路相连，已知每条道路的长度。\n\n一次，居住在 J 国的 Rainbow 邀请 Vani 来作客。不过，作为一名资深的旅行者，Vani 只对 J 国的 $k$ 座历史悠久、自然风景独特的城市感兴趣。  \n为了提升旅行的体验，Vani 想要知道他感兴趣的城市之间「两两最短路」的最小值（即在他感兴趣的城市中，最近的一对的最短距离）。\n\n也许下面的剧情你已经猜到了—— Vani 这几天还要忙着去其他地方游山玩水，就请你帮他解决这个问题吧。", "inputFormat": "每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。\n\n对于每组数据，第一行包含三个正整数 $n,m,k$，表示 J 国的 $n$ 座城市（从 $1 \\sim n$ 编号），$m$ 条道路，Vani 感兴趣的城市的个数 $k$。\n\n接下来 $m$ 行，每行包括 $3$ 个正整数 $x,y,z$，表示从第 $x$ 号城市到第 $y$ 号城市有一条长度为 $z$ 的单向道路。注意 $x,y$ 可能相等，一对 $x,y$ 也可能重复出现。\n\n接下来一行包括 $k$ 个正整数，表示 Vani 感兴趣的城市的编号。", "outputFormat": "输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示 $k$ 座城市之间两两最短路的最小值。", "hint": "### 样例解释\n对于第一组数据，$1$ 到 $3$ 最短路为 $5$；$1$ 到 $6$ 最短路为 $7$；$3,6$ 无法到达，所以最近的两点为 $1,3$，最近的距离为 $5$。\n\n对于第二组数据，$1$ 到 $2$ 最短路为 $6$；$5$ 到 $3$ 最短路为 $6$；其余的点均无法互相达，所以最近的两点为 $1,2$ 和 $5,3$，最近的距离为 $6$。\n\n### 数据范围\n\n$2 \\le k \\le n$，$1 \\le x,y \\le n$，$1 \\le z \\le 2 \\times 10^9$，$T \\leq 5$。\n\n|测试点编号|$n$ 的规模|$m$ 的规模|约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1,000$|$\\le 5,000$|无|\n|$2$|$\\le 1,000$|$\\le 5,000$|无|\n|$3$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$4$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$5$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$6$|$\\le 100,000$|$\\le 500,000$|无|\n|$7$|$\\le 100,000$|$\\le 500,000$|无|\n|$8$|$\\le 100,000$|$\\le 500,000$|无|\n|$9$|$\\le 100,000$|$\\le 500,000$|无|\n|$10$|$\\le 100,000$|$\\le 500,000$|无|\n\n2024-12-18 管理员注：[在测试点五中可能存在自环](https://www.luogu.com.cn/discuss/1022672)。", "locale": "zh-CN"}}}
{"pid": "P5305", "type": "P", "difficulty": 6, "samples": [["5 5 2\n1\n4\n1\n2\n4 3\n5 4\n2 5\n1 2\n3 2", "15\n11\n5\n1\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "线段树", "各省省选", "贵州", "广西", "树链剖分", "动态树 LCT", "分块"], "title": "[GXOI/GZOI2019] 旧词", "background": "", "description": "> 浮生有梦三千场  \n> 穷尽千里诗酒荒  \n> 徒把理想倾倒  \n> 不如早还乡\n>\n> 温一壶风尘的酒  \n> 独饮往事迢迢  \n> 举杯轻思量  \n> 泪如潮青丝留他方\n>\n> ——乌糟兽/愚青《旧词》\n\n你已经解决了五个问题，不妨在这大树之下，吟唱旧词一首抒怀。最后的问题就是关于这棵树的，它的描述很简单。\n\n给定一棵 $n$ 个点的有根树，节点标号 $1 \\sim n$，$1$ 号节点为根。  \n给定常数 $k$。  \n给定 $Q$ 个询问，每次询问给定 $x,y$。  \n求：\n\n$$\\sum\\limits_{i \\le x} \\text{depth}(\\text{lca}(i,y))^k$$\n\n$\\text{lca}(x,y)$ 表示节点 $x$ 与节点 $y$ 在有根树上的最近公共祖先。  \n$\\text{depth}(x)$ 表示节点 $x$ 的深度，根节点的深度为 $1$。  \n由于答案可能很大，你只需要输出答案模 $998244353$ 的结果。\n", "inputFormat": "输入包含 $n+Q$ 行。\n\n第 $1$ 行，三个正整数 $n,Q,k$。\n\n第 $i = 2 \\sim n$ 行，每行有一个正整数 $f_i(1 \\le f_i \\le n)$，表示编号为 $i$ 的节点的父亲节点的编号。\n\n接下来 $Q$ 行，每行两个正整数 $x,y(1 \\le x,y \\le n)$，表示一次询问。", "outputFormat": "输出包含 $Q$ 行，每行一个整数，表示答案模 $998244353$ 的结果。", "hint": "### 样例解释\n\n输入的树：\n\n![poetry.png](https://cdn.luogu.com.cn/upload/pic/56737.png)\n\n每个点的深度分别为 $1,2,3,2,3$。\n\n第一个询问 $x = 4,y = 3$，容易求出：  \n\n$$\\text{lca}(1, 3) = 1,\\text{lca}(2, 3) = 1,\\text{lca}(3, 3) = 3,\\text{lca}(4, 3) = 4$$\n\n于是 $\\text{depth}(1)^2+\\text{depth}(1)^2+\\text{depth}(3)^2+\\text{depth}(4)^2 = 1+1+9+4 = 15$。\n\n### 数据范围\n\n|测试点编号|$n$ 的规模|$Q$ 的规模|$k$ 的规模|约定|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$2$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$3$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$4$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$5$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$6$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$7$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$8$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$9$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|对于第 $i$ 个询问，有 $x = i$|\n|$10$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|对于第 $i$ 个询问，有 $x = i$|\n|$11$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|无|\n|$12$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|无|\n|$13$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|无|\n|$14$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|无|\n|$15$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|无|\n|$16$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|无|\n|$17$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$18$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$19$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$20$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] Old Words", "background": "", "description": "> Life is but three thousand dreamlike scenes.  \n> I have searched a thousand miles, yet poetry and wine are barren.  \n> I only pour out my ideals in vain,  \n> Better to return home early.\n>\n> Warm a pot of dusty-world wine,  \n> Drink alone as the past stretches far away.  \n> Raise the cup and think lightly,  \n> Tears surge like tides, black hair left in a distant land.\n>\n> — Wuzhaoshou / Yuqing, \"Old Words\"\n\nYou have already solved five problems. Now, under this big tree, you may as well sing an old song to express your feelings. The last problem is about this tree, and its description is very simple.\n\nGiven a rooted tree with $n$ nodes, with nodes labeled $1 \\sim n$, and node $1$ as the root.  \nGiven a constant $k$.  \nGiven $Q$ queries, each query provides $x, y$.  \nCompute:\n\n$$\\sum\\limits_{i \\le x} \\text{depth}(\\text{lca}(i,y))^k$$\n\n$\\text{lca}(x,y)$ denotes the lowest common ancestor of nodes $x$ and $y$ in the rooted tree.  \n$\\text{depth}(x)$ denotes the depth of node $x$, where the root has depth $1$.  \nSince the answer may be very large, you only need to output the result modulo $998244353$.", "inputFormat": "The input contains $n+Q$ lines.\n\nLine $1$ contains three positive integers $n, Q, k$.\n\nFor lines $i = 2 \\sim n$, each line contains a positive integer $f_i(1 \\le f_i \\le n)$, which denotes the label of the parent of node $i$.\n\nNext come $Q$ lines, each containing two positive integers $x, y(1 \\le x,y \\le n)$, representing one query.", "outputFormat": "The output contains $Q$ lines, each with one integer, which is the answer modulo $998244353$.", "hint": "### Sample Explanation\n\nThe tree in the input:\n\n![poetry.png](https://cdn.luogu.com.cn/upload/pic/56737.png)\n\nThe depths of the nodes are $1,2,3,2,3$, respectively.\n\nFor the first query $x = 4, y = 3$, it is easy to compute:\n\n$$\\text{lca}(1, 3) = 1,\\text{lca}(2, 3) = 1,\\text{lca}(3, 3) = 3,\\text{lca}(4, 3) = 4$$\n\nSo $\\text{depth}(1)^2+\\text{depth}(1)^2+\\text{depth}(3)^2+\\text{depth}(4)^2 = 1+1+9+4 = 15$.\n\n### Constraints\n\n|Test Point ID|Size of $n$|Size of $Q$|Size of $k$|Note|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|None|\n|$2$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|None|\n|$3$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|None|\n|$4$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|None|\n|$5$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|There exists a node whose depth is $n$|\n|$6$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|There exists a node whose depth is $n$|\n|$7$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|There exists a node whose depth is $n$|\n|$8$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|There exists a node whose depth is $n$|\n|$9$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|For the $i$-th query, $x = i$|\n|$10$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|For the $i$-th query, $x = i$|\n|$11$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|None|\n|$12$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|None|\n|$13$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|None|\n|$14$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|None|\n|$15$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|None|\n|$16$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|None|\n|$17$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|None|\n|$18$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|None|\n|$19$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|None|\n|$20$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|None|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 旧词", "background": "", "description": "> 浮生有梦三千场  \n> 穷尽千里诗酒荒  \n> 徒把理想倾倒  \n> 不如早还乡\n>\n> 温一壶风尘的酒  \n> 独饮往事迢迢  \n> 举杯轻思量  \n> 泪如潮青丝留他方\n>\n> ——乌糟兽/愚青《旧词》\n\n你已经解决了五个问题，不妨在这大树之下，吟唱旧词一首抒怀。最后的问题就是关于这棵树的，它的描述很简单。\n\n给定一棵 $n$ 个点的有根树，节点标号 $1 \\sim n$，$1$ 号节点为根。  \n给定常数 $k$。  \n给定 $Q$ 个询问，每次询问给定 $x,y$。  \n求：\n\n$$\\sum\\limits_{i \\le x} \\text{depth}(\\text{lca}(i,y))^k$$\n\n$\\text{lca}(x,y)$ 表示节点 $x$ 与节点 $y$ 在有根树上的最近公共祖先。  \n$\\text{depth}(x)$ 表示节点 $x$ 的深度，根节点的深度为 $1$。  \n由于答案可能很大，你只需要输出答案模 $998244353$ 的结果。\n", "inputFormat": "输入包含 $n+Q$ 行。\n\n第 $1$ 行，三个正整数 $n,Q,k$。\n\n第 $i = 2 \\sim n$ 行，每行有一个正整数 $f_i(1 \\le f_i \\le n)$，表示编号为 $i$ 的节点的父亲节点的编号。\n\n接下来 $Q$ 行，每行两个正整数 $x,y(1 \\le x,y \\le n)$，表示一次询问。", "outputFormat": "输出包含 $Q$ 行，每行一个整数，表示答案模 $998244353$ 的结果。", "hint": "### 样例解释\n\n输入的树：\n\n![poetry.png](https://cdn.luogu.com.cn/upload/pic/56737.png)\n\n每个点的深度分别为 $1,2,3,2,3$。\n\n第一个询问 $x = 4,y = 3$，容易求出：  \n\n$$\\text{lca}(1, 3) = 1,\\text{lca}(2, 3) = 1,\\text{lca}(3, 3) = 3,\\text{lca}(4, 3) = 4$$\n\n于是 $\\text{depth}(1)^2+\\text{depth}(1)^2+\\text{depth}(3)^2+\\text{depth}(4)^2 = 1+1+9+4 = 15$。\n\n### 数据范围\n\n|测试点编号|$n$ 的规模|$Q$ 的规模|$k$ 的规模|约定|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$2$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$3$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$4$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$5$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$6$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$7$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$8$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$9$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|对于第 $i$ 个询问，有 $x = i$|\n|$10$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|对于第 $i$ 个询问，有 $x = i$|\n|$11$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|无|\n|$12$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|无|\n|$13$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|无|\n|$14$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|无|\n|$15$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|无|\n|$16$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|无|\n|$17$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$18$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$19$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$20$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|", "locale": "zh-CN"}}}
{"pid": "P5306", "type": "P", "difficulty": 6, "samples": [["2\n3 1\n1 2 2", "1"], ["5\n3 1 2 4 5\n1 2 3\n3 2 2\n4 2 6\n5 4 3", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #5] Transport", "background": "", "description": "一个国家有 $n$ 个城市，每个城市中都有一个加油站，燃料储量为 $a_i$。  \n有 $n-1$ 条路径，将这些城市连接成一个树形结构。  \n\n一个货车能从城市 $u$ 到达城市 $v$ ，货车的燃料量必须不小于 $u,v$ 之间的距离。  \n每当货车抵达一个城市，就可以补充不超过加油站储量的燃料。  \n\n假设货车的油箱是无限大的，每行驶一公里需要消耗一单位燃料，请你算出有多少个有序数对 $(u,v)$ 满足：  \n\n一个油箱燃料量初始为 $0$ 的货车，可以从城市 $u$ 出发，抵达城市 $v$，且 $u\\neq v$。\n\n请注意，货车只能走简单路径，也就是说不能走回头路。", "inputFormat": "第一行一个正整数 $n$。  \n第二行有 $n$ 个正整数 $a_i$，表示每个加油站的燃料储量。  \n接下来 $n-1$ 行，每行三个正整数 $u,v,w$，表示城市 $u,v$ 之间有一条长为 $w$ 的路径。", "outputFormat": "一行一个整数表示答案。", "hint": "### 样例1解释：  \n唯一可行的是 $(1,2)$，即只有 $1\\rightarrow 2$ 是可行的。  \n\n### 数据范围：  \n对于 $20\\%$ 的数据：  \n$1\\le n \\le 5000$   \n对于 $40\\%$ 的数据：   \n树是一条链    \n对于 $100\\%$ 的数据：   \n$1\\le n \\le 10^5$      \n$1\\le u,v \\le n$     \n$1\\le w,a_i \\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2018/2019 #5] Transport", "background": "", "description": "A country has $n$ cities. Each city has a gas station with fuel supply $a_i$.  \nThere are $n-1$ roads connecting these cities into a tree structure.\n\nFor a truck to travel from city $u$ to city $v$, the amount of fuel in the truck must be at least the distance between $u$ and $v$.  \nEach time the truck arrives at a city, it can refuel by an amount not exceeding the fuel supply of that city's gas station.\n\nAssume the truck's fuel tank has infinite capacity, and it consumes one unit of fuel for each kilometer traveled. Please calculate how many ordered pairs $(u,v)$ satisfy:\n\nA truck whose initial fuel is $0$ can start from city $u$, reach city $v$, and $u \\neq v$.\n\nNote that the truck can only travel along a simple path, meaning it cannot go back.", "inputFormat": "The first line contains a positive integer $n$.  \nThe second line contains $n$ positive integers $a_i$, representing the fuel supply of each gas station.  \nThe next $n-1$ lines each contain three positive integers $u,v,w$, indicating that there is a road of length $w$ between cities $u$ and $v$.", "outputFormat": "Output one integer in a single line, representing the answer.", "hint": "### Explanation for Sample 1:  \nThe only feasible pair is $(1,2)$, meaning only $1\\rightarrow 2$ is feasible.\n\n### Constraints:  \nFor $20\\%$ of the testdata:  \n$1\\le n \\le 5000$。  \nFor $40\\%$ of the testdata:  \nThe tree is a chain.  \nFor $100\\%$ of the testdata:  \n$1\\le n \\le 10^5$。  \n$1\\le u,v \\le n$。  \n$1\\le w,a_i \\le 10^9$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2018/2019 #5] Transport", "background": "", "description": "一个国家有 $n$ 个城市，每个城市中都有一个加油站，燃料储量为 $a_i$。  \n有 $n-1$ 条路径，将这些城市连接成一个树形结构。  \n\n一个货车能从城市 $u$ 到达城市 $v$ ，货车的燃料量必须不小于 $u,v$ 之间的距离。  \n每当货车抵达一个城市，就可以补充不超过加油站储量的燃料。  \n\n假设货车的油箱是无限大的，每行驶一公里需要消耗一单位燃料，请你算出有多少个有序数对 $(u,v)$ 满足：  \n\n一个油箱燃料量初始为 $0$ 的货车，可以从城市 $u$ 出发，抵达城市 $v$，且 $u\\neq v$。\n\n请注意，货车只能走简单路径，也就是说不能走回头路。", "inputFormat": "第一行一个正整数 $n$。  \n第二行有 $n$ 个正整数 $a_i$，表示每个加油站的燃料储量。  \n接下来 $n-1$ 行，每行三个正整数 $u,v,w$，表示城市 $u,v$ 之间有一条长为 $w$ 的路径。", "outputFormat": "一行一个整数表示答案。", "hint": "### 样例1解释：  \n唯一可行的是 $(1,2)$，即只有 $1\\rightarrow 2$ 是可行的。  \n\n### 数据范围：  \n对于 $20\\%$ 的数据：  \n$1\\le n \\le 5000$   \n对于 $40\\%$ 的数据：   \n树是一条链    \n对于 $100\\%$ 的数据：   \n$1\\le n \\le 10^5$      \n$1\\le u,v \\le n$     \n$1\\le w,a_i \\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P5307", "type": "P", "difficulty": 6, "samples": [["2 3 200\n2 3 4\n5 6 7", "2"], ["3 3 90\n2 1 1\n45 1 1\n1 1 1", "3"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "分块", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #6] Mobitel", "background": "`Nikola`小朋友最近在学乘法口诀。  \n为了记得更牢，他决定做一个游戏进行练习。  ", "description": "他画了一个 $r$ 行 $s$ 列的矩阵，每个格子里都有一个正整数。  \n他想知道，如果从左上角走到右下角，且每次只能向右或向下走到相邻格子，那么使得路径上所有数的乘积不小于 $n$ 的路径有多少条？  \n\n由于答案可能很大，所以请输出答案对 $10^9 + 7$ 取模的结果。", "inputFormat": "第一行三个正整数 $r,s,n$  \n接下来 $r$ 行，每行 $s$ 个正整数，依次表示矩阵每一行的数。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 样例 $1$ 解释：  \n共有 $3$ 条路径，其中有 $2$ 条满足条件：  \n$2 \\rightarrow 3 \\rightarrow 6 \\rightarrow 7$，乘积为$252$  \n$2 \\rightarrow 5 \\rightarrow 6 \\rightarrow 7$，乘积为$420$  \n\n### 数据范围：  \n对于$20\\%$的数据：  \n矩阵中的数不超过$10$  \n对于$50\\%$的数据：  \n$1\\le r,s \\le 100$  \n对于$100\\%$的数据：  \n$1\\le r,s \\le 300$  \n$1\\le n \\le 10^6$  \n矩阵中的数不超过$10^6$", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2018/2019 #6] Mobitel", "background": "The child `Nikola` has recently been learning the multiplication table.  \nTo remember it better, he decided to make a game to practice.", "description": "He drew a matrix with $r$ rows and $s$ columns, and each cell contains a positive integer.  \nHe wants to know: if you walk from the top-left corner to the bottom-right corner, and each step can only go right or down to an adjacent cell, how many paths have the product of all numbers on the path not less than $n$?\n\nSince the answer may be very large, output the result modulo $10^9 + 7$.", "inputFormat": "The first line contains three positive integers $r, s, n$.  \nNext come $r$ lines, each containing $s$ positive integers, representing the numbers in each row of the matrix in order.", "outputFormat": "Output one line with one integer representing the answer.", "hint": "### Sample $1$ Explanation:  \nThere are $3$ paths in total, among which $2$ satisfy the condition:  \n$2 \\rightarrow 3 \\rightarrow 6 \\rightarrow 7$, with product $252$.  \n$2 \\rightarrow 5 \\rightarrow 6 \\rightarrow 7$, with product $420$.\n\n### Constraints:  \nFor $20\\%$ of the testdata:  \nThe numbers in the matrix do not exceed $10$.  \nFor $50\\%$ of the testdata:  \n$1 \\le r, s \\le 100$.  \nFor $100\\%$ of the testdata:  \n$1 \\le r, s \\le 300$.  \n$1 \\le n \\le 10^6$.  \nThe numbers in the matrix do not exceed $10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2018/2019 #6] Mobitel", "background": "`Nikola`小朋友最近在学乘法口诀。  \n为了记得更牢，他决定做一个游戏进行练习。  ", "description": "他画了一个 $r$ 行 $s$ 列的矩阵，每个格子里都有一个正整数。  \n他想知道，如果从左上角走到右下角，且每次只能向右或向下走到相邻格子，那么使得路径上所有数的乘积不小于 $n$ 的路径有多少条？  \n\n由于答案可能很大，所以请输出答案对 $10^9 + 7$ 取模的结果。", "inputFormat": "第一行三个正整数 $r,s,n$  \n接下来 $r$ 行，每行 $s$ 个正整数，依次表示矩阵每一行的数。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 样例 $1$ 解释：  \n共有 $3$ 条路径，其中有 $2$ 条满足条件：  \n$2 \\rightarrow 3 \\rightarrow 6 \\rightarrow 7$，乘积为$252$  \n$2 \\rightarrow 5 \\rightarrow 6 \\rightarrow 7$，乘积为$420$  \n\n### 数据范围：  \n对于$20\\%$的数据：  \n矩阵中的数不超过$10$  \n对于$50\\%$的数据：  \n$1\\le r,s \\le 100$  \n对于$100\\%$的数据：  \n$1\\le r,s \\le 300$  \n$1\\le n \\le 10^6$  \n矩阵中的数不超过$10^6$", "locale": "zh-CN"}}}
{"pid": "P5308", "type": "P", "difficulty": 6, "samples": [["5 3", "2.100000000"], ["10 10", "2.928968254"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "斜率优化", "凸完全单调性（wqs 二分）", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #4] Akvizna", "background": "", "description": "你面临 $n$ 名参赛者的挑战，最终要将他们全部战胜。  \n每一轮中，都会淘汰一些选手；你会得到这一轮奖金池中 被淘汰者 除以 这一轮对手总数 比例的奖金。  \n\n例如某一轮有 $10$ 个对手，淘汰了 $3$ 个，那么你将获得奖金池中 $3/10$ 的奖金。  \n\n假设每一轮的奖金池均为一元，`Mirko` 希望通过恰好 $k$ 轮赢得比赛，那么他最多可能获得多少奖金呢？   \n\n你只需要输出答案保留 $9$ 位小数即可。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "输出一行一个实数表示答案。", "hint": "### 样例1解释：   \n\n最优的情况为：  \n第一轮淘汰 $3$ 人，剩下两轮各淘汰 $1$ 人。  \n获得奖金为 $\\frac{3}{5}+\\frac{1}{2}+\\frac{1}{1}=2.1$ 元。\n\n### 数据范围：   \n\n对于$20\\%$的数据，$1\\le n\\le 100$。\n\n对于$40\\%$的数据，$1\\le n \\le 3000$。\n\n对于$100\\%$的数据，$1\\le k \\le n \\le 10^5$。\n\n本题较卡精度，请留意。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2018/2019 #4] Akvizna", "background": "", "description": "You are facing a challenge from $n$ contestants, and in the end you must defeat all of them.  \nIn each round, some contestants are eliminated. You will receive a share of the prize pool for that round equal to the ratio $\\dfrac{\\text{number eliminated in this round}}{\\text{total number of opponents in this round}}$.\n\nFor example, if there are $10$ opponents in a round and $3$ are eliminated, then you will receive $\\dfrac{3}{10}$ of the prize pool.\n\nAssume the prize pool in every round is 1 unit of money. Mirko wants to win the competition in exactly $k$ rounds. What is the maximum total prize he can get?\n\nYou only need to output the answer rounded to $9$ decimal places.", "inputFormat": "One line with two positive integers $n,k$.", "outputFormat": "Output one line with one real number representing the answer.", "hint": "### Explanation of Sample 1:\n\nThe best situation is:  \nEliminate $3$ people in the first round, and eliminate $1$ person in each of the remaining two rounds.  \nThe total prize is $\\frac{3}{5}+\\frac{1}{2}+\\frac{1}{1}=2.1$.\n\n### Constraints:\n\nFor $20\\%$ of the testdata, $1\\le n\\le 100$.\n\nFor $40\\%$ of the testdata, $1\\le n \\le 3000$.\n\nFor $100\\%$ of the testdata, $1\\le k \\le n \\le 10^5$.\n\nThis problem is quite strict about precision. Please be careful.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2018/2019 #4] Akvizna", "background": "", "description": "你面临 $n$ 名参赛者的挑战，最终要将他们全部战胜。  \n每一轮中，都会淘汰一些选手；你会得到这一轮奖金池中 被淘汰者 除以 这一轮对手总数 比例的奖金。  \n\n例如某一轮有 $10$ 个对手，淘汰了 $3$ 个，那么你将获得奖金池中 $3/10$ 的奖金。  \n\n假设每一轮的奖金池均为一元，`Mirko` 希望通过恰好 $k$ 轮赢得比赛，那么他最多可能获得多少奖金呢？   \n\n你只需要输出答案保留 $9$ 位小数即可。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "输出一行一个实数表示答案。", "hint": "### 样例1解释：   \n\n最优的情况为：  \n第一轮淘汰 $3$ 人，剩下两轮各淘汰 $1$ 人。  \n获得奖金为 $\\frac{3}{5}+\\frac{1}{2}+\\frac{1}{1}=2.1$ 元。\n\n### 数据范围：   \n\n对于$20\\%$的数据，$1\\le n\\le 100$。\n\n对于$40\\%$的数据，$1\\le n \\le 3000$。\n\n对于$100\\%$的数据，$1\\le k \\le n \\le 10^5$。\n\n本题较卡精度，请留意。", "locale": "zh-CN"}}}
{"pid": "P5309", "type": "P", "difficulty": 6, "samples": [["5 6\n1 2 3 4 5\n2 2 4\n1 1 1 1\n2 2 4\n2 1 3\n1 2 1 2\n2 1 3\n", "9\n12\n9\n13\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "O2优化", "分块", "Ynoi", "根号分治"], "title": "[Ynoi2011] 初始化", "background": "我呢…是什么时候开始存在于此的呢？\n\n从何时开始…我成为了我呢？\n\n仔细想想，我从出生开始似乎也没有什么记忆？\n\n这么说明天的“我”和今天的“我”是同一个存在吗？\n\n或者说…如何定义“我”这个存在呢？\n\n“我”这个存在真的存在吗？\n\n如果存在的话…意义又是什么呢？\n\n等等…如何定义“意义”呢？\n\n意义…意义…意义…意义…意义…意义…意义…意义…\n\n…………………………………………\n\n他当然想不通这些问题\n\n于是自然而然地去问大人，就像一个小孩子应该做的一样\n\n“爸爸，活着的意义是什么啊？”\n\n“等你长大了就知道了，现在先好好学习吧”\n\n“妈妈，活着的意义是什么啊？”\n\n“小孩子想这些事干啥呢，先把成绩搞好再说”\n\n“老师，活着的意义是什么啊？”\n\n“好好学习，把成绩搞好，考上好大学，找个好工作，然后赚大钱”\n\n原来如此啊，原来这就是意义呢\n\n虽然这是意义，但是感觉真是无趣呢，真是可悲呢\n\n但是，这是意义啊，不管多么的无趣，多么的可悲，既然是意义，那一定要努力\n实现呢，因为这毕竟是意义啊~！\n\n于是他开始好好学习了，由于天资还不错，所以考上了好的初中，进入了最好的\n班级，似乎未来一片光明呢\n\n实际上，他当时也确实是这么想的呢（笑\n\n【记得配图，内容待定】\n\n由于这是Ynoi，不是出题人拿来写傻逼的文字的地方，所以你需要做一个数据结构题：\n", "description": "Mayuri 有 $n$ 颗星星，每颗星星都有一个明亮度 $A_{i}$ 。Mayuri 时常想知道一个区间 $[l,r]$ 内所有星星的明亮度的总和是多少。但是星星是会眨眼的，所以星星的明亮度是会变化的。有的时候，下标为 $y,y+x,y+2x,y+3x,\\ldots,y+kx$ 的星星的明亮度会增加 $z$。保证 $y\\leq x$。\n\n\nMayuri 不怎么会数学，请回答她的询问。答案要对 $10^{9}+7$ 取模。\n", "inputFormat": "第一行两个整数 $n$ 和 $m$，分别表示星星的数量和操作的数量。\n\n\n接下来一行 $n$ 个数字 $A_{i}$，表示初始的明亮度。\n\n\n接下来 $m$ 行，每行先是一个整数表示操作类型，如果为 $1$ 则是修改操作，接下来 $3$ 个整数 $x,y,z$；如果是 $2$ 则为询问操作，接下来两个整数 $l,r$。\n", "outputFormat": "对于每个询问操作，输出一行表示答案。\n", "hint": "Idea：yanQval，Solution：yanQval，Code：yanQval，Data：yanQval&nzhtl1477\n\n对于 $10\\%$ 的数据，满足 $n,m\\leq 1000$。\n\n对于另外 $10\\%$ 的数据，满足 $x>1000$。\n\n对于另外 $10\\%$ 的数据，满足 $x>300$。\n\n对于另外 $10\\%$ 的数据，满足 $n,m \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 2\\times 10^5$，$1\\leq y\\leq x\\leq n$，$1\\leq l\\leq r\\leq n$，$0\\leq A_i,z \\leq 10^{9}+7$。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] Initialization", "background": "As for me... when did I begin to exist here?\n\nSince when... did I become me?\n\nCome to think of it, I don't seem to have any memory from birth?\n\nSo does that mean the “me” of tomorrow and the “me” of today are the same being?\n\nOr rather... how do we define this “self”?\n\nDoes this “self” really exist?\n\nIf it does... then what is its meaning?\n\nWait... how do we define “meaning”?\n\nMeaning... meaning... meaning... meaning... meaning... meaning... meaning... meaning...\n\n...\n\nHe, of course, couldn't figure any of this out.\n\nSo, naturally, he went to ask the adults, just like a child should.\n\n“Dad, what is the meaning of living?”\n\n“You’ll understand when you grow up. For now, just study hard.”\n\n“Mom, what is the meaning of living?”\n\n“Why is a child thinking about this? Focus on getting good grades first.”\n\n“Teacher, what is the meaning of living?”\n\n“Study hard, get good grades, get into a good university, find a good job, and then make lots of money.”\n\nI see—that's the meaning.\n\nEven if that's the meaning, it feels so dull, so sad.\n\nBut since that is the meaning, no matter how dull or sad it is, it must be pursued, because after all, it's the meaning~!\n\nSo he began to study hard. With decent talent, he got into a good middle school and the best class. The future seemed bright.\n\nIn fact, that's exactly what he thought then (laughs).\n\n[Remember to add an illustration, content TBD].\n\nSince this is Ynoi and not a place for the setter to write nonsense, you need to solve a data structure problem:", "description": "Mayuri has $n$ stars, each with a brightness $A_{i}$. Mayuri often wants to know the sum of the brightnesses of all stars in an interval $[l, r]$. But stars twinkle, so their brightness can change. At times, the brightness of stars with indices $y, y+x, y+2x, y+3x, \\ldots, y+kx$ increases by $z$. It is guaranteed that $y \\leq x$.\n\nMayuri is not very good at math; please answer her queries. The answer should be taken modulo $10^{9}+7$.", "inputFormat": "The first line contains two integers $n$ and $m$, the number of stars and the number of operations.\n\nThe next line contains $n$ numbers $A_{i}$, the initial brightness values.\n\nThen follow $m$ lines. Each line starts with an integer denoting the operation type: if it is $1$, it is an update, followed by three integers $x, y, z$; if it is $2$, it is a query, followed by two integers $l, r$.", "outputFormat": "For each query operation, output one line with the answer.", "hint": "Idea: yanQval, Solution: yanQval, Code: yanQval, Data: yanQval & nzhtl1477.\n\nConstraints:\n- For $10\\%$ of the testdata, $n, m \\leq 1000$.\n- For another $10\\%$ of the testdata, $x>1000$.\n- For another $10\\%$ of the testdata, $x>300$.\n- For another $10\\%$ of the testdata, $n, m \\leq 10^5$.\n- For $100\\%$ of the testdata, $1 \\leq n, m \\leq 2 \\times 10^5$, $1 \\leq y \\leq x \\leq n$, $1 \\leq l \\leq r \\leq n$, $0 \\leq A_i, z \\leq 10^{9}+7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] 初始化", "background": "我呢…是什么时候开始存在于此的呢？\n\n从何时开始…我成为了我呢？\n\n仔细想想，我从出生开始似乎也没有什么记忆？\n\n这么说明天的“我”和今天的“我”是同一个存在吗？\n\n或者说…如何定义“我”这个存在呢？\n\n“我”这个存在真的存在吗？\n\n如果存在的话…意义又是什么呢？\n\n等等…如何定义“意义”呢？\n\n意义…意义…意义…意义…意义…意义…意义…意义…\n\n…………………………………………\n\n他当然想不通这些问题\n\n于是自然而然地去问大人，就像一个小孩子应该做的一样\n\n“爸爸，活着的意义是什么啊？”\n\n“等你长大了就知道了，现在先好好学习吧”\n\n“妈妈，活着的意义是什么啊？”\n\n“小孩子想这些事干啥呢，先把成绩搞好再说”\n\n“老师，活着的意义是什么啊？”\n\n“好好学习，把成绩搞好，考上好大学，找个好工作，然后赚大钱”\n\n原来如此啊，原来这就是意义呢\n\n虽然这是意义，但是感觉真是无趣呢，真是可悲呢\n\n但是，这是意义啊，不管多么的无趣，多么的可悲，既然是意义，那一定要努力\n实现呢，因为这毕竟是意义啊~！\n\n于是他开始好好学习了，由于天资还不错，所以考上了好的初中，进入了最好的\n班级，似乎未来一片光明呢\n\n实际上，他当时也确实是这么想的呢（笑\n\n【记得配图，内容待定】\n\n由于这是Ynoi，不是出题人拿来写傻逼的文字的地方，所以你需要做一个数据结构题：\n", "description": "Mayuri 有 $n$ 颗星星，每颗星星都有一个明亮度 $A_{i}$ 。Mayuri 时常想知道一个区间 $[l,r]$ 内所有星星的明亮度的总和是多少。但是星星是会眨眼的，所以星星的明亮度是会变化的。有的时候，下标为 $y,y+x,y+2x,y+3x,\\ldots,y+kx$ 的星星的明亮度会增加 $z$。保证 $y\\leq x$。\n\n\nMayuri 不怎么会数学，请回答她的询问。答案要对 $10^{9}+7$ 取模。\n", "inputFormat": "第一行两个整数 $n$ 和 $m$，分别表示星星的数量和操作的数量。\n\n\n接下来一行 $n$ 个数字 $A_{i}$，表示初始的明亮度。\n\n\n接下来 $m$ 行，每行先是一个整数表示操作类型，如果为 $1$ 则是修改操作，接下来 $3$ 个整数 $x,y,z$；如果是 $2$ 则为询问操作，接下来两个整数 $l,r$。\n", "outputFormat": "对于每个询问操作，输出一行表示答案。\n", "hint": "Idea：yanQval，Solution：yanQval，Code：yanQval，Data：yanQval&nzhtl1477\n\n对于 $10\\%$ 的数据，满足 $n,m\\leq 1000$。\n\n对于另外 $10\\%$ 的数据，满足 $x>1000$。\n\n对于另外 $10\\%$ 的数据，满足 $x>300$。\n\n对于另外 $10\\%$ 的数据，满足 $n,m \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 2\\times 10^5$，$1\\leq y\\leq x\\leq n$，$1\\leq l\\leq r\\leq n$，$0\\leq A_i,z \\leq 10^{9}+7$。\n\n", "locale": "zh-CN"}}}
{"pid": "P5310", "type": "P", "difficulty": 6, "samples": [["5 3 2\n11 7 5 3 2\n3 2 1\n2 5\n1 6\n", "0\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2011", "平衡树", "O2优化", "哈希 hashing", "洛谷月赛", "Ynoi"], "title": "[Ynoi2011] 遥远的过去", "background": "小学六年级的时候学了JAVA，写了个小游戏，大概是把我奥数老师的头弹飞出去拿来打青蛙的，看来我小时候就懂膜蛤和P头了。\n\n现在感觉当时很多东西没理解，都在乱写，程序里面全是if，就这样还是写出来了，还拿了个科创大赛一等奖（可以加5分中考分的，可不算很野鸡！）\n\n所以一直感觉我其实是很喜欢做一些有创造性的东西的，这点之后也会体现出来。\n\n上了初中，因为之前学过点小学奥数，同时也有学一些数学竞赛的东西，所以感觉老师讲课都很平凡，没什么兴趣。\n\n第一次接触到了信息学竞赛，当时感觉还是挺有趣的，不过也没怎么认真学。\n\n学校里面有OI的培训，但由于学校里面在教Pascal，我当时已经学过JAVA了，自然觉得这个语言很落后，垃圾，所以也没怎么听课，印象中我去参加个选拔考试，有个鸡兔同笼的题，我写了个解方程被扣分了，老师给的正解是 while( a-- ) b++ 这样的东西，然后就决定不去了。\n\n初二考了一次NOIP普及组，当时只拿了120，第二题是个表达式求值，我写了很久很久都一直挂，然后就凉凉了。\n\n考完之后得知班上几个同学考了全省前10，感觉他们好强，当时还是很有好胜心的，于是决定好好学OI，初三打爆他们。\n\n初三的时候考了295，被两个当时初二的小朋友打爆了，不过我是初三里面最高分（\n\n那两个小朋友好像现在都去茶园了，果然是神仙。\n\n感觉初中还是挺好玩的，虽然天天和毒瘤老师斗智斗勇，但还是很有趣。\n\n【记得配图，内容：写的小游戏的截图，还有noip的成绩】\n\n由于这是Ynoi，不是出题人拿来写奇怪的文字的地方，所以你需要做一个数据结构题：", "description": "小 F 决定设计出一种字符集超大的语言——Z 语言，哪怕有时额外的字符并没有什么用。\n\n这种语言的特点是：\n\n* 字符集非常大，甚至可能有 $2147483648(2 ^ {31})$ 种字符；\n\n* 每个单词由一系列**两两不同**的字符组成；\n\n* 字符既能比较相同和不同，也能比较大小，因此之后我们用数字来表示 Z 语言中稀奇古怪的字符；\n\n* 两个看起来完全不同的单词也可能是同一个单词，因为：只要两个单词中第 K 大的字符所在的位置相同，那么其实就是本质上相同的单词。例如 $\\{1, 2, 3, 4, 5\\}$ 与 $\\{2, 3, 23, 233, 23333\\}$ 是相同的。（所以你可以用 Z 语言很方便地加密信息！）\n\n现在，小 F 打算将 Z 语言应用到实际中。比如，他点开了一道电脑里的算法题：\n\n> 给定两个字符串 $A, B$ ，求 $B$ 作为子串在 $A$ 中被匹配的次数。\n\n 小 F 当然知道这是一个可以用 KMP 解决的基础题。但是，他在用 Z 语言的匹配实现 Z-KMP 的时候遇到了问题，你能帮帮他吗？\n\n为了验证你是不是真的明白小 F 在说什么，小 F 会修改 $B$ 串很多次来问你。可不准偷懒哦！\n\n你的程序需要支持的操作详见输入输出格式。", "inputFormat": "输入第一行两个整数 $n, m, q(1 \\leq n, m, q \\leq 10 ^ 5)$，表示 $A, B$ 串的长度以及操作次数。\n\n第二行 $n$ 个非负整数，第 $i$ 个表示 $A$ 串的第 $i$ 个字符 $A_i$ $(0 \\leq A_i \\leq 2147483647=2 ^ {31} - 1)$。\n\n第三行 $m$ 个非负整数，第 $i$ 个表示 $B$ 串的第 $i$ 个字符 $B_i$ $(0 \\leq B_i \\leq 2147483647=2 ^ {31} - 1)$。 \n\n接下来 $q$ 行，每行两个正整数 $x_i, c_i$ $(1 \\leq c_i \\leq 2147483647=2 ^ {31} - 1)$，表示将 $B$ 串 $x_i$ 位置上的字符由 $B_{x_i}$ 改为 $c_i$。\n\n数据保证，任意时刻 $A$ 和 $B$ 均是满足前述要求的合法 Z 字符串。", "outputFormat": "**在每次修改完成后**，请输出 $B$ 作为子串在 $A$ 中被 Z-匹配 的次数。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477( partially uploaded )\n\n### 样例 1 解释\n\n在第一次修改后，$\\{3, 5, 1\\}$ 并不能被任何一个 $A$ 中的子串匹配上。\n\n在第二次修改后，$\\{6, 5, 1\\}$ 能被 $A$ 中所有长度为 $3$ 的串匹配上，原因是 A 是单调减的，而 B 也是单调减的，因此 $A$ 中所有长度为 $3$ 的串与 $B$ 排名相同的处于相同位置。\n\n### 子任务\n\n子任务 $1(31 \\mathrm{pts}) : n, m \\leq 100, q \\leq 1000$；\n\n子任务 $2(41 \\mathrm{pts}) : n, m \\leq 1000, q \\leq 5 \\times 10 ^ 4$；\n\n子任务 $3(78 \\mathrm{pts}) : n, m, q \\leq 10 ^ 5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] A Distant Past", "background": "When I was in the 6th grade, I learned Java and wrote a small game. It basically flung my math olympiad teacher’s head to hit frogs. Looks like I already understood mouha and P-head back then.\n\nNow I feel I didn’t understand a lot at the time and was just writing randomly. The program was full of if’s, yet I still finished it and even won a first prize in a science and innovation contest (it could add 5 points to the high school entrance exam, definitely not shady!).\n\nSo I’ve always felt I actually like doing creative things. This will show up later too.\n\nIn middle school, because I had learned some elementary olympiad math and also some math contest stuff, I felt the classes were plain and wasn’t very interested.\n\nI first encountered the informatics olympiad. It felt quite interesting, but I didn’t study it seriously.\n\nOur school had OI training, but they taught Pascal. Since I had already learned Java, I naturally thought that language was outdated and trash, so I didn’t really listen. I remember I took a selection test and there was a “chicken and rabbit in the same cage” problem. I wrote a solution using equations and got points deducted. The teacher’s official solution was something like while( a-- ) b++. Then I decided not to go anymore.\n\nIn the 8th grade I took the NOIP Junior group and only got 120. The second problem was expression evaluation. I spent a long time on it and kept failing, then that was it.\n\nAfter the exam I learned that several classmates were top 10 in the province. They seemed really strong. I was still very competitive back then, so I decided to study OI well and crush them in 9th grade.\n\nIn 9th grade I got 295 and got crushed by two 8th graders at the time, but I was the highest in 9th grade.\n\nThose two kids seem to have gone to Cha Yuan now. Truly legends.\n\nMiddle school felt quite fun. Although I had to play mind games with a toxic teacher every day, it was still interesting.\n\n[Remember to add images. Content: a screenshot of the small game, and the NOIP score.]\n\nSince this is Ynoi, not a place for the problem setter to write strange essays, you now need to do a data structure problem:", "description": "Little F decides to design a language with a huge character set — the Z language — even if extra characters are sometimes useless.\n\nFeatures of this language:\n- The character set is extremely large, possibly with $2147483648\\ (2^{31})$ distinct characters.\n- Each word is made of a sequence of pairwise distinct characters.\n- Characters can be compared for equality and order, so we will use numbers to represent the strange characters in the Z language.\n- Two words that look completely different can still be the same word because: as long as the positions of the $K$-th largest characters are the same in both words for every $K$, then they are essentially the same word. For example, $\\{1, 2, 3, 4, 5\\}$ and $\\{2, 3, 23, 233, 23333\\}$ are the same. (So you can conveniently use the Z language to encrypt information!)\n\nNow, Little F plans to apply the Z language to a real task. For example, he opens an algorithm problem on a computer:\n\n> Given two strings $A$ and $B$, find how many times $B$ is matched as a substring in $A$.\n\nLittle F knows this is a basic problem solvable with KMP. However, when implementing Z-KMP for matching in the Z language, he ran into trouble. Can you help him?\n\nTo verify you really understand what Little F means, he will modify string $B$ many times and ask you. No slacking!\n\nSee the input and output formats for the operations your program must support.", "inputFormat": "The first line contains two integers $n, m, q$ ($1 \\leq n, m, q \\leq 10^5$), the lengths of strings $A$ and $B$, and the number of operations.\n\nThe second line contains $n$ non-negative integers. The $i$-th is the $i$-th character $A_i$ of string $A$ ($0 \\leq A_i \\leq 2147483647 = 2^{31}-1$).\n\nThe third line contains $m$ non-negative integers. The $i$-th is the $i$-th character $B_i$ of string $B$ ($0 \\leq B_i \\leq 2147483647 = 2^{31}-1$).\n\nThen follow $q$ lines. Each line contains two positive integers $x_i, c_i$ ($1 \\leq c_i \\leq 2147483647 = 2^{31}-1$), meaning the character at position $x_i$ in $B$ is changed from $B_{x_i}$ to $c_i$.\n\nThe testdata guarantees that at any time, both $A$ and $B$ are valid Z strings that satisfy the above requirements.", "outputFormat": "After each modification, output the number of times $B$ is Z-matched as a substring in $A$.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477 (partially uploaded).\n\nSample 1 Explanation:\n- After the first modification, $\\{3, 5, 1\\}$ cannot be matched by any substring of $A$.\n- After the second modification, $\\{6, 5, 1\\}$ can be matched by every length-$3$ substring of $A$, because $A$ is strictly decreasing and $B$ is also strictly decreasing, so positions of characters with the same ranks coincide.\n\nSubtasks:\n- Subtask $1$ (31 pts): $n, m \\leq 100$, $q \\leq 1000$.\n- Subtask $2$ (41 pts): $n, m \\leq 1000$, $q \\leq 5 \\times 10^4$.\n- Subtask $3$ (78 pts): $n, m, q \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] 遥远的过去", "background": "小学六年级的时候学了JAVA，写了个小游戏，大概是把我奥数老师的头弹飞出去拿来打青蛙的，看来我小时候就懂膜蛤和P头了。\n\n现在感觉当时很多东西没理解，都在乱写，程序里面全是if，就这样还是写出来了，还拿了个科创大赛一等奖（可以加5分中考分的，可不算很野鸡！）\n\n所以一直感觉我其实是很喜欢做一些有创造性的东西的，这点之后也会体现出来。\n\n上了初中，因为之前学过点小学奥数，同时也有学一些数学竞赛的东西，所以感觉老师讲课都很平凡，没什么兴趣。\n\n第一次接触到了信息学竞赛，当时感觉还是挺有趣的，不过也没怎么认真学。\n\n学校里面有OI的培训，但由于学校里面在教Pascal，我当时已经学过JAVA了，自然觉得这个语言很落后，垃圾，所以也没怎么听课，印象中我去参加个选拔考试，有个鸡兔同笼的题，我写了个解方程被扣分了，老师给的正解是 while( a-- ) b++ 这样的东西，然后就决定不去了。\n\n初二考了一次NOIP普及组，当时只拿了120，第二题是个表达式求值，我写了很久很久都一直挂，然后就凉凉了。\n\n考完之后得知班上几个同学考了全省前10，感觉他们好强，当时还是很有好胜心的，于是决定好好学OI，初三打爆他们。\n\n初三的时候考了295，被两个当时初二的小朋友打爆了，不过我是初三里面最高分（\n\n那两个小朋友好像现在都去茶园了，果然是神仙。\n\n感觉初中还是挺好玩的，虽然天天和毒瘤老师斗智斗勇，但还是很有趣。\n\n【记得配图，内容：写的小游戏的截图，还有noip的成绩】\n\n由于这是Ynoi，不是出题人拿来写奇怪的文字的地方，所以你需要做一个数据结构题：", "description": "小 F 决定设计出一种字符集超大的语言——Z 语言，哪怕有时额外的字符并没有什么用。\n\n这种语言的特点是：\n\n* 字符集非常大，甚至可能有 $2147483648(2 ^ {31})$ 种字符；\n\n* 每个单词由一系列**两两不同**的字符组成；\n\n* 字符既能比较相同和不同，也能比较大小，因此之后我们用数字来表示 Z 语言中稀奇古怪的字符；\n\n* 两个看起来完全不同的单词也可能是同一个单词，因为：只要两个单词中第 K 大的字符所在的位置相同，那么其实就是本质上相同的单词。例如 $\\{1, 2, 3, 4, 5\\}$ 与 $\\{2, 3, 23, 233, 23333\\}$ 是相同的。（所以你可以用 Z 语言很方便地加密信息！）\n\n现在，小 F 打算将 Z 语言应用到实际中。比如，他点开了一道电脑里的算法题：\n\n> 给定两个字符串 $A, B$ ，求 $B$ 作为子串在 $A$ 中被匹配的次数。\n\n 小 F 当然知道这是一个可以用 KMP 解决的基础题。但是，他在用 Z 语言的匹配实现 Z-KMP 的时候遇到了问题，你能帮帮他吗？\n\n为了验证你是不是真的明白小 F 在说什么，小 F 会修改 $B$ 串很多次来问你。可不准偷懒哦！\n\n你的程序需要支持的操作详见输入输出格式。", "inputFormat": "输入第一行两个整数 $n, m, q(1 \\leq n, m, q \\leq 10 ^ 5)$，表示 $A, B$ 串的长度以及操作次数。\n\n第二行 $n$ 个非负整数，第 $i$ 个表示 $A$ 串的第 $i$ 个字符 $A_i$ $(0 \\leq A_i \\leq 2147483647=2 ^ {31} - 1)$。\n\n第三行 $m$ 个非负整数，第 $i$ 个表示 $B$ 串的第 $i$ 个字符 $B_i$ $(0 \\leq B_i \\leq 2147483647=2 ^ {31} - 1)$。 \n\n接下来 $q$ 行，每行两个正整数 $x_i, c_i$ $(1 \\leq c_i \\leq 2147483647=2 ^ {31} - 1)$，表示将 $B$ 串 $x_i$ 位置上的字符由 $B_{x_i}$ 改为 $c_i$。\n\n数据保证，任意时刻 $A$ 和 $B$ 均是满足前述要求的合法 Z 字符串。", "outputFormat": "**在每次修改完成后**，请输出 $B$ 作为子串在 $A$ 中被 Z-匹配 的次数。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477( partially uploaded )\n\n### 样例 1 解释\n\n在第一次修改后，$\\{3, 5, 1\\}$ 并不能被任何一个 $A$ 中的子串匹配上。\n\n在第二次修改后，$\\{6, 5, 1\\}$ 能被 $A$ 中所有长度为 $3$ 的串匹配上，原因是 A 是单调减的，而 B 也是单调减的，因此 $A$ 中所有长度为 $3$ 的串与 $B$ 排名相同的处于相同位置。\n\n### 子任务\n\n子任务 $1(31 \\mathrm{pts}) : n, m \\leq 100, q \\leq 1000$；\n\n子任务 $2(41 \\mathrm{pts}) : n, m \\leq 1000, q \\leq 5 \\times 10 ^ 4$；\n\n子任务 $3(78 \\mathrm{pts}) : n, m, q \\leq 10 ^ 5$。\n", "locale": "zh-CN"}}}
{"pid": "P5311", "type": "P", "difficulty": 7, "samples": [["5 4\n1 3 5 3 5\n1 2\n2 3\n3 4\n4 5\n1 5 1\n2 4 3\n3 4 3\n1 4 3", "3\n2\n2\n3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2011", "O2优化", "Ynoi"], "title": "[Ynoi2011] 成都七中", "background": "上初中的时候就听说成都七中非常厉害，我当时文化课成绩还不错，于是也想去成都七中。\n\n当时对高中的看法是什么样的我现在也无从得知了，但从模糊的感觉上大概是很憧憬的。\n\n我初三的时候想办法联系到了cdqz的竞赛教练林老师，然后获得了周末来旁听OI讲课的许可。\n\n还记得讲课的学长是集训队的于神，一开始就在给我们讲数据结构。cdqz明亮宽敞（当时的印象）的机房，和从未见过的beamer排版给我留下了深刻的印象。\n\n第一节课是树状数组，完全没听懂，现在感觉这个东西其实不适合一开始就讲，因为结构理解起来挺麻烦的，也不像线段树那样有一个非常直观的分治结构，而且代码经过特化非常精简，很容易谔谔。\n\n第二节课是线段树，这个听懂了一部分，感觉好神奇，但是讲到标记的部分我就无法理解了，讲完课写题，写了一个很长很丑的线段树，调了很久很久，半懂不懂地把题过了。\n\n当时在做vijos上面的题，看到小白逛公园的感觉就像是AMX-1357看到鼠爷一样。\n\n每天都有考试，考试的时候基本上啥都不会，只能写写暴力分骗分，每次评测的时候都看到学长们过了好多题，当时感觉非常羡慕。\n\n和我一起去cdqz听课的有一位zms，他初二拿了普及组省第一，初三考提高组差点拿了一等奖，我一直以他为竞争对手，每次考试的时候都在和他比划比划成绩，但基本上都是我输。\n\n【记得配图，内容：当时考试的成绩（大概找不到了），当时的PPT（大概找不到了），成都七中校门（这个有）】\n\n由于这是Ynoi，不是出题人拿来写无趣的文字的地方，所以你需要做一个数据结构题：", "description": "给你一棵 $n$ 个节点的树，每个节点有一种颜色，有 $m$ 次查询操作。\n\n查询操作给定参数 $l\\ r\\ x$，需输出：\n\n将树中编号在 $[l,r]$ 内的所有节点保留，$x$ 所在连通块中颜色种类数。\n\n每次查询操作独立。", "inputFormat": "第一行两个数 $n,m$。\n\n第二行 $n$ 个数表示每个节点的颜色。\n\n之后 $n-1$ 行，每行两个数 $x$ 和 $y$，表示 $x$ 和 $y$ 之间连有一条边。\n\n之后 $m$ 行，每行三个数 $l\\ r\\ x$，表示一次查询操作。", "outputFormat": "对每个查询操作，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：created_equal1，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，所有出现过的数在 $[1,10^5]$ 之间，保证每次输入的 $l \\le x \\le r$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] Chengdu No. 7 High School", "background": "When I was in middle school, I had heard that Chengdu No. 7 High School was very strong. My grades in regular classes were pretty good at that time, so I also wanted to go there.\n\nI do not really remember what I thought about high school back then, but from my vague impressions, I guess I really looked forward to it.\n\nIn my 9th grade, I found a way to contact Teacher Lin, the contest coach at cdqz, and got permission to sit in on OI lectures on weekends.\n\nI still remember the senior student who taught us was “Yu Shen” from the CTT. He started by teaching us data structures. The bright and spacious (as I remembered) computer room at cdqz, and the beamer style that I had never seen before, left a deep impression on me.\n\nThe first lesson was about the Binary Indexed Tree. I did not understand it at all. Now I feel that it is not suitable as the first topic, because the structure is quite hard to understand. It is also not like a segment tree with a very intuitive divide-and-conquer structure, and the code is highly specialized and very short, which makes it easy to get confused.\n\nThe second lesson was about the segment tree. I understood part of it and felt it was amazing, but when it got to the “lazy tag” part, I could not understand it anymore. After the lecture we did problems; I wrote a very long and ugly segment tree, debugged for a very long time, and somehow passed the problem while only half understanding it.\n\nAt that time I was doing problems on vijos. The feeling of seeing “Xiaobai Strolling in the Park” was like AMX-1357 seeing “Mouse Lord”.\n\nThere were exams every day. During exams I basically knew nothing, so I could only write brute force to get partial points. Every time during judging I saw the seniors solve many problems, and I felt very envious.\n\nOne person who went to cdqz with me was zms. He got 1st place in the province in the Junior group in 8th grade, and in 9th grade he almost got 1st prize in the Senior group. I always treated him as my competitor. In every exam I compared my score with his, but basically I always lost.\n\n[Remember to add pictures: the exam scores at that time (probably cannot find them), the PPT at that time (probably cannot find it), the school gate of Chengdu No. 7 High School (this one exists).]\n\nSince this is Ynoi, not a place for the problem setter to write boring text, you need to solve a data structure problem.", "description": "You are given a tree with $n$ nodes. Each node has a color. There are $m$ queries.\n\nEach query gives parameters $l\\ r\\ x$. You need to output:\n\nKeep all nodes whose indices are in $[l,r]$ in the tree. In the connected component that contains $x$, output the number of distinct colors.\n\nEach query is independent.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers representing the color of each node.\n\nThen follow $n-1$ lines. Each line contains two integers $x$ and $y$, indicating there is an edge between $x$ and $y$.\n\nThen follow $m$ lines. Each line contains three integers $l\\ r\\ x$, representing one query.", "outputFormat": "For each query, output one line with one integer, the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: created_equal1, Data: nzhtl1477.\n\nConstraints: For $100\\%$ of the testdata, all numbers that appear are in $[1,10^5]$, and it is guaranteed that for each query $l \\le x \\le r$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] 成都七中", "background": "上初中的时候就听说成都七中非常厉害，我当时文化课成绩还不错，于是也想去成都七中。\n\n当时对高中的看法是什么样的我现在也无从得知了，但从模糊的感觉上大概是很憧憬的。\n\n我初三的时候想办法联系到了cdqz的竞赛教练林老师，然后获得了周末来旁听OI讲课的许可。\n\n还记得讲课的学长是集训队的于神，一开始就在给我们讲数据结构。cdqz明亮宽敞（当时的印象）的机房，和从未见过的beamer排版给我留下了深刻的印象。\n\n第一节课是树状数组，完全没听懂，现在感觉这个东西其实不适合一开始就讲，因为结构理解起来挺麻烦的，也不像线段树那样有一个非常直观的分治结构，而且代码经过特化非常精简，很容易谔谔。\n\n第二节课是线段树，这个听懂了一部分，感觉好神奇，但是讲到标记的部分我就无法理解了，讲完课写题，写了一个很长很丑的线段树，调了很久很久，半懂不懂地把题过了。\n\n当时在做vijos上面的题，看到小白逛公园的感觉就像是AMX-1357看到鼠爷一样。\n\n每天都有考试，考试的时候基本上啥都不会，只能写写暴力分骗分，每次评测的时候都看到学长们过了好多题，当时感觉非常羡慕。\n\n和我一起去cdqz听课的有一位zms，他初二拿了普及组省第一，初三考提高组差点拿了一等奖，我一直以他为竞争对手，每次考试的时候都在和他比划比划成绩，但基本上都是我输。\n\n【记得配图，内容：当时考试的成绩（大概找不到了），当时的PPT（大概找不到了），成都七中校门（这个有）】\n\n由于这是Ynoi，不是出题人拿来写无趣的文字的地方，所以你需要做一个数据结构题：", "description": "给你一棵 $n$ 个节点的树，每个节点有一种颜色，有 $m$ 次查询操作。\n\n查询操作给定参数 $l\\ r\\ x$，需输出：\n\n将树中编号在 $[l,r]$ 内的所有节点保留，$x$ 所在连通块中颜色种类数。\n\n每次查询操作独立。", "inputFormat": "第一行两个数 $n,m$。\n\n第二行 $n$ 个数表示每个节点的颜色。\n\n之后 $n-1$ 行，每行两个数 $x$ 和 $y$，表示 $x$ 和 $y$ 之间连有一条边。\n\n之后 $m$ 行，每行三个数 $l\\ r\\ x$，表示一次查询操作。", "outputFormat": "对每个查询操作，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：created_equal1，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，所有出现过的数在 $[1,10^5]$ 之间，保证每次输入的 $l \\le x \\le r$。", "locale": "zh-CN"}}}
{"pid": "P5312", "type": "P", "difficulty": 6, "samples": [["5\n5 2 6 2 0\n5\n2 1 5\n1 2\n3 7\n2 2 6\n4", "15\n23"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2011", "O2优化", "Ynoi"], "title": "[Ynoi2011] 竞赛实验班", "background": "中考的时候好像是没什么实感的，随随便便就考上了cdqz，考前几天晚上还在偷偷用itouch看修仙小说。\n\n考上cdqz之后，我就天天去听OI课了，虽然不太听得懂，但反正也没事干。\n\n当时听于神介绍数据结构，他大概是这么写的：\n\n初级：树状数组，线段树\n\n中级：平衡树，可并堆，莫队\n\n高级：主席树，动态树\n\n前沿：动态仙人掌\n\n感觉有好多听起来就好厉害的树，还有“仙人掌”?数据结构真的是太厉害了（伏笔）！\n\n那一年cdqz突然决定搞一个竞赛实验班，专门搞竞赛，由于挺不喜欢文化课的，所以我决定去参加。\n\n想去竞赛班要经过一个学科夏令营的选拔，当时有个朋友f321dd觉得很毒瘤就跑路了，我还不太能理解，现在一定程度上能理解了。\n\n这个学科夏令营大概就是每天请不同学科的竞赛老师来讲课，数学，物理都不太感兴趣，所以上课就很无聊，无所事事的，经常偷偷跑去机房写点代码。\n\n仔细想想，我当时也对未来没什么打算，也谈不上有多热爱竞赛，也谈不上有多讨厌文化课，只是听说这个实验班好，可以上好大学，就去了，感觉和听到“学计算机挣钱多”而选择去计算机系的人差不多。\n\n不过大家不都是这样的吗。\n\n我最后进入了竞赛实验班，也认识了将要一起学习两年oi的大家，同时还进行了一次摸底考试，当时好像zms拿了350第一，我拿了310第二，记得我还用“动态spfa”水了个最短路题，看到AC的时候开心地叫了出来。\n\n当时的竞赛组：\n\nzms：初中同学，之前有提到，大家都叫他“小白”，感觉是一个挺稳重的人，是公认的我们那届OI最强选手，和yjq关系很好，被当时的我视为目标。\n\nf321dd：初中同学，朋友，初中经常一起逃课打牌（自己搞了个叫化学杀的东西），感觉是个有趣的人。\n\ngrh：四中来的，高高瘦瘦的，喜欢看本子和动画片。\n\nziliuziliu：四中来的，瘦瘦的，喜欢玩坦克世界，练了KV3这条线，天天AP打不穿WZ111，水平不错。\n\ncyz：喜欢玩坦克世界，印象中第一次看到他玩是在玩四号防空车，然后我觉得好玩也入坑了，水平挺高的，感觉经常无法理解他在想什么。\n\nFlaze：女oier，感觉挺可爱的。\n\nzyx：外地生，没学过oi。\n\ncx：胖胖的，会写oj。\n\nzqq：和Flaze一个初中的，感觉挺踏实的（最开始是这样的），什么知识点都会去学。\n\n学长：\n\nyjq：特别强，天天比赛早早做完AK。\n\nKarl_duan：感觉一直在学习，很踏实努力。\n\nzcy：特别会乱搞，平时也经常乱搞过题，NOIP暴力拿了600。\n\nmhy：集训队学长，瘦瘦的。\n\n写下这个回忆录的时候我还是挺有感触的，回忆起当时的事情让我很开心~\n\n学oi的那一阵子虽然我很菜，天天被吊打，但无疑还是快乐的。\n\n【记得配图，内容oj7】\n\n由于这是Ynoi，不是出题人拿来写怀旧的文字的地方，所以你需要做一个数据结构题：", "description": "有一个长度为 $n$ 的数组 $A$。下标从 $1$ 开始标号。有 $m$ 个操作需要处理，操作有如下四种：  \n1. 在数组 $A$ 的末尾添加一个数 $x$。  \n2. 输出 $\\sum_{i=l}^{r}A_i$。  \n3. 将数组 $A$ 中的每个数 $A_i$ 都改为 $A_i\\oplus x$。（$\\oplus$ 表示异或操作）。  \n4. 将数组 $A$ 从小到大排序。", "inputFormat": "第一行一个数 $n$ 表示 $A$ 的初始大小。  \n接下来一行 $n$ 个非负整数 $A_i$，表示 $A$ 的中的每个元素。  \n接下来一行一个数 表示询问的数量。  \n接下来 $m$ 行，每行表示一个操作：\n\n- `1 x`： 表示第一种操作，在末尾插入数 $x$。\n- `2 l r`：表示第二种操作，询问 $\\sum_{i=l}^{r}A_i$。保证有 $1\\le l\\le r\\le n'$，其中 $n'$ 为操作时刻序列的长度。\n- `3 x`：表示第三种操作，给每个数 $\\oplus$ 上 $x$。\n-  `4`：表示第四种操作，将数组 $A$ 排序。", "outputFormat": "对于每个第二种操作，输出答案。", "hint": "Idea：WJMZBMR，Solution：WJMZBMR，Code：WJMZBMR，Data：WJMZBMR\n\n$1\\le n,\\,m\\le 10^5, 0\\le x,A_i\\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] Contest Experimental Class", "background": "During the high school entrance exam, it felt like nothing special. I got into cdqz casually. A few nights before the exam, I was still secretly reading xianxia novels on an itouch.\n\nAfter getting into cdqz, I went to OI classes every day. I did not really understand much, but I had nothing else to do anyway.\n\nAt that time, I listened to Yu Shen introduce data structures, and he roughly wrote it like this:\n\nBeginner: Binary Indexed Tree, Segment Tree\n\nIntermediate: Balanced Tree, Mergeable Heap, Mo's Algorithm\n\nAdvanced: Persistent Segment Tree, Dynamic Tree\n\nFrontier: Dynamic Cactus\n\nIt felt like there were so many “trees” that sounded amazing, and even “cactus”? Data structures are really awesome (foreshadowing)!\n\nThat year, cdqz suddenly decided to set up a contest experimental class, focusing on competitions. Since I did not like cultural courses much, I decided to join.\n\nTo enter the contest class, you had to pass a selection summer camp for a subject. At that time, a friend f321dd felt it was very “toxic” and ran away. I did not quite understand then, but now I understand to some extent.\n\nThis summer camp was basically inviting different competition teachers every day to give lectures. I was not interested in math or physics, so the classes were boring. With nothing to do, I often sneaked into the computer room to write some code.\n\nThinking carefully, I had no real plan for the future back then. I cannot say I loved competitions a lot, and I cannot say I hated cultural courses a lot either. I just heard that this experimental class was good and could help you get into a good university, so I went. It felt similar to people choosing a CS major after hearing “computer science makes a lot of money”.\n\nBut is that not how everyone is?\n\nIn the end, I entered the contest experimental class and met everyone who would study OI together for the next two years. We also had a placement test. It seemed that zms got 350 and ranked first, and I got 310 and ranked second. I remember I used “dynamic spfa” to cheese a shortest path problem, and I shouted happily when I saw AC.\n\nThe contest group at that time:\n\nzms: A middle school classmate, mentioned before. Everyone called him “Xiao Bai”. He felt like a steady person, recognized as the strongest OI contestant of our grade, and he was close with yjq. I saw him as my goal at the time.\n\nf321dd: A middle school classmate and friend. In middle school we often skipped classes to play cards together (we even made something called “Chemistry Kill”). He felt like a funny person.\n\ngrh: Came from No. 4 Middle School, tall and thin, liked doujinshi and anime.\n\nziliuziliu: Came from No. 4 Middle School, thin, liked playing World of Tanks. He grinded the KV3 line, and his AP shells could not penetrate WZ111 every day. Pretty good skill.\n\ncyz: Also liked playing World of Tanks. I think the first time I saw him play, he was playing the Wirbelwind. I thought it was fun and also started playing. He was quite strong, and I often could not understand what he was thinking.\n\nFlaze: A female OIer, seemed pretty cute.\n\nzyx: A student from another place, had not learned OI before.\n\ncx: Chubby, could write an OJ.\n\nzqq: From the same middle school as Flaze, seemed very down-to-earth (at first it was like that). He would learn every knowledge point.\n\nSeniors:\n\nyjq: Extremely strong, always finished contests early and AK.\n\nKarl_duan: Felt like he was always studying, very steady and hardworking.\n\nzcy: Very good at messing around, and often solved problems in a messy way. In NOIP he got 600 with brute force.\n\nmhy: A senior from the National Training Team, thin.\n\nWhen writing this memoir, I still feel quite emotional. Remembering what happened back then makes me very happy~\n\nDuring that period of learning OI, although I was very weak and got crushed every day, it was undoubtedly still fun.\n\n[Remember to add pictures, content oj7]\n\nSince this is Ynoi, not a place for the author to write nostalgic text, you need to solve a data structure problem:", "description": "There is an array $A$ of length $n$, indexed starting from $1$. You need to process $m$ operations of the following four types:  \n1. Append a number $x$ to the end of array $A$.  \n2. Output $\\sum_{i=l}^{r}A_i$.  \n3. Change every number $A_i$ in array $A$ to $A_i\\oplus x$. ($\\oplus$ denotes the XOR operation.)  \n4. Sort array $A$ in non-decreasing order.", "inputFormat": "The first line contains an integer $n$, the initial size of $A$.  \nThe next line contains $n$ non-negative integers $A_i$, representing each element in $A$.  \nThe next line contains an integer $m$, the number of operations.  \nThe next $m$ lines each describe one operation:\n\n- `1 x`: the first operation, append $x$ to the end.\n- `2 l r`: the second operation, query $\\sum_{i=l}^{r}A_i$. It is guaranteed that $1\\le l\\le r\\le n'$, where $n'$ is the length of the sequence at the time of the operation.\n- `3 x`: the third operation, XOR every element with $x$.\n- `4`: the fourth operation, sort array $A$.", "outputFormat": "For each operation of the second type, output the answer.", "hint": "Idea: WJMZBMR, Solution: WJMZBMR, Code: WJMZBMR, Data: WJMZBMR\n\n$1\\le n,\\,m\\le 10^5, 0\\le x,A_i\\le 10^9$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] 竞赛实验班", "background": "中考的时候好像是没什么实感的，随随便便就考上了cdqz，考前几天晚上还在偷偷用itouch看修仙小说。\n\n考上cdqz之后，我就天天去听OI课了，虽然不太听得懂，但反正也没事干。\n\n当时听于神介绍数据结构，他大概是这么写的：\n\n初级：树状数组，线段树\n\n中级：平衡树，可并堆，莫队\n\n高级：主席树，动态树\n\n前沿：动态仙人掌\n\n感觉有好多听起来就好厉害的树，还有“仙人掌”?数据结构真的是太厉害了（伏笔）！\n\n那一年cdqz突然决定搞一个竞赛实验班，专门搞竞赛，由于挺不喜欢文化课的，所以我决定去参加。\n\n想去竞赛班要经过一个学科夏令营的选拔，当时有个朋友f321dd觉得很毒瘤就跑路了，我还不太能理解，现在一定程度上能理解了。\n\n这个学科夏令营大概就是每天请不同学科的竞赛老师来讲课，数学，物理都不太感兴趣，所以上课就很无聊，无所事事的，经常偷偷跑去机房写点代码。\n\n仔细想想，我当时也对未来没什么打算，也谈不上有多热爱竞赛，也谈不上有多讨厌文化课，只是听说这个实验班好，可以上好大学，就去了，感觉和听到“学计算机挣钱多”而选择去计算机系的人差不多。\n\n不过大家不都是这样的吗。\n\n我最后进入了竞赛实验班，也认识了将要一起学习两年oi的大家，同时还进行了一次摸底考试，当时好像zms拿了350第一，我拿了310第二，记得我还用“动态spfa”水了个最短路题，看到AC的时候开心地叫了出来。\n\n当时的竞赛组：\n\nzms：初中同学，之前有提到，大家都叫他“小白”，感觉是一个挺稳重的人，是公认的我们那届OI最强选手，和yjq关系很好，被当时的我视为目标。\n\nf321dd：初中同学，朋友，初中经常一起逃课打牌（自己搞了个叫化学杀的东西），感觉是个有趣的人。\n\ngrh：四中来的，高高瘦瘦的，喜欢看本子和动画片。\n\nziliuziliu：四中来的，瘦瘦的，喜欢玩坦克世界，练了KV3这条线，天天AP打不穿WZ111，水平不错。\n\ncyz：喜欢玩坦克世界，印象中第一次看到他玩是在玩四号防空车，然后我觉得好玩也入坑了，水平挺高的，感觉经常无法理解他在想什么。\n\nFlaze：女oier，感觉挺可爱的。\n\nzyx：外地生，没学过oi。\n\ncx：胖胖的，会写oj。\n\nzqq：和Flaze一个初中的，感觉挺踏实的（最开始是这样的），什么知识点都会去学。\n\n学长：\n\nyjq：特别强，天天比赛早早做完AK。\n\nKarl_duan：感觉一直在学习，很踏实努力。\n\nzcy：特别会乱搞，平时也经常乱搞过题，NOIP暴力拿了600。\n\nmhy：集训队学长，瘦瘦的。\n\n写下这个回忆录的时候我还是挺有感触的，回忆起当时的事情让我很开心~\n\n学oi的那一阵子虽然我很菜，天天被吊打，但无疑还是快乐的。\n\n【记得配图，内容oj7】\n\n由于这是Ynoi，不是出题人拿来写怀旧的文字的地方，所以你需要做一个数据结构题：", "description": "有一个长度为 $n$ 的数组 $A$。下标从 $1$ 开始标号。有 $m$ 个操作需要处理，操作有如下四种：  \n1. 在数组 $A$ 的末尾添加一个数 $x$。  \n2. 输出 $\\sum_{i=l}^{r}A_i$。  \n3. 将数组 $A$ 中的每个数 $A_i$ 都改为 $A_i\\oplus x$。（$\\oplus$ 表示异或操作）。  \n4. 将数组 $A$ 从小到大排序。", "inputFormat": "第一行一个数 $n$ 表示 $A$ 的初始大小。  \n接下来一行 $n$ 个非负整数 $A_i$，表示 $A$ 的中的每个元素。  \n接下来一行一个数 表示询问的数量。  \n接下来 $m$ 行，每行表示一个操作：\n\n- `1 x`： 表示第一种操作，在末尾插入数 $x$。\n- `2 l r`：表示第二种操作，询问 $\\sum_{i=l}^{r}A_i$。保证有 $1\\le l\\le r\\le n'$，其中 $n'$ 为操作时刻序列的长度。\n- `3 x`：表示第三种操作，给每个数 $\\oplus$ 上 $x$。\n-  `4`：表示第四种操作，将数组 $A$ 排序。", "outputFormat": "对于每个第二种操作，输出答案。", "hint": "Idea：WJMZBMR，Solution：WJMZBMR，Code：WJMZBMR，Data：WJMZBMR\n\n$1\\le n,\\,m\\le 10^5, 0\\le x,A_i\\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P5313", "type": "P", "difficulty": 7, "samples": [["6\n1 1 4 5 1 4\n3\n1 6 1\n2 3 3\n3 4 1", "0\n2\n0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "O2优化", "Ynoi"], "title": "[Ynoi2011] WBLT", "background": "时间大概在学科夏令营那段时间：\n\n当时信息组的其他几个还有新高二的同学都开始学splay了，每天听到zms和yjq（一个学长，很强）讨论splay，还戏称为\"spaly\"，就感觉很紧张，他们怎么学这么厉害的东西，我还完全不了解。\n\n然后我上网查了查splay，看到几百行的代码，看到什么zig，zag，势能分析（所以说写的这么丑的博客为什么会排前几），就感觉这个东西无法理解，大概看了看也没看懂。\n\n去问了问于神splay的功能是什么——“插入，删除，查询第k小”\n\n反正天天也无聊，于是就想了想：\n\n线段树可以查第k小，只需要让其叶子sorted即可。\n\n所以线段树是不是也能做？\n\n但是我们的线段树是一个静态的结构（当时的想法），这个东西要动态化才行，不然如何插入删除？\n\n线段树维护了每个点的区间，这个东西是静态的，也就是问题所在，我们考虑如何动态化这个东西：\n\n插入一个节点的时候，如果找到了插入位置，那么一定是一个叶子，我们可以给这个节点新建两个叶子的儿子。\n\n可以发现这个插入位置后面的所有节点都进行了平移，于是我们可以考虑对这个进行打标记来维护，称为平移标记，每次push_down平移标记来实现动态化。\n\n每次删除的时候可以使用其兄弟来代替被删除的节点，同理需要进行平移标记的维护。\n\n查询的时候先push_down平移标记，然后考虑是否进入左儿子即可。\n\n可以发现这样的结构在插入链式数据下复杂度会有问题，考虑如何平衡。\n\n我当时第一个想到的是设定一个ratio，使得左右儿子的比例在ratio之内，否则暴力重构，写了写发现好像是对的，去问于神，然后他说这个就是“替罪羊树”......\n\n诶所以我自己发明平衡树了？\n\n这么看来平衡树很简单啊。\n\n这么看来我很强啊（错觉）。\n\n然后我就一直按这个思路想下去了，想了很多种奇怪的写法，比如不平衡的时候合并一下，或者按中点分裂什么的。\n\n我乱写了一个策略，通过了平衡树模板题，但是当时写的非常复杂，因为我维护了父亲，而且写法未经过优化。\n\n后来发现不需要所谓的平移标记，可以直接维护size，这样可以按相对位置二分下去，减少了很多代码量。\n\n发现可以不存father，减少了很多代码量。\n\n又发现这个树也是可以”旋转“的，我们将旋转定义为合并两个节点即可（所以我看到说什么”无旋treap不用旋转，和treap不一样“的言论都感觉很谔谔，因为本身就是等价操作，同一个东西写出来不一样而已）。\n\n同时也是可以分裂的，这里我分裂定义为了经过 $O( logn )$ 次旋转使得根的左儿子的右儿子是我们需要的区间。\n\n我发现我设计出的平衡树的确是可以支持所有操作的，复杂度也都是 $O( logn )$ ，而且个人认为这个很好写。\n\n所以我发明平衡树了？\n\n当时起了个名字“自平衡线段树”——“Self Balancing Segment Tree”，虽然后来查了很久发现其实是把两个OI界中未引入的东西结合在了一起，应该叫做“Weight Balanced Leafy Tree”\n\n刚做出来的时候觉得这个是很重要的东西，于是对其他人都藏着掖着，生怕同学们学到我的技术，因为我当时也知道，省队就5个名额，同学都是我的竞争对手。\n\n当时mhy听说我的平衡树很强，就问我能不能10分钟写出来，我接受了挑战，然后还真的写出来了，得到了集训队爷的认可+1\n\n当时就对自己充满了自信，我都能发明这么强的一个数据结构，那进集训队保送清华北大还不是随手的事情吗（flag）。\n\n【记得配图，WBLT的】\n\n由于这是Ynoi，不是出题人拿来写装逼的文字的地方，所以你需要做一个数据结构题：", "description": "给你一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n每次查询操作给定参数 $l,r,b$，需输出最大的 $x$，使得存在一个 $a$，满足 $0\\leq a<b$，使得 $a,a+b,a+2b,\\ldots,a+(x-1)b$ 都在区间 $[l,r]$ 内至少出现过一次。\n\n如果不存在 $[0,b-1]$ 内的数，则输出 $0$。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示这个序列。\n\n第三行一个整数 $m$。\n\n之后 $m$ 行，每行三个整数 $l,r,b$，表示一次查询操作。", "outputFormat": "对于每个查询操作，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078&Forever_Pursuit\n\n对于 $30\\%$ 的数据，所有出现过的数在 $[0,1000]$ 之间。\n\n对于另外 $30\\%$ 的数据，$b \\leq 1000$。\n\n对于 $100\\%$ 的数据，所有出现过的数在 $[0,10^5]$ 之间。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] WBLT", "background": "The time was probably around the subject summer camp period.\n\nBack then, several other students in the informatics group, as well as some new 11th graders, had started learning splay. Every day I heard zms and yjq (a senior student, very strong) discussing splay, and they even jokingly called it \"spaly\". It made me feel nervous: how could they be learning something so hard while I still knew nothing about it?\n\nThen I searched for splay online. I saw several hundred lines of code, things like zig, zag, potential analysis (so why do such ugly blogs rank so high), and felt that this thing was impossible to understand. I skimmed it but did not understand anything.\n\nI went to ask what splay could do. The answer was: \"insert, delete, query the $k$-th smallest\".\n\nAnyway, I was bored every day, so I thought about it.\n\nA segment tree can query the $k$-th smallest, as long as its leaves are sorted.\n\nSo can a segment tree do it too?\n\nBut our segment tree is a static structure (that was my thinking at the time). It has to become dynamic, otherwise how can we insert and delete?\n\nA segment tree maintains the interval of each node, which is static. That is the core problem, so we consider how to make it dynamic.\n\nWhen inserting a node, if we find the insertion position, it must be a leaf. We can create two new leaf children for this node.\n\nWe can see that all nodes after this insertion position are shifted. So we can consider using a tag to maintain this, called a shift tag. Each time we `push_down` the shift tag to achieve dynamization.\n\nWhen deleting, we can use its sibling to replace the deleted node. Similarly, we need to maintain the shift tag.\n\nWhen querying, first `push_down` the shift tag, then decide whether to go into the left child.\n\nWe can see that this structure will have complexity problems under chain-like insertion data, so we consider how to balance it.\n\nThe first thing I thought of was setting a ratio so that the proportion of left and right subtrees stays within the ratio; otherwise, we rebuild by brute force. I wrote it and it seemed correct, then I asked Yu-shen, and he said this is a \"Scapegoat Tree\"...\n\nSo I invented a balanced tree myself?\n\nIn that case, balanced trees are quite simple.\n\nIn that case, I am very strong (an illusion).\n\nThen I kept thinking along this line and came up with many strange implementations, such as merging when unbalanced, or splitting by midpoint, and so on.\n\nI wrote a random strategy and passed the balanced tree template problem, but it was very complex at the time because I maintained the parent pointer and the implementation was not optimized.\n\nLater I found that the so-called shift tag was not needed. We can directly maintain `size`, so we can binary search downward by relative position, reducing a lot of code.\n\nI also found that we do not need to store `father`, reducing a lot of code.\n\nI further found that this tree can also be \"rotated\". We can define rotation as merging two nodes (so whenever I see claims like \"rotationless treap does not need rotation, unlike treap\", I feel quite speechless, because it is essentially an equivalent operation. It is the same thing, just written differently).\n\nIt can also be split. Here I defined splitting as performing $O( logn )$ rotations so that the right child of the root's left child becomes the interval we need.\n\nI found that the balanced tree I designed can indeed support all operations, the complexity is also $O( logn )$, and personally I think it is very easy to write.\n\nSo I invented a balanced tree?\n\nAt that time I gave it a name, \"Self Balancing Segment Tree\". Later, after searching for a long time, I found that it was actually a combination of two things that were not introduced into the OI community. It should be called \"Weight Balanced Leafy Tree\".\n\nWhen I first made it, I thought it was very important, so I hid it from others, afraid that my classmates would learn my technique. I also knew that there were only 5 spots in the provincial team, and my classmates were my competitors.\n\nAt that time, mhy heard that my balanced tree was very strong and asked whether I could write it in 10 minutes. I accepted the challenge, and I actually wrote it out, earning +1 recognition from the CTT seniors.\n\nAt that time I was full of confidence. If I could invent such a strong data structure, then getting into the CTT and being recommended to Tsinghua or Peking University would be easy (a flag).\n\n[Remember to add an illustration, for WBLT.]\n\nSince this is Ynoi, not a place for the problem setter to write show-off text, you need to solve a data structure problem.", "description": "You are given a sequence of length $n$, with $m$ query operations.\n\nEach query gives parameters $l,r,b$. You need to output the maximum $x$ such that there exists an $a$ with $0\\leq a<b$ satisfying that $a,a+b,a+2b,\\ldots,a+(x-1)b$ have all appeared at least once within the interval $[l,r]$.\n\nIf no number in $[0,b-1]$ exists, output $0$.", "inputFormat": "The first line contains an integer $n$.\n\nThe second line contains $n$ integers representing the sequence.\n\nThe third line contains an integer $m$.\n\nThen follow $m$ lines, each containing three integers $l,r,b$, representing one query operation.", "outputFormat": "For each query operation, output one line with one integer representing the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: ccz181078, Data: ccz181078&Forever_Pursuit.\n\nFor $30\\%$ of the testdata, all numbers that appear are within $[0,1000]$.\n\nFor another $30\\%$ of the testdata, $b \\leq 1000$.\n\nFor $100\\%$ of the testdata, all numbers that appear are within $[0,10^5]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] WBLT", "background": "时间大概在学科夏令营那段时间：\n\n当时信息组的其他几个还有新高二的同学都开始学splay了，每天听到zms和yjq（一个学长，很强）讨论splay，还戏称为\"spaly\"，就感觉很紧张，他们怎么学这么厉害的东西，我还完全不了解。\n\n然后我上网查了查splay，看到几百行的代码，看到什么zig，zag，势能分析（所以说写的这么丑的博客为什么会排前几），就感觉这个东西无法理解，大概看了看也没看懂。\n\n去问了问于神splay的功能是什么——“插入，删除，查询第k小”\n\n反正天天也无聊，于是就想了想：\n\n线段树可以查第k小，只需要让其叶子sorted即可。\n\n所以线段树是不是也能做？\n\n但是我们的线段树是一个静态的结构（当时的想法），这个东西要动态化才行，不然如何插入删除？\n\n线段树维护了每个点的区间，这个东西是静态的，也就是问题所在，我们考虑如何动态化这个东西：\n\n插入一个节点的时候，如果找到了插入位置，那么一定是一个叶子，我们可以给这个节点新建两个叶子的儿子。\n\n可以发现这个插入位置后面的所有节点都进行了平移，于是我们可以考虑对这个进行打标记来维护，称为平移标记，每次push_down平移标记来实现动态化。\n\n每次删除的时候可以使用其兄弟来代替被删除的节点，同理需要进行平移标记的维护。\n\n查询的时候先push_down平移标记，然后考虑是否进入左儿子即可。\n\n可以发现这样的结构在插入链式数据下复杂度会有问题，考虑如何平衡。\n\n我当时第一个想到的是设定一个ratio，使得左右儿子的比例在ratio之内，否则暴力重构，写了写发现好像是对的，去问于神，然后他说这个就是“替罪羊树”......\n\n诶所以我自己发明平衡树了？\n\n这么看来平衡树很简单啊。\n\n这么看来我很强啊（错觉）。\n\n然后我就一直按这个思路想下去了，想了很多种奇怪的写法，比如不平衡的时候合并一下，或者按中点分裂什么的。\n\n我乱写了一个策略，通过了平衡树模板题，但是当时写的非常复杂，因为我维护了父亲，而且写法未经过优化。\n\n后来发现不需要所谓的平移标记，可以直接维护size，这样可以按相对位置二分下去，减少了很多代码量。\n\n发现可以不存father，减少了很多代码量。\n\n又发现这个树也是可以”旋转“的，我们将旋转定义为合并两个节点即可（所以我看到说什么”无旋treap不用旋转，和treap不一样“的言论都感觉很谔谔，因为本身就是等价操作，同一个东西写出来不一样而已）。\n\n同时也是可以分裂的，这里我分裂定义为了经过 $O( logn )$ 次旋转使得根的左儿子的右儿子是我们需要的区间。\n\n我发现我设计出的平衡树的确是可以支持所有操作的，复杂度也都是 $O( logn )$ ，而且个人认为这个很好写。\n\n所以我发明平衡树了？\n\n当时起了个名字“自平衡线段树”——“Self Balancing Segment Tree”，虽然后来查了很久发现其实是把两个OI界中未引入的东西结合在了一起，应该叫做“Weight Balanced Leafy Tree”\n\n刚做出来的时候觉得这个是很重要的东西，于是对其他人都藏着掖着，生怕同学们学到我的技术，因为我当时也知道，省队就5个名额，同学都是我的竞争对手。\n\n当时mhy听说我的平衡树很强，就问我能不能10分钟写出来，我接受了挑战，然后还真的写出来了，得到了集训队爷的认可+1\n\n当时就对自己充满了自信，我都能发明这么强的一个数据结构，那进集训队保送清华北大还不是随手的事情吗（flag）。\n\n【记得配图，WBLT的】\n\n由于这是Ynoi，不是出题人拿来写装逼的文字的地方，所以你需要做一个数据结构题：", "description": "给你一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n每次查询操作给定参数 $l,r,b$，需输出最大的 $x$，使得存在一个 $a$，满足 $0\\leq a<b$，使得 $a,a+b,a+2b,\\ldots,a+(x-1)b$ 都在区间 $[l,r]$ 内至少出现过一次。\n\n如果不存在 $[0,b-1]$ 内的数，则输出 $0$。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示这个序列。\n\n第三行一个整数 $m$。\n\n之后 $m$ 行，每行三个整数 $l,r,b$，表示一次查询操作。", "outputFormat": "对于每个查询操作，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078&Forever_Pursuit\n\n对于 $30\\%$ 的数据，所有出现过的数在 $[0,1000]$ 之间。\n\n对于另外 $30\\%$ 的数据，$b \\leq 1000$。\n\n对于 $100\\%$ 的数据，所有出现过的数在 $[0,10^5]$ 之间。", "locale": "zh-CN"}}}
{"pid": "P5314", "type": "P", "difficulty": 7, "samples": [["5 5\n3 4 3 1 3\n1 2\n1 3\n2 4\n3 5\n2 1 3\n2 1 1\n1 1 1 1\n2 1 3\n1 4 1 1\n", "4\n3\n4\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2011", "O2优化", "Ynoi"], "title": "[Ynoi2011] ODT", "background": " 【先咕咕咕", "description": "给你一棵树，边权为 $1$，有点权。\n\n需要支持两个操作：\n\n- `1 x y z`：表示把树上 $x$ 到 $y$ 这条简单路径的所有点点权都加上 $z$。\n- `2 x y`：表示查询与点 $x$ 距离**小于等于** $1$ 的所有点里面的第 $y$ 小点权。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示每个点的点权。\n\n之后 $n-1$ 行，每行两个整数 $x,y$ 表示 $x$ 和 $y$ 之间连有一条边。\n\n之后 $m$ 行，每行为 `1 x y z` 或者 `2 x y` 形式，意义如上述。", "outputFormat": "对每个 2 操作输出一行，每行一个整数表示答案。\n\n数据保证每次询问都存在答案。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477( $O( n\\log^2n/ \\log\\log n )$ solution )，negiizhao( $O( n\\log n\\log\\log\\log n )$ solution )，ccz181078( $O( n\\log n )$ solution )，\n\nCode：nzhtl1477( $O( n\\log^2 n/ \\log\\log n )$ code )\n\nData：nzhtl1477( partially uploaded )\n\nsubtask 1：$20\\%$ $n,m\\leq 1000$。\n\nsubtask 2：$10\\%$ 树为一条链。\n\nsubtask 3：$20\\%$ $n,m\\leq 10^5$。\n\nsubtask 4：$30\\%$ $n,m\\leq 4\\times 10^5$。\n\nsubtask 5：$20\\%$ $n,m\\leq 10^6$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^6$，$0\\leq $ 每次加的数 $\\leq 2000$，$0\\leq $ 初始的点权 $\\leq 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] ODT", "background": "To be updated.", "description": "You are given a tree where each edge has weight $1$, and each node has a weight.\n\nSupport two operations:\n- `1 x y z`: Add $z$ to the weights of all nodes on the simple path from $x$ to $y$.\n- `2 x y`: Query the $y$-th smallest node weight among all nodes whose distance to node $x$ is less than or equal to $1$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains $n$ integers, the weight of each node.\n\nThen follow $n-1$ lines, each containing two integers $x, y$ indicating that there is an edge between $x$ and $y$.\n\nThen follow $m$ lines, each in the form `1 x y z` or `2 x y`, as described above.", "outputFormat": "For each operation of type $2$, output one line with one integer, the answer.\n\nIt is guaranteed that the answer exists for every query.", "hint": "- Idea: nzhtl1477.\n- Solution: nzhtl1477 ( $O( n\\log^2 n / \\log\\log n )$ solution ), negiizhao ( $O( n\\log n\\log\\log\\log n )$ solution ), ccz181078 ( $O( n\\log n )$ solution ).\n- Code: nzhtl1477 ( $O( n\\log^2 n / \\log\\log n )$ code ).\n- Data: nzhtl1477 ( partially uploaded ).\n\nSubtask 1: $20\\%$ $n, m \\leq 1000$.\n\nSubtask 2: $10\\%$ the tree is a chain.\n\nSubtask 3: $20\\%$ $n, m \\leq 10^5$.\n\nSubtask 4: $30\\%$ $n, m \\leq 4\\times 10^5$.\n\nSubtask 5: $20\\%$ $n, m \\leq 10^6$.\n\nConstraints: For $100\\%$ of the testdata, $1 \\leq n, m \\leq 10^6$, $0 \\leq$ the value added in each update $\\leq 2000$, $0 \\leq$ the initial node weights $\\leq 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] ODT", "background": " 【先咕咕咕", "description": "给你一棵树，边权为 $1$，有点权。\n\n需要支持两个操作：\n\n- `1 x y z`：表示把树上 $x$ 到 $y$ 这条简单路径的所有点点权都加上 $z$。\n- `2 x y`：表示查询与点 $x$ 距离**小于等于** $1$ 的所有点里面的第 $y$ 小点权。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示每个点的点权。\n\n之后 $n-1$ 行，每行两个整数 $x,y$ 表示 $x$ 和 $y$ 之间连有一条边。\n\n之后 $m$ 行，每行为 `1 x y z` 或者 `2 x y` 形式，意义如上述。", "outputFormat": "对每个 2 操作输出一行，每行一个整数表示答案。\n\n数据保证每次询问都存在答案。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477( $O( n\\log^2n/ \\log\\log n )$ solution )，negiizhao( $O( n\\log n\\log\\log\\log n )$ solution )，ccz181078( $O( n\\log n )$ solution )，\n\nCode：nzhtl1477( $O( n\\log^2 n/ \\log\\log n )$ code )\n\nData：nzhtl1477( partially uploaded )\n\nsubtask 1：$20\\%$ $n,m\\leq 1000$。\n\nsubtask 2：$10\\%$ 树为一条链。\n\nsubtask 3：$20\\%$ $n,m\\leq 10^5$。\n\nsubtask 4：$30\\%$ $n,m\\leq 4\\times 10^5$。\n\nsubtask 5：$20\\%$ $n,m\\leq 10^6$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^6$，$0\\leq $ 每次加的数 $\\leq 2000$，$0\\leq $ 初始的点权 $\\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P5315", "type": "P", "difficulty": 2, "samples": [["3 5 10\n12 3\n7 8\n5 5\n", "Too Young\nToo Simple\nSometimes Naive"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "洛谷月赛"], "title": "头像上传", "background": "", "description": "有一天无聊的你在注册一个无聊的网站，注册完的第一步自然是上传头像。\n\n你发现这个网站总共可以上传 $n$ 个头像，每个头像必须是正方形，并且长宽至少为 $L \\times L$\n\n在图片上传前，系统会对图片进行如下处理：如果图片的任何一边长度超过了 $G$ ，那么系统会不断地对图片的长宽同时减半（向下取整），直至两边长度 $\\leq G$ 为止。\n\n你现在找到了 $n$ 张可供上传的图片，第 $i$ 张的尺寸是 $W_i \\times H_i$。\n\n如果图片有任何一边小于 $L$，请输出 \"Too Young\"\n \n如果图片满足大小条件但不为正方形，请输出\"Too Simple\"\n\n如果图片满足大小条件并且是正方形，请输出\"Sometimes Naive\" \n\n以上所有字符串输出时均不包含引号。", "inputFormat": "一行三个整数 $n,L,G$，意义如题目所述。\n\n接下来每行两个整数 $W_i,H_i$，表示图片长宽。", "outputFormat": "共 $n$ 行，每行一个字符串，意义如题目所述。 ", "hint": "对于 $30\\%$ 的数据，满足 $n=1$\n\n对于 $100\\%$的数据，满足 $n \\leq 2000$，$W_i,H_i ,G\\leq 10000$", "locale": "zh-CN", "translations": {"en": {"title": "Avatar Upload", "background": "", "description": "One day, out of boredom, you register on a boring website. The first step after registration is naturally to upload an avatar.\n\nYou find that this website allows you to upload a total of $n$ avatars. Each avatar must be a square, and its side length must be at least $L \\times L$.\n\nBefore an image is uploaded, the system processes it as follows: if any side length of the image exceeds $G$, the system will repeatedly halve both the width and height at the same time (rounding down) until both side lengths are $\\leq G$.\n\nNow you have found $n$ images that can be uploaded. The $i$-th image has size $W_i \\times H_i$.\n\nIf any side of the image is less than $L$, output \"Too Young\".\n\nIf the image meets the size requirement but is not a square, output \"Too Simple\".\n\nIf the image meets the size requirement and is a square, output \"Sometimes Naive\".\n\nAll the above strings should be printed without quotes.", "inputFormat": "One line contains three integers $n, L, G$, with the meanings as described in the statement.\n\nEach of the next lines contains two integers $W_i, H_i$, representing the width and height of the image.", "outputFormat": "Output $n$ lines in total, each line containing one string, with the meanings as described in the statement.", "hint": "For $30\\%$ of the testdata, $n = 1$.\n\nFor $100\\%$ of the testdata, $n \\leq 2000$ and $W_i, H_i, G \\leq 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "头像上传", "background": "", "description": "有一天无聊的你在注册一个无聊的网站，注册完的第一步自然是上传头像。\n\n你发现这个网站总共可以上传 $n$ 个头像，每个头像必须是正方形，并且长宽至少为 $L \\times L$\n\n在图片上传前，系统会对图片进行如下处理：如果图片的任何一边长度超过了 $G$ ，那么系统会不断地对图片的长宽同时减半（向下取整），直至两边长度 $\\leq G$ 为止。\n\n你现在找到了 $n$ 张可供上传的图片，第 $i$ 张的尺寸是 $W_i \\times H_i$。\n\n如果图片有任何一边小于 $L$，请输出 \"Too Young\"\n \n如果图片满足大小条件但不为正方形，请输出\"Too Simple\"\n\n如果图片满足大小条件并且是正方形，请输出\"Sometimes Naive\" \n\n以上所有字符串输出时均不包含引号。", "inputFormat": "一行三个整数 $n,L,G$，意义如题目所述。\n\n接下来每行两个整数 $W_i,H_i$，表示图片长宽。", "outputFormat": "共 $n$ 行，每行一个字符串，意义如题目所述。 ", "hint": "对于 $30\\%$ 的数据，满足 $n=1$\n\n对于 $100\\%$的数据，满足 $n \\leq 2000$，$W_i,H_i ,G\\leq 10000$", "locale": "zh-CN"}}}
{"pid": "P5316", "type": "P", "difficulty": 5, "samples": [["1 3\n4 6 2\n48 144 36", "16 12 18"], ["2 4\n4 2 4 6 4 2\n48 144 16 36 12 36\n1 1 1 1 2 1 \n56 63 70 72 40 90 ", "16 12 18 4\n7 8 9 10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数论", "Special Judge", "洛谷月赛"], "title": "恋恋的数学题", "background": "恋恋是个可爱的女孩子，最近她沉迷了做数学题。", "description": "现在恋恋正在处理的题目十分简单：现在有$k \\space (2\\leq k\\leq 4)$个数，恋恋不知道它们分别是几，只知道它们**两两**最大公约数及最小公倍数。\n\n按照套路，恋恋非常想复原出那$k$个数，但是现在她需要假装不会做，于是她就把题目交给了你，如果你顺利解决了这个问题，恋恋就会在你背后疯狂打call……", "inputFormat": "第一行，两个整数$T$和$k$\n\n接下来$2T$行包含$T$组数据，每组数据包含两行，\n\n第一行，$\\frac{k(k-1)}2$个整数，表示$k$个未知数的两两最大公约数，乱序\n\n第二行，$\\frac{k(k-1)}2$个整数，表示$k$个未知数的两两最小公倍数，乱序", "outputFormat": "输出$T$行，每行$k$个用空格分隔的数，表示**任意一组**符合对应数据的答案。", "hint": "**保证奇数测试点中，第一行（gcd行）数据均为$1$**\n\n|测试点编号　　　|$k$　　　|输入整数不超过　　　|\n|-|-|-|\n|1,2|2|$100$|\n|3,4|2|$1000$|\n|5,6|2|$10^7$|\n|7,8|3|$100$|\n|9,10|3|$10^7$|\n|11,12|3|$10^{14}$|\n|13,14|4|$100$|\n|15,16|4|$10^7$|\n|17,18|4|$10^{14}$|\n|19,20|4|$10^{18}$|\n\n**保证数据有解**，$T\\leq 5$\n\n**SPJ按照每组中的正确比例给分，但如果TLE、RE等会导致无输出而爆零**", "locale": "zh-CN", "translations": {"en": {"title": "Lianlian’s Math Problem.", "background": "Lianlian is a cute girl, and recently she has been addicted to solving math problems.", "description": "The problem Lianlian is working on now is very simple: there are $k \\space (2\\leq k\\leq 4)$ numbers. Lianlian does not know what they are, but she knows the pairwise greatest common divisors and least common multiples of these numbers.\n\nAs usual, Lianlian really wants to reconstruct those $k$ numbers, but now she needs to pretend she cannot do it, so she hands the problem to you. If you solve it successfully, Lianlian will cheer for you like crazy behind your back.", "inputFormat": "The first line contains two integers $T$ and $k$.\n\nThe next $2T$ lines contain $T$ test cases, and each test case consists of two lines.\n\nThe first line contains $\\frac{k(k-1)}2$ integers, representing the pairwise greatest common divisors of the $k$ unknown numbers, in arbitrary order.\n\nThe second line contains $\\frac{k(k-1)}2$ integers, representing the pairwise least common multiples of the $k$ unknown numbers, in arbitrary order.", "outputFormat": "Output $T$ lines. Each line contains $k$ numbers separated by spaces, representing any one set of answers that matches the given data.", "hint": "It is guaranteed that for odd-numbered test points, the first line (the gcd line) is all $1$.\n\n|Test Point ID|$k$|Input Integers Do Not Exceed|\n|-|-|-|\n|1,2|2|$100$|\n|3,4|2|$1000$|\n|5,6|2|$10^7$|\n|7,8|3|$100$|\n|9,10|3|$10^7$|\n|11,12|3|$10^{14}$|\n|13,14|4|$100$|\n|15,16|4|$10^7$|\n|17,18|4|$10^{14}$|\n|19,20|4|$10^{18}$|\n\nIt is guaranteed that the testdata has a solution, and $T\\leq 5$.\n\nThe SPJ scores according to the correct ratio within each test case, but if TLE, RE, etc. causes no output, you will get zero points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "恋恋的数学题", "background": "恋恋是个可爱的女孩子，最近她沉迷了做数学题。", "description": "现在恋恋正在处理的题目十分简单：现在有$k \\space (2\\leq k\\leq 4)$个数，恋恋不知道它们分别是几，只知道它们**两两**最大公约数及最小公倍数。\n\n按照套路，恋恋非常想复原出那$k$个数，但是现在她需要假装不会做，于是她就把题目交给了你，如果你顺利解决了这个问题，恋恋就会在你背后疯狂打call……", "inputFormat": "第一行，两个整数$T$和$k$\n\n接下来$2T$行包含$T$组数据，每组数据包含两行，\n\n第一行，$\\frac{k(k-1)}2$个整数，表示$k$个未知数的两两最大公约数，乱序\n\n第二行，$\\frac{k(k-1)}2$个整数，表示$k$个未知数的两两最小公倍数，乱序", "outputFormat": "输出$T$行，每行$k$个用空格分隔的数，表示**任意一组**符合对应数据的答案。", "hint": "**保证奇数测试点中，第一行（gcd行）数据均为$1$**\n\n|测试点编号　　　|$k$　　　|输入整数不超过　　　|\n|-|-|-|\n|1,2|2|$100$|\n|3,4|2|$1000$|\n|5,6|2|$10^7$|\n|7,8|3|$100$|\n|9,10|3|$10^7$|\n|11,12|3|$10^{14}$|\n|13,14|4|$100$|\n|15,16|4|$10^7$|\n|17,18|4|$10^{14}$|\n|19,20|4|$10^{18}$|\n\n**保证数据有解**，$T\\leq 5$\n\n**SPJ按照每组中的正确比例给分，但如果TLE、RE等会导致无输出而爆零**", "locale": "zh-CN"}}}
{"pid": "P5317", "type": "P", "difficulty": 5, "samples": [["4 5\n4 3 3 7 6\n1 8 12 1 2\n1 1 3 0 1\n2 1 1 0 4\n4 6 7\n4 7 8\n4 8 9\n2 0 5\n2 5 7\n2 5 1 2", "62\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "洛谷月赛"], "title": "简单模拟", "background": "", "description": "考虑这样一款游戏，游戏地图可以视为一个平面直角坐标系的第一、四象限。\n\n第一象限内会出现 $n$ 个物体，一个物体可以是一个点，或者一条平行于 y 轴的线段。一个物体出现时，物体上离 x 轴最近的点和最远的点，分别称为物体的最低点和最高点。若物体是点，则最低点和最高点相同。\n\n第 $i$ 个物体会在时刻 $t_i$ 出现，最低点为 $(x_i,l_i)$，最高点为 $(x_i,r_i)$，以速度 $v_i$ 沿 y 轴负半轴方向匀速移动。\n\n玩家可以标记 x 轴正半轴上的任何整点（若这个位置已经被标记，则这次的标记和之前的标记互不影响），称为**标记操作**；也可以取消某个标记，称为**取消标记操作**。同一时间可以做任意次操作。已知玩家做了 $m$ 对操作，第 $i$ 对操作的位置为 $p_i$，其中标记操作和取消标记操作发生的时刻分别为 $a_i$ 和 $b_i$。\n\n每个物体最初会处于**正常状态**。\n\n若在某一时刻，对于一个物体，距离物体的最低点不大于 $d_0$ 的位置发生标记操作，且这个物体处于正常状态，则会发生**得分事件**，且事件的参数 $d$ 为操作位置与物体最低点的距离。若有多个标记操作符合条件，选择其中使得 $d$ 最小的，若仍有多个则选择其中位置最接近原点的，保证这样选出的操作是唯一的。随后，对于这个物体，若是一个点，则会消失，否则会*被这个操作标记*，且变成**被标记状态**。注意，一个操作可以影响多个物体，而一个物体不会被多个操作标记。\n\n若在某一时刻，对于一个物体，距离物体的最高点不大于 $d_0$ 位置发生取消标记操作，且这个物体被相应的标记操作标记，则也会发生**得分事件**，且事件的参数 $d$ 为操作位置与物体最高点的距离。随后，这个物体会消失。\n\n若在某一时刻，一个处于正常状态的物体的最低点到达了第四象限（注意，坐标轴上的点不属于任何一个象限），或一个处于被标记状态的物体对应的标记被取消，且没有因为取消标记发生得分事件，则会发生 **miss 事件**。随后，这个物体会消失。\n\n一个参数为 $d$ 的得分事件发生时，玩家会得到 $(d_0^2-d^2)s_1$ 的基本得分。若此次事件前的连续 $k - 1$ 次事件都是得分事件，且此次事件前的第 $k$ 次事件不是得分事件或不存在，则玩家会得到 $ks_2$ 的额外得分。\n\n游戏中的结算发生在距离游戏开始经过整数个单位时间的时刻之内。已经出现的物体会在相邻两个时刻之间进行移动，某一时刻开始时移动已经完成。在结算的过程中，所有物体均视为静止。游戏开始于 0 时刻。具体来说，对于包括 0 时刻在内的任一时刻：首先，这一时刻开始。随后，所有由移动造成的 miss 事件以某个顺序依次发生。随后，在这一时刻出现的物体同时出现。随后，所有操作同时发生，且保证这一时刻的标记不会在同一时刻被取消。随后，所有得分事件以某个顺序依次发生（总得分与顺序无关）。随后，所有由操作造成的 miss 事件以某个顺序依次发生。随后，所有物体的状态同时改变（消失也视为状态改变）。最后，这一时刻结束。\n\n若所有物体均经历了出现和消失，或 miss 事件发生了严格大于 $w$ 次，游戏立即结束，此后的操作均可以忽略。", "inputFormat": "第一行 $n,m$，分别表示物体的个数和操作的对数。\n\n之后 $n$ 行，每行 $x_i,l_i,r_i,t_i,v_i$。\n\n之后 $m$ 行，每行 $p_i,a_i,b_i$。\n\n之后一行，$d_0,s_1,s_2,w$。", "outputFormat": "输出两行，第一行为得分，第二行为游戏结束时刻。", "hint": "#### 样例说明\n\n在时刻 0 发生了两次得分事件，共得到了 28 分；在时刻 5 发生了一次得分事件和一次 miss 事件，得到了 18 分；在时刻 7 发生了一次得分事件，得到了 16 分；在时刻 8 发生了一次 miss 事件，至此，所有物体都经历了出现和消失，游戏结束。\n\n#### 数据范围\n\n所有输入均为整数。\n\n$1\\le n,m\\le 2000$；\n\n$0\\le t_i,a_i,b_i\\le 10^9$；\n\n$1\\le x_i,p_i,l_i,r_i\\le 10^9$；\n\n$a_i<b_i$，$l_i\\le r_i$；\n\n$1\\le v_i,v_i\\cdot\\max\\{t_j,a_j,b_j\\}\\le 10^9$；\n\n$0\\le d_0,s_1,s_2\\le 10^4$；\n\n$0\\le w\\le n$。\n\n对于30%的数据：$n,m\\le 10$。\n\n#### 题目更新\n\n24.11.15：对于题意的细节改进了描述方式，增加了 hack 数据。\n\n24.12.24：增加一组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "Simple Simulation", "background": "", "description": "Consider a game where the game map can be viewed as the first and fourth quadrants of a Cartesian coordinate plane.\n\nIn the first quadrant, there will be $n$ objects. An object can be a point, or a line segment parallel to the $y$-axis. When an object appears, the point on the object closest to the $x$-axis and the point farthest from the $x$-axis are called the lowest point and the highest point of the object, respectively. If the object is a point, then its lowest point and highest point are the same.\n\nThe $i$-th object appears at time $t_i$. Its lowest point is $(x_i,l_i)$ and its highest point is $(x_i,r_i)$. It then moves at constant speed $v_i$ along the negative direction of the $y$-axis.\n\nThe player may mark any integer point on the positive half-axis of the $x$-axis (if this position has already been marked, then this mark does not affect the previous marks), which is called a **mark operation**. The player may also cancel a mark, which is called a **cancel-mark operation**. Any number of operations can be done at the same time. It is known that the player performed $m$ pairs of operations. The position of the $i$-th pair is $p_i$, and the times of the mark operation and the cancel-mark operation are $a_i$ and $b_i$, respectively.\n\nEach object initially is in the **normal state**.\n\nIf at some time, for an object, a mark operation happens at a position whose distance to the object’s lowest point is at most $d_0$, and the object is in the normal state, then a **scoring event** occurs, and the event parameter $d$ is the distance between the operation position and the object’s lowest point. If multiple mark operations satisfy the condition, choose the one that makes $d$ minimal; if there are still multiple, choose the one whose position is closest to the origin. It is guaranteed that the chosen operation is unique. Then, for this object, if it is a point, it disappears; otherwise, it will be *marked by this operation* and becomes in the **marked state**. Note that one operation can affect multiple objects, while one object will not be marked by multiple operations.\n\nIf at some time, for an object, a cancel-mark operation happens at a position whose distance to the object’s highest point is at most $d_0$, and the object is marked by the corresponding mark operation, then a **scoring event** also occurs, and the event parameter $d$ is the distance between the operation position and the object’s highest point. Then, the object disappears.\n\nIf at some time, an object in the normal state has its lowest point reach the fourth quadrant (note that points on the axes do not belong to any quadrant), or an object in the marked state has its corresponding mark canceled and no scoring event happens due to this cancel-mark operation, then a **miss event** occurs. Then, the object disappears.\n\nWhen a scoring event with parameter $d$ occurs, the player gains a base score of $(d_0^2-d^2)s_1$. If the previous consecutive $k - 1$ events are all scoring events, and the $k$-th event before this one is not a scoring event or does not exist, then the player additionally gains $ks_2$.\n\nSettlement in the game happens at times when an integer number of time units has passed since the start of the game. Objects that have already appeared move between two adjacent times, and at the start of a time, movement has already finished. During settlement, all objects are considered stationary. The game starts at time 0. Specifically, for any time moment including time 0: first, this moment starts. Then, all miss events caused by movement happen one by one in some order. Then, objects that appear at this moment appear simultaneously. Then, all operations happen simultaneously, and it is guaranteed that marks made at this moment will not be canceled at the same moment. Then, all scoring events happen one by one in some order (the total score is independent of the order). Then, all miss events caused by operations happen one by one in some order. Then, all objects’ states change simultaneously (disappearing is also considered a state change). Finally, this moment ends.\n\nIf all objects have both appeared and disappeared, or the number of miss events becomes strictly greater than $w$, the game ends immediately, and all subsequent operations can be ignored.", "inputFormat": "The first line contains $n,m$, representing the number of objects and the number of operation pairs.\n\nThen follow $n$ lines, each containing $x_i,l_i,r_i,t_i,v_i$.\n\nThen follow $m$ lines, each containing $p_i,a_i,b_i$.\n\nThen one line containing $d_0,s_1,s_2,w$.", "outputFormat": "Output two lines. The first line is the score, and the second line is the game end time.", "hint": "#### Sample Explanation\n\nAt time 0, two scoring events occurred, and a total of 28 points was obtained. At time 5, one scoring event and one miss event occurred, and 18 points was obtained. At time 7, one scoring event occurred, and 16 points was obtained. At time 8, one miss event occurred. At this point, all objects have appeared and disappeared, and the game ends.\n\n#### Constraints\n\nAll inputs are integers.\n\n$1\\le n,m\\le 2000$;\n\n$0\\le t_i,a_i,b_i\\le 10^9$;\n\n$1\\le x_i,p_i,l_i,r_i\\le 10^9$;\n\n$a_i<b_i$，$l_i\\le r_i$；\n\n$1\\le v_i,v_i\\cdot\\max\\{t_j,a_j,b_j\\}\\le 10^9$；\n\n$0\\le d_0,s_1,s_2\\le 10^4$；\n\n$0\\le w\\le n$。\n\nFor 30% of the testdata: $n,m\\le 10$.\n\n#### Problem Updates\n\n24.11.15: Improved the description of some details in the statement, and added hack testdata.\n\n24.12.24: Added one more set of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "简单模拟", "background": "", "description": "考虑这样一款游戏，游戏地图可以视为一个平面直角坐标系的第一、四象限。\n\n第一象限内会出现 $n$ 个物体，一个物体可以是一个点，或者一条平行于 y 轴的线段。一个物体出现时，物体上离 x 轴最近的点和最远的点，分别称为物体的最低点和最高点。若物体是点，则最低点和最高点相同。\n\n第 $i$ 个物体会在时刻 $t_i$ 出现，最低点为 $(x_i,l_i)$，最高点为 $(x_i,r_i)$，以速度 $v_i$ 沿 y 轴负半轴方向匀速移动。\n\n玩家可以标记 x 轴正半轴上的任何整点（若这个位置已经被标记，则这次的标记和之前的标记互不影响），称为**标记操作**；也可以取消某个标记，称为**取消标记操作**。同一时间可以做任意次操作。已知玩家做了 $m$ 对操作，第 $i$ 对操作的位置为 $p_i$，其中标记操作和取消标记操作发生的时刻分别为 $a_i$ 和 $b_i$。\n\n每个物体最初会处于**正常状态**。\n\n若在某一时刻，对于一个物体，距离物体的最低点不大于 $d_0$ 的位置发生标记操作，且这个物体处于正常状态，则会发生**得分事件**，且事件的参数 $d$ 为操作位置与物体最低点的距离。若有多个标记操作符合条件，选择其中使得 $d$ 最小的，若仍有多个则选择其中位置最接近原点的，保证这样选出的操作是唯一的。随后，对于这个物体，若是一个点，则会消失，否则会*被这个操作标记*，且变成**被标记状态**。注意，一个操作可以影响多个物体，而一个物体不会被多个操作标记。\n\n若在某一时刻，对于一个物体，距离物体的最高点不大于 $d_0$ 位置发生取消标记操作，且这个物体被相应的标记操作标记，则也会发生**得分事件**，且事件的参数 $d$ 为操作位置与物体最高点的距离。随后，这个物体会消失。\n\n若在某一时刻，一个处于正常状态的物体的最低点到达了第四象限（注意，坐标轴上的点不属于任何一个象限），或一个处于被标记状态的物体对应的标记被取消，且没有因为取消标记发生得分事件，则会发生 **miss 事件**。随后，这个物体会消失。\n\n一个参数为 $d$ 的得分事件发生时，玩家会得到 $(d_0^2-d^2)s_1$ 的基本得分。若此次事件前的连续 $k - 1$ 次事件都是得分事件，且此次事件前的第 $k$ 次事件不是得分事件或不存在，则玩家会得到 $ks_2$ 的额外得分。\n\n游戏中的结算发生在距离游戏开始经过整数个单位时间的时刻之内。已经出现的物体会在相邻两个时刻之间进行移动，某一时刻开始时移动已经完成。在结算的过程中，所有物体均视为静止。游戏开始于 0 时刻。具体来说，对于包括 0 时刻在内的任一时刻：首先，这一时刻开始。随后，所有由移动造成的 miss 事件以某个顺序依次发生。随后，在这一时刻出现的物体同时出现。随后，所有操作同时发生，且保证这一时刻的标记不会在同一时刻被取消。随后，所有得分事件以某个顺序依次发生（总得分与顺序无关）。随后，所有由操作造成的 miss 事件以某个顺序依次发生。随后，所有物体的状态同时改变（消失也视为状态改变）。最后，这一时刻结束。\n\n若所有物体均经历了出现和消失，或 miss 事件发生了严格大于 $w$ 次，游戏立即结束，此后的操作均可以忽略。", "inputFormat": "第一行 $n,m$，分别表示物体的个数和操作的对数。\n\n之后 $n$ 行，每行 $x_i,l_i,r_i,t_i,v_i$。\n\n之后 $m$ 行，每行 $p_i,a_i,b_i$。\n\n之后一行，$d_0,s_1,s_2,w$。", "outputFormat": "输出两行，第一行为得分，第二行为游戏结束时刻。", "hint": "#### 样例说明\n\n在时刻 0 发生了两次得分事件，共得到了 28 分；在时刻 5 发生了一次得分事件和一次 miss 事件，得到了 18 分；在时刻 7 发生了一次得分事件，得到了 16 分；在时刻 8 发生了一次 miss 事件，至此，所有物体都经历了出现和消失，游戏结束。\n\n#### 数据范围\n\n所有输入均为整数。\n\n$1\\le n,m\\le 2000$；\n\n$0\\le t_i,a_i,b_i\\le 10^9$；\n\n$1\\le x_i,p_i,l_i,r_i\\le 10^9$；\n\n$a_i<b_i$，$l_i\\le r_i$；\n\n$1\\le v_i,v_i\\cdot\\max\\{t_j,a_j,b_j\\}\\le 10^9$；\n\n$0\\le d_0,s_1,s_2\\le 10^4$；\n\n$0\\le w\\le n$。\n\n对于30%的数据：$n,m\\le 10$。\n\n#### 题目更新\n\n24.11.15：对于题意的细节改进了描述方式，增加了 hack 数据。\n\n24.12.24：增加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P5318", "type": "P", "difficulty": 2, "samples": [["8 9\n1 2\n1 3\n1 4\n2 5\n2 6\n3 7\n4 7\n4 8\n7 8", "1 2 5 6 3 7 8 4 \n1 2 3 4 5 6 7 8 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "图论", "广度优先搜索 BFS", "深度优先搜索 DFS", "图遍历"], "title": "【深基18.例3】查找文献", "background": null, "description": "小 K 喜欢翻看洛谷博客获取知识。每篇文章可能会有若干个（也有可能没有）参考文献的链接指向别的博客文章。小 K 求知欲旺盛，如果他看了某篇文章，那么他一定会去看这篇文章的参考文献（如果他之前已经看过这篇参考文献的话就不用再看它了）。\n\n假设洛谷博客里面一共有 $n(1\\le n\\le10^5)$ 篇文章（编号为 $1$ 到 $n$）以及 $m(1\\le m\\le10^6)$ 条参考文献引用关系。目前小 K 已经打开了编号为 1 的一篇文章，请帮助小 K 设计一种方法，使小 K 可以不重复、不遗漏的看完所有他能看到的文章。\n\n这边是已经整理好的参考文献关系图，其中，文献 $X\\to Y$ 表示文章 $X$ 有参考文献 $Y$。不保证编号为 $1$ 的文章没有被其他文章引用。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4n4tlhi.png)\n\n请对这个图分别进行 DFS 和 BFS，并输出遍历结果。如果有很多篇文章可以参阅，请先看编号较小的那篇（因此你可能需要先排序）。", "inputFormat": "共 $m+1$ 行，第 $1$ 行为 $2$ 个数，$n$ 和 $m$，分别表示一共有 $n(1\\le n\\le10^5)$ 篇文章（编号为 $1$ 到 $n$）以及$m(1\\le m\\le10^6)$ 条参考文献引用关系。\n\n接下来 $m$ 行，每行有两个整数 $X,Y$ 表示文章 $X$ 有参考文献 $Y$。", "outputFormat": "共 $2$ 行。\n\n第一行为 DFS 遍历结果，第二行为 BFS 遍历结果。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 18. Example 3] Finding References", "background": "", "description": "Xiao K likes to browse Luogu blogs to gain knowledge. Each article may have several (or possibly none) reference links pointing to other blog articles. Xiao K is eager to learn: if he reads an article, he will definitely go read the references of this article (if he has already read a reference before, then he does not need to read it again).\n\nAssume there are a total of $n(1\\le n\\le10^5)$ articles in Luogu blogs (numbered from $1$ to $n$) and $m(1\\le m\\le10^6)$ reference-citation relations. Currently, Xiao K has opened the article numbered $1$. Please help Xiao K design a method so that he can read all the articles he can reach without repetition and without missing any.\n\nHere is the organized reference-relation graph. In it, a reference $X\\to Y$ means article $X$ has reference $Y$. It is not guaranteed that article $1$ is not cited by other articles.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4n4tlhi.png)\n\nPlease perform DFS and BFS on this graph respectively, and output the traversal results. If there are multiple articles that can be visited, read the one with the smaller index first (so you may need to sort first).", "inputFormat": "There are $m+1$ lines in total. The first line contains two numbers, $n$ and $m$, which indicate that there are $n(1\\le n\\le10^5)$ articles in total (numbered from $1$ to $n$) and $m(1\\le m\\le10^6)$ reference-citation relations.\n\nIn the next $m$ lines, each line contains two integers $X, Y$, meaning that article $X$ has reference $Y$.", "outputFormat": "There are $2$ lines in total.\n\nThe first line is the DFS traversal result, and the second line is the BFS traversal result.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基18.例3】查找文献", "background": null, "description": "小 K 喜欢翻看洛谷博客获取知识。每篇文章可能会有若干个（也有可能没有）参考文献的链接指向别的博客文章。小 K 求知欲旺盛，如果他看了某篇文章，那么他一定会去看这篇文章的参考文献（如果他之前已经看过这篇参考文献的话就不用再看它了）。\n\n假设洛谷博客里面一共有 $n(1\\le n\\le10^5)$ 篇文章（编号为 $1$ 到 $n$）以及 $m(1\\le m\\le10^6)$ 条参考文献引用关系。目前小 K 已经打开了编号为 1 的一篇文章，请帮助小 K 设计一种方法，使小 K 可以不重复、不遗漏的看完所有他能看到的文章。\n\n这边是已经整理好的参考文献关系图，其中，文献 $X\\to Y$ 表示文章 $X$ 有参考文献 $Y$。不保证编号为 $1$ 的文章没有被其他文章引用。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4n4tlhi.png)\n\n请对这个图分别进行 DFS 和 BFS，并输出遍历结果。如果有很多篇文章可以参阅，请先看编号较小的那篇（因此你可能需要先排序）。", "inputFormat": "共 $m+1$ 行，第 $1$ 行为 $2$ 个数，$n$ 和 $m$，分别表示一共有 $n(1\\le n\\le10^5)$ 篇文章（编号为 $1$ 到 $n$）以及$m(1\\le m\\le10^6)$ 条参考文献引用关系。\n\n接下来 $m$ 行，每行有两个整数 $X,Y$ 表示文章 $X$ 有参考文献 $Y$。", "outputFormat": "共 $2$ 行。\n\n第一行为 DFS 遍历结果，第二行为 BFS 遍历结果。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5319", "type": "P", "difficulty": 6, "samples": [["4 3\n....\n1 2\n2 2\n3 1", "2019"], ["5 4\n..0..\n0 2\n00 2\n01 4\n10 3", "11012"], ["18 6\n...2.1.0.1..1.0..1\n011 6\n111 4\n010 12\n121 7\n101 5\n10 3", "121211203112120121"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "各省省选", "北京", "Special Judge", "分数规划", "AC 自动机"], "title": "[BJOI2019] 奥术神杖", "background": "", "description": "Bezorath 大陆抵抗地灾军团入侵的战争进入了僵持的阶段，世世代代生活在 Bezorath 这片大陆的精灵们开始寻找远古时代诸神遗留的神器，试图借助神器的神秘力量帮助她们战胜地灾军团。\n\n在付出了惨痛的代价后，精灵们从步步凶险的远古战场取回了一件保存尚完好的神杖。但在经历过那场所有史书都视为禁忌的“诸神黄昏之战”后，神杖上镶嵌的奥术宝石已经残缺，神力也几乎消耗殆尽。精灵高层在至高会议中决定以举国之力收集残存至今的奥术宝石，并重金悬赏天下能工巧匠修复这件神杖。\n\n你作为神术一脉第五百零一位传人，接受了这个艰巨而神圣的使命。\n神杖上从左到右镶嵌了 $n$ 颗奥术宝石，奥术宝石一共有 $10$ 种，用数字 \"`0123456789`\" 表示。有些位置的宝石已经残缺，用 \"`.`\" 表示，你需要用完好的奥术宝石填补每一处残缺的部分（每种奥术宝石个数不限，且不能够更换未残缺的宝石）。古老的魔法书上记载了 $m$ 种咒语 $(S_i,V_i)$ ，其中 $S_i$ 是一个非空数字串，$V_i$ 是这种组合能够激发的神力。\n\n神杖的初始神力值 $Magic = 1$，每当神杖中出现了连续一段宝石与 $S_i$ 相等时，神力值 $Magic$ 就会乘以 $V_i$。但神杖如果包含了太多咒语就不再纯净导致神力降低：设 $c$ 为神杖包含的咒语个数（若咒语类别相同但出现位置不同视为多次），神杖最终的神力值为 $ \\sqrt[c]{Magic}$。（若 $c = 0$ 则神杖最终神力值为 $1$ ）\n\n例如有两种咒语 $(01,3)$ 、$(10,4)$ ，那么神杖 “`0101`” 的神力值为 $\\sqrt[3]{ 3 \\times 4 \\times 3}$\n\n你需要使修复好的神杖的最终的神力值最大，输出任何一个解即可。", "inputFormat": "第一行两个正整数 $n$ 、$m$ ，表示宝石数和咒语数。\n\n第二行为一个长度为 $n$ 的字符串 $T$ ，表示初始的神杖。\n\n接下来 $m$ 行每行一个非空数字串 $S_i$ 和一个正整数 $V_i$ ，表示每种咒语。", "outputFormat": "输出最终神杖上从左到右镶嵌的宝石，多解时任意输出一个即可。", "hint": "样例 1 ：法杖最终神力值为 $2$ 。\n\n样例 2 ：法杖最终神力值为 $\\sqrt[3]{2 \\times 3 \\times 4}$\n\n设 $s = \\sum_{i=1}^{m} |S_i|$ ，即所有咒语的串长之和。\n![](https://cdn.luogu.com.cn/upload/pic/57052.png)", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Arcane Staff.", "background": "", "description": "The war on the continent of Bezorath against the disaster legion has reached a stalemate. The elves who have lived on Bezorath for generations began searching for ancient artifacts left by the gods, hoping to use their mysterious power to defeat the disaster legion.\n\nAfter paying a painful price, the elves retrieved a well-preserved staff from a perilous ancient battlefield. However, after the “Twilight of the Gods War”, which all history books consider taboo, the arcane gems inlaid on the staff were already damaged, and its divine power was almost completely exhausted. The elf leaders decided, in the Supreme Council, to mobilize the whole nation to collect the remaining arcane gems, and offered a huge reward to craftsmen across the land to repair the staff.\n\nAs the 501st inheritor of the divine arts lineage, you have accepted this difficult and sacred mission.\n\nFrom left to right, the staff has $n$ arcane gems inlaid. There are $10$ types of arcane gems, represented by the digits \"`0123456789`\". Some positions are already damaged, represented by \"`.`\". You need to fill every damaged position using intact arcane gems (the number of each type is unlimited, and you are not allowed to replace gems that are not damaged). An ancient spellbook records $m$ spells $(S_i, V_i)$, where $S_i$ is a non-empty digit string, and $V_i$ is the divine power that this combination can trigger.\n\nThe initial divine power of the staff is $Magic = 1$. Whenever the staff contains a consecutive segment of gems equal to $S_i$, the divine power $Magic$ is multiplied by $V_i$. But if the staff contains too many spells, it becomes impure and its power decreases: let $c$ be the number of spells contained in the staff (if the spell type is the same but appears at different positions, it is counted multiple times). The final divine power of the staff is $\\sqrt[c]{Magic}$. (If $c = 0$, then the final divine power of the staff is $1$.)\n\nFor example, if there are two spells $(01, 3)$ and $(10, 4)$, then the divine power of the staff \"`0101`\" is $\\sqrt[3]{3 \\times 4 \\times 3}$.\n\nYou need to maximize the final divine power of the repaired staff, and output any one solution.", "inputFormat": "The first line contains two positive integers $n$ and $m$, representing the number of gems and the number of spells.\n\nThe second line contains a string $T$ of length $n$, representing the initial staff.\n\nThe next $m$ lines each contain a non-empty digit string $S_i$ and a positive integer $V_i$, representing each spell.", "outputFormat": "Output the gems inlaid on the final staff from left to right. If there are multiple solutions, output any one.", "hint": "Sample 1: the final divine power of the staff is $2$.\n\nSample 2: the final divine power of the staff is $\\sqrt[3]{2 \\times 3 \\times 4}$.\n\nLet $s = \\sum_{i=1}^{m} |S_i|$, i.e. the sum of the lengths of all spell strings.\n\n![](https://cdn.luogu.com.cn/upload/pic/57052.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 奥术神杖", "background": "", "description": "Bezorath 大陆抵抗地灾军团入侵的战争进入了僵持的阶段，世世代代生活在 Bezorath 这片大陆的精灵们开始寻找远古时代诸神遗留的神器，试图借助神器的神秘力量帮助她们战胜地灾军团。\n\n在付出了惨痛的代价后，精灵们从步步凶险的远古战场取回了一件保存尚完好的神杖。但在经历过那场所有史书都视为禁忌的“诸神黄昏之战”后，神杖上镶嵌的奥术宝石已经残缺，神力也几乎消耗殆尽。精灵高层在至高会议中决定以举国之力收集残存至今的奥术宝石，并重金悬赏天下能工巧匠修复这件神杖。\n\n你作为神术一脉第五百零一位传人，接受了这个艰巨而神圣的使命。\n神杖上从左到右镶嵌了 $n$ 颗奥术宝石，奥术宝石一共有 $10$ 种，用数字 \"`0123456789`\" 表示。有些位置的宝石已经残缺，用 \"`.`\" 表示，你需要用完好的奥术宝石填补每一处残缺的部分（每种奥术宝石个数不限，且不能够更换未残缺的宝石）。古老的魔法书上记载了 $m$ 种咒语 $(S_i,V_i)$ ，其中 $S_i$ 是一个非空数字串，$V_i$ 是这种组合能够激发的神力。\n\n神杖的初始神力值 $Magic = 1$，每当神杖中出现了连续一段宝石与 $S_i$ 相等时，神力值 $Magic$ 就会乘以 $V_i$。但神杖如果包含了太多咒语就不再纯净导致神力降低：设 $c$ 为神杖包含的咒语个数（若咒语类别相同但出现位置不同视为多次），神杖最终的神力值为 $ \\sqrt[c]{Magic}$。（若 $c = 0$ 则神杖最终神力值为 $1$ ）\n\n例如有两种咒语 $(01,3)$ 、$(10,4)$ ，那么神杖 “`0101`” 的神力值为 $\\sqrt[3]{ 3 \\times 4 \\times 3}$\n\n你需要使修复好的神杖的最终的神力值最大，输出任何一个解即可。", "inputFormat": "第一行两个正整数 $n$ 、$m$ ，表示宝石数和咒语数。\n\n第二行为一个长度为 $n$ 的字符串 $T$ ，表示初始的神杖。\n\n接下来 $m$ 行每行一个非空数字串 $S_i$ 和一个正整数 $V_i$ ，表示每种咒语。", "outputFormat": "输出最终神杖上从左到右镶嵌的宝石，多解时任意输出一个即可。", "hint": "样例 1 ：法杖最终神力值为 $2$ 。\n\n样例 2 ：法杖最终神力值为 $\\sqrt[3]{2 \\times 3 \\times 4}$\n\n设 $s = \\sum_{i=1}^{m} |S_i|$ ，即所有咒语的串长之和。\n![](https://cdn.luogu.com.cn/upload/pic/57052.png)", "locale": "zh-CN"}}}
{"pid": "P5320", "type": "P", "difficulty": 7, "samples": [["5 2\n2 4 2\n1 10000 501\n52501 233333333333 1\n52501 233333333333 2\n52501 233333333333 50", "665496240\n218802505\n745517510\n133015204\n910014966"], ["5 3\n2 2 2\n1 10000 501\n52501 233333333333 1\n52501 233333333333 2\n52501 233333333333 50", "3\n900767573\n52671648\n600503426\n678428567"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "北京"], "title": "[BJOI2019] 勘破神机", "background": "", "description": "地灾军团的军师黑袍从潜伏在精灵高层的密探手中得知了神杖的情报，他对奥术宝石中蕴含的远古神秘力量十分感兴趣。他设计夺取了数块奥术宝石，并命令作为地灾军团首席科学家的你带领手下的研究人员全力破解。经过了一个月的艰苦尝试，你的研究团队终于破译了 “`2`” 型奥术宝石和 “`3`” 型奥术宝石的内部能量结构。\n\n这两类结构有着一定的相似性，它们的内部具有 $k$ 个反应核心，“`2`” 型奥术宝石的每个核心都可以看成是一个 $2 \\times n$ 的网格，而 “`3`” 型奥术宝石的每个核心都可以看成是一个 $3 \\times n$ 的网格。（注意奥术宝石的 $k$ 和 $n$ 可能不同）当神力反应进行时，每个核心自动填充满神力颗粒。\n\n形式化地描述，每个神力颗粒可以看成是一个 $1 \\times 2$ 横置或竖置的方格，核心填满的定义为每个网格都恰好被一某个方格覆盖。若在两种填满反应核心的方案中存在一个方格放置的位置或方式不同，就认为方案不同。\n\n如填满 $2×4$ 的网格有 $5$ 种不同的方案，填满 $3×2$ 的网格有 $3$ 种不同的方案。\n\n![](https://cdn.luogu.com.cn/upload/pic/57055.png)\n\n如果奥术宝石的 $k$ 个核心的填充方式互不相同，它们就会组合出强大的咒术。黑袍想知道对于某个宝石一共有多少种不同的咒术（对于两种咒术组合，如果第一种咒术中每个核心 $a$ 的填充方式都可以找到第二种咒术的某个核心 $b$ ，使得 $a$ 和 $b$ 的填充方式完全相同，则认为这两种咒术组合相同）。\n\n对于宽度为 $n$ 、反应核心个数为 $k$ 的 “`2`” 型奥术宝石，设不同的咒术为 $F(n,k)$  ；对于宽度为 $n$ 、反应核心个数为 $k$ 的 “`3`” 型奥术宝石，设不同的咒术为 $G(n,k)$  。例如 $F(4,1) = 5$ ，$F(4,2) = 10$ ，$G(2,2) = 3$ 。\n\n地灾军团的科技水平还不能精准测量反应核心的长度 $n$ ，只能确定出核心长度的大致范围  $[l,r]$ 。你需要计算出反应核心长度在此区间内的平均咒术数，即\n\n$$ans2 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} F(n,k)$$\n$$ans3 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} G(n,k)$$\n\n设最终答案的形式为 $\\frac{A}{B}$，输出 $ A \\times B^{-1} \\bmod 998244353$ 的结果，其中 $B^{-1}$ 是 $B$ 在 $998244353$ 下的乘法逆元。", "inputFormat": "第一行为两个正整数 $T$ 、$m$ ，表示数据组数和奥术宝石的类型（只可能为 $2$ 或 $3$ ）。\n\n接下来 $T$ 行每行三个正整数 $l,r,k$ ，表示核心长度的范围与核心数量。", "outputFormat": "对于每组数据，若 $m=2$ 则输出 $ans2$ ，$m=3$ 则输出 $ans3$ 。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57057.png)\n\n对于所有数据，保证不存在 $r-l+1$ 是 $998244353$ 倍数的情况。\n\n由于考场的电脑很慢，出题人更改数据后的所有 $T=1$。\n\n注：本题数据范围有误，实际满足 $1\\leq l\\leq r\\leq 6\\times 10 ^ {18}$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Seeing Through the Secrets of the Divine Mechanism", "background": "", "description": "The strategist of the Geocast Legion, Black Robe, learned information about the Divine Staff from spies infiltrating the upper ranks of the elves. He is very interested in the ancient mysterious power contained in the Arcane Gems. He seized several Arcane Gems and ordered you, the chief scientist of the Geocast Legion, to lead your researchers to crack them with full effort. After a month of hard work, your team finally deciphered the internal energy structures of the “`2`-type” Arcane Gem and the “`3`-type” Arcane Gem.\n\nThese two kinds of structures share some similarities. Each gem contains $k$ reaction cores. Each core of a “`2`-type” Arcane Gem can be seen as a $2 \\times n$ grid, and each core of a “`3`-type” Arcane Gem can be seen as a $3 \\times n$ grid. (Note that $k$ and $n$ may be different for different gems.)\n\nWhen the divine reaction happens, each core is automatically filled with divine particles.\n\nFormally, each divine particle can be viewed as a $1 \\times 2$ domino placed horizontally or vertically. A core is considered filled if every cell of the grid is covered by exactly one domino. If, between two filling plans, there exists at least one domino whose position or orientation is different, then the two plans are considered different.\n\nFor example, there are $5$ different ways to fill a $2 \\times 4$ grid, and $3$ different ways to fill a $3 \\times 2$ grid.\n\n![](https://cdn.luogu.com.cn/upload/pic/57055.png)\n\nIf the filling plans of the $k$ cores in an Arcane Gem are all different from each other, they will combine into a powerful spell. Black Robe wants to know how many different spells a gem can produce. (For two spell combinations, if for every core filling plan $a$ in the first combination, one can find some core filling plan $b$ in the second combination such that $a$ and $b$ are exactly the same, then these two spell combinations are considered the same.)\n\nFor a “`2`-type” Arcane Gem with width $n$ and $k$ reaction cores, let the number of different spells be $F(n,k)$. For a “`3`-type” Arcane Gem with width $n$ and $k$ reaction cores, let the number of different spells be $G(n,k)$. For example, $F(4,1) = 5$, $F(4,2) = 10$, and $G(2,2) = 3$.\n\nThe Geocast Legion’s technology cannot precisely measure the core length $n$, and can only determine an approximate range $[l,r]$. You need to compute the average number of spells when the core length is within this interval, namely:\n\n$$ans2 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} F(n,k)$$\n$$ans3 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} G(n,k)$$\n\nLet the final answer be in the form $\\frac{A}{B}$. Output $A \\times B^{-1} \\bmod 998244353$, where $B^{-1}$ is the multiplicative inverse of $B$ modulo $998244353$.", "inputFormat": "The first line contains two positive integers $T$ and $m$, representing the number of test cases and the type of Arcane Gem (only $2$ or $3$).\n\nThe next $T$ lines each contain three positive integers $l, r, k$, representing the range of core lengths and the number of cores.", "outputFormat": "For each test case, if $m = 2$ output $ans2$; if $m = 3$ output $ans3$.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57057.png)\n\nFor all testdata, it is guaranteed that $r-l+1$ is not a multiple of $998244353$.\n\nBecause the computers in the contest were very slow, after the setter modified the testdata, all cases have $T = 1$.\n\nNote: The Constraints of this problem are incorrect. The actual constraints satisfy $1\\leq l\\leq r\\leq 6\\times 10 ^ {18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 勘破神机", "background": "", "description": "地灾军团的军师黑袍从潜伏在精灵高层的密探手中得知了神杖的情报，他对奥术宝石中蕴含的远古神秘力量十分感兴趣。他设计夺取了数块奥术宝石，并命令作为地灾军团首席科学家的你带领手下的研究人员全力破解。经过了一个月的艰苦尝试，你的研究团队终于破译了 “`2`” 型奥术宝石和 “`3`” 型奥术宝石的内部能量结构。\n\n这两类结构有着一定的相似性，它们的内部具有 $k$ 个反应核心，“`2`” 型奥术宝石的每个核心都可以看成是一个 $2 \\times n$ 的网格，而 “`3`” 型奥术宝石的每个核心都可以看成是一个 $3 \\times n$ 的网格。（注意奥术宝石的 $k$ 和 $n$ 可能不同）当神力反应进行时，每个核心自动填充满神力颗粒。\n\n形式化地描述，每个神力颗粒可以看成是一个 $1 \\times 2$ 横置或竖置的方格，核心填满的定义为每个网格都恰好被一某个方格覆盖。若在两种填满反应核心的方案中存在一个方格放置的位置或方式不同，就认为方案不同。\n\n如填满 $2×4$ 的网格有 $5$ 种不同的方案，填满 $3×2$ 的网格有 $3$ 种不同的方案。\n\n![](https://cdn.luogu.com.cn/upload/pic/57055.png)\n\n如果奥术宝石的 $k$ 个核心的填充方式互不相同，它们就会组合出强大的咒术。黑袍想知道对于某个宝石一共有多少种不同的咒术（对于两种咒术组合，如果第一种咒术中每个核心 $a$ 的填充方式都可以找到第二种咒术的某个核心 $b$ ，使得 $a$ 和 $b$ 的填充方式完全相同，则认为这两种咒术组合相同）。\n\n对于宽度为 $n$ 、反应核心个数为 $k$ 的 “`2`” 型奥术宝石，设不同的咒术为 $F(n,k)$  ；对于宽度为 $n$ 、反应核心个数为 $k$ 的 “`3`” 型奥术宝石，设不同的咒术为 $G(n,k)$  。例如 $F(4,1) = 5$ ，$F(4,2) = 10$ ，$G(2,2) = 3$ 。\n\n地灾军团的科技水平还不能精准测量反应核心的长度 $n$ ，只能确定出核心长度的大致范围  $[l,r]$ 。你需要计算出反应核心长度在此区间内的平均咒术数，即\n\n$$ans2 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} F(n,k)$$\n$$ans3 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} G(n,k)$$\n\n设最终答案的形式为 $\\frac{A}{B}$，输出 $ A \\times B^{-1} \\bmod 998244353$ 的结果，其中 $B^{-1}$ 是 $B$ 在 $998244353$ 下的乘法逆元。", "inputFormat": "第一行为两个正整数 $T$ 、$m$ ，表示数据组数和奥术宝石的类型（只可能为 $2$ 或 $3$ ）。\n\n接下来 $T$ 行每行三个正整数 $l,r,k$ ，表示核心长度的范围与核心数量。", "outputFormat": "对于每组数据，若 $m=2$ 则输出 $ans2$ ，$m=3$ 则输出 $ans3$ 。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57057.png)\n\n对于所有数据，保证不存在 $r-l+1$ 是 $998244353$ 倍数的情况。\n\n由于考场的电脑很慢，出题人更改数据后的所有 $T=1$。\n\n注：本题数据范围有误，实际满足 $1\\leq l\\leq r\\leq 6\\times 10 ^ {18}$。", "locale": "zh-CN"}}}
{"pid": "P5321", "type": "P", "difficulty": 7, "samples": [["3 3 4\n0 0\n1 0\n0 0\n1 0 1\n0 0 1\n3 3 0 3 1 0 0 3 1 3 0\n1 2 1 2 0\n2 1 0 1 1\n3 2 2 2 3 1 1 2 1 3 0", "11\n16"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "北京"], "title": "[BJOI2019] 送别", "background": "", "description": "法珞是个怕黑的女孩子。\n\n傍晚了，法珞所参加的学术会议早已散会。黎瑟也下了课过来接法珞回火车站。\n\n但是教学楼里突然断电了，法珞陷入了一片漆黑之中。\n\n好在黎瑟已经到了教学楼的同一层。\n\n然而由于教学楼的结构过于复杂，她们已经记不起教学楼的具体结构了。\n黎瑟学校的教学楼每层的结构都非常工整。\n\n形式化地说，教学楼的一层的平面结构可以画在二维平面上以 $(0,0)$ 为左上角顶点，$(n,m)$ 为右下角顶点的子矩形（记为 $(0,0) - (n,m)$  的矩形）里，这个子矩形的四条边是教学楼的楼体(或者说是四段已知一定存在的墙)。\n\n**请注意，本题中的坐标系和普通的平面直角坐标系不同，$(0,0)$ 是左上角的顶点而 $(n,m)$ 是右下角的顶点。 $(i,j)$ 表示的是第 $i+1$ 行第 $j+1$ 列的顶点而不是横坐标为 $i$ 纵坐标为 $j$ 的顶点。**\n\n每一段墙（无法通过的部分）是一条端点为 $(i,j)$ 和 $(i',j')$ 的线段，记作 $(i,j) - (i',j')$ 的墙，其中 $|i-i'| + |j-j'| =1$ 且 $i,i'$ 是 $[0,n]$ 中的整数， $j,j'$ 是 $[0,m]$ 中的整数（每当我们之后使用 $(i,j) - (i',j')$ 的记法，我们都保证满足上述所有条件）。\n\n法珞知道，对于这种结构，有一种办法可能让她找到黎瑟：法珞用左手扶住墙，手臂和墙面垂直，保持这个状态向前方走，在转弯处也保持左手一直扶墙的状态。按照这个方法她就可以环绕一周，可能与黎瑟相遇。\n\n![](https://cdn.luogu.com.cn/upload/pic/57058.png)\n\n上图是样例输入中第一次询问的法珞的行走方案，在行走过程中法珞的左手必须贴住墙。\n\n法珞一开始会给你需要维护的初始的(这层楼的)结构，之后会给你 $q$ 个请求。\n\n+ 操作 1 ： 读入格式形如 $1 \\ x_0 \\ y_0 \\ x_1 \\ y_1$：法珞请求在当前结构里添加一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙不存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。\n\n+ 操作2： 读入格式形如 $2 \\ x_0 \\ y_0 \\ x_1 \\ y_1$：法珞请求在当前结构里删除一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。\n\n+ 操作3： 读入格式形如 $3\\ x_0 \\ y_0 \\ x_1\\ y_1\\ d_0 \\ x_2 \\ y_2 \\ x_3 \\ y_3 \\ d_1$ ：法珞当前在 $(x_0,y_0) - (x_1,y_1)$ 的墙的中点位置 $(\\frac{x0+x1}{2},\\frac{y_0 + y_1}{2})$ ， $d_0$ 是一个 $[0,1]$ 中的整数，用来描述法珞在墙的哪一侧， $d_0  = 0$ 代表法珞在墙的左方/上方， $d_0 = 1$ 代表右方/下方。黎瑟当前在 $(x_2,y_2) - (x_3,y_3)$ 的墙的中点位置  $(\\frac{x2+x3}{2},\\frac{y_2+y_3}{2})$ 。 $d_1$ 的格式和 $d_0$ 相同。保证 $(x_0,y_0) - (x_1,y_1)$ 和 $(x_2,y_2) - (x_3,y_3)$ 这两段墙存在，且法珞和黎瑟的位置都落在 $(0,0) - (n,m)$ 的子矩形的内部。求法珞按照题目所述的方法找到黎瑟要走过多少长度（ $(i,j) - (i',j')$  这段墙的长度为 $1$，半段墙（由于起点和终点都在墙的中点处）的长度是  $\\frac{1}{2}$ ）。\n\n", "inputFormat": "输入共 $2n+q$ 行。\n\n第一行三个整数 $n$ 、$m$ 、$q$ ，意义如题目中所示。\n\n接下来的 $n$ 行，每行 $m-1$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i-1,j)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i - 1,j)$ 这一段没有墙。\n\n接下来的 $n-1$ 行，每行 $m$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i,j-1)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i,j-1)$ 这一段没有墙。\n\n接下来的 $q$ 行，每行一个操作，格式如题目中所示。", "outputFormat": "对于每个询问，输出法珞按照题目所述的方法找到黎瑟要走过多少长度，**如果法珞按照题目所述的方法无法找到黎瑟则输出 $-1$ 。**", "hint": "对于 10% 的数据， $5 \\le n,m \\le 50$ ， $1 \\le q \\le  2000$ 。\n\n对于另外 30% 的数据，没有 1 操作。\n\n对于另外 30% 的数据，保证在任意时刻若法珞和黎瑟站在任意输入格式中合法的位置，法珞都可以和黎瑟相遇。\n\n对于100%的数据，$5 \\le n,m \\le 500$ ， $1 \\le q \\le 2 \\times 10^5$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Farewell", "background": "", "description": "Falo is a girl who is afraid of the dark.\n\nIt is evening. The academic conference that Falo attended has already ended. Lise also finished class and came to pick Falo up to go to the train station.\n\nHowever, the teaching building suddenly lost power, and Falo was surrounded by darkness.\n\nLuckily, Lise has already arrived on the same floor of the teaching building.\n\nBut because the structure of the building is too complex, they can no longer remember the exact layout of this floor. The teaching building in Lise's school has a very regular layout on each floor.\n\nFormally, the planar layout of one floor can be drawn on a 2D plane inside the sub-rectangle with $(0,0)$ as the upper-left corner and $(n,m)$ as the lower-right corner (denoted as the rectangle $(0,0) - (n,m)$). The four sides of this sub-rectangle are the outer walls of the building (i.e. four wall segments that are guaranteed to exist).\n\n**Note that the coordinate system in this problem is different from the standard Cartesian coordinate system: $(0,0)$ is the upper-left corner and $(n,m)$ is the lower-right corner. $(i,j)$ denotes the vertex in the $(i+1)$-th row and $(j+1)$-th column, not the point with x-coordinate $i$ and y-coordinate $j$.**\n\nEach wall segment (an impassable part) is a line segment with endpoints $(i,j)$ and $(i',j')$, denoted as the wall $(i,j) - (i',j')$, where $|i-i'| + |j-j'| = 1$, and $i,i'$ are integers in $[0,n]$, while $j,j'$ are integers in $[0,m]$ (whenever we later use the notation $(i,j) - (i',j')$, we guarantee that all the above conditions are satisfied).\n\nFalo knows that for such a layout, there is a method that might allow her to find Lise: Falo places her left hand on the wall, with her arm perpendicular to the wall, and keeps walking forward in this state; at turns she also keeps her left hand on the wall. By doing so, she can walk around one loop and may meet Lise.\n\n![](https://cdn.luogu.com.cn/upload/pic/57058.png)\n\nThe figure above shows Falo's walking route for the first query in the sample input. During the walk, Falo's left hand must stay in contact with the wall.\n\nInitially, Falo gives you the initial structure (of this floor) that needs to be maintained, and then there will be $q$ requests.\n\n- Operation 1: input format $1 \\ x_0 \\ y_0 \\ x_1 \\ y_1$. Falo requests to add a wall segment $(x_0,y_0) - (x_1,y_1)$ to the current structure. It is guaranteed that this wall did not exist before, and it is not on the four sides of the rectangle $(0,0) - (n,m)$.\n\n- Operation 2: input format $2 \\ x_0 \\ y_0 \\ x_1 \\ y_1$. Falo requests to delete a wall segment $(x_0,y_0) - (x_1,y_1)$ from the current structure. It is guaranteed that this wall existed before, and it is not on the four sides of the rectangle $(0,0) - (n,m)$.\n\n- Operation 3: input format $3\\ x_0 \\ y_0 \\ x_1\\ y_1\\ d_0 \\ x_2 \\ y_2 \\ x_3 \\ y_3 \\ d_1$. Falo is currently at the midpoint of the wall $(x_0,y_0) - (x_1,y_1)$, i.e. $\\left(\\frac{x0+x1}{2},\\frac{y_0 + y_1}{2}\\right)$. $d_0$ is an integer in $[0,1]$ describing which side of the wall Falo is on: $d_0 = 0$ means Falo is on the left/upper side of the wall, and $d_0 = 1$ means on the right/lower side. Lise is currently at the midpoint of the wall $(x_2,y_2) - (x_3,y_3)$, i.e. $\\left(\\frac{x2+x3}{2},\\frac{y_2+y_3}{2}\\right)$. The meaning of $d_1$ is the same as $d_0$. It is guaranteed that both wall segments $(x_0,y_0) - (x_1,y_1)$ and $(x_2,y_2) - (x_3,y_3)$ exist, and both positions of Falo and Lise are strictly inside the rectangle $(0,0) - (n,m)$. Compute how much total length Falo needs to walk to find Lise using the method described above (the length of a wall segment $(i,j) - (i',j')$ is $1$, and the length of a half wall segment (since both the start and end are at midpoints) is $\\frac{1}{2}$).", "inputFormat": "There are a total of $2n+q$ lines of input.\n\nThe first line contains three integers $n$, $m$, $q$, with meanings as described above.\n\nThe next $n$ lines each contain $m-1$ integers in $[0,1]$. The integer in row $i$ and column $j$ is $1$ if the segment $(i,j) - (i-1,j)$ has a wall, and $0$ otherwise.\n\nThe next $n-1$ lines each contain $m$ integers in $[0,1]$. The integer in row $i$ and column $j$ is $1$ if the segment $(i,j) - (i,j-1)$ has a wall, and $0$ otherwise.\n\nThe next $q$ lines each describe one operation, in the format given above.", "outputFormat": "For each query, output the total length Falo needs to walk to find Lise using the method described above. **If Falo cannot find Lise using the method described above, output $-1$.**", "hint": "For 10% of the data, $5 \\le n,m \\le 50$, $1 \\le q \\le 2000$.\n\nFor another 30% of the data, there is no operation of type 1.\n\nFor another 30% of the data, it is guaranteed that at any time, if Falo and Lise stand at any valid positions given by the input format, then Falo can meet Lise.\n\nFor 100% of the data, $5 \\le n,m \\le 500$, $1 \\le q \\le 2 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 送别", "background": "", "description": "法珞是个怕黑的女孩子。\n\n傍晚了，法珞所参加的学术会议早已散会。黎瑟也下了课过来接法珞回火车站。\n\n但是教学楼里突然断电了，法珞陷入了一片漆黑之中。\n\n好在黎瑟已经到了教学楼的同一层。\n\n然而由于教学楼的结构过于复杂，她们已经记不起教学楼的具体结构了。\n黎瑟学校的教学楼每层的结构都非常工整。\n\n形式化地说，教学楼的一层的平面结构可以画在二维平面上以 $(0,0)$ 为左上角顶点，$(n,m)$ 为右下角顶点的子矩形（记为 $(0,0) - (n,m)$  的矩形）里，这个子矩形的四条边是教学楼的楼体(或者说是四段已知一定存在的墙)。\n\n**请注意，本题中的坐标系和普通的平面直角坐标系不同，$(0,0)$ 是左上角的顶点而 $(n,m)$ 是右下角的顶点。 $(i,j)$ 表示的是第 $i+1$ 行第 $j+1$ 列的顶点而不是横坐标为 $i$ 纵坐标为 $j$ 的顶点。**\n\n每一段墙（无法通过的部分）是一条端点为 $(i,j)$ 和 $(i',j')$ 的线段，记作 $(i,j) - (i',j')$ 的墙，其中 $|i-i'| + |j-j'| =1$ 且 $i,i'$ 是 $[0,n]$ 中的整数， $j,j'$ 是 $[0,m]$ 中的整数（每当我们之后使用 $(i,j) - (i',j')$ 的记法，我们都保证满足上述所有条件）。\n\n法珞知道，对于这种结构，有一种办法可能让她找到黎瑟：法珞用左手扶住墙，手臂和墙面垂直，保持这个状态向前方走，在转弯处也保持左手一直扶墙的状态。按照这个方法她就可以环绕一周，可能与黎瑟相遇。\n\n![](https://cdn.luogu.com.cn/upload/pic/57058.png)\n\n上图是样例输入中第一次询问的法珞的行走方案，在行走过程中法珞的左手必须贴住墙。\n\n法珞一开始会给你需要维护的初始的(这层楼的)结构，之后会给你 $q$ 个请求。\n\n+ 操作 1 ： 读入格式形如 $1 \\ x_0 \\ y_0 \\ x_1 \\ y_1$：法珞请求在当前结构里添加一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙不存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。\n\n+ 操作2： 读入格式形如 $2 \\ x_0 \\ y_0 \\ x_1 \\ y_1$：法珞请求在当前结构里删除一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。\n\n+ 操作3： 读入格式形如 $3\\ x_0 \\ y_0 \\ x_1\\ y_1\\ d_0 \\ x_2 \\ y_2 \\ x_3 \\ y_3 \\ d_1$ ：法珞当前在 $(x_0,y_0) - (x_1,y_1)$ 的墙的中点位置 $(\\frac{x0+x1}{2},\\frac{y_0 + y_1}{2})$ ， $d_0$ 是一个 $[0,1]$ 中的整数，用来描述法珞在墙的哪一侧， $d_0  = 0$ 代表法珞在墙的左方/上方， $d_0 = 1$ 代表右方/下方。黎瑟当前在 $(x_2,y_2) - (x_3,y_3)$ 的墙的中点位置  $(\\frac{x2+x3}{2},\\frac{y_2+y_3}{2})$ 。 $d_1$ 的格式和 $d_0$ 相同。保证 $(x_0,y_0) - (x_1,y_1)$ 和 $(x_2,y_2) - (x_3,y_3)$ 这两段墙存在，且法珞和黎瑟的位置都落在 $(0,0) - (n,m)$ 的子矩形的内部。求法珞按照题目所述的方法找到黎瑟要走过多少长度（ $(i,j) - (i',j')$  这段墙的长度为 $1$，半段墙（由于起点和终点都在墙的中点处）的长度是  $\\frac{1}{2}$ ）。\n\n", "inputFormat": "输入共 $2n+q$ 行。\n\n第一行三个整数 $n$ 、$m$ 、$q$ ，意义如题目中所示。\n\n接下来的 $n$ 行，每行 $m-1$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i-1,j)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i - 1,j)$ 这一段没有墙。\n\n接下来的 $n-1$ 行，每行 $m$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i,j-1)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i,j-1)$ 这一段没有墙。\n\n接下来的 $q$ 行，每行一个操作，格式如题目中所示。", "outputFormat": "对于每个询问，输出法珞按照题目所述的方法找到黎瑟要走过多少长度，**如果法珞按照题目所述的方法无法找到黎瑟则输出 $-1$ 。**", "hint": "对于 10% 的数据， $5 \\le n,m \\le 50$ ， $1 \\le q \\le  2000$ 。\n\n对于另外 30% 的数据，没有 1 操作。\n\n对于另外 30% 的数据，保证在任意时刻若法珞和黎瑟站在任意输入格式中合法的位置，法珞都可以和黎瑟相遇。\n\n对于100%的数据，$5 \\le n,m \\le 500$ ， $1 \\le q \\le 2 \\times 10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P5322", "type": "P", "difficulty": 4, "samples": [["1 3 10\n2 2 6", "3"], ["2 3 10\n2 2 6\n0 0 0", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2019", "各省省选", "北京", "O2优化", "背包 DP"], "title": "[BJOI2019] 排兵布阵", "background": null, "description": "小 C 正在玩一款排兵布阵的游戏。在游戏中有 $n$ 座城堡，每局对战由两名玩家来争夺这些城堡。每名玩家有 $m$ 名士兵，可以向第 $i$ 座城堡派遣 $a_i$ 名士兵去争夺这个城堡，使得总士兵数不超过 $m$。   \n\n如果一名玩家向第 $i$ 座城堡派遣的士兵数**严格**大于对手派遣士兵数的两倍，那么这名玩家就占领了这座城堡，获得 $i$ 分。  \n\n现在小 C 即将和其他 $s$ 名玩家两两对战，这 $s$ 场对决的派遣士兵方案必须相同。小 C 通过某些途径得知了其他 $s$ 名玩家即将使用的策略，他想知道他应该使用什么策略来最大化自己的总分。   \n\n由于答案可能不唯一，你只需要输出小 C 总分的最大值。", "inputFormat": "输入第一行包含三个正整数 $s,n,m$，分别表示除了小 C 以外的玩家人数、城堡数和每名玩家拥有的士兵数。\n\n接下来 $s$ 行，每行 $n$ 个非负整数，表示一名玩家的策略。其中第 $i$ 个数 $a_i$ 表示这名玩家向第 $i$ 座城堡派遣的士兵数。", "outputFormat": "输出一行一个非负整数，表示小 C 获得的最大得分。", "hint": "### 样例 1 解释  \n\n小 C 的最佳策略为向第 $1$ 座城堡和第 $2$ 座城堡各派遣 $5$ 名士兵。 \n\n### 样例 2 解释\n  \n小 C 的最佳策略之一为向第 $1$ 座城堡派遣 $2$ 名士兵，向第 $2$ 座城堡派遣 $5$ 名士兵，向第 $3$ 座城堡派遣 $1$ 名士兵。  \n\n### 数据范围\n\n对于 $10\\%$ 的数据：$s=1,n \\le 3,m \\le 10$；\n\n对于 $20\\%$ 的数据：$s=1,n \\le 10,m \\le 100$；\n\n对于 $40\\%$ 的数据：$n\\le 10,m\\le 100$；\n\n对于另外 $20\\%$ 的数据：$s=1$；\n\n对于 $100\\%$ 的数据：$1\\le s \\le 100$，$1\\le n \\le 100$，$1\\le m \\le 2\\times 10^4$。对于每名玩家，保证 $a_i \\ge 0$，$\\sum\\limits_{i=1}^n a_i \\le m$", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Troop Deployment", "background": "", "description": "Xiao C is playing a troop deployment game. In the game, there are $n$ castles, and each match is a battle between two players competing for these castles. Each player has $m$ soldiers, and may send $a_i$ soldiers to the $i$-th castle to compete for it, as long as the total number of soldiers sent does not exceed $m$.\n\nIf the number of soldiers a player sends to the $i$-th castle is **strictly** greater than twice the number sent by the opponent, then the player occupies this castle and gains $i$ points.\n\nNow Xiao C is going to play head-to-head matches against another $s$ players. The troop deployment plan used in these $s$ matches must be the same. Through some means, Xiao C has learned the strategies that the other $s$ players are going to use, and he wants to know what strategy he should use to maximize his total score.\n\nSince the answer may not be unique, you only need to output the maximum possible total score of Xiao C.", "inputFormat": "The first line contains three positive integers $s,n,m$, representing the number of players other than Xiao C, the number of castles, and the number of soldiers each player has.\n\nThe next $s$ lines each contain $n$ non-negative integers, describing one player’s strategy. The $i$-th number $a_i$ means the number of soldiers this player sends to the $i$-th castle.", "outputFormat": "Output one line with one non-negative integer, representing the maximum score Xiao C can obtain.", "hint": "**Explanation for Sample 1:**  \nXiao C’s best strategy is to send $5$ soldiers to the $1$-st castle and $5$ soldiers to the $2$-nd castle.\n\n**Explanation for Sample 2:**  \nOne of Xiao C’s best strategies is to send $2$ soldiers to the $1$-st castle, $5$ soldiers to the $2$-nd castle, and $1$ soldier to the $3$-rd castle.\n\n**Constraints:**  \nFor $10\\%$ of the testdata: $s=1,n \\le 3,m \\le 10$.  \nFor $20\\%$ of the testdata: $s=1,n \\le 10,m \\le 100$.  \nFor $40\\%$ of the testdata: $n \\le 10,m \\le 100$.  \nFor another $20\\%$ of the testdata: $s=1$.  \nFor $100\\%$ of the testdata:  \n$1 \\le s \\le 100$.  \n$1 \\le n \\le 100$.  \n$1 \\le m \\le 20000$.  \nFor each player, $a_i \\ge 0$, and $\\sum\\limits_{i=1}^n a_i \\le m$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 排兵布阵", "background": null, "description": "小 C 正在玩一款排兵布阵的游戏。在游戏中有 $n$ 座城堡，每局对战由两名玩家来争夺这些城堡。每名玩家有 $m$ 名士兵，可以向第 $i$ 座城堡派遣 $a_i$ 名士兵去争夺这个城堡，使得总士兵数不超过 $m$。   \n\n如果一名玩家向第 $i$ 座城堡派遣的士兵数**严格**大于对手派遣士兵数的两倍，那么这名玩家就占领了这座城堡，获得 $i$ 分。  \n\n现在小 C 即将和其他 $s$ 名玩家两两对战，这 $s$ 场对决的派遣士兵方案必须相同。小 C 通过某些途径得知了其他 $s$ 名玩家即将使用的策略，他想知道他应该使用什么策略来最大化自己的总分。   \n\n由于答案可能不唯一，你只需要输出小 C 总分的最大值。", "inputFormat": "输入第一行包含三个正整数 $s,n,m$，分别表示除了小 C 以外的玩家人数、城堡数和每名玩家拥有的士兵数。\n\n接下来 $s$ 行，每行 $n$ 个非负整数，表示一名玩家的策略。其中第 $i$ 个数 $a_i$ 表示这名玩家向第 $i$ 座城堡派遣的士兵数。", "outputFormat": "输出一行一个非负整数，表示小 C 获得的最大得分。", "hint": "### 样例 1 解释  \n\n小 C 的最佳策略为向第 $1$ 座城堡和第 $2$ 座城堡各派遣 $5$ 名士兵。 \n\n### 样例 2 解释\n  \n小 C 的最佳策略之一为向第 $1$ 座城堡派遣 $2$ 名士兵，向第 $2$ 座城堡派遣 $5$ 名士兵，向第 $3$ 座城堡派遣 $1$ 名士兵。  \n\n### 数据范围\n\n对于 $10\\%$ 的数据：$s=1,n \\le 3,m \\le 10$；\n\n对于 $20\\%$ 的数据：$s=1,n \\le 10,m \\le 100$；\n\n对于 $40\\%$ 的数据：$n\\le 10,m\\le 100$；\n\n对于另外 $20\\%$ 的数据：$s=1$；\n\n对于 $100\\%$ 的数据：$1\\le s \\le 100$，$1\\le n \\le 100$，$1\\le m \\le 2\\times 10^4$。对于每名玩家，保证 $a_i \\ge 0$，$\\sum\\limits_{i=1}^n a_i \\le m$", "locale": "zh-CN"}}}
{"pid": "P5323", "type": "P", "difficulty": 6, "samples": [["2\n50 20\n80 5", "858585865"], ["3\n1 2\n3 4\n5 6", "843334849"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2019", "各省省选", "北京", "O2优化"], "title": "[BJOI2019] 光线", "background": "", "description": "当一束光打到一层玻璃上时，有一定比例的光会穿过这层玻璃，一定比例的光会被反射回去，剩下的光被玻璃吸收。  \n\n设对于任意 $x$，有 $x \\times a_i\\%$ 单位的光会穿过它，有 $x \\times b_i\\%$ 的会被反射回去。  \n现在 $n$ 层玻璃叠在一起，有 $1$ 单位的光打到第 $1$ 层玻璃上，那么有多少单位的光能穿过**所有** $n$ 层玻璃呢？\n", "inputFormat": "第一行一个正整数 $n$，表示玻璃层数。  \n接下来 $n$ 行，每行两个非负整数 $a_i,b_i$，表示第 $i$ 层玻璃的透光率和反射率。", "outputFormat": "输出一行一个整数，表示穿透所有玻璃的光对 $10^9 + 7$ 取模的结果。  \n可以证明，答案一定为有理数。设答案为 $a/b$ ( $a$ 和 $b$ 是互质的正整数)，你输出的答案为 $x$，你需要保证 $a\\equiv bx \\space (\\text{mod }10^9 + 7)$。", "hint": "**样例1解释：**  \n![](https://cdn.luogu.com.cn/upload/pic/57125.png)   \n如图，光线从左上角打进来，有 $0.5$ 单位的光穿过第 $1$ 层玻璃，有 $0.2$ 单位的光被反射回去。这 $0.5$ 单位的光有 $0.4$ 单位穿过第 $2$ 层玻璃，有 $0.025$ 单位的光被反射回去。这 $0.025$ 单位的光有 $0.0125$ 单位穿过第 $1$ 层玻璃，有 $0.005$ 单位的光被反射回去。这 $0.005$ 单位的光有 $0.004$ 单位穿过第 $2$ 层玻璃……于是，穿过两层玻璃的光一共有$0.40404... = 40/99$ 单位。在模 $10^9+7$ 意义下等于 $858585865$。 \n\n**数据范围：**  \n对于 $5\\%$ 的数据，$n=1$；    \n对于 $20\\%$ 的数据，$n\\le 2$；    \n对于 $30\\%$ 的数据，$n\\le 3$；    \n对于 $50\\%$ 的数据，$n\\le 100$；    \n对于 $70\\%$ 的数据，$n\\le 3000$；    \n对于 $100\\%$ 的数据，$n\\le 5\\times 10^5$，$1\\le a_i \\le 100$，$0\\le b_i \\le 99$，$1\\le a_i+b_i \\le 100$。  \n\n每组 $a_i$ 和 $b_i$ 在满足上述限制的整数中随机生成。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Light Ray", "background": "", "description": "When a beam of light hits a layer of glass, a certain proportion of the light will pass through the glass, a certain proportion will be reflected back, and the rest will be absorbed by the glass.\n\nSuppose for any $x$, $x \\times a_i\\%$ units of light will pass through it, and $x \\times b_i\\%$ will be reflected back.\nNow there are $n$ layers of glass stacked together. If $1$ unit of light hits the $1$st layer of glass, how many units of light can pass through **all** $n$ layers of glass?", "inputFormat": "The first line contains a positive integer $n$, representing the number of glass layers.  \nThe next $n$ lines each contain two non-negative integers $a_i, b_i$, representing the transmittance and reflectance of the $i$-th layer.", "outputFormat": "Output one line containing one integer, representing the amount of light that passes through all the glass layers modulo $10^9 + 7$.  \nIt can be proven that the answer must be a rational number. Let the answer be $a/b$ (where $a$ and $b$ are coprime positive integers). If the value you output is $x$, you need to ensure that $a \\equiv bx \\space (\\text{mod }10^9 + 7)$.", "hint": "**Explanation for Sample 1:**  \n![](https://cdn.luogu.com.cn/upload/pic/57125.png)  \nAs shown in the figure, the light ray enters from the upper-left corner. There are $0.5$ units of light passing through the $1$st layer of glass, and $0.2$ units of light being reflected back. Of these $0.5$ units of light, $0.4$ units pass through the $2$nd layer of glass, and $0.025$ units of light are reflected back. Of these $0.025$ units of light, $0.0125$ units pass through the $1$st layer of glass, and $0.005$ units of light are reflected back. Of these $0.005$ units of light, $0.004$ units pass through the $2$nd layer of glass... Therefore, the total amount of light passing through the two layers of glass is $0.40404... = 40/99$ units. Modulo $10^9+7$, this equals $858585865$.\n\n**Constraints:**  \nFor $5\\%$ of the testdata, $n=1$;  \nFor $20\\%$ of the testdata, $n \\le 2$;  \nFor $30\\%$ of the testdata, $n \\le 3$;  \nFor $50\\%$ of the testdata, $n \\le 100$;  \nFor $70\\%$ of the testdata, $n \\le 3000$;  \nFor $100\\%$ of the testdata, $n \\le 5\\times 10^5$, $1 \\le a_i \\le 100$, $0 \\le b_i \\le 99$, $1 \\le a_i+b_i \\le 100$.\n\nIn each group, $a_i$ and $b_i$ are generated randomly among integers that satisfy the above constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 光线", "background": "", "description": "当一束光打到一层玻璃上时，有一定比例的光会穿过这层玻璃，一定比例的光会被反射回去，剩下的光被玻璃吸收。  \n\n设对于任意 $x$，有 $x \\times a_i\\%$ 单位的光会穿过它，有 $x \\times b_i\\%$ 的会被反射回去。  \n现在 $n$ 层玻璃叠在一起，有 $1$ 单位的光打到第 $1$ 层玻璃上，那么有多少单位的光能穿过**所有** $n$ 层玻璃呢？\n", "inputFormat": "第一行一个正整数 $n$，表示玻璃层数。  \n接下来 $n$ 行，每行两个非负整数 $a_i,b_i$，表示第 $i$ 层玻璃的透光率和反射率。", "outputFormat": "输出一行一个整数，表示穿透所有玻璃的光对 $10^9 + 7$ 取模的结果。  \n可以证明，答案一定为有理数。设答案为 $a/b$ ( $a$ 和 $b$ 是互质的正整数)，你输出的答案为 $x$，你需要保证 $a\\equiv bx \\space (\\text{mod }10^9 + 7)$。", "hint": "**样例1解释：**  \n![](https://cdn.luogu.com.cn/upload/pic/57125.png)   \n如图，光线从左上角打进来，有 $0.5$ 单位的光穿过第 $1$ 层玻璃，有 $0.2$ 单位的光被反射回去。这 $0.5$ 单位的光有 $0.4$ 单位穿过第 $2$ 层玻璃，有 $0.025$ 单位的光被反射回去。这 $0.025$ 单位的光有 $0.0125$ 单位穿过第 $1$ 层玻璃，有 $0.005$ 单位的光被反射回去。这 $0.005$ 单位的光有 $0.004$ 单位穿过第 $2$ 层玻璃……于是，穿过两层玻璃的光一共有$0.40404... = 40/99$ 单位。在模 $10^9+7$ 意义下等于 $858585865$。 \n\n**数据范围：**  \n对于 $5\\%$ 的数据，$n=1$；    \n对于 $20\\%$ 的数据，$n\\le 2$；    \n对于 $30\\%$ 的数据，$n\\le 3$；    \n对于 $50\\%$ 的数据，$n\\le 100$；    \n对于 $70\\%$ 的数据，$n\\le 3000$；    \n对于 $100\\%$ 的数据，$n\\le 5\\times 10^5$，$1\\le a_i \\le 100$，$0\\le b_i \\le 99$，$1\\le a_i+b_i \\le 100$。  \n\n每组 $a_i$ 和 $b_i$ 在满足上述限制的整数中随机生成。", "locale": "zh-CN"}}}
{"pid": "P5324", "type": "P", "difficulty": 6, "samples": [["3 9\n1 2 3\n1 1\n0 1\n0 1\n0 1\n2 2\n3 2\n0 -1\n0 -1\n0 -1", "0\n1\n2\n3\n2\n1\n1\n2\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "线段树", "各省省选", "北京", "O2优化"], "title": "[BJOI2019] 删数", "background": null, "description": "对于任意一个数列，如果能在有限次进行下列删数操作后将其删为空数列，则称这个数列可以删空。一次删数操作定义如下：  \n>记当前数列长度为 $k$ ，则删掉数列中所有等于 $k$ 的数。  \n\n现有一个长度为 $n$ 的数列 $a$，有 $m$ 次修改操作，第 $i$ 次修改后你要回答：  \n经过 $i$ 次修改后的数列 $a$，至少还需要修改几个数才可删空？  \n\n每次修改操作为单点修改或数列整体加一或数列整体减一。", "inputFormat": "第一行两个正整数 $n,m$，分别表示数列长度、修改次数。  \n第二行有 $n$ 个正整数，表示数列 $a$，即输入的第 $i$ 个数表示数列 $a$ 的第 $i$ 个数 $a_i$。   \n\n接下来 $m$ 行，每行两个整数 $p,x$，表示一次修改操作。  \n当 $1\\le p \\le n$ 时，该操作为单点修改，将数列中第 $p$ 个数 $a_p$ 修改为 $x$  \n当 $p=0$ 时，该操作为数列整体加 $x$。", "outputFormat": "输出 $m$ 行，每行一个整数，第 $i$ 行表示前 $i$ 次修改后的答案。", "hint": "**样例解释(局部)：**     \n第一次修改后，数列为 $(1, 2, 3)$，无需修改即可删空。   \n第四次修改后，数列为 $(4, 5, 6)$，需要将三个数都改掉才可能删空。   \n第六次修改后，数列为 $(4, 2, 2)$，将第一个数改成 $3$ 即可删空。   \n第九次修改后，数列为 $(1, -1, -1)$，可以将第二个数改成 $2$、第三个数改成 $3$ 来删空。   \n\n**数据范围：**   \n对于 $100\\%$ 的数据：      \n- $1\\le n,m \\le 150000, 1\\le a_i \\le n, 0\\le p\\le n$  \n- $p>0$ 时，$1\\le x \\le n$  \n- $p=0$ 时，$x\\in \\{-1, 1\\}$    \n![](https://cdn.luogu.com.cn/upload/pic/57129.png)", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Deleting Numbers", "background": "", "description": "For any sequence, if it can be deleted into an empty sequence after performing the following delete operation a finite number of times, then the sequence is said to be deletable to empty.\n\nOne delete operation is defined as follows:\n> Let the current sequence length be $k$. Then delete all numbers in the sequence that are equal to $k$.\n\nNow there is a sequence $a$ of length $n$, and there are $m$ modification operations. After the $i$-th modification, you need to answer:\nFor the sequence $a$ after $i$ modifications, what is the minimum number of elements that still need to be changed so that it can be deleted to empty?\n\nEach modification is either a point update, or adding $1$ to the whole sequence, or subtracting $1$ from the whole sequence.", "inputFormat": "The first line contains two positive integers $n, m$, representing the sequence length and the number of modifications.\n\nThe second line contains $n$ positive integers, representing the sequence $a$. That is, the $i$-th input number is the $i$-th element of the sequence, $a_i$.\n\nThe next $m$ lines each contain two integers $p, x$, representing one modification operation.\nWhen $1 \\le p \\le n$, this operation is a point update: set the $p$-th number in the sequence, $a_p$, to $x$.\nWhen $p = 0$, this operation adds $x$ to the whole sequence.", "outputFormat": "Output $m$ lines, each containing one integer. The $i$-th line denotes the answer after the first $i$ modifications.", "hint": "**Sample Explanation (partial):**\nAfter the first modification, the sequence is $(1, 2, 3)$, and it can be deleted to empty without any changes.\nAfter the fourth modification, the sequence is $(4, 5, 6)$, and all three numbers must be changed before it can possibly be deleted to empty.\nAfter the sixth modification, the sequence is $(4, 2, 2)$, and changing the first number to $3$ makes it deletable to empty.\nAfter the ninth modification, the sequence is $(1, -1, -1)$, and you can change the second number to $2$ and the third number to $3$ to make it deletable to empty.\n\n**Constraints:**\nFor $100\\%$ of the testdata:\n- $1 \\le n, m \\le 150000$, $1 \\le a_i \\le n$, $0 \\le p \\le n$.\n- When $p > 0$, $1 \\le x \\le n$.\n- When $p = 0$, $x \\in \\{-1, 1\\}$.\n![](https://cdn.luogu.com.cn/upload/pic/57129.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 删数", "background": null, "description": "对于任意一个数列，如果能在有限次进行下列删数操作后将其删为空数列，则称这个数列可以删空。一次删数操作定义如下：  \n>记当前数列长度为 $k$ ，则删掉数列中所有等于 $k$ 的数。  \n\n现有一个长度为 $n$ 的数列 $a$，有 $m$ 次修改操作，第 $i$ 次修改后你要回答：  \n经过 $i$ 次修改后的数列 $a$，至少还需要修改几个数才可删空？  \n\n每次修改操作为单点修改或数列整体加一或数列整体减一。", "inputFormat": "第一行两个正整数 $n,m$，分别表示数列长度、修改次数。  \n第二行有 $n$ 个正整数，表示数列 $a$，即输入的第 $i$ 个数表示数列 $a$ 的第 $i$ 个数 $a_i$。   \n\n接下来 $m$ 行，每行两个整数 $p,x$，表示一次修改操作。  \n当 $1\\le p \\le n$ 时，该操作为单点修改，将数列中第 $p$ 个数 $a_p$ 修改为 $x$  \n当 $p=0$ 时，该操作为数列整体加 $x$。", "outputFormat": "输出 $m$ 行，每行一个整数，第 $i$ 行表示前 $i$ 次修改后的答案。", "hint": "**样例解释(局部)：**     \n第一次修改后，数列为 $(1, 2, 3)$，无需修改即可删空。   \n第四次修改后，数列为 $(4, 5, 6)$，需要将三个数都改掉才可能删空。   \n第六次修改后，数列为 $(4, 2, 2)$，将第一个数改成 $3$ 即可删空。   \n第九次修改后，数列为 $(1, -1, -1)$，可以将第二个数改成 $2$、第三个数改成 $3$ 来删空。   \n\n**数据范围：**   \n对于 $100\\%$ 的数据：      \n- $1\\le n,m \\le 150000, 1\\le a_i \\le n, 0\\le p\\le n$  \n- $p>0$ 时，$1\\le x \\le n$  \n- $p=0$ 时，$x\\in \\{-1, 1\\}$    \n![](https://cdn.luogu.com.cn/upload/pic/57129.png)", "locale": "zh-CN"}}}
{"pid": "P5325", "type": "P", "difficulty": 7, "samples": [["10\n", "263\n"], ["1000000000\n", "710164413\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["递推", "数论", "筛法", "模板题"], "title": "【模板】Min_25 筛", "background": "模板题，无背景。", "description": "定义积性函数 $f(x)$，且 $f(p ^ k) = p ^ k(p ^ k - 1)$（$p$ 是一个质数），求\n\n$$\\sum_{i = 1} ^ n f(i)$$\n\n对 $10 ^ 9 + 7$ 取模。", "inputFormat": "一行一个整数 $n$。", "outputFormat": "一个整数表示答案。", "hint": "$f(1)=1$，$f(2)=2$，$f(3)=6$，$f(4)=12$，$f(5)=20$；  \n$f(6)=12$，$f(7)=42$，$f(8)=56$，$f(9)=72$，$f(10)=40$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n\\le 10^6$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^{10}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Min_25 Sieve", "background": "This is a template problem, with no background.", "description": "Define a multiplicative function $f(x)$, and $f(p ^ k) = p ^ k(p ^ k - 1)$ ($p$ is a prime). Compute\n\n$$\\sum_{i = 1} ^ n f(i)$$\n\nmodulo $10 ^ 9 + 7$.", "inputFormat": "One line containing an integer $n$.", "outputFormat": "Output one integer, the answer.", "hint": "$f(1)=1$，$f(2)=2$，$f(3)=6$，$f(4)=12$，$f(5)=20$；  \n$f(6)=12$，$f(7)=42$，$f(8)=56$，$f(9)=72$，$f(10)=40$。\n\nFor $30\\%$ of the testdata, it is guaranteed that $1\\le n\\le 10^6$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le n\\le 10^{10}$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】Min_25 筛", "background": "模板题，无背景。", "description": "定义积性函数 $f(x)$，且 $f(p ^ k) = p ^ k(p ^ k - 1)$（$p$ 是一个质数），求\n\n$$\\sum_{i = 1} ^ n f(i)$$\n\n对 $10 ^ 9 + 7$ 取模。", "inputFormat": "一行一个整数 $n$。", "outputFormat": "一个整数表示答案。", "hint": "$f(1)=1$，$f(2)=2$，$f(3)=6$，$f(4)=12$，$f(5)=20$；  \n$f(6)=12$，$f(7)=42$，$f(8)=56$，$f(9)=72$，$f(10)=40$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n\\le 10^6$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^{10}$。", "locale": "zh-CN"}}}
{"pid": "P5326", "type": "P", "difficulty": 7, "samples": [["2\n1 1\n1 1", "4"], ["8\n1 1 0 0 1 1 0 0\n1 2 3 4 5 6 7 8", "858924815"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] 开关", "background": "", "description": "九条可怜是一个贪玩的女孩子。  \n\n这天，她和她的好朋友法海哥哥去玩密室逃脱。在他们面前的是 $n$ 个开关，开始每个开关都是关闭的状态。要通过这关，必须要让开关达到指定的状态。目标状态由一个长度为 $n$ 的 $01$ 数组 $s$ 给出，$s_i = 0$ 表示第 $i$ 个开关在最后需要是关着的，$s_i = 1$ 表示第 $i$ 个开关在最后需要被打开。  \n\n然而作为闯关者，可怜和法海并不知道 $s$。因此他们决定采用一个比较稳妥的方法：瞎按。他们根据开关的外形、位置，通过一些玄学的方法给每一个开关赋予了一个权值 $p_i$（$p_i > 0$）每一次，他们会以正比于 $p_i$ 的概率（第 $i$ 个开关被选中的概率是 $\\frac{p_i}{\\sum^n_{j=1}p_j}$ 选择并按下一个开关。开关被按下后，状态会被反转，即开变关，关变开。**注意，每一轮的选择都是完全独立的。**\n\n在按开关的过程中，一旦当前开关的状态达到了 $s$ 那么可怜和法海面前的门就会打开，他们会马上停止按开关的过程并前往下一关。作为一名欧皇，可怜在按了 $\\sum^n_{i=1} s_i$ 次后，就打开了大门。为了感受一下自己的运气是多么的好，可怜想要让你帮她计算一下，用这种随机按的方式，期望需要按多少次开关才能通过这一关。", "inputFormat": "第一行输入一个整数 $n$，表示开关的数量。  \n第二行输入 $n$ 个整数 $s_i$（$s_i\\in \\{0,1\\}$），表示开关的目标状态。第三行同样输入 $n$ 个整数 $p_i$，表示每个开关的权值。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为，$\\frac{x}{y}$（$x \\ge 0$，$y \\ge 1$，$\\gcd(x, y) = 1$），你需要输出 $x \\times y^{-1} \\bmod 998244353$。", "hint": "**【样例解释 \\#1】**\n\n前两次按开关，有 $\\frac12$ 的概率达到 $s$，有 $\\frac12$ 的概率回到原状。因此期望的按开关数量为：\n\n$$\\sum^{+\\infty}_{i=1}2i\\times \\left(\\frac12\\right)^i=4$$\n\n---\n\n**【数据范围与约定】**\n\n| 测试点 | $n$ | 其他约定 | 测试点 | $n$ | 其他约定 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=2$ | 无 | $6$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $2$ | $=2$ | 无 | $7$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $3$ | $\\le 8$ | 无 | $8$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $4$ | $\\le 8$ | 无 | $9$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $5$ | $\\le 100$ | $p_i=1$ | $10$ | $\\le 100$ | 无 |\n\n对于 $100\\%$ 的数据，保证 $n\\ge1$，$\\sum^n_{i=1}p_i\\le5\\times10^4$，$p_i\\ge1$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Switches", "background": "", "description": "Jiutiao Keliang is a playful girl.\n\nOne day, she and her good friend Brother Fahai went to play an escape room. In front of them are $n$ switches, and at the beginning every switch is in the off state. To pass this level, the switches must reach a specified state. The target state is given by a binary array $s$ of length $n$. $s_i = 0$ means the $i$-th switch needs to be off in the end, and $s_i = 1$ means the $i$-th switch needs to be on in the end.\n\nHowever, as challengers, Keliang and Fahai do not know $s$. So they decided to use a safer method: pressing randomly. Based on the shape and position of the switches, they used some “mystic” methods to assign each switch a weight $p_i$ ($p_i > 0$). Each time, they choose and press one switch with probability proportional to $p_i$ (the probability that the $i$-th switch is chosen is $\\frac{p_i}{\\sum^n_{j=1}p_j}$). After a switch is pressed, its state is flipped: on becomes off, and off becomes on. **Note that each round of selection is completely independent.**\n\nDuring the process of pressing switches, once the current states of switches match $s$, the door in front of Keliang and Fahai will open. They will immediately stop pressing switches and move on to the next level. As a very lucky person, Keliang opened the door after pressing $\\sum^n_{i=1} s_i$ times. To feel how good her luck was, she wants you to help her compute: using this random pressing method, what is the expected number of presses needed to pass this level?", "inputFormat": "The first line contains an integer $n$, representing the number of switches.  \nThe second line contains $n$ integers $s_i$ ($s_i\\in \\{0,1\\}$), representing the target state of each switch.  \nThe third line contains $n$ integers $p_i$, representing the weight of each switch.", "outputFormat": "Output one line with one integer, representing the answer modulo $998244353$. That is, if the answer in simplest fractional form is $\\frac{x}{y}$ ($x \\ge 0$, $y \\ge 1$, $\\gcd(x, y) = 1$), you should output $x \\times y^{-1} \\bmod 998244353$.", "hint": "**[Sample Explanation \\#1]**\n\nIn the first two presses, there is a probability of $\\frac12$ to reach $s$, and a probability of $\\frac12$ to return to the initial state. Therefore, the expected number of switch presses is:\n\n$$\\sum^{+\\infty}_{i=1}2i\\times \\left(\\frac12\\right)^i=4$$\n\n---\n\n**[Constraints and Notes]**\n\n| Test Point | $n$ | Other Notes | Test Point | $n$ | Other Notes |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=2$ | None | $6$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $2$ | $=2$ | None | $7$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $3$ | $\\le 8$ | None | $8$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $4$ | $\\le 8$ | None | $9$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $5$ | $\\le 100$ | $p_i=1$ | $10$ | $\\le 100$ | None |\n\nFor $100\\%$ of the testdata, it is guaranteed that $n\\ge1$, $\\sum^n_{i=1}p_i\\le5\\times10^4$, and $p_i\\ge1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 开关", "background": "", "description": "九条可怜是一个贪玩的女孩子。  \n\n这天，她和她的好朋友法海哥哥去玩密室逃脱。在他们面前的是 $n$ 个开关，开始每个开关都是关闭的状态。要通过这关，必须要让开关达到指定的状态。目标状态由一个长度为 $n$ 的 $01$ 数组 $s$ 给出，$s_i = 0$ 表示第 $i$ 个开关在最后需要是关着的，$s_i = 1$ 表示第 $i$ 个开关在最后需要被打开。  \n\n然而作为闯关者，可怜和法海并不知道 $s$。因此他们决定采用一个比较稳妥的方法：瞎按。他们根据开关的外形、位置，通过一些玄学的方法给每一个开关赋予了一个权值 $p_i$（$p_i > 0$）每一次，他们会以正比于 $p_i$ 的概率（第 $i$ 个开关被选中的概率是 $\\frac{p_i}{\\sum^n_{j=1}p_j}$ 选择并按下一个开关。开关被按下后，状态会被反转，即开变关，关变开。**注意，每一轮的选择都是完全独立的。**\n\n在按开关的过程中，一旦当前开关的状态达到了 $s$ 那么可怜和法海面前的门就会打开，他们会马上停止按开关的过程并前往下一关。作为一名欧皇，可怜在按了 $\\sum^n_{i=1} s_i$ 次后，就打开了大门。为了感受一下自己的运气是多么的好，可怜想要让你帮她计算一下，用这种随机按的方式，期望需要按多少次开关才能通过这一关。", "inputFormat": "第一行输入一个整数 $n$，表示开关的数量。  \n第二行输入 $n$ 个整数 $s_i$（$s_i\\in \\{0,1\\}$），表示开关的目标状态。第三行同样输入 $n$ 个整数 $p_i$，表示每个开关的权值。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为，$\\frac{x}{y}$（$x \\ge 0$，$y \\ge 1$，$\\gcd(x, y) = 1$），你需要输出 $x \\times y^{-1} \\bmod 998244353$。", "hint": "**【样例解释 \\#1】**\n\n前两次按开关，有 $\\frac12$ 的概率达到 $s$，有 $\\frac12$ 的概率回到原状。因此期望的按开关数量为：\n\n$$\\sum^{+\\infty}_{i=1}2i\\times \\left(\\frac12\\right)^i=4$$\n\n---\n\n**【数据范围与约定】**\n\n| 测试点 | $n$ | 其他约定 | 测试点 | $n$ | 其他约定 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=2$ | 无 | $6$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $2$ | $=2$ | 无 | $7$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $3$ | $\\le 8$ | 无 | $8$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $4$ | $\\le 8$ | 无 | $9$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $5$ | $\\le 100$ | $p_i=1$ | $10$ | $\\le 100$ | 无 |\n\n对于 $100\\%$ 的数据，保证 $n\\ge1$，$\\sum^n_{i=1}p_i\\le5\\times10^4$，$p_i\\ge1$。", "locale": "zh-CN"}}}
{"pid": "P5327", "type": "P", "difficulty": 7, "samples": [["5 3\n1 2\n1 3\n3 4\n3 5\n3 4\n1 4\n2 5", "8"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] 语言", "background": "", "description": "九条可怜是一个喜欢规律的女孩子。按照规律，第二题应该是一道和数据结构有关的题。\n\n在一个遥远的国度，有 $n$ 个城市。城市之间有 $n - 1$ 条双向道路，这些道路保证了任何两个城市之间都能直接或者间接地到达。\n\n在上古时代，这 $n$ 个城市之间处于战争状态。在高度闭塞的环境中，每个城市都发展出了自己的语言。而在王国统一之后，语言不通给王国的发展带来了极大的阻碍。为了改善这种情况，国王下令设计了 $m$ 种通用语，并进行了 $m$ 次语言统一工作。在第 $i$ 次统一工作中，一名大臣从城市 $s_i$ 出发，沿着最短的路径走到了 $t_i$，教会了沿途所有城市（包括 $s_i, t_i$）使用第 $i$ 个通用语。\n\n一旦有了共通的语言，那么城市之间就可以开展贸易活动了。两个城市 $u_i, v_i$ 之间可以开展贸易活动当且仅当存在一种通用语 $L$ 满足 $u_i$ 到 $v_i$ 最短路上的所有城市（包括 $u_i, v_i$），都会使用 $L$。\n\n为了衡量语言统一工作的效果，国王想让你计算有多少对城市 $(u, v)$（$u < v$），他们之间可以开展贸易活动。", "inputFormat": "第一行输入两个正整数 $n, m$，表示城市数和通用语的数量。\n\n接下来 $n - 1$ 行，每行两个整数 $x_i, y_i$（$1 \\le x_i, y_i \\le n$），表示了一条连接城市 $x_i, y_i$ 的道路。\n\n接下来 $m$ 行，每行两个整数 $s_i, t_i$（$1 \\le s_i, t_i \\le n$），表示一次语言普及工作。", "outputFormat": "输出一行一个整数，表示可以开展贸易活动的城市对数量。", "hint": "\n#### 样例说明\n可以开展贸易活动的城市对为 $(1, 2), (1, 3), (1, 4), (1, 5), (2, 3), (2, 5), (3, 4), (3, 5)$。\n\n#### 数据范围\n\n|测试点|$n$|$m$|其他约定|\n|:-:|:-:|:-:|:-:|\n|$1,2$|$\\le 300$|$\\le 300$|无|\n|$3,4$|$\\le 5\\times 10^3$|$\\le 5\\times 10^3$|无|\n|$5,6$|$\\le 10^5$|$\\le 10^5$|$y_i=x_i+1$|\n|$7\\sim 10$|$\\le 10^5$|$\\le 10^5$|无|\n\n对于 $100\\%$ 的数据，有 $1 \\le x_i, y_i, s_i, t_i \\le n\\leq 10 ^ 5$，$1\\leq m\\leq 10 ^ 5$，$x_i\\neq y_i$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Language", "background": "", "description": "Jiutiao Keliang is a girl who likes patterns. By this pattern, the second problem should be related to data structures.\n\nIn a distant kingdom, there are $n$ cities. There are $n - 1$ bidirectional roads between the cities, and these roads guarantee that any two cities can reach each other directly or indirectly.\n\nIn ancient times, these $n$ cities were at war with each other. In a highly isolated environment, each city developed its own language. After the kingdom was unified, language barriers greatly hindered the kingdom’s development. To improve this, the king ordered the design of $m$ common languages and carried out $m$ language unification operations. In the $i$-th operation, a minister started from city $s_i$, walked to $t_i$ along the shortest path, and taught every city on the way (including $s_i$ and $t_i$) to use the $i$-th common language.\n\nOnce there is a shared language, cities can conduct trade. Two cities $u_i, v_i$ can conduct trade if and only if there exists a common language $L$ such that every city on the shortest path from $u_i$ to $v_i$ (including $u_i$ and $v_i$) can use $L$.\n\nTo measure the effect of the language unification operations, the king wants you to compute how many pairs of cities $(u, v)$ with $u < v$ can conduct trade.", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of cities and the number of common languages.\n\nThe next $n - 1$ lines each contain two integers $x_i, y_i$ ($1 \\le x_i, y_i \\le n$), indicating a road connecting cities $x_i$ and $y_i$.\n\nThe next $m$ lines each contain two integers $s_i, t_i$ ($1 \\le s_i, t_i \\le n$), indicating one language promotion operation.", "outputFormat": "Output one line with one integer, representing the number of pairs of cities that can conduct trade.", "hint": "#### Sample Explanation\nThe pairs of cities that can conduct trade are $(1, 2), (1, 3), (1, 4), (1, 5), (2, 3), (2, 5), (3, 4), (3, 5)$.\n\n#### Constraints\n\n|Test Point|$n$|$m$|Other Constraints|\n|:-:|:-:|:-:|:-:|\n|$1,2$|$\\le 300$|$\\le 300$|None|\n|$3,4$|$\\le 5\\times 10^3$|$\\le 5\\times 10^3$|None|\n|$5,6$|$\\le 10^5$|$\\le 10^5$|$y_i=x_i+1$|\n|$7\\sim 10$|$\\le 10^5$|$\\le 10^5$|None|\n\nFor $100\\%$ of the testdata, $1 \\le x_i, y_i, s_i, t_i \\le n\\leq 10 ^ 5$, $1\\leq m\\leq 10 ^ 5$, and $x_i\\neq y_i$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 语言", "background": "", "description": "九条可怜是一个喜欢规律的女孩子。按照规律，第二题应该是一道和数据结构有关的题。\n\n在一个遥远的国度，有 $n$ 个城市。城市之间有 $n - 1$ 条双向道路，这些道路保证了任何两个城市之间都能直接或者间接地到达。\n\n在上古时代，这 $n$ 个城市之间处于战争状态。在高度闭塞的环境中，每个城市都发展出了自己的语言。而在王国统一之后，语言不通给王国的发展带来了极大的阻碍。为了改善这种情况，国王下令设计了 $m$ 种通用语，并进行了 $m$ 次语言统一工作。在第 $i$ 次统一工作中，一名大臣从城市 $s_i$ 出发，沿着最短的路径走到了 $t_i$，教会了沿途所有城市（包括 $s_i, t_i$）使用第 $i$ 个通用语。\n\n一旦有了共通的语言，那么城市之间就可以开展贸易活动了。两个城市 $u_i, v_i$ 之间可以开展贸易活动当且仅当存在一种通用语 $L$ 满足 $u_i$ 到 $v_i$ 最短路上的所有城市（包括 $u_i, v_i$），都会使用 $L$。\n\n为了衡量语言统一工作的效果，国王想让你计算有多少对城市 $(u, v)$（$u < v$），他们之间可以开展贸易活动。", "inputFormat": "第一行输入两个正整数 $n, m$，表示城市数和通用语的数量。\n\n接下来 $n - 1$ 行，每行两个整数 $x_i, y_i$（$1 \\le x_i, y_i \\le n$），表示了一条连接城市 $x_i, y_i$ 的道路。\n\n接下来 $m$ 行，每行两个整数 $s_i, t_i$（$1 \\le s_i, t_i \\le n$），表示一次语言普及工作。", "outputFormat": "输出一行一个整数，表示可以开展贸易活动的城市对数量。", "hint": "\n#### 样例说明\n可以开展贸易活动的城市对为 $(1, 2), (1, 3), (1, 4), (1, 5), (2, 3), (2, 5), (3, 4), (3, 5)$。\n\n#### 数据范围\n\n|测试点|$n$|$m$|其他约定|\n|:-:|:-:|:-:|:-:|\n|$1,2$|$\\le 300$|$\\le 300$|无|\n|$3,4$|$\\le 5\\times 10^3$|$\\le 5\\times 10^3$|无|\n|$5,6$|$\\le 10^5$|$\\le 10^5$|$y_i=x_i+1$|\n|$7\\sim 10$|$\\le 10^5$|$\\le 10^5$|无|\n\n对于 $100\\%$ 的数据，有 $1 \\le x_i, y_i, s_i, t_i \\le n\\leq 10 ^ 5$，$1\\leq m\\leq 10 ^ 5$，$x_i\\neq y_i$。", "locale": "zh-CN"}}}
{"pid": "P5328", "type": "P", "difficulty": 7, "samples": [["3 1\n1 5\n5 1\n2 2", "1 1 -1"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] 浙江省选", "background": "", "description": "九条可怜是一个喜欢出题的女孩子，这道题是一道有关浙江省选的硬核模拟题。  \n\n在 $9102$ 年，有 $n$ 名选手参加了浙江省选，其中第 $i$ 个选手的智力是 $a_i$，训练量是 $b_i$。作为\n出题人，可怜可以自由选择这套题的风格是比较偏套路还是比较偏智力。举例来说，$\\mathrm{ZJOI}2018$ 的题就比较偏智力，今年的题就比较偏套路。  \n\n为了定量衡量一套题的风格，可怜定义了反向选拔指数 $x$，$x$ 是一个**非负整数**。第 $i$ 个选手在反向选拔指数为 $x$ 的题目上的表现为 $a_ix+b_i$。在 $x$ 给定的情况下，第 $i$ 个人的排名为表现严格大于 $a_ix+bi$ 的人数再加一。  \n\n在 $9102$ 年浙江省队的人数为 $m$，因此只有排名小于等于 $m$ 的人才能够进入浙江省队。注意当有并列的情况时，进入浙江省队的人数可能多于 $m$。\n\n不难发现，选手的排名和 $x$ 的关系非常大。现在，可怜想让你计算，第 $i$ 个选手有没有可能进入浙江省队，如果有可能，他最好的排名是多少。  \n", "inputFormat": "第一行输入两个整数 $n,m(m\\leq n)$，表示选手总数以及浙江省队的人数。  \n接下来 $n$ 行每行两个整数 $a_i,b_i$，表示每个选手的属性值。\n", "outputFormat": "输出一行 $n$ 个整数，如果第 $i$ 个选手进不了浙江省队，就输出 $-1$，否则输出他可能的最好排名。", "hint": "## 样例 1 解释\n当 $x=1$ 时，三个人的表现分别为 $6,6,4$，这时前两个人并列第一名，都能进入省队，而第三个人排名第三，没法进入省队。  \n\n当 $x>1$ 时，第二个人的表现严格好于第三个人，而当 $x=0$ 时，第一个人的表现严格好于第三个人，因此第三个人无论 $x$ 怎么取，他都没有办法进入省队。  \n\n## 数据范围与约定\n| 测试点 | $n$ | $m$ | 测试点 | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 200$ | $\\le 20$ | $6$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $2$ | $\\le 200$ | $\\le 20$ | $7$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $3$ | $\\le 10^5$ | $=1$ | $8$ | $\\le 10^5$ | $\\le 20$ |\n| $4$ | $\\le 10^5$ | $\\le 2$ | $9$ | $\\le 10^5$ | $\\le 20$ |\n| $5$ | $\\le 10^5$ | $\\le 2$  | $10$ | $\\le 10^5$ | $\\le 20$ |\n\n对于 $100\\%$ 的数据，$1\\leq a_i \\leq 10^9$，$1\\leq b_i \\leq 10^{18}$，$1\\leq m \\leq n$。\n\n对于 $100\\%$ 的数据，保证选手的属性两两不同，即 $ \\forall 1\\leq i < j \\leq n$，有 $a_i\\neq a_j$ 或 $b_i\\neq b_j$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Zhejiang NOI Qualifier", "background": "", "description": "Kyuukawa Karen is a girl who likes to create problems. This problem is a hardcore simulation problem about the Zhejiang NOI Qualifier.\n\nIn the year $9102$, there are $n$ contestants participating in the Zhejiang NOI Qualifier. The $i$-th contestant has intelligence $a_i$ and training amount $b_i$. As the problem setter, Karen can freely choose whether this set of problems is more “pattern-based” or more “intelligence-based”. For example, the problems in ZJOI 2018 were more intelligence-based, while this year’s problems are more pattern-based.\n\nTo measure the style of a set of problems quantitatively, Karen defines the reverse selection index $x$, where $x$ is a **non-negative integer**. The performance of the $i$-th contestant on problems with reverse selection index $x$ is $a_ix+b_i$. When $x$ is fixed, the rank of the $i$-th person is the number of people whose performance is strictly greater than $a_ix+b_i$, plus one.\n\nIn the year $9102$, the size of the Zhejiang provincial team is $m$, so only those with rank $\\le m$ can enter the team. Note that when there are ties, the number of people who enter the team may be greater than $m$.\n\nIt is not hard to see that a contestant’s rank depends heavily on $x$. Now, Karen wants you to compute whether the $i$-th contestant can possibly enter the Zhejiang provincial team. If possible, what is their best possible rank.", "inputFormat": "The first line contains two integers $n,m(m\\leq n)$, representing the total number of contestants and the size of the Zhejiang provincial team.  \nThe next $n$ lines each contain two integers $a_i,b_i$, representing each contestant’s attributes.", "outputFormat": "Output one line with $n$ integers. If the $i$-th contestant cannot enter the Zhejiang provincial team, output $-1$. Otherwise, output their best possible rank.", "hint": "# Constraints\n\n## Explanation of Sample 1\n\nWhen $x=1$, the three contestants’ performances are $6,6,4$. At this time, the first two contestants are tied for 1st place, and both can enter the provincial team. The third contestant ranks 3rd and cannot enter.\n\nWhen $x>1$, the second contestant’s performance is strictly better than the third contestant’s. When $x=0$, the first contestant’s performance is strictly better than the third contestant’s. Therefore, no matter how $x$ is chosen, the third contestant has no way to enter the provincial team.\n\n## Constraints and Notes\n\n| Test Point | $n$ | $m$ | Test Point | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 200$ | $\\le 20$ | $6$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $2$ | $\\le 200$ | $\\le 20$ | $7$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $3$ | $\\le 10^5$ | $=1$ | $8$ | $\\le 10^5$ | $\\le 20$ |\n| $4$ | $\\le 10^5$ | $\\le 2$ | $9$ | $\\le 10^5$ | $\\le 20$ |\n| $5$ | $\\le 10^5$ | $\\le 2$  | $10$ | $\\le 10^5$ | $\\le 20$ |\n\nFor $100\\%$ of the data, $1\\leq a_i \\leq 10^9$, $1\\leq b_i \\leq 10^{18}$, and $1\\leq m \\leq n$.\n\nFor $100\\%$ of the data, it is guaranteed that all contestants’ attributes are pairwise different, i.e., $ \\forall 1\\leq i < j \\leq n$, we have $a_i\\neq a_j$ or $b_i\\neq b_j$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 浙江省选", "background": "", "description": "九条可怜是一个喜欢出题的女孩子，这道题是一道有关浙江省选的硬核模拟题。  \n\n在 $9102$ 年，有 $n$ 名选手参加了浙江省选，其中第 $i$ 个选手的智力是 $a_i$，训练量是 $b_i$。作为\n出题人，可怜可以自由选择这套题的风格是比较偏套路还是比较偏智力。举例来说，$\\mathrm{ZJOI}2018$ 的题就比较偏智力，今年的题就比较偏套路。  \n\n为了定量衡量一套题的风格，可怜定义了反向选拔指数 $x$，$x$ 是一个**非负整数**。第 $i$ 个选手在反向选拔指数为 $x$ 的题目上的表现为 $a_ix+b_i$。在 $x$ 给定的情况下，第 $i$ 个人的排名为表现严格大于 $a_ix+bi$ 的人数再加一。  \n\n在 $9102$ 年浙江省队的人数为 $m$，因此只有排名小于等于 $m$ 的人才能够进入浙江省队。注意当有并列的情况时，进入浙江省队的人数可能多于 $m$。\n\n不难发现，选手的排名和 $x$ 的关系非常大。现在，可怜想让你计算，第 $i$ 个选手有没有可能进入浙江省队，如果有可能，他最好的排名是多少。  \n", "inputFormat": "第一行输入两个整数 $n,m(m\\leq n)$，表示选手总数以及浙江省队的人数。  \n接下来 $n$ 行每行两个整数 $a_i,b_i$，表示每个选手的属性值。\n", "outputFormat": "输出一行 $n$ 个整数，如果第 $i$ 个选手进不了浙江省队，就输出 $-1$，否则输出他可能的最好排名。", "hint": "## 样例 1 解释\n当 $x=1$ 时，三个人的表现分别为 $6,6,4$，这时前两个人并列第一名，都能进入省队，而第三个人排名第三，没法进入省队。  \n\n当 $x>1$ 时，第二个人的表现严格好于第三个人，而当 $x=0$ 时，第一个人的表现严格好于第三个人，因此第三个人无论 $x$ 怎么取，他都没有办法进入省队。  \n\n## 数据范围与约定\n| 测试点 | $n$ | $m$ | 测试点 | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 200$ | $\\le 20$ | $6$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $2$ | $\\le 200$ | $\\le 20$ | $7$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $3$ | $\\le 10^5$ | $=1$ | $8$ | $\\le 10^5$ | $\\le 20$ |\n| $4$ | $\\le 10^5$ | $\\le 2$ | $9$ | $\\le 10^5$ | $\\le 20$ |\n| $5$ | $\\le 10^5$ | $\\le 2$  | $10$ | $\\le 10^5$ | $\\le 20$ |\n\n对于 $100\\%$ 的数据，$1\\leq a_i \\leq 10^9$，$1\\leq b_i \\leq 10^{18}$，$1\\leq m \\leq n$。\n\n对于 $100\\%$ 的数据，保证选手的属性两两不同，即 $ \\forall 1\\leq i < j \\leq n$，有 $a_i\\neq a_j$ 或 $b_i\\neq b_j$。", "locale": "zh-CN"}}}
{"pid": "P5329", "type": "P", "difficulty": 4, "samples": [["7\naabaaab", "3 7 4 5 6 1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "各省省选", "陕西"], "title": "[SNOI2019] 字符串", "background": "", "description": "给出一个长度为 $n$ 的由小写字母组成的字符串 $a$，设其中第 $i$ 个字符为 $a_i(1\\le i\\le n)$。\n\n设删掉第 $i$ 个字符之后得到的字符串为 $s_i$，请按照字典序对 $s_1,s_2,\\cdots,s_n$ 从小到大排序。若两个字符串相等，则认为编号小的字符串字典序更小。", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个长为 $n$ 的由小写字母组成的字符串 $a$。", "outputFormat": "输出一行 $n$ 个整数 $k_1,k_2,\\cdots,k_n$，用空格隔开。表示 $s_{k_1}<s_{k_2}<\\cdots<s_{k_n}$。", "hint": "对于所有数据，$1\\le n\\le 10^6$。\n\n对于 10% 的数据，$1\\le n\\le 2000$；\n\n对于另外 20% 的数据，$1\\le n\\le 10^5$ 且任意两个相邻字符 $a_i,a_{i+1}$ 不相等；\n\n对于另外 30% 的数据，$1\\le n\\le 10^5$；\n\n对于余下 40% 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] String", "background": "", "description": "Given a string $a$ of length $n$ consisting of lowercase letters, let its $i$-th character be $a_i(1\\le i\\le n)$.\n\nLet $s_i$ be the string obtained after deleting the $i$-th character. Sort $s_1,s_2,\\cdots,s_n$ in increasing lexicographical order. If two strings are equal, then the one with the smaller index is considered lexicographically smaller.", "inputFormat": "The first line contains an integer $n$.\n\nThe second line contains a string $a$ of length $n$ consisting of lowercase letters.", "outputFormat": "Output one line with $n$ integers $k_1,k_2,\\cdots,k_n$, separated by spaces, meaning that $s_{k_1}<s_{k_2}<\\cdots<s_{k_n}$.", "hint": "Constraints: For all testdata, $1\\le n\\le 10^6$.\n\nFor $10\\%$ of the testdata, $1\\le n\\le 2000$.\n\nFor another $20\\%$ of the testdata, $1\\le n\\le 10^5$ and any two adjacent characters $a_i,a_{i+1}$ are not equal.\n\nFor another $30\\%$ of the testdata, $1\\le n\\le 10^5$.\n\nFor the remaining $40\\%$ of the testdata, there are no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 字符串", "background": "", "description": "给出一个长度为 $n$ 的由小写字母组成的字符串 $a$，设其中第 $i$ 个字符为 $a_i(1\\le i\\le n)$。\n\n设删掉第 $i$ 个字符之后得到的字符串为 $s_i$，请按照字典序对 $s_1,s_2,\\cdots,s_n$ 从小到大排序。若两个字符串相等，则认为编号小的字符串字典序更小。", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个长为 $n$ 的由小写字母组成的字符串 $a$。", "outputFormat": "输出一行 $n$ 个整数 $k_1,k_2,\\cdots,k_n$，用空格隔开。表示 $s_{k_1}<s_{k_2}<\\cdots<s_{k_n}$。", "hint": "对于所有数据，$1\\le n\\le 10^6$。\n\n对于 10% 的数据，$1\\le n\\le 2000$；\n\n对于另外 20% 的数据，$1\\le n\\le 10^5$ 且任意两个相邻字符 $a_i,a_{i+1}$ 不相等；\n\n对于另外 30% 的数据，$1\\le n\\le 10^5$；\n\n对于余下 40% 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5330", "type": "P", "difficulty": 6, "samples": [["4 6 3 3 14\n0 1 3\n2 4 5", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "各省省选", "陕西"], "title": "[SNOI2019] 数论", "background": "", "description": "给出正整数 $P,Q,T$ ，大小为 $n$ 的整数集 $A$ 和大小为 $m$ 的整数集 $B$ ，请你求出：\n\n$$\n\\sum_{i=0}^{T-1}[(i\\bmod P) \\in A \\land (i\\bmod Q) \\in B]\n$$\n\n\n换言之，就是问有多少个小于 $T$ 的非负整数 $x$ 满足：$x$ 除以 $P$ 的余数属于 $A$ 且 $x$ 除以 $Q$ 的余数属于 $B$。", "inputFormat": "第一行 $5$ 个用空格隔开的整数 $P,Q,n,m,T$。\n\n第二行 $n$ 个用空格隔开的整数，表示集合 $A=\\{A_1,A_2,\\cdots,A_n\\}$。保证 $A_i$ 两两不同，且 $0 \\leq A_i<P$。\n\n第三行 $m$ 个用空格隔开的整数，表示集合 $B=\\{B_1,B_2,\\cdots,B_m\\}$。保证 $B_i$ 两两不同，且 $0 \\leq B_i<Q$。\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "对于所有数据，$1 \\leq n,m \\leq 10^6 , 1 \\leq P,Q \\leq 10^6 , 1 \\leq T \\leq 10^{18}$。\n\n对于10%的数据，$T \\leq 10^6$。\n\n对于另外20%的数据，$P,Q \\leq 1000$。\n\n对于另外10%的数据，$T$是$P,Q$的公倍数。\n\n对于另外10%的数据，$P,Q$互质，且$P,Q \\leq 10^5$。\n\n对于另外10%的数据，$P,Q$互质。\n\n对于另外10%的数据，$P,Q \\leq 10^5$。\n\n对于余下30%的数据，无特殊限制。\n\n- 2023.11.17 添加三组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] Number Theory", "background": "", "description": "Given positive integers $P, Q, T$, an integer set $A$ of size $n$, and an integer set $B$ of size $m$, please compute:\n\n$$\n\\sum_{i=0}^{T-1}[(i\\bmod P) \\in A \\land (i\\bmod Q) \\in B]\n$$\n\nIn other words, ask how many non-negative integers $x$ less than $T$ satisfy: the remainder of $x$ divided by $P$ belongs to $A$, and the remainder of $x$ divided by $Q$ belongs to $B$.", "inputFormat": "The first line contains $5$ integers separated by spaces: $P, Q, n, m, T$.\n\nThe second line contains $n$ integers separated by spaces, representing the set $A=\\{A_1,A_2,\\cdots,A_n\\}$. It is guaranteed that all $A_i$ are pairwise distinct, and $0 \\leq A_i < P$.\n\nThe third line contains $m$ integers separated by spaces, representing the set $B=\\{B_1,B_2,\\cdots,B_m\\}$. It is guaranteed that all $B_i$ are pairwise distinct, and $0 \\leq B_i < Q$.", "outputFormat": "Output one integer on a single line, denoting the answer.", "hint": "For all testdata, $1 \\leq n,m \\leq 10^6$, $1 \\leq P,Q \\leq 10^6$, and $1 \\leq T \\leq 10^{18}$.\n\nFor $10\\%$ of the testdata, $T \\leq 10^6$.\n\nFor another $20\\%$ of the testdata, $P,Q \\leq 1000$.\n\nFor another $10\\%$ of the testdata, $T$ is a common multiple of $P$ and $Q$.\n\nFor another $10\\%$ of the testdata, $P$ and $Q$ are coprime, and $P,Q \\leq 10^5$.\n\nFor another $10\\%$ of the testdata, $P$ and $Q$ are coprime.\n\nFor another $10\\%$ of the testdata, $P,Q \\leq 10^5$.\n\nFor the remaining $30\\%$ of the testdata, there are no special constraints.\n\n- 2023.11.17 Added three groups of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 数论", "background": "", "description": "给出正整数 $P,Q,T$ ，大小为 $n$ 的整数集 $A$ 和大小为 $m$ 的整数集 $B$ ，请你求出：\n\n$$\n\\sum_{i=0}^{T-1}[(i\\bmod P) \\in A \\land (i\\bmod Q) \\in B]\n$$\n\n\n换言之，就是问有多少个小于 $T$ 的非负整数 $x$ 满足：$x$ 除以 $P$ 的余数属于 $A$ 且 $x$ 除以 $Q$ 的余数属于 $B$。", "inputFormat": "第一行 $5$ 个用空格隔开的整数 $P,Q,n,m,T$。\n\n第二行 $n$ 个用空格隔开的整数，表示集合 $A=\\{A_1,A_2,\\cdots,A_n\\}$。保证 $A_i$ 两两不同，且 $0 \\leq A_i<P$。\n\n第三行 $m$ 个用空格隔开的整数，表示集合 $B=\\{B_1,B_2,\\cdots,B_m\\}$。保证 $B_i$ 两两不同，且 $0 \\leq B_i<Q$。\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "对于所有数据，$1 \\leq n,m \\leq 10^6 , 1 \\leq P,Q \\leq 10^6 , 1 \\leq T \\leq 10^{18}$。\n\n对于10%的数据，$T \\leq 10^6$。\n\n对于另外20%的数据，$P,Q \\leq 1000$。\n\n对于另外10%的数据，$T$是$P,Q$的公倍数。\n\n对于另外10%的数据，$P,Q$互质，且$P,Q \\leq 10^5$。\n\n对于另外10%的数据，$P,Q$互质。\n\n对于另外10%的数据，$P,Q \\leq 10^5$。\n\n对于余下30%的数据，无特殊限制。\n\n- 2023.11.17 添加三组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P5331", "type": "P", "difficulty": 7, "samples": [["6 7\n8 4 6 1 3 0", "23"], ["8 4\n0 4 2 6 1 5 3 7", "18"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "网络流", "cdq 分治", "图论建模", "陕西", "费用流"], "title": "[SNOI2019] 通信", "background": "", "description": "$n$ 个排成一列的哨站要进行通信。第 $i$ 个哨站的频段为 $a_i$。\n\n每个哨站 $i$ 需要选择以下二者之一：\n\n1. 直接连接到控制中心，代价为 $W$；\n2. 连接到前面的某个哨站 $j$ ($j<i$)，代价为 $|a_i-a_j|$。\n每个哨站只能被后面的至多一个哨站连接。\n\n请你求出最小可能的代价和。", "inputFormat": "第 $1$ 行两个自然数 $n,W$，分别表示哨站个数和连接到控制中心的代价；\n\n第 $2$ 行 $n$ 个由空格分隔的自然数 $a_1,a_2,\\ldots,a_n$ 依次表示每个哨站的频段。", "outputFormat": "输出 $1$ 行 $1$ 个自然数表示答案。", "hint": "对于所有数据，$1 \\leq n \\leq 1000$，$0 \\leq W,a_i \\leq 10^9$。\n\n对于 $10\\%$ 的数据，$n \\leq 10$；\n\n对于另外 $10\\%$ 的数据，$n \\leq 20$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 50$，$W \\leq 5$，$a_i \\leq 4$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 100$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 300$；\n\n对于余下 $20\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] Communication", "background": "", "description": "There are $n$ sentry stations arranged in a line. The frequency band of station $i$ is $a_i$.\n\nEach station $i$ needs to choose one of the following two options:\n\n1. Connect directly to the control center, with a cost of $W$.\n2. Connect to some previous station $j$ ($j<i$), with a cost of $|a_i-a_j|$.\n\nEach station can be connected by at most one later station.\n\nPlease find the minimum possible total cost.", "inputFormat": "The first line contains two non-negative integers $n, W$, representing the number of sentry stations and the cost to connect to the control center.\n\nThe second line contains $n$ non-negative integers $a_1, a_2, \\ldots, a_n$ separated by spaces, representing the frequency band of each station in order.", "outputFormat": "Output one line containing one non-negative integer, representing the answer.", "hint": "For all testdata, $1 \\leq n \\leq 1000$, $0 \\leq W, a_i \\leq 10^9$.\n\nFor $10\\%$ of the testdata, $n \\leq 10$.\n\nFor another $10\\%$ of the testdata, $n \\leq 20$.\n\nFor another $20\\%$ of the testdata, $n \\leq 50$, $W \\leq 5$, $a_i \\leq 4$.\n\nFor another $20\\%$ of the testdata, $n \\leq 100$.\n\nFor another $20\\%$ of the testdata, $n \\leq 300$.\n\nFor the remaining $20\\%$ of the testdata, there are no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 通信", "background": "", "description": "$n$ 个排成一列的哨站要进行通信。第 $i$ 个哨站的频段为 $a_i$。\n\n每个哨站 $i$ 需要选择以下二者之一：\n\n1. 直接连接到控制中心，代价为 $W$；\n2. 连接到前面的某个哨站 $j$ ($j<i$)，代价为 $|a_i-a_j|$。\n每个哨站只能被后面的至多一个哨站连接。\n\n请你求出最小可能的代价和。", "inputFormat": "第 $1$ 行两个自然数 $n,W$，分别表示哨站个数和连接到控制中心的代价；\n\n第 $2$ 行 $n$ 个由空格分隔的自然数 $a_1,a_2,\\ldots,a_n$ 依次表示每个哨站的频段。", "outputFormat": "输出 $1$ 行 $1$ 个自然数表示答案。", "hint": "对于所有数据，$1 \\leq n \\leq 1000$，$0 \\leq W,a_i \\leq 10^9$。\n\n对于 $10\\%$ 的数据，$n \\leq 10$；\n\n对于另外 $10\\%$ 的数据，$n \\leq 20$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 50$，$W \\leq 5$，$a_i \\leq 4$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 100$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 300$；\n\n对于余下 $20\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5332", "type": "P", "difficulty": 7, "samples": [["3 3 2\n0 2 1 3\n1 1 2 3", "2 1 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2019", "各省省选", "江苏", "O2优化", "2-SAT"], "title": "[JSOI2019] 精准预测", "background": "JYY 和他的火星探险队再次登录火星小镇，并且打算把机器学习的知识传授给火星人，从而提高火星人的生活效率。但智力有限的火星人纷纷表示不相信计算机科学。为了让火星人彻底信服，JYY 的探险队找到了他们之前关于火星详细的数据记录，并且训练了一个预测模型，这个模型能准确地预测出火星人在未来的生死情况。", "description": "目前，火星小镇上有$n$个居民（编号$1,2,……,n$）。机器学习算法预测出这些居民在接下来$T$个时刻（编号$1,2,……,T$）的生死情况，每条预测都是如下两种形式之一：\n\n- 难兄难弟$0$ $t$ $x$ $y$：在$t$时刻，如果$x$是死亡状态，那么在$t+1$时刻，$y$是死亡状态。（注意，当$x$在$t$时刻是生存状态时，该预测也被认为是正确的）；\n\n- 死神来了$1$ $t$ $x$ $y$：在$t$时刻，如果$x$是生存状态，那么在$t$时刻，$y$是死亡状态。（注意，当$x$在$t$时刻是死亡状态时，该预测也被认为是正确的）。\n\n注意本题是对某个时刻进行生死状态的预测，如果某个人在$t$时刻是生存状态，在$t+1$时刻是死亡状态，你可以认为是在$t$到$t+1$这段时间内发生了某个事件导致其死亡。\n\n虽然 JYY 对自己从大数据中统计得到的模型非常自信，但火星人看到这些预测吓了一跳，表示实在难以接受这种设定，更是认为计算机科学是可怕的邪教，打破了他们平静的生活。为了安抚火星人的情绪， JYY 打算从这些预测结果中推导出一些火星人更容易接受的事实，从而安抚火星人的情绪。\n\n具体来说，JYY 首先假设对火星人生死的预测全部正确，在此基础上，JYY 希望为小镇上的每个居民$k$分别计算有多少个火星人有可能和他一起活到第$T+1$时刻，换言之，JYY 希望为每个火星人$k$计算\n\n$$\\sum_{1 \\leq i \\leq n,i \\neq k} \\operatorname{Live}(k,i)$$\n\n其中 $\\operatorname{Live}(i,j)=1$ 表示编号为$i$和$j$的火星人有可能同时在第 $T+1$ 时刻处于生还状态，否则$\\operatorname{Live}(i,j)=0$。\n\n注意火星人是不能够复活的。一个火星人可能在时刻$1$就处于死亡状态，也有可能有预测未覆盖的死亡情况发生（火星人在任何时候都可能死亡，但任意时刻观察到火星人的状态要么活着，要么死亡）。最后，注意到$\\operatorname{Live}$是为每一对火星人分别独立计算的，因此$\\operatorname{Live}(x,y)=1,\\operatorname{Live}(y,z)=1$并不意味着$\\operatorname{Live}(x,z)=1$。", "inputFormat": "输入第一行包含三个整数$T,n,m$。\n接下来有$m$行，每行表示一条预言，每条预言第一个整数$c$表示预言的类型：\n\n- $c=0$：接下来读入$t,x,y$；\n\n- $c=1$：接下来读入$t,x,y$。", "outputFormat": "输出$n$个数表示答案，用空格分割。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57734.png)", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2019] Accurate Prediction", "background": "JYY and his Mars exploration team have landed in the Mars town again. They plan to teach the Martians knowledge about machine learning to improve their life efficiency. However, the Martians, with limited intelligence, say they do not believe in computer science. To fully convince them, JYY's team found detailed historical records about Mars and trained a prediction model. This model can accurately predict whether Martians will live or die in the future.", "description": "Currently, there are $n$ residents in the Mars town (numbered $1,2,\\ldots,n$). A machine learning algorithm predicts the life-or-death status of these residents over the next $T$ moments (numbered $1,2,\\ldots,T$). Each prediction is one of the following two types:\n\n- Brothers in Misfortune $0$ $t$ $x$ $y$: At moment $t$, if $x$ is dead, then at moment $t+1$, $y$ is dead. (Note that if $x$ is alive at moment $t$, this prediction is also considered correct.)\n\n- Death God Arrives $1$ $t$ $x$ $y$: At moment $t$, if $x$ is alive, then at moment $t$, $y$ is dead. (Note that if $x$ is dead at moment $t$, this prediction is also considered correct.)\n\nNote that this problem is predicting the life-or-death status at a specific moment. If someone is alive at moment $t$ and dead at moment $t+1$, you may assume that some event happened during the time interval from $t$ to $t+1$ that caused their death.\n\nAlthough JYY is very confident in the model obtained from big data statistics, the Martians are shocked by these predictions and feel it is hard to accept such a setting. They even think computer science is a scary cult that has broken their peaceful life. To calm the Martians down, JYY plans to derive some facts from these prediction results that are easier for the Martians to accept.\n\nSpecifically, JYY first assumes that all predictions about the Martians' life and death are correct. Based on this, JYY wants to compute, for each resident $k$, how many Martians might be able to live together with him until moment $T+1$. In other words, for each Martian $k$, JYY wants to compute\n\n$$\\sum_{1 \\leq i \\leq n,i \\neq k} \\operatorname{Live}(k,i)$$\n\nwhere $\\operatorname{Live}(i,j)=1$ means that Martians $i$ and $j$ may possibly both be alive at moment $T+1$; otherwise, $\\operatorname{Live}(i,j)=0$.\n\nNote that Martians cannot be resurrected. A Martian may already be dead at moment $1$, and there may also be deaths not covered by any prediction (a Martian can die at any time, but at any moment, a Martian's observed state is either alive or dead). Finally, note that $\\operatorname{Live}$ is computed independently for each pair of Martians, so $\\operatorname{Live}(x,y)=1$ and $\\operatorname{Live}(y,z)=1$ does not imply $\\operatorname{Live}(x,z)=1$.", "inputFormat": "The first line contains three integers $T,n,m$.\nThe next $m$ lines each describe a prophecy. The first integer $c$ of each prophecy indicates its type:\n\n- $c=0$: then read $t,x,y$;\n\n- $c=1$: then read $t,x,y$.", "outputFormat": "Output $n$ numbers as the answers, separated by spaces.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57734.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2019] 精准预测", "background": "JYY 和他的火星探险队再次登录火星小镇，并且打算把机器学习的知识传授给火星人，从而提高火星人的生活效率。但智力有限的火星人纷纷表示不相信计算机科学。为了让火星人彻底信服，JYY 的探险队找到了他们之前关于火星详细的数据记录，并且训练了一个预测模型，这个模型能准确地预测出火星人在未来的生死情况。", "description": "目前，火星小镇上有$n$个居民（编号$1,2,……,n$）。机器学习算法预测出这些居民在接下来$T$个时刻（编号$1,2,……,T$）的生死情况，每条预测都是如下两种形式之一：\n\n- 难兄难弟$0$ $t$ $x$ $y$：在$t$时刻，如果$x$是死亡状态，那么在$t+1$时刻，$y$是死亡状态。（注意，当$x$在$t$时刻是生存状态时，该预测也被认为是正确的）；\n\n- 死神来了$1$ $t$ $x$ $y$：在$t$时刻，如果$x$是生存状态，那么在$t$时刻，$y$是死亡状态。（注意，当$x$在$t$时刻是死亡状态时，该预测也被认为是正确的）。\n\n注意本题是对某个时刻进行生死状态的预测，如果某个人在$t$时刻是生存状态，在$t+1$时刻是死亡状态，你可以认为是在$t$到$t+1$这段时间内发生了某个事件导致其死亡。\n\n虽然 JYY 对自己从大数据中统计得到的模型非常自信，但火星人看到这些预测吓了一跳，表示实在难以接受这种设定，更是认为计算机科学是可怕的邪教，打破了他们平静的生活。为了安抚火星人的情绪， JYY 打算从这些预测结果中推导出一些火星人更容易接受的事实，从而安抚火星人的情绪。\n\n具体来说，JYY 首先假设对火星人生死的预测全部正确，在此基础上，JYY 希望为小镇上的每个居民$k$分别计算有多少个火星人有可能和他一起活到第$T+1$时刻，换言之，JYY 希望为每个火星人$k$计算\n\n$$\\sum_{1 \\leq i \\leq n,i \\neq k} \\operatorname{Live}(k,i)$$\n\n其中 $\\operatorname{Live}(i,j)=1$ 表示编号为$i$和$j$的火星人有可能同时在第 $T+1$ 时刻处于生还状态，否则$\\operatorname{Live}(i,j)=0$。\n\n注意火星人是不能够复活的。一个火星人可能在时刻$1$就处于死亡状态，也有可能有预测未覆盖的死亡情况发生（火星人在任何时候都可能死亡，但任意时刻观察到火星人的状态要么活着，要么死亡）。最后，注意到$\\operatorname{Live}$是为每一对火星人分别独立计算的，因此$\\operatorname{Live}(x,y)=1,\\operatorname{Live}(y,z)=1$并不意味着$\\operatorname{Live}(x,z)=1$。", "inputFormat": "输入第一行包含三个整数$T,n,m$。\n接下来有$m$行，每行表示一条预言，每条预言第一个整数$c$表示预言的类型：\n\n- $c=0$：接下来读入$t,x,y$；\n\n- $c=1$：接下来读入$t,x,y$。", "outputFormat": "输出$n$个数表示答案，用空格分割。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57734.png)", "locale": "zh-CN"}}}
{"pid": "P5333", "type": "P", "difficulty": 7, "samples": [["2\n3\n1 2\n1 3\n2\n1 2", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "江苏", "O2优化"], "title": "[JSOI2019] 神经网络", "background": "火星探险队发现，火星人的思维方式与人类非常不同，是因为他们拥有与人类很不一样的神经网络结构。为了更好地理解火星人的行为模式，JYY 对小镇上火星人的大脑进行了扫描，得到了一些重要数据。", "description": "火星人在出生后，神经网络可以看作是一个由若干无向树 $\\{T_1(V_1, E_1), T_2(V_2, E_2),\\ldots T_m(V_m, E_m)\\}$ 构成的森林。随着火星人年龄的增长，神经连接的数量也不断增长。初始时，神经网络中生长的连接 $E^\\ast = \\varnothing$。神经网络根据如下规则生长：\n- 如果节点 $u \\in V_i, v \\in V_j$ 分别属于不同的无向树 $T_i$ 和 $T_j$（$i \\neq j$），则 $E^\\ast$ 中应当包含边 $(u, v)$。\n\n最终，在不再有神经网络连接可能生长后，神经网络之间的节点连接可以看成是一个无向图 $G(V,E)$，其中\n\n$$V=V_1\\cup V_2\\cup \\ldots \\cup V_m,E=E_1\\cup E_2\\cup \\ldots \\cup E_m\\cup E^\\ast$$\n\n火星人的决策是通过在 $G(V, E)$ 中建立环路完成的。针对不同的外界输入，火星人会建立不同的神经连接环路，从而做出不同的响应。为了了解火星人行为模式的复杂性，JYY 决定计算 $G$ **中哈密顿回路的数量**。\n\n$G(V, E)$ 的哈密顿回路是一条简单回路，从第一棵树的第一个节点出发，恰好经过 $V$ 中的其他节点一次且仅一次，并且回到第一棵树的第一个节点。", "inputFormat": "第一行读入 $m$，表示火星人神经网络初始时无向树的数量。  \n接下来输入有 $m$ 部分，第 $i$ 部分描述了树 $T_i$。  \n对于 $T_i$，输入的第一行是树 $T_i(V_i, E_i)$ 中节点的数量 $k_i$。假设 $V_i = \\{v_1, v_2,\\ldots ,v_{k_i}\\}$。  \n接下来 $k_{i} - 1$ 行，每行两个整数 $x, y$，表示该树节点 $v_x, v_y$（$1 \\le x, y \\le k_i$）之间有一条树边，即 $(v_x, v_y) \\in E_i$。", "outputFormat": "因为哈密顿回路的数量可能很多，你只需要输出一个非负整数，表示答案对 $998244353$ 取模后的值。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57736.png)", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2019] Neural Network", "background": "The Mars exploration team discovered that Martians think very differently from humans because they have a very different neural network structure. To better understand Martian behavior patterns, JYY scanned the brains of Martians in a small town and obtained some important data.", "description": "After a Martian is born, its neural network can be seen as a forest consisting of several undirected trees $\\{T_1(V_1, E_1), T_2(V_2, E_2),\\ldots T_m(V_m, E_m)\\}$. As the Martian grows older, the number of neural connections keeps increasing. Initially, the set of newly grown connections in the neural network is $E^\\ast = \\varnothing$. The neural network grows according to the following rule:\n- If nodes $u \\in V_i$ and $v \\in V_j$ belong to different undirected trees $T_i$ and $T_j$ respectively ($i \\neq j$), then $E^\\ast$ should contain the edge $(u, v)$.\n\nFinally, after no more neural network connections can grow, the connections between nodes in the neural network can be regarded as an undirected graph $G(V,E)$, where\n\n$$V=V_1\\cup V_2\\cup \\ldots \\cup V_m,E=E_1\\cup E_2\\cup \\ldots \\cup E_m\\cup E^\\ast$$\n\nMartians make decisions by creating cycles in $G(V, E)$. For different external inputs, Martians will create different neural connection cycles and thus produce different responses. To understand how complex Martian behavior patterns are, JYY decides to compute the **number of Hamiltonian cycles in $G$**.\n\nA Hamiltonian cycle of $G(V, E)$ is a simple cycle that starts from the first node of the first tree, visits every other node in $V$ exactly once, and then returns to the first node of the first tree.", "inputFormat": "The first line contains $m$, the number of undirected trees in the Martian neural network at the beginning.  \nThen there are $m$ parts, where the $i$-th part describes the tree $T_i$.  \nFor $T_i$, the first line contains $k_i$, the number of nodes in the tree $T_i(V_i, E_i)$. Assume $V_i = \\{v_1, v_2,\\ldots ,v_{k_i}\\}$.  \nIn the next $k_i - 1$ lines, each line contains two integers $x, y$, meaning there is a tree edge between nodes $v_x$ and $v_y$ ($1 \\le x, y \\le k_i$), i.e., $(v_x, v_y) \\in E_i$.", "outputFormat": "Since the number of Hamiltonian cycles can be very large, output a non-negative integer equal to the answer modulo $998244353$.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57736.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2019] 神经网络", "background": "火星探险队发现，火星人的思维方式与人类非常不同，是因为他们拥有与人类很不一样的神经网络结构。为了更好地理解火星人的行为模式，JYY 对小镇上火星人的大脑进行了扫描，得到了一些重要数据。", "description": "火星人在出生后，神经网络可以看作是一个由若干无向树 $\\{T_1(V_1, E_1), T_2(V_2, E_2),\\ldots T_m(V_m, E_m)\\}$ 构成的森林。随着火星人年龄的增长，神经连接的数量也不断增长。初始时，神经网络中生长的连接 $E^\\ast = \\varnothing$。神经网络根据如下规则生长：\n- 如果节点 $u \\in V_i, v \\in V_j$ 分别属于不同的无向树 $T_i$ 和 $T_j$（$i \\neq j$），则 $E^\\ast$ 中应当包含边 $(u, v)$。\n\n最终，在不再有神经网络连接可能生长后，神经网络之间的节点连接可以看成是一个无向图 $G(V,E)$，其中\n\n$$V=V_1\\cup V_2\\cup \\ldots \\cup V_m,E=E_1\\cup E_2\\cup \\ldots \\cup E_m\\cup E^\\ast$$\n\n火星人的决策是通过在 $G(V, E)$ 中建立环路完成的。针对不同的外界输入，火星人会建立不同的神经连接环路，从而做出不同的响应。为了了解火星人行为模式的复杂性，JYY 决定计算 $G$ **中哈密顿回路的数量**。\n\n$G(V, E)$ 的哈密顿回路是一条简单回路，从第一棵树的第一个节点出发，恰好经过 $V$ 中的其他节点一次且仅一次，并且回到第一棵树的第一个节点。", "inputFormat": "第一行读入 $m$，表示火星人神经网络初始时无向树的数量。  \n接下来输入有 $m$ 部分，第 $i$ 部分描述了树 $T_i$。  \n对于 $T_i$，输入的第一行是树 $T_i(V_i, E_i)$ 中节点的数量 $k_i$。假设 $V_i = \\{v_1, v_2,\\ldots ,v_{k_i}\\}$。  \n接下来 $k_{i} - 1$ 行，每行两个整数 $x, y$，表示该树节点 $v_x, v_y$（$1 \\le x, y \\le k_i$）之间有一条树边，即 $(v_x, v_y) \\in E_i$。", "outputFormat": "因为哈密顿回路的数量可能很多，你只需要输出一个非负整数，表示答案对 $998244353$ 取模后的值。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57736.png)", "locale": "zh-CN"}}}
{"pid": "P5334", "type": "P", "difficulty": 7, "samples": [["abaacaba", "1 1 3 3 3 6 3 8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "江苏", "O2优化"], "title": "[JSOI2019] 节日庆典", "background": "JYY 和探险队顺利完成了火星上的任务。在离开前，探险队正好赶上了火星人一年一度最盛大的节日「气球节」。然而，火星人遇到了每年一度的麻烦：怎样最美观地摆放气球。JYY 决定请你设计算法帮助火星人解决这个问题。", "description": "在庆典开始前，火星人会把气球准备好并串在一根绳子上。气球按顺序排列可以看成是一个由小写字母组成的长度为$n$的字符串$S$。然后，火星人会按照字符串的顺序逐个把气球加入到一个庆典的圆环上，并且表演一个节目庆祝。\n\n下图展示了一串气球 **cbbadbcd** 在进行到第$5$个节目时的情形，此时在庆典环上的气球是 **cbbad**。\n\n![](https://cdn.luogu.com.cn/upload/pic/57738.png)\n\n为了让每个节目都更好看，火星人希望在每个节目开始前调整气球在环上的顺序，使得每个节目的气球排布都最美观。对于一组气球（一个字符串），火星人认为最美观的字符串是庆典圆环上按绳子方向读出**字典序最小的字符串**，例如对于 **cbbad**，共有$5$个读出字符串的位置：\n\n- cbbad （$i=1$）；\n\n- bbadc （$i=2$）；\n\n- badcb （$i=3$）；\n\n- adcbb （$i=4$）；\n\n- dcbba （$i=5$）。\n\n如果有多个字典序最小的字符串，火星人希望找出**离绳头最近**的那个(即最小的那个)。更严谨地说，对于字符串，定义\n\n$$T_i=T[i……|T|]::T[1……i-1](1 \\leq i \\leq |T|)$$\n\n其中$::$是字符串的拼接操作。定义$f(T)$为最小的$i$（$1 \\leq i \\leq |T|$）满足$T_i=min(T_1,T_2,……,T_{|T|})$。\n\nJYY希望你帮助他设计一个算法，让火星人每个节目的气球排列都最美观，即对于给定字符串$S$的每一个前缀$S[1……i]$（$1 \\leq i \\leq |S|$），求出$f(S[1……i])$。", "inputFormat": "输入只有一行，该行包括一个字符串$S$。", "outputFormat": "在一行中对于每个$i$（$1 \\leq i \\leq |S|$），输出一个整数$f(S[1……i])$。输出的数字之间以空格分隔。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57739.png)", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2019] Festival Celebration", "background": "JYY and the expedition team successfully completed their mission on Mars. Before leaving, the team happened to catch the Martians’ biggest annual festival, the “Balloon Festival”. However, the Martians face a yearly problem: how to arrange the balloons in the most visually pleasing way. JYY decides to ask you to design an algorithm to help the Martians solve this problem.", "description": "Before the celebration begins, the Martians prepare the balloons and string them onto a rope. The balloons, in order, can be seen as a string $S$ of length $n$ consisting of lowercase letters. Then, the Martians will add the balloons one by one, following the order of the string, onto a circular ring for the celebration, and perform a show to celebrate.\n\nThe figure below shows the situation for the balloon string **cbbadbcd** at the $5$-th show. At this time, the balloons on the celebration ring are **cbbad**.\n\n![](https://cdn.luogu.com.cn/upload/pic/57738.png)\n\nTo make each show look better, the Martians want to adjust the order of the balloons on the ring before each show starts, so that the balloon arrangement for each show is the most visually pleasing. For a set of balloons (a string), the Martians define the most visually pleasing string as the **lexicographically smallest string** read along the rope direction on the celebration ring. For example, for **cbbad**, there are $5$ possible starting positions to read the string:\n\n- cbbad ($i=1$).\n\n- bbadc ($i=2$).\n\n- badcb ($i=3$).\n\n- adcbb ($i=4$).\n\n- dcbba ($i=5$).\n\nIf there are multiple lexicographically smallest strings, the Martians want the one **closest to the rope head** (i.e. the smallest $i$). More rigorously, for a string $T$, define\n\n$$T_i=T[i……|T|]::T[1……i-1](1 \\leq i \\leq |T|)$$\n\nwhere $::$ denotes string concatenation. Define $f(T)$ as the smallest $i$ ($1 \\leq i \\leq |T|$) such that $T_i=min(T_1,T_2,……,T_{|T|})$.\n\nJYY hopes you can help him design an algorithm so that the balloon arrangement for each show is the most visually pleasing. That is, for every prefix $S[1……i]$ ($1 \\leq i \\leq |S|$) of the given string $S$, compute $f(S[1……i])$.", "inputFormat": "There is only one line of input, containing a string $S$.", "outputFormat": "In one line, for each $i$ ($1 \\leq i \\leq |S|$), output an integer $f(S[1……i])$. Separate the numbers with spaces.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57739.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2019] 节日庆典", "background": "JYY 和探险队顺利完成了火星上的任务。在离开前，探险队正好赶上了火星人一年一度最盛大的节日「气球节」。然而，火星人遇到了每年一度的麻烦：怎样最美观地摆放气球。JYY 决定请你设计算法帮助火星人解决这个问题。", "description": "在庆典开始前，火星人会把气球准备好并串在一根绳子上。气球按顺序排列可以看成是一个由小写字母组成的长度为$n$的字符串$S$。然后，火星人会按照字符串的顺序逐个把气球加入到一个庆典的圆环上，并且表演一个节目庆祝。\n\n下图展示了一串气球 **cbbadbcd** 在进行到第$5$个节目时的情形，此时在庆典环上的气球是 **cbbad**。\n\n![](https://cdn.luogu.com.cn/upload/pic/57738.png)\n\n为了让每个节目都更好看，火星人希望在每个节目开始前调整气球在环上的顺序，使得每个节目的气球排布都最美观。对于一组气球（一个字符串），火星人认为最美观的字符串是庆典圆环上按绳子方向读出**字典序最小的字符串**，例如对于 **cbbad**，共有$5$个读出字符串的位置：\n\n- cbbad （$i=1$）；\n\n- bbadc （$i=2$）；\n\n- badcb （$i=3$）；\n\n- adcbb （$i=4$）；\n\n- dcbba （$i=5$）。\n\n如果有多个字典序最小的字符串，火星人希望找出**离绳头最近**的那个(即最小的那个)。更严谨地说，对于字符串，定义\n\n$$T_i=T[i……|T|]::T[1……i-1](1 \\leq i \\leq |T|)$$\n\n其中$::$是字符串的拼接操作。定义$f(T)$为最小的$i$（$1 \\leq i \\leq |T|$）满足$T_i=min(T_1,T_2,……,T_{|T|})$。\n\nJYY希望你帮助他设计一个算法，让火星人每个节目的气球排列都最美观，即对于给定字符串$S$的每一个前缀$S[1……i]$（$1 \\leq i \\leq |S|$），求出$f(S[1……i])$。", "inputFormat": "输入只有一行，该行包括一个字符串$S$。", "outputFormat": "在一行中对于每个$i$（$1 \\leq i \\leq |S|$），输出一个整数$f(S[1……i])$。输出的数字之间以空格分隔。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57739.png)", "locale": "zh-CN"}}}
{"pid": "P5335", "type": "P", "difficulty": 4, "samples": [["8\n1 jead\n1 dec\n3 de 0 0 10\n1 dec\n3 de 0 1 10\n2 dec\n3 de 0 1 10\n3 de 0 2 10", "2\n4\n4\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "哈希 hashing", "字典树 Trie", "THUSC"], "title": "[THUSC 2016] 补退选", "background": null, "description": "X 是 T 大的一名老师，每年他都要教授许多学生基础的 C++ 知识。在 T 大，每个学生在每学期的开学前都需要选课，每次选课一共分为三个阶段：预选，正选，补退选；其中「补退选」阶段最忙碌。\n\n在补退选阶段，学生即可以选课，也可以退课。对于X老师来说，在补退选阶段可能发生以下两种事件：\n\n1. 一个姓名为 $S$ 的学生选了他的课（姓名将出现在 X 的已选课学生名单中）            \n2. 一个姓名为 $S$ 的学生退了他的课（姓名将从 X 的已选课学生名单中移除）\n\n同时，X 老师对于有哪些学生选了他的课非常关心，所以他会不定时的查询已选课学生名单，每次查询最早在哪个事件之后，姓名以 $S$ 为前缀的学生数量超过了 $v$。\n\nX 老师看你骨骼惊奇，所以想用这个问题考考你，你当然不会畏惧，所以勇敢的接下了这个任务。\n\n**注意 1：学生的姓名可能相同，如果有 $p$ 个姓名相同的学生都选了 X 老师的课，则他们的姓名将出现在 X 老师的名单上 $p$ 次。**\n\n**注意 2：只有已经选了课的学生才会退课，如果姓名为 $S$ 的学生退课，则在他退课之前 X 老师的名单上一定有姓名。**\n\n**注意 3：选课，退课和查询都被定义为「事件」，「事件」的编号从 $1$ 开始。**", "inputFormat": "第一行包含一个正整数 $n$，表示一共发生了 $n$ 个事件。\n\n接下来 $n$ 行，每行描述一个事件；每行第一个正整数 $k$ 表示事件类型：\n\n1. 如果 $k = 1$，表示选课事件，接下来一个字符串 $S$，表示一个姓名为 $S$ 的学生选了 X 老师的课。   \n\n2. 如果 $k = 2$，表示退课事件，接下来一个字符串 $S$，表示一个姓名为 $S$ 的学生退了 X 老师的课。\n\n3. 如果 $k = 3$，表示查询事件，接下来一个字符串 $S$ 以及三个非负整数 $a,b,c$，表示 X 老师想知道最早在第几个事件之后，姓名以 $S$ 为前缀的学生数量超过了 $(a*|ANS|+b) \\bmod c$。$|ANS|$ 表示上次查询事件的答案的绝对值，如果当前是第一次查询，则 $ANS=0$；如果任何时刻都没有超过该值，则答案为 $-1$。\n     \n**注：输入中的所有字符串均只包含小写字母。**", "outputFormat": "对于每个查询事件，输出一行表示该查询答案。", "hint": "$n \\le 10^5,|S| \\le  60$，输入中的所有字符串只会包含前 $10$ 个小写字母。", "locale": "zh-CN", "translations": {"en": {"title": "[THUSC 2016] Add/Drop Period", "background": "", "description": "X is a teacher at University T. Every year, he teaches many students basic C++ knowledge. At University T, before the start of each semester, every student needs to choose courses. Each course selection process has three stages: pre-selection, main selection, and add/drop; among them, the “add/drop” stage is the busiest.\n\nDuring the add/drop stage, students can either add a course or drop a course. For Teacher X, the following two types of events may happen during the add/drop stage:\n\n1. A student with name $S$ adds his course (the name will appear in X’s list of enrolled students).\n2. A student with name $S$ drops his course (the name will be removed from X’s list of enrolled students).\n\nAt the same time, Teacher X cares a lot about which students have enrolled in his course, so he will query the enrolled-student list from time to time. For each query, he asks: after which event, as early as possible, does the number of students whose names have prefix $S$ become greater than $v$.\n\nTeacher X thinks you are talented, so he wants to test you with this problem. You are not afraid, so you bravely take on the task.\n\n**Note 1: Student names may be the same. If there are $p$ students with the same name who have all enrolled in Teacher X’s course, then their name will appear $p$ times in Teacher X’s list.**\n\n**Note 2: Only students who have already enrolled can drop the course. If a student with name $S$ drops the course, then before dropping, Teacher X’s list must contain that name.**\n\n**Note 3: Adding, dropping, and querying are all defined as “events”, and event indices start from $1$.**", "inputFormat": "The first line contains a positive integer $n$, indicating that a total of $n$ events occur.\n\nIn the next $n$ lines, each line describes an event. The first integer $k$ in each line indicates the event type:\n\n1. If $k = 1$, it is an add-course event. Next comes a string $S$, meaning that a student with name $S$ adds Teacher X’s course.\n2. If $k = 2$, it is a drop-course event. Next comes a string $S$, meaning that a student with name $S$ drops Teacher X’s course.\n3. If $k = 3$, it is a query event. Next comes a string $S$ and three non-negative integers $a, b, c$, meaning that Teacher X wants to know after which event, as early as possible, the number of students whose names have prefix $S$ becomes greater than $(a*|ANS|+b) \\bmod c$. $|ANS|$ denotes the absolute value of the answer to the previous query event. If this is the first query, then $ANS=0$. If this value is never exceeded at any time, then the answer is $-1$.\n\n**Note: All strings in the input contain only lowercase letters.**", "outputFormat": "For each query event, output one line containing the answer to that query.", "hint": "$n \\le 10^5, |S| \\le 60$. All strings in the input contain only the first $10$ lowercase letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUSC 2016] 补退选", "background": null, "description": "X 是 T 大的一名老师，每年他都要教授许多学生基础的 C++ 知识。在 T 大，每个学生在每学期的开学前都需要选课，每次选课一共分为三个阶段：预选，正选，补退选；其中「补退选」阶段最忙碌。\n\n在补退选阶段，学生即可以选课，也可以退课。对于X老师来说，在补退选阶段可能发生以下两种事件：\n\n1. 一个姓名为 $S$ 的学生选了他的课（姓名将出现在 X 的已选课学生名单中）            \n2. 一个姓名为 $S$ 的学生退了他的课（姓名将从 X 的已选课学生名单中移除）\n\n同时，X 老师对于有哪些学生选了他的课非常关心，所以他会不定时的查询已选课学生名单，每次查询最早在哪个事件之后，姓名以 $S$ 为前缀的学生数量超过了 $v$。\n\nX 老师看你骨骼惊奇，所以想用这个问题考考你，你当然不会畏惧，所以勇敢的接下了这个任务。\n\n**注意 1：学生的姓名可能相同，如果有 $p$ 个姓名相同的学生都选了 X 老师的课，则他们的姓名将出现在 X 老师的名单上 $p$ 次。**\n\n**注意 2：只有已经选了课的学生才会退课，如果姓名为 $S$ 的学生退课，则在他退课之前 X 老师的名单上一定有姓名。**\n\n**注意 3：选课，退课和查询都被定义为「事件」，「事件」的编号从 $1$ 开始。**", "inputFormat": "第一行包含一个正整数 $n$，表示一共发生了 $n$ 个事件。\n\n接下来 $n$ 行，每行描述一个事件；每行第一个正整数 $k$ 表示事件类型：\n\n1. 如果 $k = 1$，表示选课事件，接下来一个字符串 $S$，表示一个姓名为 $S$ 的学生选了 X 老师的课。   \n\n2. 如果 $k = 2$，表示退课事件，接下来一个字符串 $S$，表示一个姓名为 $S$ 的学生退了 X 老师的课。\n\n3. 如果 $k = 3$，表示查询事件，接下来一个字符串 $S$ 以及三个非负整数 $a,b,c$，表示 X 老师想知道最早在第几个事件之后，姓名以 $S$ 为前缀的学生数量超过了 $(a*|ANS|+b) \\bmod c$。$|ANS|$ 表示上次查询事件的答案的绝对值，如果当前是第一次查询，则 $ANS=0$；如果任何时刻都没有超过该值，则答案为 $-1$。\n     \n**注：输入中的所有字符串均只包含小写字母。**", "outputFormat": "对于每个查询事件，输出一行表示该查询答案。", "hint": "$n \\le 10^5,|S| \\le  60$，输入中的所有字符串只会包含前 $10$ 个小写字母。", "locale": "zh-CN"}}}
{"pid": "P5336", "type": "P", "difficulty": 6, "samples": [["10\n3 1\n7 10 9 10 6 7 10 7 1 2\n", "15"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "区间 DP", "THUSC"], "title": "[THUSC 2016] 成绩单", "background": "", "description": "期末考试结束了，班主任 L 老师要将成绩单分发到每位同学手中。L 老师共有 $n$ 份成绩单，按照编号从 $1$ 到 $n$ 的顺序叠放在桌子上，其中编号为 $i$ 的的成绩单分数为 $W_i$。       \n成绩单是按照批次发放的。发放成绩单时，L 老师会从当前的一叠成绩单中抽取连续的一段，让这些同学来领取自己的成绩单。当这批同学领取完毕后，L 老师再从剩余的成绩单中抽取连续的一段，供下一批同学领取。经过若干批次的领取后，成绩单将被全部发放到同学手中。       \n然而，分发成绩单是一件令人头痛的事情，一方面要照顾同学们的心理情绪，不能让分数相差太远的同学在同一批领取成绩单；另一方面要考虑时间成本，尽量减少领取成绩单的批次数。对于一个分发成绩单的方案，我们定义其代价为：    \n$$a \\times k + b \\times \\sum_{i = 1} ^ k (max_i - min_i) ^ 2$$        \n其中 $k$ 是分发的批次数，对于第 $i$ 批分发的成绩单，$max_i$ 是最高分数，$min_i$ 是最低分数，$a$ 和 $b$ 是给定的评估参数。现在，请你帮助 L 老师找到代价最小的分发成绩单的方案，并将这个最小的代价告诉 L 老师。当然，分发成绩单的批次数 $k$ 是你决定的。\n", "inputFormat": "第一行包含一个正整数 $n$，表示成绩单的数量。第二行包含两个非负整数 $a,b$，表示给定的评估参数。第三行包含 $n$ 个正整数，$w_i$ 表示第 $i$ 张成绩单上的分数。", "outputFormat": "仅一个正整数，表示最小的代价是多少。  ", "hint": "$n \\leq 50$，$a \\leq 1500$，$b \\leq 10$，$w_i \\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[THUSC 2016] Report Cards", "background": "", "description": "The final exams are over. Head teacher Mr. L needs to hand out the report cards to every student. Mr. L has $n$ report cards, stacked on the desk in order from $1$ to $n$, where the score on report card $i$ is $W_i$.\n\nThe report cards are handed out in batches. When handing them out, Mr. L will take a consecutive segment from the current stack of report cards, and the students in that segment come to pick up their own report cards. After this batch of students finishes, Mr. L then takes another consecutive segment from the remaining report cards for the next batch. After several batches, all report cards will be handed out.\n\nHowever, handing out report cards is a headache. On one hand, he needs to take care of the students' feelings, so students with scores that differ too much should not pick up their report cards in the same batch. On the other hand, he must consider the time cost and try to reduce the number of batches.\n\nFor a distribution plan, we define its cost as:\n$$a \\times k + b \\times \\sum_{i = 1} ^ k (max_i - min_i) ^ 2$$\nwhere $k$ is the number of batches. For the report cards handed out in the $i$-th batch, $max_i$ is the highest score and $min_i$ is the lowest score. $a$ and $b$ are given evaluation parameters. Now, please help Mr. L find the plan with the minimum cost, and report this minimum cost to Mr. L. Of course, the number of batches $k$ is up to you.", "inputFormat": "The first line contains a positive integer $n$, indicating the number of report cards. The second line contains two non-negative integers $a, b$, indicating the given evaluation parameters. The third line contains $n$ positive integers $w_i$, where $w_i$ is the score on the $i$-th report card.", "outputFormat": "Output a single positive integer, indicating the minimum cost.", "hint": "Constraints: $n \\leq 50$，$a \\leq 1500$，$b \\leq 10$，$w_i \\leq 1000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUSC 2016] 成绩单", "background": "", "description": "期末考试结束了，班主任 L 老师要将成绩单分发到每位同学手中。L 老师共有 $n$ 份成绩单，按照编号从 $1$ 到 $n$ 的顺序叠放在桌子上，其中编号为 $i$ 的的成绩单分数为 $W_i$。       \n成绩单是按照批次发放的。发放成绩单时，L 老师会从当前的一叠成绩单中抽取连续的一段，让这些同学来领取自己的成绩单。当这批同学领取完毕后，L 老师再从剩余的成绩单中抽取连续的一段，供下一批同学领取。经过若干批次的领取后，成绩单将被全部发放到同学手中。       \n然而，分发成绩单是一件令人头痛的事情，一方面要照顾同学们的心理情绪，不能让分数相差太远的同学在同一批领取成绩单；另一方面要考虑时间成本，尽量减少领取成绩单的批次数。对于一个分发成绩单的方案，我们定义其代价为：    \n$$a \\times k + b \\times \\sum_{i = 1} ^ k (max_i - min_i) ^ 2$$        \n其中 $k$ 是分发的批次数，对于第 $i$ 批分发的成绩单，$max_i$ 是最高分数，$min_i$ 是最低分数，$a$ 和 $b$ 是给定的评估参数。现在，请你帮助 L 老师找到代价最小的分发成绩单的方案，并将这个最小的代价告诉 L 老师。当然，分发成绩单的批次数 $k$ 是你决定的。\n", "inputFormat": "第一行包含一个正整数 $n$，表示成绩单的数量。第二行包含两个非负整数 $a,b$，表示给定的评估参数。第三行包含 $n$ 个正整数，$w_i$ 表示第 $i$ 张成绩单上的分数。", "outputFormat": "仅一个正整数，表示最小的代价是多少。  ", "hint": "$n \\leq 50$，$a \\leq 1500$，$b \\leq 10$，$w_i \\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P5337", "type": "P", "difficulty": 5, "samples": [["2\nab\n", "675\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "各省省选", "矩阵加速", "天津"], "title": "[TJOI2019] 甲苯先生的字符串", "background": "TJOI2019 D1T1\n\n源文件名：str.*\n\n时间限制: 1s 内存限制: 128M", "description": "一天小甲苯得到了一条神的指示，他要把神的指示写下来，但是又不能泄露天机，所以他要用一种方法把神的指示记下来。神的指示是一个字符串，记为字符串 $s_1$，$s_1$ 仅包含 $26$ 个小写字母。现在小甲苯想要写下神的指示，记为字符串 $s_2$，$s_2$ 仅包含 $26$ 个小写字母，要求 $s_1$ 中的相邻的两个字母不能在 $s_2$ 中相邻地出现。现在给定 $s_2$ 的长度，小甲苯想知道他有多少种方法可以将神的指示写下来。输出种类数结果对 $10^9+7$ 取模。", "inputFormat": "第一行只有一个正整数 $n$，代表字符串 $s_2$ 的长度。 \n\n第二行是一个字符串，代表字符串 $s_1$。", "outputFormat": "输出一个整数，表示小甲苯可以写出的字符串的总数。结果对$10^9+7$ 取模", "hint": "对于 $30\\%$ 的数据 $n\\le100000$。\n\n对于 $100\\%$ 的数据 $1 \\le n\\le10^{15}$，$|s_1| \\le 10^5$。\n\n说明：相邻要求顺序相同，如样例中的 $s_2$ 里不能出现 $\\text{ab}$，且仅不能出现 $\\text{ab}$，但可以出现 $\\text{ba}$。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Mr. Toluene's String", "background": "TJOI2019 D1T1.\n\nSource file name: str.*.\n\nTime limit: 1 s. Memory limit: 128 M.", "description": "One day, Xiao Toluene received a divine message. He wants to write it down, but cannot reveal the secret, so he decides to record it in a special way.\n\nThe divine message is a string, denoted as $s_1$. $s_1$ contains only $26$ lowercase letters. Now Xiao Toluene wants to write down the message as another string, denoted as $s_2$. $s_2$ also contains only $26$ lowercase letters. The requirement is: any two adjacent letters in $s_1$ must not appear adjacent in $s_2$.\n\nGiven the length of $s_2$, Xiao Toluene wants to know how many different strings $s_2$ he can write. Output the number of valid strings modulo $10^9+7$.", "inputFormat": "The first line contains a single positive integer $n$, representing the length of string $s_2$.\n\nThe second line contains a string, representing string $s_1$.", "outputFormat": "Output one integer, representing the total number of strings that Xiao Toluene can write. Take the result modulo $10^9+7$.", "hint": "For $30\\%$ of the testdata, $n \\le 100000$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^{15}$, $|s_1| \\le 10^5$.\n\nNote: The adjacency restriction requires the same order. For example, in the sample, $s_2$ must not contain $\\text{ab}$, and only $\\text{ab}$ is forbidden, but $\\text{ba}$ is allowed.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 甲苯先生的字符串", "background": "TJOI2019 D1T1\n\n源文件名：str.*\n\n时间限制: 1s 内存限制: 128M", "description": "一天小甲苯得到了一条神的指示，他要把神的指示写下来，但是又不能泄露天机，所以他要用一种方法把神的指示记下来。神的指示是一个字符串，记为字符串 $s_1$，$s_1$ 仅包含 $26$ 个小写字母。现在小甲苯想要写下神的指示，记为字符串 $s_2$，$s_2$ 仅包含 $26$ 个小写字母，要求 $s_1$ 中的相邻的两个字母不能在 $s_2$ 中相邻地出现。现在给定 $s_2$ 的长度，小甲苯想知道他有多少种方法可以将神的指示写下来。输出种类数结果对 $10^9+7$ 取模。", "inputFormat": "第一行只有一个正整数 $n$，代表字符串 $s_2$ 的长度。 \n\n第二行是一个字符串，代表字符串 $s_1$。", "outputFormat": "输出一个整数，表示小甲苯可以写出的字符串的总数。结果对$10^9+7$ 取模", "hint": "对于 $30\\%$ 的数据 $n\\le100000$。\n\n对于 $100\\%$ 的数据 $1 \\le n\\le10^{15}$，$|s_1| \\le 10^5$。\n\n说明：相邻要求顺序相同，如样例中的 $s_2$ 里不能出现 $\\text{ab}$，且仅不能出现 $\\text{ab}$，但可以出现 $\\text{ba}$。", "locale": "zh-CN"}}}
{"pid": "P5338", "type": "P", "difficulty": 6, "samples": [["1\n7 3 1\n", "0\n1\n0\n"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2019", "各省省选", "平衡树", "天津"], "title": "[TJOI2019] 甲苯先生的滚榜", "background": "", "description": "甲苯先生在制作一个 Online Judge，他发现做比赛的人们很关心自己的排名（显而易见）。\n\n在 ACM 赛制的比赛中，如果通过题目数量不相等，则通过题目数量多的人排名更靠前；  \n如果通过题目数量相等，则罚时更少的人排名更高。\n\n甲苯先生想让大家帮忙设计一个程序，每次有人通过之后，就告诉他排名在他的前面有多少人。  \n（不包括和他罚时题数都相同的同学）", "inputFormat": "第一行输入一个整数 $T$ 表示测试样例的个数。\n\n对于每一个样例，输入三个整数 $m, n, \\text{seed}$。  \n$m$ 表示参赛总人数（编号 $1 \\sim m$），$n$ 表示一共有 $n$ 次 AC（假设 AC 已经去重，即不存在相同人的相同题目提交）。  \n$\\text{seed}$ 表示生成数据的种子。\n\n接下来要求同学们使用之下的函数生成数据：\n```cpp\ntypedef unsigned int ui ;\nui randNum( ui& seed , ui last , const ui m){ \n    seed = seed * 17 + last ; return seed % m + 1; \n}\n```\n（$\\texttt{last}$ 为上一次输出的结果，在没有输出结果时 $\\texttt{last} = 7$，多组数据时 $\\texttt{last}$ 不需要重新赋值）  \n要求每次生成两个数据 $\\texttt{Ria}, \\texttt{Rib}$，表示第 $\\texttt{Ria}$ 个人 AC 了一道题目，他的罚时为 $\\texttt{Rib}$。  \n（也就是说 $\\texttt{Ria}$ 的题目数量 $+1$，罚时长度 $+\\texttt{Rib}$）。\n\n要求一共生成 $n$ 组数据，代表一共有 $n$ 次提交。\n\n对于所有数据，保证罚时总和不超过 $1.5\\times 10^6$。", "outputFormat": "每次提交输出一行整数，表示在第 $\\texttt{Ria}$ 个人 AC 后，比 $\\texttt{Ria}$ 成绩高的有多少个选手。", "hint": "| 测试点# | 1, 2 | 3, 4 | 5 |6, 7, 8 | 9, 10 |\n| :-: | :-: | :-: | :-: | :-: |:-:|\n| $T$ | $\\le10$ | $\\le5$ | $\\le15$ | $\\le5$ | $\\le5$ |\n| $m$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^4$ |$\\le10^5$|\n| $n$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^6$ |$\\le10^6$|\n", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Mr. Toluene’s Rolling Leaderboard.", "background": "", "description": "Mr. Toluene is building an Online Judge. He noticed that people participating in contests care a lot about their rank (obviously).\n\nIn an ACM-style contest, if the numbers of solved problems are different, the person who solved more problems ranks higher.  \nIf the numbers of solved problems are the same, the person with less penalty time ranks higher.\n\nMr. Toluene wants everyone to help design a program: after each time someone gets an accepted solution, tell him how many people are ranked ahead of that person.  \n(This does not include contestants who have exactly the same number of solved problems and the same penalty time.)", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nFor each test case, input three integers $m, n, \\text{seed}$.  \n$m$ is the total number of contestants (numbered $1 \\sim m$), $n$ means there are $n$ AC events in total (assume AC events are already deduplicated, i.e., there is no submission of the same problem by the same person).  \n$\\text{seed}$ is the seed used to generate the data.\n\nThen you must use the following function to generate the data:\n```cpp\ntypedef unsigned int ui ;\nui randNum( ui& seed , ui last , const ui m){ \n    seed = seed * 17 + last ; return seed % m + 1; \n}\n```\n($\\texttt{last}$ is the previous output value. When there has been no output yet, $\\texttt{last} = 7$. For multiple test cases, $\\texttt{last}$ does not need to be reset.)  \nEach time, generate two values $\\texttt{Ria}, \\texttt{Rib}$, meaning that contestant $\\texttt{Ria}$ gets an AC for one problem, and the added penalty time is $\\texttt{Rib}$.  \n(That is, the solved count of $\\texttt{Ria}$ becomes $+1$, and the penalty time becomes $+\\texttt{Rib}$.)\n\nGenerate a total of $n$ pairs of data, meaning there are $n$ submissions in total.\n\nFor all testdata, it is guaranteed that the total sum of penalty times does not exceed $1.5\\times 10^6$.", "outputFormat": "For each submission, output one line with an integer: after contestant $\\texttt{Ria}$ gets an AC, how many contestants have a better result than $\\texttt{Ria}$.", "hint": "| Test Point # | 1, 2 | 3, 4 | 5 | 6, 7, 8 | 9, 10 |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $T$ | $\\le10$ | $\\le5$ | $\\le15$ | $\\le5$ | $\\le5$ |\n| $m$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^4$ | $\\le10^5$ |\n| $n$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^6$ | $\\le10^6$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 甲苯先生的滚榜", "background": "", "description": "甲苯先生在制作一个 Online Judge，他发现做比赛的人们很关心自己的排名（显而易见）。\n\n在 ACM 赛制的比赛中，如果通过题目数量不相等，则通过题目数量多的人排名更靠前；  \n如果通过题目数量相等，则罚时更少的人排名更高。\n\n甲苯先生想让大家帮忙设计一个程序，每次有人通过之后，就告诉他排名在他的前面有多少人。  \n（不包括和他罚时题数都相同的同学）", "inputFormat": "第一行输入一个整数 $T$ 表示测试样例的个数。\n\n对于每一个样例，输入三个整数 $m, n, \\text{seed}$。  \n$m$ 表示参赛总人数（编号 $1 \\sim m$），$n$ 表示一共有 $n$ 次 AC（假设 AC 已经去重，即不存在相同人的相同题目提交）。  \n$\\text{seed}$ 表示生成数据的种子。\n\n接下来要求同学们使用之下的函数生成数据：\n```cpp\ntypedef unsigned int ui ;\nui randNum( ui& seed , ui last , const ui m){ \n    seed = seed * 17 + last ; return seed % m + 1; \n}\n```\n（$\\texttt{last}$ 为上一次输出的结果，在没有输出结果时 $\\texttt{last} = 7$，多组数据时 $\\texttt{last}$ 不需要重新赋值）  \n要求每次生成两个数据 $\\texttt{Ria}, \\texttt{Rib}$，表示第 $\\texttt{Ria}$ 个人 AC 了一道题目，他的罚时为 $\\texttt{Rib}$。  \n（也就是说 $\\texttt{Ria}$ 的题目数量 $+1$，罚时长度 $+\\texttt{Rib}$）。\n\n要求一共生成 $n$ 组数据，代表一共有 $n$ 次提交。\n\n对于所有数据，保证罚时总和不超过 $1.5\\times 10^6$。", "outputFormat": "每次提交输出一行整数，表示在第 $\\texttt{Ria}$ 个人 AC 后，比 $\\texttt{Ria}$ 成绩高的有多少个选手。", "hint": "| 测试点# | 1, 2 | 3, 4 | 5 |6, 7, 8 | 9, 10 |\n| :-: | :-: | :-: | :-: | :-: |:-:|\n| $T$ | $\\le10$ | $\\le5$ | $\\le15$ | $\\le5$ | $\\le5$ |\n| $m$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^4$ |$\\le10^5$|\n| $n$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^6$ |$\\le10^6$|\n", "locale": "zh-CN"}}}
{"pid": "P5339", "type": "P", "difficulty": 6, "samples": [["4 4 3 2 1\n", "174\n"], ["996 208 221 132 442\n", "442572391\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2019", "各省省选", "组合数学", "天津"], "title": "[TJOI2019] 唱、跳、rap和篮球", "background": "TJOI2019 D1T3\n\n源文件名：queue.\\*\n\n时间限制：4s 内存限制：128M", "description": "大中锋的学院要组织学生参观博物馆，要求学生们在博物馆中排成一队进行参观。他的同学可以分为四类：一部分最喜欢唱、一部分最喜欢跳、一部分最喜欢 rap，还有一部分最喜欢篮球。如果队列中 $k$, $k + 1$, $k + 2$, $k + 3$ 位置上的同学依次，最喜欢唱、最喜欢跳、最喜欢 rap、最喜欢篮球，那么他们就会聚在一起讨论蔡徐坤。大中锋不希望这种事情发生，因为这会使得队伍显得很乱。大中锋想知道有多少种排队的方法，不会有学生聚在一起讨论蔡徐坤。两个学生队伍被认为是不同的，当且仅当两个队伍中至少有一个位置上的学生的喜好不同。由于合法的队伍可能会有很多种，种类数对 $998244353$ 取模。", "inputFormat": "输入数据只有一行。每行 $5$ 个整数，第一个整数 $n$，代表大中锋的学院要组织多少人去参观博物馆。接下来四个整数 $a$、$b$、$c$、$d$，分别代表学生中最喜欢唱的人数、最喜欢跳的人数、最喜欢 rap 的人数和最喜欢篮球的人数。保证 $a+b+c+d \\ge n$。", "outputFormat": "每组数据输出一个整数，代表你可以安排出多少种不同的学生队伍，使得队伍中没有学生聚在一起讨论蔡徐坤。结果对 $998244353$ 取模。", "hint": "对于 20% 的数据，有 $n=a=b=c=d\\le500$。\n\n对于 100% 的数据，有 $n \\le 1000$，$a, b, c, d \\le 500$。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Singing, Dancing, Rap, and Basketball", "background": "TJOI2019 D1T3.\n\nSource file name: queue.\\*.\n\nTime limit: 4 s. Memory limit: 128 M.", "description": "Da Zhongfeng’s academy is going to organize students to visit a museum, and requires the students to line up in a single queue in the museum.\n\nHis classmates can be divided into four types: some like singing the most, some like dancing the most, some like rap the most, and some like basketball the most. If the students at positions $k$, $k + 1$, $k + 2$, $k + 3$ in the queue, in order, like singing the most, like dancing the most, like rap the most, and like basketball the most, then they will gather together to discuss Cai Xukun. Da Zhongfeng does not want this to happen, because it will make the queue look messy.\n\nDa Zhongfeng wants to know how many ways there are to arrange the queue so that no students will gather together to discuss Cai Xukun. Two queues are considered different if and only if there exists at least one position where the students’ preferences are different. Since the number of valid queues may be very large, output it modulo $998244353$.", "inputFormat": "The input contains only one line. The line contains $5$ integers. The first integer is $n$, the number of students going to visit the museum. The next four integers $a$, $b$, $c$, $d$ represent the number of students who like singing the most, like dancing the most, like rap the most, and like basketball the most, respectively. It is guaranteed that $a+b+c+d \\ge n$.", "outputFormat": "Output one integer, representing how many different student queues you can arrange such that there are no students gathering together to discuss Cai Xukun. Output the result modulo $998244353$.", "hint": "For $20\\%$ of the testdata, $n=a=b=c=d\\le500$.\n\nFor $100\\%$ of the testdata, $n \\le 1000$, $a, b, c, d \\le 500$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 唱、跳、rap和篮球", "background": "TJOI2019 D1T3\n\n源文件名：queue.\\*\n\n时间限制：4s 内存限制：128M", "description": "大中锋的学院要组织学生参观博物馆，要求学生们在博物馆中排成一队进行参观。他的同学可以分为四类：一部分最喜欢唱、一部分最喜欢跳、一部分最喜欢 rap，还有一部分最喜欢篮球。如果队列中 $k$, $k + 1$, $k + 2$, $k + 3$ 位置上的同学依次，最喜欢唱、最喜欢跳、最喜欢 rap、最喜欢篮球，那么他们就会聚在一起讨论蔡徐坤。大中锋不希望这种事情发生，因为这会使得队伍显得很乱。大中锋想知道有多少种排队的方法，不会有学生聚在一起讨论蔡徐坤。两个学生队伍被认为是不同的，当且仅当两个队伍中至少有一个位置上的学生的喜好不同。由于合法的队伍可能会有很多种，种类数对 $998244353$ 取模。", "inputFormat": "输入数据只有一行。每行 $5$ 个整数，第一个整数 $n$，代表大中锋的学院要组织多少人去参观博物馆。接下来四个整数 $a$、$b$、$c$、$d$，分别代表学生中最喜欢唱的人数、最喜欢跳的人数、最喜欢 rap 的人数和最喜欢篮球的人数。保证 $a+b+c+d \\ge n$。", "outputFormat": "每组数据输出一个整数，代表你可以安排出多少种不同的学生队伍，使得队伍中没有学生聚在一起讨论蔡徐坤。结果对 $998244353$ 取模。", "hint": "对于 20% 的数据，有 $n=a=b=c=d\\le500$。\n\n对于 100% 的数据，有 $n \\le 1000$，$a, b, c, d \\le 500$。", "locale": "zh-CN"}}}
{"pid": "P5340", "type": "P", "difficulty": 4, "samples": [["1\n2 1 1\n1 1\n1 2 1\n1 2", "-1"], ["1\n2 1 2\n1 1\n1 2 1\n1 2", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "各省省选", "O2优化", "天津"], "title": "[TJOI2019] 大中锋的游乐场", "background": "", "description": "大中锋正在一个游乐场里玩耍。游乐场里有 $n$ 个娱乐设施，娱乐设施之间相互有共 $m$ 条道路相连，经过每一条路都需要花费一定的时间。为了方便游客，每一个娱乐设施旁都会配有一个小卖部，一部分小卖部会销售可乐，另一部分会销售汉堡。\n\n由于大中锋十分贪吃，所以每当他走到一个娱乐设施，他都会先去购买一杯可乐或一个汉堡，并把它们吃掉。但如果大中锋吃掉的汉堡数量比他喝掉的可乐数量多于 $k$ ，那他就会感到很渴；如果喝掉的可乐数量比吃掉的汉堡数量多于 $k$ ，那他就会感到很饿。\n\n现在大中锋正在第 $a$ 个娱乐设施，他想前往第 $b$ 个娱乐设施，但在他前进的路途中他不希望自己很渴或很饿。大中锋想知道自己在路上少花费多少时间。但由于大中锋很懒惰，他不想思考这个问题。你能帮助他解决这个问题吗？\n\n注意：大中锋非常贪吃，所以他到达每个点的第一件事是去吃(或者喝)，才考虑其他的事情，所以在起始点和终点他都会去买汉堡(可乐)，你也需要保证在这两个点他不会感到很饿或者很渴。", "inputFormat": "输入的第一行是一个整数 $T$ 表示数据组数数，对于每组数据的格式如下：\n\n第一行有三个整数，分别代表游乐场的娱乐设施个数 $n$，游乐场的道路数 $m$ ， 以及给出的参数 $k$，其含义见【题目描述】。\n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表编号为 $i$ 的娱乐设施旁的小卖部销售的物品，$1$ 表示可乐，$2$ 表示汉堡。\n\n第 $3$ 到第 $(m + 2)$ 行，每行三个整数 $u, v, w$，代表从第 $u$ 个娱乐设施到第 $v$ 个娱乐设施有存在一条双向道路，通过该道路需要花费时间 $w$。\n\n第 $m + 3$ 行有两个整数 $s, t$ ，代表大中锋想从娱乐设施 $s$ 前往娱乐设施 $t$。", "outputFormat": "对于每组数据输出一行一个整数表示答案。如果无解，请输出 $-1$。", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq 50,m\\leq 1000$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n\\leq 10000$，$1 \\leq m\\leq 100000$，$1 \\leq k\\leq 10$，$1 \\leq a_i \\leq 2$，$1 \\leq u, v,s, t \\leq n$，$1 \\leq w \\leq 10000$。\n\n对于所有数据，保证 $1 \\leq T \\leq 10$ ，且每个测试点的大数据不超过 $2$ 个。\n\n#### 题目补充说明\n\n- 路径不一定是简单路径。\n- 大中锋可以多次经过一个节点，同时每次都会取得汉堡/可乐。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Big Center Forward’s Amusement Park", "background": "", "description": "Big Center Forward is playing in an amusement park. There are $n$ attractions in the park, connected by a total of $m$ roads. Traveling along each road takes a certain amount of time. For the convenience of visitors, each attraction has a snack shop next to it: some shops sell cola, and the others sell hamburgers.\n\nBecause Big Center Forward loves eating, every time he arrives at an attraction, he will first buy either a cup of cola or a hamburger and consume it. However, if the number of hamburgers he has eaten exceeds the number of colas he has drunk by more than $k$, he will feel very thirsty; if the number of colas he has drunk exceeds the number of hamburgers he has eaten by more than $k$, he will feel very hungry.\n\nNow Big Center Forward is at attraction $a$ and wants to go to attraction $b$, but he does not want to feel very thirsty or very hungry during the trip. He wants to know the minimum total time spent on the way. Since Big Center Forward is very lazy and does not want to think about it, can you help him solve this problem?\n\nNote: Big Center Forward is extremely greedy, so the first thing he does upon arriving at each node is to eat (or drink), and only then consider other things. Therefore, he will buy a hamburger (or cola) at both the starting point and the ending point as well. You also need to ensure that at these two nodes he will not feel very hungry or very thirsty.", "inputFormat": "The first line contains an integer $T$, indicating the number of test cases. For each test case, the format is as follows.\n\nThe first line contains three integers $n$, $m$, and $k$, representing the number of attractions, the number of roads, and the given parameter $k$ as described in the statement.\n\nThe second line contains $n$ integers. The $i$-th integer $a_i$ indicates the item sold by the shop next to attraction $i$: $1$ means cola, and $2$ means hamburger.\n\nLines $3$ to $(m + 2)$ each contain three integers $u, v, w$, indicating that there is an undirected road between attraction $u$ and attraction $v$, and traveling along this road takes time $w$.\n\nLine $m + 3$ contains two integers $s, t$, indicating that Big Center Forward wants to travel from attraction $s$ to attraction $t$.", "outputFormat": "For each test case, output one line containing one integer, the answer. If there is no feasible solution, output $-1$.", "hint": "#### Constraints\n\n- For $30\\%$ of the testdata, $n\\leq 50, m\\leq 1000$.\n- For $100\\%$ of the testdata, $1 \\leq n\\leq 10000$, $1 \\leq m\\leq 100000$, $1 \\leq k\\leq 10$, $1 \\leq a_i \\leq 2$, $1 \\leq u, v, s, t \\leq n$, $1 \\leq w \\leq 10000$.\n\nFor all testdata, $1 \\leq T \\leq 10$, and in each test point, the number of large testdata cases does not exceed $2$.\n\n#### Additional Notes\n\n- The path is not necessarily a simple path.\n- Big Center Forward may pass through a node multiple times, and each time he will obtain a hamburger/cola.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 大中锋的游乐场", "background": "", "description": "大中锋正在一个游乐场里玩耍。游乐场里有 $n$ 个娱乐设施，娱乐设施之间相互有共 $m$ 条道路相连，经过每一条路都需要花费一定的时间。为了方便游客，每一个娱乐设施旁都会配有一个小卖部，一部分小卖部会销售可乐，另一部分会销售汉堡。\n\n由于大中锋十分贪吃，所以每当他走到一个娱乐设施，他都会先去购买一杯可乐或一个汉堡，并把它们吃掉。但如果大中锋吃掉的汉堡数量比他喝掉的可乐数量多于 $k$ ，那他就会感到很渴；如果喝掉的可乐数量比吃掉的汉堡数量多于 $k$ ，那他就会感到很饿。\n\n现在大中锋正在第 $a$ 个娱乐设施，他想前往第 $b$ 个娱乐设施，但在他前进的路途中他不希望自己很渴或很饿。大中锋想知道自己在路上少花费多少时间。但由于大中锋很懒惰，他不想思考这个问题。你能帮助他解决这个问题吗？\n\n注意：大中锋非常贪吃，所以他到达每个点的第一件事是去吃(或者喝)，才考虑其他的事情，所以在起始点和终点他都会去买汉堡(可乐)，你也需要保证在这两个点他不会感到很饿或者很渴。", "inputFormat": "输入的第一行是一个整数 $T$ 表示数据组数数，对于每组数据的格式如下：\n\n第一行有三个整数，分别代表游乐场的娱乐设施个数 $n$，游乐场的道路数 $m$ ， 以及给出的参数 $k$，其含义见【题目描述】。\n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表编号为 $i$ 的娱乐设施旁的小卖部销售的物品，$1$ 表示可乐，$2$ 表示汉堡。\n\n第 $3$ 到第 $(m + 2)$ 行，每行三个整数 $u, v, w$，代表从第 $u$ 个娱乐设施到第 $v$ 个娱乐设施有存在一条双向道路，通过该道路需要花费时间 $w$。\n\n第 $m + 3$ 行有两个整数 $s, t$ ，代表大中锋想从娱乐设施 $s$ 前往娱乐设施 $t$。", "outputFormat": "对于每组数据输出一行一个整数表示答案。如果无解，请输出 $-1$。", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq 50,m\\leq 1000$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n\\leq 10000$，$1 \\leq m\\leq 100000$，$1 \\leq k\\leq 10$，$1 \\leq a_i \\leq 2$，$1 \\leq u, v,s, t \\leq n$，$1 \\leq w \\leq 10000$。\n\n对于所有数据，保证 $1 \\leq T \\leq 10$ ，且每个测试点的大数据不超过 $2$ 个。\n\n#### 题目补充说明\n\n- 路径不一定是简单路径。\n- 大中锋可以多次经过一个节点，同时每次都会取得汉堡/可乐。", "locale": "zh-CN"}}}
{"pid": "P5341", "type": "P", "difficulty": 6, "samples": [["6\naab 1\nabc 1\naaaa 2\nabab 2\nababacc 2\nabab 4", "2\n1\n3\n1\n2\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "各省省选", "天津"], "title": "[TJOI2019] 甲苯先生和大中锋的字符串", "background": "TJOI2019 D2T2\n\n源文件名：substring.*\n\n时间限制: 1s 内存限制: 128M", "description": "大中锋有一个长度为 $n$ 的字符串，他只知道其中的一个子串是祖上传下来的宝藏的密码。但是由于字符串很长，大中锋很难将这些子串一一尝试。\n\n这天大中锋找到甲苯先生算命，但是甲苯先生说：“天机不可泄漏”。\n\n在大中锋的苦苦哀求下，甲苯先生告诉大中锋：“密码是在字符串中恰好出现了 $k$ 次的子串”。\n\n但是大中锋不知道该怎么做，在大中锋再三的恳求下，甲苯先生看其真诚，又告诉他：“在恰好出现了 $k$ 次的子串中，你去按照字串的长度分类，密码就在数量最多的那一类里”。\n\n大中锋为了尝试这个密码，想让你帮忙找出子串长度出现次数最多的长度数（如果有多个输出最长长度）。", "inputFormat": "第一行一个正整数 $T$ ，表示有 $T$ 组测试数据。\n\n接下来 $T$ 行每行包含一个字符串和一个正整数 $k$ 。", "outputFormat": "一共输出 $T$ 行，每行一个整数表示在出现 $k$ 次的子串中出现次数的最多的长度。如果不存在子串出现 $k$ 次，则输出 $-1$ 。", "hint": "### 数据说明 ###\n\n对于第一个数据：其中子串 $b, aa, ab, aab$ 均只出现一次，其中长度为 $1$ 的子串出现了 $1$ 次，长度为 $2$ 的子串出现了 $2$ 次，长度为 $3$ 的子串出现了 $1$ 次。所以答案为 $2$ 。\n\n对于第二个数据：其中子串 $a, b, c, ab, bc, abc$ 均只出现一次，其中长度为 $1$ 的子串出现了 $3$ 次，长度为 $2$ 的子串出现了 $2$ 次，长度为 $3$ 的子串出现了 $1$ 次。所以答案为 $1$ 。\n\n对于第三个数据：其中子串 $aaa$ 出现二次，长度为 $3$ 的子串出现了 $1$ 次，其他长度均没有。所以答案为 $3$ 。\n\n对于第四个数据：其中子串 $a, b, ab$ 出现二次，其中长度为 $1$ 的子串出现了 $2$ 次，长度为 $2$ 的子串出现了 $1$ 次。所以答案为 $1$ 。\n\n对于第五个数据：其中子串 $b, c, ab, ba$ 出现二次，其中长度为 $1$ 的子串出现了 $2$ 次，长度为 $2$ 的子串出现了 $2$ 次。所以答案为 $2$ 。\n\n对于第六个数据：其中子串没有出现四次。所以本题的本题的答案为 $-1$ 。\n\n### 数据范围 ###\n\n对于 $20\\%$ 的数据， $1\\leq k\\leq n\\leq 10$\n\n对于 $100\\%$ 的数据， $1\\leq n\\leq 10^5,1 \\leq T \\leq 100,\\sum n \\leq 3 * 10^6$ ，输入的字符串中仅包含小写英文字母。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Mr. Toluene and Striker’s String", "background": "TJOI2019 D2T2.\n\nSource file name: substring.*.\n\nTime limit: 1 s. Memory limit: 128 MB.", "description": "Striker has a string of length $n$. He only knows that one of its substrings is the password to a family treasure passed down from his ancestors. But since the string is very long, it is hard for Striker to try all substrings one by one.\n\nOne day, Striker went to Mr. Toluene for fortune-telling, but Mr. Toluene said: “Heaven’s secrets must not be revealed.”\n\nAfter Striker’s repeated pleas, Mr. Toluene told him: “The password is a substring that appears exactly $k$ times in the string.”\n\nBut Striker still did not know what to do. After even more pleading, Mr. Toluene, seeing his sincerity, added: “Among the substrings that appear exactly $k$ times, classify them by substring length. The password is in the length group with the largest count.”\n\nTo try the password, Striker wants you to help find the length value whose count is the largest among substrings that appear $k$ times (if there are multiple answers, output the longest length).", "inputFormat": "The first line contains a positive integer $T$, meaning there are $T$ test cases.\n\nIn the next $T$ lines, each line contains a string and a positive integer $k$.", "outputFormat": "Output $T$ lines in total. Each line contains one integer: among substrings that appear exactly $k$ times, output the length that has the largest number of such substrings. If no substring appears exactly $k$ times, output $-1$.", "hint": "### Data Explanation ###\n\nFor the first test case: the substrings $b, aa, ab, aab$ all appear once. Among them, substrings of length $1$ appear $1$ time, length $2$ appear $2$ times, and length $3$ appear $1$ time. So the answer is $2$.\n\nFor the second test case: the substrings $a, b, c, ab, bc, abc$ all appear once. Among them, substrings of length $1$ appear $3$ times, length $2$ appear $2$ times, and length $3$ appear $1$ time. So the answer is $1$.\n\nFor the third test case: the substring $aaa$ appears twice. Substrings of length $3$ appear $1$ time, and there are none for all other lengths. So the answer is $3$.\n\nFor the fourth test case: the substrings $a, b, ab$ appear twice. Among them, substrings of length $1$ appear $2$ times, and length $2$ appear $1$ time. So the answer is $1$.\n\nFor the fifth test case: the substrings $b, c, ab, ba$ appear twice. Among them, substrings of length $1$ appear $2$ times, and length $2$ appear $2$ times. So the answer is $2$.\n\nFor the sixth test case: no substring appears four times. So the answer for this problem is $-1$.\n\n### Constraints ###\n\nFor $20\\%$ of the testdata, $1 \\leq k \\leq n \\leq 10$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 10^5$, $1 \\leq T \\leq 100$, $\\sum n \\leq 3 * 10^6$. The input strings contain only lowercase English letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 甲苯先生和大中锋的字符串", "background": "TJOI2019 D2T2\n\n源文件名：substring.*\n\n时间限制: 1s 内存限制: 128M", "description": "大中锋有一个长度为 $n$ 的字符串，他只知道其中的一个子串是祖上传下来的宝藏的密码。但是由于字符串很长，大中锋很难将这些子串一一尝试。\n\n这天大中锋找到甲苯先生算命，但是甲苯先生说：“天机不可泄漏”。\n\n在大中锋的苦苦哀求下，甲苯先生告诉大中锋：“密码是在字符串中恰好出现了 $k$ 次的子串”。\n\n但是大中锋不知道该怎么做，在大中锋再三的恳求下，甲苯先生看其真诚，又告诉他：“在恰好出现了 $k$ 次的子串中，你去按照字串的长度分类，密码就在数量最多的那一类里”。\n\n大中锋为了尝试这个密码，想让你帮忙找出子串长度出现次数最多的长度数（如果有多个输出最长长度）。", "inputFormat": "第一行一个正整数 $T$ ，表示有 $T$ 组测试数据。\n\n接下来 $T$ 行每行包含一个字符串和一个正整数 $k$ 。", "outputFormat": "一共输出 $T$ 行，每行一个整数表示在出现 $k$ 次的子串中出现次数的最多的长度。如果不存在子串出现 $k$ 次，则输出 $-1$ 。", "hint": "### 数据说明 ###\n\n对于第一个数据：其中子串 $b, aa, ab, aab$ 均只出现一次，其中长度为 $1$ 的子串出现了 $1$ 次，长度为 $2$ 的子串出现了 $2$ 次，长度为 $3$ 的子串出现了 $1$ 次。所以答案为 $2$ 。\n\n对于第二个数据：其中子串 $a, b, c, ab, bc, abc$ 均只出现一次，其中长度为 $1$ 的子串出现了 $3$ 次，长度为 $2$ 的子串出现了 $2$ 次，长度为 $3$ 的子串出现了 $1$ 次。所以答案为 $1$ 。\n\n对于第三个数据：其中子串 $aaa$ 出现二次，长度为 $3$ 的子串出现了 $1$ 次，其他长度均没有。所以答案为 $3$ 。\n\n对于第四个数据：其中子串 $a, b, ab$ 出现二次，其中长度为 $1$ 的子串出现了 $2$ 次，长度为 $2$ 的子串出现了 $1$ 次。所以答案为 $1$ 。\n\n对于第五个数据：其中子串 $b, c, ab, ba$ 出现二次，其中长度为 $1$ 的子串出现了 $2$ 次，长度为 $2$ 的子串出现了 $2$ 次。所以答案为 $2$ 。\n\n对于第六个数据：其中子串没有出现四次。所以本题的本题的答案为 $-1$ 。\n\n### 数据范围 ###\n\n对于 $20\\%$ 的数据， $1\\leq k\\leq n\\leq 10$\n\n对于 $100\\%$ 的数据， $1\\leq n\\leq 10^5,1 \\leq T \\leq 100,\\sum n \\leq 3 * 10^6$ ，输入的字符串中仅包含小写英文字母。", "locale": "zh-CN"}}}
{"pid": "P5342", "type": "P", "difficulty": 7, "samples": [["8\n3 1 1 1\n3 1 1 2\n3 1 2 1\n3 1 2 2\n3 2 4 1\n3 2 4 2\n3 1 5 1\n3 1 5 2", "1\n0\n3\n1\n6\n2\n8\n0"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "各省省选", "天津"], "title": "[TJOI2019] 甲苯先生的线段树", "background": "TJOI2019 D2T3\n\n源文件名：segment.*\n\n时间限制: 4s 内存限制: 128M", "description": "大中锋走在路上见到正在战术后仰的甲苯先生。因为甲苯先生帮助他解决了祖传 `Hello word!` 的代码密码，大中锋想上前打个招呼。\n\n甲苯先生突然举起喇叭说：「大家好，我是甲苯拦你斯特，是凯岩城的首席文化大使，七十二变显神通，百般武艺样样有，感受不一样的权游文化。」\n\n这时甲苯先生看到了大中锋，激动的拉着大中锋说：「为了筹钱去北境打异鬼，我参加了今年下半年中外合写的 `stl+` 项目，我将在项目中担任线段树的主写人，但是改写不是乱写，在我写的时候，发现线段树是一个满二叉树，如果让根节点编号为 $1$，对于一个编号为 $x$ 的节点，令左孩子编号为 $2x$ ，右孩子编号为 $2x+1$ 时，现在在这个二叉树上有两个节点 $a,b$，现在我想知道节点 $a$ 到节点 $b$ 之间一条路径编号和最小为多少？你要是不会就直接给我 328，我不知道什么是暗影崛起，也不知道什么是怪盗军团。」\n\n大中锋回答：「那不就是求一条简单路径直接算吗？」甲苯先生：「那你求这颗满二叉树中还有多少条简单路径等于这个值？不知道了吧，给我 328，我到北境打赢异鬼，回到凯岩城我就还你，我们拦你斯特，有债必偿。」\n\n大中锋为了不给甲苯先生 328，请求作为好朋友的你写一个程序能解决甲苯先生的问题。\n\n简单路径指的是路径上各个顶点均不重复的路径。", "inputFormat": "第一行一个正整数 $T$，表示有 $T$ 组测试数据。\n\n接下来 $T$ 行，每行包含 $4$ 个正整数 $d,a,b,c$。其中 $d$ 表示满二叉树的树高，$a，b $表示二叉树上的两个节点，$c$ 表示要回答甲苯先生的问题类别，$c=1$ 时，回答甲苯先生第一个问题（点 $a$ 到点 $b$ 的最小路径上的编号和），$c=2$ 时，回答甲苯先生的第二个问题，即回答除了从点 $a$ 到点 $b$ 的路径外与点 $a$ 到点 $b$ 的最小编号路径有相同编号和的简单路径的条数。\n", "outputFormat": "对于每组输入，输出一行，每行包含一个正整数，表示甲苯先生问题的答案。", "hint": "### 样例解释 ###\n\n对于一颗深度为 $3$ 的满二叉树，含有节点 $1,2,3,4,5,6,7$ 。\n\n节点 $1$ 到 $1$ 的路径编号和为 $1$ ，且没有其他路径编号和为 $1$ 。\n\n节点 $1$ 到 $2$ 的路径编号和为 $1+2=3$ ，存在路径 3-3 编号和为 $3$。\n\n节点 $2$ 到 $4$ 的路径编号和为 $2+4=6$ ，存在路径 2-1-3 和路径 6-6 编号和为 $6$ 。\n\n节点 $1$ 到 $5$ 的路径编号和为 $1+2+5=8$ ，存在路径 8-8 编号和为 $8$ ，但是节点 $8$ 的深度为 $4$ 不满足条件。\n\n### 数据范围 ###\n\n对于 $20\\%$ 的数据，仅存在 $c = 1$ 的情况\n\n对于 $20\\%$ 的数据， $d \\leq 10$\n\n对于 $30\\%$ 的数据， $d \\leq 20$\n\n对于 $40\\%$ 的数据， $d \\leq 25$\n\n对于 $50\\%$ 的数据， $d \\leq 30$\n\n对于 $100\\%$ 的数据， $d \\leq 50,T \\leq 10$\n", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Mr. Toluene’s Segment Tree", "background": "TJOI2019 D2T3.\n\nSource file name: segment.*.\n\nTime limit: 4 s. Memory limit: 128 M.", "description": "Da Zhongfeng was walking on the road and saw Mr. Toluene doing a tactical fadeaway. Because Mr. Toluene helped him crack the code password of the family-inherited `Hello word!`, Da Zhongfeng wanted to go up and say hello.\n\nMr. Toluene suddenly raised a loudspeaker and said: “Hello everyone, I am Toluene Lannister, the chief cultural ambassador of Casterly Rock. I can transform in seventy-two ways, and I am good at all kinds of skills. Feel a different Game of Thrones culture.”\n\nAt this time, Mr. Toluene saw Da Zhongfeng and excitedly grabbed him and said: “To raise money to go to the North to fight the White Walkers, I joined the `stl+` project co-written by China and foreign teams in the second half of this year. I will be the main writer of the segment tree in the project. But rewriting is not random writing. When I was writing, I found that a segment tree is a perfect binary tree. If we label the root as $1$, then for a node labeled $x$, let the left child be labeled $2x$ and the right child be labeled $2x+1$. Now, in this binary tree there are two nodes $a, b$. I want to know: along the path from node $a$ to node $b$, what is the minimum possible value of the sum of node labels on that path? If you can’t do it, just give me 328. I don’t know what Shadowbrink Rising is, and I don’t know what the Phantom Thief Legion is either.”\n\nDa Zhongfeng replied: “Isn’t that just computing a simple path directly?” Mr. Toluene said: “Then tell me how many simple paths in this perfect binary tree are equal to this value? You don’t know, right? Give me 328. After I defeat the White Walkers in the North and return to Casterly Rock, I will pay you back. We Lannisters always pay our debts.”\n\nTo avoid giving Mr. Toluene 328, Da Zhongfeng asked you, as a good friend, to write a program to solve Mr. Toluene’s problem.\n\nA simple path means a path in which no vertex repeats.", "inputFormat": "The first line contains a positive integer $T$, meaning there are $T$ test cases.\n\nNext, there are $T$ lines. Each line contains $4$ positive integers $d, a, b, c$. Here, $d$ is the height of the perfect binary tree, $a, b$ are two nodes in the binary tree, and $c$ indicates which type of question Mr. Toluene asks. When $c=1$, answer Mr. Toluene’s first question (the minimum sum of labels on the path from node $a$ to node $b$). When $c=2$, answer Mr. Toluene’s second question, i.e., the number of simple paths that have the same label-sum as the minimum-label-sum path from node $a$ to node $b$, excluding the path from node $a$ to node $b$ itself.", "outputFormat": "For each test case, output one line containing one positive integer, the answer to Mr. Toluene’s question.", "hint": "### Sample Explanation\n\nFor a perfect binary tree of depth $3$, it contains nodes $1, 2, 3, 4, 5, 6, 7$.\n\nThe label-sum of the path from node $1$ to node $1$ is $1$, and there is no other path whose label-sum is $1$.\n\nThe label-sum of the path from node $1$ to node $2$ is $1+2=3$. There exists a path $3-3$ whose label-sum is $3$.\n\nThe label-sum of the path from node $2$ to node $4$ is $2+4=6$. There exist the path $2-1-3$ and the path $6-6$ whose label-sum is $6$.\n\nThe label-sum of the path from node $1$ to node $5$ is $1+2+5=8$. There exists a path $8-8$ whose label-sum is $8$, but node $8$ has depth $4$, which does not satisfy the condition.\n\n### Constraints\n\nFor $20\\%$ of the testdata, there are only cases with $c = 1$.\n\nFor $20\\%$ of the testdata, $d \\leq 10$.\n\nFor $30\\%$ of the testdata, $d \\leq 20$.\n\nFor $40\\%$ of the testdata, $d \\leq 25$.\n\nFor $50\\%$ of the testdata, $d \\leq 30$.\n\nFor $100\\%$ of the testdata, $d \\leq 50, T \\leq 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 甲苯先生的线段树", "background": "TJOI2019 D2T3\n\n源文件名：segment.*\n\n时间限制: 4s 内存限制: 128M", "description": "大中锋走在路上见到正在战术后仰的甲苯先生。因为甲苯先生帮助他解决了祖传 `Hello word!` 的代码密码，大中锋想上前打个招呼。\n\n甲苯先生突然举起喇叭说：「大家好，我是甲苯拦你斯特，是凯岩城的首席文化大使，七十二变显神通，百般武艺样样有，感受不一样的权游文化。」\n\n这时甲苯先生看到了大中锋，激动的拉着大中锋说：「为了筹钱去北境打异鬼，我参加了今年下半年中外合写的 `stl+` 项目，我将在项目中担任线段树的主写人，但是改写不是乱写，在我写的时候，发现线段树是一个满二叉树，如果让根节点编号为 $1$，对于一个编号为 $x$ 的节点，令左孩子编号为 $2x$ ，右孩子编号为 $2x+1$ 时，现在在这个二叉树上有两个节点 $a,b$，现在我想知道节点 $a$ 到节点 $b$ 之间一条路径编号和最小为多少？你要是不会就直接给我 328，我不知道什么是暗影崛起，也不知道什么是怪盗军团。」\n\n大中锋回答：「那不就是求一条简单路径直接算吗？」甲苯先生：「那你求这颗满二叉树中还有多少条简单路径等于这个值？不知道了吧，给我 328，我到北境打赢异鬼，回到凯岩城我就还你，我们拦你斯特，有债必偿。」\n\n大中锋为了不给甲苯先生 328，请求作为好朋友的你写一个程序能解决甲苯先生的问题。\n\n简单路径指的是路径上各个顶点均不重复的路径。", "inputFormat": "第一行一个正整数 $T$，表示有 $T$ 组测试数据。\n\n接下来 $T$ 行，每行包含 $4$ 个正整数 $d,a,b,c$。其中 $d$ 表示满二叉树的树高，$a，b $表示二叉树上的两个节点，$c$ 表示要回答甲苯先生的问题类别，$c=1$ 时，回答甲苯先生第一个问题（点 $a$ 到点 $b$ 的最小路径上的编号和），$c=2$ 时，回答甲苯先生的第二个问题，即回答除了从点 $a$ 到点 $b$ 的路径外与点 $a$ 到点 $b$ 的最小编号路径有相同编号和的简单路径的条数。\n", "outputFormat": "对于每组输入，输出一行，每行包含一个正整数，表示甲苯先生问题的答案。", "hint": "### 样例解释 ###\n\n对于一颗深度为 $3$ 的满二叉树，含有节点 $1,2,3,4,5,6,7$ 。\n\n节点 $1$ 到 $1$ 的路径编号和为 $1$ ，且没有其他路径编号和为 $1$ 。\n\n节点 $1$ 到 $2$ 的路径编号和为 $1+2=3$ ，存在路径 3-3 编号和为 $3$。\n\n节点 $2$ 到 $4$ 的路径编号和为 $2+4=6$ ，存在路径 2-1-3 和路径 6-6 编号和为 $6$ 。\n\n节点 $1$ 到 $5$ 的路径编号和为 $1+2+5=8$ ，存在路径 8-8 编号和为 $8$ ，但是节点 $8$ 的深度为 $4$ 不满足条件。\n\n### 数据范围 ###\n\n对于 $20\\%$ 的数据，仅存在 $c = 1$ 的情况\n\n对于 $20\\%$ 的数据， $d \\leq 10$\n\n对于 $30\\%$ 的数据， $d \\leq 20$\n\n对于 $40\\%$ 的数据， $d \\leq 25$\n\n对于 $50\\%$ 的数据， $d \\leq 30$\n\n对于 $100\\%$ 的数据， $d \\leq 50,T \\leq 10$\n", "locale": "zh-CN"}}}
{"pid": "P5343", "type": "P", "difficulty": 4, "samples": [["4\n3\n1 2 3\n3\n1 2 4", "5"], ["19260817\n7\n8 9 6 3 7 2 1\n7\n4 5 2 9 7 8 3", "859254329"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "动态规划优化", "矩阵加速", "矩阵乘法"], "title": "【XR-1】分块", "background": "xht37 喜欢分块，以至于对一道**不需要分块**的题也要分块做。", "description": "有一个长度为 $n$ 的序列，xht37 现在想分块维护它。\n\nPinkRabbit 要求他只准将序列分成 $PR$ 种长度的块。\n\nNaCly_Fish 要求他只准将序列分成 $NF$ 种长度的块。\n\n同一个人可能会要求 xht37 多次相同的块长。\n\nxht37 想同时满足 PinkRabbit 和 NaCly_Fish 要求，只好使用两个人都允许的长度分块。\n\nxht37 想知道，有多少种不同的分块方案，答案对 $10 ^ 9 + 7$ 取模。", "inputFormat": "第一行一个正整数 $n$，表示序列的长度。\n\n第二行一个正整数 $PR$，表示 PinkRabbit 要求的分块长度的种类数。\n\n第三行 $PR$ 个正整数，表示 PinkRabbit 要求的 $PR$ 种分块长度。\n\n第四行一个正整数 $NF$，表示 NaCly_Fish 要求的分块长度的种类数。\n\n第五行 $NF$ 个正整数，表示 NaCly_Fish 要求的 $NF$ 种分块长度。", "outputFormat": "输出一行一个整数，表示不同分块方案的种类数对 $10 ^ 9 + 7$ 取模的值。", "hint": "【样例 $1$ 说明】\n\nPinkRabbit 和 NaCly_Fish 都允许的块长为 $\\{1,2\\}$。\n\n长度为 $4$ 的序列分块，每块长度为 $\\{1,2\\}$ 的方案有：\n\n- $1\\ 1\\ 1\\ 1$\n- $1\\ 1\\ 2$\n- $1\\ 2\\ 1$\n- $2\\ 1\\ 1$\n- $2\\ 2$\n\n共 $5$ 种。\n\n【数据规模与约定】\n\n设最大块长为 $x$。\n\n对于 $60 \\%$ 的数据，$1 \\le n \\le 10 ^ 6$，$1 \\le PR,NF,x \\le 10$，保证同一个人不会要求多次相同的块长。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 10 ^ {18}$，$1 \\le PR,NF,x \\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Block Decomposition", "background": "xht37 likes block decomposition so much that he even uses it to solve a problem that **does not need block decomposition**.", "description": "There is a sequence of length $n$, and xht37 now wants to maintain it using block decomposition.\n\nPinkRabbit requires that he may only divide the sequence into blocks whose lengths come from $PR$ allowed lengths.\n\nNaCly_Fish requires that he may only divide the sequence into blocks whose lengths come from $NF$ allowed lengths.\n\nThe same person may request the same block length multiple times.\n\nxht37 wants to satisfy both PinkRabbit and NaCly_Fish, so he has to use block lengths that are allowed by both of them.\n\nxht37 wants to know how many different block decomposition schemes there are. Output the answer modulo $10 ^ 9 + 7$.", "inputFormat": "The first line contains a positive integer $n$, which is the length of the sequence.\n\nThe second line contains a positive integer $PR$, which is the number of allowed block lengths requested by PinkRabbit.\n\nThe third line contains $PR$ positive integers, representing the $PR$ block lengths requested by PinkRabbit.\n\nThe fourth line contains a positive integer $NF$, which is the number of allowed block lengths requested by NaCly_Fish.\n\nThe fifth line contains $NF$ positive integers, representing the $NF$ block lengths requested by NaCly_Fish.", "outputFormat": "Output one line with one integer, which is the number of different block decomposition schemes modulo $10 ^ 9 + 7$.", "hint": "[Sample $1$ Explanation]\n\nThe block lengths allowed by both PinkRabbit and NaCly_Fish are $\\{1,2\\}$.\n\nFor a sequence of length $4$, the schemes that divide it into blocks with lengths in $\\{1,2\\}$ are:\n\n- $1\\ 1\\ 1\\ 1$\n- $1\\ 1\\ 2$\n- $1\\ 2\\ 1$\n- $2\\ 1\\ 1$\n- $2\\ 2$\n\nThere are $5$ schemes in total.\n\n[Constraints]\n\nLet the maximum block length be $x$.\n\nFor $60 \\%$ of the testdata, $1 \\le n \\le 10 ^ 6$, $1 \\le PR,NF,x \\le 10$, and it is guaranteed that the same person will not request the same block length multiple times.\n\nFor $100 \\%$ of the testdata, $1 \\le n \\le 10 ^ {18}$, $1 \\le PR,NF,x \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】分块", "background": "xht37 喜欢分块，以至于对一道**不需要分块**的题也要分块做。", "description": "有一个长度为 $n$ 的序列，xht37 现在想分块维护它。\n\nPinkRabbit 要求他只准将序列分成 $PR$ 种长度的块。\n\nNaCly_Fish 要求他只准将序列分成 $NF$ 种长度的块。\n\n同一个人可能会要求 xht37 多次相同的块长。\n\nxht37 想同时满足 PinkRabbit 和 NaCly_Fish 要求，只好使用两个人都允许的长度分块。\n\nxht37 想知道，有多少种不同的分块方案，答案对 $10 ^ 9 + 7$ 取模。", "inputFormat": "第一行一个正整数 $n$，表示序列的长度。\n\n第二行一个正整数 $PR$，表示 PinkRabbit 要求的分块长度的种类数。\n\n第三行 $PR$ 个正整数，表示 PinkRabbit 要求的 $PR$ 种分块长度。\n\n第四行一个正整数 $NF$，表示 NaCly_Fish 要求的分块长度的种类数。\n\n第五行 $NF$ 个正整数，表示 NaCly_Fish 要求的 $NF$ 种分块长度。", "outputFormat": "输出一行一个整数，表示不同分块方案的种类数对 $10 ^ 9 + 7$ 取模的值。", "hint": "【样例 $1$ 说明】\n\nPinkRabbit 和 NaCly_Fish 都允许的块长为 $\\{1,2\\}$。\n\n长度为 $4$ 的序列分块，每块长度为 $\\{1,2\\}$ 的方案有：\n\n- $1\\ 1\\ 1\\ 1$\n- $1\\ 1\\ 2$\n- $1\\ 2\\ 1$\n- $2\\ 1\\ 1$\n- $2\\ 2$\n\n共 $5$ 种。\n\n【数据规模与约定】\n\n设最大块长为 $x$。\n\n对于 $60 \\%$ 的数据，$1 \\le n \\le 10 ^ 6$，$1 \\le PR,NF,x \\le 10$，保证同一个人不会要求多次相同的块长。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 10 ^ {18}$，$1 \\le PR,NF,x \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5344", "type": "P", "difficulty": 6, "samples": [["9 11 5\n2 2 1 2\n2 3 1 5\n2 4 2 10\n2 5 3 9\n2 6 5 3\n2 7 6 6\n2 8 7 2\n2 9 4 2\n1 1 1 4 9 2\n1 8 5 1 6 1\n1 3 6 9 6 1", "1 1 1 1 0 1 7 9 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["倍增", "洛谷原创", "O2优化", "最短路", "最近公共祖先 LCA", "ST 表"], "title": "【XR-1】逛森林", "background": "NaCly_Fish 和 PinkRabbit 是好朋友。\n\n有一天她去森林里游玩，回去跟 PinkRabbit 说：“我发现好多棵会动的树耶！”\n\nPinkRabbit 动了动一只兔耳朵：“这有什么好稀奇的，我用一只兔耳朵就能维护每棵树的形态。”\n\nNaCly_Fish 不服：“不止这样，我还看到有一些传送门，能从一条树枝跳到另一条树枝上呢！”\n\nPinkRabbit 动了动另一只兔耳朵：“这有什么好稀奇的，我用两只兔耳朵就能统计每个传送门的信息。”\n\n![](https://cdn.luogu.com.cn/upload/pic/57782.png)\n\n于是 NaCly_Fish 很郁闷，她向你求助，请帮帮她吧。\n\n什么？你不愿意帮？\n\n那她就不给你这题的分了。", "description": "给你 $n$ 个节点的森林，初始没有边。\n\n有 $m$ 个操作，分为两种：\n\n$1\\ u_1\\ v_1\\ u_2\\ v_2\\ w$：表示构建一个单向传送门，从 $u_1 \\rightarrow v_1$ 简单路径上的所有节点，可以花费 $w$ 的代价，到达 $u_2 \\rightarrow v_2$ 简单路径上的所有节点。若 $u_1$ 到 $v_1$ 或 $u_2$ 到 $v_2$ 不连通（由 $2$ 操作产生的边不连通），则忽略此次操作。\n\n$2\\ u\\ v\\ w$：表示将 $u$ 和 $v$ 节点间连一条花费为 $w$ 的无向边，若 $u$ 和 $v$ 之间已连通（由 $2$ 操作产生的边连通）则忽略此次操作。\n\n经过这 $m$ 次操作后，请你求出从 $s$ 节点出发，到每个节点的最小花费。", "inputFormat": "第一行三个正整数 $n, m, s$，分别表示树的节点数、操作数、和起始节点。\n\n接下来 $m$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "输出一行 $n$ 个整数，第 $i$ 个整数表示从 $s$ 节点出发，到 $i$ 节点的最小花费。特别地，若不能到达$i$节点，则输出 `-1`。", "hint": "【样例说明】\n\n这是样例中给出的树（严格来讲，这棵树也是一条链）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g1kmzdbv.png)\n\n有三个传送门，其中两个是这样的：\n\n- 从 $1$ 号点可以花费 $2$ 的代价到达 $4 \\rightarrow 9$ 简单路径上的所有节点（即 $4, 9$ 号点）。\n- 从 $8 \\rightarrow 5$ 简单路径上的所有节点（即 $8, 7, 6, 5$ 号点）可以花费 $1$ 的代价到达 $1 \\rightarrow 6$ 简单路径上的所有节点（即 $1, 3, 5, 6$ 号点）。\n\n容易看出从 $5$ 号节点出发，到达其它节点的最小花费分别为：$1, 1, 1, 1, 0, 1, 7, 9, 1$。\n\n【数据规模与约定】\n\n对于第 $1, 2$ 个测试点，$1 \\le n \\le 100$，$1 \\le m \\le 300$。\n\n对于第 $3, 4$ 个测试点，$1 \\le n \\le 1000$，$1 \\le m \\le 3000$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 50000$，$1\\le m \\le 10^6$，$1\\le u,v \\le n$，$1\\le w \\le 100$。\n\n对于第 $1$ ~ $10$ 个测试点，每个 $5$ 分。\n\n对于第 $11, 12$ 个测试点，每个 $25$ 分。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Strolling in the Forest", "background": "NaCly_Fish and PinkRabbit are good friends.\n\nOne day, she went to the forest for fun. After coming back, she said to PinkRabbit: “I found many trees that can move!”\n\nPinkRabbit twitched one rabbit ear: “What is so strange about that? With one rabbit ear, I can maintain the shape of every tree.”\n\nNaCly_Fish was not convinced: “Not only that. I also saw some portals. They can jump from one branch to another!”\n\nPinkRabbit twitched the other rabbit ear: “What is so strange about that? With two rabbit ears, I can count the information of every portal.”\n\n![](https://cdn.luogu.com.cn/upload/pic/57782.png)\n\nSo NaCly_Fish felt very depressed, and she asked you for help. Please help her.\n\nWhat? You are not willing to help?\n\nThen she will not give you the points for this problem.", "description": "You are given a forest with $n$ nodes, with no edges at the beginning.\n\nThere are $m$ operations, of two types:\n\n$1\\ u_1\\ v_1\\ u_2\\ v_2\\ w$: Build a directed portal. From all nodes on the simple path $u_1 \\rightarrow v_1$, you can pay cost $w$ to reach all nodes on the simple path $u_2 \\rightarrow v_2$. If $u_1$ and $v_1$ are not connected, or $u_2$ and $v_2$ are not connected (connectivity is determined only by edges added by type $2$ operations), then ignore this operation.\n\n$2\\ u\\ v\\ w$: Add an undirected edge of cost $w$ between nodes $u$ and $v$. If $u$ and $v$ are already connected (connectivity is determined only by edges added by type $2$ operations), then ignore this operation.\n\nAfter these $m$ operations, find the minimum cost from node $s$ to every node.", "inputFormat": "The first line contains three positive integers $n, m, s$, representing the number of nodes in the tree, the number of operations, and the starting node.\n\nThe next $m$ lines each contain several positive integers, describing one operation.", "outputFormat": "Output one line with $n$ integers. The $i$-th integer is the minimum cost from node $s$ to node $i$. In particular, if node $i$ cannot be reached, output `-1`.", "hint": "[Sample Explanation]\n\nThis is the tree given in the sample (strictly speaking, this tree is also a chain):\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g1kmzdbv.png)\n\nThere are three portals, and two of them are like this:\n\n- From node $1$, you can pay cost $2$ to reach all nodes on the simple path $4 \\rightarrow 9$ (that is, nodes $4$ and $9$).\n- From all nodes on the simple path $8 \\rightarrow 5$ (that is, nodes $8, 7, 6, 5$), you can pay cost $1$ to reach all nodes on the simple path $1 \\rightarrow 6$ (that is, nodes $1, 3, 5, 6$).\n\nIt is easy to see that starting from node $5$, the minimum costs to reach the other nodes are: $1, 1, 1, 1, 0, 1, 7, 9, 1$.\n\n[Constraints]\n\nFor test points $1, 2$, $1 \\le n \\le 100$, $1 \\le m \\le 300$.\n\nFor test points $3, 4$, $1 \\le n \\le 1000$, $1 \\le m \\le 3000$.\n\nFor $100\\%$ of the data, $1 \\le n \\le 50000$, $1 \\le m \\le 10^6$, $1 \\le u,v \\le n$, $1 \\le w \\le 100$.\n\nFor test points $1$ to $10$, each is worth $5$ points.\n\nFor test points $11, 12$, each is worth $25$ points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】逛森林", "background": "NaCly_Fish 和 PinkRabbit 是好朋友。\n\n有一天她去森林里游玩，回去跟 PinkRabbit 说：“我发现好多棵会动的树耶！”\n\nPinkRabbit 动了动一只兔耳朵：“这有什么好稀奇的，我用一只兔耳朵就能维护每棵树的形态。”\n\nNaCly_Fish 不服：“不止这样，我还看到有一些传送门，能从一条树枝跳到另一条树枝上呢！”\n\nPinkRabbit 动了动另一只兔耳朵：“这有什么好稀奇的，我用两只兔耳朵就能统计每个传送门的信息。”\n\n![](https://cdn.luogu.com.cn/upload/pic/57782.png)\n\n于是 NaCly_Fish 很郁闷，她向你求助，请帮帮她吧。\n\n什么？你不愿意帮？\n\n那她就不给你这题的分了。", "description": "给你 $n$ 个节点的森林，初始没有边。\n\n有 $m$ 个操作，分为两种：\n\n$1\\ u_1\\ v_1\\ u_2\\ v_2\\ w$：表示构建一个单向传送门，从 $u_1 \\rightarrow v_1$ 简单路径上的所有节点，可以花费 $w$ 的代价，到达 $u_2 \\rightarrow v_2$ 简单路径上的所有节点。若 $u_1$ 到 $v_1$ 或 $u_2$ 到 $v_2$ 不连通（由 $2$ 操作产生的边不连通），则忽略此次操作。\n\n$2\\ u\\ v\\ w$：表示将 $u$ 和 $v$ 节点间连一条花费为 $w$ 的无向边，若 $u$ 和 $v$ 之间已连通（由 $2$ 操作产生的边连通）则忽略此次操作。\n\n经过这 $m$ 次操作后，请你求出从 $s$ 节点出发，到每个节点的最小花费。", "inputFormat": "第一行三个正整数 $n, m, s$，分别表示树的节点数、操作数、和起始节点。\n\n接下来 $m$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "输出一行 $n$ 个整数，第 $i$ 个整数表示从 $s$ 节点出发，到 $i$ 节点的最小花费。特别地，若不能到达$i$节点，则输出 `-1`。", "hint": "【样例说明】\n\n这是样例中给出的树（严格来讲，这棵树也是一条链）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g1kmzdbv.png)\n\n有三个传送门，其中两个是这样的：\n\n- 从 $1$ 号点可以花费 $2$ 的代价到达 $4 \\rightarrow 9$ 简单路径上的所有节点（即 $4, 9$ 号点）。\n- 从 $8 \\rightarrow 5$ 简单路径上的所有节点（即 $8, 7, 6, 5$ 号点）可以花费 $1$ 的代价到达 $1 \\rightarrow 6$ 简单路径上的所有节点（即 $1, 3, 5, 6$ 号点）。\n\n容易看出从 $5$ 号节点出发，到达其它节点的最小花费分别为：$1, 1, 1, 1, 0, 1, 7, 9, 1$。\n\n【数据规模与约定】\n\n对于第 $1, 2$ 个测试点，$1 \\le n \\le 100$，$1 \\le m \\le 300$。\n\n对于第 $3, 4$ 个测试点，$1 \\le n \\le 1000$，$1 \\le m \\le 3000$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 50000$，$1\\le m \\le 10^6$，$1\\le u,v \\le n$，$1\\le w \\le 100$。\n\n对于第 $1$ ~ $10$ 个测试点，每个 $5$ 分。\n\n对于第 $11, 12$ 个测试点，每个 $25$ 分。", "locale": "zh-CN"}}}
{"pid": "P5345", "type": "P", "difficulty": 6, "samples": [["2\n4 7 4\n2 5 3", "7"], ["2\n4 7 3\n2 5 3", "Impossible"], ["2\n4 7 1\n2 5 1", "0"], ["3\n14 60 44\n6 50 6\n1029 91287 87318", "101"], ["1\n6 65536 65536", "16"], ["2\n2 2 2\n2 3 1\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "中国剩余定理 CRT"], "title": "【XR-1】快乐肥宅", "background": "小粉兔的机房里面有 $n$ 个快乐肥宅，但小粉兔自己并不是，他看着这些快乐肥宅，非常羡慕，于是他想研究一下这些快乐肥宅的体重。", "description": "每个快乐肥宅第 $0$ 天的体重都等于 $1$。第 $i$ 个快乐肥宅的体重记作 $w_i$，则一开始 $w_i = 1$。\n\n第 $i$ 个快乐肥宅有一个专属的快乐指数 $k_i$，这表示他每天刚起床后，体重会是上一天的体重的 $k_i$ 倍。\n\n肥宅们是有觉悟的，第 $i$ 个肥宅有一个专属的觉醒体重 $g_i$，这表示一旦他的体重**大于** $g_i$，他就会去健身房健身，每次减掉自己 $g_i$ 的体重，直到体重小于等于 $g_i$。\n\n健身后，肥宅们会在机房见面，他们发现有时各自的体重会变得很有趣。\n\n有一天，肥宅们发现各自的体重形成了等差数列！\n\n另一天，肥宅们发现各自的体重形成了等比数列！\n\n肥宅们心想，如果 $n$ 个快乐肥宅的体重 $\\{w_1, w_2, \\ldots, w_n\\}$ 恰好形成序列 $\\{r_1, r_2, \\ldots, r_n\\}$，至少需要经过多少天呢？\n\n不过如果肥宅们等了很久都没有等到这一天，他们会认为这是不可能的。", "inputFormat": "第一行为一个正整数 $n$。\n\n接下来 $n$ 行，每行三个正整数 $k_i, g_i, r_i$。分别表示第 $i$ 个肥宅的快乐指数、觉醒体重和序列中的体重。", "outputFormat": "如果在第 $10^9$ 天结束前已经形成给定的序列，则输出一个数，表示至少需要经过的天数。\n\n如果在第 $10^9$ 天结束前没有形成给定的序列，则输出 `Impossible`。", "hint": "【样例 $1$ 说明】\n\n下表是两个肥宅在第 $0$ 天至第 $7$ 天时的体重变化表：\n\n| 天数 | 肥宅 $1$ 的体重 | 肥宅 $2$ 的体重 | 解释 |\n| :--: | :--: | :--: | :--: |\n| $0$ | $1$ | $1$ | 第 $0$ 天每个肥宅的体重都是 $1$ |\n| $1$ | $4$ | $2$ | 肥宅 $1$ 的体重是上一天的 $4$ 倍，肥宅 $2$ 的体重是上一天的 $2$ 倍 |\n| $2$ | $2$ | $4$ | 肥宅 $1$ 的体重是上一天的 $4$ 倍，为 $16$，他发现自己的体重超过了 $7$，于是去了两次健身房，把体重减少了 $2\\times 7=14$ |\n| $3$ | $1$ | $3$ | 这一天肥宅 $1$ 和肥宅 $2$ 都去了一次健身房 |\n| $4$ | $4$ | $1$ | 肥宅 $2$ 去了一次健身房 |\n| $5$ | $2$ | $2$ | 肥宅 $1$ 去了两次健身房 |\n| $6$ | $1$ | $4$ | 肥宅 $1$ 去了一次健身房 |\n| $7$ | $4$ | $3$ | 肥宅 $2$ 去了一次健身房 |\n\n可以看出在第 $7$ 天时肥宅的体重形成了序列 $\\{4, 3\\}$。\n\n【数据规模与约定】\n\nSubtask 1（20 points）：$n \\le 50$，$g_i \\le 50$。  \nSubtask 2（20 points）：$g_i$ 为质数。  \nSubtask 3（20 points）：$g_i \\le 10^3$。  \nSubtask 4（20 points）：$r_i \\in \\{1, g_i\\}$。  \nSubtask 5（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^3$，$1 \\le k_i, r_i \\le g_i \\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Happy Chubby Guys", "background": "There are $n$ happy chubby guys in Xiaofentu’s computer lab, but Xiaofentu is not one of them. He looks at these happy chubby guys and feels very jealous, so he wants to study their weights.", "description": "Each happy chubby guy’s weight on day $0$ is $1$. Let the $i$-th happy chubby guy’s weight be $w_i$, so initially $w_i = 1$.\n\nThe $i$-th happy chubby guy has a personal happiness index $k_i$, meaning that every day right after he wakes up, his weight becomes $k_i$ times his weight from the previous day.\n\nThese chubby guys are determined. The $i$-th chubby guy has a personal awakening weight $g_i$, meaning that once his weight is **greater than** $g_i$, he will go to the gym. Each time, he reduces his weight by $g_i$, until his weight is less than or equal to $g_i$.\n\nAfter working out, they meet in the computer lab, and they find that sometimes their weights become very interesting.\n\nOne day, they found that their weights formed an arithmetic progression.\n\nAnother day, they found that their weights formed a geometric progression!\n\nThe chubby guys wonder: if the weights of the $n$ happy chubby guys $\\{w_1, w_2, \\ldots, w_n\\}$ exactly form the sequence $\\{r_1, r_2, \\ldots, r_n\\}$, what is the minimum number of days needed?\n\nHowever, if they wait for a very long time and still do not reach that day, they will think it is impossible.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next $n$ lines each contain three positive integers $k_i, g_i, r_i$, representing the $i$-th chubby guy’s happiness index, awakening weight, and the target weight in the sequence.", "outputFormat": "If the given sequence is formed before the end of day $10^9$, output one number: the minimum number of days required.\n\nIf the given sequence is not formed before the end of day $10^9$, output `Impossible`.", "hint": "[Sample $1$ Explanation]\n\nThe table below shows the weight changes of two chubby guys from day $0$ to day $7$:\n\n| Days | Chubby guy $1$’s weight | Chubby guy $2$’s weight | Explanation |\n| :--: | :--: | :--: | :--: |\n| $0$ | $1$ | $1$ | On day $0$, each chubby guy’s weight is $1$ |\n| $1$ | $4$ | $2$ | Chubby guy $1$’s weight is $4$ times the previous day, and chubby guy $2$’s weight is $2$ times the previous day |\n| $2$ | $2$ | $4$ | Chubby guy $1$’s weight is $4$ times the previous day, which is $16$. He finds his weight exceeds $7$, so he goes to the gym twice, reducing his weight by $2\\times 7=14$ |\n| $3$ | $1$ | $3$ | On this day, both chubby guy $1$ and chubby guy $2$ go to the gym once |\n| $4$ | $4$ | $1$ | Chubby guy $2$ goes to the gym once |\n| $5$ | $2$ | $2$ | Chubby guy $1$ goes to the gym twice |\n| $6$ | $1$ | $4$ | Chubby guy $1$ goes to the gym once |\n| $7$ | $4$ | $3$ | Chubby guy $2$ goes to the gym once |\n\nIt can be seen that on day $7$, the chubby guys’ weights form the sequence $\\{4, 3\\}$.\n\n[Constraints and Notes]\n\nSubtask 1 (20 points): $n \\le 50$, $g_i \\le 50$.  \nSubtask 2 (20 points): $g_i$ is prime.  \nSubtask 3 (20 points): $g_i \\le 10^3$.  \nSubtask 4 (20 points): $r_i \\in \\{1, g_i\\}$.  \nSubtask 5 (20 points): no special constraints.\n\nFor $100\\%$ of the testdata: $1 \\le n \\le 10^3$, $1 \\le k_i, r_i \\le g_i \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】快乐肥宅", "background": "小粉兔的机房里面有 $n$ 个快乐肥宅，但小粉兔自己并不是，他看着这些快乐肥宅，非常羡慕，于是他想研究一下这些快乐肥宅的体重。", "description": "每个快乐肥宅第 $0$ 天的体重都等于 $1$。第 $i$ 个快乐肥宅的体重记作 $w_i$，则一开始 $w_i = 1$。\n\n第 $i$ 个快乐肥宅有一个专属的快乐指数 $k_i$，这表示他每天刚起床后，体重会是上一天的体重的 $k_i$ 倍。\n\n肥宅们是有觉悟的，第 $i$ 个肥宅有一个专属的觉醒体重 $g_i$，这表示一旦他的体重**大于** $g_i$，他就会去健身房健身，每次减掉自己 $g_i$ 的体重，直到体重小于等于 $g_i$。\n\n健身后，肥宅们会在机房见面，他们发现有时各自的体重会变得很有趣。\n\n有一天，肥宅们发现各自的体重形成了等差数列！\n\n另一天，肥宅们发现各自的体重形成了等比数列！\n\n肥宅们心想，如果 $n$ 个快乐肥宅的体重 $\\{w_1, w_2, \\ldots, w_n\\}$ 恰好形成序列 $\\{r_1, r_2, \\ldots, r_n\\}$，至少需要经过多少天呢？\n\n不过如果肥宅们等了很久都没有等到这一天，他们会认为这是不可能的。", "inputFormat": "第一行为一个正整数 $n$。\n\n接下来 $n$ 行，每行三个正整数 $k_i, g_i, r_i$。分别表示第 $i$ 个肥宅的快乐指数、觉醒体重和序列中的体重。", "outputFormat": "如果在第 $10^9$ 天结束前已经形成给定的序列，则输出一个数，表示至少需要经过的天数。\n\n如果在第 $10^9$ 天结束前没有形成给定的序列，则输出 `Impossible`。", "hint": "【样例 $1$ 说明】\n\n下表是两个肥宅在第 $0$ 天至第 $7$ 天时的体重变化表：\n\n| 天数 | 肥宅 $1$ 的体重 | 肥宅 $2$ 的体重 | 解释 |\n| :--: | :--: | :--: | :--: |\n| $0$ | $1$ | $1$ | 第 $0$ 天每个肥宅的体重都是 $1$ |\n| $1$ | $4$ | $2$ | 肥宅 $1$ 的体重是上一天的 $4$ 倍，肥宅 $2$ 的体重是上一天的 $2$ 倍 |\n| $2$ | $2$ | $4$ | 肥宅 $1$ 的体重是上一天的 $4$ 倍，为 $16$，他发现自己的体重超过了 $7$，于是去了两次健身房，把体重减少了 $2\\times 7=14$ |\n| $3$ | $1$ | $3$ | 这一天肥宅 $1$ 和肥宅 $2$ 都去了一次健身房 |\n| $4$ | $4$ | $1$ | 肥宅 $2$ 去了一次健身房 |\n| $5$ | $2$ | $2$ | 肥宅 $1$ 去了两次健身房 |\n| $6$ | $1$ | $4$ | 肥宅 $1$ 去了一次健身房 |\n| $7$ | $4$ | $3$ | 肥宅 $2$ 去了一次健身房 |\n\n可以看出在第 $7$ 天时肥宅的体重形成了序列 $\\{4, 3\\}$。\n\n【数据规模与约定】\n\nSubtask 1（20 points）：$n \\le 50$，$g_i \\le 50$。  \nSubtask 2（20 points）：$g_i$ 为质数。  \nSubtask 3（20 points）：$g_i \\le 10^3$。  \nSubtask 4（20 points）：$r_i \\in \\{1, g_i\\}$。  \nSubtask 5（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^3$，$1 \\le k_i, r_i \\le g_i \\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P5346", "type": "P", "difficulty": 6, "samples": [["5 11\n1 1 3 2\n1 2 2 1 1\n1 1\n1 2\n1 3\n1 4\n1 5\n2 4 1\n2 5 3\n3 1 1\n3 1 2\n3 1 3\n3 1 4", "5\n2\n1\n3\n4\n3\n1\n3\n2\n4\n5"]], "limits": {"time": [1000, 1000, 4000, 4000, 1500, 1500, 1500, 1500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["倍增", "离散化", "O2优化", "可持久化线段树", "可持久化", "后缀数组 SA"], "title": "【XR-1】柯南家族", "background": "xht37 最近沉迷于名侦探柯南。\n\n在某集中，小兰又在怀疑柯南的真实身份了。为了让小兰不再怀疑，柯南编造出自己的家族背景来应对小兰的询问。", "description": "这个家族一开始只有一个人，后来不断有人有了孩子，直到现在，这个家族有 $n$ 个人，第 $n$ 个人正是柯南。易知这个家族构成了一个 $n$ 个点的树形结构。\n\n柯南为了使自己编造的家庭背景更加真实，他给家族中的每个人赋予了一个**智商值**。但是，一个人的**聪明程度**不仅仅只与他的**智商值**有关，还可能与他**祖先的聪明程度**及他**出生的时代**有关。\n\n具体来说，在这个家族中，A 比 B 聪明**当且仅当** A 和 B 满足下面三种情况中的某一种：\n\n1. A 的智商值比 B 的智商值高；\n2. A 的智商值与 B 的智商值一样且 A 和 B 有不同的父亲，A 的父亲比 B 的父亲聪明；\n3. A 的智商值与 B 的智商值一样且 A 和 B 的父亲是同一个人或某一个人没有父亲，A 比 B 后出生。\n\n有一个很显然的结论是，这个家族中不会有两个人一样聪明。\n\n柯南需要回答小兰的 $q$ 个询问。为了方便说明，假设第 $i$ 个出生的人编号为 $i$。\n\n每个询问是下面三种情况中的某一种：\n\n1. `1 x`：询问编号为 $x$ 的人在整个家族中聪明程度排第几。\n2. `2 x k`：询问编号为 $x$ 的人及其祖先中第 $k$ 聪明的人的编号。\n3. `3 x k`：询问编号为 $x$ 的人及其后代中第 $k$ 聪明的人的编号。\n\n柯南还有许多案子要办，他不想在回答小兰的问题上浪费时间，他希望你能编程帮他回答小兰的所有询问。", "inputFormat": "第 $1$ 行包含两个数 $n, q$，分别表示人数和询问次数。\n\n第 $2$ 行包含 $n-1$ 个数 $f_{2 \\dots n}$，其中 $f_i$ 表示 $i$ 的父亲。\n\n第 $3$ 行包含 $n$ 个数 $a_{1 \\dots n}$，其中 $a_i$ 表示 $i$ 的智商值。\n\n接下来 $q$ 行每行两个或三个数表示一个合法询问，其中第一个数表示询问种类，后面一个或两个数为询问参数。", "outputFormat": "输出 $q$ 行，每行一个数表示询问的答案。", "hint": "【样例说明】\n\n形成的树如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eie1mrxb.png)\n\n首先比较编号为 $2,3$ 的两个人，由于** $3$ 号的智商值与 $2$ 号的智商值一样且他们的父亲是同一个人，$3$ 号比 $2$ 号后出生**满足第 $3$ 种情况，因此 $3$ 号比 $2$ 号聪明。\n\n再比较编号为 $4,5$ 的两个人，由于** $4$ 号的智商值与 $5$ 号的智商值一样且他们有不同的父亲，$4$ 号的父亲 $3$ 号比 $5$ 号的父亲 $2$ 号聪明**满足第 $2$ 种情况，因此 $4$ 号比 $5$ 号聪明。\n\n再比较编号为 $1,5$ 的两个人，由于** $5$ 号的智商值与 $1$ 号的智商值一样且 $1$ 号没有父亲，$5$ 号比 $1$ 号后出生**满足第 $3$ 种情况，因此 $5$ 号比 $1$ 号聪明。\n\n再根据第 $1$ 种情况比较编号为 $2,4$ 的两个人，可对 $5$ 人的聪明程度排序：$3 > 2 > 4 > 5 > 1$。\n\n【数据规模与约定】\n\n一共 $10$ 个测试点。\n\n对于前 $20\\%$ 的数据，$1 \\le n, q \\le 10 ^ 3$，每个测试点 $7$ 分，时限 1s。\n\n对于另 $20\\%$ 的数据，保证一个人最多只有一个儿子，每个测试点 $9$ 分，时限 4s。\n\n对于另 $20\\%$ 的数据，$1 \\le n, q \\le 10 ^ 5$，每个测试点 $9$ 分，时限 1.5s。\n\n对于另 $20\\%$ 的数据，保证只有第一种询问，每个测试点 $12$ 分，时限 1.5s。\n\n对于 $100\\%$ 的数据，$1 \\le n, q \\le 5 \\times 10 ^ 5$，$1 \\le a_i \\le 10 ^ 9$，每个测试点 $13$ 分，时限 2.5s。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Conan Family", "background": "xht37 has recently been addicted to *Detective Conan*.\n\nIn one episode, Ran suspects Conan’s true identity again. To stop Ran from suspecting him, Conan makes up a family background to answer Ran’s questions.", "description": "This family initially has only one person. Later, people keep having children, and up to now the family has $n$ people. Person $n$ is Conan. It is easy to see that this family forms a tree structure with $n$ nodes.\n\nTo make his made-up family background more realistic, Conan assigns each person an **IQ value**. However, a person’s **smartness** is not only related to their **IQ value**, but may also depend on their **ancestors’ smartness** and the **era when they were born**.\n\nSpecifically, in this family, A is smarter than B **if and only if** A and B satisfy one of the following three conditions:\n\n1. A’s IQ value is higher than B’s IQ value.\n2. A’s IQ value equals B’s IQ value, and A and B have different fathers; A’s father is smarter than B’s father.\n3. A’s IQ value equals B’s IQ value, and A and B have the same father or one of them has no father; A is born later than B.\n\nAn obvious conclusion is that no two people in this family are equally smart.\n\nConan needs to answer Ran’s $q$ queries. For convenience, assume the $i$-th person to be born is numbered $i$.\n\nEach query is one of the following three types:\n\n1. `1 x`: Ask what rank (in terms of smartness) the person numbered $x$ has in the whole family.\n2. `2 x k`: Ask for the number of the $k$-th smartest person among person $x$ and all their ancestors.\n3. `3 x k`: Ask for the number of the $k$-th smartest person among person $x$ and all their descendants.\n\nConan still has many cases to solve and does not want to waste time answering Ran’s questions. He hopes you can write a program to help him answer all queries.", "inputFormat": "The first line contains two integers $n, q$, representing the number of people and the number of queries.\n\nThe second line contains $n - 1$ integers $f_{2 \\dots n}$, where $f_i$ denotes the father of $i$.\n\nThe third line contains $n$ integers $a_{1 \\dots n}$, where $a_i$ denotes the IQ value of $i$.\n\nThe next $q$ lines each contain two or three integers describing a valid query. The first integer is the query type, and the following one or two integers are the query parameters.", "outputFormat": "Output $q$ lines, each containing one integer representing the answer to the query.", "hint": "[Sample Explanation]\n\nThe formed tree is as follows:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eie1mrxb.png)\n\nFirst compare persons $2$ and $3$. Since **person $3$ has the same IQ value as person $2$ and they have the same father, and person $3$ is born later than person $2$**, condition 3 is satisfied, so person $3$ is smarter than person $2$.\n\nThen compare persons $4$ and $5$. Since **person $4$ has the same IQ value as person $5$ and they have different fathers, and person $4$’s father (person $3$) is smarter than person $5$’s father (person $2$)**, condition 2 is satisfied, so person $4$ is smarter than person $5$.\n\nThen compare persons $1$ and $5$. Since **person $5$ has the same IQ value as person $1$ and person $1$ has no father, and person $5$ is born later than person $1$**, condition 3 is satisfied, so person $5$ is smarter than person $1$.\n\nThen, using condition 1 to compare persons $2$ and $4$, we can sort the smartness of the $5$ people as: $3 > 2 > 4 > 5 > 1$.\n\n[Constraints]\n\nThere are $10$ test points in total.\n\nFor the first $20\\%$ of the data, $1 \\le n, q \\le 10 ^ 3$. Each test point is worth $7$ points, time limit 1 s.\n\nFor another $20\\%$ of the data, each person has at most one son. Each test point is worth $9$ points, time limit 4 s.\n\nFor another $20\\%$ of the data, $1 \\le n, q \\le 10 ^ 5$. Each test point is worth $9$ points, time limit 1.5 s.\n\nFor another $20\\%$ of the data, only the first type of query is guaranteed. Each test point is worth $12$ points, time limit 1.5 s.\n\nFor $100\\%$ of the data, $1 \\le n, q \\le 5 \\times 10 ^ 5$, $1 \\le a_i \\le 10 ^ 9$. Each test point is worth $13$ points, time limit 2.5 s.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】柯南家族", "background": "xht37 最近沉迷于名侦探柯南。\n\n在某集中，小兰又在怀疑柯南的真实身份了。为了让小兰不再怀疑，柯南编造出自己的家族背景来应对小兰的询问。", "description": "这个家族一开始只有一个人，后来不断有人有了孩子，直到现在，这个家族有 $n$ 个人，第 $n$ 个人正是柯南。易知这个家族构成了一个 $n$ 个点的树形结构。\n\n柯南为了使自己编造的家庭背景更加真实，他给家族中的每个人赋予了一个**智商值**。但是，一个人的**聪明程度**不仅仅只与他的**智商值**有关，还可能与他**祖先的聪明程度**及他**出生的时代**有关。\n\n具体来说，在这个家族中，A 比 B 聪明**当且仅当** A 和 B 满足下面三种情况中的某一种：\n\n1. A 的智商值比 B 的智商值高；\n2. A 的智商值与 B 的智商值一样且 A 和 B 有不同的父亲，A 的父亲比 B 的父亲聪明；\n3. A 的智商值与 B 的智商值一样且 A 和 B 的父亲是同一个人或某一个人没有父亲，A 比 B 后出生。\n\n有一个很显然的结论是，这个家族中不会有两个人一样聪明。\n\n柯南需要回答小兰的 $q$ 个询问。为了方便说明，假设第 $i$ 个出生的人编号为 $i$。\n\n每个询问是下面三种情况中的某一种：\n\n1. `1 x`：询问编号为 $x$ 的人在整个家族中聪明程度排第几。\n2. `2 x k`：询问编号为 $x$ 的人及其祖先中第 $k$ 聪明的人的编号。\n3. `3 x k`：询问编号为 $x$ 的人及其后代中第 $k$ 聪明的人的编号。\n\n柯南还有许多案子要办，他不想在回答小兰的问题上浪费时间，他希望你能编程帮他回答小兰的所有询问。", "inputFormat": "第 $1$ 行包含两个数 $n, q$，分别表示人数和询问次数。\n\n第 $2$ 行包含 $n-1$ 个数 $f_{2 \\dots n}$，其中 $f_i$ 表示 $i$ 的父亲。\n\n第 $3$ 行包含 $n$ 个数 $a_{1 \\dots n}$，其中 $a_i$ 表示 $i$ 的智商值。\n\n接下来 $q$ 行每行两个或三个数表示一个合法询问，其中第一个数表示询问种类，后面一个或两个数为询问参数。", "outputFormat": "输出 $q$ 行，每行一个数表示询问的答案。", "hint": "【样例说明】\n\n形成的树如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eie1mrxb.png)\n\n首先比较编号为 $2,3$ 的两个人，由于** $3$ 号的智商值与 $2$ 号的智商值一样且他们的父亲是同一个人，$3$ 号比 $2$ 号后出生**满足第 $3$ 种情况，因此 $3$ 号比 $2$ 号聪明。\n\n再比较编号为 $4,5$ 的两个人，由于** $4$ 号的智商值与 $5$ 号的智商值一样且他们有不同的父亲，$4$ 号的父亲 $3$ 号比 $5$ 号的父亲 $2$ 号聪明**满足第 $2$ 种情况，因此 $4$ 号比 $5$ 号聪明。\n\n再比较编号为 $1,5$ 的两个人，由于** $5$ 号的智商值与 $1$ 号的智商值一样且 $1$ 号没有父亲，$5$ 号比 $1$ 号后出生**满足第 $3$ 种情况，因此 $5$ 号比 $1$ 号聪明。\n\n再根据第 $1$ 种情况比较编号为 $2,4$ 的两个人，可对 $5$ 人的聪明程度排序：$3 > 2 > 4 > 5 > 1$。\n\n【数据规模与约定】\n\n一共 $10$ 个测试点。\n\n对于前 $20\\%$ 的数据，$1 \\le n, q \\le 10 ^ 3$，每个测试点 $7$ 分，时限 1s。\n\n对于另 $20\\%$ 的数据，保证一个人最多只有一个儿子，每个测试点 $9$ 分，时限 4s。\n\n对于另 $20\\%$ 的数据，$1 \\le n, q \\le 10 ^ 5$，每个测试点 $9$ 分，时限 1.5s。\n\n对于另 $20\\%$ 的数据，保证只有第一种询问，每个测试点 $12$ 分，时限 1.5s。\n\n对于 $100\\%$ 的数据，$1 \\le n, q \\le 5 \\times 10 ^ 5$，$1 \\le a_i \\le 10 ^ 9$，每个测试点 $13$ 分，时限 2.5s。", "locale": "zh-CN"}}}
{"pid": "P5347", "type": "P", "difficulty": 7, "samples": [["1 3 2 0\n...\n", "7\n"], ["1 3 2 1\n...\n", "5\n"], ["2 2 1 0\n..\n..\n", "16\n"], ["2 2 1 1\n..\n..\n", "10\n"], ["2 2 1 0\n..\n#.\n", "4\n"], ["4 5 1 0\n.....\n.#.#.\n....#\n.#...\n", "65856\n"], ["4 5 1 1\n.....\n.#.#.\n....#\n.#...\n", "65616\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "轮廓线 DP"], "title": "【XR-1】俄罗斯方块", "background": "小粉兔最近沉迷一个名叫“俄罗斯方块”的游戏。\n\n然而本题除了都有格子和颜色之外和俄罗斯方块没什么关系。", "description": "有一个 $n \\times m$ 的方格图，小粉兔打算在其中画线。\n\n他可以画线若干次，也可以不画。每次画线必须从一个没有被画过的方格中心开始。\n\n只能往上下左右四个方向画线，对应方向上的方格记作**目标方格**。\n\n目标方格能被画，当且仅当下面三种情况：\n\n1. 如果目标方格**没有被画过**，则可以经过两个方格公共边的中点，直接画到目标方格中心，此时**可以选择**结束本次画线；\n2. 如果目标方格**已经被画过**，且这条画过的线是**贯穿整个方格的线**，则可以再画一条与这条线**垂直**的**贯穿整个方格的线**。对**贯穿整个方格的线**的定义为：这条线在方格中**没有改变方向**，**上下贯穿**或**左右贯穿**；\n3. 如果目标方格是本次画线的**起笔方格**，则可以经过两个方格公共边的中点，直接画到目标方格中心，此时**必须**结束本次画线。\n\n当然，不能画到整个方格图外面去。\n\n虽然小粉兔制定了如此严苛的规则，但是他仍然有很多种颜色的笔，每次画线他可以选择 $c$ 种颜色中的任意一种用来画线。\n\n不幸的是，方格图中有一些位置坏掉了，不能被经过，即在任意一次画线中不能画到坏掉的位置上。\n\n小粉兔想知道，在这些限制下，最终能画出多少种本质不同的图呢？\n\n小粉兔不想要求太多，当 $\\mathrm{op}=0$ 时，两张图本质相同当且仅当不考虑坏掉的方格，它们看起来相同（每个位置上的线条方向和颜色均相同）。\n\n而当 $\\mathrm{op}=1$ 时，两张图本质相同当且仅当不考虑坏掉的方格，它们看起来相同，或旋转 $180 ^ {\\circ}$ 后看起来相同。\n\n因为答案可能很多，所以小粉兔只想知道答案对 $998244353$ 取模的结果。", "inputFormat": "第一行三个正整数 $n,m,c$ 和一个非 $0$ 即 $1$ 的数 $\\mathrm{op}$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串，只包含 `.` 和 `#` 两种字符，描述方格图的情况。如果第 $i$ 行的第 $j$ 个字符为 `#` 则表示方格图中第 $i$ 行第 $j$ 列的方格坏掉了，否则没有坏掉。", "outputFormat": "输出一行一个数，表示答案对 $998244353$ 取模的结果。", "hint": "【样例 $1$ 说明】\n\n共有如下 $7$ 种本质不同的图：\n\n![](https://cdn.luogu.com.cn/upload/pic/57768.png)\n\n【样例 $6$ 说明】\n\n下面给出两种本质不同的图：\n\n![](https://cdn.luogu.com.cn/upload/pic/57770.png)\n\n【数据规模与约定】\n\n本题采用捆绑测试：\n\nSubtask 1（12 points）：$n=1$，$\\mathrm{op}=0$，没有坏掉的格子。  \nSubtask 2（13 points）：$c=1$，$\\mathrm{op}=0$。  \nSubtask 3（12 points）：$c=1$，$\\mathrm{op}=1$。  \nSubtask 4（14 points）：$m\\le 5$，$\\mathrm{op}=0$。  \nSubtask 5（25 points）：$\\mathrm{op}=0$。  \nSubtask 6（8 points）：$n\\bmod 2=0$，$\\mathrm{op}=1$。  \nSubtask 7（8 points）：$n\\bmod 2=1$，$m\\bmod 2=0$，$\\mathrm{op}=1$。  \nSubtask 8（8 points）：$n\\bmod 2=1$，$m\\bmod 2=1$，$\\mathrm{op}=1$。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 9$，$1\\le c\\le 10^6$，$\\mathrm{op}\\in\\{0,1\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Tetris", "background": "Xiao Fen Tu has recently become addicted to a game called “Tetris”.\n\nHowever, this problem has almost nothing to do with Tetris except that they both have grids and colors.", "description": "There is an $n \\times m$ grid. Xiao Fen Tu plans to draw lines in it.\n\nHe may draw lines any number of times, or draw none. Each time he draws, he must start from the center of a cell that has not been drawn before.\n\nHe may draw only in four directions: up, down, left, and right. The cell in the chosen direction is called the **target cell**.\n\nThe target cell can be drawn if and only if one of the following three cases holds:\n\n1. If the target cell **has not been drawn**, then he may pass through the midpoint of the common edge of the two cells and draw directly to the center of the target cell. In this case, he **may choose** to end this drawing operation.\n2. If the target cell **has been drawn**, and the drawn line is a **line that goes through the entire cell**, then he may draw another **line that goes through the entire cell** that is **perpendicular** to the existing one. A **line that goes through the entire cell** is defined as a line that **does not change direction** inside the cell, and goes through it **from top to bottom** or **from left to right**.\n3. If the target cell is the **starting cell** of the current drawing operation, then he may pass through the midpoint of the common edge of the two cells and draw directly to the center of the target cell. In this case, he **must** end this drawing operation.\n\nOf course, he cannot draw outside the whole grid.\n\nEven with such strict rules, he still has many colors of pens. Each time he draws, he may choose any one of the $c$ colors to draw the line.\n\nUnfortunately, some positions in the grid are broken and cannot be passed through, meaning that in any drawing operation he cannot draw onto broken positions.\n\nXiao Fen Tu wants to know: under these constraints, how many essentially different drawings can be produced in the end?\n\nXiao Fen Tu does not want to be too demanding. When $\\mathrm{op}=0$, two drawings are essentially the same if and only if, ignoring the broken cells, they look the same (the line direction and color at each position are the same).\n\nWhen $\\mathrm{op}=1$, two drawings are essentially the same if and only if, ignoring the broken cells, they look the same, or they look the same after a $180 ^ {\\circ}$ rotation.\n\nSince the answer may be very large, you only need the result modulo $998244353$.", "inputFormat": "The first line contains three positive integers $n,m,c$ and an integer $\\mathrm{op}$ that is either $0$ or $1$.\n\nThen follow $n$ lines, each containing a string of length $m$ consisting only of `.` and `#`, describing the grid. If the $j$-th character in the $i$-th line is `#`, it means the cell in row $i$, column $j$ is broken; otherwise it is not broken.", "outputFormat": "Output one line with one number, the answer modulo $998244353$.", "hint": "[Sample $1$ Explanation]\n\nThere are the following $7$ essentially different drawings:\n\n![](https://cdn.luogu.com.cn/upload/pic/57768.png)\n\n[Sample $6$ Explanation]\n\nTwo essentially different drawings are given below:\n\n![](https://cdn.luogu.com.cn/upload/pic/57770.png)\n\n[Data Scale and Constraints]\n\nThis problem uses bundled testdata:\n\nSubtask 1 (12 points): $n=1$, $\\mathrm{op}=0$, with no broken cells.  \nSubtask 2 (13 points): $c=1$, $\\mathrm{op}=0$.  \nSubtask 3 (12 points): $c=1$, $\\mathrm{op}=1$.  \nSubtask 4 (14 points): $m\\le 5$, $\\mathrm{op}=0$.  \nSubtask 5 (25 points): $\\mathrm{op}=0$.  \nSubtask 6 (8 points): $n\\bmod 2=0$, $\\mathrm{op}=1$.  \nSubtask 7 (8 points): $n\\bmod 2=1$, $m\\bmod 2=0$, $\\mathrm{op}=1$.  \nSubtask 8 (8 points): $n\\bmod 2=1$, $m\\bmod 2=1$, $\\mathrm{op}=1$.\n\nFor $100\\%$ of the data, $1\\le n,m\\le 9$, $1\\le c\\le 10^6$, $\\mathrm{op}\\in\\{0,1\\}$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】俄罗斯方块", "background": "小粉兔最近沉迷一个名叫“俄罗斯方块”的游戏。\n\n然而本题除了都有格子和颜色之外和俄罗斯方块没什么关系。", "description": "有一个 $n \\times m$ 的方格图，小粉兔打算在其中画线。\n\n他可以画线若干次，也可以不画。每次画线必须从一个没有被画过的方格中心开始。\n\n只能往上下左右四个方向画线，对应方向上的方格记作**目标方格**。\n\n目标方格能被画，当且仅当下面三种情况：\n\n1. 如果目标方格**没有被画过**，则可以经过两个方格公共边的中点，直接画到目标方格中心，此时**可以选择**结束本次画线；\n2. 如果目标方格**已经被画过**，且这条画过的线是**贯穿整个方格的线**，则可以再画一条与这条线**垂直**的**贯穿整个方格的线**。对**贯穿整个方格的线**的定义为：这条线在方格中**没有改变方向**，**上下贯穿**或**左右贯穿**；\n3. 如果目标方格是本次画线的**起笔方格**，则可以经过两个方格公共边的中点，直接画到目标方格中心，此时**必须**结束本次画线。\n\n当然，不能画到整个方格图外面去。\n\n虽然小粉兔制定了如此严苛的规则，但是他仍然有很多种颜色的笔，每次画线他可以选择 $c$ 种颜色中的任意一种用来画线。\n\n不幸的是，方格图中有一些位置坏掉了，不能被经过，即在任意一次画线中不能画到坏掉的位置上。\n\n小粉兔想知道，在这些限制下，最终能画出多少种本质不同的图呢？\n\n小粉兔不想要求太多，当 $\\mathrm{op}=0$ 时，两张图本质相同当且仅当不考虑坏掉的方格，它们看起来相同（每个位置上的线条方向和颜色均相同）。\n\n而当 $\\mathrm{op}=1$ 时，两张图本质相同当且仅当不考虑坏掉的方格，它们看起来相同，或旋转 $180 ^ {\\circ}$ 后看起来相同。\n\n因为答案可能很多，所以小粉兔只想知道答案对 $998244353$ 取模的结果。", "inputFormat": "第一行三个正整数 $n,m,c$ 和一个非 $0$ 即 $1$ 的数 $\\mathrm{op}$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串，只包含 `.` 和 `#` 两种字符，描述方格图的情况。如果第 $i$ 行的第 $j$ 个字符为 `#` 则表示方格图中第 $i$ 行第 $j$ 列的方格坏掉了，否则没有坏掉。", "outputFormat": "输出一行一个数，表示答案对 $998244353$ 取模的结果。", "hint": "【样例 $1$ 说明】\n\n共有如下 $7$ 种本质不同的图：\n\n![](https://cdn.luogu.com.cn/upload/pic/57768.png)\n\n【样例 $6$ 说明】\n\n下面给出两种本质不同的图：\n\n![](https://cdn.luogu.com.cn/upload/pic/57770.png)\n\n【数据规模与约定】\n\n本题采用捆绑测试：\n\nSubtask 1（12 points）：$n=1$，$\\mathrm{op}=0$，没有坏掉的格子。  \nSubtask 2（13 points）：$c=1$，$\\mathrm{op}=0$。  \nSubtask 3（12 points）：$c=1$，$\\mathrm{op}=1$。  \nSubtask 4（14 points）：$m\\le 5$，$\\mathrm{op}=0$。  \nSubtask 5（25 points）：$\\mathrm{op}=0$。  \nSubtask 6（8 points）：$n\\bmod 2=0$，$\\mathrm{op}=1$。  \nSubtask 7（8 points）：$n\\bmod 2=1$，$m\\bmod 2=0$，$\\mathrm{op}=1$。  \nSubtask 8（8 points）：$n\\bmod 2=1$，$m\\bmod 2=1$，$\\mathrm{op}=1$。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 9$，$1\\le c\\le 10^6$，$\\mathrm{op}\\in\\{0,1\\}$。", "locale": "zh-CN"}}}
{"pid": "P5348", "type": "P", "difficulty": 6, "samples": [["2\n5 1\n5 2", "4\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "密码解锁", "background": "在开锁公司劳动", "description": "这天，WD发现了一个很奇怪的密码锁，他记得CX让他解开这个密码锁之前告诉过他一些数字，可惜由于WD菜的真实，早就忘了那些数字是啥，只记得把他们从1到$n$编号后，对于任意的正整数$d(1\\le d\\le n)$，编号为$d$的倍数的数字之和恰好等于$\\mu(d)$（即$d$的莫比乌斯函数值）。\n\n现在，由于要打开这个密码锁，他必须知道第$m$个位置上的数字。由于他什么都不会，当然要请你来帮忙啦……", "inputFormat": "第一行一个数$T$，表示数据组数。接下来$T$行每行两个数，分别为$n,m$。", "outputFormat": "共$T$行，每行一个数字，表示第$m$个数字的值。显然可以证明解是唯一的。", "hint": "$subtask1(21pts):~n\\le 10^6,~T\\le 5$\n\n$subtask2(34pts):~n\\le 10^7,~T\\le 10$\n\n$subtask3(45pts):~n\\le 10^{18},~m\\le 10^9,~\\frac{n}{m}\\le 10^9,~T\\le 20$\n\n对于所有数据，$m\\le n$。\n\n对于样例1，满足要求的数列为4 -1 -1 0 -1.", "locale": "zh-CN", "translations": {"en": {"title": "Password Unlock", "background": "Working at a lock company.", "description": "One day, WD found a very strange combination lock. He remembered that before CX asked him to unlock it, CX told him some numbers. Unfortunately, since WD is really bad at this, he forgot what those numbers were. He only remembers that after numbering them from $1$ to $n$, for any positive integer $d(1\\le d\\le n)$, the sum of all numbers whose indices are multiples of $d$ is exactly $\\mu(d)$ (that is, the Möbius function value of $d$).\n\nNow, to open this lock, he must know the number at position $m$. Since he cannot do anything, he asks you for help.", "inputFormat": "The first line contains an integer $T$, indicating the number of test cases. The next $T$ lines each contain two integers $n,m$.", "outputFormat": "Output $T$ lines. Each line contains one integer, representing the value of the $m$-th number. It can be proven that the answer is unique.", "hint": "$subtask1(21pts):~n\\le 10^6,~T\\le 5$.\n\n$subtask2(34pts):~n\\le 10^7,~T\\le 10$.\n\n$subtask3(45pts):~n\\le 10^{18},~m\\le 10^9,~\\frac{n}{m}\\le 10^9,~T\\le 20$.\n\nFor all testdata, $m\\le n$.\n\nFor sample 1, the sequence that satisfies the requirement is 4 -1 -1 0 -1.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "密码解锁", "background": "在开锁公司劳动", "description": "这天，WD发现了一个很奇怪的密码锁，他记得CX让他解开这个密码锁之前告诉过他一些数字，可惜由于WD菜的真实，早就忘了那些数字是啥，只记得把他们从1到$n$编号后，对于任意的正整数$d(1\\le d\\le n)$，编号为$d$的倍数的数字之和恰好等于$\\mu(d)$（即$d$的莫比乌斯函数值）。\n\n现在，由于要打开这个密码锁，他必须知道第$m$个位置上的数字。由于他什么都不会，当然要请你来帮忙啦……", "inputFormat": "第一行一个数$T$，表示数据组数。接下来$T$行每行两个数，分别为$n,m$。", "outputFormat": "共$T$行，每行一个数字，表示第$m$个数字的值。显然可以证明解是唯一的。", "hint": "$subtask1(21pts):~n\\le 10^6,~T\\le 5$\n\n$subtask2(34pts):~n\\le 10^7,~T\\le 10$\n\n$subtask3(45pts):~n\\le 10^{18},~m\\le 10^9,~\\frac{n}{m}\\le 10^9,~T\\le 20$\n\n对于所有数据，$m\\le n$。\n\n对于样例1，满足要求的数列为4 -1 -1 0 -1.", "locale": "zh-CN"}}}
{"pid": "P5349", "type": "P", "difficulty": 6, "samples": [["1 499122177\n0 1", "2"], ["2 748683265\n0 0 1", "628524223"], ["3 713031681\n7 5 23 2", "257147786"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "幂", "background": "来到数学院劳动\n", "description": "$$\\text{求}\\ \\sum_{n=0}^{\\infty}f(n)\\ r^n\\ ,\\ f(n)\\text{为一个多项式},\\ r\\text{是一个}(0,1)\\text{内的有理数}$$\n\n若答案的最简分数为$\\frac{p}{q}$，你只需要输出$p\\times q^{-1}\\  \\mathrm{mod} \\ 998244353\\ $的值即可。", "inputFormat": "第一行两个整数$m,r$。$m$为多项式的次数。\n\n第二行$m+1$个整数，第$i$个为$x^{i-1}$的系数$a_{i-1}$。", "outputFormat": "仅一行一个数字，为答案。", "hint": "对于$10\\%$的数据，$m\\le 5$。\n\n对于$40\\%$的数据，$m\\le 2000$。\n\n对于$100\\%$的数据，$m\\le 10^5\\ ,\\ a_i\\in [0,998244353)$，保证$\\ a_{m}\\neq 0$\n\n**捆绑测试**\n\n----\n\n**样例1解释：**\n\n$499122177\\equiv \\frac{1}{2}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}n\\ (\\frac{1}{2})^n=2$\n\n-----\n\n**样例2解释：**\n\n$748683265\\equiv \\frac{1}{4}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}n^2\\ (\\frac{1}{4})^n=\\frac{20}{27}$\n\n-----\n\n**样例3解释：**\n\n$713031681\\equiv \\frac{2}{7}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}(2n^3+23n^2+5n+7)\\ (\\frac{2}{7})^n=\\frac{25417}{625}$\n\n", "locale": "zh-CN", "translations": {"en": {"title": "Power", "background": "Came to the School of Mathematics to do labor.", "description": "$$\\text{Find}\\ \\sum_{n=0}^{\\infty}f(n)\\ r^n\\ ,\\ f(n)\\text{ is a polynomial},\\ r\\text{ is a rational number in }(0,1)$$\n\nIf the simplest fraction form of the answer is $\\frac{p}{q}$, you only need to output the value of $p\\times q^{-1}\\ \\mathrm{mod}\\ 998244353$.", "inputFormat": "The first line contains two integers $m, r$. $m$ is the degree of the polynomial.\n\nThe second line contains $m+1$ integers. The $i$-th integer is the coefficient $a_{i-1}$ of $x^{i-1}$.", "outputFormat": "Only one line with one number, which is the answer.", "hint": "For $10\\%$ of the testdata, $m\\le 5$.\n\nFor $40\\%$ of the testdata, $m\\le 2000$.\n\nFor $100\\%$ of the testdata, $m\\le 10^5\\ ,\\ a_i\\in [0,998244353)$, and it is guaranteed that $\\ a_{m}\\neq 0$.\n\n**Bundled Tests**\n\n----\n\n**Sample 1 Explanation:**\n\n$499122177\\equiv \\frac{1}{2}\\ (\\mathrm{mod}\\ 998244353)$.\n\n$\\sum_{n=0}^{\\infty}n\\ (\\frac{1}{2})^n=2$.\n\n-----\n\n**Sample 2 Explanation:**\n\n$748683265\\equiv \\frac{1}{4}\\ (\\mathrm{mod}\\ 998244353)$.\n\n$\\sum_{n=0}^{\\infty}n^2\\ (\\frac{1}{4})^n=\\frac{20}{27}$.\n\n-----\n\n**Sample 3 Explanation:**\n\n$713031681\\equiv \\frac{2}{7}\\ (\\mathrm{mod}\\ 998244353)$.\n\n$\\sum_{n=0}^{\\infty}(2n^3+23n^2+5n+7)\\ (\\frac{2}{7})^n=\\frac{25417}{625}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "幂", "background": "来到数学院劳动\n", "description": "$$\\text{求}\\ \\sum_{n=0}^{\\infty}f(n)\\ r^n\\ ,\\ f(n)\\text{为一个多项式},\\ r\\text{是一个}(0,1)\\text{内的有理数}$$\n\n若答案的最简分数为$\\frac{p}{q}$，你只需要输出$p\\times q^{-1}\\  \\mathrm{mod} \\ 998244353\\ $的值即可。", "inputFormat": "第一行两个整数$m,r$。$m$为多项式的次数。\n\n第二行$m+1$个整数，第$i$个为$x^{i-1}$的系数$a_{i-1}$。", "outputFormat": "仅一行一个数字，为答案。", "hint": "对于$10\\%$的数据，$m\\le 5$。\n\n对于$40\\%$的数据，$m\\le 2000$。\n\n对于$100\\%$的数据，$m\\le 10^5\\ ,\\ a_i\\in [0,998244353)$，保证$\\ a_{m}\\neq 0$\n\n**捆绑测试**\n\n----\n\n**样例1解释：**\n\n$499122177\\equiv \\frac{1}{2}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}n\\ (\\frac{1}{2})^n=2$\n\n-----\n\n**样例2解释：**\n\n$748683265\\equiv \\frac{1}{4}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}n^2\\ (\\frac{1}{4})^n=\\frac{20}{27}$\n\n-----\n\n**样例3解释：**\n\n$713031681\\equiv \\frac{2}{7}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}(2n^3+23n^2+5n+7)\\ (\\frac{2}{7})^n=\\frac{25417}{625}$\n\n", "locale": "zh-CN"}}}
{"pid": "P5350", "type": "P", "difficulty": 6, "samples": [["10 10\n7 1 3 2 2 4 0 1 2 2 \n4 10 10 3 3\n3 4 10 5\n6 6 7\n6 9 10\n1 10 10\n5 9 10 6 7\n2 8 10 0\n5 4 4 5 5\n5 2 4 8 10\n3 3 9 0", "7\n7 0 0 0 7 7 7 1 2 7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["平衡树", "颜色段均摊（珂朵莉树 ODT）", "洛谷原创", "可持久化"], "title": "序列", "background": "搬运序列", "description": "有一个序列 $a_{1\\sim n}$ 和若干操作。\n\n- $\\mathrm{1\\  l \\  r \\ }$：求 $a_l$ 到 $a_r$ 的和。\n- $\\mathrm{2\\  l \\  r \\ val \\ }$：将 $a_l$ 到 $a_r$ 赋值为 $\\mathrm{val}$。\n- $\\mathrm{3\\  l \\  r \\ val\\ }$：将 $a_l$ 到 $a_r$ 加上 $\\mathrm{val}$。\n- $\\mathrm{4\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$：将 $a_{l_1}$ 到 $a_{r_1}$ 复制到 $a_{l_2}$ 到 $a_{r_2}$ 处。\n- $\\mathrm{5\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$：将 $a_{l_1}$ 到 $a_{r_1}$ 与 $a_{l_2}$ 到 $a_{r_2}$ 交换。 \n- $\\mathrm{6\\  l \\  r \\ }$：将 $a_l$ 到 $a_r$ 翻转。", "inputFormat": "第一行两个数 $n$ 和 $m$，为序列长度和操作个数。\n\n第二行 $n$ 个数，为 $a_{1\\sim n}$。\n\n下面 $m$ 行，每行为操作种类和相应的若干整数。", "outputFormat": "若干行，对于每个 $1$ 操作，输出答案。\n\n由于答案可能过大，对 $10^9+7$ 取模。\n\n最后一行输出序列 $a_{1\\sim n}$。当然也要取模。", "hint": "**请注意常数优化。**\n\n对于 $4$ 和 $5$ 操作，保证 $r_1-l_1=r_2-l_2$ 且区间不重叠。\n\n\n保证数据随机。\n\n对于 $30\\%$ 的数据，保证 $\\ n,m\\le 10^3\\ $。\n\n对于 $50\\%$ 的数据，保证 $\\ n,m\\le 5\\times 10^4\\ $。\n\n对于 $70\\%$ 的数据，保证 $\\ n,m\\le 1.5\\times 10^5\\ $。\n\n对于 $100\\%$ 的数据，保证 $\\ n,m\\le 3\\times 10^5\\ $，$\\ 0\\le a_i,\\mathrm{val}< 10^9+7 $。", "locale": "zh-CN", "translations": {"en": {"title": "Sequence", "background": "Moving sequences.", "description": "There is a sequence $a_{1\\sim n}$ and several operations.\n\n- $\\mathrm{1\\  l \\  r \\ }$: Find the sum from $a_l$ to $a_r$.\n- $\\mathrm{2\\  l \\  r \\ val \\ }$: Assign $\\mathrm{val}$ to $a_l$ through $a_r$.\n- $\\mathrm{3\\  l \\  r \\ val\\ }$: Add $\\mathrm{val}$ to $a_l$ through $a_r$.\n- $\\mathrm{4\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$: Copy $a_{l_1}$ through $a_{r_1}$ to the range $a_{l_2}$ through $a_{r_2}$.\n- $\\mathrm{5\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$: Swap $a_{l_1}$ through $a_{r_1}$ with $a_{l_2}$ through $a_{r_2}$.\n- $\\mathrm{6\\  l \\  r \\ }$: Reverse $a_l$ through $a_r$.", "inputFormat": "The first line contains two numbers $n$ and $m$, the length of the sequence and the number of operations.\n\nThe second line contains $n$ numbers, which are $a_{1\\sim n}$.\n\nThe next $m$ lines each describe an operation type and several corresponding integers.", "outputFormat": "Print several lines. For each operation of type $1$, output the answer.\n\nSince the answer may be too large, take it modulo $10^9+7$.\n\nOn the last line, output the sequence $a_{1\\sim n}$. It should also be taken modulo.", "hint": "**Please pay attention to constant-factor optimizations.**\n\nFor operations $4$ and $5$, it is guaranteed that $r_1-l_1=r_2-l_2$ and the intervals do not overlap.\n\nThe testdata is guaranteed to be random.\n\nFor $30\\%$ of the testdata, $\\ n,m\\le 10^3\\ $.\n\nFor $50\\%$ of the testdata, $\\ n,m\\le 5\\times 10^4\\ $.\n\nFor $70\\%$ of the testdata, $\\ n,m\\le 1.5\\times 10^5\\ $.\n\nFor $100\\%$ of the testdata, $\\ n,m\\le 3\\times 10^5\\ $，$\\ 0\\le a_i,\\mathrm{val}< 10^9+7 $。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "序列", "background": "搬运序列", "description": "有一个序列 $a_{1\\sim n}$ 和若干操作。\n\n- $\\mathrm{1\\  l \\  r \\ }$：求 $a_l$ 到 $a_r$ 的和。\n- $\\mathrm{2\\  l \\  r \\ val \\ }$：将 $a_l$ 到 $a_r$ 赋值为 $\\mathrm{val}$。\n- $\\mathrm{3\\  l \\  r \\ val\\ }$：将 $a_l$ 到 $a_r$ 加上 $\\mathrm{val}$。\n- $\\mathrm{4\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$：将 $a_{l_1}$ 到 $a_{r_1}$ 复制到 $a_{l_2}$ 到 $a_{r_2}$ 处。\n- $\\mathrm{5\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$：将 $a_{l_1}$ 到 $a_{r_1}$ 与 $a_{l_2}$ 到 $a_{r_2}$ 交换。 \n- $\\mathrm{6\\  l \\  r \\ }$：将 $a_l$ 到 $a_r$ 翻转。", "inputFormat": "第一行两个数 $n$ 和 $m$，为序列长度和操作个数。\n\n第二行 $n$ 个数，为 $a_{1\\sim n}$。\n\n下面 $m$ 行，每行为操作种类和相应的若干整数。", "outputFormat": "若干行，对于每个 $1$ 操作，输出答案。\n\n由于答案可能过大，对 $10^9+7$ 取模。\n\n最后一行输出序列 $a_{1\\sim n}$。当然也要取模。", "hint": "**请注意常数优化。**\n\n对于 $4$ 和 $5$ 操作，保证 $r_1-l_1=r_2-l_2$ 且区间不重叠。\n\n\n保证数据随机。\n\n对于 $30\\%$ 的数据，保证 $\\ n,m\\le 10^3\\ $。\n\n对于 $50\\%$ 的数据，保证 $\\ n,m\\le 5\\times 10^4\\ $。\n\n对于 $70\\%$ 的数据，保证 $\\ n,m\\le 1.5\\times 10^5\\ $。\n\n对于 $100\\%$ 的数据，保证 $\\ n,m\\le 3\\times 10^5\\ $，$\\ 0\\le a_i,\\mathrm{val}< 10^9+7 $。", "locale": "zh-CN"}}}
{"pid": "P5351", "type": "P", "difficulty": 6, "samples": [["5 2 3\n1 2 2\n2 3 2\n3 4 4\n4 5 5", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "Ruri Loves Maschera", "background": "琉璃最近沉迷于《Maschera》的二次创作。", "description": "琉璃小说中的世界有 $n$ 座城市，其中有 $n-1$ 条道路，不包含重边、自环。这 $n-1$ 条道路中，第 $i$ 条道路的魔力值为 $w_i$。\n\n琉璃作为夜魔女王，她决定要观光整个黑暗世界 。她每次会随机选一个城市为起点，经过不少于 $L$ 条且不多于 $R$ 条道路后在一个城市为终点结束。**她在观光的时候是不走回头路的**。若琉璃每次观光中经过道路的魔力值依次为 $v_1,v_2,...,v_k(L\\leq k\\leq R)$，那么她会获得 $\\max(v_1,v_2,...,v_k)$ 的魔力值。\n\n现在琉璃想知道，她尝试了所有合法的观光路线后，她所获得的魔力值总和为多少。\n\n**注意，$x$ 到 $y$ 的路径和 $y$ 到 $x$ 的路径视为两条路径。**", "inputFormat": "第一行三个数 $n,L,R$\n\n接下来 $n-1$ 行，每行三个数 $x,y,w$，表示 $x$ 结点和 $y$ 结点之间有一条魔力值为 $w$ 的道路。", "outputFormat": "输出她所获得的魔力值总和。", "hint": "数据范围：\n\n对于 $10\\%$ 的数据，$n\\leq 5000$\n\n另有 $10\\%$ 的数据，$\\min(x,y)=1$\n\n另有 $15\\%$ 的数据，$|x-y|=1$\n\n另有 $25\\%$ 的数据，$L=1,R=n-1$\n\n对于 $100\\%$ 的数据，$n\\leq 10^5,1\\leq L\\leq R\\leq n-1,1\\leq w_i\\leq 10^5$", "locale": "zh-CN", "translations": {"en": {"title": "Ruri Loves Maschera", "background": "Ruri has recently become obsessed with fan creations of *Maschera*.", "description": "The world in Ruri’s novel has $n$ cities and $n-1$ roads, with no multiple edges or self-loops. Among these $n-1$ roads, the magic value of the $i$-th road is $w_i$.\n\nAs the Queen of the Night Demons, Ruri decides to tour the entire dark world. Each time, she randomly chooses a city as the starting point, and ends at some city after passing through at least $L$ roads and at most $R$ roads. **She never goes back along the same road during the tour.** If the magic values of the roads she passes through in one tour are $v_1, v_2, ..., v_k$ $(L \\leq k \\leq R)$ in order, then she gains a magic value of $\\max(v_1, v_2, ..., v_k)$.\n\nNow Ruri wants to know: after trying all valid tour routes, what is the total sum of the magic values she gains?\n\n**Note that the path from $x$ to $y$ and the path from $y$ to $x$ are considered two different paths.**", "inputFormat": "The first line contains three integers $n, L, R$.\n\nThe next $n-1$ lines each contain three integers $x, y, w$, indicating that there is a road between node $x$ and node $y$ with magic value $w$.", "outputFormat": "Output the total sum of the magic values she gains.", "hint": "Constraints:\n\nFor $10\\%$ of the testdata, $n \\leq 5000$.\n\nFor another $10\\%$ of the testdata, $\\min(x, y) = 1$.\n\nFor another $15\\%$ of the testdata, $|x - y| = 1$.\n\nFor another $25\\%$ of the testdata, $L = 1, R = n - 1$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^5$, $1 \\leq L \\leq R \\leq n - 1$, and $1 \\leq w_i \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Ruri Loves Maschera", "background": "琉璃最近沉迷于《Maschera》的二次创作。", "description": "琉璃小说中的世界有 $n$ 座城市，其中有 $n-1$ 条道路，不包含重边、自环。这 $n-1$ 条道路中，第 $i$ 条道路的魔力值为 $w_i$。\n\n琉璃作为夜魔女王，她决定要观光整个黑暗世界 。她每次会随机选一个城市为起点，经过不少于 $L$ 条且不多于 $R$ 条道路后在一个城市为终点结束。**她在观光的时候是不走回头路的**。若琉璃每次观光中经过道路的魔力值依次为 $v_1,v_2,...,v_k(L\\leq k\\leq R)$，那么她会获得 $\\max(v_1,v_2,...,v_k)$ 的魔力值。\n\n现在琉璃想知道，她尝试了所有合法的观光路线后，她所获得的魔力值总和为多少。\n\n**注意，$x$ 到 $y$ 的路径和 $y$ 到 $x$ 的路径视为两条路径。**", "inputFormat": "第一行三个数 $n,L,R$\n\n接下来 $n-1$ 行，每行三个数 $x,y,w$，表示 $x$ 结点和 $y$ 结点之间有一条魔力值为 $w$ 的道路。", "outputFormat": "输出她所获得的魔力值总和。", "hint": "数据范围：\n\n对于 $10\\%$ 的数据，$n\\leq 5000$\n\n另有 $10\\%$ 的数据，$\\min(x,y)=1$\n\n另有 $15\\%$ 的数据，$|x-y|=1$\n\n另有 $25\\%$ 的数据，$L=1,R=n-1$\n\n对于 $100\\%$ 的数据，$n\\leq 10^5,1\\leq L\\leq R\\leq n-1,1\\leq w_i\\leq 10^5$", "locale": "zh-CN"}}}
{"pid": "P5352", "type": "P", "difficulty": 6, "samples": [["4 10\n1 2 3 4\nL 1 2\nL 2 3\nL 2 4\nA 1 4\nU 3 4 2\nO 1 4\nC 2 4\nL 3 4\nX 1 4\nS 1 3", "0\n7\n6\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "Terrible Homework", "background": "“像糟糕的作业一样糟糕。”", "description": "$ben$同学最讨厌做作业了。\n\n现在，老师布置给了$ben$同学$n$份作业，每份作业有一个难度值$A_i$。\n\n一开始，每份作业都是独立的。有一些操作，每次在两份作业$x,y$间加一条边或删除一条边。\n\n由于老师喜怒无常，因此还有一些操作，是将两份作业$x,y$之间路径上的所有作业的难度值都$xor$上一个值。\n\n同时，为了满足$ben$同学的好奇心，你需要回答两份作业$x,y$之间的所有作业的难度$and$和、难度$or$和、难度$xor$和以及难度和。", "inputFormat": "第一行两个正整数$n,q$，分别表示作业份数和操作个数。\n\n接下来一行，$n$个自然数$A_1,...,A_n$，表示每份作业的难度值。\n\n接下来$q$行，每行一个操作：\n\n- $L\\ x\\ y$：在$x,y$两份作业之间连一条边。（保证不会形成环，即任何时候这张图都是一个森林）\n- $C\\ x\\ y$：删除$x,y$两份作业之间的边。（保证这条边存在且不会被删除多次）\n- $U\\ x\\ y\\ v$：将$x,y$两份作业之间路径上的所有作业的难度值都$xor$上$v$。（包括这两份作业，且保证联通，下同）\n- $A\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$and$和。\n- $O\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$or$和。\n- $X\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$xor$和。\n- $S\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度和。", "outputFormat": "对于每一个$A,O,X,S$操作，输出答案。", "hint": "对于$10\\%$的数据，$n=100,m=100$。\n\n另有$10\\%$的数据，$n=5000,m=5000$。\n\n另有$20\\%$的数据，$n=10000,m=10000$。\n\n对于$100\\%$的数据，$2\\le n,m\\le100000,0\\le A_i<2^{30}$。", "locale": "zh-CN", "translations": {"en": {"title": "Terrible Homework", "background": "“As terrible as terrible homework.”", "description": "Student $ben$ hates doing homework the most.\n\nNow, the teacher has assigned $n$ homework tasks to $ben$. Each task has a difficulty value $A_i$.\n\nAt the beginning, every homework task is independent. There are some operations: each time, you add an edge between two tasks $x, y$ or delete an edge.\n\nBecause the teacher’s mood changes often, there are also operations that apply $xor$ with a value to the difficulty values of all tasks on the path between two tasks $x, y$.\n\nAlso, to satisfy $ben$’s curiosity, you need to answer, for all tasks on the path between $x, y$, the bitwise $and$ sum, bitwise $or$ sum, bitwise $xor$ sum, and the ordinary sum of difficulty values.", "inputFormat": "The first line contains two positive integers $n, q$, representing the number of homework tasks and the number of operations.\n\nThe next line contains $n$ non-negative integers $A_1, ..., A_n$, representing the difficulty value of each task.\n\nThen follow $q$ lines, each describing one operation:\n\n- $L\\ x\\ y$: Add an edge between tasks $x$ and $y$. (It is guaranteed that no cycle will be formed, i.e. the graph is always a forest.)\n- $C\\ x\\ y$: Delete the edge between $x$ and $y$. (It is guaranteed that this edge exists and will not be deleted more than once.)\n- $U\\ x\\ y\\ v$: Apply $xor$ with $v$ to the difficulty values of all tasks on the path between $x$ and $y$. (Including $x$ and $y$, and it is guaranteed that they are connected; the same applies below.)\n- $A\\ x\\ y$: Query the bitwise $and$ sum of the difficulty values of all tasks on the path between $x$ and $y$.\n- $O\\ x\\ y$: Query the bitwise $or$ sum of the difficulty values of all tasks on the path between $x$ and $y$.\n- $X\\ x\\ y$: Query the bitwise $xor$ sum of the difficulty values of all tasks on the path between $x$ and $y$.\n- $S\\ x\\ y$: Query the ordinary sum of the difficulty values of all tasks on the path between $x$ and $y$.", "outputFormat": "For each $A, O, X, S$ operation, output the answer.", "hint": "For $10\\%$ of the testdata, $n = 100, q = 100$.\n\nFor another $10\\%$ of the testdata, $n = 5000, q = 5000$.\n\nFor another $20\\%$ of the testdata, $n = 10000, q = 10000$.\n\nFor $100\\%$ of the testdata, $2 \\le n, q \\le 100000$, $0 \\le A_i < 2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Terrible Homework", "background": "“像糟糕的作业一样糟糕。”", "description": "$ben$同学最讨厌做作业了。\n\n现在，老师布置给了$ben$同学$n$份作业，每份作业有一个难度值$A_i$。\n\n一开始，每份作业都是独立的。有一些操作，每次在两份作业$x,y$间加一条边或删除一条边。\n\n由于老师喜怒无常，因此还有一些操作，是将两份作业$x,y$之间路径上的所有作业的难度值都$xor$上一个值。\n\n同时，为了满足$ben$同学的好奇心，你需要回答两份作业$x,y$之间的所有作业的难度$and$和、难度$or$和、难度$xor$和以及难度和。", "inputFormat": "第一行两个正整数$n,q$，分别表示作业份数和操作个数。\n\n接下来一行，$n$个自然数$A_1,...,A_n$，表示每份作业的难度值。\n\n接下来$q$行，每行一个操作：\n\n- $L\\ x\\ y$：在$x,y$两份作业之间连一条边。（保证不会形成环，即任何时候这张图都是一个森林）\n- $C\\ x\\ y$：删除$x,y$两份作业之间的边。（保证这条边存在且不会被删除多次）\n- $U\\ x\\ y\\ v$：将$x,y$两份作业之间路径上的所有作业的难度值都$xor$上$v$。（包括这两份作业，且保证联通，下同）\n- $A\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$and$和。\n- $O\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$or$和。\n- $X\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$xor$和。\n- $S\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度和。", "outputFormat": "对于每一个$A,O,X,S$操作，输出答案。", "hint": "对于$10\\%$的数据，$n=100,m=100$。\n\n另有$10\\%$的数据，$n=5000,m=5000$。\n\n另有$20\\%$的数据，$n=10000,m=10000$。\n\n对于$100\\%$的数据，$2\\le n,m\\le100000,0\\le A_i<2^{30}$。", "locale": "zh-CN"}}}
{"pid": "P5353", "type": "P", "difficulty": 6, "samples": [["5\n1 1 3 2\nabbaa", "1 5 4 2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "倍增", "O2优化", "后缀数组 SA"], "title": "树上后缀排序", "background": "", "description": "给定一棵以 $1$ 为根包含 $n$ 个节点的树，保证对于 $2 \\sim n$ 的每个节点，其父亲的编号均小于自己的编号。\n\n每个节点上有一个的字符，一个节点所代表的字符串定义为从当前节点一直到根节点的简单路径上经过的所有字符连起来形成的字符串。\n\n请你给这些字符串按照字典序排序。\n\n特别地，如果两个节点所代表的字符串完全相同，它们的大小由它们父亲排名的大小决定，即谁的父亲排名大谁就更大；如果仍相同，则由它们编号的大小决定，即谁的编号大谁就更大。", "inputFormat": "第一行包含一个正整数 $n$。\n\n第二行包含 $n-1$ 个数 $f_{2 \\dots n}$，其中 $f_i$ 表示 $i$ 的父亲。\n\n第三行为一个包含 $n$ 个**小写字母**的字符串 $s$，其中 $s_i$ 表示编号为 $i$ 的节点上的字符。", "outputFormat": "输出一行 $n$ 个正整数，第 $i$ 个正整数表示代表**排名第 $i$ 的字符串**的节点编号。", "hint": "对于 $20\\%$ 的数据，$n \\le 10 ^ 3$。\n\n对于 $50\\%$ 的数据，$n \\le 10 ^ 5$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10 ^ 5$。", "locale": "zh-CN", "translations": {"en": {"title": "Suffix Sorting on a Tree", "background": "", "description": "Given a tree rooted at $1$ with $n$ nodes, it is guaranteed that for every node from $2$ to $n$, the index of its parent is smaller than its own index.\n\nEach node has a character. The string represented by a node is defined as the string formed by concatenating all characters on the simple path from the current node up to the root.\n\nPlease sort these strings in lexicographical order.\n\nIn particular, if the strings represented by two nodes are exactly the same, their order is determined by the order of their parents: the one whose parent has a larger rank is considered larger. If they are still the same, then their order is determined by their node indices: the one with the larger index is considered larger.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n - 1$ integers $f_{2 \\dots n}$, where $f_i$ denotes the parent of node $i$.\n\nThe third line contains a string $s$ of length $n$ consisting of **lowercase letters**, where $s_i$ is the character on node $i$.", "outputFormat": "Output one line with $n$ positive integers. The $i$-th integer denotes the node index that represents the **string ranked $i$-th**.", "hint": "For $20\\%$ of the testdata, $n \\le 10 ^ 3$.\n\nFor $50\\%$ of the testdata, $n \\le 10 ^ 5$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 5 \\times 10 ^ 5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "树上后缀排序", "background": "", "description": "给定一棵以 $1$ 为根包含 $n$ 个节点的树，保证对于 $2 \\sim n$ 的每个节点，其父亲的编号均小于自己的编号。\n\n每个节点上有一个的字符，一个节点所代表的字符串定义为从当前节点一直到根节点的简单路径上经过的所有字符连起来形成的字符串。\n\n请你给这些字符串按照字典序排序。\n\n特别地，如果两个节点所代表的字符串完全相同，它们的大小由它们父亲排名的大小决定，即谁的父亲排名大谁就更大；如果仍相同，则由它们编号的大小决定，即谁的编号大谁就更大。", "inputFormat": "第一行包含一个正整数 $n$。\n\n第二行包含 $n-1$ 个数 $f_{2 \\dots n}$，其中 $f_i$ 表示 $i$ 的父亲。\n\n第三行为一个包含 $n$ 个**小写字母**的字符串 $s$，其中 $s_i$ 表示编号为 $i$ 的节点上的字符。", "outputFormat": "输出一行 $n$ 个正整数，第 $i$ 个正整数表示代表**排名第 $i$ 的字符串**的节点编号。", "hint": "对于 $20\\%$ 的数据，$n \\le 10 ^ 3$。\n\n对于 $50\\%$ 的数据，$n \\le 10 ^ 5$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10 ^ 5$。", "locale": "zh-CN"}}}
{"pid": "P5354", "type": "P", "difficulty": 6, "samples": [["5 5 3\n1 7\n2 6\n3 7\n3 6\n3 1\n1 2\n2 3\n3 4\n1 5\n1 1 4 7\n1 1 3 5\n2 1 1 3\n2 3 3 3\n1 1 3 2", "7\n1\n5"], ["2 2 2\n2 2\n2 2\n1 2\n2 2 2 2\n1 2 2 2", "3"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "线段树", "O2优化", "树链剖分", "动态树 LCT", "洛谷月赛", "Ynoi"], "title": "[Ynoi Easy Round 2017] 由乃的 OJ", "background": "![](https://cdn.luogu.com.cn/upload/pic/58221.png)", "description": "由乃正在做她的OJ。现在她在处理OJ上的用户排名问题。\n\nOJ 上注册了 $n$ 个用户，编号为 $1\\sim n$，一开始他们按照编号排名。由乃会按照心情对这些用户做以下四种操作，修改用户的排名和编号：然而由乃心情非常不好，因为 Deus 天天问她题。。。\n \n因为 Deus 天天问由乃 OI 题，所以由乃去学习了一下 OI，由于由乃智商挺高，所以 OI 学的特别熟练。\n\n她在 RBOI2016 中以第一名的成绩进入省队，参加了 NOI2016 获得了金牌保送。\n\nDeus：这个题怎么做呀？  \nyuno：这个不是 NOI2014 的水题吗。。。  \nDeus：那如果出到树上，多组链询问，带修改呢？  \nyuno：诶。。。？？？  \nDeus：这题叫做睡觉困难综合征哟~  \n\n虽然由乃 OI 很好，但是她基本上不会 DS，线段树都只会口胡，比如她 NOI2016 的分数就是 $100+100+100+0+100+100$。。。NOIP2017 的分数是 $100+0+100+100+0+100$。\n\n所以她还是只能找你帮她做了。。。\n\n给你一个有 $n$ 个点的树，每个点的包括一个位运算 $opt$ 和一个权值 $x$，位运算有`&`，`|`，`^` 三种，分别用 $1,2,3$ 表示。\n\n每次询问包含三个整数 $x,y,z$，初始选定一个数 $v$。然后 $v$ 依次经过从 $x$ 到 $y$ 的所有节点，每经过一个点 $i$，$v$ 就变成 $v\\ opt_i\\ x_i$，所以他想问你，最后到 $y$ 时，希望得到的值尽可能大，求最大值。给定的初始值 $v$ 必须是在 $[0,z]$ 之间。\n\n每次修改包含三个整数 $x,y,z$，意思是把 $x$ 点的操作修改为 $y$，数值改为 $z$。", "inputFormat": "第一行三个整数 $n,m,k$。$k$ 的意义是每个点上的数，以及询问中的数值 $z$ 都小于 $2^k$。\n\n之后 $n$ 行，每行两个整数 $x,y$ 表示该点的位运算编号以及数值。\n\n之后 $n - 1$ 行，每行两个数 $x,y$ 表示 $x$ 和 $y$ 之间有边相连。\n\n之后 $m$ 行，每行四个数，$Q,x,y,z$ 表示这次操作为 $Q$（$1$ 为询问，$2$ 为修改），$x,y,z$ 意义如题所述。", "outputFormat": "对于每个操作 $1$，输出到最后可以得到的最大值。", "hint": "Idea：f321dd，Solution：f321dd&nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $30\\%$ 的数据，$n,m\\leq 1$。\n\n对于另外 $20\\%$ 的数据，$k\\leq 5$。\n\n对于另外 $20\\%$ 的数据，位运算只会出现一种。\n\n对于 $100\\%$ 的数据，$0\\leq n,m \\leq 10^5$，$0\\leq k\\leq 64$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2017] Yuno’s OJ", "background": "![](https://cdn.luogu.com.cn/upload/pic/58221.png)", "description": "Yuno is building her OJ. Now she is dealing with the user ranking problem.\n\nThere are $n$ users registered on the OJ, numbered $1\\sim n$. Initially, they are ranked by their indices. Yuno, depending on her mood, would like to perform the following four types of operations to modify users’ rankings and indices. However, Yuno is in a very bad mood because Deus keeps asking her problems...\n\nBecause Deus keeps asking Yuno OI problems, Yuno went to study OI. Since Yuno is quite smart, she learned OI very well.\n\nShe entered the provincial team with the first place at RBOI2016 and then won a gold medal and a direct recommendation at NOI2016.\n\nDeus: How do you solve this problem?  \nYuno: Isn’t this just an easy problem from NOI2014...  \nDeus: What if we put it on a tree, with multiple path queries, with modifications?  \nYuno: Eh...???  \nDeus: This problem is called “睡觉困难综合征”~\n\nAlthough Yuno is good at OI, she basically isn’t good at DS; she can only hand-wave segment trees. For example, her NOI2016 scores were $100+100+100+0+100+100$... and her NOIP2017 scores were $100+0+100+100+0+100$.\n\nSo she still has to ask you to help her...\n\nYou are given a tree with $n$ nodes. Each node has a bitwise operation $opt$ and a value $x$. The bitwise operations are `&`, `|`, `^`, represented by $1,2,3$ respectively.\n\nEach query consists of three integers $x,y,z$. You choose an initial number $v$. Then $v$ passes through all nodes on the path from $x$ to $y$ in order. Every time it passes a node $i$, $v$ becomes $v\\ opt_i\\ x_i$. She wants to know the maximum possible final value when reaching $y$. The initial value $v$ must be in $[0,z]$.\n\nEach modification consists of three integers $x,y,z$, meaning that the operation at node $x$ is changed to $y$ and its value is changed to $z$.", "inputFormat": "The first line contains three integers $n,m,k$. The meaning of $k$ is that each number on a node and each $z$ in the queries are less than $2^k$.\n\nThen $n$ lines follow. Each line contains two integers $x,y$, representing the operation ID and the value of that node.\n\nThen $n-1$ lines follow. Each line contains two integers $x,y$, indicating that there is an edge between $x$ and $y$.\n\nThen $m$ lines follow. Each line contains four integers $Q,x,y,z$. Here $Q$ indicates the type of operation ($1$ for query, $2$ for modification), and $x,y,z$ have the meanings described above.", "outputFormat": "For each operation of type $1$, output the maximum value that can be obtained at the end.", "hint": "Idea: f321dd, Solution: f321dd & nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nFor $30\\%$ of the testdata, $n,m\\leq 1$.\n\nFor another $20\\%$ of the testdata, $k\\leq 5$.\n\nFor another $20\\%$ of the testdata, only one kind of bitwise operation appears.\n\nFor $100\\%$ of the testdata, $0\\leq n,m \\leq 10^5$, $0\\leq k\\leq 64$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2017] 由乃的 OJ", "background": "![](https://cdn.luogu.com.cn/upload/pic/58221.png)", "description": "由乃正在做她的OJ。现在她在处理OJ上的用户排名问题。\n\nOJ 上注册了 $n$ 个用户，编号为 $1\\sim n$，一开始他们按照编号排名。由乃会按照心情对这些用户做以下四种操作，修改用户的排名和编号：然而由乃心情非常不好，因为 Deus 天天问她题。。。\n \n因为 Deus 天天问由乃 OI 题，所以由乃去学习了一下 OI，由于由乃智商挺高，所以 OI 学的特别熟练。\n\n她在 RBOI2016 中以第一名的成绩进入省队，参加了 NOI2016 获得了金牌保送。\n\nDeus：这个题怎么做呀？  \nyuno：这个不是 NOI2014 的水题吗。。。  \nDeus：那如果出到树上，多组链询问，带修改呢？  \nyuno：诶。。。？？？  \nDeus：这题叫做睡觉困难综合征哟~  \n\n虽然由乃 OI 很好，但是她基本上不会 DS，线段树都只会口胡，比如她 NOI2016 的分数就是 $100+100+100+0+100+100$。。。NOIP2017 的分数是 $100+0+100+100+0+100$。\n\n所以她还是只能找你帮她做了。。。\n\n给你一个有 $n$ 个点的树，每个点的包括一个位运算 $opt$ 和一个权值 $x$，位运算有`&`，`|`，`^` 三种，分别用 $1,2,3$ 表示。\n\n每次询问包含三个整数 $x,y,z$，初始选定一个数 $v$。然后 $v$ 依次经过从 $x$ 到 $y$ 的所有节点，每经过一个点 $i$，$v$ 就变成 $v\\ opt_i\\ x_i$，所以他想问你，最后到 $y$ 时，希望得到的值尽可能大，求最大值。给定的初始值 $v$ 必须是在 $[0,z]$ 之间。\n\n每次修改包含三个整数 $x,y,z$，意思是把 $x$ 点的操作修改为 $y$，数值改为 $z$。", "inputFormat": "第一行三个整数 $n,m,k$。$k$ 的意义是每个点上的数，以及询问中的数值 $z$ 都小于 $2^k$。\n\n之后 $n$ 行，每行两个整数 $x,y$ 表示该点的位运算编号以及数值。\n\n之后 $n - 1$ 行，每行两个数 $x,y$ 表示 $x$ 和 $y$ 之间有边相连。\n\n之后 $m$ 行，每行四个数，$Q,x,y,z$ 表示这次操作为 $Q$（$1$ 为询问，$2$ 为修改），$x,y,z$ 意义如题所述。", "outputFormat": "对于每个操作 $1$，输出到最后可以得到的最大值。", "hint": "Idea：f321dd，Solution：f321dd&nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $30\\%$ 的数据，$n,m\\leq 1$。\n\n对于另外 $20\\%$ 的数据，$k\\leq 5$。\n\n对于另外 $20\\%$ 的数据，位运算只会出现一种。\n\n对于 $100\\%$ 的数据，$0\\leq n,m \\leq 10^5$，$0\\leq k\\leq 64$。\n", "locale": "zh-CN"}}}
{"pid": "P5355", "type": "P", "difficulty": 6, "samples": [["5 5\n1 1 2 3 4\n4 1 1 1\n1 1 2 2\n3 1 1 1\n3 5 5 16\n1 2 3 4", "yuno\nyumi\nyuno\nyuno\nyumi"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2017] 由乃的玉米田", "background": "![](https://cdn.luogu.com.cn/upload/pic/58222.png)", "description": "由乃在自己的农田边散步，她突然发现田里的一排玉米非常的不美。\n\n这排玉米一共有 $N$ 株，它们的高度参差不齐。\n\n由乃认为玉米田不美，所以她决定出个数据结构题\n \n这个题是这样的：\n\n给你一个序列 $a$，长度为 $n$，有 $m$ 次操作，每次询问一个区间是否可以选出两个数它们的差为 $x$，或者询问一个区间是否可以选出两个数它们的和为 $x$，或者询问一个区间是否可以选出两个数它们的乘积为 $x$ ，或者询问一个区间是否可以选出两个数它们的商为 $x$（没有余数） ，这四个操作分别为操作 $1,2,3,4$。\n\n选出的这两个数可以是同一个位置的数。", "inputFormat": "第一行两个数 $n,m$。\n\n后面一行 $n$ 个数表示 $a_i$。\n\n后面 $m$ 行每行四个数 $opt,l,r,x$。\n\n$opt$ 表示这个是第几种操作，$l,r$ 表示操作的区间，$x$ 表示这次操作的 $x$。", "outputFormat": "对于每个询问，如果可以，输出 `yuno`，否则输出 `yumi`。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477&mrsrz\n\n对于 $100\\%$ 的数据，所有输入的数在 $[0,10^5]$ 内，序列中的元素在 $[1,10^5]$ 内。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2017] Yuno's Cornfield", "background": "![](https://cdn.luogu.com.cn/upload/pic/58222.png)", "description": "Yuno is taking a walk by her farmland. She suddenly finds that a row of corn in the field looks very ugly.\n\nThere are a total of $N$ corn plants in this row, and their heights are uneven.\n\nYuno thinks the cornfield is not beautiful, so she decides to make a data structure problem.\n\nThe problem is as follows:\n\nYou are given a sequence $a$ of length $n$, with $m$ operations. Each operation queries whether, in a given interval, you can pick two numbers whose difference is $x$, or queries whether, in a given interval, you can pick two numbers whose sum is $x$, or queries whether, in a given interval, you can pick two numbers whose product is $x$, or queries whether, in a given interval, you can pick two numbers whose quotient is $x$ (with no remainder). These four operations are numbered $1,2,3,4$, respectively.\n\nThe two chosen numbers may come from the same position.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe next line contains $n$ integers representing $a_i$.\n\nThe next $m$ lines each contain four integers $opt,l,r,x$.\n\n$opt$ indicates which type of operation it is, $l,r$ specify the interval of the operation, and $x$ is the value $x$ for this operation.", "outputFormat": "For each query, if it is possible, output `yuno`; otherwise output `yumi`.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477&mrsrz.\n\nFor $100\\%$ of the testdata, all input numbers are within $[0,10^5]$, and the elements in the sequence are within $[1,10^5]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2017] 由乃的玉米田", "background": "![](https://cdn.luogu.com.cn/upload/pic/58222.png)", "description": "由乃在自己的农田边散步，她突然发现田里的一排玉米非常的不美。\n\n这排玉米一共有 $N$ 株，它们的高度参差不齐。\n\n由乃认为玉米田不美，所以她决定出个数据结构题\n \n这个题是这样的：\n\n给你一个序列 $a$，长度为 $n$，有 $m$ 次操作，每次询问一个区间是否可以选出两个数它们的差为 $x$，或者询问一个区间是否可以选出两个数它们的和为 $x$，或者询问一个区间是否可以选出两个数它们的乘积为 $x$ ，或者询问一个区间是否可以选出两个数它们的商为 $x$（没有余数） ，这四个操作分别为操作 $1,2,3,4$。\n\n选出的这两个数可以是同一个位置的数。", "inputFormat": "第一行两个数 $n,m$。\n\n后面一行 $n$ 个数表示 $a_i$。\n\n后面 $m$ 行每行四个数 $opt,l,r,x$。\n\n$opt$ 表示这个是第几种操作，$l,r$ 表示操作的区间，$x$ 表示这次操作的 $x$。", "outputFormat": "对于每个询问，如果可以，输出 `yuno`，否则输出 `yumi`。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477&mrsrz\n\n对于 $100\\%$ 的数据，所有输入的数在 $[0,10^5]$ 内，序列中的元素在 $[1,10^5]$ 内。", "locale": "zh-CN"}}}
{"pid": "P5356", "type": "P", "difficulty": 6, "samples": [["1 1\n1\n1 1 1 1", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "二分", "O2优化", "排序", "分块", "Ynoi"], "title": "[Ynoi Easy Round 2017] 由乃打扑克", "background": "![](https://cdn.luogu.com.cn/upload/pic/58223.png)", "description": "由乃不太会打扑克，\n\n所以她出了一个数据结构题。 \n\n给你一个长为 $n$ 的序列 $a$，需要支持 $m$ 次操作，操作有两种：\n\n1. 查询区间 $[l,r]$ 的第 $k$ 小值。\n2. 区间 $[l,r]$ 加上 $k$。", "inputFormat": "一行两个整数 $n,m$。\n\n接下来一行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。\n\n接下来 $m$ 行，每行四个整数 $opt,l,r,k$，其中 $opt$ 代表是哪种操作。", "outputFormat": "对于每个询问输出一个数表示答案，如果无解输出 $-1$。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477（$O(m\\sqrt{n}(\\Delta+\\log n))$）solution，ccz181078（$O(m\\sqrt{n\\log n})$）solution，\n\nCode：nzhtl1477（$O(m\\sqrt{n}(\\Delta+\\log n))$）code，ccz181078（$O(m\\sqrt{n\\log n})$）code，\n\nData：nzhtl1477。\n\n$1\\leq l\\leq r \\leq n\\leq 10^5$，$1 \\leq m \\leq 10^5$，$-2\\times 10^4\\leq a_i, k\\leq 2\\times 10^4$，$opt \\in \\{1, 2\\}$。\n\n---\n\n$\\text{upd 2022.8.18}$：新增加一组 Hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2017] Yuno Plays Poker", "background": "![](https://cdn.luogu.com.cn/upload/pic/58223.png)", "description": "Yuno is not very good at playing poker.\n\nSo she came up with a data structure problem.\n\nYou are given a sequence $a$ of length $n$. You need to support $m$ operations of two types:\n\n1. Query the $k$-th smallest value in the interval $[l, r]$.\n2. Add $k$ to every element in the interval $[l, r]$.", "inputFormat": "One line with two integers $n, m$.\n\nThe next line contains $n$ integers; the $i$-th integer represents $a_i$.\n\nThe next $m$ lines each contain four integers $opt, l, r, k$, where $opt$ indicates which type of operation it is.", "outputFormat": "For each query, output one number as the answer. If there is no solution, output $-1$.", "hint": "Idea: nzhtl1477.\n\nSolution: nzhtl1477 ($O(m\\sqrt{n}(\\Delta+\\log n))$) solution, ccz181078 ($O(m\\sqrt{n\\log n})$) solution.\n\nCode: nzhtl1477 ($O(m\\sqrt{n}(\\Delta+\\log n))$) code, ccz181078 ($O(m\\sqrt{n\\log n})$) code.\n\nData: nzhtl1477.\n\nConstraints: $1\\leq l\\leq r \\leq n\\leq 10^5$, $1 \\leq m \\leq 10^5$, $-2\\times 10^4\\leq a_i, k\\leq 2\\times 10^4$, $opt \\in \\{1, 2\\}$.\n\n---\n\n$\\text{upd 2022.8.18}$: A new set of hack testdata has been added.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2017] 由乃打扑克", "background": "![](https://cdn.luogu.com.cn/upload/pic/58223.png)", "description": "由乃不太会打扑克，\n\n所以她出了一个数据结构题。 \n\n给你一个长为 $n$ 的序列 $a$，需要支持 $m$ 次操作，操作有两种：\n\n1. 查询区间 $[l,r]$ 的第 $k$ 小值。\n2. 区间 $[l,r]$ 加上 $k$。", "inputFormat": "一行两个整数 $n,m$。\n\n接下来一行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。\n\n接下来 $m$ 行，每行四个整数 $opt,l,r,k$，其中 $opt$ 代表是哪种操作。", "outputFormat": "对于每个询问输出一个数表示答案，如果无解输出 $-1$。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477（$O(m\\sqrt{n}(\\Delta+\\log n))$）solution，ccz181078（$O(m\\sqrt{n\\log n})$）solution，\n\nCode：nzhtl1477（$O(m\\sqrt{n}(\\Delta+\\log n))$）code，ccz181078（$O(m\\sqrt{n\\log n})$）code，\n\nData：nzhtl1477。\n\n$1\\leq l\\leq r \\leq n\\leq 10^5$，$1 \\leq m \\leq 10^5$，$-2\\times 10^4\\leq a_i, k\\leq 2\\times 10^4$，$opt \\in \\{1, 2\\}$。\n\n---\n\n$\\text{upd 2022.8.18}$：新增加一组 Hack 数据。", "locale": "zh-CN"}}}
{"pid": "P5357", "type": "P", "difficulty": 5, "samples": [["5\na\nbb\naa\nabaa\nabaaa\nabaaabaa\n", "6\n0\n3\n2\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "AC 自动机", "模板题"], "title": "【模板】AC 自动机", "background": "本题原为“AC 自动机（二次加强版）”。完成本题前可以先完成 [AC 自动机（简单版）](https://www.luogu.com.cn/problem/P3808) 和 [AC 自动机（简单版 II）](https://www.luogu.com.cn/problem/P3796) 两道题，为 AC 自动机更简单的应用。", "description": "给你一个文本串 $S$ 和 $n$ 个模式串 $T_{1 \\sim n}$，请你分别求出每个模式串 $T_i$ 在 $S$ 中出现的次数。", "inputFormat": "第一行包含一个正整数 $n$ 表示模式串的个数。\n\n接下来 $n$ 行，第 $i$ 行包含一个由小写英文字母构成的非空字符串 $T_i$。\n\n最后一行包含一个由小写英文字母构成的非空字符串 $S$。\n\n**数据不保证任意两个模式串不相同**。", "outputFormat": "输出包含 $n$ 行，其中第 $i$ 行包含一个非负整数表示 $T_i$ 在 $S$ 中出现的次数。", "hint": "对于 $100 \\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$T_{1 \\sim n}$ 的长度总和不超过 $2 \\times {10}^5$，$S$ 的长度不超过 $2 \\times {10}^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Aho–Corasick Automaton.", "background": "This problem was originally called “Aho–Corasick Automaton (Second Enhanced Version)”. Before solving this problem, you may first solve [Aho–Corasick Automaton (Easy Version)](https://www.luogu.com.cn/problem/P3808) and [Aho–Corasick Automaton (Easy Version II)](https://www.luogu.com.cn/problem/P3796), which cover simpler applications of the Aho–Corasick automaton.", "description": "You are given a text string $S$ and $n$ pattern strings $T_{1 \\sim n}$. Please find, for each pattern string $T_i$, the number of times it appears in $S$.", "inputFormat": "The first line contains a positive integer $n$, representing the number of pattern strings.\n\nThe next $n$ lines each contain a non-empty string $T_i$ consisting of lowercase English letters, where the $i$-th line corresponds to $T_i$.\n\nThe last line contains a non-empty string $S$ consisting of lowercase English letters.\n\n**The testdata does not guarantee that any two pattern strings are different**.", "outputFormat": "Output $n$ lines. The $i$-th line contains a non-negative integer, representing the number of times $T_i$ appears in $S$.", "hint": "For $100\\%$ of the data, $1 \\le n \\le 2 \\times {10}^5$, the total length of $T_{1 \\sim n}$ is at most $2 \\times {10}^5$, and the length of $S$ is at most $2 \\times {10}^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】AC 自动机", "background": "本题原为“AC 自动机（二次加强版）”。完成本题前可以先完成 [AC 自动机（简单版）](https://www.luogu.com.cn/problem/P3808) 和 [AC 自动机（简单版 II）](https://www.luogu.com.cn/problem/P3796) 两道题，为 AC 自动机更简单的应用。", "description": "给你一个文本串 $S$ 和 $n$ 个模式串 $T_{1 \\sim n}$，请你分别求出每个模式串 $T_i$ 在 $S$ 中出现的次数。", "inputFormat": "第一行包含一个正整数 $n$ 表示模式串的个数。\n\n接下来 $n$ 行，第 $i$ 行包含一个由小写英文字母构成的非空字符串 $T_i$。\n\n最后一行包含一个由小写英文字母构成的非空字符串 $S$。\n\n**数据不保证任意两个模式串不相同**。", "outputFormat": "输出包含 $n$ 行，其中第 $i$ 行包含一个非负整数表示 $T_i$ 在 $S$ 中出现的次数。", "hint": "对于 $100 \\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$T_{1 \\sim n}$ 的长度总和不超过 $2 \\times {10}^5$，$S$ 的长度不超过 $2 \\times {10}^6$。", "locale": "zh-CN"}}}
{"pid": "P5358", "type": "P", "difficulty": 5, "samples": [["7\n28\n6\n4 -192321079\n3 418379342\n1 3 189801569\n3 -840249197\n4 -751917965\n3 649799919\n1 5 -92666141\n6\n4 451258008\n5 1\n4 696880327\n3 772574465\n6\n4 301010289\n3 480168068\n5 3\n5 2\n4 840536237\n5 5\n5 4\n1 7 -792284106\n2 604521872\n3 966540578\n2 -381646699\n3 -939378260\n2 -20129935\n6\n2\n0 1\n197 199", "2816930"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 快速查询", "background": "", "description": "给定一个长度为 $n$ 的整数数列，里面的元素依次编号为 $a_1,~a_2,~a_3,~\\dots,~a_n$。初始的时候，所有元素都为零。现在按照时间顺序提供了若干次关于这个数列的修改或询问，每一次修改或询问一定为以下六种情况之一：\n\n- **1 i val** ：将 $a_i$ 赋值为给定整数 $val$；\n\n- **2 val** ：将所有元素同时加上 $val$；\n\n- **3 val** ：将所有元素同时乘上 $val$；\n\n- **4 val** ：将所有元素同时赋值为 $val$；\n\n- **5 i** ：询问第 $i$ 个元素 $a_i$ 现在的值是多少；\n\n- **6** ：询问现在所有元素的和。", "inputFormat": "为了避免读入太大，输入文件采取如下的形式。\n\n第一行给定整数 $n$，表示给定数列长度为 $n$。\n 第二行给定整数 $q$，并且之后的 $q$ 行，每一行提供一个修改或询问，输入的格式与题目所述一致，请参见样例。\n 我们称上述给定的修改或询问为标准操作。\n 之后给定一个整数 $t$，并且之后的 $t$ 行每行给定两个正整数 $a_i$ 和 $b_i$，这里的下标 $i$ 依次记为 $1$ 到 $t$ 。\n\n你需要对初始值全为零的长度为 $n$ 的序列做总计 $t\\times q$ 次操作。\n 其中第 $\\Big((i-1)q+j\\Big)$ 次操作形如第 $\\Big((a_i + j b_i) \\mod{q} + 1\\Big)$ 个给定的标准操作（$1\\le i\\le t$ 且 $1\\le j\\le q$）。", "outputFormat": "输出一个整数，表示所有询问答案的累计和。\n\n因为答案可能很大，只要求输出其结果关于 $p=10^7+19$ 取模后的值。\n\n注意：若最终的累计和 ans 小于零，你应该输出 $\\big((ans \\mod{p})+p\\big)\\mod{p}$。", "hint": "子任务$1$：（$50$分）$1\\le  n\\le 500000$，$1\\le q\\le 10^5$ 且 $1\\le t\\le 5$，所有在输入中出现的$val$  满足$-10^9\\le val\\le 10^9$，所有$a_i$和$b_i$满足$0\\le a_i,b_i\\le 10^9$\n\n子任务$2$：（$50$分）$1\\le n\\le 10^9$，$1\\le q\\le 10^5$ 且 $1\\le~t~\\le~100$，所有在输入中出现的$val$ 满足$-10^9\\le val\\le  10^9$，所有$a_i$和$b_i$满足$0\\le a_i,b_i\\le 10^9$\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Fast Queries", "background": "", "description": "Given an integer sequence of length $n$, whose elements are numbered in order as $a_1,~a_2,~a_3,~\\dots,~a_n$. Initially, all elements are zero. Then, in chronological order, a number of modifications or queries on this sequence are given. Each modification or query must be one of the following six types:\n\n- **1 i val**: Assign $a_i$ the given integer $val$.\n\n- **2 val**: Add $val$ to all elements at the same time.\n\n- **3 val**: Multiply all elements by $val$ at the same time.\n\n- **4 val**: Assign all elements to $val$ at the same time.\n\n- **5 i**: Query the current value of the $i$-th element $a_i$.\n\n- **6**: Query the current sum of all elements.", "inputFormat": "To avoid overly large input, the input file uses the following format.\n\nThe first line contains an integer $n$, denoting the length of the sequence.\n\nThe second line contains an integer $q$, and then the next $q$ lines each give one modification or query. The input format is the same as described above; see the sample.\n\nWe call the above modifications or queries the standard operations.\n\nAfter that, an integer $t$ is given, and then the next $t$ lines each contain two positive integers $a_i$ and $b_i$, where the index $i$ runs from $1$ to $t$.\n\nYou need to perform a total of $t\\times q$ operations on the sequence of length $n$ that is initially all zeros.\n\nThe $\\Big((i-1)q+j\\Big)$-th operation is the $\\Big((a_i + j b_i) \\mod{q} + 1\\Big)$-th given standard operation ($1\\le i\\le t$ and $1\\le j\\le q$).", "outputFormat": "Output one integer, representing the total sum of all query answers.\n\nSince the answer may be very large, you only need to output the result modulo $p=10^7+19$.\n\nNote: If the final accumulated sum $\\mathrm{ans}$ is negative, you should output $\\big((ans \\mod{p})+p\\big)\\mod{p}$.", "hint": "Subtask $1$ ($50$ points): $1\\le n\\le 500000$, $1\\le q\\le 10^5$, and $1\\le t\\le 5$. All $val$ appearing in the input satisfy $-10^9\\le val\\le 10^9$. All $a_i$ and $b_i$ satisfy $0\\le a_i,b_i\\le 10^9$.\n\nSubtask $2$ ($50$ points): $1\\le n\\le 10^9$, $1\\le q\\le 10^5$, and $1\\le~t~\\le~100$. All $val$ appearing in the input satisfy $-10^9\\le val\\le 10^9$. All $a_i$ and $b_i$ satisfy $0\\le a_i,b_i\\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 快速查询", "background": "", "description": "给定一个长度为 $n$ 的整数数列，里面的元素依次编号为 $a_1,~a_2,~a_3,~\\dots,~a_n$。初始的时候，所有元素都为零。现在按照时间顺序提供了若干次关于这个数列的修改或询问，每一次修改或询问一定为以下六种情况之一：\n\n- **1 i val** ：将 $a_i$ 赋值为给定整数 $val$；\n\n- **2 val** ：将所有元素同时加上 $val$；\n\n- **3 val** ：将所有元素同时乘上 $val$；\n\n- **4 val** ：将所有元素同时赋值为 $val$；\n\n- **5 i** ：询问第 $i$ 个元素 $a_i$ 现在的值是多少；\n\n- **6** ：询问现在所有元素的和。", "inputFormat": "为了避免读入太大，输入文件采取如下的形式。\n\n第一行给定整数 $n$，表示给定数列长度为 $n$。\n 第二行给定整数 $q$，并且之后的 $q$ 行，每一行提供一个修改或询问，输入的格式与题目所述一致，请参见样例。\n 我们称上述给定的修改或询问为标准操作。\n 之后给定一个整数 $t$，并且之后的 $t$ 行每行给定两个正整数 $a_i$ 和 $b_i$，这里的下标 $i$ 依次记为 $1$ 到 $t$ 。\n\n你需要对初始值全为零的长度为 $n$ 的序列做总计 $t\\times q$ 次操作。\n 其中第 $\\Big((i-1)q+j\\Big)$ 次操作形如第 $\\Big((a_i + j b_i) \\mod{q} + 1\\Big)$ 个给定的标准操作（$1\\le i\\le t$ 且 $1\\le j\\le q$）。", "outputFormat": "输出一个整数，表示所有询问答案的累计和。\n\n因为答案可能很大，只要求输出其结果关于 $p=10^7+19$ 取模后的值。\n\n注意：若最终的累计和 ans 小于零，你应该输出 $\\big((ans \\mod{p})+p\\big)\\mod{p}$。", "hint": "子任务$1$：（$50$分）$1\\le  n\\le 500000$，$1\\le q\\le 10^5$ 且 $1\\le t\\le 5$，所有在输入中出现的$val$  满足$-10^9\\le val\\le 10^9$，所有$a_i$和$b_i$满足$0\\le a_i,b_i\\le 10^9$\n\n子任务$2$：（$50$分）$1\\le n\\le 10^9$，$1\\le q\\le 10^5$ 且 $1\\le~t~\\le~100$，所有在输入中出现的$val$ 满足$-10^9\\le val\\le  10^9$，所有$a_i$和$b_i$满足$0\\le a_i,b_i\\le 10^9$\n\n", "locale": "zh-CN"}}}
{"pid": "P5359", "type": "P", "difficulty": 7, "samples": [["3 5\n1 0 1\n0 0 0", "172"], ["5 7\n1 0 0 0 2\n0 0 3 0 0", "116370"], ["10 13\n0 2 0 0 1 0 2 0 0 3\n0 1 0 1 0 0 0 0 4 0", "770175525"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2019", "线段树", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 染色", "background": "", "description": "给定 $2 \\times n$ 的格点图。其中一些结点有着已知的颜色，其余的结点还没有被染色。\n\n 一个合法的染色方案不允许相邻结点有相同的染色。\n\n现在一共有 $c$ 种不同的颜色，依次记为 $1$ 到 $c$。\n\n 请问有多少对未染色结点的合法染色方案？", "inputFormat": "第一行有两个整数$n$和$c$，分别描述了格点图的大小和总的颜色个数。\n\n之后两行，每行有$n$个整数：如果是 $0$ 则表示对应结点未被染色，否则一定是一个$1$到$c$的整数表示对应结点已经染了某一种颜色。", "outputFormat": "输出一个整数，为总的染色方案数对$10^9+9$取模后的值。", "hint": "子任务$1$：（$44$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；不存在一列有$2$个已染色结点；被染色结点全部位于第一行；第一列和最后一列均有结点已被染色。\n\n子任务$2$：（$32$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；不存在一列有$2$个已染色结点；第一列和最后一列均有结点已被染色。\n\n子任务$3$：（$12$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；第一列和最后一列均有结点已被染色。\n\n子任务$4$：（$8$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$。\n\n子任务$5$：（$4$分）$1\\le n\\le 100000$ 且 $5\\le c\\le 100000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Coloring", "background": "", "description": "Given a $2 \\times n$ grid graph. Some vertices already have known colors, and the remaining vertices are not colored yet.\n\nA valid coloring does not allow adjacent vertices to have the same color.\n\nThere are $c$ different colors in total, numbered from $1$ to $c$.\n\nHow many valid colorings are there for the uncolored vertices?", "inputFormat": "The first line contains two integers $n$ and $c$, describing the size of the grid graph and the total number of colors.\n\nThen there are two lines, each containing $n$ integers: if it is $0$, it means the corresponding vertex is uncolored; otherwise, it must be an integer from $1$ to $c$, meaning the vertex has already been colored with a certain color.", "outputFormat": "Output one integer: the total number of valid colorings modulo $10^9+9$.", "hint": "Subtask $1$ ($44$ points): $1 \\le n \\le 10000$ and $5 \\le c \\le 10000$; there is no column with $2$ colored vertices; all colored vertices are in the first row; both the first column and the last column have a colored vertex.\n\nSubtask $2$ ($32$ points): $1 \\le n \\le 10000$ and $5 \\le c \\le 10000$; there is no column with $2$ colored vertices; both the first column and the last column have a colored vertex.\n\nSubtask $3$ ($12$ points): $1 \\le n \\le 10000$ and $5 \\le c \\le 10000$; both the first column and the last column have a colored vertex.\n\nSubtask $4$ ($8$ points): $1 \\le n \\le 10000$ and $5 \\le c \\le 10000$.\n\nSubtask $5$ ($4$ points): $1 \\le n \\le 100000$ and $5 \\le c \\le 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 染色", "background": "", "description": "给定 $2 \\times n$ 的格点图。其中一些结点有着已知的颜色，其余的结点还没有被染色。\n\n 一个合法的染色方案不允许相邻结点有相同的染色。\n\n现在一共有 $c$ 种不同的颜色，依次记为 $1$ 到 $c$。\n\n 请问有多少对未染色结点的合法染色方案？", "inputFormat": "第一行有两个整数$n$和$c$，分别描述了格点图的大小和总的颜色个数。\n\n之后两行，每行有$n$个整数：如果是 $0$ 则表示对应结点未被染色，否则一定是一个$1$到$c$的整数表示对应结点已经染了某一种颜色。", "outputFormat": "输出一个整数，为总的染色方案数对$10^9+9$取模后的值。", "hint": "子任务$1$：（$44$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；不存在一列有$2$个已染色结点；被染色结点全部位于第一行；第一列和最后一列均有结点已被染色。\n\n子任务$2$：（$32$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；不存在一列有$2$个已染色结点；第一列和最后一列均有结点已被染色。\n\n子任务$3$：（$12$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；第一列和最后一列均有结点已被染色。\n\n子任务$4$：（$8$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$。\n\n子任务$5$：（$4$分）$1\\le n\\le 100000$ 且 $5\\le c\\le 100000$。", "locale": "zh-CN"}}}
{"pid": "P5360", "type": "P", "difficulty": 7, "samples": [["2 4 1 2 3 5\n3\n2 2\n2 3\n3 3", "9\n5\n13"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 世界地图", "background": "", "description": "在遥远的艾莉芬特星球上，有着繁荣的艾莉芬特文明。和地球人一样，艾莉芬特人使用经纬度来标记星球上的每个位置。他们把艾莉芬特星球从北到南划分为$n$个纬度，从西到东划分为$m$个经度。在每条经线和纬线相交的地方都有一个国家，他们用$(i,j)$来表示纬度为$i$，经度为$j$的国家，显然一共有$n\\times  m$个国家。\n\n艾莉芬特人在任意两个经度或者纬度相邻的国家之间都修建了一条双向道路。\n\n考虑经度相邻的情况：对于任意一个国家$(i,j)(1\\leq i\\leq n,1\\leq j\\leq m)$，它和国家$(i,j+1)$之间都有一条道路，特别地当$j=m$时，$(i,m)$和$(i,1)$之间也有一条道路。\n\n考虑纬度相邻的情况：对于任意一个国家$(i,j)(1\\leq i<n,1\\leq j\\leq m)$，它和国家$(i+1,j)$之间都有一条道路。注意：南北极并不相邻。\n\n艾莉芬特星球并不和平，部分国家卷入了世界大战之中。在接下来$q$个世纪的第$i$个世纪里，经度在$[l_i,r_i]$之间的所有国家都卷入了该世纪发生的世界大战中。当世界大战发生时，被卷入战争的国家都很危险。如果一个国家未被卷入战争，那么它就是一个和平的国家；如果一条道路两端点都是和平的国家，那么它就是一条和平的道路。处于安全考虑，艾莉芬特联合政府会选择只开放一些和平的道路，使得任意两个和平的国家在战争期间都能仅通过这些开放的和平的道路直接或间接连通。\n\n对于任意一条道路，将它保留下来所需的安保代价都不尽相同。请写一个程序，帮助联合政府找到安保代价之和最少的方案。\n\n注意：一个世纪结束后，该世纪的世界大战将会结束，下一场战争的参战国与当前战争的参战国之间没有任何联系。", "inputFormat": "第一行包含 $6$ 个正整数 $n,m,SA,SB,SC,lim$，其中$n$表示纬度的范围，$m$ 表示经度的范围。\n\n为了减少输入量，每条道路的安保代价将由以下代码生成，其中 $\\texttt{addedge(a,b,c,d,w)}$ 表示$(a,b)$和$(c,d)$之间道路的安保代价为$w$：\n\n```cpp\nunsigned int SA, SB, SC;int lim;\nint getweight() {\n    SA ^= SA << 16;\n    SA ^= SA >> 5;\n    SA ^= SA << 1;\n    unsigned int t = SA;\n    SA = SB;\n    SB = SC;\n    SC^ = t ^ SA;\n    return SC % lim + 1;\n}\nvoid gen() {\n    scanf(\"%d%d%u%u%u%d\", &n, &m, &SA, &SB, &SC, &lim);\n    int i, j, w;\n    for(i = 1; i <= n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            if (j < m) {\n                addedge(i, j, i, j + 1, w);\n            } else {\n                addedge(i, j, i, 1, w);\n            }\n        }\n    for(i = 1; i < n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            addedge(i, j, i + 1, j, w);\n        }\n}\n```\n\n第二行包含一个正整数$q$，表示询问次数。\n\n接下来 $q$ 行，每行 $2$ 个正整数 $l_i,r_i$，依次表示每个询问。", "outputFormat": "输出 $q$ 行，每行一个整数，依次回答每个询问，即安保代价之和。", "hint": "## 样例解释：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/58230.png )\n\n## 数据范围：\n\n对于$100\\%$的数据，$1<l_i\\leq r_i<m,1\\leq SA,SB,SC\\leq 10^9$。\n\n子任务 $1$:（$10$ 分）$n=m=lim=q=50$；\n\n子任务 $2$:（$20$ 分）$n=100,m=10000,lim=5,q=10000$；\n\n子任务 $3$:（$10$ 分）$n=1,m=10000,lim=10^9,q=300000$；\n\n子任务 $4$:（$20$ 分）$n=2,m=10000,lim=10^9,q=300000$；\n\n子任务 $4$:（$40$ 分）$n=100,m=10000,lim=10^9,q=10000$；", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] World Map", "background": "", "description": "On the distant planet Elephant, there is a prosperous Elephant civilization. Like humans on Earth, Elephants use latitude and longitude to mark every location on the planet. They divide the planet from north to south into $n$ latitudes, and from west to east into $m$ longitudes. At every intersection of a meridian and a parallel there is a country. They use $(i,j)$ to denote the country at latitude $i$ and longitude $j$. Clearly, there are $n \\times m$ countries in total.\n\nElephants build a bidirectional road between any two countries that are adjacent in longitude or latitude.\n\nConsider longitude adjacency: for any country $(i,j)$ $(1 \\leq i \\leq n, 1 \\leq j \\leq m)$, there is a road between it and country $(i,j+1)$. In particular, when $j=m$, there is also a road between $(i,m)$ and $(i,1)$.\n\nConsider latitude adjacency: for any country $(i,j)$ $(1 \\leq i < n, 1 \\leq j \\leq m)$, there is a road between it and country $(i+1,j)$. Note that the North Pole and the South Pole are not adjacent.\n\nThe Elephant planet is not peaceful, and some countries are involved in a world war. In the $i$-th century among the next $q$ centuries, all countries whose longitudes are in $[l_i, r_i]$ are involved in the world war of that century. When a world war happens, countries involved in the war are dangerous. If a country is not involved in the war, then it is a peaceful country. If both endpoints of a road are peaceful countries, then it is a peaceful road. For safety reasons, the Elephant United Government will choose to open only some peaceful roads, so that during the war, any two peaceful countries can be connected directly or indirectly using only these opened peaceful roads.\n\nFor any road, the security cost required to keep it is different. Please write a program to help the united government find a plan with the minimum total security cost.\n\nNote that after a century ends, the world war of that century will end. The participants of the next war have no relation to those of the current war.", "inputFormat": "The first line contains $6$ positive integers $n, m, SA, SB, SC, lim$, where $n$ is the range of latitudes and $m$ is the range of longitudes.\n\nTo reduce the input size, the security cost of each road is generated by the following code, where $\\texttt{addedge(a,b,c,d,w)}$ means that the security cost of the road between $(a,b)$ and $(c,d)$ is $w$:\n\n```cpp\nunsigned int SA, SB, SC;int lim;\nint getweight() {\n    SA ^= SA << 16;\n    SA ^= SA >> 5;\n    SA ^= SA << 1;\n    unsigned int t = SA;\n    SA = SB;\n    SB = SC;\n    SC^ = t ^ SA;\n    return SC % lim + 1;\n}\nvoid gen() {\n    scanf(\"%d%d%u%u%u%d\", &n, &m, &SA, &SB, &SC, &lim);\n    int i, j, w;\n    for(i = 1; i <= n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            if (j < m) {\n                addedge(i, j, i, j + 1, w);\n            } else {\n                addedge(i, j, i, 1, w);\n            }\n        }\n    for(i = 1; i < n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            addedge(i, j, i + 1, j, w);\n        }\n}\n```\n\nThe second line contains a positive integer $q$, indicating the number of queries.\n\nIn the next $q$ lines, each line contains $2$ positive integers $l_i, r_i$, describing each query in order.", "outputFormat": "Output $q$ lines. Each line contains one integer, answering the corresponding query, i.e. the total security cost.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 世界地图", "background": "", "description": "在遥远的艾莉芬特星球上，有着繁荣的艾莉芬特文明。和地球人一样，艾莉芬特人使用经纬度来标记星球上的每个位置。他们把艾莉芬特星球从北到南划分为$n$个纬度，从西到东划分为$m$个经度。在每条经线和纬线相交的地方都有一个国家，他们用$(i,j)$来表示纬度为$i$，经度为$j$的国家，显然一共有$n\\times  m$个国家。\n\n艾莉芬特人在任意两个经度或者纬度相邻的国家之间都修建了一条双向道路。\n\n考虑经度相邻的情况：对于任意一个国家$(i,j)(1\\leq i\\leq n,1\\leq j\\leq m)$，它和国家$(i,j+1)$之间都有一条道路，特别地当$j=m$时，$(i,m)$和$(i,1)$之间也有一条道路。\n\n考虑纬度相邻的情况：对于任意一个国家$(i,j)(1\\leq i<n,1\\leq j\\leq m)$，它和国家$(i+1,j)$之间都有一条道路。注意：南北极并不相邻。\n\n艾莉芬特星球并不和平，部分国家卷入了世界大战之中。在接下来$q$个世纪的第$i$个世纪里，经度在$[l_i,r_i]$之间的所有国家都卷入了该世纪发生的世界大战中。当世界大战发生时，被卷入战争的国家都很危险。如果一个国家未被卷入战争，那么它就是一个和平的国家；如果一条道路两端点都是和平的国家，那么它就是一条和平的道路。处于安全考虑，艾莉芬特联合政府会选择只开放一些和平的道路，使得任意两个和平的国家在战争期间都能仅通过这些开放的和平的道路直接或间接连通。\n\n对于任意一条道路，将它保留下来所需的安保代价都不尽相同。请写一个程序，帮助联合政府找到安保代价之和最少的方案。\n\n注意：一个世纪结束后，该世纪的世界大战将会结束，下一场战争的参战国与当前战争的参战国之间没有任何联系。", "inputFormat": "第一行包含 $6$ 个正整数 $n,m,SA,SB,SC,lim$，其中$n$表示纬度的范围，$m$ 表示经度的范围。\n\n为了减少输入量，每条道路的安保代价将由以下代码生成，其中 $\\texttt{addedge(a,b,c,d,w)}$ 表示$(a,b)$和$(c,d)$之间道路的安保代价为$w$：\n\n```cpp\nunsigned int SA, SB, SC;int lim;\nint getweight() {\n    SA ^= SA << 16;\n    SA ^= SA >> 5;\n    SA ^= SA << 1;\n    unsigned int t = SA;\n    SA = SB;\n    SB = SC;\n    SC^ = t ^ SA;\n    return SC % lim + 1;\n}\nvoid gen() {\n    scanf(\"%d%d%u%u%u%d\", &n, &m, &SA, &SB, &SC, &lim);\n    int i, j, w;\n    for(i = 1; i <= n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            if (j < m) {\n                addedge(i, j, i, j + 1, w);\n            } else {\n                addedge(i, j, i, 1, w);\n            }\n        }\n    for(i = 1; i < n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            addedge(i, j, i + 1, j, w);\n        }\n}\n```\n\n第二行包含一个正整数$q$，表示询问次数。\n\n接下来 $q$ 行，每行 $2$ 个正整数 $l_i,r_i$，依次表示每个询问。", "outputFormat": "输出 $q$ 行，每行一个整数，依次回答每个询问，即安保代价之和。", "hint": "## 样例解释：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/58230.png )\n\n## 数据范围：\n\n对于$100\\%$的数据，$1<l_i\\leq r_i<m,1\\leq SA,SB,SC\\leq 10^9$。\n\n子任务 $1$:（$10$ 分）$n=m=lim=q=50$；\n\n子任务 $2$:（$20$ 分）$n=100,m=10000,lim=5,q=10000$；\n\n子任务 $3$:（$10$ 分）$n=1,m=10000,lim=10^9,q=300000$；\n\n子任务 $4$:（$20$ 分）$n=2,m=10000,lim=10^9,q=300000$；\n\n子任务 $4$:（$40$ 分）$n=100,m=10000,lim=10^9,q=10000$；", "locale": "zh-CN"}}}
{"pid": "P5361", "type": "P", "difficulty": 6, "samples": [["2\n6 15\n1 2\n1 3\n1 4\n1 5\n1 6\n2 3\n2 4\n2 5\n2 6\n3 4\n3 5\n3 6\n4 5\n4 6\n5 6\n8 11\n1 2\n2 3\n1 4\n3 7\n4 5\n5 2\n2 6\n6 7\n5 6\n5 8\n6 8", "6 1 2 3 4 5 6\n1 4\n8 1 2 3 4 5 6 7 8\n4 8 4 7 2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "各省省选", "山东", "Special Judge", "O2优化"], "title": "[SDOI2019] 热闹的聚会与尴尬的聚会", "background": "小 Q 的生日快到了，他决定周末邀请一些朋友到他的新房子一起聚会！", "description": "他的联系薄上有 $n$ 位好友，他们两两之间或者互相认识，或者互相不认识。小 Q 希望在周六办一个热闹的聚会，再在周日办一个尴尬的聚会。\n\n- 一场热闹度为 $p$ 的聚会请来了任意多位好友，对于每一位到场的好友来说都有至少 $p$ 位他认识的好友也参加了聚会，且至少对于一位到场的好友来说现场恰好有 $p$ 位他认识的好友；\n- 一场尴尬度为 $q$ 的聚会请来了恰好 $q$ 位好友，且他们两两互不认识。\n\n两场聚会可能有重复的参与者，联系薄上也有可能有某些好友同时缺席了两场聚会。\n\n小 Q 喜欢周六聚会的热闹度 $p$ 与周日聚会的尴尬度 $q$ 之间满足：$\\left\\lfloor \\frac{n}{p+1} \\right\\rfloor\\! \\le q$ 且 $\\left\\lfloor \\frac{n}{q+1} \\right\\rfloor\\! \\le p$。\n\n请帮助小 Q 找出一个可行的邀请方案。", "inputFormat": "**输入含有多组测试数据**，并在第一行给定一个整数 $T$，表示总共有多少组测试数据。之后依次给出每一组数据。\n\n每一组测试数据第一行给定两个整数 $n$ 和 $m$，依次表示联系薄中好友的总数，以及有多少对互相认识的好友。\n\n之后 $m$ 行每行给定两个正整数 $u$ 和 $v$，满足 $1\\le u\\neq v\\le n$ ，表示第 $u$ 个好友与第 $v$ 个好友互相认识。", "outputFormat": "对于每一组数据输出两行，依次描述周六热闹的聚会的参加人员，与周日尴尬的聚会的参加人员列表：\n\n第一行先输出一个正整数表示总共邀请来了多少位好友参加周六的聚会，再之后输出若干个不同的整数，按照任意顺序描述被邀请的是哪些好友。\n\n第二行先输出一个正整数表示总共邀请来了多少位好友参加周日的聚会，再之后以任意顺序输出若干个不同的整数，同样描述了周日被邀请的好友。\n\n如果有多组方案，你可以输出其中任何一组。", "hint": "#### 数据规模与约定\n\n- 子任务 $1$（$10$ 分）：$1\\le n\\le 500$；  \n- 子任务 $2$（$10$ 分）：$1\\le n\\le 700$；  \n- 子任务 $3$（$10$ 分）：$1\\le n\\le 900$；  \n- 子任务 $4$（$10$ 分）：$1\\le n\\le 1.1 \\times {10}^3$；  \n- 子任务 $5$（$10$ 分）：$1\\le n\\le 2 \\times {10}^3$；  \n- 子任务 $6$（$10$ 分）：$1\\le n\\le 3 \\times {10}^3$；  \n- 子任务 $7$（$10$ 分）：$1\\le n\\le 4.5 \\times {10}^3$；  \n- 子任务 $8$（$10$ 分）：$1\\le n\\le 6 \\times {10}^3$；  \n- 子任务 $9$（$10$ 分）：$1\\le n\\le 8 \\times {10}^3$；  \n- 子任务 $10$（$10$ 分）：$1\\le n\\le {10}^4$。\n\n对于全部的测试点，满足 $1\\le T\\le 32$ 且 $1\\le m\\le 10^5$。\n\n---\n\n#### 提示\n\n本题读入量很大，请注意自己代码在读入上的所需时间。\n\n---\n#### 说明\n\n感谢 @[81179332\\_](/user/53994) 提供 spj！", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Lively Party and Awkward Party", "background": "Xiao Q’s birthday is coming soon, and he decides to invite some friends to his new house for a party on the weekend.", "description": "There are $n$ friends in his contact list. Any two friends either know each other or do not know each other. Xiao Q wants to hold a lively party on Saturday, and then an awkward party on Sunday.\n\n- A party with liveliness $p$ invites any number of friends. For every friend who attends, there are at least $p$ friends that he knows also attending the party, and for at least one attending friend, there are exactly $p$ friends that he knows at the party.\n- A party with awkwardness $q$ invites exactly $q$ friends, and they are pairwise not acquainted with each other.\n\nThe two parties may have overlapping participants, and it is also possible that some friends in the contact list miss both parties.\n\nXiao Q likes the liveliness $p$ of Saturday’s party and the awkwardness $q$ of Sunday’s party to satisfy: $\\left\\lfloor \\frac{n}{p+1} \\right\\rfloor\\! \\le q$ and $\\left\\lfloor \\frac{n}{q+1} \\right\\rfloor\\! \\le p$.\n\nPlease help Xiao Q find a feasible invitation plan.", "inputFormat": "**The input contains multiple test cases.** The first line gives an integer $T$, which denotes the number of test cases. Then each test case follows.\n\nFor each test case, the first line gives two integers $n$ and $m$, which denote the total number of friends in the contact list, and the number of pairs of friends who know each other.\n\nThen $m$ lines follow. Each line gives two positive integers $u$ and $v$, satisfying $1\\le u\\neq v\\le n$, meaning that friend $u$ and friend $v$ know each other.", "outputFormat": "For each test case, output two lines, describing the participant list of Saturday’s lively party and Sunday’s awkward party, respectively.\n\nThe first line first outputs a positive integer, indicating how many friends are invited to the Saturday party, and then outputs several distinct integers in any order, describing which friends are invited.\n\nThe second line first outputs a positive integer, indicating how many friends are invited to the Sunday party, and then outputs several distinct integers in any order, also describing which friends are invited on Sunday.\n\nIf there are multiple valid solutions, you may output any one of them.", "hint": "#### Constraints\n\n- Subtask $1$ ($10$ points): $1\\le n\\le 500$.  \n- Subtask $2$ ($10$ points): $1\\le n\\le 700$.  \n- Subtask $3$ ($10$ points): $1\\le n\\le 900$.  \n- Subtask $4$ ($10$ points): $1\\le n\\le 1.1 \\times {10}^3$.  \n- Subtask $5$ ($10$ points): $1\\le n\\le 2 \\times {10}^3$.  \n- Subtask $6$ ($10$ points): $1\\le n\\le 3 \\times {10}^3$.  \n- Subtask $7$ ($10$ points): $1\\le n\\le 4.5 \\times {10}^3$.  \n- Subtask $8$ ($10$ points): $1\\le n\\le 6 \\times {10}^3$.  \n- Subtask $9$ ($10$ points): $1\\le n\\le 8 \\times {10}^3$.  \n- Subtask $10$ ($10$ points): $1\\le n\\le {10}^4$.\n\nFor all test points, it holds that $1\\le T\\le 32$ and $1\\le m\\le 10^5$.\n\n---\n\n#### Notes\n\nThe input size of this problem is very large. Please pay attention to the time needed for input in your code.\n\n---\n\n#### Explanation\n\nThanks to @[81179332\\_](/user/53994) for providing the spj!\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 热闹的聚会与尴尬的聚会", "background": "小 Q 的生日快到了，他决定周末邀请一些朋友到他的新房子一起聚会！", "description": "他的联系薄上有 $n$ 位好友，他们两两之间或者互相认识，或者互相不认识。小 Q 希望在周六办一个热闹的聚会，再在周日办一个尴尬的聚会。\n\n- 一场热闹度为 $p$ 的聚会请来了任意多位好友，对于每一位到场的好友来说都有至少 $p$ 位他认识的好友也参加了聚会，且至少对于一位到场的好友来说现场恰好有 $p$ 位他认识的好友；\n- 一场尴尬度为 $q$ 的聚会请来了恰好 $q$ 位好友，且他们两两互不认识。\n\n两场聚会可能有重复的参与者，联系薄上也有可能有某些好友同时缺席了两场聚会。\n\n小 Q 喜欢周六聚会的热闹度 $p$ 与周日聚会的尴尬度 $q$ 之间满足：$\\left\\lfloor \\frac{n}{p+1} \\right\\rfloor\\! \\le q$ 且 $\\left\\lfloor \\frac{n}{q+1} \\right\\rfloor\\! \\le p$。\n\n请帮助小 Q 找出一个可行的邀请方案。", "inputFormat": "**输入含有多组测试数据**，并在第一行给定一个整数 $T$，表示总共有多少组测试数据。之后依次给出每一组数据。\n\n每一组测试数据第一行给定两个整数 $n$ 和 $m$，依次表示联系薄中好友的总数，以及有多少对互相认识的好友。\n\n之后 $m$ 行每行给定两个正整数 $u$ 和 $v$，满足 $1\\le u\\neq v\\le n$ ，表示第 $u$ 个好友与第 $v$ 个好友互相认识。", "outputFormat": "对于每一组数据输出两行，依次描述周六热闹的聚会的参加人员，与周日尴尬的聚会的参加人员列表：\n\n第一行先输出一个正整数表示总共邀请来了多少位好友参加周六的聚会，再之后输出若干个不同的整数，按照任意顺序描述被邀请的是哪些好友。\n\n第二行先输出一个正整数表示总共邀请来了多少位好友参加周日的聚会，再之后以任意顺序输出若干个不同的整数，同样描述了周日被邀请的好友。\n\n如果有多组方案，你可以输出其中任何一组。", "hint": "#### 数据规模与约定\n\n- 子任务 $1$（$10$ 分）：$1\\le n\\le 500$；  \n- 子任务 $2$（$10$ 分）：$1\\le n\\le 700$；  \n- 子任务 $3$（$10$ 分）：$1\\le n\\le 900$；  \n- 子任务 $4$（$10$ 分）：$1\\le n\\le 1.1 \\times {10}^3$；  \n- 子任务 $5$（$10$ 分）：$1\\le n\\le 2 \\times {10}^3$；  \n- 子任务 $6$（$10$ 分）：$1\\le n\\le 3 \\times {10}^3$；  \n- 子任务 $7$（$10$ 分）：$1\\le n\\le 4.5 \\times {10}^3$；  \n- 子任务 $8$（$10$ 分）：$1\\le n\\le 6 \\times {10}^3$；  \n- 子任务 $9$（$10$ 分）：$1\\le n\\le 8 \\times {10}^3$；  \n- 子任务 $10$（$10$ 分）：$1\\le n\\le {10}^4$。\n\n对于全部的测试点，满足 $1\\le T\\le 32$ 且 $1\\le m\\le 10^5$。\n\n---\n\n#### 提示\n\n本题读入量很大，请注意自己代码在读入上的所需时间。\n\n---\n#### 说明\n\n感谢 @[81179332\\_](/user/53994) 提供 spj！", "locale": "zh-CN"}}}
{"pid": "P5362", "type": "P", "difficulty": 7, "samples": [["5\n1001 3\n11001 10\n00111 10\n0011 20\n0 100", "3\n4\n0\n6\n164"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 连续子序列", "background": null, "description": "我们定义 $\\textbf{T. M.}$ 序列 $\\{T_n\\}$ 为如下形式得布尔序列：\n\n- $T_0=0$；\n- $T_{2n}=T_n$;\n- $T_{2n+1}=1-T_n$。\n\n这里我们给出 $\\textbf{T. M.}$ 序列得前若干项：$01101001100101101001011001101001\\cdots$。\n\n$\\textbf{T. M.}$ 序列是一个无限长度的序列，它有很多连续子序列。\n 例如 $0$，$1$，$10100$，$10011$ 和 $011001$ 都是它的连续子序列，然而 $111$ 和 $1000$ 却不是它的连续子序列。\n\n现在给定一个布尔序列（01 字符串）$S$ 和一个非负整数 $k$，请统计一下一共有多少种 $\\textbf{T. M.}$ 序列的连续子序列 $T$ 满足：\n\n- $S$ 是 $T$ 的前缀；\n\n- $T$ 是由 $S$ 额外在右侧添加了恰好 $k$ 项形成的。", "inputFormat": "第一行给定一个整数 $T$，表示输入一共含有 $T$ 组数据。\n\n之后 $T$ 行，每一行给定一个 01 字符串 $S$（表示一个布尔序列）和一个非负正整数 $k$，为给定的一组数据。", "outputFormat": "对于每一组数据，输出一行并含有一个整数，表示满足条件的连续子序列个数。因为数值可能很大，请输出关于 $10^9+9$ 取模后的值。", "hint": "子任务 $1$：（$20$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 100$。\n\n子任务 $2$：（$20$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 50000$。\n\n子任务 $3$：（$60$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 10^{18}$", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Consecutive Subsequences", "background": "", "description": "We define the $\\textbf{T. M.}$ sequence $\\{T_n\\}$ as a Boolean sequence of the following form:\n\n- $T_0=0$.\n- $T_{2n}=T_n$.\n- $T_{2n+1}=1-T_n$.\n\nHere are the first several terms of the $\\textbf{T. M.}$ sequence: $01101001100101101001011001101001\\cdots$.\n\nThe $\\textbf{T. M.}$ sequence is an infinite sequence, and it has many consecutive subsequences.  \nFor example, $0$, $1$, $10100$, $10011$, and $011001$ are all consecutive subsequences of it, while $111$ and $1000$ are not.\n\nNow you are given a Boolean sequence (a 01 string) $S$ and a non-negative integer $k$. Please count how many different consecutive subsequences $T$ of the $\\textbf{T. M.}$ sequence satisfy:\n\n- $S$ is a prefix of $T$.\n- $T$ is formed by appending exactly $k$ more terms to the right of $S$.", "inputFormat": "The first line contains an integer $T$, indicating that there are $T$ test cases.\n\nThen follow $T$ lines. Each line contains a 01 string $S$ (representing a Boolean sequence) and a non-negative integer $k$, describing one test case.", "outputFormat": "For each test case, output one line containing an integer, indicating the number of consecutive subsequences that satisfy the conditions. Since the value may be very large, output it modulo $10^9+9$.", "hint": "Subtask $1$ ($20$ points): $1\\le T\\le 100$, the length of the given Boolean sequence is at most $100$, and $0\\le k\\le 100$.\n\nSubtask $2$ ($20$ points): $1\\le T\\le 100$, the length of the given Boolean sequence is at most $100$, and $0\\le k\\le 50000$.\n\nSubtask $3$ ($60$ points): $1\\le T\\le 100$, the length of the given Boolean sequence is at most $100$, and $0\\le k\\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 连续子序列", "background": null, "description": "我们定义 $\\textbf{T. M.}$ 序列 $\\{T_n\\}$ 为如下形式得布尔序列：\n\n- $T_0=0$；\n- $T_{2n}=T_n$;\n- $T_{2n+1}=1-T_n$。\n\n这里我们给出 $\\textbf{T. M.}$ 序列得前若干项：$01101001100101101001011001101001\\cdots$。\n\n$\\textbf{T. M.}$ 序列是一个无限长度的序列，它有很多连续子序列。\n 例如 $0$，$1$，$10100$，$10011$ 和 $011001$ 都是它的连续子序列，然而 $111$ 和 $1000$ 却不是它的连续子序列。\n\n现在给定一个布尔序列（01 字符串）$S$ 和一个非负整数 $k$，请统计一下一共有多少种 $\\textbf{T. M.}$ 序列的连续子序列 $T$ 满足：\n\n- $S$ 是 $T$ 的前缀；\n\n- $T$ 是由 $S$ 额外在右侧添加了恰好 $k$ 项形成的。", "inputFormat": "第一行给定一个整数 $T$，表示输入一共含有 $T$ 组数据。\n\n之后 $T$ 行，每一行给定一个 01 字符串 $S$（表示一个布尔序列）和一个非负正整数 $k$，为给定的一组数据。", "outputFormat": "对于每一组数据，输出一行并含有一个整数，表示满足条件的连续子序列个数。因为数值可能很大，请输出关于 $10^9+9$ 取模后的值。", "hint": "子任务 $1$：（$20$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 100$。\n\n子任务 $2$：（$20$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 50000$。\n\n子任务 $3$：（$60$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 10^{18}$", "locale": "zh-CN"}}}
{"pid": "P5363", "type": "P", "difficulty": 6, "samples": [["10 3", "100"], ["199 43", "981535230"], ["99999 47", "39178973"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 移动金币", "background": "", "description": "Alice和Bob将要进行如下的一场游戏。二人轮流操作，且Alice先行。\n当轮到一个玩家的时候，他可以选择一枚金币，并将其向左移动任意多格，且至少移动一格。\n金币不能被移出棋盘，也不能越过其它金币。\n\n一个 $1\\times n$ 的棋盘上最初摆放有 $m$ 枚金币。其中每一枚金币占据了一个独立的格子，任意一个格子内最多只有一枚金币。\n\n如果轮到一个玩家的时候他已经无法做出任何有效操作了（显然这个时候$m$枚金币恰好落在最左侧的$m$个格子中），则被判定为输家。已经知道Alice和Bob都是极致聪明的人，他们在任何局面下总能做出最优的操作。那么有多少初始状态能保证Alice必胜呢？", "inputFormat": "输入仅有一行并包含两个正整数，依次为$n$和$m$，如题目所述。", "outputFormat": "输出一个整数，表示有多少初始状态可以保证Alice作为先手方能先手必胜。由于答案可能很大，请输出关于$10^9+9$取模后的值。", "hint": "子任务$1$：（$50$分）$1\\le n\\le 250$且$1\\le m\\le 50$。\n\n子任务$2$：（$50$分）$1\\le n\\le 150000$且$1\\le m\\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Moving Coins", "background": "", "description": "Alice and Bob are going to play the following game. They take turns, and Alice moves first.\n\nWhen it is a player's turn, they may choose one coin and move it any number of cells to the left, but at least $1$ cell.\nA coin cannot be moved out of the board, and it cannot pass over other coins.\n\nInitially, there are $m$ coins placed on a $1 \\times n$ board. Each coin occupies a distinct cell, and each cell contains at most one coin.\n\nIf, on a player's turn, they can no longer make any valid move (obviously, at this time the $m$ coins are exactly in the leftmost $m$ cells), then that player is judged to lose. It is known that Alice and Bob are both extremely smart, and they can always make the optimal move in any position. So, how many initial states can guarantee that Alice, as the first player, will win?", "inputFormat": "The input contains only one line with two positive integers, $n$ and $m$, in this order, as described in the statement.", "outputFormat": "Output one integer, the number of initial states that can guarantee Alice, as the first player, will win. Since the answer may be very large, output it modulo $10^9+9$.", "hint": "Subtask $1$ ($50$ points): $1 \\le n \\le 250$ and $1 \\le m \\le 50$.\n\nSubtask $2$ ($50$ points): $1 \\le n \\le 150000$ and $1 \\le m \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 移动金币", "background": "", "description": "Alice和Bob将要进行如下的一场游戏。二人轮流操作，且Alice先行。\n当轮到一个玩家的时候，他可以选择一枚金币，并将其向左移动任意多格，且至少移动一格。\n金币不能被移出棋盘，也不能越过其它金币。\n\n一个 $1\\times n$ 的棋盘上最初摆放有 $m$ 枚金币。其中每一枚金币占据了一个独立的格子，任意一个格子内最多只有一枚金币。\n\n如果轮到一个玩家的时候他已经无法做出任何有效操作了（显然这个时候$m$枚金币恰好落在最左侧的$m$个格子中），则被判定为输家。已经知道Alice和Bob都是极致聪明的人，他们在任何局面下总能做出最优的操作。那么有多少初始状态能保证Alice必胜呢？", "inputFormat": "输入仅有一行并包含两个正整数，依次为$n$和$m$，如题目所述。", "outputFormat": "输出一个整数，表示有多少初始状态可以保证Alice作为先手方能先手必胜。由于答案可能很大，请输出关于$10^9+9$取模后的值。", "hint": "子任务$1$：（$50$分）$1\\le n\\le 250$且$1\\le m\\le 50$。\n\n子任务$2$：（$50$分）$1\\le n\\le 150000$且$1\\le m\\le 50$。", "locale": "zh-CN"}}}
{"pid": "P5364", "type": "P", "difficulty": 5, "samples": [["4 2", "37"], ["2333333 2", "514898185"], ["1234567890000 3", "891659731"], ["66666666 10", "32306309"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "矩阵加速", "陕西", "线性代数", "线性递推", "拉格朗日插值法", "特征值"], "title": "[SNOI2017] 礼物", "background": "", "description": "热情好客的**小猴子**请森林中的朋友们吃饭，他的朋友被编号为 $1\\sim N$，每个到来的朋友都会带给他一些礼物：**大香蕉**。其中，第一个朋友会带给他 $1$ 个**大香蕉**，之后，每一个朋友到来以后，都会带给他之前所有人带来的礼物个数再加他的编号的 $K$ 次方那么多个。所以，假设 $K=2$，前几位朋友带来的礼物个数分别是：\n\n$1,5,15,37,83,\\ldots$\n\n假设 $K=3$，前几位朋友带来的礼物个数分别是：\n\n$1,9,37,111,\\ldots$\n\n现在，**小猴子**好奇自己到底能收到第 $N$ 个朋友多少礼物，因此拜托于你了。\n\n已知 $N,K$，请输出第 $N$ 个朋友送的礼物个数对 $10^9+7$ 取模的结果。", "inputFormat": "第一行，两个整数 $N,K$。", "outputFormat": "一个整数，表示第 $N$ 个朋友送的礼物个数对 $10^9+7$ 取模的结果。", "hint": "- $20\\%$ 的数据：$N \\le 10^6$；\n- 另外 $10\\%$ 的数据：$K=1$；\n- 另外 $20\\%$ 的数据：$K=2$；\n- 另外 $20\\%$ 的数据：$K=3$；\n- $100\\%$ 的数据：$N \\le 10^{18}$，$K \\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] Gifts", "background": "", "description": "The hospitable **little monkey** invites friends from the forest to dinner. His friends are numbered from $1$ to $N$. Each arriving friend will bring him some gifts: **big bananas**.\n\nThe first friend brings $1$ **big banana**. After that, when each friend arrives, they will bring the total number of gifts brought by all previous friends, plus their own index raised to the $K$-th power.\n\nSo, if $K=2$, the numbers of gifts brought by the first few friends are:\n\n$1,5,15,37,83,\\ldots$\n\nIf $K=3$, the numbers of gifts brought by the first few friends are:\n\n$1,9,37,111,\\ldots$\n\nNow, the **little monkey** is curious about how many gifts he will receive from the $N$-th friend, so he asks for your help.\n\nGiven $N$ and $K$, output the number of gifts brought by the $N$-th friend modulo $10^9+7$.", "inputFormat": "The first line contains two integers $N,K$.", "outputFormat": "Output one integer, representing the number of gifts brought by the $N$-th friend modulo $10^9+7$.", "hint": "- $20\\%$ of the testdata: $N \\le 10^6$.\n- Another $10\\%$ of the testdata: $K=1$.\n- Another $20\\%$ of the testdata: $K=2$.\n- Another $20\\%$ of the testdata: $K=3$.\n- $100\\%$ of the testdata: $N \\le 10^{18}$, $K \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 礼物", "background": "", "description": "热情好客的**小猴子**请森林中的朋友们吃饭，他的朋友被编号为 $1\\sim N$，每个到来的朋友都会带给他一些礼物：**大香蕉**。其中，第一个朋友会带给他 $1$ 个**大香蕉**，之后，每一个朋友到来以后，都会带给他之前所有人带来的礼物个数再加他的编号的 $K$ 次方那么多个。所以，假设 $K=2$，前几位朋友带来的礼物个数分别是：\n\n$1,5,15,37,83,\\ldots$\n\n假设 $K=3$，前几位朋友带来的礼物个数分别是：\n\n$1,9,37,111,\\ldots$\n\n现在，**小猴子**好奇自己到底能收到第 $N$ 个朋友多少礼物，因此拜托于你了。\n\n已知 $N,K$，请输出第 $N$ 个朋友送的礼物个数对 $10^9+7$ 取模的结果。", "inputFormat": "第一行，两个整数 $N,K$。", "outputFormat": "一个整数，表示第 $N$ 个朋友送的礼物个数对 $10^9+7$ 取模的结果。", "hint": "- $20\\%$ 的数据：$N \\le 10^6$；\n- 另外 $10\\%$ 的数据：$K=1$；\n- 另外 $20\\%$ 的数据：$K=2$；\n- 另外 $20\\%$ 的数据：$K=3$；\n- $100\\%$ 的数据：$N \\le 10^{18}$，$K \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P5365", "type": "P", "difficulty": 4, "samples": [["3 24\n4 4 4\n2 2 2", "18"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "背包 DP", "陕西"], "title": "[SNOI2017] 英雄联盟", "background": null, "description": "正在上大学的小皮球热爱英雄联盟这款游戏，而且打的很菜，被网友们戏称为「小学生」。\n\n现在，小皮球终于受不了网友们的嘲讽，决定变强了，他变强的方法就是：买皮肤！\n\n小皮球只会玩 $N$ 个英雄，因此，他也只准备给这 $N$ 个英雄买皮肤，并且决定，以后只玩有皮肤的英雄。\n\n这 $N$ 个英雄中，第 $i$ 个英雄有 $K_i$ 款皮肤，价格是每款 $C_i$ Q币（同一个英雄的皮肤价格相同）。\n\n为了让自己看起来高大上一些，小皮球决定给同学们展示一下自己的皮肤，展示的思路是这样的：对于有皮肤的每一个英雄，随便选一个皮肤给同学看。\n\n比如，小皮球共有 $5$ 个英雄，这 $5$ 个英雄分别有 $0,0,3,2,4$ 款皮肤，那么，小皮球就有 $3 \\times 2 \\times 4 = 24$ 种展示的策略。\n\n现在，小皮球希望自己的展示策略能够至少达到  $M$ 种，请问，小皮球至少要花多少钱呢？", "inputFormat": "第一行，两个整数 $N,M$。\n\n第二行，$N$ 个整数，表示每个英雄的皮肤数量 $K_i$。\n\n第三行，$N$ 个整数，表示每个英雄皮肤的价格 $C_i$。", "outputFormat": "一个整数，表示小皮球达到目标最少的花费。", "hint": "**样例解释**\n\n每一个英雄都只有 $4$ 款皮肤，每款皮肤 $2$ Q币，那么每个英雄买 $3$ 款皮肤，$3 \\times 3 \\times 3 \\ge 24$，共花费 $6 \\times 3$ Q币。\n\n**数据范围**\n\n共 $10$ 组数据，第 $i$ 组数据满足：$N \\le \\max(5, \\log_2^4{i})$\n\n$100\\%$ 的数据：$M \\le 10^{17}, 1 \\le K_i \\le 10, 1 \\le C_i \\le 199$。保证有解。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] League of Legends", "background": "", "description": "Xiao Piqiu, who is in college, loves the game League of Legends, but he plays very poorly, so online players jokingly call him an “elementary school kid”.\n\nNow, Xiao Piqiu finally cannot stand the ridicule anymore and decides to become stronger. His way to become stronger is: buying skins.\n\nXiao Piqiu can only play $N$ champions, so he only plans to buy skins for these $N$ champions, and he decides that in the future he will only play champions that have skins.\n\nAmong these $N$ champions, the $i$-th champion has $K_i$ skins, and the price is $C_i$ Q-coins per skin (skins of the same champion have the same price).\n\nTo make himself look more impressive, Xiao Piqiu decides to show his skins to his classmates. The idea is: for each champion that has skins, randomly choose one skin to show.\n\nFor example, Xiao Piqiu has $5$ champions, and these $5$ champions have $0, 0, 3, 2, 4$ skins respectively. Then Xiao Piqiu has $3 \\times 2 \\times 4 = 24$ ways to show them.\n\nNow, Xiao Piqiu wants the number of his showing strategies to be at least $M$. How much money does he need to spend at least?", "inputFormat": "The first line contains two integers $N, M$.\n\nThe second line contains $N$ integers, representing the number of skins for each champion $K_i$.\n\nThe third line contains $N$ integers, representing the price of each champion’s skins $C_i$.", "outputFormat": "One integer, representing the minimum cost for Xiao Piqiu to reach the goal.", "hint": "**Sample Explanation**\n\nEach champion has $4$ skins, and each skin costs $2$ Q-coins. Then for each champion, buy $3$ skins: $3 \\times 3 \\times 3 \\ge 24$. The total cost is $6 \\times 3$ Q-coins.\n\n**Constraints**\n\nThere are $10$ test cases in total. For the $i$-th test case: $N \\le \\max(5, \\log_2^4{i})$.\n\nFor $100\\%$ of the testdata: $M \\le 10^{17}, 1 \\le K_i \\le 10, 1 \\le C_i \\le 199$. A solution is guaranteed to exist.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 英雄联盟", "background": null, "description": "正在上大学的小皮球热爱英雄联盟这款游戏，而且打的很菜，被网友们戏称为「小学生」。\n\n现在，小皮球终于受不了网友们的嘲讽，决定变强了，他变强的方法就是：买皮肤！\n\n小皮球只会玩 $N$ 个英雄，因此，他也只准备给这 $N$ 个英雄买皮肤，并且决定，以后只玩有皮肤的英雄。\n\n这 $N$ 个英雄中，第 $i$ 个英雄有 $K_i$ 款皮肤，价格是每款 $C_i$ Q币（同一个英雄的皮肤价格相同）。\n\n为了让自己看起来高大上一些，小皮球决定给同学们展示一下自己的皮肤，展示的思路是这样的：对于有皮肤的每一个英雄，随便选一个皮肤给同学看。\n\n比如，小皮球共有 $5$ 个英雄，这 $5$ 个英雄分别有 $0,0,3,2,4$ 款皮肤，那么，小皮球就有 $3 \\times 2 \\times 4 = 24$ 种展示的策略。\n\n现在，小皮球希望自己的展示策略能够至少达到  $M$ 种，请问，小皮球至少要花多少钱呢？", "inputFormat": "第一行，两个整数 $N,M$。\n\n第二行，$N$ 个整数，表示每个英雄的皮肤数量 $K_i$。\n\n第三行，$N$ 个整数，表示每个英雄皮肤的价格 $C_i$。", "outputFormat": "一个整数，表示小皮球达到目标最少的花费。", "hint": "**样例解释**\n\n每一个英雄都只有 $4$ 款皮肤，每款皮肤 $2$ Q币，那么每个英雄买 $3$ 款皮肤，$3 \\times 3 \\times 3 \\ge 24$，共花费 $6 \\times 3$ Q币。\n\n**数据范围**\n\n共 $10$ 组数据，第 $i$ 组数据满足：$N \\le \\max(5, \\log_2^4{i})$\n\n$100\\%$ 的数据：$M \\le 10^{17}, 1 \\le K_i \\le 10, 1 \\le C_i \\le 199$。保证有解。", "locale": "zh-CN"}}}
{"pid": "P5366", "type": "P", "difficulty": 7, "samples": [["5 1 30\n5\n1 2 3 4 5", "1\n2\n2\n0\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "陕西"], "title": "[SNOI2017] 遗失的答案", "background": "", "description": "小皮球在计算出答案之后，买了一堆皮肤，他心里很开心，但是一不小心，就忘记自己买了哪些皮肤了。= =|||\n\n万幸的是，他还记得他把所有皮肤按照 $1 \\sim \\text{N}$ 来编号，他买来的那些皮肤的编号（他至少买了一款皮肤），最大公约数是 $\\text{G}$，最小公倍数是 $\\text{L}$。\n\n现在，有 $\\text{Q}$ 组询问，每组询问输入一个数字 $\\text{X}$，请你告诉小皮球，有多少种合法的购买方案中，购买了皮肤 $\\text{X}$？\n\n因为答案太大了，所以你只需要输出答案 $\\bmod{10^9+7}$ 即可。", "inputFormat": "第一行，三个数字 $\\text{N, G, L}$，如题意所示。\n\n第二行，一个数字 $\\text{Q}$，表示询问个数。\n\n第三行， $\\text{Q}$ 个数字，表示每个询问所问的 $\\text{X}$。", "outputFormat": "对于每一组询问，在一行中单独输出一个整数，表示这个询问的答案。", "hint": "$\\text{30}\\%$ 的数据：$\\text{N} \\le 20$\n\n$\\text{50}\\%$ 的数据：$\\text{N} \\le 1000$\n\n$\\text{70}\\%$ 的数据：$\\text{N} \\le 100000$\n\n$\\text{100}\\%$ 的数据：$\\text{N, G, L} \\le 10^8, \\text{Q} \\le 10^5, 1 \\le \\text{X} \\le 10^8$\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] Lost Answers", "background": "", "description": "After calculating the answer, Little Ball bought a bunch of skins. He was very happy, but by accident, he forgot which skins he had bought. = =|||\n\nFortunately, he still remembers that he numbered all skins from $1 \\sim \\text{N}$. Among the skins he bought (he bought at least one skin), the greatest common divisor is $\\text{G}$, and the least common multiple is $\\text{L}$.\n\nNow there are $\\text{Q}$ queries. Each query gives a number $\\text{X}$. Please tell Little Ball: among all valid purchase plans, how many of them include skin $\\text{X}$?\n\nBecause the answer is too large, you only need to output the answer $\\bmod{10^9+7}$.", "inputFormat": "The first line contains three integers $\\text{N, G, L}$, as described.\n\nThe second line contains one integer $\\text{Q}$, the number of queries.\n\nThe third line contains $\\text{Q}$ integers, each being the $\\text{X}$ asked in a query.", "outputFormat": "For each query, output one integer per line, representing the answer to this query.", "hint": "$30\\%$ of the testdata: $\\text{N} \\le 20$.\n\n$50\\%$ of the testdata: $\\text{N} \\le 1000$.\n\n$70\\%$ of the testdata: $\\text{N} \\le 100000$.\n\n$100\\%$ of the testdata: $\\text{N, G, L} \\le 10^8, \\text{Q} \\le 10^5, 1 \\le \\text{X} \\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 遗失的答案", "background": "", "description": "小皮球在计算出答案之后，买了一堆皮肤，他心里很开心，但是一不小心，就忘记自己买了哪些皮肤了。= =|||\n\n万幸的是，他还记得他把所有皮肤按照 $1 \\sim \\text{N}$ 来编号，他买来的那些皮肤的编号（他至少买了一款皮肤），最大公约数是 $\\text{G}$，最小公倍数是 $\\text{L}$。\n\n现在，有 $\\text{Q}$ 组询问，每组询问输入一个数字 $\\text{X}$，请你告诉小皮球，有多少种合法的购买方案中，购买了皮肤 $\\text{X}$？\n\n因为答案太大了，所以你只需要输出答案 $\\bmod{10^9+7}$ 即可。", "inputFormat": "第一行，三个数字 $\\text{N, G, L}$，如题意所示。\n\n第二行，一个数字 $\\text{Q}$，表示询问个数。\n\n第三行， $\\text{Q}$ 个数字，表示每个询问所问的 $\\text{X}$。", "outputFormat": "对于每一组询问，在一行中单独输出一个整数，表示这个询问的答案。", "hint": "$\\text{30}\\%$ 的数据：$\\text{N} \\le 20$\n\n$\\text{50}\\%$ 的数据：$\\text{N} \\le 1000$\n\n$\\text{70}\\%$ 的数据：$\\text{N} \\le 100000$\n\n$\\text{100}\\%$ 的数据：$\\text{N, G, L} \\le 10^8, \\text{Q} \\le 10^5, 1 \\le \\text{X} \\le 10^8$\n\n", "locale": "zh-CN"}}}
{"pid": "P5367", "type": "P", "difficulty": 4, "samples": [["3\n2 1 3", "3"], ["4\n1 2 4 3", "2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "平衡树", "树状数组", "康托展开", "模板题"], "title": "【模板】康托展开", "background": null, "description": "求 $1\\sim N$ 的一个给定全排列在所有 $1\\sim N$ 全排列中的排名。结果对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $N$。\n\n第二行 $N$ 个正整数，表示 $1\\sim N$ 的一种全排列。", "outputFormat": "一行一个非负整数，表示答案对 $998244353$ 取模的值。", "hint": "对于 $10\\%$ 数据，$1\\le N\\le 10$。\n\n对于 $50\\%$ 数据，$1\\le N\\le 5000$。\n\n对于 $100\\%$ 数据，$1\\le N\\le 1000000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Cantor Expansion", "background": "", "description": "Find the rank of a given permutation of $1\\sim N$ among all permutations of $1\\sim N$. Output the result modulo $998244353$.", "inputFormat": "The first line contains a positive integer $N$.\n\nThe second line contains $N$ positive integers, representing a permutation of $1\\sim N$.", "outputFormat": "Output one non-negative integer, the answer modulo $998244353$.", "hint": "For $10\\%$ of the testdata, $1\\le N\\le 10$.\n\nFor $50\\%$ of the testdata, $1\\le N\\le 5000$.\n\nFor $100\\%$ of the testdata, $1\\le N\\le 1000000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】康托展开", "background": null, "description": "求 $1\\sim N$ 的一个给定全排列在所有 $1\\sim N$ 全排列中的排名。结果对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $N$。\n\n第二行 $N$ 个正整数，表示 $1\\sim N$ 的一种全排列。", "outputFormat": "一行一个非负整数，表示答案对 $998244353$ 取模的值。", "hint": "对于 $10\\%$ 数据，$1\\le N\\le 10$。\n\n对于 $50\\%$ 数据，$1\\le N\\le 5000$。\n\n对于 $100\\%$ 数据，$1\\le N\\le 1000000$。", "locale": "zh-CN"}}}
{"pid": "P5368", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2 3", "3\n1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018"], "title": "[PKUSC2018] 真实排名", "background": "", "description": "小 C 是某知名比赛的组织者，该比赛一共有 $n$ 名选手参加，每个选手的成绩是一个非负整数，定义一个选手的排名是：成绩不小于他的选手的数量（包括他自己）。例如如果 $3$ 位选手的成绩分别是 $[1 , 2 ,2]$ ，那么他们的排名分别是 $[3,2,2]$ 。\n\n拥有上帝视角的你知道所有选手的实力，所以在考试前就精准地估计了每个人的成绩，设你估计的第 $i$ 个选手的成绩为$A_i$，且由于你是上帝视角，所以如果不发生任何意外的话，你估计的成绩就是选手的最终成绩。\n\n但是在比赛当天发生了不可抗的事故（例如遭受到了外星人的攻击），导致有一些选手的成绩变成了最终成绩的两倍，即便是有上帝视角的你也不知道具体是哪些选手的成绩翻倍了，唯一知道的信息是这样的选手恰好有 $k$ 个。\n\n现在你需要计算，经过了不可抗事故后，对于第 $i$ 位选手，有多少种情况满足他的排名没有改变。\n\n由于答案可能过大，所以你只需要输出答案对 $998244353$ 取模的值即可。\n", "inputFormat": "第一行两个正整数 $n,k$。\n\n第二行 $n$ 个非负整数 $A_1, A _ 2, \\cdots, A_n$。\n", "outputFormat": "输出 $n$ 行，第 $i$ 行一个非负整数 $ans_i$，表示经过不可抗事故后，第 $i$ 位选手的排名没有发生改变的情况数。\n", "hint": "- 对于 $10\\%$ 的数据，有 $1\\leq n\\leq 15$；\n- 对于 $35\\%$ 的数据，有 $1\\leq n\\leq 10^3$；\n- 另有 $10\\%$ 的数据，满足每个人的成绩都互不相同；\n- 另有 $10\\%$ 的数据，满足 $0\\leq A_i\\leq 10^5$；\n- 另有 $10\\%$ 的数据，满足 $k=85$，$0\\leq A_i\\leq 600$；\n- 对于$100\\%$的数据，有$1\\leq k < n\\leq 10^5$，$0\\leq A_i\\leq 10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[PKUSC2018] True Ranking", "background": "", "description": "Little C is the organizer of a well-known contest. There are $n$ contestants in total, and each contestant's score is a non-negative integer. Define a contestant's rank as: the number of contestants whose scores are not less than theirs (including themselves). For example, if the scores of $3$ contestants are $[1, 2, 2]$, then their ranks are $[3, 2, 2]$.\n\nWith a god's-eye view, you know all contestants' abilities, so before the contest you accurately estimated everyone's score. Let your estimated score for the $i$-th contestant be $A_i$. Since you have a god's-eye view, if nothing unexpected happens, your estimated scores will be the contestants' final scores.\n\nHowever, on the contest day an irresistible accident happened (for example, an alien attack), causing some contestants' scores to become twice their final scores. Even with a god's-eye view, you do not know exactly which contestants' scores were doubled. The only information you know is that there are exactly $k$ such contestants.\n\nNow you need to compute, after the accident, for the $i$-th contestant, how many scenarios make their rank unchanged.\n\nSince the answer may be too large, you only need to output the answer modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n, k$.\n\nThe second line contains $n$ non-negative integers $A_1, A_2, \\cdots, A_n$.", "outputFormat": "Output $n$ lines. The $i$-th line contains a non-negative integer $ans_i$, representing the number of scenarios in which the $i$-th contestant's rank does not change after the accident.", "hint": "- For $10\\%$ of the testdata, $1 \\leq n \\leq 15$.\n- For $35\\%$ of the testdata, $1 \\leq n \\leq 10^3$.\n- Another $10\\%$ of the testdata satisfies that all scores are pairwise distinct.\n- Another $10\\%$ of the testdata satisfies $0 \\leq A_i \\leq 10^5$.\n- Another $10\\%$ of the testdata satisfies $k = 85$, $0 \\leq A_i \\leq 600$.\n- For $100\\%$ of the testdata, $1 \\leq k < n \\leq 10^5$, $0 \\leq A_i \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUSC2018] 真实排名", "background": "", "description": "小 C 是某知名比赛的组织者，该比赛一共有 $n$ 名选手参加，每个选手的成绩是一个非负整数，定义一个选手的排名是：成绩不小于他的选手的数量（包括他自己）。例如如果 $3$ 位选手的成绩分别是 $[1 , 2 ,2]$ ，那么他们的排名分别是 $[3,2,2]$ 。\n\n拥有上帝视角的你知道所有选手的实力，所以在考试前就精准地估计了每个人的成绩，设你估计的第 $i$ 个选手的成绩为$A_i$，且由于你是上帝视角，所以如果不发生任何意外的话，你估计的成绩就是选手的最终成绩。\n\n但是在比赛当天发生了不可抗的事故（例如遭受到了外星人的攻击），导致有一些选手的成绩变成了最终成绩的两倍，即便是有上帝视角的你也不知道具体是哪些选手的成绩翻倍了，唯一知道的信息是这样的选手恰好有 $k$ 个。\n\n现在你需要计算，经过了不可抗事故后，对于第 $i$ 位选手，有多少种情况满足他的排名没有改变。\n\n由于答案可能过大，所以你只需要输出答案对 $998244353$ 取模的值即可。\n", "inputFormat": "第一行两个正整数 $n,k$。\n\n第二行 $n$ 个非负整数 $A_1, A _ 2, \\cdots, A_n$。\n", "outputFormat": "输出 $n$ 行，第 $i$ 行一个非负整数 $ans_i$，表示经过不可抗事故后，第 $i$ 位选手的排名没有发生改变的情况数。\n", "hint": "- 对于 $10\\%$ 的数据，有 $1\\leq n\\leq 15$；\n- 对于 $35\\%$ 的数据，有 $1\\leq n\\leq 10^3$；\n- 另有 $10\\%$ 的数据，满足每个人的成绩都互不相同；\n- 另有 $10\\%$ 的数据，满足 $0\\leq A_i\\leq 10^5$；\n- 另有 $10\\%$ 的数据，满足 $k=85$，$0\\leq A_i\\leq 600$；\n- 对于$100\\%$的数据，有$1\\leq k < n\\leq 10^5$，$0\\leq A_i\\leq 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P5369", "type": "P", "difficulty": 6, "samples": [["2\n-1 2", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2018", "状压 DP"], "title": "[PKUSC2018] 最大前缀和", "background": "", "description": "小 C 是一个算法竞赛爱好者，有一天小 C 遇到了一个非常难的问题：求一个序列的最大子段和。\n\n但是小 C 并不会做这个题，于是小 C 决定把序列随机打乱，然后取序列的最大前缀和作为答案。\n\n小 C 是一个非常有自知之明的人，他知道自己的算法完全不对，所以并不关心正确率，他只关心求出的解的期望值，现在请你帮他解决这个问题，由于答案可能非常复杂，所以你只需要输出答案乘上 $n!$ 后对 $998244353$ 取模的值，显然这是个整数。\n\n注：最大前缀和的定义：$\\forall i \\in [1,n]$，$\\sum_{j=1}^{i}a_j$的最大值。\n", "inputFormat": "第一行一个正整数 $n$，表示序列长度。\n\n第二行 $n$ 个数，表示原序列 $a[1..n]$，第 $i$ 个数表示 $a[i]$ 。\n", "outputFormat": "输出一个**非负整数**，表示答案。\n", "hint": "对于$10\\%$的数据，有$1\\leq n\\leq 9$。\n\n对于$40\\%$的数据，有$1\\leq n\\leq 15$。\n\n另有$10\\%$的数据，满足$a$中最多只有一个负数。\n\n另有$10\\%$的数据，满足$|a[i]|\\leq 2$。\n\n对于$100\\%$的数据，满足$1\\leq n\\leq 20$，$\\sum_{i=1}^{n}|a[i]|\\leq 10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[PKUSC2018] Maximum Prefix Sum", "background": "", "description": "Xiao C is an algorithm contest enthusiast. One day, Xiao C ran into a very difficult problem: finding the maximum subarray sum of a sequence.\n\nHowever, Xiao C cannot solve this problem, so Xiao C decides to randomly shuffle the sequence and then take the maximum prefix sum of the shuffled sequence as the answer.\n\nXiao C knows very well that this algorithm is completely wrong, so he does not care about its correctness. He only cares about the expected value of the computed result. Please help him solve this problem. Since the answer may be very complicated, you only need to output the value of the answer multiplied by $n!$ and then taken modulo $998244353$. Obviously, this is an integer.\n\nNote: The definition of maximum prefix sum: $\\forall i \\in [1,n]$, the maximum value of $\\sum_{j=1}^{i}a_j$.", "inputFormat": "The first line contains a positive integer $n$, which denotes the length of the sequence.\n\nThe second line contains $n$ numbers, representing the original sequence $a[1..n]$. The $i$-th number is $a[i]$.", "outputFormat": "Output a **non-negative integer**, which denotes the answer.", "hint": "For $10\\%$ of the testdata, $1\\leq n\\leq 9$.\n\nFor $40\\%$ of the testdata, $1\\leq n\\leq 15$.\n\nFor another $10\\%$ of the testdata, in $a$ there is at most one negative number.\n\nFor another $10\\%$ of the testdata, $|a[i]|\\leq 2$.\n\nFor $100\\%$ of the testdata, $1\\leq n\\leq 20$, $\\sum_{i=1}^{n}|a[i]|\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUSC2018] 最大前缀和", "background": "", "description": "小 C 是一个算法竞赛爱好者，有一天小 C 遇到了一个非常难的问题：求一个序列的最大子段和。\n\n但是小 C 并不会做这个题，于是小 C 决定把序列随机打乱，然后取序列的最大前缀和作为答案。\n\n小 C 是一个非常有自知之明的人，他知道自己的算法完全不对，所以并不关心正确率，他只关心求出的解的期望值，现在请你帮他解决这个问题，由于答案可能非常复杂，所以你只需要输出答案乘上 $n!$ 后对 $998244353$ 取模的值，显然这是个整数。\n\n注：最大前缀和的定义：$\\forall i \\in [1,n]$，$\\sum_{j=1}^{i}a_j$的最大值。\n", "inputFormat": "第一行一个正整数 $n$，表示序列长度。\n\n第二行 $n$ 个数，表示原序列 $a[1..n]$，第 $i$ 个数表示 $a[i]$ 。\n", "outputFormat": "输出一个**非负整数**，表示答案。\n", "hint": "对于$10\\%$的数据，有$1\\leq n\\leq 9$。\n\n对于$40\\%$的数据，有$1\\leq n\\leq 15$。\n\n另有$10\\%$的数据，满足$a$中最多只有一个负数。\n\n另有$10\\%$的数据，满足$|a[i]|\\leq 2$。\n\n对于$100\\%$的数据，满足$1\\leq n\\leq 20$，$\\sum_{i=1}^{n}|a[i]|\\leq 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P5370", "type": "P", "difficulty": 6, "samples": [["556789TJJQKKAA22w\n456789TJJQKKAA22w\n456789TJQKKKAAA22", "193483\n0\n613897"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018"], "title": "[PKUSC2018] 主斗地", "background": "", "description": "如果你参加过 NOIP 2015 和 PKUWC 2018，那么你一定对一道叫做斗地主的题印象深刻。为了致敬经典，我们又出了一道有关打牌的题。在本题中，牌型和斗地主**类似但不完全相同**，我们称本题中的扑克游戏为主斗地。\n\n主斗地是一种使用黑桃、红心、梅花、方片的A到K加上大小王的共54张牌来进行的扑克牌游戏，其中大小王各一张，其他数码牌各四张。在斗地主中，牌的大小关系根据牌的数码表示如下：$3<4<5<6<7<8<9<10(T)<J<Q<K<A<2< $小王 $(w)$ $<$ 大王 $(W)$，而花色并不对牌的大小产生影响。每一局游戏中，一副手牌由 $n$ 张牌组成。游戏者每次可以根据规定的牌型进行出牌，首先打光自己的手牌一方取得游戏的胜利。为了简化题目，本题不考虑花色的影响，即**所有的相同的数码的牌都是被视为一样的**。\n\n在这道题中，允许的出牌牌型有（**这一部分与传统的斗地主有所出入，请注意**）：\n\n|   名称    |           解释           |      举例       |     注     |\n| :-----: | :--------------------: | :-----------: | :-------: |\n|   单牌    |         单独的一张牌         |       6       | 单张的王也是单牌  |\n|   对子    |        相同数码的两张牌        |      66       |  大小王不是对子  |\n|   三张牌   |        相同数码的三张牌        |      666      |           |\n|   三带一   |     相同数码的三张牌带上一张单牌     |     666w      |           |\n|   三带二   |  相同数码的三张牌带上一个另外数码的对子   |     66699     |           |\n|   顺子    |    大小连续的 $5$ 张及以上单牌    |    3456789    | 不能含有大小王和2 |\n|   连对    |   大小连续的 $3$ 对及以上的对子    |   33445566    | 不能含有大小王和2 |\n|   三顺    |     大小连续的两组及以上的三张牌     |   333444555   | 不能含有大小王和2 |\n|   四带二   |     四张相同数码的牌带上两张单牌     | 444456 444455 | 注意不能带两个对子 |\n| 飞机（单翅膀） | 三顺带上相同数量的**数码两两不同的**单牌 | 33344455569J  |           |\n| 飞机（双翅膀） | 三顺带上相同数量的**数码两两不同的**对子 |  3334446699   |           |\n\n**注意**：\n\n1. 在牌型中没有连炸这种牌型，但是形如 444455556666 的牌仍然是能出的，它将被视为 444555666 带 456 的飞机（单翅膀）牌型。\n2. 大王和小王数码不同，即飞机带大小王是合法的，例如 333444wW\n3. 容易验证，上述牌型的规则是合法的，即对于任意合法的牌，它都有唯一的牌型。\n4. 在牌型中，没有炸弹。**炸弹将被视为三带一，且没有炸弹的效果**，即它不能压任何牌型。\n5. 在牌型中，没有火箭。这意味着 wW 不再是一个合法的牌型。\n\n两手牌是属于相同牌型的当且仅当他们的名称相同且包含牌的数量相同。相同牌型的牌之间存在着大小关系：\n\n1. 三带一三带二的大小取决于那三张相同牌的数码\n2. 飞机的大小取决于三顺的大小\n3. 四带二的大小取决于四张相同牌的大小\n4. 其他牌型的大小取决于牌中的最大的一张牌\n\n下面是对主斗地的游戏过程的描述：\n\n1. 在主斗地中，有两个玩家，他们是同一个阵营的，两个玩家要一同达成游戏目标。为了方便，我们假设第一个玩家是九条可怜，第二个玩家是××网友。\n2. 游戏只会使用一副完整的扑克牌。在游戏开始的时候，**会先把所有的 $3$ 扔掉**。之后双方各从这一副牌中随机抽取 $17$ 张，余下的 $16$张被丢弃。你可以认为是随机洗牌后，九条可怜取前 $17$ 张，××网友后 $17$ 张，剩下的 $16$ 张被掉了。\n3. 游戏分成若干轮，每一轮分为两步：\n   1. 第一步，九条可怜从当前手牌中选择一个任意牌型任意大小的牌 $C$ 并打出。\n   2. 第二步，××网友从当前手牌中选择一个和 $C$ 牌型相同且大小 **严格更大** 的牌 $C'$ 打出。如果不存在这样的牌则游戏失败。\n4. 在某一轮结束后，如果九条可怜和××网友中有至少一个人没有手牌，则游戏结束。如果两个人都没有手牌，则游戏胜利，否则游戏失败。\n\n下面是一个例子：\n\n假设九条可怜的牌是 44445556789TJQKwW，××网友的牌是 666789TJQKAAAA222。那么一个可以获胜的方案是：\n\n1. 第一轮九条可怜出 4444wW，××网友出 AAAA22。\n2. 第二轮九条可怜出 6789TJQ，××网友出 789TJQK。\n3. 第三轮九条可怜出 555K，××网友出 6662。\n\n这个游戏很考验两个玩家之间的默契。但是因为九条可怜和××网友无法相互理解，于是他们打算以明牌的方式进行游戏，即双方都知道对方的牌。因为两个人都会按照最优策略行动，所以在牌下发的时候，游戏的胜负就已经确定了。\n\n现在给出××网友的牌，你需要计算九条可怜有多少种不同的可能的手牌可以获得胜利。\n\n注意：××网友和九条可怜的牌都来自于同一副扑克，且分牌的时候没有 $3$。", "inputFormat": "每组数据输入一行，一个长度为 $17$ 的字符串表示××网友的牌。我们用 456789TJQKA2wW 来表示每一种牌。\n", "outputFormat": "对每组数据，输出一个整数表示答案，满足条件的九条可怜的牌数。答案可能很大，请对 $998244353$ 取模输出。\n\n**注意**，在这题中我们不考虑花色，如果两种手牌的数码组成完全相同，但是花色不同，他们也是会被视为同一种的。\n", "hint": "\n因为种种原因，本题采用捆绑测试，一共有 $3$ 个 subtask:\n\n| 子问题编号 |  分值  |       约定       |\n| :---: | :--: | :------------: |\n|   1   | $30$ | 每一种牌最多出现 $2$ 次 |\n|   2   | $30$ | 每一种牌最多出现 $3$ 次 |\n|   3   | $40$ | 每一种牌最多出现 $4$ 次 |\n\n时间限制：2s \n\n空间限制：512M", "locale": "zh-CN", "translations": {"en": {"title": "[PKUSC2018] Zhu Dou Di", "background": "", "description": "If you have taken part in NOIP 2015 and PKUWC 2018, you must have a deep impression of a problem called Dou Dizhu. To pay tribute to the classic, we made another card-related problem. In this problem, the hand types are **similar to but not exactly the same as** Dou Dizhu. We call the poker game in this problem Zhu Dou Di.\n\nZhu Dou Di is a poker game played with a total of 54 cards: A to K of spades, hearts, clubs, and diamonds, plus the small joker and the big joker, one each. All other ranks have four copies. In Dou Dizhu, the order of ranks is as follows: $3<4<5<6<7<8<9<10(T)<J<Q<K<A<2<$ small joker $(w)$ $<$ big joker $(W)$, and suits do not affect the card order. In each game, a hand consists of $n$ cards. Each time, a player may play cards according to the allowed hand types. The first player to play all their cards wins the game. To simplify the problem, we ignore suits, i.e., **all cards of the same rank are considered identical**.\n\nIn this problem, the allowed hand types are ( **this part differs from the traditional Dou Dizhu, please be careful** ):\n\n| Name | Explanation | Example | Note |\n| :-----: | :--------------------: | :-----------: | :-------: |\n| Single | A single card | 6 | A single joker is also a single |\n| Pair | Two cards of the same rank | 66 | The two jokers do not form a pair |\n| Triple | Three cards of the same rank | 666 | |\n| Triple + Single | A triple plus one single card | 666w | |\n| Triple + Pair | A triple plus one pair of a different rank | 66699 | |\n| Straight | $5$ or more consecutive single cards | 3456789 | Cannot contain jokers or 2 |\n| Consecutive Pairs | $3$ or more consecutive pairs | 33445566 | Cannot contain jokers or 2 |\n| Consecutive Triples | Two or more consecutive triples | 333444555 | Cannot contain jokers or 2 |\n| Four + Two | Four cards of the same rank plus two single cards | 444456 444455 | Note that you cannot bring two pairs |\n| Plane (single wings) | Consecutive triples plus the same number of single cards whose ranks are **pairwise different** | 33344455569J | |\n| Plane (double wings) | Consecutive triples plus the same number of pairs whose ranks are **pairwise different** | 3334446699 | |\n\n**Notes**:\n\n1. There is no “consecutive bombs” hand type, but a hand like 444455556666 is still playable; it will be treated as a Plane (single wings) hand type, namely 444555666 with wings 456.\n2. The big joker and the small joker are different ranks, so it is legal for the plane’s wings to include both jokers, e.g., 333444wW.\n3. It is easy to verify that the above hand type rules are valid: for any legal hand, it has a unique hand type.\n4. There are no bombs. **A bomb will be treated as Triple + Single, and it has no bomb effect**, i.e., it cannot beat any hand type.\n5. There is no rocket. This means wW is no longer a legal hand type.\n\nTwo hands belong to the same hand type if and only if they have the same name and contain the same number of cards. Between hands of the same hand type, there is an order:\n\n1. For Triple + Single and Triple + Pair, the order depends on the rank of the triple.\n2. For planes, the order depends on the order of the consecutive triples.\n3. For Four + Two, the order depends on the rank of the four-of-a-kind.\n4. For other hand types, the order depends on the largest card in the hand.\n\nBelow is the game process of Zhu Dou Di:\n\n1. In Zhu Dou Di, there are two players, and they are on the same team. The two players must achieve the game goal together. For convenience, assume the first player is Jiutiao Kelian, and the second player is an “×× netizen”.\n2. The game uses only one complete deck of cards. At the start of the game, **all $3$’s are thrown away first**. Then each side randomly draws $17$ cards from the deck, and the remaining $16$ cards are discarded. You may think of it as: after shuffling, Jiutiao Kelian takes the first $17$ cards, the “×× netizen” takes the next $17$ cards, and the remaining $16$ cards are thrown away.\n3. The game consists of several rounds, and each round has two steps:\n   1. Step 1: Jiutiao Kelian chooses any legal hand $C$ of any hand type and any size from their current hand and plays it.\n   2. Step 2: The “×× netizen” chooses a hand $C'$ from their current hand that has the same hand type as $C$ and is **strictly larger** in order, and plays it. If no such hand exists, the game fails.\n4. After a round ends, if at least one of Jiutiao Kelian and the “×× netizen” has no cards left, the game ends. If both players have no cards left, the game is a win; otherwise it is a failure.\n\nHere is an example:\n\nSuppose Jiutiao Kelian’s cards are 44445556789TJQKwW, and the “×× netizen” has 666789TJQKAAAA222. One winning strategy is:\n\n1. Round 1: Jiutiao Kelian plays 4444wW, and the “×× netizen” plays AAAA22.\n2. Round 2: Jiutiao Kelian plays 6789TJQ, and the “×× netizen” plays 789TJQK.\n3. Round 3: Jiutiao Kelian plays 555K, and the “×× netizen” plays 6662.\n\nThis game strongly tests the coordination between the two players. However, since Jiutiao Kelian and the “×× netizen” cannot understand each other, they decide to play with open hands, i.e., both sides know the other’s cards. Since both players will act according to the optimal strategy, the outcome of the game is already determined at the moment the cards are dealt.\n\nNow you are given the “×× netizen”’s hand. You need to compute how many different possible hands Jiutiao Kelian can have that allow them to win.\n\nNote: the “×× netizen”’s cards and Jiutiao Kelian’s cards come from the same deck, and there are no $3$’s when dealing.", "inputFormat": "For each test case, input one line: a string of length $17$ representing the “×× netizen”’s hand. We use 456789TJQKA2wW to represent each rank of card.", "outputFormat": "For each test case, output an integer representing the answer: the number of Jiutiao Kelian’s hands that satisfy the condition. The answer may be very large, so output it modulo $998244353$.\n\n**Note**: in this problem we ignore suits. If two hands have exactly the same multiset of ranks but different suits, they are still considered the same.", "hint": "For various reasons, this problem uses bundled testdata. There are $3$ subtasks in total:\n\n| Subtask ID | Score | Constraint |\n| :---: | :--: | :------------: |\n| 1 | $30$ | Each rank appears at most $2$ times |\n| 2 | $30$ | Each rank appears at most $3$ times |\n| 3 | $40$ | Each rank appears at most $4$ times |\n\nTime limit: 2s.\n\nMemory limit: 512M.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUSC2018] 主斗地", "background": "", "description": "如果你参加过 NOIP 2015 和 PKUWC 2018，那么你一定对一道叫做斗地主的题印象深刻。为了致敬经典，我们又出了一道有关打牌的题。在本题中，牌型和斗地主**类似但不完全相同**，我们称本题中的扑克游戏为主斗地。\n\n主斗地是一种使用黑桃、红心、梅花、方片的A到K加上大小王的共54张牌来进行的扑克牌游戏，其中大小王各一张，其他数码牌各四张。在斗地主中，牌的大小关系根据牌的数码表示如下：$3<4<5<6<7<8<9<10(T)<J<Q<K<A<2< $小王 $(w)$ $<$ 大王 $(W)$，而花色并不对牌的大小产生影响。每一局游戏中，一副手牌由 $n$ 张牌组成。游戏者每次可以根据规定的牌型进行出牌，首先打光自己的手牌一方取得游戏的胜利。为了简化题目，本题不考虑花色的影响，即**所有的相同的数码的牌都是被视为一样的**。\n\n在这道题中，允许的出牌牌型有（**这一部分与传统的斗地主有所出入，请注意**）：\n\n|   名称    |           解释           |      举例       |     注     |\n| :-----: | :--------------------: | :-----------: | :-------: |\n|   单牌    |         单独的一张牌         |       6       | 单张的王也是单牌  |\n|   对子    |        相同数码的两张牌        |      66       |  大小王不是对子  |\n|   三张牌   |        相同数码的三张牌        |      666      |           |\n|   三带一   |     相同数码的三张牌带上一张单牌     |     666w      |           |\n|   三带二   |  相同数码的三张牌带上一个另外数码的对子   |     66699     |           |\n|   顺子    |    大小连续的 $5$ 张及以上单牌    |    3456789    | 不能含有大小王和2 |\n|   连对    |   大小连续的 $3$ 对及以上的对子    |   33445566    | 不能含有大小王和2 |\n|   三顺    |     大小连续的两组及以上的三张牌     |   333444555   | 不能含有大小王和2 |\n|   四带二   |     四张相同数码的牌带上两张单牌     | 444456 444455 | 注意不能带两个对子 |\n| 飞机（单翅膀） | 三顺带上相同数量的**数码两两不同的**单牌 | 33344455569J  |           |\n| 飞机（双翅膀） | 三顺带上相同数量的**数码两两不同的**对子 |  3334446699   |           |\n\n**注意**：\n\n1. 在牌型中没有连炸这种牌型，但是形如 444455556666 的牌仍然是能出的，它将被视为 444555666 带 456 的飞机（单翅膀）牌型。\n2. 大王和小王数码不同，即飞机带大小王是合法的，例如 333444wW\n3. 容易验证，上述牌型的规则是合法的，即对于任意合法的牌，它都有唯一的牌型。\n4. 在牌型中，没有炸弹。**炸弹将被视为三带一，且没有炸弹的效果**，即它不能压任何牌型。\n5. 在牌型中，没有火箭。这意味着 wW 不再是一个合法的牌型。\n\n两手牌是属于相同牌型的当且仅当他们的名称相同且包含牌的数量相同。相同牌型的牌之间存在着大小关系：\n\n1. 三带一三带二的大小取决于那三张相同牌的数码\n2. 飞机的大小取决于三顺的大小\n3. 四带二的大小取决于四张相同牌的大小\n4. 其他牌型的大小取决于牌中的最大的一张牌\n\n下面是对主斗地的游戏过程的描述：\n\n1. 在主斗地中，有两个玩家，他们是同一个阵营的，两个玩家要一同达成游戏目标。为了方便，我们假设第一个玩家是九条可怜，第二个玩家是××网友。\n2. 游戏只会使用一副完整的扑克牌。在游戏开始的时候，**会先把所有的 $3$ 扔掉**。之后双方各从这一副牌中随机抽取 $17$ 张，余下的 $16$张被丢弃。你可以认为是随机洗牌后，九条可怜取前 $17$ 张，××网友后 $17$ 张，剩下的 $16$ 张被掉了。\n3. 游戏分成若干轮，每一轮分为两步：\n   1. 第一步，九条可怜从当前手牌中选择一个任意牌型任意大小的牌 $C$ 并打出。\n   2. 第二步，××网友从当前手牌中选择一个和 $C$ 牌型相同且大小 **严格更大** 的牌 $C'$ 打出。如果不存在这样的牌则游戏失败。\n4. 在某一轮结束后，如果九条可怜和××网友中有至少一个人没有手牌，则游戏结束。如果两个人都没有手牌，则游戏胜利，否则游戏失败。\n\n下面是一个例子：\n\n假设九条可怜的牌是 44445556789TJQKwW，××网友的牌是 666789TJQKAAAA222。那么一个可以获胜的方案是：\n\n1. 第一轮九条可怜出 4444wW，××网友出 AAAA22。\n2. 第二轮九条可怜出 6789TJQ，××网友出 789TJQK。\n3. 第三轮九条可怜出 555K，××网友出 6662。\n\n这个游戏很考验两个玩家之间的默契。但是因为九条可怜和××网友无法相互理解，于是他们打算以明牌的方式进行游戏，即双方都知道对方的牌。因为两个人都会按照最优策略行动，所以在牌下发的时候，游戏的胜负就已经确定了。\n\n现在给出××网友的牌，你需要计算九条可怜有多少种不同的可能的手牌可以获得胜利。\n\n注意：××网友和九条可怜的牌都来自于同一副扑克，且分牌的时候没有 $3$。", "inputFormat": "每组数据输入一行，一个长度为 $17$ 的字符串表示××网友的牌。我们用 456789TJQKA2wW 来表示每一种牌。\n", "outputFormat": "对每组数据，输出一个整数表示答案，满足条件的九条可怜的牌数。答案可能很大，请对 $998244353$ 取模输出。\n\n**注意**，在这题中我们不考虑花色，如果两种手牌的数码组成完全相同，但是花色不同，他们也是会被视为同一种的。\n", "hint": "\n因为种种原因，本题采用捆绑测试，一共有 $3$ 个 subtask:\n\n| 子问题编号 |  分值  |       约定       |\n| :---: | :--: | :------------: |\n|   1   | $30$ | 每一种牌最多出现 $2$ 次 |\n|   2   | $30$ | 每一种牌最多出现 $3$ 次 |\n|   3   | $40$ | 每一种牌最多出现 $4$ 次 |\n\n时间限制：2s \n\n空间限制：512M", "locale": "zh-CN"}}}
{"pid": "P5371", "type": "P", "difficulty": 6, "samples": [["3 3\n0", "10"], ["9 4\n9\n1 3\n2 1\n3 1\n4 1\n5 1\n6 1\n7 1\n8 1\n9 3", "3521"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "各省省选", "陕西"], "title": "[SNOI2019] 纸牌", "background": null, "description": "有一副纸牌。牌一共有 $n$ 种，分别标有 $1,2,...,n$ ，每种有 $C$ 张。故这副牌总共有 $nC$ 张。\n\n三张连号的牌 $(i,i+1,i+2)$ 或三张相同的牌 $(i,i,i)$ 可以组成一**叠**。如果一组牌可以分成若干（包括零）**叠**，就称其为一组**王牌**。\n\n你从牌堆中摸了一些初始牌。现在你想挑出一些牌组成一组王牌，请问有多少种可能组成的王牌呢？答案对 $998244353$ 取模。**也就是说，需要在初始牌的基础上再选一些牌（也可以不再选）。**\n\n两组牌相同当且仅当它们含有的每一种牌数量都相同。", "inputFormat": "第 $1$ 行两个整数 $n,C$ 表示牌的种类数和每种的张数；\n\n第 $2$ 行一个整数 $X$ 表示初始牌的种类数；\n\n接下来 $X$ 行每行两个整数 $k_i,a_i$ ，表示初始牌中有 $a_i$ 张 $k_i$ 号牌。每行的 $k_i$ 依次递增。", "outputFormat": "输出 $1$ 行 $1$ 个自然数表示答案，对 $998244353$ 取模。", "hint": "### 样例解释1\n\n所有方案如下：\n\n1. $\\{\\}$ （不选任何牌）\n2. $\\{1,1,1\\}$\n3. $\\{2,2,2\\}$\n4. $\\{3,3,3\\}$\n5. $\\{1,2,3\\}$\n6. $\\{1,1,1,2,2,2\\}$\n7. $\\{1,1,1,3,3,3\\}$\n8. $\\{2,2,2,3,3,3\\}$\n9. $\\{1,1,2,2,3,3\\}$\n10. $\\{1,1,1,2,2,2,3,3,3\\}$\n\n### 数据范围\n\n对于所有数据， $1\\leq n\\leq 10^{18},0\\leq a_i\\leq C\\leq 1000,0\\leq X\\leq 1000$ 。注意 $a_i$ 和 $C$ 可能为 $0$ 。\n\n- 对于 $20\\%$ 的数据， $n=9,C=4$ 。\n- 对于另外 $15\\%$ 的数据， $n\\leq 10^5,C=2$ 。\n- 对于另外 $15\\%$ 的数据， $X\\leq 5,C\\leq 10$ 。\n- 对于另外 $10\\%$ 的数据， $X=0$ 。\n- 对于另外 $20\\%$ 的数据， $n\\leq 10^5$ 。\n- 对于余下 $20\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] Cards", "background": "", "description": "There is a deck of cards. There are $n$ types of cards, labeled $1,2,\\ldots,n$, and each type has $C$ cards. Therefore, the deck contains a total of $nC$ cards.\n\nThree consecutive cards $(i,i+1,i+2)$ or three identical cards $(i,i,i)$ can form a **set**. If a multiset of cards can be divided into several (possibly zero) **sets**, then it is called a **winning hand**.\n\nYou have drawn some initial cards from the deck. Now you want to pick some cards to form a winning hand. How many different winning hands can you form? Output the answer modulo $998244353$. **That is, based on the initial cards, you may select some additional cards (or select none).**\n\nTwo groups of cards are considered the same if and only if, for every card type, the quantities of that type in the two groups are the same.", "inputFormat": "The first line contains two integers $n,C$, representing the number of card types and the number of cards of each type.\n\nThe second line contains one integer $X$, representing the number of types present in the initial cards.\n\nThe next $X$ lines each contain two integers $k_i,a_i$, meaning that there are $a_i$ cards of type $k_i$ in the initial cards. The values $k_i$ are given in strictly increasing order.", "outputFormat": "Output one line with one non-negative integer, the answer modulo $998244353$.", "hint": "### Sample Explanation 1\n\nAll valid choices are as follows:\n\n1. $\\{\\}$ (choose no cards)\n2. $\\{1,1,1\\}$\n3. $\\{2,2,2\\}$\n4. $\\{3,3,3\\}$\n5. $\\{1,2,3\\}$\n6. $\\{1,1,1,2,2,2\\}$\n7. $\\{1,1,1,3,3,3\\}$\n8. $\\{2,2,2,3,3,3\\}$\n9. $\\{1,1,2,2,3,3\\}$\n10. $\\{1,1,1,2,2,2,3,3,3\\}$\n\n### Constraints\n\nFor all testdata, $1\\leq n\\leq 10^{18}$, $0\\leq a_i\\leq C\\leq 1000$, and $0\\leq X\\leq 1000$. Note that $a_i$ and $C$ may be $0$.\n\n- For $20\\%$ of the data, $n=9$ and $C=4$.\n- For another $15\\%$ of the data, $n\\leq 10^5$ and $C=2$.\n- For another $15\\%$ of the data, $X\\leq 5$ and $C\\leq 10$.\n- For another $10\\%$ of the data, $X=0$.\n- For another $20\\%$ of the data, $n\\leq 10^5$.\n- For the remaining $20\\%$ of the data, there are no special restrictions.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 纸牌", "background": null, "description": "有一副纸牌。牌一共有 $n$ 种，分别标有 $1,2,...,n$ ，每种有 $C$ 张。故这副牌总共有 $nC$ 张。\n\n三张连号的牌 $(i,i+1,i+2)$ 或三张相同的牌 $(i,i,i)$ 可以组成一**叠**。如果一组牌可以分成若干（包括零）**叠**，就称其为一组**王牌**。\n\n你从牌堆中摸了一些初始牌。现在你想挑出一些牌组成一组王牌，请问有多少种可能组成的王牌呢？答案对 $998244353$ 取模。**也就是说，需要在初始牌的基础上再选一些牌（也可以不再选）。**\n\n两组牌相同当且仅当它们含有的每一种牌数量都相同。", "inputFormat": "第 $1$ 行两个整数 $n,C$ 表示牌的种类数和每种的张数；\n\n第 $2$ 行一个整数 $X$ 表示初始牌的种类数；\n\n接下来 $X$ 行每行两个整数 $k_i,a_i$ ，表示初始牌中有 $a_i$ 张 $k_i$ 号牌。每行的 $k_i$ 依次递增。", "outputFormat": "输出 $1$ 行 $1$ 个自然数表示答案，对 $998244353$ 取模。", "hint": "### 样例解释1\n\n所有方案如下：\n\n1. $\\{\\}$ （不选任何牌）\n2. $\\{1,1,1\\}$\n3. $\\{2,2,2\\}$\n4. $\\{3,3,3\\}$\n5. $\\{1,2,3\\}$\n6. $\\{1,1,1,2,2,2\\}$\n7. $\\{1,1,1,3,3,3\\}$\n8. $\\{2,2,2,3,3,3\\}$\n9. $\\{1,1,2,2,3,3\\}$\n10. $\\{1,1,1,2,2,2,3,3,3\\}$\n\n### 数据范围\n\n对于所有数据， $1\\leq n\\leq 10^{18},0\\leq a_i\\leq C\\leq 1000,0\\leq X\\leq 1000$ 。注意 $a_i$ 和 $C$ 可能为 $0$ 。\n\n- 对于 $20\\%$ 的数据， $n=9,C=4$ 。\n- 对于另外 $15\\%$ 的数据， $n\\leq 10^5,C=2$ 。\n- 对于另外 $15\\%$ 的数据， $X\\leq 5,C\\leq 10$ 。\n- 对于另外 $10\\%$ 的数据， $X=0$ 。\n- 对于另外 $20\\%$ 的数据， $n\\leq 10^5$ 。\n- 对于余下 $20\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5372", "type": "P", "difficulty": 6, "samples": [["3 3\nnnn\nuuu\no<>\n<>n\n<>u\n<>o", "URLR"], ["5 5\nn<><>\nun<>n\nnuonu\nu<>un\n<><>u\n<><>o\n<><>n\n<><>u\n<><>n\n<><>u", "RLLRLRR"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "Special Judge", "陕西"], "title": "[SNOI2019] 积木", "background": "", "description": "有一块 $n$ 行 $m$ 列的网格板， $n,m$ 都是奇数。网格上平铺着一些 $1\\times 2$ 的积木。积木可以旋转，不能重叠。这些积木共有 $\\frac{nm-1}{2}$ 块，也就是说，网格板上只有一格的空位。\n\n你可以做两种操作：\n\n1. 将一块与空白格相邻（指有公共边）的积木旋转 $90^\\circ$ 到空白格中；\n2. 将一块与空白格积木相邻的积木平移至空白格中。\n\n如图所示（被移动的积木颜色较浅）：\n\n![](https://cdn.luogu.com.cn/upload/pic/58669.png)\n\n请你用以上两种操作将给定的网格板变换为指定的状态。", "inputFormat": "第一行两个正奇数 $n,m$ ，分别表示网格的行数和列数。\n\n接下来 $n$ 行，每行 $m$ 个字符，描述网格板的初始状态：\n\n- `<`表示这个格子是一块积木的左半部分；\n- `>`表示这个格子是一块积木的右半部分；\n- `n`表示这个格子是一块积木的上半部分；\n- `u`表示这个格子是一块积木的下半部分；\n- `o`表示这个格子是空的。\n\n接下来另外 $n$ 行，每行 $m$ 个字符，描述你需要将网格板变成的目标状态，格式同上。\n\n", "outputFormat": "你需要输出一个字符串，按顺序表示你的操作：\n\n- `L`表示你移动了空白格左侧的积木；\n- `R`表示你移动了空白格右侧的积木；\n- `U`表示你移动了空白格上方的积木；\n- `D`表示你移动了空白格下方的积木。\n\n当然，没有操作的话输出空串就好了。\n\n", "hint": "#### 数据范围与说明\n\n你输出的操作序列长度不能超过 $8\\times 10^6$ 。\n\n对于所有数据， $1\\leq n,m\\leq 2000$ 。\n\n- 对于 $10\\%$ 的数据， $n,m\\leq 3$ ；\n- 对于另外 $10\\%$ 的数据， $n,m\\leq 5$ ；\n- 对于另外 $20\\%$ 的数据， $m=3$ ；\n- 对于另外 $20\\%$ 的数据， $n,m\\leq 50$ ；\n- 对于另外 $20\\%$ 的数据， $n,m\\leq 200$ ；\n- 对于余下 $20\\%$ 的数据，无特殊限制。\n\n#### SPJ 说明\n\n参考 https://www.luogu.org/discuss/show/114298 ，感谢 @M_sea 的贡献。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] Bricks", "background": "", "description": "There is a grid board with $n$ rows and $m$ columns, where both $n$ and $m$ are odd. Some $1\\times 2$ bricks are tiled on the grid. Bricks can be rotated and cannot overlap. There are $\\frac{nm-1}{2}$ bricks in total, which means there is exactly one empty cell on the board.\n\nYou can perform two kinds of operations:\n\n1. Rotate a brick that is adjacent to the empty cell (sharing a common edge) by $90^\\circ$ into the empty cell.\n2. Translate a brick that is adjacent to the empty cell into the empty cell.\n\nAs shown in the figure (the moved brick is in a lighter color):\n\n![](https://cdn.luogu.com.cn/upload/pic/58669.png)\n\nPlease use the two operations above to transform the given grid board into the specified target state.", "inputFormat": "The first line contains two positive odd integers $n,m$, representing the number of rows and columns of the grid.\n\nThen follow $n$ lines, each containing $m$ characters, describing the initial state of the grid board:\n\n- `<` means this cell is the left half of a brick.\n- `>` means this cell is the right half of a brick.\n- `n` means this cell is the upper half of a brick.\n- `u` means this cell is the lower half of a brick.\n- `o` means this cell is empty.\n\nThen follow another $n$ lines, each containing $m$ characters, describing the target state you need to transform the board into, in the same format as above.", "outputFormat": "You need to output a string that represents your operations in order:\n\n- `L` means you moved the brick on the left side of the empty cell.\n- `R` means you moved the brick on the right side of the empty cell.\n- `U` means you moved the brick above the empty cell.\n- `D` means you moved the brick below the empty cell.\n\nOf course, if there are no operations, output an empty string.", "hint": "#### Constraints and Notes\n\nThe length of your output operation sequence must not exceed $8\\times 10^6$.\n\nFor all testdata, $1\\leq n,m\\leq 2000$.\n\n- For $10\\%$ of the testdata, $n,m\\leq 3$.\n- For another $10\\%$ of the testdata, $n,m\\leq 5$.\n- For another $20\\%$ of the testdata, $m=3$.\n- For another $20\\%$ of the testdata, $n,m\\leq 50$.\n- For another $20\\%$ of the testdata, $n,m\\leq 200$.\n- For the remaining $20\\%$ of the testdata, there are no special restrictions.\n\n#### SPJ Notes\n\nSee https://www.luogu.org/discuss/show/114298. Thanks to @M_sea for the contribution.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 积木", "background": "", "description": "有一块 $n$ 行 $m$ 列的网格板， $n,m$ 都是奇数。网格上平铺着一些 $1\\times 2$ 的积木。积木可以旋转，不能重叠。这些积木共有 $\\frac{nm-1}{2}$ 块，也就是说，网格板上只有一格的空位。\n\n你可以做两种操作：\n\n1. 将一块与空白格相邻（指有公共边）的积木旋转 $90^\\circ$ 到空白格中；\n2. 将一块与空白格积木相邻的积木平移至空白格中。\n\n如图所示（被移动的积木颜色较浅）：\n\n![](https://cdn.luogu.com.cn/upload/pic/58669.png)\n\n请你用以上两种操作将给定的网格板变换为指定的状态。", "inputFormat": "第一行两个正奇数 $n,m$ ，分别表示网格的行数和列数。\n\n接下来 $n$ 行，每行 $m$ 个字符，描述网格板的初始状态：\n\n- `<`表示这个格子是一块积木的左半部分；\n- `>`表示这个格子是一块积木的右半部分；\n- `n`表示这个格子是一块积木的上半部分；\n- `u`表示这个格子是一块积木的下半部分；\n- `o`表示这个格子是空的。\n\n接下来另外 $n$ 行，每行 $m$ 个字符，描述你需要将网格板变成的目标状态，格式同上。\n\n", "outputFormat": "你需要输出一个字符串，按顺序表示你的操作：\n\n- `L`表示你移动了空白格左侧的积木；\n- `R`表示你移动了空白格右侧的积木；\n- `U`表示你移动了空白格上方的积木；\n- `D`表示你移动了空白格下方的积木。\n\n当然，没有操作的话输出空串就好了。\n\n", "hint": "#### 数据范围与说明\n\n你输出的操作序列长度不能超过 $8\\times 10^6$ 。\n\n对于所有数据， $1\\leq n,m\\leq 2000$ 。\n\n- 对于 $10\\%$ 的数据， $n,m\\leq 3$ ；\n- 对于另外 $10\\%$ 的数据， $n,m\\leq 5$ ；\n- 对于另外 $20\\%$ 的数据， $m=3$ ；\n- 对于另外 $20\\%$ 的数据， $n,m\\leq 50$ ；\n- 对于另外 $20\\%$ 的数据， $n,m\\leq 200$ ；\n- 对于余下 $20\\%$ 的数据，无特殊限制。\n\n#### SPJ 说明\n\n参考 https://www.luogu.org/discuss/show/114298 ，感谢 @M_sea 的贡献。", "locale": "zh-CN"}}}
{"pid": "P5373", "type": "P", "difficulty": 7, "samples": [["5 1\n1 9 2 6 0 8\n1 7\n", "26 497 4900 29498 96040 134456 \n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式复合函数", "background": "有一天，NaCly_Fish看见 $\\mathsf r \\color{red} \\mathsf{qy}$ 在群里说：“终于把多项式复合写完啦！qwq”  \n她便好奇地去问 $\\mathsf r \\color{red} \\mathsf{qy}$：“这个东西怎么写啊？”   \n\n$\\mathsf r \\color{red} \\mathsf{qy}$ 只丢给了她一份嘤文的 pdf，然而她根本看不懂。  \n于是她求助于你，希望你能帮她解决这个难题。", "description": "给定一个 $n$ 次多项式 $F(x)$，和一个 $m$ 次多项式 $G(x)$，你需要求一个 $n$ 次多项式 $H(x)$ ，满足条件：  \n$$H(x) \\equiv F(G(x))\\space (\\text{mod }x^{n+1})$$   \n换种说法，你要求的多项式应满足：  \n$$H(x) \\equiv \\sum\\limits_{i=0}^n [x^i]F(x)\\times G(x)^i \\space (\\text{mod }x^{n+1})$$\n将结果的各项系数对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$ ，分别表示 $F(x)$ 和 $G(x)$ 的次数   \n第二行 $n+1$ 个非负整数 $f_i$，表示 $F(x)$ 的 $i$ 次项系数   \n第三行 $m+1$ 个非负整数 $g_i$，表示 $G(x)$ 的 $i$ 次项系数   ", "outputFormat": "输出一行 $n+1$ 个非负整数，从低到高表示 $H(x)$ 的系数", "hint": "**数据范围：**  \n$1\\le m \\le n \\le 20000$    \n$f_i,g_i \\in [0,998244353)\\cap \\mathbb Z$", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Polynomial Composition Function.", "background": "One day, NaCly_Fish saw $\\mathsf r \\color{red} \\mathsf{qy}$ say in the group chat: “I finally finished writing polynomial composition! qwq”.  \nSo she curiously asked $\\mathsf r \\color{red} \\mathsf{qy}$: “How do you write this thing?”.  \n\n$\\mathsf r \\color{red} \\mathsf{qy}$ only threw her a PDF in “Yingwen” (pinyin), but she could not understand it at all.  \nSo she asked you for help, hoping you can help her solve this difficult problem.", "description": "Given an $n$-degree polynomial $F(x)$ and an $m$-degree polynomial $G(x)$, you need to find an $n$-degree polynomial $H(x)$ that satisfies:  \n$$H(x) \\equiv F(G(x))\\space (\\text{mod }x^{n+1})$$  \nIn other words, the polynomial you need should satisfy:  \n$$H(x) \\equiv \\sum\\limits_{i=0}^n [x^i]F(x)\\times G(x)^i \\space (\\text{mod }x^{n+1})$$  \nTake all coefficients of the result modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n,m$, representing the degrees of $F(x)$ and $G(x)$.  \nThe second line contains $n+1$ non-negative integers $f_i$, representing the coefficient of the $x^i$ term of $F(x)$.  \nThe third line contains $m+1$ non-negative integers $g_i$, representing the coefficient of the $x^i$ term of $G(x)$.", "outputFormat": "Output one line with $n+1$ non-negative integers, from low degree to high degree, representing the coefficients of $H(x)$.", "hint": "**Constraints:**  \n$1\\le m \\le n \\le 20000$  \n$f_i,g_i \\in [0,998244353)\\cap \\mathbb Z$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式复合函数", "background": "有一天，NaCly_Fish看见 $\\mathsf r \\color{red} \\mathsf{qy}$ 在群里说：“终于把多项式复合写完啦！qwq”  \n她便好奇地去问 $\\mathsf r \\color{red} \\mathsf{qy}$：“这个东西怎么写啊？”   \n\n$\\mathsf r \\color{red} \\mathsf{qy}$ 只丢给了她一份嘤文的 pdf，然而她根本看不懂。  \n于是她求助于你，希望你能帮她解决这个难题。", "description": "给定一个 $n$ 次多项式 $F(x)$，和一个 $m$ 次多项式 $G(x)$，你需要求一个 $n$ 次多项式 $H(x)$ ，满足条件：  \n$$H(x) \\equiv F(G(x))\\space (\\text{mod }x^{n+1})$$   \n换种说法，你要求的多项式应满足：  \n$$H(x) \\equiv \\sum\\limits_{i=0}^n [x^i]F(x)\\times G(x)^i \\space (\\text{mod }x^{n+1})$$\n将结果的各项系数对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$ ，分别表示 $F(x)$ 和 $G(x)$ 的次数   \n第二行 $n+1$ 个非负整数 $f_i$，表示 $F(x)$ 的 $i$ 次项系数   \n第三行 $m+1$ 个非负整数 $g_i$，表示 $G(x)$ 的 $i$ 次项系数   ", "outputFormat": "输出一行 $n+1$ 个非负整数，从低到高表示 $H(x)$ 的系数", "hint": "**数据范围：**  \n$1\\le m \\le n \\le 20000$    \n$f_i,g_i \\in [0,998244353)\\cap \\mathbb Z$", "locale": "zh-CN"}}}
{"pid": "P5374", "type": "P", "difficulty": 7, "samples": [["7\n1 1 2 3 5 2\n5\n5 1 5 0\n2 0 5 0\n2 2 4 5\n7 2 2 4\n3 2 5 4", "2\n3\n69\n57\n70"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2019", "O2优化", "THUPC"], "title": "[THUPC 2019] 不用找的树", "background": "", "description": "给出一棵 $n$ 个节点的树，结点标号从 $1$ 到 $n$ 。\n\n定义树上两点 $a,b$ 的距离 $d(a,b)$ 是最小的非负整数 $k$ ，满足存在结点序列 $v_0,v_1,...,v_k$ ，满足 $v_0=a,v_k=b$ ，且对于 $0\\leq i\\leq k-1$ 有 $v_i$ 和 $v_{i+1}$ 之间在树上有一条边相连。\n\n有 $m$ 个询问，每个询问包含参数 $p_0,d_0,p_1,d_1$ ，求：\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$\n\n", "inputFormat": "第一行一个整数 $n$ ，表示树的节点数目。\n\n接下来一行 $n-1$ 个整数 $f_2,f_3,...,f_n$ ，依次表示 $i$ 和 $f_i$ （ $1\\leq f_i\\leq i-1$ ）之间有一条边。\n\n接下来一行一个整数 $m$ ，表示询问数目。\n\n接下来 $m$ 行依次描述所有询问：每行四个证书 $p_0,d_0,p_1,d_1$ （ $1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$ ）描述一组询问。\n\n保证 $1\\leq n\\leq 10^5,1\\leq m\\leq 10^5$ 。\n\n", "outputFormat": "共 $m$ 行，依次回答各组询问：每行输出一行一个整数表示这组询问的答案。", "hint": "##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] A Tree You Do Not Need to Search", "background": "", "description": "You are given a tree with $n$ nodes, numbered from $1$ to $n$.\n\nDefine the distance $d(a,b)$ between two nodes $a,b$ on the tree as the smallest non-negative integer $k$ such that there exists a node sequence $v_0,v_1,...,v_k$ with $v_0=a$, $v_k=b$, and for every $0\\leq i\\leq k-1$, there is an edge directly connecting $v_i$ and $v_{i+1}$ in the tree.\n\nThere are $m$ queries. Each query contains parameters $p_0,d_0,p_1,d_1$. Compute:\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$", "inputFormat": "The first line contains an integer $n$, the number of nodes in the tree.\n\nThe next line contains $n-1$ integers $f_2,f_3,...,f_n$, indicating that there is an edge between $i$ and $f_i$ ($1\\leq f_i\\leq i-1$).\n\nThe next line contains an integer $m$, the number of queries.\n\nThe next $m$ lines describe the queries. Each line contains four integers $p_0,d_0,p_1,d_1$ ($1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$), describing one query.\n\nConstraints: $1\\leq n\\leq 10^5,1\\leq m\\leq 10^5$.", "outputFormat": "Output $m$ lines. For each query, output one integer on its own line, which is the answer to that query.", "hint": "##### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 不用找的树", "background": "", "description": "给出一棵 $n$ 个节点的树，结点标号从 $1$ 到 $n$ 。\n\n定义树上两点 $a,b$ 的距离 $d(a,b)$ 是最小的非负整数 $k$ ，满足存在结点序列 $v_0,v_1,...,v_k$ ，满足 $v_0=a,v_k=b$ ，且对于 $0\\leq i\\leq k-1$ 有 $v_i$ 和 $v_{i+1}$ 之间在树上有一条边相连。\n\n有 $m$ 个询问，每个询问包含参数 $p_0,d_0,p_1,d_1$ ，求：\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$\n\n", "inputFormat": "第一行一个整数 $n$ ，表示树的节点数目。\n\n接下来一行 $n-1$ 个整数 $f_2,f_3,...,f_n$ ，依次表示 $i$ 和 $f_i$ （ $1\\leq f_i\\leq i-1$ ）之间有一条边。\n\n接下来一行一个整数 $m$ ，表示询问数目。\n\n接下来 $m$ 行依次描述所有询问：每行四个证书 $p_0,d_0,p_1,d_1$ （ $1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$ ）描述一组询问。\n\n保证 $1\\leq n\\leq 10^5,1\\leq m\\leq 10^5$ 。\n\n", "outputFormat": "共 $m$ 行，依次回答各组询问：每行输出一行一个整数表示这组询问的答案。", "hint": "##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5375", "type": "P", "difficulty": 3, "samples": [["6\n1 1\n1 2\n1 3\n2 1\n2 2\n2 3", "Yes\nNo\nNo\nYes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "THUPC"], "title": "[THUPC 2019] 组合数据结构问题", "background": "", "description": "> 众所周知，小葱同学擅长计算，尤其擅长计算组合数，但这个题和组合数没什么关系。\n\n小葱同学在学习了组合数的计算之后，开始了研究数据结构的道路。通过十五分钟的刻苦学习，小葱同学初步掌握了队列、栈和堆这三种数据结构。小葱同学发现这三种数据结构都支持两种操作：\n\n1. 将某个数插入该数据结构。\n2. 从该数据结构中按照数据结构的原理取出一个数。\n\n小葱同学为了检验自己对这三种数据结构的理解，设计了一个类似的黑箱模型。该模型也支持两种操作，向黑箱中输入一个数或者从黑箱中输出一个数。现在小葱对该黑箱做了若干次操作，并给出每次输入和输出的数，问这个黑箱实现的是否可能是队列、栈、大根堆或者小根堆。\n\n虽然小葱同学对这四种数据结构了如指掌，但他还是决定告诉你它们的分别是什么：\n\n- 如果黑箱是**队列**：黑箱初始为空，输入时数将被放入黑箱，输出时当前黑箱内**最早被放入的**数将被输出并移出黑箱。\n- 如果黑箱是**栈**：黑箱初始为空，输入时数将被放入黑箱，输出时当前黑箱内**最晚被放入的**数将被输出并移出黑箱。\n- 如果黑箱是**大根堆**：黑箱初始为空，输入时数将被放入黑箱，输出时当前黑箱内**值最大的**数将被输出并移出黑箱。特别地，如值最大的数有多个，则仅将其中一个移出黑箱。\n- 如果黑箱是**小根堆**：黑箱初始为空，输入时数将被放入黑箱，输出时当前黑箱内**值最小的**数将被输出并移出黑箱。特别地，如值最小的数有多个，则仅将其中一个移出黑箱。\n\n", "inputFormat": "第一行一个整数 $N$  代表操作的个数。\n\n接下来 $N$ 行每行两个整数 $\\mathrm{opt},v$ 。如果 $\\mathrm{opt}=1$ ，代表这次操作小葱同学向黑箱中插入 $v$ 了这个数；如果 $\\mathrm{opt=2}$ ，代表小葱这次操作从黑箱中取出了 $v$ 这个数。\n\n保证 $0\\leq N\\leq 10^5$ ，$-2^{31}\\leq v<2^{31}$ ，$\\mathrm{opt}\\in\\{1,2\\}$  。\n\n注意输入的数据仅保证在格式和范围上完全正确，不保证任何其他条件。", "outputFormat": "共四行，每行可能是 `Yes` 或者 `No`，分别依次代表该黑箱是否可能是队列、栈、大根堆或者小根堆。", "hint": "##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Combined Data Structure Problem", "background": "", "description": "> As everyone knows, student Xiaocong is good at calculations, especially at calculating binomial coefficients, but this problem has little to do with binomial coefficients.\n\nAfter learning how to compute binomial coefficients, Xiaocong started studying data structures. After fifteen minutes of hard study, Xiaocong initially mastered three data structures: queue, stack, and heap. Xiaocong found that these three data structures all support two operations:\n\n1. Insert a number into the data structure.\n2. Remove a number from the data structure according to its rules.\n\nTo test his understanding of these three data structures, Xiaocong designed a similar black-box model. This model also supports two operations: input a number into the black box, or output a number from the black box. Now Xiaocong has performed several operations on this black box and provided the number inserted and the number output each time. You are asked whether this black box could possibly be a queue, a stack, a max-heap, or a min-heap.\n\nAlthough Xiaocong knows these four data structures very well, he still decided to tell you how they differ:\n\n- If the black box is a **queue**: the black box is initially empty. On input, the number is placed into the black box. On output, the number that was **inserted earliest** among the current elements in the black box is output and removed.\n- If the black box is a **stack**: the black box is initially empty. On input, the number is placed into the black box. On output, the number that was **inserted latest** among the current elements in the black box is output and removed.\n- If the black box is a **max-heap**: the black box is initially empty. On input, the number is placed into the black box. On output, the **largest value** among the current elements in the black box is output and removed. In particular, if there are multiple largest values, only one of them is removed.\n- If the black box is a **min-heap**: the black box is initially empty. On input, the number is placed into the black box. On output, the **smallest value** among the current elements in the black box is output and removed. In particular, if there are multiple smallest values, only one of them is removed.", "inputFormat": "The first line contains an integer $N$, which represents the number of operations.\n\nThe next $N$ lines each contain two integers $\\mathrm{opt}, v$. If $\\mathrm{opt}=1$, it means that in this operation Xiaocong inserted the number $v$ into the black box. If $\\mathrm{opt}=2$, it means that in this operation Xiaocong removed the number $v$ from the black box.\n\nIt is guaranteed that $0\\leq N\\leq 10^5$, $-2^{31}\\leq v<2^{31}$, and $\\mathrm{opt}\\in\\{1,2\\}$.\n\nNote that the input data is only guaranteed to be completely correct in format and within the ranges, and no other conditions are guaranteed.", "outputFormat": "There are four lines in total. Each line is either `Yes` or `No`, indicating whether the black box could possibly be a queue, a stack, a max-heap, or a min-heap, respectively, in this order.", "hint": "##### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nSolutions and other resources can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 组合数据结构问题", "background": "", "description": "> 众所周知，小葱同学擅长计算，尤其擅长计算组合数，但这个题和组合数没什么关系。\n\n小葱同学在学习了组合数的计算之后，开始了研究数据结构的道路。通过十五分钟的刻苦学习，小葱同学初步掌握了队列、栈和堆这三种数据结构。小葱同学发现这三种数据结构都支持两种操作：\n\n1. 将某个数插入该数据结构。\n2. 从该数据结构中按照数据结构的原理取出一个数。\n\n小葱同学为了检验自己对这三种数据结构的理解，设计了一个类似的黑箱模型。该模型也支持两种操作，向黑箱中输入一个数或者从黑箱中输出一个数。现在小葱对该黑箱做了若干次操作，并给出每次输入和输出的数，问这个黑箱实现的是否可能是队列、栈、大根堆或者小根堆。\n\n虽然小葱同学对这四种数据结构了如指掌，但他还是决定告诉你它们的分别是什么：\n\n- 如果黑箱是**队列**：黑箱初始为空，输入时数将被放入黑箱，输出时当前黑箱内**最早被放入的**数将被输出并移出黑箱。\n- 如果黑箱是**栈**：黑箱初始为空，输入时数将被放入黑箱，输出时当前黑箱内**最晚被放入的**数将被输出并移出黑箱。\n- 如果黑箱是**大根堆**：黑箱初始为空，输入时数将被放入黑箱，输出时当前黑箱内**值最大的**数将被输出并移出黑箱。特别地，如值最大的数有多个，则仅将其中一个移出黑箱。\n- 如果黑箱是**小根堆**：黑箱初始为空，输入时数将被放入黑箱，输出时当前黑箱内**值最小的**数将被输出并移出黑箱。特别地，如值最小的数有多个，则仅将其中一个移出黑箱。\n\n", "inputFormat": "第一行一个整数 $N$  代表操作的个数。\n\n接下来 $N$ 行每行两个整数 $\\mathrm{opt},v$ 。如果 $\\mathrm{opt}=1$ ，代表这次操作小葱同学向黑箱中插入 $v$ 了这个数；如果 $\\mathrm{opt=2}$ ，代表小葱这次操作从黑箱中取出了 $v$ 这个数。\n\n保证 $0\\leq N\\leq 10^5$ ，$-2^{31}\\leq v<2^{31}$ ，$\\mathrm{opt}\\in\\{1,2\\}$  。\n\n注意输入的数据仅保证在格式和范围上完全正确，不保证任何其他条件。", "outputFormat": "共四行，每行可能是 `Yes` 或者 `No`，分别依次代表该黑箱是否可能是队列、栈、大根堆或者小根堆。", "hint": "##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5376", "type": "P", "difficulty": 6, "samples": [["3 3 1\n2 2", "24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "组合数学", "排列组合", "容斥原理", "Lucas 定理", "THUPC"], "title": "[THUPC 2019] 过河卒二", "background": "", "description": "> 首先我们回忆一下经典难题过河卒问题：\n>\n> 棋盘上 $A$ 点有一个过河卒，需要走到目标 $B$ 点。卒行走的规则：可以向上、或者向右。同时在棋盘上 $C$ 点有一个对方的马，该马所在的点和所有跳跃一步可达的点称为对方马的控制点，因此称之为「马拦过河卒」。\n>\n> 棋盘用坐标表示，$A$ 点 $(1,1)$ 、$B$ 点 $(N,M)$ ，同样马的位置坐标是需要给出的。\n>\n> 现在要求你计算出卒从 $A$ 点能够到达 $B$ 点的路径的条数，假设马的位置是固定不动的，并不是卒走一步马走一步。\n>\n> **请注意，上述背景内容与本题无关！**\n\nKiana 喜欢玩象棋，尤其是喜欢用象棋玩过河卒的游戏。在传统的过河卒问题中，Kiana 需要控制一个卒从起点走到终点，在路中避开一个对方的马的攻击，然后假装不会算并询问你从起点到终点的路径总数。\n\n在今天的过河卒二游戏中，Kiana 还是控制一个卒在一个 $N\\times M$ 的棋盘上移动，初始时卒位于左下方坐标为 $(1,1)$ 位置，但为了增加难度，Kiana 对游戏规则做出了一些修改。传统的过河卒每步只能向上或向右移动 $1$ 格，Kiana 规定自己的过河卒二还可以在一步中向右上方移动 $1$ 格，即如果当前卒位于坐标 $(x,y)$ 处，则下一步可以走到 $(x+1,y)$ 、$(x,y+1)$ 或 $(x+1,y+1)$ 中的任意一格里面去，同时 Kiana 认为，如果两种移动方案在某一步时卒移动的方向（右、上或右上）不同，则两种方案就是不同的，例如从 $(1,1)$ 先走到 $(1,2)$ 再走到 $(2,2)$ 、从 $(1,1)$ 先走到 $(2,1)$ 再走到 $(2,2)$ 和从 $(1,1)$ 直接走到 $(2,2)$ 是三种不同的移动方案。\n\n其次，过河卒二的终点不再是一个特定的位置，Kiana 规定卒可以从棋盘的上方或右方走出棋盘，此时就视为游戏成功。注意在走出棋盘时仍然有方向选择的不同，例如若过河卒位于 $(1,M)$ 处，则下一步它可以向右或者向右上用两种方式走出棋盘，若过河卒位于 $(N,M)$ 处，则下一步它可以向上、向右或者向右上用三种方式走出棋盘，以不同的方式走出棋盘仍然被算作是不同的移动方案。\n\n此外，对方马的攻击范围不再是有规律的几个位置，而是 Kiana 规定好的 $K$ 个特定坐标，并要求过河卒在移动的过程中不能走到这 $K$ 个坐标的任何一个上，在除这些坐标以外的位置上过河卒都可以按规则自由移动。\n\n现在 Kiana 想知道，过河卒二有多少种不同的移动方案可以走出棋盘，这个答案可能非常大，她只想知道方案数对 $59393$ 取模后的结果。由于她不会算，所以希望由你来告诉她。\n\n", "inputFormat": "第一行包含三个整数 $N$ 、$M$ 和 $K$ ，分别表示棋盘的坐标范围与对方马的攻击格子数（即 Kiana 规定的不能经过的坐标数）。\n\n接下来 $K$ 行，第 $i$ 行包含两个正整数 $X_i$ 和 $Y_i$ ，表示对方马的第 $i$ 个攻击坐标为 $(X_i,Y_i)$ 。\n\n对于所有数据，保证 $1\\leq N\\leq 10^9,1\\leq M\\leq 10^5,0\\leq K\\leq 20,1\\leq X_i\\leq N,1\\leq Y_i\\leq M$，$(1,1)$ 一定不会被对方马攻击，且被攻击的格子中不存在两个坐标相同的格子。", "outputFormat": "输出一行一个整数，表示过河卒走出棋盘的方案数对 $59393$ 取模后的结果。\n\n", "hint": "### 样例解释\n\n用 $\\uparrow$ 表示过河卒向上移动了一格，用 $\\rightarrow$ 表示过河卒向右移动了一格，用 $\\nearrow$ 表示过河卒向右上移动了一格，由此可以简化样例解释的表述。\n\n$24$ 种移动方案如下：\n\n$(\\uparrow\\uparrow\\uparrow)$、$(\\uparrow\\uparrow\\nearrow)$、$(\\uparrow\\uparrow\\rightarrow\\uparrow)$、$(\\uparrow\\uparrow\\rightarrow\\nearrow)$、\n\n$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\uparrow)$、$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\nearrow)$、$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\rightarrow)$、$(\\uparrow\\nearrow\\uparrow)$、\n\n$(\\uparrow\\nearrow\\nearrow)$、$(\\uparrow\\nearrow\\rightarrow\\uparrow)$、$(\\uparrow\\nearrow\\rightarrow\\nearrow)$、$(\\uparrow\\nearrow\\rightarrow\\rightarrow)$、\n\n$(\\rightarrow\\rightarrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\nearrow)$、$(\\rightarrow\\rightarrow\\uparrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\uparrow\\nearrow)$、\n\n$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\nearrow)$、$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\uparrow)$、$(\\rightarrow\\nearrow\\rightarrow)$、\n\n$(\\rightarrow\\nearrow\\nearrow)$、$(\\rightarrow\\nearrow\\uparrow\\rightarrow)$、$(\\rightarrow\\nearrow\\uparrow\\nearrow)$、$(\\rightarrow\\nearrow\\uparrow\\uparrow)$。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] River-Crossing Pawn II", "background": "", "description": "> First, let us recall the classic difficult problem, River-Crossing Pawn:\n>\n> On a chessboard, there is a river-crossing pawn at point $A$ that needs to move to the target point $B$. The pawn moves by the following rules: it can move up, or move right. Meanwhile, there is an opponent knight at point $C$. The knight’s position and all positions it can reach by one knight move are called the opponent knight’s controlled points, hence the name “the knight blocks the river-crossing pawn”.\n>\n> The chessboard is represented by coordinates: $A$ is $(1,1)$, $B$ is $(N,M)$, and the knight’s coordinate is also given.\n>\n> Now you are asked to compute the number of paths for the pawn to get from $A$ to $B$, assuming the knight stays fixed and does not move after each pawn move.\n>\n> **Note that the background above is unrelated to this problem!**\n\nKiana likes playing Chinese chess, and she especially likes using Chinese chess pieces to play the river-crossing pawn game. In the traditional river-crossing pawn problem, Kiana needs to control a pawn to move from the start to the end, avoiding the attacks of an opponent knight on the way, and then pretends she cannot calculate it and asks you for the total number of paths from the start to the end.\n\nIn today’s River-Crossing Pawn II game, Kiana still controls a pawn moving on an $N\\times M$ board. Initially, the pawn is at the bottom-left position with coordinate $(1,1)$. To make the game harder, Kiana changes some rules. In the traditional version, the pawn can only move up or right by $1$ cell each step. Kiana allows her River-Crossing Pawn II to also move up-right by $1$ cell in one step. That is, if the pawn is currently at $(x,y)$, then the next step can go to any of $(x+1,y)$, $(x,y+1)$, or $(x+1,y+1)$. Kiana also considers that if two movement plans differ in the moving direction (right, up, or up-right) at any step, then they are different plans. For example, from $(1,1)$ to $(1,2)$ then to $(2,2)$, from $(1,1)$ to $(2,1)$ then to $(2,2)$, and from $(1,1)$ directly to $(2,2)$ are three different movement plans.\n\nSecond, the goal of River-Crossing Pawn II is no longer a specific position. Kiana defines that the pawn may leave the board from the top side or the right side, and then the game is considered successful. Note that when leaving the board, there are still different direction choices. For example, if the pawn is at $(1,M)$, then in the next step it can leave the board in two ways: right or up-right. If the pawn is at $(N,M)$, then in the next step it can leave the board in three ways: up, right, or up-right. Leaving the board in different ways is still counted as different movement plans.\n\nIn addition, the opponent knight’s attack range is no longer a few regular positions. Instead, Kiana specifies $K$ particular coordinates, and the pawn is not allowed to step on any of these $K$ coordinates during its movement. On all other positions, the pawn may move freely according to the rules.\n\nNow Kiana wants to know how many different movement plans allow the pawn to leave the board. The answer can be very large; she only wants the result modulo $59393$. Since she cannot compute it, she asks you to tell her.", "inputFormat": "The first line contains three integers $N$, $M$, and $K$, representing the coordinate ranges of the board and the number of squares attacked by the opponent knight (i.e., the number of coordinates that Kiana specifies as forbidden).\n\nThe next $K$ lines each contain two positive integers $X_i$ and $Y_i$, meaning the $i$-th attacked coordinate is $(X_i,Y_i)$.\n\nFor all data, it is guaranteed that $1\\leq N\\leq 10^9$, $1\\leq M\\leq 10^5$, $0\\leq K\\leq 20$, $1\\leq X_i\\leq N$, $1\\leq Y_i\\leq M$. The cell $(1,1)$ is definitely not attacked by the opponent knight, and among the attacked cells there are no two cells with the same coordinate.", "outputFormat": "Output one line with one integer, the number of movement plans for the pawn to leave the board modulo $59393$.", "hint": "### Sample Explanation\n\nUse $\\uparrow$ to represent that the pawn moves up by one cell, use $\\rightarrow$ to represent that the pawn moves right by one cell, and use $\\nearrow$ to represent that the pawn moves up-right by one cell. This can simplify the description of the sample explanation.\n\nThe $24$ movement plans are:\n\n$(\\uparrow\\uparrow\\uparrow)$、$(\\uparrow\\uparrow\\nearrow)$、$(\\uparrow\\uparrow\\rightarrow\\uparrow)$、$(\\uparrow\\uparrow\\rightarrow\\nearrow)$、\n\n$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\uparrow)$、$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\nearrow)$、$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\rightarrow)$、$(\\uparrow\\nearrow\\uparrow)$、\n\n$(\\uparrow\\nearrow\\nearrow)$、$(\\uparrow\\nearrow\\rightarrow\\uparrow)$、$(\\uparrow\\nearrow\\rightarrow\\nearrow)$、$(\\uparrow\\nearrow\\rightarrow\\rightarrow)$、\n\n$(\\rightarrow\\rightarrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\nearrow)$、$(\\rightarrow\\rightarrow\\uparrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\uparrow\\nearrow)$、\n\n$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\nearrow)$、$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\uparrow)$、$(\\rightarrow\\nearrow\\rightarrow)$、\n\n$(\\rightarrow\\nearrow\\nearrow)$、$(\\rightarrow\\nearrow\\uparrow\\rightarrow)$、$(\\rightarrow\\nearrow\\uparrow\\nearrow)$、$(\\rightarrow\\nearrow\\uparrow\\uparrow)$。\n\n### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as editorial solutions can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 过河卒二", "background": "", "description": "> 首先我们回忆一下经典难题过河卒问题：\n>\n> 棋盘上 $A$ 点有一个过河卒，需要走到目标 $B$ 点。卒行走的规则：可以向上、或者向右。同时在棋盘上 $C$ 点有一个对方的马，该马所在的点和所有跳跃一步可达的点称为对方马的控制点，因此称之为「马拦过河卒」。\n>\n> 棋盘用坐标表示，$A$ 点 $(1,1)$ 、$B$ 点 $(N,M)$ ，同样马的位置坐标是需要给出的。\n>\n> 现在要求你计算出卒从 $A$ 点能够到达 $B$ 点的路径的条数，假设马的位置是固定不动的，并不是卒走一步马走一步。\n>\n> **请注意，上述背景内容与本题无关！**\n\nKiana 喜欢玩象棋，尤其是喜欢用象棋玩过河卒的游戏。在传统的过河卒问题中，Kiana 需要控制一个卒从起点走到终点，在路中避开一个对方的马的攻击，然后假装不会算并询问你从起点到终点的路径总数。\n\n在今天的过河卒二游戏中，Kiana 还是控制一个卒在一个 $N\\times M$ 的棋盘上移动，初始时卒位于左下方坐标为 $(1,1)$ 位置，但为了增加难度，Kiana 对游戏规则做出了一些修改。传统的过河卒每步只能向上或向右移动 $1$ 格，Kiana 规定自己的过河卒二还可以在一步中向右上方移动 $1$ 格，即如果当前卒位于坐标 $(x,y)$ 处，则下一步可以走到 $(x+1,y)$ 、$(x,y+1)$ 或 $(x+1,y+1)$ 中的任意一格里面去，同时 Kiana 认为，如果两种移动方案在某一步时卒移动的方向（右、上或右上）不同，则两种方案就是不同的，例如从 $(1,1)$ 先走到 $(1,2)$ 再走到 $(2,2)$ 、从 $(1,1)$ 先走到 $(2,1)$ 再走到 $(2,2)$ 和从 $(1,1)$ 直接走到 $(2,2)$ 是三种不同的移动方案。\n\n其次，过河卒二的终点不再是一个特定的位置，Kiana 规定卒可以从棋盘的上方或右方走出棋盘，此时就视为游戏成功。注意在走出棋盘时仍然有方向选择的不同，例如若过河卒位于 $(1,M)$ 处，则下一步它可以向右或者向右上用两种方式走出棋盘，若过河卒位于 $(N,M)$ 处，则下一步它可以向上、向右或者向右上用三种方式走出棋盘，以不同的方式走出棋盘仍然被算作是不同的移动方案。\n\n此外，对方马的攻击范围不再是有规律的几个位置，而是 Kiana 规定好的 $K$ 个特定坐标，并要求过河卒在移动的过程中不能走到这 $K$ 个坐标的任何一个上，在除这些坐标以外的位置上过河卒都可以按规则自由移动。\n\n现在 Kiana 想知道，过河卒二有多少种不同的移动方案可以走出棋盘，这个答案可能非常大，她只想知道方案数对 $59393$ 取模后的结果。由于她不会算，所以希望由你来告诉她。\n\n", "inputFormat": "第一行包含三个整数 $N$ 、$M$ 和 $K$ ，分别表示棋盘的坐标范围与对方马的攻击格子数（即 Kiana 规定的不能经过的坐标数）。\n\n接下来 $K$ 行，第 $i$ 行包含两个正整数 $X_i$ 和 $Y_i$ ，表示对方马的第 $i$ 个攻击坐标为 $(X_i,Y_i)$ 。\n\n对于所有数据，保证 $1\\leq N\\leq 10^9,1\\leq M\\leq 10^5,0\\leq K\\leq 20,1\\leq X_i\\leq N,1\\leq Y_i\\leq M$，$(1,1)$ 一定不会被对方马攻击，且被攻击的格子中不存在两个坐标相同的格子。", "outputFormat": "输出一行一个整数，表示过河卒走出棋盘的方案数对 $59393$ 取模后的结果。\n\n", "hint": "### 样例解释\n\n用 $\\uparrow$ 表示过河卒向上移动了一格，用 $\\rightarrow$ 表示过河卒向右移动了一格，用 $\\nearrow$ 表示过河卒向右上移动了一格，由此可以简化样例解释的表述。\n\n$24$ 种移动方案如下：\n\n$(\\uparrow\\uparrow\\uparrow)$、$(\\uparrow\\uparrow\\nearrow)$、$(\\uparrow\\uparrow\\rightarrow\\uparrow)$、$(\\uparrow\\uparrow\\rightarrow\\nearrow)$、\n\n$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\uparrow)$、$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\nearrow)$、$(\\uparrow\\uparrow\\rightarrow\\rightarrow\\rightarrow)$、$(\\uparrow\\nearrow\\uparrow)$、\n\n$(\\uparrow\\nearrow\\nearrow)$、$(\\uparrow\\nearrow\\rightarrow\\uparrow)$、$(\\uparrow\\nearrow\\rightarrow\\nearrow)$、$(\\uparrow\\nearrow\\rightarrow\\rightarrow)$、\n\n$(\\rightarrow\\rightarrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\nearrow)$、$(\\rightarrow\\rightarrow\\uparrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\uparrow\\nearrow)$、\n\n$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\rightarrow)$、$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\nearrow)$、$(\\rightarrow\\rightarrow\\uparrow\\uparrow\\uparrow)$、$(\\rightarrow\\nearrow\\rightarrow)$、\n\n$(\\rightarrow\\nearrow\\nearrow)$、$(\\rightarrow\\nearrow\\uparrow\\rightarrow)$、$(\\rightarrow\\nearrow\\uparrow\\nearrow)$、$(\\rightarrow\\nearrow\\uparrow\\uparrow)$。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5377", "type": "P", "difficulty": 5, "samples": [["2\n3\n4", "2\n4\n8"]], "limits": {"time": [1000], "memory": [512000]}, "tags": ["2019", "平面图欧拉公式", "组合数学", "排列组合", "THUPC"], "title": "[THUPC 2019] 鸽鸽的分割", "background": "", "description": "牛牛有一块蛋糕，他想把蛋糕分给小朋友们。蛋糕一开始是圆形的，牛牛会在圆周上选择 $n$ 个不重合的点，将这几个点两两用线段连接。这些线段将会把蛋糕分成若干块。\n\n现在，牛牛想知道，蛋糕**最多**会被分成多少块，请你告诉他答案。", "inputFormat": "输入包含至多 $20$ 行，每行一个整数 $n$，含义见「题目描述」。保证 $0\\le n \\le 64$。", "outputFormat": "依次回答牛牛的每个问题，对于每个问题，输出一行，包含一个整数表示答案。", "hint": "### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/pic/58696.png)\n\n##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Gege's Partitioning.", "background": "", "description": "Niuniu has a cake, and he wants to share it with children. The cake is initially a circle. Niuniu will choose $n$ distinct points on the circumference and connect every pair of these points with a line segment. These segments will divide the cake into several pieces.\n\nNow, Niuniu wants to know the **maximum** number of pieces the cake can be divided into. Please output the answer.", "inputFormat": "The input contains up to $20$ lines. Each line contains an integer $n$, as described in the “Description”. It is guaranteed that $0 \\le n \\le 64$.", "outputFormat": "Answer each query in order. For each query, output one line containing an integer representing the answer.", "hint": "### Sample Explanation\n\n![](https://cdn.luogu.com.cn/upload/pic/58696.png)\n\n##### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as solutions can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 鸽鸽的分割", "background": "", "description": "牛牛有一块蛋糕，他想把蛋糕分给小朋友们。蛋糕一开始是圆形的，牛牛会在圆周上选择 $n$ 个不重合的点，将这几个点两两用线段连接。这些线段将会把蛋糕分成若干块。\n\n现在，牛牛想知道，蛋糕**最多**会被分成多少块，请你告诉他答案。", "inputFormat": "输入包含至多 $20$ 行，每行一个整数 $n$，含义见「题目描述」。保证 $0\\le n \\le 64$。", "outputFormat": "依次回答牛牛的每个问题，对于每个问题，输出一行，包含一个整数表示答案。", "hint": "### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/pic/58696.png)\n\n##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5378", "type": "P", "difficulty": 7, "samples": [["1\n8\n0 0 0\n0 0 1\n0 1 0\n0 1 1\n1 0 0\n1 0 1\n1 1 0\n1 1 1\n8\n2 0 0\n2 0 1\n2 1 0\n2 1 1\n3 0 0\n3 0 1\n3 1 0\n3 1 1\n-1 0 0", "1.0000000000"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2019", "THUPC"], "title": "[THUPC 2019] 能量波", "background": "", "description": "> 有两个超级英雄在宇宙中战斗。英雄 A 为了击败对手英雄 B，使出了他的绝招，发出了一记能量光波。\n>\n> 英雄 B 有一些体力值，如果英雄 A 的能量光波对英雄 B 的伤害足够大，英雄 B 就会被击倒。否则英雄 A 就会因为耗尽能量而被英雄 B 抓住破绽，从而反而被英雄 B 击倒。所以英雄 A 迫切想知道自己的能量光波到底能够对英雄 B 造成多少伤害。\n\n为了简化问题，英雄 B 可以被描述为空间中的多个凸多面体拼成的物体。这些凸多面体可能有重合的部分，重合部分作为英雄 B 的身体只会被计算一次。\n\n英雄 A 发出的能量光波也可以被描述为空间中的另外一个凸多面体，这个光波在空间中每秒均匀移动一个向量 $\\vec{v} = (v_x,v_y,v_z)$。能量光波可以穿过任何物体，并且在穿越的过程中对对方造成伤害。\n\n在时刻 $t$, 假设英雄 A 的能量光波和英雄 B 的身体的交的体积为 $f(t) = V$，那么在这一瞬间，能量光波造成的瞬时伤害速率就恰好是 $V$。而所有时刻的总计伤害就可以被表示为\n\n$$\\int_{0}^{\\infty} f(t) \\mathrm{d}t$$\n\n英雄 A 想要知道自己的能量光波对英雄 B 的身体造成了多大的总计伤害。", "inputFormat": "第 $1$ 行一个正整数 $m_B$，表示英雄 B 的身体有多少个凸多面体组成。\n\n接下来有 $m_B$ 个输入块，每块表示英雄 B 的身体的一个组成部分。\n\n每个输入块开头第一行为一个正整数 $n$，表示这个凸多面体的顶点的个数，\n\n接下来 $n$ 行每行一个三元组，其中第 $i$ 个 $(x_i,y_i,z_i)$ 表示第 $i$ 个点的坐标。\n\n接下来一行一个正整数 $n_A$，表示英雄 A 的能量光波的对应凸多面体的顶点数，\n\n接下来 $n_A$ 行每行一个三元组，其中第 $i$ 个 $(x_i,y_i,z_i)$ 表示第 $i$ 个点的坐标。\n\n再接下来一行一个三元组 $(v_x,v_y,v_z)$，表示英雄 A 的能量光波的移动速度。\n\n我们保证 $1 \\le m_B \\le 4,4\\le n,n_A\\le 8$ ，所有输入的点的坐标都是 $[-100,100]$ 内的整数。并且所有速度向量的分量都是 $[-10,10]$ 内的实数。所有凸多面体都是不退化的 （意思是这个凸多面体的体积非 $0$）。\n\n输入中可能会出现四点共面或者三点共线的情况。\n\n我们保证在第 $0$ 秒能量光波和英雄 B 是不相交的。并且在第 $10^4$ 秒之后交集的体积一直是 $0$。", "outputFormat": "一行输出一个实数，表示总计伤害的值。\n\n输出与标准答案的绝对误差或相对误差小于 $10^{-6}$ 就会被算作正确。", "hint": "##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Energy Wave", "background": "", "description": "> Two superheroes are fighting in the universe. To defeat his opponent Hero B, Hero A uses his ultimate move and fires an energy wave.\n>\n> Hero B has some stamina. If the damage from Hero A’s energy wave is large enough, Hero B will be knocked down. Otherwise, Hero A will be caught off guard by Hero B after exhausting his energy, and Hero A will be knocked down instead. So Hero A urgently wants to know how much damage his energy wave can deal to Hero B.\n\nTo simplify the problem, Hero B can be described as an object made up of multiple convex polyhedra in space. These convex polyhedra may overlap. The overlapping part, as part of Hero B’s body, is counted only once.\n\nThe energy wave fired by Hero A can also be described as another convex polyhedron in space. This wave moves uniformly by a vector $\\vec{v} = (v_x,v_y,v_z)$ per second. The energy wave can pass through any object, and deals damage while passing through it.\n\nAt time $t$, suppose the intersection volume of Hero A’s energy wave and Hero B’s body is $f(t) = V$. Then at that instant, the instantaneous damage rate caused by the energy wave is exactly $V$. The total damage over all time can be written as\n\n$$\\int_{0}^{\\infty} f(t) \\mathrm{d}t$$\n\nHero A wants to know the total damage his energy wave deals to Hero B’s body.", "inputFormat": "The first line contains a positive integer $m_B$, indicating how many convex polyhedra make up Hero B’s body.\n\nThen there are $m_B$ input blocks, each describing one component of Hero B’s body.\n\nThe first line of each block contains a positive integer $n$, indicating the number of vertices of this convex polyhedron.\n\nThe next $n$ lines each contain a triple. The $i$-th triple $(x_i,y_i,z_i)$ gives the coordinates of the $i$-th point.\n\nThen one line contains a positive integer $n_A$, indicating the number of vertices of the convex polyhedron corresponding to Hero A’s energy wave.\n\nThe next $n_A$ lines each contain a triple. The $i$-th triple $(x_i,y_i,z_i)$ gives the coordinates of the $i$-th point.\n\nThen one line contains a triple $(v_x,v_y,v_z)$, indicating the moving velocity of Hero A’s energy wave.\n\nIt is guaranteed that $1 \\le m_B \\le 4$, $4 \\le n,n_A \\le 8$. All input point coordinates are integers in $[-100,100]$. Each component of the velocity vector is a real number in $[-10,10]$. All convex polyhedra are non-degenerate (meaning the volume of the polyhedron is not $0$).\n\nIn the input, it may happen that four points are coplanar or three points are collinear.\n\nIt is guaranteed that at time $0$, the energy wave and Hero B do not intersect. Also, after $10^4$ seconds, the intersection volume is always $0$.", "outputFormat": "Output one real number in one line, representing the value of the total damage.\n\nYour answer will be considered correct if its absolute error or relative error is less than $10^{-6}$.", "hint": "##### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nSolutions and other resources can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 能量波", "background": "", "description": "> 有两个超级英雄在宇宙中战斗。英雄 A 为了击败对手英雄 B，使出了他的绝招，发出了一记能量光波。\n>\n> 英雄 B 有一些体力值，如果英雄 A 的能量光波对英雄 B 的伤害足够大，英雄 B 就会被击倒。否则英雄 A 就会因为耗尽能量而被英雄 B 抓住破绽，从而反而被英雄 B 击倒。所以英雄 A 迫切想知道自己的能量光波到底能够对英雄 B 造成多少伤害。\n\n为了简化问题，英雄 B 可以被描述为空间中的多个凸多面体拼成的物体。这些凸多面体可能有重合的部分，重合部分作为英雄 B 的身体只会被计算一次。\n\n英雄 A 发出的能量光波也可以被描述为空间中的另外一个凸多面体，这个光波在空间中每秒均匀移动一个向量 $\\vec{v} = (v_x,v_y,v_z)$。能量光波可以穿过任何物体，并且在穿越的过程中对对方造成伤害。\n\n在时刻 $t$, 假设英雄 A 的能量光波和英雄 B 的身体的交的体积为 $f(t) = V$，那么在这一瞬间，能量光波造成的瞬时伤害速率就恰好是 $V$。而所有时刻的总计伤害就可以被表示为\n\n$$\\int_{0}^{\\infty} f(t) \\mathrm{d}t$$\n\n英雄 A 想要知道自己的能量光波对英雄 B 的身体造成了多大的总计伤害。", "inputFormat": "第 $1$ 行一个正整数 $m_B$，表示英雄 B 的身体有多少个凸多面体组成。\n\n接下来有 $m_B$ 个输入块，每块表示英雄 B 的身体的一个组成部分。\n\n每个输入块开头第一行为一个正整数 $n$，表示这个凸多面体的顶点的个数，\n\n接下来 $n$ 行每行一个三元组，其中第 $i$ 个 $(x_i,y_i,z_i)$ 表示第 $i$ 个点的坐标。\n\n接下来一行一个正整数 $n_A$，表示英雄 A 的能量光波的对应凸多面体的顶点数，\n\n接下来 $n_A$ 行每行一个三元组，其中第 $i$ 个 $(x_i,y_i,z_i)$ 表示第 $i$ 个点的坐标。\n\n再接下来一行一个三元组 $(v_x,v_y,v_z)$，表示英雄 A 的能量光波的移动速度。\n\n我们保证 $1 \\le m_B \\le 4,4\\le n,n_A\\le 8$ ，所有输入的点的坐标都是 $[-100,100]$ 内的整数。并且所有速度向量的分量都是 $[-10,10]$ 内的实数。所有凸多面体都是不退化的 （意思是这个凸多面体的体积非 $0$）。\n\n输入中可能会出现四点共面或者三点共线的情况。\n\n我们保证在第 $0$ 秒能量光波和英雄 B 是不相交的。并且在第 $10^4$ 秒之后交集的体积一直是 $0$。", "outputFormat": "一行输出一个实数，表示总计伤害的值。\n\n输出与标准答案的绝对误差或相对误差小于 $10^{-6}$ 就会被算作正确。", "hint": "##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5379", "type": "P", "difficulty": 7, "samples": [["4 2\n0 1 0 1", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "THUPC"], "title": "[THUPC 2019] 令人难以忘记的题目名称", "background": "", "description": "现在有一个长度为 $N$ 的整数序列 $S$（下标从 $0$ 开始），Alice 和 Bob 在这个序列上博弈。\n\n游戏按轮进行，每一轮中：\n\n* Alice 给出一个长度为 $N$ 的正整数序列 $T$\n* Bob 看到 Alice 给出的 $T$，然后选择 $[0, N-1]$ 里的一个整数 $x$\n* 之后我们把 $S$ 转化为 $S'$，规则如下：\n\n$${S'}_{i} = S_{i} + T_{(i+x)\\bmod N}$$\n\n* 以 $S'$ 作为新的 $S$，结束这一轮。\n\n如果某一轮结束后，$S$ 中每个数都是一个给定质数 $P$ 的倍数，那么 Alice 胜利。\n\n给定 $N$ 和初始序列 $S$，请问：Alice 是否能在有限步必胜，如果答案为是，最快可以在几轮内保证胜利。", "inputFormat": "第一行两个非负整数 $N,P$，保证 $P$ 是一个质数。\n\n接下来一行 $N$ 个空格隔开的整数，描述初始序列 $S$（$0\\le S_i \\le 10^9$）。\n\n保证 $N\\le 3\\times 10^5$，$P\\le 200$。", "outputFormat": "输出一个整数，如果 Alice 不能在有限步必胜，输出 $-1$，否则输出一个整数 $x$ 表示 Alice 最快能在几轮内胜利。", "hint": "### 样例解释\n\n一种可能的游戏情形是：\n\n* 第一轮 $T=[1, 0, 1, 0]$，$x=0$，转化后的  $S'=[1,1,1,1]$。\n* 第二轮 $T=[1,1,1,1]$，无论 $x$ 取什么，转化后的 $S'=[2,2,2,2]$。\n\n可以证明 $2$ 轮是最优的。\n\n##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] An Unforgettable Problem Title", "background": "", "description": "Now there is an integer sequence $S$ of length $N$ (indexed from $0$). Alice and Bob play a game on this sequence.\n\nThe game proceeds in rounds. In each round:\n\n* Alice provides a positive integer sequence $T$ of length $N$.\n* Bob sees the $T$ given by Alice, then chooses an integer $x$ in $[0, N-1]$.\n* Then we transform $S$ into $S'$ by the following rule:\n\n$${S'}_{i} = S_{i} + T_{(i+x)\\bmod N}$$\n\n* Take $S'$ as the new $S$, and this round ends.\n\nIf after some round ends, every number in $S$ is a multiple of a given prime $P$, then Alice wins.\n\nGiven $N$ and the initial sequence $S$, determine whether Alice can guarantee a win in finitely many steps. If yes, what is the minimum number of rounds in which she can guarantee a win.", "inputFormat": "The first line contains two non-negative integers $N, P$, and $P$ is guaranteed to be a prime.\n\nThe next line contains $N$ integers separated by spaces, describing the initial sequence $S$ ($0\\le S_i \\le 10^9$).\n\nIt is guaranteed that $N\\le 3\\times 10^5$ and $P\\le 200$.", "outputFormat": "Output one integer. If Alice cannot guarantee a win in finitely many steps, output $-1$. Otherwise, output an integer $x$ indicating the minimum number of rounds in which Alice can win.", "hint": "### Sample Explanation\n\nOne possible game process is:\n\n* Round 1: $T=[1, 0, 1, 0]$, $x=0$, and the transformed sequence is $S'=[1,1,1,1]$.\n* Round 2: $T=[1,1,1,1]$. No matter what $x$ is, the transformed sequence is $S'=[2,2,2,2]$.\n\nIt can be proved that $2$ rounds is optimal.\n\n##### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as solutions can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 令人难以忘记的题目名称", "background": "", "description": "现在有一个长度为 $N$ 的整数序列 $S$（下标从 $0$ 开始），Alice 和 Bob 在这个序列上博弈。\n\n游戏按轮进行，每一轮中：\n\n* Alice 给出一个长度为 $N$ 的正整数序列 $T$\n* Bob 看到 Alice 给出的 $T$，然后选择 $[0, N-1]$ 里的一个整数 $x$\n* 之后我们把 $S$ 转化为 $S'$，规则如下：\n\n$${S'}_{i} = S_{i} + T_{(i+x)\\bmod N}$$\n\n* 以 $S'$ 作为新的 $S$，结束这一轮。\n\n如果某一轮结束后，$S$ 中每个数都是一个给定质数 $P$ 的倍数，那么 Alice 胜利。\n\n给定 $N$ 和初始序列 $S$，请问：Alice 是否能在有限步必胜，如果答案为是，最快可以在几轮内保证胜利。", "inputFormat": "第一行两个非负整数 $N,P$，保证 $P$ 是一个质数。\n\n接下来一行 $N$ 个空格隔开的整数，描述初始序列 $S$（$0\\le S_i \\le 10^9$）。\n\n保证 $N\\le 3\\times 10^5$，$P\\le 200$。", "outputFormat": "输出一个整数，如果 Alice 不能在有限步必胜，输出 $-1$，否则输出一个整数 $x$ 表示 Alice 最快能在几轮内胜利。", "hint": "### 样例解释\n\n一种可能的游戏情形是：\n\n* 第一轮 $T=[1, 0, 1, 0]$，$x=0$，转化后的  $S'=[1,1,1,1]$。\n* 第二轮 $T=[1,1,1,1]$，无论 $x$ 取什么，转化后的 $S'=[2,2,2,2]$。\n\n可以证明 $2$ 轮是最优的。\n\n##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5380", "type": "P", "difficulty": 6, "samples": [["18\n0 0 7 0\n9 0 8 0\n0 1 1 3\n0 2 2 0\n0 3 1 2\n0 4 0 3\n9 4 8 4\n3 2 2 3\n7 0 4 2\n7 0 5 3\n9 2 7 4\n2 0 4 3\n9 1 8 3\n4 3 6 6\n7 4 9 2\n8 4 9 4\n6 6 9 4\n9 8 8 8", "Invalid command\nInvalid command\nInvalid command\nInvalid command\nred guard;NA;no;no\nInvalid command\nblue captain;NA;no;no\nred soldier;NA;no;no\nInvalid command\nInvalid command\nblue elephant;NA;no;no\nred duck;NA;no;no\nblue horse;NA;no;no\nred duck;blue soldier;no;no\nInvalid command\nblue captain;NA;yes;no\nred duck;blue captain;no;yes\nInvalid command"]], "limits": {"time": [1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000]}, "tags": ["模拟", "2019", "THUPC"], "title": "[THUPC 2019] 鸭棋", "background": "", "description": "#### 题目背景\n\n鸭棋是一种风靡鸭子界的棋类游戏。事实上，它与中国象棋有一些相似之处，但规则不尽相同。在这里，我们将为你介绍鸭棋的规则。\n\n**同时，我们下发了一个模拟鸭棋规则的玩具，你可以结合这个玩具理解题目**（也可以在 AK 后与你的队友进行对弈）。详情请见「玩具使用说明」。\n\n鸭棋在一个 $10\\times 9$（$10$ 行 $9$ 列）的网格棋盘上进行，网格上的每个格点都可以有棋子停留。对弈双方一方执红（`red`）棋、另一方执蓝（`blue`）棋，双方轮流执行操作，轮到一位玩家操作时，他必须选择一枚自己的棋子，并按照规则进行一步移动。\n\n鸭棋发明者鸭子德规定一局鸭棋由红方执先手，并设计了初始棋盘布局如下：\n\n![initial_board.png](https://cdn.luogu.com.cn/upload/pic/58700.png)\n\n##### 棋子类型与走子规则\n\n棋子分为 $7$ 类，下面介绍了它们的名字以及它们的移动规则。介绍移动规则时，我们默认棋子所处位置为 $\\left( x,y\\right)$（表示第 $x$ 行的第 $y$ 列，下同），并列出它可以到达的位置：\n\n* **王**（`captain`)：可达的位置共 $4$ 个，包括 $\\left(x\\pm 1,y\\right)$ 及 $\\left(x,y\\pm 1\\right)$。\n* **士**（`guard`）：可达的位置共 $4$ 个，包括 $\\left(x\\pm 1,y\\pm 1\\right)$ 及 $\\left(x\\pm 1,y\\mp 1\\right)$。\n* **象**（`elephant`）：可达的位置至多 $4$ 个，对于任意 $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$，分别有：\n    * 如果位置 $\\left(x+s_x\\times 1 ,y+ s_y\\times 1\\right)$ 上**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 2,y+s_y \\times 2\\right)$ 为一个可达的位置。\n* **马**（`horse`）：可达的位置至多 $8$ 个，对于任意 $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$，分别有：\n    * 如果位置 $\\left(x+s_x\\times 1 ,y\\right)$ 上**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 2,y+s_y \\times 1\\right)$ 为一个可达的位置。\n    * 如果位置 $\\left(x ,y+ s_y \\times 1 \\right)$ 上**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 1,y+s_y \\times 2\\right)$ 为一个可达的位置。\n* **车**（`car`）：可在**不跨越其他棋子**的前提下，到达同行或同列的所有其他位置。\n* **鸭**（`duck`）：可达的位置至多 $8$ 个，对于任意 $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$，分别有：\n    * 如果位置 $\\left(x+s_x\\times 2 ,y+s_y \\times 1\\right),\\left(x+s_x\\times 1 ,y\\right)$ 上均**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 3,y+s_y \\times 2\\right)$ 为一个可达的位置。\n    * 如果位置 $\\left(x+s_x \\times 1 ,y+ s_y \\times 2 \\right),\\left(x ,y+ s_y \\times 1 \\right)$ 上均**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 2,y+s_y \\times 3\\right)$ 为一个可达的位置。\n* **兵**（`soldier`）：可达的位置共 $8$ 个，包括 $\\left(x\\pm 1,y\\right)$ 及 $\\left(x,y\\pm 1\\right)$ 及 $\\left(x\\pm 1,y\\pm 1\\right)$ 及 $\\left(x\\pm 1,y\\mp 1\\right)$。\n\n**除上面描述的规则之外，棋子移动还有如下额外规则：**\n\n* 不能将棋子移动到棋盘外的某个位置。\n* 玩家不能将棋子移动到**已经停留了己方棋子**的位置。\n* 如果玩家将棋子移动到了一个**已经停留了对方棋子**的位置，那么原本停留在该位置上的这个**对方棋子**将被移出游戏。\n\n##### 胜利条件与将军局面\n\n玩家在这个游戏中的目标是将对方的**王**移出游戏。一旦一方的**王**被移出游戏，则另一方立即宣告胜利。\n\n对于一个棋盘的状态，如果存在一方有一步合法的操作能够将另一方的**王**移出游戏，则我们说当前局面是一个**将军**的局面。需要友情提示的是，根据定义，将军局面的形成包括（但不限于）如下这些可能：\n\n1. 一方将一枚棋子移动到可以攻击对方**王**的位置\n\n2. 在己方**王**受到威胁时不采取措施躲避\n\n3. 主动将**王**移动至会受到攻击的位置\n\n**除此之外，需要特别说明的是，游戏结束后，由于双方不可再操作，因此不可能出现将军局面，即便此时另一方王处于被「攻击」的位置。**\n\n#### 题目描述\n\n今年的 IDCC（International Duck Chess Competition，国际鸭棋大赛）正在如火如荼地进行着。你观摩了一场精彩绝伦的比赛，但你对对弈过程的记忆已经模糊不清了，只有系统留下的他们的**操作序列**，序列中的每个**操作**为当前操作者试图移动某个位置的棋子至另一个位置。你希望用这个序列，来复现出整局棋局的对弈过程。即，对于每步操作，你需要**首先判其是否合法**，若合法，则**进一步求出**：\n\n1. 这步操作移动了哪个棋子。\n2. 这步操作后，是否存在棋子被移出游戏，如有则还需求出被移出游戏的棋子。\n3. 这步操作后，是否形成将军局面。\n4. 这步操作后，游戏是否结束。\n\n可能包含的不合法情况如下：\n\n* 此步移动的初始位置无己方棋子停留。\n* 此步移动的初始位置有己方棋子停留，但移动不符合规则。\n* 游戏已经结束。\n\n序列中的不合法操作是需要被忽略的。比如，如果轮到红方移动，此时序列中的当前操作恰好是不合法的，则这个操作将被忽略，序列中的下一步操作将成为红方这步的操作（如仍不合法则继续忽略，直至出现合法的操作）。", "inputFormat": "第一行一个非负整数 $Q$，表示操作序列的长度。接下来依次描述每个操作。\n\n接下来 $Q$ 行，每行 $4$ 个整数 $x_s, y_s, x_t, y_t$（$0\\leq x_s,x_t < 10$，$0\\leq y_s,y_t < 9$），描述一个欲将 $\\left(x_s,y_s\\right)$ 处棋子移动到 $\\left(x_t,y_t\\right)$ 的操作。在这里，我们规定左下角（即红方**车**摆放的位置，图见「题目背景」）为 $\\left(0,0\\right)$。\n\n保证 $Q\\leq 1000$。", "outputFormat": "输出 $Q$ 行，对于每个操作依次输出复现结果。每行输出一个操作的结果：\n\n* 如果该操作为不合法操作，则请输出 `Invalid command`。\n* 如果为合法操作，则依次回答「题目描述」中的问题 $1\\sim 4$：\n    * 被移动的棋子用 `[颜色] [类型]`（注意中间包含空格）来描述，请使用它们的英文名称（见「题目背景」）。如，红象为 `red elephant`，蓝王为 `blue captain`。\n    * 被移出游戏的棋子的描述方式与上面类似。特别地，**如果无棋子被移出游戏，则该问题的答案为 `NA`**。\n    * 用 `yes`、`no` 分别表示形成、不形成将军局面。\n    * 用 `yes`、`no` 分别表示游戏结束、游戏不结束。\n    * 用 `;`（分号）将所有问题的答案隔开。\n    * 比如，四个问题的答案分别为：被移动的棋子是蓝车，无棋子被移出游戏，形成将军局面，游戏未结束。则该行应输出 `blue car;NA;yes;no`。", "hint": "##### 玩具使用说明\n\n你可以在玩具所在目录下执行如下命令来运行玩具（链接: <https://pan.baidu.com/s/12MJGgZB9zKcE3qgRbRozGw> 提取码: 4d5c）：\n\n```\n./duckchess\n```\n\n特别地，在**初次运行前**，你需要执行如下命令为它添加运行权限：\n\n\n```\nchmod +x duckchess\n```\n\n##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Duck Chess.", "background": "", "description": "#### Background\n\nDuck Chess is a board game that is popular among ducks. In fact, it is somewhat similar to Chinese Chess, but the rules are not exactly the same. Here, we will introduce the rules of Duck Chess.\n\n**At the same time, we provide a toy that simulates the rules of Duck Chess. You can use this toy to better understand the problem** (you may also play with your teammates after getting AK). For details, see “Toy Instructions”.\n\nDuck Chess is played on a $10\\times 9$ grid board ($10$ rows and $9$ columns). Each grid point can hold a piece. One player uses the red (`red`) pieces, and the other uses the blue (`blue`) pieces. The two players take turns to make moves. When it is a player’s turn, they must choose one of their own pieces and make exactly one move according to the rules.\n\nThe inventor Duck De规定 (De Guiding, “规定”) specified that red moves first, and designed the initial board layout as follows:\n\n![initial_board.png](https://cdn.luogu.com.cn/upload/pic/58700.png)\n\n##### Piece Types and Moving Rules\n\nThere are $7$ types of pieces. Below are their names and moving rules. When describing moving rules, we assume the piece is at position $\\left(x,y\\right)$ (meaning row $x$, column $y$, same below), and list the positions it can reach:\n\n* **Captain** (`captain`): It can reach $4$ positions, including $\\left(x\\pm 1,y\\right)$ and $\\left(x,y\\pm 1\\right)$.\n* **Guard** (`guard`): It can reach $4$ positions, including $\\left(x\\pm 1,y\\pm 1\\right)$ and $\\left(x\\pm 1,y\\mp 1\\right)$.\n* **Elephant** (`elephant`): It can reach at most $4$ positions. For any $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$:\n    * If there is **no piece of either side** on $\\left(x+s_x\\times 1 ,y+ s_y\\times 1\\right)$, then $\\left( x+s_x \\times 2,y+s_y \\times 2\\right)$ is a reachable position.\n* **Horse** (`horse`): It can reach at most $8$ positions. For any $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$:\n    * If there is **no piece of either side** on $\\left(x+s_x\\times 1 ,y\\right)$, then $\\left( x+s_x \\times 2,y+s_y \\times 1\\right)$ is a reachable position.\n    * If there is **no piece of either side** on $\\left(x ,y+ s_y \\times 1 \\right)$, then $\\left( x+s_x \\times 1,y+s_y \\times 2\\right)$ is a reachable position.\n* **Car** (`car`): Without **jumping over other pieces**, it can reach all other positions in the same row or the same column.\n* **Duck** (`duck`): It can reach at most $8$ positions. For any $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$:\n    * If both $\\left(x+s_x\\times 2 ,y+s_y \\times 1\\right)$ and $\\left(x+s_x\\times 1 ,y\\right)$ have **no piece of either side**, then $\\left( x+s_x \\times 3,y+s_y \\times 2\\right)$ is a reachable position.\n    * If both $\\left(x+s_x \\times 1 ,y+ s_y \\times 2 \\right)$ and $\\left(x ,y+ s_y \\times 1 \\right)$ have **no piece of either side**, then $\\left( x+s_x \\times 2,y+s_y \\times 3\\right)$ is a reachable position.\n* **Soldier** (`soldier`): It can reach $8$ positions, including $\\left(x\\pm 1,y\\right)$ and $\\left(x,y\\pm 1\\right)$ and $\\left(x\\pm 1,y\\pm 1\\right)$ and $\\left(x\\pm 1,y\\mp 1\\right)$.\n\n**In addition to the rules described above, piece movement also follows these extra rules:**\n\n* You cannot move a piece to a position outside the board.\n* A player cannot move a piece to a position that is **already occupied by one of their own pieces**.\n* If a player moves a piece to a position **occupied by an opponent’s piece**, then that **opponent’s piece** is removed from the game.\n\n##### Winning Condition and “Check” Positions\n\nThe goal of the game is to remove the opponent’s **captain** from the game. Once a side’s **captain** is removed, the other side wins immediately.\n\nFor a board state, if one side has a legal move that can remove the other side’s **captain** from the game in one step, then we say the current position is a **check** position. As a friendly reminder, by definition, forming a check position includes (but is not limited to) the following possibilities:\n\n1. Moving a piece to a position where it can attack the opponent’s **captain**.\n\n2. Not taking any action to avoid threats when one’s own **captain** is under threat.\n\n3. Actively moving the **captain** to a position that will be attacked.\n\n**In addition, note that after the game ends, since neither side can make any further moves, it is impossible for a check position to exist, even if at that time the other side’s captain is in an “attacked” position.**\n\n#### Problem Description\n\nThis year’s IDCC (International Duck Chess Competition) is in full swing. You watched an amazing match, but your memory of the game process has become blurry. Only the system’s **operation sequence** is left. Each **operation** in the sequence is the current player’s attempt to move a piece from one position to another. You want to use this sequence to reproduce the entire game process. That is, for each operation, you need to **first determine whether it is legal**. If it is legal, then you need to **further determine**:\n\n1. Which piece is moved by this operation.\n2. After this operation, whether any piece is removed from the game. If so, also determine which piece is removed.\n3. After this operation, whether a check position is formed.\n4. After this operation, whether the game ends.\n\nPossible illegal situations include:\n\n* There is no piece of the current player at the starting position of this move.\n* There is a piece of the current player at the starting position, but the move does not follow the rules.\n* The game has already ended.\n\nIllegal operations in the sequence should be ignored. For example, if it is red’s turn to move and the current operation in the sequence is illegal, then this operation is ignored, and the next operation in the sequence becomes red’s operation for this turn (if it is still illegal, keep ignoring, until a legal operation appears).", "inputFormat": "The first line contains a non-negative integer $Q$, indicating the length of the operation sequence. Next, each operation is described in order.\n\nIn the next $Q$ lines, each line contains $4$ integers $x_s, y_s, x_t, y_t$ ($0\\leq x_s,x_t < 10$, $0\\leq y_s,y_t < 9$), describing an operation that attempts to move the piece at $\\left(x_s,y_s\\right)$ to $\\left(x_t,y_t\\right)$. Here, we define the bottom-left corner (i.e., the position where red’s **car** is placed, see the figure in “Background”) as $\\left(0,0\\right)$.\n\nIt is guaranteed that $Q\\leq 1000$.", "outputFormat": "Output $Q$ lines. For each operation, output the reproduction result in order. Each line outputs the result of one operation:\n\n* If the operation is illegal, output `Invalid command`.\n* If it is legal, answer questions $1\\sim 4$ in “Problem Description” in order:\n    * Describe the moved piece as `[color] [type]` (note there is a space), using their English names (see “Background”). For example, a red elephant is `red elephant`, and a blue captain is `blue captain`.\n    * The piece removed from the game is described in the same way as above. In particular, **if no piece is removed, the answer to this question is `NA`**.\n    * Use `yes` and `no` to indicate whether a check position is formed.\n    * Use `yes` and `no` to indicate whether the game ends.\n    * Use `;` (semicolon) to separate the answers to all questions.\n    * For example, if the four answers are: the moved piece is a blue car, no piece is removed, a check position is formed, and the game does not end, then the line should be `blue car;NA;yes;no`.", "hint": "##### Toy Instructions\n\nYou can run the toy by executing the following command in the directory where the toy is located (link: <https://pan.baidu.com/s/12MJGgZB9zKcE3qgRbRozGw> extract code: 4d5c):\n\n```\n./duckchess\n```\n\nIn particular, **before the first run**, you need to execute the following command to add execute permission:\n\n```\nchmod +x duckchess\n```\n\n##### Copyright Information\n\nFrom THUPC (THU Programming Contest) 2019.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 鸭棋", "background": "", "description": "#### 题目背景\n\n鸭棋是一种风靡鸭子界的棋类游戏。事实上，它与中国象棋有一些相似之处，但规则不尽相同。在这里，我们将为你介绍鸭棋的规则。\n\n**同时，我们下发了一个模拟鸭棋规则的玩具，你可以结合这个玩具理解题目**（也可以在 AK 后与你的队友进行对弈）。详情请见「玩具使用说明」。\n\n鸭棋在一个 $10\\times 9$（$10$ 行 $9$ 列）的网格棋盘上进行，网格上的每个格点都可以有棋子停留。对弈双方一方执红（`red`）棋、另一方执蓝（`blue`）棋，双方轮流执行操作，轮到一位玩家操作时，他必须选择一枚自己的棋子，并按照规则进行一步移动。\n\n鸭棋发明者鸭子德规定一局鸭棋由红方执先手，并设计了初始棋盘布局如下：\n\n![initial_board.png](https://cdn.luogu.com.cn/upload/pic/58700.png)\n\n##### 棋子类型与走子规则\n\n棋子分为 $7$ 类，下面介绍了它们的名字以及它们的移动规则。介绍移动规则时，我们默认棋子所处位置为 $\\left( x,y\\right)$（表示第 $x$ 行的第 $y$ 列，下同），并列出它可以到达的位置：\n\n* **王**（`captain`)：可达的位置共 $4$ 个，包括 $\\left(x\\pm 1,y\\right)$ 及 $\\left(x,y\\pm 1\\right)$。\n* **士**（`guard`）：可达的位置共 $4$ 个，包括 $\\left(x\\pm 1,y\\pm 1\\right)$ 及 $\\left(x\\pm 1,y\\mp 1\\right)$。\n* **象**（`elephant`）：可达的位置至多 $4$ 个，对于任意 $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$，分别有：\n    * 如果位置 $\\left(x+s_x\\times 1 ,y+ s_y\\times 1\\right)$ 上**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 2,y+s_y \\times 2\\right)$ 为一个可达的位置。\n* **马**（`horse`）：可达的位置至多 $8$ 个，对于任意 $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$，分别有：\n    * 如果位置 $\\left(x+s_x\\times 1 ,y\\right)$ 上**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 2,y+s_y \\times 1\\right)$ 为一个可达的位置。\n    * 如果位置 $\\left(x ,y+ s_y \\times 1 \\right)$ 上**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 1,y+s_y \\times 2\\right)$ 为一个可达的位置。\n* **车**（`car`）：可在**不跨越其他棋子**的前提下，到达同行或同列的所有其他位置。\n* **鸭**（`duck`）：可达的位置至多 $8$ 个，对于任意 $s_x,s_y\\in \\left\\{ 1,-1\\right\\}$，分别有：\n    * 如果位置 $\\left(x+s_x\\times 2 ,y+s_y \\times 1\\right),\\left(x+s_x\\times 1 ,y\\right)$ 上均**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 3,y+s_y \\times 2\\right)$ 为一个可达的位置。\n    * 如果位置 $\\left(x+s_x \\times 1 ,y+ s_y \\times 2 \\right),\\left(x ,y+ s_y \\times 1 \\right)$ 上均**无任意一方**的棋子停留，则 $\\left( x+s_x \\times 2,y+s_y \\times 3\\right)$ 为一个可达的位置。\n* **兵**（`soldier`）：可达的位置共 $8$ 个，包括 $\\left(x\\pm 1,y\\right)$ 及 $\\left(x,y\\pm 1\\right)$ 及 $\\left(x\\pm 1,y\\pm 1\\right)$ 及 $\\left(x\\pm 1,y\\mp 1\\right)$。\n\n**除上面描述的规则之外，棋子移动还有如下额外规则：**\n\n* 不能将棋子移动到棋盘外的某个位置。\n* 玩家不能将棋子移动到**已经停留了己方棋子**的位置。\n* 如果玩家将棋子移动到了一个**已经停留了对方棋子**的位置，那么原本停留在该位置上的这个**对方棋子**将被移出游戏。\n\n##### 胜利条件与将军局面\n\n玩家在这个游戏中的目标是将对方的**王**移出游戏。一旦一方的**王**被移出游戏，则另一方立即宣告胜利。\n\n对于一个棋盘的状态，如果存在一方有一步合法的操作能够将另一方的**王**移出游戏，则我们说当前局面是一个**将军**的局面。需要友情提示的是，根据定义，将军局面的形成包括（但不限于）如下这些可能：\n\n1. 一方将一枚棋子移动到可以攻击对方**王**的位置\n\n2. 在己方**王**受到威胁时不采取措施躲避\n\n3. 主动将**王**移动至会受到攻击的位置\n\n**除此之外，需要特别说明的是，游戏结束后，由于双方不可再操作，因此不可能出现将军局面，即便此时另一方王处于被「攻击」的位置。**\n\n#### 题目描述\n\n今年的 IDCC（International Duck Chess Competition，国际鸭棋大赛）正在如火如荼地进行着。你观摩了一场精彩绝伦的比赛，但你对对弈过程的记忆已经模糊不清了，只有系统留下的他们的**操作序列**，序列中的每个**操作**为当前操作者试图移动某个位置的棋子至另一个位置。你希望用这个序列，来复现出整局棋局的对弈过程。即，对于每步操作，你需要**首先判其是否合法**，若合法，则**进一步求出**：\n\n1. 这步操作移动了哪个棋子。\n2. 这步操作后，是否存在棋子被移出游戏，如有则还需求出被移出游戏的棋子。\n3. 这步操作后，是否形成将军局面。\n4. 这步操作后，游戏是否结束。\n\n可能包含的不合法情况如下：\n\n* 此步移动的初始位置无己方棋子停留。\n* 此步移动的初始位置有己方棋子停留，但移动不符合规则。\n* 游戏已经结束。\n\n序列中的不合法操作是需要被忽略的。比如，如果轮到红方移动，此时序列中的当前操作恰好是不合法的，则这个操作将被忽略，序列中的下一步操作将成为红方这步的操作（如仍不合法则继续忽略，直至出现合法的操作）。", "inputFormat": "第一行一个非负整数 $Q$，表示操作序列的长度。接下来依次描述每个操作。\n\n接下来 $Q$ 行，每行 $4$ 个整数 $x_s, y_s, x_t, y_t$（$0\\leq x_s,x_t < 10$，$0\\leq y_s,y_t < 9$），描述一个欲将 $\\left(x_s,y_s\\right)$ 处棋子移动到 $\\left(x_t,y_t\\right)$ 的操作。在这里，我们规定左下角（即红方**车**摆放的位置，图见「题目背景」）为 $\\left(0,0\\right)$。\n\n保证 $Q\\leq 1000$。", "outputFormat": "输出 $Q$ 行，对于每个操作依次输出复现结果。每行输出一个操作的结果：\n\n* 如果该操作为不合法操作，则请输出 `Invalid command`。\n* 如果为合法操作，则依次回答「题目描述」中的问题 $1\\sim 4$：\n    * 被移动的棋子用 `[颜色] [类型]`（注意中间包含空格）来描述，请使用它们的英文名称（见「题目背景」）。如，红象为 `red elephant`，蓝王为 `blue captain`。\n    * 被移出游戏的棋子的描述方式与上面类似。特别地，**如果无棋子被移出游戏，则该问题的答案为 `NA`**。\n    * 用 `yes`、`no` 分别表示形成、不形成将军局面。\n    * 用 `yes`、`no` 分别表示游戏结束、游戏不结束。\n    * 用 `;`（分号）将所有问题的答案隔开。\n    * 比如，四个问题的答案分别为：被移动的棋子是蓝车，无棋子被移出游戏，形成将军局面，游戏未结束。则该行应输出 `blue car;NA;yes;no`。", "hint": "##### 玩具使用说明\n\n你可以在玩具所在目录下执行如下命令来运行玩具（链接: <https://pan.baidu.com/s/12MJGgZB9zKcE3qgRbRozGw> 提取码: 4d5c）：\n\n```\n./duckchess\n```\n\n特别地，在**初次运行前**，你需要执行如下命令为它添加运行权限：\n\n\n```\nchmod +x duckchess\n```\n\n##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5381", "type": "P", "difficulty": 6, "samples": [["2\n1 1\n1 2", "0.00000\n1.00000"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "平衡树", "Special Judge", "THUPC"], "title": "[THUPC 2019] 不等式", "background": "", "description": "> 时光回到 2017 年 6 月 7 日。午后，阳光正好。\n>\n> 现在的你，在考场中笔耕不辍。在刷刷声中，你填写着交给从前和未来的自己的答卷。\n> \n> 像无数次训练过的那样，你直接跳到了这张数学试卷的最后一道大题，二选一的题目直接选择了后者。快速地掠过了题目描述，紧缩的眉头渐渐放松。\n> \n> 「稳了。」\n>\n> 你一刻也不敢停留，又向你的梦想靠近了一小步。\n\n已知两个 $n$ 维实向量 $\\vec{a}=(a_1,a_2,\\dots,a_n),\\vec{b}=(b_1,b_2,\\dots,b_n)$，定义 $n$ 个定义域为 $\\mathbb{R}$ 函数 $f_1,f_2,\\dots,f_n$：\n\n$$f_k(x)=\\sum_{i=1}^{k} \\lvert a_ix+b_i\\rvert \\quad (k=1,2,\\dots,n)$$\n\n现在，对于每个 $k=1,2,\\dots,n$，试求 $f_k$ 在 $\\mathbb{R}$ 上的最小值。可以证明最小值一定存在。", "inputFormat": "第一行一个整数 $n$，表示向量的长度及函数的个数。\n\n接下来两行，每行 $n$ 个整数，分别描述向量 $\\vec{a},\\vec{b}$ 的各个分量，以空格隔开。\n\n对于所有的输入数据，都满足 $1\\le n\\le 5\\times 10^5,\\lvert a_i\\rvert ,\\lvert b_i\\rvert <10^5$。", "outputFormat": "输出 $n$ 行，第 $i$（$i=1,2,\\dots,n$） 行为一个实数，表示 $f_i$ 在 $\\mathbb{R}$ 上的最小值。\n\n输出与标准答案的绝对误差或相对误差小于 $10^{-6}$ 就会被算作正确。", "hint": "### 样例解释\n\n$f_1(x)=\\lvert x+1\\rvert$，显然在 $x=-1$ 处取到最小值 $0$；\n\n$f_2(x)=\\lvert x+1\\rvert +\\lvert x+2\\rvert$，可以证明其在 $[-2,-1]$ 中任意位置取到最小值 $1$。\n\n##### 后记\n\n后来，全国三卷的考生们又回想起了被参数方程支配的恐惧。\n\n##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Inequalities", "background": "", "description": "> Time goes back to June 7, 2017. In the afternoon, the sunlight is just right.\n>\n> You, in the examination room, keep writing without stopping. Amid the rustling sounds, you fill in an answer sheet meant for your past and future selves.\n>\n> Just like you have practiced countless times, you jump straight to the last big problem on this math paper. For the either-or question, you directly choose the latter. After quickly skimming the statement, your furrowed brows gradually relax.\n>\n> “This is in the bag.”\n>\n> You do not dare to pause for even a moment, and you move one small step closer to your dream.\n\nGiven two $n$-dimensional real vectors $\\vec{a}=(a_1,a_2,\\dots,a_n)$ and $\\vec{b}=(b_1,b_2,\\dots,b_n)$, define $n$ functions $f_1,f_2,\\dots,f_n$ with domain $\\mathbb{R}$:\n\n$$f_k(x)=\\sum_{i=1}^{k} \\lvert a_ix+b_i\\rvert \\quad (k=1,2,\\dots,n)$$\n\nNow, for each $k=1,2,\\dots,n$, find the minimum value of $f_k$ over $\\mathbb{R}$. It can be proven that the minimum always exists.", "inputFormat": "The first line contains an integer $n$, representing the length of the vectors and the number of functions.\n\nThe next two lines each contain $n$ integers, describing the components of vectors $\\vec{a}$ and $\\vec{b}$, separated by spaces.\n\nFor all input data, it holds that $1\\le n\\le 5\\times 10^5$ and $\\lvert a_i\\rvert ,\\lvert b_i\\rvert <10^5$.", "outputFormat": "Output $n$ lines. The $i$-th line ($i=1,2,\\dots,n$) contains a real number, representing the minimum value of $f_i$ over $\\mathbb{R}$.\n\nYour output will be considered correct if the absolute error or relative error compared with the standard answer is less than $10^{-6}$.", "hint": "### Sample Explanation\n\n$f_1(x)=\\lvert x+1\\rvert$, which obviously achieves its minimum value $0$ at $x=-1$.\n\n$f_2(x)=\\lvert x+1\\rvert +\\lvert x+2\\rvert$. It can be proven that it achieves its minimum value $1$ at any point in $[-2,-1]$.\n\n##### Postscript\n\nLater, the students who took the third national exam paper once again recalled the fear of being dominated by parametric equations.\n\n##### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as solutions can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 不等式", "background": "", "description": "> 时光回到 2017 年 6 月 7 日。午后，阳光正好。\n>\n> 现在的你，在考场中笔耕不辍。在刷刷声中，你填写着交给从前和未来的自己的答卷。\n> \n> 像无数次训练过的那样，你直接跳到了这张数学试卷的最后一道大题，二选一的题目直接选择了后者。快速地掠过了题目描述，紧缩的眉头渐渐放松。\n> \n> 「稳了。」\n>\n> 你一刻也不敢停留，又向你的梦想靠近了一小步。\n\n已知两个 $n$ 维实向量 $\\vec{a}=(a_1,a_2,\\dots,a_n),\\vec{b}=(b_1,b_2,\\dots,b_n)$，定义 $n$ 个定义域为 $\\mathbb{R}$ 函数 $f_1,f_2,\\dots,f_n$：\n\n$$f_k(x)=\\sum_{i=1}^{k} \\lvert a_ix+b_i\\rvert \\quad (k=1,2,\\dots,n)$$\n\n现在，对于每个 $k=1,2,\\dots,n$，试求 $f_k$ 在 $\\mathbb{R}$ 上的最小值。可以证明最小值一定存在。", "inputFormat": "第一行一个整数 $n$，表示向量的长度及函数的个数。\n\n接下来两行，每行 $n$ 个整数，分别描述向量 $\\vec{a},\\vec{b}$ 的各个分量，以空格隔开。\n\n对于所有的输入数据，都满足 $1\\le n\\le 5\\times 10^5,\\lvert a_i\\rvert ,\\lvert b_i\\rvert <10^5$。", "outputFormat": "输出 $n$ 行，第 $i$（$i=1,2,\\dots,n$） 行为一个实数，表示 $f_i$ 在 $\\mathbb{R}$ 上的最小值。\n\n输出与标准答案的绝对误差或相对误差小于 $10^{-6}$ 就会被算作正确。", "hint": "### 样例解释\n\n$f_1(x)=\\lvert x+1\\rvert$，显然在 $x=-1$ 处取到最小值 $0$；\n\n$f_2(x)=\\lvert x+1\\rvert +\\lvert x+2\\rvert$，可以证明其在 $[-2,-1]$ 中任意位置取到最小值 $1$。\n\n##### 后记\n\n后来，全国三卷的考生们又回想起了被参数方程支配的恐惧。\n\n##### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5382", "type": "P", "difficulty": 6, "samples": [["7 8\n2 2 1 1 3 3 4\n100 100 40 20 100 50 40\n1 3\n2 3\n1 4\n2 4\n3 5\n4 6\n3 7\n4 7", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "THUPC"], "title": "[THUPC 2019] 改善生活", "background": "", "description": "「改善生活」是小 Z 创建的一个群聊。在群聊里，小 Z 和他的 $n-1$ 个朋友们（共 $n$ 名群友，小 Z 的编号为 $1$，他的朋友们的编号从 $2$ 至 $n$）无话不说，畅谈甚欢。然而，经常水群会被冠以水王的名号，这让小 Z 头痛不已。\n\n今天，小 Z 预见到了群里可能会有 $n$ 个话题（编号从 $1$ 至 $n$）。其中，第 $i$ 个话题是 $c_i$ 号群友（当然也有可能是小 Z 自己）感兴趣的话题，这意味着该话题如果出现，这位群友将会进行 $w_i$ 分钟的**激烈发言**。方便起见，你可以认为，除此之外，群友不会进行激烈发言。\n\n所有 $n$ 个话题之间有 $m$ 组引导关系，每组引导关系的形式是一个二元组 $\\left(u,v\\right)$，它表示如果 $u$ 号话题出现，**必定**会导致 $v$ 号话题出现。\n\n巧合的是，小 Z 发现，所有他自己的**不同**话题都不存在**直接或间接**的引导关系。\n\n由于期中考试的临近，除小 Z 外的群友们都忙于复习，因此他们不会主动发起话题（发起话题指让一个话题出现，下同），也就是说，**所有** $c_i\\neq 1$ **的话题都只能由引导关系直接或间接引出**。这让想要水群、却又希望摆脱水王名号的小 Z 左右为难。因此，他决定主动发起**一个或以上**的**自己感兴趣**的话题，来诱导其他话题的出现，致使**水群最多的另一位群友激烈发言的时间**与**小 Z 自己激烈发言的时间**的比值尽可能大。即最大化下面这个式子：\n\n$$\\frac{\\max\\limits_{k=2}^n \\text{sum}\\left(k\\right)}{\\text{sum}\\left(1\\right)}$$\n\n其中，$\\text{sum}\\left(k\\right)$ 表示所有**出现**且**群友 $k$ 感兴趣**的话题的 $w$ 值总和。\n\n为避免精度误差，你只需要求出最大值**向下取整**的结果即可。", "inputFormat": "第一行两个正整数 $n,m$，分别表示话题数（恰好也是群人数）、引导关系组数。\n\n第二行 $n$ 个正整数 $c_1,\\dots, c_n$（$1\\leq c_i\\leq n$），依次描述对各话题感兴趣的群友编号。保证至少存在一个$i$ 使得 $c_i=1$。\n\n第三行 $n$ 个正整数 $w_1,\\dots, w_n$（$1\\leq w_i\\leq 100$），依次描述各话题感兴趣的群友将激烈发言的时间。\n\n接下来 $m$ 行描述引导关系，每行两个正整数 $u,v$（$1\\leq u,v\\leq n$），描述一组引导关系 $\\left(u,v\\right)$，具体意义见【题目描述】，**保证所有不同的 $c_i=1$ 的话题之间两两不存在直接或间接的引导关系**。\n\n对于每一行，如果行内包含多个数，则用单个空格将它们隔开。\n\n保证 $1\\leq n\\leq 700$，$1\\leq m\\leq 60000$。", "outputFormat": "一行一个**整数**，表示所求式子最大值**向下取整**的结果，即不超过该值的最大整数。", "hint": "### 样例解释\n\n小 Z 可以选择发起编号为 3 和 4 的话题，这将致使编号为 5、6、7 的话题出现，并引发 3 号群友时长 $150$ 分钟的激烈发言、以及 4 号群友时长 $40$ 分钟的激烈发言。由于 $3$ 号群友激烈发言时间更长，且小 Z 自己的激烈发言时长为 $60$ 分钟，因此所求最大比值为 $\\frac{150}{60}=2.5$，这个值向下取整的结果是 $2$。\n\n可以证明小 Z 不存在更优的策略。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Improve Life", "background": "", "description": "\"Improve Life\" is a group chat created by Xiao Z. In the group chat, Xiao Z and his $n-1$ friends (there are $n$ members in total; Xiao Z is numbered $1$, and his friends are numbered from $2$ to $n$) talk about everything and have a great time. However, chatting too much is often labeled as being the \"chat king\", which gives Xiao Z a headache.\n\nToday, Xiao Z foresees that there may be $n$ topics in the group (numbered from $1$ to $n$). Topic $i$ is a topic that member $c_i$ (possibly Xiao Z himself) is interested in. This means that if this topic appears, this member will make an **intense speech** for $w_i$ minutes. For convenience, you may assume that apart from this, members will not make intense speeches.\n\nAmong all $n$ topics, there are $m$ guiding relationships. Each guiding relationship is an ordered pair $\\left(u,v\\right)$, meaning that if topic $u$ appears, it will **definitely** cause topic $v$ to appear.\n\nCoincidentally, Xiao Z发现 that among all of his own **different** topics, there is no **direct or indirect** guiding relationship.\n\nBecause the midterm exams are coming, all members except Xiao Z are busy studying, so they will not proactively start topics (starting a topic means making a topic appear; same below). That is, **all** topics with $c_i\\neq 1$ **can only be triggered directly or indirectly by guiding relationships**. This puts Xiao Z in a dilemma: he wants to chat a lot, but also wants to get rid of the \"chat king\" label. Therefore, he decides to proactively start **one or more** topics **that he is interested in**, to induce other topics to appear, so that the ratio of **the maximum intense speaking time among other members** to **Xiao Z's own intense speaking time** is as large as possible. That is, maximize the following expression:\n\n$$\\frac{\\max\\limits_{k=2}^n \\text{sum}\\left(k\\right)}{\\text{sum}\\left(1\\right)}$$\n\nHere, $\\text{sum}\\left(k\\right)$ denotes the sum of $w$ values over all topics that **appear** and that **member $k$ is interested in**.\n\nTo avoid precision errors, you only need to output the result of **rounding down** the maximum value.", "inputFormat": "The first line contains two positive integers $n,m$, representing the number of topics (which is also exactly the number of group members) and the number of guiding relationships.\n\nThe second line contains $n$ positive integers $c_1,\\dots, c_n$ ($1\\leq c_i\\leq n$), describing the member number who is interested in each topic in order. It is guaranteed that there exists at least one $i$ such that $c_i=1$.\n\nThe third line contains $n$ positive integers $w_1,\\dots, w_n$ ($1\\leq w_i\\leq 100$), describing the time of intense speech for the member interested in each topic.\n\nThe next $m$ lines describe the guiding relationships. Each line contains two positive integers $u,v$ ($1\\leq u,v\\leq n$), describing a guiding relationship $\\left(u,v\\right)$. See the **Description** for the exact meaning. It is **guaranteed that between any two different topics with $c_i=1$, there is neither a direct nor an indirect guiding relationship**.\n\nFor each line, if it contains multiple numbers, they are separated by a single space.\n\nConstraints: $1\\leq n\\leq 700$, $1\\leq m\\leq 60000$.", "outputFormat": "Output a single **integer** on one line: the result of **rounding down** the maximum value of the required expression, i.e., the largest integer not exceeding that value.", "hint": "### Sample Explanation\n\nXiao Z can choose to start topics numbered 3 and 4. This will cause topics numbered 5, 6, and 7 to appear, and trigger an intense speech of $150$ minutes by member 3, and $40$ minutes by member 4. Since member 3 speaks for a longer time, and Xiao Z's own intense speaking time is $60$ minutes, the maximum ratio is $\\frac{150}{60}=2.5$, and rounding it down gives $2$.\n\nIt can be proven that Xiao Z has no better strategy.\n\n### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as solutions can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 改善生活", "background": "", "description": "「改善生活」是小 Z 创建的一个群聊。在群聊里，小 Z 和他的 $n-1$ 个朋友们（共 $n$ 名群友，小 Z 的编号为 $1$，他的朋友们的编号从 $2$ 至 $n$）无话不说，畅谈甚欢。然而，经常水群会被冠以水王的名号，这让小 Z 头痛不已。\n\n今天，小 Z 预见到了群里可能会有 $n$ 个话题（编号从 $1$ 至 $n$）。其中，第 $i$ 个话题是 $c_i$ 号群友（当然也有可能是小 Z 自己）感兴趣的话题，这意味着该话题如果出现，这位群友将会进行 $w_i$ 分钟的**激烈发言**。方便起见，你可以认为，除此之外，群友不会进行激烈发言。\n\n所有 $n$ 个话题之间有 $m$ 组引导关系，每组引导关系的形式是一个二元组 $\\left(u,v\\right)$，它表示如果 $u$ 号话题出现，**必定**会导致 $v$ 号话题出现。\n\n巧合的是，小 Z 发现，所有他自己的**不同**话题都不存在**直接或间接**的引导关系。\n\n由于期中考试的临近，除小 Z 外的群友们都忙于复习，因此他们不会主动发起话题（发起话题指让一个话题出现，下同），也就是说，**所有** $c_i\\neq 1$ **的话题都只能由引导关系直接或间接引出**。这让想要水群、却又希望摆脱水王名号的小 Z 左右为难。因此，他决定主动发起**一个或以上**的**自己感兴趣**的话题，来诱导其他话题的出现，致使**水群最多的另一位群友激烈发言的时间**与**小 Z 自己激烈发言的时间**的比值尽可能大。即最大化下面这个式子：\n\n$$\\frac{\\max\\limits_{k=2}^n \\text{sum}\\left(k\\right)}{\\text{sum}\\left(1\\right)}$$\n\n其中，$\\text{sum}\\left(k\\right)$ 表示所有**出现**且**群友 $k$ 感兴趣**的话题的 $w$ 值总和。\n\n为避免精度误差，你只需要求出最大值**向下取整**的结果即可。", "inputFormat": "第一行两个正整数 $n,m$，分别表示话题数（恰好也是群人数）、引导关系组数。\n\n第二行 $n$ 个正整数 $c_1,\\dots, c_n$（$1\\leq c_i\\leq n$），依次描述对各话题感兴趣的群友编号。保证至少存在一个$i$ 使得 $c_i=1$。\n\n第三行 $n$ 个正整数 $w_1,\\dots, w_n$（$1\\leq w_i\\leq 100$），依次描述各话题感兴趣的群友将激烈发言的时间。\n\n接下来 $m$ 行描述引导关系，每行两个正整数 $u,v$（$1\\leq u,v\\leq n$），描述一组引导关系 $\\left(u,v\\right)$，具体意义见【题目描述】，**保证所有不同的 $c_i=1$ 的话题之间两两不存在直接或间接的引导关系**。\n\n对于每一行，如果行内包含多个数，则用单个空格将它们隔开。\n\n保证 $1\\leq n\\leq 700$，$1\\leq m\\leq 60000$。", "outputFormat": "一行一个**整数**，表示所求式子最大值**向下取整**的结果，即不超过该值的最大整数。", "hint": "### 样例解释\n\n小 Z 可以选择发起编号为 3 和 4 的话题，这将致使编号为 5、6、7 的话题出现，并引发 3 号群友时长 $150$ 分钟的激烈发言、以及 4 号群友时长 $40$ 分钟的激烈发言。由于 $3$ 号群友激烈发言时间更长，且小 Z 自己的激烈发言时长为 $60$ 分钟，因此所求最大比值为 $\\frac{150}{60}=2.5$，这个值向下取整的结果是 $2$。\n\n可以证明小 Z 不存在更优的策略。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5383", "type": "P", "difficulty": 7, "samples": [["3\n1 1 1", "1 2 1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "普通多项式转下降幂多项式", "background": "这是一道模板题", "description": "已知普通多项式 $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{i}$。\n\n求下降幂多项式 $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^{\\underline{i}}$。\n\n使得 $G(x)=F(x)$。\n\n所有运算均在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行一个正整数 $n$，如题所述。\n\n第二行 $n$ 个数，第 $i$ 个数表示 $a_{i-1}$。", "outputFormat": "一行 $n$ 个数，第 $i$ 个数为 $b_{i-1}$。", "hint": "对于所有数据 $a_i\\in\\lbrack0,998244353)$。\n\n本题一共 $10$ 个点。\n\n其中 $3$ 个点 $n=2000$。\n\n另外 $7$ 个点 $n=10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Convert an Ordinary Polynomial to a Falling-Factorial Polynomial", "background": "This is a template problem.", "description": "Given an ordinary polynomial $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{i}$.\n\nFind a falling-factorial polynomial $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^{\\underline{i}}$.\n\nSuch that $G(x)=F(x)$.\n\nAll operations are performed modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$, as described above.\n\nThe second line contains $n$ numbers. The $i$-th number represents $a_{i-1}$.", "outputFormat": "Output one line with $n$ numbers. The $i$-th number is $b_{i-1}$.", "hint": "For all testdata, $a_i\\in\\lbrack0,998244353)$.\n\nThis problem has a total of $10$ subtasks.\n\nAmong them, $3$ subtasks have $n=2000$.\n\nThe other $7$ subtasks have $n=10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "普通多项式转下降幂多项式", "background": "这是一道模板题", "description": "已知普通多项式 $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{i}$。\n\n求下降幂多项式 $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^{\\underline{i}}$。\n\n使得 $G(x)=F(x)$。\n\n所有运算均在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行一个正整数 $n$，如题所述。\n\n第二行 $n$ 个数，第 $i$ 个数表示 $a_{i-1}$。", "outputFormat": "一行 $n$ 个数，第 $i$ 个数为 $b_{i-1}$。", "hint": "对于所有数据 $a_i\\in\\lbrack0,998244353)$。\n\n本题一共 $10$ 个点。\n\n其中 $3$ 个点 $n=2000$。\n\n另外 $7$ 个点 $n=10^5$。", "locale": "zh-CN"}}}
{"pid": "P5384", "type": "P", "difficulty": 6, "samples": [["5 2\n1 2 1 4\n2 1\n3 2", "1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "O2优化", "深度优先搜索 DFS", "差分"], "title": "[Cnoi2019] 雪松果树", "background": "幻想乡，冬。\n\n一年一度，生长在高山上的雪松果树又结果了。\n\nCirno 不知从哪弄到了 $1,2,3\\cdots9$ 颗雪松果,然后很开心的吃掉了其中 $6$ 颗，最后还剩最后 $1$ 颗。\n\nCirno 因为以后吃不到雪松果而感到忧愁，于是决定种在美丽的雾之湖畔。\n\n第一天，发芽。\n\n第二天，雪松果树长成了一颗参天大树，上面长满了雪松果。\n\nCirno 在雪松果成熟之前早有一些问题想知道，但现在她忙于收集雪松果，就把问题丢给了你。", "description": "雪松果树是一个以 $1$ 为根有着 $N$ 个节点的树。\n\n除此之外，Cirno 还有 $Q$ 个询问，每个询问是一个二元组 $(u,k)$，表示询问 $u$ 节点的 $k$-cousin 有多少个。\n\n我们定义:\n\n> 节点 $u$ 的 $1$-father 为 路径 $(1, u)$ （不含 u）上距 u 最近的节点\n>\n> 节点 $u$ 的 $k$-father 为 节点 「$u$ 的 $(k-1)$-father」 的 1-father\n>\n> 节点 $u$ 的 $k$-son 为所有 $k$-father 为 $u$ 的节点\n>\n> 节点 $u$ 的 $k$-cousin 为 节点「 $u$ 的 $k$-father」的 $k$-son (不包含 $u$ 本身)", "inputFormat": "第一行，两个整数 $N$, $Q$\n\n第二行，$N-1$ 个整数，第 $i$ 个表示 $i+1$ 号节点的 1-father\n\n以下 $Q$ 行，每行一个二元组$(u,k)$", "outputFormat": "一行，$Q$ 个数，每一个表示一个询问的答案。若 u 不存在 k-father，输出 0。", "hint": "数据范围：\n|数据点编号|$N\\le$|$Q\\le$|特殊性质|\n|----|----|----|-----|\n|1,2|$100$|$100$||\n|3,4|$100$|$10^6$||\n|5,6|$10^5$|$100$||\n|7|$10^4$|$5000$||\n|8,9,10|$10^5$|$10^5$||\n|11,12,13,14|$10^6$|$10^6$|**树随机生成**|\n|15,16,17,18,19,20|$10^6$|$10^6$||\n\n另外存在一组记 $20$ 分的 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Cedar Cone Tree.", "background": "Gensokyo, winter.\n\nOnce a year, the cedar cone trees growing on the high mountains bear fruit again.\n\nCirno somehow got $1,2,3\\cdots9$ cedar cones, then happily ate $6$ of them, and in the end only $1$ cone was left.\n\nCirno felt sad because she would not be able to eat cedar cones in the future, so she decided to plant it by the beautiful Misty Lake.\n\nOn the first day, it sprouted.\n\nOn the second day, the cedar cone tree grew into a towering tree, covered with cedar cones.\n\nCirno had some questions she wanted to know before the cedar cones ripened, but now she was busy collecting cedar cones, so she threw the questions to you.", "description": "The cedar cone tree is a tree with $N$ nodes rooted at $1$.\n\nIn addition, Cirno has $Q$ queries. Each query is an ordered pair $(u,k)$, asking how many $k$-cousins node $u$ has.\n\nWe define:\n\n> The 1-father of node $u$ is the node on the path $(1, u)$ (excluding $u$) that is closest to $u$.\n>\n> The $k$-father of node $u$ is the 1-father of the node “the $(k-1)$-father of $u$”.\n>\n> The $k$-son of node $u$ is the set of all nodes whose $k$-father is $u$.\n>\n> The $k$-cousin of node $u$ is the $k$-son of the node “the $k$-father of $u$” (excluding $u$ itself).", "inputFormat": "The first line contains two integers $N$ and $Q$.\n\nThe second line contains $N-1$ integers. The $i$-th integer denotes the 1-father of node $i+1$.\n\nThe following $Q$ lines each contain an ordered pair $(u,k)$.", "outputFormat": "Output one line with $Q$ numbers, where each number is the answer to a query. If $u$ does not have a $k$-father, output $0$.", "hint": "Constraints:\n|Test Point ID|$N\\le$|$Q\\le$|Special Property|\n|----|----|----|-----|\n|1,2|$100$|$100$||\n|3,4|$100$|$10^6$||\n|5,6|$10^5$|$100$||\n|7|$10^4$|$5000$||\n|8,9,10|$10^5$|$10^5$||\n|11,12,13,14|$10^6$|$10^6$|**The tree is generated randomly**|\n|15,16,17,18,19,20|$10^6$|$10^6$||\n\nIn addition, there is a set of hack testdata worth $20$ points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 雪松果树", "background": "幻想乡，冬。\n\n一年一度，生长在高山上的雪松果树又结果了。\n\nCirno 不知从哪弄到了 $1,2,3\\cdots9$ 颗雪松果,然后很开心的吃掉了其中 $6$ 颗，最后还剩最后 $1$ 颗。\n\nCirno 因为以后吃不到雪松果而感到忧愁，于是决定种在美丽的雾之湖畔。\n\n第一天，发芽。\n\n第二天，雪松果树长成了一颗参天大树，上面长满了雪松果。\n\nCirno 在雪松果成熟之前早有一些问题想知道，但现在她忙于收集雪松果，就把问题丢给了你。", "description": "雪松果树是一个以 $1$ 为根有着 $N$ 个节点的树。\n\n除此之外，Cirno 还有 $Q$ 个询问，每个询问是一个二元组 $(u,k)$，表示询问 $u$ 节点的 $k$-cousin 有多少个。\n\n我们定义:\n\n> 节点 $u$ 的 $1$-father 为 路径 $(1, u)$ （不含 u）上距 u 最近的节点\n>\n> 节点 $u$ 的 $k$-father 为 节点 「$u$ 的 $(k-1)$-father」 的 1-father\n>\n> 节点 $u$ 的 $k$-son 为所有 $k$-father 为 $u$ 的节点\n>\n> 节点 $u$ 的 $k$-cousin 为 节点「 $u$ 的 $k$-father」的 $k$-son (不包含 $u$ 本身)", "inputFormat": "第一行，两个整数 $N$, $Q$\n\n第二行，$N-1$ 个整数，第 $i$ 个表示 $i+1$ 号节点的 1-father\n\n以下 $Q$ 行，每行一个二元组$(u,k)$", "outputFormat": "一行，$Q$ 个数，每一个表示一个询问的答案。若 u 不存在 k-father，输出 0。", "hint": "数据范围：\n|数据点编号|$N\\le$|$Q\\le$|特殊性质|\n|----|----|----|-----|\n|1,2|$100$|$100$||\n|3,4|$100$|$10^6$||\n|5,6|$10^5$|$100$||\n|7|$10^4$|$5000$||\n|8,9,10|$10^5$|$10^5$||\n|11,12,13,14|$10^6$|$10^6$|**树随机生成**|\n|15,16,17,18,19,20|$10^6$|$10^6$||\n\n另外存在一组记 $20$ 分的 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P5385", "type": "P", "difficulty": 6, "samples": [["5 5 4 0\n1 2\n3 4\n2 3\n4 5\n1 5\n1 3\n2 5\n3 4\n5 5", "2\n1\n3\n4"], ["见附件中 sample2.in", "见附件中 sample2.out"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "动态树 LCT", "可持久化线段树"], "title": "[Cnoi2019] 须臾幻境", "background": "这曾今有一个凄婉哀伤的故事，但是被出题人删档弄丢了。", "description": "初始时，你有一个 $n$ 个结点 $m$ 条边的无向图 $G$，结点的编号依次为 $1,2,\\cdots,n$。\n\n现在将 $G$ 中所有 $m$ 条边依次编号，排成一个长度为 $m$ 边序列 $E=(e_1,e_2,\\cdots,e_m)$，其中 $e_i=(u_i,v_i)$ 是一个二元组，表示一个连接 $u_i$ 与 $v_i$ 的无向边。\n\n然后 Cirno 会给你 $q$ 个询问二元组 $( l, r )$，表示询问「如果只保留 $e_l,e_{l+1},\\cdots e_r$ 这个区间内的边的话，图中的联通块的个数」。\n\n时间紧急，你需要设计尽可能快的算法解决 Cirno 的询问，而且由于在某些情况下询问之间也许互相依赖，你的程序需要保持在线运行。", "inputFormat": "第一行，四个整数，用空格隔开，分别表示 $n$, $m$, $q$, $t$, 其中 $t$ 表示强制在线参数，用于解密真实的询问。\n\n接下来的 $m$ 行，其中第 $i$ 行包含两个整数 $u_i$ 与 $v_i$，用空格隔开，表示边序列 $E$。\n\n再接下来 $q$ 行，每行两个整数 $l', r'$，用空格隔开，表示一组加密后的询问。\n\n真实的询问二元组 $(l,r)$ 由以下方式解密\n\n```plain-text\nDecodeQuery( l', r', m, t, last_ans )\n\t(l, r) <- (l', r')\n    IF t > 0 THEN \n        l <- (l + t * last_ans) Mod |E| + 1\n        r <- (r + t * last_ans) Mod |E| + 1\n    IF l' > r' THEN \n        Swap(l, r)\n    RETURN (l, r)\n```\n\n其中 `last_ans` 表示上一次询问的答案，初始时 `last_ans = 0`.", "outputFormat": "$q$ 行，表示每个询问的答案。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k2c1fizv.png)\n\n**数据范围与约定**\n\n对于 $100\\%$ 的数据保证，$1\\le |V| \\le 10^5, 1\\le |E| \\le 2\\times 10^5, 1\\le q \\le 10^5, t \\in \\{0,1\\}$。**注意数据可能包含重边和自环**。\n\n**子任务**\n\nSubtask1（$15$ points）：$|V|, |E|, q \\le 5000$；\n\nSubtask2（$25$ points）：$t = 0$；\n\nSubtask3（$20$ points）：$|V| \\le 10^4, |E|, q \\le 3\\times 10^4$\n\nSubtask3（$40$ points）：无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Momentary Illusion Realm.", "background": "There used to be a sad and touching story here, but the problem setter deleted the file and it was lost.", "description": "Initially, you are given an undirected graph $G$ with $n$ vertices and $m$ edges. The vertices are numbered $1,2,\\cdots,n$.\n\nNow, number all $m$ edges in $G$ in order and arrange them into an edge sequence of length $m$: $E=(e_1,e_2,\\cdots,e_m)$, where $e_i=(u_i,v_i)$ is an ordered pair representing an undirected edge connecting $u_i$ and $v_i$.\n\nThen Cirno will give you $q$ query pairs $(l,r)$, asking: “If we only keep the edges $e_l,e_{l+1},\\cdots,e_r$ in this interval, what is the number of connected components in the graph?”\n\nTime is tight. You need to design an algorithm as fast as possible to answer Cirno’s queries. Also, since in some cases queries may depend on each other, your program must run online.", "inputFormat": "The first line contains four integers separated by spaces: $n$, $m$, $q$, $t$, where $t$ is the forced-online parameter used to decrypt the real queries.\n\nThe next $m$ lines describe the edges. The $i$-th line contains two integers $u_i$ and $v_i$ separated by a space, representing the edge sequence $E$.\n\nThe next $q$ lines each contain two integers $l', r'$ separated by spaces, representing an encrypted query.\n\nThe real query pair $(l,r)$ is decrypted as follows.\n\n```plain-text\nDecodeQuery( l', r', m, t, last_ans )\n\t(l, r) <- (l', r')\n    IF t > 0 THEN \n        l <- (l + t * last_ans) Mod |E| + 1\n        r <- (r + t * last_ans) Mod |E| + 1\n    IF l' > r' THEN \n        Swap(l, r)\n    RETURN (l, r)\n```\n\nHere, `last_ans` is the answer to the previous query. Initially, `last_ans = 0`.", "outputFormat": "Output $q$ lines, each being the answer to one query.", "hint": "**Sample Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k2c1fizv.png)\n\n**Constraints and Notes**\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le |V| \\le 10^5$, $1\\le |E| \\le 2\\times 10^5$, $1\\le q \\le 10^5$, and $t \\in \\{0,1\\}$. **Note that the testdata may contain multiple edges and self-loops**.\n\n**Subtasks**\n\nSubtask 1 ($15$ points): $|V|, |E|, q \\le 5000$.\n\nSubtask 2 ($25$ points): $t = 0$.\n\nSubtask 3 ($20$ points): $|V| \\le 10^4$, $|E|, q \\le 3\\times 10^4$.\n\nSubtask 4 ($40$ points): No special restrictions.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 须臾幻境", "background": "这曾今有一个凄婉哀伤的故事，但是被出题人删档弄丢了。", "description": "初始时，你有一个 $n$ 个结点 $m$ 条边的无向图 $G$，结点的编号依次为 $1,2,\\cdots,n$。\n\n现在将 $G$ 中所有 $m$ 条边依次编号，排成一个长度为 $m$ 边序列 $E=(e_1,e_2,\\cdots,e_m)$，其中 $e_i=(u_i,v_i)$ 是一个二元组，表示一个连接 $u_i$ 与 $v_i$ 的无向边。\n\n然后 Cirno 会给你 $q$ 个询问二元组 $( l, r )$，表示询问「如果只保留 $e_l,e_{l+1},\\cdots e_r$ 这个区间内的边的话，图中的联通块的个数」。\n\n时间紧急，你需要设计尽可能快的算法解决 Cirno 的询问，而且由于在某些情况下询问之间也许互相依赖，你的程序需要保持在线运行。", "inputFormat": "第一行，四个整数，用空格隔开，分别表示 $n$, $m$, $q$, $t$, 其中 $t$ 表示强制在线参数，用于解密真实的询问。\n\n接下来的 $m$ 行，其中第 $i$ 行包含两个整数 $u_i$ 与 $v_i$，用空格隔开，表示边序列 $E$。\n\n再接下来 $q$ 行，每行两个整数 $l', r'$，用空格隔开，表示一组加密后的询问。\n\n真实的询问二元组 $(l,r)$ 由以下方式解密\n\n```plain-text\nDecodeQuery( l', r', m, t, last_ans )\n\t(l, r) <- (l', r')\n    IF t > 0 THEN \n        l <- (l + t * last_ans) Mod |E| + 1\n        r <- (r + t * last_ans) Mod |E| + 1\n    IF l' > r' THEN \n        Swap(l, r)\n    RETURN (l, r)\n```\n\n其中 `last_ans` 表示上一次询问的答案，初始时 `last_ans = 0`.", "outputFormat": "$q$ 行，表示每个询问的答案。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k2c1fizv.png)\n\n**数据范围与约定**\n\n对于 $100\\%$ 的数据保证，$1\\le |V| \\le 10^5, 1\\le |E| \\le 2\\times 10^5, 1\\le q \\le 10^5, t \\in \\{0,1\\}$。**注意数据可能包含重边和自环**。\n\n**子任务**\n\nSubtask1（$15$ points）：$|V|, |E|, q \\le 5000$；\n\nSubtask2（$25$ points）：$t = 0$；\n\nSubtask3（$20$ points）：$|V| \\le 10^4, |E|, q \\le 3\\times 10^4$\n\nSubtask3（$40$ points）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5386", "type": "P", "difficulty": 7, "samples": [["4 1\n1 2 3 4\n1 4 2 4", "6"]], "limits": {"time": [3000, 3000, 3000, 7000, 7000, 7000], "memory": [128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "莫队", "分块"], "title": "[Cnoi2019] 数字游戏", "background": "", "description": "给定一个 $1\\sim n$ 的排列 $\\pi$，以及 $q$ 个询问，每个询问包含一个整数四元组 $( l, r, x, y )$，表示查询有多少个整数二元组 $( u, v )$ 满足：\n - $l\\le u\\le v\\le r$；\n - 且对于任意 $\\forall u\\le i\\le v$，有 $x\\le\\pi_i\\le y$。", "inputFormat": "第一行，两个整数 $n$，$q$。\n\n第二行 $n$ 个整数，表示 $\\pi$。\n\n以下 $q$ 行，每行一个四元组询问。", "outputFormat": "$q$ 行，每一行表示一个询问的答案。", "hint": "子任务 1（$34$ points）：$1\\le n, q \\le 3\\times10^4$。\n\n子任务 2（$66$ points）：$1\\le n, q \\le 2\\times10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Number Game", "background": "", "description": "Given a permutation $\\pi$ of $1 \\sim n$, and $q$ queries. Each query contains an integer quadruple $( l, r, x, y )$, asking how many integer pairs $( u, v )$ satisfy:\n- $l \\le u \\le v \\le r$;\n- and for all $\\forall u \\le i \\le v$, we have $x \\le \\pi_i \\le y$.", "inputFormat": "The first line contains two integers $n$ and $q$.\n\nThe second line contains $n$ integers, representing $\\pi$.\n\nIn the next $q$ lines, each line contains one query quadruple.", "outputFormat": "Output $q$ lines, where each line is the answer to one query.", "hint": "Subtask 1 ($34$ points): $1 \\le n, q \\le 3 \\times 10^4$.\n\nSubtask 2 ($66$ points): $1 \\le n, q \\le 2 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 数字游戏", "background": "", "description": "给定一个 $1\\sim n$ 的排列 $\\pi$，以及 $q$ 个询问，每个询问包含一个整数四元组 $( l, r, x, y )$，表示查询有多少个整数二元组 $( u, v )$ 满足：\n - $l\\le u\\le v\\le r$；\n - 且对于任意 $\\forall u\\le i\\le v$，有 $x\\le\\pi_i\\le y$。", "inputFormat": "第一行，两个整数 $n$，$q$。\n\n第二行 $n$ 个整数，表示 $\\pi$。\n\n以下 $q$ 行，每行一个四元组询问。", "outputFormat": "$q$ 行，每一行表示一个询问的答案。", "hint": "子任务 1（$34$ points）：$1\\le n, q \\le 3\\times10^4$。\n\n子任务 2（$66$ points）：$1\\le n, q \\le 2\\times10^5$。", "locale": "zh-CN"}}}
{"pid": "P5387", "type": "P", "difficulty": 6, "samples": [["4 5", "312"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["博弈论", "2019", "快速沃尔什变换 FWT"], "title": "[Cnoi2019] 人形演舞", "background": "由于出题人都退役了, 所以题目背景咕咕咕~了.", "description": "Cirno 与 Marisa 之间有一个博弈:\n\n首先给定 一个 **序列** $V$, 所有的数字都是在 $[1, m]$ 之间。\n\n每次一个人可以选取 $x \\in V, y \\in [1, x]$, 且 $ x \\oplus y \\in [0, x)$ , 然后把  $x$ 变为 $x \\oplus y$。\n\n$\\oplus$ 表示按位异或。\n\n当一个人不能操作时, 则视作失败。\n\n假定 Cirno 和 Marisa 都使用最优策略。\n\n现在 Cirno 想知道自己先手时获胜的方案数对 $998244353$ 取模后是多少。", "inputFormat": "一行，两个整数 $|V|, m$", "outputFormat": "一行，表示答案.", "hint": "对于 100% 的数据，$|V| \\le 10^{18}, m \\le 10^6$。\n\n采用捆绑测试。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Humanoid Danmaku.", "background": "Since the problem setters have all retired, the background has been put off indefinitely.", "description": "There is a game between Cirno and Marisa:\n\nFirst, a **sequence** $V$ is given, and all numbers are in $[1, m]$.\n\nOn each turn, a player may choose $x \\in V$, $y \\in [1, x]$, and require that $x \\oplus y \\in [0, x)$, then change $x$ into $x \\oplus y$.\n\n$\\oplus$ denotes bitwise XOR.\n\nIf a player cannot make a move, then that player is considered to lose.\n\nAssume that both Cirno and Marisa use optimal strategies.\n\nNow Cirno wants to know, when she moves first, what is the number of winning initial sequences modulo $998244353$.", "inputFormat": "One line with two integers $|V|$ and $m$.", "outputFormat": "One line, the answer.", "hint": "For $100\\%$ of the testdata, $|V| \\le 10^{18}$ and $m \\le 10^6$.\n\nThis problem uses bundled tests.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 人形演舞", "background": "由于出题人都退役了, 所以题目背景咕咕咕~了.", "description": "Cirno 与 Marisa 之间有一个博弈:\n\n首先给定 一个 **序列** $V$, 所有的数字都是在 $[1, m]$ 之间。\n\n每次一个人可以选取 $x \\in V, y \\in [1, x]$, 且 $ x \\oplus y \\in [0, x)$ , 然后把  $x$ 变为 $x \\oplus y$。\n\n$\\oplus$ 表示按位异或。\n\n当一个人不能操作时, 则视作失败。\n\n假定 Cirno 和 Marisa 都使用最优策略。\n\n现在 Cirno 想知道自己先手时获胜的方案数对 $998244353$ 取模后是多少。", "inputFormat": "一行，两个整数 $|V|, m$", "outputFormat": "一行，表示答案.", "hint": "对于 100% 的数据，$|V| \\le 10^{18}, m \\le 10^6$。\n\n采用捆绑测试。", "locale": "zh-CN"}}}
{"pid": "P5388", "type": "P", "difficulty": 7, "samples": [["3 4", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2019", "组合数学", "快速数论变换 NTT"], "title": "[Cnoi2019] 最终幻想", "background": "理论上来说，压轴的应该是一道数据结构题，可是它咕咕咕~了.", "description": "你有一个 $n$ 维超球, 求使用 $k$ 个 $n-1$ 维超平面可以将这个 $n$ 维超球划分成多少个 $n$ 维块。\n\n答案对 $998244353$ 取模。", "inputFormat": "输入两个数 $n,k$。", "outputFormat": "一行，表示答案。", "hint": "Subtask1( 21pts ) : $n \\le 10^6$\n\nSubtask2( 7pts )   : $k \\le n$\n\nSubtask3( 72pts ) : 无特殊限制\n\n对于 100% 的数据 $n, k \\in [1,998244353)$", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Final Fantasy", "background": "In theory, the final problem should be a data structure problem, but it got delayed again and again.", "description": "You have an $n$-dimensional hypersphere. Find how many $n$-dimensional regions it can be divided into using $k$ $(n-1)$-dimensional hyperplanes.\n\nTake the answer modulo $998244353$.", "inputFormat": "Input two numbers $n, k$.", "outputFormat": "One line, the answer.", "hint": "Subtask 1 (21 pts): $n \\le 10^6$.\n\nSubtask 2 (7 pts): $k \\le n$.\n\nSubtask 3 (72 pts): No special restrictions.\n\nConstraints: For $100\\%$ of the testdata, $n, k \\in [1, 998244353)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 最终幻想", "background": "理论上来说，压轴的应该是一道数据结构题，可是它咕咕咕~了.", "description": "你有一个 $n$ 维超球, 求使用 $k$ 个 $n-1$ 维超平面可以将这个 $n$ 维超球划分成多少个 $n$ 维块。\n\n答案对 $998244353$ 取模。", "inputFormat": "输入两个数 $n,k$。", "outputFormat": "一行，表示答案。", "hint": "Subtask1( 21pts ) : $n \\le 10^6$\n\nSubtask2( 7pts )   : $k \\le n$\n\nSubtask3( 72pts ) : 无特殊限制\n\n对于 100% 的数据 $n, k \\in [1,998244353)$", "locale": "zh-CN"}}}
{"pid": "P5389", "type": "P", "difficulty": 5, "samples": [["2", "686292993"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "概率论"], "title": "[Cnoi2019] 数学课", "background": "", "description": "聪明的 Cirno 开始学习计算，于是她很开心的算出了从 $1$ 一直加到 $n$。\n\n得到了一个 $n$ 项的数列 : $ \\{ a_n$ = $1 + 2 + 3 + 4 + ... + n \\} $\n\n为了验证自己算是否算错，她需要以某种规律从数列里取出两个元素 $v_1, v_2$（元素可以相同），并等概率的选出整数 $a \\in [ 1,v_1 ]$，$b \\in [ 1,v_2 ]$ 判断哪个比较大.\n\n所以她需要你来计算 $a>b$ 的概率。\n\n某种规律：\n选到数列第 $i$ 个元素的概率是：\n\n$$\\frac{a_i}{\\sum\\limits_{j=1}^n a_j}=\\frac{3i\\times(i+1)}{n(n+1)(n+2)}$$", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出在模 $998244353$ 意义下的概率。", "hint": "对于前 $5\\%$ 的数据 $n = 3$；\n\n对于前 $15\\%$ 的数据 $n \\le 100$；\n\n对于前 $30\\%$ 的数据  $n \\le 5000$；\n\n对于前 $55\\%$ 的数据 $n \\le 10^7$；\n\n对于前 $95\\%$ 的数据 $1\\le n \\le 10^{18}$ 且 $n, n+2$ 均不为 $998244353$ 的倍数；\n\n对于最后 $5\\%$ 的数据 $n = 0$ 表示 $n$ 为**正无穷**。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Math Class", "background": "", "description": "The smart Cirno started learning calculations, so she happily computed the sum from $1$ up to $n$.\n\nShe obtained an $n$-term sequence: $\\{ a_n = 1 + 2 + 3 + 4 + ... + n \\}$.\n\nTo check whether her calculation is wrong, she needs to pick two elements $v_1, v_2$ from the sequence according to some rule (the two elements may be the same), and then uniformly choose integers $a \\in [ 1, v_1 ]$ and $b \\in [ 1, v_2 ]$ to compare which one is larger.\n\nSo, she needs you to compute the probability that $a > b$.\n\nThe rule:\nThe probability of selecting the $i$-th element of the sequence is:\n\n$$\\frac{a_i}{\\sum\\limits_{j=1}^n a_j}=\\frac{3i\\times(i+1)}{n(n+1)(n+2)}$$", "inputFormat": "Input a positive integer $n$.", "outputFormat": "Output the probability modulo $998244353$.", "hint": "For the first $5\\%$ of the testdata, $n = 3$.\n\nFor the first $15\\%$ of the testdata, $n \\le 100$.\n\nFor the first $30\\%$ of the testdata, $n \\le 5000$.\n\nFor the first $55\\%$ of the testdata, $n \\le 10^7$.\n\nFor the first $95\\%$ of the testdata, $1 \\le n \\le 10^{18}$, and neither $n$ nor $n+2$ is a multiple of $998244353$.\n\nFor the last $5\\%$ of the testdata, $n = 0$ means $n$ is **positive infinity**.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 数学课", "background": "", "description": "聪明的 Cirno 开始学习计算，于是她很开心的算出了从 $1$ 一直加到 $n$。\n\n得到了一个 $n$ 项的数列 : $ \\{ a_n$ = $1 + 2 + 3 + 4 + ... + n \\} $\n\n为了验证自己算是否算错，她需要以某种规律从数列里取出两个元素 $v_1, v_2$（元素可以相同），并等概率的选出整数 $a \\in [ 1,v_1 ]$，$b \\in [ 1,v_2 ]$ 判断哪个比较大.\n\n所以她需要你来计算 $a>b$ 的概率。\n\n某种规律：\n选到数列第 $i$ 个元素的概率是：\n\n$$\\frac{a_i}{\\sum\\limits_{j=1}^n a_j}=\\frac{3i\\times(i+1)}{n(n+1)(n+2)}$$", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出在模 $998244353$ 意义下的概率。", "hint": "对于前 $5\\%$ 的数据 $n = 3$；\n\n对于前 $15\\%$ 的数据 $n \\le 100$；\n\n对于前 $30\\%$ 的数据  $n \\le 5000$；\n\n对于前 $55\\%$ 的数据 $n \\le 10^7$；\n\n对于前 $95\\%$ 的数据 $1\\le n \\le 10^{18}$ 且 $n, n+2$ 均不为 $998244353$ 的倍数；\n\n对于最后 $5\\%$ 的数据 $n = 0$ 表示 $n$ 为**正无穷**。", "locale": "zh-CN"}}}
{"pid": "P5390", "type": "P", "difficulty": 4, "samples": [["1\n3 1 2 3", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "组合数学", "位运算"], "title": "[Cnoi2019] 数学作业", "background": "幻想乡，春节，万家灯火。\n\nKamishirasawa Keine 老师自然不会放过这么好的机会，，，布置作业。", "description": "现在 Cirno 手上有着 $T$ 天的作业，每天的作业可以用一个二元组 $( n, V )$ 表示，其中 $n$ 表示集合的大小， $V$ 表示大小为 $n$ 的集合. 现在，Cirno 需要求出的是 $V$ 的所有子集的异或和的和，答案对 $998\\,244\\,353$ 取模。\n\n形式化地：\n\n$$\n\\text{ans}\\equiv \\sum_{S \\subseteq V} \\mathop{\\bigoplus}\\limits_{ s \\in S } s \\pmod {998\\,244\\,353}\n$$", "inputFormat": "第一行，一个整数 $T$。\n\n以下 $T$ 行，每行一个二元组 $( n, V )$。", "outputFormat": "$T$ 行，每行一个整数，表示答案。", "hint": "- Subtask 1（17pts）：$ T, n \\le 8 $；\n- Subtask 2（22pts）：$ T, n \\le 100 $；\n- Subtask 3（61pts）：$ T, n \\le 3\\times10^6 $。\n\n对于 $100\\%$ 的数据，$ \\sum |V| \\le 3 \\times 10^6, 0 \\le p \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Math Homework", "background": "Gensokyo, the Spring Festival, and lights in every home.\n\nTeacher Kamishirasawa Keine would of course not miss such a good chance... and assigned homework.", "description": "Now Cirno has homework for $T$ days. The homework for each day can be represented by an ordered pair $(n, V)$, where $n$ is the size of the set, and $V$ is a set of size $n$. Now Cirno needs to compute the sum of the XOR values over all subsets of $V$. The answer should be taken modulo $998\\,244\\,353$.\n\nFormally:\n\n$$\n\\text{ans}\\equiv \\sum_{S \\subseteq V} \\mathop{\\bigoplus}\\limits_{ s \\in S } s \\pmod {998\\,244\\,353}\n$$", "inputFormat": "The first line contains an integer $T$.\n\nThe following $T$ lines each contain an ordered pair $(n, V)$.", "outputFormat": "Output $T$ lines, each containing one integer representing the answer.", "hint": "- Subtask 1 (17 pts): $T, n \\le 8$.\n- Subtask 2 (22 pts): $T, n \\le 100$.\n- Subtask 3 (61 pts): $T, n \\le 3\\times 10^6$.\n\nFor $100\\%$ of the testdata, $\\sum |V| \\le 3 \\times 10^6, 0 \\le p \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 数学作业", "background": "幻想乡，春节，万家灯火。\n\nKamishirasawa Keine 老师自然不会放过这么好的机会，，，布置作业。", "description": "现在 Cirno 手上有着 $T$ 天的作业，每天的作业可以用一个二元组 $( n, V )$ 表示，其中 $n$ 表示集合的大小， $V$ 表示大小为 $n$ 的集合. 现在，Cirno 需要求出的是 $V$ 的所有子集的异或和的和，答案对 $998\\,244\\,353$ 取模。\n\n形式化地：\n\n$$\n\\text{ans}\\equiv \\sum_{S \\subseteq V} \\mathop{\\bigoplus}\\limits_{ s \\in S } s \\pmod {998\\,244\\,353}\n$$", "inputFormat": "第一行，一个整数 $T$。\n\n以下 $T$ 行，每行一个二元组 $( n, V )$。", "outputFormat": "$T$ 行，每行一个整数，表示答案。", "hint": "- Subtask 1（17pts）：$ T, n \\le 8 $；\n- Subtask 2（22pts）：$ T, n \\le 100 $；\n- Subtask 3（61pts）：$ T, n \\le 3\\times10^6 $。\n\n对于 $100\\%$ 的数据，$ \\sum |V| \\le 3 \\times 10^6, 0 \\le p \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5391", "type": "P", "difficulty": 6, "samples": [["4 10\nadd 10 3\nadd 5 2\nadd 3 3\nerase", "3\n4\n9\n4"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000], "memory": [65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2019", "O2优化", "背包 DP", "树链剖分"], "title": "[Cnoi2019] 青染之心", "background": "这里原本有着一个史诗般的可歌可泣的背景故事，可是这里空太小，写不下。", "description": "Cirno 初始有一个空的物品序列，一个大小为 $V$ 的背包，现在你有 $q$ 个操作，分为两种：\n\n- `add x y`：表示加入一种体积为 $x$, 价值为 $y$ 的物品到序列末尾。\n- `erase`：表示删除序列末尾的物品。\n\n在每个操作结束以后，你需要求出：\n\n假设序列中的每种物品都有无穷多个，Cirno 的背包可以装下的物品最大价值和。", "inputFormat": "第一行，两个整数，$q$，$V$ 分别表示操作数和背包大小。\n\n以下 $q$ 行，每行一个操作。", "outputFormat": "$q$ 行，每行表示每次操作后的答案。", "hint": "对于 $100\\%$ 的数据 $1\\le q, V, x, y \\le 2\\times10^4 $。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Cirno’s Dyed Heart", "background": "There was originally an epic and touching background story here, but this space is too small to write it down.", "description": "Cirno initially has an empty item sequence and a knapsack of size $V$. You are given $q$ operations of two types:\n\n- `add x y`: append a new type of item with volume $x$ and value $y$ to the end of the sequence.\n- `erase`: delete the item type at the end of the sequence.\n\nAfter each operation, you need to compute:\n\nAssuming each item type in the sequence has infinitely many copies, find the maximum total value that can be packed into Cirno’s knapsack.", "inputFormat": "The first line contains two integers $q$ and $V$, representing the number of operations and the knapsack size.\n\nThe next $q$ lines each contain one operation.", "outputFormat": "Output $q$ lines. Each line contains the answer after the corresponding operation.", "hint": "For $100\\%$ of the testdata, $1 \\le q, V, x, y \\le 2 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 青染之心", "background": "这里原本有着一个史诗般的可歌可泣的背景故事，可是这里空太小，写不下。", "description": "Cirno 初始有一个空的物品序列，一个大小为 $V$ 的背包，现在你有 $q$ 个操作，分为两种：\n\n- `add x y`：表示加入一种体积为 $x$, 价值为 $y$ 的物品到序列末尾。\n- `erase`：表示删除序列末尾的物品。\n\n在每个操作结束以后，你需要求出：\n\n假设序列中的每种物品都有无穷多个，Cirno 的背包可以装下的物品最大价值和。", "inputFormat": "第一行，两个整数，$q$，$V$ 分别表示操作数和背包大小。\n\n以下 $q$ 行，每行一个操作。", "outputFormat": "$q$ 行，每行表示每次操作后的答案。", "hint": "对于 $100\\%$ 的数据 $1\\le q, V, x, y \\le 2\\times10^4 $。", "locale": "zh-CN"}}}
{"pid": "P5392", "type": "P", "difficulty": 6, "samples": [["3 4", "181"], ["1000 8", "124141757"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "O2优化", "矩阵加速", "状态合并", "状压 DP"], "title": "[Cnoi2019] 雪松树之约", "background": "由于 Cirno 突然犯懒，所以背景故事咕咕咕了。", "description": "Cirno 定义了一种图：圆柱网络 $G( L, x )$ 。\n\n$G(L, x)$ 表示一个有 $L \\times x$ 个节点的图。\n\n其中每个节点都用一个整数二元组 $( a, b )$ 表示 $( 1 \\le a \\le L, 1 \\le b \\le x )$。\n\n对于 $ \\forall i \\in (1,L], \\ j \\in (0,x]$ , 节点 $(i, j)$ 与节点 $(i - 1, j)$ 之间有一条边。\n\n对于 $ \\forall i \\in [1,L], \\ j \\in (0,x)$ , 节点 $(i, j)$ 与节点 $(i, j +1)$ 之间有一条边。\n\n对于 $ \\forall i \\in [1,L]$ 节点 $(i, x)$ 与 节点 $(i, 1)$ 之间有一条边。\n\n现在 Cirno 想知道 $G( L, x )$ 的 **独立集** 的个数。\n\n由于你不会高精度，所以你需要将答案对 $998244353$ 取模。\n", "inputFormat": "一行，两个整数，$L$，$x$。", "outputFormat": "一行，一个整数，表示 $G(L,x)$ 的独立集的个数对 $998244353$ 取模后的结果。", "hint": "对于 前 $10\\%$ 的数据 $ L, x \\le 8 $。\n\n对于 前 $30\\%$ 的数据 $ x \\le 8 $。\n\n对于 前 $50\\%$ 的数据 $ x \\le 11 $。\n\n对于 $100\\%$ 的数据 $0 < L \\le 10^{18}, 0 <x \\le 17 $。\n\n本题采用捆绑测试。\n\n下图 是 $G( 3, 4 )$ 的示例图。\n\n![](https://cdn.luogu.com.cn/upload/pic/56163.png)", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Appointment of the Cedar Tree", "background": "Because Cirno suddenly became lazy, the background story is skipped.", "description": "Cirno defines a type of graph: the cylindrical network $G(L, x)$.\n\n$G(L, x)$ denotes a graph with $L \\times x$ nodes.\n\nEach node is represented by an ordered pair of integers $(a, b)$, where $(1 \\le a \\le L, 1 \\le b \\le x)$.\n\nFor $\\forall i \\in (1, L],\\ j \\in (0, x]$, there is an edge between node $(i, j)$ and node $(i - 1, j)$.\n\nFor $\\forall i \\in [1, L],\\ j \\in (0, x)$, there is an edge between node $(i, j)$ and node $(i, j + 1)$.\n\nFor $\\forall i \\in [1, L]$, there is an edge between node $(i, x)$ and node $(i, 1)$.\n\nNow Cirno wants to know the number of **independent sets** of $G(L, x)$.\n\nSince you cannot do big integer arithmetic, you need to output the answer modulo $998244353$.", "inputFormat": "One line with two integers $L$ and $x$.", "outputFormat": "One line with one integer, the number of independent sets of $G(L, x)$ modulo $998244353$.", "hint": "For the first $10\\%$ of the testdata, $L, x \\le 8$.\n\nFor the first $30\\%$ of the testdata, $x \\le 8$.\n\nFor the first $50\\%$ of the testdata, $x \\le 11$.\n\nFor $100\\%$ of the testdata, $0 < L \\le 10^{18},\\ 0 < x \\le 17$.\n\nThis problem uses bundled tests.\n\nThe figure below is an example of $G(3, 4)$.\n\n![](https://cdn.luogu.com.cn/upload/pic/56163.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 雪松树之约", "background": "由于 Cirno 突然犯懒，所以背景故事咕咕咕了。", "description": "Cirno 定义了一种图：圆柱网络 $G( L, x )$ 。\n\n$G(L, x)$ 表示一个有 $L \\times x$ 个节点的图。\n\n其中每个节点都用一个整数二元组 $( a, b )$ 表示 $( 1 \\le a \\le L, 1 \\le b \\le x )$。\n\n对于 $ \\forall i \\in (1,L], \\ j \\in (0,x]$ , 节点 $(i, j)$ 与节点 $(i - 1, j)$ 之间有一条边。\n\n对于 $ \\forall i \\in [1,L], \\ j \\in (0,x)$ , 节点 $(i, j)$ 与节点 $(i, j +1)$ 之间有一条边。\n\n对于 $ \\forall i \\in [1,L]$ 节点 $(i, x)$ 与 节点 $(i, 1)$ 之间有一条边。\n\n现在 Cirno 想知道 $G( L, x )$ 的 **独立集** 的个数。\n\n由于你不会高精度，所以你需要将答案对 $998244353$ 取模。\n", "inputFormat": "一行，两个整数，$L$，$x$。", "outputFormat": "一行，一个整数，表示 $G(L,x)$ 的独立集的个数对 $998244353$ 取模后的结果。", "hint": "对于 前 $10\\%$ 的数据 $ L, x \\le 8 $。\n\n对于 前 $30\\%$ 的数据 $ x \\le 8 $。\n\n对于 前 $50\\%$ 的数据 $ x \\le 11 $。\n\n对于 $100\\%$ 的数据 $0 < L \\le 10^{18}, 0 <x \\le 17 $。\n\n本题采用捆绑测试。\n\n下图 是 $G( 3, 4 )$ 的示例图。\n\n![](https://cdn.luogu.com.cn/upload/pic/56163.png)", "locale": "zh-CN"}}}
{"pid": "P5393", "type": "P", "difficulty": 7, "samples": [["3\n1 2 1", "1 1 1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "下降幂多项式转普通多项式", "background": "这是一道模板题\n", "description": "已知下降幂多项式 $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{\\underline{i}}$。\n\n求一个普通多项式 $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^i$。\n\n使得 $G(x)=F(x)$。\n\n所有运算均在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行一个正整数 $n$，如题所述。\n\n第二行 $n$ 个数，第 $i$ 个数表示 $a_{i-1}$。", "outputFormat": "一行 $n$ 个数，第 $i$ 个数为 $b_{i-1}$。", "hint": "对于所有数据 $a_i\\in\\lbrack0,998244353)$。\n\n本题一共 $10$ 个点。\n\n其中 $3$ 个点 $n=2000$。\n\n另外 $7$ 个点 $n=200000$。", "locale": "zh-CN", "translations": {"en": {"title": "Convert Falling-Factorial Polynomial to Ordinary Polynomial", "background": "This is a template problem.", "description": "You are given a falling-factorial polynomial $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{\\underline{i}}$.\n\nFind an ordinary polynomial $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^i$.\n\nSuch that $G(x)=F(x)$.\n\nAll operations are performed modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$, as described above.\n\nThe second line contains $n$ numbers, where the $i$-th number represents $a_{i-1}$.", "outputFormat": "Output one line with $n$ numbers, where the $i$-th number is $b_{i-1}$.", "hint": "For all testdata, $a_i\\in\\lbrack0,998244353)$.\n\nThis problem has $10$ subtasks.\n\nAmong them, $3$ subtasks have $n=2000$.\n\nThe other $7$ subtasks have $n=200000$.\n\nConstraints\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "下降幂多项式转普通多项式", "background": "这是一道模板题\n", "description": "已知下降幂多项式 $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{\\underline{i}}$。\n\n求一个普通多项式 $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^i$。\n\n使得 $G(x)=F(x)$。\n\n所有运算均在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行一个正整数 $n$，如题所述。\n\n第二行 $n$ 个数，第 $i$ 个数表示 $a_{i-1}$。", "outputFormat": "一行 $n$ 个数，第 $i$ 个数为 $b_{i-1}$。", "hint": "对于所有数据 $a_i\\in\\lbrack0,998244353)$。\n\n本题一共 $10$ 个点。\n\n其中 $3$ 个点 $n=2000$。\n\n另外 $7$ 个点 $n=200000$。", "locale": "zh-CN"}}}
{"pid": "P5394", "type": "P", "difficulty": 6, "samples": [["2 3\n1 2 3\n1 2 3 4\n", "1 8 52 148 89 12\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】下降幂多项式乘法", "background": "模板题，无背景。", "description": "给定一个 $n$ 次下降幂多项式 $A(x)$ 和 $m$ 次下降幂多项式 $B(x)$，你要求出一个 $n+m$ 次下降幂多项式 $F(x)$ 满足 $F(x)=A(x)B(x)$。\n\n由于结果会很大，你输出的多项式的系数应对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$，表示下降幂多项式的次数。\n\n第二行 $n+1$ 个非负整数 $a_0,a_1,a_2,\\dots,a_n$，表示 $A(x)$ 的系数。即 $A(x)=a_0+a_1x+a_2x^{\\underline 2}+\\dots+a_nx^{\\underline n}$。\n\n第三行$m+1$个非负整数$b_0,b_1,b_2,\\dots,b_m$，表示 $B(x)$ 的系数。即 $B(x)=b_0+b_1x+b_2x^{\\underline 2}+\\dots+b_mx^{\\underline m}$。\n\n", "outputFormat": "一行，共 $n+m+1$ 个非负整数，表示 $F(x)$ 的各项系数对 $998244353$ 取模后的结果。", "hint": "对于 $20\\%$的数据，$n,m\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n,m\\leqslant 10^5$，$a_i,b_i\\in[0,998244353)$，$a_n,b_m \\neq 0$。\n\n## 提示\n\n$x^{\\underline n}=\\left\\{\\begin{matrix}1 & n=0\\\\ x\\times (x-1)^{\\underline{n-1}} & n\\geqslant 1 \\end{matrix}\\right.$\n\n$\\sum\\limits_{i=0}^n a_ix^{\\underline i},a_n\\neq 0$ 是 $x$ 的 $n$ 次下降幂多项式。\n\n容易证明 $n$ 次下降幂多项式唯一确定一个 $n$ 次多项式，所以下降幂多项式乘积的定义就是对应的多项式的乘积对应的下降幂多项式。 ", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Falling Factorial Polynomial Multiplication", "background": "This is a template problem, with no background.", "description": "Given a degree $n$ falling factorial polynomial $A(x)$ and a degree $m$ falling factorial polynomial $B(x)$, you need to compute a degree $n+m$ falling factorial polynomial $F(x)$ such that $F(x)=A(x)B(x)$.\n\nSince the result can be very large, output the coefficients of the polynomial modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n,m$, representing the degrees of the falling factorial polynomials.\n\nThe second line contains $n+1$ non-negative integers $a_0,a_1,a_2,\\dots,a_n$, representing the coefficients of $A(x)$. That is, $A(x)=a_0+a_1x+a_2x^{\\underline 2}+\\dots+a_nx^{\\underline n}$.\n\nThe third line contains $m+1$ non-negative integers $b_0,b_1,b_2,\\dots,b_m$, representing the coefficients of $B(x)$. That is, $B(x)=b_0+b_1x+b_2x^{\\underline 2}+\\dots+b_mx^{\\underline m}$.", "outputFormat": "Output one line with $n+m+1$ non-negative integers, representing the coefficients of $F(x)$ modulo $998244353$.", "hint": "For $20\\%$ of the testdata, $n,m\\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1\\leqslant n,m\\leqslant 10^5$, $a_i,b_i\\in[0,998244353)$, and $a_n,b_m \\neq 0$.\n\n$x^{\\underline n}=\\left\\{\\begin{matrix}1 & n=0\\\\ x\\times (x-1)^{\\underline{n-1}} & n\\geqslant 1 \\end{matrix}\\right.$\n\n$\\sum\\limits_{i=0}^n a_ix^{\\underline i},a_n\\neq 0$ is a degree $n$ falling factorial polynomial in $x$.\n\nIt is easy to prove that a degree $n$ falling factorial polynomial uniquely determines a degree $n$ polynomial. Therefore, the definition of the product of falling factorial polynomials is: take the product of the corresponding polynomials, and then convert it back to the corresponding falling factorial polynomial.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】下降幂多项式乘法", "background": "模板题，无背景。", "description": "给定一个 $n$ 次下降幂多项式 $A(x)$ 和 $m$ 次下降幂多项式 $B(x)$，你要求出一个 $n+m$ 次下降幂多项式 $F(x)$ 满足 $F(x)=A(x)B(x)$。\n\n由于结果会很大，你输出的多项式的系数应对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$，表示下降幂多项式的次数。\n\n第二行 $n+1$ 个非负整数 $a_0,a_1,a_2,\\dots,a_n$，表示 $A(x)$ 的系数。即 $A(x)=a_0+a_1x+a_2x^{\\underline 2}+\\dots+a_nx^{\\underline n}$。\n\n第三行$m+1$个非负整数$b_0,b_1,b_2,\\dots,b_m$，表示 $B(x)$ 的系数。即 $B(x)=b_0+b_1x+b_2x^{\\underline 2}+\\dots+b_mx^{\\underline m}$。\n\n", "outputFormat": "一行，共 $n+m+1$ 个非负整数，表示 $F(x)$ 的各项系数对 $998244353$ 取模后的结果。", "hint": "对于 $20\\%$的数据，$n,m\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n,m\\leqslant 10^5$，$a_i,b_i\\in[0,998244353)$，$a_n,b_m \\neq 0$。\n\n## 提示\n\n$x^{\\underline n}=\\left\\{\\begin{matrix}1 & n=0\\\\ x\\times (x-1)^{\\underline{n-1}} & n\\geqslant 1 \\end{matrix}\\right.$\n\n$\\sum\\limits_{i=0}^n a_ix^{\\underline i},a_n\\neq 0$ 是 $x$ 的 $n$ 次下降幂多项式。\n\n容易证明 $n$ 次下降幂多项式唯一确定一个 $n$ 次多项式，所以下降幂多项式乘积的定义就是对应的多项式的乘积对应的下降幂多项式。 ", "locale": "zh-CN"}}}
{"pid": "P5395", "type": "P", "difficulty": 6, "samples": [["3\n", "0 1 3 1\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Stirling 数"], "title": "第二类斯特林数·行", "background": null, "description": "第二类斯特林数 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ 表示把 $n$ 个**不同**元素划分成 $m$ 个**相同**的集合中（不能有空集）的方案数。\n\n给定 $n$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{Bmatrix} n \\\\i \\end{Bmatrix}$。\n\n由于答案会非常大，所以你的输出需要**对 $\\bm{167772161}$（$\\bm{2^{25}\\times 5+1}$，是一个质数）取模**。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{Bmatrix} n \\\\0 \\end{Bmatrix},\\begin{Bmatrix} n \\\\1 \\end{Bmatrix},\\begin{Bmatrix} n \\\\2 \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\n \\end{Bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 2\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Stirling Numbers of the Second Kind · Row", "background": "", "description": "The Stirling number of the second kind $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ is the number of ways to partition $n$ **distinct** elements into $m$ **identical** non-empty sets.\n\nGiven $n$, for every integer $i \\in [0,n]$, you need to compute $\\begin{Bmatrix} n \\\\i \\end{Bmatrix}$.\n\nSince the answer can be very large, you must output the result **modulo $\\bm{167772161}$ ($\\bm{2^{25}\\times 5+1}$, which is a prime)**.", "inputFormat": "A single line containing a positive integer $n$, as described above.", "outputFormat": "A single line containing $n+1$ non-negative integers.\n\nOutput, in order, the values of $\\begin{Bmatrix} n \\\\0 \\end{Bmatrix},\\begin{Bmatrix} n \\\\1 \\end{Bmatrix},\\begin{Bmatrix} n \\\\2 \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\n \\end{Bmatrix}$.", "hint": "For $20\\%$ of the testdata, $n \\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leqslant n \\leqslant 2\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "第二类斯特林数·行", "background": null, "description": "第二类斯特林数 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ 表示把 $n$ 个**不同**元素划分成 $m$ 个**相同**的集合中（不能有空集）的方案数。\n\n给定 $n$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{Bmatrix} n \\\\i \\end{Bmatrix}$。\n\n由于答案会非常大，所以你的输出需要**对 $\\bm{167772161}$（$\\bm{2^{25}\\times 5+1}$，是一个质数）取模**。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{Bmatrix} n \\\\0 \\end{Bmatrix},\\begin{Bmatrix} n \\\\1 \\end{Bmatrix},\\begin{Bmatrix} n \\\\2 \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\n \\end{Bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 2\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5396", "type": "P", "difficulty": 7, "samples": [["3 2\n", "0 0 1 3\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Stirling 数"], "title": "第二类斯特林数·列", "background": "**验题人提示：程序运行时间受评测压力影响较大，评测高峰可能会被卡常。**", "description": "第二类斯特林数 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ 表示把 $n$ 个**不同**元素划分成 $m$ 个**相同**的集合（不能有空集）的方案数。\n\n给定 $n,k$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{Bmatrix} i \\\\k \\end{Bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行两个正整数 $n,k$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{Bmatrix} 0 \\\\k \\end{Bmatrix},\\begin{Bmatrix} 1 \\\\k \\end{Bmatrix},\\begin{Bmatrix} 2 \\\\k \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\k \\end{Bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant k,  n<131072$。", "locale": "zh-CN", "translations": {"en": {"title": "Stirling Numbers of the Second Kind · Sequence.", "background": "**Tester’s note: The program running time is greatly affected by judging load, and it may be slowed down during peak times.**", "description": "The Stirling number of the second kind $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ denotes the number of ways to partition $n$ **distinct** elements into $m$ **identical** non-empty sets.\n\nGiven $n, k$, for every integer $i \\in [0, n]$, you need to compute $\\begin{Bmatrix} i \\\\k \\end{Bmatrix}$.\n\nSince the answer can be very large, you need to output it modulo $167772161$ ($2^{25}\\times 5+1$, which is a prime).", "inputFormat": "One line with two positive integers $n, k$, as described above.", "outputFormat": "One line with $n+1$ non-negative integers.\n\nYou need to output, in order, the values of $\\begin{Bmatrix} 0 \\\\k \\end{Bmatrix}, \\begin{Bmatrix} 1 \\\\k \\end{Bmatrix}, \\begin{Bmatrix} 2 \\\\k \\end{Bmatrix}, \\dots, \\begin{Bmatrix} n \\\\k \\end{Bmatrix}$.", "hint": "For $20\\%$ of the testdata, $n \\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leqslant k, n < 131072$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "第二类斯特林数·列", "background": "**验题人提示：程序运行时间受评测压力影响较大，评测高峰可能会被卡常。**", "description": "第二类斯特林数 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ 表示把 $n$ 个**不同**元素划分成 $m$ 个**相同**的集合（不能有空集）的方案数。\n\n给定 $n,k$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{Bmatrix} i \\\\k \\end{Bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行两个正整数 $n,k$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{Bmatrix} 0 \\\\k \\end{Bmatrix},\\begin{Bmatrix} 1 \\\\k \\end{Bmatrix},\\begin{Bmatrix} 2 \\\\k \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\k \\end{Bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant k,  n<131072$。", "locale": "zh-CN"}}}
{"pid": "P5397", "type": "P", "difficulty": 7, "samples": [["5 5\n1 2 2 4 4\n2 3 3\n2 2 4\n1 3 2\n1 5 5\n2 2 5\n", "Ikaros\n1\n1\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2018", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2018] 天降之物", "background": "可曾做过这样的梦呢？\n\n在我身边，有一个我从没见过的少女\n\n我很喜欢她，她也很喜欢我\n\n不过——\n\n最后总是\n\n在她被天空掳去的时候\n\n迎来梦醒时分\n\n ![](https://cdn.luogu.com.cn/upload/pic/58812.png)  \n\n人？\n\n不对\n\n不是人\n\n没有人会...\n\n长着翅膀\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58813.png)  \n\n没有没有没有\n\n哪里都没有\n\n没有我可以回去的地方\n\n我没有任何可以回去的地方！\n\n哪里都没有...\n\n我能回去的地方...无论哪里...无论哪里都没有...\n\n我不想杀死任何人，不想伤害任何人！\n\n为什么...为什么要制造出我...\n\n不需要...我不需要这种力量...\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58814.png)  \n\n幸福不足以形容我现在的心情\n\n我该说什么才好呢\n\n啊对了\n\n我...爱你\n\n我爱你...主人\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58815.png)  \n\n神话中的伊卡洛斯，由于过于靠近太阳，用蜡粘住的羽毛融化后坠海而死\n", "description": "伊卡洛斯给了你一个长为 $n$ 的序列 $a$。\n\n你需要实现 $m$ 个操作，操作有两种：\n\n1. 把序列中所有值为 $x$ 的数的值变成 $y$。\n2. 找出一个位置 $i$ 满足 $a_i=x$，找出一个位置 $j$ 满足 $a_j=y$，使得 $|i-j|$ 最小，并输出 $|i-j|$。", "inputFormat": "第一行两个整数 $n,m$。\n\n之后一行 $n$ 个整数，表示序列 $a$。\n\n之后 $m$ 行，每行三个数 $opt,x,y$。\n\n如果 $opt$ 为 $1$，代表把序列中所有值为 $x$ 位置的值变成 $y$。\n\n如果 $opt$ 为 $2$，代表找出一个位置 $i$ 满足 $a_i=x$，找出一个位置 $j$ 满足 $a_j=y$，使得 $|i-j|$ 最小，并输出 $|i-j|$，如果找不出这样的位置，输出 `Ikaros`。\n\n本题强制在线，每次的 $x,y$ 需要 xor 上上次答案，如果输出 `Ikaros`，或者是第一次询问，则上次答案为 $0$。\n\n共 $50$ 组数据，数据中保证 $n=m$。", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。\n\n如果无法找出满足题意的 $i,j$，则输出 `Ikaros`。\n", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477( partially uploaded )\n\n对于 $100\\%$ 的数据，所有数在 $[1,10^5]$ 内，每次操作的值不超过 $n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] Things Falling from the Sky", "background": "Have you ever had a dream like this?\n\nBeside me, there is a girl I have never met before.\n\nI like her a lot, and she likes me a lot too.\n\nBut—\n\nIn the end, it is always\n\nWhen she is taken away by the sky,\n\nThat I wake up from the dream.\n\n ![](https://cdn.luogu.com.cn/upload/pic/58812.png)  \n\nHuman?\n\nNo.\n\nNot human.\n\nNo one would...\n\nHave wings.\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58813.png)  \n\nNo, no, no.\n\nThere is nowhere.\n\nThere is nowhere I can go back to.\n\nI have no place I can go back to!\n\nNowhere...\n\nA place I can go back to... anywhere... nowhere at all...\n\nI do not want to kill anyone, and I do not want to hurt anyone!\n\nWhy... why did you create me...\n\nNo need... I do not need this kind of power...\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58814.png)  \n\n“Happiness” is not enough to describe how I feel right now.\n\nWhat should I say?\n\nAh, right.\n\nI... love you.\n\nI love you... Master.\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58815.png)  \n\nIn Greek mythology, Icarus flew too close to the sun; the feathers glued on with wax melted, and he fell into the sea and died.", "description": "Icarus gives you a sequence $a$ of length $n$.\n\nYou need to process $m$ operations. There are two types of operations:\n\n1. Change the value of every element equal to $x$ in the sequence to $y$.\n2. Find a position $i$ such that $a_i=x$ and a position $j$ such that $a_j=y$, so that $|i-j|$ is minimized, and output $|i-j|$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe next line contains $n$ integers, representing the sequence $a$.\n\nThen follow $m$ lines, each containing three numbers $opt,x,y$.\n\nIf $opt$ is $1$, it means changing the value at every position with value $x$ to $y$.\n\nIf $opt$ is $2$, it means finding a position $i$ such that $a_i=x$ and a position $j$ such that $a_j=y$ to minimize $|i-j|$, and output $|i-j|$. If no such positions can be found, output `Ikaros`.\n\nThis problem is strictly online. For each operation, $x,y$ need to be xor-ed with the answer from two queries ago. If the output is `Ikaros`, or if it is the first query, then the last answer is $0$.\n\nThere are $50$ test cases in total, and it is guaranteed that $n=m$.", "outputFormat": "For each operation of type $2$, output one line with an integer representing the answer.\n\nIf it is impossible to find $i,j$ that satisfy the statement, output `Ikaros`.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477 ( partially uploaded ).\n\nConstraints: For $100\\%$ of the testdata, all numbers are within $[1,10^5]$, and the value in each operation does not exceed $n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] 天降之物", "background": "可曾做过这样的梦呢？\n\n在我身边，有一个我从没见过的少女\n\n我很喜欢她，她也很喜欢我\n\n不过——\n\n最后总是\n\n在她被天空掳去的时候\n\n迎来梦醒时分\n\n ![](https://cdn.luogu.com.cn/upload/pic/58812.png)  \n\n人？\n\n不对\n\n不是人\n\n没有人会...\n\n长着翅膀\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58813.png)  \n\n没有没有没有\n\n哪里都没有\n\n没有我可以回去的地方\n\n我没有任何可以回去的地方！\n\n哪里都没有...\n\n我能回去的地方...无论哪里...无论哪里都没有...\n\n我不想杀死任何人，不想伤害任何人！\n\n为什么...为什么要制造出我...\n\n不需要...我不需要这种力量...\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58814.png)  \n\n幸福不足以形容我现在的心情\n\n我该说什么才好呢\n\n啊对了\n\n我...爱你\n\n我爱你...主人\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58815.png)  \n\n神话中的伊卡洛斯，由于过于靠近太阳，用蜡粘住的羽毛融化后坠海而死\n", "description": "伊卡洛斯给了你一个长为 $n$ 的序列 $a$。\n\n你需要实现 $m$ 个操作，操作有两种：\n\n1. 把序列中所有值为 $x$ 的数的值变成 $y$。\n2. 找出一个位置 $i$ 满足 $a_i=x$，找出一个位置 $j$ 满足 $a_j=y$，使得 $|i-j|$ 最小，并输出 $|i-j|$。", "inputFormat": "第一行两个整数 $n,m$。\n\n之后一行 $n$ 个整数，表示序列 $a$。\n\n之后 $m$ 行，每行三个数 $opt,x,y$。\n\n如果 $opt$ 为 $1$，代表把序列中所有值为 $x$ 位置的值变成 $y$。\n\n如果 $opt$ 为 $2$，代表找出一个位置 $i$ 满足 $a_i=x$，找出一个位置 $j$ 满足 $a_j=y$，使得 $|i-j|$ 最小，并输出 $|i-j|$，如果找不出这样的位置，输出 `Ikaros`。\n\n本题强制在线，每次的 $x,y$ 需要 xor 上上次答案，如果输出 `Ikaros`，或者是第一次询问，则上次答案为 $0$。\n\n共 $50$ 组数据，数据中保证 $n=m$。", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。\n\n如果无法找出满足题意的 $i,j$，则输出 `Ikaros`。\n", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477( partially uploaded )\n\n对于 $100\\%$ 的数据，所有数在 $[1,10^5]$ 内，每次操作的值不超过 $n$。", "locale": "zh-CN"}}}
{"pid": "P5398", "type": "P", "difficulty": 7, "samples": [["6 3\n1 1 4 5 1 4\n1 1\n4 5\n1 4\n", "1\n3\n10\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "莫队", "O2优化", "分块", "Ynoi", "根号分治", "离线处理"], "title": "[Ynoi2018] GOSICK", "background": "  ![](https://cdn.luogu.com.cn/upload/pic/58864.png)  \n洋...娃娃？\n\n“终于来了啊”\n\n“太慢了，伴随春天而来的死神”\n   ![](https://cdn.luogu.com.cn/upload/pic/58865.png)  \n维多利...加？\n\n你...手不疼吗\n\n手通红的啊\n\n“无路赛...振作一点”\n\n“如果在这里放弃的话就永远绝交了，久城！”\n\n“要一起回去”\n\n“之前也说过的吧 一起...”\n\n“我们俩分离的地方，不是这里吧”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58866.png)  \n\n“太慢了，伴随春天而来的死神”\n\n别生气嘛 我这也是很赶时间了\n\n信收到了吗\n\n“嗯，因为都很认真写上地址了”\n\n“运用智慧之泉，终于到达了这里”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58867.png)  \n\n无论世界如何改变\n\n这次之后 将再不分离\n\n\n", "description": "维多利加给了你一个序列 $a$，每次询问给一个区间 $[l,r]$。\n\n查询 $l \\leq i,j\\leq r$，且 $a_i$ 是 $a_j$ 倍数的二元组 $(i,j)$ 的个数。\n\n\n", "inputFormat": "第一行两个整数表示 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n之后 $m$ 行，每行两个整数 $l,r$ 表示一次询问。\n", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq 5\\times 10^5$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] GOSICK", "background": "![](https://cdn.luogu.com.cn/upload/pic/58864.png)  \nYo... dolls?\n\n“You finally came.”\n\n“So slow, the reaper who comes with spring.”\n![](https://cdn.luogu.com.cn/upload/pic/58865.png)  \nVicto... rica?\n\nYou... doesn’t your hand hurt?\n\nYour hand is all red.\n\n“Urusai... pull yourself together.”\n\n“If you give up here, then we will never talk again, Kujo!”\n\n“We are going back together.”\n\n“I told you before too, together...”\n\n“The place where we part, isn’t here, right?”\n\n![](https://cdn.luogu.com.cn/upload/pic/58866.png)\n\n“So slow, the reaper who comes with spring.”\n\nDon’t be mad, I was in a real hurry too.\n\nDid you receive the letter?\n\n“Yeah, because the address was written very carefully.”\n\n“Using the fountain of wisdom, we finally arrived here.”\n\n![](https://cdn.luogu.com.cn/upload/pic/58867.png)\n\nNo matter how the world changes,\n\nAfter this time, we will never be separated again.", "description": "Victo rica gives you a sequence $a$. Each query gives an interval $[l,r]$.\n\nCount the number of ordered pairs $(i,j)$ such that $l \\leq i,j \\leq r$ and $a_i$ is a multiple of $a_j$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers, representing the sequence $a$.\n\nThen follow $m$ lines, each containing two integers $l,r$, representing one query.", "outputFormat": "For each query, output one line with one integer, representing the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nConstraints: for $100\\%$ of the data, $1 \\leq n,m,a_i \\leq 5 \\times 10^5$, $1 \\leq l \\leq r \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] GOSICK", "background": "  ![](https://cdn.luogu.com.cn/upload/pic/58864.png)  \n洋...娃娃？\n\n“终于来了啊”\n\n“太慢了，伴随春天而来的死神”\n   ![](https://cdn.luogu.com.cn/upload/pic/58865.png)  \n维多利...加？\n\n你...手不疼吗\n\n手通红的啊\n\n“无路赛...振作一点”\n\n“如果在这里放弃的话就永远绝交了，久城！”\n\n“要一起回去”\n\n“之前也说过的吧 一起...”\n\n“我们俩分离的地方，不是这里吧”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58866.png)  \n\n“太慢了，伴随春天而来的死神”\n\n别生气嘛 我这也是很赶时间了\n\n信收到了吗\n\n“嗯，因为都很认真写上地址了”\n\n“运用智慧之泉，终于到达了这里”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58867.png)  \n\n无论世界如何改变\n\n这次之后 将再不分离\n\n\n", "description": "维多利加给了你一个序列 $a$，每次询问给一个区间 $[l,r]$。\n\n查询 $l \\leq i,j\\leq r$，且 $a_i$ 是 $a_j$ 倍数的二元组 $(i,j)$ 的个数。\n\n\n", "inputFormat": "第一行两个整数表示 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n之后 $m$ 行，每行两个整数 $l,r$ 表示一次询问。\n", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq 5\\times 10^5$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5399", "type": "P", "difficulty": 7, "samples": [["7\n1 1 2 3 5 2\n5\n5 1 5 0\n2 0 5 0\n2 2 4 5\n7 2 2 4\n3 2 5 4\n", "2\n3\n69\n57\n70\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2018", "O2优化", "Ynoi"], "title": "[Ynoi2018] 駄作", "background": "以前在书上读到的皮格马利翁神话——\n\n记得那在年幼的自己看来，非常滑稽。\n\n那是一心一意地，\n\n雕刻着自己理想中的女性的男人的故事。\n\n对现实中的女性根本不看一眼。\n\n不把人类放在眼里，只是一味地爱着无机物。\n\n爱着没有灵魂的对象。\n\n在当时的我看来，那行为是极为的愚蠢。\n\n多么悲惨啊。\n\n高举理想的旗帜、悲惨地制作着爱情的投影。\n\n自导自演自我满足——那是失败者的作为。\n\n最后那人得到了女神阿佛洛狄忒的同情，\n\n令雕像拥有了灵魂。\n\n是羞耻的极致。不会成为美谈。\n\n被愚蠢的故事破坏了心情的我，\n\n粗暴地丢下了那本书。\n\n在那时。\n\n我忽然感觉到了。\n\n如同脚尖悬空般的微微的高昂感。\n\n目光所不能直视的耀眼光晕。\n\n心脏深处温柔且安静地紧揪着的感觉。\n\n不知为何，温柔的心情在胸中弥漫。\n\n这第一次体会到的心情是什么呢？\n\n温暖、粘稠、浑浊。\n\n舒适的小憩。\n\n愚蠢的男人的故事。\n\n毫无拯救价值的，蠢男人的恋爱观。\n\n知道了这一点——\n\n我——\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58868.png)  \n\n“这种烦恼谁都没办法理解啊……”\n\n“呜呜，好难过……”\n\n……\n\n“……嗯？怎么在发呆啊？”\n\n哎？啊，不是。没什么啦。\n\n总觉得……和我很相似。\n\n因为是对谁也不能说出口的烦恼所以很辛苦。\n\n现在的枢大概也是同样的心情吧。\n\n枢还真是有着不为人知的艰辛啊。\n\n“啊哈哈，算是吧。”\n\n“因为我有性别认知障碍啊，身体和内心的性别是不一样的，所以没什么可以分\n担苦恼的人。”\n\n“像这种下半身的事情，怎么也不能和别的女孩子讨论呢。”\n\n确实如此啊……\n\n“啊，好想干脆让身体也变成女性啊……该怎么办才好呢。”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58869.png)  \n\n身体和内心的性别不一样吗……\n\n我倒不是性别认知障碍……\n\n不过，却非常理解枢的感受。\n\n“男性和女性都不能理解的烦恼……\n\n我就是个不完整的人吗……”\n\n怎么说不完整，才没这回事。\n\n“——是吗？”\n\n……啊。\n\n怎、怎么了……\n\n刚才，枢的气氛突然变了……\n\n“——我的烦恼啊，平时对谁也不会说的。”\n\n……\n\n“因为很难被理解啊，都当成是在开玩笑……根本没有谁真心想着帮我分担。”\n\n这……确实是呢……\n\n而我也是如此——\n\n“不过呢……”\n\n“——我挺想和由贵君商量的呢……”\n\n原本我就对枢抱有亲近感。\n\n心灵与身体的性别不一致的人。\n\n枢有着男性的身体和女性的内心。\n\n我也好枢也好……在旁人看来都是不完整的存在。\n\n不过……我——只有我能理解。\n\n——枢不是个不完整的人。\n\n正因为是同样不完整的存在，我才能从心底完全理解。\n\n我……对自己——想要枢理解我。\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58870.png)  \n\n“我们五人永远都是朋友……\n\n从前是……今后也是……”\n\n在大家安稳的话声中，我闭上眼。\n\n——不会消失。\n\n不管是星星的光辉，还是大家的温暖。\n\n已经牢牢地刻在了我的心中。\n\n一定不会忘记，五人一起度过的日子。\n\n我无论如何都不会忘记。绝不会忘记。\n\n是吗，我在寻求着啊……\n\n如此美好的羁绊……\n\n从心底里……\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58871.png)  \n\n枢惊讶的表情，慢慢地恢复了平静。\n\n我紧张地盯着枢的嘴唇，\n\n不知道他接下来要说什么。\n\n厌恶吗？恐惧吗？\n\n还是说勉强摆出生硬的笑容给我看？\n\n……哪个都会让人伤心难受。\n\n我很怕失去与枢之间的关系。\n\n“……由贵君。”\n\n心脏跳动着。\n\n“我——”\n\n枢所道出的话语，只有一句\n\n“——能接受由贵君。”\n\n我最期望着的话语——\n\n很有聪明的枢的风格的、简洁而又完美的话语。\n\n……谢谢。\n\n“诶嘿嘿……不用客气。”\n\n枢温柔的笑容包容着我。\n\n被人接受这件事，原来是如此惬意的啊……\n\n“……我说啊，由贵君”\n\n“和由贵君有着不普通的身体一样，我也不是普通的。”\n\n枢和我是不一样的……\n\n“不……我也是异常的。\n\n因为明明作为一个男性出生，却想成为女孩子。”\n\n“身体是男性……也没有胸部，也没有女性器。\n\n是真真正正的男性。”\n\n“明明这样还是想变成女性……\n\n我知道的。明明变不成……\n\n明明知道越是想成为女性就越会变得扭曲……”\n\n“即使如此我也想成为女性，不觉得我也是怪物吗？”\n\n……\n\n语塞了。\n\n但是，我仍然只是继续沉默着。\n\n这种时候，粉饰的话语也不会起什么作用。\n\n我知道随便的安慰是没有意义的。\n\n所以……我只是默默地凝视着枢。\n\n“呵呵，由贵君真是温柔呢……\n\n最清楚我是怎么想的。”\n\n因为我明白……枢的心情啊。\n\n听我如此说，枢便露出了发自内心的微笑。\n\n“有人能‘真正’理解我，这还是第一次。”\n\n我也是……终于遇见了能够接受自己的人。\n\n在漫长艰险的旅途尽头，我们终于得到了救赎。\n\n我也好，枢也好，都是与“普通”想去甚远的、\n\n因此才一直非常痛苦……\n\n不过我们终于——\n\n——遇到了能够理解自己的同伴。\n\n", "description": "菜菜子给了你一棵 $n$ 个节点的树，结点标号从 $1$ 到 $n$ 。\n\n定义树上两点 $a,b$ 的距离 $d(a,b)$ 是最小的非负整数 $k$ ，满足存在结点序列 $v_0,v_1,...,v_k$ ，满足 $v_0=a,v_k=b$ ，且对于 $0\\leq i\\leq k-1$ 有 $v_i$ 和 $v_{i+1}$ 之间在树上有一条边相连。\n\n有 $m$ 个询问，每个询问包含参数 $p_0,d_0,p_1,d_1$ ，求：\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$\n", "inputFormat": "第一行一个整数 $n$ ，表示树的节点数目。\n\n接下来一行 $n-1$ 个整数 $f_2,f_3,...,f_n$ ，依次表示 $i$ 和 $f_i$ （ $1\\leq f_i\\leq i-1$ ）之间有一条边。\n\n接下来一行一个整数 $m$ ，表示询问数目。\n\n接下来 $m$ 行依次描述所有询问：每行四个整数 $p_0,d_0,p_1,d_1$ （ $1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$ ）描述一组询问。\n\n\n", "outputFormat": "共 $m$ 行，依次回答各组询问：每行输出一行一个整数表示这组询问的答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5,1\\leq m\\leq 10^5$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] A Poor Work", "background": "The Pygmalion myth I once read in a book—\n\nBack when I was young, I found it very ridiculous.\n\nIt was the story of a man who devoted himself\n\nto carving the woman of his ideals.\n\nHe would not even glance at real women.\n\nHe looked down on humans, and only loved inorganic things.\n\nHe loved something without a soul.\n\nAt that time, I thought that behavior was extremely foolish.\n\nHow tragic.\n\nHolding high the banner of ideals, he miserably created a projection of love.\n\nSelf-directed and self-satisfied—that is what losers do.\n\nIn the end, the man received the pity of the goddess Aphrodite,\n\nand the statue was given a soul.\n\nThe height of shame. It would never be a beautiful tale.\n\nWith my mood ruined by that stupid story,\n\nI roughly threw the book aside.\n\nAt that moment.\n\nI suddenly felt it.\n\nA slight uplift, as if the tip of my foot was hanging in the air.\n\nA dazzling halo I could not look at directly.\n\nA gentle, quiet tightness deep in my heart.\n\nFor some reason, a gentle feeling spread through my chest.\n\nWhat was this feeling, which I was experiencing for the first time?\n\nWarm, sticky, murky.\n\nA comfortable nap.\n\nThe story of a foolish man.\n\nA fool’s view of love, with no value in being saved.\n\nRealizing that—\n\nI—\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58868.png)  \n\n“No one can understand this kind of trouble at all…”\n\n“Wuwu, it hurts so much…”\n\n……\n\n“…Huh? Why are you spacing out?”\n\nEh? Ah, no. It’s nothing.\n\nSomehow… it feels very similar to me.\n\nIt is hard because it is a worry I cannot tell anyone.\n\nShu is probably feeling the same way right now.\n\nShu really has hardships that others do not know about.\n\n“Ahaha, I guess so.”\n\n“Because I have gender identity disorder (xingbie renshi zhang’ai). My body and my inner gender are different, so there’s no one I can share my troubles with.”\n\n“For things like this about the lower body, there’s no way I can talk about it with other girls.”\n\nThat is indeed true…\n\n“Ah, I really want to just make my body become female too… what should I do?”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58869.png)  \n\nYour body and your inner gender are different…\n\nI am not someone with gender identity disorder…\n\nBut I understand Shu’s feelings very well.\n\n“Troubles that neither men nor women can understand…\n\nAm I… an incomplete person…?”\n\nHow could you be incomplete? That’s not true at all.\n\n“—Is that so?”\n\n…Ah.\n\nW-what is it…\n\nJust now, Shu’s mood suddenly changed…\n\n“—About my troubles, I normally wouldn’t tell anyone.”\n\n……\n\n“Because it’s hard to be understood. People treat it as a joke… no one truly wants to help me share the burden.”\n\nTh… that is true…\n\nAnd I am the same—\n\n“But…”\n\n“—I really want to talk it over with you, Yuki-kun…”\n\nI already felt close to Shu.\n\nA person whose mind and body do not match in gender.\n\nShu has a male body and a female heart.\n\nBoth Shu and I… in other people’s eyes, we are incomplete beings.\n\nBut… I—\n\nOnly I can understand.\n\n—Shu is not an incomplete person.\n\nPrecisely because we are both incomplete, I can fully understand from the bottom of my heart.\n\nI… for myself—I want Shu to understand me.\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58870.png)  \n\n“The five of us will always be friends…\n\nIn the past… and in the future too…”\n\nAmid everyone’s calm voices, I close my eyes.\n\n—It will not disappear.\n\nNeither the shine of the stars, nor everyone’s warmth.\n\nThey are already deeply engraved in my heart.\n\nI will definitely not forget the days the five of us spent together.\n\nNo matter what, I will not forget. I will never forget.\n\nSo that’s it, I was seeking it…\n\nSuch wonderful bonds…\n\nFrom the bottom of my heart…\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58871.png)  \n\nShu’s surprised expression slowly returned to calm.\n\nNervously, I stared at Shu’s lips,\n\nnot knowing what he would say next.\n\nDisgust? Fear?\n\nOr would he force out a stiff smile for me?\n\n…Any of those would make me sad and miserable.\n\nI was very afraid of losing my relationship with Shu.\n\n“…Yuki-kun.”\n\nMy heart was pounding.\n\n“I—”\n\nThe words Shu spoke were only one sentence.\n\n“—I can accept you, Yuki-kun.”\n\nThe words I wanted most—\n\nIn Shu’s smart style: simple yet perfect words.\n\n…Thank you.\n\n“Ehehe… you’re welcome.”\n\nShu’s gentle smile embraced me.\n\nBeing accepted by someone… feels so pleasant.\n\n“…Say, Yuki-kun.”\n\n“Just like you have an unusual body, I’m not ordinary either.”\n\nShu and I are not the same…\n\n“No… I am abnormal too.\n\nBecause even though I was born as a male, I want to become a girl.”\n\n“My body is male… I don’t have breasts, and I don’t have female genitalia.\n\nI’m a real male.”\n\n“Even so, I still want to become female…\n\nI know it. Even though I can’t become one…\n\nEven though I know the more I want to become female, the more twisted I will become…”\n\n“Even so, I still want to become female. Don’t you think I’m a monster too?”\n\n……\n\nI was at a loss for words.\n\nBut I still only kept silent.\n\nAt times like this, sugarcoated words will not help.\n\nI know casual comfort has no meaning.\n\nSo… I simply gazed at Shu in silence.\n\n“Hehe, Yuki-kun is really gentle…\n\nYou understand best what I’m thinking.”\n\nBecause I understand… Shu’s feelings.\n\nHearing me say that, Shu showed a smile from the bottom of his heart.\n\n“This is the first time someone has ‘truly’ understood me.”\n\nMe too… I finally met someone who could accept me.\n\nAt the end of a long and hard journey, we finally found salvation.\n\nBoth Shu and I are far from “ordinary”,\n\nand that is why we have suffered so much…\n\nBut finally we—\n\n—met a companion who can understand us.", "description": "Caicaizi gives you a tree with $n$ nodes, numbered from $1$ to $n$.\n\nDefine the distance $d(a,b)$ between two nodes $a,b$ on the tree as the smallest non-negative integer $k$ such that there exists a node sequence $v_0,v_1,...,v_k$ with $v_0=a,v_k=b$, and for $0\\leq i\\leq k-1$, there is an edge connecting $v_i$ and $v_{i+1}$ in the tree.\n\nThere are $m$ queries. Each query contains parameters $p_0,d_0,p_1,d_1$. Compute:\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$", "inputFormat": "The first line contains an integer $n$, representing the number of nodes in the tree.\n\nThe next line contains $n-1$ integers $f_2,f_3,...,f_n$, which indicate that there is an edge between $i$ and $f_i$ ($1\\leq f_i\\leq i-1$).\n\nThe next line contains an integer $m$, representing the number of queries.\n\nThe next $m$ lines describe all queries. Each line contains four integers $p_0,d_0,p_1,d_1$ ($1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$), describing one query.", "outputFormat": "Output $m$ lines, answering the queries in order. Each line outputs one integer, which is the answer to that query.", "hint": "Idea: nzhtl1477, Solution: ccz181078, Code: ccz181078, Data: ccz181078\n\nConstraints: for $100\\%$ of the data, $1\\leq n\\leq 10^5$ and $1\\leq m\\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] 駄作", "background": "以前在书上读到的皮格马利翁神话——\n\n记得那在年幼的自己看来，非常滑稽。\n\n那是一心一意地，\n\n雕刻着自己理想中的女性的男人的故事。\n\n对现实中的女性根本不看一眼。\n\n不把人类放在眼里，只是一味地爱着无机物。\n\n爱着没有灵魂的对象。\n\n在当时的我看来，那行为是极为的愚蠢。\n\n多么悲惨啊。\n\n高举理想的旗帜、悲惨地制作着爱情的投影。\n\n自导自演自我满足——那是失败者的作为。\n\n最后那人得到了女神阿佛洛狄忒的同情，\n\n令雕像拥有了灵魂。\n\n是羞耻的极致。不会成为美谈。\n\n被愚蠢的故事破坏了心情的我，\n\n粗暴地丢下了那本书。\n\n在那时。\n\n我忽然感觉到了。\n\n如同脚尖悬空般的微微的高昂感。\n\n目光所不能直视的耀眼光晕。\n\n心脏深处温柔且安静地紧揪着的感觉。\n\n不知为何，温柔的心情在胸中弥漫。\n\n这第一次体会到的心情是什么呢？\n\n温暖、粘稠、浑浊。\n\n舒适的小憩。\n\n愚蠢的男人的故事。\n\n毫无拯救价值的，蠢男人的恋爱观。\n\n知道了这一点——\n\n我——\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58868.png)  \n\n“这种烦恼谁都没办法理解啊……”\n\n“呜呜，好难过……”\n\n……\n\n“……嗯？怎么在发呆啊？”\n\n哎？啊，不是。没什么啦。\n\n总觉得……和我很相似。\n\n因为是对谁也不能说出口的烦恼所以很辛苦。\n\n现在的枢大概也是同样的心情吧。\n\n枢还真是有着不为人知的艰辛啊。\n\n“啊哈哈，算是吧。”\n\n“因为我有性别认知障碍啊，身体和内心的性别是不一样的，所以没什么可以分\n担苦恼的人。”\n\n“像这种下半身的事情，怎么也不能和别的女孩子讨论呢。”\n\n确实如此啊……\n\n“啊，好想干脆让身体也变成女性啊……该怎么办才好呢。”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58869.png)  \n\n身体和内心的性别不一样吗……\n\n我倒不是性别认知障碍……\n\n不过，却非常理解枢的感受。\n\n“男性和女性都不能理解的烦恼……\n\n我就是个不完整的人吗……”\n\n怎么说不完整，才没这回事。\n\n“——是吗？”\n\n……啊。\n\n怎、怎么了……\n\n刚才，枢的气氛突然变了……\n\n“——我的烦恼啊，平时对谁也不会说的。”\n\n……\n\n“因为很难被理解啊，都当成是在开玩笑……根本没有谁真心想着帮我分担。”\n\n这……确实是呢……\n\n而我也是如此——\n\n“不过呢……”\n\n“——我挺想和由贵君商量的呢……”\n\n原本我就对枢抱有亲近感。\n\n心灵与身体的性别不一致的人。\n\n枢有着男性的身体和女性的内心。\n\n我也好枢也好……在旁人看来都是不完整的存在。\n\n不过……我——只有我能理解。\n\n——枢不是个不完整的人。\n\n正因为是同样不完整的存在，我才能从心底完全理解。\n\n我……对自己——想要枢理解我。\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58870.png)  \n\n“我们五人永远都是朋友……\n\n从前是……今后也是……”\n\n在大家安稳的话声中，我闭上眼。\n\n——不会消失。\n\n不管是星星的光辉，还是大家的温暖。\n\n已经牢牢地刻在了我的心中。\n\n一定不会忘记，五人一起度过的日子。\n\n我无论如何都不会忘记。绝不会忘记。\n\n是吗，我在寻求着啊……\n\n如此美好的羁绊……\n\n从心底里……\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58871.png)  \n\n枢惊讶的表情，慢慢地恢复了平静。\n\n我紧张地盯着枢的嘴唇，\n\n不知道他接下来要说什么。\n\n厌恶吗？恐惧吗？\n\n还是说勉强摆出生硬的笑容给我看？\n\n……哪个都会让人伤心难受。\n\n我很怕失去与枢之间的关系。\n\n“……由贵君。”\n\n心脏跳动着。\n\n“我——”\n\n枢所道出的话语，只有一句\n\n“——能接受由贵君。”\n\n我最期望着的话语——\n\n很有聪明的枢的风格的、简洁而又完美的话语。\n\n……谢谢。\n\n“诶嘿嘿……不用客气。”\n\n枢温柔的笑容包容着我。\n\n被人接受这件事，原来是如此惬意的啊……\n\n“……我说啊，由贵君”\n\n“和由贵君有着不普通的身体一样，我也不是普通的。”\n\n枢和我是不一样的……\n\n“不……我也是异常的。\n\n因为明明作为一个男性出生，却想成为女孩子。”\n\n“身体是男性……也没有胸部，也没有女性器。\n\n是真真正正的男性。”\n\n“明明这样还是想变成女性……\n\n我知道的。明明变不成……\n\n明明知道越是想成为女性就越会变得扭曲……”\n\n“即使如此我也想成为女性，不觉得我也是怪物吗？”\n\n……\n\n语塞了。\n\n但是，我仍然只是继续沉默着。\n\n这种时候，粉饰的话语也不会起什么作用。\n\n我知道随便的安慰是没有意义的。\n\n所以……我只是默默地凝视着枢。\n\n“呵呵，由贵君真是温柔呢……\n\n最清楚我是怎么想的。”\n\n因为我明白……枢的心情啊。\n\n听我如此说，枢便露出了发自内心的微笑。\n\n“有人能‘真正’理解我，这还是第一次。”\n\n我也是……终于遇见了能够接受自己的人。\n\n在漫长艰险的旅途尽头，我们终于得到了救赎。\n\n我也好，枢也好，都是与“普通”想去甚远的、\n\n因此才一直非常痛苦……\n\n不过我们终于——\n\n——遇到了能够理解自己的同伴。\n\n", "description": "菜菜子给了你一棵 $n$ 个节点的树，结点标号从 $1$ 到 $n$ 。\n\n定义树上两点 $a,b$ 的距离 $d(a,b)$ 是最小的非负整数 $k$ ，满足存在结点序列 $v_0,v_1,...,v_k$ ，满足 $v_0=a,v_k=b$ ，且对于 $0\\leq i\\leq k-1$ 有 $v_i$ 和 $v_{i+1}$ 之间在树上有一条边相连。\n\n有 $m$ 个询问，每个询问包含参数 $p_0,d_0,p_1,d_1$ ，求：\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$\n", "inputFormat": "第一行一个整数 $n$ ，表示树的节点数目。\n\n接下来一行 $n-1$ 个整数 $f_2,f_3,...,f_n$ ，依次表示 $i$ 和 $f_i$ （ $1\\leq f_i\\leq i-1$ ）之间有一条边。\n\n接下来一行一个整数 $m$ ，表示询问数目。\n\n接下来 $m$ 行依次描述所有询问：每行四个整数 $p_0,d_0,p_1,d_1$ （ $1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$ ）描述一组询问。\n\n\n", "outputFormat": "共 $m$ 行，依次回答各组询问：每行输出一行一个整数表示这组询问的答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5,1\\leq m\\leq 10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P5400", "type": "P", "difficulty": 7, "samples": [["5\n1 1 1 1\n2 2 2 1\n7 8 9 3\n123 456 789 1\n1000 1000 1000 10", "1\n142606337\n736950806\n246172965\n189652652"], ["10\n4975401 4951343 4803566 22\n4499697 4989534 4995301 89\n4960387 4800714 4985451 20\n4549943 4925900 4582735 36\n3010525 4611932 4998770 67\n4980964 4865325 4531707 55\n2953628 4962026 4999540 52\n4599954 4988700 4817773 75\n4981351 4950027 4852696 16\n4695981 4993997 4953978 2\n", "856105281\n423884937\n154402492\n813209966\n683750161\n337149076\n838552619\n849850633\n605653899\n384868262\n"]], "limits": {"time": [12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "CTSC/CTS"], "title": "[CTS2019] 随机立方体", "background": "", "description": "有一个 $n\\times m\\times l$ 的立方体，立方体中每个格子上都有一个数，如果某个格子上的数比三维坐标**至少有一维**相同的其他格子上的数都要大的话，我们就称它是极大的。\n\n现在将 $1\\sim n\\times m\\times l$ 这 $n\\times m\\times l$ 个数等概率随机填入 $n\\times m\\times l$ 个格子（即任意数字出现在任意格子上的概率均相等），使得每个数恰出现一次，求恰有 $k$ 个极大的数的概率。答案对 $998244353$（一个质数）取模。", "inputFormat": "输入包含多组数据。输入第一行包含一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一组数据，包含 $4$ 个正整数 $n,m,l,k$，表示一次询问。 ", "outputFormat": "对于每次询问，输出一行一个整数，表示答案对 $998244353$ 取模的余数。\n\n可以证明，答案一定为有理数。设其为 $a/b$（$a$ 和 $b$ 为互质的正整数，数据保证 $b$ 不为 $998244353$ 的倍数），则你需要保证输出的数 $x$ 满足 $0\\le x < 998244353$ 且 $a\\equiv bx \\pmod{998244353}$。可以证明这样的 $x$ 唯一存在。", "hint": "对于 $10\\%$ 的数据，$n,m\\le 2$，$l\\le 3$，$k=1$。\n\n对于 $30\\%$ 的数据，$n,m,l,k\\le 12$。\n\n对于 $40\\%$ 的数据，$n,m,l\\le 100$。\n\n对于 $50\\%$ 的数据，$n,m,l\\le 1000$。\n\n对于 $60\\%$ 的数据，$n,m,l\\le 100000$，其中有占全部数据 $30\\%$ 的数据保证 $k=1$。\n\n对于 $80\\%$ 的数据，$n,m,l\\le 1000000$，其中有占全部数据 $40\\%$ 的数据保证 $k=1$。\n\n对于 $100\\%$ 的数据，$1\\le n,m,l\\le 5000000$，$1\\le k\\le 100$，$1\\le T\\le 10$。\n\n其中有 $50\\%$ 的数据保证 $k=1$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Random Cube", "background": "", "description": "There is an $n\\times m\\times l$ cube. Each cell in the cube contains a number. If the number in a cell is greater than the numbers in all other cells that share **at least one** coordinate (in 3D) with it, then we call it a maximal cell.\n\nNow place the $n\\times m\\times l$ numbers from $1$ to $n\\times m\\times l$ into the $n\\times m\\times l$ cells uniformly at random (that is, each number is equally likely to appear in any cell), with each number appearing exactly once. Find the probability that there are exactly $k$ maximal numbers. Output the answer modulo $998244353$ (a prime).", "inputFormat": "The input contains multiple test cases. The first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain four positive integers $n,m,l,k$, representing one query.", "outputFormat": "For each query, output one line with one integer, the remainder of the answer modulo $998244353$.\n\nIt can be proven that the answer is always a rational number. Suppose it is $a/b$ (where $a$ and $b$ are coprime positive integers, and the testdata guarantees that $b$ is not a multiple of $998244353$). Then you need to output a number $x$ such that $0\\le x < 998244353$ and $a\\equiv bx \\pmod{998244353}$. It can be proven that such an $x$ exists and is unique.", "hint": "For $10\\%$ of the testdata, $n,m\\le 2$, $l\\le 3$, and $k=1$.\n\nFor $30\\%$ of the testdata, $n,m,l,k\\le 12$.\n\nFor $40\\%$ of the testdata, $n,m,l\\le 100$.\n\nFor $50\\%$ of the testdata, $n,m,l\\le 1000$.\n\nFor $60\\%$ of the testdata, $n,m,l\\le 100000$, and among them, $30\\%$ of all testdata guarantees $k=1$.\n\nFor $80\\%$ of the testdata, $n,m,l\\le 1000000$, and among them, $40\\%$ of all testdata guarantees $k=1$.\n\nFor $100\\%$ of the testdata, $1\\le n,m,l\\le 5000000$, $1\\le k\\le 100$, and $1\\le T\\le 10$.\n\nAmong them, $50\\%$ of the testdata guarantees $k=1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 随机立方体", "background": "", "description": "有一个 $n\\times m\\times l$ 的立方体，立方体中每个格子上都有一个数，如果某个格子上的数比三维坐标**至少有一维**相同的其他格子上的数都要大的话，我们就称它是极大的。\n\n现在将 $1\\sim n\\times m\\times l$ 这 $n\\times m\\times l$ 个数等概率随机填入 $n\\times m\\times l$ 个格子（即任意数字出现在任意格子上的概率均相等），使得每个数恰出现一次，求恰有 $k$ 个极大的数的概率。答案对 $998244353$（一个质数）取模。", "inputFormat": "输入包含多组数据。输入第一行包含一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一组数据，包含 $4$ 个正整数 $n,m,l,k$，表示一次询问。 ", "outputFormat": "对于每次询问，输出一行一个整数，表示答案对 $998244353$ 取模的余数。\n\n可以证明，答案一定为有理数。设其为 $a/b$（$a$ 和 $b$ 为互质的正整数，数据保证 $b$ 不为 $998244353$ 的倍数），则你需要保证输出的数 $x$ 满足 $0\\le x < 998244353$ 且 $a\\equiv bx \\pmod{998244353}$。可以证明这样的 $x$ 唯一存在。", "hint": "对于 $10\\%$ 的数据，$n,m\\le 2$，$l\\le 3$，$k=1$。\n\n对于 $30\\%$ 的数据，$n,m,l,k\\le 12$。\n\n对于 $40\\%$ 的数据，$n,m,l\\le 100$。\n\n对于 $50\\%$ 的数据，$n,m,l\\le 1000$。\n\n对于 $60\\%$ 的数据，$n,m,l\\le 100000$，其中有占全部数据 $30\\%$ 的数据保证 $k=1$。\n\n对于 $80\\%$ 的数据，$n,m,l\\le 1000000$，其中有占全部数据 $40\\%$ 的数据保证 $k=1$。\n\n对于 $100\\%$ 的数据，$1\\le n,m,l\\le 5000000$，$1\\le k\\le 100$，$1\\le T\\le 10$。\n\n其中有 $50\\%$ 的数据保证 $k=1$。", "locale": "zh-CN"}}}
{"pid": "P5401", "type": "P", "difficulty": 7, "samples": [["2 2 1", "2"], ["8 10 4", "301103104"], ["998 1000 500", "762913089"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "CTSC/CTS"], "title": "[CTS2019] 珍珠", "background": "白云苍狗，沧海桑田。\n\n白云的眼前只剩下了模糊的一片。\n\n在若隐若现之中，它看到了一个个小小的珍珠，有一些发着五彩的光芒。这些珍珠是白兔留下来的，每颗珍珠有一个颜色，为 $D$ 种颜色中随机的一种。\n\n白云想把这些珍珠放进一些小瓶子中，每个瓶子能恰好容纳两颗珍珠。不过它也有要求，每个瓶子必须装满，并且装的都是相同颜色的珍珠。\n\n白云希望能得到至少 $m$ 个装满珍珠的瓶子，它想知道它的愿望能被实现的概率是多少呢？", "description": "有 $n$ 个在范围 $[1,D]$ 内的整数均匀随机变量。\n\n求至少能选出 $m$ 个瓶子，使得存在一种方案，选择一些变量，并把选出来的每一个变量放到一个瓶子中，满足每个瓶子都恰好装两个值相同的变量的概率。\n\n请输出概率乘上 $D^n$ 后对 $998244353$ 取模的值。取模部分说明可参考第一题。", "inputFormat": "输入仅一行，三个用空格隔开的整数 $D,n,m$。", "outputFormat": "输出一个整数，表示所求概率乘上 $D^n$ 后对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n情况 $1$ : 第一个变量为 $1$，第二个变量为 $1$\n\n情况 $2$ : 第一个变量为 $1$，第二个变量为 $2$\n\n情况 $3$ : 第一个变量为 $2$，第二个变量为 $1$\n\n情况 $4$ : 第一个变量为 $2$，第二个变量为 $2$\n\n其中情况 $1$ 和 $4$ 可以把两个变量放到一个瓶子中\n\n情况 $2$ 和 $3$ 中两个变量的值不相同，所以不能放到同一个瓶子中\n\n#### 测试数据约定\n![img](https://s2.ax1x.com/2019/05/17/Eq683D.png)\n\n所有测试点均满足 $0 \\leqslant  m \\leqslant  10^9,1 \\leqslant  n \\leqslant  10^9,1 \\leqslant  D \\leqslant  10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Pearls", "background": "Time passes and everything changes.\n\nIn front of Baiyun, only a blurred scene remains.\n\nIn the vague view, it saw many small pearls, some shining with colorful light. These pearls were left by the white rabbit. Each pearl has a color, randomly chosen from $D$ colors.\n\nBaiyun wants to put these pearls into some small bottles. Each bottle can hold exactly two pearls. It also has requirements: every bottle must be full, and the two pearls in it must have the same color.\n\nBaiyun hopes to obtain at least $m$ full bottles of pearls, and it wants to know the probability that its wish can be achieved.", "description": "There are $n$ independent uniformly random integer variables in the range $[1,D]$.\n\nFind the probability that we can choose at least $m$ bottles, such that there exists a way to select some variables and put each selected variable into a bottle, satisfying that each bottle contains exactly two variables with the same value.\n\nOutput the value of the probability multiplied by $D^n$, taken modulo $998244353$. For the modulo details, refer to Problem 1.", "inputFormat": "The input contains only one line with three integers $D,n,m$ separated by spaces.", "outputFormat": "Output one integer, representing the required value of the probability multiplied by $D^n$ modulo $998244353$.", "hint": "#### Sample 1 Explanation\n\nCase $1$: the first variable is $1$, and the second variable is $1$.\n\nCase $2$: the first variable is $1$, and the second variable is $2$.\n\nCase $3$: the first variable is $2$, and the second variable is $1$.\n\nCase $4$: the first variable is $2$, and the second variable is $2$.\n\nIn cases $1$ and $4$, we can put the two variables into one bottle.\n\nIn cases $2$ and $3$, the two variables have different values, so they cannot be put into the same bottle.\n\n#### Testdata Convention\n\n![img](https://s2.ax1x.com/2019/05/17/Eq683D.png)\n\nAll test points satisfy $0 \\leqslant  m \\leqslant  10^9,1 \\leqslant  n \\leqslant  10^9,1 \\leqslant  D \\leqslant  10^5$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 珍珠", "background": "白云苍狗，沧海桑田。\n\n白云的眼前只剩下了模糊的一片。\n\n在若隐若现之中，它看到了一个个小小的珍珠，有一些发着五彩的光芒。这些珍珠是白兔留下来的，每颗珍珠有一个颜色，为 $D$ 种颜色中随机的一种。\n\n白云想把这些珍珠放进一些小瓶子中，每个瓶子能恰好容纳两颗珍珠。不过它也有要求，每个瓶子必须装满，并且装的都是相同颜色的珍珠。\n\n白云希望能得到至少 $m$ 个装满珍珠的瓶子，它想知道它的愿望能被实现的概率是多少呢？", "description": "有 $n$ 个在范围 $[1,D]$ 内的整数均匀随机变量。\n\n求至少能选出 $m$ 个瓶子，使得存在一种方案，选择一些变量，并把选出来的每一个变量放到一个瓶子中，满足每个瓶子都恰好装两个值相同的变量的概率。\n\n请输出概率乘上 $D^n$ 后对 $998244353$ 取模的值。取模部分说明可参考第一题。", "inputFormat": "输入仅一行，三个用空格隔开的整数 $D,n,m$。", "outputFormat": "输出一个整数，表示所求概率乘上 $D^n$ 后对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n情况 $1$ : 第一个变量为 $1$，第二个变量为 $1$\n\n情况 $2$ : 第一个变量为 $1$，第二个变量为 $2$\n\n情况 $3$ : 第一个变量为 $2$，第二个变量为 $1$\n\n情况 $4$ : 第一个变量为 $2$，第二个变量为 $2$\n\n其中情况 $1$ 和 $4$ 可以把两个变量放到一个瓶子中\n\n情况 $2$ 和 $3$ 中两个变量的值不相同，所以不能放到同一个瓶子中\n\n#### 测试数据约定\n![img](https://s2.ax1x.com/2019/05/17/Eq683D.png)\n\n所有测试点均满足 $0 \\leqslant  m \\leqslant  10^9,1 \\leqslant  n \\leqslant  10^9,1 \\leqslant  D \\leqslant  10^5$。", "locale": "zh-CN"}}}
{"pid": "P5402", "type": "P", "difficulty": 7, "samples": [["1 3\n1 1\n1 1\n2 1", "1 0 0 0\n1 0 1 0\n1 1 0 1"], ["2 4\n2 2\n1 1\n1 1\n2 1\n2 1", "1 0 0 0\n1 0 1 0\n1 1 0 1\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "提交答案", "Special Judge", "CTSC/CTS"], "title": "[CTS2019] 无处安放", "background": "寂寥深夜，朦朦胧胧的月光为一切都笼上一层轻纱，你漫步在幽径，时而低头沉\n吟，时而凝望星空，只独孤与彷徨作伴，哪怕只言片语却也无人倾诉，万千思绪伴着你炽热的心，随风而动，无处安放……", "description": "你整理出了 $n$ 条思绪，它们在你的心中是一个个矩形 $r_i$，你想要在心中用一个大矩形 $R$ 安放它们，也就是将 $r_i$ 放置在 $R$ 内部。为了保护这些思绪，它们安放的位置不能与其他思绪有重合部分，并且四条边要平行或垂直于 $R$ 的边。两个思绪有重合部分，指它们安放位置的重合面积大于零。\n\n你有两种安放方式：\n1. 将 $n$ 条思绪全部安放进R 中，希望令 $R$ 的面积尽量小。\n2. 固定 $R$ 的大小，希望将尽量多的思绪安放进 $R$ 中。\n\n现在我已知晓你整理好的思绪，为你选择了安放的方式，我想知道你心中最好的安放方案，请你告诉我。", "inputFormat": "第一行两个整数 $type, n$，分别表示安放方式与思绪的个数。\n\n若 $type = 2$，第二行两个整数 $W, H$，表示 $R$ 的边长。\n\n接下来 $n$ 行每行两个整数 $w_i, h_i$，表示第 $i$ 个思绪即 $r_i$ 的边长。\n\n同一行中输入的整数均以一个空格分隔开。", "outputFormat": "为了方便，若 $R$ 的边长为 $W, H$，我们将安放方案视作一个 $(0, 0)\\sim(W, H)$ 的直角坐标系。注意对于 $type = 2$ 的测试点，你应按输入，将其视作 $(0, 0)\\sim(W, H)$ 的坐标系，而不是 $(0, 0) \\sim (H, W)$ 的坐标系。\n\n输出共有 $n$ 行，每行一或四个整数，描述第 $i$ 个思绪即 $r_i$ 的放置方案。\n\n每行第一个整数 $c_i$，其中 $c_i = 1$ 表示 $r_i$ 被安放在 $R$ 中；$c_i = 0$ 表示 $r_i$ 未被安放在 $R$ 中。\n\n若 $c_i = 1$, 则该行接下来应输出三个整数 $x_i$, $y_i$, $d_{ir_i}$。若 $d_{ir_i} = 0$，则 $r_i$ 放置在 $(x_i, y_i)\\sim(x_i + w_i, y_i + h_i)$ 的矩形范围内；若 $d_{ir_i} = 1$，则 $r_i$ 放置在 $(x_i, y_i)\\sim(x_i + h_i, y_i + w_i)$ 的矩形范围内。\n\n请注意确保你的输出格式正确，且 $c_i, d_{ir_i} \\in \\{0, 1\\}$。对于 $type = 1$ 的测试点，所有 $c_i$ 均应为 $1$。\n\n同一行中输出的整数应以一个空格分隔开。", "hint": "#### 评分方式\n\n每个测试点设置了 $10$ 个评分参数 $a_1, a_2, ..., a_{10}$。若选手输出不合法，则得零分。\n\n否则，对于安放方式 $1$，令 $val$ 为 $R$ 的面积，若 $val \\leq a_i$，则你可获得 $i$ 分；对于安放方式 $2$，令 $val$ 为安放到 $R$ 中的思绪个数，若 $val \\geq a_i$ 则你可获得 $i$ 分。满足多个得分条件，测试点得分取最高者。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] No Place to Put", "background": "In the lonely late night, the hazy moonlight puts a thin veil over everything. You walk along a quiet path, sometimes lowering your head in thought, sometimes gazing at the starry sky. You are accompanied only by loneliness and hesitation. Even if you have a few words, there is no one to talk to. Countless thoughts move with your burning heart, drifting with the wind, with nowhere to be placed.", "description": "You have整理 organized $n$ thoughts. In your heart, each of them is a rectangle $r_i$. You want to use a big rectangle $R$ in your heart to place them, that is, place each $r_i$ inside $R$. To protect these thoughts, their placed positions must not overlap with each other, and their four sides must be parallel or perpendicular to the sides of $R$. Two thoughts are considered overlapping if the intersection area of their placed positions is greater than zero.\n\nYou have two placing methods:\n1. Place all $n$ thoughts into $R$, and hope to make the area of $R$ as small as possible.\n2. Fix the size of $R$, and hope to place as many thoughts as possible into $R$.\n\nNow I already know the thoughts you have organized, and I have chosen the placing method for you. I want to know the best placing plan in your heart. Please tell me.", "inputFormat": "The first line contains two integers $type, n$, representing the placing method and the number of thoughts, respectively.\n\nIf $type = 2$, the second line contains two integers $W, H$, representing the side lengths of $R$.\n\nThe next $n$ lines each contain two integers $w_i, h_i$, representing the side lengths of the $i$-th thought, i.e., $r_i$.\n\nIntegers on the same line are separated by a single space.", "outputFormat": "For convenience, if the side lengths of $R$ are $W, H$, we view the placing plan as a Cartesian coordinate system $(0, 0)\\sim(W, H)$. Note that for test points with $type = 2$, you should follow the input and treat it as the coordinate system $(0, 0)\\sim(W, H)$, rather than $(0, 0)\\sim(H, W)$.\n\nOutput a total of $n$ lines. Each line contains one or four integers, describing the placement plan of the $i$-th thought, i.e., $r_i$.\n\nThe first integer on each line is $c_i$. Here $c_i = 1$ means that $r_i$ is placed in $R$; $c_i = 0$ means that $r_i$ is not placed in $R$.\n\nIf $c_i = 1$, then output three more integers $x_i$, $y_i$, $d_{ir_i}$. If $d_{ir_i} = 0$, then $r_i$ is placed within the rectangle $(x_i, y_i)\\sim(x_i + w_i, y_i + h_i)$; if $d_{ir_i} = 1$, then $r_i$ is placed within the rectangle $(x_i, y_i)\\sim(x_i + h_i, y_i + w_i)$.\n\nPlease make sure your output format is correct, and that $c_i, d_{ir_i} \\in \\{0, 1\\}$. For test points with $type = 1$, all $c_i$ must be $1$.\n\nIntegers on the same line should be separated by a single space.", "hint": "#### Scoring\n\nEach test point provides $10$ scoring parameters $a_1, a_2, ..., a_{10}$. If a contestant’s output is invalid, the score is zero.\n\nOtherwise, for placing method $1$, let $val$ be the area of $R$. If $val \\leq a_i$, then you can get $i$ points. For placing method $2$, let $val$ be the number of thoughts placed into $R$. If $val \\geq a_i$, then you can get $i$ points. If multiple scoring conditions are satisfied, the score for the test point is the highest one.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 无处安放", "background": "寂寥深夜，朦朦胧胧的月光为一切都笼上一层轻纱，你漫步在幽径，时而低头沉\n吟，时而凝望星空，只独孤与彷徨作伴，哪怕只言片语却也无人倾诉，万千思绪伴着你炽热的心，随风而动，无处安放……", "description": "你整理出了 $n$ 条思绪，它们在你的心中是一个个矩形 $r_i$，你想要在心中用一个大矩形 $R$ 安放它们，也就是将 $r_i$ 放置在 $R$ 内部。为了保护这些思绪，它们安放的位置不能与其他思绪有重合部分，并且四条边要平行或垂直于 $R$ 的边。两个思绪有重合部分，指它们安放位置的重合面积大于零。\n\n你有两种安放方式：\n1. 将 $n$ 条思绪全部安放进R 中，希望令 $R$ 的面积尽量小。\n2. 固定 $R$ 的大小，希望将尽量多的思绪安放进 $R$ 中。\n\n现在我已知晓你整理好的思绪，为你选择了安放的方式，我想知道你心中最好的安放方案，请你告诉我。", "inputFormat": "第一行两个整数 $type, n$，分别表示安放方式与思绪的个数。\n\n若 $type = 2$，第二行两个整数 $W, H$，表示 $R$ 的边长。\n\n接下来 $n$ 行每行两个整数 $w_i, h_i$，表示第 $i$ 个思绪即 $r_i$ 的边长。\n\n同一行中输入的整数均以一个空格分隔开。", "outputFormat": "为了方便，若 $R$ 的边长为 $W, H$，我们将安放方案视作一个 $(0, 0)\\sim(W, H)$ 的直角坐标系。注意对于 $type = 2$ 的测试点，你应按输入，将其视作 $(0, 0)\\sim(W, H)$ 的坐标系，而不是 $(0, 0) \\sim (H, W)$ 的坐标系。\n\n输出共有 $n$ 行，每行一或四个整数，描述第 $i$ 个思绪即 $r_i$ 的放置方案。\n\n每行第一个整数 $c_i$，其中 $c_i = 1$ 表示 $r_i$ 被安放在 $R$ 中；$c_i = 0$ 表示 $r_i$ 未被安放在 $R$ 中。\n\n若 $c_i = 1$, 则该行接下来应输出三个整数 $x_i$, $y_i$, $d_{ir_i}$。若 $d_{ir_i} = 0$，则 $r_i$ 放置在 $(x_i, y_i)\\sim(x_i + w_i, y_i + h_i)$ 的矩形范围内；若 $d_{ir_i} = 1$，则 $r_i$ 放置在 $(x_i, y_i)\\sim(x_i + h_i, y_i + w_i)$ 的矩形范围内。\n\n请注意确保你的输出格式正确，且 $c_i, d_{ir_i} \\in \\{0, 1\\}$。对于 $type = 1$ 的测试点，所有 $c_i$ 均应为 $1$。\n\n同一行中输出的整数应以一个空格分隔开。", "hint": "#### 评分方式\n\n每个测试点设置了 $10$ 个评分参数 $a_1, a_2, ..., a_{10}$。若选手输出不合法，则得零分。\n\n否则，对于安放方式 $1$，令 $val$ 为 $R$ 的面积，若 $val \\leq a_i$，则你可获得 $i$ 分；对于安放方式 $2$，令 $val$ 为安放到 $R$ 中的思绪个数，若 $val \\geq a_i$ 则你可获得 $i$ 分。满足多个得分条件，测试点得分取最高者。", "locale": "zh-CN"}}}
{"pid": "P5403", "type": "P", "difficulty": 7, "samples": [["1\n0 0 0 1", "2.00000000\n"], ["4\n-1 7 0 7\n0 0 0 1\n2 -3 5 5\n2 2 6 -1", "23.563573998194637061425470524757"], ["4\n-1 1 -1 3\n0 4 2 4\n3 1 3 3\n0 0 2 0", "13.656854249492380195206754896839"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "Special Judge", "CTSC/CTS"], "title": "[CTS2019] 田野", "background": "", "description": "> Last night I saw you running  \nIn the open fields of grace  \nNo longer were you broken or in pain\n>\n> 题面中的歌词来自 Jackie Evancho 的 Open Fields of Grace，作曲者为 Lisa Venkatrathnam 和 Paul Sumares。\n\n你找到了一片一望无际的大田野，在这片田野中你忘记了曾经破碎、痛苦的过去。你像小孩一样在上帝的恩赐中奔跑。\n\n然而你发现了一个问题，在这片田野中有若干条峡谷。你随时都有坠入峡谷中的危险。为了继续自由自在的奔跑，你决定用若干围栏将这些峡谷围起来。\n\n我们可以忽视峡谷的宽度，将每一条峡谷看做一条线段。**这些线段可以相交**，而你的围栏必须是**一条或多条闭合不自交且两两不相交的曲线**，使得**任何一个峡谷都完全在某一条**闭合曲线围成的闭合区域之内。\n当然，围栏需要消耗资源，消耗的资源和围栏的长度成正比，你希望最小化消耗的资源总量，所以你希望求出围栏总长度的**下确界**，换句话说，你希望找到一个最大的实数 $x$，使得不存在一个方案使得围栏总长度小于 $x$。", "inputFormat": "输入文件的第一行为一个整数 $n$，表示峡谷的个数。\n\n接下来 $n$ 行，第 $i$ 行四个整数 $a_i,b_i,c_i,d_i$，表示第 $i$ 条峡谷为一条连接点 $(a_i,b_i)$ 和点 $(c_i,d_i)$ 的线段。**保证两个端点不重合，不同的线段不会涉及到相同的点。保证任意三点不共线。**", "outputFormat": "输出一行一个实数，表示围栏总长度的下确界。**你的答案和标准答案的绝对误差和相对误差的最小值不能超过** $10^{-6}$。", "hint": "#### 样例 1 解释\n一个四个端点分别为 $(−0.01,−0.01),(−0.01,1.01),(0.01,1.01),(0.01,−0.01)$ 的长方形完全包含输入的线段，且总长度为 $2.08$，略大于下确界。\n\n我们可以证明，不存在长度恰好为 $2$ 的方案。我们可以通过将正方形无限向输入线段“缩紧”来构造一个长度为任意大于 $2$ 的方案。\n\n#### 样例 2 解释\n下图为输入的线段，注意线段可以相交：\n![img1](https://s2.ax1x.com/2019/05/17/ELd6pj.png)\n\n我们以通过无限“逼近”这些红色的曲线来构造任意总长度大于答案的方案。注意通过样例 1，我们很容易知道左上角的红色线段被算了两遍。\n\n#### 样例 3 解释\n答案为 $8+4\\sqrt 2$。\n\n解释如图：\n\n![img2](https://s2.ax1x.com/2019/05/17/ELdINF.png)\n\n我们可以通过无限“逼近”这些红色的曲线来构造任意总长度大于 $8+4\\sqrt 2$ 的方案。\n\n#### 测试数据约定\n对于 $5\\%$ 的数据，保证 $1\\le n\\le 1$。\n\n对于 $10\\%$ 的数据，保证 $1\\le n\\le 2$。\n\n对于 $15\\%$ 的数据，保证 $1\\le n\\le 10$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n\\le 15$。\n\n对于 $45\\%$ 的数据，保证 $1\\le n\\le 30$。\n\n对于 $55\\%$ 的数据，保证 $1\\le n\\le 60$。\n\n对于 $65\\%$ 的数据，保证 $1\\le n\\le 120$。\n\n对于 $75\\%$ 的数据，保证 $1\\le n\\le 200$。\n\n对于另外 $10\\%$ 的数据，保证答案最多包含两条曲线。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 250$，$0\\le |a_i|,|b_i|,|c_i|,|d_i|\\le 10^9$。**保证两个端点不重合，不同的线段不会涉及到相同的点。保证任意三点不共线。**", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Fields", "background": "", "description": "> Last night I saw you running  \n> In the open fields of grace  \n> No longer were you broken or in pain\n>\n> The lyrics in the statement are from Jackie Evancho's *Open Fields of Grace*, composed by Lisa Venkatrathnam and Paul Sumares.\n\nYou found an endless open field. In this field, you forget the broken and painful past. You run like a child in God's grace.\n\nHowever, you notice a problem: there are several canyons in this field. At any time, you might fall into a canyon. To keep running freely, you decide to build some fences to enclose these canyons.\n\nWe can ignore the width of a canyon and treat each canyon as a line segment. **These segments may intersect**, and your fences must be **one or more closed curves that are non-self-intersecting and pairwise disjoint**, such that **every canyon lies completely inside the closed region enclosed by some** closed curve.\n\nOf course, fences consume resources, and the resource cost is proportional to the total fence length. You want to minimize the total resource cost, so you need the **infimum** of the total fence length. In other words, you want to find the largest real number $x$ such that there is no plan whose total fence length is less than $x$.", "inputFormat": "The first line contains an integer $n$, the number of canyons.\n\nThe next $n$ lines each contain four integers $a_i,b_i,c_i,d_i$, meaning that the $i$-th canyon is a segment connecting $(a_i,b_i)$ and $(c_i,d_i)$. **It is guaranteed that the two endpoints are different, different segments will not use the same point, and no three points are collinear.**", "outputFormat": "Output one real number, the infimum of the total fence length. **The minimum of the absolute error and the relative error between your answer and the standard answer must not exceed** $10^{-6}$.", "hint": "#### Explanation for Sample 1\nA rectangle with four vertices $(−0.01,−0.01),(−0.01,1.01),(0.01,1.01),(0.01,−0.01)$ completely contains the input segment, and its total perimeter is $2.08$, which is slightly larger than the infimum.\n\nWe can prove that there is no solution with length exactly $2$. We can construct a solution of any length greater than $2$ by shrinking the square toward the input segment infinitely.\n\n#### Explanation for Sample 2\nThe figure below shows the input segments. Note that segments may intersect:\n![img1](https://s2.ax1x.com/2019/05/17/ELd6pj.png)\n\nWe can construct solutions with any total length greater than the answer by infinitely approaching these red curves. Note that from Sample 1, it is easy to see that the red segment in the upper-left corner is counted twice.\n\n#### Explanation for Sample 3\nThe answer is $8+4\\sqrt 2$.\n\nThe explanation is shown in the figure:\n![img2](https://s2.ax1x.com/2019/05/17/ELdINF.png)\n\nWe can construct solutions with any total length greater than $8+4\\sqrt 2$ by infinitely approaching these red curves.\n\n#### Testdata Constraints\nFor $5\\%$ of the testdata, it is guaranteed that $1\\le n\\le 1$.\n\nFor $10\\%$ of the testdata, it is guaranteed that $1\\le n\\le 2$.\n\nFor $15\\%$ of the testdata, it is guaranteed that $1\\le n\\le 10$.\n\nFor $30\\%$ of the testdata, it is guaranteed that $1\\le n\\le 15$.\n\nFor $45\\%$ of the testdata, it is guaranteed that $1\\le n\\le 30$.\n\nFor $55\\%$ of the testdata, it is guaranteed that $1\\le n\\le 60$.\n\nFor $65\\%$ of the testdata, it is guaranteed that $1\\le n\\le 120$.\n\nFor $75\\%$ of the testdata, it is guaranteed that $1\\le n\\le 200$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that the answer contains at most two curves.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le n\\le 250$, $0\\le |a_i|,|b_i|,|c_i|,|d_i|\\le 10^9$. **It is guaranteed that the two endpoints are different, different segments will not use the same point, and no three points are collinear.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 田野", "background": "", "description": "> Last night I saw you running  \nIn the open fields of grace  \nNo longer were you broken or in pain\n>\n> 题面中的歌词来自 Jackie Evancho 的 Open Fields of Grace，作曲者为 Lisa Venkatrathnam 和 Paul Sumares。\n\n你找到了一片一望无际的大田野，在这片田野中你忘记了曾经破碎、痛苦的过去。你像小孩一样在上帝的恩赐中奔跑。\n\n然而你发现了一个问题，在这片田野中有若干条峡谷。你随时都有坠入峡谷中的危险。为了继续自由自在的奔跑，你决定用若干围栏将这些峡谷围起来。\n\n我们可以忽视峡谷的宽度，将每一条峡谷看做一条线段。**这些线段可以相交**，而你的围栏必须是**一条或多条闭合不自交且两两不相交的曲线**，使得**任何一个峡谷都完全在某一条**闭合曲线围成的闭合区域之内。\n当然，围栏需要消耗资源，消耗的资源和围栏的长度成正比，你希望最小化消耗的资源总量，所以你希望求出围栏总长度的**下确界**，换句话说，你希望找到一个最大的实数 $x$，使得不存在一个方案使得围栏总长度小于 $x$。", "inputFormat": "输入文件的第一行为一个整数 $n$，表示峡谷的个数。\n\n接下来 $n$ 行，第 $i$ 行四个整数 $a_i,b_i,c_i,d_i$，表示第 $i$ 条峡谷为一条连接点 $(a_i,b_i)$ 和点 $(c_i,d_i)$ 的线段。**保证两个端点不重合，不同的线段不会涉及到相同的点。保证任意三点不共线。**", "outputFormat": "输出一行一个实数，表示围栏总长度的下确界。**你的答案和标准答案的绝对误差和相对误差的最小值不能超过** $10^{-6}$。", "hint": "#### 样例 1 解释\n一个四个端点分别为 $(−0.01,−0.01),(−0.01,1.01),(0.01,1.01),(0.01,−0.01)$ 的长方形完全包含输入的线段，且总长度为 $2.08$，略大于下确界。\n\n我们可以证明，不存在长度恰好为 $2$ 的方案。我们可以通过将正方形无限向输入线段“缩紧”来构造一个长度为任意大于 $2$ 的方案。\n\n#### 样例 2 解释\n下图为输入的线段，注意线段可以相交：\n![img1](https://s2.ax1x.com/2019/05/17/ELd6pj.png)\n\n我们以通过无限“逼近”这些红色的曲线来构造任意总长度大于答案的方案。注意通过样例 1，我们很容易知道左上角的红色线段被算了两遍。\n\n#### 样例 3 解释\n答案为 $8+4\\sqrt 2$。\n\n解释如图：\n\n![img2](https://s2.ax1x.com/2019/05/17/ELdINF.png)\n\n我们可以通过无限“逼近”这些红色的曲线来构造任意总长度大于 $8+4\\sqrt 2$ 的方案。\n\n#### 测试数据约定\n对于 $5\\%$ 的数据，保证 $1\\le n\\le 1$。\n\n对于 $10\\%$ 的数据，保证 $1\\le n\\le 2$。\n\n对于 $15\\%$ 的数据，保证 $1\\le n\\le 10$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n\\le 15$。\n\n对于 $45\\%$ 的数据，保证 $1\\le n\\le 30$。\n\n对于 $55\\%$ 的数据，保证 $1\\le n\\le 60$。\n\n对于 $65\\%$ 的数据，保证 $1\\le n\\le 120$。\n\n对于 $75\\%$ 的数据，保证 $1\\le n\\le 200$。\n\n对于另外 $10\\%$ 的数据，保证答案最多包含两条曲线。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 250$，$0\\le |a_i|,|b_i|,|c_i|,|d_i|\\le 10^9$。**保证两个端点不重合，不同的线段不会涉及到相同的点。保证任意三点不共线。**", "locale": "zh-CN"}}}
{"pid": "P5404", "type": "P", "difficulty": 7, "samples": [["3\nabc", "79"], ["5\nzxcvb", "11881375"], ["20\nuuopacpertklmqwbfixc ", "765676850"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "CTSC/CTS"], "title": "[CTS2019] 重复", "background": "贾樟柯在《山河故人》里说，“生活就是重复”。在生活中，人们总是喜欢重复自己做过的事情。语言就是一个很经典的例子。\n\n比如，我们在表示疑问时，总不满足于使用一个问号“？”；使用一连串的问号“？？？？”总是显得比较有力。\n\n在表示抱歉时，一句“对不起”总显得不够情愿；连着表示“对不起对不起”才足够表达自己的真诚。", "description": "A 国就是一个喜欢重复的国家。在这个国家中，一个基本句子可以用一个长度恰好为 $m$ 的小写字母字符串表示。为了表达自己对重复的喜爱，A 国的人们总喜欢把自己想要表达的句子重复无限多次。\n\n有时，这样的重复是充满意义的。A 国的人们把一个字典序小于给定的字符串 $s$，且长度和 $s$ 相同的小写字母字符串称为一个有意义的语义片段。他们想知道，有多少个不同的基本句子（即长度恰好为 $m$ 的小写字母字符串）在经过无限重复后，可以从中找出至少一个有意义的语义片段？", "inputFormat": "输入文件的第一行为一个正整数 $m$，表示基本句子的长度；第二行为一个小写字母字符串 $s$，其含义详见题目描述。", "outputFormat": "输出一行一个整数，为满足条件的基本句子的数量。为了避免答案过大，你只需要输出将答案对 $998244353$ 取模后的结果。", "hint": "设字符串 $s$ 的长度为 $n$，则 $n$、$m$ 的范围遵循如下表格：\n\n![img](https://s2.ax1x.com/2019/05/17/EL0fFU.png)\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m\\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Repetition", "background": "Jia Zhangke said in *Mountains May Depart*, “Life is repetition.” In life, people always like to repeat what they have done. Language is a very classic example.\n\nFor example, when expressing a question, people are often not satisfied with using just one question mark “?”; using a series of question marks “????” always feels more forceful.\n\nWhen expressing an apology, saying “sorry” once often seems unwilling; repeating it as “sorry sorry” is enough to show sincerity.", "description": "Country A is a country that likes repetition. In this country, a basic sentence can be represented by a lowercase letter string of length exactly $m$. To show their love for repetition, people in Country A always repeat the sentence they want to express infinitely many times.\n\nSometimes, such repetition is meaningful. People in Country A call a lowercase letter string that is lexicographically smaller than the given string $s$ and has the same length as $s$ a meaningful semantic fragment. They want to know: how many different basic sentences (i.e., lowercase letter strings of length exactly $m$) can, after being repeated infinitely, contain at least one meaningful semantic fragment?", "inputFormat": "The first line of the input file is a positive integer $m$, which denotes the length of the basic sentence. The second line is a lowercase letter string $s$, whose meaning is described above.", "outputFormat": "Output one line with one integer, the number of basic sentences that satisfy the condition. To avoid the answer being too large, you only need to output the result modulo $998244353$.", "hint": "Let the length of string $s$ be $n$. Then the constraints of $n$ and $m$ follow the table below:\n\n![img](https://s2.ax1x.com/2019/05/17/EL0fFU.png)\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le n,m\\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 重复", "background": "贾樟柯在《山河故人》里说，“生活就是重复”。在生活中，人们总是喜欢重复自己做过的事情。语言就是一个很经典的例子。\n\n比如，我们在表示疑问时，总不满足于使用一个问号“？”；使用一连串的问号“？？？？”总是显得比较有力。\n\n在表示抱歉时，一句“对不起”总显得不够情愿；连着表示“对不起对不起”才足够表达自己的真诚。", "description": "A 国就是一个喜欢重复的国家。在这个国家中，一个基本句子可以用一个长度恰好为 $m$ 的小写字母字符串表示。为了表达自己对重复的喜爱，A 国的人们总喜欢把自己想要表达的句子重复无限多次。\n\n有时，这样的重复是充满意义的。A 国的人们把一个字典序小于给定的字符串 $s$，且长度和 $s$ 相同的小写字母字符串称为一个有意义的语义片段。他们想知道，有多少个不同的基本句子（即长度恰好为 $m$ 的小写字母字符串）在经过无限重复后，可以从中找出至少一个有意义的语义片段？", "inputFormat": "输入文件的第一行为一个正整数 $m$，表示基本句子的长度；第二行为一个小写字母字符串 $s$，其含义详见题目描述。", "outputFormat": "输出一行一个整数，为满足条件的基本句子的数量。为了避免答案过大，你只需要输出将答案对 $998244353$ 取模后的结果。", "hint": "设字符串 $s$ 的长度为 $n$，则 $n$、$m$ 的范围遵循如下表格：\n\n![img](https://s2.ax1x.com/2019/05/17/EL0fFU.png)\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m\\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P5405", "type": "P", "difficulty": 6, "samples": [["2\n0 0 1\n1 1 0\n1 2", "524078286"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "树形 DP", "容斥原理", "期望", "CTSC/CTS"], "title": "[CTS2019] 氪金手游", "background": "", "description": "小刘同学是一个喜欢氪金手游的男孩子。\n\n他最近迷上了一个新游戏，游戏的内容就是不断地抽卡。现在已知：\n- 卡池里总共有 $N$ 种卡，第 $i$ 种卡有一个权值 $W_i$，小刘同学不知道 $W_i$ 具体的值是什么。但是他通过和网友交流，他了解到 $W_i$ 服从一个分布。\n- 具体地，对每个 $i$，小刘了解到三个参数 $p_{i,1},p_{i,2},p_{i,3}$，$W_i$ 将会以 $p_{i,j}$ 的概率取值为 $j$，保证 $p_{i,1}+p_{i,2}+p_{i,3}=1$。\n\n小刘开始玩游戏了，他每次会氪一元钱来抽一张卡，其中抽到卡 $i$ 的概率为：\n$$\\frac{W_i}{\\sum_j W_j}$$\n小刘会不停地抽卡，**直到**他手里集齐了全部 $N$ 种卡。\n\n抽卡结束之后，服务器记录下来了小刘**第一次**得到每张卡的时间 $T_i$。游戏公司在这里设置了一个彩蛋：公司准备了 $N-1$ 个二元组 $(u_i,v_i)$，如果对任意的 $i$，成立 $T_{u_i}<T_{v_i}$，那么游戏公司就会认为小刘是极其幸运的，从而送给他一个橱柜的手办作为幸运大奖。\n\n游戏公司为了降低获奖概率，它准备的这些 $(u_i,v_i)$ 满足这样一个性质：对于任意的 $\\varnothing\\ne S\\subsetneq\\{1,2,\\ldots,N\\}$，总能找到 $(u_i,v_i)$ 满足：$u_i\\in S,v_i\\notin S$ **或者** $u_i\\notin S,v_i\\in S$。\n\n请你求出小刘同学能够得到幸运大奖的概率，可以保证结果是一个有理数，请输出它对 $998244353$ 取模的结果。", "inputFormat": "第一行一个整数 $N$，表示卡的种类数。\n\n接下来 $N$ 行，每行三个整数 $a_{i,1},a_{i,2},a_{i,3}$，而题目给出的 $p_{i,j}=\\frac{a_{i,j}}{a_{i,1}+a_{i,2}+a_{i,3}}$。\n\n接下来 $N-1$ 行，每行两个整数 $u_i,v_i$，描述一个二元组（意义见题目描述）。", "outputFormat": "输出一行一个整数，表示所求概率对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n$W_2$ 以 $\\frac 12$ 的概率取 $1$ 或者 $2$：\n- 如果 $W_2=1$，那么 $T_1<T_2$ 的概率为 $\\frac 34$。\n- 否则 $W_2=2$，$T_1<T_2$ 的概率为 $\\frac 35$。\n\n综合所有情况答案为 $\\frac 12\\left(\\frac 34+\\frac 35\\right)=\\frac{27}{40}$，你可以验证它对 $998244353$ 取模的结果确实是所给答案。\n\n#### 测试数据约定\n对于全部的测试数据，保证 $N\\le 1000$，$a_{i,j}\\le 10^6$。\n\n- $20$ 分的数据，$N\\le 15$。\n- $15$ 分的数据，$N\\le 200$，且每个限制保证 $|u_i−v_i|=1$。\n- $20$ 分的数据，$N\\le 1000$，且每个限制保证 $|u_i−v_i|=1$。\n- $15$ 分的数据，$N\\le 200$。\n- $30$ 分的数据，无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Pay-to-Win Mobile Gacha Game", "background": "", "description": "Student Xiao Liu is a boy who likes pay-to-win mobile games.\n\nHe recently got addicted to a new game whose content is to keep drawing cards. It is known that:\n\n- There are $N$ types of cards in the pool. The $i$-th type of card has a weight $W_i$. Xiao Liu does not know the exact value of $W_i$, but by talking with other players he learned that $W_i$ follows a distribution.\n- Specifically, for each $i$, Xiao Liu knows three parameters $p_{i,1}, p_{i,2}, p_{i,3}$. The value of $W_i$ is $j$ with probability $p_{i,j}$. It is guaranteed that $p_{i,1} + p_{i,2} + p_{i,3} = 1$.\n\nXiao Liu starts playing the game. Each time, he pays 1 yuan to draw one card. The probability of drawing card $i$ is:\n$$\\frac{W_i}{\\sum_j W_j}$$\nXiao Liu will keep drawing cards **until** he has collected all $N$ types of cards.\n\nAfter the drawing ends, the server records the time $T_i$ when Xiao Liu gets each card for the **first time**. The game company sets up an easter egg: the company prepares $N - 1$ ordered pairs $(u_i, v_i)$. If for every $i$, the condition $T_{u_i} < T_{v_i}$ holds, then the company will consider Xiao Liu extremely lucky and will give him a cabinet of figurines as the lucky grand prize.\n\nTo reduce the chance of winning, these $(u_i, v_i)$ satisfy the following property: for any $\\varnothing \\ne S \\subsetneq \\{1,2,\\ldots,N\\}$, there always exists some $(u_i, v_i)$ such that $u_i \\in S, v_i \\notin S$ **or** $u_i \\notin S, v_i \\in S$.\n\nPlease compute the probability that Xiao Liu can get the lucky grand prize. It is guaranteed that the result is a rational number. Output the result modulo $998244353$.", "inputFormat": "The first line contains an integer $N$, the number of card types.\n\nThe next $N$ lines each contain three integers $a_{i,1}, a_{i,2}, a_{i,3}$, and the probabilities in the statement are given by $p_{i,j} = \\frac{a_{i,j}}{a_{i,1} + a_{i,2} + a_{i,3}}$.\n\nThe next $N - 1$ lines each contain two integers $u_i, v_i$, describing an ordered pair (see the statement for its meaning).", "outputFormat": "Output one integer in one line, the required probability modulo $998244353$.", "hint": "#### Explanation of Sample 1\n$W_2$ is $1$ or $2$ with probability $\\frac 12$:\n- If $W_2 = 1$, then the probability that $T_1 < T_2$ is $\\frac 34$.\n- Otherwise, if $W_2 = 2$, then the probability that $T_1 < T_2$ is $\\frac 35$.\n\nCombining all cases, the answer is $\\frac 12\\left(\\frac 34 + \\frac 35\\right) = \\frac{27}{40}$. You can verify that its value modulo $998244353$ is indeed the given output.\n\n#### Testdata Constraints\nFor all testdata, it is guaranteed that $N \\le 1000$ and $a_{i,j} \\le 10^6$.\n\n- $20$ points: $N \\le 15$.\n- $15$ points: $N \\le 200$, and every constraint satisfies $|u_i−v_i|=1$.\n- $20$ points: $N \\le 1000$, and every constraint satisfies $|u_i−v_i|=1$.\n- $15$ points: $N \\le 200$.\n- $30$ points: no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 氪金手游", "background": "", "description": "小刘同学是一个喜欢氪金手游的男孩子。\n\n他最近迷上了一个新游戏，游戏的内容就是不断地抽卡。现在已知：\n- 卡池里总共有 $N$ 种卡，第 $i$ 种卡有一个权值 $W_i$，小刘同学不知道 $W_i$ 具体的值是什么。但是他通过和网友交流，他了解到 $W_i$ 服从一个分布。\n- 具体地，对每个 $i$，小刘了解到三个参数 $p_{i,1},p_{i,2},p_{i,3}$，$W_i$ 将会以 $p_{i,j}$ 的概率取值为 $j$，保证 $p_{i,1}+p_{i,2}+p_{i,3}=1$。\n\n小刘开始玩游戏了，他每次会氪一元钱来抽一张卡，其中抽到卡 $i$ 的概率为：\n$$\\frac{W_i}{\\sum_j W_j}$$\n小刘会不停地抽卡，**直到**他手里集齐了全部 $N$ 种卡。\n\n抽卡结束之后，服务器记录下来了小刘**第一次**得到每张卡的时间 $T_i$。游戏公司在这里设置了一个彩蛋：公司准备了 $N-1$ 个二元组 $(u_i,v_i)$，如果对任意的 $i$，成立 $T_{u_i}<T_{v_i}$，那么游戏公司就会认为小刘是极其幸运的，从而送给他一个橱柜的手办作为幸运大奖。\n\n游戏公司为了降低获奖概率，它准备的这些 $(u_i,v_i)$ 满足这样一个性质：对于任意的 $\\varnothing\\ne S\\subsetneq\\{1,2,\\ldots,N\\}$，总能找到 $(u_i,v_i)$ 满足：$u_i\\in S,v_i\\notin S$ **或者** $u_i\\notin S,v_i\\in S$。\n\n请你求出小刘同学能够得到幸运大奖的概率，可以保证结果是一个有理数，请输出它对 $998244353$ 取模的结果。", "inputFormat": "第一行一个整数 $N$，表示卡的种类数。\n\n接下来 $N$ 行，每行三个整数 $a_{i,1},a_{i,2},a_{i,3}$，而题目给出的 $p_{i,j}=\\frac{a_{i,j}}{a_{i,1}+a_{i,2}+a_{i,3}}$。\n\n接下来 $N-1$ 行，每行两个整数 $u_i,v_i$，描述一个二元组（意义见题目描述）。", "outputFormat": "输出一行一个整数，表示所求概率对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n$W_2$ 以 $\\frac 12$ 的概率取 $1$ 或者 $2$：\n- 如果 $W_2=1$，那么 $T_1<T_2$ 的概率为 $\\frac 34$。\n- 否则 $W_2=2$，$T_1<T_2$ 的概率为 $\\frac 35$。\n\n综合所有情况答案为 $\\frac 12\\left(\\frac 34+\\frac 35\\right)=\\frac{27}{40}$，你可以验证它对 $998244353$ 取模的结果确实是所给答案。\n\n#### 测试数据约定\n对于全部的测试数据，保证 $N\\le 1000$，$a_{i,j}\\le 10^6$。\n\n- $20$ 分的数据，$N\\le 15$。\n- $15$ 分的数据，$N\\le 200$，且每个限制保证 $|u_i−v_i|=1$。\n- $20$ 分的数据，$N\\le 1000$，且每个限制保证 $|u_i−v_i|=1$。\n- $15$ 分的数据，$N\\le 200$。\n- $30$ 分的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5406", "type": "P", "difficulty": 7, "samples": [["3 3\n^\n1 2 1\n2 3 1\n1 3 0", "1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "快速沃尔什变换 FWT", "THUPC"], "title": "[THUPC 2019] 找树", "background": "", "description": "定义 $\\otimes_1, \\otimes_2, \\otimes_3$ 分别为按位与、按位或、按位异或运算。记 $a_i$ 表示 $a$ 的从低位到高位的第 $i$ 个二进制位。定义一个作用在 $w$ 位二进制数上的新运算 $\\oplus$，满足对于结果 $a\\oplus b$ 的每一位 $(a\\oplus b)_i$ 有 $(a\\oplus b)_i = a_i \\otimes_{o_i} b_i$。不难验证 $\\oplus$ 运算满足结合律和交换律。\n\n给出一张 $n$ 个点 $m$ 条边的无向图，每一条边的权值是一个 $w$ 位二进制数（即小于 $2^w$ 的非负整数）。请你找一棵原图的生成树。设你找出的生成树中的边边权分别为 $v_1,\\cdots,v_{n-1}$，请你最大化 $v_1\\oplus v_2\\oplus\\cdots\\oplus v_{n-1}$。", "inputFormat": "第一行两个正整数 $n,m$；\n\n第二行一个长度为 $w$ 的串，串中的每个字符为 `&`、`|`、`^`  中的一个（分别代表与、或和异或），表示每一个 $\\otimes_{o_i}$。\n\n接下来 $m$ 行，每一行三个非负整数 $x,y,v$，表示一条连接 $x$ 和 $y$ 权值为 $v$ 的边，保证 $1\\leq x,y\\leq n$，$0\\le v < 2^w$。\n\n对于所有数据，$1\\le n\\le 70,1\\le m\\le 5000,1\\le w \\le 12$。", "outputFormat": "输出一行一个数，表示答案。如果图不连通，输出 `-1`。", "hint": "### 关于数据\n\n由于一些原因，数据只保留了最后 $20$ 个点。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Find a Tree", "background": "", "description": "Define $\\otimes_1, \\otimes_2, \\otimes_3$ as bitwise AND, bitwise OR, and bitwise XOR, respectively. Let $a_i$ denote the $i$-th binary bit of $a$ from low to high. Define a new operation $\\oplus$ on $w$-bit binary numbers such that for each bit $(a\\oplus b)_i$ of the result $a\\oplus b$, we have $(a\\oplus b)_i = a_i \\otimes_{o_i} b_i$. It is not hard to verify that the operation $\\oplus$ is associative and commutative.\n\nGiven an undirected graph with $n$ vertices and $m$ edges, each edge weight is a $w$-bit binary number (i.e., a non-negative integer less than $2^w$). Please find a spanning tree of the original graph. Suppose the edge weights in your spanning tree are $v_1,\\cdots,v_{n-1}$. Please maximize $v_1\\oplus v_2\\oplus\\cdots\\oplus v_{n-1}$.", "inputFormat": "The first line contains two positive integers $n,m$.\n\nThe second line contains a string of length $w$. Each character in the string is one of `&`, `|`, `^` (representing AND, OR, XOR, respectively), indicating each $\\otimes_{o_i}$.\n\nThe next $m$ lines each contain three non-negative integers $x,y,v$, representing an edge connecting $x$ and $y$ with weight $v$. It is guaranteed that $1\\leq x,y\\leq n$, $0\\le v < 2^w$.\n\nFor all testdata, $1\\le n\\le 70,1\\le m\\le 5000,1\\le w \\le 12$.", "outputFormat": "Output one line with one number, indicating the answer. If the graph is disconnected, output `-1`.", "hint": "### About the testdata\n\nFor some reasons, the testdata only keeps the last $20$ vertices.\n\n### Copyright information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as solutions can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 找树", "background": "", "description": "定义 $\\otimes_1, \\otimes_2, \\otimes_3$ 分别为按位与、按位或、按位异或运算。记 $a_i$ 表示 $a$ 的从低位到高位的第 $i$ 个二进制位。定义一个作用在 $w$ 位二进制数上的新运算 $\\oplus$，满足对于结果 $a\\oplus b$ 的每一位 $(a\\oplus b)_i$ 有 $(a\\oplus b)_i = a_i \\otimes_{o_i} b_i$。不难验证 $\\oplus$ 运算满足结合律和交换律。\n\n给出一张 $n$ 个点 $m$ 条边的无向图，每一条边的权值是一个 $w$ 位二进制数（即小于 $2^w$ 的非负整数）。请你找一棵原图的生成树。设你找出的生成树中的边边权分别为 $v_1,\\cdots,v_{n-1}$，请你最大化 $v_1\\oplus v_2\\oplus\\cdots\\oplus v_{n-1}$。", "inputFormat": "第一行两个正整数 $n,m$；\n\n第二行一个长度为 $w$ 的串，串中的每个字符为 `&`、`|`、`^`  中的一个（分别代表与、或和异或），表示每一个 $\\otimes_{o_i}$。\n\n接下来 $m$ 行，每一行三个非负整数 $x,y,v$，表示一条连接 $x$ 和 $y$ 权值为 $v$ 的边，保证 $1\\leq x,y\\leq n$，$0\\le v < 2^w$。\n\n对于所有数据，$1\\le n\\le 70,1\\le m\\le 5000,1\\le w \\le 12$。", "outputFormat": "输出一行一个数，表示答案。如果图不连通，输出 `-1`。", "hint": "### 关于数据\n\n由于一些原因，数据只保留了最后 $20$ 个点。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5407", "type": "P", "difficulty": 3, "samples": [["2019", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2019", "THUPC"], "title": "[THUPC 2019] 历史行程", "background": "> 人生是怎么样的呢？我们是怎样活着的呢？\n>\n> 无论是谁，都是从黑暗中降生，最后再回归于黑暗。几年，几十年，短暂而漫长的时光。形形色色的人，形形色色的事，如过眼云烟，转瞬即逝。过眼繁花终有尽时，有些东西还能弥留于你的记忆之中，但更多的，早已无可寻觅。\n>\n> 但是，有个人，你不会忘记。\n>\n> 在你降生于黑暗之中时，那个人就一直陪在你身边。当你突破那黑暗，第一次见到世界的光明的时候，那个人也在你身边。\n>\n> 第一次的啼哭，第一次的说话，第一次的走路，第一次的奔跑。\n>\n> 每一次的成长，是你自己的一次飞跃。而对那个人来说，则是最纯真的喜悦和感动。\n> \n>在你不知道的时候，在你不知道的地方，那个人倾尽自己的一切，为你创造最好的一切，保护你的一切，为你指引走向未来的桥梁。\n>\n> 那个人每天都在期盼着，期盼着你能早点长大，变得拥有保护你自己的力量。\n>\n> 那个人每天都在担心着，担心着你与那个人分别那天，终究还是会来到。\n>\n> 你终究会一直成长，你终究会拥有自立自强的能力。那个人，也不能再像以前一样，保护你。\n>\n> 有一天，你将走向更宽阔的未来，你会拥有和以前完全不一样的一切。而那个人，已经不再能够保护你了。\n>\n> 而你和那个人之间能够拥有的时间，也就越来越短了。\n>\n> 五年，十年，二十年，你一天一天长大。\n>\n> 五年，十年，二十年，那个人一天天老去。\n>\n> 那个人已经不能保护你了，那么现在，该你，去保护那个人了。\n>\n> 也许那个人不能永远在你身边，也许那个人终将离你而去。\n>\n> 但你永远不会忘记那个人，因为那个人，始终在你身边。\n>\n> 今天，是那个人的节日。", "description": "母亲节是一个为感谢母亲而庆祝的节日，而在世界各地的母亲节的日期有所不同。母亲们在这一天里通常会收到孩子们送的礼物；而在许多人心目中，康乃馨被视作最适于献给母亲的鲜花之一。\n\n1913 年，美国国会确定将每年 5 月的第二个星期日作为法定的母亲节，这也是现代母亲节的起源。\n\n给定一个年份，请你输出这一年的母亲节的日期。方便起见，你只需要输出它是这年 5 月的第几天即可。", "inputFormat": "一行一个整数 $y$，表示年份。\n\n保证 $1913\\leq y\\leq 2019$。", "outputFormat": "一行一个整数，表示这年的母亲节是 5 月的第几天。（请注意**不要**输出多余的前导零）", "hint": "### 样例解释\n\n2019 年的母亲节是 5 月 12 日。\n\n### 关于数据\n\n由于一些原因数据只保留了随机的 $50$ 个点。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Historical Journey", "background": "> What is life like? How do we live?\n>\n> No matter who it is, everyone is born from darkness and will eventually return to darkness. A few years, a few decades—short yet long. All kinds of people, all kinds of things, like clouds passing before your eyes, vanish in an instant. The flowers you once saw will wither in the end. Some things may still linger in your memory, but even more have long become impossible to find.\n>\n> But there is one person you will not forget.\n>\n> When you were born into the darkness, that person was always by your side. When you broke through the darkness and first saw the light of the world, that person was also by your side.\n>\n> The first cry, the first words, the first steps, the first run.\n>\n> Every time you grow, it is a leap for yourself. But for that person, it is the purest joy and emotion.\n> \n> When you do not know, in places you do not know, that person gives everything they have to create the best for you, to protect everything about you, and to point out a bridge leading you to the future.\n>\n> That person hopes every day, hoping that you can grow up sooner and become strong enough to protect yourself.\n>\n> That person worries every day, worrying that the day you part from that person will finally come.\n>\n> You will keep growing, and you will have the ability to stand on your own. And that person can no longer protect you like before.\n>\n> One day, you will walk toward a broader future. You will have everything completely different from before. And that person can no longer protect you.\n>\n> And the time you and that person can have together is getting shorter and shorter.\n>\n> Five years, ten years, twenty years—you grow up day by day.\n>\n> Five years, ten years, twenty years—that person grows old day by day.\n>\n> That person can no longer protect you, so now it is your turn to protect that person.\n>\n> Maybe that person cannot stay by your side forever. Maybe that person will eventually leave you.\n>\n> But you will never forget that person, because that person has always been by your side.\n>\n> Today is that person’s holiday.", "description": "Mother’s Day is a holiday celebrated to thank mothers, and its date differs in different parts of the world. On this day, mothers usually receive gifts from their children. In many people’s minds, carnations are considered one of the most suitable flowers to give to mothers.\n\nIn 1913, the U.S. Congress designated the second Sunday of May each year as the legal Mother’s Day, which is also the origin of modern Mother’s Day.\n\nGiven a year, output the date of Mother’s Day in that year. For convenience, you only need to output which day of May it is in that year.", "inputFormat": "One line with one integer $y$, representing the year.\n\nIt is guaranteed that $1913\\leq y\\leq 2019$.", "outputFormat": "One line with one integer, indicating which day of May Mother’s Day falls on in that year. (Please note: do **not** output extra leading zeros.)", "hint": "### Sample Explanation\n\nMother’s Day in 2019 is May 12.\n\n### About the testdata\n\nFor some reasons, only 50 random test points were kept.\n\n### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 历史行程", "background": "> 人生是怎么样的呢？我们是怎样活着的呢？\n>\n> 无论是谁，都是从黑暗中降生，最后再回归于黑暗。几年，几十年，短暂而漫长的时光。形形色色的人，形形色色的事，如过眼云烟，转瞬即逝。过眼繁花终有尽时，有些东西还能弥留于你的记忆之中，但更多的，早已无可寻觅。\n>\n> 但是，有个人，你不会忘记。\n>\n> 在你降生于黑暗之中时，那个人就一直陪在你身边。当你突破那黑暗，第一次见到世界的光明的时候，那个人也在你身边。\n>\n> 第一次的啼哭，第一次的说话，第一次的走路，第一次的奔跑。\n>\n> 每一次的成长，是你自己的一次飞跃。而对那个人来说，则是最纯真的喜悦和感动。\n> \n>在你不知道的时候，在你不知道的地方，那个人倾尽自己的一切，为你创造最好的一切，保护你的一切，为你指引走向未来的桥梁。\n>\n> 那个人每天都在期盼着，期盼着你能早点长大，变得拥有保护你自己的力量。\n>\n> 那个人每天都在担心着，担心着你与那个人分别那天，终究还是会来到。\n>\n> 你终究会一直成长，你终究会拥有自立自强的能力。那个人，也不能再像以前一样，保护你。\n>\n> 有一天，你将走向更宽阔的未来，你会拥有和以前完全不一样的一切。而那个人，已经不再能够保护你了。\n>\n> 而你和那个人之间能够拥有的时间，也就越来越短了。\n>\n> 五年，十年，二十年，你一天一天长大。\n>\n> 五年，十年，二十年，那个人一天天老去。\n>\n> 那个人已经不能保护你了，那么现在，该你，去保护那个人了。\n>\n> 也许那个人不能永远在你身边，也许那个人终将离你而去。\n>\n> 但你永远不会忘记那个人，因为那个人，始终在你身边。\n>\n> 今天，是那个人的节日。", "description": "母亲节是一个为感谢母亲而庆祝的节日，而在世界各地的母亲节的日期有所不同。母亲们在这一天里通常会收到孩子们送的礼物；而在许多人心目中，康乃馨被视作最适于献给母亲的鲜花之一。\n\n1913 年，美国国会确定将每年 5 月的第二个星期日作为法定的母亲节，这也是现代母亲节的起源。\n\n给定一个年份，请你输出这一年的母亲节的日期。方便起见，你只需要输出它是这年 5 月的第几天即可。", "inputFormat": "一行一个整数 $y$，表示年份。\n\n保证 $1913\\leq y\\leq 2019$。", "outputFormat": "一行一个整数，表示这年的母亲节是 5 月的第几天。（请注意**不要**输出多余的前导零）", "hint": "### 样例解释\n\n2019 年的母亲节是 5 月 12 日。\n\n### 关于数据\n\n由于一些原因数据只保留了随机的 $50$ 个点。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5408", "type": "P", "difficulty": 7, "samples": [["3\n", "0 2 3 1\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "倍增", "多项式", "分治", "Stirling 数", "快速数论变换 NTT"], "title": "第一类斯特林数·行", "background": null, "description": "第一类斯特林数 $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ 表示将 $n$ 个**不同**元素构成 $m$ 个圆排列的数目。\n\n给定 $n$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{bmatrix}n\\\\ i\\end{bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{bmatrix}n\\\\ 0\\end{bmatrix},\\begin{bmatrix}n\\\\ 1\\end{bmatrix},\\begin{bmatrix}n\\\\ 2\\end{bmatrix},\\dots,\\begin{bmatrix}n\\\\ n\\end{bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n< 262144$。", "locale": "zh-CN", "translations": {"en": {"title": "Stirling Numbers of the First Kind · Row.", "background": "", "description": "The Stirling number of the first kind $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ represents the number of ways to arrange $n$ **distinct** elements into $m$ circular permutations.\n\nGiven $n$, for every integer $i\\in[0,n]$, you need to compute $\\begin{bmatrix}n\\\\ i\\end{bmatrix}$.\n\nSince the answer can be very large, you should output the result modulo $167772161$ ($2^{25}\\times 5+1$, which is a prime).", "inputFormat": "A single line containing a positive integer $n$, as described in the statement.", "outputFormat": "Output one line with $n+1$ non-negative integers.\n\nYou need to output, in order, the values of $\\begin{bmatrix}n\\\\ 0\\end{bmatrix},\\begin{bmatrix}n\\\\ 1\\end{bmatrix},\\begin{bmatrix}n\\\\ 2\\end{bmatrix},\\dots,\\begin{bmatrix}n\\\\ n\\end{bmatrix}$.", "hint": "For $20\\%$ of the testdata, $n\\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1\\leqslant n< 262144$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "第一类斯特林数·行", "background": null, "description": "第一类斯特林数 $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ 表示将 $n$ 个**不同**元素构成 $m$ 个圆排列的数目。\n\n给定 $n$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{bmatrix}n\\\\ i\\end{bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{bmatrix}n\\\\ 0\\end{bmatrix},\\begin{bmatrix}n\\\\ 1\\end{bmatrix},\\begin{bmatrix}n\\\\ 2\\end{bmatrix},\\dots,\\begin{bmatrix}n\\\\ n\\end{bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n< 262144$。", "locale": "zh-CN"}}}
{"pid": "P5409", "type": "P", "difficulty": 7, "samples": [["3 2\n", "0 0 1 3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Stirling 数"], "title": "第一类斯特林数·列", "background": "模板题，无背景。\n\n**验题人提示：程序运行时间受评测压力影响较大，评测高峰可能会被卡常。**", "description": "第一类斯特林数 $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ 表示将 $n$ 个**不同**元素构成 $m$ 个圆排列的数目。\n\n给定 $n,k$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{bmatrix}i\\\\ k\\end{bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行两个正整数 $n,k$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{bmatrix}0\\\\ k\\end{bmatrix},\\begin{bmatrix}1\\\\ k\\end{bmatrix},\\begin{bmatrix}2\\\\ k\\end{bmatrix},\\dots,\\begin{bmatrix}n\\\\ k\\end{bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant k,n< 131072$。", "locale": "zh-CN", "translations": {"en": {"title": "Stirling Numbers of the First Kind · Sequence", "background": "This is a template problem, with no background.\n\n**Checker’s note: The program running time is greatly affected by judging load, and it may get time-limited during peak judging periods.**", "description": "The Stirling number of the first kind $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ represents the number of ways to arrange $n$ **distinct** elements into $m$ circular permutations.\n\nGiven $n, k$, for every integer $i \\in [0, n]$, you need to compute $\\begin{bmatrix}i\\\\ k\\end{bmatrix}$.\n\nSince the answer can be very large, you need to output the result modulo $167772161$ ($2^{25}\\times 5+1$, which is a prime).", "inputFormat": "One line with two positive integers $n, k$, as described in the statement.", "outputFormat": "One line with $n+1$ non-negative integers.\n\nOutput, in order, the values of $\\begin{bmatrix}0\\\\ k\\end{bmatrix}, \\begin{bmatrix}1\\\\ k\\end{bmatrix}, \\begin{bmatrix}2\\\\ k\\end{bmatrix}, \\dots, \\begin{bmatrix}n\\\\ k\\end{bmatrix}$.", "hint": "For $20\\%$ of the testdata, $n \\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leqslant k, n < 131072$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "第一类斯特林数·列", "background": "模板题，无背景。\n\n**验题人提示：程序运行时间受评测压力影响较大，评测高峰可能会被卡常。**", "description": "第一类斯特林数 $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ 表示将 $n$ 个**不同**元素构成 $m$ 个圆排列的数目。\n\n给定 $n,k$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{bmatrix}i\\\\ k\\end{bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行两个正整数 $n,k$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{bmatrix}0\\\\ k\\end{bmatrix},\\begin{bmatrix}1\\\\ k\\end{bmatrix},\\begin{bmatrix}2\\\\ k\\end{bmatrix},\\dots,\\begin{bmatrix}n\\\\ k\\end{bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant k,n< 131072$。", "locale": "zh-CN"}}}
{"pid": "P5410", "type": "P", "difficulty": 5, "samples": [["aaaabaa\naaaaa", "6\n21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "Z 函数", "模板题"], "title": "【模板】扩展 KMP / exKMP（Z 函数）", "background": "", "description": "给定两个字符串 $a,b$，你要求出两个数组：\n\n- $b$ 的 $z$ 函数数组 $z$，即 $b$ 与 $b$ 的每一个后缀的 LCP 长度。\n- $b$ 与 $a$ 的每一个后缀的 LCP 长度数组 $p$。\n\n对于一个长度为 $n$ 的数组 $a$，设其权值为 $\\operatorname{xor}_{i=1}^n i \\times (a_i + 1)$。", "inputFormat": "两行两个字符串 $a,b$。", "outputFormat": "第一行一个整数，表示 $z$ 的权值。\n\n第二行一个整数，表示 $p$ 的权值。", "hint": "**样例解释：**\n\n$z = \\{5\\ 4\\ 3\\ 2\\ 1\\}$，$p = \\{4\\ 3\\ 2\\ 1\\ 0\\ 2\\ 1\\}$。\n\n---\n\n**数据范围：**\n\n对于第一个测试点，$|a|,|b| \\le 2 \\times 10^3$。\n\n对于第二个测试点，$|a|,|b| \\le 2 \\times 10^5$。\n\n对于 $100\\%$ 的数据，$1 \\le |a|,|b| \\le 2 \\times 10^7$，所有字符均为小写字母。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Extended KMP / exKMP (Z Function).", "background": "", "description": "Given two strings $a, b$, you need to find two arrays:\n\n- The $z$ function array $z$ of $b$, that is, the LCP length between $b$ and each suffix of $b$.\n- The LCP length array $p$ between $b$ and each suffix of $a$.\n\nFor an array $a$ of length $n$, define its weight as $\\operatorname{xor}_{i=1}^n i \\times (a_i + 1)$.", "inputFormat": "Two lines, containing two strings $a, b$.", "outputFormat": "The first line contains one integer, the weight of $z$.\n\nThe second line contains one integer, the weight of $p$.", "hint": "**Sample explanation:**\n\n$z = \\{5\\ 4\\ 3\\ 2\\ 1\\}$, $p = \\{4\\ 3\\ 2\\ 1\\ 0\\ 2\\ 1\\}$.\n\n---\n\n**Constraints:**\n\nFor the first test point, $|a|, |b| \\le 2 \\times 10^3$.\n\nFor the second test point, $|a|, |b| \\le 2 \\times 10^5$.\n\nFor $100\\%$ of the data, $1 \\le |a|, |b| \\le 2 \\times 10^7$, and all characters are lowercase letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】扩展 KMP / exKMP（Z 函数）", "background": "", "description": "给定两个字符串 $a,b$，你要求出两个数组：\n\n- $b$ 的 $z$ 函数数组 $z$，即 $b$ 与 $b$ 的每一个后缀的 LCP 长度。\n- $b$ 与 $a$ 的每一个后缀的 LCP 长度数组 $p$。\n\n对于一个长度为 $n$ 的数组 $a$，设其权值为 $\\operatorname{xor}_{i=1}^n i \\times (a_i + 1)$。", "inputFormat": "两行两个字符串 $a,b$。", "outputFormat": "第一行一个整数，表示 $z$ 的权值。\n\n第二行一个整数，表示 $p$ 的权值。", "hint": "**样例解释：**\n\n$z = \\{5\\ 4\\ 3\\ 2\\ 1\\}$，$p = \\{4\\ 3\\ 2\\ 1\\ 0\\ 2\\ 1\\}$。\n\n---\n\n**数据范围：**\n\n对于第一个测试点，$|a|,|b| \\le 2 \\times 10^3$。\n\n对于第二个测试点，$|a|,|b| \\le 2 \\times 10^5$。\n\n对于 $100\\%$ 的数据，$1 \\le |a|,|b| \\le 2 \\times 10^7$，所有字符均为小写字母。", "locale": "zh-CN"}}}
{"pid": "P5411", "type": "P", "difficulty": 7, "samples": [["6 2\n1 2\n2 3\n1 4\n4 5\n4 6\n6\n1\n2\n3\n4\n5\n6", "9\n4\n4\n9\n9\n9"], ["10 2\n1 2\n1 3\n2 4\n4 5\n4 6\n2 7\n2 8\n7 9\n7 10\n10\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10", "16\n16\n4\n16\n9\n9\n16\n16\n9\n9"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "陕西"], "title": "[SNOI2019] 网络", "background": "", "description": "有 $n$ 个数据中心，编号为 $1,2,\\cdots,n$。它们被 $n-1$ 条光缆连通，形成一棵树。\n\n每条光缆传输数据时有 $1$ 单位时间的延迟，两个数据中心之间的延迟为连接它们的光缆的延迟之和。\n\n现在要在这 $n$ 个数据中心中选若干个作为通讯站，要求任意两个通讯站之间的延迟不超过 $d$。设选出的通讯站为 ${w_1,w_2,……,w_k}$，则通讯总延迟为这 $k$ 个通讯站两两之间的延迟之和。\n\n现在有 $q$ 次询问，每次选定一个数据中心 $u$，你需要求出：如果 $u$ 是一个通讯站，最大可能的通讯总延迟是多少。", "inputFormat": "第一行两个自然数 $n,d$ ，分别表示数据中心的个数和两个通讯站之间最大允许的延迟。\n\n接下来 $n-1$ 行每行两个正整数 $u,v$ 表示 $u$ 和 $v$ 之间有一条光缆。\n\n接下来一行一个正整数 $q$ 表示询问次数。\n\n接下来 $q$ 行每行一个正整数 $u$ 表示询问中选定的通讯站。", "outputFormat": "输出共 $q$ 行，每行一个整数表示该次询问的答案。", "hint": "对于所有数据，$1 \\leq n \\leq 5\\times10^5$，$0 \\leq d<n$，$0 \\leq q \\leq 10$。\n\n对于10%的数据，$n \\leq 15$；\n\n对于另外10%的数据，$d=n-1$；\n\n对于另外15%的数据，$n \\leq 300$；\n\n对于另外15%的数据，$n \\leq 5000$；\n\n对于另外20%的数据，$n \\leq 10^5$；\n\n对于余下30%的数据，无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] Network", "background": "", "description": "There are $n$ data centers, numbered $1,2,\\cdots,n$. They are connected by $n-1$ optical cables, forming a tree.\n\nEach optical cable has a delay of $1$ unit time when transmitting data. The delay between two data centers is the sum of the delays of the optical cables along the path connecting them.\n\nNow you need to choose some of these $n$ data centers as communication stations, such that the delay between any two communication stations does not exceed $d$. Let the selected communication stations be ${w_1,w_2,……,w_k}$. Then the total communication delay is the sum of delays between every pair of these $k$ communication stations.\n\nThere are $q$ queries. In each query, a data center $u$ is specified. You need to find: if $u$ must be a communication station, what is the maximum possible total communication delay.", "inputFormat": "The first line contains two natural numbers $n,d$, representing the number of data centers and the maximum allowed delay between any two communication stations.\n\nThe next $n-1$ lines each contain two positive integers $u,v$, indicating that there is an optical cable between $u$ and $v$.\n\nThe next line contains a positive integer $q$, representing the number of queries.\n\nThe next $q$ lines each contain one positive integer $u$, representing the communication station specified in the query.", "outputFormat": "Output $q$ lines in total. Each line contains one integer, representing the answer to that query.", "hint": "For all data, $1 \\leq n \\leq 5\\times10^5$, $0 \\leq d<n$, $0 \\leq q \\leq 10$.\n\nFor $10\\%$ of the data, $n \\leq 15$.\n\nFor another $10\\%$ of the data, $d=n-1$.\n\nFor another $15\\%$ of the data, $n \\leq 300$.\n\nFor another $15\\%$ of the data, $n \\leq 5000$.\n\nFor another $20\\%$ of the data, $n \\leq 10^5$.\n\nFor the remaining $30\\%$ of the data, there are no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 网络", "background": "", "description": "有 $n$ 个数据中心，编号为 $1,2,\\cdots,n$。它们被 $n-1$ 条光缆连通，形成一棵树。\n\n每条光缆传输数据时有 $1$ 单位时间的延迟，两个数据中心之间的延迟为连接它们的光缆的延迟之和。\n\n现在要在这 $n$ 个数据中心中选若干个作为通讯站，要求任意两个通讯站之间的延迟不超过 $d$。设选出的通讯站为 ${w_1,w_2,……,w_k}$，则通讯总延迟为这 $k$ 个通讯站两两之间的延迟之和。\n\n现在有 $q$ 次询问，每次选定一个数据中心 $u$，你需要求出：如果 $u$ 是一个通讯站，最大可能的通讯总延迟是多少。", "inputFormat": "第一行两个自然数 $n,d$ ，分别表示数据中心的个数和两个通讯站之间最大允许的延迟。\n\n接下来 $n-1$ 行每行两个正整数 $u,v$ 表示 $u$ 和 $v$ 之间有一条光缆。\n\n接下来一行一个正整数 $q$ 表示询问次数。\n\n接下来 $q$ 行每行一个正整数 $u$ 表示询问中选定的通讯站。", "outputFormat": "输出共 $q$ 行，每行一个整数表示该次询问的答案。", "hint": "对于所有数据，$1 \\leq n \\leq 5\\times10^5$，$0 \\leq d<n$，$0 \\leq q \\leq 10$。\n\n对于10%的数据，$n \\leq 15$；\n\n对于另外10%的数据，$d=n-1$；\n\n对于另外15%的数据，$n \\leq 300$；\n\n对于另外15%的数据，$n \\leq 5000$；\n\n对于另外20%的数据，$n \\leq 10^5$；\n\n对于余下30%的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5412", "type": "P", "difficulty": 2, "samples": [["1\n5\n1 0 1 0 1\n120.2 130.3 140.4 150.5 160.6\n", "130.3 150.5\n120.2 140.4 160.6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "2019", "各省省选", "排序", "云南"], "title": "[YNOI2019] 排队", "background": "", "description": "小明所在的班级要举办一场课外活动，在活动开始之前老师告诉小明：“需要把男女生分成两队，并且每一队都要按照身高从矮到高进行排序”。但是由于小明的马虎，没有把老师的安排转达给同学，导致全班同学已经排成了一列。活动马上要开始了，小明的老师对此很困扰，你能帮帮她吗？\n", "inputFormat": "每个输入文件包含多组数据。\n\n输入文件的第一行，包含一个正整数 $T$，代表该输入文件中所含的数据组数。\n\n接下来是 $T$ 组数据，每组数据的格式如下：\n\n每组数据包含 $3$ 行；\n\n第一行包含一个整数 $n$，代表班级的总人数，其中 $(0 < n \\leq 2\\times 10^{3})$；\n\n第二行包含 $n$ 个整数，它们之间用一个空格隔开，代表已经排成的一列中每一位同学的性别。每一位整数只取 $0$ 或 $1$（$0$ 表示女生，$1$ 表示男生）；\n\n第三行包含 $n$ 个浮点数，它们之间用一个空格隔开，与第二行中的数据一一对应，代表已经排成的一列中每一位同学的身高 $h(100 \\leq h \\leq 200)$。", "outputFormat": "输出文件包含 $2T$ 行，分别对应 $T$ 组数据的答案，每组答案的格式如下：\n\n每组答案包含 $2$ 行；\n\n第一行按照从小到大的顺序输出所有女生的身高；\n\n第二行按照从小到大的顺序输出所有男生的身高。\n\n注意在输出身高时，请按照原来的身高保留对应的小数点位数。", "hint": "对于 $60\\%$ 的数据：$0 < n \\leq 10^{2}$，$100 \\leq h \\leq 200$。\n\n对于 $80\\%$ 的数据：$0 < n \\leq 10^{3}$ ，$100 \\leq h \\leq 200$。\n\n对于 $100\\%$ 的数据：$0 < n \\leq 2\\times 10^{3}$，$100 \\leq h \\leq 200$，$T\\le 5$。", "locale": "zh-CN", "translations": {"en": {"title": "[YNOI2019] Queueing", "background": "", "description": "Xiaoming’s class is going to hold an extracurricular activity. Before the activity starts, the teacher tells Xiaoming: “You need to split the girls and boys into two teams, and each team must be sorted by height from short to tall.” However, because Xiaoming was careless and did not pass the arrangement to his classmates, the whole class has already lined up in a single row. The activity is about to start, and Xiaoming’s teacher is troubled by this. Can you help her?", "inputFormat": "Each input file contains multiple test cases.\n\nThe first line of the input contains a positive integer $T$, which denotes the number of test cases in this input file.\n\nThen follow $T$ test cases. The format of each test case is as follows:\n\nEach test case consists of $3$ lines.\n\nThe first line contains an integer $n$, representing the total number of students in the class, where $(0 < n \\leq 2\\times 10^{3})$.\n\nThe second line contains $n$ integers separated by single spaces, representing the gender of each student in the already formed row. Each integer is either $0$ or $1$ ($0$ means girl, $1$ means boy).\n\nThe third line contains $n$ floating-point numbers separated by single spaces, corresponding one-to-one with the second line, representing each student’s height $h(100 \\leq h \\leq 200)$ in the already formed row.", "outputFormat": "The output file contains $2T$ lines, corresponding to the answers for the $T$ test cases. The format of each test case’s output is as follows:\n\nEach test case’s output consists of $2$ lines.\n\nThe first line outputs the heights of all girls in increasing order.\n\nThe second line outputs the heights of all boys in increasing order.\n\nNote that when outputting heights, please keep the same number of digits after the decimal point as in the original height.", "hint": "For $60\\%$ of the testdata: $0 < n \\leq 10^{2}$, $100 \\leq h \\leq 200$.\n\nFor $80\\%$ of the testdata: $0 < n \\leq 10^{3}$, $100 \\leq h \\leq 200$.\n\nFor $100\\%$ of the testdata: $0 < n \\leq 2\\times 10^{3}$, $100 \\leq h \\leq 200$, $T\\le 5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[YNOI2019] 排队", "background": "", "description": "小明所在的班级要举办一场课外活动，在活动开始之前老师告诉小明：“需要把男女生分成两队，并且每一队都要按照身高从矮到高进行排序”。但是由于小明的马虎，没有把老师的安排转达给同学，导致全班同学已经排成了一列。活动马上要开始了，小明的老师对此很困扰，你能帮帮她吗？\n", "inputFormat": "每个输入文件包含多组数据。\n\n输入文件的第一行，包含一个正整数 $T$，代表该输入文件中所含的数据组数。\n\n接下来是 $T$ 组数据，每组数据的格式如下：\n\n每组数据包含 $3$ 行；\n\n第一行包含一个整数 $n$，代表班级的总人数，其中 $(0 < n \\leq 2\\times 10^{3})$；\n\n第二行包含 $n$ 个整数，它们之间用一个空格隔开，代表已经排成的一列中每一位同学的性别。每一位整数只取 $0$ 或 $1$（$0$ 表示女生，$1$ 表示男生）；\n\n第三行包含 $n$ 个浮点数，它们之间用一个空格隔开，与第二行中的数据一一对应，代表已经排成的一列中每一位同学的身高 $h(100 \\leq h \\leq 200)$。", "outputFormat": "输出文件包含 $2T$ 行，分别对应 $T$ 组数据的答案，每组答案的格式如下：\n\n每组答案包含 $2$ 行；\n\n第一行按照从小到大的顺序输出所有女生的身高；\n\n第二行按照从小到大的顺序输出所有男生的身高。\n\n注意在输出身高时，请按照原来的身高保留对应的小数点位数。", "hint": "对于 $60\\%$ 的数据：$0 < n \\leq 10^{2}$，$100 \\leq h \\leq 200$。\n\n对于 $80\\%$ 的数据：$0 < n \\leq 10^{3}$ ，$100 \\leq h \\leq 200$。\n\n对于 $100\\%$ 的数据：$0 < n \\leq 2\\times 10^{3}$，$100 \\leq h \\leq 200$，$T\\le 5$。", "locale": "zh-CN"}}}
{"pid": "P5413", "type": "P", "difficulty": 3, "samples": [["1\n2\n5 3 1\n1 1 1\n", "4.6904157598"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2019", "各省省选", "Special Judge", "云南"], "title": "[YNOI2019] 骑单车", "background": null, "description": "小明每天早晨上课都需要骑着单车经过 $n$ 段路，第i段路的长度为 $w_i (m)$，限速为 $s_i (m/s)$（在路上骑行的速度不能超过限速），加速度的绝对值最大为 $a_i (m/s^{2})$（可以加速也可以减速）。初始速度为 $0(m/s)$，你的任务是计算小明通过这 $n$ 段路的最短时间。", "inputFormat": "**本题包含多组数据。**\n\n第一行，包含一个正整数 $T$，代表所含的数据组数。\n\n接下来是 $T$ 组数据，每组数据的格式如下：\n\n每组数据包含 $n+1$ 行；\n\n第一行包含一个正整数 $n$，代表共有 $n$ 段路；\n\n接下来的 $n$ 行，每一行包含三个正整数 $w_i,s_i,a_i$，分别代表第 $i$ 段路的长度、限速和最大加速度的绝对值。", "outputFormat": "输出包含 $T$ 行，分别对应 $T$ 组数据的答案，即小明通过 $n$ 条道路所需要的最短时间（只要你的答案和标准答案的绝对误差在 $10^{-5}$ 以内就算通过）。", "hint": "对于 $60\\%$ 的数据：$0 < n \\le60$；\n\n对于 $80\\%$ 的数据：$0 < n \\le 80$；\n\n对于 $100\\%$ 的数据：$0 < n \\le10^{2}$，$w_i,s_i,a_i ≤ 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[YNOI2019] Cycling", "background": "", "description": "Xiaoming needs to ride a bicycle through $n$ road segments every morning to get to class. The length of the $i$-th segment is $w_i (m)$, and the speed limit is $s_i (m/s)$ (the riding speed on the road cannot exceed the speed limit). The maximum absolute value of acceleration is $a_i (m/s^{2})$ (he can either speed up or slow down). The initial speed is $0 (m/s)$. Your task is to compute the minimum time for Xiaoming to pass these $n$ segments.", "inputFormat": "**This problem contains multiple test cases.**\n\nThe first line contains a positive integer $T$, representing the number of test cases.\n\nThen follow $T$ test cases, each in the following format:\n\nEach test case contains $n+1$ lines.\n\nThe first line contains a positive integer $n$, representing that there are $n$ road segments.\n\nThe next $n$ lines each contain three positive integers $w_i, s_i, a_i$, representing the length, the speed limit, and the maximum absolute acceleration of the $i$-th segment, respectively.", "outputFormat": "Output $T$ lines, corresponding to the answers for the $T$ test cases. That is, the minimum time Xiaoming needs to pass the $n$ road segments (your answer is accepted as long as the absolute error from the standard answer is within $10^{-5}$).", "hint": "For $60\\%$ of the testdata: $0 < n \\le 60$.\n\nFor $80\\%$ of the testdata: $0 < n \\le 80$.\n\nFor $100\\%$ of the testdata: $0 < n \\le 10^{2}, w_i, s_i, a_i \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[YNOI2019] 骑单车", "background": null, "description": "小明每天早晨上课都需要骑着单车经过 $n$ 段路，第i段路的长度为 $w_i (m)$，限速为 $s_i (m/s)$（在路上骑行的速度不能超过限速），加速度的绝对值最大为 $a_i (m/s^{2})$（可以加速也可以减速）。初始速度为 $0(m/s)$，你的任务是计算小明通过这 $n$ 段路的最短时间。", "inputFormat": "**本题包含多组数据。**\n\n第一行，包含一个正整数 $T$，代表所含的数据组数。\n\n接下来是 $T$ 组数据，每组数据的格式如下：\n\n每组数据包含 $n+1$ 行；\n\n第一行包含一个正整数 $n$，代表共有 $n$ 段路；\n\n接下来的 $n$ 行，每一行包含三个正整数 $w_i,s_i,a_i$，分别代表第 $i$ 段路的长度、限速和最大加速度的绝对值。", "outputFormat": "输出包含 $T$ 行，分别对应 $T$ 组数据的答案，即小明通过 $n$ 条道路所需要的最短时间（只要你的答案和标准答案的绝对误差在 $10^{-5}$ 以内就算通过）。", "hint": "对于 $60\\%$ 的数据：$0 < n \\le60$；\n\n对于 $80\\%$ 的数据：$0 < n \\le 80$；\n\n对于 $100\\%$ 的数据：$0 < n \\le10^{2}$，$w_i,s_i,a_i ≤ 10$。", "locale": "zh-CN"}}}
{"pid": "P5414", "type": "P", "difficulty": 3, "samples": [["1\n4\n7 1 2 3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "各省省选", "云南"], "title": "[YNOI2019] 排序", "background": null, "description": "对于一个数列 $\\{7, 1, 2, 3\\}$ 进行排序，我们可以把 $7$ 从头移动到尾。但是这个操作的成本是 $7$，并不是最佳的。最佳的排序方式是将连续的 $1,2,3$ 移动到 $7$ 的前面。这样的话，总的操作成本就是 $1+2+3=6$，比之前的成本 $7$ 要小。\n\n你的任务是，对于一个给定的数列，输出对这个数列进行排序的最小成本。", "inputFormat": "每个输入文件包含多组数据。\n\n输入文件的第一行，包含一个正整数 $T$，代表该输入文件中所含的数据组数。\n\n接下来是 $T$ 组数据，每组数据的格式如下：\n\n每组数据包含 $2$ 行；\n\n第一行包含一个正整数 $n$，代表数列中元素的个数，其中 $0 < n \\leq 10^2$；\n\n第二行包含 $n$ 个整数，两个数之间以一个空格隔开，代表数列中的元素 $k_i$，其中$1 \\leq k_i \\leq 10^{7}$。", "outputFormat": "输出文件包含 $T$ 行，分别对应 $T$ 组数据的答案，即对数列进行排序的最小成本。", "hint": "对于 $60\\%$ 的数据：$0 < n \\leq 60$，$1 \\leq k_i \\leq 10^{7}$\n\n对于 $80\\%$ 的数据：$0 < n \\leq 80$，$1 \\leq k_i \\leq 10^{7}$\n\n对于 $100\\%$ 的数据：$0 < n \\leq 10^2$，$1 \\leq k_i \\leq 10^{7}$，$0 < T \\leq 10$", "locale": "zh-CN", "translations": {"en": {"title": "[YNOI2019] Sorting", "background": "", "description": "To sort a sequence $\\{7, 1, 2, 3\\}$, we can move $7$ from the beginning to the end. However, the cost of this operation is $7$, which is not optimal. The optimal way is to move the consecutive segment $1,2,3$ to the front of $7$. In this case, the total cost is $1+2+3=6$, which is smaller than the previous cost $7$.\n\nYour task is: for a given sequence, output the minimum cost to sort this sequence.", "inputFormat": "Each input file contains multiple test cases.\n\nThe first line contains a positive integer $T$, which represents the number of test cases in the input file.\n\nThen follow $T$ test cases, each in the following format:\n\nEach test case contains $2$ lines.\n\nThe first line contains a positive integer $n$, which represents the number of elements in the sequence, where $0 < n \\leq 10^2$.\n\nThe second line contains $n$ integers separated by a single space, representing the elements $k_i$ of the sequence, where $1 \\leq k_i \\leq 10^{7}$.", "outputFormat": "The output file contains $T$ lines, each corresponding to the answer for one test case, i.e., the minimum cost to sort the sequence.", "hint": "Constraints:\n\nFor $60\\%$ of the testdata: $0 < n \\leq 60$, $1 \\leq k_i \\leq 10^{7}$.\n\nFor $80\\%$ of the testdata: $0 < n \\leq 80$, $1 \\leq k_i \\leq 10^{7}$.\n\nFor $100\\%$ of the testdata: $0 < n \\leq 10^2$, $1 \\leq k_i \\leq 10^{7}$, $0 < T \\leq 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[YNOI2019] 排序", "background": null, "description": "对于一个数列 $\\{7, 1, 2, 3\\}$ 进行排序，我们可以把 $7$ 从头移动到尾。但是这个操作的成本是 $7$，并不是最佳的。最佳的排序方式是将连续的 $1,2,3$ 移动到 $7$ 的前面。这样的话，总的操作成本就是 $1+2+3=6$，比之前的成本 $7$ 要小。\n\n你的任务是，对于一个给定的数列，输出对这个数列进行排序的最小成本。", "inputFormat": "每个输入文件包含多组数据。\n\n输入文件的第一行，包含一个正整数 $T$，代表该输入文件中所含的数据组数。\n\n接下来是 $T$ 组数据，每组数据的格式如下：\n\n每组数据包含 $2$ 行；\n\n第一行包含一个正整数 $n$，代表数列中元素的个数，其中 $0 < n \\leq 10^2$；\n\n第二行包含 $n$ 个整数，两个数之间以一个空格隔开，代表数列中的元素 $k_i$，其中$1 \\leq k_i \\leq 10^{7}$。", "outputFormat": "输出文件包含 $T$ 行，分别对应 $T$ 组数据的答案，即对数列进行排序的最小成本。", "hint": "对于 $60\\%$ 的数据：$0 < n \\leq 60$，$1 \\leq k_i \\leq 10^{7}$\n\n对于 $80\\%$ 的数据：$0 < n \\leq 80$，$1 \\leq k_i \\leq 10^{7}$\n\n对于 $100\\%$ 的数据：$0 < n \\leq 10^2$，$1 \\leq k_i \\leq 10^{7}$，$0 < T \\leq 10$", "locale": "zh-CN"}}}
{"pid": "P5415", "type": "P", "difficulty": 6, "samples": [["3\n4 1 1\n5 1 5\n5 2 1\n", "0.250000\n0.000000\n0.217626"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "2019", "各省省选", "云南", "概率论", "高斯消元"], "title": "[YNOI2019] 游戏", "background": null, "description": "在经历了漫长的烧脑之旅后，相信同学们的思维已经充分地活跃起来了。最后，让我们玩一个游戏来结束这次充满乐趣和挑战的冒险之旅！\n\n有 $n$ 个人在玩游戏，游戏规则如下：\n\n在游戏开始之前，将这 $n$ 个人按照 $1\\sim n$ 的顺序唯一编号。游戏开始后，每一轮只允许 $4$ 个人进入游戏，其他人按照各自的编号组成等待队列，等待参加游戏。\n\n游戏中每个人赢得比赛的机会是同等的，游戏举办多轮，每一轮的获胜者可以继续参加下一轮的比赛，输家将根据本轮比赛开始之前的顺序排在等待队列的末尾（如果本轮的输家中有人赢得了上一轮比赛，那么他将在等待队列中排在本轮所有输家的前面）。\n\n例如，在某一轮比赛开始之前小明排在小红和小刚前面，如果在该轮比赛中小明、小红和小刚都没有赢，那么小明、小红和小刚将退出比赛排在等待队列的末尾，但是小明将会继续按照比赛开始之前的顺序排在小红和小刚前面。存在的特殊情况是，如果小刚在这轮比赛之前赢得了上一轮比赛，那么小刚将在等待序列中排在小明和小红的前面。\n\n比赛中，如果有人连续赢了 $m$ 次，那么他就是这个游戏最后的赢家。你的任务是，预测第 $k$ 个人成为最终赢家的可能。", "inputFormat": "**输入包含多组数据。**\n\n第一行，包含一个正整数 $T$，代表该输入文件中所含的数据组数。\n\n接下来是 $T$ 组数据，每组数据的格式如下：\n\n每组数据仅一行，包含三个整数 $n,m,k$。", "outputFormat": "输出包含 $T$ 行，分别对应 $T$ 组数据的答案，即第 $k$ 个人成为最终赢家的可能（结果保留 $6$ 位小数）。", "hint": "#### 数据规模与约定\n- 对于 $30\\%$ 的数据：保证 $ n \\le 5$，$m \\le 5$。\n- 对于 $60\\%$ 的数据：保证 $n \\le 8$，$m \\le 8$。\n- 对于 $100\\%$ 的数据：保证 $4 \\le n \\le 10$，$0 < m \\le 10$，$1\\le k \\le n$，除样例外 $T=1$。", "locale": "zh-CN", "translations": {"en": {"title": "[YNOI2019] Game", "background": "", "description": "After a long brain-burning journey, your minds should now be fully active. Finally, let us play a game to end this adventure full of fun and challenges.\n\nThere are $n$ people playing a game. The rules are as follows.\n\nBefore the game starts, the $n$ people are uniquely numbered from $1$ to $n$. After the game starts, in each round only $4$ people are allowed to play, and all others form a waiting queue in the order of their numbers, waiting to join the game.\n\nIn the game, everyone has an equal chance to win. The game is held over multiple rounds. In each round, the winner may continue to participate in the next round, while the losers will be placed at the end of the waiting queue according to their order before the start of this round (if any of the losers in this round won the previous round, then that person will be placed in the waiting queue in front of all losers of this round).\n\nFor example, before a certain round starts, Xiaoming is ahead of Xiaohong and Xiaogang. If in that round Xiaoming, Xiaohong, and Xiaogang all do not win, then they will leave the game and be placed at the end of the waiting queue, and Xiaoming will still be ahead of Xiaohong and Xiaogang according to their order before the round starts. A special case is that if Xiaogang won the previous round before this round, then Xiaogang will be placed ahead of Xiaoming and Xiaohong in the waiting queue.\n\nDuring the game, if someone wins consecutively for $m$ times, then they are the final winner of the game. Your task is to predict the probability that person $k$ becomes the final winner.", "inputFormat": "**The input contains multiple test cases.**\n\nThe first line contains a positive integer $T$, representing the number of test cases in the input file.\n\nNext come $T$ test cases, each in the following format.\n\nEach test case consists of one line containing three integers $n, m, k$.", "outputFormat": "Output $T$ lines, corresponding to the answers for the $T$ test cases, i.e. the probability that person $k$ becomes the final winner (rounded to $6$ decimal places).", "hint": "#### Constraints\n- For $30\\%$ of the testdata: $n \\le 5$, $m \\le 5$.\n- For $60\\%$ of the testdata: $n \\le 8$, $m \\le 8$.\n- For $100\\%$ of the testdata: $4 \\le n \\le 10$, $0 < m \\le 10$, $1 \\le k \\le n$, and except for the samples, $T = 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[YNOI2019] 游戏", "background": null, "description": "在经历了漫长的烧脑之旅后，相信同学们的思维已经充分地活跃起来了。最后，让我们玩一个游戏来结束这次充满乐趣和挑战的冒险之旅！\n\n有 $n$ 个人在玩游戏，游戏规则如下：\n\n在游戏开始之前，将这 $n$ 个人按照 $1\\sim n$ 的顺序唯一编号。游戏开始后，每一轮只允许 $4$ 个人进入游戏，其他人按照各自的编号组成等待队列，等待参加游戏。\n\n游戏中每个人赢得比赛的机会是同等的，游戏举办多轮，每一轮的获胜者可以继续参加下一轮的比赛，输家将根据本轮比赛开始之前的顺序排在等待队列的末尾（如果本轮的输家中有人赢得了上一轮比赛，那么他将在等待队列中排在本轮所有输家的前面）。\n\n例如，在某一轮比赛开始之前小明排在小红和小刚前面，如果在该轮比赛中小明、小红和小刚都没有赢，那么小明、小红和小刚将退出比赛排在等待队列的末尾，但是小明将会继续按照比赛开始之前的顺序排在小红和小刚前面。存在的特殊情况是，如果小刚在这轮比赛之前赢得了上一轮比赛，那么小刚将在等待序列中排在小明和小红的前面。\n\n比赛中，如果有人连续赢了 $m$ 次，那么他就是这个游戏最后的赢家。你的任务是，预测第 $k$ 个人成为最终赢家的可能。", "inputFormat": "**输入包含多组数据。**\n\n第一行，包含一个正整数 $T$，代表该输入文件中所含的数据组数。\n\n接下来是 $T$ 组数据，每组数据的格式如下：\n\n每组数据仅一行，包含三个整数 $n,m,k$。", "outputFormat": "输出包含 $T$ 行，分别对应 $T$ 组数据的答案，即第 $k$ 个人成为最终赢家的可能（结果保留 $6$ 位小数）。", "hint": "#### 数据规模与约定\n- 对于 $30\\%$ 的数据：保证 $ n \\le 5$，$m \\le 5$。\n- 对于 $60\\%$ 的数据：保证 $n \\le 8$，$m \\le 8$。\n- 对于 $100\\%$ 的数据：保证 $4 \\le n \\le 10$，$0 < m \\le 10$，$1\\le k \\le n$，除样例外 $T=1$。", "locale": "zh-CN"}}}
{"pid": "P5416", "type": "P", "difficulty": 7, "samples": [["4 4 2\n0 0 1 8 2 3 7\n0 1 2 10 1 6 2\n1 1 1\n1 4\n2 8\n2 6\n3 8", "18\n6\n11\n66"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "O2优化", "CTSC/CTS"], "title": "[CTSC2016] 时空旅行", "background": "", "description": "2045年，人类的技术突飞猛进，已经找到了进行时空旅行的方法。小 R 得到了一台时空旅行仪，他想用它调查不同时空中人类的发展状况。\n\n根据平行时空理论，宇宙中存在着很多独立的时空，每个时空在下一个时间点还会分化出若干个不同的时空。宇宙是一个三维空间，人类使用空间直角坐标系来描述空间中的一个位置，三维坐标分别是 $x,y,z$。\n\n我们假设在初始的时空（编号为 $0$）中，人类存在于地球上（地球的坐标为 $(0,0,0)$），其他的时空都是从一个现有的时空发展而来的。一个时空发生一个时间之后会发展成为另外一个时空（原来的时空不发生任何变化）。会影响小 R 的时间包括两类：\n\n1. 人类殖民了一个新的星球，该星球的状态变成“已被殖民”。\n2. 人类放弃了一个已被殖民的星球，该星球的状态变成“未被殖民”。\n\n每次进行时空旅行时，小 R 会先选定一个时空。在这个时空中，人类已经殖民了一些星球。小 R 只要到达该时空中任意一个已被殖民的星球，就能调查人类的发展状况。\n\n小 R 的时空旅行仪出现了一些问题，调整 $x$ 坐标的按钮坏掉了，因此到达点的 $x$ 坐标被固定了（每次旅行的 $x$ 坐标值可能不同）。与此同时，他仍能任意调整到达点的 $y$ 坐标和 $z$ 坐标。\n\n这个问题大大增大了小 R 的花费：因为时空旅行没有花费，但在太空中航行却需要花钱；同时，在不同星球进行调查也可能会产生不同的费用。\n\n假设小 R 将时空旅行的终点设为 $A$，他要进行调查的星球为 $B$：如果 $A$ 与 $B$ 的欧几里得距离为 $d$，那么他太空航行的花费就是 $d^2$；又如果星球 $B$上进行调查的费用为 $c$，那么小 R 此次调查的总花费就是 $d^2+c$。\n\n现在给定小 R 每次旅行到达的时空以及时空旅行仪上固定的 $x$ 坐标值，请你计算出小 R 每次旅行完成调查的最小总花费。", "inputFormat": "输入的第一行包含三个非负整数 $n,m,c_0$，$n$ 表示平行时空数量，这些平行时空的编号为 $0$ 到 $n-1$ 的整数，初始时空的编号为 $0$。$m$ 表示小 R 进行的时空旅行的次数，$c_0$ 表示在地球进行调查的花费。保证 $0< n,m \\leq 5 \\times 10^5, 0 \\leq c_0 \\leq 10^{12}$。\n\n接下来 $n-1$ 行，依次描述平行时空 $1$ 到 $n-1$，其中第 $i$ 行分两种情况：\n\n1. $0 \\ \\mathrm{fr} \\ \\mathrm{id} \\ x \\ y \\ z \\ c$：表示编号为 $i$ 的平行时空由编号为 $\\mathrm{fr}$ 的时空发展而来，人类殖民了一个编号为 $\\mathrm{id}$ 的星球，该星球的坐标为 $(x,y,z)$，在该星球进行调查的花费为 $c$。数据保证给出星球的编号不重复，且 $0< \\mathrm{id} < n$；保证 $|x|,|y|,|z| \\leq 10^6, 0 \\leq c \\leq 10^{12}$。\n2. $1 \\ \\mathrm{fr} \\ \\mathrm{id} $：表示编号为 $i$ 的平行时空由编号为 $\\mathrm{fr}$ 的时空发展而来，人类放弃了编号为 $\\mathrm{id}$ 的星球。数据保证该星球在编号为 $\\mathrm{fr}$ 的时空中处于被殖民的状态；保证 $\\mathrm{id} > 0$，即地球一定不会被放弃。\n\n上述两种情况中，各参数均为正数，相邻整数之间均用一个空格隔开；均保证 $0 \\leq \\mathrm{fr} < i$。保证不会出现上述两种之外的情况。\n\n接下来 $m$ 行，每行表示小 R 进行的一次时空旅行。每行包括两个正数 $s$ 和 $x_0$，表示小 R 到编号为 $s$ 的平行时空进行了一次时空旅行，时空旅行仪上的 $x$ 坐标被固定为了 $x_0$。保证 $0\\le s\\lt n$，$|x_0|\\le 10^6$。", "outputFormat": "输出 $m$ 行，分别表示每次旅行完成调查的最小总花费。", "hint": "对于前 $5\\%$ 的数据，$n,~m~\\leq~100$\n\n另有 $35\\%$ 的数据，$n,~m~\\leq~10^5$，其中有 $15\\%$ 的数据，人类不会放弃星球，另有 $10\\%$ 的数据，每次旅行的 $x$ 相同。\n\n对于剩下的数据，$n,~m~\\leq~5~\\times~10^5$，其中有 $10\\%$ 的数据，每次旅行的 $x$ 相同，$35\\%$ 的数据，时空 $i$ 由时空 $i - 1$ 发展而来。在这 $35\\%$ 的数据中有 $15\\%$ 的数据，人类不会放弃星球。\n\n由于文件压缩包过大无法上传，对于每一个子任务有且仅有一个测试点，为对应分值。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2016] Time-Space Travel", "background": "", "description": "In 2045, human technology advanced rapidly, and people have found a way to travel through time and space. Little R obtained a time-space travel device and wants to use it to investigate the development of humans in different time-spaces.\n\nAccording to the parallel time-space theory, there are many independent time-spaces in the universe. Each time-space will further split into several different time-spaces at the next time point. The universe is a three-dimensional space, and humans use a 3D Cartesian coordinate system to describe a position in space, with coordinates $x, y, z$.\n\nAssume that in the initial time-space (numbered $0$), humans live on Earth (Earth’s coordinates are $(0,0,0)$), and all other time-spaces are developed from an existing time-space. After one time step, a time-space will develop into another time-space (the original time-space does not change). Events that affect Little R are of two types:\n\n1. Humans colonize a new planet, and the planet’s state becomes “colonized”.\n2. Humans abandon a colonized planet, and the planet’s state becomes “not colonized”.\n\nEach time Little R performs time-space travel, he first chooses a time-space. In this time-space, humans have already colonized some planets. As long as Little R reaches any colonized planet in that time-space, he can investigate the development of humans.\n\nHowever, Little R’s device has some problems: the button for adjusting the $x$ coordinate is broken, so the $x$ coordinate of the destination point is fixed (the fixed $x$ value may differ for each trip). At the same time, he can still freely adjust the $y$ and $z$ coordinates of the destination.\n\nThis greatly increases Little R’s cost: time-space travel itself is free, but traveling in space costs money; also, investigating on different planets may incur different fees.\n\nSuppose Little R sets the endpoint of the time-space travel to $A$, and the planet he investigates is $B$. If the Euclidean distance between $A$ and $B$ is $d$, then the cost of space travel is $d^2$. If the investigation fee on planet $B$ is $c$, then the total cost of this investigation is $d^2 + c$.\n\nNow you are given the time-space Little R arrives at for each trip and the fixed $x$ coordinate value on the device. Please compute the minimum total cost for Little R to complete the investigation for each trip.", "inputFormat": "The first line contains three non-negative integers $n, m, c_0$. $n$ is the number of parallel time-spaces, numbered from $0$ to $n-1$, and the initial time-space is numbered $0$. $m$ is the number of time-space trips Little R makes. $c_0$ is the investigation fee on Earth. It is guaranteed that $0 < n, m \\leq 5 \\times 10^5$, and $0 \\leq c_0 \\leq 10^{12}$.\n\nThe next $n-1$ lines describe parallel time-spaces $1$ to $n-1$ in order. For time-space $i$, the $i$-th line is one of the following two cases:\n\n1. $0 \\ \\mathrm{fr} \\ \\mathrm{id} \\ x \\ y \\ z \\ c$: time-space $i$ develops from time-space $\\mathrm{fr}$, and humans colonize a planet with number $\\mathrm{id}$. The planet’s coordinates are $(x, y, z)$, and the investigation fee on this planet is $c$. The testdata guarantees that the given planet numbers are all distinct, and $0 < \\mathrm{id} < n$. Also, $|x|, |y|, |z| \\leq 10^6$, and $0 \\leq c \\leq 10^{12}$.\n2. $1 \\ \\mathrm{fr} \\ \\mathrm{id}$: time-space $i$ develops from time-space $\\mathrm{fr}$, and humans abandon the planet with number $\\mathrm{id}$. The testdata guarantees that this planet is colonized in time-space $\\mathrm{fr}$. Also, $\\mathrm{id} > 0$, meaning Earth will never be abandoned.\n\nIn both cases above, all parameters are positive integers, and adjacent integers are separated by one space. It is also guaranteed that $0 \\leq \\mathrm{fr} < i$. No other cases will appear.\n\nThe next $m$ lines each describe one time-space trip by Little R. Each line contains two positive integers $s$ and $x_0$, meaning that Little R travels to parallel time-space $s$, and the device fixes the $x$ coordinate to $x_0$. It is guaranteed that $0 \\leq s < n$ and $|x_0| \\leq 10^6$.", "outputFormat": "Output $m$ lines. The $i$-th line should be the minimum total cost to complete the investigation for the $i$-th trip.", "hint": "For the first $5\\%$ of the testdata, $n, m \\leq 100$.\n\nThere is another $35\\%$ of the testdata with $n, m \\leq 10^5$. Among them, for $15\\%$ of the testdata, humans never abandon planets, and for another $10\\%$ of the testdata, the $x$ value is the same for every trip.\n\nFor the remaining testdata, $n, m \\leq 5 \\times 10^5$. Among them, for $10\\%$ of the testdata, the $x$ value is the same for every trip, and for $35\\%$ of the testdata, time-space $i$ develops from time-space $i - 1$. In this $35\\%$, there is $15\\%$ of the testdata where humans never abandon planets.\n\nBecause the compressed file is too large to upload, for each subtask there is one and only one test point, corresponding to its score.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2016] 时空旅行", "background": "", "description": "2045年，人类的技术突飞猛进，已经找到了进行时空旅行的方法。小 R 得到了一台时空旅行仪，他想用它调查不同时空中人类的发展状况。\n\n根据平行时空理论，宇宙中存在着很多独立的时空，每个时空在下一个时间点还会分化出若干个不同的时空。宇宙是一个三维空间，人类使用空间直角坐标系来描述空间中的一个位置，三维坐标分别是 $x,y,z$。\n\n我们假设在初始的时空（编号为 $0$）中，人类存在于地球上（地球的坐标为 $(0,0,0)$），其他的时空都是从一个现有的时空发展而来的。一个时空发生一个时间之后会发展成为另外一个时空（原来的时空不发生任何变化）。会影响小 R 的时间包括两类：\n\n1. 人类殖民了一个新的星球，该星球的状态变成“已被殖民”。\n2. 人类放弃了一个已被殖民的星球，该星球的状态变成“未被殖民”。\n\n每次进行时空旅行时，小 R 会先选定一个时空。在这个时空中，人类已经殖民了一些星球。小 R 只要到达该时空中任意一个已被殖民的星球，就能调查人类的发展状况。\n\n小 R 的时空旅行仪出现了一些问题，调整 $x$ 坐标的按钮坏掉了，因此到达点的 $x$ 坐标被固定了（每次旅行的 $x$ 坐标值可能不同）。与此同时，他仍能任意调整到达点的 $y$ 坐标和 $z$ 坐标。\n\n这个问题大大增大了小 R 的花费：因为时空旅行没有花费，但在太空中航行却需要花钱；同时，在不同星球进行调查也可能会产生不同的费用。\n\n假设小 R 将时空旅行的终点设为 $A$，他要进行调查的星球为 $B$：如果 $A$ 与 $B$ 的欧几里得距离为 $d$，那么他太空航行的花费就是 $d^2$；又如果星球 $B$上进行调查的费用为 $c$，那么小 R 此次调查的总花费就是 $d^2+c$。\n\n现在给定小 R 每次旅行到达的时空以及时空旅行仪上固定的 $x$ 坐标值，请你计算出小 R 每次旅行完成调查的最小总花费。", "inputFormat": "输入的第一行包含三个非负整数 $n,m,c_0$，$n$ 表示平行时空数量，这些平行时空的编号为 $0$ 到 $n-1$ 的整数，初始时空的编号为 $0$。$m$ 表示小 R 进行的时空旅行的次数，$c_0$ 表示在地球进行调查的花费。保证 $0< n,m \\leq 5 \\times 10^5, 0 \\leq c_0 \\leq 10^{12}$。\n\n接下来 $n-1$ 行，依次描述平行时空 $1$ 到 $n-1$，其中第 $i$ 行分两种情况：\n\n1. $0 \\ \\mathrm{fr} \\ \\mathrm{id} \\ x \\ y \\ z \\ c$：表示编号为 $i$ 的平行时空由编号为 $\\mathrm{fr}$ 的时空发展而来，人类殖民了一个编号为 $\\mathrm{id}$ 的星球，该星球的坐标为 $(x,y,z)$，在该星球进行调查的花费为 $c$。数据保证给出星球的编号不重复，且 $0< \\mathrm{id} < n$；保证 $|x|,|y|,|z| \\leq 10^6, 0 \\leq c \\leq 10^{12}$。\n2. $1 \\ \\mathrm{fr} \\ \\mathrm{id} $：表示编号为 $i$ 的平行时空由编号为 $\\mathrm{fr}$ 的时空发展而来，人类放弃了编号为 $\\mathrm{id}$ 的星球。数据保证该星球在编号为 $\\mathrm{fr}$ 的时空中处于被殖民的状态；保证 $\\mathrm{id} > 0$，即地球一定不会被放弃。\n\n上述两种情况中，各参数均为正数，相邻整数之间均用一个空格隔开；均保证 $0 \\leq \\mathrm{fr} < i$。保证不会出现上述两种之外的情况。\n\n接下来 $m$ 行，每行表示小 R 进行的一次时空旅行。每行包括两个正数 $s$ 和 $x_0$，表示小 R 到编号为 $s$ 的平行时空进行了一次时空旅行，时空旅行仪上的 $x$ 坐标被固定为了 $x_0$。保证 $0\\le s\\lt n$，$|x_0|\\le 10^6$。", "outputFormat": "输出 $m$ 行，分别表示每次旅行完成调查的最小总花费。", "hint": "对于前 $5\\%$ 的数据，$n,~m~\\leq~100$\n\n另有 $35\\%$ 的数据，$n,~m~\\leq~10^5$，其中有 $15\\%$ 的数据，人类不会放弃星球，另有 $10\\%$ 的数据，每次旅行的 $x$ 相同。\n\n对于剩下的数据，$n,~m~\\leq~5~\\times~10^5$，其中有 $10\\%$ 的数据，每次旅行的 $x$ 相同，$35\\%$ 的数据，时空 $i$ 由时空 $i - 1$ 发展而来。在这 $35\\%$ 的数据中有 $15\\%$ 的数据，人类不会放弃星球。\n\n由于文件压缩包过大无法上传，对于每一个子任务有且仅有一个测试点，为对应分值。", "locale": "zh-CN"}}}
{"pid": "P5417", "type": "P", "difficulty": 7, "samples": [["3 2\n2 2", "5"], ["10 5\n2 3 4 3 2\n", "1003811"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "O2优化", "CTSC/CTS"], "title": "[CTSC2016] 萨菲克斯·阿瑞", "background": "", "description": "小 P 来到了 NOIP2044 的赛场上，他发现第二题的题目是这样的：给你一个长度为 $n$ 的字符串，该字符串由至多 $m$ 种不同的字符组成，其中第 $i$ 种字符的出现次数不超过 $c_i$，问你这个字符串的后缀数组是什么。\n\n聪明的小 P 想到了一个新的问题希望你来帮忙解答：在题目给定的限制下，能有多少种不同的答案。也就是所有由 $m$ 种字符组成，其中第 $i$ 种字符出现次数不超过 $c_i$，且长度为 $n$ 的字符串，共有多少种不同的后缀数组。\n\n由于答案很大，你只用输出答案对 $10^9+7$ 取模后的数。\n\n对于一个字符串 $s=s_1s_2...s_n$，记 $\\mathrm{suf}(i)$ 表示 $i$ 这个位置到末尾的子串。后缀数组为一个 $1$ 到 $n$ 的排列 $p_1,p_2,...,p_n$，满足 $\\mathrm{suf}(p_1) <  \\mathrm{suf}(p_2) <  \\dots  <  \\mathrm{suf}(p_n)$。对于两个字符串 $s$ 和 $t$，令 $i$ 为第一个使得 $s_i \\neq t_i$ 的位置，那么我们 $s_i$ 和 $t_i$ 中小的对应的字符串更小，如果 $i$ 不存在，那么长度小的字符串更小。\n\n对于字符串之间的大小关系，我们规定第 $1$ 个字符最小，第 $2$ 个字符次小，以此类推。", "inputFormat": "输入的第一行包含两个正整数 $n,m$，表示字符串的长度为 $n$，共有 $m$ 种字符。\n\n接下来一行，包含 $m$ 个非负整数 $c_1,c_2,...,c_m$，表示每种字符最多的出现次数。保证 $0 \\leq c_1,c_2,...,c_m \\leq n,c_1+c_2+...+c_m \\geq n$。", "outputFormat": "输出共一行，包含一个正数，表示答案。", "hint": "### 样例一解释\n\n我们记 $a$ 为第一种字符，$b$ 为第二种字符，那么共有 $aab,aba,abb,baa,bab,bba$ 这六种可能的字符串。它们的后缀数组为\n\n$$(1,2,3),(3,1,2),(1,3,2),(3,2,1),(2,3,1),(3,2,1)$$\n\n所以共有 $5$ 种不同的结果。\n\n### 数据范围\n\n对于前 $5\\%$ 的测试点，$n, m \\leq 6$\n\n另有 $10\\%$ 的测试点，$n, m \\leq 10$\n\n另有 $20\\%$ 的测试点，$n, m \\leq 500$，其中有 $5\\%$ 的测试点 $m = 2$，$5\\%$ 的测试点 $m = 3$，$10\\%$ 的测试点 $c_1 = c_2 = \\cdots = c_m = n$\n\n另有 $15\\%$ 的测试点，$n,m\\leq 50$\n\n另有 $20\\%$ 的测试点，$n, m \\leq 200$\n\n另有 $30\\%$ 的测试点，$n, m \\leq 500$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2016] Suffix Array", "background": "", "description": "Xiao P came to the contest site of NOIP2044. He found that the second problem was like this: given a string of length $n$, formed by at most $m$ different characters, where the number of occurrences of the $i$-th character is at most $c_i$, ask what the suffix array of this string is.\n\nClever Xiao P thought of a new problem and hopes you can help solve it: under the constraints given in the problem, how many different answers can there be. That is, among all strings of length $n$ formed by $m$ characters, where the number of occurrences of the $i$-th character is at most $c_i$, how many different suffix arrays are there in total.\n\nSince the answer is very large, you only need to output the answer modulo $10^9+7$.\n\nFor a string $s=s_1s_2...s_n$, let $\\mathrm{suf}(i)$ denote the substring from position $i$ to the end. The suffix array is a permutation $p_1,p_2,...,p_n$ of $1$ to $n$, satisfying $\\mathrm{suf}(p_1) < \\mathrm{suf}(p_2) < \\dots < \\mathrm{suf}(p_n)$. For two strings $s$ and $t$, let $i$ be the first position such that $s_i \\neq t_i$. Then the string with the smaller one among $s_i$ and $t_i$ is smaller. If such $i$ does not exist, then the shorter string is smaller.\n\nFor the ordering between characters, we define that the $1$-st character is the smallest, the $2$-nd character is the next smallest, and so on.", "inputFormat": "The first line contains two positive integers $n,m$, meaning the length of the string is $n$, and there are $m$ kinds of characters.\n\nThe next line contains $m$ non-negative integers $c_1,c_2,...,c_m$, meaning the maximum number of occurrences of each character. It is guaranteed that $0 \\leq c_1,c_2,...,c_m \\leq n$ and $c_1+c_2+...+c_m \\geq n$.", "outputFormat": "Output one line containing a positive integer, representing the answer.", "hint": "### Explanation of Sample 1\n\nLet $a$ be the first kind of character and $b$ be the second kind of character. Then there are $6$ possible strings: $aab,aba,abb,baa,bab,bba$. Their suffix arrays are\n\n$$(1,2,3),(3,1,2),(1,3,2),(3,2,1),(2,3,1),(3,2,1)$$\n\nSo there are $5$ different results.\n\n### Constraints\n\nFor the first $5\\%$ of the test points, $n, m \\leq 6$.\n\nAnother $10\\%$ of the test points: $n, m \\leq 10$.\n\nAnother $20\\%$ of the test points: $n, m \\leq 500$. Among them, for $5\\%$ of the test points $m = 2$, for $5\\%$ of the test points $m = 3$, and for $10\\%$ of the test points $c_1 = c_2 = \\cdots = c_m = n$.\n\nAnother $15\\%$ of the test points: $n,m \\leq 50$.\n\nAnother $20\\%$ of the test points: $n, m \\leq 200$.\n\nAnother $30\\%$ of the test points: $n, m \\leq 500$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2016] 萨菲克斯·阿瑞", "background": "", "description": "小 P 来到了 NOIP2044 的赛场上，他发现第二题的题目是这样的：给你一个长度为 $n$ 的字符串，该字符串由至多 $m$ 种不同的字符组成，其中第 $i$ 种字符的出现次数不超过 $c_i$，问你这个字符串的后缀数组是什么。\n\n聪明的小 P 想到了一个新的问题希望你来帮忙解答：在题目给定的限制下，能有多少种不同的答案。也就是所有由 $m$ 种字符组成，其中第 $i$ 种字符出现次数不超过 $c_i$，且长度为 $n$ 的字符串，共有多少种不同的后缀数组。\n\n由于答案很大，你只用输出答案对 $10^9+7$ 取模后的数。\n\n对于一个字符串 $s=s_1s_2...s_n$，记 $\\mathrm{suf}(i)$ 表示 $i$ 这个位置到末尾的子串。后缀数组为一个 $1$ 到 $n$ 的排列 $p_1,p_2,...,p_n$，满足 $\\mathrm{suf}(p_1) <  \\mathrm{suf}(p_2) <  \\dots  <  \\mathrm{suf}(p_n)$。对于两个字符串 $s$ 和 $t$，令 $i$ 为第一个使得 $s_i \\neq t_i$ 的位置，那么我们 $s_i$ 和 $t_i$ 中小的对应的字符串更小，如果 $i$ 不存在，那么长度小的字符串更小。\n\n对于字符串之间的大小关系，我们规定第 $1$ 个字符最小，第 $2$ 个字符次小，以此类推。", "inputFormat": "输入的第一行包含两个正整数 $n,m$，表示字符串的长度为 $n$，共有 $m$ 种字符。\n\n接下来一行，包含 $m$ 个非负整数 $c_1,c_2,...,c_m$，表示每种字符最多的出现次数。保证 $0 \\leq c_1,c_2,...,c_m \\leq n,c_1+c_2+...+c_m \\geq n$。", "outputFormat": "输出共一行，包含一个正数，表示答案。", "hint": "### 样例一解释\n\n我们记 $a$ 为第一种字符，$b$ 为第二种字符，那么共有 $aab,aba,abb,baa,bab,bba$ 这六种可能的字符串。它们的后缀数组为\n\n$$(1,2,3),(3,1,2),(1,3,2),(3,2,1),(2,3,1),(3,2,1)$$\n\n所以共有 $5$ 种不同的结果。\n\n### 数据范围\n\n对于前 $5\\%$ 的测试点，$n, m \\leq 6$\n\n另有 $10\\%$ 的测试点，$n, m \\leq 10$\n\n另有 $20\\%$ 的测试点，$n, m \\leq 500$，其中有 $5\\%$ 的测试点 $m = 2$，$5\\%$ 的测试点 $m = 3$，$10\\%$ 的测试点 $c_1 = c_2 = \\cdots = c_m = n$\n\n另有 $15\\%$ 的测试点，$n,m\\leq 50$\n\n另有 $20\\%$ 的测试点，$n, m \\leq 200$\n\n另有 $30\\%$ 的测试点，$n, m \\leq 500$", "locale": "zh-CN"}}}
{"pid": "P5418", "type": "P", "difficulty": 0, "samples": [["3 4 2 10\n1 1 2\n1 2 2\n1 3 1\n2 3 3\n1 3 5\n1 3 3\n", "2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "提交答案", "O2优化", "CTSC/CTS"], "title": "[CTSC2016] NOIP十合一（数据疑似有误）", "background": "这是一道 **提交答案题**。", "description": "在 NOIP2044 的赛场上，小 D 遇到了这样一道题：\n\n给出一个 $n$ 个点的图，其中有 $m$ 条带边权的有向边，有 $q$ 个询问，每个询问形如从 $u$ 号点走到 $v$ 号点，长度为 $w$ 的道路数量有多少？你只需要输出答案对 $P$ 取模的结果即可。\n\n小 D 思考了良久也不会做这道题，悻悻离场后，他从官网上取得了这道题的数据，共有 $10$ 组数据。小 D 怎么也想做出来这道题，于是他开始寻求你的帮助，将 $10$ 组数据的输入给了你。聪明的你一定可以帮小 D 计算出每组数据的输出的！", "inputFormat": "输入文件 noip1.in~noip10.in 已经在下载文件中。\n\n每个输入文件的第一行包括 $4$ 个正整数 $n,m,q,P$，表示图中点数、边数、询问数目以及模数。点的编号为从 $1$ 到 $n$ 的整数。\n\n接下来 $m$ 行每行描述 $m$ 条带权有向边，其中第 $i$ 行包含 $3$ 个整数 $a_i,b_i,c_i$，表示第 $i$ 条边的起点为 $a_i$，终点为 $b_i$，权值为 $c_i$。\n\n接下来 $q$ 行描述询问，其中第 $k$ 行包含 $3$ 个整数 $u_k,v_k,w_k$，表示第 $k$ 个询问需要输出从 $u_k$ 号店走到 $v_k$ 号点，长度为 $w_k$ 的道路数量对 $P$ 取模的结果。", "outputFormat": "输出文件为 noip1.out~noip10.out，分别对应相应的输入文件。\n\n每个输出文件中不超过 $q$ 行，每行包含一个小于 $P$ 的非负整数，表示该测试点前 $q$ 个询问的答案。", "hint": "### 样例一解释：\n\n对于第一组询问，一共有两条从 $1$ 号点到 $3$ 号点、长度为 $5$ 的路径。假定边的编号从 $1$ 到 $4$，则这两条路径经过的边为：\n\n第 $1$ 条：$2 \\rightarrow 4$\n\n第 $2$ 条：$1 \\rightarrow 1 \\rightarrow 3$。\n\n### 有关其他样例\n\n在测试数据下载中提供了每个测试点对应的sampleout，分别对应每个测试点第一个询问的正确输出\n\n### 输入数据下载\n\n[下载链接](https://share.weiyun.com/5sk5wqh)\n\n### 评分办法\n\n暂无spj，按照 **传统题** 评分办法进行评测，只有你的答案与标准输出 **完全相同** 才能得到测试点的分数\n\n### 提示\n\n本题可能用到的知识：\n\n**特征多项式**：对于 $n \\times n$ 的矩阵 $A$，定义以 $\\lambda$ 为变量的 $n$ 次多项式 $f(\\lambda)=\\det(\\lambda I-A)$，其中 $I$ 是 $n$ 阶单位矩阵，$\\det$ 是行列式。称 $f(\\lambda)$ 为 $A$ 的特征多项式。\n\n**Cayley-Hamilton 定理**：对于方阵 $A$ 的特征多项式 $f(\\lambda)$，一定有 $f(A)=0$。即将矩阵本身作为变量带入特征多项式，结果为零矩阵。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2016] NOIP Ten-in-One (The testdata seems to be incorrect)", "background": "This is an output-only problem.", "description": "At the contest site of NOIP2044, Little D encountered the following problem:\n\nYou are given a graph with $n$ vertices, $m$ directed edges with weights, and $q$ queries. Each query asks: how many paths are there from vertex $u$ to vertex $v$ with total length $w$? You only need to output the answer modulo $P$.\n\nLittle D thought for a long time but still could not solve it. After leaving in disappointment, he obtained the testdata for this problem from the official website. There are $10$ test cases in total. Little D really wants to solve this problem, so he asks for your help and gives you the input of these $10$ test cases. You, being smart, can surely help Little D compute the output for each test case.", "inputFormat": "The input files noip1.in~noip10.in are already included in the download package.\n\nThe first line of each input file contains $4$ positive integers $n,m,q,P$, representing the number of vertices, the number of edges, the number of queries, and the modulus. The vertices are numbered as integers from $1$ to $n$.\n\nThe next $m$ lines describe the weighted directed edges. In the $i$-th line there are $3$ integers $a_i,b_i,c_i$, meaning the $i$-th edge starts at $a_i$, ends at $b_i$, and has weight $c_i$.\n\nThe next $q$ lines describe the queries. In the $k$-th line there are $3$ integers $u_k,v_k,w_k$, meaning the $k$-th query asks for the number of paths from vertex $u_k$ to vertex $v_k$ with total length $w_k$, modulo $P$.", "outputFormat": "The output files are noip1.out~noip10.out, corresponding to the respective input files.\n\nEach output file contains at most $q$ lines. Each line contains a non-negative integer less than $P$, representing the answers to the first $q$ queries of that test case.", "hint": "### Explanation for Sample 1:\n\nFor the first query, there are exactly two paths from vertex $1$ to vertex $3$ with length $5$. Assume the edges are numbered from $1$ to $4$. Then the edges passed by these two paths are:\n\nPath $1$: $2 \\rightarrow 4$\n\nPath $2$: $1 \\rightarrow 1 \\rightarrow 3$.\n\n### About the other samples\n\nThe download package provides sampleout for each test case, which corresponds to the correct output for the first query of each test case.\n\n### Input data download\n\n[Download link](https://share.weiyun.com/5sk5wqh)\n\n### Scoring\n\nThere is no special judge. The judging follows the **traditional problem** scoring method. You get points for a test case only if your output is **exactly the same** as the standard output.\n\n### Notes\n\nThis problem may use the following knowledge:\n\n**Characteristic polynomial**: For an $n \\times n$ matrix $A$, define an $n$-th degree polynomial in $\\lambda$ as $f(\\lambda)=\\det(\\lambda I-A)$, where $I$ is the $n \\times n$ identity matrix and $\\det$ is the determinant. We call $f(\\lambda)$ the characteristic polynomial of $A$.\n\n**Cayley-Hamilton theorem**: For the characteristic polynomial $f(\\lambda)$ of a square matrix $A$, we always have $f(A)=0$. That is, if we substitute the matrix itself into the characteristic polynomial, the result is the zero matrix.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2016] NOIP十合一（数据疑似有误）", "background": "这是一道 **提交答案题**。", "description": "在 NOIP2044 的赛场上，小 D 遇到了这样一道题：\n\n给出一个 $n$ 个点的图，其中有 $m$ 条带边权的有向边，有 $q$ 个询问，每个询问形如从 $u$ 号点走到 $v$ 号点，长度为 $w$ 的道路数量有多少？你只需要输出答案对 $P$ 取模的结果即可。\n\n小 D 思考了良久也不会做这道题，悻悻离场后，他从官网上取得了这道题的数据，共有 $10$ 组数据。小 D 怎么也想做出来这道题，于是他开始寻求你的帮助，将 $10$ 组数据的输入给了你。聪明的你一定可以帮小 D 计算出每组数据的输出的！", "inputFormat": "输入文件 noip1.in~noip10.in 已经在下载文件中。\n\n每个输入文件的第一行包括 $4$ 个正整数 $n,m,q,P$，表示图中点数、边数、询问数目以及模数。点的编号为从 $1$ 到 $n$ 的整数。\n\n接下来 $m$ 行每行描述 $m$ 条带权有向边，其中第 $i$ 行包含 $3$ 个整数 $a_i,b_i,c_i$，表示第 $i$ 条边的起点为 $a_i$，终点为 $b_i$，权值为 $c_i$。\n\n接下来 $q$ 行描述询问，其中第 $k$ 行包含 $3$ 个整数 $u_k,v_k,w_k$，表示第 $k$ 个询问需要输出从 $u_k$ 号店走到 $v_k$ 号点，长度为 $w_k$ 的道路数量对 $P$ 取模的结果。", "outputFormat": "输出文件为 noip1.out~noip10.out，分别对应相应的输入文件。\n\n每个输出文件中不超过 $q$ 行，每行包含一个小于 $P$ 的非负整数，表示该测试点前 $q$ 个询问的答案。", "hint": "### 样例一解释：\n\n对于第一组询问，一共有两条从 $1$ 号点到 $3$ 号点、长度为 $5$ 的路径。假定边的编号从 $1$ 到 $4$，则这两条路径经过的边为：\n\n第 $1$ 条：$2 \\rightarrow 4$\n\n第 $2$ 条：$1 \\rightarrow 1 \\rightarrow 3$。\n\n### 有关其他样例\n\n在测试数据下载中提供了每个测试点对应的sampleout，分别对应每个测试点第一个询问的正确输出\n\n### 输入数据下载\n\n[下载链接](https://share.weiyun.com/5sk5wqh)\n\n### 评分办法\n\n暂无spj，按照 **传统题** 评分办法进行评测，只有你的答案与标准输出 **完全相同** 才能得到测试点的分数\n\n### 提示\n\n本题可能用到的知识：\n\n**特征多项式**：对于 $n \\times n$ 的矩阵 $A$，定义以 $\\lambda$ 为变量的 $n$ 次多项式 $f(\\lambda)=\\det(\\lambda I-A)$，其中 $I$ 是 $n$ 阶单位矩阵，$\\det$ 是行列式。称 $f(\\lambda)$ 为 $A$ 的特征多项式。\n\n**Cayley-Hamilton 定理**：对于方阵 $A$ 的特征多项式 $f(\\lambda)$，一定有 $f(A)=0$。即将矩阵本身作为变量带入特征多项式，结果为零矩阵。", "locale": "zh-CN"}}}
{"pid": "P5419", "type": "P", "difficulty": 6, "samples": [["4", "4 6 2\n3 1\n5\n"], ["6\n", "12 8 15 3 5\n6 7 1 13\n10 14 11\n4 2\n9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "Special Judge", "CTSC/CTS"], "title": "[CTSC2016] 单调上升序列", "background": "", "description": "对于一个带权无向图，我们可以考察它的单调上升路径。\n\n一条路径被称为单调上升的，如果沿着它走时的权值是单调递增的。\n\n注意，路径由多条首尾相连的边组成，且可经过同一顶点多次。路径的长度为它包含的边数。\n\n举例来说：下图中 $v_2 \\rightarrow v_4 \\rightarrow v_1 \\rightarrow v_2$ 是一条单调上升路径，因为每条边的权值为 $1,2,4$。这条路径的长度为 $3$。更进一步的，你可以验证下图中所有的单调上升路径的长度都不超过 $3$。\n\n![例子](https://cdn.luogu.com.cn/upload/pic/59263.png)\n\n下面的结论指出在某些图中总会存在一个比较长的单调上升路径：\n\n结论：假设带权无向图 $G$ 有 $100$ 个节点 $1000$ 条边，且所有权值各不相同。那么，$G$ 中一定存在一个单调上升路径，它的长度大于等于 $20$。\n\n证明：假设每个节点上有一个探险家。我们按权值从小到大枚举所有的边，每次将该边连接的节点中的探险家的位置进行对调。可以知道，每个探险家都走的是一条单调上升路径。另外，由于共有 $100$ 个探险家，而探险家一共走了 $2000$ 步，所以有人走了 $20$ 步。证毕。\n\n现在，我们的问题是：\n\n给定一个完全图 $G$，它的顶点个数为一个偶数 $N$。\n\n你的任务是给每条边选一个不同的权值，要使得最长的单调上升路径最短。", "inputFormat": "输入仅一行一个正偶数 $N$。", "outputFormat": "输出整数 $1$ 到 $\\frac{N(N-1)}{2}$ 的一个排列，相邻的数之间用一个空格或换行隔开。\n\n第一个数代表你给边 $(1,2)$ 选的权值；第二个数是给 $(1,3)$ 的权值，……，第 $N$ 个数是给 $(1,N)$ 的权值；然后是 $(2,3)$ 的权值，$(2,4)$ 的权值，……，$(2,N)$ 的权值；然后是 $(3,4)$ 到 $(3,N)$ 的权值；以此类推；最后是 $(N-1,N)$ 的权值。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，满足 $N \\leq 20$;\n- 对于 $50\\%$ 的数据，满足 $N \\leq 100$;\n- 对于 $100\\%$ 的数据，满足 $2 \\leq N \\leq 500$。\n\n#### 说明\n除不同的测试点有不同特点外，每个测试点你也可能获得部分分。如果你的程序能正确结束并按输出格式输出，我们将用下列方式评分：\n\n假设你的图中最长单调上升路径的长度为 $A$，正确答案为 $B$。  \n- 如果 $A=B$，你的得分为 $10$ 分；\n- 如果 $B < A < 2B$，你的得分为 $3$ 分；\n- 如果 $A \\geq 2B$，你的得分为 $0$ 分。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2016] Monotonically Increasing Sequence", "background": "", "description": "For a weighted undirected graph, we can study its monotonically increasing paths.\n\nA path is called monotonically increasing if, when you traverse it, the edge weights are monotonically increasing.\n\nNote that a path consists of multiple edges connected end to end, and it may pass through the same vertex multiple times. The length of a path is the number of edges it contains.\n\nFor example, in the figure below, $v_2 \\rightarrow v_4 \\rightarrow v_1 \\rightarrow v_2$ is a monotonically increasing path, because the weights of its edges are $1,2,4$. The length of this path is $3$. Furthermore, you can verify that in the figure below, the length of every monotonically increasing path is at most $3$.\n\n![Example](https://cdn.luogu.com.cn/upload/pic/59263.png)\n\nThe following statement shows that in some graphs, there will always be a relatively long monotonically increasing path:\n\nStatement: Suppose a weighted undirected graph $G$ has $100$ vertices and $1000$ edges, and all edge weights are pairwise distinct. Then there must exist a monotonically increasing path in $G$ whose length is at least $20$.\n\nProof: Suppose there is an explorer on each vertex. We enumerate all edges in increasing order of weight, and each time we swap the positions of the explorers on the two endpoints of the current edge. It can be seen that each explorer walks along a monotonically increasing path. Also, since there are $100$ explorers and the explorers walk a total of $2000$ steps, someone must have walked $20$ steps. QED.\n\nNow, our problem is:\n\nYou are given a complete graph $G$ whose number of vertices is an even number $N$.\n\nYour task is to assign a distinct weight to each edge so that the length of the longest monotonically increasing path is as small as possible.", "inputFormat": "The input contains only one line with a positive even integer $N$.", "outputFormat": "Output a permutation of the integers $1$ to $\\frac{N(N-1)}{2}$, with adjacent numbers separated by a single space or a newline.\n\nThe first number represents the weight you assign to edge $(1,2)$; the second number is the weight for $(1,3)$; $\\ldots$; the $N$-th number is the weight for $(1,N)$. Then come the weights for $(2,3)$, $(2,4)$, $\\ldots$, $(2,N)$. Then the weights for $(3,4)$ to $(3,N)$, and so on. Finally, output the weight for $(N-1,N)$.", "hint": "#### Constraints and Notes\n\n- For $20\\%$ of the testdata, $N \\leq 20$.\n- For $50\\%$ of the testdata, $N \\leq 100$.\n- For $100\\%$ of the testdata, $2 \\leq N \\leq 500$.\n\n#### Notes\n\nBesides different subtasks having different characteristics, you may also receive partial credit on each test. If your program can terminate correctly and output in the required format, we will score it as follows:\n\nSuppose the length of the longest monotonically increasing path in your graph is $A$, and the correct answer is $B$.  \n- If $A=B$, your score is $10$ points.\n- If $B < A < 2B$, your score is $3$ points.\n- If $A \\geq 2B$, your score is $0$ points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2016] 单调上升序列", "background": "", "description": "对于一个带权无向图，我们可以考察它的单调上升路径。\n\n一条路径被称为单调上升的，如果沿着它走时的权值是单调递增的。\n\n注意，路径由多条首尾相连的边组成，且可经过同一顶点多次。路径的长度为它包含的边数。\n\n举例来说：下图中 $v_2 \\rightarrow v_4 \\rightarrow v_1 \\rightarrow v_2$ 是一条单调上升路径，因为每条边的权值为 $1,2,4$。这条路径的长度为 $3$。更进一步的，你可以验证下图中所有的单调上升路径的长度都不超过 $3$。\n\n![例子](https://cdn.luogu.com.cn/upload/pic/59263.png)\n\n下面的结论指出在某些图中总会存在一个比较长的单调上升路径：\n\n结论：假设带权无向图 $G$ 有 $100$ 个节点 $1000$ 条边，且所有权值各不相同。那么，$G$ 中一定存在一个单调上升路径，它的长度大于等于 $20$。\n\n证明：假设每个节点上有一个探险家。我们按权值从小到大枚举所有的边，每次将该边连接的节点中的探险家的位置进行对调。可以知道，每个探险家都走的是一条单调上升路径。另外，由于共有 $100$ 个探险家，而探险家一共走了 $2000$ 步，所以有人走了 $20$ 步。证毕。\n\n现在，我们的问题是：\n\n给定一个完全图 $G$，它的顶点个数为一个偶数 $N$。\n\n你的任务是给每条边选一个不同的权值，要使得最长的单调上升路径最短。", "inputFormat": "输入仅一行一个正偶数 $N$。", "outputFormat": "输出整数 $1$ 到 $\\frac{N(N-1)}{2}$ 的一个排列，相邻的数之间用一个空格或换行隔开。\n\n第一个数代表你给边 $(1,2)$ 选的权值；第二个数是给 $(1,3)$ 的权值，……，第 $N$ 个数是给 $(1,N)$ 的权值；然后是 $(2,3)$ 的权值，$(2,4)$ 的权值，……，$(2,N)$ 的权值；然后是 $(3,4)$ 到 $(3,N)$ 的权值；以此类推；最后是 $(N-1,N)$ 的权值。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，满足 $N \\leq 20$;\n- 对于 $50\\%$ 的数据，满足 $N \\leq 100$;\n- 对于 $100\\%$ 的数据，满足 $2 \\leq N \\leq 500$。\n\n#### 说明\n除不同的测试点有不同特点外，每个测试点你也可能获得部分分。如果你的程序能正确结束并按输出格式输出，我们将用下列方式评分：\n\n假设你的图中最长单调上升路径的长度为 $A$，正确答案为 $B$。  \n- 如果 $A=B$，你的得分为 $10$ 分；\n- 如果 $B < A < 2B$，你的得分为 $3$ 分；\n- 如果 $A \\geq 2B$，你的得分为 $0$ 分。", "locale": "zh-CN"}}}
{"pid": "P5420", "type": "P", "difficulty": 7, "samples": [["3 10\na", "aaj"], ["3 10\nxy", "yzz"], ["1 100\na", "-1"], ["25 1000000000000000\nu", "uuuuuvxzuxvwwyzzuyzvxuvxw"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "O2优化", "CTSC/CTS"], "title": "[CTSC2016] 香山的树", "background": "", "description": "众所周知，香山的红叶非常著名。然而，CTSC 举行的时间是在 5 月，而红叶的季节是秋天，所以这个季节是看不到红叶的，于是我们在 CTSC 比赛中就只能讨论香山的树了。\n\ns-quark 很喜欢这些树，他计划在每棵树上贴一个各不相同的标签。每个标签为条形，可以在树干上绕成一圈。为了区分每一棵树，s-quark 在每个标签上印了一个由小写英文字母组成的字符串。由于树干周长的限制，标签的长度也是有限的，因此这个字符串至多只能由N个字母组成。\n\n但是，由于标签是在树干上围成一圈的，所以当标签在树上贴好以后，就不再能找到标签的起始位置了。所以，如果两棵树上的标签循环同构，例如分别为 \" abc \" 和 \" cab \" ，那么这两棵树就不再能通过标签区分了。针对这个问题，s-quark 想了一个巧妙的办法。对于一个已经在树上贴好的标签，s-quark 规定它的起始位置必须是能够使得字符串的字典序最小的起始位，即如果看到的字符串是 \" aba \"，那么就可以推断出从正确的起始位置开始看到的字符串应为 \" aab \"。\n\n另外，对于有些标签，例如 \" abab \"，尽管符合字典序最小的规则，但是这样的起始位置不唯一，s-quark 认为这种情况也是不理想的。所以，这样的标签 s-quark 也会避免使用。s-quark 已经把所有的树都编好了顺序，准备在第一棵树上贴标签 \" a \"，之后按照字典序给每棵树贴上不同的标签。\n\n以 $n=3$ 为例，s-quark将依次使用这些标签来标记这些树木： $a ,~aab ,~  aac , ~\\dots~, ~ aaz ,  ~ab , ~ abb , ~\\dots~, ~ abz , ~ ac , \\dots~$\n\ns-quark 知道，香山上的树总共有 $K$ 棵。他想知道他将在最后一棵树上贴的标签是什么。但是，这个问题显然太简单了。现在，s-quark 要问你，如果他在第一棵树上贴的标签是字符串 $S$，那么他将在最后一棵树上贴的标签是什么呢？", "inputFormat": "输入的第一行两个正整数 $N$ 和 $K$，分别为字符串的长度和树的总数。\n\n第二行一个由小写英文字母组成的字符串 $S$，表示在第一棵树上所贴的标签。$S$ 的长度不超过 $N$，并且保证是一个合法的标签。", "outputFormat": "输出仅一行，输出一个字符串 $T$，表示 s-quark 将在最后一棵树上贴的标签，或输出 $-1$，表示剩余的合法标签数量不足以贴完所有的树。", "hint": "对于前 $10\\%$ 的数据，$n = 8,~K~\\leq~10^4,~S = \"a\"$\n\n另有 $10\\%$ 的数据， $n = 9,~K~\\leq~10^6$\n\n对于剩下 $70\\%$ 的数据：\n\n有 $30\\%$ 的数据， $n$ 分别为 $8,~9~10$，均匀分布在这 $30\\%$ 的数据中\n\n另有 $20\\%$ 的数据，$n~\\leq~30$\n\n对于 $100\\%$ 的数据，$n~\\leq~50,~K~\\leq~10^{15}$\n", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2016] Trees of Xiangshan", "background": "", "description": "As everyone knows, Xiangshan is famous for its red leaves. However, CTSC is held in May, while the season for red leaves is autumn, so you cannot see red leaves at this time. Therefore, in the CTSC contest we can only talk about the trees of Xiangshan.\n\ns-quark likes these trees very much, and he plans to put a distinct label on each tree. Each label is a strip that can be wrapped around the trunk into a circle. To tell every tree apart, s-quark prints on each label a string made of lowercase English letters. Due to the limit of the trunk circumference, the label length is also limited, so the string can contain at most $N$ letters.\n\nHowever, since the label is wrapped into a circle around the trunk, after the label is attached, you can no longer find the starting position of the label. So, if the labels on two trees are cyclically isomorphic, for example \"abc\" and \"cab\", then these two trees can no longer be distinguished by their labels. To solve this, s-quark came up with a clever method. For a label that has already been attached to a tree, s-quark requires that its starting position must be the one that makes the string lexicographically smallest. That is, if the string you see is \"aba\", then you can infer that the string starting from the correct position should be \"aab\".\n\nIn addition, for some labels such as \"abab\", although they satisfy the lexicographically smallest rule, such a starting position is not unique, and s-quark thinks this is also undesirable. Therefore, s-quark will also avoid using such labels. s-quark has already ordered all the trees and plans to put the label \"a\" on the first tree, and then attach different labels to each tree in lexicographical order.\n\nTake $n = 3$ as an example, s-quark will use the following labels in order to mark these trees: $a ,~aab ,~  aac , ~\\dots~, ~ aaz ,  ~ab , ~ abb , ~\\dots~, ~ abz , ~ ac , \\dots~$.\n\ns-quark knows that there are $K$ trees in Xiangshan in total. He wants to know what label he will put on the last tree. But this problem is obviously too simple. Now, s-quark asks you: if the label on the first tree is the string $S$, then what label will he put on the last tree?", "inputFormat": "The first line contains two positive integers $N$ and $K$, which are the maximum string length and the total number of trees.\n\nThe second line contains a string $S$ consisting of lowercase English letters, representing the label attached to the first tree. The length of $S$ does not exceed $N$, and it is guaranteed to be a valid label.", "outputFormat": "Output only one line. Output a string $T$, representing the label that s-quark will attach to the last tree, or output $-1$ to indicate that the number of remaining valid labels is not enough to label all trees.", "hint": "For the first $10\\%$ of the testdata, $n = 8,~K~\\leq~10^4,~S = \"a\"$.\n\nAnother $10\\%$ of the testdata has $n = 9,~K~\\leq~10^6$.\n\nFor the remaining $70\\%$ of the testdata:\n\n$30\\%$ of the testdata has $n$ equal to $8,~9~10$, uniformly distributed within this $30\\%$ of the testdata.\n\nAnother $20\\%$ of the testdata has $n~\\leq~30$.\n\nFor $100\\%$ of the testdata, $n~\\leq~50,~K~\\leq~10^{15}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2016] 香山的树", "background": "", "description": "众所周知，香山的红叶非常著名。然而，CTSC 举行的时间是在 5 月，而红叶的季节是秋天，所以这个季节是看不到红叶的，于是我们在 CTSC 比赛中就只能讨论香山的树了。\n\ns-quark 很喜欢这些树，他计划在每棵树上贴一个各不相同的标签。每个标签为条形，可以在树干上绕成一圈。为了区分每一棵树，s-quark 在每个标签上印了一个由小写英文字母组成的字符串。由于树干周长的限制，标签的长度也是有限的，因此这个字符串至多只能由N个字母组成。\n\n但是，由于标签是在树干上围成一圈的，所以当标签在树上贴好以后，就不再能找到标签的起始位置了。所以，如果两棵树上的标签循环同构，例如分别为 \" abc \" 和 \" cab \" ，那么这两棵树就不再能通过标签区分了。针对这个问题，s-quark 想了一个巧妙的办法。对于一个已经在树上贴好的标签，s-quark 规定它的起始位置必须是能够使得字符串的字典序最小的起始位，即如果看到的字符串是 \" aba \"，那么就可以推断出从正确的起始位置开始看到的字符串应为 \" aab \"。\n\n另外，对于有些标签，例如 \" abab \"，尽管符合字典序最小的规则，但是这样的起始位置不唯一，s-quark 认为这种情况也是不理想的。所以，这样的标签 s-quark 也会避免使用。s-quark 已经把所有的树都编好了顺序，准备在第一棵树上贴标签 \" a \"，之后按照字典序给每棵树贴上不同的标签。\n\n以 $n=3$ 为例，s-quark将依次使用这些标签来标记这些树木： $a ,~aab ,~  aac , ~\\dots~, ~ aaz ,  ~ab , ~ abb , ~\\dots~, ~ abz , ~ ac , \\dots~$\n\ns-quark 知道，香山上的树总共有 $K$ 棵。他想知道他将在最后一棵树上贴的标签是什么。但是，这个问题显然太简单了。现在，s-quark 要问你，如果他在第一棵树上贴的标签是字符串 $S$，那么他将在最后一棵树上贴的标签是什么呢？", "inputFormat": "输入的第一行两个正整数 $N$ 和 $K$，分别为字符串的长度和树的总数。\n\n第二行一个由小写英文字母组成的字符串 $S$，表示在第一棵树上所贴的标签。$S$ 的长度不超过 $N$，并且保证是一个合法的标签。", "outputFormat": "输出仅一行，输出一个字符串 $T$，表示 s-quark 将在最后一棵树上贴的标签，或输出 $-1$，表示剩余的合法标签数量不足以贴完所有的树。", "hint": "对于前 $10\\%$ 的数据，$n = 8,~K~\\leq~10^4,~S = \"a\"$\n\n另有 $10\\%$ 的数据， $n = 9,~K~\\leq~10^6$\n\n对于剩下 $70\\%$ 的数据：\n\n有 $30\\%$ 的数据， $n$ 分别为 $8,~9~10$，均匀分布在这 $30\\%$ 的数据中\n\n另有 $20\\%$ 的数据，$n~\\leq~30$\n\n对于 $100\\%$ 的数据，$n~\\leq~50,~K~\\leq~10^{15}$\n", "locale": "zh-CN"}}}
{"pid": "P5421", "type": "P", "difficulty": 0, "samples": [["4 4 2 1 4\n1 3 3\n1 2\n1 2 5\n0\n2 3 -2\n1 1 \n3 4 1\n0", "2 1 4\n3 2 3 4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "提交答案", "Special Judge", "O2优化", "CTSC/CTS"], "title": "[CTSC2016] 科学考察队", "background": "这是一道 **提交答案题**", "description": "今年正是五四青年节。在这样的大好日子里，青年探险家牛牛带着他的科学考察队去考察一片原始森林。\n\n在考察开始前，牛牛获得了这片原始森林的地图。这片森林里有 $n$ 个集结点，编号为 $1$ 到 $n$ 的整数。在这些集结点之间，存在 $m$ 条路径，编号为 $1$ 到 $m$ 的整数。每条路径以一个集合点为起点，一个集结点为终点。\n\n为了提高科学考察的效率，牛牛将他带领的考察队分为了 $p$ 个小队，每个小队都能够独立地完成一些工作。他们约定从编号为 $S$ 的集结点出发，最终在编号为 $T$ 的集结点汇合。在考察的过程中，会遇到重重困难，比如科考队员可以从悬崖的顶端缓缓下降到悬崖底部，却不能从悬崖底部直接攀爬到悬崖顶上，因此输入的路径都是单向的。\n\n当一个小队沿着一条路径前进后，这个小队将会记录路径上的各种信息和数据。然而有的路径需要考察队自行开辟，开辟一条路径需要耗费一定的材料，将产生一些费用。由于装备数量有限，牛牛给各小队分配的装备也可能会不同，因此，有些条件困难的路径上，有些小队会因为装备不足而无法通过。但是，牛牛通过合理地分配装备，确保了每一支小队都能顺利到达编号为 $T$ 的集结点。\n\n在他们都到达 $T$ 点汇合后，牛牛将会汇总所有的信息与数据，这些信息与数据的总价值即为这次科学考察行动的总收益。其中，如果有多支小队通过了同一条路径，由于他们记录到的关于这条路径的数据是重复的，因此价值只会计算一次。而开辟路径所花费的费用即为这次科学考察的总支出，同样，即使有多支考察队经过同一条需要开辟的路径，这条路径也只需要开辟一次。\n\n现在，牛牛希望为他的 $p$ 个小队设计出合理的行动路径，使得总收益减去总支出的值最大。", "inputFormat": "输入文件 expedition1.in~expedition10.in 已在试题目录下。\n\n对于每组输入数据：\n\n第一行 $5$ 个整数，依次为 $n,m,p,S,T$，意义如题所述。\n\n接下来 $2m$ 行，每两行描述一条路径。\n\n每条路径的第一行三个整数 $u,v,w$，表示这条路径起点为 $u$，终点为 $v$。若 $w~<~0$，则表示这条路径上的数据价值为 $w$，且不需要开辟。若 $w \\leq 0$，则表示这条路径上数据价值为 $0$，且开辟的花费为 $-w$。\n\n每条路径的第二行第一个整数 $k$，表示不能通过这条路径的小队数量。接下来 $k$ 个互不相同的整数，表示这 $k$ 个小队的编号。", "outputFormat": "输入文件 expedition1.out~expedition10.out 已在试题目录下。\n\n对于每组输入数据，你需要依次输出 $p$ 行。第 $i$ 行表示第 $i$ 个小队的行动顺序。\n\n每行第一个数 $k$，表示这个小队总共走过了多少条路径。接下来 $k$ 个数，表示这个小队从 $S$ 前往 $T$ 的过程中依次走过的路径编号。", "hint": "### 样例一解释\n\n地图上有 $4$ 个集结点与 $4$ 条路径，其中第 $1$ 支小队能通过的路径有 $1、2、4$，第二支小队能通过的路径有 $2、3、4$。最终 $1$ 小队依次通过 $1、4$ 路径，$2$ 小队依次通过 $2、3、4$ 路径。获取的总收益为 $3+5+1=9$。总支出为 $2$。总收入减总支出的值为 $9-2=7$。\n\n### 评分方法\n\n每个测试点单独评分。每个测试点你还可能获得部分分。\n\n对于每个测试点，我们设置了 $10$ 个评分参数 $a_1,a_2,a_3,…,a_9,a_{10}$。如果选手的输出不合法，则得零分。否则，在你的方案中，若考察总收益为 $w_{user}$，且存在一个最大的 $i$, 使得 $w_{user}~\\geq~a_{i}$，则你获得 $i$ 分。\n\n所有评分参数文件 expedition1.ans~expedition10.ans 已在试题目录下。\n每个评分参数文件共 $10$ 行。其中第 $i$ 行一个非负整数，表示 $a_i$。\n\n### 输入数据下载\n\n[下载链接](https://share.weiyun.com/52vCCzr)", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2016] Scientific Expedition Team", "background": "This is an **output-only problem**.", "description": "This year happens to be Youth Day on May 4th. On such a great day, the young explorer Niuniu leads his scientific expedition team to explore a primeval forest.\n\nBefore the expedition starts, Niuniu obtains a map of the forest. There are $n$ gathering points in the forest, numbered from $1$ to $n$. Between these gathering points, there are $m$ paths, numbered from $1$ to $m$. Each path starts at one gathering point and ends at another gathering point.\n\nTo improve the expedition efficiency, Niuniu divides his team into $p$ squads, and each squad can independently complete some tasks. They agree to start from the gathering point numbered $S$ and finally meet at the gathering point numbered $T$. During the expedition, they will face many difficulties. For example, team members can slowly descend from the top of a cliff to the bottom, but cannot climb directly from the bottom to the top. Therefore, all paths in the input are one-way.\n\nWhen a squad moves along a path, it records various information and testdata on that path. However, some paths need to be opened up by the expedition team themselves. Opening a path consumes certain materials and produces some cost. Due to limited equipment, the equipment assigned to each squad may be different, so on some difficult paths, some squads may be unable to pass because they lack enough equipment. However, by allocating equipment reasonably, Niuniu ensures that every squad can successfully reach the gathering point numbered $T$.\n\nAfter all squads arrive at point $T$ and meet, Niuniu will aggregate all information and testdata. The total value of this information and testdata is the total revenue of this scientific expedition. If multiple squads pass through the same path, since the data they record about this path is duplicated, its value is counted only once. The cost spent on opening paths is the total expenditure of this expedition. Similarly, even if multiple squads pass through the same path that needs to be opened, this path only needs to be opened once.\n\nNow, Niuniu hopes to design reasonable action routes for his $p$ squads so that the value of total revenue minus total expenditure is maximized.", "inputFormat": "The input files expedition1.in~expedition10.in are provided in the problem directory.\n\nFor each input dataset:\n\nThe first line contains $5$ integers $n, m, p, S, T$, with meanings as described above.\n\nThe next $2m$ lines describe the paths, with every two lines describing one path.\n\nOn the first line of each path, there are three integers $u, v, w$, indicating that the path starts at $u$ and ends at $v$. If $w < 0$, it means the data value on this path is $w$, and it does not need to be opened. If $w \\leq 0$, it means the data value on this path is $0$, and the cost to open it is $-w$.\n\nOn the second line of each path, the first integer is $k$, indicating the number of squads that cannot pass this path. Then follow $k$ distinct integers, indicating the indices of these $k$ squads.", "outputFormat": "The output files expedition1.out~expedition10.out are provided in the problem directory.\n\nFor each input dataset, you need to output $p$ lines in order. The $i$-th line describes the action sequence of squad $i$.\n\nThe first number on each line is $k$, indicating how many paths this squad has traveled in total. Then follow $k$ numbers, indicating the indices of the paths this squad travels through in order when going from $S$ to $T$.", "hint": "### Explanation for Sample 1\n\nThere are $4$ gathering points and $4$ paths on the map. The paths that squad $1$ can pass are $1, 2, 4$, and the paths that squad $2$ can pass are $2, 3, 4$. In the end, squad $1$ passes paths $1, 4$ in order, and squad $2$ passes paths $2, 3, 4$ in order. The total revenue obtained is $3 + 5 + 1 = 9$. The total expenditure is $2$. The value of total revenue minus total expenditure is $9 - 2 = 7$.\n\n### Scoring\n\nEach test point is scored independently. For each test point, you may also receive partial credit.\n\nFor each test point, we provide $10$ scoring parameters $a_1, a_2, a_3, \\dots, a_9, a_{10}$. If your output is invalid, you get $0$ points. Otherwise, in your solution, if the expedition’s total revenue is $w_{user}$, and there exists a largest $i$ such that $w_{user} \\geq a_{i}$, then you get $i$ points.\n\nAll scoring parameter files expedition1.ans~expedition10.ans are provided in the problem directory. Each scoring parameter file has $10$ lines. On the $i$-th line there is a non-negative integer indicating $a_i$.\n\n### Input Data Download\n\n[Download link](https://share.weiyun.com/52vCCzr)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2016] 科学考察队", "background": "这是一道 **提交答案题**", "description": "今年正是五四青年节。在这样的大好日子里，青年探险家牛牛带着他的科学考察队去考察一片原始森林。\n\n在考察开始前，牛牛获得了这片原始森林的地图。这片森林里有 $n$ 个集结点，编号为 $1$ 到 $n$ 的整数。在这些集结点之间，存在 $m$ 条路径，编号为 $1$ 到 $m$ 的整数。每条路径以一个集合点为起点，一个集结点为终点。\n\n为了提高科学考察的效率，牛牛将他带领的考察队分为了 $p$ 个小队，每个小队都能够独立地完成一些工作。他们约定从编号为 $S$ 的集结点出发，最终在编号为 $T$ 的集结点汇合。在考察的过程中，会遇到重重困难，比如科考队员可以从悬崖的顶端缓缓下降到悬崖底部，却不能从悬崖底部直接攀爬到悬崖顶上，因此输入的路径都是单向的。\n\n当一个小队沿着一条路径前进后，这个小队将会记录路径上的各种信息和数据。然而有的路径需要考察队自行开辟，开辟一条路径需要耗费一定的材料，将产生一些费用。由于装备数量有限，牛牛给各小队分配的装备也可能会不同，因此，有些条件困难的路径上，有些小队会因为装备不足而无法通过。但是，牛牛通过合理地分配装备，确保了每一支小队都能顺利到达编号为 $T$ 的集结点。\n\n在他们都到达 $T$ 点汇合后，牛牛将会汇总所有的信息与数据，这些信息与数据的总价值即为这次科学考察行动的总收益。其中，如果有多支小队通过了同一条路径，由于他们记录到的关于这条路径的数据是重复的，因此价值只会计算一次。而开辟路径所花费的费用即为这次科学考察的总支出，同样，即使有多支考察队经过同一条需要开辟的路径，这条路径也只需要开辟一次。\n\n现在，牛牛希望为他的 $p$ 个小队设计出合理的行动路径，使得总收益减去总支出的值最大。", "inputFormat": "输入文件 expedition1.in~expedition10.in 已在试题目录下。\n\n对于每组输入数据：\n\n第一行 $5$ 个整数，依次为 $n,m,p,S,T$，意义如题所述。\n\n接下来 $2m$ 行，每两行描述一条路径。\n\n每条路径的第一行三个整数 $u,v,w$，表示这条路径起点为 $u$，终点为 $v$。若 $w~<~0$，则表示这条路径上的数据价值为 $w$，且不需要开辟。若 $w \\leq 0$，则表示这条路径上数据价值为 $0$，且开辟的花费为 $-w$。\n\n每条路径的第二行第一个整数 $k$，表示不能通过这条路径的小队数量。接下来 $k$ 个互不相同的整数，表示这 $k$ 个小队的编号。", "outputFormat": "输入文件 expedition1.out~expedition10.out 已在试题目录下。\n\n对于每组输入数据，你需要依次输出 $p$ 行。第 $i$ 行表示第 $i$ 个小队的行动顺序。\n\n每行第一个数 $k$，表示这个小队总共走过了多少条路径。接下来 $k$ 个数，表示这个小队从 $S$ 前往 $T$ 的过程中依次走过的路径编号。", "hint": "### 样例一解释\n\n地图上有 $4$ 个集结点与 $4$ 条路径，其中第 $1$ 支小队能通过的路径有 $1、2、4$，第二支小队能通过的路径有 $2、3、4$。最终 $1$ 小队依次通过 $1、4$ 路径，$2$ 小队依次通过 $2、3、4$ 路径。获取的总收益为 $3+5+1=9$。总支出为 $2$。总收入减总支出的值为 $9-2=7$。\n\n### 评分方法\n\n每个测试点单独评分。每个测试点你还可能获得部分分。\n\n对于每个测试点，我们设置了 $10$ 个评分参数 $a_1,a_2,a_3,…,a_9,a_{10}$。如果选手的输出不合法，则得零分。否则，在你的方案中，若考察总收益为 $w_{user}$，且存在一个最大的 $i$, 使得 $w_{user}~\\geq~a_{i}$，则你获得 $i$ 分。\n\n所有评分参数文件 expedition1.ans~expedition10.ans 已在试题目录下。\n每个评分参数文件共 $10$ 行。其中第 $i$ 行一个非负整数，表示 $a_i$。\n\n### 输入数据下载\n\n[下载链接](https://share.weiyun.com/52vCCzr)", "locale": "zh-CN"}}}
{"pid": "P5422", "type": "P", "difficulty": 7, "samples": [["4 3\n1 1\n5 6\n7 8\n1 1\n1 1 1\n2 3 4\n1 1 1", "10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "USACO", "轮廓线 DP"], "title": "[USACO19OPEN] Compound Escape P", "background": "", "description": "Bessie和她的朋友们被抓走并关在了远离农场的一个秘密房屋，现在该是Bessie站出来策划脱逃的时候了！这一房屋包含 $ NK $ 个排列成 $ N \\times K $ 矩形方阵的囚室，水平和垂直方向相邻的囚室之间有门互通。每个囚室中有一头奶牛。\n\nBessie黑进了系统，可以解锁任意一部分的门，但是每个门均有其代价。为了使奶牛们能够脱逃，Bessie必须打开足够多的门使得所有的奶牛可以聚集在一个房间内（这样她们就能拥有足够的力量挖地洞通向外面！）。Bessie想要使得总的解锁花费最小。\n\n但是这次行动异常关键，Bessie不能满足于仅仅一个脱逃方案：她还需要后备方案。帮助她计算最小代价脱逃方案的数量；如果某一扇门在一个方案中被解锁了而在另一个方案中没有，那么这两个方案就被认为是不同的。\n\n由于这个数字可能非常大，只需输出该数对 $ 10^9+7 $ 取模后的结果。", "inputFormat": "输入的第一行包含两个空格分隔的整数 $ N $ 和 $ K $ （ $ 2 \\leq N \\leq 30000 ,2 \\leq K \\leq 6 $ ）。\n\n以下 $ N $ 行每行包含 $ K-1 $ 个空格分隔的整数，为解锁一条水平边上的每扇门需要花费的代价。\n\n以下 $ K $ 行每行包含 $ N-1 $ 个空格分隔的整数，为解锁一条垂直边上的每扇门需要花费的代价。\n\n所有的花费均在 $ 1 $ 到 $ 10^9 $ 之间。", "outputFormat": "一个整数：最小花费的逃脱方案的数量，对 $ 10^9+7 $ 取模。", "hint": "这个测试样例描述了一个4x3的方阵，\n\n```\n     1     1\n  +-----+-----+\n  |     |     |\n1 |     |2    | 1\n  |  5  |  6  |\n  +-----+-----+\n  |     |     |\n1 |     |3    | 1\n  |  7  |  8  |\n  +-----+-----+\n  |     |     |\n1 |     |4    | 1\n  |     |     |\n  +-----+-----+\n     1    1\n```\n\n所有的最小代价脱逃方案都会使用代价为2的门，代价为3的门，以及某九个代价为1的门。由于有十种方式选择不被使用的代价为1的门，所以答案为10。\n\n### 子任务\n\n对于20%的测试数据，保证 $ N \\leq 500 $ ，所有的代价均在 $ 1 $ 到 $ 5 $ 之间。\n\n对于另外20%的测试数据，保证 $ N \\leq 5000 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] Compound Escape P", "background": "", "description": "Bessie and her friends have been captured and locked in a secret house far away from the farm, and now it is time for Bessie to step up and plan an escape. This house contains $ NK $ prison cells arranged in an $ N \\times K $ rectangular grid. There are doors connecting every pair of horizontally and vertically adjacent cells. Each cell contains one cow.\n\nBessie has hacked into the system and can unlock any subset of the doors, but each door has a cost. To allow the cows to escape, Bessie must open enough doors so that all cows can gather in a single room (so they will have enough strength to dig a tunnel to the outside). Bessie wants to minimize the total unlocking cost.\n\nHowever, this mission is extremely important, so Bessie cannot be satisfied with only one escape plan: she also needs backup plans. Help her compute the number of minimum-cost escape plans. If a door is unlocked in one plan but not unlocked in another, then the two plans are considered different.\n\nSince this number can be very large, output it modulo $ 10^9+7 $.", "inputFormat": "The first line contains two space-separated integers $ N $ and $ K $ ( $ 2 \\leq N \\leq 30000 $, $ 2 \\leq K \\leq 6 $ ).\n\nThe next $ N $ lines each contain $ K-1 $ space-separated integers, giving the cost to unlock each door on a horizontal edge.\n\nThe next $ K $ lines each contain $ N-1 $ space-separated integers, giving the cost to unlock each door on a vertical edge.\n\nAll costs are between $ 1 $ and $ 10^9 $.", "outputFormat": "One integer: the number of minimum-cost escape plans, modulo $ 10^9+7 $.", "hint": "This sample describes a $ 4 \\times 3 $ grid.\n\n```\n     1     1\n  +-----+-----+\n  |     |     |\n1 |     |2    | 1\n  |  5  |  6  |\n  +-----+-----+\n  |     |     |\n1 |     |3    | 1\n  |  7  |  8  |\n  +-----+-----+\n  |     |     |\n1 |     |4    | 1\n  |     |     |\n  +-----+-----+\n     1    1\n```\n\nAll minimum-cost escape plans will use the door with cost $ 2 $, the door with cost $ 3 $, and nine doors with cost $ 1 $. Since there are $ 10 $ ways to choose which cost $ 1 $ door is not used, the answer is $ 10 $.\n\n### Subtasks\n\nFor $ 20\\% $ of the testdata, it is guaranteed that $ N \\leq 500 $, and all costs are between $ 1 $ and $ 5 $.\n\nFor another $ 20\\% $ of the testdata, it is guaranteed that $ N \\leq 5000 $.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] Compound Escape P", "background": "", "description": "Bessie和她的朋友们被抓走并关在了远离农场的一个秘密房屋，现在该是Bessie站出来策划脱逃的时候了！这一房屋包含 $ NK $ 个排列成 $ N \\times K $ 矩形方阵的囚室，水平和垂直方向相邻的囚室之间有门互通。每个囚室中有一头奶牛。\n\nBessie黑进了系统，可以解锁任意一部分的门，但是每个门均有其代价。为了使奶牛们能够脱逃，Bessie必须打开足够多的门使得所有的奶牛可以聚集在一个房间内（这样她们就能拥有足够的力量挖地洞通向外面！）。Bessie想要使得总的解锁花费最小。\n\n但是这次行动异常关键，Bessie不能满足于仅仅一个脱逃方案：她还需要后备方案。帮助她计算最小代价脱逃方案的数量；如果某一扇门在一个方案中被解锁了而在另一个方案中没有，那么这两个方案就被认为是不同的。\n\n由于这个数字可能非常大，只需输出该数对 $ 10^9+7 $ 取模后的结果。", "inputFormat": "输入的第一行包含两个空格分隔的整数 $ N $ 和 $ K $ （ $ 2 \\leq N \\leq 30000 ,2 \\leq K \\leq 6 $ ）。\n\n以下 $ N $ 行每行包含 $ K-1 $ 个空格分隔的整数，为解锁一条水平边上的每扇门需要花费的代价。\n\n以下 $ K $ 行每行包含 $ N-1 $ 个空格分隔的整数，为解锁一条垂直边上的每扇门需要花费的代价。\n\n所有的花费均在 $ 1 $ 到 $ 10^9 $ 之间。", "outputFormat": "一个整数：最小花费的逃脱方案的数量，对 $ 10^9+7 $ 取模。", "hint": "这个测试样例描述了一个4x3的方阵，\n\n```\n     1     1\n  +-----+-----+\n  |     |     |\n1 |     |2    | 1\n  |  5  |  6  |\n  +-----+-----+\n  |     |     |\n1 |     |3    | 1\n  |  7  |  8  |\n  +-----+-----+\n  |     |     |\n1 |     |4    | 1\n  |     |     |\n  +-----+-----+\n     1    1\n```\n\n所有的最小代价脱逃方案都会使用代价为2的门，代价为3的门，以及某九个代价为1的门。由于有十种方式选择不被使用的代价为1的门，所以答案为10。\n\n### 子任务\n\n对于20%的测试数据，保证 $ N \\leq 500 $ ，所有的代价均在 $ 1 $ 到 $ 5 $ 之间。\n\n对于另外20%的测试数据，保证 $ N \\leq 5000 $ 。", "locale": "zh-CN"}}}
{"pid": "P5423", "type": "P", "difficulty": 7, "samples": [["3\n1 10 2\n20 100 30\n3 11 50", "30"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "USACO", "并查集", "平面图欧拉公式"], "title": "[USACO19OPEN] Valleys P", "background": "", "description": "Bessie 喜欢观光，而今天她正在寻找景色优美的山谷。\n\n她感兴趣的是一个 $ N \\times N $ 的方阵，其中每个格子都有一个高度。所有在此正方形方阵之外的格子的高度可以被看作是无限大。\n\n山谷指的是一块连续、不含洞的一块区域，并且每个相邻的包围该区域的格子都高于这块区域中的所有格子。\n\n更形式化地说：\n\n* 一组格子被称作是“沿边相邻的”，如果可以从其中任意一个格子出发，经过一些沿上、下、左、右方向的移动，到达其中所有其他格子。\n* 一组格子被称作是“沿点相邻的”，如果可以从其中任意一个格子出发，经过一些沿上、下、左、右、对角线方向的移动，到达其中所有其他格子。\n* 一个“区域”指的是一组非空并且沿边相邻的格子。\n* 一个区域被称作是“有洞的”，如果这个区域的补集（包括在 $ N \\times N $ 方阵之外的无限高格子）不是沿点相邻的。\n* 区域的“边界”指的是所有与该区域内的某个格子正交相邻（上、下、左、右），但本身不在该区域内的格子。\n* 一个“山谷”指的是某个非有洞区域，满足区域内的任意格子的高度低于该区域边界上任意格子的高度。\n\nBessie 的目标是求出所有山谷的大小之和。\n\n### 一些例子\n\n这是一个区域：\n\n```\noo.\nooo\n..o\n```\n\n这不是一个区域（中间的格子和右下角的格子不沿边相邻）：\n\n```\noo.\noo.\n..o\n```\n\n这是一个非有洞区域：\n\n```\nooo\no..\no..\n```\n\n这是一个有洞的区域（“甜甜圈”中间的格子与区域外的格子不沿点相邻）：\n\n```\nooo\no.o\nooo\n```\n\n这是另一个非有洞区域（中间的格子与右下角的格子沿点相邻）：\n\n```\nooo\no.o\noo.\n```", "inputFormat": "输入的第一行包含 $ N $ ，其中 $ 1 \\leq N \\leq 750 $ 。\n\n以下 $ N $ 行每行包含 $ N $ 个整数，为方阵每个格子的高度。所有高度 $ h $ 满足 $ 1 \\leq h \\leq 10^6 $ 。所有高度均为不同的整数。", "outputFormat": "输出一个整数，为所有山谷的大小之和。", "hint": "在这个例子中，有三个大小为1的山谷：\n\n```\no.o\n...\no..\n```\n\n一个大小为2的山谷：\n\n```\n...\n...\noo.\n```\n\n一个大小为3的山谷：\n\n```\nooo\n...\n...\n```\n\n一个大小为6的山谷：\n\n```\nooo\no..\noo.\n```\n\n一个大小为7的山谷：\n\n```\nooo\no.o\noo.\n```\n\n以及一个大小为9的山谷：\n\n```\nooo\nooo\nooo\n```\n\n所以，答案为1 + 1 + 1 + 2 + 3 + 6 + 7 + 9 = 30。\n\n### 子任务\n\n对于至少19%的测试数据， $ N \\leq 100 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] Valleys P", "background": "", "description": "Bessie likes sightseeing, and today she is looking for valleys with beautiful scenery.\n\nShe is interested in an $N \\times N$ square grid, where each cell has a height. The heights of all cells outside this square grid can be considered to be infinitely large.\n\nA valley is a connected, hole-free region such that every neighboring cell surrounding this region is higher than all cells in the region.\n\nMore formally:\n\n* A set of cells is called “edge-connected” if, starting from any one of the cells, it is possible to reach all other cells in the set by moving some number of steps in the up, down, left, and right directions.\n* A set of cells is called “corner-connected” if, starting from any one of the cells, it is possible to reach all other cells in the set by moving some number of steps in the up, down, left, right, and diagonal directions.\n* A “region” is a non-empty set of edge-connected cells.\n* A region is called “with holes” if the complement of this region (including the infinitely high cells outside the $N \\times N$ grid) is not corner-connected.\n* The “boundary” of a region is the set of all cells that are orthogonally adjacent (up, down, left, right) to some cell in the region, but are not themselves in the region.\n* A “valley” is a region without holes such that the height of every cell in the region is lower than the height of every cell on the region’s boundary.\n\nBessie’s goal is to compute the sum of the sizes of all valleys.\n\n### Some examples\n\nThis is a region:\n\n```\noo.\nooo\n..o\n```\n\nThis is not a region (the middle cell and the bottom-right cell are not edge-connected):\n\n```\noo.\noo.\n..o\n```\n\nThis is a hole-free region:\n\n```\nooo\no..\no..\n```\n\nThis is a region with holes (the cell in the middle of the “donut” is not corner-connected to the outside of the region):\n\n```\nooo\no.o\nooo\n```\n\nThis is another hole-free region (the cell in the middle is corner-connected to the bottom-right cell):\n\n```\nooo\no.o\noo.\n```", "inputFormat": "The first line contains $N$, where $1 \\leq N \\leq 750$.\n\nThe next $N$ lines each contain $N$ integers, the heights of the cells in the grid. All heights $h$ satisfy $1 \\leq h \\leq 10^6$. All heights are distinct integers.", "outputFormat": "Output one integer: the sum of the sizes of all valleys.", "hint": "In this example, there are three valleys of size $1$:\n\n```\no.o\n...\no..\n```\n\nOne valley of size $2$:\n\n```\n...\n...\noo.\n```\n\nOne valley of size $3$:\n\n```\nooo\n...\n...\n```\n\nOne valley of size $6$:\n\n```\nooo\no..\noo.\n```\n\nOne valley of size $7$:\n\n```\nooo\no.o\noo.\n```\n\nAnd one valley of size $9$:\n\n```\nooo\nooo\nooo\n```\n\nSo the answer is $1 + 1 + 1 + 2 + 3 + 6 + 7 + 9 = 30$.\n\n### Subtasks\n\nFor at least $19\\%$ of the testdata, $N \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] Valleys P", "background": "", "description": "Bessie 喜欢观光，而今天她正在寻找景色优美的山谷。\n\n她感兴趣的是一个 $ N \\times N $ 的方阵，其中每个格子都有一个高度。所有在此正方形方阵之外的格子的高度可以被看作是无限大。\n\n山谷指的是一块连续、不含洞的一块区域，并且每个相邻的包围该区域的格子都高于这块区域中的所有格子。\n\n更形式化地说：\n\n* 一组格子被称作是“沿边相邻的”，如果可以从其中任意一个格子出发，经过一些沿上、下、左、右方向的移动，到达其中所有其他格子。\n* 一组格子被称作是“沿点相邻的”，如果可以从其中任意一个格子出发，经过一些沿上、下、左、右、对角线方向的移动，到达其中所有其他格子。\n* 一个“区域”指的是一组非空并且沿边相邻的格子。\n* 一个区域被称作是“有洞的”，如果这个区域的补集（包括在 $ N \\times N $ 方阵之外的无限高格子）不是沿点相邻的。\n* 区域的“边界”指的是所有与该区域内的某个格子正交相邻（上、下、左、右），但本身不在该区域内的格子。\n* 一个“山谷”指的是某个非有洞区域，满足区域内的任意格子的高度低于该区域边界上任意格子的高度。\n\nBessie 的目标是求出所有山谷的大小之和。\n\n### 一些例子\n\n这是一个区域：\n\n```\noo.\nooo\n..o\n```\n\n这不是一个区域（中间的格子和右下角的格子不沿边相邻）：\n\n```\noo.\noo.\n..o\n```\n\n这是一个非有洞区域：\n\n```\nooo\no..\no..\n```\n\n这是一个有洞的区域（“甜甜圈”中间的格子与区域外的格子不沿点相邻）：\n\n```\nooo\no.o\nooo\n```\n\n这是另一个非有洞区域（中间的格子与右下角的格子沿点相邻）：\n\n```\nooo\no.o\noo.\n```", "inputFormat": "输入的第一行包含 $ N $ ，其中 $ 1 \\leq N \\leq 750 $ 。\n\n以下 $ N $ 行每行包含 $ N $ 个整数，为方阵每个格子的高度。所有高度 $ h $ 满足 $ 1 \\leq h \\leq 10^6 $ 。所有高度均为不同的整数。", "outputFormat": "输出一个整数，为所有山谷的大小之和。", "hint": "在这个例子中，有三个大小为1的山谷：\n\n```\no.o\n...\no..\n```\n\n一个大小为2的山谷：\n\n```\n...\n...\noo.\n```\n\n一个大小为3的山谷：\n\n```\nooo\n...\n...\n```\n\n一个大小为6的山谷：\n\n```\nooo\no..\noo.\n```\n\n一个大小为7的山谷：\n\n```\nooo\no.o\noo.\n```\n\n以及一个大小为9的山谷：\n\n```\nooo\nooo\nooo\n```\n\n所以，答案为1 + 1 + 1 + 2 + 3 + 6 + 7 + 9 = 30。\n\n### 子任务\n\n对于至少19%的测试数据， $ N \\leq 100 $ 。", "locale": "zh-CN"}}}
{"pid": "P5424", "type": "P", "difficulty": 4, "samples": [["6 2\n7 9 8 2 3 2", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2019", "USACO"], "title": "[USACO19OPEN] Snakes G", "background": "", "description": "传说，数千年前圣帕特里克消灭了哞尔兰所有的蛇。然而，蛇们现在卷土重来了！圣帕特里克节是在每年的 3 月 17 日，所以 Bessie 要用彻底清除哞尔兰所有的蛇来纪念圣帕特里克。\n\nBessie装备了一个捕网，用来捕捉 $ N $ 组排成一行的蛇（ $ 1 \\leq N \\leq 400 $ ）。Bessie 必须按照这些组在这一行中出现的顺序捕捉每一组的所有蛇。每当 Bessie 抓完一组蛇之后，她就会将蛇放在笼子里，然后带着空的捕网开始捕捉下一组。\n\n一个大小为 $ s $ 的捕网意味着 Bessie 可以抓住任意包含 $ g $ 条的一组蛇，其中 $ g \\leq s $ 。然而，每当 Bessie 用大小为 $ s $ 的捕网抓住了一组 $ g $ 条蛇，就意味着浪费了 $ s-g $ 的空间。Bessie 可以任意设定捕网的初始大小，并且她可以改变 $ K $ 次捕网大小（ $ 1 \\leq K<N $ ）。\n\n请告诉 Bessie 她捕捉完所有组的蛇之后可以达到的总浪费空间的最小值。", "inputFormat": "输入的第一行包含 $ N $ 和 $ K $ 。\n\n第二行包含 $ N $ 个整数 $ a_1, \\ldots ,a_N $ ，其中 $ a_i $ （ $ 0 \\leq a_i \\leq 10^6 $ ）为第 $ i $ 组蛇的数量。", "outputFormat": "输出一个整数，为 Bessie 抓住所有蛇的总浪费空间的最小值。", "hint": "Bessie 可以设置她的捕网开始时大小为 $7$。当她抓完第一组蛇之后，她将她的捕网的大小调整为 $9$，保持这个大小直到抓完第 $3$ 组蛇，再将捕网大小调整为 $3$。总浪费空间为 $ (7-7)+(9-9)+(9-8)+(3-2)+(3-3)+(3-2)=3 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] Snakes G", "background": "", "description": "Legend says that thousands of years ago, Saint Patrick got rid of all the snakes in MooLand. However, the snakes have now returned! Saint Patrick’s Day is on March 17 every year, so Bessie wants to celebrate it by completely clearing MooLand of all snakes.\n\nBessie is equipped with a net to catch $N$ groups of snakes lined up in a row ($1 \\leq N \\leq 400$). Bessie must catch all the snakes in each group in the order the groups appear in the line. Each time Bessie finishes catching one group of snakes, she puts them into cages, and then starts catching the next group with an empty net.\n\nA net of size $s$ means that Bessie can catch any group containing $g$ snakes, where $g \\leq s$. However, whenever Bessie uses a net of size $s$ to catch a group of $g$ snakes, it wastes $s - g$ space. Bessie may choose the initial size of her net freely, and she may change the net size $K$ times ($1 \\leq K < N$).\n\nPlease tell Bessie the minimum possible total wasted space after she catches all groups of snakes.", "inputFormat": "The first line of input contains $N$ and $K$.\n\nThe second line contains $N$ integers $a_1, \\ldots, a_N$, where $a_i$ ($0 \\leq a_i \\leq 10^6$) is the number of snakes in the $i$-th group.", "outputFormat": "Output one integer: the minimum total wasted space for Bessie to catch all the snakes.", "hint": "Bessie can set her net to have an initial size of $7$. After she catches the first group of snakes, she changes her net size to $9$, keeps this size until she catches the $3$-rd group, and then changes the net size to $3$. The total wasted space is $(7-7)+(9-9)+(9-8)+(3-2)+(3-3)+(3-2)=3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] Snakes G", "background": "", "description": "传说，数千年前圣帕特里克消灭了哞尔兰所有的蛇。然而，蛇们现在卷土重来了！圣帕特里克节是在每年的 3 月 17 日，所以 Bessie 要用彻底清除哞尔兰所有的蛇来纪念圣帕特里克。\n\nBessie装备了一个捕网，用来捕捉 $ N $ 组排成一行的蛇（ $ 1 \\leq N \\leq 400 $ ）。Bessie 必须按照这些组在这一行中出现的顺序捕捉每一组的所有蛇。每当 Bessie 抓完一组蛇之后，她就会将蛇放在笼子里，然后带着空的捕网开始捕捉下一组。\n\n一个大小为 $ s $ 的捕网意味着 Bessie 可以抓住任意包含 $ g $ 条的一组蛇，其中 $ g \\leq s $ 。然而，每当 Bessie 用大小为 $ s $ 的捕网抓住了一组 $ g $ 条蛇，就意味着浪费了 $ s-g $ 的空间。Bessie 可以任意设定捕网的初始大小，并且她可以改变 $ K $ 次捕网大小（ $ 1 \\leq K<N $ ）。\n\n请告诉 Bessie 她捕捉完所有组的蛇之后可以达到的总浪费空间的最小值。", "inputFormat": "输入的第一行包含 $ N $ 和 $ K $ 。\n\n第二行包含 $ N $ 个整数 $ a_1, \\ldots ,a_N $ ，其中 $ a_i $ （ $ 0 \\leq a_i \\leq 10^6 $ ）为第 $ i $ 组蛇的数量。", "outputFormat": "输出一个整数，为 Bessie 抓住所有蛇的总浪费空间的最小值。", "hint": "Bessie 可以设置她的捕网开始时大小为 $7$。当她抓完第一组蛇之后，她将她的捕网的大小调整为 $9$，保持这个大小直到抓完第 $3$ 组蛇，再将捕网大小调整为 $3$。总浪费空间为 $ (7-7)+(9-9)+(9-8)+(3-2)+(3-3)+(3-2)=3 $ 。", "locale": "zh-CN"}}}
{"pid": "P5425", "type": "P", "difficulty": 4, "samples": [["3 2", "2019201769"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2019", "USACO", "生成树"], "title": "[USACO19OPEN] I Would Walk 500 Miles G", "background": "", "description": "Farmer John 想要将他的编号为 $ 1 \\ldots N $ 的 $ N $ 头奶牛（ $ N \\leq 7500 $ ）分为非空的 $ K $ 组（ $ 2 \\leq K \\leq N $ ），使得任意两头来自不同组的奶牛都需要走一定的距离才能相遇。奶牛 $ x $ 和奶牛 $ y $ （其中 $ 1 \\leq x<y \\leq N $ ）愿意为了见面走 $ (2019201913x+2019201949y) \\mod 2019201997 $ 英里。\n\n给定一个将 $ N $ 头奶牛分为 $ K $ 个非空小组的分组方案，令 $ M $ 为任意两头来自不同组的奶牛愿意为了见面行走的英里数的最小值。为了测试奶牛们相互之间的忠诚度，Farmer John 想要将 $ N $ 头奶牛以最佳的方式分为 $ K $ 组，使得 $ M $ 尽可能大。 ", "inputFormat": "输入仅有一行，包含 $ N $ 和 $ K $ ，用空格分隔。", "outputFormat": "输出最优的 $ M $ 。", "hint": "在这个例子中，奶牛 $1$ 和奶牛 $2$ 愿意为了见面走 $2019201817$ 英里。奶牛 $2$ 和奶牛 $3$ 愿意走 $2019201685$ 英里。奶牛 $1$ 和奶牛 $3$ 愿意走 $2019201769$ 英里。所以，将奶牛 $1$ 单独分为一组，奶牛 $2$ 和奶牛 $3$ 分为一组，$M = \\min(2019201817, 2019201769) = 2019201769$（这是我们在这个问题中能够达到的最佳结果）。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] I Would Walk 500 Miles G", "background": "", "description": "Farmer John wants to divide his $N$ cows numbered $1 \\ldots N$ ($N \\leq 7500$) into $K$ non-empty groups ($2 \\leq K \\leq N$), such that any two cows from different groups must walk some distance to meet each other. Cows $x$ and $y$ (where $1 \\leq x<y \\leq N$) are willing to walk $(2019201913x+2019201949y) \\mod 2019201997$ miles in order to meet.\n\nGiven a grouping plan that divides the $N$ cows into $K$ non-empty groups, let $M$ be the minimum number of miles that any two cows from different groups are willing to walk to meet. To test the cows' loyalty to each other, Farmer John wants to divide the $N$ cows into $K$ groups in the best possible way so that $M$ is as large as possible.", "inputFormat": "The input consists of a single line containing $N$ and $K$, separated by a space.", "outputFormat": "Output the optimal value of $M$.", "hint": "In this example, cow $1$ and cow $2$ are willing to walk $2019201817$ miles to meet. Cow $2$ and cow $3$ are willing to walk $2019201685$ miles. Cow $1$ and cow $3$ are willing to walk $2019201769$ miles. Therefore, if cow $1$ is put alone in one group, and cows $2$ and $3$ are put into another group, then $M = \\min(2019201817, 2019201769) = 2019201769$ (this is the best result we can achieve in this problem).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] I Would Walk 500 Miles G", "background": "", "description": "Farmer John 想要将他的编号为 $ 1 \\ldots N $ 的 $ N $ 头奶牛（ $ N \\leq 7500 $ ）分为非空的 $ K $ 组（ $ 2 \\leq K \\leq N $ ），使得任意两头来自不同组的奶牛都需要走一定的距离才能相遇。奶牛 $ x $ 和奶牛 $ y $ （其中 $ 1 \\leq x<y \\leq N $ ）愿意为了见面走 $ (2019201913x+2019201949y) \\mod 2019201997 $ 英里。\n\n给定一个将 $ N $ 头奶牛分为 $ K $ 个非空小组的分组方案，令 $ M $ 为任意两头来自不同组的奶牛愿意为了见面行走的英里数的最小值。为了测试奶牛们相互之间的忠诚度，Farmer John 想要将 $ N $ 头奶牛以最佳的方式分为 $ K $ 组，使得 $ M $ 尽可能大。 ", "inputFormat": "输入仅有一行，包含 $ N $ 和 $ K $ ，用空格分隔。", "outputFormat": "输出最优的 $ M $ 。", "hint": "在这个例子中，奶牛 $1$ 和奶牛 $2$ 愿意为了见面走 $2019201817$ 英里。奶牛 $2$ 和奶牛 $3$ 愿意走 $2019201685$ 英里。奶牛 $1$ 和奶牛 $3$ 愿意走 $2019201769$ 英里。所以，将奶牛 $1$ 单独分为一组，奶牛 $2$ 和奶牛 $3$ 分为一组，$M = \\min(2019201817, 2019201769) = 2019201769$（这是我们在这个问题中能够达到的最佳结果）。", "locale": "zh-CN"}}}
{"pid": "P5426", "type": "P", "difficulty": 5, "samples": [["5\n0 0 0 1 0 1 0 0 0 1", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2019", "USACO", "枚举"], "title": "[USACO19OPEN] Balancing Inversions G", "background": "", "description": "Bessie 和 Elsie 在一个长为 $2N$ 的布尔数组 $A$ 上玩游戏（$1 \\leq N \\leq 10^5$）。Bessie 的分数为 $A$ 的前一半的逆序对数量，Elsie 的分数为 $A$ 的后一半的逆序对数量。逆序对指的是满足 $A[i] = 1$ 以及 $A[j] = 0$ 的一对元素，其中 $i < j$。例如，一段 $0$ 之后接着一段 $1$ 的数组没有逆序对，一段 $X$ 个 $1$ 之后接着一段 $Y$ 个 $0$ 的数组有 $XY$ 个逆序对。\n\nFarmer John 偶然看见了这一棋盘，他好奇于可以使得游戏看起来成为平局所需要交换相邻元素的最小次数。请帮助 Farmer John 求出这个问题的答案。\n", "inputFormat": "输入的第一行包含 $N$，第二行包含 $2N$ 个为 $0$ 或 $1$ 的整数。", "outputFormat": "输出使得游戏成为平局最少需要的移动次数。", "hint": "在这个例子中，初始时前一半有 $1$ 个逆序对，后一半有 $3$ 个逆序对。交换了第 $5$ 和第 $6$ 个数之后，两个子数组均有 $0$ 个逆序对。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] Balancing Inversions G", "background": "", "description": "Bessie and Elsie are playing a game on a boolean array $A$ of length $2N$ ($1 \\leq N \\leq 10^5$). Bessie's score is the number of inversions in the first half of $A$, and Elsie's score is the number of inversions in the second half of $A$. An inversion is a pair of elements satisfying $A[i] = 1$ and $A[j] = 0$, where $i < j$. For example, an array with a block of $0$'s followed by a block of $1$'s has no inversions, while an array with $X$ $1$'s followed by $Y$ $0$'s has $XY$ inversions.\n\nFarmer John happens to see this board, and he wonders what the minimum number of adjacent swaps is to make the game appear tied. Please help Farmer John compute the answer.", "inputFormat": "The first line contains $N$. The second line contains $2N$ integers, each being $0$ or $1$.", "outputFormat": "Output the minimum number of moves needed to make the game tied.", "hint": "In this example, initially the first half has $1$ inversion and the second half has $3$ inversions. After swapping the $5$-th and the $6$-th numbers, both subarrays have $0$ inversions.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] Balancing Inversions G", "background": "", "description": "Bessie 和 Elsie 在一个长为 $2N$ 的布尔数组 $A$ 上玩游戏（$1 \\leq N \\leq 10^5$）。Bessie 的分数为 $A$ 的前一半的逆序对数量，Elsie 的分数为 $A$ 的后一半的逆序对数量。逆序对指的是满足 $A[i] = 1$ 以及 $A[j] = 0$ 的一对元素，其中 $i < j$。例如，一段 $0$ 之后接着一段 $1$ 的数组没有逆序对，一段 $X$ 个 $1$ 之后接着一段 $Y$ 个 $0$ 的数组有 $XY$ 个逆序对。\n\nFarmer John 偶然看见了这一棋盘，他好奇于可以使得游戏看起来成为平局所需要交换相邻元素的最小次数。请帮助 Farmer John 求出这个问题的答案。\n", "inputFormat": "输入的第一行包含 $N$，第二行包含 $2N$ 个为 $0$ 或 $1$ 的整数。", "outputFormat": "输出使得游戏成为平局最少需要的移动次数。", "hint": "在这个例子中，初始时前一半有 $1$ 个逆序对，后一半有 $3$ 个逆序对。交换了第 $5$ 和第 $6$ 个数之后，两个子数组均有 $0$ 个逆序对。", "locale": "zh-CN"}}}
{"pid": "P5427", "type": "P", "difficulty": 4, "samples": [["3\nRLR\nRRL\nLLR", "1 1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2019", "USACO", "Ad-hoc"], "title": "[USACO19OPEN] Left Out S", "background": "", "description": "Farmer John 正在尝试给他的牛群拍照。根据以往的经验，他知道这一工作往往结果不怎么样。\n\n这一次，Farmer John 购买了一台昂贵的无人机，想要拍一张航拍照。为了使照片尽可能好看，他想让他的奶牛们在拍照时都朝向同一个方向。奶牛们现在在一块有围栏的草地上排列成 $N \\times N$（$2 \\leq N \\leq 1000$）的方阵，例如：\n\n```\nRLR\nRRL\nLLR\n```\n\n这里，字符 `R` 表示一头朝右的奶牛，字符 `L` 表示一头朝左的奶牛。由于奶牛们都挤在一起，Farmer John 没办法走到某一头奶牛面前让她调转方向。他能做的只有对着某一行或某一列的奶牛喊叫让她们调转方向，使得被叫到的这一行或列内的所有 `L` 变为 `R`，`R` 变为 `L`。Farmer John 可以对任意多的行或列发号施令，也可以对同一行或列多次发令。\n\n就如同 Farmer John 想象的，他发现他不可能让他的奶牛们都朝向同一个方向。他最多能做的是让所有奶牛中除了一头之外都朝向相同的方向。请找出这样的一头奶牛。\n", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行描述了奶牛方阵的第 $1 \\ldots N$ 行，每行包含一个长度为 $N$ 的字符串。", "outputFormat": "输出一头奶牛的行列坐标，满足这头奶牛被调转方向的话，Farmer John 就可以使他的所有奶牛都朝向同一个方向。如果不存在这样的奶牛，输出 `-1`。如果存在多头这样的奶牛，输出其中行坐标最小的，如果多头这样的奶牛具有相同的行坐标，输出其中列坐标最小的。", "hint": "在这个例子中，位于第 $1$ 行第 $1$ 列（左上角）的奶牛是那头令人讨厌的奶牛，因为 Farmer John 可以喊叫第 $2$ 行和第 $3$ 列来让所有奶牛都面向左侧，只有这一头奶牛面向右侧。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] Left Out S", "background": "", "description": "Farmer John is trying to take a photo of his cows. Based on past experience, he knows that this often does not turn out very well.\n\nThis time, Farmer John bought an expensive drone and wants to take an aerial photo. To make the photo look as good as possible, he wants all of his cows to face the same direction when the photo is taken. The cows are currently arranged on a fenced pasture in an $N \\times N$ ($2 \\leq N \\leq 1000$) square grid, for example:\n\n```\nRLR\nRRL\nLLR\n```\n\nHere, the character `R` represents a cow facing right, and `L` represents a cow facing left. Since the cows are packed closely together, Farmer John cannot walk up to a single cow and make her turn around. The only thing he can do is shout at an entire row or an entire column of cows to make them turn around, which flips all `L` to `R` and all `R` to `L` in that row or column. Farmer John may issue commands to any number of rows or columns, and may even issue commands multiple times to the same row or column.\n\nJust as Farmer John expected, he finds that it is impossible to make all cows face the same direction. The best he can do is to make all cows except one face the same direction. Please find such a cow.", "inputFormat": "The first line contains $N$. The next $N$ lines describe rows $1 \\ldots N$ of the cow grid, each containing a string of length $N$.", "outputFormat": "Output the row and column coordinates of a cow such that, if that cow were flipped, Farmer John could make all of his cows face the same direction. If no such cow exists, output `-1`. If there are multiple such cows, output the one with the smallest row index; if multiple have the same row index, output the one with the smallest column index.", "hint": "In this example, the cow at row $1$, column $1$ (the top-left corner) is the annoying cow, because Farmer John can shout at row $2$ and column $3$ to make all cows face left, with only this cow facing right.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] Left Out S", "background": "", "description": "Farmer John 正在尝试给他的牛群拍照。根据以往的经验，他知道这一工作往往结果不怎么样。\n\n这一次，Farmer John 购买了一台昂贵的无人机，想要拍一张航拍照。为了使照片尽可能好看，他想让他的奶牛们在拍照时都朝向同一个方向。奶牛们现在在一块有围栏的草地上排列成 $N \\times N$（$2 \\leq N \\leq 1000$）的方阵，例如：\n\n```\nRLR\nRRL\nLLR\n```\n\n这里，字符 `R` 表示一头朝右的奶牛，字符 `L` 表示一头朝左的奶牛。由于奶牛们都挤在一起，Farmer John 没办法走到某一头奶牛面前让她调转方向。他能做的只有对着某一行或某一列的奶牛喊叫让她们调转方向，使得被叫到的这一行或列内的所有 `L` 变为 `R`，`R` 变为 `L`。Farmer John 可以对任意多的行或列发号施令，也可以对同一行或列多次发令。\n\n就如同 Farmer John 想象的，他发现他不可能让他的奶牛们都朝向同一个方向。他最多能做的是让所有奶牛中除了一头之外都朝向相同的方向。请找出这样的一头奶牛。\n", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行描述了奶牛方阵的第 $1 \\ldots N$ 行，每行包含一个长度为 $N$ 的字符串。", "outputFormat": "输出一头奶牛的行列坐标，满足这头奶牛被调转方向的话，Farmer John 就可以使他的所有奶牛都朝向同一个方向。如果不存在这样的奶牛，输出 `-1`。如果存在多头这样的奶牛，输出其中行坐标最小的，如果多头这样的奶牛具有相同的行坐标，输出其中列坐标最小的。", "hint": "在这个例子中，位于第 $1$ 行第 $1$ 列（左上角）的奶牛是那头令人讨厌的奶牛，因为 Farmer John 可以喊叫第 $2$ 行和第 $3$ 列来让所有奶牛都面向左侧，只有这一头奶牛面向右侧。", "locale": "zh-CN"}}}
{"pid": "P5428", "type": "P", "difficulty": 5, "samples": [["4\n2 1 6 1\n4 0 1 5\n5 6 5 5\n2 7 1 3", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["计算几何", "2019", "二分", "USACO", "叉积"], "title": "[USACO19OPEN] Cow Steeplechase II S", "background": "", "description": "在过去，Farmer John曾经构思了许多新式奶牛运动项目的点子，其中就包括奶牛障碍赛，是奶牛们在赛道上跑越障碍栏架的竞速项目。他之前对推广这项运动做出的努力结果喜忧参半，所以他希望在他的农场上建造一个更大的奶牛障碍赛的场地，试着让这项运动更加普及。\n\nFarmer John为新场地精心设计了 $ N $ 个障碍栏架，编号为 $ 1 \\ldots \n N $ （ $ 2 \\leq N \\leq 10^5 $ ），每一个栏架都可以用这一场地的二维地图中的一条线段来表示。这些线段本应两两不相交，包括端点位置。\n\n不幸的是，Farmer John在绘制场地地图的时候不够仔细，现在发现线段之间出现了交点。然而，他同时注意到只要移除一条线段，这张地图就可以恢复到预期没有相交线段的状态（包括端点位置）。\n\n请求出Farmer John为了恢复没有线段相交这一属性所需要从他的计划中删去的一条线段。如果有多条线段移除后均可满足条件，请输出在输入中出现最早的线段的序号。", "inputFormat": "输入的第一行包含 $ N $ 。余下 $ N $ 行每行用四个整数 $ x_1,y_1,x_2,y_2 $ 表示一条线段，均为至多 $ 10^9 $ 的非负整数。这条线段的端点为 $ (x_1,y_1) $ 和 $ (x_2,y_2) $ 。所有线段的端点各不相同。", "outputFormat": "输出在输入中出现最早的移除之后可以使得余下线段各不相交的线段序号。", "hint": "注意：由于线段端点坐标数值的大小，在这个问题中你可能需要考虑整数类型溢出的情况。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] Cow Steeplechase II S", "background": "", "description": "In the past, Farmer John has come up with many ideas for new cow sports, including cow steeplechase, a racing event where cows run along a track and jump over hurdles. His previous efforts to promote this sport had mixed results, so he wants to build a larger cow steeplechase venue on his farm to try to make the sport more popular.\n\nFarmer John carefully designed $N$ hurdles for the new venue, numbered $1 \\ldots N$ ($2 \\leq N \\leq 10^5$). Each hurdle can be represented as a line segment on the 2D map of the venue. These segments were supposed to be pairwise non-intersecting, including at endpoints.\n\nUnfortunately, Farmer John was not careful enough when drawing the map and now finds that there are intersections between segments. However, he also notices that as long as he removes one segment, the map can be restored to the intended state where no segments intersect (including at endpoints).\n\nPlease find one segment that Farmer John needs to delete from his plan to restore the property that no segments intersect. If removing multiple segments can satisfy the condition, output the index of the segment that appears earliest in the input.", "inputFormat": "The first line contains $N$. The next $N$ lines each contain four integers $x_1, y_1, x_2, y_2$, all non-negative integers of value at most $10^9$, describing a segment. The endpoints of the segment are $(x_1, y_1)$ and $(x_2, y_2)$. All segment endpoints are distinct.", "outputFormat": "Output the index of the earliest segment in the input such that after removing it, all remaining segments are pairwise non-intersecting.", "hint": "Note: Because the endpoint coordinates can be very large, you may need to consider integer overflow in this problem.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] Cow Steeplechase II S", "background": "", "description": "在过去，Farmer John曾经构思了许多新式奶牛运动项目的点子，其中就包括奶牛障碍赛，是奶牛们在赛道上跑越障碍栏架的竞速项目。他之前对推广这项运动做出的努力结果喜忧参半，所以他希望在他的农场上建造一个更大的奶牛障碍赛的场地，试着让这项运动更加普及。\n\nFarmer John为新场地精心设计了 $ N $ 个障碍栏架，编号为 $ 1 \\ldots \n N $ （ $ 2 \\leq N \\leq 10^5 $ ），每一个栏架都可以用这一场地的二维地图中的一条线段来表示。这些线段本应两两不相交，包括端点位置。\n\n不幸的是，Farmer John在绘制场地地图的时候不够仔细，现在发现线段之间出现了交点。然而，他同时注意到只要移除一条线段，这张地图就可以恢复到预期没有相交线段的状态（包括端点位置）。\n\n请求出Farmer John为了恢复没有线段相交这一属性所需要从他的计划中删去的一条线段。如果有多条线段移除后均可满足条件，请输出在输入中出现最早的线段的序号。", "inputFormat": "输入的第一行包含 $ N $ 。余下 $ N $ 行每行用四个整数 $ x_1,y_1,x_2,y_2 $ 表示一条线段，均为至多 $ 10^9 $ 的非负整数。这条线段的端点为 $ (x_1,y_1) $ 和 $ (x_2,y_2) $ 。所有线段的端点各不相同。", "outputFormat": "输出在输入中出现最早的移除之后可以使得余下线段各不相交的线段序号。", "hint": "注意：由于线段端点坐标数值的大小，在这个问题中你可能需要考虑整数类型溢出的情况。", "locale": "zh-CN"}}}
{"pid": "P5429", "type": "P", "difficulty": 3, "samples": [["7 5\n0 5\n10 5\n5 0\n5 10\n6 7\n8 6\n8 4\n1 2\n2 3\n3 4\n5 6\n7 6", "10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "2019", "USACO", "并查集", "深度优先搜索 DFS"], "title": "[USACO19OPEN] Fence Planning S", "background": "", "description": "Farmer John 的 $ N $ 头奶牛，编号为 $ 1 \\ldots N $ （ $ 2 \\leq N \\leq 10^5 $ ），拥有一种围绕“哞网”，一些仅在组内互相交流却不与其他组进行交流的奶牛小组，组成的复杂的社交网络。\n\n每头奶牛位于农场的二维地图上的不同位置 $ (x,y) $ ，并且我们知道有 $ M $ 对奶牛( $ 1 \\leq M<10^5 $ )会相互哞叫。两头相互哞叫的奶牛属于同一哞网。\n\n为了升级他的农场，Farmer John 想要建造一个四边与 $ x $ 轴和 $ y $ 轴平行的长方形围栏。Farmer John 想要使得至少一个哞网完全被围栏所包围（在长方形边界上的奶牛计为被包围的）。请帮助 Farmer John 求出满足他的要求的围栏的最小可能周长。有可能出现这一围栏宽为 $0$ 或高为 $0$ 的情况。", "inputFormat": "输入的第一行包含 $ N $ 和 $ M $ 。以下 $ N $ 行每行包含一头奶牛的 $ x $ 坐标和 $ y $ 坐标（至多 $ 10^8 $ 的非负整数）。以下 $ M $ 行每行包含两个整数 $ a $ 和 $ b $ ，表示奶牛 $ a $ 和 $ b $ 之间有哞叫关系。每头奶牛都至少存在一个哞叫关系，并且输入中不会出现重复的哞叫关系。", "outputFormat": "输出满足 Farmer John 的要求的围栏的最小周长。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] Fence Planning S", "background": "", "description": "Farmer John has $N$ cows, numbered $1 \\ldots N$ ($2 \\leq N \\leq 10^5$). They have a complex social network based on “moo-networks”: groups of cows that communicate with each other within the group but do not communicate with cows in other groups.\n\nEach cow is at a distinct position $(x, y)$ on a 2D map of the farm, and we know that there are $M$ pairs of cows ($1 \\leq M < 10^5$) that moo to each other. Two cows that moo to each other belong to the same moo-network.\n\nTo upgrade his farm, Farmer John wants to build a rectangular fence whose four sides are parallel to the $x$-axis and the $y$-axis. He wants at least one moo-network to be completely enclosed by the fence (cows on the boundary of the rectangle are considered enclosed). Please help Farmer John find the minimum possible perimeter of a fence that satisfies his requirement. It is possible that the fence has width $0$ or height $0$.", "inputFormat": "The first line contains $N$ and $M$. The next $N$ lines each contain the $x$ coordinate and $y$ coordinate of a cow (non-negative integers up to $10^8$). The next $M$ lines each contain two integers $a$ and $b$, indicating that cows $a$ and $b$ have a mooing relationship. Each cow has at least one mooing relationship, and there are no duplicate mooing relationships in the input.", "outputFormat": "Output the minimum perimeter of a fence that satisfies Farmer John’s requirement.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] Fence Planning S", "background": "", "description": "Farmer John 的 $ N $ 头奶牛，编号为 $ 1 \\ldots N $ （ $ 2 \\leq N \\leq 10^5 $ ），拥有一种围绕“哞网”，一些仅在组内互相交流却不与其他组进行交流的奶牛小组，组成的复杂的社交网络。\n\n每头奶牛位于农场的二维地图上的不同位置 $ (x,y) $ ，并且我们知道有 $ M $ 对奶牛( $ 1 \\leq M<10^5 $ )会相互哞叫。两头相互哞叫的奶牛属于同一哞网。\n\n为了升级他的农场，Farmer John 想要建造一个四边与 $ x $ 轴和 $ y $ 轴平行的长方形围栏。Farmer John 想要使得至少一个哞网完全被围栏所包围（在长方形边界上的奶牛计为被包围的）。请帮助 Farmer John 求出满足他的要求的围栏的最小可能周长。有可能出现这一围栏宽为 $0$ 或高为 $0$ 的情况。", "inputFormat": "输入的第一行包含 $ N $ 和 $ M $ 。以下 $ N $ 行每行包含一头奶牛的 $ x $ 坐标和 $ y $ 坐标（至多 $ 10^8 $ 的非负整数）。以下 $ M $ 行每行包含两个整数 $ a $ 和 $ b $ ，表示奶牛 $ a $ 和 $ b $ 之间有哞叫关系。每头奶牛都至少存在一个哞叫关系，并且输入中不会出现重复的哞叫关系。", "outputFormat": "输出满足 Farmer John 的要求的围栏的最小周长。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5430", "type": "P", "difficulty": 7, "samples": [["4 2", "37"], ["2333333 2", "514898185"], ["1234567890000 3", "891659731"], ["1000000013 10", "616417347"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "递推", "2017", "洛谷原创", "O2优化"], "title": "[SNOI2017] 礼物 加强版", "background": "原题链接 [P5364](https://www.luogu.org/problemnew/show/P5364)", "description": "热情好客的**小猴子**请森林中的朋友们吃饭，他的朋友被编号为 $1\\sim n$，每个到来的朋友都会带给他一些礼物：**大香蕉**。其中，第一个朋友会带给他 $1$ 个**大香蕉**，之后，每一个朋友到来以后，都会带给他之前所有人带来的礼物个数再加他的编号的 $k$ 次方那么多个。所以，假设 $k=2$，前几位朋友带来的礼物个数分别是：\n\n$1,5,15,37,83,\\ldots$\n\n假设 $k=3$，前几位朋友带来的礼物个数分别是：\n\n$1,9,37,111,\\ldots$\n\n现在，**小猴子**好奇自己到底能收到第 $n$ 个朋友多少礼物，因此拜托于你了。\n\n已知 $n,k$，请输出第 $n$ 个朋友送的礼物个数 $\\bmod \\ 10^9+7$。", "inputFormat": "第一行，两个整数 $n,k$。", "outputFormat": "一个整数，表示第 $n$ 个朋友送的礼物个数 $\\bmod \\ 10^9+7$。", "hint": "$\\text{10}\\%$ 的数据：$n \\le 10^6$。\n \n另外 $\\text{10}\\%$ 的数据：$k \\le 3$。\n\n前 $\\text{40}\\%$ 的数据：$n \\le 10^{18}, k \\le 10$。\n\n前 $\\text{60}\\%$ 的数据：$n \\le 10^{18}, k \\le 1000$。\n\n前 $\\text{70}\\%$ 的数据：$k \\le 1000$。\n\n前 $\\text{90}\\%$ 的数据：$k \\le 10^6$。\n\n$\\text{100}\\%$ 的数据：$n\\le 10^{100000},k \\le 2\\times10^7$。\n\n最后一个测试点的时限为 $2s$，其余为 $1s$。\n****\nNaCly\\_Fish：本题原数据有误，现已修复。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] Gift (Enhanced Version).", "background": "Original problem link: [P5364](https://www.luogu.org/problemnew/show/P5364).", "description": "The hospitable **little monkey** invites friends from the forest to dinner. His friends are numbered from $1$ to $n$. Each friend who arrives brings him some gifts: **big bananas**. The first friend brings him $1$ **big banana**. After that, when each friend arrives, they will bring the total number of gifts brought by all previous friends, plus their index raised to the $k$-th power.\n\nSo, if $k=2$, the number of gifts brought by the first few friends is:\n\n$1,5,15,37,83,\\ldots$\n\nIf $k=3$, the number of gifts brought by the first few friends is:\n\n$1,9,37,111,\\ldots$\n\nNow, the **little monkey** is curious about how many gifts he will receive from the $n$-th friend, so he asks you for help.\n\nGiven $n,k$, output the number of gifts brought by the $n$-th friend $\\bmod \\ 10^9+7$.", "inputFormat": "The first line contains two integers $n,k$.", "outputFormat": "Output one integer, representing the number of gifts brought by the $n$-th friend $\\bmod \\ 10^9+7$.", "hint": "$\\text{10}\\%$ of the testdata: $n \\le 10^6$.\n\nAnother $\\text{10}\\%$ of the testdata: $k \\le 3$.\n\nThe first $\\text{40}\\%$ of the testdata: $n \\le 10^{18}, k \\le 10$.\n\nThe first $\\text{60}\\%$ of the testdata: $n \\le 10^{18}, k \\le 1000$.\n\nThe first $\\text{70}\\%$ of the testdata: $k \\le 1000$.\n\nThe first $\\text{90}\\%$ of the testdata: $k \\le 10^6$.\n\n$\\text{100}\\%$ of the testdata: $n\\le 10^{100000},k \\le 2\\times10^7$.\n\nThe time limit for the last test point is $2s$, and for the others it is $1s$.\n\n****\nNaCly\\_Fish: The original testdata for this problem was incorrect and has now been fixed.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 礼物 加强版", "background": "原题链接 [P5364](https://www.luogu.org/problemnew/show/P5364)", "description": "热情好客的**小猴子**请森林中的朋友们吃饭，他的朋友被编号为 $1\\sim n$，每个到来的朋友都会带给他一些礼物：**大香蕉**。其中，第一个朋友会带给他 $1$ 个**大香蕉**，之后，每一个朋友到来以后，都会带给他之前所有人带来的礼物个数再加他的编号的 $k$ 次方那么多个。所以，假设 $k=2$，前几位朋友带来的礼物个数分别是：\n\n$1,5,15,37,83,\\ldots$\n\n假设 $k=3$，前几位朋友带来的礼物个数分别是：\n\n$1,9,37,111,\\ldots$\n\n现在，**小猴子**好奇自己到底能收到第 $n$ 个朋友多少礼物，因此拜托于你了。\n\n已知 $n,k$，请输出第 $n$ 个朋友送的礼物个数 $\\bmod \\ 10^9+7$。", "inputFormat": "第一行，两个整数 $n,k$。", "outputFormat": "一个整数，表示第 $n$ 个朋友送的礼物个数 $\\bmod \\ 10^9+7$。", "hint": "$\\text{10}\\%$ 的数据：$n \\le 10^6$。\n \n另外 $\\text{10}\\%$ 的数据：$k \\le 3$。\n\n前 $\\text{40}\\%$ 的数据：$n \\le 10^{18}, k \\le 10$。\n\n前 $\\text{60}\\%$ 的数据：$n \\le 10^{18}, k \\le 1000$。\n\n前 $\\text{70}\\%$ 的数据：$k \\le 1000$。\n\n前 $\\text{90}\\%$ 的数据：$k \\le 10^6$。\n\n$\\text{100}\\%$ 的数据：$n\\le 10^{100000},k \\le 2\\times10^7$。\n\n最后一个测试点的时限为 $2s$，其余为 $1s$。\n****\nNaCly\\_Fish：本题原数据有误，现已修复。", "locale": "zh-CN"}}}
{"pid": "P5431", "type": "P", "difficulty": 4, "samples": [["6 233 42\n1 4 2 8 5 7", "91"]], "limits": {"time": [550, 550, 550, 550, 550], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "O2优化", "逆元", "模板题"], "title": "【模板】模意义下的乘法逆元 2", "background": "", "description": "给定 $n$ 个正整数 $a_i$ ，求它们在模 $p$ 意义下的乘法逆元。\n\n由于输出太多不好，所以将会给定常数 $k$，你要输出的答案为：  \n$$\\sum\\limits_{i=1}^n\\frac{k^i}{a_i}$$\n\n答案对 $p$ 取模。", "inputFormat": "第一行三个正整数 $n,p,k$，意义如题目描述。  \n第二行 $n$ 个正整数 $a_i$，是你要求逆元的数。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "对于 $30\\%$ 的数据，$1\\le n \\le 10^5$。\n\n对于 $100\\%$ 数据，$1\\le n \\le 5\\times 10^6$，$2\\le k < p \\le 10^9$，$1\\le a_i < p$，保证 $p$ 为质数。\n\n提示：本题时间限制较为严格，请注意使用较快的 IO 方式。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Multiplicative Inverse Modulo 2", "background": "", "description": "Given $n$ positive integers $a_i$, find their multiplicative inverses modulo $p$.\n\nSince outputting all inverses would be too much, a constant $k$ is given. The answer you need to output is:  \n$$\\sum\\limits_{i=1}^n\\frac{k^i}{a_i}$$\n\nOutput the answer modulo $p$.", "inputFormat": "The first line contains three positive integers $n, p, k$, with the meaning as described in the statement.  \nThe second line contains $n$ positive integers $a_i$, the numbers whose inverses you need to compute.", "outputFormat": "Output one integer in one line, representing the answer.", "hint": "For $30\\%$ of the testdata, $1 \\le n \\le 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 5\\times 10^6$, $2 \\le k < p \\le 10^9$, $1 \\le a_i < p$, and $p$ is guaranteed to be prime.\n\nNote: The time limit for this problem is relatively strict. Please use faster I/O methods.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】模意义下的乘法逆元 2", "background": "", "description": "给定 $n$ 个正整数 $a_i$ ，求它们在模 $p$ 意义下的乘法逆元。\n\n由于输出太多不好，所以将会给定常数 $k$，你要输出的答案为：  \n$$\\sum\\limits_{i=1}^n\\frac{k^i}{a_i}$$\n\n答案对 $p$ 取模。", "inputFormat": "第一行三个正整数 $n,p,k$，意义如题目描述。  \n第二行 $n$ 个正整数 $a_i$，是你要求逆元的数。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "对于 $30\\%$ 的数据，$1\\le n \\le 10^5$。\n\n对于 $100\\%$ 数据，$1\\le n \\le 5\\times 10^6$，$2\\le k < p \\le 10^9$，$1\\le a_i < p$，保证 $p$ 为质数。\n\n提示：本题时间限制较为严格，请注意使用较快的 IO 方式。", "locale": "zh-CN"}}}
{"pid": "P5432", "type": "P", "difficulty": 7, "samples": [["19260817\n114514", "873463809 93585408 943652865 "]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "倍增", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "A/B Problem（高精度除法Ⅱ）", "background": "", "description": "给你两个正整数 $a,b$，求 $\\lfloor a/b \\rfloor$。  \n为了卡掉一些乱搞做法，你需要对答案进行如下处理：  \n设答案为 $r$，构造一个多项式 $F(x)$：\n\n$$ F(x) = \\sum\\limits_{i=0}^{\\lfloor \\lg r \\rfloor} (\\lfloor 10^{-i}r \\rfloor \\bmod 10) \\cdot x^i$$\n\n简单地说，就是从 $r$ 的低位到高位，每一位对应 $F(x)$ 一项的系数。\n\n设 $F(x)$ 的最高非零次数为 $n$，你需要求出一个 $n$ 次多项式 $G(x)$，使得：  \n$$ F(x) \\cdot G(x) \\equiv 1 \\pmod{x^{n+1}}$$   \n将 $G(x)$ 的系数对 $998244353$ 取模，然后升幂输出 $G(x)$ 的系数即可。\n\n保证满足条件的 $G(x)$ 存在。", "inputFormat": "两行，每行一个正整数，分别为 $a$ 和 $b$。", "outputFormat": "输出一行 $n+1$ 个整数，为 $G(x)$ 的系数", "hint": "**【样例解释】**\n\n$\\left\\lfloor \\dfrac{19260817}{114514} \\right\\rfloor = 168$。\n\n由此构造出的多项式 $F(x)=x^2+6x+8$  \n求出来对应的 $G(x)$ 就是 $943652865x^2 + 93585408x +  873463809$。\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1\\le b \\le a \\le 10^{200000}$。", "locale": "zh-CN", "translations": {"en": {"title": "A/B Problem (High-Precision Division II)", "background": "", "description": "You are given two positive integers $a, b$. Find $\\lfloor a/b \\rfloor$.\n\nTo rule out some brute-force solutions, you must process the answer as follows.\n\nLet the answer be $r$, and construct a polynomial $F(x)$:\n\n$$ F(x) = \\sum\\limits_{i=0}^{\\lfloor \\lg r \\rfloor} (\\lfloor 10^{-i}r \\rfloor \\bmod 10) \\cdot x^i$$\n\nSimply put, from the lowest digit to the highest digit of $r$, each digit is used as the coefficient of one term of $F(x)$.\n\nLet the highest non-zero degree of $F(x)$ be $n$. You need to find a degree-$n$ polynomial $G(x)$ such that:\n\n$$ F(x) \\cdot G(x) \\equiv 1 \\pmod{x^{n+1}}$$\n\nTake the coefficients of $G(x)$ modulo $998244353$, then output the coefficients of $G(x)$ in increasing order of degree.\n\nIt is guaranteed that such a $G(x)$ exists.", "inputFormat": "Two lines, each containing one positive integer, which are $a$ and $b$, respectively.", "outputFormat": "Output one line with $n+1$ integers, the coefficients of $G(x)$.", "hint": "**Sample Explanation**\n\n$\\left\\lfloor \\dfrac{19260817}{114514} \\right\\rfloor = 168$.\n\nThe polynomial constructed is $F(x) = x^2 + 6x + 8$.\n\nThe corresponding $G(x)$ is $943652865x^2 + 93585408x + 873463809$.\n\n**Constraints**\n\nFor $100\\%$ of the testdata, $1 \\le b \\le a \\le 10^{200000}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "A/B Problem（高精度除法Ⅱ）", "background": "", "description": "给你两个正整数 $a,b$，求 $\\lfloor a/b \\rfloor$。  \n为了卡掉一些乱搞做法，你需要对答案进行如下处理：  \n设答案为 $r$，构造一个多项式 $F(x)$：\n\n$$ F(x) = \\sum\\limits_{i=0}^{\\lfloor \\lg r \\rfloor} (\\lfloor 10^{-i}r \\rfloor \\bmod 10) \\cdot x^i$$\n\n简单地说，就是从 $r$ 的低位到高位，每一位对应 $F(x)$ 一项的系数。\n\n设 $F(x)$ 的最高非零次数为 $n$，你需要求出一个 $n$ 次多项式 $G(x)$，使得：  \n$$ F(x) \\cdot G(x) \\equiv 1 \\pmod{x^{n+1}}$$   \n将 $G(x)$ 的系数对 $998244353$ 取模，然后升幂输出 $G(x)$ 的系数即可。\n\n保证满足条件的 $G(x)$ 存在。", "inputFormat": "两行，每行一个正整数，分别为 $a$ 和 $b$。", "outputFormat": "输出一行 $n+1$ 个整数，为 $G(x)$ 的系数", "hint": "**【样例解释】**\n\n$\\left\\lfloor \\dfrac{19260817}{114514} \\right\\rfloor = 168$。\n\n由此构造出的多项式 $F(x)=x^2+6x+8$  \n求出来对应的 $G(x)$ 就是 $943652865x^2 + 93585408x +  873463809$。\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1\\le b \\le a \\le 10^{200000}$。", "locale": "zh-CN"}}}
{"pid": "P5433", "type": "P", "difficulty": 6, "samples": [["1\naabacabaaa", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "月宫的符卡序列", "background": "![](https://cdn.luogu.com.cn/upload/pic/60728.png)\n", "description": "**update：重新构造了两组数据，数据已加强**\n\n辉夜原本是生活在月宫的月之公主\n\n辉夜在淸理永远亭的仓库时，发现了一个古老的符卡序列 $S$，可能是很久很久以前的辉夜仍生活在月宫时创造的，但现在的她已经回忆不起来了。\n\n于是辉夜便决定对这个符卡序列进行研究，$S$ 中的符卡从0开始标号，并且辉夜创造它时使用的卡组大小不超过26,因此符卡被表示成了字母 $a$ 到字母 $z$。\n\n辉夜对从左往右读和从右往左读都一样的序列很感兴趣，对于$S$的某个满足上述条件连续子序列$a$,其价值为$a$在$S$中的所有出现位罝中点（即若a出现在$l...r$，那么中点为$\\lfloor  \\frac{l+r}{2} \\rfloor $）的异或值。\n\n\n辉夜想知道对于所有满足条件的$a$，最大的价值是多少\n", "inputFormat": "第一行一个整数$num$($≤5$)，表示数据组数\n\n每组数据占一行，有一个仅有小写字母的字符串$S$，表示符卡序列", "outputFormat": "对于每组数据，输出一行，表示辉夜想知道的答案", "hint": "$1≤|S|≤10^6$", "locale": "zh-CN", "translations": {"en": {"title": "Spell Card Sequence of the Moon Palace", "background": "![](https://cdn.luogu.com.cn/upload/pic/60728.png)", "description": "**Update: Two sets of testdata have been rebuilt, and the testdata has been strengthened.**\n\nKaguya was originally a princess of the Moon who lived in the Moon Palace.\n\nWhen Kaguya was cleaning the warehouse of Eientei, she found an ancient spell card sequence $S$. It might have been created a very, very long time ago, when Kaguya still lived in the Moon Palace, but now she cannot remember it anymore.\n\nSo Kaguya decided to study this spell card sequence. The spell cards in $S$ are indexed starting from $0$. Also, when she created it, the deck size did not exceed $26$, so each spell card is represented by a letter from $a$ to $z$.\n\nKaguya is very interested in sequences that read the same from left to right and from right to left. For any contiguous subsequence $a$ of $S$ that satisfies the above condition, its value is defined as the XOR of the midpoints of all occurrences of $a$ in $S$ (that is, if $a$ occurs at $l...r$, then the midpoint is $\\lfloor \\frac{l+r}{2} \\rfloor$).\n\nKaguya wants to know, among all such $a$, what the maximum value is.", "inputFormat": "The first line contains an integer $num$ ($\\le 5$), indicating the number of test cases.\n\nEach test case consists of one line containing a string $S$ with only lowercase letters, representing the spell card sequence.", "outputFormat": "For each test case, output one line representing the answer Kaguya wants to know.", "hint": "$1 \\le |S| \\le 10^6$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "月宫的符卡序列", "background": "![](https://cdn.luogu.com.cn/upload/pic/60728.png)\n", "description": "**update：重新构造了两组数据，数据已加强**\n\n辉夜原本是生活在月宫的月之公主\n\n辉夜在淸理永远亭的仓库时，发现了一个古老的符卡序列 $S$，可能是很久很久以前的辉夜仍生活在月宫时创造的，但现在的她已经回忆不起来了。\n\n于是辉夜便决定对这个符卡序列进行研究，$S$ 中的符卡从0开始标号，并且辉夜创造它时使用的卡组大小不超过26,因此符卡被表示成了字母 $a$ 到字母 $z$。\n\n辉夜对从左往右读和从右往左读都一样的序列很感兴趣，对于$S$的某个满足上述条件连续子序列$a$,其价值为$a$在$S$中的所有出现位罝中点（即若a出现在$l...r$，那么中点为$\\lfloor  \\frac{l+r}{2} \\rfloor $）的异或值。\n\n\n辉夜想知道对于所有满足条件的$a$，最大的价值是多少\n", "inputFormat": "第一行一个整数$num$($≤5$)，表示数据组数\n\n每组数据占一行，有一个仅有小写字母的字符串$S$，表示符卡序列", "outputFormat": "对于每组数据，输出一行，表示辉夜想知道的答案", "hint": "$1≤|S|≤10^6$", "locale": "zh-CN"}}}
{"pid": "P5434", "type": "P", "difficulty": 7, "samples": [["3", "8"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "生成函数", "快速数论变换 NTT"], "title": "有标号荒漠计数", "background": "众所周知 仙人掌计数 是一种很简单的计数，所以我们要加强它.jpg", "description": "仙人掌是一张无向连通图，在一个仙人掌上，任意一条边至多只会出现在一个环上。同时，在本题定义的仙人掌中，仙人掌应当**无重边**、**无自环**。  \n荒漠是一张无向图，一个荒漠的每个极大连通分量都是一个仙人掌\n\n---\n给出一个整数 $n$ ，请求出有多少种不同的含有 $n$ 个点的荒漠。（点有标号）\n\n由于答案可能太大，您只需要将您的结果对 $998244353$ 取模后输出即可。", "inputFormat": "一行一个整数 $n$ 。", "outputFormat": "一行一个整数，为您的答案对 $998244353$ 取模的结果。", "hint": "对于样例，所有可能的情况如下：  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/onuzh6bn.png)\n\n可以发现，不存在更多的荒漠\n\n---\n对于 $30\\%$ 的数据： $n\\leqslant5000$  \n对于 $100\\%$ 的数据： $3\\leqslant n\\leqslant100000$", "locale": "zh-CN", "translations": {"en": {"title": "Counting Labeled Deserts", "background": "As everyone knows, counting cacti is a very easy counting problem, so we are going to make it harder.jpg.", "description": "A cactus is an undirected connected graph. In a cactus, any edge appears in at most one cycle. Also, in the cactus defined in this problem, the cactus must have **no multiple edges** and **no self-loops**.  \nA desert is an undirected graph in which every maximal connected component is a cactus.\n\n---\n\nGiven an integer $n$, find how many different deserts with $n$ vertices there are (the vertices are labeled).\n\nSince the answer may be very large, you only need to output it modulo $998244353$.", "inputFormat": "One line with one integer $n$.", "outputFormat": "One line with one integer, the answer modulo $998244353$.", "hint": "For the sample, all possible cases are as follows:  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/onuzh6bn.png)\n\nYou can see that there are no more deserts.\n\n---\n\nConstraints:  \nFor $30\\%$ of the testdata: $n\\leqslant5000$.  \nFor $100\\%$ of the testdata: $3\\leqslant n\\leqslant100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "有标号荒漠计数", "background": "众所周知 仙人掌计数 是一种很简单的计数，所以我们要加强它.jpg", "description": "仙人掌是一张无向连通图，在一个仙人掌上，任意一条边至多只会出现在一个环上。同时，在本题定义的仙人掌中，仙人掌应当**无重边**、**无自环**。  \n荒漠是一张无向图，一个荒漠的每个极大连通分量都是一个仙人掌\n\n---\n给出一个整数 $n$ ，请求出有多少种不同的含有 $n$ 个点的荒漠。（点有标号）\n\n由于答案可能太大，您只需要将您的结果对 $998244353$ 取模后输出即可。", "inputFormat": "一行一个整数 $n$ 。", "outputFormat": "一行一个整数，为您的答案对 $998244353$ 取模的结果。", "hint": "对于样例，所有可能的情况如下：  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/onuzh6bn.png)\n\n可以发现，不存在更多的荒漠\n\n---\n对于 $30\\%$ 的数据： $n\\leqslant5000$  \n对于 $100\\%$ 的数据： $3\\leqslant n\\leqslant100000$", "locale": "zh-CN"}}}
{"pid": "P5435", "type": "P", "difficulty": 6, "samples": [["5\n200 300 300 300 23333\n666 666 666 666 123456\n", "16\n564\n3636\n14328\n3905\n"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["数论", "O2优化", "最大公约数 gcd"], "title": "基于值域预处理的快速 GCD", "background": "", "description": "给定 $n$ 个正整数 $a_1,a_2,\\dots,a_n$，再给定 $n$ 个正整数 $b_1,b_2,\\dots,b_n$，你需要对每对 $(i,j)$ 求出 $a_i$ 与 $b_j$ 的最大公因数。\n\n不难发现你的输出应有 $n^2$ 个正整数。为了减少输出对程序的运行效率的影响，你只需要输出 $n$ 行，每行一个整数 $A_i$。\n\n其中对于 $i\\in[1,n]$，$A_i=\\sum_{j=1}^{n}i^j\\gcd(a_i,b_j)$。由于答案可能过大，你只需要输出模 $998,244,353$ 后的结果即可。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，表示 $a_1,a_2,\\dots,a_n$。\n\n第三行 $n$ 个正整数，表示 $b_1,b_2,\\dots,b_n$。", "outputFormat": "共 $n$ 行，第 $i$ 行应输出一个非负整数 $A_i$。意义见题目描述。", "hint": "对于 $20\\%$ 的数据，$1\\leqslant n\\leqslant 500$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 5000;1\\leqslant a_i,b_i\\leqslant 10^6$。\n\n**请注意常数因子对程序运行效率的影响**", "locale": "zh-CN", "translations": {"en": {"title": "Fast GCD Based on Value-Range Preprocessing", "background": "", "description": "Given $n$ positive integers $a_1,a_2,\\dots,a_n$, and another $n$ positive integers $b_1,b_2,\\dots,b_n$, you need to compute the greatest common divisor of $a_i$ and $b_j$ for every pair $(i,j)$.\n\nIt is not hard to see that the output should contain $n^2$ positive integers. To reduce the impact of output on the program’s running efficiency, you only need to output $n$ lines, with one integer $A_i$ per line.\n\nFor $i\\in[1,n]$, $A_i=\\sum_{j=1}^{n}i^j\\gcd(a_i,b_j)$. Since the answer may be too large, you only need to output the result modulo $998,244,353$.", "inputFormat": "The first line contains one positive integer $n$.\n\nThe second line contains $n$ positive integers, representing $a_1,a_2,\\dots,a_n$.\n\nThe third line contains $n$ positive integers, representing $b_1,b_2,\\dots,b_n$.", "outputFormat": "Output $n$ lines. The $i$-th line should contain one non-negative integer $A_i$. Its meaning is described in the statement.", "hint": "For $20\\%$ of the testdata, $1\\leqslant n\\leqslant 500$.\n\nFor $100\\%$ of the testdata, $1\\leqslant n\\leqslant 5000;1\\leqslant a_i,b_i\\leqslant 10^6$.\n\n**Please pay attention to the impact of constant factors on the program’s running efficiency.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基于值域预处理的快速 GCD", "background": "", "description": "给定 $n$ 个正整数 $a_1,a_2,\\dots,a_n$，再给定 $n$ 个正整数 $b_1,b_2,\\dots,b_n$，你需要对每对 $(i,j)$ 求出 $a_i$ 与 $b_j$ 的最大公因数。\n\n不难发现你的输出应有 $n^2$ 个正整数。为了减少输出对程序的运行效率的影响，你只需要输出 $n$ 行，每行一个整数 $A_i$。\n\n其中对于 $i\\in[1,n]$，$A_i=\\sum_{j=1}^{n}i^j\\gcd(a_i,b_j)$。由于答案可能过大，你只需要输出模 $998,244,353$ 后的结果即可。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，表示 $a_1,a_2,\\dots,a_n$。\n\n第三行 $n$ 个正整数，表示 $b_1,b_2,\\dots,b_n$。", "outputFormat": "共 $n$ 行，第 $i$ 行应输出一个非负整数 $A_i$。意义见题目描述。", "hint": "对于 $20\\%$ 的数据，$1\\leqslant n\\leqslant 500$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 5000;1\\leqslant a_i,b_i\\leqslant 10^6$。\n\n**请注意常数因子对程序运行效率的影响**", "locale": "zh-CN"}}}
{"pid": "P5436", "type": "P", "difficulty": 2, "samples": [["1\n3\n", "6\n"]], "limits": {"time": [1000, 1000], "memory": [512000, 512000]}, "tags": ["数学", "O2优化", "最大公约数 gcd"], "title": "【XR-2】缘分", "background": "> 世间万物都置身于缘分编织的大网中。缘分未到，虽历经千劫，却不能相遇。缘分到了，在草原上都能等到一艘船。——《一禅小和尚》", "description": "一禅希望知道他和师父之间的缘分大小。可是如何才能知道呢？\n\n一禅想了个办法，他先和师父约定一个正整数 $n$，接着他们各自在心里想一个不超过 $n$ 的正整数。\n\n一禅认为，他和师父心里想的这两个数的**最小公倍数**越大，则意味着他和师父之间的缘分越大。\n\n师父觉得这个办法很合适，不过他想知道这两个数的最小公倍数最大会是多少。\n\n师父的数学不太好，于是问一禅。一禅也觉得这个问题很困难，他希望你能告诉他答案。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来的 $T$ 行，每行一个正整数 $n$，表示一禅和师父约定的正整数。", "outputFormat": "对每组数据，一行一个正整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n不超过 $3$ 的两个正整数的最小公倍数的最大值为 $\\mathrm{lcm}(2,3) = 6$。\n\n【数据规模与约定】\n\n对 $50\\%$ 的数据，$1 \\le T,n \\le 100$。\n\n对 $100\\%$ 的数据，$1 \\le T \\le 100, 1 \\le n \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Fate", "background": "> All things in the world are within the great web woven by fate. If fate has not arrived, even after countless hardships, you still cannot meet. If fate has arrived, you can even wait for a ship on the grassland. — *Yi Chan, the Little Monk*", "description": "Yi Chan wants to know how strong the “fate” between him and his master is. But how can it be measured?\n\nYi Chan comes up with an idea. First, he and his master agree on a positive integer $n$. Then each of them silently thinks of a positive integer not greater than $n$.\n\nYi Chan believes that the larger the **least common multiple** of these two numbers is, the stronger the fate between him and his master is.\n\nHis master thinks this method is good, but he wants to know what the maximum possible least common multiple of the two numbers can be.\n\nHis master is not very good at math, so he asks Yi Chan. Yi Chan also finds this problem difficult, and he hopes you can tell him the answer.", "inputFormat": "**This problem contains multiple test cases.**\n\nThe first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain a positive integer $n$, the positive integer agreed upon by Yi Chan and his master.", "outputFormat": "For each test case, output one positive integer per line, the answer.", "hint": "[Sample $1$ Explanation]\n\nAmong two positive integers not greater than $3$, the maximum least common multiple is $\\mathrm{lcm}(2,3) = 6$.\n\n[Constraints]\n\nFor $50\\%$ of the testdata, $1 \\le T,n \\le 100$.\n\nFor $100\\%$ of the testdata, $1 \\le T \\le 100$, $1 \\le n \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】缘分", "background": "> 世间万物都置身于缘分编织的大网中。缘分未到，虽历经千劫，却不能相遇。缘分到了，在草原上都能等到一艘船。——《一禅小和尚》", "description": "一禅希望知道他和师父之间的缘分大小。可是如何才能知道呢？\n\n一禅想了个办法，他先和师父约定一个正整数 $n$，接着他们各自在心里想一个不超过 $n$ 的正整数。\n\n一禅认为，他和师父心里想的这两个数的**最小公倍数**越大，则意味着他和师父之间的缘分越大。\n\n师父觉得这个办法很合适，不过他想知道这两个数的最小公倍数最大会是多少。\n\n师父的数学不太好，于是问一禅。一禅也觉得这个问题很困难，他希望你能告诉他答案。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来的 $T$ 行，每行一个正整数 $n$，表示一禅和师父约定的正整数。", "outputFormat": "对每组数据，一行一个正整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n不超过 $3$ 的两个正整数的最小公倍数的最大值为 $\\mathrm{lcm}(2,3) = 6$。\n\n【数据规模与约定】\n\n对 $50\\%$ 的数据，$1 \\le T,n \\le 100$。\n\n对 $100\\%$ 的数据，$1 \\le T \\le 100, 1 \\le n \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5437", "type": "P", "difficulty": 6, "samples": [["3 1\n", "8\n"], ["4 3\n", "450\n"], ["1926 817\n", "984167516\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "生成树", "期望", "逆元"], "title": "【XR-2】约定", "background": ">「小圆，不要走！这一分离，我们何时才能重逢？」\n>\n>「小焰，我们一定还会相见的！在那之前，我们只是短暂的离别啊......」", "description": "只因为那一句约定，小焰开始了看不到尽头的等待。\n\n约定在小焰心中幻化成了一张 $n$ 个点的图。一开始，这是一张完全图，其中点的编号从 $1$ 到 $n$，连接点 $i,j$ 的边的权值为 $(i+j)^k$。\n\n然而等待的过程中，岁月也在逐渐消磨着她的信仰，因此图中的一些边被随机地删掉了。最终，图变成了一棵 $n$ 个点的树，永远地留在了小焰的心中。\n\n很久很久以后，小焰的魔力耗尽，在痛苦与绝望之中濒临崩溃。而就在这时，小圆终于来找小焰了。为了拯救自己唯一的朋友，她必须知道这棵树边权和的期望值对 $998244353$ 取模的结果是多少。\n\n你能帮小圆求出答案，让她完成那个约定吗？", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n这个完全图有 $3$ 个节点，$3$ 条边，形成了一个环。  \n这些边的权分别为：$3,4,5$   \n最后形成的树也有 $3$ 种可能，权值分别为：$7,8,9$  \n期望值为 $8$。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（5 points）：$1 \\le n \\le 5$，$1\\le k \\le 10$。     \nSubtask 2（11 points）：$k = 1$。  \nSubtask 3（11 points）：$1 \\le n,k \\le 20000$。  \nSubtask 4（13 points）：$1 \\le n,k \\le 10^5$。   \nSubtask 5（23 points）：$1 \\le k \\le 10^5$。  \nSubtask 6（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 998244352,1\\le k \\le 10^7$。\n****\n>「抱歉，让你久等了...... 你一直努力到了今天吧......」  \n>\n>「小圆......」\n>\n>「来，我们走吧。今后我们永不分离......」\n>\n>「是啊，我等这一刻——望眼欲穿。」", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Promise", "background": "> \"Xiaoyuan, don't go! After we part, when will we meet again?\"\n>\n> \"Xiaoyan, we will definitely see each other again! Before that, this is only a short farewell...\"", "description": "Just because of that promise, Xiaoyan began a wait with no end in sight.\n\nIn Xiaoyan's heart, the promise turned into a graph with $n$ vertices. At the beginning, it was a complete graph. The vertices are numbered from $1$ to $n$, and the weight of the edge connecting vertices $i, j$ is $(i+j)^k$.\n\nHowever, during the waiting, time was also slowly wearing away her faith, so some edges in the graph were randomly deleted. In the end, the graph became a tree with $n$ vertices, and stayed in Xiaoyan's heart forever.\n\nA very, very long time later, Xiaoyan's magic ran out, and she was on the verge of breaking down in pain and despair. Just then, Xiaoyuan finally came to find Xiaoyan. To save her only friend, she must know the result of the expected total edge weight of this tree modulo $998244353$.\n\nCan you help Xiaoyuan compute the answer, so she can fulfill that promise?", "inputFormat": "One line with two positive integers $n, k$.", "outputFormat": "One line with one integer, the value of the answer modulo $998244353$.", "hint": "[Sample $1$ Explanation]\n\nThis complete graph has $3$ nodes and $3$ edges, forming a cycle.  \nThe weights of these edges are: $3, 4, 5$.  \nIn the end, there are also $3$ possible trees, with total weights $7, 8, 9$.  \nThe expected value is $8$.\n\n[Constraints and Agreements]\n\n**This problem uses bundled testdata.**\n\nSubtask 1 (5 points): $1 \\le n \\le 5$, $1 \\le k \\le 10$.  \nSubtask 2 (11 points): $k = 1$.  \nSubtask 3 (11 points): $1 \\le n, k \\le 20000$.  \nSubtask 4 (13 points): $1 \\le n, k \\le 10^5$.  \nSubtask 5 (23 points): $1 \\le k \\le 10^5$.  \nSubtask 6 (37 points): no special constraints.\n\nFor $100\\%$ of the data, $1 \\le n \\le 998244352$, $1 \\le k \\le 10^7$.\n\n****\n> \"Sorry to have kept you waiting... You have worked so hard until today...\"\n>\n> \"Xiaoyuan...\"\n>\n> \"Come, let's go. From now on, we will never be apart...\"\n>\n> \"Yes. I have been waiting for this moment—so long it felt like forever.\"\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】约定", "background": ">「小圆，不要走！这一分离，我们何时才能重逢？」\n>\n>「小焰，我们一定还会相见的！在那之前，我们只是短暂的离别啊......」", "description": "只因为那一句约定，小焰开始了看不到尽头的等待。\n\n约定在小焰心中幻化成了一张 $n$ 个点的图。一开始，这是一张完全图，其中点的编号从 $1$ 到 $n$，连接点 $i,j$ 的边的权值为 $(i+j)^k$。\n\n然而等待的过程中，岁月也在逐渐消磨着她的信仰，因此图中的一些边被随机地删掉了。最终，图变成了一棵 $n$ 个点的树，永远地留在了小焰的心中。\n\n很久很久以后，小焰的魔力耗尽，在痛苦与绝望之中濒临崩溃。而就在这时，小圆终于来找小焰了。为了拯救自己唯一的朋友，她必须知道这棵树边权和的期望值对 $998244353$ 取模的结果是多少。\n\n你能帮小圆求出答案，让她完成那个约定吗？", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n这个完全图有 $3$ 个节点，$3$ 条边，形成了一个环。  \n这些边的权分别为：$3,4,5$   \n最后形成的树也有 $3$ 种可能，权值分别为：$7,8,9$  \n期望值为 $8$。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（5 points）：$1 \\le n \\le 5$，$1\\le k \\le 10$。     \nSubtask 2（11 points）：$k = 1$。  \nSubtask 3（11 points）：$1 \\le n,k \\le 20000$。  \nSubtask 4（13 points）：$1 \\le n,k \\le 10^5$。   \nSubtask 5（23 points）：$1 \\le k \\le 10^5$。  \nSubtask 6（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 998244352,1\\le k \\le 10^7$。\n****\n>「抱歉，让你久等了...... 你一直努力到了今天吧......」  \n>\n>「小圆......」\n>\n>「来，我们走吧。今后我们永不分离......」\n>\n>「是啊，我等这一刻——望眼欲穿。」", "locale": "zh-CN"}}}
{"pid": "P5438", "type": "P", "difficulty": 7, "samples": [["2 10\n", "2\n"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "素数判断,质数,筛法", "容斥原理"], "title": "【XR-2】记忆", "background": "> 过去就像攥在手中的一把干沙，自以为攥得很紧，其实早就从指缝中流光了。记忆是一条早已干涸的河流，只在毫无生气的河床中剩下零落的砾石。——刘慈欣 《三体》", "description": "你的记忆被歌者拿走了。\n\n临走前，歌者告诉你，你的记忆中有一个序列，而且这个序列是所有 $l \\le x \\le r$ 的整数 $x$ 形成的一个排列。\n\n歌者想了想，决定再告诉你一点信息：\n\n如果把一个序列的权值定义为这个序列中相邻两个数的乘积为完全平方数的数量，那么你记忆中的这个序列是所有 $l \\le x \\le r$ 的整数 $x$ 形成的排列中**权值最大**的排列。\n\n歌者希望你能够把你记忆中的这个序列的权值告诉他，他才会把属于你的记忆还给你。", "inputFormat": "一行两个正整数 $l,r$。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n一个满足权值为 $2$ 的排列为 $\\{8,2,4,9,3,10,7,5,6\\}$，其中 $8 \\times 2 = 16, 4 \\times 9=36$ 为完全平方数。这也是所有 $2 \\le x \\le 10$ 的整数 $x$ 形成的排列中权值最大的排列。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（3 points）：$r \\le 10$。  \nSubtask 2（7 points）：$r \\le 100$。  \nSubtask 3（15 points）：$r \\le 100000$。  \nSubtask 4（11 points）：$l = 1$。  \nSubtask 5（8 points）：$l \\le 10$。  \nSubtask 6（19 points）：$l \\le 1000000$。  \nSubtask 7（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le l \\le r \\le 10^{14}$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Memory", "background": "> The past is like a handful of dry sand clenched in your hand. You think you are holding it tightly, but it has already slipped away through the gaps between your fingers. Memory is a river that has long since dried up, leaving only scattered pebbles in a lifeless riverbed. — Liu Cixin, *The Three-Body Problem*.", "description": "Your memory was taken away by the Singer.\n\nBefore leaving, the Singer told you that there is a sequence in your memory, and this sequence is a permutation of all integers $x$ with $l \\le x \\le r$.\n\nAfter thinking for a moment, the Singer decided to tell you a bit more:\n\nIf we define the weight of a sequence as the number of adjacent pairs whose product is a perfect square, then the sequence in your memory is the permutation with the **maximum weight** among all permutations formed by the integers $x$ with $l \\le x \\le r$.\n\nThe Singer wants you to tell him the weight of the sequence in your memory. Only then will he return your memory to you.", "inputFormat": "One line containing two positive integers $l, r$.", "outputFormat": "One line containing one integer, which is the answer.", "hint": "[Sample $1$ Explanation]\n\nOne permutation with weight $2$ is $\\{8,2,4,9,3,10,7,5,6\\}$. In it, $8 \\times 2 = 16$ and $4 \\times 9 = 36$ are perfect squares. This is also the permutation with the maximum weight among all permutations formed by the integers $x$ with $2 \\le x \\le 10$.\n\n[Constraints]\n\n**This problem uses bundled tests.**\n\nSubtask 1 (3 points): $r \\le 10$.  \nSubtask 2 (7 points): $r \\le 100$.  \nSubtask 3 (15 points): $r \\le 100000$.  \nSubtask 4 (11 points): $l = 1$.  \nSubtask 5 (8 points): $l \\le 10$.  \nSubtask 6 (19 points): $l \\le 1000000$.  \nSubtask 7 (37 points): no special restrictions.\n\nFor $100\\%$ of the testdata, $1 \\le l \\le r \\le 10^{14}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】记忆", "background": "> 过去就像攥在手中的一把干沙，自以为攥得很紧，其实早就从指缝中流光了。记忆是一条早已干涸的河流，只在毫无生气的河床中剩下零落的砾石。——刘慈欣 《三体》", "description": "你的记忆被歌者拿走了。\n\n临走前，歌者告诉你，你的记忆中有一个序列，而且这个序列是所有 $l \\le x \\le r$ 的整数 $x$ 形成的一个排列。\n\n歌者想了想，决定再告诉你一点信息：\n\n如果把一个序列的权值定义为这个序列中相邻两个数的乘积为完全平方数的数量，那么你记忆中的这个序列是所有 $l \\le x \\le r$ 的整数 $x$ 形成的排列中**权值最大**的排列。\n\n歌者希望你能够把你记忆中的这个序列的权值告诉他，他才会把属于你的记忆还给你。", "inputFormat": "一行两个正整数 $l,r$。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n一个满足权值为 $2$ 的排列为 $\\{8,2,4,9,3,10,7,5,6\\}$，其中 $8 \\times 2 = 16, 4 \\times 9=36$ 为完全平方数。这也是所有 $2 \\le x \\le 10$ 的整数 $x$ 形成的排列中权值最大的排列。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（3 points）：$r \\le 10$。  \nSubtask 2（7 points）：$r \\le 100$。  \nSubtask 3（15 points）：$r \\le 100000$。  \nSubtask 4（11 points）：$l = 1$。  \nSubtask 5（8 points）：$l \\le 10$。  \nSubtask 6（19 points）：$l \\le 1000000$。  \nSubtask 7（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le l \\le r \\le 10^{14}$。", "locale": "zh-CN"}}}
{"pid": "P5439", "type": "P", "difficulty": 7, "samples": [["3 17\n2 0 2\n0 1 2 3 4 5 6 7 8 4 10 11 12 3 14 15 16\n0mayqueenkingrket\n9 13 17\n", "12\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 3000, 3000, 3000, 3000, 4000, 4000, 4000, 4000, 4000, 4000, 3000, 3000, 3000, 3000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["点分治", "O2优化", "虚树"], "title": "【XR-2】永恒", "background": "> 我一直认为这世界没有永恒，如果非要说永恒，宇宙间唯一的永恒就是——所有的一切都会随着时光消失。——梧桐《那片星空，那片海》", "description": "有一棵 $n$ 个点的永恒的树，树中每个点 $x(1 \\le x \\le n)$ 上都有一个永恒的字符串 $S(x)$。\n\n但这世界没有永恒，所有的一切都会随着时光消失。我们只能给每个所谓永恒的东西定义一个永恒值 $f$。这个值本身没有意义，只是一个象征罢了。\n\n- 一个字符串 $S$ 的永恒值 $f(S)$ 定义为它的长度 $\\mathrm{Len}(S)$，即：\n\n$$f(S) = \\mathrm{Len}(S)$$\n\n- 树上的一条无向路径 $K = [u, v](u < v)$ 指的是 $u,v$ 之间的简单路径（包括 $u, v$），其永恒值 $f(K)$ 定义为路径上所有不同的无序点对 $(x, y)(x \\in K, y \\in K, x < y)$ 上的字符串 $S(x), S(y)$ 的最长公共前缀 $\\mathrm{LCP}(S(x), S(y))$ 的永恒值 $f(\\mathrm{LCP}(S(x), S(y)))$ 之和，即：\n\n$$f(K) = \\sum_{x \\in K, y \\in K, x < y} f(\\mathrm{LCP}(S(x), S(y)))$$\n\n- 一棵树 $T$ 的永恒值 $f(T)$ 定义为树上所有的无向路径 $[u, v](u \\in T, v \\in T, u < v)$ 的永恒值之和，即：\n\n$$f(T) = \\sum_{u \\in T, v \\in T, u < v} f([u,v])$$\n\n特别的是，树中每个点上的字符串都来自一棵永恒的以点 $1$ 为根的 Trie 树，即每个树中的点都对应着一个 Trie 树中的点，点上的字符串就是 Trie 树中从根节点到其对应的点形成的字符串。\n\n你需要求出这棵树的永恒值，答案对 $998244353$ 取模。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示树的节点数和 Trie 树的节点数。\n\n第二行包含 $n$ 个非负整数，第 $i$ 个数为 $a_i$，表示点 $i$ 在树上的父亲节点为 $a_i$，对于树的根节点 $root$，保证 $a_{root} = 0$。\n\n第三行包含 $m$ 个非负整数，第 $i$ 个数为 $b_i$，表示点 $i$ 在 Trie 树上的父亲节点为 $b_i$，保证 $b_i < i$，$b_1=0$。\n\n第四行为一个由 $m$ 个字符构成的字符串，第 $i$ 个字符 $c_i$ 表示 Trie 树上点 $i$ 与它的父亲节点 $b_i$ 之间的边所代表的字符，保证 $c_1=\\texttt{0}$，$c_i(2 \\le i \\le m)\\in[\\texttt{a},\\texttt{z}]$。\n\n第五行包含 $n$ 个正整数 $d_i$，表示树上的点 $i$ 对应着 Trie 树上的点 $d_i$，保证 $2 \\le d_i \\le m$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n所有的 $S(x)$ 为：\n\n$S(1) = \\texttt{\"mayqueen\"}$\n\n$S(2) = \\texttt{\"mayking\"}$\n\n$S(3) = \\texttt{\"market\"}$\n\n所有的 $f(\\mathrm{LCP}(S(x), S(y)))$ 为：\n\n$f(\\mathrm{LCP}(S(1), S(2))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"mayking\"})) = f(\\texttt{\"may\"}) = \\mathrm{Len}(\\texttt{\"may\"}) = 3$\n\n$f(\\mathrm{LCP}(S(1), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n$f(\\mathrm{LCP}(S(2), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayking\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n所有的 $f([u, v])$ 为：\n\n$f([1,2]) = f(\\mathrm{LCP}(S(1), S(2))) = 3$\n\n$f([1,3]) = f(\\mathrm{LCP}(S(1), S(2))) + f(\\mathrm{LCP}(S(1), S(3))) + f(\\mathrm{LCP}(S(2), S(3))) = 3 + 2 + 2 = 7$\n\n$f([2,3]) = f(\\mathrm{LCP}(S(2), S(3))) = 2$\n\n所以：\n\n$f(T) = f([1,2]) + f([2,3]) + f([1,3]) = 3 + 7 + 2 = 12$\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（3 points）：$n, m \\le 10$，时限 1s。  \nSubtask 2（5 points）：$n, m \\le 100$，时限 1s。  \nSubtask 3（9 points）：$n, m \\le 1000$，时限 1s。  \nSubtask 4（7 points）：$n, m \\le 5000$，时限 2s。  \nSubtask 5（9 points）：$n, m \\le 20000$，时限 3s。  \nSubtask 6（11 points）：$n, m \\le 10^5$，时限 4s。  \nSubtask 7（19 points）：$m=2$，时限 3s。  \nSubtask 8（37 points）：无特殊限制，时限 10s。\n\n对于 $100\\%$ 的数据，$2 \\le n,m \\le 3\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Eternity", "background": "> I have always believed that there is no eternity in this world. If I must talk about eternity, the only eternity in the universe is that everything will disappear with time. — Wutong, *That Starry Sky, That Sea*.", "description": "There is an eternal tree with $n$ nodes. Each node $x(1 \\le x \\le n)$ has an eternal string $S(x)$.\n\nBut there is no eternity in this world. Everything will disappear with time. We can only define an “eternity value” $f$ for each so-called eternal thing. This value itself has no real meaning; it is just a symbol.\n\n- The eternity value $f(S)$ of a string $S$ is defined as its length $\\mathrm{Len}(S)$, i.e.:\n\n$$f(S) = \\mathrm{Len}(S)$$\n\n- An undirected path in the tree $K = [u, v](u < v)$ means the simple path between $u$ and $v$ (including $u$ and $v$). Its eternity value $f(K)$ is defined as the sum, over all distinct unordered pairs of nodes $(x, y)(x \\in K, y \\in K, x < y)$ on the path, of the eternity value $f(\\mathrm{LCP}(S(x), S(y)))$ of the longest common prefix $\\mathrm{LCP}(S(x), S(y))$ of the strings $S(x)$ and $S(y)$, i.e.:\n\n$$f(K) = \\sum_{x \\in K, y \\in K, x < y} f(\\mathrm{LCP}(S(x), S(y)))$$\n\n- The eternity value $f(T)$ of a tree $T$ is defined as the sum of the eternity values of all undirected paths $[u, v](u \\in T, v \\in T, u < v)$ in the tree, i.e.:\n\n$$f(T) = \\sum_{u \\in T, v \\in T, u < v} f([u,v])$$\n\nIn particular, the string on each node of the tree comes from an eternal Trie rooted at node $1$. That is, each node in the tree corresponds to a node in the Trie, and the string on that node is the string formed along the path from the Trie root to its corresponding node.\n\nYou need to compute the eternity value of this tree. Take the answer modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n, m$, denoting the number of nodes in the tree and the number of nodes in the Trie, respectively.\n\nThe second line contains $n$ non-negative integers. The $i$-th number is $a_i$, meaning that the parent of node $i$ in the tree is $a_i$. For the root node $root$, it is guaranteed that $a_{root} = 0$.\n\nThe third line contains $m$ non-negative integers. The $i$-th number is $b_i$, meaning that the parent of node $i$ in the Trie is $b_i$. It is guaranteed that $b_i < i$ and $b_1 = 0$.\n\nThe fourth line is a string of $m$ characters. The $i$-th character $c_i$ represents the character on the edge between Trie node $i$ and its parent node $b_i$. It is guaranteed that $c_1=\\texttt{0}$ and $c_i(2 \\le i \\le m)\\in[\\texttt{a},\\texttt{z}]$.\n\nThe fifth line contains $n$ positive integers $d_i$, meaning that node $i$ in the tree corresponds to node $d_i$ in the Trie. It is guaranteed that $2 \\le d_i \\le m$.", "outputFormat": "Output one integer: the answer modulo $998244353$.", "hint": "[Sample $1$ Explanation]\n\nAll $S(x)$ are:\n\n$S(1) = \\texttt{\"mayqueen\"}$\n\n$S(2) = \\texttt{\"mayking\"}$\n\n$S(3) = \\texttt{\"market\"}$\n\nAll $f(\\mathrm{LCP}(S(x), S(y)))$ are:\n\n$f(\\mathrm{LCP}(S(1), S(2))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"mayking\"})) = f(\\texttt{\"may\"}) = \\mathrm{Len}(\\texttt{\"may\"}) = 3$\n\n$f(\\mathrm{LCP}(S(1), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n$f(\\mathrm{LCP}(S(2), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayking\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\nAll $f([u, v])$ are:\n\n$f([1,2]) = f(\\mathrm{LCP}(S(1), S(2))) = 3$\n\n$f([1,3]) = f(\\mathrm{LCP}(S(1), S(2))) + f(\\mathrm{LCP}(S(1), S(3))) + f(\\mathrm{LCP}(S(2), S(3))) = 3 + 2 + 2 = 7$\n\n$f([2,3]) = f(\\mathrm{LCP}(S(2), S(3))) = 2$\n\nTherefore:\n\n$f(T) = f([1,2]) + f([2,3]) + f([1,3]) = 3 + 7 + 2 = 12$\n\n[Constraints and Conventions]\n\n**This problem uses bundled testdata.**\n\nSubtask 1 (3 points): $n, m \\le 10$, time limit 1s.  \nSubtask 2 (5 points): $n, m \\le 100$, time limit 1s.  \nSubtask 3 (9 points): $n, m \\le 1000$, time limit 1s.  \nSubtask 4 (7 points): $n, m \\le 5000$, time limit 2s.  \nSubtask 5 (9 points): $n, m \\le 20000$, time limit 3s.  \nSubtask 6 (11 points): $n, m \\le 10^5$, time limit 4s.  \nSubtask 7 (19 points): $m = 2$, time limit 3s.  \nSubtask 8 (37 points): no special restrictions, time limit 10s.\n\nFor $100\\%$ of the testdata, $2 \\le n, m \\le 3\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】永恒", "background": "> 我一直认为这世界没有永恒，如果非要说永恒，宇宙间唯一的永恒就是——所有的一切都会随着时光消失。——梧桐《那片星空，那片海》", "description": "有一棵 $n$ 个点的永恒的树，树中每个点 $x(1 \\le x \\le n)$ 上都有一个永恒的字符串 $S(x)$。\n\n但这世界没有永恒，所有的一切都会随着时光消失。我们只能给每个所谓永恒的东西定义一个永恒值 $f$。这个值本身没有意义，只是一个象征罢了。\n\n- 一个字符串 $S$ 的永恒值 $f(S)$ 定义为它的长度 $\\mathrm{Len}(S)$，即：\n\n$$f(S) = \\mathrm{Len}(S)$$\n\n- 树上的一条无向路径 $K = [u, v](u < v)$ 指的是 $u,v$ 之间的简单路径（包括 $u, v$），其永恒值 $f(K)$ 定义为路径上所有不同的无序点对 $(x, y)(x \\in K, y \\in K, x < y)$ 上的字符串 $S(x), S(y)$ 的最长公共前缀 $\\mathrm{LCP}(S(x), S(y))$ 的永恒值 $f(\\mathrm{LCP}(S(x), S(y)))$ 之和，即：\n\n$$f(K) = \\sum_{x \\in K, y \\in K, x < y} f(\\mathrm{LCP}(S(x), S(y)))$$\n\n- 一棵树 $T$ 的永恒值 $f(T)$ 定义为树上所有的无向路径 $[u, v](u \\in T, v \\in T, u < v)$ 的永恒值之和，即：\n\n$$f(T) = \\sum_{u \\in T, v \\in T, u < v} f([u,v])$$\n\n特别的是，树中每个点上的字符串都来自一棵永恒的以点 $1$ 为根的 Trie 树，即每个树中的点都对应着一个 Trie 树中的点，点上的字符串就是 Trie 树中从根节点到其对应的点形成的字符串。\n\n你需要求出这棵树的永恒值，答案对 $998244353$ 取模。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示树的节点数和 Trie 树的节点数。\n\n第二行包含 $n$ 个非负整数，第 $i$ 个数为 $a_i$，表示点 $i$ 在树上的父亲节点为 $a_i$，对于树的根节点 $root$，保证 $a_{root} = 0$。\n\n第三行包含 $m$ 个非负整数，第 $i$ 个数为 $b_i$，表示点 $i$ 在 Trie 树上的父亲节点为 $b_i$，保证 $b_i < i$，$b_1=0$。\n\n第四行为一个由 $m$ 个字符构成的字符串，第 $i$ 个字符 $c_i$ 表示 Trie 树上点 $i$ 与它的父亲节点 $b_i$ 之间的边所代表的字符，保证 $c_1=\\texttt{0}$，$c_i(2 \\le i \\le m)\\in[\\texttt{a},\\texttt{z}]$。\n\n第五行包含 $n$ 个正整数 $d_i$，表示树上的点 $i$ 对应着 Trie 树上的点 $d_i$，保证 $2 \\le d_i \\le m$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n所有的 $S(x)$ 为：\n\n$S(1) = \\texttt{\"mayqueen\"}$\n\n$S(2) = \\texttt{\"mayking\"}$\n\n$S(3) = \\texttt{\"market\"}$\n\n所有的 $f(\\mathrm{LCP}(S(x), S(y)))$ 为：\n\n$f(\\mathrm{LCP}(S(1), S(2))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"mayking\"})) = f(\\texttt{\"may\"}) = \\mathrm{Len}(\\texttt{\"may\"}) = 3$\n\n$f(\\mathrm{LCP}(S(1), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n$f(\\mathrm{LCP}(S(2), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayking\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n所有的 $f([u, v])$ 为：\n\n$f([1,2]) = f(\\mathrm{LCP}(S(1), S(2))) = 3$\n\n$f([1,3]) = f(\\mathrm{LCP}(S(1), S(2))) + f(\\mathrm{LCP}(S(1), S(3))) + f(\\mathrm{LCP}(S(2), S(3))) = 3 + 2 + 2 = 7$\n\n$f([2,3]) = f(\\mathrm{LCP}(S(2), S(3))) = 2$\n\n所以：\n\n$f(T) = f([1,2]) + f([2,3]) + f([1,3]) = 3 + 7 + 2 = 12$\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（3 points）：$n, m \\le 10$，时限 1s。  \nSubtask 2（5 points）：$n, m \\le 100$，时限 1s。  \nSubtask 3（9 points）：$n, m \\le 1000$，时限 1s。  \nSubtask 4（7 points）：$n, m \\le 5000$，时限 2s。  \nSubtask 5（9 points）：$n, m \\le 20000$，时限 3s。  \nSubtask 6（11 points）：$n, m \\le 10^5$，时限 4s。  \nSubtask 7（19 points）：$m=2$，时限 3s。  \nSubtask 8（37 points）：无特殊限制，时限 10s。\n\n对于 $100\\%$ 的数据，$2 \\le n,m \\le 3\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5440", "type": "P", "difficulty": 3, "samples": [["2\n53-7-3-7\n20190629\n", "6\n0\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["搜索", "O2优化", "剪枝", "素数判断,质数,筛法"], "title": "【XR-2】奇迹", "background": "> 相信奇迹的人，本身就和奇迹一样了不起。——笛亚 《星游记》", "description": "我们称一个**日期**为一个八位数，第 $1\\sim 4$ 位构成年，第 $5\\sim 6$ 位构成月，第 $7\\sim 8$ 位构成日，不足位数用 $0$ 补足。同时，要求日期所代表的这一天真实存在，且年的范围为 $1\\sim 9999$。\n\n出现奇迹的日期都存在相同的特点：由“日”组成的两位数，由“月+日”组成的四位数，由“年+月+日”组成的八位数均为**质数**。但并不是所有存在这样特点的日期都一定会出现奇迹。\n\n现在，你得到了一个可能会出现奇迹的日期，然而不幸的是这个日期却是残缺的，八位中可能有若干位无法确定。你需要知道这个日期有多少种可能，这样你才能做好充足的准备去迎接奇迹的到来。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来的 $T$ 行，每行一个八位字符串。其中第 $i$ 位如果为 `-`，则表示日期的第 $i$ 位无法确定，否则表示日期的第 $i$ 位为字符串中第 $i$ 位上的数字。", "outputFormat": "对每组数据，一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n`53-7-3-7` 的 $6$ 种可能的日期如下：\n\n```plain\n53070307\n53070317\n53170307\n53370307\n53570317\n53770307\n```\n\n【数据规模与约定】\n\n一共 $10$ 个测试点，记 $c$ 为八位字符串中 `-` 的个数。\n\n对前 $9$ 个测试点，在第 $i$ 个测试点中保证 $c = i - 1$。\n\n对 $100\\%$ 的数据保证 $1 \\le T \\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Miracle", "background": "> Those who believe in miracles are, themselves, as amazing as miracles. — Diya, *Star Odyssey*.", "description": "We define a **date** as an 8-digit number. Digits $1 \\sim 4$ form the year, digits $5 \\sim 6$ form the month, and digits $7 \\sim 8$ form the day. If a part has fewer digits, it is padded with $0$. Also, the day represented by the date must really exist, and the year ranges from $1 \\sim 9999$.\n\nAll miracle dates share the same property: the 2-digit number formed by the “day”, the 4-digit number formed by “month + day”, and the 8-digit number formed by “year + month + day” are all **prime numbers**. However, not every date with this property will necessarily have a miracle.\n\nNow you are given a date that may have a miracle, but unfortunately this date is incomplete: among the 8 digits, some digits may be unknown. You need to determine how many possible dates it could be, so that you can be fully prepared to welcome the miracle.", "inputFormat": "**This problem has multiple test cases.**\n\nThe first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain an 8-character string. If the $i$-th character is `-`, it means the $i$-th digit of the date is unknown; otherwise, it means the $i$-th digit of the date is the digit at position $i$ in the string.", "outputFormat": "For each test case, output one integer per line, representing the answer.", "hint": "[Sample $1$ Explanation]\n\nThe 6 possible dates for `53-7-3-7` are:\n\n```plain\n53070307\n53070317\n53170307\n53370307\n53570317\n53770307\n```\n\n[Constraints]\n\nThere are $10$ test points in total. Let $c$ be the number of `-` characters in the 8-character string.\n\nFor the first $9$ test points, in the $i$-th test point it is guaranteed that $c = i - 1$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le T \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】奇迹", "background": "> 相信奇迹的人，本身就和奇迹一样了不起。——笛亚 《星游记》", "description": "我们称一个**日期**为一个八位数，第 $1\\sim 4$ 位构成年，第 $5\\sim 6$ 位构成月，第 $7\\sim 8$ 位构成日，不足位数用 $0$ 补足。同时，要求日期所代表的这一天真实存在，且年的范围为 $1\\sim 9999$。\n\n出现奇迹的日期都存在相同的特点：由“日”组成的两位数，由“月+日”组成的四位数，由“年+月+日”组成的八位数均为**质数**。但并不是所有存在这样特点的日期都一定会出现奇迹。\n\n现在，你得到了一个可能会出现奇迹的日期，然而不幸的是这个日期却是残缺的，八位中可能有若干位无法确定。你需要知道这个日期有多少种可能，这样你才能做好充足的准备去迎接奇迹的到来。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来的 $T$ 行，每行一个八位字符串。其中第 $i$ 位如果为 `-`，则表示日期的第 $i$ 位无法确定，否则表示日期的第 $i$ 位为字符串中第 $i$ 位上的数字。", "outputFormat": "对每组数据，一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n`53-7-3-7` 的 $6$ 种可能的日期如下：\n\n```plain\n53070307\n53070317\n53170307\n53370307\n53570317\n53770307\n```\n\n【数据规模与约定】\n\n一共 $10$ 个测试点，记 $c$ 为八位字符串中 `-` 的个数。\n\n对前 $9$ 个测试点，在第 $i$ 个测试点中保证 $c = i - 1$。\n\n对 $100\\%$ 的数据保证 $1 \\le T \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P5441", "type": "P", "difficulty": 6, "samples": [["3\n", "0\n0 1 1\n0 0 1\n0 1 0\n"], ["5\n", "5\n0 1 0 1 1\n0 0 1 1 0\n1 0 0 0 1\n1 0 1 0 1\n1 1 0 0 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "Special Judge", "O2优化", "组合数学", "构造"], "title": "【XR-2】伤痕", "background": "> 长日尽处，我来到你的面前，你将看见我的伤痕，你会知晓我曾受伤，也曾痊愈。——泰戈尔《深爱你这城》", "description": "X 国经历了一场前所未有的大地震，人们伤痕累累，整个国家破碎不堪。\n\n为了帮助人们痊愈，也为了让 X 国能够生存下去，X 国国王决定重建 X 国。\n\n国王决定先建造 $n$ 座城市，由于国王喜欢奇数，所以 $n$ 为奇数。\n\n城市建造完后，需要给每两座城市之间都修建一条道路，即一共需要修建 $\\frac{n(n-1)}{2}$ 条道路。\n\n不过，修建双向道路的成本太高了，建造完 $n$ 座城市后剩下的经费最多只够修建 $n$ 条双向道路，而其余的道路只能修建成单向的。好在方向并不会影响修建单向道路所需的费用，因此所有单向道路的方向可以任意决定。\n\n另外，等到重建完成后，国王决定将 $4$ 座城市钦定为 X 国的核心城市。为促进 X 国的发展，这 $4$ 座核心城市中的任意两座城市，必须能够在不经过非核心城市的情况下相互到达。\n\n国王希望，你能够给他一种道路修建方案，使重建完成后选择 $4$ 座核心城市的方案数最大化。", "inputFormat": "一行一个正整数 $n(1 \\le n \\le 99)$，保证 $n$ 为奇数，表示有 $n$ 座城市。", "outputFormat": "第一行包含一个整数，表示最大的选择 $4$ 座核心城市的方案数。\n\n接下来的 $n$ 行每行 $n$ 个正整数描述一个邻接矩阵，表示你的道路修建方案。\n\n具体来说，第 $i$ 行的第 $j$ 个数为 $1$ 表示第 $i$ 座城市可以通过一条道路到达第 $j$ 座城市，为 $0$ 表示第 $i$ 座城市无法通过一条道路到达第 $j$ 座城市。我们分为 $3$ 种情况详细说明：\n\n1. $i, j$ 之前的道路为一条 $i$ 到 $j$ 的单向道路，则邻接矩阵的第 $i$ 行第 $j$ 个数为 $1$，第 $j$ 行第 $i$ 个数为 $0$。\n2. $i, j$ 之间的道路为一条双向道路，则邻接矩阵的第 $i$ 行第 $j$ 个数和第 $j$ 行第 $i$ 个数均为 $1$，你需要保证最多修建 $n$ 条双向道路。\n3. $i = j$，则第 $i$ 行第 $j$ 个数（第 $j$ 行第 $i$ 个数）为 $0$。", "hint": "【样例 $1$ 说明】\n\n由于一共只有 $3$ 个点，所以选择 $4$ 座核心城市的方案数一定为 $0$，那么只需要保证修建方案满足条件即可。\n\n【样例 $2$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/pic/60711.png)\n\n显然，在 $5$ 个点中任意选 $4$ 个点，都满足核心城市的条件，因此方案数最大为 $5$。\n\n【数据规模与约定】\n\n本题一共有 $50$ 个测试点，每个测试点 $2$ 分。对于第 $i$ 个测试点，$n = 2i - 1$。\n\n对于每个测试点，有五种可能的结果：\n\n1. 输出格式错误，包括：没有输出最大方案数、没有输出邻接矩阵、输出了多余的信息等。你将无法得到该测试点的任何分数，同时我们无法确定 Special Judge 的返回结果。\n2. 没有正确计算最大方案数，即使构造的道路修建方案是正确的。你将得到该测试点 $0\\%$ 的分数（即 $0$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is wrong.”\n3. 正确计算了最大方案数，但是构造的道路修建方案不满足条件，包括：邻接矩阵中有不为 $0$ 或 $1$ 的数、有自环、有两座城市中没有道路、有多于 $n$ 条双向道路等。你将得到该测试点 $50\\%$ 的分数（即 $1$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is correct, but your plan breaks the rules.”\n4. 正确计算了最大方案数，构造的道路修建方案满足条件但没有将选择 $4$ 座核心城市的方案数最大化。你将得到该测试点 $50\\%$ 的分数（即 $1$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is correct, but your plan is wrong.”\n5. 正确计算了最大方案数，同时正确构造了道路修建方案。你将得到该测试点 $100\\%$ 的分数（即 $2$ 分），Special Judge 将会返回 AC 的结果，同时输出 “The answer is correct.”", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Scars.", "background": "> At the end of a long day, I come before you. You will see my scars. You will know that I was once hurt, and that I have also healed. — Tagore, *Love This City Deeply*.", "description": "Country X has suffered an unprecedented earthquake. People are covered in scars, and the whole country is shattered.\n\nTo help people heal, and also to allow Country X to survive, the King of Country X decides to rebuild the country.\n\nThe King decides to first build $n$ cities. Since the King likes odd numbers, $n$ is odd.\n\nAfter the cities are built, a road must be built between every pair of cities, i.e., a total of $\\frac{n(n-1)}{2}$ roads.\n\nHowever, the cost of building bidirectional roads is too high. After building $n$ cities, the remaining budget is enough to build at most $n$ bidirectional roads, and all other roads can only be built as one-way roads. Fortunately, the direction does not affect the cost of building a one-way road, so the directions of all one-way roads can be chosen arbitrarily.\n\nIn addition, after the rebuilding is completed, the King will designate $4$ cities as the core cities of Country X. To promote the development of Country X, for any two of these $4$ core cities, they must be able to reach each other without passing through non-core cities.\n\nThe King hopes that you can provide him with a road construction plan such that, after the rebuilding is completed, the number of ways to choose $4$ core cities is maximized.", "inputFormat": "One line containing a positive integer $n(1 \\le n \\le 99)$, guaranteed that $n$ is odd, meaning there are $n$ cities.", "outputFormat": "The first line contains an integer, representing the maximum number of ways to choose $4$ core cities.\n\nThe next $n$ lines each contain $n$ positive integers describing an adjacency matrix, representing your road construction plan.\n\nSpecifically, the $j$-th number in the $i$-th line is $1$ if city $i$ can reach city $j$ via a road, and $0$ if city $i$ cannot reach city $j$ via a road. We explain in detail in $3$ cases:\n\n1. If the road between $i$ and $j$ is a one-way road from $i$ to $j$, then the number in row $i$, column $j$ of the adjacency matrix is $1$, and the number in row $j$, column $i$ is $0$.\n2. If the road between $i$ and $j$ is a bidirectional road, then both the number in row $i$, column $j$ and the number in row $j$, column $i$ are $1$. You must ensure that at most $n$ bidirectional roads are built.\n3. If $i = j$, then the number in row $i$, column $j$ (the number in row $j$, column $i$) is $0$.", "hint": "[Sample $1$ Explanation]\n\nSince there are only $3$ points in total, the number of ways to choose $4$ core cities must be $0$. So you only need to ensure that the construction plan satisfies the requirements.\n\n[Sample $2$ Explanation]\n\n![](https://cdn.luogu.com.cn/upload/pic/60711.png)\n\nObviously, among $5$ points, choosing any $4$ points satisfies the core-city condition, so the maximum number of ways is $5$.\n\n[Constraints]\n\nThis problem has $50$ test points, each worth $2$ points. For the $i$-th test point, $n = 2i - 1$.\n\nFor each test point, there are five possible outcomes:\n\n1. Output format error, including: not outputting the maximum number of ways, not outputting the adjacency matrix, outputting extra information, etc. You will not get any points for this test point, and we cannot determine the return result of the Special Judge.\n2. The maximum number of ways is not computed correctly, even if the constructed road plan is correct. You will get $0\\%$ of the score for this test point (i.e., $0$ points). The Special Judge will return WA and output “The answer is wrong.”\n3. The maximum number of ways is computed correctly, but the constructed road plan does not satisfy the requirements, including: numbers in the adjacency matrix that are not $0$ or $1$, self-loops, a pair of cities with no road between them, more than $n$ bidirectional roads, etc. You will get $50\\%$ of the score for this test point (i.e., $1$ point). The Special Judge will return WA and output “The answer is correct, but your plan breaks the rules.”\n4. The maximum number of ways is computed correctly, and the constructed road plan satisfies the requirements, but the number of ways to choose $4$ core cities is not maximized. You will get $50\\%$ of the score for this test point (i.e., $1$ point). The Special Judge will return WA and output “The answer is correct, but your plan is wrong.”\n5. The maximum number of ways is computed correctly, and the road construction plan is also constructed correctly. You will get $100\\%$ of the score for this test point (i.e., $2$ points). The Special Judge will return AC and output “The answer is correct.”\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】伤痕", "background": "> 长日尽处，我来到你的面前，你将看见我的伤痕，你会知晓我曾受伤，也曾痊愈。——泰戈尔《深爱你这城》", "description": "X 国经历了一场前所未有的大地震，人们伤痕累累，整个国家破碎不堪。\n\n为了帮助人们痊愈，也为了让 X 国能够生存下去，X 国国王决定重建 X 国。\n\n国王决定先建造 $n$ 座城市，由于国王喜欢奇数，所以 $n$ 为奇数。\n\n城市建造完后，需要给每两座城市之间都修建一条道路，即一共需要修建 $\\frac{n(n-1)}{2}$ 条道路。\n\n不过，修建双向道路的成本太高了，建造完 $n$ 座城市后剩下的经费最多只够修建 $n$ 条双向道路，而其余的道路只能修建成单向的。好在方向并不会影响修建单向道路所需的费用，因此所有单向道路的方向可以任意决定。\n\n另外，等到重建完成后，国王决定将 $4$ 座城市钦定为 X 国的核心城市。为促进 X 国的发展，这 $4$ 座核心城市中的任意两座城市，必须能够在不经过非核心城市的情况下相互到达。\n\n国王希望，你能够给他一种道路修建方案，使重建完成后选择 $4$ 座核心城市的方案数最大化。", "inputFormat": "一行一个正整数 $n(1 \\le n \\le 99)$，保证 $n$ 为奇数，表示有 $n$ 座城市。", "outputFormat": "第一行包含一个整数，表示最大的选择 $4$ 座核心城市的方案数。\n\n接下来的 $n$ 行每行 $n$ 个正整数描述一个邻接矩阵，表示你的道路修建方案。\n\n具体来说，第 $i$ 行的第 $j$ 个数为 $1$ 表示第 $i$ 座城市可以通过一条道路到达第 $j$ 座城市，为 $0$ 表示第 $i$ 座城市无法通过一条道路到达第 $j$ 座城市。我们分为 $3$ 种情况详细说明：\n\n1. $i, j$ 之前的道路为一条 $i$ 到 $j$ 的单向道路，则邻接矩阵的第 $i$ 行第 $j$ 个数为 $1$，第 $j$ 行第 $i$ 个数为 $0$。\n2. $i, j$ 之间的道路为一条双向道路，则邻接矩阵的第 $i$ 行第 $j$ 个数和第 $j$ 行第 $i$ 个数均为 $1$，你需要保证最多修建 $n$ 条双向道路。\n3. $i = j$，则第 $i$ 行第 $j$ 个数（第 $j$ 行第 $i$ 个数）为 $0$。", "hint": "【样例 $1$ 说明】\n\n由于一共只有 $3$ 个点，所以选择 $4$ 座核心城市的方案数一定为 $0$，那么只需要保证修建方案满足条件即可。\n\n【样例 $2$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/pic/60711.png)\n\n显然，在 $5$ 个点中任意选 $4$ 个点，都满足核心城市的条件，因此方案数最大为 $5$。\n\n【数据规模与约定】\n\n本题一共有 $50$ 个测试点，每个测试点 $2$ 分。对于第 $i$ 个测试点，$n = 2i - 1$。\n\n对于每个测试点，有五种可能的结果：\n\n1. 输出格式错误，包括：没有输出最大方案数、没有输出邻接矩阵、输出了多余的信息等。你将无法得到该测试点的任何分数，同时我们无法确定 Special Judge 的返回结果。\n2. 没有正确计算最大方案数，即使构造的道路修建方案是正确的。你将得到该测试点 $0\\%$ 的分数（即 $0$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is wrong.”\n3. 正确计算了最大方案数，但是构造的道路修建方案不满足条件，包括：邻接矩阵中有不为 $0$ 或 $1$ 的数、有自环、有两座城市中没有道路、有多于 $n$ 条双向道路等。你将得到该测试点 $50\\%$ 的分数（即 $1$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is correct, but your plan breaks the rules.”\n4. 正确计算了最大方案数，构造的道路修建方案满足条件但没有将选择 $4$ 座核心城市的方案数最大化。你将得到该测试点 $50\\%$ 的分数（即 $1$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is correct, but your plan is wrong.”\n5. 正确计算了最大方案数，同时正确构造了道路修建方案。你将得到该测试点 $100\\%$ 的分数（即 $2$ 分），Special Judge 将会返回 AC 的结果，同时输出 “The answer is correct.”", "locale": "zh-CN"}}}
{"pid": "P5442", "type": "P", "difficulty": 6, "samples": [["3 1", "8"], ["4 3", "450"], ["1926 817", "984167516"], ["998244353 1", "998244352"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [614400, 614400, 614400, 614400, 614400, 614400, 614400, 614400, 614400, 614400]}, "tags": ["数学", "O2优化", "期望", "逆元"], "title": "【XR-2】约定 (加强版)", "background": "原题链接：[P5437](https://www.luogu.org/problemnew/show/P5437)\n\n其实在比赛时就想放上这个加强版了qwq    \n但是团队成员都强烈反对，于是就在赛后放上来啦", "description": "有一个 $n$ 个点的完全图，编号从 $1$ 到 $n$。  \n连接 $i$ 和 $j$ 节点的边，权值为 $(i+j)^k$。  \n定义一棵树的权值为其所有边的权值和。  \n从这个图的所有生成树中随机选择一个，求其权值的期望。  \n需要将答案对 $998244353$ 取模。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据范围：   \n$1\\le n \\le 10^{10000}$  \n$1\\le k \\le 10^7$\n", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Appointment (Enhanced Version)", "background": "Original problem link: [P5437](https://www.luogu.org/problemnew/show/P5437).\n\nActually, during the contest I wanted to include this enhanced version qwq.  \nBut the team members strongly disagreed, so I posted it after the contest.", "description": "There is a complete graph with $n$ vertices, numbered from $1$ to $n$.  \nFor the edge connecting vertices $i$ and $j$, its weight is $(i+j)^k$.  \nDefine the weight of a tree as the sum of the weights of all its edges.  \nRandomly choose a spanning tree from all spanning trees of this graph, and find the expected value of its weight.  \nYou need to output the answer modulo $998244353$.", "inputFormat": "One line containing two positive integers $n, k$.", "outputFormat": "One line containing one integer, representing the answer modulo $998244353$.", "hint": "### Constraints\n\n$1\\le n \\le 10^{10000}$  \n$1\\le k \\le 10^7$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】约定 (加强版)", "background": "原题链接：[P5437](https://www.luogu.org/problemnew/show/P5437)\n\n其实在比赛时就想放上这个加强版了qwq    \n但是团队成员都强烈反对，于是就在赛后放上来啦", "description": "有一个 $n$ 个点的完全图，编号从 $1$ 到 $n$。  \n连接 $i$ 和 $j$ 节点的边，权值为 $(i+j)^k$。  \n定义一棵树的权值为其所有边的权值和。  \n从这个图的所有生成树中随机选择一个，求其权值的期望。  \n需要将答案对 $998244353$ 取模。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据范围：   \n$1\\le n \\le 10^{10000}$  \n$1\\le k \\le 10^7$\n", "locale": "zh-CN"}}}
{"pid": "P5443", "type": "P", "difficulty": 6, "samples": [["3 4\n1 2 5\n2 3 2\n3 1 4\n2 3 8\n5\n2 1 5\n1 4 1\n2 2 5\n1 1 1\n2 3 2", "3\n2\n3"], ["7 8\n1 2 5\n1 6 5\n2 3 5\n2 7 5\n3 4 5\n4 5 5\n5 6 5\n6 7 5\n12\n2 1 6\n1 1 1\n2 1 2\n1 2 3\n2 2 2\n1 5 2\n1 3 1\n2 2 4\n2 4 2\n1 8 1\n2 1 1\n2 1 3", "1\n7\n7\n5\n7\n7\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "并查集", "APIO", "分块"], "title": "[APIO2019] 桥梁", "background": "圣彼得堡市内所有水路长度总和约 $282$ 千米，市内水域面积占城市面积的 $7\\%$。——来自维基百科", "description": "圣彼得堡位于由 $m$ 座桥梁连接而成的 $n$ 个岛屿上。岛屿用 $1$ 到 $n$ 的整数编号，桥梁用 $1$ 到 $m$ 的整数编号。每座桥连接两个不同的岛屿。有些桥梁是在彼得大帝时代建造的，其中一些是近期建造的。这导致了不同的桥梁可能有不同的重量限制。更具体地，只有重量不超过 $d_i$ 的汽车才能通过第 $i$ 座桥梁。有时圣彼得堡的一些桥梁会进行翻新，但这并不一定会使桥梁承重变得更好，也就是说，进行翻新的桥梁的 $d_i$ 可能会增加或减少。你准备开发一个产品，用于帮助公民和城市客人。目前，你开发的模块要能执行两种类型的操作：\n\n1. 将桥梁 $b_j$ 的重量限制改为 $r_j$。\n\n2. 统计一辆重为 $w_j$ 的汽车从岛屿 $s_j$ 出发能够到达多少个不同的岛屿。\n\n请你回答所有第二种操作的答案。\n\n", "inputFormat": "第一行包含两个整数 $n$ 和 $m$—— 表示圣彼得堡的岛屿数量与桥梁数量。\n\n接下来 $m$ 行，每行三个整数 $u_i,v_i,d_i$。第 $i$ 行的整数描述了一座连接岛屿 $u_i$ 和 $v_i$，初始时重量限制为 $d_i$ 的桥梁。\n\n接下来一行一个整数 $q$—— 表示操作的数量。\n\n接下来 $q$ 行按顺序每行描述一个操作。\n\n每行第一个整数 $t_j$ 表示操作类型：\n\n- 若 $t_j=1$，则该操作是第一种类型，该行接下来给定两个整数 $b_j$ 和 $r_j$，表示桥梁 $b_j$ 的重量限制将变为 $r_j$。\n\n- 若 $t_j=2$，则该操作是第二种类型，该行接下来给定两个整数 $s_j$ 和 $w_j$，表示一辆重为 $w_j$ 的汽车将要从第 $s_j$ 个岛屿出发。", "outputFormat": "对于每个第二种类型的询问，输出一行一个整数表示答案。", "hint": "对于全部数据，$1 \\leq n \\leq 5\\times 10^4$，$0 \\leq m \\leq 10^5$，$1 \\leq q \\leq 10^5$。保证 $1 \\leq u_i$，$v_i$, $s_j \\leq n$，$u_i \\neq v_i$，$1 \\leq d_i$, $r_j$, $w_j \\leq 10^9$，$1 \\leq b_j \\leq m$，$t_j \\in {1,2}$。\n\n详细子任务附加限制与分值如下表\n\n| 子任务 | 附加限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $m\\leq 10^3$，$q\\leq 10^4$ | 13 |\n| 2 | 岛屿和桥梁将形成一个树结构；$m=n-1$，$u_i=i$，$v_i=i+1$；（$1\\leq i\\leq m$） | 16 |\n| 3 | 岛屿和桥梁将形成一个完全二叉树结构；$n=2^k-1$，$m=n-1$，$u_i=\\frac{i+1}{2}$，$v_i=i+1$；（$1\\leq k\\leq 15$，$1\\leq i\\leq m$） | 17 |\n| 4 | 所有 $t_i$ 均为 $2$ | 14 |\n| 5 | 岛屿和桥梁将形成一个树结构 | 13 |\n| 6 | 无特殊限制 | 27 |", "locale": "zh-CN", "translations": {"en": {"title": "[APIO2019] Bridges", "background": "The total length of all waterways in Saint Petersburg is about $282$ km, and the water area accounts for $7\\%$ of the city area. — From Wikipedia.", "description": "Saint Petersburg is located on $n$ islands connected by $m$ bridges. The islands are numbered with integers from $1$ to $n$, and the bridges are numbered with integers from $1$ to $m$. Each bridge connects two different islands. Some bridges were built in the era of Peter the Great, while others were built more recently. As a result, different bridges may have different weight limits. More specifically, only cars with weight not exceeding $d_i$ can cross bridge $i$. Sometimes, some bridges in Saint Petersburg are renovated, but this does not necessarily make their load capacity better; that is, after renovation, the $d_i$ of a bridge may increase or decrease. You are going to develop a product to help citizens and city visitors. Currently, the module you are developing needs to support two types of operations:\n\n1. Change the weight limit of bridge $b_j$ to $r_j$.\n\n2. Count how many different islands a car of weight $w_j$ can reach starting from island $s_j$.\n\nPlease answer all queries of the second type.", "inputFormat": "The first line contains two integers $n$ and $m$, representing the number of islands and the number of bridges in Saint Petersburg.\n\nThe next $m$ lines each contain three integers $u_i, v_i, d_i$. Line $i$ describes a bridge connecting islands $u_i$ and $v_i$, with an initial weight limit of $d_i$.\n\nThe next line contains one integer $q$, representing the number of operations.\n\nThe next $q$ lines describe the operations in order, one per line.\n\nThe first integer on each line is $t_j$, indicating the operation type:\n\n- If $t_j = 1$, this is the first type of operation. The line then contains two integers $b_j$ and $r_j$, meaning the weight limit of bridge $b_j$ will become $r_j$.\n\n- If $t_j = 2$, this is the second type of operation. The line then contains two integers $s_j$ and $w_j$, meaning a car of weight $w_j$ will start from island $s_j$.", "outputFormat": "For each query of the second type, output one line with one integer representing the answer.", "hint": "For all testdata, $1 \\leq n \\leq 5 \\times 10^4$, $0 \\leq m \\leq 10^5$, $1 \\leq q \\leq 10^5$. It is guaranteed that $1 \\leq u_i, v_i, s_j \\leq n$, $u_i \\neq v_i$, $1 \\leq d_i, r_j, w_j \\leq 10^9$, $1 \\leq b_j \\leq m$, and $t_j \\in \\{1, 2\\}$.\n\nThe detailed additional constraints and scores for the subtasks are shown in the table below.\n\n| Subtask | Additional Constraints | Score |\n| :----------: | :----------: | :----------: |\n| 1 | $n, m \\leq 10^3$, $q \\leq 10^4$ | 13 |\n| 2 | The islands and bridges form a tree; $m = n - 1$, $u_i = i$, $v_i = i + 1$ ($1 \\leq i \\leq m$) | 16 |\n| 3 | The islands and bridges form a complete binary tree; $n = 2^k - 1$, $m = n - 1$, $u_i = \\frac{i+1}{2}$, $v_i = i + 1$ ($1 \\leq k \\leq 15$, $1 \\leq i \\leq m$) | 17 |\n| 4 | All $t_i$ are $2$ | 14 |\n| 5 | The islands and bridges form a tree | 13 |\n| 6 | No special constraints | 27 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[APIO2019] 桥梁", "background": "圣彼得堡市内所有水路长度总和约 $282$ 千米，市内水域面积占城市面积的 $7\\%$。——来自维基百科", "description": "圣彼得堡位于由 $m$ 座桥梁连接而成的 $n$ 个岛屿上。岛屿用 $1$ 到 $n$ 的整数编号，桥梁用 $1$ 到 $m$ 的整数编号。每座桥连接两个不同的岛屿。有些桥梁是在彼得大帝时代建造的，其中一些是近期建造的。这导致了不同的桥梁可能有不同的重量限制。更具体地，只有重量不超过 $d_i$ 的汽车才能通过第 $i$ 座桥梁。有时圣彼得堡的一些桥梁会进行翻新，但这并不一定会使桥梁承重变得更好，也就是说，进行翻新的桥梁的 $d_i$ 可能会增加或减少。你准备开发一个产品，用于帮助公民和城市客人。目前，你开发的模块要能执行两种类型的操作：\n\n1. 将桥梁 $b_j$ 的重量限制改为 $r_j$。\n\n2. 统计一辆重为 $w_j$ 的汽车从岛屿 $s_j$ 出发能够到达多少个不同的岛屿。\n\n请你回答所有第二种操作的答案。\n\n", "inputFormat": "第一行包含两个整数 $n$ 和 $m$—— 表示圣彼得堡的岛屿数量与桥梁数量。\n\n接下来 $m$ 行，每行三个整数 $u_i,v_i,d_i$。第 $i$ 行的整数描述了一座连接岛屿 $u_i$ 和 $v_i$，初始时重量限制为 $d_i$ 的桥梁。\n\n接下来一行一个整数 $q$—— 表示操作的数量。\n\n接下来 $q$ 行按顺序每行描述一个操作。\n\n每行第一个整数 $t_j$ 表示操作类型：\n\n- 若 $t_j=1$，则该操作是第一种类型，该行接下来给定两个整数 $b_j$ 和 $r_j$，表示桥梁 $b_j$ 的重量限制将变为 $r_j$。\n\n- 若 $t_j=2$，则该操作是第二种类型，该行接下来给定两个整数 $s_j$ 和 $w_j$，表示一辆重为 $w_j$ 的汽车将要从第 $s_j$ 个岛屿出发。", "outputFormat": "对于每个第二种类型的询问，输出一行一个整数表示答案。", "hint": "对于全部数据，$1 \\leq n \\leq 5\\times 10^4$，$0 \\leq m \\leq 10^5$，$1 \\leq q \\leq 10^5$。保证 $1 \\leq u_i$，$v_i$, $s_j \\leq n$，$u_i \\neq v_i$，$1 \\leq d_i$, $r_j$, $w_j \\leq 10^9$，$1 \\leq b_j \\leq m$，$t_j \\in {1,2}$。\n\n详细子任务附加限制与分值如下表\n\n| 子任务 | 附加限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $m\\leq 10^3$，$q\\leq 10^4$ | 13 |\n| 2 | 岛屿和桥梁将形成一个树结构；$m=n-1$，$u_i=i$，$v_i=i+1$；（$1\\leq i\\leq m$） | 16 |\n| 3 | 岛屿和桥梁将形成一个完全二叉树结构；$n=2^k-1$，$m=n-1$，$u_i=\\frac{i+1}{2}$，$v_i=i+1$；（$1\\leq k\\leq 15$，$1\\leq i\\leq m$） | 17 |\n| 4 | 所有 $t_i$ 均为 $2$ | 14 |\n| 5 | 岛屿和桥梁将形成一个树结构 | 13 |\n| 6 | 无特殊限制 | 27 |", "locale": "zh-CN"}}}
{"pid": "P5444", "type": "P", "difficulty": 6, "samples": [["3 3 3\n4 4\n7 9\n17 18", "4"], ["3 5 10\n1 20\n50 68\n89 98", "31"], ["2 16 13\n2 5\n18 18", "5"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "APIO"], "title": "[APIO2019] 奇怪装置", "background": "", "description": "考古学家发现古代文明留下了一种奇怪的装置。该装置包含两个屏幕，分别显示两个整数 $x$ 和 $y$ 。\n\n经过研究，科学家对该装置得出了一个结论：该装置是一个特殊的时钟，它从过去的某个时间点开始测量经过的时刻数 $t$，但该装置的创造者却将 $t$ 用奇怪的方式显示出来。若从该装置开始测量到现在所经过的时刻数为 $t$，装置会显示两个整数：$x = ((t + \\lfloor \\frac {t}{B} \\rfloor) \\bmod A)$，与 $y=(t \\bmod B)$。这里 $\\lfloor x \\rfloor$ 是下取整函数，表示小于或等于 $x$ 的最大整数。\n\n考古学家通过进一步研究还发现，该装置的屏幕无法一直工作。实际上，该装置的屏幕只在 $n$ 个连续的时间区间段中能正常工作。第 $i$ 个时间段从时刻 $l_i$ 到时刻 $r_i$。现在科学家想要知道有多少个不同的数对 $x,y$ 能够在该装置工作时被显示出来。\n\n两个数对 $(x_1,y_1)$ 和 $(x_2,y_2)$ 不同当且仅当 $x_1 \\neq x_2$ 或 $y_1 \\neq y_2$。\n", "inputFormat": "第一行包含三个整数 $n$，$A$ 与 $B$。\n接下来 $n$ 行每行两个整数 $l_i$，$r_i$ 表示装置可以工作的第 $i$ 个时间区间。", "outputFormat": "输出一行一个整数表示问题的答案。", "hint": "对于第一个样例，装置屏幕将显示如下这些数对。\n\n$t=4:(2,1)$\n\n$t=7:(0,1)$\n\n$t=8:(1,2)$\n\n$t=9:(0,0)$\n\n$t=17:(1,2)$\n\n$t=18:(0,0)$\n\n共有四个不同的数对：$(0,0),(0,1),(1,2),(2,1)$\n\n对于全部数据，$1 \\leq n \\leq 10^6,1 \\leq A,B \\leq 10^{18},0 \\leq l_i \\leq r_i \\leq 10^{18}$\n\n令 $S=\\sum_{i=1}^n (r_i-l_i+1)$ 与 $L=\\max_{i=1}^n (r_i-l_i+1)$\n\n详细子任务附加限制与分值如下表：\n\n| 子任务 | 附加限制 | 分值 |\n| :-----------: | :----------- | :-----------: |\n| 1 | $S\\leq 10^6$ | 10 |\n| 2 | $n=1$ | 5 |\n| 3 | $A\\times B \\leq 10^6$ | 5 |\n| 4 | $B=1$ | 5 |\n| 5 | $B\\leq 3$ | 5 |\n| 6 | $B\\leq 10^6$ | 20 |\n| 7 | $L\\leq B$ | 20 |\n| 8 | 无附加限制 | 30 |\n", "locale": "zh-CN", "translations": {"en": {"title": "[APIO2019] Strange Device", "background": "", "description": "Archaeologists have discovered a strange device left behind by an ancient civilization. The device has two screens, which display two integers $x$ and $y$.\n\nAfter research, scientists reached the following conclusion: the device is a special clock. It starts counting the number of moments $t$ that have passed since some point in the past, but the creator displays $t$ in a strange way. If the number of moments that have passed since the device started measuring is $t$, then it displays two integers:\n$x = ((t + \\lfloor \\frac {t}{B} \\rfloor) \\bmod A)$, and $y = (t \\bmod B)$.\nHere $\\lfloor x \\rfloor$ is the floor function, which means the greatest integer less than or equal to $x$.\n\nArchaeologists further found that the screens cannot work all the time. In fact, the screens work normally only during $n$ continuous time intervals. The $i$-th interval is from moment $l_i$ to moment $r_i$. Now scientists want to know how many different pairs $x,y$ can be displayed while the device is working.\n\nTwo pairs $(x_1,y_1)$ and $(x_2,y_2)$ are different if and only if $x_1 \\neq x_2$ or $y_1 \\neq y_2$.", "inputFormat": "The first line contains three integers $n$, $A$, and $B$.\nThe next $n$ lines each contain two integers $l_i$ and $r_i$, representing the $i$-th time interval during which the device can work.", "outputFormat": "Output one line containing one integer, the answer to the problem.", "hint": "For the first sample, the device screens will display the following pairs.\n\n$t=4:(2,1)$\n\n$t=7:(0,1)$\n\n$t=8:(1,2)$\n\n$t=9:(0,0)$\n\n$t=17:(1,2)$\n\n$t=18:(0,0)$\n\nThere are four different pairs in total: $(0,0),(0,1),(1,2),(2,1)$.\n\nFor all data, $1 \\leq n \\leq 10^6,1 \\leq A,B \\leq 10^{18},0 \\leq l_i \\leq r_i \\leq 10^{18}$.\n\nLet $S=\\sum_{i=1}^n (r_i-l_i+1)$ and $L=\\max_{i=1}^n (r_i-l_i+1)$.\n\nThe detailed additional constraints and scores for subtasks are shown in the table below:\n\n| Subtask | Additional Constraints | Score |\n| :-----------: | :----------- | :-----------: |\n| 1 | $S\\leq 10^6$ | 10 |\n| 2 | $n=1$ | 5 |\n| 3 | $A\\times B \\leq 10^6$ | 5 |\n| 4 | $B=1$ | 5 |\n| 5 | $B\\leq 3$ | 5 |\n| 6 | $B\\leq 10^6$ | 20 |\n| 7 | $L\\leq B$ | 20 |\n| 8 | No additional constraints. | 30 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[APIO2019] 奇怪装置", "background": "", "description": "考古学家发现古代文明留下了一种奇怪的装置。该装置包含两个屏幕，分别显示两个整数 $x$ 和 $y$ 。\n\n经过研究，科学家对该装置得出了一个结论：该装置是一个特殊的时钟，它从过去的某个时间点开始测量经过的时刻数 $t$，但该装置的创造者却将 $t$ 用奇怪的方式显示出来。若从该装置开始测量到现在所经过的时刻数为 $t$，装置会显示两个整数：$x = ((t + \\lfloor \\frac {t}{B} \\rfloor) \\bmod A)$，与 $y=(t \\bmod B)$。这里 $\\lfloor x \\rfloor$ 是下取整函数，表示小于或等于 $x$ 的最大整数。\n\n考古学家通过进一步研究还发现，该装置的屏幕无法一直工作。实际上，该装置的屏幕只在 $n$ 个连续的时间区间段中能正常工作。第 $i$ 个时间段从时刻 $l_i$ 到时刻 $r_i$。现在科学家想要知道有多少个不同的数对 $x,y$ 能够在该装置工作时被显示出来。\n\n两个数对 $(x_1,y_1)$ 和 $(x_2,y_2)$ 不同当且仅当 $x_1 \\neq x_2$ 或 $y_1 \\neq y_2$。\n", "inputFormat": "第一行包含三个整数 $n$，$A$ 与 $B$。\n接下来 $n$ 行每行两个整数 $l_i$，$r_i$ 表示装置可以工作的第 $i$ 个时间区间。", "outputFormat": "输出一行一个整数表示问题的答案。", "hint": "对于第一个样例，装置屏幕将显示如下这些数对。\n\n$t=4:(2,1)$\n\n$t=7:(0,1)$\n\n$t=8:(1,2)$\n\n$t=9:(0,0)$\n\n$t=17:(1,2)$\n\n$t=18:(0,0)$\n\n共有四个不同的数对：$(0,0),(0,1),(1,2),(2,1)$\n\n对于全部数据，$1 \\leq n \\leq 10^6,1 \\leq A,B \\leq 10^{18},0 \\leq l_i \\leq r_i \\leq 10^{18}$\n\n令 $S=\\sum_{i=1}^n (r_i-l_i+1)$ 与 $L=\\max_{i=1}^n (r_i-l_i+1)$\n\n详细子任务附加限制与分值如下表：\n\n| 子任务 | 附加限制 | 分值 |\n| :-----------: | :----------- | :-----------: |\n| 1 | $S\\leq 10^6$ | 10 |\n| 2 | $n=1$ | 5 |\n| 3 | $A\\times B \\leq 10^6$ | 5 |\n| 4 | $B=1$ | 5 |\n| 5 | $B\\leq 3$ | 5 |\n| 6 | $B\\leq 10^6$ | 20 |\n| 7 | $L\\leq B$ | 20 |\n| 8 | 无附加限制 | 30 |\n", "locale": "zh-CN"}}}
{"pid": "P5445", "type": "P", "difficulty": 6, "samples": [["5 7\n11011\nquery 1 2\nquery 1 2\nquery 1 6\nquery 3 4\ntoggle 3\nquery 3 4\nquery 1 6", "1\n2\n0\n0\n1\n2"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "APIO"], "title": "[APIO2019] 路灯", "background": "", "description": "一辆自动驾驶的出租车正在 Innopolis 的街道上行驶。该街道上有 $n+1$ 个停车站点，它们将街道划分成了 $n$ 条路段。每一路段都拥有一个路灯。当第 $i$ 个路灯亮起，它将照亮连接第 $i$ 与第 $i+1$ 个站点的路段。否则这条路段将是黑暗的。\n\n安全起见，出租车只能在被照亮的路段上行驶。换言之，出租车能从站点 $a$ 出发到达站点 $b (a<b)$ 的条件是：连接站点 $a$ 与 $a+1$，$a + 1$ 与 $a+2$，……，$b-1$ 与 $b$ 的路段都被照亮。\n\n在经过一些意外故障或修理之后，街道上的路灯可能是亮起的，也可能是熄灭的。\n\n现在给定 $0$ 时刻时，街道上路灯的初始状态。之后 $1,2,\\ldots,q$ 时刻，每时刻会发生下列两种事件之一：\n\n- $\\text{toggle} \\ i$：切换第 $i$ 个路灯的状态。具体地说，若路灯原来亮起，则现在将熄灭；若路灯原来熄灭，则现在将亮起。\n\n- $\\text{query}  \\  a  \\  b$：出租车部门的负责人想知道，从 $0$ 时刻起到当前时刻，有多少个时刻满足：出租车能够从站点 $a$ 出发到达站点 $b$。\n\n请你帮助出租车部门的负责人回答他们的问题。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$，表示路灯的数量与时刻数。\n\n第二行包含一个字符串 $s$ 表示路灯的初始状态，$s_i$ 为 $1$ 表示第 $i$ 个路灯初始时亮起；$s_i$ 为 $0$ 表示第 $i$ 个路灯初始时熄灭。\n\n接下来 $q$ 行每行描述一个时刻的事件。第 $i$ 行描述时刻 $i$ 所发生的事件：\n\n- $\\text{toggle} \\ i$：该时刻切换了第 $i$ 个路灯的状态。\n\n- $\\text{query} \\ a \\ b$：计算从 $0$ 时刻起到该时刻，共有多少个时刻满足：出租车能从站点 $a$ 出发到达站点 $b$。\n\n至少有一个时刻的事件是 $\\text{query}$。", "outputFormat": "对于每个 $\\text{query}$ 的事件，输出一行单个整数，表示该问题的答案。", "hint": "对于全部数据，$1 \\leq n,q \\leq 3\\times 10^5$，$|s|=n$，$1 \\leq i \\leq n$，$1 \\leq a < b \\leq n+1$。\n\n详细子任务附加限制与分值如下表\n\n| 子任务 | 附加限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $q\\leq 100$ | 20 |\n| 2 | 对于所有 $\\text{query}\\ a\\ b$ 事件，满足 $a=b-1$ | 20 |\n| 3 | 对于所有 $\\text{toggle}\\ i$ 事件，第 $i$ 个路灯将被点亮 | 20 |\n| 4 | 所有 $\\text{toggle}$ 事件都发生在第一个 $\\text{query}$ 事件之前 | 20 |\n| 5 | 无特殊限制 | 20 |", "locale": "zh-CN", "translations": {"en": {"title": "[APIO2019] Street Lamps", "background": "", "description": "A self-driving taxi is driving along a street in Innopolis. There are $n+1$ stops on the street, which divide the street into $n$ road segments. Each segment has a street lamp. When the $i$-th lamp is on, it lights up the segment connecting stops $i$ and $i+1$. Otherwise, this segment is dark.\n\nFor safety reasons, the taxi can only drive on lit segments. In other words, the taxi can travel from stop $a$ to stop $b$ $(a<b)$ if and only if the segments connecting stops $a$ and $a+1$, $a+1$ and $a+2$, $\\ldots$, $b-1$ and $b$ are all lit.\n\nAfter some unexpected failures or repairs, the street lamps on the street may be on or off.\n\nYou are given the initial states of the street lamps at time $0$. Then at times $1,2,\\ldots,q$, one of the following two events happens at each time:\n\n- $\\text{toggle}\\ i$: Toggle the state of the $i$-th street lamp. Specifically, if it was on, it becomes off; if it was off, it becomes on.\n\n- $\\text{query}\\ a\\ b$: The head of the taxi department wants to know: from time $0$ up to the current time, how many times satisfy that the taxi can travel from stop $a$ to stop $b$.\n\nPlease help answer these queries for the head of the taxi department.", "inputFormat": "The first line contains two integers $n$ and $q$, representing the number of street lamps and the number of time moments.\n\nThe second line contains a string $s$ representing the initial states of the street lamps. $s_i=1$ means the $i$-th lamp is initially on, and $s_i=0$ means the $i$-th lamp is initially off.\n\nThe next $q$ lines each describe the event at a time moment. The $i$-th of these lines describes the event that happens at time $i$:\n\n- $\\text{toggle}\\ i$: At this time moment, the state of the $i$-th street lamp is toggled.\n\n- $\\text{query}\\ a\\ b$: Compute, from time $0$ up to this time moment, how many time moments satisfy that the taxi can travel from stop $a$ to stop $b$.\n\nAt least one event is $\\text{query}$.", "outputFormat": "For each $\\text{query}$ event, output a single integer on its own line, which is the answer to that query.", "hint": "For all data, $1 \\leq n,q \\leq 3\\times 10^5$, $|s|=n$, $1 \\leq i \\leq n$, $1 \\leq a < b \\leq n+1$.\n\nThe detailed additional constraints and scores for subtasks are as follows.\n\n| Subtask | Additional Constraints | Score |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $q \\leq 100$ | 20 |\n| 2 | For all $\\text{query}\\ a\\ b$ events, $a=b-1$ holds | 20 |\n| 3 | For all $\\text{toggle}\\ i$ events, the $i$-th lamp will be turned on | 20 |\n| 4 | All $\\text{toggle}$ events happen before the first $\\text{query}$ event | 20 |\n| 5 | No additional constraints | 20 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[APIO2019] 路灯", "background": "", "description": "一辆自动驾驶的出租车正在 Innopolis 的街道上行驶。该街道上有 $n+1$ 个停车站点，它们将街道划分成了 $n$ 条路段。每一路段都拥有一个路灯。当第 $i$ 个路灯亮起，它将照亮连接第 $i$ 与第 $i+1$ 个站点的路段。否则这条路段将是黑暗的。\n\n安全起见，出租车只能在被照亮的路段上行驶。换言之，出租车能从站点 $a$ 出发到达站点 $b (a<b)$ 的条件是：连接站点 $a$ 与 $a+1$，$a + 1$ 与 $a+2$，……，$b-1$ 与 $b$ 的路段都被照亮。\n\n在经过一些意外故障或修理之后，街道上的路灯可能是亮起的，也可能是熄灭的。\n\n现在给定 $0$ 时刻时，街道上路灯的初始状态。之后 $1,2,\\ldots,q$ 时刻，每时刻会发生下列两种事件之一：\n\n- $\\text{toggle} \\ i$：切换第 $i$ 个路灯的状态。具体地说，若路灯原来亮起，则现在将熄灭；若路灯原来熄灭，则现在将亮起。\n\n- $\\text{query}  \\  a  \\  b$：出租车部门的负责人想知道，从 $0$ 时刻起到当前时刻，有多少个时刻满足：出租车能够从站点 $a$ 出发到达站点 $b$。\n\n请你帮助出租车部门的负责人回答他们的问题。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$，表示路灯的数量与时刻数。\n\n第二行包含一个字符串 $s$ 表示路灯的初始状态，$s_i$ 为 $1$ 表示第 $i$ 个路灯初始时亮起；$s_i$ 为 $0$ 表示第 $i$ 个路灯初始时熄灭。\n\n接下来 $q$ 行每行描述一个时刻的事件。第 $i$ 行描述时刻 $i$ 所发生的事件：\n\n- $\\text{toggle} \\ i$：该时刻切换了第 $i$ 个路灯的状态。\n\n- $\\text{query} \\ a \\ b$：计算从 $0$ 时刻起到该时刻，共有多少个时刻满足：出租车能从站点 $a$ 出发到达站点 $b$。\n\n至少有一个时刻的事件是 $\\text{query}$。", "outputFormat": "对于每个 $\\text{query}$ 的事件，输出一行单个整数，表示该问题的答案。", "hint": "对于全部数据，$1 \\leq n,q \\leq 3\\times 10^5$，$|s|=n$，$1 \\leq i \\leq n$，$1 \\leq a < b \\leq n+1$。\n\n详细子任务附加限制与分值如下表\n\n| 子任务 | 附加限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $q\\leq 100$ | 20 |\n| 2 | 对于所有 $\\text{query}\\ a\\ b$ 事件，满足 $a=b-1$ | 20 |\n| 3 | 对于所有 $\\text{toggle}\\ i$ 事件，第 $i$ 个路灯将被点亮 | 20 |\n| 4 | 所有 $\\text{toggle}$ 事件都发生在第一个 $\\text{query}$ 事件之前 | 20 |\n| 5 | 无特殊限制 | 20 |", "locale": "zh-CN"}}}
{"pid": "P5446", "type": "P", "difficulty": 5, "samples": [["4\nabcdcb\nqwqwq\nqaqaqqq\ncarnation", "4 6\n2 3 4 5\n6 7\n9"]], "limits": {"time": [2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000]}, "tags": ["2018", "Manacher 算法", "THUPC"], "title": "[THUPC 2018] 绿绿和串串", "background": "绿绿和 Yazid 是好朋友。他们在一起做串串游戏。", "description": "绿绿有一个由小写字母组成的非空字符串 $R$，但 Yazid 不知道它具体是什么。\n\n我们定义**翻转**的操作：把一个串以最后一个字符作对称轴进行翻转复制。形式化地描述就是，如果他翻转的串为 $R$，那么他会将前 $\\left| R\\right|-1$ 个字符倒序排列后，插入到串的最后。\n\n举例而言，串`abcd`进行翻转操作后，将得到`abcdcba`；串`qw`连续进行 **$2$ 次**翻转操作后，将得到`qwqwq`；串`z`无论进行多少次翻转操作，都不会被改变。\n\n贪玩的绿绿进行了若干次（可能为 $0$ 次）翻转操作。\n\n淘气的绿绿又展示出了一个非空串 $S$，并表示 $S$ 是**最终**的串 $R$ 的前缀。现在，他想考考 Yazid，**初始**的串 $R$ 的长度可能是多少。\n\nYazid 找到了正在参加清华校赛的你，请你来帮他解决这个问题。但聪明的 Yazid 发现，所有超过 $\\left| S\\right|$ 的整数都一定是 $R$ 的可能长度，因此你只需要告诉他不超过的 $\\left| S\\right|$ 的 $R$ 的可能长度即可。\n\n为了帮助你理解问题，Yazid 还将对一些概念和记号做出解释：\n\n- 对于一个串 $S$，$\\left| S\\right|$ 表示的是该串的长度。\n- 对于一个串 $S$，我们定义串 $T$ 是它的前缀，当且仅当 $\\left| T\\right|\\leq\\left| S\\right|$，且对于任意整数 $i$ 满足 $1\\leq i\\leq\\left| T\\right|$，都有 $T$ 的左起第 $i$ 个字符与 $S$ 的左起第 $i$ 个字符相同。（形象地理解，即 $T$ 在 $S$ 的前部出现）\n  - 如：`abc`是`abcdefg`的前缀，`aba`**不**为`abba`的前缀，`z`为`z`的前缀，空串为任意一个串的前缀。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n\n* 一行一个仅由小写字母组成的非空字符串 $S$。\n", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 从小到大输出 $\\left| R\\right|$ 的所有不超过 $\\left| S\\right|$ 的可能值，所有值之间用单个空格隔开。", "hint": "### 数据范围\n\n保证 $\\left| S\\right|\\leq 10^6$，$\\sum\\left| S\\right|\\leq 5\\times 10^6$。\n\n$\\sum\\left| S\\right|$ 表示的是单个测试点中所有数据 $\\left| S\\right|$ 的总和。\n\n### 提示\n\n* 读入规模较大，请注意读入效率。\n\n* 样例中的最后一个字符串是什么意思呢？\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Lvlvl and Skewers", "background": "Lvlvl and Yazid are good friends. They play a skewer game together.", "description": "Lvlvl has a non-empty string $R$ consisting of lowercase letters, but Yazid does not know what it is.\n\nWe define the **flip** operation: flip-copy a string using its last character as the axis of symmetry. Formally, if the string to be flipped is $R$, then take the first $\\left| R\\right|-1$ characters, reverse them, and append them to the end of the string.\n\nFor example, after applying the flip operation to `abcd`, we get `abcdcba`; if we apply the flip operation **$2$ times** in a row to `qw`, we get `qwqwq`; for `z`, no matter how many times we apply the flip operation, it will not change.\n\nThe playful Lvlvl performed the flip operation several times (possibly $0$ times).\n\nThen the naughty Lvlvl showed a non-empty string $S$, and said that $S$ is a prefix of the **final** string $R$. Now he wants to test Yazid: what lengths could the **initial** string $R$ have?\n\nYazid asked you, who are participating in the Tsinghua campus contest, to help solve this problem. But the clever Yazid noticed that every integer greater than $\\left| S\\right|$ must be a possible length of $R$, so you only need to tell him the possible lengths of $R$ that do not exceed $\\left| S\\right|$.\n\nTo help you understand the problem, Yazid also explains some concepts and notation:\n\n- For a string $S$, $\\left| S\\right|$ denotes its length.\n- For a string $S$, we say that a string $T$ is its prefix if and only if $\\left| T\\right|\\leq\\left| S\\right|$, and for every integer $i$ with $1\\leq i\\leq\\left| T\\right|$, the $i$-th character of $T$ from the left is the same as the $i$-th character of $S$ from the left. (Intuitively, $T$ appears at the beginning of $S$.)\n  - For example: `abc` is a prefix of `abcdefg`; `aba` is **not** a prefix of `abba`; `z` is a prefix of `z`; the empty string is a prefix of any string.", "inputFormat": "The input contains multiple test cases. The first line contains an integer $T$ indicating the number of test cases. Each test case is described as follows:\n\n- One line contains a non-empty string $S$ consisting only of lowercase letters.", "outputFormat": "For each test case, output one line:\n\n- Output all possible values of $\\left| R\\right|$ that do not exceed $\\left| S\\right|$, in increasing order, separated by a single space.", "hint": "### Constraints\n\nIt is guaranteed that $\\left| S\\right|\\leq 10^6$ and $\\sum\\left| S\\right|\\leq 5\\times 10^6$.\n\n$\\sum\\left| S\\right|$ denotes the total length $\\left| S\\right|$ of all test cases in a single test point.\n\n### Notes\n\n- The input size is large, so please pay attention to input efficiency.\n- What does the last string in the sample mean?\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Collegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as the editorial can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 绿绿和串串", "background": "绿绿和 Yazid 是好朋友。他们在一起做串串游戏。", "description": "绿绿有一个由小写字母组成的非空字符串 $R$，但 Yazid 不知道它具体是什么。\n\n我们定义**翻转**的操作：把一个串以最后一个字符作对称轴进行翻转复制。形式化地描述就是，如果他翻转的串为 $R$，那么他会将前 $\\left| R\\right|-1$ 个字符倒序排列后，插入到串的最后。\n\n举例而言，串`abcd`进行翻转操作后，将得到`abcdcba`；串`qw`连续进行 **$2$ 次**翻转操作后，将得到`qwqwq`；串`z`无论进行多少次翻转操作，都不会被改变。\n\n贪玩的绿绿进行了若干次（可能为 $0$ 次）翻转操作。\n\n淘气的绿绿又展示出了一个非空串 $S$，并表示 $S$ 是**最终**的串 $R$ 的前缀。现在，他想考考 Yazid，**初始**的串 $R$ 的长度可能是多少。\n\nYazid 找到了正在参加清华校赛的你，请你来帮他解决这个问题。但聪明的 Yazid 发现，所有超过 $\\left| S\\right|$ 的整数都一定是 $R$ 的可能长度，因此你只需要告诉他不超过的 $\\left| S\\right|$ 的 $R$ 的可能长度即可。\n\n为了帮助你理解问题，Yazid 还将对一些概念和记号做出解释：\n\n- 对于一个串 $S$，$\\left| S\\right|$ 表示的是该串的长度。\n- 对于一个串 $S$，我们定义串 $T$ 是它的前缀，当且仅当 $\\left| T\\right|\\leq\\left| S\\right|$，且对于任意整数 $i$ 满足 $1\\leq i\\leq\\left| T\\right|$，都有 $T$ 的左起第 $i$ 个字符与 $S$ 的左起第 $i$ 个字符相同。（形象地理解，即 $T$ 在 $S$ 的前部出现）\n  - 如：`abc`是`abcdefg`的前缀，`aba`**不**为`abba`的前缀，`z`为`z`的前缀，空串为任意一个串的前缀。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n\n* 一行一个仅由小写字母组成的非空字符串 $S$。\n", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 从小到大输出 $\\left| R\\right|$ 的所有不超过 $\\left| S\\right|$ 的可能值，所有值之间用单个空格隔开。", "hint": "### 数据范围\n\n保证 $\\left| S\\right|\\leq 10^6$，$\\sum\\left| S\\right|\\leq 5\\times 10^6$。\n\n$\\sum\\left| S\\right|$ 表示的是单个测试点中所有数据 $\\left| S\\right|$ 的总和。\n\n### 提示\n\n* 读入规模较大，请注意读入效率。\n\n* 样例中的最后一个字符串是什么意思呢？\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5447", "type": "P", "difficulty": 7, "samples": [["5 6 5\n000000\n001001\n000100\n001000\n000001\ndwdaa", "4"]], "limits": {"time": [12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000], "memory": [2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 赛艇", "background": "", "description": "Lavender、Caryophyllus、Jasmine、Dianthus现在在玩一款名叫“赛艇”的游戏。\n\n这个游戏的规则是这样的：\n\n1. 玩家自由组成两队，一个人当赛艇的艇长，另一个人当侦察兵；\n2. 每次游戏开始时，双方均拥有由系统生成的某张地图，该地图以01矩阵的形式表示，`1`表示有障碍物，无法通行，`0`表示水域空旷，可以通行；\n3. 第一回合，双方的赛艇艇长都要在地图上指定一个出发点，该出发点不能是障碍物，也就是只能为`0`；\n4. 在每个回合中，艇长可以指挥自己的赛艇向上/下/左/右四个方向的某一方向的空旷水域移动一个单位的距离，也就是说只能移向四个方向上的某个`0`上（当然，不能移动出地图之外）；在该操作完成之后，**必须向对方说出自己在该回合移动的方向**；\n5. 双方的侦察兵负责记录每一回合对方赛艇的移动方向，并负责推断此时对方赛艇可能的位置；如果某方的侦察兵推测出对方赛艇此时的精确位置，那么可以向其发射导弹，该侦察兵所在的一方胜利；\n\n现在，Jasmine记录了一些对方赛艇的路径，她想确定一下此时对方所有可能的位置共有几种。由于她不是很擅长计算，所以这个任务就交给你了。", "inputFormat": "输入第一行包含三个正整数 $n$，$m$，$k$，分别表示地图为 $n$ 行 $m$ 列，当前游戏已经进行了 $k$ 轮。保证 $2\\le n,m \\le 1500$，$1\\le k\\le 5\\times 10^6$。\n\n输入第二行到第 $n+1$ 行为一个 $n$ 行 $m$ 列的 01 矩阵，无任何分隔符号，表示地图的具体信息，具体含义如上所示。\n\n输入的最后一行为一个长度为 $k$ 的字符串 $s$，仅由字母 `w`、`a`、`s`、`d` 构成，从前往后第 $i$ 个字符 $s_i$ 表示对方在第 $i$ 轮中，对方赛艇向上/左/下/右移动一个单位距离。", "outputFormat": "输出一行一个正整数，表示在第 $k$ 轮游戏回合的时候，对方赛艇可能的位置的种数。对于所有输入数据，**保证有合法解**。", "hint": "### 样例解释\n\n![](https://i.loli.net/2018/05/14/5af98ebcd79df.png)\n\n上图显示了路径序列可视化之后的结果，下图用蓝色标出了此时对方赛艇可能的位置。\n\n![](https://i.loli.net/2018/05/14/5af98ed39a602.png)\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Rowing", "background": "", "description": "Lavender, Caryophyllus, Jasmine, and Dianthus are now playing a game called \"Rowing\".\n\nThe rules of this game are as follows:\n\n1. Players freely form two teams. One person acts as the boat captain, and the other acts as the scout.\n2. At the start of each game, both sides are given a map generated by the system. The map is represented as a 0-1 matrix: `1` means there is an obstacle and it is impassable, while `0` means open water and it is passable.\n3. In the first round, both captains must choose a starting point on the map. This point cannot be an obstacle, so it must be `0`.\n4. In each round, the captain may command their boat to move by one unit to an adjacent open-water cell in one of the four directions: up/down/left/right. That is, the boat may only move onto a `0` in one of the four directions (and of course, it cannot move outside the map). After this operation is completed, they **must tell the opponent the direction they moved in that round**.\n5. The scouts on both sides are responsible for recording the opponent boat’s movement direction in each round, and for inferring the opponent boat’s possible position at that moment. If a scout can infer the opponent boat’s exact position at that moment, they may fire a missile at it, and the scout’s side wins.\n\nNow, Jasmine has recorded some movement directions of the opponent boat. She wants to determine how many possible positions the opponent boat may be at this moment. Since she is not good at calculations, she hands this task to you.", "inputFormat": "The first line contains three positive integers $n$, $m$, $k$, indicating that the map has $n$ rows and $m$ columns, and the game has currently proceeded for $k$ rounds. It is guaranteed that $2\\le n,m \\le 1500$, $1\\le k\\le 5\\times 10^6$.\n\nLines 2 to $n+1$ contain an $n$ by $m$ 0-1 matrix with no separators, describing the map information. The meaning is as described above.\n\nThe last line of the input is a string $s$ of length $k$, consisting only of the letters `w`, `a`, `s`, `d`. From left to right, the $i$-th character $s_i$ indicates that in round $i$, the opponent boat moved one unit up/left/down/right.", "outputFormat": "Output one line containing one positive integer, indicating the number of possible positions of the opponent boat in round $k$. For all input data, it is **guaranteed that a valid solution exists**.", "hint": "### Sample Explanation\n\n![](https://i.loli.net/2018/05/14/5af98ebcd79df.png)\n\nThe figure above shows the result after visualizing the path sequence. The figure below marks in blue the possible positions of the opponent boat at this moment.\n\n![](https://i.loli.net/2018/05/14/5af98ed39a602.png)\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Collegiate Invitational Contest (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as the editorial can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 赛艇", "background": "", "description": "Lavender、Caryophyllus、Jasmine、Dianthus现在在玩一款名叫“赛艇”的游戏。\n\n这个游戏的规则是这样的：\n\n1. 玩家自由组成两队，一个人当赛艇的艇长，另一个人当侦察兵；\n2. 每次游戏开始时，双方均拥有由系统生成的某张地图，该地图以01矩阵的形式表示，`1`表示有障碍物，无法通行，`0`表示水域空旷，可以通行；\n3. 第一回合，双方的赛艇艇长都要在地图上指定一个出发点，该出发点不能是障碍物，也就是只能为`0`；\n4. 在每个回合中，艇长可以指挥自己的赛艇向上/下/左/右四个方向的某一方向的空旷水域移动一个单位的距离，也就是说只能移向四个方向上的某个`0`上（当然，不能移动出地图之外）；在该操作完成之后，**必须向对方说出自己在该回合移动的方向**；\n5. 双方的侦察兵负责记录每一回合对方赛艇的移动方向，并负责推断此时对方赛艇可能的位置；如果某方的侦察兵推测出对方赛艇此时的精确位置，那么可以向其发射导弹，该侦察兵所在的一方胜利；\n\n现在，Jasmine记录了一些对方赛艇的路径，她想确定一下此时对方所有可能的位置共有几种。由于她不是很擅长计算，所以这个任务就交给你了。", "inputFormat": "输入第一行包含三个正整数 $n$，$m$，$k$，分别表示地图为 $n$ 行 $m$ 列，当前游戏已经进行了 $k$ 轮。保证 $2\\le n,m \\le 1500$，$1\\le k\\le 5\\times 10^6$。\n\n输入第二行到第 $n+1$ 行为一个 $n$ 行 $m$ 列的 01 矩阵，无任何分隔符号，表示地图的具体信息，具体含义如上所示。\n\n输入的最后一行为一个长度为 $k$ 的字符串 $s$，仅由字母 `w`、`a`、`s`、`d` 构成，从前往后第 $i$ 个字符 $s_i$ 表示对方在第 $i$ 轮中，对方赛艇向上/左/下/右移动一个单位距离。", "outputFormat": "输出一行一个正整数，表示在第 $k$ 轮游戏回合的时候，对方赛艇可能的位置的种数。对于所有输入数据，**保证有合法解**。", "hint": "### 样例解释\n\n![](https://i.loli.net/2018/05/14/5af98ebcd79df.png)\n\n上图显示了路径序列可视化之后的结果，下图用蓝色标出了此时对方赛艇可能的位置。\n\n![](https://i.loli.net/2018/05/14/5af98ed39a602.png)\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5448", "type": "P", "difficulty": 7, "samples": [["2 233\n3\n4", "4\n10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 好图计数", "background": "这道题目非常简单，它甚至没有题目背景、没有任何故事。\n\n但为了能让你顺利理解题目，善良的 Yazid 将为你介绍一些概念。\n\n* 简单图：不存在重边、自环的图。（重边即为两条完全相同的边，自环即为两端点为同一节点的边）\n\n* 补图：一个图 $G$ 的补图有与 $G$ 完全相同的节点，且任意两点之间有边当且仅当他们在 $G$ 中不相邻。", "description": "我们归纳定义一个无向简单图是**好的**：\n\n1. 一个单点是好的。\n\n2. 若干个好的图分别作为联通块所形成的图是好的。\n\n3. 一个好的图的补图是好的。\n\n给定一个正整数 $n$。\n\n求 $n$ 个点的本质不同的好的图的数量对质数 $P$ 取模的结果。（这里的 $P$ 是一个常数，具体见【输入格式】）\n\n两个好的图的被认为是**本质不同的**，当且仅当无论如何将一个图重标号，它都不能与另一个图完全相同。", "inputFormat": "输入包含多组数据，第一行 $2$ 个用空格隔开的整数 $T,P$ 分别表示数据组数、以及模数。接下来依次描述每组数据，对于每组数据：\n\n* 一行一个整数 $n$，表示希望统计数目的好的图的节点数。", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 一个整数，表示 $n$ 个节点的好的图的数目对 $P$ 取模的结果。", "hint": "### 样例解释\n\n下面是 $3$ 个点的所有好的图：\n\n![](https://i.loli.net/2018/05/14/5af990dbcfbc0.png)\n\n### 数据范围\n\n保证 $T\\leq 233$，$n\\leq 23333$，$2^{29} < P < 2^{30}$ 且保证 $P$ 为质数。\n\n### 提示\n\n能够通过本题的算法的时间复杂度可能比你想象的要糟糕一些、也可能比你想象的要优秀一些。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Good Graph Counting", "background": "This problem is very simple. It does not even have a background story.\n\nBut to help you understand the problem smoothly, the kind Yazid will introduce some concepts.\n\n* Simple graph: a graph with no multiple edges and no self-loops. (A multiple edge means two completely identical edges, and a self-loop means an edge whose two endpoints are the same vertex.)\n\n* Complement graph: the complement of a graph $G$ has exactly the same vertices as $G$, and there is an edge between any two vertices if and only if they are not adjacent in $G$.", "description": "We define an undirected simple graph to be **good** as follows:\n\n1. A single vertex is good.\n\n2. A graph formed by taking several good graphs as connected components is good.\n\n3. The complement of a good graph is good.\n\nGiven a positive integer $n$.\n\nFind, modulo the prime $P$, the number of essentially different good graphs on $n$ vertices. (Here $P$ is a constant; see **Input Format** for details.)\n\nTwo good graphs are considered **essentially different** if and only if, no matter how you relabel one graph, it still cannot become exactly the same as the other graph.", "inputFormat": "The input contains multiple test cases. The first line contains two integers $T, P$ separated by spaces, representing the number of test cases and the modulus. Then each test case is described as follows:\n\n* One line with one integer $n$, meaning the number of vertices of the good graphs to be counted.", "outputFormat": "For each test case, output one line:\n\n* One integer, the number of good graphs on $n$ vertices modulo $P$.", "hint": "### Sample Explanation\n\nBelow are all good graphs with $3$ vertices:\n\n![](https://i.loli.net/2018/05/14/5af990dbcfbc0.png)\n\n### Constraints\n\nIt is guaranteed that $T \\leq 233$, $n \\leq 23333$, $2^{29} < P < 2^{30}$, and $P$ is prime.\n\n### Hint\n\nThe time complexity of an algorithm that can pass this problem might be worse than you expect, or it might be better than you expect.\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Collegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 好图计数", "background": "这道题目非常简单，它甚至没有题目背景、没有任何故事。\n\n但为了能让你顺利理解题目，善良的 Yazid 将为你介绍一些概念。\n\n* 简单图：不存在重边、自环的图。（重边即为两条完全相同的边，自环即为两端点为同一节点的边）\n\n* 补图：一个图 $G$ 的补图有与 $G$ 完全相同的节点，且任意两点之间有边当且仅当他们在 $G$ 中不相邻。", "description": "我们归纳定义一个无向简单图是**好的**：\n\n1. 一个单点是好的。\n\n2. 若干个好的图分别作为联通块所形成的图是好的。\n\n3. 一个好的图的补图是好的。\n\n给定一个正整数 $n$。\n\n求 $n$ 个点的本质不同的好的图的数量对质数 $P$ 取模的结果。（这里的 $P$ 是一个常数，具体见【输入格式】）\n\n两个好的图的被认为是**本质不同的**，当且仅当无论如何将一个图重标号，它都不能与另一个图完全相同。", "inputFormat": "输入包含多组数据，第一行 $2$ 个用空格隔开的整数 $T,P$ 分别表示数据组数、以及模数。接下来依次描述每组数据，对于每组数据：\n\n* 一行一个整数 $n$，表示希望统计数目的好的图的节点数。", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 一个整数，表示 $n$ 个节点的好的图的数目对 $P$ 取模的结果。", "hint": "### 样例解释\n\n下面是 $3$ 个点的所有好的图：\n\n![](https://i.loli.net/2018/05/14/5af990dbcfbc0.png)\n\n### 数据范围\n\n保证 $T\\leq 233$，$n\\leq 23333$，$2^{29} < P < 2^{30}$ 且保证 $P$ 为质数。\n\n### 提示\n\n能够通过本题的算法的时间复杂度可能比你想象的要糟糕一些、也可能比你想象的要优秀一些。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5449", "type": "P", "difficulty": 0, "samples": [["2 4 4\n1 1 -1 -1\n0 10 0 -1\n1 -1 1 -1\n10 0 -1 0\n1 1\n2 1\n1 2\n2 2", "122\n144\n242\n244"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 《算法与数据结构》小助教招募通知", "background": "T 大学和 U 大学是 W 国最好的两个大学。《算法与数据结构》是 U 大学的一门经典课程，曾连续百余年获得“U 大学一级精品课程”的荣誉。\n\n小 O 是这门课明年的助教。由于这门课过于火爆，他一个人忙不过来，所以他正在招募这门课的小助教。不过，招募的条件有点奇怪……", "description": "《算法与数据结构》课程的内容共分为 $n$ 个知识点，而每个知识点均有配套的的 $m$ 道练习题。每道题有两个属性值，第 $i$ 个知识点的第 $j$ 道练习题可以让做这道题的学生的算法能力提高 $a_{i, j}$，数据结构能力提高 $d_{i, j}$。这些属性值均为整数，但是可能为负数，甚至可能存在两个属性均为负的练习题。（不要问这种题是怎么被加进题库的…）\n\n明年的《算法与数据结构》课共有 $q$ 个学生注册。通过对每个学生以前学习情况的考察，小 O 决定对每个学生进行“因材施教”。具体方法是，对于第 $k$ 个学生、第 $i$ 个知识点，小 O 希望这个学生完成这个知识点的恰好 $c_{k, i}$ 道练习题。\n\n其实小 O 和 T 大学关系密切，希望在 U 大学搞点事情。对于每个学生，设为该学生选出的所有练习题对于算法能力与数据结构能力的提升分别为 $A$ 与 $D$，小 O 的目标是最大化 $A^2+D^2$，这样无论这个学生在哪个方面能力提升或降低的程度很大，都是小 O 所期望的。\n\n请对于每个学生计算这个目标的最大值。", "inputFormat": "每个输入文件仅包含一个测试数据。\n\n* 第一行包含三个正整数 $n, m, q$。\n\n* 接下来 $n$ 行，每行包含 $m$ 个整数；其中第 $i$ 行的第 $j$ 个整数为 $a_{i, j}$。\n\n* 接下来 $n$ 行，每行包含 $m$ 个整数；其中第 $i$ 行的第 $j$ 个整数为 $d_{i, j}$。\n\n* 接下来 $q$ 行，每行包含 $n$ 个整数；其中第 $k$ 行的第 $i$ 个整数为 $c_{k, i}$。\n\n对于输入的每一行，如果有多个数输入，则相邻两个数用恰好一个空格隔开。", "outputFormat": "输出 $q$ 行，每行 1 个整数：第 $k$ 行的整数表示第 $k$ 个学生的 $A^2+D^2$ 的最大值。", "hint": "### 样例解释\n\n有 2 个知识点，每个知识点有 4 道练习题；有 4 个学生。\n\n以第 2 个学生为例，我们需要为该学生在第 1 个知识点中选择恰好 2 道练习题，在第 2 个知识点中选择恰好 1 道练习题。一种最优的方案是，在第 1 个知识点中选择第 1 道题和第 3 道题，在第 2 个知识点中选择第 1 道题。这些题目对于算法能力的提高为 $A=a_{1,1}+a_{1,3}+a_{2,1}=1+(-1)+0=0$，对于数据结构能力的提高为 $D=d_{1,1}+d_{1,3}+d_{2,1}=1+1+10=12$，此时 $A^2+D^2=144$，并且不存在更优的方案。\n\n### 数据范围\n\n$1 \\leq n \\leq 6$，$1 \\leq m \\leq 666$，$1 \\leq q \\leq 666$，所有的 $a_{i, j}$ 与 $d_{i, j}$ 均在 $[-10^9,10^9]$ 范围内。\n对于最终测试数据，所有的 $c_{k, i}$ 均在 $[0, m]$ 范围内**独立、均匀**随机生成。\n\n### 提示\n\n输出的每个数可能非常大，甚至可能超过64位整数的范围。\n\n* C++语言可以使用`__int128_t`类型表示带符号128位整数，或使用`__uint128_t`类型表示无符号128位整数；这两种数据类型无法直接进行输入/输出。\n\n* Java语言可以使用`BigInteger`类。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Recruitment Notice for Junior Teaching Assistants of \"Algorithms and Data Structures\"", "background": "University T and University U are the two best universities in Country W. \"Algorithms and Data Structures\" is a classic course at University U, and it has won the honor of \"University U First-Class Premium Course\" for more than one hundred consecutive years.\n\nLittle O is the TA for this course next year. Because the course is too popular, he cannot handle it alone, so he is recruiting junior teaching assistants for this course. However, the recruitment requirements are a bit strange...", "description": "The content of the course \"Algorithms and Data Structures\" is divided into $n$ knowledge points, and each knowledge point has $m$ corresponding practice problems. Each problem has two attribute values: the $j$-th practice problem of the $i$-th knowledge point can increase the algorithm ability of the student who solves it by $a_{i, j}$, and increase the data structure ability by $d_{i, j}$. These attribute values are all integers, but they may be negative, and there may even be practice problems where both attributes are negative. (Do not ask how such problems got into the problem set...)\n\nThere are $q$ students registered for next year's \"Algorithms and Data Structures\" course. By examining each student's previous learning situation, Little O decides to teach each student according to their aptitude. Specifically, for the $k$-th student and the $i$-th knowledge point, Little O wants this student to complete exactly $c_{k, i}$ practice problems of this knowledge point.\n\nIn fact, Little O has close ties with University T and wants to stir up some trouble at University U. For each student, let the total improvements in algorithm ability and data structure ability from all selected practice problems be $A$ and $D$, respectively. Little O's goal is to maximize $A^2 + D^2$. In this way, no matter how much the student's abilities increase or decrease in either aspect, it is what Little O wants.\n\nPlease compute the maximum value of this objective for each student.", "inputFormat": "Each input file contains only one testdata.\n\n* The first line contains three positive integers $n, m, q$.\n\n* The next $n$ lines each contain $m$ integers; in the $i$-th of these lines, the $j$-th integer is $a_{i, j}$.\n\n* The next $n$ lines each contain $m$ integers; in the $i$-th of these lines, the $j$-th integer is $d_{i, j}$.\n\n* The next $q$ lines each contain $n$ integers; in the $k$-th of these lines, the $i$-th integer is $c_{k, i}$.\n\nFor each line of input, if multiple numbers are given, then adjacent numbers are separated by exactly one space.", "outputFormat": "Output $q$ lines, each with 1 integer: the integer on line $k$ is the maximum value of $A^2 + D^2$ for the $k$-th student.", "hint": "### Sample Explanation\n\nThere are 2 knowledge points, and each knowledge point has 4 practice problems; there are 4 students.\n\nTake the 2nd student as an example. We need to select exactly 2 practice problems from the 1st knowledge point and exactly 1 practice problem from the 2nd knowledge point for this student. One optimal plan is to choose the 1st and 3rd problems in the 1st knowledge point, and choose the 1st problem in the 2nd knowledge point. The improvement in algorithm ability from these problems is $A = a_{1,1} + a_{1,3} + a_{2,1} = 1 + (-1) + 0 = 0$, and the improvement in data structure ability is $D = d_{1,1} + d_{1,3} + d_{2,1} = 1 + 1 + 10 = 12$. Then $A^2 + D^2 = 144$, and there is no better plan.\n\n### Constraints\n\n$1 \\leq n \\leq 6$, $1 \\leq m \\leq 666$, $1 \\leq q \\leq 666$, and all $a_{i, j}$ and $d_{i, j}$ are in the range $[-10^9, 10^9]$.\nFor the final testdata, all $c_{k, i}$ are generated independently and uniformly at random in the range $[0, m]$.\n\n### Hint\n\nEach output number may be very large, and may even exceed the range of 64-bit integers.\n\n* In C++, you can use the `__int128_t` type to represent signed 128-bit integers, or use `__uint128_t` to represent unsigned 128-bit integers. These two data types cannot be directly used for input/output.\n\n* In Java, you can use the `BigInteger` class.\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Intercollegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 《算法与数据结构》小助教招募通知", "background": "T 大学和 U 大学是 W 国最好的两个大学。《算法与数据结构》是 U 大学的一门经典课程，曾连续百余年获得“U 大学一级精品课程”的荣誉。\n\n小 O 是这门课明年的助教。由于这门课过于火爆，他一个人忙不过来，所以他正在招募这门课的小助教。不过，招募的条件有点奇怪……", "description": "《算法与数据结构》课程的内容共分为 $n$ 个知识点，而每个知识点均有配套的的 $m$ 道练习题。每道题有两个属性值，第 $i$ 个知识点的第 $j$ 道练习题可以让做这道题的学生的算法能力提高 $a_{i, j}$，数据结构能力提高 $d_{i, j}$。这些属性值均为整数，但是可能为负数，甚至可能存在两个属性均为负的练习题。（不要问这种题是怎么被加进题库的…）\n\n明年的《算法与数据结构》课共有 $q$ 个学生注册。通过对每个学生以前学习情况的考察，小 O 决定对每个学生进行“因材施教”。具体方法是，对于第 $k$ 个学生、第 $i$ 个知识点，小 O 希望这个学生完成这个知识点的恰好 $c_{k, i}$ 道练习题。\n\n其实小 O 和 T 大学关系密切，希望在 U 大学搞点事情。对于每个学生，设为该学生选出的所有练习题对于算法能力与数据结构能力的提升分别为 $A$ 与 $D$，小 O 的目标是最大化 $A^2+D^2$，这样无论这个学生在哪个方面能力提升或降低的程度很大，都是小 O 所期望的。\n\n请对于每个学生计算这个目标的最大值。", "inputFormat": "每个输入文件仅包含一个测试数据。\n\n* 第一行包含三个正整数 $n, m, q$。\n\n* 接下来 $n$ 行，每行包含 $m$ 个整数；其中第 $i$ 行的第 $j$ 个整数为 $a_{i, j}$。\n\n* 接下来 $n$ 行，每行包含 $m$ 个整数；其中第 $i$ 行的第 $j$ 个整数为 $d_{i, j}$。\n\n* 接下来 $q$ 行，每行包含 $n$ 个整数；其中第 $k$ 行的第 $i$ 个整数为 $c_{k, i}$。\n\n对于输入的每一行，如果有多个数输入，则相邻两个数用恰好一个空格隔开。", "outputFormat": "输出 $q$ 行，每行 1 个整数：第 $k$ 行的整数表示第 $k$ 个学生的 $A^2+D^2$ 的最大值。", "hint": "### 样例解释\n\n有 2 个知识点，每个知识点有 4 道练习题；有 4 个学生。\n\n以第 2 个学生为例，我们需要为该学生在第 1 个知识点中选择恰好 2 道练习题，在第 2 个知识点中选择恰好 1 道练习题。一种最优的方案是，在第 1 个知识点中选择第 1 道题和第 3 道题，在第 2 个知识点中选择第 1 道题。这些题目对于算法能力的提高为 $A=a_{1,1}+a_{1,3}+a_{2,1}=1+(-1)+0=0$，对于数据结构能力的提高为 $D=d_{1,1}+d_{1,3}+d_{2,1}=1+1+10=12$，此时 $A^2+D^2=144$，并且不存在更优的方案。\n\n### 数据范围\n\n$1 \\leq n \\leq 6$，$1 \\leq m \\leq 666$，$1 \\leq q \\leq 666$，所有的 $a_{i, j}$ 与 $d_{i, j}$ 均在 $[-10^9,10^9]$ 范围内。\n对于最终测试数据，所有的 $c_{k, i}$ 均在 $[0, m]$ 范围内**独立、均匀**随机生成。\n\n### 提示\n\n输出的每个数可能非常大，甚至可能超过64位整数的范围。\n\n* C++语言可以使用`__int128_t`类型表示带符号128位整数，或使用`__uint128_t`类型表示无符号128位整数；这两种数据类型无法直接进行输入/输出。\n\n* Java语言可以使用`BigInteger`类。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5450", "type": "P", "difficulty": 7, "samples": [["4 1 2\n1 2\n2 3\n3 4", "4"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 淘米神的树", "background": "", "description": "可爱的 Tommy 有一棵树。这棵树上只有点 $a$ 和 $b$ 是黑色，其它的点都是白色。\n\n每次，Tommy 可以将一个黑色 $p$ 的点染成红色，然后把和 $p$ 相邻的所有白色的点染成黑色。最后，所有的点都会被染成红色。\n\n设第 $i$ 个点是第 $t_i$ 个被染成红色的，那么 $t_i$ 是一个 $1$ 到 $n$ 的排列。Tommy 希望你帮他求出，有多少种不同的 $t_i$。", "inputFormat": "每个输入文件仅包含一个测试数据。\n\n* 第一行三个用空格隔开的正整数 $n,a,b$，表示树的点数和初始的黑色点的编号；\n\n* 接下来 $n-1$ 行，每行两个正整数 $x,y$ 描述树上的一条边 $\\left( x,y\\right)$。\n\n树上的节点从 $1$ 开始编号。", "outputFormat": "输出 $1$ 行：\n\n* 一个整数，表示不同的排列 $t_i$ 的个数除以 $998,244,353$ 的余数。", "hint": "### 数据范围\n\n保证 $a,b\\le n\\le 234,567$。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Taomi God’s Tree", "background": "", "description": "Lovely Tommy has a tree. In this tree, only vertices $a$ and $b$ are black, and all other vertices are white.\n\nEach time, Tommy can recolor a black vertex $p$ to red, and then recolor all white vertices adjacent to $p$ into black. In the end, all vertices will be recolored to red.\n\nLet the $i$-th vertex be recolored to red as the $t_i$-th one; then $t_i$ is a permutation of $1$ to $n$. Tommy wants you to help him find how many different $t_i$ there are.", "inputFormat": "Each input file contains only one testdata.\n\n* The first line contains three positive integers $n,a,b$ separated by spaces, representing the number of vertices of the tree and the indices of the initial black vertices.\n\n* The next $n-1$ lines each contain two positive integers $x,y$, describing an edge $\\left( x,y\\right)$ in the tree.\n\nThe vertices of the tree are numbered starting from $1$.", "outputFormat": "Output $1$ line:\n\n* One integer, representing the number of different permutations $t_i$ modulo $998,244,353$.", "hint": "### Constraints\n\nIt is guaranteed that $a,b\\le n\\le 234,567$.\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Collegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 淘米神的树", "background": "", "description": "可爱的 Tommy 有一棵树。这棵树上只有点 $a$ 和 $b$ 是黑色，其它的点都是白色。\n\n每次，Tommy 可以将一个黑色 $p$ 的点染成红色，然后把和 $p$ 相邻的所有白色的点染成黑色。最后，所有的点都会被染成红色。\n\n设第 $i$ 个点是第 $t_i$ 个被染成红色的，那么 $t_i$ 是一个 $1$ 到 $n$ 的排列。Tommy 希望你帮他求出，有多少种不同的 $t_i$。", "inputFormat": "每个输入文件仅包含一个测试数据。\n\n* 第一行三个用空格隔开的正整数 $n,a,b$，表示树的点数和初始的黑色点的编号；\n\n* 接下来 $n-1$ 行，每行两个正整数 $x,y$ 描述树上的一条边 $\\left( x,y\\right)$。\n\n树上的节点从 $1$ 开始编号。", "outputFormat": "输出 $1$ 行：\n\n* 一个整数，表示不同的排列 $t_i$ 的个数除以 $998,244,353$ 的余数。", "hint": "### 数据范围\n\n保证 $a,b\\le n\\le 234,567$。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5451", "type": "P", "difficulty": 5, "samples": [["1\n1502992813 2511821915 653507 57809 2638352023", "19260817"]], "limits": {"time": [1000, 1000], "memory": [512000, 512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 密码学第三次小作业", "background": "1977年，罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）提出了RSA 加密算法。RSA 加密算法是一种非对称加密算法，其可靠性由极大整数因数分解的难度决定。换言之，对一极大整数做因数分解愈困难，RSA 算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用 RSA 加密的信息的可靠性就肯定会极度下降。\n\nRSA 的基本原理如下：\n\n- 公钥与私钥的产生\n  1. 随机选择两个不同大质数 $p$ 和 $q$，计算 $N=p\\times q$\n  2. 根据欧拉函数性质，求得 $r=\\varphi (N)=\\varphi (p)\\varphi (q)=(p-1)(q-1)$\n  3. 选择一个小于 $r$ 的正整数 $e$，使 $e$ 和 $r$ 互质。并求得 $e$ 关于 $r$ 的乘法逆元 $d$，有 $ed\\equiv 1 \\pmod r$\n  4. 将 $p$ 和 $q$ 的记录销毁。此时，$(N,e)$ 是公钥，$(N,d)$ 是私钥。\n- 消息加密：首先需要将消息 $m$ 以一个双方约定好的格式转化为一个小于 $N$，且与 $N$ 互质的整数 $n$。如果消息太长，可以将消息分为几段，这也就是我们所说的块加密，后对于每一部分利用如下公式加密：\n\n$$\nn^{e}\\equiv c\\pmod N\n$$\n\n- 消息解密：利用密钥 $d$ 进行解密\n\n$$\nc^{d}\\equiv n\\pmod N\n$$", "description": "现在有两个用户由于巧合，拥有了相同的模数 $N$，但是私钥不同。设两个用户的公钥分别为 $e_1$ 和 $e_2$，**且两者互质**。明文消息为 $m$，密文分别为：\n\n$$\\begin{matrix}c_1=m^{e_1}\\bmod N\\\\c_2=m^{e_2}\\bmod N\\end{matrix}$$\n\n现在，一个攻击者截获了 $c_1$ ，$c_2$，$e_1$，$e_2$，$N$，请帮助他恢复出明文 $m$ 。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数，保证 $1\\le T\\le 10^4$ 。接下来依次描述每组数据，对于每组数据：\n\n* 一行包含五个正整数 $c_1$，$c_2$，$e_1$，$e_2$，$N$，保证 $2^{8}< N < 2^{63}$，$N$ 有且仅有两个素因子，其余数据严格按照上述RSA算法生成。\n", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n- 一个非负整数 $m$，请选手务必在输出时保证 $0\\le m<N$。答案 $m$ 保证与 $N$ 互质。", "hint": "### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] The Third Cryptography Homework", "background": "In 1977, Ronald Rivest, Adi Shamir, and Leonard Adleman proposed the RSA encryption algorithm. RSA is an asymmetric encryption algorithm, and its security depends on the difficulty of factoring very large integers. In other words, the harder it is to factor a very large integer, the more reliable RSA is. If someone finds a fast factoring algorithm, then the security of information encrypted with RSA will definitely drop a lot.\n\nThe basic idea of RSA is as follows:\n\n- Generating the public key and private key\n  1. Randomly choose two different large primes $p$ and $q$, and compute $N=p\\times q$.\n  2. By the property of Euler's totient function, compute $r=\\varphi (N)=\\varphi (p)\\varphi (q)=(p-1)(q-1)$.\n  3. Choose a positive integer $e$ less than $r$ such that $e$ and $r$ are coprime. Then compute the multiplicative inverse $d$ of $e$ modulo $r$, satisfying $ed\\equiv 1 \\pmod r$.\n  4. Destroy the records of $p$ and $q$. At this point, $(N,e)$ is the public key, and $(N,d)$ is the private key.\n- Message encryption: First, convert the message $m$ into an integer $n$ that is less than $N$ and coprime with $N$, in a format agreed upon by both parties. If the message is too long, it can be split into several parts (this is what we call block encryption). Then each part is encrypted using:\n\n$$\nn^{e}\\equiv c\\pmod N\n$$\n\n- Message decryption: Decrypt using the key $d$:\n\n$$\nc^{d}\\equiv n\\pmod N\n$$", "description": "Now there are two users who, by coincidence, have the same modulus $N$ but different private keys. Let their public keys be $e_1$ and $e_2$, **and they are coprime**. The plaintext message is $m$, and the ciphertexts are:\n\n$$\\begin{matrix}c_1=m^{e_1}\\bmod N\\\\c_2=m^{e_2}\\bmod N\\end{matrix}$$\n\nNow, an attacker has intercepted $c_1$, $c_2$, $e_1$, $e_2$, and $N$. Please help him recover the plaintext $m$.", "inputFormat": "The input contains multiple test cases. The first line contains an integer $T$ indicating the number of test cases, and it is guaranteed that $1\\le T\\le 10^4$ . Then each test case is described as follows:\n\n- One line contains five positive integers $c_1$, $c_2$, $e_1$, $e_2$, $N$. It is guaranteed that $2^{8}< N < 2^{63}$, $N$ has exactly two prime factors, and the other values are generated strictly according to the RSA algorithm described above.", "outputFormat": "For each test case, output $1$ line:\n\n- A non-negative integer $m$. Please make sure that $0\\le m<N$ when outputting. It is guaranteed that the answer $m$ is coprime with $N$.", "hint": "### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Intercollegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nSolutions and other resources can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 密码学第三次小作业", "background": "1977年，罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）提出了RSA 加密算法。RSA 加密算法是一种非对称加密算法，其可靠性由极大整数因数分解的难度决定。换言之，对一极大整数做因数分解愈困难，RSA 算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用 RSA 加密的信息的可靠性就肯定会极度下降。\n\nRSA 的基本原理如下：\n\n- 公钥与私钥的产生\n  1. 随机选择两个不同大质数 $p$ 和 $q$，计算 $N=p\\times q$\n  2. 根据欧拉函数性质，求得 $r=\\varphi (N)=\\varphi (p)\\varphi (q)=(p-1)(q-1)$\n  3. 选择一个小于 $r$ 的正整数 $e$，使 $e$ 和 $r$ 互质。并求得 $e$ 关于 $r$ 的乘法逆元 $d$，有 $ed\\equiv 1 \\pmod r$\n  4. 将 $p$ 和 $q$ 的记录销毁。此时，$(N,e)$ 是公钥，$(N,d)$ 是私钥。\n- 消息加密：首先需要将消息 $m$ 以一个双方约定好的格式转化为一个小于 $N$，且与 $N$ 互质的整数 $n$。如果消息太长，可以将消息分为几段，这也就是我们所说的块加密，后对于每一部分利用如下公式加密：\n\n$$\nn^{e}\\equiv c\\pmod N\n$$\n\n- 消息解密：利用密钥 $d$ 进行解密\n\n$$\nc^{d}\\equiv n\\pmod N\n$$", "description": "现在有两个用户由于巧合，拥有了相同的模数 $N$，但是私钥不同。设两个用户的公钥分别为 $e_1$ 和 $e_2$，**且两者互质**。明文消息为 $m$，密文分别为：\n\n$$\\begin{matrix}c_1=m^{e_1}\\bmod N\\\\c_2=m^{e_2}\\bmod N\\end{matrix}$$\n\n现在，一个攻击者截获了 $c_1$ ，$c_2$，$e_1$，$e_2$，$N$，请帮助他恢复出明文 $m$ 。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数，保证 $1\\le T\\le 10^4$ 。接下来依次描述每组数据，对于每组数据：\n\n* 一行包含五个正整数 $c_1$，$c_2$，$e_1$，$e_2$，$N$，保证 $2^{8}< N < 2^{63}$，$N$ 有且仅有两个素因子，其余数据严格按照上述RSA算法生成。\n", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n- 一个非负整数 $m$，请选手务必在输出时保证 $0\\le m<N$。答案 $m$ 保证与 $N$ 互质。", "hint": "### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5452", "type": "P", "difficulty": 0, "samples": [["3 5\n4 1 -10.10 -10.20 10.30 -10.40 10.50 10.60 -10.70 10.80\n4 2 -20.80 -20.70 20.60 -20.50 20.40 20.30 -20.20 20.10\n4 1 -30.10 -30.30 30.50 -30.70 30.20 30.40 -30.60 30.80\n2 1 15.80 15.60\n2 1 25.40 25.20\n1 2\n2 1 15.70 15.50\n2 1 25.30 25.10", "3271.8500\n3271.8500\n1236.0000\n2035.8500"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 琪亚娜之墙", "background": "", "description": "那一天，人类终于回想起，曾经一度被她们支配的恐惧，还有被囚禁于鸟笼中的那份耻辱。\n\n为了守护最珍视之物，Kiana建立起了 $n$ 座围墙，每一座围墙都闭合形成了一个**凸多边形**，不同的围墙**互不相交**。出于特别的目的，围墙分为两种：用砖瓦和岩石砌成的**工匠之墙**、用树木和荆棘形成的**自然之墙**。\n\n只依靠墙壁并不使人放心，Kiana还派遣了两类士兵在墙内巡逻：\n\n**追魂猎人**：他们从小与大自然为伴，可以自由穿越自然之墙，但无法通过工匠之墙。\n\n**天马骑士**：他们拥有在天空中飞行的能力，可以自由飞越工匠之墙，但由于某些信仰的缘故，无法通过自然之墙。\n\n只依靠墙壁和士兵任然难以让人放心，但Kiana还拥有神之力量，在某段时间内，她发挥了 $m$ 次这股力量，以完成两类事件：\n\n1. 将某座工匠之墙转化为自然之墙，或将某座自然之墙转化为工匠之墙。\n\n2. 将一位追魂猎人或天马骑士直接传送到坐标 $(x,y)$ 处，保证这个坐标不位于围墙之上，且与最近的围墙相距至少 $10^{-3}$。\n\n在每一次传送士兵完成后，Kiana希望知道这名士兵可以自由活动的区域**面积**有多大。由于她不会做，所以希望你来告诉她答案。", "inputFormat": "输入第一行包含两个正整数 $n$ 和 $m$，分别表示围墙的数量和Kiana发动神之力量的次数，数据保证 $n\\leq 3\\times 10^4$且 $m\\leq 10^5$。\n\n接下来 $n$ 行，第 $i$ 行用于描述第 $i$ 座围墙的情况，首先有两个正整数 $k_i$ 和 $r_i$，分别表示这座围墙的顶点数和类型，若 $r_i=1$ 表示这是工匠之墙，若 $r_i=2$ 表示这是自然之墙，接下来 $2k_i$ 个实数，第 $2p-1$ 和第 $2p$ 个数表示这座围墙上第 $p$ 个顶点的横、纵坐标，所有的顶点按照在多边形上逆时针排列的顺序输入，数据保证 $3\\leq k_i\\leq 100$ 且 $\\sum_{i=1}^{n}k_i\\leq 10^5$。\n\n接下来 $m$ 行，第 $j$ 行用于描述Kiana第 $j$ 次使用神之力量的情况，首先有一个正整数 $op$，表示Kiana发动的神之力量类型，若：\n\n$op=1$：这一行还有一个正整数 $u$，表示Kiana转换了第 $u$ 座围墙的类型（若本来为工匠之墙，则转化为自然之墙，若本来为自然之墙，则转化为工匠之墙），数据保证 $1\\leq u\\leq n$。\n\n$op=2$：这一行还有一个正整数 $v$ 与两个实数 $x$ 和 $y$，若 $v=1$，表示Kiana将一名追魂猎人传送到了 $(x,y)$ 处，若 $v=2$，表示Kiana将一名天马骑士传送到了 $(x,y)$ 处。\n\n数据保证所有的 $r_i$、$op$ 和 $v$ 的取值仅为 $1$ 或 $2$，所有的实数保留到小数点后两位且绝对值小于 $2\\times 10^5$，任意两个的多边形之间的距离至少为 $10^{-3}$，任意两个输入顶点的横坐标之差与纵坐标之差的绝对值不小于 $10^{-3}$。", "outputFormat": "输出由若干行组成，对于每个 $op=2$ 的输入，输出一行一个实数 $S$（保留到小数点后 $4$ 位），表示该名士兵可以自由活动的区域面积，数据保证这个面积是有限的。", "hint": "来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Kiana’s Wall.", "background": "", "description": "That day, humanity finally remembered the fear of being ruled by them, and the shame of being imprisoned in a cage.\n\nTo protect what she values most, Kiana built $n$ walls. Each wall is closed and forms a **convex polygon**, and different walls **do not intersect** each other. For special purposes, the walls are divided into two types: the **Craftsman Wall**, built from bricks and rocks, and the **Natural Wall**, formed by trees and thorns.\n\nRelying only on walls is still not reassuring, so Kiana also sent two types of soldiers to patrol inside the walls:\n\n**Soul Hunter**: They grew up with nature, can pass through Natural Walls freely, but cannot pass through Craftsman Walls.\n\n**Pegasus Knight**: They can fly in the sky, so they can fly over Craftsman Walls freely, but due to certain beliefs, they cannot pass through Natural Walls.\n\nEven relying on walls and soldiers is still not reassuring, but Kiana also possesses divine power. During a period of time, she used this power $m$ times to perform two kinds of events:\n\n1. Convert a Craftsman Wall into a Natural Wall, or convert a Natural Wall into a Craftsman Wall.\n\n2. Teleport a Soul Hunter or a Pegasus Knight directly to the coordinate $(x,y)$. It is guaranteed that this coordinate is not on any wall, and its distance to the nearest wall is at least $10^{-3}$.\n\nAfter each soldier teleportation, Kiana wants to know the **area** of the region where this soldier can move freely. Since she cannot do it, she hopes you can tell her the answer.", "inputFormat": "The first line contains two positive integers $n$ and $m$, representing the number of walls and the number of times Kiana uses divine power. The testdata guarantees $n\\leq 3\\times 10^4$ and $m\\leq 10^5$.\n\nIn the next $n$ lines, the $i$-th line describes the $i$-th wall. It starts with two positive integers $k_i$ and $r_i$, representing the number of vertices and the type of this wall. If $r_i=1$, it is a Craftsman Wall; if $r_i=2$, it is a Natural Wall. Then follow $2k_i$ real numbers: the $(2p-1)$-th and $2p$-th numbers are the $x$- and $y$-coordinates of the $p$-th vertex of this wall. All vertices are given in counterclockwise order along the polygon. The testdata guarantees $3\\leq k_i\\leq 100$ and $\\sum_{i=1}^{n}k_i\\leq 10^5$.\n\nIn the next $m$ lines, the $j$-th line describes the $j$-th use of divine power. It starts with a positive integer $op$, indicating the type of operation. If:\n\n$op=1$: This line also contains a positive integer $u$, meaning Kiana changes the type of wall $u$ (if it is originally a Craftsman Wall, it becomes a Natural Wall; if it is originally a Natural Wall, it becomes a Craftsman Wall). The testdata guarantees $1\\leq u\\leq n$.\n\n$op=2$: This line also contains a positive integer $v$ and two real numbers $x$ and $y$. If $v=1$, Kiana teleports a Soul Hunter to $(x,y)$; if $v=2$, Kiana teleports a Pegasus Knight to $(x,y)$.\n\nThe testdata guarantees that all $r_i$, $op$, and $v$ take values only $1$ or $2$. All real numbers are given with exactly two digits after the decimal point and have absolute value less than $2\\times 10^5$. The distance between any two polygons is at least $10^{-3}$. For any two input vertices, the absolute value of the difference in their $x$-coordinates and the absolute value of the difference in their $y$-coordinates are both at least $10^{-3}$.", "outputFormat": "The output consists of several lines. For each input with $op=2$, output one line with a real number $S$ (rounded to $4$ digits after the decimal point), representing the area of the region where the soldier can move freely. The testdata guarantees that this area is finite.", "hint": "From the 2018 Tsinghua University Programming Contest and Collegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nSolutions and other resources can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 琪亚娜之墙", "background": "", "description": "那一天，人类终于回想起，曾经一度被她们支配的恐惧，还有被囚禁于鸟笼中的那份耻辱。\n\n为了守护最珍视之物，Kiana建立起了 $n$ 座围墙，每一座围墙都闭合形成了一个**凸多边形**，不同的围墙**互不相交**。出于特别的目的，围墙分为两种：用砖瓦和岩石砌成的**工匠之墙**、用树木和荆棘形成的**自然之墙**。\n\n只依靠墙壁并不使人放心，Kiana还派遣了两类士兵在墙内巡逻：\n\n**追魂猎人**：他们从小与大自然为伴，可以自由穿越自然之墙，但无法通过工匠之墙。\n\n**天马骑士**：他们拥有在天空中飞行的能力，可以自由飞越工匠之墙，但由于某些信仰的缘故，无法通过自然之墙。\n\n只依靠墙壁和士兵任然难以让人放心，但Kiana还拥有神之力量，在某段时间内，她发挥了 $m$ 次这股力量，以完成两类事件：\n\n1. 将某座工匠之墙转化为自然之墙，或将某座自然之墙转化为工匠之墙。\n\n2. 将一位追魂猎人或天马骑士直接传送到坐标 $(x,y)$ 处，保证这个坐标不位于围墙之上，且与最近的围墙相距至少 $10^{-3}$。\n\n在每一次传送士兵完成后，Kiana希望知道这名士兵可以自由活动的区域**面积**有多大。由于她不会做，所以希望你来告诉她答案。", "inputFormat": "输入第一行包含两个正整数 $n$ 和 $m$，分别表示围墙的数量和Kiana发动神之力量的次数，数据保证 $n\\leq 3\\times 10^4$且 $m\\leq 10^5$。\n\n接下来 $n$ 行，第 $i$ 行用于描述第 $i$ 座围墙的情况，首先有两个正整数 $k_i$ 和 $r_i$，分别表示这座围墙的顶点数和类型，若 $r_i=1$ 表示这是工匠之墙，若 $r_i=2$ 表示这是自然之墙，接下来 $2k_i$ 个实数，第 $2p-1$ 和第 $2p$ 个数表示这座围墙上第 $p$ 个顶点的横、纵坐标，所有的顶点按照在多边形上逆时针排列的顺序输入，数据保证 $3\\leq k_i\\leq 100$ 且 $\\sum_{i=1}^{n}k_i\\leq 10^5$。\n\n接下来 $m$ 行，第 $j$ 行用于描述Kiana第 $j$ 次使用神之力量的情况，首先有一个正整数 $op$，表示Kiana发动的神之力量类型，若：\n\n$op=1$：这一行还有一个正整数 $u$，表示Kiana转换了第 $u$ 座围墙的类型（若本来为工匠之墙，则转化为自然之墙，若本来为自然之墙，则转化为工匠之墙），数据保证 $1\\leq u\\leq n$。\n\n$op=2$：这一行还有一个正整数 $v$ 与两个实数 $x$ 和 $y$，若 $v=1$，表示Kiana将一名追魂猎人传送到了 $(x,y)$ 处，若 $v=2$，表示Kiana将一名天马骑士传送到了 $(x,y)$ 处。\n\n数据保证所有的 $r_i$、$op$ 和 $v$ 的取值仅为 $1$ 或 $2$，所有的实数保留到小数点后两位且绝对值小于 $2\\times 10^5$，任意两个的多边形之间的距离至少为 $10^{-3}$，任意两个输入顶点的横坐标之差与纵坐标之差的绝对值不小于 $10^{-3}$。", "outputFormat": "输出由若干行组成，对于每个 $op=2$ 的输入，输出一行一个实数 $S$（保留到小数点后 $4$ 位），表示该名士兵可以自由活动的区域面积，数据保证这个面积是有限的。", "hint": "来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5453", "type": "P", "difficulty": 6, "samples": [["4\n2 4 4 2\n0 0 0 0\n0 0 0 1\n1 2 1 1 0 2 1 10 1 2dsaigao 1 0 20\n2 1 1 1 0 0 1 10 1 faceking\n2 1 1 1 0 3 1 10 1 rabiribi 1\n1 3 1 1 0 1 1 10 1 toolihai\n1 5 4 4\n0 0 0 0 0\n1 1 2 2 0 3 1 1 100 onepunch 1 2\n1 2 1 1 1 0 1 1 100 toolihai\n1 3 1 1 1 0 1 1 100 toolihai\n1 4 2 1 1 0 1 1 100 toolihai\n1 4 1 4\n0 0 0 0\n1 1 1 1 0 3 3 2 2 backward 2\n10 10 10 20\n0 0 0 1 0 1 0 0 0 1\n0 0 0 0 0 0 0 0 0 1\n0 1 0 0 1 0 0 1 0 0\n0 0 0 0 0 1 0 0 0 0\n0 0 0 0 0 1 0 0 0 1\n0 1 0 0 0 0 0 0 0 0\n1 0 0 0 1 0 1 0 1 1\n0 0 0 0 0 0 0 0 0 1\n0 0 1 0 1 1 0 1 0 1\n1 0 0 0 0 0 0 0 0 0\n10 9 8 0 0 1 6 7 2 viuganda\n5 3 10 0 1 1 6 3 7 toolihai\n2 7 6 3 0 3 7 3 1 faceking\n5 7 10 9 1 3 9 8 8 rabiribi 10\n6 10 1 1 0 1 11 7 7 backward 9\n2 3 8 5 0 3 2 9 4 onepunch 6 1\n1 7 8 2 0 3 11 2 5 hupraise\n9 9 4 3 1 3 12 4 9 gugugugu\n2 1 10 6 1 2 6 6 2 2dsaigao 9 9 9\n10 10 10 5 1 1 12 4 8 firework 4", "1 1\n1 1\n2 3\n2 1\n1 4\n1 2\n1 3\n1 4\n1 2\n5\n10 6\n2 5\n1 5\n5 8\n6 10\n1 7\n1 5\n8 9\n4 9\n8 1"]], "limits": {"time": [10000], "memory": [512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 组合数问题", "background": "**友情提示：本题篇幅较长。**", "description": "众所周知，小葱同学擅长计算，尤其擅长计算组合数。\n\n于是现在我们有了一个 $N\\times M$ 的棋盘，棋盘上有些地方会有障碍物的存在。在棋盘上有 $K$ 枚棋子，每枚棋子要么属于红队要么属于蓝队。此外，每枚棋子有两个属性值，第 $i$ 枚棋子的两个属性记为 $a_i,b_i$ 并且保证 $a_i\\geq b_i$。既然有了两支队伍那么小葱同学就要来玩游戏，这个游戏一共有 $R$ 个回合。每个回合内，每枚棋子会按照如下顺序进行游戏：\n\n0. 回合开始，记当前是第 $H$ 回合。若现在为游戏的开始时刻，则 $H=1$。\n\n1. 对于所有能够移动的棋子，沿着自己当前的方向移动一格。每枚棋子的朝向一定是上下左右中的一种。如果棋子发现自己不能移动，即前方格子为棋盘外部或者障碍物，那么则不向前移动，而是将自己的方向旋转一百八十度，即进行向后转的操作（注意此时转了之后棋子这回合内并不会进行移动）。\n\n2. 对于所有棋子，每个棋子都拥有且仅拥有一种技能。此时所有棋子按照编号从小到大依次释放技能，如果不能释放技能则跳过。技能总共分为以下几种：\n\n\t1. 重锤火花（toolihai）：以自身为中心，制造出绚丽的烟花，令人赏心悦目，无任何效果。\n\n\t2. 面子之王（faceking）：该棋子充满了面子，所有棋子都要听其号令，使得所有棋子的方向强制向左（逆时针）转九十度。该技能的效果持续时间为永久。\n\n\t3. 头发掉光（onepunch）：头发掉光之后，王队长变得更强了，使该枚棋子的属性大幅度提升。即若当前棋子 $i$ 的属性为 $\\left(a_i,b_i\\right)$，属性的提升值为 $v$，那么该棋子的属性则变为 $\\left(a_i+v,b_i\\right)$。该技能的效果能持续 $l$ 个回合，若当前回合为 $H$，则该技能效果会在第 $H+l$ 回合开始的时候消失。若在技能消失前棋子 $i$ 的属性为 $\\left(a_i,b_i\\right)$，则技能效果消失后其属性会变为 $\\left(\\max\\left(a_i-v,0\\right),\\min\\left(b_i,\\max\\left(a_i-v,0\\right)\\right)\\right)$。注意在该技能效果消失前该技能可能被再次释放，则多次释放的技能效果叠加，但技能效果消失的时间分开计算。（详见样例第二组数据）\n\n\t4. 拉比哩比（rabiribi）：挥动真正的重锤，制造火花，击退前方扇形区域的所有敌方单位。该技能所能影响到的范围为前方大小为 $v$ 的扇形区域，所谓扇形区域可见下图：\n\n        ![](https://cdn.luogu.com.cn/upload/image_hosting/zgtwzsld.png)\n\t\t\n        从上图我们可以看出，在图的最下方有正在释放技能的棋子，其技能朝向为上，所以其技能方向也为上。则上方的所有区域则为其技能所影响到的扇形区域，该扇形区域大小为 $5$，即 $v=5$。注意到棋盘上某些位置会有障碍物，障碍物的存在会影响到该技能的影响范围。如果一个障碍物存在于技能范围之内，那么以障碍物开始的处于技能范围内的扇形区域也都不会受到技能的影响。如上图可见，所有黑色格子的最下方格子即为障碍物的位置，所有黑色格子即为受到障碍物影响所不能被技能效果影响的格子。\n        \n        另一方面，击退效果的定义为将受到技能影响效果的棋子沿着技能释放方向强制移动一格，即从图中 $p_2$ 被击退到 $p_3$ 的位置。如果被击退方向是障碍物或者棋盘边界，则按一下规则进行：\n        \n        - 如果下一位置为障碍物，则被击退到该障碍物后面，即从图中的 $p_0$ 击退到 $p_1$。\n        - 如果下一位置为棋盘外部，如当前在第一行并且要被击退到第零行，则被击退到第 $N$ 行对应的同一列的位置。\n        \n        重复以上过程直到被击退到一个不是障碍物和棋盘外部的位置，则该击退过程结束。（详见样例第一组数据）\n\t\n\t5. 退学花火（firework）：退学之后，有了更多的时间来挖坑。使得上一个释放重锤火花的棋子在接下来 $l$ 回合内无法移动。如果不存在这样的棋子，则使自己在接下来 $l$ 回合内无法移动。\n\n\t6. 救乌干达（viuganda）：使用vim，拯救阵亡的棋子，复活距离自身最远的阵亡的己方棋子。若己方没有阵亡棋子，则复活对方距离自身最近的阵亡棋子。如果对方也没有阵亡棋子，则什么也不做。我们这里使用的距离为曼哈顿距离，即若第 $i$ 枚棋子处于位置 $\\left(x_i,y_i\\right)$， 第 $j$ 枚棋子处于位置 $\\left(x_j,y_j\\right)$，那么此时两枚棋子的距离为 $\\left|x_i-x_j\\right|+\\left|y_i-y_j\\right|$。如果同时有多枚棋子距离当前棋子的曼哈顿距离一样，那么我们选择其中编号最大的棋子即可。棋子被复活后如果当前回合可以释放技能并且仍然没有被跳过，则会释放技能。\n\n\t7. 降维打击（2dsaigao）：利用超时空武器，向自己右前方发射动感光波，使得某个区域内的单位不能释放技能。该动感光波发射之后，遇到棋盘边缘或者障碍物则会发生方向改变的现象，如下图所示：\n\t\n\t\t![](https://cdn.luogu.com.cn/upload/image_hosting/3j1makll.png)\n\t\t\n        中间格子为当前棋子所处的位置，其方向向左。每当该光波会进入一个有障碍物的格子或者棋盘边缘的时候，该光波就会改变自己的方向顺时针旋转 $90^\\circ$。该光波每从一个格子的中心到达另一个格子的中心时我们称该光波走了 $1$ 的距离。当光波走了 $o$ 的距离之后，光波就会以当前格子为中心发生爆炸，使得所有距离当前格子曼哈顿距离不超过 $v$ 的棋子在接下来 $l$ 回合的时间内都不能释放技能，即从现在到第 $H+l$ 回合开始的这段时间内都不能释放技能。（详见样例第一组数据）\n\t\t\n\t8. 咕咕咕咕（gugugugu）：做人，绝不能普普通通的鸽了别人；要鸽，必须带着大家一起鸽。该技能效果为使得己方所有当前回合还没有释放技能的棋子全部跳过技能释放的环节，即使得己方还未释放技能的棋子当前回合不能释放技能。\n\t\n\t9. 反向传播（backward）：让时间暂停，让游戏倒流，让自身回到过去，回到之前的某个回合。若当前为第 $H$ 回合，该技能效果是回到 $l$ 回合前，则当前棋子 $i$ 会回到第 $H-l$ 回合。所谓回到第 $H-l$ 回合，即当前棋子的一下所有值都会变回第 $H-l$ 回合开始的时候的值：\n        \n        - 位置及方向。\n        - 属性。\n        - 是否存活以及复活时间。\n        - 受到的技能影响的效果以及剩余时间。\n        \n        注意此时棋子 $i$ 的技能刷新时间并不会回到第 $H-l$ 回合的时间。（详见样例第三组数据）（技能刷新时间的规则会在下面说明）\n\t\t\n\t10. 葱之礼赞（hupraise）：葱的到来，使得今天变为了一个神圣的日子，要将红蓝双方的棋子进行配对。每个红方棋子可以和任何一个蓝方棋子进行配对，并且每个棋子都最多只能和对面一个棋子进行配对。第 $i$ 枚棋子 和第 $j$ 枚棋子能够配对的条件为两个棋子属于不同阵营并且 $a_i\\oplus a_j$ 是 $3$ 的倍数（该符号为异或）。现在每当该技能发动时，你需要求出最多能够配多少对。\n\n\t**技能刷新规则**：对于所有技能，当前为第 $H$ 回合，如果第 $i$ 枚棋子释放了技能，那么在第 $H+z_i$ 回合的时候该技能才回复完毕，才能再次释放技能。如果第 $i$ 枚棋子在当前回合中了一个持续时间为 $l$ 回合的技能，那么该技能的影响将在第 $H+l$ 回合开始的时候消除。对于所有棋子，若其首轮技能回复时间为 $f_i$，技能回复时间为 $z_i$，则若没有其他棋子的影响，其第一次将在第 $f_i$ 回合释放技能，之后每 $z_i$ 回合再次释放技能。\n\n3. 对于棋盘上所有格子，如果一个格子内既有红队棋子又有蓝队棋子，那么此时这个格子内的棋子便会发生交战。交战的规则如下：\n\n    我们规定第 $i$ 枚棋子的战斗力为 $\\binom{a_i}{b_i}$（该式子等价于 $C_{a_i}^{b_i}$）。在交战时，每次由红蓝双方派出己方在这个格子战力最大的棋子进行交战。假设红方派出第 $i$ 枚棋子，蓝方派出第 $j$ 枚棋子。如果红方蓝方两枚棋子战斗力一样，那么派出的两枚棋子均阵亡。若战斗力不一样，假设第 $i$ 枚棋子战力更高，那么第 $j$ 枚棋子阵亡，同时第 $i$ 枚棋子的两个属性变为 $\\max\\left(a_i-a_j,0\\right),\\max\\left(b_i-a_j,0\\right)$。不断重复以上操作直到一方棋子全部阵亡。若第 $i$ 枚棋子在当前回合即第 $H$ 回合阵亡，那么第 $i$ 枚棋子会在第 $H+r_i$ 回合开始的时候复活。第 $i$ 枚棋子复活之后将其两个属性将变为游戏开始时候的属性值，并且移除所有当前棋子身上的技能效果，其移动方向保持阵亡前的移动方向。棋子阵亡期间其技能正常回复，但是不能移动和释放技能，并且不受到其他任何技能的影响。\n\n\n现在小葱告诉你所有与这游戏相关的东西，希望你按照游戏规则来进行游戏，并输出游戏结束之后每个棋子的位置。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n\n* 第一行四个整数 $N,M,K,R$。\n\n* 接下来 $N$ 行每行 $M$ 个数。对于第 $i$ 行第 $j$ 列的数，如果等于 $0$ 则代表第 $i$ 行第 $j$ 列的格子为普通格子，否则为障碍物。\n\n* 接下来 $K$ 行，每行一开始有九个整数 $x_i,y_i,a_i,b_i,c_i,d_i,f_i,z_i,r_i$。代表第 $i$ 枚棋子一开始的位置位于第 $x_i$ 行 第 $y_i$ 列，其属性值为 $a_i,b_i$ 并且所属的阵营为 $c_i$。如果 $c_i=0$ 则为红方否则为蓝方。棋子 $i$ 一开始的朝向为 $d_i$，$d_i=0,1,2,3$ 分别表示上下左右四个方向。$f_i$ 为技能首轮回复时间，$z_i$ 为技能回复时间，即第 $i$ 枚棋子若在没有受到其他棋子影响的情况下，第一次将在第 $f_i$ 回合释放技能，之后每 $z_i$ 回合再次释放技能。$r_i$ 为其复活时间。接下来一个字符串 $s_i$ 为其技能的英文名字，已在每个技能后面注明了其对应的英文名字。对于不同的技能种类，会在当前行增加一定的输入值，具体如下：\n\n\t1. 重锤火花（toolihai），无增加的输入。\n\n\t2. 面子之王（faceking），无增加的输入。\n\n\t3. 头发掉光（onepunch），增加输入 $v_i,l_i$，代表该技能的增益效果和持续时间。\n\n\t4. 拉比哩比（rabiribi），增加输入 $v_i$ 代表技能的范围。\n\t\t\n\t5. 退学花火（firework），增加输入 $l_i$ 代表技能的影响时间。\n\n\t6. 救乌干达（viuganda），无增加的输入。\n\n\t7. 降维打击（2dsaigao），增加输入 $y_i,v_i,l_i$，代表光波能移动的距离、光波爆炸后能影响的范围以及技能的影响持续时间。\n\t\t\t\n\t8. 咕咕咕咕（gugugugu），无增加的输入。\n\t\t\n\t9. 反向传播（backward），增加输入 $l_i$，表示回到 $l_i$ 回合之前，数据保证不会回到游戏开始之前。\n\t\t\t\n\t10. 葱之礼赞（hupraise），无增加的输入。", "outputFormat": "对于每组数据：\n\n* 每当技能 $10$ 发动时，输出一行一个整数。\n\n* 在游戏结束之后，输出 $K$ 行，每行两个整数代表第 $i$ 枚棋子现在处于哪一行哪一列。", "hint": "### 样例解释\n\n对于第一组数据，在左上方释放技能 $7$ 时，是朝着角落里射出的动感光波，所以碰到角落返回回射出点时，此时距离为 $1$，正好原地爆炸，使得技能 $2$ 无法放出。而右下方是在释放技能 $4$ 时，将对方击穿了地图的例子。\n\n对于第二组数据，第一枚棋子每次向右走一步就会释放一次技能。第一回合走到 $(1,2)$，释放技能后属性变为 $(3,2)$，和对方交战后属性变为 $(2,1)$。第二回合走到 $(1,3)$，释放技能后属性变为 $(3,1)$，和对方交战后属性变为 $(3,0)$。第三回合走到 $(1,4)$，由于之前第一回合释放的技能效果消失，属性变回 $(2,0)$，再重新释放技能变为 $(3,0)$，然后被对手痛殴致死。所以最后停留在了 $(1,4)$。\n\n对于第三组数据，该棋子每走两次就会释放技能跳回两回合前的状态，不断循环这样的过程。\n\n### 数据范围\n\n保证 $1\\leq T\\leq 20$，$1\\leq N,M\\leq 100$，$1\\leq K\\leq 200$，$1\\leq R\\leq 1000$。\n\n保证所有的附加输入除了技能 $3,5,7$ 的影响时间大于 $0$ 以外，剩下均大于等于 $0$。\n\n保证棋子一开始不在障碍物上，一开始以及增幅的属性值均不超过 $1000$（但不保证增幅后的属性超过 $1000$）。\n\n保证技能的首轮回复时间、之后的回复时间以及复活时间均大于 $0$。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Binomial Coefficient Problem", "background": "**Friendly reminder: This problem statement is quite long.**", "description": "As everyone knows, student Xiao Cong is good at calculation, especially at computing binomial coefficients.\n\nNow we have an $N \\times M$ board, and some cells on the board contain obstacles. There are $K$ pieces on the board. Each piece belongs to either the red team or the blue team. Also, each piece has two attributes; for piece $i$, the two attributes are denoted by $a_i, b_i$, and it is guaranteed that $a_i \\geq b_i$. Since there are two teams, Xiao Cong wants to play a game. The game has a total of $R$ rounds. In each round, every piece acts in the following order:\n\n0. At the start of the round, let the current round be the $H$-th round. If this is the start of the game, then $H = 1$.\n\n1. For all pieces that can move, move one cell forward in their current direction. Each piece’s direction must be one of up, down, left, or right. If a piece finds that it cannot move, i.e., the cell in front is outside the board or is an obstacle, then it does not move forward. Instead, it rotates its direction by $180^\\circ$ (i.e., turns around). Note that after turning around, the piece will not move in this round.\n\n2. For all pieces, each piece has exactly one skill. Now all pieces release skills in order of increasing index; if a piece cannot release its skill, it is skipped. There are the following kinds of skills:\n\n\t1. Heavy Hammer Sparkles (toolihai): Centered on itself, it creates gorgeous fireworks that are pleasing to the eye, with no effect.\n\n\t2. King of Face (faceking): This piece is full of “face”, and all pieces must obey its command, forcing all pieces to rotate their directions $90^\\circ$ to the left (counterclockwise). The effect lasts permanently.\n\n\t3. Hair Gone (onepunch): After losing all its hair, Captain Wang becomes stronger, greatly boosting this piece’s attributes. That is, if the current attributes of piece $i$ are $\\left(a_i, b_i\\right)$, and the boost value is $v$, then its attributes become $\\left(a_i + v, b_i\\right)$. This effect lasts for $l$ rounds. If the current round is $H$, then this effect disappears at the start of round $H + l$. If before the effect disappears piece $i$’s attributes are $\\left(a_i, b_i\\right)$, then after the effect disappears its attributes become $\\left(\\max\\left(a_i - v, 0\\right), \\min\\left(b_i, \\max\\left(a_i - v, 0\\right)\\right)\\right)$. Note that before the effect disappears, this skill may be released again; multiple releases stack, but the disappearance time is computed separately for each release. (See the second sample.)\n\n\t4. Rabi Ribi (rabiribi): Swings a real heavy hammer to create sparks, knocking back all enemy units in a forward fan-shaped area. The affected range is a forward fan-shaped area of size $v$, as shown below:\n\n        ![](https://cdn.luogu.com.cn/upload/image_hosting/zgtwzsld.png)\n\t\t\n        From the figure, we can see that the piece releasing the skill is at the bottom, facing up, so the skill direction is also up. All cells above form the fan-shaped area affected by the skill. The fan size is $5$, i.e., $v = 5$. Note that some positions on the board have obstacles, and obstacles affect the skill range. If an obstacle lies within the skill range, then the fan-shaped area within the skill range starting from that obstacle will not be affected by the skill. In the figure, the lowest cell of each black column is an obstacle, and all black cells are cells that cannot be affected due to the obstacle.\n        \n        On the other hand, the knockback effect is defined as forcing a piece affected by the skill to move one cell along the skill direction, i.e., from $p_2$ being knocked back to position $p_3$ in the figure. If the knockback direction hits an obstacle or the board boundary, then handle it as follows:\n        \n        - If the next position is an obstacle, then it is knocked back to the cell behind that obstacle, i.e., from $p_0$ knocked back to $p_1$ in the figure.\n        - If the next position is outside the board, e.g., currently in the first row and it would be knocked back to row $0$, then it is knocked back to the cell in row $N$ in the same column.\n        \n        Repeat the above process until it is knocked back to a position that is neither an obstacle nor outside the board; then the knockback process ends. (See the first sample.)\n\n\t5. Dropout Fireworks (firework): After dropping out, there is more time to dig holes. It makes the piece that most recently released Heavy Hammer Sparkles unable to move for the next $l$ rounds. If no such piece exists, then it makes itself unable to move for the next $l$ rounds.\n\n\t6. Save Uganda (viuganda): Uses vim to save fallen pieces, reviving the farthest dead allied piece from itself. If there is no dead allied piece, then revive the closest dead enemy piece from itself. If the enemy also has no dead pieces, do nothing. The distance used here is Manhattan distance: if piece $i$ is at $\\left(x_i, y_i\\right)$ and piece $j$ is at $\\left(x_j, y_j\\right)$, then the distance is $\\left|x_i - x_j\\right| + \\left|y_i - y_j\\right|$. If multiple pieces have the same Manhattan distance to the current piece, choose the one with the largest index. If the revived piece can release its skill in the current round and has not been skipped yet, it will release its skill.\n\n\t7. Dimensionality Reduction Strike (2dsaigao): Uses a hyperspace weapon to fire a dynamic light wave to its right-front, making units in some area unable to release skills. After the light wave is fired, when it hits the board edge or an obstacle, its direction changes as shown below:\n\t\n\t\t![](https://cdn.luogu.com.cn/upload/image_hosting/3j1makll.png)\n\t\t\n        The center cell is where the current piece is, and its direction is left. Each time the light wave is about to enter a cell with an obstacle or the board edge, it rotates its direction $90^\\circ$ clockwise. Each time the light wave travels from the center of one cell to the center of another, we say it travels a distance of $1$. After the wave has traveled a distance of $o$, it explodes centered at the current cell, making all pieces whose Manhattan distance to that cell is at most $v$ unable to release skills for the next $l$ rounds, i.e., they cannot release skills from now until the start of round $H + l$. (See the first sample.)\n\n\t8. Gugu Gugu (gugugugu): In life, you must never “pigeon” others in an ordinary way; if you pigeon, you must pigeon everyone together. This skill makes all allied pieces that have not released their skill yet in the current round skip the skill-releasing stage, i.e., allied pieces that have not yet released their skill cannot release their skill in the current round.\n\n\t9. Backward Propagation (backward): Stop time, reverse the game, and return itself to the past, to some previous round. If the current round is $H$, and this effect returns to $l$ rounds earlier, then piece $i$ will return to round $H - l$. “Returning to round $H - l$” means that all of the following values of piece $i$ revert to their values at the start of round $H - l$:\n        \n        - Position and direction.\n        - Attributes.\n        - Whether it is alive and its revival time.\n        - Skill effects applied to it and their remaining durations.\n        \n        Note that the skill cooldown time of piece $i$ does not revert to the time of round $H - l$. (See the third sample.) (The skill cooldown rules are explained below.)\n\n\t10. Praise of Scallions (hupraise): The arrival of scallions makes today a sacred day, and red and blue pieces should be paired. Each red piece can be paired with any blue piece, and each piece can be paired with at most one opposing piece. Pieces $i$ and $j$ can be paired if they are from different teams and $a_i \\oplus a_j$ is a multiple of $3$ (this symbol is XOR). Now every time this skill is activated, you need to find the maximum number of pairs that can be formed.\n\n\t**Skill cooldown rules**: For all skills, if the current round is $H$ and piece $i$ releases its skill, then the skill will not finish cooling down until round $H + z_i$, and it can only be released again after that. If piece $i$ is affected in the current round by a skill lasting $l$ rounds, then the effect will be removed at the start of round $H + l$. For all pieces, if its first skill cooldown time is $f_i$ and its cooldown interval is $z_i$, then without influence from other pieces, it will release its skill for the first time in round $f_i$, and then once every $z_i$ rounds thereafter.\n\n3. For all cells on the board, if a cell contains both red pieces and blue pieces, then the pieces in that cell will engage in combat. The combat rules are as follows:\n\n    We define the combat power of piece $i$ as $\\binom{a_i}{b_i}$ (this is equivalent to $C_{a_i}^{b_i}$). In combat, each time both teams send out their own piece with the highest combat power in this cell to fight. Suppose the red team sends piece $i$ and the blue team sends piece $j$. If their combat powers are equal, then both pieces die. If they are not equal, suppose piece $i$ has higher combat power, then piece $j$ dies, and the two attributes of piece $i$ become $\\max\\left(a_i - a_j, 0\\right), \\max\\left(b_i - a_j, 0\\right)$. Repeat the above process until all pieces of one team in the cell have died. If piece $i$ dies in the current round, i.e., round $H$, then it will revive at the start of round $H + r_i$. After reviving, its two attributes return to the initial attribute values at the start of the game, and all skill effects on it are removed; its movement direction remains the same as before it died. During death, its skill cooldown proceeds normally, but it cannot move or release skills, and it is not affected by any other skills.\n\nNow Xiao Cong tells you everything related to this game. You need to simulate the game according to the rules and output the position of each piece after the game ends.", "inputFormat": "The input contains multiple test cases. The first line contains an integer $T$ indicating the number of test cases. Each test case is described as follows:\n\n* The first line contains four integers $N, M, K, R$.\n\n* The next $N$ lines each contain $M$ numbers. For the number in row $i$, column $j$, if it equals $0$, it means the cell at row $i$, column $j$ is a normal cell; otherwise, it is an obstacle.\n\n* The next $K$ lines each start with nine integers $x_i, y_i, a_i, b_i, c_i, d_i, f_i, z_i, r_i$, describing piece $i$. Its initial position is at row $x_i$, column $y_i$, its attributes are $a_i, b_i$, and its team is $c_i$. If $c_i = 0$ it is red; otherwise it is blue. The initial facing direction is $d_i$, where $d_i = 0, 1, 2, 3$ represent up, down, left, right. $f_i$ is the first cooldown time, and $z_i$ is the cooldown interval, i.e., if not affected by other pieces, piece $i$ releases its skill for the first time in round $f_i$, and then once every $z_i$ rounds. $r_i$ is its revival time. Then there is a string $s_i$, which is the English name of its skill, already given after each skill above. For different skill types, additional values are appended on the same line as follows:\n\n\t1. Heavy Hammer Sparkles (toolihai): no additional input.\n\n\t2. King of Face (faceking): no additional input.\n\n\t3. Hair Gone (onepunch): additional input $v_i, l_i$, representing the boost value and duration.\n\n\t4. Rabi Ribi (rabiribi): additional input $v_i$, representing the skill range.\n\t\t\n\t5. Dropout Fireworks (firework): additional input $l_i$, representing the duration of the effect.\n\n\t6. Save Uganda (viuganda): no additional input.\n\n\t7. Dimensionality Reduction Strike (2dsaigao): additional input $y_i, v_i, l_i$, representing the travel distance of the wave, the affected range after explosion, and the duration of the effect.\n\t\t\t\n\t8. Gugu Gugu (gugugugu): no additional input.\n\t\t\n\t9. Backward Propagation (backward): additional input $l_i$, meaning returning to $l_i$ rounds earlier. The data guarantees it will not return to before the start of the game.\n\t\t\t\n\t10. Praise of Scallions (hupraise): no additional input.", "outputFormat": "For each test case:\n\n* Every time skill $10$ is activated, output one line containing one integer.\n\n* After the game ends, output $K$ lines. Each line contains two integers indicating the current row and column of piece $i$.", "hint": "### Sample Explanation\n\nFor the first sample, when skill $7$ is released at the upper-left, the dynamic light wave is fired toward the corner. When it hits the corner and bounces back to the firing point, the distance is $1$, so it explodes in place, making skill $2$ unable to be released. The lower-right part shows an example of using skill $4$ to knock the opponent through the map.\n\nFor the second sample, the first piece releases its skill every time it moves one step to the right. In the first round it moves to $(1, 2)$, after releasing the skill its attributes become $(3, 2)$, and after fighting the opponent its attributes become $(2, 1)$. In the second round it moves to $(1, 3)$, after releasing the skill its attributes become $(3, 1)$, and after fighting the opponent its attributes become $(3, 0)$. In the third round it moves to $(1, 4)$. Since the skill effect released in the first round disappears, its attributes revert to $(2, 0)$, then it releases the skill again to become $(3, 0)$, and then it is beaten to death by the opponent. So it finally stays at $(1, 4)$.\n\nFor the third sample, the piece releases its skill every two moves to jump back to the state two rounds ago, and repeats this cycle.\n\n### Constraints\n\nIt is guaranteed that $1 \\leq T \\leq 20$, $1 \\leq N, M \\leq 100$, $1 \\leq K \\leq 200$, $1 \\leq R \\leq 1000$.\n\nIt is guaranteed that among all additional inputs, except that the durations of skills $3, 5, 7$ are greater than $0$, all others are at least $0$.\n\nIt is guaranteed that no piece starts on an obstacle, and both the initial and boosted attribute values do not exceed $1000$ (but it is not guaranteed that attributes after boosts are at most $1000$).\n\nIt is guaranteed that the first cooldown time, the cooldown interval, and the revival time are all greater than $0$.\n\n### Copyright Information\n\nFrom Tsinghua University Programming Contest and Collegiate Invitational 2018 (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nSolutions and other resources can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 组合数问题", "background": "**友情提示：本题篇幅较长。**", "description": "众所周知，小葱同学擅长计算，尤其擅长计算组合数。\n\n于是现在我们有了一个 $N\\times M$ 的棋盘，棋盘上有些地方会有障碍物的存在。在棋盘上有 $K$ 枚棋子，每枚棋子要么属于红队要么属于蓝队。此外，每枚棋子有两个属性值，第 $i$ 枚棋子的两个属性记为 $a_i,b_i$ 并且保证 $a_i\\geq b_i$。既然有了两支队伍那么小葱同学就要来玩游戏，这个游戏一共有 $R$ 个回合。每个回合内，每枚棋子会按照如下顺序进行游戏：\n\n0. 回合开始，记当前是第 $H$ 回合。若现在为游戏的开始时刻，则 $H=1$。\n\n1. 对于所有能够移动的棋子，沿着自己当前的方向移动一格。每枚棋子的朝向一定是上下左右中的一种。如果棋子发现自己不能移动，即前方格子为棋盘外部或者障碍物，那么则不向前移动，而是将自己的方向旋转一百八十度，即进行向后转的操作（注意此时转了之后棋子这回合内并不会进行移动）。\n\n2. 对于所有棋子，每个棋子都拥有且仅拥有一种技能。此时所有棋子按照编号从小到大依次释放技能，如果不能释放技能则跳过。技能总共分为以下几种：\n\n\t1. 重锤火花（toolihai）：以自身为中心，制造出绚丽的烟花，令人赏心悦目，无任何效果。\n\n\t2. 面子之王（faceking）：该棋子充满了面子，所有棋子都要听其号令，使得所有棋子的方向强制向左（逆时针）转九十度。该技能的效果持续时间为永久。\n\n\t3. 头发掉光（onepunch）：头发掉光之后，王队长变得更强了，使该枚棋子的属性大幅度提升。即若当前棋子 $i$ 的属性为 $\\left(a_i,b_i\\right)$，属性的提升值为 $v$，那么该棋子的属性则变为 $\\left(a_i+v,b_i\\right)$。该技能的效果能持续 $l$ 个回合，若当前回合为 $H$，则该技能效果会在第 $H+l$ 回合开始的时候消失。若在技能消失前棋子 $i$ 的属性为 $\\left(a_i,b_i\\right)$，则技能效果消失后其属性会变为 $\\left(\\max\\left(a_i-v,0\\right),\\min\\left(b_i,\\max\\left(a_i-v,0\\right)\\right)\\right)$。注意在该技能效果消失前该技能可能被再次释放，则多次释放的技能效果叠加，但技能效果消失的时间分开计算。（详见样例第二组数据）\n\n\t4. 拉比哩比（rabiribi）：挥动真正的重锤，制造火花，击退前方扇形区域的所有敌方单位。该技能所能影响到的范围为前方大小为 $v$ 的扇形区域，所谓扇形区域可见下图：\n\n        ![](https://cdn.luogu.com.cn/upload/image_hosting/zgtwzsld.png)\n\t\t\n        从上图我们可以看出，在图的最下方有正在释放技能的棋子，其技能朝向为上，所以其技能方向也为上。则上方的所有区域则为其技能所影响到的扇形区域，该扇形区域大小为 $5$，即 $v=5$。注意到棋盘上某些位置会有障碍物，障碍物的存在会影响到该技能的影响范围。如果一个障碍物存在于技能范围之内，那么以障碍物开始的处于技能范围内的扇形区域也都不会受到技能的影响。如上图可见，所有黑色格子的最下方格子即为障碍物的位置，所有黑色格子即为受到障碍物影响所不能被技能效果影响的格子。\n        \n        另一方面，击退效果的定义为将受到技能影响效果的棋子沿着技能释放方向强制移动一格，即从图中 $p_2$ 被击退到 $p_3$ 的位置。如果被击退方向是障碍物或者棋盘边界，则按一下规则进行：\n        \n        - 如果下一位置为障碍物，则被击退到该障碍物后面，即从图中的 $p_0$ 击退到 $p_1$。\n        - 如果下一位置为棋盘外部，如当前在第一行并且要被击退到第零行，则被击退到第 $N$ 行对应的同一列的位置。\n        \n        重复以上过程直到被击退到一个不是障碍物和棋盘外部的位置，则该击退过程结束。（详见样例第一组数据）\n\t\n\t5. 退学花火（firework）：退学之后，有了更多的时间来挖坑。使得上一个释放重锤火花的棋子在接下来 $l$ 回合内无法移动。如果不存在这样的棋子，则使自己在接下来 $l$ 回合内无法移动。\n\n\t6. 救乌干达（viuganda）：使用vim，拯救阵亡的棋子，复活距离自身最远的阵亡的己方棋子。若己方没有阵亡棋子，则复活对方距离自身最近的阵亡棋子。如果对方也没有阵亡棋子，则什么也不做。我们这里使用的距离为曼哈顿距离，即若第 $i$ 枚棋子处于位置 $\\left(x_i,y_i\\right)$， 第 $j$ 枚棋子处于位置 $\\left(x_j,y_j\\right)$，那么此时两枚棋子的距离为 $\\left|x_i-x_j\\right|+\\left|y_i-y_j\\right|$。如果同时有多枚棋子距离当前棋子的曼哈顿距离一样，那么我们选择其中编号最大的棋子即可。棋子被复活后如果当前回合可以释放技能并且仍然没有被跳过，则会释放技能。\n\n\t7. 降维打击（2dsaigao）：利用超时空武器，向自己右前方发射动感光波，使得某个区域内的单位不能释放技能。该动感光波发射之后，遇到棋盘边缘或者障碍物则会发生方向改变的现象，如下图所示：\n\t\n\t\t![](https://cdn.luogu.com.cn/upload/image_hosting/3j1makll.png)\n\t\t\n        中间格子为当前棋子所处的位置，其方向向左。每当该光波会进入一个有障碍物的格子或者棋盘边缘的时候，该光波就会改变自己的方向顺时针旋转 $90^\\circ$。该光波每从一个格子的中心到达另一个格子的中心时我们称该光波走了 $1$ 的距离。当光波走了 $o$ 的距离之后，光波就会以当前格子为中心发生爆炸，使得所有距离当前格子曼哈顿距离不超过 $v$ 的棋子在接下来 $l$ 回合的时间内都不能释放技能，即从现在到第 $H+l$ 回合开始的这段时间内都不能释放技能。（详见样例第一组数据）\n\t\t\n\t8. 咕咕咕咕（gugugugu）：做人，绝不能普普通通的鸽了别人；要鸽，必须带着大家一起鸽。该技能效果为使得己方所有当前回合还没有释放技能的棋子全部跳过技能释放的环节，即使得己方还未释放技能的棋子当前回合不能释放技能。\n\t\n\t9. 反向传播（backward）：让时间暂停，让游戏倒流，让自身回到过去，回到之前的某个回合。若当前为第 $H$ 回合，该技能效果是回到 $l$ 回合前，则当前棋子 $i$ 会回到第 $H-l$ 回合。所谓回到第 $H-l$ 回合，即当前棋子的一下所有值都会变回第 $H-l$ 回合开始的时候的值：\n        \n        - 位置及方向。\n        - 属性。\n        - 是否存活以及复活时间。\n        - 受到的技能影响的效果以及剩余时间。\n        \n        注意此时棋子 $i$ 的技能刷新时间并不会回到第 $H-l$ 回合的时间。（详见样例第三组数据）（技能刷新时间的规则会在下面说明）\n\t\t\n\t10. 葱之礼赞（hupraise）：葱的到来，使得今天变为了一个神圣的日子，要将红蓝双方的棋子进行配对。每个红方棋子可以和任何一个蓝方棋子进行配对，并且每个棋子都最多只能和对面一个棋子进行配对。第 $i$ 枚棋子 和第 $j$ 枚棋子能够配对的条件为两个棋子属于不同阵营并且 $a_i\\oplus a_j$ 是 $3$ 的倍数（该符号为异或）。现在每当该技能发动时，你需要求出最多能够配多少对。\n\n\t**技能刷新规则**：对于所有技能，当前为第 $H$ 回合，如果第 $i$ 枚棋子释放了技能，那么在第 $H+z_i$ 回合的时候该技能才回复完毕，才能再次释放技能。如果第 $i$ 枚棋子在当前回合中了一个持续时间为 $l$ 回合的技能，那么该技能的影响将在第 $H+l$ 回合开始的时候消除。对于所有棋子，若其首轮技能回复时间为 $f_i$，技能回复时间为 $z_i$，则若没有其他棋子的影响，其第一次将在第 $f_i$ 回合释放技能，之后每 $z_i$ 回合再次释放技能。\n\n3. 对于棋盘上所有格子，如果一个格子内既有红队棋子又有蓝队棋子，那么此时这个格子内的棋子便会发生交战。交战的规则如下：\n\n    我们规定第 $i$ 枚棋子的战斗力为 $\\binom{a_i}{b_i}$（该式子等价于 $C_{a_i}^{b_i}$）。在交战时，每次由红蓝双方派出己方在这个格子战力最大的棋子进行交战。假设红方派出第 $i$ 枚棋子，蓝方派出第 $j$ 枚棋子。如果红方蓝方两枚棋子战斗力一样，那么派出的两枚棋子均阵亡。若战斗力不一样，假设第 $i$ 枚棋子战力更高，那么第 $j$ 枚棋子阵亡，同时第 $i$ 枚棋子的两个属性变为 $\\max\\left(a_i-a_j,0\\right),\\max\\left(b_i-a_j,0\\right)$。不断重复以上操作直到一方棋子全部阵亡。若第 $i$ 枚棋子在当前回合即第 $H$ 回合阵亡，那么第 $i$ 枚棋子会在第 $H+r_i$ 回合开始的时候复活。第 $i$ 枚棋子复活之后将其两个属性将变为游戏开始时候的属性值，并且移除所有当前棋子身上的技能效果，其移动方向保持阵亡前的移动方向。棋子阵亡期间其技能正常回复，但是不能移动和释放技能，并且不受到其他任何技能的影响。\n\n\n现在小葱告诉你所有与这游戏相关的东西，希望你按照游戏规则来进行游戏，并输出游戏结束之后每个棋子的位置。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n\n* 第一行四个整数 $N,M,K,R$。\n\n* 接下来 $N$ 行每行 $M$ 个数。对于第 $i$ 行第 $j$ 列的数，如果等于 $0$ 则代表第 $i$ 行第 $j$ 列的格子为普通格子，否则为障碍物。\n\n* 接下来 $K$ 行，每行一开始有九个整数 $x_i,y_i,a_i,b_i,c_i,d_i,f_i,z_i,r_i$。代表第 $i$ 枚棋子一开始的位置位于第 $x_i$ 行 第 $y_i$ 列，其属性值为 $a_i,b_i$ 并且所属的阵营为 $c_i$。如果 $c_i=0$ 则为红方否则为蓝方。棋子 $i$ 一开始的朝向为 $d_i$，$d_i=0,1,2,3$ 分别表示上下左右四个方向。$f_i$ 为技能首轮回复时间，$z_i$ 为技能回复时间，即第 $i$ 枚棋子若在没有受到其他棋子影响的情况下，第一次将在第 $f_i$ 回合释放技能，之后每 $z_i$ 回合再次释放技能。$r_i$ 为其复活时间。接下来一个字符串 $s_i$ 为其技能的英文名字，已在每个技能后面注明了其对应的英文名字。对于不同的技能种类，会在当前行增加一定的输入值，具体如下：\n\n\t1. 重锤火花（toolihai），无增加的输入。\n\n\t2. 面子之王（faceking），无增加的输入。\n\n\t3. 头发掉光（onepunch），增加输入 $v_i,l_i$，代表该技能的增益效果和持续时间。\n\n\t4. 拉比哩比（rabiribi），增加输入 $v_i$ 代表技能的范围。\n\t\t\n\t5. 退学花火（firework），增加输入 $l_i$ 代表技能的影响时间。\n\n\t6. 救乌干达（viuganda），无增加的输入。\n\n\t7. 降维打击（2dsaigao），增加输入 $y_i,v_i,l_i$，代表光波能移动的距离、光波爆炸后能影响的范围以及技能的影响持续时间。\n\t\t\t\n\t8. 咕咕咕咕（gugugugu），无增加的输入。\n\t\t\n\t9. 反向传播（backward），增加输入 $l_i$，表示回到 $l_i$ 回合之前，数据保证不会回到游戏开始之前。\n\t\t\t\n\t10. 葱之礼赞（hupraise），无增加的输入。", "outputFormat": "对于每组数据：\n\n* 每当技能 $10$ 发动时，输出一行一个整数。\n\n* 在游戏结束之后，输出 $K$ 行，每行两个整数代表第 $i$ 枚棋子现在处于哪一行哪一列。", "hint": "### 样例解释\n\n对于第一组数据，在左上方释放技能 $7$ 时，是朝着角落里射出的动感光波，所以碰到角落返回回射出点时，此时距离为 $1$，正好原地爆炸，使得技能 $2$ 无法放出。而右下方是在释放技能 $4$ 时，将对方击穿了地图的例子。\n\n对于第二组数据，第一枚棋子每次向右走一步就会释放一次技能。第一回合走到 $(1,2)$，释放技能后属性变为 $(3,2)$，和对方交战后属性变为 $(2,1)$。第二回合走到 $(1,3)$，释放技能后属性变为 $(3,1)$，和对方交战后属性变为 $(3,0)$。第三回合走到 $(1,4)$，由于之前第一回合释放的技能效果消失，属性变回 $(2,0)$，再重新释放技能变为 $(3,0)$，然后被对手痛殴致死。所以最后停留在了 $(1,4)$。\n\n对于第三组数据，该棋子每走两次就会释放技能跳回两回合前的状态，不断循环这样的过程。\n\n### 数据范围\n\n保证 $1\\leq T\\leq 20$，$1\\leq N,M\\leq 100$，$1\\leq K\\leq 200$，$1\\leq R\\leq 1000$。\n\n保证所有的附加输入除了技能 $3,5,7$ 的影响时间大于 $0$ 以外，剩下均大于等于 $0$。\n\n保证棋子一开始不在障碍物上，一开始以及增幅的属性值均不超过 $1000$（但不保证增幅后的属性超过 $1000$）。\n\n保证技能的首轮回复时间、之后的回复时间以及复活时间均大于 $0$。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5454", "type": "P", "difficulty": 5, "samples": [["4 2\n0 0 1", "3 12\n1 2\n1 3\n1 4"], ["10 9\n10 9 8 7 6 5 4 3 2 1", "9 177454\n4 5\n4 6\n3 4\n3 7\n2 3\n2 8\n1 2\n1 9\n1 10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "Special Judge", "THUPC"], "title": "[THUPC 2018] 城市地铁规划", "background": "", "description": "经过选拔，Kiana成为了可乐城的市长，为了兑现选举承诺，她决定在可乐城的 $n$ 个重要地标之间修建地铁。\n\n可乐城的交通状况并不复杂，在任意两个地标之间修建一条地铁轨道都是可行的，但是地铁轨道并不是越多越好，如果有太多地铁从一个地标处经过，该地标的拥堵程度将大幅增加。为此，Kiana决定给每个地标一个便利度来衡量拥堵程度，如果有 $d$ 条地铁轨道经过了某个地标，那么该地标的便利度为 $f(d)\\mod 59393$，其中 $f(x)=\\sum_{i=0}^{k}a_ix^i$ 是Kiana指定的一个 $k$ 次多项式。\n\n因为修建地铁有一定的成本，所以Kiana希望新建的地铁轨道尽可能少，但任意两座地标之间都需要能通过地铁相互到达。Kiana想知道在给定的条件下，什么样的修建方案可以使得地标的便利度之和最大。由于她不会做，所以希望你来告诉她答案。", "inputFormat": "输入第一行包含两个正整数 $n$ 和 $k$，分别表示可乐城的地标总数和Kiana指定的多项式次数，地标的编号依次为 $1$ 至 $n$，数据保证 $n\\leq 3000$且 $k\\leq 10$。\n\n输入第二行包含 $k+1$ 个非负整数 $a_0\\sim a_k$，即Kiana指定的多项式的系数，数据保证所有的 $a_i\\leq 50$。", "outputFormat": "输出由若干行组成，第一行包含两个用空格隔开的正整数 $m$ 和 $S$，分别表示你的方案中修建的地铁轨道数量与最终的便利度之和。\n\n接下来 $m$ 行，每行包含两个用空格隔开的正整数 $u$ 和 $v$，表示在第 $u$ 和第 $v$ 个地标之间修建了一条地铁轨道。\n\n本题将采用Special Judge，如果有多种方案使得地标的便利度之和最大，输出其中任意一种即可。", "hint": "### 备注\n\n本题因为一些原因只保留了后 $50$ 组数据。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] City Metro Planning", "background": "", "description": "After being selected, Kiana became the mayor of Kele City. To fulfill her campaign promise, she decided to build a metro system among the $n$ important landmarks in Kele City.\n\nThe traffic situation in Kele City is not complicated. It is feasible to build a metro track between any two landmarks. However, more metro tracks are not always better: if too many tracks pass through a landmark, the congestion at that landmark will increase significantly. Therefore, Kiana decided to assign each landmark a convenience value to measure congestion. If $d$ metro tracks pass through a landmark, then its convenience value is $f(d)\\mod 59393$, where $f(x)=\\sum_{i=0}^{k}a_ix^i$ is a degree-$k$ polynomial specified by Kiana.\n\nBuilding metro tracks has a cost, so Kiana wants the number of newly built tracks to be as small as possible, while any two landmarks must be able to reach each other by metro. Kiana wants to know, under the given conditions, what construction plan can maximize the sum of convenience values over all landmarks. Since she cannot solve it, she asks you to give her the answer.", "inputFormat": "The first line contains two positive integers $n$ and $k$, representing the total number of landmarks in Kele City and the degree of the polynomial specified by Kiana. The landmarks are numbered from $1$ to $n$. The testdata guarantees $n\\leq 3000$ and $k\\leq 10$.\n\nThe second line contains $k+1$ non-negative integers $a_0\\sim a_k$, i.e., the coefficients of the polynomial specified by Kiana. The testdata guarantees that all $a_i\\leq 50$.", "outputFormat": "The output consists of multiple lines. The first line contains two positive integers $m$ and $S$ separated by a space, representing the number of metro tracks built in your plan and the final sum of convenience values.\n\nIn the next $m$ lines, each line contains two positive integers $u$ and $v$ separated by a space, indicating that a metro track is built between landmark $u$ and landmark $v$.\n\nThis problem uses a Special Judge. If multiple plans maximize the sum of convenience values, you may output any one of them.", "hint": "### Notes\n\nDue to some reasons, only the last $50$ groups of testdata are kept for this problem.\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Collegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as solutions can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 城市地铁规划", "background": "", "description": "经过选拔，Kiana成为了可乐城的市长，为了兑现选举承诺，她决定在可乐城的 $n$ 个重要地标之间修建地铁。\n\n可乐城的交通状况并不复杂，在任意两个地标之间修建一条地铁轨道都是可行的，但是地铁轨道并不是越多越好，如果有太多地铁从一个地标处经过，该地标的拥堵程度将大幅增加。为此，Kiana决定给每个地标一个便利度来衡量拥堵程度，如果有 $d$ 条地铁轨道经过了某个地标，那么该地标的便利度为 $f(d)\\mod 59393$，其中 $f(x)=\\sum_{i=0}^{k}a_ix^i$ 是Kiana指定的一个 $k$ 次多项式。\n\n因为修建地铁有一定的成本，所以Kiana希望新建的地铁轨道尽可能少，但任意两座地标之间都需要能通过地铁相互到达。Kiana想知道在给定的条件下，什么样的修建方案可以使得地标的便利度之和最大。由于她不会做，所以希望你来告诉她答案。", "inputFormat": "输入第一行包含两个正整数 $n$ 和 $k$，分别表示可乐城的地标总数和Kiana指定的多项式次数，地标的编号依次为 $1$ 至 $n$，数据保证 $n\\leq 3000$且 $k\\leq 10$。\n\n输入第二行包含 $k+1$ 个非负整数 $a_0\\sim a_k$，即Kiana指定的多项式的系数，数据保证所有的 $a_i\\leq 50$。", "outputFormat": "输出由若干行组成，第一行包含两个用空格隔开的正整数 $m$ 和 $S$，分别表示你的方案中修建的地铁轨道数量与最终的便利度之和。\n\n接下来 $m$ 行，每行包含两个用空格隔开的正整数 $u$ 和 $v$，表示在第 $u$ 和第 $v$ 个地标之间修建了一条地铁轨道。\n\n本题将采用Special Judge，如果有多种方案使得地标的便利度之和最大，输出其中任意一种即可。", "hint": "### 备注\n\n本题因为一些原因只保留了后 $50$ 组数据。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5455", "type": "P", "difficulty": 6, "samples": [["4 10\n1 6 10 2\n100 2333 666 300\n7\n3 1 4\n3 1 3\n1 2 4 1\n3 1 4\n2 2 3 -1000\n2 2 3 -600\n3 2 4", "15165 2865\n14165 2169\n36630 798\n4899 1273"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "线段树", "背包 DP", "THUPC"], "title": "[THUPC 2018] 弗雷兹的玩具商店", "background": "物是人非事事休，欲语泪先流。\n", "description": "弗雷兹在 C 市有一个玩具店，店里有 $n$ 种玩具，编号依次为 $1,2,\\dots, n$，编号为 $i$ 的玩具的单价为 $c_i$ 元，一个该玩具提供的愉悦度为 $v_i$ 。\n\n突然有一天，C市来了 $m$ 个小朋友。据可靠消息，这些小朋友会在一些时刻一起来店里买东西，其中第 $i$ 个小朋友每次都会带 $i$ 元（ $1\\leq i\\leq m$ ）。\n\n由于某些玩具特别优秀，所以每次小朋友们都会在特定的编号范围内挑选玩具。\n\n除此之外，由于小朋友们在一年前的清华校赛中就愉悦得无法自拔，所以弗雷兹放弃了对他们的治疗，于是小朋友们就可以无限制地购买玩具了。也就是说，对于任意玩具，每个小朋友在每次的购买件数都可以是任意的非负整数。\n\n时代飞速发展，玩具的受欢迎程度和价格也会随着时代的发展而改变。\n\n为了方便你处理这些信息，Yazid 进行了整理，发现这些日子里，弗雷兹的玩具商店里共发生了 $Q$ 个事件。\n\n对于每个事件，都有 $3$ 个基本参数 $op,l,r$ 。其中 $op$ 为 $1$ 至 $3$ 之间的整数，代表了事件的类别：\n\n1. 对于 $op=1$ 的事件，Yazid 还会给你一个额外参数 $d$ ，表示这是一个**价格调整**事件：将编号在区间 $[l,r]$ 内的玩具的单价 $c$ 全部增加 $d$ 元。为了防止单价超过 $m$ 元导致玩具永远无法被小朋友们购买，弗雷兹会将所有超过 $m$ 的单价减去 $m$。（保证 $d$ 为不超过 $m$ 的正数）\n\n2. 对于 $op=2$ 的事件，Yazid还会给你一个额外参数 $b$ ，表示这是一个**愉悦修正**事件：将编号在区间 $[l,r]$ 内的玩具的愉悦度 $v$ 全部增加 $b$ 。（需要注意这里的 $b$ 可能是负数）\n\n3. 对于 $op=3$ 的事件，表示**购买**事件：所有的 $m$ 个小朋友来到弗雷兹的玩具商店，在编号范围在 $[l,r]$ 内的玩具中进行随意地购买。\n\n现在，对于每一次的购买事件，你想知道：\n\n1. 所有小朋友所能获得的最大愉悦度之和。\n\n2. 所有小朋友所能获得的最大愉悦度的异或和（异或运算是 $\\mathrm{xor}$ 运算，即 C++/Java/Python 中的 `^` 运算）。", "inputFormat": "* 第 $1$ 行 $2$ 个正整数 $n,m$，分别表示玩具数量、以及小朋友的数量。\n\n* 第 $2$ 行 $n$ 个正整数 $c_1,\\dots,c_n$，依次描述各玩具的单价。\n\n* 第 $3$ 行 $n$ 个正整数 $v_1,\\dots,v_n$，依次描述各玩具的愉悦度。\n\n* 第 $4$ 行 $1$ 个非负整数 $Q$，表示事件的数量。\n\n* 接下来 $Q$ 行依次描述所有事件，每行描述一个事件。每行的开头是 $3$ 个整数 $op,l,r$，意义见题目描述。\n\n\t* 如果 $op=1$，接下来跟随 $1$ 个该事件的额外参数（整数） $d$，意义见题目描述。\n\t\n\t* 如果 $op=2$，接下来跟随 $1$ 个该事件的额外参数（整数） $b$，意义见题目描述。\n\t\n\t* 如果 $op=3$，接下来无任何额外参数。\n\t\n\t* 保证 $1\\leq l\\leq r\\leq n$。\n\n对于每一行，如果包含多个数，则用单个空格将它们隔开。", "outputFormat": "* 对于每个购买事件，输出一行 $2$ 个用空格隔开的整数，依次表示所有小朋友所能获得的最大愉悦度之和、以及所有小朋友所能获得的最大愉悦度的异或和。", "hint": "### 样例解释\n\n对于第 $1$ 个购买事件，各位小朋友（编号从小到大，即从 $1$ 至 $10$）能够获得的最大愉悦度依次为：$100,300,400,600,700,2333,2433,2633,2733,2933$。\n\n对于第 $2$ 个购买事件，各位小朋友（编号从小到大，即从 $1$ 至 $10$）能够获得的最大愉悦度依次为：$100,200,300,400,500,2333,2433,2533,2633,2733$。\n\n对于第 $3$ 个购买事件，各位小朋友（编号从小到大，即从 $1$ 至 $10$）能够获得的最大愉悦度依次为：$666,1332,1998,2664,3330,3996,4662,5328,5994,6660$。\n\n对于第 $4$ 个购买事件，各位小朋友（编号从小到大，即从 $1$ 至 $10$）能够获得的最大愉悦度依次为：$0,0,300,300,300,600,733,733,900,1033$。\n\n根据这些信息，你将很容易计算出答案。\n\n### 数据范围\n\n保证 $1\\le n\\leq 200,000$，$1\\le m\\leq 60$，$0\\le Q\\leq 30,000$。\n\n保证 $1\\leq c_i,d\\leq m$。\n\n保证 $0\\leq v_i\\leq 10^7$，$\\left| b\\right|\\leq 10^3$。\n\n### 提示\n\n这个提示本不该有，但善良的出题人还是想提醒你：所有小朋友所能获得的最大愉悦度之和有可能超过 $32$ 位有符号整数的范围。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Freyz’s Toy Store", "background": "Everything has changed, and nothing remains the same. I want to speak, but tears come first.", "description": "Freyz has a toy store in City C. The store sells $n$ kinds of toys, numbered $1,2,\\dots,n$. The unit price of toy $i$ is $c_i$ yuan, and buying one unit of this toy provides happiness value $v_i$.\n\nOne day, $m$ children came to City C. According to reliable information, these children will come to the store together at certain times to buy things. Each time, the $i$-th child will bring exactly $i$ yuan ($1\\leq i\\leq m$).\n\nBecause some toys are especially good, every time the children will only choose toys within a specific index range.\n\nAlso, since the children were already so happy in last year’s Tsinghua programming contest that they could not stop, Freyz gave up treating them, so the children can buy toys without limits. That is, for any toy, each child can buy any non-negative integer quantity each time.\n\nAs time moves forward quickly, the popularity and prices of toys may also change.\n\nTo help you handle this information, Yazid organized it and found that there were $Q$ events in Freyz’s toy store during these days.\n\nEach event has $3$ basic parameters $op,l,r$. Here $op$ is an integer from $1$ to $3$, representing the type of the event:\n\n1. For an event with $op=1$, Yazid will also give you an extra parameter $d$, meaning this is a **price adjustment** event: increase the unit price $c$ of all toys with indices in $[l,r]$ by $d$ yuan. To prevent a unit price from exceeding $m$ yuan and making the toy never purchasable by the children, Freyz will subtract $m$ from any unit price that exceeds $m$. (It is guaranteed that $d$ is a positive integer not exceeding $m$.)\n\n2. For an event with $op=2$, Yazid will also give you an extra parameter $b$, meaning this is a **happiness modification** event: increase the happiness value $v$ of all toys with indices in $[l,r]$ by $b$. (Note that $b$ may be negative.)\n\n3. For an event with $op=3$, this is a **purchase** event: all $m$ children come to Freyz’s toy store and buy freely among the toys with indices in $[l,r]$.\n\nNow, for each purchase event, you want to know:\n\n1. The sum of the maximum total happiness that all children can obtain.\n\n2. The xor sum of the maximum total happiness that all children can obtain (xor is the $\\mathrm{xor}$ operation, i.e. the `^` operator in C++/Java/Python).", "inputFormat": "* Line $1$: two positive integers $n,m$, representing the number of toys and the number of children.\n\n* Line $2$: $n$ positive integers $c_1,\\dots,c_n$, describing the unit price of each toy.\n\n* Line $3$: $n$ positive integers $v_1,\\dots,v_n$, describing the happiness value of each toy.\n\n* Line $4$: one non-negative integer $Q$, representing the number of events.\n\n* The next $Q$ lines describe all events, one per line. Each line starts with three integers $op,l,r$, as described above.\n\n\t* If $op=1$, it is followed by one extra parameter (integer) $d$, as described above.\n\t\n\t* If $op=2$, it is followed by one extra parameter (integer) $b$, as described above.\n\t\n\t* If $op=3$, there is no extra parameter.\n\t\n\t* It is guaranteed that $1\\leq l\\leq r\\leq n$.\n\nIn each line, if there are multiple numbers, they are separated by a single space.", "outputFormat": "* For each purchase event, output one line with two integers separated by a space, representing the sum of the maximum happiness all children can obtain, and the xor sum of the maximum happiness all children can obtain, in this order.", "hint": "### Sample Explanation\n\nFor the $1$-st purchase event, the maximum happiness each child (in order of indices from $1$ to $10$) can obtain is: $100,300,400,600,700,2333,2433,2633,2733,2933$.\n\nFor the $2$-nd purchase event, the maximum happiness each child (in order of indices from $1$ to $10$) can obtain is: $100,200,300,400,500,2333,2433,2533,2633,2733$.\n\nFor the $3$-rd purchase event, the maximum happiness each child (in order of indices from $1$ to $10$) can obtain is: $666,1332,1998,2664,3330,3996,4662,5328,5994,6660$.\n\nFor the $4$-th purchase event, the maximum happiness each child (in order of indices from $1$ to $10$) can obtain is: $0,0,300,300,300,600,733,733,900,1033$.\n\nWith this information, you can easily compute the answers.\n\n### Constraints\n\nIt is guaranteed that $1\\le n\\leq 200,000$, $1\\le m\\leq 60$, $0\\le Q\\leq 30,000$.\n\nIt is guaranteed that $1\\leq c_i,d\\leq m$.\n\nIt is guaranteed that $0\\leq v_i\\leq 10^7$, $\\left| b\\right|\\leq 10^3$.\n\n### Hint\n\nThis hint should not have existed, but the kind problem setter still wants to remind you: the sum of the maximum happiness all children can obtain may exceed the range of 32-bit signed integers.\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Intercollegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai) for supporting this contest.\n\nSolutions and other resources can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 弗雷兹的玩具商店", "background": "物是人非事事休，欲语泪先流。\n", "description": "弗雷兹在 C 市有一个玩具店，店里有 $n$ 种玩具，编号依次为 $1,2,\\dots, n$，编号为 $i$ 的玩具的单价为 $c_i$ 元，一个该玩具提供的愉悦度为 $v_i$ 。\n\n突然有一天，C市来了 $m$ 个小朋友。据可靠消息，这些小朋友会在一些时刻一起来店里买东西，其中第 $i$ 个小朋友每次都会带 $i$ 元（ $1\\leq i\\leq m$ ）。\n\n由于某些玩具特别优秀，所以每次小朋友们都会在特定的编号范围内挑选玩具。\n\n除此之外，由于小朋友们在一年前的清华校赛中就愉悦得无法自拔，所以弗雷兹放弃了对他们的治疗，于是小朋友们就可以无限制地购买玩具了。也就是说，对于任意玩具，每个小朋友在每次的购买件数都可以是任意的非负整数。\n\n时代飞速发展，玩具的受欢迎程度和价格也会随着时代的发展而改变。\n\n为了方便你处理这些信息，Yazid 进行了整理，发现这些日子里，弗雷兹的玩具商店里共发生了 $Q$ 个事件。\n\n对于每个事件，都有 $3$ 个基本参数 $op,l,r$ 。其中 $op$ 为 $1$ 至 $3$ 之间的整数，代表了事件的类别：\n\n1. 对于 $op=1$ 的事件，Yazid 还会给你一个额外参数 $d$ ，表示这是一个**价格调整**事件：将编号在区间 $[l,r]$ 内的玩具的单价 $c$ 全部增加 $d$ 元。为了防止单价超过 $m$ 元导致玩具永远无法被小朋友们购买，弗雷兹会将所有超过 $m$ 的单价减去 $m$。（保证 $d$ 为不超过 $m$ 的正数）\n\n2. 对于 $op=2$ 的事件，Yazid还会给你一个额外参数 $b$ ，表示这是一个**愉悦修正**事件：将编号在区间 $[l,r]$ 内的玩具的愉悦度 $v$ 全部增加 $b$ 。（需要注意这里的 $b$ 可能是负数）\n\n3. 对于 $op=3$ 的事件，表示**购买**事件：所有的 $m$ 个小朋友来到弗雷兹的玩具商店，在编号范围在 $[l,r]$ 内的玩具中进行随意地购买。\n\n现在，对于每一次的购买事件，你想知道：\n\n1. 所有小朋友所能获得的最大愉悦度之和。\n\n2. 所有小朋友所能获得的最大愉悦度的异或和（异或运算是 $\\mathrm{xor}$ 运算，即 C++/Java/Python 中的 `^` 运算）。", "inputFormat": "* 第 $1$ 行 $2$ 个正整数 $n,m$，分别表示玩具数量、以及小朋友的数量。\n\n* 第 $2$ 行 $n$ 个正整数 $c_1,\\dots,c_n$，依次描述各玩具的单价。\n\n* 第 $3$ 行 $n$ 个正整数 $v_1,\\dots,v_n$，依次描述各玩具的愉悦度。\n\n* 第 $4$ 行 $1$ 个非负整数 $Q$，表示事件的数量。\n\n* 接下来 $Q$ 行依次描述所有事件，每行描述一个事件。每行的开头是 $3$ 个整数 $op,l,r$，意义见题目描述。\n\n\t* 如果 $op=1$，接下来跟随 $1$ 个该事件的额外参数（整数） $d$，意义见题目描述。\n\t\n\t* 如果 $op=2$，接下来跟随 $1$ 个该事件的额外参数（整数） $b$，意义见题目描述。\n\t\n\t* 如果 $op=3$，接下来无任何额外参数。\n\t\n\t* 保证 $1\\leq l\\leq r\\leq n$。\n\n对于每一行，如果包含多个数，则用单个空格将它们隔开。", "outputFormat": "* 对于每个购买事件，输出一行 $2$ 个用空格隔开的整数，依次表示所有小朋友所能获得的最大愉悦度之和、以及所有小朋友所能获得的最大愉悦度的异或和。", "hint": "### 样例解释\n\n对于第 $1$ 个购买事件，各位小朋友（编号从小到大，即从 $1$ 至 $10$）能够获得的最大愉悦度依次为：$100,300,400,600,700,2333,2433,2633,2733,2933$。\n\n对于第 $2$ 个购买事件，各位小朋友（编号从小到大，即从 $1$ 至 $10$）能够获得的最大愉悦度依次为：$100,200,300,400,500,2333,2433,2533,2633,2733$。\n\n对于第 $3$ 个购买事件，各位小朋友（编号从小到大，即从 $1$ 至 $10$）能够获得的最大愉悦度依次为：$666,1332,1998,2664,3330,3996,4662,5328,5994,6660$。\n\n对于第 $4$ 个购买事件，各位小朋友（编号从小到大，即从 $1$ 至 $10$）能够获得的最大愉悦度依次为：$0,0,300,300,300,600,733,733,900,1033$。\n\n根据这些信息，你将很容易计算出答案。\n\n### 数据范围\n\n保证 $1\\le n\\leq 200,000$，$1\\le m\\leq 60$，$0\\le Q\\leq 30,000$。\n\n保证 $1\\leq c_i,d\\leq m$。\n\n保证 $0\\leq v_i\\leq 10^7$，$\\left| b\\right|\\leq 10^3$。\n\n### 提示\n\n这个提示本不该有，但善良的出题人还是想提醒你：所有小朋友所能获得的最大愉悦度之和有可能超过 $32$ 位有符号整数的范围。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5456", "type": "P", "difficulty": 4, "samples": [["5\n2 2 2 3\n7 7 8 8\n9 9 9 9\n3 3 5 6\n9 7 5 2", "0 0 0 8 16 0 0 0 0\n900 1320 724 176 16 0 0 0 0\n2401 2744 1176 224 16 0 0 0 0\n12 62 108 72 16 0 0 0 0\n0 210 284 120 16 0 0 0 0"]], "limits": {"time": [1000], "memory": [512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 蛋糕", "background": "", "description": "最近，菲菲学会了做蛋糕，她做了一个 **4D** 的蛋糕送给牛牛，这个蛋糕的大小是： $a \\times b \\times c \\times d$。\n\n蛋糕所有的表面都抹着奶油，牛牛想把蛋糕沿着与表面平行的超平面，切成 $1 \\times 1 \\times 1 \\times 1$ 的小块。\n\n现在，牛牛想知道，在这些小块蛋糕中，有 $0$ 个、$1$ 个、$2$ 个……$8$ 个表面抹着奶油的有分别有多少块。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。（$T <= 10000$）\n\n接下来依次描述每组数据，对于每组数据：\n\n* 一行 $4$ 个正整数 $a$、$b$、$c$、$d$。（四个正整数都在 $10^6$ 以内）", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 一行输出 $9$ 个整数，分别表示有 $0$ 个、$1$ 个、$2$ 个……$8$ 个表面抹着奶油的小块蛋糕数量，所有值之间用单个空格隔开。为了防止答案过大，你只需要输出答案除以 $2148473648$ 的余数。", "hint": "### 样例解释\n\n对于第一组数据，把 $2 \\times 2 \\times 2 \\times 3$ 的蛋糕切成小块后，共形成了 $24$ 个小立方体，其中有 $16$ 个小块分别与其他 $4$ 个小块相邻，因此它们有 $4$ 个面涂有奶油，而另外 $8$ 个小块分别与其他 $5$ 个小块相邻，因此它们有 $3$ 个面涂有奶油。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Cake", "background": "", "description": "Recently, Feifei learned how to make cakes. She made a **4D** cake for Niuniu. The size of the cake is: $a \\times b \\times c \\times d$.\n\nAll surfaces of the cake are covered with cream. Niuniu wants to cut the cake into $1 \\times 1 \\times 1 \\times 1$ small pieces along hyperplanes parallel to the surfaces.\n\nNow, Niuniu wants to know, among these small pieces, how many pieces have $0$ surface, $1$ surface, $2$ surfaces, $\\ldots$, $8$ surfaces covered with cream, respectively.", "inputFormat": "The input contains multiple test cases. The first line contains an integer $T$ indicating the number of test cases. ($T \\le 10000$)\n\nEach test case is described as follows:\n\n- One line with $4$ positive integers $a$, $b$, $c$, $d$. (All four positive integers are within $10^6$)", "outputFormat": "For each test case, output one line:\n\n- Output $9$ integers, representing the number of small pieces that have $0$ surface, $1$ surface, $2$ surfaces, $\\ldots$, $8$ surfaces covered with cream, respectively. Separate the values with a single space. To prevent the answer from being too large, you only need to output each value modulo $2148473648$.", "hint": "### Sample Explanation\n\nFor the first test case, after cutting a $2 \\times 2 \\times 2 \\times 3$ cake into small pieces, a total of $24$ small cubes are formed. Among them, $16$ pieces are each adjacent to the other $4$ pieces, so they have $4$ faces covered with cream. The other $8$ pieces are each adjacent to the other $5$ pieces, so they have $3$ faces covered with cream.\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Intercollegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai) for supporting this contest.\n\nResources such as solutions can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 蛋糕", "background": "", "description": "最近，菲菲学会了做蛋糕，她做了一个 **4D** 的蛋糕送给牛牛，这个蛋糕的大小是： $a \\times b \\times c \\times d$。\n\n蛋糕所有的表面都抹着奶油，牛牛想把蛋糕沿着与表面平行的超平面，切成 $1 \\times 1 \\times 1 \\times 1$ 的小块。\n\n现在，牛牛想知道，在这些小块蛋糕中，有 $0$ 个、$1$ 个、$2$ 个……$8$ 个表面抹着奶油的有分别有多少块。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。（$T <= 10000$）\n\n接下来依次描述每组数据，对于每组数据：\n\n* 一行 $4$ 个正整数 $a$、$b$、$c$、$d$。（四个正整数都在 $10^6$ 以内）", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 一行输出 $9$ 个整数，分别表示有 $0$ 个、$1$ 个、$2$ 个……$8$ 个表面抹着奶油的小块蛋糕数量，所有值之间用单个空格隔开。为了防止答案过大，你只需要输出答案除以 $2148473648$ 的余数。", "hint": "### 样例解释\n\n对于第一组数据，把 $2 \\times 2 \\times 2 \\times 3$ 的蛋糕切成小块后，共形成了 $24$ 个小立方体，其中有 $16$ 个小块分别与其他 $4$ 个小块相邻，因此它们有 $4$ 个面涂有奶油，而另外 $8$ 个小块分别与其他 $5$ 个小块相邻，因此它们有 $3$ 个面涂有奶油。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5457", "type": "P", "difficulty": 5, "samples": [["2\n2 2\n3 3", "5\n150"]], "limits": {"time": [1000], "memory": [512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 生生不息", "background": "", "description": "生命游戏是一个经典的零玩家游戏。\n\n游戏在一块 $n \\times m$ 的方格棋盘上进行，初始时，棋盘上的一些格子中有生命，另一些格子中没有生命。\n\n在新的一天开始时，如果一个格子周围的 $8$ 个（边界上的格子也许不到 $8$ 个）格子中，在前一天有恰好$2$个或$3$个格子中有生命，则这个格子上的生命可以继续生存，如果周围的格子中恰好有$3$个格子在前一天有生命且这个格子中前一天没有生命，则会在这个格子中诞生新的生命。在其他情况下，该格子中原有的生命则会死去且不会产生新的生命。\n\n如果在某一天，棋盘上所有的格子里都没有生命，显然，在接下来的时间里，所有的格子中再也不会有生命了，我们就说这些生命灭绝了。\n\n现在，牛牛希望让菲菲来决定游戏开始时棋盘上的每个格子中是否有生命。\n\n而他想知道，在游戏开始时，菲菲有多少种不同的方法使得棋盘上的生命永远也不会灭绝。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。（$T <= 30$）\n\n接下来依次描述每组数据，对于每组数据：\n\n* 一行 $2$ 个正整数 $n$、$m$。（$n,m<=5$）", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 一行输出 $1$ 个整数，表示问题的答案。", "hint": "来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Endless Life", "background": "", "description": "The Game of Life is a classic zero-player game.\n\nThe game is played on an $n \\times m$ grid board. Initially, some cells contain life, and the others do not.\n\nWhen a new day begins, if among the 8 neighboring cells around a cell (cells on the boundary may have fewer than 8 neighbors), there were exactly $2$ or $3$ living cells on the previous day, then the life in this cell can continue to survive. If among the neighboring cells there were exactly $3$ living cells on the previous day and this cell was not alive on the previous day, then new life is born in this cell. In all other cases, any existing life in this cell dies, and no new life is created.\n\nIf on some day, there is no life in any cell on the board, then obviously in the following days there will never be life in any cell again. We say that life has gone extinct.\n\nNow, Niuniu wants Feifei to decide whether each cell on the board is alive at the start of the game.\n\nHe wants to know how many different initial configurations Feifei can choose so that life on the board will never go extinct.", "inputFormat": "The input contains multiple test cases. The first line contains an integer $T$ indicating the number of test cases. ($T <= 30$)\n\nThen each test case is described as follows:\n\n* One line with $2$ positive integers $n$ and $m$. ($n,m<=5$)", "outputFormat": "For each test case, output $1$ line:\n\n* Output one integer, representing the answer.", "hint": "From the 2018 Tsinghua University Programming Contest and College Invitational Contest (THUPC 2018). Thanks to [Pony.ai](http://pony.ai) for supporting this contest.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 生生不息", "background": "", "description": "生命游戏是一个经典的零玩家游戏。\n\n游戏在一块 $n \\times m$ 的方格棋盘上进行，初始时，棋盘上的一些格子中有生命，另一些格子中没有生命。\n\n在新的一天开始时，如果一个格子周围的 $8$ 个（边界上的格子也许不到 $8$ 个）格子中，在前一天有恰好$2$个或$3$个格子中有生命，则这个格子上的生命可以继续生存，如果周围的格子中恰好有$3$个格子在前一天有生命且这个格子中前一天没有生命，则会在这个格子中诞生新的生命。在其他情况下，该格子中原有的生命则会死去且不会产生新的生命。\n\n如果在某一天，棋盘上所有的格子里都没有生命，显然，在接下来的时间里，所有的格子中再也不会有生命了，我们就说这些生命灭绝了。\n\n现在，牛牛希望让菲菲来决定游戏开始时棋盘上的每个格子中是否有生命。\n\n而他想知道，在游戏开始时，菲菲有多少种不同的方法使得棋盘上的生命永远也不会灭绝。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。（$T <= 30$）\n\n接下来依次描述每组数据，对于每组数据：\n\n* 一行 $2$ 个正整数 $n$、$m$。（$n,m<=5$）", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 一行输出 $1$ 个整数，表示问题的答案。", "hint": "来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5458", "type": "P", "difficulty": 6, "samples": [["4\n0 0 0 11\n1 0 0 5\n0 1 0 7\n0 0 -1 13", "25.1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "2016", "各省省选", "网络流", "北京", "O2优化"], "title": "[BJOI2016] 水晶", "background": "不用惊慌，今天的题都不是小强出的。  \n\n——融入了无数心血的作品，现在却不得不亲手毁掉，难以体会他的心情啊。\n\n——那也是没有办法的事情，能量共振不消除的话…… \n\n望着已经被装上炸药的水晶，02放下了望远镜，看向了手中的共振分析报告。  \n\n还是会有一些水晶，幸存下来的…… 也许吧。", "description": "地图由密铺的六边形单元组成，每个单元与其他六个单元相邻。  \n\n为了方便起见，我们用坐标 $(x,y,z)$ 描述一个单元的位置，表示从原点开始按如图所示的 $x,y,z$ 方向各走若干步之后到达的地方。  \n\n有可能有两个坐标描述同一个单元，比如 $(1,1,1)$ 和 $(0,0,0)$ 描述的都是原点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dd1hb5vv.png)\n\n显然 $(x,y,z)$ 单元和 $(x+1,y,z)$，$(x-1,y,z)$ ，$(x,y+1,z)$，$(x,y-1,z)$，$(x,y,z+1)$，$(x,y,z-1)$ 相邻。  \n\n有 $N$ 块水晶位于地图的单元内，第 $i$ 块水晶位于坐标 $(x_i, y_i, z_i)$ 所表示的单元中，并拥有 $c_i$ 的价值，每个单元内部可能会有多块水晶。  \n\n地图中，有一些单元安装有能量源。如下图，任何满足 $x+y+z$ 是 $3$ 的整数倍的坐标所描述的单元内都安装有能量源。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9x4o6dhs.png)\n\n有能量源的单元中的水晶价值将会额外增加 $10\\%$。如果三块水晶所在的单元满足特定排列，那么它们将会引发共振。 \n\n共振分两种，$a$ 共振和 $b$ 共振。  \n\n$a$ 共振：如果三块水晶所在的单元两两相邻地排成一个三角形，那么会引起 $a$ 共振。   \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/48uc3ey4.png)\n\n图中每一个三角形表示这三个单元各有一块水晶将会发生一个 $a$ 共振。  \n\n$b$ 共振：如果三块水晶所在的单元依次相邻地排成一条长度为 $2$ 的直线段，且正中间的单元恰好有能量源，那么会引起b共振。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2b47zl09.png)\n\n图中粉红色线段表示这三个单元各有一块水晶将会发生一个 $b$ 共振，黑色线段表示即使这三个单元有水晶也不会发生 $b$ 共振。  \n\n现在你要炸掉一部分水晶，使得任何共振都不会发生的前提下，剩余水晶的价值总和最大。", "inputFormat": "第一行一个正整数 $N$，表示水晶数量。  \n接下来 $N$ 行，每行四个整数用空格分开的整数 $x_i,y_i,z_i,c_i$，表示一个水晶的位置和价值。  \n有可能有水晶的位置重合。  ", "outputFormat": "一行一个实数，表示剩余水晶的价值总和，四舍五入保留 $1$ 位小数。", "hint": "【样例 $1$ 说明】   \n\n四块水晶排成一个菱形，没有 $b$ 共振，有 $2$ 处 $a$ 共振，分别是 $1,2,4$ 号水晶和 $1,3,4$ 号水晶形成的三角形。 \n因此，为了消除两处 $a$ 共振，有如下 $3$ 种方案：\n\n1. 炸掉 $1$ 号水晶，留下 $2,3,4$ 号水晶，总剩余价值 $5+7+13=25$\n2. 炸掉 $4$ 号水晶，留下 $1,2,3$ 号水晶，总剩余价值 $11 \\times(1+10\\%)+5+7=24.1$   \n3. 炸掉 $2,3$ 号水晶，留下$1,4$ 号水晶，总剩余价值 $11 \\times (1+10\\%)+13=25.1$  \n\n因此我们采用第三种方案，最大总剩余价值为$25.1$。    \n\n【数据范围】  \n\n$1\\le N \\le 50000$    \n$1\\le c_i \\le 1000$   \n$-1000 \\le x_i,y_i,z_i \\le 1000$   ", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2016] Crystal", "background": "Do not panic, none of today’s problems were made by Xiaoqiang.\n\n—A work poured with countless efforts, yet now he has to destroy it with his own hands. It is hard to understand how he feels.\n\n—There is no other choice. If the energy resonance is not removed...\n\nLooking at the crystals already planted with explosives, 02 put down the telescope and looked at the resonance analysis report in his hand.\n\nSome crystals will still survive... maybe.", "description": "The map consists of densely tiled hexagonal cells, and each cell is adjacent to six other cells.\n\nFor convenience, we use coordinates $(x,y,z)$ to describe the position of a cell: starting from the origin, walk several steps along the $x$, $y$, and $z$ directions as shown in the figure to reach that cell.\n\nIt is possible that two coordinates describe the same cell. For example, $(1,1,1)$ and $(0,0,0)$ both describe the origin.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dd1hb5vv.png)\n\nClearly, cell $(x,y,z)$ is adjacent to $(x+1,y,z)$, $(x-1,y,z)$, $(x,y+1,z)$, $(x,y-1,z)$, $(x,y,z+1)$, and $(x,y,z-1)$.\n\nThere are $N$ crystals located in the cells of the map. The $i$-th crystal is in the cell described by coordinates $(x_i, y_i, z_i)$ and has value $c_i$. A single cell may contain multiple crystals.\n\nOn the map, some cells have energy sources installed. As shown below, any cell described by coordinates whose $x+y+z$ is a multiple of $3$ has an energy source installed.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9x4o6dhs.png)\n\nThe value of crystals in a cell with an energy source increases by an additional $10\\%$. If the cells containing three crystals satisfy certain patterns, they will trigger resonance.\n\nThere are two types of resonance: $a$ resonance and $b$ resonance.\n\n$a$ resonance: If the cells containing three crystals form a triangle such that every pair of cells is adjacent, then an $a$ resonance is triggered.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/48uc3ey4.png)\n\nIn the figure, each triangle means that if each of the three cells contains one crystal, they will trigger one $a$ resonance.\n\n$b$ resonance: If the cells containing three crystals are arranged in a straight line segment of length $2$ such that consecutive cells are adjacent, and the middle cell has an energy source, then a $b$ resonance is triggered.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2b47zl09.png)\n\nIn the figure, the pink segments indicate that if each of the three cells contains one crystal, they will trigger a $b$ resonance. The black segments indicate that even if these three cells contain crystals, they will not trigger a $b$ resonance.\n\nNow you need to blow up some crystals so that no resonance occurs, and under this condition, maximize the total value of the remaining crystals.", "inputFormat": "The first line contains a positive integer $N$, the number of crystals.  \nThe next $N$ lines each contain four integers separated by spaces: $x_i,y_i,z_i,c_i$, describing the position and value of a crystal.  \nDifferent crystals may share the same position.", "outputFormat": "Output one real number in a single line: the total value of the remaining crystals, rounded to $1$ decimal place.", "hint": "[Sample $1$ Explanation]\n\nFour crystals form a diamond shape. There is no $b$ resonance, and there are $2$ occurrences of $a$ resonance: the triangles formed by crystals $1,2,4$ and by crystals $1,3,4$.\n\nTherefore, to eliminate the two $a$ resonances, there are $3$ possible plans:\n\n1. Blow up crystal $1$, keep crystals $2,3,4$, total remaining value $5+7+13=25$.\n2. Blow up crystal $4$, keep crystals $1,2,3$, total remaining value $11 \\times(1+10\\%)+5+7=24.1$.\n3. Blow up crystals $2,3$, keep crystals $1,4$, total remaining value $11 \\times (1+10\\%)+13=25.1$.\n\nSo we choose the third plan, and the maximum total remaining value is $25.1$.\n\n[Constraints]\n\n$1\\le N \\le 50000$  \n$1\\le c_i \\le 1000$  \n$-1000 \\le x_i,y_i,z_i \\le 1000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2016] 水晶", "background": "不用惊慌，今天的题都不是小强出的。  \n\n——融入了无数心血的作品，现在却不得不亲手毁掉，难以体会他的心情啊。\n\n——那也是没有办法的事情，能量共振不消除的话…… \n\n望着已经被装上炸药的水晶，02放下了望远镜，看向了手中的共振分析报告。  \n\n还是会有一些水晶，幸存下来的…… 也许吧。", "description": "地图由密铺的六边形单元组成，每个单元与其他六个单元相邻。  \n\n为了方便起见，我们用坐标 $(x,y,z)$ 描述一个单元的位置，表示从原点开始按如图所示的 $x,y,z$ 方向各走若干步之后到达的地方。  \n\n有可能有两个坐标描述同一个单元，比如 $(1,1,1)$ 和 $(0,0,0)$ 描述的都是原点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dd1hb5vv.png)\n\n显然 $(x,y,z)$ 单元和 $(x+1,y,z)$，$(x-1,y,z)$ ，$(x,y+1,z)$，$(x,y-1,z)$，$(x,y,z+1)$，$(x,y,z-1)$ 相邻。  \n\n有 $N$ 块水晶位于地图的单元内，第 $i$ 块水晶位于坐标 $(x_i, y_i, z_i)$ 所表示的单元中，并拥有 $c_i$ 的价值，每个单元内部可能会有多块水晶。  \n\n地图中，有一些单元安装有能量源。如下图，任何满足 $x+y+z$ 是 $3$ 的整数倍的坐标所描述的单元内都安装有能量源。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9x4o6dhs.png)\n\n有能量源的单元中的水晶价值将会额外增加 $10\\%$。如果三块水晶所在的单元满足特定排列，那么它们将会引发共振。 \n\n共振分两种，$a$ 共振和 $b$ 共振。  \n\n$a$ 共振：如果三块水晶所在的单元两两相邻地排成一个三角形，那么会引起 $a$ 共振。   \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/48uc3ey4.png)\n\n图中每一个三角形表示这三个单元各有一块水晶将会发生一个 $a$ 共振。  \n\n$b$ 共振：如果三块水晶所在的单元依次相邻地排成一条长度为 $2$ 的直线段，且正中间的单元恰好有能量源，那么会引起b共振。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2b47zl09.png)\n\n图中粉红色线段表示这三个单元各有一块水晶将会发生一个 $b$ 共振，黑色线段表示即使这三个单元有水晶也不会发生 $b$ 共振。  \n\n现在你要炸掉一部分水晶，使得任何共振都不会发生的前提下，剩余水晶的价值总和最大。", "inputFormat": "第一行一个正整数 $N$，表示水晶数量。  \n接下来 $N$ 行，每行四个整数用空格分开的整数 $x_i,y_i,z_i,c_i$，表示一个水晶的位置和价值。  \n有可能有水晶的位置重合。  ", "outputFormat": "一行一个实数，表示剩余水晶的价值总和，四舍五入保留 $1$ 位小数。", "hint": "【样例 $1$ 说明】   \n\n四块水晶排成一个菱形，没有 $b$ 共振，有 $2$ 处 $a$ 共振，分别是 $1,2,4$ 号水晶和 $1,3,4$ 号水晶形成的三角形。 \n因此，为了消除两处 $a$ 共振，有如下 $3$ 种方案：\n\n1. 炸掉 $1$ 号水晶，留下 $2,3,4$ 号水晶，总剩余价值 $5+7+13=25$\n2. 炸掉 $4$ 号水晶，留下 $1,2,3$ 号水晶，总剩余价值 $11 \\times(1+10\\%)+5+7=24.1$   \n3. 炸掉 $2,3$ 号水晶，留下$1,4$ 号水晶，总剩余价值 $11 \\times (1+10\\%)+13=25.1$  \n\n因此我们采用第三种方案，最大总剩余价值为$25.1$。    \n\n【数据范围】  \n\n$1\\le N \\le 50000$    \n$1\\le c_i \\le 1000$   \n$-1000 \\le x_i,y_i,z_i \\le 1000$   ", "locale": "zh-CN"}}}
{"pid": "P5459", "type": "P", "difficulty": 4, "samples": [["5 5 9\n1 2 3 4 5", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "线段树", "各省省选", "树状数组", "离散化", "北京", "cdq 分治", "O2优化"], "title": "[BJOI2016] 回转寿司", "background": null, "description": "酷爱日料的小 Z 经常光顾学校东门外的回转寿司店。在这里，一盘盘寿司通过传送带依次呈现在小 Z 眼前。  \n\n不同的寿司带给小 Z 的味觉感受是不一样的，我们定义小 Z 对每盘寿司都有一个满意度。  \n\n例如小 Z 酷爱三文鱼，他对一盘三文鱼寿司的满意度为 $10$；小 Z 觉得金枪鱼没有什么味道，他对一盘金枪鱼寿司的满意度只有 $5$；小 Z 最近看了电影《美人鱼》，被里面的八爪鱼恶心到了，所以他对一盘八爪鱼刺身的满意度是 $-100$。\n\n特别地，小 Z 是个著名的吃货，他吃回转寿司有一个习惯，我们称之为“狂吃不止”。具体地讲，当他吃掉传送带上的一盘寿司后，他会毫不犹豫地吃掉它后面的寿司，直到他不想再吃寿司了为止。  \n\n今天，小 Z 再次来到了这家回转寿司店，$N$ 盘寿司将依次经过他的面前。其中，小 Z 对第 $i$ 盘寿司的满意度为 $a_i$。  \n\n小 Z 可以选择从哪盘寿司开始吃，也可以选择吃到哪盘寿司为止。他想知道共有多少种不同的选择，使得他的满意度之和不低于 $L$，且不高于 $R$。\n\n注意，虽然这是回转寿司，但是我们不认为这是一个环上的问题，而是一条线上的问题。即，小 Z 能吃到的是输入序列的一个连续子序列；最后一盘转走之后，第一盘并不会再出现一次。", "inputFormat": "第一行三个正整数 $N,L,R$，表示寿司盘数，满意度的下限和上限。\n\n第二行包含 $N$ 个整数 $a_i$，表示小 Z 对寿司的满意度。", "outputFormat": "一行一个整数，表示有多少种方案可以使得小 Z 的满意度之和不低于 $L$ 且不高于 $R$。", "hint": "### 【数据范围】\n\n$1\\le N \\le 10^5$；  \n$|a_i| \\le 10^5$；   \n$0\\le L,R \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2016] Conveyor Belt Sushi.", "background": "", "description": "Xiao Z, who loves Japanese food, often visits the conveyor belt sushi restaurant outside the east gate of his school. There, plates of sushi appear in front of him one by one on a conveyor belt.\n\nDifferent sushi gives Xiao Z different tastes, so we define that Xiao Z has a satisfaction value for each plate of sushi.\n\nFor example, Xiao Z loves salmon, so his satisfaction for a plate of salmon sushi is $10$; Xiao Z thinks tuna has little taste, so his satisfaction for a plate of tuna sushi is only $5$; Xiao Z recently watched the movie *Mermaid* and felt disgusted by the octopus in it, so his satisfaction for a plate of octopus sashimi is $-100$.\n\nIn particular, Xiao Z is a famous foodie and has a habit when eating conveyor belt sushi, which we call “eating nonstop”. Specifically, once he eats a plate of sushi on the conveyor belt, he will immediately eat the sushi after it, until he does not want to eat anymore.\n\nToday, Xiao Z comes to this restaurant again. There will be $N$ plates of sushi passing in front of him in order. Xiao Z’s satisfaction for the $i$-th plate is $a_i$.\n\nXiao Z can choose which plate to start eating from, and he can also choose which plate to stop at. He wants to know how many different choices there are such that the total satisfaction is not less than $L$ and not greater than $R$.\n\nNote that although this is conveyor belt sushi, we do not treat it as a circular problem, but as a linear one. That is, what Xiao Z can eat is a contiguous subsequence of the input sequence; after the last plate passes by, the first plate will not appear again.", "inputFormat": "The first line contains three positive integers $N, L, R$, representing the number of sushi plates, the lower bound and the upper bound of satisfaction.  \nThe second line contains $N$ integers $a_i$, representing Xiao Z’s satisfaction for each plate of sushi.", "outputFormat": "Output one integer in a single line, representing how many choices make the total satisfaction not less than $L$ and not greater than $R$.", "hint": "Constraints.\n\n$1 \\le N \\le 10^5$  \n$|a_i| \\le 10^5$  \n$0 \\le L, R \\le 10^9$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2016] 回转寿司", "background": null, "description": "酷爱日料的小 Z 经常光顾学校东门外的回转寿司店。在这里，一盘盘寿司通过传送带依次呈现在小 Z 眼前。  \n\n不同的寿司带给小 Z 的味觉感受是不一样的，我们定义小 Z 对每盘寿司都有一个满意度。  \n\n例如小 Z 酷爱三文鱼，他对一盘三文鱼寿司的满意度为 $10$；小 Z 觉得金枪鱼没有什么味道，他对一盘金枪鱼寿司的满意度只有 $5$；小 Z 最近看了电影《美人鱼》，被里面的八爪鱼恶心到了，所以他对一盘八爪鱼刺身的满意度是 $-100$。\n\n特别地，小 Z 是个著名的吃货，他吃回转寿司有一个习惯，我们称之为“狂吃不止”。具体地讲，当他吃掉传送带上的一盘寿司后，他会毫不犹豫地吃掉它后面的寿司，直到他不想再吃寿司了为止。  \n\n今天，小 Z 再次来到了这家回转寿司店，$N$ 盘寿司将依次经过他的面前。其中，小 Z 对第 $i$ 盘寿司的满意度为 $a_i$。  \n\n小 Z 可以选择从哪盘寿司开始吃，也可以选择吃到哪盘寿司为止。他想知道共有多少种不同的选择，使得他的满意度之和不低于 $L$，且不高于 $R$。\n\n注意，虽然这是回转寿司，但是我们不认为这是一个环上的问题，而是一条线上的问题。即，小 Z 能吃到的是输入序列的一个连续子序列；最后一盘转走之后，第一盘并不会再出现一次。", "inputFormat": "第一行三个正整数 $N,L,R$，表示寿司盘数，满意度的下限和上限。\n\n第二行包含 $N$ 个整数 $a_i$，表示小 Z 对寿司的满意度。", "outputFormat": "一行一个整数，表示有多少种方案可以使得小 Z 的满意度之和不低于 $L$ 且不高于 $R$。", "hint": "### 【数据范围】\n\n$1\\le N \\le 10^5$；  \n$|a_i| \\le 10^5$；   \n$0\\le L,R \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5460", "type": "P", "difficulty": 6, "samples": [["5 1\nAdd 110\nAdd 11\nDel 110\nDel 11\nAdd 110\n11011101001001010101011101000010 2 5", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "2016", "各省省选", "北京", "O2优化", "字典树 Trie"], "title": "[BJOI2016] IP地址", "background": null, "description": "路由表中每一项对应了一个形如 1011101????????????????????????? 的规则，会匹配指定的前缀为给定形式的 $\\texttt{ip}$。  \n\n当有多个规则匹配时，前缀最长的生效。同一时刻不会有多个匹配的规则的前缀一样长。每一个时刻，会有一条规则被加入，或者之前被加入的某条规则会过期。   \n\n给一系列 $\\texttt{ip}$，问每一个 $\\texttt{ip}$ 在一个给定的时间区间内匹配到的生效规则变了几次？  \n   \n例如，有一系列事件：    \n \n$\\texttt{Add}$ $110$   \n$\\texttt{Add}$ $11$   \n$\\texttt{Del}$ $110$   \n$\\texttt{Del}$ $11$   \n$\\texttt{Add}$ $110$     \n\n那么，$\\texttt{ip}$ 地址 11011101001001010101011101000010 在这五个时刻之后匹配到的生效规则分别是：  \n\n$110$ (第一条)，   \n$110$ (第一条)，   \n$11$ (第二条)，   \n空，   \n$110$ (第三条)。     \n\n其中，在第二个事件后到第五个事件后的这段过程中，一共变了 $3$ 次。", "inputFormat": "第一行两个正整数 $n,q$，表示事件数有询问数。  \n接下来 $n$ 行，每行描述一个事件，格式为：  \n\n$\\texttt{Add}$ $s$ 表示新建一个规则，匹配前缀为 $s$ 的所有 $\\texttt{ip}$。  \n$\\texttt{Del}$ $s$ 表示把当前前缀 $s$ 对应的规则删掉(过期)。保证之前有这样的一条规则还没被删。     \n\n接下来 $q$ 行，每行一个 $\\texttt{ip}$ 与两个正整数 $a,b$，表示查询在第 $a$ 个事件后到第 $b$ 个事件的这段时间里，这个 $\\texttt{ip}$ 匹配到的生效规则变化的次数。 $\\texttt{ip}$ 用01字符串来表示。", "outputFormat": "对于每次查询，输出一行一个整数表示答案。", "hint": "【数据范围】  \n\n- $1\\le n,q \\le 10^5$\n\n- $|s|\\le32$\n\n- 每个 $\\texttt{ip}$ 长度均为 $32$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2016] IP Address", "background": "", "description": "Each entry in the routing table corresponds to a rule of the form 1011101?????????????????????????, which matches an $\\texttt{ip}$ whose prefix fits the given pattern.\n\nWhen multiple rules match, the one with the longest prefix takes effect. At any time, there will not be multiple matching rules with the same prefix length. At each moment, either a rule is added, or some previously added rule expires.\n\nGiven a list of $\\texttt{ip}$ addresses, for each $\\texttt{ip}$, ask how many times the effective matched rule changes within a given time interval.\n\nFor example, suppose there is a sequence of events:\n\n$\\texttt{Add}$ $110$  \n$\\texttt{Add}$ $11$  \n$\\texttt{Del}$ $110$  \n$\\texttt{Del}$ $11$  \n$\\texttt{Add}$ $110$\n\nThen, for the $\\texttt{ip}$ address 11011101001001010101011101000010, the effective matched rules after these five moments are:\n\n$110$ (the first one),  \n$110$ (the first one),  \n$11$ (the second one),  \nempty,  \n$110$ (the third one).\n\nDuring the period from after the second event to after the fifth event, it changes a total of $3$ times.", "inputFormat": "The first line contains two positive integers $n,q$, representing the number of events and the number of queries.\n\nThe next $n$ lines each describe an event in the following format:\n\n$\\texttt{Add}$ $s$ means creating a new rule that matches all $\\texttt{ip}$ addresses with prefix $s$.  \n$\\texttt{Del}$ $s$ means deleting (expiring) the current rule corresponding to prefix $s$. It is guaranteed that such a rule exists and has not been deleted before.\n\nThe next $q$ lines each contain an $\\texttt{ip}$ and two positive integers $a,b$, meaning: during the time period from after the $a$-th event to the $b$-th event, how many times does the effective rule matched by this $\\texttt{ip}$ change? The $\\texttt{ip}$ is given as a binary string of 0 and 1.", "outputFormat": "For each query, output one line with an integer representing the answer.", "hint": "Constraints\n\n- $1\\le n,q \\le 10^5$.\n- $|s|\\le32$.\n- Each $\\texttt{ip}$ has length $32$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2016] IP地址", "background": null, "description": "路由表中每一项对应了一个形如 1011101????????????????????????? 的规则，会匹配指定的前缀为给定形式的 $\\texttt{ip}$。  \n\n当有多个规则匹配时，前缀最长的生效。同一时刻不会有多个匹配的规则的前缀一样长。每一个时刻，会有一条规则被加入，或者之前被加入的某条规则会过期。   \n\n给一系列 $\\texttt{ip}$，问每一个 $\\texttt{ip}$ 在一个给定的时间区间内匹配到的生效规则变了几次？  \n   \n例如，有一系列事件：    \n \n$\\texttt{Add}$ $110$   \n$\\texttt{Add}$ $11$   \n$\\texttt{Del}$ $110$   \n$\\texttt{Del}$ $11$   \n$\\texttt{Add}$ $110$     \n\n那么，$\\texttt{ip}$ 地址 11011101001001010101011101000010 在这五个时刻之后匹配到的生效规则分别是：  \n\n$110$ (第一条)，   \n$110$ (第一条)，   \n$11$ (第二条)，   \n空，   \n$110$ (第三条)。     \n\n其中，在第二个事件后到第五个事件后的这段过程中，一共变了 $3$ 次。", "inputFormat": "第一行两个正整数 $n,q$，表示事件数有询问数。  \n接下来 $n$ 行，每行描述一个事件，格式为：  \n\n$\\texttt{Add}$ $s$ 表示新建一个规则，匹配前缀为 $s$ 的所有 $\\texttt{ip}$。  \n$\\texttt{Del}$ $s$ 表示把当前前缀 $s$ 对应的规则删掉(过期)。保证之前有这样的一条规则还没被删。     \n\n接下来 $q$ 行，每行一个 $\\texttt{ip}$ 与两个正整数 $a,b$，表示查询在第 $a$ 个事件后到第 $b$ 个事件的这段时间里，这个 $\\texttt{ip}$ 匹配到的生效规则变化的次数。 $\\texttt{ip}$ 用01字符串来表示。", "outputFormat": "对于每次查询，输出一行一个整数表示答案。", "hint": "【数据范围】  \n\n- $1\\le n,q \\le 10^5$\n\n- $|s|\\le32$\n\n- 每个 $\\texttt{ip}$ 长度均为 $32$。", "locale": "zh-CN"}}}
{"pid": "P5461", "type": "P", "difficulty": 3, "samples": [["3", "0 0 0 0 0 0 0 1\n0 0 0 0 0 0 1 1\n0 0 0 0 0 1 0 1\n0 0 0 0 1 1 1 1\n0 0 0 1 0 0 0 1\n0 0 1 1 0 0 1 1\n0 1 0 1 0 1 0 1\n1 1 1 1 1 1 1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递归", "分治", "洛谷月赛"], "title": "赦免战俘", "background": "借助反作弊系统，一些在月赛有抄袭作弊行为的选手被抓出来了！", "description": "现有 $2^n\\times 2^n (n\\le10)$ 名作弊者站成一个正方形方阵等候 kkksc03 的发落。kkksc03 决定赦免一些作弊者。他将正方形矩阵均分为 $4$ 个更小的正方形矩阵，每个更小的矩阵的边长是原矩阵的一半。其中左上角那一个矩阵的所有作弊者都将得到赦免，剩下 $3$ 个小矩阵中，每一个矩阵继续分为 $4$ 个更小的矩阵，然后通过同样的方式赦免作弊者……直到矩阵无法再分下去为止。所有没有被赦免的作弊者都将被处以棕名处罚。\n\n给出 $n$，请输出每名作弊者的命运，其中 $0$ 代表被赦免，$1$ 代表不被赦免。", "inputFormat": "一个整数 $n$。", "outputFormat": "$2^n \\times 2^n$ 的 01 矩阵，代表每个人是否被赦免。数字之间有一个空格。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "Pardoning Prisoners of War", "background": "With the help of the anti-cheating system, some contestants who copied or cheated in the monthly contest have been caught.", "description": "There are $2^n \\times 2^n$ cheaters $(n \\le 10)$ standing in a square matrix, waiting for kkksc03's decision. kkksc03 decides to pardon some of them. He splits the square matrix evenly into $4$ smaller square matrices, and each smaller matrix has side length half of the original matrix. All cheaters in the upper-left matrix will be pardoned. In the remaining $3$ smaller matrices, each matrix is split into $4$ even smaller matrices, and cheaters are pardoned in the same way... until the matrix can no longer be split.\n\nAll cheaters who are not pardoned will receive the brown-name penalty.\n\nGiven $n$, output the fate of each cheater, where $0$ means pardoned and $1$ means not pardoned.", "inputFormat": "An integer $n$.", "outputFormat": "A $2^n \\times 2^n$ 01 matrix representing whether each person is pardoned. There is one space between numbers.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "赦免战俘", "background": "借助反作弊系统，一些在月赛有抄袭作弊行为的选手被抓出来了！", "description": "现有 $2^n\\times 2^n (n\\le10)$ 名作弊者站成一个正方形方阵等候 kkksc03 的发落。kkksc03 决定赦免一些作弊者。他将正方形矩阵均分为 $4$ 个更小的正方形矩阵，每个更小的矩阵的边长是原矩阵的一半。其中左上角那一个矩阵的所有作弊者都将得到赦免，剩下 $3$ 个小矩阵中，每一个矩阵继续分为 $4$ 个更小的矩阵，然后通过同样的方式赦免作弊者……直到矩阵无法再分下去为止。所有没有被赦免的作弊者都将被处以棕名处罚。\n\n给出 $n$，请输出每名作弊者的命运，其中 $0$ 代表被赦免，$1$ 代表不被赦免。", "inputFormat": "一个整数 $n$。", "outputFormat": "$2^n \\times 2^n$ 的 01 矩阵，代表每个人是否被赦免。数字之间有一个空格。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5462", "type": "P", "difficulty": 4, "samples": [["4 \n3 1 4 2", "4 2 3 1"], ["6 \n6 5 4 1 3 2", "6 5 4 1 3 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["堆", "洛谷月赛", "链表"], "title": "X龙珠", "background": null, "description": "“X 龙珠”是一款益智小游戏。游戏中有 $n(2|n)$ 个编号互不相同龙珠按照给定的顺序排成一个队列，每个龙珠上面都有一个编号。每次操作时，选择并取出龙珠队列中**相邻**的两个龙珠，放到目标队列的末尾（目标队列最开始是空的，且这两个龙珠的前后顺序不变），然后去除原龙珠队列的空隙。反复多次，直到原龙珠队列为空。可见，因为决策不一样导致目标队列顺序不一样。现在请求出所有方案中、目标队列字典序最大的方案。只需要给出目标队列即可。\n\n例如，当原龙珠队列是 $[1,3,2,4]$ 时，可以先取出 $3$ 和 $2$，此时目标队列是 $[3,2]$，原龙珠队列是 $[1,4]$；再将剩下两个龙珠放入目标队列，得到目标队列是 $[3,2,1,4]$。", "inputFormat": "第一行，一个整数 $n$。\n\n接下来一行，每行 $n$ 个整数，表示原龙珠队列的编号。", "outputFormat": "一行，$n$ 个整数。", "hint": "对于 $20\\%$ 的数据，$n\\le10$。  \n对于 $60\\%$ 的数据，$n\\le10^3$。  \n对于 $100\\%$ 的数据，$n\\le10^5$，龙珠编号不超过 $n$。", "locale": "zh-CN", "translations": {"en": {"title": "X Dragon Balls", "background": "", "description": "\"X Dragon Balls\" is a puzzle mini-game. In the game, there are $n(2|n)$ dragon balls with distinct numbers, arranged in a queue in the given order, and each dragon ball has a number on it.\n\nIn each operation, choose and take out two **adjacent** dragon balls from the original queue, and put them at the end of the target queue (the target queue is initially empty, and the relative order of these two dragon balls does not change). Then remove the gap in the original queue. Repeat this process until the original queue becomes empty. It is clear that different choices lead to different orders of the target queue. Now you need to find, among all possible operations, the one that makes the target queue lexicographically largest. You only need to output the target queue.\n\nFor example, when the original queue is [1,3,2,4], you can first take out 3 and 2. Then the target queue becomes [3,2], and the original queue becomes [1,4]. Next, put the remaining two dragon balls into the target queue, and the final target queue is [3,2,1,4].", "inputFormat": "The first line contains an integer $n$.\n\nThe next line contains $n$ integers, representing the numbers of the dragon balls in the original queue.", "outputFormat": "One line with $n$ integers.", "hint": "For 20% of the testdata, $n \\le 10$。  \nFor 60% of the testdata, $n \\le 10^3$。  \nFor 100% of the testdata, $n \\le 10^5$, and the dragon ball numbers do not exceed $n$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "X龙珠", "background": null, "description": "“X 龙珠”是一款益智小游戏。游戏中有 $n(2|n)$ 个编号互不相同龙珠按照给定的顺序排成一个队列，每个龙珠上面都有一个编号。每次操作时，选择并取出龙珠队列中**相邻**的两个龙珠，放到目标队列的末尾（目标队列最开始是空的，且这两个龙珠的前后顺序不变），然后去除原龙珠队列的空隙。反复多次，直到原龙珠队列为空。可见，因为决策不一样导致目标队列顺序不一样。现在请求出所有方案中、目标队列字典序最大的方案。只需要给出目标队列即可。\n\n例如，当原龙珠队列是 $[1,3,2,4]$ 时，可以先取出 $3$ 和 $2$，此时目标队列是 $[3,2]$，原龙珠队列是 $[1,4]$；再将剩下两个龙珠放入目标队列，得到目标队列是 $[3,2,1,4]$。", "inputFormat": "第一行，一个整数 $n$。\n\n接下来一行，每行 $n$ 个整数，表示原龙珠队列的编号。", "outputFormat": "一行，$n$ 个整数。", "hint": "对于 $20\\%$ 的数据，$n\\le10$。  \n对于 $60\\%$ 的数据，$n\\le10^3$。  \n对于 $100\\%$ 的数据，$n\\le10^5$，龙珠编号不超过 $n$。", "locale": "zh-CN"}}}
{"pid": "P5463", "type": "P", "difficulty": 4, "samples": [["8\n1 9 2 6 0 8 1 7", "106"], ["10\n1 10 8 5 6 2 3 9 4 7", "270"], ["20\n6 0 4 5 8 8 0 6 6 1 0 4 6 6 0 0 7 2 0 5", "3481"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["树状数组", "前缀和", "洛谷月赛"], "title": "小鱼比可爱（加强版）", "background": "", "description": "人比人，气死人；鱼比鱼，难死鱼。小鱼最近参加了一个“比可爱”比赛，比的是每只鱼的可爱程度。参赛的鱼被从左到右排成一排，头都朝向左边，然后每只鱼会得到一个整数数值，表示这只鱼的可爱程度，很显然整数越大，表示这只鱼越可爱，而且任意两只鱼的可爱程度可能一样。由于所有的鱼头都朝向左边，所以每只鱼只能看见在它左边的鱼的可爱程度，它们心里都在计算，在自己的眼力范围内有多少只鱼不如自己可爱呢。请你帮这些可爱但是鱼脑不够用的小鱼们计算一下。\n\n和之前的要求不一样，比赛组委会关心的是这个排列的“总得意值”。一共有 $n$ 只小鱼，总共有 $\\frac{n(n+1)}2$ 个不同的区间。每个区间的得意值等于这个区间中符合“左边的一只鱼的可爱值比右边的一只鱼可爱值更大”的对数（其实就是区间逆序对数啦）。总得意值就是所有区间的“得意值”的和。现在要求输出“总得意值”是多少。", "inputFormat": "第一行输入一个整数 $n$，表示鱼的数目。\n\n第二行内输入 $n$ 个整数 $a_1,a_2,\\cdots,a_n$，用空格间隔，依次表示从左到右每只小鱼的可爱程度。", "outputFormat": "输出一个整数表示答案。", "hint": "测试点　　　|$n$　　　　|$a_i$　　　　|是否有重复数字 　\n:-:|:-:|:-:|:-:\n$1$|$1$|无特殊限制|否\n$2$|$10$|无特殊限制|否\n$3$|$10$|无特殊限制|是\n$4$|$1000$|$\\le10$|是\n$5$|$1000$|无特殊限制|否\n$6$|$1000$|无特殊限制|是\n$7$|$10^5$|$\\le100$|是\n$8$|$3\\times 10^5$|无特殊限制|否\n$9$|$5\\times 10^5$|无特殊限制|是\n$10$|$10^6$|无特殊限制|是\n\n对于 $100\\%$ 的数据，$n \\le 10^6$，$a_i\\le 10^9$，所有数字均为非负整数。", "locale": "zh-CN", "translations": {"en": {"title": "Little Fish Compare Cuteness (Enhanced Version).", "background": "", "description": "When people compare with each other, it is annoying; when fish compare with each other, it is even worse. Little Fish recently joined a “cuteness comparison” contest, where the cuteness of each fish is compared. The fish are lined up from left to right, all facing to the left. Then each fish is given an integer value representing its cuteness. Obviously, the larger the integer is, the cuter the fish is, and any two fish may have the same cuteness value. Since all fish face left, each fish can only see the cuteness values of the fish to its left. They are all calculating in their minds: within their view, how many fish are less cute than themselves? Please help these cute little fish, whose brains are not good enough, compute this.\n\nDifferent from the previous requirement, the organizing committee cares about the “total smugness value” of this arrangement. There are $n$ little fish, and there are $\\frac{n(n+1)}2$ different intervals in total. The smugness value of each interval equals the number of pairs in this interval that satisfy “the fish on the left has a larger cuteness value than the fish on the right” (in fact, it is the number of inversions in the interval). The total smugness value is the sum of the smugness values of all intervals. Now you need to output what the “total smugness value” is.", "inputFormat": "The first line contains an integer $n$, representing the number of fish.\n\nThe second line contains $n$ integers $a_1,a_2,\\cdots,a_n$, separated by spaces, representing the cuteness of each little fish from left to right.", "outputFormat": "Output one integer representing the answer.", "hint": "Test Point | $n$ | $a_i$ | Are there duplicate numbers\n:-:|:-:|:-:|:-:\n$1$ | $1$ | No special restrictions | No\n$2$ | $10$ | No special restrictions | No\n$3$ | $10$ | No special restrictions | Yes\n$4$ | $1000$ | $\\le10$ | Yes\n$5$ | $1000$ | No special restrictions | No\n$6$ | $1000$ | No special restrictions | Yes\n$7$ | $10^5$ | $\\le100$ | Yes\n$8$ | $3\\times 10^5$ | No special restrictions | No\n$9$ | $5\\times 10^5$ | No special restrictions | Yes\n$10$ | $10^6$ | No special restrictions | Yes\n\nConstraints: for $100\\%$ of the data, $n \\le 10^6$, $a_i \\le 10^9$, and all numbers are non-negative integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小鱼比可爱（加强版）", "background": "", "description": "人比人，气死人；鱼比鱼，难死鱼。小鱼最近参加了一个“比可爱”比赛，比的是每只鱼的可爱程度。参赛的鱼被从左到右排成一排，头都朝向左边，然后每只鱼会得到一个整数数值，表示这只鱼的可爱程度，很显然整数越大，表示这只鱼越可爱，而且任意两只鱼的可爱程度可能一样。由于所有的鱼头都朝向左边，所以每只鱼只能看见在它左边的鱼的可爱程度，它们心里都在计算，在自己的眼力范围内有多少只鱼不如自己可爱呢。请你帮这些可爱但是鱼脑不够用的小鱼们计算一下。\n\n和之前的要求不一样，比赛组委会关心的是这个排列的“总得意值”。一共有 $n$ 只小鱼，总共有 $\\frac{n(n+1)}2$ 个不同的区间。每个区间的得意值等于这个区间中符合“左边的一只鱼的可爱值比右边的一只鱼可爱值更大”的对数（其实就是区间逆序对数啦）。总得意值就是所有区间的“得意值”的和。现在要求输出“总得意值”是多少。", "inputFormat": "第一行输入一个整数 $n$，表示鱼的数目。\n\n第二行内输入 $n$ 个整数 $a_1,a_2,\\cdots,a_n$，用空格间隔，依次表示从左到右每只小鱼的可爱程度。", "outputFormat": "输出一个整数表示答案。", "hint": "测试点　　　|$n$　　　　|$a_i$　　　　|是否有重复数字 　\n:-:|:-:|:-:|:-:\n$1$|$1$|无特殊限制|否\n$2$|$10$|无特殊限制|否\n$3$|$10$|无特殊限制|是\n$4$|$1000$|$\\le10$|是\n$5$|$1000$|无特殊限制|否\n$6$|$1000$|无特殊限制|是\n$7$|$10^5$|$\\le100$|是\n$8$|$3\\times 10^5$|无特殊限制|否\n$9$|$5\\times 10^5$|无特殊限制|是\n$10$|$10^6$|无特殊限制|是\n\n对于 $100\\%$ 的数据，$n \\le 10^6$，$a_i\\le 10^9$，所有数字均为非负整数。", "locale": "zh-CN"}}}
{"pid": "P5464", "type": "P", "difficulty": 6, "samples": [["3\n1 5\n2 7\n4 8\n", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "前缀和", "洛谷月赛"], "title": "缩小社交圈", "background": "", "description": "社交圈子里有 $n$ 个人，每个人都有一个 SAN 值范围 $[l_i,r_i]$。当两个人的 SAN 值交集不为空时，这两个人有 PY 关系。\n\n现在希望从社交圈子里面挑选出一些人组成一个集合 $S$，如果将所有集合内的人中有 PY 关系的那一对人都连上边，则 $S$ 刚好成为一个树（森林不行哦）。\n\n请问，有多少种可以选择的方案？由于答案可能很大，请对 $10^{9}+7$ 取模。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行 2 个整数，表示这个人的 SAN 值区间。", "outputFormat": "一行一个整数，表示答案。", "hint": "对于20%的数据，满足 $n \\leq 18$ 。\n\n对于40%的数据，满足 $n \\leq 50$\n\n对于60%的数据，满足 $n \\leq 200$\n\n对于100%的数据，满足 $n \\leq 2000,1 \\leq l_{i} <r_{i} \\leq 4000 $\n", "locale": "zh-CN", "translations": {"en": {"title": "Shrink the Social Circle", "background": "", "description": "There are $n$ people in a social circle. Each person has a SAN value interval $[l_i, r_i]$. If the SAN intervals of two people have a non-empty intersection, then these two people have a PY relationship.\n\nNow we want to pick some people from the social circle to form a set $S$. If we add an edge between every pair of people in the set who have a PY relationship, then $S$ must form exactly a tree (a forest is not allowed).\n\nHow many ways are there to choose such a set? Since the answer may be very large, output it modulo $10^{9}+7$.", "inputFormat": "The first line contains an integer $n$.\n\nThe next $n$ lines each contain two integers, describing the SAN value interval of a person.", "outputFormat": "Output one integer, the answer.", "hint": "For $20\\%$ of the testdata, $n \\leq 18$.\n\nFor $40\\%$ of the testdata, $n \\leq 50$.\n\nFor $60\\%$ of the testdata, $n \\leq 200$.\n\nFor $100\\%$ of the testdata, $n \\leq 2000$, $1 \\leq l_i < r_i \\leq 4000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "缩小社交圈", "background": "", "description": "社交圈子里有 $n$ 个人，每个人都有一个 SAN 值范围 $[l_i,r_i]$。当两个人的 SAN 值交集不为空时，这两个人有 PY 关系。\n\n现在希望从社交圈子里面挑选出一些人组成一个集合 $S$，如果将所有集合内的人中有 PY 关系的那一对人都连上边，则 $S$ 刚好成为一个树（森林不行哦）。\n\n请问，有多少种可以选择的方案？由于答案可能很大，请对 $10^{9}+7$ 取模。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行 2 个整数，表示这个人的 SAN 值区间。", "outputFormat": "一行一个整数，表示答案。", "hint": "对于20%的数据，满足 $n \\leq 18$ 。\n\n对于40%的数据，满足 $n \\leq 50$\n\n对于60%的数据，满足 $n \\leq 200$\n\n对于100%的数据，满足 $n \\leq 2000,1 \\leq l_{i} <r_{i} \\leq 4000 $\n", "locale": "zh-CN"}}}
{"pid": "P5465", "type": "P", "difficulty": 6, "samples": [["7\n1 1 2 1 4 6\n5\n3 4 6\n1 5 7\n1 2 4\n1 2 6\n1 3 5", "3/2\n13/5\n3/2\n2/1\n1/1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2018", "倍增"], "title": "[PKUSC2018] 星际穿越", "background": "", "description": "有 $n$ 个星球，它们的编号是 1 到 $n$，它们坐落在同一个星系内，这个星系可以抽象为一条数轴，每个星球都是数轴上的一个点，特别地，编号为 $i$ 的星球的坐标是 $i$。\n\n一开始，由于科技上的原因，这 $n$ 个星球的居民之间无法进行交流，因此他们也不知道彼此的存在。现在，这些星球独立发展出了星际穿越与星际交流的工具。对于第 $i$ 个星球，他通过发射强力信号，成功地与编号在 $[l_i,i-1]$ 的所有星球取得了联系(编号为 1 的星球没有发出任何信号)，取得联系的两个星球会建立 **双向** 的传送门，对于建立了传送门的两个星球 $u,v$，$u$ 上的居民可以花费 1 单位时间传送到 $v$，$v$ 上的居民也可以花费 1 单位时间传送到 $u$ ，我们用 $dist(x,y)$ 表示从编号为 $x$ 的星球出发，通过一系列星球间的传送门，传送到编号为 $y$ 的星球最少需要花费的时间。\n\n现在有 $q$ 个星际商人，第 $i$ 个商人初始所在的位置是 $x_i$, 他的目的地是 $[l_i,r_i]$ 中的其中一个星球，保证 $l_i<r_i<x_i$ 。他会在这些星球中等概率挑选一个星球 $y$ (每个星球都有一样的概率被选中作为目的地)，然后通过一系列星球的传送门，**花费最少的时间**到达星球 $y$ 。商人想知道他花费的期望时间是多少？也就是计算 $\\frac{1}{r_i-l_i+1}{\\sum_{y=l_i}^{r_i}{dist(x_i,y)}}$ 。\n", "inputFormat": "第一行一个正整数 $n$ ，表示星球的个数。\n\n第二行 $n-1$ 个正整数，第 $i$ 个正整数为  $l_{i+1}$ ，表示编号在 $[l_{i+1},i]$ 区间内所有星球已经与编号为 $i+1$ 的星球取得了联系，并且可以通过花费 1 单位进行彼此的传输。保证 $l_{i+1}\\leq i$\n\n第三行一个正整数 $q$ ，表示询问组数。\n\n接下来 $q$ 行，每行三个数字 $l_i,r_i,x_i$ ，表示在 $[l_i,r_i]$ 这个区间中等概率选择一个星球 $y$，$dist(x_i,y)$ 的期望。保证 $l_i<r_i<x_i$\n", "outputFormat": "对于每组询问，注意到答案必然是一个有理数，因此以 $p/q$ 的格式输出这个有理数，要求 $\\gcd(p,q)=1$ 。\n\n如果答案为整数 $m$ ，输出 $m/1$ 。", "hint": "样例对应的无向图如下：![ex](https://cdn.luogu.com.cn/upload/pic/63831.png)\n\n对于 $20\\%$ 的数据，满足 $n \\leq 100$。\n\n对于另 $25\\%$ 的数据，满足 $n\\leq 2000$\n\n对于另 $25\\%$ 的数据，满足 $n\\leq 5000$\n\n对于 $100\\%$ 的数据，满足 $n,q\\leq 3\\times 10^5$", "locale": "zh-CN", "translations": {"en": {"title": "[PKUSC2018] Interstellar Travel", "background": "", "description": "There are $n$ planets, numbered from 1 to $n$. They are located in the same galaxy, which can be modeled as a number line. Each planet is a point on the number line. In particular, the coordinate of planet $i$ is $i$.\n\nAt the beginning, due to technological limits, the residents of these $n$ planets could not communicate with each other, so they did not know each other existed. Now, these planets have independently developed tools for interstellar travel and interstellar communication. For planet $i$, by sending a powerful signal, it successfully made contact with all planets with indices in $[l_i,i-1]$ (planet 1 did not send any signal). Any two planets that make contact will build a **bidirectional** portal. For two planets $u,v$ that have a portal between them, residents on $u$ can spend 1 unit of time to teleport to $v$, and residents on $v$ can also spend 1 unit of time to teleport to $u$. Let $dist(x,y)$ denote the minimum time needed to travel from planet $x$ to planet $y$ through a sequence of portals between planets.\n\nNow there are $q$ interstellar merchants. The initial position of the $i$-th merchant is $x_i$, and his destination is one planet among $[l_i,r_i]$, where it is guaranteed that $l_i<r_i<x_i$. He will choose a planet $y$ in this interval uniformly at random (each planet has the same probability of being chosen as the destination), and then reach planet $y$ through portals, using the **minimum possible time**. The merchant wants to know the expected time he spends, i.e., compute $\\frac{1}{r_i-l_i+1}{\\sum_{y=l_i}^{r_i}{dist(x_i,y)}}$.", "inputFormat": "The first line contains a positive integer $n$, representing the number of planets.\n\nThe second line contains $n-1$ positive integers. The $i$-th positive integer is $l_{i+1}$, meaning that all planets with indices in the interval $[l_{i+1},i]$ have already made contact with planet $i+1$, and they can transmit to each other with cost 1. It is guaranteed that $l_{i+1}\\leq i$.\n\nThe third line contains a positive integer $q$, representing the number of queries.\n\nThe next $q$ lines each contain three numbers $l_i,r_i,x_i$, meaning: choose a planet $y$ uniformly at random in $[l_i,r_i]$, and ask for the expected value of $dist(x_i,y)$. It is guaranteed that $l_i<r_i<x_i$.", "outputFormat": "For each query, note that the answer must be a rational number, so output it in the form $p/q$, requiring $\\gcd(p,q)=1$.\n\nIf the answer is an integer $m$, output $m/1$.", "hint": "The undirected graph corresponding to the sample is as follows: ![ex](https://cdn.luogu.com.cn/upload/pic/63831.png)\n\nFor $20\\%$ of the testdata, $n \\leq 100$.\n\nFor another $25\\%$ of the testdata, $n\\leq 2000$.\n\nFor another $25\\%$ of the testdata, $n\\leq 5000$.\n\nFor $100\\%$ of the testdata, $n,q\\leq 3\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUSC2018] 星际穿越", "background": "", "description": "有 $n$ 个星球，它们的编号是 1 到 $n$，它们坐落在同一个星系内，这个星系可以抽象为一条数轴，每个星球都是数轴上的一个点，特别地，编号为 $i$ 的星球的坐标是 $i$。\n\n一开始，由于科技上的原因，这 $n$ 个星球的居民之间无法进行交流，因此他们也不知道彼此的存在。现在，这些星球独立发展出了星际穿越与星际交流的工具。对于第 $i$ 个星球，他通过发射强力信号，成功地与编号在 $[l_i,i-1]$ 的所有星球取得了联系(编号为 1 的星球没有发出任何信号)，取得联系的两个星球会建立 **双向** 的传送门，对于建立了传送门的两个星球 $u,v$，$u$ 上的居民可以花费 1 单位时间传送到 $v$，$v$ 上的居民也可以花费 1 单位时间传送到 $u$ ，我们用 $dist(x,y)$ 表示从编号为 $x$ 的星球出发，通过一系列星球间的传送门，传送到编号为 $y$ 的星球最少需要花费的时间。\n\n现在有 $q$ 个星际商人，第 $i$ 个商人初始所在的位置是 $x_i$, 他的目的地是 $[l_i,r_i]$ 中的其中一个星球，保证 $l_i<r_i<x_i$ 。他会在这些星球中等概率挑选一个星球 $y$ (每个星球都有一样的概率被选中作为目的地)，然后通过一系列星球的传送门，**花费最少的时间**到达星球 $y$ 。商人想知道他花费的期望时间是多少？也就是计算 $\\frac{1}{r_i-l_i+1}{\\sum_{y=l_i}^{r_i}{dist(x_i,y)}}$ 。\n", "inputFormat": "第一行一个正整数 $n$ ，表示星球的个数。\n\n第二行 $n-1$ 个正整数，第 $i$ 个正整数为  $l_{i+1}$ ，表示编号在 $[l_{i+1},i]$ 区间内所有星球已经与编号为 $i+1$ 的星球取得了联系，并且可以通过花费 1 单位进行彼此的传输。保证 $l_{i+1}\\leq i$\n\n第三行一个正整数 $q$ ，表示询问组数。\n\n接下来 $q$ 行，每行三个数字 $l_i,r_i,x_i$ ，表示在 $[l_i,r_i]$ 这个区间中等概率选择一个星球 $y$，$dist(x_i,y)$ 的期望。保证 $l_i<r_i<x_i$\n", "outputFormat": "对于每组询问，注意到答案必然是一个有理数，因此以 $p/q$ 的格式输出这个有理数，要求 $\\gcd(p,q)=1$ 。\n\n如果答案为整数 $m$ ，输出 $m/1$ 。", "hint": "样例对应的无向图如下：![ex](https://cdn.luogu.com.cn/upload/pic/63831.png)\n\n对于 $20\\%$ 的数据，满足 $n \\leq 100$。\n\n对于另 $25\\%$ 的数据，满足 $n\\leq 2000$\n\n对于另 $25\\%$ 的数据，满足 $n\\leq 5000$\n\n对于 $100\\%$ 的数据，满足 $n,q\\leq 3\\times 10^5$", "locale": "zh-CN"}}}
{"pid": "P5466", "type": "P", "difficulty": 6, "samples": [["1?0?", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "2018", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "[PKUSC2018] 神仙的游戏", "background": "", "description": "小 D 和小 H 是两位神仙。他们经常在一起玩神仙才会玩的一些游戏，比如 “口算一个 4 位数是不是完全平方数” 。\n\n今天他们发现了一种新的游戏：首先称 $s$ 长度为 $len$ 的前缀成为 border 当且仅当 $s[1\\dots len ] = s[|s|-len + 1\\dots |s|]$ 。给出一个由 $\\texttt{01?}$ 组成的字符串 $s$，将 $s$ 中的问号用 $\\texttt{01}$ 替换，对每个 $len$ 口算是否存在替换问号的方案使得 $s$ 长度为 $len$ 的前缀成为 border，把这个结果记做 $f(len)\\in \\{0,1\\}$。如果 $s$ 长度为 $len$ 的前缀能够成为 border 那么 $f(len) = 1$，否则 $f(len) = 0$。\n\n由于小 D 和小 H 是神仙，所以他们计算的 $s$ 的长度很长，因此把计算的结果一一比对会花费很长的时间。为了方便比对，他们规定了一个校验值：$(f(1)\\times 1^2)~\\operatorname{xor}~(f(2)\\times 2^2)~\\operatorname{xor}~(f(3)\\times 3^2)~\\operatorname{xor}~\\dots~\\operatorname{xor}~(f(n)\\times n^2)$ 来校验他们的答案是否相同。$\\operatorname{xor}$ 表示按位异或。但是不巧，在某一次游戏中，他们口算出的校验值并不一样，他们希望你帮助他们来计算一个正确的校验值。当然，他们不强迫你口算，可以编程解决。\n", "inputFormat": "一个串 $s$，保证每个字符都是 $\\texttt 0$，$\\texttt 1$ 或者 $\\texttt ?$。", "outputFormat": "输出字符串的校验值， 即 $(f(1)\\times 1^2)~\\operatorname{xor}~(f(2)\\times 2^2)~\\operatorname{xor}~(f(3)\\times 3^2)~\\operatorname{xor}~\\dots~\\operatorname{xor}~(f(n)\\times n^2)$。", "hint": "### 样例解释\n\n将问号填充为 1001，则这个串有长度为 1 的 border, 故 $f(1) = 1$。\n\n将问号填充为 1101，则这个串有长度为 4 的 border, 故 $f(4) = 1$。\n\n对于 $f(2)$ 和 $f(3)$，可以枚举填充的字符是什么来证明他们的值是 0。\n\n故答案是 $1^2~\\operatorname{xor}~4^2=17$。\n\n### 数据范围\n\n| 子任务编号 |        $\\lvert s \\rvert$         |         附加说明         | 分数 |\n| :--------: | :------------------: | :----------------------: | :--: |\n|     1      |     $\\leq 1000$      |            无            |  8   |\n|     2      | $\\leq 5 \\times 10^5$ |     输入的串没有问号     |  10  |\n|     3      | $\\leq 5\\times 10^5$  |         数据随机         |  22  |\n|     4      | $\\leq 5\\times 10^5$  | 问号个数至少是 $\\lvert s \\rvert -5000$ |  27  |\n|     5      | $\\leq 5\\times 10^5$  |            无            |  33  |\n", "locale": "zh-CN", "translations": {"en": {"title": "[PKUSC2018] Immortals' Game", "background": "", "description": "Little D and Little H are two immortals. They often play games that only immortals would play, such as “mentally checking whether a 4-digit number is a perfect square”.\n\nToday they found a new game: first, for a string $s$, a prefix of length $len$ is called a border if and only if $s[1\\dots len] = s[|s|-len+1\\dots |s|]$. Given a string $s$ consisting of $\\texttt{01?}$, replace each question mark in $s$ with $\\texttt{0}$ or $\\texttt{1}$. For each $len$, mentally determine whether there exists a way to replace the question marks such that the prefix of $s$ of length $len$ becomes a border, and record this result as $f(len)\\in\\{0,1\\}$. If the prefix of $s$ of length $len$ can become a border, then $f(len)=1$; otherwise $f(len)=0$.\n\nSince Little D and Little H are immortals, the length of $s$ they compute is very large, so comparing the results one by one would take a long time. To make comparison easier, they define a checksum: $(f(1)\\times 1^2)~\\operatorname{xor}~(f(2)\\times 2^2)~\\operatorname{xor}~(f(3)\\times 3^2)~\\operatorname{xor}~\\dots~\\operatorname{xor}~(f(n)\\times n^2)$ to verify whether their answers are the same. $\\operatorname{xor}$ denotes bitwise XOR. Unfortunately, in one game, the checksums they computed mentally were not the same. They want you to help them compute the correct checksum. Of course, they do not force you to do it mentally; you may solve it by programming.", "inputFormat": "A string $s$, guaranteed that each character is $\\texttt 0$, $\\texttt 1$, or $\\texttt ?$.", "outputFormat": "Output the checksum of the string, i.e. $(f(1)\\times 1^2)~\\operatorname{xor}~(f(2)\\times 2^2)~\\operatorname{xor}~(f(3)\\times 3^2)~\\operatorname{xor}~\\dots~\\operatorname{xor}~(f(n)\\times n^2)$.", "hint": "### Sample Explanation\n\nFill the question marks as 1001. Then this string has a border of length 1, so $f(1)=1$.\n\nFill the question marks as 1101. Then this string has a border of length 4, so $f(4)=1$.\n\nFor $f(2)$ and $f(3)$, you can enumerate what characters are filled in to prove that their values are 0.\n\nSo the answer is $1^2~\\operatorname{xor}~4^2=17$.\n\n### Constraints\n\n| Subtask ID |        $\\lvert s \\rvert$         |         Additional Notes         | Score |\n| :--------: | :------------------: | :----------------------: | :--: |\n|     1      |     $\\leq 1000$      |            None            |  8   |\n|     2      | $\\leq 5 \\times 10^5$ |     The input string has no question marks     |  10  |\n|     3      | $\\leq 5\\times 10^5$  |         The testdata is random         |  22  |\n|     4      | $\\leq 5\\times 10^5$  | The number of question marks is at least $\\lvert s \\rvert - 5000$ |  27  |\n|     5      | $\\leq 5\\times 10^5$  |            None            |  33  |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUSC2018] 神仙的游戏", "background": "", "description": "小 D 和小 H 是两位神仙。他们经常在一起玩神仙才会玩的一些游戏，比如 “口算一个 4 位数是不是完全平方数” 。\n\n今天他们发现了一种新的游戏：首先称 $s$ 长度为 $len$ 的前缀成为 border 当且仅当 $s[1\\dots len ] = s[|s|-len + 1\\dots |s|]$ 。给出一个由 $\\texttt{01?}$ 组成的字符串 $s$，将 $s$ 中的问号用 $\\texttt{01}$ 替换，对每个 $len$ 口算是否存在替换问号的方案使得 $s$ 长度为 $len$ 的前缀成为 border，把这个结果记做 $f(len)\\in \\{0,1\\}$。如果 $s$ 长度为 $len$ 的前缀能够成为 border 那么 $f(len) = 1$，否则 $f(len) = 0$。\n\n由于小 D 和小 H 是神仙，所以他们计算的 $s$ 的长度很长，因此把计算的结果一一比对会花费很长的时间。为了方便比对，他们规定了一个校验值：$(f(1)\\times 1^2)~\\operatorname{xor}~(f(2)\\times 2^2)~\\operatorname{xor}~(f(3)\\times 3^2)~\\operatorname{xor}~\\dots~\\operatorname{xor}~(f(n)\\times n^2)$ 来校验他们的答案是否相同。$\\operatorname{xor}$ 表示按位异或。但是不巧，在某一次游戏中，他们口算出的校验值并不一样，他们希望你帮助他们来计算一个正确的校验值。当然，他们不强迫你口算，可以编程解决。\n", "inputFormat": "一个串 $s$，保证每个字符都是 $\\texttt 0$，$\\texttt 1$ 或者 $\\texttt ?$。", "outputFormat": "输出字符串的校验值， 即 $(f(1)\\times 1^2)~\\operatorname{xor}~(f(2)\\times 2^2)~\\operatorname{xor}~(f(3)\\times 3^2)~\\operatorname{xor}~\\dots~\\operatorname{xor}~(f(n)\\times n^2)$。", "hint": "### 样例解释\n\n将问号填充为 1001，则这个串有长度为 1 的 border, 故 $f(1) = 1$。\n\n将问号填充为 1101，则这个串有长度为 4 的 border, 故 $f(4) = 1$。\n\n对于 $f(2)$ 和 $f(3)$，可以枚举填充的字符是什么来证明他们的值是 0。\n\n故答案是 $1^2~\\operatorname{xor}~4^2=17$。\n\n### 数据范围\n\n| 子任务编号 |        $\\lvert s \\rvert$         |         附加说明         | 分数 |\n| :--------: | :------------------: | :----------------------: | :--: |\n|     1      |     $\\leq 1000$      |            无            |  8   |\n|     2      | $\\leq 5 \\times 10^5$ |     输入的串没有问号     |  10  |\n|     3      | $\\leq 5\\times 10^5$  |         数据随机         |  22  |\n|     4      | $\\leq 5\\times 10^5$  | 问号个数至少是 $\\lvert s \\rvert -5000$ |  27  |\n|     5      | $\\leq 5\\times 10^5$  |            无            |  33  |\n", "locale": "zh-CN"}}}
{"pid": "P5467", "type": "P", "difficulty": 6, "samples": [["4 4\n0 0\n1 0\n-1 -1\n0 1\n0 0\n1 0\n1 1\n0 1\n", "0.50000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018"], "title": "[PKUSC2018] PKUSC", "background": "", "description": "九条可怜是一个爱玩游戏的女孩子。\n\n最近她在玩一个无双割草类的游戏，平面上有 $n$ 个敌人，每一个敌人的坐标为 $x_i,y_i$。可怜有一个技能是在平面上画一个 $m$ 个点的简单多边形，并消灭所有**严格**在多边形内部的敌人。\n\n不难发现如果想要快速的消灭敌人的话，只要画一个足够大的简单多边形就行了。但是这样的游戏性就太差了。于是可怜打算为游戏增加一定的随机性。\n\n可怜在平面上随便画了一个 $m$ 个点的简单多边形 $(a_i,b_i)$。接下来可怜打算按照 $[-\\pi,\\pi)$ 上的均匀分布随机选取数字 $\\alpha$（可以理解为等概率选取），并把这个简单多边形绕原点逆时针旋转 $\\alpha$ 的角度（弧度制）。\n\n现在可怜给你了每一个点的坐标，多边形的坐标，你的任务是帮助可怜计算在随机旋转后她期望可以消灭多少个敌人。", "inputFormat": "第一行四个整数 $n,m$。\n\n接下来 $n$ 行每行两个整数 $x_i,y_i$ 描述了一个敌人的坐标。\n\n接下来 $m$ 行每行两个整数 $a_i,b_i$ 按照逆时针的顺序描述了简单多边形的每一个顶点。", "outputFormat": "输出一行一个整数表示期望值，保留五位小数。同时保证所有数据的小数点后第 $6$ 位在舍入前不会是 $4$ 和 $5$。", "hint": "### 样例解释\n\n如果你对概率与期望不怎么了解，这儿给出一些 Hint:\n\n1. 设 $P_i$ 为旋转之后恰好能消灭 $i$ 个敌人的概率，那么期望就是 $\\sum_{i=1}^n iP_i$.\n2. 计算 $P_i$ 的一个方法是，在所有 $[-\\pi,\\pi)$ 范围内的旋转角度中，旋转后恰好消灭 $i$ 个敌人的角度构成了 $t_i$ 个区间 $(l_j,r_j)$（开闭不影响），那么 $P_i=\\frac{\\sum_{j=1}^{t_i}(r_j-l_j)}{2\\pi}$.\n\n在这题中：能消灭 $0$ 个敌人的区间是 $[\\frac{\\pi}{2},\\pi),[-\\pi,-\\frac{\\pi}{2}]$，能消灭 $1$ 个敌人的区间是 $(-\\frac{\\pi}{2},0),(0,\\frac{\\pi}{2})$。于是 $P_0 = P_1=\\frac{1}{2}$。所以答案为 $\\frac{1}{2}=0.50000$.\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$n,m \\leq 15$。\n\n对于另外 $30\\%$ 的数据，选择的简单多边形是一个凸多边形。\n\n对于 $100\\%$ 的数据，$n \\leq 200, m \\leq 500, |x|,|y| \\leq 10^6$.", "locale": "zh-CN", "translations": {"en": {"title": "[PKUSC2018] PKUSC", "background": "", "description": "Jiutiao Keliang is a girl who loves playing games.\n\nRecently, she has been playing a hack-and-slash mowing game. There are $n$ enemies on the plane, and the coordinates of each enemy are $x_i,y_i$. Keliang has a skill that allows her to draw a simple polygon with $m$ points on the plane, and eliminate all enemies that are **strictly** inside the polygon.\n\nIt is not hard to see that if she wants to eliminate enemies quickly, she can just draw a sufficiently large simple polygon. But that would make the game much less fun. So, Keliang decides to add some randomness to the game.\n\nKeliang casually draws a simple polygon with $m$ points $(a_i,b_i)$ on the plane. Next, she plans to randomly choose a number $\\alpha$ according to the uniform distribution on $[-\\pi,\\pi)$ (you can think of it as choosing with equal probability), and rotate this simple polygon counterclockwise around the origin by an angle of $\\alpha$ (in radians).\n\nNow Keliang gives you the coordinates of every point and the polygon. Your task is to help Keliang compute the expected number of enemies she can eliminate after a random rotation.", "inputFormat": "The first line contains four integers $n,m$.\n\nThe next $n$ lines each contain two integers $x_i,y_i$, describing the coordinates of an enemy.\n\nThe next $m$ lines each contain two integers $a_i,b_i$, describing each vertex of the simple polygon in counterclockwise order.", "outputFormat": "Output one line with one number representing the expected value, rounded to five digits after the decimal point. It is guaranteed that, before rounding, the $6$-th digit after the decimal point will not be $4$ or $5$ for all testdata.", "hint": "### Sample Explanation\n\nIf you are not very familiar with probability and expectation, here are some hints:\n\n1. Let $P_i$ be the probability that after rotation, exactly $i$ enemies can be eliminated. Then the expectation is $\\sum_{i=1}^n iP_i$.\n2. One way to compute $P_i$ is: among all rotation angles in the range $[-\\pi,\\pi)$, the angles for which exactly $i$ enemies are eliminated after rotation form $t_i$ intervals $(l_j,r_j)$ (whether endpoints are open or closed does not matter). Then $P_i=\\frac{\\sum_{j=1}^{t_i}(r_j-l_j)}{2\\pi}$.\n\nIn this problem: the intervals where $0$ enemies can be eliminated are $[\\frac{\\pi}{2},\\pi),[-\\pi,-\\frac{\\pi}{2}]$, and the intervals where $1$ enemy can be eliminated are $(-\\frac{\\pi}{2},0),(0,\\frac{\\pi}{2})$. Therefore, $P_0 = P_1=\\frac{1}{2}$. So the answer is $\\frac{1}{2}=0.50000$.\n\n### Constraints\n\nFor $30\\%$ of the data, $n,m \\leq 15$.\n\nFor another $30\\%$ of the data, the chosen simple polygon is a convex polygon.\n\nFor $100\\%$ of the data, $n \\leq 200, m \\leq 500, |x|,|y| \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUSC2018] PKUSC", "background": "", "description": "九条可怜是一个爱玩游戏的女孩子。\n\n最近她在玩一个无双割草类的游戏，平面上有 $n$ 个敌人，每一个敌人的坐标为 $x_i,y_i$。可怜有一个技能是在平面上画一个 $m$ 个点的简单多边形，并消灭所有**严格**在多边形内部的敌人。\n\n不难发现如果想要快速的消灭敌人的话，只要画一个足够大的简单多边形就行了。但是这样的游戏性就太差了。于是可怜打算为游戏增加一定的随机性。\n\n可怜在平面上随便画了一个 $m$ 个点的简单多边形 $(a_i,b_i)$。接下来可怜打算按照 $[-\\pi,\\pi)$ 上的均匀分布随机选取数字 $\\alpha$（可以理解为等概率选取），并把这个简单多边形绕原点逆时针旋转 $\\alpha$ 的角度（弧度制）。\n\n现在可怜给你了每一个点的坐标，多边形的坐标，你的任务是帮助可怜计算在随机旋转后她期望可以消灭多少个敌人。", "inputFormat": "第一行四个整数 $n,m$。\n\n接下来 $n$ 行每行两个整数 $x_i,y_i$ 描述了一个敌人的坐标。\n\n接下来 $m$ 行每行两个整数 $a_i,b_i$ 按照逆时针的顺序描述了简单多边形的每一个顶点。", "outputFormat": "输出一行一个整数表示期望值，保留五位小数。同时保证所有数据的小数点后第 $6$ 位在舍入前不会是 $4$ 和 $5$。", "hint": "### 样例解释\n\n如果你对概率与期望不怎么了解，这儿给出一些 Hint:\n\n1. 设 $P_i$ 为旋转之后恰好能消灭 $i$ 个敌人的概率，那么期望就是 $\\sum_{i=1}^n iP_i$.\n2. 计算 $P_i$ 的一个方法是，在所有 $[-\\pi,\\pi)$ 范围内的旋转角度中，旋转后恰好消灭 $i$ 个敌人的角度构成了 $t_i$ 个区间 $(l_j,r_j)$（开闭不影响），那么 $P_i=\\frac{\\sum_{j=1}^{t_i}(r_j-l_j)}{2\\pi}$.\n\n在这题中：能消灭 $0$ 个敌人的区间是 $[\\frac{\\pi}{2},\\pi),[-\\pi,-\\frac{\\pi}{2}]$，能消灭 $1$ 个敌人的区间是 $(-\\frac{\\pi}{2},0),(0,\\frac{\\pi}{2})$。于是 $P_0 = P_1=\\frac{1}{2}$。所以答案为 $\\frac{1}{2}=0.50000$.\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$n,m \\leq 15$。\n\n对于另外 $30\\%$ 的数据，选择的简单多边形是一个凸多边形。\n\n对于 $100\\%$ 的数据，$n \\leq 200, m \\leq 500, |x|,|y| \\leq 10^6$.", "locale": "zh-CN"}}}
{"pid": "P5468", "type": "P", "difficulty": 6, "samples": [["3 4 1 5 10\n1 2 3 4\n1 2 5 7\n1 2 6 8\n2 3 9 10", "94"], ["4 3 1 2 3\n1 2 2 3\n2 3 5 7\n3 4 7 9", "34"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2019", "NOI", "O2优化", "深度优先搜索 DFS", "斜率优化", "生成树"], "title": "[NOI2019] 回家路线", "background": "本题原题数据强度较低，若想要测试较强数据可以去 [P6302](https://www.luogu.com.cn/problem/P6302)，除数据范围外均与原题相同。", "description": "猫国的铁路系统中有 $n$ 个站点，从 $1 - n$ 编号。小猫准备从 $1$ 号站点出发，乘坐列车回到猫窝所在的 $n$ 号站点。它查询了能够乘坐的列车，这些列车共 $m$ 班，从 $1 - m$ 编号。小猫将在 $0$ 时刻到达 $1$ 号站点。对于 $i$ 号列车，它将在时刻 $p_i$ 从站点 $x_i$ 出发，在时刻 $q_i$ 直达站点 $y_i$，小猫只能在时刻 $p_i$ 上 $i$ 号列车，也只能在时刻 $q_i$ 下 $i$ 号列车。小猫可以通过多次换乘到达 $n$ 号站点。一次换乘是指对于两班列车，假设分别为 $u$ 号与 $v$ 号列车，若 $y_u = x_v$ 并且 $q_u \\leq p_v$，那么小猫可以乘坐完 $u$ 号列车后在 $y_u$ 号站点等待 $p_v - q_u$ 个时刻，并在时刻 $p_v$ 乘坐 $v$ 号列车。\n\n小猫只想回到猫窝并且减少途中的麻烦，对此它用烦躁值来衡量。\n\n- 小猫在站点等待时将增加烦躁值，对于一次 $t (t \\geq 0)$ 个时刻的等待，烦躁值将增加 $At^2 + Bt + C$，其中 $A, B,C$ 是给定的常数。注意：小猫登上第一班列车前，即从 $0$ 时刻起停留在 $1$ 号站点的那些时刻也算作一次等待。\n\n- 若小猫最终在时刻 $z$ 到达 $n$ 号站点，则烦躁值将再增加 $z$。\n\n形式化地说，若小猫共乘坐了 $k$ 班列车，依次乘坐的列车编号可用序列 $s_1, s_2, \\cdots , s_k$表示。该方案被称作一条可行的回家路线，当且仅当它满足下列两个条件：\n\n1. $x_{s1} = 1$ , $y_{sk} = n$\n\n2. 对于所有 $j (1 \\leq j < k)$，满足 $y_{sj} = x_{s_{j+1}}$ 且 $q_{sj}\\leq p_{s_{j+1}}$\n\n对于该回家路线，小猫得到的烦躁值将为：\n\n$$q_{s_k}+(A\\times p_{s_1}^2+B\\times p_{s_1}+C)+\\sum_{j=1}^{k-1}(A(p_{s_{j+1}}-q_{s_j})^2+B(p_{s_{j+1}}-q_{s_j})+C)$$\n\n小猫想让自己的烦躁值尽量小，请你帮它求出所有可行的回家路线中，能得到的最小的烦躁值。题目保证至少存在一条可行的回家路线。", "inputFormat": "第一行五个整数 $n, m, A, B,C$，变量意义见题目描述。\n\n接下来 $m$ 行，第 $i$ 行四个整数 $x_i, y_i, p_i, q_i$，分别表示 $i$ 号列车的出发站、到达站、出发时刻与到达时刻。", "outputFormat": "输出仅一行一个整数，表示所求的答案。", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 3\n\n见附加文件的 `route/route3.in` 与 `route/route3.ans`。\n\n该样例的数据类型与最终测试点 $5 \\sim 8$ 一致。\n\n#### 样例 4\n\n见附加文件的 `route/route4.in` 与 `route/route4.ans`。\n\n该样例的数据类型与最终测试点 $11 \\sim 14$ 一致。\n\n#### 样例 5\n\n见附加文件的 `route/route5.in` 与 `route/route5.ans`。\n\n该样例的数据类型与最终测试点 $18 \\sim 20$ 一致。\n\n### 样例 1 解释\n\n共有三条可行的回家路线：\n\n- 依次乘坐 1，4 号列车，得到的烦躁值为：$10 + (1 \\times 3^2 + 5 \\times 3 + 10) + (1 \\times (9 - 4)^2 + 5 \\times (9 - 4) + 10)= 104$\n- 依次乘坐 2，4 号列车，得到的烦躁值为：$10 + (1 \\times 5^2 + 5 \\times 5 + 10) + (1 \\times (9 - 7)^2 + 5 \\times (9 - 7) + 10)= 94$\n- 依次乘坐 3，4 号列车，得到的烦躁值为：$10 + (1 \\times 6^2 + 5 \\times 6 + 10) + (1 \\times (9 - 8)^2 + 5 \\times (9 - 8) + 10)= 102$\n\n第二条路线得到的烦躁值最小为 $94$。\n\n### 数据范围\n\n对于所有测试点：$2\\le n\\le 10^5,1\\le m\\le 2\\times 10^5,0 \\le A \\le 10 , 0 \\le B, C \\le 10^6,1 \\le x_i, y_i \\le n , x_i \\neq y_i , 0 \\le p_i < q_i \\le 10^3$。\n\n每个测试点的具体限制见下表：\n\n::cute-table{tuack}\n\n| 测试点编号  |        $n$         |          $m$          | $A,B,C$ 的特殊限制 | 其他特殊条件 |\n| :---------: | :----------------: | :-------------------: | :----------------: | :----------: |\n|  $1\\sim 2$  |     $\\le 100$      |        $=n-1$         |         无         | $y_i=x_i+1$  |\n|  $3\\sim 4$  |     ^      | $\\le 100$ |     $A=B=C=0$      | ^  |\n|  $5\\sim 8$  | $\\le 2\\times 10^3$ |  $\\le 4\\times 10^3$   |     ^              |  $x_i<y_i$   |\n|     $9$     | ^ |  ^   |      $A=B=0$       |  ^   |\n|    $10$     | ^ |  ^   |       $A=0$        |  ^   |\n| $11\\sim 14$ | ^ |  ^   |         无         |      无      |\n|    $15$     |     $\\le 10^5$     |  $\\le 2\\times 10^5$   |      $A=B=0$       |      ^      |\n| $16\\sim 17$ |     ^     |  ^   |       $A=0$        |      ^      |\n| $18\\sim 20$ |     ^     |  ^   |         无         |      ^      |", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2019] Route Home", "background": "The original version of this problem has relatively weak testdata. If you want to test with stronger testdata, you can go to [P6302](https://www.luogu.com.cn/problem/P6302). Except for the Constraints, everything is the same as the original problem.", "description": "In the railway system of Cat Kingdom, there are $n$ stations numbered from $1$ to $n$. A kitten plans to start from station $1$ and take trains to return to its home at station $n$. It has checked the available trains: there are $m$ trains in total, numbered from $1$ to $m$. The kitten will arrive at station $1$ at time $0$.\n\nFor train $i$, it departs from station $x_i$ at time $p_i$ and goes directly to station $y_i$, arriving at time $q_i$. The kitten can only board train $i$ at time $p_i$, and can only get off train $i$ at time $q_i$. The kitten can reach station $n$ by transferring multiple times.\n\nA transfer means the following: for two trains, say train $u$ and train $v$, if $y_u = x_v$ and $q_u \\leq p_v$, then after taking train $u$, the kitten can wait at station $y_u$ for $p_v - q_u$ time units, and then take train $v$ at time $p_v$.\n\nThe kitten wants to get home while reducing the trouble on the way, and it measures this by an “irritation value”.\n\n- While the kitten is waiting at a station, the irritation value increases. For a wait of $t (t \\geq 0)$ time units, the irritation value increases by $At^2 + Bt + C$, where $A, B, C$ are given constants. Note: the time it stays at station $1$ starting from time $0$ before boarding the first train also counts as one wait.\n\n- If the kitten finally arrives at station $n$ at time $z$, the irritation value increases by an additional $z$.\n\nFormally, suppose the kitten takes $k$ trains in total, and the sequence of train indices is $s_1, s_2, \\cdots , s_k$. This plan is called a feasible route home if and only if it satisfies:\n\n1. $x_{s1} = 1$ , $y_{sk} = n$\n\n2. For all $j (1 \\leq j < k)$, $y_{sj} = x_{s_{j+1}}$ and $q_{sj}\\leq p_{s_{j+1}}$\n\nFor this route home, the irritation value is:\n\n$$q_{s_k}+(A\\times p_{s_1}^2+B\\times p_{s_1}+C)+\\sum_{j=1}^{k-1}(A(p_{s_{j+1}}-q_{s_j})^2+B(p_{s_{j+1}}-q_{s_j})+C)$$\n\nThe kitten wants the irritation value to be as small as possible. Please compute, among all feasible routes home, the minimum possible irritation value. The problem guarantees that at least one feasible route exists.", "inputFormat": "The first line contains five integers $n, m, A, B, C$. Their meanings are as described in the statement.\n\nThe next $m$ lines: line $i$ contains four integers $x_i, y_i, p_i, q_i$, representing the departure station, arrival station, departure time, and arrival time of train $i$.", "outputFormat": "Output one integer in a single line, the required answer.", "hint": "### More Samples\n\nYou can obtain more samples through the additional files.\n\n#### Sample 3\n\nSee `route/route3.in` and `route/route3.ans` in the additional files.\n\nThe data type of this sample is the same as that of final test points $5 \\sim 8$.\n\n#### Sample 4\n\nSee `route/route4.in` and `route/route4.ans` in the additional files.\n\nThe data type of this sample is the same as that of final test points $11 \\sim 14$.\n\n#### Sample 5\n\nSee `route/route5.in` and `route/route5.ans` in the additional files.\n\nThe data type of this sample is the same as that of final test points $18 \\sim 20$.\n\n### Explanation for Sample 1\n\nThere are three feasible routes home:\n\n- Take trains 1 and 4 in order. The irritation value is: $10 + (1 \\times 3^2 + 5 \\times 3 + 10) + (1 \\times (9 - 4)^2 + 5 \\times (9 - 4) + 10)= 104$\n- Take trains 2 and 4 in order. The irritation value is: $10 + (1 \\times 5^2 + 5 \\times 5 + 10) + (1 \\times (9 - 7)^2 + 5 \\times (9 - 7) + 10)= 94$\n- Take trains 3 and 4 in order. The irritation value is: $10 + (1 \\times 6^2 + 5 \\times 6 + 10) + (1 \\times (9 - 8)^2 + 5 \\times (9 - 8) + 10)= 102$\n\nThe second route has the smallest irritation value, which is $94$.\n\n### Constraints\n\nFor all test points: $2\\le n\\le 10^5,1\\le m\\le 2\\times 10^5,0 \\le A \\le 10 , 0 \\le B, C \\le 10^6,1 \\le x_i, y_i \\le n , x_i \\neq y_i , 0 \\le p_i < q_i \\le 10^3$.\n\nThe specific limits for each test point are shown in the table below:\n\n::cute-table{tuack}\n\n| Test Point ID |        $n$         |          $m$          | Special Limits on $A,B,C$ | Other Special Conditions |\n| :-----------: | :----------------: | :-------------------: | :-----------------------: | :----------------------: |\n|  $1\\sim 2$    |     $\\le 100$      |        $=n-1$         |           None            | $y_i=x_i+1$              |\n|  $3\\sim 4$    |         ^          |        $\\le 100$      |       $A=B=C=0$           | ^                        |\n|  $5\\sim 8$    | $\\le 2\\times 10^3$ |  $\\le 4\\times 10^3$   |            ^              |  $x_i<y_i$               |\n|     $9$       |         ^          |          ^            |        $A=B=0$            | ^                        |\n|    $10$       |         ^          |          ^            |         $A=0$             | ^                        |\n| $11\\sim 14$   |         ^          |          ^            |           None            |           None           |\n|    $15$       |     $\\le 10^5$     |  $\\le 2\\times 10^5$   |        $A=B=0$            | ^                        |\n| $16\\sim 17$   |         ^          |          ^            |         $A=0$             | ^                        |\n| $18\\sim 20$   |         ^          |          ^            |           None            | ^                        |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2019] 回家路线", "background": "本题原题数据强度较低，若想要测试较强数据可以去 [P6302](https://www.luogu.com.cn/problem/P6302)，除数据范围外均与原题相同。", "description": "猫国的铁路系统中有 $n$ 个站点，从 $1 - n$ 编号。小猫准备从 $1$ 号站点出发，乘坐列车回到猫窝所在的 $n$ 号站点。它查询了能够乘坐的列车，这些列车共 $m$ 班，从 $1 - m$ 编号。小猫将在 $0$ 时刻到达 $1$ 号站点。对于 $i$ 号列车，它将在时刻 $p_i$ 从站点 $x_i$ 出发，在时刻 $q_i$ 直达站点 $y_i$，小猫只能在时刻 $p_i$ 上 $i$ 号列车，也只能在时刻 $q_i$ 下 $i$ 号列车。小猫可以通过多次换乘到达 $n$ 号站点。一次换乘是指对于两班列车，假设分别为 $u$ 号与 $v$ 号列车，若 $y_u = x_v$ 并且 $q_u \\leq p_v$，那么小猫可以乘坐完 $u$ 号列车后在 $y_u$ 号站点等待 $p_v - q_u$ 个时刻，并在时刻 $p_v$ 乘坐 $v$ 号列车。\n\n小猫只想回到猫窝并且减少途中的麻烦，对此它用烦躁值来衡量。\n\n- 小猫在站点等待时将增加烦躁值，对于一次 $t (t \\geq 0)$ 个时刻的等待，烦躁值将增加 $At^2 + Bt + C$，其中 $A, B,C$ 是给定的常数。注意：小猫登上第一班列车前，即从 $0$ 时刻起停留在 $1$ 号站点的那些时刻也算作一次等待。\n\n- 若小猫最终在时刻 $z$ 到达 $n$ 号站点，则烦躁值将再增加 $z$。\n\n形式化地说，若小猫共乘坐了 $k$ 班列车，依次乘坐的列车编号可用序列 $s_1, s_2, \\cdots , s_k$表示。该方案被称作一条可行的回家路线，当且仅当它满足下列两个条件：\n\n1. $x_{s1} = 1$ , $y_{sk} = n$\n\n2. 对于所有 $j (1 \\leq j < k)$，满足 $y_{sj} = x_{s_{j+1}}$ 且 $q_{sj}\\leq p_{s_{j+1}}$\n\n对于该回家路线，小猫得到的烦躁值将为：\n\n$$q_{s_k}+(A\\times p_{s_1}^2+B\\times p_{s_1}+C)+\\sum_{j=1}^{k-1}(A(p_{s_{j+1}}-q_{s_j})^2+B(p_{s_{j+1}}-q_{s_j})+C)$$\n\n小猫想让自己的烦躁值尽量小，请你帮它求出所有可行的回家路线中，能得到的最小的烦躁值。题目保证至少存在一条可行的回家路线。", "inputFormat": "第一行五个整数 $n, m, A, B,C$，变量意义见题目描述。\n\n接下来 $m$ 行，第 $i$ 行四个整数 $x_i, y_i, p_i, q_i$，分别表示 $i$ 号列车的出发站、到达站、出发时刻与到达时刻。", "outputFormat": "输出仅一行一个整数，表示所求的答案。", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 3\n\n见附加文件的 `route/route3.in` 与 `route/route3.ans`。\n\n该样例的数据类型与最终测试点 $5 \\sim 8$ 一致。\n\n#### 样例 4\n\n见附加文件的 `route/route4.in` 与 `route/route4.ans`。\n\n该样例的数据类型与最终测试点 $11 \\sim 14$ 一致。\n\n#### 样例 5\n\n见附加文件的 `route/route5.in` 与 `route/route5.ans`。\n\n该样例的数据类型与最终测试点 $18 \\sim 20$ 一致。\n\n### 样例 1 解释\n\n共有三条可行的回家路线：\n\n- 依次乘坐 1，4 号列车，得到的烦躁值为：$10 + (1 \\times 3^2 + 5 \\times 3 + 10) + (1 \\times (9 - 4)^2 + 5 \\times (9 - 4) + 10)= 104$\n- 依次乘坐 2，4 号列车，得到的烦躁值为：$10 + (1 \\times 5^2 + 5 \\times 5 + 10) + (1 \\times (9 - 7)^2 + 5 \\times (9 - 7) + 10)= 94$\n- 依次乘坐 3，4 号列车，得到的烦躁值为：$10 + (1 \\times 6^2 + 5 \\times 6 + 10) + (1 \\times (9 - 8)^2 + 5 \\times (9 - 8) + 10)= 102$\n\n第二条路线得到的烦躁值最小为 $94$。\n\n### 数据范围\n\n对于所有测试点：$2\\le n\\le 10^5,1\\le m\\le 2\\times 10^5,0 \\le A \\le 10 , 0 \\le B, C \\le 10^6,1 \\le x_i, y_i \\le n , x_i \\neq y_i , 0 \\le p_i < q_i \\le 10^3$。\n\n每个测试点的具体限制见下表：\n\n::cute-table{tuack}\n\n| 测试点编号  |        $n$         |          $m$          | $A,B,C$ 的特殊限制 | 其他特殊条件 |\n| :---------: | :----------------: | :-------------------: | :----------------: | :----------: |\n|  $1\\sim 2$  |     $\\le 100$      |        $=n-1$         |         无         | $y_i=x_i+1$  |\n|  $3\\sim 4$  |     ^      | $\\le 100$ |     $A=B=C=0$      | ^  |\n|  $5\\sim 8$  | $\\le 2\\times 10^3$ |  $\\le 4\\times 10^3$   |     ^              |  $x_i<y_i$   |\n|     $9$     | ^ |  ^   |      $A=B=0$       |  ^   |\n|    $10$     | ^ |  ^   |       $A=0$        |  ^   |\n| $11\\sim 14$ | ^ |  ^   |         无         |      无      |\n|    $15$     |     $\\le 10^5$     |  $\\le 2\\times 10^5$   |      $A=B=0$       |      ^      |\n| $16\\sim 17$ |     ^     |  ^   |       $A=0$        |      ^      |\n| $18\\sim 20$ |     ^     |  ^   |         无         |      ^      |", "locale": "zh-CN"}}}
{"pid": "P5469", "type": "P", "difficulty": 7, "samples": [["5\n3 3\n3 3\n3 4\n2 2\n3 3", "1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "NOI", "O2优化"], "title": "[NOI2019] 机器人", "background": "时限 3 秒，内存 512MB", "description": "小 R 喜欢研究机器人。\n\n最近，小 R 新研制出了两种机器人，分别是 `P` 型机器人和 `Q` 型机器人。现在他要测试这两种机器人的移动能力，测试在从左到右排成一排的 $n$ 个柱子上进行，柱子用$1 - n$ 依次编号，$i$ 号柱子的高度为一个正整数 $h_i$。机器人**只能在相邻柱子间移动**，即：若机器人当前在 $i$ 号柱子上，它只能尝试移动到 $i - 1$ 号和 $i + 1$ 号柱子上。\n\n每次测试，小 R 会选取一个起点 $s$，并将两种机器人均放置在 $s$ 号柱子上。随后它们会按自己的规则移动。\n\n`P` 型机器人会一直**向左**移动，但它**无法**移动到比起点 $s$ **更高**的柱子上。更具体地，`P` 型机器人在 $l (l \\leq s)$ 号柱子停止移动，**当且仅当**下列两个条件均成立：\n\n- $l = 1$ 或 $h_{l-1} > h_s$。\n\n- 对于满足 $l \\leq j \\leq s$ 的 $j$，有 $h_j \\leq h_s$。\n\n`Q` 型机器人会一直**向右**移动，但它**只能**移动到比起点 $s$ **更低**的柱子上。更具体地，`Q` 型机器人在 $r (r \\geq s)$ 号柱子停止移动，**当且仅当**下列两个条件均成立：\n\n- $r = n$ 或 $h_{r+1} \\geq h_s$。\n\n- 对于满足 $s < j \\leq r$ 的 $j$，有 $h_j < h_s$。\n\n现在，小 R 可以设置每根柱子的高度，$i$ 号柱子可选择的高度范围为 $[A_i, B_i]$，即$A_i \\leq h_i \\leq B_i$。小 R 希望**无论**测试的起点 $s$ 选在哪里，两种机器人移动过的柱子数量的差的绝对值都**小于等于**$2$。他想知道有多少种柱子高度的设置方案满足要求，小 R 认为两种方案不同当且仅当存在一个 $k$，使得两种方案中 $k$ 号柱子的高度不同。请你告诉他满足要求的方案数模 $10^9 + 7$ 后的结果。", "inputFormat": "第一行一个正整数 $n$，表示柱子的数量。\n\n接下来 $n$ 行，第 $i$ 行两个正整数 $A_i, B_i$，分别表示 $i$ 号柱子的最小和最大高度。", "outputFormat": "仅一行一个整数，表示答案模 $10^9 + 7$ 的值。", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 2\n\n见附加文件的 `robot/robot2.in` 与 `robot/robot2.ans`。\n\n#### 样例 3\n\n见附加文件的 `robot/robot3.in` 与 `robot/robot3.ans`。\n\n#### 样例 4\n\n见附加文件的 `robot/robot4.in` 与 `robot/robot4.ans`。\n\n### 样例 1 解释\n\n柱子高度共两种情况：\n\n- 高度为：`3 2 3 2 3`。此时若起点设置在 $5$，`P` 型机器人将停在 $1$ 号柱子，共移动$4$ 个柱子。`Q` 型机器人停在 $5$ 号柱子，共移动 $0$ 个柱子，不符合条件。\n\n- 高度为：`3 2 4 2 3`。此时无论起点选在哪，都满足条件，具体见下表：\n\n::cute-table{tuack}\n\n| 起点编号 | P 型机器人 | Q 型机器人 |\n| :----------: | :----------: | :----------: |\n| $1$ | 停在 $1$ 号柱子，移动过 $0$ 个 | 停在 $2$ 号柱子，移动过 $1$ 个 |\n| $2$ | 停在 $2$ 号柱子，移动过 $0$ 个 | 停在 $2$ 号柱子，移动过 $0$ 个 |\n| $3$ | 停在 $1$ 号柱子，移动过 $2$ 个 |停在 $5$ 号柱子，移动过 $2$ 个  |\n| $4$ | 停在 $4$ 号柱子，移动过 $0$ 个 | 停在 $4$ 号柱子，移动过 $0$ 个 |\n| $5$ |停在 $4$ 号柱子，移动过 $1$ 个  | 停在 $5$ 号柱子，移动过 $0$ 个 |\n\n### 数据范围\n\n对于所有测试数据：$1 \\leq n \\leq 300$ , $1 \\leq A_i \\leq B_i \\leq 10^9$。\n\n每个测试点的具体限制见下表：\n\n::cute-table{tuack}\n\n| 测试点编号 | $n\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: |\n| $1,2$ | $7$ | $A_i=B_i,B_i\\le 7$ |\n| $3,4$ | $7$ | $B_i\\le 7$ |\n| $5,6,7$ | $50$ | $B_i\\le 100$ |\n| $8,9,10$ | $300$ | $B_i\\le 10^4$ |\n| $11,12$ | $50$ | $A_i=1,B_i=10^9$ |\n| $13,14,15$ | $50$ | 无 |\n| $16,17$ | $150$ | ^ |\n| $18,19$ | $200$ | ^ |\n| $20$ | $300$ | ^ |", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2019] Robot.", "background": "Time limit: 3 seconds, memory limit: 512MB.", "description": "Little R likes studying robots.\n\nRecently, Little R developed two new types of robots, `P`-type robots and `Q`-type robots. Now he wants to test their moving abilities. The test is done on $n$ pillars arranged in a line from left to right, numbered $1 - n$ in order. The height of pillar $i$ is a positive integer $h_i$. Robots **can only move between adjacent pillars**, that is: if a robot is currently on pillar $i$, it can only try to move to pillar $i - 1$ and pillar $i + 1$.\n\nIn each test, Little R chooses a starting point $s$ and places both types of robots on pillar $s$. Then they move according to their own rules.\n\nThe `P`-type robot keeps moving **to the left**, but it **cannot** move onto a pillar that is **higher** than the starting pillar $s$. More specifically, the `P`-type robot stops at pillar $l \\ (l \\leq s)$ **if and only if** both of the following conditions hold:\n\n- $l = 1$ or $h_{l-1} > h_s$.\n\n- For every $j$ with $l \\leq j \\leq s$, we have $h_j \\leq h_s$.\n\nThe `Q`-type robot keeps moving **to the right**, but it **can only** move onto pillars that are **lower** than the starting pillar $s$. More specifically, the `Q`-type robot stops at pillar $r \\ (r \\geq s)$ **if and only if** both of the following conditions hold:\n\n- $r = n$ or $h_{r+1} \\geq h_s$.\n\n- For every $j$ with $s < j \\leq r$, we have $h_j < h_s$.\n\nNow, Little R can set the height of each pillar. The selectable height range for pillar $i$ is $[A_i, B_i]$, that is, $A_i \\leq h_i \\leq B_i$. Little R hopes that **no matter** where the test starting point $s$ is chosen, the absolute value of the difference between the numbers of pillars moved over by the two robots is always **less than or equal to** $2$. He wants to know how many height-setting schemes satisfy this requirement. Little R considers two schemes different if and only if there exists some $k$ such that the height of pillar $k$ is different in the two schemes. Please output the number of valid schemes modulo $10^9 + 7$.", "inputFormat": "The first line contains a positive integer $n$, representing the number of pillars.\n\nThe next $n$ lines each contain two positive integers $A_i, B_i$, representing the minimum and maximum height of pillar $i$.", "outputFormat": "Output one line with one integer, the answer modulo $10^9 + 7$.", "hint": "### More Samples\n\nYou can get more samples through the additional files.\n\n#### Sample 2\n\nSee `robot/robot2.in` and `robot/robot2.ans` in the additional files.\n\n#### Sample 3\n\nSee `robot/robot3.in` and `robot/robot3.ans` in the additional files.\n\n#### Sample 4\n\nSee `robot/robot4.in` and `robot/robot4.ans` in the additional files.\n\n### Explanation for Sample 1\n\nThere are two possible pillar height settings:\n\n- Heights: `3 2 3 2 3`. If the starting point is set to $5$, the `P`-type robot will stop at pillar $1$, moving across $4$ pillars. The `Q`-type robot stops at pillar $5$, moving across $0$ pillars. This does not satisfy the condition.\n\n- Heights: `3 2 4 2 3`. In this case, no matter where the starting point is chosen, the condition is satisfied. Details are shown in the table below:\n\n::cute-table{tuack}\n\n| Starting index | P-type robot | Q-type robot |\n| :----------: | :----------: | :----------: |\n| $1$ | Stops at pillar $1$, moves across $0$ | Stops at pillar $2$, moves across $1$ |\n| $2$ | Stops at pillar $2$, moves across $0$ | Stops at pillar $2$, moves across $0$ |\n| $3$ | Stops at pillar $1$, moves across $2$ | Stops at pillar $5$, moves across $2$ |\n| $4$ | Stops at pillar $4$, moves across $0$ | Stops at pillar $4$, moves across $0$ |\n| $5$ | Stops at pillar $4$, moves across $1$ | Stops at pillar $5$, moves across $0$ |\n\n### Constraints\n\nFor all testdata: $1 \\leq n \\leq 300$, $1 \\leq A_i \\leq B_i \\leq 10^9$.\n\nThe detailed limits for each test point are shown in the table below:\n\n::cute-table{tuack}\n\n| Test point ID | $n\\le$ | Special property |\n| :----------: | :----------: | :----------: |\n| $1,2$ | $7$ | $A_i=B_i,B_i\\le 7$ |\n| $3,4$ | $7$ | $B_i\\le 7$ |\n| $5,6,7$ | $50$ | $B_i\\le 100$ |\n| $8,9,10$ | $300$ | $B_i\\le 10^4$ |\n| $11,12$ | $50$ | $A_i=1,B_i=10^9$ |\n| $13,14,15$ | $50$ | None. |\n| $16,17$ | $150$ | ^ |\n| $18,19$ | $200$ | ^ |\n| $20$ | $300$ | ^ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2019] 机器人", "background": "时限 3 秒，内存 512MB", "description": "小 R 喜欢研究机器人。\n\n最近，小 R 新研制出了两种机器人，分别是 `P` 型机器人和 `Q` 型机器人。现在他要测试这两种机器人的移动能力，测试在从左到右排成一排的 $n$ 个柱子上进行，柱子用$1 - n$ 依次编号，$i$ 号柱子的高度为一个正整数 $h_i$。机器人**只能在相邻柱子间移动**，即：若机器人当前在 $i$ 号柱子上，它只能尝试移动到 $i - 1$ 号和 $i + 1$ 号柱子上。\n\n每次测试，小 R 会选取一个起点 $s$，并将两种机器人均放置在 $s$ 号柱子上。随后它们会按自己的规则移动。\n\n`P` 型机器人会一直**向左**移动，但它**无法**移动到比起点 $s$ **更高**的柱子上。更具体地，`P` 型机器人在 $l (l \\leq s)$ 号柱子停止移动，**当且仅当**下列两个条件均成立：\n\n- $l = 1$ 或 $h_{l-1} > h_s$。\n\n- 对于满足 $l \\leq j \\leq s$ 的 $j$，有 $h_j \\leq h_s$。\n\n`Q` 型机器人会一直**向右**移动，但它**只能**移动到比起点 $s$ **更低**的柱子上。更具体地，`Q` 型机器人在 $r (r \\geq s)$ 号柱子停止移动，**当且仅当**下列两个条件均成立：\n\n- $r = n$ 或 $h_{r+1} \\geq h_s$。\n\n- 对于满足 $s < j \\leq r$ 的 $j$，有 $h_j < h_s$。\n\n现在，小 R 可以设置每根柱子的高度，$i$ 号柱子可选择的高度范围为 $[A_i, B_i]$，即$A_i \\leq h_i \\leq B_i$。小 R 希望**无论**测试的起点 $s$ 选在哪里，两种机器人移动过的柱子数量的差的绝对值都**小于等于**$2$。他想知道有多少种柱子高度的设置方案满足要求，小 R 认为两种方案不同当且仅当存在一个 $k$，使得两种方案中 $k$ 号柱子的高度不同。请你告诉他满足要求的方案数模 $10^9 + 7$ 后的结果。", "inputFormat": "第一行一个正整数 $n$，表示柱子的数量。\n\n接下来 $n$ 行，第 $i$ 行两个正整数 $A_i, B_i$，分别表示 $i$ 号柱子的最小和最大高度。", "outputFormat": "仅一行一个整数，表示答案模 $10^9 + 7$ 的值。", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 2\n\n见附加文件的 `robot/robot2.in` 与 `robot/robot2.ans`。\n\n#### 样例 3\n\n见附加文件的 `robot/robot3.in` 与 `robot/robot3.ans`。\n\n#### 样例 4\n\n见附加文件的 `robot/robot4.in` 与 `robot/robot4.ans`。\n\n### 样例 1 解释\n\n柱子高度共两种情况：\n\n- 高度为：`3 2 3 2 3`。此时若起点设置在 $5$，`P` 型机器人将停在 $1$ 号柱子，共移动$4$ 个柱子。`Q` 型机器人停在 $5$ 号柱子，共移动 $0$ 个柱子，不符合条件。\n\n- 高度为：`3 2 4 2 3`。此时无论起点选在哪，都满足条件，具体见下表：\n\n::cute-table{tuack}\n\n| 起点编号 | P 型机器人 | Q 型机器人 |\n| :----------: | :----------: | :----------: |\n| $1$ | 停在 $1$ 号柱子，移动过 $0$ 个 | 停在 $2$ 号柱子，移动过 $1$ 个 |\n| $2$ | 停在 $2$ 号柱子，移动过 $0$ 个 | 停在 $2$ 号柱子，移动过 $0$ 个 |\n| $3$ | 停在 $1$ 号柱子，移动过 $2$ 个 |停在 $5$ 号柱子，移动过 $2$ 个  |\n| $4$ | 停在 $4$ 号柱子，移动过 $0$ 个 | 停在 $4$ 号柱子，移动过 $0$ 个 |\n| $5$ |停在 $4$ 号柱子，移动过 $1$ 个  | 停在 $5$ 号柱子，移动过 $0$ 个 |\n\n### 数据范围\n\n对于所有测试数据：$1 \\leq n \\leq 300$ , $1 \\leq A_i \\leq B_i \\leq 10^9$。\n\n每个测试点的具体限制见下表：\n\n::cute-table{tuack}\n\n| 测试点编号 | $n\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: |\n| $1,2$ | $7$ | $A_i=B_i,B_i\\le 7$ |\n| $3,4$ | $7$ | $B_i\\le 7$ |\n| $5,6,7$ | $50$ | $B_i\\le 100$ |\n| $8,9,10$ | $300$ | $B_i\\le 10^4$ |\n| $11,12$ | $50$ | $A_i=1,B_i=10^9$ |\n| $13,14,15$ | $50$ | 无 |\n| $16,17$ | $150$ | ^ |\n| $18,19$ | $200$ | ^ |\n| $20$ | $300$ | ^ |", "locale": "zh-CN"}}}
{"pid": "P5470", "type": "P", "difficulty": 7, "samples": [["5\n1 1 1\n7\n7\n3 2 1\n4 1 2\n1 4 2\n5 2 1\n4 5 5 8 4\n2 1 7 2 7\n6 4 1\n1 5 8 3 2 4\n2 6 9 3 1 7\n7 5 4\n1 6 6 6 5 9 1\n9 5 3 9 1 4 2", "14\n12\n27\n45\n62\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2019", "NOI", "O2优化", "优先队列", "模拟费用流", "反悔贪心"], "title": "[NOI2019] 序列", "background": "", "description": "给定两个长度为 $n$ 的正整数序列 $\\{a_i\\}$ 与 $\\{b_i\\}$，序列的下标为 $1, 2, \\cdots , n$。现在你需要分别对两个序列各指定**恰好** $K$ 个下标，要求**至少**有 $L$ 个下标在两个序列中都被指定，使得这 $2K$ 个下标在序列中对应的元素的总和**最大**。\n\n形式化地说，你需要确定两个长度为 $K$ 的序列 $\\{c_i\\}, \\{d_i\\}$，其中\n$1 \\leq c_1 < c_2 < \\cdots < c_K \\leq n , 1 \\leq d_1 < d_2 < \\cdots < d_K \\leq n$\n\n并要求 $\\left \\lvert \\{c_1, c_2, \\cdots , c_K\\} \\cap \\{d_1, d_2, · · · , d_K\\} \\right \\rvert \\geq L$\n\n目标是最大化 $\\sum^{K}_{i=1} a_{c_i} +\\sum^{K}_{i=1} b_{d_i}$", "inputFormat": "**本题输入文件包含多组数据**。\n\n第一行一个正整数 $T$ 表示数据组数。接下来每三行表示一组数据。\n\n每组数据第一行三个整数 $n, K, L$，变量意义见题目描述。\n\n每组数据第二行 $n$ 个整数表示序列 $\\{a_i\\}$。\n\n每组数据第三行 $n$ 个整数表示序列 $\\{b_i\\}$。", "outputFormat": "对于每组数据输出一行一个整数表示答案。", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 2\n\n见选手目录下的 `sequence/sequence2.in` 与 `sequence/sequence2.ans`。\n\n#### 样例 3\n\n见选手目录下的 `sequence/sequence3.in` 与 `sequence/sequence3.ans`。\n\n### 样例 1 解释\n\n第一组数据选择的下标为：$\\{c_i\\} = \\{1\\} , \\{d_i\\} = \\{1\\}$。\n\n第二组数据选择的下标为：$\\{c_i\\} = \\{1, 3\\} , \\{d_i\\} = \\{2, 3\\}$\n\n第三组数据选择的下标为：$\\{c_i\\} = \\{3, 4\\} , \\{d_i\\} = \\{3, 5\\}$。\n\n第四组数据选择的下标为：$\\{c_i\\} = \\{2, 3, 4, 6\\} , \\{d_i\\} = \\{2, 3, 4, 6\\}$。\n\n第五组数据选择的下标为：$\\{c_i\\} = \\{2, 3, 4, 5, 6\\} , \\{d_i\\} = \\{1, 2, 3, 4, 6\\}$。\n\n### 数据范围\n\n对于所有测试点：$T \\leq 10 , 1 \\leq \\sum n \\leq 10^6, 1 \\leq L \\leq K \\leq n \\leq 2 \\times 10^5, 1 \\leq a_i, b_i \\leq 10^9$。\n\n::cute-table{tuack}\n\n| 测试点编号 | $n\\le$ | $\\sum n \\le$ |\n| :----------: | :----------: | :----------: |\n| $1\\sim3$ | $10$ | $3\\times 10^5$ |\n| $4\\sim5$ | $18$ | ^ |\n| $6\\sim7$ | $30$ | ^ |\n| $8\\sim10$ | $150$ | ^ |\n| $11\\sim16$ | $2\\times 10^3$ | ^ |\n| $17\\sim21$ | $2\\times 10^5$ | ^ |\n| $22\\sim25$ | ^ | $10^6$ |", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2019] Sequence", "background": "", "description": "Given two positive integer sequences $\\{a_i\\}$ and $\\{b_i\\}$ of length $n$, where the indices are $1, 2, \\cdots , n$. You now need to choose **exactly** $K$ indices for each sequence, requiring that **at least** $L$ indices are chosen in both sequences, so that the total sum of the corresponding elements of these $2K$ indices is **maximized**.\n\nFormally, you need to determine two sequences $\\{c_i\\}$ and $\\{d_i\\}$ of length $K$, where\n$1 \\leq c_1 < c_2 < \\cdots < c_K \\leq n , 1 \\leq d_1 < d_2 < \\cdots < d_K \\leq n$\n\nand require that $\\left \\lvert \\{c_1, c_2, \\cdots , c_K\\} \\cap \\{d_1, d_2, · · · , d_K\\} \\right \\rvert \\geq L$.\n\nThe goal is to maximize $\\sum^{K}_{i=1} a_{c_i} +\\sum^{K}_{i=1} b_{d_i}$.", "inputFormat": "**This input file contains multiple test cases**.\n\nThe first line contains a positive integer $T$ indicating the number of test cases. Then every three lines describe one test case.\n\nFor each test case, the first line contains three integers $n, K, L$, with meanings as described in the statement.\n\nFor each test case, the second line contains $n$ integers representing the sequence $\\{a_i\\}$.\n\nFor each test case, the third line contains $n$ integers representing the sequence $\\{b_i\\}$.", "outputFormat": "For each test case, output one line containing one integer, the answer.", "hint": "### More Samples\n\nYou can get more samples from the additional files.\n\n#### Sample 2\n\nSee `sequence/sequence2.in` and `sequence/sequence2.ans` in the contestant directory.\n\n#### Sample 3\n\nSee `sequence/sequence3.in` and `sequence/sequence3.ans` in the contestant directory.\n\n### Explanation for Sample 1\n\nIn the first test case, the chosen indices are: $\\{c_i\\} = \\{1\\} , \\{d_i\\} = \\{1\\}$.\n\nIn the second test case, the chosen indices are: $\\{c_i\\} = \\{1, 3\\} , \\{d_i\\} = \\{2, 3\\}$.\n\nIn the third test case, the chosen indices are: $\\{c_i\\} = \\{3, 4\\} , \\{d_i\\} = \\{3, 5\\}$.\n\nIn the fourth test case, the chosen indices are: $\\{c_i\\} = \\{2, 3, 4, 6\\} , \\{d_i\\} = \\{2, 3, 4, 6\\}$.\n\nIn the fifth test case, the chosen indices are: $\\{c_i\\} = \\{2, 3, 4, 5, 6\\} , \\{d_i\\} = \\{1, 2, 3, 4, 6\\}$.\n\n### Constraints\n\nFor all test points: $T \\leq 10 , 1 \\leq \\sum n \\leq 10^6, 1 \\leq L \\leq K \\leq n \\leq 2 \\times 10^5, 1 \\leq a_i, b_i \\leq 10^9$.\n\n::cute-table{tuack}\n\n| Test Point ID | $n\\le$ | $\\sum n \\le$ |\n| :----------: | :----------: | :----------: |\n| $1\\sim3$ | $10$ | $3\\times 10^5$ |\n| $4\\sim5$ | $18$ | ^ |\n| $6\\sim7$ | $30$ | ^ |\n| $8\\sim10$ | $150$ | ^ |\n| $11\\sim16$ | $2\\times 10^3$ | ^ |\n| $17\\sim21$ | $2\\times 10^5$ | ^ |\n| $22\\sim25$ | ^ | $10^6$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2019] 序列", "background": "", "description": "给定两个长度为 $n$ 的正整数序列 $\\{a_i\\}$ 与 $\\{b_i\\}$，序列的下标为 $1, 2, \\cdots , n$。现在你需要分别对两个序列各指定**恰好** $K$ 个下标，要求**至少**有 $L$ 个下标在两个序列中都被指定，使得这 $2K$ 个下标在序列中对应的元素的总和**最大**。\n\n形式化地说，你需要确定两个长度为 $K$ 的序列 $\\{c_i\\}, \\{d_i\\}$，其中\n$1 \\leq c_1 < c_2 < \\cdots < c_K \\leq n , 1 \\leq d_1 < d_2 < \\cdots < d_K \\leq n$\n\n并要求 $\\left \\lvert \\{c_1, c_2, \\cdots , c_K\\} \\cap \\{d_1, d_2, · · · , d_K\\} \\right \\rvert \\geq L$\n\n目标是最大化 $\\sum^{K}_{i=1} a_{c_i} +\\sum^{K}_{i=1} b_{d_i}$", "inputFormat": "**本题输入文件包含多组数据**。\n\n第一行一个正整数 $T$ 表示数据组数。接下来每三行表示一组数据。\n\n每组数据第一行三个整数 $n, K, L$，变量意义见题目描述。\n\n每组数据第二行 $n$ 个整数表示序列 $\\{a_i\\}$。\n\n每组数据第三行 $n$ 个整数表示序列 $\\{b_i\\}$。", "outputFormat": "对于每组数据输出一行一个整数表示答案。", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 2\n\n见选手目录下的 `sequence/sequence2.in` 与 `sequence/sequence2.ans`。\n\n#### 样例 3\n\n见选手目录下的 `sequence/sequence3.in` 与 `sequence/sequence3.ans`。\n\n### 样例 1 解释\n\n第一组数据选择的下标为：$\\{c_i\\} = \\{1\\} , \\{d_i\\} = \\{1\\}$。\n\n第二组数据选择的下标为：$\\{c_i\\} = \\{1, 3\\} , \\{d_i\\} = \\{2, 3\\}$\n\n第三组数据选择的下标为：$\\{c_i\\} = \\{3, 4\\} , \\{d_i\\} = \\{3, 5\\}$。\n\n第四组数据选择的下标为：$\\{c_i\\} = \\{2, 3, 4, 6\\} , \\{d_i\\} = \\{2, 3, 4, 6\\}$。\n\n第五组数据选择的下标为：$\\{c_i\\} = \\{2, 3, 4, 5, 6\\} , \\{d_i\\} = \\{1, 2, 3, 4, 6\\}$。\n\n### 数据范围\n\n对于所有测试点：$T \\leq 10 , 1 \\leq \\sum n \\leq 10^6, 1 \\leq L \\leq K \\leq n \\leq 2 \\times 10^5, 1 \\leq a_i, b_i \\leq 10^9$。\n\n::cute-table{tuack}\n\n| 测试点编号 | $n\\le$ | $\\sum n \\le$ |\n| :----------: | :----------: | :----------: |\n| $1\\sim3$ | $10$ | $3\\times 10^5$ |\n| $4\\sim5$ | $18$ | ^ |\n| $6\\sim7$ | $30$ | ^ |\n| $8\\sim10$ | $150$ | ^ |\n| $11\\sim16$ | $2\\times 10^3$ | ^ |\n| $17\\sim21$ | $2\\times 10^5$ | ^ |\n| $22\\sim25$ | ^ | $10^6$ |", "locale": "zh-CN"}}}
{"pid": "P5471", "type": "P", "difficulty": 6, "samples": [["5 3 5 5\n1 1\n3 1\n4 1\n2 2\n3 3\n1 123 1 5 1 5\n1 50 1 5 1 1\n3 10 2 2 2 2", "50\n50\n60\n123\n"]], "limits": {"time": [2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200, 2200], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "NOI", "O2优化", "图论建模", "最短路"], "title": "[NOI2019] 弹跳", "background": "原题时限 2s\n\n内存 128MB", "description": "跳蚤国有 $n$ 座城市，分别编号为 $1 - n$，$1$ 号城市为首都。所有城市分布在一个$w \\times h$ 范围的网格上。每座城市都有一个整数坐标 $(x, y) (1 \\leq x \\leq w, 1 \\leq y \\leq h)$，不同城市的坐标不相同。\n\n在跳蚤国中共有 $m$ 个弹跳装置，分别编号为 $1 - m$，其中 $i$ 号弹跳装置位于 $p_i$ 号城市，并具有参数 $t_i, L_i, R_i, D_i, U_i$。利用该弹跳装置，跳蚤可花费 $t_i (t_i > 0)$ 个单位时间，从 $p_i$ 号城市跳至坐标满足 $L_i \\leq x \\leq R_i, D_i \\leq y \\leq U_i (1 \\leq L_i \\leq R_i \\leq w, 1 \\leq D_i \\leq U_i \\leq h)$ 的任意一座城市。需要注意的是，一座城市中可能存在多个弹跳装置，也可能没有弹跳装置。\n\n由于城市间距离较远，跳蚤们必须依靠弹跳装置出行。具体来说，一次出行将经过\n若干座城市，依次经过的城市的编号可用序列 $a_0, a_1, \\cdots , a_k$ 表示；在此次出行中，依次利用的弹跳装置的编号可用序列 $b_1, b_2, \\cdots , b_k$ 表示。其中每座城市可在序列 $\\{a_j\\}$ 中出现任意次，每个弹跳装置也可在序列 $\\{b_j\\}$ 中出现任意次，且满足，对于每个 $j (1 \\leq j \\leq k)$，编号为 $b_j$ 的弹跳装置位于城市 $a_{j-1}$，且跳蚤能通过该弹跳装置跳至城市 $a_j$。我们称这是一次从城市 $a_0$ 到城市 $a_k$ 的出行，其进行了 $k$ 次弹跳，共花费 $\\sum^k_{i=1} t_{b_{i}}$ 个单位时间。\n\n现在跳蚤国王想知道，对于跳蚤国除首都（$1$ 号城市）外的每座城市，从首都出发，到达该城市最少需要花费的单位时间。跳蚤国王保证，对每座城市，均存在从首都到它的出行方案。\n", "inputFormat": "第一行包含四个整数 $n, m,w, h$，变量的具体意义见题目描述。\n\n接下来 $n$ 行，第 $i$ 行包含两个整数 $x_i, y_i$，表示 $i$ 号城市的坐标。\n\n接下来 $m$ 行，第 $i$ 行包含六个整数 $p_i, t_i, L_i, R_i, D_i, U_i$，分别表示 $i$ 号弹跳装置所在的城市编号、弹跳所需的时间、可到达的矩形范围。这些整数的具体意义见题目描述。", "outputFormat": "输出 $n - 1$ 行，第 $i$ 行包含一个整数，表示从跳蚤国首都到 $i + 1$ 号城市最少需要花费的单位时间。\n", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 2\n\n见附加文件中的 `jump/jump2.in` 与 `jump/jump2.ans`。\n\n这组样例的数据范围为 $n = 10^4 , m = 2\\times 10^4 , w = 10^4 , h = 1$。\n\n#### 样例 3\n\n见附加文件中的 `jump/jump3.in` 与 `jump/jump3.ans`。\n\n这组样例的数据范围为 $n = 10^4 , m = 2\\times 10^4 , w = 10^4 , h = 10^4$。\n\n### 数据范围\n\n对于所有测试点和样例满足：\n\n$1 \\leq n \\leq 70000 , 1 \\leq m \\leq 150000 , 1 \\leq w, h \\leq n , 1 \\leq t_i \\leq 10000$。\n\n每个测试点的具体限制见下表。\n\n| 测试点编号 | $1\\le n\\le$ | $1\\le m\\le$ | 特殊限制 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1\\sim8$ | $100$ | $100$ | 无 |\n| $9\\sim13$ | $5\\times 10^4$ | $10^5$ | 每个弹跳装置恰好可达一座城市，且 $L_i=R_i$，$D_i=U_i$ |\n| $14\\sim18$ | $5\\times 10^4$ | $10^5$ | $h=1$ | \n| $19\\sim22$ | $2.5\\times 10^4$ | $5\\times 10^4$ | 无 | \n| $23\\sim25$ | $7\\times 10^4$ | $1.5\\times 10^5$ | 无 | ", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2019] Jumping", "background": "The original time limit is 2 s.\n\nThe memory limit is 128 MB.", "description": "There are $n$ cities in Flea Kingdom, numbered from $1$ to $n$, and city $1$ is the capital. All cities are located on a grid within a $w \\times h$ area. Each city has integer coordinates $(x, y) (1 \\leq x \\leq w, 1 \\leq y \\leq h)$, and no two cities share the same coordinates.\n\nThere are $m$ jumping devices in Flea Kingdom, numbered from $1$ to $m$. Device $i$ is located in city $p_i$ and has parameters $t_i, L_i, R_i, D_i, U_i$. By using this device, a flea can spend $t_i (t_i > 0)$ units of time to jump from city $p_i$ to any city whose coordinates satisfy $L_i \\leq x \\leq R_i, D_i \\leq y \\leq U_i (1 \\leq L_i \\leq R_i \\leq w, 1 \\leq D_i \\leq U_i \\leq h)$. Note that a city may have multiple jumping devices, or none.\n\nBecause cities are far apart, fleas must rely on jumping devices to travel. Specifically, a trip will pass through several cities; the city numbers in order can be written as a sequence $a_0, a_1, \\cdots , a_k$. The jumping device numbers used in order can be written as a sequence $b_1, b_2, \\cdots , b_k$. Each city may appear in the sequence $\\{a_j\\}$ any number of times, and each jumping device may appear in the sequence $\\{b_j\\}$ any number of times. For each $j (1 \\leq j \\leq k)$, device $b_j$ is located in city $a_{j-1}$, and the flea can use this device to jump to city $a_j$. We call this a trip from city $a_0$ to city $a_k$. It makes $k$ jumps in total, and costs $\\sum^k_{i=1} t_{b_{i}}$ units of time.\n\nNow the flea king wants to know, for every city other than the capital (city $1$), the minimum number of time units needed to start from the capital and reach that city. The king guarantees that for every city, there exists at least one trip from the capital to it.", "inputFormat": "The first line contains four integers $n, m, w, h$. The meanings of the variables are described in the statement.\n\nThe next $n$ lines: line $i$ contains two integers $x_i, y_i$, indicating the coordinates of city $i$.\n\nThe next $m$ lines: line $i$ contains six integers $p_i, t_i, L_i, R_i, D_i, U_i$, indicating the city where device $i$ is located, the time needed for the jump, and the reachable rectangular region. The meanings of these integers are described in the statement.", "outputFormat": "Output $n - 1$ lines. Line $i$ contains one integer, representing the minimum number of time units needed to travel from the capital of Flea Kingdom to city $i + 1$.", "hint": "### More Samples\n\nYou can obtain more samples through the additional files.\n\n#### Sample 2\n\nSee `jump/jump2.in` and `jump/jump2.ans` in the additional files.\n\nThe Constraints for this sample are $n = 10^4 , m = 2\\times 10^4 , w = 10^4 , h = 1$.\n\n#### Sample 3\n\nSee `jump/jump3.in` and `jump/jump3.ans` in the additional files.\n\nThe Constraints for this sample are $n = 10^4 , m = 2\\times 10^4 , w = 10^4 , h = 10^4$.\n\n### Constraints\n\nFor all test points and samples:\n\n$1 \\leq n \\leq 70000 , 1 \\leq m \\leq 150000 , 1 \\leq w, h \\leq n , 1 \\leq t_i \\leq 10000$.\n\nThe detailed limits for each test point are shown in the table below.\n\n| Test Point ID | $1\\le n\\le$ | $1\\le m\\le$ | Special Constraints |\n| :----------: | :----------: | :----------: | :----------: |\n| $1\\sim8$ | $100$ | $100$ | None |\n| $9\\sim13$ | $5\\times 10^4$ | $10^5$ | Each jumping device can reach exactly one city, and $L_i=R_i$, $D_i=U_i$ |\n| $14\\sim18$ | $5\\times 10^4$ | $10^5$ | $h=1$ | \n| $19\\sim22$ | $2.5\\times 10^4$ | $5\\times 10^4$ | None | \n| $23\\sim25$ | $7\\times 10^4$ | $1.5\\times 10^5$ | None |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2019] 弹跳", "background": "原题时限 2s\n\n内存 128MB", "description": "跳蚤国有 $n$ 座城市，分别编号为 $1 - n$，$1$ 号城市为首都。所有城市分布在一个$w \\times h$ 范围的网格上。每座城市都有一个整数坐标 $(x, y) (1 \\leq x \\leq w, 1 \\leq y \\leq h)$，不同城市的坐标不相同。\n\n在跳蚤国中共有 $m$ 个弹跳装置，分别编号为 $1 - m$，其中 $i$ 号弹跳装置位于 $p_i$ 号城市，并具有参数 $t_i, L_i, R_i, D_i, U_i$。利用该弹跳装置，跳蚤可花费 $t_i (t_i > 0)$ 个单位时间，从 $p_i$ 号城市跳至坐标满足 $L_i \\leq x \\leq R_i, D_i \\leq y \\leq U_i (1 \\leq L_i \\leq R_i \\leq w, 1 \\leq D_i \\leq U_i \\leq h)$ 的任意一座城市。需要注意的是，一座城市中可能存在多个弹跳装置，也可能没有弹跳装置。\n\n由于城市间距离较远，跳蚤们必须依靠弹跳装置出行。具体来说，一次出行将经过\n若干座城市，依次经过的城市的编号可用序列 $a_0, a_1, \\cdots , a_k$ 表示；在此次出行中，依次利用的弹跳装置的编号可用序列 $b_1, b_2, \\cdots , b_k$ 表示。其中每座城市可在序列 $\\{a_j\\}$ 中出现任意次，每个弹跳装置也可在序列 $\\{b_j\\}$ 中出现任意次，且满足，对于每个 $j (1 \\leq j \\leq k)$，编号为 $b_j$ 的弹跳装置位于城市 $a_{j-1}$，且跳蚤能通过该弹跳装置跳至城市 $a_j$。我们称这是一次从城市 $a_0$ 到城市 $a_k$ 的出行，其进行了 $k$ 次弹跳，共花费 $\\sum^k_{i=1} t_{b_{i}}$ 个单位时间。\n\n现在跳蚤国王想知道，对于跳蚤国除首都（$1$ 号城市）外的每座城市，从首都出发，到达该城市最少需要花费的单位时间。跳蚤国王保证，对每座城市，均存在从首都到它的出行方案。\n", "inputFormat": "第一行包含四个整数 $n, m,w, h$，变量的具体意义见题目描述。\n\n接下来 $n$ 行，第 $i$ 行包含两个整数 $x_i, y_i$，表示 $i$ 号城市的坐标。\n\n接下来 $m$ 行，第 $i$ 行包含六个整数 $p_i, t_i, L_i, R_i, D_i, U_i$，分别表示 $i$ 号弹跳装置所在的城市编号、弹跳所需的时间、可到达的矩形范围。这些整数的具体意义见题目描述。", "outputFormat": "输出 $n - 1$ 行，第 $i$ 行包含一个整数，表示从跳蚤国首都到 $i + 1$ 号城市最少需要花费的单位时间。\n", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 2\n\n见附加文件中的 `jump/jump2.in` 与 `jump/jump2.ans`。\n\n这组样例的数据范围为 $n = 10^4 , m = 2\\times 10^4 , w = 10^4 , h = 1$。\n\n#### 样例 3\n\n见附加文件中的 `jump/jump3.in` 与 `jump/jump3.ans`。\n\n这组样例的数据范围为 $n = 10^4 , m = 2\\times 10^4 , w = 10^4 , h = 10^4$。\n\n### 数据范围\n\n对于所有测试点和样例满足：\n\n$1 \\leq n \\leq 70000 , 1 \\leq m \\leq 150000 , 1 \\leq w, h \\leq n , 1 \\leq t_i \\leq 10000$。\n\n每个测试点的具体限制见下表。\n\n| 测试点编号 | $1\\le n\\le$ | $1\\le m\\le$ | 特殊限制 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1\\sim8$ | $100$ | $100$ | 无 |\n| $9\\sim13$ | $5\\times 10^4$ | $10^5$ | 每个弹跳装置恰好可达一座城市，且 $L_i=R_i$，$D_i=U_i$ |\n| $14\\sim18$ | $5\\times 10^4$ | $10^5$ | $h=1$ | \n| $19\\sim22$ | $2.5\\times 10^4$ | $5\\times 10^4$ | 无 | \n| $23\\sim25$ | $7\\times 10^4$ | $1.5\\times 10^5$ | 无 | ", "locale": "zh-CN"}}}
{"pid": "P5472", "type": "P", "difficulty": 7, "samples": [["4 1 1\n3\n1\n1", "249561090\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "NOI", "O2优化"], "title": "[NOI2019] 斗主地", "background": "时限 4 秒 内存 512MB", "description": "小 S 在和小 F 玩一个叫“斗地主”的游戏。\n\n可怜的小 S 发现自己打牌并打不过小 F，所以他想要在洗牌环节动动手脚。\n\n一副牌一共有 $n$ 张牌，从上到下依次标号为 $1 \\sim n$。标号为 $i$ 的牌**分数**是 $f(i)$。在本题，$f(i)$ 有且仅有两种可能：$f(i) = i$ 或 $f(i) = i^2$。\n\n洗牌的方式和我们日常生活中的比较类似，以下我们用形式化的语言来定义： 洗牌环节一共分 $m$ 轮，这 $m$ 轮洗牌依次进行。第 $i$ 轮洗牌时：\n\n1. 小 S 会拿出从最上面往下数的前 $A_i$ 张牌。这样这副牌就被分成了两堆：第一堆 是最上面的 $A_i$ 张牌，第二堆是剩下的 $n-A_i$ 张牌，且这两堆牌内相对顺序不变。 特别地，当$A_i = n$ 或 $A_i = 0$ 时，有一堆牌是空的。\n2. 接下来对两堆牌进行合并，从而产生新的第三堆牌。当第一堆牌还剩下 $X$ 张，第二堆牌还剩下 $Y$ 张的时候，以 $\\dfrac{X}{X+Y}$ 的概率取出第一堆牌的最下面的牌，并将它 放入新的第三堆牌的最上面， $\\dfrac{Y}{X+Y}$  的概率取出第二堆牌的最下面的牌，并将它放入新的第三堆牌的最上面\n3. 重复操作 $2$，一直取到两堆牌都为空为止。这样我们就完成了一轮洗牌。\n\n因为洗牌过程是随机的，所以小 S 发现自己没法知道某个位置上具体是哪张牌。但小 S 想问你在经历了这 $m$ 轮洗牌后，某个位置上的牌的**期望分数**是多少。小 S 一共会问你 $Q$ 个这样的问题。", "inputFormat": "输入的第一行包含三个正整数 $n, m, type$，分别表示牌的数量，洗牌的轮数与 $f(i)$ 的类型。当 $type = 1$ 时，$f(i) = i$。当 $type = 2$ 时，$f(i) = i^2$。\n\n接下来一行，一共 $m$ 个整数，表示 $A_1 \\sim A_m$。\n\n接下来一行一个正整数 $Q$，表示小 S 的询问个数。 接下来 $Q$ 行，每行一个正整数 $c_i$，表示小 S 想要知道从上往下第 $c_i$ 个位置上的牌的**期望分数**。\n\n保证 $1 \\leq c_i \\leq n$。", "outputFormat": "输出一共 $Q$ 行，每行一个整数，表示答案在模 $998244353$ 意义下的取值。\n\n\n即设答案化为最简分式后的形式为 $\\dfrac{a}\n{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx \\equiv a \\pmod{998244353}$ 且 $0 ≤ x < 998244353$。可以证明这样的整数 $x$ 是唯一的。", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 2\n\n见附加文件中的 `landlords/landlords2.in` 与 `landlords/landlords2.ans`。\n\n#### 样例 3\n\n见附加文件中的 `landlords/landlords3.in` 与 `landlords/landlords3.ans`。\n\n### 样例输入输出 1 解释\n\n- 有 $\\dfrac{1}{4}$ 的概率从上到下的最终结果是 $\\{1, 2, 3, 4\\}$。\n- 有 $\\dfrac{1}{4}$ 的概率从上到下的最终结果是 $\\{1, 2, 4, 3\\}$。\n- 有 $\\dfrac{1}{4}$ 的概率从上到下的最终结果是 $\\{1, 4, 2, 3\\}$。\n- 有 $\\dfrac{1}{4}$ 的概率从上到下的最终结果是 $\\{4, 1, 2, 3\\}$。\n\n所以最终有 $\\dfrac{1}{4}$ 的概率第一个位置是 $4$，有 $\\dfrac{3}\n{4}$ 的概率第一个位置是 $1$，所以第一个位置的期望分数是 $\\dfrac{7}{\n4}$。\n\n为了帮助你们更直观地了解洗牌的过程，我们在下面画出了结果是 $\\{1, 4, 2, 3\\}$ 的过程。\n\n![](https://cdn.luogu.com.cn/upload/pic/64318.png)\n\n### 数据规模与约定\n\n对于全部的测试点，保证 $3\\le n \\le 10^7$，$1\\le m,Q\\le5\\times 10^5$，$0\\le A_i\\le n$，$type\\in \\{1,2\\}$。\n\n每个测试点的具体限制见下表：\n\n| 测试点 | $n$ | $m$ | $type=$ | 其他性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 10$ | $\\le 1$ | $1$ | 无 |\n| $2$ | $\\le 80$ | $\\le 80$ | $1$ | 无 |\n| $3$ | $\\le 80$ | $\\le 80$ | $2$ | 无 |\n| $4$ | $\\le 100$ | $\\le 5\\times 10^5$ | $2$ | 所有 $A_i$ 相同 |\n| $5$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | 无 |\n| $6$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | 无 |\n| $7$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | 无 |\n| $8$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$ |无  |\n| $9$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$ | 无 |\n| $10$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$  | 无 |\n\n请注意我们并没有保证 $Q\\le n$。\n\n### 提示\n\n这里我们给出离散型随机变量 $X$ 的期望 $\\mathbb{E}[x]$ 的定义：\n\n设离散随机变量 $X$ 的可能值是 $X_1,X_2,\\ldots X_k$，$Pr[X_1],Pr[X_2],\\ldots,Pr[X_k]$ 为 $X$ 取对应值的概率，则 $X$ 的期望为：\n$$\\mathbb{E}[x]=\\sum^k_{i=1}X_i\\times Pr[X_i]$$\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2019] Douzhu Di", "background": "Time limit: 4 seconds. Memory limit: 512MB.", "description": "Xiao S is playing a game called “Dou Dizhu” with Xiao F.\n\nPoor Xiao S finds that he cannot beat Xiao F at playing cards, so he wants to do something during the shuffling stage.\n\nA deck has $n$ cards, numbered from top to bottom as $1 \\sim n$. The **score** of the card numbered $i$ is $f(i)$. In this problem, $f(i)$ has exactly two possibilities: $f(i) = i$ or $f(i) = i^2$.\n\nThe shuffling method is similar to what we do in daily life. We define it formally as follows: the shuffling stage consists of $m$ rounds, performed in order. In round $i$:\n\n1. Xiao S takes the top $A_i$ cards from the deck. Then the deck is split into two piles: the first pile is the top $A_i$ cards, and the second pile is the remaining $n-A_i$ cards, and the relative order within each pile remains unchanged. In particular, when $A_i = n$ or $A_i = 0$, one pile is empty.\n2. Next, merge the two piles to produce a new third pile. When the first pile has $X$ cards left and the second pile has $Y$ cards left, with probability $\\dfrac{X}{X+Y}$ take the bottom card of the first pile and put it on the top of the new third pile; with probability $\\dfrac{Y}{X+Y}$ take the bottom card of the second pile and put it on the top of the new third pile.\n3. Repeat step $2$ until both piles are empty. This completes one round of shuffling.\n\nBecause the shuffling process is random, Xiao S cannot know exactly which card is at a certain position. But after these $m$ rounds of shuffling, Xiao S wants to ask what the **expected score** of the card at a certain position is. Xiao S will ask you $Q$ such questions.", "inputFormat": "The first line contains three positive integers $n, m, type$, representing the number of cards, the number of shuffling rounds, and the type of $f(i)$. When $type = 1$, $f(i) = i$. When $type = 2$, $f(i) = i^2$.\n\nThe next line contains $m$ integers, representing $A_1 \\sim A_m$.\n\nThe next line contains a positive integer $Q$, the number of queries from Xiao S. The next $Q$ lines each contain a positive integer $c_i$, meaning Xiao S wants to know the **expected score** of the card at the $c_i$-th position from top to bottom.\n\nIt is guaranteed that $1 \\leq c_i \\leq n$.", "outputFormat": "Output $Q$ lines. Each line contains one integer, which is the answer modulo $998244353$.\n\nThat is, suppose the answer in lowest terms is $\\dfrac{a}{b}$, where $a$ and $b$ are coprime. Output an integer $x$ such that $bx \\equiv a \\pmod{998244353}$ and $0 \\le x < 998244353$. It can be proven that such an integer $x$ is unique.", "hint": "### More Samples\n\nYou can obtain more samples through the additional files.\n\n#### Sample 2\n\nSee `landlords/landlords2.in` and `landlords/landlords2.ans` in the additional files.\n\n#### Sample 3\n\nSee `landlords/landlords3.in` and `landlords/landlords3.ans` in the additional files.\n\n### Explanation for Sample Input/Output 1\n\n- With probability $\\dfrac{1}{4}$, the final result from top to bottom is $\\{1, 2, 3, 4\\}$.\n- With probability $\\dfrac{1}{4}$, the final result from top to bottom is $\\{1, 2, 4, 3\\}$.\n- With probability $\\dfrac{1}{4}$, the final result from top to bottom is $\\{1, 4, 2, 3\\}$.\n- With probability $\\dfrac{1}{4}$, the final result from top to bottom is $\\{4, 1, 2, 3\\}$.\n\nSo in the end, with probability $\\dfrac{1}{4}$ the first position is $4$, and with probability $\\dfrac{3}{4}$ the first position is $1$. Therefore, the expected score of the first position is $\\dfrac{7}{4}$.\n\nTo help you understand the shuffling process more intuitively, we draw below the process where the result is $\\{1, 4, 2, 3\\}$.\n\n![](https://cdn.luogu.com.cn/upload/pic/64318.png)\n\n### Constraints and Notes\n\nFor all test points, it is guaranteed that $3\\le n \\le 10^7$, $1\\le m,Q\\le5\\times 10^5$, $0\\le A_i\\le n$, $type\\in \\{1,2\\}$.\n\nThe specific limits for each test point are shown in the table below:\n\n| Test Point | $n$ | $m$ | $type=$ | Other Properties |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 10$ | $\\le 1$ | $1$ | None |\n| $2$ | $\\le 80$ | $\\le 80$ | $1$ | None |\n| $3$ | $\\le 80$ | $\\le 80$ | $2$ | None |\n| $4$ | $\\le 100$ | $\\le 5\\times 10^5$ | $2$ | All $A_i$ are the same |\n| $5$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | None |\n| $6$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | None |\n| $7$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | None |\n| $8$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$ | None |\n| $9$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$ | None |\n| $10$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$ | None |\n\nPlease note that we do not guarantee $Q\\le n$.\n\n### Hint\n\nHere we give the definition of the expectation $\\mathbb{E}[x]$ of a discrete random variable $X$:\n\nSuppose the possible values of $X$ are $X_1,X_2,\\ldots X_k$, and $Pr[X_1],Pr[X_2],\\ldots,Pr[X_k]$ are the probabilities that $X$ takes the corresponding values. Then the expectation of $X$ is:\n$$\\mathbb{E}[x]=\\sum^k_{i=1}X_i\\times Pr[X_i]$$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2019] 斗主地", "background": "时限 4 秒 内存 512MB", "description": "小 S 在和小 F 玩一个叫“斗地主”的游戏。\n\n可怜的小 S 发现自己打牌并打不过小 F，所以他想要在洗牌环节动动手脚。\n\n一副牌一共有 $n$ 张牌，从上到下依次标号为 $1 \\sim n$。标号为 $i$ 的牌**分数**是 $f(i)$。在本题，$f(i)$ 有且仅有两种可能：$f(i) = i$ 或 $f(i) = i^2$。\n\n洗牌的方式和我们日常生活中的比较类似，以下我们用形式化的语言来定义： 洗牌环节一共分 $m$ 轮，这 $m$ 轮洗牌依次进行。第 $i$ 轮洗牌时：\n\n1. 小 S 会拿出从最上面往下数的前 $A_i$ 张牌。这样这副牌就被分成了两堆：第一堆 是最上面的 $A_i$ 张牌，第二堆是剩下的 $n-A_i$ 张牌，且这两堆牌内相对顺序不变。 特别地，当$A_i = n$ 或 $A_i = 0$ 时，有一堆牌是空的。\n2. 接下来对两堆牌进行合并，从而产生新的第三堆牌。当第一堆牌还剩下 $X$ 张，第二堆牌还剩下 $Y$ 张的时候，以 $\\dfrac{X}{X+Y}$ 的概率取出第一堆牌的最下面的牌，并将它 放入新的第三堆牌的最上面， $\\dfrac{Y}{X+Y}$  的概率取出第二堆牌的最下面的牌，并将它放入新的第三堆牌的最上面\n3. 重复操作 $2$，一直取到两堆牌都为空为止。这样我们就完成了一轮洗牌。\n\n因为洗牌过程是随机的，所以小 S 发现自己没法知道某个位置上具体是哪张牌。但小 S 想问你在经历了这 $m$ 轮洗牌后，某个位置上的牌的**期望分数**是多少。小 S 一共会问你 $Q$ 个这样的问题。", "inputFormat": "输入的第一行包含三个正整数 $n, m, type$，分别表示牌的数量，洗牌的轮数与 $f(i)$ 的类型。当 $type = 1$ 时，$f(i) = i$。当 $type = 2$ 时，$f(i) = i^2$。\n\n接下来一行，一共 $m$ 个整数，表示 $A_1 \\sim A_m$。\n\n接下来一行一个正整数 $Q$，表示小 S 的询问个数。 接下来 $Q$ 行，每行一个正整数 $c_i$，表示小 S 想要知道从上往下第 $c_i$ 个位置上的牌的**期望分数**。\n\n保证 $1 \\leq c_i \\leq n$。", "outputFormat": "输出一共 $Q$ 行，每行一个整数，表示答案在模 $998244353$ 意义下的取值。\n\n\n即设答案化为最简分式后的形式为 $\\dfrac{a}\n{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx \\equiv a \\pmod{998244353}$ 且 $0 ≤ x < 998244353$。可以证明这样的整数 $x$ 是唯一的。", "hint": "### 更多样例\n\n您可以通过附加文件获得更多样例。\n\n#### 样例 2\n\n见附加文件中的 `landlords/landlords2.in` 与 `landlords/landlords2.ans`。\n\n#### 样例 3\n\n见附加文件中的 `landlords/landlords3.in` 与 `landlords/landlords3.ans`。\n\n### 样例输入输出 1 解释\n\n- 有 $\\dfrac{1}{4}$ 的概率从上到下的最终结果是 $\\{1, 2, 3, 4\\}$。\n- 有 $\\dfrac{1}{4}$ 的概率从上到下的最终结果是 $\\{1, 2, 4, 3\\}$。\n- 有 $\\dfrac{1}{4}$ 的概率从上到下的最终结果是 $\\{1, 4, 2, 3\\}$。\n- 有 $\\dfrac{1}{4}$ 的概率从上到下的最终结果是 $\\{4, 1, 2, 3\\}$。\n\n所以最终有 $\\dfrac{1}{4}$ 的概率第一个位置是 $4$，有 $\\dfrac{3}\n{4}$ 的概率第一个位置是 $1$，所以第一个位置的期望分数是 $\\dfrac{7}{\n4}$。\n\n为了帮助你们更直观地了解洗牌的过程，我们在下面画出了结果是 $\\{1, 4, 2, 3\\}$ 的过程。\n\n![](https://cdn.luogu.com.cn/upload/pic/64318.png)\n\n### 数据规模与约定\n\n对于全部的测试点，保证 $3\\le n \\le 10^7$，$1\\le m,Q\\le5\\times 10^5$，$0\\le A_i\\le n$，$type\\in \\{1,2\\}$。\n\n每个测试点的具体限制见下表：\n\n| 测试点 | $n$ | $m$ | $type=$ | 其他性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 10$ | $\\le 1$ | $1$ | 无 |\n| $2$ | $\\le 80$ | $\\le 80$ | $1$ | 无 |\n| $3$ | $\\le 80$ | $\\le 80$ | $2$ | 无 |\n| $4$ | $\\le 100$ | $\\le 5\\times 10^5$ | $2$ | 所有 $A_i$ 相同 |\n| $5$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | 无 |\n| $6$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | 无 |\n| $7$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $1$ | 无 |\n| $8$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$ |无  |\n| $9$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$ | 无 |\n| $10$ | $\\le 10^7$ | $\\le 5\\times 10^5$ | $2$  | 无 |\n\n请注意我们并没有保证 $Q\\le n$。\n\n### 提示\n\n这里我们给出离散型随机变量 $X$ 的期望 $\\mathbb{E}[x]$ 的定义：\n\n设离散随机变量 $X$ 的可能值是 $X_1,X_2,\\ldots X_k$，$Pr[X_1],Pr[X_2],\\ldots,Pr[X_k]$ 为 $X$ 取对应值的概率，则 $X$ 的期望为：\n$$\\mathbb{E}[x]=\\sum^k_{i=1}X_i\\times Pr[X_i]$$\n\n", "locale": "zh-CN"}}}
{"pid": "P5473", "type": "P", "difficulty": 7, "samples": [["100 200 300\n3 2\n0 1\n1 2\n", "见“提示与说明”"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "NOI", "交互题", "Special Judge", "O2优化"], "title": "[NOI2019] I 君的探险", "background": "附加文件可在页面底部「附件」中下载。\n\n### 特别提示\n\n**在洛谷提交本题时的一些注意事项（与原题面不同之处请以此处为准）：**\n\n1. 与原题不同的是，你不需要，也不应该在程序开头包含 `explore.h` 头文件。\n\n2. 为了确保程序正常编译，你需要在你提交的程序开头加上如下函数声明语句：\n\n```cpp\nvoid modify(int x);\nint query(int x);\nvoid report(int x, int y);\nint check(int x);\n```\n\n3. 本题仅支持 C++ 语言（包括 `C++`，`C++11`，`C++14`，`C++17`）提交。", "description": "时隔半年，I 君的商店终于开不下去了，他决定转让商店，做一名探险家去探索未知的广阔世界。\n\n根据古书记载，他在一个大荒漠的腹地找到了未知文明创造的地下宫殿，宫殿由 $N$ 个大型洞穴和 $M$ 条连接这些洞穴的双向通路构成。I 君能借助古书分辨所处的洞穴，但书中并没有记录 $M$ 条通路的连接结构，因此他难以搜寻传说中藏在宫殿里的无尽财宝。\n\n不过现在 I 君发现了一个神秘机关，通过它可以获知宫殿的信息，I 君决定利用这个机关来得到宫殿的连接结构，请你来协助他。\n\n地下宫殿可以抽象成一张 $N$ 个点、$M$ 条边的无向简单图（简单图满足任意两点之间至多存在一条直接相连的边），洞穴从 $0 \\sim n - 1$ 编号。目前你并不知道边有哪些。\n\n每个洞穴都拥有一个光源，光源有开启、关闭两种状态，只有当光源处于开启状态时它所在的洞穴才会被照亮。初始时所有的光源都处于关闭状态，而光源的状态只能用I 君发现的神秘机关改变。更具体的，使用神秘机关可以进行如下四种操作：\n\n1. 向机关给定一个编号 $x$，机关将会改变$x$ 号洞穴，以及与$x$ 号洞穴有通路直接相连的洞穴的光源状态。即原来开启的光源将会关闭；原来关闭的光源将会开启。\n\n2. 向机关给定一个编号 $x$，机关将会显示当前$x$ 号洞穴光源的状态。\n\n3. 向机关给定两个编号 $x, y$，表示你确定有一条连接 $x$ 号洞穴与 $y$ 号洞穴的通路，并让机关记录。\n\n4. 向机关给定一个编号 $x$，机关将会判断与 $x$ 号洞穴相连的通路是否都已被记录。\n\n机关在完成上一次操作后才能进行下一次操作。机关不能随意使用，因此每种操作的使用次数都有限制，分别为 $L_m, L_q, M, L_c$。你的任务是，编写一个程序，帮助 I 君决定如何合理利用神秘机关，从而正确地找到这 $M$ 条通路。\n\n### 实现细节\n\n你不需要，也不应该实现主函数，你只需要实现函数 `explore(N, M)`，这里的 $N$和 $M$ 分别表示洞穴和通路的个数。你可以通过调用如下四个函数来和交互库进行交互：\n\n1. `modify(x)`\n\n- 这个函数可以令机关执行操作 $1$，给定的编号为 $x$。\n\n- 你需要保证 $0 \\leq x < N$，这个函数没有返回值。\n\n2. `query(x)`\n\n- 这个函数可以令机关执行操作 $2$，给定的编号为 $x$。\n\n- 你需要保证 $0 \\leq x < N$，这个函数返回 $0$ 或 $1$，表示目前 $x$ 号洞穴的光源为关闭（$0$ 表示）或开启（$1$ 表示）状态。\n\n3. `report(x, y)`\n\n- 这个函数可以令机关执行操作 $3$，给定的编号为 $x, y$。\n\n- 你需要保证 $0 \\leq x, y < N$ 且 $x \\neq y$，这个函数没有返回值。\n\n4. `check(x)`\n\n- 这个函数可以令机关执行操作 $4$，给定的编号为 $x$。\n\n- 你需要保证 $0 \\leq x < N$，这个函数返回 $0$ 或 $1$，其中返回 $1$ 当且仅当与 $x$ 号洞穴相连的所有通路都已通过操作 3 被记录。\n\n评测时，交互库会恰好调用 `explore` 一次。\n\n本题保证所使用的图在交互开始之前已经完全确定，不会根据和你的程序的交互过程动态构造，因此题目中的交互操作都是确定性的，你不需要关心这些操作在交互库中的具体实现。\n\n数据保证在调用次数限制下，交互库运行所需的时间不超过1s；交互库使用的内存大小固定，且不超过128MB。\n\n### 实现方法\n\n选手工作目录下已经提供了一个 `template_explore.cpp/c/pas`，请将这个文件拷贝一份，重命名为 `explore.cpp/c/pas`，然后在其基础上答题。\n\n1. 对 C++ / C 语言选手\n\n- 请确保你的程序开头有 \n```\n#include \"explore.h\"。\n```\n- 你需要实现的函数 `explore` 的接口信息如下：\n```\nvoid explore(int N, int M);\n```\n- 你可以调用的交互函数的接口如下：\n```\nvoid modify(int x);\nint query(int x);\nvoid report(int x, int y);\nint check(int x);\n```\n\n2. 对 Pascal 语言选手\n\n- 注意：Pascal 的代码中实现接口的语法较为复杂，请选手直接在下发的.\n`template_explore.pas` 的基础上进行答题，而不是自己从头实现代码。\n\n- 你需要实现的函数 `explore` 的接口信息如下：\n```\nprocedure _explore(N, M : longint);\n```\n- 注意：这里的函数名称是`_explore` 而非`explore`，如果使用`explore` 将导致编译失败。\n\n- 你可以调用的交互函数的接口如下：\n```\nprocedure modify(x : longint);\nfunction query(x : longint) : longint;\nprocedure report(x : longint; y : longint);\nfunction check(x : longint) : longint;\n```\n\n试题目录下的 `grader.cpp/c` 以及 `graderhelperlib.pas` 是我们提供的交互库参考实现，最终测试时所用的交互库实现与该参考实现有所不同，因此选手的解法不应该依赖交互库实现。\n\n1. 对 `C/C++` 语言的选手：\n\n- 你需要在本题目录下使用如下命令编译得到可执行程序：\n\n- 对于 C 语言：\n```\ngcc grader.c explore.c -o explore -O2 -lm\n```\n- 对于 C++ 语言：\n```\ng++ grader.cpp explore.cpp -o explore -O2 -lm\n```\n\n2. 对于 `Pascal` 语言的选手：\n\n- 你需要在本题目录下使用如下命令编译得到可执行程序：\n```\nfpc grader.pas -o\"explore\" -O2\n```\n\n3. 对于编译得到的可执行程序：\n\n- 可执行文件将从标准输入读入以下格式的数据：\n\n第一行包含三个整数 $L_m, L_q, L_c$ ，第二行包含两个整数 $N, M$，意义如题面描述。\n\n接下来 $M$ 行，每行两个整数 $x, y$，描述一条连接 $x$ 号洞穴与 $y$ 号洞穴的通路。\n\n- 读入完成之后，交互库将调用恰好一次函数 `explore`，用输入的数据测试你的函数。你的函数正确返回后，交互库会判断你的计算是否正确，若正确则会输出 `Correct` 和交互函数调用次数相关信息，否则会输出相应的错误信息。", "inputFormat": "", "outputFormat": "", "hint": "数据第一行的三个整数分别表示三种操作的调用次数限制，即 `modify(x)` 调用次数不能超过 $100$，`query(x)` 调用次数不能超过 $200$，`check(x)` 调用次数不能超过 $300$。\n\n数据第二行的两个整数分别表示洞穴数和通路条数，即 $N = 3 , M = 2$。\n\n`report(x, y)` 调用次数不能超过 $M$，该例子中即不超过 $2$ 次。\n\n下面是一个正确的交互过程：\n\n| 选手程序 | 交互库 | 说明 |\n| :----------: | :----------: | :----------: |\n|  | 调用 $\\text{explore}(3,2)$ | 开始测试 |\n| 调用 $\\text{modify}(0)$ |  | 对 $0$ 号洞穴做操作 $1$ |\n| 调用 $\\text{query}(2)$ | 返回 $0$ | 目前 $2$ 号洞穴的光源状态是关闭 |\n| 调用 $\\text{report}(0,1)$ |  | 发现了道路 $(0,1)$ 并记录 |\n| 调用 $\\text{check}(0)$ | 返回 $1$ | 与 $0$ 号洞穴相关的道路都已被记录 |\n| 调用 $\\text{report}(2,1)$ |  | 发现了道路 $(2,1)$ 并记录 |\n| 运行结束并返回 | 向屏幕打印 $\\text{Correct}$ | 交互结束，结果正确 |\n\n### 下发文件说明\n\n在本试题目录下：\n\n1. `grader.cpp/c` 以及 `graderhelperlib.pas` 是我们提供的交互库参考实现。\n\n2. `explore.h` 和 `grader.pas` 是头文件，选手不用关心具体内容。\n\n3. `template_explore.cpp/c/pas` 是我们提供的样例解题源代码。\n\n4. `explore1.in`、`explore2.in`、`explore3.in` 是样例输入，可供测试。\n\n选手注意对所有下发文件做好备份。评测只收取本试题目录下的`explore.c/cpp/pas`，并且对该程序以外的文件的修改无效。\n\n最终评测只会收取 `explore.cpp/c/pas`，修改选手目录下其他文件对评测无效。\n\n本题首先会受到和传统题相同的限制。例如编译错误会导致整道题目得 $0$ 分，运行时错误、超过时间限制、超过空间限制等会导致相应测试点得 $0$ 分等。你只能访问自己定义的和交互库给出的变量及其对应的内存空间，尝试访问其他空间将可能导致编译错误或运行错误。\n\n在上述条件基础上，在一个测试点中，你得到满分，当且仅当：\n\n1. 你的每次函数调用均合法，且调用 `modify`、`query` 和 `check` 的次数分别不超过$L_m, L_q, L_c$。\n\n2. 由于 `report` 的调用次数限制为 $M$，你的每次调用都必须记录一条新的且存在的边；即每次调用 `report(x, y)` 时，应满足：有一条连接 $x$ 号洞穴和 $y$ 号洞穴的通路，且在这次调用之前从未调用过 `report(x, y)` 或 `report(y, x)`。\n\n3. 你实现的函数 `explore` 正常返回。\n\n4. 在 `explore` 函数返回时，你已经通过调用 `report` 记录了全部 $M$ 条通路。\n\n本题共 $25$ 个测试点，每个测试点 $4$ 分。每个测试点的数据规模和相关限制见下表。\n| 测试点编号 | $N=$ | $M=$ | $L_m=$ | $L_q=$ | $L_c=$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $3$ | $2$ | $100$ | $100$ | $100$ | 无 |\n| $2$ | $100$ | $10\\times N$ | $200$ | $10^4$ | $2\\times M$ | 无 |\n| $3$ | $200$ | $10\\times N$ | $200$ | $4\\times 10^4$ | $2\\times M$ | 无 |\n| $4$ | $300$ | $10\\times N$ |$299$  | $9\\times 10^4$ | $2\\times M$ | 无 |\n| $5$ | $500$ | $10\\times N$ | $499$ | $1.5\\times 10^5$ | $2\\times M$ | 无 |\n| $6$ | $59998$ | $\\frac{N}{2}$ | $17\\times N$ | $17\\times N$ | $0$ | $A$ |\n| $7$ | $99998$ | $\\frac{N}{2}$ | $18\\times N$ | $18\\times N$ | $0$ | $A$ |\n| $8$ | $199998$ | $\\frac{N}{2}$ | $19\\times N$ | $19\\times N$ | $0$ | $A$ |\n| $9$ | $199998$ | $\\frac{N}{2}$ | $19\\times N$ | $19\\times N$ | $0$ | $A$ |\n| $10$ | $99997$ | $N-1$ | $18\\times N$ | $18\\times N$ | $0$ | $B$ |\n| $11$ | $199997$ | $N-1$ | $19\\times N$ | $19\\times N$ | $0$ | $B$ |\n| $12$ | $99996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $13$ | $199996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $14$ | $199996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $15$ | $99995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $16$ | $99995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $17$ | $199995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $18$ | $1004$ | $2\\times 10^3$ | $10^7$ | $5\\times 10^4$ | $2\\times M$ | 无 |\n| $19$ | $1004$ | $3\\times 10^3$ | $10^7$ | $5\\times 10^4$ | $2\\times M$ | 无 |\n| $20$ | $1004$ | $3\\times 10^3$ | $10^7$ | $5\\times 10^4$ | $2\\times M$ | 无 |\n| $21$ | $5\\times 10^4$ | $2\\times N$ | $10^7$ | $10^7$ | $2\\times M$ |  无|\n| $22$ | $10^5$ | $2\\times N$ | $10^7$ | $10^7$ | $2\\times M$ | 无 |\n| $23$ | $1.5\\times 10^5$ | $2\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | 无 |\n| $24$ | $2\\times 10^5$ | $2.5\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | 无 |\n| $25$ | $2\\times 10^5$ | $3\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | 无 |\n\n再次提醒，题目保证测试所使用的图在交互开始之前已经完全确定，而不会根据和你的程序的交互动态构造。\n\n表中特殊性质栏中变量的含义如下：\n\nA：保证每个点的度数恰好为 $1$。\n\nB：保证对于每个 $x > 0$，存在恰好一个 $y < x$ 的 $y$ 使得 $x$ 号洞穴与 $y$ 号洞穴有通路直接相连。\n\nC：存在 $0 \\sim N - 1$ 的一个排列 $p_0, p_1, \\cdots , p_{N-1}$，使得对任意 $1 \\leq i < N$，存在一条连接洞穴编号分别为 $p_{i-1}$ 与 $p_i$ 的通路。\n\nD：保证图连通。\n\n- 提示：你的程序可以通过判断传入的 $N$ 的个位来区分上述不同的数据类型。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2019] Mr. I's Adventure.", "background": "Additional files can be downloaded from “Attachments” at the bottom of the page.\n\n### Special Notes\n\n**Notes for submitting this problem on Luogu (if it differs from the original statement, follow what is written here):**\n\n1. Unlike the original problem, you do not need to, and should not, include the header file `explore.h` at the beginning of your program.\n\n2. To ensure your program compiles correctly, you need to add the following function declarations at the beginning of your submitted program:\n\n```cpp\nvoid modify(int x);\nint query(int x);\nvoid report(int x, int y);\nint check(int x);\n```\n\n3. This problem only supports submissions in C++ (including `C++`, `C++11`, `C++14`, `C++17`).", "description": "Half a year later, Mr. I’s shop finally could not stay open anymore. He decided to transfer the shop and become an explorer to explore the vast unknown world.\n\nAccording to ancient books, he found an underground palace created by an unknown civilization deep in a great desert. The palace consists of $N$ large caves and $M$ bidirectional passages connecting these caves. Mr. I can use the ancient book to identify which cave he is in, but the book does not record the connection structure of the $M$ passages, so it is difficult for him to search for the endless treasure said to be hidden in the palace.\n\nHowever, Mr. I has now found a mysterious mechanism that can reveal information about the palace. Mr. I decides to use this mechanism to obtain the connection structure of the palace, and asks you to assist him.\n\nThe underground palace can be abstracted as an undirected simple graph with $N$ vertices and $M$ edges (a simple graph means there is at most one directly connected edge between any two vertices). The caves are numbered from $0 \\sim n - 1$. Currently, you do not know what the edges are.\n\nEach cave has a light source, which has two states: on and off. A cave is lit only when its light source is on. Initially, all light sources are off, and the light states can only be changed using the mysterious mechanism discovered by Mr. I. More specifically, the mechanism supports the following four operations:\n\n1. Given an index $x$, the mechanism will toggle the light state of cave $x$ and all caves that are directly connected to cave $x$ by a passage. That is, lights that were on will be turned off, and lights that were off will be turned on.\n\n2. Given an index $x$, the mechanism will display the current light state of cave $x$.\n\n3. Given two indices $x, y$, it means you confirm that there is a passage connecting cave $x$ and cave $y$, and you ask the mechanism to record it.\n\n4. Given an index $x$, the mechanism will determine whether all passages incident to cave $x$ have already been recorded.\n\nThe mechanism can perform the next operation only after finishing the previous one. The mechanism cannot be used freely, so the number of times each operation can be used is limited to $L_m, L_q, M, L_c$, respectively. Your task is to write a program to help Mr. I decide how to use the mechanism properly, so that all $M$ passages can be found correctly.\n\n### Implementation Details\n\nYou do not need to, and should not, implement the main function. You only need to implement the function `explore(N, M)`, where $N$ and $M$ are the numbers of caves and passages. You can interact with the interactive library by calling the following four functions:\n\n1. `modify(x)`\n\n- This function makes the mechanism perform operation $1$ with the given index $x$.\n\n- You must ensure $0 \\leq x < N$. This function has no return value.\n\n2. `query(x)`\n\n- This function makes the mechanism perform operation $2$ with the given index $x$.\n\n- You must ensure $0 \\leq x < N$. This function returns $0$ or $1$, meaning the light source of cave $x$ is currently off ($0$) or on ($1$).\n\n3. `report(x, y)`\n\n- This function makes the mechanism perform operation $3$ with the given indices $x, y$.\n\n- You must ensure $0 \\leq x, y < N$ and $x \\neq y$. This function has no return value.\n\n4. `check(x)`\n\n- This function makes the mechanism perform operation $4$ with the given index $x$.\n\n- You must ensure $0 \\leq x < N$. This function returns $0$ or $1$, where it returns $1$ if and only if all passages incident to cave $x$ have already been recorded via operation 3.\n\nDuring judging, the interactive library will call `explore` exactly once.\n\nThis problem guarantees that the graph used has been fully determined before the interaction starts, and will not be constructed dynamically based on the interaction process. Therefore, all interactive operations in the statement are deterministic, and you do not need to care about their internal implementation in the library.\n\nThe testdata guarantees that under the call limits, the time needed for the interactive library to run does not exceed 1 s. The memory used by the interactive library is fixed and does not exceed 128 MB.\n\n### Implementation Method\n\nA `template_explore.cpp/c/pas` has already been provided in the contestant working directory. Please copy this file and rename it to `explore.cpp/c/pas`, then solve the problem based on it.\n\n1. For C++ / C contestants\n\n- Please make sure your program starts with\n```\n#include \"explore.h\"。\n```\n- The interface of the function `explore` you need to implement is:\n```\nvoid explore(int N, int M);\n```\n- The interfaces of the interactive functions you can call are:\n```\nvoid modify(int x);\nint query(int x);\nvoid report(int x, int y);\nint check(int x);\n```\n\n2. For Pascal contestants\n\n- Note: The syntax for implementing the interface in Pascal code is relatively complex. Please solve the problem directly based on the provided `template_explore.pas`, rather than implementing everything from scratch.\n\n- The interface of the function you need to implement is:\n```\nprocedure _explore(N, M : longint);\n```\n- Note: The function name here is `_explore` rather than `explore`. Using `explore` will cause compilation failure.\n\n- The interfaces of the interactive functions you can call are:\n```\nprocedure modify(x : longint);\nfunction query(x : longint) : longint;\nprocedure report(x : longint; y : longint);\nfunction check(x : longint) : longint;\n```\n\nThe `grader.cpp/c` and `graderhelperlib.pas` in the problem directory are a reference implementation of the interactive library provided by us. The interactive library used in the final test is different from this reference implementation, so your solution should not depend on the library implementation.\n\n1. For `C/C++` contestants:\n\n- You need to compile the executable in this problem directory using the following commands:\n\n- For C:\n```\ngcc grader.c explore.c -o explore -O2 -lm\n```\n- For C++:\n```\ng++ grader.cpp explore.cpp -o explore -O2 -lm\n```\n\n2. For `Pascal` contestants:\n\n- You need to compile the executable in this problem directory using the following command:\n```\nfpc grader.pas -o\"explore\" -O2\n```\n\n3. For the compiled executable:\n\n- The executable will read input from standard input in the following format:\n\nThe first line contains three integers $L_m, L_q, L_c$. The second line contains two integers $N, M$, with the meanings as described above.\n\nThe next $M$ lines each contain two integers $x, y$, describing a passage connecting cave $x$ and cave $y$.\n\n- After reading is finished, the interactive library will call the function `explore` exactly once, and test your function with the input data. After your function returns correctly, the interactive library will check whether your result is correct. If it is correct, it will output `Correct` and information related to the number of interactive calls; otherwise it will output the corresponding error information.", "inputFormat": "", "outputFormat": "", "hint": "The three integers on the first line of the testdata are the call limits of the three operations: the number of calls to `modify(x)` must not exceed $100$, the number of calls to `query(x)` must not exceed $200$, and the number of calls to `check(x)` must not exceed $300$.\n\nThe two integers on the second line of the testdata are the number of caves and the number of passages, i.e. $N = 3 , M = 2$.\n\nThe number of calls to `report(x, y)` must not exceed $M$, so in this example it must not exceed $2$ calls.\n\nBelow is a correct interaction process:\n\n| Contestant Program | Interactive Library | Explanation |\n| :----------: | :----------: | :----------: |\n|  | Calls $\\text{explore}(3,2)$ | Start testing. |\n| Calls $\\text{modify}(0)$ |  | Perform operation $1$ on cave $0$. |\n| Calls $\\text{query}(2)$ | Returns $0$ | The current light state of cave $2$ is off. |\n| Calls $\\text{report}(0,1)$ |  | Found and recorded the passage $(0,1)$. |\n| Calls $\\text{check}(0)$ | Returns $1$ | All passages incident to cave $0$ have been recorded. |\n| Calls $\\text{report}(2,1)$ |  | Found and recorded the passage $(2,1)$. |\n| Ends and returns | Prints $\\text{Correct}$ | Interaction ends, and the result is correct. |\n\n### Notes on Provided Files\n\nIn this problem directory:\n\n1. `grader.cpp/c` and `graderhelperlib.pas` are the reference implementation of the interactive library provided by us.\n\n2. `explore.h` and `grader.pas` are header files; contestants do not need to care about their contents.\n\n3. `template_explore.cpp/c/pas` is the sample solution source code provided by us.\n\n4. `explore1.in`, `explore2.in`, `explore3.in` are sample inputs for testing.\n\nPlease back up all provided files. The judge only collects `explore.c/cpp/pas` in this problem directory, and any modifications to other files are ignored.\n\nThe final judging will only collect `explore.cpp/c/pas`. Modifying other files in your directory does not affect judging.\n\nThis problem is first subject to the same limits as traditional problems. For example, compilation errors will make the whole problem score $0$ points, runtime errors, time limit exceeded, memory limit exceeded, etc. will make the corresponding test point score $0$ points. You may only access variables you define and those provided by the interactive library, as well as their corresponding memory space. Attempting to access other memory may cause compilation errors or runtime errors.\n\nUnder the above conditions, for each test point, you get full score if and only if:\n\n1. Every function call you make is valid, and the numbers of calls to `modify`, `query`, and `check` do not exceed $L_m, L_q, L_c$, respectively.\n\n2. Since the call limit of `report` is $M$, each call must record a new edge that exists. That is, each time you call `report(x, y)`, it must satisfy: there is a passage connecting caves $x$ and $y$, and before this call you have never called `report(x, y)` or `report(y, x)`.\n\n3. The function `explore` you implemented returns normally.\n\n4. When `explore` returns, you have recorded all $M$ passages by calling `report`.\n\nThere are $25$ test points in total, each worth $4$ points. The data size and related limits for each test point are shown in the table below.\n| Test Point ID | $N=$ | $M=$ | $L_m=$ | $L_q=$ | $L_c=$ | Special Property |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $3$ | $2$ | $100$ | $100$ | $100$ | None |\n| $2$ | $100$ | $10\\times N$ | $200$ | $10^4$ | $2\\times M$ | None |\n| $3$ | $200$ | $10\\times N$ | $200$ | $4\\times 10^4$ | $2\\times M$ | None |\n| $4$ | $300$ | $10\\times N$ |$299$  | $9\\times 10^4$ | $2\\times M$ | None |\n| $5$ | $500$ | $10\\times N$ | $499$ | $1.5\\times 10^5$ | $2\\times M$ | None |\n| $6$ | $59998$ | $\\frac{N}{2}$ | $17\\times N$ | $17\\times N$ | $0$ | $A$ |\n| $7$ | $99998$ | $\\frac{N}{2}$ | $18\\times N$ | $18\\times N$ | $0$ | $A$ |\n| $8$ | $199998$ | $\\frac{N}{2}$ | $19\\times N$ | $19\\times N$ | $0$ | $A$ |\n| $9$ | $199998$ | $\\frac{N}{2}$ | $19\\times N$ | $19\\times N$ | $0$ | $A$ |\n| $10$ | $99997$ | $N-1$ | $18\\times N$ | $18\\times N$ | $0$ | $B$ |\n| $11$ | $199997$ | $N-1$ | $19\\times N$ | $19\\times N$ | $0$ | $B$ |\n| $12$ | $99996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $13$ | $199996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $14$ | $199996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $15$ | $99995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $16$ | $99995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $17$ | $199995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $18$ | $1004$ | $2\\times 10^3$ | $10^7$ | $5\\times 10^4$ | $2\\times M$ | None |\n| $19$ | $1004$ | $3\\times 10^3$ | $10^7$ | $$5\\times 10^4$$ | $2\\times M$ | None |\n| $20$ | $1004$ | $3\\times 10^3$ | $10^7$ | $5\\times 10^4$ | $2\\times M$ | None |\n| $21$ | $5\\times 10^4$ | $2\\times N$ | $10^7$ | $10^7$ | $2\\times M$ |  None |\n| $22$ | $10^5$ | $2\\times N$ | $10^7$ | $10^7$ | $2\\times M$ | None |\n| $23$ | $1.5\\times 10^5$ | $2\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | None |\n| $24$ | $2\\times 10^5$ | $2.5\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | None |\n| $25$ | $2\\times 10^5$ | $3\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | None |\n\nReminder again: the problem guarantees that the graph used for testing has been fully determined before the interaction starts, and will not be constructed dynamically based on the interaction with your program.\n\nThe meanings of the variables in the “Special Property” column are as follows:\n\nA: It is guaranteed that the degree of every vertex is exactly $1$.\n\nB: It is guaranteed that for every $x > 0$, there exists exactly one $y < x$ such that cave $x$ is directly connected to cave $y$ by a passage.\n\nC: There exists a permutation $p_0, p_1, \\cdots , p_{N-1}$ of $0 \\sim N - 1$ such that for any $1 \\leq i < N$, there exists a passage connecting caves $p_{i-1}$ and $p_i$.\n\nD: It is guaranteed that the graph is connected.\n\n- Hint: Your program can distinguish the different data types above by checking the last digit of the given $N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2019] I 君的探险", "background": "附加文件可在页面底部「附件」中下载。\n\n### 特别提示\n\n**在洛谷提交本题时的一些注意事项（与原题面不同之处请以此处为准）：**\n\n1. 与原题不同的是，你不需要，也不应该在程序开头包含 `explore.h` 头文件。\n\n2. 为了确保程序正常编译，你需要在你提交的程序开头加上如下函数声明语句：\n\n```cpp\nvoid modify(int x);\nint query(int x);\nvoid report(int x, int y);\nint check(int x);\n```\n\n3. 本题仅支持 C++ 语言（包括 `C++`，`C++11`，`C++14`，`C++17`）提交。", "description": "时隔半年，I 君的商店终于开不下去了，他决定转让商店，做一名探险家去探索未知的广阔世界。\n\n根据古书记载，他在一个大荒漠的腹地找到了未知文明创造的地下宫殿，宫殿由 $N$ 个大型洞穴和 $M$ 条连接这些洞穴的双向通路构成。I 君能借助古书分辨所处的洞穴，但书中并没有记录 $M$ 条通路的连接结构，因此他难以搜寻传说中藏在宫殿里的无尽财宝。\n\n不过现在 I 君发现了一个神秘机关，通过它可以获知宫殿的信息，I 君决定利用这个机关来得到宫殿的连接结构，请你来协助他。\n\n地下宫殿可以抽象成一张 $N$ 个点、$M$ 条边的无向简单图（简单图满足任意两点之间至多存在一条直接相连的边），洞穴从 $0 \\sim n - 1$ 编号。目前你并不知道边有哪些。\n\n每个洞穴都拥有一个光源，光源有开启、关闭两种状态，只有当光源处于开启状态时它所在的洞穴才会被照亮。初始时所有的光源都处于关闭状态，而光源的状态只能用I 君发现的神秘机关改变。更具体的，使用神秘机关可以进行如下四种操作：\n\n1. 向机关给定一个编号 $x$，机关将会改变$x$ 号洞穴，以及与$x$ 号洞穴有通路直接相连的洞穴的光源状态。即原来开启的光源将会关闭；原来关闭的光源将会开启。\n\n2. 向机关给定一个编号 $x$，机关将会显示当前$x$ 号洞穴光源的状态。\n\n3. 向机关给定两个编号 $x, y$，表示你确定有一条连接 $x$ 号洞穴与 $y$ 号洞穴的通路，并让机关记录。\n\n4. 向机关给定一个编号 $x$，机关将会判断与 $x$ 号洞穴相连的通路是否都已被记录。\n\n机关在完成上一次操作后才能进行下一次操作。机关不能随意使用，因此每种操作的使用次数都有限制，分别为 $L_m, L_q, M, L_c$。你的任务是，编写一个程序，帮助 I 君决定如何合理利用神秘机关，从而正确地找到这 $M$ 条通路。\n\n### 实现细节\n\n你不需要，也不应该实现主函数，你只需要实现函数 `explore(N, M)`，这里的 $N$和 $M$ 分别表示洞穴和通路的个数。你可以通过调用如下四个函数来和交互库进行交互：\n\n1. `modify(x)`\n\n- 这个函数可以令机关执行操作 $1$，给定的编号为 $x$。\n\n- 你需要保证 $0 \\leq x < N$，这个函数没有返回值。\n\n2. `query(x)`\n\n- 这个函数可以令机关执行操作 $2$，给定的编号为 $x$。\n\n- 你需要保证 $0 \\leq x < N$，这个函数返回 $0$ 或 $1$，表示目前 $x$ 号洞穴的光源为关闭（$0$ 表示）或开启（$1$ 表示）状态。\n\n3. `report(x, y)`\n\n- 这个函数可以令机关执行操作 $3$，给定的编号为 $x, y$。\n\n- 你需要保证 $0 \\leq x, y < N$ 且 $x \\neq y$，这个函数没有返回值。\n\n4. `check(x)`\n\n- 这个函数可以令机关执行操作 $4$，给定的编号为 $x$。\n\n- 你需要保证 $0 \\leq x < N$，这个函数返回 $0$ 或 $1$，其中返回 $1$ 当且仅当与 $x$ 号洞穴相连的所有通路都已通过操作 3 被记录。\n\n评测时，交互库会恰好调用 `explore` 一次。\n\n本题保证所使用的图在交互开始之前已经完全确定，不会根据和你的程序的交互过程动态构造，因此题目中的交互操作都是确定性的，你不需要关心这些操作在交互库中的具体实现。\n\n数据保证在调用次数限制下，交互库运行所需的时间不超过1s；交互库使用的内存大小固定，且不超过128MB。\n\n### 实现方法\n\n选手工作目录下已经提供了一个 `template_explore.cpp/c/pas`，请将这个文件拷贝一份，重命名为 `explore.cpp/c/pas`，然后在其基础上答题。\n\n1. 对 C++ / C 语言选手\n\n- 请确保你的程序开头有 \n```\n#include \"explore.h\"。\n```\n- 你需要实现的函数 `explore` 的接口信息如下：\n```\nvoid explore(int N, int M);\n```\n- 你可以调用的交互函数的接口如下：\n```\nvoid modify(int x);\nint query(int x);\nvoid report(int x, int y);\nint check(int x);\n```\n\n2. 对 Pascal 语言选手\n\n- 注意：Pascal 的代码中实现接口的语法较为复杂，请选手直接在下发的.\n`template_explore.pas` 的基础上进行答题，而不是自己从头实现代码。\n\n- 你需要实现的函数 `explore` 的接口信息如下：\n```\nprocedure _explore(N, M : longint);\n```\n- 注意：这里的函数名称是`_explore` 而非`explore`，如果使用`explore` 将导致编译失败。\n\n- 你可以调用的交互函数的接口如下：\n```\nprocedure modify(x : longint);\nfunction query(x : longint) : longint;\nprocedure report(x : longint; y : longint);\nfunction check(x : longint) : longint;\n```\n\n试题目录下的 `grader.cpp/c` 以及 `graderhelperlib.pas` 是我们提供的交互库参考实现，最终测试时所用的交互库实现与该参考实现有所不同，因此选手的解法不应该依赖交互库实现。\n\n1. 对 `C/C++` 语言的选手：\n\n- 你需要在本题目录下使用如下命令编译得到可执行程序：\n\n- 对于 C 语言：\n```\ngcc grader.c explore.c -o explore -O2 -lm\n```\n- 对于 C++ 语言：\n```\ng++ grader.cpp explore.cpp -o explore -O2 -lm\n```\n\n2. 对于 `Pascal` 语言的选手：\n\n- 你需要在本题目录下使用如下命令编译得到可执行程序：\n```\nfpc grader.pas -o\"explore\" -O2\n```\n\n3. 对于编译得到的可执行程序：\n\n- 可执行文件将从标准输入读入以下格式的数据：\n\n第一行包含三个整数 $L_m, L_q, L_c$ ，第二行包含两个整数 $N, M$，意义如题面描述。\n\n接下来 $M$ 行，每行两个整数 $x, y$，描述一条连接 $x$ 号洞穴与 $y$ 号洞穴的通路。\n\n- 读入完成之后，交互库将调用恰好一次函数 `explore`，用输入的数据测试你的函数。你的函数正确返回后，交互库会判断你的计算是否正确，若正确则会输出 `Correct` 和交互函数调用次数相关信息，否则会输出相应的错误信息。", "inputFormat": "", "outputFormat": "", "hint": "数据第一行的三个整数分别表示三种操作的调用次数限制，即 `modify(x)` 调用次数不能超过 $100$，`query(x)` 调用次数不能超过 $200$，`check(x)` 调用次数不能超过 $300$。\n\n数据第二行的两个整数分别表示洞穴数和通路条数，即 $N = 3 , M = 2$。\n\n`report(x, y)` 调用次数不能超过 $M$，该例子中即不超过 $2$ 次。\n\n下面是一个正确的交互过程：\n\n| 选手程序 | 交互库 | 说明 |\n| :----------: | :----------: | :----------: |\n|  | 调用 $\\text{explore}(3,2)$ | 开始测试 |\n| 调用 $\\text{modify}(0)$ |  | 对 $0$ 号洞穴做操作 $1$ |\n| 调用 $\\text{query}(2)$ | 返回 $0$ | 目前 $2$ 号洞穴的光源状态是关闭 |\n| 调用 $\\text{report}(0,1)$ |  | 发现了道路 $(0,1)$ 并记录 |\n| 调用 $\\text{check}(0)$ | 返回 $1$ | 与 $0$ 号洞穴相关的道路都已被记录 |\n| 调用 $\\text{report}(2,1)$ |  | 发现了道路 $(2,1)$ 并记录 |\n| 运行结束并返回 | 向屏幕打印 $\\text{Correct}$ | 交互结束，结果正确 |\n\n### 下发文件说明\n\n在本试题目录下：\n\n1. `grader.cpp/c` 以及 `graderhelperlib.pas` 是我们提供的交互库参考实现。\n\n2. `explore.h` 和 `grader.pas` 是头文件，选手不用关心具体内容。\n\n3. `template_explore.cpp/c/pas` 是我们提供的样例解题源代码。\n\n4. `explore1.in`、`explore2.in`、`explore3.in` 是样例输入，可供测试。\n\n选手注意对所有下发文件做好备份。评测只收取本试题目录下的`explore.c/cpp/pas`，并且对该程序以外的文件的修改无效。\n\n最终评测只会收取 `explore.cpp/c/pas`，修改选手目录下其他文件对评测无效。\n\n本题首先会受到和传统题相同的限制。例如编译错误会导致整道题目得 $0$ 分，运行时错误、超过时间限制、超过空间限制等会导致相应测试点得 $0$ 分等。你只能访问自己定义的和交互库给出的变量及其对应的内存空间，尝试访问其他空间将可能导致编译错误或运行错误。\n\n在上述条件基础上，在一个测试点中，你得到满分，当且仅当：\n\n1. 你的每次函数调用均合法，且调用 `modify`、`query` 和 `check` 的次数分别不超过$L_m, L_q, L_c$。\n\n2. 由于 `report` 的调用次数限制为 $M$，你的每次调用都必须记录一条新的且存在的边；即每次调用 `report(x, y)` 时，应满足：有一条连接 $x$ 号洞穴和 $y$ 号洞穴的通路，且在这次调用之前从未调用过 `report(x, y)` 或 `report(y, x)`。\n\n3. 你实现的函数 `explore` 正常返回。\n\n4. 在 `explore` 函数返回时，你已经通过调用 `report` 记录了全部 $M$ 条通路。\n\n本题共 $25$ 个测试点，每个测试点 $4$ 分。每个测试点的数据规模和相关限制见下表。\n| 测试点编号 | $N=$ | $M=$ | $L_m=$ | $L_q=$ | $L_c=$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $3$ | $2$ | $100$ | $100$ | $100$ | 无 |\n| $2$ | $100$ | $10\\times N$ | $200$ | $10^4$ | $2\\times M$ | 无 |\n| $3$ | $200$ | $10\\times N$ | $200$ | $4\\times 10^4$ | $2\\times M$ | 无 |\n| $4$ | $300$ | $10\\times N$ |$299$  | $9\\times 10^4$ | $2\\times M$ | 无 |\n| $5$ | $500$ | $10\\times N$ | $499$ | $1.5\\times 10^5$ | $2\\times M$ | 无 |\n| $6$ | $59998$ | $\\frac{N}{2}$ | $17\\times N$ | $17\\times N$ | $0$ | $A$ |\n| $7$ | $99998$ | $\\frac{N}{2}$ | $18\\times N$ | $18\\times N$ | $0$ | $A$ |\n| $8$ | $199998$ | $\\frac{N}{2}$ | $19\\times N$ | $19\\times N$ | $0$ | $A$ |\n| $9$ | $199998$ | $\\frac{N}{2}$ | $19\\times N$ | $19\\times N$ | $0$ | $A$ |\n| $10$ | $99997$ | $N-1$ | $18\\times N$ | $18\\times N$ | $0$ | $B$ |\n| $11$ | $199997$ | $N-1$ | $19\\times N$ | $19\\times N$ | $0$ | $B$ |\n| $12$ | $99996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $13$ | $199996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $14$ | $199996$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $C$ |\n| $15$ | $99995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $16$ | $99995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $17$ | $199995$ | $N-1$ | $10^7$ | $10^7$ | $2\\times M$ | $D$ |\n| $18$ | $1004$ | $2\\times 10^3$ | $10^7$ | $5\\times 10^4$ | $2\\times M$ | 无 |\n| $19$ | $1004$ | $3\\times 10^3$ | $10^7$ | $5\\times 10^4$ | $2\\times M$ | 无 |\n| $20$ | $1004$ | $3\\times 10^3$ | $10^7$ | $5\\times 10^4$ | $2\\times M$ | 无 |\n| $21$ | $5\\times 10^4$ | $2\\times N$ | $10^7$ | $10^7$ | $2\\times M$ |  无|\n| $22$ | $10^5$ | $2\\times N$ | $10^7$ | $10^7$ | $2\\times M$ | 无 |\n| $23$ | $1.5\\times 10^5$ | $2\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | 无 |\n| $24$ | $2\\times 10^5$ | $2.5\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | 无 |\n| $25$ | $2\\times 10^5$ | $3\\times 10^5$ | $10^7$ | $10^7$ | $2\\times M$ | 无 |\n\n再次提醒，题目保证测试所使用的图在交互开始之前已经完全确定，而不会根据和你的程序的交互动态构造。\n\n表中特殊性质栏中变量的含义如下：\n\nA：保证每个点的度数恰好为 $1$。\n\nB：保证对于每个 $x > 0$，存在恰好一个 $y < x$ 的 $y$ 使得 $x$ 号洞穴与 $y$ 号洞穴有通路直接相连。\n\nC：存在 $0 \\sim N - 1$ 的一个排列 $p_0, p_1, \\cdots , p_{N-1}$，使得对任意 $1 \\leq i < N$，存在一条连接洞穴编号分别为 $p_{i-1}$ 与 $p_i$ 的通路。\n\nD：保证图连通。\n\n- 提示：你的程序可以通过判断传入的 $N$ 的个位来区分上述不同的数据类型。", "locale": "zh-CN"}}}
{"pid": "P5474", "type": "P", "difficulty": 4, "samples": [["5 5\n.....\n.E.S.\n.....\n.....\n.N.E.", "(4,3)\n(1,3)\n(1,1)\n(4,1)"], ["4 3\n...\n.N.\n.S.\n...", "(1,1)\n(2,1)"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "Special Judge", "CCO（加拿大）"], "title": "[CCO 2015] 冰上车", "background": null, "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day2 T1「[Cars on Ice](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)」**\n\n在圣诞夜守卫银行是一件非常无聊的事情。这就是 Barry 想要去停车场附近溜冰的原因。然而因为其他守卫把车停在了那里，停车场并不是空的。所以 Barry 决定把他们的车推出停车场。他注意到那些停着的车面对的方向是东南西北之一。因为停车场结冰了，所以推一辆车将会使得他滑行直至离开停车场或撞上其他的车。这些车只能朝他们面向的方向推。为了不撞车，Barry 找你帮忙，让你帮他计算出将车推出停车场的顺序，以便他清空停车场。", "inputFormat": "第一行包括两个整数 $N,M$，表示停车场的行列数。  \n接下来 $N$ 行每行 $M$ 个字符，描述一个停车场。其中 `.` 代表这是一个空的车位，而 `N`, `E`, `W`, `S` 表示一辆车，分别表示这辆车面朝北、东、西、南。", "outputFormat": "输出在不发生撞车的情况下将车推出的顺序，每辆车按格式 $(r,c)$ 输出，其中 $(r,c)$ 是车在停车场中的坐标，$(0,0)$ 为左上角，$(N-1,M-1)$ 为右下角。  \n保证至少有一个有效解，如果有多个解，输出任意一个。", "hint": "#### 样例解释 1\n\n唯一一辆在开始时没有被其他车挡住的是在 $(4,3)$ 的车，当这架车被推到停车场右边后，在它上面的车（在 $(1,3)$ 的车）可以被推出，然后是在 $(1,1)$ 的车，最后是在 $(4,1)$ 的车，停车场得以清空。\n\n#### 样例解释 2\n\n两辆车都可以作为第一个被推出停车场的车，所以样例输出 2 是正确的，同时顺序与其相反的输出也是正确的。\n\n#### 数据范围\n\n对于 $70\\%$ 的数据，$1\\le N,M \\le 100$；\n\n对于 $100\\%$ 的数据，$1\\le N,M \\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Cars on Ice", "background": "", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day2 T1 \"[Cars on Ice](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)\".**\n\nGuarding a bank on Christmas Eve is very boring. That is why Barry wants to go skating near the parking lot. However, because other guards parked their cars there, the parking lot is not empty. So Barry decides to push their cars out of the parking lot. He notices that the parked cars are facing one of the four directions: north, south, east, or west. Since the parking lot is icy, pushing a car will make it slide until it leaves the parking lot or crashes into another car. Each car can only be pushed in the direction it is facing. To avoid crashes, Barry asks you for help: compute an order to push the cars out of the parking lot so that he can clear the entire lot.", "inputFormat": "The first line contains two integers $N, M$, representing the number of rows and columns of the parking lot.  \nThe next $N$ lines each contain $M$ characters describing the parking lot. `.` means an empty space, and `N`, `E`, `W`, `S` indicate a car, meaning the car is facing north, east, west, and south, respectively.", "outputFormat": "Output an order to push the cars out without any crashes. Output each car in the format $(r,c)$, where $(r,c)$ is the car’s coordinate in the parking lot. $(0,0)$ is the top-left corner and $(N-1,M-1)$ is the bottom-right corner.  \nIt is guaranteed that there is at least one valid solution. If there are multiple solutions, output any one.", "hint": "#### Sample Explanation 1\n\nThe only car that is not blocked by any other car at the start is the car at $(4,3)$. After this car is pushed out through the right side of the parking lot, the car above it (the car at $(1,3)$) can be pushed out, then the car at $(1,1)$, and finally the car at $(4,1)$. The parking lot is then cleared.\n\n#### Sample Explanation 2\n\nEither car can be the first car pushed out of the parking lot, so Sample Output 2 is correct. The output in the reverse order is also correct.\n\n#### Constraints\n\nFor $70\\%$ of the testdata, $1 \\le N, M \\le 100$.\n\nFor $100\\%$ of the testdata, $1 \\le N, M \\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 冰上车", "background": null, "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day2 T1「[Cars on Ice](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)」**\n\n在圣诞夜守卫银行是一件非常无聊的事情。这就是 Barry 想要去停车场附近溜冰的原因。然而因为其他守卫把车停在了那里，停车场并不是空的。所以 Barry 决定把他们的车推出停车场。他注意到那些停着的车面对的方向是东南西北之一。因为停车场结冰了，所以推一辆车将会使得他滑行直至离开停车场或撞上其他的车。这些车只能朝他们面向的方向推。为了不撞车，Barry 找你帮忙，让你帮他计算出将车推出停车场的顺序，以便他清空停车场。", "inputFormat": "第一行包括两个整数 $N,M$，表示停车场的行列数。  \n接下来 $N$ 行每行 $M$ 个字符，描述一个停车场。其中 `.` 代表这是一个空的车位，而 `N`, `E`, `W`, `S` 表示一辆车，分别表示这辆车面朝北、东、西、南。", "outputFormat": "输出在不发生撞车的情况下将车推出的顺序，每辆车按格式 $(r,c)$ 输出，其中 $(r,c)$ 是车在停车场中的坐标，$(0,0)$ 为左上角，$(N-1,M-1)$ 为右下角。  \n保证至少有一个有效解，如果有多个解，输出任意一个。", "hint": "#### 样例解释 1\n\n唯一一辆在开始时没有被其他车挡住的是在 $(4,3)$ 的车，当这架车被推到停车场右边后，在它上面的车（在 $(1,3)$ 的车）可以被推出，然后是在 $(1,1)$ 的车，最后是在 $(4,1)$ 的车，停车场得以清空。\n\n#### 样例解释 2\n\n两辆车都可以作为第一个被推出停车场的车，所以样例输出 2 是正确的，同时顺序与其相反的输出也是正确的。\n\n#### 数据范围\n\n对于 $70\\%$ 的数据，$1\\le N,M \\le 100$；\n\n对于 $100\\%$ 的数据，$1\\le N,M \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P5475", "type": "P", "difficulty": 5, "samples": [["7 1\n100 1\n120 3\n130 5\n140 6\n150 8\n165 10\n170 12", "5.00"], ["12 4\n0 1\n2 1\n3 3\n6 1\n9 6\n12 5\n21 1\n23 1\n24 3\n27 1\n30 8\n33 6", "4.50"], ["2 4\n40287 8\n20338194 8", "0.00"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "CCO（加拿大）"], "title": "[CCO 2015] 定音鼓手", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day2 T2「[Tiampist](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)」**\n\n计算机科学家不常帮助打击乐家，但今天，这将改变。既然我们没法同时帮助所有打击乐家，那么就先设法帮助定音鼓手。\n\n定音鼓是一种能被调整至特定音调的大鼓。定音鼓手用编号为 $1\\dots D$ 的 $D$ 个定音鼓演奏。现在，他们在演奏一个有 $N$ 个音符的小节，第 $i$ 个音符演奏 $T_i$ 秒，它的音调是 $P_i$，而 $P_i$ 属于 $\\{\\text{F},$ $\\text{F}^♯,$ $\\text{G,}$ $\\text{G}^♯,$ $\\text{A},$ $\\text{A}^♯,$ $\\text{B},$ $\\text{C},$ $\\text{C}^♯,$ $\\text{D},$ $\\text{D}^♯,$ $\\text{E}\\}$ 这 12 个音符中的一个音符。\n\n在一个时刻，一个定音鼓必须先被调到某个音调，才能用来弹奏这个音调，因此定音鼓手能演奏音符 $i$ 当且仅当这个定音鼓在时间 $T_i$ 调到了音调 $P_i$。\n\n在这个片段当中的每个音符都是在一个八度的范围内，从 $\\text{F}$ 上至 $\\text{E}$，这就意味着上面可能的音符的音调是升序排序的。为了使你的计算更加方便，我们将使用整数 $1$ 到 $12$ 来表示这十二个音符。\n\n| 1 | 2 | 3 |4 | 5 | 6 |7 | 8 |9 |10 | 11 | 12 |\n| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |\n| $\\text{F}$ | $\\text{F}^♯$ | $\\text{G}$|$\\text{G}^♯$ |$\\text{A}$ | $\\text{A}^♯$ |$\\text{B}$| $\\text{C}$ |$\\text{C}^♯$ |$\\text{D}$ | $\\text{D}^♯$ |$\\text{E}$ |\n\n以上是所有定音鼓能调到的音调。\n\n在演奏开始前，定音鼓手可以随意调整各个定音鼓到任意他们想要的音调。然而，在演奏时，他们可能需要在音符间隙快速地调整他们，这样他们才能在正确的时候演奏出正确的音符。这些鼓从 $1$ 到 $D$ 编号，在任意时刻，鼓 $i+1$ 的音调必须比鼓 $i$ 的音调高。鼓手必须在（当前时刻）不需要演奏时才能调整一个鼓的音高，并且鼓手一次只能调整一个鼓的音高（假设没有人帮他调节）。\n\n因此，这并不是一件简单的事，定音鼓手想要让他们有尽可能多的时间调节。具体来说，他们想要最大化在演奏过程中的调整时间以便使他们可以在演奏中以最快速度做必要的音调调节。", "inputFormat": "第一行两个整数 $N,D$，分别表示被弹奏的音符和鼓的数量。\n\n接下来 $N$ 行每行两个整数 $T_i$ 和 $P_i$，表示第 $i$ 个音符演奏的时间和音调。", "outputFormat": "输出一行包含一个实数，下取整至两位小数，表示最大的调整时间。输出 $0.00$ 表示没有必要重新调节。", "hint": "> 【样例解释 1】\n\n> 如果只有一个鼓，定音鼓手为了可以演奏下一个音符，必须在每个音符弹奏后重新调节。\n\n> 如果有两个鼓，答案应该是 $10.00$，当留下高音鼓调到音调 $12$ 时达到这个答案。\n\n> 【样例解释 2】\n\n> 前六个音符里只有四个音调：$1$，$3$，$5$，$6$，类似的，最后六个音符里只有 $1$，$3$，$6$，$8$ 四个音调。\n\n> 一个最佳策略是，预先调整四个鼓到 $1$，$3$，$5$，$6$，在第六个音符后，定音鼓手可以花 $4.50$ 秒调整最高音的鼓到音调 $8$，然后另外 $4.50$ 秒调整次高音鼓到音调 $6$，完成时刚好是时候去弹奏第七个音符。\n\n> 【样例解释 3】\n\n> 则是一个更为典型的定音鼓片段，只包含一个音符，因此不需要重新调节。\n\n【数据范围】\n\n对于 $60\\%$ 的数据，$1\\le N \\le 50,1\\le D\\le 3$；\n\n对于 $100\\%$ 的数据，$1\\le N \\le 100,$ $1\\le D\\le 4,$ $0\\le T_1<T_2<...<T_{N-1}<T_N\\le 10^9,$ $1\\le P_i \\le 12(1\\le i \\le N)$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Timpanist", "background": "", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day2 T2 \"[Tiampist](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)\".**\n\nComputer scientists do not often help percussionists, but today that will change. Since we cannot help all percussionists at once, let us help the timpanist first.\n\nA timpani is a large drum that can be tuned to a specific pitch. A timpanist performs using $D$ timpani numbered $1 \\dots D$. Now they are playing a measure with $N$ notes. The $i$-th note is played at time $T_i$ seconds, and its pitch is $P_i$, where $P_i$ is one of the following 12 notes: $\\{\\text{F},$ $\\text{F}^♯,$ $\\text{G,}$ $\\text{G}^♯,$ $\\text{A},$ $\\text{A}^♯,$ $\\text{B},$ $\\text{C},$ $\\text{C}^♯,$ $\\text{D},$ $\\text{D}^♯,$ $\\text{E}\\}$.\n\nAt any moment, a timpani must be tuned to a pitch before it can be used to play that pitch. Therefore, the timpanist can play note $i$ if and only if, at time $T_i$, some timpani is tuned to pitch $P_i$.\n\nAll notes in this excerpt are within one octave, from $\\text{F}$ up to $\\text{E}$, which means the possible pitches above are in increasing order. To make computation easier, we will use integers $1$ to $12$ to represent these twelve notes.\n\n| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 |\n| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |\n| $\\text{F}$ | $\\text{F}^♯$ | $\\text{G}$ | $\\text{G}^♯$ | $\\text{A}$ | $\\text{A}^♯$ | $\\text{B}$ | $\\text{C}$ | $\\text{C}^♯$ | $\\text{D}$ | $\\text{D}^♯$ | $\\text{E}$ |\n\nThese are all the pitches that each timpani can be tuned to.\n\nBefore the performance starts, the timpanist may freely tune each timpani to any pitch they want. However, during the performance, they may need to quickly retune them in the gaps between notes, so that they can play the correct note at the correct time. The drums are numbered from $1$ to $D$. At any time, the pitch of drum $i+1$ must be higher than the pitch of drum $i$. The timpanist may retune a drum only when they are not required to play at that moment, and they can retune only one drum at a time (assume no one helps them tune).\n\nTherefore, this is not easy. The timpanist wants to have as much time as possible for retuning. More specifically, they want to maximize the retuning time during the performance so that they can make necessary pitch changes as quickly as possible while playing.", "inputFormat": "The first line contains two integers $N, D$, representing the number of notes played and the number of drums.\n\nThe next $N$ lines each contain two integers $T_i$ and $P_i$, representing the time and pitch of the $i$-th note.", "outputFormat": "Output a single line containing one real number, floored to two decimal places, representing the maximum retuning time. Output $0.00$ if no retuning is necessary.", "hint": "> [Sample Explanation 1]\n\n> If there is only one drum, then to play the next note, the timpanist must retune after every note.\n\n> If there are two drums, the answer should be $10.00$, achieved when the higher-pitched drum is left tuned to pitch $12$.\n\n> [Sample Explanation 2]\n\n> Among the first six notes, there are only four pitches: $1$, $3$, $5$, $6$. Similarly, among the last six notes, there are only four pitches: $1$, $3$, $6$, $8$.\n\n> One optimal strategy is to pre-tune four drums to $1$, $3$, $5$, $6$. After the sixth note, the timpanist can spend $4.50$ seconds tuning the highest-pitched drum to pitch $8$, then another $4.50$ seconds tuning the second-highest drum to pitch $6$, finishing exactly in time to play the seventh note.\n\n> [Sample Explanation 3]\n\n> This is a more typical timpani excerpt: it contains only one note, so no retuning is needed.\n\nConstraints\n\nFor $60\\%$ of the testdata, $1\\le N \\le 50, 1\\le D\\le 3$.\n\nFor $100\\%$ of the testdata, $1\\le N \\le 100,$ $1\\le D\\le 4,$ $0\\le T_1<T_2<...<T_{N-1}<T_N\\le 10^9,$ $1\\le P_i \\le 12(1\\le i \\le N)$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 定音鼓手", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day2 T2「[Tiampist](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)」**\n\n计算机科学家不常帮助打击乐家，但今天，这将改变。既然我们没法同时帮助所有打击乐家，那么就先设法帮助定音鼓手。\n\n定音鼓是一种能被调整至特定音调的大鼓。定音鼓手用编号为 $1\\dots D$ 的 $D$ 个定音鼓演奏。现在，他们在演奏一个有 $N$ 个音符的小节，第 $i$ 个音符演奏 $T_i$ 秒，它的音调是 $P_i$，而 $P_i$ 属于 $\\{\\text{F},$ $\\text{F}^♯,$ $\\text{G,}$ $\\text{G}^♯,$ $\\text{A},$ $\\text{A}^♯,$ $\\text{B},$ $\\text{C},$ $\\text{C}^♯,$ $\\text{D},$ $\\text{D}^♯,$ $\\text{E}\\}$ 这 12 个音符中的一个音符。\n\n在一个时刻，一个定音鼓必须先被调到某个音调，才能用来弹奏这个音调，因此定音鼓手能演奏音符 $i$ 当且仅当这个定音鼓在时间 $T_i$ 调到了音调 $P_i$。\n\n在这个片段当中的每个音符都是在一个八度的范围内，从 $\\text{F}$ 上至 $\\text{E}$，这就意味着上面可能的音符的音调是升序排序的。为了使你的计算更加方便，我们将使用整数 $1$ 到 $12$ 来表示这十二个音符。\n\n| 1 | 2 | 3 |4 | 5 | 6 |7 | 8 |9 |10 | 11 | 12 |\n| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |\n| $\\text{F}$ | $\\text{F}^♯$ | $\\text{G}$|$\\text{G}^♯$ |$\\text{A}$ | $\\text{A}^♯$ |$\\text{B}$| $\\text{C}$ |$\\text{C}^♯$ |$\\text{D}$ | $\\text{D}^♯$ |$\\text{E}$ |\n\n以上是所有定音鼓能调到的音调。\n\n在演奏开始前，定音鼓手可以随意调整各个定音鼓到任意他们想要的音调。然而，在演奏时，他们可能需要在音符间隙快速地调整他们，这样他们才能在正确的时候演奏出正确的音符。这些鼓从 $1$ 到 $D$ 编号，在任意时刻，鼓 $i+1$ 的音调必须比鼓 $i$ 的音调高。鼓手必须在（当前时刻）不需要演奏时才能调整一个鼓的音高，并且鼓手一次只能调整一个鼓的音高（假设没有人帮他调节）。\n\n因此，这并不是一件简单的事，定音鼓手想要让他们有尽可能多的时间调节。具体来说，他们想要最大化在演奏过程中的调整时间以便使他们可以在演奏中以最快速度做必要的音调调节。", "inputFormat": "第一行两个整数 $N,D$，分别表示被弹奏的音符和鼓的数量。\n\n接下来 $N$ 行每行两个整数 $T_i$ 和 $P_i$，表示第 $i$ 个音符演奏的时间和音调。", "outputFormat": "输出一行包含一个实数，下取整至两位小数，表示最大的调整时间。输出 $0.00$ 表示没有必要重新调节。", "hint": "> 【样例解释 1】\n\n> 如果只有一个鼓，定音鼓手为了可以演奏下一个音符，必须在每个音符弹奏后重新调节。\n\n> 如果有两个鼓，答案应该是 $10.00$，当留下高音鼓调到音调 $12$ 时达到这个答案。\n\n> 【样例解释 2】\n\n> 前六个音符里只有四个音调：$1$，$3$，$5$，$6$，类似的，最后六个音符里只有 $1$，$3$，$6$，$8$ 四个音调。\n\n> 一个最佳策略是，预先调整四个鼓到 $1$，$3$，$5$，$6$，在第六个音符后，定音鼓手可以花 $4.50$ 秒调整最高音的鼓到音调 $8$，然后另外 $4.50$ 秒调整次高音鼓到音调 $6$，完成时刚好是时候去弹奏第七个音符。\n\n> 【样例解释 3】\n\n> 则是一个更为典型的定音鼓片段，只包含一个音符，因此不需要重新调节。\n\n【数据范围】\n\n对于 $60\\%$ 的数据，$1\\le N \\le 50,1\\le D\\le 3$；\n\n对于 $100\\%$ 的数据，$1\\le N \\le 100,$ $1\\le D\\le 4,$ $0\\le T_1<T_2<...<T_{N-1}<T_N\\le 10^9,$ $1\\le P_i \\le 12(1\\le i \\le N)$。", "locale": "zh-CN"}}}
{"pid": "P5476", "type": "P", "difficulty": 6, "samples": [["4 2\n3\n3 1 1 2 3 4 2\n3 1 4 2 3 3 2\n4 2 1 2 4 4 1 4 4\n6\n2 2\n2 3\n1 2 3\n2 2\n2 3\n2 4", "0.88889\n0.33333\n0.44444\n0.11111\n0.00000"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "Special Judge", "CCO（加拿大）"], "title": "[CCO 2015] 挖掘", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day2 T3「[Eggscavation](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)」**\n\n度假时间到了！你厌倦了 C shell（编程语言），所以你决定去收集贝壳（Seashell，与 C Shell 同音）。\n\n你决定去游览 Cartesia 国的岛度假。该岛以拥有优美的方形沙滩而著名。该沙滩被划分成 $N\\times N$ 的矩阵组成，你带上了你可靠的铲子，你可以用铲子在岛上挖最多 $K\\times K$的正方形子矩阵。为了保证你的铲子是可靠的，你所挖的正方形子矩阵要保证所挖的 $K\\times K$ 的范围都在沙滩上。\n\n在岛下，有 $M$ 种未探索过的贝壳种类。具体来说，对于每个贝壳种类 $i$，有 $S_i$ 个贝壳在不同的位置。对于每个不同的种类的贝壳，你把它挖出来，然后带回家，然后以每个 $1$ 美元的价格卖给一个科学家。多个同种类的贝壳没有附加价值。\n\n麻烦的是，一种华丽的渡渡鸟在沙滩上跑来跑去。在一个给定时刻，他可能会在一个网格里埋一个蛋，包括那些已经有蛋或者网格的网格。坏消息是，如果你铲子挖出来的 $K\\times K$ 的子正方形矩阵里包含渡渡鸟的蛋，科学家会因为你正在危害濒危物种而非常着急，因此没人会给你钱。\n\n想到这些，你决定坐下来，开始写程序，进行模拟挖掘。你将会去计算你的挖掘的可能性，当你在不同时间点以均等可能性选择一个挖掘方案时，需要保证至少一个收入值来偿还你的学生贷款。谁想白忙活一场呢？", "inputFormat": "第一行包括两个整数 $N,K$，表示岛和铲子的尺寸\n\n第二行一个数 $M$，表示贝壳种类数。接下来 $M$ 行每行表示一个种类 $i$，包含一个整数 $S_i$，接着 $2\\times S_i$ 个数，为一些在 $(1,1)$ 与 $(N,M)$ 之间的坐标，表示 $S_i$ 个贝壳埋的位置。\n\n接下来 $T$ 行每行表示一个时间点，按时间由最远到最近排序，每行为如下格式之一：\n- $1$ $A_i$ $B_i$，表示渡渡鸟在 $(A_i,B_i)$ 下了一个蛋\n- $2$ $V_i$，表示我们想计算一个在该时间点获利 $\\geq V_i$ 的随机挖掘的可能性。注意贝壳和蛋在计算时都没有没有被真正地挖出来。", "outputFormat": "对于每个询问，输出一行表示一次获得至少指定利润的随机挖掘的可能性。你的答案与标准答案之间的差值的绝对值不能大于 $10^{-4}$。", "hint": "【样例解释】\n\n初始时，贝壳的排布如下所示：\n\n![CCO2015D2T3Pic1](http://miao.su/images/2018/08/16/aaa6d86f.png)\n\n我们将用铲子挖至多 $2\\times 2$ 的格子，因此我们有 $9$ 种可能的挖掘。\n当没有蛋出现时，$8$ 种挖掘包含至少两种贝壳，$3$ 种挖掘包含三种贝壳。\n\n一个蛋掉进了有贝壳 $1,2$ 的方格。\n\n在这种情况下，$\\frac{4}{9}$ 的挖掘包含至少两种贝壳且没有蛋，仅有一种挖掘会包含所有种类的贝壳并且没有蛋，那就是挖掘左下角。最终输出指明没有任何一种挖掘包含四种贝壳。\n\n【数据范围】\n\n对于至少 $15\\%$ 的数据，$1\\le N \\le 40$；\n\n对于另外 $25\\%$ 的数据，所有的更新操作在询问操作前出现；\n\n对于 $100\\%$ 的数据，$1\\le K \\le N\\le 2500,$ $0\\le M \\le 10^5,$ $1\\le S_i\\le 4,$ $0\\le T\\le 10000,$ $1\\le A_i,B_i \\le N,$ $1\\le V_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Excavation.", "background": "", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day 2 T3 “[Eggscavation](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)”.**\n\nVacation time has arrived. You are tired of C shell (a programming language), so you decide to collect seashells (“Seashell”, a homophone of “C Shell”).\n\nYou decide to visit the island nation of Cartesia for a vacation. The island is famous for its beautiful square beach. The beach is divided into an $N \\times N$ grid. You bring your trusty shovel, and you can dig out a square submatrix of size at most $K \\times K$ on the island. To ensure your shovel is reliable, the $K \\times K$ area you dig must lie entirely within the beach.\n\nUnder the island, there are $M$ unexplored species of shells. Specifically, for each species $i$, there are $S_i$ shells at distinct positions. For each different species of shell, you dig it up, take it home, and sell it to a scientist for $1$ dollar each. Multiple shells of the same species have no extra value.\n\nUnfortunately, a fancy dodo bird runs around on the beach. At a given moment, it may bury an egg in a grid cell, including cells that already have an egg or shells. The bad news is: if the $K \\times K$ square submatrix you dig contains a dodo egg, the scientist will get very upset because you are harming an endangered species, and nobody will pay you.\n\nAfter thinking about this, you decide to sit down and write a program to simulate the excavation. You need to compute the probability of your excavation outcomes: when you choose a digging plan uniformly at random at different times, what is the probability that you can earn at least some amount to repay your student loans? Nobody wants to work for nothing.", "inputFormat": "The first line contains two integers $N, K$, representing the size of the island and the shovel.\n\nThe second line contains an integer $M$, the number of shell species. The next $M$ lines each describe a species $i$: they contain an integer $S_i$, followed by $2 \\times S_i$ numbers representing coordinates between $(1,1)$ and $(N,N)$, indicating the positions where the $S_i$ shells are buried.\n\nThen there are $T$ lines, each representing a time point, sorted from the farthest time to the most recent. Each line is in one of the following formats:\n- $1$ $A_i$ $B_i$, meaning the dodo lays an egg at $(A_i, B_i)$.\n- $2$ $V_i$, meaning we want to compute the probability that a random excavation at this time point yields profit $\\ge V_i$. Note that shells and eggs are not actually dug up during these computations.", "outputFormat": "For each query, output one line giving the probability that a random excavation yields at least the specified profit. The absolute error between your answer and the standard answer must not exceed $10^{-4}$.", "hint": "[Sample Explanation.]\n\nInitially, the shells are arranged as shown below:\n\n![CCO2015D2T3Pic1](http://miao.su/images/2018/08/16/aaa6d86f.png)\n\nWe will dig at most a $2 \\times 2$ area, so there are $9$ possible excavations. When there are no eggs, $8$ excavations contain at least two species of shells, and $3$ excavations contain three species of shells.\n\nAn egg falls into the cell that contains shells $1$ and $2$.\n\nIn this case, $\\frac{4}{9}$ of the excavations contain at least two species of shells and no egg. Only one excavation contains all species of shells and no egg: digging the bottom-left corner. The final output indicates that there is no excavation that contains four species of shells.\n\n[Constraints.]\n\nFor at least $15\\%$ of the testdata, $1 \\le N \\le 40$.\n\nFor another $25\\%$ of the testdata, all update operations appear before any query operations.\n\nFor $100\\%$ of the testdata, $1 \\le K \\le N \\le 2500$, $0 \\le M \\le 10^5$, $1 \\le S_i \\le 4$, $0 \\le T \\le 10000$, $1 \\le A_i, B_i \\le N$, $1 \\le V_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 挖掘", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day2 T3「[Eggscavation](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day2.pdf)」**\n\n度假时间到了！你厌倦了 C shell（编程语言），所以你决定去收集贝壳（Seashell，与 C Shell 同音）。\n\n你决定去游览 Cartesia 国的岛度假。该岛以拥有优美的方形沙滩而著名。该沙滩被划分成 $N\\times N$ 的矩阵组成，你带上了你可靠的铲子，你可以用铲子在岛上挖最多 $K\\times K$的正方形子矩阵。为了保证你的铲子是可靠的，你所挖的正方形子矩阵要保证所挖的 $K\\times K$ 的范围都在沙滩上。\n\n在岛下，有 $M$ 种未探索过的贝壳种类。具体来说，对于每个贝壳种类 $i$，有 $S_i$ 个贝壳在不同的位置。对于每个不同的种类的贝壳，你把它挖出来，然后带回家，然后以每个 $1$ 美元的价格卖给一个科学家。多个同种类的贝壳没有附加价值。\n\n麻烦的是，一种华丽的渡渡鸟在沙滩上跑来跑去。在一个给定时刻，他可能会在一个网格里埋一个蛋，包括那些已经有蛋或者网格的网格。坏消息是，如果你铲子挖出来的 $K\\times K$ 的子正方形矩阵里包含渡渡鸟的蛋，科学家会因为你正在危害濒危物种而非常着急，因此没人会给你钱。\n\n想到这些，你决定坐下来，开始写程序，进行模拟挖掘。你将会去计算你的挖掘的可能性，当你在不同时间点以均等可能性选择一个挖掘方案时，需要保证至少一个收入值来偿还你的学生贷款。谁想白忙活一场呢？", "inputFormat": "第一行包括两个整数 $N,K$，表示岛和铲子的尺寸\n\n第二行一个数 $M$，表示贝壳种类数。接下来 $M$ 行每行表示一个种类 $i$，包含一个整数 $S_i$，接着 $2\\times S_i$ 个数，为一些在 $(1,1)$ 与 $(N,M)$ 之间的坐标，表示 $S_i$ 个贝壳埋的位置。\n\n接下来 $T$ 行每行表示一个时间点，按时间由最远到最近排序，每行为如下格式之一：\n- $1$ $A_i$ $B_i$，表示渡渡鸟在 $(A_i,B_i)$ 下了一个蛋\n- $2$ $V_i$，表示我们想计算一个在该时间点获利 $\\geq V_i$ 的随机挖掘的可能性。注意贝壳和蛋在计算时都没有没有被真正地挖出来。", "outputFormat": "对于每个询问，输出一行表示一次获得至少指定利润的随机挖掘的可能性。你的答案与标准答案之间的差值的绝对值不能大于 $10^{-4}$。", "hint": "【样例解释】\n\n初始时，贝壳的排布如下所示：\n\n![CCO2015D2T3Pic1](http://miao.su/images/2018/08/16/aaa6d86f.png)\n\n我们将用铲子挖至多 $2\\times 2$ 的格子，因此我们有 $9$ 种可能的挖掘。\n当没有蛋出现时，$8$ 种挖掘包含至少两种贝壳，$3$ 种挖掘包含三种贝壳。\n\n一个蛋掉进了有贝壳 $1,2$ 的方格。\n\n在这种情况下，$\\frac{4}{9}$ 的挖掘包含至少两种贝壳且没有蛋，仅有一种挖掘会包含所有种类的贝壳并且没有蛋，那就是挖掘左下角。最终输出指明没有任何一种挖掘包含四种贝壳。\n\n【数据范围】\n\n对于至少 $15\\%$ 的数据，$1\\le N \\le 40$；\n\n对于另外 $25\\%$ 的数据，所有的更新操作在询问操作前出现；\n\n对于 $100\\%$ 的数据，$1\\le K \\le N\\le 2500,$ $0\\le M \\le 10^5,$ $1\\le S_i\\le 4,$ $0\\le T\\le 10000,$ $1\\le A_i,B_i \\le N,$ $1\\le V_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5477", "type": "P", "difficulty": 5, "samples": [["4 7\n2 1 1\n2 1 2\n2 1 3\n2 1 4\n3\n3 4\n2 3\n1 2", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "2018", "洛谷原创", "O2优化"], "title": "[MtOI2018] 刷题？作业狂魔！", "background": "在临听到暑假的尾声以后，神奇的 cz 终于发觉自己的作业不能完成了。\n\n在他写完作业之前，你需要将他做作业的顺序告诉给他听，这样你们就可以一起玩了。", "description": "你拥有 $T$ 分钟的时间。\n\n做作业的顺序可以根据重要度 $v_i$ 来排序，但可能这不是最佳方案。且每项作业可能不止有一项，所以每项作业还有一个数量 $c_i$，每项 $t_i$ 分钟可以完成。\n\n而在做某作业之前可能要先写完某个作业，所以还给出 $M$ 个关系，每个关系包含两个数 $a,b$，代表 $a$ 是 $b$ 完成的前提，不存在 $a=b$ 的情况。\n\n关系不排除环的情况，cz 不想重做一遍作业，只好不做在环上的作业。\n\n当某作业做到一半但时间结束，则失去该作业重要度；当该作业只做了 $k$ 个，但 $k\\leq c_i$，则得到 $k\\times v_i$ 重要度，如果该作业没把 $c_i$ 个做完，则不得做其他作业。\n\n可存在 $b$ 有多个 $a$，但请注意一个作业的 **一个** 前提被做了以后，该作业就可以被做了。但 cz 非常专注，他写完一个作业以后就必须写**以该作业为前提的**作业。", "inputFormat": "输入共 $N+M+2$ 行\n\n第 $1$ 行输入 $2$ 个正整数 $N,T$。\n\n接下来共 $N$ 行输入，第 $i$ 行输入 $3$ 个正整数 $v_i,c_i,t_i$。\n\n第 $N+2$ 行输入 $1$ 个正整数 $1$ 行。\n\n接下来共 $M$ 行输入，意义同上。", "outputFormat": "输出共 $1$ 行 $1$ 个数，表示价值（重要度）最大值。", "hint": "### 子任务\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10000,1 \\leq M \\leq 100000$\n\n其他值均在 long long 范围内。\n\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T1\n\n出题人：Doubleen\n\n56432", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] Grinding Problems? Homework Maniac!", "background": "After hearing that summer vacation is coming to an end, the magical cz finally realized that he cannot finish his homework.\n\nBefore he finishes the homework, you need to tell him the order in which to do it, so that you can play together.", "description": "You have $T$ minutes.\n\nThe order of doing homework can be sorted by importance $v_i$, but this may not be the best strategy. Also, each type of homework may have more than one item, so each homework also has a quantity $c_i$, and each item takes $t_i$ minutes to complete.\n\nBefore doing some homework, it may be necessary to finish some other homework first, so $M$ relations are given. Each relation contains two numbers $a$, $b$, meaning that $a$ is a prerequisite for completing $b$. There is no case where $a=b$.\n\nThe relations may contain cycles. cz does not want to redo homework, so he can only skip the homework that lies on cycles.\n\nIf the time ends when a homework is only half done, then you gain no importance from that homework. If for a homework you finish only $k$ items, and $k\\leq c_i$, then you gain $k\\times v_i$ importance. If you do not finish all $c_i$ items of that homework, then you are not allowed to do any other homework.\n\nA homework $b$ may have multiple prerequisites $a$. However, note that once **one** prerequisite of a homework is done, that homework can be done. But cz is very focused: after finishing one homework, he must do the homework **that uses this homework as a prerequisite**.", "inputFormat": "The input has $N+M+2$ lines.\n\nLine $1$ contains two positive integers $N,T$.\n\nThe next $N$ lines follow. Line $i$ contains three positive integers $v_i,c_i,t_i$.\n\nLine $N+2$ contains one positive integer $1$.\n\nThe next $M$ lines describe the relations, with the same meaning as above.", "outputFormat": "Output one line with one number, the maximum value (importance).", "hint": "### Subtasks\n\nFor $100\\%$ of the testdata, $1<=N<=10000,1<=M<=100000$.\n\nAll other values are within the range of $long long$.\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T1\n\nProblem setter: Doubleen\n\n56432\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] 刷题？作业狂魔！", "background": "在临听到暑假的尾声以后，神奇的 cz 终于发觉自己的作业不能完成了。\n\n在他写完作业之前，你需要将他做作业的顺序告诉给他听，这样你们就可以一起玩了。", "description": "你拥有 $T$ 分钟的时间。\n\n做作业的顺序可以根据重要度 $v_i$ 来排序，但可能这不是最佳方案。且每项作业可能不止有一项，所以每项作业还有一个数量 $c_i$，每项 $t_i$ 分钟可以完成。\n\n而在做某作业之前可能要先写完某个作业，所以还给出 $M$ 个关系，每个关系包含两个数 $a,b$，代表 $a$ 是 $b$ 完成的前提，不存在 $a=b$ 的情况。\n\n关系不排除环的情况，cz 不想重做一遍作业，只好不做在环上的作业。\n\n当某作业做到一半但时间结束，则失去该作业重要度；当该作业只做了 $k$ 个，但 $k\\leq c_i$，则得到 $k\\times v_i$ 重要度，如果该作业没把 $c_i$ 个做完，则不得做其他作业。\n\n可存在 $b$ 有多个 $a$，但请注意一个作业的 **一个** 前提被做了以后，该作业就可以被做了。但 cz 非常专注，他写完一个作业以后就必须写**以该作业为前提的**作业。", "inputFormat": "输入共 $N+M+2$ 行\n\n第 $1$ 行输入 $2$ 个正整数 $N,T$。\n\n接下来共 $N$ 行输入，第 $i$ 行输入 $3$ 个正整数 $v_i,c_i,t_i$。\n\n第 $N+2$ 行输入 $1$ 个正整数 $1$ 行。\n\n接下来共 $M$ 行输入，意义同上。", "outputFormat": "输出共 $1$ 行 $1$ 个数，表示价值（重要度）最大值。", "hint": "### 子任务\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10000,1 \\leq M \\leq 100000$\n\n其他值均在 long long 范围内。\n\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T1\n\n出题人：Doubleen\n\n56432", "locale": "zh-CN"}}}
{"pid": "P5478", "type": "P", "difficulty": 6, "samples": [["5  \n1 2  \n1 3  \n2 4  \n2 5  \n4  \n10 1  \n6 1  \n14 5  \n7 3  \n5 3  \n1 2 3  \n1 5 3  \n1 4 4  \n2 1 4  \n1 2 3", "10 7 6  \n14 10 7  \n-1  \n7 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "线段树", "各省省选", "北京", "O2优化", "树链剖分", "STL"], "title": "[BJOI2015] 骑士的旅行", "background": "在一片古老的土地上，有一个繁荣的文明。\n\n这片大地几乎被森林覆盖，有N座城坐落其中。巧合的是，这N座城由恰好N-1条双向道路连接起来，使得任意两座城都是连通的。也就是说，这些城形成了树的结构，任意两座城之间有且仅有一条简单路径。\n\n在这个文明中，骑士是尤其受到尊崇的职业。任何一名骑士，都是其家族乃至家乡的荣耀。Henry从小就渴望成为一名能守护家乡、驱逐敌人的骑士。勤奋训练许多年后，Henry终于满18岁了。他决定离开家乡，向那些成名已久的骑士们发起挑战！\n", "description": "根据Henry的调查，大陆上一共有 $M$ 名受封骑士，不妨编号为 $1$ 到 $M$。第 $i$ 个骑士居住在城 $P_i$，武力值为 $F_i$。\n\nHenry计划进行若干次旅行，每次从某座城出发沿着唯一的简单路径前往另一座城，同时会挑战路线上武力值最高的 $K$ 个骑士（Henry的体力有限，为了提高水平，当然要挑战最强的骑士）。如果路线上的骑士不足 $K$ 人，Henry会挑战遇到的所有人。\n\n每次旅行前，可能会有某些骑士的武力值或定居地发生变化，Henry自然会打听消息，并对计划做出调整。\n\n为了在每次旅行时做好充分准备，Henry希望你能帮忙在每次旅行前计算出这条路线上他将挑战哪些对手。", "inputFormat": "第一行，一个整数 $N$ ，表示有 $N$ 座城，编号为 $1 \\sim N$。\n\n接下来 $N-1$ 行，每行两个整数 $u_i$ 和 $v_i$，表示城 $u_i$ 和城 $v_i$ 之间有一条道路相连。\n\n第 $N+1$ 行，一个整数 $M$，表示有 $M$ 个骑士。\n\n接下来M行，每行两个整数 $F_i$ 和 $P_i$ 。按顺序依次表示编号为 $1 \\sim M$ 的每名骑士的武力值和居住地。\n\n第 $N+M+2$ 行，两个整数 $Q,~K$，分别表示操作次数和每次旅行挑战的骑士数目上限。\n\n接下来 $Q$ 行，每行三个整数 $T_i,~X_i,~Y_i$ 。$T_i$ 取值范围为 $\\{1,~2,~3\\}$，表示操作类型。\n\n一共有以下三种类型的操作：\n\n$T_i=1$ 时表示一次旅行，Henry将从城 $X_i$ 出发前往城市 $Y_i$；\n\n$T_i=2$ 时表示编号为 $X_i$ 的骑士的居住地搬到城 $Y_i$；\n\n$T_i=3$ 时表示编号为 $X_i$ 的骑士的武力值修正为 $Y_i$。", "outputFormat": "输出若干行，依次为每个旅行的答案。\n\n对每个 $T_i=1$ 的询问，输出一行，按从大到小的顺序输出Henry在这次旅行中挑战的\n\n所有骑士的武力值。如果路线上没有骑士，输出一行，为一个整数 $-1$。", "hint": "100%的数据中，$1 \\leq N,~M \\leq 40,000,~1 \\leq Ui,~Vi,~Pi \\leq N,~1\\leq Q \\leq 80,000,~1 \\leq K \\leq 20$，旅行次数不超过 40,000 次，武力值为不超过1,000的正整数。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2015] Knight’s Journey", "background": "On an ancient land, there was a prosperous civilization.\n\nThis land was almost covered by forests, and there were $N$ cities scattered within it. By coincidence, these $N$ cities were connected by exactly $N-1$ bidirectional roads, so that any two cities were connected. In other words, these cities form a tree structure, and between any two cities there exists exactly one simple path.\n\nIn this civilization, being a knight was an especially respected profession. Any knight was the pride of their family and hometown. Henry had long dreamed of becoming a knight who could protect his hometown and drive away enemies. After training hard for many years, Henry finally turned 18. He decided to leave his hometown and challenge those famous knights.", "description": "According to Henry’s investigation, there are a total of $M$ titled knights on the continent, numbered from $1$ to $M$. The $i$-th knight lives in city $P_i$ and has combat power $F_i$.\n\nHenry plans to make several journeys. In each journey, he starts from some city and travels along the unique simple path to another city, and he will challenge the strongest $K$ knights (Henry has limited stamina, and to improve himself, of course he challenges the strongest knights). If there are fewer than $K$ knights on the route, Henry will challenge everyone he meets.\n\nBefore each journey, some knights’ combat power or residence may change. Henry will naturally gather information and adjust his plan.\n\nTo be fully prepared for each journey, Henry wants you to help compute which opponents he will challenge on that route before each journey.", "inputFormat": "The first line contains an integer $N$, meaning there are $N$ cities, numbered from $1$ to $N$.\n\nThe next $N-1$ lines each contain two integers $u_i$ and $v_i$, indicating that there is a road between city $u_i$ and city $v_i$.\n\nLine $N+1$ contains an integer $M$, meaning there are $M$ knights.\n\nThe next $M$ lines each contain two integers $F_i$ and $P_i$, describing in order the combat power and residence of each knight numbered from $1$ to $M$.\n\nLine $N+M+2$ contains two integers $Q$ and $K$, meaning the number of operations and the maximum number of knights challenged in each journey.\n\nThe next $Q$ lines each contain three integers $T_i$, $X_i$, and $Y_i$. $T_i \\in \\{1,~2,~3\\}$ indicates the operation type.\n\nThere are three types of operations:\n\nWhen $T_i=1$, it means a journey: Henry will travel from city $X_i$ to city $Y_i$.\n\nWhen $T_i=2$, it means the residence of knight $X_i$ is moved to city $Y_i$.\n\nWhen $T_i=3$, it means the combat power of knight $X_i$ is changed to $Y_i$.", "outputFormat": "Output several lines, in order, as the answers for each journey.\n\nFor each query with $T_i=1$, output one line listing, in decreasing order, the combat power values of all knights Henry challenges in this journey. If there are no knights on the route, output one line containing the integer $-1$.", "hint": "Constraints: for $100\\%$ of the testdata, $1 \\leq N,~M \\leq 40,000$, $1 \\leq Ui,~Vi,~Pi \\leq N$, $1 \\leq Q \\leq 80,000$, $1 \\leq K \\leq 20$. The number of journeys does not exceed 40,000. Combat power values are positive integers not exceeding 1,000.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2015] 骑士的旅行", "background": "在一片古老的土地上，有一个繁荣的文明。\n\n这片大地几乎被森林覆盖，有N座城坐落其中。巧合的是，这N座城由恰好N-1条双向道路连接起来，使得任意两座城都是连通的。也就是说，这些城形成了树的结构，任意两座城之间有且仅有一条简单路径。\n\n在这个文明中，骑士是尤其受到尊崇的职业。任何一名骑士，都是其家族乃至家乡的荣耀。Henry从小就渴望成为一名能守护家乡、驱逐敌人的骑士。勤奋训练许多年后，Henry终于满18岁了。他决定离开家乡，向那些成名已久的骑士们发起挑战！\n", "description": "根据Henry的调查，大陆上一共有 $M$ 名受封骑士，不妨编号为 $1$ 到 $M$。第 $i$ 个骑士居住在城 $P_i$，武力值为 $F_i$。\n\nHenry计划进行若干次旅行，每次从某座城出发沿着唯一的简单路径前往另一座城，同时会挑战路线上武力值最高的 $K$ 个骑士（Henry的体力有限，为了提高水平，当然要挑战最强的骑士）。如果路线上的骑士不足 $K$ 人，Henry会挑战遇到的所有人。\n\n每次旅行前，可能会有某些骑士的武力值或定居地发生变化，Henry自然会打听消息，并对计划做出调整。\n\n为了在每次旅行时做好充分准备，Henry希望你能帮忙在每次旅行前计算出这条路线上他将挑战哪些对手。", "inputFormat": "第一行，一个整数 $N$ ，表示有 $N$ 座城，编号为 $1 \\sim N$。\n\n接下来 $N-1$ 行，每行两个整数 $u_i$ 和 $v_i$，表示城 $u_i$ 和城 $v_i$ 之间有一条道路相连。\n\n第 $N+1$ 行，一个整数 $M$，表示有 $M$ 个骑士。\n\n接下来M行，每行两个整数 $F_i$ 和 $P_i$ 。按顺序依次表示编号为 $1 \\sim M$ 的每名骑士的武力值和居住地。\n\n第 $N+M+2$ 行，两个整数 $Q,~K$，分别表示操作次数和每次旅行挑战的骑士数目上限。\n\n接下来 $Q$ 行，每行三个整数 $T_i,~X_i,~Y_i$ 。$T_i$ 取值范围为 $\\{1,~2,~3\\}$，表示操作类型。\n\n一共有以下三种类型的操作：\n\n$T_i=1$ 时表示一次旅行，Henry将从城 $X_i$ 出发前往城市 $Y_i$；\n\n$T_i=2$ 时表示编号为 $X_i$ 的骑士的居住地搬到城 $Y_i$；\n\n$T_i=3$ 时表示编号为 $X_i$ 的骑士的武力值修正为 $Y_i$。", "outputFormat": "输出若干行，依次为每个旅行的答案。\n\n对每个 $T_i=1$ 的询问，输出一行，按从大到小的顺序输出Henry在这次旅行中挑战的\n\n所有骑士的武力值。如果路线上没有骑士，输出一行，为一个整数 $-1$。", "hint": "100%的数据中，$1 \\leq N,~M \\leq 40,000,~1 \\leq Ui,~Vi,~Pi \\leq N,~1\\leq Q \\leq 80,000,~1 \\leq K \\leq 20$，旅行次数不超过 40,000 次，武力值为不超过1,000的正整数。", "locale": "zh-CN"}}}
{"pid": "P5479", "type": "P", "difficulty": 6, "samples": [["1\nAAA\nAABBAAB", "5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2015", "各省省选", "北京", "哈希 hashing", "后缀数组 SA"], "title": "[BJOI2015] 隐身术", "background": null, "description": "给定两个串 $A$、$B$。请问 $B$ 中有多少个非空子串和 $A$ 的编辑距离不超过 $K$？\n\n所谓“子串”，指的是 $B$ 中连续的一段。不同位置的内容相同的子串算作多个。两个串之间的“编辑距离”指的是把一个串变成另一个串需要的最小的操作次数，每次操作可以插入、删除或者替换一个字符。", "inputFormat": "第一行一个非负整数 $K$。接下来两行，每行一个由大写字母组成的字符\n串，分别表示 $A$ 和 $B$。", "outputFormat": "输出一行一个整数，表示所求答案。", "hint": "对 $100\\%$ 的数据，$K\\leq5$，两个字符串均非空，长度和小于 $10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2015] Invisibility", "background": "", "description": "Given two strings $A$ and $B$. How many non-empty substrings of $B$ have an edit distance to $A$ that is at most $K$?\n\nA “substring” means a consecutive segment of $B$. Substrings with the same content but different positions are counted multiple times. The “edit distance” between two strings is the minimum number of operations needed to change one string into the other. Each operation can insert, delete, or replace one character.", "inputFormat": "The first line contains a non-negative integer $K$. The next two lines each contain a string of uppercase letters, representing $A$ and $B$ respectively.", "outputFormat": "Output one line containing an integer, which is the required answer.", "hint": "For $100\\%$ of the data, $K\\leq5$, both strings are non-empty, and the sum of their lengths is less than $10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2015] 隐身术", "background": null, "description": "给定两个串 $A$、$B$。请问 $B$ 中有多少个非空子串和 $A$ 的编辑距离不超过 $K$？\n\n所谓“子串”，指的是 $B$ 中连续的一段。不同位置的内容相同的子串算作多个。两个串之间的“编辑距离”指的是把一个串变成另一个串需要的最小的操作次数，每次操作可以插入、删除或者替换一个字符。", "inputFormat": "第一行一个非负整数 $K$。接下来两行，每行一个由大写字母组成的字符\n串，分别表示 $A$ 和 $B$。", "outputFormat": "输出一行一个整数，表示所求答案。", "hint": "对 $100\\%$ 的数据，$K\\leq5$，两个字符串均非空，长度和小于 $10^5$。", "locale": "zh-CN"}}}
{"pid": "P5480", "type": "P", "difficulty": 0, "samples": [["3 3 1\n1 2 1\n2 3 1\n1 3 2", "2 3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "北京", "Special Judge", "O2优化"], "title": "[BJOI2015] 回家的路【征集spj】", "background": "", "description": "小强和阿米巴是好朋友。连接北京和小强的家乡的是错综复杂的铁路网。一共有$~N~$个站点，站点之间有长短不一的双向的铁路。小强每次回家的时候，会从所有的最短路中随机选择一条。阿米巴门前有一条铁路。他想在不改变北京到小强的家乡的最短路的距离的前提下，给这个铁路网再添一条长度为$~K~$的单向铁路，使得小强路过阿米巴家门口的那条铁路的概率最大。请输出这个最大概率。", "inputFormat": "第一行是三个正整数$~N,M~$和$~K~$，表示站点的数量，铁路线的数量和新开的铁路线的长度。站点从$~1~$编号到$~N~$。北京是$~1~$号点，小强的家乡是$~N~$号。接下来$~M~$行，每行三个正整数$~u,v,s~$表示有一条连接站点$~u~$和$~v~$的铁路线长度是$~s~$。\n\n这$~M~$行中的第一行描述的是阿米巴家门口的铁路。两个点之间可能有多条铁路。也有可能$~u=v~$，即，有自环。你新修建的铁路也可以和已有线路重合，也可以是自环。$~1~$和$~N~$之间一定是连通的。\n\n$~3\\leq N\\leq 100000,M\\leq 400000,1\\leq s,K≤10000~$，保证无论如何加边图中任两点之间的最短路的数量都不超过$2^{16000}~$。", "outputFormat": "输出一行两个正整数$~A,B~$，表示从$~A~$向$~B~$修建一条单向铁路。你的修建方案得出的小强路过的概率和标准答案之间的差距不超过$10^{-6}$即可算对。\n\n//注意：本题因缺少$spj$，请谨慎提交。", "hint": "添加边之后，一共有$~3~$条最短路，小强会路过阿米巴门前的概率由$~1/2~$变为$~2/3~$.", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2015] The Road Home [SPJ Wanted]", "background": "", "description": "Xiaoqiang and Amoeba are good friends. Connecting Beijing and Xiaoqiang's hometown is a complicated railway network. There are $~N~$ stations in total, and between stations there are undirected railways of different lengths. Each time Xiaoqiang goes home, he randomly chooses one path among all shortest paths.\n\nThere is a railway in front of Amoeba's house. Without changing the shortest-path distance from Beijing to Xiaoqiang's hometown, Amoeba wants to add one directed railway of length $~K~$ to the network, so that the probability that Xiaoqiang passes through the railway in front of Amoeba's house is as large as possible. Please output this maximum probability.\n\n## Constraints\n\n$~3\\leq N\\leq 100000,M\\leq 400000,1\\leq s,K≤10000~$. It is guaranteed that no matter how you add the edge, the number of shortest paths between any two nodes in the graph will not exceed $2^{16000}~$.", "inputFormat": "The first line contains three positive integers $~N,M~$ and $~K~$, representing the number of stations, the number of railways, and the length of the new railway. Stations are numbered from $~1~$ to $~N~$. Beijing is node $~1~$, and Xiaoqiang's hometown is node $~N~$.\n\nThe next $~M~$ lines each contain three positive integers $~u,v,s~$, indicating an undirected railway connecting stations $~u~$ and $~v~$ with length $~s~$.\n\nThe first of these $~M~$ lines describes the railway in front of Amoeba's house. There may be multiple railways between the same pair of nodes. It is also possible that $~u=v~$, i.e., a self-loop. The new railway you build may overlap an existing railway, and it may also be a self-loop. Nodes $~1~$ and $~N~$ are guaranteed to be connected.", "outputFormat": "Output one line with two positive integers $~A,B~$, meaning that you build a directed railway from $~A~$ to $~B~$. Your construction is accepted if the difference between the probability that Xiaoqiang passes through the target railway under your plan and the standard answer is at most $10^{-6}$.\n\n// Note: This problem lacks an $spj$, so please submit with caution.", "hint": "After adding an edge, there are $~3~$ shortest paths in total. The probability that Xiaoqiang passes in front of Amoeba's house changes from $~1/2~$ to $~2/3~$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2015] 回家的路【征集spj】", "background": "", "description": "小强和阿米巴是好朋友。连接北京和小强的家乡的是错综复杂的铁路网。一共有$~N~$个站点，站点之间有长短不一的双向的铁路。小强每次回家的时候，会从所有的最短路中随机选择一条。阿米巴门前有一条铁路。他想在不改变北京到小强的家乡的最短路的距离的前提下，给这个铁路网再添一条长度为$~K~$的单向铁路，使得小强路过阿米巴家门口的那条铁路的概率最大。请输出这个最大概率。", "inputFormat": "第一行是三个正整数$~N,M~$和$~K~$，表示站点的数量，铁路线的数量和新开的铁路线的长度。站点从$~1~$编号到$~N~$。北京是$~1~$号点，小强的家乡是$~N~$号。接下来$~M~$行，每行三个正整数$~u,v,s~$表示有一条连接站点$~u~$和$~v~$的铁路线长度是$~s~$。\n\n这$~M~$行中的第一行描述的是阿米巴家门口的铁路。两个点之间可能有多条铁路。也有可能$~u=v~$，即，有自环。你新修建的铁路也可以和已有线路重合，也可以是自环。$~1~$和$~N~$之间一定是连通的。\n\n$~3\\leq N\\leq 100000,M\\leq 400000,1\\leq s,K≤10000~$，保证无论如何加边图中任两点之间的最短路的数量都不超过$2^{16000}~$。", "outputFormat": "输出一行两个正整数$~A,B~$，表示从$~A~$向$~B~$修建一条单向铁路。你的修建方案得出的小强路过的概率和标准答案之间的差距不超过$10^{-6}$即可算对。\n\n//注意：本题因缺少$spj$，请谨慎提交。", "hint": "添加边之后，一共有$~3~$条最短路，小强会路过阿米巴门前的概率由$~1/2~$变为$~2/3~$.", "locale": "zh-CN"}}}
{"pid": "P5481", "type": "P", "difficulty": 6, "samples": [["1 3 3 10", "0"], ["2 2 2 10", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "北京", "O2优化", "组合数学"], "title": "[BJOI2015] 糖果", "background": "Alice 正在教她的弟弟 Bob 学数学。 ", "description": "每天，Alice 画一个 $n$ 行 $m$ 列的表格，要求 Bob 在格子里填数。 \n\nBob已经学会了自然数 $1$ 到 $k$ 的写法。因此他在每个格子里填 $1 \\sim k$ 之间的整数。 \n\nAlice 告诉 Bob，如果 Bob 填写完表格的 $n \\times m$ 个数以后，每行的数从第 $1$ 列到第 $m$ 列单调不减，并且任意两行至少有一列的数不同，而且以前 Bob 没有填写过相同的表格，那么 Alice 就给 Bob 吃一颗糖果。 \n\nBob想知道，如果每天填写一遍表格，最多能吃到多少颗糖果。 \n\n答案对 $p$ 取模。\n", "inputFormat": "输入只有一行四个整数，分别代表 $n, m, k, p$。", "outputFormat": "输出一行，一个整数，表示答案模 $p$ 后的结果。 ", "hint": "#### 样例输入输出 1 解释\n\n共有 $10$ 种方案，取模后为 $0$。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n, m \\leq 10^5$，$1 \\leq k,p \\leq 2 \\times 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2015] Candy", "background": "Alice is teaching her younger brother Bob math.", "description": "Every day, Alice draws a table with $n$ rows and $m$ columns and asks Bob to fill in numbers in the cells.\n\nBob has learned how to write the natural numbers from $1$ to $k$. Therefore, in each cell he writes an integer between $1 \\sim k$.\n\nAlice tells Bob that if, after Bob fills in all $n \\times m$ numbers, the numbers in each row are non-decreasing from column $1$ to column $m$, and for any two rows there is at least one column where the numbers are different, and Bob has never filled in an identical table before, then Alice will give Bob a piece of candy.\n\nBob wants to know: if he fills in the table once per day, what is the maximum number of candies he can get.\n\nThe answer is taken modulo $p$.", "inputFormat": "The input contains only one line with four integers, representing $n, m, k, p$.", "outputFormat": "Output one line with one integer, representing the answer modulo $p$.", "hint": "#### Explanation of Sample Input/Output 1\n\nThere are $10$ valid schemes in total, and after taking modulo, it becomes $0$.\n\n---\n\n#### Constraints\n\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\leq n, m \\leq 10^5$, and $1 \\leq k, p \\leq 2 \\times 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2015] 糖果", "background": "Alice 正在教她的弟弟 Bob 学数学。 ", "description": "每天，Alice 画一个 $n$ 行 $m$ 列的表格，要求 Bob 在格子里填数。 \n\nBob已经学会了自然数 $1$ 到 $k$ 的写法。因此他在每个格子里填 $1 \\sim k$ 之间的整数。 \n\nAlice 告诉 Bob，如果 Bob 填写完表格的 $n \\times m$ 个数以后，每行的数从第 $1$ 列到第 $m$ 列单调不减，并且任意两行至少有一列的数不同，而且以前 Bob 没有填写过相同的表格，那么 Alice 就给 Bob 吃一颗糖果。 \n\nBob想知道，如果每天填写一遍表格，最多能吃到多少颗糖果。 \n\n答案对 $p$ 取模。\n", "inputFormat": "输入只有一行四个整数，分别代表 $n, m, k, p$。", "outputFormat": "输出一行，一个整数，表示答案模 $p$ 后的结果。 ", "hint": "#### 样例输入输出 1 解释\n\n共有 $10$ 种方案，取模后为 $0$。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n, m \\leq 10^5$，$1 \\leq k,p \\leq 2 \\times 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5482", "type": "P", "difficulty": 5, "samples": [["9\nAdd 1 1 1\nAdd -2 4 3\nQuery 0\nDel 1\nQuery 0\nDel 2\nQuery 0\nAdd 8 9 100\nQuery 10", "1\n1\n0\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "平衡树", "树状数组", "吉林"], "title": "[JLOI2011] 不等式组", "background": "", "description": "旺汪与旺喵最近在做一些不等式的练习。这些不等式都是形如 $ax+b>c$ 的一元不等式。当然，解这些不等式对旺汪来说太简单了，所以旺喵想挑战旺汪。旺喵给出一组一元不等式，并给出一个数值。旺汪需要回答的是 $x=k$ 时成立的不等式的数量。聪明的旺汪每次都很快就给出了答案。你的任务是快速的验证旺汪的答案是不是正确的。", "inputFormat": "输入第一行为一个正整数 $n$，代表接下来有 $n$ 行。\n\n接下来每一行可能有 $3$ 种形式：\n\n1. `Add a b c`：表明要往不等式组添加一条不等式 $ax+b>c$。\n2. `Del i`：代表删除第 $i$ 条添加的不等式（最先添加的是第 $1$ 条）。\n3. `Query k`：代表一个询问，即当 $x=k$ 时，在当前不等式组内成立的不等式的数量。\n\n注意：一开始不等式组为空，$a,b,c,i,k$ 均为整数，且保证所有操作均合法，不会出现要求删除尚未添加的不等式的情况，但可能重复删除同一条不等式。", "outputFormat": "对于每一个询问 `Query k`，输出一行一个整数，代表询问的答案。", "hint": "#### 样例 1 说明\n\n第 $1$ 条添加到不等式组的不等式为 $x+1>1$，第 $2$ 条为 $−2x+4>3$。所以第 $1$ 个询问的时候只有第 $2$ 条不等式可以成立，故输出 `1`。\n\n然后删除第 $1$ 条不等式，再询问的时候依然是只有第 $2$ 条不等式可以成立，故输出 $1$ 。\n\n再删除第 $2$ 条不等式后，因为不等式组里面没有不等式了，所以没有不等式可以被满足，故输出 $0$。\n\n继续加入第 $3$ 条不等式 $8x+9>100$，当 $x=k=10$ 时有 $8\\times 10+9=89<100$，故也没有不等式可以被满足，依然输出 $0$。\n\n#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n\\leq 10^3$。\n- 对于 $40\\%$ 的数据，保证 $n\\leq 10^4$。\n- 对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5$，$a,b,c\\in[-10^8,10^8]$，$k\\in[-10^6,10^6]$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2011] System of Inequalities", "background": "", "description": "Wangwang and Wangmiao have recently been practicing some inequalities. These inequalities are all one-variable inequalities of the form $ax+b>c$. Of course, solving such inequalities is too easy for Wangwang, so Wangmiao wants to challenge him.\n\nWangmiao gives a set of one-variable inequalities and a value. Wangwang needs to answer: when $x=k$, how many inequalities in the set are satisfied. Clever Wangwang can give the answer quickly every time. Your task is to quickly verify whether Wangwang's answers are correct.", "inputFormat": "The first line contains a positive integer $n$, indicating that there will be $n$ lines following.\n\nEach of the next lines can be in one of the following $3$ forms:\n\n1. `Add a b c`: Add an inequality $ax+b>c$ to the system.\n2. `Del i`: Delete the $i$-th added inequality (the first added one is $1$).\n3. `Query k`: A query asking, when $x=k$, how many inequalities in the current system are satisfied.\n\nNote: Initially, the system is empty. $a,b,c,i,k$ are all integers. All operations are guaranteed to be valid: there will be no request to delete an inequality that has not been added, but the same inequality may be deleted repeatedly.", "outputFormat": "For each query `Query k`, output one line with one integer, which is the answer to the query.", "hint": "#### Explanation of Sample 1\n\nThe first inequality added to the system is $x+1>1$, and the second is $-2x+4>3$. Therefore, in the first query, only the second inequality can be satisfied, so output `1`.\n\nThen delete the first inequality. In the next query, still only the second inequality can be satisfied, so output $1$.\n\nAfter deleting the second inequality, since the system contains no inequalities, none can be satisfied, so output $0$.\n\nContinue by adding the third inequality $8x+9>100$. When $x=k=10$, we have $8\\times 10+9=89<100$, so no inequality can be satisfied, and the output is still $0$.\n\n#### Constraints\n\n- For $20\\%$ of the data, $n\\leq 10^3$.\n- For $40\\%$ of the data, $n\\leq 10^4$.\n- For $100\\%$ of the data, $1\\leq n\\leq 10^5$, $a,b,c\\in[-10^8,10^8]$, $k\\in[-10^6,10^6]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2011] 不等式组", "background": "", "description": "旺汪与旺喵最近在做一些不等式的练习。这些不等式都是形如 $ax+b>c$ 的一元不等式。当然，解这些不等式对旺汪来说太简单了，所以旺喵想挑战旺汪。旺喵给出一组一元不等式，并给出一个数值。旺汪需要回答的是 $x=k$ 时成立的不等式的数量。聪明的旺汪每次都很快就给出了答案。你的任务是快速的验证旺汪的答案是不是正确的。", "inputFormat": "输入第一行为一个正整数 $n$，代表接下来有 $n$ 行。\n\n接下来每一行可能有 $3$ 种形式：\n\n1. `Add a b c`：表明要往不等式组添加一条不等式 $ax+b>c$。\n2. `Del i`：代表删除第 $i$ 条添加的不等式（最先添加的是第 $1$ 条）。\n3. `Query k`：代表一个询问，即当 $x=k$ 时，在当前不等式组内成立的不等式的数量。\n\n注意：一开始不等式组为空，$a,b,c,i,k$ 均为整数，且保证所有操作均合法，不会出现要求删除尚未添加的不等式的情况，但可能重复删除同一条不等式。", "outputFormat": "对于每一个询问 `Query k`，输出一行一个整数，代表询问的答案。", "hint": "#### 样例 1 说明\n\n第 $1$ 条添加到不等式组的不等式为 $x+1>1$，第 $2$ 条为 $−2x+4>3$。所以第 $1$ 个询问的时候只有第 $2$ 条不等式可以成立，故输出 `1`。\n\n然后删除第 $1$ 条不等式，再询问的时候依然是只有第 $2$ 条不等式可以成立，故输出 $1$ 。\n\n再删除第 $2$ 条不等式后，因为不等式组里面没有不等式了，所以没有不等式可以被满足，故输出 $0$。\n\n继续加入第 $3$ 条不等式 $8x+9>100$，当 $x=k=10$ 时有 $8\\times 10+9=89<100$，故也没有不等式可以被满足，依然输出 $0$。\n\n#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n\\leq 10^3$。\n- 对于 $40\\%$ 的数据，保证 $n\\leq 10^4$。\n- 对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5$，$a,b,c\\in[-10^8,10^8]$，$k\\in[-10^6,10^6]$。", "locale": "zh-CN"}}}
{"pid": "P5483", "type": "P", "difficulty": 3, "samples": [["2\n2 a\na1,b1,c1\na2,b2\n4 b\na1,b1,c1,d1\na2,b2\na3,b3,c3\na4", "a,,,b,,,\na1,b1,c1,a1,b1,c1,d1\na2,b2,,a2,b2,,\n,,,a3,b3,c3,\n,,,a4,,,"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2011", "各省省选", "吉林"], "title": "[JLOI2011] 小A的烦恼", "background": "", "description": "小$A$是$B$公司的一名$PM(product market)$。$B$公司越来越注重产品使用情况分析，而小$A$的工作就是整天对着一堆数据分析来分析去，没完没了。其中有一个操作是小$A$很头疼的，就是要把多个$csv$文件的数据拷到同一个$excel$文件中去。\n有一天小$A$满怀期待地找到了你，一个高级程序员，她想让你写程序帮她完成这个简单重复性工作。这不是坑爹吗，直接操作$excel$还要用到第三方的库，还不如直接写到$csv$文件中，让她再手动去转成$excel$文件。经过内部沟通协调，最终定下了这个方案。\n$csv$是一种$excel$可支持和格式，且存储方式非常简单。它实际上就是用“`,`”来分隔相邻的两个列。比如以下三行数据：  \n```\na,a,a\nb,,b\n,c,c\n```\n表示的就是：  \n\n| a | a | a |\n| ---------- | :----------: | :----------: |\n| b |   | b |\n|   | c | c |\n\n现在小$A$想做的就是把各个文件按照从左往右的顺序拷到同一个文件当中。比如文件$a$的数据是：  \n```\na1,b1,c1\na2,b2\n```\n文件$b$的数据是：  \n```\na1,b1,c1,d1\na2,b2\na3,b3,c3\na4\n```\n那么她所希望的最终结果是：  \n\n| a |  |  | b |  |  |  |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| a1 | b1 | c1 | a1 | b1 | c1 | d1 |\n| a2 | b2 |  | a2 | b2 |  |  |\n|  |  |  | a3 | b3 | c3 |  |\n|  |  |  | a4 |  |  |  |\n\n这个结果在$csv$文件里就是：  \n```\na,,,b,,,\na1,b1,c1,a1,b1,c1,d1\na2,b2,,a2,b2,,\n,,,a3,b3,c3,\n,,,a4,,,\n```\n以上结果的第一行是每一个文件的文件名，文件名与相应文件的第一列对齐。如果相应文件不止一列，那么其它列用空的单元格来补充。  \n输入的$csv$文件里保证了每一行的末尾都没有“`,`”，也就是说像$a$文件的第$2$行的第$3$列一样，如那一格是空的，那么在$b2$后面是没有“`,`”的。  \n输出的$csv$文件里因为是程序的输出结果，为了简化程序，如果末尾是空的，那么还是会显式输出“`,`”，如以上的结果所示。  \n输入文件保证至少有一行一列非空。  \n输出的文件要保证下一个文件的第一列要紧邻着上一文件的最后一个非空列的右面。最后一个文件只输出到最后一个非空列。   ", "inputFormat": "第一行有一个整数$N$（$1\\leq N\\leq 100$），表示有$N$个文件。  \n以下$N$个数据块的第一行有一个整数$M$ ($1\\leq M\\leq 100$)和一个字符串$S$ ($1\\leq length(S)\\leq 100$)，M表示文件的行数，$S$表示文件名。  \n$N$个数据块的下面$M$行中，每一行是一个字符串$T$($1\\leq length(T)\\leq 100$)，$T$只包含小写字母、数字和“`,`”。  ", "outputFormat": "输出把$N$个文件的数据合到一个文件的结果。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2011] Little A's Trouble", "background": "", "description": "Little $A$ is a PM (product market) at company $B$. Company $B$ is paying more and more attention to analyzing product usage, and Little $A$'s job is to stare at piles of data all day and analyze them over and over again, endlessly. One operation that gives Little $A$ a big headache is copying data from multiple $csv$ files into the same $excel$ file.\n\nOne day, Little $A$ came to you with great expectations. As a senior programmer, she wants you to write a program to help her complete this simple, repetitive task. But that is troublesome: directly operating on $excel$ requires third-party libraries. It is better to write directly into a $csv$ file and let her manually convert it into an $excel$ file later. After internal communication and coordination, this plan was finally chosen.\n\n$csv$ is a format supported by $excel$, and its storage is very simple. It uses “,” to separate two adjacent columns. For example, the following three lines of data:\n```\na,a,a\nb,,b\n,c,c\n```\nrepresent:\n\n| a | a | a |\n| ---------- | :----------: | :----------: |\n| b |   | b |\n|   | c | c |\n\nNow, what Little $A$ wants to do is to copy each file into the same file from left to right. For example, file $a$ contains:\n```\na1,b1,c1\na2,b2\n```\nand file $b$ contains:\n```\na1,b1,c1,d1\na2,b2\na3,b3,c3\na4\n```\nThen the final result she wants is:\n\n| a |  |  | b |  |  |  |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| a1 | b1 | c1 | a1 | b1 | c1 | d1 |\n| a2 | b2 |  | a2 | b2 |  |  |\n|  |  |  | a3 | b3 | c3 |  |\n|  |  |  | a4 |  |  |  |\n\nIn a $csv$ file, this result is:\n```\na,,,b,,,\na1,b1,c1,a1,b1,c1,d1\na2,b2,,a2,b2,,\n,,,a3,b3,c3,\n,,,a4,,,\n```\nThe first line of the result above is the file name of each file. Each file name is aligned with the first column of its corresponding file. If the corresponding file has more than one column, the other columns are filled with empty cells.\n\nThe input $csv$ files guarantee that there is no “,” at the end of any line. That is, like the third column in the second line of file $a$: if that cell is empty, then there is no “,” after `b2`.\n\nSince the output $csv$ file is produced by a program, to simplify the program, if the end is empty, it will still explicitly output “,”, as shown in the result above.\n\nThe input guarantees that there is at least one non-empty row and one non-empty column.\n\nIn the output file, the first column of the next file must be immediately to the right of the last non-empty column of the previous file. The last file should only be output up to its last non-empty column.", "inputFormat": "The first line contains an integer $N$ ($1 \\leq N \\leq 100$), meaning there are $N$ files.\n\nFor each of the following $N$ data blocks, the first line contains an integer $M$ ($1 \\leq M \\leq 100$) and a string $S$ ($1 \\leq length(S) \\leq 100$). $M$ is the number of rows in the file, and $S$ is the file name.\n\nIn each data block, the next $M$ lines each contain a string $T$ ($1 \\leq length(T) \\leq 100$). $T$ only contains lowercase letters, digits, and “,”.", "outputFormat": "Output the result of merging the data from the $N$ files into one file.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2011] 小A的烦恼", "background": "", "description": "小$A$是$B$公司的一名$PM(product market)$。$B$公司越来越注重产品使用情况分析，而小$A$的工作就是整天对着一堆数据分析来分析去，没完没了。其中有一个操作是小$A$很头疼的，就是要把多个$csv$文件的数据拷到同一个$excel$文件中去。\n有一天小$A$满怀期待地找到了你，一个高级程序员，她想让你写程序帮她完成这个简单重复性工作。这不是坑爹吗，直接操作$excel$还要用到第三方的库，还不如直接写到$csv$文件中，让她再手动去转成$excel$文件。经过内部沟通协调，最终定下了这个方案。\n$csv$是一种$excel$可支持和格式，且存储方式非常简单。它实际上就是用“`,`”来分隔相邻的两个列。比如以下三行数据：  \n```\na,a,a\nb,,b\n,c,c\n```\n表示的就是：  \n\n| a | a | a |\n| ---------- | :----------: | :----------: |\n| b |   | b |\n|   | c | c |\n\n现在小$A$想做的就是把各个文件按照从左往右的顺序拷到同一个文件当中。比如文件$a$的数据是：  \n```\na1,b1,c1\na2,b2\n```\n文件$b$的数据是：  \n```\na1,b1,c1,d1\na2,b2\na3,b3,c3\na4\n```\n那么她所希望的最终结果是：  \n\n| a |  |  | b |  |  |  |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| a1 | b1 | c1 | a1 | b1 | c1 | d1 |\n| a2 | b2 |  | a2 | b2 |  |  |\n|  |  |  | a3 | b3 | c3 |  |\n|  |  |  | a4 |  |  |  |\n\n这个结果在$csv$文件里就是：  \n```\na,,,b,,,\na1,b1,c1,a1,b1,c1,d1\na2,b2,,a2,b2,,\n,,,a3,b3,c3,\n,,,a4,,,\n```\n以上结果的第一行是每一个文件的文件名，文件名与相应文件的第一列对齐。如果相应文件不止一列，那么其它列用空的单元格来补充。  \n输入的$csv$文件里保证了每一行的末尾都没有“`,`”，也就是说像$a$文件的第$2$行的第$3$列一样，如那一格是空的，那么在$b2$后面是没有“`,`”的。  \n输出的$csv$文件里因为是程序的输出结果，为了简化程序，如果末尾是空的，那么还是会显式输出“`,`”，如以上的结果所示。  \n输入文件保证至少有一行一列非空。  \n输出的文件要保证下一个文件的第一列要紧邻着上一文件的最后一个非空列的右面。最后一个文件只输出到最后一个非空列。   ", "inputFormat": "第一行有一个整数$N$（$1\\leq N\\leq 100$），表示有$N$个文件。  \n以下$N$个数据块的第一行有一个整数$M$ ($1\\leq M\\leq 100$)和一个字符串$S$ ($1\\leq length(S)\\leq 100$)，M表示文件的行数，$S$表示文件名。  \n$N$个数据块的下面$M$行中，每一行是一个字符串$T$($1\\leq length(T)\\leq 100$)，$T$只包含小写字母、数字和“`,`”。  ", "outputFormat": "输出把$N$个文件的数据合到一个文件的结果。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5484", "type": "P", "difficulty": 5, "samples": [["10 3\nCTAGTAGAAG\nTCC", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "高精度", "2011", "各省省选", "吉林"], "title": "[JLOI2011] 基因补全", "background": "", "description": "在生物课中我们学过，碱基组成了$DNA$（脱氧核糖核酸），他们分别可以用大写字母$A,C,T,G$表示，其中$A$总与$T$配对，$C$总与$G$配对。两个碱基序列能相互匹配，当且仅当它们等长，并且任意相同位置的碱基都是能相互配对的。例如$ACGTC$能且仅能与$TGCAG$配对。一个相对短的碱基序列能通过往该序列中任意位置补足碱基来与一个相对长的碱基序列配对。补全碱基的位置、数量不同，都将视为不同的补全方案。现在有两串碱基序列$S$和$T$，分别有$n$和$m$个碱基($n\\geq m$)，问一共有多少种补全方案。", "inputFormat": "数据包括三行。\n第一行有两个整数$n$，$m$，表示碱基序列的长度。\n第二行包含$n$个字符，表示碱基序列$S$。\n第三行包含$m$个字符，表示碱基序列$T$。\n两个碱基序列的字符种类只有$A,C,G,T$这$4$个大写字母。", "outputFormat": "答案只包含一行，表示补全方案的个数。", "hint": "样例解释：  \n$TCC$的$4$种补全方案（括号中字符为补全的碱基）  \n$(GA)TC(AT)C(TTC)$  \n$(GA)TC(ATCTT)C$  \n$(GA)T(CAT)C(TT)C$  \n$(GATCA)TC(TT)C$  \n\n数据范围：  \n对于$30\\% $数据，$n\\leq 1000,m\\leq 2$  \n对于$50\\% $数据，$n\\leq 1000,m\\leq 4$  \n对于$100\\% $数据，$n\\leq 2000,m\\leq n$  ", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2011] Gene Completion", "background": "", "description": "In biology class, we learned that bases make up $DNA$ (deoxyribonucleic acid). They can be represented by the uppercase letters $A, C, T, G$, where $A$ always pairs with $T$, and $C$ always pairs with $G$. Two base sequences can match each other if and only if they have the same length, and at every position, the two bases can pair with each other. For example, $ACGTC$ can and only can pair with $TGCAG$.\n\nA relatively shorter base sequence can be made to pair with a relatively longer base sequence by inserting bases at any positions in the shorter sequence. Different insertion positions or different numbers of inserted bases are considered different completion plans.\n\nNow you are given two base sequences $S$ and $T$, with lengths $n$ and $m$ respectively ($n \\geq m$). Find how many completion plans there are in total.", "inputFormat": "The input has three lines.  \nThe first line contains two integers $n$ and $m$, representing the lengths of the base sequences.  \nThe second line contains $n$ characters, representing the base sequence $S$.  \nThe third line contains $m$ characters, representing the base sequence $T$.  \nThe characters in both sequences are only the $4$ uppercase letters $A, C, G, T$.", "outputFormat": "Output one line containing the number of completion plans.", "hint": "Sample explanation:  \nThe $4$ completion plans for $TCC$ (characters in parentheses are the inserted bases):  \n$(GA)TC(AT)C(TTC)$  \n$(GA)TC(ATCTT)C$  \n$(GA)T(CAT)C(TT)C$  \n$(GATCA)TC(TT)C$  \n\nConstraints:  \nFor $30\\%$ of the testdata, $n \\leq 1000, m \\leq 2$.  \nFor $50\\%$ of the testdata, $n \\leq 1000, m \\leq 4$.  \nFor $100\\%$ of the testdata, $n \\leq 2000, m \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2011] 基因补全", "background": "", "description": "在生物课中我们学过，碱基组成了$DNA$（脱氧核糖核酸），他们分别可以用大写字母$A,C,T,G$表示，其中$A$总与$T$配对，$C$总与$G$配对。两个碱基序列能相互匹配，当且仅当它们等长，并且任意相同位置的碱基都是能相互配对的。例如$ACGTC$能且仅能与$TGCAG$配对。一个相对短的碱基序列能通过往该序列中任意位置补足碱基来与一个相对长的碱基序列配对。补全碱基的位置、数量不同，都将视为不同的补全方案。现在有两串碱基序列$S$和$T$，分别有$n$和$m$个碱基($n\\geq m$)，问一共有多少种补全方案。", "inputFormat": "数据包括三行。\n第一行有两个整数$n$，$m$，表示碱基序列的长度。\n第二行包含$n$个字符，表示碱基序列$S$。\n第三行包含$m$个字符，表示碱基序列$T$。\n两个碱基序列的字符种类只有$A,C,G,T$这$4$个大写字母。", "outputFormat": "答案只包含一行，表示补全方案的个数。", "hint": "样例解释：  \n$TCC$的$4$种补全方案（括号中字符为补全的碱基）  \n$(GA)TC(AT)C(TTC)$  \n$(GA)TC(ATCTT)C$  \n$(GA)T(CAT)C(TT)C$  \n$(GATCA)TC(TT)C$  \n\n数据范围：  \n对于$30\\% $数据，$n\\leq 1000,m\\leq 2$  \n对于$50\\% $数据，$n\\leq 1000,m\\leq 4$  \n对于$100\\% $数据，$n\\leq 2000,m\\leq n$  ", "locale": "zh-CN"}}}
{"pid": "P5485", "type": "P", "difficulty": 4, "samples": [["100 3\n10.0 40.0\n20.0 30.0\n15.0 35.0", "14.29 85.71 612"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2010", "各省省选", "吉林"], "title": "[JLOI2010] 铁人双项比赛", "background": null, "description": "铁人双项比赛是吉林教育学院的一项传统体育项目。该项目比赛由长跑和骑自行车组成，参赛选手必须先完成 $k$ 公里的长跑，然后完成r公里的骑车，才能到达终点。每个参赛选手所擅长的项目不同，有的擅长长跑，有的擅长骑车。如果总赛程 $s=k+r$ 一定，那么 $k$ 越大，对擅长长跑的选手越有利；$k$ 越小，对擅长骑车的选手越有利。\n \n现在给定总赛程 $s$，以及每个选手长跑和骑车的平均速度，请你求出对于某个指定的选手最有利的 $k$ 和 $r$。所谓最有利，是指选择了这个 $k$ 和 $r$ 后，该选手可以获得冠军，且领先第 $2$ 名尽量地多。", "inputFormat": "你的程序从文件读入输入数据。\n输入的第一行是两个正整数 $s$ 和 $n$，$s$ 表示总赛程（单位为公里，$s\\leq 2^{31}$），$n$ 表示参赛总人数（$2\\leq n\\leq 100$）。\n接下来的 $n$ 行每行是两个实数，分别表示每个选手长跑的平均速度和骑车的平均速度（单位为千米/小时）。\n第 $n$ 个选手就是指定的选手，你的任务是求出对他最有利的 $k$ 和 $r$。", "outputFormat": "你的程序的输出包括三个数 $k,r,t$，分别表示对第 $n$ 号选手最有利的 $k$ 和 $r$（浮点数，保留小数点后 $2$ 位），以及在选择 $k$ 和 $r$ 的情况下，第 $n$ 号选手最多可以领先第 $2$ 名多少秒（四舍五入到整数）；如果另一个选手和该选手并列第一，则 $t_i=0$。倘若无论选择什么 $k$，$r$ 都不能使第 $n$ 号选手获胜，则输出 ``NO``。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2010] Ironman Duathlon", "background": "", "description": "The Ironman Duathlon is a traditional sports event of Jilin Institute of Education. The race consists of long-distance running and cycling. Each contestant must first complete a $k$-kilometer run, and then complete an $r$-kilometer bike ride to reach the finish line. Different contestants are good at different events: some are better at running, while others are better at cycling. If the total distance $s=k+r$ is fixed, then the larger $k$ is, the more advantageous it is for contestants who are good at running; the smaller $k$ is, the more advantageous it is for contestants who are good at cycling.\n\nNow you are given the total distance $s$, as well as each contestant’s average speed for running and cycling. Please find the values of $k$ and $r$ that are the most favorable for a specified contestant. “Most favorable” means that after choosing this $k$ and $r$, the contestant can win the championship, and the lead over the second place is as large as possible.", "inputFormat": "Your program reads input from a file.  \nThe first line contains two positive integers $s$ and $n$. $s$ is the total distance (in kilometers, $s\\leq 2^{31}$), and $n$ is the total number of contestants ($2\\leq n\\leq 100$).  \nThe next $n$ lines each contain two real numbers, representing each contestant’s average running speed and average cycling speed (in kilometers per hour).  \nThe $n$-th contestant is the specified contestant. Your task is to find the most favorable $k$ and $r$ for them.", "outputFormat": "Your program should output three numbers $k,r,t$, representing the most favorable $k$ and $r$ for contestant $n$ (floating-point numbers, rounded to $2$ decimal places), and the maximum number of seconds by which contestant $n$ can lead the second place under this choice of $k$ and $r$ (rounded to an integer). If another contestant ties with them for first place, then $t=0$. If contestant $n$ cannot win no matter what $k$ and $r$ are chosen, output ``NO``.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2010] 铁人双项比赛", "background": null, "description": "铁人双项比赛是吉林教育学院的一项传统体育项目。该项目比赛由长跑和骑自行车组成，参赛选手必须先完成 $k$ 公里的长跑，然后完成r公里的骑车，才能到达终点。每个参赛选手所擅长的项目不同，有的擅长长跑，有的擅长骑车。如果总赛程 $s=k+r$ 一定，那么 $k$ 越大，对擅长长跑的选手越有利；$k$ 越小，对擅长骑车的选手越有利。\n \n现在给定总赛程 $s$，以及每个选手长跑和骑车的平均速度，请你求出对于某个指定的选手最有利的 $k$ 和 $r$。所谓最有利，是指选择了这个 $k$ 和 $r$ 后，该选手可以获得冠军，且领先第 $2$ 名尽量地多。", "inputFormat": "你的程序从文件读入输入数据。\n输入的第一行是两个正整数 $s$ 和 $n$，$s$ 表示总赛程（单位为公里，$s\\leq 2^{31}$），$n$ 表示参赛总人数（$2\\leq n\\leq 100$）。\n接下来的 $n$ 行每行是两个实数，分别表示每个选手长跑的平均速度和骑车的平均速度（单位为千米/小时）。\n第 $n$ 个选手就是指定的选手，你的任务是求出对他最有利的 $k$ 和 $r$。", "outputFormat": "你的程序的输出包括三个数 $k,r,t$，分别表示对第 $n$ 号选手最有利的 $k$ 和 $r$（浮点数，保留小数点后 $2$ 位），以及在选择 $k$ 和 $r$ 的情况下，第 $n$ 号选手最多可以领先第 $2$ 名多少秒（四舍五入到整数）；如果另一个选手和该选手并列第一，则 $t_i=0$。倘若无论选择什么 $k$，$r$ 都不能使第 $n$ 号选手获胜，则输出 ``NO``。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5486", "type": "P", "difficulty": 5, "samples": [["10 7\nXXXXXXX\nXOXXXXO\nXOXXXXO\nXOXXXOX\nOXXOXOX\nXOXOXOX\nOXXOXOX\nOXXXXOX\nXXXXXXX\nXXXXXXX\n2 9\n0 0", "Case 1:\n\nB: 2-5\nF: 5-9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2010", "各省省选", "吉林", "区间 DP"], "title": "[JLOI2010] 世界杯租房", "background": null, "description": "南非世界杯组委会指定了在此期间可提供的一些旅馆供球迷租赁，名为阿凡达的即是其中一所。因为阿凡达旅馆房子的数目不超过 $26$，所以它们可以用 $26$ 个大写字母表示。  \n有一天，刘经理的电话响了，他接到了一个租赁房屋的请求，要求从 $6$ 月 $12$ 日晚起租到 $6$ 月 $19$ 日中午。于是他查看了预定表，但是并没有发现一间房屋能够直接满足要求。比如房主可能因为一些私人原因需要留在自己的房子中，所以这个游客不得不在其中的一间先住上几天再搬到另一间住上几天。他详细检查了预定表后，对旅客说：“我将你先在 $B$ 安置 $3$ 天，再将你安排到 $F$ 去度过剩余的旅途。”  \n你的目标是使得游客从一间房屋搬到另一间房屋的次数最少。  \n注意在旅馆的计费中，总是将某一天的晚上到第二天的中午视作一天。", "inputFormat": "输入文件包括多组数据。每组数据输入文件第一行包括两个整数 $M$ 和 $N$。$M$ 表示日程表上的天数，$N$ 表示公寓的数目。天数不超过 $100$ 天，从 $1$ 开始计数，公寓不超过 $26$ 个，从 $A$ 开始计数。  \n\n接下来 $M$ 行，每行包括 $N$ 个字母，表示从第i天晚到次日中午，该公寓是否已经被出租，$X$ 代表被出租，$O$ 代表未被出租。  \n\n最后一行包括两个整数 $s,t$，代表旅客从第 $s$ 天晚入住到第 $ (t+1) $ 天中午结束旅行。$1\\leq s<t\\leq M+1$。  \n$M=N=0$ 标志着文件的结束。", "outputFormat": "对于每一组数据，首先打印测试数据的编号，冒号和一个空行。接下来输出换房次数最少的方案，每一行使用如下格式：\n\n`<unit>: <start date>-<end date>`\n\n其中 `<unit>` 为房屋编号，`<start date>` 和 `<end date>` 分别为该旅客入住和离开该房屋时间。\n\n注意，如果存在多种方案满足换房次数最少，输出其中字典序最小的方案。\n\n如不存在这样的方案，输出一行“$\\texttt{Not available}$”。\n\n每两组输出之间以一个空行隔开。输出文件的末尾不要加空行。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2010] World Cup House Rental", "background": "", "description": "The South Africa World Cup organizing committee designated some hotels that could provide rooms for fans to rent during this period, and one of them is called Avatar. Since the number of rooms in the Avatar hotel does not exceed $26$, they can be represented by $26$ uppercase letters.  \nOne day, Manager Liu’s phone rang. He received a request to rent a room from the night of June 12 to noon of June 19. He checked the reservation table, but did not find any single room that could satisfy the request directly. For example, the owner might need to stay in their own room for personal reasons, so the tourist has to stay in one room for a few days and then move to another room for the remaining days. After carefully checking the reservation table, he told the traveler: “I will place you in $B$ for $3$ days first, and then arrange you to stay in $F$ for the rest of the trip.”  \nYour goal is to minimize the number of times the traveler needs to move from one room to another.  \nNote that in the hotel’s billing, the time from one night to the next day at noon is always counted as one day.", "inputFormat": "The input contains multiple test cases. For each test case, the first line contains two integers $M$ and $N$. $M$ is the number of days on the schedule, and $N$ is the number of units (rooms). The number of days does not exceed $100$, counted starting from $1$. The number of units does not exceed $26$, labeled starting from $A$.  \n\nThe next $M$ lines each contain $N$ letters, indicating whether the unit has already been rented from the night of day $i$ to noon of the next day. `X` means rented, and `O` means not rented.  \n\nThe last line contains two integers $s, t$, meaning the traveler checks in on the night of day $s$ and ends the trip at noon of day $(t+1)$. $1\\leq s<t\\leq M+1$.  \n$M=N=0$ indicates the end of the file.", "outputFormat": "For each test case, first print the testdata number, followed by a colon and a blank line. Then output a plan with the minimum number of room changes, using the following format on each line:\n\n`<unit>: <start date>-<end date>`\n\nHere, `<unit>` is the unit label, and `<start date>` and `<end date>` are the times when the traveler moves into and leaves that unit, respectively.\n\nNote that if there are multiple plans with the minimum number of room changes, output the lexicographically smallest plan.\n\nIf no such plan exists, output one line: `Not available`.\n\nPrint a blank line between every two test cases. Do not add an extra blank line at the end of the output.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2010] 世界杯租房", "background": null, "description": "南非世界杯组委会指定了在此期间可提供的一些旅馆供球迷租赁，名为阿凡达的即是其中一所。因为阿凡达旅馆房子的数目不超过 $26$，所以它们可以用 $26$ 个大写字母表示。  \n有一天，刘经理的电话响了，他接到了一个租赁房屋的请求，要求从 $6$ 月 $12$ 日晚起租到 $6$ 月 $19$ 日中午。于是他查看了预定表，但是并没有发现一间房屋能够直接满足要求。比如房主可能因为一些私人原因需要留在自己的房子中，所以这个游客不得不在其中的一间先住上几天再搬到另一间住上几天。他详细检查了预定表后，对旅客说：“我将你先在 $B$ 安置 $3$ 天，再将你安排到 $F$ 去度过剩余的旅途。”  \n你的目标是使得游客从一间房屋搬到另一间房屋的次数最少。  \n注意在旅馆的计费中，总是将某一天的晚上到第二天的中午视作一天。", "inputFormat": "输入文件包括多组数据。每组数据输入文件第一行包括两个整数 $M$ 和 $N$。$M$ 表示日程表上的天数，$N$ 表示公寓的数目。天数不超过 $100$ 天，从 $1$ 开始计数，公寓不超过 $26$ 个，从 $A$ 开始计数。  \n\n接下来 $M$ 行，每行包括 $N$ 个字母，表示从第i天晚到次日中午，该公寓是否已经被出租，$X$ 代表被出租，$O$ 代表未被出租。  \n\n最后一行包括两个整数 $s,t$，代表旅客从第 $s$ 天晚入住到第 $ (t+1) $ 天中午结束旅行。$1\\leq s<t\\leq M+1$。  \n$M=N=0$ 标志着文件的结束。", "outputFormat": "对于每一组数据，首先打印测试数据的编号，冒号和一个空行。接下来输出换房次数最少的方案，每一行使用如下格式：\n\n`<unit>: <start date>-<end date>`\n\n其中 `<unit>` 为房屋编号，`<start date>` 和 `<end date>` 分别为该旅客入住和离开该房屋时间。\n\n注意，如果存在多种方案满足换房次数最少，输出其中字典序最小的方案。\n\n如不存在这样的方案，输出一行“$\\texttt{Not available}$”。\n\n每两组输出之间以一个空行隔开。输出文件的末尾不要加空行。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5487", "type": "P", "difficulty": 7, "samples": [["4 10\n1 1 2 3\n", "1 1 \n89\n"], ["5 10\n3 7 27 95 339", "3 2\n691707\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "线性递推", "Berlekamp-Massey(BM) 算法", "模板题"], "title": "【模板】Berlekamp–Massey 算法", "background": "前置技能：线性递推 $\\&~\\rm BM$ 算法。\n\n同时，请注意优化你的空间。保证最短递推式**唯一**。\n\n出题人为强行二合一感到很抱歉，但是其实也是可以学习一下 $k^2 \\log n$ 线性递推的——保证在 `-O2` 指令下可以过。", "description": "给出一个数列 $P$ 从 $0$ 开始的前 $n$ 项。\n\n求序列 $P$ 在 $\\bmod~998244353$ 下的最短线性递推式，并在 $\\bmod~998244353$ 下输出 $P_m$。", "inputFormat": "第一行共两个数 $n,m$ ，表示将会给出序列 $P$ 的前 $n$ 项，要求 $P_m$。\n\n第二行 $n$ 个数，表示 $P_0,P_1,P_2,\\ldots,P_{n-1}$。", "outputFormat": "第一行输出该最短线性递推式。\n\n第二行输出 $P_m$ 的值。", "hint": "对于 $100 \\%$ 的数据，$n < m \\le {10}^9$，$1 \\le n \\le 10000$，保证递推式最长不超过 $5000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Berlekamp–Massey Algorithm", "background": "Prerequisite skills: linear recurrence and the $\\&~\\rm BM$ algorithm.\n\nAlso, please pay attention to optimizing your memory usage. The shortest recurrence is guaranteed to be **unique**.\n\nThe problem setter apologizes for forcing two tasks into one, but this is also a chance to learn the $k^2 \\log n$ method for linear recurrences. It is guaranteed to pass under the `-O2` option.", "description": "You are given the first $n$ terms of a sequence $P$ starting from index $0$.\n\nFind the shortest linear recurrence of sequence $P$ modulo $998244353$, and output $P_m$ modulo $998244353$.", "inputFormat": "The first line contains two integers $n,m$, meaning that the first $n$ terms of sequence $P$ will be given, and you need to compute $P_m$.\n\nThe second line contains $n$ integers, which are $P_0,P_1,P_2,\\ldots,P_{n-1}$.", "outputFormat": "On the first line, output the shortest linear recurrence.\n\nOn the second line, output the value of $P_m$.", "hint": "For $100\\%$ of the testdata, $n < m \\le 10^9$, $1 \\le n \\le 10000$, and the length of the recurrence is guaranteed to be at most $5000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】Berlekamp–Massey 算法", "background": "前置技能：线性递推 $\\&~\\rm BM$ 算法。\n\n同时，请注意优化你的空间。保证最短递推式**唯一**。\n\n出题人为强行二合一感到很抱歉，但是其实也是可以学习一下 $k^2 \\log n$ 线性递推的——保证在 `-O2` 指令下可以过。", "description": "给出一个数列 $P$ 从 $0$ 开始的前 $n$ 项。\n\n求序列 $P$ 在 $\\bmod~998244353$ 下的最短线性递推式，并在 $\\bmod~998244353$ 下输出 $P_m$。", "inputFormat": "第一行共两个数 $n,m$ ，表示将会给出序列 $P$ 的前 $n$ 项，要求 $P_m$。\n\n第二行 $n$ 个数，表示 $P_0,P_1,P_2,\\ldots,P_{n-1}$。", "outputFormat": "第一行输出该最短线性递推式。\n\n第二行输出 $P_m$ 的值。", "hint": "对于 $100 \\%$ 的数据，$n < m \\le {10}^9$，$1 \\le n \\le 10000$，保证递推式最长不超过 $5000$。", "locale": "zh-CN"}}}
{"pid": "P5488", "type": "P", "difficulty": 6, "samples": [["8 3 0\n1 9 2 6 0 8 1 7", "1 12 35 76 135 220 332 478 "], ["8 3 1\n1 9 2 6 0 8 1 7", "1 6 1004535787 26 1004535788 24 1004535780 28"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "差分与前缀和", "background": "", "description": "给定一个长为 $n$ 的序列 $a$，求出其 $k$ 阶差分或前缀和。    \n结果的每一项都需要对 $1004535809$ 取模。", "inputFormat": "第一行三个整数 $n,k,t$，若 $t=0$ 表示求前缀和，$t=1$ 表示求差分。  \n第二行 $n$ 个整数，表示序列 $a$。", "outputFormat": "输出一行 $n$ 个整数，表示 $a$ 的 $k$ 阶差分或前缀和。", "hint": "【数据范围】  \n\n$1 \\le n \\le 10^5$  \n$0 \\le a_i \\le 10^9$   \n$1\\le k \\le 10^{2333}, k \\not \\equiv 0 \\pmod{1004535809}$", "locale": "zh-CN", "translations": {"en": {"title": "Difference and Prefix Sum", "background": "", "description": "Given a sequence $a$ of length $n$, find its $k$-th order difference or prefix sum.  \nEach term of the result needs to be taken modulo $1004535809$.", "inputFormat": "The first line contains three integers $n, k, t$. If $t = 0$, compute the prefix sum; if $t = 1$, compute the difference.  \nThe second line contains $n$ integers representing the sequence $a$.", "outputFormat": "Output one line with $n$ integers, representing the $k$-th order difference or prefix sum of $a$.", "hint": "Constraints  \n\n$1 \\le n \\le 10^5$  \n$0 \\le a_i \\le 10^9$  \n$1 \\le k \\le 10^{2333}, k \\not \\equiv 0 \\pmod{1004535809}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "差分与前缀和", "background": "", "description": "给定一个长为 $n$ 的序列 $a$，求出其 $k$ 阶差分或前缀和。    \n结果的每一项都需要对 $1004535809$ 取模。", "inputFormat": "第一行三个整数 $n,k,t$，若 $t=0$ 表示求前缀和，$t=1$ 表示求差分。  \n第二行 $n$ 个整数，表示序列 $a$。", "outputFormat": "输出一行 $n$ 个整数，表示 $a$ 的 $k$ 阶差分或前缀和。", "hint": "【数据范围】  \n\n$1 \\le n \\le 10^5$  \n$0 \\le a_i \\le 10^9$   \n$1\\le k \\le 10^{2333}, k \\not \\equiv 0 \\pmod{1004535809}$", "locale": "zh-CN"}}}
{"pid": "P5489", "type": "P", "difficulty": 6, "samples": [["5 10\n1 1 2\n1 2 3\n2 1 3\n3 0 1\n1 3 1\n1 1 6\n2 3 7\n1 6 7\n1 7 1\n3 3 6", "2\n2\n-1\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["洛谷原创", "树链剖分", "动态树 LCT"], "title": "EntropyIncreaser 与 动态图", "background": "话说 NaCly_Fish 在和  $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 吃饭时，问过她一个问题：“一个无向图，支持动态加边，求两点间割点数，怎么做？” \n\n$\\mathsf E \\color{red} \\mathsf{ntropyIncreaser}$ 想了几秒，说：“这不是sb题吗，随便怎么做都行吧。”然后三两句道出了一个算法。\n\n而 NaCly_Fish 还是不会，请你来教教她这题怎么做吧。", "description": "有一个 $n$ 个点的图，初始没有边。  \n有 $q$ 个操作，分为 $3$ 种，具体如下：  \n\n- `1 u v` 表示在 $u,v$ 之间连一条无向边  \n- `2 u v` 表示求 $u,v$ 间的割边数量   \n- `3 u v` 表示求 $u,v$ 间的割点数量   \n\n特别地，对于 $2$、$3$ 操作，若 $u,v$ 不连通，则输出 $-1$    \n****\n为了防止有歧义，这里给出对两点间割边和割点数量的定义：  \n对于所有包含 $u,v$ 的路径的节点集合之交 $S$ ，定义 $S$ 中的元素数量为 $u,v$ 间的割点数。  \n对于所有包含 $u,v$ 的路径的边集合之交 $T$ ，定义 $T$ 中的元素数量为 $u,v$ 间的割边数。  \n****\n**本题强制在线。**  \n从第二行开始，每次的输入的 $u,v$ 都需要异或上 $\\text{last}$ ，才是实际操作的 $u,v$。  \n $\\text{last}$ 为最近一次**答案非 $-1$ 的**询问的答案，定义初始 $\\text{last}=0$   \nps：如果您不知道异或是什么意思，可以看这里：[xor](https://www.baidu.com/link?url=bhG_De1gZYsqrIq7dkhgGj8vP87xSSyoIwk0-5p1fyKmf58cznvq0oYJg0XGoyKNpuGk7EsvjUnyvgJ19_ZA3PhoMJ3hIufHZ5GXh1OaIoS&wd=&eqid=ab26bc160004324d000000035d1ed64e)", "inputFormat": "第一行两个正整数 $n,q$，表示节点数和操作次数。   \n接下来 $q$ 行，每行三个整数，表示一次操作。   \n", "outputFormat": "对于每个$2$、$3$ 操作，输出一行一个整数表示答案。 ", "hint": "~~题目背景为真实事件~~\n\n### 样例说明：  \n实际操作为：  \n```cpp\n5 10\n1 1 2\n1 2 3\n2 1 3\n3 2 3\n1 1 3\n1 3 4\n2 1 5\n1 4 5\n1 5 3\n3 1 4\n```\n\n【数据范围】\n  \n对于 $20\\%$ 的数据，$1\\le n,q \\le 2000$ ；   \n对于另外 $30\\%$ 的数据，所有 $2$、$3$ 操作均在 $1$ 操作之后；    \n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le q \\le 3\\times 10^5$。\n    \n对于 $1$ 操作，保证 $u\\neq  v$。  \n\nBy：NaCly_Fish\n\n****\n\n欢迎加入 EI队长粉丝裙，群号：$747262201$   ", "locale": "zh-CN", "translations": {"en": {"title": "EntropyIncreaser and Dynamic Graph", "background": "It is said that when NaCly_Fish was having a meal with $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$, he asked her a question: “Given an undirected graph that supports dynamic edge insertions, how do we find the number of articulation points between two vertices?”  \n\n$\\mathsf E \\color{red} \\mathsf{ntropyIncreaser}$ thought for a few seconds and said: “Isn’t this a super easy problem? You can do it however you want.” Then she explained an algorithm in just a few sentences.\n\nBut NaCly_Fish still did not understand it. Please teach her how to solve this problem.", "description": "There is a graph with $n$ vertices, initially with no edges.  \nThere are $q$ operations, of $3$ types, as follows:\n\n- `1 u v` means adding an undirected edge between $u$ and $v$.\n- `2 u v` means querying the number of bridges between $u$ and $v$.\n- `3 u v` means querying the number of articulation points between $u$ and $v$.\n\nIn particular, for operations $2$ and $3$, if $u$ and $v$ are not connected, output $-1$.\n\n****\n\nTo avoid ambiguity, here are the definitions of the number of bridges and articulation points between two vertices:\n\nLet $S$ be the intersection of the vertex sets of all paths that contain both $u$ and $v$. Define the number of elements in $S$ as the number of articulation points between $u$ and $v$.  \nLet $T$ be the intersection of the edge sets of all paths that contain both $u$ and $v$. Define the number of elements in $T$ as the number of bridges between $u$ and $v$.\n\n****\n\n**This problem is strictly online.**  \nStarting from the second line, in each input, $u,v$ must be XORed with $\\text{last}$ to get the actual $u,v$.  \n$\\text{last}$ is the answer of the most recent query whose answer is **not $-1$**, and initially $\\text{last}=0$.  \nps: If you do not know what XOR means, see here: [xor](https://www.baidu.com/link?url=bhG_De1gZYsqrIq7dkhgGj8vP87xSSyoIwk0-5p1fyKmf58cznvq0oYJg0XGoyKNpuGk7EsvjUnyvgJ19_ZA3PhoMJ3hIufHZ5GXh1OaIoS&wd=&eqid=ab26bc160004324d000000035d1ed64e).", "inputFormat": "The first line contains two positive integers $n,q$, representing the number of vertices and the number of operations.  \nThe next $q$ lines each contain three integers, describing one operation.", "outputFormat": "For each operation of type $2$ or $3$, output one line with one integer representing the answer.", "hint": "~~The background story is a real event.~~\n\n### Sample Explanation\n\nThe actual operations are:\n```cpp\n5 10\n1 1 2\n1 2 3\n2 1 3\n3 2 3\n1 1 3\n1 3 4\n2 1 5\n1 4 5\n1 5 3\n3 1 4\n```\n\n### Constraints\n\nFor $20\\%$ of the testdata, $1\\le n,q \\le 2000$.  \nFor another $30\\%$ of the testdata, all operations of type $2$ and $3$ occur after a type $1$ operation.  \nFor $100\\%$ of the testdata, $1\\le n \\le 10^5$, $1\\le q \\le 3\\times 10^5$.\n\nFor type $1$ operations, it is guaranteed that $u\\neq v$.\n\nBy: NaCly_Fish\n\n****\n\nWelcome to join the EI Captain fan group. Group number: $747262201$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "EntropyIncreaser 与 动态图", "background": "话说 NaCly_Fish 在和  $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 吃饭时，问过她一个问题：“一个无向图，支持动态加边，求两点间割点数，怎么做？” \n\n$\\mathsf E \\color{red} \\mathsf{ntropyIncreaser}$ 想了几秒，说：“这不是sb题吗，随便怎么做都行吧。”然后三两句道出了一个算法。\n\n而 NaCly_Fish 还是不会，请你来教教她这题怎么做吧。", "description": "有一个 $n$ 个点的图，初始没有边。  \n有 $q$ 个操作，分为 $3$ 种，具体如下：  \n\n- `1 u v` 表示在 $u,v$ 之间连一条无向边  \n- `2 u v` 表示求 $u,v$ 间的割边数量   \n- `3 u v` 表示求 $u,v$ 间的割点数量   \n\n特别地，对于 $2$、$3$ 操作，若 $u,v$ 不连通，则输出 $-1$    \n****\n为了防止有歧义，这里给出对两点间割边和割点数量的定义：  \n对于所有包含 $u,v$ 的路径的节点集合之交 $S$ ，定义 $S$ 中的元素数量为 $u,v$ 间的割点数。  \n对于所有包含 $u,v$ 的路径的边集合之交 $T$ ，定义 $T$ 中的元素数量为 $u,v$ 间的割边数。  \n****\n**本题强制在线。**  \n从第二行开始，每次的输入的 $u,v$ 都需要异或上 $\\text{last}$ ，才是实际操作的 $u,v$。  \n $\\text{last}$ 为最近一次**答案非 $-1$ 的**询问的答案，定义初始 $\\text{last}=0$   \nps：如果您不知道异或是什么意思，可以看这里：[xor](https://www.baidu.com/link?url=bhG_De1gZYsqrIq7dkhgGj8vP87xSSyoIwk0-5p1fyKmf58cznvq0oYJg0XGoyKNpuGk7EsvjUnyvgJ19_ZA3PhoMJ3hIufHZ5GXh1OaIoS&wd=&eqid=ab26bc160004324d000000035d1ed64e)", "inputFormat": "第一行两个正整数 $n,q$，表示节点数和操作次数。   \n接下来 $q$ 行，每行三个整数，表示一次操作。   \n", "outputFormat": "对于每个$2$、$3$ 操作，输出一行一个整数表示答案。 ", "hint": "~~题目背景为真实事件~~\n\n### 样例说明：  \n实际操作为：  \n```cpp\n5 10\n1 1 2\n1 2 3\n2 1 3\n3 2 3\n1 1 3\n1 3 4\n2 1 5\n1 4 5\n1 5 3\n3 1 4\n```\n\n【数据范围】\n  \n对于 $20\\%$ 的数据，$1\\le n,q \\le 2000$ ；   \n对于另外 $30\\%$ 的数据，所有 $2$、$3$ 操作均在 $1$ 操作之后；    \n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le q \\le 3\\times 10^5$。\n    \n对于 $1$ 操作，保证 $u\\neq  v$。  \n\nBy：NaCly_Fish\n\n****\n\n欢迎加入 EI队长粉丝裙，群号：$747262201$   ", "locale": "zh-CN"}}}
{"pid": "P5490", "type": "P", "difficulty": 5, "samples": [["2\n100 100 200 200\n150 150 250 255\n", "18000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "离散化", "O2优化", "扫描线", "模板题"], "title": "【模板】扫描线 & 矩形面积并", "background": "", "description": "求 $n$ 个四边平行于坐标轴的矩形的面积并。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行每行四个非负整数 $x_1, y_1, x_2, y_2$，表示一个矩形的四个端点坐标为 $(x_1, y_1),(x_1, y_2),(x_2, y_2),(x_2, y_1)$。", "outputFormat": "一行一个正整数，表示 $n$ 个矩形的并集覆盖的总面积。", "hint": "对于 $20\\%$ 的数据，$1 \\le n \\le 1000$。  \n对于 $100\\%$ 的数据，$1 \\le n \\le {10}^5$，$0 \\le x_1 < x_2 \\le {10}^9$，$0 \\le y_1 < y_2 \\le {10}^9$。\n\nUpdated on 4.10 by Dengduck（口胡） \\& yummy（实现）：增加了一组数据。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Scanline & Union Area of Rectangles", "background": "", "description": "Find the union area of $n$ rectangles whose sides are parallel to the coordinate axes.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next $n$ lines each contain four non-negative integers $x_1, y_1, x_2, y_2$, indicating that the four vertices of a rectangle are $(x_1, y_1)$, $(x_1, y_2)$, $(x_2, y_2)$, $(x_2, y_1)$.", "outputFormat": "Output one positive integer in a single line, representing the total area covered by the union of the $n$ rectangles.", "hint": "For $20\\%$ of the testdata, $1 \\le n \\le 1000$.  \nFor $100\\%$ of the testdata, $1 \\le n \\le {10}^5$, $0 \\le x_1 < x_2 \\le {10}^9$, $0 \\le y_1 < y_2 \\le {10}^9$.\n\nUpdated on 4.10 by Dengduck (kouhu) \\& yummy (implementation): one more test case was added.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】扫描线 & 矩形面积并", "background": "", "description": "求 $n$ 个四边平行于坐标轴的矩形的面积并。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行每行四个非负整数 $x_1, y_1, x_2, y_2$，表示一个矩形的四个端点坐标为 $(x_1, y_1),(x_1, y_2),(x_2, y_2),(x_2, y_1)$。", "outputFormat": "一行一个正整数，表示 $n$ 个矩形的并集覆盖的总面积。", "hint": "对于 $20\\%$ 的数据，$1 \\le n \\le 1000$。  \n对于 $100\\%$ 的数据，$1 \\le n \\le {10}^5$，$0 \\le x_1 < x_2 \\le {10}^9$，$0 \\le y_1 < y_2 \\le {10}^9$。\n\nUpdated on 4.10 by Dengduck（口胡） \\& yummy（实现）：增加了一组数据。", "locale": "zh-CN"}}}
{"pid": "P5491", "type": "P", "difficulty": 6, "samples": [["3\n5 1000000009\n4 1000000009\n0 19260817", "383008016 616991993\n2 1000000007\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["二次剩余", "模板题"], "title": "【模板】二次剩余", "background": null, "description": "给出 $N,p$，求解方程 \n\n$$\nx^2 \\equiv N \\pmod{p}\n$$\n\n多组数据，**且保证 $p$ 是奇素数。**", "inputFormat": "第 $1$ 行，一个整数 $T$ 表示数据组数。\n\n第 $2\\sim T+1$ 行，每行两个整数 $N$ 和 $p$，含义详见题目描述。", "outputFormat": "输出共 $T$ 行。\n\n对于每一行输出，若有解，则按 $\\bmod ~p$ 后递增的顺序输出在 $\\bmod~ p$ 意义下的全部解；若两解相同，只输出其中一个；若无解，则输出 `Hola!` 。", "hint": "对于 $100\\%$ 的数据，$1\\leq T\\leq 10^4$，$0\\le N, p\\leq 10^9+9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Quadratic Residue", "background": "", "description": "Given $N, p$, solve the equation\n\n$$\nx^2 \\equiv N \\pmod{p}\n$$\n\nThere are multiple test cases, **and it is guaranteed that $p$ is an odd prime.**", "inputFormat": "Line $1$ contains an integer $T$, which indicates the number of test cases.\n\nLines $2$ to $T + 1$ each contain two integers $N$ and $p$. Their meanings are described in the statement.", "outputFormat": "Output a total of $T$ lines.\n\nFor each line of output, if there is a solution, output all solutions modulo $p$ in increasing order after taking $\\bmod~ p$. If the two solutions are the same, output only one of them. If there is no solution, output `Hola!`.", "hint": "For $100\\%$ of the testdata, $1 \\le T \\le 10^4$, $0 \\le N, p \\le 10^9 + 9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】二次剩余", "background": null, "description": "给出 $N,p$，求解方程 \n\n$$\nx^2 \\equiv N \\pmod{p}\n$$\n\n多组数据，**且保证 $p$ 是奇素数。**", "inputFormat": "第 $1$ 行，一个整数 $T$ 表示数据组数。\n\n第 $2\\sim T+1$ 行，每行两个整数 $N$ 和 $p$，含义详见题目描述。", "outputFormat": "输出共 $T$ 行。\n\n对于每一行输出，若有解，则按 $\\bmod ~p$ 后递增的顺序输出在 $\\bmod~ p$ 意义下的全部解；若两解相同，只输出其中一个；若无解，则输出 `Hola!` 。", "hint": "对于 $100\\%$ 的数据，$1\\leq T\\leq 10^4$，$0\\le N, p\\leq 10^9+9$。", "locale": "zh-CN"}}}
{"pid": "P5492", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2\n2 3", "665496236"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2018", "记忆化搜索", "概率论", "状压 DP"], "title": "[PKUWC2018] 随机算法", "background": "", "description": "我们知道，求任意图的最大独立集是一类NP完全问题，目前还没有准确的多项式算法，但是有许多多项式复杂度的近似算法。\n\n例如，小 C 常用的一种算法是：\n\n1. 对于一个 $n$ 个点的无向图，先等概率随机一个 $1\\ldots n$ 的排列 $p[1\\ldots n]$。\n\n2. 维护答案集合 $S$ ，一开始 $S$ 为空集，之后按照 $i=1\\ldots n$ 的顺序，检查 $\\{p[i]\\}\\cup S$ 是否是一个独立集，如果是的话就令 $S=\\{p[i]\\}\\cup S$。\n\n3. 最后得到一个独立集 $S$ 作为答案。\n\n小 C 现在想知道，对于给定的一张图，这个算法的正确率，输出答案对 $998244353$ 取模。", "inputFormat": "第一行两个非负整数 $n,m$ 表示给定的图的点数和边数。\n\n接下来 $m$ 行，每行有两个正整数 $(u,v) (u\\neq v)$ 描述这张图的一条无向边。", "outputFormat": "输出正确率，答案对 $998244353$ 取模。", "hint": "#### 样例解释\n这张图的最大独立集显然为 $2$，可以发现只有 $p[1]=2$ 时会得出 $S=\\{2\\}$，否则都是 $S=\\{1,3\\}$，所以答案是 $\\frac{2}{3}$。\n\n\n#### 数据范围\n对于 $10\\%$ 的数据，有$1\\leq n\\leq 9$。\n\n对于 $30\\%$ 的数据，有$1\\leq n\\leq 13$。\n\n对于 $50\\%$ 的数据，有$1\\leq n\\leq 17$。\n\n另有 $10\\%$ 的数据，满足给定的图是一条链。\n\n另有 $10\\%$ 的数据，满足给定的图是一棵树。\n\n对于 $100\\%$ 的数据，有$1\\leq n\\leq 20$，$0\\leq m\\leq \\frac{n\\times (n-1)}{2}$，保证给定的图没有重边和自环。", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Randomized Algorithm", "background": "", "description": "We know that finding the maximum independent set of an arbitrary graph is an NP-complete problem. Currently, there is no exact polynomial-time algorithm, but there are many polynomial-time approximation algorithms.\n\nFor example, one algorithm often used by Little C is:\n\n1. For an undirected graph with $n$ vertices, first uniformly randomly generate a permutation $p[1\\ldots n]$ of $1\\ldots n$.\n\n2. Maintain an answer set $S$. Initially, $S$ is empty. Then, in the order $i=1\\ldots n$, check whether $\\{p[i]\\}\\cup S$ is an independent set. If it is, set $S=\\{p[i]\\}\\cup S$.\n\n3. Finally, obtain an independent set $S$ as the answer.\n\nNow Little C wants to know, for a given graph, the probability that this algorithm is correct. Output the answer modulo $998244353$.", "inputFormat": "The first line contains two non-negative integers $n,m$, representing the number of vertices and edges of the given graph.\n\nThe next $m$ lines each contain two positive integers $(u,v)$ $(u\\neq v)$, describing an undirected edge of the graph.", "outputFormat": "Output the probability of being correct, modulo $998244353$.", "hint": "#### Sample Explanation\n\nThe maximum independent set size of this graph is clearly $2$. It can be seen that only when $p[1]=2$ will we get $S=\\{2\\}$; otherwise, we always get $S=\\{1,3\\}$. Therefore, the answer is $\\frac{2}{3}$.\n\n#### Constraints\n\nFor $10\\%$ of the testdata, $1\\leq n\\leq 9$.\n\nFor $30\\%$ of the testdata, $1\\leq n\\leq 13$.\n\nFor $50\\%$ of the testdata, $1\\leq n\\leq 17$.\n\nAnother $10\\%$ of the testdata satisfies that the given graph is a path.\n\nAnother $10\\%$ of the testdata satisfies that the given graph is a tree.\n\nFor $100\\%$ of the testdata, $1\\leq n\\leq 20$, $0\\leq m\\leq \\frac{n\\times (n-1)}{2}$. It is guaranteed that the given graph has no multiple edges and no self-loops.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] 随机算法", "background": "", "description": "我们知道，求任意图的最大独立集是一类NP完全问题，目前还没有准确的多项式算法，但是有许多多项式复杂度的近似算法。\n\n例如，小 C 常用的一种算法是：\n\n1. 对于一个 $n$ 个点的无向图，先等概率随机一个 $1\\ldots n$ 的排列 $p[1\\ldots n]$。\n\n2. 维护答案集合 $S$ ，一开始 $S$ 为空集，之后按照 $i=1\\ldots n$ 的顺序，检查 $\\{p[i]\\}\\cup S$ 是否是一个独立集，如果是的话就令 $S=\\{p[i]\\}\\cup S$。\n\n3. 最后得到一个独立集 $S$ 作为答案。\n\n小 C 现在想知道，对于给定的一张图，这个算法的正确率，输出答案对 $998244353$ 取模。", "inputFormat": "第一行两个非负整数 $n,m$ 表示给定的图的点数和边数。\n\n接下来 $m$ 行，每行有两个正整数 $(u,v) (u\\neq v)$ 描述这张图的一条无向边。", "outputFormat": "输出正确率，答案对 $998244353$ 取模。", "hint": "#### 样例解释\n这张图的最大独立集显然为 $2$，可以发现只有 $p[1]=2$ 时会得出 $S=\\{2\\}$，否则都是 $S=\\{1,3\\}$，所以答案是 $\\frac{2}{3}$。\n\n\n#### 数据范围\n对于 $10\\%$ 的数据，有$1\\leq n\\leq 9$。\n\n对于 $30\\%$ 的数据，有$1\\leq n\\leq 13$。\n\n对于 $50\\%$ 的数据，有$1\\leq n\\leq 17$。\n\n另有 $10\\%$ 的数据，满足给定的图是一条链。\n\n另有 $10\\%$ 的数据，满足给定的图是一棵树。\n\n对于 $100\\%$ 的数据，有$1\\leq n\\leq 20$，$0\\leq m\\leq \\frac{n\\times (n-1)}{2}$，保证给定的图没有重边和自环。", "locale": "zh-CN"}}}
{"pid": "P5493", "type": "P", "difficulty": 6, "samples": [["10 3 1000000007", "1458"], ["100000 0 1000000007", "941229402"], ["100000 10 1000000007", "446053671"]], "limits": {"time": [1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "素数判断,质数,筛法"], "title": "质数前缀统计", "background": "这是洲阁筛和 Min_25 筛的重要前置知识。", "description": "设 $S(n)$ 为 $n$ 以内质数的 $k$ 次方和。\n\n给出 $N$，求下列式子的值。\n\n$$\\sum_{i=1}^{\\lfloor\\sqrt{N}\\rfloor} i^2 S \\!\\left( \\left\\lfloor \\frac{N}{i} \\right\\rfloor \\right)$$\n\n所有结果对给定的质数 $p$ 取模。\n\n", "inputFormat": "一行三个整数 $N,k,p$，之间用空格隔开。", "outputFormat": "一行一个整数，代表计算的结果。", "hint": "**样例解释** : \n\n$S \\!\\left( \\left\\lfloor \\frac{N}{1} \\right\\rfloor \\right)\\! = S(10) = 2^3 + 3^3 + 5^3 + 7^3 = 503$。\n\n$S \\!\\left( \\left\\lfloor \\frac{N}{2} \\right\\rfloor \\right)\\! = S(5) = 2^3 + 3^3 + 5^3 = 160$。\n\n$S \\!\\left( \\left\\lfloor \\frac{N}{3} \\right\\rfloor \\right)\\! = S(3) = 2^3 + 3^3 = 35$。\n\n$1^2 S \\!\\left( \\left\\lfloor \\frac{N}{1} \\right\\rfloor \\right)\\! + 2^2 S \\!\\left( \\left\\lfloor \\frac{N}{2} \\right\\rfloor \\right)\\! + 3^2 S \\!\\left( \\left\\lfloor \\frac{N}{3} \\right\\rfloor \\right)\\! = 503 + 640 + 315 = 1458$。\n\n| 测试点编号 | $N \\le$ | $k \\le$ | 时限 |\n| :--: | :--: | :--: | :--: |\n| $1\\sim 3$ | $10^6$ | $10$ | $1\\texttt s$ |\n| $4\\sim 7$ | $4\\times {10}^{10}$ | $0$ | $3\\texttt s$ |\n| $8\\sim 12$ | $4\\times {10}^{10}$ | $10$ | $3\\texttt s$ |\n\n对于 $100\\%$ 的数据，$0 \\le k \\le 10$，$1 \\le N \\le 4\\times {10}^{10}$，${10}^9 < p < 1.01 \\times {10}^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "质数前缀统计", "background": "这是洲阁筛和 Min_25 筛的重要前置知识。", "description": "设 $S(n)$ 为 $n$ 以内质数的 $k$ 次方和。\n\n给出 $N$，求下列式子的值。\n\n$$\\sum_{i=1}^{\\lfloor\\sqrt{N}\\rfloor} i^2 S \\!\\left( \\left\\lfloor \\frac{N}{i} \\right\\rfloor \\right)$$\n\n所有结果对给定的质数 $p$ 取模。\n\n", "inputFormat": "一行三个整数 $N,k,p$，之间用空格隔开。", "outputFormat": "一行一个整数，代表计算的结果。", "hint": "**样例解释** : \n\n$S \\!\\left( \\left\\lfloor \\frac{N}{1} \\right\\rfloor \\right)\\! = S(10) = 2^3 + 3^3 + 5^3 + 7^3 = 503$。\n\n$S \\!\\left( \\left\\lfloor \\frac{N}{2} \\right\\rfloor \\right)\\! = S(5) = 2^3 + 3^3 + 5^3 = 160$。\n\n$S \\!\\left( \\left\\lfloor \\frac{N}{3} \\right\\rfloor \\right)\\! = S(3) = 2^3 + 3^3 = 35$。\n\n$1^2 S \\!\\left( \\left\\lfloor \\frac{N}{1} \\right\\rfloor \\right)\\! + 2^2 S \\!\\left( \\left\\lfloor \\frac{N}{2} \\right\\rfloor \\right)\\! + 3^2 S \\!\\left( \\left\\lfloor \\frac{N}{3} \\right\\rfloor \\right)\\! = 503 + 640 + 315 = 1458$。\n\n| 测试点编号 | $N \\le$ | $k \\le$ | 时限 |\n| :--: | :--: | :--: | :--: |\n| $1\\sim 3$ | $10^6$ | $10$ | $1\\texttt s$ |\n| $4\\sim 7$ | $4\\times {10}^{10}$ | $0$ | $3\\texttt s$ |\n| $8\\sim 12$ | $4\\times {10}^{10}$ | $10$ | $3\\texttt s$ |\n\n对于 $100\\%$ 的数据，$0 \\le k \\le 10$，$1 \\le N \\le 4\\times {10}^{10}$，${10}^9 < p < 1.01 \\times {10}^9$。", "locale": "zh-CN"}}}
{"pid": "P5494", "type": "P", "difficulty": 6, "samples": [["5 12\n0 0 0 0 0\n2 1 1 1\n2 1 1 2\n2 1 1 3\n3 1 1 3\n4 1 2\n2 1 1 4\n2 1 1 5\n0 1 2 4\n2 2 1 4\n3 2 2 4\n1 1 2\n4 1 3", "3\n2\n4\n3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "平衡树", "模板题"], "title": "【模板】线段树分裂", "background": "", "description": "给出一个可重集 $a$（编号为 $1$），它支持以下操作：\n\n`0 p x y`：将可重集 $p$ 中大于等于 $x$ 且小于等于 $y$ 的值移动到一个新的可重集中（新可重集编号为从 $2$ 开始的正整数，是上一次产生的新可重集的编号+1）。\n\n`1 p t`：将可重集 $t$ 中的数放入可重集 $p$，且清空可重集 $t$（数据保证在此后的操作中不会出现可重集 $t$）。\n\n`2 p x q`：在 $p$ 这个可重集中加入 $x$ 个数字 $q$。\n\n`3 p x y`：查询可重集 $p$ 中大于等于 $x$ 且小于等于 $y$ 的值的个数。\n\n`4 p k`：查询在 $p$ 这个可重集中第 $k$ 小的数，不存在时输出 `-1`。", "inputFormat": "第一行两个整数 $n,m$，表示可重集中的数在 $1\\sim n$ 的范围内，有 $m$ 个操作。\n\n接下来一行 $n$ 个整数，表示 $1 \\sim n$ 这些数在 $a$ 中出现的次数 $(a_{i} \\leq m)$。\n\n接下来的 $m$ 行每行若干个整数，第一个数为操作的编号 $opt$（$0 \\leq opt \\leq 4$），以**题目描述**为准。", "outputFormat": "依次输出每个查询操作的答案。", "hint": "对于 $30\\%$ 的数据，$1\\leq n \\leq {10}^3$，$1 \\le m \\le {10}^3$；  \n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$1 \\le x, y, q \\le m \\le 2 \\times {10}^5$。保证数据合法。\n\n不开 `long long` 见祖宗！！\n\n---\n\n题面 by @[Limit](https://www.luogu.com.cn/user/86625)\n\nstd by @[Limit](https://www.luogu.com.cn/user/86625)（线段树分裂）\n\n验题 by @[Froggy](https://www.luogu.com.cn/user/100285)（平衡树，不过合并的复杂度假掉了，倒数第二个测试点就是 hack 数据）\n\n数据 by @[Froggy](https://www.luogu.com.cn/user/100285)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】线段树分裂", "background": "", "description": "给出一个可重集 $a$（编号为 $1$），它支持以下操作：\n\n`0 p x y`：将可重集 $p$ 中大于等于 $x$ 且小于等于 $y$ 的值移动到一个新的可重集中（新可重集编号为从 $2$ 开始的正整数，是上一次产生的新可重集的编号+1）。\n\n`1 p t`：将可重集 $t$ 中的数放入可重集 $p$，且清空可重集 $t$（数据保证在此后的操作中不会出现可重集 $t$）。\n\n`2 p x q`：在 $p$ 这个可重集中加入 $x$ 个数字 $q$。\n\n`3 p x y`：查询可重集 $p$ 中大于等于 $x$ 且小于等于 $y$ 的值的个数。\n\n`4 p k`：查询在 $p$ 这个可重集中第 $k$ 小的数，不存在时输出 `-1`。", "inputFormat": "第一行两个整数 $n,m$，表示可重集中的数在 $1\\sim n$ 的范围内，有 $m$ 个操作。\n\n接下来一行 $n$ 个整数，表示 $1 \\sim n$ 这些数在 $a$ 中出现的次数 $(a_{i} \\leq m)$。\n\n接下来的 $m$ 行每行若干个整数，第一个数为操作的编号 $opt$（$0 \\leq opt \\leq 4$），以**题目描述**为准。", "outputFormat": "依次输出每个查询操作的答案。", "hint": "对于 $30\\%$ 的数据，$1\\leq n \\leq {10}^3$，$1 \\le m \\le {10}^3$；  \n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$1 \\le x, y, q \\le m \\le 2 \\times {10}^5$。保证数据合法。\n\n不开 `long long` 见祖宗！！\n\n---\n\n题面 by @[Limit](https://www.luogu.com.cn/user/86625)\n\nstd by @[Limit](https://www.luogu.com.cn/user/86625)（线段树分裂）\n\n验题 by @[Froggy](https://www.luogu.com.cn/user/100285)（平衡树，不过合并的复杂度假掉了，倒数第二个测试点就是 hack 数据）\n\n数据 by @[Froggy](https://www.luogu.com.cn/user/100285)", "locale": "zh-CN"}}}
{"pid": "P5495", "type": "P", "difficulty": 5, "samples": [["5 1477\n", "2608816472\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["Dirichlet 卷积", "模板题"], "title": "【模板】Dirichlet 前缀和", "background": "模板题，无背景。", "description": "给定一个长度为 $n$ 的数列 $a_1,a_2,a_3,\\dots,a_n$。\n\n现在你要求出一个长度为 $n$ 的数列 $b_1,b_2,b_3,\\dots,b_n$，满足\n\n$$b_k=\\sum_{i|k}a_i$$\n\n由于某些神秘原因，这里的 $b_k$ 要对 $2^{32}$ 取模。", "inputFormat": "为了避免过大的输入，本题的输入使用随机数生成器。\n\n输入中只有一行两个整数 $n,seed$。其中 $seed$ 为 $32$ 位无符号整数，用来生成数据。\n\n接下来，你要调用 $n$ 次随机数生成器，分别生成 $a_1\\sim a_n$。\n\n对于```C/C++```选手，生成器模板如下：\n\n```cpp\n#define uint unsigned int\nuint seed;\ninline uint getnext(){\n\tseed^=seed<<13;\n\tseed^=seed>>17;\n\tseed^=seed<<5;\n\treturn seed;\n}\n```\n\n对于```Pascal```选手，生成器模板如下：\n\n```pas\nvar seed:dword;\nfunction getnext:dword;\nbegin\n\tseed:=seed xor(seed shl 13);\n\tseed:=seed xor(seed shr 17);\n\tseed:=seed xor(seed shl 5);\n\tgetnext:=seed;\nend;\n```\n\n注意：**所有 $n$ 个数均为 $32$ 位无符号整数**。", "outputFormat": "为了避免过大的输出，你只需输出一个 $32$ 位无符号整数，表示所有 $b_i$ 的异或和。", "hint": "样例中，数列 $a$ 为 $397153977, 974453892, 352446086, 334987182, 2086335567$。\n\n数列 $b$ 为 $397153977, 1371607869, 749600063, 1706595051, 2483489544$。\n\n### 限制与约定\n\n对于 $100\\%$ 的数据， $1\\leq n\\leq 2\\times 10^7$，$0\\leq seed< 2^{32}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Dirichlet Prefix Sum", "background": "This is a template problem, with no background.", "description": "Given a sequence $a_1,a_2,a_3,\\dots,a_n$ of length $n$.\n\nNow you need to compute a sequence $b_1,b_2,b_3,\\dots,b_n$ of length $n$, satisfying\n\n$$b_k=\\sum_{i|k}a_i$$\n\nDue to some mysterious reasons, each $b_k$ should be taken modulo $2^{32}$.", "inputFormat": "To avoid overly large input, this problem uses a random number generator.\n\nThe input contains only one line with two integers $n, seed$. Here, $seed$ is a $32$-bit unsigned integer used to generate the data.\n\nNext, you need to call the random number generator $n$ times to generate $a_1 \\sim a_n$.\n\nFor ```C/C++``` users, the generator template is as follows:\n\n```cpp\n#define uint unsigned int\nuint seed;\ninline uint getnext(){\n\tseed^=seed<<13;\n\tseed^=seed>>17;\n\tseed^=seed<<5;\n\treturn seed;\n}\n```\n\nFor ```Pascal``` users, the generator template is as follows:\n\n```pas\nvar seed:dword;\nfunction getnext:dword;\nbegin\n\tseed:=seed xor(seed shl 13);\n\tseed:=seed xor(seed shr 17);\n\tseed:=seed xor(seed shl 5);\n\tgetnext:=seed;\nend;\n```\n\nNote: **All $n$ numbers are $32$-bit unsigned integers**.", "outputFormat": "To avoid overly large output, you only need to output one $32$-bit unsigned integer, which is the XOR sum of all $b_i$.", "hint": "In the sample, the sequence $a$ is $397153977, 974453892, 352446086, 334987182, 2086335567$.\n\nThe sequence $b$ is $397153977, 1371607869, 749600063, 1706595051, 2483489544$.\n\n### Constraints and Conventions\n\nFor $100\\%$ of the testdata, $1\\leq n\\leq 2\\times 10^7$, $0\\leq seed< 2^{32}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】Dirichlet 前缀和", "background": "模板题，无背景。", "description": "给定一个长度为 $n$ 的数列 $a_1,a_2,a_3,\\dots,a_n$。\n\n现在你要求出一个长度为 $n$ 的数列 $b_1,b_2,b_3,\\dots,b_n$，满足\n\n$$b_k=\\sum_{i|k}a_i$$\n\n由于某些神秘原因，这里的 $b_k$ 要对 $2^{32}$ 取模。", "inputFormat": "为了避免过大的输入，本题的输入使用随机数生成器。\n\n输入中只有一行两个整数 $n,seed$。其中 $seed$ 为 $32$ 位无符号整数，用来生成数据。\n\n接下来，你要调用 $n$ 次随机数生成器，分别生成 $a_1\\sim a_n$。\n\n对于```C/C++```选手，生成器模板如下：\n\n```cpp\n#define uint unsigned int\nuint seed;\ninline uint getnext(){\n\tseed^=seed<<13;\n\tseed^=seed>>17;\n\tseed^=seed<<5;\n\treturn seed;\n}\n```\n\n对于```Pascal```选手，生成器模板如下：\n\n```pas\nvar seed:dword;\nfunction getnext:dword;\nbegin\n\tseed:=seed xor(seed shl 13);\n\tseed:=seed xor(seed shr 17);\n\tseed:=seed xor(seed shl 5);\n\tgetnext:=seed;\nend;\n```\n\n注意：**所有 $n$ 个数均为 $32$ 位无符号整数**。", "outputFormat": "为了避免过大的输出，你只需输出一个 $32$ 位无符号整数，表示所有 $b_i$ 的异或和。", "hint": "样例中，数列 $a$ 为 $397153977, 974453892, 352446086, 334987182, 2086335567$。\n\n数列 $b$ 为 $397153977, 1371607869, 749600063, 1706595051, 2483489544$。\n\n### 限制与约定\n\n对于 $100\\%$ 的数据， $1\\leq n\\leq 2\\times 10^7$，$0\\leq seed< 2^{32}$。", "locale": "zh-CN"}}}
{"pid": "P5496", "type": "P", "difficulty": 6, "samples": [["debber\n", "1 1 1 2 1 1\n"], ["lwkvjfrphhgkfvzzyx\n", "1 1 2 2 3 1 1 1 1 2 3 1 1 1 1 2 3 4\n"], ["azzzyyzyyx", "1 2 1 2 3 2 2 2 3 3"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "O2优化", "回文自动机 PAM", "模板题"], "title": "【模板】回文树 / 回文自动机（PAM）", "background": null, "description": "给定一个字符串 $s$。保证每个字符为小写字母。对于 $s$ 的每个位置，请求出以该位置结尾的回文子串个数。\n\n这个字符串被进行了加密，除了第一个字符，其他字符都需要通过上一个位置的答案来解密。\n\n具体地，若第 $i(i\\geq 1)$ 个位置的答案是 $k$，第 $i+1$ 个字符读入时的 $\\rm ASCII$ 码为 $c$，则第 $i+1$ 个字符实际的 $\\rm ASCII$ 码为 $(c-97+k)\\bmod 26+97$。所有字符在加密前后都为小写字母。", "inputFormat": "一行一个字符串 $s$ 表示被加密后的串。", "outputFormat": "一行， $|s|$ 个整数。第 $i$ 个整数表示原串以第 $i$ 个字符结尾的回文子串个数。", "hint": "### 样例解释\n\n三个样例解码后分别为：\n\n- $\\verb!dfccgs!$；\n- $\\verb!lxlxlisqiiingwaaaa!$；\n- $\\verb!aabaabbaaa!$。\n\n### 数据范围及约定\n\n对于 $100\\%$ 的数据， $1\\leq |s|\\leq 5\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Palindromic Tree / Palindromic Automaton (PAM).", "background": "", "description": "Given a string $s$. It is guaranteed that each character is a lowercase letter. For each position in $s$, find the number of palindromic substrings that end at that position.\n\nThis string has been encrypted. Except for the first character, all other characters must be decrypted using the answer from the previous position.\n\nSpecifically, if the answer at position $i(i\\geq 1)$ is $k$, and the $\\rm ASCII$ code read for the character at position $i+1$ is $c$, then the actual $\\rm ASCII$ code of the character at position $i+1$ is $(c-97+k)\\bmod 26+97$. All characters are lowercase letters both before and after encryption.", "inputFormat": "One line containing a string $s$, representing the encrypted string.", "outputFormat": "One line with $|s|$ integers. The $i$-th integer represents the number of palindromic substrings in the original string that end at the $i$-th character.", "hint": "### Sample Explanation\n\nAfter decoding, the three samples are respectively:\n\n- $\\verb!dfccgs!$;\n- $\\verb!lxlxlisqiiingwaaaa!$;\n- $\\verb!aabaabbaaa!$.\n\n### Constraints and Notes\n\nFor $100\\%$ of the testdata, $1\\leq |s|\\leq 5\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】回文树 / 回文自动机（PAM）", "background": null, "description": "给定一个字符串 $s$。保证每个字符为小写字母。对于 $s$ 的每个位置，请求出以该位置结尾的回文子串个数。\n\n这个字符串被进行了加密，除了第一个字符，其他字符都需要通过上一个位置的答案来解密。\n\n具体地，若第 $i(i\\geq 1)$ 个位置的答案是 $k$，第 $i+1$ 个字符读入时的 $\\rm ASCII$ 码为 $c$，则第 $i+1$ 个字符实际的 $\\rm ASCII$ 码为 $(c-97+k)\\bmod 26+97$。所有字符在加密前后都为小写字母。", "inputFormat": "一行一个字符串 $s$ 表示被加密后的串。", "outputFormat": "一行， $|s|$ 个整数。第 $i$ 个整数表示原串以第 $i$ 个字符结尾的回文子串个数。", "hint": "### 样例解释\n\n三个样例解码后分别为：\n\n- $\\verb!dfccgs!$；\n- $\\verb!lxlxlisqiiingwaaaa!$；\n- $\\verb!aabaabbaaa!$。\n\n### 数据范围及约定\n\n对于 $100\\%$ 的数据， $1\\leq |s|\\leq 5\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5497", "type": "P", "difficulty": 3, "samples": [["2 4\n", "NO\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["鸽笼原理", "构造"], "title": "[LnOI2019SP] 龟速单项式变换(SMT)", "background": "题目提供者：朝田诗乃\n\n众所周知，这是一题签到题。", "description": "有如下定义：若正整数序列 $a$ 中存在连续若干个正整数的和为 $m$ 的倍数，则这个正整数序列 $a$ 被称为“$m$ 序列”。\n\n给定 $n$ 和 $m$，你需要知道长度为 $n$ 的任意正整数序列 $a$ 是否都是“$m$ 序列”。", "inputFormat": "两个数，$n$ 和 $m$。", "outputFormat": "如果成立输出 `YES` 否则输出 `NO`。", "hint": "样例解释：存在反例 $[1, 2]$。\n\nSubtask 1 (50 pts)：$1 \\le n, m \\le 5$。\n\nSubtask 2 (50 pts)：$1 \\le n, m \\le {10}^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019SP] Turtle-Speed Single-Term Transformation (SMT).", "background": "Problem provider: Asada Shino.\n\nAs everyone knows, this is a check-in problem.", "description": "The following definition is given: if, in a positive integer sequence $a$, there exists a sum of several consecutive positive integers that is a multiple of $m$, then the positive integer sequence $a$ is called an “$m$ sequence”.\n\nGiven $n$ and $m$, you need to determine whether every positive integer sequence $a$ of length $n$ is an “$m$ sequence”.", "inputFormat": "Two numbers, $n$ and $m$.", "outputFormat": "If it holds, output `YES`; otherwise output `NO`.", "hint": "Sample explanation: there exists a counterexample $[1, 2]$.\n\nSubtask 1 (50 pts): $1 \\le n, m \\le 5$.\n\nSubtask 2 (50 pts): $1 \\le n, m \\le {10}^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019SP] 龟速单项式变换(SMT)", "background": "题目提供者：朝田诗乃\n\n众所周知，这是一题签到题。", "description": "有如下定义：若正整数序列 $a$ 中存在连续若干个正整数的和为 $m$ 的倍数，则这个正整数序列 $a$ 被称为“$m$ 序列”。\n\n给定 $n$ 和 $m$，你需要知道长度为 $n$ 的任意正整数序列 $a$ 是否都是“$m$ 序列”。", "inputFormat": "两个数，$n$ 和 $m$。", "outputFormat": "如果成立输出 `YES` 否则输出 `NO`。", "hint": "样例解释：存在反例 $[1, 2]$。\n\nSubtask 1 (50 pts)：$1 \\le n, m \\le 5$。\n\nSubtask 2 (50 pts)：$1 \\le n, m \\le {10}^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5498", "type": "P", "difficulty": 5, "samples": [["5 3\n6 12 6 3 27\n1 1\n4 5\n1 3", "6\n37\n100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "[LnOI2019] 脸滚键盘", "background": "题目提供者：Okami\n\n朝田诗乃：一个优秀的长脖子鹿是会数数字的位数的。", "description": "长颈鹿Abbi喜欢用脸滚键盘，它每次滚键盘就会把一段子区间的值乘起来。\n\n定义子区间为一个区间中的一个连续区间。\n\n定义一段子区间的权值为每个元素权值之积。\n\n定义一段区间的期望权值为任意选出一段子区间的权值的期望值。\n\n给定 $n$ 个数字，分别表示权值 $a_i$。\n\n共 $q$ 次询问，对于一次询问 $l \\ r$ 查询指定区间的期望权值。", "inputFormat": "第一行，两个数 $n$ 和 $q$。\n\n第二行 $n$ 个数，第 $n$ 个数表示序列初始值 $a_i$。\n\n接下来 $q$ 行，每行两个数 $l \\ \\ r$，表示询问的区间。", "outputFormat": "对于每次询问，输出指定区间的期望权值。\n\n由于期望权值可以很大，**请输出期望权值模 $100000007$。**\n\n不要问我除不尽怎么办了，看上面\n\n还是不行的话请移步https://www.luogu.org/problem/P2613", "hint": "时空限制：1s/512MB\n\n对于30%的数据，$1 \\leq n, q \\leq 100$\n\n对于100%的数据，$1 \\leq n, q \\leq 10^6$，$1 \\leq a_i \\leq 10^7$\n\n样例解释：对于区间 $[1,1]$，共有一个子区间 $[1,1]$，权值为 $6$，每个区间取到的概率是 $\\frac{1}{1}$，期望权值为6.\n\n对于区间 $[4,5]$，共有三个子区间 $[4,4]$、$[4,5]$、$[5,5]$，权值分别为 $3$、$81$、$27$，每个区间取到的概率是 $\\frac{1}{3}$，总期望权值为 $37$.\n\n对于区间 $[1,3]$，共有个六子区间 $[1,1]$、$[1,2]$、$[1,3]$、$[2,2]$、$[2,3]$、$[3,3]$，权值分别为 $6$、$72$、$432$、$12$、$72$、$6$，每个区间取到的概率是 $\\frac{1}{6}$，总期望权值为 $100$.\n\n建议使用读入优化。", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019] Face-Rolling the Keyboard", "background": "Problem provider: Okami.\n\nAsada Shino: A good long-necked deer can count the number of digits in numbers.", "description": "The giraffe Abbi likes to roll its face on the keyboard. Each time it does so, it multiplies the values in some sub-interval.\n\nA sub-interval is a contiguous interval within an interval.\n\nThe weight of a sub-interval is defined as the product of the weights of all its elements.\n\nThe expected weight of an interval is defined as the expected value of the weight of a sub-interval chosen uniformly at random from all sub-intervals of that interval.\n\nGiven $n$ numbers, where the $i$-th number is the weight $a_i$.\n\nThere are $q$ queries. For each query $l \\ \\ r$, ask for the expected weight of the specified interval.", "inputFormat": "The first line contains two integers $n$ and $q$.\n\nThe second line contains $n$ integers, the $i$-th integer is the initial value $a_i$ of the sequence.\n\nThe next $q$ lines each contain two integers $l \\ \\ r$, representing the query interval.", "outputFormat": "For each query, output the expected weight of the specified interval.\n\nSince the expected weight can be very large, **output the expected weight modulo $100000007$.**\n\nDo not ask what to do if it is not divisible; see above.\n\nIf it still does not work, please refer to https://www.luogu.org/problem/P2613.", "hint": "Time and memory limits: 1 s / 512 MB.\n\nFor $30\\%$ of the testdata, $1 \\leq n, q \\leq 100$.\n\nFor $100\\%$ of the testdata, $1 \\leq n, q \\leq 10^6$, $1 \\leq a_i \\leq 10^7$.\n\nSample explanation: For the interval $[1,1]$, there is only one sub-interval $[1,1]$ with weight $6$. The probability of choosing each sub-interval is $\\frac{1}{1}$, so the expected weight is 6.\n\nFor the interval $[4,5]$, there are three sub-intervals $[4,4]$, $[4,5]$, and $[5,5]$, with weights $3$, $81$, and $27$ respectively. The probability of choosing each sub-interval is $\\frac{1}{3}$, so the total expected weight is $37$.\n\nFor the interval $[1,3]$, there are six sub-intervals $[1,1]$, $[1,2]$, $[1,3]$, $[2,2]$, $[2,3]$, and $[3,3]$, with weights $6$, $72$, $432$, $12$, $72$, and $6$ respectively. The probability of choosing each sub-interval is $\\frac{1}{6}$, so the total expected weight is $100$.\n\nIt is recommended to use fast input.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019] 脸滚键盘", "background": "题目提供者：Okami\n\n朝田诗乃：一个优秀的长脖子鹿是会数数字的位数的。", "description": "长颈鹿Abbi喜欢用脸滚键盘，它每次滚键盘就会把一段子区间的值乘起来。\n\n定义子区间为一个区间中的一个连续区间。\n\n定义一段子区间的权值为每个元素权值之积。\n\n定义一段区间的期望权值为任意选出一段子区间的权值的期望值。\n\n给定 $n$ 个数字，分别表示权值 $a_i$。\n\n共 $q$ 次询问，对于一次询问 $l \\ r$ 查询指定区间的期望权值。", "inputFormat": "第一行，两个数 $n$ 和 $q$。\n\n第二行 $n$ 个数，第 $n$ 个数表示序列初始值 $a_i$。\n\n接下来 $q$ 行，每行两个数 $l \\ \\ r$，表示询问的区间。", "outputFormat": "对于每次询问，输出指定区间的期望权值。\n\n由于期望权值可以很大，**请输出期望权值模 $100000007$。**\n\n不要问我除不尽怎么办了，看上面\n\n还是不行的话请移步https://www.luogu.org/problem/P2613", "hint": "时空限制：1s/512MB\n\n对于30%的数据，$1 \\leq n, q \\leq 100$\n\n对于100%的数据，$1 \\leq n, q \\leq 10^6$，$1 \\leq a_i \\leq 10^7$\n\n样例解释：对于区间 $[1,1]$，共有一个子区间 $[1,1]$，权值为 $6$，每个区间取到的概率是 $\\frac{1}{1}$，期望权值为6.\n\n对于区间 $[4,5]$，共有三个子区间 $[4,4]$、$[4,5]$、$[5,5]$，权值分别为 $3$、$81$、$27$，每个区间取到的概率是 $\\frac{1}{3}$，总期望权值为 $37$.\n\n对于区间 $[1,3]$，共有个六子区间 $[1,1]$、$[1,2]$、$[1,3]$、$[2,2]$、$[2,3]$、$[3,3]$，权值分别为 $6$、$72$、$432$、$12$、$72$、$6$，每个区间取到的概率是 $\\frac{1}{6}$，总期望权值为 $100$.\n\n建议使用读入优化。", "locale": "zh-CN"}}}
{"pid": "P5499", "type": "P", "difficulty": 6, "samples": [["8 5\n1 2 3 3 2 2 7\n1 0 1 3 4 5 0 6\n3 1\n2 2\n3 1\n1 4 1\n3 1", "18 132\n37 360\n35 120"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树链剖分"], "title": "[LnOI2019] Abbi 并不想研学", "background": "题目提供者：XuKaFy", "description": "**【原版题目】**\n\n给定一颗 $n$ 个节点的树，树的叶节点全部是数字，非叶节点全部是符号 `+` 或者 `*`。\n\n请先对该树进行树链剖分。注意：若出现子树大小相同的情况，请选择编号较小的子节点作为重儿子。\n\n一个节点的权值这样计算：若该节点为叶节点，数值即为节点数值；若该节点非叶节点，则该点的权值为【【【该点的【所有不在该点所在重链上】的子节点】所在重链的所有节点权值】相 `+` 或者相 `*` 的结果（操作取决于该节点的符号）】。\n\n另一种表示方式是：设某一节点 $i$ 的儿子集合为 $D_{i}$，节点 $i$ 的父亲为 $F_{i}$，节点 $i$ 的所在重链节点集合为 $P_{i}$。\n\n我们设：\n$$\nCharge_{i}=\\cup_{k\\in D_{i},\\ k\\not\\in P_{i}}P_{k}\n$$\n\n令 $C_{i}$ 为这个节点的符号，这个节点的权值就是：\n$$\nV_{i}=\n\\begin{cases}\n\\sum_{j\\in Charge_{i}}V_{j} &C_{i}=`+'\\\\\n\\prod_{j\\in Charge_{i}}V_{j} &C_{i}=`\\times'\n\\end{cases}  \n$$\n\n数据不保证每一个非叶节点都有至少一个非链上儿子，若没有合法的儿子则忽略该节点。\n\n你需要支持这三种操作：\n\n1. 改变某一叶节点的数值；\n\n2. 改变某一非叶节点的符号为 `+` 或者 `*`；\n\n3. 查询某一节点所在重链所有节点权值相 `+` 与相 `*` 的值。\n\n为防止溢出，请将所有权值对 $99991$ 取模。", "inputFormat": "第一行输入两个数 $n$ 与 $m$ 表示学生数量与要求数量。\n\n接下来输入 $1$ 行，$n-1$ 个数，表示第 $i+1$ 个节点的父亲为$a$。\n\n接下来一行 $n$ 个数，分别为每个节点的信息：若该节点为叶节点，则是一个数字表示 $V_{i}$，否则为一个数，`0` 表示 `+`，`1`表示 `*`。\n\n接下来输入 $m$ 行，每行一个数字 $c$ 与编号 $k$，表示要求类型为 $c$，操作的节点编号为 $k$。若 $c=1$，那么再输入一个数 $V_{i}$ 表示新的权值。", "outputFormat": "对于每一个 $3$ 操作，请输出一行，该行包括两个数 $a, b$，分别表示将本节点所在重链的所有节点权值相加**以及**相乘的结果。", "hint": "对于 $30\\%$ 的数据，$1 \\le n,m \\le 1000$。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 10^{6}, 1 \\le V_{i}<99991$。\n\n**数据保证任何时刻树上没有权值为 $0$ 的节点。**", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019] Abbi Does Not Want to Go on a Study Tour.", "background": "Problem provider: XuKaFy", "description": "**[Original Problem]**\n\nGiven a tree with $n$ nodes. All leaf nodes are numbers, and all non-leaf nodes are symbols `+` or `*`.\n\nFirst, perform Heavy-Light Decomposition (HLD) on the tree. Note: if there is a tie in subtree size, choose the child with the smaller index as the heavy child.\n\nThe value of a node is defined as follows: if the node is a leaf, its value is the number on the node; if the node is not a leaf, then its value is the result of applying `+` or `*` (depending on the node’s symbol) to the values of all nodes on the heavy chains of all its children that are **not on the same heavy chain as this node**.\n\nAnother way to describe it is: let the set of children of node $i$ be $D_{i}$, the parent of node $i$ be $F_{i}$, and the set of nodes on the heavy chain containing node $i$ be $P_{i}$.\n\nDefine:\n$$\nCharge_{i}=\\cup_{k\\in D_{i},\\ k\\not\\in P_{i}}P_{k}\n$$\n\nLet $C_{i}$ be the symbol of this node. Then the value of this node is:\n$$\nV_{i}=\n\\begin{cases}\n\\sum_{j\\in Charge_{i}}V_{j} &C_{i}=`+'\\\\\n\\prod_{j\\in Charge_{i}}V_{j} &C_{i}=`\\times'\n\\end{cases}  \n$$\n\nThe data does not guarantee that every non-leaf node has at least one child outside its chain. If there is no valid child, ignore this node.\n\nYou need to support three operations:\n\n1. Change the value of a leaf node.\n\n2. Change the symbol of a non-leaf node to `+` or `*`.\n\n3. Query, for the heavy chain containing a given node, the sum and the product of the values of all nodes on that heavy chain.\n\nTo prevent overflow, take all values modulo $99991$.", "inputFormat": "The first line contains two integers $n$ and $m$, meaning the number of students and the number of requests.\n\nThen input $1$ line with $n-1$ integers, meaning the parent of node $i+1$ is $a$.\n\nThen input one line with $n$ integers describing each node: if the node is a leaf, it is a number representing $V_{i}$; otherwise it is a number, where `0` means `+` and `1` means `*`.\n\nThen input $m$ lines. Each line contains an integer $c$ and an index $k$, meaning the request type is $c$ and the operated node index is $k$. If $c=1$, then input another integer $V_{i}$ as the new value.", "outputFormat": "For each operation of type $3$, output one line containing two integers $a, b$, meaning the sum **and** the product of the values of all nodes on the heavy chain containing this node.", "hint": "For $30\\%$ of the testdata, $1 \\le n,m \\le 1000$.\n\nFor $100\\%$ of the testdata, $1 \\le n,m \\le 10^{6}, 1 \\le V_{i}<99991$.\n\n**The testdata guarantees that at any time there is no node on the tree whose value is $0$.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019] Abbi 并不想研学", "background": "题目提供者：XuKaFy", "description": "**【原版题目】**\n\n给定一颗 $n$ 个节点的树，树的叶节点全部是数字，非叶节点全部是符号 `+` 或者 `*`。\n\n请先对该树进行树链剖分。注意：若出现子树大小相同的情况，请选择编号较小的子节点作为重儿子。\n\n一个节点的权值这样计算：若该节点为叶节点，数值即为节点数值；若该节点非叶节点，则该点的权值为【【【该点的【所有不在该点所在重链上】的子节点】所在重链的所有节点权值】相 `+` 或者相 `*` 的结果（操作取决于该节点的符号）】。\n\n另一种表示方式是：设某一节点 $i$ 的儿子集合为 $D_{i}$，节点 $i$ 的父亲为 $F_{i}$，节点 $i$ 的所在重链节点集合为 $P_{i}$。\n\n我们设：\n$$\nCharge_{i}=\\cup_{k\\in D_{i},\\ k\\not\\in P_{i}}P_{k}\n$$\n\n令 $C_{i}$ 为这个节点的符号，这个节点的权值就是：\n$$\nV_{i}=\n\\begin{cases}\n\\sum_{j\\in Charge_{i}}V_{j} &C_{i}=`+'\\\\\n\\prod_{j\\in Charge_{i}}V_{j} &C_{i}=`\\times'\n\\end{cases}  \n$$\n\n数据不保证每一个非叶节点都有至少一个非链上儿子，若没有合法的儿子则忽略该节点。\n\n你需要支持这三种操作：\n\n1. 改变某一叶节点的数值；\n\n2. 改变某一非叶节点的符号为 `+` 或者 `*`；\n\n3. 查询某一节点所在重链所有节点权值相 `+` 与相 `*` 的值。\n\n为防止溢出，请将所有权值对 $99991$ 取模。", "inputFormat": "第一行输入两个数 $n$ 与 $m$ 表示学生数量与要求数量。\n\n接下来输入 $1$ 行，$n-1$ 个数，表示第 $i+1$ 个节点的父亲为$a$。\n\n接下来一行 $n$ 个数，分别为每个节点的信息：若该节点为叶节点，则是一个数字表示 $V_{i}$，否则为一个数，`0` 表示 `+`，`1`表示 `*`。\n\n接下来输入 $m$ 行，每行一个数字 $c$ 与编号 $k$，表示要求类型为 $c$，操作的节点编号为 $k$。若 $c=1$，那么再输入一个数 $V_{i}$ 表示新的权值。", "outputFormat": "对于每一个 $3$ 操作，请输出一行，该行包括两个数 $a, b$，分别表示将本节点所在重链的所有节点权值相加**以及**相乘的结果。", "hint": "对于 $30\\%$ 的数据，$1 \\le n,m \\le 1000$。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 10^{6}, 1 \\le V_{i}<99991$。\n\n**数据保证任何时刻树上没有权值为 $0$ 的节点。**", "locale": "zh-CN"}}}
{"pid": "P5500", "type": "P", "difficulty": 6, "samples": [["10 4\n3 3 3 3 2 3 3 3 2 2\nQ 1 6 1\nQ 1 6 0\nR 8 8 2\nQ 5 10 1", "5\n4\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "[LnOI2019] 真正的 OIer 从不女装", "background": "题目提供者：朝田诗乃\n\n众所周知，女装只有零次和无数次。", "description": "给定一个长度为 $n$ 的序列 $a$。\n\n有如下定义：若一个序列中所有数字都一样，那么这个序列被称作“诗乃序列”。\n\n对于每次询问，给定 $l$ 和 $r$，求序列 $a$ 中**左右端点都在 $[l,r]$ 中**的最长“诗乃序列”长度。\n\n这题难倒了 Abbi。Abbi 决定女装。当 Abbi 女装时，序列会出现神奇的变化：它可以**在询问的区间 $[l,r]$ 中**挑一个它喜欢的位置 $p$，将区间 $[l,p]$ 和 $(p,r]$ **分别**翻转。\n\nAbbi 想知道，**最多**进行 $k$ 次女装后（可选择进行不足 $k$ 次或不进行女装），能得到的最长的“诗乃序列”的长度是多少？", "inputFormat": "第一行，$n$、$m$，表示序列长度和操作个数。\n\n第二行，$n$ 个数，第$i$个数表示序列初始值 $a_i$。\n\n接下来 $m$ 行，每行描述一个操作，格式如下：\n\n1. $R$ $l$ $r$ $x$：表示将区间 $[l,r]$ 上的数字全部变成 $x$。\n2. $Q$ $l$ $r$ $k$：表示询问在 $[l,r]$ 中进行最多 $k$ 次女装所能得到的最长“诗乃序列”长度。\n\n**注意：询问独立，即每次询问后会将序列复原，不实际执行反转操作。**", "outputFormat": "对于每个 Q 操作，输出询问答案。", "hint": "**时空限制**：1s/512MB。\n\n**数据范围：**\n\n- 对于 $20\\%$ 的数据，$1 ≤ n,m ≤ 100$。\n- 对于另外 $10\\%$ 数据，所有询问的 $k=0$。\n- 对于另外 $10\\%$ 数据，没有 R 操作。\n- 对于 $100\\%$ 的数据，$1≤n,m≤200000$，$0≤k≤1000$，$1≤a_i,x≤10^9$，$1≤l≤r≤n$。\n\n特殊限制：对于后 $80\\%$ 的数据，保证能卡飞 ODT。\n\n**样例解释：**\n\n对于第一次询问，询问的区间为：\n\n```\n3 3 3 3 2 3\n```\n\n女装 $1$ 次，将区间 $[1,4]$ 和 $[5,6]$ 分别翻转，得到：\n\n```\n3 3 3 3 3 2\n```\n\n此时可得到最长“诗乃序列”，长度为 $5$。可以证明没有别的女装方法能得到更长的“诗乃序列”。\n\n此后询问以此类推。\n\n**建议使用读入优化。**", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019] A Real OIer Never Cross-dresses", "background": "Problem provider: Asada Shino.\n\nAs everyone knows, there are only zero times and countless times for cross-dressing.", "description": "Given a sequence $a$ of length $n$.\n\nThere is the following definition: if all numbers in a sequence are the same, then this sequence is called a “Shino sequence”.\n\nFor each query, given $l$ and $r$, find the maximum length of a “Shino sequence” in $a$ whose **both endpoints are within $[l,r]$**.\n\nThis problem stumped Abbi. Abbi decided to cross-dress. When Abbi cross-dresses, the sequence undergoes a magical change: it can choose a position $p$ that it likes **within the query interval $[l,r]$**, and **separately** reverse the intervals $[l,p]$ and $(p,r]$.\n\nAbbi wants to know: after cross-dressing at most $k$ times (you may choose to do fewer than $k$ times, or not cross-dress at all), what is the maximum possible length of a “Shino sequence” that can be obtained?", "inputFormat": "The first line contains $n$ and $m$, representing the sequence length and the number of operations.\n\nThe second line contains $n$ numbers, where the $i$-th number is the initial value $a_i$.\n\nThe next $m$ lines each describe an operation in the following format:\n\n1. $R$ $l$ $r$ $x$: set all numbers in the interval $[l,r]$ to $x$.\n2. $Q$ $l$ $r$ $k$: query the maximum length of a “Shino sequence” that can be obtained by cross-dressing at most $k$ times within $[l,r]$.\n\n**Note: Queries are independent. That is, after each query, the sequence is restored; the reversal operations are not actually applied.**", "outputFormat": "For each $Q$ operation, output the answer to the query.", "hint": "**Time and memory limits**: 1s / 512MB.\n\n**Constraints:**\n\n- For $20\\%$ of the testdata, $1 \\le n,m \\le 100$.\n- For another $10\\%$ of the testdata, all queries have $k=0$.\n- For another $10\\%$ of the testdata, there are no $R$ operations.\n- For $100\\%$ of the testdata, $1 \\le n,m \\le 200000$, $0 \\le k \\le 1000$, $1 \\le a_i,x \\le 10^9$, $1 \\le l \\le r \\le n$.\n\nSpecial restriction: for the last $80\\%$ of the testdata, it is guaranteed that ODT can be hacked.\n\n**Sample explanation:**\n\nFor the first query, the queried interval is:\n\n```\n3 3 3 3 2 3\n```\n\nCross-dress once, and reverse $[1,4]$ and $[5,6]$ separately, obtaining:\n\n```\n3 3 3 3 3 2\n```\n\nAt this time, the longest “Shino sequence” has length $5$. It can be proven that no other way of cross-dressing can produce a longer “Shino sequence”.\n\nSubsequent queries proceed similarly.\n\n**It is recommended to use fast input.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019] 真正的 OIer 从不女装", "background": "题目提供者：朝田诗乃\n\n众所周知，女装只有零次和无数次。", "description": "给定一个长度为 $n$ 的序列 $a$。\n\n有如下定义：若一个序列中所有数字都一样，那么这个序列被称作“诗乃序列”。\n\n对于每次询问，给定 $l$ 和 $r$，求序列 $a$ 中**左右端点都在 $[l,r]$ 中**的最长“诗乃序列”长度。\n\n这题难倒了 Abbi。Abbi 决定女装。当 Abbi 女装时，序列会出现神奇的变化：它可以**在询问的区间 $[l,r]$ 中**挑一个它喜欢的位置 $p$，将区间 $[l,p]$ 和 $(p,r]$ **分别**翻转。\n\nAbbi 想知道，**最多**进行 $k$ 次女装后（可选择进行不足 $k$ 次或不进行女装），能得到的最长的“诗乃序列”的长度是多少？", "inputFormat": "第一行，$n$、$m$，表示序列长度和操作个数。\n\n第二行，$n$ 个数，第$i$个数表示序列初始值 $a_i$。\n\n接下来 $m$ 行，每行描述一个操作，格式如下：\n\n1. $R$ $l$ $r$ $x$：表示将区间 $[l,r]$ 上的数字全部变成 $x$。\n2. $Q$ $l$ $r$ $k$：表示询问在 $[l,r]$ 中进行最多 $k$ 次女装所能得到的最长“诗乃序列”长度。\n\n**注意：询问独立，即每次询问后会将序列复原，不实际执行反转操作。**", "outputFormat": "对于每个 Q 操作，输出询问答案。", "hint": "**时空限制**：1s/512MB。\n\n**数据范围：**\n\n- 对于 $20\\%$ 的数据，$1 ≤ n,m ≤ 100$。\n- 对于另外 $10\\%$ 数据，所有询问的 $k=0$。\n- 对于另外 $10\\%$ 数据，没有 R 操作。\n- 对于 $100\\%$ 的数据，$1≤n,m≤200000$，$0≤k≤1000$，$1≤a_i,x≤10^9$，$1≤l≤r≤n$。\n\n特殊限制：对于后 $80\\%$ 的数据，保证能卡飞 ODT。\n\n**样例解释：**\n\n对于第一次询问，询问的区间为：\n\n```\n3 3 3 3 2 3\n```\n\n女装 $1$ 次，将区间 $[1,4]$ 和 $[5,6]$ 分别翻转，得到：\n\n```\n3 3 3 3 3 2\n```\n\n此时可得到最长“诗乃序列”，长度为 $5$。可以证明没有别的女装方法能得到更长的“诗乃序列”。\n\n此后询问以此类推。\n\n**建议使用读入优化。**", "locale": "zh-CN"}}}
{"pid": "P5501", "type": "P", "difficulty": 6, "samples": [["4 2\n1 2 2 3\n1 4\n1 2", "21\n5"], ["10 5\n8 6 9 8 1 1 3 10 7 9\n5 8\n1 3\n5 7\n9 9\n5 6\n", "51\n49\n11\n7\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 5000, 5000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["莫队", "O2优化"], "title": "[LnOI2019] 来者不拒，去者不追", "background": "题目提供者：朝田诗乃\n\n![avartar](https://cdn.luogu.com.cn/upload/pic/66100.png)", "description": "给定一个长度为 $n$ 的序列 $a$。给定 $m$ 个询问，每次询问一个区间中 $[l,r]$ 中所有数的“Abbi 值”之和。\n\nAbbi 值定义为：若 $a_i$ 在询问区间 $[l,r]$ 中是第 $k$ 小，那么它的“Abbi 值”等于 $k \\times a_i$。\n\n为了消除歧义举个例子：\n\n有序列 $\\{1,2,2,3\\}$，那么 $1$ 是第 $1$ 小，$2$ 是第 $2$ 小，$3$ 是第 $4$ 小，序列 Abbi 值和为：\n\n$$1 \\times 1+2 \\times 2+2 \\times 2+3 \\times 4=21.$$", "inputFormat": "第一行两个整数，$n$ 和 $m$，分别表示序列长度和询问组数。\n\n第二行 $n$ 个数，第 $i$ 个数为 $a_i$，表示序列的初始值。\n\n接下来 $m$ 行，每行两个数 $l$ 和 $r$，表示询问区间。", "outputFormat": "对于每个询问，输出一行表示答案。", "hint": "前 2 个数据点，$1≤n,m≤1000$，时限 1s。\n\n接下来 14 个数据点，$1≤n,a_i,m≤100000$，$1≤l≤r≤n$，时限 1s。\n\n最后两个数据点，$1≤a_i≤100000$，$1≤l≤r≤n$，$1≤n,m≤500000$，时限 3s。\n\n建议使用读入优化。建议开启 O2 优化。\n\n数据已经过加强。", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019] Welcome All Who Come, Do Not Chase Those Who Leave", "background": "Problem provider: Asada Shino\n\n![avartar](https://cdn.luogu.com.cn/upload/pic/66100.png)", "description": "Given a sequence $a$ of length $n$. There are $m$ queries. For each query, you need to find the sum of the “Abbi value” of all numbers in the interval $[l,r]$.\n\nThe Abbi value is defined as follows: if $a_i$ is the $k$-th smallest in the query interval $[l,r]$, then its “Abbi value” equals $k \\times a_i$.\n\nTo avoid ambiguity, here is an example:\n\nGiven the sequence $\\{1,2,2,3\\}$, then $1$ is the $1$-st smallest, $2$ is the $2$-nd smallest, and $3$ is the $4$-th smallest. The sum of Abbi values of the sequence is:\n\n$$1 \\times 1+2 \\times 2+2 \\times 2+3 \\times 4=21.$$", "inputFormat": "The first line contains two integers, $n$ and $m$, representing the length of the sequence and the number of queries.\n\nThe second line contains $n$ numbers. The $i$-th number is $a_i$, representing the initial value of the sequence.\n\nThe next $m$ lines each contain two numbers $l$ and $r$, representing a query interval.", "outputFormat": "For each query, output one line with the answer.", "hint": "Constraints\n\nFor the first 2 test points, $1 \\le n,m \\le 1000$, time limit $1\\text{s}$.\n\nFor the next 14 test points, $1 \\le n,a_i,m \\le 100000$, $1 \\le l \\le r \\le n$, time limit $1\\text{s}$.\n\nFor the last 2 test points, $1 \\le a_i \\le 100000$, $1 \\le l \\le r \\le n$, $1 \\le n,m \\le 500000$, time limit $3\\text{s}$.\n\nIt is recommended to use fast input. It is recommended to enable $O2$ optimization.\n\nThe testdata has been strengthened.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019] 来者不拒，去者不追", "background": "题目提供者：朝田诗乃\n\n![avartar](https://cdn.luogu.com.cn/upload/pic/66100.png)", "description": "给定一个长度为 $n$ 的序列 $a$。给定 $m$ 个询问，每次询问一个区间中 $[l,r]$ 中所有数的“Abbi 值”之和。\n\nAbbi 值定义为：若 $a_i$ 在询问区间 $[l,r]$ 中是第 $k$ 小，那么它的“Abbi 值”等于 $k \\times a_i$。\n\n为了消除歧义举个例子：\n\n有序列 $\\{1,2,2,3\\}$，那么 $1$ 是第 $1$ 小，$2$ 是第 $2$ 小，$3$ 是第 $4$ 小，序列 Abbi 值和为：\n\n$$1 \\times 1+2 \\times 2+2 \\times 2+3 \\times 4=21.$$", "inputFormat": "第一行两个整数，$n$ 和 $m$，分别表示序列长度和询问组数。\n\n第二行 $n$ 个数，第 $i$ 个数为 $a_i$，表示序列的初始值。\n\n接下来 $m$ 行，每行两个数 $l$ 和 $r$，表示询问区间。", "outputFormat": "对于每个询问，输出一行表示答案。", "hint": "前 2 个数据点，$1≤n,m≤1000$，时限 1s。\n\n接下来 14 个数据点，$1≤n,a_i,m≤100000$，$1≤l≤r≤n$，时限 1s。\n\n最后两个数据点，$1≤a_i≤100000$，$1≤l≤r≤n$，$1≤n,m≤500000$，时限 3s。\n\n建议使用读入优化。建议开启 O2 优化。\n\n数据已经过加强。", "locale": "zh-CN"}}}
{"pid": "P5502", "type": "P", "difficulty": 5, "samples": [["5\n30 60 20 20 20", "80"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["暴力数据结构", "2015", "各省省选", "江苏", "分治"], "title": "[JSOI2015] 最大公约数", "background": "", "description": "给定一个长度为 $N$ 的正整数序列 $A_i$ 。\n\n对于其任意一个连续的子序列 $A_l,A_{l+1},...,A_r$ ，我们定义其权值 $W(L,R)$ 为其长度与序列中所有元素的最大公约数的乘积，即 $W(L,R) = (R-L+1) × \\gcd (A_l,...,A_r)$。\n\n`JYY` 希望找出权值最大的子序列。", "inputFormat": "输入一行包含一个正整数 $N$ 。\n\n接下来一行，包含 $N$ 个正整数，表示序列 $A_i$ 。\n ", "outputFormat": "输出文件包含一行一个正整数，表示权值最大的子序列的权值。", "hint": "$1 \\le  A_i \\le  10^{12}, 1 \\le  N \\le  100000$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2015] Greatest Common Divisor", "background": "", "description": "Given a sequence of positive integers $A_i$ of length $N$.\n\nFor any consecutive subsequence $A_l, A_{l+1}, ..., A_r$, define its weight $W(L, R)$ as the product of its length and the greatest common divisor of all elements in the subsequence, i.e., $W(L, R) = (R - L + 1) × \\gcd(A_l, ..., A_r)$.\n\n`JYY` wants to find the subsequence with the maximum weight.", "inputFormat": "The input contains one line with a positive integer $N$.\n\nThe next line contains $N$ positive integers, representing the sequence $A_i$.", "outputFormat": "Output one line with a positive integer, representing the maximum weight among all subsequences.", "hint": "$1 \\le A_i \\le 10^{12}, 1 \\le N \\le 100000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2015] 最大公约数", "background": "", "description": "给定一个长度为 $N$ 的正整数序列 $A_i$ 。\n\n对于其任意一个连续的子序列 $A_l,A_{l+1},...,A_r$ ，我们定义其权值 $W(L,R)$ 为其长度与序列中所有元素的最大公约数的乘积，即 $W(L,R) = (R-L+1) × \\gcd (A_l,...,A_r)$。\n\n`JYY` 希望找出权值最大的子序列。", "inputFormat": "输入一行包含一个正整数 $N$ 。\n\n接下来一行，包含 $N$ 个正整数，表示序列 $A_i$ 。\n ", "outputFormat": "输出文件包含一行一个正整数，表示权值最大的子序列的权值。", "hint": "$1 \\le  A_i \\le  10^{12}, 1 \\le  N \\le  100000$", "locale": "zh-CN"}}}
{"pid": "P5503", "type": "P", "difficulty": 6, "samples": [["6\n5\n3\n2\n4\n2\n4", "2\n3\n5\n3\n5\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2016", "各省省选", "江苏"], "title": "[JSOI2016] 灯塔", "background": null, "description": "JSOI 的国境线上有 $N$ 座连续的山峰，其中第 $i$ 座的高度是 $h_i$。为了简单起见，我们认为这 $N$ 座山峰排成了连续一条直线。如果在第 $i$ 座山峰上建立一座高度为 $p$（$p≥0$）的灯塔，JYY 发现，这座灯塔能够照亮第 $j$ 座山峰，当且仅当满足如下不等式:\n\n$$h_j \\le h_i+p-\\sqrt {|i-j|}$$\n\nJSOI 国王希望对于每一座山峰，JYY 都能提供建造一座能够照亮全部其他山峰的灯塔所需要的最小高度。你能帮助 JYY 么？", "inputFormat": "输入一行包含一个正整数 $N$。\n\n接下来 $N$ 行，第 $i$ 行包含一个正整数 $h_i$，表示第 $i$ 座山峰的高度。", "outputFormat": "第 $i$ 行包含一个非负整数，表示在第 $i$ 座山峰上修建灯塔所需要的最小高度 $p_i$。", "hint": "对于 $100\\%$ 的数据，$1< N \\le  10^5$，$0 < h_i \\le  10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Lighthouse", "background": "", "description": "Along the border of JSOI, there are $N$ consecutive mountain peaks. The height of the $i$-th peak is $h_i$. For simplicity, we assume these $N$ peaks are arranged along a straight line.\n\nIf a lighthouse of height $p$ ($p \\ge 0$) is built on the $i$-th peak, JYY finds that this lighthouse can illuminate the $j$-th peak if and only if the following inequality holds:\n\n$$h_j \\le h_i + p - \\sqrt {|i-j|}$$\n\nThe king of JSOI wants JYY to provide, for each peak, the minimum height required to build a lighthouse that can illuminate all other peaks. Can you help JYY?", "inputFormat": "The input contains one line with a positive integer $N$.\n\nIn the next $N$ lines, the $i$-th line contains a positive integer $h_i$, representing the height of the $i$-th peak.", "outputFormat": "The $i$-th line contains a non-negative integer, representing the minimum height $p_i$ required to build a lighthouse on the $i$-th peak.", "hint": "For $100\\%$ of the data, $1 < N \\le 10^5$, $0 < h_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 灯塔", "background": null, "description": "JSOI 的国境线上有 $N$ 座连续的山峰，其中第 $i$ 座的高度是 $h_i$。为了简单起见，我们认为这 $N$ 座山峰排成了连续一条直线。如果在第 $i$ 座山峰上建立一座高度为 $p$（$p≥0$）的灯塔，JYY 发现，这座灯塔能够照亮第 $j$ 座山峰，当且仅当满足如下不等式:\n\n$$h_j \\le h_i+p-\\sqrt {|i-j|}$$\n\nJSOI 国王希望对于每一座山峰，JYY 都能提供建造一座能够照亮全部其他山峰的灯塔所需要的最小高度。你能帮助 JYY 么？", "inputFormat": "输入一行包含一个正整数 $N$。\n\n接下来 $N$ 行，第 $i$ 行包含一个正整数 $h_i$，表示第 $i$ 座山峰的高度。", "outputFormat": "第 $i$ 行包含一个非负整数，表示在第 $i$ 座山峰上修建灯塔所需要的最小高度 $p_i$。", "hint": "对于 $100\\%$ 的数据，$1< N \\le  10^5$，$0 < h_i \\le  10^9$。", "locale": "zh-CN"}}}
{"pid": "P5504", "type": "P", "difficulty": 6, "samples": [["5\n2\n2\n5\n2\n3", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2011", "各省省选", "江苏", "动态规划优化", "斜率优化"], "title": "[JSOI2011] 柠檬", "background": "", "description": "$\\text{Flute}$ 很喜欢柠檬。它准备了一串用树枝串起来的贝壳，打算用一种魔法把贝壳变成柠檬。贝壳一共有 $n$ $(1≤n≤100000)$ 只，按顺序串在树枝上。为了方便，我们从左到右给贝壳编号 $1..n$ 。每只贝壳的大小不一定相同，贝壳 $i$ 的大小为 $s_i(1≤s_i≤10000)$ 。\n\n变柠檬的魔法要求$:\\ \\text{Flute}$ 每次从树枝一端取下一小段连续的贝壳，并选择一种贝壳的大小 $s_0$。如果这一小段贝壳中大小为 $s_0$ 的贝壳有 $t$ 只，那么魔法可以把这一小段贝壳变成 $s_0t^2$ 只柠檬。$\\text{Flute}$ 可以取任意多次贝壳，直到树枝上的贝壳被全部取完。各个小段中，$\\text{Flute}$ 选择的贝壳大小 $s_0$ 可以不同。而最终 $\\text{Flute}$ 得到的柠檬数，就是所有小段柠檬数的总和。\n\n$\\text{Flute}$ 想知道，它最多能用这一串贝壳\n变出多少柠檬。请你帮忙解决这个问题。", "inputFormat": "第 $1$ 行：一个整数，表示 $n$ 。\n第 $2..n+1$ 行：每行一个整数，第 $i+1$ 行表示 $s_i$。", "outputFormat": "仅一个整数，表示 $\\text{Flute}$ 最多能得到的柠檬数。", "hint": "$\\text{Flute}$ 先从左端取下 $4$ 只贝壳，它们的大小为 $2, 2, 5, 2$。选择 $s_0=2$，那么这一段里有 $3$ 只大小为 $s_0$ 的贝壳，通过魔法可以得到 $2×3^2 = 18$ 只柠檬。再从右端取下最后一只贝壳，通过魔法可以得到 $3×1^2 = 3$ 只柠檬。总共可以得到 $18+3=21$ 只柠檬。没有比这更优的方案了。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2011] Lemons", "background": "", "description": "$\\text{Flute}$ likes lemons very much. It prepared a string of shells threaded onto a branch and plans to use a kind of magic to turn the shells into lemons. There are $n$ $(1 \\le n \\le 100000)$ shells in total, threaded on the branch in order. For convenience, we number the shells from left to right as $1..n$. The sizes of the shells are not necessarily the same; the size of shell $i$ is $s_i(1 \\le s_i \\le 10000)$.\n\nThe lemon-making magic requires that: each time, $\\text{Flute}$ removes a short consecutive segment of shells from one end of the branch, and chooses a shell size $s_0$. If there are $t$ shells of size $s_0$ in this segment, then the magic can turn this segment into $s_0 t^2$ lemons. $\\text{Flute}$ may remove shells any number of times until all shells on the branch have been removed. For different segments, the chosen shell size $s_0$ may be different. The final number of lemons $\\text{Flute}$ gets is the sum of the lemons obtained from all segments.\n\n$\\text{Flute}$ wants to know the maximum number of lemons that can be produced from this string of shells. Please help solve this problem.", "inputFormat": "Line $1$: an integer $n$.\n\nLines $2..n+1$: each line contains one integer; line $i+1$ gives $s_i$.", "outputFormat": "A single integer, meaning the maximum number of lemons $\\text{Flute}$ can obtain.", "hint": "$\\text{Flute}$ first removes $4$ shells from the left end, with sizes $2, 2, 5, 2$. Choose $s_0 = 2$. Then there are $3$ shells of size $s_0$ in this segment, so the magic yields $2 \\times 3^2 = 18$ lemons. Then remove the last shell from the right end, and the magic yields $3 \\times 1^2 = 3$ lemons. In total, you can get $18 + 3 = 21$ lemons. There is no better plan than this.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2011] 柠檬", "background": "", "description": "$\\text{Flute}$ 很喜欢柠檬。它准备了一串用树枝串起来的贝壳，打算用一种魔法把贝壳变成柠檬。贝壳一共有 $n$ $(1≤n≤100000)$ 只，按顺序串在树枝上。为了方便，我们从左到右给贝壳编号 $1..n$ 。每只贝壳的大小不一定相同，贝壳 $i$ 的大小为 $s_i(1≤s_i≤10000)$ 。\n\n变柠檬的魔法要求$:\\ \\text{Flute}$ 每次从树枝一端取下一小段连续的贝壳，并选择一种贝壳的大小 $s_0$。如果这一小段贝壳中大小为 $s_0$ 的贝壳有 $t$ 只，那么魔法可以把这一小段贝壳变成 $s_0t^2$ 只柠檬。$\\text{Flute}$ 可以取任意多次贝壳，直到树枝上的贝壳被全部取完。各个小段中，$\\text{Flute}$ 选择的贝壳大小 $s_0$ 可以不同。而最终 $\\text{Flute}$ 得到的柠檬数，就是所有小段柠檬数的总和。\n\n$\\text{Flute}$ 想知道，它最多能用这一串贝壳\n变出多少柠檬。请你帮忙解决这个问题。", "inputFormat": "第 $1$ 行：一个整数，表示 $n$ 。\n第 $2..n+1$ 行：每行一个整数，第 $i+1$ 行表示 $s_i$。", "outputFormat": "仅一个整数，表示 $\\text{Flute}$ 最多能得到的柠檬数。", "hint": "$\\text{Flute}$ 先从左端取下 $4$ 只贝壳，它们的大小为 $2, 2, 5, 2$。选择 $s_0=2$，那么这一段里有 $3$ 只大小为 $s_0$ 的贝壳，通过魔法可以得到 $2×3^2 = 18$ 只柠檬。再从右端取下最后一只贝壳，通过魔法可以得到 $3×1^2 = 3$ 只柠檬。总共可以得到 $18+3=21$ 只柠檬。没有比这更优的方案了。", "locale": "zh-CN"}}}
{"pid": "P5505", "type": "P", "difficulty": 5, "samples": [["5 4\n1 3 3 5", "384835"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "江苏", "组合数学", "容斥原理"], "title": "[JSOI2011] 分特产", "background": null, "description": "JYY 带队参加了若干场 $\\text{ACM/ICPC}$ 比赛，带回了许多土特产，要分给实验室的同学们。\n\nJYY 想知道，把这些特产分给 $n$ 个同学，一共有多少种不同的分法？当然，JYY 不希望任何一个同学因为没有拿到特产而感到失落，所以每个同学都必须至少分得一个特产。\n\n例如，JYY 带来了 $2$ 袋麻花和 $1$ 袋包子，分给 $A$ 和 $B$ 两位同学，那么共有 $4$ 种不同的\n分配方法：\n\n $A$：麻花， $B$：麻花、包子\n\n $A$：麻花、麻花， $B$：包子\n\n $A$：包子， $B$：麻花、麻花\n\n $A$：麻花、包子， $B$：麻花", "inputFormat": "输入数据：\n\n第一行是同学的数量 $n$ 和特产的种类 $m$。\n\n第二行包含 $m$ 个整数，表示每一种特产的数量。\n\n$n, m$ 不超过 $1000$ ，每一种特产的数量不超过 $1000$。", "outputFormat": "输出一行，不同分配方案的总数。\n\n由于输出结果可能非常巨大，你只需要输出最终结果\n$\\bmod\\ {10^9+7}$ 的数值就可以了。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2011] Distributing Local Specialties", "background": "", "description": "JYY led a team to several $\\text{ACM/ICPC}$ contests and brought back many local specialties, which he wants to distribute to the students in the lab.\n\nJYY wants to know: if these specialties are distributed to $n$ students, how many different distribution methods are there in total? Of course, JYY does not want any student to feel upset because they did not get any specialties, so each student must receive at least one specialty.\n\nFor example, JYY brought $2$ bags of twisted dough sticks and $1$ bag of buns, and distributes them to students $A$ and $B$. Then there are $4$ different distribution methods:\n\n$A$: twisted dough stick, $B$: twisted dough stick, bun\n\n$A$: twisted dough stick, twisted dough stick, $B$: bun\n\n$A$: bun, $B$: twisted dough stick, twisted dough stick\n\n$A$: twisted dough stick, bun, $B$: twisted dough stick", "inputFormat": "Input testdata:\n\nThe first line contains the number of students $n$ and the number of specialty types $m$.\n\nThe second line contains $m$ integers, where each integer represents the quantity of one type of specialty.\n\n$n, m$ do not exceed $1000$, and the quantity of each specialty type does not exceed $1000$.", "outputFormat": "Output one line: the total number of different distribution plans.\n\nSince the result may be extremely large, you only need to output the value of the final result $\\bmod\\ {10^9+7}$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2011] 分特产", "background": null, "description": "JYY 带队参加了若干场 $\\text{ACM/ICPC}$ 比赛，带回了许多土特产，要分给实验室的同学们。\n\nJYY 想知道，把这些特产分给 $n$ 个同学，一共有多少种不同的分法？当然，JYY 不希望任何一个同学因为没有拿到特产而感到失落，所以每个同学都必须至少分得一个特产。\n\n例如，JYY 带来了 $2$ 袋麻花和 $1$ 袋包子，分给 $A$ 和 $B$ 两位同学，那么共有 $4$ 种不同的\n分配方法：\n\n $A$：麻花， $B$：麻花、包子\n\n $A$：麻花、麻花， $B$：包子\n\n $A$：包子， $B$：麻花、麻花\n\n $A$：麻花、包子， $B$：麻花", "inputFormat": "输入数据：\n\n第一行是同学的数量 $n$ 和特产的种类 $m$。\n\n第二行包含 $m$ 个整数，表示每一种特产的数量。\n\n$n, m$ 不超过 $1000$ ，每一种特产的数量不超过 $1000$。", "outputFormat": "输出一行，不同分配方案的总数。\n\n由于输出结果可能非常巨大，你只需要输出最终结果\n$\\bmod\\ {10^9+7}$ 的数值就可以了。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5506", "type": "P", "difficulty": 4, "samples": [["4 7\n-1 -1 0 2 1 1 0 0 0 5 0 RAAAAAA\n51 0 1 1 4 0 0 1 0 5 0 UMMMMMM\n-2 0 0 2 0 0 0 0 0 5 1 FFFNNNN\n53 0 0 2 4 0 0 0 0 5 1 FFFNNNN\n", "6 0 0 1\n45 0 0 0\n5 0 0 4\n46 0 0 7\n"], ["7 1\n0 0 0 0 0 2 0 0 0 1 0 A\n1 0 0 0 0 4 0 0 0 3 0 A\n1 0 0 0 0 1 1 1 1 4 0 N\n1 0 -1 0 0 0 0 0 0 2 0 N\n0 1 0 0 0 0 0 3 0 3 0 M\n0 1 -1 0 0 0 0 0 1 3 0 N\n0 1 -1 0 0 0 0 0 2 3 0 N", "0 0 -1 1\n1 0 -1 3\n1 0 -1 4\n1 0 -2 2\n0 1 -1 3\n0 1 -2 1\n0 1 -2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟"], "title": "封锁", "background": "Steve 带领队伍准备去 M 星消灭黑暗势力，即将降落时被 M 星上空的无人机拦截了。", "description": "为了突破封锁，成功降落， Steve 使用了电磁干扰仪，使无人机开始自相残杀。\n\n然而，情况很快就变得混乱，无法了解当前的情况。\n\n幸好 Steve 的部队已经记录了开始混战前的状况，并设法获得了无人机执行操作的顺序。\n\n每架无人机有 $5$ 项属性 $atk,def,mat,mdf,fix$ ，当前生命值 $hp$ ，当前坐标 $(x,y,z)$ ，当前水平朝向 $f$( 范围 0-7) 和竖直朝向 $h$( 范围 0-4) 。\n\n每一时刻，所有存活的无人机会**先**向正前方移动一格。\n\n随后，存活的无人机会**按编号从小到大**依次执行下列操作之一：\n\n无操作 (N)\n\n上下转向 (U/D) ：改变 $h$ 的值，上为增加，下为减少，如果超过了范围就是无效操作，忽略。\n\n左右转向 (L/R) ：改变 $f$ 的值，左为增加，右为减少，循环（分别对应从上面看的逆时针，顺时针）。\n\n例如：当 $h=4$ 时操作 U 无效，当 $f=0$ 时操作 R 会使\n $f$ 变为 $7$ 。\n\n修复 (F) ：使 $hp$ 增加 $fix$ 点。\n\n子弹 (A) ：使位于这架无人机正前方**最近**的飞机受到伤害，伤害的值为当前飞机的 $atk$ 值与目标的 $def$ 值之差（差为负则不会造成伤害），**如果多架飞机处于同一位置，那么只有编号最小的飞机会受到伤害**。\n\n激光 (M) ：使位于这架无人机正前方的**所有**飞机受到伤害，伤害的值为当前飞机的 $mat$ 值与目标的 $mdf$ 值之差（差为负则不会造成伤害）。\n\n注意：与开火飞机重叠的飞机不会受到伤害\n\n如果受到伤害后， $hp\\leq 0$ ，那么这架飞机就会坠毁。\n\n对于 $f$ 和 $h$ ，它的“正前方”是这样定义的：\n\n首先，根据 $f$ 确定 $x,y$ 方向，如下图。\n\n![](https://cdn.luogu.com.cn/upload/pic/64952.png)\n\n随后，根据 $h$ 进一步确定方向。\n\n对于 $h=0$ 或 $h=4$ ，正前方是正下或正上（ $x,y$ 不变， $z$ 变化）。\n\n对于 $h=1$ 或 $h=3$ ，在上面方向的基础上再向下/上移动一格。\n\n对于 $h=2$ ，正前方为水平方向（ $x,y$ 如上所述， $z$ 不变）。\n\n（有人反馈看不懂方向，这里直接给出 $f,h$ 和正前方\n $(x,y,z)$ 的对应表）\n\n![](https://cdn.luogu.com.cn/upload/pic/71703.png)\n\n现在， Steve 告诉你了所有飞机初始的状态和之后执行的操作。\n\n你需要告诉他，经过 $t$ 个时刻的混战之后，每架飞机的位置和生命值。", "inputFormat": "第一行两个整数 $n,t$ ，表示飞机数和时刻数。\n\n接下来 $n$ 行，每行 $11$ 个整数和一个长为 $t$ 字符串，按编号顺序描述无人机。\n\n这 $11$ 个整数分别为 $x,y,z,h,f,atk,def,mat,mdf,hp,fix$ ，其中 $hp$ 为初始生命值。\n\n字符串的每一个字符均为大写字母，依次表示这 $t$ 个时刻的操作。", "outputFormat": "$n$ 行，每行 $4$ 个整数 $x,y,z,hp$ 。\n\n如果这架飞机没有坠毁，则输出坐标和最终的生命值。\n\n否则，输出坠毁前的坐标， $hp$ 输出 $0$ 。", "hint": "两架飞机移动并改变朝向后互相面对，随后它们分别向对面疯狂开火，最终 1 号飞机率先击落 2 号飞机，因为 2 号飞机已经坠毁，所以 1 号飞机不会被击落。\n\n而它们身后分别跟着两架飞机， 2 号飞机使用激光，所以 3 号飞机也会受到伤害， 1 号飞机使用子弹，所以 4 号飞机不会受到伤害，直到 2 号飞机坠毁后， 1 号飞机发出最后一颗子弹，对 4 号飞机造成了一点伤害。同时两架飞机前三次操作分别进行了三次修复， $hp$ 增加了 $3$ 。\n\n测试时，每个 Subtask 包括 3 个测试点，全部通过才能得到该 Subtask 的分数\n\n------------\n\n样例 2 解释：<https://www.luogu.com.cn/discuss/582252>\n\n---\n\n数据范围：\n\n$1\\leq n,t\\leq 100$\n\n输入的所有数字大小在合理范围内，且绝对值均不大于 $100$ 。\n\n其中 $atk,def,mat,mdf,fix$ 为非负整数。\n\n$hp$ 为正整数。\n\n$x,y,z$ 为整数。\n\n$h$ 为 $0,1,2,3,4$ 中的一个。\n\n$f$ 为 $0,1,2,3,4,5,6,7$ 中的一个。\n\n字符串仅包含 $NFLRUDAM$ $8$ 种字符。\n\n另外，对于前 3 个 subtask ，保证任何时刻飞机的 z 坐标为\n $0$ 。\n\nSubtask | 分值 | 出现的操作\n:-: | :-: | :-: \n1| 12| N\n2| 14| NF\n3| 15| NFLR\n4| 17| NFLRUD\n5| 19| NFLRUDM\n6| 23| NFLRUDMA", "locale": "zh-CN", "translations": {"en": {"title": "Blockade.", "background": "Steve led his team to Planet M to wipe out the dark forces. Just as they were about to land, they were intercepted by drones in the sky above Planet M.", "description": "To break through the blockade and land successfully, Steve used an electromagnetic jammer, causing the drones to start killing each other.\n\nHowever, the situation quickly became chaotic, and it was impossible to understand what was happening.\n\nFortunately, Steve’s troops recorded the situation before the brawl started, and managed to obtain the order of operations executed by the drones.\n\nEach drone has $5$ attributes: $atk,def,mat,mdf,fix$, its current health $hp$, its current coordinates $(x,y,z)$, its current horizontal facing $f$ (range $0$–$7$), and its vertical facing $h$ (range $0$–$4$).\n\nAt each moment, all surviving drones will **first** move one cell straight forward.\n\nThen, the surviving drones will **in increasing order of their IDs** execute exactly one of the following operations:\n\n- No operation (N).\n\n- Turn up/down (U/D): change the value of $h$. Up means increase, down means decrease. If it goes out of range, the operation is invalid and should be ignored.\n\n- Turn left/right (L/R): change the value of $f$. Left means increase, right means decrease, with wrap-around (corresponding to counterclockwise/clockwise when viewed from above).\n\nFor example, when $h=4$, operation U is invalid. When $f=0$, operation R will change $f$ to $7$.\n\n- Repair (F): increase $hp$ by $fix$.\n\n- Bullet (A): deal damage to the **nearest** drone located straight ahead of this drone. The damage value is the difference between the attacker’s current $atk$ and the target’s $def$ (if the difference is negative, it deals no damage). **If multiple drones are at the same position, only the one with the smallest ID takes damage**.\n\n- Laser (M): deal damage to **all** drones straight ahead of this drone. The damage value is the difference between the attacker’s current $mat$ and the target’s $mdf$ (if the difference is negative, it deals no damage).\n\nNote: drones overlapping with the firing drone will not take damage.\n\nIf after taking damage, $hp\\leq 0$, then the drone crashes.\n\nFor $f$ and $h$, “straight ahead” is defined as follows:\n\nFirst, determine the $x,y$ direction based on $f$, as shown in the figure below.\n\n![](https://cdn.luogu.com.cn/upload/pic/64952.png)\n\nThen, further determine the direction based on $h$.\n\n- For $h=0$ or $h=4$, straight ahead is straight down or straight up ($x,y$ unchanged, $z$ changes).\n\n- For $h=1$ or $h=3$, based on the horizontal direction above, also move one cell down/up.\n\n- For $h=2$, straight ahead is the horizontal direction ($x,y$ as above, $z$ unchanged).\n\n(Some people reported that the direction is hard to understand. Here is the direct correspondence table of $f,h$ and the straight-ahead $(x,y,z)$.)\n\n![](https://cdn.luogu.com.cn/upload/pic/71703.png)\n\nNow, Steve has told you the initial state of all drones and the operations they execute afterward.\n\nYou need to tell him, after $t$ moments of fighting, the position and health of each drone.", "inputFormat": "The first line contains two integers $n,t$, representing the number of drones and the number of moments.\n\nThe next $n$ lines each contain $11$ integers and a string of length $t$, describing the drones in order of their IDs.\n\nThese $11$ integers are $x,y,z,h,f,atk,def,mat,mdf,hp,fix$, where $hp$ is the initial health.\n\nEach character in the string is an uppercase letter, representing the operation at each of the $t$ moments in order.", "outputFormat": "Output $n$ lines, each with $4$ integers $x,y,z,hp$.\n\nIf the drone has not crashed, output its coordinates and final health.\n\nOtherwise, output its coordinates right before crashing, and output $0$ for $hp$.", "hint": "After two drones move and change their facing directions, they end up facing each other. Then they both fire crazily at each other. In the end, Drone $1$ shoots down Drone $2$ first. Since Drone $2$ has already crashed, Drone $1$ will not be shot down.\n\nBehind them there are two drones following respectively. Drone $2$ uses a laser, so Drone $3$ will also take damage. Drone $1$ uses bullets, so Drone $4$ will not take damage. This continues until Drone $2$ crashes, after which Drone $1$ fires one last bullet and deals $1$ point of damage to Drone $4$. At the same time, in their first three operations, both drones performed three repairs, so $hp$ increases by $3$.\n\nDuring judging, each Subtask includes 3 test points. You can get the score of that Subtask only if you pass all of them.\n\n------------\n\nSample 2 explanation: <https://www.luogu.com.cn/discuss/582252>\n\n---\n\nConstraints:\n\n$1\\leq n,t\\leq 100$\n\nAll input numbers are within reasonable ranges, and their absolute values are all at most $100$.\n\nAmong them, $atk,def,mat,mdf,fix$ are non-negative integers.\n\n$hp$ is a positive integer.\n\n$x,y,z$ are integers.\n\n$h$ is one of $0,1,2,3,4$.\n\n$f$ is one of $0,1,2,3,4,5,6,7$.\n\nThe string contains only $8$ kinds of characters: $NFLRUDAM$.\n\nIn addition, for the first 3 subtasks, it is guaranteed that at any moment, the drones’ $z$ coordinates are $0$.\n\nSubtask | Score | Operations Appearing\n:-: | :-: | :-:\n1| 12| N\n2| 14| NF\n3| 15| NFLR\n4| 17| NFLRUD\n5| 19| NFLRUDM\n6| 23| NFLRUDMA\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "封锁", "background": "Steve 带领队伍准备去 M 星消灭黑暗势力，即将降落时被 M 星上空的无人机拦截了。", "description": "为了突破封锁，成功降落， Steve 使用了电磁干扰仪，使无人机开始自相残杀。\n\n然而，情况很快就变得混乱，无法了解当前的情况。\n\n幸好 Steve 的部队已经记录了开始混战前的状况，并设法获得了无人机执行操作的顺序。\n\n每架无人机有 $5$ 项属性 $atk,def,mat,mdf,fix$ ，当前生命值 $hp$ ，当前坐标 $(x,y,z)$ ，当前水平朝向 $f$( 范围 0-7) 和竖直朝向 $h$( 范围 0-4) 。\n\n每一时刻，所有存活的无人机会**先**向正前方移动一格。\n\n随后，存活的无人机会**按编号从小到大**依次执行下列操作之一：\n\n无操作 (N)\n\n上下转向 (U/D) ：改变 $h$ 的值，上为增加，下为减少，如果超过了范围就是无效操作，忽略。\n\n左右转向 (L/R) ：改变 $f$ 的值，左为增加，右为减少，循环（分别对应从上面看的逆时针，顺时针）。\n\n例如：当 $h=4$ 时操作 U 无效，当 $f=0$ 时操作 R 会使\n $f$ 变为 $7$ 。\n\n修复 (F) ：使 $hp$ 增加 $fix$ 点。\n\n子弹 (A) ：使位于这架无人机正前方**最近**的飞机受到伤害，伤害的值为当前飞机的 $atk$ 值与目标的 $def$ 值之差（差为负则不会造成伤害），**如果多架飞机处于同一位置，那么只有编号最小的飞机会受到伤害**。\n\n激光 (M) ：使位于这架无人机正前方的**所有**飞机受到伤害，伤害的值为当前飞机的 $mat$ 值与目标的 $mdf$ 值之差（差为负则不会造成伤害）。\n\n注意：与开火飞机重叠的飞机不会受到伤害\n\n如果受到伤害后， $hp\\leq 0$ ，那么这架飞机就会坠毁。\n\n对于 $f$ 和 $h$ ，它的“正前方”是这样定义的：\n\n首先，根据 $f$ 确定 $x,y$ 方向，如下图。\n\n![](https://cdn.luogu.com.cn/upload/pic/64952.png)\n\n随后，根据 $h$ 进一步确定方向。\n\n对于 $h=0$ 或 $h=4$ ，正前方是正下或正上（ $x,y$ 不变， $z$ 变化）。\n\n对于 $h=1$ 或 $h=3$ ，在上面方向的基础上再向下/上移动一格。\n\n对于 $h=2$ ，正前方为水平方向（ $x,y$ 如上所述， $z$ 不变）。\n\n（有人反馈看不懂方向，这里直接给出 $f,h$ 和正前方\n $(x,y,z)$ 的对应表）\n\n![](https://cdn.luogu.com.cn/upload/pic/71703.png)\n\n现在， Steve 告诉你了所有飞机初始的状态和之后执行的操作。\n\n你需要告诉他，经过 $t$ 个时刻的混战之后，每架飞机的位置和生命值。", "inputFormat": "第一行两个整数 $n,t$ ，表示飞机数和时刻数。\n\n接下来 $n$ 行，每行 $11$ 个整数和一个长为 $t$ 字符串，按编号顺序描述无人机。\n\n这 $11$ 个整数分别为 $x,y,z,h,f,atk,def,mat,mdf,hp,fix$ ，其中 $hp$ 为初始生命值。\n\n字符串的每一个字符均为大写字母，依次表示这 $t$ 个时刻的操作。", "outputFormat": "$n$ 行，每行 $4$ 个整数 $x,y,z,hp$ 。\n\n如果这架飞机没有坠毁，则输出坐标和最终的生命值。\n\n否则，输出坠毁前的坐标， $hp$ 输出 $0$ 。", "hint": "两架飞机移动并改变朝向后互相面对，随后它们分别向对面疯狂开火，最终 1 号飞机率先击落 2 号飞机，因为 2 号飞机已经坠毁，所以 1 号飞机不会被击落。\n\n而它们身后分别跟着两架飞机， 2 号飞机使用激光，所以 3 号飞机也会受到伤害， 1 号飞机使用子弹，所以 4 号飞机不会受到伤害，直到 2 号飞机坠毁后， 1 号飞机发出最后一颗子弹，对 4 号飞机造成了一点伤害。同时两架飞机前三次操作分别进行了三次修复， $hp$ 增加了 $3$ 。\n\n测试时，每个 Subtask 包括 3 个测试点，全部通过才能得到该 Subtask 的分数\n\n------------\n\n样例 2 解释：<https://www.luogu.com.cn/discuss/582252>\n\n---\n\n数据范围：\n\n$1\\leq n,t\\leq 100$\n\n输入的所有数字大小在合理范围内，且绝对值均不大于 $100$ 。\n\n其中 $atk,def,mat,mdf,fix$ 为非负整数。\n\n$hp$ 为正整数。\n\n$x,y,z$ 为整数。\n\n$h$ 为 $0,1,2,3,4$ 中的一个。\n\n$f$ 为 $0,1,2,3,4,5,6,7$ 中的一个。\n\n字符串仅包含 $NFLRUDAM$ $8$ 种字符。\n\n另外，对于前 3 个 subtask ，保证任何时刻飞机的 z 坐标为\n $0$ 。\n\nSubtask | 分值 | 出现的操作\n:-: | :-: | :-: \n1| 12| N\n2| 14| NF\n3| 15| NFLR\n4| 17| NFLRUD\n5| 19| NFLRUDM\n6| 23| NFLRUDMA", "locale": "zh-CN"}}}
{"pid": "P5507", "type": "P", "difficulty": 5, "samples": [["3 3 7 2 6\n3 1 4 5 3\n3 1 2 6 4\n3 1 10 3 5\n3 2 8 3 6\n3 7 9 2 1\n1 1 2 3 4\n1 3 11 10 12\n1 8 6 7 4\n1 9 9 8 8\n1 12 10 12 12\n1 7 8 9 10\n", "6\n1 2 3 4 5 6\n"], ["3 3 7 2 6\n3 1 4 5 3\n3 1 2 6 4\n3 1 10 3 5\n3 2 8 3 6\n3 7 9 2 1\n1 1 2 3 4\n1 3 11 10 12\n1 8 6 7 4\n1 9 9 8 8\n1 12 10 12 12\n1 7 8 9 10\n", "6\n1 1 2 3 4 5\n"], ["4 2 2 2 2\n4 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n1 1 1 1 1\n", "1\n1\n"], ["4 9 3 4 5 \n1 9 8 12 11 \n4 7 5 6 12 \n3 2 2 11 2 \n3 6 8 2 12 \n4 8 4 2 11 \n2 12 9 5 3 \n4 1 1 11 1 \n1 1 7 4 1 \n4 11 6 12 8 \n2 6 3 7 6 \n4 3 9 7 10 \n", "10\n11 4 6 10 7 7 5 9 9 9 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["搜索", "Special Judge", "O2优化", "广度优先搜索 BFS", "启发式搜索"], "title": "机关", "background": "Steve 成功降落后，在 M 星上发现了一扇大门，但是这扇大门是锁着的。", "description": "这扇门上有一个机关，上面一共有 $12$ 个旋钮，每个旋钮有 $4$ 个状态，将旋钮的状态用数字 $1$ 到 $4$ 表示。\n\n每个旋钮只能向一个方向旋转（状态：$1\\rightarrow2\\rightarrow3\\rightarrow4\\rightarrow1$），在旋转时，会引起另一个旋钮也旋转一次（方向相同，不会引起连锁反应），同一旋钮在不同状态下，可能会引起不同的旋钮旋转（在输入中给出）。\n\n当所有旋钮都旋转到状态 $1$ 时，机关就打开了。\n\n由于旋钮年久失修，旋转一次很困难，而且时间很紧迫，因此 Steve 希望用最少的旋转次数打开机关。\n\n这个任务就交给你了。", "inputFormat": "$12$ 行，每行 $5$ 个整数，描述机关的状态。\n\n第 $i$ 行第一个整数 $s_i$ 表示第 $i$ 个旋钮的初始状态是 $s_i$。\n\n接下来 $4$ 个整数 $a_{i,j},j=1,2,3,4$ 表示这个旋钮在状态 $j$ 时旋转，会引起第 $a_{i,j}$ 个旋钮旋转到下一个状态。", "outputFormat": "第一行一个整数 $n$，表示最少的步数。\n\n第二行 $n$ 个整数，表示依次旋转的旋钮编号。\n\n数据保证有解。", "hint": "样例 $1$ 和 $2$ 输入相同，两个输出都可以通过。\n\n样例 $4$ 解释：\n```\n414334 241424\n旋转11到状态3，引起3旋转到状态1\n411334 241434\n旋转4到状态4，引起11旋转到状态4\n411434 241444\n旋转6到状态1，引起11旋转到状态1\n411431 241414\n旋转10到状态1，引起8旋转到状态1\n411431 211114\n旋转7到状态3，引起9旋转到状态2\n411431 312114\n旋转7到状态4，引起5旋转到状态4\n411441 412114\n旋转5到状态1，引起12旋转到状态1\n411411 412111\n旋转9到状态3，引起7旋转到状态1\n411411 113111\n旋转9到状态4，引起4旋转到状态1\n411111 114111\n旋转9到状态1，引起1旋转到状态1\n111111 111111\n```\n\n数据保证存在打开机关的方式。\n\n每个测试点 $10$ 分。\n\n只要你输出格式正确，输出了正确的步数，并给出了任意一种正确方案，就能得到该测试点的得分。\n\n否则，该测试点不得分。\n\n数据范围：\n\n测试点 | 所需步数\n:-: | :-:\n1 | 4|\n2|6|\n3|8|\n4|9|\n5|10|\n6|11|\n7|12|\n8|13|\n9|15|\n10|17|", "locale": "zh-CN", "translations": {"en": {"title": "Mechanism", "background": "After Steve landed successfully, he found a gate on Planet M, but the gate was locked.", "description": "There is a mechanism on the gate. It has a total of $12$ knobs, and each knob has $4$ states. The states of a knob are represented by the numbers $1$ to $4$.\n\nEach knob can only be rotated in one direction (states: $1\\rightarrow2\\rightarrow3\\rightarrow4\\rightarrow1$). When it is rotated, it will cause another knob to rotate once as well (in the same direction, and it will not cause a chain reaction). The same knob, when in different states, may cause different knobs to rotate (given in the input).\n\nWhen all knobs are rotated to state $1$, the mechanism opens.\n\nBecause the knobs have not been maintained for a long time, rotating once is difficult, and time is tight. Therefore, Steve wants to open the mechanism using the minimum number of rotations.\n\nThis task is left to you.", "inputFormat": "There are $12$ lines, each containing $5$ integers, describing the state of the mechanism.\n\nOn line $i$, the first integer $s_i$ indicates that the initial state of the $i$-th knob is $s_i$.\n\nThe next $4$ integers $a_{i,j}, j=1,2,3,4$ indicate that when this knob is in state $j$ and is rotated, it will cause the $a_{i,j}$-th knob to rotate to the next state.", "outputFormat": "The first line contains an integer $n$, indicating the minimum number of steps.\n\nThe second line contains $n$ integers, indicating the indices of the knobs rotated in order.\n\nThe testdata guarantees that a solution exists.", "hint": "Samples $1$ and $2$ have the same input, and both outputs are accepted.\n\nExplanation for sample $4$:\n```\n414334 241424\nRotate knob 11 to state 3, causing knob 3 to rotate to state 1.\n411334 241434\nRotate knob 4 to state 4, causing knob 11 to rotate to state 4.\n411434 241444\nRotate knob 6 to state 1, causing knob 11 to rotate to state 1.\n411431 241414\nRotate knob 10 to state 1, causing knob 8 to rotate to state 1.\n411431 211114\nRotate knob 7 to state 3, causing knob 9 to rotate to state 2.\n411431 312114\nRotate knob 7 to state 4, causing knob 5 to rotate to state 4.\n411441 412114\nRotate knob 5 to state 1, causing knob 12 to rotate to state 1.\n411411 412111\nRotate knob 9 to state 3, causing knob 7 to rotate to state 1.\n411411 113111\nRotate knob 9 to state 4, causing knob 4 to rotate to state 1.\n411111 114111\nRotate knob 9 to state 1, causing knob 1 to rotate to state 1.\n111111 111111\n```\n\nThe testdata guarantees that there is a way to open the mechanism.\n\nEach test point is worth $10$ points.\n\nAs long as your output format is correct, you output the correct number of steps, and you provide any correct solution, you will get the score for that test point.\n\nOtherwise, you will get $0$ points for that test point.\n\nConstraints:\n\nTest point | Required steps\n:-: | :-:\n1 | 4\n2 | 6\n3 | 8\n4 | 9\n5 | 10\n6 | 11\n7 | 12\n8 | 13\n9 | 15\n10 | 17\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "机关", "background": "Steve 成功降落后，在 M 星上发现了一扇大门，但是这扇大门是锁着的。", "description": "这扇门上有一个机关，上面一共有 $12$ 个旋钮，每个旋钮有 $4$ 个状态，将旋钮的状态用数字 $1$ 到 $4$ 表示。\n\n每个旋钮只能向一个方向旋转（状态：$1\\rightarrow2\\rightarrow3\\rightarrow4\\rightarrow1$），在旋转时，会引起另一个旋钮也旋转一次（方向相同，不会引起连锁反应），同一旋钮在不同状态下，可能会引起不同的旋钮旋转（在输入中给出）。\n\n当所有旋钮都旋转到状态 $1$ 时，机关就打开了。\n\n由于旋钮年久失修，旋转一次很困难，而且时间很紧迫，因此 Steve 希望用最少的旋转次数打开机关。\n\n这个任务就交给你了。", "inputFormat": "$12$ 行，每行 $5$ 个整数，描述机关的状态。\n\n第 $i$ 行第一个整数 $s_i$ 表示第 $i$ 个旋钮的初始状态是 $s_i$。\n\n接下来 $4$ 个整数 $a_{i,j},j=1,2,3,4$ 表示这个旋钮在状态 $j$ 时旋转，会引起第 $a_{i,j}$ 个旋钮旋转到下一个状态。", "outputFormat": "第一行一个整数 $n$，表示最少的步数。\n\n第二行 $n$ 个整数，表示依次旋转的旋钮编号。\n\n数据保证有解。", "hint": "样例 $1$ 和 $2$ 输入相同，两个输出都可以通过。\n\n样例 $4$ 解释：\n```\n414334 241424\n旋转11到状态3，引起3旋转到状态1\n411334 241434\n旋转4到状态4，引起11旋转到状态4\n411434 241444\n旋转6到状态1，引起11旋转到状态1\n411431 241414\n旋转10到状态1，引起8旋转到状态1\n411431 211114\n旋转7到状态3，引起9旋转到状态2\n411431 312114\n旋转7到状态4，引起5旋转到状态4\n411441 412114\n旋转5到状态1，引起12旋转到状态1\n411411 412111\n旋转9到状态3，引起7旋转到状态1\n411411 113111\n旋转9到状态4，引起4旋转到状态1\n411111 114111\n旋转9到状态1，引起1旋转到状态1\n111111 111111\n```\n\n数据保证存在打开机关的方式。\n\n每个测试点 $10$ 分。\n\n只要你输出格式正确，输出了正确的步数，并给出了任意一种正确方案，就能得到该测试点的得分。\n\n否则，该测试点不得分。\n\n数据范围：\n\n测试点 | 所需步数\n:-: | :-:\n1 | 4|\n2|6|\n3|8|\n4|9|\n5|10|\n6|11|\n7|12|\n8|13|\n9|15|\n10|17|", "locale": "zh-CN"}}}
{"pid": "P5508", "type": "P", "difficulty": 6, "samples": [["6 2\n0 1 2 0 0 0\n1 1 2 3 5\n4 5 6 6 2\n", "9\n3\n1 2 6"], ["6 2\n0 1 2 0 0 0\n1 1 2 3 5\n4 5 6 6 2\n", "9\n4\n1 3 4 6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["图论", "线段树", "Special Judge", "O2优化"], "title": "寻宝", "background": "Steve成功打开了机关，发现机关后是一个巨大的迷宫", "description": "这个迷宫一共有$n$个洞穴，洞穴之间有很多单向隧道，很难数清\n\n但经过分析，发现：\n\n这些隧道可以分为$m$组，对于每一组，编号在区间$[s_l,s_r]$内的每一个洞穴，与编号在区间$[t_l,t_r]$内的每一个洞穴之间，都有一条隧道，每组内共有$(s_r-s_l+1)\\cdot (t_r-t_l+1)$条隧道，通过同组内每一条隧道的时间都相等\n\n为了进一步节约时间，Steve可以挖掘新的隧道\n\n但是，每个洞穴的性质不同，导致挖掘隧道的难度不同，有些洞穴甚至无法挖掘隧道\n\n具体来说，第$i$个洞穴有一个值$v_i$，$v_i=0$表示无法挖掘隧道，对于其它值，表示从第$i$个洞穴开始，挖掘一条到第$j$个洞穴的隧道，并到达第$j$个隧道，需要花费$|i-j|*v_i$时间\n\nSteve希望在最短时间内到达第$n$个洞穴，决定不限制挖掘隧道的数量\n\n现在，你需要告诉Steve最少需要用的时间\n\n如果可能，你应帮助Steve求出一种最优方案", "inputFormat": "第一行两个整数$n,m$\n\n接下来一行$n$个整数$v_1,v_2,...,v_n$\n\n接下来$m$行，每行描述一组隧道\n\n每行$5$个整数$s_l,s_r,t_l,t_r,w$，其中$w$表示通过时间", "outputFormat": "如果无解，则只需输出一行一个整数\"-1\"(不含引号)\n\n如果有解，则按下列格式输出：\n\n第一行一个整数$t$，表示最少花费的时间\n\n如果你无法给出方案，在第二行输出一个整数$0$\n\n如果你可以给出方案，在第二行输出一个整数$c$，在第三行输出$c$个整数，依次表示一种最优方案经过的洞穴编号\n\n你并不需要告诉Steve经过的隧道是否为挖掘出来的，或者属于哪一组", "hint": "样例1：1号到2号走第一组隧道，2号到6号挖掘隧道，用时$1*(6-2)=4$\n\n样例2：1号到3号走第一组隧道，3号到4号挖掘隧道，用时$2*(4-3)=2$，4号到6号走第二组隧道\n\n每个Subtask包括两个测试点，取较低分\n\n对于每个测试点：\n\n如果输出格式错误，那么，该测试点得0分\n\n如果你没有给出正确的用时，那么，该测试点得0分\n\n如果你给出正确的用时，但没有给出方案，那么你可以得到该测试点一半的分数（每个测试点得分向下取整）\n\n如果你给出了错误方案，那么你可能可以得到该测试点一半的分数，或者得0分\n\n如果你给出了正确的方案，那么你可以得到该测试点全部的分数\n\n上面两个输出都可以得到满分，还有一种方案是$1 2 4 6$\n\n如果你输出：\n\n```\n9\n0\n```\n那么你可以得到该测试点一半的分数\n\n数据范围：\n\n$1\\le w,v_i \\le 10^9$\n\nSubtask | 分值| n | m| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1 | 5| 100| 100| | \n2| 10| 3000| 3000| |\n3| 11| 50000| 50000| 2,3|\n4| 10| 50000| 50000| 1|\n5| 12| 50000| 0| |\n6| 12| 50000| 1| |\n7| 13| 50000| 20|3 |\n8| 13| 50000| 20| |\n9| 14| 50000| 50000| |\n\n特殊性质1：所有$v_i=0$\n\n特殊性质2：所有$v_i \\in \\{0,k\\}$，$k$为常数\n\n特殊性质3：所有$s_l=s_r,t_l=t_r$\n\n保证存在到达$n$号洞穴的方案\n\n关于输出错误方案：\n\n如果输出的$2\\leq c\\leq n$，经过的点以$1$开头，以$n$结尾，且中间的点都是在$(1,n)$的整数，则这组解可能是一组最优解，可以得到一半分数\n\n否则，得0分\n\n~~不用担心spj会TLE/MLE~~", "locale": "zh-CN", "translations": {"en": {"title": "Treasure Hunt.", "background": "Steve successfully opened the mechanism, and found that behind it was a huge maze.", "description": "This maze has a total of $n$ caves. There are many one-way tunnels between the caves, so many that it is hard to count them.\n\nHowever, after analysis, it is found that:\n\nThese tunnels can be divided into $m$ groups. For each group, for every cave with an index in the interval $[s_l,s_r]$, and every cave with an index in the interval $[t_l,t_r]$, there is a tunnel between them. Each group contains a total of $(s_r-s_l+1)\\cdot (t_r-t_l+1)$ tunnels, and the time to pass through any tunnel in the same group is the same.\n\nTo further save time, Steve can dig new tunnels.\n\nHowever, each cave has different properties, which makes digging tunnels of different difficulty. Some caves cannot even dig tunnels.\n\nSpecifically, the $i$-th cave has a value $v_i$. $v_i=0$ means tunnels cannot be dug from it. For other values, it means that starting from cave $i$, digging a tunnel to cave $j$ and arriving at cave $j$ costs $|i-j|*v_i$ time.\n\nSteve wants to reach cave $n$ in the shortest time, and decides not to limit the number of tunnels he digs.\n\nNow, you need to tell Steve the minimum time required.\n\nIf possible, you should help Steve find an optimal plan.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe next line contains $n$ integers $v_1,v_2,...,v_n$.\n\nThe next $m$ lines each describe a group of tunnels.\n\nEach line contains $5$ integers $s_l,s_r,t_l,t_r,w$, where $w$ is the travel time.", "outputFormat": "If there is no solution, output only one line with one integer $-1$.\n\nIf there is a solution, output in the following format:\n\nThe first line contains an integer $t$, which is the minimum time spent.\n\nIf you cannot provide a plan, output an integer $0$ on the second line.\n\nIf you can provide a plan, output an integer $c$ on the second line, and output $c$ integers on the third line, representing (in order) the cave indices visited by one optimal plan.\n\nYou do not need to tell Steve whether each tunnel used is dug, or which group it belongs to.", "hint": "Sample 1: From cave $1$ to cave $2$ use the first group tunnel, then from cave $2$ to cave $6$ dig a tunnel, costing $1*(6-2)=4$ time.\n\nSample 2: From cave $1$ to cave $3$ use the first group tunnel, then from cave $3$ to cave $4$ dig a tunnel, costing $2*(4-3)=2$, then from cave $4$ to cave $6$ use the second group tunnel.\n\nEach subtask includes two test points, and the lower score is taken.\n\nFor each test point:\n\nIf the output format is wrong, then this test point scores $0$.\n\nIf you do not output the correct time, then this test point scores $0$.\n\nIf you output the correct time but do not give a plan, then you can get half of the score of this test point (the score of each test point is rounded down).\n\nIf you give a wrong plan, then you may get half of the score of this test point, or get $0$.\n\nIf you give a correct plan, then you can get the full score of this test point.\n\nThe two outputs above can both get full score. Another plan is $1 2 4 6$.\n\nIf you output:\n\n```\n9\n0\n```\n\nthen you can get half of the score for this test point.\n\nConstraints:\n\n$1\\le w,v_i \\le 10^9$.\n\nSubtask | Score | n | m | Special Property\n:-: | :-: | :-: | :-: | :-:\n1 | 5 | 100 | 100 | |\n2 | 10 | 3000 | 3000 | |\n3 | 11 | 50000 | 50000 | 2,3 |\n4 | 10 | 50000 | 50000 | 1 |\n5 | 12 | 50000 | 0 | |\n6 | 12 | 50000 | 1 | |\n7 | 13 | 50000 | 20 | 3 |\n8 | 13 | 50000 | 20 | |\n9 | 14 | 50000 | 50000 | |\n\nSpecial Property 1: All $v_i=0$.\n\nSpecial Property 2: All $v_i \\in \\{0,k\\}$, where $k$ is a constant.\n\nSpecial Property 3: All $s_l=s_r,t_l=t_r$.\n\nIt is guaranteed that there exists a plan to reach cave $n$.\n\nAbout outputting a wrong plan:\n\nIf the output satisfies $2\\leq c\\leq n$, the visited nodes start with $1$ and end with $n$, and all intermediate nodes are integers in $(1,n)$, then this set of output may be an optimal solution, and you can get half of the score.\n\nOtherwise, you get $0$.\n\n~~Do not worry about the SPJ TLE/MLE.~~\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "寻宝", "background": "Steve成功打开了机关，发现机关后是一个巨大的迷宫", "description": "这个迷宫一共有$n$个洞穴，洞穴之间有很多单向隧道，很难数清\n\n但经过分析，发现：\n\n这些隧道可以分为$m$组，对于每一组，编号在区间$[s_l,s_r]$内的每一个洞穴，与编号在区间$[t_l,t_r]$内的每一个洞穴之间，都有一条隧道，每组内共有$(s_r-s_l+1)\\cdot (t_r-t_l+1)$条隧道，通过同组内每一条隧道的时间都相等\n\n为了进一步节约时间，Steve可以挖掘新的隧道\n\n但是，每个洞穴的性质不同，导致挖掘隧道的难度不同，有些洞穴甚至无法挖掘隧道\n\n具体来说，第$i$个洞穴有一个值$v_i$，$v_i=0$表示无法挖掘隧道，对于其它值，表示从第$i$个洞穴开始，挖掘一条到第$j$个洞穴的隧道，并到达第$j$个隧道，需要花费$|i-j|*v_i$时间\n\nSteve希望在最短时间内到达第$n$个洞穴，决定不限制挖掘隧道的数量\n\n现在，你需要告诉Steve最少需要用的时间\n\n如果可能，你应帮助Steve求出一种最优方案", "inputFormat": "第一行两个整数$n,m$\n\n接下来一行$n$个整数$v_1,v_2,...,v_n$\n\n接下来$m$行，每行描述一组隧道\n\n每行$5$个整数$s_l,s_r,t_l,t_r,w$，其中$w$表示通过时间", "outputFormat": "如果无解，则只需输出一行一个整数\"-1\"(不含引号)\n\n如果有解，则按下列格式输出：\n\n第一行一个整数$t$，表示最少花费的时间\n\n如果你无法给出方案，在第二行输出一个整数$0$\n\n如果你可以给出方案，在第二行输出一个整数$c$，在第三行输出$c$个整数，依次表示一种最优方案经过的洞穴编号\n\n你并不需要告诉Steve经过的隧道是否为挖掘出来的，或者属于哪一组", "hint": "样例1：1号到2号走第一组隧道，2号到6号挖掘隧道，用时$1*(6-2)=4$\n\n样例2：1号到3号走第一组隧道，3号到4号挖掘隧道，用时$2*(4-3)=2$，4号到6号走第二组隧道\n\n每个Subtask包括两个测试点，取较低分\n\n对于每个测试点：\n\n如果输出格式错误，那么，该测试点得0分\n\n如果你没有给出正确的用时，那么，该测试点得0分\n\n如果你给出正确的用时，但没有给出方案，那么你可以得到该测试点一半的分数（每个测试点得分向下取整）\n\n如果你给出了错误方案，那么你可能可以得到该测试点一半的分数，或者得0分\n\n如果你给出了正确的方案，那么你可以得到该测试点全部的分数\n\n上面两个输出都可以得到满分，还有一种方案是$1 2 4 6$\n\n如果你输出：\n\n```\n9\n0\n```\n那么你可以得到该测试点一半的分数\n\n数据范围：\n\n$1\\le w,v_i \\le 10^9$\n\nSubtask | 分值| n | m| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1 | 5| 100| 100| | \n2| 10| 3000| 3000| |\n3| 11| 50000| 50000| 2,3|\n4| 10| 50000| 50000| 1|\n5| 12| 50000| 0| |\n6| 12| 50000| 1| |\n7| 13| 50000| 20|3 |\n8| 13| 50000| 20| |\n9| 14| 50000| 50000| |\n\n特殊性质1：所有$v_i=0$\n\n特殊性质2：所有$v_i \\in \\{0,k\\}$，$k$为常数\n\n特殊性质3：所有$s_l=s_r,t_l=t_r$\n\n保证存在到达$n$号洞穴的方案\n\n关于输出错误方案：\n\n如果输出的$2\\leq c\\leq n$，经过的点以$1$开头，以$n$结尾，且中间的点都是在$(1,n)$的整数，则这组解可能是一组最优解，可以得到一半分数\n\n否则，得0分\n\n~~不用担心spj会TLE/MLE~~", "locale": "zh-CN"}}}
{"pid": "P5509", "type": "P", "difficulty": 5, "samples": [["5\n2 2\n3 3\n1 4\n2 4\n3 4\n", "3\n7\n1\n381716\n127244\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "逆元"], "title": "派遣", "background": "Steve在洞穴里发现了一张地图，上面标识出了黑暗势力的据点，他决定派遣一些士兵前去", "description": "然而，这些士兵不一定具有与黑暗势力作战的能力，因而最终被派遣的士兵是未知的\n\n为了尽量了解派遣的士兵的情况，Steve需要你帮忙计算一些值\n\nSteve一共有$t$支军队，每支军队的人数都不同\n\n每支军队可以按一定标准排成$n \\times k$的方阵，每个士兵的位置可以用坐标$(x,y)$表示，其中$0\\le x < n,0 \\le y <k$，这个士兵的编号就是$x\\cdot k+y$\n\n位于$(0,0)$位置的士兵是队长，无论任何情况都会被派遣\n\n对于其余的士兵，可以派遣，也可以不派遣\n\n一支$n \\times k$的军队的能力值是这样定义的：\n\n如果所有士兵都被派遣，那么能力值是$1$\n\n如果位于$(x,y)$位置的士兵(编号为$i$)未被派遣，那么能力值变为原来的$\\frac{x}{i-x}$\n\n例如，对于一支$2\\times 2$的军队，如果$(1,1)$位置的士兵(编号为$3$)未被派遣，其他士兵都被派遣，那么能力值为$\\frac{1}{3-1}=\\frac{1}{2}$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(0,1)$位置的士兵(编号为$1$)都未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(1,0)$位置的士兵(编号为$2$)都未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{1}{2-1} = \\frac{1}{2}$\n\n现在，Steve需要你为每一支军队，计算出所有可能派遣方案的能力值之和\n\n为了避免出现分数，输出结果是模$1145141$意义下的值\n\n如果这个值不存在，那么输出$-1$\n\n也就是，如果你的答案为既约分数$\\frac{p}{q}$，你需要找到一个最小的非负整数$a$，满足$p\\equiv q\\cdot a(mod 1145141)$，并输出这个值，如果不存在这样的整数，就输出$-1$\n\n提示：$1145141$是质数", "inputFormat": "第一行一个整数$t$\n\n接下来$t$行，每行两个整数$n,k$", "outputFormat": "$t$行，每行一个整数表示答案", "hint": "第四组数据实际值为$\\frac{7}{3}$\n\n第五组数据实际值为$\\frac{55}{9}$\n\n第一组数据解释：\n\n如果所有士兵都被派遣，那么能力值为$1$\n\n如果$(1,1)$位置的士兵(编号为$3$)未被派遣，那么能力值为$\\frac{1}{3-1}=0.5$\n\n如果$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{0}{1-0} = 0$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$\n\n如果$(1,0)$位置的士兵(编号为$2$)未被派遣，那么能力值为$\\frac{1}{2-1} = 1$\n\n如果$(1,0)$位置的士兵(编号为$2$)和$(1,1)$位置的士兵(编号为$3$)未被派遣，那么能力值为$\\frac{1}{2-1} \\times \\frac{1}{3-1}=0.5$\n\n如果$(1,0)$位置的士兵(编号为$2$)和$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{1}{2-1} \\times \\frac{0}{1-0}=0$\n\n如果只有队长被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} \\times \\frac{1}{2-1}=0$\n\n所以，答案为$1+0.5+0+0+1+0.5+0+0=3$\n\n数据范围：\n\n对于所有数据，$n\\ge 1,k\\ge 2$\n\nSubtask1是比赛时的测试数据：\n\n测试点| 分值| t | $n\\le$| $k\\le$\n:-: | :-: | :-: | :-: | :-:\n1| 10| 5| 5| 5| \n2| 11| 100| 100| 100|\n3| 12| 100000| 5| 100000|\n4| 13| 100000| 100000| 5|\n5| 16| 5| 100000| 100000|\n6| 18| 5| $10^9$| $10^9$|\n7| 20| 100000| $10^9$|$10^9$|\n\nSubtask2包括两个不计分的Hack数据，均满足$t=1$\n\n#8满足#7的性质\n\n#9满足#5的性质", "locale": "zh-CN", "translations": {"en": {"title": "Dispatch", "background": "Steve found a map in a cave. The map marked the strongholds of the dark forces, so he decided to dispatch some soldiers there.", "description": "However, these soldiers may not necessarily have the ability to fight the dark forces, so the final set of dispatched soldiers is unknown.\n\nTo better understand the dispatched soldiers, Steve needs you to help compute some values.\n\nSteve has a total of $t$ armies, and each army has a different number of soldiers.\n\nEach army can be arranged into an $n \\times k$ grid under a certain standard. Each soldier’s position can be represented by coordinates $(x,y)$, where $0 \\le x < n$ and $0 \\le y < k$. The soldier’s index is $x \\cdot k + y$.\n\nThe soldier at position $(0,0)$ is the captain, and will be dispatched no matter what.\n\nFor the remaining soldiers, they may or may not be dispatched.\n\nThe ability value of an $n \\times k$ army is defined as follows:\n\n- If all soldiers are dispatched, then the ability value is $1$.\n- If the soldier at position $(x,y)$ (with index $i$) is not dispatched, then the ability value becomes the previous value multiplied by $\\frac{x}{i-x}$.\n\nFor example, for a $2 \\times 2$ army, if the soldier at $(1,1)$ (index $3$) is not dispatched and all other soldiers are dispatched, then the ability value is $\\frac{1}{3-1}=\\frac{1}{2}$.\n\nIf both the soldier at $(1,1)$ (index $3$) and the soldier at $(0,1)$ (index $1$) are not dispatched, then the ability value is $\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$.\n\nIf both the soldier at $(1,1)$ (index $3$) and the soldier at $(1,0)$ (index $2$) are not dispatched, then the ability value is $\\frac{1}{3-1} \\times \\frac{1}{2-1} = \\frac{1}{2}$.\n\nNow, for each army, Steve needs you to compute the sum of the ability values over all possible dispatch plans.\n\nTo avoid fractions, output the result modulo $1145141$.\n\nIf this value does not exist, output $-1$.\n\nThat is, if your answer is an irreducible fraction $\\frac{p}{q}$, you need to find the smallest non-negative integer $a$ such that $p \\equiv q \\cdot a \\pmod{1145141}$, and output $a$. If no such integer exists, output $-1$.\n\nHint: $1145141$ is a prime number.", "inputFormat": "The first line contains an integer $t$.\n\nThe next $t$ lines each contain two integers $n, k$.", "outputFormat": "Output $t$ lines, each containing one integer representing the answer.", "hint": "The actual value for the 4th group of testdata is $\\frac{7}{3}$.\n\nThe actual value for the 5th group of testdata is $\\frac{55}{9}$.\n\nExplanation for the 1st group of testdata:\n\nIf all soldiers are dispatched, then the ability value is $1$.\n\nIf the soldier at $(1,1)$ (index $3$) is not dispatched, then the ability value is $\\frac{1}{3-1}=0.5$.\n\nIf the soldier at $(0,1)$ (index $1$) is not dispatched, then the ability value is $\\frac{0}{1-0} = 0$.\n\nIf both the soldier at $(1,1)$ (index $3$) and the soldier at $(0,1)$ (index $1$) are not dispatched, then the ability value is $\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$.\n\nIf the soldier at $(1,0)$ (index $2$) is not dispatched, then the ability value is $\\frac{1}{2-1} = 1$.\n\nIf both the soldier at $(1,0)$ (index $2$) and the soldier at $(1,1)$ (index $3$) are not dispatched, then the ability value is $\\frac{1}{2-1} \\times \\frac{1}{3-1}=0.5$.\n\nIf both the soldier at $(1,0)$ (index $2$) and the soldier at $(0,1)$ (index $1$) are not dispatched, then the ability value is $\\frac{1}{2-1} \\times \\frac{0}{1-0}=0$.\n\nIf only the captain is dispatched, then the ability value is $\\frac{1}{3-1} \\times \\frac{0}{1-0} \\times \\frac{1}{2-1}=0$.\n\nSo, the answer is $1+0.5+0+0+1+0.5+0+0=3$.\n\nConstraints:\n\nFor all testdata, $n \\ge 1, k \\ge 2$.\n\nSubtask 1 is the testdata used during the contest:\n\nTest point | Score | $t$ | $n \\le$ | $k \\le$\n:-: | :-: | :-: | :-: | :-:\n1 | 10 | 5 | 5 | 5\n2 | 11 | 100 | 100 | 100\n3 | 12 | 100000 | 5 | 100000\n4 | 13 | 100000 | 100000 | 5\n5 | 16 | 5 | 100000 | 100000\n6 | 18 | 5 | $10^9$ | $10^9$\n7 | 20 | 100000 | $10^9$ | $10^9$\n\nSubtask 2 includes two unscored hack testdata, both satisfying $t=1$.\n\n#8 satisfies the properties of #7.\n\n#9 satisfies the properties of #5.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "派遣", "background": "Steve在洞穴里发现了一张地图，上面标识出了黑暗势力的据点，他决定派遣一些士兵前去", "description": "然而，这些士兵不一定具有与黑暗势力作战的能力，因而最终被派遣的士兵是未知的\n\n为了尽量了解派遣的士兵的情况，Steve需要你帮忙计算一些值\n\nSteve一共有$t$支军队，每支军队的人数都不同\n\n每支军队可以按一定标准排成$n \\times k$的方阵，每个士兵的位置可以用坐标$(x,y)$表示，其中$0\\le x < n,0 \\le y <k$，这个士兵的编号就是$x\\cdot k+y$\n\n位于$(0,0)$位置的士兵是队长，无论任何情况都会被派遣\n\n对于其余的士兵，可以派遣，也可以不派遣\n\n一支$n \\times k$的军队的能力值是这样定义的：\n\n如果所有士兵都被派遣，那么能力值是$1$\n\n如果位于$(x,y)$位置的士兵(编号为$i$)未被派遣，那么能力值变为原来的$\\frac{x}{i-x}$\n\n例如，对于一支$2\\times 2$的军队，如果$(1,1)$位置的士兵(编号为$3$)未被派遣，其他士兵都被派遣，那么能力值为$\\frac{1}{3-1}=\\frac{1}{2}$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(0,1)$位置的士兵(编号为$1$)都未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(1,0)$位置的士兵(编号为$2$)都未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{1}{2-1} = \\frac{1}{2}$\n\n现在，Steve需要你为每一支军队，计算出所有可能派遣方案的能力值之和\n\n为了避免出现分数，输出结果是模$1145141$意义下的值\n\n如果这个值不存在，那么输出$-1$\n\n也就是，如果你的答案为既约分数$\\frac{p}{q}$，你需要找到一个最小的非负整数$a$，满足$p\\equiv q\\cdot a(mod 1145141)$，并输出这个值，如果不存在这样的整数，就输出$-1$\n\n提示：$1145141$是质数", "inputFormat": "第一行一个整数$t$\n\n接下来$t$行，每行两个整数$n,k$", "outputFormat": "$t$行，每行一个整数表示答案", "hint": "第四组数据实际值为$\\frac{7}{3}$\n\n第五组数据实际值为$\\frac{55}{9}$\n\n第一组数据解释：\n\n如果所有士兵都被派遣，那么能力值为$1$\n\n如果$(1,1)$位置的士兵(编号为$3$)未被派遣，那么能力值为$\\frac{1}{3-1}=0.5$\n\n如果$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{0}{1-0} = 0$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$\n\n如果$(1,0)$位置的士兵(编号为$2$)未被派遣，那么能力值为$\\frac{1}{2-1} = 1$\n\n如果$(1,0)$位置的士兵(编号为$2$)和$(1,1)$位置的士兵(编号为$3$)未被派遣，那么能力值为$\\frac{1}{2-1} \\times \\frac{1}{3-1}=0.5$\n\n如果$(1,0)$位置的士兵(编号为$2$)和$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{1}{2-1} \\times \\frac{0}{1-0}=0$\n\n如果只有队长被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} \\times \\frac{1}{2-1}=0$\n\n所以，答案为$1+0.5+0+0+1+0.5+0+0=3$\n\n数据范围：\n\n对于所有数据，$n\\ge 1,k\\ge 2$\n\nSubtask1是比赛时的测试数据：\n\n测试点| 分值| t | $n\\le$| $k\\le$\n:-: | :-: | :-: | :-: | :-:\n1| 10| 5| 5| 5| \n2| 11| 100| 100| 100|\n3| 12| 100000| 5| 100000|\n4| 13| 100000| 100000| 5|\n5| 16| 5| 100000| 100000|\n6| 18| 5| $10^9$| $10^9$|\n7| 20| 100000| $10^9$|$10^9$|\n\nSubtask2包括两个不计分的Hack数据，均满足$t=1$\n\n#8满足#7的性质\n\n#9满足#5的性质", "locale": "zh-CN"}}}
{"pid": "P5510", "type": "P", "difficulty": 6, "samples": [["2 0\n1 1\n3 3\n2 2\n4 4\n9\n1 1 1 1\n1 1 1 2\n1 1 2 2\n2 1 1 1\n1 2 1 2\n1 2 2 2\n2 2 1 1\n2 2 1 2\n2 2 2 2\n", "18\n2\n6\n4\n2\n18\n16\n0\n12\n12\n"], ["2 0\n1 1\n2 2\n2 2\n3 3\n9\n1 1 1 1\n1 1 1 2\n1 1 2 2\n1 2 1 1\n1 2 1 2\n1 2 2 2\n2 2 1 1\n2 2 1 2\n2 2 2 2\n", "11\n2\n5\n3\n2\n11\n9\n0\n6\n6\n"], ["5 0\n1 1\n1 1\n1 1\n2 1\n2 1\n1 1\n1 1\n2 1\n2 1\n3 1\n7\n2 4 1 1\n1 3 3 4\n3 4 5 5\n2 5 4 4\n1 5 5 5\n1 3 1 2\n1 2 3 4\n", "11\n0\n6\n5\n6\n5\n0\n6\n"], ["3 0\n3 1\n2 2\n1 3\n4 4\n5 5\n6 6\n12\n1 3 2 2\n1 2 2 3\n3 1 1 2\n2 1 3 1\n1 1 2 3\n3 1 3 1\n3 2 2 3\n1 2 3 3\n1 2 1 3\n3 2 1 1\n2 2 1 3\n3 3 1 2\n", "90\n30\n33\n54\n45\n11\n90\n55\n18\n45\n20\n30\n27\n"], ["3 2 233 5 10\n", "15618218285282996994"], ["3 0\n3 754517792\n1 842082509\n4 600944080\n2 592435186\n5 348652025\n5 247250863\n10\n1 3 3 2\n3 2 1 1\n2 2 3 2\n2 1 2 1\n3 3 3 1\n2 3 3 2\n1 3 3 3\n1 3 3 3\n2 2 1 3\n2 1 2 1\n", "988687952\n712318441\n204869162\n71500349\n703342331\n285345621\n783818790\n712318441\n712318441\n276369511\n703342331\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "排序", "前缀和"], "title": "水晶", "background": "2019/12/27 修改最后一个点的数据范围\n\nSteve带领军队到达了黑暗势力的据点\n\n然而，他发现黑暗势力正在使用水晶保护自己\n\n为了突破防御，Steve开始用武器攻击水晶", "description": "黑暗势力的水晶已经排成了一排，而且数量很多\n\n水晶可分为$n$组，第$i$组内有$a_i$个水晶，并且防御力均为$na_i$\n\nSteve的武器也已经排成了一排，而且数量也很多\n\n武器也可分为$n$组，第$i$组内有$b_i$个武器，并且攻击力均为$nb_i$\n\n每一轮攻击中，黑暗势力会选择一个水晶，Steve会选择一个武器\n\n如果这个武器的攻击力大于水晶的防御力，这次攻击就有效\n\n然而，水晶和武器数量太多了，Steve很难知道具体选择了哪个水晶，哪个武器\n\n现在Steve希望知道：\n\n1.对于所有可能的情况，有多少种选法是一次有效的攻击\n\n2.如果已经知道选用水晶的防御力在第$x$组水晶的防御力和第$y$组水晶的防御力之间，且选用武器的攻击力在第$z$组武器的攻击力和第$u$组武器的攻击力之间，那么，有多少种选法是一次有效的攻击\n\n也就是，选择的水晶防御力不小于第$x$组水晶和第$y$组水晶防御力的较小值，不大于两者的较大值，武器同理\n\n两个选法不同，当且仅当选用的水晶或武器不同（可以在同一组）\n\n由于战事紧迫，你需要迅速回答问题才能让Steve作出下一轮攻击的决策\n\n因此，部分测试点强制在线\n\n为了避免答案过大，答案对$998244353$取模", "inputFormat": "由于输入输出规模较大，使用下面的模板完成数据生成，具体格式请看模板和样例\n\n评测时，所有测试点都只会输入5个数，输出1个数，因此你不需要输入输出优化\n\n为便于调试，该模板可以手动指定数据，并输出每一个询问的答案，只需要输入的$k=0$\n\n对于所有测试点，保证调用交互库消耗的时间不超过300ms\n```\n#include<cstdio>\nusing namespace std;\n#define u32 unsigned int\n#define u64 unsigned long long\nint cl;\nconst int N=2500007;\nconst long long M=998244353LL;\nint n,q,k;\nint a[N],na[N],b[N],nb[N];\nint x,y,z,u;\nnamespace lib{\n    u64 read(){\n        u64 n=0;\n        char c=getchar();\n        while(c<'0'||c>'9')c=getchar();\n        while(c>='0'&&c<='9'){\n            n=n*10+c-'0';\n            c=getchar();\n        }\n        return n;\n    }\n    char r[30];\n    void write(u64 num){\n        if(num==0){\n            putchar('0');\n            return;\n        }\n        int t=0;\n        while(num){\n            r[t++]=num%10+'0';\n            num/=10;\n        }\n        while(t)putchar(r[--t]);\n    }\n    u64 s;\n    u64 rand(u64 l,u64 r){\n        s=s*19260817+1;\n        return ((s>>8)%(r-l+1)+l);\n    }\n    int ra,t;\n    void init(){\n        n=read();k=read();\n        if(k<2){\n            for(int i=1;i<=n;i++){\n                a[i]=read();na[i]=read();\n            }\n            for(int i=1;i<=n;i++){\n                b[i]=read();nb[i]=read();\n            }\n        }else{\n            s=read();ra=read();\n            u64 bacs=s;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\ta[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//na[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\t//a[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tna[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            bacs=s;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\tb[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//nb[i]=((s>>8)%(M-1)+1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\t//b[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tnb[i]=((s>>8)%(M-1)+1);\n            }\n        }\n        q=read();\n    }\n    u64 lastans;\n    u64 res;\n    void reply(u64 num){\n        if(k<2){\n            write(num);putchar('\\n');\n        }else{\n            res=res*233+num;\n        }\n        lastans^=num;\n    }\n    void query(){\n        if(k<2){\n            x=read();y=read();z=read();u=read();\n        }else{\n        \ts=s*19260817+1;\n        \tx=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \ty=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tz=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tu=((s>>8)%n+1);\n            //x=rand(1,n);y=rand(1,n);z=rand(1,n);u=rand(1,n);\n        }\n        if(k&1){\n        \tint t=lastans%n+1;\n        \tif((x+=t)>n)x-=n;\n        \tif((y+=t)>n)y-=n;\n        \tif((z+=t)>n)z-=n;\n        \tif((u+=t)>n)u-=n;\n            /*x=(x+lastans)%n+1;\n            y=(y+lastans)%n+1;\n            z=(z+lastans)%n+1;\n            u=(u+lastans)%n+1;*/\n        }\n    }\n    void stop(){\n        if(k>=2){write(res);putchar('\\n');}\n    }\n}\nint main(){\n\tlib::init();\n\t//现在你可以使用生成的a,na,b,nb\n\t\n    //回答第一问\n    \n\tlib::reply(233);\n\t\n\tfor(int i=1;i<=q;i++){\n\t\tlib::query();\n\t\t\n\t\t//回答第二问 \n        \n\t\tlib::reply(233);\n\t}\n\tlib::stop();\n}\n```", "outputFormat": "如果$k=0$，则会分别输出每一问的答案\n\n否则，只会输出一个整数用于检查结果是否正确", "hint": "样例1解释：\n\n当选择第二组武器时，一定能进行一次有效攻击\n\n当选择第一组武器时，只有选择第一组水晶才能进行一次有效攻击\n\n因而，不难求出每一问的答案\n\n建议根据样例进一步理解题意\n\n样例5与样例6一致\n\n数据范围：\n\n对于所有数据，满足$1\\le x,y,z,u \\le n$，$1\\le a_i,b_i\\le 10^9$，$1\\le na_i,nb_i\\le 998244352$\n\n如未特别说明，$k=3$，即：由模板生成数据，强制在线\n\n如果$k=2$，那么这组数据仍由生成器生成，但不强制在线，也就是你可以在不回答询问的情况下得到下一个询问的真实值，随后按顺序回答即可\n\n测试点| 分值| n | q| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1| 4| 100| 100| $k=2$| \n2| 14| 3000| 3000| $k=2$|\n3| 11| 100000| 100000| $a_i,b_i\\le 100$|\n4| 10| 15| 4000000| |\n5| 12| 100| 4000000| |\n6| 14| 5000| 4000000| |\n7| 16| 100000| 100000| |\n8| 19| 2500000| 4000000| |", "locale": "zh-CN", "translations": {"en": {"title": "Crystal", "background": "2019/12/27: Modified the Constraints of the last test point.\n\nSteve led his army to the stronghold of the dark forces.\n\nHowever, he found that the dark forces were using crystals to protect themselves.\n\nTo break through the defense, Steve began attacking the crystals with weapons.", "description": "The dark forces’ crystals have been lined up in a row, and there are many of them.\n\nThe crystals can be divided into $n$ groups. The $i$-th group contains $a_i$ crystals, and their defense value is $na_i$.\n\nSteve’s weapons have also been lined up in a row, and there are many of them.\n\nThe weapons can also be divided into $n$ groups. The $i$-th group contains $b_i$ weapons, and their attack value is $nb_i$.\n\nIn each round of attack, the dark forces will choose one crystal, and Steve will choose one weapon.\n\nIf the weapon’s attack value is greater than the crystal’s defense value, then this attack is effective.\n\nHowever, there are too many crystals and weapons, so it is hard for Steve to know exactly which crystal and which weapon were chosen.\n\nNow Steve wants to know:\n\n1. For all possible situations, how many ways of choosing result in an effective attack.\n\n2. If it is already known that the chosen crystal’s defense value is between the defense values of the crystals in group $x$ and group $y$, and the chosen weapon’s attack value is between the attack values of the weapons in group $z$ and group $u$, then how many ways of choosing result in an effective attack.\n\nThat is, the chosen crystal’s defense value is not less than the smaller of the defense values of group $x$ and group $y$, and not greater than the larger of them; similarly for the weapon.\n\nTwo choices are different if and only if the chosen crystal or the chosen weapon is different (they may be in the same group).\n\nSince the battle is urgent, you need to answer the questions quickly so that Steve can decide the next round of attacks.\n\nTherefore, some test points require online answering.\n\nTo avoid the answer being too large, take the answer modulo $998244353$.", "inputFormat": "Because the input/output size is large, use the following template to generate the data. For the exact format, see the template and samples.\n\nDuring judging, all test points will only input 5 numbers and output 1 number, so you do not need to optimize input/output.\n\nFor easier debugging, this template can manually specify the data and output the answer to each query; in that case you only need to input $k=0$.\n\nFor all test points, it is guaranteed that the time consumed by calling the interaction library does not exceed 300 ms.\n```\n#include<cstdio>\nusing namespace std;\n#define u32 unsigned int\n#define u64 unsigned long long\nint cl;\nconst int N=2500007;\nconst long long M=998244353LL;\nint n,q,k;\nint a[N],na[N],b[N],nb[N];\nint x,y,z,u;\nnamespace lib{\n    u64 read(){\n        u64 n=0;\n        char c=getchar();\n        while(c<'0'||c>'9')c=getchar();\n        while(c>='0'&&c<='9'){\n            n=n*10+c-'0';\n            c=getchar();\n        }\n        return n;\n    }\n    char r[30];\n    void write(u64 num){\n        if(num==0){\n            putchar('0');\n            return;\n        }\n        int t=0;\n        while(num){\n            r[t++]=num%10+'0';\n            num/=10;\n        }\n        while(t)putchar(r[--t]);\n    }\n    u64 s;\n    u64 rand(u64 l,u64 r){\n        s=s*19260817+1;\n        return ((s>>8)%(r-l+1)+l);\n    }\n    int ra,t;\n    void init(){\n        n=read();k=read();\n        if(k<2){\n            for(int i=1;i<=n;i++){\n                a[i]=read();na[i]=read();\n            }\n            for(int i=1;i<=n;i++){\n                b[i]=read();nb[i]=read();\n            }\n        }else{\n            s=read();ra=read();\n            u64 bacs=s;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\ta[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//na[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\t//a[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tna[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            bacs=s;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\tb[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//nb[i]=((s>>8)%(M-1)+1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\t//b[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tnb[i]=((s>>8)%(M-1)+1);\n            }\n        }\n        q=read();\n    }\n    u64 lastans;\n    u64 res;\n    void reply(u64 num){\n        if(k<2){\n            write(num);putchar('\\n');\n        }else{\n            res=res*233+num;\n        }\n        lastans^=num;\n    }\n    void query(){\n        if(k<2){\n            x=read();y=read();z=read();u=read();\n        }else{\n        \ts=s*19260817+1;\n        \tx=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \ty=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tz=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tu=((s>>8)%n+1);\n            //x=rand(1,n);y=rand(1,n);z=rand(1,n);u=rand(1,n);\n        }\n        if(k&1){\n        \tint t=lastans%n+1;\n        \tif((x+=t)>n)x-=n;\n        \tif((y+=t)>n)y-=n;\n        \tif((z+=t)>n)z-=n;\n        \tif((u+=t)>n)u-=n;\n            /*x=(x+lastans)%n+1;\n            y=(y+lastans)%n+1;\n            z=(z+lastans)%n+1;\n            u=(u+lastans)%n+1;*/\n        }\n    }\n    void stop(){\n        if(k>=2){write(res);putchar('\\n');}\n    }\n}\nint main(){\n\tlib::init();\n\t//现在你可以使用生成的a,na,b,nb\n\t\n    //回答第一问\n    \n\tlib::reply(233);\n\t\n\tfor(int i=1;i<=q;i++){\n\t\tlib::query();\n\t\t\n\t\t//回答第二问 \n        \n\t\tlib::reply(233);\n\t}\n\tlib::stop();\n}\n```", "outputFormat": "If $k=0$, the answer to each question will be output separately.\n\nOtherwise, only one integer will be output to check whether the result is correct.", "hint": "Explanation for Sample 1:\n\nWhen choosing the weapons in the second group, you can always make an effective attack.\n\nWhen choosing the weapons in the first group, only choosing the crystals in the first group can make an effective attack.\n\nTherefore, it is not hard to find the answer to each question.\n\nIt is recommended to further understand the statement based on the samples.\n\nSample 5 is the same as Sample 6.\n\nConstraints:\n\nFor all data, $1 \\le x,y,z,u \\le n$, $1 \\le a_i,b_i \\le 10^9$, and $1 \\le na_i,nb_i \\le 998244352$.\n\nUnless otherwise specified, $k=3$, i.e., the data is generated by the template and online answering is required.\n\nIf $k=2$, the data is still generated by the generator, but online answering is not required. That is, you can get the real value of the next query without answering the current query, and then answer them in order afterward.\n\nTest Point | Score | $n$ | $q$ | Special Property\n:-: | :-: | :-: | :-: | :-:\n1 | 4 | 100 | 100 | $k=2$\n2 | 14 | 3000 | 3000 | $k=2$\n3 | 11 | 100000 | 100000 | $a_i,b_i \\le 100$\n4 | 10 | 15 | 4000000 |\n5 | 12 | 100 | 4000000 |\n6 | 14 | 5000 | 4000000 |\n7 | 16 | 100000 | 100000 |\n8 | 19 | 2500000 | 4000000 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "水晶", "background": "2019/12/27 修改最后一个点的数据范围\n\nSteve带领军队到达了黑暗势力的据点\n\n然而，他发现黑暗势力正在使用水晶保护自己\n\n为了突破防御，Steve开始用武器攻击水晶", "description": "黑暗势力的水晶已经排成了一排，而且数量很多\n\n水晶可分为$n$组，第$i$组内有$a_i$个水晶，并且防御力均为$na_i$\n\nSteve的武器也已经排成了一排，而且数量也很多\n\n武器也可分为$n$组，第$i$组内有$b_i$个武器，并且攻击力均为$nb_i$\n\n每一轮攻击中，黑暗势力会选择一个水晶，Steve会选择一个武器\n\n如果这个武器的攻击力大于水晶的防御力，这次攻击就有效\n\n然而，水晶和武器数量太多了，Steve很难知道具体选择了哪个水晶，哪个武器\n\n现在Steve希望知道：\n\n1.对于所有可能的情况，有多少种选法是一次有效的攻击\n\n2.如果已经知道选用水晶的防御力在第$x$组水晶的防御力和第$y$组水晶的防御力之间，且选用武器的攻击力在第$z$组武器的攻击力和第$u$组武器的攻击力之间，那么，有多少种选法是一次有效的攻击\n\n也就是，选择的水晶防御力不小于第$x$组水晶和第$y$组水晶防御力的较小值，不大于两者的较大值，武器同理\n\n两个选法不同，当且仅当选用的水晶或武器不同（可以在同一组）\n\n由于战事紧迫，你需要迅速回答问题才能让Steve作出下一轮攻击的决策\n\n因此，部分测试点强制在线\n\n为了避免答案过大，答案对$998244353$取模", "inputFormat": "由于输入输出规模较大，使用下面的模板完成数据生成，具体格式请看模板和样例\n\n评测时，所有测试点都只会输入5个数，输出1个数，因此你不需要输入输出优化\n\n为便于调试，该模板可以手动指定数据，并输出每一个询问的答案，只需要输入的$k=0$\n\n对于所有测试点，保证调用交互库消耗的时间不超过300ms\n```\n#include<cstdio>\nusing namespace std;\n#define u32 unsigned int\n#define u64 unsigned long long\nint cl;\nconst int N=2500007;\nconst long long M=998244353LL;\nint n,q,k;\nint a[N],na[N],b[N],nb[N];\nint x,y,z,u;\nnamespace lib{\n    u64 read(){\n        u64 n=0;\n        char c=getchar();\n        while(c<'0'||c>'9')c=getchar();\n        while(c>='0'&&c<='9'){\n            n=n*10+c-'0';\n            c=getchar();\n        }\n        return n;\n    }\n    char r[30];\n    void write(u64 num){\n        if(num==0){\n            putchar('0');\n            return;\n        }\n        int t=0;\n        while(num){\n            r[t++]=num%10+'0';\n            num/=10;\n        }\n        while(t)putchar(r[--t]);\n    }\n    u64 s;\n    u64 rand(u64 l,u64 r){\n        s=s*19260817+1;\n        return ((s>>8)%(r-l+1)+l);\n    }\n    int ra,t;\n    void init(){\n        n=read();k=read();\n        if(k<2){\n            for(int i=1;i<=n;i++){\n                a[i]=read();na[i]=read();\n            }\n            for(int i=1;i<=n;i++){\n                b[i]=read();nb[i]=read();\n            }\n        }else{\n            s=read();ra=read();\n            u64 bacs=s;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\ta[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//na[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\t//a[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tna[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            bacs=s;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\tb[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//nb[i]=((s>>8)%(M-1)+1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\t//b[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tnb[i]=((s>>8)%(M-1)+1);\n            }\n        }\n        q=read();\n    }\n    u64 lastans;\n    u64 res;\n    void reply(u64 num){\n        if(k<2){\n            write(num);putchar('\\n');\n        }else{\n            res=res*233+num;\n        }\n        lastans^=num;\n    }\n    void query(){\n        if(k<2){\n            x=read();y=read();z=read();u=read();\n        }else{\n        \ts=s*19260817+1;\n        \tx=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \ty=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tz=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tu=((s>>8)%n+1);\n            //x=rand(1,n);y=rand(1,n);z=rand(1,n);u=rand(1,n);\n        }\n        if(k&1){\n        \tint t=lastans%n+1;\n        \tif((x+=t)>n)x-=n;\n        \tif((y+=t)>n)y-=n;\n        \tif((z+=t)>n)z-=n;\n        \tif((u+=t)>n)u-=n;\n            /*x=(x+lastans)%n+1;\n            y=(y+lastans)%n+1;\n            z=(z+lastans)%n+1;\n            u=(u+lastans)%n+1;*/\n        }\n    }\n    void stop(){\n        if(k>=2){write(res);putchar('\\n');}\n    }\n}\nint main(){\n\tlib::init();\n\t//现在你可以使用生成的a,na,b,nb\n\t\n    //回答第一问\n    \n\tlib::reply(233);\n\t\n\tfor(int i=1;i<=q;i++){\n\t\tlib::query();\n\t\t\n\t\t//回答第二问 \n        \n\t\tlib::reply(233);\n\t}\n\tlib::stop();\n}\n```", "outputFormat": "如果$k=0$，则会分别输出每一问的答案\n\n否则，只会输出一个整数用于检查结果是否正确", "hint": "样例1解释：\n\n当选择第二组武器时，一定能进行一次有效攻击\n\n当选择第一组武器时，只有选择第一组水晶才能进行一次有效攻击\n\n因而，不难求出每一问的答案\n\n建议根据样例进一步理解题意\n\n样例5与样例6一致\n\n数据范围：\n\n对于所有数据，满足$1\\le x,y,z,u \\le n$，$1\\le a_i,b_i\\le 10^9$，$1\\le na_i,nb_i\\le 998244352$\n\n如未特别说明，$k=3$，即：由模板生成数据，强制在线\n\n如果$k=2$，那么这组数据仍由生成器生成，但不强制在线，也就是你可以在不回答询问的情况下得到下一个询问的真实值，随后按顺序回答即可\n\n测试点| 分值| n | q| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1| 4| 100| 100| $k=2$| \n2| 14| 3000| 3000| $k=2$|\n3| 11| 100000| 100000| $a_i,b_i\\le 100$|\n4| 10| 15| 4000000| |\n5| 12| 100| 4000000| |\n6| 14| 5000| 4000000| |\n7| 16| 100000| 100000| |\n8| 19| 2500000| 4000000| |", "locale": "zh-CN"}}}
{"pid": "P5511", "type": "P", "difficulty": 7, "samples": [["10 8 0\n1 1 5 1\n3 1 3 5\n1 1 5 3\n2 2 3 3\n1 1 5 3\n1 1 5 5\n3 3 4 2\n1 1 5 3\n", "5\n2\n2\n4\n2\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "树套树", "分块"], "title": "决战", "background": "Steve 成功突破了水晶防御，即将和黑暗势力进行决战。", "description": "然而黑暗势力具有改变地形的能力，给军队的前进造成了很大困难\n\n为了使军队更快前进，Steve 将核武器带到了前线，用来破坏地形\n\n另外，Steve 很关心当前的地形情况\n\n具体地说，前线的地形可分为 $n$ 段，初始高度为 $0$，决战时会发生 $m$ 个事件，事件可以是：\n\n1. Steve 询问区间 $[l,r]$ 内，有几段小于给定的高度 $h$。\n2. Steve 使用核武器，使得区间 $[l,r]$ 内高度大于 $h$ 的段的高度减少到 $h$。\n3. 黑暗势力改变地形，使得区间 $[l,r]$ 内高度小于 $h$ 的段的高度增加到 $h$。\n\n由于战事非常紧迫，所以部分测试点强制在线。\n\n对于 $k=1$ 的测试点，设上次事件 1 的答案为 $lastans$，你需要将 $l,r,h$ 分别与 $lastans$ 取异或后得到实际数值，如果还没有回答过事件 1，那么 $lastans=0$。", "inputFormat": "第一行 $3$ 个整数 $n,m,k$。\n\n接下来 $m$ 行，每行 $4$ 个整数，描述一个事件。\n\n第一个整数 $opt$ 表示事件种类，接下来 $3$ 个整数 $l,r,h$，含义如题所述。\n\n**数据中存在 $l>r$ 的情况，此时请直接忽略这次操作。**", "outputFormat": "对于每个事件 1，输出一行一个整数，表示询问的答案。", "hint": "样例解释：\n\n```\n[00000]00000=>5[TTTTT]\n[000]0000000\n[55500]00000=>2[FFFTT]\n5[55]0000000\n[53300]00000=>2[FFFTT]\n[53300]00000=>4[FTTTT]\n53[30]000000\n[53320]00000=>2[FFFTT]\n```\n\n数据范围：\n\n对于所有数据，保证 $1\\le l \\le r \\le n,0\\le h \\le 10^9$。\n\nSubtask1 是比赛时的数据。\n\n测试点| 分值| n | m| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1| 4| 1000| 1000| | \n2| 14| 100000| 100000| $h\\le 1$|\n3| 11| 100000| 100000| |\n4| 10| $10^9$| 1000| |\n5| 12| $10^9$| 100000| $k=1,h\\le 1$|\n6| 14| $10^9$| 100000| *|\n7| 16| $10^9$| 100000| |\n8| 19| $10^9$| 100000| $k=1$|\n\n对于第 $6$ 个测试点，保证所有事件 $1$ 都在事件 $2$ 和 $3$ 之后。\n\nSubtask2 为不计分的 Hack 数据，现在仅包含一组数据，满足 #8 的性质。\n\n$\\color{white}\\texttt{不保证数据随机}$", "locale": "zh-CN", "translations": {"en": {"title": "Final Battle", "background": "Steve has successfully broken through the crystal defense and is about to fight the dark forces in a final battle.", "description": "However, the dark forces can change the terrain, which makes it very difficult for the army to advance.\n\nTo help the army move faster, Steve brought nuclear weapons to the front line to destroy the terrain.\n\nAlso, Steve cares a lot about the current terrain situation.\n\nSpecifically, the front-line terrain can be divided into $n$ segments, with initial height $0$. During the final battle, $m$ events will happen. An event can be:\n\n1. Steve asks: in the interval $[l,r]$, how many segments have height less than the given height $h$.\n2. Steve uses nuclear weapons: in the interval $[l,r]$, for segments whose height is greater than $h$, reduce their height to $h$.\n3. The dark forces change the terrain: in the interval $[l,r]$, for segments whose height is less than $h$, increase their height to $h$.\n\nBecause the battle is very urgent, some test points require online processing.\n\nFor test points with $k=1$, let the answer to the last type 1 event be $lastans$. You need to XOR $l$, $r$, and $h$ with $lastans$ respectively to get the actual values. If no type 1 event has been answered yet, then $lastans=0$.", "inputFormat": "The first line contains $3$ integers $n,m,k$.\n\nThe next $m$ lines each contain $4$ integers describing an event.\n\nThe first integer $opt$ indicates the event type, followed by $3$ integers $l,r,h$, with meanings as described above.\n\n**There are cases where $l>r$ in the testdata. In this case, please ignore this operation directly.**", "outputFormat": "For each type 1 event, output one integer per line, which is the answer to the query.", "hint": "Sample explanation:\n\n```\n[00000]00000=>5[TTTTT]\n[000]0000000\n[55500]00000=>2[FFFTT]\n5[55]0000000\n[53300]00000=>2[FFFTT]\n[53300]00000=>4[FTTTT]\n53[30]000000\n[53320]00000=>2[FFFTT]\n```\n\nConstraints:\n\nFor all data, it is guaranteed that $1\\le l \\le r \\le n,0\\le h \\le 10^9$.\n\nSubtask 1 is the data used during the contest.\n\nTest point | Score | $n$ | $m$ | Special property\n:-: | :-: | :-: | :-: | :-:\n1 | 4 | 1000 | 1000 |\n2 | 14 | 100000 | 100000 | $h\\le 1$\n3 | 11 | 100000 | 100000 |\n4 | 10 | $10^9$ | 1000 |\n5 | 12 | $10^9$ | 100000 | $k=1,h\\le 1$\n6 | 14 | $10^9$ | 100000 | *\n7 | 16 | $10^9$ | 100000 |\n8 | 19 | $10^9$ | 100000 | $k=1$\n\nFor test point 6, it is guaranteed that all type 1 events occur after type 2 and type 3 events.\n\nSubtask 2 is unscored hack data. It currently only contains one dataset, satisfying the property of #8.\n\n$\\color{white}\\texttt{No guarantee that the data is random}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "决战", "background": "Steve 成功突破了水晶防御，即将和黑暗势力进行决战。", "description": "然而黑暗势力具有改变地形的能力，给军队的前进造成了很大困难\n\n为了使军队更快前进，Steve 将核武器带到了前线，用来破坏地形\n\n另外，Steve 很关心当前的地形情况\n\n具体地说，前线的地形可分为 $n$ 段，初始高度为 $0$，决战时会发生 $m$ 个事件，事件可以是：\n\n1. Steve 询问区间 $[l,r]$ 内，有几段小于给定的高度 $h$。\n2. Steve 使用核武器，使得区间 $[l,r]$ 内高度大于 $h$ 的段的高度减少到 $h$。\n3. 黑暗势力改变地形，使得区间 $[l,r]$ 内高度小于 $h$ 的段的高度增加到 $h$。\n\n由于战事非常紧迫，所以部分测试点强制在线。\n\n对于 $k=1$ 的测试点，设上次事件 1 的答案为 $lastans$，你需要将 $l,r,h$ 分别与 $lastans$ 取异或后得到实际数值，如果还没有回答过事件 1，那么 $lastans=0$。", "inputFormat": "第一行 $3$ 个整数 $n,m,k$。\n\n接下来 $m$ 行，每行 $4$ 个整数，描述一个事件。\n\n第一个整数 $opt$ 表示事件种类，接下来 $3$ 个整数 $l,r,h$，含义如题所述。\n\n**数据中存在 $l>r$ 的情况，此时请直接忽略这次操作。**", "outputFormat": "对于每个事件 1，输出一行一个整数，表示询问的答案。", "hint": "样例解释：\n\n```\n[00000]00000=>5[TTTTT]\n[000]0000000\n[55500]00000=>2[FFFTT]\n5[55]0000000\n[53300]00000=>2[FFFTT]\n[53300]00000=>4[FTTTT]\n53[30]000000\n[53320]00000=>2[FFFTT]\n```\n\n数据范围：\n\n对于所有数据，保证 $1\\le l \\le r \\le n,0\\le h \\le 10^9$。\n\nSubtask1 是比赛时的数据。\n\n测试点| 分值| n | m| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1| 4| 1000| 1000| | \n2| 14| 100000| 100000| $h\\le 1$|\n3| 11| 100000| 100000| |\n4| 10| $10^9$| 1000| |\n5| 12| $10^9$| 100000| $k=1,h\\le 1$|\n6| 14| $10^9$| 100000| *|\n7| 16| $10^9$| 100000| |\n8| 19| $10^9$| 100000| $k=1$|\n\n对于第 $6$ 个测试点，保证所有事件 $1$ 都在事件 $2$ 和 $3$ 之后。\n\nSubtask2 为不计分的 Hack 数据，现在仅包含一组数据，满足 #8 的性质。\n\n$\\color{white}\\texttt{不保证数据随机}$", "locale": "zh-CN"}}}
{"pid": "P5512", "type": "P", "difficulty": 5, "samples": [["2", "1 2\n4 3"], ["1", "NO"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "Special Judge"], "title": "[NOIP 1997 提高组] 棋盘问题 加强版", "background": "[P1549](https://www.luogu.org/problem/P1549) 数据加强版。\n\n**数据从 5 扩大到了 10。**\n\n\n\n因为本题数据可能存在诸多争议，故特开一题用来测试加强版数据。", "description": "在 $N \\times N$（$1 \\le N \\le 10$）的棋盘上，填入 $1, 2, \\dots, N ^ 2$ 共 $N ^ 2$ 个数，使得任意两个相邻的数之和为素数。\n\n例如：当 $N = 2$ 时，有：\n\n| $1$ | $2$ |\n| :-----------: | :-----------: |\n| $4$ | $3$ |\n\n其相邻数的和为素数的有：\n\n$1+2,1+4,4+3,2+3$\n\n当 $N=4$ 时，一种可以填写的方案如下：\n\n| $1$ | $2$ | $11$ | $12$ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $16$ | $15$ | $8$ | $5$ |\n| $13$ | $4$ | $9$ | $14$ |\n| $6$ | $7$ | $10$ | $3$ |\n\n在这里我们约定：左上角的格子里必须填数字 $1$。", "inputFormat": "一行一个整数 $N$。", "outputFormat": "如有多种解，则输出第一行、第一列之和为最小的排列方案；若无解，则输出 `NO`。", "hint": "$N\\leq10$\n\n $N=1,2,...,10$ 的数据都各有一个点，由于某些原因， $N$ 不一定与测试点编号相等。\n\n----\n\n**数据新修复于 `2020.1.20`**", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 1997 Senior] Chessboard Problem Enhanced Version", "background": "An enhanced testdata version of [P1549](https://www.luogu.org/problem/P1549).\n\n**The testdata has been expanded from 5 to 10.**\n\nBecause the testdata for this problem may have many disputes, a separate problem is created to test the enhanced version testdata.", "description": "On an $N \\times N$ chessboard ($1 \\le N \\le 10$), fill in $N ^ 2$ numbers $1, 2, \\dots, N ^ 2$, such that the sum of any two adjacent numbers is a prime number.\n\nFor example, when $N = 2$, one solution is:\n\n| $1$ | $2$ |\n| :-----------: | :-----------: |\n| $4$ | $3$ |\n\nThe adjacent pairs whose sums are prime are:\n\n$1+2,1+4,4+3,2+3$\n\nWhen $N = 4$, one possible filling is:\n\n| $1$ | $2$ | $11$ | $12$ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $16$ | $15$ | $8$ | $5$ |\n| $13$ | $4$ | $9$ | $14$ |\n| $6$ | $7$ | $10$ | $3$ |\n\nHere we require that the top-left cell must contain the number $1$.", "inputFormat": "One line with an integer $N$.", "outputFormat": "If there are multiple solutions, output the arrangement with the smallest sum of the first row and the first column. If there is no solution, output `NO`.", "hint": "$N\\leq10$\n\nFor $N=1,2,\\dots,10$, each has one test point. For some reasons, $N$ is not necessarily the same as the test point ID.\n\n----\n\n**The testdata was newly fixed on `2020.1.20`.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 1997 提高组] 棋盘问题 加强版", "background": "[P1549](https://www.luogu.org/problem/P1549) 数据加强版。\n\n**数据从 5 扩大到了 10。**\n\n\n\n因为本题数据可能存在诸多争议，故特开一题用来测试加强版数据。", "description": "在 $N \\times N$（$1 \\le N \\le 10$）的棋盘上，填入 $1, 2, \\dots, N ^ 2$ 共 $N ^ 2$ 个数，使得任意两个相邻的数之和为素数。\n\n例如：当 $N = 2$ 时，有：\n\n| $1$ | $2$ |\n| :-----------: | :-----------: |\n| $4$ | $3$ |\n\n其相邻数的和为素数的有：\n\n$1+2,1+4,4+3,2+3$\n\n当 $N=4$ 时，一种可以填写的方案如下：\n\n| $1$ | $2$ | $11$ | $12$ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $16$ | $15$ | $8$ | $5$ |\n| $13$ | $4$ | $9$ | $14$ |\n| $6$ | $7$ | $10$ | $3$ |\n\n在这里我们约定：左上角的格子里必须填数字 $1$。", "inputFormat": "一行一个整数 $N$。", "outputFormat": "如有多种解，则输出第一行、第一列之和为最小的排列方案；若无解，则输出 `NO`。", "hint": "$N\\leq10$\n\n $N=1,2,...,10$ 的数据都各有一个点，由于某些原因， $N$ 不一定与测试点编号相等。\n\n----\n\n**数据新修复于 `2020.1.20`**", "locale": "zh-CN"}}}
{"pid": "P5513", "type": "P", "difficulty": 6, "samples": [["221LU\n12L2", "3"], ["111RRRRRRR\n222", "0"], ["11111\n222222", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "CEOI（中欧）"], "title": "[CEOI 2013] Board", "background": "", "description": "给出这样一棵“二叉树”:\n - 每个节点有左右两个儿子，并如下定义每个节点的高度：假设父亲节点的高度为 $h$，那么他的两个儿子的节点的高度都是 $h+1$，相同高度的所有节点称作一层。\n\n - 每个节点的左儿子的子树都在右儿子的子树的左边，每一层相邻的两个节点之间有一条边。 下面是一个例子：\n\n![](https://cdn.luogu.com.cn/upload/pic/74384.png)\n\n每一条图上的路径用一个字符串表示，字符串中的每一个字符表示一 个移动。字符仅包含如下五种：\n\n - $\\tt 1$：表示移动到当前节点的左儿子 \n - $\\tt 2$：表示移动到当前节点的右儿子\n - $\\tt U$：表示移动到当前节点的父亲节点 \n - $\\tt L$：表示移动到当前节点同层的左边的节点（保证当前节点在这一层中不是最左边的节点）\n - $\\tt R$：表示移动到当前节点同层的右边的节点（保证当前节点在这一层中不是最右边的节点）\n\n 用一条路径来表示这条路径的终点，例如路径：$\\tt  221LU$ 就表示上图中的节点 $A$。 给出两条路径，你的任务是求出着两条路径的终点之间的最短路。", "inputFormat": "输入两行，每行一个字符串，分别表示两条路径。", "outputFormat": "输出一行，表示两个节点之间的最短路。", "hint": "用 $D$ 表示所有经过的节点中，深度最大的节点的深度；$S$ 表示输入字符串的最大长度。 \n\n- 对于 $10\\%$ 的数据，$D \\leq 10$;\n- 对于 $30\\%$ 的数据，$D \\leq 50$;\n- 对于 $50\\%$ 的数据，$D \\leq 10^3$;\n- 对于 $70\\%$ 的数据，$D\\leq 2 \\times 10^4$; \n- 对于 $100\\%$ 的数据，$D \\leq 10^5, S \\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CEOI 2013] Board", "background": "", "description": "Consider the following “binary tree”:\n\n- Each node has two children, left and right. The height of each node is defined as follows: if the height of a parent node is $h$, then the heights of both of its children are $h+1$. All nodes with the same height form one level.\n\n- The subtree of a node’s left child is to the left of the subtree of its right child. Between every two adjacent nodes on the same level, there is an edge. An example is shown below:\n\n![](https://cdn.luogu.com.cn/upload/pic/74384.png)\n\nEach path in the graph is represented by a string, where each character represents one move. The characters are only the following five types:\n\n- $\\tt 1$: move to the left child of the current node.\n- $\\tt 2$: move to the right child of the current node.\n- $\\tt U$: move to the parent of the current node.\n- $\\tt L$: move to the node on the same level immediately to the left of the current node (it is guaranteed that the current node is not the leftmost node on this level).\n- $\\tt R$: move to the node on the same level immediately to the right of the current node (it is guaranteed that the current node is not the rightmost node on this level).\n\nA path denotes its endpoint. For example, the path $\\tt 221LU$ denotes node $A$ in the figure above. Given two paths, your task is to find the shortest path length between the endpoints of these two paths.", "inputFormat": "Two lines, each containing a string, representing the two paths.", "outputFormat": "Output one line, the length of the shortest path between the two nodes.", "hint": "Let $D$ be the maximum depth among all nodes visited, and let $S$ be the maximum length of the input strings.\n\n- For $10\\%$ of the testdata, $D \\leq 10$.\n- For $30\\%$ of the testdata, $D \\leq 50$.\n- For $50\\%$ of the testdata, $D \\leq 10^3$.\n- For $70\\%$ of the testdata, $D \\leq 2 \\times 10^4$.\n- For $100\\%$ of the testdata, $D \\leq 10^5, S \\leq 10^5$.\n\n# Input Format\n\nTwo lines, each containing a string, representing the two paths.\n\n# Output Format\n\nOutput one line, the length of the shortest path between the two nodes.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CEOI 2013] Board", "background": "", "description": "给出这样一棵“二叉树”:\n - 每个节点有左右两个儿子，并如下定义每个节点的高度：假设父亲节点的高度为 $h$，那么他的两个儿子的节点的高度都是 $h+1$，相同高度的所有节点称作一层。\n\n - 每个节点的左儿子的子树都在右儿子的子树的左边，每一层相邻的两个节点之间有一条边。 下面是一个例子：\n\n![](https://cdn.luogu.com.cn/upload/pic/74384.png)\n\n每一条图上的路径用一个字符串表示，字符串中的每一个字符表示一 个移动。字符仅包含如下五种：\n\n - $\\tt 1$：表示移动到当前节点的左儿子 \n - $\\tt 2$：表示移动到当前节点的右儿子\n - $\\tt U$：表示移动到当前节点的父亲节点 \n - $\\tt L$：表示移动到当前节点同层的左边的节点（保证当前节点在这一层中不是最左边的节点）\n - $\\tt R$：表示移动到当前节点同层的右边的节点（保证当前节点在这一层中不是最右边的节点）\n\n 用一条路径来表示这条路径的终点，例如路径：$\\tt  221LU$ 就表示上图中的节点 $A$。 给出两条路径，你的任务是求出着两条路径的终点之间的最短路。", "inputFormat": "输入两行，每行一个字符串，分别表示两条路径。", "outputFormat": "输出一行，表示两个节点之间的最短路。", "hint": "用 $D$ 表示所有经过的节点中，深度最大的节点的深度；$S$ 表示输入字符串的最大长度。 \n\n- 对于 $10\\%$ 的数据，$D \\leq 10$;\n- 对于 $30\\%$ 的数据，$D \\leq 50$;\n- 对于 $50\\%$ 的数据，$D \\leq 10^3$;\n- 对于 $70\\%$ 的数据，$D\\leq 2 \\times 10^4$; \n- 对于 $100\\%$ 的数据，$D \\leq 10^5, S \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5514", "type": "P", "difficulty": 2, "samples": [["3\n1 2 5", "6"], ["6\n9 18 36 25 9 32\n", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "贪心", "2019", "洛谷原创", "O2优化"], "title": "[MtOI2019] 永夜的报应", "background": "在这世上有一乡一林一竹亭，也有一主一仆一仇敌。\n\n有人曾经想拍下他们的身影，却被可爱的兔子迷惑了心神。\n\n那些迷途中的人啊，终究会消失在不灭的永夜中……  ", "description": "蓬莱山 辉夜(Kaguya)手里有一堆数字。\n\n辉夜手里有 $n$ 个非负整数 $a_1,a_2\\cdots a_n$，由于辉夜去打 Gal Game 去了，她希望智慧的你来帮忙。  \n\n* 你需要将这些数分成若干组，满足 $n$ 个数中的每一个数都恰好被分到了一个组中，且每一组至少包含一个数。  \n\n定义一组数的权值为该组内所有数的**异或和**。请求出一种分组方案，使得分出的所有组数的权值之和最小，输出权值之和的最小值。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示给定的非负整数的数量。\n\n接下来一行包含 $n$ 个非负整数 $a_1,a_2\\cdots a_n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "**样例 $1$ 解释：**\n\n一种最优的分组方案如下：\n\n- 将第 $1$ 个数和第 $3$ 个数分为一组，该组的权值为 $1\\oplus 5 = 4$；\n- 将第 $2$ 个数分为一组，该组的权值为 $2$。\n\n该分组方案的所有组的权值之和为 $4 + 2 = 6$，可以证明，不存在权值之和更小的分组方案。\n\n**样例 $2$ 解释：**\n\n一种最优的分组方案如下：\n\n- 将第 $1$ 个数和第 $5$ 个数分为一组，该组的权值为 $9\\oplus 9 = 0$；\n- 将第 $2$ 个数和第 $4$ 个数分为一组，该组的权值为 $18\\oplus 25 = 11$；\n- 将第 $3$ 个数和第 $6$ 个数分为一组，该组的权值为 $36\\oplus 32 = 4$。\n\n该分组方案的所有组的权值之和为 $0 + 11 + 4 = 15$。可以证明，不存在权值之和更小的分组方案。\n\n### 子任务\n\n- 对于 $80\\%$ 的数据，满足 $n\\leq 15$。\n- 对于 $100\\%$ 的数据，满足 $n\\leq 10^6,a_i \\leq 10^9$。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T1\n\n出题人：disangan233\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Retribution of the Eternal Night", "background": "In this world, there is a village, a forest, and a bamboo pavilion; there is also a master, a servant, and an enemy.\n\nSomeone once wanted to capture their silhouettes, but their mind was confused by cute rabbits.\n\nThose who lose their way will eventually disappear into the unquenchable eternal night.", "description": "Houraisan Kaguya (Kaguya) has a bunch of numbers.\n\nKaguya has $n$ non-negative integers $a_1,a_2\\cdots a_n$. Since Kaguya went to play a Gal Game, she hopes that you, who are wise, can help.\n\n- You need to divide these numbers into several groups, such that each of the $n$ numbers is assigned to exactly one group, and each group contains at least one number.\n\nDefine the weight of a group as the **xor sum** of all numbers in that group. Please find a grouping plan that minimizes the sum of the weights of all groups, and output this minimum value.", "inputFormat": "The first line contains a positive integer $n$, representing the number of given non-negative integers.\n\nThe next line contains $n$ non-negative integers $a_1,a_2\\cdots a_n$.", "outputFormat": "Output one line with one integer representing the answer.", "hint": "**Explanation for Sample $1$:**\n\nOne optimal grouping plan is:\n\n- Put the $1$st number and the $3$rd number into one group, whose weight is $1\\oplus 5 = 4$.\n- Put the $2$nd number into one group, whose weight is $2$.\n\nThe sum of the weights of all groups is $4 + 2 = 6$. It can be proven that there is no grouping plan with a smaller total weight sum.\n\n**Explanation for Sample $2$:**\n\nOne optimal grouping plan is:\n\n- Put the $1$st number and the $5$th number into one group, whose weight is $9\\oplus 9 = 0$.\n- Put the $2$nd number and the $4$th number into one group, whose weight is $18\\oplus 25 = 11$.\n- Put the $3$rd number and the $6$th number into one group, whose weight is $36\\oplus 32 = 4$.\n\nThe sum of the weights of all groups is $0 + 11 + 4 = 15$. It can be proven that there is no grouping plan with a smaller total weight sum.\n\n### Subtasks\n\n- For $80\\%$ of the testdata, $n\\leq 15$.\n- For $100\\%$ of the testdata, $n\\leq 10^6,a_i \\leq 10^9$.\n\n### Source\n\n[Lost Home 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T1\n\nProblem setter: disangan233\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 永夜的报应", "background": "在这世上有一乡一林一竹亭，也有一主一仆一仇敌。\n\n有人曾经想拍下他们的身影，却被可爱的兔子迷惑了心神。\n\n那些迷途中的人啊，终究会消失在不灭的永夜中……  ", "description": "蓬莱山 辉夜(Kaguya)手里有一堆数字。\n\n辉夜手里有 $n$ 个非负整数 $a_1,a_2\\cdots a_n$，由于辉夜去打 Gal Game 去了，她希望智慧的你来帮忙。  \n\n* 你需要将这些数分成若干组，满足 $n$ 个数中的每一个数都恰好被分到了一个组中，且每一组至少包含一个数。  \n\n定义一组数的权值为该组内所有数的**异或和**。请求出一种分组方案，使得分出的所有组数的权值之和最小，输出权值之和的最小值。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示给定的非负整数的数量。\n\n接下来一行包含 $n$ 个非负整数 $a_1,a_2\\cdots a_n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "**样例 $1$ 解释：**\n\n一种最优的分组方案如下：\n\n- 将第 $1$ 个数和第 $3$ 个数分为一组，该组的权值为 $1\\oplus 5 = 4$；\n- 将第 $2$ 个数分为一组，该组的权值为 $2$。\n\n该分组方案的所有组的权值之和为 $4 + 2 = 6$，可以证明，不存在权值之和更小的分组方案。\n\n**样例 $2$ 解释：**\n\n一种最优的分组方案如下：\n\n- 将第 $1$ 个数和第 $5$ 个数分为一组，该组的权值为 $9\\oplus 9 = 0$；\n- 将第 $2$ 个数和第 $4$ 个数分为一组，该组的权值为 $18\\oplus 25 = 11$；\n- 将第 $3$ 个数和第 $6$ 个数分为一组，该组的权值为 $36\\oplus 32 = 4$。\n\n该分组方案的所有组的权值之和为 $0 + 11 + 4 = 15$。可以证明，不存在权值之和更小的分组方案。\n\n### 子任务\n\n- 对于 $80\\%$ 的数据，满足 $n\\leq 15$。\n- 对于 $100\\%$ 的数据，满足 $n\\leq 10^6,a_i \\leq 10^9$。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T1\n\n出题人：disangan233\n\n", "locale": "zh-CN"}}}
{"pid": "P5515", "type": "P", "difficulty": 4, "samples": [["500 233 0", "0.00503"], ["10000 3141592653 0", "0.10166"], ["50000 1314159 0", "0.50722"], ["50000 1314159 1", "1.51676"], ["1000000 5201314 0", "10.30487"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "洛谷原创", "Special Judge", "O2优化", "微积分"], "title": "[MtOI2019] 灵梦的计算器", "background": "**注: 该背景部分改编自 disangan233 中考前买计算器的真实事件。**  \n\n博丽 灵梦 (Hakurei Reimu) 在成功抢回八云 紫 (Yakumo Yukari) 用隙间偷走的香火钱后，她和依神 紫苑 (Yorigami Shion) 去香霖堂买东西啦！  \n\n灵梦想买一个计算器来计算神社的香火钱，但是因为香霖堂的东西太贵了，她选择使用河童重工网络 (Kawashiro Nitori's Network,KNN) 网购一个 Casio 计算器。\n\n但出人意料的是，灵梦使用 KNN 买回来的 Casio 是个假货，最多只能显示整数部分（即向下取整）。   \n\n灵梦很苦恼，因为这个计算器可能会导致一些特别大的误差。所以灵梦想让拥有外界的式神(指电脑)的你帮她解决一个问题。", "description": "灵梦得到了3个实数 $n$ ，$a$ ，$b$ ( $4\\le n\\le 5,5 \\le a,b \\le 10$ ) ，她成功地计算了 $n^a+n^b$，得到了一个只显示整数部分的结果。  \n\n灵梦想知道，若存在一个实数 $n'(n' \\geq 0)$，使得 ${n'}^a+{n'}^b$ 的结果在计算器上与 $n^a+n^b$ 的结果显示出来**完全一致**时，$n'$ 的变化范围，即 $n'$ 的最大值与最小值之差。  \n\n如果你不知道如何计算 $n^k$，请使用`cmath`库的`pow()`函数，`pow(n,k)`的结果即为 $n^k$ 的结果。    \n\n---\n\n为了提高本题的难度，灵梦给你设置了 $T$ 组询问。而为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问(代码来自河童重工)：  \n\n~~~cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#define uint unsigned int\n\tuint sd;int op;\n\tinline void init() {scanf(\"%u %d\", &sd, &op);}\n\tinline uint uint_rand()\n\t{\n\t\tsd ^= sd << 13;\n\t\tsd ^= sd >> 7;\n\t\tsd ^= sd << 11;\n\t\treturn sd;\n\t}\n\tinline double get_n()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn x + 4;\n\t}\n\tinline double get_k()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn (x + 1) * 5;\n\t}\n\tinline void read(double &n,double &a, double &b)\n\t{\n\t\tn = get_n(); a = get_k();\n\t\tif (op) b = a;\n\t\telse b = get_k(); \n\t}\n}\n~~~\n\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::read(n,a,b)` 函数后得到的便是第 $i$ 次询问的 $n_i$, $a_i$ 和 $b_i$。     \n\n为了减少你的输出量，令第 $i$ 次询问的答案为 $s_i$，你只需要输出 $\\sum^{T}_{i=1} s_i$ 。如果你的答案与标准答案的绝对误差在 $10^{-2}$ 以内，你的答案则被视为是正确答案。\n\n本题数据的生成采用时间复杂度**远远劣于**普通算法的高 (da) 精 (bao) 度 (li) 算法来保证精度，本题数据保证**单次询问的误差**小于 $10^{-10}$，**所以本题的SPJ范围对于正解来说是完全足够的。**\n\n---\n\n为了让你更好地做题，这里给出了关于 $op$ 的说明：   \n\n* 当 $op=1$ 时，有 $a=b$，否则无特殊限定。  ", "inputFormat": "输入共一行，包含 $3$ 个正整数  $T$，$seed$，$op$，含义见题目描述。", "outputFormat": "输出共一行，输出题目描述中要求输出的答案。", "hint": "### 子任务\n\n![QQ图片20190707214000.png](https://i.loli.net/2019/07/07/5d21f64bc09c827059.png)\n\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T2\n\n出题人：disangan233\n\n验题人：suwakow\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Reimu's Calculator.", "background": "**Note: This background is adapted from a real event where disangan233 bought a calculator before the high school entrance exam.**  \n\nAfter Hakurei Reimu successfully took back the donation money that Yakumo Yukari stole using gaps, she and Yorigami Shion went to Kourindou to buy things!  \n\nReimu wanted to buy a calculator to compute the shrine’s donation money, but since the goods in Kourindou were too expensive, she chose to buy a Casio calculator online via Kawashiro Nitori's Network (KNN).\n\nUnexpectedly, the Casio she bought through KNN was a fake. It can display only the integer part (i.e., it always rounds down).  \n\nReimu is troubled, because this calculator may cause some especially large errors. So Reimu wants you, who have a shikigami from the Outside World (meaning a computer), to help her solve a problem.", "description": "Reimu is given 3 real numbers $n$, $a$, $b$ ($4 \\le n \\le 5$, $5 \\le a,b \\le 10$). She successfully computed $n^a+n^b$, and got a result that shows only the integer part on the calculator.  \n\nReimu wants to know: if there exists a real number $n'(n' \\geq 0)$ such that the result of ${n'}^a+{n'}^b$ shown on the calculator is **exactly the same** as the result shown for $n^a+n^b$, then what is the range of possible values of $n'$, i.e., the difference between the maximum and minimum possible $n'$.  \n\nIf you do not know how to compute $n^k$, please use the `pow()` function in the `cmath` library. The result of `pow(n,k)` is $n^k$.    \n\n---\n\nTo increase the difficulty of this problem, Reimu gives you $T$ queries. To reduce your input and output to some extent, we generate the queries using the following code (the code comes from Kawashiro Heavy Industries):\n\n~~~cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#define uint unsigned int\n\tuint sd;int op;\n\tinline void init() {scanf(\"%u %d\", &sd, &op);}\n\tinline uint uint_rand()\n\t{\n\t\tsd ^= sd << 13;\n\t\tsd ^= sd >> 7;\n\t\tsd ^= sd << 11;\n\t\treturn sd;\n\t}\n\tinline double get_n()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn x + 4;\n\t}\n\tinline double get_k()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn (x + 1) * 5;\n\t}\n\tinline void read(double &n,double &a, double &b)\n\t{\n\t\tn = get_n(); a = get_k();\n\t\tif (op) b = a;\n\t\telse b = get_k(); \n\t}\n}\n~~~\n\nAfter calling `Mker::init()`, when you call `Mker::read(n,a,b)` for the $i$-th time, you will obtain the $i$-th query’s $n_i$, $a_i$, and $b_i$.     \n\nTo reduce your output, let the answer to the $i$-th query be $s_i$. You only need to output $\\sum^{T}_{i=1} s_i$. If the absolute error between your answer and the standard answer is within $10^{-2}$, your answer will be considered correct.\n\nThe testdata of this problem is generated using a high (da) precision (bao) algorithm with a time complexity **much worse** than normal algorithms, to ensure accuracy. The testdata guarantees that the **error of each single query** is less than $10^{-10}$, so the SPJ tolerance for this problem is completely sufficient for correct solutions.\n\n---\n\nTo help you solve the problem, here is an explanation of $op$:  \n\n* When $op=1$, we have $a=b$. Otherwise, there is no special constraint.", "inputFormat": "The input contains one line with $3$ positive integers $T$, $seed$, $op$. Their meanings are described in the problem statement.", "outputFormat": "Output one line, the answer required in the problem statement.", "hint": "### Subtasks\n\n![QQ图片20190707214000.png](https://i.loli.net/2019/07/07/5d21f64bc09c827059.png)\n\n\n### Source\n\n[Lost House 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T2\n\nProblem setter: disangan233\n\nProblem reviewer: suwakow\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 灵梦的计算器", "background": "**注: 该背景部分改编自 disangan233 中考前买计算器的真实事件。**  \n\n博丽 灵梦 (Hakurei Reimu) 在成功抢回八云 紫 (Yakumo Yukari) 用隙间偷走的香火钱后，她和依神 紫苑 (Yorigami Shion) 去香霖堂买东西啦！  \n\n灵梦想买一个计算器来计算神社的香火钱，但是因为香霖堂的东西太贵了，她选择使用河童重工网络 (Kawashiro Nitori's Network,KNN) 网购一个 Casio 计算器。\n\n但出人意料的是，灵梦使用 KNN 买回来的 Casio 是个假货，最多只能显示整数部分（即向下取整）。   \n\n灵梦很苦恼，因为这个计算器可能会导致一些特别大的误差。所以灵梦想让拥有外界的式神(指电脑)的你帮她解决一个问题。", "description": "灵梦得到了3个实数 $n$ ，$a$ ，$b$ ( $4\\le n\\le 5,5 \\le a,b \\le 10$ ) ，她成功地计算了 $n^a+n^b$，得到了一个只显示整数部分的结果。  \n\n灵梦想知道，若存在一个实数 $n'(n' \\geq 0)$，使得 ${n'}^a+{n'}^b$ 的结果在计算器上与 $n^a+n^b$ 的结果显示出来**完全一致**时，$n'$ 的变化范围，即 $n'$ 的最大值与最小值之差。  \n\n如果你不知道如何计算 $n^k$，请使用`cmath`库的`pow()`函数，`pow(n,k)`的结果即为 $n^k$ 的结果。    \n\n---\n\n为了提高本题的难度，灵梦给你设置了 $T$ 组询问。而为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问(代码来自河童重工)：  \n\n~~~cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#define uint unsigned int\n\tuint sd;int op;\n\tinline void init() {scanf(\"%u %d\", &sd, &op);}\n\tinline uint uint_rand()\n\t{\n\t\tsd ^= sd << 13;\n\t\tsd ^= sd >> 7;\n\t\tsd ^= sd << 11;\n\t\treturn sd;\n\t}\n\tinline double get_n()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn x + 4;\n\t}\n\tinline double get_k()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn (x + 1) * 5;\n\t}\n\tinline void read(double &n,double &a, double &b)\n\t{\n\t\tn = get_n(); a = get_k();\n\t\tif (op) b = a;\n\t\telse b = get_k(); \n\t}\n}\n~~~\n\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::read(n,a,b)` 函数后得到的便是第 $i$ 次询问的 $n_i$, $a_i$ 和 $b_i$。     \n\n为了减少你的输出量，令第 $i$ 次询问的答案为 $s_i$，你只需要输出 $\\sum^{T}_{i=1} s_i$ 。如果你的答案与标准答案的绝对误差在 $10^{-2}$ 以内，你的答案则被视为是正确答案。\n\n本题数据的生成采用时间复杂度**远远劣于**普通算法的高 (da) 精 (bao) 度 (li) 算法来保证精度，本题数据保证**单次询问的误差**小于 $10^{-10}$，**所以本题的SPJ范围对于正解来说是完全足够的。**\n\n---\n\n为了让你更好地做题，这里给出了关于 $op$ 的说明：   \n\n* 当 $op=1$ 时，有 $a=b$，否则无特殊限定。  ", "inputFormat": "输入共一行，包含 $3$ 个正整数  $T$，$seed$，$op$，含义见题目描述。", "outputFormat": "输出共一行，输出题目描述中要求输出的答案。", "hint": "### 子任务\n\n![QQ图片20190707214000.png](https://i.loli.net/2019/07/07/5d21f64bc09c827059.png)\n\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T2\n\n出题人：disangan233\n\n验题人：suwakow\n", "locale": "zh-CN"}}}
{"pid": "P5516", "type": "P", "difficulty": 6, "samples": [["NACLYFISHAKIOI\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0", "164.9"], ["DSGAY\n1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0\n\n", "16.0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262139, 262139, 262139, 262139, 262139, 262139, 262139, 262139, 262139, 262139]}, "tags": ["动态规划 DP", "2019", "洛谷原创", "O2优化", "期望"], "title": "[MtOI2019] 小铃的烦恼", "background": "在幻想乡中，本居 小铃(Motoori Kosuzu)不仅经常被人撞，还要整理铃奈庵的书籍，她有很多烦恼。", "description": "小铃每天都会整理一次铃奈庵的书籍。这次桌子上有 $n$ 本魔法书，这些书一次排成一排，每本书有一个魔法属性和编号。\n\n最开始这些书的魔法属性都是一样的，但是因为被人多次使用，魔法属性发生了变化，小铃想让所有书的魔法属性重新全部相同。\n\n这次小铃找到了雾雨 魔理沙(Kirisame Marisa)帮忙整理书籍，每次魔理沙可以释放选定魔法，魔法会随机选择两本书 $a,b$ ( $a$ 不等于 $b$ )。\n\n选定这两本书后，魔理沙会释放转移魔法，使得有 $p_{a,b}\\ (p_{a,b}\\in (0,1])$ 的概率，第 $b$ 本书的魔法属性变成第 $a$ 本书的魔法属性。也就是说有 $1-p_{a,b}$ 的概率，使得你**即使选定了 $a,b$ 两本书，但是魔法属性的转移不成功，意味着这次操作是无效的** 。\n\n注意 $p_{a,b}$ 是对于**转移是否成功的概率**，和随机选择两本书的操作互不影响。\n\n现在小铃想知道，求期望操作多少次，才能使所有的书魔法属性都一样？由于时间紧迫，小铃找到了你，希望你可以帮其解决这个问题，不然小铃就不会给你这题的分了。", "inputFormat": "第一行一个字符串，第 $i$ 个字符表示第 $i$ 本书的魔法属性，注意每本书的魔法属性为 $A$ 到 $Z$ 的所有的大写字母中的任意一字母。(设字符串的长度为 $n$ ) 。\n\n第二行到第 $n+1$ 行，每行 $n$ 个实数，第 $i$ 行的第 $j$ 个数表示 $p_{i,j}$ 。", "outputFormat": "结果，精确到小数点后 $1$ 位。", "hint": "对于前 $10\\%$ 的数据，$n\\leq 10$，且最多有一种不同的魔法属性。\n\n对于另外 $20\\%$ 的数据，$n\\leq10$，且最多有两种不同的魔法属性，并且其中一种的魔法属性的个数小于等于 $1$  。\n\n对于 $100\\%$ 的数据，$n\\leq2\\times 10^3$ 。\n\n对于所有数据，满足 $\\left(\\sum\\limits_{a=1}^{n}\\sum\\limits_{b=1}^{n}p_{a,b}\\right) = n^2$ 。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T3\n\n出题人：Qiuly \n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Kosuzu's Troubles", "background": "In Gensokyo, Motoori Kosuzu not only often gets bumped into by others, but also has to organize the books in Suzunaan. She has many troubles.", "description": "Kosuzu organizes the books in Suzunaan once every day. This time there are $n$ magic books on the table, placed in a row. Each book has a magic attribute and an index.\n\nAt the beginning, all books had the same magic attribute. However, after being used many times, their magic attributes changed. Kosuzu wants all books to have the same magic attribute again.\n\nThis time Kosuzu asks Kirisame Marisa for help. Each time, Marisa can cast a chosen spell, and the spell will randomly choose two books $a,b$ (where $a$ is not equal to $b$).\n\nAfter these two books are chosen, Marisa casts a transfer spell: with probability $p_{a,b}\\ (p_{a,b}\\in (0,1])$, the magic attribute of book $b$ becomes the magic attribute of book $a$. That is, with probability $1-p_{a,b}$, **even if you have chosen books $a,b$, the transfer fails, meaning this operation is invalid**.\n\nNote that $p_{a,b}$ is the **probability that the transfer succeeds**, and it does not affect the random process of choosing the two books.\n\nNow Kosuzu wants to know: what is the expected number of operations needed to make the magic attributes of all books identical? Since time is tight, Kosuzu asks you for help. Otherwise, she will not give you the points for this problem.", "inputFormat": "The first line contains a string. The $i$-th character represents the magic attribute of the $i$-th book. Note that each book’s magic attribute is any uppercase letter from $A$ to $Z$. (Let the length of the string be $n$.)\n\nLines $2$ to $n+1$ each contain $n$ real numbers. The $j$-th number on the $i$-th of these lines represents $p_{i,j}$.", "outputFormat": "Output the answer, accurate to $1$ digit after the decimal point.", "hint": "For the first $10\\%$ of the testdata, $n\\leq 10$, and there is at most one kind of magic attribute.\n\nFor another $20\\%$ of the testdata, $n\\leq 10$, and there are at most two kinds of magic attributes, and the count of one of the attributes is at most $1$.\n\nFor $100\\%$ of the testdata, $n\\leq2\\times 10^3$.\n\nFor all testdata, $\\left(\\sum\\limits_{a=1}^{n}\\sum\\limits_{b=1}^{n}p_{a,b}\\right) = n^2$.\n\n### Source\n\n[Meituzhijia 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T3\n\nProblem setter: Qiuly\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 小铃的烦恼", "background": "在幻想乡中，本居 小铃(Motoori Kosuzu)不仅经常被人撞，还要整理铃奈庵的书籍，她有很多烦恼。", "description": "小铃每天都会整理一次铃奈庵的书籍。这次桌子上有 $n$ 本魔法书，这些书一次排成一排，每本书有一个魔法属性和编号。\n\n最开始这些书的魔法属性都是一样的，但是因为被人多次使用，魔法属性发生了变化，小铃想让所有书的魔法属性重新全部相同。\n\n这次小铃找到了雾雨 魔理沙(Kirisame Marisa)帮忙整理书籍，每次魔理沙可以释放选定魔法，魔法会随机选择两本书 $a,b$ ( $a$ 不等于 $b$ )。\n\n选定这两本书后，魔理沙会释放转移魔法，使得有 $p_{a,b}\\ (p_{a,b}\\in (0,1])$ 的概率，第 $b$ 本书的魔法属性变成第 $a$ 本书的魔法属性。也就是说有 $1-p_{a,b}$ 的概率，使得你**即使选定了 $a,b$ 两本书，但是魔法属性的转移不成功，意味着这次操作是无效的** 。\n\n注意 $p_{a,b}$ 是对于**转移是否成功的概率**，和随机选择两本书的操作互不影响。\n\n现在小铃想知道，求期望操作多少次，才能使所有的书魔法属性都一样？由于时间紧迫，小铃找到了你，希望你可以帮其解决这个问题，不然小铃就不会给你这题的分了。", "inputFormat": "第一行一个字符串，第 $i$ 个字符表示第 $i$ 本书的魔法属性，注意每本书的魔法属性为 $A$ 到 $Z$ 的所有的大写字母中的任意一字母。(设字符串的长度为 $n$ ) 。\n\n第二行到第 $n+1$ 行，每行 $n$ 个实数，第 $i$ 行的第 $j$ 个数表示 $p_{i,j}$ 。", "outputFormat": "结果，精确到小数点后 $1$ 位。", "hint": "对于前 $10\\%$ 的数据，$n\\leq 10$，且最多有一种不同的魔法属性。\n\n对于另外 $20\\%$ 的数据，$n\\leq10$，且最多有两种不同的魔法属性，并且其中一种的魔法属性的个数小于等于 $1$  。\n\n对于 $100\\%$ 的数据，$n\\leq2\\times 10^3$ 。\n\n对于所有数据，满足 $\\left(\\sum\\limits_{a=1}^{n}\\sum\\limits_{b=1}^{n}p_{a,b}\\right) = n^2$ 。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T3\n\n出题人：Qiuly \n", "locale": "zh-CN"}}}
{"pid": "P5517", "type": "P", "difficulty": 6, "samples": [["142857 1145141919 0", "562611141"], ["142857 1145141919 1", "894946216"], ["142857 1145141919 2", "771134436"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2019", "洛谷原创", "O2优化", "矩阵加速", "生成函数", "线性递推"], "title": "[MtOI2019] 幻想乡数学竞赛", "background": "一年一度的幻想乡数学竞赛 (thMO) 又要开始了。\n\n幻想乡中学习数学的少 (lao) 女 (tai) 们 (po) 和冰之妖精 baka 一起准备着 thMO。\n\n但是在那一刻，幻想乡日复一日的宁静被打破了。\n\n广播里，播放起了死亡的歌曲！\n\n在那一刻，人们又回想起了被算数支配的恐惧。  \n\n就剩下 baka，baka，baka，baka 的声音在幻想乡里回荡。  \n \n\n---  \n\n河城 荷取 (Kawashiro Nitori) 正坐在 thMO2019 的考场上！  \n因为荷取有着她的[超级计算机](https://www.luogu.org/problemnew/show/P4911)，在成功地用光学迷彩覆盖了计算机之后，荷取在 thMO2019 的考场上所向披靡。  \n\n* 荷取用她的超级计算机 $0 \\,\\mathrm{ms}$ 跑出了这么一道题：  \n\n  * $\\exists \\{ a_n\\} (n=0,1,\\cdots ,10^{18})$，已知 $a_0=2,a_1=5,a_{n+2}=3a_{n+1}-2a_n$，求 $a_n\\bmod 10^{9}+7$\n\n* 荷取：显然，这个题可以用矩阵乘法 + 快速幂，可以 $O(\\log n)$ 水过去，差不多就这样：\n\n$$\n\\begin{bmatrix} a_n & a_{n+1} \\end{bmatrix}=\\begin{bmatrix} a_0 & a_1 \\end{bmatrix} \\times \\begin{bmatrix} 3 & 1 \\\\ -2 & 0 \\end{bmatrix}^n\n$$      \n  \n但是荷取遇到了一道她不会的题，她正在寻求你的帮助呢！ ", "description": "存在一个数列 $\\{ a_n\\} (n\\in \\{ 0,1,2,\\cdots ,2^{64}-1\\} )$。  \n已知 $a_0=-3,a_1=-6,a_2=-12,a_n=3a_{n-1}+a_{n-2}-3a_{n-3}+3^n$。  \n\n* 现在给你一个非负整数 $n$ ，令 $p=10^{9}+7$，请你求出 $a_n \\bmod p$。 \n\n* **注：若 $a_n<0$ ，请输出 $(a_n \\bmod p+p)\\bmod p$。**    \n  \n  \n为了更充分地考验你的水平，荷取设置了 $T$ 组询问。\n\n* 为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问：  \n  \n```cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#include<climits>\n\t#define ull unsigned long long\n\t#define uint unsigned int\n\tull sd;int op;\n\tinline void init() {scanf(\"%llu %d\", &sd, &op);}\n\tinline ull ull_rand()\n\t{\n\t\tsd ^= sd << 43;\n\t\tsd ^= sd >> 29;\n\t\tsd ^= sd << 34;\n\t\treturn sd;\n\t}\n\tinline ull rand()\n\t{\n\t\tif (op == 0) return ull_rand() % USHRT_MAX + 1;\n\t\tif (op == 1) return ull_rand() % UINT_MAX + 1; \n\t\tif (op == 2) return ull_rand();\n\t}\n}\n```  \n\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::rand()` 函数时返回的便是第 $i$ 次询问的 $n_i$。\n\n在这里给出 $op$ 的限制：\n\n* 如果 $op=0$，满足 $n_i \\leq 2^{16}$。\n\n* 如果 $op=1$，满足 $n_i \\leq 2^{32}$。\n\n* 如果 $op=2$，满足 $n_i \\leq 2^{64}-1$。\n\n为了减少你的输出量，你只需要输出所有询问答案的**异或和**。\n\n\n\n", "inputFormat": "第一行三个整数，输入 $T$ ， $seed$ 和 $op$。", "outputFormat": "第一行一个整数，输出 $T$ 组询问的答案的**异或和**。  ", "hint": "### 子任务  \n\n![png](https://i.loli.net/2019/04/19/5cb9bb2c6c1d6.png)  \n\n### 题目来源\n\n[迷途之家 2019 联赛](https://www.luogu.org/contest/20135)(MtOI2019) T4\n\n出题人：disangan233\n\n验题人：suwakow\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Gensokyo Mathematics Contest", "background": "The annual Gensokyo Mathematics Contest (thMO) is about to begin again.\n\nThe young (actually old) girls (actually housewives) who study math in Gensokyo, together with the ice fairy baka, are preparing for thMO.\n\nBut at that moment, the day-by-day peace of Gensokyo was broken.\n\nOn the radio, a song of death started playing!\n\nAt that moment, people recalled the fear of being ruled by arithmetic again.\n\nOnly the voice of baka, baka, baka, baka echoed throughout Gensokyo.\n\n---\n\nKawashiro Nitori is sitting in the thMO2019 exam room!  \nBecause Nitori has her [supercomputer](https://www.luogu.org/problemnew/show/P4911), after successfully covering it with optical camouflage, she became unstoppable in the thMO2019 exam.\n\n* Nitori used her supercomputer to solve this problem in $0 \\,\\mathrm{ms}$:\n\n  * $\\exists \\{ a_n\\} (n=0,1,\\cdots ,10^{18})$，given $a_0=2,a_1=5,a_{n+2}=3a_{n+1}-2a_n$, find $a_n\\bmod 10^{9}+7$\n\n* Nitori: Obviously, this can be done with matrix multiplication + fast exponentiation, and you can pass it in $O(\\log n)$, roughly like this:\n\n$$\n\\begin{bmatrix} a_n & a_{n+1} \\end{bmatrix}=\\begin{bmatrix} a_0 & a_1 \\end{bmatrix} \\times \\begin{bmatrix} 3 & 1 \\\\ -2 & 0 \\end{bmatrix}^n\n$$\n\nBut Nitori encountered a problem she cannot solve, and she is asking for your help!", "description": "There exists a sequence $\\{ a_n\\} (n\\in \\{ 0,1,2,\\cdots ,2^{64}-1\\} )$.  \nGiven $a_0=-3,a_1=-6,a_2=-12,a_n=3a_{n-1}+a_{n-2}-3a_{n-3}+3^n$.\n\n* Now you are given a non-negative integer $n$. Let $p=10^{9}+7$. Please compute $a_n \\bmod p$.\n\n* **Note: if $a_n<0$, please output $(a_n \\bmod p+p)\\bmod p$.**\n\nTo test your skills more thoroughly, Nitori prepared $T$ queries.\n\n* To reduce the amount of input and output to some extent, we generate the queries using the following code:\n\n```cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#include<climits>\n\t#define ull unsigned long long\n\t#define uint unsigned int\n\tull sd;int op;\n\tinline void init() {scanf(\"%llu %d\", &sd, &op);}\n\tinline ull ull_rand()\n\t{\n\t\tsd ^= sd << 43;\n\t\tsd ^= sd >> 29;\n\t\tsd ^= sd << 34;\n\t\treturn sd;\n\t}\n\tinline ull rand()\n\t{\n\t\tif (op == 0) return ull_rand() % USHRT_MAX + 1;\n\t\tif (op == 1) return ull_rand() % UINT_MAX + 1; \n\t\tif (op == 2) return ull_rand();\n\t}\n}\n```\n\nAfter calling `Mker::init()`, the value returned by your $i$-th call to `Mker::rand()` is the $n_i$ of the $i$-th query.\n\nThe constraints on $op$ are as follows:\n\n* If $op=0$, then $n_i \\leq 2^{16}$.\n\n* If $op=1$, then $n_i \\leq 2^{32}$.\n\n* If $op=2$, then $n_i \\leq 2^{64}-1$.\n\nTo reduce your output size, you only need to output the **xor sum** of the answers of all queries.", "inputFormat": "The first line contains three integers: $T$, $seed$, and $op$.", "outputFormat": "Output one integer: the **xor sum** of the answers to the $T$ queries.", "hint": "### Subtasks\n\n![png](https://i.loli.net/2019/04/19/5cb9bb2c6c1d6.png)\n\n### Source\n\n[Lost Home 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T4\n\nProblem setter: disangan233\n\nProblem tester: suwakow\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 幻想乡数学竞赛", "background": "一年一度的幻想乡数学竞赛 (thMO) 又要开始了。\n\n幻想乡中学习数学的少 (lao) 女 (tai) 们 (po) 和冰之妖精 baka 一起准备着 thMO。\n\n但是在那一刻，幻想乡日复一日的宁静被打破了。\n\n广播里，播放起了死亡的歌曲！\n\n在那一刻，人们又回想起了被算数支配的恐惧。  \n\n就剩下 baka，baka，baka，baka 的声音在幻想乡里回荡。  \n \n\n---  \n\n河城 荷取 (Kawashiro Nitori) 正坐在 thMO2019 的考场上！  \n因为荷取有着她的[超级计算机](https://www.luogu.org/problemnew/show/P4911)，在成功地用光学迷彩覆盖了计算机之后，荷取在 thMO2019 的考场上所向披靡。  \n\n* 荷取用她的超级计算机 $0 \\,\\mathrm{ms}$ 跑出了这么一道题：  \n\n  * $\\exists \\{ a_n\\} (n=0,1,\\cdots ,10^{18})$，已知 $a_0=2,a_1=5,a_{n+2}=3a_{n+1}-2a_n$，求 $a_n\\bmod 10^{9}+7$\n\n* 荷取：显然，这个题可以用矩阵乘法 + 快速幂，可以 $O(\\log n)$ 水过去，差不多就这样：\n\n$$\n\\begin{bmatrix} a_n & a_{n+1} \\end{bmatrix}=\\begin{bmatrix} a_0 & a_1 \\end{bmatrix} \\times \\begin{bmatrix} 3 & 1 \\\\ -2 & 0 \\end{bmatrix}^n\n$$      \n  \n但是荷取遇到了一道她不会的题，她正在寻求你的帮助呢！ ", "description": "存在一个数列 $\\{ a_n\\} (n\\in \\{ 0,1,2,\\cdots ,2^{64}-1\\} )$。  \n已知 $a_0=-3,a_1=-6,a_2=-12,a_n=3a_{n-1}+a_{n-2}-3a_{n-3}+3^n$。  \n\n* 现在给你一个非负整数 $n$ ，令 $p=10^{9}+7$，请你求出 $a_n \\bmod p$。 \n\n* **注：若 $a_n<0$ ，请输出 $(a_n \\bmod p+p)\\bmod p$。**    \n  \n  \n为了更充分地考验你的水平，荷取设置了 $T$ 组询问。\n\n* 为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问：  \n  \n```cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#include<climits>\n\t#define ull unsigned long long\n\t#define uint unsigned int\n\tull sd;int op;\n\tinline void init() {scanf(\"%llu %d\", &sd, &op);}\n\tinline ull ull_rand()\n\t{\n\t\tsd ^= sd << 43;\n\t\tsd ^= sd >> 29;\n\t\tsd ^= sd << 34;\n\t\treturn sd;\n\t}\n\tinline ull rand()\n\t{\n\t\tif (op == 0) return ull_rand() % USHRT_MAX + 1;\n\t\tif (op == 1) return ull_rand() % UINT_MAX + 1; \n\t\tif (op == 2) return ull_rand();\n\t}\n}\n```  \n\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::rand()` 函数时返回的便是第 $i$ 次询问的 $n_i$。\n\n在这里给出 $op$ 的限制：\n\n* 如果 $op=0$，满足 $n_i \\leq 2^{16}$。\n\n* 如果 $op=1$，满足 $n_i \\leq 2^{32}$。\n\n* 如果 $op=2$，满足 $n_i \\leq 2^{64}-1$。\n\n为了减少你的输出量，你只需要输出所有询问答案的**异或和**。\n\n\n\n", "inputFormat": "第一行三个整数，输入 $T$ ， $seed$ 和 $op$。", "outputFormat": "第一行一个整数，输出 $T$ 组询问的答案的**异或和**。  ", "hint": "### 子任务  \n\n![png](https://i.loli.net/2019/04/19/5cb9bb2c6c1d6.png)  \n\n### 题目来源\n\n[迷途之家 2019 联赛](https://www.luogu.org/contest/20135)(MtOI2019) T4\n\n出题人：disangan233\n\n验题人：suwakow\n", "locale": "zh-CN"}}}
{"pid": "P5518", "type": "P", "difficulty": 7, "samples": [["3 998244853\n1 1 1\n2 2 2\n3 3 3\n", "1 1 1\n16 4096 16\n180292630 873575259 180292630\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "洛谷原创", "Special Judge", "O2优化", "莫比乌斯反演", "整除分块"], "title": "[MtOI2019] 幽灵乐团 / 莫比乌斯反演基础练习题", "background": "白玉楼中，冥界的音乐会开始了。\n\nLunasa，Lyrica 和 Merlin 正在演奏。", "description": "东风谷 早苗(Kochiya Sanae)非常喜欢幽灵乐团的演奏，她想对她们的演奏评分。\n\n因为幽灵乐团有 $3$ 个人，所以我们可以用 $3$ 个正整数 $A,B,C$ 来表示出乐团演奏的分数，她们的演奏分数可以表示为\n\n$$\\prod_{i=1}^{A}\\prod_{j=1}^{B}\\prod_{k=1}^{C}\\left(\\frac{\\text{lcm}(i,j)}{\\gcd(i,k)}\\right)^{f(type)}$$\n\n因为音乐在不同的部分会有不同的听觉感受，所以 $type$ 会在 $\\{0,1,2\\}$ 中发生变化，其中：\n\n$$\\begin{aligned}\nf(0)&=1 \\cr\nf(1)&=i \\times j \\times k \\cr\nf(2)&=\\gcd(i,j,k)\n\\end{aligned}$$\n\n因为乐团的歌实在太好听了，导致分数特别高，所以她们的分数要对给定的正整数 $p$ 取模。\n\n因为有很多歌曲要演奏，所以早苗给出了 $T$ 组询问。", "inputFormat": "第一行两个正整数 $T$，$p$，含义详见题目描述。\n\n接下来 $T$ 行，每行三个正整数 $A,B,C$ 表示每组询问。", "outputFormat": "$T$ 行，每行三个正整数分别表示 $type=0/1/2$ 的时候给定式子的值。", "hint": "### 数据范围及约定\n\n对于 $10\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 50 $$  \n\n对于 $20\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 100 $$\n\n另有 $10\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 100\\ \\ \\ \\ \\ A=B=C $$  \n\n对于 $60\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 10^3 $$\n\n对于 $100\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 10^5 \\ \\ \\ \\ 10^7 \\leq p \\leq 1.05\\times 10^9\\ \\ \\ \\ p\\in \\{ prime\\} \\ \\ \\ \\ T =70$$\n\n---\n\n早苗非常善良，就算你不知道所有的正确答案，她也会给你一些分数。 \n \n* 如果你的第一列是正确的，她将会给你这个测试点 $20\\%$ 的分数。\n* 如果你的第二列是正确的，她将会给你这个测试点 $40\\%$ 的分数。\n* 如果你的第三列是正确的，她将会给你这个测试点 $40\\%$ 的分数。  \n\n所以就算你不知道答案是什么，也请你在你不知道的那些地方输出 $[0,2^{31})$ 内的整数，否则可能会造成不可预估的错误。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T5\n\n出题人：CYJian \n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Ghost Band / Basic Practice of Möbius Inversion.", "background": "In Hakugyokurou, the concert in the Netherworld has begun.\n\nLunasa, Lyrica, and Merlin are performing.", "description": "Kochiya Sanae really likes the performance of the Ghost Band, and she wants to score their performance.\n\nSince the Ghost Band has $3$ members, we can use three positive integers $A,B,C$ to represent the score of the band’s performance. Their performance score can be written as\n\n$$\\prod_{i=1}^{A}\\prod_{j=1}^{B}\\prod_{k=1}^{C}\\left(\\frac{\\text{lcm}(i,j)}{\\gcd(i,k)}\\right)^{f(type)}$$\n\nBecause the music sounds different in different parts, $type$ changes within $\\{0,1,2\\}$, where:\n\n$$\\begin{aligned}\nf(0)&=1 \\cr\nf(1)&=i \\times j \\times k \\cr\nf(2)&=\\gcd(i,j,k)\n\\end{aligned}$$\n\nBecause the band’s songs are so good that the score becomes very large, the score should be taken modulo a given positive integer $p$.\n\nSince there are many songs to perform, Sanae gives $T$ queries.", "inputFormat": "The first line contains two positive integers $T$ and $p$, as described above.\n\nThe next $T$ lines each contain three positive integers $A,B,C$, representing one query.", "outputFormat": "Output $T$ lines. Each line contains three positive integers, representing the value of the given expression when $type=0/1/2$, respectively.", "hint": "### Constraints and Notes\n\nFor $10\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 50 $$\n\nFor $20\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 100 $$\n\nAnother $10\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 100\\ \\ \\ \\ \\ A=B=C $$\n\nFor $60\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 10^3 $$\n\nFor $100\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 10^5 \\ \\ \\ \\ 10^7 \\leq p \\leq 1.05\\times 10^9\\ \\ \\ \\ p\\in \\{ prime\\} \\ \\ \\ \\ T =70$$\n\n---\n\nSanae is very kind. Even if you do not know all the correct answers, she will still give you some points.\n\n* If your first column is correct, she will give you $20\\%$ of the score for this test point.\n* If your second column is correct, she will give you $40\\%$ of the score for this test point.\n* If your third column is correct, she will give you $40\\%$ of the score for this test point.\n\nSo even if you do not know what the answers are, please output an integer in $[0,2^{31})$ for the parts you do not know, otherwise it may cause unpredictable errors.\n\n### Source\n\n[Lost House 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T5.\n\nProblem setter: CYJian.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 幽灵乐团 / 莫比乌斯反演基础练习题", "background": "白玉楼中，冥界的音乐会开始了。\n\nLunasa，Lyrica 和 Merlin 正在演奏。", "description": "东风谷 早苗(Kochiya Sanae)非常喜欢幽灵乐团的演奏，她想对她们的演奏评分。\n\n因为幽灵乐团有 $3$ 个人，所以我们可以用 $3$ 个正整数 $A,B,C$ 来表示出乐团演奏的分数，她们的演奏分数可以表示为\n\n$$\\prod_{i=1}^{A}\\prod_{j=1}^{B}\\prod_{k=1}^{C}\\left(\\frac{\\text{lcm}(i,j)}{\\gcd(i,k)}\\right)^{f(type)}$$\n\n因为音乐在不同的部分会有不同的听觉感受，所以 $type$ 会在 $\\{0,1,2\\}$ 中发生变化，其中：\n\n$$\\begin{aligned}\nf(0)&=1 \\cr\nf(1)&=i \\times j \\times k \\cr\nf(2)&=\\gcd(i,j,k)\n\\end{aligned}$$\n\n因为乐团的歌实在太好听了，导致分数特别高，所以她们的分数要对给定的正整数 $p$ 取模。\n\n因为有很多歌曲要演奏，所以早苗给出了 $T$ 组询问。", "inputFormat": "第一行两个正整数 $T$，$p$，含义详见题目描述。\n\n接下来 $T$ 行，每行三个正整数 $A,B,C$ 表示每组询问。", "outputFormat": "$T$ 行，每行三个正整数分别表示 $type=0/1/2$ 的时候给定式子的值。", "hint": "### 数据范围及约定\n\n对于 $10\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 50 $$  \n\n对于 $20\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 100 $$\n\n另有 $10\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 100\\ \\ \\ \\ \\ A=B=C $$  \n\n对于 $60\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 10^3 $$\n\n对于 $100\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 10^5 \\ \\ \\ \\ 10^7 \\leq p \\leq 1.05\\times 10^9\\ \\ \\ \\ p\\in \\{ prime\\} \\ \\ \\ \\ T =70$$\n\n---\n\n早苗非常善良，就算你不知道所有的正确答案，她也会给你一些分数。 \n \n* 如果你的第一列是正确的，她将会给你这个测试点 $20\\%$ 的分数。\n* 如果你的第二列是正确的，她将会给你这个测试点 $40\\%$ 的分数。\n* 如果你的第三列是正确的，她将会给你这个测试点 $40\\%$ 的分数。  \n\n所以就算你不知道答案是什么，也请你在你不知道的那些地方输出 $[0,2^{31})$ 内的整数，否则可能会造成不可预估的错误。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T5\n\n出题人：CYJian \n", "locale": "zh-CN"}}}
{"pid": "P5519", "type": "P", "difficulty": 7, "samples": [["1 1926", "2"], ["23 3", "509581943"], ["1919 810", "252250482"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2019", "洛谷原创", "O2优化", "线性递推", "快速傅里叶变换 FFT", "Lucas 定理"], "title": "[MtOI2019] 埋骨于弘川", "background": "在幻想乡中，冥界的樱花一年又一年地往复开放。\n\n在 Yuyuko 的心中，出现了一棵樱花树，一个与花朵息息相关的序列，和一个伤感的问题。\n\n那些曾经奋斗过的 OIer 们啊，如今又在何方呢？", "description": "在幻想乡，西行寺 幽幽子(Yuyuko)是一个以贪吃著名的亡灵，她拥有操纵死亡的能力。\n\nYuyuko 通过外界的式神——电脑，对OI进行了深刻的研究 ，她发现了一些惊人的事实：\n\n* OIer 们放弃了太多其他同学们拥有的东西，在题海中寻求自己的梦想。  \n\n* 但是 AFO 的 OIer 们，跟死亡又有什么区别呢？他们或许已经失去了自己的梦想……\n\n这时幽幽子发现，天空中飘舞的樱花组成了两个整数 $n$，$k$。于此同时，在樱花树下，出现了一个函数 $f(x,y)$ 的描述：\n\n$$f(x,y) = \\begin{cases} 2 & , x=1 \\\\ 2^x& , 2\\le x \\le 42,y = 0 \\\\ \\prod\\limits_{i=1}^{42} f(x-i,y)^i & , x \\ge 43,y = 0 \\\\ f(x-1,y)f(x,y-1) & , x\\ge 2,y \\ge 1\\end{cases}$$\n\n\n\n幽幽子想让你计算出 $f(n,k) \\bmod 998244353$，她认为这个函数象征着OIer们......", "inputFormat": "两个整数 $n,k$", "outputFormat": "一个正整数 $f(n,k) \\bmod 998244353$", "hint": "【样例 $1$ 解释】\n\n根据定义，$f(1,1926)=2$。\n\n【数据范围与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1 (7 points)：$1\\le n,k \\le 1000$   \nSubtask 2 (11 points)：$1\\le n \\le 10^{18}$，$k=0$   \nSubtask 3 (13 points)：$1\\le n \\le 10^{18}$，$k=1$   \nSubtask 4 (29 points)：$1\\le n \\le 10^{18}$，$0\\le k \\le 1000$   \nSubtask 5 (40 points)：无特殊限制\n\n对于 $100\\%$ 的数据：$1\\le n \\le 10^{18}$，$0\\le k \\le 30000$   \n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T6\n\n出题人：NaCly_Fish \n\n验题人：Imagine \n\n题面：disangan233\n\n**此题稍有卡常，请注意优化代码常数。**", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Buried Bones in Hongchuan.", "background": "In Gensokyo, the cherry blossoms of the Netherworld bloom again and again, repeating year after year.\n\nIn Yuyuko’s heart, there appeared a cherry tree, a sequence closely tied to blossoms, and a sad question.\n\nThose OIers who once struggled—where are they now?", "description": "In Gensokyo, Saigyouji Yuyuko (Yuyuko) is a ghost famous for being a big eater, and she has the power to control death.\n\nThrough an external shikigami from the outside world—a computer—Yuyuko conducted deep research on OI, and discovered some shocking facts:\n\n* OIers gave up too many things that other classmates had, searching for their dreams in a sea of problems.\n\n* But for OIers who are AFO, what difference is there from death? Perhaps they have already lost their dreams...\n\nAt this moment, Yuyuko found that the cherry blossoms dancing in the sky formed two integers $n$, $k$. Meanwhile, under the cherry tree, a description of a function $f(x,y)$ appeared:\n\n$$f(x,y) = \\begin{cases} 2 & , x=1 \\\\ 2^x& , 2\\le x \\le 42,y = 0 \\\\ \\prod\\limits_{i=1}^{42} f(x-i,y)^i & , x \\ge 43,y = 0 \\\\ f(x-1,y)f(x,y-1) & , x\\ge 2,y \\ge 1\\end{cases}$$\n\nYuyuko wants you to compute $f(n,k) \\bmod 998244353$. She believes this function symbolizes OIers...", "inputFormat": "Two integers $n,k$.", "outputFormat": "A positive integer $f(n,k) \\bmod 998244353$.", "hint": "[Sample $1$ Explanation]\n\nAccording to the definition, $f(1,1926)=2$.\n\n[Constraints and Notes]\n\n**This problem uses bundled testdata.**\n\nSubtask 1 (7 points): $1\\le n,k \\le 1000$  \nSubtask 2 (11 points): $1\\le n \\le 10^{18}$, $k=0$  \nSubtask 3 (13 points): $1\\le n \\le 10^{18}$, $k=1$  \nSubtask 4 (29 points): $1\\le n \\le 10^{18}$, $0\\le k \\le 1000$  \nSubtask 5 (40 points): No special restrictions.\n\nFor $100\\%$ of the testdata: $1\\le n \\le 10^{18}$, $0\\le k \\le 30000$.\n\n### Source\n\n[Lost Home 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T6.\n\nProblem setter: NaCly_Fish.\n\nProblem reviewer: Imagine.\n\nStatement: disangan233.\n\n**This problem is slightly strict on time limits, so please optimize constant factors in your code.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 埋骨于弘川", "background": "在幻想乡中，冥界的樱花一年又一年地往复开放。\n\n在 Yuyuko 的心中，出现了一棵樱花树，一个与花朵息息相关的序列，和一个伤感的问题。\n\n那些曾经奋斗过的 OIer 们啊，如今又在何方呢？", "description": "在幻想乡，西行寺 幽幽子(Yuyuko)是一个以贪吃著名的亡灵，她拥有操纵死亡的能力。\n\nYuyuko 通过外界的式神——电脑，对OI进行了深刻的研究 ，她发现了一些惊人的事实：\n\n* OIer 们放弃了太多其他同学们拥有的东西，在题海中寻求自己的梦想。  \n\n* 但是 AFO 的 OIer 们，跟死亡又有什么区别呢？他们或许已经失去了自己的梦想……\n\n这时幽幽子发现，天空中飘舞的樱花组成了两个整数 $n$，$k$。于此同时，在樱花树下，出现了一个函数 $f(x,y)$ 的描述：\n\n$$f(x,y) = \\begin{cases} 2 & , x=1 \\\\ 2^x& , 2\\le x \\le 42,y = 0 \\\\ \\prod\\limits_{i=1}^{42} f(x-i,y)^i & , x \\ge 43,y = 0 \\\\ f(x-1,y)f(x,y-1) & , x\\ge 2,y \\ge 1\\end{cases}$$\n\n\n\n幽幽子想让你计算出 $f(n,k) \\bmod 998244353$，她认为这个函数象征着OIer们......", "inputFormat": "两个整数 $n,k$", "outputFormat": "一个正整数 $f(n,k) \\bmod 998244353$", "hint": "【样例 $1$ 解释】\n\n根据定义，$f(1,1926)=2$。\n\n【数据范围与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1 (7 points)：$1\\le n,k \\le 1000$   \nSubtask 2 (11 points)：$1\\le n \\le 10^{18}$，$k=0$   \nSubtask 3 (13 points)：$1\\le n \\le 10^{18}$，$k=1$   \nSubtask 4 (29 points)：$1\\le n \\le 10^{18}$，$0\\le k \\le 1000$   \nSubtask 5 (40 points)：无特殊限制\n\n对于 $100\\%$ 的数据：$1\\le n \\le 10^{18}$，$0\\le k \\le 30000$   \n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T6\n\n出题人：NaCly_Fish \n\n验题人：Imagine \n\n题面：disangan233\n\n**此题稍有卡常，请注意优化代码常数。**", "locale": "zh-CN"}}}
{"pid": "P5520", "type": "P", "difficulty": 3, "samples": [["1 3 2 19260718", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "2019", "O2优化", "组合数学", "排列组合"], "title": "[yLOI2019] 青原樱", "background": "> 星川之下皆萤火尘埃，  \n> 我独行在人潮你天真而待。  \n> 相遇若是借丹青着色，  \n> 青原上 绯樱如海。\n\n——银临《青原樱》(Cover 人衣大人)", "description": "扶苏是一个非常喜欢边听古风鸽边写数学题的人，因此这道题其实是个五三原题。\n\n扶苏希望重现青原上樱花盛开的景色，于是他准备了很多**互不相同**樱花树幼苗，准备种成一行。\n\n这一行中，一共有 $n$ 个位置可以种下樱花，而扶苏准备了 $m$ 支幼苗。由于樱花盛放时对左右空间需求非常大，所以樱花不能紧挨着种植，也就是任意两支幼苗之间必须至少存在一个不种花的空位置。\n\n按照这种方式种花并不难，但是令扶苏感到好奇的是一共有多少合法的方案让他把这 $m$ 支幼苗都种下去。一个方案是合法的当且仅当他满足上一段中叙述的要求。如果我们将花按照 $1,2,3,\\dots,m$ 编号，两种方案不同当且仅当被选择种花的位置不同或从左向右数花的编号序列不同。\n\n为了避免输出过大，答案对一个参数 $p$ 取模。", "inputFormat": "每个输入文件中有且仅有一组测试数据。\n\n测试数据只有一行四个整数，依次代表 $type,~n,~m,~p$，其中 $type$ 是一个帮助你判断测试点类型的参数，会在数据范围中说明。 ", "outputFormat": "输出一行一个整数，代表答案对 $p$ 取模的结果。\n", "hint": "#### 样例输入输出 1 解释\n一共有 $2$ 个樱花幼苗， $3$ 个种花的位置，如果给幼苗编号为 $1,~2$，位置编号为 $1,~2,~3$，那么两种方案分别如下：\n\n| 位置 | $1$ | $2$ | $3$ |\n| :---: | :---: | :---: | :---: |\n| 方案 1 | 幼苗 $1$ | 空 | 幼苗 $2$ |\n| 方案 2 | 幼苗 $2$ | 空 | 幼苗 $1$ |\n\n---\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 6 个子任务**。\n\n| 子任务编号 | $n \\leq$ | $m \\leq$ | $type=$ | 特殊性质 | 子任务分值 |\n| :----------: | :--------: | :----------: | :-------: | :--------: | :-----------: |\n| 1 | $1$ | $1$ | $0$ | 特殊性质 1 | $5$ |\n| 2 | $20$ | $20$ | $1$ | 特殊性质 1 | $15$ |\n| 3 | $400$ | $200$ | $2$ | 无 | $20$ |\n| 4 | $2000$ | $2000$ | $3$ | 无 | $20$ |\n| 5 | $2000000$ | $1000000$ | $4$| 特殊性质 2 | $20$ | \n| 6 | $2000000$ | $1000000$ | $5$| 无 | $20$ | \n\n特殊性质 1：保证对应测试点的**实际**方案数(在取模前)不超过 $10^6$\n\n特殊性质 2：保证 $p$ 是一个质数。\n\n对于 $100\\%$ 的数据，保证：\n- $1 \\leq n \\leq 2 \\times 10^6$。\n- $1 \\leq m \\leq 10^6 $。\n- $1 \\leq p \\leq 10^9$。\n- $1 \\leq m \\leq \\lceil\\frac{n}{2} \\rceil$。\n\n---\n\n#### 提示\n\n- 请使用合适的数据类型来进行运算，避免溢出。\n- 参数 $type$ 可以帮助你快速的判断子任务编号。\n", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2019] Qingyuan Sakura.", "background": "> Under the star river, all is firefly dust,  \n> I walk alone in the crowd while you wait, innocent.  \n> If meeting is borrowing colors from paintings,  \n> On Qingyuan, crimson sakura is like a sea.  \n>\n> — Yin Lin, \"Qingyuan Sakura\" (Cover: Renyi Daren).", "description": "Fusu really likes writing math problems while listening to ancient-style music, so this problem is actually an original question from *Wusan*.\n\nFusu wants to recreate the scenery of sakura blooming on Qingyuan, so he prepared many **pairwise distinct** sakura saplings and plans to plant them in a single row.\n\nIn this row, there are $n$ positions where sakura can be planted, and Fusu prepared $m$ saplings. Because sakura needs a lot of space on both sides when in full bloom, sakura cannot be planted next to each other. That is, between any two saplings, there must be at least one empty position where no flower is planted.\n\nPlanting in this way is not hard, but what Fusu is curious about is: how many valid plans are there to plant all $m$ saplings? A plan is valid if and only if it satisfies the requirement described in the previous paragraph. If we number the saplings as $1,2,3,\\dots,m$, then two plans are different if and only if the chosen planting positions are different, or the sequence of sapling numbers from left to right is different.\n\nTo avoid overly large output, take the answer modulo a parameter $p$.", "inputFormat": "Each input file contains exactly one set of testdata.\n\nThe testdata consists of one line with four integers, in order $type,~n,~m,~p$, where $type$ is a parameter that helps you determine the test point type, as described in the Constraints.", "outputFormat": "Output one line containing one integer, which is the answer modulo $p$.", "hint": "#### Explanation of Sample Input/Output 1\n\nThere are $2$ sakura saplings and $3$ planting positions. If the saplings are numbered $1,~2$ and the positions are numbered $1,~2,~3$, then the two plans are as follows:\n\n| Position | $1$ | $2$ | $3$ |\n| :---: | :---: | :---: | :---: |\n| Plan 1 | Sapling $1$ | Empty | Sapling $2$ |\n| Plan 2 | Sapling $2$ | Empty | Sapling $1$ |\n\n---\n\n#### Constraints and Agreements\n\n**This problem uses bundled testing with 6 subtasks in total**.\n\n| Subtask ID | $n \\leq$ | $m \\leq$ | $type=$ | Special Property | Subtask Score |\n| :----------: | :--------: | :----------: | :-------: | :--------: | :-----------: |\n| 1 | $1$ | $1$ | $0$ | Special Property 1 | $5$ |\n| 2 | $20$ | $20$ | $1$ | Special Property 1 | $15$ |\n| 3 | $400$ | $200$ | $2$ | None | $20$ |\n| 4 | $2000$ | $2000$ | $3$ | None | $20$ |\n| 5 | $2000000$ | $1000000$ | $4$ | Special Property 2 | $20$ |\n| 6 | $2000000$ | $1000000$ | $5$ | None | $20$ |\n\nSpecial Property 1: It is guaranteed that the **actual** number of plans for the corresponding test points (before taking modulo) does not exceed $10^6$.\n\nSpecial Property 2: It is guaranteed that $p$ is a prime.\n\nFor $100\\%$ of the data, it is guaranteed that:\n- $1 \\leq n \\leq 2 \\times 10^6$.\n- $1 \\leq m \\leq 10^6$.\n- $1 \\leq p \\leq 10^9$.\n- $1 \\leq m \\leq \\lceil\\frac{n}{2} \\rceil$.\n\n---\n\n#### Notes\n\n- Please use appropriate data types for computations to avoid overflow.\n- The parameter $type$ can help you quickly determine the subtask ID.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2019] 青原樱", "background": "> 星川之下皆萤火尘埃，  \n> 我独行在人潮你天真而待。  \n> 相遇若是借丹青着色，  \n> 青原上 绯樱如海。\n\n——银临《青原樱》(Cover 人衣大人)", "description": "扶苏是一个非常喜欢边听古风鸽边写数学题的人，因此这道题其实是个五三原题。\n\n扶苏希望重现青原上樱花盛开的景色，于是他准备了很多**互不相同**樱花树幼苗，准备种成一行。\n\n这一行中，一共有 $n$ 个位置可以种下樱花，而扶苏准备了 $m$ 支幼苗。由于樱花盛放时对左右空间需求非常大，所以樱花不能紧挨着种植，也就是任意两支幼苗之间必须至少存在一个不种花的空位置。\n\n按照这种方式种花并不难，但是令扶苏感到好奇的是一共有多少合法的方案让他把这 $m$ 支幼苗都种下去。一个方案是合法的当且仅当他满足上一段中叙述的要求。如果我们将花按照 $1,2,3,\\dots,m$ 编号，两种方案不同当且仅当被选择种花的位置不同或从左向右数花的编号序列不同。\n\n为了避免输出过大，答案对一个参数 $p$ 取模。", "inputFormat": "每个输入文件中有且仅有一组测试数据。\n\n测试数据只有一行四个整数，依次代表 $type,~n,~m,~p$，其中 $type$ 是一个帮助你判断测试点类型的参数，会在数据范围中说明。 ", "outputFormat": "输出一行一个整数，代表答案对 $p$ 取模的结果。\n", "hint": "#### 样例输入输出 1 解释\n一共有 $2$ 个樱花幼苗， $3$ 个种花的位置，如果给幼苗编号为 $1,~2$，位置编号为 $1,~2,~3$，那么两种方案分别如下：\n\n| 位置 | $1$ | $2$ | $3$ |\n| :---: | :---: | :---: | :---: |\n| 方案 1 | 幼苗 $1$ | 空 | 幼苗 $2$ |\n| 方案 2 | 幼苗 $2$ | 空 | 幼苗 $1$ |\n\n---\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 6 个子任务**。\n\n| 子任务编号 | $n \\leq$ | $m \\leq$ | $type=$ | 特殊性质 | 子任务分值 |\n| :----------: | :--------: | :----------: | :-------: | :--------: | :-----------: |\n| 1 | $1$ | $1$ | $0$ | 特殊性质 1 | $5$ |\n| 2 | $20$ | $20$ | $1$ | 特殊性质 1 | $15$ |\n| 3 | $400$ | $200$ | $2$ | 无 | $20$ |\n| 4 | $2000$ | $2000$ | $3$ | 无 | $20$ |\n| 5 | $2000000$ | $1000000$ | $4$| 特殊性质 2 | $20$ | \n| 6 | $2000000$ | $1000000$ | $5$| 无 | $20$ | \n\n特殊性质 1：保证对应测试点的**实际**方案数(在取模前)不超过 $10^6$\n\n特殊性质 2：保证 $p$ 是一个质数。\n\n对于 $100\\%$ 的数据，保证：\n- $1 \\leq n \\leq 2 \\times 10^6$。\n- $1 \\leq m \\leq 10^6 $。\n- $1 \\leq p \\leq 10^9$。\n- $1 \\leq m \\leq \\lceil\\frac{n}{2} \\rceil$。\n\n---\n\n#### 提示\n\n- 请使用合适的数据类型来进行运算，避免溢出。\n- 参数 $type$ 可以帮助你快速的判断子任务编号。\n", "locale": "zh-CN"}}}
{"pid": "P5521", "type": "P", "difficulty": 5, "samples": [["3 \n1 2 \n1 1 1", "2 2 1"], ["3\n1 1\n1 1 1", "3 1 1"], ["6\n1 1 2 3 4\n3 14 1 5 12 15", "21 20 13 20 12 15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2019", "O2优化", "排序", "深度优先搜索 DFS", "树形 DP"], "title": "[yLOI2019] 梅深不见冬", "background": "> 风，吹起梅岭的深冬；霜，如惊涛一样汹涌；  \n> 雪，飘落后把所有烧成空，像这场，捕捉不到的梦。   \n> 醒来时已是多年之久，宫门铜环才长了铁锈，也开始生出离愁。\n\n——银临《梅深不见冬》", "description": "扶苏从深冬的梅岭走出，来到了一棵有 $n$ 个节点的有根树上。\n\n如果你不知道什么是树，可以认为树是一个边数恰好比节点个数少一的简单无向连通图。\n\n如果我们规定 $x$ 是树 $T$ 的根，那么定义任意一个节点 $y$ 到根的路径就是从 $y$ 出发不重复经过节点到达 $x$ 所经过的所经过的点构成的点集。可以证明这样的点集有且仅有一个。\n\n定义一个节点 $u$ 是节点 $v$ 的孩子，当且仅当 $u$ 与 $v$ 相连且 $u$ 不在 $v$ 到根的路径中。如果 $u$ 是 $v$ 的孩子，那么定义 $v$ 是 $u$ 的家长节点。\n\n如果我是 @[\\_rqy](https://www.luogu.org/space/show?uid=7868) 那种~~毒瘤~~神仙的话，可能会问你每个节点的孩子数不超过 $k$ 的 $n$ 个节点的带标号无根树一共有多少个，可惜这个问题我也不会，所以我不会问你这么毒瘤的问题。\n\n扶苏从这棵 $n$ 个节点的树的 $1$ 号节点出发，沿着树上的边行走。当然我们规定 $1$ 号节点是这棵树的根。他所行走的规定是：当扶苏在节点 $u$ 时，扶苏要么在 $u$ 的孩子中选择一个**没有到达过**的节点 $v$ 并行走到 $v$，要么选择回到 $u$ 的家长节点。\n\n现在给每个节点一个权值 $w$，其中 $i$ 号节点的权值为 $w_i$。他想给这棵树的某个节点放上从梅岭带出的梅花。我们规定扶苏能在节点 $u$ 放上梅花当且仅当满足如下条件：\n\n> 扶苏当前在节点 $u$。\n>\n> 对于 $u$ 的所有孩子 $v$，节点 $v$ 被放上了 $w_v$ 朵梅花。\n\n同时，扶苏可以在**任意时刻**收回**任意节点**上的梅花，在收回梅花时不需要走到对应节点。\n\n现在扶苏想问问你，对于每个节点，如果他想在 $i$ 号节点上放 $w_i$ 朵梅花，那么他最少要从梅岭带出多少朵梅花。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n数据的第一行是一个整数 $n$ 代表树的节点个数。\n\n第二行有 $n-1$ 个用空格隔开的整数，第 $i$ 个整数 $p_i$ 代表第 $i+1$ 号节点的家长节点编号。\n\n第三行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表 $w_i$。", "outputFormat": "输出一行 $n$ 个用空格隔开的整数，第 $i$ 个整数代表想在 $i$ 号节点上放 $w_i$ 朵梅花需要准备的梅花个数。", "hint": "#### 输入输出样例 1 解释\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72286.png)\n\n样例 1 的输入如上图，每个节点都需要放一朵梅花。\n\n如果在 1 号节点放梅花，则从 1 号点运动到 2 号点，然后运动到 3 号点，在 3 号点上放一朵梅花，返回 2 号点，在 2 号点上放一朵梅花，同时收回 3 号点的梅花，然后返回 1 号点，将从 3 号点收回的梅花放到 1 号点即可。一共需要两朵梅花。\n\n在 2、3 号节点放梅花的方案类似。\n\n#### 输入输出样例 3 解释\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72287.png)\n\n样例 3 的输入如左图。\n\n先从 1 号节点运动至 3 号节点，再运动至 5 号节点，在 5 号节点上放置 $12$ 朵梅花，然后返回 3 号节点，在 3 号节点上放置 $1$ 朵梅花，收回五号节点的 $12$ 朵梅花，返回 1 号节点。\n\n然后运动到 2 号节点，通过 4 号节点运动到 6 号节点，放下 $15$ 朵梅花，返回 4 号节点放下 $5$ 朵梅花，此时树上有的梅花数为 $5 + 15 + 1 = 21$，分别在 4 号、6 号和 3 号节点上。然后收回 6 号节点的梅花，返回 2 号节点，放下 $14$ 朵梅花，收回 4 号节点的，返回 1 号节点，在 1 号节点上放置 $3$ 朵梅花，即可达到在 1 号节点上放梅花的目的。\n\n可以验证最小花费为 $21$。其他节点的答案同理。\n\n请注意，其他节点的答案不一定是按照该节点的运动路径行走得到的。\n\n---\n\n#### 数据规模与约定\n\n| 测试点编号 |  $n = $  | 测试点编号 |  $n = $  |\n| :--------: | :------: | :--------: | :------: |\n|     1      |   $1$    |     11     | $100003$ |\n|     2      |   $8$    |     12     | $100003$ |\n|     3      |   $8$    |     13     | $100003$ |\n|     4      |   $8$    |     14     | $100003$ |\n|     5      |   $8$    |     15     | $100004$ |\n|     6      | $100000$ |     16     | $100004$ |\n|     7      | $100000$ |     17     | $100004$ |\n|     8      | $100002$ |     18     | $100004$ |\n|     9      | $100002$ |     19     | $100004$ |\n|     10     | $100002$ |     20     | $100004$ |\n\n- 对于测试点 5、6，满足特殊性质：每个节点的孩子结点个数不超过 $2$。\n- 对于测试点 8 到测试点 10，满足特殊性质：每个节点的孩子节点个数不超过 $5$。\n- 对于测试点 11 到测试点 14，满足特殊性质：任意一个节点到根的路径上的点数不超过 $3$，也即树高不超过 $3$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5 + 4,~1 \\leq p_i \\leq i,~1 \\leq w_i \\leq 1000$。\n\n---\n\n#### 提示\n\n- $n$ 的末位数字可以帮助你快速的判断测试点所具有的的特殊性质。", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2019] Deep in the Plum Forest, Winter Is Nowhere to Be Seen", "background": "> The wind blows up the deep winter of Meiling; the frost surges like raging waves;  \n> The snow falls and burns everything into emptiness, like this dream that cannot be caught.  \n> When I wake up, many years have passed; the bronze rings on the palace gates have grown rusty, and sorrow begins to grow as well.  \n\n— Yin Lin, *Deep in the Plum Forest, Winter Is Nowhere to Be Seen*.", "description": "Fu Su walks out of the deep winter Meiling and arrives at a rooted tree with $n$ nodes.\n\nIf you do not know what a tree is, you may think of it as a simple undirected connected graph whose number of edges is exactly one less than the number of nodes.\n\nIf we specify that $x$ is the root of a tree $T$, then for any node $y$, the path from $y$ to the root is defined as the set of nodes passed through when starting from $y$ and reaching $x$ without visiting any node twice. It can be proven that such a set is unique.\n\nA node $u$ is a child of node $v$ if and only if $u$ is connected to $v$ and $u$ is not on the path from $v$ to the root. If $u$ is a child of $v$, then $v$ is the parent node of $u$.\n\nIf I were a ~~toxic~~ genius like @[\\_rqy](https://www.luogu.org/space/show?uid=7868), I might ask you how many labeled unrooted trees with $n$ nodes exist such that every node has at most $k$ children. Unfortunately I cannot solve that either, so I will not ask such a painful question.\n\nFu Su starts from node $1$ of this $n$-node tree and walks along the edges. We define node $1$ as the root of the tree. His movement rule is: when Fu Su is at node $u$, he either chooses a node $v$ among the children of $u$ that he has **not visited** and moves to $v$, or he chooses to return to the parent node of $u$.\n\nNow each node has a weight $w$, where the weight of node $i$ is $w_i$. He wants to place plum blossoms brought from Meiling onto some node of the tree. We say Fu Su can place plum blossoms on node $u$ if and only if the following conditions are satisfied:\n\n> Fu Su is currently at node $u$.\n>\n> For every child $v$ of $u$, node $v$ has been placed with $w_v$ plum blossoms.\n\nMeanwhile, Fu Su can take back the plum blossoms on **any node** at **any time**, and he does not need to walk to that node when taking them back.\n\nNow Fu Su asks you: for each node, if he wants to place $w_i$ plum blossoms on node $i$, what is the minimum number of plum blossoms he needs to bring out from Meiling?", "inputFormat": "Each input file contains one and only one set of testdata.\n\nThe first line contains an integer $n$, the number of nodes in the tree.\n\nThe second line contains $n - 1$ integers separated by spaces. The $i$-th integer $p_i$ denotes the index of the parent of node $i + 1$.\n\nThe third line contains $n$ integers separated by spaces. The $i$-th integer denotes $w_i$.", "outputFormat": "Output one line with $n$ integers separated by spaces. The $i$-th integer denotes the number of plum blossoms that need to be prepared to place $w_i$ plum blossoms on node $i$.", "hint": "#### Explanation for Sample Input/Output 1\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72286.png)\n\nThe input of Sample 1 is shown in the figure above. Every node needs to be placed with one plum blossom.\n\nIf we place plum blossoms on node $1$, we move from node $1$ to node $2$, then to node $3$, place one plum blossom on node $3$, return to node $2$, place one plum blossom on node $2$, and at the same time take back the plum blossom on node $3$. Then return to node $1$, and place the plum blossom taken back from node $3$ onto node $1$. In total, we need two plum blossoms.\n\nThe plans for placing plum blossoms on nodes $2$ and $3$ are similar.\n\n#### Explanation for Sample Input/Output 3\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72287.png)\n\nThe input of Sample 3 is shown in the left figure.\n\nFirst move from node $1$ to node $3$, then to node $5$, place $12$ plum blossoms on node $5$, then return to node $3$, place $1$ plum blossom on node $3$, take back the $12$ plum blossoms on node $5$, and return to node $1$.\n\nThen move to node $2$, and move through node $4$ to node $6$, place $15$ plum blossoms, return to node $4$ and place $5$ plum blossoms. At this moment, the number of plum blossoms on the tree is $5 + 15 + 1 = 21$, located at nodes $4$, $6$, and $3$. Then take back the plum blossoms on node $6$, return to node $2$, place $14$ plum blossoms, take back the blossoms on node $4$, return to node $1$, and place $3$ plum blossoms on node $1$, thus achieving the goal of placing plum blossoms on node $1$.\n\nIt can be verified that the minimum cost is $21$. The answers for other nodes are similar.\n\nPlease note that the answers for other nodes are not necessarily obtained by walking along the movement path of that node.\n\n---\n\n#### Constraints and Agreements\n\n| Test Point ID |  $n = $  | Test Point ID |  $n = $  |\n| :----------: | :------: | :----------: | :------: |\n|      1       |   $1$    |      11      | $100003$ |\n|      2       |   $8$    |      12      | $100003$ |\n|      3       |   $8$    |      13      | $100003$ |\n|      4       |   $8$    |      14      | $100003$ |\n|      5       |   $8$    |      15      | $100004$ |\n|      6       | $100000$ |      16      | $100004$ |\n|      7       | $100000$ |      17      | $100004$ |\n|      8       | $100002$ |      18      | $100004$ |\n|      9       | $100002$ |      19      | $100004$ |\n|      10      | $100002$ |      20      | $100004$ |\n\n- For test points 5 and 6, a special property holds: each node has at most $2$ child nodes.\n- For test points 8 to 10, a special property holds: each node has at most $5$ child nodes.\n- For test points 11 to 14, a special property holds: the number of nodes on the path from any node to the root is at most $3$, i.e. the height of the tree is at most $3$.\n- For $100\\%$ of the data, it is guaranteed that $1 \\leq n \\leq 10^5 + 4,~1 \\leq p_i \\leq i,~1 \\leq w_i \\leq 1000$.\n\n---\n\n#### Hint\n\n- The last digit of $n$ can help you quickly determine the special property of the test point.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2019] 梅深不见冬", "background": "> 风，吹起梅岭的深冬；霜，如惊涛一样汹涌；  \n> 雪，飘落后把所有烧成空，像这场，捕捉不到的梦。   \n> 醒来时已是多年之久，宫门铜环才长了铁锈，也开始生出离愁。\n\n——银临《梅深不见冬》", "description": "扶苏从深冬的梅岭走出，来到了一棵有 $n$ 个节点的有根树上。\n\n如果你不知道什么是树，可以认为树是一个边数恰好比节点个数少一的简单无向连通图。\n\n如果我们规定 $x$ 是树 $T$ 的根，那么定义任意一个节点 $y$ 到根的路径就是从 $y$ 出发不重复经过节点到达 $x$ 所经过的所经过的点构成的点集。可以证明这样的点集有且仅有一个。\n\n定义一个节点 $u$ 是节点 $v$ 的孩子，当且仅当 $u$ 与 $v$ 相连且 $u$ 不在 $v$ 到根的路径中。如果 $u$ 是 $v$ 的孩子，那么定义 $v$ 是 $u$ 的家长节点。\n\n如果我是 @[\\_rqy](https://www.luogu.org/space/show?uid=7868) 那种~~毒瘤~~神仙的话，可能会问你每个节点的孩子数不超过 $k$ 的 $n$ 个节点的带标号无根树一共有多少个，可惜这个问题我也不会，所以我不会问你这么毒瘤的问题。\n\n扶苏从这棵 $n$ 个节点的树的 $1$ 号节点出发，沿着树上的边行走。当然我们规定 $1$ 号节点是这棵树的根。他所行走的规定是：当扶苏在节点 $u$ 时，扶苏要么在 $u$ 的孩子中选择一个**没有到达过**的节点 $v$ 并行走到 $v$，要么选择回到 $u$ 的家长节点。\n\n现在给每个节点一个权值 $w$，其中 $i$ 号节点的权值为 $w_i$。他想给这棵树的某个节点放上从梅岭带出的梅花。我们规定扶苏能在节点 $u$ 放上梅花当且仅当满足如下条件：\n\n> 扶苏当前在节点 $u$。\n>\n> 对于 $u$ 的所有孩子 $v$，节点 $v$ 被放上了 $w_v$ 朵梅花。\n\n同时，扶苏可以在**任意时刻**收回**任意节点**上的梅花，在收回梅花时不需要走到对应节点。\n\n现在扶苏想问问你，对于每个节点，如果他想在 $i$ 号节点上放 $w_i$ 朵梅花，那么他最少要从梅岭带出多少朵梅花。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n数据的第一行是一个整数 $n$ 代表树的节点个数。\n\n第二行有 $n-1$ 个用空格隔开的整数，第 $i$ 个整数 $p_i$ 代表第 $i+1$ 号节点的家长节点编号。\n\n第三行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表 $w_i$。", "outputFormat": "输出一行 $n$ 个用空格隔开的整数，第 $i$ 个整数代表想在 $i$ 号节点上放 $w_i$ 朵梅花需要准备的梅花个数。", "hint": "#### 输入输出样例 1 解释\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72286.png)\n\n样例 1 的输入如上图，每个节点都需要放一朵梅花。\n\n如果在 1 号节点放梅花，则从 1 号点运动到 2 号点，然后运动到 3 号点，在 3 号点上放一朵梅花，返回 2 号点，在 2 号点上放一朵梅花，同时收回 3 号点的梅花，然后返回 1 号点，将从 3 号点收回的梅花放到 1 号点即可。一共需要两朵梅花。\n\n在 2、3 号节点放梅花的方案类似。\n\n#### 输入输出样例 3 解释\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72287.png)\n\n样例 3 的输入如左图。\n\n先从 1 号节点运动至 3 号节点，再运动至 5 号节点，在 5 号节点上放置 $12$ 朵梅花，然后返回 3 号节点，在 3 号节点上放置 $1$ 朵梅花，收回五号节点的 $12$ 朵梅花，返回 1 号节点。\n\n然后运动到 2 号节点，通过 4 号节点运动到 6 号节点，放下 $15$ 朵梅花，返回 4 号节点放下 $5$ 朵梅花，此时树上有的梅花数为 $5 + 15 + 1 = 21$，分别在 4 号、6 号和 3 号节点上。然后收回 6 号节点的梅花，返回 2 号节点，放下 $14$ 朵梅花，收回 4 号节点的，返回 1 号节点，在 1 号节点上放置 $3$ 朵梅花，即可达到在 1 号节点上放梅花的目的。\n\n可以验证最小花费为 $21$。其他节点的答案同理。\n\n请注意，其他节点的答案不一定是按照该节点的运动路径行走得到的。\n\n---\n\n#### 数据规模与约定\n\n| 测试点编号 |  $n = $  | 测试点编号 |  $n = $  |\n| :--------: | :------: | :--------: | :------: |\n|     1      |   $1$    |     11     | $100003$ |\n|     2      |   $8$    |     12     | $100003$ |\n|     3      |   $8$    |     13     | $100003$ |\n|     4      |   $8$    |     14     | $100003$ |\n|     5      |   $8$    |     15     | $100004$ |\n|     6      | $100000$ |     16     | $100004$ |\n|     7      | $100000$ |     17     | $100004$ |\n|     8      | $100002$ |     18     | $100004$ |\n|     9      | $100002$ |     19     | $100004$ |\n|     10     | $100002$ |     20     | $100004$ |\n\n- 对于测试点 5、6，满足特殊性质：每个节点的孩子结点个数不超过 $2$。\n- 对于测试点 8 到测试点 10，满足特殊性质：每个节点的孩子节点个数不超过 $5$。\n- 对于测试点 11 到测试点 14，满足特殊性质：任意一个节点到根的路径上的点数不超过 $3$，也即树高不超过 $3$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5 + 4,~1 \\leq p_i \\leq i,~1 \\leq w_i \\leq 1000$。\n\n---\n\n#### 提示\n\n- $n$ 的末位数字可以帮助你快速的判断测试点所具有的的特殊性质。", "locale": "zh-CN"}}}
{"pid": "P5522", "type": "P", "difficulty": 5, "samples": [["3 3 5\n010\n0?0\n1?0\n0 1 2\n0 2 3\n1 3 0??\n0 2 3\n0 1 3", "2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2019", "线段树", "树状数组", "O2优化", "位运算", "状压 DP"], "title": "[yLOI2019] 棠梨煎雪", "background": "> 岁岁花藻檐下共将棠梨煎雪，  \n> 自总角至你我某日辗转天边。  \n> 天淡天青，宿雨沾襟，  \n> 一年一会信笺却只见寥寥数言。\n\n——银临《棠梨煎雪》", "description": "扶苏正在听《棠梨煎雪》的时候，@[spitfirekindergarten](https://www.luogu.org/space/show?uid=61795) 发来一道 [IOI2018 集训队作业题](http://uoj.ac/problem/425)：我切了这集训队题，辣鸡扶苏快过来做题。扶苏定睛一看，这不 s\\* 题嘛，写了一发交上去才发现自己看错题目了。但是写完的代码不能浪费，于是就有了这道题。\n\n歌词中的主人公与她的朋友一年会有一次互相写信给对方，一共通信了 $m$ 年。为了简化问题，我们认为她们每封信的内容都是一条二进制码，并且所有二进制码的长度都是 $n$。即每封信的内容都是一个长度为 $n$ 的字符串，这个字符串只含字符 ``0`` 或 ``1``。\n\n这天她拿出了朋友写给她的所有信件，其中第 $i$ 年的写的信件编号为 $i$。由于信件保存时间过久，上面有一些字符已经模糊不清，我们将这样的位置记为 ``?``，``?`` 字符可以被解释为 ``0`` 或 ``1``。由于她的朋友也是人，符合人类的本质，所以朋友在一段连续的时间中书写的内容可能是相同的。现在她想问问你，对于一段连续的年份区间 $[l,r]$ 中的所有信件，假如朋友在这段时间展示了人类的本质，所写的是同一句话，那么这一句话一共有多少种可能的组成。也即一共有多少字符串 $S$，满足在这个区间内的所有信件的内容都可能是 $S$。\n\n一个长度为 $n$ 的只含 ``0,1,?`` 的字符串 $A$ 可能是一个字符串 $B$ 当且仅当 $B$ 满足如下条件：\n\n- $B$ 的长度也是 $n$ 。\n- $B$ 中只含字符 ``0,1``。\n- $A$ 中所有为 ``0`` 的位置在 $B$ 中也是 ``0``。\n- $A$ 中所有为 ``1`` 的位置在 $B$ 中也是 ``1``。\n- $A$ 中为 ``?`` 的位置在 $B$ 中可以为 ``0`` 也可以是 ``1``。\n\n同时她可能会突然发现看错了某年的信的内容，于是她可能会把某一年的信的内容修改为一个别的只含 ``0``,``1``,``?`` 的长度为 $n$ 的字符串。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n输入数据第一行为三个用空格隔开的整数，分别代表代表字符串长度 $n$，字符串个数 $m$ 和操作次数 $q$。\n\n下面 $m$ 行，每行是一个长度为 $n$ 的字符串，第 $(i + 1)$ 行的字符串 $s_i$ 代表第 $i$ 年信的内容。\n\n下面 $q$ 行，每行的第一个数字是操作编号 $opt$。\n\n- 如果 $opt=0$，那么后面接两个整数 $[l,~r]$，代表一次查询操作。\n- 如果 $opt=1$，那么后面接一个整数 $pos$，在一个空格后会有一个长度为 $n$ 的字符串 $t$，代表将第 $pos$ 个字符串修改为新的字符串 $t$。", "outputFormat": "为了避免输出过大，请你输出一行一个数代表所有查询的答案异或和对 $0$ 取异或的结果。", "hint": "### 样例 1 解释\n\n- 对于第一次询问，只有串 ``010`` 符合要求。\n- 对于第二次询问，由于第二个串的第一位为 ``0``，第三个串的第一位为 ``1``，故没有串符合要求。\n- 修改后将第三个串修改为 ``0??``。\n- 对于第四次询问，有两个串符合要求，分别为 ``000`` 和 ``010``。\n- 对于第五次询问，只有 ``010`` 符合要求。\n\n故答案为 $1,0,2,1$，他们的异或和再异或 $0$ 的值为 $2$。\n\n---\n\n### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 7 个子任务**。\n\n| 子任务编号 |  $m = $  |  $q = $   | $n = $ | 子任务分数 |\n| :--------: | :------: | :-------: | :----: | :--------: |\n|    $1$     |   $1$    |    $0$    |  $1$   |    $5$     |\n|    $2$     |  $102$   |   $102$   |  $10$  |    $10$    |\n|    $3$     |  $1003$  |  $1003$   |  $10$  |    $15$    |\n|    $4$     |  $1004$  |  $10004$  |  $30$  |    $15$    |\n|    $5$     | $100005$ | $500005$  |  $1$   |    $15$    |\n|    $6$     | $100006$ |  $50006$  |  $30$  |    $10$    |\n|    $7$     | $100007$ | $1000007$ |  $30$  |    $30$    |\n\n对于全部的测试点，保证：\n- $1 \\leq m \\leq 10^5 + 7$，$0 \\leq q \\leq 10^6 + 7$，$1 \\leq n \\leq 30$。\n- $0 \\leq opt \\leq 1$，$1 \\leq pos \\leq m$，$1 \\leq l \\leq r \\leq m$。\n- $s_i, t$ 的长度均为 $n$ 且只含有字符 `0`,`1`,`?`。\n- 输入字符串的总长度不超过 $5 \\times 10^6$。数据在 Linux 下生成，即换行符不含 `\\r`。\n\n---\n\n#### 提示\n\n- 请注意常数因子对程序效率造成的影响。\n- 请注意数据读入对程序效率造成的影响。\n- 请注意输入的问号为英文问号，即其 ASCII 值为 $63$。\n\n注: 为减少错误做法的通过率，时限于 2020 年 7 月由 2000ms 改为 1500ms。", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2019] Tangli Jianxue", "background": "> Year after year, under the eaves with flower patterns, we boil snow with tangli,  \n> From childhood to some day when you and I drift to the ends of the sky.  \n> The sky is pale, the sky is blue; the night rain wets my clothes,  \n> Once a year, the letters arrive, yet there are only a few words.\n\n— Yinlin, “Tangli Jianxue”.", "description": "While Fusu was listening to “Tangli Jianxue”, @[spitfirekindergarten](https://www.luogu.org/space/show?uid=61795) sent an [IOI2018 CTT homework problem](http://uoj.ac/problem/425): “I’ve solved this CTT problem, you trash Fusu, come and do it.” Fusu took a closer look—wasn’t this an s\\* problem? He coded and submitted it, only to find he had misread the statement. But the finished code could not be wasted, so this problem was created.\n\nThe protagonist in the lyrics and her friend write letters to each other once a year, for a total of $m$ years. To simplify the problem, we assume that the content of each letter is a binary code, and all binary codes have length $n$. That is, each letter is a string of length $n$ containing only characters `0` or `1`.\n\nOne day she took out all the letters her friend wrote to her. The letter written in year $i$ is numbered $i$. Because the letters have been kept for too long, some characters have become blurred. We mark such positions as `?`. A `?` character can be interpreted as `0` or `1`. Since her friend is also a human and thus follows human nature, the content written during a continuous period of time may be the same. Now she wants to ask you: for all letters in a continuous year interval $[l,r]$, assuming her friend showed “human nature” in this period and wrote the same sentence, how many possible sentences can that sentence be? In other words, how many strings $S$ are there such that every letter in this interval could have content $S$?\n\nA string $A$ of length $n$ containing only `0,1,?` could be a string $B$ if and only if $B$ satisfies:\n\n- The length of $B$ is also $n$.\n- $B$ contains only characters `0,1`.\n- Every position that is `0` in $A$ is also `0` in $B$.\n- Every position that is `1` in $A$ is also `1` in $B$.\n- Every position that is `?` in $A$ can be `0` or `1` in $B$.\n\nShe may also suddenly realize that she misread the content of some year’s letter, so she may modify the content of a certain year’s letter into another length-$n$ string containing only `0`,`1`,`?`.", "inputFormat": "Each input file contains exactly one test case.\n\nThe first line contains three integers separated by spaces, representing the string length $n$, the number of strings $m$, and the number of operations $q$.\n\nThe next $m$ lines each contain a string of length $n$. The string $s_i$ on line $(i + 1)$ represents the content of the letter in year $i$.\n\nThe next $q$ lines describe operations. The first number of each line is the operation code $opt$.\n\n- If $opt=0$, it is followed by two integers $[l,~r]$, representing a query operation.\n- If $opt=1$, it is followed by an integer $pos$, then after a space a string $t$ of length $n$, representing modifying the $pos$-th string to the new string $t$.", "outputFormat": "To avoid an excessively large output, output one line with one number: the XOR of the answers of all queries, and then XOR it with $0$.", "hint": "### Sample 1 Explanation\n\n- For the first query, only the string `010` satisfies the requirement.\n- For the second query, since the first bit of the second string is `0` and the first bit of the third string is `1`, no string satisfies the requirement.\n- After the modification, the third string becomes `0??`.\n- For the fourth query, there are two valid strings: `000` and `010`.\n- For the fifth query, only `010` is valid.\n\nTherefore the answers are $1,0,2,1$. Their XOR, and then XOR with $0$, equals $2$.\n\n---\n\n### Constraints\n\n**This problem uses bundled subtasks, with a total of 7 subtasks**.\n\n| Subtask ID |  $m = $  |  $q = $   | $n = $ | Subtask Score |\n| :--------: | :------: | :-------: | :----: | :-----------: |\n|    $1$     |   $1$    |    $0$    |  $1$   |      $5$      |\n|    $2$     |  $102$   |   $102$   |  $10$  |     $10$      |\n|    $3$     |  $1003$  |  $1003$   |  $10$  |     $15$      |\n|    $4$     |  $1004$  |  $10004$  |  $30$  |     $15$      |\n|    $5$     | $100005$ | $500005$  |  $1$   |     $15$      |\n|    $6$     | $100006$ |  $50006$  |  $30$  |     $10$      |\n|    $7$     | $100007$ | $1000007$ |  $30$  |     $30$      |\n\nFor all testdata, it is guaranteed that:\n\n- $1 \\leq m \\leq 10^5 + 7$, $0 \\leq q \\leq 10^6 + 7$, $1 \\leq n \\leq 30$.\n- $0 \\leq opt \\leq 1$, $1 \\leq pos \\leq m$, $1 \\leq l \\leq r \\leq m$.\n- The lengths of $s_i$ and $t$ are both $n$, and they contain only `0`,`1`,`?`.\n- The total length of input strings does not exceed $5 \\times 10^6$. The data is generated under Linux, so line breaks do not include `\\r`.\n\n---\n\n#### Hint\n\n- Please pay attention to the impact of constant factors on program efficiency.\n- Please pay attention to the impact of input reading on program efficiency.\n- Please note that the question mark in the input is the English question mark, whose ASCII value is $63$.\n\nNote: To reduce the acceptance rate of incorrect solutions, the time limit was changed from 2000 ms to 1500 ms in July 2020.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2019] 棠梨煎雪", "background": "> 岁岁花藻檐下共将棠梨煎雪，  \n> 自总角至你我某日辗转天边。  \n> 天淡天青，宿雨沾襟，  \n> 一年一会信笺却只见寥寥数言。\n\n——银临《棠梨煎雪》", "description": "扶苏正在听《棠梨煎雪》的时候，@[spitfirekindergarten](https://www.luogu.org/space/show?uid=61795) 发来一道 [IOI2018 集训队作业题](http://uoj.ac/problem/425)：我切了这集训队题，辣鸡扶苏快过来做题。扶苏定睛一看，这不 s\\* 题嘛，写了一发交上去才发现自己看错题目了。但是写完的代码不能浪费，于是就有了这道题。\n\n歌词中的主人公与她的朋友一年会有一次互相写信给对方，一共通信了 $m$ 年。为了简化问题，我们认为她们每封信的内容都是一条二进制码，并且所有二进制码的长度都是 $n$。即每封信的内容都是一个长度为 $n$ 的字符串，这个字符串只含字符 ``0`` 或 ``1``。\n\n这天她拿出了朋友写给她的所有信件，其中第 $i$ 年的写的信件编号为 $i$。由于信件保存时间过久，上面有一些字符已经模糊不清，我们将这样的位置记为 ``?``，``?`` 字符可以被解释为 ``0`` 或 ``1``。由于她的朋友也是人，符合人类的本质，所以朋友在一段连续的时间中书写的内容可能是相同的。现在她想问问你，对于一段连续的年份区间 $[l,r]$ 中的所有信件，假如朋友在这段时间展示了人类的本质，所写的是同一句话，那么这一句话一共有多少种可能的组成。也即一共有多少字符串 $S$，满足在这个区间内的所有信件的内容都可能是 $S$。\n\n一个长度为 $n$ 的只含 ``0,1,?`` 的字符串 $A$ 可能是一个字符串 $B$ 当且仅当 $B$ 满足如下条件：\n\n- $B$ 的长度也是 $n$ 。\n- $B$ 中只含字符 ``0,1``。\n- $A$ 中所有为 ``0`` 的位置在 $B$ 中也是 ``0``。\n- $A$ 中所有为 ``1`` 的位置在 $B$ 中也是 ``1``。\n- $A$ 中为 ``?`` 的位置在 $B$ 中可以为 ``0`` 也可以是 ``1``。\n\n同时她可能会突然发现看错了某年的信的内容，于是她可能会把某一年的信的内容修改为一个别的只含 ``0``,``1``,``?`` 的长度为 $n$ 的字符串。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n输入数据第一行为三个用空格隔开的整数，分别代表代表字符串长度 $n$，字符串个数 $m$ 和操作次数 $q$。\n\n下面 $m$ 行，每行是一个长度为 $n$ 的字符串，第 $(i + 1)$ 行的字符串 $s_i$ 代表第 $i$ 年信的内容。\n\n下面 $q$ 行，每行的第一个数字是操作编号 $opt$。\n\n- 如果 $opt=0$，那么后面接两个整数 $[l,~r]$，代表一次查询操作。\n- 如果 $opt=1$，那么后面接一个整数 $pos$，在一个空格后会有一个长度为 $n$ 的字符串 $t$，代表将第 $pos$ 个字符串修改为新的字符串 $t$。", "outputFormat": "为了避免输出过大，请你输出一行一个数代表所有查询的答案异或和对 $0$ 取异或的结果。", "hint": "### 样例 1 解释\n\n- 对于第一次询问，只有串 ``010`` 符合要求。\n- 对于第二次询问，由于第二个串的第一位为 ``0``，第三个串的第一位为 ``1``，故没有串符合要求。\n- 修改后将第三个串修改为 ``0??``。\n- 对于第四次询问，有两个串符合要求，分别为 ``000`` 和 ``010``。\n- 对于第五次询问，只有 ``010`` 符合要求。\n\n故答案为 $1,0,2,1$，他们的异或和再异或 $0$ 的值为 $2$。\n\n---\n\n### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 7 个子任务**。\n\n| 子任务编号 |  $m = $  |  $q = $   | $n = $ | 子任务分数 |\n| :--------: | :------: | :-------: | :----: | :--------: |\n|    $1$     |   $1$    |    $0$    |  $1$   |    $5$     |\n|    $2$     |  $102$   |   $102$   |  $10$  |    $10$    |\n|    $3$     |  $1003$  |  $1003$   |  $10$  |    $15$    |\n|    $4$     |  $1004$  |  $10004$  |  $30$  |    $15$    |\n|    $5$     | $100005$ | $500005$  |  $1$   |    $15$    |\n|    $6$     | $100006$ |  $50006$  |  $30$  |    $10$    |\n|    $7$     | $100007$ | $1000007$ |  $30$  |    $30$    |\n\n对于全部的测试点，保证：\n- $1 \\leq m \\leq 10^5 + 7$，$0 \\leq q \\leq 10^6 + 7$，$1 \\leq n \\leq 30$。\n- $0 \\leq opt \\leq 1$，$1 \\leq pos \\leq m$，$1 \\leq l \\leq r \\leq m$。\n- $s_i, t$ 的长度均为 $n$ 且只含有字符 `0`,`1`,`?`。\n- 输入字符串的总长度不超过 $5 \\times 10^6$。数据在 Linux 下生成，即换行符不含 `\\r`。\n\n---\n\n#### 提示\n\n- 请注意常数因子对程序效率造成的影响。\n- 请注意数据读入对程序效率造成的影响。\n- 请注意输入的问号为英文问号，即其 ASCII 值为 $63$。\n\n注: 为减少错误做法的通过率，时限于 2020 年 7 月由 2000ms 改为 1500ms。", "locale": "zh-CN"}}}
{"pid": "P5523", "type": "P", "difficulty": 6, "samples": [["6\n233 666 250 0", "0 0 0 0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "枚举", "位运算"], "title": "[yLOI2019] 珍珠", "background": "> 别叹息太多告别，至少相遇很真切。  \n> 摇曳着盛放枯竭，时间从未停歇。  \n> 天涯浪迹的白雪，念念不忘山川蝴蝶。  \n> 听说有人孤负黑夜，偏要点亮人间的月。\n\n——银临《珍珠》", "description": "扶苏给了你一个放珍珠的小匣子，这个匣子在左右两端都可以无限制的加入珍珠，珍珠在匣子里会排成一列，每次在左端加入珍珠，这个珍珠会被加入到这个珍珠序列的最左侧，在右端加入则会被加入到珍珠序列的最右侧。初始时，匣子是空的。\n\n这些珍珠要么是黑色的，要么是白色的，为了方便起见，我们将白色看作 $0$，黑色看作 $1$。\n\n在人鱼的世界中，定义颜色 $A$ **组合** 颜色 $B$ 为 $A\\operatorname{nand}B$，读作 $A$ 与非 $B$。\n\n定义 $A \\operatorname{nand} B = \\operatorname{not} (A \\operatorname{and}B)$ ，其中 $\\operatorname{and}$ 运算代表二进制与运算，$\\operatorname{not}$ 运算代表二进制非运算。\n\n定义位置 $x$ 到位置 $y$ 的组合和为：\n\n从 $x$ 开始向 $y$ ，第一个颜色组合第二个颜色的结果组合第三个颜色，得到的结果组合第四个颜色……一直组合到位置 $y$ 的颜色的结果。特别的，$x = y$ 时，组合和为该颜色。\n\n形式化的，设 $C_{x, y}$ 为序列 $A$ 从 $x$ 到 $y$ 的组合和，则\n$$C_{x, y} = \\begin{cases} C_{x, y - 1} \\operatorname{nand} A_y & x < y \\\\  C_{x, y + 1} \\operatorname{nand} A_y & x > y \\\\ A_x &x = y \\end{cases}$$\n\n例如，给定序列 $1, 1, 0, 0$，从 $2$ 到 $4$ 的组合和为 \n\n$$(1 \\operatorname{nand} 0) \\operatorname{nand} 0 = 1 \\operatorname{nand} 0 = 1$$\n\n从 $3$ 到 $1$ 的组合和为\n\n$$(0 \\operatorname{nand} 1) \\operatorname{nand} 1 = 1 \\operatorname{nand} 1 = 0$$\n\n从 $2$ 到 $2$ 的组合和为\n\n$$1$$\n\n扶苏会在匣子的两边加入一些珍珠，或者给定一个位置 $p$，询问你从左向右数第 $1$ 个位置到从左向右数第 $p$ 个位置的组合和，或者从右向左数第 $1$ 个位置到从右向左数第 $p$ 个位置的组合和。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n数据的第一行是一个整数 $n$，代表扶苏的操作个数。\n\n由于正常读入每个操作所需要的输入量过大，因此我们采用下面的生成器来生成每个操作。\n\n```cpp\n#include <cstdio>\n\nnamespace Maker {\n\ntypedef unsigned int uit;\n\nbool __sp;\nuit __x, __y, __z;\nint __type, __k, __m;\n\ntemplate <typename T>\ninline void qr(T &x) {\n  char ch = getchar(), lst = ' ';\n  while ((ch > '9') || (ch < '0')) lst = ch, ch = getchar();\n  while ((ch >= '0') && (ch <= '9')) x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();\n  if (lst == '-') x = -x;\n}\n\ntemplate <typename T>\ninline void Begin(const T &x) {\n  __type = x % 10;\n  qr(__x); qr(__y); qr(__z); qr(__m);\n  __sp = (__type == 3) || (__type == 4); __type &= 1;\n}\n\ninline uit __Next_Integer() {\n  __x ^= __y << (__z & 31);\n  __y ^= __z >> (__x & 31);\n  __z ^= __x << (__y & 31);\n  __x ^= __x >> 5; __y ^= __y << 13; __z ^= __z >> 6;\n  return __x;\n}\n\ninline uit Rand() { return __Next_Integer(); }\n\ntemplate <typename Tx, typename Ty, typename Tz>\ninline void Get_Nextline(Tx &x, Ty &y, Tz &z) {\n  if (__m) {\n    --__m;\n    x = 0; y = 0; z = 0;\n    qr(x); qr(y); qr(z);\n    if (x == 0) {\n      ++__k;\n    }\n  } else {\n    x = Rand() & 1; y = Rand() & 1;\n    if (__k == 0) { x = 0; }\n    if (x == 0) {\n      ++__k;\n      if (__sp) {\n        z = __type;\n      } else {\n        z = Rand() & 1;\n      }\n    } else {\n      int dk = __k >> 1;\n      if (dk == 0) {\n        z = 1;\n      } else {\n        z = Rand() % dk + dk;\n      }\n    }\n  }\n}\n\n}\n```\n\n对于 C/C++ 选手，我们提供了如上的数据生成代码（C 选手请使用 C++ 语言提交)，请将他们直接复制到你的代码中。\n\n对于非 C/C++ 选手，请你自行按照上面代码的内容，自行写出你所使用语言的对应生成器。\n\n下面的内容只针对 C++ 选手，请其他语言的选手自行按照对应语言的语法来完成代码。\n\n在读入 $n$ 这个数字以后，请你调用 ``Maker`` 命名空间中的 ``Begin`` 函数，函数的参数为 $n$。换句话说，你的代码中需要出现类似 ``Maker::Begin(n)`` 的语句。\n\n在调用完 ``Maker::Begin`` 函数以后，生成器就可以开始工作了。一共有 $n$ 次操作，每次操作时请你调用 ``Maker::Get_Nextline`` 函数，传入三个**整形**变量，(不妨设为 $x,y,z$)，每次函数调用结束以后，$x,y,z$ 的值都会被修改，作为每次操作的参数。具体含义如下：\n\n> 每次操作会有三个整数作为参数， 依次记为 $x,y,z$\n>\n> - 如果 $x = 0$，则代表这是一次插入操作；\n> - 如果 $x = 1$，则代表这是一次查询。\n> - 如果 $y = 0$，则代表插入操作是从左侧进行的，或者查询的位置是从左向右数的；\n> - 如果 $y = 1$，则代表插入操作是从右侧进行的，或者查询的位置是从右向左数的。\n> - 如果 $x = 0$，则 $z$ 是一个非零即一的整数，代表插入珍珠的颜色，$0$ 代表白色，$1$ 代表黑色；\n> - 如果 $x = 1$，则 $z$ 代表查询从第一个到第 $z$ 个位置的组合和。组合和的方向和位置的方向由参数 $y$ 决定。\n\n对于 C/C++ 选手，我们提供了模板程序([模板程序链接](https://www.luogu.org/paste/lk7wn4a1))，在这个程序中，已经做好了变量的读入和生成器的初始化，同时能够自动获取 $x,y,z$ 的值，你需要做的只是每次依照题意进行一个操作，最终输出答案。你可以自主选择是否使用这个模板，最终的评测得分与你的代码内容**无关**。\n\n**特别提醒：不建议使用 ``fread`` 等直接从输入中大量读取信息然后保存的函数对 $n$ 进行读入，如果你非要这么做，请你自行重写 ``Maker::Begin()`` 中的读入部分。**\n\n**从输入数据的第二行起，所有的数据都会被生成器自动读入（包括第二行），不需要你再行读入**。\n\n输入数据的第二行是四个整数 $a,b,c,m$，其中 $a,b,c$ 是生成器的参数，$m$ 为需要额外读入的操作数。\n\n为了在某种意义上避免因为生成的操作完全随机而产生的乱搞做法，我们将首先额外读入 $m$ 个给定的操作，然后再行随机。\n\n以下 $m$ 行，每行三个整数 $x,~y,~z$，代表一次操作。\n\n请特别注意，这 $m$ 次操作会被生成器**自动读入**。", "outputFormat": "为了避免输出过大，请输出一行四个用空格隔开的整数，分别代表所有的查询中：\n\n- 一共有多少次查询的结果为 $1$。\n- 一共有多少次查询的操作编号为奇数且查询结果为 $0$。\n- 一共有多少次查询的操作编号为偶数且查询结果为 $1$。\n- 一共有多少次查询的操作编号是 $1024$ 的倍数且查询结果为 $0$。\n\n定义第 $i$ 次操作的操作编号为 $i$。\n\n**注意，一次插入也算做一次操作**。", "hint": "#### 样例输入输出 1 解释\n\n第一次操作，$x=0,y=1,z=0$，在匣子右端插入一个 $0$，那么匣子里的珍珠序列为 $\\{0\\}$\n\n第二次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。\n\n第三次操作，$x = 0,y = 1,z = 1$，在匣子右端插入一个 $1$，匣子里的珍珠序列为 $\\{0,~1\\}$\n\n第四次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。\n\n第五次操作，$x = 0,y = 0,z = 0$，在匣子左侧插入一个 $0$，那么匣子里的珍珠序列为 $\\{0,~0,~1\\}$\n\n第六次操作，$x = 0,y = 1,z = 1$，在匣子右侧插入一个 $1$，那么匣子的珍珠序列为 $\\{0,~0,~1,~1\\}$\n\n没有任何一次查询的结果满足【输出格式】中提到的任意一种情况，于是输出 ``0 0 0 0``。\n\n---\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 $7$ 个子任务**。\n\n- Subtask 1（5 points）：$n = m = 0$。\n- Subtask 2（15 points）：$n = 1001$。\n- Subtask 3（15 points）：$n = 10^5 + 2$。\n- Subtask 4（10 points）：$n = 10^7 + 3$，对于所有 $x = 0$ 的操作，保证 $z = 1$。\n- Subtask 5（10 points）：$n = 10^7 + 4$，对于所有 $x = 0$ 的操作，保证 $z = 0$。\n- Subtask 6（15 points）：$n = 10^7 + 5$，$m = 0$。\n- Subtask 7（30 points）：$n = 10^7 + 6$。\n\n对于全部的测试点，保证 $0 \\leq n \\leq 10^7 + 6$，$0 \\leq m \\leq \\min(n, 10^6)$，$x, y \\in \\{0, 1\\}$，且对于所有 $x = 0$ 的操作，保证  $z \\in \\{0, 1\\}$，若设 $k$ 为在任一查询时匣子里的珍珠个数，则保证对于 $x = 1$ 的操作，$1 \\leq z \\leq k$，匣子为空时不会有查询操作。\n\n---\n\n#### 提示与说明\n\n- 请注意常数因子对程序效率造成的影响。\n- $n$ 的末位数字可以帮助你快速的判断测试点所属的子任务。\n- 由于涉及到非操作，与非运算可能不具备一些常见位运算的运算律，请格外注意。\n- std 使用 C++ 语言，保证时限是 std 用时的 1.5 倍以上，**但是不保证其他语言能够通过本题**。\n- 对于 C++ 选手，如果你直接复制上面的生成器，保证生成器运行总时间不超过 300ms。", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2019] Pearls", "background": "> Do not sigh too much for farewells; at least the meeting was real.  \n> Swaying between blooming and withering, time has never stopped.  \n> Snow drifting at the edge of the world, never forgetting mountains and butterflies.  \n> I heard someone let down the dark night, yet insisted on lighting the moon for the human world.\n>\n> — Yin Lin, “Pearls”.", "description": "Fusu gives you a small box for holding pearls. This box can add pearls without limit at both the left and right ends. Pearls in the box will line up into a sequence. Each time you add a pearl on the left end, it is inserted to the leftmost of the sequence; adding on the right end inserts it to the rightmost. Initially, the box is empty.\n\nEach pearl is either black or white. For convenience, we treat white as $0$ and black as $1$.\n\nIn the mermaid world, combining color $A$ with color $B$ is defined as $A\\operatorname{nand}B$, read as “$A$ NAND $B$”.\n\nDefine\n$A \\operatorname{nand} B = \\operatorname{not} (A \\operatorname{and}B)$,\nwhere $\\operatorname{and}$ is the binary AND operation and $\\operatorname{not}$ is the binary NOT operation.\n\nDefine the combined value from position $x$ to position $y$ as:\n\nStarting from $x$ towards $y$, combine the first color with the second color, then combine the result with the third color, then combine that result with the fourth color, and so on, until combining with the color at position $y$. In particular, when $x = y$, the combined value is just that color.\n\nFormally, let $C_{x, y}$ be the combined value of sequence $A$ from $x$ to $y$. Then\n$$C_{x, y} = \\begin{cases} C_{x, y - 1} \\operatorname{nand} A_y & x < y \\\\  C_{x, y + 1} \\operatorname{nand} A_y & x > y \\\\ A_x &x = y \\end{cases}$$\n\nFor example, given the sequence $1, 1, 0, 0$, the combined value from $2$ to $4$ is\n\n$$(1 \\operatorname{nand} 0) \\operatorname{nand} 0 = 1 \\operatorname{nand} 0 = 1$$\n\nThe combined value from $3$ to $1$ is\n\n$$(0 \\operatorname{nand} 1) \\operatorname{nand} 1 = 1 \\operatorname{nand} 1 = 0$$\n\nThe combined value from $2$ to $2$ is\n\n$$1$$\n\nFusu will add some pearls to both ends of the box, or give a position $p$ and ask you for the combined value from the $1$st position (counting left to right) to the $p$-th position (counting left to right), or from the $1$st position (counting right to left) to the $p$-th position (counting right to left).", "inputFormat": "Each input file contains exactly one set of testdata.\n\nThe first line contains an integer $n$, which is the number of operations performed by Fusu.\n\nSince reading each operation normally would require too much input, we use the following generator to generate each operation.\n\n```cpp\n#include <cstdio>\n\nnamespace Maker {\n\ntypedef unsigned int uit;\n\nbool __sp;\nuit __x, __y, __z;\nint __type, __k, __m;\n\ntemplate <typename T>\ninline void qr(T &x) {\n  char ch = getchar(), lst = ' ';\n  while ((ch > '9') || (ch < '0')) lst = ch, ch = getchar();\n  while ((ch >= '0') && (ch <= '9')) x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();\n  if (lst == '-') x = -x;\n}\n\ntemplate <typename T>\ninline void Begin(const T &x) {\n  __type = x % 10;\n  qr(__x); qr(__y); qr(__z); qr(__m);\n  __sp = (__type == 3) || (__type == 4); __type &= 1;\n}\n\ninline uit __Next_Integer() {\n  __x ^= __y << (__z & 31);\n  __y ^= __z >> (__x & 31);\n  __z ^= __x << (__y & 31);\n  __x ^= __x >> 5; __y ^= __y << 13; __z ^= __z >> 6;\n  return __x;\n}\n\ninline uit Rand() { return __Next_Integer(); }\n\ntemplate <typename Tx, typename Ty, typename Tz>\ninline void Get_Nextline(Tx &x, Ty &y, Tz &z) {\n  if (__m) {\n    --__m;\n    x = 0; y = 0; z = 0;\n    qr(x); qr(y); qr(z);\n    if (x == 0) {\n      ++__k;\n    }\n  } else {\n    x = Rand() & 1; y = Rand() & 1;\n    if (__k == 0) { x = 0; }\n    if (x == 0) {\n      ++__k;\n      if (__sp) {\n        z = __type;\n      } else {\n        z = Rand() & 1;\n      }\n    } else {\n      int dk = __k >> 1;\n      if (dk == 0) {\n        z = 1;\n      } else {\n        z = Rand() % dk + dk;\n      }\n    }\n  }\n}\n\n}\n```\n\nFor C/C++ users, we provide the generator code above (C users must submit in C++). Please copy it directly into your code.\n\nFor non-C/C++ users, please implement the corresponding generator in your own language according to the code above.\n\nThe following content is only for C++ users. Users of other languages should adapt it according to their language syntax.\n\nAfter reading $n$, you should call the `Begin` function in the `Maker` namespace, with parameter $n$. In other words, your code needs a statement like `Maker::Begin(n)`.\n\nAfter calling `Maker::Begin`, the generator starts working. There are $n$ operations. For each operation, call `Maker::Get_Nextline`, passing in three **integer** variables (say $x, y, z$). After each call, the values of $x, y, z$ will be modified and used as the parameters of the operation. The meanings are as follows:\n\n> Each operation has three integers as parameters, denoted $x, y, z$ in order.\n>\n> - If $x = 0$, this is an insertion operation.\n> - If $x = 1$, this is a query.\n> - If $y = 0$, the insertion is performed from the left side, or the query positions are counted from left to right.\n> - If $y = 1$, the insertion is performed from the right side, or the query positions are counted from right to left.\n> - If $x = 0$, then $z$ is an integer equal to $0$ or $1$, representing the color of the inserted pearl: $0$ means white and $1$ means black.\n> - If $x = 1$, then $z$ represents querying the combined value from the $1$st to the $z$-th position. The direction of combination and the direction of counting positions are determined by $y$.\n\nFor C/C++ users, we provide a template program ([template program link](https://www.luogu.org/paste/lk7wn4a1)). In this program, the input and generator initialization are already done, and it can automatically obtain $x, y, z$. You only need to perform one operation each time as required by the statement and finally output the answer. You may choose whether to use this template; your final score is **unrelated** to your code content.\n\n**Special reminder: it is not recommended to use functions like `fread` to read a large amount of input and then parse $n$. If you insist on doing so, please rewrite the input-reading part in `Maker::Begin()`.**\n\n**Starting from the second line of the input, all data will be automatically read by the generator (including the second line), and you do not need to read it manually.**\n\nThe second line of the input contains four integers $a, b, c, m$, where $a, b, c$ are parameters of the generator, and $m$ is the number of operations that need to be additionally read.\n\nTo, in some sense, avoid “messy” solutions caused by fully random operations, we will first additionally read $m$ given operations, and then generate random ones.\n\nIn the next $m$ lines, each line contains three integers $x,~y,~z$, representing one operation.\n\nPlease note that these $m$ operations will be **automatically read** by the generator.", "outputFormat": "To avoid overly large output, output one line with four integers separated by spaces, representing among all queries:\n\n- How many queries have result $1$.\n- How many queries have an odd operation index and result $0$.\n- How many queries have an even operation index and result $1$.\n- How many queries have an operation index that is a multiple of $1024$ and result $0$.\n\nDefine the operation index of the $i$-th operation as $i$.\n\n**Note that an insertion also counts as an operation.**", "hint": "#### Explanation of Sample Input/Output 1\n\nFor the first operation, $x = 0, y = 1, z = 0$. Insert a $0$ at the right end, so the pearl sequence in the box is $\\{0\\}$.\n\nFor the second operation, $x = 1, y = 0, z = 1$. Query the combined value from the first element to the first element counting from left to right. The answer is $0$.\n\nFor the third operation, $x = 0, y = 1, z = 1$. Insert a $1$ at the right end, so the sequence becomes $\\{0,~1\\}$.\n\nFor the fourth operation, $x = 1, y = 0, z = 1$. Query the combined value from the first element to the first element counting from left to right. The answer is $0$.\n\nFor the fifth operation, $x = 0, y = 0, z = 0$. Insert a $0$ at the left end, so the sequence becomes $\\{0,~0,~1\\}$.\n\nFor the sixth operation, $x = 0, y = 1, z = 1$. Insert a $1$ at the right end, so the sequence becomes $\\{0,~0,~1,~1\\}$.\n\nNo query result satisfies any of the cases mentioned in the “Output Format”, so the output is `0 0 0 0`.\n\n---\n\n#### Constraints and Conventions\n\n**This problem uses bundled subtasks, with a total of $7$ subtasks.**\n\n- Subtask 1 (5 points): $n = m = 0$.\n- Subtask 2 (15 points): $n = 1001$.\n- Subtask 3 (15 points): $n = 10^5 + 2$.\n- Subtask 4 (10 points): $n = 10^7 + 3$. For all operations with $x = 0$, it is guaranteed that $z = 1$.\n- Subtask 5 (10 points): $n = 10^7 + 4$. For all operations with $x = 0$, it is guaranteed that $z = 0$.\n- Subtask 6 (15 points): $n = 10^7 + 5$, $m = 0$.\n- Subtask 7 (30 points): $n = 10^7 + 6$.\n\nFor all test cases, it is guaranteed that $0 \\leq n \\leq 10^7 + 6$, $0 \\leq m \\leq \\min(n, 10^6)$, $x, y \\in \\{0, 1\\}$, and for all operations with $x = 0$, it is guaranteed that $z \\in \\{0, 1\\}$. Let $k$ be the number of pearls in the box at any query time; then for operations with $x = 1$, it is guaranteed that $1 \\leq z \\leq k$. There will be no query operation when the box is empty.\n\n---\n\n#### Notes and Additional Information\n\n- Please pay attention to the impact of constant factors on program efficiency.\n- The last digit of $n$ can help you quickly determine which subtask the test case belongs to.\n- Since NAND and NOT are involved, NAND may not satisfy some common bitwise operation laws. Please be especially careful.\n- `std` uses C++, and the time limit is guaranteed to be at least $1.5$ times the runtime of `std`, **but it is not guaranteed that other languages can pass this problem**.\n- For C++ users, if you copy the generator above directly, it is guaranteed that the total runtime of the generator does not exceed 300 ms.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2019] 珍珠", "background": "> 别叹息太多告别，至少相遇很真切。  \n> 摇曳着盛放枯竭，时间从未停歇。  \n> 天涯浪迹的白雪，念念不忘山川蝴蝶。  \n> 听说有人孤负黑夜，偏要点亮人间的月。\n\n——银临《珍珠》", "description": "扶苏给了你一个放珍珠的小匣子，这个匣子在左右两端都可以无限制的加入珍珠，珍珠在匣子里会排成一列，每次在左端加入珍珠，这个珍珠会被加入到这个珍珠序列的最左侧，在右端加入则会被加入到珍珠序列的最右侧。初始时，匣子是空的。\n\n这些珍珠要么是黑色的，要么是白色的，为了方便起见，我们将白色看作 $0$，黑色看作 $1$。\n\n在人鱼的世界中，定义颜色 $A$ **组合** 颜色 $B$ 为 $A\\operatorname{nand}B$，读作 $A$ 与非 $B$。\n\n定义 $A \\operatorname{nand} B = \\operatorname{not} (A \\operatorname{and}B)$ ，其中 $\\operatorname{and}$ 运算代表二进制与运算，$\\operatorname{not}$ 运算代表二进制非运算。\n\n定义位置 $x$ 到位置 $y$ 的组合和为：\n\n从 $x$ 开始向 $y$ ，第一个颜色组合第二个颜色的结果组合第三个颜色，得到的结果组合第四个颜色……一直组合到位置 $y$ 的颜色的结果。特别的，$x = y$ 时，组合和为该颜色。\n\n形式化的，设 $C_{x, y}$ 为序列 $A$ 从 $x$ 到 $y$ 的组合和，则\n$$C_{x, y} = \\begin{cases} C_{x, y - 1} \\operatorname{nand} A_y & x < y \\\\  C_{x, y + 1} \\operatorname{nand} A_y & x > y \\\\ A_x &x = y \\end{cases}$$\n\n例如，给定序列 $1, 1, 0, 0$，从 $2$ 到 $4$ 的组合和为 \n\n$$(1 \\operatorname{nand} 0) \\operatorname{nand} 0 = 1 \\operatorname{nand} 0 = 1$$\n\n从 $3$ 到 $1$ 的组合和为\n\n$$(0 \\operatorname{nand} 1) \\operatorname{nand} 1 = 1 \\operatorname{nand} 1 = 0$$\n\n从 $2$ 到 $2$ 的组合和为\n\n$$1$$\n\n扶苏会在匣子的两边加入一些珍珠，或者给定一个位置 $p$，询问你从左向右数第 $1$ 个位置到从左向右数第 $p$ 个位置的组合和，或者从右向左数第 $1$ 个位置到从右向左数第 $p$ 个位置的组合和。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n数据的第一行是一个整数 $n$，代表扶苏的操作个数。\n\n由于正常读入每个操作所需要的输入量过大，因此我们采用下面的生成器来生成每个操作。\n\n```cpp\n#include <cstdio>\n\nnamespace Maker {\n\ntypedef unsigned int uit;\n\nbool __sp;\nuit __x, __y, __z;\nint __type, __k, __m;\n\ntemplate <typename T>\ninline void qr(T &x) {\n  char ch = getchar(), lst = ' ';\n  while ((ch > '9') || (ch < '0')) lst = ch, ch = getchar();\n  while ((ch >= '0') && (ch <= '9')) x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();\n  if (lst == '-') x = -x;\n}\n\ntemplate <typename T>\ninline void Begin(const T &x) {\n  __type = x % 10;\n  qr(__x); qr(__y); qr(__z); qr(__m);\n  __sp = (__type == 3) || (__type == 4); __type &= 1;\n}\n\ninline uit __Next_Integer() {\n  __x ^= __y << (__z & 31);\n  __y ^= __z >> (__x & 31);\n  __z ^= __x << (__y & 31);\n  __x ^= __x >> 5; __y ^= __y << 13; __z ^= __z >> 6;\n  return __x;\n}\n\ninline uit Rand() { return __Next_Integer(); }\n\ntemplate <typename Tx, typename Ty, typename Tz>\ninline void Get_Nextline(Tx &x, Ty &y, Tz &z) {\n  if (__m) {\n    --__m;\n    x = 0; y = 0; z = 0;\n    qr(x); qr(y); qr(z);\n    if (x == 0) {\n      ++__k;\n    }\n  } else {\n    x = Rand() & 1; y = Rand() & 1;\n    if (__k == 0) { x = 0; }\n    if (x == 0) {\n      ++__k;\n      if (__sp) {\n        z = __type;\n      } else {\n        z = Rand() & 1;\n      }\n    } else {\n      int dk = __k >> 1;\n      if (dk == 0) {\n        z = 1;\n      } else {\n        z = Rand() % dk + dk;\n      }\n    }\n  }\n}\n\n}\n```\n\n对于 C/C++ 选手，我们提供了如上的数据生成代码（C 选手请使用 C++ 语言提交)，请将他们直接复制到你的代码中。\n\n对于非 C/C++ 选手，请你自行按照上面代码的内容，自行写出你所使用语言的对应生成器。\n\n下面的内容只针对 C++ 选手，请其他语言的选手自行按照对应语言的语法来完成代码。\n\n在读入 $n$ 这个数字以后，请你调用 ``Maker`` 命名空间中的 ``Begin`` 函数，函数的参数为 $n$。换句话说，你的代码中需要出现类似 ``Maker::Begin(n)`` 的语句。\n\n在调用完 ``Maker::Begin`` 函数以后，生成器就可以开始工作了。一共有 $n$ 次操作，每次操作时请你调用 ``Maker::Get_Nextline`` 函数，传入三个**整形**变量，(不妨设为 $x,y,z$)，每次函数调用结束以后，$x,y,z$ 的值都会被修改，作为每次操作的参数。具体含义如下：\n\n> 每次操作会有三个整数作为参数， 依次记为 $x,y,z$\n>\n> - 如果 $x = 0$，则代表这是一次插入操作；\n> - 如果 $x = 1$，则代表这是一次查询。\n> - 如果 $y = 0$，则代表插入操作是从左侧进行的，或者查询的位置是从左向右数的；\n> - 如果 $y = 1$，则代表插入操作是从右侧进行的，或者查询的位置是从右向左数的。\n> - 如果 $x = 0$，则 $z$ 是一个非零即一的整数，代表插入珍珠的颜色，$0$ 代表白色，$1$ 代表黑色；\n> - 如果 $x = 1$，则 $z$ 代表查询从第一个到第 $z$ 个位置的组合和。组合和的方向和位置的方向由参数 $y$ 决定。\n\n对于 C/C++ 选手，我们提供了模板程序([模板程序链接](https://www.luogu.org/paste/lk7wn4a1))，在这个程序中，已经做好了变量的读入和生成器的初始化，同时能够自动获取 $x,y,z$ 的值，你需要做的只是每次依照题意进行一个操作，最终输出答案。你可以自主选择是否使用这个模板，最终的评测得分与你的代码内容**无关**。\n\n**特别提醒：不建议使用 ``fread`` 等直接从输入中大量读取信息然后保存的函数对 $n$ 进行读入，如果你非要这么做，请你自行重写 ``Maker::Begin()`` 中的读入部分。**\n\n**从输入数据的第二行起，所有的数据都会被生成器自动读入（包括第二行），不需要你再行读入**。\n\n输入数据的第二行是四个整数 $a,b,c,m$，其中 $a,b,c$ 是生成器的参数，$m$ 为需要额外读入的操作数。\n\n为了在某种意义上避免因为生成的操作完全随机而产生的乱搞做法，我们将首先额外读入 $m$ 个给定的操作，然后再行随机。\n\n以下 $m$ 行，每行三个整数 $x,~y,~z$，代表一次操作。\n\n请特别注意，这 $m$ 次操作会被生成器**自动读入**。", "outputFormat": "为了避免输出过大，请输出一行四个用空格隔开的整数，分别代表所有的查询中：\n\n- 一共有多少次查询的结果为 $1$。\n- 一共有多少次查询的操作编号为奇数且查询结果为 $0$。\n- 一共有多少次查询的操作编号为偶数且查询结果为 $1$。\n- 一共有多少次查询的操作编号是 $1024$ 的倍数且查询结果为 $0$。\n\n定义第 $i$ 次操作的操作编号为 $i$。\n\n**注意，一次插入也算做一次操作**。", "hint": "#### 样例输入输出 1 解释\n\n第一次操作，$x=0,y=1,z=0$，在匣子右端插入一个 $0$，那么匣子里的珍珠序列为 $\\{0\\}$\n\n第二次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。\n\n第三次操作，$x = 0,y = 1,z = 1$，在匣子右端插入一个 $1$，匣子里的珍珠序列为 $\\{0,~1\\}$\n\n第四次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。\n\n第五次操作，$x = 0,y = 0,z = 0$，在匣子左侧插入一个 $0$，那么匣子里的珍珠序列为 $\\{0,~0,~1\\}$\n\n第六次操作，$x = 0,y = 1,z = 1$，在匣子右侧插入一个 $1$，那么匣子的珍珠序列为 $\\{0,~0,~1,~1\\}$\n\n没有任何一次查询的结果满足【输出格式】中提到的任意一种情况，于是输出 ``0 0 0 0``。\n\n---\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 $7$ 个子任务**。\n\n- Subtask 1（5 points）：$n = m = 0$。\n- Subtask 2（15 points）：$n = 1001$。\n- Subtask 3（15 points）：$n = 10^5 + 2$。\n- Subtask 4（10 points）：$n = 10^7 + 3$，对于所有 $x = 0$ 的操作，保证 $z = 1$。\n- Subtask 5（10 points）：$n = 10^7 + 4$，对于所有 $x = 0$ 的操作，保证 $z = 0$。\n- Subtask 6（15 points）：$n = 10^7 + 5$，$m = 0$。\n- Subtask 7（30 points）：$n = 10^7 + 6$。\n\n对于全部的测试点，保证 $0 \\leq n \\leq 10^7 + 6$，$0 \\leq m \\leq \\min(n, 10^6)$，$x, y \\in \\{0, 1\\}$，且对于所有 $x = 0$ 的操作，保证  $z \\in \\{0, 1\\}$，若设 $k$ 为在任一查询时匣子里的珍珠个数，则保证对于 $x = 1$ 的操作，$1 \\leq z \\leq k$，匣子为空时不会有查询操作。\n\n---\n\n#### 提示与说明\n\n- 请注意常数因子对程序效率造成的影响。\n- $n$ 的末位数字可以帮助你快速的判断测试点所属的子任务。\n- 由于涉及到非操作，与非运算可能不具备一些常见位运算的运算律，请格外注意。\n- std 使用 C++ 语言，保证时限是 std 用时的 1.5 倍以上，**但是不保证其他语言能够通过本题**。\n- 对于 C++ 选手，如果你直接复制上面的生成器，保证生成器运行总时间不超过 300ms。", "locale": "zh-CN"}}}
{"pid": "P5524", "type": "P", "difficulty": 6, "samples": [["5 10 6\n3 1\n3 5\n2 5 5 10\n3 1\n2 5 5 5\n3 5\n3 1\n1 1 5\n2 5 5 3\n3 5\n5 6\n3 6\n1 10\n2 8\n3 10\n7 8", "5\n5\n8\n5\n8\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "O2优化", "Ynoi"], "title": "[Ynoi2012] NOIP2015 充满了希望", "background": "", "description": "给一个长为 $n$ 的序列，有 $m$ 个操作，操作编号从 $1$ 到 $m$，每个操作为：\n\n`1 x y`：将序列位置为 $x,y$ 的两个元素交换。\n\n`2 l r x`：将序列区间 $[l,r]$ 内所有元素修改为 $x$。\n\n`3 x`：查询序列 $x$ 位置的值。\n\n现在有 $q$ 次查询，每次查询给出一个操作的区间 $[l,r]$：\n\n先将序列中的元素全部置为 $0$，之后依次进行从 $l$ 到 $r$ 的所有操作，求出所有这些操作中所有 $3$ 操作的答案的和。\n\n查询之间独立。", "inputFormat": "第一行三个数表示 $n,m,q$。\n\n之后 $m$ 行，每行 $2$ 到 $4$ 个数，依次表示每个操作。\n\n之后 $q$ 行，每行两个数 $l,r$，查询依次进行 $[l,r]$ 的所有操作，所有 $3$ 操作的答案的和。", "outputFormat": "对于每次查询，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477&ccz181078，Solution：nzhtl1477&ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $10\\%$ 的数据，满足 $1\\le n,m,q\\le 1000$。\n\n对于 $40\\%$ 的数据，满足 $1\\le n,m,q\\le 10^5$。\n\n对于另外 $20\\%$ 的数据，没有 $1$ 操作。\n\n对于另外 $20\\%$ 的数据，没有 $2$ 操作。\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m,q\\le 10^6$，$1\\le x\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2012] NOIP2015 充满了希望", "background": "", "description": "给一个长为 $n$ 的序列，有 $m$ 个操作，操作编号从 $1$ 到 $m$，每个操作为：\n\n`1 x y`：将序列位置为 $x,y$ 的两个元素交换。\n\n`2 l r x`：将序列区间 $[l,r]$ 内所有元素修改为 $x$。\n\n`3 x`：查询序列 $x$ 位置的值。\n\n现在有 $q$ 次查询，每次查询给出一个操作的区间 $[l,r]$：\n\n先将序列中的元素全部置为 $0$，之后依次进行从 $l$ 到 $r$ 的所有操作，求出所有这些操作中所有 $3$ 操作的答案的和。\n\n查询之间独立。", "inputFormat": "第一行三个数表示 $n,m,q$。\n\n之后 $m$ 行，每行 $2$ 到 $4$ 个数，依次表示每个操作。\n\n之后 $q$ 行，每行两个数 $l,r$，查询依次进行 $[l,r]$ 的所有操作，所有 $3$ 操作的答案的和。", "outputFormat": "对于每次查询，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477&ccz181078，Solution：nzhtl1477&ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $10\\%$ 的数据，满足 $1\\le n,m,q\\le 1000$。\n\n对于 $40\\%$ 的数据，满足 $1\\le n,m,q\\le 10^5$。\n\n对于另外 $20\\%$ 的数据，没有 $1$ 操作。\n\n对于另外 $20\\%$ 的数据，没有 $2$ 操作。\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m,q\\le 10^6$，$1\\le x\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5525", "type": "P", "difficulty": 6, "samples": [["1\n8\n1 10\n1 -10\n10 1\n8 -5\n-10 0\n8 6\n-4 8\n-6 8\n15\n2 -1 3\n8 -1 6\n-7 -10 2\n-10 -1 4\n7 10 10\n-1 -7 9\n-5 0 5\n-5 5 4\n10 -7 4\n-5 5 1\n2 1 6\n10 3 7\n-2 0 3\n-2 0 7\n-9 -6 6", "100000000110100"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "O2优化", "Ynoi"], "title": "[Ynoi2012] WC2016 充满了失望", "background": "", "description": "在平面直角坐标系中，\n\n给 $n$ 个点，这 $n$ 个点是可达的，如果点 $A,B$ 可达则线段 $AB$ 上的点均可达。\n\n给 $m$ 个圆，问有哪些圆满足圆内任意点都是可达的。", "inputFormat": "第一行一个整数 $T$，表示数据组数；\n\n接下来 $T$ 组数据，每组数据中：\n\n第一行一个整数 $n$，\n\n接下来 $n$ 行每行两个整数 $x_i,y_i$，表示点，\n\n接下来一行一个整数 $m$，\n\n接下来 $m$ 行每行三个整数 $X_i,Y_i,R_i$，表示圆。", "outputFormat": "每组数据输出一行，一个长度 $m$ 的 `01` 串，表示答案（`0` 表示圆内存在不可达的点，`1` 表示圆内所有点可达）", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n样例解释：\n\n红色的点为样例中给出的点，橙色的圆表示答案为 `1` 的询问，蓝色的圆表示答案为 `0` 的询问。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2hsha1je.png)\n\n$1\\leq n,m\\leq 5\\times 10^5$，$1\\leq R_i\\leq 10^6$，$-10^6\\leq x_i,y_i,X_i,Y_i\\leq 10^6$，$\\sum n\\leq 5\\times 10^5$，$\\sum \n m\\leq 5\\times 10^5$。\n\n保证当 $R_i$ 变化不超过 $1$ 时，答案不发生变化。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2012] WC2016 Full of Disappointment", "background": "", "description": "In the 2D Cartesian coordinate system,\n\nYou are given $n$ points. These $n$ points are reachable. If points $A, B$ are reachable, then all points on the segment $AB$ are also reachable.\n\nYou are given $m$ circles. Determine which circles satisfy that every point inside the circle is reachable.", "inputFormat": "The first line contains an integer $T$, which indicates the number of test cases.\n\nThen there are $T$ test cases. For each test case:\n\nThe first line contains an integer $n$.\n\nThe next $n$ lines each contain two integers $x_i, y_i$, representing a point.\n\nThe next line contains an integer $m$.\n\nThe next $m$ lines each contain three integers $X_i, Y_i, R_i$, representing a circle.", "outputFormat": "For each test case, output one line: a `01` string of length $m$, representing the answers (`0` means there exists an unreachable point inside the circle, `1` means all points inside the circle are reachable).", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078.\n\nSample explanation:\n\nThe red points are the points given in the sample. The orange circles indicate queries with answer `1`, and the blue circles indicate queries with answer `0`.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2hsha1je.png)\n\nConstraints: $1\\leq n,m\\leq 5\\times 10^5$, $1\\leq R_i\\leq 10^6$, $-10^6\\leq x_i,y_i,X_i,Y_i\\leq 10^6$, $\\sum n\\leq 5\\times 10^5$, $\\sum m\\leq 5\\times 10^5$.\n\nIt is guaranteed that when $R_i$ changes by no more than $1$, the answer does not change.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2012] WC2016 充满了失望", "background": "", "description": "在平面直角坐标系中，\n\n给 $n$ 个点，这 $n$ 个点是可达的，如果点 $A,B$ 可达则线段 $AB$ 上的点均可达。\n\n给 $m$ 个圆，问有哪些圆满足圆内任意点都是可达的。", "inputFormat": "第一行一个整数 $T$，表示数据组数；\n\n接下来 $T$ 组数据，每组数据中：\n\n第一行一个整数 $n$，\n\n接下来 $n$ 行每行两个整数 $x_i,y_i$，表示点，\n\n接下来一行一个整数 $m$，\n\n接下来 $m$ 行每行三个整数 $X_i,Y_i,R_i$，表示圆。", "outputFormat": "每组数据输出一行，一个长度 $m$ 的 `01` 串，表示答案（`0` 表示圆内存在不可达的点，`1` 表示圆内所有点可达）", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n样例解释：\n\n红色的点为样例中给出的点，橙色的圆表示答案为 `1` 的询问，蓝色的圆表示答案为 `0` 的询问。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2hsha1je.png)\n\n$1\\leq n,m\\leq 5\\times 10^5$，$1\\leq R_i\\leq 10^6$，$-10^6\\leq x_i,y_i,X_i,Y_i\\leq 10^6$，$\\sum n\\leq 5\\times 10^5$，$\\sum \n m\\leq 5\\times 10^5$。\n\n保证当 $R_i$ 变化不超过 $1$ 时，答案不发生变化。", "locale": "zh-CN"}}}
{"pid": "P5526", "type": "P", "difficulty": 7, "samples": [["5 3\n1 2 1 2 3\n1 2\n1 3\n3 4\n3 5\n3 3\n4 1\n4 3", "47\n51\n49\n45"], ["6 1\n1 1 1 1 1 1\n1 2\n2 3\n3 4\n4 5\n5 6\n1 2", "36\n46"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2012", "O2优化", "Ynoi"], "title": "[Ynoi2012] 惊惶的 SCOI2016", "background": "", "description": "给你一棵 $n$ 个节点的树，每个点有个颜色，有 $m$ 次修改，每次修改需要输出树上所有有向简单路径的颜色数的和。", "inputFormat": "第一行，输入两个整数 $n$ 和 $m$。\n\n第二行，输入 $n$ 个整数 $c_1,c_2,\\ldots,c_n$（$1\\leq c_i\\leq n$）。其中 $c_i$ 为 $i$ 节点的初始颜色。\n\n接下来 $n-1$ 行每行包括两个整数 $u,v$（$1\\leq u,v\\leq n$），这表示 $u$ 与 $v$ 之间有一条边。\n\n接着 $m$ 行每行包括两个整数 $u,x$（$1\\leq u,x\\leq n$）表示将节点 $u$ 的颜色修改为 $x$。", "outputFormat": "输出 $m+1$ 行，每行一个整数，为初始这个树上所有路径颜色数的和，以及每次修改后的这个值。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $2\\leq n\\leq 4\\times 10^5$，$1\\leq m\\leq 4\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2012] Panic SCOI2016", "background": "", "description": "You are given a tree with $n$ nodes. Each node has a color. There are $m$ modifications. For each modification, you need to output the sum, over all directed simple paths in the tree, of the number of distinct colors on the path.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThe second line contains $n$ integers $c_1,c_2,\\ldots,c_n$ ($1\\leq c_i\\leq n$), where $c_i$ is the initial color of node $i$.\n\nThe next $n-1$ lines each contain two integers $u,v$ ($1\\leq u,v\\leq n$), indicating that there is an edge between $u$ and $v$.\n\nThen follow $m$ lines, each containing two integers $u,x$ ($1\\leq u,x\\leq n$), meaning to change the color of node $u$ to $x$.", "outputFormat": "Output $m+1$ lines, each containing one integer: the sum of the number of colors over all paths in the tree for the initial tree, and the value after each modification.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477\n\nFor $100\\%$ of the testdata, $2\\leq n\\leq 4\\times 10^5$ and $1\\leq m\\leq 4\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2012] 惊惶的 SCOI2016", "background": "", "description": "给你一棵 $n$ 个节点的树，每个点有个颜色，有 $m$ 次修改，每次修改需要输出树上所有有向简单路径的颜色数的和。", "inputFormat": "第一行，输入两个整数 $n$ 和 $m$。\n\n第二行，输入 $n$ 个整数 $c_1,c_2,\\ldots,c_n$（$1\\leq c_i\\leq n$）。其中 $c_i$ 为 $i$ 节点的初始颜色。\n\n接下来 $n-1$ 行每行包括两个整数 $u,v$（$1\\leq u,v\\leq n$），这表示 $u$ 与 $v$ 之间有一条边。\n\n接着 $m$ 行每行包括两个整数 $u,x$（$1\\leq u,x\\leq n$）表示将节点 $u$ 的颜色修改为 $x$。", "outputFormat": "输出 $m+1$ 行，每行一个整数，为初始这个树上所有路径颜色数的和，以及每次修改后的这个值。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $2\\leq n\\leq 4\\times 10^5$，$1\\leq m\\leq 4\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5529", "type": "P", "difficulty": 7, "samples": [["10\n0 1 1 1 3 4 2 4 2 3\n16 20 29 16 23 6 29 21 1 22\n10\n3 4\n3 4\n2 6 20\n2 1 8\n2 2 8\n1 9 21\n3 6\n3 2\n1 3 11\n1 4 17\n", "16 2 2\n16 2 2\n20 1 1\n8 3 2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "平衡树", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2012] 梦断 SCOI2017", "background": "", "description": "有 $n$ 个学生构成了一棵有根树，每个学生有一个 $\\text{gpa}$。\n\n定义一个学生所在的**专业**为仅保留两端学生 $\\text{gpa}$ 相同的边时，这个学生所在的连通分量。\n\n定义一个专业的**怨气值**是 $max(dep[a]-dep[b]+1)$ $s.t$. $a,b$是专业中的学生，$dep_{根}=0$，$dep_{w}=dep_{w的父亲}+1$。\n\n操作 1 ：给出 $x$ 和 $y$，把学生 $x$ 的 $\\text{gpa}$ 改成 $y$。\n\n操作 2 ：给出 $x$ 和 $y$，把学生 $x$ 所在的专业中所有点 $\\text{gpa}$ 改为 $y$。\n\n操作 3 ：给出 $x$，问学生 $x$ 的 $\\text{gpa}$，$x$ 所在专业的人数，$x$所在专业的怨气值。", "inputFormat": "第一行一个数 $n$。\n\n第二行 $n$ 个数表示每个节点的父亲，其中第 $i$ 个数 $<i$，且 $1$ 节点的父亲为 $0$。\n\n第三行 $n$ 个数表示每个学生的 $\\text{gpa}$。\n\n第四行一个数 $m$。\n\n之后 $m$ 行，每行一个两或三个数表示一次操作，类型如上述。", "outputFormat": "对于每个 $3$ 操作，输出一行三个数，中间用空格隔开，依次表示：学生 $x$ 的 $\\text{gpa}$，$x$ 所在专业的人数，$x$ 所在专业的怨气值。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n定义 $\\text{gpa}$ 共有 $c$ 种。\n\n对于 $40\\%$ 的数据，$n,m \\le 1000$。\n\n对于另外 $40\\%$ 的数据，$n,m \\le 10^{5}$，$c=2$，$\\text{gpa}$ 的范围在 $[1,2]$ 中。\n\n对于 $100\\%$ 的数据，$n,m \\le 10^5$，$c=30$，$\\text{gpa}$ 的范围在 $[1,30]$ 中。\n\n我都懒得喷 THU 了。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2012] Dream Broken SCOI2017", "background": "", "description": "There are $n$ students forming a rooted tree, and each student has a $\\text{gpa}$.\n\nDefine a student’s **major** as the connected component that contains this student after keeping only the edges whose two endpoints have the same $\\text{gpa}$.\n\nDefine the **resentment value** of a major as $max(dep[a]-dep[b]+1)$ $s.t$. $a,b$ are students in the major, $dep_{root}=0$, and $dep_{w}=dep_{w's\\ father}+1$.\n\nOperation 1: given $x$ and $y$, change student $x$’s $\\text{gpa}$ to $y$.\n\nOperation 2: given $x$ and $y$, change the $\\text{gpa}$ of all nodes in the major containing student $x$ to $y$.\n\nOperation 3: given $x$, ask for student $x$’s $\\text{gpa}$, the number of students in the major containing $x$, and the resentment value of the major containing $x$.", "inputFormat": "The first line contains an integer $n$.\n\nThe second line contains $n$ integers representing the parent of each node. The $i$-th integer is $< i$, and the parent of node $1$ is $0$.\n\nThe third line contains $n$ integers representing each student’s $\\text{gpa}$.\n\nThe fourth line contains an integer $m$.\n\nThen follow $m$ lines. Each line contains two or three integers representing one operation, with types as described above.", "outputFormat": "For each operation of type $3$, output one line with three integers separated by spaces, in order: student $x$’s $\\text{gpa}$, the number of students in the major containing $x$, and the resentment value of the major containing $x$.", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078\n\nAssume there are a total of $c$ kinds of $\\text{gpa}$.\n\nFor $40\\%$ of the testdata, $n,m \\le 1000$.\n\nFor another $40\\%$ of the testdata, $n,m \\le 10^{5}$, $c=2$, and $\\text{gpa}$ is in $[1,2]$.\n\nFor $100\\%$ of the testdata, $n,m \\le 10^5$, $c=30$, and $\\text{gpa}$ is in $[1,30]$.\n\nI am too lazy to even complain about THU.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2012] 梦断 SCOI2017", "background": "", "description": "有 $n$ 个学生构成了一棵有根树，每个学生有一个 $\\text{gpa}$。\n\n定义一个学生所在的**专业**为仅保留两端学生 $\\text{gpa}$ 相同的边时，这个学生所在的连通分量。\n\n定义一个专业的**怨气值**是 $max(dep[a]-dep[b]+1)$ $s.t$. $a,b$是专业中的学生，$dep_{根}=0$，$dep_{w}=dep_{w的父亲}+1$。\n\n操作 1 ：给出 $x$ 和 $y$，把学生 $x$ 的 $\\text{gpa}$ 改成 $y$。\n\n操作 2 ：给出 $x$ 和 $y$，把学生 $x$ 所在的专业中所有点 $\\text{gpa}$ 改为 $y$。\n\n操作 3 ：给出 $x$，问学生 $x$ 的 $\\text{gpa}$，$x$ 所在专业的人数，$x$所在专业的怨气值。", "inputFormat": "第一行一个数 $n$。\n\n第二行 $n$ 个数表示每个节点的父亲，其中第 $i$ 个数 $<i$，且 $1$ 节点的父亲为 $0$。\n\n第三行 $n$ 个数表示每个学生的 $\\text{gpa}$。\n\n第四行一个数 $m$。\n\n之后 $m$ 行，每行一个两或三个数表示一次操作，类型如上述。", "outputFormat": "对于每个 $3$ 操作，输出一行三个数，中间用空格隔开，依次表示：学生 $x$ 的 $\\text{gpa}$，$x$ 所在专业的人数，$x$ 所在专业的怨气值。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n定义 $\\text{gpa}$ 共有 $c$ 种。\n\n对于 $40\\%$ 的数据，$n,m \\le 1000$。\n\n对于另外 $40\\%$ 的数据，$n,m \\le 10^{5}$，$c=2$，$\\text{gpa}$ 的范围在 $[1,2]$ 中。\n\n对于 $100\\%$ 的数据，$n,m \\le 10^5$，$c=30$，$\\text{gpa}$ 的范围在 $[1,30]$ 中。\n\n我都懒得喷 THU 了。", "locale": "zh-CN"}}}
{"pid": "P5530", "type": "P", "difficulty": 5, "samples": [["4 5 1 4\n2 1 2 1\n3 4 3 1\n2 3 1 2\n3 1 1 4\n2 4 2 4", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2002", "最短路", "BalticOI（波罗的海）"], "title": "[BalticOI 2002] 双调路径", "background": "", "description": "如今的道路收费发展很快。道路的密度越来越大，因此选择最佳路径是很现实的问题。城市的道路是双向的，每条道路有固定的旅行时间以及需要支付的费用。\n\n路径是连续经过的道路组成的。总时间是各条道路旅行时间的和，总费用是各条道路所支付费用的总和。一条路径越快，或者费用越低，该路径就越好。严格地说，如果一条路径比别的路径更快，而且不需要支付更多费用，它就比较好。反过来也如此理解。如果没有一条路径比某路径更好，则该路径被称为最小路径。\n\n这样的最小的路径有可能不止一条，或者根本不存在路径。\n\n问题：读入网络，计算最小路径的总数。费用时间都相同的两条最小路径只算作一条。你只要输出不同种类的最小路径数即可。", "inputFormat": "第一行有四个整数，城市总数 $n$，道路总数 $m$，起点和终点城市 $s,e$。\n$\\newline$\n接下来的 $m$ 行每行描述了一条道路的信息：两个端点 $p,r$，费用 $c$，以及时间 $t$；\n$\\newline$\n两个城市之间可能有多条路径连接。", "outputFormat": "输出一行一个数，表示最小路径的总数。", "hint": "**数据范围：**\n- $1\\leq{n}\\leq100$，$0\\leq{m}\\leq300$。\n- $1\\leq{s,e,p,r}\\leq{n}$，$0\\leq{c,t}\\leq100$。\n- $s\\neq{e}，p\\neq{r}$。\n\n**样例解释：**\n\n![样例输入](https://z3.ax1x.com/2021/09/24/4DN3xP.png)\n\n从 $1$ 到 $4$ 有 $4$ 条路径。为 $1\\rightarrow 2\\rightarrow 4$（费用为 $4$，时间为 $5$），$1\\rightarrow 3\\rightarrow 4$（费用为 $4$，时间为 $5$），$1\\rightarrow 2\\rightarrow 3\\rightarrow 4$（费用为 $6$，时间为 $4$），$1\\rightarrow 3\\rightarrow 2\\rightarrow 4$（费用为 $4$，时间为 $10$）。\n\n$1\\rightarrow 3\\rightarrow 4$ 和 $1\\rightarrow 2\\rightarrow 4$ 比 $1\\rightarrow 3\\rightarrow 2\\rightarrow 4$ 更好。有两种最佳路径：费用为 $4$，时间为 $5$（$1\\rightarrow 2\\rightarrow 4$ 和 $1\\rightarrow 3\\rightarrow 4$）和 费用为 $6$，时间为 $4$（$1\\rightarrow 2\\rightarrow 3\\rightarrow 4$）。", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2002] Bitonic Paths.", "background": "", "description": "Nowadays, road toll systems are developing fast. The density of roads is getting higher and higher, so choosing the best route is a very practical problem. The roads in a city are bidirectional. Each road has a fixed travel time and a fee that must be paid.\n\nA path is made up of consecutive roads. The total time is the sum of travel times of all roads on the path, and the total fee is the sum of fees paid on all roads on the path. A path is better if it is faster, or if it costs less. More strictly, if one path is faster than another path and does not require paying more, then it is better. The reverse can be understood in the same way. If no path is better than a given path, then this path is called a minimal path.\n\nSuch minimal paths may be more than one, or there may be no path at all.\n\nTask: given the network, compute the total number of minimal paths. Two minimal paths with the same fee and time are counted as one. You only need to output the number of different types of minimal paths.", "inputFormat": "The first line contains four integers: the number of cities $n$, the number of roads $m$, and the start and end cities $s, e$.\n$\\newline$\nThe next $m$ lines each describe one road: its two endpoints $p, r$, the fee $c$, and the time $t$.\n$\\newline$\nThere may be multiple roads connecting the same pair of cities.", "outputFormat": "Output one line with one integer, representing the total number of minimal paths.", "hint": "**Constraints:**\n- $1\\leq{n}\\leq100$, $0\\leq{m}\\leq300$.\n- $1\\leq{s,e,p,r}\\leq{n}$, $0\\leq{c,t}\\leq100$.\n- $s\\neq{e}$, $p\\neq{r}$.\n\n**Sample Explanation:**\n\n![Sample Input](https://z3.ax1x.com/2021/09/24/4DN3xP.png)\n\nThere are $4$ paths from $1$ to $4$: $1\\rightarrow 2\\rightarrow 4$ (fee $4$, time $5$), $1\\rightarrow 3\\rightarrow 4$ (fee $4$, time $5$), $1\\rightarrow 2\\rightarrow 3\\rightarrow 4$ (fee $6$, time $4$), and $1\\rightarrow 3\\rightarrow 2\\rightarrow 4$ (fee $4$, time $10$).\n\n$1\\rightarrow 3\\rightarrow 4$ and $1\\rightarrow 2\\rightarrow 4$ are better than $1\\rightarrow 3\\rightarrow 2\\rightarrow 4$. There are two types of best paths: fee $4$, time $5$ ($1\\rightarrow 2\\rightarrow 4$ and $1\\rightarrow 3\\rightarrow 4$), and fee $6$, time $4$ ($1\\rightarrow 2\\rightarrow 3\\rightarrow 4$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2002] 双调路径", "background": "", "description": "如今的道路收费发展很快。道路的密度越来越大，因此选择最佳路径是很现实的问题。城市的道路是双向的，每条道路有固定的旅行时间以及需要支付的费用。\n\n路径是连续经过的道路组成的。总时间是各条道路旅行时间的和，总费用是各条道路所支付费用的总和。一条路径越快，或者费用越低，该路径就越好。严格地说，如果一条路径比别的路径更快，而且不需要支付更多费用，它就比较好。反过来也如此理解。如果没有一条路径比某路径更好，则该路径被称为最小路径。\n\n这样的最小的路径有可能不止一条，或者根本不存在路径。\n\n问题：读入网络，计算最小路径的总数。费用时间都相同的两条最小路径只算作一条。你只要输出不同种类的最小路径数即可。", "inputFormat": "第一行有四个整数，城市总数 $n$，道路总数 $m$，起点和终点城市 $s,e$。\n$\\newline$\n接下来的 $m$ 行每行描述了一条道路的信息：两个端点 $p,r$，费用 $c$，以及时间 $t$；\n$\\newline$\n两个城市之间可能有多条路径连接。", "outputFormat": "输出一行一个数，表示最小路径的总数。", "hint": "**数据范围：**\n- $1\\leq{n}\\leq100$，$0\\leq{m}\\leq300$。\n- $1\\leq{s,e,p,r}\\leq{n}$，$0\\leq{c,t}\\leq100$。\n- $s\\neq{e}，p\\neq{r}$。\n\n**样例解释：**\n\n![样例输入](https://z3.ax1x.com/2021/09/24/4DN3xP.png)\n\n从 $1$ 到 $4$ 有 $4$ 条路径。为 $1\\rightarrow 2\\rightarrow 4$（费用为 $4$，时间为 $5$），$1\\rightarrow 3\\rightarrow 4$（费用为 $4$，时间为 $5$），$1\\rightarrow 2\\rightarrow 3\\rightarrow 4$（费用为 $6$，时间为 $4$），$1\\rightarrow 3\\rightarrow 2\\rightarrow 4$（费用为 $4$，时间为 $10$）。\n\n$1\\rightarrow 3\\rightarrow 4$ 和 $1\\rightarrow 2\\rightarrow 4$ 比 $1\\rightarrow 3\\rightarrow 2\\rightarrow 4$ 更好。有两种最佳路径：费用为 $4$，时间为 $5$（$1\\rightarrow 2\\rightarrow 4$ 和 $1\\rightarrow 3\\rightarrow 4$）和 费用为 $6$，时间为 $4$（$1\\rightarrow 2\\rightarrow 3\\rightarrow 4$）。", "locale": "zh-CN"}}}
{"pid": "P5531", "type": "P", "difficulty": 6, "samples": [["1 3\nJJD\n3 1\n", "0.667"], ["2 2\nJJ\nDD\n3 1\n", "0.000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "CCO（加拿大）"], "title": "[CCO 2019] Human Error", "background": "", "description": "Justin和Donald正在玩一种游戏：跳棋。你可能没有听说过，但是规则非常简单。\n\n棋盘是一个矩形网格，在最开始时，每一格上恰好有一个棋子，并且每名玩家在棋盘上最少拥有一枚棋子。Justin的棋子被标记为`J`，而Donald的被标记为`D`。\n\nJustin先下棋。在一次移动中，这位玩家可以移动自己的一枚棋子并吃掉相邻的一枚棋子 **（不一定是对手的）** ，随后轮到对手。如果当前玩家无法进行这样的操作，那么这位玩家就输了。\n\n棋子$A$与$B$是相邻的，当且仅当$A$正好在$B$的上/下/左/右一格。\n\n在理想的世界中，两人都是绝佳的逻辑学者，可以知晓每种棋盘上的最佳策略。然而这是不现实的。事实上，在游玩时，两人只会选择相对较好的走法。它到底有多好取决于Justin和Donald的误差常数，分别是$J$和$D$。\n\n形式化地，拥有误差常数$A$的玩家会从所有可能的走法中选择其中$A$种组成方案集合。如果所有可能的走法数$ P \\le A $，那么方案集合仅包含这$P$种。之后，这位玩家会随机（等概率）地挑选其中的一种并依此进行操作。\n\n两人在挑选方案组成集合时总会选择最优的方案，亦知晓对手也会选择最优方案。\n\n请问Justin获胜的概率是多少？", "inputFormat": "第一行两个正整数，$R C$（用空格隔开）。\n\n之后$R$行，每行$C$个字符，代表初始棋盘上的棋子分布（含义见题目描述）。\n\n之后一行两个正整数，$J D$（用空格隔开），含义见题目描述。", "outputFormat": "一行，一个精确到3位小数的浮点数，代表Justin获胜的概率。", "hint": "### 限制\n\n$ 1 \\le R \\times C \\le 13 $\n\n$ 1 \\le J,D \\le 13 $\n\n初始棋盘棋子分布只用`J`和`D`这两种字符表示。\n\n### 样例说明\n\n**样例1：**\n\nJustin拥有3种移动的可能性，移动后分别为：（用`_`表示空棋子）\n\n`_JD`（第一颗向右移），`J_J`（第二颗向右移），`J_D`（第二颗向左移）。\n\n对于情况1，Justin败。对于情况2和3，Justin胜。由于Justin的误差常数为3，他会选择所有的情况，故胜率为$\\frac{2}{3}$，取0.667。\n\n**样例2：**\n\nJustin拥有4种移动的可能性，移动后分别为：（用`_`表示空棋子）\n\n```\nJ_ _J J_ _J\nDD DD DJ JD\n```\n\n然而，无论Justin选择哪种，他都没有可能赢。\n\n之后Donald会选择最优的移动。他可以选择以下的方式击败对应的Justin：\n\n```\nD_ _D J_ _J\n_D D_ _D D_\n```\n\n故而Justin不可能赢。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2019] Human Error", "background": "", "description": "Justin and Donald are playing a game: checkers. You may not have heard of it, but the rules are very simple.\n\nThe board is a rectangular grid. At the beginning, each cell contains exactly one piece, and each player has at least one piece on the board. Justin’s pieces are marked `J`, and Donald’s are marked `D`.\n\nJustin moves first. In one move, the player may move one of their own pieces and capture one adjacent piece **(not necessarily the opponent’s)**, then it becomes the other player’s turn. If the current player cannot make such a move, then this player loses.\n\nPieces $A$ and $B$ are adjacent if and only if $A$ is exactly one cell above, below, left, or right of $B$.\n\nIn an ideal world, both players are perfect logicians and can know the best strategy for every board position. However, this is not realistic. In fact, while playing, they only choose relatively good moves. How good it is depends on Justin’s and Donald’s error constants, which are $J$ and $D$, respectively.\n\nFormally, a player with error constant $A$ will select a set of plans consisting of $A$ moves from all possible moves. If the number of all possible moves $P \\le A$, then the plan set contains only these $P$ moves. Then, the player randomly (with equal probability) picks one move from the set and makes that move.\n\nWhen choosing which moves form the set, both players always choose the optimal set, and they also know that the opponent will choose the optimal set.\n\nWhat is the probability that Justin wins?", "inputFormat": "The first line contains two positive integers $R C$ (separated by a space).\n\nThen there are $R$ lines, each containing $C$ characters, representing the initial distribution of pieces on the board (see the description for meanings).\n\nThen one line contains two positive integers $J D$ (separated by a space), with the meanings described above.", "outputFormat": "Output one line with a floating-point number rounded to 3 decimal places, representing the probability that Justin wins.", "hint": "### Constraints\n\n$ 1 \\le R \\times C \\le 13 $\n\n$ 1 \\le J,D \\le 13 $\n\nThe initial board distribution uses only the two characters `J` and `D`.\n\n### Sample Explanation\n\n**Sample 1:**\n\nJustin has 3 possible moves, and the resulting boards are (use `_` to represent an empty cell).\n\n`_JD` (move the first piece to the right), `J_J` (move the second piece to the right), `J_D` (move the second piece to the left).\n\nFor case 1, Justin loses. For cases 2 and 3, Justin wins. Since Justin’s error constant is 3, he will choose all cases, so the win rate is $\\frac{2}{3}$, which is $0.667$.\n\n**Sample 2:**\n\nJustin has 4 possible moves, and the resulting boards are (use `_` to represent an empty cell).\n\n```\nJ_ _J J_ _J\nDD DD DJ JD\n```\n\nHowever, no matter which one Justin chooses, he has no way to win.\n\nThen Donald will choose the optimal move. He can choose the following moves to defeat the corresponding Justin moves:\n\n```\nD_ _D J_ _J\n_D D_ _D D_\n```\n\nTherefore, Justin cannot win.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2019] Human Error", "background": "", "description": "Justin和Donald正在玩一种游戏：跳棋。你可能没有听说过，但是规则非常简单。\n\n棋盘是一个矩形网格，在最开始时，每一格上恰好有一个棋子，并且每名玩家在棋盘上最少拥有一枚棋子。Justin的棋子被标记为`J`，而Donald的被标记为`D`。\n\nJustin先下棋。在一次移动中，这位玩家可以移动自己的一枚棋子并吃掉相邻的一枚棋子 **（不一定是对手的）** ，随后轮到对手。如果当前玩家无法进行这样的操作，那么这位玩家就输了。\n\n棋子$A$与$B$是相邻的，当且仅当$A$正好在$B$的上/下/左/右一格。\n\n在理想的世界中，两人都是绝佳的逻辑学者，可以知晓每种棋盘上的最佳策略。然而这是不现实的。事实上，在游玩时，两人只会选择相对较好的走法。它到底有多好取决于Justin和Donald的误差常数，分别是$J$和$D$。\n\n形式化地，拥有误差常数$A$的玩家会从所有可能的走法中选择其中$A$种组成方案集合。如果所有可能的走法数$ P \\le A $，那么方案集合仅包含这$P$种。之后，这位玩家会随机（等概率）地挑选其中的一种并依此进行操作。\n\n两人在挑选方案组成集合时总会选择最优的方案，亦知晓对手也会选择最优方案。\n\n请问Justin获胜的概率是多少？", "inputFormat": "第一行两个正整数，$R C$（用空格隔开）。\n\n之后$R$行，每行$C$个字符，代表初始棋盘上的棋子分布（含义见题目描述）。\n\n之后一行两个正整数，$J D$（用空格隔开），含义见题目描述。", "outputFormat": "一行，一个精确到3位小数的浮点数，代表Justin获胜的概率。", "hint": "### 限制\n\n$ 1 \\le R \\times C \\le 13 $\n\n$ 1 \\le J,D \\le 13 $\n\n初始棋盘棋子分布只用`J`和`D`这两种字符表示。\n\n### 样例说明\n\n**样例1：**\n\nJustin拥有3种移动的可能性，移动后分别为：（用`_`表示空棋子）\n\n`_JD`（第一颗向右移），`J_J`（第二颗向右移），`J_D`（第二颗向左移）。\n\n对于情况1，Justin败。对于情况2和3，Justin胜。由于Justin的误差常数为3，他会选择所有的情况，故胜率为$\\frac{2}{3}$，取0.667。\n\n**样例2：**\n\nJustin拥有4种移动的可能性，移动后分别为：（用`_`表示空棋子）\n\n```\nJ_ _J J_ _J\nDD DD DJ JD\n```\n\n然而，无论Justin选择哪种，他都没有可能赢。\n\n之后Donald会选择最优的移动。他可以选择以下的方式击败对应的Justin：\n\n```\nD_ _D J_ _J\n_D D_ _D D_\n```\n\n故而Justin不可能赢。", "locale": "zh-CN"}}}
{"pid": "P5532", "type": "P", "difficulty": 6, "samples": [["5 4\n..#.\n##.#\n.##.\n#...\n#...\n", "....\n....\n###.\n###.\n#..#"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2019", "CCO（加拿大）", "图论建模", "最短路", "差分约束"], "title": "[CCO 2019] Sirtet", "background": "", "description": "在一款新型的无人游戏（话说这算游戏吗）Sirlet中，界面是一个矩形网格。在游戏开始之前，一些方格是空白的（表示为`.`），而一些方格是被填充的（表示为`#`）。那些被填充的方格代表一组物体，而相邻的被填充方格被视作同一物体。\n\n例如，这个初始网格：\n\n```\n..#.\n##.#\n.##.\n#...\n#...\n```\n\n包含以下4个物体：\n\n```\n##   #  #  #\n ##  #\n```\n\n当游戏开始时，每个物体开始以相同的速度匀速下落，它们持续下落，直到它接触到最下面的一行或是另一物体的顶部，而在接触时停止下落。\n\n求网格的最终状态。", "inputFormat": "第一行，两个正整数$N M$（用空格隔开）。\n\n随后$N$行，每行$M$个字符，代表网格。它们或是`#`，或是`.`，含义见题目描述。", "outputFormat": "$N$行，每行$M$个字符，代表网格的最终状态。它们或是`#`，或是`.`，含义见题目描述。", "hint": "### 限制\n\n$ 1 \\le N \\times M \\le 10^6 $\n\n### 子任务\n\nSubtask 1 （40分）：$ 1 \\le N \\times M \\le 2000 $\n\nSubtask 2 （24分）：$ M = 2 $\n\nSubtask 3 （36分）：没有附加限制。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2019] Sirtet", "background": "", "description": "In a new kind of unattended game (does this even count as a game) called Sirlet, the screen is a rectangular grid. Before the game starts, some cells are empty (shown as `.`), and some cells are filled (shown as `#`). The filled cells represent a set of objects, and adjacent filled cells are considered to be the same object.\n\nFor example, this initial grid:\n\n```\n..#.\n##.#\n.##.\n#...\n#...\n```\n\ncontains the following 4 objects:\n\n```\n##   #  #  #\n ##  #\n```\n\nWhen the game starts, each object begins to fall downward at the same constant speed. They keep falling until they touch the bottom row or the top of another object, and then stop falling at the moment of contact.\n\nFind the final state of the grid.", "inputFormat": "The first line contains two positive integers $N$ and $M$ (separated by a space).\n\nThe next $N$ lines each contain $M$ characters representing the grid. Each character is either `#` or `.`, with meanings as described above.", "outputFormat": "Output $N$ lines, each containing $M$ characters representing the final state of the grid. Each character is either `#` or `.`, with meanings as described above.", "hint": "### Constraints\n\n$ 1 \\le N \\times M \\le 10^6 $\n\n### Subtasks\n\nSubtask 1 (40 points): $ 1 \\le N \\times M \\le 2000 $\n\nSubtask 2 (24 points): $ M = 2 $\n\nSubtask 3 (36 points): No additional constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2019] Sirtet", "background": "", "description": "在一款新型的无人游戏（话说这算游戏吗）Sirlet中，界面是一个矩形网格。在游戏开始之前，一些方格是空白的（表示为`.`），而一些方格是被填充的（表示为`#`）。那些被填充的方格代表一组物体，而相邻的被填充方格被视作同一物体。\n\n例如，这个初始网格：\n\n```\n..#.\n##.#\n.##.\n#...\n#...\n```\n\n包含以下4个物体：\n\n```\n##   #  #  #\n ##  #\n```\n\n当游戏开始时，每个物体开始以相同的速度匀速下落，它们持续下落，直到它接触到最下面的一行或是另一物体的顶部，而在接触时停止下落。\n\n求网格的最终状态。", "inputFormat": "第一行，两个正整数$N M$（用空格隔开）。\n\n随后$N$行，每行$M$个字符，代表网格。它们或是`#`，或是`.`，含义见题目描述。", "outputFormat": "$N$行，每行$M$个字符，代表网格的最终状态。它们或是`#`，或是`.`，含义见题目描述。", "hint": "### 限制\n\n$ 1 \\le N \\times M \\le 10^6 $\n\n### 子任务\n\nSubtask 1 （40分）：$ 1 \\le N \\times M \\le 2000 $\n\nSubtask 2 （24分）：$ M = 2 $\n\nSubtask 3 （36分）：没有附加限制。", "locale": "zh-CN"}}}
{"pid": "P5533", "type": "P", "difficulty": 6, "samples": [["4\n3 3 4 1\n1 2 1", "67"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2019", "CCO（加拿大）"], "title": "[CCO 2019] Winter Driving", "background": "", "description": "在雪白帝国背部分布有$N$个城市，从$1$到$N$编号。对于一座城市$i$，有$A_i$位居民居住在其中。\n\n它们间分布有$N-1$条道路，从$2$到$N$编号。对于一条路$j$，它连接城市$j$和$P_j$，其中$P_j \\lt j$。任何城市最多被连接到36条路。\n\n在冬季，危险的驾驶条件使得政府执行交通管制，所有的路都变为单向高速公路，即对于一条路$j$，它要么成为从城市$j$到城市$P_j$的单向高速公路，要么成为从城市$P_j$到城市$j$的单向高速公路。\n\n此时，每个居民都想给其他所有公民寄假日贺卡。然而，如果要从城市$X$向城市$Y$发送一张假日贺卡，必须保证可以通过高速公路连接$X$和$Y$，或者$X=Y$。\n\n请求出，当所有的公路都被转换为单向高速公路后，最多可以被送出的贺卡总数。", "inputFormat": "第一行，一个正整数$N$。\n\n第二行，$N$个正整数$A_1$ ~ $A_N$。\n\n第三行，$N-1$个正整数$P_2$ ~ $P_N$。", "outputFormat": "一行，一个正整数，即最多可以被送出的贺卡总数。", "hint": "### 样例解释\n\n一种可能的做法是将：\n\n![avatar](https://s2.ax1x.com/2019/08/29/mq4eat.png)\n\n转化为：\n\n![avatar](https://s2.ax1x.com/2019/08/29/mq5jtx.png)\n\n此时，3号城的每个居民都可以往3号城寄3张卡片，往2号城寄3张，往1号城寄3张，往4号城寄1张。所以3号城共计可以发送40张。\n\n相似地，2号城共可寄18张，3号城共可寄9张，4号城一张也寄不了。\n\n所以答案为$40+18+9+0=67$。\n\n### 限制\n\n$2 \\le N \\le 200 000$\n\n对于任意合法$i$，$1 \\le A_i \\le 10 000$\n\n对于任意合法$j$，$1 \\le P_j \\le j$\n\n设$D$为任意一个城市连接的道路数量。$D \\le 36$。\n\n### 子任务\n\nSubtask 1（20分）：$N \\le 10$\n\nSubtask 2（20分）：$N \\le 1000$，$D \\le 10$\n\nSubtask 3（20分）：$D \\le 18$\n\nSubtask 4（20分）：$N=37$，且所有的道路均连向一个城市，亦即这个城市有36条连接的城市，且它们均只通过一条道路连向此城。\n\nSubtask 5（20分）：没有附加限制。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2019] Winter Driving", "background": "", "description": "There are $N$ cities in the Northern White Empire, numbered from $1$ to $N$. In city $i$, there are $A_i$ residents.\n\nThere are $N - 1$ roads, numbered from $2$ to $N$. Road $j$ connects city $j$ and city $P_j$, where $P_j \\lt j$. Each city is connected to at most 36 roads.\n\nIn winter, dangerous driving conditions cause the government to enforce traffic control, and all roads become one-way highways. That is, for each road $j$, it becomes either a one-way highway from city $j$ to city $P_j$, or a one-way highway from city $P_j$ to city $j$.\n\nNow, every resident wants to send holiday cards to all other citizens. However, to send a holiday card from city $X$ to city $Y$, it must be possible to travel from $X$ to $Y$ using the highways, or $X = Y$.\n\nFind the maximum total number of cards that can be delivered after all roads are converted into one-way highways.", "inputFormat": "The first line contains a positive integer $N$.\n\nThe second line contains $N$ positive integers $A_1$ to $A_N$.\n\nThe third line contains $N - 1$ positive integers $P_2$ to $P_N$.", "outputFormat": "One line containing a positive integer, the maximum total number of holiday cards that can be delivered.", "hint": "### Sample Explanation\n\nOne possible way is to convert:\n\n![avatar](https://s2.ax1x.com/2019/08/29/mq4eat.png)\n\ninto:\n\n![avatar](https://s2.ax1x.com/2019/08/29/mq5jtx.png)\n\nThen, each resident in city 3 can send 3 cards to city 3, 3 cards to city 2, 3 cards to city 1, and 1 card to city 4. So city 3 can send a total of 40 cards.\n\nSimilarly, city 2 can send 18 cards in total, city 1 can send 9 cards in total, and city 4 cannot send any cards.\n\nSo the answer is $40 + 18 + 9 + 0 = 67$.\n\n### Constraints\n\n$2 \\le N \\le 200\\,000$\n\nFor any valid $i$, $1 \\le A_i \\le 10\\,000$\n\nFor any valid $j$, $1 \\le P_j \\le j$\n\nLet $D$ be the number of roads connected to any city. $D \\le 36$.\n\n### Subtasks\n\nSubtask 1 (20 points): $N \\le 10$\n\nSubtask 2 (20 points): $N \\le 1000$, $D \\le 10$\n\nSubtask 3 (20 points): $D \\le 18$\n\nSubtask 4 (20 points): $N = 37$, and all roads connect to one city, i.e. this city has 36 connected cities, and each of those cities is connected to it by only one road.\n\nSubtask 5 (20 points): No additional constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2019] Winter Driving", "background": "", "description": "在雪白帝国背部分布有$N$个城市，从$1$到$N$编号。对于一座城市$i$，有$A_i$位居民居住在其中。\n\n它们间分布有$N-1$条道路，从$2$到$N$编号。对于一条路$j$，它连接城市$j$和$P_j$，其中$P_j \\lt j$。任何城市最多被连接到36条路。\n\n在冬季，危险的驾驶条件使得政府执行交通管制，所有的路都变为单向高速公路，即对于一条路$j$，它要么成为从城市$j$到城市$P_j$的单向高速公路，要么成为从城市$P_j$到城市$j$的单向高速公路。\n\n此时，每个居民都想给其他所有公民寄假日贺卡。然而，如果要从城市$X$向城市$Y$发送一张假日贺卡，必须保证可以通过高速公路连接$X$和$Y$，或者$X=Y$。\n\n请求出，当所有的公路都被转换为单向高速公路后，最多可以被送出的贺卡总数。", "inputFormat": "第一行，一个正整数$N$。\n\n第二行，$N$个正整数$A_1$ ~ $A_N$。\n\n第三行，$N-1$个正整数$P_2$ ~ $P_N$。", "outputFormat": "一行，一个正整数，即最多可以被送出的贺卡总数。", "hint": "### 样例解释\n\n一种可能的做法是将：\n\n![avatar](https://s2.ax1x.com/2019/08/29/mq4eat.png)\n\n转化为：\n\n![avatar](https://s2.ax1x.com/2019/08/29/mq5jtx.png)\n\n此时，3号城的每个居民都可以往3号城寄3张卡片，往2号城寄3张，往1号城寄3张，往4号城寄1张。所以3号城共计可以发送40张。\n\n相似地，2号城共可寄18张，3号城共可寄9张，4号城一张也寄不了。\n\n所以答案为$40+18+9+0=67$。\n\n### 限制\n\n$2 \\le N \\le 200 000$\n\n对于任意合法$i$，$1 \\le A_i \\le 10 000$\n\n对于任意合法$j$，$1 \\le P_j \\le j$\n\n设$D$为任意一个城市连接的道路数量。$D \\le 36$。\n\n### 子任务\n\nSubtask 1（20分）：$N \\le 10$\n\nSubtask 2（20分）：$N \\le 1000$，$D \\le 10$\n\nSubtask 3（20分）：$D \\le 18$\n\nSubtask 4（20分）：$N=37$，且所有的道路均连向一个城市，亦即这个城市有36条连接的城市，且它们均只通过一条道路连向此城。\n\nSubtask 5（20分）：没有附加限制。", "locale": "zh-CN"}}}
{"pid": "P5534", "type": "P", "difficulty": 1, "samples": [["1 2 3\n", "6\n"], ["-5 -10 5\n", "-75\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "数学", "O2优化"], "title": "【XR-3】等差数列", "background": "", "description": "小 X 给了你一个等差数列的前两项以及项数，请你求出这个等差数列各项之和。\n\n等差数列：对于一个 $n$ 项数列 $a$，如果满足对于任意 $i \\in [1,n)$，有 $a_{i+1} - a_i = d$，其中 $d$ 为定值，则称这个数列为一个等差数列。", "inputFormat": "一行 $3$ 个整数 $a_1, a_2, n$，表示等差数列的第 $1,2$ 项以及项数。\n\n**数据范围：**\n\n- $|a_1|,|a_2| \\le 10^6$。\n- $3 \\le n \\le 10^6$。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n这个等差数列为 `1 2 3`，其各项之和为 $6$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-3] Arithmetic Progression.", "background": "", "description": "Xiao X gives you the first two terms and the number of terms of an arithmetic progression. Please find the sum of all terms of this arithmetic progression.\n\nArithmetic progression: For an $n$-term sequence $a$, if for any $i \\in [1,n)$ it satisfies $a_{i+1} - a_i = d$, where $d$ is a constant, then this sequence is called an arithmetic progression.", "inputFormat": "One line with $3$ integers $a_1, a_2, n$, representing the 1st and 2nd terms of the arithmetic progression and the number of terms.\n\n**Constraints:**\n\n- $|a_1|,|a_2| \\le 10^6$.\n- $3 \\le n \\le 10^6$.", "outputFormat": "One line with one integer, representing the answer.", "hint": "**Sample $1$ Explanation**\n\nThis arithmetic progression is `1 2 3`, and the sum of its terms is $6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-3】等差数列", "background": "", "description": "小 X 给了你一个等差数列的前两项以及项数，请你求出这个等差数列各项之和。\n\n等差数列：对于一个 $n$ 项数列 $a$，如果满足对于任意 $i \\in [1,n)$，有 $a_{i+1} - a_i = d$，其中 $d$ 为定值，则称这个数列为一个等差数列。", "inputFormat": "一行 $3$ 个整数 $a_1, a_2, n$，表示等差数列的第 $1,2$ 项以及项数。\n\n**数据范围：**\n\n- $|a_1|,|a_2| \\le 10^6$。\n- $3 \\le n \\le 10^6$。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n这个等差数列为 `1 2 3`，其各项之和为 $6$。", "locale": "zh-CN"}}}
{"pid": "P5535", "type": "P", "difficulty": 3, "samples": [["3 1\n", "2\n"], ["6 4\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "O2优化", "素数判断,质数,筛法", "最大公约数 gcd"], "title": "【XR-3】小道消息", "background": "", "description": "小 X 想探究小道消息传播的速度有多快，于是他做了一个社会实验。\n\n有 $n$ 个人，其中第 $i$ 个人的衣服上有一个数 $i+1$。小 X 发现了一个规律：当一个衣服上的数为 $i$ 的人在某一天知道了一条信息，他会在第二天把这条信息告诉衣服上的数为 $j$ 的人，其中 $\\gcd(i,j)=1$（即 $i,j$ 的最大公约数为 $1$）。在第 $0$ 天，小 X 把一条小道消息告诉了第 $k$ 个人，小 X 想知道第几天时所有人都会知道这条小道消息。\n\n可以证明，一定存在所有人都知道了这条小道消息的那一天。\n\n提示：你可能需要用到的定理——[伯特兰-切比雪夫定理](https://baike.baidu.com/item/%E4%BC%AF%E7%89%B9%E5%85%B0-%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E5%AE%9A%E7%90%86/2053704)。", "inputFormat": "一行 $2$ 个正整数 $n,k$。\n\n**数据范围：**\n\n- $2 \\le n \\le 10^{14}$。\n- $1 \\le k \\le n$。", "outputFormat": "一行一个正整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n$3$ 个人的衣服上的数分别为 `2 3 4`。\n\n在第 $0$ 天，小 X 把一条小道消息告诉了第 $1$ 个人，他的衣服上的数为2。\n\n在第 $1$ 天，第 $1$ 个人会告诉第 $2$ 个人，因为 $\\gcd(2,3) = 1$，但他不会告诉第 $3$ 个人，因为 $\\gcd(2,4) = 2 \\ne 1$。\n\n在第 $2$ 天，第 $2$ 个人会告诉第 $3$ 个人，因为 $\\gcd(3,4) = 1$，这时所有人都知道了这条小道消息，因此答案为 $2$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-3] Rumors", "background": "", "description": "Xiao X wants to study how fast a rumor spreads, so he did a social experiment.\n\nThere are $n$ people. The number on person $i$'s clothes is $i+1$. Xiao X found a rule: if a person whose clothing number is $i$ learns a piece of information on some day, then on the next day he will tell this information to every person whose clothing number is $j$ such that $\\gcd(i,j)=1$ (that is, the greatest common divisor of $i$ and $j$ is $1$). On day $0$, Xiao X tells a rumor to the $k$-th person. Xiao X wants to know on which day everyone will know this rumor.\n\nIt can be proven that such a day when everyone knows the rumor must exist.\n\nHint: You may need the following theorem — [Bertrand–Chebyshev theorem](https://baike.baidu.com/item/%E4%BC%AF%E7%89%B9%E5%85%B0-%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E5%AE%9A%E7%90%86/2053704).", "inputFormat": "One line with $2$ positive integers $n,k$.\n\n**Constraints:**\n\n- $2 \\le n \\le 10^{14}$.\n- $1 \\le k \\le n$.", "outputFormat": "One line with one positive integer, the answer.", "hint": "**Explanation for Sample $1$**\n\nThe clothing numbers of the $3$ people are `2 3 4`.\n\nOn day $0$, Xiao X tells a rumor to person $1$, whose clothing number is $2$.\n\nOn day $1$, person $1$ will tell person $2$ because $\\gcd(2,3)=1$, but he will not tell person $3$ because $\\gcd(2,4)=2 \\ne 1$.\n\nOn day $2$, person $2$ will tell person $3$ because $\\gcd(3,4)=1$. Now everyone knows the rumor, so the answer is $2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-3】小道消息", "background": "", "description": "小 X 想探究小道消息传播的速度有多快，于是他做了一个社会实验。\n\n有 $n$ 个人，其中第 $i$ 个人的衣服上有一个数 $i+1$。小 X 发现了一个规律：当一个衣服上的数为 $i$ 的人在某一天知道了一条信息，他会在第二天把这条信息告诉衣服上的数为 $j$ 的人，其中 $\\gcd(i,j)=1$（即 $i,j$ 的最大公约数为 $1$）。在第 $0$ 天，小 X 把一条小道消息告诉了第 $k$ 个人，小 X 想知道第几天时所有人都会知道这条小道消息。\n\n可以证明，一定存在所有人都知道了这条小道消息的那一天。\n\n提示：你可能需要用到的定理——[伯特兰-切比雪夫定理](https://baike.baidu.com/item/%E4%BC%AF%E7%89%B9%E5%85%B0-%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E5%AE%9A%E7%90%86/2053704)。", "inputFormat": "一行 $2$ 个正整数 $n,k$。\n\n**数据范围：**\n\n- $2 \\le n \\le 10^{14}$。\n- $1 \\le k \\le n$。", "outputFormat": "一行一个正整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n$3$ 个人的衣服上的数分别为 `2 3 4`。\n\n在第 $0$ 天，小 X 把一条小道消息告诉了第 $1$ 个人，他的衣服上的数为2。\n\n在第 $1$ 天，第 $1$ 个人会告诉第 $2$ 个人，因为 $\\gcd(2,3) = 1$，但他不会告诉第 $3$ 个人，因为 $\\gcd(2,4) = 2 \\ne 1$。\n\n在第 $2$ 天，第 $2$ 个人会告诉第 $3$ 个人，因为 $\\gcd(3,4) = 1$，这时所有人都知道了这条小道消息，因此答案为 $2$。", "locale": "zh-CN"}}}
{"pid": "P5536", "type": "P", "difficulty": 4, "samples": [["6 3\n1 2\n2 3\n2 4\n1 5\n5 6\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "堆", "O2优化", "树的直径"], "title": "【XR-3】核心城市", "background": null, "description": "X 国有 $n$ 座城市，$n - 1$ 条长度为 $1$ 的道路，每条道路连接两座城市，且任意两座城市都能通过若干条道路相互到达，显然，城市和道路形成了一棵树。\n\nX 国国王决定将 $k$ 座城市钦定为 X 国的核心城市，其余城市为非核心城市。这 $k$ 座核心城市需满足以下两个条件：\n\n1. 这 $k$ 座城市可以通过道路，在不经过非核心城市的情况下两两相互到达。\n2. 定义某个非核心城市与这 $k$ 座核心城市的距离为，这座城市与 $k$ 座核心城市的距离的最小值。\n\n为了衡量交通状况，国王发明了交通拥堵度，它为所有非核心城市与核心城市的距离中的最大值。\n\n问题来了，如何安排核心城市才能使交通拥堵度最小呢？请输出满足条件的最小交通拥堵度。", "inputFormat": "第一行 $2$ 个正整数 $n,k$。\n\n接下来 $n - 1$ 行，每行 $2$ 个正整数 $u,v$，表示第 $u$ 座城市与第 $v$ 座城市之间有一条长度为 $1$ 的道路。\n\n**数据范围：**\n\n- $1 \\le k < n \\le 10 ^ 5$。\n- $1 \\le u,v \\le n, u \\ne v$，保证城市与道路形成一棵树。", "outputFormat": "一行一个整数，表示满足条件的最小交通拥堵度。", "hint": "【样例说明】\n\n钦定 $1,2,5$ 这 $3$ 座城市为核心城市，这样 $3,4,6$ 另外 $3$ 座非核心城市与核心城市的距离均为 $1$，因此答案为 $1$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-3] Core Cities", "background": "", "description": "Country X has $n$ cities and $n - 1$ roads of length $1$. Each road connects two cities, and any two cities can reach each other through some roads. Obviously, the cities and roads form a tree.\n\nThe king of Country X decides to designate $k$ cities as the core cities of Country X, and the remaining cities are non-core cities. These $k$ core cities must satisfy the following two conditions:\n\n1. These $k$ cities can reach each other pairwise via roads without passing through any non-core city.\n2. Define the distance from a non-core city to the $k$ core cities as the minimum value among its distances to the $k$ core cities.\n\nTo measure traffic conditions, the king invented the traffic congestion level, which is the maximum value among the distances from all non-core cities to the core cities.\n\nThe problem is: how should we choose the core cities to minimize the traffic congestion level? Output the minimum possible traffic congestion level that satisfies the conditions.", "inputFormat": "The first line contains $2$ positive integers $n, k$.\n\nThe next $n - 1$ lines each contain $2$ positive integers $u, v$, meaning there is a road of length $1$ between city $u$ and city $v$.\n\n**Constraints:**\n\n- $1 \\le k < n \\le 10 ^ 5$.\n- $1 \\le u, v \\le n, u \\ne v$, and it is guaranteed that the cities and roads form a tree.", "outputFormat": "One line with one integer, representing the minimum traffic congestion level that satisfies the conditions.", "hint": "[Sample Explanation]\n\nDesignate cities $1, 2, 5$ as the $3$ core cities. Then the distances from the other $3$ non-core cities $3, 4, 6$ to the core cities are all $1$, so the answer is $1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-3】核心城市", "background": null, "description": "X 国有 $n$ 座城市，$n - 1$ 条长度为 $1$ 的道路，每条道路连接两座城市，且任意两座城市都能通过若干条道路相互到达，显然，城市和道路形成了一棵树。\n\nX 国国王决定将 $k$ 座城市钦定为 X 国的核心城市，其余城市为非核心城市。这 $k$ 座核心城市需满足以下两个条件：\n\n1. 这 $k$ 座城市可以通过道路，在不经过非核心城市的情况下两两相互到达。\n2. 定义某个非核心城市与这 $k$ 座核心城市的距离为，这座城市与 $k$ 座核心城市的距离的最小值。\n\n为了衡量交通状况，国王发明了交通拥堵度，它为所有非核心城市与核心城市的距离中的最大值。\n\n问题来了，如何安排核心城市才能使交通拥堵度最小呢？请输出满足条件的最小交通拥堵度。", "inputFormat": "第一行 $2$ 个正整数 $n,k$。\n\n接下来 $n - 1$ 行，每行 $2$ 个正整数 $u,v$，表示第 $u$ 座城市与第 $v$ 座城市之间有一条长度为 $1$ 的道路。\n\n**数据范围：**\n\n- $1 \\le k < n \\le 10 ^ 5$。\n- $1 \\le u,v \\le n, u \\ne v$，保证城市与道路形成一棵树。", "outputFormat": "一行一个整数，表示满足条件的最小交通拥堵度。", "hint": "【样例说明】\n\n钦定 $1,2,5$ 这 $3$ 座城市为核心城市，这样 $3,4,6$ 另外 $3$ 座非核心城市与核心城市的距离均为 $1$，因此答案为 $1$。", "locale": "zh-CN"}}}
{"pid": "P5537", "type": "P", "difficulty": 6, "samples": [["6 6 10\n0 1 2 2 1 5\n1 2 2 1 2 1\n1 1 1 3\n1 5 2 6\n1 6 5 6\n1 2 3 5\n1 2 4 4\n2 2 1\n1 1 1 6\n1 1 2 4\n2 1 2\n1 1 1 5\n", "4\n5\n6\n4\n3\n3\n4\n6\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "线段树", "二分", "树状数组", "O2优化", "哈希 hashing"], "title": "【XR-3】系统设计", "background": "", "description": "小 X 需要你设计一个系统。\n\n这个系统首先需要输入一棵 $n$ 个点的有根树和一个长度为 $m$ 的序列 $a$，接下来需要实现 $q$ 个操作。\n\n操作分两种：\n\n1. `1 x l r` 表示设定起点为有根树的节点 $x$，接下来依次遍历 $l \\sim r$。当遍历到 $i$ 时，从当前节点走向它的编号第 $a_i$ 小的儿子。如果某一时刻当前节点的儿子个数小于 $a_i$，或者已经遍历完 $l \\sim r$，则在这个点停住，并输出这个点的编号，同时停止遍历。\n2. `2 t k` 表示将序列中第 $t$ 个数 $a_t$ 修改为 $k$。", "inputFormat": "第一行 $3$ 个正整数 $n,m,q$，分别表示树的点数、序列的长度和操作个数。\n\n第二行 $n$ 个整数 $f_{1 \\dots n}$，其中 $f_i$ 表示点 $i$ 在树中的父亲节点编号，特别地，设根节点为 $rt$，则 $f_{rt} = 0$。\n\n第三行 $m$ 个正整数 $a_{1 \\dots m}$，表示序列 $a$。\n\n接下来 $q$ 行，每行描述一个操作。\n\n**数据范围：**\n\n- $1 \\le n,m,q \\le 5 \\times 10 ^ 5$。\n- $1 \\le a_i \\le n$。\n- 对于操作 $1$，保证 $1 \\le x \\le n$，$1 \\le l \\le r \\le m$。\n- 对于操作 $2$，保证 $1 \\le t \\le m$，$1 \\le k \\le n$。", "outputFormat": "对于每个操作 $1$，一行一个正整数，表示答案。", "hint": "本题读入、输出量较大，请使用[读入、输出优化](https://oi-wiki.org/misc/io/)。\n\n【样例说明】\n\n第一个操作为 `1 1 1 3`，即 $1 \\rightarrow 2 \\rightarrow 4$，因此答案为 $4$。\n\n第九个操作后，序列变为 `2 1 2 1 2 1`。\n\n第十个操作为 `1 1 1 5`，即 $1 \\rightarrow 5 \\rightarrow 6$，因此答案为 $6$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-3] System Design", "background": "", "description": "Little X needs you to design a system.\n\nThis system first needs to read a rooted tree with $n$ nodes and a sequence $a$ of length $m$, and then process $q$ operations.\n\nThere are two types of operations:\n\n1. `1 x l r` means: set the starting point as node $x$ in the rooted tree, then traverse $l \\sim r$ in order. When traversing to $i$, move from the current node to its $a_i$-th smallest child (by node index). If at some moment the current node has fewer than $a_i$ children, or you have already finished traversing $l \\sim r$, then stop at this node, output its index, and stop traversing.\n2. `2 t k` means: modify the $t$-th number in the sequence, changing $a_t$ to $k$.", "inputFormat": "The first line contains $3$ positive integers $n, m, q$, representing the number of nodes in the tree, the length of the sequence, and the number of operations.\n\nThe second line contains $n$ integers $f_{1 \\dots n}$, where $f_i$ is the index of the parent of node $i$ in the tree. In particular, let the root be $rt$, then $f_{rt} = 0$.\n\nThe third line contains $m$ positive integers $a_{1 \\dots m}$, representing the sequence $a$.\n\nThen follow $q$ lines, each describing one operation.\n\n**Constraints:**\n\n- $1 \\le n, m, q \\le 5 \\times 10 ^ 5$.\n- $1 \\le a_i \\le n$.\n- For operation type $1$, it is guaranteed that $1 \\le x \\le n$, $1 \\le l \\le r \\le m$.\n- For operation type $2$, it is guaranteed that $1 \\le t \\le m$, $1 \\le k \\le n$.", "outputFormat": "For each operation of type $1$, output one positive integer per line, representing the answer.", "hint": "The input and output size of this problem is large. Please use [fast input/output](https://oi-wiki.org/misc/io/).\n\n**Sample Explanation**\n\nThe first operation is `1 1 1 3`, that is, $1 \\rightarrow 2 \\rightarrow 4$, so the answer is $4$.\n\nAfter the ninth operation, the sequence becomes `2 1 2 1 2 1`.\n\nThe tenth operation is `1 1 1 5`, that is, $1 \\rightarrow 5 \\rightarrow 6$, so the answer is $6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-3】系统设计", "background": "", "description": "小 X 需要你设计一个系统。\n\n这个系统首先需要输入一棵 $n$ 个点的有根树和一个长度为 $m$ 的序列 $a$，接下来需要实现 $q$ 个操作。\n\n操作分两种：\n\n1. `1 x l r` 表示设定起点为有根树的节点 $x$，接下来依次遍历 $l \\sim r$。当遍历到 $i$ 时，从当前节点走向它的编号第 $a_i$ 小的儿子。如果某一时刻当前节点的儿子个数小于 $a_i$，或者已经遍历完 $l \\sim r$，则在这个点停住，并输出这个点的编号，同时停止遍历。\n2. `2 t k` 表示将序列中第 $t$ 个数 $a_t$ 修改为 $k$。", "inputFormat": "第一行 $3$ 个正整数 $n,m,q$，分别表示树的点数、序列的长度和操作个数。\n\n第二行 $n$ 个整数 $f_{1 \\dots n}$，其中 $f_i$ 表示点 $i$ 在树中的父亲节点编号，特别地，设根节点为 $rt$，则 $f_{rt} = 0$。\n\n第三行 $m$ 个正整数 $a_{1 \\dots m}$，表示序列 $a$。\n\n接下来 $q$ 行，每行描述一个操作。\n\n**数据范围：**\n\n- $1 \\le n,m,q \\le 5 \\times 10 ^ 5$。\n- $1 \\le a_i \\le n$。\n- 对于操作 $1$，保证 $1 \\le x \\le n$，$1 \\le l \\le r \\le m$。\n- 对于操作 $2$，保证 $1 \\le t \\le m$，$1 \\le k \\le n$。", "outputFormat": "对于每个操作 $1$，一行一个正整数，表示答案。", "hint": "本题读入、输出量较大，请使用[读入、输出优化](https://oi-wiki.org/misc/io/)。\n\n【样例说明】\n\n第一个操作为 `1 1 1 3`，即 $1 \\rightarrow 2 \\rightarrow 4$，因此答案为 $4$。\n\n第九个操作后，序列变为 `2 1 2 1 2 1`。\n\n第十个操作为 `1 1 1 5`，即 $1 \\rightarrow 5 \\rightarrow 6$，因此答案为 $6$。", "locale": "zh-CN"}}}
{"pid": "P5538", "type": "P", "difficulty": 7, "samples": [["10\n15 50 89 9 38 73 38 23 6 52\n2 1\n3 2\n4 2\n5 3\n6 3\n7 5\n8 7\n9 1\n10 7\n", "54184\n"], ["20\n17 56 72 12 16 43 33 8 28 90 21 12 7 43 55 95 25 65 63 77\n2 1\n3 2\n4 1\n5 3\n6 5\n7 1\n8 7\n9 7\n10 3\n11 5\n12 7\n13 5\n14 7\n15 11\n16 6\n17 3\n18 15\n19 15\n20 13\n", "503636\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "O2优化", "树论", "位运算"], "title": "【XR-3】Namid[A]me", "background": "", "description": "小 X 给了你一棵 $n$ 个点的树，点有点权。\n\n你需要求出下列式子模 $786433$ 的值：\n\n$\\sum_{1\\leq u\\leq v\\leq n}f(u,v)^{f(u,v)}$\n\n其中 $f(u,v)$ 表示 $u$ 到 $v$ 的最短路径上所有点的点权按位与在一起之后的值。\n\n提示：为了方便你的计算，这里我们认为 $0^0=0$。另外，$786433$ 是一个质数，同时也是一个不常用的 NTT 模数，它的原根为 $10$，如果你不知道什么是 NTT 或者不知道什么是原根，你可以忽略这个提示。", "inputFormat": "第一行一个正整数 $n$，表示树的点数。\n\n第二行 $n$ 个正整数 $a_{1\\dots n}$，其中 $a_i$ 表示编号为 $i$ 的点的点权。\n\n接下来 $n-1$ 行，每行 $2$ 个正整数 $u,v$，表示编号为 $u$ 和编号为 $v$ 的点之间有一条边。\n\n**数据范围：**\n\n- $2 \\le n \\le 2 \\times 10^5$。\n- 对于所有满足 $1\\le i \\le n$ 的 $i$ 都有 $1 \\le a_i < 2^{30}$。\n- $1 \\le u,v \\le n, u \\ne v$。\n- 设 $d$ 为树中叶子（度数为 $1$ 的点）的个数，数据保证 $4\\le n \\cdot d \\le 3 \\times 10 ^ 6$。", "outputFormat": "一行一个整数，表示答案对 $786433$ 取模后的值。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[XR-3] Namid[A]me", "background": "", "description": "X gives you a tree with $n$ nodes, and each node has a weight.\n\nYou need to compute the value of the following expression modulo $786433$:\n\n$\\sum_{1\\leq u\\leq v\\leq n}f(u,v)^{f(u,v)}$\n\nHere, $f(u,v)$ is the value obtained by taking the bitwise AND of the weights of all nodes on the shortest path from $u$ to $v$.\n\nHint: To make calculation easier, we define $0^0=0$. Also, $786433$ is a prime number and an uncommon NTT modulus, whose primitive root is $10$. If you do not know what NTT is or what a primitive root is, you can ignore this hint.", "inputFormat": "The first line contains a positive integer $n$, the number of nodes in the tree.\n\nThe second line contains $n$ positive integers $a_{1\\dots n}$, where $a_i$ is the weight of node $i$.\n\nThe next $n-1$ lines each contain two positive integers $u,v$, meaning there is an edge between node $u$ and node $v$.\n\n**Constraints:**\n\n- $2 \\le n \\le 2 \\times 10^5$.\n- For all $i$ satisfying $1\\le i \\le n$, $1 \\le a_i < 2^{30}$.\n- $1 \\le u,v \\le n, u \\ne v$.\n- Let $d$ be the number of leaves in the tree (nodes with degree $1$). The testdata guarantees that $4\\le n \\cdot d \\le 3 \\times 10 ^ 6$.", "outputFormat": "Output one integer on one line, the answer modulo $786433$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-3】Namid[A]me", "background": "", "description": "小 X 给了你一棵 $n$ 个点的树，点有点权。\n\n你需要求出下列式子模 $786433$ 的值：\n\n$\\sum_{1\\leq u\\leq v\\leq n}f(u,v)^{f(u,v)}$\n\n其中 $f(u,v)$ 表示 $u$ 到 $v$ 的最短路径上所有点的点权按位与在一起之后的值。\n\n提示：为了方便你的计算，这里我们认为 $0^0=0$。另外，$786433$ 是一个质数，同时也是一个不常用的 NTT 模数，它的原根为 $10$，如果你不知道什么是 NTT 或者不知道什么是原根，你可以忽略这个提示。", "inputFormat": "第一行一个正整数 $n$，表示树的点数。\n\n第二行 $n$ 个正整数 $a_{1\\dots n}$，其中 $a_i$ 表示编号为 $i$ 的点的点权。\n\n接下来 $n-1$ 行，每行 $2$ 个正整数 $u,v$，表示编号为 $u$ 和编号为 $v$ 的点之间有一条边。\n\n**数据范围：**\n\n- $2 \\le n \\le 2 \\times 10^5$。\n- 对于所有满足 $1\\le i \\le n$ 的 $i$ 都有 $1 \\le a_i < 2^{30}$。\n- $1 \\le u,v \\le n, u \\ne v$。\n- 设 $d$ 为树中叶子（度数为 $1$ 的点）的个数，数据保证 $4\\le n \\cdot d \\le 3 \\times 10 ^ 6$。", "outputFormat": "一行一个整数，表示答案对 $786433$ 取模后的值。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5539", "type": "P", "difficulty": 5, "samples": [["10 3\n2 4 5\n", "1\n"], ["100000 6\n14 47 31 233 666 59\n", "91\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "枚举", "位运算"], "title": "【XR-3】Unknown Mother-Goose", "background": "", "description": "小 X 得到了一个正整数 $n$ 和一个正整数集合 $S$，他想知道有多少个正整数 $x$ 满足以下所有条件：\n\n- $3 \\le x \\le n$\n- 存在 $a \\in S, x \\equiv 0 \\pmod a$\n- 存在 $b \\in S,x-1 \\equiv 0 \\pmod b$\n- 存在 $c \\in S,x-2 \\equiv 0 \\pmod c$\n\n请你帮小 X 求出来。", "inputFormat": "第一行两个正整数 $n,|S|$，表示你得到的 $n$ 和正整数集合 $S$ 的大小。\n\n第二行 $|S|$ 个正整数，表示正整数集合 $S$ 中的元素。\n\n**数据范围：**\n\n- $3 \\le n \\le 10^9$。\n- $3 \\le |S| \\le 20$。\n- 保证 $S$ 中所有元素均小于 $n$，不保证所有元素互不相同。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n只有当 $x = 6$ 时：\n\n- $x \\equiv 0 \\pmod 2$\n- $x \\equiv 1 \\pmod 5$\n- $x \\equiv 2 \\pmod 4$\n\n满足条件。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-3] Unknown Mother-Goose", "background": "", "description": "Xiao X is given a positive integer $n$ and a set of positive integers $S$. He wants to know how many positive integers $x$ satisfy all of the following conditions:\n\n- $3 \\le x \\le n$\n- There exists $a \\in S$ such that $x \\equiv 0 \\pmod a$\n- There exists $b \\in S$ such that $x-1 \\equiv 0 \\pmod b$\n- There exists $c \\in S$ such that $x-2 \\equiv 0 \\pmod c$\n\nPlease help Xiao X compute the answer.", "inputFormat": "The first line contains two positive integers $n, |S|$, representing the given $n$ and the size of the set $S$.\n\nThe second line contains $|S|$ positive integers, representing the elements in the set $S$.\n\n**Constraints:**\n\n- $3 \\le n \\le 10^9$.\n- $3 \\le |S| \\le 20$.\n- All elements in $S$ are less than $n$. Elements are not guaranteed to be distinct.", "outputFormat": "Output one integer in a single line, representing the answer.", "hint": "[Sample $1$ Explanation]\n\nOnly when $x = 6$:\n\n- $x \\equiv 0 \\pmod 2$\n- $x \\equiv 1 \\pmod 5$\n- $x \\equiv 2 \\pmod 4$\n\ndo the conditions hold.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-3】Unknown Mother-Goose", "background": "", "description": "小 X 得到了一个正整数 $n$ 和一个正整数集合 $S$，他想知道有多少个正整数 $x$ 满足以下所有条件：\n\n- $3 \\le x \\le n$\n- 存在 $a \\in S, x \\equiv 0 \\pmod a$\n- 存在 $b \\in S,x-1 \\equiv 0 \\pmod b$\n- 存在 $c \\in S,x-2 \\equiv 0 \\pmod c$\n\n请你帮小 X 求出来。", "inputFormat": "第一行两个正整数 $n,|S|$，表示你得到的 $n$ 和正整数集合 $S$ 的大小。\n\n第二行 $|S|$ 个正整数，表示正整数集合 $S$ 中的元素。\n\n**数据范围：**\n\n- $3 \\le n \\le 10^9$。\n- $3 \\le |S| \\le 20$。\n- 保证 $S$ 中所有元素均小于 $n$，不保证所有元素互不相同。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n只有当 $x = 6$ 时：\n\n- $x \\equiv 0 \\pmod 2$\n- $x \\equiv 1 \\pmod 5$\n- $x \\equiv 2 \\pmod 4$\n\n满足条件。", "locale": "zh-CN"}}}
{"pid": "P5540", "type": "P", "difficulty": 7, "samples": [["4 5\n0 1 1 2\n0 2 2 3\n0 3 1 5\n1 3 3 4\n2 3 1 3", "3 10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["图论", "计算几何", "2011", "生成树", "BalkanOI（巴尔干半岛）"], "title": "[BalkanOI 2011] timeismoney", "background": "", "description": "给出一个 $n$ 个点 $m$ 条边的无向图，第 $i$ 条边有两个权值 $a_i$ 和 $b_i$ 。\n\n求该图的一棵生成树 $T$ ，使得\n\n$$\\left(\\sum_{e\\in T}a_e\\right)\\times\\left(\\sum_{e\\in T}b_e\\right)$$\n\n最小。", "inputFormat": "第一行两个正整数 $n,m$ 。\n\n下 $m$ 行，每行 $4$ 个整数 $u_i,v_i,a_i,b_i$ ，表示第 $i$ 条边连接  $u_i$ 和 $v_i$ ，权值为 $a_i$ 和 $b_i$ 。\n\n点的编号为 $0\\sim n-1$ 。", "outputFormat": "假设你求出的生成树为 $T$ ，你需要输出一行两个整数，分别为 $\\displaystyle\\sum_{e\\in T}a_e$ 和 $\\displaystyle\\sum_{e\\in T}b_e$ 。\n\n如果有多解，请输出 $\\displaystyle\\sum_{e\\in T}a_e$ 最小的那个。", "hint": "对于 $100\\%$ 的数据，$1\\leq n\\leq 200,1\\leq m\\leq 10000,0\\leq a_i,b_i\\leq 255$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[BalkanOI 2011] timeismoney", "background": "", "description": "Given an undirected graph with $n$ vertices and $m$ edges, the $i$-th edge has two weights $a_i$ and $b_i$.\n\nFind a spanning tree $T$ of this graph such that\n\n$$\\left(\\sum_{e\\in T}a_e\\right)\\times\\left(\\sum_{e\\in T}b_e\\right)$$\n\nis minimized.", "inputFormat": "The first line contains two positive integers $n,m$.\n\nThe next $m$ lines each contain $4$ integers $u_i,v_i,a_i,b_i$, meaning that the $i$-th edge connects $u_i$ and $v_i$, with weights $a_i$ and $b_i$.\n\nThe vertices are numbered from $0$ to $n-1$.", "outputFormat": "Suppose the spanning tree you found is $T$. Output one line with two integers, which are $\\displaystyle\\sum_{e\\in T}a_e$ and $\\displaystyle\\sum_{e\\in T}b_e$.\n\nIf there are multiple solutions, output the one with the smallest $\\displaystyle\\sum_{e\\in T}a_e$.", "hint": "For $100\\%$ of the testdata, $1\\leq n\\leq 200$, $1\\leq m\\leq 10000$, $0\\leq a_i,b_i\\leq 255$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalkanOI 2011] timeismoney", "background": "", "description": "给出一个 $n$ 个点 $m$ 条边的无向图，第 $i$ 条边有两个权值 $a_i$ 和 $b_i$ 。\n\n求该图的一棵生成树 $T$ ，使得\n\n$$\\left(\\sum_{e\\in T}a_e\\right)\\times\\left(\\sum_{e\\in T}b_e\\right)$$\n\n最小。", "inputFormat": "第一行两个正整数 $n,m$ 。\n\n下 $m$ 行，每行 $4$ 个整数 $u_i,v_i,a_i,b_i$ ，表示第 $i$ 条边连接  $u_i$ 和 $v_i$ ，权值为 $a_i$ 和 $b_i$ 。\n\n点的编号为 $0\\sim n-1$ 。", "outputFormat": "假设你求出的生成树为 $T$ ，你需要输出一行两个整数，分别为 $\\displaystyle\\sum_{e\\in T}a_e$ 和 $\\displaystyle\\sum_{e\\in T}b_e$ 。\n\n如果有多解，请输出 $\\displaystyle\\sum_{e\\in T}a_e$ 最小的那个。", "hint": "对于 $100\\%$ 的数据，$1\\leq n\\leq 200,1\\leq m\\leq 10000,0\\leq a_i,b_i\\leq 255$ 。", "locale": "zh-CN"}}}
{"pid": "P5541", "type": "P", "difficulty": 3, "samples": [["3 \n4 \n7 \n9", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "贪心", "2019", "USACO", "排序"], "title": "[USACO19FEB] Sleepy Cow Herding S", "background": "", "description": "Farmer John 的 $N$ 头奶牛，总是会迷路走到农场上遥远的地方去！他需要你帮助将她们一起赶回来。\n\n农场的草地大体是一块狭长的区域——我们可以将其想象成一条数轴，奶牛可以占据数轴上的任意整数位置。这 $N$ 头奶牛现在正位于不同的整数位置，Farmer John 想要移动她们，使得她们占据 $N$ 个相邻的位置（例如，位置 $6$、$7$、$8$）。\n\n不幸的是，奶牛们现在很困，Farmer John 要让她们集中精力听从命令移动并不容易。任意时刻，他只能使得一头处在“端点”（在所有奶牛中位置最小或最大）位置的奶牛移动。当他移动奶牛时，他可以命令她走到任意一个未被占用的整数位置，只要在新的位置上她不再是一个端点。可以看到随着时间的推移，这样的移动可以使奶牛们趋向越来越近。\n\n请求出使得奶牛们集中到相邻位置所进行的移动次数的最小和最大可能值。", "inputFormat": "先输入一个整数 $N$（$N \\leq 100000$），接下来输入 $N$ 个数，表示 $N$ 头奶牛的位置。", "outputFormat": "输出的第一行包含 Farmer John 需要将奶牛们聚集起来所需进行的最小移动次数。第二行包含他将奶牛聚集起来能够进行的最大移动次数。", "hint": "2019 USACO 二月月赛银牌组第一题", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Sleepy Cow Herding S", "background": "", "description": "Farmer John’s $N$ cows always get lost and wander far away on the farm. He needs your help to herd them back together.\n\nThe farm’s pasture is basically a long narrow region—we can think of it as a number line, and cows can stand at any integer position on this line. These $N$ cows are currently at distinct integer positions. Farmer John wants to move them so that they occupy $N$ consecutive positions (for example, positions $6$, $7$, $8$).\n\nUnfortunately, the cows are very sleepy right now, so it is not easy for Farmer John to get them to focus and follow moving orders. At any moment, he can only move a cow that is at an “endpoint” (the cow with the smallest or largest position among all cows). When he moves a cow, he may command it to go to any unoccupied integer position, as long as at its new position it is no longer an endpoint. You can see that over time, such moves can make the cows get closer and closer together.\n\nFind the minimum and maximum possible number of moves required to make the cows gather into consecutive positions.", "inputFormat": "First input an integer $N$ ($N \\leq 100000$). Then input $N$ numbers, representing the positions of the $N$ cows.", "outputFormat": "The first line contains the minimum number of moves Farmer John needs to gather the cows together. The second line contains the maximum number of moves he could make while still gathering the cows together.", "hint": "The first problem of the Silver Division in the February 2019 USACO contest.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Sleepy Cow Herding S", "background": "", "description": "Farmer John 的 $N$ 头奶牛，总是会迷路走到农场上遥远的地方去！他需要你帮助将她们一起赶回来。\n\n农场的草地大体是一块狭长的区域——我们可以将其想象成一条数轴，奶牛可以占据数轴上的任意整数位置。这 $N$ 头奶牛现在正位于不同的整数位置，Farmer John 想要移动她们，使得她们占据 $N$ 个相邻的位置（例如，位置 $6$、$7$、$8$）。\n\n不幸的是，奶牛们现在很困，Farmer John 要让她们集中精力听从命令移动并不容易。任意时刻，他只能使得一头处在“端点”（在所有奶牛中位置最小或最大）位置的奶牛移动。当他移动奶牛时，他可以命令她走到任意一个未被占用的整数位置，只要在新的位置上她不再是一个端点。可以看到随着时间的推移，这样的移动可以使奶牛们趋向越来越近。\n\n请求出使得奶牛们集中到相邻位置所进行的移动次数的最小和最大可能值。", "inputFormat": "先输入一个整数 $N$（$N \\leq 100000$），接下来输入 $N$ 个数，表示 $N$ 头奶牛的位置。", "outputFormat": "输出的第一行包含 Farmer John 需要将奶牛们聚集起来所需进行的最小移动次数。第二行包含他将奶牛聚集起来能够进行的最大移动次数。", "hint": "2019 USACO 二月月赛银牌组第一题", "locale": "zh-CN"}}}
{"pid": "P5542", "type": "P", "difficulty": 3, "samples": [["3 2\n1 1 5 5\n4 4 7 6\n3 3 8 7", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "USACO", "前缀和", "差分"], "title": "[USACO19FEB] Painting The Barn S", "background": "", "description": "农夫约翰不擅长多任务处理。他经常分心，很难完成长的项目。目前，他正试图在谷仓的一侧上漆，但他一直在画小矩形区域，然后由于照料奶牛的需要而偏离了方向，使得谷仓的某些部分上漆的涂料比其他部分多。\n\n我们可以将谷仓的一侧描述为一个二维 $x-y$ 平面，农夫约翰在该平面上绘制 $n$ 个矩形，每个矩形的边都与坐标轴平行，每个矩形由谷仓的左下角和右上角点的坐标描述。\n\n农夫约翰想在谷仓上涂几层油漆，这样在不久的将来就不需要再重新粉刷了。但是，他不想浪费时间涂太多的油漆。结果表明，$K$ 涂层是最佳用量。请在他画完所有的长方形后，帮他确定谷仓有多少面积被 $K$ 层油漆覆盖。", "inputFormat": "输入的第一行包含 $n$ 和 $K$。\n\n其余 $n$ 行中的每一行包含四个整数 $x_1$、$y_1$、$x_2$、$y_2$，描述正在绘制的矩形区域，左下角 $(x_1,y_1)$ 和右上角 $(x_2,y_2)$。所有 $x$ 和 $y$ 值都在 $0$ 到 $1000$ 范围内，并且所有矩形都有正面积。", "outputFormat": "请输出谷仓被 $K$ 层油漆覆盖的区域。", "hint": "$1\\le K\\le n\\le 10^5$。\n\nUSACO 2019 二月月赛银牌组第二题。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Painting The Barn S", "background": "", "description": "Farmer John is not good at multitasking. He often gets distracted and has trouble finishing long projects. Right now, he is trying to paint one side of his barn, but he keeps painting small rectangular regions and then gets sidetracked to take care of the cows, causing some parts of the barn to have more layers of paint than others.\n\nWe can describe one side of the barn as a 2D $x-y$ plane. Farmer John paints $n$ rectangles on this plane. The sides of each rectangle are parallel to the coordinate axes, and each rectangle is described by the coordinates of its bottom-left corner and top-right corner.\n\nFarmer John wants to paint enough layers so that he will not need to repaint again in the near future. However, he does not want to waste time applying too much paint. It turns out that $K$ layers is the best amount. After he finishes painting all rectangles, help him determine how much area of the barn is covered by exactly $K$ layers of paint.", "inputFormat": "The first line contains $n$ and $K$.\n\nEach of the remaining $n$ lines contains four integers $x_1$, $y_1$, $x_2$, $y_2$, describing a painted rectangular region with bottom-left corner $(x_1,y_1)$ and top-right corner $(x_2,y_2)$. All $x$ and $y$ values are in the range from $0$ to $1000$, and all rectangles have positive area.", "outputFormat": "Output the area of the barn that is covered by exactly $K$ layers of paint.", "hint": "$1\\le K\\le n\\le 10^5$.\n\nThe second problem of the USACO February 2019 contest, Silver division.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Painting The Barn S", "background": "", "description": "农夫约翰不擅长多任务处理。他经常分心，很难完成长的项目。目前，他正试图在谷仓的一侧上漆，但他一直在画小矩形区域，然后由于照料奶牛的需要而偏离了方向，使得谷仓的某些部分上漆的涂料比其他部分多。\n\n我们可以将谷仓的一侧描述为一个二维 $x-y$ 平面，农夫约翰在该平面上绘制 $n$ 个矩形，每个矩形的边都与坐标轴平行，每个矩形由谷仓的左下角和右上角点的坐标描述。\n\n农夫约翰想在谷仓上涂几层油漆，这样在不久的将来就不需要再重新粉刷了。但是，他不想浪费时间涂太多的油漆。结果表明，$K$ 涂层是最佳用量。请在他画完所有的长方形后，帮他确定谷仓有多少面积被 $K$ 层油漆覆盖。", "inputFormat": "输入的第一行包含 $n$ 和 $K$。\n\n其余 $n$ 行中的每一行包含四个整数 $x_1$、$y_1$、$x_2$、$y_2$，描述正在绘制的矩形区域，左下角 $(x_1,y_1)$ 和右上角 $(x_2,y_2)$。所有 $x$ 和 $y$ 值都在 $0$ 到 $1000$ 范围内，并且所有矩形都有正面积。", "outputFormat": "请输出谷仓被 $K$ 层油漆覆盖的区域。", "hint": "$1\\le K\\le n\\le 10^5$。\n\nUSACO 2019 二月月赛银牌组第二题。", "locale": "zh-CN"}}}
{"pid": "P5543", "type": "P", "difficulty": 4, "samples": [["3 2\nS 1 2\nD 3 2", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["图论", "2019", "USACO", "并查集", "图遍历"], "title": "[USACO19FEB] The Great Revegetation S", "background": null, "description": "一场漫长的干旱使农场主约翰的 $N$ 个牧场没有草。然而，随着雨季的到来，是时候“重新种植”了。在农夫约翰的小屋里，他有两个桶，每个桶都有不同类型的草籽。他想在他的每一个牧场种草，在每一个牧场中选择一种类型的草。\n\n作为一名奶农，农场主约翰想确保他能满足他那几头奶牛的特殊饮食需求。他的 $m$ 头奶牛都有两个最喜欢的牧场。他的一些奶牛有一个饮食限制，那就是他们应该只吃一种类型的草，因此农场主约翰希望确保在这类奶牛最喜欢的两个田里种植同一种类型的草。其他的奶牛有一个不同的饮食限制，要求他们吃不同类型的草。对于那些奶牛，农场主约翰当然想确保他们最喜欢的两块田地里有不同的草。\n\n\n请帮助农场主约翰确定他在他的 $N$ 个牧场上种植草的不同方式的数量。", "inputFormat": "输入的第一行包含两个整数 $N$（$2\\le N\\le10^5$）和 $m$（$1\\le m\\le10^5$）。\n\n之后 $m$ 行，每行描述了一头奶牛。首先是一个字符 `S` 或 `D`，表示这头奶牛需要相同（`S`）还是不同（`D`）的草类型，然后是两个 $1\\sim N$ 的整数，表示这头奶牛喜欢的两块牧场。", "outputFormat": "输出农场主约翰在他的 $N$ 个牧场上植草的方式总数。请用二进制写你的答案。", "hint": "USACO 2019 二月月赛银牌组第三题", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] The Great Revegetation S", "background": "", "description": "A long drought has left Farmer John’s $N$ pastures without grass. However, with the arrival of the rainy season, it is time to “revegetate”. In Farmer John’s barn, he has two buckets, each containing a different type of grass seed. He wants to plant grass in each of his pastures, choosing one type of grass for each pasture.\n\nAs a dairy farmer, Farmer John wants to make sure he can meet the special dietary needs of his cows. His $m$ cows each have two favorite pastures. Some cows have a dietary restriction that they should eat only one type of grass, so Farmer John wants to make sure that the same type of grass is planted in the two pastures favored by such cows. Other cows have a different dietary restriction that requires them to eat different types of grass. For those cows, Farmer John of course wants to make sure that there is different grass in their two favorite pastures.\n\nPlease help Farmer John determine the number of different ways to plant grass on his $N$ pastures.", "inputFormat": "The first line of input contains two integers $N$ ($2\\le N\\le10^5$) and $m$ ($1\\le m\\le10^5$).\n\nThe next $m$ lines each describe one cow. Each line begins with a character `S` or `D`, indicating whether this cow needs the same (`S`) or different (`D`) grass types, followed by two integers in $1\\sim N$, representing the two pastures favored by this cow.", "outputFormat": "Output the total number of ways Farmer John can plant grass on his $N$ pastures. Please write your answer in binary.", "hint": "USACO February 2019 Contest, Silver Division, Problem 3.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] The Great Revegetation S", "background": null, "description": "一场漫长的干旱使农场主约翰的 $N$ 个牧场没有草。然而，随着雨季的到来，是时候“重新种植”了。在农夫约翰的小屋里，他有两个桶，每个桶都有不同类型的草籽。他想在他的每一个牧场种草，在每一个牧场中选择一种类型的草。\n\n作为一名奶农，农场主约翰想确保他能满足他那几头奶牛的特殊饮食需求。他的 $m$ 头奶牛都有两个最喜欢的牧场。他的一些奶牛有一个饮食限制，那就是他们应该只吃一种类型的草，因此农场主约翰希望确保在这类奶牛最喜欢的两个田里种植同一种类型的草。其他的奶牛有一个不同的饮食限制，要求他们吃不同类型的草。对于那些奶牛，农场主约翰当然想确保他们最喜欢的两块田地里有不同的草。\n\n\n请帮助农场主约翰确定他在他的 $N$ 个牧场上种植草的不同方式的数量。", "inputFormat": "输入的第一行包含两个整数 $N$（$2\\le N\\le10^5$）和 $m$（$1\\le m\\le10^5$）。\n\n之后 $m$ 行，每行描述了一头奶牛。首先是一个字符 `S` 或 `D`，表示这头奶牛需要相同（`S`）还是不同（`D`）的草类型，然后是两个 $1\\sim N$ 的整数，表示这头奶牛喜欢的两块牧场。", "outputFormat": "输出农场主约翰在他的 $N$ 个牧场上植草的方式总数。请用二进制写你的答案。", "hint": "USACO 2019 二月月赛银牌组第三题", "locale": "zh-CN"}}}
{"pid": "P5544", "type": "P", "difficulty": 6, "samples": [["1 5 3\n0 0 1\n3 3\n-3 3\n3 -3\n3 0\n0 3 ", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2016", "各省省选", "江苏", "模拟退火"], "title": "[JSOI2016] 炸弹攻击1", "background": "JYY 最近迷上了一款塔防游戏，在游戏中，JYY 除了建设建筑，还可以使用炸弹对屏幕上的敌人进行范围杀伤。", "description": "游戏地图可以简单认为是一个二维平面。JYY 建造了 $N$ 个建筑，每个建筑都是一个圆，其中第 $i$ 个建筑的圆心位于 $(x_i,y_i)$ 且半径为 $r_i$。地图上一共有 $M$ 个敌人，一个敌人可以近似看成一个平面上的点，其中第 $i$ 个敌人位于$ (p_i,q_i)$。JYY 可以使用一枚可以设置半径的炸弹，可以设置一个不超过 $R$ 的范围，然后选择平面上的一个点引爆，范围内的所有敌人全部消灭。\n\n当然，由于炸弹威力巨大，如果爆炸范围接触到 JYY 的建筑，那么 JYY 的建筑也会受到损伤。（注：如果炸弹的爆炸范围仅接触到了 JYY 建筑的边界，则不会对 JYY 的建筑造成损伤；如果敌人出现在了爆炸范围的边界，则该敌人被消灭）JYY 可以自由控制炸弹的爆炸地点和爆炸半径。作为一个保守的玩家，他希望在保证自己建筑毫发无损的情况下，消灭尽量多的敌人。", "inputFormat": "第一行包含三个非负整数，分别为 $N,M,R$；\n\n接下来 $N$ 行，每行三个整数，其中第 $i$ 行为 $x_i,y_i,r_i$，表示第 $i$ 个建筑的位置和半径。数据保证所有建筑不相交（但是有可能边界接触）；\n\n接下来 $M$ 行，每行两个整数，其中第 $i$ 行为 $p_i,q_i$，表示第 $i$ 个敌人的位置。", "outputFormat": "输出一行一个整数，表示 JYY 最多可以消灭的敌人数量。", "hint": "- 对于 $20\\%$ 的数据，满足 $M = 2$；\n- 对于另外 $20\\%$ 的数据，满足 $N = 0$；\n- 对于另外 $20\\%$ 的数据，满足 $M \\leq 50$；\n- 对于 $100\\%$ 的数据，满足：\n  - $0 \\leq N \\leq 10$；\n  - $0 < M \\leq 10^3$；\n  - $1 \\leq R, r_i \\leq 2 \\times 10^4$；\n  - $|p_i|, |q_i|, |x_i|, |y_i| \\leq 2 \\times 10^4$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Bomb Attack 1", "background": "JYY has recently become obsessed with a tower defense game. In the game, besides building structures, JYY can also use bombs to deal area damage to enemies on the screen.", "description": "The game map can be simply regarded as a two-dimensional plane. JYY has built $N$ buildings, and each building is a circle. The center of the $i$-th building is at $(x_i,y_i)$ with radius $r_i$. There are $M$ enemies on the map, and each enemy can be approximated as a point on the plane. The $i$-th enemy is located at $(p_i,q_i)$. JYY can use a bomb with an adjustable radius: he can set a radius not exceeding $R$, then choose a point on the plane to detonate it, and all enemies within the range are eliminated.\n\nOf course, because the bomb is very powerful, if the explosion range touches JYY's buildings, then JYY's buildings will be damaged. (Note: if the bomb's explosion range only touches the boundary of a building, it will not damage the building; if an enemy appears on the boundary of the explosion range, that enemy is eliminated.) JYY can freely control the detonation position and the explosion radius. As a cautious player, he wants to eliminate as many enemies as possible while ensuring that none of his buildings are damaged at all.", "inputFormat": "The first line contains three non-negative integers: $N, M, R$.\n\nThe next $N$ lines each contain three integers. The $i$-th line gives $x_i,y_i,r_i$, describing the position and radius of the $i$-th building. The data guarantees that no buildings intersect (but their boundaries may touch).\n\nThe next $M$ lines each contain two integers. The $i$-th line gives $p_i,q_i$, describing the position of the $i$-th enemy.", "outputFormat": "Output one line with one integer, representing the maximum number of enemies that JYY can eliminate.", "hint": "- For $20\\%$ of the data, $M = 2$.\n- For another $20\\%$ of the data, $N = 0$.\n- For another $20\\%$ of the data, $M \\leq 50$.\n- For $100\\%$ of the data, the Constraints are:\n  - $0 \\leq N \\leq 10$.\n  - $0 < M \\leq 10^3$.\n  - $1 \\leq R, r_i \\leq 2 \\times 10^4$.\n  - $|p_i|, |q_i|, |x_i|, |y_i| \\leq 2 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 炸弹攻击1", "background": "JYY 最近迷上了一款塔防游戏，在游戏中，JYY 除了建设建筑，还可以使用炸弹对屏幕上的敌人进行范围杀伤。", "description": "游戏地图可以简单认为是一个二维平面。JYY 建造了 $N$ 个建筑，每个建筑都是一个圆，其中第 $i$ 个建筑的圆心位于 $(x_i,y_i)$ 且半径为 $r_i$。地图上一共有 $M$ 个敌人，一个敌人可以近似看成一个平面上的点，其中第 $i$ 个敌人位于$ (p_i,q_i)$。JYY 可以使用一枚可以设置半径的炸弹，可以设置一个不超过 $R$ 的范围，然后选择平面上的一个点引爆，范围内的所有敌人全部消灭。\n\n当然，由于炸弹威力巨大，如果爆炸范围接触到 JYY 的建筑，那么 JYY 的建筑也会受到损伤。（注：如果炸弹的爆炸范围仅接触到了 JYY 建筑的边界，则不会对 JYY 的建筑造成损伤；如果敌人出现在了爆炸范围的边界，则该敌人被消灭）JYY 可以自由控制炸弹的爆炸地点和爆炸半径。作为一个保守的玩家，他希望在保证自己建筑毫发无损的情况下，消灭尽量多的敌人。", "inputFormat": "第一行包含三个非负整数，分别为 $N,M,R$；\n\n接下来 $N$ 行，每行三个整数，其中第 $i$ 行为 $x_i,y_i,r_i$，表示第 $i$ 个建筑的位置和半径。数据保证所有建筑不相交（但是有可能边界接触）；\n\n接下来 $M$ 行，每行两个整数，其中第 $i$ 行为 $p_i,q_i$，表示第 $i$ 个敌人的位置。", "outputFormat": "输出一行一个整数，表示 JYY 最多可以消灭的敌人数量。", "hint": "- 对于 $20\\%$ 的数据，满足 $M = 2$；\n- 对于另外 $20\\%$ 的数据，满足 $N = 0$；\n- 对于另外 $20\\%$ 的数据，满足 $M \\leq 50$；\n- 对于 $100\\%$ 的数据，满足：\n  - $0 \\leq N \\leq 10$；\n  - $0 < M \\leq 10^3$；\n  - $1 \\leq R, r_i \\leq 2 \\times 10^4$；\n  - $|p_i|, |q_i|, |x_i|, |y_i| \\leq 2 \\times 10^4$。\n", "locale": "zh-CN"}}}
{"pid": "P5545", "type": "P", "difficulty": 6, "samples": [["3\n1 12\n10 30\n30 10\n1\n10 -10\n4\n2 -11\n9 -1\n11 -1\n15 -14", "7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["计算几何", "2016", "各省省选", "江苏"], "title": "[JSOI2016] 炸弹攻击2", "background": "还记得那款题为炸弹攻击的塔防游戏吗？这款游戏出了续作，炸弹的威力大大加强了。", "description": "游戏的地图是一个二维平面。JYY 的阵地位于 $x$ 轴下方，而所有的敌人目前都位于 $x$ 轴上方。\n\n在 JYY 的阵地中有建有 $T$ 个激光塔和 $S$ 个发射源。其中第 $i$ 个防御塔 $T_i$ 的坐标为 $(tx_i,ty_i)$，第 $i$ 个发射源 $S_i$ 的坐标为 $(sx_i,sy_i)$。\n\n地图上有 $D$ 个敌人，第 $i$ 个敌人 $D_i$ 的坐标为 $(dx_i,dy_i)$。\n\n两座激光塔可以相互连接形成能量墙。发射源朝向敌人发出的能量如果穿过了能量墙，可以得到巨大的加强而变为超级射线并瞬间消灭敌人。\n\nJYY 想知道他有多少种可以可以发出超级射线的攻击方案。\n\n具体来说，一个可以发出超级射线的攻击方案为一个由四个点组成的集合：$\\{T_i,T_j,S_k,D_l\\}$，满足$1 \\leq i < j \\leq T,1 \\leq k \\leq S,1 \\leq l \\leq D$，并且线段 $T_iT_j$ 和线段 $S_kD_l$ 相交。\n\n游戏设定保证在这 $T+D+S$ 个点中，不存在重点也不存在三点共线。", "inputFormat": "第一行包含一个正整数 $D$；\n\n接下来 $D$ 行，每行包含两个整数 $dx_i,dy_i$，表示一个敌人的坐标；\n\n第 $D+1$ 行包含一个整数 $S$；\n\n接下来 $S$ 行，每行包含两个整数 $sx_i,sy_i$，表示一个发射源的坐标；\n\n第 $D+S+1$ 行包含一个整数 $T$；\n\n接下来 $T$ 行，每行包含两个整数 $(tx_i,ty_i)$，表示一个激光塔的坐标。", "outputFormat": "输出一行一个整数，可以发出超级射线的攻击方案个数。", "hint": "对于 $20\\%$ 的数据，满足 $D,S,T \\leq 30$；\n\n对于$50\\%$ 的数据，满足 $D,S,T \\leq 150$；\n\n对于$100\\%$ 的数据，满足 $1 \\leq D,S,T \\leq 800 , dy_i>0,sy_i,ty_i<0$，所有坐标绝对值不超过 $10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Bomb Attack 2", "background": "Do you still remember the tower defense game called Bomb Attack? This game now has a sequel, and the bombs are much more powerful.", "description": "The game map is a two-dimensional plane. JYY's base is below the $x$-axis, and all enemies are currently above the $x$-axis.\n\nIn JYY's base, there are $T$ laser towers and $S$ launchers. The coordinates of the $i$-th tower $T_i$ are $(tx_i,ty_i)$, and the coordinates of the $i$-th launcher $S_i$ are $(sx_i,sy_i)$.\n\nThere are $D$ enemies on the map. The coordinates of the $i$-th enemy $D_i$ are $(dx_i,dy_i)$.\n\nTwo laser towers can be connected to form an energy wall. If the energy fired from a launcher toward an enemy passes through an energy wall, it can be greatly strengthened, becoming a super ray that instantly destroys the enemy.\n\nJYY wants to know how many different attack plans can produce a super ray.\n\nSpecifically, an attack plan that can produce a super ray is a set of four points: $\\{T_i,T_j,S_k,D_l\\}$, satisfying $1 \\leq i < j \\leq T,1 \\leq k \\leq S,1 \\leq l \\leq D$, and the line segment $T_iT_j$ intersects the line segment $S_kD_l$.\n\nThe game guarantees that among these $T+D+S$ points, there are no duplicate points and no three points are collinear.", "inputFormat": "The first line contains a positive integer $D$.\n\nThe next $D$ lines each contain two integers $dx_i,dy_i$, representing the coordinates of an enemy.\n\nLine $D+1$ contains an integer $S$.\n\nThe next $S$ lines each contain two integers $sx_i,sy_i$, representing the coordinates of a launcher.\n\nLine $D+S+1$ contains an integer $T$.\n\nThe next $T$ lines each contain two integers $(tx_i,ty_i)$, representing the coordinates of a laser tower.", "outputFormat": "Output one line containing one integer: the number of attack plans that can produce a super ray.", "hint": "For $20\\%$ of the testdata, $D,S,T \\leq 30$.\n\nFor $50\\%$ of the testdata, $D,S,T \\leq 150$.\n\nFor $100\\%$ of the testdata, $1 \\leq D,S,T \\leq 800, dy_i>0,sy_i,ty_i<0$, and the absolute value of every coordinate does not exceed $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 炸弹攻击2", "background": "还记得那款题为炸弹攻击的塔防游戏吗？这款游戏出了续作，炸弹的威力大大加强了。", "description": "游戏的地图是一个二维平面。JYY 的阵地位于 $x$ 轴下方，而所有的敌人目前都位于 $x$ 轴上方。\n\n在 JYY 的阵地中有建有 $T$ 个激光塔和 $S$ 个发射源。其中第 $i$ 个防御塔 $T_i$ 的坐标为 $(tx_i,ty_i)$，第 $i$ 个发射源 $S_i$ 的坐标为 $(sx_i,sy_i)$。\n\n地图上有 $D$ 个敌人，第 $i$ 个敌人 $D_i$ 的坐标为 $(dx_i,dy_i)$。\n\n两座激光塔可以相互连接形成能量墙。发射源朝向敌人发出的能量如果穿过了能量墙，可以得到巨大的加强而变为超级射线并瞬间消灭敌人。\n\nJYY 想知道他有多少种可以可以发出超级射线的攻击方案。\n\n具体来说，一个可以发出超级射线的攻击方案为一个由四个点组成的集合：$\\{T_i,T_j,S_k,D_l\\}$，满足$1 \\leq i < j \\leq T,1 \\leq k \\leq S,1 \\leq l \\leq D$，并且线段 $T_iT_j$ 和线段 $S_kD_l$ 相交。\n\n游戏设定保证在这 $T+D+S$ 个点中，不存在重点也不存在三点共线。", "inputFormat": "第一行包含一个正整数 $D$；\n\n接下来 $D$ 行，每行包含两个整数 $dx_i,dy_i$，表示一个敌人的坐标；\n\n第 $D+1$ 行包含一个整数 $S$；\n\n接下来 $S$ 行，每行包含两个整数 $sx_i,sy_i$，表示一个发射源的坐标；\n\n第 $D+S+1$ 行包含一个整数 $T$；\n\n接下来 $T$ 行，每行包含两个整数 $(tx_i,ty_i)$，表示一个激光塔的坐标。", "outputFormat": "输出一行一个整数，可以发出超级射线的攻击方案个数。", "hint": "对于 $20\\%$ 的数据，满足 $D,S,T \\leq 30$；\n\n对于$50\\%$ 的数据，满足 $D,S,T \\leq 150$；\n\n对于$100\\%$ 的数据，满足 $1 \\leq D,S,T \\leq 800 , dy_i>0,sy_i,ty_i<0$，所有坐标绝对值不超过 $10^9$。", "locale": "zh-CN"}}}
{"pid": "P5546", "type": "P", "difficulty": 4, "samples": [["3\nabcb\nbca\nacbc", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2000", "二分", "POI（波兰）", "哈希 hashing", "字典树 Trie", "后缀数组 SA"], "title": "[POI 2000] 公共串", "background": null, "description": "给出几个由小写字母构成的单词，求它们最长的公共子串的长度。", "inputFormat": "文件的第一行是整数 $n$，$1\\le n \\le 5$，表示单词的数量。接下来 $n$ 行每行一个单词，只由小写字母组成，单词的长度至少为 $1$，最大为 $2000$。", "outputFormat": "仅一行，一个整数，最长公共子串的长度。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[POI 2000] Common Substring", "background": "", "description": "Given several words consisting of lowercase letters, find the length of their longest common substring.", "inputFormat": "The first line of the file is an integer $n$, $1\\le n \\le 5$, which represents the number of words. The next $n$ lines each contain one word, consisting only of lowercase letters. The length of each word is at least $1$ and at most $2000$.", "outputFormat": "Only one line containing one integer: the length of the longest common substring.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[POI 2000] 公共串", "background": null, "description": "给出几个由小写字母构成的单词，求它们最长的公共子串的长度。", "inputFormat": "文件的第一行是整数 $n$，$1\\le n \\le 5$，表示单词的数量。接下来 $n$ 行每行一个单词，只由小写字母组成，单词的长度至少为 $1$，最大为 $2000$。", "outputFormat": "仅一行，一个整数，最长公共子串的长度。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5547", "type": "P", "difficulty": 6, "samples": [["2 998244353", "5"], ["3 998244353", "15"], ["20 998244353", "578067492"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "北京", "O2优化", "组合数学"], "title": "[BJ United Round #3] 三色树", "background": "", "description": "请你对满足以下要求的 $n$ 个节点的 **无标号无根树** 计数： \n \n- 每个节点是三种颜色之一：红，蓝，黄\n- 红色节点度数不超过 $4$，蓝色和黄色节点度数均不超过 $3$  \n- 黄色节点不能相邻\n\n注意 **无标号无根树** 的意义是：如果两颗树可以通过重新编号的方法使得对应点颜色相同，对应连边一致，则认为是同一颗树。\n\n答案对输入的质数 $p$ 取模。", "inputFormat": "两个正整数 $n,p$，意义如题面所示。", "outputFormat": "一个整数，表示方案数对 $p$ 取模的结果。", "hint": "\n\n对于 $100\\%$ 的数据，保证：  \n$1\\le n \\le 3000$  \n$9\\times 10^8 \\le p \\le 1.01 \\times 10^9$   \n保证 $p$ 为质数\n\nBy：EntropyIncreaser", "locale": "zh-CN", "translations": {"en": {"title": "[BJ United Round #3] Three-Color Tree", "background": "", "description": "Please count the number of **unlabeled unrooted trees** with $n$ nodes that satisfy the following requirements:\n\n- Each node has one of three colors: red, blue, or yellow.\n- The degree of a red node is at most $4$, and the degrees of blue and yellow nodes are both at most $3$.\n- Yellow nodes cannot be adjacent.\n\nNote that the meaning of an **unlabeled unrooted tree** is: if two trees can be made identical by renumbering the nodes so that the corresponding nodes have the same colors and the corresponding edges match, then they are considered the same tree.\n\nThe answer should be taken modulo the prime number $p$ given in the input.", "inputFormat": "Two positive integers $n,p$, with the meanings as described above.", "outputFormat": "One integer, representing the number of valid trees modulo $p$.", "hint": "For $100\\%$ of the testdata, it is guaranteed that:\n$1\\le n \\le 3000$.\n$9\\times 10^8 \\le p \\le 1.01 \\times 10^9$.\nIt is guaranteed that $p$ is prime.\n\nBy: EntropyIncreaser\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJ United Round #3] 三色树", "background": "", "description": "请你对满足以下要求的 $n$ 个节点的 **无标号无根树** 计数： \n \n- 每个节点是三种颜色之一：红，蓝，黄\n- 红色节点度数不超过 $4$，蓝色和黄色节点度数均不超过 $3$  \n- 黄色节点不能相邻\n\n注意 **无标号无根树** 的意义是：如果两颗树可以通过重新编号的方法使得对应点颜色相同，对应连边一致，则认为是同一颗树。\n\n答案对输入的质数 $p$ 取模。", "inputFormat": "两个正整数 $n,p$，意义如题面所示。", "outputFormat": "一个整数，表示方案数对 $p$ 取模的结果。", "hint": "\n\n对于 $100\\%$ 的数据，保证：  \n$1\\le n \\le 3000$  \n$9\\times 10^8 \\le p \\le 1.01 \\times 10^9$   \n保证 $p$ 为质数\n\nBy：EntropyIncreaser", "locale": "zh-CN"}}}
{"pid": "P5548", "type": "P", "difficulty": 7, "samples": [["2 2 2", "8"], ["2 3 4", "213"], ["2 4 6", "5548"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "北京", "组合数学", "生成函数"], "title": "[BJ United Round #3] 押韵", "background": "韵要怎么押？棋要怎么下？敌要怎么杀？旗要怎么插？", "description": "现在你想要写一首歌词，一共有 $nd$ 个字，你一共设计了 $k$ 种韵脚，每个字恰好要符合一种韵脚。  \n\n并且只有当每种韵脚在歌词中出现的字数恰为 $d$ 的倍数时，这首歌才好听。\n\n试问一共有多少种韵脚的搭配方法，使得歌词好听？\n\n你只需要回答方案数对于 $1049874433$ 取模的结果即可。", "inputFormat": "一行三个整数 $n,k,d$，如题意所示。", "outputFormat": "一行一个整数，表示答案。", "hint": "对于 $100\\%$ 的数据，保证：  \n$0 \\le n \\le 10^9$  \n$1\\le k \\le 2000$  \n$d\\in \\{ 1,2,3,4,6 \\}$\n\nBy：EntropyIncreaser", "locale": "zh-CN", "translations": {"en": {"title": "[BJ United Round #3] Rhyming.", "background": "How do you rhyme? How do you play chess? How do you kill enemies? How do you plant the flag?", "description": "Now you want to write a song lyric with a total of $nd$ characters. You have designed $k$ types of rhyme endings, and each character must fit exactly one type of rhyme ending.\n\nAlso, the song sounds good only if, for every rhyme ending type, the number of characters in the lyric that use this rhyme ending is exactly a multiple of $d$.\n\nHow many ways are there to assign rhyme endings so that the song sounds good?\n\nYou only need to output the number of ways modulo $1049874433$.", "inputFormat": "One line with three integers $n,k,d$, as described.", "outputFormat": "One line with one integer, the answer.", "hint": "For $100\\%$ of the testdata, it is guaranteed that:  \n$0 \\le n \\le 10^9$  \n$1 \\le k \\le 2000$  \n$d \\in \\{ 1,2,3,4,6 \\}$\n\nBy: EntropyIncreaser\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJ United Round #3] 押韵", "background": "韵要怎么押？棋要怎么下？敌要怎么杀？旗要怎么插？", "description": "现在你想要写一首歌词，一共有 $nd$ 个字，你一共设计了 $k$ 种韵脚，每个字恰好要符合一种韵脚。  \n\n并且只有当每种韵脚在歌词中出现的字数恰为 $d$ 的倍数时，这首歌才好听。\n\n试问一共有多少种韵脚的搭配方法，使得歌词好听？\n\n你只需要回答方案数对于 $1049874433$ 取模的结果即可。", "inputFormat": "一行三个整数 $n,k,d$，如题意所示。", "outputFormat": "一行一个整数，表示答案。", "hint": "对于 $100\\%$ 的数据，保证：  \n$0 \\le n \\le 10^9$  \n$1\\le k \\le 2000$  \n$d\\in \\{ 1,2,3,4,6 \\}$\n\nBy：EntropyIncreaser", "locale": "zh-CN"}}}
{"pid": "P5549", "type": "P", "difficulty": 6, "samples": [["4 3\n0 0\n1 1\n2 3\n3 3", "1.41421356"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "二分", "北京", "Special Judge", "随机化"], "title": "[BJ United Round #3] 观察星象", "background": "", "description": "EI 在用望远镜观察星星，星空中共有  $n$ 个星星，每个星星观察起来有一个二维直角坐标 $(x,y)$。  \n\n他的望远镜如果定位在 $(x_0,y_0)$ 处，可以看到所有 $(x_0-x)^2 + (y_0-y)^2 \\le r^2$ 的星星。  \n\n望远镜的大小 $r$ 是可以调整的，EI 想知道如果他要至少看到 $m$ 个星星，至少需要把 $r$ 设置到多大？", "inputFormat": "第一行两个正整数 $n,m$，表示星星的数量和要求看到的星星数量。  \n接下来 $n$ 行，每行两个整数 $x,y$，表示一个星星的坐标。  \n保证星星坐标两两不同。", "outputFormat": "输出一行一个正实数，表示望远镜的最小半径。  \n令你的答案为 $a$，标准答案为 $b$，若 $\\frac{|a-b|}{\\max(1,b)} \\le 10^{-6}$  \n( 即绝对误差或者相对误差不超过 $10^{-6}$ ) 即为正确。", "hint": "| 子任务编号 | $n$ | $m$ | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\leq 50$ | $\\leq n$ | $10$ |\n| $2$ | $\\leq 200$ | $\\leq n$ | $15$ |\n| $3$ | $\\leq 700$ | $\\leq n$ | $15$ |\n| $4$ | $\\leq 2000$ | $= n$ | $20$ |\n| $5$ | $\\leq 2000$ | $\\leq n$ | $40$ |\n\n\n对于 $100\\%$ 的数据，保证：  \n$2 \\le m \\le n  \\le 2000$  \n$|x|,|y| \\le 10^4$\n\nBy：EntropyIncreaser", "locale": "zh-CN", "translations": {"en": {"title": "[BJ United Round #3] Observing the Stars", "background": "", "description": "EI is using a telescope to observe stars. There are $n$ stars in the sky, and each star has a 2D Cartesian coordinate $(x,y)$.\n\nIf the telescope is positioned at $(x_0,y_0)$, it can see all stars satisfying $(x_0-x)^2 + (y_0-y)^2 \\le r^2$.\n\nThe telescope size $r$ can be adjusted. EI wants to know: if he wants to see at least $m$ stars, what is the minimum value to set $r$ to?", "inputFormat": "The first line contains two positive integers $n,m$, representing the number of stars and the required number of stars to be seen.\n\nThe next $n$ lines each contain two integers $x,y$, representing the coordinate of one star.\n\nIt is guaranteed that all star coordinates are pairwise distinct.", "outputFormat": "Output one line containing one positive real number, representing the minimum radius of the telescope.\n\nLet your answer be $a$ and the standard answer be $b$. If $\\frac{|a-b|}{\\max(1,b)} \\le 10^{-6}$ (i.e., the absolute error or relative error does not exceed $10^{-6}$), then your answer is accepted.", "hint": "| Subtask ID | $n$ | $m$ | Score |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\leq 50$ | $\\leq n$ | $10$ |\n| $2$ | $\\leq 200$ | $\\leq n$ | $15$ |\n| $3$ | $\\leq 700$ | $\\leq n$ | $15$ |\n| $4$ | $\\leq 2000$ | $= n$ | $20$ |\n| $5$ | $\\leq 2000$ | $\\leq n$ | $40$ |\n\nFor $100\\%$ of the testdata, it is guaranteed that:\n\n$2 \\le m \\le n \\le 2000$.\n\n$|x|,|y| \\le 10^4$.\n\nBy: EntropyIncreaser.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJ United Round #3] 观察星象", "background": "", "description": "EI 在用望远镜观察星星，星空中共有  $n$ 个星星，每个星星观察起来有一个二维直角坐标 $(x,y)$。  \n\n他的望远镜如果定位在 $(x_0,y_0)$ 处，可以看到所有 $(x_0-x)^2 + (y_0-y)^2 \\le r^2$ 的星星。  \n\n望远镜的大小 $r$ 是可以调整的，EI 想知道如果他要至少看到 $m$ 个星星，至少需要把 $r$ 设置到多大？", "inputFormat": "第一行两个正整数 $n,m$，表示星星的数量和要求看到的星星数量。  \n接下来 $n$ 行，每行两个整数 $x,y$，表示一个星星的坐标。  \n保证星星坐标两两不同。", "outputFormat": "输出一行一个正实数，表示望远镜的最小半径。  \n令你的答案为 $a$，标准答案为 $b$，若 $\\frac{|a-b|}{\\max(1,b)} \\le 10^{-6}$  \n( 即绝对误差或者相对误差不超过 $10^{-6}$ ) 即为正确。", "hint": "| 子任务编号 | $n$ | $m$ | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\leq 50$ | $\\leq n$ | $10$ |\n| $2$ | $\\leq 200$ | $\\leq n$ | $15$ |\n| $3$ | $\\leq 700$ | $\\leq n$ | $15$ |\n| $4$ | $\\leq 2000$ | $= n$ | $20$ |\n| $5$ | $\\leq 2000$ | $\\leq n$ | $40$ |\n\n\n对于 $100\\%$ 的数据，保证：  \n$2 \\le m \\le n  \\le 2000$  \n$|x|,|y| \\le 10^4$\n\nBy：EntropyIncreaser", "locale": "zh-CN"}}}
{"pid": "P5550", "type": "P", "difficulty": 4, "samples": [["4 1 2 3\n1 2 3 4", "1 2 3 4"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["矩阵乘法"], "title": "Chino的数列", "background": "没有背景\n\n我写不出来了qwq", "description": "Chino给定了 $n$ 个数 $a_1...a_n$，给定常数 $s,m$ ，她会轮流对这 $n$ 个数做 $k$ 组操作，每组操作包含以下几步：\n\n1. $\\operatorname{swap}(a_s,a_m)$（交换 $a_s,a_m$）。\n\n2. 将 $n$ 个数都向前平移一位（第 $1$ 个移动到第 $n$ 个位置上）。\n\nChino 想知道，$k$ 组操作后，这 $n$ 个数分别是多少？\n \nOrz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg", "inputFormat": "第一行，四个数，$n,s,m,k$。\n\n接下来一行 $n$ 个数，分别代表 $a_1,a_2...a_n$。", "outputFormat": "输出一行，$n$ 个数，分别代表 $a_1,a_2...a_n$。", "hint": "对于 $40\\%$ 的数据，$1 \\leq k \\leq 10^7$\n\n对于 $100\\% $的数据，$1 \\leq n \\leq 80$，$1 \\leq s,m\\leq n$，$1 \\leq k \\leq 10^{18}$\n\n所有数字均在 `long long` 以内", "locale": "zh-CN", "translations": {"en": {"title": "Chino’s Sequence.", "background": "None.\n\nI can’t write it anymore qwq.", "description": "Chino is given $n$ numbers $a_1...a_n$, and two constants $s, m$. She will repeatedly perform $k$ rounds of operations on these $n$ numbers. Each round includes the following steps:\n\n1. $\\operatorname{swap}(a_s,a_m)$ (swap $a_s$ and $a_m$).\n\n2. Shift all $n$ numbers forward by one position (the 1st number moves to the $n$-th position).\n\nChino wants to know what these $n$ numbers are after $k$ rounds of operations.\n\nOrz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg.", "inputFormat": "The first line contains four numbers: $n, s, m, k$.\n\nThe next line contains $n$ numbers, representing $a_1, a_2...a_n$.", "outputFormat": "Output one line with $n$ numbers, representing $a_1, a_2...a_n$.", "hint": "For $40\\%$ of the testdata, $1 \\leq k \\leq 10^7$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 80$, $1 \\leq s, m \\leq n$, $1 \\leq k \\leq 10^{18}$.\n\nAll numbers fit in `long long`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Chino的数列", "background": "没有背景\n\n我写不出来了qwq", "description": "Chino给定了 $n$ 个数 $a_1...a_n$，给定常数 $s,m$ ，她会轮流对这 $n$ 个数做 $k$ 组操作，每组操作包含以下几步：\n\n1. $\\operatorname{swap}(a_s,a_m)$（交换 $a_s,a_m$）。\n\n2. 将 $n$ 个数都向前平移一位（第 $1$ 个移动到第 $n$ 个位置上）。\n\nChino 想知道，$k$ 组操作后，这 $n$ 个数分别是多少？\n \nOrz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg", "inputFormat": "第一行，四个数，$n,s,m,k$。\n\n接下来一行 $n$ 个数，分别代表 $a_1,a_2...a_n$。", "outputFormat": "输出一行，$n$ 个数，分别代表 $a_1,a_2...a_n$。", "hint": "对于 $40\\%$ 的数据，$1 \\leq k \\leq 10^7$\n\n对于 $100\\% $的数据，$1 \\leq n \\leq 80$，$1 \\leq s,m\\leq n$，$1 \\leq k \\leq 10^{18}$\n\n所有数字均在 `long long` 以内", "locale": "zh-CN"}}}
