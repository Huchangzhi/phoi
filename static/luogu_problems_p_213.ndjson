{"pid": "P5309", "type": "P", "difficulty": 6, "samples": [["5 6\n1 2 3 4 5\n2 2 4\n1 1 1 1\n2 2 4\n2 1 3\n1 2 1 2\n2 1 3\n", "9\n12\n9\n13\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "O2优化", "分块", "Ynoi", "根号分治"], "title": "[Ynoi2011] 初始化", "background": "我呢…是什么时候开始存在于此的呢？\n\n从何时开始…我成为了我呢？\n\n仔细想想，我从出生开始似乎也没有什么记忆？\n\n这么说明天的“我”和今天的“我”是同一个存在吗？\n\n或者说…如何定义“我”这个存在呢？\n\n“我”这个存在真的存在吗？\n\n如果存在的话…意义又是什么呢？\n\n等等…如何定义“意义”呢？\n\n意义…意义…意义…意义…意义…意义…意义…意义…\n\n…………………………………………\n\n他当然想不通这些问题\n\n于是自然而然地去问大人，就像一个小孩子应该做的一样\n\n“爸爸，活着的意义是什么啊？”\n\n“等你长大了就知道了，现在先好好学习吧”\n\n“妈妈，活着的意义是什么啊？”\n\n“小孩子想这些事干啥呢，先把成绩搞好再说”\n\n“老师，活着的意义是什么啊？”\n\n“好好学习，把成绩搞好，考上好大学，找个好工作，然后赚大钱”\n\n原来如此啊，原来这就是意义呢\n\n虽然这是意义，但是感觉真是无趣呢，真是可悲呢\n\n但是，这是意义啊，不管多么的无趣，多么的可悲，既然是意义，那一定要努力\n实现呢，因为这毕竟是意义啊~！\n\n于是他开始好好学习了，由于天资还不错，所以考上了好的初中，进入了最好的\n班级，似乎未来一片光明呢\n\n实际上，他当时也确实是这么想的呢（笑\n\n【记得配图，内容待定】\n\n由于这是Ynoi，不是出题人拿来写傻逼的文字的地方，所以你需要做一个数据结构题：\n", "description": "Mayuri 有 $n$ 颗星星，每颗星星都有一个明亮度 $A_{i}$ 。Mayuri 时常想知道一个区间 $[l,r]$ 内所有星星的明亮度的总和是多少。但是星星是会眨眼的，所以星星的明亮度是会变化的。有的时候，下标为 $y,y+x,y+2x,y+3x,\\ldots,y+kx$ 的星星的明亮度会增加 $z$。保证 $y\\leq x$。\n\n\nMayuri 不怎么会数学，请回答她的询问。答案要对 $10^{9}+7$ 取模。\n", "inputFormat": "第一行两个整数 $n$ 和 $m$，分别表示星星的数量和操作的数量。\n\n\n接下来一行 $n$ 个数字 $A_{i}$，表示初始的明亮度。\n\n\n接下来 $m$ 行，每行先是一个整数表示操作类型，如果为 $1$ 则是修改操作，接下来 $3$ 个整数 $x,y,z$；如果是 $2$ 则为询问操作，接下来两个整数 $l,r$。\n", "outputFormat": "对于每个询问操作，输出一行表示答案。\n", "hint": "Idea：yanQval，Solution：yanQval，Code：yanQval，Data：yanQval&nzhtl1477\n\n对于 $10\\%$ 的数据，满足 $n,m\\leq 1000$。\n\n对于另外 $10\\%$ 的数据，满足 $x>1000$。\n\n对于另外 $10\\%$ 的数据，满足 $x>300$。\n\n对于另外 $10\\%$ 的数据，满足 $n,m \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 2\\times 10^5$，$1\\leq y\\leq x\\leq n$，$1\\leq l\\leq r\\leq n$，$0\\leq A_i,z \\leq 10^{9}+7$。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] Initialization", "background": "As for me... when did I begin to exist here?\n\nSince when... did I become me?\n\nCome to think of it, I don't seem to have any memory from birth?\n\nSo does that mean the “me” of tomorrow and the “me” of today are the same being?\n\nOr rather... how do we define this “self”?\n\nDoes this “self” really exist?\n\nIf it does... then what is its meaning?\n\nWait... how do we define “meaning”?\n\nMeaning... meaning... meaning... meaning... meaning... meaning... meaning... meaning...\n\n...\n\nHe, of course, couldn't figure any of this out.\n\nSo, naturally, he went to ask the adults, just like a child should.\n\n“Dad, what is the meaning of living?”\n\n“You’ll understand when you grow up. For now, just study hard.”\n\n“Mom, what is the meaning of living?”\n\n“Why is a child thinking about this? Focus on getting good grades first.”\n\n“Teacher, what is the meaning of living?”\n\n“Study hard, get good grades, get into a good university, find a good job, and then make lots of money.”\n\nI see—that's the meaning.\n\nEven if that's the meaning, it feels so dull, so sad.\n\nBut since that is the meaning, no matter how dull or sad it is, it must be pursued, because after all, it's the meaning~!\n\nSo he began to study hard. With decent talent, he got into a good middle school and the best class. The future seemed bright.\n\nIn fact, that's exactly what he thought then (laughs).\n\n[Remember to add an illustration, content TBD].\n\nSince this is Ynoi and not a place for the setter to write nonsense, you need to solve a data structure problem:", "description": "Mayuri has $n$ stars, each with a brightness $A_{i}$. Mayuri often wants to know the sum of the brightnesses of all stars in an interval $[l, r]$. But stars twinkle, so their brightness can change. At times, the brightness of stars with indices $y, y+x, y+2x, y+3x, \\ldots, y+kx$ increases by $z$. It is guaranteed that $y \\leq x$.\n\nMayuri is not very good at math; please answer her queries. The answer should be taken modulo $10^{9}+7$.", "inputFormat": "The first line contains two integers $n$ and $m$, the number of stars and the number of operations.\n\nThe next line contains $n$ numbers $A_{i}$, the initial brightness values.\n\nThen follow $m$ lines. Each line starts with an integer denoting the operation type: if it is $1$, it is an update, followed by three integers $x, y, z$; if it is $2$, it is a query, followed by two integers $l, r$.", "outputFormat": "For each query operation, output one line with the answer.", "hint": "Idea: yanQval, Solution: yanQval, Code: yanQval, Data: yanQval & nzhtl1477.\n\nConstraints:\n- For $10\\%$ of the testdata, $n, m \\leq 1000$.\n- For another $10\\%$ of the testdata, $x>1000$.\n- For another $10\\%$ of the testdata, $x>300$.\n- For another $10\\%$ of the testdata, $n, m \\leq 10^5$.\n- For $100\\%$ of the testdata, $1 \\leq n, m \\leq 2 \\times 10^5$, $1 \\leq y \\leq x \\leq n$, $1 \\leq l \\leq r \\leq n$, $0 \\leq A_i, z \\leq 10^{9}+7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] 初始化", "background": "我呢…是什么时候开始存在于此的呢？\n\n从何时开始…我成为了我呢？\n\n仔细想想，我从出生开始似乎也没有什么记忆？\n\n这么说明天的“我”和今天的“我”是同一个存在吗？\n\n或者说…如何定义“我”这个存在呢？\n\n“我”这个存在真的存在吗？\n\n如果存在的话…意义又是什么呢？\n\n等等…如何定义“意义”呢？\n\n意义…意义…意义…意义…意义…意义…意义…意义…\n\n…………………………………………\n\n他当然想不通这些问题\n\n于是自然而然地去问大人，就像一个小孩子应该做的一样\n\n“爸爸，活着的意义是什么啊？”\n\n“等你长大了就知道了，现在先好好学习吧”\n\n“妈妈，活着的意义是什么啊？”\n\n“小孩子想这些事干啥呢，先把成绩搞好再说”\n\n“老师，活着的意义是什么啊？”\n\n“好好学习，把成绩搞好，考上好大学，找个好工作，然后赚大钱”\n\n原来如此啊，原来这就是意义呢\n\n虽然这是意义，但是感觉真是无趣呢，真是可悲呢\n\n但是，这是意义啊，不管多么的无趣，多么的可悲，既然是意义，那一定要努力\n实现呢，因为这毕竟是意义啊~！\n\n于是他开始好好学习了，由于天资还不错，所以考上了好的初中，进入了最好的\n班级，似乎未来一片光明呢\n\n实际上，他当时也确实是这么想的呢（笑\n\n【记得配图，内容待定】\n\n由于这是Ynoi，不是出题人拿来写傻逼的文字的地方，所以你需要做一个数据结构题：\n", "description": "Mayuri 有 $n$ 颗星星，每颗星星都有一个明亮度 $A_{i}$ 。Mayuri 时常想知道一个区间 $[l,r]$ 内所有星星的明亮度的总和是多少。但是星星是会眨眼的，所以星星的明亮度是会变化的。有的时候，下标为 $y,y+x,y+2x,y+3x,\\ldots,y+kx$ 的星星的明亮度会增加 $z$。保证 $y\\leq x$。\n\n\nMayuri 不怎么会数学，请回答她的询问。答案要对 $10^{9}+7$ 取模。\n", "inputFormat": "第一行两个整数 $n$ 和 $m$，分别表示星星的数量和操作的数量。\n\n\n接下来一行 $n$ 个数字 $A_{i}$，表示初始的明亮度。\n\n\n接下来 $m$ 行，每行先是一个整数表示操作类型，如果为 $1$ 则是修改操作，接下来 $3$ 个整数 $x,y,z$；如果是 $2$ 则为询问操作，接下来两个整数 $l,r$。\n", "outputFormat": "对于每个询问操作，输出一行表示答案。\n", "hint": "Idea：yanQval，Solution：yanQval，Code：yanQval，Data：yanQval&nzhtl1477\n\n对于 $10\\%$ 的数据，满足 $n,m\\leq 1000$。\n\n对于另外 $10\\%$ 的数据，满足 $x>1000$。\n\n对于另外 $10\\%$ 的数据，满足 $x>300$。\n\n对于另外 $10\\%$ 的数据，满足 $n,m \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 2\\times 10^5$，$1\\leq y\\leq x\\leq n$，$1\\leq l\\leq r\\leq n$，$0\\leq A_i,z \\leq 10^{9}+7$。\n\n", "locale": "zh-CN"}}}
{"pid": "P5310", "type": "P", "difficulty": 6, "samples": [["5 3 2\n11 7 5 3 2\n3 2 1\n2 5\n1 6\n", "0\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2011", "平衡树", "O2优化", "哈希 hashing", "洛谷月赛", "Ynoi"], "title": "[Ynoi2011] 遥远的过去", "background": "小学六年级的时候学了JAVA，写了个小游戏，大概是把我奥数老师的头弹飞出去拿来打青蛙的，看来我小时候就懂膜蛤和P头了。\n\n现在感觉当时很多东西没理解，都在乱写，程序里面全是if，就这样还是写出来了，还拿了个科创大赛一等奖（可以加5分中考分的，可不算很野鸡！）\n\n所以一直感觉我其实是很喜欢做一些有创造性的东西的，这点之后也会体现出来。\n\n上了初中，因为之前学过点小学奥数，同时也有学一些数学竞赛的东西，所以感觉老师讲课都很平凡，没什么兴趣。\n\n第一次接触到了信息学竞赛，当时感觉还是挺有趣的，不过也没怎么认真学。\n\n学校里面有OI的培训，但由于学校里面在教Pascal，我当时已经学过JAVA了，自然觉得这个语言很落后，垃圾，所以也没怎么听课，印象中我去参加个选拔考试，有个鸡兔同笼的题，我写了个解方程被扣分了，老师给的正解是 while( a-- ) b++ 这样的东西，然后就决定不去了。\n\n初二考了一次NOIP普及组，当时只拿了120，第二题是个表达式求值，我写了很久很久都一直挂，然后就凉凉了。\n\n考完之后得知班上几个同学考了全省前10，感觉他们好强，当时还是很有好胜心的，于是决定好好学OI，初三打爆他们。\n\n初三的时候考了295，被两个当时初二的小朋友打爆了，不过我是初三里面最高分（\n\n那两个小朋友好像现在都去茶园了，果然是神仙。\n\n感觉初中还是挺好玩的，虽然天天和毒瘤老师斗智斗勇，但还是很有趣。\n\n【记得配图，内容：写的小游戏的截图，还有noip的成绩】\n\n由于这是Ynoi，不是出题人拿来写奇怪的文字的地方，所以你需要做一个数据结构题：", "description": "小 F 决定设计出一种字符集超大的语言——Z 语言，哪怕有时额外的字符并没有什么用。\n\n这种语言的特点是：\n\n* 字符集非常大，甚至可能有 $2147483648(2 ^ {31})$ 种字符；\n\n* 每个单词由一系列**两两不同**的字符组成；\n\n* 字符既能比较相同和不同，也能比较大小，因此之后我们用数字来表示 Z 语言中稀奇古怪的字符；\n\n* 两个看起来完全不同的单词也可能是同一个单词，因为：只要两个单词中第 K 大的字符所在的位置相同，那么其实就是本质上相同的单词。例如 $\\{1, 2, 3, 4, 5\\}$ 与 $\\{2, 3, 23, 233, 23333\\}$ 是相同的。（所以你可以用 Z 语言很方便地加密信息！）\n\n现在，小 F 打算将 Z 语言应用到实际中。比如，他点开了一道电脑里的算法题：\n\n> 给定两个字符串 $A, B$ ，求 $B$ 作为子串在 $A$ 中被匹配的次数。\n\n 小 F 当然知道这是一个可以用 KMP 解决的基础题。但是，他在用 Z 语言的匹配实现 Z-KMP 的时候遇到了问题，你能帮帮他吗？\n\n为了验证你是不是真的明白小 F 在说什么，小 F 会修改 $B$ 串很多次来问你。可不准偷懒哦！\n\n你的程序需要支持的操作详见输入输出格式。", "inputFormat": "输入第一行两个整数 $n, m, q(1 \\leq n, m, q \\leq 10 ^ 5)$，表示 $A, B$ 串的长度以及操作次数。\n\n第二行 $n$ 个非负整数，第 $i$ 个表示 $A$ 串的第 $i$ 个字符 $A_i$ $(0 \\leq A_i \\leq 2147483647=2 ^ {31} - 1)$。\n\n第三行 $m$ 个非负整数，第 $i$ 个表示 $B$ 串的第 $i$ 个字符 $B_i$ $(0 \\leq B_i \\leq 2147483647=2 ^ {31} - 1)$。 \n\n接下来 $q$ 行，每行两个正整数 $x_i, c_i$ $(1 \\leq c_i \\leq 2147483647=2 ^ {31} - 1)$，表示将 $B$ 串 $x_i$ 位置上的字符由 $B_{x_i}$ 改为 $c_i$。\n\n数据保证，任意时刻 $A$ 和 $B$ 均是满足前述要求的合法 Z 字符串。", "outputFormat": "**在每次修改完成后**，请输出 $B$ 作为子串在 $A$ 中被 Z-匹配 的次数。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477( partially uploaded )\n\n### 样例 1 解释\n\n在第一次修改后，$\\{3, 5, 1\\}$ 并不能被任何一个 $A$ 中的子串匹配上。\n\n在第二次修改后，$\\{6, 5, 1\\}$ 能被 $A$ 中所有长度为 $3$ 的串匹配上，原因是 A 是单调减的，而 B 也是单调减的，因此 $A$ 中所有长度为 $3$ 的串与 $B$ 排名相同的处于相同位置。\n\n### 子任务\n\n子任务 $1(31 \\mathrm{pts}) : n, m \\leq 100, q \\leq 1000$；\n\n子任务 $2(41 \\mathrm{pts}) : n, m \\leq 1000, q \\leq 5 \\times 10 ^ 4$；\n\n子任务 $3(78 \\mathrm{pts}) : n, m, q \\leq 10 ^ 5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] A Distant Past", "background": "When I was in the 6th grade, I learned Java and wrote a small game. It basically flung my math olympiad teacher’s head to hit frogs. Looks like I already understood mouha and P-head back then.\n\nNow I feel I didn’t understand a lot at the time and was just writing randomly. The program was full of if’s, yet I still finished it and even won a first prize in a science and innovation contest (it could add 5 points to the high school entrance exam, definitely not shady!).\n\nSo I’ve always felt I actually like doing creative things. This will show up later too.\n\nIn middle school, because I had learned some elementary olympiad math and also some math contest stuff, I felt the classes were plain and wasn’t very interested.\n\nI first encountered the informatics olympiad. It felt quite interesting, but I didn’t study it seriously.\n\nOur school had OI training, but they taught Pascal. Since I had already learned Java, I naturally thought that language was outdated and trash, so I didn’t really listen. I remember I took a selection test and there was a “chicken and rabbit in the same cage” problem. I wrote a solution using equations and got points deducted. The teacher’s official solution was something like while( a-- ) b++. Then I decided not to go anymore.\n\nIn the 8th grade I took the NOIP Junior group and only got 120. The second problem was expression evaluation. I spent a long time on it and kept failing, then that was it.\n\nAfter the exam I learned that several classmates were top 10 in the province. They seemed really strong. I was still very competitive back then, so I decided to study OI well and crush them in 9th grade.\n\nIn 9th grade I got 295 and got crushed by two 8th graders at the time, but I was the highest in 9th grade.\n\nThose two kids seem to have gone to Cha Yuan now. Truly legends.\n\nMiddle school felt quite fun. Although I had to play mind games with a toxic teacher every day, it was still interesting.\n\n[Remember to add images. Content: a screenshot of the small game, and the NOIP score.]\n\nSince this is Ynoi, not a place for the problem setter to write strange essays, you now need to do a data structure problem:", "description": "Little F decides to design a language with a huge character set — the Z language — even if extra characters are sometimes useless.\n\nFeatures of this language:\n- The character set is extremely large, possibly with $2147483648\\ (2^{31})$ distinct characters.\n- Each word is made of a sequence of pairwise distinct characters.\n- Characters can be compared for equality and order, so we will use numbers to represent the strange characters in the Z language.\n- Two words that look completely different can still be the same word because: as long as the positions of the $K$-th largest characters are the same in both words for every $K$, then they are essentially the same word. For example, $\\{1, 2, 3, 4, 5\\}$ and $\\{2, 3, 23, 233, 23333\\}$ are the same. (So you can conveniently use the Z language to encrypt information!)\n\nNow, Little F plans to apply the Z language to a real task. For example, he opens an algorithm problem on a computer:\n\n> Given two strings $A$ and $B$, find how many times $B$ is matched as a substring in $A$.\n\nLittle F knows this is a basic problem solvable with KMP. However, when implementing Z-KMP for matching in the Z language, he ran into trouble. Can you help him?\n\nTo verify you really understand what Little F means, he will modify string $B$ many times and ask you. No slacking!\n\nSee the input and output formats for the operations your program must support.", "inputFormat": "The first line contains two integers $n, m, q$ ($1 \\leq n, m, q \\leq 10^5$), the lengths of strings $A$ and $B$, and the number of operations.\n\nThe second line contains $n$ non-negative integers. The $i$-th is the $i$-th character $A_i$ of string $A$ ($0 \\leq A_i \\leq 2147483647 = 2^{31}-1$).\n\nThe third line contains $m$ non-negative integers. The $i$-th is the $i$-th character $B_i$ of string $B$ ($0 \\leq B_i \\leq 2147483647 = 2^{31}-1$).\n\nThen follow $q$ lines. Each line contains two positive integers $x_i, c_i$ ($1 \\leq c_i \\leq 2147483647 = 2^{31}-1$), meaning the character at position $x_i$ in $B$ is changed from $B_{x_i}$ to $c_i$.\n\nThe testdata guarantees that at any time, both $A$ and $B$ are valid Z strings that satisfy the above requirements.", "outputFormat": "After each modification, output the number of times $B$ is Z-matched as a substring in $A$.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477 (partially uploaded).\n\nSample 1 Explanation:\n- After the first modification, $\\{3, 5, 1\\}$ cannot be matched by any substring of $A$.\n- After the second modification, $\\{6, 5, 1\\}$ can be matched by every length-$3$ substring of $A$, because $A$ is strictly decreasing and $B$ is also strictly decreasing, so positions of characters with the same ranks coincide.\n\nSubtasks:\n- Subtask $1$ (31 pts): $n, m \\leq 100$, $q \\leq 1000$.\n- Subtask $2$ (41 pts): $n, m \\leq 1000$, $q \\leq 5 \\times 10^4$.\n- Subtask $3$ (78 pts): $n, m, q \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] 遥远的过去", "background": "小学六年级的时候学了JAVA，写了个小游戏，大概是把我奥数老师的头弹飞出去拿来打青蛙的，看来我小时候就懂膜蛤和P头了。\n\n现在感觉当时很多东西没理解，都在乱写，程序里面全是if，就这样还是写出来了，还拿了个科创大赛一等奖（可以加5分中考分的，可不算很野鸡！）\n\n所以一直感觉我其实是很喜欢做一些有创造性的东西的，这点之后也会体现出来。\n\n上了初中，因为之前学过点小学奥数，同时也有学一些数学竞赛的东西，所以感觉老师讲课都很平凡，没什么兴趣。\n\n第一次接触到了信息学竞赛，当时感觉还是挺有趣的，不过也没怎么认真学。\n\n学校里面有OI的培训，但由于学校里面在教Pascal，我当时已经学过JAVA了，自然觉得这个语言很落后，垃圾，所以也没怎么听课，印象中我去参加个选拔考试，有个鸡兔同笼的题，我写了个解方程被扣分了，老师给的正解是 while( a-- ) b++ 这样的东西，然后就决定不去了。\n\n初二考了一次NOIP普及组，当时只拿了120，第二题是个表达式求值，我写了很久很久都一直挂，然后就凉凉了。\n\n考完之后得知班上几个同学考了全省前10，感觉他们好强，当时还是很有好胜心的，于是决定好好学OI，初三打爆他们。\n\n初三的时候考了295，被两个当时初二的小朋友打爆了，不过我是初三里面最高分（\n\n那两个小朋友好像现在都去茶园了，果然是神仙。\n\n感觉初中还是挺好玩的，虽然天天和毒瘤老师斗智斗勇，但还是很有趣。\n\n【记得配图，内容：写的小游戏的截图，还有noip的成绩】\n\n由于这是Ynoi，不是出题人拿来写奇怪的文字的地方，所以你需要做一个数据结构题：", "description": "小 F 决定设计出一种字符集超大的语言——Z 语言，哪怕有时额外的字符并没有什么用。\n\n这种语言的特点是：\n\n* 字符集非常大，甚至可能有 $2147483648(2 ^ {31})$ 种字符；\n\n* 每个单词由一系列**两两不同**的字符组成；\n\n* 字符既能比较相同和不同，也能比较大小，因此之后我们用数字来表示 Z 语言中稀奇古怪的字符；\n\n* 两个看起来完全不同的单词也可能是同一个单词，因为：只要两个单词中第 K 大的字符所在的位置相同，那么其实就是本质上相同的单词。例如 $\\{1, 2, 3, 4, 5\\}$ 与 $\\{2, 3, 23, 233, 23333\\}$ 是相同的。（所以你可以用 Z 语言很方便地加密信息！）\n\n现在，小 F 打算将 Z 语言应用到实际中。比如，他点开了一道电脑里的算法题：\n\n> 给定两个字符串 $A, B$ ，求 $B$ 作为子串在 $A$ 中被匹配的次数。\n\n 小 F 当然知道这是一个可以用 KMP 解决的基础题。但是，他在用 Z 语言的匹配实现 Z-KMP 的时候遇到了问题，你能帮帮他吗？\n\n为了验证你是不是真的明白小 F 在说什么，小 F 会修改 $B$ 串很多次来问你。可不准偷懒哦！\n\n你的程序需要支持的操作详见输入输出格式。", "inputFormat": "输入第一行两个整数 $n, m, q(1 \\leq n, m, q \\leq 10 ^ 5)$，表示 $A, B$ 串的长度以及操作次数。\n\n第二行 $n$ 个非负整数，第 $i$ 个表示 $A$ 串的第 $i$ 个字符 $A_i$ $(0 \\leq A_i \\leq 2147483647=2 ^ {31} - 1)$。\n\n第三行 $m$ 个非负整数，第 $i$ 个表示 $B$ 串的第 $i$ 个字符 $B_i$ $(0 \\leq B_i \\leq 2147483647=2 ^ {31} - 1)$。 \n\n接下来 $q$ 行，每行两个正整数 $x_i, c_i$ $(1 \\leq c_i \\leq 2147483647=2 ^ {31} - 1)$，表示将 $B$ 串 $x_i$ 位置上的字符由 $B_{x_i}$ 改为 $c_i$。\n\n数据保证，任意时刻 $A$ 和 $B$ 均是满足前述要求的合法 Z 字符串。", "outputFormat": "**在每次修改完成后**，请输出 $B$ 作为子串在 $A$ 中被 Z-匹配 的次数。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477( partially uploaded )\n\n### 样例 1 解释\n\n在第一次修改后，$\\{3, 5, 1\\}$ 并不能被任何一个 $A$ 中的子串匹配上。\n\n在第二次修改后，$\\{6, 5, 1\\}$ 能被 $A$ 中所有长度为 $3$ 的串匹配上，原因是 A 是单调减的，而 B 也是单调减的，因此 $A$ 中所有长度为 $3$ 的串与 $B$ 排名相同的处于相同位置。\n\n### 子任务\n\n子任务 $1(31 \\mathrm{pts}) : n, m \\leq 100, q \\leq 1000$；\n\n子任务 $2(41 \\mathrm{pts}) : n, m \\leq 1000, q \\leq 5 \\times 10 ^ 4$；\n\n子任务 $3(78 \\mathrm{pts}) : n, m, q \\leq 10 ^ 5$。\n", "locale": "zh-CN"}}}
{"pid": "P5311", "type": "P", "difficulty": 7, "samples": [["5 4\n1 3 5 3 5\n1 2\n2 3\n3 4\n4 5\n1 5 1\n2 4 3\n3 4 3\n1 4 3", "3\n2\n2\n3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2011", "O2优化", "Ynoi"], "title": "[Ynoi2011] 成都七中", "background": "上初中的时候就听说成都七中非常厉害，我当时文化课成绩还不错，于是也想去成都七中。\n\n当时对高中的看法是什么样的我现在也无从得知了，但从模糊的感觉上大概是很憧憬的。\n\n我初三的时候想办法联系到了cdqz的竞赛教练林老师，然后获得了周末来旁听OI讲课的许可。\n\n还记得讲课的学长是集训队的于神，一开始就在给我们讲数据结构。cdqz明亮宽敞（当时的印象）的机房，和从未见过的beamer排版给我留下了深刻的印象。\n\n第一节课是树状数组，完全没听懂，现在感觉这个东西其实不适合一开始就讲，因为结构理解起来挺麻烦的，也不像线段树那样有一个非常直观的分治结构，而且代码经过特化非常精简，很容易谔谔。\n\n第二节课是线段树，这个听懂了一部分，感觉好神奇，但是讲到标记的部分我就无法理解了，讲完课写题，写了一个很长很丑的线段树，调了很久很久，半懂不懂地把题过了。\n\n当时在做vijos上面的题，看到小白逛公园的感觉就像是AMX-1357看到鼠爷一样。\n\n每天都有考试，考试的时候基本上啥都不会，只能写写暴力分骗分，每次评测的时候都看到学长们过了好多题，当时感觉非常羡慕。\n\n和我一起去cdqz听课的有一位zms，他初二拿了普及组省第一，初三考提高组差点拿了一等奖，我一直以他为竞争对手，每次考试的时候都在和他比划比划成绩，但基本上都是我输。\n\n【记得配图，内容：当时考试的成绩（大概找不到了），当时的PPT（大概找不到了），成都七中校门（这个有）】\n\n由于这是Ynoi，不是出题人拿来写无趣的文字的地方，所以你需要做一个数据结构题：", "description": "给你一棵 $n$ 个节点的树，每个节点有一种颜色，有 $m$ 次查询操作。\n\n查询操作给定参数 $l\\ r\\ x$，需输出：\n\n将树中编号在 $[l,r]$ 内的所有节点保留，$x$ 所在连通块中颜色种类数。\n\n每次查询操作独立。", "inputFormat": "第一行两个数 $n,m$。\n\n第二行 $n$ 个数表示每个节点的颜色。\n\n之后 $n-1$ 行，每行两个数 $x$ 和 $y$，表示 $x$ 和 $y$ 之间连有一条边。\n\n之后 $m$ 行，每行三个数 $l\\ r\\ x$，表示一次查询操作。", "outputFormat": "对每个查询操作，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：created_equal1，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，所有出现过的数在 $[1,10^5]$ 之间，保证每次输入的 $l \\le x \\le r$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] Chengdu No. 7 High School", "background": "When I was in middle school, I had heard that Chengdu No. 7 High School was very strong. My grades in regular classes were pretty good at that time, so I also wanted to go there.\n\nI do not really remember what I thought about high school back then, but from my vague impressions, I guess I really looked forward to it.\n\nIn my 9th grade, I found a way to contact Teacher Lin, the contest coach at cdqz, and got permission to sit in on OI lectures on weekends.\n\nI still remember the senior student who taught us was “Yu Shen” from the CTT. He started by teaching us data structures. The bright and spacious (as I remembered) computer room at cdqz, and the beamer style that I had never seen before, left a deep impression on me.\n\nThe first lesson was about the Binary Indexed Tree. I did not understand it at all. Now I feel that it is not suitable as the first topic, because the structure is quite hard to understand. It is also not like a segment tree with a very intuitive divide-and-conquer structure, and the code is highly specialized and very short, which makes it easy to get confused.\n\nThe second lesson was about the segment tree. I understood part of it and felt it was amazing, but when it got to the “lazy tag” part, I could not understand it anymore. After the lecture we did problems; I wrote a very long and ugly segment tree, debugged for a very long time, and somehow passed the problem while only half understanding it.\n\nAt that time I was doing problems on vijos. The feeling of seeing “Xiaobai Strolling in the Park” was like AMX-1357 seeing “Mouse Lord”.\n\nThere were exams every day. During exams I basically knew nothing, so I could only write brute force to get partial points. Every time during judging I saw the seniors solve many problems, and I felt very envious.\n\nOne person who went to cdqz with me was zms. He got 1st place in the province in the Junior group in 8th grade, and in 9th grade he almost got 1st prize in the Senior group. I always treated him as my competitor. In every exam I compared my score with his, but basically I always lost.\n\n[Remember to add pictures: the exam scores at that time (probably cannot find them), the PPT at that time (probably cannot find it), the school gate of Chengdu No. 7 High School (this one exists).]\n\nSince this is Ynoi, not a place for the problem setter to write boring text, you need to solve a data structure problem.", "description": "You are given a tree with $n$ nodes. Each node has a color. There are $m$ queries.\n\nEach query gives parameters $l\\ r\\ x$. You need to output:\n\nKeep all nodes whose indices are in $[l,r]$ in the tree. In the connected component that contains $x$, output the number of distinct colors.\n\nEach query is independent.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers representing the color of each node.\n\nThen follow $n-1$ lines. Each line contains two integers $x$ and $y$, indicating there is an edge between $x$ and $y$.\n\nThen follow $m$ lines. Each line contains three integers $l\\ r\\ x$, representing one query.", "outputFormat": "For each query, output one line with one integer, the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: created_equal1, Data: nzhtl1477.\n\nConstraints: For $100\\%$ of the testdata, all numbers that appear are in $[1,10^5]$, and it is guaranteed that for each query $l \\le x \\le r$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] 成都七中", "background": "上初中的时候就听说成都七中非常厉害，我当时文化课成绩还不错，于是也想去成都七中。\n\n当时对高中的看法是什么样的我现在也无从得知了，但从模糊的感觉上大概是很憧憬的。\n\n我初三的时候想办法联系到了cdqz的竞赛教练林老师，然后获得了周末来旁听OI讲课的许可。\n\n还记得讲课的学长是集训队的于神，一开始就在给我们讲数据结构。cdqz明亮宽敞（当时的印象）的机房，和从未见过的beamer排版给我留下了深刻的印象。\n\n第一节课是树状数组，完全没听懂，现在感觉这个东西其实不适合一开始就讲，因为结构理解起来挺麻烦的，也不像线段树那样有一个非常直观的分治结构，而且代码经过特化非常精简，很容易谔谔。\n\n第二节课是线段树，这个听懂了一部分，感觉好神奇，但是讲到标记的部分我就无法理解了，讲完课写题，写了一个很长很丑的线段树，调了很久很久，半懂不懂地把题过了。\n\n当时在做vijos上面的题，看到小白逛公园的感觉就像是AMX-1357看到鼠爷一样。\n\n每天都有考试，考试的时候基本上啥都不会，只能写写暴力分骗分，每次评测的时候都看到学长们过了好多题，当时感觉非常羡慕。\n\n和我一起去cdqz听课的有一位zms，他初二拿了普及组省第一，初三考提高组差点拿了一等奖，我一直以他为竞争对手，每次考试的时候都在和他比划比划成绩，但基本上都是我输。\n\n【记得配图，内容：当时考试的成绩（大概找不到了），当时的PPT（大概找不到了），成都七中校门（这个有）】\n\n由于这是Ynoi，不是出题人拿来写无趣的文字的地方，所以你需要做一个数据结构题：", "description": "给你一棵 $n$ 个节点的树，每个节点有一种颜色，有 $m$ 次查询操作。\n\n查询操作给定参数 $l\\ r\\ x$，需输出：\n\n将树中编号在 $[l,r]$ 内的所有节点保留，$x$ 所在连通块中颜色种类数。\n\n每次查询操作独立。", "inputFormat": "第一行两个数 $n,m$。\n\n第二行 $n$ 个数表示每个节点的颜色。\n\n之后 $n-1$ 行，每行两个数 $x$ 和 $y$，表示 $x$ 和 $y$ 之间连有一条边。\n\n之后 $m$ 行，每行三个数 $l\\ r\\ x$，表示一次查询操作。", "outputFormat": "对每个查询操作，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：created_equal1，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，所有出现过的数在 $[1,10^5]$ 之间，保证每次输入的 $l \\le x \\le r$。", "locale": "zh-CN"}}}
{"pid": "P5312", "type": "P", "difficulty": 6, "samples": [["5\n5 2 6 2 0\n5\n2 1 5\n1 2\n3 7\n2 2 6\n4", "15\n23"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2011", "O2优化", "Ynoi"], "title": "[Ynoi2011] 竞赛实验班", "background": "中考的时候好像是没什么实感的，随随便便就考上了cdqz，考前几天晚上还在偷偷用itouch看修仙小说。\n\n考上cdqz之后，我就天天去听OI课了，虽然不太听得懂，但反正也没事干。\n\n当时听于神介绍数据结构，他大概是这么写的：\n\n初级：树状数组，线段树\n\n中级：平衡树，可并堆，莫队\n\n高级：主席树，动态树\n\n前沿：动态仙人掌\n\n感觉有好多听起来就好厉害的树，还有“仙人掌”?数据结构真的是太厉害了（伏笔）！\n\n那一年cdqz突然决定搞一个竞赛实验班，专门搞竞赛，由于挺不喜欢文化课的，所以我决定去参加。\n\n想去竞赛班要经过一个学科夏令营的选拔，当时有个朋友f321dd觉得很毒瘤就跑路了，我还不太能理解，现在一定程度上能理解了。\n\n这个学科夏令营大概就是每天请不同学科的竞赛老师来讲课，数学，物理都不太感兴趣，所以上课就很无聊，无所事事的，经常偷偷跑去机房写点代码。\n\n仔细想想，我当时也对未来没什么打算，也谈不上有多热爱竞赛，也谈不上有多讨厌文化课，只是听说这个实验班好，可以上好大学，就去了，感觉和听到“学计算机挣钱多”而选择去计算机系的人差不多。\n\n不过大家不都是这样的吗。\n\n我最后进入了竞赛实验班，也认识了将要一起学习两年oi的大家，同时还进行了一次摸底考试，当时好像zms拿了350第一，我拿了310第二，记得我还用“动态spfa”水了个最短路题，看到AC的时候开心地叫了出来。\n\n当时的竞赛组：\n\nzms：初中同学，之前有提到，大家都叫他“小白”，感觉是一个挺稳重的人，是公认的我们那届OI最强选手，和yjq关系很好，被当时的我视为目标。\n\nf321dd：初中同学，朋友，初中经常一起逃课打牌（自己搞了个叫化学杀的东西），感觉是个有趣的人。\n\ngrh：四中来的，高高瘦瘦的，喜欢看本子和动画片。\n\nziliuziliu：四中来的，瘦瘦的，喜欢玩坦克世界，练了KV3这条线，天天AP打不穿WZ111，水平不错。\n\ncyz：喜欢玩坦克世界，印象中第一次看到他玩是在玩四号防空车，然后我觉得好玩也入坑了，水平挺高的，感觉经常无法理解他在想什么。\n\nFlaze：女oier，感觉挺可爱的。\n\nzyx：外地生，没学过oi。\n\ncx：胖胖的，会写oj。\n\nzqq：和Flaze一个初中的，感觉挺踏实的（最开始是这样的），什么知识点都会去学。\n\n学长：\n\nyjq：特别强，天天比赛早早做完AK。\n\nKarl_duan：感觉一直在学习，很踏实努力。\n\nzcy：特别会乱搞，平时也经常乱搞过题，NOIP暴力拿了600。\n\nmhy：集训队学长，瘦瘦的。\n\n写下这个回忆录的时候我还是挺有感触的，回忆起当时的事情让我很开心~\n\n学oi的那一阵子虽然我很菜，天天被吊打，但无疑还是快乐的。\n\n【记得配图，内容oj7】\n\n由于这是Ynoi，不是出题人拿来写怀旧的文字的地方，所以你需要做一个数据结构题：", "description": "有一个长度为 $n$ 的数组 $A$。下标从 $1$ 开始标号。有 $m$ 个操作需要处理，操作有如下四种：  \n1. 在数组 $A$ 的末尾添加一个数 $x$。  \n2. 输出 $\\sum_{i=l}^{r}A_i$。  \n3. 将数组 $A$ 中的每个数 $A_i$ 都改为 $A_i\\oplus x$。（$\\oplus$ 表示异或操作）。  \n4. 将数组 $A$ 从小到大排序。", "inputFormat": "第一行一个数 $n$ 表示 $A$ 的初始大小。  \n接下来一行 $n$ 个非负整数 $A_i$，表示 $A$ 的中的每个元素。  \n接下来一行一个数 表示询问的数量。  \n接下来 $m$ 行，每行表示一个操作：\n\n- `1 x`： 表示第一种操作，在末尾插入数 $x$。\n- `2 l r`：表示第二种操作，询问 $\\sum_{i=l}^{r}A_i$。保证有 $1\\le l\\le r\\le n'$，其中 $n'$ 为操作时刻序列的长度。\n- `3 x`：表示第三种操作，给每个数 $\\oplus$ 上 $x$。\n-  `4`：表示第四种操作，将数组 $A$ 排序。", "outputFormat": "对于每个第二种操作，输出答案。", "hint": "Idea：WJMZBMR，Solution：WJMZBMR，Code：WJMZBMR，Data：WJMZBMR\n\n$1\\le n,\\,m\\le 10^5, 0\\le x,A_i\\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] Contest Experimental Class", "background": "During the high school entrance exam, it felt like nothing special. I got into cdqz casually. A few nights before the exam, I was still secretly reading xianxia novels on an itouch.\n\nAfter getting into cdqz, I went to OI classes every day. I did not really understand much, but I had nothing else to do anyway.\n\nAt that time, I listened to Yu Shen introduce data structures, and he roughly wrote it like this:\n\nBeginner: Binary Indexed Tree, Segment Tree\n\nIntermediate: Balanced Tree, Mergeable Heap, Mo's Algorithm\n\nAdvanced: Persistent Segment Tree, Dynamic Tree\n\nFrontier: Dynamic Cactus\n\nIt felt like there were so many “trees” that sounded amazing, and even “cactus”? Data structures are really awesome (foreshadowing)!\n\nThat year, cdqz suddenly decided to set up a contest experimental class, focusing on competitions. Since I did not like cultural courses much, I decided to join.\n\nTo enter the contest class, you had to pass a selection summer camp for a subject. At that time, a friend f321dd felt it was very “toxic” and ran away. I did not quite understand then, but now I understand to some extent.\n\nThis summer camp was basically inviting different competition teachers every day to give lectures. I was not interested in math or physics, so the classes were boring. With nothing to do, I often sneaked into the computer room to write some code.\n\nThinking carefully, I had no real plan for the future back then. I cannot say I loved competitions a lot, and I cannot say I hated cultural courses a lot either. I just heard that this experimental class was good and could help you get into a good university, so I went. It felt similar to people choosing a CS major after hearing “computer science makes a lot of money”.\n\nBut is that not how everyone is?\n\nIn the end, I entered the contest experimental class and met everyone who would study OI together for the next two years. We also had a placement test. It seemed that zms got 350 and ranked first, and I got 310 and ranked second. I remember I used “dynamic spfa” to cheese a shortest path problem, and I shouted happily when I saw AC.\n\nThe contest group at that time:\n\nzms: A middle school classmate, mentioned before. Everyone called him “Xiao Bai”. He felt like a steady person, recognized as the strongest OI contestant of our grade, and he was close with yjq. I saw him as my goal at the time.\n\nf321dd: A middle school classmate and friend. In middle school we often skipped classes to play cards together (we even made something called “Chemistry Kill”). He felt like a funny person.\n\ngrh: Came from No. 4 Middle School, tall and thin, liked doujinshi and anime.\n\nziliuziliu: Came from No. 4 Middle School, thin, liked playing World of Tanks. He grinded the KV3 line, and his AP shells could not penetrate WZ111 every day. Pretty good skill.\n\ncyz: Also liked playing World of Tanks. I think the first time I saw him play, he was playing the Wirbelwind. I thought it was fun and also started playing. He was quite strong, and I often could not understand what he was thinking.\n\nFlaze: A female OIer, seemed pretty cute.\n\nzyx: A student from another place, had not learned OI before.\n\ncx: Chubby, could write an OJ.\n\nzqq: From the same middle school as Flaze, seemed very down-to-earth (at first it was like that). He would learn every knowledge point.\n\nSeniors:\n\nyjq: Extremely strong, always finished contests early and AK.\n\nKarl_duan: Felt like he was always studying, very steady and hardworking.\n\nzcy: Very good at messing around, and often solved problems in a messy way. In NOIP he got 600 with brute force.\n\nmhy: A senior from the National Training Team, thin.\n\nWhen writing this memoir, I still feel quite emotional. Remembering what happened back then makes me very happy~\n\nDuring that period of learning OI, although I was very weak and got crushed every day, it was undoubtedly still fun.\n\n[Remember to add pictures, content oj7]\n\nSince this is Ynoi, not a place for the author to write nostalgic text, you need to solve a data structure problem:", "description": "There is an array $A$ of length $n$, indexed starting from $1$. You need to process $m$ operations of the following four types:  \n1. Append a number $x$ to the end of array $A$.  \n2. Output $\\sum_{i=l}^{r}A_i$.  \n3. Change every number $A_i$ in array $A$ to $A_i\\oplus x$. ($\\oplus$ denotes the XOR operation.)  \n4. Sort array $A$ in non-decreasing order.", "inputFormat": "The first line contains an integer $n$, the initial size of $A$.  \nThe next line contains $n$ non-negative integers $A_i$, representing each element in $A$.  \nThe next line contains an integer $m$, the number of operations.  \nThe next $m$ lines each describe one operation:\n\n- `1 x`: the first operation, append $x$ to the end.\n- `2 l r`: the second operation, query $\\sum_{i=l}^{r}A_i$. It is guaranteed that $1\\le l\\le r\\le n'$, where $n'$ is the length of the sequence at the time of the operation.\n- `3 x`: the third operation, XOR every element with $x$.\n- `4`: the fourth operation, sort array $A$.", "outputFormat": "For each operation of the second type, output the answer.", "hint": "Idea: WJMZBMR, Solution: WJMZBMR, Code: WJMZBMR, Data: WJMZBMR\n\n$1\\le n,\\,m\\le 10^5, 0\\le x,A_i\\le 10^9$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] 竞赛实验班", "background": "中考的时候好像是没什么实感的，随随便便就考上了cdqz，考前几天晚上还在偷偷用itouch看修仙小说。\n\n考上cdqz之后，我就天天去听OI课了，虽然不太听得懂，但反正也没事干。\n\n当时听于神介绍数据结构，他大概是这么写的：\n\n初级：树状数组，线段树\n\n中级：平衡树，可并堆，莫队\n\n高级：主席树，动态树\n\n前沿：动态仙人掌\n\n感觉有好多听起来就好厉害的树，还有“仙人掌”?数据结构真的是太厉害了（伏笔）！\n\n那一年cdqz突然决定搞一个竞赛实验班，专门搞竞赛，由于挺不喜欢文化课的，所以我决定去参加。\n\n想去竞赛班要经过一个学科夏令营的选拔，当时有个朋友f321dd觉得很毒瘤就跑路了，我还不太能理解，现在一定程度上能理解了。\n\n这个学科夏令营大概就是每天请不同学科的竞赛老师来讲课，数学，物理都不太感兴趣，所以上课就很无聊，无所事事的，经常偷偷跑去机房写点代码。\n\n仔细想想，我当时也对未来没什么打算，也谈不上有多热爱竞赛，也谈不上有多讨厌文化课，只是听说这个实验班好，可以上好大学，就去了，感觉和听到“学计算机挣钱多”而选择去计算机系的人差不多。\n\n不过大家不都是这样的吗。\n\n我最后进入了竞赛实验班，也认识了将要一起学习两年oi的大家，同时还进行了一次摸底考试，当时好像zms拿了350第一，我拿了310第二，记得我还用“动态spfa”水了个最短路题，看到AC的时候开心地叫了出来。\n\n当时的竞赛组：\n\nzms：初中同学，之前有提到，大家都叫他“小白”，感觉是一个挺稳重的人，是公认的我们那届OI最强选手，和yjq关系很好，被当时的我视为目标。\n\nf321dd：初中同学，朋友，初中经常一起逃课打牌（自己搞了个叫化学杀的东西），感觉是个有趣的人。\n\ngrh：四中来的，高高瘦瘦的，喜欢看本子和动画片。\n\nziliuziliu：四中来的，瘦瘦的，喜欢玩坦克世界，练了KV3这条线，天天AP打不穿WZ111，水平不错。\n\ncyz：喜欢玩坦克世界，印象中第一次看到他玩是在玩四号防空车，然后我觉得好玩也入坑了，水平挺高的，感觉经常无法理解他在想什么。\n\nFlaze：女oier，感觉挺可爱的。\n\nzyx：外地生，没学过oi。\n\ncx：胖胖的，会写oj。\n\nzqq：和Flaze一个初中的，感觉挺踏实的（最开始是这样的），什么知识点都会去学。\n\n学长：\n\nyjq：特别强，天天比赛早早做完AK。\n\nKarl_duan：感觉一直在学习，很踏实努力。\n\nzcy：特别会乱搞，平时也经常乱搞过题，NOIP暴力拿了600。\n\nmhy：集训队学长，瘦瘦的。\n\n写下这个回忆录的时候我还是挺有感触的，回忆起当时的事情让我很开心~\n\n学oi的那一阵子虽然我很菜，天天被吊打，但无疑还是快乐的。\n\n【记得配图，内容oj7】\n\n由于这是Ynoi，不是出题人拿来写怀旧的文字的地方，所以你需要做一个数据结构题：", "description": "有一个长度为 $n$ 的数组 $A$。下标从 $1$ 开始标号。有 $m$ 个操作需要处理，操作有如下四种：  \n1. 在数组 $A$ 的末尾添加一个数 $x$。  \n2. 输出 $\\sum_{i=l}^{r}A_i$。  \n3. 将数组 $A$ 中的每个数 $A_i$ 都改为 $A_i\\oplus x$。（$\\oplus$ 表示异或操作）。  \n4. 将数组 $A$ 从小到大排序。", "inputFormat": "第一行一个数 $n$ 表示 $A$ 的初始大小。  \n接下来一行 $n$ 个非负整数 $A_i$，表示 $A$ 的中的每个元素。  \n接下来一行一个数 表示询问的数量。  \n接下来 $m$ 行，每行表示一个操作：\n\n- `1 x`： 表示第一种操作，在末尾插入数 $x$。\n- `2 l r`：表示第二种操作，询问 $\\sum_{i=l}^{r}A_i$。保证有 $1\\le l\\le r\\le n'$，其中 $n'$ 为操作时刻序列的长度。\n- `3 x`：表示第三种操作，给每个数 $\\oplus$ 上 $x$。\n-  `4`：表示第四种操作，将数组 $A$ 排序。", "outputFormat": "对于每个第二种操作，输出答案。", "hint": "Idea：WJMZBMR，Solution：WJMZBMR，Code：WJMZBMR，Data：WJMZBMR\n\n$1\\le n,\\,m\\le 10^5, 0\\le x,A_i\\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P5313", "type": "P", "difficulty": 7, "samples": [["6\n1 1 4 5 1 4\n3\n1 6 1\n2 3 3\n3 4 1", "0\n2\n0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "O2优化", "Ynoi"], "title": "[Ynoi2011] WBLT", "background": "时间大概在学科夏令营那段时间：\n\n当时信息组的其他几个还有新高二的同学都开始学splay了，每天听到zms和yjq（一个学长，很强）讨论splay，还戏称为\"spaly\"，就感觉很紧张，他们怎么学这么厉害的东西，我还完全不了解。\n\n然后我上网查了查splay，看到几百行的代码，看到什么zig，zag，势能分析（所以说写的这么丑的博客为什么会排前几），就感觉这个东西无法理解，大概看了看也没看懂。\n\n去问了问于神splay的功能是什么——“插入，删除，查询第k小”\n\n反正天天也无聊，于是就想了想：\n\n线段树可以查第k小，只需要让其叶子sorted即可。\n\n所以线段树是不是也能做？\n\n但是我们的线段树是一个静态的结构（当时的想法），这个东西要动态化才行，不然如何插入删除？\n\n线段树维护了每个点的区间，这个东西是静态的，也就是问题所在，我们考虑如何动态化这个东西：\n\n插入一个节点的时候，如果找到了插入位置，那么一定是一个叶子，我们可以给这个节点新建两个叶子的儿子。\n\n可以发现这个插入位置后面的所有节点都进行了平移，于是我们可以考虑对这个进行打标记来维护，称为平移标记，每次push_down平移标记来实现动态化。\n\n每次删除的时候可以使用其兄弟来代替被删除的节点，同理需要进行平移标记的维护。\n\n查询的时候先push_down平移标记，然后考虑是否进入左儿子即可。\n\n可以发现这样的结构在插入链式数据下复杂度会有问题，考虑如何平衡。\n\n我当时第一个想到的是设定一个ratio，使得左右儿子的比例在ratio之内，否则暴力重构，写了写发现好像是对的，去问于神，然后他说这个就是“替罪羊树”......\n\n诶所以我自己发明平衡树了？\n\n这么看来平衡树很简单啊。\n\n这么看来我很强啊（错觉）。\n\n然后我就一直按这个思路想下去了，想了很多种奇怪的写法，比如不平衡的时候合并一下，或者按中点分裂什么的。\n\n我乱写了一个策略，通过了平衡树模板题，但是当时写的非常复杂，因为我维护了父亲，而且写法未经过优化。\n\n后来发现不需要所谓的平移标记，可以直接维护size，这样可以按相对位置二分下去，减少了很多代码量。\n\n发现可以不存father，减少了很多代码量。\n\n又发现这个树也是可以”旋转“的，我们将旋转定义为合并两个节点即可（所以我看到说什么”无旋treap不用旋转，和treap不一样“的言论都感觉很谔谔，因为本身就是等价操作，同一个东西写出来不一样而已）。\n\n同时也是可以分裂的，这里我分裂定义为了经过 $O( logn )$ 次旋转使得根的左儿子的右儿子是我们需要的区间。\n\n我发现我设计出的平衡树的确是可以支持所有操作的，复杂度也都是 $O( logn )$ ，而且个人认为这个很好写。\n\n所以我发明平衡树了？\n\n当时起了个名字“自平衡线段树”——“Self Balancing Segment Tree”，虽然后来查了很久发现其实是把两个OI界中未引入的东西结合在了一起，应该叫做“Weight Balanced Leafy Tree”\n\n刚做出来的时候觉得这个是很重要的东西，于是对其他人都藏着掖着，生怕同学们学到我的技术，因为我当时也知道，省队就5个名额，同学都是我的竞争对手。\n\n当时mhy听说我的平衡树很强，就问我能不能10分钟写出来，我接受了挑战，然后还真的写出来了，得到了集训队爷的认可+1\n\n当时就对自己充满了自信，我都能发明这么强的一个数据结构，那进集训队保送清华北大还不是随手的事情吗（flag）。\n\n【记得配图，WBLT的】\n\n由于这是Ynoi，不是出题人拿来写装逼的文字的地方，所以你需要做一个数据结构题：", "description": "给你一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n每次查询操作给定参数 $l,r,b$，需输出最大的 $x$，使得存在一个 $a$，满足 $0\\leq a<b$，使得 $a,a+b,a+2b,\\ldots,a+(x-1)b$ 都在区间 $[l,r]$ 内至少出现过一次。\n\n如果不存在 $[0,b-1]$ 内的数，则输出 $0$。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示这个序列。\n\n第三行一个整数 $m$。\n\n之后 $m$ 行，每行三个整数 $l,r,b$，表示一次查询操作。", "outputFormat": "对于每个查询操作，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078&Forever_Pursuit\n\n对于 $30\\%$ 的数据，所有出现过的数在 $[0,1000]$ 之间。\n\n对于另外 $30\\%$ 的数据，$b \\leq 1000$。\n\n对于 $100\\%$ 的数据，所有出现过的数在 $[0,10^5]$ 之间。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] WBLT", "background": "The time was probably around the subject summer camp period.\n\nBack then, several other students in the informatics group, as well as some new 11th graders, had started learning splay. Every day I heard zms and yjq (a senior student, very strong) discussing splay, and they even jokingly called it \"spaly\". It made me feel nervous: how could they be learning something so hard while I still knew nothing about it?\n\nThen I searched for splay online. I saw several hundred lines of code, things like zig, zag, potential analysis (so why do such ugly blogs rank so high), and felt that this thing was impossible to understand. I skimmed it but did not understand anything.\n\nI went to ask what splay could do. The answer was: \"insert, delete, query the $k$-th smallest\".\n\nAnyway, I was bored every day, so I thought about it.\n\nA segment tree can query the $k$-th smallest, as long as its leaves are sorted.\n\nSo can a segment tree do it too?\n\nBut our segment tree is a static structure (that was my thinking at the time). It has to become dynamic, otherwise how can we insert and delete?\n\nA segment tree maintains the interval of each node, which is static. That is the core problem, so we consider how to make it dynamic.\n\nWhen inserting a node, if we find the insertion position, it must be a leaf. We can create two new leaf children for this node.\n\nWe can see that all nodes after this insertion position are shifted. So we can consider using a tag to maintain this, called a shift tag. Each time we `push_down` the shift tag to achieve dynamization.\n\nWhen deleting, we can use its sibling to replace the deleted node. Similarly, we need to maintain the shift tag.\n\nWhen querying, first `push_down` the shift tag, then decide whether to go into the left child.\n\nWe can see that this structure will have complexity problems under chain-like insertion data, so we consider how to balance it.\n\nThe first thing I thought of was setting a ratio so that the proportion of left and right subtrees stays within the ratio; otherwise, we rebuild by brute force. I wrote it and it seemed correct, then I asked Yu-shen, and he said this is a \"Scapegoat Tree\"...\n\nSo I invented a balanced tree myself?\n\nIn that case, balanced trees are quite simple.\n\nIn that case, I am very strong (an illusion).\n\nThen I kept thinking along this line and came up with many strange implementations, such as merging when unbalanced, or splitting by midpoint, and so on.\n\nI wrote a random strategy and passed the balanced tree template problem, but it was very complex at the time because I maintained the parent pointer and the implementation was not optimized.\n\nLater I found that the so-called shift tag was not needed. We can directly maintain `size`, so we can binary search downward by relative position, reducing a lot of code.\n\nI also found that we do not need to store `father`, reducing a lot of code.\n\nI further found that this tree can also be \"rotated\". We can define rotation as merging two nodes (so whenever I see claims like \"rotationless treap does not need rotation, unlike treap\", I feel quite speechless, because it is essentially an equivalent operation. It is the same thing, just written differently).\n\nIt can also be split. Here I defined splitting as performing $O( logn )$ rotations so that the right child of the root's left child becomes the interval we need.\n\nI found that the balanced tree I designed can indeed support all operations, the complexity is also $O( logn )$, and personally I think it is very easy to write.\n\nSo I invented a balanced tree?\n\nAt that time I gave it a name, \"Self Balancing Segment Tree\". Later, after searching for a long time, I found that it was actually a combination of two things that were not introduced into the OI community. It should be called \"Weight Balanced Leafy Tree\".\n\nWhen I first made it, I thought it was very important, so I hid it from others, afraid that my classmates would learn my technique. I also knew that there were only 5 spots in the provincial team, and my classmates were my competitors.\n\nAt that time, mhy heard that my balanced tree was very strong and asked whether I could write it in 10 minutes. I accepted the challenge, and I actually wrote it out, earning +1 recognition from the CTT seniors.\n\nAt that time I was full of confidence. If I could invent such a strong data structure, then getting into the CTT and being recommended to Tsinghua or Peking University would be easy (a flag).\n\n[Remember to add an illustration, for WBLT.]\n\nSince this is Ynoi, not a place for the problem setter to write show-off text, you need to solve a data structure problem.", "description": "You are given a sequence of length $n$, with $m$ query operations.\n\nEach query gives parameters $l,r,b$. You need to output the maximum $x$ such that there exists an $a$ with $0\\leq a<b$ satisfying that $a,a+b,a+2b,\\ldots,a+(x-1)b$ have all appeared at least once within the interval $[l,r]$.\n\nIf no number in $[0,b-1]$ exists, output $0$.", "inputFormat": "The first line contains an integer $n$.\n\nThe second line contains $n$ integers representing the sequence.\n\nThe third line contains an integer $m$.\n\nThen follow $m$ lines, each containing three integers $l,r,b$, representing one query operation.", "outputFormat": "For each query operation, output one line with one integer representing the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: ccz181078, Data: ccz181078&Forever_Pursuit.\n\nFor $30\\%$ of the testdata, all numbers that appear are within $[0,1000]$.\n\nFor another $30\\%$ of the testdata, $b \\leq 1000$.\n\nFor $100\\%$ of the testdata, all numbers that appear are within $[0,10^5]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] WBLT", "background": "时间大概在学科夏令营那段时间：\n\n当时信息组的其他几个还有新高二的同学都开始学splay了，每天听到zms和yjq（一个学长，很强）讨论splay，还戏称为\"spaly\"，就感觉很紧张，他们怎么学这么厉害的东西，我还完全不了解。\n\n然后我上网查了查splay，看到几百行的代码，看到什么zig，zag，势能分析（所以说写的这么丑的博客为什么会排前几），就感觉这个东西无法理解，大概看了看也没看懂。\n\n去问了问于神splay的功能是什么——“插入，删除，查询第k小”\n\n反正天天也无聊，于是就想了想：\n\n线段树可以查第k小，只需要让其叶子sorted即可。\n\n所以线段树是不是也能做？\n\n但是我们的线段树是一个静态的结构（当时的想法），这个东西要动态化才行，不然如何插入删除？\n\n线段树维护了每个点的区间，这个东西是静态的，也就是问题所在，我们考虑如何动态化这个东西：\n\n插入一个节点的时候，如果找到了插入位置，那么一定是一个叶子，我们可以给这个节点新建两个叶子的儿子。\n\n可以发现这个插入位置后面的所有节点都进行了平移，于是我们可以考虑对这个进行打标记来维护，称为平移标记，每次push_down平移标记来实现动态化。\n\n每次删除的时候可以使用其兄弟来代替被删除的节点，同理需要进行平移标记的维护。\n\n查询的时候先push_down平移标记，然后考虑是否进入左儿子即可。\n\n可以发现这样的结构在插入链式数据下复杂度会有问题，考虑如何平衡。\n\n我当时第一个想到的是设定一个ratio，使得左右儿子的比例在ratio之内，否则暴力重构，写了写发现好像是对的，去问于神，然后他说这个就是“替罪羊树”......\n\n诶所以我自己发明平衡树了？\n\n这么看来平衡树很简单啊。\n\n这么看来我很强啊（错觉）。\n\n然后我就一直按这个思路想下去了，想了很多种奇怪的写法，比如不平衡的时候合并一下，或者按中点分裂什么的。\n\n我乱写了一个策略，通过了平衡树模板题，但是当时写的非常复杂，因为我维护了父亲，而且写法未经过优化。\n\n后来发现不需要所谓的平移标记，可以直接维护size，这样可以按相对位置二分下去，减少了很多代码量。\n\n发现可以不存father，减少了很多代码量。\n\n又发现这个树也是可以”旋转“的，我们将旋转定义为合并两个节点即可（所以我看到说什么”无旋treap不用旋转，和treap不一样“的言论都感觉很谔谔，因为本身就是等价操作，同一个东西写出来不一样而已）。\n\n同时也是可以分裂的，这里我分裂定义为了经过 $O( logn )$ 次旋转使得根的左儿子的右儿子是我们需要的区间。\n\n我发现我设计出的平衡树的确是可以支持所有操作的，复杂度也都是 $O( logn )$ ，而且个人认为这个很好写。\n\n所以我发明平衡树了？\n\n当时起了个名字“自平衡线段树”——“Self Balancing Segment Tree”，虽然后来查了很久发现其实是把两个OI界中未引入的东西结合在了一起，应该叫做“Weight Balanced Leafy Tree”\n\n刚做出来的时候觉得这个是很重要的东西，于是对其他人都藏着掖着，生怕同学们学到我的技术，因为我当时也知道，省队就5个名额，同学都是我的竞争对手。\n\n当时mhy听说我的平衡树很强，就问我能不能10分钟写出来，我接受了挑战，然后还真的写出来了，得到了集训队爷的认可+1\n\n当时就对自己充满了自信，我都能发明这么强的一个数据结构，那进集训队保送清华北大还不是随手的事情吗（flag）。\n\n【记得配图，WBLT的】\n\n由于这是Ynoi，不是出题人拿来写装逼的文字的地方，所以你需要做一个数据结构题：", "description": "给你一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n每次查询操作给定参数 $l,r,b$，需输出最大的 $x$，使得存在一个 $a$，满足 $0\\leq a<b$，使得 $a,a+b,a+2b,\\ldots,a+(x-1)b$ 都在区间 $[l,r]$ 内至少出现过一次。\n\n如果不存在 $[0,b-1]$ 内的数，则输出 $0$。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示这个序列。\n\n第三行一个整数 $m$。\n\n之后 $m$ 行，每行三个整数 $l,r,b$，表示一次查询操作。", "outputFormat": "对于每个查询操作，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078&Forever_Pursuit\n\n对于 $30\\%$ 的数据，所有出现过的数在 $[0,1000]$ 之间。\n\n对于另外 $30\\%$ 的数据，$b \\leq 1000$。\n\n对于 $100\\%$ 的数据，所有出现过的数在 $[0,10^5]$ 之间。", "locale": "zh-CN"}}}
{"pid": "P5314", "type": "P", "difficulty": 7, "samples": [["5 5\n3 4 3 1 3\n1 2\n1 3\n2 4\n3 5\n2 1 3\n2 1 1\n1 1 1 1\n2 1 3\n1 4 1 1\n", "4\n3\n4\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2011", "O2优化", "Ynoi"], "title": "[Ynoi2011] ODT", "background": " 【先咕咕咕", "description": "给你一棵树，边权为 $1$，有点权。\n\n需要支持两个操作：\n\n- `1 x y z`：表示把树上 $x$ 到 $y$ 这条简单路径的所有点点权都加上 $z$。\n- `2 x y`：表示查询与点 $x$ 距离**小于等于** $1$ 的所有点里面的第 $y$ 小点权。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示每个点的点权。\n\n之后 $n-1$ 行，每行两个整数 $x,y$ 表示 $x$ 和 $y$ 之间连有一条边。\n\n之后 $m$ 行，每行为 `1 x y z` 或者 `2 x y` 形式，意义如上述。", "outputFormat": "对每个 2 操作输出一行，每行一个整数表示答案。\n\n数据保证每次询问都存在答案。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477( $O( n\\log^2n/ \\log\\log n )$ solution )，negiizhao( $O( n\\log n\\log\\log\\log n )$ solution )，ccz181078( $O( n\\log n )$ solution )，\n\nCode：nzhtl1477( $O( n\\log^2 n/ \\log\\log n )$ code )\n\nData：nzhtl1477( partially uploaded )\n\nsubtask 1：$20\\%$ $n,m\\leq 1000$。\n\nsubtask 2：$10\\%$ 树为一条链。\n\nsubtask 3：$20\\%$ $n,m\\leq 10^5$。\n\nsubtask 4：$30\\%$ $n,m\\leq 4\\times 10^5$。\n\nsubtask 5：$20\\%$ $n,m\\leq 10^6$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^6$，$0\\leq $ 每次加的数 $\\leq 2000$，$0\\leq $ 初始的点权 $\\leq 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2011] ODT", "background": "To be updated.", "description": "You are given a tree where each edge has weight $1$, and each node has a weight.\n\nSupport two operations:\n- `1 x y z`: Add $z$ to the weights of all nodes on the simple path from $x$ to $y$.\n- `2 x y`: Query the $y$-th smallest node weight among all nodes whose distance to node $x$ is less than or equal to $1$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains $n$ integers, the weight of each node.\n\nThen follow $n-1$ lines, each containing two integers $x, y$ indicating that there is an edge between $x$ and $y$.\n\nThen follow $m$ lines, each in the form `1 x y z` or `2 x y`, as described above.", "outputFormat": "For each operation of type $2$, output one line with one integer, the answer.\n\nIt is guaranteed that the answer exists for every query.", "hint": "- Idea: nzhtl1477.\n- Solution: nzhtl1477 ( $O( n\\log^2 n / \\log\\log n )$ solution ), negiizhao ( $O( n\\log n\\log\\log\\log n )$ solution ), ccz181078 ( $O( n\\log n )$ solution ).\n- Code: nzhtl1477 ( $O( n\\log^2 n / \\log\\log n )$ code ).\n- Data: nzhtl1477 ( partially uploaded ).\n\nSubtask 1: $20\\%$ $n, m \\leq 1000$.\n\nSubtask 2: $10\\%$ the tree is a chain.\n\nSubtask 3: $20\\%$ $n, m \\leq 10^5$.\n\nSubtask 4: $30\\%$ $n, m \\leq 4\\times 10^5$.\n\nSubtask 5: $20\\%$ $n, m \\leq 10^6$.\n\nConstraints: For $100\\%$ of the testdata, $1 \\leq n, m \\leq 10^6$, $0 \\leq$ the value added in each update $\\leq 2000$, $0 \\leq$ the initial node weights $\\leq 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2011] ODT", "background": " 【先咕咕咕", "description": "给你一棵树，边权为 $1$，有点权。\n\n需要支持两个操作：\n\n- `1 x y z`：表示把树上 $x$ 到 $y$ 这条简单路径的所有点点权都加上 $z$。\n- `2 x y`：表示查询与点 $x$ 距离**小于等于** $1$ 的所有点里面的第 $y$ 小点权。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示每个点的点权。\n\n之后 $n-1$ 行，每行两个整数 $x,y$ 表示 $x$ 和 $y$ 之间连有一条边。\n\n之后 $m$ 行，每行为 `1 x y z` 或者 `2 x y` 形式，意义如上述。", "outputFormat": "对每个 2 操作输出一行，每行一个整数表示答案。\n\n数据保证每次询问都存在答案。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477( $O( n\\log^2n/ \\log\\log n )$ solution )，negiizhao( $O( n\\log n\\log\\log\\log n )$ solution )，ccz181078( $O( n\\log n )$ solution )，\n\nCode：nzhtl1477( $O( n\\log^2 n/ \\log\\log n )$ code )\n\nData：nzhtl1477( partially uploaded )\n\nsubtask 1：$20\\%$ $n,m\\leq 1000$。\n\nsubtask 2：$10\\%$ 树为一条链。\n\nsubtask 3：$20\\%$ $n,m\\leq 10^5$。\n\nsubtask 4：$30\\%$ $n,m\\leq 4\\times 10^5$。\n\nsubtask 5：$20\\%$ $n,m\\leq 10^6$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^6$，$0\\leq $ 每次加的数 $\\leq 2000$，$0\\leq $ 初始的点权 $\\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P5315", "type": "P", "difficulty": 2, "samples": [["3 5 10\n12 3\n7 8\n5 5\n", "Too Young\nToo Simple\nSometimes Naive"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "洛谷月赛"], "title": "头像上传", "background": "", "description": "有一天无聊的你在注册一个无聊的网站，注册完的第一步自然是上传头像。\n\n你发现这个网站总共可以上传 $n$ 个头像，每个头像必须是正方形，并且长宽至少为 $L \\times L$\n\n在图片上传前，系统会对图片进行如下处理：如果图片的任何一边长度超过了 $G$ ，那么系统会不断地对图片的长宽同时减半（向下取整），直至两边长度 $\\leq G$ 为止。\n\n你现在找到了 $n$ 张可供上传的图片，第 $i$ 张的尺寸是 $W_i \\times H_i$。\n\n如果图片有任何一边小于 $L$，请输出 \"Too Young\"\n \n如果图片满足大小条件但不为正方形，请输出\"Too Simple\"\n\n如果图片满足大小条件并且是正方形，请输出\"Sometimes Naive\" \n\n以上所有字符串输出时均不包含引号。", "inputFormat": "一行三个整数 $n,L,G$，意义如题目所述。\n\n接下来每行两个整数 $W_i,H_i$，表示图片长宽。", "outputFormat": "共 $n$ 行，每行一个字符串，意义如题目所述。 ", "hint": "对于 $30\\%$ 的数据，满足 $n=1$\n\n对于 $100\\%$的数据，满足 $n \\leq 2000$，$W_i,H_i ,G\\leq 10000$", "locale": "zh-CN", "translations": {"en": {"title": "Avatar Upload", "background": "", "description": "One day, out of boredom, you register on a boring website. The first step after registration is naturally to upload an avatar.\n\nYou find that this website allows you to upload a total of $n$ avatars. Each avatar must be a square, and its side length must be at least $L \\times L$.\n\nBefore an image is uploaded, the system processes it as follows: if any side length of the image exceeds $G$, the system will repeatedly halve both the width and height at the same time (rounding down) until both side lengths are $\\leq G$.\n\nNow you have found $n$ images that can be uploaded. The $i$-th image has size $W_i \\times H_i$.\n\nIf any side of the image is less than $L$, output \"Too Young\".\n\nIf the image meets the size requirement but is not a square, output \"Too Simple\".\n\nIf the image meets the size requirement and is a square, output \"Sometimes Naive\".\n\nAll the above strings should be printed without quotes.", "inputFormat": "One line contains three integers $n, L, G$, with the meanings as described in the statement.\n\nEach of the next lines contains two integers $W_i, H_i$, representing the width and height of the image.", "outputFormat": "Output $n$ lines in total, each line containing one string, with the meanings as described in the statement.", "hint": "For $30\\%$ of the testdata, $n = 1$.\n\nFor $100\\%$ of the testdata, $n \\leq 2000$ and $W_i, H_i, G \\leq 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "头像上传", "background": "", "description": "有一天无聊的你在注册一个无聊的网站，注册完的第一步自然是上传头像。\n\n你发现这个网站总共可以上传 $n$ 个头像，每个头像必须是正方形，并且长宽至少为 $L \\times L$\n\n在图片上传前，系统会对图片进行如下处理：如果图片的任何一边长度超过了 $G$ ，那么系统会不断地对图片的长宽同时减半（向下取整），直至两边长度 $\\leq G$ 为止。\n\n你现在找到了 $n$ 张可供上传的图片，第 $i$ 张的尺寸是 $W_i \\times H_i$。\n\n如果图片有任何一边小于 $L$，请输出 \"Too Young\"\n \n如果图片满足大小条件但不为正方形，请输出\"Too Simple\"\n\n如果图片满足大小条件并且是正方形，请输出\"Sometimes Naive\" \n\n以上所有字符串输出时均不包含引号。", "inputFormat": "一行三个整数 $n,L,G$，意义如题目所述。\n\n接下来每行两个整数 $W_i,H_i$，表示图片长宽。", "outputFormat": "共 $n$ 行，每行一个字符串，意义如题目所述。 ", "hint": "对于 $30\\%$ 的数据，满足 $n=1$\n\n对于 $100\\%$的数据，满足 $n \\leq 2000$，$W_i,H_i ,G\\leq 10000$", "locale": "zh-CN"}}}
{"pid": "P5316", "type": "P", "difficulty": 5, "samples": [["1 3\n4 6 2\n48 144 36", "16 12 18"], ["2 4\n4 2 4 6 4 2\n48 144 16 36 12 36\n1 1 1 1 2 1 \n56 63 70 72 40 90 ", "16 12 18 4\n7 8 9 10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数论", "Special Judge", "洛谷月赛"], "title": "恋恋的数学题", "background": "恋恋是个可爱的女孩子，最近她沉迷了做数学题。", "description": "现在恋恋正在处理的题目十分简单：现在有$k \\space (2\\leq k\\leq 4)$个数，恋恋不知道它们分别是几，只知道它们**两两**最大公约数及最小公倍数。\n\n按照套路，恋恋非常想复原出那$k$个数，但是现在她需要假装不会做，于是她就把题目交给了你，如果你顺利解决了这个问题，恋恋就会在你背后疯狂打call……", "inputFormat": "第一行，两个整数$T$和$k$\n\n接下来$2T$行包含$T$组数据，每组数据包含两行，\n\n第一行，$\\frac{k(k-1)}2$个整数，表示$k$个未知数的两两最大公约数，乱序\n\n第二行，$\\frac{k(k-1)}2$个整数，表示$k$个未知数的两两最小公倍数，乱序", "outputFormat": "输出$T$行，每行$k$个用空格分隔的数，表示**任意一组**符合对应数据的答案。", "hint": "**保证奇数测试点中，第一行（gcd行）数据均为$1$**\n\n|测试点编号　　　|$k$　　　|输入整数不超过　　　|\n|-|-|-|\n|1,2|2|$100$|\n|3,4|2|$1000$|\n|5,6|2|$10^7$|\n|7,8|3|$100$|\n|9,10|3|$10^7$|\n|11,12|3|$10^{14}$|\n|13,14|4|$100$|\n|15,16|4|$10^7$|\n|17,18|4|$10^{14}$|\n|19,20|4|$10^{18}$|\n\n**保证数据有解**，$T\\leq 5$\n\n**SPJ按照每组中的正确比例给分，但如果TLE、RE等会导致无输出而爆零**", "locale": "zh-CN", "translations": {"en": {"title": "Lianlian’s Math Problem.", "background": "Lianlian is a cute girl, and recently she has been addicted to solving math problems.", "description": "The problem Lianlian is working on now is very simple: there are $k \\space (2\\leq k\\leq 4)$ numbers. Lianlian does not know what they are, but she knows the pairwise greatest common divisors and least common multiples of these numbers.\n\nAs usual, Lianlian really wants to reconstruct those $k$ numbers, but now she needs to pretend she cannot do it, so she hands the problem to you. If you solve it successfully, Lianlian will cheer for you like crazy behind your back.", "inputFormat": "The first line contains two integers $T$ and $k$.\n\nThe next $2T$ lines contain $T$ test cases, and each test case consists of two lines.\n\nThe first line contains $\\frac{k(k-1)}2$ integers, representing the pairwise greatest common divisors of the $k$ unknown numbers, in arbitrary order.\n\nThe second line contains $\\frac{k(k-1)}2$ integers, representing the pairwise least common multiples of the $k$ unknown numbers, in arbitrary order.", "outputFormat": "Output $T$ lines. Each line contains $k$ numbers separated by spaces, representing any one set of answers that matches the given data.", "hint": "It is guaranteed that for odd-numbered test points, the first line (the gcd line) is all $1$.\n\n|Test Point ID|$k$|Input Integers Do Not Exceed|\n|-|-|-|\n|1,2|2|$100$|\n|3,4|2|$1000$|\n|5,6|2|$10^7$|\n|7,8|3|$100$|\n|9,10|3|$10^7$|\n|11,12|3|$10^{14}$|\n|13,14|4|$100$|\n|15,16|4|$10^7$|\n|17,18|4|$10^{14}$|\n|19,20|4|$10^{18}$|\n\nIt is guaranteed that the testdata has a solution, and $T\\leq 5$.\n\nThe SPJ scores according to the correct ratio within each test case, but if TLE, RE, etc. causes no output, you will get zero points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "恋恋的数学题", "background": "恋恋是个可爱的女孩子，最近她沉迷了做数学题。", "description": "现在恋恋正在处理的题目十分简单：现在有$k \\space (2\\leq k\\leq 4)$个数，恋恋不知道它们分别是几，只知道它们**两两**最大公约数及最小公倍数。\n\n按照套路，恋恋非常想复原出那$k$个数，但是现在她需要假装不会做，于是她就把题目交给了你，如果你顺利解决了这个问题，恋恋就会在你背后疯狂打call……", "inputFormat": "第一行，两个整数$T$和$k$\n\n接下来$2T$行包含$T$组数据，每组数据包含两行，\n\n第一行，$\\frac{k(k-1)}2$个整数，表示$k$个未知数的两两最大公约数，乱序\n\n第二行，$\\frac{k(k-1)}2$个整数，表示$k$个未知数的两两最小公倍数，乱序", "outputFormat": "输出$T$行，每行$k$个用空格分隔的数，表示**任意一组**符合对应数据的答案。", "hint": "**保证奇数测试点中，第一行（gcd行）数据均为$1$**\n\n|测试点编号　　　|$k$　　　|输入整数不超过　　　|\n|-|-|-|\n|1,2|2|$100$|\n|3,4|2|$1000$|\n|5,6|2|$10^7$|\n|7,8|3|$100$|\n|9,10|3|$10^7$|\n|11,12|3|$10^{14}$|\n|13,14|4|$100$|\n|15,16|4|$10^7$|\n|17,18|4|$10^{14}$|\n|19,20|4|$10^{18}$|\n\n**保证数据有解**，$T\\leq 5$\n\n**SPJ按照每组中的正确比例给分，但如果TLE、RE等会导致无输出而爆零**", "locale": "zh-CN"}}}
{"pid": "P5317", "type": "P", "difficulty": 5, "samples": [["4 5\n4 3 3 7 6\n1 8 12 1 2\n1 1 3 0 1\n2 1 1 0 4\n4 6 7\n4 7 8\n4 8 9\n2 0 5\n2 5 7\n2 5 1 2", "62\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "洛谷月赛"], "title": "简单模拟", "background": "", "description": "考虑这样一款游戏，游戏地图可以视为一个平面直角坐标系的第一、四象限。\n\n第一象限内会出现 $n$ 个物体，一个物体可以是一个点，或者一条平行于 y 轴的线段。一个物体出现时，物体上离 x 轴最近的点和最远的点，分别称为物体的最低点和最高点。若物体是点，则最低点和最高点相同。\n\n第 $i$ 个物体会在时刻 $t_i$ 出现，最低点为 $(x_i,l_i)$，最高点为 $(x_i,r_i)$，以速度 $v_i$ 沿 y 轴负半轴方向匀速移动。\n\n玩家可以标记 x 轴正半轴上的任何整点（若这个位置已经被标记，则这次的标记和之前的标记互不影响），称为**标记操作**；也可以取消某个标记，称为**取消标记操作**。同一时间可以做任意次操作。已知玩家做了 $m$ 对操作，第 $i$ 对操作的位置为 $p_i$，其中标记操作和取消标记操作发生的时刻分别为 $a_i$ 和 $b_i$。\n\n每个物体最初会处于**正常状态**。\n\n若在某一时刻，对于一个物体，距离物体的最低点不大于 $d_0$ 的位置发生标记操作，且这个物体处于正常状态，则会发生**得分事件**，且事件的参数 $d$ 为操作位置与物体最低点的距离。若有多个标记操作符合条件，选择其中使得 $d$ 最小的，若仍有多个则选择其中位置最接近原点的，保证这样选出的操作是唯一的。随后，对于这个物体，若是一个点，则会消失，否则会*被这个操作标记*，且变成**被标记状态**。注意，一个操作可以影响多个物体，而一个物体不会被多个操作标记。\n\n若在某一时刻，对于一个物体，距离物体的最高点不大于 $d_0$ 位置发生取消标记操作，且这个物体被相应的标记操作标记，则也会发生**得分事件**，且事件的参数 $d$ 为操作位置与物体最高点的距离。随后，这个物体会消失。\n\n若在某一时刻，一个处于正常状态的物体的最低点到达了第四象限（注意，坐标轴上的点不属于任何一个象限），或一个处于被标记状态的物体对应的标记被取消，且没有因为取消标记发生得分事件，则会发生 **miss 事件**。随后，这个物体会消失。\n\n一个参数为 $d$ 的得分事件发生时，玩家会得到 $(d_0^2-d^2)s_1$ 的基本得分。若此次事件前的连续 $k - 1$ 次事件都是得分事件，且此次事件前的第 $k$ 次事件不是得分事件或不存在，则玩家会得到 $ks_2$ 的额外得分。\n\n游戏中的结算发生在距离游戏开始经过整数个单位时间的时刻之内。已经出现的物体会在相邻两个时刻之间进行移动，某一时刻开始时移动已经完成。在结算的过程中，所有物体均视为静止。游戏开始于 0 时刻。具体来说，对于包括 0 时刻在内的任一时刻：首先，这一时刻开始。随后，所有由移动造成的 miss 事件以某个顺序依次发生。随后，在这一时刻出现的物体同时出现。随后，所有操作同时发生，且保证这一时刻的标记不会在同一时刻被取消。随后，所有得分事件以某个顺序依次发生（总得分与顺序无关）。随后，所有由操作造成的 miss 事件以某个顺序依次发生。随后，所有物体的状态同时改变（消失也视为状态改变）。最后，这一时刻结束。\n\n若所有物体均经历了出现和消失，或 miss 事件发生了严格大于 $w$ 次，游戏立即结束，此后的操作均可以忽略。", "inputFormat": "第一行 $n,m$，分别表示物体的个数和操作的对数。\n\n之后 $n$ 行，每行 $x_i,l_i,r_i,t_i,v_i$。\n\n之后 $m$ 行，每行 $p_i,a_i,b_i$。\n\n之后一行，$d_0,s_1,s_2,w$。", "outputFormat": "输出两行，第一行为得分，第二行为游戏结束时刻。", "hint": "#### 样例说明\n\n在时刻 0 发生了两次得分事件，共得到了 28 分；在时刻 5 发生了一次得分事件和一次 miss 事件，得到了 18 分；在时刻 7 发生了一次得分事件，得到了 16 分；在时刻 8 发生了一次 miss 事件，至此，所有物体都经历了出现和消失，游戏结束。\n\n#### 数据范围\n\n所有输入均为整数。\n\n$1\\le n,m\\le 2000$；\n\n$0\\le t_i,a_i,b_i\\le 10^9$；\n\n$1\\le x_i,p_i,l_i,r_i\\le 10^9$；\n\n$a_i<b_i$，$l_i\\le r_i$；\n\n$1\\le v_i,v_i\\cdot\\max\\{t_j,a_j,b_j\\}\\le 10^9$；\n\n$0\\le d_0,s_1,s_2\\le 10^4$；\n\n$0\\le w\\le n$。\n\n对于30%的数据：$n,m\\le 10$。\n\n#### 题目更新\n\n24.11.15：对于题意的细节改进了描述方式，增加了 hack 数据。\n\n24.12.24：增加一组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "Simple Simulation", "background": "", "description": "Consider a game where the game map can be viewed as the first and fourth quadrants of a Cartesian coordinate plane.\n\nIn the first quadrant, there will be $n$ objects. An object can be a point, or a line segment parallel to the $y$-axis. When an object appears, the point on the object closest to the $x$-axis and the point farthest from the $x$-axis are called the lowest point and the highest point of the object, respectively. If the object is a point, then its lowest point and highest point are the same.\n\nThe $i$-th object appears at time $t_i$. Its lowest point is $(x_i,l_i)$ and its highest point is $(x_i,r_i)$. It then moves at constant speed $v_i$ along the negative direction of the $y$-axis.\n\nThe player may mark any integer point on the positive half-axis of the $x$-axis (if this position has already been marked, then this mark does not affect the previous marks), which is called a **mark operation**. The player may also cancel a mark, which is called a **cancel-mark operation**. Any number of operations can be done at the same time. It is known that the player performed $m$ pairs of operations. The position of the $i$-th pair is $p_i$, and the times of the mark operation and the cancel-mark operation are $a_i$ and $b_i$, respectively.\n\nEach object initially is in the **normal state**.\n\nIf at some time, for an object, a mark operation happens at a position whose distance to the object’s lowest point is at most $d_0$, and the object is in the normal state, then a **scoring event** occurs, and the event parameter $d$ is the distance between the operation position and the object’s lowest point. If multiple mark operations satisfy the condition, choose the one that makes $d$ minimal; if there are still multiple, choose the one whose position is closest to the origin. It is guaranteed that the chosen operation is unique. Then, for this object, if it is a point, it disappears; otherwise, it will be *marked by this operation* and becomes in the **marked state**. Note that one operation can affect multiple objects, while one object will not be marked by multiple operations.\n\nIf at some time, for an object, a cancel-mark operation happens at a position whose distance to the object’s highest point is at most $d_0$, and the object is marked by the corresponding mark operation, then a **scoring event** also occurs, and the event parameter $d$ is the distance between the operation position and the object’s highest point. Then, the object disappears.\n\nIf at some time, an object in the normal state has its lowest point reach the fourth quadrant (note that points on the axes do not belong to any quadrant), or an object in the marked state has its corresponding mark canceled and no scoring event happens due to this cancel-mark operation, then a **miss event** occurs. Then, the object disappears.\n\nWhen a scoring event with parameter $d$ occurs, the player gains a base score of $(d_0^2-d^2)s_1$. If the previous consecutive $k - 1$ events are all scoring events, and the $k$-th event before this one is not a scoring event or does not exist, then the player additionally gains $ks_2$.\n\nSettlement in the game happens at times when an integer number of time units has passed since the start of the game. Objects that have already appeared move between two adjacent times, and at the start of a time, movement has already finished. During settlement, all objects are considered stationary. The game starts at time 0. Specifically, for any time moment including time 0: first, this moment starts. Then, all miss events caused by movement happen one by one in some order. Then, objects that appear at this moment appear simultaneously. Then, all operations happen simultaneously, and it is guaranteed that marks made at this moment will not be canceled at the same moment. Then, all scoring events happen one by one in some order (the total score is independent of the order). Then, all miss events caused by operations happen one by one in some order. Then, all objects’ states change simultaneously (disappearing is also considered a state change). Finally, this moment ends.\n\nIf all objects have both appeared and disappeared, or the number of miss events becomes strictly greater than $w$, the game ends immediately, and all subsequent operations can be ignored.", "inputFormat": "The first line contains $n,m$, representing the number of objects and the number of operation pairs.\n\nThen follow $n$ lines, each containing $x_i,l_i,r_i,t_i,v_i$.\n\nThen follow $m$ lines, each containing $p_i,a_i,b_i$.\n\nThen one line containing $d_0,s_1,s_2,w$.", "outputFormat": "Output two lines. The first line is the score, and the second line is the game end time.", "hint": "#### Sample Explanation\n\nAt time 0, two scoring events occurred, and a total of 28 points was obtained. At time 5, one scoring event and one miss event occurred, and 18 points was obtained. At time 7, one scoring event occurred, and 16 points was obtained. At time 8, one miss event occurred. At this point, all objects have appeared and disappeared, and the game ends.\n\n#### Constraints\n\nAll inputs are integers.\n\n$1\\le n,m\\le 2000$;\n\n$0\\le t_i,a_i,b_i\\le 10^9$;\n\n$1\\le x_i,p_i,l_i,r_i\\le 10^9$;\n\n$a_i<b_i$，$l_i\\le r_i$；\n\n$1\\le v_i,v_i\\cdot\\max\\{t_j,a_j,b_j\\}\\le 10^9$；\n\n$0\\le d_0,s_1,s_2\\le 10^4$；\n\n$0\\le w\\le n$。\n\nFor 30% of the testdata: $n,m\\le 10$.\n\n#### Problem Updates\n\n24.11.15: Improved the description of some details in the statement, and added hack testdata.\n\n24.12.24: Added one more set of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "简单模拟", "background": "", "description": "考虑这样一款游戏，游戏地图可以视为一个平面直角坐标系的第一、四象限。\n\n第一象限内会出现 $n$ 个物体，一个物体可以是一个点，或者一条平行于 y 轴的线段。一个物体出现时，物体上离 x 轴最近的点和最远的点，分别称为物体的最低点和最高点。若物体是点，则最低点和最高点相同。\n\n第 $i$ 个物体会在时刻 $t_i$ 出现，最低点为 $(x_i,l_i)$，最高点为 $(x_i,r_i)$，以速度 $v_i$ 沿 y 轴负半轴方向匀速移动。\n\n玩家可以标记 x 轴正半轴上的任何整点（若这个位置已经被标记，则这次的标记和之前的标记互不影响），称为**标记操作**；也可以取消某个标记，称为**取消标记操作**。同一时间可以做任意次操作。已知玩家做了 $m$ 对操作，第 $i$ 对操作的位置为 $p_i$，其中标记操作和取消标记操作发生的时刻分别为 $a_i$ 和 $b_i$。\n\n每个物体最初会处于**正常状态**。\n\n若在某一时刻，对于一个物体，距离物体的最低点不大于 $d_0$ 的位置发生标记操作，且这个物体处于正常状态，则会发生**得分事件**，且事件的参数 $d$ 为操作位置与物体最低点的距离。若有多个标记操作符合条件，选择其中使得 $d$ 最小的，若仍有多个则选择其中位置最接近原点的，保证这样选出的操作是唯一的。随后，对于这个物体，若是一个点，则会消失，否则会*被这个操作标记*，且变成**被标记状态**。注意，一个操作可以影响多个物体，而一个物体不会被多个操作标记。\n\n若在某一时刻，对于一个物体，距离物体的最高点不大于 $d_0$ 位置发生取消标记操作，且这个物体被相应的标记操作标记，则也会发生**得分事件**，且事件的参数 $d$ 为操作位置与物体最高点的距离。随后，这个物体会消失。\n\n若在某一时刻，一个处于正常状态的物体的最低点到达了第四象限（注意，坐标轴上的点不属于任何一个象限），或一个处于被标记状态的物体对应的标记被取消，且没有因为取消标记发生得分事件，则会发生 **miss 事件**。随后，这个物体会消失。\n\n一个参数为 $d$ 的得分事件发生时，玩家会得到 $(d_0^2-d^2)s_1$ 的基本得分。若此次事件前的连续 $k - 1$ 次事件都是得分事件，且此次事件前的第 $k$ 次事件不是得分事件或不存在，则玩家会得到 $ks_2$ 的额外得分。\n\n游戏中的结算发生在距离游戏开始经过整数个单位时间的时刻之内。已经出现的物体会在相邻两个时刻之间进行移动，某一时刻开始时移动已经完成。在结算的过程中，所有物体均视为静止。游戏开始于 0 时刻。具体来说，对于包括 0 时刻在内的任一时刻：首先，这一时刻开始。随后，所有由移动造成的 miss 事件以某个顺序依次发生。随后，在这一时刻出现的物体同时出现。随后，所有操作同时发生，且保证这一时刻的标记不会在同一时刻被取消。随后，所有得分事件以某个顺序依次发生（总得分与顺序无关）。随后，所有由操作造成的 miss 事件以某个顺序依次发生。随后，所有物体的状态同时改变（消失也视为状态改变）。最后，这一时刻结束。\n\n若所有物体均经历了出现和消失，或 miss 事件发生了严格大于 $w$ 次，游戏立即结束，此后的操作均可以忽略。", "inputFormat": "第一行 $n,m$，分别表示物体的个数和操作的对数。\n\n之后 $n$ 行，每行 $x_i,l_i,r_i,t_i,v_i$。\n\n之后 $m$ 行，每行 $p_i,a_i,b_i$。\n\n之后一行，$d_0,s_1,s_2,w$。", "outputFormat": "输出两行，第一行为得分，第二行为游戏结束时刻。", "hint": "#### 样例说明\n\n在时刻 0 发生了两次得分事件，共得到了 28 分；在时刻 5 发生了一次得分事件和一次 miss 事件，得到了 18 分；在时刻 7 发生了一次得分事件，得到了 16 分；在时刻 8 发生了一次 miss 事件，至此，所有物体都经历了出现和消失，游戏结束。\n\n#### 数据范围\n\n所有输入均为整数。\n\n$1\\le n,m\\le 2000$；\n\n$0\\le t_i,a_i,b_i\\le 10^9$；\n\n$1\\le x_i,p_i,l_i,r_i\\le 10^9$；\n\n$a_i<b_i$，$l_i\\le r_i$；\n\n$1\\le v_i,v_i\\cdot\\max\\{t_j,a_j,b_j\\}\\le 10^9$；\n\n$0\\le d_0,s_1,s_2\\le 10^4$；\n\n$0\\le w\\le n$。\n\n对于30%的数据：$n,m\\le 10$。\n\n#### 题目更新\n\n24.11.15：对于题意的细节改进了描述方式，增加了 hack 数据。\n\n24.12.24：增加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P5318", "type": "P", "difficulty": 2, "samples": [["8 9\n1 2\n1 3\n1 4\n2 5\n2 6\n3 7\n4 7\n4 8\n7 8", "1 2 5 6 3 7 8 4 \n1 2 3 4 5 6 7 8 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "图论", "广度优先搜索 BFS", "深度优先搜索 DFS", "图遍历"], "title": "【深基18.例3】查找文献", "background": null, "description": "小 K 喜欢翻看洛谷博客获取知识。每篇文章可能会有若干个（也有可能没有）参考文献的链接指向别的博客文章。小 K 求知欲旺盛，如果他看了某篇文章，那么他一定会去看这篇文章的参考文献（如果他之前已经看过这篇参考文献的话就不用再看它了）。\n\n假设洛谷博客里面一共有 $n(1\\le n\\le10^5)$ 篇文章（编号为 $1$ 到 $n$）以及 $m(1\\le m\\le10^6)$ 条参考文献引用关系。目前小 K 已经打开了编号为 1 的一篇文章，请帮助小 K 设计一种方法，使小 K 可以不重复、不遗漏的看完所有他能看到的文章。\n\n这边是已经整理好的参考文献关系图，其中，文献 $X\\to Y$ 表示文章 $X$ 有参考文献 $Y$。不保证编号为 $1$ 的文章没有被其他文章引用。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4n4tlhi.png)\n\n请对这个图分别进行 DFS 和 BFS，并输出遍历结果。如果有很多篇文章可以参阅，请先看编号较小的那篇（因此你可能需要先排序）。", "inputFormat": "共 $m+1$ 行，第 $1$ 行为 $2$ 个数，$n$ 和 $m$，分别表示一共有 $n(1\\le n\\le10^5)$ 篇文章（编号为 $1$ 到 $n$）以及$m(1\\le m\\le10^6)$ 条参考文献引用关系。\n\n接下来 $m$ 行，每行有两个整数 $X,Y$ 表示文章 $X$ 有参考文献 $Y$。", "outputFormat": "共 $2$ 行。\n\n第一行为 DFS 遍历结果，第二行为 BFS 遍历结果。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 18. Example 3] Finding References", "background": "", "description": "Xiao K likes to browse Luogu blogs to gain knowledge. Each article may have several (or possibly none) reference links pointing to other blog articles. Xiao K is eager to learn: if he reads an article, he will definitely go read the references of this article (if he has already read a reference before, then he does not need to read it again).\n\nAssume there are a total of $n(1\\le n\\le10^5)$ articles in Luogu blogs (numbered from $1$ to $n$) and $m(1\\le m\\le10^6)$ reference-citation relations. Currently, Xiao K has opened the article numbered $1$. Please help Xiao K design a method so that he can read all the articles he can reach without repetition and without missing any.\n\nHere is the organized reference-relation graph. In it, a reference $X\\to Y$ means article $X$ has reference $Y$. It is not guaranteed that article $1$ is not cited by other articles.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4n4tlhi.png)\n\nPlease perform DFS and BFS on this graph respectively, and output the traversal results. If there are multiple articles that can be visited, read the one with the smaller index first (so you may need to sort first).", "inputFormat": "There are $m+1$ lines in total. The first line contains two numbers, $n$ and $m$, which indicate that there are $n(1\\le n\\le10^5)$ articles in total (numbered from $1$ to $n$) and $m(1\\le m\\le10^6)$ reference-citation relations.\n\nIn the next $m$ lines, each line contains two integers $X, Y$, meaning that article $X$ has reference $Y$.", "outputFormat": "There are $2$ lines in total.\n\nThe first line is the DFS traversal result, and the second line is the BFS traversal result.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基18.例3】查找文献", "background": null, "description": "小 K 喜欢翻看洛谷博客获取知识。每篇文章可能会有若干个（也有可能没有）参考文献的链接指向别的博客文章。小 K 求知欲旺盛，如果他看了某篇文章，那么他一定会去看这篇文章的参考文献（如果他之前已经看过这篇参考文献的话就不用再看它了）。\n\n假设洛谷博客里面一共有 $n(1\\le n\\le10^5)$ 篇文章（编号为 $1$ 到 $n$）以及 $m(1\\le m\\le10^6)$ 条参考文献引用关系。目前小 K 已经打开了编号为 1 的一篇文章，请帮助小 K 设计一种方法，使小 K 可以不重复、不遗漏的看完所有他能看到的文章。\n\n这边是已经整理好的参考文献关系图，其中，文献 $X\\to Y$ 表示文章 $X$ 有参考文献 $Y$。不保证编号为 $1$ 的文章没有被其他文章引用。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4n4tlhi.png)\n\n请对这个图分别进行 DFS 和 BFS，并输出遍历结果。如果有很多篇文章可以参阅，请先看编号较小的那篇（因此你可能需要先排序）。", "inputFormat": "共 $m+1$ 行，第 $1$ 行为 $2$ 个数，$n$ 和 $m$，分别表示一共有 $n(1\\le n\\le10^5)$ 篇文章（编号为 $1$ 到 $n$）以及$m(1\\le m\\le10^6)$ 条参考文献引用关系。\n\n接下来 $m$ 行，每行有两个整数 $X,Y$ 表示文章 $X$ 有参考文献 $Y$。", "outputFormat": "共 $2$ 行。\n\n第一行为 DFS 遍历结果，第二行为 BFS 遍历结果。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5319", "type": "P", "difficulty": 6, "samples": [["4 3\n....\n1 2\n2 2\n3 1", "2019"], ["5 4\n..0..\n0 2\n00 2\n01 4\n10 3", "11012"], ["18 6\n...2.1.0.1..1.0..1\n011 6\n111 4\n010 12\n121 7\n101 5\n10 3", "121211203112120121"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "各省省选", "北京", "Special Judge", "分数规划", "AC 自动机"], "title": "[BJOI2019] 奥术神杖", "background": "", "description": "Bezorath 大陆抵抗地灾军团入侵的战争进入了僵持的阶段，世世代代生活在 Bezorath 这片大陆的精灵们开始寻找远古时代诸神遗留的神器，试图借助神器的神秘力量帮助她们战胜地灾军团。\n\n在付出了惨痛的代价后，精灵们从步步凶险的远古战场取回了一件保存尚完好的神杖。但在经历过那场所有史书都视为禁忌的“诸神黄昏之战”后，神杖上镶嵌的奥术宝石已经残缺，神力也几乎消耗殆尽。精灵高层在至高会议中决定以举国之力收集残存至今的奥术宝石，并重金悬赏天下能工巧匠修复这件神杖。\n\n你作为神术一脉第五百零一位传人，接受了这个艰巨而神圣的使命。\n神杖上从左到右镶嵌了 $n$ 颗奥术宝石，奥术宝石一共有 $10$ 种，用数字 \"`0123456789`\" 表示。有些位置的宝石已经残缺，用 \"`.`\" 表示，你需要用完好的奥术宝石填补每一处残缺的部分（每种奥术宝石个数不限，且不能够更换未残缺的宝石）。古老的魔法书上记载了 $m$ 种咒语 $(S_i,V_i)$ ，其中 $S_i$ 是一个非空数字串，$V_i$ 是这种组合能够激发的神力。\n\n神杖的初始神力值 $Magic = 1$，每当神杖中出现了连续一段宝石与 $S_i$ 相等时，神力值 $Magic$ 就会乘以 $V_i$。但神杖如果包含了太多咒语就不再纯净导致神力降低：设 $c$ 为神杖包含的咒语个数（若咒语类别相同但出现位置不同视为多次），神杖最终的神力值为 $ \\sqrt[c]{Magic}$。（若 $c = 0$ 则神杖最终神力值为 $1$ ）\n\n例如有两种咒语 $(01,3)$ 、$(10,4)$ ，那么神杖 “`0101`” 的神力值为 $\\sqrt[3]{ 3 \\times 4 \\times 3}$\n\n你需要使修复好的神杖的最终的神力值最大，输出任何一个解即可。", "inputFormat": "第一行两个正整数 $n$ 、$m$ ，表示宝石数和咒语数。\n\n第二行为一个长度为 $n$ 的字符串 $T$ ，表示初始的神杖。\n\n接下来 $m$ 行每行一个非空数字串 $S_i$ 和一个正整数 $V_i$ ，表示每种咒语。", "outputFormat": "输出最终神杖上从左到右镶嵌的宝石，多解时任意输出一个即可。", "hint": "样例 1 ：法杖最终神力值为 $2$ 。\n\n样例 2 ：法杖最终神力值为 $\\sqrt[3]{2 \\times 3 \\times 4}$\n\n设 $s = \\sum_{i=1}^{m} |S_i|$ ，即所有咒语的串长之和。\n![](https://cdn.luogu.com.cn/upload/pic/57052.png)", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Arcane Staff.", "background": "", "description": "The war on the continent of Bezorath against the disaster legion has reached a stalemate. The elves who have lived on Bezorath for generations began searching for ancient artifacts left by the gods, hoping to use their mysterious power to defeat the disaster legion.\n\nAfter paying a painful price, the elves retrieved a well-preserved staff from a perilous ancient battlefield. However, after the “Twilight of the Gods War”, which all history books consider taboo, the arcane gems inlaid on the staff were already damaged, and its divine power was almost completely exhausted. The elf leaders decided, in the Supreme Council, to mobilize the whole nation to collect the remaining arcane gems, and offered a huge reward to craftsmen across the land to repair the staff.\n\nAs the 501st inheritor of the divine arts lineage, you have accepted this difficult and sacred mission.\n\nFrom left to right, the staff has $n$ arcane gems inlaid. There are $10$ types of arcane gems, represented by the digits \"`0123456789`\". Some positions are already damaged, represented by \"`.`\". You need to fill every damaged position using intact arcane gems (the number of each type is unlimited, and you are not allowed to replace gems that are not damaged). An ancient spellbook records $m$ spells $(S_i, V_i)$, where $S_i$ is a non-empty digit string, and $V_i$ is the divine power that this combination can trigger.\n\nThe initial divine power of the staff is $Magic = 1$. Whenever the staff contains a consecutive segment of gems equal to $S_i$, the divine power $Magic$ is multiplied by $V_i$. But if the staff contains too many spells, it becomes impure and its power decreases: let $c$ be the number of spells contained in the staff (if the spell type is the same but appears at different positions, it is counted multiple times). The final divine power of the staff is $\\sqrt[c]{Magic}$. (If $c = 0$, then the final divine power of the staff is $1$.)\n\nFor example, if there are two spells $(01, 3)$ and $(10, 4)$, then the divine power of the staff \"`0101`\" is $\\sqrt[3]{3 \\times 4 \\times 3}$.\n\nYou need to maximize the final divine power of the repaired staff, and output any one solution.", "inputFormat": "The first line contains two positive integers $n$ and $m$, representing the number of gems and the number of spells.\n\nThe second line contains a string $T$ of length $n$, representing the initial staff.\n\nThe next $m$ lines each contain a non-empty digit string $S_i$ and a positive integer $V_i$, representing each spell.", "outputFormat": "Output the gems inlaid on the final staff from left to right. If there are multiple solutions, output any one.", "hint": "Sample 1: the final divine power of the staff is $2$.\n\nSample 2: the final divine power of the staff is $\\sqrt[3]{2 \\times 3 \\times 4}$.\n\nLet $s = \\sum_{i=1}^{m} |S_i|$, i.e. the sum of the lengths of all spell strings.\n\n![](https://cdn.luogu.com.cn/upload/pic/57052.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 奥术神杖", "background": "", "description": "Bezorath 大陆抵抗地灾军团入侵的战争进入了僵持的阶段，世世代代生活在 Bezorath 这片大陆的精灵们开始寻找远古时代诸神遗留的神器，试图借助神器的神秘力量帮助她们战胜地灾军团。\n\n在付出了惨痛的代价后，精灵们从步步凶险的远古战场取回了一件保存尚完好的神杖。但在经历过那场所有史书都视为禁忌的“诸神黄昏之战”后，神杖上镶嵌的奥术宝石已经残缺，神力也几乎消耗殆尽。精灵高层在至高会议中决定以举国之力收集残存至今的奥术宝石，并重金悬赏天下能工巧匠修复这件神杖。\n\n你作为神术一脉第五百零一位传人，接受了这个艰巨而神圣的使命。\n神杖上从左到右镶嵌了 $n$ 颗奥术宝石，奥术宝石一共有 $10$ 种，用数字 \"`0123456789`\" 表示。有些位置的宝石已经残缺，用 \"`.`\" 表示，你需要用完好的奥术宝石填补每一处残缺的部分（每种奥术宝石个数不限，且不能够更换未残缺的宝石）。古老的魔法书上记载了 $m$ 种咒语 $(S_i,V_i)$ ，其中 $S_i$ 是一个非空数字串，$V_i$ 是这种组合能够激发的神力。\n\n神杖的初始神力值 $Magic = 1$，每当神杖中出现了连续一段宝石与 $S_i$ 相等时，神力值 $Magic$ 就会乘以 $V_i$。但神杖如果包含了太多咒语就不再纯净导致神力降低：设 $c$ 为神杖包含的咒语个数（若咒语类别相同但出现位置不同视为多次），神杖最终的神力值为 $ \\sqrt[c]{Magic}$。（若 $c = 0$ 则神杖最终神力值为 $1$ ）\n\n例如有两种咒语 $(01,3)$ 、$(10,4)$ ，那么神杖 “`0101`” 的神力值为 $\\sqrt[3]{ 3 \\times 4 \\times 3}$\n\n你需要使修复好的神杖的最终的神力值最大，输出任何一个解即可。", "inputFormat": "第一行两个正整数 $n$ 、$m$ ，表示宝石数和咒语数。\n\n第二行为一个长度为 $n$ 的字符串 $T$ ，表示初始的神杖。\n\n接下来 $m$ 行每行一个非空数字串 $S_i$ 和一个正整数 $V_i$ ，表示每种咒语。", "outputFormat": "输出最终神杖上从左到右镶嵌的宝石，多解时任意输出一个即可。", "hint": "样例 1 ：法杖最终神力值为 $2$ 。\n\n样例 2 ：法杖最终神力值为 $\\sqrt[3]{2 \\times 3 \\times 4}$\n\n设 $s = \\sum_{i=1}^{m} |S_i|$ ，即所有咒语的串长之和。\n![](https://cdn.luogu.com.cn/upload/pic/57052.png)", "locale": "zh-CN"}}}
{"pid": "P5320", "type": "P", "difficulty": 7, "samples": [["5 2\n2 4 2\n1 10000 501\n52501 233333333333 1\n52501 233333333333 2\n52501 233333333333 50", "665496240\n218802505\n745517510\n133015204\n910014966"], ["5 3\n2 2 2\n1 10000 501\n52501 233333333333 1\n52501 233333333333 2\n52501 233333333333 50", "3\n900767573\n52671648\n600503426\n678428567"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "北京"], "title": "[BJOI2019] 勘破神机", "background": "", "description": "地灾军团的军师黑袍从潜伏在精灵高层的密探手中得知了神杖的情报，他对奥术宝石中蕴含的远古神秘力量十分感兴趣。他设计夺取了数块奥术宝石，并命令作为地灾军团首席科学家的你带领手下的研究人员全力破解。经过了一个月的艰苦尝试，你的研究团队终于破译了 “`2`” 型奥术宝石和 “`3`” 型奥术宝石的内部能量结构。\n\n这两类结构有着一定的相似性，它们的内部具有 $k$ 个反应核心，“`2`” 型奥术宝石的每个核心都可以看成是一个 $2 \\times n$ 的网格，而 “`3`” 型奥术宝石的每个核心都可以看成是一个 $3 \\times n$ 的网格。（注意奥术宝石的 $k$ 和 $n$ 可能不同）当神力反应进行时，每个核心自动填充满神力颗粒。\n\n形式化地描述，每个神力颗粒可以看成是一个 $1 \\times 2$ 横置或竖置的方格，核心填满的定义为每个网格都恰好被一某个方格覆盖。若在两种填满反应核心的方案中存在一个方格放置的位置或方式不同，就认为方案不同。\n\n如填满 $2×4$ 的网格有 $5$ 种不同的方案，填满 $3×2$ 的网格有 $3$ 种不同的方案。\n\n![](https://cdn.luogu.com.cn/upload/pic/57055.png)\n\n如果奥术宝石的 $k$ 个核心的填充方式互不相同，它们就会组合出强大的咒术。黑袍想知道对于某个宝石一共有多少种不同的咒术（对于两种咒术组合，如果第一种咒术中每个核心 $a$ 的填充方式都可以找到第二种咒术的某个核心 $b$ ，使得 $a$ 和 $b$ 的填充方式完全相同，则认为这两种咒术组合相同）。\n\n对于宽度为 $n$ 、反应核心个数为 $k$ 的 “`2`” 型奥术宝石，设不同的咒术为 $F(n,k)$  ；对于宽度为 $n$ 、反应核心个数为 $k$ 的 “`3`” 型奥术宝石，设不同的咒术为 $G(n,k)$  。例如 $F(4,1) = 5$ ，$F(4,2) = 10$ ，$G(2,2) = 3$ 。\n\n地灾军团的科技水平还不能精准测量反应核心的长度 $n$ ，只能确定出核心长度的大致范围  $[l,r]$ 。你需要计算出反应核心长度在此区间内的平均咒术数，即\n\n$$ans2 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} F(n,k)$$\n$$ans3 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} G(n,k)$$\n\n设最终答案的形式为 $\\frac{A}{B}$，输出 $ A \\times B^{-1} \\bmod 998244353$ 的结果，其中 $B^{-1}$ 是 $B$ 在 $998244353$ 下的乘法逆元。", "inputFormat": "第一行为两个正整数 $T$ 、$m$ ，表示数据组数和奥术宝石的类型（只可能为 $2$ 或 $3$ ）。\n\n接下来 $T$ 行每行三个正整数 $l,r,k$ ，表示核心长度的范围与核心数量。", "outputFormat": "对于每组数据，若 $m=2$ 则输出 $ans2$ ，$m=3$ 则输出 $ans3$ 。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57057.png)\n\n对于所有数据，保证不存在 $r-l+1$ 是 $998244353$ 倍数的情况。\n\n由于考场的电脑很慢，出题人更改数据后的所有 $T=1$。\n\n注：本题数据范围有误，实际满足 $1\\leq l\\leq r\\leq 6\\times 10 ^ {18}$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Seeing Through the Secrets of the Divine Mechanism", "background": "", "description": "The strategist of the Geocast Legion, Black Robe, learned information about the Divine Staff from spies infiltrating the upper ranks of the elves. He is very interested in the ancient mysterious power contained in the Arcane Gems. He seized several Arcane Gems and ordered you, the chief scientist of the Geocast Legion, to lead your researchers to crack them with full effort. After a month of hard work, your team finally deciphered the internal energy structures of the “`2`-type” Arcane Gem and the “`3`-type” Arcane Gem.\n\nThese two kinds of structures share some similarities. Each gem contains $k$ reaction cores. Each core of a “`2`-type” Arcane Gem can be seen as a $2 \\times n$ grid, and each core of a “`3`-type” Arcane Gem can be seen as a $3 \\times n$ grid. (Note that $k$ and $n$ may be different for different gems.)\n\nWhen the divine reaction happens, each core is automatically filled with divine particles.\n\nFormally, each divine particle can be viewed as a $1 \\times 2$ domino placed horizontally or vertically. A core is considered filled if every cell of the grid is covered by exactly one domino. If, between two filling plans, there exists at least one domino whose position or orientation is different, then the two plans are considered different.\n\nFor example, there are $5$ different ways to fill a $2 \\times 4$ grid, and $3$ different ways to fill a $3 \\times 2$ grid.\n\n![](https://cdn.luogu.com.cn/upload/pic/57055.png)\n\nIf the filling plans of the $k$ cores in an Arcane Gem are all different from each other, they will combine into a powerful spell. Black Robe wants to know how many different spells a gem can produce. (For two spell combinations, if for every core filling plan $a$ in the first combination, one can find some core filling plan $b$ in the second combination such that $a$ and $b$ are exactly the same, then these two spell combinations are considered the same.)\n\nFor a “`2`-type” Arcane Gem with width $n$ and $k$ reaction cores, let the number of different spells be $F(n,k)$. For a “`3`-type” Arcane Gem with width $n$ and $k$ reaction cores, let the number of different spells be $G(n,k)$. For example, $F(4,1) = 5$, $F(4,2) = 10$, and $G(2,2) = 3$.\n\nThe Geocast Legion’s technology cannot precisely measure the core length $n$, and can only determine an approximate range $[l,r]$. You need to compute the average number of spells when the core length is within this interval, namely:\n\n$$ans2 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} F(n,k)$$\n$$ans3 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} G(n,k)$$\n\nLet the final answer be in the form $\\frac{A}{B}$. Output $A \\times B^{-1} \\bmod 998244353$, where $B^{-1}$ is the multiplicative inverse of $B$ modulo $998244353$.", "inputFormat": "The first line contains two positive integers $T$ and $m$, representing the number of test cases and the type of Arcane Gem (only $2$ or $3$).\n\nThe next $T$ lines each contain three positive integers $l, r, k$, representing the range of core lengths and the number of cores.", "outputFormat": "For each test case, if $m = 2$ output $ans2$; if $m = 3$ output $ans3$.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57057.png)\n\nFor all testdata, it is guaranteed that $r-l+1$ is not a multiple of $998244353$.\n\nBecause the computers in the contest were very slow, after the setter modified the testdata, all cases have $T = 1$.\n\nNote: The Constraints of this problem are incorrect. The actual constraints satisfy $1\\leq l\\leq r\\leq 6\\times 10 ^ {18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 勘破神机", "background": "", "description": "地灾军团的军师黑袍从潜伏在精灵高层的密探手中得知了神杖的情报，他对奥术宝石中蕴含的远古神秘力量十分感兴趣。他设计夺取了数块奥术宝石，并命令作为地灾军团首席科学家的你带领手下的研究人员全力破解。经过了一个月的艰苦尝试，你的研究团队终于破译了 “`2`” 型奥术宝石和 “`3`” 型奥术宝石的内部能量结构。\n\n这两类结构有着一定的相似性，它们的内部具有 $k$ 个反应核心，“`2`” 型奥术宝石的每个核心都可以看成是一个 $2 \\times n$ 的网格，而 “`3`” 型奥术宝石的每个核心都可以看成是一个 $3 \\times n$ 的网格。（注意奥术宝石的 $k$ 和 $n$ 可能不同）当神力反应进行时，每个核心自动填充满神力颗粒。\n\n形式化地描述，每个神力颗粒可以看成是一个 $1 \\times 2$ 横置或竖置的方格，核心填满的定义为每个网格都恰好被一某个方格覆盖。若在两种填满反应核心的方案中存在一个方格放置的位置或方式不同，就认为方案不同。\n\n如填满 $2×4$ 的网格有 $5$ 种不同的方案，填满 $3×2$ 的网格有 $3$ 种不同的方案。\n\n![](https://cdn.luogu.com.cn/upload/pic/57055.png)\n\n如果奥术宝石的 $k$ 个核心的填充方式互不相同，它们就会组合出强大的咒术。黑袍想知道对于某个宝石一共有多少种不同的咒术（对于两种咒术组合，如果第一种咒术中每个核心 $a$ 的填充方式都可以找到第二种咒术的某个核心 $b$ ，使得 $a$ 和 $b$ 的填充方式完全相同，则认为这两种咒术组合相同）。\n\n对于宽度为 $n$ 、反应核心个数为 $k$ 的 “`2`” 型奥术宝石，设不同的咒术为 $F(n,k)$  ；对于宽度为 $n$ 、反应核心个数为 $k$ 的 “`3`” 型奥术宝石，设不同的咒术为 $G(n,k)$  。例如 $F(4,1) = 5$ ，$F(4,2) = 10$ ，$G(2,2) = 3$ 。\n\n地灾军团的科技水平还不能精准测量反应核心的长度 $n$ ，只能确定出核心长度的大致范围  $[l,r]$ 。你需要计算出反应核心长度在此区间内的平均咒术数，即\n\n$$ans2 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} F(n,k)$$\n$$ans3 = \\frac{1}{r-l+1}\\sum_{n=l}^{r} G(n,k)$$\n\n设最终答案的形式为 $\\frac{A}{B}$，输出 $ A \\times B^{-1} \\bmod 998244353$ 的结果，其中 $B^{-1}$ 是 $B$ 在 $998244353$ 下的乘法逆元。", "inputFormat": "第一行为两个正整数 $T$ 、$m$ ，表示数据组数和奥术宝石的类型（只可能为 $2$ 或 $3$ ）。\n\n接下来 $T$ 行每行三个正整数 $l,r,k$ ，表示核心长度的范围与核心数量。", "outputFormat": "对于每组数据，若 $m=2$ 则输出 $ans2$ ，$m=3$ 则输出 $ans3$ 。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57057.png)\n\n对于所有数据，保证不存在 $r-l+1$ 是 $998244353$ 倍数的情况。\n\n由于考场的电脑很慢，出题人更改数据后的所有 $T=1$。\n\n注：本题数据范围有误，实际满足 $1\\leq l\\leq r\\leq 6\\times 10 ^ {18}$。", "locale": "zh-CN"}}}
{"pid": "P5321", "type": "P", "difficulty": 7, "samples": [["3 3 4\n0 0\n1 0\n0 0\n1 0 1\n0 0 1\n3 3 0 3 1 0 0 3 1 3 0\n1 2 1 2 0\n2 1 0 1 1\n3 2 2 2 3 1 1 2 1 3 0", "11\n16"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "北京"], "title": "[BJOI2019] 送别", "background": "", "description": "法珞是个怕黑的女孩子。\n\n傍晚了，法珞所参加的学术会议早已散会。黎瑟也下了课过来接法珞回火车站。\n\n但是教学楼里突然断电了，法珞陷入了一片漆黑之中。\n\n好在黎瑟已经到了教学楼的同一层。\n\n然而由于教学楼的结构过于复杂，她们已经记不起教学楼的具体结构了。\n黎瑟学校的教学楼每层的结构都非常工整。\n\n形式化地说，教学楼的一层的平面结构可以画在二维平面上以 $(0,0)$ 为左上角顶点，$(n,m)$ 为右下角顶点的子矩形（记为 $(0,0) - (n,m)$  的矩形）里，这个子矩形的四条边是教学楼的楼体(或者说是四段已知一定存在的墙)。\n\n**请注意，本题中的坐标系和普通的平面直角坐标系不同，$(0,0)$ 是左上角的顶点而 $(n,m)$ 是右下角的顶点。 $(i,j)$ 表示的是第 $i+1$ 行第 $j+1$ 列的顶点而不是横坐标为 $i$ 纵坐标为 $j$ 的顶点。**\n\n每一段墙（无法通过的部分）是一条端点为 $(i,j)$ 和 $(i',j')$ 的线段，记作 $(i,j) - (i',j')$ 的墙，其中 $|i-i'| + |j-j'| =1$ 且 $i,i'$ 是 $[0,n]$ 中的整数， $j,j'$ 是 $[0,m]$ 中的整数（每当我们之后使用 $(i,j) - (i',j')$ 的记法，我们都保证满足上述所有条件）。\n\n法珞知道，对于这种结构，有一种办法可能让她找到黎瑟：法珞用左手扶住墙，手臂和墙面垂直，保持这个状态向前方走，在转弯处也保持左手一直扶墙的状态。按照这个方法她就可以环绕一周，可能与黎瑟相遇。\n\n![](https://cdn.luogu.com.cn/upload/pic/57058.png)\n\n上图是样例输入中第一次询问的法珞的行走方案，在行走过程中法珞的左手必须贴住墙。\n\n法珞一开始会给你需要维护的初始的(这层楼的)结构，之后会给你 $q$ 个请求。\n\n+ 操作 1 ： 读入格式形如 $1 \\ x_0 \\ y_0 \\ x_1 \\ y_1$：法珞请求在当前结构里添加一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙不存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。\n\n+ 操作2： 读入格式形如 $2 \\ x_0 \\ y_0 \\ x_1 \\ y_1$：法珞请求在当前结构里删除一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。\n\n+ 操作3： 读入格式形如 $3\\ x_0 \\ y_0 \\ x_1\\ y_1\\ d_0 \\ x_2 \\ y_2 \\ x_3 \\ y_3 \\ d_1$ ：法珞当前在 $(x_0,y_0) - (x_1,y_1)$ 的墙的中点位置 $(\\frac{x0+x1}{2},\\frac{y_0 + y_1}{2})$ ， $d_0$ 是一个 $[0,1]$ 中的整数，用来描述法珞在墙的哪一侧， $d_0  = 0$ 代表法珞在墙的左方/上方， $d_0 = 1$ 代表右方/下方。黎瑟当前在 $(x_2,y_2) - (x_3,y_3)$ 的墙的中点位置  $(\\frac{x2+x3}{2},\\frac{y_2+y_3}{2})$ 。 $d_1$ 的格式和 $d_0$ 相同。保证 $(x_0,y_0) - (x_1,y_1)$ 和 $(x_2,y_2) - (x_3,y_3)$ 这两段墙存在，且法珞和黎瑟的位置都落在 $(0,0) - (n,m)$ 的子矩形的内部。求法珞按照题目所述的方法找到黎瑟要走过多少长度（ $(i,j) - (i',j')$  这段墙的长度为 $1$，半段墙（由于起点和终点都在墙的中点处）的长度是  $\\frac{1}{2}$ ）。\n\n", "inputFormat": "输入共 $2n+q$ 行。\n\n第一行三个整数 $n$ 、$m$ 、$q$ ，意义如题目中所示。\n\n接下来的 $n$ 行，每行 $m-1$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i-1,j)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i - 1,j)$ 这一段没有墙。\n\n接下来的 $n-1$ 行，每行 $m$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i,j-1)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i,j-1)$ 这一段没有墙。\n\n接下来的 $q$ 行，每行一个操作，格式如题目中所示。", "outputFormat": "对于每个询问，输出法珞按照题目所述的方法找到黎瑟要走过多少长度，**如果法珞按照题目所述的方法无法找到黎瑟则输出 $-1$ 。**", "hint": "对于 10% 的数据， $5 \\le n,m \\le 50$ ， $1 \\le q \\le  2000$ 。\n\n对于另外 30% 的数据，没有 1 操作。\n\n对于另外 30% 的数据，保证在任意时刻若法珞和黎瑟站在任意输入格式中合法的位置，法珞都可以和黎瑟相遇。\n\n对于100%的数据，$5 \\le n,m \\le 500$ ， $1 \\le q \\le 2 \\times 10^5$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Farewell", "background": "", "description": "Falo is a girl who is afraid of the dark.\n\nIt is evening. The academic conference that Falo attended has already ended. Lise also finished class and came to pick Falo up to go to the train station.\n\nHowever, the teaching building suddenly lost power, and Falo was surrounded by darkness.\n\nLuckily, Lise has already arrived on the same floor of the teaching building.\n\nBut because the structure of the building is too complex, they can no longer remember the exact layout of this floor. The teaching building in Lise's school has a very regular layout on each floor.\n\nFormally, the planar layout of one floor can be drawn on a 2D plane inside the sub-rectangle with $(0,0)$ as the upper-left corner and $(n,m)$ as the lower-right corner (denoted as the rectangle $(0,0) - (n,m)$). The four sides of this sub-rectangle are the outer walls of the building (i.e. four wall segments that are guaranteed to exist).\n\n**Note that the coordinate system in this problem is different from the standard Cartesian coordinate system: $(0,0)$ is the upper-left corner and $(n,m)$ is the lower-right corner. $(i,j)$ denotes the vertex in the $(i+1)$-th row and $(j+1)$-th column, not the point with x-coordinate $i$ and y-coordinate $j$.**\n\nEach wall segment (an impassable part) is a line segment with endpoints $(i,j)$ and $(i',j')$, denoted as the wall $(i,j) - (i',j')$, where $|i-i'| + |j-j'| = 1$, and $i,i'$ are integers in $[0,n]$, while $j,j'$ are integers in $[0,m]$ (whenever we later use the notation $(i,j) - (i',j')$, we guarantee that all the above conditions are satisfied).\n\nFalo knows that for such a layout, there is a method that might allow her to find Lise: Falo places her left hand on the wall, with her arm perpendicular to the wall, and keeps walking forward in this state; at turns she also keeps her left hand on the wall. By doing so, she can walk around one loop and may meet Lise.\n\n![](https://cdn.luogu.com.cn/upload/pic/57058.png)\n\nThe figure above shows Falo's walking route for the first query in the sample input. During the walk, Falo's left hand must stay in contact with the wall.\n\nInitially, Falo gives you the initial structure (of this floor) that needs to be maintained, and then there will be $q$ requests.\n\n- Operation 1: input format $1 \\ x_0 \\ y_0 \\ x_1 \\ y_1$. Falo requests to add a wall segment $(x_0,y_0) - (x_1,y_1)$ to the current structure. It is guaranteed that this wall did not exist before, and it is not on the four sides of the rectangle $(0,0) - (n,m)$.\n\n- Operation 2: input format $2 \\ x_0 \\ y_0 \\ x_1 \\ y_1$. Falo requests to delete a wall segment $(x_0,y_0) - (x_1,y_1)$ from the current structure. It is guaranteed that this wall existed before, and it is not on the four sides of the rectangle $(0,0) - (n,m)$.\n\n- Operation 3: input format $3\\ x_0 \\ y_0 \\ x_1\\ y_1\\ d_0 \\ x_2 \\ y_2 \\ x_3 \\ y_3 \\ d_1$. Falo is currently at the midpoint of the wall $(x_0,y_0) - (x_1,y_1)$, i.e. $\\left(\\frac{x0+x1}{2},\\frac{y_0 + y_1}{2}\\right)$. $d_0$ is an integer in $[0,1]$ describing which side of the wall Falo is on: $d_0 = 0$ means Falo is on the left/upper side of the wall, and $d_0 = 1$ means on the right/lower side. Lise is currently at the midpoint of the wall $(x_2,y_2) - (x_3,y_3)$, i.e. $\\left(\\frac{x2+x3}{2},\\frac{y_2+y_3}{2}\\right)$. The meaning of $d_1$ is the same as $d_0$. It is guaranteed that both wall segments $(x_0,y_0) - (x_1,y_1)$ and $(x_2,y_2) - (x_3,y_3)$ exist, and both positions of Falo and Lise are strictly inside the rectangle $(0,0) - (n,m)$. Compute how much total length Falo needs to walk to find Lise using the method described above (the length of a wall segment $(i,j) - (i',j')$ is $1$, and the length of a half wall segment (since both the start and end are at midpoints) is $\\frac{1}{2}$).", "inputFormat": "There are a total of $2n+q$ lines of input.\n\nThe first line contains three integers $n$, $m$, $q$, with meanings as described above.\n\nThe next $n$ lines each contain $m-1$ integers in $[0,1]$. The integer in row $i$ and column $j$ is $1$ if the segment $(i,j) - (i-1,j)$ has a wall, and $0$ otherwise.\n\nThe next $n-1$ lines each contain $m$ integers in $[0,1]$. The integer in row $i$ and column $j$ is $1$ if the segment $(i,j) - (i,j-1)$ has a wall, and $0$ otherwise.\n\nThe next $q$ lines each describe one operation, in the format given above.", "outputFormat": "For each query, output the total length Falo needs to walk to find Lise using the method described above. **If Falo cannot find Lise using the method described above, output $-1$.**", "hint": "For 10% of the data, $5 \\le n,m \\le 50$, $1 \\le q \\le 2000$.\n\nFor another 30% of the data, there is no operation of type 1.\n\nFor another 30% of the data, it is guaranteed that at any time, if Falo and Lise stand at any valid positions given by the input format, then Falo can meet Lise.\n\nFor 100% of the data, $5 \\le n,m \\le 500$, $1 \\le q \\le 2 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 送别", "background": "", "description": "法珞是个怕黑的女孩子。\n\n傍晚了，法珞所参加的学术会议早已散会。黎瑟也下了课过来接法珞回火车站。\n\n但是教学楼里突然断电了，法珞陷入了一片漆黑之中。\n\n好在黎瑟已经到了教学楼的同一层。\n\n然而由于教学楼的结构过于复杂，她们已经记不起教学楼的具体结构了。\n黎瑟学校的教学楼每层的结构都非常工整。\n\n形式化地说，教学楼的一层的平面结构可以画在二维平面上以 $(0,0)$ 为左上角顶点，$(n,m)$ 为右下角顶点的子矩形（记为 $(0,0) - (n,m)$  的矩形）里，这个子矩形的四条边是教学楼的楼体(或者说是四段已知一定存在的墙)。\n\n**请注意，本题中的坐标系和普通的平面直角坐标系不同，$(0,0)$ 是左上角的顶点而 $(n,m)$ 是右下角的顶点。 $(i,j)$ 表示的是第 $i+1$ 行第 $j+1$ 列的顶点而不是横坐标为 $i$ 纵坐标为 $j$ 的顶点。**\n\n每一段墙（无法通过的部分）是一条端点为 $(i,j)$ 和 $(i',j')$ 的线段，记作 $(i,j) - (i',j')$ 的墙，其中 $|i-i'| + |j-j'| =1$ 且 $i,i'$ 是 $[0,n]$ 中的整数， $j,j'$ 是 $[0,m]$ 中的整数（每当我们之后使用 $(i,j) - (i',j')$ 的记法，我们都保证满足上述所有条件）。\n\n法珞知道，对于这种结构，有一种办法可能让她找到黎瑟：法珞用左手扶住墙，手臂和墙面垂直，保持这个状态向前方走，在转弯处也保持左手一直扶墙的状态。按照这个方法她就可以环绕一周，可能与黎瑟相遇。\n\n![](https://cdn.luogu.com.cn/upload/pic/57058.png)\n\n上图是样例输入中第一次询问的法珞的行走方案，在行走过程中法珞的左手必须贴住墙。\n\n法珞一开始会给你需要维护的初始的(这层楼的)结构，之后会给你 $q$ 个请求。\n\n+ 操作 1 ： 读入格式形如 $1 \\ x_0 \\ y_0 \\ x_1 \\ y_1$：法珞请求在当前结构里添加一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙不存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。\n\n+ 操作2： 读入格式形如 $2 \\ x_0 \\ y_0 \\ x_1 \\ y_1$：法珞请求在当前结构里删除一段 $(x_0,y_0) - (x_1,y_1)$ 的墙，保证此前这段墙存在且这段墙不在 $(0,0) - (n,m)$ 的子矩形的四条边上。\n\n+ 操作3： 读入格式形如 $3\\ x_0 \\ y_0 \\ x_1\\ y_1\\ d_0 \\ x_2 \\ y_2 \\ x_3 \\ y_3 \\ d_1$ ：法珞当前在 $(x_0,y_0) - (x_1,y_1)$ 的墙的中点位置 $(\\frac{x0+x1}{2},\\frac{y_0 + y_1}{2})$ ， $d_0$ 是一个 $[0,1]$ 中的整数，用来描述法珞在墙的哪一侧， $d_0  = 0$ 代表法珞在墙的左方/上方， $d_0 = 1$ 代表右方/下方。黎瑟当前在 $(x_2,y_2) - (x_3,y_3)$ 的墙的中点位置  $(\\frac{x2+x3}{2},\\frac{y_2+y_3}{2})$ 。 $d_1$ 的格式和 $d_0$ 相同。保证 $(x_0,y_0) - (x_1,y_1)$ 和 $(x_2,y_2) - (x_3,y_3)$ 这两段墙存在，且法珞和黎瑟的位置都落在 $(0,0) - (n,m)$ 的子矩形的内部。求法珞按照题目所述的方法找到黎瑟要走过多少长度（ $(i,j) - (i',j')$  这段墙的长度为 $1$，半段墙（由于起点和终点都在墙的中点处）的长度是  $\\frac{1}{2}$ ）。\n\n", "inputFormat": "输入共 $2n+q$ 行。\n\n第一行三个整数 $n$ 、$m$ 、$q$ ，意义如题目中所示。\n\n接下来的 $n$ 行，每行 $m-1$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i-1,j)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i - 1,j)$ 这一段没有墙。\n\n接下来的 $n-1$ 行，每行 $m$ 个 $[0,1]$ 中的整数，第 $i$ 行第 $j$ 列的整数为 $1$ 表示 $(i,j) - (i,j-1)$ 这一段有墙，为 $0$ 则表示 $(i,j) - (i,j-1)$ 这一段没有墙。\n\n接下来的 $q$ 行，每行一个操作，格式如题目中所示。", "outputFormat": "对于每个询问，输出法珞按照题目所述的方法找到黎瑟要走过多少长度，**如果法珞按照题目所述的方法无法找到黎瑟则输出 $-1$ 。**", "hint": "对于 10% 的数据， $5 \\le n,m \\le 50$ ， $1 \\le q \\le  2000$ 。\n\n对于另外 30% 的数据，没有 1 操作。\n\n对于另外 30% 的数据，保证在任意时刻若法珞和黎瑟站在任意输入格式中合法的位置，法珞都可以和黎瑟相遇。\n\n对于100%的数据，$5 \\le n,m \\le 500$ ， $1 \\le q \\le 2 \\times 10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P5322", "type": "P", "difficulty": 4, "samples": [["1 3 10\n2 2 6", "3"], ["2 3 10\n2 2 6\n0 0 0", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2019", "各省省选", "北京", "O2优化", "背包 DP"], "title": "[BJOI2019] 排兵布阵", "background": null, "description": "小 C 正在玩一款排兵布阵的游戏。在游戏中有 $n$ 座城堡，每局对战由两名玩家来争夺这些城堡。每名玩家有 $m$ 名士兵，可以向第 $i$ 座城堡派遣 $a_i$ 名士兵去争夺这个城堡，使得总士兵数不超过 $m$。   \n\n如果一名玩家向第 $i$ 座城堡派遣的士兵数**严格**大于对手派遣士兵数的两倍，那么这名玩家就占领了这座城堡，获得 $i$ 分。  \n\n现在小 C 即将和其他 $s$ 名玩家两两对战，这 $s$ 场对决的派遣士兵方案必须相同。小 C 通过某些途径得知了其他 $s$ 名玩家即将使用的策略，他想知道他应该使用什么策略来最大化自己的总分。   \n\n由于答案可能不唯一，你只需要输出小 C 总分的最大值。", "inputFormat": "输入第一行包含三个正整数 $s,n,m$，分别表示除了小 C 以外的玩家人数、城堡数和每名玩家拥有的士兵数。\n\n接下来 $s$ 行，每行 $n$ 个非负整数，表示一名玩家的策略。其中第 $i$ 个数 $a_i$ 表示这名玩家向第 $i$ 座城堡派遣的士兵数。", "outputFormat": "输出一行一个非负整数，表示小 C 获得的最大得分。", "hint": "### 样例 1 解释  \n\n小 C 的最佳策略为向第 $1$ 座城堡和第 $2$ 座城堡各派遣 $5$ 名士兵。 \n\n### 样例 2 解释\n  \n小 C 的最佳策略之一为向第 $1$ 座城堡派遣 $2$ 名士兵，向第 $2$ 座城堡派遣 $5$ 名士兵，向第 $3$ 座城堡派遣 $1$ 名士兵。  \n\n### 数据范围\n\n对于 $10\\%$ 的数据：$s=1,n \\le 3,m \\le 10$；\n\n对于 $20\\%$ 的数据：$s=1,n \\le 10,m \\le 100$；\n\n对于 $40\\%$ 的数据：$n\\le 10,m\\le 100$；\n\n对于另外 $20\\%$ 的数据：$s=1$；\n\n对于 $100\\%$ 的数据：$1\\le s \\le 100$，$1\\le n \\le 100$，$1\\le m \\le 2\\times 10^4$。对于每名玩家，保证 $a_i \\ge 0$，$\\sum\\limits_{i=1}^n a_i \\le m$", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Troop Deployment", "background": "", "description": "Xiao C is playing a troop deployment game. In the game, there are $n$ castles, and each match is a battle between two players competing for these castles. Each player has $m$ soldiers, and may send $a_i$ soldiers to the $i$-th castle to compete for it, as long as the total number of soldiers sent does not exceed $m$.\n\nIf the number of soldiers a player sends to the $i$-th castle is **strictly** greater than twice the number sent by the opponent, then the player occupies this castle and gains $i$ points.\n\nNow Xiao C is going to play head-to-head matches against another $s$ players. The troop deployment plan used in these $s$ matches must be the same. Through some means, Xiao C has learned the strategies that the other $s$ players are going to use, and he wants to know what strategy he should use to maximize his total score.\n\nSince the answer may not be unique, you only need to output the maximum possible total score of Xiao C.", "inputFormat": "The first line contains three positive integers $s,n,m$, representing the number of players other than Xiao C, the number of castles, and the number of soldiers each player has.\n\nThe next $s$ lines each contain $n$ non-negative integers, describing one player’s strategy. The $i$-th number $a_i$ means the number of soldiers this player sends to the $i$-th castle.", "outputFormat": "Output one line with one non-negative integer, representing the maximum score Xiao C can obtain.", "hint": "**Explanation for Sample 1:**  \nXiao C’s best strategy is to send $5$ soldiers to the $1$-st castle and $5$ soldiers to the $2$-nd castle.\n\n**Explanation for Sample 2:**  \nOne of Xiao C’s best strategies is to send $2$ soldiers to the $1$-st castle, $5$ soldiers to the $2$-nd castle, and $1$ soldier to the $3$-rd castle.\n\n**Constraints:**  \nFor $10\\%$ of the testdata: $s=1,n \\le 3,m \\le 10$.  \nFor $20\\%$ of the testdata: $s=1,n \\le 10,m \\le 100$.  \nFor $40\\%$ of the testdata: $n \\le 10,m \\le 100$.  \nFor another $20\\%$ of the testdata: $s=1$.  \nFor $100\\%$ of the testdata:  \n$1 \\le s \\le 100$.  \n$1 \\le n \\le 100$.  \n$1 \\le m \\le 20000$.  \nFor each player, $a_i \\ge 0$, and $\\sum\\limits_{i=1}^n a_i \\le m$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 排兵布阵", "background": null, "description": "小 C 正在玩一款排兵布阵的游戏。在游戏中有 $n$ 座城堡，每局对战由两名玩家来争夺这些城堡。每名玩家有 $m$ 名士兵，可以向第 $i$ 座城堡派遣 $a_i$ 名士兵去争夺这个城堡，使得总士兵数不超过 $m$。   \n\n如果一名玩家向第 $i$ 座城堡派遣的士兵数**严格**大于对手派遣士兵数的两倍，那么这名玩家就占领了这座城堡，获得 $i$ 分。  \n\n现在小 C 即将和其他 $s$ 名玩家两两对战，这 $s$ 场对决的派遣士兵方案必须相同。小 C 通过某些途径得知了其他 $s$ 名玩家即将使用的策略，他想知道他应该使用什么策略来最大化自己的总分。   \n\n由于答案可能不唯一，你只需要输出小 C 总分的最大值。", "inputFormat": "输入第一行包含三个正整数 $s,n,m$，分别表示除了小 C 以外的玩家人数、城堡数和每名玩家拥有的士兵数。\n\n接下来 $s$ 行，每行 $n$ 个非负整数，表示一名玩家的策略。其中第 $i$ 个数 $a_i$ 表示这名玩家向第 $i$ 座城堡派遣的士兵数。", "outputFormat": "输出一行一个非负整数，表示小 C 获得的最大得分。", "hint": "### 样例 1 解释  \n\n小 C 的最佳策略为向第 $1$ 座城堡和第 $2$ 座城堡各派遣 $5$ 名士兵。 \n\n### 样例 2 解释\n  \n小 C 的最佳策略之一为向第 $1$ 座城堡派遣 $2$ 名士兵，向第 $2$ 座城堡派遣 $5$ 名士兵，向第 $3$ 座城堡派遣 $1$ 名士兵。  \n\n### 数据范围\n\n对于 $10\\%$ 的数据：$s=1,n \\le 3,m \\le 10$；\n\n对于 $20\\%$ 的数据：$s=1,n \\le 10,m \\le 100$；\n\n对于 $40\\%$ 的数据：$n\\le 10,m\\le 100$；\n\n对于另外 $20\\%$ 的数据：$s=1$；\n\n对于 $100\\%$ 的数据：$1\\le s \\le 100$，$1\\le n \\le 100$，$1\\le m \\le 2\\times 10^4$。对于每名玩家，保证 $a_i \\ge 0$，$\\sum\\limits_{i=1}^n a_i \\le m$", "locale": "zh-CN"}}}
{"pid": "P5323", "type": "P", "difficulty": 6, "samples": [["2\n50 20\n80 5", "858585865"], ["3\n1 2\n3 4\n5 6", "843334849"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2019", "各省省选", "北京", "O2优化"], "title": "[BJOI2019] 光线", "background": "", "description": "当一束光打到一层玻璃上时，有一定比例的光会穿过这层玻璃，一定比例的光会被反射回去，剩下的光被玻璃吸收。  \n\n设对于任意 $x$，有 $x \\times a_i\\%$ 单位的光会穿过它，有 $x \\times b_i\\%$ 的会被反射回去。  \n现在 $n$ 层玻璃叠在一起，有 $1$ 单位的光打到第 $1$ 层玻璃上，那么有多少单位的光能穿过**所有** $n$ 层玻璃呢？\n", "inputFormat": "第一行一个正整数 $n$，表示玻璃层数。  \n接下来 $n$ 行，每行两个非负整数 $a_i,b_i$，表示第 $i$ 层玻璃的透光率和反射率。", "outputFormat": "输出一行一个整数，表示穿透所有玻璃的光对 $10^9 + 7$ 取模的结果。  \n可以证明，答案一定为有理数。设答案为 $a/b$ ( $a$ 和 $b$ 是互质的正整数)，你输出的答案为 $x$，你需要保证 $a\\equiv bx \\space (\\text{mod }10^9 + 7)$。", "hint": "**样例1解释：**  \n![](https://cdn.luogu.com.cn/upload/pic/57125.png)   \n如图，光线从左上角打进来，有 $0.5$ 单位的光穿过第 $1$ 层玻璃，有 $0.2$ 单位的光被反射回去。这 $0.5$ 单位的光有 $0.4$ 单位穿过第 $2$ 层玻璃，有 $0.025$ 单位的光被反射回去。这 $0.025$ 单位的光有 $0.0125$ 单位穿过第 $1$ 层玻璃，有 $0.005$ 单位的光被反射回去。这 $0.005$ 单位的光有 $0.004$ 单位穿过第 $2$ 层玻璃……于是，穿过两层玻璃的光一共有$0.40404... = 40/99$ 单位。在模 $10^9+7$ 意义下等于 $858585865$。 \n\n**数据范围：**  \n对于 $5\\%$ 的数据，$n=1$；    \n对于 $20\\%$ 的数据，$n\\le 2$；    \n对于 $30\\%$ 的数据，$n\\le 3$；    \n对于 $50\\%$ 的数据，$n\\le 100$；    \n对于 $70\\%$ 的数据，$n\\le 3000$；    \n对于 $100\\%$ 的数据，$n\\le 5\\times 10^5$，$1\\le a_i \\le 100$，$0\\le b_i \\le 99$，$1\\le a_i+b_i \\le 100$。  \n\n每组 $a_i$ 和 $b_i$ 在满足上述限制的整数中随机生成。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Light Ray", "background": "", "description": "When a beam of light hits a layer of glass, a certain proportion of the light will pass through the glass, a certain proportion will be reflected back, and the rest will be absorbed by the glass.\n\nSuppose for any $x$, $x \\times a_i\\%$ units of light will pass through it, and $x \\times b_i\\%$ will be reflected back.\nNow there are $n$ layers of glass stacked together. If $1$ unit of light hits the $1$st layer of glass, how many units of light can pass through **all** $n$ layers of glass?", "inputFormat": "The first line contains a positive integer $n$, representing the number of glass layers.  \nThe next $n$ lines each contain two non-negative integers $a_i, b_i$, representing the transmittance and reflectance of the $i$-th layer.", "outputFormat": "Output one line containing one integer, representing the amount of light that passes through all the glass layers modulo $10^9 + 7$.  \nIt can be proven that the answer must be a rational number. Let the answer be $a/b$ (where $a$ and $b$ are coprime positive integers). If the value you output is $x$, you need to ensure that $a \\equiv bx \\space (\\text{mod }10^9 + 7)$.", "hint": "**Explanation for Sample 1:**  \n![](https://cdn.luogu.com.cn/upload/pic/57125.png)  \nAs shown in the figure, the light ray enters from the upper-left corner. There are $0.5$ units of light passing through the $1$st layer of glass, and $0.2$ units of light being reflected back. Of these $0.5$ units of light, $0.4$ units pass through the $2$nd layer of glass, and $0.025$ units of light are reflected back. Of these $0.025$ units of light, $0.0125$ units pass through the $1$st layer of glass, and $0.005$ units of light are reflected back. Of these $0.005$ units of light, $0.004$ units pass through the $2$nd layer of glass... Therefore, the total amount of light passing through the two layers of glass is $0.40404... = 40/99$ units. Modulo $10^9+7$, this equals $858585865$.\n\n**Constraints:**  \nFor $5\\%$ of the testdata, $n=1$;  \nFor $20\\%$ of the testdata, $n \\le 2$;  \nFor $30\\%$ of the testdata, $n \\le 3$;  \nFor $50\\%$ of the testdata, $n \\le 100$;  \nFor $70\\%$ of the testdata, $n \\le 3000$;  \nFor $100\\%$ of the testdata, $n \\le 5\\times 10^5$, $1 \\le a_i \\le 100$, $0 \\le b_i \\le 99$, $1 \\le a_i+b_i \\le 100$.\n\nIn each group, $a_i$ and $b_i$ are generated randomly among integers that satisfy the above constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 光线", "background": "", "description": "当一束光打到一层玻璃上时，有一定比例的光会穿过这层玻璃，一定比例的光会被反射回去，剩下的光被玻璃吸收。  \n\n设对于任意 $x$，有 $x \\times a_i\\%$ 单位的光会穿过它，有 $x \\times b_i\\%$ 的会被反射回去。  \n现在 $n$ 层玻璃叠在一起，有 $1$ 单位的光打到第 $1$ 层玻璃上，那么有多少单位的光能穿过**所有** $n$ 层玻璃呢？\n", "inputFormat": "第一行一个正整数 $n$，表示玻璃层数。  \n接下来 $n$ 行，每行两个非负整数 $a_i,b_i$，表示第 $i$ 层玻璃的透光率和反射率。", "outputFormat": "输出一行一个整数，表示穿透所有玻璃的光对 $10^9 + 7$ 取模的结果。  \n可以证明，答案一定为有理数。设答案为 $a/b$ ( $a$ 和 $b$ 是互质的正整数)，你输出的答案为 $x$，你需要保证 $a\\equiv bx \\space (\\text{mod }10^9 + 7)$。", "hint": "**样例1解释：**  \n![](https://cdn.luogu.com.cn/upload/pic/57125.png)   \n如图，光线从左上角打进来，有 $0.5$ 单位的光穿过第 $1$ 层玻璃，有 $0.2$ 单位的光被反射回去。这 $0.5$ 单位的光有 $0.4$ 单位穿过第 $2$ 层玻璃，有 $0.025$ 单位的光被反射回去。这 $0.025$ 单位的光有 $0.0125$ 单位穿过第 $1$ 层玻璃，有 $0.005$ 单位的光被反射回去。这 $0.005$ 单位的光有 $0.004$ 单位穿过第 $2$ 层玻璃……于是，穿过两层玻璃的光一共有$0.40404... = 40/99$ 单位。在模 $10^9+7$ 意义下等于 $858585865$。 \n\n**数据范围：**  \n对于 $5\\%$ 的数据，$n=1$；    \n对于 $20\\%$ 的数据，$n\\le 2$；    \n对于 $30\\%$ 的数据，$n\\le 3$；    \n对于 $50\\%$ 的数据，$n\\le 100$；    \n对于 $70\\%$ 的数据，$n\\le 3000$；    \n对于 $100\\%$ 的数据，$n\\le 5\\times 10^5$，$1\\le a_i \\le 100$，$0\\le b_i \\le 99$，$1\\le a_i+b_i \\le 100$。  \n\n每组 $a_i$ 和 $b_i$ 在满足上述限制的整数中随机生成。", "locale": "zh-CN"}}}
{"pid": "P5324", "type": "P", "difficulty": 6, "samples": [["3 9\n1 2 3\n1 1\n0 1\n0 1\n0 1\n2 2\n3 2\n0 -1\n0 -1\n0 -1", "0\n1\n2\n3\n2\n1\n1\n2\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "线段树", "各省省选", "北京", "O2优化"], "title": "[BJOI2019] 删数", "background": null, "description": "对于任意一个数列，如果能在有限次进行下列删数操作后将其删为空数列，则称这个数列可以删空。一次删数操作定义如下：  \n>记当前数列长度为 $k$ ，则删掉数列中所有等于 $k$ 的数。  \n\n现有一个长度为 $n$ 的数列 $a$，有 $m$ 次修改操作，第 $i$ 次修改后你要回答：  \n经过 $i$ 次修改后的数列 $a$，至少还需要修改几个数才可删空？  \n\n每次修改操作为单点修改或数列整体加一或数列整体减一。", "inputFormat": "第一行两个正整数 $n,m$，分别表示数列长度、修改次数。  \n第二行有 $n$ 个正整数，表示数列 $a$，即输入的第 $i$ 个数表示数列 $a$ 的第 $i$ 个数 $a_i$。   \n\n接下来 $m$ 行，每行两个整数 $p,x$，表示一次修改操作。  \n当 $1\\le p \\le n$ 时，该操作为单点修改，将数列中第 $p$ 个数 $a_p$ 修改为 $x$  \n当 $p=0$ 时，该操作为数列整体加 $x$。", "outputFormat": "输出 $m$ 行，每行一个整数，第 $i$ 行表示前 $i$ 次修改后的答案。", "hint": "**样例解释(局部)：**     \n第一次修改后，数列为 $(1, 2, 3)$，无需修改即可删空。   \n第四次修改后，数列为 $(4, 5, 6)$，需要将三个数都改掉才可能删空。   \n第六次修改后，数列为 $(4, 2, 2)$，将第一个数改成 $3$ 即可删空。   \n第九次修改后，数列为 $(1, -1, -1)$，可以将第二个数改成 $2$、第三个数改成 $3$ 来删空。   \n\n**数据范围：**   \n对于 $100\\%$ 的数据：      \n- $1\\le n,m \\le 150000, 1\\le a_i \\le n, 0\\le p\\le n$  \n- $p>0$ 时，$1\\le x \\le n$  \n- $p=0$ 时，$x\\in \\{-1, 1\\}$    \n![](https://cdn.luogu.com.cn/upload/pic/57129.png)", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2019] Deleting Numbers", "background": "", "description": "For any sequence, if it can be deleted into an empty sequence after performing the following delete operation a finite number of times, then the sequence is said to be deletable to empty.\n\nOne delete operation is defined as follows:\n> Let the current sequence length be $k$. Then delete all numbers in the sequence that are equal to $k$.\n\nNow there is a sequence $a$ of length $n$, and there are $m$ modification operations. After the $i$-th modification, you need to answer:\nFor the sequence $a$ after $i$ modifications, what is the minimum number of elements that still need to be changed so that it can be deleted to empty?\n\nEach modification is either a point update, or adding $1$ to the whole sequence, or subtracting $1$ from the whole sequence.", "inputFormat": "The first line contains two positive integers $n, m$, representing the sequence length and the number of modifications.\n\nThe second line contains $n$ positive integers, representing the sequence $a$. That is, the $i$-th input number is the $i$-th element of the sequence, $a_i$.\n\nThe next $m$ lines each contain two integers $p, x$, representing one modification operation.\nWhen $1 \\le p \\le n$, this operation is a point update: set the $p$-th number in the sequence, $a_p$, to $x$.\nWhen $p = 0$, this operation adds $x$ to the whole sequence.", "outputFormat": "Output $m$ lines, each containing one integer. The $i$-th line denotes the answer after the first $i$ modifications.", "hint": "**Sample Explanation (partial):**\nAfter the first modification, the sequence is $(1, 2, 3)$, and it can be deleted to empty without any changes.\nAfter the fourth modification, the sequence is $(4, 5, 6)$, and all three numbers must be changed before it can possibly be deleted to empty.\nAfter the sixth modification, the sequence is $(4, 2, 2)$, and changing the first number to $3$ makes it deletable to empty.\nAfter the ninth modification, the sequence is $(1, -1, -1)$, and you can change the second number to $2$ and the third number to $3$ to make it deletable to empty.\n\n**Constraints:**\nFor $100\\%$ of the testdata:\n- $1 \\le n, m \\le 150000$, $1 \\le a_i \\le n$, $0 \\le p \\le n$.\n- When $p > 0$, $1 \\le x \\le n$.\n- When $p = 0$, $x \\in \\{-1, 1\\}$.\n![](https://cdn.luogu.com.cn/upload/pic/57129.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2019] 删数", "background": null, "description": "对于任意一个数列，如果能在有限次进行下列删数操作后将其删为空数列，则称这个数列可以删空。一次删数操作定义如下：  \n>记当前数列长度为 $k$ ，则删掉数列中所有等于 $k$ 的数。  \n\n现有一个长度为 $n$ 的数列 $a$，有 $m$ 次修改操作，第 $i$ 次修改后你要回答：  \n经过 $i$ 次修改后的数列 $a$，至少还需要修改几个数才可删空？  \n\n每次修改操作为单点修改或数列整体加一或数列整体减一。", "inputFormat": "第一行两个正整数 $n,m$，分别表示数列长度、修改次数。  \n第二行有 $n$ 个正整数，表示数列 $a$，即输入的第 $i$ 个数表示数列 $a$ 的第 $i$ 个数 $a_i$。   \n\n接下来 $m$ 行，每行两个整数 $p,x$，表示一次修改操作。  \n当 $1\\le p \\le n$ 时，该操作为单点修改，将数列中第 $p$ 个数 $a_p$ 修改为 $x$  \n当 $p=0$ 时，该操作为数列整体加 $x$。", "outputFormat": "输出 $m$ 行，每行一个整数，第 $i$ 行表示前 $i$ 次修改后的答案。", "hint": "**样例解释(局部)：**     \n第一次修改后，数列为 $(1, 2, 3)$，无需修改即可删空。   \n第四次修改后，数列为 $(4, 5, 6)$，需要将三个数都改掉才可能删空。   \n第六次修改后，数列为 $(4, 2, 2)$，将第一个数改成 $3$ 即可删空。   \n第九次修改后，数列为 $(1, -1, -1)$，可以将第二个数改成 $2$、第三个数改成 $3$ 来删空。   \n\n**数据范围：**   \n对于 $100\\%$ 的数据：      \n- $1\\le n,m \\le 150000, 1\\le a_i \\le n, 0\\le p\\le n$  \n- $p>0$ 时，$1\\le x \\le n$  \n- $p=0$ 时，$x\\in \\{-1, 1\\}$    \n![](https://cdn.luogu.com.cn/upload/pic/57129.png)", "locale": "zh-CN"}}}
{"pid": "P5325", "type": "P", "difficulty": 7, "samples": [["10\n", "263\n"], ["1000000000\n", "710164413\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["递推", "数论", "筛法", "模板题"], "title": "【模板】Min_25 筛", "background": "模板题，无背景。", "description": "定义积性函数 $f(x)$，且 $f(p ^ k) = p ^ k(p ^ k - 1)$（$p$ 是一个质数），求\n\n$$\\sum_{i = 1} ^ n f(i)$$\n\n对 $10 ^ 9 + 7$ 取模。", "inputFormat": "一行一个整数 $n$。", "outputFormat": "一个整数表示答案。", "hint": "$f(1)=1$，$f(2)=2$，$f(3)=6$，$f(4)=12$，$f(5)=20$；  \n$f(6)=12$，$f(7)=42$，$f(8)=56$，$f(9)=72$，$f(10)=40$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n\\le 10^6$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^{10}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Min_25 Sieve", "background": "This is a template problem, with no background.", "description": "Define a multiplicative function $f(x)$, and $f(p ^ k) = p ^ k(p ^ k - 1)$ ($p$ is a prime). Compute\n\n$$\\sum_{i = 1} ^ n f(i)$$\n\nmodulo $10 ^ 9 + 7$.", "inputFormat": "One line containing an integer $n$.", "outputFormat": "Output one integer, the answer.", "hint": "$f(1)=1$，$f(2)=2$，$f(3)=6$，$f(4)=12$，$f(5)=20$；  \n$f(6)=12$，$f(7)=42$，$f(8)=56$，$f(9)=72$，$f(10)=40$。\n\nFor $30\\%$ of the testdata, it is guaranteed that $1\\le n\\le 10^6$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le n\\le 10^{10}$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】Min_25 筛", "background": "模板题，无背景。", "description": "定义积性函数 $f(x)$，且 $f(p ^ k) = p ^ k(p ^ k - 1)$（$p$ 是一个质数），求\n\n$$\\sum_{i = 1} ^ n f(i)$$\n\n对 $10 ^ 9 + 7$ 取模。", "inputFormat": "一行一个整数 $n$。", "outputFormat": "一个整数表示答案。", "hint": "$f(1)=1$，$f(2)=2$，$f(3)=6$，$f(4)=12$，$f(5)=20$；  \n$f(6)=12$，$f(7)=42$，$f(8)=56$，$f(9)=72$，$f(10)=40$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n\\le 10^6$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^{10}$。", "locale": "zh-CN"}}}
{"pid": "P5326", "type": "P", "difficulty": 7, "samples": [["2\n1 1\n1 1", "4"], ["8\n1 1 0 0 1 1 0 0\n1 2 3 4 5 6 7 8", "858924815"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] 开关", "background": "", "description": "九条可怜是一个贪玩的女孩子。  \n\n这天，她和她的好朋友法海哥哥去玩密室逃脱。在他们面前的是 $n$ 个开关，开始每个开关都是关闭的状态。要通过这关，必须要让开关达到指定的状态。目标状态由一个长度为 $n$ 的 $01$ 数组 $s$ 给出，$s_i = 0$ 表示第 $i$ 个开关在最后需要是关着的，$s_i = 1$ 表示第 $i$ 个开关在最后需要被打开。  \n\n然而作为闯关者，可怜和法海并不知道 $s$。因此他们决定采用一个比较稳妥的方法：瞎按。他们根据开关的外形、位置，通过一些玄学的方法给每一个开关赋予了一个权值 $p_i$（$p_i > 0$）每一次，他们会以正比于 $p_i$ 的概率（第 $i$ 个开关被选中的概率是 $\\frac{p_i}{\\sum^n_{j=1}p_j}$ 选择并按下一个开关。开关被按下后，状态会被反转，即开变关，关变开。**注意，每一轮的选择都是完全独立的。**\n\n在按开关的过程中，一旦当前开关的状态达到了 $s$ 那么可怜和法海面前的门就会打开，他们会马上停止按开关的过程并前往下一关。作为一名欧皇，可怜在按了 $\\sum^n_{i=1} s_i$ 次后，就打开了大门。为了感受一下自己的运气是多么的好，可怜想要让你帮她计算一下，用这种随机按的方式，期望需要按多少次开关才能通过这一关。", "inputFormat": "第一行输入一个整数 $n$，表示开关的数量。  \n第二行输入 $n$ 个整数 $s_i$（$s_i\\in \\{0,1\\}$），表示开关的目标状态。第三行同样输入 $n$ 个整数 $p_i$，表示每个开关的权值。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为，$\\frac{x}{y}$（$x \\ge 0$，$y \\ge 1$，$\\gcd(x, y) = 1$），你需要输出 $x \\times y^{-1} \\bmod 998244353$。", "hint": "**【样例解释 \\#1】**\n\n前两次按开关，有 $\\frac12$ 的概率达到 $s$，有 $\\frac12$ 的概率回到原状。因此期望的按开关数量为：\n\n$$\\sum^{+\\infty}_{i=1}2i\\times \\left(\\frac12\\right)^i=4$$\n\n---\n\n**【数据范围与约定】**\n\n| 测试点 | $n$ | 其他约定 | 测试点 | $n$ | 其他约定 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=2$ | 无 | $6$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $2$ | $=2$ | 无 | $7$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $3$ | $\\le 8$ | 无 | $8$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $4$ | $\\le 8$ | 无 | $9$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $5$ | $\\le 100$ | $p_i=1$ | $10$ | $\\le 100$ | 无 |\n\n对于 $100\\%$ 的数据，保证 $n\\ge1$，$\\sum^n_{i=1}p_i\\le5\\times10^4$，$p_i\\ge1$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Switches", "background": "", "description": "Jiutiao Keliang is a playful girl.\n\nOne day, she and her good friend Brother Fahai went to play an escape room. In front of them are $n$ switches, and at the beginning every switch is in the off state. To pass this level, the switches must reach a specified state. The target state is given by a binary array $s$ of length $n$. $s_i = 0$ means the $i$-th switch needs to be off in the end, and $s_i = 1$ means the $i$-th switch needs to be on in the end.\n\nHowever, as challengers, Keliang and Fahai do not know $s$. So they decided to use a safer method: pressing randomly. Based on the shape and position of the switches, they used some “mystic” methods to assign each switch a weight $p_i$ ($p_i > 0$). Each time, they choose and press one switch with probability proportional to $p_i$ (the probability that the $i$-th switch is chosen is $\\frac{p_i}{\\sum^n_{j=1}p_j}$). After a switch is pressed, its state is flipped: on becomes off, and off becomes on. **Note that each round of selection is completely independent.**\n\nDuring the process of pressing switches, once the current states of switches match $s$, the door in front of Keliang and Fahai will open. They will immediately stop pressing switches and move on to the next level. As a very lucky person, Keliang opened the door after pressing $\\sum^n_{i=1} s_i$ times. To feel how good her luck was, she wants you to help her compute: using this random pressing method, what is the expected number of presses needed to pass this level?", "inputFormat": "The first line contains an integer $n$, representing the number of switches.  \nThe second line contains $n$ integers $s_i$ ($s_i\\in \\{0,1\\}$), representing the target state of each switch.  \nThe third line contains $n$ integers $p_i$, representing the weight of each switch.", "outputFormat": "Output one line with one integer, representing the answer modulo $998244353$. That is, if the answer in simplest fractional form is $\\frac{x}{y}$ ($x \\ge 0$, $y \\ge 1$, $\\gcd(x, y) = 1$), you should output $x \\times y^{-1} \\bmod 998244353$.", "hint": "**[Sample Explanation \\#1]**\n\nIn the first two presses, there is a probability of $\\frac12$ to reach $s$, and a probability of $\\frac12$ to return to the initial state. Therefore, the expected number of switch presses is:\n\n$$\\sum^{+\\infty}_{i=1}2i\\times \\left(\\frac12\\right)^i=4$$\n\n---\n\n**[Constraints and Notes]**\n\n| Test Point | $n$ | Other Notes | Test Point | $n$ | Other Notes |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=2$ | None | $6$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $2$ | $=2$ | None | $7$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $3$ | $\\le 8$ | None | $8$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $4$ | $\\le 8$ | None | $9$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $5$ | $\\le 100$ | $p_i=1$ | $10$ | $\\le 100$ | None |\n\nFor $100\\%$ of the testdata, it is guaranteed that $n\\ge1$, $\\sum^n_{i=1}p_i\\le5\\times10^4$, and $p_i\\ge1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 开关", "background": "", "description": "九条可怜是一个贪玩的女孩子。  \n\n这天，她和她的好朋友法海哥哥去玩密室逃脱。在他们面前的是 $n$ 个开关，开始每个开关都是关闭的状态。要通过这关，必须要让开关达到指定的状态。目标状态由一个长度为 $n$ 的 $01$ 数组 $s$ 给出，$s_i = 0$ 表示第 $i$ 个开关在最后需要是关着的，$s_i = 1$ 表示第 $i$ 个开关在最后需要被打开。  \n\n然而作为闯关者，可怜和法海并不知道 $s$。因此他们决定采用一个比较稳妥的方法：瞎按。他们根据开关的外形、位置，通过一些玄学的方法给每一个开关赋予了一个权值 $p_i$（$p_i > 0$）每一次，他们会以正比于 $p_i$ 的概率（第 $i$ 个开关被选中的概率是 $\\frac{p_i}{\\sum^n_{j=1}p_j}$ 选择并按下一个开关。开关被按下后，状态会被反转，即开变关，关变开。**注意，每一轮的选择都是完全独立的。**\n\n在按开关的过程中，一旦当前开关的状态达到了 $s$ 那么可怜和法海面前的门就会打开，他们会马上停止按开关的过程并前往下一关。作为一名欧皇，可怜在按了 $\\sum^n_{i=1} s_i$ 次后，就打开了大门。为了感受一下自己的运气是多么的好，可怜想要让你帮她计算一下，用这种随机按的方式，期望需要按多少次开关才能通过这一关。", "inputFormat": "第一行输入一个整数 $n$，表示开关的数量。  \n第二行输入 $n$ 个整数 $s_i$（$s_i\\in \\{0,1\\}$），表示开关的目标状态。第三行同样输入 $n$ 个整数 $p_i$，表示每个开关的权值。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为，$\\frac{x}{y}$（$x \\ge 0$，$y \\ge 1$，$\\gcd(x, y) = 1$），你需要输出 $x \\times y^{-1} \\bmod 998244353$。", "hint": "**【样例解释 \\#1】**\n\n前两次按开关，有 $\\frac12$ 的概率达到 $s$，有 $\\frac12$ 的概率回到原状。因此期望的按开关数量为：\n\n$$\\sum^{+\\infty}_{i=1}2i\\times \\left(\\frac12\\right)^i=4$$\n\n---\n\n**【数据范围与约定】**\n\n| 测试点 | $n$ | 其他约定 | 测试点 | $n$ | 其他约定 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=2$ | 无 | $6$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $2$ | $=2$ | 无 | $7$ | $\\le 100$ | $p_i\\le 2,s_i=1$ |\n| $3$ | $\\le 8$ | 无 | $8$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $4$ | $\\le 8$ | 无 | $9$ | $\\le 100$ | $\\sum p_i\\le 2\\times 10^3$ |\n| $5$ | $\\le 100$ | $p_i=1$ | $10$ | $\\le 100$ | 无 |\n\n对于 $100\\%$ 的数据，保证 $n\\ge1$，$\\sum^n_{i=1}p_i\\le5\\times10^4$，$p_i\\ge1$。", "locale": "zh-CN"}}}
{"pid": "P5327", "type": "P", "difficulty": 7, "samples": [["5 3\n1 2\n1 3\n3 4\n3 5\n3 4\n1 4\n2 5", "8"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] 语言", "background": "", "description": "九条可怜是一个喜欢规律的女孩子。按照规律，第二题应该是一道和数据结构有关的题。\n\n在一个遥远的国度，有 $n$ 个城市。城市之间有 $n - 1$ 条双向道路，这些道路保证了任何两个城市之间都能直接或者间接地到达。\n\n在上古时代，这 $n$ 个城市之间处于战争状态。在高度闭塞的环境中，每个城市都发展出了自己的语言。而在王国统一之后，语言不通给王国的发展带来了极大的阻碍。为了改善这种情况，国王下令设计了 $m$ 种通用语，并进行了 $m$ 次语言统一工作。在第 $i$ 次统一工作中，一名大臣从城市 $s_i$ 出发，沿着最短的路径走到了 $t_i$，教会了沿途所有城市（包括 $s_i, t_i$）使用第 $i$ 个通用语。\n\n一旦有了共通的语言，那么城市之间就可以开展贸易活动了。两个城市 $u_i, v_i$ 之间可以开展贸易活动当且仅当存在一种通用语 $L$ 满足 $u_i$ 到 $v_i$ 最短路上的所有城市（包括 $u_i, v_i$），都会使用 $L$。\n\n为了衡量语言统一工作的效果，国王想让你计算有多少对城市 $(u, v)$（$u < v$），他们之间可以开展贸易活动。", "inputFormat": "第一行输入两个正整数 $n, m$，表示城市数和通用语的数量。\n\n接下来 $n - 1$ 行，每行两个整数 $x_i, y_i$（$1 \\le x_i, y_i \\le n$），表示了一条连接城市 $x_i, y_i$ 的道路。\n\n接下来 $m$ 行，每行两个整数 $s_i, t_i$（$1 \\le s_i, t_i \\le n$），表示一次语言普及工作。", "outputFormat": "输出一行一个整数，表示可以开展贸易活动的城市对数量。", "hint": "\n#### 样例说明\n可以开展贸易活动的城市对为 $(1, 2), (1, 3), (1, 4), (1, 5), (2, 3), (2, 5), (3, 4), (3, 5)$。\n\n#### 数据范围\n\n|测试点|$n$|$m$|其他约定|\n|:-:|:-:|:-:|:-:|\n|$1,2$|$\\le 300$|$\\le 300$|无|\n|$3,4$|$\\le 5\\times 10^3$|$\\le 5\\times 10^3$|无|\n|$5,6$|$\\le 10^5$|$\\le 10^5$|$y_i=x_i+1$|\n|$7\\sim 10$|$\\le 10^5$|$\\le 10^5$|无|\n\n对于 $100\\%$ 的数据，有 $1 \\le x_i, y_i, s_i, t_i \\le n\\leq 10 ^ 5$，$1\\leq m\\leq 10 ^ 5$，$x_i\\neq y_i$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Language", "background": "", "description": "Jiutiao Keliang is a girl who likes patterns. By this pattern, the second problem should be related to data structures.\n\nIn a distant kingdom, there are $n$ cities. There are $n - 1$ bidirectional roads between the cities, and these roads guarantee that any two cities can reach each other directly or indirectly.\n\nIn ancient times, these $n$ cities were at war with each other. In a highly isolated environment, each city developed its own language. After the kingdom was unified, language barriers greatly hindered the kingdom’s development. To improve this, the king ordered the design of $m$ common languages and carried out $m$ language unification operations. In the $i$-th operation, a minister started from city $s_i$, walked to $t_i$ along the shortest path, and taught every city on the way (including $s_i$ and $t_i$) to use the $i$-th common language.\n\nOnce there is a shared language, cities can conduct trade. Two cities $u_i, v_i$ can conduct trade if and only if there exists a common language $L$ such that every city on the shortest path from $u_i$ to $v_i$ (including $u_i$ and $v_i$) can use $L$.\n\nTo measure the effect of the language unification operations, the king wants you to compute how many pairs of cities $(u, v)$ with $u < v$ can conduct trade.", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of cities and the number of common languages.\n\nThe next $n - 1$ lines each contain two integers $x_i, y_i$ ($1 \\le x_i, y_i \\le n$), indicating a road connecting cities $x_i$ and $y_i$.\n\nThe next $m$ lines each contain two integers $s_i, t_i$ ($1 \\le s_i, t_i \\le n$), indicating one language promotion operation.", "outputFormat": "Output one line with one integer, representing the number of pairs of cities that can conduct trade.", "hint": "#### Sample Explanation\nThe pairs of cities that can conduct trade are $(1, 2), (1, 3), (1, 4), (1, 5), (2, 3), (2, 5), (3, 4), (3, 5)$.\n\n#### Constraints\n\n|Test Point|$n$|$m$|Other Constraints|\n|:-:|:-:|:-:|:-:|\n|$1,2$|$\\le 300$|$\\le 300$|None|\n|$3,4$|$\\le 5\\times 10^3$|$\\le 5\\times 10^3$|None|\n|$5,6$|$\\le 10^5$|$\\le 10^5$|$y_i=x_i+1$|\n|$7\\sim 10$|$\\le 10^5$|$\\le 10^5$|None|\n\nFor $100\\%$ of the testdata, $1 \\le x_i, y_i, s_i, t_i \\le n\\leq 10 ^ 5$, $1\\leq m\\leq 10 ^ 5$, and $x_i\\neq y_i$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 语言", "background": "", "description": "九条可怜是一个喜欢规律的女孩子。按照规律，第二题应该是一道和数据结构有关的题。\n\n在一个遥远的国度，有 $n$ 个城市。城市之间有 $n - 1$ 条双向道路，这些道路保证了任何两个城市之间都能直接或者间接地到达。\n\n在上古时代，这 $n$ 个城市之间处于战争状态。在高度闭塞的环境中，每个城市都发展出了自己的语言。而在王国统一之后，语言不通给王国的发展带来了极大的阻碍。为了改善这种情况，国王下令设计了 $m$ 种通用语，并进行了 $m$ 次语言统一工作。在第 $i$ 次统一工作中，一名大臣从城市 $s_i$ 出发，沿着最短的路径走到了 $t_i$，教会了沿途所有城市（包括 $s_i, t_i$）使用第 $i$ 个通用语。\n\n一旦有了共通的语言，那么城市之间就可以开展贸易活动了。两个城市 $u_i, v_i$ 之间可以开展贸易活动当且仅当存在一种通用语 $L$ 满足 $u_i$ 到 $v_i$ 最短路上的所有城市（包括 $u_i, v_i$），都会使用 $L$。\n\n为了衡量语言统一工作的效果，国王想让你计算有多少对城市 $(u, v)$（$u < v$），他们之间可以开展贸易活动。", "inputFormat": "第一行输入两个正整数 $n, m$，表示城市数和通用语的数量。\n\n接下来 $n - 1$ 行，每行两个整数 $x_i, y_i$（$1 \\le x_i, y_i \\le n$），表示了一条连接城市 $x_i, y_i$ 的道路。\n\n接下来 $m$ 行，每行两个整数 $s_i, t_i$（$1 \\le s_i, t_i \\le n$），表示一次语言普及工作。", "outputFormat": "输出一行一个整数，表示可以开展贸易活动的城市对数量。", "hint": "\n#### 样例说明\n可以开展贸易活动的城市对为 $(1, 2), (1, 3), (1, 4), (1, 5), (2, 3), (2, 5), (3, 4), (3, 5)$。\n\n#### 数据范围\n\n|测试点|$n$|$m$|其他约定|\n|:-:|:-:|:-:|:-:|\n|$1,2$|$\\le 300$|$\\le 300$|无|\n|$3,4$|$\\le 5\\times 10^3$|$\\le 5\\times 10^3$|无|\n|$5,6$|$\\le 10^5$|$\\le 10^5$|$y_i=x_i+1$|\n|$7\\sim 10$|$\\le 10^5$|$\\le 10^5$|无|\n\n对于 $100\\%$ 的数据，有 $1 \\le x_i, y_i, s_i, t_i \\le n\\leq 10 ^ 5$，$1\\leq m\\leq 10 ^ 5$，$x_i\\neq y_i$。", "locale": "zh-CN"}}}
{"pid": "P5328", "type": "P", "difficulty": 7, "samples": [["3 1\n1 5\n5 1\n2 2", "1 1 -1"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] 浙江省选", "background": "", "description": "九条可怜是一个喜欢出题的女孩子，这道题是一道有关浙江省选的硬核模拟题。  \n\n在 $9102$ 年，有 $n$ 名选手参加了浙江省选，其中第 $i$ 个选手的智力是 $a_i$，训练量是 $b_i$。作为\n出题人，可怜可以自由选择这套题的风格是比较偏套路还是比较偏智力。举例来说，$\\mathrm{ZJOI}2018$ 的题就比较偏智力，今年的题就比较偏套路。  \n\n为了定量衡量一套题的风格，可怜定义了反向选拔指数 $x$，$x$ 是一个**非负整数**。第 $i$ 个选手在反向选拔指数为 $x$ 的题目上的表现为 $a_ix+b_i$。在 $x$ 给定的情况下，第 $i$ 个人的排名为表现严格大于 $a_ix+bi$ 的人数再加一。  \n\n在 $9102$ 年浙江省队的人数为 $m$，因此只有排名小于等于 $m$ 的人才能够进入浙江省队。注意当有并列的情况时，进入浙江省队的人数可能多于 $m$。\n\n不难发现，选手的排名和 $x$ 的关系非常大。现在，可怜想让你计算，第 $i$ 个选手有没有可能进入浙江省队，如果有可能，他最好的排名是多少。  \n", "inputFormat": "第一行输入两个整数 $n,m(m\\leq n)$，表示选手总数以及浙江省队的人数。  \n接下来 $n$ 行每行两个整数 $a_i,b_i$，表示每个选手的属性值。\n", "outputFormat": "输出一行 $n$ 个整数，如果第 $i$ 个选手进不了浙江省队，就输出 $-1$，否则输出他可能的最好排名。", "hint": "## 样例 1 解释\n当 $x=1$ 时，三个人的表现分别为 $6,6,4$，这时前两个人并列第一名，都能进入省队，而第三个人排名第三，没法进入省队。  \n\n当 $x>1$ 时，第二个人的表现严格好于第三个人，而当 $x=0$ 时，第一个人的表现严格好于第三个人，因此第三个人无论 $x$ 怎么取，他都没有办法进入省队。  \n\n## 数据范围与约定\n| 测试点 | $n$ | $m$ | 测试点 | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 200$ | $\\le 20$ | $6$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $2$ | $\\le 200$ | $\\le 20$ | $7$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $3$ | $\\le 10^5$ | $=1$ | $8$ | $\\le 10^5$ | $\\le 20$ |\n| $4$ | $\\le 10^5$ | $\\le 2$ | $9$ | $\\le 10^5$ | $\\le 20$ |\n| $5$ | $\\le 10^5$ | $\\le 2$  | $10$ | $\\le 10^5$ | $\\le 20$ |\n\n对于 $100\\%$ 的数据，$1\\leq a_i \\leq 10^9$，$1\\leq b_i \\leq 10^{18}$，$1\\leq m \\leq n$。\n\n对于 $100\\%$ 的数据，保证选手的属性两两不同，即 $ \\forall 1\\leq i < j \\leq n$，有 $a_i\\neq a_j$ 或 $b_i\\neq b_j$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Zhejiang NOI Qualifier", "background": "", "description": "Kyuukawa Karen is a girl who likes to create problems. This problem is a hardcore simulation problem about the Zhejiang NOI Qualifier.\n\nIn the year $9102$, there are $n$ contestants participating in the Zhejiang NOI Qualifier. The $i$-th contestant has intelligence $a_i$ and training amount $b_i$. As the problem setter, Karen can freely choose whether this set of problems is more “pattern-based” or more “intelligence-based”. For example, the problems in ZJOI 2018 were more intelligence-based, while this year’s problems are more pattern-based.\n\nTo measure the style of a set of problems quantitatively, Karen defines the reverse selection index $x$, where $x$ is a **non-negative integer**. The performance of the $i$-th contestant on problems with reverse selection index $x$ is $a_ix+b_i$. When $x$ is fixed, the rank of the $i$-th person is the number of people whose performance is strictly greater than $a_ix+b_i$, plus one.\n\nIn the year $9102$, the size of the Zhejiang provincial team is $m$, so only those with rank $\\le m$ can enter the team. Note that when there are ties, the number of people who enter the team may be greater than $m$.\n\nIt is not hard to see that a contestant’s rank depends heavily on $x$. Now, Karen wants you to compute whether the $i$-th contestant can possibly enter the Zhejiang provincial team. If possible, what is their best possible rank.", "inputFormat": "The first line contains two integers $n,m(m\\leq n)$, representing the total number of contestants and the size of the Zhejiang provincial team.  \nThe next $n$ lines each contain two integers $a_i,b_i$, representing each contestant’s attributes.", "outputFormat": "Output one line with $n$ integers. If the $i$-th contestant cannot enter the Zhejiang provincial team, output $-1$. Otherwise, output their best possible rank.", "hint": "# Constraints\n\n## Explanation of Sample 1\n\nWhen $x=1$, the three contestants’ performances are $6,6,4$. At this time, the first two contestants are tied for 1st place, and both can enter the provincial team. The third contestant ranks 3rd and cannot enter.\n\nWhen $x>1$, the second contestant’s performance is strictly better than the third contestant’s. When $x=0$, the first contestant’s performance is strictly better than the third contestant’s. Therefore, no matter how $x$ is chosen, the third contestant has no way to enter the provincial team.\n\n## Constraints and Notes\n\n| Test Point | $n$ | $m$ | Test Point | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 200$ | $\\le 20$ | $6$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $2$ | $\\le 200$ | $\\le 20$ | $7$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $3$ | $\\le 10^5$ | $=1$ | $8$ | $\\le 10^5$ | $\\le 20$ |\n| $4$ | $\\le 10^5$ | $\\le 2$ | $9$ | $\\le 10^5$ | $\\le 20$ |\n| $5$ | $\\le 10^5$ | $\\le 2$  | $10$ | $\\le 10^5$ | $\\le 20$ |\n\nFor $100\\%$ of the data, $1\\leq a_i \\leq 10^9$, $1\\leq b_i \\leq 10^{18}$, and $1\\leq m \\leq n$.\n\nFor $100\\%$ of the data, it is guaranteed that all contestants’ attributes are pairwise different, i.e., $ \\forall 1\\leq i < j \\leq n$, we have $a_i\\neq a_j$ or $b_i\\neq b_j$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 浙江省选", "background": "", "description": "九条可怜是一个喜欢出题的女孩子，这道题是一道有关浙江省选的硬核模拟题。  \n\n在 $9102$ 年，有 $n$ 名选手参加了浙江省选，其中第 $i$ 个选手的智力是 $a_i$，训练量是 $b_i$。作为\n出题人，可怜可以自由选择这套题的风格是比较偏套路还是比较偏智力。举例来说，$\\mathrm{ZJOI}2018$ 的题就比较偏智力，今年的题就比较偏套路。  \n\n为了定量衡量一套题的风格，可怜定义了反向选拔指数 $x$，$x$ 是一个**非负整数**。第 $i$ 个选手在反向选拔指数为 $x$ 的题目上的表现为 $a_ix+b_i$。在 $x$ 给定的情况下，第 $i$ 个人的排名为表现严格大于 $a_ix+bi$ 的人数再加一。  \n\n在 $9102$ 年浙江省队的人数为 $m$，因此只有排名小于等于 $m$ 的人才能够进入浙江省队。注意当有并列的情况时，进入浙江省队的人数可能多于 $m$。\n\n不难发现，选手的排名和 $x$ 的关系非常大。现在，可怜想让你计算，第 $i$ 个选手有没有可能进入浙江省队，如果有可能，他最好的排名是多少。  \n", "inputFormat": "第一行输入两个整数 $n,m(m\\leq n)$，表示选手总数以及浙江省队的人数。  \n接下来 $n$ 行每行两个整数 $a_i,b_i$，表示每个选手的属性值。\n", "outputFormat": "输出一行 $n$ 个整数，如果第 $i$ 个选手进不了浙江省队，就输出 $-1$，否则输出他可能的最好排名。", "hint": "## 样例 1 解释\n当 $x=1$ 时，三个人的表现分别为 $6,6,4$，这时前两个人并列第一名，都能进入省队，而第三个人排名第三，没法进入省队。  \n\n当 $x>1$ 时，第二个人的表现严格好于第三个人，而当 $x=0$ 时，第一个人的表现严格好于第三个人，因此第三个人无论 $x$ 怎么取，他都没有办法进入省队。  \n\n## 数据范围与约定\n| 测试点 | $n$ | $m$ | 测试点 | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le 200$ | $\\le 20$ | $6$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $2$ | $\\le 200$ | $\\le 20$ | $7$ | $\\le 2\\times 10^4$ | $\\le 20$ |\n| $3$ | $\\le 10^5$ | $=1$ | $8$ | $\\le 10^5$ | $\\le 20$ |\n| $4$ | $\\le 10^5$ | $\\le 2$ | $9$ | $\\le 10^5$ | $\\le 20$ |\n| $5$ | $\\le 10^5$ | $\\le 2$  | $10$ | $\\le 10^5$ | $\\le 20$ |\n\n对于 $100\\%$ 的数据，$1\\leq a_i \\leq 10^9$，$1\\leq b_i \\leq 10^{18}$，$1\\leq m \\leq n$。\n\n对于 $100\\%$ 的数据，保证选手的属性两两不同，即 $ \\forall 1\\leq i < j \\leq n$，有 $a_i\\neq a_j$ 或 $b_i\\neq b_j$。", "locale": "zh-CN"}}}
