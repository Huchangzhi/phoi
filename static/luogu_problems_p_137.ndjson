{"pid": "P3776", "type": "P", "difficulty": 7, "samples": [["6 4 9 4\n3 3\nNWESSWEWS\n2 3 2 3\n3 2 4 4\n5 3 6 4\n1 2 5 3", "0\n2\n1\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "APIO"], "title": "[APIO2017] 斑斓之地", "background": "本题原为交互题，这里采用传统题形式进行评测。", "description": "在很久以前的黄金时代，澳大利亚的土地是矩形的，它可以被划分成 $R$ 行 $C$ 列的网格状，行的编号从北到南依次为 $1$ 到 $R$ ，列的编号从西到东依次为 $1$ 到 $C$，$(r,c)$ 表示第 $r$ 行第 $c$ 列的土地。一天，伟大的彩虹蛇从 $(s_r,s_c)$ 出发在澳大利亚的土地上移动，彩虹蛇连续进行了 $M$ 次移动，每次它会向正北 (`N`)、正南 (`S`)、正东 (`E`) 或正西 (`W`) 方向移动一格，其经过的所有的格子（包括起点和终点）都会变成河流。保证在任一时刻，彩虹蛇都不会离开这片 $R$ 行 $C$ 列的矩形土地。\n\n数百万年之后，你想购买一块矩形区域纪念伟大的彩虹蛇。你想给所购买矩形区域内每一块不是河流的格子都染上颜色，要求相邻的格子颜色必须相同，两个格子相邻当且仅当两个格子有一条公共边，你所购买区域之外的格子无须染色。\n\n现在给出彩虹蛇 $M$ 次移动的方向，你有 $Q$ 个购买矩形区域的方案，问每个方案最多能够将土地染上多少种不同的颜色。", "inputFormat": "第一行：四个整数 $R$，$C$，$M$ 和 $Q$；\n\n第二行：两个整数 $s_r$ 和 $s_c$；\n\n第三行: 一个包含 $M$ 个字符的字符串 $S$，每个字符是 `N`、`S`、`E`、`W` 之一（如果 $M=0$ 则此行留空）；\n\n第四到 $Q+3$ 行: 每行四个整数 $a_r,a_c,b_r$ 和 $b_c$，表示你购买的土地范围，左上角是 $(a_r,a_c)$，右下角是 $(b_r,b_c)$。", "outputFormat": "对于每个询问做出回答，输出最多能够将土地染上多少种不同的颜色。", "hint": "### 样例解释\n\n样例对应下图，其中蓝色代表河流。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1mhty5m8.png)\n\n### 数据范围\n\n对于所有测试数据，$0\\le M\\le 10^5$，并且 $R,C,Q\\ge 1$，对于每个购买矩形土地的方案，都有 $1 \\le a_r \\le b_r \\le R, 1 \\le a_c \\le b_c \\le C$。\n\n详细子任务分值及附加条件如下表。\n\n|子任务编号|分值|$R$|$C$|$Q$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$11$|$R\\le 50$|$C\\le 50$|$Q\\le 1000$|\n|$2$|$12$|$R=2$|$C\\le 2\\times 10^5$|$Q\\le 10^5$|\n|$3$|$24$|$R\\le 2\\times 10^5$|$C\\le 2\\times 10^5$|$Q=1$|\n|$4$|$27$|$R\\le 1000$|$C\\le 1000$|$Q\\le 10^5$|\n|$5$|$26$|$R\\le 2\\times 10^5$|$C\\le 2\\times 10^5$|$Q\\le 10^5$|\n", "locale": "zh-CN", "translations": {"en": {"title": "[APIO2017] The Colorful Land", "background": "This problem was originally interactive; here it is evaluated in the traditional (non-interactive) format.", "description": "In the distant Golden Age, the land of Australia was rectangular and could be divided into a grid with $R$ rows and $C$ columns. Rows are numbered $1$ to $R$ from north to south, and columns are numbered $1$ to $C$ from west to east. The cell $(r, c)$ denotes the land in row $r$ and column $c$. One day, the great Rainbow Serpent started at $(s_r, s_c)$ and moved across Australia. The serpent made $M$ consecutive moves, each time moving one cell to the north (`N`), south (`S`), east (`E`), or west (`W`). Every cell it passed through (including the start and end cells) turned into river. It is guaranteed that the Rainbow Serpent never leaves the $R \\times C$ rectangular land at any time.\n\nMillions of years later, you want to buy a rectangular area to commemorate the great Rainbow Serpent. You want to color every non-river cell inside the purchased rectangle, with the requirement that adjacent cells must have the same color. Two cells are adjacent if and only if they share a common side. Cells outside your purchased area do not need to be colored.\n\nYou are given the $M$ movement directions of the Rainbow Serpent and $Q$ candidate rectangular regions to purchase. For each region, determine the maximum number of different colors you can use.", "inputFormat": "The first line contains four integers $R$, $C$, $M$, and $Q$.\n\nThe second line contains two integers $s_r$ and $s_c$.\n\nThe third line contains a string $S$ of $M$ characters, each being one of `N`, `S`, `E`, or `W` (if $M=0$, this line is left blank).\n\nLines $4$ through $Q+3$: each line contains four integers $a_r$, $a_c$, $b_r$, and $b_c$, describing the land you intend to purchase, whose top-left corner is $(a_r, a_c)$ and bottom-right corner is $(b_r, b_c)$.", "outputFormat": "For each query, output the maximum number of different colors that the land can be painted with.", "hint": "### Sample Explanation\n\nThe sample corresponds to the figure below, where blue cells represent rivers.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1mhty5m8.png)\n\n### Constraints\n\nFor all testdata, $0 \\le M \\le 10^5$, and $R, C, Q \\ge 1$. For every purchased rectangle, $1 \\le a_r \\le b_r \\le R$ and $1 \\le a_c \\le b_c \\le C$.\n\nThe detailed subtask scores and additional conditions are as follows.\n\n| Subtask ID | Score | $R$ | $C$ | $Q$ |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $11$ | $R \\le 50$ | $C \\le 50$ | $Q \\le 1000$ |\n| $2$ | $12$ | $R = 2$ | $C \\le 2 \\times 10^5$ | $Q \\le 10^5$ |\n| $3$ | $24$ | $R \\le 2 \\times 10^5$ | $C \\le 2 \\times 10^5$ | $Q = 1$ |\n| $4$ | $27$ | $R \\le 1000$ | $C \\le 1000$ | $Q \\le 10^5$ |\n| $5$ | $26$ | $R \\le 2 \\times 10^5$ | $C \\le 2 \\times 10^5$ | $Q \\le 10^5$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[APIO2017] 斑斓之地", "background": "本题原为交互题，这里采用传统题形式进行评测。", "description": "在很久以前的黄金时代，澳大利亚的土地是矩形的，它可以被划分成 $R$ 行 $C$ 列的网格状，行的编号从北到南依次为 $1$ 到 $R$ ，列的编号从西到东依次为 $1$ 到 $C$，$(r,c)$ 表示第 $r$ 行第 $c$ 列的土地。一天，伟大的彩虹蛇从 $(s_r,s_c)$ 出发在澳大利亚的土地上移动，彩虹蛇连续进行了 $M$ 次移动，每次它会向正北 (`N`)、正南 (`S`)、正东 (`E`) 或正西 (`W`) 方向移动一格，其经过的所有的格子（包括起点和终点）都会变成河流。保证在任一时刻，彩虹蛇都不会离开这片 $R$ 行 $C$ 列的矩形土地。\n\n数百万年之后，你想购买一块矩形区域纪念伟大的彩虹蛇。你想给所购买矩形区域内每一块不是河流的格子都染上颜色，要求相邻的格子颜色必须相同，两个格子相邻当且仅当两个格子有一条公共边，你所购买区域之外的格子无须染色。\n\n现在给出彩虹蛇 $M$ 次移动的方向，你有 $Q$ 个购买矩形区域的方案，问每个方案最多能够将土地染上多少种不同的颜色。", "inputFormat": "第一行：四个整数 $R$，$C$，$M$ 和 $Q$；\n\n第二行：两个整数 $s_r$ 和 $s_c$；\n\n第三行: 一个包含 $M$ 个字符的字符串 $S$，每个字符是 `N`、`S`、`E`、`W` 之一（如果 $M=0$ 则此行留空）；\n\n第四到 $Q+3$ 行: 每行四个整数 $a_r,a_c,b_r$ 和 $b_c$，表示你购买的土地范围，左上角是 $(a_r,a_c)$，右下角是 $(b_r,b_c)$。", "outputFormat": "对于每个询问做出回答，输出最多能够将土地染上多少种不同的颜色。", "hint": "### 样例解释\n\n样例对应下图，其中蓝色代表河流。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1mhty5m8.png)\n\n### 数据范围\n\n对于所有测试数据，$0\\le M\\le 10^5$，并且 $R,C,Q\\ge 1$，对于每个购买矩形土地的方案，都有 $1 \\le a_r \\le b_r \\le R, 1 \\le a_c \\le b_c \\le C$。\n\n详细子任务分值及附加条件如下表。\n\n|子任务编号|分值|$R$|$C$|$Q$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$11$|$R\\le 50$|$C\\le 50$|$Q\\le 1000$|\n|$2$|$12$|$R=2$|$C\\le 2\\times 10^5$|$Q\\le 10^5$|\n|$3$|$24$|$R\\le 2\\times 10^5$|$C\\le 2\\times 10^5$|$Q=1$|\n|$4$|$27$|$R\\le 1000$|$C\\le 1000$|$Q\\le 10^5$|\n|$5$|$26$|$R\\le 2\\times 10^5$|$C\\le 2\\times 10^5$|$Q\\le 10^5$|\n", "locale": "zh-CN"}}}
{"pid": "P3777", "type": "P", "difficulty": 6, "samples": [], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "APIO", "交互题", "Special Judge"], "title": "[APIO2017] 考拉的游戏", "background": "### 特别提示\n\n**在洛谷提交本题时的一些注意事项（与原题面不同之处请以此处为准）：**\n\n1. 提交时请在程序里加入以下函数声明语句：\n\n```cpp\nvoid playRound(int*,int*);\n```\n\n2. 程序开头不用，也不应该包含 `koala.h` 头文件。\n3. 仅支持 `C++`（含 `C++`，`C++11`，`C++14`，`C++17`）提交。", "description": "Koala 发明了一个新游戏，来邀请你一起玩！游戏的开始，她会在桌上放 $N$ 个物品，物品从 $0$ 到 $N - 1$ 标号。接着，她会秘密地给每个物品分配一个 $1$ 到 $N$ 之间的整数权值，且任意两个物品不会被分配到相同的权值。其中，第 $i$ 个物品的权值为 $P_i$。她请你来确定由这些权值构成的序列 $P=P_0,P_1,\\dots ,P_{N-1}$ 的一些特征。\n\n为了回答她的问题，你可以请 Koala 玩若干轮游戏。每一轮中，你会得到 $W$ 个蓝色石子，Koala 会得到 $W$ 个红色石子。首先，你可以选择若干个物品，再把你的一些（或全部）石子放在这些物品的旁边。Koala 会观察你的石子分配，然后类似地把她的一些（或全部）石子放在若干个物品旁边。如果一个物品旁边的红色石子数严格大于蓝色石子数，那么，Koala可以获得这个物品。Koala 分配她的石子时，总会选择使她获得的物品的权值和最大的方案，如果有多种方案可以做到这一点，她会选择一种获得的物品数最多的方案，如果仍然有多种方案，她会选择其中任意一种。\n\nKoala 非常懒，如果你和她玩太多轮游戏，她就会睡着。你的任务是通过尽可能少轮数的游戏，确定 Koala 的序列 $P$ 的相关特征。\n\n### 任务\n\n在这个任务中，你需要实现 $4$ 个函数：`minValue`, `maxValue`, `greaterValue` 和 `allValues`。\n\n每个函数需要你确定序列 $P$ 的不同特征。我们强烈推荐在我们提供的模版的基础上进行作答。注意，即使你只想获得部分子任务的分数，你也必须为四个函数都提供一个实现（尽管一些函数的内部可能为空）。你的程序禁止从标准输入读数据、向标准输出写数据或与任何文件交互。\n\n在每个函数中，参数 `N` 表示游戏中物品的个数，参数 `W` 表示你和 Koala 在每一轮游戏中拥有的石子数。\n\n* `minValue(N, W)` --- 这个函数需要返回权值最小的物品的标号 $i$，即 $P_i=1$\n* `maxValue(N, W)` --- 这个函数需要返回权值最大的物品的标号 $i$，即 $P_i=N$\n* `greaterValue(N, W)` --- 这个函数需要比较物品 $0$ 和物品 $1$ 的权值，返回权值较大的物品的标号。具体来说，若 $P_0>P_1$​，它应该返回 $0$ ，否则返回 $1$ 。\n* `allValues(N, W, P)` --- 这个函数需要确定整个排列，并将其存放在给定的数组 $P$ 中：具体来说，$P[i]$ 应该保存物品 $i$ 的权值 $P_i (0 \\leq i \\leq N-1)$。\n\n在每个测试点中，交互库会一次或多次调用这些函数中的一个。每次函数调用代表不同的任务，哪个函数会被调用、以及最多被调用多少次取决于子任务（见下文）。你可以认为 Koala 在每次函数调用前确定了她的序列 $P$，并且序列不会在一次函数的调用过程中改变。一次调用结束后，她可以在下次函数调用之前改变她的序列。\n\n你实现的四个函数可以通过调用函数 `playRound` 来获取 Koala 的序列的相关信息。\n\n* `playRound(B, R)`，请 Koala 和你玩一轮游戏。\n\n数组 `B` 描述你在每个物品旁边放了多少蓝色石子。具体来说，对任意 $0 \\leq i \\leq N-1$，$B[i]$ 个蓝色石子将会被放在物品 $i$ 旁边。每个 $B[i]$ 必须是一个非负整数，且 $B[0]+B[1]+\\cdots +B[N-1]$ 不能超过 $W$ 。\n\n交互库会把 Koala 的回应存放在你提供的数组 `R` 中。具体来说，对任意 $0 \\leq i \\leq N-1$，Koala 会在物品 $i$ 旁边放 $R[i]$ 个红色石子。\n\n每个子任务对你在每次游戏中调用 `playRound` 的次数有所限制。注意，调用次数越少你的得分可能会越高。（具体限制和评分方式参见下文）", "inputFormat": "", "outputFormat": "", "hint": "### 子任务\n\n#### 样例数据：$0$ 分\n\n**因为特殊原因（不支持设置 $0$ 分测试点），评测时将不测样例**。\n\n* 有 $5$ 个「样例数据」测试点，每个测试点恰好调用一次 $4$ 个函数中的某一个。请看下文的「样例」获取各测试点的详细信息。\n* $N=6$\n* $P=5,3,2,1,6,4$\n\n每次游戏中，你可以调用 `playRound `至多 $3200$ 次。\n\n#### 子任务 1：$4$ 分\n* 在这个子任务中，交互库只会调用函数 `minValue`，每个测试点中，这个函数最多会被调用 $100$ 次。\n* $N=100$\n* $W=100$\n* 每一次游戏中，你可以调用 `playRound` 至多 $2$ 次。\n\n#### 子任务 2：$15$ 分\n* 在这个子任务中，交互库只会调用函数 `maxValue`。每个测试点中，这个函数最多会被调用 $100$ 次。\n* $N=100$\n* $W=100$\n* 每一次游戏中，你可以调用 `playRound` 至多 $13$ 次。\n* 这个子任务中，一个测试点的分数取决于每一轮游戏中 `playRound` 被调用次数的最大值 $C_{max}$，具体来说，你的得分为：\n  - 若 $C_{max}\\leq 4$，获得 $15$ 分。\n  - 若 $5 \\leq C_{max} \\leq 13$，获得 $7$ 分。\n\n#### 子任务 3：$18$ 分\n* 在这个子任务中，交互库只会调用函数 `greaterValue`。每个测试点中，这个函数最多会被调用 $1100$ 次。\n* $N=100$\n* $W=100$\n* 每一次游戏中，你可以调用 `playRound` 至多 $14$ 次。\n* 这个子任务中，一个测试点的分数取决于每一轮游戏中 `playRound` 被调用次数的最大值 $C_{max}$，具体来说，你的得分为：\n  - 若 $C_{max}\\leq 3$，获得 $18$ 分。\n  - 若 $C_{max}=4$，获得 $14$ 分。\n  - 若 $C_{max}=5$，获得 $11$ 分。\n  - 若 $6 \\leq C_{max}\\leq 14$，获得 $5$ 分。\n\n#### 子任务 4：$10$ 分\n* 在这个子任务中，交互库只会调用函数 `allValues`，每个测试点中，这个函数会被调用恰好一次。\n* $N=100$\n* $W=200$\n* 你可以调用 `playRound` 至多 $700$ 次。\n\n#### 子任务 5：$53$ 分\n* 在这个子任务中，交互库只会调用函数 `allValues`，每个测试点中，这个函数会被调用恰好一次。\n* $N=100$\n* $W=100$\n* 你可以调用 `playRound` 至多 $3200$ 次。\n* 这个子任务中，一个测试点的分数取决于 `playRound` 被调用的次数 $C$ ，具体来说，你的得分为：\n  - 若 $C \\leq 100$，获得 $53$ 分。\n  - 若 $101 \\leq C \\leq 3200$，获得 $\\lfloor 53-8 \\log_2 (c/100) \\rfloor$ 分。其中，$\\lfloor x \\rfloor$ 为不大于 $x$ 的最大整数。举例来说，若 $C=3200$，那么你的解答将获得 $13$ 分。\n\n### 评分方式\n\n- 和传统题一样，你的程序的运行时间和空间不能超过时间和空间限制。**交互库运行的时间和空间也会算入你的程序的总时间和空间当中**。当你估算这一部分的时空消耗时，你可以认为，在评测时使用的交互库与我们提供的样例交互库有**相同的函数**和**相似的实现**。\n- 在一个测试点中，若你在调用 `playRound` 时传入了非法的数组 B，或调用 `playRound` 的总次数超过了上限，那么该测试点记 $0$ 分。\n- 在一个测试点的任意一次游戏中，若一个函数没有正确地回答所要求的 Koala 的序列的特征，那么该测试点记 $0$ 分。\n- 子任务 4 和子任务 5 均要求你实现函数 `allValues`，但在调用时传入了不同的 $W$。你可以利用两个子任务在这个参数上的不同，从而在你的实现中区分两个子任务。你可以参考你的语言的模板实现获取更详细的信息。\n- 比赛时，你可以提交本题目最多 60 次，连续两次的提交至少间隔 2 分钟。\n- **你在一个子任务上的得分，等于你在该子任务所有测试点中的最低得分**。\n\n### 如何测试你的程序\n\n在终端下输入如下命令进行编译：\n\n```bash\ng++ grader.cpp koala.cpp -o grader -g -Wall --std=c++11\n```\n\n样例交互库将按如下格式从标准输入读入数据：\n\n第一行两个整数 $F,G$，其中 $F$ 代表交互库调用的函数类型，$G$ 代表调用函数的次数；\n\n接下来 $G$ 行，每行开头两个整数 $N,W$，后跟 $N$ 个整数 $P_0,P_1,\\ldots,P_{N-1}$。\n\n$F$ 对应的样例交互库调用的函数类型如下表所示：\n\n| $F$ | 调用的函数类型 |\n| ----------- | ----------- |\n| $1$ | `minValue` |\n| $2$ | `maxValue` |\n| $3$ | `greaterValue` |\n| $4$ | `allValues` |\n\n对于每次函数调用，样例交互库将向标准输出输出两行。第一行代表你调用 `playRound` 的次数，第二行代表函数调用后返回的结构（对于 $F=4$ 的情况，将输出调用 `allValues` 时返回的数组，对于其他情况，将输出函数的返回值）。\n\n### 样例\n\n考虑如下的排列：\n\n| $i$ | 0 | 1 | 2 | 3 | 4 | 5 |\n| ----------- | ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |\n| $P_i$ | 5 | 3 | 2 | 1 | 6 | 4 |\n\n下表展示了几次调用函数 `playRound` 的例子，以及交互库对每个调用的有效反馈（注意，一次 `playRound` 的调用，可能会有多种可能的有效反馈） 。\n\n| $W$ | 调用 | 可能的交互库反馈 | 解释 |\n| ----------- | ----------- | ----------- | ----------- |\n| 6 | `playRound([0,3,0,2,1,0],R)` | `R=[1,1,1,0,2,1]` | Koala 获得了物品 $0,2,4,5$，总权值为 $17$，这是一种可能的权值最大的方案。 |\n| 6 | `playRound([1,2,3,1,2,0],R)` | 非法调用 | 你总共放了 $9$ 个石子，超过了 $W$ 的限制。 |\n| 12 | `playRound([0,3,0,2,1,0],R)` | `R=[2,3,0,2,3,1]` | 你不用放完 $W$ 个石子，Koala 也不用放完 $W$ 个石子。 |\n| 6 | `playRound([0,1,0,0,1,0],R)` | `R=[1,0,1,1,2,1]` | 若 Koala 有多种方案最大化获得物品的权值，她会选择使自己获得物品最多的方案。因此 `R=[1,2,0,0,2,1]` 不是一个合法的返回值。 |\n\n下面是样例数据的返回值，请注意在样例数据中，你可以调用 `playRound` 至多 $3200$ 次。\n\n| # | 交互库调用 | 期望返回值 | 解释 |\n| ----------- | ----------- | ----------- | ----------- |\n| 1 | `minValue(6,6)` | 3 | $P_3=1$ |\n| 2 | `maxValue(6,6)` | 4 | $P_4=6$ |\n| 3 | `greaterValue(6,6)` | 0 | $P_0=5,P_1=3$ |\n| 4 | `allValues(6,12,P)` | `P=[5,3,2,1,6,4]` | 注意 `allValues` 无返回值，而是将正确结果放入 P 中。 |\n| 5 | `allValues(6,12,P)` | `P=[5,3,2,1,6,4]` | 同上。 |\n\n\n### 附加文件\n\n附加文件包含样例输入输出，C++ 样例交互库和程序模板，我们推荐您在模板的基础上实现您的程序。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[APIO2017] 考拉的游戏", "background": "### 特别提示\n\n**在洛谷提交本题时的一些注意事项（与原题面不同之处请以此处为准）：**\n\n1. 提交时请在程序里加入以下函数声明语句：\n\n```cpp\nvoid playRound(int*,int*);\n```\n\n2. 程序开头不用，也不应该包含 `koala.h` 头文件。\n3. 仅支持 `C++`（含 `C++`，`C++11`，`C++14`，`C++17`）提交。", "description": "Koala 发明了一个新游戏，来邀请你一起玩！游戏的开始，她会在桌上放 $N$ 个物品，物品从 $0$ 到 $N - 1$ 标号。接着，她会秘密地给每个物品分配一个 $1$ 到 $N$ 之间的整数权值，且任意两个物品不会被分配到相同的权值。其中，第 $i$ 个物品的权值为 $P_i$。她请你来确定由这些权值构成的序列 $P=P_0,P_1,\\dots ,P_{N-1}$ 的一些特征。\n\n为了回答她的问题，你可以请 Koala 玩若干轮游戏。每一轮中，你会得到 $W$ 个蓝色石子，Koala 会得到 $W$ 个红色石子。首先，你可以选择若干个物品，再把你的一些（或全部）石子放在这些物品的旁边。Koala 会观察你的石子分配，然后类似地把她的一些（或全部）石子放在若干个物品旁边。如果一个物品旁边的红色石子数严格大于蓝色石子数，那么，Koala可以获得这个物品。Koala 分配她的石子时，总会选择使她获得的物品的权值和最大的方案，如果有多种方案可以做到这一点，她会选择一种获得的物品数最多的方案，如果仍然有多种方案，她会选择其中任意一种。\n\nKoala 非常懒，如果你和她玩太多轮游戏，她就会睡着。你的任务是通过尽可能少轮数的游戏，确定 Koala 的序列 $P$ 的相关特征。\n\n### 任务\n\n在这个任务中，你需要实现 $4$ 个函数：`minValue`, `maxValue`, `greaterValue` 和 `allValues`。\n\n每个函数需要你确定序列 $P$ 的不同特征。我们强烈推荐在我们提供的模版的基础上进行作答。注意，即使你只想获得部分子任务的分数，你也必须为四个函数都提供一个实现（尽管一些函数的内部可能为空）。你的程序禁止从标准输入读数据、向标准输出写数据或与任何文件交互。\n\n在每个函数中，参数 `N` 表示游戏中物品的个数，参数 `W` 表示你和 Koala 在每一轮游戏中拥有的石子数。\n\n* `minValue(N, W)` --- 这个函数需要返回权值最小的物品的标号 $i$，即 $P_i=1$\n* `maxValue(N, W)` --- 这个函数需要返回权值最大的物品的标号 $i$，即 $P_i=N$\n* `greaterValue(N, W)` --- 这个函数需要比较物品 $0$ 和物品 $1$ 的权值，返回权值较大的物品的标号。具体来说，若 $P_0>P_1$​，它应该返回 $0$ ，否则返回 $1$ 。\n* `allValues(N, W, P)` --- 这个函数需要确定整个排列，并将其存放在给定的数组 $P$ 中：具体来说，$P[i]$ 应该保存物品 $i$ 的权值 $P_i (0 \\leq i \\leq N-1)$。\n\n在每个测试点中，交互库会一次或多次调用这些函数中的一个。每次函数调用代表不同的任务，哪个函数会被调用、以及最多被调用多少次取决于子任务（见下文）。你可以认为 Koala 在每次函数调用前确定了她的序列 $P$，并且序列不会在一次函数的调用过程中改变。一次调用结束后，她可以在下次函数调用之前改变她的序列。\n\n你实现的四个函数可以通过调用函数 `playRound` 来获取 Koala 的序列的相关信息。\n\n* `playRound(B, R)`，请 Koala 和你玩一轮游戏。\n\n数组 `B` 描述你在每个物品旁边放了多少蓝色石子。具体来说，对任意 $0 \\leq i \\leq N-1$，$B[i]$ 个蓝色石子将会被放在物品 $i$ 旁边。每个 $B[i]$ 必须是一个非负整数，且 $B[0]+B[1]+\\cdots +B[N-1]$ 不能超过 $W$ 。\n\n交互库会把 Koala 的回应存放在你提供的数组 `R` 中。具体来说，对任意 $0 \\leq i \\leq N-1$，Koala 会在物品 $i$ 旁边放 $R[i]$ 个红色石子。\n\n每个子任务对你在每次游戏中调用 `playRound` 的次数有所限制。注意，调用次数越少你的得分可能会越高。（具体限制和评分方式参见下文）", "inputFormat": "", "outputFormat": "", "hint": "### 子任务\n\n#### 样例数据：$0$ 分\n\n**因为特殊原因（不支持设置 $0$ 分测试点），评测时将不测样例**。\n\n* 有 $5$ 个「样例数据」测试点，每个测试点恰好调用一次 $4$ 个函数中的某一个。请看下文的「样例」获取各测试点的详细信息。\n* $N=6$\n* $P=5,3,2,1,6,4$\n\n每次游戏中，你可以调用 `playRound `至多 $3200$ 次。\n\n#### 子任务 1：$4$ 分\n* 在这个子任务中，交互库只会调用函数 `minValue`，每个测试点中，这个函数最多会被调用 $100$ 次。\n* $N=100$\n* $W=100$\n* 每一次游戏中，你可以调用 `playRound` 至多 $2$ 次。\n\n#### 子任务 2：$15$ 分\n* 在这个子任务中，交互库只会调用函数 `maxValue`。每个测试点中，这个函数最多会被调用 $100$ 次。\n* $N=100$\n* $W=100$\n* 每一次游戏中，你可以调用 `playRound` 至多 $13$ 次。\n* 这个子任务中，一个测试点的分数取决于每一轮游戏中 `playRound` 被调用次数的最大值 $C_{max}$，具体来说，你的得分为：\n  - 若 $C_{max}\\leq 4$，获得 $15$ 分。\n  - 若 $5 \\leq C_{max} \\leq 13$，获得 $7$ 分。\n\n#### 子任务 3：$18$ 分\n* 在这个子任务中，交互库只会调用函数 `greaterValue`。每个测试点中，这个函数最多会被调用 $1100$ 次。\n* $N=100$\n* $W=100$\n* 每一次游戏中，你可以调用 `playRound` 至多 $14$ 次。\n* 这个子任务中，一个测试点的分数取决于每一轮游戏中 `playRound` 被调用次数的最大值 $C_{max}$，具体来说，你的得分为：\n  - 若 $C_{max}\\leq 3$，获得 $18$ 分。\n  - 若 $C_{max}=4$，获得 $14$ 分。\n  - 若 $C_{max}=5$，获得 $11$ 分。\n  - 若 $6 \\leq C_{max}\\leq 14$，获得 $5$ 分。\n\n#### 子任务 4：$10$ 分\n* 在这个子任务中，交互库只会调用函数 `allValues`，每个测试点中，这个函数会被调用恰好一次。\n* $N=100$\n* $W=200$\n* 你可以调用 `playRound` 至多 $700$ 次。\n\n#### 子任务 5：$53$ 分\n* 在这个子任务中，交互库只会调用函数 `allValues`，每个测试点中，这个函数会被调用恰好一次。\n* $N=100$\n* $W=100$\n* 你可以调用 `playRound` 至多 $3200$ 次。\n* 这个子任务中，一个测试点的分数取决于 `playRound` 被调用的次数 $C$ ，具体来说，你的得分为：\n  - 若 $C \\leq 100$，获得 $53$ 分。\n  - 若 $101 \\leq C \\leq 3200$，获得 $\\lfloor 53-8 \\log_2 (c/100) \\rfloor$ 分。其中，$\\lfloor x \\rfloor$ 为不大于 $x$ 的最大整数。举例来说，若 $C=3200$，那么你的解答将获得 $13$ 分。\n\n### 评分方式\n\n- 和传统题一样，你的程序的运行时间和空间不能超过时间和空间限制。**交互库运行的时间和空间也会算入你的程序的总时间和空间当中**。当你估算这一部分的时空消耗时，你可以认为，在评测时使用的交互库与我们提供的样例交互库有**相同的函数**和**相似的实现**。\n- 在一个测试点中，若你在调用 `playRound` 时传入了非法的数组 B，或调用 `playRound` 的总次数超过了上限，那么该测试点记 $0$ 分。\n- 在一个测试点的任意一次游戏中，若一个函数没有正确地回答所要求的 Koala 的序列的特征，那么该测试点记 $0$ 分。\n- 子任务 4 和子任务 5 均要求你实现函数 `allValues`，但在调用时传入了不同的 $W$。你可以利用两个子任务在这个参数上的不同，从而在你的实现中区分两个子任务。你可以参考你的语言的模板实现获取更详细的信息。\n- 比赛时，你可以提交本题目最多 60 次，连续两次的提交至少间隔 2 分钟。\n- **你在一个子任务上的得分，等于你在该子任务所有测试点中的最低得分**。\n\n### 如何测试你的程序\n\n在终端下输入如下命令进行编译：\n\n```bash\ng++ grader.cpp koala.cpp -o grader -g -Wall --std=c++11\n```\n\n样例交互库将按如下格式从标准输入读入数据：\n\n第一行两个整数 $F,G$，其中 $F$ 代表交互库调用的函数类型，$G$ 代表调用函数的次数；\n\n接下来 $G$ 行，每行开头两个整数 $N,W$，后跟 $N$ 个整数 $P_0,P_1,\\ldots,P_{N-1}$。\n\n$F$ 对应的样例交互库调用的函数类型如下表所示：\n\n| $F$ | 调用的函数类型 |\n| ----------- | ----------- |\n| $1$ | `minValue` |\n| $2$ | `maxValue` |\n| $3$ | `greaterValue` |\n| $4$ | `allValues` |\n\n对于每次函数调用，样例交互库将向标准输出输出两行。第一行代表你调用 `playRound` 的次数，第二行代表函数调用后返回的结构（对于 $F=4$ 的情况，将输出调用 `allValues` 时返回的数组，对于其他情况，将输出函数的返回值）。\n\n### 样例\n\n考虑如下的排列：\n\n| $i$ | 0 | 1 | 2 | 3 | 4 | 5 |\n| ----------- | ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |\n| $P_i$ | 5 | 3 | 2 | 1 | 6 | 4 |\n\n下表展示了几次调用函数 `playRound` 的例子，以及交互库对每个调用的有效反馈（注意，一次 `playRound` 的调用，可能会有多种可能的有效反馈） 。\n\n| $W$ | 调用 | 可能的交互库反馈 | 解释 |\n| ----------- | ----------- | ----------- | ----------- |\n| 6 | `playRound([0,3,0,2,1,0],R)` | `R=[1,1,1,0,2,1]` | Koala 获得了物品 $0,2,4,5$，总权值为 $17$，这是一种可能的权值最大的方案。 |\n| 6 | `playRound([1,2,3,1,2,0],R)` | 非法调用 | 你总共放了 $9$ 个石子，超过了 $W$ 的限制。 |\n| 12 | `playRound([0,3,0,2,1,0],R)` | `R=[2,3,0,2,3,1]` | 你不用放完 $W$ 个石子，Koala 也不用放完 $W$ 个石子。 |\n| 6 | `playRound([0,1,0,0,1,0],R)` | `R=[1,0,1,1,2,1]` | 若 Koala 有多种方案最大化获得物品的权值，她会选择使自己获得物品最多的方案。因此 `R=[1,2,0,0,2,1]` 不是一个合法的返回值。 |\n\n下面是样例数据的返回值，请注意在样例数据中，你可以调用 `playRound` 至多 $3200$ 次。\n\n| # | 交互库调用 | 期望返回值 | 解释 |\n| ----------- | ----------- | ----------- | ----------- |\n| 1 | `minValue(6,6)` | 3 | $P_3=1$ |\n| 2 | `maxValue(6,6)` | 4 | $P_4=6$ |\n| 3 | `greaterValue(6,6)` | 0 | $P_0=5,P_1=3$ |\n| 4 | `allValues(6,12,P)` | `P=[5,3,2,1,6,4]` | 注意 `allValues` 无返回值，而是将正确结果放入 P 中。 |\n| 5 | `allValues(6,12,P)` | `P=[5,3,2,1,6,4]` | 同上。 |\n\n\n### 附加文件\n\n附加文件包含样例输入输出，C++ 样例交互库和程序模板，我们推荐您在模板的基础上实现您的程序。", "locale": "zh-CN"}}}
{"pid": "P3778", "type": "P", "difficulty": 6, "samples": [["4 5 2\n10 9 5 2\n6 4 20 15\n9 7 10 9\n-1 -1 16 11\n1 2 3\n2 3 3\n1 4 1\n4 3 1\n3 1 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "APIO"], "title": "[APIO2017] 商旅", "background": "", "description": "在广阔的澳大利亚内陆地区长途跋涉后，你孤身一人带着一个背包来到了科巴。你被这个城市发达而美丽的市场所深深吸引，决定定居于此，做一个商人。科巴有 $N$ 个集市，集市用从 $1$ 到 $N$ 的整数编号，集市之间通过 $M$ 条 **单向** 道路连接，通过每条道路都需要消耗一定的时间。\n\n在科巴的集市上，有 $K$ 种不同的商品，商品用从 $1$ 到 $K$ 的整数编号。每个集市对每种商品都有自己的定价，买入和卖出商品的价格可以是不同的。并非每个集市都可以买卖所有的商品：一个集市可能只提供部分商品的双向交易服务；对于一种商品，一个集市也可能只收购而不卖出该商品或只卖出而不收购该商品。如果一个集市收购一种商品，它收购这种商品的数量是不限的，同样，一个集市如果卖出一种商品，则它卖出这种商品的数量也是不限的。\n\n为了更快地获得收益，你决定寻找一条盈利效率最高的环路。环路是指带着空的背包从一个集市出发，沿着道路前进，经过若干个市场并最终回到出发点。在环路中，允许 **多次** 经过同一个集市或同一条道路。在经过集市时，你可以购买或者卖出商品，一旦你购买了一个商品，你需要把它装在背包里带走。由于你的背包非常小，任何时候你最多只能持有一个商品。在购买一个商品时，你不需要考虑你是否有足够的金钱，但在卖出时，需要注意只能卖出你拥有的商品。\n\n从环路中得到的收益为在环路中卖出商品得到的金钱减去购买商品花费的金钱，而一条环路上消耗的时间则是依次通过环路上所有道路所需要花费的时间的总和。环路的 *盈利效率* 是指从环路中得到的收益除以花费的时间。需要注意的是，一条没有任何交易的环路的盈利效率为 $0$ 。\n\n你需要求出所有 **消耗时间为正数** 的环路中，盈利效率 **最高** 的环路的盈利效率。答案 **向下取整** 保留到整数。如果没有任何一条环路可以盈利，则输出 $0$ 。", "inputFormat": "第一行包含 $3$ 个正整数，$N$ , $M$ 和 $K$，分别表示集市数量、道路数量和商品种类数量。\n\n接下来的 $N$ 行，第 $i$ 行中包含 $2K$ 个整数 $B_{i,1},S_{i,1},B_{i,2},S_{i,2},\\cdots ,B_{i,K},S_{i,K}$ 描述一个集市。对于任意的 $1\\leq j\\leq K$ ，整数 $B_{i,j},S_{i,j}$ 分别表示在编号为 $i$ 的集市上购买、卖出编号为 $j$ 的商品时的交易价格。如果一个交易价格为 $-1$，则表示这个商品在这个集市上不能进行这种交易。\n\n接下来 $M$ 行，第 $p$ 行包含 $3$ 个整数 $V_p,W_p,T_p$，表示存在一条从编号为 $V_p$ 的市场出发前往编号为 $W_p$ 的市场的路径花费 $T_p$ 分钟。\n", "outputFormat": "输出包含一个整数，表示盈利效率最高的环路盈利效率，答案 **向下取整** 保留到整数。如果没有任何一条环路可以盈利，则输出 $0$ 。\n", "hint": "### 样例解释\n\n在样例中，我们考虑下面两条环路，`1−2−3−1` 和 `1−4−3−1`。\n\n考虑环路 `1−2−3−1`：这条环路消耗的总时间是 $(3+3+1)=7$ 分钟。在这条环路中，最佳的交易方式是：在编号为 $1$ 的集市中购买编号为 $2$ 的商品（花费的金钱为 $5$）；在编号为 $2$ 的集市中卖出编号为 $2$ 的商品（得到的金钱为 $15$），然后立即购买编号为 $1$ 的商品（花费的金钱为 $6$）；带着编号为 1 的商品经过编号为 3 的集市，在回到编号为 $1$ 的城市后卖出（得到的金钱为 $9$）。在这个环路中，总盈利为 $−5+15−6+9=13$。这个环路的盈利效率为 $\\frac{13}{7}$，向下取整后为 $1$ 。\n\n考虑环路 `1−4−3−1`：这条环路消耗的总时间是 $(1+1+1)=3$ 分钟。在这条环路中，最佳的交易方式是：在编号为 $1$ 的集市中购买编号为 $2$ 的商品（花费的金钱为 $5$）；在编号为 $4$ 的集市中卖出编号为 $2$ 的商品（得到的金钱为 $11$）；然后经过编号为 $3$ 的集市回到编号为 $1$ 的城市。在这个环路中，总盈利为 $−5+11=6$ 。 这个环路的盈利效率为 $\\frac 6 3$，向下取整后为 $2$ 。\n\n综上所述，盈利效率最高的环路的盈利效率为 $2$。\n\n### 子任务\n\n在所有数据中，满足：$ 1\\le N \\le 100,1\\le M \\le 9900,1\\le K \\le 1000$，如果在编号为 $i (1\\le i\\le N)$ 的集市中，编号为 $j(1\\le j\\le K)$ 的商品既可以购买又可以卖出，则 $0\\le S_{ij}\\le B_{ij}\\le 10^9$​。\n\n对于编号为 $p (1\\le p\\le M)$ 的道路，保证 $V_p\\neq W_p$，且 $1\\le T_p\\le 10^7$。\n\n不存在满足 $1\\le p\\le q\\le M$ 的 $p,q$ 使得 $(V_p,W_p)=(V_q,W_q)$。\n\n详细子任务如下表：\n\n| 子任务编号 | 分值 |                      附加条件                       |                             解释                             |\n| :--------: | :--: | :-------------------------------------------------: | :----------------------------------------------------------: |\n|    $1$     | $12$ |       $B_{i,j}=-1\\ (2\\le i\\le N,1\\le j\\le K)$       |                   你只能在市场 $1$ 买东西                    |\n|    $2$     | $21$ |          $N,K\\le 50,T_p=1\\ (1\\le p\\le M)$           |                 所有道路通过只需要 $1$ 分钟                  |\n|    $3$     | $33$ | $B_{i,j}=S_{i,j}\\neq -1\\ (1\\le i\\le N,1\\le j\\le K)$ | 对于每个市场，在其中买卖物品的价格都是一样的（在不同市场价格可能不同） |\n|    $4$     | $34$ |                         无                          |                              无                             |\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[APIO2017] Merchant", "background": "", "description": "After a long trek across the vast Australian outback, you arrive alone in Cobar with a backpack. Captivated by the city’s prosperous and beautiful markets, you decide to settle down and become a merchant. Cobar has $N$ markets, numbered from $1$ to $N$, connected by $M$ directed roads. Traversing each road takes some amount of time.\n\nThere are $K$ different types of goods in Cobar, numbered from $1$ to $K$. Each market has its own prices for each good, and the buy and sell prices may differ. Not every market buys and sells every good: a market may support both buying and selling only for a subset of goods; for a particular good, a market may only buy but not sell, or only sell but not buy. If a market buys a certain good, the quantity it buys is unlimited; similarly, if a market sells a certain good, the quantity it sells is unlimited.\n\nTo gain profit more quickly, you decide to find the cycle with the highest profit efficiency. A cycle means starting from some market with an empty backpack, traveling along roads through several markets, and finally returning to the starting point. It is allowed to pass through the same market or the same road multiple times within the cycle. When passing a market, you may buy or sell goods. Once you buy a good, you must carry it in your backpack. Because your backpack is very small, you can hold at most one good at any time. When buying a good, you do not need to consider whether you have enough money; when selling, note that you can only sell the good you currently hold.\n\nThe profit gained from a cycle is the total money obtained from selling minus the total money spent on buying during the cycle. The time spent on a cycle is the sum of the traversal times of all roads along the cycle. The profit efficiency of a cycle is the profit divided by the time spent. Note that the profit efficiency of a cycle with no transactions is $0$.\n\nYou need to find, among all cycles with strictly positive total time, the maximum profit efficiency. Output the value floored to an integer. If no cycle can yield a positive profit, output $0$.", "inputFormat": "The first line contains $3$ positive integers $N$, $M$, and $K$, denoting the number of markets, the number of roads, and the number of goods, respectively.\n\nThe next $N$ lines describe the markets. In line $i$, there are $2K$ integers $B_{i,1}, S_{i,1}, B_{i,2}, S_{i,2}, \\cdots, B_{i,K}, S_{i,K}$. For any $1 \\le j \\le K$, the integers $B_{i,j}$ and $S_{i,j}$ denote the buying and selling price at market $i$ for good $j$, respectively. If a transaction price is $-1$, then that transaction is not available for that good at that market.\n\nThen follow $M$ lines. In line $p$, there are $3$ integers $V_p, W_p, T_p$, indicating there is a directed road from market $V_p$ to market $W_p$ with travel time $T_p$ minutes.", "outputFormat": "Output a single integer: the maximum profit efficiency over all cycles, floored to an integer. If no cycle can be profitable, output $0$.", "hint": "Sample explanation.\n\nIn the sample, consider the two cycles `1−2−3−1` and `1−4−3−1`.\n\nConsider the cycle `1−2−3−1`: the total time is $(3+3+1)=7$ minutes. The best sequence of transactions is: at market $1$, buy good $2$ (spending $5$); at market $2$, sell good $2$ (gaining $15$), then immediately buy good $1$ (spending $6$); pass through market $3$ carrying good $1$, and upon returning to market $1$, sell it (gaining $9$). The total profit is $-5+15-6+9=13$. The profit efficiency is $\\frac{13}{7}$, whose floor is $1$.\n\nConsider the cycle `1−4−3−1`: the total time is $(1+1+1)=3$ minutes. The best sequence of transactions is: at market $1$, buy good $2$ (spending $5$); at market $4$, sell good $2$ (gaining $11$); then pass through market $3$ and return to market $1$. The total profit is $-5+11=6$. The profit efficiency is $\\frac 6 3$, whose floor is $2$.\n\nTherefore, the maximum profit efficiency over all cycles is $2$.\n\nSubtasks.\n\nAcross all testdata, the following hold: $1 \\le N \\le 100$, $1 \\le M \\le 9900$, $1 \\le K \\le 1000$. If in market $i$ for good $j$ both buying and selling are available, then $0 \\le S_{i,j} \\le B_{i,j} \\le 10^9$. For road $p$ ($1 \\le p \\le M$), it is guaranteed that $V_p \\ne W_p$ and $1 \\le T_p \\le 10^7$. There do not exist indices $p, q$ with $1 \\le p \\le q \\le M$ such that $(V_p, W_p) = (V_q, W_q)$.\n\n| Subtask | Score | Additional conditions | Explanation |\n| :-----: | :---: | :-------------------: | :---------: |\n| $1$ | $12$ | $B_{i,j}=-1\\ (2\\le i\\le N, 1\\le j\\le K)$ | You can only buy goods at market $1$. |\n| $2$ | $21$ | $N, K \\le 50, \\ T_p=1\\ (1\\le p\\le M)$ | All roads take $1$ minute to traverse. |\n| $3$ | $33$ | $B_{i,j}=S_{i,j}\\neq -1\\ (1\\le i\\le N, 1\\le j\\le K)$ | At each market, the buy and sell prices are the same (prices may differ across markets). |\n| $4$ | $34$ | None | None. |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[APIO2017] 商旅", "background": "", "description": "在广阔的澳大利亚内陆地区长途跋涉后，你孤身一人带着一个背包来到了科巴。你被这个城市发达而美丽的市场所深深吸引，决定定居于此，做一个商人。科巴有 $N$ 个集市，集市用从 $1$ 到 $N$ 的整数编号，集市之间通过 $M$ 条 **单向** 道路连接，通过每条道路都需要消耗一定的时间。\n\n在科巴的集市上，有 $K$ 种不同的商品，商品用从 $1$ 到 $K$ 的整数编号。每个集市对每种商品都有自己的定价，买入和卖出商品的价格可以是不同的。并非每个集市都可以买卖所有的商品：一个集市可能只提供部分商品的双向交易服务；对于一种商品，一个集市也可能只收购而不卖出该商品或只卖出而不收购该商品。如果一个集市收购一种商品，它收购这种商品的数量是不限的，同样，一个集市如果卖出一种商品，则它卖出这种商品的数量也是不限的。\n\n为了更快地获得收益，你决定寻找一条盈利效率最高的环路。环路是指带着空的背包从一个集市出发，沿着道路前进，经过若干个市场并最终回到出发点。在环路中，允许 **多次** 经过同一个集市或同一条道路。在经过集市时，你可以购买或者卖出商品，一旦你购买了一个商品，你需要把它装在背包里带走。由于你的背包非常小，任何时候你最多只能持有一个商品。在购买一个商品时，你不需要考虑你是否有足够的金钱，但在卖出时，需要注意只能卖出你拥有的商品。\n\n从环路中得到的收益为在环路中卖出商品得到的金钱减去购买商品花费的金钱，而一条环路上消耗的时间则是依次通过环路上所有道路所需要花费的时间的总和。环路的 *盈利效率* 是指从环路中得到的收益除以花费的时间。需要注意的是，一条没有任何交易的环路的盈利效率为 $0$ 。\n\n你需要求出所有 **消耗时间为正数** 的环路中，盈利效率 **最高** 的环路的盈利效率。答案 **向下取整** 保留到整数。如果没有任何一条环路可以盈利，则输出 $0$ 。", "inputFormat": "第一行包含 $3$ 个正整数，$N$ , $M$ 和 $K$，分别表示集市数量、道路数量和商品种类数量。\n\n接下来的 $N$ 行，第 $i$ 行中包含 $2K$ 个整数 $B_{i,1},S_{i,1},B_{i,2},S_{i,2},\\cdots ,B_{i,K},S_{i,K}$ 描述一个集市。对于任意的 $1\\leq j\\leq K$ ，整数 $B_{i,j},S_{i,j}$ 分别表示在编号为 $i$ 的集市上购买、卖出编号为 $j$ 的商品时的交易价格。如果一个交易价格为 $-1$，则表示这个商品在这个集市上不能进行这种交易。\n\n接下来 $M$ 行，第 $p$ 行包含 $3$ 个整数 $V_p,W_p,T_p$，表示存在一条从编号为 $V_p$ 的市场出发前往编号为 $W_p$ 的市场的路径花费 $T_p$ 分钟。\n", "outputFormat": "输出包含一个整数，表示盈利效率最高的环路盈利效率，答案 **向下取整** 保留到整数。如果没有任何一条环路可以盈利，则输出 $0$ 。\n", "hint": "### 样例解释\n\n在样例中，我们考虑下面两条环路，`1−2−3−1` 和 `1−4−3−1`。\n\n考虑环路 `1−2−3−1`：这条环路消耗的总时间是 $(3+3+1)=7$ 分钟。在这条环路中，最佳的交易方式是：在编号为 $1$ 的集市中购买编号为 $2$ 的商品（花费的金钱为 $5$）；在编号为 $2$ 的集市中卖出编号为 $2$ 的商品（得到的金钱为 $15$），然后立即购买编号为 $1$ 的商品（花费的金钱为 $6$）；带着编号为 1 的商品经过编号为 3 的集市，在回到编号为 $1$ 的城市后卖出（得到的金钱为 $9$）。在这个环路中，总盈利为 $−5+15−6+9=13$。这个环路的盈利效率为 $\\frac{13}{7}$，向下取整后为 $1$ 。\n\n考虑环路 `1−4−3−1`：这条环路消耗的总时间是 $(1+1+1)=3$ 分钟。在这条环路中，最佳的交易方式是：在编号为 $1$ 的集市中购买编号为 $2$ 的商品（花费的金钱为 $5$）；在编号为 $4$ 的集市中卖出编号为 $2$ 的商品（得到的金钱为 $11$）；然后经过编号为 $3$ 的集市回到编号为 $1$ 的城市。在这个环路中，总盈利为 $−5+11=6$ 。 这个环路的盈利效率为 $\\frac 6 3$，向下取整后为 $2$ 。\n\n综上所述，盈利效率最高的环路的盈利效率为 $2$。\n\n### 子任务\n\n在所有数据中，满足：$ 1\\le N \\le 100,1\\le M \\le 9900,1\\le K \\le 1000$，如果在编号为 $i (1\\le i\\le N)$ 的集市中，编号为 $j(1\\le j\\le K)$ 的商品既可以购买又可以卖出，则 $0\\le S_{ij}\\le B_{ij}\\le 10^9$​。\n\n对于编号为 $p (1\\le p\\le M)$ 的道路，保证 $V_p\\neq W_p$，且 $1\\le T_p\\le 10^7$。\n\n不存在满足 $1\\le p\\le q\\le M$ 的 $p,q$ 使得 $(V_p,W_p)=(V_q,W_q)$。\n\n详细子任务如下表：\n\n| 子任务编号 | 分值 |                      附加条件                       |                             解释                             |\n| :--------: | :--: | :-------------------------------------------------: | :----------------------------------------------------------: |\n|    $1$     | $12$ |       $B_{i,j}=-1\\ (2\\le i\\le N,1\\le j\\le K)$       |                   你只能在市场 $1$ 买东西                    |\n|    $2$     | $21$ |          $N,K\\le 50,T_p=1\\ (1\\le p\\le M)$           |                 所有道路通过只需要 $1$ 分钟                  |\n|    $3$     | $33$ | $B_{i,j}=S_{i,j}\\neq -1\\ (1\\le i\\le N,1\\le j\\le K)$ | 对于每个市场，在其中买卖物品的价格都是一样的（在不同市场价格可能不同） |\n|    $4$     | $34$ |                         无                          |                              无                             |\n\n", "locale": "zh-CN"}}}
{"pid": "P3779", "type": "P", "difficulty": 7, "samples": [["1\n2 19\n0 0\n0 1\n0 2\n0 3\n0 4\n0 5\n0 6\n0 7\n0 8\n0 9", "0.000002\n0.000038\n0.000364\n0.002213\n0.009605\n0.031784\n0.083534\n0.179642\n0.323803\n0.500000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 2000, 2000, 3000, 3500, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "山东", "Special Judge", "O2优化", "期望", "积分"], "title": "[SDOI2017] 龙与地下城", "background": "", "description": "小 Q 同学是一个热爱学习的人，但是他最近沉迷于各种游戏，龙与地下城就是其中之一。\n\n在这个游戏中，很多场合需要通过掷骰子来产生随机数，并由此决定角色未来的命运，因此骰子堪称该游戏的标志性道具。\n\n骰子也分为许多种类，比如 $4$ 面骰、$6$ 面骰、$8$ 面骰、$12$ 面骰、$20$ 面骰，其中 $20$ 面骰用到的机会非常多。当然，现在科技发达，可以用一个随机数生成器来取代真实的骰子，所以这里**认为骰子就是一个随机数生成器**。\n\n在战斗中，骰子主要用来决定角色的攻击是否命中，以及命中后造成的伤害值。举个例子，假设现在已经确定能够命中敌人，那么 $YdX$（也就是掷出 $Y$ 个 $X$ 面骰子之后所有骰子显示的数字之和）就是对敌人的基础伤害。在敌人没有防御的情况下，这个基础伤害就是真实伤害。\n\n众所周知，骰子显示每个数的概率应该是相等的，也就是说，对于一个 $X$ 面骰子，显示 $0, 1, 2,\\dots ,X−1$ 中每一个数字的概率都是 $\\dfrac {1}{X}$。\n\n更形式化地说，这个骰子显示的数 $W$ 满足离散的均匀分布，其分布列为\n\n| $H$ | $0$ | $1$ | $2$ | $\\cdots$ | $X-1$ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| $P$ | $\\dfrac {1}{X}$ | $\\dfrac {1}{X}$ | $\\dfrac {1}{X}$ | $\\cdots$ | $\\dfrac {1}{X}$ |\n\n\n除此之外还有一些性质：\n\n- $W$ 的**一阶原点矩**（**期望**）为\n\n$$v_1(W)=E(W)=\\sum_{i=0}^{X-1}i\\cdot P(W=i)=\\frac {X-1}{2}$$\n\n- $W$ 的**二阶中心矩**（**方差**）为\n\n$$\\mu_2(W)=E((W-E(W))^2)=\\sum_{i=0}^{X-1}(i-E(W))^2\\cdot P(W=i)=\\frac {X^2-1}{12}$$\n\n言归正传，现在小 Q 同学面对着一个生命值为 A 的没有防御的敌人，能够发动一次必中的 $YdX$ 攻击，显然只有造成的伤害不少于敌人的生命值才能打倒敌人。但是另一方面，小 Q 同学作为强迫症患者，不希望出现 overkill，也就是造成的伤害大于 $B$ 的情况，因此**只有在打倒敌人并且不发生 overkill 的情况下小 Q 同学才会认为取得了属于他的胜利**。\n\n因为小 Q 同学非常谨慎，他会进行 $10$ 次模拟战，每次给出敌人的生命值 $A$以及 overkill 的标准 $B$，他想知道此时取得属于他的胜利的概率是多少，你能帮帮他吗？\n", "inputFormat": "第一行是一个正整数 $T$，表示测试数据的组数，\n\n对于每组测试数据：\n\n第一行是两个整数 $X,Y$，分别表示骰子的面数以及骰子的个数；\n\n接下来 $10$ 行，每行包含两个整数 $A,B$，分别表示敌人的生命值 $A$ 以及 overkill 的标准 $B$。", "outputFormat": "对于每组测试数据，输出 $10$ 行，对每个询问输出一个实数，要求绝对误差不超过 $0.013\\, 579$。\n\n也就是说，记输出为 $a$，答案为 $b$，若满足 $|a-b|\\leq 0.013\\,579$，则认为输出是正确的。", "hint": "对于 $100\\%$ 的数据，$T \\leq 10$，$2 \\leq X \\leq 20$，$1 \\leq Y \\leq 200000$，$0 \\leq A \\leq B \\leq (X-1)Y$。\n\n**保证满足 $Y > 800$ 的数据不超过 $2$ 组。**\n\n| 测试点编号 | $X$ | $Y$ | 备注 |\n| :--: | :--: | :--: | :--: |\n| $1$ | $\\le 20$ | $\\le 40$ | $X^Y\\le 10^7$ |\n| $2\\sim 4$ | $\\le 20$ | $\\le 1\\, 600$ | - |\n| $5\\sim 10$ | $\\le 20$ | $\\le 8\\, 000$ | - |\n| $11,12$ | $=2$ | $\\le 200\\, 000$ | - |\n| $13\\sim 20$ | $\\le 20$ | $\\le 200\\, 000$ | - |\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2017] Dungeons and Dragons", "background": "", "description": "Xiao Q is a student who loves studying, but he has recently been obsessed with various games, and Dungeons and Dragons is one of them.\n\nIn this game, many situations require rolling dice to generate random numbers, which then determine the character’s fate. Therefore, dice are iconic props in this game.\n\nThere are many kinds of dice, such as the $4$-sided die, $6$-sided die, $8$-sided die, $12$-sided die, and $20$-sided die, among which the $20$-sided die is used very often. Of course, with modern technology, a random number generator can replace a real die, so here we assume that a die is a random number generator.\n\nIn battles, dice are mainly used to determine whether an attack hits and, if it hits, the damage dealt. For example, suppose we already know the attack will hit; then $YdX$ (i.e., roll $Y$ $X$-sided dice and sum all numbers shown) is the base damage dealt to the enemy. If the enemy has no defense, this base damage is the actual damage.\n\nIt is well known that each face of a die has the same probability. That is, for an $X$-sided die, each number among $0, 1, 2, \\dots, X-1$ appears with probability $\\dfrac{1}{X}$.\n\nMore formally, the number shown by this die, $W$, follows a discrete uniform distribution, with the following distribution table:\n\n| $W$ | $0$ | $1$ | $2$ | $\\cdots$ | $X-1$ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| $P$ | $\\dfrac {1}{X}$ | $\\dfrac {1}{X}$ | $\\dfrac {1}{X}$ | $\\cdots$ | $\\dfrac {1}{X}$ |\n\nIn addition, it has the following properties:\n\n- The first raw moment (expectation) of $W$ is\n$$v_1(W)=E(W)=\\sum_{i=0}^{X-1}i\\cdot P(W=i)=\\frac {X-1}{2}.$$\n\n- The second central moment (variance) of $W$ is\n$$\\mu_2(W)=E((W-E(W))^2)=\\sum_{i=0}^{X-1}(i-E(W))^2\\cdot P(W=i)=\\frac {X^2-1}{12}.$$\n\nBack to the point: Now Xiao Q faces an enemy with health $A$, has no defense, and he can make one guaranteed-hit $YdX$ attack. Obviously, only damage not less than the enemy’s health can defeat the enemy. On the other hand, as a perfectionist, Xiao Q does not want “overkill,” i.e., dealing damage greater than $B$. Therefore, Xiao Q considers it his victory only if he both defeats the enemy and does not have “overkill.”\n\nBecause Xiao Q is very cautious, he will run $10$ mock battles. Each time, he gives the enemy’s health $A$ and the overkill threshold $B$. He wants to know the probability of achieving his own victory under these conditions. Can you help him?", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nFor each test case:\n\n- The first line contains two integers $X, Y$, the number of faces of the die and the number of dice, respectively.\n- Then follow $10$ lines, each containing two integers $A, B$, representing the enemy’s health $A$ and the overkill threshold $B$.", "outputFormat": "For each test case, output $10$ lines. For each query, output a real number. The absolute error must not exceed $0.013\\, 579$.\n\nThat is, let the output be $a$ and the correct answer be $b$. If $|a-b|\\leq 0.013\\,579$, the output is considered correct.", "hint": "For $100\\%$ of the testdata, $T \\leq 10$, $2 \\leq X \\leq 20$, $1 \\leq Y \\leq 200000$, $0 \\leq A \\leq B \\leq (X-1)Y$.\n\n**It is guaranteed that there are at most $2$ test cases with $Y > 800$.**\n\n| Test point ID | $X$ | $Y$ | Note |\n| :--: | :--: | :--: | :--: |\n| $1$ | $\\le 20$ | $\\le 40$ | $X^Y\\le 10^7$ |\n| $2\\sim 4$ | $\\le 20$ | $\\le 1\\, 600$ | - |\n| $5\\sim 10$ | $\\le 20$ | $\\le 8\\, 000$ | - |\n| $11,12$ | $=2$ | $\\le 200\\, 000$ | - |\n| $13\\sim 20$ | $\\le 20$ | $\\le 200\\, 000$ | - |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2017] 龙与地下城", "background": "", "description": "小 Q 同学是一个热爱学习的人，但是他最近沉迷于各种游戏，龙与地下城就是其中之一。\n\n在这个游戏中，很多场合需要通过掷骰子来产生随机数，并由此决定角色未来的命运，因此骰子堪称该游戏的标志性道具。\n\n骰子也分为许多种类，比如 $4$ 面骰、$6$ 面骰、$8$ 面骰、$12$ 面骰、$20$ 面骰，其中 $20$ 面骰用到的机会非常多。当然，现在科技发达，可以用一个随机数生成器来取代真实的骰子，所以这里**认为骰子就是一个随机数生成器**。\n\n在战斗中，骰子主要用来决定角色的攻击是否命中，以及命中后造成的伤害值。举个例子，假设现在已经确定能够命中敌人，那么 $YdX$（也就是掷出 $Y$ 个 $X$ 面骰子之后所有骰子显示的数字之和）就是对敌人的基础伤害。在敌人没有防御的情况下，这个基础伤害就是真实伤害。\n\n众所周知，骰子显示每个数的概率应该是相等的，也就是说，对于一个 $X$ 面骰子，显示 $0, 1, 2,\\dots ,X−1$ 中每一个数字的概率都是 $\\dfrac {1}{X}$。\n\n更形式化地说，这个骰子显示的数 $W$ 满足离散的均匀分布，其分布列为\n\n| $H$ | $0$ | $1$ | $2$ | $\\cdots$ | $X-1$ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| $P$ | $\\dfrac {1}{X}$ | $\\dfrac {1}{X}$ | $\\dfrac {1}{X}$ | $\\cdots$ | $\\dfrac {1}{X}$ |\n\n\n除此之外还有一些性质：\n\n- $W$ 的**一阶原点矩**（**期望**）为\n\n$$v_1(W)=E(W)=\\sum_{i=0}^{X-1}i\\cdot P(W=i)=\\frac {X-1}{2}$$\n\n- $W$ 的**二阶中心矩**（**方差**）为\n\n$$\\mu_2(W)=E((W-E(W))^2)=\\sum_{i=0}^{X-1}(i-E(W))^2\\cdot P(W=i)=\\frac {X^2-1}{12}$$\n\n言归正传，现在小 Q 同学面对着一个生命值为 A 的没有防御的敌人，能够发动一次必中的 $YdX$ 攻击，显然只有造成的伤害不少于敌人的生命值才能打倒敌人。但是另一方面，小 Q 同学作为强迫症患者，不希望出现 overkill，也就是造成的伤害大于 $B$ 的情况，因此**只有在打倒敌人并且不发生 overkill 的情况下小 Q 同学才会认为取得了属于他的胜利**。\n\n因为小 Q 同学非常谨慎，他会进行 $10$ 次模拟战，每次给出敌人的生命值 $A$以及 overkill 的标准 $B$，他想知道此时取得属于他的胜利的概率是多少，你能帮帮他吗？\n", "inputFormat": "第一行是一个正整数 $T$，表示测试数据的组数，\n\n对于每组测试数据：\n\n第一行是两个整数 $X,Y$，分别表示骰子的面数以及骰子的个数；\n\n接下来 $10$ 行，每行包含两个整数 $A,B$，分别表示敌人的生命值 $A$ 以及 overkill 的标准 $B$。", "outputFormat": "对于每组测试数据，输出 $10$ 行，对每个询问输出一个实数，要求绝对误差不超过 $0.013\\, 579$。\n\n也就是说，记输出为 $a$，答案为 $b$，若满足 $|a-b|\\leq 0.013\\,579$，则认为输出是正确的。", "hint": "对于 $100\\%$ 的数据，$T \\leq 10$，$2 \\leq X \\leq 20$，$1 \\leq Y \\leq 200000$，$0 \\leq A \\leq B \\leq (X-1)Y$。\n\n**保证满足 $Y > 800$ 的数据不超过 $2$ 组。**\n\n| 测试点编号 | $X$ | $Y$ | 备注 |\n| :--: | :--: | :--: | :--: |\n| $1$ | $\\le 20$ | $\\le 40$ | $X^Y\\le 10^7$ |\n| $2\\sim 4$ | $\\le 20$ | $\\le 1\\, 600$ | - |\n| $5\\sim 10$ | $\\le 20$ | $\\le 8\\, 000$ | - |\n| $11,12$ | $=2$ | $\\le 200\\, 000$ | - |\n| $13\\sim 20$ | $\\le 20$ | $\\le 200\\, 000$ | - |\n", "locale": "zh-CN"}}}
{"pid": "P3780", "type": "P", "difficulty": 7, "samples": [["2\n5 1\n0 1 1\n1 1 1\n1 1 3\n2 1 10\n3 1 4\n9 15\n0 1 1\n1 7 2\n2 5 10\n1 3 1\n4 3 17\n4 3 18\n4 4 19\n1 1 1\n8 1 100", "15\n316"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "单调队列", "山东", "O2优化", "枚举", "背包 DP"], "title": "[SDOI2017] 苹果树", "background": "**提示：第三档部分分中正确的数据范围应为 $v_i=1$，为尊重原题未进行数据范围修改**。", "description": "夏天近了，又到了恋爱的季节，小 Q 家门前的苹果树上结满了红红圆圆的苹果。\n\n这株苹果树是一个有着 $n$ 个结点的有根树，其中结点被依次编号为 $1$ 至 $n$。$1$ 号结点为根，其余每一个结点的父结点一定是某个编号较小的结点。每一个结点上都有一些苹果，第 $i$ 个结点上有 $a_i (a_i > 0)$ 个苹果，每取走其中一个苹果就可以得到 $v_i (v_i > 0)$ 的幸福度（若在这个结点取走 $k \\leq a_i$ 个苹果，则可以收获 $kv_i$ 的幸福度）。如果在一个结点取走了至少一个苹果，则必须要在其父结点处取走至少一个苹果。\n\n现在，给定正整数 $k$，请从树上取走若干苹果。如果总计取走了 $t$ 个苹果，且所有取了至少一个苹果的那些结点的最大深度为 $h$（这里规定根结点的深度为 $1$），则要求 $t-h \\leq k$。问最大可以收获多少的幸福度？（这些幸福度全都归属于恋爱中的小 Q。）", "inputFormat": "本题有多组测试数据，输入的第一行给定整数 $Q$，表示有 $Q$ 组数据。之后依次给出 $Q$ 组数据。\n\n对于每一组数据来说，第一行包含两个整数 $n$ 和 $k$。\n\n之后 $n$ 行，每行给出三个整数，描述了每一个结点。其中第 $i$ 行的第一个整数给出了 $i$ 的父结点标号（如果 $i = 1$，则其父结点为 $0$），第二个整数为 $a_i$，第三个整数为 $v_i$。", "outputFormat": "输出一共有 $Q$ 行，对应了 $Q$ 组数据。\n\n对于每一组数据，输出一个整数，表示最大可以收获的幸福度。", "hint": "- 有 $10\\%$ 的数据，满足 $nk \\leq 3000000$ 且给定的树的高度为 $2$。\n- 有 $20\\%$ 的数据，满足 $nk \\leq 25000000$ 且给定的树的高度为 $2$。\n- 有 $20\\%$ 的数据，满足 $nk \\leq 25000000$ 且所有 $a_i$ 均为 $1$。\n- 还有 $20\\%$ 的数据，满足 $nk \\leq 3000000$，没有上述额外限制。\n- 对于 $100\\%$ 的数据，满足 $1 \\leq Q \\leq 5$；$1 \\leq n \\leq 20000$；$1 \\leq k \\leq 500000$；$1 \\leq nk \\leq 25000000$；$1 \\leq a_i \\leq 10^8$；$1 \\leq v_i \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2017] Apple Tree", "background": "**Tip: In the third partial score, the correct constraint should be $v_i=1$. To respect the original problem, the constraints are not modified.**", "description": "Summer is coming, and it is the season of love. The apple tree in front of Little Q’s house is full of bright red round apples.\n\nThis apple tree is a rooted tree with $n$ nodes, numbered $1$ to $n$. Node $1$ is the root. For every other node, its parent is guaranteed to be a node with a smaller index. Each node has some apples. The $i$-th node has $a_i (a_i > 0)$ apples, and taking one apple from this node gives $v_i (v_i > 0)$ happiness (if you take $k \\leq a_i$ apples from this node, you gain $kv_i$ happiness). If you take at least one apple from a node, then you must also take at least one apple from its parent.\n\nYou are given a positive integer $k$. Pick some apples from the tree. If in total you pick $t$ apples, and among all nodes from which at least one apple is picked, the maximum depth is $h$ (the root has depth $1$), then you must satisfy $t-h \\leq k$. Find the maximum total happiness you can obtain.", "inputFormat": "There are multiple testcases. The first line contains an integer $Q$, the number of testcases.\n\nFor each testcase, the first line contains two integers $n$ and $k$.\n\nThen $n$ lines follow, each describing one node. On the $i$-th line, the first integer is the index of the parent of node $i$ (if $i = 1$, its parent is $0$), the second integer is $a_i$, and the third integer is $v_i$.", "outputFormat": "Output $Q$ lines, one per testcase.\n\nFor each testcase, output a single integer, the maximum total happiness that can be obtained.", "hint": "- For $10\\%$ of the testdata, $nk \\leq 3000000$ and the height of the tree is $2$.\n- For $20\\%$ of the testdata, $nk \\leq 25000000$ and the height of the tree is $2$.\n- For $20\\%$ of the testdata, $nk \\leq 25000000$ and all $a_i$ are $1$.\n- For another $20\\%$ of the testdata, $nk \\leq 3000000$ with no additional restrictions.\n- Constraints for $100\\%$ of the testdata: $1 \\leq Q \\leq 5$; $1 \\leq n \\leq 20000$; $1 \\leq k \\leq 500000$; $1 \\leq nk \\leq 25000000$; $1 \\leq a_i \\leq 10^8$; $1 \\leq v_i \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2017] 苹果树", "background": "**提示：第三档部分分中正确的数据范围应为 $v_i=1$，为尊重原题未进行数据范围修改**。", "description": "夏天近了，又到了恋爱的季节，小 Q 家门前的苹果树上结满了红红圆圆的苹果。\n\n这株苹果树是一个有着 $n$ 个结点的有根树，其中结点被依次编号为 $1$ 至 $n$。$1$ 号结点为根，其余每一个结点的父结点一定是某个编号较小的结点。每一个结点上都有一些苹果，第 $i$ 个结点上有 $a_i (a_i > 0)$ 个苹果，每取走其中一个苹果就可以得到 $v_i (v_i > 0)$ 的幸福度（若在这个结点取走 $k \\leq a_i$ 个苹果，则可以收获 $kv_i$ 的幸福度）。如果在一个结点取走了至少一个苹果，则必须要在其父结点处取走至少一个苹果。\n\n现在，给定正整数 $k$，请从树上取走若干苹果。如果总计取走了 $t$ 个苹果，且所有取了至少一个苹果的那些结点的最大深度为 $h$（这里规定根结点的深度为 $1$），则要求 $t-h \\leq k$。问最大可以收获多少的幸福度？（这些幸福度全都归属于恋爱中的小 Q。）", "inputFormat": "本题有多组测试数据，输入的第一行给定整数 $Q$，表示有 $Q$ 组数据。之后依次给出 $Q$ 组数据。\n\n对于每一组数据来说，第一行包含两个整数 $n$ 和 $k$。\n\n之后 $n$ 行，每行给出三个整数，描述了每一个结点。其中第 $i$ 行的第一个整数给出了 $i$ 的父结点标号（如果 $i = 1$，则其父结点为 $0$），第二个整数为 $a_i$，第三个整数为 $v_i$。", "outputFormat": "输出一共有 $Q$ 行，对应了 $Q$ 组数据。\n\n对于每一组数据，输出一个整数，表示最大可以收获的幸福度。", "hint": "- 有 $10\\%$ 的数据，满足 $nk \\leq 3000000$ 且给定的树的高度为 $2$。\n- 有 $20\\%$ 的数据，满足 $nk \\leq 25000000$ 且给定的树的高度为 $2$。\n- 有 $20\\%$ 的数据，满足 $nk \\leq 25000000$ 且所有 $a_i$ 均为 $1$。\n- 还有 $20\\%$ 的数据，满足 $nk \\leq 3000000$，没有上述额外限制。\n- 对于 $100\\%$ 的数据，满足 $1 \\leq Q \\leq 5$；$1 \\leq n \\leq 20000$；$1 \\leq k \\leq 500000$；$1 \\leq nk \\leq 25000000$；$1 \\leq a_i \\leq 10^8$；$1 \\leq v_i \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P3781", "type": "P", "difficulty": 7, "samples": [["4 4\n2 0 1 3\n1 2\n1 3\n1 4\n12\nQuery 0\nQuery 1\nQuery 2\nQuery 3\nChange 1 0\nChange 2 1\nChange 3 3\nChange 4 1\nQuery 0\nQuery 1\nQuery 2\nQuery 3", "3\n3\n2\n3\n2\n4\n2\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "线段树", "各省省选", "山东", "树链剖分", "矩阵乘法", "动态 DP", "全局平衡二叉树"], "title": "[SDOI2017] 切树游戏", "background": "hack数据 by boshi & Remmina", "description": "小Q是一个热爱学习的人，他经常去维基百科学习计算机科学。\n\n就在刚才，小Q认真地学习了一系列位运算符，其中按位异或的运算符$\\oplus$对他影响很大。按位异或的运算符是双目运算符。按位异或具有交换律，即$i \\oplus j = j \\oplus i$。\n\n他发现，按位异或可以理解成被运算的数字的二进制位对应位如果相同，则结果的该位置为$0$，否则为$1$，例如：$1(01) \\oplus 2(10) = 3(11)$。\n\n他还发现，按位异或可以理解成参与运算的数字的每个二进制位都进行了不进位的加法，例如：$3(11) \\oplus 3(11) = 0(00)$。\n\n现在小Q有一棵$n$个结点的无根树$T$，结点依次编号为$1$到$n$，其中结点$i$的权值为$v_i$。\n\n定义一棵树的价值为它所有点的权值的异或和，一棵树$T$的连通子树就是它的一个连通子图，并且这个图也是一棵树。\n\n小Q想要在这棵树上玩切树游戏，他会不断做以下两种操作：\n\n- `Change x y` 将编号为$x$的结点的权值修改为$y$。\n\n- `Query k` 询问有多少棵$T$的非空连通子树，满足其价值恰好为$k$。\n\n小Q非常喜(bu)欢(hui)数学，他希望你能快速回答他的问题，你能写个程序帮帮他吗？\n", "inputFormat": "第一行包含两个正整数$n$ , $m$，分别表示结点的个数以及权值的上限。\n\n第二行包含$n$个非负整数$v_1, v_2,\\dots , v_n$，分别表示每个结点一开始的权值。\n\n接下来$n-1$行，每行包含两个正整数$a_i , b_i$，表示有一条连接$a_i$和$b_i$的无向树边。\n\n接下来一行包含一个正整数$q$，表示小Q操作的次数。\n\n接下来$q$行每行依次表示每个操作。\n", "outputFormat": "输出若干行，每行一个整数，依次回答每个询问。因为答案可能很大，所以请对$10007$取模输出。\n", "hint": "对于$100\\%$的数据，$1 \\leq a_i,b_i,x \\leq n$ , $0 \\leq v_i,y,k < m$，修改操作不超过$10000$个。\n\n![](https://cdn.luogu.com.cn/upload/pic/5534.png)\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2017] Cut Tree Game", "background": "Hack testdata by boshi & Remmina.", "description": "Xiao Q is someone who loves to learn. He often goes to Wikipedia to study computer science.\n\nJust now, Xiao Q carefully studied a series of bitwise operators, among which the bitwise XOR operator $\\oplus$ impressed him a lot. The bitwise XOR operator is a binary operator. Bitwise XOR is commutative, i.e., $i \\oplus j = j \\oplus i$.\n\nHe found that bitwise XOR can be understood as: for the binary representations of the numbers being operated on, if the corresponding bits are the same, then the result’s bit is $0$, otherwise it is $1$, for example: $1(01) \\oplus 2(10) = 3(11)$.\n\nHe also found that bitwise XOR can be understood as performing addition without carry on each binary bit of the numbers involved, for example: $3(11) \\oplus 3(11) = 0(00)$.\n\nNow Xiao Q has an unrooted tree $T$ with $n$ nodes, numbered from $1$ to $n$, where the weight of node $i$ is $v_i$.\n\nDefine the value of a tree as the XOR of the weights of all its nodes. A connected subtree of a tree $T$ is a connected subgraph of $T$ that is also a tree.\n\nXiao Q wants to play a cut-tree game on this tree. He will repeatedly perform the following two operations:\n\n- Change x y: change the weight of node $x$ to $y$.\n- Query k: ask how many nonempty connected subtrees of $T$ have value exactly $k$.\n\nXiao Q really likes (but is not good at) math, and he hopes you can answer his questions quickly. Can you write a program to help him?", "inputFormat": "- The first line contains two positive integers $n$, $m$, representing the number of nodes and the upper bound of weights.\n- The second line contains $n$ nonnegative integers $v_1, v_2, \\dots, v_n$, representing the initial weight of each node.\n- The next $n - 1$ lines each contain two positive integers $a_i$, $b_i$, indicating that there is an undirected tree edge connecting $a_i$ and $b_i$.\n- The next line contains a positive integer $q$, representing the number of operations Xiao Q performs.\n- The next $q$ lines each describe one operation in order.", "outputFormat": "Output several lines, each containing one integer, answering each query in order. Since the answer may be large, output it modulo $10007$.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\leq a_i, b_i, x \\leq n$, $0 \\leq v_i, y, k < m$, and the number of Change operations does not exceed $10000$.\n\n![](https://cdn.luogu.com.cn/upload/pic/5534.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2017] 切树游戏", "background": "hack数据 by boshi & Remmina", "description": "小Q是一个热爱学习的人，他经常去维基百科学习计算机科学。\n\n就在刚才，小Q认真地学习了一系列位运算符，其中按位异或的运算符$\\oplus$对他影响很大。按位异或的运算符是双目运算符。按位异或具有交换律，即$i \\oplus j = j \\oplus i$。\n\n他发现，按位异或可以理解成被运算的数字的二进制位对应位如果相同，则结果的该位置为$0$，否则为$1$，例如：$1(01) \\oplus 2(10) = 3(11)$。\n\n他还发现，按位异或可以理解成参与运算的数字的每个二进制位都进行了不进位的加法，例如：$3(11) \\oplus 3(11) = 0(00)$。\n\n现在小Q有一棵$n$个结点的无根树$T$，结点依次编号为$1$到$n$，其中结点$i$的权值为$v_i$。\n\n定义一棵树的价值为它所有点的权值的异或和，一棵树$T$的连通子树就是它的一个连通子图，并且这个图也是一棵树。\n\n小Q想要在这棵树上玩切树游戏，他会不断做以下两种操作：\n\n- `Change x y` 将编号为$x$的结点的权值修改为$y$。\n\n- `Query k` 询问有多少棵$T$的非空连通子树，满足其价值恰好为$k$。\n\n小Q非常喜(bu)欢(hui)数学，他希望你能快速回答他的问题，你能写个程序帮帮他吗？\n", "inputFormat": "第一行包含两个正整数$n$ , $m$，分别表示结点的个数以及权值的上限。\n\n第二行包含$n$个非负整数$v_1, v_2,\\dots , v_n$，分别表示每个结点一开始的权值。\n\n接下来$n-1$行，每行包含两个正整数$a_i , b_i$，表示有一条连接$a_i$和$b_i$的无向树边。\n\n接下来一行包含一个正整数$q$，表示小Q操作的次数。\n\n接下来$q$行每行依次表示每个操作。\n", "outputFormat": "输出若干行，每行一个整数，依次回答每个询问。因为答案可能很大，所以请对$10007$取模输出。\n", "hint": "对于$100\\%$的数据，$1 \\leq a_i,b_i,x \\leq n$ , $0 \\leq v_i,y,k < m$，修改操作不超过$10000$个。\n\n![](https://cdn.luogu.com.cn/upload/pic/5534.png)\n", "locale": "zh-CN"}}}
{"pid": "P3782", "type": "P", "difficulty": 7, "samples": [["0\n1\n3 5 4\n1 2 5 3 4\n3 4 5 1 2\n3 1 4 2 5", "7\n1 2 1\n3 4 1\n2 3 2\n4 5 2\n1 2 3\n3 4 3\n2 3 4"]], "limits": {"time": [7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "提交答案", "Special Judge", "WC"], "title": "[WC2017] 排序", "background": "**本题暂时只能使用代码提交。**\n\n", "description": "牛牛最近学习了排序的相关知识。他对排序算法的运行效率产生了浓厚的兴趣并对此展开了一系列的研究。\n\n为了优化排序的运行时间，牛牛找到了来参加冬令营的你，希望你帮助他设计一台计算机进行排序（**升序**）。\n\n这台计算机的设计方法如下：\n\n- 需要进行排序的序列存储在大小为 $n$ 的数组 $Q$ 中。\n\n- 进行计算的最小单元是比较器，一个比较器可以用一个三元组 $(i,j,t)$ 表示（$i,j,t$ 均为整数），其中 $1 \\le i<j \\le n$，$1 \\le t \\le m$。它的功能是：在时刻 $t$ 比较 $Q_{i}$ 与 $Q_{j}$ 的大小，若 $Q_{i}>Q_{j}$，就交换 $Q_{i}$ 与 $Q_{j}$ 的值，否则什么也不做。\n\n- 若要让计算机**工作**（**但不一定解决问题**），则需要任意两个比较器之间**不能发生冲突**。两个比较器 $(A,B,S)$ 与 $(C,D,T)$ **会发生冲突**当且仅当 $A,B,C,D$ 中有**至少两个相等的数**，**并且** $S=T$。例如：比较器 $(1,3,1)$ 和 $(2,4,1)$ 不会发生冲突，而比较器 $(1,2,3)$ 和 $(2,3,3)$ 会发生冲突。\n\n在运行时，这台计算机中的每个比较器都会按照预先设定好的参数在指定的时间进行相应的操作。这台计算机运行时需要消耗的时间为所有的比较器中参数 $t$ 的**最大值** $w$，该值越小意味着运行时间越短。\n\n为了检验你设计的计算机，牛牛提供了测试数据。**每组测试数据**包含 $q$ 个**问题**，即 $q$ 个长度为 $n$ 的排列 $P$。请你为**每组测试数据**设计一台运行时间不超过 $m$ 的计算机（否则计算机将**超时**），使得这台计算机能对**测试数据中所有的** $P$ 排序。\n\n", "inputFormat": "为了方便你区分不同的子任务，每个输入文件第一行为一个整数 $I$，表示当前测试点的编号。\n\n第二行一个整数 $J$ 表示**这个测试点**中的**测试数据**组数。\n\n**每组测试数据**第一行三个整数 $q,n,m$。\n\n接下来 $q$ 行每行 $n$ 个整数，描述一个 $1$ 到 $n$ 的排列 $P$。\n\n**数据保证有解。**", "outputFormat": "对于**每组测试数据**，第一行输出一个整数 $f$ 表示你设计的计算机中比较器个数。\n\n接下来 $f$ 行，每行 $3$ 个整数 $i,j,t$，描述你的计算机的一个比较器 $(i,j,t)$。\n\n若 $i,j \\notin [1,n]$，则计算机**不能工作**。", "hint": "### 输入数据及 checker 下载\n\n在[这里](http://pan.baidu.com/s/1miBgJ3q)下载。\n\n**警告：所有数据（包括 SPJ）均为 Windows（64 位）格式。**\n\n### 关于 UKE 的问题\n\n由于本题 SPJ 的时间复杂度较高，请用比较器个数尽量少的方案来通过该题，否则可能出现 SPJ TLE 的问题，导致评测结果为 UKE。\n\nSPJ 的时间复杂度为：\n$$O\\left ( \\sum_{i=1}^{J}q_i\\times (n_i+f_i) \\right )$$\n\n### 评分方式\n\n共 $8$ 个**测试点**，分别有 $6,12,13,10,10,10,19,20$ 组**测试数据**，共 $100$ 组，**每组测试数据满分 $1$ 分。**\n\n在**每组测试数据**中，若 $1 \\le w\\le m$ 且 $f\\le 10^{6}$，比较器之间不会发生冲突，计算机能对**测试数据中所有的** $P$ 排序，则该**测试数据**得分，否则不得分。\n\n如果你输出了不足 $J$ 个计算机，那么我们将默认你输出的第 $i$ 个计算机对应第 $i$ 组测试数据。\n\n如果你的输出不符合格式要求，我们不保证你能得到该测试点的分数。\n\n### 数据特性\n\n对于 $100\\%$ 的数据，$1 \\le m \\le 150$，$J \\in \\{1,6,10,12,13,19,20\\}$，$0 \\le I \\le 8$，其余请自行下载数据查看。\n\n这里给出部分数据的部分特性：\n\n- **测试点 $4$（$10$ 分）** 中，对于输入的每一个排列 $P$，它每一个环的大小都互不相同。循环可以理解为，将一个长度为 $n$ 的排列 $P$ 看成一张 $n$ 个点 $n$ 条边的无向图（**基环森林**），其中 $i$ 号点和 $P_{i}$ 号点之间有一条边，这张图中的**每一个联通块都是一个环**（**即该图由若干个环组成**），如 $P=\\{\\color{blue}1,\\color{green}3,2,\\color{purple}6,\\color{red}10,\\color{purple}7,4,\\color{red}5,8,9\\color{black}\\}$（**每个颜色代表一个环**）。\n\n- **测试点 $7$（$19$ 分）** 中，对于输入的每一个排列 $P$，都存在若干个互不相交的区间 $[l_i,r_i]$，使得在对每一个区间 $[l_i,r_i]$ 循环左移一次后，数组有序，如 $P=\\{\\color{blue}3,1,2,\\color{green}7,4,5,6,\\color{purple}8,\\color{red}9\\color{black}\\}$（**每个颜色代表一个区间**）。循环左移的例子为：$(1,2,3,4)$ 循环左移一步为 $(2,3,4,1)$。\n- **测试点 $7$ 的前 $8$ 组测试数据（$8$ 分）** 中，满足对于输入的每一个排列 $P$，都存在整数 $i$，使得对区间 $[1,i]$ 循环左移一次后，数组有序，如 $P=\\{\\color{red}5,1,2,3,4\\color{black},6,7,8\\}$。\n\n### 测试你的输出\n\n我们在文件中提供了 `checker`（**Windows x64**）来检测你的输出的得分，使用这个工具的方法为：\n\n`checker.exe sort<I>.in sort<I>.out sort<I>.out`\n\n其中 $I$ 为**测试点**编号（**输入时不带尖括号**），`checker.exe` 为校验器，`sort<I>.in` 为题目提供的输入文件，`sort<I>.out` 为你的对应的输出文件（**输入两遍**）。运行此命令将给出以 `sort<I>.in` 为输入文件，以 `sort<I>.out` 为输出文件时你的得分情况。\n\n在你调用这个程序后，`checker` 将根据你给出的输出文件给出每一个**测试数据**的测试结果，其中包括（如果你输出的计算机同时出现了多种错误，将会返回其中一种）：\n\n| 测试结果 | 含义 |\n| :----------- | :----------- |\n| `FAIL!` | 未知错误：SPJ 运行失败。 |\n| `Input error!` | 输入文件非法：你改动了输入文件。 |\n| `The number of the comparators is invalid!` | 检测到 $f>10^6$。 |\n| `Unexpected EOF` | 给出的计算机不完整。 |\n| `The running time of the comparator should be in [1, 150]` | 检测到 $w \\notin [1,150]$。 |\n| `Invalid sorting network!` | 给出的计算机不能工作。 |\n| `The answer is incorrect` | 给出的计算机不能解决所有问题。 |\n| `Invalid! m=(X) but M=(X)` | 给出的计算机超时：$w=Y,m=X$（$Y>X$）。 |\n| `Correct! m=(X) and M=(X)` | 给出的计算机正确：$w=Y,m=X$（$Y\\le X$）。 |\n\n最后，如果 `checker` 正常运行到了最后，将会额外输出一行 `Total points: (Z)`，表示你在**这个测试点**一共得了 $Z$ 分。\n\n### 提醒\n\n**请注意「测试点」、「测试数据」和「问题」的区别！**\n\n**请牢记下面的图示：**\n\n- 整道题目\n\n  - 测试点 $1$\n    \n    - 测试数据 $1.1$\n    \n      - 问题 $1.1.1$\n      \n    - 测试数据 $1.2$\n    \n      - 问题 $1.2.1$\n      \n    - 测试数据 $1.3$\n    \n      - 问题 $1.3.1$\n      \n      - 问题 $1.3.2$\n      \n      - ……\n      \n      - 问题 $1.3.5$\n      \n    - ……\n    \n    - 测试数据 $1.6$\n    \n  - 测试点 $2$\n  \n  - ……\n  \n  - 测试点 $8$\n", "locale": "zh-CN", "translations": {"en": {"title": "[WC2017] Sorting", "background": "This problem currently only allows code submissions.", "description": "Niuniu has recently learned about sorting and has become very interested in the efficiency of sorting algorithms. To optimize sorting time, Niuniu turned to you at the winter camp to help design a computer to perform sorting (ascending).\n\nThe computer is designed as follows:\n\n- The sequence to be sorted is stored in an array $Q$ of size $n$.\n\n- The smallest unit of computation is a comparator, represented by a triple $(i, j, t)$ (all integers), where $1 \\le i < j \\le n$, $1 \\le t \\le m$. Its function is: at time $t$, compare $Q_{i}$ and $Q_{j}$. If $Q_{i} > Q_{j}$, swap $Q_{i}$ and $Q_{j}$; otherwise do nothing.\n\n- For the computer to work (but not necessarily solve the problem), any two comparators must not conflict. Two comparators $(A, B, S)$ and $(C, D, T)$ conflict if and only if at least two numbers among $A, B, C, D$ are equal and $S = T$. For example, comparators $(1, 3, 1)$ and $(2, 4, 1)$ do not conflict, while $(1, 2, 3)$ and $(2, 3, 3)$ do conflict.\n\nAt runtime, each comparator in the computer performs its operation at its preset time. The running time of the computer is the maximum value $w$ of parameter $t$ among all comparators; the smaller this value, the shorter the running time.\n\nTo test your computer design, Niuniu provides testdata. Each group of testdata contains $q$ queries, i.e., $q$ permutations $P$ of length $n$. For each group of testdata, please design a computer with running time at most $m$ (otherwise the computer will time out) that can sort all $P$ in the testdata.", "inputFormat": "To help you distinguish sub-tasks, each input file begins with an integer $I$, the current test point index.\n\nThe second line contains an integer $J$, the number of testdata groups in this test point.\n\nFor each group of testdata, the first line contains three integers $q, n, m$.\n\nThen follow $q$ lines, each containing $n$ integers describing a permutation $P$ of $1$ to $n$.\n\nIt is guaranteed that a solution exists.", "outputFormat": "For each group of testdata, output an integer $f$ in the first line, the number of comparators in your computer.\n\nThen output $f$ lines, each with $3$ integers $i, j, t$, describing a comparator $(i, j, t)$ of your computer.\n\nIf $i, j \\notin [1, n]$, then the computer cannot work.", "hint": "### Download input data and checker\n\nDownload from [here](http://pan.baidu.com/s/1miBgJ3q).\n\nWarning: All files (including the SPJ) are in Windows (64-bit) format.\n\n### About the UKE issue\n\nBecause the SPJ has high time complexity, please use as few comparators as possible. Otherwise the SPJ may TLE, causing the verdict to be UKE.\n\nThe SPJ time complexity is:\n$$O\\left ( \\sum_{i=1}^{J}q_i\\times (n_i+f_i) \\right )$$\n\n### Scoring\n\nThere are 8 test points with $6, 12, 13, 10, 10, 10, 19, 20$ groups of testdata respectively, 100 groups in total, and each group of testdata is worth 1 point.\n\nIn each group of testdata, if $1 \\le w \\le m$ and $f \\le 10^{6}$, the comparators do not conflict, and the computer can sort all $P$ in the testdata, then that testdata scores; otherwise it scores 0.\n\nIf you output fewer than $J$ computers, we assume your $i$-th computer corresponds to the $i$-th group of testdata.\n\nIf your output format is invalid, we do not guarantee you can get points for that test point.\n\n### Data characteristics\n\nFor $100\\%$ of the data, $1 \\le m \\le 150$, $J \\in \\{1, 6, 10, 12, 13, 19, 20\\}$, $0 \\le I \\le 8$. See the downloadable data for the rest.\n\nSome partial characteristics:\n\n- Test point $4$ (10 points): For every input permutation $P$, all its cycle sizes are pairwise distinct. You can think of a permutation $P$ of length $n$ as an undirected graph with $n$ nodes and $n$ edges (a functional graph consisting only of cycles), where there is an edge between node $i$ and node $P_{i}$. Every connected component in this graph is a cycle (i.e., the graph consists of several cycles), e.g., $P=\\{\\color{blue}1,\\color{green}3,2,\\color{purple}6,\\color{red}10,\\color{purple}7,4,\\color{red}5,8,9\\color{black}\\}$ (each color indicates a cycle).\n\n- Test point $7$ (19 points): For every input permutation $P$, there exist several pairwise disjoint intervals $[l_i, r_i]$ such that after rotating each interval $[l_i, r_i]$ left by one step, the array becomes sorted, e.g., $P=\\{\\color{blue}3,1,2,\\color{green}7,4,5,6,\\color{purple}8,\\color{red}9\\color{black}\\}$ (each color indicates an interval). Example of a left cyclic shift: $(1, 2, 3, 4)$ rotated left by one step becomes $(2, 3, 4, 1)$.\n- In the first 8 groups of testdata of test point $7$ (8 points), for every input permutation $P$, there exists an integer $i$ such that after rotating the interval $[1, i]$ left by one step, the array becomes sorted, e.g., $P=\\{\\color{red}5,1,2,3,4\\color{black},6,7,8\\}$.\n\n### Test your output\n\nWe provide a checker (Windows x64) in the files to evaluate your output. Usage:\n\n`checker.exe sort<I>.in sort<I>.out sort<I>.out`\n\nHere $I$ is the test point index (do not include angle brackets in the input), `checker.exe` is the checker, `sort<I>.in` is the provided input file, and `sort<I>.out` is your corresponding output file (input twice). Running this command will show your score on the input file `sort<I>.in` with your output file `sort<I>.out`.\n\nAfter you invoke the program, the checker prints the result for each group of testdata, including (if multiple errors occur simultaneously, one of them is reported):\n\n| Result | Meaning |\n| :----------- | :----------- |\n| `FAIL!` | Unknown error: SPJ runtime failure. |\n| `Input error!` | Invalid input file: you modified the input. |\n| `The number of the comparators is invalid!` | Detected $f>10^6$. |\n| `Unexpected EOF` | The computer you provided is incomplete. |\n| `The running time of the comparator should be in [1, 150]` | Detected $w \\notin [1, 150]$. |\n| `Invalid sorting network!` | The computer you provided cannot work. |\n| `The answer is incorrect` | The computer you provided cannot solve all queries. |\n| `Invalid! m=(X) but M=(X)` | The computer timed out: $w=Y, m=X$ ($Y>X$). |\n| `Correct! m=(X) and M=(X)` | The computer is correct: $w=Y, m=X$ ($Y \\le X$). |\n\nFinally, if the checker finishes normally, it additionally prints `Total points: (Z)`, which is the total points you scored on this test point.\n\n### Reminder\n\nPlease pay attention to the difference between “test point”, “testdata”, and “query”.\n\nPlease keep in mind the structure below:\n\n- The whole problem\n\n  - Test point $1$\n    \n    - Testdata $1.1$\n    \n      - Query $1.1.1$\n      \n    - Testdata $1.2$\n    \n      - Query $1.2.1$\n      \n    - Testdata $1.3$\n      \n      - Query $1.3.1$\n      \n      - Query $1.3.2$\n      \n      - …\n      \n      - Query $1.3.5$\n      \n    - …\n    \n    - Testdata $1.6$\n    \n  - Test point $2$\n  \n  - …\n  \n  - Test point $8$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2017] 排序", "background": "**本题暂时只能使用代码提交。**\n\n", "description": "牛牛最近学习了排序的相关知识。他对排序算法的运行效率产生了浓厚的兴趣并对此展开了一系列的研究。\n\n为了优化排序的运行时间，牛牛找到了来参加冬令营的你，希望你帮助他设计一台计算机进行排序（**升序**）。\n\n这台计算机的设计方法如下：\n\n- 需要进行排序的序列存储在大小为 $n$ 的数组 $Q$ 中。\n\n- 进行计算的最小单元是比较器，一个比较器可以用一个三元组 $(i,j,t)$ 表示（$i,j,t$ 均为整数），其中 $1 \\le i<j \\le n$，$1 \\le t \\le m$。它的功能是：在时刻 $t$ 比较 $Q_{i}$ 与 $Q_{j}$ 的大小，若 $Q_{i}>Q_{j}$，就交换 $Q_{i}$ 与 $Q_{j}$ 的值，否则什么也不做。\n\n- 若要让计算机**工作**（**但不一定解决问题**），则需要任意两个比较器之间**不能发生冲突**。两个比较器 $(A,B,S)$ 与 $(C,D,T)$ **会发生冲突**当且仅当 $A,B,C,D$ 中有**至少两个相等的数**，**并且** $S=T$。例如：比较器 $(1,3,1)$ 和 $(2,4,1)$ 不会发生冲突，而比较器 $(1,2,3)$ 和 $(2,3,3)$ 会发生冲突。\n\n在运行时，这台计算机中的每个比较器都会按照预先设定好的参数在指定的时间进行相应的操作。这台计算机运行时需要消耗的时间为所有的比较器中参数 $t$ 的**最大值** $w$，该值越小意味着运行时间越短。\n\n为了检验你设计的计算机，牛牛提供了测试数据。**每组测试数据**包含 $q$ 个**问题**，即 $q$ 个长度为 $n$ 的排列 $P$。请你为**每组测试数据**设计一台运行时间不超过 $m$ 的计算机（否则计算机将**超时**），使得这台计算机能对**测试数据中所有的** $P$ 排序。\n\n", "inputFormat": "为了方便你区分不同的子任务，每个输入文件第一行为一个整数 $I$，表示当前测试点的编号。\n\n第二行一个整数 $J$ 表示**这个测试点**中的**测试数据**组数。\n\n**每组测试数据**第一行三个整数 $q,n,m$。\n\n接下来 $q$ 行每行 $n$ 个整数，描述一个 $1$ 到 $n$ 的排列 $P$。\n\n**数据保证有解。**", "outputFormat": "对于**每组测试数据**，第一行输出一个整数 $f$ 表示你设计的计算机中比较器个数。\n\n接下来 $f$ 行，每行 $3$ 个整数 $i,j,t$，描述你的计算机的一个比较器 $(i,j,t)$。\n\n若 $i,j \\notin [1,n]$，则计算机**不能工作**。", "hint": "### 输入数据及 checker 下载\n\n在[这里](http://pan.baidu.com/s/1miBgJ3q)下载。\n\n**警告：所有数据（包括 SPJ）均为 Windows（64 位）格式。**\n\n### 关于 UKE 的问题\n\n由于本题 SPJ 的时间复杂度较高，请用比较器个数尽量少的方案来通过该题，否则可能出现 SPJ TLE 的问题，导致评测结果为 UKE。\n\nSPJ 的时间复杂度为：\n$$O\\left ( \\sum_{i=1}^{J}q_i\\times (n_i+f_i) \\right )$$\n\n### 评分方式\n\n共 $8$ 个**测试点**，分别有 $6,12,13,10,10,10,19,20$ 组**测试数据**，共 $100$ 组，**每组测试数据满分 $1$ 分。**\n\n在**每组测试数据**中，若 $1 \\le w\\le m$ 且 $f\\le 10^{6}$，比较器之间不会发生冲突，计算机能对**测试数据中所有的** $P$ 排序，则该**测试数据**得分，否则不得分。\n\n如果你输出了不足 $J$ 个计算机，那么我们将默认你输出的第 $i$ 个计算机对应第 $i$ 组测试数据。\n\n如果你的输出不符合格式要求，我们不保证你能得到该测试点的分数。\n\n### 数据特性\n\n对于 $100\\%$ 的数据，$1 \\le m \\le 150$，$J \\in \\{1,6,10,12,13,19,20\\}$，$0 \\le I \\le 8$，其余请自行下载数据查看。\n\n这里给出部分数据的部分特性：\n\n- **测试点 $4$（$10$ 分）** 中，对于输入的每一个排列 $P$，它每一个环的大小都互不相同。循环可以理解为，将一个长度为 $n$ 的排列 $P$ 看成一张 $n$ 个点 $n$ 条边的无向图（**基环森林**），其中 $i$ 号点和 $P_{i}$ 号点之间有一条边，这张图中的**每一个联通块都是一个环**（**即该图由若干个环组成**），如 $P=\\{\\color{blue}1,\\color{green}3,2,\\color{purple}6,\\color{red}10,\\color{purple}7,4,\\color{red}5,8,9\\color{black}\\}$（**每个颜色代表一个环**）。\n\n- **测试点 $7$（$19$ 分）** 中，对于输入的每一个排列 $P$，都存在若干个互不相交的区间 $[l_i,r_i]$，使得在对每一个区间 $[l_i,r_i]$ 循环左移一次后，数组有序，如 $P=\\{\\color{blue}3,1,2,\\color{green}7,4,5,6,\\color{purple}8,\\color{red}9\\color{black}\\}$（**每个颜色代表一个区间**）。循环左移的例子为：$(1,2,3,4)$ 循环左移一步为 $(2,3,4,1)$。\n- **测试点 $7$ 的前 $8$ 组测试数据（$8$ 分）** 中，满足对于输入的每一个排列 $P$，都存在整数 $i$，使得对区间 $[1,i]$ 循环左移一次后，数组有序，如 $P=\\{\\color{red}5,1,2,3,4\\color{black},6,7,8\\}$。\n\n### 测试你的输出\n\n我们在文件中提供了 `checker`（**Windows x64**）来检测你的输出的得分，使用这个工具的方法为：\n\n`checker.exe sort<I>.in sort<I>.out sort<I>.out`\n\n其中 $I$ 为**测试点**编号（**输入时不带尖括号**），`checker.exe` 为校验器，`sort<I>.in` 为题目提供的输入文件，`sort<I>.out` 为你的对应的输出文件（**输入两遍**）。运行此命令将给出以 `sort<I>.in` 为输入文件，以 `sort<I>.out` 为输出文件时你的得分情况。\n\n在你调用这个程序后，`checker` 将根据你给出的输出文件给出每一个**测试数据**的测试结果，其中包括（如果你输出的计算机同时出现了多种错误，将会返回其中一种）：\n\n| 测试结果 | 含义 |\n| :----------- | :----------- |\n| `FAIL!` | 未知错误：SPJ 运行失败。 |\n| `Input error!` | 输入文件非法：你改动了输入文件。 |\n| `The number of the comparators is invalid!` | 检测到 $f>10^6$。 |\n| `Unexpected EOF` | 给出的计算机不完整。 |\n| `The running time of the comparator should be in [1, 150]` | 检测到 $w \\notin [1,150]$。 |\n| `Invalid sorting network!` | 给出的计算机不能工作。 |\n| `The answer is incorrect` | 给出的计算机不能解决所有问题。 |\n| `Invalid! m=(X) but M=(X)` | 给出的计算机超时：$w=Y,m=X$（$Y>X$）。 |\n| `Correct! m=(X) and M=(X)` | 给出的计算机正确：$w=Y,m=X$（$Y\\le X$）。 |\n\n最后，如果 `checker` 正常运行到了最后，将会额外输出一行 `Total points: (Z)`，表示你在**这个测试点**一共得了 $Z$ 分。\n\n### 提醒\n\n**请注意「测试点」、「测试数据」和「问题」的区别！**\n\n**请牢记下面的图示：**\n\n- 整道题目\n\n  - 测试点 $1$\n    \n    - 测试数据 $1.1$\n    \n      - 问题 $1.1.1$\n      \n    - 测试数据 $1.2$\n    \n      - 问题 $1.2.1$\n      \n    - 测试数据 $1.3$\n    \n      - 问题 $1.3.1$\n      \n      - 问题 $1.3.2$\n      \n      - ……\n      \n      - 问题 $1.3.5$\n      \n    - ……\n    \n    - 测试数据 $1.6$\n    \n  - 测试点 $2$\n  \n  - ……\n  \n  - 测试点 $8$\n", "locale": "zh-CN"}}}
{"pid": "P3783", "type": "P", "difficulty": 7, "samples": [["1\n4 4 6\n1 2 2 5\n2 3 2 5\n2 4 1 6\n4 2 1 6\n1 2 1\n2 3 1\n3 4 1\n4 5 2\n1 6 2", "2\n7\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "2017", "线段树", "各省省选", "山东", "O2优化", "虚树", "字典树 Trie"], "title": "[SDOI2017] 天才黑客", "background": "$\\text{SD0062}$ 号选手小 Q 同学为了偷到 SDOI7012 的试题，利用高超的黑客技术潜入了 SDOI 出题组的内联网的中央控制系统，然而这个内联网除了配备有中央控制系统，还为内联网中的每条单向网线设定了特殊的通信口令，这里通信口令是一个字符串，不同网线的口令可能不同。这让小 Q 同学感觉有些棘手，不过这根本难不倒他，很快他就分析出了整个内联网的结构。\n", "description": "内联网中有 $n$ 个节点（从 $1$ 到 $n$ 标号）和 $m$ 条**单向**网线，中央控制系统在第 $1$ 个节点上，每条网线单向连接内联网中的某两个节点，从 $1$ 号节点出发经过若干条网线总能到达其他任意一个节点。每个节点都可以运行任意的应用程序，应用程序会携带一条通信口令，当且仅当程序的口令与网线的口令相同时，程序才能通过这条网线到达另一端的节点继续运行，并且通过每条网线都需要花费一定的时间。\n\n每个应用程序可以在任意一个节点修改通信口令，修改通信口令花费的时间可以忽略不计，但是为了减小修改量，需要先调用一个子程序来计算当前程序的口令和网线的口令的最长公共前缀（记其长度为 $\\mathrm{len}$），由于获取网线的口令的某个字符会比较耗时，调用一次这个子程序需要花费 $\\mathrm{len}$ 个单位时间。\n\n除此之外，小 Q 同学还在中央控制系统中发现了一个字典，每条网线的口令都是字典中的某个字符串。具体来说，这个字典是一棵 $k$ 个节点（从 $1$ 到 $k$ 标号）的有根树，其中根是第 $1$ 个节点，每条**边**上有一个字符，字符串 $S$ 在字典中当且仅当存在某个点 $u$ 使得从根节点出发往下走到 $u$ 的这条路径上的字符顺次拼接构成 $S$。\n\n现在小 Q 同学在 $1$ 号节点同时开启了 $(n-1)$ 个应用程序，这些应用程序同时运行且互不干扰，每个程序的通信口令都为空，他希望用最短的时间把这些程序分别发送到其他节点上，你需要帮小 Q 同学分别计算出发送到第 $i$（$i=2,3,\\dots ,n$）个节点的程序完成任务的最短时间。\n", "inputFormat": "第一行是一个正整数 $T$，表示测试数据的组数，\n\n对于每组测试数据，第一行是三个整数 $n,m,k$，分别表示内联网的节点数、内联网的网线条数、字典树的节点数，\n\n接下来 $m$ 行，每行包含四个整数 $a_i,b_i,c_i,d_i$，表示沿着这条网线可以从第 $a_i$ 个节点花费 $c_i$ 个单位时间到达第 $b_i$ 个节点，网线的口令是由从字典树的根到 $d_i $这个点的路径上的字符顺次拼接构成的字符串（**可能为空**），需要注意的是**这个内联网可能有自环和重边**。\n\n接下来 $(k-1)$ 行，每行包含三个整数 $u_i,v_i,w_i$，表示字典树上有一条 $u_i \\rightarrow v_i$ 的边，边上有字符 $w_i$，保证给出的边构成一棵以 $1$ 为根的有根树，并且每个点连出去的边上的字符互不相同。\n", "outputFormat": "对于每组测试数据，输出 $(n-1)$ 行，第 $i$ 行表示发送到第 $(i+1)$ 个节点的程序完成任务的最短时间。\n", "hint": "样例解释：下图展示了样例中内联网的结构。字符串用红色字体标出。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/btzomagx.png)\n\n记 $\\mathrm{LCP}(S,T)$ 为字符串 $S,T$ 的**最长公共前缀**的长度。例如，$\\mathrm{LCP}(\\texttt{\\textcolor{red}{starry}killer},\\texttt{\\textcolor{red}{starry}dust})=6$。记 $\\epsilon$ 为空字符串。\n\n从 $1$ 到 $3$ 的一条可行路径是 $1 \\rightarrow 2 \\rightarrow 3$，所需时间是$(2 + \\mathrm{LCP}(\\epsilon , \\texttt{1112})) + (2 +\\mathrm{LCP}(\\texttt{1112} ,\\texttt{1112})) = 8$。\n\n但这条路径不是最优的，最优路径是 $1 \\rightarrow 2 \\rightarrow 4 \\rightarrow 2 \\rightarrow 3$。\n\n\n \n\n| 测试点编号 | $n\\le $ | $m\\le $|  $k\\le$ | 备注 |\n| :--: | :--: | :--: | :--: | :--: |\n| $1\\sim 5$ | $5\\,000$ | $5\\,000$ | $20\\,000$ | - |\n| $6\\sim 14$ | $50\\,000$ | $50\\,000$ | $20\\,000$ | $nk\\le 200\\,000$ |\n| $15\\sim 20$ | $50\\,000$ | $50\\,000$ | $20\\,000$ | - |\n\n对于 $100\\%$ 的数据，保证：\n\n- $T \\leq 10$；\n- $2 \\leq n \\leq 50000$，$1 \\leq m \\leq 50000$，$1 \\leq k \\leq 20000$；\n- $n>5000$ 或 $m > 5000$ 的数据不超过 $2$ 组；\n- $1 \\leq a_i,b_i \\leq n$，$0 \\leq c_i \\leq 20000$，$1 \\leq d_i \\leq k$；\n- $1 \\leq u_i,v_i \\leq k$，$1 \\leq w_i \\leq 20000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2017] Genius Hacker", "background": "Contestant $\\text{SD0062}$, Xiao Q, in order to steal the SDOI7012 problems, infiltrated the SDOI problem setters’ intranet central control system using superb hacking skills. However, besides the central control system, this intranet also assigns a special communication passcode to each directed network cable. A passcode is a string, and different cables may have different passcodes. This looks tricky to Xiao Q, but it cannot stop him. Soon, he analyzed the entire structure of the intranet.", "description": "The intranet has $n$ nodes (numbered from $1$ to $n$) and $m$ directed cables. The central control system is at node $1$. Each cable connects an ordered pair of nodes, and starting from node $1$ you can reach any other node by following some cables. Any node can run any application. An application carries a communication passcode. A program can traverse a cable if and only if its current passcode equals the cable’s passcode. Traversing any cable takes some amount of time.\n\nEach application can modify its communication passcode at any node. The time to change the passcode itself can be neglected. However, to minimize the amount of modification, you must first call a subroutine to compute the longest common prefix (denote its length by $\\mathrm{len}$) between the program’s current passcode and the cable’s passcode. Because obtaining any character of the cable’s passcode is time‑consuming, calling this subroutine once costs $\\mathrm{len}$ time units.\n\nIn addition, Xiao Q found a dictionary in the central control system. Every cable’s passcode is some string from this dictionary. Specifically, this dictionary is a rooted tree with $k$ nodes (numbered from $1$ to $k$), rooted at node $1$. Each edge carries a character. A string $S$ is in the dictionary if and only if there exists a node $u$ such that the characters along the path from the root to $u$ concatenated in order form $S$.\n\nNow Xiao Q simultaneously starts $(n-1)$ applications at node $1$. These programs run concurrently without interference. Each program’s initial passcode is empty. He wants to send these programs to the other nodes in the shortest possible time. You need to help Xiao Q compute, for each $i$ ($i=2,3,\\dots ,n$), the minimal time for the program destined for node $i$ to finish its task.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nFor each test case, the first line contains three integers $n, m, k$, the number of intranet nodes, the number of cables, and the number of dictionary tree nodes, respectively.\n\nThe next $m$ lines each contain four integers $a_i, b_i, c_i, d_i$, meaning that there is a directed cable from node $a_i$ to node $b_i$ whose traversal time is $c_i$, and whose passcode equals the string formed by the characters along the path from the dictionary root to node $d_i$ (which can be empty). Note that the intranet may have self‑loops and multiple edges.\n\nThe next $(k-1)$ lines each contain three integers $u_i, v_i, w_i$, indicating there is an edge $u_i \\rightarrow v_i$ in the dictionary tree whose label is a character $w_i$. It is guaranteed that the given edges form a rooted tree with root $1$, and the labels on the outgoing edges of any node are pairwise distinct.", "outputFormat": "For each test case, output $(n-1)$ lines. The $i$‑th line is the minimal time for the program to reach node $(i+1)$.", "hint": "Sample explanation: The following figure shows the intranet structure in the sample. Strings are marked in red.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/btzomagx.png)\n\nLet $\\mathrm{LCP}(S,T)$ be the length of the longest common prefix of strings $S$ and $T$. For example, $\\mathrm{LCP}(\\texttt{\\textcolor{red}{starry}killer},\\texttt{\\textcolor{red}{starry}dust})=6$. Let $\\epsilon$ be the empty string.\n\nOne feasible path from $1$ to $3$ is $1 \\rightarrow 2 \\rightarrow 3$. The required time is $(2 + \\mathrm{LCP}(\\epsilon , \\texttt{1112})) + (2 + \\mathrm{LCP}(\\texttt{1112} , \\texttt{1112})) = 8$.\n\nHowever, this path is not optimal. The optimal path is $1 \\rightarrow 2 \\rightarrow 4 \\rightarrow 2 \\rightarrow 3$.\n\n| Test point index | $n \\le$ | $m \\le$ | $k \\le$ | Remarks |\n| :--: | :--: | :--: | :--: | :--: |\n| $1 \\sim 5$ | $5\\,000$ | $5\\,000$ | $20\\,000$ | - |\n| $6 \\sim 14$ | $50\\,000$ | $50\\,000$ | $20\\,000$ | $nk \\le 200\\,000$ |\n| $15 \\sim 20$ | $50\\,000$ | $50\\,000$ | $20\\,000$ | - |\n\nFor $100\\%$ of the testdata, it is guaranteed that:\n- $T \\leq 10$.\n- $2 \\leq n \\leq 50000$, $1 \\leq m \\leq 50000$, $1 \\leq k \\leq 20000$.\n- The number of test cases with $n > 5000$ or $m > 5000$ does not exceed $2$.\n- $1 \\leq a_i, b_i \\leq n$, $0 \\leq c_i \\leq 20000$, $1 \\leq d_i \\leq k$.\n- $1 \\leq u_i, v_i \\leq k$, $1 \\leq w_i \\leq 20000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2017] 天才黑客", "background": "$\\text{SD0062}$ 号选手小 Q 同学为了偷到 SDOI7012 的试题，利用高超的黑客技术潜入了 SDOI 出题组的内联网的中央控制系统，然而这个内联网除了配备有中央控制系统，还为内联网中的每条单向网线设定了特殊的通信口令，这里通信口令是一个字符串，不同网线的口令可能不同。这让小 Q 同学感觉有些棘手，不过这根本难不倒他，很快他就分析出了整个内联网的结构。\n", "description": "内联网中有 $n$ 个节点（从 $1$ 到 $n$ 标号）和 $m$ 条**单向**网线，中央控制系统在第 $1$ 个节点上，每条网线单向连接内联网中的某两个节点，从 $1$ 号节点出发经过若干条网线总能到达其他任意一个节点。每个节点都可以运行任意的应用程序，应用程序会携带一条通信口令，当且仅当程序的口令与网线的口令相同时，程序才能通过这条网线到达另一端的节点继续运行，并且通过每条网线都需要花费一定的时间。\n\n每个应用程序可以在任意一个节点修改通信口令，修改通信口令花费的时间可以忽略不计，但是为了减小修改量，需要先调用一个子程序来计算当前程序的口令和网线的口令的最长公共前缀（记其长度为 $\\mathrm{len}$），由于获取网线的口令的某个字符会比较耗时，调用一次这个子程序需要花费 $\\mathrm{len}$ 个单位时间。\n\n除此之外，小 Q 同学还在中央控制系统中发现了一个字典，每条网线的口令都是字典中的某个字符串。具体来说，这个字典是一棵 $k$ 个节点（从 $1$ 到 $k$ 标号）的有根树，其中根是第 $1$ 个节点，每条**边**上有一个字符，字符串 $S$ 在字典中当且仅当存在某个点 $u$ 使得从根节点出发往下走到 $u$ 的这条路径上的字符顺次拼接构成 $S$。\n\n现在小 Q 同学在 $1$ 号节点同时开启了 $(n-1)$ 个应用程序，这些应用程序同时运行且互不干扰，每个程序的通信口令都为空，他希望用最短的时间把这些程序分别发送到其他节点上，你需要帮小 Q 同学分别计算出发送到第 $i$（$i=2,3,\\dots ,n$）个节点的程序完成任务的最短时间。\n", "inputFormat": "第一行是一个正整数 $T$，表示测试数据的组数，\n\n对于每组测试数据，第一行是三个整数 $n,m,k$，分别表示内联网的节点数、内联网的网线条数、字典树的节点数，\n\n接下来 $m$ 行，每行包含四个整数 $a_i,b_i,c_i,d_i$，表示沿着这条网线可以从第 $a_i$ 个节点花费 $c_i$ 个单位时间到达第 $b_i$ 个节点，网线的口令是由从字典树的根到 $d_i $这个点的路径上的字符顺次拼接构成的字符串（**可能为空**），需要注意的是**这个内联网可能有自环和重边**。\n\n接下来 $(k-1)$ 行，每行包含三个整数 $u_i,v_i,w_i$，表示字典树上有一条 $u_i \\rightarrow v_i$ 的边，边上有字符 $w_i$，保证给出的边构成一棵以 $1$ 为根的有根树，并且每个点连出去的边上的字符互不相同。\n", "outputFormat": "对于每组测试数据，输出 $(n-1)$ 行，第 $i$ 行表示发送到第 $(i+1)$ 个节点的程序完成任务的最短时间。\n", "hint": "样例解释：下图展示了样例中内联网的结构。字符串用红色字体标出。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/btzomagx.png)\n\n记 $\\mathrm{LCP}(S,T)$ 为字符串 $S,T$ 的**最长公共前缀**的长度。例如，$\\mathrm{LCP}(\\texttt{\\textcolor{red}{starry}killer},\\texttt{\\textcolor{red}{starry}dust})=6$。记 $\\epsilon$ 为空字符串。\n\n从 $1$ 到 $3$ 的一条可行路径是 $1 \\rightarrow 2 \\rightarrow 3$，所需时间是$(2 + \\mathrm{LCP}(\\epsilon , \\texttt{1112})) + (2 +\\mathrm{LCP}(\\texttt{1112} ,\\texttt{1112})) = 8$。\n\n但这条路径不是最优的，最优路径是 $1 \\rightarrow 2 \\rightarrow 4 \\rightarrow 2 \\rightarrow 3$。\n\n\n \n\n| 测试点编号 | $n\\le $ | $m\\le $|  $k\\le$ | 备注 |\n| :--: | :--: | :--: | :--: | :--: |\n| $1\\sim 5$ | $5\\,000$ | $5\\,000$ | $20\\,000$ | - |\n| $6\\sim 14$ | $50\\,000$ | $50\\,000$ | $20\\,000$ | $nk\\le 200\\,000$ |\n| $15\\sim 20$ | $50\\,000$ | $50\\,000$ | $20\\,000$ | - |\n\n对于 $100\\%$ 的数据，保证：\n\n- $T \\leq 10$；\n- $2 \\leq n \\leq 50000$，$1 \\leq m \\leq 50000$，$1 \\leq k \\leq 20000$；\n- $n>5000$ 或 $m > 5000$ 的数据不超过 $2$ 组；\n- $1 \\leq a_i,b_i \\leq n$，$0 \\leq c_i \\leq 20000$，$1 \\leq d_i \\leq k$；\n- $1 \\leq u_i,v_i \\leq k$，$1 \\leq w_i \\leq 20000$。", "locale": "zh-CN"}}}
{"pid": "P3784", "type": "P", "difficulty": 7, "samples": [["5 1000003\n1 2 3 5 7", "5\n1 2 3 4 5"], ["9 1000003\n1 2 2 3 4 5 6 7 8", "3\n1 2 5"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "各省省选", "山东", "O2优化", "莫比乌斯反演", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "[SDOI2017] 遗忘的集合", "background": "", "description": "小 Q 在他的个人主页上放出了一个悬赏：征集只含正整数的非空集合 $S$，其中的每个元素都不超过 $n$，并且满足一些附加条件。\n\n众所周知，我们可以很轻松地对于任意不超过 $n$ 的正整数 $x$，计算出把 $x$ 表示成 $S$ 中元素之和的方案数 $f(x)$，在这里我们约定，在任意方案中每个数字可以出现多次，但是不考虑数字出现的顺序。\n\n例如，当 $S=\\{1,2,3,4,5\\}$ 时，我们可以计算出 $f(2) = 2, f(3) = 3, f(4) = 5, f(5) = 7$。\n\n再例如，当 $S=\\{1,2,5\\}$ 时，我们可以计算出 $f(4) = 3, f(5) = 4, f(6) = 5, f(7) = 6$。\n\n麻烦地是现在小 Q 忘记了 $S$ 里有哪些元素，幸运地是他用存储设备记录下了所有 $f(i)\\bmod p$ 的值，小 Q 希望你能利用这些信息帮他恢复出 $S$ 原来的样子。\n\n具体来说，他希望你找到这样一个正整数的**非空**集合 $S$，其中的每个元素都不超过 $n$，并且对于任意的 $i = 1, 2,\\cdots ,n$，满足把 $i$ 表示成 $S$ 中元素之和的方案数在模 $p$ 意义下等于 $f(i)$，其中 $p$ 是记录在存储设备中的一个质数。他向你保证：**一定存在**这样的集合$S$。\n\n然而，小 Q 觉得他存储的信息并不足以恢复出唯一的 $S$，也就是说，可能会存在多个这样的集合 $S$，所以小 Q 希望你能给出所有解中**字典序最小**的解。\n\n对于满足条件的两个不同的集合 $S_1$ 和 $S_2$，我们认为 $S_1$ 的字典序比 $S_2$ 的字典序小，当且仅当存在非负整数 $k$，使得 $S_1$ 的前 $k$ 小元素与 $S_2$ 的前 $k$ 小元素完全相等，并且，要么 $S_1$ 的元素个数为 $k$，且 $S_2$ 的元素个数至少为 $(k + 1)$，要么 $S_1$ 和 $S_2$ 都有至少 $(k + 1)$ 个元素，且 $S_1$ 的第 $(k + 1)$ 小元素比 $S_2$ 的第 $(k + 1)$ 小元素小。\n", "inputFormat": "第一行包含两个整数 $n$ 和 $p$，满足 $p$ 是质数。\n\n第二行包含 $n$ 个整数 $f(1), f(2),\\cdots , f(n)$，含义见题目描述。\n\n保证每一行中相邻的整数由恰好一个空格隔开，并且末尾没有多余的空格。\n", "outputFormat": "你需要输出两行信息来描述字典序最小的解，其中第一行包含一个整数 $m\\ (m > 0)$，表示 $S$ 的元素个数，第二行包含 $m$ 个正整数 $s_1, s_2,\\cdots ,s_m$，表示将 $S$ 的所有元素按升序排序后得到的序列。\n\n你需要保证输出的每一行中相邻的整数由恰好一个空格隔开，并且每一行的末尾没有多余的空格。\n", "hint": "对于 $100\\%$ 的数据，有 $1 \\leq n < 2^{18} , 10^6 \\leq p < 2^{30} , 0 \\leq f(i) < p\\quad (i=1,2, \\cdots , n)$。\n\n![](https://cdn.luogu.com.cn/upload/pic/5548.png)\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2017] The Forgotten Set", "background": "", "description": "Little Q posted a bounty on his personal homepage: collect a **non-empty** set $S$ containing only positive integers, each not exceeding $n$, and satisfying some additional conditions.\n\nAs is well known, for any positive integer $x$ not exceeding $n$, we can easily compute the number of ways $f(x)$ to express $x$ as a sum of elements from $S$. Here, in any representation, each number may be used multiple times, and the order of numbers is ignored.\n\nFor example, when $S=\\{1,2,3,4,5\\}$, we can compute $f(2) = 2, f(3) = 3, f(4) = 5, f(5) = 7$.\n\nAnother example: when $S=\\{1,2,5\\}$, we can compute $f(4) = 3, f(5) = 4, f(6) = 5, f(7) = 6$.\n\nThe trouble is that Little Q has forgotten which elements are in $S$. Fortunately, he recorded all the values of $f(i) \\bmod p$ on a storage device, and he hopes you can use this information to reconstruct the original $S$.\n\nSpecifically, he wants you to find a **non-empty** set $S$ of positive integers, each at most $n$, such that for every $i = 1, 2, \\cdots , n$, the number of ways to represent $i$ as a sum of elements from $S$ is congruent to $f(i)$ modulo $p$, where $p$ is a prime stored on the device. He guarantees that such an $S$ exists.\n\nHowever, Little Q believes the stored information is not enough to recover a unique $S$; that is, there may be multiple such sets $S$. So he wants the lexicographically smallest one among all solutions.\n\nFor two different sets $S_1$ and $S_2$ that satisfy the conditions, we say $S_1$ is lexicographically smaller than $S_2$ if and only if there exists a non-negative integer $k$ such that the first $k$ smallest elements of $S_1$ are exactly the same as those of $S_2$, and either $S_1$ has exactly $k$ elements and $S_2$ has at least $(k + 1)$ elements, or both $S_1$ and $S_2$ have at least $(k + 1)$ elements and the $(k + 1)$-th smallest element of $S_1$ is smaller than that of $S_2$.", "inputFormat": "The first line contains two integers $n$ and $p$, where $p$ is prime.\n\nThe second line contains $n$ integers $f(1), f(2), \\cdots , f(n)$, as defined in the statement.\n\nIt is guaranteed that in each line adjacent integers are separated by exactly one space, and there is no trailing space at the end of any line.", "outputFormat": "Output two lines describing the lexicographically smallest solution. The first line contains an integer $m\\ (m > 0)$, the number of elements in $S$. The second line contains $m$ positive integers $s_1, s_2, \\cdots , s_m$, which are the elements of $S$ sorted in ascending order.\n\nYou must ensure that in each output line, adjacent integers are separated by exactly one space, and there is no trailing space at the end of any line.", "hint": "For $100\\%$ of the testdata, we have $1 \\le n < 2^{18}$, $10^6 \\le p < 2^{30}$, $0 \\le f(i) < p \\ (i = 1, 2, \\cdots , n)$.\n\n![](https://cdn.luogu.com.cn/upload/pic/5548.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2017] 遗忘的集合", "background": "", "description": "小 Q 在他的个人主页上放出了一个悬赏：征集只含正整数的非空集合 $S$，其中的每个元素都不超过 $n$，并且满足一些附加条件。\n\n众所周知，我们可以很轻松地对于任意不超过 $n$ 的正整数 $x$，计算出把 $x$ 表示成 $S$ 中元素之和的方案数 $f(x)$，在这里我们约定，在任意方案中每个数字可以出现多次，但是不考虑数字出现的顺序。\n\n例如，当 $S=\\{1,2,3,4,5\\}$ 时，我们可以计算出 $f(2) = 2, f(3) = 3, f(4) = 5, f(5) = 7$。\n\n再例如，当 $S=\\{1,2,5\\}$ 时，我们可以计算出 $f(4) = 3, f(5) = 4, f(6) = 5, f(7) = 6$。\n\n麻烦地是现在小 Q 忘记了 $S$ 里有哪些元素，幸运地是他用存储设备记录下了所有 $f(i)\\bmod p$ 的值，小 Q 希望你能利用这些信息帮他恢复出 $S$ 原来的样子。\n\n具体来说，他希望你找到这样一个正整数的**非空**集合 $S$，其中的每个元素都不超过 $n$，并且对于任意的 $i = 1, 2,\\cdots ,n$，满足把 $i$ 表示成 $S$ 中元素之和的方案数在模 $p$ 意义下等于 $f(i)$，其中 $p$ 是记录在存储设备中的一个质数。他向你保证：**一定存在**这样的集合$S$。\n\n然而，小 Q 觉得他存储的信息并不足以恢复出唯一的 $S$，也就是说，可能会存在多个这样的集合 $S$，所以小 Q 希望你能给出所有解中**字典序最小**的解。\n\n对于满足条件的两个不同的集合 $S_1$ 和 $S_2$，我们认为 $S_1$ 的字典序比 $S_2$ 的字典序小，当且仅当存在非负整数 $k$，使得 $S_1$ 的前 $k$ 小元素与 $S_2$ 的前 $k$ 小元素完全相等，并且，要么 $S_1$ 的元素个数为 $k$，且 $S_2$ 的元素个数至少为 $(k + 1)$，要么 $S_1$ 和 $S_2$ 都有至少 $(k + 1)$ 个元素，且 $S_1$ 的第 $(k + 1)$ 小元素比 $S_2$ 的第 $(k + 1)$ 小元素小。\n", "inputFormat": "第一行包含两个整数 $n$ 和 $p$，满足 $p$ 是质数。\n\n第二行包含 $n$ 个整数 $f(1), f(2),\\cdots , f(n)$，含义见题目描述。\n\n保证每一行中相邻的整数由恰好一个空格隔开，并且末尾没有多余的空格。\n", "outputFormat": "你需要输出两行信息来描述字典序最小的解，其中第一行包含一个整数 $m\\ (m > 0)$，表示 $S$ 的元素个数，第二行包含 $m$ 个正整数 $s_1, s_2,\\cdots ,s_m$，表示将 $S$ 的所有元素按升序排序后得到的序列。\n\n你需要保证输出的每一行中相邻的整数由恰好一个空格隔开，并且每一行的末尾没有多余的空格。\n", "hint": "对于 $100\\%$ 的数据，有 $1 \\leq n < 2^{18} , 10^6 \\leq p < 2^{30} , 0 \\leq f(i) < p\\quad (i=1,2, \\cdots , n)$。\n\n![](https://cdn.luogu.com.cn/upload/pic/5548.png)\n", "locale": "zh-CN"}}}
{"pid": "P3785", "type": "P", "difficulty": 7, "samples": [["3\n5 3\n2 1 1 1 1\n1 1 1 1 2\n5 5\n5 2 3 3 4\n2 5 3 4 3\n5 5\n4 5 2 1 4\n5 4 2 1 4", "YES\n5 5\n1 3\n4 4\nNO\nYES\n2 2\n1 1\n3 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "山东", "Special Judge", "O2优化", "KMP 算法", "Manacher 算法", "分类讨论", "Z 函数"], "title": "[SDOI2017] 文本校正", "background": "", "description": "小Q在研发一种数据混淆的算法时不慎将重要的文档都给混淆了。幸运的是，将这些文档校正对于他来说并不是难事。他凭借着敏锐的观察力成功地用肉眼完成了校正。\n\n为了防止这种情况再次发生，小Q希望开发一种文本校正工具，他的目标是将一个文本串$T$分成连续的$3$段，要求每段都不能为空，然后按一定顺序将这$3$段从左往右拼接起来，将其还原为初始文本串$S$。\n\n在进行了大量肉眼校正工作之后，小Q需要休息一下，因此他把这个任务交给了你。请写一个程序，判断是否可以还原，并给出一个合法的还原方案。\n", "inputFormat": "第一行包含一个正整数$Case$，表示需要进行的校正次数。\n\n接下来$Case$个部分依次表示每次校正工作，每个部分第一行包含两个正整数$n$，$m$，分别表示文本串的长度以及字符集的大小。\n\n每个部分第二行包含$n$个正整数$S_1,S_2,\\dots ,S_n$，表示$S$串。\n\n每个部分第三行包含$n$个正整数$T_1,T_2,\\dots ,T_n$，表示$T$串。\n", "outputFormat": "对于每次校正工作，若无解，则仅输出一行\"NO\"(不含引号)，否则第一行输出\"YES\"(不含引号)，接下来三行每行两个正整数$l_i$，$r_i$，按拼接顺序依次表示$T$的$3$个子串。\n\n若存在多种还原方案，请输出任意一种。\n", "hint": "对于$100\\%$的数据，$3 \\leq n \\leq 1000000$，$1 \\leq Si,Ti \\leq m \\leq 1000000$。\n\n![](https://cdn.luogu.com.cn/upload/pic/5550.png)\n\nspj by @Wen_kr \n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2017] Text Correction", "background": "", "description": "While developing a data obfuscation algorithm, Xiao Q accidentally obfuscated some important documents. Fortunately, correcting these documents is not difficult for him. With keen observation, he managed to correct them by eye.\n\nTo prevent this from happening again, Xiao Q wants to develop a text correction tool. His goal is to split a string $T$ into three consecutive segments, each of which must be non-empty, then concatenate these 3 segments from left to right in some order to restore the original string $S$.\n\nAfter a lot of manual correction, Xiao Q needs a break, so he assigns this task to you. Please write a program to determine whether restoration is possible, and if so, output a valid restoration plan.", "inputFormat": "The first line contains a positive integer $Case$, the number of correction tasks.\n\nThen follow $Case$ parts, each describing one task. The first line of each part contains two positive integers $n$, $m$, denoting the length of the string and the size of the character set, respectively.\n\nThe second line of each part contains $n$ positive integers $S_1, S_2, \\dots, S_n$, representing the string $S$.\n\nThe third line of each part contains $n$ positive integers $T_1, T_2, \\dots, T_n$, representing the string $T$.", "outputFormat": "For each task, if there is no solution, output a single line \"NO\" (without quotes). Otherwise, output \"YES\" (without quotes) on the first line, and then output three lines, each containing two positive integers $l_i$, $r_i$, representing the 3 substrings of $T$ in the concatenation order.\n\nIf multiple restoration plans exist, output any one of them.", "hint": "Constraints: For $100\\%$ of the testdata, $3 \\leq n \\leq 1000000$, $1 \\leq S_i, T_i \\leq m \\leq 1000000$.\n\n![](https://cdn.luogu.com.cn/upload/pic/5550.png)\n\nspj by @Wen_kr.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2017] 文本校正", "background": "", "description": "小Q在研发一种数据混淆的算法时不慎将重要的文档都给混淆了。幸运的是，将这些文档校正对于他来说并不是难事。他凭借着敏锐的观察力成功地用肉眼完成了校正。\n\n为了防止这种情况再次发生，小Q希望开发一种文本校正工具，他的目标是将一个文本串$T$分成连续的$3$段，要求每段都不能为空，然后按一定顺序将这$3$段从左往右拼接起来，将其还原为初始文本串$S$。\n\n在进行了大量肉眼校正工作之后，小Q需要休息一下，因此他把这个任务交给了你。请写一个程序，判断是否可以还原，并给出一个合法的还原方案。\n", "inputFormat": "第一行包含一个正整数$Case$，表示需要进行的校正次数。\n\n接下来$Case$个部分依次表示每次校正工作，每个部分第一行包含两个正整数$n$，$m$，分别表示文本串的长度以及字符集的大小。\n\n每个部分第二行包含$n$个正整数$S_1,S_2,\\dots ,S_n$，表示$S$串。\n\n每个部分第三行包含$n$个正整数$T_1,T_2,\\dots ,T_n$，表示$T$串。\n", "outputFormat": "对于每次校正工作，若无解，则仅输出一行\"NO\"(不含引号)，否则第一行输出\"YES\"(不含引号)，接下来三行每行两个正整数$l_i$，$r_i$，按拼接顺序依次表示$T$的$3$个子串。\n\n若存在多种还原方案，请输出任意一种。\n", "hint": "对于$100\\%$的数据，$3 \\leq n \\leq 1000000$，$1 \\leq Si,Ti \\leq m \\leq 1000000$。\n\n![](https://cdn.luogu.com.cn/upload/pic/5550.png)\n\nspj by @Wen_kr \n", "locale": "zh-CN"}}}
{"pid": "P3786", "type": "P", "difficulty": 5, "samples": [["5 5 10 3 3\n1 1\n1 11\n1\n3 4\n5 2\n3 5\n1 1\n5 4\n3 4\n2 1\n1 1\n1 1\n5 5", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "最短路", "进制", "洛谷比赛", "状压 DP"], "title": "萃香抱西瓜", "background": " ![](https://cdn.luogu.com.cn/upload/pic/5565.png) \n\n伊吹萃香 (Ibuki Suika) 正在魔法之森漫步，突然，许多西瓜 (Suika) 从四周飞来，划出了绚丽的轨迹。虽然阵势有点恐怖，但她还是决定抱走一些西瓜。\n", "description": "萃香所处的环境被简化为一个长为 $h$，宽为 $w$ 的网格平面。$X$ 坐标范围为 $[1,w]$，$Y$ 坐标范围为 $[1,h]$。\n\n她初始时（第 $1$ 个时刻）站在坐标为 $(sx,sy)$ 的方格。\n\n西瓜可能在任意一个方格出现，在每个时间单位，它们可能向任何一个方向移动，也可能静止不动。西瓜的位置和移动的轨迹是已知的。西瓜的总数为 $n$ 个，但只有 $m$ 个西瓜可以被萃香抱走，因为其他都太大了，可能会砸伤她。\n\n整个过程会持续 $T$ 个时刻。萃香希望可以抱走全部的 $m$ 个西瓜，并且在任何时候避免与任何一个过大的西瓜处在同一位置。抱走的方式为在某个时刻，与该西瓜处于同一位置。另外，由于萃香不愿耗费过多体力到处乱跑，她每个时刻可以选择静止不动，也可以选择移动到相邻的四个格子之一，只要不越出环境边界。如果选择移动到相邻格子，则算作移动了一次。第 $1$ 个时刻萃香刚站定，无法移动。\n\n在每个时刻，如果萃香选择移动，可以认为萃香与西瓜同时从原来的位置移到了新的位置，没有先后顺序。\n\n萃香想要知道，不被任何一个大西瓜砸中，并得到所有的m个小西瓜的情况下，最少需要移动多少次。\n", "inputFormat": "第一行五个整数 $h,w,T,sx,sy$ ，含义见题目描述。\n\n第二行两个整数 $n,m$，含义见题目描述。\n\n接下来 $n$ 段数据，每一段描述了一个西瓜的出现位置，时间，移动方式，是否可以被抱走等内容，具体如下:\n\n首先一行，两个整数 $t1,t2$，表示西瓜在 $t1$ 时刻出现，$t2$ 时刻消失。若 $t2=T+1$，表示西瓜在最后一个时刻也不消失。保证西瓜至少存在一个时刻。\n\n接下来一行一个整数 $a$，只能为 $0$ 或 $1$，$0$ 表示这个西瓜需要避开，$1$ 表示这个西瓜需要抱走。数据保证需要抱走的西瓜恰好有 $m$ 个。\n\n接下来 $t2-t1$ 行，每一行两个整数 $x,y$，顺序描述了从 $t1$ 时刻到 $t2-1$ 时刻，该西瓜的坐标。西瓜的移动不一定是连续的，并且是一瞬间完成的，所以无需考虑萃香是否站在了移动路径上。\n", "outputFormat": "如果萃香在整个 $T$ 时刻内无法避免被大西瓜砸中或者无法收集到所有 $m$ 个小西瓜，输出 $-1$，否则输出一个整数，表示萃香需要移动的最少次数。\n", "hint": "\n### 样例说明\n第 $2 \\sim 4$ 个时刻萃香站着不动，在第 $6$ 个时刻，西瓜出现在萃香旁边，萃香移动到 $(3,4)$ 位置即可抱走这个西瓜。\n\n### 数据范围和提示\n\n本题采用捆绑测试。\n\nSubtask $1$：具有特殊性质 A 和 B；\n\nSubtask $2 \\sim 3$：仅具有特殊性质 A；\n\nSubtask $4 \\sim 5$：仅具有特殊性质 B；\n\nSubtask $6 \\sim 10$：不具有任何一个特殊性质。\n\n特殊性质 A：对于所有西瓜，均满足 $t1=1,t2=T+1$。\n所有西瓜全程都静止在原地，不会发生移动。\n\n特殊性质 B：$m=0$。\n\n对于全部子任务，满足：\n\n$1 \\le x \\le w,1 \\le y \\le h$\n\n$1\\le n \\le 20,\n0 \\le m \\le 10,\nm \\le n$\n\n$1 \\le h,w \\le 5,\n1 \\le T \\le 100,\n1 \\le t1 \\le T,\n2 \\le t2 \\le T+1,\nt1< t2$\n\n\n保证一个位置不会同时出现两个或两个以上西瓜。", "locale": "zh-CN", "translations": {"en": {"title": "Suika Hugs Watermelons", "background": "![](https://cdn.luogu.com.cn/upload/pic/5565.png)\n\nIbuki Suika (pinyin: Yībùcuìxiāng; Ibuki Suika) is strolling through the Forest of Magic when suddenly many watermelons (Suika) fly in from all directions, tracing brilliant paths. Although the scene is a bit scary, she still decides to pick up some watermelons.", "description": "Suika’s environment is simplified to a grid of length $h$ and width $w$. The $X$-coordinate range is $[1, w]$, and the $Y$-coordinate range is $[1, h]$.\n\nAt the initial moment (time $1$), she stands on the cell at coordinates $(sx, sy)$.\n\nA watermelon may appear on any cell. At each time unit, it may move in any direction or stay still. The positions and trajectories of all watermelons are known. The total number of watermelons is $n$, but only $m$ of them can be picked up by Suika; the others are too big and may hurt her.\n\nThe whole process lasts for $T$ time steps. Suika wants to pick up all $m$ small watermelons while avoiding being at the same position as any big watermelon at any time. To pick up a watermelon, she must be at the same position as that watermelon at some time step. Also, because Suika does not want to run around too much, at each time step she may either stay still or move to one of the four adjacent cells, as long as she does not leave the grid. If she moves to an adjacent cell, it counts as one move. At time $1$, Suika has just taken her position and cannot move.\n\nAt each time step, if Suika chooses to move, you may assume that Suika and the watermelons move from their old positions to their new positions simultaneously, with no order.\n\nSuika wants to know the minimum number of moves needed to avoid all big watermelons and collect all $m$ small watermelons.", "inputFormat": "The first line contains five integers $h, w, T, sx, sy$, as described above.\n\nThe second line contains two integers $n, m$, as described above.\n\nThen follow $n$ blocks. Each block describes a watermelon's appearance time, disappearance time, movement, and whether it can be picked up:\n\n- First line: two integers $t1, t2$, meaning the watermelon appears at time $t1$ and disappears at time $t2$. If $t2 = T + 1$, the watermelon does not disappear even at the last time step. It is guaranteed that each watermelon exists for at least one time step.\n- Next line: one integer $a$, either $0$ or $1$. $0$ means this watermelon must be avoided; $1$ means this watermelon must be picked up. It is guaranteed that exactly $m$ watermelons need to be picked up.\n- Next $t2 - t1$ lines: each line contains two integers $x, y$, in order describing the coordinates of this watermelon from time $t1$ to time $t2 - 1$. A watermelon’s movement may be non-continuous and happens instantaneously, so you do not need to consider whether Suika was on the movement path.", "outputFormat": "If Suika cannot avoid being hit by any big watermelon during the $T$ time steps or cannot collect all $m$ small watermelons, output $-1$. Otherwise, output a single integer, the minimum number of moves Suika needs.", "hint": "### Sample Explanation\nFrom times $2$ to $4$, Suika stays still. At time $6$, a watermelon appears next to her; Suika can move to $(3, 4)$ to pick it up.\n\n### Constraints and Hint\nThis problem uses bundled testdata.\n\nSubtask 1: has special properties A and B.\n\nSubtasks 2–3: has only special property A.\n\nSubtasks 4–5: has only special property B.\n\nSubtasks 6–10: has neither special property.\n\nSpecial property A: For all watermelons, $t1 = 1, t2 = T + 1$. All watermelons stay still the whole time.\n\nSpecial property B: $m = 0$.\n\nFor all subtasks, the following hold:\n\n$1 \\le x \\le w, 1 \\le y \\le h$.\n\n$1 \\le n \\le 20, 0 \\le m \\le 10, m \\le n$.\n\n$1 \\le h, w \\le 5, 1 \\le T \\le 100, 1 \\le t1 \\le T, 2 \\le t2 \\le T + 1, t1 < t2$.\n\nIt is guaranteed that no position will contain two or more watermelons at the same time.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "萃香抱西瓜", "background": " ![](https://cdn.luogu.com.cn/upload/pic/5565.png) \n\n伊吹萃香 (Ibuki Suika) 正在魔法之森漫步，突然，许多西瓜 (Suika) 从四周飞来，划出了绚丽的轨迹。虽然阵势有点恐怖，但她还是决定抱走一些西瓜。\n", "description": "萃香所处的环境被简化为一个长为 $h$，宽为 $w$ 的网格平面。$X$ 坐标范围为 $[1,w]$，$Y$ 坐标范围为 $[1,h]$。\n\n她初始时（第 $1$ 个时刻）站在坐标为 $(sx,sy)$ 的方格。\n\n西瓜可能在任意一个方格出现，在每个时间单位，它们可能向任何一个方向移动，也可能静止不动。西瓜的位置和移动的轨迹是已知的。西瓜的总数为 $n$ 个，但只有 $m$ 个西瓜可以被萃香抱走，因为其他都太大了，可能会砸伤她。\n\n整个过程会持续 $T$ 个时刻。萃香希望可以抱走全部的 $m$ 个西瓜，并且在任何时候避免与任何一个过大的西瓜处在同一位置。抱走的方式为在某个时刻，与该西瓜处于同一位置。另外，由于萃香不愿耗费过多体力到处乱跑，她每个时刻可以选择静止不动，也可以选择移动到相邻的四个格子之一，只要不越出环境边界。如果选择移动到相邻格子，则算作移动了一次。第 $1$ 个时刻萃香刚站定，无法移动。\n\n在每个时刻，如果萃香选择移动，可以认为萃香与西瓜同时从原来的位置移到了新的位置，没有先后顺序。\n\n萃香想要知道，不被任何一个大西瓜砸中，并得到所有的m个小西瓜的情况下，最少需要移动多少次。\n", "inputFormat": "第一行五个整数 $h,w,T,sx,sy$ ，含义见题目描述。\n\n第二行两个整数 $n,m$，含义见题目描述。\n\n接下来 $n$ 段数据，每一段描述了一个西瓜的出现位置，时间，移动方式，是否可以被抱走等内容，具体如下:\n\n首先一行，两个整数 $t1,t2$，表示西瓜在 $t1$ 时刻出现，$t2$ 时刻消失。若 $t2=T+1$，表示西瓜在最后一个时刻也不消失。保证西瓜至少存在一个时刻。\n\n接下来一行一个整数 $a$，只能为 $0$ 或 $1$，$0$ 表示这个西瓜需要避开，$1$ 表示这个西瓜需要抱走。数据保证需要抱走的西瓜恰好有 $m$ 个。\n\n接下来 $t2-t1$ 行，每一行两个整数 $x,y$，顺序描述了从 $t1$ 时刻到 $t2-1$ 时刻，该西瓜的坐标。西瓜的移动不一定是连续的，并且是一瞬间完成的，所以无需考虑萃香是否站在了移动路径上。\n", "outputFormat": "如果萃香在整个 $T$ 时刻内无法避免被大西瓜砸中或者无法收集到所有 $m$ 个小西瓜，输出 $-1$，否则输出一个整数，表示萃香需要移动的最少次数。\n", "hint": "\n### 样例说明\n第 $2 \\sim 4$ 个时刻萃香站着不动，在第 $6$ 个时刻，西瓜出现在萃香旁边，萃香移动到 $(3,4)$ 位置即可抱走这个西瓜。\n\n### 数据范围和提示\n\n本题采用捆绑测试。\n\nSubtask $1$：具有特殊性质 A 和 B；\n\nSubtask $2 \\sim 3$：仅具有特殊性质 A；\n\nSubtask $4 \\sim 5$：仅具有特殊性质 B；\n\nSubtask $6 \\sim 10$：不具有任何一个特殊性质。\n\n特殊性质 A：对于所有西瓜，均满足 $t1=1,t2=T+1$。\n所有西瓜全程都静止在原地，不会发生移动。\n\n特殊性质 B：$m=0$。\n\n对于全部子任务，满足：\n\n$1 \\le x \\le w,1 \\le y \\le h$\n\n$1\\le n \\le 20,\n0 \\le m \\le 10,\nm \\le n$\n\n$1 \\le h,w \\le 5,\n1 \\le T \\le 100,\n1 \\le t1 \\le T,\n2 \\le t2 \\le T+1,\nt1< t2$\n\n\n保证一个位置不会同时出现两个或两个以上西瓜。", "locale": "zh-CN"}}}
{"pid": "P3787", "type": "P", "difficulty": 5, "samples": [["4\n1 2 1.00000000\n2 3 0.00000000\n3 4 1.00000101\n9\n1 1 3.00000000\n9 2\n9 3\n1 2 1.42856031\n9 4\n9 2\n1 3 4.23333333\n9 2\n9 4", "3.00000000\n0.00000000\n0.00000000\n4.42856031\n4.42856031\n4.23333761"]], "limits": {"time": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "线段树", "树状数组", "洛谷原创", "Special Judge", "洛谷比赛"], "title": "冰精冻西瓜", "background": "![](https://cdn.luogu.com.cn/upload/pic/5279.png) \n\n盛夏，冰之妖精琪露诺发现了一大片西瓜地，终于可以吃到美味的冻西瓜啦。", "description": "琪露诺是拥有操纵冷气程度的能力的妖精，一天她发现了一片西瓜地。这里有 $n$ 个西瓜，由 $n-1$ 条西瓜蔓连接，形成一个有根树，琪露诺想要把它们冷冻起来慢慢吃。\n\n这些西瓜蔓具有神奇的性质，可以将经过它的冷气的寒冷程度放大或缩小，每条西瓜蔓放大/缩小冷气寒冷程度的能力值为 $w_i$，表示冷气经过它后，寒冷程度值 $x$ 会变为 $ x\\times w_i$。每个西瓜也有一个寒冷程度值，炎热的夏日，所有西瓜的寒冷程度值初始都为 $0$。\n\n琪露诺会做出两种动作:\n\n①.对着西瓜 $i$ 放出寒冷程度为 $x$ 的冷气。这股冷气顺着西瓜蔓向“西瓜树”的叶子节点蔓延，冷气的寒冷程度会按照上面的规则变化。遇到一个西瓜连了多条西瓜蔓时，每条叶子节点方向的西瓜蔓均会获得与原先寒冷程度相等的冷气。途径的所有西瓜的寒冷程度值都会加上冷气的寒冷程度值。\n\n**冷气只会向释放点的子树蔓延，不会向根方向蔓延**\n\n⑨.向你询问西瓜 $i$ 的寒冷程度值是多少。\n\n等等，为什么会有⑨？因为笨蛋琪露诺自己也会忘记放了多少冰呢。\n\n所以，帮她计算的任务就这么交给你啦。", "inputFormat": "第一行一个整数 $n$，表示西瓜的数量。\n\n西瓜编号为 $1\\sim n$，$1$ 为这棵“西瓜树”的根。\n\n接下来 $n-1$ 行，每行有两个整数 $u$、$v$ 和一个实数 $w$，表示西瓜 $u$ 和西瓜 $v$ 之间连接有一条藤蔓，它放大/缩小冷气寒冷程度的能力值为 $w$。\n\n接下来一行一个整数 $m$，表示操作的数量。\n\n接下来 $m$ 行，每行两个整数或两个整数和一个实数。\n\n第一个数只能是 $1$ 或 $9$。\n\n如果为 $1$，接下来一个整数 $i$ 和一个实数 $x$，表示对西瓜 $i$ 放出寒冷程度为 $x$ 的冷气。\n\n如果为 $9$，接下来一个整数 $i$，表示询问编号为 $i$ 的西瓜的寒冷程度值。", "outputFormat": "对于每个操作⑨，输出一行一个实数，表示对应西瓜的寒冷程度值。", "hint": "子任务可能出现如下的特殊性质:\n\n“西瓜树”退化为一条链\n\n输入数据中的实数均保留8位小数，选手的答案被判作正确当且仅当输出与标准答案误差不超过 $10^{-7}$。请特别注意浮点数精度问题。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5278.png) \n\n实际数据中，冷气的寒冷程度x的范围为 $[-0.1,0.1]$\n\n(样例中的冷气寒冷程度的范围为 $[1,5]$)\n\n命题人:orangebird,鸣谢oscar。", "locale": "zh-CN", "translations": {"en": {"title": "The Ice Fairy Freezes Watermelons", "background": "![](https://cdn.luogu.com.cn/upload/pic/5279.png) \n\nIn midsummer, the ice fairy Cirno discovered a large watermelon field. She can finally enjoy delicious frozen watermelons.", "description": "Cirno is a fairy who can control how cold the air is. One day she found a watermelon field. There are $n$ watermelons, connected by $n-1$ vines, forming a rooted tree. Cirno wants to freeze them and eat them slowly.\n\nThese watermelon vines have a magical property: they can amplify or attenuate the coldness of the passing cold air. Each vine has a multiplier $w_i$, meaning that after the cold air passes through it, a coldness value $x$ becomes $ x\\times w_i$. Each watermelon also has a coldness value, and on a hot summer day all watermelons start with coldness $0$.\n\nCirno performs two types of actions:\n\n①. Release cold air of coldness $x$ at watermelon $i$. This cold air spreads along the vines toward the leaves of the \"watermelon tree\", and its coldness changes according to the above rule. When a watermelon has multiple outgoing vines toward leaf nodes, each vine gets cold air with the same coldness as before the split. Every watermelon along the path adds the current coldness of the air to its own coldness.\n\n**The cold air only spreads within the subtree of the release point and never toward the root.**\n\n⑨. Ask for the coldness value of watermelon $i$.\n\nWait, why is there a ⑨? Because silly Cirno herself sometimes forgets how much ice she has released.\n\nSo please help her compute it.", "inputFormat": "The first line contains an integer $n$, the number of watermelons.\n\nThe watermelons are numbered $1$ to $n$, and $1$ is the root of this \"watermelon tree\".\n\nThe next $n-1$ lines each contain two integers $u$, $v$ and a real number $w$, indicating that there is a vine between watermelons $u$ and $v$, and its amplification/attenuation multiplier is $w$.\n\nThe next line contains an integer $m$, the number of operations.\n\nEach of the next $m$ lines contains either two integers, or two integers and a real number.\n\nThe first number can only be $1$ or $9$.\n\nIf it is $1$, then an integer $i$ and a real number $x$ follow, meaning to release cold air of coldness $x$ at watermelon $i$.\n\nIf it is $9$, then an integer $i$ follows, meaning to query the coldness value of watermelon $i$.", "outputFormat": "For each operation ⑨, output one line with a real number, the coldness value of the corresponding watermelon.", "hint": "A subtask may have the following special property:\n\nThe \"watermelon tree\" degenerates into a chain.\n\nAll real numbers in the input keep 8 decimal places. A solution is accepted if and only if the absolute error from the standard answer is at most $10^{-7}$. Please pay special attention to floating-point precision.\n\n![](https://cdn.luogu.com.cn/upload/pic/5278.png) \n\nIn the actual testdata, the range of the coldness $x$ of the cold air is $[-0.1, 0.1]$.\n\n(In the samples, the range of the coldness is $[1, 5]$.)\n\nProblem setter: orangebird, thanks to oscar.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "冰精冻西瓜", "background": "![](https://cdn.luogu.com.cn/upload/pic/5279.png) \n\n盛夏，冰之妖精琪露诺发现了一大片西瓜地，终于可以吃到美味的冻西瓜啦。", "description": "琪露诺是拥有操纵冷气程度的能力的妖精，一天她发现了一片西瓜地。这里有 $n$ 个西瓜，由 $n-1$ 条西瓜蔓连接，形成一个有根树，琪露诺想要把它们冷冻起来慢慢吃。\n\n这些西瓜蔓具有神奇的性质，可以将经过它的冷气的寒冷程度放大或缩小，每条西瓜蔓放大/缩小冷气寒冷程度的能力值为 $w_i$，表示冷气经过它后，寒冷程度值 $x$ 会变为 $ x\\times w_i$。每个西瓜也有一个寒冷程度值，炎热的夏日，所有西瓜的寒冷程度值初始都为 $0$。\n\n琪露诺会做出两种动作:\n\n①.对着西瓜 $i$ 放出寒冷程度为 $x$ 的冷气。这股冷气顺着西瓜蔓向“西瓜树”的叶子节点蔓延，冷气的寒冷程度会按照上面的规则变化。遇到一个西瓜连了多条西瓜蔓时，每条叶子节点方向的西瓜蔓均会获得与原先寒冷程度相等的冷气。途径的所有西瓜的寒冷程度值都会加上冷气的寒冷程度值。\n\n**冷气只会向释放点的子树蔓延，不会向根方向蔓延**\n\n⑨.向你询问西瓜 $i$ 的寒冷程度值是多少。\n\n等等，为什么会有⑨？因为笨蛋琪露诺自己也会忘记放了多少冰呢。\n\n所以，帮她计算的任务就这么交给你啦。", "inputFormat": "第一行一个整数 $n$，表示西瓜的数量。\n\n西瓜编号为 $1\\sim n$，$1$ 为这棵“西瓜树”的根。\n\n接下来 $n-1$ 行，每行有两个整数 $u$、$v$ 和一个实数 $w$，表示西瓜 $u$ 和西瓜 $v$ 之间连接有一条藤蔓，它放大/缩小冷气寒冷程度的能力值为 $w$。\n\n接下来一行一个整数 $m$，表示操作的数量。\n\n接下来 $m$ 行，每行两个整数或两个整数和一个实数。\n\n第一个数只能是 $1$ 或 $9$。\n\n如果为 $1$，接下来一个整数 $i$ 和一个实数 $x$，表示对西瓜 $i$ 放出寒冷程度为 $x$ 的冷气。\n\n如果为 $9$，接下来一个整数 $i$，表示询问编号为 $i$ 的西瓜的寒冷程度值。", "outputFormat": "对于每个操作⑨，输出一行一个实数，表示对应西瓜的寒冷程度值。", "hint": "子任务可能出现如下的特殊性质:\n\n“西瓜树”退化为一条链\n\n输入数据中的实数均保留8位小数，选手的答案被判作正确当且仅当输出与标准答案误差不超过 $10^{-7}$。请特别注意浮点数精度问题。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5278.png) \n\n实际数据中，冷气的寒冷程度x的范围为 $[-0.1,0.1]$\n\n(样例中的冷气寒冷程度的范围为 $[1,5]$)\n\n命题人:orangebird,鸣谢oscar。", "locale": "zh-CN"}}}
{"pid": "P3788", "type": "P", "difficulty": 5, "samples": [["2\n90 270\n315 45", "0.0%\n70.7%"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "洛谷原创", "洛谷比赛"], "title": "幽幽子吃西瓜", "background": " ![](https://cdn.luogu.com.cn/upload/pic/5575.png) \n\n西行寺幽幽子是冥界的亡灵，她是一个标准的吃货，现在她的面前摆着一个妖梦替她准备的大西瓜。\n", "description": "妖梦费了好大的劲为幽幽子准备了一个大西瓜，甚至和兔子铃仙打了一架。现在妖梦闲来无事，就蹲在一旁看幽幽子吃西瓜。西瓜可以看作一个标准的球体，瓜皮是绿色的，瓜瓤是红色的，瓜皮的厚度可视为0。妖梦恰好以正视的角度看着这个西瓜。幽幽子是一个吃货，妖梦一走神，自己背后的刀就不见了，而西瓜也被切掉了一块。幽幽子切西瓜时刀面始终垂直于桌面，并且切下的一块在俯视图中正好是一个以西瓜中心为顶点，半径为西瓜半径的扇形。如图所示，是一种满足条件的情况\n\n俯视:\n\n ![](https://cdn.luogu.com.cn/upload/pic/5576.png) \n\n正视:\n\n ![](https://cdn.luogu.com.cn/upload/pic/5577.png) \n\n妖梦看着红红绿绿的西瓜，忽然陷入思考，红色的西瓜瓤占整个西瓜可视面积的百分之多少呢？但她对几何一窍不通，于是想问问幽幽子，但幽幽子正抱着切下来的西瓜大吃特吃，没有理会妖梦。于是她想让你来帮她解决这个问题。\n\n为了方便描述问题，我们为俯视图建立一个平面极坐标系，极点在俯视图圆形(扇形)的正中央，极轴方向竖直向下。极轴所对应的角度为0度，角度逆时针依次增加，直到转一圈又回到极轴。因此角度范围是[0,360)。幽幽子会切掉西瓜从a°到b°的这一整块。\n", "inputFormat": "第一行一个整数T，表示数据组数。\n\n接下来T行每行两个整数a,b。表示切掉范围的起始角度和终止角度。若a>b，则切掉的角度为[a,360)∪[0,b]这一范围。\n", "outputFormat": "T行，每行一个实数后跟一个百分号“%”，表示被切掉一部分的西瓜的正视图(平行投影)中，红色的西瓜瓤占西瓜总可视面积的百分比。在此题中，妖梦的视野方向平行于俯视图的极轴，并且极轴射线指向妖梦。\n\n输出的实数四舍五入保留一位小数，你的答案被判作正确，当且仅当与标准答案完全相同。\n", "hint": "样例说明:\n\n第一个样例中，切掉的西瓜恰好在背面，在妖梦的角度看起来与未切过的西瓜并无区别，因此输出0%。第二个样例中，切掉了从315°~45°这一部分,经过计算，得到答案为sqrt(2)/2，化成小数得到0.707,即70.7%\n\n本题目共有10个测试点。\n\n对于第1个测试点，a,b∈{0,90,180,270}。\n\n对于第2个测试点，270<=a<=359,0<=b<=90。\n\n对于第3,4个测试点，180<=a<=359,0<=b<=179。\n\n对于全部测试点，0<=a,b<=359,a≠b。\n\n1<=T<=10000\n\n命题人:orangebird\n", "locale": "zh-CN", "translations": {"en": {"title": "Yuyuko Eats Watermelon", "background": "![](https://cdn.luogu.com.cn/upload/pic/5575.png) \n\nSaigyouji Yuyuko is a spirit of the Netherworld. She is a typical foodie. Right now, a big watermelon prepared by Youmu is placed in front of her.", "description": "Youmu put great effort into preparing a big watermelon for Yuyuko, even getting into a fight with the rabbit Reisen. Now, with nothing else to do, Youmu squats to the side and watches Yuyuko eat the watermelon. The watermelon can be regarded as a perfect sphere: the rind is green, the flesh is red, and the rind’s thickness can be considered 0. Youmu is looking at this watermelon head-on (front view). Because Yuyuko is such a foodie, the moment Youmu looks away, the sword behind her goes missing, and a piece of the watermelon has been cut off. While Yuyuko is cutting, the blade’s plane is always vertical to the tabletop, and the piece she cuts off appears in the top view exactly as a sector whose vertex is at the watermelon’s center and whose radius equals the watermelon’s radius. As shown in the figure, this is one valid situation.\n\nTop view:\n\n ![](https://cdn.luogu.com.cn/upload/pic/5576.png) \n\nFront view:\n\n ![](https://cdn.luogu.com.cn/upload/pic/5577.png) \n\nLooking at the red-and-green watermelon, Youmu suddenly wonders: what percentage of the visible area of the watermelon is the red flesh? However, she knows nothing about geometry. She wants to ask Yuyuko, but Yuyuko is busy devouring the cut-off piece and ignores her. So Youmu wants you to help solve this problem.\n\nTo make the problem easier to describe, we set up a plane polar coordinate system on the top view. The pole is at the exact center of the circular (sector) top view, and the polar axis points straight downward. The polar angle corresponding to the axis is 0 degrees. Angles increase counterclockwise until a full rotation returns to the polar axis. Therefore, the angle range is $[0, 360)$. Yuyuko will cut off the entire sector from $a^\\circ$ to $b^\\circ$.", "inputFormat": "The first line contains an integer T, the number of test cases.\n\nEach of the next T lines contains two integers a and b, representing the starting and ending angles of the cut range. If $a > b$, then the cut angle range is $[a, 360) \\cup [0, b]$.", "outputFormat": "Output T lines. Each line contains a real number followed by a percent sign \"%\", representing the percentage of the red watermelon flesh area in the front view (parallel projection) of the watermelon after the cut. In this problem, Youmu’s viewing direction is parallel to the polar axis in the top view, and the ray of the polar axis points toward Youmu.\n\nRound the real number to one digit after the decimal point. Your answer is judged correct if and only if it matches the standard answer exactly.", "hint": "Sample explanation:\n\nIn the first sample, the cut is exactly on the back side. From Youmu’s point of view, it looks no different from an uncut watermelon, so the output is 0%.\n\nIn the second sample, the cut is from $315^\\circ$ to $45^\\circ$. After calculation, the answer is $\\sqrt{2}/2$, whose decimal is 0.707, i.e., 70.7%.\n\nThere are 10 test points in total.\n\nFor test point 1, $a, b \\in \\{0, 90, 180, 270\\}$.\n\nFor test point 2, $270 \\le a \\le 359$, $0 \\le b \\le 90$.\n\nFor test points 3–4, $180 \\le a \\le 359$, $0 \\le b \\le 179$.\n\nFor all test points, $0 \\le a, b \\le 359$, $a \\ne b$.\n\n$1 \\le T \\le 10000$.\n\nAuthor: orangebird.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "幽幽子吃西瓜", "background": " ![](https://cdn.luogu.com.cn/upload/pic/5575.png) \n\n西行寺幽幽子是冥界的亡灵，她是一个标准的吃货，现在她的面前摆着一个妖梦替她准备的大西瓜。\n", "description": "妖梦费了好大的劲为幽幽子准备了一个大西瓜，甚至和兔子铃仙打了一架。现在妖梦闲来无事，就蹲在一旁看幽幽子吃西瓜。西瓜可以看作一个标准的球体，瓜皮是绿色的，瓜瓤是红色的，瓜皮的厚度可视为0。妖梦恰好以正视的角度看着这个西瓜。幽幽子是一个吃货，妖梦一走神，自己背后的刀就不见了，而西瓜也被切掉了一块。幽幽子切西瓜时刀面始终垂直于桌面，并且切下的一块在俯视图中正好是一个以西瓜中心为顶点，半径为西瓜半径的扇形。如图所示，是一种满足条件的情况\n\n俯视:\n\n ![](https://cdn.luogu.com.cn/upload/pic/5576.png) \n\n正视:\n\n ![](https://cdn.luogu.com.cn/upload/pic/5577.png) \n\n妖梦看着红红绿绿的西瓜，忽然陷入思考，红色的西瓜瓤占整个西瓜可视面积的百分之多少呢？但她对几何一窍不通，于是想问问幽幽子，但幽幽子正抱着切下来的西瓜大吃特吃，没有理会妖梦。于是她想让你来帮她解决这个问题。\n\n为了方便描述问题，我们为俯视图建立一个平面极坐标系，极点在俯视图圆形(扇形)的正中央，极轴方向竖直向下。极轴所对应的角度为0度，角度逆时针依次增加，直到转一圈又回到极轴。因此角度范围是[0,360)。幽幽子会切掉西瓜从a°到b°的这一整块。\n", "inputFormat": "第一行一个整数T，表示数据组数。\n\n接下来T行每行两个整数a,b。表示切掉范围的起始角度和终止角度。若a>b，则切掉的角度为[a,360)∪[0,b]这一范围。\n", "outputFormat": "T行，每行一个实数后跟一个百分号“%”，表示被切掉一部分的西瓜的正视图(平行投影)中，红色的西瓜瓤占西瓜总可视面积的百分比。在此题中，妖梦的视野方向平行于俯视图的极轴，并且极轴射线指向妖梦。\n\n输出的实数四舍五入保留一位小数，你的答案被判作正确，当且仅当与标准答案完全相同。\n", "hint": "样例说明:\n\n第一个样例中，切掉的西瓜恰好在背面，在妖梦的角度看起来与未切过的西瓜并无区别，因此输出0%。第二个样例中，切掉了从315°~45°这一部分,经过计算，得到答案为sqrt(2)/2，化成小数得到0.707,即70.7%\n\n本题目共有10个测试点。\n\n对于第1个测试点，a,b∈{0,90,180,270}。\n\n对于第2个测试点，270<=a<=359,0<=b<=90。\n\n对于第3,4个测试点，180<=a<=359,0<=b<=179。\n\n对于全部测试点，0<=a,b<=359,a≠b。\n\n1<=T<=10000\n\n命题人:orangebird\n", "locale": "zh-CN"}}}
{"pid": "P3789", "type": "P", "difficulty": 7, "samples": [["3 3", "11 4 2 0"], ["20 10", "1398101 4582670 8103780 10126770 9931780 8075094 5618340 3422330 1841460 893790 383524"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "递推", "洛谷原创", "O2优化", "线性递推", "级数", "快速傅里叶变换 FFT", "洛谷月赛"], "title": "Azuki loves coloring", "background": "", "description": "NEKOPARA Vol.3 发售之后，在新作中不是主角的 Azuki 终于可以休息了。为了打发时间，她开始给一个由 $n$ 个格子组成的序列涂色，每个格子可以涂黑白灰三种颜色之一。为了美观，Azuki 希望序列中没有两个黑色的格子相邻，也没有两个白色的格子相邻。这样的序列有很多，Azuki 定义每个序列的权值是其中一个黑色格子和一个白色格子相邻的情况的出现次数，如序列“灰黑白黑”的权值为 $2$。Azuki 想知道，对于满足 $0\\le i\\le k$ 的每一个 $i$，长度为 $n$ 且权值为 $i$ 的序列有多少种。由于答案很大，因此她只需要知道答案 $\\text{mod }998244353$ 的值就可以了。Azuki 答应你，如果你解决了这个问题，她就可以给你做~~美味的蛋糕吃~~。\n", "inputFormat": "一行两个正整数 $n,k$。\n", "outputFormat": "一行 $k+1$ 个正整数，分别代表权值为 $0,1,\\dots,k$ 的序列的个数 $\\text{mod }998244353$ 的值。\n", "hint": "对于 $30\\%$ 的测试点，$n,k\\le 100$。\n\n对于 $50\\%$ 的测试点，$n,k\\le 5000$，时限 $1s$。其余测试点时限 $5s$。\n\n对于 $70\\%$ 的测试点，$n,k\\le 60000$。\n\n对于 $100\\%$ 的测试点，$n\\le 10^{18},k\\le 100000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Azuki loves coloring", "background": "", "description": "After the release of NEKOPARA Vol.3, Azuki, who is not the protagonist in the new work, can finally take a break. To pass the time, she starts coloring a sequence of $n$ cells, each cell being one of three colors: black, white, or gray. For aesthetics, Azuki wants no two black cells to be adjacent and no two white cells to be adjacent. There are many such sequences. Azuki defines the weight of a sequence as the number of occurrences where a black cell and a white cell are adjacent. For example, the weight of the sequence \"gray black white black\" is $2$. Azuki wants to know, for each $i$ with $0 \\le i \\le k$, how many sequences of length $n$ have weight $i$. Since the answers can be large, she only needs the values $\\text{mod }998244353$. Azuki promises that if you solve this problem, she will make you ~~delicious cake~~.", "inputFormat": "One line with two positive integers $n, k$.", "outputFormat": "One line with $k+1$ positive integers, representing the values $\\text{mod }998244353$ of the numbers of sequences whose weights are $0, 1, \\dots, k$.", "hint": "For $30\\%$ of the testdata, $n, k \\le 100$.\n\nFor $50\\%$ of the testdata, $n, k \\le 5000$, time limit $1\\ \\text{s}$. The remaining testdata have time limit $5\\ \\text{s}$.\n\nFor $70\\%$ of the testdata, $n, k \\le 60000$.\n\nFor $100\\%$ of the testdata, $n \\le 10^{18}, k \\le 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Azuki loves coloring", "background": "", "description": "NEKOPARA Vol.3 发售之后，在新作中不是主角的 Azuki 终于可以休息了。为了打发时间，她开始给一个由 $n$ 个格子组成的序列涂色，每个格子可以涂黑白灰三种颜色之一。为了美观，Azuki 希望序列中没有两个黑色的格子相邻，也没有两个白色的格子相邻。这样的序列有很多，Azuki 定义每个序列的权值是其中一个黑色格子和一个白色格子相邻的情况的出现次数，如序列“灰黑白黑”的权值为 $2$。Azuki 想知道，对于满足 $0\\le i\\le k$ 的每一个 $i$，长度为 $n$ 且权值为 $i$ 的序列有多少种。由于答案很大，因此她只需要知道答案 $\\text{mod }998244353$ 的值就可以了。Azuki 答应你，如果你解决了这个问题，她就可以给你做~~美味的蛋糕吃~~。\n", "inputFormat": "一行两个正整数 $n,k$。\n", "outputFormat": "一行 $k+1$ 个正整数，分别代表权值为 $0,1,\\dots,k$ 的序列的个数 $\\text{mod }998244353$ 的值。\n", "hint": "对于 $30\\%$ 的测试点，$n,k\\le 100$。\n\n对于 $50\\%$ 的测试点，$n,k\\le 5000$，时限 $1s$。其余测试点时限 $5s$。\n\n对于 $70\\%$ 的测试点，$n,k\\le 60000$。\n\n对于 $100\\%$ 的测试点，$n\\le 10^{18},k\\le 100000$。\n", "locale": "zh-CN"}}}
{"pid": "P3790", "type": "P", "difficulty": 6, "samples": [["4 5  \n1 2 12  \n1 3 9  \n2 4 6  \n3 4 8  \n1 4 4  ", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "O2优化", "枚举", "剪枝", "生成树", "洛谷月赛"], "title": "文艺数学题", "background": "小 Y 在 AK 曼哈顿 OI，CTSC 和 APIO 之后，开始研究数学题。", "description": "小 Y 有一张 $N$ 个点，$M$ 条边的无向图（**可能有重边、自环**），每条边都有一个权值 $w$。\n\n\n你需要计算：所有**生成树的边权的最大公约数**之和，具体操作见样例。\n\n\n由于答案可能很大，需要**对 $1000000007$ 取模**。", "inputFormat": "第一行两个正整数 $N,M$，表示点数和边数。\n\n\n接下来 $M$ 行，每行三个正整数 $u,v,w$，表示一条边连接 $u$ 和 $v$，权值为 $w$。", "outputFormat": "输出一行一个数，表示答案**对 $1000000007$ 取模**的值。", "hint": "### 样例 $1$ 的解释\n\n ![](https://cdn.luogu.com.cn/upload/pic/13639.png) \n\n显然，这张图有 $8$ 个不同的生成树。\n\n\n用 $\\gcd(x,y,z)$ 表示 $x,y,z$ 的最大公约数，则答案为\n\n$\\gcd(12,6,8)+\\gcd(6,8,9)+\\gcd(8,9,12)+\\gcd(9,12,6)+\\gcd(9,4,6)+\\gcd(12,4,8)+\\gcd(12,4,9)+\\gcd(6,4,8)$\n\n$=2+1+1+3+1+4+1+2$\n\n$=15$。\n\n### 数据范围\n\n\n对于 $20\\%$ 的数据，$N\\le 10, M\\le 20$；\n\n对于另外 $10\\%$ 的数据，$N\\le 12, M\\le 24$；\n\n对于另外 $20\\%$ 的数据，$N\\le 60, M\\le 3000$，且满足$u_i+1=v_i$；\n\n对于另外 $20\\%$ 的数据，$N\\le 40, M\\le 1000, W\\le 1000$；\n\n对于另外 $15\\%$ 的数据，$N\\le 50, M\\le 2000$；\n\n对于 $100\\%$ 的数据，$N\\le 60, M\\le 3000, W\\le 1000000$。", "locale": "zh-CN", "translations": {"en": {"title": "Artistic Math Problem", "background": "After Xiao Y AK-ed Manhattan OI, CTSC, and APIO, he started studying math problems.", "description": "Xiao Y has an undirected graph with $N$ vertices and $M$ edges (**possibly with multiple edges and self-loops**), and each edge has a weight $w$.\n\nYou need to compute the sum of the greatest common divisors of the edge weights over all spanning trees; see the sample for details.\n\nSince the answer may be large, take it **modulo $1000000007$**.", "inputFormat": "The first line contains two positive integers $N, M$, denoting the number of vertices and the number of edges.\n\nThe next $M$ lines each contain three positive integers $u, v, w$, denoting an edge connecting $u$ and $v$ with weight $w$.", "outputFormat": "Output a single integer: the answer **modulo $1000000007$**.", "hint": "### Explanation of Sample $1$\n\n![](https://cdn.luogu.com.cn/upload/pic/13639.png)\n\nObviously, this graph has $8$ different spanning trees.\n\nLet $\\gcd(x,y,z)$ denote the greatest common divisor of $x, y, z$. Then the answer is\n\n$\\gcd(12,6,8)+\\gcd(6,8,9)+\\gcd(8,9,12)+\\gcd(9,12,6)+\\gcd(9,4,6)+\\gcd(12,4,8)+\\gcd(12,4,9)+\\gcd(6,4,8)$\n\n$=2+1+1+3+1+4+1+2$\n\n$=15$.\n\n### Constraints\n\nFor $20\\%$ of the testdata, $N\\le 10, M\\le 20$;\n\nFor another $10\\%$ of the testdata, $N\\le 12, M\\le 24$;\n\nFor another $20\\%$ of the testdata, $N\\le 60, M\\le 3000$, and it satisfies $u_i+1=v_i$;\n\nFor another $20\\%$ of the testdata, $N\\le 40, M\\le 1000, W\\le 1000$;\n\nFor another $15\\%$ of the testdata, $N\\le 50, M\\le 2000$;\n\nFor $100\\%$ of the testdata, $N\\le 60, M\\le 3000, W\\le 1000000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "文艺数学题", "background": "小 Y 在 AK 曼哈顿 OI，CTSC 和 APIO 之后，开始研究数学题。", "description": "小 Y 有一张 $N$ 个点，$M$ 条边的无向图（**可能有重边、自环**），每条边都有一个权值 $w$。\n\n\n你需要计算：所有**生成树的边权的最大公约数**之和，具体操作见样例。\n\n\n由于答案可能很大，需要**对 $1000000007$ 取模**。", "inputFormat": "第一行两个正整数 $N,M$，表示点数和边数。\n\n\n接下来 $M$ 行，每行三个正整数 $u,v,w$，表示一条边连接 $u$ 和 $v$，权值为 $w$。", "outputFormat": "输出一行一个数，表示答案**对 $1000000007$ 取模**的值。", "hint": "### 样例 $1$ 的解释\n\n ![](https://cdn.luogu.com.cn/upload/pic/13639.png) \n\n显然，这张图有 $8$ 个不同的生成树。\n\n\n用 $\\gcd(x,y,z)$ 表示 $x,y,z$ 的最大公约数，则答案为\n\n$\\gcd(12,6,8)+\\gcd(6,8,9)+\\gcd(8,9,12)+\\gcd(9,12,6)+\\gcd(9,4,6)+\\gcd(12,4,8)+\\gcd(12,4,9)+\\gcd(6,4,8)$\n\n$=2+1+1+3+1+4+1+2$\n\n$=15$。\n\n### 数据范围\n\n\n对于 $20\\%$ 的数据，$N\\le 10, M\\le 20$；\n\n对于另外 $10\\%$ 的数据，$N\\le 12, M\\le 24$；\n\n对于另外 $20\\%$ 的数据，$N\\le 60, M\\le 3000$，且满足$u_i+1=v_i$；\n\n对于另外 $20\\%$ 的数据，$N\\le 40, M\\le 1000, W\\le 1000$；\n\n对于另外 $15\\%$ 的数据，$N\\le 50, M\\le 2000$；\n\n对于 $100\\%$ 的数据，$N\\le 60, M\\le 3000, W\\le 1000000$。", "locale": "zh-CN"}}}
{"pid": "P3791", "type": "P", "difficulty": 7, "samples": [["0 2 233", "14"], ["123 234 345", "205761"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "O2优化", "枚举", "进制", "前缀和", "洛谷月赛"], "title": "普通数学题", "background": "一天 zzq 没有题可以出了。于是他随便写了一个式子，求$\\sum_{i=0}^n \\sum_{j=0}^m i \\operatorname{xor}j\\operatorname{xor}x$，其中 $\\operatorname{xor}$ 表示异或。\n\nzzy 一看，这不是水题吗，就随便加了一个函数：$\\sum_{i=0}^n \\sum_{j=0}^m d(i \\operatorname{xor}j\\operatorname{xor}x)$，其中 $\\operatorname{xor}$ 表示异或，$d(x)$ 表示 $x$ 的约数个数。**注意 $d(0)=0$。**\n\n现在 zzq 不会做了，只好写了一个暴力造了数据，然后把这道题丢给了你。\n", "description": "输入三个数 $n,m,x$，要求计算 $\\sum_{i=0}^n \\sum_{j=0}^m d(i \\operatorname{xor}j\\operatorname{xor}x)$，其中 $\\operatorname{xor}$ 表示二进制下的异或，$d(x)$ 表示 $x$ 的约数个数。\n\n由于答案比较大，要求输出答案模 $ 998244353$ 后的结果。\n", "inputFormat": "一行三个数 $n,m,x$。\n", "outputFormat": "输出答案模 $ 998244353$ 后的结果。", "hint": "对于 $20\\%$ 的数据，$n,m,x \\leq 2000$。\n\n对于 $50\\%$ 的数据，$n,m,x \\leq 10^6$。\n\n对于 $80\\%$ 的数据，$n,m,x \\leq 10^8$。\n\n对于 $100\\%$ 的数据，$1 \\leq n,m,x \\leq 10^{10}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Ordinary Math Problem", "background": "One day, zzq had no problems to set. So he casually wrote an expression to compute $\\sum_{i=0}^n \\sum_{j=0}^m i \\operatorname{xor} j \\operatorname{xor} x$, where $\\operatorname{xor}$ denotes bitwise XOR.\n\nzzy thought this was easy, so he casually added a function: $\\sum_{i=0}^n \\sum_{j=0}^m d(i \\operatorname{xor} j \\operatorname{xor} x)$, where $\\operatorname{xor}$ denotes bitwise XOR and $d(x)$ denotes the number of divisors of $x$. **Note that $d(0) = 0$.**\n\nNow zzq could not solve it, so he wrote a brute-force generator to produce testdata and threw this problem to you.", "description": "Given three integers $n, m, x$, compute $\\sum_{i=0}^n \\sum_{j=0}^m d(i \\operatorname{xor} j \\operatorname{xor} x)$, where $\\operatorname{xor}$ denotes bitwise XOR and $d(x)$ denotes the number of divisors of $x$.\n\nSince the answer can be large, output the result modulo $998244353$.", "inputFormat": "One line with three integers $n, m, x$.", "outputFormat": "Output the answer modulo $998244353$.", "hint": "For $20\\%$ of the testdata, $n, m, x \\leq 2000$.\n\nFor $50\\%$ of the testdata, $n, m, x \\leq 10^6$.\n\nFor $80\\%$ of the testdata, $n, m, x \\leq 10^8$.\n\nFor $100\\%$ of the testdata, $1 \\leq n, m, x \\leq 10^{10}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "普通数学题", "background": "一天 zzq 没有题可以出了。于是他随便写了一个式子，求$\\sum_{i=0}^n \\sum_{j=0}^m i \\operatorname{xor}j\\operatorname{xor}x$，其中 $\\operatorname{xor}$ 表示异或。\n\nzzy 一看，这不是水题吗，就随便加了一个函数：$\\sum_{i=0}^n \\sum_{j=0}^m d(i \\operatorname{xor}j\\operatorname{xor}x)$，其中 $\\operatorname{xor}$ 表示异或，$d(x)$ 表示 $x$ 的约数个数。**注意 $d(0)=0$。**\n\n现在 zzq 不会做了，只好写了一个暴力造了数据，然后把这道题丢给了你。\n", "description": "输入三个数 $n,m,x$，要求计算 $\\sum_{i=0}^n \\sum_{j=0}^m d(i \\operatorname{xor}j\\operatorname{xor}x)$，其中 $\\operatorname{xor}$ 表示二进制下的异或，$d(x)$ 表示 $x$ 的约数个数。\n\n由于答案比较大，要求输出答案模 $ 998244353$ 后的结果。\n", "inputFormat": "一行三个数 $n,m,x$。\n", "outputFormat": "输出答案模 $ 998244353$ 后的结果。", "hint": "对于 $20\\%$ 的数据，$n,m,x \\leq 2000$。\n\n对于 $50\\%$ 的数据，$n,m,x \\leq 10^6$。\n\n对于 $80\\%$ 的数据，$n,m,x \\leq 10^8$。\n\n对于 $100\\%$ 的数据，$1 \\leq n,m,x \\leq 10^{10}$。\n", "locale": "zh-CN"}}}
{"pid": "P3792", "type": "P", "difficulty": 5, "samples": [["5 5\n1 2 3 4 5\n2 1 5\n2 2 3\n2 3 3\n1 3 4\n2 3 5", "damushen\ndamushen\ndamushen\nyuanxing"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "线段树", "平衡树", "洛谷原创", "O2优化", "哈希 hashing", "素数判断,质数,筛法", "洛谷月赛"], "title": "由乃与大母神原型和偶像崇拜", "background": ":::info[题目背景]{open}\n ![](https://cdn.luogu.com.cn/upload/pic/5702.png) \n\n由乃最近没事干，去研究轻拍学去了\n\n就是一个叫做flip flappers，轻拍翻转小膜女的番\n\n ![](https://cdn.luogu.com.cn/upload/pic/5703.png) \n\n然后研究的过程中她看到了一个叫做大母神原型的东西\n\n大母神不仅是部落保护神，而且是部落间互相识别的标记（以后泛化为不同的图形符号、服饰和祭祀仪式），在部落联盟出现后，具有领导力的部落神祇，上升为整个联盟的共神，进而成为酋邦和王国的共神\n\n ![](https://cdn.luogu.com.cn/upload/pic/5709.png) \n\n大概就是说这个东西是母系社会时候的偶像，然后象征着母亲可以创造生命也可以毁灭生命什么什么的，分别是善母与恶母，既孕育一切，又吞噬一切\n\n然后我们熟知的神话里面就有大母神，比如女娲其实就是个大母神。。。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5716.png) \n\n原始部落时期的大母神既具有生育和哺乳的能力，也具有保护部落、带来丰收的神力。\n\n到了神话时期，大母神进一步分化，演变出形形色色的女神，分别象征了女性能量的不同面向：孕育女神、大地女神、爱与美女神、保护女神、战争女神、丰收女神、智慧女神、命运女神……\n\n这些是善母\n\n ![](https://cdn.luogu.com.cn/upload/pic/5717.png) \n\n世间的事物总是两面性的：一切生命诞生于土地，最终要回归土地；创造的必然也拥有毁灭的能力。大母神也同样具有痛苦、恐怖、吞噬和危险的一面。\n\n比如童话故事里面的女巫，其实就是大母神的另一面的体现，也就是恶母\n\n糖果屋的故事讲的就是韩赛尔和格雷特被继母赶出家里，因为没饭吃了，然后进了森林发现了一个糖果屋，里面有个女巫，专门吃小孩子\n\n然而如果我们仔细想想这个故事，会发现它没有那么简单\n\n比如说，女巫真的是吃小孩子吗？如果女巫是个善良的老婆婆，无偿救助在森林里面困住的小孩子呢？\n\n还有就是当韩赛尔和格雷特杀死了女巫，回到家中发现她们的继母也死了\n\n这是否意味着她们实际上杀死的是她们的继母？\n\n所以这个故事本质上讲的是她们杀了她们的母亲，也就是打败了大母神\n\n很多神话故事里面都有打败大母神的情节\n:::", "description": ":::info[无关内容]{open}\n\n ![](https://cdn.luogu.com.cn/upload/pic/5706.png) \n\n你看到这里也许已经觉得由乃精神不正常了\n\n然而由乃自从不小心##了自己的##后早就不正常了\n\n由乃研究了很久大母神原型，但是仍然一脸懵逼\n\n于是就出数据结构题骗钱去了\n\n由乃：给你一个序列，每次询问一个区间是否是值域连续段\n\nzzy：你把题意说详细点\n\n由乃：就是说不能有重复数字，比如1 2 2 3就不行，然后4 2 3 1就可以\n\nyql：sb分块\n\nddd：sb bitset\n\n由乃：woc你们好树链啊，我。。我带修\n\nzzq：#######sb题\n\n由乃：我就是要出原题\n\n ![](https://cdn.luogu.com.cn/upload/pic/5710.png) \n\n![](https://cdn.luogu.com.cn/upload/pic/5705.png)\n\n:::\n给你一个长为 $n$ 的序列 $a$。\n\n每次操作分为两种：\n\n1. 修改 $x$ 位置的值为 $y$。\n2. 查询区间 $[l,r]$ 是否可以重排为值域上连续的一段。", "inputFormat": "第一行两个数 $n,m$。\n\n第二行 $n$ 个数表示 $a_i$。\n\n后面 $m$ 行每行三个数 $opt,x,y$，或者 $opt,l,r$，代表操作。", "outputFormat": "如果可以，输出 `damushen`，否则输出 `yuanxing`。", "hint": "对于 $30\\%$ 的数据，$n,m \\le 500$。\n\n对于 $60\\%$ 的数据，$n,m \\le 10^5$。\n\n对于 $100\\%$ 的数据，$n,m \\le 5\\times 10^5$。\n\n初始值的值域小于 $2.5\\times 10^7$，修改操作的 $y$ 小于等于 $n$。保证在任意时刻所有 $a_i$ 均为正整数。\n\n2s", "locale": "zh-CN", "translations": {"en": {"title": "Yuno, the Great Mother Archetype, and Idolatry", "background": "![](https://cdn.luogu.com.cn/upload/pic/5702.png)\n\nYuno recently had nothing to do and went to study \"light patting\" studies.\n\nIt is an anime called Flip Flappers.\n\n![](https://cdn.luogu.com.cn/upload/pic/5703.png)\n\nDuring her research, she came across something called the Great Mother archetype.\n\nThe Great Mother is not only the tribal protector deity but also a mark for mutual recognition between tribes (later generalized into various graphic symbols, attire, and ritual practices). After tribal alliances emerged, the deity of a tribe with leadership rose to become the common deity of the entire alliance, and then the common deity of chiefdoms and kingdoms.\n\n![](https://cdn.luogu.com.cn/upload/pic/5709.png)\n\nBasically, it says this figure is an idol from matriarchal society, symbolizing that the mother can create life and also destroy life, embodied as the Good Mother and the Terrible Mother—she nurtures all and also devours all.\n\nIn myths we are familiar with, there are Great Mother figures; for example, Nüwa is essentially a Great Mother.\n\n![](https://cdn.luogu.com.cn/upload/pic/5716.png)\n\nIn the era of primitive tribes, the Great Mother not only had the ability to give birth and nurse but also possessed divine power to protect the tribe and bring abundant harvests.\n\nBy the mythic age, the Great Mother further differentiated into a variety of goddesses, each symbolizing different aspects of feminine energy: goddess of birth, earth goddess, goddess of love and beauty, protective goddess, war goddess, harvest goddess, wisdom goddess, goddess of fate, and so on.\n\nThese are the Good Mother aspects.\n\n![](https://cdn.luogu.com.cn/upload/pic/5717.png)\n\nThings in the world are always dual: all life is born from the earth and ultimately returns to the earth; what creates also inherently has the power to destroy. The Great Mother likewise has a side of pain, terror, devouring, and danger.\n\nFor example, the witch in fairy tales is actually an embodiment of the other side of the Great Mother, namely the Terrible Mother.\n\nThe story of the gingerbread house tells of Hansel and Gretel being driven from home by their stepmother because there was no food, then entering the forest and finding a gingerbread house with a witch inside who eats children.\n\nHowever, if we think carefully about this story, we will find it is not so simple.\n\nFor instance, does the witch really eat children? What if the witch is a kind old woman who freely rescues children trapped in the forest?\n\nAnd when Hansel and Gretel kill the witch and return home, they find that their stepmother has also died.\n\nDoes that imply they actually killed their stepmother?\n\nSo the essence of this story is that they killed their mother—defeating the Great Mother.\n\nMany myths include episodes of defeating the Great Mother.", "description": "![](https://cdn.luogu.com.cn/upload/pic/5706.png)\n\nYou may already think Yuno is not mentally normal by this point.\n\nHowever, Yuno has not been normal ever since she accidentally ## her own ##.\n\nYuno studied the Great Mother archetype for a long time but is still completely confused.\n\nSo she went off to make a data structure problem to farm points.\n\nYuno: I give you a sequence; each query asks whether a subarray is a contiguous segment on the value range.\n\nzzy: Explain the problem statement in more detail.\n\nYuno: It means there cannot be duplicate numbers. For example, 1 2 2 3 is not okay, but 4 2 3 1 is okay.\n\nyql: sb block decomposition.\n\nddd: sb bitset.\n\nYuno: Wow, you all love tree chains. I... I’ll support modifications.\n\nzzq: ####### sb problem.\n\nYuno: I’m going to publish the original problem as is.\n\n![](https://cdn.luogu.com.cn/upload/pic/5710.png)\n\nYou are given a sequence $a$ of length $n$.\n\nThere are two types of operations:\n\n1. Update the value at position $x$ to $y$.\n2. Query whether the subarray $[l, r]$ can be rearranged into a consecutive range of values.\n\n![](https://cdn.luogu.com.cn/upload/pic/5705.png)", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThe second line contains $n$ integers representing $a_i$.\n\nEach of the next $m$ lines contains three integers: either $opt$ $x$ $y$, or $opt$ $l$ $r$, representing an operation.", "outputFormat": "If it is possible, output \"damushen\".\n\nOtherwise, output \"yuanxing\".", "hint": "- For $30\\%$ of the testdata, $n, m \\le 500$.\n- For $60\\%$ of the testdata, $n, m \\le 100000$.\n- For $100\\%$ of the testdata, $n, m \\le 500000$.\n\nThe initial values have value range less than $2.5 \\times 10^7$. In update operations, $y \\le n$. At any time, all $a_i$ are guaranteed to be positive integers.\n\nTime limit: 2 s.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "由乃与大母神原型和偶像崇拜", "background": ":::info[题目背景]{open}\n ![](https://cdn.luogu.com.cn/upload/pic/5702.png) \n\n由乃最近没事干，去研究轻拍学去了\n\n就是一个叫做flip flappers，轻拍翻转小膜女的番\n\n ![](https://cdn.luogu.com.cn/upload/pic/5703.png) \n\n然后研究的过程中她看到了一个叫做大母神原型的东西\n\n大母神不仅是部落保护神，而且是部落间互相识别的标记（以后泛化为不同的图形符号、服饰和祭祀仪式），在部落联盟出现后，具有领导力的部落神祇，上升为整个联盟的共神，进而成为酋邦和王国的共神\n\n ![](https://cdn.luogu.com.cn/upload/pic/5709.png) \n\n大概就是说这个东西是母系社会时候的偶像，然后象征着母亲可以创造生命也可以毁灭生命什么什么的，分别是善母与恶母，既孕育一切，又吞噬一切\n\n然后我们熟知的神话里面就有大母神，比如女娲其实就是个大母神。。。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5716.png) \n\n原始部落时期的大母神既具有生育和哺乳的能力，也具有保护部落、带来丰收的神力。\n\n到了神话时期，大母神进一步分化，演变出形形色色的女神，分别象征了女性能量的不同面向：孕育女神、大地女神、爱与美女神、保护女神、战争女神、丰收女神、智慧女神、命运女神……\n\n这些是善母\n\n ![](https://cdn.luogu.com.cn/upload/pic/5717.png) \n\n世间的事物总是两面性的：一切生命诞生于土地，最终要回归土地；创造的必然也拥有毁灭的能力。大母神也同样具有痛苦、恐怖、吞噬和危险的一面。\n\n比如童话故事里面的女巫，其实就是大母神的另一面的体现，也就是恶母\n\n糖果屋的故事讲的就是韩赛尔和格雷特被继母赶出家里，因为没饭吃了，然后进了森林发现了一个糖果屋，里面有个女巫，专门吃小孩子\n\n然而如果我们仔细想想这个故事，会发现它没有那么简单\n\n比如说，女巫真的是吃小孩子吗？如果女巫是个善良的老婆婆，无偿救助在森林里面困住的小孩子呢？\n\n还有就是当韩赛尔和格雷特杀死了女巫，回到家中发现她们的继母也死了\n\n这是否意味着她们实际上杀死的是她们的继母？\n\n所以这个故事本质上讲的是她们杀了她们的母亲，也就是打败了大母神\n\n很多神话故事里面都有打败大母神的情节\n:::", "description": ":::info[无关内容]{open}\n\n ![](https://cdn.luogu.com.cn/upload/pic/5706.png) \n\n你看到这里也许已经觉得由乃精神不正常了\n\n然而由乃自从不小心##了自己的##后早就不正常了\n\n由乃研究了很久大母神原型，但是仍然一脸懵逼\n\n于是就出数据结构题骗钱去了\n\n由乃：给你一个序列，每次询问一个区间是否是值域连续段\n\nzzy：你把题意说详细点\n\n由乃：就是说不能有重复数字，比如1 2 2 3就不行，然后4 2 3 1就可以\n\nyql：sb分块\n\nddd：sb bitset\n\n由乃：woc你们好树链啊，我。。我带修\n\nzzq：#######sb题\n\n由乃：我就是要出原题\n\n ![](https://cdn.luogu.com.cn/upload/pic/5710.png) \n\n![](https://cdn.luogu.com.cn/upload/pic/5705.png)\n\n:::\n给你一个长为 $n$ 的序列 $a$。\n\n每次操作分为两种：\n\n1. 修改 $x$ 位置的值为 $y$。\n2. 查询区间 $[l,r]$ 是否可以重排为值域上连续的一段。", "inputFormat": "第一行两个数 $n,m$。\n\n第二行 $n$ 个数表示 $a_i$。\n\n后面 $m$ 行每行三个数 $opt,x,y$，或者 $opt,l,r$，代表操作。", "outputFormat": "如果可以，输出 `damushen`，否则输出 `yuanxing`。", "hint": "对于 $30\\%$ 的数据，$n,m \\le 500$。\n\n对于 $60\\%$ 的数据，$n,m \\le 10^5$。\n\n对于 $100\\%$ 的数据，$n,m \\le 5\\times 10^5$。\n\n初始值的值域小于 $2.5\\times 10^7$，修改操作的 $y$ 小于等于 $n$。保证在任意时刻所有 $a_i$ 均为正整数。\n\n2s", "locale": "zh-CN"}}}
{"pid": "P3793", "type": "P", "difficulty": 5, "samples": [["233 233 233", "243704637294"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["洛谷原创", "O2优化", "栈", "分块", "ST 表", "洛谷月赛", "笛卡尔树"], "title": "由乃救爷爷", "background": "大家看过葫芦娃吧？\n\n没看过也没关系，让由乃告诉你吧\n\n ![](https://cdn.luogu.com.cn/upload/pic/5725.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5740.png) \n\n传说明斯克航空航天局里关着两个坦克，strv103b和krv。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5733.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5722.png) \n\n鼠爷不小心打破了明斯克航空航天局，两个坦克逃了出来，从此其他坦克过上了水深火热的生活。\n\n明斯克航空航天局急忙去告诉一个叫做serb的光头，只有YY出七辆图纸车，才能消灭这两个卖头势力。\n\nserbYY出了七个连图纸都没有的车，却被瑞典人从bbs中窥见 。他们摧毁不了这七个YY车，\n\n就把serb和鼠爷抓去。但是这时候七个坦克模型已经建出来了。\n\n她们分别是 T28原型，T100lt，907工程，蟋蟀15，WZ111，FV215b183，FV215b\n\n她们为了消灭卖头势力，救出serb和鼠爷，一个接一个去与卖头势力搏斗。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5723.png) \n\nT28原是正面很硬的TD，但装甲在金币弹面前一点用都没有，直接被krv卖头打死。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5728.png) \n\nT100lt是隐蔽超好的眼车，却因为没有视野，被103b活活黑死。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5724.png) \n\n907工程是铁头，被krv顶牛直接抽包抽死。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5727.png) \n\n蟋蟀15会黑枪，却因为辣鸡的转向被krv绕死。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5729.png) \n\nWZ111有三百穿，被103b穿侧面一发爆了弹药架。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5730.png) \n\nFV215b183有183炮，103b和krv瑟瑟发抖，不敢打她，于是她解救了其他所有坦克。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5734.png) \n\n但是自己的兄弟FV215b因为瑞典人的诱惑，决定叛变（因为183OO大），TK了183一发，然后183着火烧死了，结果所有坦克都被103b和krv降服了。\n\n瑞典人把七个坦克还有鼠爷一起给serb，让serb做出两辆最强坦克加入瑞典阵营。serb用尽了他所有的脑洞，做出了两辆车E100WT和T-50-2\n\n ![](https://cdn.luogu.com.cn/upload/pic/5731.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5732.png) \n\nkrv和103b看到之后蛤蛤大笑\n\nkrv：E100WT，10mm的脸，不被HE糊死才怪\n\n103b：E100WT，灯塔般的隐蔽，不被黑死才怪\n\nkrv：T-50-2，这血量，我一炮就可以打死\n\n103b：T-50-2，看是你机动好还是我黑枪准\n\nserb：百运，胶水，让她们看看你们的厉害", "description": "故事还没讲完\n\nkrv骑坡卖头，却发现百运凭借优秀的精度炮炮打穿她的观察孔\n\nkrv慌了，跑去城市里面伸缩，被百运站桩撸死\n\nstrv103b跑去草后黑枪，看见胶水在肉侦，却发现自己根本打不中她，然后就被胶水点亮了，百运一梭子128的ARCR飞了过来\n\nstrv103b怂了，准备跑路了，但是还没等到自己切换回行走模式，胶水已经开始断她的腿了，被胶水断死\n\n\n瑞典车们高呼不可战胜，从此不敢嚣张了\n\n\n然后serb把百运和胶水加入了WOT\n\n从此\n其他坦克过上了更加水深火热的生活\n\n\n然而你又不玩WOT，这事情不管你什么事啊\n\n然而yql是大家的妹妹，所以这件事很重要：\n\n\nyql在AK曼哈顿OI，CTSC，APIO之后，开始研究数学题。\n\n由乃在挂了字符串OI，CTSC，APIO之后，开始研究大母神原型。\n\nyql出了个数学题，由乃画出了一个表示大母神的图腾。\n\n然后把这两个合成了一个题：\n\n\n然而由于未知原因那个题挂掉了。。。\n\n由乃想起来SCOI 2017 电子科技大学出了个卡常的rmq，然后发生了一件很有趣的事情\n\n就是一位姓王的同学凭借奇奇怪怪的常数优化怒草了那个题，还比标程块了233倍\n\n所以由乃也出了个卡常rmq，因为没题出了", "inputFormat": "给你一个随机数生成器\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\n读入三个数 $n,m,s$\n\n你需要 `srand(s)` 一下\n\n然后 $n$ 个数表示 $a_i$，这个直接调用 `read` 函数\n\n然后 $m$ 个询问，表示区间**最大值**，询问的区间是 $l = \\text{read()} \\bmod n + 1 , r = \\text{read()} \\bmod n + 1$，注意有可能 $l > r$", "outputFormat": "输出一个 `unsigned long long` 表示每次询问的答案的和", "hint": "| 测试点编号 | $n,m =$ | 时限 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $1000$ | 1s |\n| $3$ | $10^5$ | 1s |\n| $4$ | $5\\times10^5$ | 1s |\n| $5$ | $10^6$ | 1s |\n| $6$ | $10^7$ | 5s |\n| $7$ | $1.2 \\times 10^7$ | 5s |\n| $8$ | $1.5 \\times 10^7$ | 5s |\n| $9$ | $2 \\times 10^7$ | 5s |", "locale": "zh-CN", "translations": {"en": {"title": "Yuno Saves Grandpa", "background": "Has everyone watched Calabash Brothers?\n\nEven if you haven't, let Yuno tell you.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5725.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5740.png) \n\nLegend says the Minsk Aviation and Space Administration held two tanks in custody, strv103b and krv.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5733.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5722.png) \n\nMouse-ye accidentally broke the Minsk Aviation and Space Administration, and the two tanks escaped. From then on, other tanks lived in deep misery.\n\nThe Minsk Aviation and Space Administration hurried to tell a bald man named SerB that only by releasing seven \"YY\" blueprinted tanks could they eliminate these two hull-down forces.\n\nSerB \"YY\"-ed seven tanks without even blueprints, but they were peeped by the Swedes on the BBS. Unable to destroy these seven \"YY\" tanks, they captured SerB and Mouse-ye. However, by then the seven tank models had already been built.\n\nThey were T28 Prototype, T-100LT, Object 907, Grille 15, WZ-111, FV215b 183, and FV215b.\n\nTo eliminate the hull-down forces and rescue SerB and Mouse-ye, they fought the hull-down forces one by one.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5723.png) \n\nThe T28 Prototype has very tough frontal armor as a TD, but armor is useless against premium shells and was directly head-shot to death by krv in hull-down.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5728.png) \n\nThe T-100LT is an excellent stealth scout, but without view range, it was perma-sniped to death by 103b.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5724.png) \n\nObject 907 has an iron head, but got into a face-off with krv and was clipped to death.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5727.png) \n\nThe Grille 15 can snipe, but due to terrible traverse, it was circle-strafed to death by krv.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5729.png) \n\nThe WZ-111 has 300 mm pen, but 103b penned its side once and ammo-racked it.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5730.png) \n\nThe FV215b 183 has a 183 mm gun; 103b and krv trembled and dared not shoot her, so she rescued all the other tanks.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5734.png) \n\nHowever, her brother FV215b, tempted by the Swedes, decided to defect (because the 183 has \"OO\" big), TKed the 183 with one shot, and the 183 caught fire and burned to death. As a result, all tanks were subdued by 103b and krv.\n\nThe Swedes handed the seven tanks plus Mouse-ye to SerB, asking SerB to make the two strongest tanks to join the Swedish camp. SerB used all his wild ideas and made two tanks, E100WT and T-50-2.\n\n ![](https://cdn.luogu.com.cn/upload/pic/5731.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5732.png) \n\nkrv and 103b burst into loud laughter upon seeing them.\n\nkrv: E100WT, a 10 mm face; how can it not get smashed by HE?\n\n103b: E100WT, lighthouse-like camouflage; how can it not get bush-sniped?\n\nkrv: T-50-2, with that HP, I can one-shot it.\n\n103b: T-50-2, let's see if you're more mobile or my sniping is more accurate.\n\nSerB: Baiyun, Jiaoshui, show them what you can do.", "description": "The story isn't over yet.\n\nkrv went hull-down on a slope, only to find Baiyun (pinyin) penetrating her cupola shot after shot thanks to great accuracy.\n\nkrv panicked, ran into the city to peek-a-boo, and got mowed down by Baiyun trading shots stationary.\n\nstrv103b went to bush-camp, saw Jiaoshui (pinyin) doing active scouting, but found she simply couldn't hit her; then Jiaoshui lit her up, and Baiyun sent over a burst of 128 ARCR.\n\nstrv103b chickened out and tried to run, but before switching back to travel mode, Jiaoshui had already started tracking her, and she got permatracked to death by Jiaoshui.\n\nThe Swedish tanks shouted that they were invincible, and from then on did not dare to be arrogant.\n\nThen SerB added Baiyun and Jiaoshui to WOT.\n\nFrom then on, other tanks lived an even more miserable life.\n\nBut you don't play WOT—what does this have to do with you?\n\nHowever, yql is everyone's little sister, so this is important:\n\nAfter AK (full score) in Manhattan OI, CTSC, and APIO, yql started studying math problems.\n\nAfter failing string problems in OI, CTSC, and APIO, Yuno started researching the \"Great Mother Goddess\" prototype.\n\nyql made a math problem, and Yuno drew a totem representing the Great Mother Goddess.\n\nThen they combined these into one problem:\n\nBut for unknown reasons that problem failed...\n\nYuno remembered that in SCOI 2017 University of Electronic Science and Technology of China put out a constant-factor-tuned RMQ, and something interesting happened:\n\nA student surnamed Wang, relying on strange constant optimizations, demolished that problem and was 233 times faster than the official solution.\n\nSo Yuno also made a constant-factor-tuned RMQ, because there were no problems left to make.", "inputFormat": "You are given a random number generator:\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\nRead three numbers $n, m, s$.\n\nYou need to call `srand(s)`.\n\nThen there are $n$ numbers representing $a_i$, generated by directly calling the `read` function.\n\nThen there are $m$ queries asking for the range maximum. The query interval is $l = \\text{read()} \\bmod n + 1 , r = \\text{read()} \\bmod n + 1$. Note that it is possible that $l > r$.", "outputFormat": "Output a single `unsigned long long` representing the sum of the answers to all queries.", "hint": "| Test point ID | $n, m =$ | Time limit |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $1000$ | 1 s |\n| $3$ | $10^5$ | 1 s |\n| $4$ | $5\\times10^5$ | 1 s |\n| $5$ | $10^6$ | 1 s |\n| $6$ | $10^7$ | 5 s |\n| $7$ | $1.2 \\times 10^7$ | 5 s |\n| $8$ | $1.5 \\times 10^7$ | 5 s |\n| $9$ | $2 \\times 10^7$ | 5 s |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "由乃救爷爷", "background": "大家看过葫芦娃吧？\n\n没看过也没关系，让由乃告诉你吧\n\n ![](https://cdn.luogu.com.cn/upload/pic/5725.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5740.png) \n\n传说明斯克航空航天局里关着两个坦克，strv103b和krv。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5733.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5722.png) \n\n鼠爷不小心打破了明斯克航空航天局，两个坦克逃了出来，从此其他坦克过上了水深火热的生活。\n\n明斯克航空航天局急忙去告诉一个叫做serb的光头，只有YY出七辆图纸车，才能消灭这两个卖头势力。\n\nserbYY出了七个连图纸都没有的车，却被瑞典人从bbs中窥见 。他们摧毁不了这七个YY车，\n\n就把serb和鼠爷抓去。但是这时候七个坦克模型已经建出来了。\n\n她们分别是 T28原型，T100lt，907工程，蟋蟀15，WZ111，FV215b183，FV215b\n\n她们为了消灭卖头势力，救出serb和鼠爷，一个接一个去与卖头势力搏斗。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5723.png) \n\nT28原是正面很硬的TD，但装甲在金币弹面前一点用都没有，直接被krv卖头打死。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5728.png) \n\nT100lt是隐蔽超好的眼车，却因为没有视野，被103b活活黑死。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5724.png) \n\n907工程是铁头，被krv顶牛直接抽包抽死。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5727.png) \n\n蟋蟀15会黑枪，却因为辣鸡的转向被krv绕死。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5729.png) \n\nWZ111有三百穿，被103b穿侧面一发爆了弹药架。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5730.png) \n\nFV215b183有183炮，103b和krv瑟瑟发抖，不敢打她，于是她解救了其他所有坦克。\n\n ![](https://cdn.luogu.com.cn/upload/pic/5734.png) \n\n但是自己的兄弟FV215b因为瑞典人的诱惑，决定叛变（因为183OO大），TK了183一发，然后183着火烧死了，结果所有坦克都被103b和krv降服了。\n\n瑞典人把七个坦克还有鼠爷一起给serb，让serb做出两辆最强坦克加入瑞典阵营。serb用尽了他所有的脑洞，做出了两辆车E100WT和T-50-2\n\n ![](https://cdn.luogu.com.cn/upload/pic/5731.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/5732.png) \n\nkrv和103b看到之后蛤蛤大笑\n\nkrv：E100WT，10mm的脸，不被HE糊死才怪\n\n103b：E100WT，灯塔般的隐蔽，不被黑死才怪\n\nkrv：T-50-2，这血量，我一炮就可以打死\n\n103b：T-50-2，看是你机动好还是我黑枪准\n\nserb：百运，胶水，让她们看看你们的厉害", "description": "故事还没讲完\n\nkrv骑坡卖头，却发现百运凭借优秀的精度炮炮打穿她的观察孔\n\nkrv慌了，跑去城市里面伸缩，被百运站桩撸死\n\nstrv103b跑去草后黑枪，看见胶水在肉侦，却发现自己根本打不中她，然后就被胶水点亮了，百运一梭子128的ARCR飞了过来\n\nstrv103b怂了，准备跑路了，但是还没等到自己切换回行走模式，胶水已经开始断她的腿了，被胶水断死\n\n\n瑞典车们高呼不可战胜，从此不敢嚣张了\n\n\n然后serb把百运和胶水加入了WOT\n\n从此\n其他坦克过上了更加水深火热的生活\n\n\n然而你又不玩WOT，这事情不管你什么事啊\n\n然而yql是大家的妹妹，所以这件事很重要：\n\n\nyql在AK曼哈顿OI，CTSC，APIO之后，开始研究数学题。\n\n由乃在挂了字符串OI，CTSC，APIO之后，开始研究大母神原型。\n\nyql出了个数学题，由乃画出了一个表示大母神的图腾。\n\n然后把这两个合成了一个题：\n\n\n然而由于未知原因那个题挂掉了。。。\n\n由乃想起来SCOI 2017 电子科技大学出了个卡常的rmq，然后发生了一件很有趣的事情\n\n就是一位姓王的同学凭借奇奇怪怪的常数优化怒草了那个题，还比标程块了233倍\n\n所以由乃也出了个卡常rmq，因为没题出了", "inputFormat": "给你一个随机数生成器\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\n读入三个数 $n,m,s$\n\n你需要 `srand(s)` 一下\n\n然后 $n$ 个数表示 $a_i$，这个直接调用 `read` 函数\n\n然后 $m$ 个询问，表示区间**最大值**，询问的区间是 $l = \\text{read()} \\bmod n + 1 , r = \\text{read()} \\bmod n + 1$，注意有可能 $l > r$", "outputFormat": "输出一个 `unsigned long long` 表示每次询问的答案的和", "hint": "| 测试点编号 | $n,m =$ | 时限 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $1000$ | 1s |\n| $3$ | $10^5$ | 1s |\n| $4$ | $5\\times10^5$ | 1s |\n| $5$ | $10^6$ | 1s |\n| $6$ | $10^7$ | 5s |\n| $7$ | $1.2 \\times 10^7$ | 5s |\n| $8$ | $1.5 \\times 10^7$ | 5s |\n| $9$ | $2 \\times 10^7$ | 5s |", "locale": "zh-CN"}}}
{"pid": "P3794", "type": "P", "difficulty": 5, "samples": [["5 6\n2 4 3 4 2", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "洛谷原创", "O2优化", "枚举", "进制", "ST 表", "洛谷月赛"], "title": "签到题IV", "background": "这场月赛好像其他题背景都很长，这题就不写背景了。![](https://cdn.luogu.com.cn/upload/pic/1436.png)", "description": "给定一个长度为 $n$ 的序列 $[a_1,a_2\\cdots a_n]$，其中每个数都是正整数。\n\n\n你需要找出有多少对 $(i,j)$，$1 \\leq i \\leq j \\leq n$ 且 $\\gcd(a_i,a_{i+1}...a_j) \\operatorname{xor} (a_i \\operatorname{or} a_{i+1} \\operatorname{or} \\cdots \\operatorname{or} a_j)=k$，其中 $\\operatorname{xor}$ 表示二进制异或，$\\operatorname{or}$ 表示二进制或。", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行 $n$ 个整数 $a_1,a_2\\cdots a_n$。", "outputFormat": "输出合法的 $(i,j)$ 的对数。", "hint": "- 对于 $30\\%$ 的数据，$n \\leq 500$。\n- 对于 $60\\%$ 的数据，$n \\leq 100000$。\n- 对于 $100\\%$ 的数据，$1 \\leq n,a_i \\leq 500000$。", "locale": "zh-CN", "translations": {"en": {"title": "Check-in Problem IV", "background": "It seems the other problems in this monthly contest have long backgrounds, so this one will skip the background. ![](https://cdn.luogu.com.cn/upload/pic/1436.png)", "description": "Given a sequence of length $n$, $[a_1, a_2, \\ldots, a_n]$, where each number is a positive integer.\n\nYou need to find how many pairs $(i, j)$ satisfy $1 \\le i \\le j \\le n$ and $\\gcd(a_i, a_{i+1}, \\ldots, a_j) \\operatorname{xor} (a_i \\operatorname{or} a_{i+1} \\operatorname{or} \\cdots \\operatorname{or} a_j) = k$, where $\\operatorname{xor}$ denotes bitwise XOR and $\\operatorname{or}$ denotes bitwise OR.", "inputFormat": "The first line contains two integers $n$ and $k$.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$.", "outputFormat": "Output the number of valid pairs $(i, j)$.", "hint": "- For $30\\%$ of the testdata, $n \\le 500$.\n- For $60\\%$ of the testdata, $n \\le 100000$.\n- For $100\\%$ of the testdata, $1 \\le n, a_i \\le 500000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "签到题IV", "background": "这场月赛好像其他题背景都很长，这题就不写背景了。![](https://cdn.luogu.com.cn/upload/pic/1436.png)", "description": "给定一个长度为 $n$ 的序列 $[a_1,a_2\\cdots a_n]$，其中每个数都是正整数。\n\n\n你需要找出有多少对 $(i,j)$，$1 \\leq i \\leq j \\leq n$ 且 $\\gcd(a_i,a_{i+1}...a_j) \\operatorname{xor} (a_i \\operatorname{or} a_{i+1} \\operatorname{or} \\cdots \\operatorname{or} a_j)=k$，其中 $\\operatorname{xor}$ 表示二进制异或，$\\operatorname{or}$ 表示二进制或。", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行 $n$ 个整数 $a_1,a_2\\cdots a_n$。", "outputFormat": "输出合法的 $(i,j)$ 的对数。", "hint": "- 对于 $30\\%$ 的数据，$n \\leq 500$。\n- 对于 $60\\%$ 的数据，$n \\leq 100000$。\n- 对于 $100\\%$ 的数据，$1 \\leq n,a_i \\leq 500000$。", "locale": "zh-CN"}}}
{"pid": "P3795", "type": "P", "difficulty": 3, "samples": [["3\n", "4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480]}, "tags": ["动态规划 DP", "搜索", "数学", "递推"], "title": "钟氏映射", "background": "2233年，CSSYZ学校的数学老师兼数学竞赛顾问钟JG已经2200+岁啦！\n\n为了庆生，他或她给广大人民群众出了道题。\n", "description": "设集合$N=M=\\left\\{x|x\\in N_+,x\\leq k,k\\in N_+\\right\\}$\n\n设$f$为$N$到$M$的映射。\n\n求满足：\n\n$f[f(x)]=x$的不同的映射$f$的个数，由于答案较大，输出答案对$14233333$取余的数即可。\n", "inputFormat": "输入一个正整数$k$\n", "outputFormat": "输出满足$f[f(x)]=x$的不同的映射$f$的个数对$14233333$取余得到的数。\n", "hint": "四个映射分别为：\n\n\n|f(1)|f(2)|f(3)|\n|-|-|-|\n|1|2|3|\n|1|3|2|\n|2|1|3|\n|3|2|1|\n\n数据范围：\n\n对于20%的数据，$1\\leq k\\leq 9$\n\n对于其它的80%的数据，$1\\leq k\\leq 10^7$\n\n\n内存20MB...（一开始开1MB把自己坑了）\n", "locale": "zh-CN", "translations": {"en": {"title": "Zhong's Mapping", "background": "In the year 2233, the math teacher and math contest advisor Zhong JG at CSSYZ School is already over 2200 years old. To celebrate the birthday, they gave a problem to the public.", "description": "Let $N = M = \\left\\{x|x\\in N_+,x\\leq k,k\\in N_+\\right\\}$. Let $f$ be a mapping from $N$ to $M$. Count the number of distinct mappings $f$ that satisfy $f(f(x)) = x$. Since the answer may be large, output the result modulo $14233333$.", "inputFormat": "A single positive integer $k$.", "outputFormat": "Output the number of distinct mappings $f$ satisfying $f(f(x)) = x$, modulo $14233333$.", "hint": "For $k = 3$, the four mappings are:\n\n| f(1) | f(2) | f(3) |\n|-|-|-|\n| 1 | 2 | 3 |\n| 1 | 3 | 2 |\n| 2 | 1 | 3 |\n| 3 | 2 | 1 |\n\nConstraints:\n\n- For 20% of the testdata, $1 \\leq k \\leq 9$.\n- For the other 80% of the testdata, $1 \\leq k \\leq 10^7$.\n\nMemory 20 MB... (I initially set 1 MB and got myself into trouble).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "钟氏映射", "background": "2233年，CSSYZ学校的数学老师兼数学竞赛顾问钟JG已经2200+岁啦！\n\n为了庆生，他或她给广大人民群众出了道题。\n", "description": "设集合$N=M=\\left\\{x|x\\in N_+,x\\leq k,k\\in N_+\\right\\}$\n\n设$f$为$N$到$M$的映射。\n\n求满足：\n\n$f[f(x)]=x$的不同的映射$f$的个数，由于答案较大，输出答案对$14233333$取余的数即可。\n", "inputFormat": "输入一个正整数$k$\n", "outputFormat": "输出满足$f[f(x)]=x$的不同的映射$f$的个数对$14233333$取余得到的数。\n", "hint": "四个映射分别为：\n\n\n|f(1)|f(2)|f(3)|\n|-|-|-|\n|1|2|3|\n|1|3|2|\n|2|1|3|\n|3|2|1|\n\n数据范围：\n\n对于20%的数据，$1\\leq k\\leq 9$\n\n对于其它的80%的数据，$1\\leq k\\leq 10^7$\n\n\n内存20MB...（一开始开1MB把自己坑了）\n", "locale": "zh-CN"}}}
