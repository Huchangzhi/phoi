{"pid": "P6055", "type": "P", "difficulty": 6, "samples": [["50\n", "104527\n"], ["200\n", "6664993\n"], ["500000\n", "835964450\n"], ["10000000\n", "503290049"], ["100000000", "712748411\n"], ["1000000000", "845640070\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "杜教筛"], "title": "[RC-02] GCD", "background": "小 A：数论题真是无聊呢，一天到晚枚举二元组、三元组，太无聊了。\n\n小 B：对呀对呀，都是套路。\n\n小 A：要不我们试试枚举四元组？\n\n小 B：......\n\n于是就有了这道题。\n", "description": "给出 $N$，求：\n\n$$\n\\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(i,j)=1][\\gcd(p,q)=1]\n$$\n\n答案模 $998244353$。\n\n$[]$ 是条件表达式。当括号里面的式子成立时值为 $1$，否则为 $0$。", "inputFormat": "仅一行一个整数，为 $N$。", "outputFormat": "输出一个整数，为所求答案模上 $998244353$ 的值。", "hint": "对于所有数据，保证 $1\\le N\\le 2\\times10^9$，所有测试点的时限均为 $1\\text{s}$，空间限制均为 $500\\text{MB}$。\n\n| 测试点编号 | $N$               |\n| ---------- | ----------------- |\n| $1$          | $\\le 100$         |\n| $2$          | $\\le 400$         |\n| $3,4,5,6$ | $\\le10^6$ |\n| $7,8$       | $\\le 2\\times10^7$ |\n| $9$          | $\\le 2\\times10^8$ |\n| $10$         | $\\le 2\\times10^9$ |\n\n这题其实可以搞一个测试点多组数据，但良心的出题人为了多给你们一点部分分，就决定只来一组数据。\n\nidea 源自 @Fee_cle6418，题目的题面，标算，数据源自 @FangZeLi。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RC-02] GCD", "background": "小 A：数论题真是无聊呢，一天到晚枚举二元组、三元组，太无聊了。\n\n小 B：对呀对呀，都是套路。\n\n小 A：要不我们试试枚举四元组？\n\n小 B：......\n\n于是就有了这道题。\n", "description": "给出 $N$，求：\n\n$$\n\\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(i,j)=1][\\gcd(p,q)=1]\n$$\n\n答案模 $998244353$。\n\n$[]$ 是条件表达式。当括号里面的式子成立时值为 $1$，否则为 $0$。", "inputFormat": "仅一行一个整数，为 $N$。", "outputFormat": "输出一个整数，为所求答案模上 $998244353$ 的值。", "hint": "对于所有数据，保证 $1\\le N\\le 2\\times10^9$，所有测试点的时限均为 $1\\text{s}$，空间限制均为 $500\\text{MB}$。\n\n| 测试点编号 | $N$               |\n| ---------- | ----------------- |\n| $1$          | $\\le 100$         |\n| $2$          | $\\le 400$         |\n| $3,4,5,6$ | $\\le10^6$ |\n| $7,8$       | $\\le 2\\times10^7$ |\n| $9$          | $\\le 2\\times10^8$ |\n| $10$         | $\\le 2\\times10^9$ |\n\n这题其实可以搞一个测试点多组数据，但良心的出题人为了多给你们一点部分分，就决定只来一组数据。\n\nidea 源自 @Fee_cle6418，题目的题面，标算，数据源自 @FangZeLi。", "locale": "zh-CN"}}}
{"pid": "P6056", "type": "P", "difficulty": 1, "samples": [["980 20 2\n0.0005 0.00001", "955 43 2"], ["1400000000 1 10\n0.000000003 0.001", "1386791252 13205592 3157"], ["1919 810 1\n0.00001 0.1", "1903 745 81"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷月赛"], "title": "[加油武汉] SIR 模型", "background": "SIR 模型将总人口分为以下三类：\n\n- 易感者（susceptibles），其数量记为 $s(t)$，表示 $t$ 时刻未染病但有可能被该类疾病传染的人数；\n- 染病者（infectives），其数量记为 $i(t)$，表示 $t$ 时刻已被感染成为病人而且具有传染力的人数；\n- 恢复者（recovered），其数量记为 $r(t)$，表示 $t$ 时刻已从染病者中移出的人数。\n\n设总人口为 $N(t)$，则有 $N(t)=s(t)+i(t)+r(t)$。  \n\nSIR 模型的建立基于以下三个假设：  \n\n1. 不考虑人口的出生、死亡、流动等种群动力因素。人口始终保持一个常数，即 $N(t) \\equiv K$。  \n2. 一个病人一旦与易感者接触就必然具有一定的传染力。假设 $t$ 时刻单位时间内，一个病人能传染的易感者数目与此环境内易感者总数 $s(t)$ 成正比，比例系数为 $\\beta$，从而在 $t$ 时刻单位时间内被所有病人传染的人数为 $\\beta s(t)i(t)$。  \n3. $t$ 时刻，单位时间内从染病者中移出的人数与病人数量成正比，比例系数为 $\\gamma$，单位时间内移出者的数量为 $\\gamma i(t)$。", "description": "我们将这个模型简化一下，初始有感染者 $I$ 人和易感者 $S$ 人，对于每一天当前有 $I_i$ 个感染者、$S_i$ 个易感者、$R_i$ 个恢复者，则每天会有 $\\lceil \\beta S_iI_i \\rceil$ 人被感染（由易感者变成感染者），有 $\\lceil \\gamma I_i \\rceil$ 人被治愈（由感染者变成恢复者） 。\n\n其中 $\\beta$ 为感染系数，$\\gamma$ 为恢复系数，$\\lceil \\rceil$ 为向上取整符号。 \n\n求 $n$ 天后，有多少易感者 $S$，感染者 $I$，和恢复者 $R$ 。\n\n注：感染者和恢复者都是每天结算的，结算的结果只和当天开始的时候的值有关，即感染者当天恢复不影响他当天感染别人。\n\n若计算被感染人数超过易感者人数则全员被感染。", "inputFormat": "第一行三个正整数，分别表示第 $0$ 天易感者人数 $S_0$ 和感染者人数 $I_0$，以及天数 $n$（刚开始恢复者数 $R_0=0$）。\n\n第二行两个浮点数，分别表示感染系数 $\\beta$ 和恢复系数 $\\gamma$。", "outputFormat": "一行三个整数，分别表示 $n$ 天后的易感者人数 $S$ 、感染者人数 $I$ 和恢复者 $R$。", "hint": "对于 $30\\%$ 的数据，$n=1$。  \n对于另外 $30\\%$ 的数据，$S_0, R_0\\le 10^4$。  \n对于 $100\\%$ 的数据，$1 \\le S_0+R_0\\le 2\\times 10^9, 0 < \\beta, \\gamma < 1, 1 \\le n \\le 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] SIR 模型", "background": "SIR 模型将总人口分为以下三类：\n\n- 易感者（susceptibles），其数量记为 $s(t)$，表示 $t$ 时刻未染病但有可能被该类疾病传染的人数；\n- 染病者（infectives），其数量记为 $i(t)$，表示 $t$ 时刻已被感染成为病人而且具有传染力的人数；\n- 恢复者（recovered），其数量记为 $r(t)$，表示 $t$ 时刻已从染病者中移出的人数。\n\n设总人口为 $N(t)$，则有 $N(t)=s(t)+i(t)+r(t)$。  \n\nSIR 模型的建立基于以下三个假设：  \n\n1. 不考虑人口的出生、死亡、流动等种群动力因素。人口始终保持一个常数，即 $N(t) \\equiv K$。  \n2. 一个病人一旦与易感者接触就必然具有一定的传染力。假设 $t$ 时刻单位时间内，一个病人能传染的易感者数目与此环境内易感者总数 $s(t)$ 成正比，比例系数为 $\\beta$，从而在 $t$ 时刻单位时间内被所有病人传染的人数为 $\\beta s(t)i(t)$。  \n3. $t$ 时刻，单位时间内从染病者中移出的人数与病人数量成正比，比例系数为 $\\gamma$，单位时间内移出者的数量为 $\\gamma i(t)$。", "description": "我们将这个模型简化一下，初始有感染者 $I$ 人和易感者 $S$ 人，对于每一天当前有 $I_i$ 个感染者、$S_i$ 个易感者、$R_i$ 个恢复者，则每天会有 $\\lceil \\beta S_iI_i \\rceil$ 人被感染（由易感者变成感染者），有 $\\lceil \\gamma I_i \\rceil$ 人被治愈（由感染者变成恢复者） 。\n\n其中 $\\beta$ 为感染系数，$\\gamma$ 为恢复系数，$\\lceil \\rceil$ 为向上取整符号。 \n\n求 $n$ 天后，有多少易感者 $S$，感染者 $I$，和恢复者 $R$ 。\n\n注：感染者和恢复者都是每天结算的，结算的结果只和当天开始的时候的值有关，即感染者当天恢复不影响他当天感染别人。\n\n若计算被感染人数超过易感者人数则全员被感染。", "inputFormat": "第一行三个正整数，分别表示第 $0$ 天易感者人数 $S_0$ 和感染者人数 $I_0$，以及天数 $n$（刚开始恢复者数 $R_0=0$）。\n\n第二行两个浮点数，分别表示感染系数 $\\beta$ 和恢复系数 $\\gamma$。", "outputFormat": "一行三个整数，分别表示 $n$ 天后的易感者人数 $S$ 、感染者人数 $I$ 和恢复者 $R$。", "hint": "对于 $30\\%$ 的数据，$n=1$。  \n对于另外 $30\\%$ 的数据，$S_0, R_0\\le 10^4$。  \n对于 $100\\%$ 的数据，$1 \\le S_0+R_0\\le 2\\times 10^9, 0 < \\beta, \\gamma < 1, 1 \\le n \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P6057", "type": "P", "difficulty": 4, "samples": [["5 3\n1 5\n2 5\n3 5", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["组合数学", "洛谷月赛"], "title": "[加油武汉] 七步洗手法", "background": "现在正处于疫情防控的关键时期，大家要经常洗手，防止接触感染。\n\n[正确的洗手方法](https://dxy.com/column/4473)", "description": "给定一张含有 $n$ 个点的无向完全图，其中 $m$ 条边是白边，其余是黑边。\n\n现在需要你求出同色的三元环（或者说，三角形）的个数。", "inputFormat": "第一行整数 $n,m$，意义如题。\n\n剩下的 $m$ 行每行两个整数 $u,v$，代表白边的两个端点。保证给出的白边没有重边和自环。", "outputFormat": "一行一个整数，为答案。", "hint": " - 对于 $20\\%$ 的数据，满足 $n \\leq 200$；\n - 对于 $50\\%$ 的数据，满足 $n \\leq 2000$；\n - 对于 $100\\%$ 的数据，满足 $1 \\leq n \\leq 10^5,1 \\leq m \\leq 3\\times 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] 七步洗手法", "background": "现在正处于疫情防控的关键时期，大家要经常洗手，防止接触感染。\n\n[正确的洗手方法](https://dxy.com/column/4473)", "description": "给定一张含有 $n$ 个点的无向完全图，其中 $m$ 条边是白边，其余是黑边。\n\n现在需要你求出同色的三元环（或者说，三角形）的个数。", "inputFormat": "第一行整数 $n,m$，意义如题。\n\n剩下的 $m$ 行每行两个整数 $u,v$，代表白边的两个端点。保证给出的白边没有重边和自环。", "outputFormat": "一行一个整数，为答案。", "hint": " - 对于 $20\\%$ 的数据，满足 $n \\leq 200$；\n - 对于 $50\\%$ 的数据，满足 $n \\leq 2000$；\n - 对于 $100\\%$ 的数据，满足 $1 \\leq n \\leq 10^5,1 \\leq m \\leq 3\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P6058", "type": "P", "difficulty": 4, "samples": [["11 2\n1 2 2\n1 3 3\n2 4 1\n3 5 2\n4 6 2\n4 7 3\n5 8 1\n6 9 3\n6 10 25\n8 11 4\n", "66"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["二分", "最近公共祖先 LCA", "洛谷月赛"], "title": "[加油武汉] 体温调查", "background": "在疫情扩散后，疾控中心的医护人员对来自武汉的人员进行了家庭访问，对体温进行测量。医护人员从疾控中心出发，按照一定顺序对所有家庭进行访问，然后汇总数据。 \n\n家庭列表上记录着类似于`A街道B小区C号楼D户`一样的住址，按照字典顺序排列，因此每个区域中的家庭在列表中总是相邻的。医护人员在访问完某个区域（比如B1小区）的所有家庭后，需要将数据送至上一层（比如A街道）的管理机构中，然后继续访问（比如B2小区）中的家庭。\n\n也就是说，医护人员的移动路径类似一颗**树**，其中树根代表疾控中心，树叶代表家庭，而中间的结点代表一层一层的管理区域。结点的孩子代表下一层的区域（或者家庭），是有序的。从根到某个家庭的路径上所有的点正好组成了这个家庭的地址。 \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6zfh4ofj.png)\n\n如图，4家的地址分别为（按顺序）\n- A1-B1-C1-Z1\n- A1-B1-C1-Z2\n- A1-B1-Z3\n- A2-B2-C3-Z4\n\n箭头仅代表归属关系，所有路均可双向通行。\n\n本质上，题目给出的树就是住址构成的 **字典树**/**Trie树** 。", "description": "给出一颗树，根结点编号为$1$。有一名医护人员从根出发，沿着树边移动，去每个叶子采集信息，最后返回根。他的采集顺序是固定的，每当走到一个结点$u$，他会先走向编号最小的孩子，并访问完其中所有的家庭并回到$u$，然后再走向编号第二小的孩子，依此直到访问完$u$子树中所有的家庭返回上一层。可以发现访问叶子的顺序也正好是家庭住址列表上的顺序。\n\n沿着树边移动需要一定时间，为了节约时间，可以将家庭列表分成连续的$k$段，并让$k$个医护人员同时从根出发，每人访问一个区间中的家庭然后返回。请你计算出统计完所有家庭的体温所需要的最短时间。", "inputFormat": "第一行两个整数$n, k$，分别表示树中的结点数和医护人员数。\n\n接下来$n-1$行，每行三个整数$u, v, w$，表示一条从$u$到$v$，经过花费时间$w$的边。", "outputFormat": "一行一个整数，表示统计完所有家庭的最短时间。", "hint": "对 $30\\%$ 的数据，$1 \\le n \\le 20$\n\n对另外 $10 \\%$ 的数据，$k = 1$\n\n对另外 $20 \\%$ 的数据，$k = 2$\n\n对 $100\\%$ 的数据，$1 \\le n \\le 2*10^5, 1 \\le k \\le m, 1 \\le u, v \\le n, 0 \\le w \\le 10^9$，$m$为叶子数。\n\n### 样例说明\n图示见题目背景。\n\n第一个人的路径为RT->Z1->Z2->RT，耗时66。\n\n第二个人的路径为RT->Z3->Z4->RT，耗时32。\n\n让一个人访问Z2，另一个人访问Z1、Z3、Z4的方案是不合法的。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] 体温调查", "background": "在疫情扩散后，疾控中心的医护人员对来自武汉的人员进行了家庭访问，对体温进行测量。医护人员从疾控中心出发，按照一定顺序对所有家庭进行访问，然后汇总数据。 \n\n家庭列表上记录着类似于`A街道B小区C号楼D户`一样的住址，按照字典顺序排列，因此每个区域中的家庭在列表中总是相邻的。医护人员在访问完某个区域（比如B1小区）的所有家庭后，需要将数据送至上一层（比如A街道）的管理机构中，然后继续访问（比如B2小区）中的家庭。\n\n也就是说，医护人员的移动路径类似一颗**树**，其中树根代表疾控中心，树叶代表家庭，而中间的结点代表一层一层的管理区域。结点的孩子代表下一层的区域（或者家庭），是有序的。从根到某个家庭的路径上所有的点正好组成了这个家庭的地址。 \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6zfh4ofj.png)\n\n如图，4家的地址分别为（按顺序）\n- A1-B1-C1-Z1\n- A1-B1-C1-Z2\n- A1-B1-Z3\n- A2-B2-C3-Z4\n\n箭头仅代表归属关系，所有路均可双向通行。\n\n本质上，题目给出的树就是住址构成的 **字典树**/**Trie树** 。", "description": "给出一颗树，根结点编号为$1$。有一名医护人员从根出发，沿着树边移动，去每个叶子采集信息，最后返回根。他的采集顺序是固定的，每当走到一个结点$u$，他会先走向编号最小的孩子，并访问完其中所有的家庭并回到$u$，然后再走向编号第二小的孩子，依此直到访问完$u$子树中所有的家庭返回上一层。可以发现访问叶子的顺序也正好是家庭住址列表上的顺序。\n\n沿着树边移动需要一定时间，为了节约时间，可以将家庭列表分成连续的$k$段，并让$k$个医护人员同时从根出发，每人访问一个区间中的家庭然后返回。请你计算出统计完所有家庭的体温所需要的最短时间。", "inputFormat": "第一行两个整数$n, k$，分别表示树中的结点数和医护人员数。\n\n接下来$n-1$行，每行三个整数$u, v, w$，表示一条从$u$到$v$，经过花费时间$w$的边。", "outputFormat": "一行一个整数，表示统计完所有家庭的最短时间。", "hint": "对 $30\\%$ 的数据，$1 \\le n \\le 20$\n\n对另外 $10 \\%$ 的数据，$k = 1$\n\n对另外 $20 \\%$ 的数据，$k = 2$\n\n对 $100\\%$ 的数据，$1 \\le n \\le 2*10^5, 1 \\le k \\le m, 1 \\le u, v \\le n, 0 \\le w \\le 10^9$，$m$为叶子数。\n\n### 样例说明\n图示见题目背景。\n\n第一个人的路径为RT->Z1->Z2->RT，耗时66。\n\n第二个人的路径为RT->Z3->Z4->RT，耗时32。\n\n让一个人访问Z2，另一个人访问Z1、Z3、Z4的方案是不合法的。", "locale": "zh-CN"}}}
{"pid": "P6059", "type": "P", "difficulty": 5, "samples": [["5\n1 2 3 4 5", "698771051 399297745 349385527 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "洛谷月赛"], "title": "[加油武汉] 居家隔离", "background": "为了防止感染，大家要自觉做到居家隔离，少外出少与外人接触。", "description": "居家久了，你需要给自己找点娱乐。于是你看到这么一个游戏：\n给定一个 $n$ 元集合 $ \\{a_1,a_2,a_3....a_n \\}$，元素各不相同。\n\n游戏总共会进行 $n$ 轮，每轮系统会从集合中随机挑出一个元素，记作 $x$。你可以有如下两种选择：\n\n1. 取走 $x$，那么 $x$ 将会是你的最终得分。\n2. 舍弃 $x$，此时 $x$ 将会永久的从这个集合中删去，并且进入下一轮。\n\n请注意，若是集合中仅剩唯一一个元素时，该元素无法被舍弃。\n\n由于你很懒，所以你指定了一个很咸鱼的策略：\n\n对于前 $k$ 轮，将得到的数全部舍弃，并且记录下得到的数中的最大值，记作 $y$。\n\n在第 $k$ 轮之后，执行如下策略：\n\n若是取得的 $x > y$，则直接取走 $x$。反之不断舍弃，直到找到了一个满足要求的 $x$ 或是仅剩一个元素。\n\n现在你希望知道，对于 $1$ 到 $n-1$ 的每一个 $k$，你期望下的得分是多少。\n\n所有数请对 $998244353$ 取模。", "inputFormat": "第一行一个整数 $n$，表示集合中元素个数。\n\n第二行共 $n$ 个整数，描述集合中的每一个元素。", "outputFormat": "一行，总共 $n-1$ 个数，第 $i$ 个数表示当 $k=i$ 时，期望得分。\n\n设答案化为最简分式后的形式为 $\\frac{a}{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx\\equiv a \\pmod{998244353}$ 且 $0\\leq x < 998244353$。可以证明这样的整数 $x$ 是唯一的。", "hint": "**样例解释**\n\n答案输出的四个数应该分别是 $\\frac{39}{10}, \\frac{19}{5} ,\\frac{69}{20}, 3$，但在模意义下除以一个数相当于乘这个数在模意义下的逆元，因此输出为这些数。举例来说 $\\frac{39}{10}\\equiv 39\\cdot 10^{-1}\\equiv 39\\cdot 299473306\\equiv 698771051\\pmod{998244353}$。\n\n提示：如果你不知道如何对一个分数取余，请点这里：<https://www.luogu.com.cn/problem/P2613>\n\n\n - 对于 $40\\%$ 的数据，满足 $2 \\leq n \\leq 10$；\n - 对于 $60\\%$ 的数据，满足集合为 $[1,n]$ 中所有正整数；\n - 对于 $100\\%$ 的数据，满足 $2 \\leq n \\leq 1000$，集合中所有数字不超过 $10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Cheer Up Wuhan] Home Quarantine", "background": "To prevent infection, everyone should consciously stay in home quarantine, go out less, and have less contact with outsiders.", "description": "After staying at home for a long time, you need to find some entertainment. Then you see the following game:\n\nYou are given a set with $n$ elements $\\{a_1,a_2,a_3....a_n\\}$, and all elements are distinct.\n\nThe game consists of $n$ rounds in total. In each round, the system randomly picks an element from the set, denoted as $x$. You have two choices:\n\n1. Take $x$, then $x$ will be your final score.\n2. Discard $x$. In this case, $x$ will be permanently removed from the set, and the game proceeds to the next round.\n\nNote that if there is only one element left in the set, that element cannot be discarded.\n\nSince you are lazy, you choose a very “slacker” strategy:\n\nFor the first $k$ rounds, discard all numbers you get, and record the maximum among them, denoted as $y$.\n\nAfter round $k$, use the following strategy:\n\nIf the obtained $x > y$, take $x$ immediately. Otherwise, keep discarding until you find an $x$ that satisfies the condition, or until only one element remains.\n\nNow you want to know, for each $k$ from $1$ to $n-1$, what your expected score is.\n\nAll numbers should be taken modulo $998244353$.", "inputFormat": "The first line contains an integer $n$, the number of elements in the set.\n\nThe second line contains $n$ integers, describing each element in the set.", "outputFormat": "Output one line with $n-1$ numbers in total. The $i$-th number represents the expected score when $k=i$.\n\nLet the answer in lowest terms be $\\frac{a}{b}$, where $a$ and $b$ are coprime. Output the integer $x$ such that $bx\\equiv a \\pmod{998244353}$ and $0\\leq x < 998244353$. It can be proven that such an integer $x$ is unique.", "hint": "**Sample Explanation**\n\nThe four numbers that should be output are $\\frac{39}{10}, \\frac{19}{5} ,\\frac{69}{20}, 3$, but under modulo arithmetic, dividing by a number is equivalent to multiplying by its modular inverse, so the output is these values modulo $998244353$. For example, $\\frac{39}{10}\\equiv 39\\cdot 10^{-1}\\equiv 39\\cdot 299473306\\equiv 698771051\\pmod{998244353}$.\n\nHint: If you do not know how to take a fraction modulo a number, click here: <https://www.luogu.com.cn/problem/P2613>.\n\n- For $40\\%$ of the testdata, $2 \\leq n \\leq 10$.\n- For $60\\%$ of the testdata, the set is all positive integers in $[1,n]$.\n- For $100\\%$ of the testdata, $2 \\leq n \\leq 1000$, and all numbers in the set are at most $10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[加油武汉] 居家隔离", "background": "为了防止感染，大家要自觉做到居家隔离，少外出少与外人接触。", "description": "居家久了，你需要给自己找点娱乐。于是你看到这么一个游戏：\n给定一个 $n$ 元集合 $ \\{a_1,a_2,a_3....a_n \\}$，元素各不相同。\n\n游戏总共会进行 $n$ 轮，每轮系统会从集合中随机挑出一个元素，记作 $x$。你可以有如下两种选择：\n\n1. 取走 $x$，那么 $x$ 将会是你的最终得分。\n2. 舍弃 $x$，此时 $x$ 将会永久的从这个集合中删去，并且进入下一轮。\n\n请注意，若是集合中仅剩唯一一个元素时，该元素无法被舍弃。\n\n由于你很懒，所以你指定了一个很咸鱼的策略：\n\n对于前 $k$ 轮，将得到的数全部舍弃，并且记录下得到的数中的最大值，记作 $y$。\n\n在第 $k$ 轮之后，执行如下策略：\n\n若是取得的 $x > y$，则直接取走 $x$。反之不断舍弃，直到找到了一个满足要求的 $x$ 或是仅剩一个元素。\n\n现在你希望知道，对于 $1$ 到 $n-1$ 的每一个 $k$，你期望下的得分是多少。\n\n所有数请对 $998244353$ 取模。", "inputFormat": "第一行一个整数 $n$，表示集合中元素个数。\n\n第二行共 $n$ 个整数，描述集合中的每一个元素。", "outputFormat": "一行，总共 $n-1$ 个数，第 $i$ 个数表示当 $k=i$ 时，期望得分。\n\n设答案化为最简分式后的形式为 $\\frac{a}{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx\\equiv a \\pmod{998244353}$ 且 $0\\leq x < 998244353$。可以证明这样的整数 $x$ 是唯一的。", "hint": "**样例解释**\n\n答案输出的四个数应该分别是 $\\frac{39}{10}, \\frac{19}{5} ,\\frac{69}{20}, 3$，但在模意义下除以一个数相当于乘这个数在模意义下的逆元，因此输出为这些数。举例来说 $\\frac{39}{10}\\equiv 39\\cdot 10^{-1}\\equiv 39\\cdot 299473306\\equiv 698771051\\pmod{998244353}$。\n\n提示：如果你不知道如何对一个分数取余，请点这里：<https://www.luogu.com.cn/problem/P2613>\n\n\n - 对于 $40\\%$ 的数据，满足 $2 \\leq n \\leq 10$；\n - 对于 $60\\%$ 的数据，满足集合为 $[1,n]$ 中所有正整数；\n - 对于 $100\\%$ 的数据，满足 $2 \\leq n \\leq 1000$，集合中所有数字不超过 $10000$。", "locale": "zh-CN"}}}
{"pid": "P6060", "type": "P", "difficulty": 6, "samples": [["1\n5 2", "15"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "多项式", "数论", "O2优化", "洛谷月赛", "整除分块"], "title": "[加油武汉] 传染病研究", "background": "", "description": "在得知 W 市爆发的肺炎之后，科学家们立刻投入了紧锣密鼓的研究之中。\n\n（下面的部分非严谨科学，大家做题以外切勿当真）\n\n假设某种病毒在第 $x$ 天的传播能力为 $D(x)$，该函数的含义为 $x$ 的约数个数。例如 $D(6)=4, D(7)=2$。\n\n现在给定你总的传播天数 $n$ 和一个影响常数 $k$，你需要计算 $\\sum_{i=1}^n D(i^k)$ 也就是 $D(1^k)+D(2^k)+D(3^k)+ \\cdots +D(n^k)\n$。\n\n由于答案可能很大，请对 $998244353$ 取模。", "inputFormat": "本题有多组数据。\n\n第一行一个整数 $T$，表示数据组数。\n\n接下来每行两个整数 $n,k$，意义如题所示。", "outputFormat": "共 $T$ 行，表示每组数据的答案。", "hint": " - 对于 $20\\%$ 的数据，满足 $1\\leq T\\leq 10,1\\leq n\\leq 100,1\\leq k\\leq 6$；\n - 存在另外 $30\\%$ 的数据，满足 $1 \\leq T \\leq 10^4, 1\\leq n \\leq 10^7,k=1$；\n - 对于 $100\\%$ 的数据，满足 $1 \\leq T \\leq 10^4, 1\\leq n,k \\leq 10^7$。\n\n【样例解释】\n\n$D(1^2)+D(2^2)+D(3^2)+D(4^2)+D(5^2)$  \n$=D(1)+D(4)+D(9)+D(16)+D(25)$  \n$=(1)+(3)+(3)+(5)+(3)$  \n\n1 有约数 1 个：1；  \n4 有约数 3 个：1，2，4；  \n9 有约数 3 个：1，3，9；  \n16 有约数 5 个：1，2，4，8，16；  \n25 有约数 3 个：1，5，25；\n\n一共有15个  \n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] 传染病研究", "background": "", "description": "在得知 W 市爆发的肺炎之后，科学家们立刻投入了紧锣密鼓的研究之中。\n\n（下面的部分非严谨科学，大家做题以外切勿当真）\n\n假设某种病毒在第 $x$ 天的传播能力为 $D(x)$，该函数的含义为 $x$ 的约数个数。例如 $D(6)=4, D(7)=2$。\n\n现在给定你总的传播天数 $n$ 和一个影响常数 $k$，你需要计算 $\\sum_{i=1}^n D(i^k)$ 也就是 $D(1^k)+D(2^k)+D(3^k)+ \\cdots +D(n^k)\n$。\n\n由于答案可能很大，请对 $998244353$ 取模。", "inputFormat": "本题有多组数据。\n\n第一行一个整数 $T$，表示数据组数。\n\n接下来每行两个整数 $n,k$，意义如题所示。", "outputFormat": "共 $T$ 行，表示每组数据的答案。", "hint": " - 对于 $20\\%$ 的数据，满足 $1\\leq T\\leq 10,1\\leq n\\leq 100,1\\leq k\\leq 6$；\n - 存在另外 $30\\%$ 的数据，满足 $1 \\leq T \\leq 10^4, 1\\leq n \\leq 10^7,k=1$；\n - 对于 $100\\%$ 的数据，满足 $1 \\leq T \\leq 10^4, 1\\leq n,k \\leq 10^7$。\n\n【样例解释】\n\n$D(1^2)+D(2^2)+D(3^2)+D(4^2)+D(5^2)$  \n$=D(1)+D(4)+D(9)+D(16)+D(25)$  \n$=(1)+(3)+(3)+(5)+(3)$  \n\n1 有约数 1 个：1；  \n4 有约数 3 个：1，2，4；  \n9 有约数 3 个：1，3，9；  \n16 有约数 5 个：1，2，4，8，16；  \n25 有约数 3 个：1，5，25；\n\n一共有15个  \n", "locale": "zh-CN"}}}
{"pid": "P6061", "type": "P", "difficulty": 6, "samples": [["3 3\n30 25 30\n1 2 3\n2 3 5\n3 1 10", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "最短路", "洛谷月赛"], "title": "[加油武汉] 疫情调查", "background": null, "description": "W 市爆发了严重的肺炎疫情。为了应对疫情，W 市需要对下属每一个社区进行巡回调查。\n\nW 市共有 $n$ 个街区，街区之间由 $m$ 条不相同的有向道路相连，没有任何一条道路是自己通向自己的，并且是保证弱连通的。通过每条道路需要消耗一定的燃油费用。\n\n现在你需要派出一些工作人员来寻访每个街区。对于每个工作人员，你需要给他分派一些街区，之后工作人员会按照给定的顺序在这些街区反复循环，每周循环一次。请注意，工作人员只会检查你给他分配的街区，在分配的街区之间经过的街区，工作人员并不会下车。同时为了防止人员浪费，任何一个街区只能接受一位工作人员的检查。当然，如果必要，他也会经过重复的街区。\n\n工作人员的花费是这样的：若是某个工作人员只分配到了一个街区 $u$，那么他需要每周消耗 $a_u$ 的停留费用。若是被分配到了多于一个的街区，那么他的花费就是环绕这些点一圈最后回到起点的道路燃油费用之和。\n\n现在你需要知道，在工作人员数量无限的情况下，每周最少需要多少费用可以将整个 W 市完全巡查。", "inputFormat": "第一行两个整数 $n,m$，意义如题。\n\n第二行 $n$ 个整数，为数组 $a$。\n\n接下来 $m$ 行，每行三个整数 $u_i,v_i,w_i$ 表示存在一条连接 $u_i,v_i$ 的**有向边**，通行时付出的代价为 $w_i$。", "outputFormat": "一个整数，表示答案。", "hint": "对于所有的数据 $1\\leq n\\leq 500,1\\leq m\\leq \\min\\{5000,n\\times(n-1)\\},0\\leq a_i,w_i\\leq 10^9$，保证图弱连通，无自环、无重边。\n\n对于不同的测试点，我们有如下约束：\n\n| 测试点编号 | $n\\leq$ | $m\\leq$ | 特殊性质 |\n| :-: | :-: | :-: | :-: |\n| $1\\sim 6$ | $15$ | $100$ | $\\times$ |\n| $7\\sim 10$ | $500$ | $5000$ | 对于所有的 $w_i=0$ |\n| $11\\sim 14$ | $500$ | $500$ | $n=m$ 且所有的节点出度为 $1$ |\n| $15\\sim 20$ | $500$ | $5000$ | $\\times$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] 疫情调查", "background": null, "description": "W 市爆发了严重的肺炎疫情。为了应对疫情，W 市需要对下属每一个社区进行巡回调查。\n\nW 市共有 $n$ 个街区，街区之间由 $m$ 条不相同的有向道路相连，没有任何一条道路是自己通向自己的，并且是保证弱连通的。通过每条道路需要消耗一定的燃油费用。\n\n现在你需要派出一些工作人员来寻访每个街区。对于每个工作人员，你需要给他分派一些街区，之后工作人员会按照给定的顺序在这些街区反复循环，每周循环一次。请注意，工作人员只会检查你给他分配的街区，在分配的街区之间经过的街区，工作人员并不会下车。同时为了防止人员浪费，任何一个街区只能接受一位工作人员的检查。当然，如果必要，他也会经过重复的街区。\n\n工作人员的花费是这样的：若是某个工作人员只分配到了一个街区 $u$，那么他需要每周消耗 $a_u$ 的停留费用。若是被分配到了多于一个的街区，那么他的花费就是环绕这些点一圈最后回到起点的道路燃油费用之和。\n\n现在你需要知道，在工作人员数量无限的情况下，每周最少需要多少费用可以将整个 W 市完全巡查。", "inputFormat": "第一行两个整数 $n,m$，意义如题。\n\n第二行 $n$ 个整数，为数组 $a$。\n\n接下来 $m$ 行，每行三个整数 $u_i,v_i,w_i$ 表示存在一条连接 $u_i,v_i$ 的**有向边**，通行时付出的代价为 $w_i$。", "outputFormat": "一个整数，表示答案。", "hint": "对于所有的数据 $1\\leq n\\leq 500,1\\leq m\\leq \\min\\{5000,n\\times(n-1)\\},0\\leq a_i,w_i\\leq 10^9$，保证图弱连通，无自环、无重边。\n\n对于不同的测试点，我们有如下约束：\n\n| 测试点编号 | $n\\leq$ | $m\\leq$ | 特殊性质 |\n| :-: | :-: | :-: | :-: |\n| $1\\sim 6$ | $15$ | $100$ | $\\times$ |\n| $7\\sim 10$ | $500$ | $5000$ | 对于所有的 $w_i=0$ |\n| $11\\sim 14$ | $500$ | $500$ | $n=m$ 且所有的节点出度为 $1$ |\n| $15\\sim 20$ | $500$ | $5000$ | $\\times$ |", "locale": "zh-CN"}}}
{"pid": "P6062", "type": "P", "difficulty": 6, "samples": [["4 4\n*.*.\n.***\n***.\n..*.", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO", "图论建模", "二分图"], "title": "[USACO05JAN] Muddy Fields G", "background": "", "description": "大雨侵袭了奶牛们的牧场。\n\n牧场是一个 $R \\times C$ 的矩形，其中 $1 \\leq R,C \\leq 50$。大雨将没有长草的土地弄得泥泞不堪，可是小心的奶牛们不想在吃草的时候弄脏她们的蹄子。为了防止她们的蹄子被弄脏，约翰决定在泥泞的牧场里放置一些木板。每一块木板的宽度为 $1$ 个单位，长度任意，每一个板必须放置在平行于牧场的泥地里。 \n\n约翰想使用最少的木板覆盖所有的泥地．一个木板可以重叠在另一个木板上，但是不能放在草地上。", "inputFormat": "第一行两个整数 $R,C$。\n\n接下来 $R$ 行，每行 $C$ 个字符，描述牧场，其中 `*` 为泥地，`.` 为草地。", "outputFormat": "输出一个整数，最少需要多少木板。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Muddy Fields G", "background": "", "description": "大雨侵袭了奶牛们的牧场。\n\n牧场是一个 $R \\times C$ 的矩形，其中 $1 \\leq R,C \\leq 50$。大雨将没有长草的土地弄得泥泞不堪，可是小心的奶牛们不想在吃草的时候弄脏她们的蹄子。为了防止她们的蹄子被弄脏，约翰决定在泥泞的牧场里放置一些木板。每一块木板的宽度为 $1$ 个单位，长度任意，每一个板必须放置在平行于牧场的泥地里。 \n\n约翰想使用最少的木板覆盖所有的泥地．一个木板可以重叠在另一个木板上，但是不能放在草地上。", "inputFormat": "第一行两个整数 $R,C$。\n\n接下来 $R$ 行，每行 $C$ 个字符，描述牧场，其中 `*` 为泥地，`.` 为草地。", "outputFormat": "输出一个整数，最少需要多少木板。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6063", "type": "P", "difficulty": 4, "samples": [["4 5\n5 8 7 7\n5 2 1 5\n7 1 7 1\n8 9 6 9\n9 8 9 9", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO"], "title": "[USACO05JAN] The Wedding Juicer G", "background": "", "description": "约翰的奶牛们找到了一份不错的兼职一设计冲压式榨汁机．榨汁机设计如下：\n\n一个 $W \\times H$ 的底座（$3\\leq W,H \\leq 300$），每一个 $1 \\times 1$ 的方格上都放有一个高度为 $B$（$1 \\leq B \\leq 10^9$）的柱子，用来榨汁。假设柱子之间都被完美地粘合了，这样水不会顺着柱子与柱子之间的空隙流走。\n\n但是约翰一直不知道，这么一个榨汁机，到底能装多少果汁？假设榨汁机周围没有任何东西，也就是说，边界上的水都会流走，有些榨汁机则根本不能装下任何的果汁。", "inputFormat": "第一行两个整数 $W$ 和 $H$。\n\n接下来 $H$ 行，每行 $W$ 个数字，代表了高度。", "outputFormat": "输出最多能装多少果汁。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] The Wedding Juicer G", "background": "", "description": "约翰的奶牛们找到了一份不错的兼职一设计冲压式榨汁机．榨汁机设计如下：\n\n一个 $W \\times H$ 的底座（$3\\leq W,H \\leq 300$），每一个 $1 \\times 1$ 的方格上都放有一个高度为 $B$（$1 \\leq B \\leq 10^9$）的柱子，用来榨汁。假设柱子之间都被完美地粘合了，这样水不会顺着柱子与柱子之间的空隙流走。\n\n但是约翰一直不知道，这么一个榨汁机，到底能装多少果汁？假设榨汁机周围没有任何东西，也就是说，边界上的水都会流走，有些榨汁机则根本不能装下任何的果汁。", "inputFormat": "第一行两个整数 $W$ 和 $H$。\n\n接下来 $H$ 行，每行 $W$ 个数字，代表了高度。", "outputFormat": "输出最多能装多少果汁。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6064", "type": "P", "difficulty": 4, "samples": [["5 3\n2\n0\n3\n1\n4", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2005", "USACO"], "title": "[USACO05JAN] Naptime G", "background": null, "description": "贝茜是一只非常缺觉的奶牛．她的一天被平均分割成 $N$ 段（$3 \\leq N \\leq 3830$），但是她要用其中的 $B$ 段时间（$2 \\leq B \\lt N$）睡觉。每段时间都有一个效用值 $U_i$（$0 \\leq U_i \\leq 2 \\times 10^5$），只有当她睡觉的时候，才会发挥效用。\n\n有了闹钟的帮助，贝茜可以选择任意的时间入睡，当然，她只能在时间划分的边界处入睡、醒来。\n\n贝茜想使所有睡觉效用的总和最大。不幸的是，每一段睡眠的第一个时间阶段都是“入睡”阶段，而且不记入效用值。\n\n时间阶段是不断循环的圆（一天一天是循环的嘛），假如贝茜在时间 $N$ 和时间 $1$ 睡觉，那么她将得到时间 $1$ 的效用值。", "inputFormat": "第一行两个整数 $N,B$。\n\n接下来 $N$ 行，每行一个整数，表示第 $i$ 个时段的效用值。", "outputFormat": "输出最大效用值。", "hint": "从第 $4$ 个时段入睡，到第 $1$ 个时段结束醒来。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Naptime G", "background": null, "description": "贝茜是一只非常缺觉的奶牛．她的一天被平均分割成 $N$ 段（$3 \\leq N \\leq 3830$），但是她要用其中的 $B$ 段时间（$2 \\leq B \\lt N$）睡觉。每段时间都有一个效用值 $U_i$（$0 \\leq U_i \\leq 2 \\times 10^5$），只有当她睡觉的时候，才会发挥效用。\n\n有了闹钟的帮助，贝茜可以选择任意的时间入睡，当然，她只能在时间划分的边界处入睡、醒来。\n\n贝茜想使所有睡觉效用的总和最大。不幸的是，每一段睡眠的第一个时间阶段都是“入睡”阶段，而且不记入效用值。\n\n时间阶段是不断循环的圆（一天一天是循环的嘛），假如贝茜在时间 $N$ 和时间 $1$ 睡觉，那么她将得到时间 $1$ 的效用值。", "inputFormat": "第一行两个整数 $N,B$。\n\n接下来 $N$ 行，每行一个整数，表示第 $i$ 个时段的效用值。", "outputFormat": "输出最大效用值。", "hint": "从第 $4$ 个时段入睡，到第 $1$ 个时段结束醒来。", "locale": "zh-CN"}}}
{"pid": "P6065", "type": "P", "difficulty": 2, "samples": [["7", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO"], "title": "[USACO05JAN] Sumsets S", "background": "", "description": "给出一个整数 $N$，将 $N$ 分解为若干个 $2$ 的次幂的和，共有多少种方法？", "inputFormat": "输入一个整数 $N$（$1 \\leq N \\leq 10^6$）。", "outputFormat": "输出方案数对 $10^9$ 取模的结果。", "hint": "所有合法方案如下：\n- 1+1+1+1+1+1+1\n- 1+1+1+1+1+2\n- 1+1+1+2+2\n- 1+1+1+4\n- 1+2+2+2\n- 1+2+4", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Sumsets S", "background": "", "description": "给出一个整数 $N$，将 $N$ 分解为若干个 $2$ 的次幂的和，共有多少种方法？", "inputFormat": "输入一个整数 $N$（$1 \\leq N \\leq 10^6$）。", "outputFormat": "输出方案数对 $10^9$ 取模的结果。", "hint": "所有合法方案如下：\n- 1+1+1+1+1+1+1\n- 1+1+1+1+1+2\n- 1+1+1+2+2\n- 1+1+1+4\n- 1+2+2+2\n- 1+2+4", "locale": "zh-CN"}}}
{"pid": "P6066", "type": "P", "difficulty": 4, "samples": [["4 5\n1 2\n1 4\n2 3\n2 4\n3 4", "1\n2\n3\n4\n2\n1\n4\n3\n2\n4\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2005", "USACO", "Special Judge", "深度优先搜索 DFS", "欧拉回路", "栈"], "title": "[USACO05JAN] Watchcow S", "background": "", "description": "Farmer John 有 $N$ 个农场（$2 \\leq N \\leq 10^4$），这些农场由 $M$ 条道路连接（$1 \\leq M \\leq 5 \\times 10^4$）。不保证没有重边。\n\nBassie 从 $1$ 号农场开始巡逻，每条路必须从两个方向各走**恰好一遍**，最后回到 $1$ 号农场。\n\n请输出一条满足上述要求的路径。\n\n保证这样的路径存在。如果有多条路径，任意输出一条即可。", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $M$ 行，每行两个整数 $u,v$，描述一条 $u$ 到 $v$ 的道路。", "outputFormat": "输出经过的农场，一行一个。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Watchcow S", "background": "", "description": "Farmer John 有 $N$ 个农场（$2 \\leq N \\leq 10^4$），这些农场由 $M$ 条道路连接（$1 \\leq M \\leq 5 \\times 10^4$）。不保证没有重边。\n\nBassie 从 $1$ 号农场开始巡逻，每条路必须从两个方向各走**恰好一遍**，最后回到 $1$ 号农场。\n\n请输出一条满足上述要求的路径。\n\n保证这样的路径存在。如果有多条路径，任意输出一条即可。", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $M$ 行，每行两个整数 $u,v$，描述一条 $u$ 到 $v$ 的道路。", "outputFormat": "输出经过的农场，一行一个。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6067", "type": "P", "difficulty": 3, "samples": [["5\n1\n5\n3\n2\n4", "40"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2005", "USACO", "前缀和"], "title": "[USACO05JAN] Moo Volume S", "background": "", "description": "Farmer John 的农场上有 $N$ 头奶牛（$1 \\leq N \\leq 10^5$），第 $i$ 头奶牛的位置为 $x_i$（$0 \\leq x_i \\leq 10^9$）。\n\n奶牛很健谈，每头奶牛都和其他 $N-1$ 头奶牛聊天。第 $i$ 头奶牛和第 $j$ 头奶牛聊天时，音量为 $|x_i-x_j|$。\n\n请您求出所有奶牛聊天音量的总和。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $x_i$。", "outputFormat": "输出总音量。\n\n**保证答案在 64 位带符号整数的表示范围内。**", "hint": "- 子任务 1（原测试数据，1 分）：$N \\leq 10^4$；\n- 子任务 2（99 分）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Moo Volume S", "background": "", "description": "Farmer John 的农场上有 $N$ 头奶牛（$1 \\leq N \\leq 10^5$），第 $i$ 头奶牛的位置为 $x_i$（$0 \\leq x_i \\leq 10^9$）。\n\n奶牛很健谈，每头奶牛都和其他 $N-1$ 头奶牛聊天。第 $i$ 头奶牛和第 $j$ 头奶牛聊天时，音量为 $|x_i-x_j|$。\n\n请您求出所有奶牛聊天音量的总和。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $x_i$。", "outputFormat": "输出总音量。\n\n**保证答案在 64 位带符号整数的表示范围内。**", "hint": "- 子任务 1（原测试数据，1 分）：$N \\leq 10^4$；\n- 子任务 2（99 分）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6068", "type": "P", "difficulty": 2, "samples": [["3\n12\n27\n5\n", "2\n3\n-1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "枚举"], "title": "『MdOI R1』GCD? GCD!", "background": "", "description": "灵喜欢 $\\mathrm{gcd}$，也就是 **最大公约数**。如果你不知道什么叫做最大公约数，你可以访问 [最大公约数 - OI Wiki](https://oi-wiki.org/math/gcd/)。\n\n灵给了你一个正整数 $n$，要你把它分成三个 **互不相等的** 正整数 $a,b,c$ 之和，使得 $\\mathrm{gcd}(a,b,c)$ 最大。", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "对于每组数据，一行一个整数，表示答案，即最大的 $\\mathrm{gcd}(a,b,c)$ 。 \n\n特别地，如果 $n$ 无法分成三个互不相等的正整数之和，请输出 `-1`。", "hint": "【样例解释】\n\n将 $12$ 分成 $2+4+6$，可以证明 $\\gcd(2,4,6)=2$ 为可能达到的最大值。\n\n将 $27$ 分成 $3+6+18$，可以证明 $\\gcd(3,6,18)=3$ 为可能达到的最大值。\n\n$5$ 无法分成三个互不相等的正整数之和，输出 `-1`。\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\leq$ | 分值 |\n| :--------: | :-----: | :--: |\n|     1      |  $50$   |  17  |\n|     2      |  $500$  |  19  |\n|     3      | $10^5$  |  23  |\n|     4      | $10^9$  |  41  |\n\n对于 $100\\%$ 的数据，$1\\le T \\le 100$，$1\\le n\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R1』GCD? GCD!", "background": "", "description": "灵喜欢 $\\mathrm{gcd}$，也就是 **最大公约数**。如果你不知道什么叫做最大公约数，你可以访问 [最大公约数 - OI Wiki](https://oi-wiki.org/math/gcd/)。\n\n灵给了你一个正整数 $n$，要你把它分成三个 **互不相等的** 正整数 $a,b,c$ 之和，使得 $\\mathrm{gcd}(a,b,c)$ 最大。", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "对于每组数据，一行一个整数，表示答案，即最大的 $\\mathrm{gcd}(a,b,c)$ 。 \n\n特别地，如果 $n$ 无法分成三个互不相等的正整数之和，请输出 `-1`。", "hint": "【样例解释】\n\n将 $12$ 分成 $2+4+6$，可以证明 $\\gcd(2,4,6)=2$ 为可能达到的最大值。\n\n将 $27$ 分成 $3+6+18$，可以证明 $\\gcd(3,6,18)=3$ 为可能达到的最大值。\n\n$5$ 无法分成三个互不相等的正整数之和，输出 `-1`。\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\leq$ | 分值 |\n| :--------: | :-----: | :--: |\n|     1      |  $50$   |  17  |\n|     2      |  $500$  |  19  |\n|     3      | $10^5$  |  23  |\n|     4      | $10^9$  |  41  |\n\n对于 $100\\%$ 的数据，$1\\le T \\le 100$，$1\\le n\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6069", "type": "P", "difficulty": 4, "samples": [["4 32\n3 7 -5 -1\n", "1\n"], ["5 18\n1 4 3 6 9\n", "1\n"], ["6 679\n5 83 56 20 54 111\n", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "二分", "前缀和", "双指针 two-pointer"], "title": "『MdOI R1』Group", "background": "此题为比赛时的数据。\n\n然鹅后来 yummy 觉得没这个必要，于是放弃加强。\n\n**存在不使用 `long double` 和 `__int128` 的写法。**", "description": "为了让我们团队的同学更加团结，我们需要让各个成员的水平尽量平均。这时，就需要有人对自己产生一些改变。\n\n我们的团队有 $n$ 个同学，第 $i$ 个同学的水平值是一个整数 $a_i$。\n\n我们认为当整组同学水平值的 **方差** **不超过 $m$** 的时候，这组同学就是团结的。  \n\n请问至少要让几个同学改变自己的水平值（可以改成任意一个 **实数**），这个团队才可以做到团结？\n\n为避免读入时的精度误差，本题输入的 $m$ 是 **实际值的 $n$ 倍**，这个值是一个整数。\n\n---\n\n如果你不知道什么叫做方差，以下是方差的基本概念：\n\n方差是衡量一组数据 **波动程度** 的指标。\n\n设长度为 $n$ 的序列 $a_{1\\dots n}$ 的平均数为 $p$，则该序列的方差 $S$ 为：\n\n$$\nS=\\frac{1}{n} \\sum_{i=1}^n(a_i-p)^2\n$$", "inputFormat": "第一行，整数 $n,m$，分别表示同学的人数和方差上限的 $n$ 倍。\n\n第二行，$n$ 个整数 $a_{1\\cdots n}$，表示每个同学的水平值。", "outputFormat": "第一行，一个整数 $t$，表示最少要改变水平值的人数。", "hint": "【样例 1 解释】   \n\n这组样例中，$n=4$，真实的 $m=\\dfrac{32}{n}=8$。\n\n一开始，所有同学水平值 $a_i$ 的平均数为 $1$，方差为：\n\n$$S=\\dfrac{1}{4}[(3-1)^2+(7-1)^2+(-5-1)^2+(-1-1)^2]=20$$\n\n把第 $3$ 个同学的水平值改成 $3$ 后，平均数为 $3$，方差为：\n\n$$S=\\dfrac{1}{4}[(3-3)^2+(7-3)^2+(3-3)^2+(-1-3)^2]=8$$\n\n只改变了 $1$ 人的水平值，即满足了题目要求。\n\n【样例 2 解释】\n\n这组样例中，$n=5$，真实的 $m=\\dfrac{18}{n}=3.6$。\n\n一开始，所有同学水平值 $a_i$ 的平均数为 $4.6$，方差为 $7.44$：\n\n把第 $5$ 个同学的水平值改成 $3.5$ 后，平均数为 $3.5$，**方差为 $2.6$。**\n\n只改变了 $1$ 人的水平值，即满足了题目要求。\n\n---\n\n【数据范围】   \n\n|子任务编号|$n\\leq$|分值|\n|:-:|:-:|:-:|\n|1|$16$|15|\n|2|$300$|17|\n|3|$10^3$|20|\n|4|$5\\times 10^3$|7|\n|5|$10^4$|8|\n|6|$2\\times 10^5$|33|\n\n对于所有测试点，$1\\leq n\\leq 2\\times 10^5$，$1\\leq m\\leq 10^{18}$，$0\\leq |a_i|\\leq 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R1』Group", "background": "此题为比赛时的数据。\n\n然鹅后来 yummy 觉得没这个必要，于是放弃加强。\n\n**存在不使用 `long double` 和 `__int128` 的写法。**", "description": "为了让我们团队的同学更加团结，我们需要让各个成员的水平尽量平均。这时，就需要有人对自己产生一些改变。\n\n我们的团队有 $n$ 个同学，第 $i$ 个同学的水平值是一个整数 $a_i$。\n\n我们认为当整组同学水平值的 **方差** **不超过 $m$** 的时候，这组同学就是团结的。  \n\n请问至少要让几个同学改变自己的水平值（可以改成任意一个 **实数**），这个团队才可以做到团结？\n\n为避免读入时的精度误差，本题输入的 $m$ 是 **实际值的 $n$ 倍**，这个值是一个整数。\n\n---\n\n如果你不知道什么叫做方差，以下是方差的基本概念：\n\n方差是衡量一组数据 **波动程度** 的指标。\n\n设长度为 $n$ 的序列 $a_{1\\dots n}$ 的平均数为 $p$，则该序列的方差 $S$ 为：\n\n$$\nS=\\frac{1}{n} \\sum_{i=1}^n(a_i-p)^2\n$$", "inputFormat": "第一行，整数 $n,m$，分别表示同学的人数和方差上限的 $n$ 倍。\n\n第二行，$n$ 个整数 $a_{1\\cdots n}$，表示每个同学的水平值。", "outputFormat": "第一行，一个整数 $t$，表示最少要改变水平值的人数。", "hint": "【样例 1 解释】   \n\n这组样例中，$n=4$，真实的 $m=\\dfrac{32}{n}=8$。\n\n一开始，所有同学水平值 $a_i$ 的平均数为 $1$，方差为：\n\n$$S=\\dfrac{1}{4}[(3-1)^2+(7-1)^2+(-5-1)^2+(-1-1)^2]=20$$\n\n把第 $3$ 个同学的水平值改成 $3$ 后，平均数为 $3$，方差为：\n\n$$S=\\dfrac{1}{4}[(3-3)^2+(7-3)^2+(3-3)^2+(-1-3)^2]=8$$\n\n只改变了 $1$ 人的水平值，即满足了题目要求。\n\n【样例 2 解释】\n\n这组样例中，$n=5$，真实的 $m=\\dfrac{18}{n}=3.6$。\n\n一开始，所有同学水平值 $a_i$ 的平均数为 $4.6$，方差为 $7.44$：\n\n把第 $5$ 个同学的水平值改成 $3.5$ 后，平均数为 $3.5$，**方差为 $2.6$。**\n\n只改变了 $1$ 人的水平值，即满足了题目要求。\n\n---\n\n【数据范围】   \n\n|子任务编号|$n\\leq$|分值|\n|:-:|:-:|:-:|\n|1|$16$|15|\n|2|$300$|17|\n|3|$10^3$|20|\n|4|$5\\times 10^3$|7|\n|5|$10^4$|8|\n|6|$2\\times 10^5$|33|\n\n对于所有测试点，$1\\leq n\\leq 2\\times 10^5$，$1\\leq m\\leq 10^{18}$，$0\\leq |a_i|\\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P6070", "type": "P", "difficulty": 4, "samples": [["4 14 3\n1 1 1\n1 2 1\n1 3 1\n2 1 1\n2 2 3\n2 3 3\n2 4 2\n3 1 1\n3 2 3\n3 3 3\n3 4 2\n4 2 2\n4 3 2\n4 4 2\n", "3\n"], ["3 1 2\n1 1 1\n", "-1\n"], ["4 5 1\n1 1 5\n2 2 -3\n2 3 -4\n3 3 1\n4 4 2\n", "15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "O2优化", "差分"], "title": "『MdOI R1』Decrease", "background": "", "description": "给定一个 $n \\times n$ 的矩阵，你可以进行若干次操作。\n\n每次操作，你可以将一个 $k \\times k$ 的 **连续** 子矩阵里的所有数全都加上 $1$ 或者全都减去 $1$。\n\n初始时，矩阵中有 $m$ 个位置上的数不为 $0$，其它位置上的数均为 $0$。\n\n请你求出至少需要多少次操作，可以将矩形中所有数都变为 $0$。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示矩阵大小，非 $0$ 格数和每次修改的连续子矩阵大小。\n\n接下来 $m$ 行，每行三个整数 $x,y,z$，表示初始时矩阵的第 $x$ 行第 $y$ 列上的数为 $z$。\n\n", "outputFormat": "一行一个整数，表示最少操作次数。\n\n特别地，如果无法使矩阵中所有数都变为 $0$，输出 `-1`。  ", "hint": "【样例 1 解释】:  \n\n给出的矩阵为：  \n\n```plain\n1 1 1 0\n1 3 3 2\n1 3 3 2\n0 2 2 2\n```\n\n具体步骤：  \n\n先将以第一行第一列为左上角的连续子矩阵执行 **减 1 操作** 一次；\n\n再将以第二行第二列为左上角的连续子矩阵执行 **减 1 操作** 两次。\n\n总共三次。\n\n```plain\n1 1 1 0  0 0 0 0  0 0 0 0  0 0 0 0\n1 3 3 2  0 2 2 2  0 1 1 1  0 0 0 0\n1 3 3 2  0 2 2 2  0 1 1 1  0 0 0 0\n0 2 2 2  0 2 2 2  0 1 1 1  0 0 0 0\n```\n\n【样例 2 解释】：  \n\n给出的矩阵为：  \n\n```plain\n1 0 0\n0 0 0\n0 0 0\n```\n\n只通过 $2\\times 2$ 的连续子矩阵操作不可能使得所有格子上的数都变为 $0$。\n\n【数据范围】   \n\n**本题采用捆绑测试。**\n\n| 子任务编号 |    $n\\leq$     | $k\\leq$ | 分值 |\n| :--------: | :------------: | :-----: | :--: |\n|     1      |     $10^3$     |   $1$   |  11  |\n|     2      |      $20$      |  $20$   |  14  |\n|     3      |     $100$      |  $100$  |  17  |\n|     4      |     $10^3$     | $10^3$  |  34  |\n|     5      | $5\\times 10^3$ | $10^3$  |  24  |\n\n对于所有数据，$1\\leq n\\leq 5\\times 10^3$，$1\\leq m\\leq \\min(n^2,5\\times 10^5)$，$1\\leq k\\leq \\min(n,10^3)$，$1\\leq x,y\\leq n$，每对 $(x,y)$ 至多出现一次，$1 \\le |z| \\leq 10^9$。\n\n数据保证如果有解，答案不超过 $2^{63}-1$。\n\n---\n\n【提示】\n\n本题读入量较大，建议使用较快的读入方式。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R1』Decrease", "background": "", "description": "给定一个 $n \\times n$ 的矩阵，你可以进行若干次操作。\n\n每次操作，你可以将一个 $k \\times k$ 的 **连续** 子矩阵里的所有数全都加上 $1$ 或者全都减去 $1$。\n\n初始时，矩阵中有 $m$ 个位置上的数不为 $0$，其它位置上的数均为 $0$。\n\n请你求出至少需要多少次操作，可以将矩形中所有数都变为 $0$。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示矩阵大小，非 $0$ 格数和每次修改的连续子矩阵大小。\n\n接下来 $m$ 行，每行三个整数 $x,y,z$，表示初始时矩阵的第 $x$ 行第 $y$ 列上的数为 $z$。\n\n", "outputFormat": "一行一个整数，表示最少操作次数。\n\n特别地，如果无法使矩阵中所有数都变为 $0$，输出 `-1`。  ", "hint": "【样例 1 解释】:  \n\n给出的矩阵为：  \n\n```plain\n1 1 1 0\n1 3 3 2\n1 3 3 2\n0 2 2 2\n```\n\n具体步骤：  \n\n先将以第一行第一列为左上角的连续子矩阵执行 **减 1 操作** 一次；\n\n再将以第二行第二列为左上角的连续子矩阵执行 **减 1 操作** 两次。\n\n总共三次。\n\n```plain\n1 1 1 0  0 0 0 0  0 0 0 0  0 0 0 0\n1 3 3 2  0 2 2 2  0 1 1 1  0 0 0 0\n1 3 3 2  0 2 2 2  0 1 1 1  0 0 0 0\n0 2 2 2  0 2 2 2  0 1 1 1  0 0 0 0\n```\n\n【样例 2 解释】：  \n\n给出的矩阵为：  \n\n```plain\n1 0 0\n0 0 0\n0 0 0\n```\n\n只通过 $2\\times 2$ 的连续子矩阵操作不可能使得所有格子上的数都变为 $0$。\n\n【数据范围】   \n\n**本题采用捆绑测试。**\n\n| 子任务编号 |    $n\\leq$     | $k\\leq$ | 分值 |\n| :--------: | :------------: | :-----: | :--: |\n|     1      |     $10^3$     |   $1$   |  11  |\n|     2      |      $20$      |  $20$   |  14  |\n|     3      |     $100$      |  $100$  |  17  |\n|     4      |     $10^3$     | $10^3$  |  34  |\n|     5      | $5\\times 10^3$ | $10^3$  |  24  |\n\n对于所有数据，$1\\leq n\\leq 5\\times 10^3$，$1\\leq m\\leq \\min(n^2,5\\times 10^5)$，$1\\leq k\\leq \\min(n,10^3)$，$1\\leq x,y\\leq n$，每对 $(x,y)$ 至多出现一次，$1 \\le |z| \\leq 10^9$。\n\n数据保证如果有解，答案不超过 $2^{63}-1$。\n\n---\n\n【提示】\n\n本题读入量较大，建议使用较快的读入方式。  ", "locale": "zh-CN"}}}
{"pid": "P6071", "type": "P", "difficulty": 6, "samples": [["5 4\n3 1 2\n1 5 1\n2 3 3\n3 4 4\n2 3 5\n2 1 7\n0 7 7\n5 5 2", "3\n2\n6\n0"], ["10 10\n2 1 9907\n3 2 8329\n4 2 8402\n5 4 3636\n6 4 8747\n7 4 3080\n8 6 780\n9 6 5414\n10 9 3545\n2 10 10\n26107 26106 26101\n4 9 10\n14171 14166 14169\n8958 8949 8949\n36008 36014 36013\n11485 11485 11472\n3 9 9\n30888 30894 30895\n8404 8404 8411\n", "26108\n0\n14161\n8959\n36015\n11482\n0\n30892\n8402\n0\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["最近公共祖先 LCA", "可持久化线段树"], "title": "『MdOI R1』Treequery", "background": "", "description": "给定一棵 $n$ 个点的无根树，边有边权。\n\n令 $E(x,y)$ 表示树上 $x,y$ 之间的简单路径上的所有边的集合，特别地，当 $x=y$ 时，$E(x,y) = \\varnothing$。\n\n你需要 **实时** 回答 $q$ 个询问，每个询问给定 $p,l,r$，请你求出集合 $\\bigcap_{i=l}^r E(p,i)$ 中所有边的边权和，即 $E(p, l\\dots r)$ 的交所包含的边的边权和。\n\n通俗的讲，你需要求出 $p$ 到 $[l,r]$ 内每一个点的简单路径的公共部分长度。\n\n", "inputFormat": "第一行两个整数 $n,q$，表示树的结点数和询问数。\n\n接下来 $n-1$ 行，每行三个整数 $x,y,w$，表示 $x$ 与 $y$ 之间有一条权值为 $w$ 的边。\n\n接下来 $q$ 行，每行三个整数 $p_0,l_0,r_0$。第 $i$ 个询问的 $p,l,r$ 分别为 $p_0,l_0,r_0$ 异或上 $lastans$ 的值，其中 $lastans$ 是上次询问的答案，初始时为 $0$。", "outputFormat": "对于每个询问，一行一个整数，表示答案。", "hint": "【样例 1 说明】\n\n样例中的树如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g6l15zpv.png)\n\n下面解释中的询问参数均为异或 $lastans$ 之后得到的真实值。\n\n对于第一个询问，$p=2$，$l=3$，$r=5$，$\\bigcap_{i=3}^5 E(2,i)$ 为边 $(2,3)$，长度为 $3$。\n\n对于第二个询问，$p=1$，$l=2$，$r=4$，$\\bigcap_{i=2}^4 E(1,i)$ 为边 $(1,3)$，长度为 $2$；\n\n对于第三个询问，$p=2$，$l=5$，$r=5$，$\\bigcap_{i=5}^5 E(2,i)$ 为边集 $\\{(2,3),(3,1),(1,5)\\}$，长度为 $6$；\n\n对于第四个询问，$p=3$，$l=3$，$r=4$，$\\bigcap_{i=3}^4 E(3,i)=\\varnothing$，长度为 $0$。\n\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |   $n,q\\leq$    | 特殊性质 | 分值 |\n| :--------: | :------------: | :------: | :--: |\n|     1      |     $10^5$     |  $l=r$   |  8   |\n|     2      |     $10^5$     |  $p=1$   |  20  |\n|     3      |     $10^3$     |    无    |  20  |\n|     4      |     $10^5$     |    无    |  26  |\n|     5      | $2\\times 10^5$ |    无    |  26  |\n\n对于 $100\\%$ 的数据，$1\\leq n,q\\leq 2\\times 10^5$，$1\\leq x,y,p\\leq n$，$1\\leq l\\leq r\\leq n$，$1\\leq w\\leq 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "\"MdOI R1\" Treequery", "background": "", "description": "Given an undirected tree with $n$ nodes, where each edge has a weight.\n\nLet $E(x,y)$ denote the set of all edges on the simple path between $x$ and $y$ in the tree. In particular, when $x=y$, $E(x,y)=\\varnothing$.\n\nYou need to answer $q$ queries **online**. Each query gives $p,l,r$. Please compute the sum of edge weights of all edges in the set $\\bigcap_{i=l}^r E(p,i)$, i.e. the sum of edge weights contained in the intersection of $E(p, l\\dots r)$.\n\nIn simple terms, you need to find the length of the common part of the simple paths from $p$ to every node in $[l,r]$.", "inputFormat": "The first line contains two integers $n,q$, representing the number of nodes in the tree and the number of queries.\n\nThe next $n-1$ lines each contain three integers $x,y,w$, indicating that there is an edge between $x$ and $y$ with weight $w$.\n\nThe next $q$ lines each contain three integers $p_0,l_0,r_0$. For the $i$-th query, the actual $p,l,r$ are obtained by XOR-ing $p_0,l_0,r_0$ with $lastans$, respectively, where $lastans$ is the answer to the previous query and is initially $0$.", "outputFormat": "For each query, output one integer per line, representing the answer.", "hint": "[Sample 1 Explanation]\n\nThe tree in the sample is shown in the figure:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g6l15zpv.png)\n\nIn the explanations below, all query parameters are the real values after XOR with $lastans$.\n\nFor the first query, $p=2$, $l=3$, $r=5$, and $\\bigcap_{i=3}^5 E(2,i)$ is the edge $(2,3)$, with total length $3$.\n\nFor the second query, $p=1$, $l=2$, $r=4$, and $\\bigcap_{i=2}^4 E(1,i)$ is the edge $(1,3)$, with total length $2$.\n\nFor the third query, $p=2$, $l=5$, $r=5$, and $\\bigcap_{i=5}^5 E(2,i)$ is the edge set $\\{(2,3),(3,1),(1,5)\\}$, with total length $6$.\n\nFor the fourth query, $p=3$, $l=3$, $r=4$, $\\bigcap_{i=3}^4 E(3,i)=\\varnothing$, and the total length is $0$.\n\n---\n\n[Constraints]\n\n**This problem uses bundled testdata.**\n\n| Subtask ID | $n,q\\leq$ | Special Property | Score |\n| :--------: | :-------: | :--------------: | :---: |\n| 1 | $10^5$ | $l=r$ | 8 |\n| 2 | $10^5$ | $p=1$ | 20 |\n| 3 | $10^3$ | None | 20 |\n| 4 | $10^5$ | None | 26 |\n| 5 | $2\\times 10^5$ | None | 26 |\n\nFor $100\\%$ of the data, $1\\leq n,q\\leq 2\\times 10^5$, $1\\leq x,y,p\\leq n$, $1\\leq l\\leq r\\leq n$, and $1\\leq w\\leq 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "『MdOI R1』Treequery", "background": "", "description": "给定一棵 $n$ 个点的无根树，边有边权。\n\n令 $E(x,y)$ 表示树上 $x,y$ 之间的简单路径上的所有边的集合，特别地，当 $x=y$ 时，$E(x,y) = \\varnothing$。\n\n你需要 **实时** 回答 $q$ 个询问，每个询问给定 $p,l,r$，请你求出集合 $\\bigcap_{i=l}^r E(p,i)$ 中所有边的边权和，即 $E(p, l\\dots r)$ 的交所包含的边的边权和。\n\n通俗的讲，你需要求出 $p$ 到 $[l,r]$ 内每一个点的简单路径的公共部分长度。\n\n", "inputFormat": "第一行两个整数 $n,q$，表示树的结点数和询问数。\n\n接下来 $n-1$ 行，每行三个整数 $x,y,w$，表示 $x$ 与 $y$ 之间有一条权值为 $w$ 的边。\n\n接下来 $q$ 行，每行三个整数 $p_0,l_0,r_0$。第 $i$ 个询问的 $p,l,r$ 分别为 $p_0,l_0,r_0$ 异或上 $lastans$ 的值，其中 $lastans$ 是上次询问的答案，初始时为 $0$。", "outputFormat": "对于每个询问，一行一个整数，表示答案。", "hint": "【样例 1 说明】\n\n样例中的树如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g6l15zpv.png)\n\n下面解释中的询问参数均为异或 $lastans$ 之后得到的真实值。\n\n对于第一个询问，$p=2$，$l=3$，$r=5$，$\\bigcap_{i=3}^5 E(2,i)$ 为边 $(2,3)$，长度为 $3$。\n\n对于第二个询问，$p=1$，$l=2$，$r=4$，$\\bigcap_{i=2}^4 E(1,i)$ 为边 $(1,3)$，长度为 $2$；\n\n对于第三个询问，$p=2$，$l=5$，$r=5$，$\\bigcap_{i=5}^5 E(2,i)$ 为边集 $\\{(2,3),(3,1),(1,5)\\}$，长度为 $6$；\n\n对于第四个询问，$p=3$，$l=3$，$r=4$，$\\bigcap_{i=3}^4 E(3,i)=\\varnothing$，长度为 $0$。\n\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |   $n,q\\leq$    | 特殊性质 | 分值 |\n| :--------: | :------------: | :------: | :--: |\n|     1      |     $10^5$     |  $l=r$   |  8   |\n|     2      |     $10^5$     |  $p=1$   |  20  |\n|     3      |     $10^3$     |    无    |  20  |\n|     4      |     $10^5$     |    无    |  26  |\n|     5      | $2\\times 10^5$ |    无    |  26  |\n\n对于 $100\\%$ 的数据，$1\\leq n,q\\leq 2\\times 10^5$，$1\\leq x,y,p\\leq n$，$1\\leq l\\leq r\\leq n$，$1\\leq w\\leq 10^4$。", "locale": "zh-CN"}}}
{"pid": "P6072", "type": "P", "difficulty": 6, "samples": [["9\n1 2 1\n1 3 7\n2 4 8\n3 5 3\n4 6 3\n3 7 3\n7 8 5\n7 9 2\n", "21\n"], ["3\n1 2 2\n2 3 1\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000]}, "tags": ["莫队", "O2优化", "分治", "字典树 Trie"], "title": "『MdOI R1』Path", "background": "", "description": "给定一棵 $n$ 个点的无根树，边有边权。\n\n令 $V(x,y),E(x,y)$ 分别表示树上 $x,y$ 之间的简单路径上的所有点的集合和所有边的集合，特别地，当 $x=y$ 时，$V(x,y) = \\{x\\}$，$E(x,y) = \\varnothing$。\n\n再令边集 $E$ 的权值 $f(E)$ 为 $E$ 中所有边的权值的 **异或和**，当 $E = \\varnothing$ 时，$f(E) = 0$。\n\n现在，要你求出\n$$\n\\max_{1\\le x,y,u,v \\le n,V(x,y)\\cap V(u,v) = \\varnothing}(f(E(x,y)) + f(E(u,v)))\n$$\n通俗的讲，你要选择两条简单路径，满足没有重合的点，且边权异或和之和最大。", "inputFormat": "第一行一个整数 $n$，表示树上点的个数。\n\n接下来 $n-1$ 行，每行三个整数 $x,y,w$，表示编号为 $x$ 和 $y$ 的点之间有一条权值为 $w$ 的边。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 1 解释】\n\n样例中的树如图所示，选择标红色和蓝色的两条路径，满足没有重合的点，且边权异或和之和最大，为 $(7\\oplus 1\\oplus 8)+(5\\oplus 2)=21$（其中 $\\oplus$ 表示异或运算）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jen9sxcf.png)\n\n【样例 2 解释】\n\n样例中的树如图所示，为一条链的形状，选择标红色和蓝色的两条路径，蓝色路径退化成了一个点，使异或和之和达到最大值 $2+0=2$。注意红色路径并不能延申到 $3$，否则蓝色路径将无法存在。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1xzo1lh2.png)\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |    $n\\leq$     |  特殊性质   | 分值 | 时限 |\n| :--------: | :------------: | :---------: | :--: | :--: |\n|     1      |      $50$      |     无      |  12  |  1s  |\n|     2      | $2\\times 10^3$ |     无      |  28  |  2s  |\n|     3      | $2\\times 10^4$ | $y = x + 1$ |  20  |  3s  |\n|     4      | $3\\times 10^4$ |     无      |  40  | 3.5s |\n\n对于 $100\\%$ 的数据，$2\\leq n\\leq 3\\times 10^4$，$1\\leq x,y\\leq n$，$0\\leq w\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "\"MdOI R1\" Path", "background": "", "description": "You are given an undirected tree with $n$ nodes, and each edge has a weight.\n\nLet $V(x,y)$ and $E(x,y)$ denote the set of all nodes and the set of all edges on the simple path between $x$ and $y$ in the tree. In particular, when $x=y$, $V(x,y)=\\{x\\}$ and $E(x,y)=\\varnothing$.\n\nDefine the weight $f(E)$ of an edge set $E$ as the **bitwise XOR sum** of the weights of all edges in $E$. When $E=\\varnothing$, $f(E)=0$.\n\nNow, you need to compute\n$$\n\\max_{1\\le x,y,u,v \\le n,V(x,y)\\cap V(u,v) = \\varnothing}(f(E(x,y)) + f(E(u,v)))\n$$\nIn plain words, you need to choose two simple paths such that they do not share any common nodes, and the sum of their edge-weight XOR values is as large as possible.", "inputFormat": "The first line contains an integer $n$, the number of nodes in the tree.\n\nThe next $n-1$ lines each contain three integers $x,y,w$, indicating that there is an edge of weight $w$ between nodes $x$ and $y$.", "outputFormat": "Output one integer on a single line, the answer.", "hint": "[Sample 1 Explanation]\n\nThe tree in the sample is shown in the figure. Choose the two paths marked in red and blue. They have no common nodes, and the sum of XOR values is maximized, which is $(7\\oplus 1\\oplus 8)+(5\\oplus 2)=21$ (where $\\oplus$ denotes the XOR operation).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jen9sxcf.png)\n\n[Sample 2 Explanation]\n\nThe tree in the sample is shown in the figure. It is a chain. Choose the red and blue paths; the blue path degenerates into a single node, making the maximum sum of XOR values $2+0=2$. Note that the red path cannot be extended to $3$, otherwise the blue path would not be possible.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1xzo1lh2.png)\n\n---\n\n[Constraints]\n\n**This problem uses bundled testdata.**\n\n| Subtask ID |    $n\\leq$     | Special Property | Score | Time Limit |\n| :--------: | :------------: | :--------------: | :---: | :--------: |\n|     1      |      $50$      |       None       |  12   |    1s      |\n|     2      | $2\\times 10^3$ |       None       |  28   |    2s      |\n|     3      | $2\\times 10^4$ | $y = x + 1$      |  20   |    3s      |\n|     4      | $3\\times 10^4$ |       None       |  40   |   3.5s     |\n\nFor $100\\%$ of the testdata, $2\\leq n\\leq 3\\times 10^4$, $1\\leq x,y\\leq n$, $0\\leq w\\leq 10^9$.\n\n# Input Format\n\nThe first line contains an integer $n$, the number of nodes in the tree.\n\nThe next $n-1$ lines each contain three integers $x,y,w$, indicating that there is an edge of weight $w$ between nodes $x$ and $y$.\n\n# Output Format\n\nOutput one integer on a single line, the answer.\n\n# Hint\n\n[Sample 1 Explanation]\n\nThe tree in the sample is shown in the figure. Choose the two paths marked in red and blue. They have no common nodes, and the sum of XOR values is maximized, which is $(7\\oplus 1\\oplus 8)+(5\\oplus 2)=21$ (where $\\oplus$ denotes the XOR operation).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jen9sxcf.png)\n\n[Sample 2 Explanation]\n\nThe tree in the sample is shown in the figure. It is a chain. Choose the red and blue paths; the blue path degenerates into a single node, making the maximum sum of XOR values $2+0=2$. Note that the red path cannot be extended to $3$, otherwise the blue path would not be possible.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1xzo1lh2.png)\n\n---\n\n[Constraints]\n\n**This problem uses bundled testdata.**\n\n| Subtask ID |    $n\\leq$     | Special Property | Score | Time Limit |\n| :--------: | :------------: | :--------------: | :---: | :--------: |\n|     1      |      $50$      |       None       |  12   |    1s      |\n|     2      | $2\\times 10^3$ |       None       |  28   |    2s      |\n|     3      | $2\\times 10^4$ | $y = x + 1$      |  20   |    3s      |\n|     4      | $3\\times 10^4$ |       None       |  40   |   3.5s     |\n\nFor $100\\%$ of the testdata, $2\\leq n\\leq 3\\times 10^4$, $1\\leq x,y\\leq n$, $0\\leq w\\leq 10^9$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "『MdOI R1』Path", "background": "", "description": "给定一棵 $n$ 个点的无根树，边有边权。\n\n令 $V(x,y),E(x,y)$ 分别表示树上 $x,y$ 之间的简单路径上的所有点的集合和所有边的集合，特别地，当 $x=y$ 时，$V(x,y) = \\{x\\}$，$E(x,y) = \\varnothing$。\n\n再令边集 $E$ 的权值 $f(E)$ 为 $E$ 中所有边的权值的 **异或和**，当 $E = \\varnothing$ 时，$f(E) = 0$。\n\n现在，要你求出\n$$\n\\max_{1\\le x,y,u,v \\le n,V(x,y)\\cap V(u,v) = \\varnothing}(f(E(x,y)) + f(E(u,v)))\n$$\n通俗的讲，你要选择两条简单路径，满足没有重合的点，且边权异或和之和最大。", "inputFormat": "第一行一个整数 $n$，表示树上点的个数。\n\n接下来 $n-1$ 行，每行三个整数 $x,y,w$，表示编号为 $x$ 和 $y$ 的点之间有一条权值为 $w$ 的边。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 1 解释】\n\n样例中的树如图所示，选择标红色和蓝色的两条路径，满足没有重合的点，且边权异或和之和最大，为 $(7\\oplus 1\\oplus 8)+(5\\oplus 2)=21$（其中 $\\oplus$ 表示异或运算）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jen9sxcf.png)\n\n【样例 2 解释】\n\n样例中的树如图所示，为一条链的形状，选择标红色和蓝色的两条路径，蓝色路径退化成了一个点，使异或和之和达到最大值 $2+0=2$。注意红色路径并不能延申到 $3$，否则蓝色路径将无法存在。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1xzo1lh2.png)\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |    $n\\leq$     |  特殊性质   | 分值 | 时限 |\n| :--------: | :------------: | :---------: | :--: | :--: |\n|     1      |      $50$      |     无      |  12  |  1s  |\n|     2      | $2\\times 10^3$ |     无      |  28  |  2s  |\n|     3      | $2\\times 10^4$ | $y = x + 1$ |  20  |  3s  |\n|     4      | $3\\times 10^4$ |     无      |  40  | 3.5s |\n\n对于 $100\\%$ 的数据，$2\\leq n\\leq 3\\times 10^4$，$1\\leq x,y\\leq n$，$0\\leq w\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6073", "type": "P", "difficulty": 7, "samples": [["1\n5\n2\n2\n3", "1\n33\n"], ["2\n2\n4 2\n18 7", "440891256\n841247136"], ["4\n2\n4 2\n20 9", "65\n429844531\n"], ["5\n2\n4 2\n30 12", "58\n475486366\n"]], "limits": {"time": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "组合数学", "Stirling 数", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "『MdOI R1』Epic Convolution", "background": "小 Q 是神仙，尤其喜欢多项式。\n\n这天小 K 问了道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}g_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后小 K 花了一个月学习 FFT 和 NTT。又跑过去问小 Q 一道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}\\binom{n}{k}g_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后小 K 又花了一个月学习 FFT 和 NTT。又跑过去问小 Q 一道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后他仔细看了一遍，傻眼了，发现他不会这道题。\n\n为了吊打小 K，你需要告诉他 $4$ 个特殊情况的做法。", "description": "给定特定的序列 $g,h$，求 $f_n$ 满足 $f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$。\n\n本题有五个子任务，前四个子任务给定不同形式的 $g,h$，需要求出 $f_n$，第五个子任务不依赖于这个等式，但是形式上与此相似。\n\n**注意，本题所有输出请对 $998244353$（$119\\times 2^{23}+1$，一个质数）取模。**\n\n---\n\n**Subtask 1（4 pts）：**\n\n给定一个 $n$，你需要回答 $q$ 组询问，每组询问给定一个整数 $m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\begin{cases}1,&k<m\\\\0,&k\\geq m\\end{cases}$$\n\n$$h_k=1$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 2,3（16,16 pts）：**\n\n这两个子任务给定的序列 $g,h$ 形式相同，但数据范围不同，请仔细阅读数据范围。\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\frac{1}{(k+m+1)!}$$\n\n$$h_k=\\begin{cases}0,&k<m\\\\\\frac{(-1)^{k-m}}{(k-m)!},&k\\geq m\\end{cases}$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 4（32 pts）：**\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\frac{k^m}{k!}$$\n\n$$h_k=\\frac{(-1)^k}{k!}$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 5（32 pts）：**\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n**注意下面 $n,m$ 的含义，不要看反。**\n\n$$\\sum\\limits_{k=0}^{m}(k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\sum\\limits_{i=0}^{m-k}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}$$\n\n你需要回答出上面这个式子的值。\n\n与前四个 Subtask 相似之处是，求和的一开始是幂的形式。", "inputFormat": "第一行一个整数 $op$，表示子任务编号。\n\n若 $op=1$：  \n\n第二行一个整数 $n$，第三行一个整数 $q$；  \n\n接下来 $q$ 行，每行一个整数 $m$。\n\n若 $op\\in \\{2,3,4,5\\}$： \n\n第二行一个整数 $q$；  \n\n接下来 $q$ 行：每行两个整数 $n,m$。  \n\n所有变量含义见题目描述。", "outputFormat": "对于每组询问，一行一个整数，表示答案。", "hint": "### 样例解释 1\n\n在这组样例中，需要解决第一个子任务，$n=5,\\ \\ q=2$。\n\n第一组询问中，$m=2$，则（省略了 $0$ 的加数项）：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4\\ \\ g_5]=[1\\ \\ 1\\ \\ 0\\ \\ 0\\ \\ 0\\ \\ 0] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4\\ \\ h_5]=[1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1] $$\n\n$$f_5=1^5\\times g_1h_4=1$$\n\n第二组询问中，$m=3$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4\\ \\ g_5]=[1\\ \\ 1\\ \\ 1\\ \\ 0\\ \\ 0\\ \\ 0]$$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4\\ \\ h_5]=[1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1]$$\n\n$$f_5=1^5\\times g_1h_4+2^5\\times g_2h_3=33$$\n\n------\n\n### 样例解释 2\n\n在这组样例中，需要解决第二个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4]=[\\dfrac{1}{6}\\ \\ \\dfrac{1}{24}\\ \\ \\dfrac{1}{120}\\ \\ \\dfrac{1}{720}\\ \\ \\dfrac{1}{5040}] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4]=[0\\ \\ 0\\ \\ 1\\ \\ -1\\ \\ \\dfrac{1}{2}] $$\n\n$$f_4=1^4\\times g_1h_3+2^4\\times g_2h_2=\\dfrac{11}{120} $$\n\n$f_4=\\dfrac{11}{120}$ 对 $998244353$ 取模后等于 $440891256$。\n\n第二组询问范围过大，不进行样例解释。\n\n------\n\n### 样例解释 3\n\n在这组样例中，需要解决第四个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4]=[0\\ \\ \\ 1\\ \\ \\ 2\\ \\ \\ \\dfrac{3}{2}\\ \\ \\dfrac{2}{3}] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4]=[1\\ \\ -1\\ \\ \\dfrac{1}{2}\\ \\ -\\dfrac{1}{6}\\ \\ \\dfrac{1}{24}] $$\n\n$$f_4=1^4\\times g_1h_3+2^4\\times g_2h_2+3^4\\times g_3h_1+4^4\\times g_4h_0=65 $$\n\n第二组询问范围过大，不进行样例解释。\n\n---\n\n### 样例解释 4\n\n在这组样例中，需要解决第五个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则枚举 $k,i$：\n\n$$k=0,\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=\\dfrac{1}{2} $$\n\n$$k=0,\\ \\ i=1:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=9 $$\n\n$$k=0,\\ \\ i=2:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=36 $$\n\n$$k=1,\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=-64 $$\n\n$$k=1\\ \\ i=1:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=-288 $$\n\n$$k=2\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=\\dfrac{729}{2} $$\n\n全部相加，结果为 $58$。\n\n第二组询问范围过大，不进行样例解释。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试，不同 Subtask 的题意不同。**\n\n| 子任务编号 |    $q\\leq$     |    $n\\leq$     |    $m\\leq$     | 分值 |\n| :--------: | :------------: | :------------: | :------------: | :--: |\n|     1      | $5\\times 10^5$ |     $10^5$     | $\\min(10^5,n)$ |  4   |\n|     2      | $5\\times 10^5$ |     $2\\times 10^5$     |      $20$      |  16  |\n|     3      |      $20$      |  $998244352$   |      $20$      |  16  |\n|     4(31-40)      | $5\\times 10^5$ | $2\\times 10^5$ |      $10$      |  32  |\n|     4(51-60)      | $20$ | $10^{10^5}$ |      $10$      |  32  |\n|     5      | $5\\times 10^5$ | $2\\times 10^3$ | $2\\times 10^3$ |  32  |\n\n所有输入均为正整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R1』Epic Convolution", "background": "小 Q 是神仙，尤其喜欢多项式。\n\n这天小 K 问了道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}g_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后小 K 花了一个月学习 FFT 和 NTT。又跑过去问小 Q 一道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}\\binom{n}{k}g_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后小 K 又花了一个月学习 FFT 和 NTT。又跑过去问小 Q 一道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后他仔细看了一遍，傻眼了，发现他不会这道题。\n\n为了吊打小 K，你需要告诉他 $4$ 个特殊情况的做法。", "description": "给定特定的序列 $g,h$，求 $f_n$ 满足 $f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$。\n\n本题有五个子任务，前四个子任务给定不同形式的 $g,h$，需要求出 $f_n$，第五个子任务不依赖于这个等式，但是形式上与此相似。\n\n**注意，本题所有输出请对 $998244353$（$119\\times 2^{23}+1$，一个质数）取模。**\n\n---\n\n**Subtask 1（4 pts）：**\n\n给定一个 $n$，你需要回答 $q$ 组询问，每组询问给定一个整数 $m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\begin{cases}1,&k<m\\\\0,&k\\geq m\\end{cases}$$\n\n$$h_k=1$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 2,3（16,16 pts）：**\n\n这两个子任务给定的序列 $g,h$ 形式相同，但数据范围不同，请仔细阅读数据范围。\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\frac{1}{(k+m+1)!}$$\n\n$$h_k=\\begin{cases}0,&k<m\\\\\\frac{(-1)^{k-m}}{(k-m)!},&k\\geq m\\end{cases}$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 4（32 pts）：**\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\frac{k^m}{k!}$$\n\n$$h_k=\\frac{(-1)^k}{k!}$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 5（32 pts）：**\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n**注意下面 $n,m$ 的含义，不要看反。**\n\n$$\\sum\\limits_{k=0}^{m}(k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\sum\\limits_{i=0}^{m-k}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}$$\n\n你需要回答出上面这个式子的值。\n\n与前四个 Subtask 相似之处是，求和的一开始是幂的形式。", "inputFormat": "第一行一个整数 $op$，表示子任务编号。\n\n若 $op=1$：  \n\n第二行一个整数 $n$，第三行一个整数 $q$；  \n\n接下来 $q$ 行，每行一个整数 $m$。\n\n若 $op\\in \\{2,3,4,5\\}$： \n\n第二行一个整数 $q$；  \n\n接下来 $q$ 行：每行两个整数 $n,m$。  \n\n所有变量含义见题目描述。", "outputFormat": "对于每组询问，一行一个整数，表示答案。", "hint": "### 样例解释 1\n\n在这组样例中，需要解决第一个子任务，$n=5,\\ \\ q=2$。\n\n第一组询问中，$m=2$，则（省略了 $0$ 的加数项）：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4\\ \\ g_5]=[1\\ \\ 1\\ \\ 0\\ \\ 0\\ \\ 0\\ \\ 0] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4\\ \\ h_5]=[1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1] $$\n\n$$f_5=1^5\\times g_1h_4=1$$\n\n第二组询问中，$m=3$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4\\ \\ g_5]=[1\\ \\ 1\\ \\ 1\\ \\ 0\\ \\ 0\\ \\ 0]$$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4\\ \\ h_5]=[1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1]$$\n\n$$f_5=1^5\\times g_1h_4+2^5\\times g_2h_3=33$$\n\n------\n\n### 样例解释 2\n\n在这组样例中，需要解决第二个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4]=[\\dfrac{1}{6}\\ \\ \\dfrac{1}{24}\\ \\ \\dfrac{1}{120}\\ \\ \\dfrac{1}{720}\\ \\ \\dfrac{1}{5040}] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4]=[0\\ \\ 0\\ \\ 1\\ \\ -1\\ \\ \\dfrac{1}{2}] $$\n\n$$f_4=1^4\\times g_1h_3+2^4\\times g_2h_2=\\dfrac{11}{120} $$\n\n$f_4=\\dfrac{11}{120}$ 对 $998244353$ 取模后等于 $440891256$。\n\n第二组询问范围过大，不进行样例解释。\n\n------\n\n### 样例解释 3\n\n在这组样例中，需要解决第四个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4]=[0\\ \\ \\ 1\\ \\ \\ 2\\ \\ \\ \\dfrac{3}{2}\\ \\ \\dfrac{2}{3}] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4]=[1\\ \\ -1\\ \\ \\dfrac{1}{2}\\ \\ -\\dfrac{1}{6}\\ \\ \\dfrac{1}{24}] $$\n\n$$f_4=1^4\\times g_1h_3+2^4\\times g_2h_2+3^4\\times g_3h_1+4^4\\times g_4h_0=65 $$\n\n第二组询问范围过大，不进行样例解释。\n\n---\n\n### 样例解释 4\n\n在这组样例中，需要解决第五个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则枚举 $k,i$：\n\n$$k=0,\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=\\dfrac{1}{2} $$\n\n$$k=0,\\ \\ i=1:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=9 $$\n\n$$k=0,\\ \\ i=2:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=36 $$\n\n$$k=1,\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=-64 $$\n\n$$k=1\\ \\ i=1:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=-288 $$\n\n$$k=2\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=\\dfrac{729}{2} $$\n\n全部相加，结果为 $58$。\n\n第二组询问范围过大，不进行样例解释。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试，不同 Subtask 的题意不同。**\n\n| 子任务编号 |    $q\\leq$     |    $n\\leq$     |    $m\\leq$     | 分值 |\n| :--------: | :------------: | :------------: | :------------: | :--: |\n|     1      | $5\\times 10^5$ |     $10^5$     | $\\min(10^5,n)$ |  4   |\n|     2      | $5\\times 10^5$ |     $2\\times 10^5$     |      $20$      |  16  |\n|     3      |      $20$      |  $998244352$   |      $20$      |  16  |\n|     4(31-40)      | $5\\times 10^5$ | $2\\times 10^5$ |      $10$      |  32  |\n|     4(51-60)      | $20$ | $10^{10^5}$ |      $10$      |  32  |\n|     5      | $5\\times 10^5$ | $2\\times 10^3$ | $2\\times 10^3$ |  32  |\n\n所有输入均为正整数。", "locale": "zh-CN"}}}
{"pid": "P6074", "type": "P", "difficulty": 6, "samples": [["3 1\n2 3 3\n6 6 6\n1 2\n2 3", "0.42"], ["9 2\n9 4 4 1 6 5 1 9 5\n8 3 3 1 5 4 1 8 4\n1 2\n2 3\n3 4\n3 5\n1 6\n6 7\n7 8\n6 9", "1.15"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["点分治", "树形 DP", "分数规划", "树链剖分"], "title": "最小路径", "background": "", "description": "一棵 $n$ 个点的树，每个点两个点权 $a_i$ 和 $b_i$，找一条长度为 $m$ 的简单路径，使 $\\frac{\\sum a_i}{\\sum b_i}$ 最小。无解输出 $-1$。", "inputFormat": "第一行两个正整数 $n$ 和 $m$。  \n第二行 $n$ 个正整数 $a_i$。  \n第三行 $n$ 个正整数 $b_i$。  \n以下 $n-1$ 行，每行两个正整数 $u,v$，为一条边的两个端点。", "outputFormat": "输出最小值，**保留两位小数**。", "hint": "subtask 1 $20$：$n\\le 100$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\nsubtask 2 $40$：$n\\le 10^4$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\nsubtask 3 $40$：$n\\le 2\\times 10^5$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^5$，$1\\le m\\le n$，$1\\le a_i,b_i\\le 2000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "最小路径", "background": "", "description": "一棵 $n$ 个点的树，每个点两个点权 $a_i$ 和 $b_i$，找一条长度为 $m$ 的简单路径，使 $\\frac{\\sum a_i}{\\sum b_i}$ 最小。无解输出 $-1$。", "inputFormat": "第一行两个正整数 $n$ 和 $m$。  \n第二行 $n$ 个正整数 $a_i$。  \n第三行 $n$ 个正整数 $b_i$。  \n以下 $n-1$ 行，每行两个正整数 $u,v$，为一条边的两个端点。", "outputFormat": "输出最小值，**保留两位小数**。", "hint": "subtask 1 $20$：$n\\le 100$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\nsubtask 2 $40$：$n\\le 10^4$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\nsubtask 3 $40$：$n\\le 2\\times 10^5$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^5$，$1\\le m\\le n$，$1\\le a_i,b_i\\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P6075", "type": "P", "difficulty": 4, "samples": [["2 2", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2015", "各省省选", "江苏"], "title": "[JSOI2015] 子集选取", "background": "", "description": "给定 $n$ 个元素的集合 $S= \\left\\{1,2,\\cdots,n \\right\\}$ 和整数 $ k$，现在要从 $S$ 中选出若干子集 $A_{i,j}\\ (A \\subseteq S$，$1 \\le j \\le i \\le k)$ 排成下面所示边长为 $k$ 的三角形（因此总共选出了 $\\frac{1}{2} k(k+1)$ 个子集）。      \n$$\\begin{matrix}\nA_{1,1}\\\\\nA_{2,1}&A_{2,2}\\\\\nA_{3,1}&A_{3,2}&A_{3,3}\\\\\n\\vdots&\\vdots&\\vdots&\\ddots\\\\\nA_{k,1}&A_{k,2}&A_{k,3}&\\cdots&A_{k,k}\n\\end{matrix}   $$\n\n此外，JYY 对选出的子集之间还有额外的要求：选出的这些子集必须满足\n$A_{i,j} \\subseteq A_{i,j-1}$ 且 $A_{i,j} \\subseteq A_{i-1,j}$。     \nJYY 想知道，求有多少种不同的选取这些子集的方法。因为答案很大，JYY 只关心输出答案模 $1{,}000{,}000{,}007$ 的值。 \n      \n对于两种选取方案 $A = \\left\\{ A_{1,1} , A_{2,1} ,\\cdots, A_{k,k} \\right\\}$ 和 $B = \\left\\{ B_{1,1} , B_{2,1} ,\\cdots, B_{k,k} \\right\\}$ 只要存在 $i,j$ 满足 $A_{i,j} \\neq B_{i,j}$，我们就认为 $A$ 和 $B$ 是不同的方案。   ", "inputFormat": "输入包含一行两个整数 $n$ 和 $k$。", "outputFormat": "一行一个整数，表示不同方案数目模 $1,000,000,007$ 的值。", "hint": "对于 $100\\%$ 的数据，$1 \\le n$，$k \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 子集选取", "background": "", "description": "给定 $n$ 个元素的集合 $S= \\left\\{1,2,\\cdots,n \\right\\}$ 和整数 $ k$，现在要从 $S$ 中选出若干子集 $A_{i,j}\\ (A \\subseteq S$，$1 \\le j \\le i \\le k)$ 排成下面所示边长为 $k$ 的三角形（因此总共选出了 $\\frac{1}{2} k(k+1)$ 个子集）。      \n$$\\begin{matrix}\nA_{1,1}\\\\\nA_{2,1}&A_{2,2}\\\\\nA_{3,1}&A_{3,2}&A_{3,3}\\\\\n\\vdots&\\vdots&\\vdots&\\ddots\\\\\nA_{k,1}&A_{k,2}&A_{k,3}&\\cdots&A_{k,k}\n\\end{matrix}   $$\n\n此外，JYY 对选出的子集之间还有额外的要求：选出的这些子集必须满足\n$A_{i,j} \\subseteq A_{i,j-1}$ 且 $A_{i,j} \\subseteq A_{i-1,j}$。     \nJYY 想知道，求有多少种不同的选取这些子集的方法。因为答案很大，JYY 只关心输出答案模 $1{,}000{,}000{,}007$ 的值。 \n      \n对于两种选取方案 $A = \\left\\{ A_{1,1} , A_{2,1} ,\\cdots, A_{k,k} \\right\\}$ 和 $B = \\left\\{ B_{1,1} , B_{2,1} ,\\cdots, B_{k,k} \\right\\}$ 只要存在 $i,j$ 满足 $A_{i,j} \\neq B_{i,j}$，我们就认为 $A$ 和 $B$ 是不同的方案。   ", "inputFormat": "输入包含一行两个整数 $n$ 和 $k$。", "outputFormat": "一行一个整数，表示不同方案数目模 $1,000,000,007$ 的值。", "hint": "对于 $100\\%$ 的数据，$1 \\le n$，$k \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6076", "type": "P", "difficulty": 5, "samples": [["2 2 3", "60"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2015", "各省省选", "江苏", "容斥原理"], "title": "[JSOI2015] 染色问题", "background": "", "description": "萌萌家有一个棋盘，这个棋盘是一个 $n \\times m$ 的矩形，分成 $n$ 行 $m$ 列共 $n \\times m$ 个小方格。   \n现在萌萌和南南有 $C$ 种不同颜色的颜料，他们希望把棋盘用这些颜料染色，并满足以下规定：   \n\n1. 棋盘的每一个小方格既可以染色（染成 $C$ 种颜色中的一种），也可以不染色。   \n2. 棋盘的每一行至少有一个小方格被染色。   \n3. 棋盘的每一列至少有一个小方格被染色。   \n4. 每种颜色都在棋盘上出现至少一次。  \n \n以下是一些将 $3  \\times 3$ 棋盘染成 $C=3$ 种颜色（红、黄、蓝）的例子（下图已更新）： \n  \n![](https://cdn.luogu.com.cn/upload/image_hosting/7s4j5elx.png)    \n\n请你求出满足要求的不同的染色方案总数。只要存在一个位置的颜色不同，即认为两个染色方案是不同的。", "inputFormat": "输入只有一行，为 $3$ 个整数 $n,m,c$。", "outputFormat": "输出一个整数，为不同染色方案总数。\n因为总数可能很大，只需输出总数对 $1,000,000,007$ 取模的值。", "hint": "对于$100\\%$的数据，$1 \\le n,m,c \\le 400$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 染色问题", "background": "", "description": "萌萌家有一个棋盘，这个棋盘是一个 $n \\times m$ 的矩形，分成 $n$ 行 $m$ 列共 $n \\times m$ 个小方格。   \n现在萌萌和南南有 $C$ 种不同颜色的颜料，他们希望把棋盘用这些颜料染色，并满足以下规定：   \n\n1. 棋盘的每一个小方格既可以染色（染成 $C$ 种颜色中的一种），也可以不染色。   \n2. 棋盘的每一行至少有一个小方格被染色。   \n3. 棋盘的每一列至少有一个小方格被染色。   \n4. 每种颜色都在棋盘上出现至少一次。  \n \n以下是一些将 $3  \\times 3$ 棋盘染成 $C=3$ 种颜色（红、黄、蓝）的例子（下图已更新）： \n  \n![](https://cdn.luogu.com.cn/upload/image_hosting/7s4j5elx.png)    \n\n请你求出满足要求的不同的染色方案总数。只要存在一个位置的颜色不同，即认为两个染色方案是不同的。", "inputFormat": "输入只有一行，为 $3$ 个整数 $n,m,c$。", "outputFormat": "输出一个整数，为不同染色方案总数。\n因为总数可能很大，只需输出总数对 $1,000,000,007$ 取模的值。", "hint": "对于$100\\%$的数据，$1 \\le n,m,c \\le 400$。", "locale": "zh-CN"}}}
{"pid": "P6077", "type": "P", "difficulty": 6, "samples": [["130 340 5\n10 50\n130 130\n70 170\n0 180\n60 260", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "BalticOI（波罗的海）"], "title": "[BalticOI 2007] Escape", "background": "", "description": "战犯们企图逃离监狱，他们详细地计划了如何逃出监狱本身，逃出监狱之后他们希望在附近的一个村子里找到掩护。\n\n村子（下图中的 B）和监狱（图中的 A）中间有一个峡谷，这个峡谷也是有士兵守卫的。守卫峡谷的士兵们坐在岗哨上很少走动，每个士兵的观察范围是 $100$ 米。士兵所处位置决定了战犯们能否安全通过峡谷，安全通过的条件就是在任何时刻战犯们距离最近的士兵大于 $100$ 米。\n\n给定峡谷的长、宽和每个士兵在峡谷中的坐标，假定士兵的位置一直保持不变，请你写一个程序计算战犯们能否不被士兵发现，顺利通过峡谷。\n\n如果不能，那么战犯们最少需要消灭几个士兵才能安全通过峡谷（无论士兵是否被另一个士兵看到，他都可以被消灭）。 \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/59rrua2p.png)", "inputFormat": "第一行有三个整数 $l$，$w$ 和 $n$，分别表示峡谷的长度、宽度和士兵的人数。\n\n接下来的 $n$ 行，每行两个整数 $x_i$ 和 $y_i$，表示第 $i$ 个士兵在峡谷的坐标，坐标以米为单位，峡谷的西南角坐标为 $(0, 0)$，东北角坐标为 $(l, w)$，见上图。\n\n注意：通过峡谷可以从 $(0, ys)$，（其中 $ys$ 满足 $0\\leq ys \\leq w$） 到 $(l, ye)$（其中 $ye$ 满足 $0 \\leq ye \\leq w$），其中 $ys$， $ye$ 不一定是整数。", "outputFormat": "只有一行，为一个整数，即安全通过峡谷需要消灭的士兵的人数，如果不需要消灭任何士兵，则输出 $0$。", "hint": "对于 $100\\%$ 的数据，满足：$1 \\leq w \\leq 5\\cdot 10^4$，$1\\leq l \\leq 5\\cdot 10^4$，$1\\leq n \\leq 250$，$0 \\leq x_i \\leq l$，$0 \\leq y_i \\leq w$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2007] Escape", "background": "", "description": "战犯们企图逃离监狱，他们详细地计划了如何逃出监狱本身，逃出监狱之后他们希望在附近的一个村子里找到掩护。\n\n村子（下图中的 B）和监狱（图中的 A）中间有一个峡谷，这个峡谷也是有士兵守卫的。守卫峡谷的士兵们坐在岗哨上很少走动，每个士兵的观察范围是 $100$ 米。士兵所处位置决定了战犯们能否安全通过峡谷，安全通过的条件就是在任何时刻战犯们距离最近的士兵大于 $100$ 米。\n\n给定峡谷的长、宽和每个士兵在峡谷中的坐标，假定士兵的位置一直保持不变，请你写一个程序计算战犯们能否不被士兵发现，顺利通过峡谷。\n\n如果不能，那么战犯们最少需要消灭几个士兵才能安全通过峡谷（无论士兵是否被另一个士兵看到，他都可以被消灭）。 \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/59rrua2p.png)", "inputFormat": "第一行有三个整数 $l$，$w$ 和 $n$，分别表示峡谷的长度、宽度和士兵的人数。\n\n接下来的 $n$ 行，每行两个整数 $x_i$ 和 $y_i$，表示第 $i$ 个士兵在峡谷的坐标，坐标以米为单位，峡谷的西南角坐标为 $(0, 0)$，东北角坐标为 $(l, w)$，见上图。\n\n注意：通过峡谷可以从 $(0, ys)$，（其中 $ys$ 满足 $0\\leq ys \\leq w$） 到 $(l, ye)$（其中 $ye$ 满足 $0 \\leq ye \\leq w$），其中 $ys$， $ye$ 不一定是整数。", "outputFormat": "只有一行，为一个整数，即安全通过峡谷需要消灭的士兵的人数，如果不需要消灭任何士兵，则输出 $0$。", "hint": "对于 $100\\%$ 的数据，满足：$1 \\leq w \\leq 5\\cdot 10^4$，$1\\leq l \\leq 5\\cdot 10^4$，$1\\leq n \\leq 250$，$0 \\leq x_i \\leq l$，$0 \\leq y_i \\leq w$。", "locale": "zh-CN"}}}
{"pid": "P6078", "type": "P", "difficulty": 6, "samples": [["2 1 3\n3\n5", "9"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2004", "CEOI（中欧）", "组合数学", "生成函数"], "title": "[CEOI 2004] Sweets", "background": "", "description": "John 得到了 $n$ 罐糖果。不同的糖果罐，糖果的种类不同（即同一个糖果罐里的糖果种类是相同的，不同的糖果罐里的糖果的种类是不同的）。第 $i$ 个糖果罐里有 $m_{i}$ 个糖果。John 决定吃掉一些糖果，他想吃掉至少 $a$ 个糖果，但不超过 $b$ 个。问题是 John 无法确定吃多少个糖果和每种糖果各吃几个。有多少种方法可以做这件事呢？  ", "inputFormat": "输入共 $n+1$ 行：\n\n第一行读入 $n$，$a$，$b$。\n\n接下来 $n$ 行，一行一个数，代表 $m_{i}$。", "outputFormat": "仅一行，表示 John 能够选择的满足以上条件的吃掉糖果的方法数，答案对 $2004$ 取模。", "hint": "#### 数据范围及限制\n对于 $100\\%$ 的数据，保证 $1\\leq n \\leq 10$，$0\\leq a \\leq b \\leq 10^7$，$0 \\leq m_{i} \\leq 10^6$。\n\n#### 说明\n本题译自 [Central European Olympiad\nin Informatics 2004](https://www.oi.edu.pl/old/php/ceoi2004.php?module=show&file=news) [Day 1](https://www.oi.edu.pl/old/php/ceoi2004.php?module=show&file=tasks) [T2 Sweets](https://www.oi.edu.pl/old/ceoi2004/problems/swe.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2004] Sweets", "background": "", "description": "John 得到了 $n$ 罐糖果。不同的糖果罐，糖果的种类不同（即同一个糖果罐里的糖果种类是相同的，不同的糖果罐里的糖果的种类是不同的）。第 $i$ 个糖果罐里有 $m_{i}$ 个糖果。John 决定吃掉一些糖果，他想吃掉至少 $a$ 个糖果，但不超过 $b$ 个。问题是 John 无法确定吃多少个糖果和每种糖果各吃几个。有多少种方法可以做这件事呢？  ", "inputFormat": "输入共 $n+1$ 行：\n\n第一行读入 $n$，$a$，$b$。\n\n接下来 $n$ 行，一行一个数，代表 $m_{i}$。", "outputFormat": "仅一行，表示 John 能够选择的满足以上条件的吃掉糖果的方法数，答案对 $2004$ 取模。", "hint": "#### 数据范围及限制\n对于 $100\\%$ 的数据，保证 $1\\leq n \\leq 10$，$0\\leq a \\leq b \\leq 10^7$，$0 \\leq m_{i} \\leq 10^6$。\n\n#### 说明\n本题译自 [Central European Olympiad\nin Informatics 2004](https://www.oi.edu.pl/old/php/ceoi2004.php?module=show&file=news) [Day 1](https://www.oi.edu.pl/old/php/ceoi2004.php?module=show&file=tasks) [T2 Sweets](https://www.oi.edu.pl/old/ceoi2004/problems/swe.pdf)。", "locale": "zh-CN"}}}
{"pid": "P6079", "type": "P", "difficulty": 4, "samples": [["5 8\n-1 0\n3 1\n5 1\n-3 3\n2 0", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2006", "USACO"], "title": "[USACO06MAR] Milk Team Select G", "background": "", "description": "Farmer John 的 $N(1 \\le N \\le 500)$ 头奶牛打算参加一场世界级的产奶比赛 （Multistate Milking Match-up，MMM），他们已经摸清了其他队的实力。他们的总产奶量只要大于等于 $X$ 加仑（$1 \\leq X \\leq 10^6$），就能赢得胜利。\n\n每头奶牛都能为全队贡献一定量的牛奶，数值在 $-10^4$ 到 $10^4$ 加仑之间（为啥有负数？因为有些奶牛会打翻其他奶牛产的牛奶）。\n\nMMM 的目标是通过合作，增进家庭成员间的默契。为了支持比赛精神，奶牛们希望在赢得比赛的前提下，有尽可能多对奶牛间存在直系血缘关系。当然，所有奶牛都是女性，因此这里的直系血缘关系就是母女关系。\n\n现在 FJ 摸清了所有奶牛间的血缘关系，希望算出一个团队在赢得胜利的前提下，最多有多少对奶牛存在血缘关系。注意：如果一个团队由某头奶牛和她的母亲和外祖母组成的话，这个团队只有两对血缘关系（她和她的母亲，她的母亲和外祖母）。", "inputFormat": "第一行两个整数 $N,X$。\n\n接下来 $N$ 行，每行两个整数，第一个整数是它能为团队贡献的产奶量，第二个整数为它的母亲的编号，如果她的母亲不在牛群里，这个数字为 $0$。\n\n保证血缘关系不会出现环。", "outputFormat": "输出在获胜的前提下，一个团队中最多存在多少血缘关系。\n\n特别地，如果不存在一个团队能获胜，输出 $-1$。", "hint": "最优的队伍包含 $1,2,3,5$ 这四头奶牛，总产奶量为 $9$ 加仑，共有两对血缘关系（$1,2$ 和 $1,3$）。\n\n虽然 $2,3,5$ 这个组合产奶量更大，但是这个组合里没有血缘关系。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06MAR] Milk Team Select G", "background": "", "description": "Farmer John 的 $N(1 \\le N \\le 500)$ 头奶牛打算参加一场世界级的产奶比赛 （Multistate Milking Match-up，MMM），他们已经摸清了其他队的实力。他们的总产奶量只要大于等于 $X$ 加仑（$1 \\leq X \\leq 10^6$），就能赢得胜利。\n\n每头奶牛都能为全队贡献一定量的牛奶，数值在 $-10^4$ 到 $10^4$ 加仑之间（为啥有负数？因为有些奶牛会打翻其他奶牛产的牛奶）。\n\nMMM 的目标是通过合作，增进家庭成员间的默契。为了支持比赛精神，奶牛们希望在赢得比赛的前提下，有尽可能多对奶牛间存在直系血缘关系。当然，所有奶牛都是女性，因此这里的直系血缘关系就是母女关系。\n\n现在 FJ 摸清了所有奶牛间的血缘关系，希望算出一个团队在赢得胜利的前提下，最多有多少对奶牛存在血缘关系。注意：如果一个团队由某头奶牛和她的母亲和外祖母组成的话，这个团队只有两对血缘关系（她和她的母亲，她的母亲和外祖母）。", "inputFormat": "第一行两个整数 $N,X$。\n\n接下来 $N$ 行，每行两个整数，第一个整数是它能为团队贡献的产奶量，第二个整数为它的母亲的编号，如果她的母亲不在牛群里，这个数字为 $0$。\n\n保证血缘关系不会出现环。", "outputFormat": "输出在获胜的前提下，一个团队中最多存在多少血缘关系。\n\n特别地，如果不存在一个团队能获胜，输出 $-1$。", "hint": "最优的队伍包含 $1,2,3,5$ 这四头奶牛，总产奶量为 $9$ 加仑，共有两对血缘关系（$1,2$ 和 $1,3$）。\n\n虽然 $2,3,5$ 这个组合产奶量更大，但是这个组合里没有血缘关系。", "locale": "zh-CN"}}}
{"pid": "P6080", "type": "P", "difficulty": 6, "samples": [["9 6 10\n5\n6\n2\n10\n10\n7\n3\n2\n9\n1\n4\n4\n3\n2\n1", "1\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO"], "title": "[USACO05DEC] Cow Patterns G", "background": "", "description": "Farmer John 的 $N$（$1 \\leq N \\leq 10^5$）头奶牛中出现了 $K$（$1 \\leq K \\leq 25000$）只坏蛋！这些坏蛋在奶牛排队的时候总站在一起。现在你需要帮助 FJ 找出他们。\n\n为了区分，FJ 给每头奶牛发了号牌，上面写着一个 $1 \\ldots S$ 之间的数字（$1 \\leq S \\leq 25$），虽然这不是个完美的方法，但也有一定作用。现在 FJ 记不得坏蛋们的具体号码，但他给出了一个模式串。原坏蛋的号码相同，模式串中的号码依旧相同，模式串中坏蛋号码的大小关系也和原号码相同。\n\n例如模式串：$1,4,4,3,2,1$，原来的 $6$ 只坏蛋，最前面和最后面的号码相等且最小（不一定是 $1$），位置 $2,3$ 的坏蛋号码相同且最大（不一定是 $4$）。\n\n现在有这样一个队列：$5, 6, 2, 10, 10, 7, 3, 2, 9$，它的子串 $2, 10, 10, 7, 3, 2$ 匹配模式串的相等关系和大小关系，这就可能是一个坏蛋团伙。\n\n请找出所有团伙的可能情况。 ", "inputFormat": "第一行三个整数 $N,K,S$。\n\n接下来 $N$ 行，每行一个整数，代表第 $i$ 奶牛的编号。\n\n接下来 $K$ 行，每行一个整数，表示模式串中第 $i$ 个位置的号码。", "outputFormat": "第一行输出一个整数 $B$。\n\n接下来 $B$ 行，每行一个整数，为一种可能的坏蛋团伙的起始位置。\n\n所有位置按升序输出。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05DEC] Cow Patterns G", "background": "", "description": "Farmer John 的 $N$（$1 \\leq N \\leq 10^5$）头奶牛中出现了 $K$（$1 \\leq K \\leq 25000$）只坏蛋！这些坏蛋在奶牛排队的时候总站在一起。现在你需要帮助 FJ 找出他们。\n\n为了区分，FJ 给每头奶牛发了号牌，上面写着一个 $1 \\ldots S$ 之间的数字（$1 \\leq S \\leq 25$），虽然这不是个完美的方法，但也有一定作用。现在 FJ 记不得坏蛋们的具体号码，但他给出了一个模式串。原坏蛋的号码相同，模式串中的号码依旧相同，模式串中坏蛋号码的大小关系也和原号码相同。\n\n例如模式串：$1,4,4,3,2,1$，原来的 $6$ 只坏蛋，最前面和最后面的号码相等且最小（不一定是 $1$），位置 $2,3$ 的坏蛋号码相同且最大（不一定是 $4$）。\n\n现在有这样一个队列：$5, 6, 2, 10, 10, 7, 3, 2, 9$，它的子串 $2, 10, 10, 7, 3, 2$ 匹配模式串的相等关系和大小关系，这就可能是一个坏蛋团伙。\n\n请找出所有团伙的可能情况。 ", "inputFormat": "第一行三个整数 $N,K,S$。\n\n接下来 $N$ 行，每行一个整数，代表第 $i$ 奶牛的编号。\n\n接下来 $K$ 行，每行一个整数，表示模式串中第 $i$ 个位置的号码。", "outputFormat": "第一行输出一个整数 $B$。\n\n接下来 $B$ 行，每行一个整数，为一种可能的坏蛋团伙的起始位置。\n\n所有位置按升序输出。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6081", "type": "P", "difficulty": 4, "samples": [["5\n0 2 2 7\n3 5 5 8\n4 2 6 4\n6 1 8 6\n0 0 8 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO"], "title": "[USACO05DEC] Barn Expansion G", "background": "", "description": "Farmer John 有 $N$（$1 \\leq N \\leq 25000$）个矩形牛棚，它们的墙与坐标轴平行，且坐标在 $[0,10^6]$ 范围内。保证任意两个牛棚不重叠，但可能有公共的墙。\n\n由于奶牛数量不断增加，FJ 打算扩张牛棚。一个牛棚是可以扩张的，当且仅当它的墙与其他牛棚的墙没有公共部分。如果两个牛棚有一个公共角，这两个牛棚均不可扩张。\n\n请你求出有多少牛棚是可以扩张的。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行四个整数，分别代表牛棚左下角坐标和右上角坐标。", "outputFormat": "输出可以扩张的牛棚数量。", "hint": "前两个牛棚可以扩张。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05DEC] Barn Expansion G", "background": "", "description": "Farmer John 有 $N$（$1 \\leq N \\leq 25000$）个矩形牛棚，它们的墙与坐标轴平行，且坐标在 $[0,10^6]$ 范围内。保证任意两个牛棚不重叠，但可能有公共的墙。\n\n由于奶牛数量不断增加，FJ 打算扩张牛棚。一个牛棚是可以扩张的，当且仅当它的墙与其他牛棚的墙没有公共部分。如果两个牛棚有一个公共角，这两个牛棚均不可扩张。\n\n请你求出有多少牛棚是可以扩张的。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行四个整数，分别代表牛棚左下角坐标和右上角坐标。", "outputFormat": "输出可以扩张的牛棚数量。", "hint": "前两个牛棚可以扩张。", "locale": "zh-CN"}}}
{"pid": "P6082", "type": "P", "difficulty": 4, "samples": [["9\n-3 -4 2 4 -2 3 4 6\n4 4 2 2 2 2 2 2\n1 2\n1 3\n1 4\n2 5\n2 6\n3 7\n4 8\n4 9", "9\nsolution is unique"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2015", "各省省选", "江苏"], "title": "[JSOI2015] salesman", "background": "", "description": "某售货员小 T 要到若干城镇去推销商品,由于该地区是交通不便的山区，任意两个城镇之间都只有唯一的可能经过其它城镇的路线。 小 T 可以准确地估计出在每个城镇停留的净收益。这些净收益可能是负数，即推销商品的利润抵不上花费。由于交通不便，小 T 经过每个城镇都需要停留，在每个城镇的停留次数与在该地的净收益无关，因为很多费用不是计次收取的，而每个城镇对小 T 的商品需求也是相对固定的，停留一次后就饱和了。每个城镇为了强化治安，对外地人的最多停留次数有严格的规定。\n\n请你帮小 T 设计一个收益最大的巡回方案,即从家乡出发，在经过的每个城镇停留，最后回到家乡的旅行方案。你的程序只需输出最大收益，以及最优方案是否唯一。方案并不包括路线的细节，方案相同的标准是选择经过并停留的城镇是否相同。因为取消巡回也是一种方案，因此最大收益不会是负数。小 T 在家乡净收益是零，因为在家乡是本地人，家乡对小 T 当然没有停留次数的限制。", "inputFormat": "输入的第一行是一个正整数 $n$，表示城镇数目。城镇以 $1$ 到 $n$ 的数命名。小 T 的家乡命名为 $1$。\n\n第二行和第三行都包含以空格隔开的 $n-1$ 个整数。第二行的第 $i$ 个数表示在城镇 $i+1$ 停留的净收益。第三行的第 $i$ 个数表示城镇 $i+1$ 规定的最大停留次数。所有的最大停留次数都不小于 $2$。\n\n接下来的 $n-1$ 行，每行两个 $1$ 到 $n$ 的正整数 $x,y$，之间以一个空格\n隔开，表示 $x,y$ 之间有一条不经过其它城镇的双向道路。输入数据保证所有城镇是连通的。 ", "outputFormat": "输出有两行。第一行包含一个自然数，表示巡回旅行的最大收益。如果该方案唯一，在第二行输出 `solution is unique`，否则在第二行输出 `solution is not unique`。", "hint": "#### 样例说明\n\n最佳路线包括城镇 $1,2,4,5,9$。\n\n---\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$5\\leq n\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] salesman", "background": "", "description": "某售货员小 T 要到若干城镇去推销商品,由于该地区是交通不便的山区，任意两个城镇之间都只有唯一的可能经过其它城镇的路线。 小 T 可以准确地估计出在每个城镇停留的净收益。这些净收益可能是负数，即推销商品的利润抵不上花费。由于交通不便，小 T 经过每个城镇都需要停留，在每个城镇的停留次数与在该地的净收益无关，因为很多费用不是计次收取的，而每个城镇对小 T 的商品需求也是相对固定的，停留一次后就饱和了。每个城镇为了强化治安，对外地人的最多停留次数有严格的规定。\n\n请你帮小 T 设计一个收益最大的巡回方案,即从家乡出发，在经过的每个城镇停留，最后回到家乡的旅行方案。你的程序只需输出最大收益，以及最优方案是否唯一。方案并不包括路线的细节，方案相同的标准是选择经过并停留的城镇是否相同。因为取消巡回也是一种方案，因此最大收益不会是负数。小 T 在家乡净收益是零，因为在家乡是本地人，家乡对小 T 当然没有停留次数的限制。", "inputFormat": "输入的第一行是一个正整数 $n$，表示城镇数目。城镇以 $1$ 到 $n$ 的数命名。小 T 的家乡命名为 $1$。\n\n第二行和第三行都包含以空格隔开的 $n-1$ 个整数。第二行的第 $i$ 个数表示在城镇 $i+1$ 停留的净收益。第三行的第 $i$ 个数表示城镇 $i+1$ 规定的最大停留次数。所有的最大停留次数都不小于 $2$。\n\n接下来的 $n-1$ 行，每行两个 $1$ 到 $n$ 的正整数 $x,y$，之间以一个空格\n隔开，表示 $x,y$ 之间有一条不经过其它城镇的双向道路。输入数据保证所有城镇是连通的。 ", "outputFormat": "输出有两行。第一行包含一个自然数，表示巡回旅行的最大收益。如果该方案唯一，在第二行输出 `solution is unique`，否则在第二行输出 `solution is not unique`。", "hint": "#### 样例说明\n\n最佳路线包括城镇 $1,2,4,5,9$。\n\n---\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$5\\leq n\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P6083", "type": "P", "difficulty": 5, "samples": [["5\n11100\n11000\n10111\n11000\n11100", "2 2 3 3 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "二分", "各省省选", "江苏", "哈希 hashing"], "title": "[JSOI2015] symmetry", "background": "", "description": "张老师正在课堂上讲解正方形的对称模式。为了简单起见，他用 $01$ 方阵代表一个正方形图形，即把正方形分解成 $n\\times n$ 的方格阵，$0$ 代表一个白色方格，$1$ 代表一个黑色方格。\n\n首先讲到的是容易辨别的轴对称，正方形有 $4$ 个对称轴，分别是水平中线，竖直中线和两条对角线。如果一个正方形图形以某个对称轴做反射变换后保持不变，就称为轴对称图形。例如下面的两个图形都是轴对称图形。\n\n```plain\n100  010\n100  101\n111  000\n```\n\n张老师继续讲解正方形的旋转对称。如果一个正方形图形以中心点旋转 $180$ 度后保持不变，就称为 $180$ 度对称图形。如果以中心点顺时针旋转 $90$ 度后保持不变，就称为 $90$ 度对称图形，例如下面的两个图形左边是 $180$ 度对称图形，右边是 $90$ 度对称图形。\n\n```plain\n0011  1011\n1110  1110\n0111  0111\n1100  1101\n```\n\n张老师接着说，如果一个正方形图形具有两个互相垂直的对称轴，就称为 $4$ 对称图形，如果关于 $4$ 个对称轴全部对称，就称为 $8$ 对称图形。按照定义，$90$ 度对称图形也是 $180$ 度对称图形，$8$ 对称图形也是 $4$ 对称图形。当正方形图形的边长为偶数时，该图形的中心是最中间 $4$ 个方格的公共顶点，当正方形图形的边长为奇数时，该图形有一个中心方格，该图\n形的中心也是它的中心方格的中心。边长为 $1$ 的图形显然是 $8$ 对称图形。\n\n张老师给学生证明了两个定理。\n\n- 定理 $1$：一个正方形图形是 $4$ 对称图形当且仅对它是 $180$ 度对称图形和轴对称图形。\n- 定理 $2$：一个正方形图形是 $8$ 对称图形当且仅对它是 $90$ 度对称图形和轴对称图形。\n\n最后是练习时间，张老师要求学生寻找在大正方形图形中出现的各种对称图形。请你编程实现这个要求。设输入一个 $01$ 方阵，输出满足 $8$ 对称，$90$ 度对称，$4$ 对称，$180$ 度对称和轴对称的最大子连续方阵的边长。子连续方阵是指选择若干相邻行列的子方阵，代表在大图形中出现的小图形。", "inputFormat": "输入的第一行是一个正整数 $n$，表示大正方形图形的边长。然后是 $n$ 行长度为 $n$ 的 $01$ 字符串。", "outputFormat": "输出有一行，包含 $5$ 个以空格隔开的自然数，分别表示在输入中出现的最大 $8$ 对称，$90$ 度对称，$4$ 对称，$180$ 度对称和轴对称的子连续方阵的行数。", "hint": "#### 样例说明\n\n大图形有水平对称轴，左上角有一个 $2\\times 2$ 的 $8$ 对称图形，中间 $3$ 行最右 $3$ 列构成 $4$ 对称图形。\n\n---\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$5\\leq n\\leq 500$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] symmetry", "background": "", "description": "张老师正在课堂上讲解正方形的对称模式。为了简单起见，他用 $01$ 方阵代表一个正方形图形，即把正方形分解成 $n\\times n$ 的方格阵，$0$ 代表一个白色方格，$1$ 代表一个黑色方格。\n\n首先讲到的是容易辨别的轴对称，正方形有 $4$ 个对称轴，分别是水平中线，竖直中线和两条对角线。如果一个正方形图形以某个对称轴做反射变换后保持不变，就称为轴对称图形。例如下面的两个图形都是轴对称图形。\n\n```plain\n100  010\n100  101\n111  000\n```\n\n张老师继续讲解正方形的旋转对称。如果一个正方形图形以中心点旋转 $180$ 度后保持不变，就称为 $180$ 度对称图形。如果以中心点顺时针旋转 $90$ 度后保持不变，就称为 $90$ 度对称图形，例如下面的两个图形左边是 $180$ 度对称图形，右边是 $90$ 度对称图形。\n\n```plain\n0011  1011\n1110  1110\n0111  0111\n1100  1101\n```\n\n张老师接着说，如果一个正方形图形具有两个互相垂直的对称轴，就称为 $4$ 对称图形，如果关于 $4$ 个对称轴全部对称，就称为 $8$ 对称图形。按照定义，$90$ 度对称图形也是 $180$ 度对称图形，$8$ 对称图形也是 $4$ 对称图形。当正方形图形的边长为偶数时，该图形的中心是最中间 $4$ 个方格的公共顶点，当正方形图形的边长为奇数时，该图形有一个中心方格，该图\n形的中心也是它的中心方格的中心。边长为 $1$ 的图形显然是 $8$ 对称图形。\n\n张老师给学生证明了两个定理。\n\n- 定理 $1$：一个正方形图形是 $4$ 对称图形当且仅对它是 $180$ 度对称图形和轴对称图形。\n- 定理 $2$：一个正方形图形是 $8$ 对称图形当且仅对它是 $90$ 度对称图形和轴对称图形。\n\n最后是练习时间，张老师要求学生寻找在大正方形图形中出现的各种对称图形。请你编程实现这个要求。设输入一个 $01$ 方阵，输出满足 $8$ 对称，$90$ 度对称，$4$ 对称，$180$ 度对称和轴对称的最大子连续方阵的边长。子连续方阵是指选择若干相邻行列的子方阵，代表在大图形中出现的小图形。", "inputFormat": "输入的第一行是一个正整数 $n$，表示大正方形图形的边长。然后是 $n$ 行长度为 $n$ 的 $01$ 字符串。", "outputFormat": "输出有一行，包含 $5$ 个以空格隔开的自然数，分别表示在输入中出现的最大 $8$ 对称，$90$ 度对称，$4$ 对称，$180$ 度对称和轴对称的子连续方阵的行数。", "hint": "#### 样例说明\n\n大图形有水平对称轴，左上角有一个 $2\\times 2$ 的 $8$ 对称图形，中间 $3$ 行最右 $3$ 列构成 $4$ 对称图形。\n\n---\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$5\\leq n\\leq 500$。", "locale": "zh-CN"}}}
{"pid": "P6084", "type": "P", "difficulty": 6, "samples": [["2\n4\n1 4\n2 4\n3 4\n5\n1 3\n2 3\n3 4\n4 5", "1\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "江苏", "哈希 hashing"], "title": "[JSOI2015] isomorphism", "background": "", "description": "一个无向树的度数为 $2$ 的结点称为假结点，其它结点称为真结点。一个无向树的简化树其结点由原树的全体真结点组成，两个真结点之间有边当且仅当它们在原树中有边，或者在原树中有一条联结这两个结点的路，其中间节点全是假结点。两个无向树各自的简化树如果同构，即存在结点之间的一一对应，使得在一个树中的任意两个结点之间有边当且仅当它们的对应结点在另一个树中有边，则称原来的两个无向树实质同构。\n\n给定若干个无向树，将相互实质同构的无向树只保留一个其余删除。统计剩下的相互不实质同构的无向树个数，并将它们的简化树结点个数从小到大输出。", "inputFormat": "第一行只有一个正整数 $m$。\n\n后面依次输入 $m$ 棵无向树，每棵无向树先用一行输入结点个数 $n$，结点就用 $1$ 到 $n$ 表示，然后用 $n-1$ 行输入 $n-1$ 条无向边，每行有两个 $1$ 到 $n$  之间的不同的正整数，用一个空格隔开，代表这两个结点之间有无向边。两棵树之间无空行。\n", "outputFormat": "第一行输出一个正整数，即输入中不计实质同构包含无向树的个数 $m_0\\ (1\\leq m_0\\leq m)$。\n\n第二行包含不严格递增的 $m_0$ 个正整数，表示这 $m_0$ 棵无向树的简化树结点个数。相邻两数用一个空格隔开。", "hint": "#### 数据范围\n\n对于 $100\\%$ 的数据，$2\\leq m\\leq 20, 2\\leq n\\leq 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] isomorphism", "background": "", "description": "一个无向树的度数为 $2$ 的结点称为假结点，其它结点称为真结点。一个无向树的简化树其结点由原树的全体真结点组成，两个真结点之间有边当且仅当它们在原树中有边，或者在原树中有一条联结这两个结点的路，其中间节点全是假结点。两个无向树各自的简化树如果同构，即存在结点之间的一一对应，使得在一个树中的任意两个结点之间有边当且仅当它们的对应结点在另一个树中有边，则称原来的两个无向树实质同构。\n\n给定若干个无向树，将相互实质同构的无向树只保留一个其余删除。统计剩下的相互不实质同构的无向树个数，并将它们的简化树结点个数从小到大输出。", "inputFormat": "第一行只有一个正整数 $m$。\n\n后面依次输入 $m$ 棵无向树，每棵无向树先用一行输入结点个数 $n$，结点就用 $1$ 到 $n$ 表示，然后用 $n-1$ 行输入 $n-1$ 条无向边，每行有两个 $1$ 到 $n$  之间的不同的正整数，用一个空格隔开，代表这两个结点之间有无向边。两棵树之间无空行。\n", "outputFormat": "第一行输出一个正整数，即输入中不计实质同构包含无向树的个数 $m_0\\ (1\\leq m_0\\leq m)$。\n\n第二行包含不严格递增的 $m_0$ 个正整数，表示这 $m_0$ 棵无向树的简化树结点个数。相邻两数用一个空格隔开。", "hint": "#### 数据范围\n\n对于 $100\\%$ 的数据，$2\\leq m\\leq 20, 2\\leq n\\leq 10^4$。", "locale": "zh-CN"}}}
{"pid": "P6085", "type": "P", "difficulty": 6, "samples": [["6 3\n1 2 1000\n2 3 1000\n4 5 500\n2\n1 4 300\n3 5 300", "3100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "江苏"], "title": "[JSOI2013] 吃货 JYY", "background": "作为 JSOI 的著名吃货，JYY 的理想之一就是吃遍全世界的美食。要走遍全世界当然需要不断的坐飞机了。而不同的航班上所提供的餐食是很不一样的：比如中国的航班会提供中餐，英国的航班有奶茶和蛋糕，澳大利亚的航班有海鲜，新加坡的航班会有冰激凌……\n\nJYY 选出了一些他特别希望品尝餐食的航班，希望制定一个花费最少的旅游计划，能够从南京出发，乘坐所有这些航班并最后回到南京。", "description": "世界上一共有 $N$ 个 JYY 愿意去的城市，分别从 $1$ 编号到 $N$。JYY 选出了 $K$ 个他一定要乘坐的航班。除此之外，还有 $M$ 个 JYY 没有特别的偏好，可以乘坐也可以不乘坐的航班。\n\n一个航班我们用一个三元组 $(x,y,z)$ 来表示，意义是这趟航班连接城市 $x$ 和 $y$，并且机票费用是 $z$。每个航班都是往返的，所以 JYY 花费 $z$ 的钱，既可以选择从 $x$ 飞往 $y$，也可以选择从 $y$ 飞往 $x$。\n\n南京的编号是 $1$，现在 JYY 打算从南京出发，乘坐所有 K 个航班，并且最后回到南京，请你帮他求出最小的花费。\n", "inputFormat": "输入数据的第一行包含两个整数 $N$ 和 $K$。\n\n接下来 $K$ 行，每行三个整数 $x,y,z$ 描述必须乘坐的航班的信息，数据保证在这 $K$ 个航班中，不会有两个不同的航班在同一对城市之间执飞。\n\n第 $K+2$ 行包含一个整数 $M$，接下来 $M$ 行，每行三个整数 $x,y,z$ 描述可以乘坐也可以不乘坐的航班信息。", "outputFormat": "输出一行一个整数，表示最少的花费。数据保证一定存在满足 JYY 要求的旅行方案。", "hint": "### 样例解释\n\n一个可行的最佳方案为 $1\\rightarrow 2\\rightarrow 3\\rightarrow 5\\rightarrow 4\\rightarrow 1$。\n\n机票所需的费用为 $1000+1000+300+500+300=3100$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$2\\leq N\\leq 13,0\\leq K\\leq 78,2\\leq M\\leq 200,1\\leq x,y\\leq N,1\\leq z\\leq 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2013] 吃货 JYY", "background": "作为 JSOI 的著名吃货，JYY 的理想之一就是吃遍全世界的美食。要走遍全世界当然需要不断的坐飞机了。而不同的航班上所提供的餐食是很不一样的：比如中国的航班会提供中餐，英国的航班有奶茶和蛋糕，澳大利亚的航班有海鲜，新加坡的航班会有冰激凌……\n\nJYY 选出了一些他特别希望品尝餐食的航班，希望制定一个花费最少的旅游计划，能够从南京出发，乘坐所有这些航班并最后回到南京。", "description": "世界上一共有 $N$ 个 JYY 愿意去的城市，分别从 $1$ 编号到 $N$。JYY 选出了 $K$ 个他一定要乘坐的航班。除此之外，还有 $M$ 个 JYY 没有特别的偏好，可以乘坐也可以不乘坐的航班。\n\n一个航班我们用一个三元组 $(x,y,z)$ 来表示，意义是这趟航班连接城市 $x$ 和 $y$，并且机票费用是 $z$。每个航班都是往返的，所以 JYY 花费 $z$ 的钱，既可以选择从 $x$ 飞往 $y$，也可以选择从 $y$ 飞往 $x$。\n\n南京的编号是 $1$，现在 JYY 打算从南京出发，乘坐所有 K 个航班，并且最后回到南京，请你帮他求出最小的花费。\n", "inputFormat": "输入数据的第一行包含两个整数 $N$ 和 $K$。\n\n接下来 $K$ 行，每行三个整数 $x,y,z$ 描述必须乘坐的航班的信息，数据保证在这 $K$ 个航班中，不会有两个不同的航班在同一对城市之间执飞。\n\n第 $K+2$ 行包含一个整数 $M$，接下来 $M$ 行，每行三个整数 $x,y,z$ 描述可以乘坐也可以不乘坐的航班信息。", "outputFormat": "输出一行一个整数，表示最少的花费。数据保证一定存在满足 JYY 要求的旅行方案。", "hint": "### 样例解释\n\n一个可行的最佳方案为 $1\\rightarrow 2\\rightarrow 3\\rightarrow 5\\rightarrow 4\\rightarrow 1$。\n\n机票所需的费用为 $1000+1000+300+500+300=3100$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$2\\leq N\\leq 13,0\\leq K\\leq 78,2\\leq M\\leq 200,1\\leq x,y\\leq N,1\\leq z\\leq 10^4$。", "locale": "zh-CN"}}}
{"pid": "P6086", "type": "P", "difficulty": 5, "samples": [["6 1\n3 6 4 6 1", "29"], ["6 2\n4 6 5 2", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "Prüfer 序列", "模板题"], "title": "【模板】Prüfer(Prufer) 序列", "background": "Prüfer 序列又写作 Prufer 序列。", "description": "请实现 Prüfer 序列和无根树的相互转化。\n\n为方便你实现代码，尽管是无根树，我们在读入时仍将 $n$ 设为其根。\n\n对于一棵无根树，设 $f_{1\\dots n-1}$ 为其**父亲序列**（$f_i$ 表示 $i$ 在 $n$ 为根时的父亲），设 $p_{1 \\dots n-2}$ 为其 **Prüfer 序列**。\n\n另外，对于一个长度为 $m$ 的序列 $a_{1 \\dots m}$，我们设其**权值**为 $\\operatorname{xor}_{i = 1}^m i \\times a_i$。", "inputFormat": "第一行两个整数 $n,m$，表示树的点数和转化类型。\n\n若 $m = 1$，第二行一行 $n-1$ 个整数，表示父亲序列。  \n若 $m = 2$，第二行一行 $n-2$ 个整数，表示 Prüfer 序列。", "outputFormat": "若 $m = 1$，一行一个整数，表示给出的父亲序列对应的 Prüfer 序列的权值。  \n若 $m = 2$，一行一个整数，表示给出的 Prüfer 序列对应的父亲序列的权值。", "hint": "**【样例 1 解释】**\n\n$p = \\{6\\ 1\\ 3\\ 4\\}$。\n\n**【样例 2 解释】**\n\n$f = \\{4\\ 6\\ 6\\ 5\\ 2\\}$。\n\n---\n\n**【数据范围】**\n\n| 测试点编号 | $2 \\le n \\le $  | $m = $ |\n| :--------: | :-------------: | :----: |\n|    $1$     |     $10^3$      |  $1$   |\n|    $2$     |     $10^5$      |  $1$   |\n|    $3$     |     $10^5$      |  $1$   |\n|    $4$     | $5 \\times 10^6$ |  $1$   |\n|    $5$     | $5 \\times 10^6$ |  $1$   |\n|    $6$     |     $10^3$      |  $2$   |\n|    $7$     |     $10^5$      |  $2$   |\n|    $8$     |     $10^5$      |  $2$   |\n|    $9$     | $5 \\times 10^6$ |  $2$   |\n|    $10$    | $5 \\times 10^6$ |  $2$   |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】Prüfer(Prufer) 序列", "background": "Prüfer 序列又写作 Prufer 序列。", "description": "请实现 Prüfer 序列和无根树的相互转化。\n\n为方便你实现代码，尽管是无根树，我们在读入时仍将 $n$ 设为其根。\n\n对于一棵无根树，设 $f_{1\\dots n-1}$ 为其**父亲序列**（$f_i$ 表示 $i$ 在 $n$ 为根时的父亲），设 $p_{1 \\dots n-2}$ 为其 **Prüfer 序列**。\n\n另外，对于一个长度为 $m$ 的序列 $a_{1 \\dots m}$，我们设其**权值**为 $\\operatorname{xor}_{i = 1}^m i \\times a_i$。", "inputFormat": "第一行两个整数 $n,m$，表示树的点数和转化类型。\n\n若 $m = 1$，第二行一行 $n-1$ 个整数，表示父亲序列。  \n若 $m = 2$，第二行一行 $n-2$ 个整数，表示 Prüfer 序列。", "outputFormat": "若 $m = 1$，一行一个整数，表示给出的父亲序列对应的 Prüfer 序列的权值。  \n若 $m = 2$，一行一个整数，表示给出的 Prüfer 序列对应的父亲序列的权值。", "hint": "**【样例 1 解释】**\n\n$p = \\{6\\ 1\\ 3\\ 4\\}$。\n\n**【样例 2 解释】**\n\n$f = \\{4\\ 6\\ 6\\ 5\\ 2\\}$。\n\n---\n\n**【数据范围】**\n\n| 测试点编号 | $2 \\le n \\le $  | $m = $ |\n| :--------: | :-------------: | :----: |\n|    $1$     |     $10^3$      |  $1$   |\n|    $2$     |     $10^5$      |  $1$   |\n|    $3$     |     $10^5$      |  $1$   |\n|    $4$     | $5 \\times 10^6$ |  $1$   |\n|    $5$     | $5 \\times 10^6$ |  $1$   |\n|    $6$     |     $10^3$      |  $2$   |\n|    $7$     |     $10^5$      |  $2$   |\n|    $8$     |     $10^5$      |  $2$   |\n|    $9$     | $5 \\times 10^6$ |  $2$   |\n|    $10$    | $5 \\times 10^6$ |  $2$   |", "locale": "zh-CN"}}}
{"pid": "P6087", "type": "P", "difficulty": 6, "samples": [["1\n5 1 2 4\n1 2 3 4 5", "0.7500"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "二分", "各省省选", "单调队列", "江苏", "分数规划"], "title": "[JSOI2015] 送礼物", "background": "JYY 和 CX 的结婚纪念日即将到来，JYY 来到萌萌开的礼品店选购纪念礼物。\n\n萌萌的礼品店很神奇，所有出售的礼物都按照特定的顺序都排成一列，而且相邻\n的礼物之间有一种神秘的美感。于是，JYY 决定从中挑选连续的一些礼物，但究\n竟选哪些呢？", "description": "假设礼品店一共有 $N$ 件礼物排成一列，每件礼物都有它的美观度。排在第 $i\\ (1\\leq i\\leq N)$ 个位置的礼物美观度为正整数 $A_i$。JYY 决定选出其中连续的一段，即编号为 $i,i+1,\\cdots,j-1,j$ 的礼物。选出这些礼物的美观程度定义为\n\n$$\\frac{M(i,j)-m(i,j)}{j-i+K}$$\n\n其中 $M(i,j)$ 表示 $\\max\\{A_i,A_{i+1},\\cdots,A_j\\}$，$m(i,j)$ 表示 $\\min\\{A_i,A_{i+1},\\cdots,A_j\\}$，$K$ 为给定的正整数。\n由于不能显得太小气，所以 JYY 所选礼物的件数最少为 $L$ 件；同时，选得太多也不好拿，因此礼物最多选 $R$ 件。JYY 应该如何选择，才能得到最大的美观程度？由于礼物实在太多挑花眼，JYY 打算把这个问题交给会编程的你。\n\n", "inputFormat": "**本题每个测试点有多组数据。**\n\n输入第一行包含一个正整数 $T$，表示有 $T$ 组数据。\n\n每组数据包含两行。第一行四个非负整数 $N,K,L,R$。第二行包含 $N$ 个正整数，依次表示 $A_1,A_2,\\cdots,A_n$。", "outputFormat": "输出 $T$ 行，每行一个非负实数，依次对应每组数据的答案，数据保证答案不\n会超过 $10^3$。输出四舍五入保留 $4$ 位小数。", "hint": "对于 $100\\%$ 的数据，$T\\leq 10$，$N,K\\leq 5\\times 10^4$，$1\\leq A_i\\leq 10^8$，$2\\leq L,R\\leq N$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 送礼物", "background": "JYY 和 CX 的结婚纪念日即将到来，JYY 来到萌萌开的礼品店选购纪念礼物。\n\n萌萌的礼品店很神奇，所有出售的礼物都按照特定的顺序都排成一列，而且相邻\n的礼物之间有一种神秘的美感。于是，JYY 决定从中挑选连续的一些礼物，但究\n竟选哪些呢？", "description": "假设礼品店一共有 $N$ 件礼物排成一列，每件礼物都有它的美观度。排在第 $i\\ (1\\leq i\\leq N)$ 个位置的礼物美观度为正整数 $A_i$。JYY 决定选出其中连续的一段，即编号为 $i,i+1,\\cdots,j-1,j$ 的礼物。选出这些礼物的美观程度定义为\n\n$$\\frac{M(i,j)-m(i,j)}{j-i+K}$$\n\n其中 $M(i,j)$ 表示 $\\max\\{A_i,A_{i+1},\\cdots,A_j\\}$，$m(i,j)$ 表示 $\\min\\{A_i,A_{i+1},\\cdots,A_j\\}$，$K$ 为给定的正整数。\n由于不能显得太小气，所以 JYY 所选礼物的件数最少为 $L$ 件；同时，选得太多也不好拿，因此礼物最多选 $R$ 件。JYY 应该如何选择，才能得到最大的美观程度？由于礼物实在太多挑花眼，JYY 打算把这个问题交给会编程的你。\n\n", "inputFormat": "**本题每个测试点有多组数据。**\n\n输入第一行包含一个正整数 $T$，表示有 $T$ 组数据。\n\n每组数据包含两行。第一行四个非负整数 $N,K,L,R$。第二行包含 $N$ 个正整数，依次表示 $A_1,A_2,\\cdots,A_n$。", "outputFormat": "输出 $T$ 行，每行一个非负实数，依次对应每组数据的答案，数据保证答案不\n会超过 $10^3$。输出四舍五入保留 $4$ 位小数。", "hint": "对于 $100\\%$ 的数据，$T\\leq 10$，$N,K\\leq 5\\times 10^4$，$1\\leq A_i\\leq 10^8$，$2\\leq L,R\\leq N$。", "locale": "zh-CN"}}}
{"pid": "P6088", "type": "P", "difficulty": 5, "samples": [["4\n1 2 ab\n2 4 ac\n1 3 bc\n3\n1 4 a\n3 4 b\n3 2 ab", "2\n1\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "江苏", "字典树 Trie"], "title": "[JSOI2015] 字符串树", "background": "萌萌买了一颗字符串树的种子，春天种下去以后夏天就能长出一棵很大的字符串树。字符串树很奇特，树枝上都密密麻麻写满了字符串，看上去很复杂的样\n子。", "description": "字符串树本质上还是一棵树，即 $N$ 个节点 $N-1$ 条边的连通无向无环图，节点从 $1$ 到 $N$ 编号。与普通的树不同的是，树上的每条边都对应了一个字符串。萌萌和 JYY 在树下玩的时候，萌萌决定考一考 JYY。每次萌萌都写出一个字符串 $S$ 和两个节点 $U,V$，JYY 需要立即回答 $U$ 和 $V$ 之间的最短路径（即 $U,V$ 之间边数最少的路径，由于给定的是一棵树，这样的路径是唯一的）上有多少个字符串以 $S$ 为前缀。\n\nJYY 虽然精通编程，但对字符串处理却不在行。所以他请你帮他解决萌萌的难题。", "inputFormat": "输入第一行包含一个整数 $N$，代表字符串树的节点数量。\n\n接下来 $N-1$ 行，每行先是两个数 $U,V$，然后是一个字符串 $S$，表示节点 $U$ 和节点 $V$ 之间有一条直接相连的边，这条边上的字符串是 $S$。输入数据保证给出的是一棵合法的树。\n\n接下来一行包含一个整数 $Q$，表示萌萌的问题数。\n\n接下来 $Q$ 行，每行先是两个数 $U,V$，然后是一个字符串 $S$，表示萌萌的一个问题是节点 $U$ 和节点 $V$ 之间的最短路径上有多少字符串以 $S$ 为前缀。", "outputFormat": "输出 $Q$ 行，每行对应萌萌的一个问题的答案。", "hint": "对于 $100\\%$ 的数据，$1\\leq N,Q\\leq 10^5$，输入所有字符串长度不超过 $10$ 且只包含 `a~z` 的小写字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 字符串树", "background": "萌萌买了一颗字符串树的种子，春天种下去以后夏天就能长出一棵很大的字符串树。字符串树很奇特，树枝上都密密麻麻写满了字符串，看上去很复杂的样\n子。", "description": "字符串树本质上还是一棵树，即 $N$ 个节点 $N-1$ 条边的连通无向无环图，节点从 $1$ 到 $N$ 编号。与普通的树不同的是，树上的每条边都对应了一个字符串。萌萌和 JYY 在树下玩的时候，萌萌决定考一考 JYY。每次萌萌都写出一个字符串 $S$ 和两个节点 $U,V$，JYY 需要立即回答 $U$ 和 $V$ 之间的最短路径（即 $U,V$ 之间边数最少的路径，由于给定的是一棵树，这样的路径是唯一的）上有多少个字符串以 $S$ 为前缀。\n\nJYY 虽然精通编程，但对字符串处理却不在行。所以他请你帮他解决萌萌的难题。", "inputFormat": "输入第一行包含一个整数 $N$，代表字符串树的节点数量。\n\n接下来 $N-1$ 行，每行先是两个数 $U,V$，然后是一个字符串 $S$，表示节点 $U$ 和节点 $V$ 之间有一条直接相连的边，这条边上的字符串是 $S$。输入数据保证给出的是一棵合法的树。\n\n接下来一行包含一个整数 $Q$，表示萌萌的问题数。\n\n接下来 $Q$ 行，每行先是两个数 $U,V$，然后是一个字符串 $S$，表示萌萌的一个问题是节点 $U$ 和节点 $V$ 之间的最短路径上有多少字符串以 $S$ 为前缀。", "outputFormat": "输出 $Q$ 行，每行对应萌萌的一个问题的答案。", "hint": "对于 $100\\%$ 的数据，$1\\leq N,Q\\leq 10^5$，输入所有字符串长度不超过 $10$ 且只包含 `a~z` 的小写字母。", "locale": "zh-CN"}}}
{"pid": "P6089", "type": "P", "difficulty": 5, "samples": [["5 5\n0.5\n5 1\n3 2\n2 2\n2 1\n3 1", "0.89"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "江苏", "概率论"], "title": "[JSOI2015] 非诚勿扰", "background": "JYY 赶上了互联网创业的大潮，为非诚勿扰开发了最新的手机 App 实现单身大龄青年之间的“速配”。然而随着用户数量的增长，JYY 发现现有速配的算法似乎很难满足大家的要求，因此 JYY 决定请你来调查一下其中的原因。", "description": "应用的后台一共有 $N$ 个女性和 $N$ 个男性，他们每个人都希望能够找到自己的合适伴侣。为了方便，每个男性都被编上了 $1$ 到 $N$ 之间的一个号码，并且任意两个人的号码不一样。每个女性也被如此编号。\n\nJYY 应用的最大特点是赋予女性较高的选择权，让每个女性指定自己的“如意郎君列表”。每个女性的如意郎君列表都是所有男性的一个子集，并且可能为空。如果列表非空，她们会在其中选择一个男性作为自己最终接受的对象。\n\nJYY 用如下算法来为每个女性速配最终接受的男性：将“如意郎君列表”中的男性按照编号从小到大的顺序呈现给她。对于每次呈现，她将独立地以 $P$ 的概率接受这个男性（换言之，会以 $1-P$ 的概率拒绝这个男性）。如果她选择了拒绝，App 就会呈现列表中下一个男性，以此类推。如果列表中所有的男性都已经呈现，那么中介所会重新按照列表的顺序来呈现这些男性，直到她接受了某个男性为止。显然，在这种规则下，每个女性只能选择接受一个男性，而一个男性可能被多个女性所接受。当然，也可能有部分男性不被任何一个女性接受。\n\n这样，每个女性就有了自己接受的男性（“如意郎君列表”为空的除外）。现在考虑任意两个不同的、如意郎君列表非空的女性 $a$ 和 $b$，如果 $a$ 的编号比 $b$ 的编号小，而 $a$ 选择的男性的编号比 $b$ 选择的编号大，那么女性 $a$ 和女性 $b$ 就叫做一对不稳定因素。\n\n由于每个女性选择的男性是有一定的随机性的，所以不稳定因素的数目也是有一定随机性的。JYY 希望你能够求得不稳定因素的期望个数（即平均数目），从而进一步研究为什么速配算法不能满足大家的需求。", "inputFormat": "输入第一行包含 $2$ 个自然数 $N,M$，表示有 $N$ 个女性和 $N$ 个男性，以及所有女性的“如意郎君列表”长度之和是 $M$。\n\n接下来一行一个实数 $P$，为女性接受男性的概率。\n\n接下来 $M$ 行，每行包含两个整数 $a,b$，表示男性 $b$ 在女性 $a$ 的“如意郎君列表”中。", "outputFormat": "输出 $1$ 行，包含一个实数，四舍五入后保留到小数点后 $2$ 位，表示不稳定因素的期望数目。", "hint": "对于 $100\\%$ 的数据，$1\\leq N,M\\leq 5\\times 10^5$，$0.4\\leq P<0.6$。\n\n输入保证每个女性的“如意郎君列表”中的男性出现且仅出现一次。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 非诚勿扰", "background": "JYY 赶上了互联网创业的大潮，为非诚勿扰开发了最新的手机 App 实现单身大龄青年之间的“速配”。然而随着用户数量的增长，JYY 发现现有速配的算法似乎很难满足大家的要求，因此 JYY 决定请你来调查一下其中的原因。", "description": "应用的后台一共有 $N$ 个女性和 $N$ 个男性，他们每个人都希望能够找到自己的合适伴侣。为了方便，每个男性都被编上了 $1$ 到 $N$ 之间的一个号码，并且任意两个人的号码不一样。每个女性也被如此编号。\n\nJYY 应用的最大特点是赋予女性较高的选择权，让每个女性指定自己的“如意郎君列表”。每个女性的如意郎君列表都是所有男性的一个子集，并且可能为空。如果列表非空，她们会在其中选择一个男性作为自己最终接受的对象。\n\nJYY 用如下算法来为每个女性速配最终接受的男性：将“如意郎君列表”中的男性按照编号从小到大的顺序呈现给她。对于每次呈现，她将独立地以 $P$ 的概率接受这个男性（换言之，会以 $1-P$ 的概率拒绝这个男性）。如果她选择了拒绝，App 就会呈现列表中下一个男性，以此类推。如果列表中所有的男性都已经呈现，那么中介所会重新按照列表的顺序来呈现这些男性，直到她接受了某个男性为止。显然，在这种规则下，每个女性只能选择接受一个男性，而一个男性可能被多个女性所接受。当然，也可能有部分男性不被任何一个女性接受。\n\n这样，每个女性就有了自己接受的男性（“如意郎君列表”为空的除外）。现在考虑任意两个不同的、如意郎君列表非空的女性 $a$ 和 $b$，如果 $a$ 的编号比 $b$ 的编号小，而 $a$ 选择的男性的编号比 $b$ 选择的编号大，那么女性 $a$ 和女性 $b$ 就叫做一对不稳定因素。\n\n由于每个女性选择的男性是有一定的随机性的，所以不稳定因素的数目也是有一定随机性的。JYY 希望你能够求得不稳定因素的期望个数（即平均数目），从而进一步研究为什么速配算法不能满足大家的需求。", "inputFormat": "输入第一行包含 $2$ 个自然数 $N,M$，表示有 $N$ 个女性和 $N$ 个男性，以及所有女性的“如意郎君列表”长度之和是 $M$。\n\n接下来一行一个实数 $P$，为女性接受男性的概率。\n\n接下来 $M$ 行，每行包含两个整数 $a,b$，表示男性 $b$ 在女性 $a$ 的“如意郎君列表”中。", "outputFormat": "输出 $1$ 行，包含一个实数，四舍五入后保留到小数点后 $2$ 位，表示不稳定因素的期望数目。", "hint": "对于 $100\\%$ 的数据，$1\\leq N,M\\leq 5\\times 10^5$，$0.4\\leq P<0.6$。\n\n输入保证每个女性的“如意郎君列表”中的男性出现且仅出现一次。\n", "locale": "zh-CN"}}}
{"pid": "P6090", "type": "P", "difficulty": 6, "samples": [["1\nradar", "1"], ["1\nrobot", "2"], ["2\nFLOW\nWOLF", "2"], ["2\nbaobab\nbob", "4097"], ["3\nTURING\nSUBMIT\nACCEPT", "162"], ["3\nMAN1LA\nMAN6OS\nAN4NAS", "114"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "枚举", "CEOI（中欧）", "组合数学"], "title": "[CEOI 2019] 立方填词", "background": "", "description": "立方填词是一种特殊的填词游戏。填词之前，你需要选择立方体的边长 $a$ ，然后你就可以建立一个有 $a^3$ 个单位立方体的立方体了。这个大立方体有 $12$ 条边。然后，你去掉所有没有接触大立方体边的单位立方体。下图展示了当 $a=6$ 时建立的最终立方体。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zzs7dshw.png)\n\n最后，你需要给剩下的每个单位立方体填上一个字母。对于这个立方体，填词之后，每条边上的单词都应该是有意义的。每条边都可以双向阅读，只要从一个方向读起来有意义即可。\n\n下图展示了当 $a=6$ 时的一个立方体。一些单位立方体已经填上了字母。你已经可以沿这个大立方体的三条边读到 **SUBMIT**，**ACCEPT** 和 **TURING** 三个单词了。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jzpyzoeu.png)\n\n给定一系列有意义的单词，每个单词可以在合法的立方体的任意一条边上出现。求可以构造多少种不同的立方体对 $998244353$ 取模。\n\n即使一个立方体可以通过旋转和镜像操作变成另一个立方体，也认为这两个立方体**是不同的**。", "inputFormat": "第一行一个整数 $n$ ，表示单词的个数。\n\n接下来 $n$ 行，每行一个单词，表示可以在大立方体的边上出现的单词。单词长度大于等于 $3$ ，并且小于等于 $10$ 。\n\n保证所有单词都不同。", "outputFormat": "输出一个整数，表示可以构造的不同立方体数对 $998244353$ 取模后的结果。", "hint": "#### 样例解释#1\n\n第一个样例中，唯一一种可能是立方体的所有边上的单词均为 **radar**。\n\n#### 样例解释#2\n\n第二个样例中，有两种立方体，其中一个旋转后可以得到另一个立方体。立方体所有边上的单词都是 **robot**，两个立方体的不同之处在于左下角的字母是 **r** 还是 **t**。\n\n#### 样例解释#3\n\n第三个样例与第二个类似，注意阅读方向不会影响答案。\n\n#### 样例解释#4\n\n第四个样例中，如果把 **bob** 填在立方体的每条边上，有一种立方体。还有 $2^\n{12} = 4096$ 种立方体，每条边都填 **baobab**（对于 $12$ 条边中的一条，我们有两种可能的阅读顺序）。\n\n#### 数据范围\n\n对于全部数据， $1 \\le n \\le 10^5$  。      \n\n详细子任务限制及分值如下表：\n\n| 子任务编号 | 限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | 单词中只包含小写的 `a` 到 `f` | $21$ |\n| 2 | 单词中只包含小写的 `a` 到 `p` | $29$ |\n| 3 | 单词中包含小写的 `a` 到 `p` 和大写的 `A` 到 `P` | $34$ |\n| 4 | 单词中包含小写的 `a` 到 `z`，大写的 `A` 到 `Z` 和数字 `0` 到 `9`  | $16$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2019] 立方填词", "background": "", "description": "立方填词是一种特殊的填词游戏。填词之前，你需要选择立方体的边长 $a$ ，然后你就可以建立一个有 $a^3$ 个单位立方体的立方体了。这个大立方体有 $12$ 条边。然后，你去掉所有没有接触大立方体边的单位立方体。下图展示了当 $a=6$ 时建立的最终立方体。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zzs7dshw.png)\n\n最后，你需要给剩下的每个单位立方体填上一个字母。对于这个立方体，填词之后，每条边上的单词都应该是有意义的。每条边都可以双向阅读，只要从一个方向读起来有意义即可。\n\n下图展示了当 $a=6$ 时的一个立方体。一些单位立方体已经填上了字母。你已经可以沿这个大立方体的三条边读到 **SUBMIT**，**ACCEPT** 和 **TURING** 三个单词了。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jzpyzoeu.png)\n\n给定一系列有意义的单词，每个单词可以在合法的立方体的任意一条边上出现。求可以构造多少种不同的立方体对 $998244353$ 取模。\n\n即使一个立方体可以通过旋转和镜像操作变成另一个立方体，也认为这两个立方体**是不同的**。", "inputFormat": "第一行一个整数 $n$ ，表示单词的个数。\n\n接下来 $n$ 行，每行一个单词，表示可以在大立方体的边上出现的单词。单词长度大于等于 $3$ ，并且小于等于 $10$ 。\n\n保证所有单词都不同。", "outputFormat": "输出一个整数，表示可以构造的不同立方体数对 $998244353$ 取模后的结果。", "hint": "#### 样例解释#1\n\n第一个样例中，唯一一种可能是立方体的所有边上的单词均为 **radar**。\n\n#### 样例解释#2\n\n第二个样例中，有两种立方体，其中一个旋转后可以得到另一个立方体。立方体所有边上的单词都是 **robot**，两个立方体的不同之处在于左下角的字母是 **r** 还是 **t**。\n\n#### 样例解释#3\n\n第三个样例与第二个类似，注意阅读方向不会影响答案。\n\n#### 样例解释#4\n\n第四个样例中，如果把 **bob** 填在立方体的每条边上，有一种立方体。还有 $2^\n{12} = 4096$ 种立方体，每条边都填 **baobab**（对于 $12$ 条边中的一条，我们有两种可能的阅读顺序）。\n\n#### 数据范围\n\n对于全部数据， $1 \\le n \\le 10^5$  。      \n\n详细子任务限制及分值如下表：\n\n| 子任务编号 | 限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | 单词中只包含小写的 `a` 到 `f` | $21$ |\n| 2 | 单词中只包含小写的 `a` 到 `p` | $29$ |\n| 3 | 单词中包含小写的 `a` 到 `p` 和大写的 `A` 到 `P` | $34$ |\n| 4 | 单词中包含小写的 `a` 到 `z`，大写的 `A` 到 `Z` 和数字 `0` 到 `9`  | $16$ |", "locale": "zh-CN"}}}
{"pid": "P6091", "type": "P", "difficulty": 5, "samples": [["6\n2 1\n4 1\n25 2\n36 1\n9 6\n18 1\n", "1\n1 \n1\n3 \n8\n3 12 17 23 \n0\n\n2\n\n2\n5 11 \n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "原根", "数论", "素数判断,质数,筛法", "模板题"], "title": "【模板】原根", "background": "", "description": "给定整数 $n$，求它的所有原根。\n\n为了减小你的输出量，给出输出参数 $d$，设 $n$ 的所有原根有 $c$ 个，从小到大分别为 $g_1,\\ldots,g_c$，你只需要依次输出 $g_d,g_{2d},\\ldots,g_{\\lfloor\\frac{c}{d}\\rfloor\\times d}$。\n\n---\n\n如果你不了解原根的定义，可以自行查找资料或阅读下列定义：\n\n正整数 $g$ 是正整数 $n$ 的原根，当且仅当 $1\\leq g\\leq n-1$，且 $g$ 模 $n$ 的阶为 $\\varphi(n)$。", "inputFormat": "**本题包含多组数据**。\n\n第一行：一个整数 $T$，表示数据组数。\n\n接下来 $T$ 行：每行两个整数 $n,d$，表示一组询问数据。", "outputFormat": "对于每组数据：\n\n第一行输出一个整数 $c$，表示 $n$ 的原根个数，第二行输出 $\\lfloor\\dfrac{c}{d}\\rfloor$ 个数，按照题目描述中要求输出。\n\n注意：即使 $\\lfloor\\dfrac{c}{d}\\rfloor=0$，也需要输出一个空行。", "hint": "【样例解释】\n\n对于第 $1,2,4,6$ 组数据，给出的 $n$ 的所有原根都出现在输出中。\n\n对于第 $3$ 组数据，$25$ 的原根集合为 $\\{2,3,8,12,13,17,22,23\\}$。\n\n对于第 $5$ 组数据，$9$ 的原根集合为 $\\{2,5\\}$。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，$1\\leq T\\leq 10$，$2\\leq n\\leq 10^6$，$1\\leq d\\leq 200$，保证输出的数的总个数不超过 $10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】原根", "background": "", "description": "给定整数 $n$，求它的所有原根。\n\n为了减小你的输出量，给出输出参数 $d$，设 $n$ 的所有原根有 $c$ 个，从小到大分别为 $g_1,\\ldots,g_c$，你只需要依次输出 $g_d,g_{2d},\\ldots,g_{\\lfloor\\frac{c}{d}\\rfloor\\times d}$。\n\n---\n\n如果你不了解原根的定义，可以自行查找资料或阅读下列定义：\n\n正整数 $g$ 是正整数 $n$ 的原根，当且仅当 $1\\leq g\\leq n-1$，且 $g$ 模 $n$ 的阶为 $\\varphi(n)$。", "inputFormat": "**本题包含多组数据**。\n\n第一行：一个整数 $T$，表示数据组数。\n\n接下来 $T$ 行：每行两个整数 $n,d$，表示一组询问数据。", "outputFormat": "对于每组数据：\n\n第一行输出一个整数 $c$，表示 $n$ 的原根个数，第二行输出 $\\lfloor\\dfrac{c}{d}\\rfloor$ 个数，按照题目描述中要求输出。\n\n注意：即使 $\\lfloor\\dfrac{c}{d}\\rfloor=0$，也需要输出一个空行。", "hint": "【样例解释】\n\n对于第 $1,2,4,6$ 组数据，给出的 $n$ 的所有原根都出现在输出中。\n\n对于第 $3$ 组数据，$25$ 的原根集合为 $\\{2,3,8,12,13,17,22,23\\}$。\n\n对于第 $5$ 组数据，$9$ 的原根集合为 $\\{2,5\\}$。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，$1\\leq T\\leq 10$，$2\\leq n\\leq 10^6$，$1\\leq d\\leq 200$，保证输出的数的总个数不超过 $10^5$。", "locale": "zh-CN"}}}
{"pid": "P6092", "type": "P", "difficulty": 3, "samples": [["8 2 12 \n1 2 4 2 1 3 5 6 2 3 6 4", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2012", "二分", "CEOI（中欧）"], "title": "[CEOI 2012] 工作规划", "background": "", "description": "CEOI 在 $N$ 天内收到了 $M$ 个任务，每个任务需要 $1$ 台机器工作 $1$ 天来完成。CEOI 有很多台机器，每台机器一天只能完成一个任务。 CEOI 要求每个任务最多只能推迟 $D$ 天完成。换言之，如果一个客户在第 $S$ 天提交了一个任务，CEOI 必须在第 $S+D$ 天之前完成它。\n\n请你写程序求出每个任务最多推迟 $D$ 天的前提下，最少需要多少台机器才能按要求完成所有任务。", "inputFormat": "第一行输入包含三个整数， $N$ 是 CEOI 接受任务的天数， $D$ 是每个任务最多可以推迟的天数。$M$ 是任务的个数。\n\n第二行是 $M$ 个被空格分隔的整数。第 $i$ 个数代表收到第 $i$ 个任务时间。第 $N-D$ 天之后均没有任务。所有的任务按照输入顺序从 $1$ 到 $N$ 依次编号。", "outputFormat": "输出一个整数，即能完成任务的最少机器数。", "hint": "对于 $50\\%$ 的测试点，$M \\le 10^5$。\n\n对于所有测试点，$1 \\le N \\le {10}^5$，$0 \\le D < N$ , $1 \\le M< 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2012] 工作规划", "background": "", "description": "CEOI 在 $N$ 天内收到了 $M$ 个任务，每个任务需要 $1$ 台机器工作 $1$ 天来完成。CEOI 有很多台机器，每台机器一天只能完成一个任务。 CEOI 要求每个任务最多只能推迟 $D$ 天完成。换言之，如果一个客户在第 $S$ 天提交了一个任务，CEOI 必须在第 $S+D$ 天之前完成它。\n\n请你写程序求出每个任务最多推迟 $D$ 天的前提下，最少需要多少台机器才能按要求完成所有任务。", "inputFormat": "第一行输入包含三个整数， $N$ 是 CEOI 接受任务的天数， $D$ 是每个任务最多可以推迟的天数。$M$ 是任务的个数。\n\n第二行是 $M$ 个被空格分隔的整数。第 $i$ 个数代表收到第 $i$ 个任务时间。第 $N-D$ 天之后均没有任务。所有的任务按照输入顺序从 $1$ 到 $N$ 依次编号。", "outputFormat": "输出一个整数，即能完成任务的最少机器数。", "hint": "对于 $50\\%$ 的测试点，$M \\le 10^5$。\n\n对于所有测试点，$1 \\le N \\le {10}^5$，$0 \\le D < N$ , $1 \\le M< 10^6$。", "locale": "zh-CN"}}}
{"pid": "P6093", "type": "P", "difficulty": 4, "samples": [["3\n5 4 1\n4 2 2\n3 2 1", "7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2015", "各省省选", "江苏"], "title": "[JSOI2015] 套娃", "background": "刚从俄罗斯旅游回来的 JYY 买了很多很多好看的套娃作为纪念品！JYY 由于太过激动，把所有的套娃全部都打开了。而由于很多套娃长得过于相像，JYY 现在不知道该如何把它们装回去了（他实在搞不清，应该把哪个套娃装到哪个里面去了）。", "description": "JYY 一共有 $N$ 个拆开的套娃，每个套娃从 $1$ 到 $N$ 编号。编号为 $i$ 的套娃有一个外径 $Out_i$ 和一个内径 $In_i$（$In_i<Out_i$）。\n\n对于套娃 $i$ 和套娃 $j$，如果满足 $Out_i<In_j$，那么套娃 $i$ 就可以装到套娃 $j$ 里面去。\n\n注意，一个套娃内部，不允许并排的放入多个套娃。\n\n也就是说，如果我们将 $i$ 装到 $j$ 的内部之后，还存在另一个套娃 $k$，也满足 $Out_k<In_j$，我们此时是不允许再将 $k$ 放到 $j$ 内部的（因为 $j$ 的内部已经放入了 $i$）。但是，如果 $k$ 还满足 $Out_k<In_i$，那么我们允许先将 $k$ 放到 $i$ 的内部，然后再把 $k$ 和 $i$ 作为一个整体放入 $j$ 的内部。\n\nJYY 认为一套好的套娃，内部的空隙一定是尽量少的。如果套娃 $j$ 内部装入了套娃 $i$，那么我们认为，套娃 $j$ 内部产生的空隙为 $In_j-Out_i$；如果套娃 $j$ 的内部什么也没有装，那么套娃 $j$ 的空隙则就是 $In_j$。\n\nJYY 也希望，那些长得更加好看的套娃，里面可以填的尽量满一些；而相对\n那些不那么好看的套娃，JYY 也就相对不那么介意一些。为此 JYY 对于编号为 $i$ 的套娃设置了一个好看度 $B_i$，如果这个套娃内部还存在 $K$ 的空隙，那么 JYY 对于这个套娃就会产生 $K\\times Bi$ 的不满意度。\n\nJYY 对于一个套娃安装方案的不满意度，就是每个套娃产生的不满意度的总\n和。JYY 希望找出一个，不满意度最小的套娃安装方案。", "inputFormat": "第一行包含一个正整数 $N$。接下来 $N$ 行，每行包含三个正整数 $Out_i,In_i,B_i$，表示 $i$ 号套娃的外径，内径，以及好看度。\n\n", "outputFormat": "输出文件包含一行一个整数，表示不满意度的最小值。\n\n", "hint": "对于 $100\\%$ 的数据，$N\\leq 2\\times 10^5$，$1\\leq In_i<Out_i\\leq 10^4$，$1\\leq B_i\\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 套娃", "background": "刚从俄罗斯旅游回来的 JYY 买了很多很多好看的套娃作为纪念品！JYY 由于太过激动，把所有的套娃全部都打开了。而由于很多套娃长得过于相像，JYY 现在不知道该如何把它们装回去了（他实在搞不清，应该把哪个套娃装到哪个里面去了）。", "description": "JYY 一共有 $N$ 个拆开的套娃，每个套娃从 $1$ 到 $N$ 编号。编号为 $i$ 的套娃有一个外径 $Out_i$ 和一个内径 $In_i$（$In_i<Out_i$）。\n\n对于套娃 $i$ 和套娃 $j$，如果满足 $Out_i<In_j$，那么套娃 $i$ 就可以装到套娃 $j$ 里面去。\n\n注意，一个套娃内部，不允许并排的放入多个套娃。\n\n也就是说，如果我们将 $i$ 装到 $j$ 的内部之后，还存在另一个套娃 $k$，也满足 $Out_k<In_j$，我们此时是不允许再将 $k$ 放到 $j$ 内部的（因为 $j$ 的内部已经放入了 $i$）。但是，如果 $k$ 还满足 $Out_k<In_i$，那么我们允许先将 $k$ 放到 $i$ 的内部，然后再把 $k$ 和 $i$ 作为一个整体放入 $j$ 的内部。\n\nJYY 认为一套好的套娃，内部的空隙一定是尽量少的。如果套娃 $j$ 内部装入了套娃 $i$，那么我们认为，套娃 $j$ 内部产生的空隙为 $In_j-Out_i$；如果套娃 $j$ 的内部什么也没有装，那么套娃 $j$ 的空隙则就是 $In_j$。\n\nJYY 也希望，那些长得更加好看的套娃，里面可以填的尽量满一些；而相对\n那些不那么好看的套娃，JYY 也就相对不那么介意一些。为此 JYY 对于编号为 $i$ 的套娃设置了一个好看度 $B_i$，如果这个套娃内部还存在 $K$ 的空隙，那么 JYY 对于这个套娃就会产生 $K\\times Bi$ 的不满意度。\n\nJYY 对于一个套娃安装方案的不满意度，就是每个套娃产生的不满意度的总\n和。JYY 希望找出一个，不满意度最小的套娃安装方案。", "inputFormat": "第一行包含一个正整数 $N$。接下来 $N$ 行，每行包含三个正整数 $Out_i,In_i,B_i$，表示 $i$ 号套娃的外径，内径，以及好看度。\n\n", "outputFormat": "输出文件包含一行一个整数，表示不满意度的最小值。\n\n", "hint": "对于 $100\\%$ 的数据，$N\\leq 2\\times 10^5$，$1\\leq In_i<Out_i\\leq 10^4$，$1\\leq B_i\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6094", "type": "P", "difficulty": 6, "samples": [["5 5\n-3 7 0 0 0\n8 0 7 -10 0\n0 7 0 1 0\n0 0 0 0 0\n-8 0 0 2 10\n4 50 50 1 50\n50 50 1 9 50\n50 50 1 1 50\n2 50 50 50 50\n2 50 50 50\n50 50 1 1\n50 1 8 1\n50 50 50 50\n1 50 50 50", "48"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "网络流", "江苏"], "title": "[JSOI2015] 圈地", "background": "JYY 在火星买了一大块矩形的地皮做房地产开发。由于地皮实在是太大了，JYY 把这块地皮划分成了 $N$ 行 $M$ 列的小方格，并在每一格中建造一栋房子。历时若干年，开发终于宣告结束，JYY 也可以把这些房子挂牌出售了。现在他找到了两位非同寻常的土豪买家：南南和强强。\n\n麻烦的是，南南和强强是水火不容的。为了保证他们俩不发生矛盾，JYY 需要把卖给他们俩的房子用墙隔开。不过造墙是需要钱的，JYY 作为倒卖地皮的专家，自然想挣尽可能多的钱，因此他邀请到你帮他设计最优的出售方案。", "description": "JYY 把这块地皮划分成了 $N$ 行 $M$ 列的矩形，且矩形的每一格中建造一栋房子。现在，南南和强强已经将他们的购买意见提交给了 JYY。对于每一栋房子，南南和强强已经给定了他们的出价（不想购买，或愿意以一定价格购买），并且由于他们已经协商好了各自的势力范围，因此不存在两个人同时想买一栋房子的情况。JYY 可以选择每一栋房子是否出售（因为不存在两个人同时想买一栋房子的情况，若 JYY 选择出售一栋房子，它的买家就是确定的）。房子卖给强强和南南以后，JYY 就能获得卖出房子出价的总和。\n\n不过，作为售后服务，JYY 需要通过造墙（将两栋相邻的房子用一堵墙隔开）把两个人的房子完全隔开。所谓完全隔开，就是指造出的墙以及四周的边界将整个区域划分成若干个不连通的部分，每个部分里面只有一个人的房子。当然，造墙也是需要钱的，而且价格不菲。不过 JYY 当初在宣传时声称造墙完全免费，所以这部分钱只好由 JYY 自己出了。\n\nJYY 请你为他规划每幢房子是否要卖出以及建造哪些围墙，才能使得卖房子的收益减去造围墙的花费最大。另外一个好消息是整个地皮的四周已经建好了墙，因此 JYY 可以利用这些建好的墙达到目的。下图就是用墙将区域划分成 $3$ 个不连通的部分的例子。格子中的数字代表出价（数字的含义参考输入格式），边上的数值代表造墙的价格。四周的墙（边界）本来就有，不需要 JYY 花额外的代价去建造。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t57031da.png)", "inputFormat": "输入第一行包含两个用空格隔开的自然数 $N$ 和 $M$。\n\n接下来 $N$ 行，每行 $M$ 个整数，第 $i$ 行第 $j$ 列的整数 $a$ 描述了位于 $(i,j)$ 房子的出售信息。如果 $a=0$，说明强强和南南都不想买这个位置上的房子；如果 $a>0$，说明强强想以价格 $a$ 买这个位置上的房子。如果 $a<0$，说明南南想以价格 $-a$ 买这个位置上的房子。\n\n接下来 $N-1$ 行，每行 $M$ 个整数。第 $i$ 行第 $j$ 列的数表示第 $i$ 行第 $j$ 列的房子与第 $i+1$ 行第 $j$ 列的房子之间的墙的造价。\n\n接下来 $N$ 行，每行 $M-1$ 个整数。第 $i$ 行第 $j$ 列的数表示第 $i$ 行第 $j$ 列的房子与第 $i$ 行第 $j+1$ 列的房子之间的墙的造价。\n", "outputFormat": "输出仅有一行包含一个整数，表示 JYY 的最大收益。\n\n", "hint": "对于 $100\\%$ 的数据，$1\\leq N,M\\leq 200$，任何价格都不超过 $1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 圈地", "background": "JYY 在火星买了一大块矩形的地皮做房地产开发。由于地皮实在是太大了，JYY 把这块地皮划分成了 $N$ 行 $M$ 列的小方格，并在每一格中建造一栋房子。历时若干年，开发终于宣告结束，JYY 也可以把这些房子挂牌出售了。现在他找到了两位非同寻常的土豪买家：南南和强强。\n\n麻烦的是，南南和强强是水火不容的。为了保证他们俩不发生矛盾，JYY 需要把卖给他们俩的房子用墙隔开。不过造墙是需要钱的，JYY 作为倒卖地皮的专家，自然想挣尽可能多的钱，因此他邀请到你帮他设计最优的出售方案。", "description": "JYY 把这块地皮划分成了 $N$ 行 $M$ 列的矩形，且矩形的每一格中建造一栋房子。现在，南南和强强已经将他们的购买意见提交给了 JYY。对于每一栋房子，南南和强强已经给定了他们的出价（不想购买，或愿意以一定价格购买），并且由于他们已经协商好了各自的势力范围，因此不存在两个人同时想买一栋房子的情况。JYY 可以选择每一栋房子是否出售（因为不存在两个人同时想买一栋房子的情况，若 JYY 选择出售一栋房子，它的买家就是确定的）。房子卖给强强和南南以后，JYY 就能获得卖出房子出价的总和。\n\n不过，作为售后服务，JYY 需要通过造墙（将两栋相邻的房子用一堵墙隔开）把两个人的房子完全隔开。所谓完全隔开，就是指造出的墙以及四周的边界将整个区域划分成若干个不连通的部分，每个部分里面只有一个人的房子。当然，造墙也是需要钱的，而且价格不菲。不过 JYY 当初在宣传时声称造墙完全免费，所以这部分钱只好由 JYY 自己出了。\n\nJYY 请你为他规划每幢房子是否要卖出以及建造哪些围墙，才能使得卖房子的收益减去造围墙的花费最大。另外一个好消息是整个地皮的四周已经建好了墙，因此 JYY 可以利用这些建好的墙达到目的。下图就是用墙将区域划分成 $3$ 个不连通的部分的例子。格子中的数字代表出价（数字的含义参考输入格式），边上的数值代表造墙的价格。四周的墙（边界）本来就有，不需要 JYY 花额外的代价去建造。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t57031da.png)", "inputFormat": "输入第一行包含两个用空格隔开的自然数 $N$ 和 $M$。\n\n接下来 $N$ 行，每行 $M$ 个整数，第 $i$ 行第 $j$ 列的整数 $a$ 描述了位于 $(i,j)$ 房子的出售信息。如果 $a=0$，说明强强和南南都不想买这个位置上的房子；如果 $a>0$，说明强强想以价格 $a$ 买这个位置上的房子。如果 $a<0$，说明南南想以价格 $-a$ 买这个位置上的房子。\n\n接下来 $N-1$ 行，每行 $M$ 个整数。第 $i$ 行第 $j$ 列的数表示第 $i$ 行第 $j$ 列的房子与第 $i+1$ 行第 $j$ 列的房子之间的墙的造价。\n\n接下来 $N$ 行，每行 $M-1$ 个整数。第 $i$ 行第 $j$ 列的数表示第 $i$ 行第 $j$ 列的房子与第 $i$ 行第 $j+1$ 列的房子之间的墙的造价。\n", "outputFormat": "输出仅有一行包含一个整数，表示 JYY 的最大收益。\n\n", "hint": "对于 $100\\%$ 的数据，$1\\leq N,M\\leq 200$，任何价格都不超过 $1000$。", "locale": "zh-CN"}}}
{"pid": "P6095", "type": "P", "difficulty": 6, "samples": [["4 2\n4321", "32"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "二分", "各省省选", "江苏", "后缀数组 SA"], "title": "[JSOI2015] 串分割", "background": "JYY 每天都会在地铁上度过很长的时间。\n\n为了打发时间，JYY 随手写下了一个很长的环形的数字字符串，并且陷入了沉思。", "description": "JYY 写下了一个长度为 $N$ 的，仅包含 `1`，`2`，……，`9` 这 $9$ 种不同字符的环形字符串 $S$。JYY 希望把 $S$ 进行 $K$ 次切割，并分成 $K$ 个非空的子串。对于每一个子串，由于其仅包含数字，我们可以将其看成一个十进制数——因此\n经过 $K$ 次切割，JYY 可以得到 $K$ 个不同的十进制数。JYY 希望他得到的这 $K$ 个数中，最大的那一个尽量小。", "inputFormat": "第一行包含两个整数 $N$ 和 $K$。\n\n第二行包含一个长度为 $N$ 的字符串 $S$。", "outputFormat": "输出一行包含一个正整数，表示最佳分割方案中，JYY 所得到的那 $K$ 个数中，最大的那一个。\n\n", "hint": "对于 $100\\%$ 的数据，$3\\leq N\\leq 2\\times 10^5$，$2\\leq K\\leq N$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 串分割", "background": "JYY 每天都会在地铁上度过很长的时间。\n\n为了打发时间，JYY 随手写下了一个很长的环形的数字字符串，并且陷入了沉思。", "description": "JYY 写下了一个长度为 $N$ 的，仅包含 `1`，`2`，……，`9` 这 $9$ 种不同字符的环形字符串 $S$。JYY 希望把 $S$ 进行 $K$ 次切割，并分成 $K$ 个非空的子串。对于每一个子串，由于其仅包含数字，我们可以将其看成一个十进制数——因此\n经过 $K$ 次切割，JYY 可以得到 $K$ 个不同的十进制数。JYY 希望他得到的这 $K$ 个数中，最大的那一个尽量小。", "inputFormat": "第一行包含两个整数 $N$ 和 $K$。\n\n第二行包含一个长度为 $N$ 的字符串 $S$。", "outputFormat": "输出一行包含一个正整数，表示最佳分割方案中，JYY 所得到的那 $K$ 个数中，最大的那一个。\n\n", "hint": "对于 $100\\%$ 的数据，$3\\leq N\\leq 2\\times 10^5$，$2\\leq K\\leq N$。", "locale": "zh-CN"}}}
{"pid": "P6096", "type": "P", "difficulty": 5, "samples": [["2 5\nA B C D E\n4 A B C D\n3 C D E\nA D", "1\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "江苏", "最短路"], "title": "[JSOI2015] 地铁线路", "background": "", "description": "JSOI 王国的地铁又涨价了！正在 JSOI 旅游的 JYY 非常不开心。这次票价改革后，乘客并不是按照乘坐的距离收费，而是按照换乘次数进行收费的！JYY 也要按此更新他的线路搜索软件了。JYY 心想，在支付同样票价的前提下，岂不\n是坐的站数越多，自己就赚的越多嘛！于是 JYY 希望开发一个线路搜索软件，使得自己总能够“赚”的最多！\n\nJSOI 地铁一共有 $N$ 条线路 $S$ 个车站。第 $i$ 条地铁线路包含 $L_i$ 个站。所有地铁线路都是一条从首发站到终点站的直线型线路（不存在例如北京地铁 2 号线或者 10 号线那样奇葩的环线）。同时，每一条地铁线路都是双向运行的。如果有不同的线路经过同一个地铁站，那么乘客就可以在那个地铁站进行换乘。根据 JSOI 地铁的最新收费方式，每当乘客进入一列正在运行的地铁列车，都需要支付 $1$ 的费用。因此，假设乘客一共换乘了 $x$ 次，那么就需要总共支付 $x+1$ 的乘车费用。由于地铁线路都是双向运行的，因此在任意一站都可以换乘该线地铁反方向运行的列车。不过，需要注意的是，即使是换乘同样线路的反方向列车，也是需要付费的（因为总是需要先下车，再重新上车的）。\n\nJYY现在要从 $A$ 站坐地铁前往 $B$ 站。假设对于任意一条地铁线路，相邻两站间地铁的运行时间均为 $1$ 分钟，并且列车停站和换乘均不耗时间，JYY想知道\n\n1. 他最少需要支付的票价是多少钱；\n2. 在支付最少票价的前提下，他最多可以乘坐多少分钟的地铁。", "inputFormat": "第一行包含两个正整数 $N$ 和 $S$。\n\n第二行包含 $S$ 个由空格隔开的字符串，表示 $S$ 个站点的站名。\n\n接下来 $N$ 行，每行描述一条地铁线路。对于其中第 $i$ 行，首先包含一个正整数 $L_i$，接下来 $L_i$ 个字符串，表示这条地铁线路上的站点名称。一条线路允许多次停靠同一个站点。\n\n第 $N+3$ 行，包含两个不同的字符串 $A$ 和 $B$，表示 JYY 目前在 $A$ 站，希望坐地铁前往 $B$ 站。", "outputFormat": "第一行包含一个整数 $C$，表示 JYY 最少需要支付的乘车费用。\n\n第二行包含一个整数 $T$，表示 JYY 在花费 $C$ 的前提下，可以乘坐地铁的最长时间。\n\n如果不存在两个站点之间的路线，第一行输出`-1`，第二行输出 `0`。", "hint": "对于 $100\\%$ 的数据，$2\\leq N\\leq 4\\times 10^5$，$S\\leq 3\\times 10^5$，$\\sum L_i\\leq 8\\times 10^5$。\n\n保证输入所有字符串的长度不超过 $40$，且仅包含字母、数字以及横线 `-`。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 地铁线路", "background": "", "description": "JSOI 王国的地铁又涨价了！正在 JSOI 旅游的 JYY 非常不开心。这次票价改革后，乘客并不是按照乘坐的距离收费，而是按照换乘次数进行收费的！JYY 也要按此更新他的线路搜索软件了。JYY 心想，在支付同样票价的前提下，岂不\n是坐的站数越多，自己就赚的越多嘛！于是 JYY 希望开发一个线路搜索软件，使得自己总能够“赚”的最多！\n\nJSOI 地铁一共有 $N$ 条线路 $S$ 个车站。第 $i$ 条地铁线路包含 $L_i$ 个站。所有地铁线路都是一条从首发站到终点站的直线型线路（不存在例如北京地铁 2 号线或者 10 号线那样奇葩的环线）。同时，每一条地铁线路都是双向运行的。如果有不同的线路经过同一个地铁站，那么乘客就可以在那个地铁站进行换乘。根据 JSOI 地铁的最新收费方式，每当乘客进入一列正在运行的地铁列车，都需要支付 $1$ 的费用。因此，假设乘客一共换乘了 $x$ 次，那么就需要总共支付 $x+1$ 的乘车费用。由于地铁线路都是双向运行的，因此在任意一站都可以换乘该线地铁反方向运行的列车。不过，需要注意的是，即使是换乘同样线路的反方向列车，也是需要付费的（因为总是需要先下车，再重新上车的）。\n\nJYY现在要从 $A$ 站坐地铁前往 $B$ 站。假设对于任意一条地铁线路，相邻两站间地铁的运行时间均为 $1$ 分钟，并且列车停站和换乘均不耗时间，JYY想知道\n\n1. 他最少需要支付的票价是多少钱；\n2. 在支付最少票价的前提下，他最多可以乘坐多少分钟的地铁。", "inputFormat": "第一行包含两个正整数 $N$ 和 $S$。\n\n第二行包含 $S$ 个由空格隔开的字符串，表示 $S$ 个站点的站名。\n\n接下来 $N$ 行，每行描述一条地铁线路。对于其中第 $i$ 行，首先包含一个正整数 $L_i$，接下来 $L_i$ 个字符串，表示这条地铁线路上的站点名称。一条线路允许多次停靠同一个站点。\n\n第 $N+3$ 行，包含两个不同的字符串 $A$ 和 $B$，表示 JYY 目前在 $A$ 站，希望坐地铁前往 $B$ 站。", "outputFormat": "第一行包含一个整数 $C$，表示 JYY 最少需要支付的乘车费用。\n\n第二行包含一个整数 $T$，表示 JYY 在花费 $C$ 的前提下，可以乘坐地铁的最长时间。\n\n如果不存在两个站点之间的路线，第一行输出`-1`，第二行输出 `0`。", "hint": "对于 $100\\%$ 的数据，$2\\leq N\\leq 4\\times 10^5$，$S\\leq 3\\times 10^5$，$\\sum L_i\\leq 8\\times 10^5$。\n\n保证输入所有字符串的长度不超过 $40$，且仅包含字母、数字以及横线 `-`。", "locale": "zh-CN"}}}
{"pid": "P6097", "type": "P", "difficulty": 6, "samples": [["2\n1 0 2 1\n2 0 2 1", "2 0 6 3"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["O2优化", "快速沃尔什变换 FWT", "快速莫比乌斯变换 FMT", "集合幂级数，子集卷积", "模板题"], "title": "【模板】子集卷积", "background": "这是一道模板题。", "description": "给定两个长度为 $2^n$ 的序列 $a_0,a_1,\\cdots,a_{2^n-1}$ 和 $b_0,b_1,\\cdots,b_{2^n-1}$，你需要求出一个序列 $c_0,c_1,\\cdots,c_{2^n-1}$，其中 $c_k$ 满足：\n\n$$c_k=\\sum_{\\substack{{i \\& j=0}\\\\{i~\\mid~ j=k}}} a_i b_j$$\n\n其中$~\\mid~$表示按位或，$\\&$表示按位与。\n\n答案对 $10^9+9$ 取模。", "inputFormat": "第一行输入一个正整数 $n$ ，表示集合的大小。\n\n第二行有 $2^n$ 个整数，描述了 $a$。\n\n第三行有 $2^n$ 个整数，描述了 $b$。", "outputFormat": "输出一行 $2^n$ 个整数，表示 $c$。", "hint": "对于所有数据，$1\\le n\\le 20$，$0\\le a_i,b_i< 10^9+9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】子集卷积", "background": "这是一道模板题。", "description": "给定两个长度为 $2^n$ 的序列 $a_0,a_1,\\cdots,a_{2^n-1}$ 和 $b_0,b_1,\\cdots,b_{2^n-1}$，你需要求出一个序列 $c_0,c_1,\\cdots,c_{2^n-1}$，其中 $c_k$ 满足：\n\n$$c_k=\\sum_{\\substack{{i \\& j=0}\\\\{i~\\mid~ j=k}}} a_i b_j$$\n\n其中$~\\mid~$表示按位或，$\\&$表示按位与。\n\n答案对 $10^9+9$ 取模。", "inputFormat": "第一行输入一个正整数 $n$ ，表示集合的大小。\n\n第二行有 $2^n$ 个整数，描述了 $a$。\n\n第三行有 $2^n$ 个整数，描述了 $b$。", "outputFormat": "输出一行 $2^n$ 个整数，表示 $c$。", "hint": "对于所有数据，$1\\le n\\le 20$，$0\\le a_i,b_i< 10^9+9$。", "locale": "zh-CN"}}}
{"pid": "P6098", "type": "P", "difficulty": 5, "samples": [["5 5\n1 2 4 8 16\n1 2\n1 3\n3 4\n3 5\n2 1 5\n1 1 16\n2 3 5\n2 1 5\n2 1 3\n", "21\n20\n4\n20\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "线段树", "USACO", "树状数组", "树链剖分"], "title": "[USACO19FEB] Cow Land G", "background": "Cow Land 是一个特殊的奶牛游乐园，奶牛们可以在那里漫步，吃美味的草，并参观不同的景点（尤其过山车特别受欢迎）。", "description": "Cow Land 总共有 $ N $ 个不同的景点（ $ 2 \\leq N \\leq 10^5 $ ）。 一共有 $ n-1 $ 条道路连接任意两个景点，这意味着任意两个景点间只有一条简单路径。\n\n每个景点 $ i $ 都有一个享受值 $ e_i $ ，这个值可能会改变。因为一些景点在早上更有吸引力，而其他景点在下午则更能吸引游客。\n\n从景点 $ i $ 到景点 $ j $ 的奶牛们可以欣赏从景点 $ i $ 到景点 $ j $ 的路上的所有景观。这条路线的享受值为景点 $ i $ 到景点 $ j $ 的路上的所有景点（包括景点 $ i $ 和景点 $ j $ ）的享受值按位进行异或运算的结果。\n\n请帮助奶牛确定他们前往 Cow Land 旅行时计划的路线的享受值。", "inputFormat": "输入的第一行包含两个整数， $ N,Q $（$1 \\leq Q \\leq 10^5$）。\n\n接下来一行包含 $ N $ 个整数，其中第 $ i $ 个整数 $ e_i $ 代表景点 $ i $ 的享受值。\n\n接下来 $ N-1 $ 行，每行包含两个整数 $ a,b $ ，表示景点 $ a $ 和景点 $ b $ 之间有一条道路相连。\n\n最后 $ Q $ 行，每行包含 3 个整数，表示一个操作，具体内容如下：\n\n1. `1 i v`，表示将 $ e_i $ 修改为 $ v $ 。\n2. `2 i j`，表示询问从景点 $ i $ 到景点 $ j $ 的路线的享受值为多少。", "outputFormat": "对于每个 2 操作，输出对应查询的结果。", "hint": "子任务：对于 $ 50\\% $ 的数据，没有修改操作。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Cow Land G", "background": "Cow Land is a special cow amusement park where cows can walk around, eat tasty grass, and visit different attractions (especially the roller coasters, which are very popular).", "description": "Cow Land has a total of $N$ different attractions ($2 \\leq N \\leq 10^5$). There are $N-1$ roads connecting pairs of attractions, which means there is exactly one simple path between any two attractions.\n\nEach attraction $i$ has an enjoyment value $e_i$, and this value may change. This is because some attractions are more appealing in the morning, while others are more appealing in the afternoon.\n\nCows traveling from attraction $i$ to attraction $j$ can enjoy all the sights along the path from $i$ to $j$. The enjoyment value of this route is the bitwise XOR of the enjoyment values of all attractions on the path from $i$ to $j$ (including attraction $i$ and attraction $j$).\n\nPlease help the cows determine the enjoyment value of the routes they plan to take during their trip to Cow Land.", "inputFormat": "The first line contains two integers $N, Q$ ($1 \\leq Q \\leq 10^5$).\n\nThe next line contains $N$ integers, where the $i$-th integer $e_i$ represents the enjoyment value of attraction $i$.\n\nThe next $N-1$ lines each contain two integers $a, b$, indicating that there is a road connecting attraction $a$ and attraction $b$.\n\nThe last $Q$ lines each contain 3 integers, describing an operation as follows.\n\n1. `1 i v`, meaning to change $e_i$ to $v$.\n2. `2 i j`, meaning to ask what the enjoyment value of the route from attraction $i$ to attraction $j$ is.", "outputFormat": "For each operation of type 2, output the answer to the corresponding query.", "hint": "Subtasks: For $50\\%$ of the testdata, there are no update operations.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Cow Land G", "background": "Cow Land 是一个特殊的奶牛游乐园，奶牛们可以在那里漫步，吃美味的草，并参观不同的景点（尤其过山车特别受欢迎）。", "description": "Cow Land 总共有 $ N $ 个不同的景点（ $ 2 \\leq N \\leq 10^5 $ ）。 一共有 $ n-1 $ 条道路连接任意两个景点，这意味着任意两个景点间只有一条简单路径。\n\n每个景点 $ i $ 都有一个享受值 $ e_i $ ，这个值可能会改变。因为一些景点在早上更有吸引力，而其他景点在下午则更能吸引游客。\n\n从景点 $ i $ 到景点 $ j $ 的奶牛们可以欣赏从景点 $ i $ 到景点 $ j $ 的路上的所有景观。这条路线的享受值为景点 $ i $ 到景点 $ j $ 的路上的所有景点（包括景点 $ i $ 和景点 $ j $ ）的享受值按位进行异或运算的结果。\n\n请帮助奶牛确定他们前往 Cow Land 旅行时计划的路线的享受值。", "inputFormat": "输入的第一行包含两个整数， $ N,Q $（$1 \\leq Q \\leq 10^5$）。\n\n接下来一行包含 $ N $ 个整数，其中第 $ i $ 个整数 $ e_i $ 代表景点 $ i $ 的享受值。\n\n接下来 $ N-1 $ 行，每行包含两个整数 $ a,b $ ，表示景点 $ a $ 和景点 $ b $ 之间有一条道路相连。\n\n最后 $ Q $ 行，每行包含 3 个整数，表示一个操作，具体内容如下：\n\n1. `1 i v`，表示将 $ e_i $ 修改为 $ v $ 。\n2. `2 i j`，表示询问从景点 $ i $ 到景点 $ j $ 的路线的享受值为多少。", "outputFormat": "对于每个 2 操作，输出对应查询的结果。", "hint": "子任务：对于 $ 50\\% $ 的数据，没有修改操作。", "locale": "zh-CN"}}}
{"pid": "P6099", "type": "P", "difficulty": 4, "samples": [["5\n4\n5\n2\n3\n1", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "二分", "USACO", "栈"], "title": "[USACO19FEB] Dishwashing G", "background": "Bessie 和 Elsie 正在帮助 Farmer John 洗碗，这是一个比人们想象的更复杂的过程。", "description": "两头奶牛决定 Bessie 负责涂肥皂，Elsie 负责冲洗。\n\n刚开始的时候，$N$ 个脏盘子（保证是从 $1$ 到 $N$ 的一个排列）堆在 Bessie 那里，而 Elsie 这边的堆是空的。而在她们俩之间，则有一张专门放涂过肥皂的盘子的桌子。\n\n每个冲洗步骤需要执行以下两个操作之一：\n\n- Bessie 从脏盘子堆顶取出一个盘子，涂上肥皂，然后放在桌子上。将这个盘子放在桌子上时，Bessie 只能放在现有的非空盘堆的顶端，或是在最右边新增一个盘堆。\n- Elsie 从桌子最左边的盘堆的顶端拿起盘子，将它冲洗后放在干净的盘堆顶端。\n\n她们希望干净的盘堆能按编号排序，编号最小的在底端，编号最大的在顶端。然而她们发现有的时候这并不可能做到。现在给定脏盘子的堆叠顺序，请你求出一个最大前缀，使得该前缀的所有盘子洗干净后，能按上面的要求堆叠。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行一个整数，代表 Bessie 的脏盘子堆的堆叠顺序。输入的第一个盘子在堆的顶部。", "outputFormat": "输出该序列的最大前缀长度，使得该前缀的所有盘子洗干净后，能按小号在下，大号在上的规则堆叠。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Dishwashing G", "background": "Bessie and Elsie are helping Farmer John wash dishes, which is a more complicated process than people might think.", "description": "The two cows decide that Bessie will apply soap, and Elsie will do the rinsing.\n\nAt the beginning, $N$ dirty dishes (guaranteed to be a permutation of $1$ to $N$) are stacked on Bessie's side, while Elsie's stack is empty. Between them, there is a table specifically used to hold soaped dishes.\n\nEach rinsing step must perform one of the following two operations:\n\n- Bessie takes the top dish from the dirty stack, applies soap, and then places it onto the table. When placing this dish on the table, Bessie may only place it on top of an existing non-empty stack of dishes, or start a new stack on the far right.\n- Elsie takes the top dish from the leftmost stack on the table, rinses it, and then places it on top of the clean stack.\n\nThey want the clean stack to be sorted by label, with the smallest label at the bottom and the largest label at the top. However, they find that sometimes this is not possible. Now, given the stacking order of the dirty dishes, find the maximum prefix such that after washing all dishes in this prefix, they can be stacked according to the requirement above.", "inputFormat": "The first line contains an integer $N$ ($1 \\leq N \\leq 10^5$).\n\nThe next $N$ lines each contain one integer, representing the stacking order of Bessie's dirty dish stack. The first dish given in the input is at the top of the stack.", "outputFormat": "Output the length of the maximum prefix of the sequence such that after washing all dishes in this prefix, they can be stacked with smaller labels at the bottom and larger labels at the top.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Dishwashing G", "background": "Bessie 和 Elsie 正在帮助 Farmer John 洗碗，这是一个比人们想象的更复杂的过程。", "description": "两头奶牛决定 Bessie 负责涂肥皂，Elsie 负责冲洗。\n\n刚开始的时候，$N$ 个脏盘子（保证是从 $1$ 到 $N$ 的一个排列）堆在 Bessie 那里，而 Elsie 这边的堆是空的。而在她们俩之间，则有一张专门放涂过肥皂的盘子的桌子。\n\n每个冲洗步骤需要执行以下两个操作之一：\n\n- Bessie 从脏盘子堆顶取出一个盘子，涂上肥皂，然后放在桌子上。将这个盘子放在桌子上时，Bessie 只能放在现有的非空盘堆的顶端，或是在最右边新增一个盘堆。\n- Elsie 从桌子最左边的盘堆的顶端拿起盘子，将它冲洗后放在干净的盘堆顶端。\n\n她们希望干净的盘堆能按编号排序，编号最小的在底端，编号最大的在顶端。然而她们发现有的时候这并不可能做到。现在给定脏盘子的堆叠顺序，请你求出一个最大前缀，使得该前缀的所有盘子洗干净后，能按上面的要求堆叠。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行一个整数，代表 Bessie 的脏盘子堆的堆叠顺序。输入的第一个盘子在堆的顶部。", "outputFormat": "输出该序列的最大前缀长度，使得该前缀的所有盘子洗干净后，能按小号在下，大号在上的规则堆叠。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6100", "type": "P", "difficulty": 5, "samples": [["3 2\n1 1 4 4\n3 3 7 6\n2 2 8 7", "26"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2019", "USACO", "差分"], "title": "[USACO19FEB] Painting the Barn G", "background": "", "description": "Farmer John 不太擅长多任务处理。他经常分心，很难完成一些长期的项目。目前，他正在谷仓的一侧刷油漆，但他一直忙着在很小的区域涂抹油漆，然后由于抚育母牛的需要而陷入困境，使谷仓的某些部分比其他部分涂有更多的油漆。\n\n我们将谷仓的墙描述为一个 X-Y 平面，每次涂油漆的区域都是一个矩形。FJ 在这个平面上绘制了 $N$ 个矩形，每个矩形的边均与坐标轴平行。因此我们用矩形的左下角和右上角坐标来描述一个矩形。\n\nFJ 想在谷仓里涂几层油漆，这样就不需要在不久的将来再次重新涂油漆。但是，他不想浪费时间涂过多的油漆。事实证明，$K$ 层涂料是最佳用量。但是因为涂油漆的面积太小了，FJ 并不太高兴。他决定最多再绘制两个**不相交**的矩形（这里的相交指两个矩形交的面积大于零，即如果两个矩形仅共用一条边或一个点，则不视为相交）来增加面积。当然不绘制新矩形或仅绘制一个新矩形也是允许的。", "inputFormat": "第一行两个整数 $N,K$（$1 \\leq N,K \\leq 10^5$）。\n\n接下来 $N$ 行，每行四个整数 $x_1,y_1,x_2,y_2$（$0 \\leq x_1,y_1,x_2,y_2 \\leq 200$），描述一个矩形。其左下角坐标为 $(x_1,y_1)$，右上角坐标为 $x_2,y_2$。保证所有矩形面积为正，即其不会退化为线段或点。\n\n和现有的矩形一样，新绘制的矩形，其左下角和右上角坐标也必须是整数，且坐标必须在 $0 \\sim 200$ 之间，面积也必须为正。", "outputFormat": "输出被涂油漆恰好 $K$ 次区域的最大面积。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO19FEB] Painting the Barn G", "background": "", "description": "Farmer John 不太擅长多任务处理。他经常分心，很难完成一些长期的项目。目前，他正在谷仓的一侧刷油漆，但他一直忙着在很小的区域涂抹油漆，然后由于抚育母牛的需要而陷入困境，使谷仓的某些部分比其他部分涂有更多的油漆。\n\n我们将谷仓的墙描述为一个 X-Y 平面，每次涂油漆的区域都是一个矩形。FJ 在这个平面上绘制了 $N$ 个矩形，每个矩形的边均与坐标轴平行。因此我们用矩形的左下角和右上角坐标来描述一个矩形。\n\nFJ 想在谷仓里涂几层油漆，这样就不需要在不久的将来再次重新涂油漆。但是，他不想浪费时间涂过多的油漆。事实证明，$K$ 层涂料是最佳用量。但是因为涂油漆的面积太小了，FJ 并不太高兴。他决定最多再绘制两个**不相交**的矩形（这里的相交指两个矩形交的面积大于零，即如果两个矩形仅共用一条边或一个点，则不视为相交）来增加面积。当然不绘制新矩形或仅绘制一个新矩形也是允许的。", "inputFormat": "第一行两个整数 $N,K$（$1 \\leq N,K \\leq 10^5$）。\n\n接下来 $N$ 行，每行四个整数 $x_1,y_1,x_2,y_2$（$0 \\leq x_1,y_1,x_2,y_2 \\leq 200$），描述一个矩形。其左下角坐标为 $(x_1,y_1)$，右上角坐标为 $x_2,y_2$。保证所有矩形面积为正，即其不会退化为线段或点。\n\n和现有的矩形一样，新绘制的矩形，其左下角和右上角坐标也必须是整数，且坐标必须在 $0 \\sim 200$ 之间，面积也必须为正。", "outputFormat": "输出被涂油漆恰好 $K$ 次区域的最大面积。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6101", "type": "P", "difficulty": 2, "samples": [["nzhtl1477\n15\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷月赛"], "title": "[EER2] 出言不逊", "background": "你出言不逊是！！", "description": "珂愛想出公开赛，但每次都被拒绝。\n\n珂愛很生气，于是学会了出言不逊。\n\n珂愛用一个字符串 $S$ 存储了她想说的话，但这句话太逊了。为了出言不逊，珂愛要对字符串进行操作。每次操作，珂愛可以选择一个字符 $c$，若 $c$ 在字符串 $S$ 中出现了 $x$ 次，则珂愛会将 $x$ 个字符 $c$ 补到 $S$ 的尾部。\n\n珂愛认为，这个字符串长度至少为 $L$ 时，她才能出言不逊。珂愛想要知道，她至少需要操作多少次，才能让这个字符串的长度**大于等于** $L$。\n\n如果你不告诉珂愛，珂愛会对你出言不逊。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行一个正整数 $L$。\n\n意义见题目描述。", "outputFormat": "一行一个整数，表示最小操作次数。", "hint": "### 样例解释\n\n第一次操作，选择字符 `7`，字符串变为 `nzhtl147777`，长度为 $11$。\n\n第二次操作，选择字符 `7`，字符串变为 `nzhtl1477777777`，长度为 $15$。\n\n### 限制与约定\n\n对于 $100\\%$ 的数据，$1\\leq |S|\\leq 10^6$，$1\\leq L\\lt 2^{64}$，$S$ 中只可能出现大、小写英文字母和数字，共 $62$ 种不同字符。\n\n$|S|$ 表示字符串 $S$ 的长度。\n\n本题共有 $4$ 个子任务，每个子任务的限制如下：\n\n子任务 1（$15$ 分）：保证 $|S|=L-1$。\n\n子任务 2（$20$ 分）：保证 $S$ 中只出现字符 `d`。\n\n子任务 3（$30$ 分）：$L\\leq 10^6$。\n\n子任务 4（$35$ 分）：没有特殊限制。\n\n### 提示\n\n**请注意 $L$ 的上限**。\n\n**数据在 Windows 下生成，请注意每行的行末是 `\\r\\n` 而非 `\\n`。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER2] 出言不逊", "background": "你出言不逊是！！", "description": "珂愛想出公开赛，但每次都被拒绝。\n\n珂愛很生气，于是学会了出言不逊。\n\n珂愛用一个字符串 $S$ 存储了她想说的话，但这句话太逊了。为了出言不逊，珂愛要对字符串进行操作。每次操作，珂愛可以选择一个字符 $c$，若 $c$ 在字符串 $S$ 中出现了 $x$ 次，则珂愛会将 $x$ 个字符 $c$ 补到 $S$ 的尾部。\n\n珂愛认为，这个字符串长度至少为 $L$ 时，她才能出言不逊。珂愛想要知道，她至少需要操作多少次，才能让这个字符串的长度**大于等于** $L$。\n\n如果你不告诉珂愛，珂愛会对你出言不逊。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行一个正整数 $L$。\n\n意义见题目描述。", "outputFormat": "一行一个整数，表示最小操作次数。", "hint": "### 样例解释\n\n第一次操作，选择字符 `7`，字符串变为 `nzhtl147777`，长度为 $11$。\n\n第二次操作，选择字符 `7`，字符串变为 `nzhtl1477777777`，长度为 $15$。\n\n### 限制与约定\n\n对于 $100\\%$ 的数据，$1\\leq |S|\\leq 10^6$，$1\\leq L\\lt 2^{64}$，$S$ 中只可能出现大、小写英文字母和数字，共 $62$ 种不同字符。\n\n$|S|$ 表示字符串 $S$ 的长度。\n\n本题共有 $4$ 个子任务，每个子任务的限制如下：\n\n子任务 1（$15$ 分）：保证 $|S|=L-1$。\n\n子任务 2（$20$ 分）：保证 $S$ 中只出现字符 `d`。\n\n子任务 3（$30$ 分）：$L\\leq 10^6$。\n\n子任务 4（$35$ 分）：没有特殊限制。\n\n### 提示\n\n**请注意 $L$ 的上限**。\n\n**数据在 Windows 下生成，请注意每行的行末是 `\\r\\n` 而非 `\\n`。**", "locale": "zh-CN"}}}
{"pid": "P6102", "type": "P", "difficulty": 3, "samples": [["2\n1 2\n", "30\n"], ["6\n1 1 4 5 1 4\n", "3944\n"], ["7\n1 9 1 9 8 1 0\n", "12892\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["位运算", "洛谷月赛"], "title": "[EER2] 谔运算", "background": "在某个谔谔的一天中，CYJian 做到一道谔运算的谔谔题，CYJian 发现他不会做，于是决心从头开始研究令人谔谔的谔运算。", "description": "首先，CYJian 写出了一个长度为 $n$ 的数列 $a$。\n\n然后他灵光一动，写出了下面这个谔谔的式子：\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\sum_{k=1}^{n}\\sum_{l=1}^{n} (a_i\\ {\\rm or}\\ a_j)\\ {\\rm xor}\\ (a_k\\ {\\rm and}\\ a_l)$$\n\nCYJian 觉得这个是一个谔运算的简单式子，摁计算器花了 $114514{\\rm s}$ 就算出来了答案。\n\n为了证明你吊打 $114514$ 个 CYJian，请你在 $1{\\rm s}$ 内算出来这个式子的值吧。你只需要给出答案对 $2^{32}$ 取模的值即可。", "inputFormat": "第一行一个正整数 $n$ 表示数列的长度。\n\n第二行 $n$ 个非负整数，第 $i$ 个数表示 $a_i$。", "outputFormat": "一行一个非负整数，表示题目描述中给出式子的值。", "hint": "样例一解释：\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 0$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 1$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 1$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 2$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 1$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 2$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 3$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 3$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 1$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 3$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 2$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 2$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 0$\n\n对所有结果求和，即可得到答案为 $30$。\n\n---\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的测试点：$1 \\leq n \\leq 5 \\times 10^5$，$0 \\leq a_i \\leq 2^{32}-1$。\n\n本题共 $6$ 个子任务，各子任务的分值及约定如下：\n\n子任务 $1$（$1$ 分）：为样例一。\n\n子任务 $2$（$14$ 分）：$1 \\leq n \\leq 80$。\n\n子任务 $3$（$25$ 分）：$0 \\leq a_i \\leq 80$。\n\n子任务 $4$（$30$ 分）：$0 \\leq a_i \\leq 5000$。\n\n子任务 $5$（$25$ 分）：$1 \\leq n \\leq 1000$。\n\n子任务 $6$（$5$ 分）：无特殊限制。\n\n---\n\n#### 友情提示\n\n请注意数据范围。\n\n**如果您不知道上面的谔运算是什么，请参考[这里](https://www.luogu.com.cn/paste/oe4a9czd)**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER2] 谔运算", "background": "在某个谔谔的一天中，CYJian 做到一道谔运算的谔谔题，CYJian 发现他不会做，于是决心从头开始研究令人谔谔的谔运算。", "description": "首先，CYJian 写出了一个长度为 $n$ 的数列 $a$。\n\n然后他灵光一动，写出了下面这个谔谔的式子：\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\sum_{k=1}^{n}\\sum_{l=1}^{n} (a_i\\ {\\rm or}\\ a_j)\\ {\\rm xor}\\ (a_k\\ {\\rm and}\\ a_l)$$\n\nCYJian 觉得这个是一个谔运算的简单式子，摁计算器花了 $114514{\\rm s}$ 就算出来了答案。\n\n为了证明你吊打 $114514$ 个 CYJian，请你在 $1{\\rm s}$ 内算出来这个式子的值吧。你只需要给出答案对 $2^{32}$ 取模的值即可。", "inputFormat": "第一行一个正整数 $n$ 表示数列的长度。\n\n第二行 $n$ 个非负整数，第 $i$ 个数表示 $a_i$。", "outputFormat": "一行一个非负整数，表示题目描述中给出式子的值。", "hint": "样例一解释：\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 0$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 1$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 1$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 2$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 1$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 2$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 3$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 3$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 1$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 3$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 2$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 2$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 0$\n\n对所有结果求和，即可得到答案为 $30$。\n\n---\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的测试点：$1 \\leq n \\leq 5 \\times 10^5$，$0 \\leq a_i \\leq 2^{32}-1$。\n\n本题共 $6$ 个子任务，各子任务的分值及约定如下：\n\n子任务 $1$（$1$ 分）：为样例一。\n\n子任务 $2$（$14$ 分）：$1 \\leq n \\leq 80$。\n\n子任务 $3$（$25$ 分）：$0 \\leq a_i \\leq 80$。\n\n子任务 $4$（$30$ 分）：$0 \\leq a_i \\leq 5000$。\n\n子任务 $5$（$25$ 分）：$1 \\leq n \\leq 1000$。\n\n子任务 $6$（$5$ 分）：无特殊限制。\n\n---\n\n#### 友情提示\n\n请注意数据范围。\n\n**如果您不知道上面的谔运算是什么，请参考[这里](https://www.luogu.com.cn/paste/oe4a9czd)**。", "locale": "zh-CN"}}}
{"pid": "P6103", "type": "P", "difficulty": 4, "samples": [["4", "9"], ["7", "140"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "洛谷月赛"], "title": "[EER2] 直接自然溢出啥事没有", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)", "description": "给定一个整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个“程序片段”。\n\n具体定义如下：\n\n单个分号 `;` 是一个“语句”。\n\n空串 ` ` 是一个“程序片段”。\n\n如果字符串 `A` 是“程序片段”，字符串 `B` 是“语句”，则 `AB` 是“程序片段”。\n\n如果字符串 `A` 是“程序片段”，则 `{A}` 是“语句块”。\n\n如果字符串 `A` 是“语句块”，则 `A` 是“语句”，`[]A` 和 `[]()A` 都是“函数”。\n\n如果字符串 `A` 是“函数”，则 `(A)` 是“函数”，`A` 和 `A()` 都是“值”。\n\n如果字符串 `A` 是“值”，则 `(A)` 是“值”，`A;` 是“语句”。\n\n**注意：`A` 是 `B` 并不代表 `B` 是 `A`**。", "inputFormat": "一行，一个整数 $n$。", "outputFormat": "一行，一个整数，表示答案对 $18\\,446\\,744\\,073\\,709\\,551\\,616$（$2^{64}$） 取模的结果。", "hint": "### 样例一解释\n\n合法的“程序片段”有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n子任务 1（$20$ 分）：$n\\leq 10$。\n\n子任务 2（$20$ 分）：$n\\leq 100$。\n\n子任务 3（$20$ 分）：$n\\leq 2500$。\n\n子任务 4（$40$ 分）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$0\\leq n\\leq 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER2] 直接自然溢出啥事没有", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)", "description": "给定一个整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个“程序片段”。\n\n具体定义如下：\n\n单个分号 `;` 是一个“语句”。\n\n空串 ` ` 是一个“程序片段”。\n\n如果字符串 `A` 是“程序片段”，字符串 `B` 是“语句”，则 `AB` 是“程序片段”。\n\n如果字符串 `A` 是“程序片段”，则 `{A}` 是“语句块”。\n\n如果字符串 `A` 是“语句块”，则 `A` 是“语句”，`[]A` 和 `[]()A` 都是“函数”。\n\n如果字符串 `A` 是“函数”，则 `(A)` 是“函数”，`A` 和 `A()` 都是“值”。\n\n如果字符串 `A` 是“值”，则 `(A)` 是“值”，`A;` 是“语句”。\n\n**注意：`A` 是 `B` 并不代表 `B` 是 `A`**。", "inputFormat": "一行，一个整数 $n$。", "outputFormat": "一行，一个整数，表示答案对 $18\\,446\\,744\\,073\\,709\\,551\\,616$（$2^{64}$） 取模的结果。", "hint": "### 样例一解释\n\n合法的“程序片段”有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n子任务 1（$20$ 分）：$n\\leq 10$。\n\n子任务 2（$20$ 分）：$n\\leq 100$。\n\n子任务 3（$20$ 分）：$n\\leq 2500$。\n\n子任务 4（$40$ 分）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$0\\leq n\\leq 10^4$。", "locale": "zh-CN"}}}
{"pid": "P6104", "type": "P", "difficulty": 5, "samples": [["5 2 0\n3 5 8 14 16\n2 3\n1 3\n", "41\n32\n"], ["4 2 1\n2 3 5 8\n1 2\n12 9\n", "14\n28\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 700], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷月赛"], "title": "[EER2] 相同的数字", "background": "", "description": "每天早上在黑板上会写有 $n$ 个固定的数字，但是这些数字太无序了，所以每天晚上兔子想把他们变成相同的数字。\n\n有两种操作 :\n\n* 选择一个下标 $k$，将 $a_k$ 替换为 $a_k+1$。一次操作花费 $c_1$ 的时间。\n\n* 选择一个下标 $k$，将 $a_k$ 替换为大于 $a_k$ 的最小质数。一次操作花费 $c_2$ 的时间。\n\n兔子很懒，所以他不想花费太多的时间，你需要帮他计算出将所有数变相同的最小时间。\n\n总共会有 $q$ 天。兔子每天的状态不同，所以每一天会有不同的 $c_1$ 和 $c_2$。但是黑板上的数不会变。\n\n第一天花费的时间当然会影响第二天的状态。每天真实的 $c_1 = c'_1\\oplus\n (T \\times (lastans \\bmod 2^{17}))$，$c_2 = c'_2 \\oplus\n (T\\times (lastans \\bmod 2^{17}))$。其中 $\\oplus$ 为 $\\operatorname{xor}$ 运算，$lastans$ 为上一次的答案，最初 $lastans = 0$。", "inputFormat": "第一行三个整数 $n, q, T$，表示黑板上数的个数、总天数和一个参数。\n\n第二行 $n$ 个整数 $a_i$，表示黑板上的数。\n\n接下来 $q$ 行，每行两个整数 $c'_1, c'_2$，表示每天操作花费的参数。", "outputFormat": "共 $q$ 行，每行一个整数，表示一天的最小时间。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$1 \\leq a_i \\leq 10^7$，$0 \\leq T \\leq 1$，$1 \\leq q \\leq 10^6$，$1 \\leq c_1, c_2, c'_1, c'_2< 2^{17}$。\n\n| 测试点编号 | 分值 | $n\\leq$ | $a_i\\leq$ | $T=$ | $q\\leq$ |特殊性质|\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $100$ | $100$ | $0$ | $5$ |  所有 $a_i$ 都是质数，$c_1, c_2\\leq 10^4$|\n| $2$ | $10$ | $10^5$ | $10^5$ | $0$ | $5$ | |\n| $3$ | $25$ | $10^5$ | $10^7$ | $0$ | $5$ |  |\n| $4$ | $10$ | $10^5$ | $10^7$ | $1$ | $5$ | 所有 $a_i$ 都是质数||\n| $5$ | $20$ | $10^5$ | $10^7$ | $0$ | $10^5$ |  |\n| $6$ | $22$ | $10^5$ | $10^7$ | $1$ | $10^6$ | |\n|$7$ | $\\color{red}3$ | $10^5$ | $10^7$ | $1$ | $10^6$ | $\\color{red}{时限}$ $\\color{red}{700ms}$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER2] 相同的数字", "background": "", "description": "每天早上在黑板上会写有 $n$ 个固定的数字，但是这些数字太无序了，所以每天晚上兔子想把他们变成相同的数字。\n\n有两种操作 :\n\n* 选择一个下标 $k$，将 $a_k$ 替换为 $a_k+1$。一次操作花费 $c_1$ 的时间。\n\n* 选择一个下标 $k$，将 $a_k$ 替换为大于 $a_k$ 的最小质数。一次操作花费 $c_2$ 的时间。\n\n兔子很懒，所以他不想花费太多的时间，你需要帮他计算出将所有数变相同的最小时间。\n\n总共会有 $q$ 天。兔子每天的状态不同，所以每一天会有不同的 $c_1$ 和 $c_2$。但是黑板上的数不会变。\n\n第一天花费的时间当然会影响第二天的状态。每天真实的 $c_1 = c'_1\\oplus\n (T \\times (lastans \\bmod 2^{17}))$，$c_2 = c'_2 \\oplus\n (T\\times (lastans \\bmod 2^{17}))$。其中 $\\oplus$ 为 $\\operatorname{xor}$ 运算，$lastans$ 为上一次的答案，最初 $lastans = 0$。", "inputFormat": "第一行三个整数 $n, q, T$，表示黑板上数的个数、总天数和一个参数。\n\n第二行 $n$ 个整数 $a_i$，表示黑板上的数。\n\n接下来 $q$ 行，每行两个整数 $c'_1, c'_2$，表示每天操作花费的参数。", "outputFormat": "共 $q$ 行，每行一个整数，表示一天的最小时间。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$1 \\leq a_i \\leq 10^7$，$0 \\leq T \\leq 1$，$1 \\leq q \\leq 10^6$，$1 \\leq c_1, c_2, c'_1, c'_2< 2^{17}$。\n\n| 测试点编号 | 分值 | $n\\leq$ | $a_i\\leq$ | $T=$ | $q\\leq$ |特殊性质|\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $100$ | $100$ | $0$ | $5$ |  所有 $a_i$ 都是质数，$c_1, c_2\\leq 10^4$|\n| $2$ | $10$ | $10^5$ | $10^5$ | $0$ | $5$ | |\n| $3$ | $25$ | $10^5$ | $10^7$ | $0$ | $5$ |  |\n| $4$ | $10$ | $10^5$ | $10^7$ | $1$ | $5$ | 所有 $a_i$ 都是质数||\n| $5$ | $20$ | $10^5$ | $10^7$ | $0$ | $10^5$ |  |\n| $6$ | $22$ | $10^5$ | $10^7$ | $1$ | $10^6$ | |\n|$7$ | $\\color{red}3$ | $10^5$ | $10^7$ | $1$ | $10^6$ | $\\color{red}{时限}$ $\\color{red}{700ms}$ |", "locale": "zh-CN"}}}
{"pid": "P6105", "type": "P", "difficulty": 6, "samples": [["7 9\n1 2\n1 3\n1 0\n1 14\n2 14\n2 13\n1 1\n", "EE\n5\n8\n8\n8\n5\n7\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2010] y-fast trie", "background": "谔谔我\n\n本题读入量约 6 MB，输出量约 5 MB，请选择适合的输入输出方法", "description": "给定一个常数 $C$，你需要维护一个集合 $S$，支持 $n$ 次操作：\n\n- 操作1：给出 $x$，插入一个元素 $x$，保证之前集合中没有 $x$ 这个元素\n- 操作2：给出 $x$，删除一个元素 $x$，保证之前集合中存在 $x$ 这个元素\n\n每次操作结束后，需要输出 $\\max\\limits_{\\substack{ i, j \\in S \\\\ i \\ne j }} \\bigl( (i+j) \\bmod C \\bigr)$，即从 $S$ 集合中选出两个不同的元素，其的和 $\\bmod~C$ 的最大值，如果 $S$ 集合中不足两个元素，则输出 `EE`。\n\n本题强制在线，每次的 $x$ 需要 $\\operatorname{xor}$ 上次答案 ，如果之前没有询问或者输出了 `EE`，则上次答案为 $0$。", "inputFormat": "第一行两个整数 $n, C$。\n\n接下来 $n$ 行，每行有两个整数 $1~x$ 或 $2~x$，表示第一类或第二类操作。", "outputFormat": "输出 $n$ 行，第 $i$ 行表示第 $i$ 次操作结束后的答案。", "hint": "Idea：zhouwc，Solution：ccz181078&nzhtl1477，Code：ccz181078&nzhtl1477，Data：nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $1\\%$ 的数据，为样例 1。\n\n对于另外 $9\\%$ 的数据，集合中元素个数 $\\le 1$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 10^4$。\n\n对于另外 $19\\%$ 的数据，$1\\leq n,C \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\leq 5\\times 10^5$，$1\\leq C\\leq 1073741823$，$0\\leq x\\leq 1073741823$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2010] y-fast trie", "background": "谔谔我\n\n本题读入量约 6 MB，输出量约 5 MB，请选择适合的输入输出方法", "description": "给定一个常数 $C$，你需要维护一个集合 $S$，支持 $n$ 次操作：\n\n- 操作1：给出 $x$，插入一个元素 $x$，保证之前集合中没有 $x$ 这个元素\n- 操作2：给出 $x$，删除一个元素 $x$，保证之前集合中存在 $x$ 这个元素\n\n每次操作结束后，需要输出 $\\max\\limits_{\\substack{ i, j \\in S \\\\ i \\ne j }} \\bigl( (i+j) \\bmod C \\bigr)$，即从 $S$ 集合中选出两个不同的元素，其的和 $\\bmod~C$ 的最大值，如果 $S$ 集合中不足两个元素，则输出 `EE`。\n\n本题强制在线，每次的 $x$ 需要 $\\operatorname{xor}$ 上次答案 ，如果之前没有询问或者输出了 `EE`，则上次答案为 $0$。", "inputFormat": "第一行两个整数 $n, C$。\n\n接下来 $n$ 行，每行有两个整数 $1~x$ 或 $2~x$，表示第一类或第二类操作。", "outputFormat": "输出 $n$ 行，第 $i$ 行表示第 $i$ 次操作结束后的答案。", "hint": "Idea：zhouwc，Solution：ccz181078&nzhtl1477，Code：ccz181078&nzhtl1477，Data：nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $1\\%$ 的数据，为样例 1。\n\n对于另外 $9\\%$ 的数据，集合中元素个数 $\\le 1$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 10^4$。\n\n对于另外 $19\\%$ 的数据，$1\\leq n,C \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\leq 5\\times 10^5$，$1\\leq C\\leq 1073741823$，$0\\leq x\\leq 1073741823$。", "locale": "zh-CN"}}}
{"pid": "P6106", "type": "P", "difficulty": 7, "samples": [["2\n1 1 4 4\n2 1 4 3\n4\n1 1 6 6\n1 1 3 3\n2 1 3 3\n1 2 2 4", "1\n0.6\n0.4\n0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "平衡树", "Special Judge", "O2优化", "扫描线", "Ynoi"], "title": "[Ynoi2010] Self Adjusting Top Tree", "background": "", "description": "平面上有 $n$ 条线段。\n\n共 $m$ 次询问，每次询问给出一个边平行于坐标轴的矩形，问 每条与矩形有交的线段与矩形的交的长度之和 与 所有线段的长度之和 的 比值，要求输出与标准答案的相对误差或绝对误差不超过 $10^{-6}$。\n\n线段以 $x_1\\;y_1\\;x_2\\;y_2$ 的形式给出，表示以 $(x_1,y_1),(x_2,y_2)$ 为端点的线段，保证任意两条线段没有交点或重合部分，且 $x_1\\ne x_2,y_1\\ne y_2$。\n\n矩形以 $x_1\\;y_1\\;x_2\\;y_2$ 的形式给出，表示矩形 $\\{(x,y)|x_1\\le x\\le x_2,y_1\\le y\\le y_2\\}$，保证 $x_1< x_2, y_1< y_2$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行四个由空格分隔的整数 $x1,y1,x2,y2$，表示线段。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行四个由空格分隔的整数 $x1,y1,x2,y2$，表示询问的矩形。", "outputFormat": "对每个询问，输出一行，一个介于 $0$ 和 $1$ 之间的十进制小数，表示答案", "hint": "Idea：nzhtl1477&ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^5, 1\\le x_1,y_1,x_2,y_2\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2010] Self Adjusting Top Tree", "background": "", "description": "平面上有 $n$ 条线段。\n\n共 $m$ 次询问，每次询问给出一个边平行于坐标轴的矩形，问 每条与矩形有交的线段与矩形的交的长度之和 与 所有线段的长度之和 的 比值，要求输出与标准答案的相对误差或绝对误差不超过 $10^{-6}$。\n\n线段以 $x_1\\;y_1\\;x_2\\;y_2$ 的形式给出，表示以 $(x_1,y_1),(x_2,y_2)$ 为端点的线段，保证任意两条线段没有交点或重合部分，且 $x_1\\ne x_2,y_1\\ne y_2$。\n\n矩形以 $x_1\\;y_1\\;x_2\\;y_2$ 的形式给出，表示矩形 $\\{(x,y)|x_1\\le x\\le x_2,y_1\\le y\\le y_2\\}$，保证 $x_1< x_2, y_1< y_2$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行四个由空格分隔的整数 $x1,y1,x2,y2$，表示线段。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行四个由空格分隔的整数 $x1,y1,x2,y2$，表示询问的矩形。", "outputFormat": "对每个询问，输出一行，一个介于 $0$ 和 $1$ 之间的十进制小数，表示答案", "hint": "Idea：nzhtl1477&ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^5, 1\\le x_1,y_1,x_2,y_2\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P6107", "type": "P", "difficulty": 7, "samples": [["6\n1 2 5 4 3 6\n4\n1 8\n3 6\n5 10\n2 7", "3\n0\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2010", "O2优化", "Ynoi"], "title": "[Ynoi2010] Worst Case Top Tree", "background": "", "description": "给定序列 $a_0,a_1,a_2\\dots,a_n,a_{n+1}$；\n\n满足 $a_0=a_{n+1}=+\\infty$，$a_1,a_2,\\dots,a_n$ 在输入中给出；\n\n对 $1\\le x \\le n$，称 $\\max_{0\\le i<x,a_i\\ge a_x} i$ 和 $x$ 是**相邻**的，且 $\\min_{x<i\\le n+1,a_i>a_x} i$ 和 $x$ 是**相邻**的；\n\n如果 $x$ 和 $y$ 相邻，则 $y$ 和 $x$ 也相邻；\n\n如果 $0\\le b_1,b_2,b_3,b_4,b_5,b_6\\le n+1$，且 $b_i$ 和 $b_{i+1}$ 相邻，$b_1$ 和 $b_6$ 相邻，$b_i$ 互不相同，则称集合 $\\{b_1,b_2,b_3,b_4,b_5,b_6\\}$ 是一个六元环（即判断两个六元环是否相同时，不考虑 $b_i$ 的顺序）。\n\n共有 $m$ 次修改操作，每次修改操作给出 $x\\;y$，将 $a_x$ 改为 $a_x+y$；\n\n每次修改后要求输出六元环的个数；", "inputFormat": "第一行一个整数 $n$；\n\n第二行 $n$ 个整数表示 $a_1\\;a_2\\;\\dots\\;a_n$；\n\n第三行一个整数 $m$；\n\n接下来 $m$ 行，每行两个整数 $x\\;y$ 表示一次修改操作。", "outputFormat": "共 $m$ 行，每行一个整数，表示每次修改后的六元环个数。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078&zx2003，Data：nzhtl1477&zx2003\n\n对于 $100\\%$ 的数据，以上提到的所有数值为整数，且 $1\\le n,m\\le 5\\cdot 10^5;\\;1\\le x\\le n;\\;1\\le a_i,y\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2010] Worst Case Top Tree", "background": "", "description": "给定序列 $a_0,a_1,a_2\\dots,a_n,a_{n+1}$；\n\n满足 $a_0=a_{n+1}=+\\infty$，$a_1,a_2,\\dots,a_n$ 在输入中给出；\n\n对 $1\\le x \\le n$，称 $\\max_{0\\le i<x,a_i\\ge a_x} i$ 和 $x$ 是**相邻**的，且 $\\min_{x<i\\le n+1,a_i>a_x} i$ 和 $x$ 是**相邻**的；\n\n如果 $x$ 和 $y$ 相邻，则 $y$ 和 $x$ 也相邻；\n\n如果 $0\\le b_1,b_2,b_3,b_4,b_5,b_6\\le n+1$，且 $b_i$ 和 $b_{i+1}$ 相邻，$b_1$ 和 $b_6$ 相邻，$b_i$ 互不相同，则称集合 $\\{b_1,b_2,b_3,b_4,b_5,b_6\\}$ 是一个六元环（即判断两个六元环是否相同时，不考虑 $b_i$ 的顺序）。\n\n共有 $m$ 次修改操作，每次修改操作给出 $x\\;y$，将 $a_x$ 改为 $a_x+y$；\n\n每次修改后要求输出六元环的个数；", "inputFormat": "第一行一个整数 $n$；\n\n第二行 $n$ 个整数表示 $a_1\\;a_2\\;\\dots\\;a_n$；\n\n第三行一个整数 $m$；\n\n接下来 $m$ 行，每行两个整数 $x\\;y$ 表示一次修改操作。", "outputFormat": "共 $m$ 行，每行一个整数，表示每次修改后的六元环个数。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078&zx2003，Data：nzhtl1477&zx2003\n\n对于 $100\\%$ 的数据，以上提到的所有数值为整数，且 $1\\le n,m\\le 5\\cdot 10^5;\\;1\\le x\\le n;\\;1\\le a_i,y\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6108", "type": "P", "difficulty": 6, "samples": [["4 4\n1 2 4 1\n2 1 3\n1 1 2 2\n2 1 4", "388206138\n339680376"], ["10 20\n1 4 4 520968631\n1 4 7 988452236\n1 4 9 355405133\n2 9 10\n2 2 8\n1 3 5 400339337\n2 3 8\n2 6 7\n2 4 10\n2 7 9\n1 3 8 387471594\n1 2 4 559944503\n2 1 8\n1 4 7 108832063\n2 5 9\n2 4 8\n1 3 8 622785003\n2 9 10\n1 2 7 252591713\n1 5 6 666406180", "570099967\n274921471\n285269733\n0\n571283655\n970723747\n401326984\n17519114\n844628984\n570099967"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2009", "O2优化", "Ynoi"], "title": "[Ynoi2009] rprsvq", "background": "", "description": "你有一个长度为 $n$ 的序列 $v_1, v_2, \\dots, v_n$，初值全都为 $0$。\n\n你要进行 $m$ 次操作：\n\n- 操作 1：给出 $l,r,a$，将 $v_l,v_{l+1},\\dots ,v_r$ 的值加上 $a$。\n- 操作 2：给出 $l,r$，求在$v_l,v_{l+1}, \\dots ,v_r$ 中选出一个非空的子序列，求所有方案中选出的子序列的方差之和，答案对 $998244353$ 取模。\n\n一个序列 $a_1,a_2, \\dots, a_n$ 的方差定义为令 $\\bar{a}=\\frac{1}{n}\\sum_{i=1}^n a_i$，则方差为 $\\frac{1}{n}\\sum_{i=1}^n (a_i-\\bar{a})^2$。", "inputFormat": "第一行两个整数 $n, m$。\n\n接下来 $m$ 行，每行有四个整数 $1~l~r~a$ 或三个整数 $2~l~r$，表示第一类或第二类操作，保证 $0\\leq a< 998244353$。\n", "outputFormat": "对每个第二类操作，输出一行表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $10\\%$ 的数据，$n\\leq 10, m\\leq 1000$。\n\n对于 $20\\%$ 的数据，$n\\leq 16, m\\leq 1000$。\n\n对于 $30\\%$ 的数据，$n\\leq 100, m\\leq 10^3$。\n\n对于 $50\\%$ 的数据，$n, m\\leq 10^3$。\n\n对于另外$10\\%$的数据，$n\\leq 10^5$，保证首先是第一类操作，然后是第二类操作。\n\n对于 $80\\%$ 的数据，$n, m\\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\leq 5\\times 10^6,1\\leq m\\leq 10^5$。\n\n对于第一个测试数据的第一个询问，序列是 $\\{0,1,1\\}$，所有的子序列中只有 $\\{0,1\\}, \\{0,1\\}$ 和 $\\{0,1,1\\}$ 方差不为 $0$，分别是 $\\frac{1}{4}, \\frac{1}{4}, \\frac{2}{9}$，总和为 $\\frac{13}{18}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2009] rprsvq", "background": "", "description": "You have a sequence $v_1, v_2, \\dots, v_n$ of length $n$, with all initial values equal to $0$.\n\nYou need to perform $m$ operations:\n\n- Operation 1: Given $l, r, a$, add $a$ to $v_l, v_{l+1}, \\dots, v_r$.\n- Operation 2: Given $l, r$, choose a non-empty subsequence from $v_l, v_{l+1}, \\dots, v_r$. For all possible choices, compute the sum of variances of the chosen subsequences. Output the answer modulo $998244353$.\n\nThe variance of a sequence $a_1, a_2, \\dots, a_n$ is defined as follows. Let $\\bar{a}=\\frac{1}{n}\\sum_{i=1}^n a_i$, then the variance is $\\frac{1}{n}\\sum_{i=1}^n (a_i-\\bar{a})^2$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next $m$ lines describe the operations. Each line contains either four integers $1~l~r~a$ or three integers $2~l~r$, representing an operation of the first type or the second type. It is guaranteed that $0\\leq a< 998244353$.", "outputFormat": "For each operation of the second type, output one line containing the answer.", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078.\n\nConstraints:\n\nFor $10\\%$ of the testdata, $n\\leq 10, m\\leq 1000$.\n\nFor $20\\%$ of the testdata, $n\\leq 16, m\\leq 1000$.\n\nFor $30\\%$ of the testdata, $n\\leq 100, m\\leq 10^3$.\n\nFor $50\\%$ of the testdata, $n, m\\leq 10^3$.\n\nFor another $10\\%$ of the testdata, $n\\leq 10^5$, and it is guaranteed that all operations of the first type come first, followed by operations of the second type.\n\nFor $80\\%$ of the testdata, $n, m\\leq 10^5$.\n\nFor $100\\%$ of the testdata, $1\\leq n \\leq 5\\times 10^6, 1\\leq m\\leq 10^5$.\n\nFor the first query in the first testdata, the sequence is $\\{0,1,1\\}$. Among all subsequences, only $\\{0,1\\}$, $\\{0,1\\}$, and $\\{0,1,1\\}$ have non-zero variance, which are $\\frac{1}{4}, \\frac{1}{4}, \\frac{2}{9}$ respectively. Their total sum is $\\frac{13}{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2009] rprsvq", "background": "", "description": "你有一个长度为 $n$ 的序列 $v_1, v_2, \\dots, v_n$，初值全都为 $0$。\n\n你要进行 $m$ 次操作：\n\n- 操作 1：给出 $l,r,a$，将 $v_l,v_{l+1},\\dots ,v_r$ 的值加上 $a$。\n- 操作 2：给出 $l,r$，求在$v_l,v_{l+1}, \\dots ,v_r$ 中选出一个非空的子序列，求所有方案中选出的子序列的方差之和，答案对 $998244353$ 取模。\n\n一个序列 $a_1,a_2, \\dots, a_n$ 的方差定义为令 $\\bar{a}=\\frac{1}{n}\\sum_{i=1}^n a_i$，则方差为 $\\frac{1}{n}\\sum_{i=1}^n (a_i-\\bar{a})^2$。", "inputFormat": "第一行两个整数 $n, m$。\n\n接下来 $m$ 行，每行有四个整数 $1~l~r~a$ 或三个整数 $2~l~r$，表示第一类或第二类操作，保证 $0\\leq a< 998244353$。\n", "outputFormat": "对每个第二类操作，输出一行表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $10\\%$ 的数据，$n\\leq 10, m\\leq 1000$。\n\n对于 $20\\%$ 的数据，$n\\leq 16, m\\leq 1000$。\n\n对于 $30\\%$ 的数据，$n\\leq 100, m\\leq 10^3$。\n\n对于 $50\\%$ 的数据，$n, m\\leq 10^3$。\n\n对于另外$10\\%$的数据，$n\\leq 10^5$，保证首先是第一类操作，然后是第二类操作。\n\n对于 $80\\%$ 的数据，$n, m\\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\leq 5\\times 10^6,1\\leq m\\leq 10^5$。\n\n对于第一个测试数据的第一个询问，序列是 $\\{0,1,1\\}$，所有的子序列中只有 $\\{0,1\\}, \\{0,1\\}$ 和 $\\{0,1,1\\}$ 方差不为 $0$，分别是 $\\frac{1}{4}, \\frac{1}{4}, \\frac{2}{9}$，总和为 $\\frac{13}{18}$。\n", "locale": "zh-CN"}}}
{"pid": "P6109", "type": "P", "difficulty": 7, "samples": [["5 5 5\n1 1 4 5 4\n4 1 4 1 10\n1 3 3 3 3\n1 1 5 5 8\n2 4 4 5 8\n2 1 2 1\n4 1 5 4\n1 2 3 5\n2 1 5 3\n1 3 5 5\n", "12\n22\n20\n22\n20\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2009", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2009] rprmq1", "background": "我谔谔\n\n本题读入量约 13 MB，输出量约 7 MB，请选择合适的输入输出方法", "description": "有一个 $n \\times n$ 的矩阵 $a$，初始全是 $0$，有 $m$ 次修改操作和 $q$ 次查询操作，先进行所有修改操作，然后进行所有查询操作。\n\n一次修改操作会给出 $l_1,l_2,r_1,r_2,x$，代表把所有满足 $l_1 \\le i \\le r_1$ 且 $l_2 \\le j \\le r_2$ 的 $a_{i,j}$ 元素加上一个值 $x$。\n\n一次查询操作会给出 $l_1,l_2,r_1,r_2$，代表查询所有满足 $l_1 \\le i \\le r_1$ 且 $l_2 \\le j \\le r_2$ 的 $a_{i,j}$ 元素的最大值。", "inputFormat": "第一行三个由空格分隔的整数 $n,m,q$。\n\n之后 $m$ 行，每行给出五个整数 $l_1,l_2,r_1,r_2,x$，表示一次修改操作。\n\n之后 $q$ 行，每行给出四个整数 $l_1,l_2,r_1,r_2$，表示一次查询操作。", "outputFormat": "输出 $q$ 行，对每次查询操作输出一行一个数表示答案。", "hint": "Idea：apiadu，Solution：ccz181078，Code：apiadu，Data：apiadu&nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $1\\%$ 的数据，为样例 1。\n\n对于另外 $9\\%$ 的数据，$n=1$。\n\n对于另外 $19\\%$ 的数据，$n,m\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 2000$，$q\\leq 2\\times 10^5$。\n\n对于另外 $19\\%$ 的数据，$m,q\\leq 2000$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 5\\times 10^4$，$1\\leq q \\leq 5\\times 10^5$，$1\\leq x\\leq 2147483647$，$1\\leq l_1\\leq r_1\\leq n$，$1\\leq l_2\\leq r_2\\leq n$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2009] rprmq1", "background": "我谔谔\n\n本题读入量约 13 MB，输出量约 7 MB，请选择合适的输入输出方法", "description": "有一个 $n \\times n$ 的矩阵 $a$，初始全是 $0$，有 $m$ 次修改操作和 $q$ 次查询操作，先进行所有修改操作，然后进行所有查询操作。\n\n一次修改操作会给出 $l_1,l_2,r_1,r_2,x$，代表把所有满足 $l_1 \\le i \\le r_1$ 且 $l_2 \\le j \\le r_2$ 的 $a_{i,j}$ 元素加上一个值 $x$。\n\n一次查询操作会给出 $l_1,l_2,r_1,r_2$，代表查询所有满足 $l_1 \\le i \\le r_1$ 且 $l_2 \\le j \\le r_2$ 的 $a_{i,j}$ 元素的最大值。", "inputFormat": "第一行三个由空格分隔的整数 $n,m,q$。\n\n之后 $m$ 行，每行给出五个整数 $l_1,l_2,r_1,r_2,x$，表示一次修改操作。\n\n之后 $q$ 行，每行给出四个整数 $l_1,l_2,r_1,r_2$，表示一次查询操作。", "outputFormat": "输出 $q$ 行，对每次查询操作输出一行一个数表示答案。", "hint": "Idea：apiadu，Solution：ccz181078，Code：apiadu，Data：apiadu&nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $1\\%$ 的数据，为样例 1。\n\n对于另外 $9\\%$ 的数据，$n=1$。\n\n对于另外 $19\\%$ 的数据，$n,m\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 2000$，$q\\leq 2\\times 10^5$。\n\n对于另外 $19\\%$ 的数据，$m,q\\leq 2000$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 5\\times 10^4$，$1\\leq q \\leq 5\\times 10^5$，$1\\leq x\\leq 2147483647$，$1\\leq l_1\\leq r_1\\leq n$，$1\\leq l_2\\leq r_2\\leq n$。\n", "locale": "zh-CN"}}}
{"pid": "P6111", "type": "P", "difficulty": 3, "samples": [["4 3\n1 2 3\n2 3 2\n2 4 4\n1 2\n4 1\n3 1", "3\n0\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["搜索", "2018", "USACO", "并查集", "深度优先搜索 DFS"], "title": "[USACO18JAN] MooTube S", "background": "*本题与 [金组同名题目](/problem/P4185) 在题意上一致，唯一的差别是数据范围。*", "description": "在业余时间，Farmer John 创建了一个新的视频共享服务，他将其命名为 MooTube。在 MooTube 上，Farmer John 的奶牛可以录制，分享和发现许多有趣的视频。他的奶牛已经发布了 $N$ 个视频（$1 \\leq N \\leq 5000$），为了方便将其编号为  $1 \\ldots N$ 。然而，FJ 无法弄清楚如何帮助他的奶牛找到他们可能喜欢的新视频。\n\nFJ 希望为每个 MooTube 视频创建一个“推荐视频”列表。这样，奶牛将被推荐与他们已经观看过的视频最相关的视频。\n\nFJ 设计了一个“相关性”度量标准，顾名思义，它确定了两个视频相互之间的相关性。他选择 $N-1$ 对视频并手动计算其之间的相关性。然后，FJ 将他的视频建成一棵树，其中每个视频是节点，并且他手动将 $N-1$ 对视频连接。为了方便，FJ 选择了 $N-1$ 对，这样任意视频都可以通过一条连通路径到达任意其他视频。 FJ 决定将任意一对视频的相关性定义为沿此路径的任何连接的最小相关性。\n\nFarmer John 想要选择一个 $K$ 值，以便在任何给定的 MooTube 视频旁边，推荐所有其他与该视频至少有 $K$ 相关的视频。然而，FJ 担心会向他的奶牛推荐太多的视频，这可能会分散他们对产奶的注意力！因此，他想设定适当的 $K$ 值。 Farmer John希望得到您的帮助，回答有关 $K$ 值的推荐视频的一些问题。", "inputFormat": "第一行输入包含 $N$ 和 $Q$（$1 \\leq Q \\leq 5000$）。\n\n接下来的 $N-1$ 行描述了 FJ 手动比较的一对视频。 每行包括三个整数  $p_i$，$q_i$ 和 $r_i$（$1 \\leq p_i, q_i \\leq N$，$1 \\leq r_i \\leq 10^9$），表示视频 $p_i$ 和 $q_i$ 已连接并且相关性为 $r_i$。\n\n接下来的 $Q$ 行描述了 Farmer John 的 $Q$ 个问题。每行包含两个整数，$k_i$ 和 $v_i$（$1 \\leq k_i \\leq 10^9$，$1 \\leq v_i \\leq N$），表示 FJ 的第 $i$ 个问题询问中当 $K = k_i$ 时，第 $v_i$ 个视频推荐列表中将推荐的视频数。", "outputFormat": "输出 $Q$ 行。在第 $i$ 行，输出 FJ 的第 $i$ 个问题的答案。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO18JAN] MooTube S", "background": "*本题与 [金组同名题目](/problem/P4185) 在题意上一致，唯一的差别是数据范围。*", "description": "在业余时间，Farmer John 创建了一个新的视频共享服务，他将其命名为 MooTube。在 MooTube 上，Farmer John 的奶牛可以录制，分享和发现许多有趣的视频。他的奶牛已经发布了 $N$ 个视频（$1 \\leq N \\leq 5000$），为了方便将其编号为  $1 \\ldots N$ 。然而，FJ 无法弄清楚如何帮助他的奶牛找到他们可能喜欢的新视频。\n\nFJ 希望为每个 MooTube 视频创建一个“推荐视频”列表。这样，奶牛将被推荐与他们已经观看过的视频最相关的视频。\n\nFJ 设计了一个“相关性”度量标准，顾名思义，它确定了两个视频相互之间的相关性。他选择 $N-1$ 对视频并手动计算其之间的相关性。然后，FJ 将他的视频建成一棵树，其中每个视频是节点，并且他手动将 $N-1$ 对视频连接。为了方便，FJ 选择了 $N-1$ 对，这样任意视频都可以通过一条连通路径到达任意其他视频。 FJ 决定将任意一对视频的相关性定义为沿此路径的任何连接的最小相关性。\n\nFarmer John 想要选择一个 $K$ 值，以便在任何给定的 MooTube 视频旁边，推荐所有其他与该视频至少有 $K$ 相关的视频。然而，FJ 担心会向他的奶牛推荐太多的视频，这可能会分散他们对产奶的注意力！因此，他想设定适当的 $K$ 值。 Farmer John希望得到您的帮助，回答有关 $K$ 值的推荐视频的一些问题。", "inputFormat": "第一行输入包含 $N$ 和 $Q$（$1 \\leq Q \\leq 5000$）。\n\n接下来的 $N-1$ 行描述了 FJ 手动比较的一对视频。 每行包括三个整数  $p_i$，$q_i$ 和 $r_i$（$1 \\leq p_i, q_i \\leq N$，$1 \\leq r_i \\leq 10^9$），表示视频 $p_i$ 和 $q_i$ 已连接并且相关性为 $r_i$。\n\n接下来的 $Q$ 行描述了 Farmer John 的 $Q$ 个问题。每行包含两个整数，$k_i$ 和 $v_i$（$1 \\leq k_i \\leq 10^9$，$1 \\leq v_i \\leq N$），表示 FJ 的第 $i$ 个问题询问中当 $K = k_i$ 时，第 $v_i$ 个视频推荐列表中将推荐的视频数。", "outputFormat": "输出 $Q$ 行。在第 $i$ 行，输出 FJ 的第 $i$ 个问题的答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6112", "type": "P", "difficulty": 6, "samples": [["4", "9"], ["7", "140"], ["8923", "424180943"], ["114514", "552971057"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "递推", "O2优化", "生成函数"], "title": "直接自然溢出啥事没有 加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P6103)    \n本题与原题的区别，只有模数和数据范围不同。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)", "description": "给定一个正整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个「程序片段」。\n\n具体定义如下：\n\n单个分号 `;` 是一个「语句」。\n\n空串 是一个「程序片段」。\n\n如果字符串 `A` 是「程序片段」，字符串 `B` 是「语句」，则 `AB` 是「程序片段」。\n\n如果字符串 `A` 是「程序片段」，则 `{A}` 是「语句块」。\n\n如果字符串 `A` 是「语句块」，则 `A` 是「语句」，`[]A` 和 `[]()A` 都是「函数」。\n\n如果字符串 `A` 是「函数」，则 `(A)` 是「函数」，`A` 和 `A()` 都是「值」。\n\n如果字符串 `A` 是「值」，则 `(A)` 是「值」，`A;` 是「语句」。\n\n**注意：`A` 是 `B` 并不代表 `B` 是 `A`。**", "inputFormat": "输入一行一个正整数 $n$。", "outputFormat": "输出一行一个整数表示答案，作为良心出题人，你只需要对 $998244353$ 取模。", "hint": "【样例一解释】  \n合法的「程序片段」有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。\n\n【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^5$；   \n对于 $100\\%$ 的数据，$1\\le n \\le 10^7$。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "直接自然溢出啥事没有 加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P6103)    \n本题与原题的区别，只有模数和数据范围不同。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)", "description": "给定一个正整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个「程序片段」。\n\n具体定义如下：\n\n单个分号 `;` 是一个「语句」。\n\n空串 是一个「程序片段」。\n\n如果字符串 `A` 是「程序片段」，字符串 `B` 是「语句」，则 `AB` 是「程序片段」。\n\n如果字符串 `A` 是「程序片段」，则 `{A}` 是「语句块」。\n\n如果字符串 `A` 是「语句块」，则 `A` 是「语句」，`[]A` 和 `[]()A` 都是「函数」。\n\n如果字符串 `A` 是「函数」，则 `(A)` 是「函数」，`A` 和 `A()` 都是「值」。\n\n如果字符串 `A` 是「值」，则 `(A)` 是「值」，`A;` 是「语句」。\n\n**注意：`A` 是 `B` 并不代表 `B` 是 `A`。**", "inputFormat": "输入一行一个正整数 $n$。", "outputFormat": "输出一行一个整数表示答案，作为良心出题人，你只需要对 $998244353$ 取模。", "hint": "【样例一解释】  \n合法的「程序片段」有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。\n\n【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^5$；   \n对于 $100\\%$ 的数据，$1\\le n \\le 10^7$。  ", "locale": "zh-CN"}}}
{"pid": "P6113", "type": "P", "difficulty": 6, "samples": [["10 10\n4 3\n3 1\n4 7\n2 10\n2 9\n3 10\n5 9\n4 6\n1 10\n1 7\n", "4\n7 9 10 6 0 4 1 0 2 3 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "一般图的最大匹配", "线性代数", "模板题"], "title": "【模板】一般图最大匹配", "background": "模板题，无背景。", "description": "给出一张 $n$ 个点 $m$ 条边的无向图，求该图的最大匹配。", "inputFormat": "第一行两个正整数 $n$ 和 $m$，分别表示图的点数和边数。\n\n接下来 $m$ 行，每行两个正整数 $u$ 和 $v$，表示图中存在一条连接 $u$ 和 $v$ 的无向边。", "outputFormat": "第一行一个整数，表示最大匹配数。\n\n第二行 $n$ 个整数，第 $i$ 个数表示与结点 $i$ 匹配的结点编号，若该结点无匹配则输出 $0$。\n\n如有多解输出任意解即可。", "hint": "对于 $50\\%$ 的数据，$n\\le500$。\n\n对于 $100\\%$ 的数据，$2\\le n\\le10^3$，$1\\le m\\le5\\times10^4$。\n\n本题有 5 组 extra test。\n\n####  提示\n为了方便你调试你的程序，出题人在[这里](https://www.luogu.com.cn/paste/vf7dlo6r)为你提供了一个~~写的很丑的~~数据生成器。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】一般图最大匹配", "background": "模板题，无背景。", "description": "给出一张 $n$ 个点 $m$ 条边的无向图，求该图的最大匹配。", "inputFormat": "第一行两个正整数 $n$ 和 $m$，分别表示图的点数和边数。\n\n接下来 $m$ 行，每行两个正整数 $u$ 和 $v$，表示图中存在一条连接 $u$ 和 $v$ 的无向边。", "outputFormat": "第一行一个整数，表示最大匹配数。\n\n第二行 $n$ 个整数，第 $i$ 个数表示与结点 $i$ 匹配的结点编号，若该结点无匹配则输出 $0$。\n\n如有多解输出任意解即可。", "hint": "对于 $50\\%$ 的数据，$n\\le500$。\n\n对于 $100\\%$ 的数据，$2\\le n\\le10^3$，$1\\le m\\le5\\times10^4$。\n\n本题有 5 组 extra test。\n\n####  提示\n为了方便你调试你的程序，出题人在[这里](https://www.luogu.com.cn/paste/vf7dlo6r)为你提供了一个~~写的很丑的~~数据生成器。", "locale": "zh-CN"}}}
{"pid": "P6114", "type": "P", "difficulty": 6, "samples": [["ababa\n", "3\n"], ["bbababaabaaabaaaab\n", "23\n"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "Lyndon 分解", "模板题"], "title": "【模板】Lyndon 分解", "background": "", "description": "这是一道模板题。\n\n读入一个由小写英文字母组成的字符串 $s$ ，请把这个字符串分成若干部分 $s=s_1s_2s_3\\cdots s_m$，使得每个 $s_i$ 都是 [$\\text{Lyndon Word}$](https://en.wikipedia.org/wiki/Lyndon_word)，且 $\\forall 1\\le i<m:s_i\\ge s_{i+1}$。输出 $s_1$ 到 $s_m$ 这些串长度的右端点的位置。位置编号为 $1$ 到 $n$。\n\n一个字符串 $s$ 是一个 $\\text{Lyndon Word}$，当且仅当 $s$ 是其所有后缀中最小的字符串。\n\n为了减小输出量，你只需要输出所有右端点的异或和。", "inputFormat": "一行一个长度为 $n$ 的仅包含小写英文字母的字符串 $s$。", "outputFormat": "一行一个整数，表示所有右端点的异或和。", "hint": "第一组样例的答案为 `2 4 5`。\n\n第二组样例的答案为 `1 2 4 6 9 13 18`。\n\n- 对于 $20\\%$ 的数据，保证 $1\\le n\\le 1000$；\n- 对于 $100\\%$ 的数据，保证 $1\\le n\\le 5\\times 10^6+1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】Lyndon 分解", "background": "", "description": "这是一道模板题。\n\n读入一个由小写英文字母组成的字符串 $s$ ，请把这个字符串分成若干部分 $s=s_1s_2s_3\\cdots s_m$，使得每个 $s_i$ 都是 [$\\text{Lyndon Word}$](https://en.wikipedia.org/wiki/Lyndon_word)，且 $\\forall 1\\le i<m:s_i\\ge s_{i+1}$。输出 $s_1$ 到 $s_m$ 这些串长度的右端点的位置。位置编号为 $1$ 到 $n$。\n\n一个字符串 $s$ 是一个 $\\text{Lyndon Word}$，当且仅当 $s$ 是其所有后缀中最小的字符串。\n\n为了减小输出量，你只需要输出所有右端点的异或和。", "inputFormat": "一行一个长度为 $n$ 的仅包含小写英文字母的字符串 $s$。", "outputFormat": "一行一个整数，表示所有右端点的异或和。", "hint": "第一组样例的答案为 `2 4 5`。\n\n第二组样例的答案为 `1 2 4 6 9 13 18`。\n\n- 对于 $20\\%$ 的数据，保证 $1\\le n\\le 1000$；\n- 对于 $100\\%$ 的数据，保证 $1\\le n\\le 5\\times 10^6+1$。", "locale": "zh-CN"}}}
{"pid": "P6115", "type": "P", "difficulty": 7, "samples": [["5 2 1\n1 0\n998244352 0\n998244352 1\n998244352 1", "44"], ["233 2 3\n1 0\n998244352 0 0 0\n0 998244349 4 0\n0 8 998244337 8", "193416411"], ["114514 7 7\n1 9 8 2 6 4 7\n9 1 8 2 7 6 5 3\n2 8 4 6 2 9 4 5\n1 9 2 6 0 8 1 7\n1 9 1 9 8 1 0 7\n1 1 4 5 1 4 4 4\n4 4 4 4 4 4 4 4\n9 9 8 2 4 4 3 5\n1 9 8 6 0 6 0 4", "565704112"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "倍增", "O2优化", "矩阵加速", "矩阵乘法", "快速傅里叶变换 FFT", "模板题"], "title": "【模板】整式递推", "background": "话说上次菜菜的 NaCly\\_Fish 想教后辈做常系数线性齐次递推，奈何智商不够，见识短浅，被机房同学轮番吊打。\n\n之后她又听说了整式递推这种东西，便去请教中国队长 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$。然而 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 觉得这个东西太简单了，只回应了一句：“你不看候选队论文么？”\n\nNaCly\\_Fish 终于找来论文，但她完全看不懂。于是她只能找又强又热心的你来教她这个问题。", "description": "对于无限数列 $a$，已知 $\\forall n \\ge m$ 都满足\n$$\\sum_{k=0}^m a_{n-k} P_k(n) = 0$$\n其中 $P_k$ 为不超过 $d$ 次的多项式。  \n给定所有 $P_k$ 的系数，和 $\\{ a_i \\}_{i=0}^{m-1} $，求 $a_n$。\n\n由于答案可能很大，所以要对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n,m,d$。  \n第二行 $m$ 个非负整数，表示 $\\{ a_i \\}_{i=0}^{m-1} $。  \n接下来 $m+1$ 行，每行 $d+1$ 个非负整数；第 $k+3$ 行由低到高地给出 $P_k$ 的系数。 ", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n这里的递推式就是 $a_n \\equiv (n-1)(a_{n-1}+a_{n-2}) \\pmod{998244353}$，容易计算得 $a_5 \\equiv 44 \\pmod{998244353}$。\n\n【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$。  \n对于 $100\\%$ 的数据，$1\\le m,d \\le 7$，$1 \\le n \\le 6 \\times 10^8$。\n\n所有输入不超过 $6 \\times 10^8$。  \n$\\forall x \\in [m,n] \\cap \\mathbb Z \\text{ s.t. } P_0(x) \\not \\equiv 0 \\pmod{998244353}$。\n\n欢迎加入 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 粉丝群：747262201", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】整式递推", "background": "话说上次菜菜的 NaCly\\_Fish 想教后辈做常系数线性齐次递推，奈何智商不够，见识短浅，被机房同学轮番吊打。\n\n之后她又听说了整式递推这种东西，便去请教中国队长 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$。然而 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 觉得这个东西太简单了，只回应了一句：“你不看候选队论文么？”\n\nNaCly\\_Fish 终于找来论文，但她完全看不懂。于是她只能找又强又热心的你来教她这个问题。", "description": "对于无限数列 $a$，已知 $\\forall n \\ge m$ 都满足\n$$\\sum_{k=0}^m a_{n-k} P_k(n) = 0$$\n其中 $P_k$ 为不超过 $d$ 次的多项式。  \n给定所有 $P_k$ 的系数，和 $\\{ a_i \\}_{i=0}^{m-1} $，求 $a_n$。\n\n由于答案可能很大，所以要对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n,m,d$。  \n第二行 $m$ 个非负整数，表示 $\\{ a_i \\}_{i=0}^{m-1} $。  \n接下来 $m+1$ 行，每行 $d+1$ 个非负整数；第 $k+3$ 行由低到高地给出 $P_k$ 的系数。 ", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n这里的递推式就是 $a_n \\equiv (n-1)(a_{n-1}+a_{n-2}) \\pmod{998244353}$，容易计算得 $a_5 \\equiv 44 \\pmod{998244353}$。\n\n【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$。  \n对于 $100\\%$ 的数据，$1\\le m,d \\le 7$，$1 \\le n \\le 6 \\times 10^8$。\n\n所有输入不超过 $6 \\times 10^8$。  \n$\\forall x \\in [m,n] \\cap \\mathbb Z \\text{ s.t. } P_0(x) \\not \\equiv 0 \\pmod{998244353}$。\n\n欢迎加入 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 粉丝群：747262201", "locale": "zh-CN"}}}
{"pid": "P6116", "type": "P", "difficulty": 5, "samples": [["5\nRRGYY", "2"], ["6\nRRRRRG", "-1"], ["20\nYYGYYYGGGGRGYYGRGRYG", "8"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2019", "JOI（日本）"], "title": "[JOI 2019 Final] 有趣的家庭菜园 3 / Growing Vegetables is Fun 3", "background": "JOI 2019 Final T3", "description": "家庭菜园专家 JOI 先生在他的家庭菜园中种植了一种叫 Joy 草的植物。在他的菜园里，有 $N$ 个花盆自东向西摆放，第 $i$ 个编号为 $i$。每个花盆中有一株 Joy 草。\n\n春天到了，JOI 先生注意到 Joy 草如他期望地长出了各种颜色的叶子，但他也发现 Joy 草的生长速度没有他期望的那么快。他查阅了书籍，找到了草的以下特点：\n\n - Joy 草有三种品种，分别会长出红色、绿色和黄色的叶子。\n\n - 如果两株同一颜色的 Joy 草紧密相邻，它们的生长速度就会减慢。\n\n因此，JOI 先生决定重新摆放花盆，使得没有两株相邻的 Joy 草颜色相同。\n\n花盆非常沉重，因此 JOI 先生每次只能交换相邻的两个花盆。形式化的说，JOI 先生每次操作可以选择一个 $i$，然后交换花盆 $i$ 和花盆 $i+1$。\n\n请编写一个程序，计算最少的交换次数。", "inputFormat": "第一行一个整数 $N$。\n\n接下来一行一个长度为 $N$ 的字符串 ，每个字符为 `R`,`G`,`Y` 中的一个，表示 Joy 草的颜色。", "outputFormat": "输出一行一个整数，表示完成目标所需的最少操作次数。如果无解，输出 $-1$。", "hint": "### 样例解释\n\n样例解释 $1$:  \n\n一种合法的方案是：\n  \n第一步：交换第三个花盆和第四个花盆。 \n \n第二步：交换第二个花盆和第三个花盆。 \n \n可以证明，不存在次数更少的方案 \n\n样例解释 $2$：  \n\n可以证明，无论如何移动，均不可达到目标。\n\n### 子任务\n\nSubtask 1（5 分）：$N\\le 15$。\n\nSubtask 2（55 分）：$N\\le 60$。\n\nSubtask 3（15 分）：字符串仅包含 `R`,`G`。\n\nSubtask 4（25 分）：$N\\le 400$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2019 Final] 有趣的家庭菜园 3 / Growing Vegetables is Fun 3", "background": "JOI 2019 Final T3", "description": "家庭菜园专家 JOI 先生在他的家庭菜园中种植了一种叫 Joy 草的植物。在他的菜园里，有 $N$ 个花盆自东向西摆放，第 $i$ 个编号为 $i$。每个花盆中有一株 Joy 草。\n\n春天到了，JOI 先生注意到 Joy 草如他期望地长出了各种颜色的叶子，但他也发现 Joy 草的生长速度没有他期望的那么快。他查阅了书籍，找到了草的以下特点：\n\n - Joy 草有三种品种，分别会长出红色、绿色和黄色的叶子。\n\n - 如果两株同一颜色的 Joy 草紧密相邻，它们的生长速度就会减慢。\n\n因此，JOI 先生决定重新摆放花盆，使得没有两株相邻的 Joy 草颜色相同。\n\n花盆非常沉重，因此 JOI 先生每次只能交换相邻的两个花盆。形式化的说，JOI 先生每次操作可以选择一个 $i$，然后交换花盆 $i$ 和花盆 $i+1$。\n\n请编写一个程序，计算最少的交换次数。", "inputFormat": "第一行一个整数 $N$。\n\n接下来一行一个长度为 $N$ 的字符串 ，每个字符为 `R`,`G`,`Y` 中的一个，表示 Joy 草的颜色。", "outputFormat": "输出一行一个整数，表示完成目标所需的最少操作次数。如果无解，输出 $-1$。", "hint": "### 样例解释\n\n样例解释 $1$:  \n\n一种合法的方案是：\n  \n第一步：交换第三个花盆和第四个花盆。 \n \n第二步：交换第二个花盆和第三个花盆。 \n \n可以证明，不存在次数更少的方案 \n\n样例解释 $2$：  \n\n可以证明，无论如何移动，均不可达到目标。\n\n### 子任务\n\nSubtask 1（5 分）：$N\\le 15$。\n\nSubtask 2（55 分）：$N\\le 60$。\n\nSubtask 3（15 分）：字符串仅包含 `R`,`G`。\n\nSubtask 4（25 分）：$N\\le 400$。", "locale": "zh-CN"}}}
{"pid": "P6117", "type": "P", "difficulty": 5, "samples": [["3\n0 0\n0 4\n4 0\n2 1\n2 5\n-1 1", "15"], ["4\n2 1\n2 1\n2 1\n3 1\n3 1\n3 1\n3 1\n3 1", "9"], ["5\n1000000000 1000000000\n-1000000000 1000000000\n-1000000000 -1000000000\n1000000000 -1000000000\n-1 -5\n-2 2\n2 8\n4 7\n-2 5\n7 3", "8000000029"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "2019", "JOI（日本）"], "title": "[JOI 2019 Final] 硬币收藏 / Coin Collecting", "background": "JOI 2019 Final T4", "description": "JOI 先生的收藏室里有一张巨大的桌子，上面有许多稀有的硬币。为了清理桌子，他要重新摆放硬币。\n\n桌面可视为 $(2\\times 10^9+1)\\times (2\\times 10^9+1)$ 的网格。JOI 先生有 $2N$ 枚硬币。初始时，第 $i$ 枚 $(1\\le i\\le 2N)$ 硬币被放在坐标为 $(X_i,Y_i)$ 的格子里。JOI 先生的目标是在每个满足 $1\\le x \\le N,1\\le y\\le 2$ 的格子 $(x,y)$ 上恰好放一枚硬币。为了不损坏硬币，他能做的唯一一个操作是钦定一枚硬币然后将其移动到相邻的一个格子中（我们说两个格子相邻，当且仅当这两个格子有公共边）。在移动硬币的过程中，允许两个硬币处在同一个格子中。JOI 先生希望通过尽量少的操作次数完成目标。\n\n现在给出硬币的数量和初始时所在的位置，编写一个程序，计算完成 JOI 先生目标所需的最少操作次数。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $2N$ 行，第 $i$ 行为两个整数 $X_i$ 和 $Y_i$。", "outputFormat": "输出一行一个整数，表示完成目标所需的最少操作次数。", "hint": "### 样例解释\n\n样例解释 $1$:  \n\n一种合法的移动方案是：  \n\n第一枚硬币：$(0,0)\\rightarrow(1,0)\\rightarrow(1,1)\\rightarrow(1,2)$  \n\n第二枚硬币：$(0,4)\\rightarrow(1,4)\\rightarrow(1,3)\\rightarrow(2,3)\\rightarrow(3,3)\\rightarrow(3,2)$  \n\n第三枚硬币：$(4,0)\\rightarrow(4,1)\\rightarrow(3,1)$  \n\n第四枚硬币：不动  \n\n第五枚硬币：$(2,5)\\rightarrow(2,4)\\rightarrow(2,3)\\rightarrow(2,2)$ \n \n第六枚硬币：$(-1,1)\\rightarrow(0,1)\\rightarrow(1,1)$  \n\n可以证明 JOI 先生不能用少于 $15$ 次移动完成目标。\n\n### 数据范围\n\nSubtask1（8 分），$N\\le 10$。\n\nSubtask2（29 分），$N\\le 1000$。\n\nSubtask3（63 分），无其他限制。\n\n对于 $100\\%$ 的数据，$N\\le 10^5,-10^9\\le X_i,Y_i\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2019 Final] 硬币收藏 / Coin Collecting", "background": "JOI 2019 Final T4", "description": "JOI 先生的收藏室里有一张巨大的桌子，上面有许多稀有的硬币。为了清理桌子，他要重新摆放硬币。\n\n桌面可视为 $(2\\times 10^9+1)\\times (2\\times 10^9+1)$ 的网格。JOI 先生有 $2N$ 枚硬币。初始时，第 $i$ 枚 $(1\\le i\\le 2N)$ 硬币被放在坐标为 $(X_i,Y_i)$ 的格子里。JOI 先生的目标是在每个满足 $1\\le x \\le N,1\\le y\\le 2$ 的格子 $(x,y)$ 上恰好放一枚硬币。为了不损坏硬币，他能做的唯一一个操作是钦定一枚硬币然后将其移动到相邻的一个格子中（我们说两个格子相邻，当且仅当这两个格子有公共边）。在移动硬币的过程中，允许两个硬币处在同一个格子中。JOI 先生希望通过尽量少的操作次数完成目标。\n\n现在给出硬币的数量和初始时所在的位置，编写一个程序，计算完成 JOI 先生目标所需的最少操作次数。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $2N$ 行，第 $i$ 行为两个整数 $X_i$ 和 $Y_i$。", "outputFormat": "输出一行一个整数，表示完成目标所需的最少操作次数。", "hint": "### 样例解释\n\n样例解释 $1$:  \n\n一种合法的移动方案是：  \n\n第一枚硬币：$(0,0)\\rightarrow(1,0)\\rightarrow(1,1)\\rightarrow(1,2)$  \n\n第二枚硬币：$(0,4)\\rightarrow(1,4)\\rightarrow(1,3)\\rightarrow(2,3)\\rightarrow(3,3)\\rightarrow(3,2)$  \n\n第三枚硬币：$(4,0)\\rightarrow(4,1)\\rightarrow(3,1)$  \n\n第四枚硬币：不动  \n\n第五枚硬币：$(2,5)\\rightarrow(2,4)\\rightarrow(2,3)\\rightarrow(2,2)$ \n \n第六枚硬币：$(-1,1)\\rightarrow(0,1)\\rightarrow(1,1)$  \n\n可以证明 JOI 先生不能用少于 $15$ 次移动完成目标。\n\n### 数据范围\n\nSubtask1（8 分），$N\\le 10$。\n\nSubtask2（29 分），$N\\le 1000$。\n\nSubtask3（63 分），无其他限制。\n\n对于 $100\\%$ 的数据，$N\\le 10^5,-10^9\\le X_i,Y_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6118", "type": "P", "difficulty": 6, "samples": [["5 4\n1 2\n2 3\n3 4\n3 5\n1 2 1 2 4", "2\n0\n1\n1\n1"], ["7 1\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n1 1 1 1 1 1 1", "1\n1\n1\n0\n1\n1\n1"], ["10 10\n2 6\n5 8\n10 8\n1 4\n10 6\n4 5\n10 7\n6 9\n3 7\n1 2 3 4 5 6 7 8 9 10", "4\n3\n4\n2\n0\n2\n2\n0\n3\n2"], ["22 12\n9 6\n12 13\n4 20\n21 22\n3 19\n2 9\n6 18\n18 11\n18 3\n16 2\n6 4\n3 17\n16 10\n8 16\n22 1\n16 14\n15 8\n9 21\n2 12\n21 5\n12 7\n1 1 4 8 4 11 7 6 7 11 6 11 10 4 7 5 3 12 9 6 12 2", "2\n0\n1\n1\n1\n1\n1\n0\n0\n1\n2\n0\n1\n1\n2\n0\n2\n1\n2\n3\n0\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "树的直径", "栈", "JOI（日本）"], "title": "[JOI 2019 Final] 独特的城市 / Unique Cities", "background": "JOI 2019 Final T5", "description": "JOI 国有 $N$ 个城市，城市从 $1$ 到 $N$ 编号。这些城市被 $N-1$ 条双向道路连接，第 $i$ 条路连接两个城市 $A_i$ 和 $B_i$。从任何城市出发，可以到达所有城市。\n\nJOI 国有些特产，每种特产的编号都在 $1$ 到 $M$ 之间（包括 $1$ 和 $M$），但是 $1$ 到 $M$ 的某些整数可能不代表 JOI 国的特产。JOI 国的每个城市都产一种特产。$j$ 城产的特产是 $C_j$。多个城市可能产相同的特产。\n\n我们定义两个城市之间的距离为从一个城市到另一个城市需要经过的最少道路数，对于城市 $x$，我们定义城市 $y$（$y\\neq x$）是**独特的城市**当且仅当对于任何一个城市 $z$（$z\\neq x,z\\neq y$），$x$ 与 $y$ 间的距离不等于 $x$ 与 $z$ 之间的距离。\n\nJOI 国交通部部长 K 先生想知道对于城市 $j$ 的**独特的城市**一共能产多少种特产。\n\n给出 JOI 国的道路信息与每个城市产的特产，写一个程序计算对于每个城市的**独特的城市**，一共能产多少种特产。", "inputFormat": "第一行两个整数 $N,M$，意义如题目描述。\n\n接下来 $N-1$ 行，每行两个整数 $A_i,B_i$，意义如题目描述。\n\n最后一行 $N$ 个正整数，第 $i$ 个为 $C_i$，意义如题目描述。", "outputFormat": "输出 $N$ 行，第 $i$ 行表示对于城市 $i$ 的独特的城市一共能产多少种特产。", "hint": "样例解释 $1$：  \n\n对于城市 $1$，它的独特城市是城市 $2,3$，城市 $2$ 产特产 $2$，城市 $3$ 产特产 $3$，一共产两种特产，因此答案是 $2$；  \n\n对于城市 $2$，没有独特城市，因此输出 $0$；\n  \n对于城市 $3$，它的独特城市是城市 $1$，城市 $1$ 产特产 ，因此答案是 $1$；  \n\n对于城市 $4$，它的独特城市是城市 $1,3$，城市 $1,3$ 均产特产 $1$，因此答案是 $1$；  \n\n对于城市 $5$，它的独特城市是城市 $1,3$，城市 $1,3$ 均产特产 $1$，因此答案是 $1$。  \n\n注意：没有城市产特产 $3$。  \n\n对于 $4\\%$ 的数据，$N\\le 2000$。\n\n另有 $32\\%$ 的数据，$M=1$。\n\n另有 $32\\%$ 的数据，$M=N,C_j=j(1\\le j \\le N)$。\n\n对于 $100\\%$ 的数据，$1\\le N \\le 2\\times 10^5,1\\le M,A_i,B_i \\le N,A_i \\neq B_i,1\\le C_j \\le M$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2019 Final] 独特的城市 / Unique Cities", "background": "JOI 2019 Final T5", "description": "JOI 国有 $N$ 个城市，城市从 $1$ 到 $N$ 编号。这些城市被 $N-1$ 条双向道路连接，第 $i$ 条路连接两个城市 $A_i$ 和 $B_i$。从任何城市出发，可以到达所有城市。\n\nJOI 国有些特产，每种特产的编号都在 $1$ 到 $M$ 之间（包括 $1$ 和 $M$），但是 $1$ 到 $M$ 的某些整数可能不代表 JOI 国的特产。JOI 国的每个城市都产一种特产。$j$ 城产的特产是 $C_j$。多个城市可能产相同的特产。\n\n我们定义两个城市之间的距离为从一个城市到另一个城市需要经过的最少道路数，对于城市 $x$，我们定义城市 $y$（$y\\neq x$）是**独特的城市**当且仅当对于任何一个城市 $z$（$z\\neq x,z\\neq y$），$x$ 与 $y$ 间的距离不等于 $x$ 与 $z$ 之间的距离。\n\nJOI 国交通部部长 K 先生想知道对于城市 $j$ 的**独特的城市**一共能产多少种特产。\n\n给出 JOI 国的道路信息与每个城市产的特产，写一个程序计算对于每个城市的**独特的城市**，一共能产多少种特产。", "inputFormat": "第一行两个整数 $N,M$，意义如题目描述。\n\n接下来 $N-1$ 行，每行两个整数 $A_i,B_i$，意义如题目描述。\n\n最后一行 $N$ 个正整数，第 $i$ 个为 $C_i$，意义如题目描述。", "outputFormat": "输出 $N$ 行，第 $i$ 行表示对于城市 $i$ 的独特的城市一共能产多少种特产。", "hint": "样例解释 $1$：  \n\n对于城市 $1$，它的独特城市是城市 $2,3$，城市 $2$ 产特产 $2$，城市 $3$ 产特产 $3$，一共产两种特产，因此答案是 $2$；  \n\n对于城市 $2$，没有独特城市，因此输出 $0$；\n  \n对于城市 $3$，它的独特城市是城市 $1$，城市 $1$ 产特产 ，因此答案是 $1$；  \n\n对于城市 $4$，它的独特城市是城市 $1,3$，城市 $1,3$ 均产特产 $1$，因此答案是 $1$；  \n\n对于城市 $5$，它的独特城市是城市 $1,3$，城市 $1,3$ 均产特产 $1$，因此答案是 $1$。  \n\n注意：没有城市产特产 $3$。  \n\n对于 $4\\%$ 的数据，$N\\le 2000$。\n\n另有 $32\\%$ 的数据，$M=1$。\n\n另有 $32\\%$ 的数据，$M=N,C_j=j(1\\le j \\le N)$。\n\n对于 $100\\%$ 的数据，$1\\le N \\le 2\\times 10^5,1\\le M,A_i,B_i \\le N,A_i \\neq B_i,1\\le C_j \\le M$。", "locale": "zh-CN"}}}
{"pid": "P6119", "type": "P", "difficulty": 4, "samples": [["6\n1\n2\n3\n4\n5\n6\n6\n5\n4\n3\n2\n1", "5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2017", "USACO"], "title": "[USACO17FEB] Why Did the Cow Cross the Road II G", "background": "*本题与 [白金组同名题目](/problem/P3657) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 饲养了 $N$ 种奶牛，编号从 $1$ 到 $N$。一些品种的奶牛和其他奶牛间相处良好，事实证明，如果两个品种的奶牛编号分别为 $a,b$，当 $|a-b| \\leq 4$ 时，这两个品种的奶牛能友好相处，否则不能友好相处。\n\n一条长长的道路贯穿整个农场，道路的左侧有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场），道路的右侧也有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场）。为了让奶牛们安全穿过马路，Farmer John 希望能在马路上画出一些人行道（牛行道？），要求这些人行道满足如下条件：\n\n1. 人行道从左侧的某个牧场出发，连接到右侧的某个牧场；\n2. 人行道连接的两个牧场的奶牛要能友好相处；\n3. 人行道不能在道路中间相交；\n4. 每个牧场只能与一条人行道相连。\n\n你需要帮 FJ 求出最多能有多少条人行道。", "inputFormat": "输入第一行一个整数 $N$（$1 \\leq N \\leq 1000$）。\n\n接下来 $N$ 行，每行一个整数 $a_i$，代表道路左侧第 $i$ 个牧场的奶牛品种编号。\n\n接下来 $N$ 行，每行一个整数 $b_i$，代表道路右侧第 $i$ 个牧场的奶牛品种编号。", "outputFormat": "输出最多能画多少条人行道。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO17FEB] Why Did the Cow Cross the Road II G", "background": "*本题与 [白金组同名题目](/problem/P3657) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 饲养了 $N$ 种奶牛，编号从 $1$ 到 $N$。一些品种的奶牛和其他奶牛间相处良好，事实证明，如果两个品种的奶牛编号分别为 $a,b$，当 $|a-b| \\leq 4$ 时，这两个品种的奶牛能友好相处，否则不能友好相处。\n\n一条长长的道路贯穿整个农场，道路的左侧有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场），道路的右侧也有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场）。为了让奶牛们安全穿过马路，Farmer John 希望能在马路上画出一些人行道（牛行道？），要求这些人行道满足如下条件：\n\n1. 人行道从左侧的某个牧场出发，连接到右侧的某个牧场；\n2. 人行道连接的两个牧场的奶牛要能友好相处；\n3. 人行道不能在道路中间相交；\n4. 每个牧场只能与一条人行道相连。\n\n你需要帮 FJ 求出最多能有多少条人行道。", "inputFormat": "输入第一行一个整数 $N$（$1 \\leq N \\leq 1000$）。\n\n接下来 $N$ 行，每行一个整数 $a_i$，代表道路左侧第 $i$ 个牧场的奶牛品种编号。\n\n接下来 $N$ 行，每行一个整数 $b_i$，代表道路右侧第 $i$ 个牧场的奶牛品种编号。", "outputFormat": "输出最多能画多少条人行道。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6120", "type": "P", "difficulty": 3, "samples": [["5\nP\nP\nH\nP\nS", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2017", "USACO"], "title": "[USACO17JAN] Hoof, Paper, Scissor S", "background": "*本题与 [金组同名题目](/problem/P3609) 在题意上一致，唯一的差别在于对变手势次数的限制。*", "description": "你可能玩过“石头，剪刀，布”，这个游戏在奶牛中同样流行，不过它的名字变成了“蹄子，剪刀，布”。\n\n“蹄子，剪刀，布”和“石头，剪刀，布”的规则十分类似，两只奶牛数到三，然后出一个代表蹄子，剪刀或布的手势。蹄子胜过剪刀，剪刀胜过布，布胜过蹄子。特别地，如果两只奶牛的手势相同，则视为平局。\n\n现在 FJ 和 Bessie 要进行 $N$ 轮对抗。Bessie 已经预测了 FJ 每一轮要出的手势。然而 Bessie 很懒，她最多只想变换一次手势。\n\n现在请你帮 Bessie 求出她最多能赢多少轮。", "inputFormat": "第一行输入一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行一个字母，代表 FJ 这一轮出的手势。`H` 代表蹄子（Hoof），`S` 代表剪刀（Scissors），`P` 代表布（Paper）。", "outputFormat": "输出一个整数，代表 Bessie 在最多变换一次手势的前提下最多赢多少轮。", "hint": null, "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO17JAN] Hoof, Paper, Scissor S", "background": "*本题与 [金组同名题目](/problem/P3609) 在题意上一致，唯一的差别在于对变手势次数的限制。*", "description": "你可能玩过“石头，剪刀，布”，这个游戏在奶牛中同样流行，不过它的名字变成了“蹄子，剪刀，布”。\n\n“蹄子，剪刀，布”和“石头，剪刀，布”的规则十分类似，两只奶牛数到三，然后出一个代表蹄子，剪刀或布的手势。蹄子胜过剪刀，剪刀胜过布，布胜过蹄子。特别地，如果两只奶牛的手势相同，则视为平局。\n\n现在 FJ 和 Bessie 要进行 $N$ 轮对抗。Bessie 已经预测了 FJ 每一轮要出的手势。然而 Bessie 很懒，她最多只想变换一次手势。\n\n现在请你帮 Bessie 求出她最多能赢多少轮。", "inputFormat": "第一行输入一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行一个字母，代表 FJ 这一轮出的手势。`H` 代表蹄子（Hoof），`S` 代表剪刀（Scissors），`P` 代表布（Paper）。", "outputFormat": "输出一个整数，代表 Bessie 在最多变换一次手势的前提下最多赢多少轮。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P6121", "type": "P", "difficulty": 4, "samples": [["4 3\n1 2\n2 3\n3 4\n3\n4\n1\n2", "YES\nNO\nYES\nYES"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "2016", "USACO", "并查集", "链表"], "title": "[USACO16OPEN] Closing the Farm G", "background": "*本题和 [银组同名题目](/problem/P3144) 在题意上一致，唯一的不同是数据范围。*", "description": "FJ 和他的奶牛们正在计划离开小镇做一次长的旅行，同时 FJ 想临时地关掉他的农场以节省一些金钱。\n\n这个农场一共有被用 $M$ 条双向道路连接的 $N$ 个谷仓（$1 \\leq N,M \\leq 2 \\times 10^5$）。为了关闭整个农场，FJ 计划每一次关闭掉一个谷仓。当一个谷仓被关闭了，所有的连接到这个谷仓的道路都会被关闭，而且再也不能够被使用。\n\nFJ 现在正感兴趣于知道在每一个时间（这里的“时间”指在每一次关闭谷仓之前的时间）时他的农场是否是“全连通的”——也就是说从任意的一个开着的谷仓开始，能够到达另外的一个谷仓。注意自从某一个时间之后，可能整个农场都开始不会是“全连通的”。", "inputFormat": "输入第一行两个整数 $N,M$。\n\n接下来 $M$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 两个农场的路。\n\n最后 $N$ 行每行一个整数，表示第 $i$ 个被关闭的农场编号。", "outputFormat": "输出 $N$ 行，每行包含 `YES` 或 `NO`，表示某个时刻农场是否是全连通的。\n\n第一行输出最初的状态，第 $i$ 行（$2 \\leq i \\leq N$）输出第 $i-1$ 个农场被关闭后的状态。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO16OPEN] Closing the Farm G", "background": "*本题和 [银组同名题目](/problem/P3144) 在题意上一致，唯一的不同是数据范围。*", "description": "FJ 和他的奶牛们正在计划离开小镇做一次长的旅行，同时 FJ 想临时地关掉他的农场以节省一些金钱。\n\n这个农场一共有被用 $M$ 条双向道路连接的 $N$ 个谷仓（$1 \\leq N,M \\leq 2 \\times 10^5$）。为了关闭整个农场，FJ 计划每一次关闭掉一个谷仓。当一个谷仓被关闭了，所有的连接到这个谷仓的道路都会被关闭，而且再也不能够被使用。\n\nFJ 现在正感兴趣于知道在每一个时间（这里的“时间”指在每一次关闭谷仓之前的时间）时他的农场是否是“全连通的”——也就是说从任意的一个开着的谷仓开始，能够到达另外的一个谷仓。注意自从某一个时间之后，可能整个农场都开始不会是“全连通的”。", "inputFormat": "输入第一行两个整数 $N,M$。\n\n接下来 $M$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 两个农场的路。\n\n最后 $N$ 行每行一个整数，表示第 $i$ 个被关闭的农场编号。", "outputFormat": "输出 $N$ 行，每行包含 `YES` 或 `NO`，表示某个时刻农场是否是全连通的。\n\n第一行输出最初的状态，第 $i$ 行（$2 \\leq i \\leq N$）输出第 $i-1$ 个农场被关闭后的状态。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6122", "type": "P", "difficulty": 6, "samples": [["5 4\n0 0 4 1 1\n2 4 5 2", "1 1 2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "ICPC", "模拟费用流", "NERC/NEERC"], "title": "[NEERC 2016] Mole Tunnels", "background": null, "description": "鼹鼠们在底下开凿了 $n$ 个洞，由 $n-1$ 条隧道连接，对于任意的 $i>1$，第 $i$ 个洞都会和第 $\\lfloor \\frac{i}{2}\\rfloor$ 个洞间有一条隧道，第 $i$ 个洞内还有 $c_i$ 个食物能供最多 $c_i$ 只鼹鼠吃。一共有 $m$ 只鼹鼠，第 $i$ 只鼹鼠住在第 $p_i$ 个洞内。\n\n一天早晨，前 $k$ 只鼹鼠醒来了，而后 $m-k$ 只鼹鼠均在睡觉，前 $k$ 只鼹鼠就开始觅食，最终他们都会到达某一个洞，使得所有洞的 $c_i$ 均大于等于该洞内醒着的鼹鼠个数，而且要求鼹鼠行动路径总长度最小。现对于所有的 $1 \\le k \\le m$，输出最小的鼹鼠行动路径的总长度，保证一定存在某种合法方案。", "inputFormat": "第一行两个数 $n,m$，表示有 $n$ 个洞，$m$ 只鼹鼠。\n\n第二行 $n$ 个整数 $c_i$ 表示第 $i$ 个洞的食物数。\n\n第三行 $m$ 个整数 $p_i$ 表示第 $i$ 只鼹鼠所在洞 $p_i$。", "outputFormat": "输出一行 $m$ 个整数，第 $i$ 个整数表示当 $k=i$ 时最小的鼹鼠行动路径总长度。", "hint": "对于全部的数据满足：$1 \\le n,m \\le 10^5$，$0 \\le c_i \\le m$，$1 \\le p_i \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NEERC 2016] Mole Tunnels", "background": null, "description": "鼹鼠们在底下开凿了 $n$ 个洞，由 $n-1$ 条隧道连接，对于任意的 $i>1$，第 $i$ 个洞都会和第 $\\lfloor \\frac{i}{2}\\rfloor$ 个洞间有一条隧道，第 $i$ 个洞内还有 $c_i$ 个食物能供最多 $c_i$ 只鼹鼠吃。一共有 $m$ 只鼹鼠，第 $i$ 只鼹鼠住在第 $p_i$ 个洞内。\n\n一天早晨，前 $k$ 只鼹鼠醒来了，而后 $m-k$ 只鼹鼠均在睡觉，前 $k$ 只鼹鼠就开始觅食，最终他们都会到达某一个洞，使得所有洞的 $c_i$ 均大于等于该洞内醒着的鼹鼠个数，而且要求鼹鼠行动路径总长度最小。现对于所有的 $1 \\le k \\le m$，输出最小的鼹鼠行动路径的总长度，保证一定存在某种合法方案。", "inputFormat": "第一行两个数 $n,m$，表示有 $n$ 个洞，$m$ 只鼹鼠。\n\n第二行 $n$ 个整数 $c_i$ 表示第 $i$ 个洞的食物数。\n\n第三行 $m$ 个整数 $p_i$ 表示第 $i$ 只鼹鼠所在洞 $p_i$。", "outputFormat": "输出一行 $m$ 个整数，第 $i$ 个整数表示当 $k=i$ 时最小的鼹鼠行动路径总长度。", "hint": "对于全部的数据满足：$1 \\le n,m \\le 10^5$，$0 \\le c_i \\le m$，$1 \\le p_i \\le n$。", "locale": "zh-CN"}}}
{"pid": "P6123", "type": "P", "difficulty": 3, "samples": [["x >= 5 && x <= 10 ||\nx >= 7 && x <= 20 ||\nx <= 2 ||\nx >= 21 && x <= 25 ||\nx >= 8 && x <= 10 ||\nx >= 100", "x <= 2 ||\nx >= 5 && x <= 25 ||\nx >= 100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2016", "ICPC", "NERC/NEERC"], "title": "[NEERC 2016] Hard Refactoring", "background": "", "description": "对于一个变量 $x$，给出一些约束条件，形如 $x \\geq a$，$x \\le a$ \n这些约束条件之间用```||```连接，然后你需要将这些约束条件简化，最后输出简化后的约束条件。", "inputFormat": "输入不超过 $10^3$ 行，每行要么是两个用 ```&&``` 连接的约束条件，要么就是单个的约束条件。\n\n如果一行有两个约束条件，第一个约束条件总是 $x \\geq a$ 的形式，第二个约束总是 $x \\leq a$ 的形式。\n\n除了输入的最后一行，每一行末尾都有一个 ```||```。\n\n并且所有的字符（除了`>=`，`<=`，`&&`，`||`）之间均由空格隔开，且没有多余的前置、后置空格。", "outputFormat": "输出若干行，表示最简的约束条件的形式（也就是使输出的行数尽量少），其余格式与输入格式保持一致。\n\n输出的若干行可以不按照特定的顺序输出。\n\n特别地，如果对于任意的 $x∈[-32768,32767]$，$x$均能满足约束条件，仅输出一行```true```，反之，若对于任意的 $x∈[-32768,32767]$，$x$均不能满足约束条件，仅输出一行```false```。", "hint": "对于所有在这一题中出现的数字（包括 $x$），都$\\ge -32768$（$-2^{15}$） 且 $\\le 32767 $（$2^{15}-1$）。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NEERC 2016] Hard Refactoring", "background": "", "description": "对于一个变量 $x$，给出一些约束条件，形如 $x \\geq a$，$x \\le a$ \n这些约束条件之间用```||```连接，然后你需要将这些约束条件简化，最后输出简化后的约束条件。", "inputFormat": "输入不超过 $10^3$ 行，每行要么是两个用 ```&&``` 连接的约束条件，要么就是单个的约束条件。\n\n如果一行有两个约束条件，第一个约束条件总是 $x \\geq a$ 的形式，第二个约束总是 $x \\leq a$ 的形式。\n\n除了输入的最后一行，每一行末尾都有一个 ```||```。\n\n并且所有的字符（除了`>=`，`<=`，`&&`，`||`）之间均由空格隔开，且没有多余的前置、后置空格。", "outputFormat": "输出若干行，表示最简的约束条件的形式（也就是使输出的行数尽量少），其余格式与输入格式保持一致。\n\n输出的若干行可以不按照特定的顺序输出。\n\n特别地，如果对于任意的 $x∈[-32768,32767]$，$x$均能满足约束条件，仅输出一行```true```，反之，若对于任意的 $x∈[-32768,32767]$，$x$均不能满足约束条件，仅输出一行```false```。", "hint": "对于所有在这一题中出现的数字（包括 $x$），都$\\ge -32768$（$-2^{15}$） 且 $\\le 32767 $（$2^{15}-1$）。", "locale": "zh-CN"}}}
{"pid": "P6124", "type": "P", "difficulty": 6, "samples": [["2", "10"], ["10", "1100"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["高精度", "2015", "广度优先搜索 BFS", "ICPC", "NERC/NEERC"], "title": "[NEERC 2015] Binary vs Decimal", "background": "", "description": "一个正数 $A$，如果它只包含 `0` 或 `1`，且它转成二进制后的 $B$，$A$ 是 $B$ 的后缀，这个数就是我们所要的。\n\n现在给出数字 $N$，求第 $N$ 个这样的数。", "inputFormat": "一行一个数 $N$。", "outputFormat": "一行一个数，第 $N$ 个数。", "hint": "$1 \\le N \\le 10^4$。\n\n|原数|二进制|评论|\n| :-----------: | :-----------: | :-----------: |\n|$1$|$1$|√|\n|$10$|$1010$|√|\n|$11$|$1011$|√|\n|$100$|$1100100$|√|\n|$101$|$1100101$|√|\n|$110$|$1101110$|√|\n|$111$|$1101111$|√|\n|$1000$|$1111101000$|√|\n|$1001$|$1111101001$|√|\n|$1010$|$1111110010$|×|\n|$1011$|$1111110011$|×|\n|$1100$|$10001001100$|√| ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NEERC 2015] Binary vs Decimal", "background": "", "description": "一个正数 $A$，如果它只包含 `0` 或 `1`，且它转成二进制后的 $B$，$A$ 是 $B$ 的后缀，这个数就是我们所要的。\n\n现在给出数字 $N$，求第 $N$ 个这样的数。", "inputFormat": "一行一个数 $N$。", "outputFormat": "一行一个数，第 $N$ 个数。", "hint": "$1 \\le N \\le 10^4$。\n\n|原数|二进制|评论|\n| :-----------: | :-----------: | :-----------: |\n|$1$|$1$|√|\n|$10$|$1010$|√|\n|$11$|$1011$|√|\n|$100$|$1100100$|√|\n|$101$|$1100101$|√|\n|$110$|$1101110$|√|\n|$111$|$1101111$|√|\n|$1000$|$1111101000$|√|\n|$1001$|$1111101001$|√|\n|$1010$|$1111110010$|×|\n|$1011$|$1111110011$|×|\n|$1100$|$10001001100$|√| ", "locale": "zh-CN"}}}
{"pid": "P6125", "type": "P", "difficulty": 6, "samples": [["3 2 2\n1 2\n1 2\nAB\nBA\nAA", "0.25\n0.50\n0.25"], ["3 4 2\n1 2\n1 2\nAABA\nABAA\nBAAA", "0.31\n0.33\n0.37"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "动态规划 DP", "2009", "各省省选", "江苏", "高斯消元", "AC 自动机"], "title": "[JSOI2009] 有趣的游戏", "background": "", "description": "小阳阳发明了一个有趣的游戏：有 $n$ 个玩家，每个玩家都有一个长度为 $l$ 的字母序列，任何两个玩家的字母序列不同。共有 $m$ 种不同的字母，所有的字母序列都由这 $m$ 种字母构成。为了方便，我们取大写字母的前 $m$ 个字母。   \n例如 $m=3,l=4,\\texttt{ABAA}$ 和 $\\texttt{CBCA}$ 是两个合法的字母序列。       \n现在由小阳阳来操控一台神奇的机器，每个时刻机器会随机产生一个字母，其中第 $i$ 种字母随机出来的概率为 $\\dfrac{p_i}{q_i}$ ，显然 $\\sum \\limits_{k=1}^m \\dfrac{p_i}{q_i}=1$。  \n这样 $T$ 个时刻后机器会产生一个长度为 $T$ 的字母序列。  \n如果某个时刻某个玩家发现自己的字母序列在机器产生的字母序列中出现了，“出现”的定义是玩家的字母序列是机器产生的字母序列中连续的一段，那么我们称这个玩家获胜，游戏结束。       \n现在小阳阳感兴趣的一个问题是，每个玩家分别有多大的概率能获得这场游戏的胜利呢？  ", "inputFormat": "第一行有三个正整数 $n,l,m$ 表示有 $n$ 个人，每个字母的序列长度均为 $l$，共有 $m$ 个字母。   \n接下来 $m$ 行，每行有两个非负整数 $p, q$，表示随机到第 $i$ 个字母的概率为 $\\frac{p}{q}$。   \n接下来 $n$ 行，每行有一个长度为 $l$ 的字母序列，表示第 $i$ 个人的字母序列。", "outputFormat": "包含 $n$ 行，每行一个实数，表示第 $i$ 个人获胜的概率，输出结果四舍五入到两位小数。 ", "hint": "$1 \\leq n,l,m \\leq 10$，$0 \\leq p_i \\leq q_i \\leq 10$ 且 $\\gcd(p,q) = 1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2009] 有趣的游戏", "background": "", "description": "小阳阳发明了一个有趣的游戏：有 $n$ 个玩家，每个玩家都有一个长度为 $l$ 的字母序列，任何两个玩家的字母序列不同。共有 $m$ 种不同的字母，所有的字母序列都由这 $m$ 种字母构成。为了方便，我们取大写字母的前 $m$ 个字母。   \n例如 $m=3,l=4,\\texttt{ABAA}$ 和 $\\texttt{CBCA}$ 是两个合法的字母序列。       \n现在由小阳阳来操控一台神奇的机器，每个时刻机器会随机产生一个字母，其中第 $i$ 种字母随机出来的概率为 $\\dfrac{p_i}{q_i}$ ，显然 $\\sum \\limits_{k=1}^m \\dfrac{p_i}{q_i}=1$。  \n这样 $T$ 个时刻后机器会产生一个长度为 $T$ 的字母序列。  \n如果某个时刻某个玩家发现自己的字母序列在机器产生的字母序列中出现了，“出现”的定义是玩家的字母序列是机器产生的字母序列中连续的一段，那么我们称这个玩家获胜，游戏结束。       \n现在小阳阳感兴趣的一个问题是，每个玩家分别有多大的概率能获得这场游戏的胜利呢？  ", "inputFormat": "第一行有三个正整数 $n,l,m$ 表示有 $n$ 个人，每个字母的序列长度均为 $l$，共有 $m$ 个字母。   \n接下来 $m$ 行，每行有两个非负整数 $p, q$，表示随机到第 $i$ 个字母的概率为 $\\frac{p}{q}$。   \n接下来 $n$ 行，每行有一个长度为 $l$ 的字母序列，表示第 $i$ 个人的字母序列。", "outputFormat": "包含 $n$ 行，每行一个实数，表示第 $i$ 个人获胜的概率，输出结果四舍五入到两位小数。 ", "hint": "$1 \\leq n,l,m \\leq 10$，$0 \\leq p_i \\leq q_i \\leq 10$ 且 $\\gcd(p,q) = 1$。", "locale": "zh-CN"}}}
{"pid": "P6126", "type": "P", "difficulty": 6, "samples": [["5\n3 2 3 4\n2 1 3\n4 2 1 4 5\n2 1 3\n1 3", "3\n1 2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "各省省选", "江苏", "Special Judge", "高斯消元"], "title": "[JSOI2012] 始祖鸟", "background": null, "description": "最近，进香河地带出现了一家“始祖鸟专卖店”，然而这并不只是一时的心血来潮。         \n                         \n早在远古时期，进香河地带就以其秀美的环境和适宜的温度吸引了成群的始祖鸟。始祖鸟是一种团结的鸟类，它们总是通过各种方式来增强种群内部的交流，聚会则是其中之一。因为聚会不但可以增强朋友之间的友谊，而且可以认识新的朋友。        \n                             \n现在有 $N$ 只始祖鸟，我们从 $1$ 开始编号。对于第 $i$ 只始祖鸟，有 $M_i$ 个认识的朋友，它们的编号分别是 $F_{i,1},F_{i,2},\\dots,F_{i,M_i}$。朋友的认识关系是单向的，也就是说如果第 $s$ 只始祖鸟认识第 $t$ 只始祖鸟，那么第 $t$ 只始祖鸟不一定认识第 $s$ 只始祖鸟。        \n   \n聚会的地点分为两处，一处在上游，一处在下游。对于每一处聚会场所，都必须满足对于在这个聚会场所中的始祖鸟，有恰好有偶数个自己认识的朋友与之在同一个聚会场所中。当然，每一只始祖鸟都必须在两处聚会场所之一。         \n       \n现在需要你给出一种安排方式。你只需要给出在上游的始祖鸟编号，如果有多组解，请输出任何一组解。", "inputFormat": "输入数据包含 $N+1$ 行，第一行是数字 $N$，代表始祖鸟的个数。       \n接下来 $N$ 行，第 $i+1$ 行的第一个数字是 $M_i$，表示第 $i$ 只鸟的朋友个数。之后有 $M_i$ 个数字依次为 $F_{i,1},F_{i,2},\\dots,F_{i,M_i}$ 表示第 $i$ 只始祖鸟朋友的标号。", "outputFormat": "输出数据包含 $2$ 行，第一行有一个非负整数 $k$，表示在上游参加聚会的始祖鸟个数。第二行有 $k$ 个正整数，表示在这个 $k$ 只始祖鸟的编号，你可以以任意顺序输出这些编号。如果无法满足要求，只输出一行 `Impossible`。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，$1 \\le N \\le 2000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2012] 始祖鸟", "background": null, "description": "最近，进香河地带出现了一家“始祖鸟专卖店”，然而这并不只是一时的心血来潮。         \n                         \n早在远古时期，进香河地带就以其秀美的环境和适宜的温度吸引了成群的始祖鸟。始祖鸟是一种团结的鸟类，它们总是通过各种方式来增强种群内部的交流，聚会则是其中之一。因为聚会不但可以增强朋友之间的友谊，而且可以认识新的朋友。        \n                             \n现在有 $N$ 只始祖鸟，我们从 $1$ 开始编号。对于第 $i$ 只始祖鸟，有 $M_i$ 个认识的朋友，它们的编号分别是 $F_{i,1},F_{i,2},\\dots,F_{i,M_i}$。朋友的认识关系是单向的，也就是说如果第 $s$ 只始祖鸟认识第 $t$ 只始祖鸟，那么第 $t$ 只始祖鸟不一定认识第 $s$ 只始祖鸟。        \n   \n聚会的地点分为两处，一处在上游，一处在下游。对于每一处聚会场所，都必须满足对于在这个聚会场所中的始祖鸟，有恰好有偶数个自己认识的朋友与之在同一个聚会场所中。当然，每一只始祖鸟都必须在两处聚会场所之一。         \n       \n现在需要你给出一种安排方式。你只需要给出在上游的始祖鸟编号，如果有多组解，请输出任何一组解。", "inputFormat": "输入数据包含 $N+1$ 行，第一行是数字 $N$，代表始祖鸟的个数。       \n接下来 $N$ 行，第 $i+1$ 行的第一个数字是 $M_i$，表示第 $i$ 只鸟的朋友个数。之后有 $M_i$ 个数字依次为 $F_{i,1},F_{i,2},\\dots,F_{i,M_i}$ 表示第 $i$ 只始祖鸟朋友的标号。", "outputFormat": "输出数据包含 $2$ 行，第一行有一个非负整数 $k$，表示在上游参加聚会的始祖鸟个数。第二行有 $k$ 个正整数，表示在这个 $k$ 只始祖鸟的编号，你可以以任意顺序输出这些编号。如果无法满足要求，只输出一行 `Impossible`。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，$1 \\le N \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P6127", "type": "P", "difficulty": 7, "samples": [["3\nTTTT\nTTFT\nTFTT\nTFFF\nFTTT\nFTFF\nFFTF\nFFFF\n", "a&b|(a|b&c)"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "贪心", "2000", "Special Judge", "CTSC/CTS"], "title": "[CTSC2000] 逻辑范式", "background": "", "description": "逻辑学是对命题以及命题真假性进行研究的一门科学。命题一般用一个小写字母表示，任何命题的值非真即假。我们用 `T` 表示命题的值为真，用 `F` 表示命题的值为假。\n\n命题间的运算符称为命题操作联结词，简称联结词。逻辑系统中最基本的三个联结词是非、且和或，为了简便，我们用 $!$ 表示联结词非，用 $\\&$ 表示联结词且，用 $|$ 表示联结词或。\n\n联结词非是一个一元联结词，对于任意命题 $p$ ，$!p$ 的真值总是和 $p$ 相反。\n\n联结词且又称合取，是一个二元联结词，对于任意命题 $p$ 和 $q$ ，当且仅当 $p$ 和 $q$ 同为真时， $p\\&q$ 为真，否则 $p\\&q$ 为假。\n\n联结词或又称析取，是一个二元联结词，对于任意命题 $p$ 和 $q$ ，当且仅当 $p$ 和 $q$ 同为假时， $p|q$ 为假，否则 $p|q$ 为真。\n\n下面给出三个基本命题运算联结词的真值表：\n\n| 命题 $p$ | 命题 $q$ | $!p$ | $p\\&q$ | $p\\|q$   |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| T | T | F | T | T |\n| T | F | F | F | T | \n| F | T | T | F | T |\n| F | T | T | F | T |\n| F | F | T | F | F | \n\n\n逻辑表达式是由命题、联结词和括号组成的。它的定义如下：\n\n`<表达式>      ::=<合取式> or <析取式> or <否定式> or (<表达式>) or <元素>`\n\n`<合取式>      ::=<表达式>&<表达式>`\n\n`<析取式>      ::=<表达式>|<表达式>`\n\n`<否定式>      ::=!<表达式>`\n\n`<元素>      ::=<命题>`\n\n注：其中 <命题> 是 $a$ 到 $z$ 的小写字母，`::=` 表示定义为， `or` 表示或。\n\n对表达式的求值过程是根据表达式中各命题的值和真值表进行命题运算操作的过程。运算优先级为 $()$ 、 $!$ 、 $\\&$ 和 $|$ 。$\\&$ 和 $|$ 的优先级相同。相同优先级从左到右运算。\n\n与或非逻辑范式（这里简称为范式）是一种逻辑表达式，它能够符合特定的真值表。例如一般逻辑里定义的蕴涵运算 $\\rightarrow$ 的真值表为：\n\n| 命题 $p$ | 命题 $q$ | $p \\rightarrow q$ |\n| :----------: | :----------: | :----------: |\n| T | T | T |\n| T | F | F |\n| F | T | T |\n| F | F | T |\n\n\n我们可以用表达式 $!p|q$ 来表示这个蕴涵运算。表达式  $!p|q$ 的真值表为：\n\n| 命题 $p$ | 命题 $q$ | $!p\\|q$ |\n| :----------: | :----------: | :----------: |\n| T | T | T |\n| T | F | F |\n| F | T | T |\n| F | F | T |\n\n这样，我们就说 $p \\to q$ 的范式为 $!p|q$ 。\n\n完备定理告诉我们，对于任意一个 $n$ 元逻辑运算函数 $A$ ，已知 $A$ 的真值表，总可以求出 $A$ 的范式。范式只含命题、三个基本联结词和括号。例如，下面是一个三元运算 $A(p,q,r)$ 的真值表：\n\n| 命题 $p$ | 命题 $q$ | 命题 $r$ | $A(p,q,r)$ |\n| :----------: | :----------: | :----------: | :----------: |\n| T | T | T | T |\n| T | T | F | T |\n| T | F | T | T |\n| T | F | F | F |\n| F | T | T | T |\n| F | T | F | F |\n| F | F | T | F |\n| F | F | F | F |\n\n也就是说，在命题 $p,q,r$ 有两个或两个以上为真时， $A$ 为真；反之 $A$ 为假。\n\n当然，范式并不是唯一的。假设存在一种 $A$ 的范式为 $(p\\&q\\&r)|(!p\\&q\\&r)|(p\\&!q\\&r)|(p\\&q\\&!r)$ ， 表达式 $(p\\&q)|(q\\&r)|(p\\&r)$ 也是 $A$ 的范式，并且它的长度比前式更短。\n\n我们的要求是：给定 $n$ 元函数 $A$ 的真值表，求 $A$ 的范式，并要求范式尽可能短。", "inputFormat": "输入文件第一行为 $n$（$n \\leq 6$），表示 $A$ 是 $n$ 元函数。随后有 $2^n$ 行，每行为一个长度为 $n+1$ 的字符串。字符串仅包含字符 `T` 和 `F` 。前 $n$ 个依次表示第 $n$ 个命题的值，最后一个表示当 $n$ 个命题按此取值时 $A$ 的值。", "outputFormat": "输出文件包含一行，为你给出的范式。命题依次用小写字母 $a, b, c, d, \\ldots $表示。", "hint": "**评分标准**：\n\n- 如果你给定的范式错误或者在规定时间内没有出解，该测试点得 $0$ 分。\n- 如果你给定的范式长度小于等于标准答案的长度，该测试点得满分。\n- 如果你给定的范式长度大于等于标准答案长度的两倍，该测试点得 $0$ 分。\n- 如果你给定的范式长度大于标准答案的长度，小于标准答案长度的两倍，该测试点得分计算公式为： \n\n$$\nScore=FullScore \\times \\frac{2L_{std}-L}{L_{std}}\n$$\n\n其中 $FullScore$ 为该测试点满分， $L_{std}$ 为标准答案长度， $L$ 为你的答案长度。\n\n**感谢 [tiger2005](https://www.luogu.com.cn/user/60864) 提供 SPJ ！**\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CTSC2000] 逻辑范式", "background": "", "description": "逻辑学是对命题以及命题真假性进行研究的一门科学。命题一般用一个小写字母表示，任何命题的值非真即假。我们用 `T` 表示命题的值为真，用 `F` 表示命题的值为假。\n\n命题间的运算符称为命题操作联结词，简称联结词。逻辑系统中最基本的三个联结词是非、且和或，为了简便，我们用 $!$ 表示联结词非，用 $\\&$ 表示联结词且，用 $|$ 表示联结词或。\n\n联结词非是一个一元联结词，对于任意命题 $p$ ，$!p$ 的真值总是和 $p$ 相反。\n\n联结词且又称合取，是一个二元联结词，对于任意命题 $p$ 和 $q$ ，当且仅当 $p$ 和 $q$ 同为真时， $p\\&q$ 为真，否则 $p\\&q$ 为假。\n\n联结词或又称析取，是一个二元联结词，对于任意命题 $p$ 和 $q$ ，当且仅当 $p$ 和 $q$ 同为假时， $p|q$ 为假，否则 $p|q$ 为真。\n\n下面给出三个基本命题运算联结词的真值表：\n\n| 命题 $p$ | 命题 $q$ | $!p$ | $p\\&q$ | $p\\|q$   |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| T | T | F | T | T |\n| T | F | F | F | T | \n| F | T | T | F | T |\n| F | T | T | F | T |\n| F | F | T | F | F | \n\n\n逻辑表达式是由命题、联结词和括号组成的。它的定义如下：\n\n`<表达式>      ::=<合取式> or <析取式> or <否定式> or (<表达式>) or <元素>`\n\n`<合取式>      ::=<表达式>&<表达式>`\n\n`<析取式>      ::=<表达式>|<表达式>`\n\n`<否定式>      ::=!<表达式>`\n\n`<元素>      ::=<命题>`\n\n注：其中 <命题> 是 $a$ 到 $z$ 的小写字母，`::=` 表示定义为， `or` 表示或。\n\n对表达式的求值过程是根据表达式中各命题的值和真值表进行命题运算操作的过程。运算优先级为 $()$ 、 $!$ 、 $\\&$ 和 $|$ 。$\\&$ 和 $|$ 的优先级相同。相同优先级从左到右运算。\n\n与或非逻辑范式（这里简称为范式）是一种逻辑表达式，它能够符合特定的真值表。例如一般逻辑里定义的蕴涵运算 $\\rightarrow$ 的真值表为：\n\n| 命题 $p$ | 命题 $q$ | $p \\rightarrow q$ |\n| :----------: | :----------: | :----------: |\n| T | T | T |\n| T | F | F |\n| F | T | T |\n| F | F | T |\n\n\n我们可以用表达式 $!p|q$ 来表示这个蕴涵运算。表达式  $!p|q$ 的真值表为：\n\n| 命题 $p$ | 命题 $q$ | $!p\\|q$ |\n| :----------: | :----------: | :----------: |\n| T | T | T |\n| T | F | F |\n| F | T | T |\n| F | F | T |\n\n这样，我们就说 $p \\to q$ 的范式为 $!p|q$ 。\n\n完备定理告诉我们，对于任意一个 $n$ 元逻辑运算函数 $A$ ，已知 $A$ 的真值表，总可以求出 $A$ 的范式。范式只含命题、三个基本联结词和括号。例如，下面是一个三元运算 $A(p,q,r)$ 的真值表：\n\n| 命题 $p$ | 命题 $q$ | 命题 $r$ | $A(p,q,r)$ |\n| :----------: | :----------: | :----------: | :----------: |\n| T | T | T | T |\n| T | T | F | T |\n| T | F | T | T |\n| T | F | F | F |\n| F | T | T | T |\n| F | T | F | F |\n| F | F | T | F |\n| F | F | F | F |\n\n也就是说，在命题 $p,q,r$ 有两个或两个以上为真时， $A$ 为真；反之 $A$ 为假。\n\n当然，范式并不是唯一的。假设存在一种 $A$ 的范式为 $(p\\&q\\&r)|(!p\\&q\\&r)|(p\\&!q\\&r)|(p\\&q\\&!r)$ ， 表达式 $(p\\&q)|(q\\&r)|(p\\&r)$ 也是 $A$ 的范式，并且它的长度比前式更短。\n\n我们的要求是：给定 $n$ 元函数 $A$ 的真值表，求 $A$ 的范式，并要求范式尽可能短。", "inputFormat": "输入文件第一行为 $n$（$n \\leq 6$），表示 $A$ 是 $n$ 元函数。随后有 $2^n$ 行，每行为一个长度为 $n+1$ 的字符串。字符串仅包含字符 `T` 和 `F` 。前 $n$ 个依次表示第 $n$ 个命题的值，最后一个表示当 $n$ 个命题按此取值时 $A$ 的值。", "outputFormat": "输出文件包含一行，为你给出的范式。命题依次用小写字母 $a, b, c, d, \\ldots $表示。", "hint": "**评分标准**：\n\n- 如果你给定的范式错误或者在规定时间内没有出解，该测试点得 $0$ 分。\n- 如果你给定的范式长度小于等于标准答案的长度，该测试点得满分。\n- 如果你给定的范式长度大于等于标准答案长度的两倍，该测试点得 $0$ 分。\n- 如果你给定的范式长度大于标准答案的长度，小于标准答案长度的两倍，该测试点得分计算公式为： \n\n$$\nScore=FullScore \\times \\frac{2L_{std}-L}{L_{std}}\n$$\n\n其中 $FullScore$ 为该测试点满分， $L_{std}$ 为标准答案长度， $L$ 为你的答案长度。\n\n**感谢 [tiger2005](https://www.luogu.com.cn/user/60864) 提供 SPJ ！**\n", "locale": "zh-CN"}}}
{"pid": "P6128", "type": "P", "difficulty": 6, "samples": [["3 6 2\n2 2\n2 5 ", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "江苏"], "title": "[JSOI2012] 幼儿园的游戏", "background": "", "description": "公元 $1770$ 年，纪昀先生途经进香河，与百姓谈说人世，谈说友善。他所告诉人们的为友之道，流传至今，深深影响着当地的人们，甚至是幼儿园的孩童。                 \n一天，多诺达新幼儿园的孩子们与老师们排排坐，形成了一个 $n \\times m$ 的矩形队列，一共有 $k$ 个老师，他们融入在了这个矩形队列之中，与小朋友们欢乐地唱着歌。“手拉手，我们永远都是好朋友！”于是老师要求每一位小朋友都和四周(即上下左右四个方向)的任意两个小朋友牵手。                 \n作为幼儿园里最聪明的小朋友，你马上意识到这并不是单纯的游戏，而是一个非常有意义的问题。你非常希望知道一共有多少种不同的牵手方案，满足每一位小朋友都可以和四周恰好两位小朋友牵手。当然，每一位小朋友都只能和小朋友牵手，不能去和老师牵手。任何一位小朋友都不允许自己和自己牵手(即左手拉右手)。 \n你所需要知道的只是方案个数，因为答案可能太大，所以需要对 $1000000007$ 取模。 ", "inputFormat": "第一行有三个整数，分别是 $n$,$m$ 和 $k$。如题。            \n接下来 $k$ 行，每一行有 $2$ 个整数 $x$ 和 $y$，描述了一位老师的位置。 ", "outputFormat": "你只需要输出一个整数，表示答案关于 $10^9+7$ 取模后的结果。 ", "hint": "对于 $100\\%$ 的数据， $1 \\le n \\le 8,1 \\le m \\le 2^{31}-1$，$1 \\le k \\le 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2012] 幼儿园的游戏", "background": "", "description": "公元 $1770$ 年，纪昀先生途经进香河，与百姓谈说人世，谈说友善。他所告诉人们的为友之道，流传至今，深深影响着当地的人们，甚至是幼儿园的孩童。                 \n一天，多诺达新幼儿园的孩子们与老师们排排坐，形成了一个 $n \\times m$ 的矩形队列，一共有 $k$ 个老师，他们融入在了这个矩形队列之中，与小朋友们欢乐地唱着歌。“手拉手，我们永远都是好朋友！”于是老师要求每一位小朋友都和四周(即上下左右四个方向)的任意两个小朋友牵手。                 \n作为幼儿园里最聪明的小朋友，你马上意识到这并不是单纯的游戏，而是一个非常有意义的问题。你非常希望知道一共有多少种不同的牵手方案，满足每一位小朋友都可以和四周恰好两位小朋友牵手。当然，每一位小朋友都只能和小朋友牵手，不能去和老师牵手。任何一位小朋友都不允许自己和自己牵手(即左手拉右手)。 \n你所需要知道的只是方案个数，因为答案可能太大，所以需要对 $1000000007$ 取模。 ", "inputFormat": "第一行有三个整数，分别是 $n$,$m$ 和 $k$。如题。            \n接下来 $k$ 行，每一行有 $2$ 个整数 $x$ 和 $y$，描述了一位老师的位置。 ", "outputFormat": "你只需要输出一个整数，表示答案关于 $10^9+7$ 取模后的结果。 ", "hint": "对于 $100\\%$ 的数据， $1 \\le n \\le 8,1 \\le m \\le 2^{31}-1$，$1 \\le k \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P6129", "type": "P", "difficulty": 6, "samples": [["2\n5 -1\n3\n1 4 1 0\n2 3 1 0\n1 5 1 2", "1.00 2.00\n2.00 3.00\n1.00 1.00"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "江苏"], "title": "[JSOI2012] 铁拳", "background": "经过了可怕的第三次世界大战后，国家政府崩溃，各大财团趁机夺取掌控世界。长年战争后，八大财团幸存并割据一方，其中最强的当属掌控北美的铁拳。 \n在铁拳财团所维护的文明区域中，有一项最为光荣、重要的赛事——`Iron Fist`，也就是铁拳大赛。$IF$中云集了世界各地各财团鼎力资助的世外高手，只为了赢得`IF Champion`，得到无上的荣耀，当然还有随之而来的权力。本来一切秩序井然，但一个来自贫民窟的少年风间仁意外地在海选中赢了 $IF$ 正式选手，获得了决赛资格，从此格局被打乱……                                           \n为了应对这突如其来的变数， $IF$ 管理层决定先对联盟中所有的选手进行评估，以更好地掌握大局。 ", "description": "已知最近 $m$ 届比赛出现过的 $n$ 位选手，背后都有着各自财团的资助，并且签下了合同。由于这是各财团的高度机密，合同的具体细节无从得知，但铁拳财团的间谍们通过各种渠道得知了每个选手的薪金范围（显然薪金是非负数）。 \n对于最近 $m$ 届的 $IF$ 比赛（从 $1$ 开始编号），每一届联盟都会进行清算，通过国际金融手段准确计算出这一届联盟选手身价总和的变化。每一届中，会有一些新选手加入，也会有部分选手在比赛中丧失了战斗能力，而被踢出联盟，流放到贫民窟。                                                 \n现在给出联盟中 $n$ 位选手的身价范围，以及他们 进入联盟的届数（ $0$ 表示在 $m+1$ 届以前就已经是联盟选手） 和 离开联盟的届数（ $0$ 表示是现役选手）。同时给出最近 $m$ 届中，每一届联盟选手身价总和减去上一届的值。                         \n请你根据现有信息，尽可能准确地给出每个选手可能的薪金范围。各选手之间的薪金范围可以不同时成立，但对于一位选手的范围中的每一个数，都必须至少存在一种合法方案使该选手能得到相应薪金，而且这个范围跨度要尽可能大。        \n如果输入信息有误，请输出`-1`，表示无解。 ", "inputFormat": "第一行一个正整数 $m$，意义同上。                                 \n第二行包含 $m$ 个整数，第 $i$ 个表示第 $i$ 届中 选手身价总和 的变化情况。                        \n第三行一个正整数 $n$。                            \n接下来 $n$ 行，每行包含四个整数，分别表示 身价下限 、 身价上限 、 出道届数 、 退役届数，细节请参照上文。                      \n保证出道时间严格比退役时间小（ $0$ 除外）。 ", "outputFormat": "如果输入信息有误，仅输出一行一个整数`-1`。                      \n否则输出 $n$行，每行两个实数，第 $i$ 行表示第 $i$ 个选手实际身价的准确范围，并保留两位小数。 ", "hint": "#### 样例解释#1\n\n第二届只有 $3$ 号离开了，可以锁定 $3$ 号的薪金是 $1$。 \n\n如此一来， $1$ 号和 $2$ 号薪金之和为 $4$，那么 $1$ 号最少能拿 $1$，最多能拿 $2$；$2$ 号最少能拿到 $2$，最多能拿到 $3$。\n\n#### 数据范围\n\n\n对于 $100\\%$的数据，$1 \\le n \\le 200,1 \\le m \\le 100$，给定薪金范围不超过 $20000$。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2012] 铁拳", "background": "经过了可怕的第三次世界大战后，国家政府崩溃，各大财团趁机夺取掌控世界。长年战争后，八大财团幸存并割据一方，其中最强的当属掌控北美的铁拳。 \n在铁拳财团所维护的文明区域中，有一项最为光荣、重要的赛事——`Iron Fist`，也就是铁拳大赛。$IF$中云集了世界各地各财团鼎力资助的世外高手，只为了赢得`IF Champion`，得到无上的荣耀，当然还有随之而来的权力。本来一切秩序井然，但一个来自贫民窟的少年风间仁意外地在海选中赢了 $IF$ 正式选手，获得了决赛资格，从此格局被打乱……                                           \n为了应对这突如其来的变数， $IF$ 管理层决定先对联盟中所有的选手进行评估，以更好地掌握大局。 ", "description": "已知最近 $m$ 届比赛出现过的 $n$ 位选手，背后都有着各自财团的资助，并且签下了合同。由于这是各财团的高度机密，合同的具体细节无从得知，但铁拳财团的间谍们通过各种渠道得知了每个选手的薪金范围（显然薪金是非负数）。 \n对于最近 $m$ 届的 $IF$ 比赛（从 $1$ 开始编号），每一届联盟都会进行清算，通过国际金融手段准确计算出这一届联盟选手身价总和的变化。每一届中，会有一些新选手加入，也会有部分选手在比赛中丧失了战斗能力，而被踢出联盟，流放到贫民窟。                                                 \n现在给出联盟中 $n$ 位选手的身价范围，以及他们 进入联盟的届数（ $0$ 表示在 $m+1$ 届以前就已经是联盟选手） 和 离开联盟的届数（ $0$ 表示是现役选手）。同时给出最近 $m$ 届中，每一届联盟选手身价总和减去上一届的值。                         \n请你根据现有信息，尽可能准确地给出每个选手可能的薪金范围。各选手之间的薪金范围可以不同时成立，但对于一位选手的范围中的每一个数，都必须至少存在一种合法方案使该选手能得到相应薪金，而且这个范围跨度要尽可能大。        \n如果输入信息有误，请输出`-1`，表示无解。 ", "inputFormat": "第一行一个正整数 $m$，意义同上。                                 \n第二行包含 $m$ 个整数，第 $i$ 个表示第 $i$ 届中 选手身价总和 的变化情况。                        \n第三行一个正整数 $n$。                            \n接下来 $n$ 行，每行包含四个整数，分别表示 身价下限 、 身价上限 、 出道届数 、 退役届数，细节请参照上文。                      \n保证出道时间严格比退役时间小（ $0$ 除外）。 ", "outputFormat": "如果输入信息有误，仅输出一行一个整数`-1`。                      \n否则输出 $n$行，每行两个实数，第 $i$ 行表示第 $i$ 个选手实际身价的准确范围，并保留两位小数。 ", "hint": "#### 样例解释#1\n\n第二届只有 $3$ 号离开了，可以锁定 $3$ 号的薪金是 $1$。 \n\n如此一来， $1$ 号和 $2$ 号薪金之和为 $4$，那么 $1$ 号最少能拿 $1$，最多能拿 $2$；$2$ 号最少能拿到 $2$，最多能拿到 $3$。\n\n#### 数据范围\n\n\n对于 $100\\%$的数据，$1 \\le n \\le 200,1 \\le m \\le 100$，给定薪金范围不超过 $20000$。  ", "locale": "zh-CN"}}}
{"pid": "P6130", "type": "P", "difficulty": 6, "samples": [["3\n1 1\n2 2\n2 1", "574619649"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "O2优化", "前缀和", "逆元"], "title": "随机红包", "background": "出题人准备发一个微信红包给一些人，他很好奇如何随机分配里面的钱。", "description": "出题人蒟蒻的红包里有着 $1$ 块钱，他要把这块钱随机分给 $n$ 个人。\n\n为了随机，他设计了以下算法进行分配：（用伪代码表示）\n```\na[0]=0,a[n]=1\nfor i=1 to n-1 do{\n    a[i]=rand()\n}\nsort(a)\nfor i=1 to n do{\n    money[i]=a[i]-a[i-1]\n}\n```\n这里的 `rand()` 函数会等概率随机返回一个 $[0,1]$ 之间的实数值，`sort()` 函数会将一个数组从小到大排序。\n\n现在，出题人蒟蒻很好奇得到钱数第 $k$ 少的人得到的钱的期望。\n\n由于他要根据这个值去推算他要发多少个红包，所以他要问你 $T$ 次。\n\n为了避免精度丢失，答案对 $998244353$ 取模。\n\n为了避免输出量过大，输出所有答案的异或和。", "inputFormat": "**本题有多组数据**。\n\n第一行为整数 $T$，表示数据组数。\n\n对于每组数据，一行两个整数 $n,k$。", "outputFormat": "共一行一个整数，表示所有询问的答案的异或和。", "hint": "**【样例解释】**\n\n第一个问题，$n=k=1$，答案是 $1$。\n\n第二个问题，较大的数在 $[\\dfrac{1}{2},1]$ 上均匀分布，期望为 $\\dfrac{3}{4}$，取模后为 $249561089$。\n\n第三个问题，较小的数在 $[0,\\dfrac{1}{2}]$ 上均匀分布，期望为 $\\dfrac{1}{4}$，取模后为 $748683265$。\n\n异或和为 $574619649$。\n\n------\n\n**【数据范围】**\n\n**本题采用捆绑测试**。\n\n$\\text{Subtask 1 (4 pts)}$：$n \\le 10$，$k=1$。\n\n$\\text{Subtask 2 (16 pts)}$：$n \\le 5 \\times 10^3$。\n\n$\\text{Subtask 3 (20 pts)}$：$k=1$。\n\n$\\text{Subtask 4 (28 pts)}$：$n \\le 10^5$。\n\n$\\text{Subtask 5 (32 pts)}$：没有任何额外限制。\n\n对于 $100\\%$ 的数据，$1 \\le k \\le n \\le 10^7$，$1 \\le T \\le 2 \\times 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "随机红包", "background": "出题人准备发一个微信红包给一些人，他很好奇如何随机分配里面的钱。", "description": "出题人蒟蒻的红包里有着 $1$ 块钱，他要把这块钱随机分给 $n$ 个人。\n\n为了随机，他设计了以下算法进行分配：（用伪代码表示）\n```\na[0]=0,a[n]=1\nfor i=1 to n-1 do{\n    a[i]=rand()\n}\nsort(a)\nfor i=1 to n do{\n    money[i]=a[i]-a[i-1]\n}\n```\n这里的 `rand()` 函数会等概率随机返回一个 $[0,1]$ 之间的实数值，`sort()` 函数会将一个数组从小到大排序。\n\n现在，出题人蒟蒻很好奇得到钱数第 $k$ 少的人得到的钱的期望。\n\n由于他要根据这个值去推算他要发多少个红包，所以他要问你 $T$ 次。\n\n为了避免精度丢失，答案对 $998244353$ 取模。\n\n为了避免输出量过大，输出所有答案的异或和。", "inputFormat": "**本题有多组数据**。\n\n第一行为整数 $T$，表示数据组数。\n\n对于每组数据，一行两个整数 $n,k$。", "outputFormat": "共一行一个整数，表示所有询问的答案的异或和。", "hint": "**【样例解释】**\n\n第一个问题，$n=k=1$，答案是 $1$。\n\n第二个问题，较大的数在 $[\\dfrac{1}{2},1]$ 上均匀分布，期望为 $\\dfrac{3}{4}$，取模后为 $249561089$。\n\n第三个问题，较小的数在 $[0,\\dfrac{1}{2}]$ 上均匀分布，期望为 $\\dfrac{1}{4}$，取模后为 $748683265$。\n\n异或和为 $574619649$。\n\n------\n\n**【数据范围】**\n\n**本题采用捆绑测试**。\n\n$\\text{Subtask 1 (4 pts)}$：$n \\le 10$，$k=1$。\n\n$\\text{Subtask 2 (16 pts)}$：$n \\le 5 \\times 10^3$。\n\n$\\text{Subtask 3 (20 pts)}$：$k=1$。\n\n$\\text{Subtask 4 (28 pts)}$：$n \\le 10^5$。\n\n$\\text{Subtask 5 (32 pts)}$：没有任何额外限制。\n\n对于 $100\\%$ 的数据，$1 \\le k \\le n \\le 10^7$，$1 \\le T \\le 2 \\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P6131", "type": "P", "difficulty": 4, "samples": [["6 16\n................\n..XXXX....XXX...\n...XXXX....XX...\n.XXXX......XXX..\n........XXXXX...\n..XXX....XXX....", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2011", "USACO"], "title": "[USACO11NOV] Cow Beauty Pageant S", "background": "", "description": "听说最近流行表皮有三个斑点的奶牛，Farmer John 迅速购买了不少这样的奶牛。但流行趋势也在改变，最近改为流行只有一个斑点的奶牛了。\n\nFJ 决定在他的奶牛上涂色，从而把三个斑点合并成一个。牛皮由一个 $N \\times M$ 的矩阵来表示，像这样：\n\n```plain\n................\n..XXXX....XXX...\n...XXXX....XX...\n.XXXX......XXX..\n........XXXXX...\n..XXX....XXX....\n```\n\n每个 `X` 表示斑点的一部分。如果两个 `X` 在竖直或水平方向上相邻，则它们属于同一个斑点（对角线相邻不算）。因此上面表示的是一头具有三个斑点的奶牛。\n\nFJ 可以通过将一些 `.` 涂成 `X` 来改变牛身上的图案。他希望使用尽可能少的涂料将三个斑点合并为一个斑点。对于上图，下面是一种消耗涂料最少的方案（只涂了 4 个格子，新涂的格将用 `*` 表示）：\n\n```plain\n................\n..XXXX....XXX...\n...XXXX*...XX...\n.XXXX..**..XXX..\n...*....XXXXX...\n..XXX....XXX....\n```\n\n现在请你帮 FJ 算出将三个斑点合并为一个斑点最少需要涂多少格子。", "inputFormat": "第一行两个整数 $N,M$（$1 \\leq N,M \\leq 50$）。\n\n接下来 $N$ 行，每行 $M$ 个字符（`.` 或 `X`），描述牛表皮的斑点分布情况。保证这头牛恰好有三个斑点。", "outputFormat": "输出将三个斑点合并为一个斑点最少需要涂多少格子。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO11NOV] Cow Beauty Pageant S", "background": "", "description": "听说最近流行表皮有三个斑点的奶牛，Farmer John 迅速购买了不少这样的奶牛。但流行趋势也在改变，最近改为流行只有一个斑点的奶牛了。\n\nFJ 决定在他的奶牛上涂色，从而把三个斑点合并成一个。牛皮由一个 $N \\times M$ 的矩阵来表示，像这样：\n\n```plain\n................\n..XXXX....XXX...\n...XXXX....XX...\n.XXXX......XXX..\n........XXXXX...\n..XXX....XXX....\n```\n\n每个 `X` 表示斑点的一部分。如果两个 `X` 在竖直或水平方向上相邻，则它们属于同一个斑点（对角线相邻不算）。因此上面表示的是一头具有三个斑点的奶牛。\n\nFJ 可以通过将一些 `.` 涂成 `X` 来改变牛身上的图案。他希望使用尽可能少的涂料将三个斑点合并为一个斑点。对于上图，下面是一种消耗涂料最少的方案（只涂了 4 个格子，新涂的格将用 `*` 表示）：\n\n```plain\n................\n..XXXX....XXX...\n...XXXX*...XX...\n.XXXX..**..XXX..\n...*....XXXXX...\n..XXX....XXX....\n```\n\n现在请你帮 FJ 算出将三个斑点合并为一个斑点最少需要涂多少格子。", "inputFormat": "第一行两个整数 $N,M$（$1 \\leq N,M \\leq 50$）。\n\n接下来 $N$ 行，每行 $M$ 个字符（`.` 或 `X`），描述牛表皮的斑点分布情况。保证这头牛恰好有三个斑点。", "outputFormat": "输出将三个斑点合并为一个斑点最少需要涂多少格子。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6132", "type": "P", "difficulty": 7, "samples": [["3 1 2\n0 1", "13"], ["8 2 3\n0 2 3", "7497953"], ["3000 2 3\n0 1 3", "500207304"], ["10000000 3 2\n0 3", "238588124"], ["876543210 233 4\n0 1 2 3", "467638557"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2019", "集训队互测", "O2优化", "矩阵加速", "组合数学", "生成函数", "快速傅里叶变换 FFT"], "title": "[集训队互测 2019] 简单计数", "background": "### 警告，滥用本题者将被封号。\n\n\n$\\mathsf C \\color{red}\\mathsf{auchySheep}$ 近期优化了他的 快速数论变换 (NTT) 模板的常数，现在他能在 $0.1\\text s$ 内轻松跑过 $n=10^9$ 了，所以他准备用下面的这个简单计数题也考验一下你的常数优化水平。", "description": "传说，在很久很久以前，有一张 $n​$ 个点的带标号**有向无环**图。每条边有一个颜色，为 $k$ 种不同颜色中的一种。这张图满足如下性质：\n\n- 每个点有不超过 $1$ 条出边  \n- 每个点的入边条数在集合 $S$ 中\n\n由于某种原因，你想知道这样的图的个数。由于这样的图可能很多，你只要输出答案对 $998244353​$ 取模的值。\n\n两个图不同当且仅当存在一条从某个点 $a$ 到某个点 $b$ 的有向边，它只在恰好一个图中出现，或在两个图中都出现但颜色不同。", "inputFormat": "第一行输入三个正整数 $n, k, |S|$。  \n第二行从小到大输入 $|S|$ 个不同的非负整数，表示 $S$ 集合中的元素。", "outputFormat": "输出一行一个 $[0,998244352]$ 的整数，表示符合题意的图的个数对 $998244353​$ 取模的值。", "hint": "【样例一解释】  \n有如下 $13$ 个符合题意的图，其中 $a \\to b$ 表示一条从 $a$ 连向 $b$ 的有向边：\n\n1. 没有边\n2. $1 \\to 2$\n3. $2 \\to 1$\n4. $1 \\to3$\n5. $3 \\to 1$\n6. $2 \\to 3$\n7. $3 \\to 2$\n8. $1 \\to 2 \\to 3$\n9. $1 \\to 3 \\to 2$\n10. $2 \\to 1 \\to 3$\n11. $2 \\to 3 \\to 1$\n12. $3 \\to 1 \\to 2$\n13. $3 \\to 2 \\to 1$\n\n【数据范围】  \n数据共分为 $7$ 个子任务。\n\n- 子任务 $1$（$5$ 分）：$n \\leq 8$。\n- 子任务 $2$（$10$ 分）：$n \\leq 5000$。\n- 子任务 $3$（$30$ 分）：$n \\leq 10^5$。\n- 子任务 $4$（$20$ 分）：$n \\leq 10^7$。\n- 子任务 $5$（$15$ 分）：$n \\leq 10^8$。\n- 子任务 $6$（$10$ 分）：$S=\\{0,1\\}$。\n- 子任务 $7$（$10$ 分）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 9 \\times 10^8​$，$1 \\le k \\le 10^7$，$S \\neq \\varnothing$，$S \\subseteq \\{0,1,2,3\\}$。 \n\nBy：fjzzq2002  \n来源：2019 年集训队互测 Day5", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2019] 简单计数", "background": "### 警告，滥用本题者将被封号。\n\n\n$\\mathsf C \\color{red}\\mathsf{auchySheep}$ 近期优化了他的 快速数论变换 (NTT) 模板的常数，现在他能在 $0.1\\text s$ 内轻松跑过 $n=10^9$ 了，所以他准备用下面的这个简单计数题也考验一下你的常数优化水平。", "description": "传说，在很久很久以前，有一张 $n​$ 个点的带标号**有向无环**图。每条边有一个颜色，为 $k$ 种不同颜色中的一种。这张图满足如下性质：\n\n- 每个点有不超过 $1$ 条出边  \n- 每个点的入边条数在集合 $S$ 中\n\n由于某种原因，你想知道这样的图的个数。由于这样的图可能很多，你只要输出答案对 $998244353​$ 取模的值。\n\n两个图不同当且仅当存在一条从某个点 $a$ 到某个点 $b$ 的有向边，它只在恰好一个图中出现，或在两个图中都出现但颜色不同。", "inputFormat": "第一行输入三个正整数 $n, k, |S|$。  \n第二行从小到大输入 $|S|$ 个不同的非负整数，表示 $S$ 集合中的元素。", "outputFormat": "输出一行一个 $[0,998244352]$ 的整数，表示符合题意的图的个数对 $998244353​$ 取模的值。", "hint": "【样例一解释】  \n有如下 $13$ 个符合题意的图，其中 $a \\to b$ 表示一条从 $a$ 连向 $b$ 的有向边：\n\n1. 没有边\n2. $1 \\to 2$\n3. $2 \\to 1$\n4. $1 \\to3$\n5. $3 \\to 1$\n6. $2 \\to 3$\n7. $3 \\to 2$\n8. $1 \\to 2 \\to 3$\n9. $1 \\to 3 \\to 2$\n10. $2 \\to 1 \\to 3$\n11. $2 \\to 3 \\to 1$\n12. $3 \\to 1 \\to 2$\n13. $3 \\to 2 \\to 1$\n\n【数据范围】  \n数据共分为 $7$ 个子任务。\n\n- 子任务 $1$（$5$ 分）：$n \\leq 8$。\n- 子任务 $2$（$10$ 分）：$n \\leq 5000$。\n- 子任务 $3$（$30$ 分）：$n \\leq 10^5$。\n- 子任务 $4$（$20$ 分）：$n \\leq 10^7$。\n- 子任务 $5$（$15$ 分）：$n \\leq 10^8$。\n- 子任务 $6$（$10$ 分）：$S=\\{0,1\\}$。\n- 子任务 $7$（$10$ 分）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 9 \\times 10^8​$，$1 \\le k \\le 10^7$，$S \\neq \\varnothing$，$S \\subseteq \\{0,1,2,3\\}$。 \n\nBy：fjzzq2002  \n来源：2019 年集训队互测 Day5", "locale": "zh-CN"}}}
{"pid": "P6134", "type": "P", "difficulty": 5, "samples": [["5 6\n1 2\n2 3\n3 5\n4 5\n1 5\n1 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "各省省选", "江苏", "拓扑排序", "bitset"], "title": "[JSOI2015] 最小表示", "background": "还记得去年 JYY 所研究的强连通分量的问题吗？去年的题目里，JYY 研究了对于有向图的“加边”问题。对于图论有着强烈兴趣的 JYY，今年又琢磨起了“删边”的问题。", "description": "对于一个 $N$ 个点（每个点从 $1$ 到 $N$ 编号），$M$ 条边的有向图，JYY 发现，如果从图中删去一些边，那么原图的连通性会发生改变；而也有一些边，删去之后图的连通性并不会发生改变。\n\nJYY 想知道，如果想要使得原图任意两点的连通性保持不变，我们最多能删掉多少条边呢？\n\n\n为了简化一下大家的工作量，这次 JYY 保证他给定的有向图一定是一个有向无环图（JYY：大家经过去年的问题，都知道对于给任意有向图的问题，最后都能转化为有向无环图上的问题，所以今年 JYY 就干脆简化一下大家的工作）。", "inputFormat": "第一行包含两个正整数 $N$ 和 $M$。\n\n接下来 $M$ 行，每行包含两个 $1$ 到 $N$ 之间的正整数 $x_i$ 和 $y_i$，表示图中存在一条从 $x_i$ 到 $y_i$ 的有向边。\n\n输入数据保证，任意两点间只会有至多一条边存在。", "outputFormat": "输出一行包含一个整数，表示JYY最多可以删掉的边数。", "hint": "### 样例解释\n\n一种合法方案为删去 $1\\rightarrow 5$ 和 $1\\rightarrow 3$。容易证明没有比 $2$ 更优的答案。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1 \\leq N\\leq 3\\times 10^4$，$0 \\leq M\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 最小表示", "background": "还记得去年 JYY 所研究的强连通分量的问题吗？去年的题目里，JYY 研究了对于有向图的“加边”问题。对于图论有着强烈兴趣的 JYY，今年又琢磨起了“删边”的问题。", "description": "对于一个 $N$ 个点（每个点从 $1$ 到 $N$ 编号），$M$ 条边的有向图，JYY 发现，如果从图中删去一些边，那么原图的连通性会发生改变；而也有一些边，删去之后图的连通性并不会发生改变。\n\nJYY 想知道，如果想要使得原图任意两点的连通性保持不变，我们最多能删掉多少条边呢？\n\n\n为了简化一下大家的工作量，这次 JYY 保证他给定的有向图一定是一个有向无环图（JYY：大家经过去年的问题，都知道对于给任意有向图的问题，最后都能转化为有向无环图上的问题，所以今年 JYY 就干脆简化一下大家的工作）。", "inputFormat": "第一行包含两个正整数 $N$ 和 $M$。\n\n接下来 $M$ 行，每行包含两个 $1$ 到 $N$ 之间的正整数 $x_i$ 和 $y_i$，表示图中存在一条从 $x_i$ 到 $y_i$ 的有向边。\n\n输入数据保证，任意两点间只会有至多一条边存在。", "outputFormat": "输出一行包含一个整数，表示JYY最多可以删掉的边数。", "hint": "### 样例解释\n\n一种合法方案为删去 $1\\rightarrow 5$ 和 $1\\rightarrow 3$。容易证明没有比 $2$ 更优的答案。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1 \\leq N\\leq 3\\times 10^4$，$0 \\leq M\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P6136", "type": "P", "difficulty": 5, "samples": [["6 7\n1 1 4 5 1 4\n2 1\n1 9\n4 1\n5 8\n3 13\n6 7\n1 4\n", "6\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["平衡树", "O2优化", "模板题"], "title": "【模板】普通平衡树（数据加强版）", "background": "本题是 P3369 数据加强版，**扩大数据范围**并增加了**强制在线**。\n\n**题目的输入、输出和原题略有不同**，但需要支持的操作相同。", "description": "您需要动态地维护一个可重集合 $M$，并且提供以下操作：\n\n1. 向 $M$ 中插入一个数 $x$。\n2. 从 $M$ 中删除一个数 $x$（若有多个相同的数，应只删除一个）。\n3. 查询 $M$ 中有多少个数比 $x$ 小，并且将得到的答案加一。\n4. 查询如果将 $M$ 从小到大排列后，排名位于第 $x$ 位的数。\n5. 查询 $M$ 中 $x$ 的前驱（前驱定义为小于 $x$，且最大的数）。\n6. 查询 $M$ 中 $x$ 的后继（后继定义为大于 $x$，且最小的数）。\n\n本题**强制在线**，保证所有操作合法（操作 $2$ 保证存在至少一个 $x$，操作 $4,5,6$ 保证存在答案）。", "inputFormat": "第一行两个正整数 $n,m$，表示**初始数的个数**和操作的个数。\n\n**第二行 $n$ 个整数 $a_1,a_2,a_3,\\ldots,a_n$，表示初始的数**。\n\n接下来 $m$ 行，每行有两个整数 $\\text{opt}$ 和 $x'$，$\\text{opt}$ 表示操作的序号（$ 1 \\leq \\text{opt} \\leq 6 $），$x'$ 表示加密后的操作数。\n\n我们记 $\\text{last}$ 表示上一次 $3,4,5,6$ 操作的答案，则每次操作的 $x'$ 都要**异或**上 $\\text{last}$ 才是真实的 $x$。初始 $\\text{last}$ 为 $0$。", "outputFormat": "输出一行一个整数，表示所有 $3,4,5,6$ 操作的答案的**异或和**。", "hint": "### 样例解释\n\n样例加密前为：\n```plain\n6 7\n1 1 4 5 1 4\n2 1\n1 9\n4 1\n5 9\n3 8\n6 1\n1 0\n```\n::::info[每一个操作的输出]\n执行第一个操作前，$M=\\{1,1,1,4,4,5\\}$，完成后 $M=\\{1,1,4,4,5\\}$。\n\n执行第二个操作后 $M=\\{1,1,4,4,5,9\\}$。\n\n第三个操作查询 $M$ 中第 $1$ 小的数字，答案为 $1$。\n\n第四个操作查询 $M$ 中 $9$ 的前驱，答案为 $5$。\n\n第五个操作查询 $M$ 中有多少个数比 $8$ 小，并且将答案加 $1$，答案为 $6$。\n\n第六个操作查询 $M$ 中 $1$ 的后继，答案为 $4$。\n\n第七个操作完成后 $M=\\{0,1,1,4,4,5,9\\}$。\n\n输出 $1\\oplus5\\oplus6\\oplus4=6$。\n::::\n\n### 限制与约定\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 10^5$，$1\\leq m\\leq 10^6$，$0\\leq a_i,x\\lt 2^{30}$。\n\n**本题输入数据较大，请使用较快的读入方式。**\n\n---\n\n$\\text{upd 2022.7.22}$：新增加 $9$ 组 Hack 数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】普通平衡树（数据加强版）", "background": "本题是 P3369 数据加强版，**扩大数据范围**并增加了**强制在线**。\n\n**题目的输入、输出和原题略有不同**，但需要支持的操作相同。", "description": "您需要动态地维护一个可重集合 $M$，并且提供以下操作：\n\n1. 向 $M$ 中插入一个数 $x$。\n2. 从 $M$ 中删除一个数 $x$（若有多个相同的数，应只删除一个）。\n3. 查询 $M$ 中有多少个数比 $x$ 小，并且将得到的答案加一。\n4. 查询如果将 $M$ 从小到大排列后，排名位于第 $x$ 位的数。\n5. 查询 $M$ 中 $x$ 的前驱（前驱定义为小于 $x$，且最大的数）。\n6. 查询 $M$ 中 $x$ 的后继（后继定义为大于 $x$，且最小的数）。\n\n本题**强制在线**，保证所有操作合法（操作 $2$ 保证存在至少一个 $x$，操作 $4,5,6$ 保证存在答案）。", "inputFormat": "第一行两个正整数 $n,m$，表示**初始数的个数**和操作的个数。\n\n**第二行 $n$ 个整数 $a_1,a_2,a_3,\\ldots,a_n$，表示初始的数**。\n\n接下来 $m$ 行，每行有两个整数 $\\text{opt}$ 和 $x'$，$\\text{opt}$ 表示操作的序号（$ 1 \\leq \\text{opt} \\leq 6 $），$x'$ 表示加密后的操作数。\n\n我们记 $\\text{last}$ 表示上一次 $3,4,5,6$ 操作的答案，则每次操作的 $x'$ 都要**异或**上 $\\text{last}$ 才是真实的 $x$。初始 $\\text{last}$ 为 $0$。", "outputFormat": "输出一行一个整数，表示所有 $3,4,5,6$ 操作的答案的**异或和**。", "hint": "### 样例解释\n\n样例加密前为：\n```plain\n6 7\n1 1 4 5 1 4\n2 1\n1 9\n4 1\n5 9\n3 8\n6 1\n1 0\n```\n::::info[每一个操作的输出]\n执行第一个操作前，$M=\\{1,1,1,4,4,5\\}$，完成后 $M=\\{1,1,4,4,5\\}$。\n\n执行第二个操作后 $M=\\{1,1,4,4,5,9\\}$。\n\n第三个操作查询 $M$ 中第 $1$ 小的数字，答案为 $1$。\n\n第四个操作查询 $M$ 中 $9$ 的前驱，答案为 $5$。\n\n第五个操作查询 $M$ 中有多少个数比 $8$ 小，并且将答案加 $1$，答案为 $6$。\n\n第六个操作查询 $M$ 中 $1$ 的后继，答案为 $4$。\n\n第七个操作完成后 $M=\\{0,1,1,4,4,5,9\\}$。\n\n输出 $1\\oplus5\\oplus6\\oplus4=6$。\n::::\n\n### 限制与约定\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 10^5$，$1\\leq m\\leq 10^6$，$0\\leq a_i,x\\lt 2^{30}$。\n\n**本题输入数据较大，请使用较快的读入方式。**\n\n---\n\n$\\text{upd 2022.7.22}$：新增加 $9$ 组 Hack 数据。", "locale": "zh-CN"}}}
{"pid": "P6137", "type": "P", "difficulty": 6, "samples": [["11\n2 5\n2 6\n3 3\n3 6\n4 3\n4 4\n4 5\n4 6\n5 3\n5 4\n5 6\n", "174"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "IOI"], "title": "[IOI 2012] 理想城", "background": null, "description": "像许多同龄的科学家和艺术家一样，小 L 对城市规划和城区设计很感兴趣.他致力于构建一个理想城。理想城由 $N$ 个区块组成，而这些区块放在一个无限大的正方形网格上。第 $x$ 行第 $y$ 列的单元格由有序数对 $(x,y)$来标识。单元格 $(0,0)$ 位于网格的左上角。给定一个单元格 $(x,y)$，与之相邻的单元格（如果存在的话）分别为：$(x-1,y)$，$(x+1,y)$，$(x,y-1)$，$(x,y+1)$。每个区块在网格上恰好覆盖一个单元格。一个区块能够被放置在单元格 $(x,y)$ 上，当且仅当 $1 \\le x,y \\le 2^{31}-2$ 。我们将使用单元格的坐标同时来代表单元格上面的区块。若两个区块被放在相邻的单元格中，则视它们为相邻区块.理想城所有的区块连在一起，里面没有“洞”存在.换言之，所有单元格必须满足下述两个条件：\n- 对于任意两个空白的单元格，至少存在一连串相邻的空白单元格连接它们。\n- 对于任意两个非空的单元格，至少存在一连串相邻的非空单元格连接它们。\n\n以下 $4$ 个图中的区块放置均不满足理想城的条件。前两个图不满足第一个条件。第 $3$ 个图不满足第二个条件，第 $4$ 个图两个条件均不满足。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uzw8c8c8.png)\n\n当遍历理想城时，一个**跳步**代表**从一个区块走到一个相邻的区块**。跳步时不能移进空白单元格。假设 $v_0,v_1,\\cdots,v_{N-1}$ 是 $N$ 个区块的坐标。对于任意两个不同的区块 $v_i$ 和 $v_j$，它们的距离 $d(v_i,v_j)$ 是从 $v_i$ 移动到 $v_j$ 所需的最小跳步数目。\n\n下图是一个由 $11$ 个区块组成的理想城。区块坐标分别为\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5whsvyjh.png)\n\n$$v_0=(2,5) \\quad v_1=(2,6) \\quad v_2=(3,3)$$\n$$v_3=(3,6) \\quad v_4=(4,3) \\quad v_5=(4,4)$$\n$$v_6=(4,5) \\quad v_7=(4,6) \\quad v_8=(5,3)$$\n$$v_9=(5,4) \\quad v_{10}=(5,6)$$\n\n\n其中，$d(v_1,v_3)=1$，$d(v_1,v_8)=6$，$d(v_6,v_{10})=2$，$d(v_9,v_{10})=4$。\n\n给定一个理想域，试求\n$$S=\\sum_{i=0}^{N-2}\\sum_{j=i+1}^{N-1}d(v_i,v_j)$$", "inputFormat": "第 $1$ 行为一个正整数 $N$，为理想城区块的数目。\n\n第 $2$ 行到第 $N+1$ 行，每行有两个非负整数。第 $i+2$ 行为第 $i$ 个区块的坐标 $v_i = (x_i， y_i)$。", "outputFormat": "输出仅一行一个正整数，为 $S$ 的值。由于 $S$ 的值可能较大，你只需输出 $S$ 对 $10^9$ 取模的值。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le x_i,y_i \\le 2^{31}-2$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2012] Ideal City", "background": "", "description": "Like many scientists and artists of his age, Little L is very interested in city planning and urban design. He is devoted to building an ideal city. The ideal city consists of $N$ blocks, and these blocks are placed on an infinite square grid. The cell in row $x$ and column $y$ is identified by the ordered pair $(x,y)$. The cell $(0,0)$ is located at the upper-left corner of the grid. Given a cell $(x,y)$, the adjacent cells (if they exist) are: $(x-1,y)$, $(x+1,y)$, $(x,y-1)$, $(x,y+1)$. Each block covers exactly one cell on the grid. A block can be placed on cell $(x,y)$ if and only if $1 \\le x,y \\le 2^{31}-2$. We will use the coordinates of a cell to also denote the block on that cell. If two blocks are placed in adjacent cells, they are considered adjacent blocks. All blocks in the ideal city are connected, and there are no “holes” inside. In other words, all cells must satisfy the following two conditions:\n\n- For any two empty cells, there exists at least one sequence of adjacent empty cells connecting them.\n- For any two non-empty cells, there exists at least one sequence of adjacent non-empty cells connecting them.\n\nThe block placements in the following $4$ figures do not satisfy the conditions of an ideal city. The first two figures do not satisfy the first condition. The $3$rd figure does not satisfy the second condition, and the $4$th figure satisfies neither condition.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uzw8c8c8.png)\n\nWhen traversing the ideal city, one **step** means **moving from one block to an adjacent block**. During a step, you cannot move into an empty cell. Suppose $v_0,v_1,\\cdots,v_{N-1}$ are the coordinates of the $N$ blocks. For any two different blocks $v_i$ and $v_j$, their distance $d(v_i,v_j)$ is the minimum number of steps needed to move from $v_i$ to $v_j$.\n\nThe figure below shows an ideal city consisting of $11$ blocks. The block coordinates are:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5whsvyjh.png)\n\n$$v_0=(2,5) \\quad v_1=(2,6) \\quad v_2=(3,3)$$\n$$v_3=(3,6) \\quad v_4=(4,3) \\quad v_5=(4,4)$$\n$$v_6=(4,5) \\quad v_7=(4,6) \\quad v_8=(5,3)$$\n$$v_9=(5,4) \\quad v_{10}=(5,6)$$\n\nHere, $d(v_1,v_3)=1$, $d(v_1,v_8)=6$, $d(v_6,v_{10})=2$, and $d(v_9,v_{10})=4$.\n\nGiven an ideal city, compute\n$$S=\\sum_{i=0}^{N-2}\\sum_{j=i+1}^{N-1}d(v_i,v_j)$$", "inputFormat": "The first line contains a positive integer $N$, the number of blocks in the ideal city.\n\nLines $2$ to $N+1$ each contain two non-negative integers. Line $i+2$ gives the coordinates of the $i$-th block $v_i = (x_i, y_i)$.", "outputFormat": "Output a single line containing a positive integer, the value of $S$. Since $S$ may be very large, you only need to output $S$ modulo $10^9$.", "hint": "For $100\\%$ of the testdata, $1 \\le N \\le 10^5$, and $1 \\le x_i,y_i \\le 2^{31}-2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2012] 理想城", "background": null, "description": "像许多同龄的科学家和艺术家一样，小 L 对城市规划和城区设计很感兴趣.他致力于构建一个理想城。理想城由 $N$ 个区块组成，而这些区块放在一个无限大的正方形网格上。第 $x$ 行第 $y$ 列的单元格由有序数对 $(x,y)$来标识。单元格 $(0,0)$ 位于网格的左上角。给定一个单元格 $(x,y)$，与之相邻的单元格（如果存在的话）分别为：$(x-1,y)$，$(x+1,y)$，$(x,y-1)$，$(x,y+1)$。每个区块在网格上恰好覆盖一个单元格。一个区块能够被放置在单元格 $(x,y)$ 上，当且仅当 $1 \\le x,y \\le 2^{31}-2$ 。我们将使用单元格的坐标同时来代表单元格上面的区块。若两个区块被放在相邻的单元格中，则视它们为相邻区块.理想城所有的区块连在一起，里面没有“洞”存在.换言之，所有单元格必须满足下述两个条件：\n- 对于任意两个空白的单元格，至少存在一连串相邻的空白单元格连接它们。\n- 对于任意两个非空的单元格，至少存在一连串相邻的非空单元格连接它们。\n\n以下 $4$ 个图中的区块放置均不满足理想城的条件。前两个图不满足第一个条件。第 $3$ 个图不满足第二个条件，第 $4$ 个图两个条件均不满足。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uzw8c8c8.png)\n\n当遍历理想城时，一个**跳步**代表**从一个区块走到一个相邻的区块**。跳步时不能移进空白单元格。假设 $v_0,v_1,\\cdots,v_{N-1}$ 是 $N$ 个区块的坐标。对于任意两个不同的区块 $v_i$ 和 $v_j$，它们的距离 $d(v_i,v_j)$ 是从 $v_i$ 移动到 $v_j$ 所需的最小跳步数目。\n\n下图是一个由 $11$ 个区块组成的理想城。区块坐标分别为\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5whsvyjh.png)\n\n$$v_0=(2,5) \\quad v_1=(2,6) \\quad v_2=(3,3)$$\n$$v_3=(3,6) \\quad v_4=(4,3) \\quad v_5=(4,4)$$\n$$v_6=(4,5) \\quad v_7=(4,6) \\quad v_8=(5,3)$$\n$$v_9=(5,4) \\quad v_{10}=(5,6)$$\n\n\n其中，$d(v_1,v_3)=1$，$d(v_1,v_8)=6$，$d(v_6,v_{10})=2$，$d(v_9,v_{10})=4$。\n\n给定一个理想域，试求\n$$S=\\sum_{i=0}^{N-2}\\sum_{j=i+1}^{N-1}d(v_i,v_j)$$", "inputFormat": "第 $1$ 行为一个正整数 $N$，为理想城区块的数目。\n\n第 $2$ 行到第 $N+1$ 行，每行有两个非负整数。第 $i+2$ 行为第 $i$ 个区块的坐标 $v_i = (x_i， y_i)$。", "outputFormat": "输出仅一行一个正整数，为 $S$ 的值。由于 $S$ 的值可能较大，你只需输出 $S$ 对 $10^9$ 取模的值。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le x_i,y_i \\le 2^{31}-2$ 。", "locale": "zh-CN"}}}
{"pid": "P6138", "type": "P", "difficulty": 6, "samples": [["5 3 3\n1 0 2 4\n1 3\n0 1\n0 1\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "IOI"], "title": "[IOI 2012] 骑马比武竞赛", "background": "", "description": "1491 年公爵 Milan Lodovico Sforza 为了他与 Beatrice d'Este 的婚礼，要求Leonardo 来负责筹备婚礼的庆典。在这个庆典中包含了一个盛大的持续三天的骑马比武竞赛，但是最受欢迎的骑士迟到了...\n\n在一骑马比武的竞赛，$N$ 个骑士一开始被排成一排然后按照他们的位置从 $0$ 到 $N-1$ 开始编号。骑马比武的主持人每一回合叫出两个位置 $S$ 跟 $E$ （其中 $0 \\le S < E \\le N - 1$）。所有介于 $S$ 与 $E$ （含） 这两个位置的骑士则开始进行骑马比武。最后的赢家可以留下来继续进行竞赛， 并回到他原来的位置，而输家则离开这个竞赛。在这之后，剩下的骑士按照原来排列的顺 序，往前挤掉空出来的位置。所以他们的位置编号变成从 $0$ 到 $N - (E - S) - 1$。骑马比武竞赛的主持人接着进行下一个回合的比赛，直到最后剩下唯一个骑士。\n\nLeonardo 知道所有骑士有不同的强度，这个强度从 $0$ (最弱) 到 $N-1$ (最强)。他也知道骑马比武竞赛的主持人会下怎么样的命令来进行C回合的竞赛，毕竟他是无所不能的   Leonardo。而且他也确定在每一个回合中，拥有最大强度的骑士会获得胜利。\n\n$N$ 个骑士中的 $N-1$ 个骑士已经排成了一排，只是最受欢迎的骑士还未出现。这个骑士的强度为 $R$ 但是他迟到了。为了让这场竞赛达到最高潮, Leonardo  想要让这个骑士能好好展现他的风采，所以想要帮他安插一个位置，而这个位置可以使得这个骑士能获得最多回合的 胜利。请注意，我们不关心与此骑士无关的回合。我们只关心包含此骑士而且由他赢得胜利的回合。\n\n**例子**\n\n假设有 $5$ 个骑士，其中 $4$ 个骑士已经排列好，而他们的强度分别是 $[1,0,2,4]$。而迟到骑士的强度为 $3$ 。假设要进行 $3$ 回合，骑马比武的主持人打算要叫出的位置 $(S,E)$ 分别是 $(1, 3)$，$(0, 1)$，$(0, 1)$。\n\n假设 Leonardo  将迟到的骑士插到第一个位置而且迟到的骑士强度为 $3$。那么骑士强度的排列将会是 $[3, 1, 0, 2, 4]$。第一回合参与的骑士为位置 $1,2,3$ 的骑士，他们的强度分别是 $1,0,2$，所以由强度 $2$ 的骑士获得胜利。经过这一回合，新的骑士强度的排列变成 $[3, 2, 4]]$。下一个回合是由强度 $3$ 与强度 $2$（位置 $0,1$）的骑士进行比赛，由强度 $3$ 的骑士获得胜利。而骑士强度的排列则变成 $[3,4]$。最后一回合（位置 $0,1$）由强度 $4$ 的骑士获得胜利。那么，迟到的骑士只有获得一回合的胜利 (第二回合)。\n\n若 Leonardo 将迟到的骑士插入强度 $1$ 与强度 $0$ 的骑士中间，骑士强度的排列将会是 $[1,3,0,2,4]$。这一次,  第一回合比赛的骑士强度为 $3,0,2$。由强度 $3$ 的骑士获胜，然后骑士强度的排列变成 $[1,3,4]$。在第二回合中由强度 $1$ 对上强度 $3$ 的骑士，由强度 $3$ 的骑士获胜。最后的一回合，骑士强度的排列变成  $[3,4]$，由强度 $4$ 的骑士获得胜利。在这个排列中，迟到的骑士获得两回合的胜利。这实际上是最佳的位置，因为没有其他的位置可以让迟到的骑士获得两回合以上的胜利。\n\n你的任务是写一个程序来帮迟到的骑士选择最佳的位置让他能获得最多的胜利回合数，以符合 Leonardo 的期待。", "inputFormat": "- 第一行，$3$个整数 $N$，$C$，$R$，其中 $N$ 表示骑士的个数，$C$ 表示竞赛主持人会进行的回合数，$R$ 表示迟到的骑士的强度。\n- 第二行，$N$ 个整数 $K[0],K[1],\\cdots,K[N-1]$，表示已经排列好成一列的 $N-1$ 个骑士的强度\n- 第三行，$2C$ 个整数 $S[0],E[0],S[1],E[1],\\cdots,E[N-1],S[N-1]$，对于 $0 \\le i \\le C-1$，竞赛主持人进行第 $i +1$ 回合比赛的骑士为从位置 $S[i]$ 到位置 $E[i]$ (含). 你可以假设对每一个 $i$ , $S[i] < E[i]$。", "outputFormat": "共一行，让迟到的骑士能获得最多胜利回合数的位置。如果存在多个最优的位置，输出编号最小的位置。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le C \\le N-1$，在第 $i+1$ 回合，$E[i]$ 会小于这个回合剩下的骑士数量。经过 $C$ 回合的命令之后，只会剩下一个骑士。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[IOI 2012] 骑马比武竞赛", "background": "", "description": "1491 年公爵 Milan Lodovico Sforza 为了他与 Beatrice d'Este 的婚礼，要求Leonardo 来负责筹备婚礼的庆典。在这个庆典中包含了一个盛大的持续三天的骑马比武竞赛，但是最受欢迎的骑士迟到了...\n\n在一骑马比武的竞赛，$N$ 个骑士一开始被排成一排然后按照他们的位置从 $0$ 到 $N-1$ 开始编号。骑马比武的主持人每一回合叫出两个位置 $S$ 跟 $E$ （其中 $0 \\le S < E \\le N - 1$）。所有介于 $S$ 与 $E$ （含） 这两个位置的骑士则开始进行骑马比武。最后的赢家可以留下来继续进行竞赛， 并回到他原来的位置，而输家则离开这个竞赛。在这之后，剩下的骑士按照原来排列的顺 序，往前挤掉空出来的位置。所以他们的位置编号变成从 $0$ 到 $N - (E - S) - 1$。骑马比武竞赛的主持人接着进行下一个回合的比赛，直到最后剩下唯一个骑士。\n\nLeonardo 知道所有骑士有不同的强度，这个强度从 $0$ (最弱) 到 $N-1$ (最强)。他也知道骑马比武竞赛的主持人会下怎么样的命令来进行C回合的竞赛，毕竟他是无所不能的   Leonardo。而且他也确定在每一个回合中，拥有最大强度的骑士会获得胜利。\n\n$N$ 个骑士中的 $N-1$ 个骑士已经排成了一排，只是最受欢迎的骑士还未出现。这个骑士的强度为 $R$ 但是他迟到了。为了让这场竞赛达到最高潮, Leonardo  想要让这个骑士能好好展现他的风采，所以想要帮他安插一个位置，而这个位置可以使得这个骑士能获得最多回合的 胜利。请注意，我们不关心与此骑士无关的回合。我们只关心包含此骑士而且由他赢得胜利的回合。\n\n**例子**\n\n假设有 $5$ 个骑士，其中 $4$ 个骑士已经排列好，而他们的强度分别是 $[1,0,2,4]$。而迟到骑士的强度为 $3$ 。假设要进行 $3$ 回合，骑马比武的主持人打算要叫出的位置 $(S,E)$ 分别是 $(1, 3)$，$(0, 1)$，$(0, 1)$。\n\n假设 Leonardo  将迟到的骑士插到第一个位置而且迟到的骑士强度为 $3$。那么骑士强度的排列将会是 $[3, 1, 0, 2, 4]$。第一回合参与的骑士为位置 $1,2,3$ 的骑士，他们的强度分别是 $1,0,2$，所以由强度 $2$ 的骑士获得胜利。经过这一回合，新的骑士强度的排列变成 $[3, 2, 4]]$。下一个回合是由强度 $3$ 与强度 $2$（位置 $0,1$）的骑士进行比赛，由强度 $3$ 的骑士获得胜利。而骑士强度的排列则变成 $[3,4]$。最后一回合（位置 $0,1$）由强度 $4$ 的骑士获得胜利。那么，迟到的骑士只有获得一回合的胜利 (第二回合)。\n\n若 Leonardo 将迟到的骑士插入强度 $1$ 与强度 $0$ 的骑士中间，骑士强度的排列将会是 $[1,3,0,2,4]$。这一次,  第一回合比赛的骑士强度为 $3,0,2$。由强度 $3$ 的骑士获胜，然后骑士强度的排列变成 $[1,3,4]$。在第二回合中由强度 $1$ 对上强度 $3$ 的骑士，由强度 $3$ 的骑士获胜。最后的一回合，骑士强度的排列变成  $[3,4]$，由强度 $4$ 的骑士获得胜利。在这个排列中，迟到的骑士获得两回合的胜利。这实际上是最佳的位置，因为没有其他的位置可以让迟到的骑士获得两回合以上的胜利。\n\n你的任务是写一个程序来帮迟到的骑士选择最佳的位置让他能获得最多的胜利回合数，以符合 Leonardo 的期待。", "inputFormat": "- 第一行，$3$个整数 $N$，$C$，$R$，其中 $N$ 表示骑士的个数，$C$ 表示竞赛主持人会进行的回合数，$R$ 表示迟到的骑士的强度。\n- 第二行，$N$ 个整数 $K[0],K[1],\\cdots,K[N-1]$，表示已经排列好成一列的 $N-1$ 个骑士的强度\n- 第三行，$2C$ 个整数 $S[0],E[0],S[1],E[1],\\cdots,E[N-1],S[N-1]$，对于 $0 \\le i \\le C-1$，竞赛主持人进行第 $i +1$ 回合比赛的骑士为从位置 $S[i]$ 到位置 $E[i]$ (含). 你可以假设对每一个 $i$ , $S[i] < E[i]$。", "outputFormat": "共一行，让迟到的骑士能获得最多胜利回合数的位置。如果存在多个最优的位置，输出编号最小的位置。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le C \\le N-1$，在第 $i+1$ 回合，$E[i]$ 会小于这个回合剩下的骑士数量。经过 $C$ 回合的命令之后，只会剩下一个骑士。", "locale": "zh-CN"}}}
{"pid": "P6139", "type": "P", "difficulty": 6, "samples": [["4\naa\nab\nbac\ncaa", "10\n10"], ["1\na", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["后缀自动机 SAM", "O2优化", "模板题"], "title": "【模板】广义后缀自动机（广义 SAM）", "background": "管理员备注：本题于 2023 年 5 月 4 日加入输出点数的要求。本题在此之前提交的题解均没有输出点数，特此注明。", "description": "给定 $n$ 个由小写字母组成的字符串 $s_1,s_2\\ldots s_n$，求本质不同的子串个数。（不包含空串）\n\n进一步，设 $Q$ 为能接受 $s_1,s_2,\\dots,s_n$ 的所有后缀的最小 DFA，请你输出 $Q$ 的点数。（如果你无法理解这句话，可以认为就是输出 $s_1,s_2,\\dots,s_n$ 建成的“广义后缀自动机”的点数）。", "inputFormat": "第一行一个正整数 $n$。\n\n以下 $n$ 行，每行一个字符串，第 $i$ 行表示字符串 $s_{i-1}$。", "outputFormat": "第一行一个正整数，为本质不同的子串个数。\n\n第二行一个正整数，为 $Q$ 的点数。", "hint": "数据范围：$1\\le n\\le 4\\cdot 10^5$，$1\\le \\sum{|s_i|}\\le 10^6$。\n\n样例 1 解释：共有 $10$ 个本质不同的子串，它们是：`\"a\",\"b\",\"c\",\"aa\",\"ab\",\"ac\",\"ba\",\"ca\",\"bac\",\"caa\"`。 DFA 结构略去。\n\n样例 2 解释：共有 $1$ 个本质不同的子串，它们是：`\"a\"`。DFA 包含一个起始结点 $S$ 和一个结点 $T$，有一条边 $S\\to T$，其上字符为 `a`。故总结点数为 $2$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】广义后缀自动机（广义 SAM）", "background": "管理员备注：本题于 2023 年 5 月 4 日加入输出点数的要求。本题在此之前提交的题解均没有输出点数，特此注明。", "description": "给定 $n$ 个由小写字母组成的字符串 $s_1,s_2\\ldots s_n$，求本质不同的子串个数。（不包含空串）\n\n进一步，设 $Q$ 为能接受 $s_1,s_2,\\dots,s_n$ 的所有后缀的最小 DFA，请你输出 $Q$ 的点数。（如果你无法理解这句话，可以认为就是输出 $s_1,s_2,\\dots,s_n$ 建成的“广义后缀自动机”的点数）。", "inputFormat": "第一行一个正整数 $n$。\n\n以下 $n$ 行，每行一个字符串，第 $i$ 行表示字符串 $s_{i-1}$。", "outputFormat": "第一行一个正整数，为本质不同的子串个数。\n\n第二行一个正整数，为 $Q$ 的点数。", "hint": "数据范围：$1\\le n\\le 4\\cdot 10^5$，$1\\le \\sum{|s_i|}\\le 10^6$。\n\n样例 1 解释：共有 $10$ 个本质不同的子串，它们是：`\"a\",\"b\",\"c\",\"aa\",\"ab\",\"ac\",\"ba\",\"ca\",\"bac\",\"caa\"`。 DFA 结构略去。\n\n样例 2 解释：共有 $1$ 个本质不同的子串，它们是：`\"a\"`。DFA 包含一个起始结点 $S$ 和一个结点 $T$，有一条边 $S\\to T$，其上字符为 `a`。故总结点数为 $2$。\n", "locale": "zh-CN"}}}
{"pid": "P6140", "type": "P", "difficulty": 3, "samples": [["6\nA\nC\nD\nB\nC\nB", "ABCBCD"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07NOV] Best Cow Line S", "background": "*本题和 [2007 年 12 月月赛金组同名题目](/problem/P2870) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 打算带领 $N$（$1 \\leq N \\leq 2\\,000$）头奶牛参加一年一度的”全美农场主大奖赛“。在这场比赛中，每个参赛者必须让他的奶牛排成一列，然后带领这些奶牛从裁判面前依此走过。\n\n今年，竞赛委员会在接受报名时，采用了一种新的登记规则：取每头奶牛名字的首字母，按照它们在队伍中的次序排成一列。将所有队伍的名字按字典序升序排序，从而得到出场顺序。\n\nFJ 由于事务繁忙，他希望能够尽早出场。因此他决定重排队列。\n\n他的调整方式是这样的：每次，他从原队列的首端或尾端牵出一头奶牛，将她安排到新队列尾部。重复这一操作直到所有奶牛都插入新队列为止。\n\n现在请你帮 FJ 算出按照上面这种方法能排出的字典序最小的队列。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行每行一个大写字母，表示初始队列。", "outputFormat": "输出一个长度为 $N$ 的字符串，表示可能的最小字典序队列。\n\n每输出 $80$ 个字母需要一个换行。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07NOV] Best Cow Line S", "background": "*本题和 [2007 年 12 月月赛金组同名题目](/problem/P2870) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 打算带领 $N$（$1 \\leq N \\leq 2\\,000$）头奶牛参加一年一度的”全美农场主大奖赛“。在这场比赛中，每个参赛者必须让他的奶牛排成一列，然后带领这些奶牛从裁判面前依此走过。\n\n今年，竞赛委员会在接受报名时，采用了一种新的登记规则：取每头奶牛名字的首字母，按照它们在队伍中的次序排成一列。将所有队伍的名字按字典序升序排序，从而得到出场顺序。\n\nFJ 由于事务繁忙，他希望能够尽早出场。因此他决定重排队列。\n\n他的调整方式是这样的：每次，他从原队列的首端或尾端牵出一头奶牛，将她安排到新队列尾部。重复这一操作直到所有奶牛都插入新队列为止。\n\n现在请你帮 FJ 算出按照上面这种方法能排出的字典序最小的队列。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行每行一个大写字母，表示初始队列。", "outputFormat": "输出一个长度为 $N$ 的字符串，表示可能的最小字典序队列。\n\n每输出 $80$ 个字母需要一个换行。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6141", "type": "P", "difficulty": 5, "samples": [["5 5\n2 4 6 8 10\n0 1 2\n1 4 3\n2 4 2\n1 1 9\n0 4 7", "0\n2\n0\n4\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "各省省选", "江苏"], "title": "[JSOI2013] 贪心的导游", "background": "", "description": "南京有一条著名的购物街。购物街嘛，就是一排整齐的商店啦~\n\n导游小 Z 每次都会把游客团带到购物街里走一段，然后选择一个商店进去购物。\n\n小 Z 接待的游客都是购物狂，他们恨不得将店内的商品洗劫一空，也就是说，只要他们能买，就一定会继续买（钱够不够你不用考虑，他们都有信用卡可以透支）。\n\n但是有一点，他们都非常讲究平等、很谦虚，每个人都不能忍受比别人多买什么东西或者少买什么东西，于是他们每个人最后买的商品数量都是一样的。这虽然导致他们没办法每次都把商店搬空，但是每次已经给店家带来一大笔生意了，店家已经非常感谢了！为了表示感谢，店家决定把游客们买完之后剩下来那几件没卖掉的商品就送给导游小 Z 了。\n\n贪心的小 Z 自然希望自己能获赠的商品数量越大越好啦~\n\n现在告诉你这一排共 $n$ 个商店（标号为 $0$ 到 $n-1$）每个商店里的商品总数，每次小 Z 会带一批共 $p$ 个游客的旅游团，到其中 $u$ 号商店和 $v$ 号商店之间逛一逛，请你帮小 Z 在所逛的商店区间内选择一个，告诉小 Z 他最多能获赠多少件商品。", "inputFormat": "第一行，包含两个整数 $n,m$，分别表示商店个数和小 Z 带来的旅游团个数。\n\n接下来一行，包含 $n$ 个整数 $a_i$，表示第 $i$ 个商店的商品总数。\n\n接下来 $m$ 行，每行三个整数 $u,v,p$，表示这个旅游团逛 $u$ 号商店和 $v$ 号商店之间的商店（包含 $u$ 和 $v$），且这个旅游团的人数为 $p$。", "outputFormat": "共输出 $m$ 行，每行一个整数，第 $i$ 行输出第 $i$ 个旅游团购物后，小 Z 最多能获赠的商品数量。", "hint": "### 样例解释\n\n第一个旅游团， $2$ 个人， $0$ 号商店到 $1$ 号商店的区间。若去 $1$ 号商店，共 $2$ 件商品，每人买 $1$ 件，剩 $0$ 件。若去 $2$ 号商店，共 $4$ 件商品，每人买 $2$ 件，剩 $0$ 件。所以，小 Z 最多获赠 $0$ 件。\n\n第二个旅游团， $3$ 个人，小 Z 选择带他们去 $4$ 号商店，共 $8$ 件商品，每人买 $2$ 件商品（因为每人 $3$ 件不够），剩下 $2$ 件，小 Z 最多获赠就是 $2$ 件。 可以验证去其它商店小 Z 最多获赠的商品不会达到 $2$ 件。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1 \\leq n\\leq 10^6,1 \\leq m\\leq 5\\times 10^4,0\\leq a_i\\leq 10^3,2\\leq p\\leq 10^3,0\\leq u,v\\leq n-1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2013] 贪心的导游", "background": "", "description": "南京有一条著名的购物街。购物街嘛，就是一排整齐的商店啦~\n\n导游小 Z 每次都会把游客团带到购物街里走一段，然后选择一个商店进去购物。\n\n小 Z 接待的游客都是购物狂，他们恨不得将店内的商品洗劫一空，也就是说，只要他们能买，就一定会继续买（钱够不够你不用考虑，他们都有信用卡可以透支）。\n\n但是有一点，他们都非常讲究平等、很谦虚，每个人都不能忍受比别人多买什么东西或者少买什么东西，于是他们每个人最后买的商品数量都是一样的。这虽然导致他们没办法每次都把商店搬空，但是每次已经给店家带来一大笔生意了，店家已经非常感谢了！为了表示感谢，店家决定把游客们买完之后剩下来那几件没卖掉的商品就送给导游小 Z 了。\n\n贪心的小 Z 自然希望自己能获赠的商品数量越大越好啦~\n\n现在告诉你这一排共 $n$ 个商店（标号为 $0$ 到 $n-1$）每个商店里的商品总数，每次小 Z 会带一批共 $p$ 个游客的旅游团，到其中 $u$ 号商店和 $v$ 号商店之间逛一逛，请你帮小 Z 在所逛的商店区间内选择一个，告诉小 Z 他最多能获赠多少件商品。", "inputFormat": "第一行，包含两个整数 $n,m$，分别表示商店个数和小 Z 带来的旅游团个数。\n\n接下来一行，包含 $n$ 个整数 $a_i$，表示第 $i$ 个商店的商品总数。\n\n接下来 $m$ 行，每行三个整数 $u,v,p$，表示这个旅游团逛 $u$ 号商店和 $v$ 号商店之间的商店（包含 $u$ 和 $v$），且这个旅游团的人数为 $p$。", "outputFormat": "共输出 $m$ 行，每行一个整数，第 $i$ 行输出第 $i$ 个旅游团购物后，小 Z 最多能获赠的商品数量。", "hint": "### 样例解释\n\n第一个旅游团， $2$ 个人， $0$ 号商店到 $1$ 号商店的区间。若去 $1$ 号商店，共 $2$ 件商品，每人买 $1$ 件，剩 $0$ 件。若去 $2$ 号商店，共 $4$ 件商品，每人买 $2$ 件，剩 $0$ 件。所以，小 Z 最多获赠 $0$ 件。\n\n第二个旅游团， $3$ 个人，小 Z 选择带他们去 $4$ 号商店，共 $8$ 件商品，每人买 $2$ 件商品（因为每人 $3$ 件不够），剩下 $2$ 件，小 Z 最多获赠就是 $2$ 件。 可以验证去其它商店小 Z 最多获赠的商品不会达到 $2$ 件。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1 \\leq n\\leq 10^6,1 \\leq m\\leq 5\\times 10^4,0\\leq a_i\\leq 10^3,2\\leq p\\leq 10^3,0\\leq u,v\\leq n-1$。", "locale": "zh-CN"}}}
{"pid": "P6142", "type": "P", "difficulty": 5, "samples": [["8\n1 2\n1 3\n1 4\n4 5\n1 6\n6 7\n7 8", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2020", "二分", "USACO"], "title": "[USACO20FEB] Delegation P", "background": null, "description": "Farmer John 有 $N$ 个牧场，这些牧场通过 $N-1$ 条道路连接，形成了一个树形结构。\n\n但在 28 年的经营后（译者注：USACO 创办于 1992 年），FJ 觉得处理树上问题非常辣手，他认为一条链上的问题更加简单。\n\n因此他决定将整棵树划分为若干条链，将每一条链的管理权授予一位工人。他不关心链的数量，却关心链的长度，他希望划分的链都尽可能长，从而不会有人用效率低下的算法蒙混过关。\n\nFJ 现在想知道最大的正整数 $K$，使得整棵树被划分成若干条链，且每条链的长度都**至少**是 $K$。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 的道路。", "outputFormat": "输出 $K$。", "hint": "### 样例解释\n\n一种划分方案如下：\n\n$$\n2-1-6-7-8, 3-1-4-5\n$$\n\n### 子任务\n\n- 测试点 $2 \\sim 4$ 满足**最多**有一个点的度数大于 $2$。\n- 测试点 $5 \\sim 8$ 满足 $N \\leq 10^3$。\n- 测试点 $9 \\sim 15$ 没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Delegation P", "background": null, "description": "Farmer John 有 $N$ 个牧场，这些牧场通过 $N-1$ 条道路连接，形成了一个树形结构。\n\n但在 28 年的经营后（译者注：USACO 创办于 1992 年），FJ 觉得处理树上问题非常辣手，他认为一条链上的问题更加简单。\n\n因此他决定将整棵树划分为若干条链，将每一条链的管理权授予一位工人。他不关心链的数量，却关心链的长度，他希望划分的链都尽可能长，从而不会有人用效率低下的算法蒙混过关。\n\nFJ 现在想知道最大的正整数 $K$，使得整棵树被划分成若干条链，且每条链的长度都**至少**是 $K$。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 的道路。", "outputFormat": "输出 $K$。", "hint": "### 样例解释\n\n一种划分方案如下：\n\n$$\n2-1-6-7-8, 3-1-4-5\n$$\n\n### 子任务\n\n- 测试点 $2 \\sim 4$ 满足**最多**有一个点的度数大于 $2$。\n- 测试点 $5 \\sim 8$ 满足 $N \\leq 10^3$。\n- 测试点 $9 \\sim 15$ 没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6143", "type": "P", "difficulty": 5, "samples": [["3\n*..\n.*.\n*..", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2020", "USACO", "枚举", "平面几何"], "title": "[USACO20FEB] Equilateral Triangles P", "background": "", "description": "Farmer John 的农场可以用一个 $N \\times N$ 的方阵（$1 \\leq N \\leq 300$）。对于方阵内的每个格子，如果这个格子有奶牛，就用 `*` 表示，否则用 `.` 表示。\n\nFJ 相信他的牧场的美丽程度正比于两两距离相等的奶牛三元组的数量。也就是说，她们组成一个等边三角形。不幸的是，直到最近 FJ 才发现，由于他的奶牛都处在整数坐标位置，如果使用欧几里得距离进行计算，不可能存在美丽的奶牛三元组！于是，FJ 决定改用“曼哈顿”距离。形式化地说，两点 $(x_0,y_0)$ 和 $(x_1,y_1)$ 的曼哈顿距离等于 $|x_0-x_1|+|y_0-y_1|$。\n\n给定表示奶牛位置的方阵，计算等边三角形的数量。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个长度为 $N$ 的字符串，第 $i$ 行的第 $j$ 个字符表示位置 $(i,j)$ 上是否有奶牛。", "outputFormat": "输出一个整数，为所求的答案。可以证明答案可以用 32 位有符号整数型存储。", "hint": "### 样例解释\n\n有三头奶牛，并且她们组成了一个等边三角形，因为每对奶牛之间的曼哈顿距离都等于二。\n\n### 子任务\n\n- 对于测试点 $T$（$T \\in [2,11]$），满足 $N=25T$；\n- 对于测试点 $T$（$T \\in [12,15]$），满足 $N=300$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Equilateral Triangles P", "background": "", "description": "Farmer John 的农场可以用一个 $N \\times N$ 的方阵（$1 \\leq N \\leq 300$）。对于方阵内的每个格子，如果这个格子有奶牛，就用 `*` 表示，否则用 `.` 表示。\n\nFJ 相信他的牧场的美丽程度正比于两两距离相等的奶牛三元组的数量。也就是说，她们组成一个等边三角形。不幸的是，直到最近 FJ 才发现，由于他的奶牛都处在整数坐标位置，如果使用欧几里得距离进行计算，不可能存在美丽的奶牛三元组！于是，FJ 决定改用“曼哈顿”距离。形式化地说，两点 $(x_0,y_0)$ 和 $(x_1,y_1)$ 的曼哈顿距离等于 $|x_0-x_1|+|y_0-y_1|$。\n\n给定表示奶牛位置的方阵，计算等边三角形的数量。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个长度为 $N$ 的字符串，第 $i$ 行的第 $j$ 个字符表示位置 $(i,j)$ 上是否有奶牛。", "outputFormat": "输出一个整数，为所求的答案。可以证明答案可以用 32 位有符号整数型存储。", "hint": "### 样例解释\n\n有三头奶牛，并且她们组成了一个等边三角形，因为每对奶牛之间的曼哈顿距离都等于二。\n\n### 子任务\n\n- 对于测试点 $T$（$T \\in [2,11]$），满足 $N=25T$；\n- 对于测试点 $T$（$T \\in [12,15]$），满足 $N=300$。", "locale": "zh-CN"}}}
{"pid": "P6144", "type": "P", "difficulty": 6, "samples": [["3 2\n1 6\n2 3\n4 5", "10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2020", "线段树", "USACO", "Stirling 数"], "title": "[USACO20FEB] Help Yourself P", "background": "", "description": "在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。\n\n定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。\n\n定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目的 $K$ 次方。\n\n现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。\n\n你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！", "inputFormat": "第一行两个整数 $N$，$K$（$1 \\leq N \\leq 10^5$。$2 \\leq K \\leq 10$）。\n\n接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \\leq l_i \\lt r_i \\leq 2N$，且任意两个端点都不在同一位置上。", "outputFormat": "输出所求答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n所有非空子集的复杂度如下所示（显然空集的复杂度为零）：\n\n$$\n\\{[1,6]\\} \\implies 1, \\{[2,3]\\} \\implies 1, \\{[4,5]\\} \\implies 1\n$$\n\n$$\n\\{[1,6],[2,3]\\} \\implies 1, \\{[1,6],[4,5]\\} \\implies 1, \\{[2,3],[4,5]\\} \\implies 4\n$$\n\n$$\n\\{[1,6],[2,3],[4,5]\\} \\implies 1\n$$\n\n故答案为 $1+1+1+1+1+4+1=10$。\n\n### 子任务\n\n- 测试点 $2$ 满足 $N \\leq 16$；\n- 测试点 $3 \\sim 5$ 满足 $N \\leq 10^3$，且 $K=2$；\n- 测试点 $6 \\sim 8$ 满足 $N \\leq 10^3$；\n- 对于测试点 $T$（$T \\in [9,16]$），满足 $K=3+(T-9)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Help Yourself P", "background": "", "description": "在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。\n\n定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。\n\n定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目的 $K$ 次方。\n\n现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。\n\n你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！", "inputFormat": "第一行两个整数 $N$，$K$（$1 \\leq N \\leq 10^5$。$2 \\leq K \\leq 10$）。\n\n接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \\leq l_i \\lt r_i \\leq 2N$，且任意两个端点都不在同一位置上。", "outputFormat": "输出所求答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n所有非空子集的复杂度如下所示（显然空集的复杂度为零）：\n\n$$\n\\{[1,6]\\} \\implies 1, \\{[2,3]\\} \\implies 1, \\{[4,5]\\} \\implies 1\n$$\n\n$$\n\\{[1,6],[2,3]\\} \\implies 1, \\{[1,6],[4,5]\\} \\implies 1, \\{[2,3],[4,5]\\} \\implies 4\n$$\n\n$$\n\\{[1,6],[2,3],[4,5]\\} \\implies 1\n$$\n\n故答案为 $1+1+1+1+1+4+1=10$。\n\n### 子任务\n\n- 测试点 $2$ 满足 $N \\leq 16$；\n- 测试点 $3 \\sim 5$ 满足 $N \\leq 10^3$，且 $K=2$；\n- 测试点 $6 \\sim 8$ 满足 $N \\leq 10^3$；\n- 对于测试点 $T$（$T \\in [9,16]$），满足 $K=3+(T-9)$。", "locale": "zh-CN"}}}
{"pid": "P6145", "type": "P", "difficulty": 3, "samples": [["4 10 3\n1 2 3 4\n1 2 5\n2 4 2\n3 4 4", "1\n6\n3\n8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["图论", "2020", "USACO", "拓扑排序", "差分约束"], "title": "[USACO20FEB] Timeline G", "background": "", "description": "Bessie 在过去的 $M$ 天内参加了 $N$ 次挤奶。但她已经忘了她每次挤奶是在哪个时候了。\n\n对于第 $i$ 次挤奶，Bessie 记得它不早于第 $S_i$ 天进行。另外，她还有 $C$ 条记忆，每条记忆形如一个三元组 $(a,b,x)$，含义是第 $b$ 次挤奶在第 $a$ 次挤奶结束至少 $x$ 天后进行。\n\n现在请你帮 Bessie 算出在满足所有条件的前提下，每次挤奶的最早日期。\n\n保证 Bessie 的记忆没有错误，这意味着一定存在一种合法的方案，使得：\n\n- 第 $i$ 次挤奶不早于第 $S_i$ 天进行，且不晚于第 $M$ 天进行；\n- 所有的记忆都得到满足；", "inputFormat": "第一行三个整数 $N,M,C$。保证 $1 \\leq N,C \\leq 10^5$，$2 \\leq M \\leq 10^9$。\n\n接下来一行包含 $N$ 个整数 $S_1, S_2 , \\ldots, S_n$，保证 $\\forall 1 \\leq i \\leq n$，都满足 $1 \\leq S_i \\leq M$。\n\n下面 $C$ 行每行三个整数 $a,b,x$，描述一条记忆。保证 $a \\neq b$，且 $1 \\leq x \\leq M$。", "outputFormat": "输出 $N$ 行，每行一个整数，第 $i$ 行的数表示第 $i$ 次挤奶的最早日期。", "hint": "- 测试点 $2 \\sim 4$ 满足 $N,C \\leq 10^3$。\n- 测试点 $5 \\sim 10$ 没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Timeline G", "background": "", "description": "Bessie 在过去的 $M$ 天内参加了 $N$ 次挤奶。但她已经忘了她每次挤奶是在哪个时候了。\n\n对于第 $i$ 次挤奶，Bessie 记得它不早于第 $S_i$ 天进行。另外，她还有 $C$ 条记忆，每条记忆形如一个三元组 $(a,b,x)$，含义是第 $b$ 次挤奶在第 $a$ 次挤奶结束至少 $x$ 天后进行。\n\n现在请你帮 Bessie 算出在满足所有条件的前提下，每次挤奶的最早日期。\n\n保证 Bessie 的记忆没有错误，这意味着一定存在一种合法的方案，使得：\n\n- 第 $i$ 次挤奶不早于第 $S_i$ 天进行，且不晚于第 $M$ 天进行；\n- 所有的记忆都得到满足；", "inputFormat": "第一行三个整数 $N,M,C$。保证 $1 \\leq N,C \\leq 10^5$，$2 \\leq M \\leq 10^9$。\n\n接下来一行包含 $N$ 个整数 $S_1, S_2 , \\ldots, S_n$，保证 $\\forall 1 \\leq i \\leq n$，都满足 $1 \\leq S_i \\leq M$。\n\n下面 $C$ 行每行三个整数 $a,b,x$，描述一条记忆。保证 $a \\neq b$，且 $1 \\leq x \\leq M$。", "outputFormat": "输出 $N$ 行，每行一个整数，第 $i$ 行的数表示第 $i$ 次挤奶的最早日期。", "hint": "- 测试点 $2 \\sim 4$ 满足 $N,C \\leq 10^3$。\n- 测试点 $5 \\sim 10$ 没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6146", "type": "P", "difficulty": 4, "samples": [["3\n1 6\n2 3\n4 5", "8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["递推", "2020", "二分", "USACO", "排序", "组合数学", "前缀和"], "title": "[USACO20FEB] Help Yourself G", "background": "", "description": "在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。\n\n定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。\n\n定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目。\n\n现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。\n\n你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \\leq l_i \\lt r_i \\leq 2N$，且任意两个端点都不在同一位置上。", "outputFormat": "输出所求答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n所有非空子集的复杂度如下所示（显然空集的复杂度为零）：\n$$\n\\{[1,6]\\} \\implies 1, \\{[2,3]\\} \\implies 1, \\{[4,5]\\} \\implies 1\n$$\n\n$$\n\\{[1,6],[2,3]\\} \\implies 1, \\{[1,6],[4,5]\\} \\implies 1, \\{[2,3],[4,5]\\} \\implies 2\n$$\n\n$$\n\\{[1,6],[2,3],[4,5]\\} \\implies 1\n$$\n\n故答案为 $1+1+1+1+1+2+1=8$。\n\n### 子任务\n\n- 测试点 $2 \\sim 3$ 满足 $N \\leq 16$；\n- 测试点 $4 \\sim 7$ 满足 $N \\leq 1000$；\n- 测试点 $8 \\sim 12$ 没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Help Yourself G", "background": "", "description": "在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。\n\n定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。\n\n定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目。\n\n现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。\n\n你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \\leq l_i \\lt r_i \\leq 2N$，且任意两个端点都不在同一位置上。", "outputFormat": "输出所求答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n所有非空子集的复杂度如下所示（显然空集的复杂度为零）：\n$$\n\\{[1,6]\\} \\implies 1, \\{[2,3]\\} \\implies 1, \\{[4,5]\\} \\implies 1\n$$\n\n$$\n\\{[1,6],[2,3]\\} \\implies 1, \\{[1,6],[4,5]\\} \\implies 1, \\{[2,3],[4,5]\\} \\implies 2\n$$\n\n$$\n\\{[1,6],[2,3],[4,5]\\} \\implies 1\n$$\n\n故答案为 $1+1+1+1+1+2+1=8$。\n\n### 子任务\n\n- 测试点 $2 \\sim 3$ 满足 $N \\leq 16$；\n- 测试点 $4 \\sim 7$ 满足 $N \\leq 1000$；\n- 测试点 $8 \\sim 12$ 没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6147", "type": "P", "difficulty": 5, "samples": [["13\n1 2\n2 3\n2 4\n4 5\n2 6\n6 7\n6 8\n8 9\n9 10\n8 11\n11 12\n12 13", "111000000000"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "USACO", "数论", "树的遍历"], "title": "[USACO20FEB] Delegation G", "background": "", "description": "Farmer John 有 $N$ 个牧场，这些牧场通过 $N-1$ 条道路连接，形成了一个树形结构。\n\n但在 28 年的经营后（译者注：USACO 创办于 1992 年），FJ 觉得处理树上问题非常辣手，他认为一条链上的问题更加简单。\n\n因此他决定将整棵树划分为若干条链，将每一条链的管理权授予一位工人。为了避免可能的争端，他希望所有链的长度均相同。\n\nFJ 现在想知道，对于每一个满足 $1 \\leq K \\leq N-1$ 的 $K$，是否存在一种划分方案，使得整棵树被划分成若干条链，且每条链的长度都**恰好**是 $K$。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 的道路。", "outputFormat": "输出一个长度 $N-1$ 的 0/1 串。第 $i$ 位的值为 $1$ 当且仅当存在一种划分方案，使得整棵树被划分成若干条链，且每条链的长度都恰好是 $i$，否则第 $i$ 位的值为 $0$。", "hint": "### 样例解释\n\n$K=1,2,3$ 时都存在一种合法的划分方案。\n\n$K=3$ 时的一种划分方案如下：\n\n$13-12-11-8, 10-9-8-6, 7-6-2-3, 5-4-2-1$\n\n### 子任务\n\n- 测试点 $2 \\sim 4$ 满足**最多**有一个点的度数大于 $2$。\n- 测试点 $5 \\sim 8$ 满足 $N \\leq 10^3$。\n- 测试点 $9 \\sim 15$ 没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Delegation G", "background": "", "description": "Farmer John 有 $N$ 个牧场，这些牧场通过 $N-1$ 条道路连接，形成了一个树形结构。\n\n但在 28 年的经营后（译者注：USACO 创办于 1992 年），FJ 觉得处理树上问题非常辣手，他认为一条链上的问题更加简单。\n\n因此他决定将整棵树划分为若干条链，将每一条链的管理权授予一位工人。为了避免可能的争端，他希望所有链的长度均相同。\n\nFJ 现在想知道，对于每一个满足 $1 \\leq K \\leq N-1$ 的 $K$，是否存在一种划分方案，使得整棵树被划分成若干条链，且每条链的长度都**恰好**是 $K$。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 的道路。", "outputFormat": "输出一个长度 $N-1$ 的 0/1 串。第 $i$ 位的值为 $1$ 当且仅当存在一种划分方案，使得整棵树被划分成若干条链，且每条链的长度都恰好是 $i$，否则第 $i$ 位的值为 $0$。", "hint": "### 样例解释\n\n$K=1,2,3$ 时都存在一种合法的划分方案。\n\n$K=3$ 时的一种划分方案如下：\n\n$13-12-11-8, 10-9-8-6, 7-6-2-3, 5-4-2-1$\n\n### 子任务\n\n- 测试点 $2 \\sim 4$ 满足**最多**有一个点的度数大于 $2$。\n- 测试点 $5 \\sim 8$ 满足 $N \\leq 10^3$。\n- 测试点 $9 \\sim 15$ 没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6148", "type": "P", "difficulty": 4, "samples": [["7 2 2\n2 5\n3 7", "1\n2\n4\n3\n5\n7\n6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2020", "倍增", "USACO"], "title": "[USACO20FEB] Swapity Swapity Swap S", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$1\\leq N\\leq 10^5$）站成一排。对于每一个 $1\\leq i\\leq N$，从左往右数第 $i$ 头奶牛的编号为 $i$。\n\nFarmer John 想到了一个新的奶牛晨练方案。他给奶牛们 $M$ 对整数 $(L_1,R_1)\\ldots (L_M,R_M)$，其中 $1\\leq M\\leq 100$。他让她们重复以下包含 $M$ 个步骤的过程 $K$（$1\\leq K\\leq 10^9$）次：\n\n对于从 $1$ 到 $M$ 的每一个 $i$：\n- 当前从左往右数在位置 $L_i\\ldots R_i$ 的奶牛序列反转她们的顺序。\n- 当奶牛们重复这一过程 $K$ 次后，请对每一个 $1\\leq i\\leq N$ 输出从左往右数第 $i$ 头奶牛的编号。", "inputFormat": "输入的第一行包含 $N$，$M$ 和 $K$。对于每一个 $1\\leq i\\leq M$，第 $i+1$ 行包含 $L_i$ 和 $R_i$，均为范围在 $1\\ldots N$ 内的整数，其中 $L_i<R_i$。", "outputFormat": "在第 $i$ 行输出指令序列执行了 $K$ 次后奶牛序列中从左往右数第 $i$ 个元素的编号。", "hint": "#### 样例解释：\n初始时，奶牛们的顺序从左往右为 [$1,2,3,4,5,6,7$]。在这一过程的第一步过后，顺序变为 [$1,5,4,3,2,6,7$]。在这一过程的第二步过后，顺序变为 [$1,5,7,6,2,3,4$]。再重复这两个步骤各一次可以得到样例的输出。\n\n#### 子任务：\n- 测试点 $2$ 满足 $N=K=100$。\n- 测试点 $3$-$5$ 满足 $K\\leq 10^3$。\n- 测试点 $6$-$10$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Swapity Swapity Swap S", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$1\\leq N\\leq 10^5$）站成一排。对于每一个 $1\\leq i\\leq N$，从左往右数第 $i$ 头奶牛的编号为 $i$。\n\nFarmer John 想到了一个新的奶牛晨练方案。他给奶牛们 $M$ 对整数 $(L_1,R_1)\\ldots (L_M,R_M)$，其中 $1\\leq M\\leq 100$。他让她们重复以下包含 $M$ 个步骤的过程 $K$（$1\\leq K\\leq 10^9$）次：\n\n对于从 $1$ 到 $M$ 的每一个 $i$：\n- 当前从左往右数在位置 $L_i\\ldots R_i$ 的奶牛序列反转她们的顺序。\n- 当奶牛们重复这一过程 $K$ 次后，请对每一个 $1\\leq i\\leq N$ 输出从左往右数第 $i$ 头奶牛的编号。", "inputFormat": "输入的第一行包含 $N$，$M$ 和 $K$。对于每一个 $1\\leq i\\leq M$，第 $i+1$ 行包含 $L_i$ 和 $R_i$，均为范围在 $1\\ldots N$ 内的整数，其中 $L_i<R_i$。", "outputFormat": "在第 $i$ 行输出指令序列执行了 $K$ 次后奶牛序列中从左往右数第 $i$ 个元素的编号。", "hint": "#### 样例解释：\n初始时，奶牛们的顺序从左往右为 [$1,2,3,4,5,6,7$]。在这一过程的第一步过后，顺序变为 [$1,5,4,3,2,6,7$]。在这一过程的第二步过后，顺序变为 [$1,5,7,6,2,3,4$]。再重复这两个步骤各一次可以得到样例的输出。\n\n#### 子任务：\n- 测试点 $2$ 满足 $N=K=100$。\n- 测试点 $3$-$5$ 满足 $K\\leq 10^3$。\n- 测试点 $6$-$10$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6149", "type": "P", "difficulty": 4, "samples": [["4\n0 0\n0 1\n1 0\n1 2", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2020", "USACO", "排序"], "title": "[USACO20FEB] Triangles S", "background": "", "description": "Farmer John 想要给他的奶牛们建造一个三角形牧场。\n\n有 $N$（$3\\leq N\\leq 10^5$）个栅栏柱子分别位于农场的二维平面上不同的点 $(X_1,Y_1)\\ldots (X_N,Y_N)$。他可以选择其中三个点组成三角形牧场，只要三角形有一条边与 $x$ 轴平行，且有另一条边与 $y$ 轴平行。\n\nFJ 可以组成的所有可能的牧场的面积之和等于多少？", "inputFormat": "第一行包含 $N$。\n\n以下 $N$ 行每行包含两个整数 $X_i$ 和 $Y_i$，均在范围 $−10^4\\ldots 10^4$ 之内，描述一个栅栏柱子的位置。", "outputFormat": "由于面积之和不一定为整数且可能非常大，输出面积之和的**两倍**模 $10^9+7$ 的余数。", "hint": "#### 样例解释：\n栅栏木桩 ($0,0$)、($1,0$) 和 ($1,2$) 组成了一个面积为 $1$ 的三角形，($0,0$)、($1,0$) 和 ($0,1$) 组成了一个面积为 $0.5$ 的三角形。所以答案为 $2\\times (1+0.5)=3$。\n\n#### 子任务：\n- 测试点 $2$ 满足 $N=200$。\n- 测试点 $3$-$4$ 满足 $N\\leq 5000$。\n- 测试点 $5$-$10$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Triangles S", "background": "", "description": "Farmer John 想要给他的奶牛们建造一个三角形牧场。\n\n有 $N$（$3\\leq N\\leq 10^5$）个栅栏柱子分别位于农场的二维平面上不同的点 $(X_1,Y_1)\\ldots (X_N,Y_N)$。他可以选择其中三个点组成三角形牧场，只要三角形有一条边与 $x$ 轴平行，且有另一条边与 $y$ 轴平行。\n\nFJ 可以组成的所有可能的牧场的面积之和等于多少？", "inputFormat": "第一行包含 $N$。\n\n以下 $N$ 行每行包含两个整数 $X_i$ 和 $Y_i$，均在范围 $−10^4\\ldots 10^4$ 之内，描述一个栅栏柱子的位置。", "outputFormat": "由于面积之和不一定为整数且可能非常大，输出面积之和的**两倍**模 $10^9+7$ 的余数。", "hint": "#### 样例解释：\n栅栏木桩 ($0,0$)、($1,0$) 和 ($1,2$) 组成了一个面积为 $1$ 的三角形，($0,0$)、($1,0$) 和 ($0,1$) 组成了一个面积为 $0.5$ 的三角形。所以答案为 $2\\times (1+0.5)=3$。\n\n#### 子任务：\n- 测试点 $2$ 满足 $N=200$。\n- 测试点 $3$-$4$ 满足 $N\\leq 5000$。\n- 测试点 $5$-$10$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6150", "type": "P", "difficulty": 4, "samples": [["4\n11 10 11 11\n1 2\n2 3\n2 4", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["搜索", "2020", "USACO", "深度优先搜索 DFS", "图遍历"], "title": "[USACO20FEB] Clock Tree S", "background": "", "description": "Farmer John 的新牛棚的设计十分奇怪：它由编号为 $1\\ldots N$ 的 $N$ 间房间（$2\\leq N\\leq 2\\,500$），以及 $N−1$ 条走廊组成。每条走廊连接两间房间，使得每间房间都可以沿着一些走廊到达任意其他房间。\n\n牛棚里的每间房间都装有一个在表盘上印有标准的整数 $1\\ldots 12$ 的圆形时钟。然而，这些时钟只有一根指针，并且总是直接指向表盘上的某个数字（它从不指向两个数字之间）。\n\n奶牛 Bessie 想要同步牛棚中的所有时钟，使它们都指向整数 $12$。然而，她头脑稍有些简单，当她在牛棚里行走的时候，每次她进入一间房间，她将房间里的时钟的指针向后拨动一个位置。例如，如果原来时钟指向 $5$，现在它会指向 $6$，如果原来时钟指向 $12$，现在它会指向 $1$。如果 Bessie 进入同一间房间多次，她每次进入都会拨动这间房间的时钟。\n\n请求出 Bessie 可能的出发房间数量，使得她可以在牛棚中走动并使所有时钟指向 $12$。注意 Bessie 并不拨动她出发房间的时钟，但任意时刻她再次进入的时候会拨动它。时钟不会自己走动；时钟只会在 Bessie 进入时被拨动。此外，Bessie 一旦进入了一条走廊，她必须到达走廊的另一端（不允许走到一半折回原来的房间）。", "inputFormat": "输入的第一行包含 $N$。下一行包含 $N$ 个整数，均在范围 $1\\ldots 12$ 之内，表示每间房间初始时的时钟设置。以下 $N−1$ 行每行用两个整数 $a$ 和 $b$ 描述了一条走廊，两数均在范围 $1\\ldots N$ 之内，为该走廊连接的两间房间的编号。", "outputFormat": "输出出发房间的数量，使得 Bessie 有可能使所有时钟指向 $12$。", "hint": "#### 样例解释：\n在这个例子中，当且仅当 Bessie 从房间 $2$ 出发时她可以使所有房间的时钟指向 $12$（比如，移动到房间 $1$，$2$，$3$，$2$，最后到 $4$）。\n\n#### 子任务：\n- 测试点 $2$-$7$ 满足 $N\\leq 100$。\n- 测试点 $8$-$15$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Clock Tree S", "background": "", "description": "Farmer John 的新牛棚的设计十分奇怪：它由编号为 $1\\ldots N$ 的 $N$ 间房间（$2\\leq N\\leq 2\\,500$），以及 $N−1$ 条走廊组成。每条走廊连接两间房间，使得每间房间都可以沿着一些走廊到达任意其他房间。\n\n牛棚里的每间房间都装有一个在表盘上印有标准的整数 $1\\ldots 12$ 的圆形时钟。然而，这些时钟只有一根指针，并且总是直接指向表盘上的某个数字（它从不指向两个数字之间）。\n\n奶牛 Bessie 想要同步牛棚中的所有时钟，使它们都指向整数 $12$。然而，她头脑稍有些简单，当她在牛棚里行走的时候，每次她进入一间房间，她将房间里的时钟的指针向后拨动一个位置。例如，如果原来时钟指向 $5$，现在它会指向 $6$，如果原来时钟指向 $12$，现在它会指向 $1$。如果 Bessie 进入同一间房间多次，她每次进入都会拨动这间房间的时钟。\n\n请求出 Bessie 可能的出发房间数量，使得她可以在牛棚中走动并使所有时钟指向 $12$。注意 Bessie 并不拨动她出发房间的时钟，但任意时刻她再次进入的时候会拨动它。时钟不会自己走动；时钟只会在 Bessie 进入时被拨动。此外，Bessie 一旦进入了一条走廊，她必须到达走廊的另一端（不允许走到一半折回原来的房间）。", "inputFormat": "输入的第一行包含 $N$。下一行包含 $N$ 个整数，均在范围 $1\\ldots 12$ 之内，表示每间房间初始时的时钟设置。以下 $N−1$ 行每行用两个整数 $a$ 和 $b$ 描述了一条走廊，两数均在范围 $1\\ldots N$ 之内，为该走廊连接的两间房间的编号。", "outputFormat": "输出出发房间的数量，使得 Bessie 有可能使所有时钟指向 $12$。", "hint": "#### 样例解释：\n在这个例子中，当且仅当 Bessie 从房间 $2$ 出发时她可以使所有房间的时钟指向 $12$（比如，移动到房间 $1$，$2$，$3$，$2$，最后到 $4$）。\n\n#### 子任务：\n- 测试点 $2$-$7$ 满足 $N\\leq 100$。\n- 测试点 $8$-$15$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6151", "type": "P", "difficulty": 7, "samples": [["2\n2 2", "18"], ["6\n7 8 9 10 11 12", "515320459"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "容斥原理", "快速傅里叶变换 FFT"], "title": "[集训队作业2019] 青春猪头少年不会梦到兔女郎学姐", "background": "来源：2019 集训队作业 Round4", "description": "若干个正整数排成一个序列，其中数字 $i$ 的出现次数为 $c_i$，对于每一个这样的序列，定义他的权值如下：\n\n把这个序列首尾相接放在一个圆上，把这些数字分成若干相邻的段，使得每段都是在圆上相邻的数字，任意两段没有公共的元素，每一段中的数字都相同，相邻段中的数字不同，则这个序列的权值定义为所有段的长度之积。\n\n求所有的序列的权值和对 $998244353$ 取模。\n\n注：虽然计算序列的权值的时候是圆排列，但互为循环排列的不同序列仍然被认为是不同的，如 $(1,2,1,2)$ 和 $(2,1,2,1)$ 被认为是不同的序列。", "inputFormat": "若干行，第一行一个正整数 $n$ ，表示数字种类数。\n\n第二行 $n$ 个正整数 $c_i$，表示第 $i$ 个数字的出现次数。", "outputFormat": "一行，表示所有出现次数符合条件的序列的权值和对 $998244353$ 取模的值。", "hint": "样例解释 #1：\n\n合法序列为 $(1,1,2,2),(1,2,1,2),(1,2,2,1),(2,1,1,2),(2,1,2,1),(2,2,1,1)$。\n权值分别为 $4,1,4,4,1,4$，和为 $18$。\n\n$\\sum c_i \\le 2\\times 10^5$\n\n$2\\le n\\le 2\\times 10^5$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队作业2019] 青春猪头少年不会梦到兔女郎学姐", "background": "来源：2019 集训队作业 Round4", "description": "若干个正整数排成一个序列，其中数字 $i$ 的出现次数为 $c_i$，对于每一个这样的序列，定义他的权值如下：\n\n把这个序列首尾相接放在一个圆上，把这些数字分成若干相邻的段，使得每段都是在圆上相邻的数字，任意两段没有公共的元素，每一段中的数字都相同，相邻段中的数字不同，则这个序列的权值定义为所有段的长度之积。\n\n求所有的序列的权值和对 $998244353$ 取模。\n\n注：虽然计算序列的权值的时候是圆排列，但互为循环排列的不同序列仍然被认为是不同的，如 $(1,2,1,2)$ 和 $(2,1,2,1)$ 被认为是不同的序列。", "inputFormat": "若干行，第一行一个正整数 $n$ ，表示数字种类数。\n\n第二行 $n$ 个正整数 $c_i$，表示第 $i$ 个数字的出现次数。", "outputFormat": "一行，表示所有出现次数符合条件的序列的权值和对 $998244353$ 取模的值。", "hint": "样例解释 #1：\n\n合法序列为 $(1,1,2,2),(1,2,1,2),(1,2,2,1),(2,1,1,2),(2,1,2,1),(2,2,1,1)$。\n权值分别为 $4,1,4,4,1,4$，和为 $18$。\n\n$\\sum c_i \\le 2\\times 10^5$\n\n$2\\le n\\le 2\\times 10^5$", "locale": "zh-CN"}}}
{"pid": "P6152", "type": "P", "difficulty": 7, "samples": [["7 2\n2 1 3 1 3 1 4\n1 7\n4 5", "10\n2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2018", "后缀自动机 SAM", "O2优化"], "title": "[集训队作业2018] 后缀树节点数", "background": "来源：陈江伦 2018 候选队论文题", "description": "给定一个长度为 $n$ 的字符串 $P$，有 $m$ 次询问，每次给定两个参数 $l$ , $r$，询问子串 $P[l,r]$ 所构成的后缀树的结点数。\n\n如果你不了解后缀树，你也可以理解为对 $[l,r]$ 的反串建后缀自动机。\n\n注意在本题中，后缀树的根节点不计入答案。", "inputFormat": "本题中用数字来表示字符串，不同的数字代表不同的字符，相同的数字代表相同的字符，数字的范围在 $[0,n]$ 之间。\n\n第一行两个正整数 $n$ 和 $m$，表示字符串长度和询问个数。\n第二行 $n$ 个用空格隔开的非负整数，表示这个字符串。\n接下来 $m$ 行，每行两个正整数 $l,r$，表示询问子串 $[l,r]$ 的后缀树的结点数。", "outputFormat": "输出 $m$ 行，每行一个正整数表示答案。", "hint": "对于 $30\\%$ 的数据：$n,m\\le 3\\times 10^3$；\n\n对于 $100\\%$ 的数据满足：$n\\le 10^5$，$m\\le 3\\times 10^5$，字符串的每个数字 $\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队作业2018] 后缀树节点数", "background": "来源：陈江伦 2018 候选队论文题", "description": "给定一个长度为 $n$ 的字符串 $P$，有 $m$ 次询问，每次给定两个参数 $l$ , $r$，询问子串 $P[l,r]$ 所构成的后缀树的结点数。\n\n如果你不了解后缀树，你也可以理解为对 $[l,r]$ 的反串建后缀自动机。\n\n注意在本题中，后缀树的根节点不计入答案。", "inputFormat": "本题中用数字来表示字符串，不同的数字代表不同的字符，相同的数字代表相同的字符，数字的范围在 $[0,n]$ 之间。\n\n第一行两个正整数 $n$ 和 $m$，表示字符串长度和询问个数。\n第二行 $n$ 个用空格隔开的非负整数，表示这个字符串。\n接下来 $m$ 行，每行两个正整数 $l,r$，表示询问子串 $[l,r]$ 的后缀树的结点数。", "outputFormat": "输出 $m$ 行，每行一个正整数表示答案。", "hint": "对于 $30\\%$ 的数据：$n,m\\le 3\\times 10^3$；\n\n对于 $100\\%$ 的数据满足：$n\\le 10^5$，$m\\le 3\\times 10^5$，字符串的每个数字 $\\le n$。", "locale": "zh-CN"}}}
{"pid": "P6153", "type": "P", "difficulty": 1, "samples": [["11 8 \n1 2\n4 3\n5 4\n1 3\n5 6\n7 10\n5 10\n8 9", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2020"], "title": "询问", "background": " zbw 被邀请至幼儿园给小朋友们出题。", "description": "　现在 zbw 有 $n$ 个物品，编号从 $1 \\sim n$，他会告诉你 $m$ 个条件，每个条件包含两个数 $x,y$，表示第 $x$ 个物品和第 $y$ 个物品是相同的。\n\n 因为 zbw 特别赶时间，所以他保证**每次给出的条件都是有用的，也就是说，每次给出的条件无法由之前的条件推导得来。**\n\n你需要回答有多少**种**不同的物品。", "inputFormat": "　第一行两个整数 $n$,$m$。\n\n   之后 $m$ 行，每行两个数 $x,y$，表示第 $x$ 个物品和第 $y$ 个物品是相同的。", "outputFormat": "一个整数，不同物品的数量。", "hint": "对于 $20\\%$ 的数据，$n,m \\le 10$。\n\n对于 $40\\%$ 的数据，$n,m \\le 10^3$。\n\n对于 $60\\%$ 的数据，$n,m \\le 10^5$。\n\n对于 $80\\%$ 的数据，$m \\le 10^6$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^{18}$，$1 \\le m \\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "Queries", "background": "zbw was invited to a kindergarten to create problems for children.", "description": "Now zbw has $n$ items, numbered from $1 \\sim n$. He will tell you $m$ conditions. Each condition contains two numbers $x, y$, meaning that item $x$ and item $y$ are the same.\n\nBecause zbw is in a big hurry, he guarantees that **every condition he gives is useful; that is, each condition cannot be deduced from the previous conditions.**\n\nYou need to answer how many **different kinds** of items there are.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThen follow $m$ lines. Each line contains two numbers $x, y$, meaning that item $x$ and item $y$ are the same.", "outputFormat": "Output one integer: the number of different items.", "hint": "For $20\\%$ of the testdata, $n, m \\le 10$.\n\nFor $40\\%$ of the testdata, $n, m \\le 10^3$.\n\nFor $60\\%$ of the testdata, $n, m \\le 10^5$.\n\nFor $80\\%$ of the testdata, $m \\le 10^6$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^{18}$, $1 \\le m \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "询问", "background": " zbw 被邀请至幼儿园给小朋友们出题。", "description": "　现在 zbw 有 $n$ 个物品，编号从 $1 \\sim n$，他会告诉你 $m$ 个条件，每个条件包含两个数 $x,y$，表示第 $x$ 个物品和第 $y$ 个物品是相同的。\n\n 因为 zbw 特别赶时间，所以他保证**每次给出的条件都是有用的，也就是说，每次给出的条件无法由之前的条件推导得来。**\n\n你需要回答有多少**种**不同的物品。", "inputFormat": "　第一行两个整数 $n$,$m$。\n\n   之后 $m$ 行，每行两个数 $x,y$，表示第 $x$ 个物品和第 $y$ 个物品是相同的。", "outputFormat": "一个整数，不同物品的数量。", "hint": "对于 $20\\%$ 的数据，$n,m \\le 10$。\n\n对于 $40\\%$ 的数据，$n,m \\le 10^3$。\n\n对于 $60\\%$ 的数据，$n,m \\le 10^5$。\n\n对于 $80\\%$ 的数据，$m \\le 10^6$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^{18}$，$1 \\le m \\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P6154", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2\n3 2", "199648871"], ["6 5\n1 3\n2 3\n3 4\n4 5\n4 6", "630470119"], ["5 6\n1 2\n1 3\n4 5\n3 4\n3 5\n2 4", "887328315"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "记忆化搜索", "拓扑排序", "期望"], "title": "游走", "background": "zbw 在 B 城游走。", "description": "B 城可以看作一个有 $n$ 个点 $m$ 条边的**有向无环图**。**可能存在重边**。\n\nzbw 在 B 城随机游走，他会在所有路径中随机选择一条路径，选择所有路径的概率相等。路径的起点和终点可以相同。\n\n定义一条路径的长度为经过的边数，你需要求出 zbw 走的路径长度的期望，答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $x,y$，表示存在一条从 $x$ 到 $y$ 的有向边。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "样例说明：样例的答案分别为 $\\dfrac{2}{5}$，$\\dfrac{25}{19}$ 和 $\\dfrac{11}{9}$。\n\n| 测试点编号 | $n$ | $m$ | 特殊性质 | 每测试点分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10$ | $\\le 10$ | 无 | $2$ |\n| $3,4,5$ | $\\le 15$ | $\\le 100$ | 无 | $2$ |\n| $6,7,8$ | $\\le 100$ | $\\le 10^3$ | 无 | $2$ |\n| $9,10$ | $\\le 10^3$ | $\\le 10^4$ | 无 | $2$ |\n| $11,12$ | $\\le 10^4$ | $\\le 10^5$ | 无 | $5$ |\n| $13,14$ | $\\le 10^5$ | $\\le 2\\times10^5$ | 无 | $5$ |\n| $15,16$ | $\\le 10^5$ | $\\le 7\\times10^5$ | 无 | $10$ |\n| $17$ | $\\le 10$ | $=n-1$ | 有向树 | $10$ |\n| $18$ | $\\le 10^3$ | $=n-1$ | 有向树 | $10$ |\n| $19$ | $\\le 10^4$ | $=n-1$ | 有向树 | $10$ |\n| $20$ | $\\le 10^5$ | $=n-1$ | 有向树 | $10$ |\n\n其中，“有向树”的定义是：若把图视为无向图，则为一棵树（如样例 $1,2$）。\n\n保证所有数据均按照某种方式随机，这意味着你可以认为算法执行过程中，你可以放心执行模意义下除法操作而不用担心除以零。", "locale": "zh-CN", "translations": {"en": {"title": "Random Walk", "background": "zbw is wandering in City B.", "description": "City B can be seen as a **directed acyclic graph** with $n$ vertices and $m$ edges. **Multiple edges may exist**.\n\nzbw walks randomly in City B. He will randomly choose one path among all paths, and every path is chosen with equal probability. The starting vertex and the ending vertex of a path may be the same.\n\nDefine the length of a path as the number of edges it passes through. You need to compute the expected length of the path zbw walks, and output the answer modulo $998244353$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next $m$ lines each contain two integers $x, y$, indicating that there is a directed edge from $x$ to $y$.", "outputFormat": "Output one integer per line, representing the answer modulo $998244353$.", "hint": "Sample explanation: the answers for the samples are $\\dfrac{2}{5}$, $\\dfrac{25}{19}$, and $\\dfrac{11}{9}$.\n\n## Constraints\n\n| Test Point ID | $n$ | $m$ | Special Property | Score per Test Point |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10$ | $\\le 10$ | None | $2$ |\n| $3,4,5$ | $\\le 15$ | $\\le 100$ | None | $2$ |\n| $6,7,8$ | $\\le 100$ | $\\le 10^3$ | None | $2$ |\n| $9,10$ | $\\le 10^3$ | $\\le 10^4$ | None | $2$ |\n| $11,12$ | $\\le 10^4$ | $\\le 10^5$ | None | $5$ |\n| $13,14$ | $\\le 10^5$ | $\\le 2\\times 10^5$ | None | $5$ |\n| $15,16$ | $\\le 10^5$ | $\\le 7\\times 10^5$ | None | $10$ |\n| $17$ | $\\le 10$ | $= n - 1$ | Directed Tree | $10$ |\n| $18$ | $\\le 10^3$ | $= n - 1$ | Directed Tree | $10$ |\n| $19$ | $\\le 10^4$ | $= n - 1$ | Directed Tree | $10$ |\n| $20$ | $\\le 10^5$ | $= n - 1$ | Directed Tree | $10$ |\n\nHere, a “Directed Tree” means: if you view the graph as an undirected graph, it is a tree (as in samples $1,2$).\n\nIt is guaranteed that all testdata is generated randomly in some way. This means you may assume that during the algorithm, you can safely perform division modulo $998244353$ without worrying about dividing by zero.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "游走", "background": "zbw 在 B 城游走。", "description": "B 城可以看作一个有 $n$ 个点 $m$ 条边的**有向无环图**。**可能存在重边**。\n\nzbw 在 B 城随机游走，他会在所有路径中随机选择一条路径，选择所有路径的概率相等。路径的起点和终点可以相同。\n\n定义一条路径的长度为经过的边数，你需要求出 zbw 走的路径长度的期望，答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $x,y$，表示存在一条从 $x$ 到 $y$ 的有向边。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "样例说明：样例的答案分别为 $\\dfrac{2}{5}$，$\\dfrac{25}{19}$ 和 $\\dfrac{11}{9}$。\n\n| 测试点编号 | $n$ | $m$ | 特殊性质 | 每测试点分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10$ | $\\le 10$ | 无 | $2$ |\n| $3,4,5$ | $\\le 15$ | $\\le 100$ | 无 | $2$ |\n| $6,7,8$ | $\\le 100$ | $\\le 10^3$ | 无 | $2$ |\n| $9,10$ | $\\le 10^3$ | $\\le 10^4$ | 无 | $2$ |\n| $11,12$ | $\\le 10^4$ | $\\le 10^5$ | 无 | $5$ |\n| $13,14$ | $\\le 10^5$ | $\\le 2\\times10^5$ | 无 | $5$ |\n| $15,16$ | $\\le 10^5$ | $\\le 7\\times10^5$ | 无 | $10$ |\n| $17$ | $\\le 10$ | $=n-1$ | 有向树 | $10$ |\n| $18$ | $\\le 10^3$ | $=n-1$ | 有向树 | $10$ |\n| $19$ | $\\le 10^4$ | $=n-1$ | 有向树 | $10$ |\n| $20$ | $\\le 10^5$ | $=n-1$ | 有向树 | $10$ |\n\n其中，“有向树”的定义是：若把图视为无向图，则为一棵树（如样例 $1,2$）。\n\n保证所有数据均按照某种方式随机，这意味着你可以认为算法执行过程中，你可以放心执行模意义下除法操作而不用担心除以零。", "locale": "zh-CN"}}}
{"pid": "P6155", "type": "P", "difficulty": 4, "samples": [["3\n3 3 3\n1 2 3", "4"], ["3\n3 3 4\n3 2 1", "2"], ["3\n3 4 5\n2 1 3", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2020", "栈"], "title": "修改", "background": "", "description": "给定一个长度为 $n$ 的整数序列 $a_i$，再给定一个长度为 $n$ 的整数序列 $b_i$。\n\n你可以进行一些修改，每次你可以将一个 $a_i$ 增加 $1$，花费为 $b_i$，你需要使所有的 $a_i$ 不相等，且同时满足花费最少。\n\n但 zbw 认为太过简单，于是他规定，你可以在修改前进行**无限**次如下操作：交换 $b_i,b_j(1 \\leq i,j \\leq n)$。\n\n求最小的花费。\n\n**由于答案可能很大，请输出答案对  $2^{64}$ 取模后的值。**\n\n\n", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数，第 $i$ 个数表示 $a_i$。\n\n第三行 $n$ 个整数，第 $i$ 个数表示 $b_i$。", "outputFormat": "输出一行一个整数，表示答案对 $2^{64}$ 取模的值。", "hint": "样例 $1$：不改变 $b$，让 $a_1$ 增加 $2$，$a_2$ 增加 $1$，总花费为 $4$。\n\n样例 $2$：交换 $b_1,b_3$，让 $a_1$ 增加 $2$，总花费为 $2$。\n\n样例 $3$：不做任何改变。\n\n**本题输入量较大，请使用读入优化。**\n\n\n\n| 测试点 |$n$  |$a_i$  |特殊性质|\n| :----------: | :----------: | :----------: |  :----------: |\n| $1,2$ |$\\leq10$  |$\\leq10^9$  |无 |\n| $3\\sim6$ |$\\leq10^3$  |$\\leq10^9$  |无| \n| $7\\sim10$ |$\\leq10^6$  |$\\leq10^6$  | 无|\n| $11\\sim14$ |$\\leq10^6$  |$\\leq10^9$  |所有 $b_i$ 相等 |\n| $15\\sim20$ |$\\leq10^6$  |$\\leq10^9$  |无|\n\n对于所有数据 $1 \\leq n \\leq 10^6$，$1\\leq a_i,b_i\\leq10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "修改", "background": "", "description": "给定一个长度为 $n$ 的整数序列 $a_i$，再给定一个长度为 $n$ 的整数序列 $b_i$。\n\n你可以进行一些修改，每次你可以将一个 $a_i$ 增加 $1$，花费为 $b_i$，你需要使所有的 $a_i$ 不相等，且同时满足花费最少。\n\n但 zbw 认为太过简单，于是他规定，你可以在修改前进行**无限**次如下操作：交换 $b_i,b_j(1 \\leq i,j \\leq n)$。\n\n求最小的花费。\n\n**由于答案可能很大，请输出答案对  $2^{64}$ 取模后的值。**\n\n\n", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数，第 $i$ 个数表示 $a_i$。\n\n第三行 $n$ 个整数，第 $i$ 个数表示 $b_i$。", "outputFormat": "输出一行一个整数，表示答案对 $2^{64}$ 取模的值。", "hint": "样例 $1$：不改变 $b$，让 $a_1$ 增加 $2$，$a_2$ 增加 $1$，总花费为 $4$。\n\n样例 $2$：交换 $b_1,b_3$，让 $a_1$ 增加 $2$，总花费为 $2$。\n\n样例 $3$：不做任何改变。\n\n**本题输入量较大，请使用读入优化。**\n\n\n\n| 测试点 |$n$  |$a_i$  |特殊性质|\n| :----------: | :----------: | :----------: |  :----------: |\n| $1,2$ |$\\leq10$  |$\\leq10^9$  |无 |\n| $3\\sim6$ |$\\leq10^3$  |$\\leq10^9$  |无| \n| $7\\sim10$ |$\\leq10^6$  |$\\leq10^6$  | 无|\n| $11\\sim14$ |$\\leq10^6$  |$\\leq10^9$  |所有 $b_i$ 相等 |\n| $15\\sim20$ |$\\leq10^6$  |$\\leq10^9$  |无|\n\n对于所有数据 $1 \\leq n \\leq 10^6$，$1\\leq a_i,b_i\\leq10^9$。", "locale": "zh-CN"}}}
{"pid": "P6156", "type": "P", "difficulty": 6, "samples": [["3 3", "1216"], ["2 6", "9714"], ["18 2", "260108"], ["143 1", "7648044"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "莫比乌斯反演", "分块", "差分"], "title": "简单题", "background": "zbw 遇上了一道题，由于他急着去找 qby，所以他想让你来帮他做。", "description": "给你 $n,k$ 求下式的值：\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n(i+j)^kf(\\gcd(i,j))\\gcd(i,j)$\n\n其中 $\\gcd(i,j)$ 表示 $i,j$ 的最大公约数。\n\n$f$ 函数定义如下：\n\n如果 $k$ 有平方因子 $f(k)=0$，否则 $f(k)=1$。\n\n**Update:平方因子定义 如果存在一个整数 $k(k>1),k^2|n$ 则 $k$ 是 $n$ 的一个平方因子** \n\n**请输出答案对 $998244353$ 取模的值。**", "inputFormat": "一行两个整数 $n,k$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "|  测试点|$n$  |$k$  |\n| :----------: | :----------: | :----------: |\n| $1,2$ |$\\leq10^3$  |$\\leq10^3$  |\n| $3,4$ |$\\leq2 \\times 10^3$  |$\\leq10^{18}$  |\n| $5 \\sim8$ | $\\leq5 \\times 10^4$ |$\\leq10^{18}$  |\n| $9$ |$\\leq 5\\times10^6$  |$=1$  |\n| $10,11$ |$\\leq 5\\times10^6$  | $=2$ |\n| $12,13$ | $\\leq 5\\times10^6$ | $\\leq10^3$ |\n| $14 \\sim20$ | $\\leq 5\\times10^6$ | $\\leq10^{18}$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5 \\times 10^6$，$1 \\leq k \\leq 10^{18}$。\n\n**Update on 2020/3/16:**\n\n时间调至 $1$s,卡掉了 $O(n\\log k)$,$O(n\\log mod)$ 的做法。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "简单题", "background": "zbw 遇上了一道题，由于他急着去找 qby，所以他想让你来帮他做。", "description": "给你 $n,k$ 求下式的值：\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n(i+j)^kf(\\gcd(i,j))\\gcd(i,j)$\n\n其中 $\\gcd(i,j)$ 表示 $i,j$ 的最大公约数。\n\n$f$ 函数定义如下：\n\n如果 $k$ 有平方因子 $f(k)=0$，否则 $f(k)=1$。\n\n**Update:平方因子定义 如果存在一个整数 $k(k>1),k^2|n$ 则 $k$ 是 $n$ 的一个平方因子** \n\n**请输出答案对 $998244353$ 取模的值。**", "inputFormat": "一行两个整数 $n,k$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "|  测试点|$n$  |$k$  |\n| :----------: | :----------: | :----------: |\n| $1,2$ |$\\leq10^3$  |$\\leq10^3$  |\n| $3,4$ |$\\leq2 \\times 10^3$  |$\\leq10^{18}$  |\n| $5 \\sim8$ | $\\leq5 \\times 10^4$ |$\\leq10^{18}$  |\n| $9$ |$\\leq 5\\times10^6$  |$=1$  |\n| $10,11$ |$\\leq 5\\times10^6$  | $=2$ |\n| $12,13$ | $\\leq 5\\times10^6$ | $\\leq10^3$ |\n| $14 \\sim20$ | $\\leq 5\\times10^6$ | $\\leq10^{18}$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5 \\times 10^6$，$1 \\leq k \\leq 10^{18}$。\n\n**Update on 2020/3/16:**\n\n时间调至 $1$s,卡掉了 $O(n\\log k)$,$O(n\\log mod)$ 的做法。", "locale": "zh-CN"}}}
{"pid": "P6157", "type": "P", "difficulty": 6, "samples": [["7\n1 2\n2 3\n2 4\n1 5\n5 6\n5 7\n5 4 3 2 1 4 3\n6\n1 3 4\n1 2 5\n1 2 1\n0 2 1\n1 2 5\n1 2 1", "3 4\n4 3\n4 3\n1 4\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "线段树", "树链剖分"], "title": "有趣的游戏", "background": "小 A 和小 B 正在玩一个有趣的电脑游戏。", "description": "游戏在一棵大小为 $n$ 的树上进行。其中每个点都有点权，第 $i$ 个点的点权为 $w_i$。\n\n每一次系统会给出一条链，小 A 可以从这条链上找出两个**点权不同**的点 $x,y$，他的得分是 $w_x\\bmod w_y$。然后小 B 会从**整棵树**中选取两个**小 A 没有选过**的点，计分方式同小 A。\n\n为了保持游戏难度，系统有时会增加一个点的权值。\n\n当然，小 A 会尽可能使自己得分最大，他想知道这个值是多少。同时，他想知道，在自己得分最大的情况下，小 B 的最大得分是多少。", "inputFormat": "第一行一个整数 $n$ 表示树的节点个数。\n\n接下来 $n-1$ 行，每行两个整数 $a,b$，表示 $a,b$ 之间有一条边。\n\n接下来一行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个点的点权。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行三个整数 $opt,x,y$。\n\n若 $opt=0$，将  $w_x$ 增加 $y$。\n\n若 $opt=1$，表示系统给出一条从 $x$ 到 $y$ 的链。", "outputFormat": "对于每一次 $opt=1$，输出一行两个整数 $suma,sumb$ 。分别表示小 A 的最大得分和在这情况下小 B 的最大得分 。\n\n**如果小 A 无法选出两个权值不同的点，那么只输出一个数 $-1$。**", "hint": "样例解释：\n\n第一次：小 A 选择点 $3$ 和点 $2$，得分为 $3\\bmod 4=3$，小 B 选择点 $6$ 和点 $1$ 得分为 $4\\bmod 5=4$。\n\n第二次：小 A 选择点 $2$ 和点 $1$，得分为 $4\\bmod 5=4$，小 B 选择点 $7$ 和点 $6$ 得分为 $3\\bmod 4=3$。\n\n第三次：小 A 选择点 $2$ 和点 $1$，得分为 $4\\bmod 5=4$，小 B 选择点 $7$ 和点 $6$ 得分为 $3\\bmod 4=3$。\n\n第四次：第 $2$ 个点点权变为 $5$。\n\n第五次：小 A 选择点 $5$ 和点 $1$，得分为 $1\\bmod 5=1$，小 B 选择点 $6$ 和点 $2$ 得分为 $4\\bmod 5=4$。\n\n第六次：小 A 可以选的点只有 $1,2$ ，点权都是 $5$，没有可以选的方案。\n\n**本题采用捆绑测试。**\n| Subtasks |$n,q$  |特殊性质  |分数  |\n| :----------: | :----------: | :----------: | :----------: |\n|Subtask1  |$\\leq10^3$  |无  |$10$  |\n|Subtask2  |$\\leq10^5$  |树的形态，点权随机  |$15$  |\n|Subtask3  |$\\leq10^5$  |最多有 $5$ 种不同的点权，且没有修改 |$15$  |\n|Subtask4  |$\\leq10^5$  |树为一条链，且第 $i$ $(i>1)$ 个点的父亲为 $i-1$ |$25$  |\n|Subtask5  |$\\leq10^5$  |无  |$35$  |\n\n对于所有数据 $1 \\leq n,q \\leq 10^5$，$1 \\leq w_i \\leq 10^4$，增加的数为不大于 $10^3$ 的正整数，且输入为一棵合法的树。**保证任何时候不同种类的数大于等于 $4$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "有趣的游戏", "background": "小 A 和小 B 正在玩一个有趣的电脑游戏。", "description": "游戏在一棵大小为 $n$ 的树上进行。其中每个点都有点权，第 $i$ 个点的点权为 $w_i$。\n\n每一次系统会给出一条链，小 A 可以从这条链上找出两个**点权不同**的点 $x,y$，他的得分是 $w_x\\bmod w_y$。然后小 B 会从**整棵树**中选取两个**小 A 没有选过**的点，计分方式同小 A。\n\n为了保持游戏难度，系统有时会增加一个点的权值。\n\n当然，小 A 会尽可能使自己得分最大，他想知道这个值是多少。同时，他想知道，在自己得分最大的情况下，小 B 的最大得分是多少。", "inputFormat": "第一行一个整数 $n$ 表示树的节点个数。\n\n接下来 $n-1$ 行，每行两个整数 $a,b$，表示 $a,b$ 之间有一条边。\n\n接下来一行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个点的点权。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行三个整数 $opt,x,y$。\n\n若 $opt=0$，将  $w_x$ 增加 $y$。\n\n若 $opt=1$，表示系统给出一条从 $x$ 到 $y$ 的链。", "outputFormat": "对于每一次 $opt=1$，输出一行两个整数 $suma,sumb$ 。分别表示小 A 的最大得分和在这情况下小 B 的最大得分 。\n\n**如果小 A 无法选出两个权值不同的点，那么只输出一个数 $-1$。**", "hint": "样例解释：\n\n第一次：小 A 选择点 $3$ 和点 $2$，得分为 $3\\bmod 4=3$，小 B 选择点 $6$ 和点 $1$ 得分为 $4\\bmod 5=4$。\n\n第二次：小 A 选择点 $2$ 和点 $1$，得分为 $4\\bmod 5=4$，小 B 选择点 $7$ 和点 $6$ 得分为 $3\\bmod 4=3$。\n\n第三次：小 A 选择点 $2$ 和点 $1$，得分为 $4\\bmod 5=4$，小 B 选择点 $7$ 和点 $6$ 得分为 $3\\bmod 4=3$。\n\n第四次：第 $2$ 个点点权变为 $5$。\n\n第五次：小 A 选择点 $5$ 和点 $1$，得分为 $1\\bmod 5=1$，小 B 选择点 $6$ 和点 $2$ 得分为 $4\\bmod 5=4$。\n\n第六次：小 A 可以选的点只有 $1,2$ ，点权都是 $5$，没有可以选的方案。\n\n**本题采用捆绑测试。**\n| Subtasks |$n,q$  |特殊性质  |分数  |\n| :----------: | :----------: | :----------: | :----------: |\n|Subtask1  |$\\leq10^3$  |无  |$10$  |\n|Subtask2  |$\\leq10^5$  |树的形态，点权随机  |$15$  |\n|Subtask3  |$\\leq10^5$  |最多有 $5$ 种不同的点权，且没有修改 |$15$  |\n|Subtask4  |$\\leq10^5$  |树为一条链，且第 $i$ $(i>1)$ 个点的父亲为 $i-1$ |$25$  |\n|Subtask5  |$\\leq10^5$  |无  |$35$  |\n\n对于所有数据 $1 \\leq n,q \\leq 10^5$，$1 \\leq w_i \\leq 10^4$，增加的数为不大于 $10^3$ 的正整数，且输入为一棵合法的树。**保证任何时候不同种类的数大于等于 $4$。**", "locale": "zh-CN"}}}
{"pid": "P6158", "type": "P", "difficulty": 7, "samples": [["3\n8 3\n5 2\n1 1\n4 2\n1 2\n7 5\n7 2\n6 1\n5 4\n2 3\n1 4 \n4 3", "49"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "网络流", "O2优化", "最短路", "最小割", "凸包", "叉积"], "title": "封锁", "background": "震惊！zbw 竟从 B 城监狱逃出！\n\n作为 B 城的警察局长，你必须在 zbw 逃出你的管辖范围之前抓住他。", "description": "B 城可视为一个 $n \\times n$ 的方阵，其中监狱在 $(1,1)$，B 城唯一出城的出口在 $(n,n)$。每两个相邻的点（横坐标之差的绝对值 $+$ 纵坐标之间的绝对值 $=1$）之间都有一条**无向的**道路（没有斜着的道路）。你需要在一些道路上部下防守，使得无论 zbw 怎么走，都至少会经过其中的一条道路。\n\n在一条 $(i,j)$ 到 $(i,j+1)$ 的道路上部下防守的花费是 $r_{i,j}$，在一条 $(i,j)$ 到 $(i+1,j)$ 的道路上部下防守的花费是 $d_{i,j}$，同时，在道路上部下防守会对人民的生活造成影响，在一条 $(i,j)$ 到 $(i,j+1)$ 的道路上部下防守对人民的生活造成的影响是 $x_{i,j}$，在一条 $(i,j)$ 到 $(i+1,j)$ 的道路上部下防守对人民的生活造成的影响是 $y_{i,j}$。\n\n定义总花费为 $w$ ，总影响为 $e$ ，作为一名优秀的警察局长，你需要最小化 $w \\times e$。 ", "inputFormat": "第一行一个整数 $n$。\n\n之后的 $n \\times (n-1)$ 行，第 $i$ 行两个整数 $r_{i/n+1,(i-1)\\bmod n+1}$， $x_{i/n+1,(i-1)\\bmod n+1}$。\n\n之后的 $n \\times (n-1)$ 行，第 $i$ 行两个整数 $d_{i/n+1,(i-1)\\bmod n+1}$ ，$y_{i/n+1,(i-1)\\bmod n+1}$。\n\n也就是说，先从上往下给从左往右给出竖边的信息，再从上往下给从左往右给出横边的信息。\n\n如果不理解请见样例解释。\n", "outputFormat": "一行一个整数，表示 $w \\times e$ 的最小值。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/bjd62iba.png)\n\n如图，左上角为 $(1,1)$，右下角为 $(n,n)$，\n其中蓝色数字表示 $r$,\n红色数字表示 $x$,\n黄色数字表示 $d$,\n绿色数字表示 $y$。\n\n最优方案为防守三条边，分别为：\n\n$(2,2)-(2,3),(3,1)-(3,2),(3,2)-(3,3)$\n\n三条边的边权分别是 $2,3$---$1,1$ ---$4,3$\n\n答案为 $(1+2+4)\\times (1+3+3)=49$\n\n\n可以发现没有更优的做法。\n\n**本题采用捆绑测试。**\n\n|  Subtasks| $n$ |特殊性质  |分数\n| :----------: | :----------: | :----------: |:----------: |\n|  Subtask1| $n=2$ |无  |$5$\n|  Subtask2| $n\\leq400$ |数据随机  |$15$\n|  Subtask3| $n\\leq10$ |  无|$15$\n|  Subtask4| $n\\leq50$ | 无 |$30$\n|  Subtask5| $n\\leq400$ | 无 |$35$\n\n对于所有数据 $1 \\leq n \\leq 400$，$0 \\leq r_{i,j}, d_{i,j},x_{i,j} ,y_{i,j}  \\leq 10^3$。\n\n数据于2020/3/4加强，卡掉部分复杂度错误的做法。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "封锁", "background": "震惊！zbw 竟从 B 城监狱逃出！\n\n作为 B 城的警察局长，你必须在 zbw 逃出你的管辖范围之前抓住他。", "description": "B 城可视为一个 $n \\times n$ 的方阵，其中监狱在 $(1,1)$，B 城唯一出城的出口在 $(n,n)$。每两个相邻的点（横坐标之差的绝对值 $+$ 纵坐标之间的绝对值 $=1$）之间都有一条**无向的**道路（没有斜着的道路）。你需要在一些道路上部下防守，使得无论 zbw 怎么走，都至少会经过其中的一条道路。\n\n在一条 $(i,j)$ 到 $(i,j+1)$ 的道路上部下防守的花费是 $r_{i,j}$，在一条 $(i,j)$ 到 $(i+1,j)$ 的道路上部下防守的花费是 $d_{i,j}$，同时，在道路上部下防守会对人民的生活造成影响，在一条 $(i,j)$ 到 $(i,j+1)$ 的道路上部下防守对人民的生活造成的影响是 $x_{i,j}$，在一条 $(i,j)$ 到 $(i+1,j)$ 的道路上部下防守对人民的生活造成的影响是 $y_{i,j}$。\n\n定义总花费为 $w$ ，总影响为 $e$ ，作为一名优秀的警察局长，你需要最小化 $w \\times e$。 ", "inputFormat": "第一行一个整数 $n$。\n\n之后的 $n \\times (n-1)$ 行，第 $i$ 行两个整数 $r_{i/n+1,(i-1)\\bmod n+1}$， $x_{i/n+1,(i-1)\\bmod n+1}$。\n\n之后的 $n \\times (n-1)$ 行，第 $i$ 行两个整数 $d_{i/n+1,(i-1)\\bmod n+1}$ ，$y_{i/n+1,(i-1)\\bmod n+1}$。\n\n也就是说，先从上往下给从左往右给出竖边的信息，再从上往下给从左往右给出横边的信息。\n\n如果不理解请见样例解释。\n", "outputFormat": "一行一个整数，表示 $w \\times e$ 的最小值。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/bjd62iba.png)\n\n如图，左上角为 $(1,1)$，右下角为 $(n,n)$，\n其中蓝色数字表示 $r$,\n红色数字表示 $x$,\n黄色数字表示 $d$,\n绿色数字表示 $y$。\n\n最优方案为防守三条边，分别为：\n\n$(2,2)-(2,3),(3,1)-(3,2),(3,2)-(3,3)$\n\n三条边的边权分别是 $2,3$---$1,1$ ---$4,3$\n\n答案为 $(1+2+4)\\times (1+3+3)=49$\n\n\n可以发现没有更优的做法。\n\n**本题采用捆绑测试。**\n\n|  Subtasks| $n$ |特殊性质  |分数\n| :----------: | :----------: | :----------: |:----------: |\n|  Subtask1| $n=2$ |无  |$5$\n|  Subtask2| $n\\leq400$ |数据随机  |$15$\n|  Subtask3| $n\\leq10$ |  无|$15$\n|  Subtask4| $n\\leq50$ | 无 |$30$\n|  Subtask5| $n\\leq400$ | 无 |$35$\n\n对于所有数据 $1 \\leq n \\leq 400$，$0 \\leq r_{i,j}, d_{i,j},x_{i,j} ,y_{i,j}  \\leq 10^3$。\n\n数据于2020/3/4加强，卡掉部分复杂度错误的做法。", "locale": "zh-CN"}}}
{"pid": "P6159", "type": "P", "difficulty": 1, "samples": [["12 5 2", "10"], ["1000 342 3472844", "648"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2020"], "title": "[Cnoi2020] 光图", "background": "> 简洁中蕴含着伟大。\n\nCirno 不经意地把一个内部完全反射的圆分成了 $12$ 等分，等分点分别记作 $A_0$, $A_1$, $A_2$, $\\cdots$ , $A_{11}$。\n\n随后，她不经意地将一束光从一点发出，朝向另一点，重复，反射，迭代，便得到了一幅美妙的光图。\n\n这一切都发生在不经意之间。\n\n她不经意地发现了这一幕，并且不经意地记下了这个不经意的结论，又在某一刻不经意地回忆起。\n\n幻想乡的每一天一切都是这么不以为意，多好的一天啊！", "description": "Rumia 有一个单位圆，被分成 $n$ 等分，等分点分别记作 $A_0$, $A_1$, $A_2$, $\\cdots$ , $A_{n-1}$。\n\n现在她从 $A_0$ 向 $A_p$ 发射一束光，经过 $k-1$ 次反射，到达了 $A_t$。\n\nRumia 想知道 $t$ 的值，由于 Cirno 并不想帮她，所以 Rumia 转而求助于你。", "inputFormat": "一行，三个整数，$n,p,k$。", "outputFormat": "一行，一个整数 $t$。", "hint": "### Sample1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x7j0roeg.png)\n\n### 后置物理知识\n - **连续曲线反射规律** : 入射光线与出射光线关于入射点在曲线上切线夹角相等。\n\n### 数据范围约定\n\n**「本题采用捆绑测试」**\n\n - Subtask1( $80\\%$ ) : $n, k \\le 10^6$\n - Subtask2( $20\\%$ ) : $n, k \\le 10^9$\n\n对于 $100\\%$ 的数据 : $0 < p < n \\le 10^9$, $0 < k \\le 10^9$。\n\n### 后记\n - Cirno 得到的光图就是传说中的**十二芒星图**。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2020] Light Diagram", "background": "> Greatness is hidden in simplicity.\n\nCirno casually divided a circle with total internal reflection into $12$ equal parts, and the division points are denoted as $A_0$, $A_1$, $A_2$, $\\cdots$ , $A_{11}$.\n\nThen, she casually emitted a beam of light from one point toward another point. By repeating, reflecting, and iterating, she obtained a beautiful light diagram.\n\nAll of this happened casually.\n\nShe casually noticed this scene, and casually wrote down this casual conclusion, and at some moment casually recalled it.\n\nEvery day in Gensokyo is so carefree. What a nice day.", "description": "Rumia has a unit circle, divided into $n$ equal parts, and the division points are denoted as $A_0$, $A_1$, $A_2$, $\\cdots$ , $A_{n-1}$.\n\nNow she emits a beam of light from $A_0$ toward $A_p$. After $k - 1$ reflections, it arrives at $A_t$.\n\nRumia wants to know the value of $t$. Since Cirno does not want to help her, Rumia turns to you for help.", "inputFormat": "One line with three integers, $n, p, k$.", "outputFormat": "One line with one integer $t$.", "hint": "### Explanation of Sample 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x7j0roeg.png)\n\n### Physical knowledge used later\n- **Reflection law on a continuous curve**: The incident ray and the reflected ray make equal angles with the tangent line of the curve at the point of incidence.\n\n### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 ($80\\%$): $n, k \\le 10^6$.\n- Subtask 2 ($20\\%$): $n, k \\le 10^9$.\n\nFor $100\\%$ of the testdata: $0 < p < n \\le 10^9$, $0 < k \\le 10^9$.\n\n### Postscript\n- The light diagram obtained by Cirno is the legendary **twelve-pointed star diagram**.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2020] 光图", "background": "> 简洁中蕴含着伟大。\n\nCirno 不经意地把一个内部完全反射的圆分成了 $12$ 等分，等分点分别记作 $A_0$, $A_1$, $A_2$, $\\cdots$ , $A_{11}$。\n\n随后，她不经意地将一束光从一点发出，朝向另一点，重复，反射，迭代，便得到了一幅美妙的光图。\n\n这一切都发生在不经意之间。\n\n她不经意地发现了这一幕，并且不经意地记下了这个不经意的结论，又在某一刻不经意地回忆起。\n\n幻想乡的每一天一切都是这么不以为意，多好的一天啊！", "description": "Rumia 有一个单位圆，被分成 $n$ 等分，等分点分别记作 $A_0$, $A_1$, $A_2$, $\\cdots$ , $A_{n-1}$。\n\n现在她从 $A_0$ 向 $A_p$ 发射一束光，经过 $k-1$ 次反射，到达了 $A_t$。\n\nRumia 想知道 $t$ 的值，由于 Cirno 并不想帮她，所以 Rumia 转而求助于你。", "inputFormat": "一行，三个整数，$n,p,k$。", "outputFormat": "一行，一个整数 $t$。", "hint": "### Sample1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x7j0roeg.png)\n\n### 后置物理知识\n - **连续曲线反射规律** : 入射光线与出射光线关于入射点在曲线上切线夹角相等。\n\n### 数据范围约定\n\n**「本题采用捆绑测试」**\n\n - Subtask1( $80\\%$ ) : $n, k \\le 10^6$\n - Subtask2( $20\\%$ ) : $n, k \\le 10^9$\n\n对于 $100\\%$ 的数据 : $0 < p < n \\le 10^9$, $0 < k \\le 10^9$。\n\n### 后记\n - Cirno 得到的光图就是传说中的**十二芒星图**。", "locale": "zh-CN"}}}
{"pid": "P6160", "type": "P", "difficulty": 3, "samples": [["3 4 5", "-25.0"], ["159 473 824 ", "-445561.0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "向量"], "title": "[Cnoi2020] 向量", "background": "> 向量(vector)，指具有大小(Magnitude)和方向(Direction) 的量。  \n> 与向量对应的量叫做数量(Scalar)，数量只有大小，没有方向。\n\n对于 Cirno 来说，整天环绕氷屋的旋转 Sangetsusei 们是向量而不是数量。\n - Sunny Milk 以 $r_1$ 为半径做匀速圆周运动。\n - Luna Child 以 $r_2$ 为半径做匀加速圆周运动。\n - Star Sapphire 以 $r_3$ 为半径做变加速圆周运动。\n\n为了尽可能的减小三月精们的影响，一些重要的参数必需被计算。", "description": "以氷屋为原点，三月精的位置分别记作向量 $\\vec{a}$, $\\vec{b}$, $\\vec{c}$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j3u0l3no.png)\n\n由定义可知，$|\\vec{a}|=r_1$, $|\\vec{b}|=r_2$, $|\\vec{c}|=r_3$。\n\n现在 Cirno 分配给你的任务是计算其 **破坏极限指数** $\\sigma$。\n\n$$\\sigma=\\min\\{\\vec{a}\\cdot\\vec{b}+\\vec{b}\\cdot\\vec{c}+\\vec{c}\\cdot\\vec{a}\\}$$\n\n其中「$\\cdot$」表示 **向量内积**。", "inputFormat": "一行，三个整数 $r_1$, $r_2$, $r_3$，保证 $r_1 \\le r_2 \\le r_3$。", "outputFormat": "一行，一个 **实数** $\\sigma$。（**小数点后保留一位数字**）", "hint": "### Sample1 解释\n\n$\\cos\\langle\\vec{a},\\vec{b}\\rangle=0,\\cos\\langle\\vec{b},\\vec{c}\\rangle=-\\frac{4}{5},\\cos\\langle\\vec{c},\\vec{a}\\rangle=-\\frac{3}{5}$ 时答案最小。\n\n### 后置数学知识\n - **向量内积定义** : $\\vec{a}\\cdot\\vec{b}=|\\vec{a}||\\vec{b}|\\times \\cos\\langle\\vec{a},\\vec{b}\\rangle$\n - **向量内积坐标表示** : $(x_1,y_1)\\cdot(x_2,y_2)=x_1x_2+y_1y_2$\n\n### 数据范围约定\n\n**「本题采用捆绑测试」**\n\n - Subtask1( $20\\%$ ) : $r_1=r_2=r_3$\n - Subtask2( $40\\%$ ) : $r_1,r_2,r_3 \\le 10$\n - Subtask3( $40\\%$ ) : $r_1,r_2,r_3 \\le 10^9$\n\n对于 $100\\%$ 的数据 $0 < r_1 \\le r_2 \\le r_3 \\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2020] Vectors", "background": "> A vector refers to a quantity that has both magnitude (Magnitude) and direction (Direction).  \n> The quantity corresponding to a vector is called a scalar (Scalar), which has only magnitude and no direction.\n\nFor Cirno, the Sangetsusei who keep rotating around the ice house all day are vectors, not scalars.\n- Sunny Milk performs uniform circular motion with radius $r_1$.\n- Luna Child performs uniformly accelerated circular motion with radius $r_2$.\n- Star Sapphire performs variably accelerated circular motion with radius $r_3$.\n\nTo reduce the impact of the Sangetsusei as much as possible, some important parameters must be computed.", "description": "Take the ice house as the origin. The positions of the Sangetsusei are denoted by vectors $\\vec{a}$, $\\vec{b}$, $\\vec{c}$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j3u0l3no.png)\n\nBy definition, $|\\vec{a}|=r_1$, $|\\vec{b}|=r_2$, $|\\vec{c}|=r_3$.\n\nNow Cirno assigns you the task of computing the **destruction limit index** $\\sigma$.\n\n$$\\sigma=\\min\\{\\vec{a}\\cdot\\vec{b}+\\vec{b}\\cdot\\vec{c}+\\vec{c}\\cdot\\vec{a}\\}$$\n\nHere, “$\\cdot$” denotes the **vector dot product**.", "inputFormat": "One line with three integers $r_1$, $r_2$, $r_3$, guaranteed that $r_1 \\le r_2 \\le r_3$.", "outputFormat": "One line with one **real number** $\\sigma$. (**Keep one digit after the decimal point**.)", "hint": "### Sample1 Explanation\n\nThe answer is minimized when $\\cos\\langle\\vec{a},\\vec{b}\\rangle=0,\\cos\\langle\\vec{b},\\vec{c}\\rangle=-\\frac{4}{5},\\cos\\langle\\vec{c},\\vec{a}\\rangle=-\\frac{3}{5}$.\n\n### Required Math Knowledge\n- **Definition of dot product**: $\\vec{a}\\cdot\\vec{b}=|\\vec{a}||\\vec{b}|\\times \\cos\\langle\\vec{a},\\vec{b}\\rangle$\n- **Coordinate form of dot product**: $(x_1,y_1)\\cdot(x_2,y_2)=x_1x_2+y_1y_2$\n\n### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 ($20\\%$): $r_1=r_2=r_3$\n- Subtask 2 ($40\\%$): $r_1,r_2,r_3 \\le 10$\n- Subtask 3 ($40\\%$): $r_1,r_2,r_3 \\le 10^9$\n\nFor $100\\%$ of the testdata, $0 < r_1 \\le r_2 \\le r_3 \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2020] 向量", "background": "> 向量(vector)，指具有大小(Magnitude)和方向(Direction) 的量。  \n> 与向量对应的量叫做数量(Scalar)，数量只有大小，没有方向。\n\n对于 Cirno 来说，整天环绕氷屋的旋转 Sangetsusei 们是向量而不是数量。\n - Sunny Milk 以 $r_1$ 为半径做匀速圆周运动。\n - Luna Child 以 $r_2$ 为半径做匀加速圆周运动。\n - Star Sapphire 以 $r_3$ 为半径做变加速圆周运动。\n\n为了尽可能的减小三月精们的影响，一些重要的参数必需被计算。", "description": "以氷屋为原点，三月精的位置分别记作向量 $\\vec{a}$, $\\vec{b}$, $\\vec{c}$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j3u0l3no.png)\n\n由定义可知，$|\\vec{a}|=r_1$, $|\\vec{b}|=r_2$, $|\\vec{c}|=r_3$。\n\n现在 Cirno 分配给你的任务是计算其 **破坏极限指数** $\\sigma$。\n\n$$\\sigma=\\min\\{\\vec{a}\\cdot\\vec{b}+\\vec{b}\\cdot\\vec{c}+\\vec{c}\\cdot\\vec{a}\\}$$\n\n其中「$\\cdot$」表示 **向量内积**。", "inputFormat": "一行，三个整数 $r_1$, $r_2$, $r_3$，保证 $r_1 \\le r_2 \\le r_3$。", "outputFormat": "一行，一个 **实数** $\\sigma$。（**小数点后保留一位数字**）", "hint": "### Sample1 解释\n\n$\\cos\\langle\\vec{a},\\vec{b}\\rangle=0,\\cos\\langle\\vec{b},\\vec{c}\\rangle=-\\frac{4}{5},\\cos\\langle\\vec{c},\\vec{a}\\rangle=-\\frac{3}{5}$ 时答案最小。\n\n### 后置数学知识\n - **向量内积定义** : $\\vec{a}\\cdot\\vec{b}=|\\vec{a}||\\vec{b}|\\times \\cos\\langle\\vec{a},\\vec{b}\\rangle$\n - **向量内积坐标表示** : $(x_1,y_1)\\cdot(x_2,y_2)=x_1x_2+y_1y_2$\n\n### 数据范围约定\n\n**「本题采用捆绑测试」**\n\n - Subtask1( $20\\%$ ) : $r_1=r_2=r_3$\n - Subtask2( $40\\%$ ) : $r_1,r_2,r_3 \\le 10$\n - Subtask3( $40\\%$ ) : $r_1,r_2,r_3 \\le 10^9$\n\n对于 $100\\%$ 的数据 $0 < r_1 \\le r_2 \\le r_3 \\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P6161", "type": "P", "difficulty": 3, "samples": [["2", "2\n0 1 3\n0 2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "Special Judge", "构造"], "title": "[Cnoi2020] 高维", "background": "> 本质上，幻想乡是高维的。", "description": "Cirno 捕获了一只 $n$ 维蚂蚁，它想从 $S(0,0,...,0)$ 爬到 $T(1,1,...,1)$ 。\n\n被封闭在这个 $1\\times1\\times...\\times1$ 的方格中，蚂蚁每一步只能爬向一个坐标相邻的点。\n\n现在 Cirno 想考考你蚂蚁最多能找到多少条从 $S$ 到 $T$ 的路径两两没有交点( 除 $S$, $T$ )。\n\n并要求你构造这样一组路径。", "inputFormat": "一行，一个整数 $n$ 。", "outputFormat": "第一行，一个整数 $t$，表示最多的路径数。\n\n以下 $t$ 行，每行一条合法路径。\n\n合法路径表示方式 :\n\n> $S$ [空格] $P_1$ [空格] $P_2$ [空格] ... [空格] $T$\n\n其中 $P_i$ 是一个二进制压缩的 $01$ 串 表示一个 $n$ 维坐标。\n\n**请不要输出多余的空格**。", "hint": "**「本题使用 Special Judge」**\n\n### Sample1解释\n\n第 $1$ 条路径：$(0,0) \\rightarrow (0,1) \\rightarrow (1,1)$\n\n第 $2$ 条路径：$(0,0) \\rightarrow (1,0) \\rightarrow (1,1)$\n\n二者除了 $S$ 与 $T$ 无交点。\n\n### 数据范围约定\n\n**「本题不采用捆绑测试，数据有梯度」**\n\n对于 100% 的数据 $3 \\le n \\le 60$。\n\n### 后置代码片段\n\n - 二进制压位函数\n\n```cpp\n/**\n * For only cpp11, cpp14, cpp17, cpp20.\n *\n * @param: __s : The binary high-dimension position inputed.\n * @return: Standard output format( U64 ).\n**/\n\nunsigned long long zip( std::string __s ) \n  { unsigned long long __r = 0;\n    for( auto __c : __s ) \n      { ( __r <<= 1ull ) |= ( __c - 0x30 ); }\n    return __r; }\n\n```\n - SPJ代码\n```cpp\n//SPJ\n#include \"testlib.h\"\n#include<bits/stdc++.h>\n\ntypedef unsigned long long ULL;\ntypedef std::vector<std::string> SEQ;\ntypedef std::string STR;\n\nSEQ split( std::string _par, char _sgn )\n  { SEQ _rat = SEQ();\n\tSTR _rem = STR();\n\t\n    for( char __c : _par )\n      { if( __c = _sgn ) _rat.push_back( _rem ), _rem = \"\";\n\t    else _rem += __c; }\n\t\n\tif( _rem != \"\" ) _rat.push_back( _rem );\n\t\n\treturn _rat; }\n\nULL to_ULL( std::string _str ) \n  { ULL _rat = 0;\n\t\n\tfor( char __c : _str )\n\t  { ( _rat *= 10ull ) += (ULL)( __c - '0' ); }\n\t\n\treturn _rat; }\n\nbool isPw2( ULL x )\n  { return !( x & (x - 1ull) ); }\n\nstd::map<ULL, bool> MP;\n\nint main(int argc, char* argv[]) {\n    registerTestlibCmd(argc, argv);\n\t\n\tULL n = inf.readLong();\n\tULL S = 0, T = (1ull << n) - 1ull;\n\tULL N = ouf.readLong();\n\t\n\tif( N != n ) quitf( _wa, \"Count paths wrongly.\" );\n\t\n\touf.readEoln();\n\t\n    while( n -- ) {\n    \tstd::string path = ouf.readLine();\n    \n    \tULL _lst = 0;\n    \t\n    \tfor( auto N : split( path, \" \" ) )\n    \t  { ULL _now = to_ULL( N );\n    \t\tif( _now != S and _now != T and MP[_now] ) \n\t\t\t  { quitf( _wa, \"Paths crossing\" ); }\n    \t    if( !isPw2( _now ^ _lst ) ) \n\t\t\t  { quitf( _wa, \"Wrong path format\" ); }\n    \t    _lst = _now; MP[_now] = true; }\n    \t\n    \tif( _lst != T ) quitf( _wa, \"Wrong path ending\" );\n\t}\n\t\n\tquitf( _ok, \"Accepted\" );\n\t\n    return 0;\n} \n```\n", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2020] High Dimension", "background": "> In essence, Gensokyo is high-dimensional.", "description": "Cirno has caught an $n$-dimensional ant. It wants to crawl from $S(0,0,...,0)$ to $T(1,1,...,1)$.\n\nTrapped inside this $1\\times1\\times...\\times1$ grid, the ant can move in each step only to a point adjacent in exactly one coordinate.\n\nNow Cirno wants to test you: what is the maximum number of pairwise vertex-disjoint paths from $S$ to $T$ (excluding $S$ and $T$) that the ant can find?\n\nYou are also required to construct such a set of paths.", "inputFormat": "One line with one integer $n$.", "outputFormat": "The first line contains one integer $t$, the maximum number of paths.\n\nThe next $t$ lines each contain one valid path.\n\nA valid path is written as:\n\n> $S$ [space] $P_1$ [space] $P_2$ [space] ... [space] $T$\n\nwhere $P_i$ is a binary-compressed $01$ string representing an $n$-dimensional coordinate.\n\n**Do not output extra spaces.**", "hint": "**\"This problem uses Special Judge.\"**\n\n### Explanation of Sample 1\n\nPath $1$: $(0,0) \\rightarrow (0,1) \\rightarrow (1,1)$.\n\nPath $2$: $(0,0) \\rightarrow (1,0) \\rightarrow (1,1)$.\n\nThey have no common points except $S$ and $T$.\n\n### Constraints\n\n**\"This problem does not use bundled testdata; the testdata has multiple difficulty levels.\"**\n\nFor 100% of the testdata, $3 \\le n \\le 60$.\n\n### Attached Code Snippets\n\n- Binary packing function\n\n```cpp\n/**\n * For only cpp11, cpp14, cpp17, cpp20.\n *\n * @param: __s : The binary high-dimension position inputed.\n * @return: Standard output format( U64 ).\n**/\n\nunsigned long long zip( std::string __s ) \n  { unsigned long long __r = 0;\n    for( auto __c : __s ) \n      { ( __r <<= 1ull ) |= ( __c - 0x30 ); }\n    return __r; }\n\n```\n\n- SPJ code\n\n```cpp\n//SPJ\n#include \"testlib.h\"\n#include<bits/stdc++.h>\n\ntypedef unsigned long long ULL;\ntypedef std::vector<std::string> SEQ;\ntypedef std::string STR;\n\nSEQ split( std::string _par, char _sgn )\n  { SEQ _rat = SEQ();\n\tSTR _rem = STR();\n\t\n    for( char __c : _par )\n      { if( __c = _sgn ) _rat.push_back( _rem ), _rem = \"\";\n\t    else _rem += __c; }\n\t\n\tif( _rem != \"\" ) _rat.push_back( _rem );\n\t\n\treturn _rat; }\n\nULL to_ULL( std::string _str ) \n  { ULL _rat = 0;\n\t\n\tfor( char __c : _str )\n\t  { ( _rat *= 10ull ) += (ULL)( __c - '0' ); }\n\t\n\treturn _rat; }\n\nbool isPw2( ULL x )\n  { return !( x & (x - 1ull) ); }\n\nstd::map<ULL, bool> MP;\n\nint main(int argc, char* argv[]) {\n    registerTestlibCmd(argc, argv);\n\t\n\tULL n = inf.readLong();\n\tULL S = 0, T = (1ull << n) - 1ull;\n\tULL N = ouf.readLong();\n\t\n\tif( N != n ) quitf( _wa, \"Count paths wrongly.\" );\n\t\n\touf.readEoln();\n\t\n    while( n -- ) {\n    \tstd::string path = ouf.readLine();\n    \n    \tULL _lst = 0;\n    \t\n    \tfor( auto N : split( path, \" \" ) )\n    \t  { ULL _now = to_ULL( N );\n    \t\tif( _now != S and _now != T and MP[_now] ) \n\t\t\t  { quitf( _wa, \"Paths crossing\" ); }\n    \t    if( !isPw2( _now ^ _lst ) ) \n\t\t\t  { quitf( _wa, \"Wrong path format\" ); }\n    \t    _lst = _now; MP[_now] = true; }\n    \t\n    \tif( _lst != T ) quitf( _wa, \"Wrong path ending\" );\n\t}\n\t\n\tquitf( _ok, \"Accepted\" );\n\t\n    return 0;\n} \n```\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2020] 高维", "background": "> 本质上，幻想乡是高维的。", "description": "Cirno 捕获了一只 $n$ 维蚂蚁，它想从 $S(0,0,...,0)$ 爬到 $T(1,1,...,1)$ 。\n\n被封闭在这个 $1\\times1\\times...\\times1$ 的方格中，蚂蚁每一步只能爬向一个坐标相邻的点。\n\n现在 Cirno 想考考你蚂蚁最多能找到多少条从 $S$ 到 $T$ 的路径两两没有交点( 除 $S$, $T$ )。\n\n并要求你构造这样一组路径。", "inputFormat": "一行，一个整数 $n$ 。", "outputFormat": "第一行，一个整数 $t$，表示最多的路径数。\n\n以下 $t$ 行，每行一条合法路径。\n\n合法路径表示方式 :\n\n> $S$ [空格] $P_1$ [空格] $P_2$ [空格] ... [空格] $T$\n\n其中 $P_i$ 是一个二进制压缩的 $01$ 串 表示一个 $n$ 维坐标。\n\n**请不要输出多余的空格**。", "hint": "**「本题使用 Special Judge」**\n\n### Sample1解释\n\n第 $1$ 条路径：$(0,0) \\rightarrow (0,1) \\rightarrow (1,1)$\n\n第 $2$ 条路径：$(0,0) \\rightarrow (1,0) \\rightarrow (1,1)$\n\n二者除了 $S$ 与 $T$ 无交点。\n\n### 数据范围约定\n\n**「本题不采用捆绑测试，数据有梯度」**\n\n对于 100% 的数据 $3 \\le n \\le 60$。\n\n### 后置代码片段\n\n - 二进制压位函数\n\n```cpp\n/**\n * For only cpp11, cpp14, cpp17, cpp20.\n *\n * @param: __s : The binary high-dimension position inputed.\n * @return: Standard output format( U64 ).\n**/\n\nunsigned long long zip( std::string __s ) \n  { unsigned long long __r = 0;\n    for( auto __c : __s ) \n      { ( __r <<= 1ull ) |= ( __c - 0x30 ); }\n    return __r; }\n\n```\n - SPJ代码\n```cpp\n//SPJ\n#include \"testlib.h\"\n#include<bits/stdc++.h>\n\ntypedef unsigned long long ULL;\ntypedef std::vector<std::string> SEQ;\ntypedef std::string STR;\n\nSEQ split( std::string _par, char _sgn )\n  { SEQ _rat = SEQ();\n\tSTR _rem = STR();\n\t\n    for( char __c : _par )\n      { if( __c = _sgn ) _rat.push_back( _rem ), _rem = \"\";\n\t    else _rem += __c; }\n\t\n\tif( _rem != \"\" ) _rat.push_back( _rem );\n\t\n\treturn _rat; }\n\nULL to_ULL( std::string _str ) \n  { ULL _rat = 0;\n\t\n\tfor( char __c : _str )\n\t  { ( _rat *= 10ull ) += (ULL)( __c - '0' ); }\n\t\n\treturn _rat; }\n\nbool isPw2( ULL x )\n  { return !( x & (x - 1ull) ); }\n\nstd::map<ULL, bool> MP;\n\nint main(int argc, char* argv[]) {\n    registerTestlibCmd(argc, argv);\n\t\n\tULL n = inf.readLong();\n\tULL S = 0, T = (1ull << n) - 1ull;\n\tULL N = ouf.readLong();\n\t\n\tif( N != n ) quitf( _wa, \"Count paths wrongly.\" );\n\t\n\touf.readEoln();\n\t\n    while( n -- ) {\n    \tstd::string path = ouf.readLine();\n    \n    \tULL _lst = 0;\n    \t\n    \tfor( auto N : split( path, \" \" ) )\n    \t  { ULL _now = to_ULL( N );\n    \t\tif( _now != S and _now != T and MP[_now] ) \n\t\t\t  { quitf( _wa, \"Paths crossing\" ); }\n    \t    if( !isPw2( _now ^ _lst ) ) \n\t\t\t  { quitf( _wa, \"Wrong path format\" ); }\n    \t    _lst = _now; MP[_now] = true; }\n    \t\n    \tif( _lst != T ) quitf( _wa, \"Wrong path ending\" );\n\t}\n\t\n\tquitf( _ok, \"Accepted\" );\n\t\n    return 0;\n} \n```\n", "locale": "zh-CN"}}}
{"pid": "P6162", "type": "P", "difficulty": 5, "samples": [["10 5", "42525"], ["642 357", "409821948"], ["666666 233333", "791003566"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "组合数学", "容斥原理", "Stirling 数"], "title": "[Cnoi2020] 四角链", "background": "> 四角链图是一种常见的四角网络，属于仙人掌图，通常不会出现在重掺杂单晶尾部的横截面上，呈现的一组其外围是杂质富集条纹的封闭的不是四角环状网络。但因为其复杂的特点，所以常出现在描述社群联系的情景中，例如一些众所周知不可描述的......\n\n作为一个聪明活泼的女孩子，Cirno 厌倦了教科书式冗长乏味的概念，直接给出了四角链图的图示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/38vmj7jc.png)", "description": "事实上四角链可以抽象为 $1\\times (n - 1)$ 网格，每个格子被分别编号为 $1$, $2$, .... , $n-1$。\n\n每个格子可以有两种选择 :\n - 不填数\n - 填入一个小于或等于自己编号的正整数\n\n当一种填数方案 **不存在两个格子填的数相同** 时，Cirno 称之为合法方案。\n\nCirno 想知道有且仅有 $k$ 个格子填入了数字的合法方案数对 $998244353$ 取模后的结果。", "inputFormat": "一行，两个整数 $n$, $k$。", "outputFormat": "一行，一个整数，表示答案。", "hint": "### 数据范围约定\n\n**「本题采用捆绑测试」**\n\n - Subtask1( $20\\%$ ) : $n,k \\le 10$\n - Subtask2( $20\\%$ ) : $n,k \\le 1000$\n - Subtask3( $60\\%$ ) : 无特殊限制\n\n对于 $100\\%$ 的数据 : $0 \\le k < n \\le 10^6$。\n\n### 说明\n\n - 以下文献没有阅读必要。\n\n### Reference\n\n - [1] 中国知网 - 四角链的一些极值问题 - 厦门大学 - 曾艳秋  \nhttp://kns.cnki.net/KCMS/detail/detail.aspx?dbcode=CMFD&filename=2007056552.nh\n - [2] 中国知网 - 关于四角仙人掌图的海明优美性 - 吉林工程技术师范学院教育技术中心;海南大学理工学院 - 李秀芬;潘伟  \nhttp://www.cnki.com.cn/Article/CJFDTotal-CCYD200806009.htm", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2020] Quadrilateral Chain", "background": "> A quadrilateral chain graph is a common quadrilateral network. It belongs to cactus graphs. It usually does not appear in the cross-section at the tail of a heavily doped single crystal. What appears is a closed non-quadrilateral ring network whose outer boundary is a set of impurity-enriched stripes. However, because of its complex characteristics, it often appears in scenarios describing community connections, such as some well-known indescribable ones...\n\nAs a smart and lively girl, Cirno got tired of the textbook-style long and boring concepts, and directly gave the diagram of a quadrilateral chain graph.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/38vmj7jc.png)", "description": "In fact, a quadrilateral chain can be abstracted as a $1\\times (n - 1)$ grid. Each cell is numbered $1$, $2$, $\\ldots$, $n-1$, respectively.\n\nEach cell can take one of two choices:\n- Leave it empty.\n- Fill in a positive integer that is less than or equal to its own index.\n\nIf a filling scheme **does not have two cells filled with the same number**, Cirno calls it a valid scheme.\n\nCirno wants to know the number of valid schemes in which exactly $k$ cells are filled with numbers, modulo $998244353$.", "inputFormat": "One line containing two integers $n$, $k$.", "outputFormat": "One line containing one integer, the answer.", "hint": "### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 ( $20\\%$ ): $n,k \\le 10$.\n- Subtask 2 ( $20\\%$ ): $n,k \\le 1000$.\n- Subtask 3 ( $60\\%$ ): no special constraints.\n\nFor $100\\%$ of the testdata: $0 \\le k < n \\le 10^6$.\n\n### Notes\n\n- The following references are not necessary to read.\n\n### Reference\n\n- [1] CNKI - Some Extremal Problems of Quadrilateral Chains - Xiamen University - Zeng Yanqiu  \nhttp://kns.cnki.net/KCMS/detail/detail.aspx?dbcode=CMFD&filename=2007056552.nh\n- [2] CNKI - On the Hamming Gracefulness of Quadrilateral Cactus Graphs - Education Technology Center, Jilin Engineering and Technical Teachers College; College of Science and Engineering, Hainan University - Li Xiufen; Pan Wei  \nhttp://www.cnki.com.cn/Article/CJFDTotal-CCYD200806009.htm\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2020] 四角链", "background": "> 四角链图是一种常见的四角网络，属于仙人掌图，通常不会出现在重掺杂单晶尾部的横截面上，呈现的一组其外围是杂质富集条纹的封闭的不是四角环状网络。但因为其复杂的特点，所以常出现在描述社群联系的情景中，例如一些众所周知不可描述的......\n\n作为一个聪明活泼的女孩子，Cirno 厌倦了教科书式冗长乏味的概念，直接给出了四角链图的图示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/38vmj7jc.png)", "description": "事实上四角链可以抽象为 $1\\times (n - 1)$ 网格，每个格子被分别编号为 $1$, $2$, .... , $n-1$。\n\n每个格子可以有两种选择 :\n - 不填数\n - 填入一个小于或等于自己编号的正整数\n\n当一种填数方案 **不存在两个格子填的数相同** 时，Cirno 称之为合法方案。\n\nCirno 想知道有且仅有 $k$ 个格子填入了数字的合法方案数对 $998244353$ 取模后的结果。", "inputFormat": "一行，两个整数 $n$, $k$。", "outputFormat": "一行，一个整数，表示答案。", "hint": "### 数据范围约定\n\n**「本题采用捆绑测试」**\n\n - Subtask1( $20\\%$ ) : $n,k \\le 10$\n - Subtask2( $20\\%$ ) : $n,k \\le 1000$\n - Subtask3( $60\\%$ ) : 无特殊限制\n\n对于 $100\\%$ 的数据 : $0 \\le k < n \\le 10^6$。\n\n### 说明\n\n - 以下文献没有阅读必要。\n\n### Reference\n\n - [1] 中国知网 - 四角链的一些极值问题 - 厦门大学 - 曾艳秋  \nhttp://kns.cnki.net/KCMS/detail/detail.aspx?dbcode=CMFD&filename=2007056552.nh\n - [2] 中国知网 - 关于四角仙人掌图的海明优美性 - 吉林工程技术师范学院教育技术中心;海南大学理工学院 - 李秀芬;潘伟  \nhttp://www.cnki.com.cn/Article/CJFDTotal-CCYD200806009.htm", "locale": "zh-CN"}}}
{"pid": "P6163", "type": "P", "difficulty": 5, "samples": [["3\n1 2\n2 3\n3 4", "4"], ["8\n39 42\n53 55\n51 52\n46 47\n52 54\n33 38\n2 7\n32 34", "910"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2020"], "title": "[Cnoi2020] 领域极限", "background": "", "description": "Cirno 有 $n$ 个整数，分别记作 $a_1,a_2,a_3,...,a_n$。\n\n对于每一个数 $a_i$ 都有一个限制二元组 $(l_i,r_i)$。\n\nCirno 想知道：\n\n$$\\min_{\\forall t, a_t \\in [l_t,r_t]}\\big\\{\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\left| a_i - a_j \\right|\\big\\}$$", "inputFormat": "第一行，一个整数 $n$。\n\n以下 $n$ 行，每行一个限制二元组 $(l_i,r_i)$。", "outputFormat": "一行，一个整数，表示答案。", "hint": "### Sample1说明\n\n$(a_1,a_2,a_3)=(2,3,3)$ 时，答案取到最小值。\n\n### 数据范围与约定\n\n**「本题采用捆绑测试」**\n\n - Subtask1( $20\\%$ ) : $n \\le 10$，且 $r_i - l_i \\le 5$；\n - Subtask2( $20\\%$ ) : $n \\le 20$；\n - Subtask3( $20\\%$ ) : $n \\le 10^3$；\n - Subtask4( $40\\%$ ) : $n \\le 10^5$；\n\n对于 $100\\%$ 的数据 : $n \\in (0,10^5]$，$0 \\le l_i \\le r_i \\le 10^9$，答案在 $[0,4 \\times 10^{18}]$ 内。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2020] Domain Limit", "background": "", "description": "Cirno has $n$ integers, denoted as $a_1,a_2,a_3,...,a_n$.\n\nFor each number $a_i$, there is a constraint pair $(l_i,r_i)$.\n\nCirno wants to know:\n\n$$\\min_{\\forall t, a_t \\in [l_t,r_t]}\\big\\{\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\left| a_i - a_j \\right|\\big\\}$$", "inputFormat": "The first line contains an integer $n$.\n\nThe next $n$ lines each contain a constraint pair $(l_i,r_i)$.", "outputFormat": "One line containing an integer, which is the answer.", "hint": "### Sample 1 Explanation\n\nWhen $(a_1,a_2,a_3)=(2,3,3)$, the answer reaches its minimum.\n\n### Constraints and Notes\n\n**\"This problem uses bundled testdata.\"**\n\n- Subtask 1 ( $20\\%$ ): $n \\le 10$, and $r_i - l_i \\le 5$.\n- Subtask 2 ( $20\\%$ ): $n \\le 20$.\n- Subtask 3 ( $20\\%$ ): $n \\le 10^3$.\n- Subtask 4 ( $40\\%$ ): $n \\le 10^5$.\n\nFor $100\\%$ of the testdata: $n \\in (0,10^5]$, $0 \\le l_i \\le r_i \\le 10^9$, and the answer is within $[0,4 \\times 10^{18}]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2020] 领域极限", "background": "", "description": "Cirno 有 $n$ 个整数，分别记作 $a_1,a_2,a_3,...,a_n$。\n\n对于每一个数 $a_i$ 都有一个限制二元组 $(l_i,r_i)$。\n\nCirno 想知道：\n\n$$\\min_{\\forall t, a_t \\in [l_t,r_t]}\\big\\{\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\left| a_i - a_j \\right|\\big\\}$$", "inputFormat": "第一行，一个整数 $n$。\n\n以下 $n$ 行，每行一个限制二元组 $(l_i,r_i)$。", "outputFormat": "一行，一个整数，表示答案。", "hint": "### Sample1说明\n\n$(a_1,a_2,a_3)=(2,3,3)$ 时，答案取到最小值。\n\n### 数据范围与约定\n\n**「本题采用捆绑测试」**\n\n - Subtask1( $20\\%$ ) : $n \\le 10$，且 $r_i - l_i \\le 5$；\n - Subtask2( $20\\%$ ) : $n \\le 20$；\n - Subtask3( $20\\%$ ) : $n \\le 10^3$；\n - Subtask4( $40\\%$ ) : $n \\le 10^5$；\n\n对于 $100\\%$ 的数据 : $n \\in (0,10^5]$，$0 \\le l_i \\le r_i \\le 10^9$，答案在 $[0,4 \\times 10^{18}]$ 内。", "locale": "zh-CN"}}}
{"pid": "P6164", "type": "P", "difficulty": 6, "samples": [["3\nA\nQUERY B\nADD BBABBBBAAB\nDEL 1", "0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化", "模板题"], "title": "【模板】后缀平衡树", "background": "\"后缀平衡树\"这个名字正确性存疑，由于 clj 给的\"重量平衡树\"定义有歧义。\n\n字符串我也不会，所以也没去查证。", "description": "给你一个字符串 `init`，要求你支持三个操作：\n\n1. 在当前字符串的后面插入若干个字符。\n\n2. 在当前字符串的后面删除若干个字符。\n\n3. 询问字符串 $s$ 在当前字符串中出现了几次（作为连续子串）？\n\n你必须在线支持这些操作。\n\n", "inputFormat": "第一行一个数 $q$ 表示操作个数。\n\n第二行一个字符串表示初始字符串 `init`。\n\n接下来 $q$ 行，每行 $2$ 个字符串 `Type Str`。\n \nType是 `ADD` 的话表示在后面插入。\n\nType是 `DEL` 的话表示在后面删除。\n\nType是 `QUERY` 的话表示询问某字符串在当前字符串中出现了几次。\n\n为了体现在线操作，你需要维护一个变量 `mask`，初始值为 $0$。\n\n读入串 `Str` 之后，使用这个过程将之解码成真正询问的串 `TrueStr`。\n\n询问的时候，对 `TrueStr` 询问后输出一行答案 `Result`。\n\n然后 `mask = mask xor Result`\n\n插入的时候，将 `TrueStr` 插到当前字符串后面即可。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/whqt9ff9.png)", "outputFormat": "对每个 $3$ 操作，输出一行一个整数表示答案。", "hint": "数据字符串变化长度以及初始长度和 $ \\le 8 \\times 10^5$，询问次数 $\\le 10^5$，询问总长度 $\\le 3 \\times 10^6$。\n\n字符集为大写字母，注意 `ADD` 和 `QUERY` 操作的字符串都需要解压。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】后缀平衡树", "background": "\"后缀平衡树\"这个名字正确性存疑，由于 clj 给的\"重量平衡树\"定义有歧义。\n\n字符串我也不会，所以也没去查证。", "description": "给你一个字符串 `init`，要求你支持三个操作：\n\n1. 在当前字符串的后面插入若干个字符。\n\n2. 在当前字符串的后面删除若干个字符。\n\n3. 询问字符串 $s$ 在当前字符串中出现了几次（作为连续子串）？\n\n你必须在线支持这些操作。\n\n", "inputFormat": "第一行一个数 $q$ 表示操作个数。\n\n第二行一个字符串表示初始字符串 `init`。\n\n接下来 $q$ 行，每行 $2$ 个字符串 `Type Str`。\n \nType是 `ADD` 的话表示在后面插入。\n\nType是 `DEL` 的话表示在后面删除。\n\nType是 `QUERY` 的话表示询问某字符串在当前字符串中出现了几次。\n\n为了体现在线操作，你需要维护一个变量 `mask`，初始值为 $0$。\n\n读入串 `Str` 之后，使用这个过程将之解码成真正询问的串 `TrueStr`。\n\n询问的时候，对 `TrueStr` 询问后输出一行答案 `Result`。\n\n然后 `mask = mask xor Result`\n\n插入的时候，将 `TrueStr` 插到当前字符串后面即可。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/whqt9ff9.png)", "outputFormat": "对每个 $3$ 操作，输出一行一个整数表示答案。", "hint": "数据字符串变化长度以及初始长度和 $ \\le 8 \\times 10^5$，询问次数 $\\le 10^5$，询问总长度 $\\le 3 \\times 10^6$。\n\n字符集为大写字母，注意 `ADD` 和 `QUERY` 操作的字符串都需要解压。", "locale": "zh-CN"}}}
{"pid": "P6165", "type": "P", "difficulty": 5, "samples": [["100 84\n30 79\n26 63\n96 30\n17 97\n33 63\n73 25\n17 7\n96 48\n80 6\n3 34\n51 48\n33 37\n89 7\n72 65\n51 54\n49 37\n45 72\n50 39\n95 89\n3 55\n25 0\n2 54\n10 91\n59 2\n29 46\n0 40\n95 68\n69 45\n87 68\n49 38\n20 69\n87 15\n35 39\n59 47\n38 62\n91 19\n35 70\n83 19\n28 20\n70 24\n36 55\n75 36\n28 12\n53 29\n12 16\n75 84\n40 85\n27 53\n58 62\n88 84\n44 27\n76 24\n58 22\n8 44\n94 15\n14 94\n5 83\n31 85\n90 5\n88 42\n81 47\n76 67\n82 80\n31 93\n14 74\n42 98\n99 82\n71 8\n98 92\n18 22\n81 52\n99 23\n41 67\n74 1\n93 56\n4 52\n1 86\n92 60\n56 66\n18 61\n16 57\n43 23\n4 64\n-1\n", "100\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "IOI", "O2优化"], "title": "[IOI 2012] rings", "background": "", "description": "在李奥纳多的文献  \"Codex  Atlanticus\"  中描述了一种早期而复杂的降落伞。李奥纳多的降落伞是一个由布料缝制而成的金字塔型木头结构。\n\n**串接的圆环**\n\n空中自由落体玩家 Adrain Nicholas （爱准尼古拉斯） 在五百年后测试了李奥纳多的设计。在这个测试中，一个现代的轻量结构将李奥纳多的降落伞使用到人体。我们想要使用串接的圆环，这些圆环为缝制的布料提供了钩子。圆环可以很简单地串接在一起，而且每一个圆环可以打开或关闭。串接的圆环可以构成一种特殊的型态叫做\"链\"（chain）。所谓的\"链\"指的是一序列串接的圆环，每个圆环可以串接（最多两个）邻居。但是这个序列必须有个起头与结束（这两个圆环只能串接另外一个圆环）。如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w6zr6nns.png)\n\n其他种串接型态当然是可能的，因为一个圆环可以串接到3个或更多的圆环。我们说一个圆环是\"关键的\"如果我们将它打开并移除这个圆环，其他的圆环会形成互无交集的链的集合(或者是没有任何的圆环留下)。\n\n**例子**\n\n请参考下图中的 $7$ 个圆环，其编号由 $0$ 到 $6$。在这个例子中有两个\"关键\"圆环。其中一个关键圆环是编号 $2$ 的圆环。移除此圆环，剩下的圆环形成三条链 $[1]$, $[0,5,3,4]$ 以及 $[6]$。另外一个关键圆环是编号 $3$ 的圆环，移除此圆环，剩下的圆环形成三条链 $[1,2,0,5]$,$[4]$，以及 $[6]$。如果我们尝试着移除其他的圆环，我们无法获得互无交集的链集合。举例来说，移除编号 $5$ 的圆环之后，虽然可以获得 $[6]$ 这样的一条链，但是 $0,1,2,3$ 以及 $4$ 并没有形成一条链。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wk40d8go.png)\n\n**任务**\n\n给定一个串接的圆环型态，你的程序必须计算其关键圆环的个数。\n", "inputFormat": "- 第一行，有 $2$ 个整数 $N$，$L$。$N$ 代表有 $N$ 个互无交集的圆环，其编号从 $0$ 到 $N-1$ 作为初始的圆环形态，$L$ 表示操作的个数。\n\n- 第 $2$ 到 $L+1$ 行，每行包含 $1$ 或 $2$ 个整数，表示一个操作。具体如下：\n\n1.`A B` 表示将编号 $A$ 以及编号 $B$ 的圆环串联在一起。保证 $A$ 和 $B$ 不相同。\n\n2.`-1` 输出一行，目前串接圆环的组态中关键圆环的个数。", "outputFormat": "对于每项 $2$ 操作，输出一行，表示当时串接圆环的组态中关键圆环的个数。", "hint": "对于 $100\\%$ 的数据，$1 \\le N,L \\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[IOI 2012] rings", "background": "", "description": "在李奥纳多的文献  \"Codex  Atlanticus\"  中描述了一种早期而复杂的降落伞。李奥纳多的降落伞是一个由布料缝制而成的金字塔型木头结构。\n\n**串接的圆环**\n\n空中自由落体玩家 Adrain Nicholas （爱准尼古拉斯） 在五百年后测试了李奥纳多的设计。在这个测试中，一个现代的轻量结构将李奥纳多的降落伞使用到人体。我们想要使用串接的圆环，这些圆环为缝制的布料提供了钩子。圆环可以很简单地串接在一起，而且每一个圆环可以打开或关闭。串接的圆环可以构成一种特殊的型态叫做\"链\"（chain）。所谓的\"链\"指的是一序列串接的圆环，每个圆环可以串接（最多两个）邻居。但是这个序列必须有个起头与结束（这两个圆环只能串接另外一个圆环）。如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w6zr6nns.png)\n\n其他种串接型态当然是可能的，因为一个圆环可以串接到3个或更多的圆环。我们说一个圆环是\"关键的\"如果我们将它打开并移除这个圆环，其他的圆环会形成互无交集的链的集合(或者是没有任何的圆环留下)。\n\n**例子**\n\n请参考下图中的 $7$ 个圆环，其编号由 $0$ 到 $6$。在这个例子中有两个\"关键\"圆环。其中一个关键圆环是编号 $2$ 的圆环。移除此圆环，剩下的圆环形成三条链 $[1]$, $[0,5,3,4]$ 以及 $[6]$。另外一个关键圆环是编号 $3$ 的圆环，移除此圆环，剩下的圆环形成三条链 $[1,2,0,5]$,$[4]$，以及 $[6]$。如果我们尝试着移除其他的圆环，我们无法获得互无交集的链集合。举例来说，移除编号 $5$ 的圆环之后，虽然可以获得 $[6]$ 这样的一条链，但是 $0,1,2,3$ 以及 $4$ 并没有形成一条链。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wk40d8go.png)\n\n**任务**\n\n给定一个串接的圆环型态，你的程序必须计算其关键圆环的个数。\n", "inputFormat": "- 第一行，有 $2$ 个整数 $N$，$L$。$N$ 代表有 $N$ 个互无交集的圆环，其编号从 $0$ 到 $N-1$ 作为初始的圆环形态，$L$ 表示操作的个数。\n\n- 第 $2$ 到 $L+1$ 行，每行包含 $1$ 或 $2$ 个整数，表示一个操作。具体如下：\n\n1.`A B` 表示将编号 $A$ 以及编号 $B$ 的圆环串联在一起。保证 $A$ 和 $B$ 不相同。\n\n2.`-1` 输出一行，目前串接圆环的组态中关键圆环的个数。", "outputFormat": "对于每项 $2$ 操作，输出一行，表示当时串接圆环的组态中关键圆环的个数。", "hint": "对于 $100\\%$ 的数据，$1 \\le N,L \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P6166", "type": "P", "difficulty": 5, "samples": [["10\nT c\nT z\nT u\nT a\nT i\nT h\nT f\nT z\nP 3\nP 0\n", "a\nc\n"], ["98\nT u\nT g\nT p\nT h\nT w\nP 3\nP 0\nT d\nT d\nT r\nT v\nT z\nT w\nT h\nP 0\nT d\nT v\nT b\nP 9\nT n\nT e\nP 0\nT s\nT i\nT a\nP 6\nT b\nT n\nT m\nT t\nT m\nT g\nT y\nT g\nP 0\nT m\nP 18\nT r\nP 17\nT w\nT w\nT o\nT m\nT m\nP 0\nT q\nP 5\nT t\nP 27\nP 34\nT p\nT f\nT h\nT j\nT f\nT l\nP 3\nT f\nT q\nT h\nP 17\nT w\nT d\nT p\nT z\nP 0\nT m\nP 10\nT o\nP 5\nP 18\nP 7\nT q\nT z\nP 2\nT u\nP 10\nT e\nP 6\nT s\nT t\nP 24\nT s\nP 0\nT t\nT c\nP 4\nT j\nT o\nP 5\nT i\nP 11\nT a\nT t\nP 58\nP 51\nP 64\nP 12\n", "h\nu\nu\nz\nu\nd\nu\ni\ns\nu\nd\ng\nm\nh\ns\nu\nw\nd\ni\nr\np\nw\nd\nm\nu\nw\nd\nh\ns\no\na\nd\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "倍增", "IOI", "可持久化线段树", "可持久化"], "title": "[IOI 2012] scrivener", "background": "", "description": "有些人说李奥纳多是一个对于 Johannes  Gutenberg 的崇拜者，Johannes 是一个发明活字印刷的德国铁匠，为了表达尊敬，李奥纳多设计了一台机器被称为小龙虾代书，那是一个非常简单的打字设备。这机器就像一部简单的现代打字机，但只能接受两个指令。一个指令是 输出一个字符，另一个指令是取消最近的指令。小龙虾代书的最大特点就是拥有这个功能强大的取消指令。因为一个取消指令本身也是一个指令，所以也可以被取消。\n\n**说明**\n\n你的任务是作出此小龙虾代书的程序，一开始并无输出任何文字，然后开始接受使用者输入的一连串指令，并可查询目前输出文字中的特定位置的字符。详细说明如下:\n\n- `TypeLetter(L)` —附加一个小写字母L在输出文字的最后，$L$ 可以是 $a,b,\\cdots, z$。\n\n- `UndoCommands(U)` — 取消之前的 $U$ 个指令，$U$ 是一个正整数。\n\n- `GetLetter(P)` — 回传在输出文字中位置为 $P$ 的字符，$P$ 是一个非负整数。 输出文字中的第一个字符的位置为 $0$。 （这个查询并不是一个指令，因此会被取消指令忽略。）\n\n三种操作可以依照任何顺序被呼叫 $0$ 次或多次以上。\n\n指令 `UndoCommands(U)` 会依照原本执行的相反顺序来取消前面 $U$ 个指令: 如果被取消的指令是 `TypeLetter(L)`，就会从输出文字最后面移除字母 $L$。如果被取消的指令是 `UndoCommands(X)`，那么将会依照原本执行的顺序重新执行之前被取消的 $X$ 个指令。\n\n**范例**\n\n我们列出一连串可能的指令，以及每次执行指令后的输出文字。\n\n| 操作 | 回传 | 输出文字 |\n| :-----------: | :-----------: | :-----------: |\n| `TypeLetter(a)` |  | `a` |\n| `TypeLetter(b)` |  | `ab` |\n| `GetLetter(1)` | `b` | `ab` |\n| `TypeLetter(d)` |  | `abd` |\n| `UndoCommands(2)` |  | `a` |\n| `UndoCommands(1)` |  | `abd` |\n| `GetLetter(2)` | `d` | `abd` |\n|  `TypeLetter(e)`|  | `abde` |\n| `UndoCommands(1)` |  | `abd` |\n| `UndoCommands(5)` |  | `ab` |\n|`TypeLetter(c)`  |  | `abc` |\n| `GetLetter(2)` | `c` | `abc` |\n| `UndoCommands(2)` |  | `abd` |\n| `GetLetter(2)` | `d` | `abd` |\n", "inputFormat": "- 第 $1$ 行，一个正整数 $N$，表示操作的个数。\n\n- 第 $2$ 到 $N+1$ 行，每行开始有一个大写字母参数。\n\n1. `T` 表示一个 `TypeLetter` 指令，后面接着一个空白和一个小写字母参数。\n\n2. `U` 表示一个 `UndoCommands` 指令，后面接着一个空白和一个整数参数。\n\n3. `P` 表示一个 `GetLetter` 指令，后面接着一个空白和一个整数参数。", "outputFormat": "对于每项 `GetLetter` 操作，输出一行，一个回传的字符。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 10^6$。参数 $U$ 保证不会超过前面已经输入的指令数目，而且参数 $P$ 一定小于输出文字的长度（也就是输出文字的字母数）。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[IOI 2012] scrivener", "background": "", "description": "有些人说李奥纳多是一个对于 Johannes  Gutenberg 的崇拜者，Johannes 是一个发明活字印刷的德国铁匠，为了表达尊敬，李奥纳多设计了一台机器被称为小龙虾代书，那是一个非常简单的打字设备。这机器就像一部简单的现代打字机，但只能接受两个指令。一个指令是 输出一个字符，另一个指令是取消最近的指令。小龙虾代书的最大特点就是拥有这个功能强大的取消指令。因为一个取消指令本身也是一个指令，所以也可以被取消。\n\n**说明**\n\n你的任务是作出此小龙虾代书的程序，一开始并无输出任何文字，然后开始接受使用者输入的一连串指令，并可查询目前输出文字中的特定位置的字符。详细说明如下:\n\n- `TypeLetter(L)` —附加一个小写字母L在输出文字的最后，$L$ 可以是 $a,b,\\cdots, z$。\n\n- `UndoCommands(U)` — 取消之前的 $U$ 个指令，$U$ 是一个正整数。\n\n- `GetLetter(P)` — 回传在输出文字中位置为 $P$ 的字符，$P$ 是一个非负整数。 输出文字中的第一个字符的位置为 $0$。 （这个查询并不是一个指令，因此会被取消指令忽略。）\n\n三种操作可以依照任何顺序被呼叫 $0$ 次或多次以上。\n\n指令 `UndoCommands(U)` 会依照原本执行的相反顺序来取消前面 $U$ 个指令: 如果被取消的指令是 `TypeLetter(L)`，就会从输出文字最后面移除字母 $L$。如果被取消的指令是 `UndoCommands(X)`，那么将会依照原本执行的顺序重新执行之前被取消的 $X$ 个指令。\n\n**范例**\n\n我们列出一连串可能的指令，以及每次执行指令后的输出文字。\n\n| 操作 | 回传 | 输出文字 |\n| :-----------: | :-----------: | :-----------: |\n| `TypeLetter(a)` |  | `a` |\n| `TypeLetter(b)` |  | `ab` |\n| `GetLetter(1)` | `b` | `ab` |\n| `TypeLetter(d)` |  | `abd` |\n| `UndoCommands(2)` |  | `a` |\n| `UndoCommands(1)` |  | `abd` |\n| `GetLetter(2)` | `d` | `abd` |\n|  `TypeLetter(e)`|  | `abde` |\n| `UndoCommands(1)` |  | `abd` |\n| `UndoCommands(5)` |  | `ab` |\n|`TypeLetter(c)`  |  | `abc` |\n| `GetLetter(2)` | `c` | `abc` |\n| `UndoCommands(2)` |  | `abd` |\n| `GetLetter(2)` | `d` | `abd` |\n", "inputFormat": "- 第 $1$ 行，一个正整数 $N$，表示操作的个数。\n\n- 第 $2$ 到 $N+1$ 行，每行开始有一个大写字母参数。\n\n1. `T` 表示一个 `TypeLetter` 指令，后面接着一个空白和一个小写字母参数。\n\n2. `U` 表示一个 `UndoCommands` 指令，后面接着一个空白和一个整数参数。\n\n3. `P` 表示一个 `GetLetter` 指令，后面接着一个空白和一个整数参数。", "outputFormat": "对于每项 `GetLetter` 操作，输出一行，一个回传的字符。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 10^6$。参数 $U$ 保证不会超过前面已经输入的指令数目，而且参数 $P$ 一定小于输出文字的长度（也就是输出文字的字母数）。", "locale": "zh-CN"}}}
{"pid": "P6167", "type": "P", "difficulty": 7, "samples": [["4 10\n10 20 20\n0 40 0 30\n", "80\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "IOI", "Special Judge", "O2优化"], "title": "[IOI 2016] shortcut", "background": "", "description": "Pavel 有一个非常简单的铁路玩具。 它有一条含有 $n$ 个车站的主干线并且连续编号为 $0$ 到 $n-1$。车站 $0$ 和车站 $n-1$ 就在这条主干线的两端。其中车站 $i$ 和车站 $i+1$ 之间的距离为 $l_i$ 厘米（$ 0 \\le i<n-1$）。\n\n除了这条主干线之外，这个铁路也许会有些支线。每条支线都是由主干线中的一个车站和主干线 外的一个新车站之间的一条新铁路构成（这些新的车站不会被编号）。在主干线中的一个车站最多只能有一条支线。以主干线中的车站 $i$ 为起点的支线的长度为 $d_i$ 厘米。我们用 $d_i=0$ 来表示车站 $i$ 没有支线。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h21s6cjy.png)\n\nPavel 现正规划一条快捷方式：一条在主干线中两个不相同的车站之间（它们可能相邻）的快速干线。这条快速干线无论是连接哪两个车站，它的长度都将会恰好是 $c$ 厘米。\n\n铁路中的每一段，包括那条新的快速干线，都能够双向行驶。任意两个车站的距离就是它们之间沿着铁路由一个车站到另一个车站之间最短路径的长度。所有车站组合中最大的距离就叫做整个铁路网络的直径。换句话说，存在一个最小值 $t$ 使任意两个车站之间的距离都不会超过 $t$。\n\nPavel 就是想建造一条快速干线，使得有了这条快速干线后新的铁路网络的直径能达到最小值。\n\n### 样例一\n\n```\n4 10\n10 20 20\n0 40 0 30\n```\n\n最优解是在车站 $1$ 和车站 $3$ 之间建造一条快速干线，如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a31c6opk.png)\n\n这个新铁路网络的直径是 $80$ 厘米，所以应该输出数值 $80$。\n\n### 样例二\n\n```\n9 30\n10 10 10 10 10 10 10 10\n20 0 30 0 0 40 0 40 0\n```\n\n最优解是连接车站 $2$ 和车站 $7$，这个解的直径是 $110$。\n\n### 样例三\n\n```\n4 1\n2 2 2\n1 10 10 1\n```\n最优解是连接车站 $1$ 和车站 $2$，这样直径将被缩短到 $21$。\n\n### 样例四\n\n```\n3 3\n1 1 \n1 1 1\n```\n在任意两个车站中建立长度为 $3$ 的快速干线都不会改进整个铁路网络的直径，因此其直径仍为初始值 $4$。\n\n", "inputFormat": "- 第一行：两个整数 $n$ 和 $c$，\n\n- 第二行：整数 $l_0,l_1,\\cdots,l_{n-2}$，\n\n- 第三行：整数 $d_0,d_1,\\cdots,d_{n-1}$。", "outputFormat": "共一行，加入新快速干线后铁路网络直径的最小可能值。", "hint": "对于 $100\\%$ 的数据，$2\\le n\\le 10^6$，$1\\le l_i\\le 10^9$，$0\\le d_i\\le 10^9$，$1\\le c\\le 10^9$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[IOI 2016] shortcut", "background": "", "description": "Pavel 有一个非常简单的铁路玩具。 它有一条含有 $n$ 个车站的主干线并且连续编号为 $0$ 到 $n-1$。车站 $0$ 和车站 $n-1$ 就在这条主干线的两端。其中车站 $i$ 和车站 $i+1$ 之间的距离为 $l_i$ 厘米（$ 0 \\le i<n-1$）。\n\n除了这条主干线之外，这个铁路也许会有些支线。每条支线都是由主干线中的一个车站和主干线 外的一个新车站之间的一条新铁路构成（这些新的车站不会被编号）。在主干线中的一个车站最多只能有一条支线。以主干线中的车站 $i$ 为起点的支线的长度为 $d_i$ 厘米。我们用 $d_i=0$ 来表示车站 $i$ 没有支线。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h21s6cjy.png)\n\nPavel 现正规划一条快捷方式：一条在主干线中两个不相同的车站之间（它们可能相邻）的快速干线。这条快速干线无论是连接哪两个车站，它的长度都将会恰好是 $c$ 厘米。\n\n铁路中的每一段，包括那条新的快速干线，都能够双向行驶。任意两个车站的距离就是它们之间沿着铁路由一个车站到另一个车站之间最短路径的长度。所有车站组合中最大的距离就叫做整个铁路网络的直径。换句话说，存在一个最小值 $t$ 使任意两个车站之间的距离都不会超过 $t$。\n\nPavel 就是想建造一条快速干线，使得有了这条快速干线后新的铁路网络的直径能达到最小值。\n\n### 样例一\n\n```\n4 10\n10 20 20\n0 40 0 30\n```\n\n最优解是在车站 $1$ 和车站 $3$ 之间建造一条快速干线，如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a31c6opk.png)\n\n这个新铁路网络的直径是 $80$ 厘米，所以应该输出数值 $80$。\n\n### 样例二\n\n```\n9 30\n10 10 10 10 10 10 10 10\n20 0 30 0 0 40 0 40 0\n```\n\n最优解是连接车站 $2$ 和车站 $7$，这个解的直径是 $110$。\n\n### 样例三\n\n```\n4 1\n2 2 2\n1 10 10 1\n```\n最优解是连接车站 $1$ 和车站 $2$，这样直径将被缩短到 $21$。\n\n### 样例四\n\n```\n3 3\n1 1 \n1 1 1\n```\n在任意两个车站中建立长度为 $3$ 的快速干线都不会改进整个铁路网络的直径，因此其直径仍为初始值 $4$。\n\n", "inputFormat": "- 第一行：两个整数 $n$ 和 $c$，\n\n- 第二行：整数 $l_0,l_1,\\cdots,l_{n-2}$，\n\n- 第三行：整数 $d_0,d_1,\\cdots,d_{n-1}$。", "outputFormat": "共一行，加入新快速干线后铁路网络直径的最小可能值。", "hint": "对于 $100\\%$ 的数据，$2\\le n\\le 10^6$，$1\\le l_i\\le 10^9$，$0\\le d_i\\le 10^9$，$1\\le c\\le 10^9$。\n\n", "locale": "zh-CN"}}}
{"pid": "P6168", "type": "P", "difficulty": 7, "samples": [["4 1\n1 7\n4 3\n5 8\n6 6\n", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "IOI", "Special Judge"], "title": "[IOI 2016] railroad", "background": null, "description": "Anna 在一个游乐园工作。她负责建造一个新的过山车铁路。她已经设计了影响过山车速度的 $n$ 个特殊的路段（方便起见标记为 $0$ 到 $n-1$）。现在 Anna 必须要把这些特殊的路段放在一起并提出一个过山车的最后设计。为了简化问题，你可以假设过山车的长度为零。\n\n对于 $0$ 和 $n-1$ 之间的每个 $i$，这个特殊的路段 $i$ 具有如下两个性质：\n\n- 当进入这个路段时，有一个速度限制：过山车的速度必须小于或等于 $s_i$ $\\text{km/h}$（每小时千米）。\n\n- 当离开这个路段时，过山车的速度刚好是 $t_i$ $\\text{km/h}$，不管过山车进入该路段时的速度如何。\n\n最后完成的过山车设计是一个以某种顺序包含这 $n$ 个特殊路段的单一铁路线。这 $n$ 个路段中的每一个应当被使用刚好一次。连续的路段之间用铁轨来连接。Anna 应该选择这 $n$ 个路段的顺序，然后确定每段铁轨的长度。铁轨的长度以米来衡量，可以是任意的非负整数（可以为零）。\n\n两个特殊路段之间的每 $1$ 米铁轨可以将过山车的速度减慢 $1$ $\\text{km/h}$。在这个过山车铁路的起点，过山车按照 Anna 选择的顺序进入第一个特殊路段时的速度是 $1$ $\\text{km/h}$。\n\n最后的设计还必须满足以下要求：\n\n- 过山车在进入这些特殊路段时不能违反任一个速度限制。\n\n- 过山车的速度在任意时刻为正。\n\n你的任务是找出这些路段之间铁轨的最小可能总长度（这些路段之间铁轨总长度的最小值）。如果 $m=0$ 你只需要检查是否存在一个有效的过山车设计，使得每段铁轨的长度为零。\n\n**举例**\n\n```\n4 1\n1 7\n4 3\n5 8\n6 6\n```\n在这个样例中有 $4$ 个特殊的路段。最好的解是按照 $0,3,1,2$ 的顺序构造，连接这些路段的铁轨长度分别是 $1,2,0$。下面给出过山车沿铁路铁轨的行驶方式：\n\n- 最初过山车的速度是 $1$ km/h。\n\n- 过山车由进入 $0$ 号路段开始行进。\n\n- 过山车以 $7$ $\\text{km/h}$ 的速度离开 00 号路段。\n\n- 然后有一段长度为 $1$ $\\text{m}$ 的铁轨。过山车在到达这段铁轨的末端时速度为 $6$ $\\text{km/h}$。\n\n- 过山车以 $6$ $\\text{km/h}$ 的速度进入 $3$ 号路段并以相同的速度离开该路段。\n\n- 在离开 $3$ 号路段后，过山车走过一段 $2$ $\\text{m}$ 长的铁轨。速度降至 $4$ $\\text{km/h}$。\n\n- 过山车以 $4$ $\\text{km/h}$ 的速度进入 $1$ 号路段，并且以 $3$ $\\text{km/h}$ 的速度离开该路段。\n\n- 离开 $1$ 号路段后，过山车立即进入 $2$ 号路段。\n\n- 过山车离开 $2$ 号路段。其最终速度是 $8$ $\\text{km/h}$。\n\n路段之间的铁轨总长度：$1+2+0=3$。", "inputFormat": "- 第一行：两个整数 $n$ 和 $m$，其中 $m=0$ 表示当答案不为 $0$ 时，你可以返回任意正整数，$m=1$ 表示你需要返回正确答案。\n\n- 接下来 $n$ 行：第 $i$ 行的两个整数表示 $s_{i-1}$ 和 $t_{i-1}$。", "outputFormat": "共一行，所有铁轨的最小可能总长度。（当 $m=0$ 时，如果存在一个有效的过山车设计使得每段铁轨的长度均为零，则函数返回零，如果上述设计不存在，则输出任意的正整数）。", "hint": "对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$ 1 \\le s_i \\le 10^9$，$1 \\le t_i \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[IOI 2016] railroad", "background": null, "description": "Anna 在一个游乐园工作。她负责建造一个新的过山车铁路。她已经设计了影响过山车速度的 $n$ 个特殊的路段（方便起见标记为 $0$ 到 $n-1$）。现在 Anna 必须要把这些特殊的路段放在一起并提出一个过山车的最后设计。为了简化问题，你可以假设过山车的长度为零。\n\n对于 $0$ 和 $n-1$ 之间的每个 $i$，这个特殊的路段 $i$ 具有如下两个性质：\n\n- 当进入这个路段时，有一个速度限制：过山车的速度必须小于或等于 $s_i$ $\\text{km/h}$（每小时千米）。\n\n- 当离开这个路段时，过山车的速度刚好是 $t_i$ $\\text{km/h}$，不管过山车进入该路段时的速度如何。\n\n最后完成的过山车设计是一个以某种顺序包含这 $n$ 个特殊路段的单一铁路线。这 $n$ 个路段中的每一个应当被使用刚好一次。连续的路段之间用铁轨来连接。Anna 应该选择这 $n$ 个路段的顺序，然后确定每段铁轨的长度。铁轨的长度以米来衡量，可以是任意的非负整数（可以为零）。\n\n两个特殊路段之间的每 $1$ 米铁轨可以将过山车的速度减慢 $1$ $\\text{km/h}$。在这个过山车铁路的起点，过山车按照 Anna 选择的顺序进入第一个特殊路段时的速度是 $1$ $\\text{km/h}$。\n\n最后的设计还必须满足以下要求：\n\n- 过山车在进入这些特殊路段时不能违反任一个速度限制。\n\n- 过山车的速度在任意时刻为正。\n\n你的任务是找出这些路段之间铁轨的最小可能总长度（这些路段之间铁轨总长度的最小值）。如果 $m=0$ 你只需要检查是否存在一个有效的过山车设计，使得每段铁轨的长度为零。\n\n**举例**\n\n```\n4 1\n1 7\n4 3\n5 8\n6 6\n```\n在这个样例中有 $4$ 个特殊的路段。最好的解是按照 $0,3,1,2$ 的顺序构造，连接这些路段的铁轨长度分别是 $1,2,0$。下面给出过山车沿铁路铁轨的行驶方式：\n\n- 最初过山车的速度是 $1$ km/h。\n\n- 过山车由进入 $0$ 号路段开始行进。\n\n- 过山车以 $7$ $\\text{km/h}$ 的速度离开 00 号路段。\n\n- 然后有一段长度为 $1$ $\\text{m}$ 的铁轨。过山车在到达这段铁轨的末端时速度为 $6$ $\\text{km/h}$。\n\n- 过山车以 $6$ $\\text{km/h}$ 的速度进入 $3$ 号路段并以相同的速度离开该路段。\n\n- 在离开 $3$ 号路段后，过山车走过一段 $2$ $\\text{m}$ 长的铁轨。速度降至 $4$ $\\text{km/h}$。\n\n- 过山车以 $4$ $\\text{km/h}$ 的速度进入 $1$ 号路段，并且以 $3$ $\\text{km/h}$ 的速度离开该路段。\n\n- 离开 $1$ 号路段后，过山车立即进入 $2$ 号路段。\n\n- 过山车离开 $2$ 号路段。其最终速度是 $8$ $\\text{km/h}$。\n\n路段之间的铁轨总长度：$1+2+0=3$。", "inputFormat": "- 第一行：两个整数 $n$ 和 $m$，其中 $m=0$ 表示当答案不为 $0$ 时，你可以返回任意正整数，$m=1$ 表示你需要返回正确答案。\n\n- 接下来 $n$ 行：第 $i$ 行的两个整数表示 $s_{i-1}$ 和 $t_{i-1}$。", "outputFormat": "共一行，所有铁轨的最小可能总长度。（当 $m=0$ 时，如果存在一个有效的过山车设计使得每段铁轨的长度均为零，则函数返回零，如果上述设计不存在，则输出任意的正整数）。", "hint": "对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$ 1 \\le s_i \\le 10^9$，$1 \\le t_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6169", "type": "P", "difficulty": 5, "samples": [["1 10 12\n9\n", "0\n"], ["2 5 10\n4 2", "2\n0 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "IOI", "Special Judge", "排序", "前缀和", "双指针 two-pointer"], "title": "[IOI 2016] molecules", "background": "", "description": "彼得在一家公司工作，这家公司已经制造了一台检测分子的机器。每个分子的重量都是正整数。这台机器的检测范围是 $[l,u]$，这里 $l$ 和 $u$ 都是正整数。这台机器能够检测一个分子集合当且仅当这个集合包含了一个子集，这个子集的分子的重量属于机器的检测范围。\n\n考虑 $n$ 个分子，重量记为 $w_0,\\cdots,w_{n-1}$。如果存在一个下标的集合（并且该集合中的下标都不相同）$I=\\{i_1,\\cdots,i_m\\}$ 使得 $l\\le w_{i_1}+\\cdots+w_{i_m}\\le u$，那么检测就会成功。\n\n由于机器的细节，$l$ 和 $u$ 之间的差距要保证会大于等于最重分子和最轻分子之间的差距，即 $u-l \\ge w_{max}-w_{min}$，其中 $w_{max}=\\max(w_0,\\cdots,w_{n-1})$，$w_{min}=\\min(w_0,\\cdots,w_{n-1})$\n\n你的任务是写一个程序，该程序能找到一个子集，使得该子集的总重量属于检测范围，或者判定没有这样的子集存在。\n\n\n### 样例一 \n \n ```\n  4 15 17\n  6 8 8 7\n ```\n\n这个例子当中，我们有四个分子，重量分别是 $6,8,8$ 和 $7$。这台机器可以检测子集总重量在 $15$ 到 $17$ 之间（包含 $15$ 和 $17$）的子集。注意，$17-15 \\ge 8-6$。分子 $1$ 和分子 $3$ 的重量之和为 $w_1+w_3=8+7=15$, 所以应该输出\n```\n2\n1 3\n```\n其他可能正确的答案有 \n```\n2 \n1 2\n```\n（$w_1+w_2=8+8=16$）\n\n和 \n```\n2\n2 3\n```\n（$w_2+w_3=8+7=15$）。\n\n### 样例二 \n\n```\n4 14 15\n5 5 6 6\n```\n\n这个例子当中，我们有四个分子，重量分别为 $5,5,6$ 和 $6$，我们要寻找一个子集，其总重量介于 $14$ 和 $15$ 之间（包含 $14$ 和 $15$）。请注意，$15-14 \\ge 6-5$。因为不存在总重量介于 $14$ 和 $15$ 之间的子集，所以输出 `0`。", "inputFormat": "- 第一行：整数 $n,l$ 和 $u$。\n\n- 第二行：$n$ 个整数：$w_0,\\cdots,w_{n-1}$。", "outputFormat": "如果有满足条件的子集：\n\n- 第一行，输出该子集大小 $x$。\n\n- 第二行，$x$ 个整数，符合要求的子集中的分子的下标。\n\n如果没有，输出 `0`。", "hint": "对于 $100\\%$ 的数据，$n \\le 2 \\times 10^5$，$w_i \\le \t2^{31}-1$，$l,u \\le 2^{31}-1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[IOI 2016] molecules", "background": "", "description": "彼得在一家公司工作，这家公司已经制造了一台检测分子的机器。每个分子的重量都是正整数。这台机器的检测范围是 $[l,u]$，这里 $l$ 和 $u$ 都是正整数。这台机器能够检测一个分子集合当且仅当这个集合包含了一个子集，这个子集的分子的重量属于机器的检测范围。\n\n考虑 $n$ 个分子，重量记为 $w_0,\\cdots,w_{n-1}$。如果存在一个下标的集合（并且该集合中的下标都不相同）$I=\\{i_1,\\cdots,i_m\\}$ 使得 $l\\le w_{i_1}+\\cdots+w_{i_m}\\le u$，那么检测就会成功。\n\n由于机器的细节，$l$ 和 $u$ 之间的差距要保证会大于等于最重分子和最轻分子之间的差距，即 $u-l \\ge w_{max}-w_{min}$，其中 $w_{max}=\\max(w_0,\\cdots,w_{n-1})$，$w_{min}=\\min(w_0,\\cdots,w_{n-1})$\n\n你的任务是写一个程序，该程序能找到一个子集，使得该子集的总重量属于检测范围，或者判定没有这样的子集存在。\n\n\n### 样例一 \n \n ```\n  4 15 17\n  6 8 8 7\n ```\n\n这个例子当中，我们有四个分子，重量分别是 $6,8,8$ 和 $7$。这台机器可以检测子集总重量在 $15$ 到 $17$ 之间（包含 $15$ 和 $17$）的子集。注意，$17-15 \\ge 8-6$。分子 $1$ 和分子 $3$ 的重量之和为 $w_1+w_3=8+7=15$, 所以应该输出\n```\n2\n1 3\n```\n其他可能正确的答案有 \n```\n2 \n1 2\n```\n（$w_1+w_2=8+8=16$）\n\n和 \n```\n2\n2 3\n```\n（$w_2+w_3=8+7=15$）。\n\n### 样例二 \n\n```\n4 14 15\n5 5 6 6\n```\n\n这个例子当中，我们有四个分子，重量分别为 $5,5,6$ 和 $6$，我们要寻找一个子集，其总重量介于 $14$ 和 $15$ 之间（包含 $14$ 和 $15$）。请注意，$15-14 \\ge 6-5$。因为不存在总重量介于 $14$ 和 $15$ 之间的子集，所以输出 `0`。", "inputFormat": "- 第一行：整数 $n,l$ 和 $u$。\n\n- 第二行：$n$ 个整数：$w_0,\\cdots,w_{n-1}$。", "outputFormat": "如果有满足条件的子集：\n\n- 第一行，输出该子集大小 $x$。\n\n- 第二行，$x$ 个整数，符合要求的子集中的分子的下标。\n\n如果没有，输出 `0`。", "hint": "对于 $100\\%$ 的数据，$n \\le 2 \\times 10^5$，$w_i \\le \t2^{31}-1$，$l,u \\le 2^{31}-1$。", "locale": "zh-CN"}}}
{"pid": "P6170", "type": "P", "difficulty": 5, "samples": [["10\n1\n0\n0\n2\n0\n0\n1\n2\n2\n2", "33"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "贪心", "2016", "USACO"], "title": "[USACO16FEB] Circular Barn G", "background": "*本题与 [银组同名题目](/problem/P3137) 在题意上一致，唯一的差别是数据范围。*", "description": "作为当代建筑的爱好者，Farmer John 建造了一个圆形新谷仓，谷仓内部 $n$ 个房间排成环形（$3 \\leq n \\leq 10^5$），按顺时针顺序编号为 $1\\ldots n$，每个房间都有通往与其相邻的左右房间的门，还有一扇门通往外面。\n\n现在 FJ 有 $n$ 头奶牛，他的目标是让每个房间恰好有一头奶牛。然而不幸的是，现在奶牛们随意呆在某个房间里，第 $i$ 个房间里有 $c_i$ 头奶牛。保证 $\\sum c_i =n$。\n\nFJ 决定采用这样的方法来解决这个问题：让某些奶牛**顺时针**穿过某些房间到达指定的位置。如果一头奶牛穿过了 $d$ 扇门，他消耗的能量为 $d^2$。你需要帮 FJ 算出所有奶牛消耗的能量和最小值是多少。", "inputFormat": "第一行一个整数 $n$，接下来 $n$ 行，第 $i$ 行一个整数 $c_i$。", "outputFormat": "输出所有奶牛最小消耗能量和。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO16FEB] Circular Barn G", "background": "*本题与 [银组同名题目](/problem/P3137) 在题意上一致，唯一的差别是数据范围。*", "description": "作为当代建筑的爱好者，Farmer John 建造了一个圆形新谷仓，谷仓内部 $n$ 个房间排成环形（$3 \\leq n \\leq 10^5$），按顺时针顺序编号为 $1\\ldots n$，每个房间都有通往与其相邻的左右房间的门，还有一扇门通往外面。\n\n现在 FJ 有 $n$ 头奶牛，他的目标是让每个房间恰好有一头奶牛。然而不幸的是，现在奶牛们随意呆在某个房间里，第 $i$ 个房间里有 $c_i$ 头奶牛。保证 $\\sum c_i =n$。\n\nFJ 决定采用这样的方法来解决这个问题：让某些奶牛**顺时针**穿过某些房间到达指定的位置。如果一头奶牛穿过了 $d$ 扇门，他消耗的能量为 $d^2$。你需要帮 FJ 算出所有奶牛消耗的能量和最小值是多少。", "inputFormat": "第一行一个整数 $n$，接下来 $n$ 行，第 $i$ 行一个整数 $c_i$。", "outputFormat": "输出所有奶牛最小消耗能量和。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6171", "type": "P", "difficulty": 4, "samples": [["15 15 5 2\n2\n5\n10\n6\n4\n11\n3", "44"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2016", "USACO", "生成树"], "title": "[USACO16FEB] Fenced In G", "background": "*本题和 [白金组同名题目](/problem/P3141) 在题意上一致，唯一的不同是数据范围。*", "description": "Farmer John 意识到他的奶牛最近患上了一种恐惧症（害怕过于开阔的空间）。为了减少放牧的恐惧，FJ 决定在牧场中建一些水平和竖直方向的栅栏来将牧场分成若干个小区域。\n\n整个牧场是一个矩形，两个角的坐标分别为 $(0,0)$ 和 $(A,B)$。FJ 在 $a_1,\\ldots ,a_n$ 这 $n$ 个两两不同的位置建造了竖直方向的栅栏，每个栅栏从 $(a_i,0)$ 到 $(a_i,B)$；FJ 在 $b_1,\\ldots ,b_m$ 这 $m$ 个两两不同的位置建造了水平方向的栅栏，每个栅栏从 $(0,b_i)$ 到 $(A,b_i)$。竖直方向的栅栏和水平方向的栅栏两两相交，将整个牧场分割成 $(n+1)(m+1)$ 个区域。\n\n不幸的是，FJ 忘记了在栅栏上开门，奶牛都只能被困在一个个的小区域里！他想通过去掉一些栅栏来解决这个问题。他一次可以选择两个相邻的区域，将隔离这两个区域的栅栏去掉。FJ 的目标是让奶牛能够抵达牧场的任意一个地方。\n\n这是一个例子：\n\n```plain\n+---+--+\n|   |  |\n+---+--+\n|   |  |\n|   |  |\n+---+--+\n```\n\n去掉一些栅栏后的效果是这样的：\n\n```plain\n+---+--+\n|      |\n+---+  +\n|      |\n|      |\n+---+--+\n```\n\n为了降低工程量，FJ 当然希望拆除的栅栏长度最短。", "inputFormat": "第一行四个整数 $A,B,n,m$，保证 $1 \\leq n,m \\leq 2000$，$1 \\leq A,B \\leq 10^9$。\n\n接下来 $n$ 行，第 $i$ 行一个整数 $a_i$，保证 $0 \\lt a_i \\lt A$。\n\n接下来 $m$ 行，第 $i$ 行一个整数 $b_i$，保证 $0 \\lt b_i \\lt B$。", "outputFormat": "输出拆除栅栏的最小长度。**答案需要用 64 位带符号整数存储。**", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO16FEB] Fenced In G", "background": "*本题和 [白金组同名题目](/problem/P3141) 在题意上一致，唯一的不同是数据范围。*", "description": "Farmer John 意识到他的奶牛最近患上了一种恐惧症（害怕过于开阔的空间）。为了减少放牧的恐惧，FJ 决定在牧场中建一些水平和竖直方向的栅栏来将牧场分成若干个小区域。\n\n整个牧场是一个矩形，两个角的坐标分别为 $(0,0)$ 和 $(A,B)$。FJ 在 $a_1,\\ldots ,a_n$ 这 $n$ 个两两不同的位置建造了竖直方向的栅栏，每个栅栏从 $(a_i,0)$ 到 $(a_i,B)$；FJ 在 $b_1,\\ldots ,b_m$ 这 $m$ 个两两不同的位置建造了水平方向的栅栏，每个栅栏从 $(0,b_i)$ 到 $(A,b_i)$。竖直方向的栅栏和水平方向的栅栏两两相交，将整个牧场分割成 $(n+1)(m+1)$ 个区域。\n\n不幸的是，FJ 忘记了在栅栏上开门，奶牛都只能被困在一个个的小区域里！他想通过去掉一些栅栏来解决这个问题。他一次可以选择两个相邻的区域，将隔离这两个区域的栅栏去掉。FJ 的目标是让奶牛能够抵达牧场的任意一个地方。\n\n这是一个例子：\n\n```plain\n+---+--+\n|   |  |\n+---+--+\n|   |  |\n|   |  |\n+---+--+\n```\n\n去掉一些栅栏后的效果是这样的：\n\n```plain\n+---+--+\n|      |\n+---+  +\n|      |\n|      |\n+---+--+\n```\n\n为了降低工程量，FJ 当然希望拆除的栅栏长度最短。", "inputFormat": "第一行四个整数 $A,B,n,m$，保证 $1 \\leq n,m \\leq 2000$，$1 \\leq A,B \\leq 10^9$。\n\n接下来 $n$ 行，第 $i$ 行一个整数 $a_i$，保证 $0 \\lt a_i \\lt A$。\n\n接下来 $m$ 行，第 $i$ 行一个整数 $b_i$，保证 $0 \\lt b_i \\lt B$。", "outputFormat": "输出拆除栅栏的最小长度。**答案需要用 64 位带符号整数存储。**", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6172", "type": "P", "difficulty": 5, "samples": [["7\n7 3\n5 5\n7 13\n3 1\n11 7\n5 3\n9 1", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "倍增", "二分", "USACO", "树状数组"], "title": "[USACO16FEB] Load Balancing P", "background": "*本题与 [银组同名题目](/problem/P3138) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 的 $N$ 头奶牛（$1 \\leq N \\leq 10^5$）散布在整个农场上。整个农场是一个无限大的二维平面，第 $i$ 头奶牛的坐标是 $(x_i,y_i)$（保证 $x_i,y_i$ 均为正奇数，且 $x_i,y_i \\leq 10^6$），且没有任意两头奶牛在同一位置上。\n\nFJ 希望修建一条竖直方向的栅栏，它的方程是 $x=a$，他还希望修建一条水平方向的栅栏，它的方程是 $y=b$。为了防止栅栏经过奶牛，$a,b$ 均要求是偶数。容易发现，这两个栅栏会在 $(a,b)$ 处相交，将整个农场分割为四个区域。\n\nFJ 希望这四个区域内的奶牛数量较为均衡，尽量避免一个区域奶牛多而另一个区域奶牛少的情况。令 $M$ 为四个区域里奶牛最多区域的奶牛数量，请帮 FJ 求出 $M$ 的最小值。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行两个整数 $x_i,y_i$，描述第 $i$ 头奶牛的位置。", "outputFormat": "输出 $M$ 的最小值。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO16FEB] Load Balancing P", "background": "*本题与 [银组同名题目](/problem/P3138) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 的 $N$ 头奶牛（$1 \\leq N \\leq 10^5$）散布在整个农场上。整个农场是一个无限大的二维平面，第 $i$ 头奶牛的坐标是 $(x_i,y_i)$（保证 $x_i,y_i$ 均为正奇数，且 $x_i,y_i \\leq 10^6$），且没有任意两头奶牛在同一位置上。\n\nFJ 希望修建一条竖直方向的栅栏，它的方程是 $x=a$，他还希望修建一条水平方向的栅栏，它的方程是 $y=b$。为了防止栅栏经过奶牛，$a,b$ 均要求是偶数。容易发现，这两个栅栏会在 $(a,b)$ 处相交，将整个农场分割为四个区域。\n\nFJ 希望这四个区域内的奶牛数量较为均衡，尽量避免一个区域奶牛多而另一个区域奶牛少的情况。令 $M$ 为四个区域里奶牛最多区域的奶牛数量，请帮 FJ 求出 $M$ 的最小值。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行两个整数 $x_i,y_i$，描述第 $i$ 头奶牛的位置。", "outputFormat": "输出 $M$ 的最小值。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6173", "type": "P", "difficulty": 6, "samples": [["6 2\n2\n5\n4\n2\n6\n2", "14"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2016", "USACO", "分治", "动态规划优化", "斜率优化", "四边形不等式"], "title": "[USACO16FEB] Circular Barn P", "background": "", "description": "作为当代建筑的爱好者，Farmer John 建造了一个圆形新谷仓，谷仓内部 $n$ 个房间排成环形（$3 \\leq n \\leq 1000$），按顺时针顺序编号为 $1\\ldots n$，每个房间都有通往与其相邻的左右房间的门，还有一扇门通往外面。\n\nFJ 准备让第 $i$ 个房间里恰好有 $r_i$ 头奶牛（$1 \\le r_i \\le {10}^6$）。为了有序地让奶牛进入谷仓，他打算解锁 $k$ 个从外界进入谷仓的门（$1 \\le k \\le 7$）。然后，每头奶牛**顺时针**走动，直到到达目的地。FJ 的目标是让所有奶牛走动的距离和最小（奶牛从哪个门进入可以随意安排，这里走动的距离只包含进入谷仓后走动的距离），现在请你求出这个最小距离。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 行，第 $i$ 行一个整数 $r_i$。", "outputFormat": "输出所有奶牛最小走动距离和。", "hint": "FJ 打开 $2,5$ 两个门。$11$ 头奶牛从 $2$ 号门进入，前往 $2,3,4$ 号房间，总距离 $8$。$10$ 头奶牛从 $5$ 号门进入，前往 $5,6,1$ 号房间，总距离 $6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO16FEB] Circular Barn P", "background": "", "description": "作为当代建筑的爱好者，Farmer John 建造了一个圆形新谷仓，谷仓内部 $n$ 个房间排成环形（$3 \\leq n \\leq 1000$），按顺时针顺序编号为 $1\\ldots n$，每个房间都有通往与其相邻的左右房间的门，还有一扇门通往外面。\n\nFJ 准备让第 $i$ 个房间里恰好有 $r_i$ 头奶牛（$1 \\le r_i \\le {10}^6$）。为了有序地让奶牛进入谷仓，他打算解锁 $k$ 个从外界进入谷仓的门（$1 \\le k \\le 7$）。然后，每头奶牛**顺时针**走动，直到到达目的地。FJ 的目标是让所有奶牛走动的距离和最小（奶牛从哪个门进入可以随意安排，这里走动的距离只包含进入谷仓后走动的距离），现在请你求出这个最小距离。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 行，第 $i$ 行一个整数 $r_i$。", "outputFormat": "输出所有奶牛最小走动距离和。", "hint": "FJ 打开 $2,5$ 两个门。$11$ 头奶牛从 $2$ 号门进入，前往 $2,3,4$ 号房间，总距离 $8$。$10$ 头奶牛从 $5$ 号门进入，前往 $5,6,1$ 号房间，总距离 $6$。", "locale": "zh-CN"}}}
{"pid": "P6174", "type": "P", "difficulty": 3, "samples": [["7 2\n20\n25\n18\n8\n10\n3\n1", "5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2016", "二分", "USACO"], "title": "[USACO16JAN] Angry Cows S", "background": "", "description": "Bessie 设计了一款新游戏：*Angry Cows*。在这个游戏中，玩家发射奶牛，每头奶牛落地时引爆一定范围内的干草。游戏的目标是使用一组奶牛引爆所有干草。\n\n$N$ 捆干草排列在数轴上的不同位置。第 $i$ 捆干草的的位置为 $x_i$。如果一个威力为 $R$ 的奶牛在 $x$ 位置落地，她将引爆 $[x-R,x+R]$ 范围内的所有干草。\n\n你现在可以发射 $K$ 头奶牛，每头奶牛的威力都是 $R$，现在你需要确定 $R$ 的最小值，使得用 $K$ 头奶牛可以引爆所有干草。", "inputFormat": "第一行两个整数 $N,K$（$1 \\leq N \\leq 5 \\times 10^4$，$1 \\leq K \\leq 10$）。\n\n接下来 $N$ 行，第 $i$ 行一个整数 $x_i$（$0 \\leq x_i \\leq 10^9$）。", "outputFormat": "输出一个整数，即 $R$ 的最小值。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO16JAN] Angry Cows S", "background": "", "description": "Bessie 设计了一款新游戏：*Angry Cows*。在这个游戏中，玩家发射奶牛，每头奶牛落地时引爆一定范围内的干草。游戏的目标是使用一组奶牛引爆所有干草。\n\n$N$ 捆干草排列在数轴上的不同位置。第 $i$ 捆干草的的位置为 $x_i$。如果一个威力为 $R$ 的奶牛在 $x$ 位置落地，她将引爆 $[x-R,x+R]$ 范围内的所有干草。\n\n你现在可以发射 $K$ 头奶牛，每头奶牛的威力都是 $R$，现在你需要确定 $R$ 的最小值，使得用 $K$ 头奶牛可以引爆所有干草。", "inputFormat": "第一行两个整数 $N,K$（$1 \\leq N \\leq 5 \\times 10^4$，$1 \\leq K \\leq 10$）。\n\n接下来 $N$ 行，第 $i$ 行一个整数 $x_i$（$0 \\leq x_i \\leq 10^9$）。", "outputFormat": "输出一个整数，即 $R$ 的最小值。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6175", "type": "P", "difficulty": 3, "samples": [["5 7\n1 4 1\n1 3 300\n3 1 10\n1 2 16\n2 3 100\n2 5 15\n5 3 20", "61"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["最小环"], "title": "无向图的最小环问题", "background": "", "description": "给定一张无向图，求图中一个至少包含 $3$ 个点的环，环上的节点不重复，并且环上的边的长度之和最小。该问题称为无向图的最小环问题。在本题中，你需要输出最小的环的边权和。若无解，输出 `No solution.`。", "inputFormat": "第一行两个正整数 $n,m$ 表示点数和边数。\n\n接下来 $m$ 行，每行三个正整数 $u,v,d$，表示节点 $u,v$ 之间有一条长度为 $d$ 的边。\n\n", "outputFormat": "输出边权和最小的环的边权和。若无解，输出 `No solution.`。", "hint": "样例解释：一种可行的方案：$1-3-5-2-1$。\n\n对于 $20\\%$ 的数据，$n,m \\leq 10$。\n\n对于 $60\\%$ 的数据，$m\\leq 100$。\n\n对于 $100\\%$ 的数据，$1\\le n\\leq 100$，$1\\le m\\leq 5\\times 10^3$，$1 \\leq d \\leq 10^5$。\n\n\n**无解输出包括句号。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "无向图的最小环问题", "background": "", "description": "给定一张无向图，求图中一个至少包含 $3$ 个点的环，环上的节点不重复，并且环上的边的长度之和最小。该问题称为无向图的最小环问题。在本题中，你需要输出最小的环的边权和。若无解，输出 `No solution.`。", "inputFormat": "第一行两个正整数 $n,m$ 表示点数和边数。\n\n接下来 $m$ 行，每行三个正整数 $u,v,d$，表示节点 $u,v$ 之间有一条长度为 $d$ 的边。\n\n", "outputFormat": "输出边权和最小的环的边权和。若无解，输出 `No solution.`。", "hint": "样例解释：一种可行的方案：$1-3-5-2-1$。\n\n对于 $20\\%$ 的数据，$n,m \\leq 10$。\n\n对于 $60\\%$ 的数据，$m\\leq 100$。\n\n对于 $100\\%$ 的数据，$1\\le n\\leq 100$，$1\\le m\\leq 5\\times 10^3$，$1 \\leq d \\leq 10^5$。\n\n\n**无解输出包括句号。**", "locale": "zh-CN"}}}
{"pid": "P6176", "type": "P", "difficulty": 6, "samples": [["4\n0 0\n0 10\n1 10\n1 0", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2016", "USACO"], "title": "[USACO16JAN] Lights Out P", "background": "", "description": "Farmer John has installed a fancy new milking machine in his barn, but it draws so much power that it occasionally causes the power to go out! This happens so often that Bessie has memorized a map of the barn, making it easier for her to find the exit of the barn in the dark. She is curious though about the impact of power loss on her ability to exit the barn quickly. For example, she wonders how much farther she might need to walk find the exit in the dark.\n\nThe barn is described by a simple (non self-intersecting) polygon with integer vertices $(x_1,y_1)\\ldots(x_n,y_n)$ listed in clockwise order. Its edges alternate between horizontal (parallel to the x-axis) and vertical (parallel to the y-axis); the first edge can be of either type. The exit is located at $(x_1,y_1)$. Bessie starts inside the barn located at some vertex $(x_i,y_i)$ for $i \\gt 1$. She can walk only around the perimeter of the barn, either clockwise or counterclockwise, potentially changing direction any time she reaches a vertex. Her goal is to travel a minimum distance to reach the exit. This is relatively easy to do with the lights on, of course, since she will travel either clockwise or counterclockwise from her current location to the exit -- whichever direction is shorter.\n\nOne day, the lights go out, causing Bessie to panic and forget which vertex she is standing at. Fortunately, she still remembers the exact map of the barn, so she can possibly figure out her position by walking around and using her sense of touch. Whenever she is standing at a vertex (including at her initial vertex), she can feel whether it is a left turn or a right turn, and she can tell if that vertex is the exit. When she walks along an edge of the barn, she can determine the exact length of the edge after walking along the entire edge. In general, Bessie will strategically feel her way around her starting vertex until she knows enough information to determine where she is, at which point she can easily figure out how to get to the exit by traveling a minimum amount of remaining distance.\n\nPlease help Bessie determine the smallest possible amount by which her travel distance will increase in the worst case (over all possibilities for her starting vertex) for travel in the dark versus in a lit barn, assuming she moves according to an optimal strategy in each case. An \"optimal\" strategy for the unlit case is one that minimizes this extra worst-case amount.", "inputFormat": "The first line of the input contains $N$ ($4 \\leq N \\leq 200$). Each of the next $N$ lines contains two integers, describing the points $(x_i,y_i)$ in clockwise order around the barn. These integers are in the range $-100,000 \\ldots 100,000$.", "outputFormat": "Please output the smallest possible worst-case amount by which Bessie's optimal distance in the dark is longer than her optimal distance in a lit barn, where the worst case is taken over all possible vertices at which Bessie can start.", "hint": "In this example, Bessie can feel that she is initially standing at an inward bend, however since in this example all corners are inward bends this tells her little information.\n\nOne optimal strategy is to just travel clockwise. This is optimal is she starts at vertex 3 or 4 and only adds 2 units of distance if she starts at vertex 2.", "locale": "en", "translations": {"en": {"title": "[USACO16JAN] Lights Out P", "background": "", "description": "Farmer John has installed a fancy new milking machine in his barn, but it draws so much power that it occasionally causes the power to go out! This happens so often that Bessie has memorized a map of the barn, making it easier for her to find the exit of the barn in the dark. She is curious though about the impact of power loss on her ability to exit the barn quickly. For example, she wonders how much farther she might need to walk find the exit in the dark.\n\nThe barn is described by a simple (non self-intersecting) polygon with integer vertices $(x_1,y_1)\\ldots(x_n,y_n)$ listed in clockwise order. Its edges alternate between horizontal (parallel to the x-axis) and vertical (parallel to the y-axis); the first edge can be of either type. The exit is located at $(x_1,y_1)$. Bessie starts inside the barn located at some vertex $(x_i,y_i)$ for $i \\gt 1$. She can walk only around the perimeter of the barn, either clockwise or counterclockwise, potentially changing direction any time she reaches a vertex. Her goal is to travel a minimum distance to reach the exit. This is relatively easy to do with the lights on, of course, since she will travel either clockwise or counterclockwise from her current location to the exit -- whichever direction is shorter.\n\nOne day, the lights go out, causing Bessie to panic and forget which vertex she is standing at. Fortunately, she still remembers the exact map of the barn, so she can possibly figure out her position by walking around and using her sense of touch. Whenever she is standing at a vertex (including at her initial vertex), she can feel whether it is a left turn or a right turn, and she can tell if that vertex is the exit. When she walks along an edge of the barn, she can determine the exact length of the edge after walking along the entire edge. In general, Bessie will strategically feel her way around her starting vertex until she knows enough information to determine where she is, at which point she can easily figure out how to get to the exit by traveling a minimum amount of remaining distance.\n\nPlease help Bessie determine the smallest possible amount by which her travel distance will increase in the worst case (over all possibilities for her starting vertex) for travel in the dark versus in a lit barn, assuming she moves according to an optimal strategy in each case. An \"optimal\" strategy for the unlit case is one that minimizes this extra worst-case amount.", "inputFormat": "The first line of the input contains $N$ ($4 \\leq N \\leq 200$). Each of the next $N$ lines contains two integers, describing the points $(x_i,y_i)$ in clockwise order around the barn. These integers are in the range $-100,000 \\ldots 100,000$.", "outputFormat": "Please output the smallest possible worst-case amount by which Bessie's optimal distance in the dark is longer than her optimal distance in a lit barn, where the worst case is taken over all possible vertices at which Bessie can start.", "hint": "In this example, Bessie can feel that she is initially standing at an inward bend, however since in this example all corners are inward bends this tells her little information.\n\nOne optimal strategy is to just travel clockwise. This is optimal is she starts at vertex 3 or 4 and only adds 2 units of distance if she starts at vertex 2.", "locale": "en"}, "zh-CN": {"title": "[USACO16JAN] Lights Out P", "background": "", "description": "农夫约翰在他的谷仓里安装了一台新的挤奶机，但它耗电量太大，偶尔会导致停电！这种情况发生得如此频繁，以至于贝茜已经记住了谷仓的地图，这帮助她在黑暗中更容易找到出口。但她好奇停电会对她快速离开谷仓的能力产生多大影响。例如，她想知道在黑暗中寻找出口可能需要多走多少路。\n\n谷仓由一个简单（无自交）多边形描述，其顶点按顺时针顺序排列为 $(x_1,y_1)\\ldots(x_n,y_n)$。多边形的边在水平（平行于 $x$ 轴）和垂直（平行于 $y$ 轴）之间交替；第一条边可以是任意类型。出口位于 $(x_1,y_1)$。贝茜从某个顶点 $(x_i,y_i)$（$i > 1$）开始位于谷仓内部。她只能沿着谷仓的周边行走，可以顺时针或逆时针方向移动，并可在到达顶点时随时改变方向。她的目标是以最短距离到达出口。在有灯光的情况下这很容易，因为她只需从当前位置沿顺时针或逆时针中选择较短的方向行进即可。\n\n某天停电时，贝茜因恐慌而忘记了自己所在的起始顶点。幸运的是，她仍清楚记得谷仓的地图，因此她可能通过行走并利用触觉来确定自己的位置。每当她站在一个顶点时（包括初始顶点），她可以感知该顶点是左转还是右转，并能判断该顶点是否是出口。当她沿着谷仓的边行走时，她可以在走完整条边后确定该边的精确长度。贝茜将策略性地探索周围环境，直到获得足够信息来确定自己的位置，之后她就能轻松计算出剩余的最短路径。\n\n请帮助贝茜计算：在最优策略下，黑暗中最坏情况（考虑所有可能的起始顶点）下她的行走距离相比有灯光时可能增加的最小额外距离。这里的“最优策略”指能最小化这种最坏情况额外距离的策略。", "inputFormat": "输入第一行包含 $N$（$4 \\leq N \\leq 200$）。接下来 $N$ 行每行包含两个整数，按顺时针顺序描述多边形顶点 $(x_i,y_i)$。这些整数的范围在 $-100,000$ 到 $100,000$ 之间。", "outputFormat": "请输出在最优策略下，贝茜在黑暗中最坏情况（考虑所有可能的起始顶点）下的行走距离相比有灯光时可能增加的最小额外距离。", "hint": "在此示例中，贝茜可以感知到自己初始位于一个内角处，但由于所有角都是内角，这提供的信息有限。\n\n一种最优策略是始终顺时针行走。如果她从顶点 3 或 4 出发，这是最优选择；如果从顶点 2 出发，则只会增加 2 单位距离。", "locale": "zh-CN"}}}
{"pid": "P6177", "type": "P", "difficulty": 6, "samples": [["8 2\n105 2 9 3 8 5 7 7 \n1 2\n1 3\n1 4\n3 5\n3 6\n3 7\n4 8\n2 5\n3 8", "4\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["倍增", "最近公共祖先 LCA", "树链剖分", "可持久化", "分块", "模板题"], "title": "【模板】树分块 / Count on a tree II", "background": "原 bzoj2589。", "description": "给定一个 $n$ 个节点的树，每个节点上有一个整数，$i$ 号点的整数为 $val_i$。\n\n有 $m$ 次询问，每次给出 $u',v$，您需要将其解密得到 $u,v$，并查询 $u$ 到 $v$ 的路径上有多少个不同的整数。\n\n解密方式：$u=u' \\operatorname{xor} lastans$。\n\n$lastans$ 为上一次询问的答案，若无询问则为 $0$。", "inputFormat": "第一行有两个整数 $n$ 和 $m$。\n\n第二行有 $n$ 个整数。第 $i$ 个整数表示 $val_i$。\n\n在接下来的 $n-1$ 行中，每行包含两个整数 $u,v$，描述一条边。\n\n在接下来的 $m$ 行中，每行包含两个整数 $u',v$，描述一组询问。", "outputFormat": "对于每个询问，一行一个整数表示答案。", "hint": "对于 $100\\%$ 的数据，$1\\le u,v\\le n\\le 4\\times 10^4$，$1\\le m\\le 10^5$，$0\\le u',val_i<2^{31}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】树分块 / Count on a tree II", "background": "原 bzoj2589。", "description": "给定一个 $n$ 个节点的树，每个节点上有一个整数，$i$ 号点的整数为 $val_i$。\n\n有 $m$ 次询问，每次给出 $u',v$，您需要将其解密得到 $u,v$，并查询 $u$ 到 $v$ 的路径上有多少个不同的整数。\n\n解密方式：$u=u' \\operatorname{xor} lastans$。\n\n$lastans$ 为上一次询问的答案，若无询问则为 $0$。", "inputFormat": "第一行有两个整数 $n$ 和 $m$。\n\n第二行有 $n$ 个整数。第 $i$ 个整数表示 $val_i$。\n\n在接下来的 $n-1$ 行中，每行包含两个整数 $u,v$，描述一条边。\n\n在接下来的 $m$ 行中，每行包含两个整数 $u',v$，描述一组询问。", "outputFormat": "对于每个询问，一行一个整数表示答案。", "hint": "对于 $100\\%$ 的数据，$1\\le u,v\\le n\\le 4\\times 10^4$，$1\\le m\\le 10^5$，$0\\le u',val_i<2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P6178", "type": "P", "difficulty": 6, "samples": [["5 8 0\n2 3 1\n1 2 3\n4 5 1\n4 2 2\n3 5 2\n3 4 3\n3 4 1\n3 3 5\n", "144\n"], ["5 9 1\n1 2 3\n3 2 1\n1 3 1\n2 4 2\n3 5 1\n4 3 4\n3 5 1\n5 4 1\n4 4 6\n", "72\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "矩阵树定理", "生成树", "高斯消元", "模板题"], "title": "【模板】Matrix-Tree 定理", "background": "", "description": "给定一张 $n$ 个结点 $m$ 条边的带权图（可能为无向图，可能为有向图）。\n\n定义其一个生成树 $T$ 的权值为 $T$ 中所有边权的乘积。\n\n求其所有不同生成树的权值之和，对 $10^9+7$ 取模。\n\n---\n\n注意：\n\n1. 本题中，有向图的生成树指的是 **以 $1$ 为根的外向树**；\n\n2. 两棵生成树 $T_1,T_2$ 不同，当且仅当存在存在一条边 $e$，满足 $e\\in T_1,\\ \\ e\\notin T_2$。", "inputFormat": "第一行：三个整数 $n,m,t$，分别表示图的结点数量，边的数量和图的类型（$t=0$ 时为无向图，$t=1$ 时为有向图）。\n\n接下来 $m$ 行：每行三个整数 $u,v,w$。\n\n如果 $t=0$，表示 $u,v$ 之间有一条权值为 $w$ 的无向边；\n\n如果 $t=1$，表示从 $u$ 到 $v$ 有一条权值为 $w$ 的有向边。", "outputFormat": "第一行：一个整数 $ans$，表示给定的图的生成树权值和对 $10^9+7$ 取模的结果。", "hint": "【样例 $1$ 解释】\n\n样例 $1$ 中的无向图如左图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pxtx9z5a.png)\n\n右图为其一个权值为 $3\\times 1\\times 2\\times 3=18$ 的生成树的例子。\n\n---\n\n【样例 $2$ 解释】\n\n样例 $2$ 中的有向图如左图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4276yln3.png)\n\n右图为其一个权值为 $1\\times 1\\times 1\\times 2=2$ 的生成树（以 $1$ 为根的外向树）的例子。\n\n---\n\n【数据范围】\n\n对于 $100\\%$ 的数据：$1\\leq n\\leq 300,\\ \\ 1\\leq m\\leq 10^5,\\ \\ t\\in \\{0,1\\},\\ \\ 1\\leq u,v\\leq n,\\ \\ 1\\leq w\\leq 10^9$。\n\n对于测试点 $1,2,3,4,5,6$，$t=0$；对于测试点 $7,8,9,10,11$，$t=1$。\n\n图中 **可能** 存在重边和自环，重边算作多条边。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】Matrix-Tree 定理", "background": "", "description": "给定一张 $n$ 个结点 $m$ 条边的带权图（可能为无向图，可能为有向图）。\n\n定义其一个生成树 $T$ 的权值为 $T$ 中所有边权的乘积。\n\n求其所有不同生成树的权值之和，对 $10^9+7$ 取模。\n\n---\n\n注意：\n\n1. 本题中，有向图的生成树指的是 **以 $1$ 为根的外向树**；\n\n2. 两棵生成树 $T_1,T_2$ 不同，当且仅当存在存在一条边 $e$，满足 $e\\in T_1,\\ \\ e\\notin T_2$。", "inputFormat": "第一行：三个整数 $n,m,t$，分别表示图的结点数量，边的数量和图的类型（$t=0$ 时为无向图，$t=1$ 时为有向图）。\n\n接下来 $m$ 行：每行三个整数 $u,v,w$。\n\n如果 $t=0$，表示 $u,v$ 之间有一条权值为 $w$ 的无向边；\n\n如果 $t=1$，表示从 $u$ 到 $v$ 有一条权值为 $w$ 的有向边。", "outputFormat": "第一行：一个整数 $ans$，表示给定的图的生成树权值和对 $10^9+7$ 取模的结果。", "hint": "【样例 $1$ 解释】\n\n样例 $1$ 中的无向图如左图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pxtx9z5a.png)\n\n右图为其一个权值为 $3\\times 1\\times 2\\times 3=18$ 的生成树的例子。\n\n---\n\n【样例 $2$ 解释】\n\n样例 $2$ 中的有向图如左图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4276yln3.png)\n\n右图为其一个权值为 $1\\times 1\\times 1\\times 2=2$ 的生成树（以 $1$ 为根的外向树）的例子。\n\n---\n\n【数据范围】\n\n对于 $100\\%$ 的数据：$1\\leq n\\leq 300,\\ \\ 1\\leq m\\leq 10^5,\\ \\ t\\in \\{0,1\\},\\ \\ 1\\leq u,v\\leq n,\\ \\ 1\\leq w\\leq 10^9$。\n\n对于测试点 $1,2,3,4,5,6$，$t=0$；对于测试点 $7,8,9,10,11$，$t=1$。\n\n图中 **可能** 存在重边和自环，重边算作多条边。", "locale": "zh-CN"}}}
{"pid": "P6179", "type": "P", "difficulty": 3, "samples": [["3\n1\n6\n4", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2015", "USACO", "排序"], "title": "[USACO15DEC] High Card Wins S", "background": "", "description": "Bessie 是纸牌游戏的忠实粉丝。对她而言，其他奶牛都算不上对手。更糟糕的是，其他奶牛在打牌时的行为都是完全能预测的。尽管如此，Bessie 知道取胜仍然是个挑战。\n\nBessie 和她的朋友 Elsie 正在玩一种纸牌游戏。这个游戏里要用到一副 $2N$ 张牌的套牌，编号从 $1$ 到 $2N$。Bessie 和 Elsie 每个人各分得 $N$ 张卡片。接下来进行 $N$ 轮比赛，Bessie 和 Elsie 每轮各出一张牌。每一轮谁的牌编号更大，谁就赢得了本轮的胜利。\n\nBessie 已经预测了 Elsie 的出牌顺序，请帮助 Bessie 算出她最多能赢多少轮。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 5 \\times 10^4$）。\n\n接下来 $N$ 行，第 $i$ 行一个整数，表示 Elsie 第 $i$ 轮出的牌。注意 Bessie 手中的 $N$ 张牌很容易从输入中推出。", "outputFormat": "输出 Bessie 最多能赢多少轮。", "hint": "Bessie 手中拿着 $2,3,5$ 三张牌。\n\n它第一轮出 $2$，第二轮出 $3$，第三轮出 $5$，从而赢得一，三两轮。可以证明不存在更优的方案。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO15DEC] High Card Wins S", "background": "", "description": "Bessie 是纸牌游戏的忠实粉丝。对她而言，其他奶牛都算不上对手。更糟糕的是，其他奶牛在打牌时的行为都是完全能预测的。尽管如此，Bessie 知道取胜仍然是个挑战。\n\nBessie 和她的朋友 Elsie 正在玩一种纸牌游戏。这个游戏里要用到一副 $2N$ 张牌的套牌，编号从 $1$ 到 $2N$。Bessie 和 Elsie 每个人各分得 $N$ 张卡片。接下来进行 $N$ 轮比赛，Bessie 和 Elsie 每轮各出一张牌。每一轮谁的牌编号更大，谁就赢得了本轮的胜利。\n\nBessie 已经预测了 Elsie 的出牌顺序，请帮助 Bessie 算出她最多能赢多少轮。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 5 \\times 10^4$）。\n\n接下来 $N$ 行，第 $i$ 行一个整数，表示 Elsie 第 $i$ 轮出的牌。注意 Bessie 手中的 $N$ 张牌很容易从输入中推出。", "outputFormat": "输出 Bessie 最多能赢多少轮。", "hint": "Bessie 手中拿着 $2,3,5$ 三张牌。\n\n它第一轮出 $2$，第二轮出 $3$，第三轮出 $5$，从而赢得一，三两轮。可以证明不存在更优的方案。", "locale": "zh-CN"}}}
{"pid": "P6180", "type": "P", "difficulty": 2, "samples": [["6 3\n2\n1\n1\n3\n2\n1\n1 6\n3 3\n2 4", "3 2 1\n1 0 0\n2 0 1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "USACO", "前缀和"], "title": "[USACO15DEC] Breed Counting S", "background": "", "description": "Farmer John 的 $N$ 头奶牛，从左到右编号为 $1 \\ldots N$，排成一队。\n\n所有牛都可以分为三个品种，每头牛都有一个品种编号（只能为 $1,2,3$ 中的一个）。FJ 有 $Q$ 个询问，每个询问希望求出某个区间内每个品种奶牛的数量。", "inputFormat": "第一行两个整数 $N,Q$（$1 \\leq N,Q \\leq 10^5$）。\n\n接下来 $N$ 行，每行一个整数，第 $i$ 个整数代表第 $i$ 头奶牛的品种编号。\n\n接下来 $Q$ 行，每行两个整数 $a,b$，表示第 $i$ 次查询的范围是 $[a,b]$。", "outputFormat": "对于每个查询，输出三个整数，分别是指定区间内品种 $1$ 的奶牛数量，品种 $2$ 的奶牛数量，品种 $3$ 的奶牛数量。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO15DEC] Breed Counting S", "background": "", "description": "Farmer John 的 $N$ 头奶牛，从左到右编号为 $1 \\ldots N$，排成一队。\n\n所有牛都可以分为三个品种，每头牛都有一个品种编号（只能为 $1,2,3$ 中的一个）。FJ 有 $Q$ 个询问，每个询问希望求出某个区间内每个品种奶牛的数量。", "inputFormat": "第一行两个整数 $N,Q$（$1 \\leq N,Q \\leq 10^5$）。\n\n接下来 $N$ 行，每行一个整数，第 $i$ 个整数代表第 $i$ 头奶牛的品种编号。\n\n接下来 $Q$ 行，每行两个整数 $a,b$，表示第 $i$ 次查询的范围是 $[a,b]$。", "outputFormat": "对于每个查询，输出三个整数，分别是指定区间内品种 $1$ 的奶牛数量，品种 $2$ 的奶牛数量，品种 $3$ 的奶牛数量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6181", "type": "P", "difficulty": 2, "samples": [["7\n3\n2\n3\n5\n4\n1\n6", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2010", "USACO", "枚举"], "title": "[USACO10OPEN] 山峰暸望 Mountain Watching S", "background": null, "description": "一天，Bessie 望着远处的山脉，在思考：“哪一座山最宽呢？”\n\nBessie 设法测量了 $N$ 个位置的高度 $h_i$（$1 \\leq N \\leq 10^5$，$1 \\leq h_i \\leq 10^9$）。一座山被定义为一个高度先不下降，后不上升的子序列。视野边缘的山脉也只会增加或减少高度。一座山的宽度被定义为这座山包含的位置数量。\n\n下面是一个例子：\n\n```plain\n           *******                   *\n          *********                 ***\n          **********               *****\n          ***********           *********               *\n*      *****************       ***********             *** *\n**    *******************     *************   * *     *******      *\n**********************************************************************\n3211112333677777776543332111112344456765432111212111112343232111111211\naaaaaa                   ccccccccccccccccccccc eeeeeee    ggggggggg\n  bbbbbbbbbbbbbbbbbbbbbbbbbbbb             ddddd ffffffffff  hhhhhhhhh\n```\n\n每座山都已经用字母标出来了。这里 `b` 山脉的宽度最大，为 $28$。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $h_i$。", "outputFormat": "输出最宽的山的宽度。", "hint": "**【样例说明】**\n\n在最宽的山处测量到的高度为 $2, 3, 5, 4, 1$。其他的山包括 $3, 2$ 和 $1, 6$。\n\n---\n\n**【提示】**\n\n如果你知道一座山的最高的部分（也就是山峰），你会发现，找到这座山的宽度是很容易的哦。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO10OPEN] 山峰暸望 Mountain Watching S", "background": null, "description": "一天，Bessie 望着远处的山脉，在思考：“哪一座山最宽呢？”\n\nBessie 设法测量了 $N$ 个位置的高度 $h_i$（$1 \\leq N \\leq 10^5$，$1 \\leq h_i \\leq 10^9$）。一座山被定义为一个高度先不下降，后不上升的子序列。视野边缘的山脉也只会增加或减少高度。一座山的宽度被定义为这座山包含的位置数量。\n\n下面是一个例子：\n\n```plain\n           *******                   *\n          *********                 ***\n          **********               *****\n          ***********           *********               *\n*      *****************       ***********             *** *\n**    *******************     *************   * *     *******      *\n**********************************************************************\n3211112333677777776543332111112344456765432111212111112343232111111211\naaaaaa                   ccccccccccccccccccccc eeeeeee    ggggggggg\n  bbbbbbbbbbbbbbbbbbbbbbbbbbbb             ddddd ffffffffff  hhhhhhhhh\n```\n\n每座山都已经用字母标出来了。这里 `b` 山脉的宽度最大，为 $28$。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $h_i$。", "outputFormat": "输出最宽的山的宽度。", "hint": "**【样例说明】**\n\n在最宽的山处测量到的高度为 $2, 3, 5, 4, 1$。其他的山包括 $3, 2$ 和 $1, 6$。\n\n---\n\n**【提示】**\n\n如果你知道一座山的最高的部分（也就是山峰），你会发现，找到这座山的宽度是很容易的哦。", "locale": "zh-CN"}}}
{"pid": "P6182", "type": "P", "difficulty": 4, "samples": [["12\na 5\na 3\na 7\ns\nt 2\na 2\nt 4\na 4\ns\nt 7\ns\ns", "5\n3\n7\n3\n5\n2\n7\n4\n7\n2\n5\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "USACO", "可持久化", "栈"], "title": "[USACO10OPEN] Time Travel S", "background": "", "description": "Farmer John 买了台时光机，这使得他可以方便地管理自己的奶牛群。\n\n他现在有 $N$ 个操作（$1 \\leq N \\leq 8 \\times 10^4$），每次操作仅可能是如下三种之一：\n\n1. `a x`：添加一头编号为 $x$ 的奶牛（$1 \\leq x \\leq 10^6$）。\n2. `s`：卖掉最近添加的奶牛（保证此时至少有一头奶牛）。\n3. `t x`：回到**第 $x$ 次操作前**的状态（保证第 $x$ 次操作存在）。\n\n你需要在 FJ 执行每次操作后输出他拥有的最新的奶牛的编号。特别地，如果没有奶牛，输出 $-1$。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行描述一次操作。", "outputFormat": "第 $i$ 行输出第 $i$ 次操作后 FJ 拥有的最新的奶牛的编号。特别地，如果没有奶牛，输出 $-1$。", "hint": "下面是样例解释，其中拥有的奶牛已经按添加顺序排好。\n\n| 操作编号 | 操作  | 拥有的奶牛 | 输出 |\n| -------- | ----- | ---------- | ---- |\n| 1        | `a 5` | 5          | 5    |\n| 2        | `a 3` | 5,3        | 3    |\n| 3        | `a 7` | 5,3,7      | 7    |\n| 4        | `s`   | 5,3        | 3    |\n| 5        | `t 2` | 5          | 5    |\n| 6        | `a 2` | 5,2        | 2    |\n| 7        | `t 4` | 5,3,7      | 7    |\n| 8        | `a 4` | 5,3,7,4    | 4    |\n| 9        | `s`   | 5,3,7      | 7    |\n| 10       | `t 7` | 5,2        | 2    |\n| 11       | `s`   | 5          | 5    |\n| 12       | `s`   | /          | -1   |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO10OPEN] Time Travel S", "background": "", "description": "Farmer John 买了台时光机，这使得他可以方便地管理自己的奶牛群。\n\n他现在有 $N$ 个操作（$1 \\leq N \\leq 8 \\times 10^4$），每次操作仅可能是如下三种之一：\n\n1. `a x`：添加一头编号为 $x$ 的奶牛（$1 \\leq x \\leq 10^6$）。\n2. `s`：卖掉最近添加的奶牛（保证此时至少有一头奶牛）。\n3. `t x`：回到**第 $x$ 次操作前**的状态（保证第 $x$ 次操作存在）。\n\n你需要在 FJ 执行每次操作后输出他拥有的最新的奶牛的编号。特别地，如果没有奶牛，输出 $-1$。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行描述一次操作。", "outputFormat": "第 $i$ 行输出第 $i$ 次操作后 FJ 拥有的最新的奶牛的编号。特别地，如果没有奶牛，输出 $-1$。", "hint": "下面是样例解释，其中拥有的奶牛已经按添加顺序排好。\n\n| 操作编号 | 操作  | 拥有的奶牛 | 输出 |\n| -------- | ----- | ---------- | ---- |\n| 1        | `a 5` | 5          | 5    |\n| 2        | `a 3` | 5,3        | 3    |\n| 3        | `a 7` | 5,3,7      | 7    |\n| 4        | `s`   | 5,3        | 3    |\n| 5        | `t 2` | 5          | 5    |\n| 6        | `a 2` | 5,2        | 2    |\n| 7        | `t 4` | 5,3,7      | 7    |\n| 8        | `a 4` | 5,3,7,4    | 4    |\n| 9        | `s`   | 5,3,7      | 7    |\n| 10       | `t 7` | 5,2        | 2    |\n| 11       | `s`   | 5          | 5    |\n| 12       | `s`   | /          | -1   |", "locale": "zh-CN"}}}
{"pid": "P6183", "type": "P", "difficulty": 2, "samples": [["3", "OOO\nOXO\nOXX\nOOX\nXOX\nXXX\nXXO\nXOO\nOOO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "USACO", "Special Judge", "深度优先搜索 DFS"], "title": "[USACO10MAR] The Rock Game S", "background": "", "description": "在奶牛回家休息和娱乐之前，Farmer John 希望它们通过玩游戏获得一些智力上的刺激。\n\n游戏板由 $n$ 个相同的洞组成，这些洞最初**都是空的**。一头母牛要么用石头盖住一个空的洞，要么揭开一个先前被盖住的洞。**游戏状态**的定义是所有洞是否被石头覆盖的情况。\n\n游戏的目标是让奶牛到达**每个可能的游戏状态**一次，最后回到初始状态。\n\n以下是他们其中一次游戏的示例（空的洞用 `O` 表示，用石头盖住的洞用 `X` 表示）：\n\n| 时刻 | 洞 1 | 洞 2 | 洞 3 | 描述 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | O | O | O | 一开始所有的洞都是空的 |\n| $1$ | O | O | X | 盖上洞 3 |\n| $2$ | X | O | X | 盖上洞 1 |\n| $3$ | X | O | O | 打开洞 3 |\n| $4$ | X | X | O | 盖上洞 2 |\n| $5$ | O | X | O | 打开洞 1 |\n| $6$ | O | X | X | 盖上洞 3 |\n| $7$ | X | X | X | 盖上洞 1 |\n\n现在牛被卡住玩不下去了！他们必须打开一个洞，然而不管他们打开哪个洞，他们都会到达一个他们已经到达过的状态。例如，如果他们从第二个洞中取出岩石，他们将到达他们在时刻 $2$ 已经访问过的状态（`X O X`）。\n\n下面是一个 3 个孔的有效解决方案：\n\n| 时间 | 洞 1 | 洞 2 | 洞 3 | 描述 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | O | O | O | 一开始所有的洞都是空的 |\n| $1$ | O | X | O | 盖上洞 2 |\n| $2$ | O | X | X | 盖上洞 3 |\n| $3$ | O | O | X | 打开洞 2 |\n| $4$ | X | O | X | 盖上洞 1 |\n| $5$ | X | X | X | 盖上洞 2 |\n| $6$ | X | X | O | 打开洞 3 |\n| $7$ | X | O | O | 打开洞 2 |\n| $8$ | O | O | O | 打开洞 1，恢复到原来的状态 |\n\n现在，奶牛们厌倦了这个游戏，它们想找你帮忙。\n\n给定 $n$，求游戏的有效解决方案序列。如果有多个解决方案，则输出**任意一个**。", "inputFormat": "仅一行，一个整数 $n$。", "outputFormat": "共 $2^n+1$ 行，每行一个长度为 $n$ 的字符串，其中只包含字符 `O` 和 `X`，该行中的第 $i$ 个字符表示第 $i$ 个孔在此状态下是被覆盖还是未覆盖，第一行和最后一行必须全部都是 `O`。", "hint": "#### 样例 1 说明\n\n见题目描述。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，有 $1\\le n\\le15$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO10MAR] The Rock Game S", "background": "", "description": "在奶牛回家休息和娱乐之前，Farmer John 希望它们通过玩游戏获得一些智力上的刺激。\n\n游戏板由 $n$ 个相同的洞组成，这些洞最初**都是空的**。一头母牛要么用石头盖住一个空的洞，要么揭开一个先前被盖住的洞。**游戏状态**的定义是所有洞是否被石头覆盖的情况。\n\n游戏的目标是让奶牛到达**每个可能的游戏状态**一次，最后回到初始状态。\n\n以下是他们其中一次游戏的示例（空的洞用 `O` 表示，用石头盖住的洞用 `X` 表示）：\n\n| 时刻 | 洞 1 | 洞 2 | 洞 3 | 描述 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | O | O | O | 一开始所有的洞都是空的 |\n| $1$ | O | O | X | 盖上洞 3 |\n| $2$ | X | O | X | 盖上洞 1 |\n| $3$ | X | O | O | 打开洞 3 |\n| $4$ | X | X | O | 盖上洞 2 |\n| $5$ | O | X | O | 打开洞 1 |\n| $6$ | O | X | X | 盖上洞 3 |\n| $7$ | X | X | X | 盖上洞 1 |\n\n现在牛被卡住玩不下去了！他们必须打开一个洞，然而不管他们打开哪个洞，他们都会到达一个他们已经到达过的状态。例如，如果他们从第二个洞中取出岩石，他们将到达他们在时刻 $2$ 已经访问过的状态（`X O X`）。\n\n下面是一个 3 个孔的有效解决方案：\n\n| 时间 | 洞 1 | 洞 2 | 洞 3 | 描述 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | O | O | O | 一开始所有的洞都是空的 |\n| $1$ | O | X | O | 盖上洞 2 |\n| $2$ | O | X | X | 盖上洞 3 |\n| $3$ | O | O | X | 打开洞 2 |\n| $4$ | X | O | X | 盖上洞 1 |\n| $5$ | X | X | X | 盖上洞 2 |\n| $6$ | X | X | O | 打开洞 3 |\n| $7$ | X | O | O | 打开洞 2 |\n| $8$ | O | O | O | 打开洞 1，恢复到原来的状态 |\n\n现在，奶牛们厌倦了这个游戏，它们想找你帮忙。\n\n给定 $n$，求游戏的有效解决方案序列。如果有多个解决方案，则输出**任意一个**。", "inputFormat": "仅一行，一个整数 $n$。", "outputFormat": "共 $2^n+1$ 行，每行一个长度为 $n$ 的字符串，其中只包含字符 `O` 和 `X`，该行中的第 $i$ 个字符表示第 $i$ 个孔在此状态下是被覆盖还是未覆盖，第一行和最后一行必须全部都是 `O`。", "hint": "#### 样例 1 说明\n\n见题目描述。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，有 $1\\le n\\le15$。", "locale": "zh-CN"}}}
{"pid": "P6184", "type": "P", "difficulty": 2, "samples": [["6", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "USACO"], "title": "[USACO08OCT] Building A Fence G", "background": "勤奋的 Farmer John 想要建造一个由四面围成的栅栏来关住那些奶牛。他现在有一块长度为$N$（$4 \\leq N \\leq 2,500$）的长木板，他需要把这块长木板切成边长均为正整数的四块，使得他能建造一个栅栏。 ", "description": "请问他有多少种不同的切割方式能使切割出来的木板围成一个四面的栅栏。 \n\n注意： \n\n1. 不要考虑对称性的问题，不需要去除对称的方案和类似的复杂问题；\n2. 栅栏围成的面积必须大于 0；\n3. 结果可以用 32 位整数存储。", "inputFormat": "一个整数 $N$。", "outputFormat": "Farmer John 能将木板分割开来并能围成四边形的方案数。", "hint": "Farmer John 有 10 种方法将木板分成四块：\n- (1, 1, 1 ,3);\n- (1, 1, 2, 2); \n- (1, 1, 3, 1); \n- (1, 2, 1, 2); \n- (1, 2, 2, 1); \n- (1, 3, 1, 1); \n- (2, 1, 1, 2); \n- (2, 1, 2, 1); \n- (2, 2, 1, 1);\n- (3, 1, 1, 1)。\n\n其中有四种情况是不能围成一个四边形的：\n- (1, 1, 1, 3),\n- (1, 1, 3, 1),\n- (1, 3, 1, 1),\n- (3, 1, 1, 1)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO08OCT] Building A Fence G", "background": "勤奋的 Farmer John 想要建造一个由四面围成的栅栏来关住那些奶牛。他现在有一块长度为$N$（$4 \\leq N \\leq 2,500$）的长木板，他需要把这块长木板切成边长均为正整数的四块，使得他能建造一个栅栏。 ", "description": "请问他有多少种不同的切割方式能使切割出来的木板围成一个四面的栅栏。 \n\n注意： \n\n1. 不要考虑对称性的问题，不需要去除对称的方案和类似的复杂问题；\n2. 栅栏围成的面积必须大于 0；\n3. 结果可以用 32 位整数存储。", "inputFormat": "一个整数 $N$。", "outputFormat": "Farmer John 能将木板分割开来并能围成四边形的方案数。", "hint": "Farmer John 有 10 种方法将木板分成四块：\n- (1, 1, 1 ,3);\n- (1, 1, 2, 2); \n- (1, 1, 3, 1); \n- (1, 2, 1, 2); \n- (1, 2, 2, 1); \n- (1, 3, 1, 1); \n- (2, 1, 1, 2); \n- (2, 1, 2, 1); \n- (2, 2, 1, 1);\n- (3, 1, 1, 1)。\n\n其中有四种情况是不能围成一个四边形的：\n- (1, 1, 1, 3),\n- (1, 1, 3, 1),\n- (1, 3, 1, 1),\n- (3, 1, 1, 1)。", "locale": "zh-CN"}}}
{"pid": "P6185", "type": "P", "difficulty": 5, "samples": [["3\n1 1\n1\n3\n1 1 1\n2 3\n1 2\n4 5\n1 1 2\n2 1 2\n1 1 2\n3 3\n1 2 3\n5 5 4\n1 1 2\n1 1 3\n2 2 3", "YES\nYES\nYES"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "并查集", "二分图", "NOI Online"], "title": "[NOI Online #1 提高组] 序列", "background": "## 由于本题数据较难构造，所以无法保证卡掉所有错误做法。\n\n", "description": "小 D 有一个长度为 $n$ 的整数序列 $a_{1 \\dots n}$，她想通过若干次操作把它变成序列 $b_i$。\n\n小 D 有 $m$ 种可选的操作，第 $i$ 种操作可使用三元组 $(t_i,u_i,v_i)$ 描述：若 $t_i=1$，则她可以使 $a_{u_i}$ 与 $a_{v_i}$ 都加一或都减一；若 $t_i=2$，则她可以使 $a_{u_i}$ 减一、$a_{v_i}$ 加一，或是 $a_{u_i}$ 加一、$a_{v_i}$ 减一，因此当 $u_i=v_i$ 时，这种操作相当于没有操作。\n\n小 D 可以以任意顺序执行操作，且每种操作都可进行无限次。现在给定序列与所有操作，请你帮她判断是否存在一种方案能将 $a_i$ 变为 $b_i$。题目保证两个序列长度都为 $n$。若方案存在请输出 `YES`，否则输出 `NO`。", "inputFormat": "本题输入文件包含多组数据。\n\n第一行一个正整数 $T$ 表示数据组数。对于每组数据：\n\n第一行两个整数 $n,m$，表示序列长度与操作种数。\n\n第二行 $n$ 个整数表示序列 $a_i$。\n\n第三行 $n$ 个整数表示序列 $b_i$。\n\n接下来 $m$ 行每行三个整数 $t_i,u_i,v_i$，第 $i$ 行描述操作 $i$。\n\n注意：同一个三元组 $(t_i,u_i,v_i)$ 可能在输入中出现多次。", "outputFormat": "对于每组数据输出一行一个字符串 `YES` 或 `NO` 表示答案。", "hint": "#### 样例 1 解释\n\n第一组数据：使用一次操作 $1$。  \n第二组数据：使用三次操作 $1$。  \n第三组数据：使用三次操作 $1$，令 $a_1,a_2$ 都增加 $3$，再使用一次操作 $2$，令 $a_1,a_3$ 都增加 $1$。\n\n---\n\n#### 数据范围与提示\n\n对于测试点 $1 \\sim 5$：$n=2$，$m=1$，$a_i,b_i \\le 99$，$u_1 \\ne v_1$，$t_1=1$。  \n对于测试点 $6 \\sim 10$：$n=2$，$m=1$，$a_i,b_i \\le 99$，$u_1 \\ne v_1$，$t_1=2$。  \n对于测试点 $11 \\sim 12$：$n=2$，$a_i,b_i \\le 99$，$u_i \\ne v_i$。  \n对于测试点 $13 \\sim 16$：$t_i=2$。  \n对于测试点 $17$：$n,m \\le 20$。  \n对于测试点 $18$：$n,m \\le 10^3$。  \n对于所有测试点：$1 \\le T \\le 10$，$1 \\le n,m \\le 10^5$，$1 \\le a_i,b_i \\le 10^9$，$t_i \\in \\{1,2\\}$，$1\\le u_i,v_i \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online #1 提高组] 序列", "background": "## 由于本题数据较难构造，所以无法保证卡掉所有错误做法。\n\n", "description": "小 D 有一个长度为 $n$ 的整数序列 $a_{1 \\dots n}$，她想通过若干次操作把它变成序列 $b_i$。\n\n小 D 有 $m$ 种可选的操作，第 $i$ 种操作可使用三元组 $(t_i,u_i,v_i)$ 描述：若 $t_i=1$，则她可以使 $a_{u_i}$ 与 $a_{v_i}$ 都加一或都减一；若 $t_i=2$，则她可以使 $a_{u_i}$ 减一、$a_{v_i}$ 加一，或是 $a_{u_i}$ 加一、$a_{v_i}$ 减一，因此当 $u_i=v_i$ 时，这种操作相当于没有操作。\n\n小 D 可以以任意顺序执行操作，且每种操作都可进行无限次。现在给定序列与所有操作，请你帮她判断是否存在一种方案能将 $a_i$ 变为 $b_i$。题目保证两个序列长度都为 $n$。若方案存在请输出 `YES`，否则输出 `NO`。", "inputFormat": "本题输入文件包含多组数据。\n\n第一行一个正整数 $T$ 表示数据组数。对于每组数据：\n\n第一行两个整数 $n,m$，表示序列长度与操作种数。\n\n第二行 $n$ 个整数表示序列 $a_i$。\n\n第三行 $n$ 个整数表示序列 $b_i$。\n\n接下来 $m$ 行每行三个整数 $t_i,u_i,v_i$，第 $i$ 行描述操作 $i$。\n\n注意：同一个三元组 $(t_i,u_i,v_i)$ 可能在输入中出现多次。", "outputFormat": "对于每组数据输出一行一个字符串 `YES` 或 `NO` 表示答案。", "hint": "#### 样例 1 解释\n\n第一组数据：使用一次操作 $1$。  \n第二组数据：使用三次操作 $1$。  \n第三组数据：使用三次操作 $1$，令 $a_1,a_2$ 都增加 $3$，再使用一次操作 $2$，令 $a_1,a_3$ 都增加 $1$。\n\n---\n\n#### 数据范围与提示\n\n对于测试点 $1 \\sim 5$：$n=2$，$m=1$，$a_i,b_i \\le 99$，$u_1 \\ne v_1$，$t_1=1$。  \n对于测试点 $6 \\sim 10$：$n=2$，$m=1$，$a_i,b_i \\le 99$，$u_1 \\ne v_1$，$t_1=2$。  \n对于测试点 $11 \\sim 12$：$n=2$，$a_i,b_i \\le 99$，$u_i \\ne v_i$。  \n对于测试点 $13 \\sim 16$：$t_i=2$。  \n对于测试点 $17$：$n,m \\le 20$。  \n对于测试点 $18$：$n,m \\le 10^3$。  \n对于所有测试点：$1 \\le T \\le 10$，$1 \\le n,m \\le 10^5$，$1 \\le a_i,b_i \\le 10^9$，$t_i \\in \\{1,2\\}$，$1\\le u_i,v_i \\le n$。", "locale": "zh-CN"}}}
{"pid": "P6186", "type": "P", "difficulty": 5, "samples": [["3 6\n1 2 3\n2 0\n1 1\n1 2\n2 0\n2 1\n2 2", "0\n2\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "线段树", "树状数组", "NOI Online"], "title": "[NOI Online #1 提高组] 冒泡排序", "background": "", "description": "给定一个 $1 ∼ n$ 的排列 $p_i$，接下来有 $m$ 次操作，操作共两种：\n1. 交换操作：给定 $x$，将当前排列中的第 $x$ 个数与第 $x+1$ 个数交换位置。\n2. 询问操作：给定 $k$，请你求出当前排列经过 $k$ 轮冒泡排序后的逆序对个数。\n对一个长度为 $n$ 的排列 $p_i$ 进行一轮冒泡排序的伪代码如下：\n```\nfor i = 1 to n-1:\n  if p[i] > p[i + 1]:\n    swap(p[i], p[i + 1])\n```", "inputFormat": "第一行两个整数 $n$，$m$，表示排列长度与操作个数。\n\n第二行 $n$ 个整数表示排列 $p_i$。\n\n接下来 $m$ 行每行两个整数 $t_i$，$c_i$，描述一次操作：\n- 若 $t_i=1$，则本次操作是交换操作，$x=c_i$；\n- 若 $t_i=2$，则本次操作是询问操作，$k=c_i$。", "outputFormat": "对于每次询问操作输出一行一个整数表示答案。", "hint": "#### 样例一解释\n第一次操作：排列为 $\\{1,2,3\\}$，经过 0 轮冒泡排序后为 $\\{1,2,3\\}$，$0$ 个逆序对。\n\n第二次操作：排列变为 $\\{2,1,3\\}$。\n\n第三次操作：排列变为 $\\{2,3,1\\}$。\n\n第四次操作：经过 $0$ 轮冒泡排序后排列变为 $\\{2,3,1\\}$，$2$ 个逆序对。\n\n第五次操作：经过 $1$ 轮冒泡排序后排列变为 $\\{2,1,3\\}$，$1$ 个逆序对。\n\n第六次操作：经过 $2$ 轮冒泡排序后排列变为 $\\{1,2,3\\}$，$0$ 个逆序对。\n\n---\n\n#### 数据范围与提示\n对于测试点 1 ∼ 2：$n,m \\leq 100$。\n\n对于测试点 3 ∼ 4：$n,m \\leq 2000$。\n\n对于测试点 5 ∼ 6：交换操作个数不超过 $100$。\n\n对于所有测试点：$2 \\leq n,m \\leq 2 \\times 10^5$，$t_i \\in \\{1,2\\}$，$1 \\leq x < n$，$0 \\leq k < 2^{31}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online #1 提高组] 冒泡排序", "background": "", "description": "给定一个 $1 ∼ n$ 的排列 $p_i$，接下来有 $m$ 次操作，操作共两种：\n1. 交换操作：给定 $x$，将当前排列中的第 $x$ 个数与第 $x+1$ 个数交换位置。\n2. 询问操作：给定 $k$，请你求出当前排列经过 $k$ 轮冒泡排序后的逆序对个数。\n对一个长度为 $n$ 的排列 $p_i$ 进行一轮冒泡排序的伪代码如下：\n```\nfor i = 1 to n-1:\n  if p[i] > p[i + 1]:\n    swap(p[i], p[i + 1])\n```", "inputFormat": "第一行两个整数 $n$，$m$，表示排列长度与操作个数。\n\n第二行 $n$ 个整数表示排列 $p_i$。\n\n接下来 $m$ 行每行两个整数 $t_i$，$c_i$，描述一次操作：\n- 若 $t_i=1$，则本次操作是交换操作，$x=c_i$；\n- 若 $t_i=2$，则本次操作是询问操作，$k=c_i$。", "outputFormat": "对于每次询问操作输出一行一个整数表示答案。", "hint": "#### 样例一解释\n第一次操作：排列为 $\\{1,2,3\\}$，经过 0 轮冒泡排序后为 $\\{1,2,3\\}$，$0$ 个逆序对。\n\n第二次操作：排列变为 $\\{2,1,3\\}$。\n\n第三次操作：排列变为 $\\{2,3,1\\}$。\n\n第四次操作：经过 $0$ 轮冒泡排序后排列变为 $\\{2,3,1\\}$，$2$ 个逆序对。\n\n第五次操作：经过 $1$ 轮冒泡排序后排列变为 $\\{2,1,3\\}$，$1$ 个逆序对。\n\n第六次操作：经过 $2$ 轮冒泡排序后排列变为 $\\{1,2,3\\}$，$0$ 个逆序对。\n\n---\n\n#### 数据范围与提示\n对于测试点 1 ∼ 2：$n,m \\leq 100$。\n\n对于测试点 3 ∼ 4：$n,m \\leq 2000$。\n\n对于测试点 5 ∼ 6：交换操作个数不超过 $100$。\n\n对于所有测试点：$2 \\leq n,m \\leq 2 \\times 10^5$，$t_i \\in \\{1,2\\}$，$1 \\leq x < n$，$0 \\leq k < 2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P6187", "type": "P", "difficulty": 5, "samples": [["6 4\n1 2 3 4 5 6\n0\n1\n2\n3", "91\n82\n85\n88"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2020", "NOI Online"], "title": "[NOI Online #1 提高组] 最小环", "background": "", "description": "给定一个长度为 $n$ 的正整数序列 $a_i$，下标从 $1$ 开始编号。我们将该序列视为一个首尾相邻的环，更具体地，对于下标为 $i$, $j(i \\leqslant j)$ 的两个数 $a_i$, $a_j$，它们的距离为 $\\min(j-i, i+n-j)$。\n\n现在再给定 $m$ 个整数 $k_1$, $k_2$,..., $k_m$，对每个 $k_i(i=1$, $2$,..., $m)$，你需要将上面的序列 $a_i$ 重新排列，使得环上任意两个距离为 $k_i$ 的数字的乘积之和最大。", "inputFormat": "第一行两个正整数 $n$, $m$，表示序列长度与询问数。\n\n接下来一行 $n$ 个正整数表示 $a_i$。\n\n接下来 $m$ 行每行一个非负整数表示 $k_i$。\n", "outputFormat": "共 $m$ 行，每行一个整数表示答案。", "hint": "#### 输入输出样例 1 解释\n- $k=0$ 时：答案为每个数平方的和。\n- $k=1$ 时：一种最优方案：$\\{3,1,2,4,6,5\\}$。答案为 $3 \\times 1 + 1 \\times 2 + 2 \\times 4 + 4 \\times 6 + 6 \\times 5 + 5 \\times 3 = 82$。\n- $k=2$ 时：一种最优方案：$\\{3,6,1,4,2,5\\}$。答案为 $3 \\times 1 + 1 \\times 2 + 2 \\times 3 + 6 \\times 4 + 4 \\times 5 + 5 \\times 6 = 85$。\n- $k=3$ 时，一个合法的排列是 $1,5,3,2,6,4$ ，答案为 $88$。注意这里答案不是 $44$。\n\n---\n\n#### 数据范围与提示\n对于所有测试数据：$1 \\leqslant m \\leqslant n \\leqslant 2 \\times 10^5$，$0 \\leqslant k \\leqslant \\lfloor n/2\\rfloor$，$1 \\leqslant a_i \\leqslant 10^5$。\n\n| 测试点编号 | $n \\leqslant$ | 特殊性质|\n| :--- | :--- | :--- |\n| 1 | $10$ | 无 |\n| 2 | $18$ | 无 |\n| 3 | $36$ | $n$ 为偶数且 $m=1$，$k=2$ |\n| 4,5 | $1000$ | $m \\leqslant 10$，$k=1$ |\n| 6 | $50$ | $m \\leqslant 10$，$k \\leqslant 2$ |\n| 7,8 | $3000$ | 无 |\n| 9,10 | $2 \\times 10^5$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online #1 提高组] 最小环", "background": "", "description": "给定一个长度为 $n$ 的正整数序列 $a_i$，下标从 $1$ 开始编号。我们将该序列视为一个首尾相邻的环，更具体地，对于下标为 $i$, $j(i \\leqslant j)$ 的两个数 $a_i$, $a_j$，它们的距离为 $\\min(j-i, i+n-j)$。\n\n现在再给定 $m$ 个整数 $k_1$, $k_2$,..., $k_m$，对每个 $k_i(i=1$, $2$,..., $m)$，你需要将上面的序列 $a_i$ 重新排列，使得环上任意两个距离为 $k_i$ 的数字的乘积之和最大。", "inputFormat": "第一行两个正整数 $n$, $m$，表示序列长度与询问数。\n\n接下来一行 $n$ 个正整数表示 $a_i$。\n\n接下来 $m$ 行每行一个非负整数表示 $k_i$。\n", "outputFormat": "共 $m$ 行，每行一个整数表示答案。", "hint": "#### 输入输出样例 1 解释\n- $k=0$ 时：答案为每个数平方的和。\n- $k=1$ 时：一种最优方案：$\\{3,1,2,4,6,5\\}$。答案为 $3 \\times 1 + 1 \\times 2 + 2 \\times 4 + 4 \\times 6 + 6 \\times 5 + 5 \\times 3 = 82$。\n- $k=2$ 时：一种最优方案：$\\{3,6,1,4,2,5\\}$。答案为 $3 \\times 1 + 1 \\times 2 + 2 \\times 3 + 6 \\times 4 + 4 \\times 5 + 5 \\times 6 = 85$。\n- $k=3$ 时，一个合法的排列是 $1,5,3,2,6,4$ ，答案为 $88$。注意这里答案不是 $44$。\n\n---\n\n#### 数据范围与提示\n对于所有测试数据：$1 \\leqslant m \\leqslant n \\leqslant 2 \\times 10^5$，$0 \\leqslant k \\leqslant \\lfloor n/2\\rfloor$，$1 \\leqslant a_i \\leqslant 10^5$。\n\n| 测试点编号 | $n \\leqslant$ | 特殊性质|\n| :--- | :--- | :--- |\n| 1 | $10$ | 无 |\n| 2 | $18$ | 无 |\n| 3 | $36$ | $n$ 为偶数且 $m=1$，$k=2$ |\n| 4,5 | $1000$ | $m \\leqslant 10$，$k=1$ |\n| 6 | $50$ | $m \\leqslant 10$，$k \\leqslant 2$ |\n| 7,8 | $3000$ | 无 |\n| 9,10 | $2 \\times 10^5$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P6188", "type": "P", "difficulty": 2, "samples": [["1\n", "-1"], ["14\n", "1 1 1"], ["33\n", "1 2 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2020", "枚举", "NOI Online"], "title": "[NOI Online #1 入门组] 文具订购", "background": "", "description": "小明的班上共有 $n$ 元班费，同学们准备使用班费集体购买 $3$ 种物品：\n\n1. 圆规，每个 $7$ 元。\n2. 笔，每支 $4$ 元。\n3. 笔记本，每本 $3$ 元。\n\n小明负责订购文具，设圆规，笔，笔记本的订购数量分别为 $a,b,c$，他订购的原则依次如下：\n\n1. $n$ 元钱必须正好用光，即 $7a+4b+3c=n$。\n2. 在满足以上条件情况下，成套的数量尽可能大，即 $a,b,c$ 中的最小值尽可能大。\n3. 在满足以上条件情况下，物品的总数尽可能大，即 $a+b+c$ 尽可能大。\n\n请你帮助小明求出满足条件的最优方案。可以证明若存在方案，则最优方案唯一。\n\n ", "inputFormat": "输入仅一行一个整数，代表班费数量 $n$。 ", "outputFormat": "如果问题无解，请输出 $-1$。\n\n否则输出一行三个用空格隔开的整数 $a, b, c$，分别代表圆规、笔、笔记本的个数。\n\n", "hint": "#### 样例输入输出 3 解释\n\n$a=2,b=4,c=1$ 也是满足条件 $1,2$ 的方案，但对于条件 $3$，该方案只买了 $7$ 个物品，不如 $a=1,b=2,c=6$ 的方案。 \n\n#### 数据规模与约定\n\n- 对于测试点 $1 \\sim 6$，保证 $n \\leq 14$。\n- 对于测试点 $7 \\sim 12$，保证 $n$ 是 $14$ 的倍数。\n- 对于测试点 $13 \\sim 18$，保证 $n \\leq 100$。\n- 对于全部的测试点，保证 $0 \\leq n \\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online #1 入门组] 文具订购", "background": "", "description": "小明的班上共有 $n$ 元班费，同学们准备使用班费集体购买 $3$ 种物品：\n\n1. 圆规，每个 $7$ 元。\n2. 笔，每支 $4$ 元。\n3. 笔记本，每本 $3$ 元。\n\n小明负责订购文具，设圆规，笔，笔记本的订购数量分别为 $a,b,c$，他订购的原则依次如下：\n\n1. $n$ 元钱必须正好用光，即 $7a+4b+3c=n$。\n2. 在满足以上条件情况下，成套的数量尽可能大，即 $a,b,c$ 中的最小值尽可能大。\n3. 在满足以上条件情况下，物品的总数尽可能大，即 $a+b+c$ 尽可能大。\n\n请你帮助小明求出满足条件的最优方案。可以证明若存在方案，则最优方案唯一。\n\n ", "inputFormat": "输入仅一行一个整数，代表班费数量 $n$。 ", "outputFormat": "如果问题无解，请输出 $-1$。\n\n否则输出一行三个用空格隔开的整数 $a, b, c$，分别代表圆规、笔、笔记本的个数。\n\n", "hint": "#### 样例输入输出 3 解释\n\n$a=2,b=4,c=1$ 也是满足条件 $1,2$ 的方案，但对于条件 $3$，该方案只买了 $7$ 个物品，不如 $a=1,b=2,c=6$ 的方案。 \n\n#### 数据规模与约定\n\n- 对于测试点 $1 \\sim 6$，保证 $n \\leq 14$。\n- 对于测试点 $7 \\sim 12$，保证 $n$ 是 $14$ 的倍数。\n- 对于测试点 $13 \\sim 18$，保证 $n \\leq 100$。\n- 对于全部的测试点，保证 $0 \\leq n \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P6189", "type": "P", "difficulty": 6, "samples": [["4 44\n", "5"], ["66 666666\n", "323522"], ["66666 66666666\n", "45183149\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "2020", "NOI Online", "根号分治"], "title": "[NOI Online #1 入门组] 跑步", "background": "", "description": "小 H 是一个热爱运动的孩子，某天他想给自己制定一个跑步计划。小 H 计划跑 $n$ 米，其中第 $i(i \\geq 1)$ 分钟要跑 $x_i$ 米（$x_i$ 是正整数），但没有确定好总时长。\n\n由于随着跑步时间增加，小 H 会越来越累，所以小 H 的计划必须满足对于任意 $i(i >1)$ 都满足 $x_i \\leq x_{i-1}$。\n\n现在小 H 想知道一共有多少个不同的满足条件的计划，请你帮助他。两个计划不同当且仅当跑步的总时长不同，或者存在一个 $i$，使得两个计划中 $x_i$ 不相同。\n\n由于最后的答案可能很大，你只需要求出答案对 $p$ 取模的结果。 ", "inputFormat": "输入只有一行两个整数，代表总米数 $n$ 和模数 $p$。", "outputFormat": "输出一行一个整数，代表答案对 $p$ 取模的结果。", "hint": "#### 样例输入输出 1 解释\n\n五个不同的计划分别是：$\\{1,1,1,1\\}$，$\\{2,1,1\\}$，$\\{3,1\\}$，$\\{2,2\\}$，$\\{4\\}$。 \n\n---\n\n#### 数据规模与约定\n\n本题共 $10$ 个测试点，各测试点信息如下表。\n\n| 测试点编号 | $n \\leq$ | 测试点编号 | $n \\leq$ |\n| :----------: | :---------: | :----------: | :---------: |\n| $1$ | $5$ | $6$ | $2\\times 10^3$ |\n| $2$ | $10$ | $7$ | $5\\times 10^3$ |\n| $3$ | $50$ | $8$ | $2\\times 10^4$ |\n| $4$ | $100$ | $9$ | $5\\times 10^4$ |\n| $5$ | $500$ | $10$ | $10^5$|\n\n对于全部的测试点，保证 $1 \\leq n \\leq 10^5$，$1 \\leq p < 2^{30}$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI Online #1 Junior] Running", "background": "", "description": "Little H is a child who loves sports. One day, he wants to make a running plan for himself. Little H plans to run $n$ meters in total. In the $i$-th minute ($i \\geq 1$), he will run $x_i$ meters ($x_i$ is a positive integer), but the total duration is not fixed.\n\nAs the running time increases, Little H will get more and more tired, so his plan must satisfy that for any $i$ ($i > 1$), $x_i \\leq x_{i-1}$.\n\nNow Little H wants to know how many different plans satisfy the conditions. Two plans are different if and only if the total duration is different, or there exists an $i$ such that $x_i$ is different in the two plans.\n\nSince the final answer may be very large, you only need to output the result modulo $p$.", "inputFormat": "The input contains only one line with two integers, representing the total meters $n$ and the modulus $p$.", "outputFormat": "Output one line with one integer, representing the answer modulo $p$.", "hint": "#### Explanation of Sample Input/Output 1\n\nThe five different plans are: $\\{1,1,1,1\\}$, $\\{2,1,1\\}$, $\\{3,1\\}$, $\\{2,2\\}$, $\\{4\\}$.\n\n---\n\n#### Constraints\n\nThis problem has $10$ test points. The information for each test point is shown in the table below.\n\n| Test Point ID | $n \\leq$ | Test Point ID | $n \\leq$ |\n| :----------: | :---------: | :----------: | :---------: |\n| $1$ | $5$ | $6$ | $2\\times 10^3$ |\n| $2$ | $10$ | $7$ | $5\\times 10^3$ |\n| $3$ | $50$ | $8$ | $2\\times 10^4$ |\n| $4$ | $100$ | $9$ | $5\\times 10^4$ |\n| $5$ | $500$ | $10$ | $10^5$ |\n\nFor all test points, it is guaranteed that $1 \\leq n \\leq 10^5$, $1 \\leq p < 2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI Online #1 入门组] 跑步", "background": "", "description": "小 H 是一个热爱运动的孩子，某天他想给自己制定一个跑步计划。小 H 计划跑 $n$ 米，其中第 $i(i \\geq 1)$ 分钟要跑 $x_i$ 米（$x_i$ 是正整数），但没有确定好总时长。\n\n由于随着跑步时间增加，小 H 会越来越累，所以小 H 的计划必须满足对于任意 $i(i >1)$ 都满足 $x_i \\leq x_{i-1}$。\n\n现在小 H 想知道一共有多少个不同的满足条件的计划，请你帮助他。两个计划不同当且仅当跑步的总时长不同，或者存在一个 $i$，使得两个计划中 $x_i$ 不相同。\n\n由于最后的答案可能很大，你只需要求出答案对 $p$ 取模的结果。 ", "inputFormat": "输入只有一行两个整数，代表总米数 $n$ 和模数 $p$。", "outputFormat": "输出一行一个整数，代表答案对 $p$ 取模的结果。", "hint": "#### 样例输入输出 1 解释\n\n五个不同的计划分别是：$\\{1,1,1,1\\}$，$\\{2,1,1\\}$，$\\{3,1\\}$，$\\{2,2\\}$，$\\{4\\}$。 \n\n---\n\n#### 数据规模与约定\n\n本题共 $10$ 个测试点，各测试点信息如下表。\n\n| 测试点编号 | $n \\leq$ | 测试点编号 | $n \\leq$ |\n| :----------: | :---------: | :----------: | :---------: |\n| $1$ | $5$ | $6$ | $2\\times 10^3$ |\n| $2$ | $10$ | $7$ | $5\\times 10^3$ |\n| $3$ | $50$ | $8$ | $2\\times 10^4$ |\n| $4$ | $100$ | $9$ | $5\\times 10^4$ |\n| $5$ | $500$ | $10$ | $10^5$|\n\n对于全部的测试点，保证 $1 \\leq n \\leq 10^5$，$1 \\leq p < 2^{30}$。", "locale": "zh-CN"}}}
{"pid": "P6190", "type": "P", "difficulty": 6, "samples": [["4 3 2\n1 2 5\n2 3 4\n3 4 1\n", "-8"], ["2 2 2\n1 2 10\n2 1 1\n", "-19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "图论", "2020", "倍增", "矩阵加速", "最短路", "NOI Online"], "title": "[NOI Online #1 入门组] 魔法", "background": "", "description": "C 国由 $n$ 座城市与 $m$ 条有向道路组成，城市与道路都从 $1$ 开始编号，经过 $i$ 号道路需要 $t_i$ 的费用。\n\n现在你要从 $1$ 号城市出发去 $n$ 号城市，你可以施展最多 $k$ 次魔法，使得通过下一条道路时，需要的费用变为原来的相反数，即费用从 $t_i$ 变为 $-t_i$。请你算一算，你至少要花费多少费用才能完成这次旅程。\n\n注意：使用魔法只是改变一次的花费，而不改变一条道路自身的 $t_i$；最终的费用可以为负，并且一个城市可以经过多次（包括 $n$ 号城市）。 ", "inputFormat": "输入的第一行有三个整数，分别代表城市数 $n$，道路数 $m$ 和魔法次数限制 $k$。\n\n第 $2$ 到第 $(m + 1)$ 行，每行三个整数。第 $(i + 1)$ 行的整数 $u_i, v_i, t_i$ 表示存在一条从 $u_i$ 到 $v_i$ 的单向道路，经过它需要花费 $t_i$。", "outputFormat": "输出一行一个整数表示最小的花费。", "hint": "#### 输入输出样例 1 解释\n\n依次经过 $1$ 号道路、$2$ 号道路、$3$ 号道路，并在经过 $1,2$ 号道路前使用魔法。 \n\n#### 输入输出样例 2 解释\n\n依次经过 $1$ 号道路、$2$ 号道路、$1$ 号道路，并在两次经过 $1$ 号道路前都使用魔法。 \n\n#### 数据规模与约定\n\n本题共 $20$ 个测试点，各测试点信息见下表。\n\n| 测试点编号 | $n \\leq$ | $m \\leq$ | $k \\leq$ | 无环 |\n| :----------: | :--------: | :---------: | :--------: | :----: |\n| $1 \\sim 2$ | $5$ | $20$ | $0$ | 不保证 |\n| $3 \\sim 4$ | $10$ | $20$ | $50$ | 不保证 |\n| $5 \\sim 6$ | $10$ | $20$ | $0$| 不保证 |\n| $7 \\sim 8$ | $20$ | $200$ | $50$ | 是 |\n| $9 \\sim 10$ | $20$ | $200$ | $0$ | 不保证 |\n| $11 \\sim 12$ | $100$ | $200$ | $50$ | 是 |\n| $13 \\sim 14$ | $100$ | $200$ | $50$ | 不保证 |\n| $15 \\sim 18$ | $100$ | $2500$ | $1000$ | 不保证 |\n| $19 \\sim 20$ | $100$ | $2500$ | $10^6$ | 不保证 |\n\n对于【无环】一栏为“是”的测试点，保证给出的图是一张有向无环图，否则不对图的形态做任何保证。\n\n对于全部的测试点，保证：\n- $1 \\leq n \\leq 100$，$1 \\leq m \\leq 2500$，$0 \\leq k \\leq 10^6$。\n- $1 \\leq u_i, v_i \\leq n$，$1 \\leq t_i \\leq 10^9$。\n- 给出的图无重边和自环，且至少存在一条能从 $1$ 到达 $n$ 的路径。\n\n**民间数据使用 [CYaRon](https://github.com/luogu-dev/cyaron) 在 5 分钟内生成。如果发现数据有问题，请在讨论版发帖或私信 @[StudyingFather](/user/22030)**", "locale": "zh-CN", "translations": {"en": {"title": "[NOI Online #1 Junior] Magic", "background": "", "description": "Country C consists of $n$ cities and $m$ directed roads. Both cities and roads are numbered starting from $1$. Traversing road $i$ costs $t_i$.\n\nNow you want to travel from city $1$ to city $n$. You may cast magic at most $k$ times, so that when you traverse the next road, the cost becomes the opposite of the original, i.e. the cost changes from $t_i$ to $-t_i$. Please compute the minimum total cost needed to finish this trip.\n\nNote: Casting magic only changes the cost for one traversal, and does not change the road’s own $t_i$. The final total cost may be negative, and a city may be visited multiple times (including city $n$).", "inputFormat": "The first line contains three integers, representing the number of cities $n$, the number of roads $m$, and the limit on the number of times you can cast magic $k$.\n\nLines $2$ to $(m + 1)$ each contain three integers. On line $(i + 1)$, the integers $u_i, v_i, t_i$ indicate that there is a one-way road from $u_i$ to $v_i$, and traversing it costs $t_i$.", "outputFormat": "Output one integer in one line, representing the minimum total cost.", "hint": "#### Explanation for Sample Input/Output 1\n\nTraverse road $1$, road $2$, and road $3$ in order, and cast magic before traversing roads $1$ and $2$.\n\n#### Explanation for Sample Input/Output 2\n\nTraverse road $1$, road $2$, and road $1$ in order, and cast magic before both times you traverse road $1$.\n\n#### Constraints\n\nThis problem has $20$ test points. The information for each test point is shown in the table below.\n\n| Test Point ID | $n \\leq$ | $m \\leq$ | $k \\leq$ | Acyclic |\n| :----------: | :--------: | :---------: | :--------: | :----: |\n| $1 \\sim 2$ | $5$ | $20$ | $0$ | Not guaranteed |\n| $3 \\sim 4$ | $10$ | $20$ | $50$ | Not guaranteed |\n| $5 \\sim 6$ | $10$ | $20$ | $0$ | Not guaranteed |\n| $7 \\sim 8$ | $20$ | $200$ | $50$ | Yes |\n| $9 \\sim 10$ | $20$ | $200$ | $0$ | Not guaranteed |\n| $11 \\sim 12$ | $100$ | $200$ | $50$ | Yes |\n| $13 \\sim 14$ | $100$ | $200$ | $50$ | Not guaranteed |\n| $15 \\sim 18$ | $100$ | $2500$ | $1000$ | Not guaranteed |\n| $19 \\sim 20$ | $100$ | $2500$ | $10^6$ | Not guaranteed |\n\nFor test points where the “Acyclic” column is “Yes”, it is guaranteed that the given graph is a directed acyclic graph; otherwise, there is no guarantee about the graph structure.\n\nFor all test points, it is guaranteed that:\n- $1 \\leq n \\leq 100$, $1 \\leq m \\leq 2500$, $0 \\leq k \\leq 10^6$.\n- $1 \\leq u_i, v_i \\leq n$, $1 \\leq t_i \\leq 10^9$.\n- The given graph has no multiple edges or self-loops, and there exists at least one path from $1$ to $n$.\n\n**Unofficial testdata is generated within 5 minutes using [CYaRon](https://github.com/luogu-dev/cyaron). If you find any issues with the testdata, please post in the discussion board or send a private message to @[StudyingFather](/user/22030).**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI Online #1 入门组] 魔法", "background": "", "description": "C 国由 $n$ 座城市与 $m$ 条有向道路组成，城市与道路都从 $1$ 开始编号，经过 $i$ 号道路需要 $t_i$ 的费用。\n\n现在你要从 $1$ 号城市出发去 $n$ 号城市，你可以施展最多 $k$ 次魔法，使得通过下一条道路时，需要的费用变为原来的相反数，即费用从 $t_i$ 变为 $-t_i$。请你算一算，你至少要花费多少费用才能完成这次旅程。\n\n注意：使用魔法只是改变一次的花费，而不改变一条道路自身的 $t_i$；最终的费用可以为负，并且一个城市可以经过多次（包括 $n$ 号城市）。 ", "inputFormat": "输入的第一行有三个整数，分别代表城市数 $n$，道路数 $m$ 和魔法次数限制 $k$。\n\n第 $2$ 到第 $(m + 1)$ 行，每行三个整数。第 $(i + 1)$ 行的整数 $u_i, v_i, t_i$ 表示存在一条从 $u_i$ 到 $v_i$ 的单向道路，经过它需要花费 $t_i$。", "outputFormat": "输出一行一个整数表示最小的花费。", "hint": "#### 输入输出样例 1 解释\n\n依次经过 $1$ 号道路、$2$ 号道路、$3$ 号道路，并在经过 $1,2$ 号道路前使用魔法。 \n\n#### 输入输出样例 2 解释\n\n依次经过 $1$ 号道路、$2$ 号道路、$1$ 号道路，并在两次经过 $1$ 号道路前都使用魔法。 \n\n#### 数据规模与约定\n\n本题共 $20$ 个测试点，各测试点信息见下表。\n\n| 测试点编号 | $n \\leq$ | $m \\leq$ | $k \\leq$ | 无环 |\n| :----------: | :--------: | :---------: | :--------: | :----: |\n| $1 \\sim 2$ | $5$ | $20$ | $0$ | 不保证 |\n| $3 \\sim 4$ | $10$ | $20$ | $50$ | 不保证 |\n| $5 \\sim 6$ | $10$ | $20$ | $0$| 不保证 |\n| $7 \\sim 8$ | $20$ | $200$ | $50$ | 是 |\n| $9 \\sim 10$ | $20$ | $200$ | $0$ | 不保证 |\n| $11 \\sim 12$ | $100$ | $200$ | $50$ | 是 |\n| $13 \\sim 14$ | $100$ | $200$ | $50$ | 不保证 |\n| $15 \\sim 18$ | $100$ | $2500$ | $1000$ | 不保证 |\n| $19 \\sim 20$ | $100$ | $2500$ | $10^6$ | 不保证 |\n\n对于【无环】一栏为“是”的测试点，保证给出的图是一张有向无环图，否则不对图的形态做任何保证。\n\n对于全部的测试点，保证：\n- $1 \\leq n \\leq 100$，$1 \\leq m \\leq 2500$，$0 \\leq k \\leq 10^6$。\n- $1 \\leq u_i, v_i \\leq n$，$1 \\leq t_i \\leq 10^9$。\n- 给出的图无重边和自环，且至少存在一条能从 $1$ 到达 $n$ 的路径。\n\n**民间数据使用 [CYaRon](https://github.com/luogu-dev/cyaron) 在 5 分钟内生成。如果发现数据有问题，请在讨论版发帖或私信 @[StudyingFather](/user/22030)**", "locale": "zh-CN"}}}
{"pid": "P6191", "type": "P", "difficulty": 3, "samples": [["4 2", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递推", "2009", "USACO", "组合数学", "前缀和"], "title": "[USACO09FEB] Bulls And Cows S", "background": "一年一度的展会要来临了，Farmer John 想要把 $N$（$1 \\leq N \\leq 10^5$）只奶牛和公牛安排在单独的一行中。 John 发现最近公牛们非常好斗；假如两只公牛在这一行中靠的太近，他们就会吵架，以至于斗殴，破坏这和谐的环境。", "description": "John 非常的足智多谋，他计算出任何两只公牛之间至少要有 $K$（$0 \\leq K \\lt N$）只奶牛，这样才能避免斗殴。John 希望你帮助他计算一下有多少种安排方法，可避免任何斗殴的的发生。John 认为每头公牛都是一样的，每头奶牛都是一样的。因而，只要在一些相同的位置上有不同种类的牛，那这就算两种不同的方法。", "inputFormat": "两个整数 $N$ 和 $K$。", "outputFormat": "输出约翰可以安排的方法数。考虑到这个数可能很大，你只要输出对 $5\\,000\\,011$ 取模之后的结果就可以了。", "hint": "下面的就是 FJ 思考出可行的 6 种方案（C 代表奶牛，B 代表公牛）：\n- CCCC\n- BCCC\n- CBCC\n- CCBC\n- CCCB\n- BCCB", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO09FEB] Bulls And Cows S", "background": "一年一度的展会要来临了，Farmer John 想要把 $N$（$1 \\leq N \\leq 10^5$）只奶牛和公牛安排在单独的一行中。 John 发现最近公牛们非常好斗；假如两只公牛在这一行中靠的太近，他们就会吵架，以至于斗殴，破坏这和谐的环境。", "description": "John 非常的足智多谋，他计算出任何两只公牛之间至少要有 $K$（$0 \\leq K \\lt N$）只奶牛，这样才能避免斗殴。John 希望你帮助他计算一下有多少种安排方法，可避免任何斗殴的的发生。John 认为每头公牛都是一样的，每头奶牛都是一样的。因而，只要在一些相同的位置上有不同种类的牛，那这就算两种不同的方法。", "inputFormat": "两个整数 $N$ 和 $K$。", "outputFormat": "输出约翰可以安排的方法数。考虑到这个数可能很大，你只要输出对 $5\\,000\\,011$ 取模之后的结果就可以了。", "hint": "下面的就是 FJ 思考出可行的 6 种方案（C 代表奶牛，B 代表公牛）：\n- CCCC\n- BCCC\n- CBCC\n- CCBC\n- CCCB\n- BCCB", "locale": "zh-CN"}}}
{"pid": "P6192", "type": "P", "difficulty": 6, "samples": [["7 7 4\n1 2 3\n2 3 2\n4 3 9\n2 6 2\n4 5 3\n6 5 2\n7 6 4\n2 4 7 5\n", "11\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "最短路", "状压 DP", "模板题"], "title": "【模板】最小斯坦纳树", "background": "", "description": "给定一个包含 $n$ 个结点和 $m$ 条带权边的无向连通图 $G=(V,E)$。\n\n再给定包含 $k$ 个结点的点集 $S$，选出 $G$ 的子图 $G'=(V',E')$，使得：\n\n1. $S\\subseteq V'$；\n\n2. $G'$ 为连通图；\n\n3. $E'$ 中所有边的权值和最小。\n\n你只需要求出 $E'$ 中所有边的权值和。", "inputFormat": "第一行：三个整数 $n,m,k$，表示 $G$ 的结点数、边数和 $S$ 的大小。\n\n接下来 $m$ 行：每行三个整数 $u,v,w$，表示编号为 $u,v$ 的点之间有一条权值为 $w$ 的无向边。\n\n接下来一行：$k$ 个互不相同的正整数，表示 $S$ 的元素。", "outputFormat": "第一行：一个整数，表示 $E'$ 中边权和的最小值。", "hint": "【样例解释】\n\n样例中给出的图如下图所示，红色点为 $S$ 中的元素，红色边为 $E'$ 的元素，此时 $E'$ 中所有边的权值和为 $2+2+3+4=11$，达到最小值。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rdu06bwj.png)\n\n---\n\n【数据范围】\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 100,\\ \\ 1\\leq m\\leq 500,\\ \\ 1\\leq k\\leq 10,\\ \\ 1\\leq u,v\\leq n,\\ \\ 1\\leq w\\leq 10^6$。\n\n保证给出的无向图连通，但 **可能** 存在重边和自环。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】最小斯坦纳树", "background": "", "description": "给定一个包含 $n$ 个结点和 $m$ 条带权边的无向连通图 $G=(V,E)$。\n\n再给定包含 $k$ 个结点的点集 $S$，选出 $G$ 的子图 $G'=(V',E')$，使得：\n\n1. $S\\subseteq V'$；\n\n2. $G'$ 为连通图；\n\n3. $E'$ 中所有边的权值和最小。\n\n你只需要求出 $E'$ 中所有边的权值和。", "inputFormat": "第一行：三个整数 $n,m,k$，表示 $G$ 的结点数、边数和 $S$ 的大小。\n\n接下来 $m$ 行：每行三个整数 $u,v,w$，表示编号为 $u,v$ 的点之间有一条权值为 $w$ 的无向边。\n\n接下来一行：$k$ 个互不相同的正整数，表示 $S$ 的元素。", "outputFormat": "第一行：一个整数，表示 $E'$ 中边权和的最小值。", "hint": "【样例解释】\n\n样例中给出的图如下图所示，红色点为 $S$ 中的元素，红色边为 $E'$ 的元素，此时 $E'$ 中所有边的权值和为 $2+2+3+4=11$，达到最小值。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rdu06bwj.png)\n\n---\n\n【数据范围】\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 100,\\ \\ 1\\leq m\\leq 500,\\ \\ 1\\leq k\\leq 10,\\ \\ 1\\leq u,v\\leq n,\\ \\ 1\\leq w\\leq 10^6$。\n\n保证给出的无向图连通，但 **可能** 存在重边和自环。", "locale": "zh-CN"}}}
{"pid": "P6193", "type": "P", "difficulty": 5, "samples": [["3 \n2 \n3 \n1", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07FEB] Cow Sorting G", "background": "", "description": "Farmer John 的 $n$（$1 \\leq n \\leq 10^5$）头牛一字排开。每头奶牛都有一个“脾气暴躁”水平，范围在 $1 \\ldots 10^5$，且任意两头奶牛的脾气暴躁值不相同。由于脾气暴躁的奶牛更有可能损坏 FJ 的挤奶设备，因此 FJ 希望对奶牛进行重新排序，以便按照脾气暴躁程度依此提升的顺序排列它们。\n\n在此过程中，任何两头奶牛（不一定相邻）的位置都可以互换。由于脾气暴躁的母牛难以移动，因此 FJ 总共需要 $X + Y$ 单位的时间来交换两只脾气暴躁程度为 $X$ 和 $Y$ 的母牛。请帮助 FJ 计算将奶牛按脾气暴躁程度的升序排序所需的最短时间。", "inputFormat": "第一行一个整数：$N$ 。\n\n接下来 $N$ 行每行包含一个整数 $a_i$，代表第 $i$ 头奶牛的脾气暴躁值。", "outputFormat": "输出将所有奶牛按按脾气暴躁程度的升序排序所需的最短时间。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07FEB] Cow Sorting G", "background": "", "description": "Farmer John 的 $n$（$1 \\leq n \\leq 10^5$）头牛一字排开。每头奶牛都有一个“脾气暴躁”水平，范围在 $1 \\ldots 10^5$，且任意两头奶牛的脾气暴躁值不相同。由于脾气暴躁的奶牛更有可能损坏 FJ 的挤奶设备，因此 FJ 希望对奶牛进行重新排序，以便按照脾气暴躁程度依此提升的顺序排列它们。\n\n在此过程中，任何两头奶牛（不一定相邻）的位置都可以互换。由于脾气暴躁的母牛难以移动，因此 FJ 总共需要 $X + Y$ 单位的时间来交换两只脾气暴躁程度为 $X$ 和 $Y$ 的母牛。请帮助 FJ 计算将奶牛按脾气暴躁程度的升序排序所需的最短时间。", "inputFormat": "第一行一个整数：$N$ 。\n\n接下来 $N$ 行每行包含一个整数 $a_i$，代表第 $i$ 头奶牛的脾气暴躁值。", "outputFormat": "输出将所有奶牛按按脾气暴躁程度的升序排序所需的最短时间。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6194", "type": "P", "difficulty": 2, "samples": [["........\n........\n........\n..B..R..\n........\n........\n........\n........\n", "11111011\n01110011\n10101011\n11000000\n10101011\n01110011\n11111011\n11111001\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "O2优化", "洛谷月赛"], "title": "[EER1] 苏联人", "background": "~~题目名称是吸引你点进来的。~~\n\n这是一道正常的题，和苏联没有任何关系。", "description": "你在打 EE Round 1，发现第一题非常无聊。于是你不打了，去下国际象棋了。\n\n结果你发现，由于神秘力量的影响，你的棋子只剩下若干黑色的战车，若干黑色的主教和一只白色的国王了。\n\n由于你很无聊，所以你把一些黑色棋子放在了 $8\\times 8$ 的棋盘上。\n\n由于你很无聊，所以你想知道，国王放在哪些格子是安全的。换句话说，有哪些格子不会被战车和主教攻击到。当然，**国王不能放在已经有棋子的地方**。\n\n为了防止你无聊透顶而不知道国际象棋的规则，这里给出以下提示（如果你知道规则那么可以跳过）：\n\n国际象棋中，战车可以横向、竖向移动，且格数不受限制。但**不能越过其他棋子**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5symt5td.png)\n\n如图，黄色的格子为战车能走到（攻击到）的格子。\n\n国际象棋中，主教可以斜向移动，且格数不受限制。但**不能越过其他棋子**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/skmw1njm.png)\n\n如图，黄色的格子为主教能走到（攻击到）的格子。\n\n简单来说，如果当前位置到目标位置的**线段**上存在其他棋子，则可以称为“越过了其他棋子”。\n\n如果目标位置是对方的棋子，那么移动到目标位置后，对方的棋子会被吃掉。\n\n更进一步地，你要找的所有位置，必须满足没有黑色棋子能一步走到。\n\n---\n\n如果你还是没有读懂，可以结合样例进行理解。", "inputFormat": "共 $8$ 行，每行 $8$ 个字符，表示棋盘的状态。\n\n其中 `.` 表示空位，`R` 表示战车，`B` 表示主教。", "outputFormat": "共 $8$ 行，每行 $8$ 个字符。若一个格子是可以放国王的，则输出 `1`，否则输出 `0`。", "hint": "对于 $100\\%$ 的数据，保证只会出现 `.`，`R`，`B` 三种字符。\n\n本题共有 $4$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$（$10$ 分）：保证只会出现 `.`。\n\n子任务 $2$（$20$ 分）：保证只会出现一个 `R` 或一个 `B`（不同时出现）。\n\n子任务 $3$（$30$ 分）：保证只有一个 `.`。\n\n子任务 $4$（$40$ 分）：没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER1] 苏联人", "background": "~~题目名称是吸引你点进来的。~~\n\n这是一道正常的题，和苏联没有任何关系。", "description": "你在打 EE Round 1，发现第一题非常无聊。于是你不打了，去下国际象棋了。\n\n结果你发现，由于神秘力量的影响，你的棋子只剩下若干黑色的战车，若干黑色的主教和一只白色的国王了。\n\n由于你很无聊，所以你把一些黑色棋子放在了 $8\\times 8$ 的棋盘上。\n\n由于你很无聊，所以你想知道，国王放在哪些格子是安全的。换句话说，有哪些格子不会被战车和主教攻击到。当然，**国王不能放在已经有棋子的地方**。\n\n为了防止你无聊透顶而不知道国际象棋的规则，这里给出以下提示（如果你知道规则那么可以跳过）：\n\n国际象棋中，战车可以横向、竖向移动，且格数不受限制。但**不能越过其他棋子**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5symt5td.png)\n\n如图，黄色的格子为战车能走到（攻击到）的格子。\n\n国际象棋中，主教可以斜向移动，且格数不受限制。但**不能越过其他棋子**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/skmw1njm.png)\n\n如图，黄色的格子为主教能走到（攻击到）的格子。\n\n简单来说，如果当前位置到目标位置的**线段**上存在其他棋子，则可以称为“越过了其他棋子”。\n\n如果目标位置是对方的棋子，那么移动到目标位置后，对方的棋子会被吃掉。\n\n更进一步地，你要找的所有位置，必须满足没有黑色棋子能一步走到。\n\n---\n\n如果你还是没有读懂，可以结合样例进行理解。", "inputFormat": "共 $8$ 行，每行 $8$ 个字符，表示棋盘的状态。\n\n其中 `.` 表示空位，`R` 表示战车，`B` 表示主教。", "outputFormat": "共 $8$ 行，每行 $8$ 个字符。若一个格子是可以放国王的，则输出 `1`，否则输出 `0`。", "hint": "对于 $100\\%$ 的数据，保证只会出现 `.`，`R`，`B` 三种字符。\n\n本题共有 $4$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$（$10$ 分）：保证只会出现 `.`。\n\n子任务 $2$（$20$ 分）：保证只会出现一个 `R` 或一个 `B`（不同时出现）。\n\n子任务 $3$（$30$ 分）：保证只有一个 `.`。\n\n子任务 $4$（$40$ 分）：没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6195", "type": "P", "difficulty": 2, "samples": [["1 2", "7"], ["2 2", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷月赛"], "title": "[EER1] 迫害", "background": "\"In Germany they first came for the Communists,　\n\nand I didn't speak up because I wasn't a Communist.　　\n\nThen they came for the Jews,　　\n\nand I didn't speak up because I wasn't a Jew.　　\n\nThen they came for the trade unionists,　　\n\nand I didn't speak up because I wasn't a trade unionist.\n\nThen they came for the Catholics,　　\n\nand I didn't speak up because I was a Protestant.　　\n\nThen they came for me ,\n\nand by that time no one was left to speak up.\"\n\n-- Pastor Martin Niemöller\n\n”起初他们迫害共产党员，我没有说话，因为我不是马克思的信徒。\n\n后来他们迫害犹太人，我没有说话，因为我是日耳曼人。\n\n再后来他们迫害天主教徒，我没有说话，因为我是新教牧师。\n\n最后他们迫害到我头上，我环顾四周，却再也没有人能为我说话。”", "description": "有 $k$ 个人，X 要对这 $k$ 个人进行迫害。\n\n这 $k$ 个人，每一个人都拥有一个数字，分别从 $1$ 至 $k$。\n\nX 拥有 $n+m$ 个数字，这些数字为 $n$ 个 $1$ 和 $m$ 个大小可由 X 决定的数字（每个数字定好之后不能更换）。\n\nX 能对这些人进行迫害，当且仅当他能用手中若干个数的加和等于被迫害人的数字，一次迫害就成功了（不会消耗数字）。\n\n由于 X 的权利极大，又十分邪恶，他想要从第 $1$ 个人开始**一个一个**进行迫害行动。\n\n由于小 Z 也在这个被迫害的行列里，他十分的慌张，希望你来告诉他 X 能最多能从第一个人开始连续迫害多少个人。\n\n由于被迫害的人太多了，所以请将答案对 $1000000007$ 取模。", "inputFormat": "第一行两个整数 $n,m$，表示 X 有 $n$ 个 $1$，有 $m$ 个大小可自定的数。\n", "outputFormat": "请你告诉小 Z，X 能迫害多少个人。", "hint": "**【样例 1 解释】**\n\nX 选取 $2$ 个数分别为 $2,4$，可知能连续迫害 $7$ 个人。\n\n**【样例 2 解释】**\n\nX 选取 $2$ 个数分别为 $3,6$，可知能连续迫害 $11$ 个人。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（50 points）：$1 \\le n \\le 5$，$1 \\le m \\le 5$。\n- Subtask 2（30 points）：保证答案在取模前在 $10^{18}$ 之内。\n- Subtask 3（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6 $，$1 \\le m \\le 10^9 $。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER1] 迫害", "background": "\"In Germany they first came for the Communists,　\n\nand I didn't speak up because I wasn't a Communist.　　\n\nThen they came for the Jews,　　\n\nand I didn't speak up because I wasn't a Jew.　　\n\nThen they came for the trade unionists,　　\n\nand I didn't speak up because I wasn't a trade unionist.\n\nThen they came for the Catholics,　　\n\nand I didn't speak up because I was a Protestant.　　\n\nThen they came for me ,\n\nand by that time no one was left to speak up.\"\n\n-- Pastor Martin Niemöller\n\n”起初他们迫害共产党员，我没有说话，因为我不是马克思的信徒。\n\n后来他们迫害犹太人，我没有说话，因为我是日耳曼人。\n\n再后来他们迫害天主教徒，我没有说话，因为我是新教牧师。\n\n最后他们迫害到我头上，我环顾四周，却再也没有人能为我说话。”", "description": "有 $k$ 个人，X 要对这 $k$ 个人进行迫害。\n\n这 $k$ 个人，每一个人都拥有一个数字，分别从 $1$ 至 $k$。\n\nX 拥有 $n+m$ 个数字，这些数字为 $n$ 个 $1$ 和 $m$ 个大小可由 X 决定的数字（每个数字定好之后不能更换）。\n\nX 能对这些人进行迫害，当且仅当他能用手中若干个数的加和等于被迫害人的数字，一次迫害就成功了（不会消耗数字）。\n\n由于 X 的权利极大，又十分邪恶，他想要从第 $1$ 个人开始**一个一个**进行迫害行动。\n\n由于小 Z 也在这个被迫害的行列里，他十分的慌张，希望你来告诉他 X 能最多能从第一个人开始连续迫害多少个人。\n\n由于被迫害的人太多了，所以请将答案对 $1000000007$ 取模。", "inputFormat": "第一行两个整数 $n,m$，表示 X 有 $n$ 个 $1$，有 $m$ 个大小可自定的数。\n", "outputFormat": "请你告诉小 Z，X 能迫害多少个人。", "hint": "**【样例 1 解释】**\n\nX 选取 $2$ 个数分别为 $2,4$，可知能连续迫害 $7$ 个人。\n\n**【样例 2 解释】**\n\nX 选取 $2$ 个数分别为 $3,6$，可知能连续迫害 $11$ 个人。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（50 points）：$1 \\le n \\le 5$，$1 \\le m \\le 5$。\n- Subtask 2（30 points）：保证答案在取模前在 $10^{18}$ 之内。\n- Subtask 3（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6 $，$1 \\le m \\le 10^9 $。", "locale": "zh-CN"}}}
{"pid": "P6196", "type": "P", "difficulty": 4, "samples": [["3\n1 2 3", "9\n"], ["4\n19 26 8 17", "846"], ["6\n1 1 1 1 1 1", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "洛谷月赛"], "title": "[EER1] 代价", "background": "> 个人的遭遇，命运的多舛都使我被迫成熟，这一切的代价都当是日后活下去的力量。\n——  三毛\n\n小 Z 喜欢玩数字游戏。", "description": "给出一个长度为 $n+2$ 的序列 $a_i$，其中第 $1$ 个数和第 $n+2$ 个数固定为 $1$。你每次可以选择序列中间的一个数删除（不能是第一个和最后一个），删除位置 $p$ 上的数的代价为 $a_{p-1} \\times a_p \\times a_{p+1}$。你需要执行这个操作直到无法操作为止。求最小的代价和。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，第 $i$ 个数表示 $a_{i+1}$。", "outputFormat": "一行一个正整数，表示最小的代价和。", "hint": "样例一解释：\n\n先删除 $3$，代价为 $6$，再删除 $2$，代价为 $2$，再删除 $1$，代价为 $1$。\n\n总代价为 $6+2+1=9$。\n\n---\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的测试点：$1 \\leq n \\leq 10^6$，$1 \\leq a_i \\leq 10^4$。\n\n本题共 $6$ 个子任务，各子任务的分值及约定如下：\n\n子任务 $1$（$1$ 分）：$a_i = 1$。\n\n子任务 $2$（$14$ 分）：$1 \\leq n \\leq 10$。\n\n子任务 $3$（$5$ 分）：$1 \\leq a_i \\leq 2$。\n\n子任务 $4$（$14$ 分）：$1 \\leq n \\leq 40$。\n\n子任务 $5$（$26$ 分）：$1 \\leq n \\leq 500$。\n\n子任务 $6$（$40$ 分）：无特殊限制。\n\n#### 特别感谢\n\nidea：smrsky\n\nsolu：CYJian\n\ndata：iostream", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER1] 代价", "background": "> 个人的遭遇，命运的多舛都使我被迫成熟，这一切的代价都当是日后活下去的力量。\n——  三毛\n\n小 Z 喜欢玩数字游戏。", "description": "给出一个长度为 $n+2$ 的序列 $a_i$，其中第 $1$ 个数和第 $n+2$ 个数固定为 $1$。你每次可以选择序列中间的一个数删除（不能是第一个和最后一个），删除位置 $p$ 上的数的代价为 $a_{p-1} \\times a_p \\times a_{p+1}$。你需要执行这个操作直到无法操作为止。求最小的代价和。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，第 $i$ 个数表示 $a_{i+1}$。", "outputFormat": "一行一个正整数，表示最小的代价和。", "hint": "样例一解释：\n\n先删除 $3$，代价为 $6$，再删除 $2$，代价为 $2$，再删除 $1$，代价为 $1$。\n\n总代价为 $6+2+1=9$。\n\n---\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的测试点：$1 \\leq n \\leq 10^6$，$1 \\leq a_i \\leq 10^4$。\n\n本题共 $6$ 个子任务，各子任务的分值及约定如下：\n\n子任务 $1$（$1$ 分）：$a_i = 1$。\n\n子任务 $2$（$14$ 分）：$1 \\leq n \\leq 10$。\n\n子任务 $3$（$5$ 分）：$1 \\leq a_i \\leq 2$。\n\n子任务 $4$（$14$ 分）：$1 \\leq n \\leq 40$。\n\n子任务 $5$（$26$ 分）：$1 \\leq n \\leq 500$。\n\n子任务 $6$（$40$ 分）：无特殊限制。\n\n#### 特别感谢\n\nidea：smrsky\n\nsolu：CYJian\n\ndata：iostream", "locale": "zh-CN"}}}
{"pid": "P6197", "type": "P", "difficulty": 6, "samples": [["10 1 998244353\n3", "20"], ["40 2 1018429441\n1\n4", "-1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "O2优化", "洛谷月赛"], "title": "[EER1] 礼物", "background": "### Update：\n\n时限扩大到 3 秒。", "description": "小 Z 送了你一个数列，具体的，有 $a_1=1$，$a_2=2$，$a_i=2a_{i-1}+ka_{i-2}(3\\le i\\le n)$，其中 $n$ 是数列的长度，$k$ 是她设定的一个正整数参数。\n\n小 Z 告诉你一个秘密，这个数列是她精心挑选的，有着一种奇妙的性质 \"Prime-smooth\"—— 即对于 $n$ 以内的任何一个**质数** $p$，满足 $p\\mid a_p$（$\\mid$ 是整除记号）。\n\n你很好奇是不是真的有这回事，于是你写了一个质数发生器，进行了长达三天三夜的尝试，终于发现了几个反例：有 $m$ 个质数 $p_i$ 竟然不满足小 Z 所说的性质！\n\n由于你已经随机了很久，你相信别的质数 **一定满足** 性质。\n\n为了表明你和小 Z 心有灵犀，你现在想猜出小 Z 当时设定的参数 $k$，由于答案很大，你只需要求出最小的 $k$ 对一个质数 $c$ 取模即可。", "inputFormat": "第一行三个非负整数 $n,m,c$，它们与题面中含义相同。\n\n接下来 $m$ 行，每行一个正整数 $i$，表示对于从小到大数第 $i$ 个质数 $p_i$，不满足 $p_i\\mid a_{p_i}$。我们保证这个质数 $p_i\\le n$。注意：**不保证**这 $m$ 个数两两不同。", "outputFormat": "一行一个整数，为最小的 $k$ 对 $c$ 取模后的值。\n\n特别的，如果出现无解的情况，输出 $-1$。", "hint": "**【样例 1 解释】**\n\n注意第 $3$ 个质数是 $5$。\n\n当 $k=20$ 时，$a_2=2$，$a_3=24$，$a_7=19264$ 均符合 $p\\mid a_p$，并且 $a_5=656$ 符合 $p\\nmid a_p$。\n\n**【数据范围】**\n\n$10\\le n\\le 3\\times 10^8$。\n\n$n\\lt c\\lt 2^{30}$，$c=a\\cdot 2^d+1(d\\ge 18)$，保证 $c$ 是质数。\n\n$0\\le m\\le 20$。\n\n| 子任务编号 |    $n\\leq$     |    $m\\leq$     | 特殊性质 | 分值 |\n| :--------: | :------------: | :------------: | :------------: | :--: |\n|     1      | $10^6$ | $20$ ||  10   |\n|     2      | $5\\times 10^7$ | $20$ ||  20  |\n|     3      | $2\\times 10^8$ | $0$ ||  10  |\n|     4      | $2\\times 10^8$ | $6$ ||  10  |\n|     5      | $3\\times 10^8$ | $0$ | $c=998244353$ |  20  |\n|     6      | $3\\times 10^8$ | $0$ ||  20  |\n|     7      | $3\\times 10^8$ | $20$ ||  10  |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER1] 礼物", "background": "### Update：\n\n时限扩大到 3 秒。", "description": "小 Z 送了你一个数列，具体的，有 $a_1=1$，$a_2=2$，$a_i=2a_{i-1}+ka_{i-2}(3\\le i\\le n)$，其中 $n$ 是数列的长度，$k$ 是她设定的一个正整数参数。\n\n小 Z 告诉你一个秘密，这个数列是她精心挑选的，有着一种奇妙的性质 \"Prime-smooth\"—— 即对于 $n$ 以内的任何一个**质数** $p$，满足 $p\\mid a_p$（$\\mid$ 是整除记号）。\n\n你很好奇是不是真的有这回事，于是你写了一个质数发生器，进行了长达三天三夜的尝试，终于发现了几个反例：有 $m$ 个质数 $p_i$ 竟然不满足小 Z 所说的性质！\n\n由于你已经随机了很久，你相信别的质数 **一定满足** 性质。\n\n为了表明你和小 Z 心有灵犀，你现在想猜出小 Z 当时设定的参数 $k$，由于答案很大，你只需要求出最小的 $k$ 对一个质数 $c$ 取模即可。", "inputFormat": "第一行三个非负整数 $n,m,c$，它们与题面中含义相同。\n\n接下来 $m$ 行，每行一个正整数 $i$，表示对于从小到大数第 $i$ 个质数 $p_i$，不满足 $p_i\\mid a_{p_i}$。我们保证这个质数 $p_i\\le n$。注意：**不保证**这 $m$ 个数两两不同。", "outputFormat": "一行一个整数，为最小的 $k$ 对 $c$ 取模后的值。\n\n特别的，如果出现无解的情况，输出 $-1$。", "hint": "**【样例 1 解释】**\n\n注意第 $3$ 个质数是 $5$。\n\n当 $k=20$ 时，$a_2=2$，$a_3=24$，$a_7=19264$ 均符合 $p\\mid a_p$，并且 $a_5=656$ 符合 $p\\nmid a_p$。\n\n**【数据范围】**\n\n$10\\le n\\le 3\\times 10^8$。\n\n$n\\lt c\\lt 2^{30}$，$c=a\\cdot 2^d+1(d\\ge 18)$，保证 $c$ 是质数。\n\n$0\\le m\\le 20$。\n\n| 子任务编号 |    $n\\leq$     |    $m\\leq$     | 特殊性质 | 分值 |\n| :--------: | :------------: | :------------: | :------------: | :--: |\n|     1      | $10^6$ | $20$ ||  10   |\n|     2      | $5\\times 10^7$ | $20$ ||  20  |\n|     3      | $2\\times 10^8$ | $0$ ||  10  |\n|     4      | $2\\times 10^8$ | $6$ ||  10  |\n|     5      | $3\\times 10^8$ | $0$ | $c=998244353$ |  20  |\n|     6      | $3\\times 10^8$ | $0$ ||  20  |\n|     7      | $3\\times 10^8$ | $20$ ||  10  |", "locale": "zh-CN"}}}
{"pid": "P6198", "type": "P", "difficulty": 5, "samples": [["10\n1 -1 2 3 -1 3 1 -1 2 3 \n", "2 4 3 6 7 5 1 9 8 10\n"], ["10\n1 1 2 2 3 2 3 3 4 5 \n", "2 1 5 4 6 3 8 7 9 10\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "洛谷月赛"], "title": "[EER1] 单调栈", "background": "", "description": "单调栈是一种常见的数据结构，如果你之前没有了解过，可以参考 [单调栈教程](https://www.luogu.com.cn/problemnew/solution/P5788) 帮助理解题意。\n\n有一个长度为 $n$ 的**排列** $p_0, p_1, \\cdots, p_{n-1}$，通过这个排列生成了一个长度为 $n$ 的序列 $S$，其中 $S_i$ 表示由 $p_0, p_1, \\cdots, p_i$ 组成的递增单调栈的大小。\n\n换一种说法，序列 $S$ 是由如下代码生成的：\n```cpp\nstack<int> stk;\nint n = p.size();\nvector<int> S;\nfor (int i = 0; i < n; i++) {\n  while (!stk.empty() && p[i] <= p[stk.top()]) stk.pop();\n  stk.push(i);\n  S.push_back((int)stk.size());\n}\n```\n\n现在给你序列 $S$ 的**一部分**，没有给出的部分可以取任意值。请你根据给出的 $S$ 复原出排列 $p$。如果有多种可能，输出字典序最小的。保证一定有解。\n", "inputFormat": "第一行一个整数 $n$。表示排列的长度。\n\n接下来一行 $n$ 个整数，表示序列 $S$。其中部分项为 $-1$，表示可以取任意值。", "outputFormat": "一行 $n$ 个整数，一个排列。\n\n", "hint": "样例 #1 解释：样例 $1$ 的输出对应的 $S$ 序列为 1 2 2 3 4 3 1 2 2 3，可以匹配输入。可以证明这是字典序最小的可以匹配输入的排列。\n\n\n对于 $100\\%$ 的数据，满足 $1 \\leq n \\leq 10^6$。\n\n本题共有 $5$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$ ($5$ 分)：保证 $1 \\leq n \\leq 10$。\n\n子任务 $2$ ($10$ 分)：保证给出的 $S$ 中没有 $-1$。\n\n子任务 $3$ ($20$ 分)：保证 $1 \\leq n \\leq 300$。\n\n子任务 $4$ ($20$ 分)：保证 $1 \\leq n \\leq 3000$。\n\n子任务 $5$ ($45$ 分)：无特殊限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER1] 单调栈", "background": "", "description": "单调栈是一种常见的数据结构，如果你之前没有了解过，可以参考 [单调栈教程](https://www.luogu.com.cn/problemnew/solution/P5788) 帮助理解题意。\n\n有一个长度为 $n$ 的**排列** $p_0, p_1, \\cdots, p_{n-1}$，通过这个排列生成了一个长度为 $n$ 的序列 $S$，其中 $S_i$ 表示由 $p_0, p_1, \\cdots, p_i$ 组成的递增单调栈的大小。\n\n换一种说法，序列 $S$ 是由如下代码生成的：\n```cpp\nstack<int> stk;\nint n = p.size();\nvector<int> S;\nfor (int i = 0; i < n; i++) {\n  while (!stk.empty() && p[i] <= p[stk.top()]) stk.pop();\n  stk.push(i);\n  S.push_back((int)stk.size());\n}\n```\n\n现在给你序列 $S$ 的**一部分**，没有给出的部分可以取任意值。请你根据给出的 $S$ 复原出排列 $p$。如果有多种可能，输出字典序最小的。保证一定有解。\n", "inputFormat": "第一行一个整数 $n$。表示排列的长度。\n\n接下来一行 $n$ 个整数，表示序列 $S$。其中部分项为 $-1$，表示可以取任意值。", "outputFormat": "一行 $n$ 个整数，一个排列。\n\n", "hint": "样例 #1 解释：样例 $1$ 的输出对应的 $S$ 序列为 1 2 2 3 4 3 1 2 2 3，可以匹配输入。可以证明这是字典序最小的可以匹配输入的排列。\n\n\n对于 $100\\%$ 的数据，满足 $1 \\leq n \\leq 10^6$。\n\n本题共有 $5$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$ ($5$ 分)：保证 $1 \\leq n \\leq 10$。\n\n子任务 $2$ ($10$ 分)：保证给出的 $S$ 中没有 $-1$。\n\n子任务 $3$ ($20$ 分)：保证 $1 \\leq n \\leq 300$。\n\n子任务 $4$ ($20$ 分)：保证 $1 \\leq n \\leq 3000$。\n\n子任务 $5$ ($45$ 分)：无特殊限制。\n", "locale": "zh-CN"}}}
{"pid": "P6199", "type": "P", "difficulty": 7, "samples": [["5\n1 2 1\n1 3 1\n2 4 1\n2 5 1\n2 3 1\n2 4 1\n3 5 1\n3 1 1\n", "10\n"], ["4\n1 2 1\n1 3 1\n1 4 1\n1 2 1\n2 3 1\n3 4 1 \n", "8\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "洛谷月赛"], "title": "[EER1] 河童重工", "background": "妖怪之山上生活着两种妖怪，鸦天狗和河童。从前，他们各有自己专属的交通线路，可以在妖怪之山的各个地点之间移动，但两套交通线路的维护成本实在是太高了！因此妖怪们现在想要把两套线路精简成一套。这个繁重的工程就被委托给河童重工了。", "description": "妖怪之山上有 $n$ 个地点，鸦天狗和河童的两套交通线路都是分别由一些连接这些地点的无向道路组成的，每条道路有自己的长度，把这些道路看成有权边，那么他们的两套线路分别可以表示成两棵 $n$ 个节点的树 $T_1, T_2$（有 $n-1$ 条边的有边权无向连通图），河童重工现在要新建一些无向道路，新建一条无向道路 $(i,j)$ 的花费是 $dist_{T_1}(i,j)+dist_{T_2}(i,j)$（即 $T_1,T_2$ 上 $i$ 到 $j$ 的距离之和），河童重工要保证妖怪之山的任意两个节点都能只通过新修建的道路互相到达。但由于如果花费过多可能引起异变，所以他们希望这个工程的总花费最少。\n\n荷取作为这个工程的总设计师，请你帮她算一算，修建新道路的总花费最少是多少？", "inputFormat": "第一行一个正整数 $n$，表示节点数量。\n\n接下来有 $n-1$ 行，其中第 $i$ 行有三个整数 $x_i, y_i, v_i(1 \\leq x_i, y_i \\leq n, 1 \\leq v_i \\leq 5000)$，表示 $T_1$ 中有一条长度为 $v_i$ 的边，连接 $x_i, y_i$ 两点。\n\n接下来有 $n-1$ 行，其中第 $j$ 行有三个整数 $x_j, y_j, v_j(1 \\leq x_j, y_j \\leq n, 1 \\leq v_j \\leq 5000)$，表示 $T_2$ 中有一条长度为 $v_j$ 的边，连接 $x_j, y_j$ 两点。\n", "outputFormat": "一行一个整数表示最少的总花费。\n", "hint": "对于 $100\\%$ 的数据，满足 $2 \\leq n \\leq 10^5$。\n\n本题共有 $5$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$（$15$ 分)：保证 $2 \\leq n \\leq 1000$。\n\n子任务 $2$（$15$ 分)：保证 $T_1, T_2$ 分别是一条链。\n\n子任务 $3$（$5$ 分)：保证 $T_1, T_2$ 除了边权完全相同（即如果将两棵树看成无边权树，那么它们是相同的）。\n\n子任务 $4$（$5$ 分)：保证 $T_2$ 是一条链。\n\n子任务 $5$（$60$ 分)：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER1] 河童重工", "background": "妖怪之山上生活着两种妖怪，鸦天狗和河童。从前，他们各有自己专属的交通线路，可以在妖怪之山的各个地点之间移动，但两套交通线路的维护成本实在是太高了！因此妖怪们现在想要把两套线路精简成一套。这个繁重的工程就被委托给河童重工了。", "description": "妖怪之山上有 $n$ 个地点，鸦天狗和河童的两套交通线路都是分别由一些连接这些地点的无向道路组成的，每条道路有自己的长度，把这些道路看成有权边，那么他们的两套线路分别可以表示成两棵 $n$ 个节点的树 $T_1, T_2$（有 $n-1$ 条边的有边权无向连通图），河童重工现在要新建一些无向道路，新建一条无向道路 $(i,j)$ 的花费是 $dist_{T_1}(i,j)+dist_{T_2}(i,j)$（即 $T_1,T_2$ 上 $i$ 到 $j$ 的距离之和），河童重工要保证妖怪之山的任意两个节点都能只通过新修建的道路互相到达。但由于如果花费过多可能引起异变，所以他们希望这个工程的总花费最少。\n\n荷取作为这个工程的总设计师，请你帮她算一算，修建新道路的总花费最少是多少？", "inputFormat": "第一行一个正整数 $n$，表示节点数量。\n\n接下来有 $n-1$ 行，其中第 $i$ 行有三个整数 $x_i, y_i, v_i(1 \\leq x_i, y_i \\leq n, 1 \\leq v_i \\leq 5000)$，表示 $T_1$ 中有一条长度为 $v_i$ 的边，连接 $x_i, y_i$ 两点。\n\n接下来有 $n-1$ 行，其中第 $j$ 行有三个整数 $x_j, y_j, v_j(1 \\leq x_j, y_j \\leq n, 1 \\leq v_j \\leq 5000)$，表示 $T_2$ 中有一条长度为 $v_j$ 的边，连接 $x_j, y_j$ 两点。\n", "outputFormat": "一行一个整数表示最少的总花费。\n", "hint": "对于 $100\\%$ 的数据，满足 $2 \\leq n \\leq 10^5$。\n\n本题共有 $5$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$（$15$ 分)：保证 $2 \\leq n \\leq 1000$。\n\n子任务 $2$（$15$ 分)：保证 $T_1, T_2$ 分别是一条链。\n\n子任务 $3$（$5$ 分)：保证 $T_1, T_2$ 除了边权完全相同（即如果将两棵树看成无边权树，那么它们是相同的）。\n\n子任务 $4$（$5$ 分)：保证 $T_2$ 是一条链。\n\n子任务 $5$（$60$ 分)：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6200", "type": "P", "difficulty": 2, "samples": [["4 3\n2 1\n2 3\n4 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07OCT] Super Paintball G", "background": "", "description": "奶牛们最近从玩具商那里，买来了一套仿真版彩弹游戏设备（类似于真人 CS）。Bessie 把她们玩游戏的草坪划分成了 $N \\times N$ 的矩阵（$1 \\leq N \\leq 100$），同时他算出了她的 $K$ 个对手在草地上的位置（$1 \\leq K \\leq 10^5$），现在你需要帮 Bessie 算些东西。\n\n在这个游戏中，奶牛们用一把枪向八个方向中的任意一个方向射出子弹，这八个方向分别是：正北，正南，正东，正西，东北，东南，西北，西南（东北指北偏东 $45^\\circ$，东南，西北，西南同理）。\n\nBessie 想要你算出，有多少个位置可以让她射到所有对手。特别地，Bessie 可以和她的某一个对手站在同一格子，这时候她可以射到和她同一格子的对手。", "inputFormat": "第一行两个整数 $N, K$。\n\n接下来 $K$ 行，每行两个整数 $R_i, C_i$，表示第 $i$ 头奶牛在第 $R_i$ 行第 $C_i$ 列。可能有两个奶牛在同一位置上。", "outputFormat": "输出 Bessie 可以选择的格子数目。", "hint": "可选的位置有：$(2,1),(2,3),(3,2),(4,1),(4,3)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07OCT] Super Paintball G", "background": "", "description": "奶牛们最近从玩具商那里，买来了一套仿真版彩弹游戏设备（类似于真人 CS）。Bessie 把她们玩游戏的草坪划分成了 $N \\times N$ 的矩阵（$1 \\leq N \\leq 100$），同时他算出了她的 $K$ 个对手在草地上的位置（$1 \\leq K \\leq 10^5$），现在你需要帮 Bessie 算些东西。\n\n在这个游戏中，奶牛们用一把枪向八个方向中的任意一个方向射出子弹，这八个方向分别是：正北，正南，正东，正西，东北，东南，西北，西南（东北指北偏东 $45^\\circ$，东南，西北，西南同理）。\n\nBessie 想要你算出，有多少个位置可以让她射到所有对手。特别地，Bessie 可以和她的某一个对手站在同一格子，这时候她可以射到和她同一格子的对手。", "inputFormat": "第一行两个整数 $N, K$。\n\n接下来 $K$ 行，每行两个整数 $R_i, C_i$，表示第 $i$ 头奶牛在第 $R_i$ 行第 $C_i$ 列。可能有两个奶牛在同一位置上。", "outputFormat": "输出 Bessie 可以选择的格子数目。", "hint": "可选的位置有：$(2,1),(2,3),(3,2),(4,1),(4,3)$。", "locale": "zh-CN"}}}
{"pid": "P6202", "type": "P", "difficulty": 4, "samples": [["3 4\n1\n0\n4", "26\n25\n29\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07CHN] Summing Sums G", "background": "", "description": "$N$ 头奶牛（$1 \\leq N \\leq 5 \\times 10^4$）刚刚学习了不少密码学知识，终于，她们创造出了属于奶牛的加密方法，由于她们经验不足，她们的加密方法很简单：\n\n第 $i$ 头奶牛掌握着密码的第 $i$ 个数字，起始的时候是 $C_i$（$0 \\leq C_i \\lt 9 \\times 10^7$）。加密的时候，第 $i$ 头奶牛会计算其他所有奶牛的数字和，并将这个和对 $98\\,765\\,431$ 取模。在所有奶牛计算完成后，每头奶牛都会用自己算的数字代替原来的数字。即，\n\n$$\nC_{i}'=(\\sum_{k=1}^NC_k-C_i) \\bmod 98\\,765\\,431\n$$\n\n这样，她们完成了一次加密。\n\n在十一月，奶牛们把这个加密方法告诉了驼鹿卡门。卡门想了一会后，说：“你们的算法还很原始，为了达到加密效果，你们要重复这个加密过程 $T$ 次（$1 \\leq T \\leq 1\\,414\\,213\\,562$）”。\n\n奶牛们很懒，于是就把这个任务交给了你。", "inputFormat": "第一行两个整数 $N,T$。\n\n接下来 $N$ 行，第 $i$ 行一个整数 $C_i$。", "outputFormat": "输出 $N$ 行，第 $i$ 行一个整数，代表经过 $T$ 次加密后的 $C_i$。", "hint": "每次加密后的 $C_i$ 如下：\n\n| 次数 | $C_1$ | $C_2$ | $C_3$ |\n| ---- | ----- | ----- | ----- |\n| 0    | 1     | 0     | 4     |\n| 1    | 4     | 5     | 1     |\n| 2    | 6     | 5     | 9     |\n| 3    | 14    | 15    | 11    |\n| 4    | 26    | 25    | 29    |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07CHN] Summing Sums G", "background": "", "description": "$N$ 头奶牛（$1 \\leq N \\leq 5 \\times 10^4$）刚刚学习了不少密码学知识，终于，她们创造出了属于奶牛的加密方法，由于她们经验不足，她们的加密方法很简单：\n\n第 $i$ 头奶牛掌握着密码的第 $i$ 个数字，起始的时候是 $C_i$（$0 \\leq C_i \\lt 9 \\times 10^7$）。加密的时候，第 $i$ 头奶牛会计算其他所有奶牛的数字和，并将这个和对 $98\\,765\\,431$ 取模。在所有奶牛计算完成后，每头奶牛都会用自己算的数字代替原来的数字。即，\n\n$$\nC_{i}'=(\\sum_{k=1}^NC_k-C_i) \\bmod 98\\,765\\,431\n$$\n\n这样，她们完成了一次加密。\n\n在十一月，奶牛们把这个加密方法告诉了驼鹿卡门。卡门想了一会后，说：“你们的算法还很原始，为了达到加密效果，你们要重复这个加密过程 $T$ 次（$1 \\leq T \\leq 1\\,414\\,213\\,562$）”。\n\n奶牛们很懒，于是就把这个任务交给了你。", "inputFormat": "第一行两个整数 $N,T$。\n\n接下来 $N$ 行，第 $i$ 行一个整数 $C_i$。", "outputFormat": "输出 $N$ 行，第 $i$ 行一个整数，代表经过 $T$ 次加密后的 $C_i$。", "hint": "每次加密后的 $C_i$ 如下：\n\n| 次数 | $C_1$ | $C_2$ | $C_3$ |\n| ---- | ----- | ----- | ----- |\n| 0    | 1     | 0     | 4     |\n| 1    | 4     | 5     | 1     |\n| 2    | 6     | 5     | 9     |\n| 3    | 14    | 15    | 11    |\n| 4    | 26    | 25    | 29    |", "locale": "zh-CN"}}}
{"pid": "P6203", "type": "P", "difficulty": 0, "samples": [["3\n1\n1\n5\n5\n1\n1", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07CHN] The Bovine Accordion and Banjo Orchestra G", "background": null, "description": "FJ 的 $2N$ 头奶牛（$3 \\leq N \\leq 1000$）准备举办一场音乐会。其中 $N$ 头奶牛是手风琴手，另外 $N$ 头奶牛是班卓琴手，每个手风琴手有一个天才指数 $A_i$（$0 \\leq A_i \\leq 1000$），每个班卓琴手也有一个天才指数 $B_i$（$0 \\leq B_i \\leq 1000$）。\n\nFJ 需要给手风琴手和班卓琴手配对。让第 $i$ 位手风琴手和第 $j$ 位班卓琴手配对，能产生 $A_i \\times B_j$ 的收益。\n\n不幸的是，FJ 的奶牛都存在一种怪癖：如果第 $i$ 位手风琴手和第 $j$ 位班卓琴手配对，那么第 $i+1 \\sim N$ 位手风琴手，不会选择与第 $1 \\sim j-1$ 位班卓琴手配对。这给 FJ 的配对计划带来了很多不便。\n\n更糟糕的是，那些失去演出机会的失落的奶牛，为了消解内心的失落感情，会成群结队地到酒吧喝酒。\n\n如果第 $x$ 号手风琴手到第 $y$ 号手风琴手都是失落的（$x-1$ 和 $y+1$ 号手风琴手不存在或是参加了演出），这些奶牛就会去结队去酒吧喝酒，开销为：\n\n$$\n(\\sum_{k=x}^y A_k)^2\n$$\n\n对于班卓琴手，也有类似的规律。\n\n现在 FJ 不得不好好考虑下他的计划了，他想让你算出他的最大的收益。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $A_i$。\n\n接下来 $N$ 行，每行一个整数 $B_i$。", "outputFormat": "输出 FJ 能获得的最大收益。", "hint": "手风琴手 $3$ 和班卓琴手 $1$ 搭配，收益 $25$。\n\n手风琴手 $1,2$ 一块喝酒，花费 $4$。\n\n班卓琴手 $2,3$ 一块喝酒，花费 $4$。\n\n最终收益为 $17$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07CHN] The Bovine Accordion and Banjo Orchestra G", "background": null, "description": "FJ 的 $2N$ 头奶牛（$3 \\leq N \\leq 1000$）准备举办一场音乐会。其中 $N$ 头奶牛是手风琴手，另外 $N$ 头奶牛是班卓琴手，每个手风琴手有一个天才指数 $A_i$（$0 \\leq A_i \\leq 1000$），每个班卓琴手也有一个天才指数 $B_i$（$0 \\leq B_i \\leq 1000$）。\n\nFJ 需要给手风琴手和班卓琴手配对。让第 $i$ 位手风琴手和第 $j$ 位班卓琴手配对，能产生 $A_i \\times B_j$ 的收益。\n\n不幸的是，FJ 的奶牛都存在一种怪癖：如果第 $i$ 位手风琴手和第 $j$ 位班卓琴手配对，那么第 $i+1 \\sim N$ 位手风琴手，不会选择与第 $1 \\sim j-1$ 位班卓琴手配对。这给 FJ 的配对计划带来了很多不便。\n\n更糟糕的是，那些失去演出机会的失落的奶牛，为了消解内心的失落感情，会成群结队地到酒吧喝酒。\n\n如果第 $x$ 号手风琴手到第 $y$ 号手风琴手都是失落的（$x-1$ 和 $y+1$ 号手风琴手不存在或是参加了演出），这些奶牛就会去结队去酒吧喝酒，开销为：\n\n$$\n(\\sum_{k=x}^y A_k)^2\n$$\n\n对于班卓琴手，也有类似的规律。\n\n现在 FJ 不得不好好考虑下他的计划了，他想让你算出他的最大的收益。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $A_i$。\n\n接下来 $N$ 行，每行一个整数 $B_i$。", "outputFormat": "输出 FJ 能获得的最大收益。", "hint": "手风琴手 $3$ 和班卓琴手 $1$ 搭配，收益 $25$。\n\n手风琴手 $1,2$ 一块喝酒，花费 $4$。\n\n班卓琴手 $2,3$ 一块喝酒，花费 $4$。\n\n最终收益为 $17$。", "locale": "zh-CN"}}}
{"pid": "P6204", "type": "P", "difficulty": 0, "samples": [["4\n1 2\n2 3\n3 1\n1 4", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07CHN] Treasure G", "background": "", "description": "卡门和他的朋友们最近挖到了一箱财宝，他们打算将这箱财宝埋在公路网的某个节点上。\n\n整个公路网有 $N$ 个节点，这些节点之间由 $N$ 条公路连接。公路都是双向通行的，任何一个节点至少与一条公路相连，且没有节点与超过 $4$ 条公路连接。卡门决定不将财宝埋在有 $4$ 条公路连接的节点上，因为那里交通繁忙，容易被暴露。\n\n卡门将公路网的地图画了出来，并在计划埋藏财宝的地方画了个叉。为了研究最佳埋藏方案，他把所有情况都画了出来，比如下面是一个 $N=4$ 时的所有埋藏情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1n2zbqb9.png)\n\n他仔细研究后，发现后两种方案是本质相同的。两种地图是本质相同的，当且仅当：\n\n- 宝藏埋藏地点相对应；\n- 如果两个节点间有路，则对应节点间也有路；\n- 如果两个节点间没有路，则对应节点间也没有路。\n\n现在你需要求出究竟有多少种本质不同的埋藏方案。", "inputFormat": "第一行一个整数 $N$（$4 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条道路。\n\n保证两个节点间最多有一条道路直接相连，且不存在从节点 $u$ 到节点 $u$ 的道路。", "outputFormat": "输出本质不同的埋藏方案数。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07CHN] Treasure G", "background": "", "description": "卡门和他的朋友们最近挖到了一箱财宝，他们打算将这箱财宝埋在公路网的某个节点上。\n\n整个公路网有 $N$ 个节点，这些节点之间由 $N$ 条公路连接。公路都是双向通行的，任何一个节点至少与一条公路相连，且没有节点与超过 $4$ 条公路连接。卡门决定不将财宝埋在有 $4$ 条公路连接的节点上，因为那里交通繁忙，容易被暴露。\n\n卡门将公路网的地图画了出来，并在计划埋藏财宝的地方画了个叉。为了研究最佳埋藏方案，他把所有情况都画了出来，比如下面是一个 $N=4$ 时的所有埋藏情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1n2zbqb9.png)\n\n他仔细研究后，发现后两种方案是本质相同的。两种地图是本质相同的，当且仅当：\n\n- 宝藏埋藏地点相对应；\n- 如果两个节点间有路，则对应节点间也有路；\n- 如果两个节点间没有路，则对应节点间也没有路。\n\n现在你需要求出究竟有多少种本质不同的埋藏方案。", "inputFormat": "第一行一个整数 $N$（$4 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条道路。\n\n保证两个节点间最多有一条道路直接相连，且不存在从节点 $u$ 到节点 $u$ 的道路。", "outputFormat": "输出本质不同的埋藏方案数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6205", "type": "P", "difficulty": 3, "samples": [["5 3", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2006", "USACO"], "title": "[USACO06JAN] Dollar Dayz S", "background": "", "description": "FJ 到商场买工具。商场里有 $K$ 种工具（$1 \\leq K \\leq 100$），价格分别为 $1,2,\\ldots,K$ 元。FJ 手里有 $N$ 元（$1 \\leq N \\leq 1000$），必须花完。他有多少种购买方案呢？", "inputFormat": "一行两个整数 $N,K$。", "outputFormat": "输出不同的购买方案数。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06JAN] Dollar Dayz S", "background": "", "description": "FJ 到商场买工具。商场里有 $K$ 种工具（$1 \\leq K \\leq 100$），价格分别为 $1,2,\\ldots,K$ 元。FJ 手里有 $N$ 元（$1 \\leq N \\leq 1000$），必须花完。他有多少种购买方案呢？", "inputFormat": "一行两个整数 $N,K$。", "outputFormat": "输出不同的购买方案数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6206", "type": "P", "difficulty": 1, "samples": [["5", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2006", "USACO"], "title": "[USACO06OCT] Another Cow Number Game G", "background": "", "description": "奶牛们在玩一种数字游戏，Bessie 想让你帮她预测一下结果。游戏开始时，Bessie 将得到一个正整数 $N$。此时她的分数为 $0$。\n\n奶牛们按照以下规则对 $N$ 进行变换：\n\n- 如果 $N$ 是奇数，那么将它乘以 $3$ 后再加 $1$。\n- 如果 $N$ 是偶数，那么将它除以 $2$。\n\n数字每变换一次，Bessie 就得到 $1$ 分。当 $N=1$ 时，游戏结束。此时的分数就是她的最终得分。", "inputFormat": "一行，一个整数 $N$。", "outputFormat": "一行，一个整数，为 Bessie 的最终得分。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^6$。\n\n------------\n\n**【样例说明】**\n\n当 $N$ 的初始值为 $5$ 时，游戏的过程如下：\n\n| $N$ | 变换后的数字 | 变换过程 | 总分 |\n| :----------: | :----------: | :----------: | :----------: |\n| $5$ | $16$ | $3\\times 5+1$ | $1$ |\n| $16$ | $8$ | $16\\div 2$ | $2$ |\n| $8$ | $4$ | $8\\div 2$ | $3$ |\n| $4$ | $2$ | $4\\div 2$ | $4$ |\n| $2$ | $1$ | $2\\div 2$ | $5$ |\n\nBessie 的最终得分为 $5$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OCT] Another Cow Number Game G", "background": "", "description": "奶牛们在玩一种数字游戏，Bessie 想让你帮她预测一下结果。游戏开始时，Bessie 将得到一个正整数 $N$。此时她的分数为 $0$。\n\n奶牛们按照以下规则对 $N$ 进行变换：\n\n- 如果 $N$ 是奇数，那么将它乘以 $3$ 后再加 $1$。\n- 如果 $N$ 是偶数，那么将它除以 $2$。\n\n数字每变换一次，Bessie 就得到 $1$ 分。当 $N=1$ 时，游戏结束。此时的分数就是她的最终得分。", "inputFormat": "一行，一个整数 $N$。", "outputFormat": "一行，一个整数，为 Bessie 的最终得分。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^6$。\n\n------------\n\n**【样例说明】**\n\n当 $N$ 的初始值为 $5$ 时，游戏的过程如下：\n\n| $N$ | 变换后的数字 | 变换过程 | 总分 |\n| :----------: | :----------: | :----------: | :----------: |\n| $5$ | $16$ | $3\\times 5+1$ | $1$ |\n| $16$ | $8$ | $16\\div 2$ | $2$ |\n| $8$ | $4$ | $8\\div 2$ | $3$ |\n| $4$ | $2$ | $4\\div 2$ | $4$ |\n| $2$ | $1$ | $2\\div 2$ | $5$ |\n\nBessie 的最终得分为 $5$。\n", "locale": "zh-CN"}}}
{"pid": "P6207", "type": "P", "difficulty": 3, "samples": [["5 8\n..*...**\n*.*.*.**\n*...*...\n*.*.*.*.\n....*.*.", "1 1\n1 2\n2 2\n3 2\n3 3\n3 4\n2 4\n1 4\n1 5\n1 6\n2 6\n3 6\n3 7\n3 8\n4 8\n5 8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2006", "USACO", "Special Judge", "广度优先搜索 BFS", "深度优先搜索 DFS"], "title": "[USACO06OCT] Cows on Skates G", "background": "", "description": "**本题使用 Special Judge。**\n\nFarmer John 把农场划分为了一个 $r$ 行 $c$ 列的矩阵，并发现奶牛们无法通过其中一些区域。此刻，Bessie 位于坐标为 $(1,1)$ 的区域，并想到坐标为 $(r,c)$ 的牛棚享用晚餐。她知道，以她所在的区域为起点，每次移动至相邻的四个区域之一，总有一些路径可以到达牛棚。\n\n这样的路径可能有无数种，请你输出任意一种，并保证所需移动次数不超过 $100000$。", "inputFormat": "第一行两个整数 $r,c$。\n \n接下来 $r$ 行，每行 $c$ 个字符，表示 Bessie 能否通过相应位置的区域。字符只可能是 `.` 或 `*`。\n\n- `.` 表示 Bessie 可以通过该区域。\n- `*` 表示 Bessie 无法通过该区域。", "outputFormat": "若干行，每行包含两个用空格隔开的整数，表示 Bessie 依次通过的区域的坐标。\n\n显然，输出的第一行是 `1 1` ，最后一行是 `r c`。\n\n相邻的两个坐标所表示的区域必须相邻。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le r\\le 113$，$1\\le c\\le 77$。\n\n------------\n\n**【样例说明】* *\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3gsutffb.png)\n\n图为样例输出的示意图。答案不唯一。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OCT] Cows on Skates G", "background": "", "description": "**本题使用 Special Judge。**\n\nFarmer John 把农场划分为了一个 $r$ 行 $c$ 列的矩阵，并发现奶牛们无法通过其中一些区域。此刻，Bessie 位于坐标为 $(1,1)$ 的区域，并想到坐标为 $(r,c)$ 的牛棚享用晚餐。她知道，以她所在的区域为起点，每次移动至相邻的四个区域之一，总有一些路径可以到达牛棚。\n\n这样的路径可能有无数种，请你输出任意一种，并保证所需移动次数不超过 $100000$。", "inputFormat": "第一行两个整数 $r,c$。\n \n接下来 $r$ 行，每行 $c$ 个字符，表示 Bessie 能否通过相应位置的区域。字符只可能是 `.` 或 `*`。\n\n- `.` 表示 Bessie 可以通过该区域。\n- `*` 表示 Bessie 无法通过该区域。", "outputFormat": "若干行，每行包含两个用空格隔开的整数，表示 Bessie 依次通过的区域的坐标。\n\n显然，输出的第一行是 `1 1` ，最后一行是 `r c`。\n\n相邻的两个坐标所表示的区域必须相邻。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le r\\le 113$，$1\\le c\\le 77$。\n\n------------\n\n**【样例说明】* *\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3gsutffb.png)\n\n图为样例输出的示意图。答案不唯一。", "locale": "zh-CN"}}}
{"pid": "P6208", "type": "P", "difficulty": 3, "samples": [["3 7\n6 5 3 7 9 2 7\n2 4 3 5 6 8 6\n4 9 9 9 1 5 8", "50"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2006", "USACO"], "title": "[USACO06OCT] Cow Pie Treasures G", "background": "", "description": "奶牛们制作了一些藏有金币的馅饼，并把它们排成了一个 $r$ 行 $c$ 列的矩阵。现在，你需要从坐标为 $(1,1)$ 的馅饼旁移动到坐标为 $(r,c)$ 的馅饼旁。对于每次移动，你必须向右移动一列，并且行数的变动不能超过 $1$。即如果你处于坐标为 $(x,y)$ 的馅饼旁，你只能移动到坐标为 $(x-1,y+1)$，$(x,y+1)$ 或 $(x+1,y+1)$ 的馅饼旁。在一个馅饼旁停留时，你可以拿走其中所有的金币。当然，你一定不愿意中途离开矩阵而放弃这些金币。\n\n奶牛们把标有矩阵中每一块馅饼所藏金币数的表格交给了你。你想知道按照以上规则，自己最多能拿到多少金币。", "inputFormat": "第一行两个整数 $r,c$。\n \n接下来 $r$ 行，每行 $c$ 个整数，表示矩阵中每一块馅饼所藏金币数 $t$。\n", "outputFormat": "一行，一个整数，表示你能拿到的最大金币数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le r,c\\le 100$，$1\\le t\\le 25$。\n\n------------\n\n**【样例说明】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pgw19uqm.png)\n\n样例给出的矩阵如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hwhzq9oy.png)\n\n这是一种合法的移动方式。你可以拿到 $47$ 枚金币。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sdyxlpv5.png)\n\n在这个矩阵中你最多能拿到 $50$ 枚金币，路线如图所示。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OCT] Cow Pie Treasures G", "background": "", "description": "奶牛们制作了一些藏有金币的馅饼，并把它们排成了一个 $r$ 行 $c$ 列的矩阵。现在，你需要从坐标为 $(1,1)$ 的馅饼旁移动到坐标为 $(r,c)$ 的馅饼旁。对于每次移动，你必须向右移动一列，并且行数的变动不能超过 $1$。即如果你处于坐标为 $(x,y)$ 的馅饼旁，你只能移动到坐标为 $(x-1,y+1)$，$(x,y+1)$ 或 $(x+1,y+1)$ 的馅饼旁。在一个馅饼旁停留时，你可以拿走其中所有的金币。当然，你一定不愿意中途离开矩阵而放弃这些金币。\n\n奶牛们把标有矩阵中每一块馅饼所藏金币数的表格交给了你。你想知道按照以上规则，自己最多能拿到多少金币。", "inputFormat": "第一行两个整数 $r,c$。\n \n接下来 $r$ 行，每行 $c$ 个整数，表示矩阵中每一块馅饼所藏金币数 $t$。\n", "outputFormat": "一行，一个整数，表示你能拿到的最大金币数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le r,c\\le 100$，$1\\le t\\le 25$。\n\n------------\n\n**【样例说明】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pgw19uqm.png)\n\n样例给出的矩阵如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hwhzq9oy.png)\n\n这是一种合法的移动方式。你可以拿到 $47$ 枚金币。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sdyxlpv5.png)\n\n在这个矩阵中你最多能拿到 $50$ 枚金币，路线如图所示。", "locale": "zh-CN"}}}
{"pid": "P6209", "type": "P", "difficulty": 2, "samples": [["1\n1\n", "1"], ["2\n233 23333\n", "23566"], ["3\n345 379 573\n", "2317"], ["4\n1234 567 89 10\n", "4000"], ["5\n19111010 19260817 19371213 19491001 20200110\n", "239635161"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟"], "title": "「SWTR-4」Calculating Machine", "background": "小 E 在用自己的 Calculating Machine 计算 $n$ 个**十进制**数 $a_1,a_2,\\cdots,a_n$ 的和。\n\n", "description": "小 E 计算几个数的和的方式为：\n\n- 如果参与运算的数不止 $2$ 个，那么**从左往右**依次计算。\n\n- 若两个数的位数不同，则位数少的数自动在前面补前导零，直到两数位数相同。\n\n- 从两个数的最低位开始，计算当前位两个数码的和加上前一位的进位，写上这个和除以 $10$ 的余数。\n\n- 进位规则：如果当前位两个数码的和加上前一位的进位小于 $7$，不进位；如果和大于等于 $7$ 且小于等于 $13$，则进一位；否则进两位。\n\n例如：$2+4=6$，$7+8=25$，$61+6=177$，$38+169=217$，$3+900=1903$。\n\n由于小 E 的计算机器被 360 安全病毒当成病毒杀死了，所以他想请你帮忙求出 $a_1+a_2+\\dots+a_n$。", "inputFormat": "第一行，一个整数 $n$ —— 表示参与运算的数的个数。\n\n第二行，$n$ 个整数，$a_1,a_2,\\cdots,a_n$ —— 表示从左往右所有参与运算的数，你也可以理解为 $a_i$ 在 $a_{i+1}$ 的左边。", "outputFormat": "一行一个整数 —— 表示 $a_1+a_2+\\cdots+a_n$。", "hint": "【样例 $3$ 说明】\n\n$345+379+573=1734+573=2317$。\n\n【样例 $4$ 说明】\n\n$1234+567+89+10=2801+89+10=3990+10=4000$。\n\n【数据范围与约定】\n\n对于 $10\\%$ 的数据，$n=1$。\n\n对于 $30\\%$ 的数据，$n \\leq 2$。\n\n对于 $60\\%$ 的数据，$n \\leq 10$，$a_i \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 2020$，$0 \\leq a_i \\leq 10^9$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $A\n\nidea：[ET2006](https://www.luogu.com.cn/user/115194)，std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN", "translations": {"en": {"title": "“SWTR-4” Calculating Machine", "background": "Little E is using his own Calculating Machine to compute the sum of $n$ **decimal** numbers $a_1,a_2,\\cdots,a_n$.", "description": "The way Little E computes the sum of several numbers is:\n\n- If there are more than $2$ numbers in the operation, compute **from left to right** in order.\n\n- If the two numbers have different lengths, the shorter one is automatically padded with leading zeros until the two numbers have the same length.\n\n- Starting from the least significant digit of the two numbers, compute the sum of the two digits at the current position plus the carry from the previous position, and write down the remainder of this sum divided by $10$.\n\n- Carry rule: if the sum of the two digits at the current position plus the carry from the previous position is less than $7$, do not carry; if the sum is greater than or equal to $7$ and less than or equal to $13$, carry $1$; otherwise, carry $2$.\n\nFor example: $2+4=6$, $7+8=25$, $61+6=177$, $38+169=217$, $3+900=1903$.\n\nBecause Little E’s calculating machine was killed by 360 Security as a virus, he wants you to help compute $a_1+a_2+\\dots+a_n$.", "inputFormat": "The first line contains an integer $n$ — the number of numbers involved in the operation.\n\nThe second line contains $n$ integers $a_1,a_2,\\cdots,a_n$ — all numbers involved in the operation from left to right. You can also understand this as $a_i$ is to the left of $a_{i+1}$.", "outputFormat": "Output one integer in one line — the value of $a_1+a_2+\\cdots+a_n$.", "hint": "[Sample $3$ Explanation]\n\n$345+379+573=1734+573=2317$.\n\n[Sample $4$ Explanation]\n\n$1234+567+89+10=2801+89+10=3990+10=4000$.\n\n[Constraints and Notes]\n\nFor $10\\%$ of the testdata, $n=1$.\n\nFor $30\\%$ of the testdata, $n \\leq 2$.\n\nFor $60\\%$ of the testdata, $n \\leq 10$, $a_i \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 2020$, $0 \\leq a_i \\leq 10^9$.\n\n[Source]\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $A\n\nidea: [ET2006](https://www.luogu.com.cn/user/115194), std: [Alex_Wei](https://www.luogu.com.cn/user/123294), problem checking: [Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-4」Calculating Machine", "background": "小 E 在用自己的 Calculating Machine 计算 $n$ 个**十进制**数 $a_1,a_2,\\cdots,a_n$ 的和。\n\n", "description": "小 E 计算几个数的和的方式为：\n\n- 如果参与运算的数不止 $2$ 个，那么**从左往右**依次计算。\n\n- 若两个数的位数不同，则位数少的数自动在前面补前导零，直到两数位数相同。\n\n- 从两个数的最低位开始，计算当前位两个数码的和加上前一位的进位，写上这个和除以 $10$ 的余数。\n\n- 进位规则：如果当前位两个数码的和加上前一位的进位小于 $7$，不进位；如果和大于等于 $7$ 且小于等于 $13$，则进一位；否则进两位。\n\n例如：$2+4=6$，$7+8=25$，$61+6=177$，$38+169=217$，$3+900=1903$。\n\n由于小 E 的计算机器被 360 安全病毒当成病毒杀死了，所以他想请你帮忙求出 $a_1+a_2+\\dots+a_n$。", "inputFormat": "第一行，一个整数 $n$ —— 表示参与运算的数的个数。\n\n第二行，$n$ 个整数，$a_1,a_2,\\cdots,a_n$ —— 表示从左往右所有参与运算的数，你也可以理解为 $a_i$ 在 $a_{i+1}$ 的左边。", "outputFormat": "一行一个整数 —— 表示 $a_1+a_2+\\cdots+a_n$。", "hint": "【样例 $3$ 说明】\n\n$345+379+573=1734+573=2317$。\n\n【样例 $4$ 说明】\n\n$1234+567+89+10=2801+89+10=3990+10=4000$。\n\n【数据范围与约定】\n\n对于 $10\\%$ 的数据，$n=1$。\n\n对于 $30\\%$ 的数据，$n \\leq 2$。\n\n对于 $60\\%$ 的数据，$n \\leq 10$，$a_i \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 2020$，$0 \\leq a_i \\leq 10^9$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $A\n\nidea：[ET2006](https://www.luogu.com.cn/user/115194)，std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN"}}}
{"pid": "P6210", "type": "P", "difficulty": 5, "samples": [["12 3 8 10 17\n", "11\n6"], ["72 5 66 13 89\n", "94\n54"], ["360360 123 20200202 123456789 987654321\n", "21751721\n802555475"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "高精度", "莫比乌斯反演"], "title": "「SWTR-4」Easy Math Problems", "background": "数学老师给小 A 布置了 $2$ 道 Easy Math Problems。", "description": "给定 $n,c,f,l,r$，有集合 $S=\\{x\\in\\mathbb{N_+}\\mid\\gcd(x,n)\\leq c\\}$ 和集合 $Q=\\{x\\in S\\mid l\\leq x\\leq r\\}$。\n\n- 集合 $S$ 为所有与 $n$ 的 $\\gcd$ 不超过 $c$ 的正整数，集合 $Q$ 为 $S$ 中不小于 $l$，不大于 $r$ 的数。\n\n第一问：请求出集合 $S$ 中第 $f$ 小的数。\n\n第二问：请求出集合 $Q$ 中包含的元素个数。\n\n由于数字很大，所以小 A 想请你帮他求出问题的答案。", "inputFormat": "一行五个整数 $n,c,f,l,r$ —— 意义见题目描述。", "outputFormat": "输出两行整数 —— 第一行为第一问的答案，第二行为第二问的答案。", "hint": "【样例 $1$ 说明】\n\n$S=\\{1,2,3,5,7,9,10,11,13,14,15,17,\\dots\\},Q=\\{10,11,13,14,15,17\\}$，可知集合 $S$ 第 $8$ 小的数为 $11$，集合 $Q$ 中包含的元素个数为 $6$。\n\n【数据范围与约定】\n\n**本题使用捆绑测试**。\n\n子任务 $1(15\\%)$：$n\\leq 10^3$，$r\\leq 10^3$，$f\\leq 10^3$。\n\n子任务 $2(35\\%)$：$n\\leq 10^5$，$r\\leq 10^5$，$f\\leq 10^5$。\n\n子任务 $3(35\\%)$：$n\\leq 10^6$，$r\\leq 10^{12}$，$f\\leq 10^{12}$。\n\n子任务 $4(15\\%)$：$n\\leq 10^7$，$r\\leq 10^{10^5}$，$f\\leq 10^{10^5}$。\n\n对于 $100\\%$ 的数据，$1\\leq c\\leq n\\leq 10^7$，$1\\leq l\\leq r\\leq 10^{10^5}$，$1\\leq f\\leq 10^{10^5}$。\n\n【Tips】\n\n想用 $n\\log n$ 过这道题？\n\n【时间限制】\n\n对于前 $3$ 个子任务，时间限制 $1\\rm{s}$，剩下一个子任务 $500\\rm{ms}$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $B\n\nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[xtx1092515503](https://www.luogu.com.cn/user/123369) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-4\" Easy Math Problems", "background": "The math teacher assigned Little A $2$ Easy Math Problems.", "description": "Given $n,c,f,l,r$, define the set $S=\\{x\\in\\mathbb{N_+}\\mid\\gcd(x,n)\\leq c\\}$ and the set $Q=\\{x\\in S\\mid l\\leq x\\leq r\\}$.\n\n- Set $S$ contains all positive integers whose $\\gcd$ with $n$ is at most $c$, and set $Q$ contains the elements in $S$ that are not less than $l$ and not greater than $r$.\n\nQuestion 1: Find the $f$-th smallest number in set $S$.\n\nQuestion 2: Find the number of elements in set $Q$.\n\nSince the numbers are very large, Little A wants you to help compute the answers.", "inputFormat": "A single line with five integers $n,c,f,l,r$ — with meanings as described in the statement.", "outputFormat": "Output two lines of integers — the first line is the answer to Question 1, and the second line is the answer to Question 2.", "hint": "[Sample $1$ Explanation]\n\n$S=\\{1,2,3,5,7,9,10,11,13,14,15,17,\\dots\\},Q=\\{10,11,13,14,15,17\\}$. It can be seen that the $8$-th smallest number in $S$ is $11$, and the number of elements in $Q$ is $6$.\n\n[Constraints and Notes]\n\n**This problem uses bundled tests.**\n\nSubtask $1(15\\%)$: $n\\leq 10^3$, $r\\leq 10^3$, $f\\leq 10^3$.\n\nSubtask $2(35\\%)$: $n\\leq 10^5$, $r\\leq 10^5$, $f\\leq 10^5$.\n\nSubtask $3(35\\%)$: $n\\leq 10^6$, $r\\leq 10^{12}$, $f\\leq 10^{12}$.\n\nSubtask $4(15\\%)$: $n\\leq 10^7$, $r\\leq 10^{10^5}$, $f\\leq 10^{10^5}$.\n\nFor $100\\%$ of the testdata, $1\\leq c\\leq n\\leq 10^7$, $1\\leq l\\leq r\\leq 10^{10^5}$, $1\\leq f\\leq 10^{10^5}$.\n\n[Tips]\n\nWant to solve this problem with $n\\log n$?\n\n[Time Limit]\n\nFor the first $3$ subtasks, the time limit is $1\\rm{s}$, and for the remaining subtask it is $500\\rm{ms}$.\n\n[Source]\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $B\n\nidea & std: [Alex_Wei](https://www.luogu.com.cn/user/123294), verification: [xtx1092515503](https://www.luogu.com.cn/user/123369) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-4」Easy Math Problems", "background": "数学老师给小 A 布置了 $2$ 道 Easy Math Problems。", "description": "给定 $n,c,f,l,r$，有集合 $S=\\{x\\in\\mathbb{N_+}\\mid\\gcd(x,n)\\leq c\\}$ 和集合 $Q=\\{x\\in S\\mid l\\leq x\\leq r\\}$。\n\n- 集合 $S$ 为所有与 $n$ 的 $\\gcd$ 不超过 $c$ 的正整数，集合 $Q$ 为 $S$ 中不小于 $l$，不大于 $r$ 的数。\n\n第一问：请求出集合 $S$ 中第 $f$ 小的数。\n\n第二问：请求出集合 $Q$ 中包含的元素个数。\n\n由于数字很大，所以小 A 想请你帮他求出问题的答案。", "inputFormat": "一行五个整数 $n,c,f,l,r$ —— 意义见题目描述。", "outputFormat": "输出两行整数 —— 第一行为第一问的答案，第二行为第二问的答案。", "hint": "【样例 $1$ 说明】\n\n$S=\\{1,2,3,5,7,9,10,11,13,14,15,17,\\dots\\},Q=\\{10,11,13,14,15,17\\}$，可知集合 $S$ 第 $8$ 小的数为 $11$，集合 $Q$ 中包含的元素个数为 $6$。\n\n【数据范围与约定】\n\n**本题使用捆绑测试**。\n\n子任务 $1(15\\%)$：$n\\leq 10^3$，$r\\leq 10^3$，$f\\leq 10^3$。\n\n子任务 $2(35\\%)$：$n\\leq 10^5$，$r\\leq 10^5$，$f\\leq 10^5$。\n\n子任务 $3(35\\%)$：$n\\leq 10^6$，$r\\leq 10^{12}$，$f\\leq 10^{12}$。\n\n子任务 $4(15\\%)$：$n\\leq 10^7$，$r\\leq 10^{10^5}$，$f\\leq 10^{10^5}$。\n\n对于 $100\\%$ 的数据，$1\\leq c\\leq n\\leq 10^7$，$1\\leq l\\leq r\\leq 10^{10^5}$，$1\\leq f\\leq 10^{10^5}$。\n\n【Tips】\n\n想用 $n\\log n$ 过这道题？\n\n【时间限制】\n\n对于前 $3$ 个子任务，时间限制 $1\\rm{s}$，剩下一个子任务 $500\\rm{ms}$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $B\n\nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[xtx1092515503](https://www.luogu.com.cn/user/123369) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN"}}}
{"pid": "P6211", "type": "P", "difficulty": 3, "samples": [["2\n-2 1\n1 1", "3"], ["3\n-3 0 4\n2 3 4", "999999997"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "「SWTR-4」Meeting in the Forest", "background": "每当月圆时分，五个族群的族猫们都会聚集在小岛上，进行每月的森林大会。蒟星为了了解其它五族猫的特点，就扮成了一只独行猫来到小岛上……", "description": "森林大会上有 $n$ 只猫，每只猫的武力值为 $a_i$，于是蒟星列出了下面这样一个方程：\n\n$$x^n+\\sum_{i=1}^{n}a_ix^{n-i}=0$$\n\n- 通俗地讲，这个方程就是 $x^n+a_1x^{n-1}+a_2x^{n-2}+\\cdots+a_{n-1}x+a_n=0$。\n\n蒟星根据 TA 优（cu）秀（bi）的数学知识可以知道，这个方程在复数集内有 $n$ 个根，不妨把这 $n$ 个根设为 $x_1, x_2, ..., x_n$。\n\n接下来蒟星想要知道森林大会上的猫的实力如何，于是列出了下面一个表达式：\n\n$$\\sum_{i=1}^{n}(b_i\\times \\sum_{1\\le j_1 < j_2 <\\cdots< j_i \\le n}^{n}x_{j_1}x_{j_2}\\cdots x_{j_i})$$\n\n- $\\sum_{1\\le j_1 < j_2 < \\cdots < j_i \\le n}^{n}x_{j_1}x_{j_2}\\cdots x_{j_i}$ 就是从方程的 $n$ 个根中选出 $i$ 个，求所有可能方案的 $i$ 个根的乘积之和。\n\n但蒟星只要这个表达式对 $10^9+7$ 取模后的值就好了。\n\n- 若答案为负数 $a$，请输出 $a + (10^9+7)$。\n\n蒟星把这个任务交给了您，不过他已经告诉你了 $n$，$a_i$ 和 $b_i$，您能帮帮 TA 吗？", "inputFormat": "第一行一个整数 $n$ —— 表示方程的次数。\n\n第二行 $n$ 个整数 $a_1, a_2, ... a_n$ —— 意义见题目描述。\n\n第三行 $n$ 个整数 $b_1, b_2, ... b_n$ —— 同上。", "outputFormat": "输出一行，一个数，表示这个表达式对 $10^9+7$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n原方程为 $x^2-2x+1=0$，此时 $x_1=x_2=1$。\n\n表达式的值为 $x_1+x_2+x_1x_2=1+1+1=3$。\n\n【样例 $2$ 说明】\n\n原方程为 $x^3-3x^2+4=0$，此时 $x_1=-1,x_2=x_3=2$。\n\n表达式的值为 \n\n$$\\begin{aligned}&2\\cdot (x_1+x_2+x_3)+3\\cdot(x_1x_2+x_1x_3+x_2x_3)+4\\cdot x_1x_2x_3\\\\=\\ &2\\times(-1+2+2)+3\\times(-2+(-2)+4)+4\\times (-4)\\\\=\\ &-10\\end{aligned}$$\n\n因为 $-10$ 为负数，所以输出 $-10+(10^9+7)=999999997$。\n\n【数据范围与约定】\n\n对于 $10\\%$ 的数据，$n=1$。\n\n对于另外 $20\\%$ 的数据，$n=2$。\n\n对于 $40\\%$ 的数据，$n\\leq 10$。\n\n对于 $60\\%$ 的数据，$n\\leq 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\le 2 \\times 10^5$，$-10^9 \\le a_i, b_i \\le 10^9$。\n\n【Tips】\n\n[韦达定理](https://baike.baidu.com/item/%E9%9F%A6%E8%BE%BE%E5%AE%9A%E7%90%86/105027?fr=aladdin)也许会对你有帮助。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $C\n\nidea & std：[蒟蒻的名字](https://www.luogu.com.cn/user/147999)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-4」Meeting in the Forest", "background": "每当月圆时分，五个族群的族猫们都会聚集在小岛上，进行每月的森林大会。蒟星为了了解其它五族猫的特点，就扮成了一只独行猫来到小岛上……", "description": "森林大会上有 $n$ 只猫，每只猫的武力值为 $a_i$，于是蒟星列出了下面这样一个方程：\n\n$$x^n+\\sum_{i=1}^{n}a_ix^{n-i}=0$$\n\n- 通俗地讲，这个方程就是 $x^n+a_1x^{n-1}+a_2x^{n-2}+\\cdots+a_{n-1}x+a_n=0$。\n\n蒟星根据 TA 优（cu）秀（bi）的数学知识可以知道，这个方程在复数集内有 $n$ 个根，不妨把这 $n$ 个根设为 $x_1, x_2, ..., x_n$。\n\n接下来蒟星想要知道森林大会上的猫的实力如何，于是列出了下面一个表达式：\n\n$$\\sum_{i=1}^{n}(b_i\\times \\sum_{1\\le j_1 < j_2 <\\cdots< j_i \\le n}^{n}x_{j_1}x_{j_2}\\cdots x_{j_i})$$\n\n- $\\sum_{1\\le j_1 < j_2 < \\cdots < j_i \\le n}^{n}x_{j_1}x_{j_2}\\cdots x_{j_i}$ 就是从方程的 $n$ 个根中选出 $i$ 个，求所有可能方案的 $i$ 个根的乘积之和。\n\n但蒟星只要这个表达式对 $10^9+7$ 取模后的值就好了。\n\n- 若答案为负数 $a$，请输出 $a + (10^9+7)$。\n\n蒟星把这个任务交给了您，不过他已经告诉你了 $n$，$a_i$ 和 $b_i$，您能帮帮 TA 吗？", "inputFormat": "第一行一个整数 $n$ —— 表示方程的次数。\n\n第二行 $n$ 个整数 $a_1, a_2, ... a_n$ —— 意义见题目描述。\n\n第三行 $n$ 个整数 $b_1, b_2, ... b_n$ —— 同上。", "outputFormat": "输出一行，一个数，表示这个表达式对 $10^9+7$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n原方程为 $x^2-2x+1=0$，此时 $x_1=x_2=1$。\n\n表达式的值为 $x_1+x_2+x_1x_2=1+1+1=3$。\n\n【样例 $2$ 说明】\n\n原方程为 $x^3-3x^2+4=0$，此时 $x_1=-1,x_2=x_3=2$。\n\n表达式的值为 \n\n$$\\begin{aligned}&2\\cdot (x_1+x_2+x_3)+3\\cdot(x_1x_2+x_1x_3+x_2x_3)+4\\cdot x_1x_2x_3\\\\=\\ &2\\times(-1+2+2)+3\\times(-2+(-2)+4)+4\\times (-4)\\\\=\\ &-10\\end{aligned}$$\n\n因为 $-10$ 为负数，所以输出 $-10+(10^9+7)=999999997$。\n\n【数据范围与约定】\n\n对于 $10\\%$ 的数据，$n=1$。\n\n对于另外 $20\\%$ 的数据，$n=2$。\n\n对于 $40\\%$ 的数据，$n\\leq 10$。\n\n对于 $60\\%$ 的数据，$n\\leq 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\le 2 \\times 10^5$，$-10^9 \\le a_i, b_i \\le 10^9$。\n\n【Tips】\n\n[韦达定理](https://baike.baidu.com/item/%E9%9F%A6%E8%BE%BE%E5%AE%9A%E7%90%86/105027?fr=aladdin)也许会对你有帮助。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $C\n\nidea & std：[蒟蒻的名字](https://www.luogu.com.cn/user/147999)", "locale": "zh-CN"}}}
{"pid": "P6212", "type": "P", "difficulty": 5, "samples": [["3 1 2 1\nBG?\n", "500000004"], ["3 -1 4 3\n???\n", "750000006"], ["5 5 7 3\nG??B?\n", "625000005"], ["6 10 9 4\n??GB??\n", "937500007"], ["20 20 15 10\nB?G?B?G?????BBBG?GG?\n", "78125001"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192]}, "tags": ["动态规划 DP"], "title": "「SWTR-4」Lining up", "background": "作为班长的小 S 在指挥操场上的一群同学排队，Lining up 可不是一件容易的事情。", "description": "操场上有排成一列的 $n$ 个同学，每个同学要么是男生，用 ```B``` 表示；要么是女生，用 ```G``` 表示。\n\n我们定义两个相邻的同学的满意度如下：\n\n- 如果两个相邻的同学的性别相同，那么就会像普通同学一样聊天，产生 $0$ 点满意度。\n\n- 如果前面的同学是男生，后面的同学是女生，那么就不会有任何事件发生。同学们都很活跃，他们不希望这么无聊，产生 $-b$ 点满意度。\n\n- 如果前面的同学是女生，后面的同学是男生，那么他们就会聊得很开心，产生 $a$ 点满意度。\n\n由于小 S 是近视眼，所以他无法分辨有些同学的性别，用 ```?``` 表示。\n\n为了提高自己在大家心目中的地位，小 S 想保证所有相邻同学的满意度之和不小于 $m$。\n\n他想知道满足“所有相邻同学的满意度之和不小于 $m$”的概率是多少，对 $10^9+7$ 取模。", "inputFormat": "第一行，四个整数 $n,m,a,b$ —— 意义见题目描述。\n\n第二行，一个长度为 $n$ 的字符串 $s$ 表示队列 —— 第 $i$ 个字符表示**从前往后**数第 $i$ 位同学。", "outputFormat": "一行，表示概率。", "hint": "【样例 $1$ 说明】\n\n共有 $1$ 个满足题意的队形 $\\tt BGB$。概率为 $\\frac{1}{2} \\bmod (10^9+7)=500000004$。\n\n【样例 $2$ 说明】\n\n共有 $6$ 个满足题意的队形 $\\tt BBB,BGB,GBB,GBG,GGB,GGG$。概率为 $\\frac{6}{8} \\bmod (10^9+7)=750000006$。\n\n【样例 $5$ 说明】\n\n真实答案为 $\\dfrac{29}{64}$。\n\n【数据范围与约定】\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n\\leq$ | 特殊性质 | 分数\n:-: | :-: | :-: | :-:\n$1$ | $2020$ | 没有```?``` | $8$\n$2$ | $20$ | 无 | $17$\n$3$ | $250$ | 无 | $29$\n$4$ | $2020$ | $a=1,b=1$ | $10$\n$5$ | $2020$ | 无 | $36$\n\n对于全部数据，$2 \\leq n \\leq 2020$，$1 \\leq |m| \\leq 10^{12}$，$1 \\leq a,b \\leq 10^9$，$s_i \\in \\tt{\\{B,G,?\\}}$。\n\n**请注意特殊的空间限制。**\n\n【Tips】\n\n如果你不会对分数取模，可以看看[这里](https://www.luogu.com.cn/problem/P2613)。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $D\n\nidea：[ET2006](https://www.luogu.com.cn/user/115194)，std：[Isaunoya](https://www.luogu.com.cn/user/96580)，验题：[Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-4\" Lining up", "background": "As the class monitor, Little S is directing a group of classmates to line up on the playground. Lining up is not an easy task.", "description": "There are $n$ students standing in a single line on the playground. Each student is either a boy, denoted by ```B```, or a girl, denoted by ```G```.\n\nWe define the satisfaction of two adjacent students as follows:\n\n- If the two adjacent students have the same gender, then they chat like ordinary classmates, producing $0$ satisfaction.\n\n- If the student in front is a boy and the one behind is a girl, then nothing happens. The students are very active and do not want it to be so boring, producing $-b$ satisfaction.\n\n- If the student in front is a girl and the one behind is a boy, then they chat very happily, producing $a$ satisfaction.\n\nSince Little S is nearsighted, he cannot tell the gender of some students, denoted by ```?```.\n\nTo improve his status in everyone’s eyes, Little S wants to ensure that the sum of satisfaction over all adjacent pairs is at least $m$.\n\nHe wants to know the probability that the condition “the sum of satisfaction over all adjacent pairs is at least $m$” holds, modulo $10^9+7$.", "inputFormat": "The first line contains four integers $n, m, a, b$ — as described in the statement.\n\nThe second line contains a string $s$ of length $n$ representing the line — the $i$-th character represents the $i$-th student **from front to back**.", "outputFormat": "Output one line containing the probability.", "hint": "[Sample $1$ Explanation]\n\nThere is $1$ lineup that satisfies the condition: $\\tt BGB$. The probability is $\\frac{1}{2} \\bmod (10^9+7)=500000004$.\n\n[Sample $2$ Explanation]\n\nThere are $6$ lineups that satisfy the condition: $\\tt BBB,BGB,GBB,GBG,GGB,GGG$. The probability is $\\frac{6}{8} \\bmod (10^9+7)=750000006$.\n\n[Sample $5$ Explanation]\n\nThe actual answer is $\\dfrac{29}{64}$.\n\n[Constraints and Notes]\n\n**This problem uses bundled testdata.**\n\nSubtask ID | $n\\leq$ | Special property | Score\n:-: | :-: | :-: | :-:\n$1$ | $2020$ | No ```?``` | $8$\n$2$ | $20$ | None | $17$\n$3$ | $250$ | None | $29$\n$4$ | $2020$ | $a=1,b=1$ | $10$\n$5$ | $2020$ | None | $36$\n\nFor all testdata: $2 \\leq n \\leq 2020$, $1 \\leq |m| \\leq 10^{12}$, $1 \\leq a,b \\leq 10^9$, $s_i \\in \\tt{\\{B,G,?\\}}$.\n\n**Please note the special memory limit.**\n\n[Tips]\n\nIf you do not know how to take a fraction modulo, you can read [here](https://www.luogu.com.cn/problem/P2613).\n\n[Source]\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $D\n\nidea: [ET2006](https://www.luogu.com.cn/user/115194), std: [Isaunoya](https://www.luogu.com.cn/user/96580), validator: [Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-4」Lining up", "background": "作为班长的小 S 在指挥操场上的一群同学排队，Lining up 可不是一件容易的事情。", "description": "操场上有排成一列的 $n$ 个同学，每个同学要么是男生，用 ```B``` 表示；要么是女生，用 ```G``` 表示。\n\n我们定义两个相邻的同学的满意度如下：\n\n- 如果两个相邻的同学的性别相同，那么就会像普通同学一样聊天，产生 $0$ 点满意度。\n\n- 如果前面的同学是男生，后面的同学是女生，那么就不会有任何事件发生。同学们都很活跃，他们不希望这么无聊，产生 $-b$ 点满意度。\n\n- 如果前面的同学是女生，后面的同学是男生，那么他们就会聊得很开心，产生 $a$ 点满意度。\n\n由于小 S 是近视眼，所以他无法分辨有些同学的性别，用 ```?``` 表示。\n\n为了提高自己在大家心目中的地位，小 S 想保证所有相邻同学的满意度之和不小于 $m$。\n\n他想知道满足“所有相邻同学的满意度之和不小于 $m$”的概率是多少，对 $10^9+7$ 取模。", "inputFormat": "第一行，四个整数 $n,m,a,b$ —— 意义见题目描述。\n\n第二行，一个长度为 $n$ 的字符串 $s$ 表示队列 —— 第 $i$ 个字符表示**从前往后**数第 $i$ 位同学。", "outputFormat": "一行，表示概率。", "hint": "【样例 $1$ 说明】\n\n共有 $1$ 个满足题意的队形 $\\tt BGB$。概率为 $\\frac{1}{2} \\bmod (10^9+7)=500000004$。\n\n【样例 $2$ 说明】\n\n共有 $6$ 个满足题意的队形 $\\tt BBB,BGB,GBB,GBG,GGB,GGG$。概率为 $\\frac{6}{8} \\bmod (10^9+7)=750000006$。\n\n【样例 $5$ 说明】\n\n真实答案为 $\\dfrac{29}{64}$。\n\n【数据范围与约定】\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n\\leq$ | 特殊性质 | 分数\n:-: | :-: | :-: | :-:\n$1$ | $2020$ | 没有```?``` | $8$\n$2$ | $20$ | 无 | $17$\n$3$ | $250$ | 无 | $29$\n$4$ | $2020$ | $a=1,b=1$ | $10$\n$5$ | $2020$ | 无 | $36$\n\n对于全部数据，$2 \\leq n \\leq 2020$，$1 \\leq |m| \\leq 10^{12}$，$1 \\leq a,b \\leq 10^9$，$s_i \\in \\tt{\\{B,G,?\\}}$。\n\n**请注意特殊的空间限制。**\n\n【Tips】\n\n如果你不会对分数取模，可以看看[这里](https://www.luogu.com.cn/problem/P2613)。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $D\n\nidea：[ET2006](https://www.luogu.com.cn/user/115194)，std：[Isaunoya](https://www.luogu.com.cn/user/96580)，验题：[Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN"}}}
{"pid": "P6213", "type": "P", "difficulty": 6, "samples": [["6 4\n1 2 3\n2 3 4\n2 4 5\n3 5 2\n3 6 3\n1 2 1 1 2 2\n", "5"], ["6 4\n1 2 3\n2 3 4\n2 4 5\n3 5 2\n3 6 3\n1 1 1 1 1 1\n", "0"], ["6 4\n1 2 3\n2 3 4\n2 4 5\n3 5 2\n3 6 3\n2 2 2 2 2 2\n", "12"], ["12 6\n1 4 33\n2 11 51\n3 9 100\n4 8 7\n5 9 35\n6 12 30\n7 11 58\n8 10 65\n9 10 59\n10 12 9\n11 12 72\n2 2 2 3 2 1 2 1 2 3 2 2\n", "263"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "树形 DP"], "title": "「SWTR-4」Collecting Coins", "background": "小 A 喜欢 Collecting Coins。他还有个好朋友叫做小 c。\n\n小 c 在外出游玩的时候被困在了一个迷宫里面，小 A 得知消息后，立刻放下了自己手中正在打的树套树套树套树，出发去营救她。", "description": "经过一番勘察，小 A 发现小 c 被困的迷宫由 $n$ 个房间组成，这些房间用 $n-1$ 扇门连接，**形成了一颗树**。小 c 被困在 $d$ 号房间。\n\n小 A 还发现每扇门上都写有一个数字 $v$，经过该扇门就会获得 $v$ 个金币，但每扇门上的金币只能获得一次。\n\n由于把小 c 困在迷宫里的坏人早已知道小 A 会来救她，所以他们在每个房间里都布下了陷阱，使得第 $i$ 个房间最多可以进入 $k_i$ 次，否则小 A 也会被困在迷宫里。Luckily，小 c 在向小 A 求救的时候，已经将这个陷阱告诉了他。\n\n小 A 在进入迷宫的时候可以任选初始房间 $r$（进入迷宫算一次进入房间 $r$）。**小 A 可以离开迷宫，当且仅当他在房间 $r$。**\n\n如果小 A 进入了 $d$ 号房间，我们就认为他成功地救下了小 c。在救下小 c 后，小 A 还可以带着她继续在迷宫中行动。\n\n虽然小 A 并不是一个非常贪财的人，但还是想知道：在**成功救下小 c** 且离开迷宫的前提下，他最多能获得多少金币。", "inputFormat": "第一行，两个整数 $n,d$ —— 表示房间个数和小 c 被困的房间号。\n\n接下来 $n-1$ 行，每行三个整数 $x_i,y_i,v_i$ —— 分别表示第 $i$ 扇门连接的两个房间编号和这扇门上写的数。\n\n接下来一行，$n$ 个整数 $k_1,k_2,\\cdots,k_n$ —— 表示每个房间最多可进入的次数。", "outputFormat": "一行一个整数，表示小 A 能获得的金币数量的最大值。", "hint": "【样例 $1$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zwtjgksh.png)\n\n一种最优的走法为：$2\\to 4\\to 2$，共可获得 $5$ 金币。\n\n【样例 $2$ 说明】\n\n如上图，小 A 只能空降到 $4$ 号房间，然后再离开迷宫，共可获得 $0$ 金币。\n\n【样例 $4$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fmd43hzq.png)\n\n一种最优的走法为：$3\\to 9\\to 10\\to 8\\to 10\\to 12\\to 6\\to 12\\to 10\\to 9\\to 3$，共可获得 $100+59+65+9+30=263$ 金币。\n\n【数据范围与约定】\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n\\leq$ | 特殊性质 | 分值 |\n:-: | :-: | :-: | :-: |\n$1$ | $12$ | $k_i=1$ | $3$ |\n$2$ | $12$ | $k_i\\leq 3$ | $12$ |\n$3$ | $10^3$ | 迷宫为一条链 | $9$ |\n$4$ | $10^3$ | 无 | $16$ |\n$5$ | $10^5$ | 迷宫为一条链 | $9$ |\n$6$ | $10^5$ | 迷宫为一个菊花图 | $16$ |\n$7$ | $10^5$ | 无 | $35$ |\n\n对于 $100\\%$ 的数据，$1\\leq d,k_i\\leq n\\leq 10^5$，$1\\leq v_i\\leq 10^4$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $E\n\nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-4\" Collecting Coins", "background": "Little A likes Collecting Coins. He also has a good friend named little c.\n\nWhile traveling outside, little c got trapped in a maze. After hearing the news, little A immediately put down the “tree-of-trees-of-trees” he was playing and set off to rescue her.", "description": "After some investigation, little A found that the maze where little c is trapped consists of $n$ rooms, connected by $n-1$ doors, **forming a tree**. Little c is trapped in room $d$.\n\nLittle A also found that each door has a number $v$ written on it. Passing through that door gives $v$ coins, but the coins on each door can only be obtained once.\n\nSince the bad guys who trapped little c already knew little A would come to rescue her, they placed traps in every room, so that room $i$ can be entered at most $k_i$ times; otherwise, little A would also be trapped in the maze. Luckily, when asking little A for help, little c had already told him about this trap.\n\nWhen entering the maze, little A may choose any starting room $r$ (entering the maze counts as entering room $r$ once). **Little A can leave the maze if and only if he is in room $r$.**\n\nIf little A enters room $d$, we consider that he has successfully rescued little c. After rescuing little c, little A may continue moving in the maze with her.\n\nAlthough little A is not a very greedy person, he still wants to know: under the condition that he **successfully rescues little c** and leaves the maze, what is the maximum number of coins he can obtain.", "inputFormat": "The first line contains two integers $n,d$, representing the number of rooms and the room number where little c is trapped.\n\nThe next $n-1$ lines each contain three integers $x_i,y_i,v_i$, representing the two room numbers connected by the $i$-th door, and the number written on that door.\n\nThe next line contains $n$ integers $k_1,k_2,\\cdots,k_n$, representing the maximum number of times each room can be entered.", "outputFormat": "Output one integer in a single line, representing the maximum number of coins little A can obtain.", "hint": "[Sample $1$ Explanation]\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zwtjgksh.png)\n\nOne optimal route is: $2\\to 4\\to 2$, and it can obtain $5$ coins in total.\n\n[Sample $2$ Explanation]\n\nAs in the figure above, little A can only “airdrop” to room $4$, and then leave the maze, obtaining $0$ coins in total.\n\n[Sample $4$ Explanation]\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fmd43hzq.png)\n\nOne optimal route is: $3\\to 9\\to 10\\to 8\\to 10\\to 12\\to 6\\to 12\\to 10\\to 9\\to 3$, and it can obtain $100+59+65+9+30=263$ coins in total.\n\n[Constraints and Notes]\n\n**This problem uses bundled testdata.**\n\nSubtask ID | $n\\leq$ | Special Property | Score |\n:-: | :-: | :-: | :-: |\n$1$ | $12$ | $k_i=1$ | $3$ |\n$2$ | $12$ | $k_i\\leq 3$ | $12$ |\n$3$ | $10^3$ | The maze is a chain | $9$ |\n$4$ | $10^3$ | None | $16$ |\n$5$ | $10^5$ | The maze is a chain | $9$ |\n$6$ | $10^5$ | The maze is a “chrysanthemum graph” (juhua tu) | $16$ |\n$7$ | $10^5$ | None | $35$ |\n\nFor $100\\%$ of the data, $1\\leq d,k_i\\leq n\\leq 10^5$, $1\\leq v_i\\leq 10^4$.\n\n[Source]\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $E\n\nidea & std: [Alex_Wei](https://www.luogu.com.cn/user/123294), validator: [chenxia25](https://www.luogu.com.cn/user/138400)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-4」Collecting Coins", "background": "小 A 喜欢 Collecting Coins。他还有个好朋友叫做小 c。\n\n小 c 在外出游玩的时候被困在了一个迷宫里面，小 A 得知消息后，立刻放下了自己手中正在打的树套树套树套树，出发去营救她。", "description": "经过一番勘察，小 A 发现小 c 被困的迷宫由 $n$ 个房间组成，这些房间用 $n-1$ 扇门连接，**形成了一颗树**。小 c 被困在 $d$ 号房间。\n\n小 A 还发现每扇门上都写有一个数字 $v$，经过该扇门就会获得 $v$ 个金币，但每扇门上的金币只能获得一次。\n\n由于把小 c 困在迷宫里的坏人早已知道小 A 会来救她，所以他们在每个房间里都布下了陷阱，使得第 $i$ 个房间最多可以进入 $k_i$ 次，否则小 A 也会被困在迷宫里。Luckily，小 c 在向小 A 求救的时候，已经将这个陷阱告诉了他。\n\n小 A 在进入迷宫的时候可以任选初始房间 $r$（进入迷宫算一次进入房间 $r$）。**小 A 可以离开迷宫，当且仅当他在房间 $r$。**\n\n如果小 A 进入了 $d$ 号房间，我们就认为他成功地救下了小 c。在救下小 c 后，小 A 还可以带着她继续在迷宫中行动。\n\n虽然小 A 并不是一个非常贪财的人，但还是想知道：在**成功救下小 c** 且离开迷宫的前提下，他最多能获得多少金币。", "inputFormat": "第一行，两个整数 $n,d$ —— 表示房间个数和小 c 被困的房间号。\n\n接下来 $n-1$ 行，每行三个整数 $x_i,y_i,v_i$ —— 分别表示第 $i$ 扇门连接的两个房间编号和这扇门上写的数。\n\n接下来一行，$n$ 个整数 $k_1,k_2,\\cdots,k_n$ —— 表示每个房间最多可进入的次数。", "outputFormat": "一行一个整数，表示小 A 能获得的金币数量的最大值。", "hint": "【样例 $1$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zwtjgksh.png)\n\n一种最优的走法为：$2\\to 4\\to 2$，共可获得 $5$ 金币。\n\n【样例 $2$ 说明】\n\n如上图，小 A 只能空降到 $4$ 号房间，然后再离开迷宫，共可获得 $0$ 金币。\n\n【样例 $4$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fmd43hzq.png)\n\n一种最优的走法为：$3\\to 9\\to 10\\to 8\\to 10\\to 12\\to 6\\to 12\\to 10\\to 9\\to 3$，共可获得 $100+59+65+9+30=263$ 金币。\n\n【数据范围与约定】\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n\\leq$ | 特殊性质 | 分值 |\n:-: | :-: | :-: | :-: |\n$1$ | $12$ | $k_i=1$ | $3$ |\n$2$ | $12$ | $k_i\\leq 3$ | $12$ |\n$3$ | $10^3$ | 迷宫为一条链 | $9$ |\n$4$ | $10^3$ | 无 | $16$ |\n$5$ | $10^5$ | 迷宫为一条链 | $9$ |\n$6$ | $10^5$ | 迷宫为一个菊花图 | $16$ |\n$7$ | $10^5$ | 无 | $35$ |\n\n对于 $100\\%$ 的数据，$1\\leq d,k_i\\leq n\\leq 10^5$，$1\\leq v_i\\leq 10^4$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $E\n\nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN"}}}
{"pid": "P6214", "type": "P", "difficulty": 7, "samples": [["3 3 10\n0.00 0.00 0.00 1.00\n-1.00 -1.00 0.20\n10.00 10.00 0.41\n-4.56 -1.23 1.00\n-2.00 -1.00 0.40\n-10.00 -10.00 0.41\n9.87 6.54 1.00\n0.00 1\n1.00 1\n5.00 1\n5.00 3\n5.00 4\n10.00 2\n10.00 6\n28.28 1\n28.28 2\n28.29 1", "-4.66\n-2.33\n0.26970954\n0.83836048\n-4.66\n0.65792852\n-4.66\n0.40999665\n0.41005730\n-4.66"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["计算几何", "线段树", "Special Judge", "O2优化", "可持久化线段树", "可持久化"], "title": "「SWTR-4」Taking a Walk", "background": "小 A 喜欢在广场上散步。\n\n有一次在小 A 散步的时候，由于思考得过于投入，他不小心撞在了电线杆上。\n\n于是就有了这道题目（当然是假的）。", "description": "小 A 和 好友小 Y 站在一个平面上，他们的初始坐标分别是 $(Ax_0,Ay_0)$ 和 $(Bx_0,By_0)$。\n\n当然，站着实在是太无聊了，所以他们会不停地移动。\n\n准确来说，小 A 共有 $n$ 次移动，小 Y 共有 $m$ 次移动。\n\n小 A 在第 $At_{i-1}$ 到第 $At_i$ 时刻会从 $(Ax_{i-1},Ay_{i-1})$ **匀速直线运动**到 $(Ax_i,Ay_i)$。\n\n小 Y 在第 $Bt_{i-1}$ 到第 $Bt_i$ 时刻会从 $(Bx_{i-1},By_{i-1})$ **匀速直线运动**到 $(Bx_i,By_i)$。\n\n- $At_0=Bt_0=0$。\n\n小 A 还有 $q$ 次询问： 每次询问给出一个浮点数 $c$ 和一个整数 $f$，请求出他们第 $f$ 次相距 $c$ 的时刻。\n\n- **特殊的，如果他们之间相距 $c$ 的时刻有无数个**，输出 `-2.33`。\n\n- **特殊的，如果 $f$ 大于他们之间相距 $c$ 的次数**，输出 `-4.66`。\n\n- 如果不满足上面两个条件，输出他们第 $f$ 次相距 $c$ 的时刻。\n", "inputFormat": "第一行，三个整数 $n,m,q$ —— $n$ 表示小 A 的移动次数，$m$ 表示小 Y 的移动次数，$q$ 表示询问次数。\n\n第二行，四个两位浮点数 $Ax_0,Ay_0,Bx_0,By_0$ —— 表示小 A 和小 Y 的初始坐标。\n\n接下来 $n$ 行，第 $i$ 行三个两位浮点数 $Ax_i,Ay_i,At_i$ —— 意义见题目描述。\n\n接下来 $m$ 行，第 $i$ 行三个两位浮点数 $Bx_i,By_i,Bt_i$ —— 同上。\n\n接下来 $q$ 行，每行一个两位浮点数 $c$ 和一个整数 $f$ —— 描述一个询问。", "outputFormat": "共 $q$ 个浮点数，表示每个询问的答案。", "hint": "**「Special Judge」**\n\n**本题使用 Special judge。**\n\n如果你的输出与正确答案的**相对误差或绝对误差**不超过 $10^{-7}$，将会获得该测试点的满分，否则不得分。**建议输出至少 $8$ 位小数**。\n\n请不要输出除了题目要求以外的数字，否则可能获得 UKE。\n\n保证没有答案为 $0$ 的情况。\n\nSPJ 如下：\n\n```\n#include \"testlib.h\"\n#define double long double\nconst double eps=1e-7;\nbool Equal(double x,double y){\n\treturn abs(x-y)<=eps||abs((x-y)/y)<=eps;\n}\nint main(int argc, char* argv[]){\n    registerTestlibCmd(argc, argv);\n    int n=inf.readInt(),m=inf.readInt(),q=inf.readInt();\n    for(int i=1;i<=q;i++){\n    \tdouble x=ouf.readDouble(),y=ans.readDouble();\n    \tif(!Equal(x,y))quitf(_wa,\"On line %d the answer is wrong: expected = %.8LF, found = %.8LF\",i,y,x);\n\t}\n\tquitf(_ok, \"The answer is correct.\"); \n\treturn 0;\n}\n```\n\n**「数据范围与约定」**\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n,m\\leq$ | $q\\leq$ | 得分\n:-: | :-: | :-: | :-:\n$1$ | $5\\times 10^2$ | $10^3$ | $10$\n$2$ | $2\\times 10^4$ | $2\\times 10^4$ | $20$\n$3$ | $4\\times 10^4$ | $5\\times 10^4$ | $30$\n$4$ | $8\\times 10^4$ | $3\\times 10^5$ | $40$\n\n对于 $100\\%$ 的数据，有 $1\\leq n,m\\leq 8\\times 10^4$，$1\\leq q\\leq 3\\times 10^5$，$At_n=Bt_m\\leq 6\\times 10^4$，$1\\leq f\\leq m+n$，$0\\leq c\\leq 3\\times 10^4$。\n\n为保证极端数据下的精度，所有坐标的绝对值不大于 $10^4$。\n\n保证 $At_i<At_{i+1}$，$Bt_i<Bt_{i+1}$，一次移动的时间不超过 $6\\times 10^2$。**不保证**某次移动没有改变位置。\n\n**请注意精度误差。**\n\n**「时间 & 空间限制」**\n\n对于第 $1$ 个子任务，时限 $\\rm{1s}$；其余子任务时限 $\\rm{2.5s}$。\n\n对于第 $1$ 个子任务，空限 $\\rm{128MB}$；其余子任务空限 $\\rm{256MB}$。\n\n**为了卡掉错解，出题人放短了时限，但时限仍在 std 的 $2$ 倍以上。**\n\n**std 轻微卡常，请注意 I/O/常数优化。**\n\n**本题开启自动 O2 优化。**\n\n**「来源」**\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414) F。  \nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-4」Taking a Walk", "background": "小 A 喜欢在广场上散步。\n\n有一次在小 A 散步的时候，由于思考得过于投入，他不小心撞在了电线杆上。\n\n于是就有了这道题目（当然是假的）。", "description": "小 A 和 好友小 Y 站在一个平面上，他们的初始坐标分别是 $(Ax_0,Ay_0)$ 和 $(Bx_0,By_0)$。\n\n当然，站着实在是太无聊了，所以他们会不停地移动。\n\n准确来说，小 A 共有 $n$ 次移动，小 Y 共有 $m$ 次移动。\n\n小 A 在第 $At_{i-1}$ 到第 $At_i$ 时刻会从 $(Ax_{i-1},Ay_{i-1})$ **匀速直线运动**到 $(Ax_i,Ay_i)$。\n\n小 Y 在第 $Bt_{i-1}$ 到第 $Bt_i$ 时刻会从 $(Bx_{i-1},By_{i-1})$ **匀速直线运动**到 $(Bx_i,By_i)$。\n\n- $At_0=Bt_0=0$。\n\n小 A 还有 $q$ 次询问： 每次询问给出一个浮点数 $c$ 和一个整数 $f$，请求出他们第 $f$ 次相距 $c$ 的时刻。\n\n- **特殊的，如果他们之间相距 $c$ 的时刻有无数个**，输出 `-2.33`。\n\n- **特殊的，如果 $f$ 大于他们之间相距 $c$ 的次数**，输出 `-4.66`。\n\n- 如果不满足上面两个条件，输出他们第 $f$ 次相距 $c$ 的时刻。\n", "inputFormat": "第一行，三个整数 $n,m,q$ —— $n$ 表示小 A 的移动次数，$m$ 表示小 Y 的移动次数，$q$ 表示询问次数。\n\n第二行，四个两位浮点数 $Ax_0,Ay_0,Bx_0,By_0$ —— 表示小 A 和小 Y 的初始坐标。\n\n接下来 $n$ 行，第 $i$ 行三个两位浮点数 $Ax_i,Ay_i,At_i$ —— 意义见题目描述。\n\n接下来 $m$ 行，第 $i$ 行三个两位浮点数 $Bx_i,By_i,Bt_i$ —— 同上。\n\n接下来 $q$ 行，每行一个两位浮点数 $c$ 和一个整数 $f$ —— 描述一个询问。", "outputFormat": "共 $q$ 个浮点数，表示每个询问的答案。", "hint": "**「Special Judge」**\n\n**本题使用 Special judge。**\n\n如果你的输出与正确答案的**相对误差或绝对误差**不超过 $10^{-7}$，将会获得该测试点的满分，否则不得分。**建议输出至少 $8$ 位小数**。\n\n请不要输出除了题目要求以外的数字，否则可能获得 UKE。\n\n保证没有答案为 $0$ 的情况。\n\nSPJ 如下：\n\n```\n#include \"testlib.h\"\n#define double long double\nconst double eps=1e-7;\nbool Equal(double x,double y){\n\treturn abs(x-y)<=eps||abs((x-y)/y)<=eps;\n}\nint main(int argc, char* argv[]){\n    registerTestlibCmd(argc, argv);\n    int n=inf.readInt(),m=inf.readInt(),q=inf.readInt();\n    for(int i=1;i<=q;i++){\n    \tdouble x=ouf.readDouble(),y=ans.readDouble();\n    \tif(!Equal(x,y))quitf(_wa,\"On line %d the answer is wrong: expected = %.8LF, found = %.8LF\",i,y,x);\n\t}\n\tquitf(_ok, \"The answer is correct.\"); \n\treturn 0;\n}\n```\n\n**「数据范围与约定」**\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n,m\\leq$ | $q\\leq$ | 得分\n:-: | :-: | :-: | :-:\n$1$ | $5\\times 10^2$ | $10^3$ | $10$\n$2$ | $2\\times 10^4$ | $2\\times 10^4$ | $20$\n$3$ | $4\\times 10^4$ | $5\\times 10^4$ | $30$\n$4$ | $8\\times 10^4$ | $3\\times 10^5$ | $40$\n\n对于 $100\\%$ 的数据，有 $1\\leq n,m\\leq 8\\times 10^4$，$1\\leq q\\leq 3\\times 10^5$，$At_n=Bt_m\\leq 6\\times 10^4$，$1\\leq f\\leq m+n$，$0\\leq c\\leq 3\\times 10^4$。\n\n为保证极端数据下的精度，所有坐标的绝对值不大于 $10^4$。\n\n保证 $At_i<At_{i+1}$，$Bt_i<Bt_{i+1}$，一次移动的时间不超过 $6\\times 10^2$。**不保证**某次移动没有改变位置。\n\n**请注意精度误差。**\n\n**「时间 & 空间限制」**\n\n对于第 $1$ 个子任务，时限 $\\rm{1s}$；其余子任务时限 $\\rm{2.5s}$。\n\n对于第 $1$ 个子任务，空限 $\\rm{128MB}$；其余子任务空限 $\\rm{256MB}$。\n\n**为了卡掉错解，出题人放短了时限，但时限仍在 std 的 $2$ 倍以上。**\n\n**std 轻微卡常，请注意 I/O/常数优化。**\n\n**本题开启自动 O2 优化。**\n\n**「来源」**\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414) F。  \nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN"}}}
{"pid": "P6215", "type": "P", "difficulty": 5, "samples": [["10 10 1 1\n0 1 8 8 5 6 6 8 0 1 \n9 2 8 8 6 2 5 0 1 8 \n3 9\n1 2 3\n3 10\n3 5\n2 10 0\n3 10\n1 5 9\n2 9 7\n3 9\n3 4\n", "610\n1034\n390\n674\n1018\n246\n"], ["10 10 873892251 2\n393158301 365328187 234823508 38818450 963771276 826653462 358628534 626503513 239326879 647251399 \n1 1 1 1 1 1 1 1 1 1 \n1 6 861625956\n1 2 300158647\n1 2 84103073\n3 8\n1 1 942644245\n1 9 883742604\n1 2 974963615\n3 5\n1 8 710319943\n3 1\n", "35415628\n483475596\n154061492\n"], ["10 10 480345252 3\n494173949 364489100 93066339 249297520 207335443 117096873 864460454 113006173 214332928 582507765 \n5658914 222040024 221653308 296560771 594076100 151232714 410372721 23331041 374481229 184401699 \n3 6\n3 8\n1 1 931776921\n1 6 44943479\n1 6 946828878\n1 4 9046748\n3 3\n1 7 692410213\n1 10 483672045\n3 10\n", "214010503\n321766325\n894782746\n274293582\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树"], "title": "函数求值", "background": "", "description": "有两个长度均为 $n$ 的权值序列 $a,b$，常数 $p,k$，以及两个函数：\n\n$$g(x) = \\sum_{i=1}^x p^i \\times a_i$$\n\n$$f(x) = \\sum_{i=1}^x g(i) ^ k \\times b_i$$\n\n有 $m$ 个操作，操作有以下三种：\n\n*  $1\\ x\\ y$，表示将 $a_x$ 修改为 $y$。\n\n*  $2\\ x\\ y$，表示将 $b_x$ 修改为 $y$。\n\n*  $3\\ x$，表示查询 $f(x)$ 对 $10 ^ 9 + 7$ 取模的值。", "inputFormat": "第一行四个整数，$n,m,p,k$。\n\n第二行 $n$ 个整数，表示序列 $a$。\n\n第三行 $n$ 个整数，表示序列 $b$。\n\n接下来 $m$ 行，每行描述一个操作。", "outputFormat": "对于每个 $3\\ x$ 操作，输出答案。", "hint": "**【样例解释】**\n\n   这是样例一操作四后的结果：\n\n| $/$  | $1$ | $2$ | $3$ | $4$ | $5$ |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $a_i$ | $0$ | $3$ |  $8$ | $8$ | $5$ |\n| $b_i$ | $9$ | $2$ |  $8$ | $8$ | $6$ |\n| $g(i)$ | $0$ | $3$ |  $11$ | $19$ | $24$ |\n| $f(i)$ | $0$ | $6$ |  $94$ | $246$ | $390$ |\n\n----------------------\n\n**【数据范围】**\n\n- 对于 $100\\%%$ 的数据：\n\n    $1 \\le n,m \\le 2 \\times 10 ^ 5$。\n\n    $0 \\le a_i,b_i,p \\le 10 ^ 9 + 6$。\n\n    $1 \\le x \\le n$，$0 \\le y \\le 10 ^ 9 + 6$。\n\n    $1 \\le k \\le 3$。\n\n- **详细的数据范围：**\n\n     测试点编号 | $n,m \\le$ | $k$ | 特殊性质 \n     :-: | :-: | :-: | :-:\n     $1$ | $300$ | $\\le 3$ |  无\n     $2$ | $300$ | $\\le 3$ |  无\n     $3$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  无\n     $4$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  无\n     $5$ | $7 \\times 10 ^ 4$ | $= 1$ | A\n     $6$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $7$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $8$ | $7 \\times 10 ^ 4$ | $= 2$ |  A \n     $9$ | $7 \\times 10 ^ 4$ | $= 3$ |  A\n     $10$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $11$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $12$ | $7 \\times 10 ^ 4$ | $= 2$ | B\n     $13$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $14$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $15$ | $7 \\times 10 ^ 4$ | $= 1$ |  无\n     $16$ | $7 \\times 10 ^ 4$ | $= 2$ |  无\n     $17$ | $7 \\times 10 ^ 4$ | $= 3$ |  无\n     $18$ | $2 \\times 10 ^ 5$ | $= 1$ |  无\n     $19$ | $2 \\times 10 ^ 5$ | $= 2$ |  无\n     $20$ | $2 \\times 10 ^ 5$ | $= 3$ |  无\n\n     A：任意时刻所有 $b_i = 1$。\n\n     B：无操作二。\n\n---------------------\n\n**【提示】**\n\n样例二满足A类性质，样例三满足B类性质。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "函数求值", "background": "", "description": "有两个长度均为 $n$ 的权值序列 $a,b$，常数 $p,k$，以及两个函数：\n\n$$g(x) = \\sum_{i=1}^x p^i \\times a_i$$\n\n$$f(x) = \\sum_{i=1}^x g(i) ^ k \\times b_i$$\n\n有 $m$ 个操作，操作有以下三种：\n\n*  $1\\ x\\ y$，表示将 $a_x$ 修改为 $y$。\n\n*  $2\\ x\\ y$，表示将 $b_x$ 修改为 $y$。\n\n*  $3\\ x$，表示查询 $f(x)$ 对 $10 ^ 9 + 7$ 取模的值。", "inputFormat": "第一行四个整数，$n,m,p,k$。\n\n第二行 $n$ 个整数，表示序列 $a$。\n\n第三行 $n$ 个整数，表示序列 $b$。\n\n接下来 $m$ 行，每行描述一个操作。", "outputFormat": "对于每个 $3\\ x$ 操作，输出答案。", "hint": "**【样例解释】**\n\n   这是样例一操作四后的结果：\n\n| $/$  | $1$ | $2$ | $3$ | $4$ | $5$ |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $a_i$ | $0$ | $3$ |  $8$ | $8$ | $5$ |\n| $b_i$ | $9$ | $2$ |  $8$ | $8$ | $6$ |\n| $g(i)$ | $0$ | $3$ |  $11$ | $19$ | $24$ |\n| $f(i)$ | $0$ | $6$ |  $94$ | $246$ | $390$ |\n\n----------------------\n\n**【数据范围】**\n\n- 对于 $100\\%%$ 的数据：\n\n    $1 \\le n,m \\le 2 \\times 10 ^ 5$。\n\n    $0 \\le a_i,b_i,p \\le 10 ^ 9 + 6$。\n\n    $1 \\le x \\le n$，$0 \\le y \\le 10 ^ 9 + 6$。\n\n    $1 \\le k \\le 3$。\n\n- **详细的数据范围：**\n\n     测试点编号 | $n,m \\le$ | $k$ | 特殊性质 \n     :-: | :-: | :-: | :-:\n     $1$ | $300$ | $\\le 3$ |  无\n     $2$ | $300$ | $\\le 3$ |  无\n     $3$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  无\n     $4$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  无\n     $5$ | $7 \\times 10 ^ 4$ | $= 1$ | A\n     $6$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $7$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $8$ | $7 \\times 10 ^ 4$ | $= 2$ |  A \n     $9$ | $7 \\times 10 ^ 4$ | $= 3$ |  A\n     $10$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $11$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $12$ | $7 \\times 10 ^ 4$ | $= 2$ | B\n     $13$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $14$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $15$ | $7 \\times 10 ^ 4$ | $= 1$ |  无\n     $16$ | $7 \\times 10 ^ 4$ | $= 2$ |  无\n     $17$ | $7 \\times 10 ^ 4$ | $= 3$ |  无\n     $18$ | $2 \\times 10 ^ 5$ | $= 1$ |  无\n     $19$ | $2 \\times 10 ^ 5$ | $= 2$ |  无\n     $20$ | $2 \\times 10 ^ 5$ | $= 3$ |  无\n\n     A：任意时刻所有 $b_i = 1$。\n\n     B：无操作二。\n\n---------------------\n\n**【提示】**\n\n样例二满足A类性质，样例三满足B类性质。", "locale": "zh-CN"}}}
{"pid": "P6216", "type": "P", "difficulty": 5, "samples": [["10 2\nccbccbbcbb bc", "4"], ["20 2\ncbcaacabcbacbbabacca ba\n", "4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["前缀和", "KMP 算法", "Manacher 算法"], "title": "回文匹配", "background": "", "description": "对于一对字符串 $(s_1,s_2)$，若 $s_1$ 的长度为奇数的子串 $[l,r]$ 满足 $[l,r]$ 是回文的，那么 $s_1$ 的“分数”会增加 $s_2$ 在 $[l,r]$ 中出现的次数。\n\n现在给出一对 $(s_1,s_2)$，请计算出 $s_1$ 的“分数”。\n\n答案对 $2 ^ {32}$ 取模。", "inputFormat": "第一行两个整数，$n,m$，表示 $s_1$ 的长度和 $s_2$ 的长度。\n\n第二行两个字符串，$s_1,s_2$。", "outputFormat": "一行一个整数，表示 $s_1$ 的分数。", "hint": "**【样例解释】**\n\n   对于样例一：\n\n   子串 $[1,5]$ 中 $s_2$ 出现了一次，子串 $[2,4]$ 中 $s_2$ 出现了一次。\n\n   子串 $[7,9]$ 中 $s_2$ 出现了一次，子串 $[6,10]$ 中 $s_2$ 出现了一次。\n\n--------------------------------------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- 对于 $100\\%$ 的数据：$1 \\le n,m \\le 3 \\times 10 ^ 6$，字符串中的字符都是小写字母。\n\n- **详细的数据范围：**\n\n  | Subtask 编号 |     $n,m \\le$     | 分值 |\n  | :----------: | :---------------: | :--: |\n  |     $1$      |       $100$       | $15$ |\n  |     $2$      |     $10 ^ 3$      | $15$ |\n  |     $3$      | $5 \\times 10 ^ 3$ | $20$ |\n  |     $4$      | $4 \\times 10 ^ 5$ | $30$ |\n  |     $5$      | $3 \\times 10 ^ 6$ | $20$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "回文匹配", "background": "", "description": "对于一对字符串 $(s_1,s_2)$，若 $s_1$ 的长度为奇数的子串 $[l,r]$ 满足 $[l,r]$ 是回文的，那么 $s_1$ 的“分数”会增加 $s_2$ 在 $[l,r]$ 中出现的次数。\n\n现在给出一对 $(s_1,s_2)$，请计算出 $s_1$ 的“分数”。\n\n答案对 $2 ^ {32}$ 取模。", "inputFormat": "第一行两个整数，$n,m$，表示 $s_1$ 的长度和 $s_2$ 的长度。\n\n第二行两个字符串，$s_1,s_2$。", "outputFormat": "一行一个整数，表示 $s_1$ 的分数。", "hint": "**【样例解释】**\n\n   对于样例一：\n\n   子串 $[1,5]$ 中 $s_2$ 出现了一次，子串 $[2,4]$ 中 $s_2$ 出现了一次。\n\n   子串 $[7,9]$ 中 $s_2$ 出现了一次，子串 $[6,10]$ 中 $s_2$ 出现了一次。\n\n--------------------------------------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- 对于 $100\\%$ 的数据：$1 \\le n,m \\le 3 \\times 10 ^ 6$，字符串中的字符都是小写字母。\n\n- **详细的数据范围：**\n\n  | Subtask 编号 |     $n,m \\le$     | 分值 |\n  | :----------: | :---------------: | :--: |\n  |     $1$      |       $100$       | $15$ |\n  |     $2$      |     $10 ^ 3$      | $15$ |\n  |     $3$      | $5 \\times 10 ^ 3$ | $20$ |\n  |     $4$      | $4 \\times 10 ^ 5$ | $30$ |\n  |     $5$      | $3 \\times 10 ^ 6$ | $20$ |", "locale": "zh-CN"}}}
{"pid": "P6217", "type": "P", "difficulty": 5, "samples": [["5 5\n12 8 9 14 21\n1 5 2\n1 3 3\n3 5 7\n1 5 6\n2 3 7", "1016064\n2592\n18522\n9144576\n3528\n"], ["10 10\n47 47 47 3 7 19 2 7 31 31 \n1 3 53\n4 4 61\n2 8 73\n6 7 53\n1 5 47\n2 5 73\n5 6 71\n7 7 67\n4 7 83\n1 9 59\n", "456856666\n183\n802334105\n106742\n816245119\n365992530\n670453\n134\n871739899\n194416112\n"], ["10 10\n2 13 13 2 3 17 11 19 19 7 \n4 8 1\n1 2 7\n6 7 37\n9 10 7\n1 8 9\n3 8 47\n5 8 2\n3 6 9\n4 5 25\n4 5 8\n", "21318\n1274\n256003\n931\n819082258\n40076077\n170544\n2899962\n3750\n192\n"], ["10 10\n14 39 31 30 3 21 19 17 35 2 \n1 3 10\n6 6 19\n2 4 3\n6 8 18\n1 10 2\n5 6 49\n2 6 8\n7 9 26\n3 6 12\n1 1 10\n", "8463000\n399\n108810\n13186152\n23723126\n21609\n437603581\n198696680\n22498560\n70\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "最大公约数 gcd", "逆元"], "title": "简单数论题", "background": "", "description": "给出一个长度为 $n$ 的序列 $a$，$q$ 次询问 $\\prod_{i=l}^r \\operatorname{lcm}(a_i,x)$ 的值。\n\n答案对 $10 ^ 9 + 7$ 取模。", "inputFormat": "第一行两个整数 $n,q$。\n\n第二行 $n$ 个整数 $a_i$。\n\n接下来 $q$ 行，每行三个整数 $l,r,x$。", "outputFormat": "$q$ 行，一行一个答案。", "hint": "**【样例解释】**\n\n   对于样例一的第二个查询，答案是：\n\n   $\\quad \\operatorname{lcm}(12,3) \\times \\operatorname{lcm}(8,3) \\times \\operatorname{lcm}(9,3)$\n\n   $= 12 \\times 24 \\times 9$\n\n   $= 2592$\n\n------------------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n\n- 对于 $100 \\%$ 的数据：$1 \\le l \\le r \\le n$，$1 \\le n,q,a_i,x \\le 2 \\times 10 ^ 5$。\n\n- **详细的数据范围：**\n\n  | Subtask 编号 | $n,q ,a_i,x\\le $  |              特殊性质               | 分值 |\n  | :---------: | :---------------: | :---------------------------------: | :--: |\n  |     $1$     |       $100$       |                 无                  | $10$ |\n  |     $2$     | $2 \\times 10 ^ 5$ | $a_i,x$ 是质数，任意 $a_i \\neq x$ | $10$ |\n  |     $3$     | $5 \\times 10 ^ 4$ |           $a_i$ 是质数            | $15$ |\n  |     $4$     | $5 \\times 10 ^ 4$ |           $μ(a_i) \\neq 0$           | $15$ |\n  |     $5$     | $5 \\times 10 ^ 4$ |                 无                  | $25$ |\n  |     $6$     | $2 \\times 10 ^ 5$ |                 无                  | $25$ |\n\n-------------------------\n\n**【提示】**\n\n- 样例二满足 Subtask2 的特殊性质，样例三满足 Subtask3 的特殊性质，样例四满足 Subtask4 的特殊性质。\n\n- $μ(x)$ 是莫比乌斯函数，它的定义如下：\n\n    设 $x = {p_1} ^ {q_1} \\times {p_2} ^ {q_2} \\times ... \\times {p_k} ^ {q_k}$。\n\n    $μ(x) =\\begin{cases}1&x=1\\\\(-1) ^ k&q_1,q_2...q_k \\le 1\\\\0&\\text{otherwise}\\end{cases}$ \n\n    注：$p_i$ 为质数，$q_i$ 为正整数。", "locale": "zh-CN", "translations": {"en": {"title": "Simple Number Theory Problem", "background": "", "description": "You are given a sequence $a$ of length $n$. There are $q$ queries asking for the value of $\\prod_{i=l}^r \\operatorname{lcm}(a_i,x)$.\n\nThe answer should be taken modulo $10 ^ 9 + 7$.", "inputFormat": "The first line contains two integers $n,q$.\n\nThe second line contains $n$ integers $a_i$.\n\nThe next $q$ lines each contain three integers $l,r,x$.", "outputFormat": "Output $q$ lines, one answer per line.", "hint": "**[Sample Explanation]**\n\nFor the second query in Sample 1, the answer is:\n\n$\\quad \\operatorname{lcm}(12,3) \\times \\operatorname{lcm}(8,3) \\times \\operatorname{lcm}(9,3)$\n\n$= 12 \\times 24 \\times 9$\n\n$= 2592$.\n\n------------------\n\n**[Constraints]**\n\n**This problem uses bundled testdata.**\n\n- For $100 \\%$ of the testdata: $1 \\le l \\le r \\le n$, $1 \\le n,q,a_i,x \\le 2 \\times 10 ^ 5$.\n\n- **Detailed constraints:**\n\n  | Subtask ID | $n,q ,a_i,x\\le $  |          Special Property           | Score |\n  | :--------: | :---------------: | :---------------------------------: | :---: |\n  |    $1$     |       $100$       |                None                 | $10$  |\n  |    $2$     | $2 \\times 10 ^ 5$ | $a_i,x$ are primes, and any $a_i \\neq x$ | $10$  |\n  |    $3$     | $5 \\times 10 ^ 4$ |            $a_i$ are primes         | $15$  |\n  |    $4$     | $5 \\times 10 ^ 4$ |           $μ(a_i) \\neq 0$           | $15$  |\n  |    $5$     | $5 \\times 10 ^ 4$ |                None                 | $25$  |\n  |    $6$     | $2 \\times 10 ^ 5$ |                None                 | $25$  |\n\n-------------------------\n\n**[Notes]**\n\n- Sample 2 satisfies the special property of Subtask 2, Sample 3 satisfies the special property of Subtask 3, and Sample 4 satisfies the special property of Subtask 4.\n\n- $μ(x)$ is the Möbius function, defined as follows:\n\n    Let $x = {p_1} ^ {q_1} \\times {p_2} ^ {q_2} \\times ... \\times {p_k} ^ {q_k}$.\n\n    $μ(x) =\\begin{cases}1&x=1\\\\(-1) ^ k&q_1,q_2...q_k \\le 1\\\\0&\\text{otherwise}\\end{cases}$.\n\n    Note: $p_i$ are primes, and $q_i$ are positive integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "简单数论题", "background": "", "description": "给出一个长度为 $n$ 的序列 $a$，$q$ 次询问 $\\prod_{i=l}^r \\operatorname{lcm}(a_i,x)$ 的值。\n\n答案对 $10 ^ 9 + 7$ 取模。", "inputFormat": "第一行两个整数 $n,q$。\n\n第二行 $n$ 个整数 $a_i$。\n\n接下来 $q$ 行，每行三个整数 $l,r,x$。", "outputFormat": "$q$ 行，一行一个答案。", "hint": "**【样例解释】**\n\n   对于样例一的第二个查询，答案是：\n\n   $\\quad \\operatorname{lcm}(12,3) \\times \\operatorname{lcm}(8,3) \\times \\operatorname{lcm}(9,3)$\n\n   $= 12 \\times 24 \\times 9$\n\n   $= 2592$\n\n------------------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n\n- 对于 $100 \\%$ 的数据：$1 \\le l \\le r \\le n$，$1 \\le n,q,a_i,x \\le 2 \\times 10 ^ 5$。\n\n- **详细的数据范围：**\n\n  | Subtask 编号 | $n,q ,a_i,x\\le $  |              特殊性质               | 分值 |\n  | :---------: | :---------------: | :---------------------------------: | :--: |\n  |     $1$     |       $100$       |                 无                  | $10$ |\n  |     $2$     | $2 \\times 10 ^ 5$ | $a_i,x$ 是质数，任意 $a_i \\neq x$ | $10$ |\n  |     $3$     | $5 \\times 10 ^ 4$ |           $a_i$ 是质数            | $15$ |\n  |     $4$     | $5 \\times 10 ^ 4$ |           $μ(a_i) \\neq 0$           | $15$ |\n  |     $5$     | $5 \\times 10 ^ 4$ |                 无                  | $25$ |\n  |     $6$     | $2 \\times 10 ^ 5$ |                 无                  | $25$ |\n\n-------------------------\n\n**【提示】**\n\n- 样例二满足 Subtask2 的特殊性质，样例三满足 Subtask3 的特殊性质，样例四满足 Subtask4 的特殊性质。\n\n- $μ(x)$ 是莫比乌斯函数，它的定义如下：\n\n    设 $x = {p_1} ^ {q_1} \\times {p_2} ^ {q_2} \\times ... \\times {p_k} ^ {q_k}$。\n\n    $μ(x) =\\begin{cases}1&x=1\\\\(-1) ^ k&q_1,q_2...q_k \\le 1\\\\0&\\text{otherwise}\\end{cases}$ \n\n    注：$p_i$ 为质数，$q_i$ 为正整数。", "locale": "zh-CN"}}}
{"pid": "P6218", "type": "P", "difficulty": 5, "samples": [["2 12", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2006", "USACO", "数位 DP"], "title": "[USACO06NOV] Round Numbers S", "background": "", "description": "如果一个正整数的二进制表示中，$0$ 的数目不小于 $1$ 的数目，那么它就被称为「圆数」。\n\n例如，$9$ 的二进制表示为 $1001$，其中有 $2$ 个 $0$ 与 $2$ 个 $1$。因此，$9$ 是一个「圆数」。\n\n请你计算，区间 $[l,r]$ 中有多少个「圆数」。", "inputFormat": "一行，两个整数 $l,r$。", "outputFormat": "一行，一个整数，表示区间 $[l,r]$ 中「圆数」的个数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le l,r\\le 2\\times 10^9$。\n\n------------\n\n**【样例说明】**\n\n区间 $[2,12]$ 中共有 $6$ 个「圆数」，分别为 $2,4,8,9,10,12$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06NOV] Round Numbers S", "background": "", "description": "如果一个正整数的二进制表示中，$0$ 的数目不小于 $1$ 的数目，那么它就被称为「圆数」。\n\n例如，$9$ 的二进制表示为 $1001$，其中有 $2$ 个 $0$ 与 $2$ 个 $1$。因此，$9$ 是一个「圆数」。\n\n请你计算，区间 $[l,r]$ 中有多少个「圆数」。", "inputFormat": "一行，两个整数 $l,r$。", "outputFormat": "一行，一个整数，表示区间 $[l,r]$ 中「圆数」的个数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le l,r\\le 2\\times 10^9$。\n\n------------\n\n**【样例说明】**\n\n区间 $[2,12]$ 中共有 $6$ 个「圆数」，分别为 $2,4,8,9,10,12$。", "locale": "zh-CN"}}}
{"pid": "P6219", "type": "P", "difficulty": 7, "samples": [["0", "6 6\n1 4\n1 5\n4 3\n5 3\n3 2\n2 6"], ["1", "1 0"], ["2", "6 8\n1 2\n1 3\n1 4\n1 5\n5 4\n2 6\n3 6\n4 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2019/2020 #6] Konstrukcija", "background": "题目翻译来自 [LOJ3268](https://loj.ac/problem/3268)。", "description": "**译自 [COCI 2019/2020 Contest #6](https://hsin.hr/coci/archive/2019_2020/) T3.** ***[Konstrukcija](https://hsin.hr/coci/archive/2019_2020/contest6_tasks.pdf)***\n\n令 $G$ 为一个有向无环图。若 $G$ 的不同顶点 $c_1,c_2,c_3,\\ldots c_n$ 满足有一条从 $c_1$ 到 $c_2$ 的路径，有一条从 $c_2$ 到 $c_3$ 的路径，……还有一条从 $c_{n-1}$ 到 $c_n$ 的路径，则称数组 $C = (c_1,c_2,c_3,\\ldots c_n)$ 为一个从 $c_1$ 开始，在 $c_n$ 结束的有序数组。  \n注意对于 $C$ 中任意的两个相邻的元素 $c_i,c_{i+1}$ 不必有直接连接的边，只需要有一条路径即可。\n\n同时，我们定义有序数组 $C = (c_1,c_2,c_3,\\ldots c_n)$ 的长度 $\\mathrm{len}(C) = n$。因此，一个有序数组的长度即为其中包含的顶点个数。  \n注意可以存在一个长度为 $1$，从同一个点开始并结束的有序数组。\n\n并且，我们再定义有序数组 $C = (c_1,c_2,c_3,\\ldots c_n)$ 的符号 $\\mathrm{sgn}(C) = (-1)^{\\mathrm{len}(C)+1}$。  \n对于 $G$ 中的顶点 $x,y$，我们用 $S_{x,y}$ 表示所有从 $x$ 开始并在 $y$ 结束的有序数组的集合。\n\n最后，我们定义顶点 $x,y$ 之间的矛盾值为 $\\mathrm{tns}(x,y) = \\sum\\limits_{C \\in S_{x,y}} \\mathrm{sgn}(C)$。  \n也就是说，顶点 $x,y$ 之间的矛盾值等于所有从 $x$ 开始并在 $y$ 结束的有序数组的符号之和。\n\n给定一个整数 $K$，你需要构造一个最多 $1000$ 个点，$1000$ 条边的有向无环图满足 $\\mathrm{tns}(1,N) = K$，其中 $N$ 为顶点个数。  \n顶点以正整数 $1\\ldots N$ 编号。", "inputFormat": "第一行，一个整数 $K$。", "outputFormat": "第一行，两个整数 $N,M$ 表示你构造出的有向无环图的点数与边数。  \n以下 $M$ 行中，第 $i$ 行包含两个不同的整数 $X_i,Y_i$，表示第 $i$ 条边从 $X_i$ 连向 $Y_i$。每条边应最多出现一次。  \n并且，你的方案需要满足任意两点的矛盾值的绝对值不超过 $2^{80}$。  \n若有多解，随意输出一解即可。", "hint": "### 样例 1 解释\n构造出的图包含 $6$ 个顶点。从 $1$ 开始在 $6$ 结束的有序数组有：\n\n- $(1, 6)$；\n- $(1, 4, 6)$；\n- $(1, 5, 6)$；\n- $(1, 3, 6)$；\n- $(1, 2, 6)$；\n- $(1, 4, 3, 6)$；\n- $(1, 4, 2, 6)$；\n- $(1, 5, 3, 6)$；\n- $(1, 5, 2, 6)$；\n- $(1, 3, 2, 6)$；\n- $(1, 4, 3, 2, 6)$；\n- $(1, 5, 3, 2, 6)$。\n  \n它们的长度分别为 $1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4$，  \n所以它们的符号分别为 $-1, 1, 1, 1, 1,-1,-1,-1,-1,-1, 1, 1$。  \n因此，$1$ 和 $6$ 的矛盾值为 $-1 + 1 + 1 + 1 + 1 - 1 - 1 - 1 - 1 - 1 + 1 + 1 = 0$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5k7lbjtc.png)\n\n-----\n\n### 数据范围：\n\n\n对于 $100\\%$ 的数据，$|K| \\le 10^{18}$。  \n各子任务限制见下表：\n\n|子任务|分值|限制|\n|:-:|:-:|:-:|\n|$0$|$0$|为样例|\n|$1$|$13$|$1 \\le K < 500$|\n|$2$|$13$|$-300 < K \\le 1$|\n|$3$|$18$|$\\lvert K\\rvert < 10000$|\n|$4$|$56$|-|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2019/2020 #6] Konstrukcija", "background": "题目翻译来自 [LOJ3268](https://loj.ac/problem/3268)。", "description": "**译自 [COCI 2019/2020 Contest #6](https://hsin.hr/coci/archive/2019_2020/) T3.** ***[Konstrukcija](https://hsin.hr/coci/archive/2019_2020/contest6_tasks.pdf)***\n\n令 $G$ 为一个有向无环图。若 $G$ 的不同顶点 $c_1,c_2,c_3,\\ldots c_n$ 满足有一条从 $c_1$ 到 $c_2$ 的路径，有一条从 $c_2$ 到 $c_3$ 的路径，……还有一条从 $c_{n-1}$ 到 $c_n$ 的路径，则称数组 $C = (c_1,c_2,c_3,\\ldots c_n)$ 为一个从 $c_1$ 开始，在 $c_n$ 结束的有序数组。  \n注意对于 $C$ 中任意的两个相邻的元素 $c_i,c_{i+1}$ 不必有直接连接的边，只需要有一条路径即可。\n\n同时，我们定义有序数组 $C = (c_1,c_2,c_3,\\ldots c_n)$ 的长度 $\\mathrm{len}(C) = n$。因此，一个有序数组的长度即为其中包含的顶点个数。  \n注意可以存在一个长度为 $1$，从同一个点开始并结束的有序数组。\n\n并且，我们再定义有序数组 $C = (c_1,c_2,c_3,\\ldots c_n)$ 的符号 $\\mathrm{sgn}(C) = (-1)^{\\mathrm{len}(C)+1}$。  \n对于 $G$ 中的顶点 $x,y$，我们用 $S_{x,y}$ 表示所有从 $x$ 开始并在 $y$ 结束的有序数组的集合。\n\n最后，我们定义顶点 $x,y$ 之间的矛盾值为 $\\mathrm{tns}(x,y) = \\sum\\limits_{C \\in S_{x,y}} \\mathrm{sgn}(C)$。  \n也就是说，顶点 $x,y$ 之间的矛盾值等于所有从 $x$ 开始并在 $y$ 结束的有序数组的符号之和。\n\n给定一个整数 $K$，你需要构造一个最多 $1000$ 个点，$1000$ 条边的有向无环图满足 $\\mathrm{tns}(1,N) = K$，其中 $N$ 为顶点个数。  \n顶点以正整数 $1\\ldots N$ 编号。", "inputFormat": "第一行，一个整数 $K$。", "outputFormat": "第一行，两个整数 $N,M$ 表示你构造出的有向无环图的点数与边数。  \n以下 $M$ 行中，第 $i$ 行包含两个不同的整数 $X_i,Y_i$，表示第 $i$ 条边从 $X_i$ 连向 $Y_i$。每条边应最多出现一次。  \n并且，你的方案需要满足任意两点的矛盾值的绝对值不超过 $2^{80}$。  \n若有多解，随意输出一解即可。", "hint": "### 样例 1 解释\n构造出的图包含 $6$ 个顶点。从 $1$ 开始在 $6$ 结束的有序数组有：\n\n- $(1, 6)$；\n- $(1, 4, 6)$；\n- $(1, 5, 6)$；\n- $(1, 3, 6)$；\n- $(1, 2, 6)$；\n- $(1, 4, 3, 6)$；\n- $(1, 4, 2, 6)$；\n- $(1, 5, 3, 6)$；\n- $(1, 5, 2, 6)$；\n- $(1, 3, 2, 6)$；\n- $(1, 4, 3, 2, 6)$；\n- $(1, 5, 3, 2, 6)$。\n  \n它们的长度分别为 $1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4$，  \n所以它们的符号分别为 $-1, 1, 1, 1, 1,-1,-1,-1,-1,-1, 1, 1$。  \n因此，$1$ 和 $6$ 的矛盾值为 $-1 + 1 + 1 + 1 + 1 - 1 - 1 - 1 - 1 - 1 + 1 + 1 = 0$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5k7lbjtc.png)\n\n-----\n\n### 数据范围：\n\n\n对于 $100\\%$ 的数据，$|K| \\le 10^{18}$。  \n各子任务限制见下表：\n\n|子任务|分值|限制|\n|:-:|:-:|:-:|\n|$0$|$0$|为样例|\n|$1$|$13$|$1 \\le K < 500$|\n|$2$|$13$|$-300 < K \\le 1$|\n|$3$|$18$|$\\lvert K\\rvert < 10000$|\n|$4$|$56$|-|", "locale": "zh-CN"}}}
{"pid": "P6220", "type": "P", "difficulty": 6, "samples": [["4 5\n11111\n10000\n10000\n10000", "3\n2 1 DESNO\n3 1 DESNO\n4 1 DESNO"], ["6 4\n1111\n1011\n1000\n1011\n1010\n1000", "4\n1 2 DOLJE\n4 4 DOLJE\n5 3 DOLJE\n3 1 DESNO"], ["9 8\n11111111\n10000000\n10001000\n10010001\n11100001\n10100110\n10001000\n10100001\n10010001", "14\n5 2 DOLJE\n5 8 DOLJE\n8 3 DOLJE\n2 1 DESNO\n3 1 DESNO\n3 5 DESNO\n4 1 DESNO\n4 4 DESNO\n5 3 DESNO\n6 3 DESNO\n7 1 DESNO\n7 5 DESNO\n8 3 DESNO\n9 4 DESNO"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "网络流", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2019/2020 #6] Skandi", "background": "题目翻译来自 [LOJ3269](https://loj.ac/problem/3269) 。\n\n\n**由于洛谷评测机原因，数据有删改。**", "description": "**译自 [COCI 2019/2020 Contest #6](https://hsin.hr/coci/archive/2019_2020/) T4.** ***[Skandi](https://hsin.hr/coci/archive/2019_2020/contest6_tasks.pdf)***\n\nDragica 不仅是当地的一个半专业保龄球队的队长，还是一位充满激情的厨师。除此之外，他还是克罗地亚数一数二的填字游戏（crossword）玩家。填字游戏是一个在 $N\\times M$ 的网格上游玩的游戏。在游戏开始前，部分格子已经填上了字母，作为至多两题的起点，而玩家需要根据给出的提示以水平向右或竖直向下的方向在剩下的格子填上答案。在这里，一题的答案定义为从该题起点沿提示指定方向直至网格边界或另一题起点之前的部分。如果一题的起点右边一格是空的，则该题在水平方向上存在一题；类似的，如果一题的下面一格是空的，则该题在竖直方向上存在一题。\n\nDragica 当然知道答案啦，但他有点鸽，想让你帮他找出完成某个填字游戏最少回答的题目数。", "inputFormat": "第一行两个空格分隔的整数 $N,~M$，含意见题目描述。\n\n接下来 $N$ 行每行 $M$ 个字符 `0` 或 `1`，其中 `0` 表示这是个待填充答案的空格，而 `1` 表示该格已填有字符，是至多两题的起点。保证输入存在至少一个 `0` ，且第一行和第一列均为 `1`。", "outputFormat": "第一行输出完成该次填字游戏的最小答案数 $X$。\n\n接下来 $X$ 行每行以 `r c dir` 的格式回答一个问题，其中 `r` 表示题目的行号，`c` 表示题目的列号，`dir` 为 `DESNO` （克罗地亚语中的右）和 `DOLJE` （克罗地亚语中的下）之一，表示 Dragica 回答问题的方向。\n\n如果有多解，输出任意一个。", "hint": "#### 样例 $3$ 解释：\n下图展示了样例中的填词游戏，其中黑色的格子表示开始时已经填了字符的格子，在图下方所示的表中你可以看到给出的横着填和竖着填的提示。注意，已经填了字符的格子可以是零题、一题（例如第 $8$ 和 $13$ 题）或两题（例如第 $10$ 和 $12$）题的起点。要解出它，你至少需要知道 $14$ 题的答案，试试看看你会吗？~~（疑问语气）~~\n\n*译者注：以下图片经过高清重制。中文的 crossword 没啥意义，就不翻译了。*\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d7w61uk7.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4spl87ov.png)\n\n-----\n\n\n#### 数据范围：\n\n对于 $100\\%$ 的数据，有 $2\\le N,~M\\le 500$。\n\n各子任务限制见下表：\n\n|子任务|分值|特殊限制|\n|:-:|:-:|:-:|\n|1|16|至多 $9$ 个格子开始前填了字符|\n|2|30|$N\\le 500,~M\\le 10$|\n|3|54|无特殊限制|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2019/2020 #6] Skandi", "background": "题目翻译来自 [LOJ3269](https://loj.ac/problem/3269) 。\n\n\n**由于洛谷评测机原因，数据有删改。**", "description": "**译自 [COCI 2019/2020 Contest #6](https://hsin.hr/coci/archive/2019_2020/) T4.** ***[Skandi](https://hsin.hr/coci/archive/2019_2020/contest6_tasks.pdf)***\n\nDragica 不仅是当地的一个半专业保龄球队的队长，还是一位充满激情的厨师。除此之外，他还是克罗地亚数一数二的填字游戏（crossword）玩家。填字游戏是一个在 $N\\times M$ 的网格上游玩的游戏。在游戏开始前，部分格子已经填上了字母，作为至多两题的起点，而玩家需要根据给出的提示以水平向右或竖直向下的方向在剩下的格子填上答案。在这里，一题的答案定义为从该题起点沿提示指定方向直至网格边界或另一题起点之前的部分。如果一题的起点右边一格是空的，则该题在水平方向上存在一题；类似的，如果一题的下面一格是空的，则该题在竖直方向上存在一题。\n\nDragica 当然知道答案啦，但他有点鸽，想让你帮他找出完成某个填字游戏最少回答的题目数。", "inputFormat": "第一行两个空格分隔的整数 $N,~M$，含意见题目描述。\n\n接下来 $N$ 行每行 $M$ 个字符 `0` 或 `1`，其中 `0` 表示这是个待填充答案的空格，而 `1` 表示该格已填有字符，是至多两题的起点。保证输入存在至少一个 `0` ，且第一行和第一列均为 `1`。", "outputFormat": "第一行输出完成该次填字游戏的最小答案数 $X$。\n\n接下来 $X$ 行每行以 `r c dir` 的格式回答一个问题，其中 `r` 表示题目的行号，`c` 表示题目的列号，`dir` 为 `DESNO` （克罗地亚语中的右）和 `DOLJE` （克罗地亚语中的下）之一，表示 Dragica 回答问题的方向。\n\n如果有多解，输出任意一个。", "hint": "#### 样例 $3$ 解释：\n下图展示了样例中的填词游戏，其中黑色的格子表示开始时已经填了字符的格子，在图下方所示的表中你可以看到给出的横着填和竖着填的提示。注意，已经填了字符的格子可以是零题、一题（例如第 $8$ 和 $13$ 题）或两题（例如第 $10$ 和 $12$）题的起点。要解出它，你至少需要知道 $14$ 题的答案，试试看看你会吗？~~（疑问语气）~~\n\n*译者注：以下图片经过高清重制。中文的 crossword 没啥意义，就不翻译了。*\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d7w61uk7.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4spl87ov.png)\n\n-----\n\n\n#### 数据范围：\n\n对于 $100\\%$ 的数据，有 $2\\le N,~M\\le 500$。\n\n各子任务限制见下表：\n\n|子任务|分值|特殊限制|\n|:-:|:-:|:-:|\n|1|16|至多 $9$ 个格子开始前填了字符|\n|2|30|$N\\le 500,~M\\le 10$|\n|3|54|无特殊限制|", "locale": "zh-CN"}}}
{"pid": "P6221", "type": "P", "difficulty": 4, "samples": [["3 2\na b\nab bd\nabc abd", "5"], ["3 3\na b c\naa ab ac\naaa aab aca", "6"], ["3 1\na\nbc\ndef", "0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "COCI（克罗地亚）"], "title": "[COCI 2019/2020 #6] Trener", "background": "题目翻译来自 [LOJ3270](https://loj.ac/problem/3270)。", "description": "**译自 [COCI 2019/2020 Contest #6](https://hsin.hr/coci/archive/2019_2020/) T5.** ***[Trener](https://hsin.hr/coci/archive/2019_2020/contest6_tasks.pdf)***\n\n我们已经知道了学生们喜欢睡觉。Patrik 是这一记录的保持者。在最后一个梦中，他发现自己成为了他最喜欢的球队的队长。\n\n为了参加一场比赛，他把自己的所有球员分为 $N$ 组，每组 $K$ 名球员，对于第 $i$ 组的球员，他们的姓氏长度都为 $i$。\n\n现在，他要开始规划上场的球员组合了。一个组合有 $N$ 名球员，并且组委会对上场的球队还有有以下要求：\n\n- 所有球员的姓氏长度必须不同。\n\n- 所有球员的姓氏必须为其他姓氏比他长一个字符的球员的连续子序列。\n\nPatrik 想知道，自己最多能把这些球员分为多少支可以上场的队伍。答案对 $10^9+7$ 取模。", "inputFormat": "输入第一行为两个整数 $N,K$。\n\n接下来的 $N$ 行，每行 $K$ 个字符串，为球员的姓氏，保证第 $i$ 行的字符串长度为 $i$。", "outputFormat": "输出一行一个整数为最多分出的队伍支数，答案对 $10^9+7$ 取模。", "hint": "#### 样例 $1$ 说明：\n可以分为如下队伍：\n\n`(a, ab, abc), (a, ab,abd), (b, ab, abc), (b, ab, abd), (b, bd, abd)`。\n\n----\n\n#### 数据范围：\n\n对于 $100\\%$ 的数据，$1\\le N\\le 50$，$1\\leq K\\leq 1500$。\n\n|任务编号|特殊限制|分值|\n|:-:|:-:|:-:|\n|$0$|为样例|$0$|\n|$1$|$N=5,K=10$|$20$|\n|$2$|$N=50,K=100$|$30$|\n|$3$|无特殊限制。|$50$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2019/2020 #6] Trener", "background": "题目翻译来自 [LOJ3270](https://loj.ac/problem/3270)。", "description": "**译自 [COCI 2019/2020 Contest #6](https://hsin.hr/coci/archive/2019_2020/) T5.** ***[Trener](https://hsin.hr/coci/archive/2019_2020/contest6_tasks.pdf)***\n\n我们已经知道了学生们喜欢睡觉。Patrik 是这一记录的保持者。在最后一个梦中，他发现自己成为了他最喜欢的球队的队长。\n\n为了参加一场比赛，他把自己的所有球员分为 $N$ 组，每组 $K$ 名球员，对于第 $i$ 组的球员，他们的姓氏长度都为 $i$。\n\n现在，他要开始规划上场的球员组合了。一个组合有 $N$ 名球员，并且组委会对上场的球队还有有以下要求：\n\n- 所有球员的姓氏长度必须不同。\n\n- 所有球员的姓氏必须为其他姓氏比他长一个字符的球员的连续子序列。\n\nPatrik 想知道，自己最多能把这些球员分为多少支可以上场的队伍。答案对 $10^9+7$ 取模。", "inputFormat": "输入第一行为两个整数 $N,K$。\n\n接下来的 $N$ 行，每行 $K$ 个字符串，为球员的姓氏，保证第 $i$ 行的字符串长度为 $i$。", "outputFormat": "输出一行一个整数为最多分出的队伍支数，答案对 $10^9+7$ 取模。", "hint": "#### 样例 $1$ 说明：\n可以分为如下队伍：\n\n`(a, ab, abc), (a, ab,abd), (b, ab, abc), (b, ab, abd), (b, bd, abd)`。\n\n----\n\n#### 数据范围：\n\n对于 $100\\%$ 的数据，$1\\le N\\le 50$，$1\\leq K\\leq 1500$。\n\n|任务编号|特殊限制|分值|\n|:-:|:-:|:-:|\n|$0$|为样例|$0$|\n|$1$|$N=5,K=10$|$20$|\n|$2$|$N=50,K=100$|$30$|\n|$3$|无特殊限制。|$50$|", "locale": "zh-CN"}}}
{"pid": "P6222", "type": "P", "difficulty": 6, "samples": [["4 1919 5\n1\n14\n51\n4\n", "32\n1012884514\n62017882\n105160\n"]], "limits": {"time": [500, 500, 500, 500, 1500], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "O2优化", "莫比乌斯反演"], "title": "「P6156 简单题」加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P6156)\n\n此题在原题基础上，加上了多测，更改了模数，同时为了彻底卡掉非线性预处理，开大了数据范围。\n\n可能有点卡常。", "description": "$T$ 组询问。一开始给定一个常数 $K$。每次询问单独给定 $n$。请你求出：\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n} (i+j)^K \\gcd(i,j) \\mu^2(\\gcd(i,j)) \\pmod {2^{32}}$$", "inputFormat": "第一行三个正整数 $T,N,K$，分别表示询问组数、询问的 $N$ 的最大值、以及给定的常量。\n\n接下来 $T$ 行，每行一个正整数表示这组询问的 $n$ 是多少。", "outputFormat": "$T$ 行，每行一个非负整数，表示询问当前给定的 $n$，题面的式子计算出的结果是多少。", "hint": "一共有 $5$ 组测试点。第 $i$ 组测试点满足：$N=10^{i+2}$。\n\n对于所有测试点，满足：$T = 10^4$，$1 \\leq K < 2^{31}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「P6156 简单题」加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P6156)\n\n此题在原题基础上，加上了多测，更改了模数，同时为了彻底卡掉非线性预处理，开大了数据范围。\n\n可能有点卡常。", "description": "$T$ 组询问。一开始给定一个常数 $K$。每次询问单独给定 $n$。请你求出：\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n} (i+j)^K \\gcd(i,j) \\mu^2(\\gcd(i,j)) \\pmod {2^{32}}$$", "inputFormat": "第一行三个正整数 $T,N,K$，分别表示询问组数、询问的 $N$ 的最大值、以及给定的常量。\n\n接下来 $T$ 行，每行一个正整数表示这组询问的 $n$ 是多少。", "outputFormat": "$T$ 行，每行一个非负整数，表示询问当前给定的 $n$，题面的式子计算出的结果是多少。", "hint": "一共有 $5$ 组测试点。第 $i$ 组测试点满足：$N=10^{i+2}$。\n\n对于所有测试点，满足：$T = 10^4$，$1 \\leq K < 2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P6223", "type": "P", "difficulty": 5, "samples": [["6\n15\n10 20 18 16 6 16\n1 4\n4 5\n4 6\n6 2\n5 3\n", "5\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[CHCI 2009 Final Exam #1] PODJELA", "background": null, "description": "有 $n$ 个农民，他们住在 $n$ 个不同的村子里，这 $n$ 个村子形成一棵树，每个农民初始时有 $x$ 元钱。\n\n每一次操作，一个农民可以从它自己的钱中，取出任意数量的钱，交给某个相邻村子的农民。\n\n对于每个农民给定一个值 $v_i$，求最少需要多少次操作，使得每个农民最终拿到的钱 $\\ge$ 给定的值。", "inputFormat": "第一行包含一个整数 $n$，即农民数。\n\n第二行包含一个整数 $x$，即每个农民初始时拥有的钱数。\n\n第三行包含 $n$ 个整数，第 $i$ 个数表示 $v_i$。\n\n接下来 $n-1$ 行每行包含两个整数，表示树上的一条边。", "outputFormat": "输出一行一个整数，即最少需要的操作次数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n\\le 2000$，$0\\le x\\le 10000$，$\\sum\\limits_{i=1}^n v_i\\le n\\times x$。\n\n#### 说明\n\n翻译自 [Croatian Highschool Competitions In Informatics 2009 Final Exam #1 T2 PODJELA](https://hsin.hr/2009/final/first_day/tasks.pdf)。", "locale": "zh-CN", "translations": {"en": {"title": "[CHCI 2009 Final Exam #1] PODJELA", "background": "", "description": "There are $n$ farmers living in $n$ different villages. These $n$ villages form a tree. Initially, each farmer has $x$ dollars.\n\nIn one operation, a farmer may take any amount of money from their own money and give it to a farmer in an adjacent village.\n\nFor each farmer, a value $v_i$ is given. Find the minimum number of operations needed so that in the end every farmer has money $\\ge$ the given value.", "inputFormat": "The first line contains an integer $n$, the number of farmers.\n\nThe second line contains an integer $x$, the amount of money each farmer initially has.\n\nThe third line contains $n$ integers, where the $i$-th number is $v_i$.\n\nThe next $n - 1$ lines each contain two integers, representing an edge of the tree.", "outputFormat": "Output one line with one integer, the minimum number of operations required.", "hint": "#### Constraints\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 2000$, $0 \\le x \\le 10000$, $\\sum\\limits_{i=1}^n v_i \\le n \\times x$.\n\n#### Notes\n\nTranslated from [Croatian Highschool Competitions In Informatics 2009 Final Exam #1 T2 PODJELA](https://hsin.hr/2009/final/first_day/tasks.pdf)。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CHCI 2009 Final Exam #1] PODJELA", "background": null, "description": "有 $n$ 个农民，他们住在 $n$ 个不同的村子里，这 $n$ 个村子形成一棵树，每个农民初始时有 $x$ 元钱。\n\n每一次操作，一个农民可以从它自己的钱中，取出任意数量的钱，交给某个相邻村子的农民。\n\n对于每个农民给定一个值 $v_i$，求最少需要多少次操作，使得每个农民最终拿到的钱 $\\ge$ 给定的值。", "inputFormat": "第一行包含一个整数 $n$，即农民数。\n\n第二行包含一个整数 $x$，即每个农民初始时拥有的钱数。\n\n第三行包含 $n$ 个整数，第 $i$ 个数表示 $v_i$。\n\n接下来 $n-1$ 行每行包含两个整数，表示树上的一条边。", "outputFormat": "输出一行一个整数，即最少需要的操作次数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n\\le 2000$，$0\\le x\\le 10000$，$\\sum\\limits_{i=1}^n v_i\\le n\\times x$。\n\n#### 说明\n\n翻译自 [Croatian Highschool Competitions In Informatics 2009 Final Exam #1 T2 PODJELA](https://hsin.hr/2009/final/first_day/tasks.pdf)。", "locale": "zh-CN"}}}
{"pid": "P6224", "type": "P", "difficulty": 6, "samples": [["3\n7 5\n6 2\n3 1\n5\n1 6 1\n1 5 5\n2 7 1\n0 3 2\n1 1 0", "1\n2\n4\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2014", "树状数组", "北京", "cdq 分治", "K-D Tree"], "title": "[BJWC2014] 数据", "background": "", "description": "为了写论文，```Alex``` 经常要整理大量的数据。这一次，```Alex``` 面临一个严峻的考验：他需要实现一个数据结构来维护一个点集。\n\n现在，二维平面上有 $N$ 个点。\n\n```Alex``` 需要实现以下三种操作：\n\n1. 在点集里添加一个点；\n\n2. 给出一个点，查询它到点集里所有点的曼哈顿距离的最小值；\n\n3. 给出一个点，查询它到点集里所有点的曼哈顿距离的最大值。\n\n两个点的曼哈顿距离定义为它们的横坐标差的绝对值与纵坐标差的绝对值的和。\n\n这么困难的问题，```Alex``` 当然不会做，只好再次请你帮忙了。", "inputFormat": "第一行包含一个整数 $N$，表示点集最初的点数。\n\n接下来 $N$ 行，每行两个整数，依次表示每个点的横坐标和纵坐标。\n\n第 $N+2$ 行包含一个整数 $Q$，表示询问的数目。\n\n接下来 $Q$ 行，每行三个整数，依次表示询问的类型，点的横坐标和纵坐标。$0$ 类型表示添加一个点，$1$ 类型表示查询到该点的曼哈顿距离的最小值，$2$ 类型表示查询最大值。", "outputFormat": "输出若干行，依次表示每个查询操作的答案。", "hint": "对于前 $20 \\%$ 的数据：$1\\le N , Q\\le 10^3$\n\n对于前 $100 \\%$ 的数据： $1\\le N , Q \\le 10^5$；\n\n点的坐标是不超过 $10^9$ 的非负整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BJWC2014] 数据", "background": "", "description": "为了写论文，```Alex``` 经常要整理大量的数据。这一次，```Alex``` 面临一个严峻的考验：他需要实现一个数据结构来维护一个点集。\n\n现在，二维平面上有 $N$ 个点。\n\n```Alex``` 需要实现以下三种操作：\n\n1. 在点集里添加一个点；\n\n2. 给出一个点，查询它到点集里所有点的曼哈顿距离的最小值；\n\n3. 给出一个点，查询它到点集里所有点的曼哈顿距离的最大值。\n\n两个点的曼哈顿距离定义为它们的横坐标差的绝对值与纵坐标差的绝对值的和。\n\n这么困难的问题，```Alex``` 当然不会做，只好再次请你帮忙了。", "inputFormat": "第一行包含一个整数 $N$，表示点集最初的点数。\n\n接下来 $N$ 行，每行两个整数，依次表示每个点的横坐标和纵坐标。\n\n第 $N+2$ 行包含一个整数 $Q$，表示询问的数目。\n\n接下来 $Q$ 行，每行三个整数，依次表示询问的类型，点的横坐标和纵坐标。$0$ 类型表示添加一个点，$1$ 类型表示查询到该点的曼哈顿距离的最小值，$2$ 类型表示查询最大值。", "outputFormat": "输出若干行，依次表示每个查询操作的答案。", "hint": "对于前 $20 \\%$ 的数据：$1\\le N , Q\\le 10^3$\n\n对于前 $100 \\%$ 的数据： $1\\le N , Q \\le 10^5$；\n\n点的坐标是不超过 $10^9$ 的非负整数。", "locale": "zh-CN"}}}
{"pid": "P6225", "type": "P", "difficulty": 4, "samples": [["3 3\n1 2 3\n2 1 3\n1 1 3\n2 1 3", "2\n0"], ["5 6\n1 2 3 4 5\n2 1 3\n1 1 3\n2 1 5\n2 4 4\n1 1 1\n2 4 4", "2\n5\n4\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2019", "树状数组", "eJOI（欧洲）", "位运算"], "title": "[eJOI 2019] 异或橙子", "background": "", "description": "Janez 喜欢橙子！他制造了一个橙子扫描仪，但是这个扫描仪对于扫描的每个橙子的图像只能输出一个  $32$ 位整数。\n\n他一共扫描了 $n$ 个橙子，但有时他也会重新扫描一个橙子，导致这个橙子的 $32$ 位整数发生更新。\n\nJanez 想要分析这些橙子，他觉得异或操作非常有趣，他每次选取一个区间从 $l$  至 $u$，他想要得到这个区间内所有子区间的异或和的异或和。\n\n例如 $l=2,u=4$ 的情况，记橙子序列 $A$ 中第 $i$ 个橙子的整数是 $a_i$，那么他要求的就是：\n\n$$a_2 \\oplus a_3 \\oplus a_4 \\oplus (a_2\\oplus a_3)\\oplus(a_3\\oplus a_4)\\oplus(a_2\\oplus a_3 \\oplus a_4)$$\n\n-------------------------------------\n\n注：式子中的 $\\oplus$ 代表按位异或运算。异或的运算规则如下。\n\n对于两个数的第 $i$ 位，记为 $x,y$，那么：\n\n|$x$|$y$|$x\\oplus y$|\n| :-----------: | :-----------: | :-----------: |\n|$0$|$1$|$1$|\n|$1$|$0$|$1$|\n|$0$|$0$|$0$|\n|$1$|$1$|$0$|\n\n例：$13\\oplus 23=26$\n\n|$13=$|$0\\cdots 001101$|\n| --------: | :------: |\n|$23=$|$0\\cdots 010111$|\n|$13\\oplus 23=$|$0\\cdots 011010$|", "inputFormat": "第一行输入两个正整数 $n,q$，表示橙子数量和操作次数。\n\n接下来一行 $n$ 个非负整数，表示每个橙子扫描得到的数值 ，从 $1$ 开始编号。\n\n接下来 $q$ 行，每行三个数：\n\n- 如果第一个数是 $1$，接下来输入一个正整数 $i$ 与非负整数 $j$，表示将第 $i$ 个橙子的扫描值 $a_i$ 修改为 $j$。\n\n- 如果第一个数是 $2$，接下来输入两个正整数 $u,l$ 表示询问这个区间的答案。", "outputFormat": "对于每组询问，输出一行一个非负整数，表示所求的总异或和。", "hint": "#### 输入输出样例 1 解释\n\n- 最初，$A=[1,2,3]$，询问结果为 $1\\oplus 2\\oplus 3\\oplus(1\\oplus 2)\\oplus (2\\oplus 3)\\oplus(1\\oplus 2\\oplus 3)=2$\n\n- 修改后，第一个位置被修改为 $3$ ，询问的结果是 $3\\oplus 2\\oplus 3\\oplus(3\\oplus 2)\\oplus (2\\oplus 3)\\oplus(3\\oplus 2\\oplus 3)=0$。\n\n----------------------------\n\n#### 数据规模与约定：\n\n**本题采用多测试点捆绑测试，共有 5 个子任务**。\n\n- Subtask 1(12 points)：$1\\le n,q\\le 10^2$，无特殊限制\n- Subtask 2(18 points)：$1\\le n,q\\le 5\\times 10^2$，且没有修改操作。\n- Subtask 3(25 points)：$1\\le n,q\\le 5\\times 10^3$，无特殊限制\n- Subtask 4(20 points)：$1\\le n,q\\le 2\\times 10^5$，且没有修改操作。\n- Subtask 5(25 points)：$1\\le n,q\\le 2\\times 10^5$，无特殊限制\n\n对于所有数据，$0\\le a_i\\le 10^9,1\\le n,q\\le 2\\times 10^5$\n\n--------------------------\n\n#### 说明\n\n原题来自：[eJOI2019](http://ejoi2019.si/) Problem A. [XORanges](https://www.ejoi2019.si/static/media/uploads/tasks/xoranges-isc(1).pdf)\n\n题面&数据来自：[LibreOJ](https://loj.ac/problem/3195)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2019] 异或橙子", "background": "", "description": "Janez 喜欢橙子！他制造了一个橙子扫描仪，但是这个扫描仪对于扫描的每个橙子的图像只能输出一个  $32$ 位整数。\n\n他一共扫描了 $n$ 个橙子，但有时他也会重新扫描一个橙子，导致这个橙子的 $32$ 位整数发生更新。\n\nJanez 想要分析这些橙子，他觉得异或操作非常有趣，他每次选取一个区间从 $l$  至 $u$，他想要得到这个区间内所有子区间的异或和的异或和。\n\n例如 $l=2,u=4$ 的情况，记橙子序列 $A$ 中第 $i$ 个橙子的整数是 $a_i$，那么他要求的就是：\n\n$$a_2 \\oplus a_3 \\oplus a_4 \\oplus (a_2\\oplus a_3)\\oplus(a_3\\oplus a_4)\\oplus(a_2\\oplus a_3 \\oplus a_4)$$\n\n-------------------------------------\n\n注：式子中的 $\\oplus$ 代表按位异或运算。异或的运算规则如下。\n\n对于两个数的第 $i$ 位，记为 $x,y$，那么：\n\n|$x$|$y$|$x\\oplus y$|\n| :-----------: | :-----------: | :-----------: |\n|$0$|$1$|$1$|\n|$1$|$0$|$1$|\n|$0$|$0$|$0$|\n|$1$|$1$|$0$|\n\n例：$13\\oplus 23=26$\n\n|$13=$|$0\\cdots 001101$|\n| --------: | :------: |\n|$23=$|$0\\cdots 010111$|\n|$13\\oplus 23=$|$0\\cdots 011010$|", "inputFormat": "第一行输入两个正整数 $n,q$，表示橙子数量和操作次数。\n\n接下来一行 $n$ 个非负整数，表示每个橙子扫描得到的数值 ，从 $1$ 开始编号。\n\n接下来 $q$ 行，每行三个数：\n\n- 如果第一个数是 $1$，接下来输入一个正整数 $i$ 与非负整数 $j$，表示将第 $i$ 个橙子的扫描值 $a_i$ 修改为 $j$。\n\n- 如果第一个数是 $2$，接下来输入两个正整数 $u,l$ 表示询问这个区间的答案。", "outputFormat": "对于每组询问，输出一行一个非负整数，表示所求的总异或和。", "hint": "#### 输入输出样例 1 解释\n\n- 最初，$A=[1,2,3]$，询问结果为 $1\\oplus 2\\oplus 3\\oplus(1\\oplus 2)\\oplus (2\\oplus 3)\\oplus(1\\oplus 2\\oplus 3)=2$\n\n- 修改后，第一个位置被修改为 $3$ ，询问的结果是 $3\\oplus 2\\oplus 3\\oplus(3\\oplus 2)\\oplus (2\\oplus 3)\\oplus(3\\oplus 2\\oplus 3)=0$。\n\n----------------------------\n\n#### 数据规模与约定：\n\n**本题采用多测试点捆绑测试，共有 5 个子任务**。\n\n- Subtask 1(12 points)：$1\\le n,q\\le 10^2$，无特殊限制\n- Subtask 2(18 points)：$1\\le n,q\\le 5\\times 10^2$，且没有修改操作。\n- Subtask 3(25 points)：$1\\le n,q\\le 5\\times 10^3$，无特殊限制\n- Subtask 4(20 points)：$1\\le n,q\\le 2\\times 10^5$，且没有修改操作。\n- Subtask 5(25 points)：$1\\le n,q\\le 2\\times 10^5$，无特殊限制\n\n对于所有数据，$0\\le a_i\\le 10^9,1\\le n,q\\le 2\\times 10^5$\n\n--------------------------\n\n#### 说明\n\n原题来自：[eJOI2019](http://ejoi2019.si/) Problem A. [XORanges](https://www.ejoi2019.si/static/media/uploads/tasks/xoranges-isc(1).pdf)\n\n题面&数据来自：[LibreOJ](https://loj.ac/problem/3195)", "locale": "zh-CN"}}}
{"pid": "P6226", "type": "P", "difficulty": 5, "samples": [["5 9 7\n...##....\n..#.##..#\n..#....##\n.##...#..\n....#....\nWS?EE??", "22"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2019", "BalticOI（波罗的海）", "bitset"], "title": "[BalticOI 2019] 潜艇 / Nautilus", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day1 T2.** ***[Nautilus](http://boi2019.eio.ee/wp-content/uploads/2019/04/nautilus.en_.pdf)***", "description": "有一艘潜艇正在海洋中秘密航行。\n\n海洋是一个 $R \\times C$ 的网格，其中 `#` 代表岛屿，`.` 代表水域，潜艇只能在水域中航行。\n\n每分钟，潜艇会发出一个无线电信号，代表潜艇要航行的方向。方向由如下字母表示：北（N），东（E），南（S），西（W）。\n\n现在监听者已经架设了一台拦截潜艇信号的雷达。在最近的 $M$ 分钟，雷达收集到了 $M$ 个信号，由一个长度为 $M$ 的字符串表示，例如 `WS?EE??`。收集到的信号有些无法解码，用 `?` 表示。\n\n监听者并不知道潜艇最初的位置，但想要借助地图计算出潜艇的当前位置。请你帮助监听者计算出潜艇当前可能的位置共有几种。", "inputFormat": "输入第一行包含三个整数 $R,C,M$。\n\n接下来 $R$ 行，每行 $C$ 个字符，描述海域地图。\n\n最后一行是一个长度为 $M$ 的字符串，代表了监听者监听到的信号。保证字符串中只含有 `N`，`E`，`S`，`W`，`?` 这几种字符。", "outputFormat": "输出一个整数：潜艇当前可能的位置有几种。", "hint": "各子任务的分值与数据规模如下：\n\n- 子任务 1（29 分）：$1 \\leq R,C,M \\leq 100$，监听到的信号中没有 `?`。\n- 子任务 2（37 分）：$1 \\leq R,C,M \\leq 100$。\n- 子任务 3（34 分）：$1 \\leq R,C \\leq 500$，$1 \\leq M \\leq 5000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2019] 潜艇 / Nautilus", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day1 T2.** ***[Nautilus](http://boi2019.eio.ee/wp-content/uploads/2019/04/nautilus.en_.pdf)***", "description": "有一艘潜艇正在海洋中秘密航行。\n\n海洋是一个 $R \\times C$ 的网格，其中 `#` 代表岛屿，`.` 代表水域，潜艇只能在水域中航行。\n\n每分钟，潜艇会发出一个无线电信号，代表潜艇要航行的方向。方向由如下字母表示：北（N），东（E），南（S），西（W）。\n\n现在监听者已经架设了一台拦截潜艇信号的雷达。在最近的 $M$ 分钟，雷达收集到了 $M$ 个信号，由一个长度为 $M$ 的字符串表示，例如 `WS?EE??`。收集到的信号有些无法解码，用 `?` 表示。\n\n监听者并不知道潜艇最初的位置，但想要借助地图计算出潜艇的当前位置。请你帮助监听者计算出潜艇当前可能的位置共有几种。", "inputFormat": "输入第一行包含三个整数 $R,C,M$。\n\n接下来 $R$ 行，每行 $C$ 个字符，描述海域地图。\n\n最后一行是一个长度为 $M$ 的字符串，代表了监听者监听到的信号。保证字符串中只含有 `N`，`E`，`S`，`W`，`?` 这几种字符。", "outputFormat": "输出一个整数：潜艇当前可能的位置有几种。", "hint": "各子任务的分值与数据规模如下：\n\n- 子任务 1（29 分）：$1 \\leq R,C,M \\leq 100$，监听到的信号中没有 `?`。\n- 子任务 2（37 分）：$1 \\leq R,C,M \\leq 100$。\n- 子任务 3（34 分）：$1 \\leq R,C \\leq 500$，$1 \\leq M \\leq 5000$。", "locale": "zh-CN"}}}
{"pid": "P6227", "type": "P", "difficulty": 5, "samples": [["5 2 3 1\n1 2 3\n1 3 2\n3 4 1\n3 5 2\n2\n4\n2 2\n2 5\n4 5", "escaped\n3\noo"], ["10 2 5 4\n7 2 3\n4 8 3\n9 10 1\n6 7 3\n9 2 3\n10 1 2\n8 2 2\n5 2 1\n3 8 2\n8\n7\n2 1\n1 5\n8 4\n6 2\n7 7", "8\nescaped\nescaped\nescaped\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "BalticOI（波罗的海）"], "title": "[BalticOI 2019] 山谷 (Day1)", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day1 T3.** ***[Alpine valley](http://boi2019.eio.ee/wp-content/uploads/2019/04/valley.en_.pdf)***", "description": "在阿尔卑斯山谷中，有 $N$ 个村庄，编号为 $1 \\ldots N$，这些村庄通过 $N-1$ 条边连接起来，形成了一个树型结构。\n\n虽然任意两个村庄间都能相互抵达，但路途花费的时间可能令人难以接受，尤其是当你想要购买一些生活必需品的时候——因为所有村庄中，只有其中 $S$ 个村庄有商店。\n\n今年冬天，由于大雪的原因，情况变得更糟。因此，你需要到达 $E$ 号村庄——那里有连接山区和外界的唯一通道，亦或是在山谷中的商店里购买足够接下来几个月生活的物资。今天早上，你在收音机里听到了所有道路中有一条道路无法通行的消息，但是你并不知道具体是哪一条道路。\n\n你现在想知道你和你的朋友是否可以离开山谷，如果不能离开，则需要知道你们离最近商店的距离。由于你还不知道哪条道路无法通行，并且你的朋友们居住在不同的村庄，因此你需要回答 $Q$ 组询问，每组询问给出一条被封锁的道路和你朋友所在村庄的位置。", "inputFormat": "输入第一行包含四个整数 $N,S,Q,E$。其中 $N$ 代表村庄数目，$S$ 代表有商店的村庄的数目，$Q$ 代表你需要回答的询问数，$E$ 代表连接山区和外界的村庄的编号。\n\n接下来 $N-1$ 行，每行包含三个整数 $A,B,W$，代表村庄 $A$ 与村庄 $B$ 之间有一条长度为 $W$ 的道路。\n\n接下来 $S$ 行，每行包含一个整数 $C$，代表 $C$ 号村庄有一个商店。数据保证同一个村庄最多只有一个商店。\n\n最后 $Q$ 行，每行两个整数 $I,R$，询问当 $I$ 号道路（按输入顺序编号）无法通行时，从 $R$ 号村庄出发能否离开山谷，如果不能，则询问其离最近商店的距离。", "outputFormat": "输出包含 $Q$ 行，第 $i$ 行输出第 $i$ 组询问的答案。更具体地说，如果能离开山谷，输出 `escaped`；如果不能离开山谷的话，输出 $R$ 号村庄离最近商店的距离；如果既不能离开山谷，也不能到达任意一个商店的话，输出 `oo`。", "hint": "### 样例解释 1\n\n本样例对应下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v6u2t5hk.png)\n\n在该图（以及接下来一张图）中，用灰色标记的点为商店所在点，图上的边按照「编号 / 长度」的顺序进行标注。\n\n### 样例解释 2\n\n本样例对应下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sdxj2iz6.png)\n\n### 子任务\n\n对于所有数据，均满足：$1 \\leq S,E,A,B,C,I,R \\leq N$，且 $1 \\leq W \\leq 10^9$。\n\n各子任务的分值与数据规模如下：\n\n- 子任务 1（9 分）：$1 \\leq N \\leq 100,1 \\leq Q \\leq 10000$，且所有道路均满足 $|A-B|=1$。\n- 子任务 2（27 分）：$1 \\leq N \\leq 1000,1 \\leq Q \\leq 1000$。\n- 子任务 3（23 分）：$1 \\leq N \\leq 10^5,1 \\leq Q \\leq 10^5$，且 $S=N$。\n- 子任务 4（41 分）：$1 \\leq N \\leq 10^5,1 \\leq Q \\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2019] 山谷 (Day1)", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day1 T3.** ***[Alpine valley](http://boi2019.eio.ee/wp-content/uploads/2019/04/valley.en_.pdf)***", "description": "在阿尔卑斯山谷中，有 $N$ 个村庄，编号为 $1 \\ldots N$，这些村庄通过 $N-1$ 条边连接起来，形成了一个树型结构。\n\n虽然任意两个村庄间都能相互抵达，但路途花费的时间可能令人难以接受，尤其是当你想要购买一些生活必需品的时候——因为所有村庄中，只有其中 $S$ 个村庄有商店。\n\n今年冬天，由于大雪的原因，情况变得更糟。因此，你需要到达 $E$ 号村庄——那里有连接山区和外界的唯一通道，亦或是在山谷中的商店里购买足够接下来几个月生活的物资。今天早上，你在收音机里听到了所有道路中有一条道路无法通行的消息，但是你并不知道具体是哪一条道路。\n\n你现在想知道你和你的朋友是否可以离开山谷，如果不能离开，则需要知道你们离最近商店的距离。由于你还不知道哪条道路无法通行，并且你的朋友们居住在不同的村庄，因此你需要回答 $Q$ 组询问，每组询问给出一条被封锁的道路和你朋友所在村庄的位置。", "inputFormat": "输入第一行包含四个整数 $N,S,Q,E$。其中 $N$ 代表村庄数目，$S$ 代表有商店的村庄的数目，$Q$ 代表你需要回答的询问数，$E$ 代表连接山区和外界的村庄的编号。\n\n接下来 $N-1$ 行，每行包含三个整数 $A,B,W$，代表村庄 $A$ 与村庄 $B$ 之间有一条长度为 $W$ 的道路。\n\n接下来 $S$ 行，每行包含一个整数 $C$，代表 $C$ 号村庄有一个商店。数据保证同一个村庄最多只有一个商店。\n\n最后 $Q$ 行，每行两个整数 $I,R$，询问当 $I$ 号道路（按输入顺序编号）无法通行时，从 $R$ 号村庄出发能否离开山谷，如果不能，则询问其离最近商店的距离。", "outputFormat": "输出包含 $Q$ 行，第 $i$ 行输出第 $i$ 组询问的答案。更具体地说，如果能离开山谷，输出 `escaped`；如果不能离开山谷的话，输出 $R$ 号村庄离最近商店的距离；如果既不能离开山谷，也不能到达任意一个商店的话，输出 `oo`。", "hint": "### 样例解释 1\n\n本样例对应下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v6u2t5hk.png)\n\n在该图（以及接下来一张图）中，用灰色标记的点为商店所在点，图上的边按照「编号 / 长度」的顺序进行标注。\n\n### 样例解释 2\n\n本样例对应下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sdxj2iz6.png)\n\n### 子任务\n\n对于所有数据，均满足：$1 \\leq S,E,A,B,C,I,R \\leq N$，且 $1 \\leq W \\leq 10^9$。\n\n各子任务的分值与数据规模如下：\n\n- 子任务 1（9 分）：$1 \\leq N \\leq 100,1 \\leq Q \\leq 10000$，且所有道路均满足 $|A-B|=1$。\n- 子任务 2（27 分）：$1 \\leq N \\leq 1000,1 \\leq Q \\leq 1000$。\n- 子任务 3（23 分）：$1 \\leq N \\leq 10^5,1 \\leq Q \\leq 10^5$，且 $S=N$。\n- 子任务 4（41 分）：$1 \\leq N \\leq 10^5,1 \\leq Q \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P6228", "type": "P", "difficulty": 5, "samples": [["1 2 2\n5\n3 4", "2"], ["1 1 2\n5\n5", "Impossible"], ["3 3 3\n3 3 2\n3 3 3", "Impossible"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "BalticOI（波罗的海）"], "title": "[BalticOI 2019] 汤姆的餐厅 (Day2)", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day2 T1.** ***[Tom's Kitchen](http://boi2019.eio.ee/wp-content/uploads/2019/05/kitchen.en_.pdf)***", "description": "*Tom's Kitchen* 是一家非常受欢迎的餐厅，其受欢迎的原因之一是每份菜都由至少 $ K $ 名厨师进行准备。今天有 $ N $ 份菜需要准备，第 $ i $ 份菜的准备时间是 $ A_i $ 小时。\n\nTom 可以雇佣 $ M $ 名厨师，厨师 $ j $ 最多可以工作 $ B_j $ 小时。此外，即使厨师 $ j $ 的工作时间不到 $ B_j $ 小时，他也会得到工作 $ B_j $ 小时的报酬。一名厨师可以花不同的时间准备不同的菜，但是每一道菜都需要由至少 $ K $ 名厨师准备，并且他们花的时间总和恰好为 $ A_i $。当一名厨师准备菜品时，他总会花正整数小时。\n\nTom 需要一套最优的雇佣厨师方案，以使得厨师不工作就获得报酬的小时数（即所有雇佣厨师的总工作时间上限与准备所有菜的总时间之差）尽可能小。", "inputFormat": "第一行包含三个正整数：$ N,M,K $。\n\n第二行包含 $ N $ 个整数 $ A_i $，第三行包含 $ M $ 个整数 $ B_j $。", "outputFormat": "如果不存在一套方案可以完成所有菜的准备工作，输出 `Impossible`。否则输出一个整数，代表厨师不工作就获得报酬的小时数的最小值。", "hint": "### 样例解释 1\n\nTom 需要雇佣这两位厨师来完成所有菜的准备工作。准备所有菜的时间为 $ 5 $ 小时，但 Tom 需要支付 $ 3+4=7 $ 小时的费用，即厨师不工作就能得到 $ 2 $ 小时的工资。\n\n### 样例解释 2\n\n准备一份菜需要至少两位厨师，但只能雇佣一位厨师，因此不能完成准备工作。\n\n### 样例解释 3\n\n第三份菜无法由三位厨师来准备，因为准备第三份菜的时间只有 $ 2 $ 小时（这意味着如果由三名厨师准备第三份菜的话，至少有一位厨师的准备时间是 $ 0 $ 小时，而这是不符合题目要求的）。\n\n### 子任务\n\n各子任务的分值与数据规模如下：\n\n- 子任务 1（9 分）：$ 1 \\leq N,K \\leq 300, 1 \\leq M \\leq 2, 1 \\leq A_i,B_j \\leq 300 $；\n- 子任务 2（22 分）：$ 1 \\leq N,K \\leq 300, 1 \\leq M \\leq 15, 1 \\leq A_i,B_j \\leq 300 $；\n- 子任务 3（20 分）：$ 1 \\leq N,M,A_i,B_j \\leq 300, K=1 $；\n- 子任务 4（21 分）：$ 1 \\leq N,M,K,A_i,B_j \\leq 40 $；\n- 子任务 5（28 分）：$ 1 \\leq N,M,K,A_i,B_j \\leq 300 $。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2019] 汤姆的餐厅 (Day2)", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day2 T1.** ***[Tom's Kitchen](http://boi2019.eio.ee/wp-content/uploads/2019/05/kitchen.en_.pdf)***", "description": "*Tom's Kitchen* 是一家非常受欢迎的餐厅，其受欢迎的原因之一是每份菜都由至少 $ K $ 名厨师进行准备。今天有 $ N $ 份菜需要准备，第 $ i $ 份菜的准备时间是 $ A_i $ 小时。\n\nTom 可以雇佣 $ M $ 名厨师，厨师 $ j $ 最多可以工作 $ B_j $ 小时。此外，即使厨师 $ j $ 的工作时间不到 $ B_j $ 小时，他也会得到工作 $ B_j $ 小时的报酬。一名厨师可以花不同的时间准备不同的菜，但是每一道菜都需要由至少 $ K $ 名厨师准备，并且他们花的时间总和恰好为 $ A_i $。当一名厨师准备菜品时，他总会花正整数小时。\n\nTom 需要一套最优的雇佣厨师方案，以使得厨师不工作就获得报酬的小时数（即所有雇佣厨师的总工作时间上限与准备所有菜的总时间之差）尽可能小。", "inputFormat": "第一行包含三个正整数：$ N,M,K $。\n\n第二行包含 $ N $ 个整数 $ A_i $，第三行包含 $ M $ 个整数 $ B_j $。", "outputFormat": "如果不存在一套方案可以完成所有菜的准备工作，输出 `Impossible`。否则输出一个整数，代表厨师不工作就获得报酬的小时数的最小值。", "hint": "### 样例解释 1\n\nTom 需要雇佣这两位厨师来完成所有菜的准备工作。准备所有菜的时间为 $ 5 $ 小时，但 Tom 需要支付 $ 3+4=7 $ 小时的费用，即厨师不工作就能得到 $ 2 $ 小时的工资。\n\n### 样例解释 2\n\n准备一份菜需要至少两位厨师，但只能雇佣一位厨师，因此不能完成准备工作。\n\n### 样例解释 3\n\n第三份菜无法由三位厨师来准备，因为准备第三份菜的时间只有 $ 2 $ 小时（这意味着如果由三名厨师准备第三份菜的话，至少有一位厨师的准备时间是 $ 0 $ 小时，而这是不符合题目要求的）。\n\n### 子任务\n\n各子任务的分值与数据规模如下：\n\n- 子任务 1（9 分）：$ 1 \\leq N,K \\leq 300, 1 \\leq M \\leq 2, 1 \\leq A_i,B_j \\leq 300 $；\n- 子任务 2（22 分）：$ 1 \\leq N,K \\leq 300, 1 \\leq M \\leq 15, 1 \\leq A_i,B_j \\leq 300 $；\n- 子任务 3（20 分）：$ 1 \\leq N,M,A_i,B_j \\leq 300, K=1 $；\n- 子任务 4（21 分）：$ 1 \\leq N,M,K,A_i,B_j \\leq 40 $；\n- 子任务 5（28 分）：$ 1 \\leq N,M,K,A_i,B_j \\leq 300 $。", "locale": "zh-CN"}}}
{"pid": "P6229", "type": "P", "difficulty": 5, "samples": [["zxyabcd\nyxbadctz", "4\n3 2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072, 3072]}, "tags": ["2019", "Special Judge", "BalticOI（波罗的海）"], "title": "[BalticOI 2019] 项链 (Day2)", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day2 T2.** ***[Necklace](http://boi2019.eio.ee/wp-content/uploads/2019/05/necklace.en_.pdf)***", "description": "Jill 和 Jane 是姐妹，去年圣诞节他们每个人都得到了一串彩色珠子。我们可以将每种颜色描述为小写英文字母（$\\texttt{a}\\ldots \\texttt{z}$），并将每串珠子描述为一个单词。\n\n女孩们想从他们的珠子中创造项链。他们可以从自己的那串珠子的两端移除一些珠子（可能为零），然后连接剩余部分的两端，将其变成项链。生成的项链可以旋转和翻转。\n\n姐妹们希望他们的项链看起来完全一样，并且尽可能长。她们项链可以达到的最大长度是多少？", "inputFormat": "输入包含两行，每行一个字符串，分别描述了 Jill 和 Jane 的一串彩珠。", "outputFormat": "输出第一行应该包含一个正整数，代表项链的长度。测试数据保证存在长度为正整数的项链。\n\n第二行包含两个正整数，分别代表 Jill 和 Jane 得到的项链在原来彩珠串中的起始位置，如果有多种合法方案，任意输出一种即可。每一串彩珠从左到右从 $ 0 $ 开始编号。", "hint": "### 样例解释\n\n我们对两串彩珠进行如下处理：\n\n`zxyabcd` $ \\to $ `---abcd`  \n`yxbadctz` $ \\to $ `--badc--`\n\n最终得到的两串项链 `abcd` 和 `badc` 经过翻转和旋转后是等价的。\n\n### 评分标准\n\n如果你的程序得到的项链合法（即两条项链等价），且长度与可能的最长项链长度相等，你将得到该测试点全部的分数。\n\n如果你的程序得到的项链合法，且长度达到了最长项链长度的一半，你将得到该测试点 $ 20\\% $ 的分数。\n\n**请注意，你在一个子任务上的得分，等于你在该子任务所有测试点的最低得分。**\n\n### 子任务\n\n设输入中每个字符串的长度上限为 $ N $ 。\n\n- 子任务 1（25 分）：$ N = 100 $；\n- 子任务 2（20 分）：$ N = 400 $；\n- 子任务 3（40 分）：$ N = 3000 $；\n- 子任务 4（15 分）：$ N = 3000 $，**内存限制为 3 MB**。\n\n前三个子任务内存限制均为 1GB。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2019] 项链 (Day2)", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day2 T2.** ***[Necklace](http://boi2019.eio.ee/wp-content/uploads/2019/05/necklace.en_.pdf)***", "description": "Jill 和 Jane 是姐妹，去年圣诞节他们每个人都得到了一串彩色珠子。我们可以将每种颜色描述为小写英文字母（$\\texttt{a}\\ldots \\texttt{z}$），并将每串珠子描述为一个单词。\n\n女孩们想从他们的珠子中创造项链。他们可以从自己的那串珠子的两端移除一些珠子（可能为零），然后连接剩余部分的两端，将其变成项链。生成的项链可以旋转和翻转。\n\n姐妹们希望他们的项链看起来完全一样，并且尽可能长。她们项链可以达到的最大长度是多少？", "inputFormat": "输入包含两行，每行一个字符串，分别描述了 Jill 和 Jane 的一串彩珠。", "outputFormat": "输出第一行应该包含一个正整数，代表项链的长度。测试数据保证存在长度为正整数的项链。\n\n第二行包含两个正整数，分别代表 Jill 和 Jane 得到的项链在原来彩珠串中的起始位置，如果有多种合法方案，任意输出一种即可。每一串彩珠从左到右从 $ 0 $ 开始编号。", "hint": "### 样例解释\n\n我们对两串彩珠进行如下处理：\n\n`zxyabcd` $ \\to $ `---abcd`  \n`yxbadctz` $ \\to $ `--badc--`\n\n最终得到的两串项链 `abcd` 和 `badc` 经过翻转和旋转后是等价的。\n\n### 评分标准\n\n如果你的程序得到的项链合法（即两条项链等价），且长度与可能的最长项链长度相等，你将得到该测试点全部的分数。\n\n如果你的程序得到的项链合法，且长度达到了最长项链长度的一半，你将得到该测试点 $ 20\\% $ 的分数。\n\n**请注意，你在一个子任务上的得分，等于你在该子任务所有测试点的最低得分。**\n\n### 子任务\n\n设输入中每个字符串的长度上限为 $ N $ 。\n\n- 子任务 1（25 分）：$ N = 100 $；\n- 子任务 2（20 分）：$ N = 400 $；\n- 子任务 3（40 分）：$ N = 3000 $；\n- 子任务 4（15 分）：$ N = 3000 $，**内存限制为 3 MB**。\n\n前三个子任务内存限制均为 1GB。", "locale": "zh-CN"}}}
{"pid": "P6230", "type": "P", "difficulty": 5, "samples": [["5 4 4\n7 0 4 9\n3 0 8 4\n1 1 3 7\n5 1 3 4\n4 2 2 9", "24"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "BalticOI（波罗的海）"], "title": "[BalticOI 2019] 奥运会 (Day2)", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day2 T3.** ***[Olympiads](http://boi2019.eio.ee/wp-content/uploads/2019/05/olymp.en_.pdf)***", "description": "两个相邻的城市每年都会派出一个 $ K $ 人的代表队参加 $ K $ 场比赛。每一位参赛者都参加所有 $ K $ 场比赛，单场比赛中代表队的得分是该比赛中代表队单名参赛者的最高分，而代表队的总得分是各场比赛代表队的得分之和。\n\n举个 $ K = 3 $ 的例子：\n\n|              | 比赛 1 | 比赛 2 | 比赛 3 |\n| :----------: | :---: | :---: | :---: |\n|   参赛者 1    |   4   |   5   |   3   |\n|   参赛者 2    |   7   |   3   |   6   |\n|   参赛者 3    |   3   |   4   |   5   |\n| **团队得分** |   7   |   5   |   6   |\n\n该队在这三场比赛的总得分为 $ 7+5+6=18 $。\n\n两个城市之间已经不仅仅开始争论哪个城市有最好的代表队，而且争论哪个城市有第 $ C $ 好的代表队。其中 $ C=1 $ 代表最好（即团队总分最高）的代表队，$ C=2 $ 代表第二好的代表队，以此类推。\n\n你的任务是为其中一个城市找到他们城市中第 $ C $ 好的代表队。两个代表队是不同的，当且仅当两个代表队中至少有一名成员不同。", "inputFormat": "输入第一行包含三个整数 $ N,K,C $，其中 $ N $ 代表该城市的候选队员人数，$ K $ 代表一个代表队的人数，$ C $ 代表你要求出的是第 $ C $ 好的代表队。\n\n接下来 $ N $ 行，每行包含 $ K $ 个整数，其中第 $ i $ 行第 $ j $ 个数代表队员 $ i $ 在第 $ j $ 场比赛上的得分。\n\n数据保证：$ K \\leq N $ ，可能的代表队组成方案数不少于 $ C $，每名队员的得分不超过 $ 10^6 $。", "outputFormat": "输出包含一个整数，即该城市第 $ C $ 好的代表队的得分。", "hint": "各子任务的数据规模如下：\n\n- 子任务 1（13 分）：$ 1 \\leq N \\leq 500, 1 \\leq K \\leq 2, 1 \\leq C \\leq 2000 $；\n- 子任务 2（31 分）：$ 1 \\leq N \\leq 40, 1 \\leq K \\leq 6, 1 \\leq C \\leq 2000 $；\n- 子任务 3（24 分）：$ 1 \\leq N \\leq 500, 1 \\leq K \\leq 6, 1 \\leq C \\leq 2000 $ ，且所有得分均不超过 $ 10 $；\n- 子任务 4（32 分）：$ 1 \\leq N \\leq 500, 1 \\leq K \\leq 6, 1 \\leq C \\leq 2000 $；", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2019] 奥运会 (Day2)", "background": "**译自 [BalticOI 2019](http://boi2019.eio.ee/tasks/) Day2 T3.** ***[Olympiads](http://boi2019.eio.ee/wp-content/uploads/2019/05/olymp.en_.pdf)***", "description": "两个相邻的城市每年都会派出一个 $ K $ 人的代表队参加 $ K $ 场比赛。每一位参赛者都参加所有 $ K $ 场比赛，单场比赛中代表队的得分是该比赛中代表队单名参赛者的最高分，而代表队的总得分是各场比赛代表队的得分之和。\n\n举个 $ K = 3 $ 的例子：\n\n|              | 比赛 1 | 比赛 2 | 比赛 3 |\n| :----------: | :---: | :---: | :---: |\n|   参赛者 1    |   4   |   5   |   3   |\n|   参赛者 2    |   7   |   3   |   6   |\n|   参赛者 3    |   3   |   4   |   5   |\n| **团队得分** |   7   |   5   |   6   |\n\n该队在这三场比赛的总得分为 $ 7+5+6=18 $。\n\n两个城市之间已经不仅仅开始争论哪个城市有最好的代表队，而且争论哪个城市有第 $ C $ 好的代表队。其中 $ C=1 $ 代表最好（即团队总分最高）的代表队，$ C=2 $ 代表第二好的代表队，以此类推。\n\n你的任务是为其中一个城市找到他们城市中第 $ C $ 好的代表队。两个代表队是不同的，当且仅当两个代表队中至少有一名成员不同。", "inputFormat": "输入第一行包含三个整数 $ N,K,C $，其中 $ N $ 代表该城市的候选队员人数，$ K $ 代表一个代表队的人数，$ C $ 代表你要求出的是第 $ C $ 好的代表队。\n\n接下来 $ N $ 行，每行包含 $ K $ 个整数，其中第 $ i $ 行第 $ j $ 个数代表队员 $ i $ 在第 $ j $ 场比赛上的得分。\n\n数据保证：$ K \\leq N $ ，可能的代表队组成方案数不少于 $ C $，每名队员的得分不超过 $ 10^6 $。", "outputFormat": "输出包含一个整数，即该城市第 $ C $ 好的代表队的得分。", "hint": "各子任务的数据规模如下：\n\n- 子任务 1（13 分）：$ 1 \\leq N \\leq 500, 1 \\leq K \\leq 2, 1 \\leq C \\leq 2000 $；\n- 子任务 2（31 分）：$ 1 \\leq N \\leq 40, 1 \\leq K \\leq 6, 1 \\leq C \\leq 2000 $；\n- 子任务 3（24 分）：$ 1 \\leq N \\leq 500, 1 \\leq K \\leq 6, 1 \\leq C \\leq 2000 $ ，且所有得分均不超过 $ 10 $；\n- 子任务 4（32 分）：$ 1 \\leq N \\leq 500, 1 \\leq K \\leq 6, 1 \\leq C \\leq 2000 $；", "locale": "zh-CN"}}}
{"pid": "P6231", "type": "P", "difficulty": 6, "samples": [["6 10\nadd 1 2 1\nadd 2 1 1\nadd 3 2 1\nadd 4 5 2\nreach 4 6\ndest 1 5\ndel 5 6\nadd 1 4 2\ndest 2 3\ndest 3 2", "OK\nERROR\nOK\nOK\nNO\nERROR\nERROR\nOK\n3 1\n5 6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2013", "各省省选", "平衡树", "江苏", "O2优化"], "title": "[JSOI2013] 公交系统", "background": "几年前南京因为修地铁的缘故，很多公交车线路都被迫改变了。\n\nJYY 为此很苦恼：试想一下，当你坐上一辆公交车，却发现这辆公交车驶向了与你记忆完全不同的方向。\n\n于是 JYY 打算开发一套可以利用手机进行实时更新的公交信息应用， 所有安装了这款应用的手机都可以向数据库发送最新的公交线路更改情况，同时也可以通过应用向数据库查询自己所需要的信息。", "description": "南京一共有 $n$ 个公交站点，分别从 $1$ 到 $n$ 编号。两个不同的站点 $x$ 和 $y$ 之间可能会有公交车直接运营（不经过别的站点直接从 $x$ 开到 $y$） ，我们将这种关系看作一条无向边（公交线路显然是双向的，我们既可以从 $x$ 坐公交车到 $y$，也可以从 $y$ 坐车到 $x$）。\n\n任意时刻任何公交站点都至多只会连有 $2$ 条边，并且所有这些边是不会形成\n环的（公交车很少会出现环线，所以这些公交线路应该形成一些不相交的链，链\n的两端分别对应两个终点站）。\n\nJYY 的 IOS 应用按照时间顺序一共收到了 $q$ 条交互信息，每一条交互信息\n都是下列五种信息之一：\n\n- `add x y z`，表示当前时刻，站点 $x$ 到站点 $y$ 之间有新增了一班公交车直接运营，并且在当前路况下，公交车所需要的运营时间为 $z$。\n- `del x y`，表示由于某种原因，原本在站点 $x$ 和站点 $y$ 之间直接运营的公交车停运了。\n- `change x y z`，表示由于路况情况改变，站点 $x$ 到站点 $y$ 之间直接运营的公交车当前的运营时间为 $z$。\n- `reach x y`，表示某个用户询问从站点 $x$ 坐车能不能坐到站点 $y$。\n- `dest x y`，表示某个用户从站点 $x$ 上车，坐上了当前正开往站点 $y$ 的公交车。该用户想知道，他到达 $y$ 后继续乘坐可乘坐的线路(已经乘坐过的线路不能重复乘坐)，最终能够到达的终点站是哪一站？从站点 $x$ 开始需要多久才能\n开到终点站？\n\n**在收到第一条信息之前，没有任何公交车在运营**。\n\n由于用户难免会提交错误的信息，所以 JYY 希望他的软件对于错误的信息也\n要能够做出合理的反应：\n\n- 对于 `add` 信息，如果加入边 $(x,y)$ 之后，任何站点连接的边数均不超过 $2$ 并且图中没有环，JYY 则认为这个信息是正确的，并根据这个信息更新\n数据库中的公交线路数据，否则JYY会无视这个错误信息。\n- 对于 `del` 和 `change` 信息，如果站点 $x$ 和站点 $y$ 之间有公交车直接运营， JYY 则认为这条信息是正确的，并更新数据库，否则 JYY 则会无视这个错误\n信息。\n- 对于 `dest` 信息，如果站点 $x$ 不能到达站点 $y$，JYY 也会认为这一条询问信\n息是错误的。\n\nJYY 希望你能够帮助他完成这一个公交信息应用。", "inputFormat": "输入数据的第一行包含两个整数，分别代表站点数 $n$ 和交互信息条数 $q$。\n\n接下来 $q$ 行，每行对应一个 JYY 需要处理的信息，其格式见【题目描述】。\n", "outputFormat": "输出 $q$ 行，每行都对应一个输入文件中的信息，具体内容如下：\n\n- 如果输入的信息是错误的，输出 `ERROR`。\n- 对于一个正确的 `add`，`del`，`change` 信息，输出 `OK`。\n- 对于一个正确的 `dest` 信息，输出一行两个整数，分别为终点站的编号和开到终点站所需要的时间.\n- 对于 `reach` 信息，如果用户询问的两个公交站点相互可达，输出 `YES`，否则输出 `NO`。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证：\n\n- $2 \\leq n \\leq 10^5$，$2 \\leq q \\leq2×10^5$。\n- $1 \\leq x, y \\leq n$，$x \\neq y$，$1\\leq z \\leq10^4$。\n\n---\n\n#### 提示\n\n请注意数据读入对程序效率造成的影响。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Bus System.", "background": "A few years ago, because Nanjing was building the subway, many bus routes had to be changed.\n\nJYY was very troubled by this. Imagine getting on a bus, only to find that it is heading in a completely different direction from what you remember.\n\nSo JYY plans to develop a bus information app that can be updated in real time using mobile phones. All phones with this app installed can send the latest bus route changes to the database, and can also query the database through the app for the information they need.", "description": "There are $n$ bus stops in Nanjing, numbered from $1$ to $n$. Between two different stops $x$ and $y$, there may be a bus that operates directly (going from $x$ to $y$ without passing any other stops). We treat this relationship as an undirected edge (bus routes are obviously bidirectional: we can go from $x$ to $y$, and also from $y$ to $x$).\n\nAt any time, each bus stop is connected to at most $2$ edges, and all these edges will not form cycles (bus circular lines are rare, so these bus routes should form several disjoint chains, and the two ends of each chain correspond to two terminal stops).\n\nJYY's iOS app receives a total of $q$ interaction messages in time order. Each message is one of the following five types:\n\n- `add x y z`: At the current time, a new bus starts operating directly between stop $x$ and stop $y$, and under current traffic conditions, the travel time is $z$.\n- `del x y`: For some reason, the bus that originally operated directly between stop $x$ and stop $y$ has stopped service.\n- `change x y z`: Due to changes in traffic conditions, the current travel time of the bus operating directly between stop $x$ and stop $y$ is $z$.\n- `reach x y`: A user asks whether they can travel from stop $x$ to stop $y$ by bus.\n- `dest x y`: A user gets on at stop $x$ and takes the bus that is currently heading to stop $y$. The user wants to know: after arriving at $y$, if they continue to take available routes (a route that has been taken cannot be taken again), which terminal stop can they finally reach? How long does it take from stop $x$ to reach that terminal stop?\n\n**Before the first message is received, there are no buses in service**.\n\nSince users may submit incorrect information, JYY wants his software to respond reasonably to incorrect messages as well:\n\n- For an `add` message, if after adding edge $(x, y)$, the degree of every stop is at most $2$ and there is no cycle in the graph, then JYY considers this message correct and updates the bus route data in the database according to it. Otherwise, JYY will ignore this incorrect message.\n- For `del` and `change` messages, if there is a bus operating directly between stop $x$ and stop $y$, then JYY considers the message correct and updates the database. Otherwise, JYY will ignore this incorrect message.\n- For a `dest` message, if stop $x$ cannot reach stop $y$, then JYY also considers this query message incorrect.\n\nJYY hopes you can help him complete this bus information app.", "inputFormat": "The first line of the input contains two integers, representing the number of stops $n$ and the number of interaction messages $q$.\n\nThe next $q$ lines each contain one message that JYY needs to process. The format is described in the Description section.", "outputFormat": "Output $q$ lines. Each line corresponds to one message in the input file. The required output is as follows:\n\n- If the input message is incorrect, output `ERROR`.\n- For a correct `add`, `del`, or `change` message, output `OK`.\n- For a correct `dest` message, output one line with two integers: the terminal stop number and the time needed to reach the terminal stop.\n- For a `reach` message, if the two queried bus stops are mutually reachable, output `YES`, otherwise output `NO`.", "hint": "#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that:\n\n- $2 \\leq n \\leq 10^5$, $2 \\leq q \\leq 2 \\times 10^5$.\n- $1 \\leq x, y \\leq n$, $x \\neq y$, $1 \\leq z \\leq 10^4$.\n\n---\n\n#### Hint\n\nPlease pay attention to the impact of input reading on program efficiency.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 公交系统", "background": "几年前南京因为修地铁的缘故，很多公交车线路都被迫改变了。\n\nJYY 为此很苦恼：试想一下，当你坐上一辆公交车，却发现这辆公交车驶向了与你记忆完全不同的方向。\n\n于是 JYY 打算开发一套可以利用手机进行实时更新的公交信息应用， 所有安装了这款应用的手机都可以向数据库发送最新的公交线路更改情况，同时也可以通过应用向数据库查询自己所需要的信息。", "description": "南京一共有 $n$ 个公交站点，分别从 $1$ 到 $n$ 编号。两个不同的站点 $x$ 和 $y$ 之间可能会有公交车直接运营（不经过别的站点直接从 $x$ 开到 $y$） ，我们将这种关系看作一条无向边（公交线路显然是双向的，我们既可以从 $x$ 坐公交车到 $y$，也可以从 $y$ 坐车到 $x$）。\n\n任意时刻任何公交站点都至多只会连有 $2$ 条边，并且所有这些边是不会形成\n环的（公交车很少会出现环线，所以这些公交线路应该形成一些不相交的链，链\n的两端分别对应两个终点站）。\n\nJYY 的 IOS 应用按照时间顺序一共收到了 $q$ 条交互信息，每一条交互信息\n都是下列五种信息之一：\n\n- `add x y z`，表示当前时刻，站点 $x$ 到站点 $y$ 之间有新增了一班公交车直接运营，并且在当前路况下，公交车所需要的运营时间为 $z$。\n- `del x y`，表示由于某种原因，原本在站点 $x$ 和站点 $y$ 之间直接运营的公交车停运了。\n- `change x y z`，表示由于路况情况改变，站点 $x$ 到站点 $y$ 之间直接运营的公交车当前的运营时间为 $z$。\n- `reach x y`，表示某个用户询问从站点 $x$ 坐车能不能坐到站点 $y$。\n- `dest x y`，表示某个用户从站点 $x$ 上车，坐上了当前正开往站点 $y$ 的公交车。该用户想知道，他到达 $y$ 后继续乘坐可乘坐的线路(已经乘坐过的线路不能重复乘坐)，最终能够到达的终点站是哪一站？从站点 $x$ 开始需要多久才能\n开到终点站？\n\n**在收到第一条信息之前，没有任何公交车在运营**。\n\n由于用户难免会提交错误的信息，所以 JYY 希望他的软件对于错误的信息也\n要能够做出合理的反应：\n\n- 对于 `add` 信息，如果加入边 $(x,y)$ 之后，任何站点连接的边数均不超过 $2$ 并且图中没有环，JYY 则认为这个信息是正确的，并根据这个信息更新\n数据库中的公交线路数据，否则JYY会无视这个错误信息。\n- 对于 `del` 和 `change` 信息，如果站点 $x$ 和站点 $y$ 之间有公交车直接运营， JYY 则认为这条信息是正确的，并更新数据库，否则 JYY 则会无视这个错误\n信息。\n- 对于 `dest` 信息，如果站点 $x$ 不能到达站点 $y$，JYY 也会认为这一条询问信\n息是错误的。\n\nJYY 希望你能够帮助他完成这一个公交信息应用。", "inputFormat": "输入数据的第一行包含两个整数，分别代表站点数 $n$ 和交互信息条数 $q$。\n\n接下来 $q$ 行，每行对应一个 JYY 需要处理的信息，其格式见【题目描述】。\n", "outputFormat": "输出 $q$ 行，每行都对应一个输入文件中的信息，具体内容如下：\n\n- 如果输入的信息是错误的，输出 `ERROR`。\n- 对于一个正确的 `add`，`del`，`change` 信息，输出 `OK`。\n- 对于一个正确的 `dest` 信息，输出一行两个整数，分别为终点站的编号和开到终点站所需要的时间.\n- 对于 `reach` 信息，如果用户询问的两个公交站点相互可达，输出 `YES`，否则输出 `NO`。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证：\n\n- $2 \\leq n \\leq 10^5$，$2 \\leq q \\leq2×10^5$。\n- $1 \\leq x, y \\leq n$，$x \\neq y$，$1\\leq z \\leq10^4$。\n\n---\n\n#### 提示\n\n请注意数据读入对程序效率造成的影响。", "locale": "zh-CN"}}}
{"pid": "P6232", "type": "P", "difficulty": 5, "samples": [["3 2", "5"], ["5 10", "19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400]}, "tags": ["2019", "eJOI（欧洲）"], "title": "[eJOI 2019] 挂架", "background": "", "description": "一个挂架由 $n$ 层的连接杆组成。第 $i$ 层（$i\\in [0,n-1]$）有 $2^i$ 根连接杆。第 $0$ 层的连接杆的中点被固定在墙上。在其他层，第 $j$ 个（$j\\in[1,2^i]$）连接杆的中点被上一层的第 $\\left\\lceil{\\dfrac{j}{2}}\\right\\rceil$ 个连接杆所固定。如果 $j$ 是奇数，那就是被上一个连接杆所的左端点固定的，如果是偶数，那就是右端点。在最底层，每一个连接杆的左右端点都有一个用来挂衣服的挂钩。一个挂钩可以挂至多一件衣服。\n\n举个例子，当 $n=3$ 时，这个挂架长这样：\n\n![e.g.](https://cdn.luogu.com.cn/upload/image_hosting/1gjqwegx.png)\n\nMojca 想要把她的所有衣服挂到这个挂架上。每一件衣服恰好重一个单位。以免破坏挂架脆弱的结构，她必须按照某种特定的规则（或顺序）依次挂衣服：\n\n- 当挂好一件衣服后，对于每一个连接杆，假设它左端点下方的总重为 $w_l$，右端点为 $w_r$，那么必须确保 $w_l-w_r \\in {0,1}$。 **注意，不可以为** $-1$ 。\n\n连接杆和挂钩很轻，重量可忽略不计。\n\nMojca 听说你很强，所以来寻求你的帮助。给定两个整数 $n,k$ ，请确定第 $k$ 个衣服应该挂在哪个挂钩上。", "inputFormat": "输入仅一行，两个正整数 $n,k$。", "outputFormat": "输出包含一行，共一个整数，表示第 $k$ 个衣服应该挂的挂钩的编号，**并对** $(10^9+7)$ **取模，挂钩的编号不等同于连接杆的编号。**", "hint": "#### 【样例输入输出解释】\n\n**样例 1 解释**\n\n- 挂钩的使用顺序应为：$1,5,3,7,2,6,4,8$，那么第二件衣服就应该挂在第 $5$ 个挂钩上。\n\n**样例 2 解释**\n\n- 这里，挂钩是使用顺序为：$1,\t17,9,\t25,5,\t21,13,29,3,19,\\text{etc.}$\n\n---\n\n#### 【数据规模与约定】\n\n**本题采用多测试点捆绑测试，共有 3 个子任务**。\n\n- Subtask 1（20 points）：$n \\leq 10$。\n- Subtask 2（20 points）：$n \\leq 20$。\n- Subtask 3（60 points）：无特殊限制。\n\n对于全部的测试点，保证 $1 \\leq n \\leq 10^6$，$1 \\leq k \\leq \\min(2^n, 10^{18})$。\n\n---\n\n#### 【说明】\n\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem B. [Hanging Rack](https://www.ejoi2019.si/static/media/uploads/tasks/rack-isc(1).pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)（感觉 [LOJ 的翻译](https://loj.ac/problem/3196) 被过于简化容易导致歧义，所以供题者自行翻译了一遍）", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2019] 挂架", "background": "", "description": "一个挂架由 $n$ 层的连接杆组成。第 $i$ 层（$i\\in [0,n-1]$）有 $2^i$ 根连接杆。第 $0$ 层的连接杆的中点被固定在墙上。在其他层，第 $j$ 个（$j\\in[1,2^i]$）连接杆的中点被上一层的第 $\\left\\lceil{\\dfrac{j}{2}}\\right\\rceil$ 个连接杆所固定。如果 $j$ 是奇数，那就是被上一个连接杆所的左端点固定的，如果是偶数，那就是右端点。在最底层，每一个连接杆的左右端点都有一个用来挂衣服的挂钩。一个挂钩可以挂至多一件衣服。\n\n举个例子，当 $n=3$ 时，这个挂架长这样：\n\n![e.g.](https://cdn.luogu.com.cn/upload/image_hosting/1gjqwegx.png)\n\nMojca 想要把她的所有衣服挂到这个挂架上。每一件衣服恰好重一个单位。以免破坏挂架脆弱的结构，她必须按照某种特定的规则（或顺序）依次挂衣服：\n\n- 当挂好一件衣服后，对于每一个连接杆，假设它左端点下方的总重为 $w_l$，右端点为 $w_r$，那么必须确保 $w_l-w_r \\in {0,1}$。 **注意，不可以为** $-1$ 。\n\n连接杆和挂钩很轻，重量可忽略不计。\n\nMojca 听说你很强，所以来寻求你的帮助。给定两个整数 $n,k$ ，请确定第 $k$ 个衣服应该挂在哪个挂钩上。", "inputFormat": "输入仅一行，两个正整数 $n,k$。", "outputFormat": "输出包含一行，共一个整数，表示第 $k$ 个衣服应该挂的挂钩的编号，**并对** $(10^9+7)$ **取模，挂钩的编号不等同于连接杆的编号。**", "hint": "#### 【样例输入输出解释】\n\n**样例 1 解释**\n\n- 挂钩的使用顺序应为：$1,5,3,7,2,6,4,8$，那么第二件衣服就应该挂在第 $5$ 个挂钩上。\n\n**样例 2 解释**\n\n- 这里，挂钩是使用顺序为：$1,\t17,9,\t25,5,\t21,13,29,3,19,\\text{etc.}$\n\n---\n\n#### 【数据规模与约定】\n\n**本题采用多测试点捆绑测试，共有 3 个子任务**。\n\n- Subtask 1（20 points）：$n \\leq 10$。\n- Subtask 2（20 points）：$n \\leq 20$。\n- Subtask 3（60 points）：无特殊限制。\n\n对于全部的测试点，保证 $1 \\leq n \\leq 10^6$，$1 \\leq k \\leq \\min(2^n, 10^{18})$。\n\n---\n\n#### 【说明】\n\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem B. [Hanging Rack](https://www.ejoi2019.si/static/media/uploads/tasks/rack-isc(1).pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)（感觉 [LOJ 的翻译](https://loj.ac/problem/3196) 被过于简化容易导致歧义，所以供题者自行翻译了一遍）", "locale": "zh-CN"}}}
{"pid": "P6233", "type": "P", "difficulty": 5, "samples": [["3 3\nEES\nSSW\nESX", "3"], ["3 3\nEES\nSSW\nEEX", "0"], ["3 4\nEXES\nWSNS\nXNNX", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400]}, "tags": ["2019", "eJOI（欧洲）", "最短路"], "title": "[eJOI 2019] Awesome Arrowland Adventure", "background": "", "description": "你现在在一个大小为 $m$ 行（行编号从 $0$ 开始，从上往下一直到 $m-1$） $n$ （列编号从 $0$ 开始，从左往右一直到 $n-1$）列的矩阵中。你的初始位置为 $(0,0)$。（$(r,c)$ 表示矩阵中第 $r$ 行，第 $c$ 列的位置）\n\n你需要走到位置 $(m-1,n-1)$ 处。这个矩阵非常神奇——在矩阵的某些格子上有一个箭头。 箭头只可能有四种方向：北（向上），东（向右），南（向下），西（向左）。箭头分布在整个矩阵之上，形成了箭头矩阵。\n\n当你在某一个位置时，假如这个位置不在矩形（左上角 $(0,0)$，右下角 $(m-1,n-1)$）范围内或这个位置没有箭头，那么你会一直停留于此，永远无法到达终点。如果此处有箭头，那么你将会向这个箭头的方向走一格。\n\n但显然，你不一定能够在初始的箭头矩阵上找到一条从 $(0,0)$ 到 $(m-1,n-1)$ 的路径。为了找到这样一条路径，你可以一次将箭头矩阵中某一个箭头 ***顺时针*** 旋转 $90$ 度。通过几次的旋转，你可能会找到一条路径。\n\n请你判断是否可以通过旋转来得到一条从 $(0,0)$ 到 $(m-1,n-1)$ 的路径，如果有，求出最小需要的旋转次数。", "inputFormat": "第一行：两个整数 $m,n$ ，表示矩阵的大小；\n\n接下来 $m$ 行，每行一个长度为 $n$ 的字符串，表示箭头矩阵中这一行的箭头的信息。字符串只可能包含 $5$ 种字符：`W`，`E`，`N`，`S`，`X`。它们分别表示：西，东，北，南，没有箭头。", "outputFormat": "如果没有可以找到路径的旋转方案，输出 ```-1```；\n\n如果有，输出一个整数表示需要旋转的最少次数。", "hint": "#### 样例解释\n\n【样例 1 解释】\n- 一个可行的解是，将位置 $(1,2)$ 的 ```W``` 旋转 $3$ 次变成 ```S```。\n\n【样例 2 解释】\n- 不需要任何旋转就可以。\n\n【样例 3 解释】\n- 在 $(0,0)$ 处旋转 $1$ 次，在 $(1,0)$ 处旋转 $2$ 次，在 $(2,1)$ 处旋转 $1$ 次。\n\n---\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 $5$ 个子任务**。\n\n- Subtask 1（10 points）：$m=1$，且输入的字符矩阵只包含 ```E``` 或 ```X```。\n- Subtask 2（12 points）：$m=1$。\n- Subtask 3（12 points）：$n=m=3$。\n- Subtask 4（16 points）：$m=2$。\n- Subtask 5（50 points）：无特殊限制。\n\n对于 全部的测试点，保证 $1\\le m,n\\le 500$。\n\n---\n\n#### 说明\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem F [Awesome Arrowland Adventure](https://www.ejoi2019.si/static/media/uploads/tasks/adventure-isc(1).pdf)\n\n题面翻译：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)（如果觉得这个翻译令人谔谔，欢迎提供新翻译）", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2019] Awesome Arrowland Adventure", "background": "", "description": "你现在在一个大小为 $m$ 行（行编号从 $0$ 开始，从上往下一直到 $m-1$） $n$ （列编号从 $0$ 开始，从左往右一直到 $n-1$）列的矩阵中。你的初始位置为 $(0,0)$。（$(r,c)$ 表示矩阵中第 $r$ 行，第 $c$ 列的位置）\n\n你需要走到位置 $(m-1,n-1)$ 处。这个矩阵非常神奇——在矩阵的某些格子上有一个箭头。 箭头只可能有四种方向：北（向上），东（向右），南（向下），西（向左）。箭头分布在整个矩阵之上，形成了箭头矩阵。\n\n当你在某一个位置时，假如这个位置不在矩形（左上角 $(0,0)$，右下角 $(m-1,n-1)$）范围内或这个位置没有箭头，那么你会一直停留于此，永远无法到达终点。如果此处有箭头，那么你将会向这个箭头的方向走一格。\n\n但显然，你不一定能够在初始的箭头矩阵上找到一条从 $(0,0)$ 到 $(m-1,n-1)$ 的路径。为了找到这样一条路径，你可以一次将箭头矩阵中某一个箭头 ***顺时针*** 旋转 $90$ 度。通过几次的旋转，你可能会找到一条路径。\n\n请你判断是否可以通过旋转来得到一条从 $(0,0)$ 到 $(m-1,n-1)$ 的路径，如果有，求出最小需要的旋转次数。", "inputFormat": "第一行：两个整数 $m,n$ ，表示矩阵的大小；\n\n接下来 $m$ 行，每行一个长度为 $n$ 的字符串，表示箭头矩阵中这一行的箭头的信息。字符串只可能包含 $5$ 种字符：`W`，`E`，`N`，`S`，`X`。它们分别表示：西，东，北，南，没有箭头。", "outputFormat": "如果没有可以找到路径的旋转方案，输出 ```-1```；\n\n如果有，输出一个整数表示需要旋转的最少次数。", "hint": "#### 样例解释\n\n【样例 1 解释】\n- 一个可行的解是，将位置 $(1,2)$ 的 ```W``` 旋转 $3$ 次变成 ```S```。\n\n【样例 2 解释】\n- 不需要任何旋转就可以。\n\n【样例 3 解释】\n- 在 $(0,0)$ 处旋转 $1$ 次，在 $(1,0)$ 处旋转 $2$ 次，在 $(2,1)$ 处旋转 $1$ 次。\n\n---\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 $5$ 个子任务**。\n\n- Subtask 1（10 points）：$m=1$，且输入的字符矩阵只包含 ```E``` 或 ```X```。\n- Subtask 2（12 points）：$m=1$。\n- Subtask 3（12 points）：$n=m=3$。\n- Subtask 4（16 points）：$m=2$。\n- Subtask 5（50 points）：无特殊限制。\n\n对于 全部的测试点，保证 $1\\le m,n\\le 500$。\n\n---\n\n#### 说明\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem F [Awesome Arrowland Adventure](https://www.ejoi2019.si/static/media/uploads/tasks/adventure-isc(1).pdf)\n\n题面翻译：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)（如果觉得这个翻译令人谔谔，欢迎提供新翻译）", "locale": "zh-CN"}}}
{"pid": "P6234", "type": "P", "difficulty": 6, "samples": [["5 6\n7 3 8 1 0 9\n4 6 2 5 8 3\n1 9 7 3 9 5\n2 6 8 4 5 7\n3 8 2 7 3 6\n3\n1 1\n2 2\n3 4", "67"], ["5 6\n7 3 8 1 0 9\n4 6 2 5 8 3\n1 9 7 3 9 5\n2 6 8 4 5 7\n3 8 2 7 3 6\n3\n1 1\n2 2\n3 3", "No"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400]}, "tags": ["2019", "并查集", "eJOI（欧洲）", "图论建模", "基环树", "分类讨论"], "title": "[eJOI 2019] T形覆盖", "background": null, "description": "如果你玩过俄罗斯方块，应该见过如下图形：\n\n![sqr](https://cdn.luogu.com.cn/upload/image_hosting/tt5awyg3.png)\n\n我们称它为一个 ***T 形四格拼板***。其 **中心** 被标记为 $\\times$。\n\nManca 画了一个 $n$ 行 $m$ 列的长方形网格。行从 $0$ 至 $m-1$ 编号，列从 $0$ 至 $n-1$ 编号。她将网格中的一些格子标记为 ***特殊格子***。然后，她想要她的朋友 Nika 帮助她将 T 形四格拼板按找如下规则摆放：\n\n- 特殊格子的数量与 T 形四格拼板的数量相同，每个 T 形四格拼板的中心在网格上的位置必须是特殊格子。\n- T 形四格拼板之间不能有重叠部分。\n- 所有拼板的部分均在网格内。\n\n注意，T 形四格拼板有四种摆放方式：$\\bot \\top \\vdash \\dashv$。\n\n如果方案不存在，输出 `No`，否则请找出一种方案使得被拼板覆盖的数总和最大，求出这个最大值。", "inputFormat": "第一行两个整数 $m,n$ 分别表示行数和列数。\n\n接下来 $m$ 行，每行 $n$ 个整数，第 $i$ 行第 $j$ 个数（从 $0$ 开始编号）表示方格中第 $i$ 行第 $j$ 列的数 $a_{i,j}$。\n\n接下来一行，一个整数 $k$，表示特殊格子的数量。\n\n接下来 $k$ 行，每行两个整数 $r_i,c_i$，表示第 $i$ 个被标记的特殊格子的位置。", "outputFormat": "如果有方案，输出可能的被覆盖的格子内数总和的最大值，否则输出 `No`。", "hint": "#### 输入输出样例 1 解释\n\n其中一种最优的方案如下：\n\n- $(1,1)$ 位置的摆放方式为 $\\dashv$。\n- $(2,2)$ 位置的摆放方式为 $\\vdash$。\n- $(3,4)$ 位置的摆放方式为 $\\bot$。\n\n--------------------------\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 7 个子任务。**\n\n- Subtask 1（5 points）：$k\\le 10^3$，保证对于所有 $i\\ne j$，$\\max(|r_i-r_j|,|c_i-c_j|)>2$。\n- Subtask 2（10 points）：$k\\le 10^3$，保证对于所有 $i\\ne j$，若 $\\max(|r_i-r_j|,|c_i-c_j|)\\le 2$，则 $(r_i,c_i)$ 与 $(r_j,c_j)$ 有邻边。\n- Subtask 3（10 points）：$k\\le 10^3$，保证对于所有 $i\\ne j$，$\\max(|r_i-r_j|,|c_i-c_j|)\\ne 2$。\n- Subtask 4（10 points）：所有特殊格子在同一行。\n- Subtask 5（15 points）：$k\\le 10$。\n- Subtask 6（20 points）：$k\\le 10^3$\n- Subtask 7（30 points）：无其他限制。\n\n对于所有数据，满足：$1\\le k\\le nm\\le 10^6,a_{ij}\\in[0,10^3],r_i\\in[0,m),c_i\\in[0,n)$。\n\n---------------------------\n\n#### 说明\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem C. [T - Covering](https://www.ejoi2019.si/static/media/uploads/tasks/covering-isc(1).pdf)。\n\n翻译来自：[LibreOJ](https://loj.ac/problem/3197)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2019] T形覆盖", "background": null, "description": "如果你玩过俄罗斯方块，应该见过如下图形：\n\n![sqr](https://cdn.luogu.com.cn/upload/image_hosting/tt5awyg3.png)\n\n我们称它为一个 ***T 形四格拼板***。其 **中心** 被标记为 $\\times$。\n\nManca 画了一个 $n$ 行 $m$ 列的长方形网格。行从 $0$ 至 $m-1$ 编号，列从 $0$ 至 $n-1$ 编号。她将网格中的一些格子标记为 ***特殊格子***。然后，她想要她的朋友 Nika 帮助她将 T 形四格拼板按找如下规则摆放：\n\n- 特殊格子的数量与 T 形四格拼板的数量相同，每个 T 形四格拼板的中心在网格上的位置必须是特殊格子。\n- T 形四格拼板之间不能有重叠部分。\n- 所有拼板的部分均在网格内。\n\n注意，T 形四格拼板有四种摆放方式：$\\bot \\top \\vdash \\dashv$。\n\n如果方案不存在，输出 `No`，否则请找出一种方案使得被拼板覆盖的数总和最大，求出这个最大值。", "inputFormat": "第一行两个整数 $m,n$ 分别表示行数和列数。\n\n接下来 $m$ 行，每行 $n$ 个整数，第 $i$ 行第 $j$ 个数（从 $0$ 开始编号）表示方格中第 $i$ 行第 $j$ 列的数 $a_{i,j}$。\n\n接下来一行，一个整数 $k$，表示特殊格子的数量。\n\n接下来 $k$ 行，每行两个整数 $r_i,c_i$，表示第 $i$ 个被标记的特殊格子的位置。", "outputFormat": "如果有方案，输出可能的被覆盖的格子内数总和的最大值，否则输出 `No`。", "hint": "#### 输入输出样例 1 解释\n\n其中一种最优的方案如下：\n\n- $(1,1)$ 位置的摆放方式为 $\\dashv$。\n- $(2,2)$ 位置的摆放方式为 $\\vdash$。\n- $(3,4)$ 位置的摆放方式为 $\\bot$。\n\n--------------------------\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 7 个子任务。**\n\n- Subtask 1（5 points）：$k\\le 10^3$，保证对于所有 $i\\ne j$，$\\max(|r_i-r_j|,|c_i-c_j|)>2$。\n- Subtask 2（10 points）：$k\\le 10^3$，保证对于所有 $i\\ne j$，若 $\\max(|r_i-r_j|,|c_i-c_j|)\\le 2$，则 $(r_i,c_i)$ 与 $(r_j,c_j)$ 有邻边。\n- Subtask 3（10 points）：$k\\le 10^3$，保证对于所有 $i\\ne j$，$\\max(|r_i-r_j|,|c_i-c_j|)\\ne 2$。\n- Subtask 4（10 points）：所有特殊格子在同一行。\n- Subtask 5（15 points）：$k\\le 10$。\n- Subtask 6（20 points）：$k\\le 10^3$\n- Subtask 7（30 points）：无其他限制。\n\n对于所有数据，满足：$1\\le k\\le nm\\le 10^6,a_{ij}\\in[0,10^3],r_i\\in[0,m),c_i\\in[0,n)$。\n\n---------------------------\n\n#### 说明\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem C. [T - Covering](https://www.ejoi2019.si/static/media/uploads/tasks/covering-isc(1).pdf)。\n\n翻译来自：[LibreOJ](https://loj.ac/problem/3197)。", "locale": "zh-CN"}}}
{"pid": "P6235", "type": "P", "difficulty": 6, "samples": [["2 2\n1 3 1\n1 3 1", "4"], ["4 3\n2 3 9 3 4 3\n2 3 3 1 2 4", "14"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400]}, "tags": ["动态规划 DP", "2019", "eJOI（欧洲）"], "title": "[eJOI 2019] 矩形染色", "background": "**警告：滥用本题评测将被封号**", "description": "Srečko 想给一个 $m$ 行（从 $0$ 至 $m-1$ 编号） $n$ 列（从 $0$ 至 $n-1$ 编号）的的矩形网格的每一个格子染上色。一开始，整个矩形都是白色的。每一步，他都会选择一条对角线，并给这条对角线上的所有格子染上色。每个对角线染色都需要一定的费用（忽略长度），这就导致某些对角线的染色费用有高于其他某些对角线。\n\n你需要写一个程序，读入各个对角线的染色费用，求出将所有格子染上色的最小总费用。\n\n**注意，同一个格子被重复多次地染色是被允许的。**\n\n------------------------------------\n\n一个 $m$ 行 $n$ 列的矩形网格共有 $2n+2m-2$。\n\n例：当 $m=4,n=3$ 时，共有 $12$ 条对角线：\n\n![e.g.](https://cdn.luogu.com.cn/upload/image_hosting/j74h8wgo.png)", "inputFormat": "输入共 $3$ 行。\n\n第一行：两个整数 $n,m$；\n\n第二行：共 $m+n-1$ 个整数，描述所有 $\\searrow$ 方向的对角线。第 $1$ 个整数表示 $(0,n-1)$ 这个单个的格子，第 $2$ 个整数表示 $(0,n-2),(1,n-1)$ 两个格子，以此类推。\n\n第三行：共 $m+n-1$ 个整数，描述所有 $\\nearrow$ 方向的对角线。第 $1$ 个整数表示 $(0,0)$ 这个单个的格子，第 $2$ 个整数表示 $(0,1),(1,0)$ 两个格子，以此类推。", "outputFormat": "一个整数表示答案。", "hint": "#### 【输入输出样例解释】\n\n**样例 1 解释**\n\n- 在这个情况中，如下的方案可以得到最小花费：\n\n![sample1](https://cdn.luogu.com.cn/upload/image_hosting/m2meji32.png)\n\n总花费 $=1+1+1+1=4$。\n\n**样例 2 解释**\n\n- 对于这个情况，如下的方案可以使花费最小化：\n\n![sample2](https://cdn.luogu.com.cn/upload/image_hosting/4xp4192w.png)\n\n总花费 $=3+2+3+3+1+2=14$。\n\n-------------------------\n\n#### 【数据规模与约定】\n\n**本题采用多测试点捆绑测试，共有 7 个子任务**。\n\n- Subtask 1（10 points）：$n,m\\le 4$\n- Subtask 2（10 points）：$m,n\\le 10$\n- Subtask 3（10 points）：$m,n\\le 20$\n- Subtask 4（20 points）：$m,n\\le 2\\times 10^3$\n- Subtask 5（10 points）：$m=1,n\\le 2\\times 10^5$\n- Subtask 6（20 points）：$m=n\\le 2\\times 10^5$\n- Subtask 7（20 points）：无其他限制。\n\n对于所有数据，保证 $1\\le m,n\\le 2\\times 10^5$，每条对角线的染色费用 $\\in [1,10^9]$\n\n-----------------------\n\n#### 【说明】\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem E. [Colouring\ta\trectangle](https://www.ejoi2019.si/static/media/uploads/tasks/colouring-isc.pdf)。\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2019] 矩形染色", "background": "**警告：滥用本题评测将被封号**", "description": "Srečko 想给一个 $m$ 行（从 $0$ 至 $m-1$ 编号） $n$ 列（从 $0$ 至 $n-1$ 编号）的的矩形网格的每一个格子染上色。一开始，整个矩形都是白色的。每一步，他都会选择一条对角线，并给这条对角线上的所有格子染上色。每个对角线染色都需要一定的费用（忽略长度），这就导致某些对角线的染色费用有高于其他某些对角线。\n\n你需要写一个程序，读入各个对角线的染色费用，求出将所有格子染上色的最小总费用。\n\n**注意，同一个格子被重复多次地染色是被允许的。**\n\n------------------------------------\n\n一个 $m$ 行 $n$ 列的矩形网格共有 $2n+2m-2$。\n\n例：当 $m=4,n=3$ 时，共有 $12$ 条对角线：\n\n![e.g.](https://cdn.luogu.com.cn/upload/image_hosting/j74h8wgo.png)", "inputFormat": "输入共 $3$ 行。\n\n第一行：两个整数 $n,m$；\n\n第二行：共 $m+n-1$ 个整数，描述所有 $\\searrow$ 方向的对角线。第 $1$ 个整数表示 $(0,n-1)$ 这个单个的格子，第 $2$ 个整数表示 $(0,n-2),(1,n-1)$ 两个格子，以此类推。\n\n第三行：共 $m+n-1$ 个整数，描述所有 $\\nearrow$ 方向的对角线。第 $1$ 个整数表示 $(0,0)$ 这个单个的格子，第 $2$ 个整数表示 $(0,1),(1,0)$ 两个格子，以此类推。", "outputFormat": "一个整数表示答案。", "hint": "#### 【输入输出样例解释】\n\n**样例 1 解释**\n\n- 在这个情况中，如下的方案可以得到最小花费：\n\n![sample1](https://cdn.luogu.com.cn/upload/image_hosting/m2meji32.png)\n\n总花费 $=1+1+1+1=4$。\n\n**样例 2 解释**\n\n- 对于这个情况，如下的方案可以使花费最小化：\n\n![sample2](https://cdn.luogu.com.cn/upload/image_hosting/4xp4192w.png)\n\n总花费 $=3+2+3+3+1+2=14$。\n\n-------------------------\n\n#### 【数据规模与约定】\n\n**本题采用多测试点捆绑测试，共有 7 个子任务**。\n\n- Subtask 1（10 points）：$n,m\\le 4$\n- Subtask 2（10 points）：$m,n\\le 10$\n- Subtask 3（10 points）：$m,n\\le 20$\n- Subtask 4（20 points）：$m,n\\le 2\\times 10^3$\n- Subtask 5（10 points）：$m=1,n\\le 2\\times 10^5$\n- Subtask 6（20 points）：$m=n\\le 2\\times 10^5$\n- Subtask 7（20 points）：无其他限制。\n\n对于所有数据，保证 $1\\le m,n\\le 2\\times 10^5$，每条对角线的染色费用 $\\in [1,10^9]$\n\n-----------------------\n\n#### 【说明】\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem E. [Colouring\ta\trectangle](https://www.ejoi2019.si/static/media/uploads/tasks/colouring-isc.pdf)。\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)。", "locale": "zh-CN"}}}
{"pid": "P6236", "type": "P", "difficulty": 2, "samples": [["10 4\n4\n5\n2\n3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "COCI（克罗地亚）"], "title": "[COCI 2010/2011 #1] LJUTNJA", "background": "", "description": "幼儿园的小孩们收到了一个有 $m$ 颗糖果的大包裹，现在要把这些糖果分给 $n$ 个小孩。\n\n每一个小孩都给出了一个期望的糖果数，如果没有达到他的期望值 $a_i$，小孩就会生气。每差一个糖果，小孩的生气指数就会增加，可以认为他生气的程度等于他少得到的糖果数的平方。\n\n比如，Mirko 想要得到 $32$ 个糖果，但是只得到了 $29$ 个。他少了 $3$ 个，所以他的生气指数是 $9$。不幸的是，糖果数不足以满足所有小孩的期望。所以我们应该采取最优的分配方法，使得最后小孩们的生气指数的和最小。", "inputFormat": "输入数据共 $n+1$ 行。\n\n第一行两个整数 $m,n$。\n \n接下来 $n$ 行，每行一个整数，第 $i+1$ 行的整数表示第 $i$ 个小朋友期望值 $a_i$。", "outputFormat": "输出数据共一行。\n\n一行一个整数，表示最小的总生气指数。", "hint": "#### 样例输入输出 1 解释\n\n共 $10$ 颗糖果，共 $4$ 人，给每一个同学他所需要的糖果数减 $1$，也就是依次给 $3,4,1,2$ 颗，这样的话每人少一颗，每人的生气指数就是 $1^2=1$，$4$ 个人就是 $1 \\times 4=4$，答案 $4$ 是最优方案。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $40 \\%$ 的数据，保证 $n \\leq 5000$，$m \\leq 30$，结果不超过 $5 \\times 10^8$。\n- 对于 $100 \\%$ 的数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 2 \\times {10}^9$，结果不超过 $2^{64}-1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2010/2011 #1] LJUTNJA", "background": "", "description": "幼儿园的小孩们收到了一个有 $m$ 颗糖果的大包裹，现在要把这些糖果分给 $n$ 个小孩。\n\n每一个小孩都给出了一个期望的糖果数，如果没有达到他的期望值 $a_i$，小孩就会生气。每差一个糖果，小孩的生气指数就会增加，可以认为他生气的程度等于他少得到的糖果数的平方。\n\n比如，Mirko 想要得到 $32$ 个糖果，但是只得到了 $29$ 个。他少了 $3$ 个，所以他的生气指数是 $9$。不幸的是，糖果数不足以满足所有小孩的期望。所以我们应该采取最优的分配方法，使得最后小孩们的生气指数的和最小。", "inputFormat": "输入数据共 $n+1$ 行。\n\n第一行两个整数 $m,n$。\n \n接下来 $n$ 行，每行一个整数，第 $i+1$ 行的整数表示第 $i$ 个小朋友期望值 $a_i$。", "outputFormat": "输出数据共一行。\n\n一行一个整数，表示最小的总生气指数。", "hint": "#### 样例输入输出 1 解释\n\n共 $10$ 颗糖果，共 $4$ 人，给每一个同学他所需要的糖果数减 $1$，也就是依次给 $3,4,1,2$ 颗，这样的话每人少一颗，每人的生气指数就是 $1^2=1$，$4$ 个人就是 $1 \\times 4=4$，答案 $4$ 是最优方案。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $40 \\%$ 的数据，保证 $n \\leq 5000$，$m \\leq 30$，结果不超过 $5 \\times 10^8$。\n- 对于 $100 \\%$ 的数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 2 \\times {10}^9$，结果不超过 $2^{64}-1$。", "locale": "zh-CN"}}}
{"pid": "P6237", "type": "P", "difficulty": 6, "samples": [["11\n7 6\n4 4\n3 2\n1 3\n9 9\n13 4\n8 1\n6 4\n9 5\n8 3\n11 5", "3\n3 4 7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "CEOI（中欧）"], "title": "[CEOI 2012] Printed Circuit Board", "background": "", "description": "给出一个 $n$ 个顶点的简单多边形，对于每个顶点，假如它和原点连成的线段只在这个顶点处和多边形相交，就称为满足要求的顶点。你的任务是输出所有满足要求的顶点编号。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/beasw2yx.png)\n\n", "inputFormat": "第一行一个正整数 $n$。\n\n下面 $n$ 行每行两个不超过 $10^6$ 的正整数，依次表示每个顶点的坐标。顶点按照输入顺序用正整数 $1,2,...,n$ 编号，并且顶点保证按照顺时针或逆时针顺序给出。", "outputFormat": "第一行一个正整数 $m$，表示满足要求的顶点个数。 \n\n第二行 $m$ 个正整数，按照升序给出满足要求的顶点编号。", "hint": "对于 $100\\%$ 的数据，满足 $1 \\le n \\le 2 \\times 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2012] Printed Circuit Board", "background": "", "description": "给出一个 $n$ 个顶点的简单多边形，对于每个顶点，假如它和原点连成的线段只在这个顶点处和多边形相交，就称为满足要求的顶点。你的任务是输出所有满足要求的顶点编号。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/beasw2yx.png)\n\n", "inputFormat": "第一行一个正整数 $n$。\n\n下面 $n$ 行每行两个不超过 $10^6$ 的正整数，依次表示每个顶点的坐标。顶点按照输入顺序用正整数 $1,2,...,n$ 编号，并且顶点保证按照顺时针或逆时针顺序给出。", "outputFormat": "第一行一个正整数 $m$，表示满足要求的顶点个数。 \n\n第二行 $m$ 个正整数，按照升序给出满足要求的顶点编号。", "hint": "对于 $100\\%$ 的数据，满足 $1 \\le n \\le 2 \\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P6238", "type": "P", "difficulty": 5, "samples": [["8 7 5\n1 2\n1 3\n1 6\n3 4\n2 5\n7 8\n8 7\n1 2 3 7 8 ", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 3000, 1000, 3000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "江苏"], "title": "[JSOI2011] 序的计数", "background": "", "description": "给定无向图 $G=\\{V,E\\}$，其中 $n=|V|,m=|E|$，$n$ 个点从 $1$ 到 $n$ 依次编号。\n\n现在要求利用 DFS 即深度优先搜索。容易知道，利用 DFS 进行遍历的同时，我们可以将遍历到的点按照遍历的先后顺序记录下来，这样会得到一个点的序列，即一个 $1$ 到 $n$ 的排列。我们称这个排列为一个可能的 DFS 序。\n\n显然不是所有 $1$ 到 $n$ 的排列都可能是 DFS 序的。现在这个 DFS 的过程进行到了一半，且恰好遍历了 $k$ 个不同的点 $\\{u_1,u_2,...,u_k\\}$，那么显然，这个进行到一半的 DFS 过程所对应的 DFS 序应该是这 $k$ 个数的一个排列。\n\n现在请求出，当前这 $k$ 个遍历点能对应多少个不同的长度为 $k$ 的 DFS 序呢?", "inputFormat": "输入文件第一行包含用空格隔开的三个整数，分别为 $n,m$ 和 $k$；\n\n接下来 $m$ 行，每行包含两个用一个空格隔开的正整数 $u$ 和 $v$，表示图 $G$ 存在边 $(u,v)$。\n\n最后一行包含 $k$ 个用空格隔开的正整数，描述当前已经遍历过的 $k$ 个点，其中第 $i$ 个数为 $u_i$。数据保证这 $k$ 个数一定按照从小到大的顺序给出。", "outputFormat": "输出一行一个数，表示可能的 DFS 序的数量。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\le n \\le 100$，$1 \\le m \\le 5 \\times 10^3$，$1 \\le k \\le 18$，$1 \\le u_i \\le n$，$1 \\leq u, v \\leq n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2011] 序的计数", "background": "", "description": "给定无向图 $G=\\{V,E\\}$，其中 $n=|V|,m=|E|$，$n$ 个点从 $1$ 到 $n$ 依次编号。\n\n现在要求利用 DFS 即深度优先搜索。容易知道，利用 DFS 进行遍历的同时，我们可以将遍历到的点按照遍历的先后顺序记录下来，这样会得到一个点的序列，即一个 $1$ 到 $n$ 的排列。我们称这个排列为一个可能的 DFS 序。\n\n显然不是所有 $1$ 到 $n$ 的排列都可能是 DFS 序的。现在这个 DFS 的过程进行到了一半，且恰好遍历了 $k$ 个不同的点 $\\{u_1,u_2,...,u_k\\}$，那么显然，这个进行到一半的 DFS 过程所对应的 DFS 序应该是这 $k$ 个数的一个排列。\n\n现在请求出，当前这 $k$ 个遍历点能对应多少个不同的长度为 $k$ 的 DFS 序呢?", "inputFormat": "输入文件第一行包含用空格隔开的三个整数，分别为 $n,m$ 和 $k$；\n\n接下来 $m$ 行，每行包含两个用一个空格隔开的正整数 $u$ 和 $v$，表示图 $G$ 存在边 $(u,v)$。\n\n最后一行包含 $k$ 个用空格隔开的正整数，描述当前已经遍历过的 $k$ 个点，其中第 $i$ 个数为 $u_i$。数据保证这 $k$ 个数一定按照从小到大的顺序给出。", "outputFormat": "输出一行一个数，表示可能的 DFS 序的数量。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\le n \\le 100$，$1 \\le m \\le 5 \\times 10^3$，$1 \\le k \\le 18$，$1 \\le u_i \\le n$，$1 \\leq u, v \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P6239", "type": "P", "difficulty": 6, "samples": [["3 4 1", "3"], ["4 3 3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "江西", "状压 DP"], "title": "[JXOI2012] 奇怪的道路", "background": "", "description": "小宇从历史书上了解到一个古老的文明。这个文明在各个方面高度发达，交通方面也不例外。考古学家已经知道，这个文明在全盛时期有 $n$ 座城市，编号为 $1,2,...,n$。$m$ 条道路连接在这些城市之间，每条道路将两个城市连接起来，使得两地的居民可以方便地来往。一对城市之间可能存在多条道路。\n\n据史料记载，这个文明的交通网络满足两个奇怪的特征。\n\n1. 这个文明崇拜数字 $k$，对于任何一条道路，设它连接的两个城市分别为 $u$ 和 $v$，则必定满足 $1 \\le \\left\\vert {u-v}\\right\\vert \\le k$。\n2. 任何一个城市都与恰好偶数条道路相连（ $0$ 也被认为是偶数）。\n\n不过，由于时间过于久远，具体的交通网络我们已经无法得知了。小宇很好奇这 $n$ 个城市之间究竟有多少种可能的连接方法，于是她向你求助。\n\n两种可能的连接方法不同当且仅当存在一对城市，它们间的道路数在两种方法中不同。\n\n在交通网络中，有可能存在两个城市无法互相到达。\n\n方法数可能很大，你只需要输出方法数模 $10^9 + 7$ 后的结果。", "inputFormat": "输入共一行，有三个整数 $n,m,k$。", "outputFormat": "输出一个整数，表示方案数模 $10^9 + 7$ 后的结果。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，满足 $1 \\le n,m \\le 30$，$1 \\le k \\le 8$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JXOI2012] 奇怪的道路", "background": "", "description": "小宇从历史书上了解到一个古老的文明。这个文明在各个方面高度发达，交通方面也不例外。考古学家已经知道，这个文明在全盛时期有 $n$ 座城市，编号为 $1,2,...,n$。$m$ 条道路连接在这些城市之间，每条道路将两个城市连接起来，使得两地的居民可以方便地来往。一对城市之间可能存在多条道路。\n\n据史料记载，这个文明的交通网络满足两个奇怪的特征。\n\n1. 这个文明崇拜数字 $k$，对于任何一条道路，设它连接的两个城市分别为 $u$ 和 $v$，则必定满足 $1 \\le \\left\\vert {u-v}\\right\\vert \\le k$。\n2. 任何一个城市都与恰好偶数条道路相连（ $0$ 也被认为是偶数）。\n\n不过，由于时间过于久远，具体的交通网络我们已经无法得知了。小宇很好奇这 $n$ 个城市之间究竟有多少种可能的连接方法，于是她向你求助。\n\n两种可能的连接方法不同当且仅当存在一对城市，它们间的道路数在两种方法中不同。\n\n在交通网络中，有可能存在两个城市无法互相到达。\n\n方法数可能很大，你只需要输出方法数模 $10^9 + 7$ 后的结果。", "inputFormat": "输入共一行，有三个整数 $n,m,k$。", "outputFormat": "输出一个整数，表示方案数模 $10^9 + 7$ 后的结果。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，满足 $1 \\le n,m \\le 30$，$1 \\le k \\le 8$。", "locale": "zh-CN"}}}
{"pid": "P6240", "type": "P", "difficulty": 6, "samples": [["8 5\n10 31 36 30 36 24 29 29\n59 152 284 202 282 156 277 212\n3 5 81\n4 5 75\n7 8 71\n1 3 92\n4 4 95\n", "566\n484\n489\n495\n202"], ["15 10\n5 15 18 15 18 12 14 14 10 15 17 18 9 7 6 \n11 31 26 34 19 17 15 25 11 34 18 26 21 8 11 \n7 15 31\n2 9 67\n8 15 77\n3 13 43\n6 7 98\n2 2 110\n3 13 26\n11 11 84\n7 14 25\n4 6 90", "66\n118\n128\n89\n32\n31\n55\n18\n55\n70"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "分治", "背包 DP"], "title": "好吃的题目", "background": "这是一道好吃的题目。", "description": "有一条小吃街，从左到右依次排列着 $n$ 个商店，从 $1$ 开始标号。\n\n第 $i$ 个商店会只出售一种小吃，热量为 $h_i$，美味度为 $w_i$。\n\n现在有 $m$ 个吃货要来逛街，第 $i$ 个吃货会在 $[l_i,r_i]$ 的商店内寻找小吃，而且为了防止太胖，最多能摄入 $t_i$ 的热量。\n\n小吃吃多了会腻，所以同一个商店的小吃只能吃一次。\n\n现在每个吃货想知道自己最多能得到多少美味度。", "inputFormat": "第一行为两个整数，分别表示 $n,m$。\n\n第二行为 $n$ 个整数，第 $i$ 个整数表示 $h_i$。\n\n第三行为 $n$ 个整数，第 $i$ 个整数表示 $w_i$。\n\n第 $4$ 到第 $(m + 3)$ 行，每行三个整数，第 $(i + 3)$ 行的整数 $l_i, r_i, t_i$ 分别表示第 $i$ 个吃货的参数。\n", "outputFormat": "对于每个吃货，输出一行一个整数，表示最大的美味度和。", "hint": "#### 【样例输入输出解释】\n\n**样例 1 解释**\n\n对于第一组数据的第一个吃货，可以选择第 $3$ 个商店和第 $5$ 个商店。\n\n摄入的热量为 $36+36=72\\leq 81$，获得美味度为 $284+282=566$。\n\n**样例 2 解释**\n\n对于第二组数据的第一个吃货，可以选择第 $10$，第 $13$，第 $15$ 个商店。\n\n摄入的热量为 $15+9+6=30\\leq 31$，获得美味度为 $34+21+11=66$。\n\n---\n\n#### 【数据规模与约定】\n\n- 对于 $30\\%$ 的数据，满足 $n,m\\leq 500$。\n- 对于 $60\\%$ 的数据，满足 $n\\leq 4\\times 10^4$，$m\\leq 5000$。\n- 对于 $100\\%$ 的数据，满足 $1 \\leq n\\leq 4\\times 10^4$，$1 \\leq m\\leq 2\\times 10^5$，$1\\leq l_i\\leq r_i\\leq n$，$1\\leq h_i,t_i\\leq 200$，$1\\leq w_i\\leq 10^7$。\n\n\n\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "好吃的题目", "background": "这是一道好吃的题目。", "description": "有一条小吃街，从左到右依次排列着 $n$ 个商店，从 $1$ 开始标号。\n\n第 $i$ 个商店会只出售一种小吃，热量为 $h_i$，美味度为 $w_i$。\n\n现在有 $m$ 个吃货要来逛街，第 $i$ 个吃货会在 $[l_i,r_i]$ 的商店内寻找小吃，而且为了防止太胖，最多能摄入 $t_i$ 的热量。\n\n小吃吃多了会腻，所以同一个商店的小吃只能吃一次。\n\n现在每个吃货想知道自己最多能得到多少美味度。", "inputFormat": "第一行为两个整数，分别表示 $n,m$。\n\n第二行为 $n$ 个整数，第 $i$ 个整数表示 $h_i$。\n\n第三行为 $n$ 个整数，第 $i$ 个整数表示 $w_i$。\n\n第 $4$ 到第 $(m + 3)$ 行，每行三个整数，第 $(i + 3)$ 行的整数 $l_i, r_i, t_i$ 分别表示第 $i$ 个吃货的参数。\n", "outputFormat": "对于每个吃货，输出一行一个整数，表示最大的美味度和。", "hint": "#### 【样例输入输出解释】\n\n**样例 1 解释**\n\n对于第一组数据的第一个吃货，可以选择第 $3$ 个商店和第 $5$ 个商店。\n\n摄入的热量为 $36+36=72\\leq 81$，获得美味度为 $284+282=566$。\n\n**样例 2 解释**\n\n对于第二组数据的第一个吃货，可以选择第 $10$，第 $13$，第 $15$ 个商店。\n\n摄入的热量为 $15+9+6=30\\leq 31$，获得美味度为 $34+21+11=66$。\n\n---\n\n#### 【数据规模与约定】\n\n- 对于 $30\\%$ 的数据，满足 $n,m\\leq 500$。\n- 对于 $60\\%$ 的数据，满足 $n\\leq 4\\times 10^4$，$m\\leq 5000$。\n- 对于 $100\\%$ 的数据，满足 $1 \\leq n\\leq 4\\times 10^4$，$1 \\leq m\\leq 2\\times 10^5$，$1\\leq l_i\\leq r_i\\leq n$，$1\\leq h_i,t_i\\leq 200$，$1\\leq w_i\\leq 10^7$。\n\n\n\n\n", "locale": "zh-CN"}}}
{"pid": "P6241", "type": "P", "difficulty": 5, "samples": [["3\n2\n3\n7", "2\n1 1\n1 2\n3\n1 1\n2 2\n1 3\n4\n1 1\n1 2\n2 3\n1 4​"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400]}, "tags": ["2019", "Special Judge", "eJOI（欧洲）", "构造"], "title": "[eJOI 2019] 塔", "background": "", "description": "Jernej 在晚上感到很无聊，于是他发明了一个游戏。他想要用数字卡片生成一个塔。一开始，他在一张卡片上写下了一个数字 $1$。\n\nJernej 可以再另一张写下一个新的数字并放在塔顶。 **这个新的数字必须等于之前塔中某一连续段的数字之和** 。也就是说，假设现在塔中已有 $n$ 个数字，你可以任意选取塔中的一段 $[l,u]$ ，并对这一段求和，将得到的新数字添加至塔顶，其中 $1\\le l\\le u\\le n$。\n\nJernej 想要生成 $T$ 个塔（相当于多组询问），每个塔顶都是 $T$ 个可能不同的他想要的数字。你需要帮助他求出生成这些塔的最小步数及其方案。", "inputFormat": "第一行：一个整数 $T$，表示塔的个数；\n\n接下来 $T$ 行，一行一个整数 $q$，表示现在 Jernej 想生成一个塔顶数字为 $q$ 的塔。\n\n保证有解。", "outputFormat": "对于每个询问 $q$：\n\n- 输出一行，包含一个整数 $s$ （$0\\le s\\le 10^3$），表示最小步数。\n- 接下来 $s$ 行，每行两个由空格隔开的整数 $l,u$，表示建生成塔的方案（操作时间早的先输出）。", "hint": "#### 【Special Judge 计分标准】\n\n本题共 $10$ 个测试点。对于每个测试点，计分规则如下：\n\n- 对于测试点中的任意一个塔，如果你的程序输出的 **最小步数** 与标准答案 **均一致** ，那么这个测试点你会得到 $10$ 分。\n- 对于测试点中的任意一个塔，如果你的程序输出的答案是错误的，那么得 $0$ 分（评测时如果发现输出不完全可能会得到 UKE）。\n- 如果你的答案并 **不是最优解但不是错误的** ，那么对于该测试点中的第 $i$ 个塔，你得到的分数为 $\\text{score}_i =1+\\dfrac{\\text{minimum steps}}{\\text{solution steps}}\\times 7$，其中 $\\text{minimum steps}$ 表示正确答案的最小步数，$\\text{solution steps}$ 表示你的程序输出的答案。最终这个测试点的得分为 $\\min\\limits_{i\\in [1,T]} \\{\\text{score}_i\\}$。向上取两位小数。\n\n#### 【输入输出样例解释】\n\n**询问 1 解释**：\n\n- Jernej 想要生成造一个塔顶数为 $2$ 的塔。起初塔为 $\\{1\\}$（左边表示塔底，右边表示塔顶）；\n- 第一步，选取子段 $[1,1]$，对 $\\{1\\}$ 中的所有元素求和，得到 $1$，现在塔为 $\\{1,1\\}$；\n- 第二步，选取子段 $[1,2]$，对 $\\{1,1\\}$ 中的所有元素求和，得到 $2$，现在塔为 $\\{1,1,2\\}$。此时已经达到了询问的要求。\n\n**询问 2 解释**：\n\n- 要生成塔顶为 $3$ 的塔不止一种方法。除了样例输出的一种之外，下面的也是正确答案：\n\n```plain\n1 1\n1 2\n2 3\n```\n\n#### 【数据规模与约定】\n\n**本题采用多测试点捆绑测试，共有 7 个子任务**。\n\n- Subtask 1（1 test case - 10 points）：$T\\le 10,q\\le 10$。\n- Subtask 2（1 test case - 10 points）：$T\\le 20,q\\le 20$。\n- Subtask 3（1 test case - 10 points）：$T= 100,q\\le 100$。\n- Subtask 4（1 test case - 10 points）：$T= 10^3,q\\le 10^4$。\n- Subtask 5（1 test case - 10 points）：$T= 10^3,q\\le 10^5$。\n- Subtask 6（1 test case - 10 points）：$T= 10^3,q\\le 10^6$。\n- Subtask 7（1 test case - 10 points）：$T= 10^3,q\\le 10^9$。\n- Subtask 8（1 test case - 10 points）：$T= 10^3,q\\le 10^{12}$。\n- Subtask 9（2 test case - 20 points）：无其他限制。\n\n对于所有数据，保证 $1\\le T\\le 10^3,1\\le q\\le 10^{18}$\n\n#### 【说明】\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem D. [Tower](https://www.ejoi2019.si/static/media/uploads/tasks/tower-isc.pdf)。\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2019] 塔", "background": "", "description": "Jernej 在晚上感到很无聊，于是他发明了一个游戏。他想要用数字卡片生成一个塔。一开始，他在一张卡片上写下了一个数字 $1$。\n\nJernej 可以再另一张写下一个新的数字并放在塔顶。 **这个新的数字必须等于之前塔中某一连续段的数字之和** 。也就是说，假设现在塔中已有 $n$ 个数字，你可以任意选取塔中的一段 $[l,u]$ ，并对这一段求和，将得到的新数字添加至塔顶，其中 $1\\le l\\le u\\le n$。\n\nJernej 想要生成 $T$ 个塔（相当于多组询问），每个塔顶都是 $T$ 个可能不同的他想要的数字。你需要帮助他求出生成这些塔的最小步数及其方案。", "inputFormat": "第一行：一个整数 $T$，表示塔的个数；\n\n接下来 $T$ 行，一行一个整数 $q$，表示现在 Jernej 想生成一个塔顶数字为 $q$ 的塔。\n\n保证有解。", "outputFormat": "对于每个询问 $q$：\n\n- 输出一行，包含一个整数 $s$ （$0\\le s\\le 10^3$），表示最小步数。\n- 接下来 $s$ 行，每行两个由空格隔开的整数 $l,u$，表示建生成塔的方案（操作时间早的先输出）。", "hint": "#### 【Special Judge 计分标准】\n\n本题共 $10$ 个测试点。对于每个测试点，计分规则如下：\n\n- 对于测试点中的任意一个塔，如果你的程序输出的 **最小步数** 与标准答案 **均一致** ，那么这个测试点你会得到 $10$ 分。\n- 对于测试点中的任意一个塔，如果你的程序输出的答案是错误的，那么得 $0$ 分（评测时如果发现输出不完全可能会得到 UKE）。\n- 如果你的答案并 **不是最优解但不是错误的** ，那么对于该测试点中的第 $i$ 个塔，你得到的分数为 $\\text{score}_i =1+\\dfrac{\\text{minimum steps}}{\\text{solution steps}}\\times 7$，其中 $\\text{minimum steps}$ 表示正确答案的最小步数，$\\text{solution steps}$ 表示你的程序输出的答案。最终这个测试点的得分为 $\\min\\limits_{i\\in [1,T]} \\{\\text{score}_i\\}$。向上取两位小数。\n\n#### 【输入输出样例解释】\n\n**询问 1 解释**：\n\n- Jernej 想要生成造一个塔顶数为 $2$ 的塔。起初塔为 $\\{1\\}$（左边表示塔底，右边表示塔顶）；\n- 第一步，选取子段 $[1,1]$，对 $\\{1\\}$ 中的所有元素求和，得到 $1$，现在塔为 $\\{1,1\\}$；\n- 第二步，选取子段 $[1,2]$，对 $\\{1,1\\}$ 中的所有元素求和，得到 $2$，现在塔为 $\\{1,1,2\\}$。此时已经达到了询问的要求。\n\n**询问 2 解释**：\n\n- 要生成塔顶为 $3$ 的塔不止一种方法。除了样例输出的一种之外，下面的也是正确答案：\n\n```plain\n1 1\n1 2\n2 3\n```\n\n#### 【数据规模与约定】\n\n**本题采用多测试点捆绑测试，共有 7 个子任务**。\n\n- Subtask 1（1 test case - 10 points）：$T\\le 10,q\\le 10$。\n- Subtask 2（1 test case - 10 points）：$T\\le 20,q\\le 20$。\n- Subtask 3（1 test case - 10 points）：$T= 100,q\\le 100$。\n- Subtask 4（1 test case - 10 points）：$T= 10^3,q\\le 10^4$。\n- Subtask 5（1 test case - 10 points）：$T= 10^3,q\\le 10^5$。\n- Subtask 6（1 test case - 10 points）：$T= 10^3,q\\le 10^6$。\n- Subtask 7（1 test case - 10 points）：$T= 10^3,q\\le 10^9$。\n- Subtask 8（1 test case - 10 points）：$T= 10^3,q\\le 10^{12}$。\n- Subtask 9（2 test case - 20 points）：无其他限制。\n\n对于所有数据，保证 $1\\le T\\le 10^3,1\\le q\\le 10^{18}$\n\n#### 【说明】\n\n原题来自：[eJOI2019](https://www.ejoi2019.si) Problem D. [Tower](https://www.ejoi2019.si/static/media/uploads/tasks/tower-isc.pdf)。\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN"}}}
{"pid": "P6242", "type": "P", "difficulty": 6, "samples": [["5 6\n1 2 3 4 5\n3 2 5\n1 1 3 3\n4 2 4\n2 3 4 1\n5 1 5\n3 1 4\n", "14\n6\n6\n11\n"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "O2优化", "吉司机线段树 segment tree beats", "模板题"], "title": "【模板】线段树 3（区间最值操作、区间历史最值）", "background": "本题是线段树维护区间最值操作与区间历史最值的模板。", "description": "给出一个长度为 $n$ 的数列 $A$，同时定义一个辅助数组 $B$，$B$ 开始与 $A$ 完全相同。接下来进行了 $m$ 次操作，操作有五种类型，按以下格式给出：\n\n- `1 l r k`：对于所有的 $i\\in[l,r]$，将 $A_i$ 加上 $k$（$k$ 可以为负数）。\n- `2 l r v`：对于所有的 $i\\in[l,r]$，将 $A_i$ 变成 $\\min(A_i,v)$。\n- `3 l r`：求 $\\sum_{i=l}^{r}A_i$。\n- `4 l r`：对于所有的 $i\\in[l,r]$，求 $A_i$ 的最大值。\n- `5 l r`：对于所有的 $i\\in[l,r]$，求 $B_i$ 的最大值。\n\n在每一次操作后，我们都进行一次更新，让 $B_i\\gets\\max(B_i,A_i)$。\n", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示数列 $A$ 的长度和操作次数。\n\n第二行包含 $n$ 个整数 $A_1,A_2,\\cdots,A_n$，表示数列 $A$。\n\n接下来 $m$ 行，每行行首有一个整数 $op$，表示操作类型；接下来两个或三个整数表示操作参数，格式见【题目描述】。\n", "outputFormat": "对于 $op\\in\\{3,4,5\\}$ 的操作，输出一行包含一个整数，表示这个询问的答案。\n", "hint": "#### 样例说明 \\#1 ####\n\n| 操作次数 | 输入内容 | 操作 | 数列 | 输出结果 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 0 |  |  | $1,2,3,4,5$ |  |\n| 1 | `3 2 5` | 求出 $[2,5]$ 所有数的和 | $1,2,3,4,5$ | `14` |\n| 2 | `1 1 3 3` | 将 $[1,3]$ 内所有数加 $3$ | $4,5,6,4,5$ |  |\n| 3 | `4 2 4` | 求出 $[2,4]$ 所有数的最大值 | $4,5,6,4,5$ | `6` |\n| 4 | `2 3 4 1` | 将 $[3,4]$ 所有数与 $1$ 取最小值 | $4,5,1,1,5$ |  |\n| 5 | `5 1 5` | 求出 $[1,5]$ 所有位置历史最大值的最大值 | $4,5,1,1,5$ | `6` |\n| 6 | `3 1 4` | 求出 $[1,4]$ 所有数的和 | $4,5,1,1,5$ | `11` |\n\n#### 数据规模与约定\n\n- 对于测试点 $1,2$，满足 $n,m\\leq 5000$；\n- 对于测试点 $3,4$，满足 $op\\in\\{1,2,3,4\\}$；\n- 对于测试点 $5,6$，满足 $op\\in\\{1,3,4,5\\}$；\n- 对于全部测试数据，保证 $1\\leq n,m\\leq 5\\times 10^5$，$-5\\times10^8\\leq A_i\\leq 5\\times10^8$，$op\\in[1,5]$，$1 \\leq l\\leq r \\leq n$，$-2000\\leq k\\leq 2000$，$-5\\times10^8\\leq v\\leq 5\\times10^8$。\n\n#### 提示 ####\n\n本题输入量较大，请使用合理高效的读入方法。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】线段树 3（区间最值操作、区间历史最值）", "background": "本题是线段树维护区间最值操作与区间历史最值的模板。", "description": "给出一个长度为 $n$ 的数列 $A$，同时定义一个辅助数组 $B$，$B$ 开始与 $A$ 完全相同。接下来进行了 $m$ 次操作，操作有五种类型，按以下格式给出：\n\n- `1 l r k`：对于所有的 $i\\in[l,r]$，将 $A_i$ 加上 $k$（$k$ 可以为负数）。\n- `2 l r v`：对于所有的 $i\\in[l,r]$，将 $A_i$ 变成 $\\min(A_i,v)$。\n- `3 l r`：求 $\\sum_{i=l}^{r}A_i$。\n- `4 l r`：对于所有的 $i\\in[l,r]$，求 $A_i$ 的最大值。\n- `5 l r`：对于所有的 $i\\in[l,r]$，求 $B_i$ 的最大值。\n\n在每一次操作后，我们都进行一次更新，让 $B_i\\gets\\max(B_i,A_i)$。\n", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示数列 $A$ 的长度和操作次数。\n\n第二行包含 $n$ 个整数 $A_1,A_2,\\cdots,A_n$，表示数列 $A$。\n\n接下来 $m$ 行，每行行首有一个整数 $op$，表示操作类型；接下来两个或三个整数表示操作参数，格式见【题目描述】。\n", "outputFormat": "对于 $op\\in\\{3,4,5\\}$ 的操作，输出一行包含一个整数，表示这个询问的答案。\n", "hint": "#### 样例说明 \\#1 ####\n\n| 操作次数 | 输入内容 | 操作 | 数列 | 输出结果 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 0 |  |  | $1,2,3,4,5$ |  |\n| 1 | `3 2 5` | 求出 $[2,5]$ 所有数的和 | $1,2,3,4,5$ | `14` |\n| 2 | `1 1 3 3` | 将 $[1,3]$ 内所有数加 $3$ | $4,5,6,4,5$ |  |\n| 3 | `4 2 4` | 求出 $[2,4]$ 所有数的最大值 | $4,5,6,4,5$ | `6` |\n| 4 | `2 3 4 1` | 将 $[3,4]$ 所有数与 $1$ 取最小值 | $4,5,1,1,5$ |  |\n| 5 | `5 1 5` | 求出 $[1,5]$ 所有位置历史最大值的最大值 | $4,5,1,1,5$ | `6` |\n| 6 | `3 1 4` | 求出 $[1,4]$ 所有数的和 | $4,5,1,1,5$ | `11` |\n\n#### 数据规模与约定\n\n- 对于测试点 $1,2$，满足 $n,m\\leq 5000$；\n- 对于测试点 $3,4$，满足 $op\\in\\{1,2,3,4\\}$；\n- 对于测试点 $5,6$，满足 $op\\in\\{1,3,4,5\\}$；\n- 对于全部测试数据，保证 $1\\leq n,m\\leq 5\\times 10^5$，$-5\\times10^8\\leq A_i\\leq 5\\times10^8$，$op\\in[1,5]$，$1 \\leq l\\leq r \\leq n$，$-2000\\leq k\\leq 2000$，$-5\\times10^8\\leq v\\leq 5\\times10^8$。\n\n#### 提示 ####\n\n本题输入量较大，请使用合理高效的读入方法。\n", "locale": "zh-CN"}}}
{"pid": "P6243", "type": "P", "difficulty": 6, "samples": [["3\n2 2\n7 4\n3 5", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2006", "USACO"], "title": "[USACO06OPEN] The Milk Queue G", "background": "题目是经过简写保证不改变原有题意的题目。", "description": "每早，FJ 的 $N$ 头奶牛都排成一列挤奶．一个个进到仓库，为提高速率，FJ 把整个挤奶过程划分成两道工序，FJ负责实行第一道，第二道由 Rob 完成。\n\n如果某头牛先于另一头牛开始进行第一道工序，那么她同样先开始第二道工序。\n\nFJ 发现，如果奶牛们按某种顺序排队进行挤奶，那么可能会在排队等待上多花很多的时间。比如，如果 FJ 要花很长时间才能完成某头奶牛的第一道工序，那么 Rob 就会浪费一段时间。反之如果 FJ 的工作完成得太快，Rob 面前会有很多奶牛排起长队。\n\n请你计算按最优方式排队后最少需要多少时间才能挤完奶。对于每头奶牛，数据提供第一道工序的时间 $A_i$ 和第二道工序的时间 $B_i$。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行两个整数表示第 $i$ 头牛的 $A_i$，$B_i$ 值。", "outputFormat": "输出按最优方案排队后挤奶所需的最短时间。", "hint": "#### 样例说明\n\n把奶牛们按照 3，1，2  的顺序排队，这样挤奶总共花费 16 个单位时间．\n\n$1\\le N\\le 25000$\n\n$1\\le A_i,B_i\\le 2\\times 10^4$\n\n2025-06-03: 增加了一组 hack 数据", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OPEN] The Milk Queue G", "background": "题目是经过简写保证不改变原有题意的题目。", "description": "每早，FJ 的 $N$ 头奶牛都排成一列挤奶．一个个进到仓库，为提高速率，FJ 把整个挤奶过程划分成两道工序，FJ负责实行第一道，第二道由 Rob 完成。\n\n如果某头牛先于另一头牛开始进行第一道工序，那么她同样先开始第二道工序。\n\nFJ 发现，如果奶牛们按某种顺序排队进行挤奶，那么可能会在排队等待上多花很多的时间。比如，如果 FJ 要花很长时间才能完成某头奶牛的第一道工序，那么 Rob 就会浪费一段时间。反之如果 FJ 的工作完成得太快，Rob 面前会有很多奶牛排起长队。\n\n请你计算按最优方式排队后最少需要多少时间才能挤完奶。对于每头奶牛，数据提供第一道工序的时间 $A_i$ 和第二道工序的时间 $B_i$。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行两个整数表示第 $i$ 头牛的 $A_i$，$B_i$ 值。", "outputFormat": "输出按最优方案排队后挤奶所需的最短时间。", "hint": "#### 样例说明\n\n把奶牛们按照 3，1，2  的顺序排队，这样挤奶总共花费 16 个单位时间．\n\n$1\\le N\\le 25000$\n\n$1\\le A_i,B_i\\le 2\\times 10^4$\n\n2025-06-03: 增加了一组 hack 数据", "locale": "zh-CN"}}}
{"pid": "P6244", "type": "P", "difficulty": 2, "samples": [["7\n1 6\n8 6\n14 5\n19 2\n1 8\n18 3\n10 6", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2006", "USACO"], "title": "[USACO06OPEN] County Fair Events S", "background": "题目是经过简写保证不改变原有题意的题目。", "description": "FJ 参加活动。 \n\n他想参加尽可能多的 $N$ 个活动，参加完某个之后可以立刻参加下一个。 \n\n给定 FJ 可参加的活动列表、其开始时间 $T$ 和持续时间 $L$ ，求 FJ 可以参加的最大活动数。 \n\nFJ 每个活动都不会提早离开。", "inputFormat": "第一行有一个整数 $N$。\n\n第二到 $N+1$ 行：每行包含两个用空格分隔的整数 $T$ 和 $L$ ，意义如上述。", "outputFormat": "输出仅一行，FJ 最多能参加几个活动。", "hint": "$1\\le T,L\\le 10^5$\n\n$1\\le N\\le 10^4$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OPEN] County Fair Events S", "background": "题目是经过简写保证不改变原有题意的题目。", "description": "FJ 参加活动。 \n\n他想参加尽可能多的 $N$ 个活动，参加完某个之后可以立刻参加下一个。 \n\n给定 FJ 可参加的活动列表、其开始时间 $T$ 和持续时间 $L$ ，求 FJ 可以参加的最大活动数。 \n\nFJ 每个活动都不会提早离开。", "inputFormat": "第一行有一个整数 $N$。\n\n第二到 $N+1$ 行：每行包含两个用空格分隔的整数 $T$ 和 $L$ ，意义如上述。", "outputFormat": "输出仅一行，FJ 最多能参加几个活动。", "hint": "$1\\le T,L\\le 10^5$\n\n$1\\le N\\le 10^4$", "locale": "zh-CN"}}}
{"pid": "P6245", "type": "P", "difficulty": 3, "samples": [["3000 5\n600 800\n1600 1800\n100 1300\n300 2100\n1600 2300", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2006", "USACO"], "title": "[USACO06OPEN] The Climbing Wall S", "background": "题目是经过简写保证不改变原有题意的题目。", "description": "Bessie 要爬墙，墙宽 $30000$ ，高 $H$，墙上有 $F$ 个不同的落脚点 $(X,Y)$。\n\n$(0,0)$ 在左下角的地面。任意落脚点至少相距 $300$。至少有一条路可以上去，Bessie 每次最多爬 $1000$ 个单位距离，且可以向任意方向爬行。\n\n一旦她到达了一个高度距离 $H$ 不到 $1000$ 的落脚点，可以直接到墙顶。Bessie 的起点可以在任一高度不超过 $1000$ 的落脚点上。问Bessi爬到顶端的最少次数。\n\n本题距离指**欧几里得距离**。", "inputFormat": "第一行有两个以空格分隔的整数 $H$ 和 $F$ 。\n\n第二到 $F+1$ 行，每行是落脚点的坐标 $(X,Y)$，$X$ 是距攀岩墙左边的距离，$Y$ 是离地面的距离。", "outputFormat": "输出仅一个整数，Bessie 到达攀岩墙顶部所需的最少步数。", "hint": "#### 样例说明\n\n分别经过 $(600,800),(100,1300),(300,2100)$。\n\n$1001\\le H\\le 3\\times 10^4$\n\n$1\\le F\\le 10^4$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OPEN] The Climbing Wall S", "background": "题目是经过简写保证不改变原有题意的题目。", "description": "Bessie 要爬墙，墙宽 $30000$ ，高 $H$，墙上有 $F$ 个不同的落脚点 $(X,Y)$。\n\n$(0,0)$ 在左下角的地面。任意落脚点至少相距 $300$。至少有一条路可以上去，Bessie 每次最多爬 $1000$ 个单位距离，且可以向任意方向爬行。\n\n一旦她到达了一个高度距离 $H$ 不到 $1000$ 的落脚点，可以直接到墙顶。Bessie 的起点可以在任一高度不超过 $1000$ 的落脚点上。问Bessi爬到顶端的最少次数。\n\n本题距离指**欧几里得距离**。", "inputFormat": "第一行有两个以空格分隔的整数 $H$ 和 $F$ 。\n\n第二到 $F+1$ 行，每行是落脚点的坐标 $(X,Y)$，$X$ 是距攀岩墙左边的距离，$Y$ 是离地面的距离。", "outputFormat": "输出仅一个整数，Bessie 到达攀岩墙顶部所需的最少步数。", "hint": "#### 样例说明\n\n分别经过 $(600,800),(100,1300),(300,2100)$。\n\n$1001\\le H\\le 3\\times 10^4$\n\n$1\\le F\\le 10^4$", "locale": "zh-CN"}}}
{"pid": "P6246", "type": "P", "difficulty": 7, "samples": [["5 2\n0 1 2 3 4", "3"]], "limits": {"time": [2000, 3000, 4000, 6000, 6000], "memory": [256000, 256000, 256000, 256000, 256000]}, "tags": ["2000", "二分", "IOI", "O2优化", "斜率优化", "凸完全单调性（wqs 二分）", "栈", "队列"], "title": "[IOI 2000] 邮局 加强版 加强版", "background": "> 看到你时总是感觉清风徐徐,\n>\n> 本以为和你相识不会是偶遇,\n>\n> 奈何你犹如过客、化作秋雨,  \n>\n> 只是经过我生命的一瓢柳絮,\n>\n> 从不会真正有童话似的结局.\n>\n> 我静静地写尽这些躁言丑句,\n> \n> 本以为可以稍稍地缓解抑郁.\n>\n> 却是徒增一场悲伤的脑补剧.\n>\n> 你问我为什么说这么多?\n>\n> 因为这题是加强版的 [IOI2000]邮局.", "description": "高速公路旁边有 $n$ 个村庄。高速公路表示为整数轴，每个村庄的位置用单个整数坐标表示。两个位置之间的距离是其整数坐标差的绝对值。\n\n现在要建立  $m$ 个邮局，邮局将建在一些，但不一定是所有的村庄中。为了建立邮局，应选择他们建造的位置，使每个村庄与其最近的邮局之间的距离总和最小。\n\n你要编写一个程序，已知村庄的位置和邮局的数量，计算每个村庄和最近的邮局之间所有距离的最小可能的总和。", "inputFormat": "第一行包含两个整数，分别表示村庄的数量 $n$ 和邮局的数量 $m$。\n\n第二行共 $n$ 个整数，表示每个村庄的坐标，第 $i$ 个整数表示第 $i$ 个村庄的坐标 $a_i$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n\n本题共五个测试点，各测试点信息如下：\n\n| 测试点编号 | $n = $ | $a_i \\leq $ |\n| :----------: | :-------: | :----: |\n| 1 | $50000$ | $6 \\times 10^4$ |\n| 2 | $150000$ | $2 \\times 10^5$ |\n| 3 | $299998$ | $5 \\times 10^5$ |\n| 4 | $499998$ | $10^6$ |\n| 5 | $499999$ | $2\\times 10^6$ |\n\n对于全部的测试点，保证 $1 \\leq m \\leq n \\leq 5 \\times 10^5$，$0 \\leq a_i \\leq 2\\times 10^6$，且 $a_i$ 的值在对应范围内均匀随机。\n\n保证最终答案不超过 $10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[IOI 2000] 邮局 加强版 加强版", "background": "> 看到你时总是感觉清风徐徐,\n>\n> 本以为和你相识不会是偶遇,\n>\n> 奈何你犹如过客、化作秋雨,  \n>\n> 只是经过我生命的一瓢柳絮,\n>\n> 从不会真正有童话似的结局.\n>\n> 我静静地写尽这些躁言丑句,\n> \n> 本以为可以稍稍地缓解抑郁.\n>\n> 却是徒增一场悲伤的脑补剧.\n>\n> 你问我为什么说这么多?\n>\n> 因为这题是加强版的 [IOI2000]邮局.", "description": "高速公路旁边有 $n$ 个村庄。高速公路表示为整数轴，每个村庄的位置用单个整数坐标表示。两个位置之间的距离是其整数坐标差的绝对值。\n\n现在要建立  $m$ 个邮局，邮局将建在一些，但不一定是所有的村庄中。为了建立邮局，应选择他们建造的位置，使每个村庄与其最近的邮局之间的距离总和最小。\n\n你要编写一个程序，已知村庄的位置和邮局的数量，计算每个村庄和最近的邮局之间所有距离的最小可能的总和。", "inputFormat": "第一行包含两个整数，分别表示村庄的数量 $n$ 和邮局的数量 $m$。\n\n第二行共 $n$ 个整数，表示每个村庄的坐标，第 $i$ 个整数表示第 $i$ 个村庄的坐标 $a_i$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n\n本题共五个测试点，各测试点信息如下：\n\n| 测试点编号 | $n = $ | $a_i \\leq $ |\n| :----------: | :-------: | :----: |\n| 1 | $50000$ | $6 \\times 10^4$ |\n| 2 | $150000$ | $2 \\times 10^5$ |\n| 3 | $299998$ | $5 \\times 10^5$ |\n| 4 | $499998$ | $10^6$ |\n| 5 | $499999$ | $2\\times 10^6$ |\n\n对于全部的测试点，保证 $1 \\leq m \\leq n \\leq 5 \\times 10^5$，$0 \\leq a_i \\leq 2\\times 10^6$，且 $a_i$ 的值在对应范围内均匀随机。\n\n保证最终答案不超过 $10^9$。", "locale": "zh-CN"}}}
{"pid": "P6247", "type": "P", "difficulty": 6, "samples": [["4\n0.0 0.0\n0.0 1.0\n1.0 0.0\n1.0 1.0", "1.00 1.41"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "山东", "Special Judge", "分治", "凸包", "K-D Tree"], "title": "[SDOI2012] 最近最远点对", "background": "", "description": "给定平面直角坐标系上的 $n$ 个点，分别求出距离最近的两个点的距离和距离最远的两个点的距离。注意，距离为直线距离。", "inputFormat": "第一行一个整数，$n$。\n接下来 $n$ 行每行两个非负浮点数，$x_i$,$y_i$，表示第 $i$ 个点的 X 坐标与 Y 坐标。", "outputFormat": "总共一行，两个浮点数，为最短距离与最长距离。误差不超过 $0.01$ 视为正确。", "hint": "- 对于 $30\\%$ 的数据，$n\\leq 2000$；\n- 对于 $70\\%$ 的数据，$n\\leq 20000$；\n- 对于 $100\\%$ 的数据，$0 \\lt n\\leq 10^5$，输入数据中所有数均为不超过 $10^9$ 的非负数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SDOI2012] 最近最远点对", "background": "", "description": "给定平面直角坐标系上的 $n$ 个点，分别求出距离最近的两个点的距离和距离最远的两个点的距离。注意，距离为直线距离。", "inputFormat": "第一行一个整数，$n$。\n接下来 $n$ 行每行两个非负浮点数，$x_i$,$y_i$，表示第 $i$ 个点的 X 坐标与 Y 坐标。", "outputFormat": "总共一行，两个浮点数，为最短距离与最长距离。误差不超过 $0.01$ 视为正确。", "hint": "- 对于 $30\\%$ 的数据，$n\\leq 2000$；\n- 对于 $70\\%$ 的数据，$n\\leq 20000$；\n- 对于 $100\\%$ 的数据，$0 \\lt n\\leq 10^5$，输入数据中所有数均为不超过 $10^9$ 的非负数。", "locale": "zh-CN"}}}
{"pid": "P6248", "type": "P", "difficulty": 3, "samples": [["7 0\nSigma 10\nOrisa 10\nMei 10\nReaper 10\nMoira 10\nLucio 10\nDoomfist 1", "60"], ["8 2\nPharah 5\nMercy 5\nReinhardt 10\nDVA 10\nSOLDIER:76 12\nTorbjorn 5\nAnna 8\nBaptiste 10\nPharah Mercy 20\nAnna Pharah 5", "75"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["枚举", "深度优先搜索 DFS", "进制"], "title": "准备战斗，选择你的英雄", "background": "zjf，被 NOIP 普及组初赛戏耍，pj 1= -> 初赛三等，愤恨地离开了 OI，深陷中考的泥潭当中。据说，他颓废是因为玩多了 [OW](https://ow.blizzard.cn/home) 这款游戏。", "description": "目前，游戏共有 $31$ 个英雄，每局可以派 $6$ 个英雄上场。实际能使用的英雄数将会小于 $31$。简单地假设，每位英雄对团队的贡献可以用一个正整数 $v_i$ 表示。团队的总能力等于所有英雄的贡献之和。特别地，对于 $m$ 组特定的英雄，他们一起出现会让团队总能力提高 $x_i$。\n\n**另注：英雄组合可以重复，若重复请多次计数。**", "inputFormat": "第一行两个整数 $n$，$m$，表示可选英雄个数和特定的组合数。  \n接下来 $n$ 行，每行先给出第 $i$ 个英雄的名字，然后再输入一个整数 $v_i$。  \n接下来 $m$ 行，每行两个字符串 $a$，$b$ 和一个整数 $x_i$，表示若英雄 $a$ 和英雄 $b$ 一起出现时总能力提高 $x_i$。  \n**保证：$a$ 和 $b$ 不是同一个英雄。**\n\n", "outputFormat": "一个整数，表示团队能力值的最大值。", "hint": "#### 样例 1 解释\n我们应该选择前 $6$ 名英雄。\n\n---\n\n#### 样例 2 解释\n我们应该选择 Pharah、Mercy、Reinhardt、DVA、SOLDIER:76、Anna\n\n---\n\n#### 数据范围\n对于 $40\\%$ 的数据，$m=0$。  \n对于 $100\\%$ 的数据，$6\\le n \\le 30$，$0\\le m \\le 30$，*$1\\le x_i,v_i \\le 100$*，英雄名字长度 $\\le 10$，字符集包括大小写字母、数字以及冒号（ `:` ）。每个英雄的名字各不相同。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "准备战斗，选择你的英雄", "background": "zjf，被 NOIP 普及组初赛戏耍，pj 1= -> 初赛三等，愤恨地离开了 OI，深陷中考的泥潭当中。据说，他颓废是因为玩多了 [OW](https://ow.blizzard.cn/home) 这款游戏。", "description": "目前，游戏共有 $31$ 个英雄，每局可以派 $6$ 个英雄上场。实际能使用的英雄数将会小于 $31$。简单地假设，每位英雄对团队的贡献可以用一个正整数 $v_i$ 表示。团队的总能力等于所有英雄的贡献之和。特别地，对于 $m$ 组特定的英雄，他们一起出现会让团队总能力提高 $x_i$。\n\n**另注：英雄组合可以重复，若重复请多次计数。**", "inputFormat": "第一行两个整数 $n$，$m$，表示可选英雄个数和特定的组合数。  \n接下来 $n$ 行，每行先给出第 $i$ 个英雄的名字，然后再输入一个整数 $v_i$。  \n接下来 $m$ 行，每行两个字符串 $a$，$b$ 和一个整数 $x_i$，表示若英雄 $a$ 和英雄 $b$ 一起出现时总能力提高 $x_i$。  \n**保证：$a$ 和 $b$ 不是同一个英雄。**\n\n", "outputFormat": "一个整数，表示团队能力值的最大值。", "hint": "#### 样例 1 解释\n我们应该选择前 $6$ 名英雄。\n\n---\n\n#### 样例 2 解释\n我们应该选择 Pharah、Mercy、Reinhardt、DVA、SOLDIER:76、Anna\n\n---\n\n#### 数据范围\n对于 $40\\%$ 的数据，$m=0$。  \n对于 $100\\%$ 的数据，$6\\le n \\le 30$，$0\\le m \\le 30$，*$1\\le x_i,v_i \\le 100$*，英雄名字长度 $\\le 10$，字符集包括大小写字母、数字以及冒号（ `:` ）。每个英雄的名字各不相同。\n", "locale": "zh-CN"}}}
{"pid": "P6249", "type": "P", "difficulty": 4, "samples": [["5\n-5 1 5\n-3 1 5\n-1 1 5\n1 1 5\n3 2 5\n", "4"], ["5\n-5 2 5\n-3 1 5\n-1 1 5\n1 0 5\n3 4 5\n", "5"], ["5\n1 1 1\n2 1 2\n3 1 3\n4 1 5\n-5 5 5\n", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "神帖", "background": "zrl 的生日在 3.14。出生在神帖迭起的日子，他的快乐自然很多。这不，他又要收取来着神帖的馈赠了。", "description": "神帖分布在讨论区的一些页面上，每个页面最多有一个神帖。假设他正在浏览的页面设为 $0$ 号页面。向左一页为 $-1$ 号页面，向右一页为 $1$ 号页面，以此类推。第 $i$ 个神帖在 $x_i$ 号页面上，并且有特定的封禁的时间 $t_i$ 和快乐值 $v_i$，超过了这个时间 $t_i$ 浏览就不能得到他的快乐值了。zrl 向左或向右翻一页需要 $1$ 单位时间，浏览神帖不需要时间。问：zrl 最多能得到多少快乐值。\n\n注：在 $t_i$ 个单位时间浏览第 $i$ 个神贴仍能得到 $v_i$ 的快乐值。\n\n**另注：每个神帖的快乐值最多只能得到一次。**", "inputFormat": "第一行一个整数 $n$，表示神帖数量。\n\n接下来 $n$ 行，每行三个整数，分别表示第 $i$ 个神帖的 $x_i$，$v_i$，$t_i$。", "outputFormat": "一个整数，为 zrl 能得到的最多的快乐值。", "hint": "#### 样例解释：\n\n样例 1：$0 \\rightarrow -1 \\rightarrow 0 \\rightarrow 1 \\rightarrow 2 \\rightarrow 3$  \n样例 2：$0 \\rightarrow -1 \\rightarrow 0 \\rightarrow 1 \\rightarrow 2 \\rightarrow 3$  \n样例 3：$0 \\rightarrow -1 \\rightarrow -2 \\rightarrow -3 \\rightarrow -4 \\rightarrow -5$ \n\n---\n\n#### 数据范围：\n\n| 测试点 | 特殊性质 |\n| :-----------: | :-----------: |\n| $1-2$ | $x_i \\ge 0$ |\n| $3-4$ | $0 \\le t_i \\le 20$ |\n| $5-6$ | $n \\le 20$ |\n| $7$ | $-10 \\le x_i \\le 10$ |\n| $8-9$ | $t_i=$\\|$x_i$\\| |\n| $10-13$ | 所有 $t_i$ 均相等 |\n| $14-17$ | $n \\le 60$ |\n| $17-22$ | 无 |\n\n对于 $100\\%$ 的数据，$n \\le 200$，$-500 \\le x_i \\le 500$，$0 \\le v_i \\le 10^9$，$0\\le t_i \\le 500$。\n\nHint：新增两组 Hack 数据，贪心/模拟已经过不去了。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "神帖", "background": "zrl 的生日在 3.14。出生在神帖迭起的日子，他的快乐自然很多。这不，他又要收取来着神帖的馈赠了。", "description": "神帖分布在讨论区的一些页面上，每个页面最多有一个神帖。假设他正在浏览的页面设为 $0$ 号页面。向左一页为 $-1$ 号页面，向右一页为 $1$ 号页面，以此类推。第 $i$ 个神帖在 $x_i$ 号页面上，并且有特定的封禁的时间 $t_i$ 和快乐值 $v_i$，超过了这个时间 $t_i$ 浏览就不能得到他的快乐值了。zrl 向左或向右翻一页需要 $1$ 单位时间，浏览神帖不需要时间。问：zrl 最多能得到多少快乐值。\n\n注：在 $t_i$ 个单位时间浏览第 $i$ 个神贴仍能得到 $v_i$ 的快乐值。\n\n**另注：每个神帖的快乐值最多只能得到一次。**", "inputFormat": "第一行一个整数 $n$，表示神帖数量。\n\n接下来 $n$ 行，每行三个整数，分别表示第 $i$ 个神帖的 $x_i$，$v_i$，$t_i$。", "outputFormat": "一个整数，为 zrl 能得到的最多的快乐值。", "hint": "#### 样例解释：\n\n样例 1：$0 \\rightarrow -1 \\rightarrow 0 \\rightarrow 1 \\rightarrow 2 \\rightarrow 3$  \n样例 2：$0 \\rightarrow -1 \\rightarrow 0 \\rightarrow 1 \\rightarrow 2 \\rightarrow 3$  \n样例 3：$0 \\rightarrow -1 \\rightarrow -2 \\rightarrow -3 \\rightarrow -4 \\rightarrow -5$ \n\n---\n\n#### 数据范围：\n\n| 测试点 | 特殊性质 |\n| :-----------: | :-----------: |\n| $1-2$ | $x_i \\ge 0$ |\n| $3-4$ | $0 \\le t_i \\le 20$ |\n| $5-6$ | $n \\le 20$ |\n| $7$ | $-10 \\le x_i \\le 10$ |\n| $8-9$ | $t_i=$\\|$x_i$\\| |\n| $10-13$ | 所有 $t_i$ 均相等 |\n| $14-17$ | $n \\le 60$ |\n| $17-22$ | 无 |\n\n对于 $100\\%$ 的数据，$n \\le 200$，$-500 \\le x_i \\le 500$，$0 \\le v_i \\le 10^9$，$0\\le t_i \\le 500$。\n\nHint：新增两组 Hack 数据，贪心/模拟已经过不去了。", "locale": "zh-CN"}}}
{"pid": "P6250", "type": "P", "difficulty": 5, "samples": [["3\n1\n2\n5", "YES\n1\n1 1\nNO\nYES\n3\n1 5\n2 1\n2 -1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "Special Judge"], "title": "分拆", "background": "小 W 喜欢分拆。", "description": "小 W 定义了一种「良好的分拆」：\n\n对于正整数 $n$，如果存在 $n$ 个整数 $(a_1,a_2,\\cdots,a_n)$ 使得 $\\sum\\limits_{i=1}^na_i=\\prod\\limits_{i=1}^na_i=n$，那么称 $n$ 是「良好的」，而 $(a_1,a_2,\\cdots,a_n)$ 是 $n$ 的一个「良好的分拆」。\n\n现在，小 W 给了你一些 $n$，他希望你求出这些 $n$ 分别是不是「良好的」。如果是良好的，请**任意**输出一个 $n$ 的「良好的分拆」。", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一个整数 $n$，表示小 W 的一个询问。", "outputFormat": "对于每组数据，输出若干行。\n\n如果 $n$ 不是「良好的」，那么仅输出一行 `NO`；\n\n否则，第一行输出 `YES`，接下来一行一个数 $a$，表示你的「良好的分拆」中有多少种不同的数，接下来 $a$ 行，每行两个数 $x,y$，表示有 $x$ 个 $y$。", "hint": "## 样例解释\n$n=1$ 时，$(1)$ 是 $1$ 的一个「良好的分拆」；\n\n$n=2$ 时，$2$ 没有「良好的分拆」；\n\n$n=5$ 时，$5+1+1+(-1)+(-1)=5\\times1\\times1\\times(-1)\\times(-1)=5$，所以 $(5,1,1,-1,-1)$ 是 $5$ 的一个「良好的分拆」。\n## 数据范围\n**本题不捆绑测试。**  \n$\\text{Subtask\\;1(10\\;pts)}$：$n=1,T=1000$；  \n$\\text{Subtask\\;2(30\\;pts)}$：$n\\le 10^4,T=100$；  \n$\\text{Subtask\\;3(60\\;pts)}$：$T=1000$。  \n对于所有数据，$1\\le n\\le10^9$。\n## 说明\n本题带有 $\\text{SPJ}$。\n\n某个测试点获得满分，当且仅当对于这个测试点的所有 $T$ 组数据，有：\n- 第一行的答案相同。\n- 如果第一行的答案为 `YES`，则还要满足 $1\\le a\\le 20$，$1\\le x\\le n$，$\\sum y\\times x=\\prod y^x=\\sum x=n$。\n\n**为了便于 $\\text{SPJ}$ 的编写，允许有的 $y$ 相同，同时请确保在输出文件末尾有且仅有一个换行。**\n\n$\\text{SPJ}$ 源码请到[云剪贴板](https://www.luogu.com.cn/paste/tlhjg36n)查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "分拆", "background": "小 W 喜欢分拆。", "description": "小 W 定义了一种「良好的分拆」：\n\n对于正整数 $n$，如果存在 $n$ 个整数 $(a_1,a_2,\\cdots,a_n)$ 使得 $\\sum\\limits_{i=1}^na_i=\\prod\\limits_{i=1}^na_i=n$，那么称 $n$ 是「良好的」，而 $(a_1,a_2,\\cdots,a_n)$ 是 $n$ 的一个「良好的分拆」。\n\n现在，小 W 给了你一些 $n$，他希望你求出这些 $n$ 分别是不是「良好的」。如果是良好的，请**任意**输出一个 $n$ 的「良好的分拆」。", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一个整数 $n$，表示小 W 的一个询问。", "outputFormat": "对于每组数据，输出若干行。\n\n如果 $n$ 不是「良好的」，那么仅输出一行 `NO`；\n\n否则，第一行输出 `YES`，接下来一行一个数 $a$，表示你的「良好的分拆」中有多少种不同的数，接下来 $a$ 行，每行两个数 $x,y$，表示有 $x$ 个 $y$。", "hint": "## 样例解释\n$n=1$ 时，$(1)$ 是 $1$ 的一个「良好的分拆」；\n\n$n=2$ 时，$2$ 没有「良好的分拆」；\n\n$n=5$ 时，$5+1+1+(-1)+(-1)=5\\times1\\times1\\times(-1)\\times(-1)=5$，所以 $(5,1,1,-1,-1)$ 是 $5$ 的一个「良好的分拆」。\n## 数据范围\n**本题不捆绑测试。**  \n$\\text{Subtask\\;1(10\\;pts)}$：$n=1,T=1000$；  \n$\\text{Subtask\\;2(30\\;pts)}$：$n\\le 10^4,T=100$；  \n$\\text{Subtask\\;3(60\\;pts)}$：$T=1000$。  \n对于所有数据，$1\\le n\\le10^9$。\n## 说明\n本题带有 $\\text{SPJ}$。\n\n某个测试点获得满分，当且仅当对于这个测试点的所有 $T$ 组数据，有：\n- 第一行的答案相同。\n- 如果第一行的答案为 `YES`，则还要满足 $1\\le a\\le 20$，$1\\le x\\le n$，$\\sum y\\times x=\\prod y^x=\\sum x=n$。\n\n**为了便于 $\\text{SPJ}$ 的编写，允许有的 $y$ 相同，同时请确保在输出文件末尾有且仅有一个换行。**\n\n$\\text{SPJ}$ 源码请到[云剪贴板](https://www.luogu.com.cn/paste/tlhjg36n)查看。", "locale": "zh-CN"}}}
{"pid": "P6251", "type": "P", "difficulty": 4, "samples": [["4\n3 2 1 2\n2 3 4 3\n2 1 2 1\n2 2 1 3", "3 2 4 1\n4 2 1 3"], ["2\n1 2\n2 3\n2 8\n2 1", "impossible"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "Special Judge", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Azulejos", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "Ceramic artists Maria and João are opening a small azulejo store in Porto. Azulejos are the beautiful ceramic tiles for which Portugal is famous. Maria and João want to create an attractive window display, but, due to limited space in their shop, they must arrange their tile samples in two rows on a single shelf. Each of João's tiles has exactly one of Maria's tiles in front of it and each of Maria's tiles has exactly one of João's tiles behind it. These hand-crafted tiles are of many different sizes, and it is important that each tile in the back row is taller than the tile in front of it so that both are visible to passers-by. For the convenience of shoppers, tiles in each row are arranged in non-decreasing order of price from left to right. Tiles of the same price may be arranged in any order subject to the visibility condition stated above.\n\nYour task is to find an ordering of the tiles in each row that satisfies these constraints, or determine that no such ordering exists.", "inputFormat": "The first line of input contains an integer $n$ ($1 \\leq n \\leq 5 \\times 10^5$), the number of tiles in each row. The next four lines contain $n$ integers each; the first pair of lines represents the back row of tiles and the second pair of lines represents the front row. Tiles in each row are numbered from $1$ to $n$ according to their ordering in the input. The first line in each pair contains $n$ integers $p_1, \\dots , p_n$ ($1 \\leq p_i \\leq 10^9$ for each $i$), where $p_i$ is the price of tile number $i$ in that row. The second line in each pair contains $n$ integers $h_1, \\dots , h_n$ ($1 \\leq h_i \\leq 10^9$ for each $i$), where $h_i$ is the height of tile number $i$ in that row.", "outputFormat": "If there is a valid ordering, output it as two lines of $n$ integers, each consisting of a permutation of the tile numbers from $1$ to $n$. The first line represents the ordering of the tiles in the back row and the second\nrepresents the ordering of the tiles in the front row. If more than one pair of permutations satisfies the constraints, any such pair will be accepted. If no ordering exists, output `impossible`.", "hint": "Source: ICPC 2019 World Finals.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Azulejos", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "Ceramic artists Maria and João are opening a small azulejo store in Porto. Azulejos are the beautiful ceramic tiles for which Portugal is famous. Maria and João want to create an attractive window display, but, due to limited space in their shop, they must arrange their tile samples in two rows on a single shelf. Each of João's tiles has exactly one of Maria's tiles in front of it and each of Maria's tiles has exactly one of João's tiles behind it. These hand-crafted tiles are of many different sizes, and it is important that each tile in the back row is taller than the tile in front of it so that both are visible to passers-by. For the convenience of shoppers, tiles in each row are arranged in non-decreasing order of price from left to right. Tiles of the same price may be arranged in any order subject to the visibility condition stated above.\n\nYour task is to find an ordering of the tiles in each row that satisfies these constraints, or determine that no such ordering exists.", "inputFormat": "The first line of input contains an integer $n$ ($1 \\leq n \\leq 5 \\times 10^5$), the number of tiles in each row. The next four lines contain $n$ integers each; the first pair of lines represents the back row of tiles and the second pair of lines represents the front row. Tiles in each row are numbered from $1$ to $n$ according to their ordering in the input. The first line in each pair contains $n$ integers $p_1, \\dots , p_n$ ($1 \\leq p_i \\leq 10^9$ for each $i$), where $p_i$ is the price of tile number $i$ in that row. The second line in each pair contains $n$ integers $h_1, \\dots , h_n$ ($1 \\leq h_i \\leq 10^9$ for each $i$), where $h_i$ is the height of tile number $i$ in that row.", "outputFormat": "If there is a valid ordering, output it as two lines of $n$ integers, each consisting of a permutation of the tile numbers from $1$ to $n$. The first line represents the ordering of the tiles in the back row and the second\nrepresents the ordering of the tiles in the front row. If more than one pair of permutations satisfies the constraints, any such pair will be accepted. If no ordering exists, output `impossible`.", "hint": "Source: ICPC 2019 World Finals.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Azulejos", "background": "", "description": "陶艺家 Maria 和 João 正在波尔图开设一家小型的 azulejo 商店。Azulejos 是葡萄牙著名的美丽陶瓷瓷砖。Maria 和 João 想要创建一个吸引人的橱窗展示，但由于店内空间有限，他们必须将瓷砖样品在一个架子上排列成两行。João 的每块瓷砖前面都有 Maria 的一块瓷砖，Maria 的每块瓷砖后面都有 João 的一块瓷砖。这些手工制作的瓷砖有许多不同的尺寸，重要的是后排的每块瓷砖都比前排的瓷砖高，以便路人都能看到。为了方便顾客，每排瓷砖按价格从左到右非递减排列。相同价格的瓷砖可以在满足上述可见性条件的情况下以任何顺序排列。\n\n你的任务是找到满足这些约束条件的瓷砖排列，或者确定不存在这样的排列。", "inputFormat": "输入的第一行包含一个整数 $n$ ($1 \\leq n \\leq 5 \\times 10^5$)，表示每排的瓷砖数量。接下来的四行每行包含 $n$ 个整数；前两行表示后排的瓷砖，后两行表示前排的瓷砖。每排的瓷砖根据输入中的顺序从 $1$ 到 $n$ 编号。每对中的第一行包含 $n$ 个整数 $p_1, \\dots , p_n$ ($1 \\leq p_i \\leq 10^9$ 对于每个 $i$)，其中 $p_i$ 是该排中编号为 $i$ 的瓷砖的价格。每对中的第二行包含 $n$ 个整数 $h_1, \\dots , h_n$ ($1 \\leq h_i \\leq 10^9$ 对于每个 $i$)，其中 $h_i$ 是该排中编号为 $i$ 的瓷砖的高度。", "outputFormat": "如果存在有效的排列，则输出两行 $n$ 个整数，每行由从 $1$ 到 $n$ 的瓷砖编号的一个排列组成。第一行表示后排瓷砖的排列，第二行表示前排瓷砖的排列。如果有多个满足约束的排列对，任何这样的对都将被接受。如果不存在这样的排列，输出 `impossible`。", "hint": "来源：ICPC 2019 世界总决赛。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P6252", "type": "P", "difficulty": 5, "samples": [["5 60 18 2\n0 0\n20 20\n30 10\n50 30\n70 20", "6460"], ["4 10 1 1\n0 0\n1 9\n9 9\n10 0", "impossible"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["计算几何", "2019", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Beautiful Bridges", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "What connects us all? Well, it is often bridges. Since ancient times, people have been building bridges for roads, for trains, for pedestrians, and as aqueducts to transport water. It is humanity's way of not taking inconvenient geography for an answer.\n\nThe company Arch Bridges Construction (ABC) specializes in—you guessed it—the construction of arch bridges. This classical style of bridge is supported by pillars that extend from the ground below the bridge. Arches between pillars distribute the bridge's weight onto the adjacent pillars.\n\nThe bridges built by ABC often have pillars spaced at irregular intervals. For aesthetic reasons, ABC's bridges always have semicircular arches, as illustrated in Figure B.1. However, while a bridge arch can touch the ground, it cannot extend below the ground. This makes some pillar placements impossible.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r95zwobd.png)\n\nGiven a ground profile and a desired bridge height $h$, there are usually many ways of building an arch bridge. We model the ground profile as a piecewise-linear function described by $n$ key points $(x_1, y_1),(x_2, y_2), \\dots ,(x_n, y_n)$, where the $x-\\text{coordinate}$ of a point is the position along the bridge, and the $y-\\text{coordinate}$ is the elevation of the ground above sea level at this position along the bridge. The first and last pillars must be built at the first and last key points, and any intermediate pillars can be built only at these key points. The cost of a bridge is the cost of its pillars (which is proportional to their heights) plus the cost of its arches (which is proportional to the amount of material used). So a bridge with $k$ pillars of heights $h_1, \\dots , h_k$ that are separated by horizontal distances $d_1, \\dots , d_{k - 1}$ has a total cost of\n$$\\alpha \\cdot \\sum_{i = 1}^{k} h_i + \\beta \\cdot \\sum_{i = 1}^{k - 1} d_i^2$$\nfor some given constants $\\alpha$ and $\\beta$. ABC wants to construct each bridge at the lowest possible cost.", "inputFormat": "The first line of input contains four integers $n, h, \\alpha, and \\beta$, where $n$ ($2 \\leq n \\leq 10^4$) is the number of points describing the ground profile, $h$ ($1 \\leq h \\leq 10^5$) is the desired height of the bridge above sea level, and $\\alpha, \\beta$ ($1 \\leq \\alpha, \\beta \\leq 10^4$) are the cost factors as described earlier. Then follow $n$ lines, the $i^{\\text{th}}$ of which contains two integers $x_i, y_i$ ($0 \\leq x_1 < x_2 < . . . < x_n \\leq 10^5$ and $0 \\leq yi < h$), describing the ground profile.", "outputFormat": "Output the minimum cost of building a bridge from horizontal position $x_1$ to $x_n$ at height $h$ above sea level. If it is impossible to build any such bridge, output `impossible`.", "hint": "Source: ICPC 2019 World Finals.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Beautiful Bridges", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "What connects us all? Well, it is often bridges. Since ancient times, people have been building bridges for roads, for trains, for pedestrians, and as aqueducts to transport water. It is humanity's way of not taking inconvenient geography for an answer.\n\nThe company Arch Bridges Construction (ABC) specializes in—you guessed it—the construction of arch bridges. This classical style of bridge is supported by pillars that extend from the ground below the bridge. Arches between pillars distribute the bridge's weight onto the adjacent pillars.\n\nThe bridges built by ABC often have pillars spaced at irregular intervals. For aesthetic reasons, ABC's bridges always have semicircular arches, as illustrated in Figure B.1. However, while a bridge arch can touch the ground, it cannot extend below the ground. This makes some pillar placements impossible.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r95zwobd.png)\n\nGiven a ground profile and a desired bridge height $h$, there are usually many ways of building an arch bridge. We model the ground profile as a piecewise-linear function described by $n$ key points $(x_1, y_1),(x_2, y_2), \\dots ,(x_n, y_n)$, where the $x-\\text{coordinate}$ of a point is the position along the bridge, and the $y-\\text{coordinate}$ is the elevation of the ground above sea level at this position along the bridge. The first and last pillars must be built at the first and last key points, and any intermediate pillars can be built only at these key points. The cost of a bridge is the cost of its pillars (which is proportional to their heights) plus the cost of its arches (which is proportional to the amount of material used). So a bridge with $k$ pillars of heights $h_1, \\dots , h_k$ that are separated by horizontal distances $d_1, \\dots , d_{k - 1}$ has a total cost of\n$$\\alpha \\cdot \\sum_{i = 1}^{k} h_i + \\beta \\cdot \\sum_{i = 1}^{k - 1} d_i^2$$\nfor some given constants $\\alpha$ and $\\beta$. ABC wants to construct each bridge at the lowest possible cost.", "inputFormat": "The first line of input contains four integers $n, h, \\alpha, and \\beta$, where $n$ ($2 \\leq n \\leq 10^4$) is the number of points describing the ground profile, $h$ ($1 \\leq h \\leq 10^5$) is the desired height of the bridge above sea level, and $\\alpha, \\beta$ ($1 \\leq \\alpha, \\beta \\leq 10^4$) are the cost factors as described earlier. Then follow $n$ lines, the $i^{\\text{th}}$ of which contains two integers $x_i, y_i$ ($0 \\leq x_1 < x_2 < . . . < x_n \\leq 10^5$ and $0 \\leq yi < h$), describing the ground profile.", "outputFormat": "Output the minimum cost of building a bridge from horizontal position $x_1$ to $x_n$ at height $h$ above sea level. If it is impossible to build any such bridge, output `impossible`.", "hint": "Source: ICPC 2019 World Finals.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Beautiful Bridges", "background": "", "description": "是什么将我们连接在一起？通常是桥梁。自古以来，人们就开始建造桥梁用于道路、火车、行人以及作为运河来运输水。这是人类不屈服于不便地理条件的一种方式。\n\nArch Bridges Construction (ABC) 公司专门从事——你猜对了——拱桥的建造。这种经典风格的桥梁由从桥下地面延伸的柱子支撑。柱子之间的拱将桥梁的重量分布到相邻的柱子上。\n\nABC 建造的桥梁通常在不规则间隔处设置柱子。出于美学原因，ABC 的桥梁总是有半圆形的拱，如图 B.1 所示。然而，虽然桥拱可以接触地面，但不能延伸到地面以下。这使得某些柱子的位置不可能实现。\n\n给定一个地面轮廓和一个期望的桥梁高度 $h$，通常有多种建造拱桥的方法。我们将地面轮廓建模为由 $n$ 个关键点 $(x_1, y_1),(x_2, y_2), \\dots ,(x_n, y_n)$ 描述的分段线性函数，其中点的 $x-\\text{坐标}$ 是沿桥的位置，$y-\\text{坐标}$ 是沿桥该位置处的地面海拔。第一个和最后一个柱子必须建在第一个和最后一个关键点上，任何中间的柱子只能建在这些关键点上。桥梁的成本是其柱子的成本（与其高度成正比）加上其拱的成本（与使用的材料量成正比）。因此，一个有 $k$ 个高度为 $h_1, \\dots , h_k$ 的柱子并且水平距离为 $d_1, \\dots , d_{k - 1}$ 的桥梁的总成本为\n$$\\alpha \\cdot \\sum_{i = 1}^{k} h_i + \\beta \\cdot \\sum_{i = 1}^{k - 1} d_i^2$$\n对于某些给定的常数 $\\alpha$ 和 $\\beta$。ABC 希望以最低的成本建造每座桥梁。", "inputFormat": "输入的第一行包含四个整数 $n, h, \\alpha, \\beta$，其中 $n$ ($2 \\leq n \\leq 10^4$) 是描述地面轮廓的点的数量，$h$ ($1 \\leq h \\leq 10^5$) 是期望的桥梁海拔高度，$\\alpha, \\beta$ ($1 \\leq \\alpha, \\beta \\leq 10^4$) 是如前所述的成本因子。接下来是 $n$ 行，第 $i^{\\text{th}}$ 行包含两个整数 $x_i, y_i$ ($0 \\leq x_1 < x_2 < . . . < x_n \\leq 10^5$ 且 $0 \\leq y_i < h$)，描述地面轮廓。", "outputFormat": "输出从水平位置 $x_1$ 到 $x_n$ 在海拔高度 $h$ 处建造桥梁的最低成本。如果无法建造任何这样的桥梁，输出 `impossible`。", "hint": "来源：ICPC 2019 世界总决赛。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P6253", "type": "P", "difficulty": 6, "samples": [["W 3\n21-17\n13x22x31x24\n19x28", "-b-.-.-. -b-.-.-.\n.-.-.-.- .-.-.-.-\n-.-.-.-. -.-.-.-.\nB-.-w-.- .-.-w-.-\n-.-.-W-. -.-.-.-.\nw-.-.-.- .-.-.-.-\n-.-w-w-. -.-.-.-W\n.-.-.-.- .-.-.-.-"], ["B 5\n2-7\n9x2\n32-27\n2x11x18\n5-9", "-.-b-.-W -.-.-.-W\nb-b-.-.- .-.-.-.-\n-w-.-.-. -b-.-.-.\nB-w-b-.- B-w-.-.-\n-.-.-.-. -.-W-.-.\n.-.-.-.- .-.-.-.-\n-.-.-.-. -.-.-B-.\n.-.-.-B- .-.-.-.-"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "Special Judge", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Checks Post Facto", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "Your university's board game club just hosted a Checkers tournament, and you were assigned to take notes on the games. Unfortunately, while walking home, you dropped all of your papers into a puddle! Disaster! Much of what you wrote is now unreadable; all you have left are some lists of moves played in the middle of various games. Is there some way you can reconstruct what happened in those games? You had better fix things fast, or they will demote you to Tic-Tac-Toe recordkeeper!\n\nCheckers (or English Draughts) is a well-known board game with simple rules. It is played on the dark squares of an $8 \\times 8$ checkerboard. There are two players, Black and White, who alternate turns moving their pieces (all of Black's pieces are black and all of White's pieces are white). Each piece occupies a single dark square, and can be either a normal $man$ or a promoted $king$. A turn consists of choosing one piece and moving it in one of two ways:\n\n1. Shifting it diagonally to an unoccupied adjacent dark square, as shown in Figure C.1(a). This is called a $simple~move$. If the piece is a man, it can move only in the two diagonal directions towards the opposing side of the board (towards the bottom for Black, the top for White). If the piece is a king, it can move in all four diagonal directions.\n\n2. Jumping over an adjacent enemy piece to an unoccupied square immediately on the other side, then removing ($capturing$) that piece. Men can jump only in the two directions described above, while kings can jump in all four. The player can then repeat this step, continuing to jump with the same piece as long as there are properly-positioned enemy pieces to capture. Such a sequence of one or more jumps is called a $jump~move$. Figure C.1(b) shows a jump move comprising three\njumps.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/onoiijvu.png)\n\nIn Checkers, captures are forced moves. If a jump move is available at the start of a player's turn, they must jump, and cannot stop jumping with that piece until it has no more possible jumps. They are free to choose which piece to jump with, and where, if there are multiple possibilities. In Figure C.1(b), Black could not have made any other move.\n\nIf a man reaches the farthest row from its player (that is, a black man reaches the bottom row or a white man reaches the top row), it is removed from the board and replaced by a king of the same color (it is said to be $promoted$), and the turn ends. A piece cannot be promoted and then jump backwards as a new king in the same turn.\n\n\nGiven a list of moves, find a setup of pieces such that the moves can be legally played in sequence starting from that setup. This setup may not have black men on the bottom row or white men on the top row, since they would have been promoted to kings already. You need only ensure that the rules above are obeyed; you do not need to ensure that this setup is reachable in a real game of Checkers.", "inputFormat": "The first line of input contains a character $c$ and an integer $n$, where $c$ is either `B` or `W`, indicates which player makes the first move (Black or White respectively) and $n$ ($1 \\leq n \\leq 100$) is the number of moves in the list. Then follow $n$ lines, each of which describes a move in the standard Checkers notation defined below.\n\n\nThe dark squares are identified by numbers $1 \\sim 32$, as shown in Figure C.1(c). A simple move from square $a$ to square $b$ is written as `a-b`. A jump move starting at $a$ and jumping to $b_1, b_2, \\dots , b_k$ is written as $a\\text{x}b_1\\text{x}b_2\\text{x} \\dots \\text{x}b_k$.\n\nThere is always a valid solution for the given set of moves.", "outputFormat": "Output two boards side-by-side (separated by a space), giving the positions of all pieces on the board before (on the left) and after (on the right) the given moves. Use  `-` for light squares,  `.` for empty dark squares, lowercase `b` and `w` for black and white men, and uppercase `B` and `W` for black and white kings. If there is more than one valid solution, any one is acceptable.", "hint": "Source: ICPC World Finals 2019.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Checks Post Facto", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "Your university's board game club just hosted a Checkers tournament, and you were assigned to take notes on the games. Unfortunately, while walking home, you dropped all of your papers into a puddle! Disaster! Much of what you wrote is now unreadable; all you have left are some lists of moves played in the middle of various games. Is there some way you can reconstruct what happened in those games? You had better fix things fast, or they will demote you to Tic-Tac-Toe recordkeeper!\n\nCheckers (or English Draughts) is a well-known board game with simple rules. It is played on the dark squares of an $8 \\times 8$ checkerboard. There are two players, Black and White, who alternate turns moving their pieces (all of Black's pieces are black and all of White's pieces are white). Each piece occupies a single dark square, and can be either a normal $man$ or a promoted $king$. A turn consists of choosing one piece and moving it in one of two ways:\n\n1. Shifting it diagonally to an unoccupied adjacent dark square, as shown in Figure C.1(a). This is called a $simple~move$. If the piece is a man, it can move only in the two diagonal directions towards the opposing side of the board (towards the bottom for Black, the top for White). If the piece is a king, it can move in all four diagonal directions.\n\n2. Jumping over an adjacent enemy piece to an unoccupied square immediately on the other side, then removing ($capturing$) that piece. Men can jump only in the two directions described above, while kings can jump in all four. The player can then repeat this step, continuing to jump with the same piece as long as there are properly-positioned enemy pieces to capture. Such a sequence of one or more jumps is called a $jump~move$. Figure C.1(b) shows a jump move comprising three\njumps.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/onoiijvu.png)\n\nIn Checkers, captures are forced moves. If a jump move is available at the start of a player's turn, they must jump, and cannot stop jumping with that piece until it has no more possible jumps. They are free to choose which piece to jump with, and where, if there are multiple possibilities. In Figure C.1(b), Black could not have made any other move.\n\nIf a man reaches the farthest row from its player (that is, a black man reaches the bottom row or a white man reaches the top row), it is removed from the board and replaced by a king of the same color (it is said to be $promoted$), and the turn ends. A piece cannot be promoted and then jump backwards as a new king in the same turn.\n\n\nGiven a list of moves, find a setup of pieces such that the moves can be legally played in sequence starting from that setup. This setup may not have black men on the bottom row or white men on the top row, since they would have been promoted to kings already. You need only ensure that the rules above are obeyed; you do not need to ensure that this setup is reachable in a real game of Checkers.", "inputFormat": "The first line of input contains a character $c$ and an integer $n$, where $c$ is either `B` or `W`, indicates which player makes the first move (Black or White respectively) and $n$ ($1 \\leq n \\leq 100$) is the number of moves in the list. Then follow $n$ lines, each of which describes a move in the standard Checkers notation defined below.\n\n\nThe dark squares are identified by numbers $1 \\sim 32$, as shown in Figure C.1(c). A simple move from square $a$ to square $b$ is written as `a-b`. A jump move starting at $a$ and jumping to $b_1, b_2, \\dots , b_k$ is written as $a\\text{x}b_1\\text{x}b_2\\text{x} \\dots \\text{x}b_k$.\n\nThere is always a valid solution for the given set of moves.", "outputFormat": "Output two boards side-by-side (separated by a space), giving the positions of all pieces on the board before (on the left) and after (on the right) the given moves. Use  `-` for light squares,  `.` for empty dark squares, lowercase `b` and `w` for black and white men, and uppercase `B` and `W` for black and white kings. If there is more than one valid solution, any one is acceptable.", "hint": "Source: ICPC World Finals 2019.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Checks Post Facto", "background": "", "description": "游戏在一个 $8 \\times 8$ 的方格棋盘的深色方格上进行。有两名玩家，黑方和白方，他们轮流移动他们的棋子（所有黑方的棋子都是黑色的，所有白方的棋子都是白色的）。每个棋子占据一个单独的深色方格，可以是**兵**或**王**。一个回合包括选择一个棋子并以以下两种方式之一移动它：\n\n1. 将其**斜着**移动到一个相邻的未占用的深色方格，如图 (a) 所示。这被称为**简单移动**。兵只能沿向前的两种方向移动（对于黑方是朝下，对于白方是朝上）。如果棋子是王，它可以在所有四个斜方向移动。\n\n2. 跳过对方的棋子到达空地，并吃掉对方的子。允许移动的方向与第一条相同。然后，玩家可以重复此步骤，继续使用相同的棋子跳。这样一个或多个跳的序列称为**跳跃移动**。图 (b) 展示了由三个跳跃组成的跳跃移动。\n\n如果在玩家回合开始时有一个跳跃移动可用，他们必须进行跳跃，并且不能停止使用该棋子跳跃，直到它没有更多可能的跳跃。他们可以自由选择使用哪个棋子进行跳跃，以及在有多个可能性的情况下选择在哪里跳跃。在图 (b) 中，黑方不能进行任何其他移动。\n\n如果一个兵达到其玩家的最远一行（即，一个黑子达到底行或一个白子达到顶行），它将变成同色的王（称为**晋升**），然后**回合结束**。这意味着一个兵不能在同一回合中被晋升然后以王的身份继续倒退跳跃。\n\n给定一系列移动，请找到一个初始棋局，使得可以从该棋局开始按顺序合法进行这些移动。此棋局可能不能在底行有黑子或在顶行有白子，因为它们可能已经被晋升为王。你只需要确保上述规则被遵守；不需要确保这个棋局在实际跳棋游戏中是可达的。", "inputFormat": "输入的第一行包含一个字符 $c$ 和一个整数 $n$，其中 $c$ 是 B 或 W，表示哪个玩家首先移动（分别为黑方或白方），$n$（$1 \\leq n \\leq 100$）是移动列表中的移动次数。然后是 $n$ 行，每行描述标准跳棋符号中定义的一步移动。\n\n深色方格用数字 $1 \\sim 32$ 标识，如图 (c) 所示。从方格 $a$ 到方格 $b$ 的简单移动写作 a-b。从 $a$ 开始跳到 $b_1, b_2, \\dots , b_k$ 的跳跃移动写作 $a\\text{x}b_1\\text{x}b_2\\text{x} \\dots \\text{x}b_k$。\n\n对于给定的移动集合，总是存在至少一个答案。", "outputFormat": "所有棋子在棋盘上的位置以两个并排的棋盘输出（用空格分隔），分别表示在给定的移动之前（左边）和之后（右边）的棋盘。\n\n使用`-`表示浅色方格，`.`表示空的深色方格，小写的`b`和`w`表示黑色和白色兵，大写的`B`和`W`表示黑色和白色王。如果存在多个答案，则任何一个都可以接受。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6254", "type": "P", "difficulty": 4, "samples": [["9\ne1 e1 s1 e2 s1 s2 e42 e1 s1", "3 1"], ["8\ns1 s1 e3 e1 s3 e1 e3 s3", "8 2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "2019", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Circular DNA", "background": "", "description": "You have an internship with a bioinformatics research group studying DNA. A single strand of DNA consists of many genes, which fall into different categories called gene types. Gene types are delimited by specific nucleotide sequences known as gene markers. Each gene type i has a unique start marker $\\texttt s_i$ and a unique end marker $\\texttt e_i$ . After many dirty jobs (growing bacteria, cell extraction, protein engineering,and so on), your research group can convert DNA into a form consisting of only the gene markers, removing all the genetic material lying between the markers.\n\nYour research group came up with the interesting hypothesis that gene interpretation depends on whether the markers of some gene types form properly nested structures. To decide whether markers of gene type $i$ form a proper nesting in a given sequence of markers $w$, one needs to consider the subsequence of $w$ containing only the markers of gene type $i$ ($\\texttt s_i$ and $\\texttt e_i$), leaving none of them out. The following (and only the following) are considered to be properly nested structures:\n\n- $\\texttt s_i \\texttt e_i$\n- $\\texttt s_i N \\texttt e_i$, where $N$ is a properly nested structure\n- $AB$, where $A$ and $B$ are properly nested structures\n\nGiven your computing background, you were assigned to investigate this property, but there is one further complication. Your group is studying a specific type of DNA called circular DNA, which is DNA that forms a closed loop. To study nesting in circular DNA, it is necessary to cut the loop at some location, which results in a unique sequence of markers (the direction of reading is fixed by molecular properties). Whether a gene type $i$ forms a proper nesting now also depends on where the circular DNA is cut. Your task is to find the cutting location that maximizes the number of gene types that form a properly nested structure. Figure D.1 shows an example corresponding to Sample Input 1. The indicated cut results in the markers for gene type 1 being properly nested.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l856fbko.png)", "inputFormat": "The first line of input contains an integer $n$ ($1 \\leq n \\leq 10^6$), the length of the DNA. The next line contains the DNA sequence, that is, $n$ markers. Each marker is a character $c$ followed by an integer $i$, where $c \\in \\{\\texttt s, \\texttt e\\}$ specifies whether it is a start or an end marker and $i$ ($1 \\leq i \\leq 10^6$) is the gene type of the marker. The given DNA sequence has been obtained from the circular DNA by cutting at an arbitrary location.", "outputFormat": "Output one line with two integers $p$ and $m$, where $p$ is the cutting position that maximizes the number of different gene types that form a proper nesting, and $m$ is this maximum number of gene types. The DNA is cut just before the $p^{\\text{th}}$ input marker (for instance, the cut shown in Figure D.1 has $p = 3$). If more than one cutting position yields the same maximum value of $m$, output the smallest $p$ that does so.", "hint": "Source: ICPC 2019 World Finals.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Circular DNA", "background": "", "description": "You have an internship with a bioinformatics research group studying DNA. A single strand of DNA consists of many genes, which fall into different categories called gene types. Gene types are delimited by specific nucleotide sequences known as gene markers. Each gene type i has a unique start marker $\\texttt s_i$ and a unique end marker $\\texttt e_i$ . After many dirty jobs (growing bacteria, cell extraction, protein engineering,and so on), your research group can convert DNA into a form consisting of only the gene markers, removing all the genetic material lying between the markers.\n\nYour research group came up with the interesting hypothesis that gene interpretation depends on whether the markers of some gene types form properly nested structures. To decide whether markers of gene type $i$ form a proper nesting in a given sequence of markers $w$, one needs to consider the subsequence of $w$ containing only the markers of gene type $i$ ($\\texttt s_i$ and $\\texttt e_i$), leaving none of them out. The following (and only the following) are considered to be properly nested structures:\n\n- $\\texttt s_i \\texttt e_i$\n- $\\texttt s_i N \\texttt e_i$, where $N$ is a properly nested structure\n- $AB$, where $A$ and $B$ are properly nested structures\n\nGiven your computing background, you were assigned to investigate this property, but there is one further complication. Your group is studying a specific type of DNA called circular DNA, which is DNA that forms a closed loop. To study nesting in circular DNA, it is necessary to cut the loop at some location, which results in a unique sequence of markers (the direction of reading is fixed by molecular properties). Whether a gene type $i$ forms a proper nesting now also depends on where the circular DNA is cut. Your task is to find the cutting location that maximizes the number of gene types that form a properly nested structure. Figure D.1 shows an example corresponding to Sample Input 1. The indicated cut results in the markers for gene type 1 being properly nested.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l856fbko.png)", "inputFormat": "The first line of input contains an integer $n$ ($1 \\leq n \\leq 10^6$), the length of the DNA. The next line contains the DNA sequence, that is, $n$ markers. Each marker is a character $c$ followed by an integer $i$, where $c \\in \\{\\texttt s, \\texttt e\\}$ specifies whether it is a start or an end marker and $i$ ($1 \\leq i \\leq 10^6$) is the gene type of the marker. The given DNA sequence has been obtained from the circular DNA by cutting at an arbitrary location.", "outputFormat": "Output one line with two integers $p$ and $m$, where $p$ is the cutting position that maximizes the number of different gene types that form a proper nesting, and $m$ is this maximum number of gene types. The DNA is cut just before the $p^{\\text{th}}$ input marker (for instance, the cut shown in Figure D.1 has $p = 3$). If more than one cutting position yields the same maximum value of $m$, output the smallest $p$ that does so.", "hint": "Source: ICPC 2019 World Finals.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Circular DNA", "background": "", "description": "你在一个研究 DNA 的生物信息学研究小组实习。单链 DNA 由许多基因组成，这些基因分为不同的类别，称为基因类型。基因类型由特定的核苷酸序列分隔，称为基因标记。每个基因类型 $i$ 有一个唯一的起始标记 $\\texttt s_i$ 和一个唯一的结束标记 $\\texttt e_i$。经过许多繁琐的工作（如细菌培养、细胞提取、蛋白质工程等），你的研究小组可以将 DNA 转换为仅由基因标记组成的形式，去除标记之间的所有遗传物质。\n\n你的研究小组提出了一个有趣的假设，即基因的解释取决于某些基因类型的标记是否形成了正确的嵌套结构。要确定基因类型 $i$ 的标记在给定的标记序列 $w$ 中是否形成了正确的嵌套结构，需要考虑 $w$ 的子序列，其中只包含基因类型 $i$ 的标记（$\\texttt s_i$ 和 $\\texttt e_i$），不遗漏任何一个。以下（且仅以下）被认为是正确的嵌套结构：\n\n- $\\texttt s_i \\texttt e_i$\n- $\\texttt s_i N \\texttt e_i$，其中 $N$ 是一个正确的嵌套结构\n- $AB$，其中 $A$ 和 $B$ 是正确的嵌套结构\n\n鉴于你的计算背景，你被分配去研究这个性质，但还有一个进一步的复杂性。你的小组正在研究一种称为环状 DNA 的特定类型的 DNA，这种 DNA 形成一个闭合的环。为了研究环状 DNA 中的嵌套，有必要在某个位置切开环，这会产生一个唯一的标记序列（读取方向由分子性质固定）。基因类型 $i$ 是否形成正确的嵌套现在也取决于环状 DNA 的切割位置。你的任务是找到最大化形成正确嵌套结构的基因类型数量的切割位置。图 D.1 显示了对应于样例输入 1 的一个例子。所示的切割导致基因类型 1 的标记正确嵌套。", "inputFormat": "输入的第一行包含一个整数 $n$ ($1 \\leq n \\leq 10^6$)，表示 DNA 的长度。下一行包含 DNA 序列，即 $n$ 个标记。每个标记是一个字符 $c$ 后跟一个整数 $i$，其中 $c \\in \\{\\texttt s, \\texttt e\\}$ 指定它是起始还是结束标记，$i$ ($1 \\leq i \\leq 10^6$) 是标记的基因类型。给定的 DNA 序列是通过在任意位置切割环状 DNA 获得的。", "outputFormat": "输出一行包含两个整数 $p$ 和 $m$，其中 $p$ 是最大化形成正确嵌套结构的不同基因类型数量的切割位置，$m$ 是这个最大基因类型数量。DNA 在第 $p$ 个输入标记之前被切割（例如，图 D.1 所示的切割有 $p = 3$）。如果有多个切割位置产生相同的最大值 $m$，则输出最小的 $p$。", "hint": "来源：ICPC 2019 世界总决赛。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P6255", "type": "P", "difficulty": 4, "samples": [["6 5\n1 2\n1 3\n2 3\n4 5\n5 6\n", "2\n4 5\n6 5"], ["8 8\n1 2\n1 3\n2 3\n3 4\n1 5\n1 6\n6 7\n6 8\n", "3\n1 5\n1 6\n3 4\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2019", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Dead-End Detector", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "The council of your home town has decided to improve road sign placement,especially for dead ends. They have given you a road map, and you must determine where to put up signs to mark the dead ends. They want you to use as few signs as possible.\n\nThe road map is a collection of locations connected by two-way streets. The following rule describes how to obtain a complete placement of dead-end signs. Consider a street $S$ connecting a location $x$ with another location. The $x$-entrance of $S$ gets a dead-end sign if, after entering $S$ from $x$, it is not possible to come back to $x$ without making a U-turn. A U-turn is a 180-degree turn immediately reversing the direction.\n\nTo save costs, you have decided not to install redundant dead-end signs, as specified by the following rule. Consider a street $S$ with a dead-end sign at its $x$-entrance and another street $T$ with a dead-end sign at its $y$-entrance. If, after entering $S$ from $x$, it is possible to go to $y$ and enter $T$ without making a U-turn, the dead-end sign at the $y$-entrance of $T$ is redundant. See Figure E.1 for examples.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/33rn5okp.png)\n\nFigure E.1: Illustration of sample inputs, indicating where non-redundant dead-end signs are placed.\n", "inputFormat": "The first line of input contains two integers $n$ and $m$, where $n$ $(1 \\leq n \\leq 5\\times10^5)$ is the number of locations and $m$ $(0 \\leq m \\leq 5 \\times 10^5)$ is the number of streets. Each of the following $m$ lines contains two integers $v$ and $w$ $(1 \\leq v \\lt w \\leq n)$ indicating that there is a two-way street connecting locations $v$ and $w$. All location pairs in the input are distinct.", "outputFormat": "On the first line, output $k$, the number of dead-end signs installed. On each of the next $k$ lines, output two integers $v$ and $w$ marking that a dead-end sign should be installed at the $v$-entrance of a street connecting locations $v$ and $w$. The lines describing dead-end signs must be sorted in ascending order of $v$-locations,breaking ties in ascending order of $w$-locations.", "hint": "Source: ICPC World Finals 2019 Problem E.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Dead-End Detector", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "The council of your home town has decided to improve road sign placement,especially for dead ends. They have given you a road map, and you must determine where to put up signs to mark the dead ends. They want you to use as few signs as possible.\n\nThe road map is a collection of locations connected by two-way streets. The following rule describes how to obtain a complete placement of dead-end signs. Consider a street $S$ connecting a location $x$ with another location. The $x$-entrance of $S$ gets a dead-end sign if, after entering $S$ from $x$, it is not possible to come back to $x$ without making a U-turn. A U-turn is a 180-degree turn immediately reversing the direction.\n\nTo save costs, you have decided not to install redundant dead-end signs, as specified by the following rule. Consider a street $S$ with a dead-end sign at its $x$-entrance and another street $T$ with a dead-end sign at its $y$-entrance. If, after entering $S$ from $x$, it is possible to go to $y$ and enter $T$ without making a U-turn, the dead-end sign at the $y$-entrance of $T$ is redundant. See Figure E.1 for examples.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/33rn5okp.png)\n\nFigure E.1: Illustration of sample inputs, indicating where non-redundant dead-end signs are placed.\n", "inputFormat": "The first line of input contains two integers $n$ and $m$, where $n$ $(1 \\leq n \\leq 5\\times10^5)$ is the number of locations and $m$ $(0 \\leq m \\leq 5 \\times 10^5)$ is the number of streets. Each of the following $m$ lines contains two integers $v$ and $w$ $(1 \\leq v \\lt w \\leq n)$ indicating that there is a two-way street connecting locations $v$ and $w$. All location pairs in the input are distinct.", "outputFormat": "On the first line, output $k$, the number of dead-end signs installed. On each of the next $k$ lines, output two integers $v$ and $w$ marking that a dead-end sign should be installed at the $v$-entrance of a street connecting locations $v$ and $w$. The lines describing dead-end signs must be sorted in ascending order of $v$-locations,breaking ties in ascending order of $w$-locations.", "hint": "Source: ICPC World Finals 2019 Problem E.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Dead-End Detector", "background": "", "description": "你所在家乡的市政委员会决定改善道路标志的设置，特别是对于死胡同的标志。他们给了你一张道路地图，你需要确定在哪里设置标志来标记死胡同。他们希望你使用尽可能少的标志。\n\n这张道路地图是由通过双向街道连接的多个地点组成的。以下规则描述了如何完成死胡同标志的设置。考虑一条街道 $S$ 连接地点 $x$ 和另一个地点。如果从 $x$ 进入 $S$ 后，无法在不掉头的情况下返回 $x$，则在 $S$ 的 $x$ 入口处设置一个死胡同标志。掉头是指立即反向的 180 度转弯。\n\n为了节省成本，你决定不安装冗余的死胡同标志，具体规则如下。考虑一条在 $x$ 入口处有死胡同标志的街道 $S$ 和另一条在 $y$ 入口处有死胡同标志的街道 $T$。如果从 $x$ 进入 $S$ 后，可以在不掉头的情况下到达 $y$ 并进入 $T$，那么 $T$ 的 $y$ 入口处的死胡同标志是冗余的。参见图 E.1 以获取示例。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/33rn5okp.png)\n\n图 E.1：示例输入的说明，指示放置非冗余死胡同标志的位置。", "inputFormat": "输入的第一行包含两个整数 $n$ 和 $m$，其中 $n$ $(1 \\leq n \\leq 5\\times10^5)$ 是地点的数量，$m$ $(0 \\leq m \\leq 5 \\times 10^5)$ 是街道的数量。接下来的 $m$ 行中的每一行包含两个整数 $v$ 和 $w$ $(1 \\leq v < w \\leq n)$，表示有一条双向街道连接地点 $v$ 和 $w$。输入中的所有地点对都是不同的。", "outputFormat": "第一行输出 $k$，表示安装的死胡同标志的数量。在接下来的 $k$ 行中，每行输出两个整数 $v$ 和 $w$，表示在连接地点 $v$ 和 $w$ 的街道的 $v$ 入口处应安装一个死胡同标志。描述死胡同标志的行必须按 $v$ 位置升序排序，若有相同则按 $w$ 位置升序排序。", "hint": "来源：ICPC 世界总决赛 2019 问题 E。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P6256", "type": "P", "difficulty": 7, "samples": [["10 20 5\n32 50 12 60\n30 60 8 70\n25 70 0 80\n15 30 28 40\n5 20 14 25\n", "2"], ["2 4 2\n3 2 0 3\n5 2 1 5", "1"]], "limits": {"time": [15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Directing Rainfall", "background": "", "description": "Porto and the nearby Douro Valley are famous for producing port wine. Wine lovers from all over the world come here to enjoy this sweet wine where it is made. The International Consortium of Port Connoisseurs (ICPC) is organizing tours to the vineyards that are upstream on the Douro River. To make visits more pleasurable for tourists, the ICPC has recently installed sun tarps above the vineyards. The tarps protect tourists from sunburn when strolling among the vines and sipping on a vintage port.\n\nUnfortunately, there is a small problem with the tarps. Grapes need sunlight and water to grow. While the tarps let through enough sunlight, they are entirely waterproof. This means that rainwater might not\nreach the vineyards below. If nothing is done, this year's wine harvest is in peril!\n\nThe ICPC wants to solve their problem by puncturing the tarps so that they let rainwater through to the vineyards below. Since there is little time to waste before the rainy season starts, the ICPC wants to make the minimum number of punctures that achieve this goal. We will consider a two-dimensional version of this problem. The vineyard to be watered is an interval on the $x$-axis, and the tarps are modeled as line segments above the $x$-axis. The tarps are slanted, that is, not parallel to the $x-$ or $y-$ axes (see Figure F.1 for an example). Rain falls straight down from infinitely high. When any rain falls on a tarp, it flows toward the tarp's lower end and falls off from there, unless there is a puncture between the place where the rain falls and the tarp's lower end—in which case the rain will fall through the puncture instead. After the rain falls off a tarp, it continues to fall vertically.\n\nThis repeats until the rain hits the ground (the $x$-axis).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/acu9ydhw.png)\n\nFor legal reasons you have to ensure that at least some of the rain that reaches the vineyard originated from directly above the vineyard. This is to prevent any vineyard from stealing all their rain from neighboring vineyards (see the second sample input for an example).", "inputFormat": "The first line of input contains three integers $l$ , $r$ and $n$, where $(l,r)$ $(0 \\leq l \\lt r \\leq 10^9)$ is the interval representing the vineyard and $n$ $(0 \\leq n \\leq 5 \\times 10^5)$ is the number of tarps. Each of the following $n$ linesdescribes a tarp and contains four integers $x_1, y_1, x_2, y_2$ , where $(x_1, y_1)$ is the position of the tarp's lowerend and $(x_2, y_2)$ is the position of the higher end $(0 \\leq x_1, x_2 \\leq 10^9 , x_1≠x_2, $ and $ 0 \\lt y_1 \\lt y_2 \\leq 10^9)$.\nThe $x$-coordinates given in the input ($l$, $r$, and the values of $x_1$ and $x_2$ for all tarps) are all distinct. Thetarps described in the input will not intersect, and no endpoint of a tarp will lie on another tarp.", "outputFormat": "Output the smallest number of punctures that need to be made to get some rain falling from above the vineyard to the vineyard.", "hint": "Source: ICPC World Finals 2019 Problem F: Directing Rainfall.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Directing Rainfall", "background": "", "description": "Porto and the nearby Douro Valley are famous for producing port wine. Wine lovers from all over the world come here to enjoy this sweet wine where it is made. The International Consortium of Port Connoisseurs (ICPC) is organizing tours to the vineyards that are upstream on the Douro River. To make visits more pleasurable for tourists, the ICPC has recently installed sun tarps above the vineyards. The tarps protect tourists from sunburn when strolling among the vines and sipping on a vintage port.\n\nUnfortunately, there is a small problem with the tarps. Grapes need sunlight and water to grow. While the tarps let through enough sunlight, they are entirely waterproof. This means that rainwater might not\nreach the vineyards below. If nothing is done, this year's wine harvest is in peril!\n\nThe ICPC wants to solve their problem by puncturing the tarps so that they let rainwater through to the vineyards below. Since there is little time to waste before the rainy season starts, the ICPC wants to make the minimum number of punctures that achieve this goal. We will consider a two-dimensional version of this problem. The vineyard to be watered is an interval on the $x$-axis, and the tarps are modeled as line segments above the $x$-axis. The tarps are slanted, that is, not parallel to the $x-$ or $y-$ axes (see Figure F.1 for an example). Rain falls straight down from infinitely high. When any rain falls on a tarp, it flows toward the tarp's lower end and falls off from there, unless there is a puncture between the place where the rain falls and the tarp's lower end—in which case the rain will fall through the puncture instead. After the rain falls off a tarp, it continues to fall vertically.\n\nThis repeats until the rain hits the ground (the $x$-axis).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/acu9ydhw.png)\n\nFor legal reasons you have to ensure that at least some of the rain that reaches the vineyard originated from directly above the vineyard. This is to prevent any vineyard from stealing all their rain from neighboring vineyards (see the second sample input for an example).", "inputFormat": "The first line of input contains three integers $l$ , $r$ and $n$, where $(l,r)$ $(0 \\leq l \\lt r \\leq 10^9)$ is the interval representing the vineyard and $n$ $(0 \\leq n \\leq 5 \\times 10^5)$ is the number of tarps. Each of the following $n$ linesdescribes a tarp and contains four integers $x_1, y_1, x_2, y_2$ , where $(x_1, y_1)$ is the position of the tarp's lowerend and $(x_2, y_2)$ is the position of the higher end $(0 \\leq x_1, x_2 \\leq 10^9 , x_1≠x_2, $ and $ 0 \\lt y_1 \\lt y_2 \\leq 10^9)$.\nThe $x$-coordinates given in the input ($l$, $r$, and the values of $x_1$ and $x_2$ for all tarps) are all distinct. Thetarps described in the input will not intersect, and no endpoint of a tarp will lie on another tarp.", "outputFormat": "Output the smallest number of punctures that need to be made to get some rain falling from above the vineyard to the vineyard.", "hint": "Source: ICPC World Finals 2019 Problem F: Directing Rainfall.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Directing Rainfall", "background": "", "description": "波尔图和附近的杜罗河谷因生产波特酒而闻名。来自世界各地的葡萄酒爱好者来到这里品尝这种甜美的葡萄酒。国际波特酒鉴赏家联盟（ICPC）正在组织到杜罗河上游葡萄园的旅行。为了让游客的参观更加愉快，ICPC 最近在葡萄园上方安装了遮阳篷。这些遮阳篷保护游客在葡萄藤间漫步和品尝陈年波特酒时不被晒伤。\n\n不幸的是，遮阳篷存在一个小问题。葡萄需要阳光和水才能生长。虽然遮阳篷能透过足够的阳光，但它们完全防水。这意味着雨水可能无法到达下方的葡萄园。如果不采取措施，今年的葡萄酒收成将岌岌可危！\n\nICPC 想通过在遮阳篷上打孔来解决这个问题，以便雨水能透过遮阳篷到达下方的葡萄园。由于雨季即将到来，时间紧迫，ICPC 希望以最少的打孔次数实现这一目标。我们将考虑这个问题的二维版本。需要浇灌的葡萄园是 $x$ 轴上的一个区间，遮阳篷被建模为 $x$ 轴上方的线段。遮阳篷是倾斜的，即不平行于 $x$ 轴或 $y$ 轴（参见图 F.1 了解示例）。雨水从无限高处直线下落。当雨水落在遮阳篷上时，它会流向遮阳篷的低端并从那里落下，除非在雨水落下的地方和遮阳篷的低端之间有一个孔——在这种情况下，雨水将通过孔落下。雨水从遮阳篷上落下后，继续垂直下落。\n\n这种情况会重复，直到雨水落到地面（$x$ 轴）上。\n\n出于法律原因，您必须确保至少有一些雨水是直接从葡萄园上方落到葡萄园的。这是为了防止任何葡萄园从邻近的葡萄园窃取所有的雨水（参见第二个样例输入了解示例）。", "inputFormat": "输入的第一行包含三个整数 $l$、$r$ 和 $n$，其中 $(l,r)$ $(0 \\leq l < r \\leq 10^9)$ 是表示葡萄园的区间，$n$ $(0 \\leq n \\leq 5 \\times 10^5)$ 是遮阳篷的数量。接下来的 $n$ 行中的每一行描述一个遮阳篷，包含四个整数 $x_1, y_1, x_2, y_2$，其中 $(x_1, y_1)$ 是遮阳篷低端的位置，$(x_2, y_2)$ 是高端的位置 $(0 \\leq x_1, x_2 \\leq 10^9, x_1 \neq x_2, $ 且 $ 0 < y_1 < y_2 \\leq 10^9)$。\n\n输入中给出的 $x$ 坐标（$l$、$r$ 以及所有遮阳篷的 $x_1$ 和 $x_2$ 的值）都是不同的。输入中描述的遮阳篷不会相交，且没有遮阳篷的端点会位于另一个遮阳篷上。", "outputFormat": "输出需要打孔的最小次数，以便从葡萄园上方落下的雨水能够到达葡萄园。", "hint": "来源：ICPC 世界总决赛 2019 问题 F：引导降雨。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P6257", "type": "P", "difficulty": 6, "samples": [["10 5\nS 0\nY 1\nR 2\nE 3\nN 4\nE 5\nA 6\nD 7\nY 7\nR 9\nRY\nE\nN\nS\nAY", "2\n2\n1\n1\n0"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] First of Her Name", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "In the Royal Family, names are very important! As the Royal Historian you have been charged with analyzing the patterns in the names of the Royal Ladies in the realm.\n\nThere have been n Royal Ladies, for convenience numbered from 1 to $n$. The name of each Lady is anuppercase letter concatenated with the name of her mother. The exception is the Lady numbered 1, the\nfounder of the Royal Family, whose name is just a single uppercase letter.\n\nFor example, ENERYS could be the mother of AENERYS (as the name AENERYS consists of the single uppercase letter 'A' concatenated with ENERYS, which is her mother's name). Similarly, AENERYS could be the mother of DAENERYS and YAENERYS.\n\nYou are given the description of all the Royal Ladies. Your task is to determine, for certain interesting strings $s$, the number of Royal Ladies for whom s is a prefix of their name.\n\nFor example, consider Sample Input 1 below, with a Royal Line that goes straight from the founder S to AENERYS (through YS, RYS, ERYS, NERYS and ENERYS), with each Lady having exactly one daughter. Then AENERYS has two daughters—DAENERYS and YAENERYS, with the latter havingone daughter, RYAENERYS.\n\nIn such a family, RY is a prefix of the names of two ladies: RYS and RYAENERYS. E is a prefix of the names of ERYS and ENERYS. N is a prefix only of NERYS's name, while S is a prefix only of the nameof the founder, S. AY is not a prefix of any Royal Lady's name.\n", "inputFormat": "The first line of input contains two integers $n$ and $k$, where $n$ $(1 \\leq n \\leq 10^6)$ is the total number of Royal Ladies and $k$ $(1 \\leq k \\leq 10^6)$ is the number of query strings.\n\nThen follow n lines describing the Royal Ladies. The $i^{th}$ of these lines describes the Royal Lady numbered $i$, and contains an uppercase letter $c_i$ ('A'–'Z') and an integer $p_i$, where $c_i$ is the first letter of the name of Lady $i$, and $p_i$ $(p1 = 0$ and $1 \\leq pi \\lt i$ for $i \\gt 1)$ is the number of her mother (or $0$, in the case\nof the First Lady). All the names are unique.\n\nThe remaining $k$ lines each contain one nonempty query string, consisting only of uppercase letters. The sum of the lengths of the query strings is at most $10^6$.", "outputFormat": "Output $k$ lines, with the $i^{th}$ line containing the number of Royal Ladies who have the $i^{th}$ query string as a prefix of their name.", "hint": "Source: ICPC World Finals 2019.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] First of Her Name", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "In the Royal Family, names are very important! As the Royal Historian you have been charged with analyzing the patterns in the names of the Royal Ladies in the realm.\n\nThere have been n Royal Ladies, for convenience numbered from 1 to $n$. The name of each Lady is anuppercase letter concatenated with the name of her mother. The exception is the Lady numbered 1, the\nfounder of the Royal Family, whose name is just a single uppercase letter.\n\nFor example, ENERYS could be the mother of AENERYS (as the name AENERYS consists of the single uppercase letter 'A' concatenated with ENERYS, which is her mother's name). Similarly, AENERYS could be the mother of DAENERYS and YAENERYS.\n\nYou are given the description of all the Royal Ladies. Your task is to determine, for certain interesting strings $s$, the number of Royal Ladies for whom s is a prefix of their name.\n\nFor example, consider Sample Input 1 below, with a Royal Line that goes straight from the founder S to AENERYS (through YS, RYS, ERYS, NERYS and ENERYS), with each Lady having exactly one daughter. Then AENERYS has two daughters—DAENERYS and YAENERYS, with the latter havingone daughter, RYAENERYS.\n\nIn such a family, RY is a prefix of the names of two ladies: RYS and RYAENERYS. E is a prefix of the names of ERYS and ENERYS. N is a prefix only of NERYS's name, while S is a prefix only of the nameof the founder, S. AY is not a prefix of any Royal Lady's name.\n", "inputFormat": "The first line of input contains two integers $n$ and $k$, where $n$ $(1 \\leq n \\leq 10^6)$ is the total number of Royal Ladies and $k$ $(1 \\leq k \\leq 10^6)$ is the number of query strings.\n\nThen follow n lines describing the Royal Ladies. The $i^{th}$ of these lines describes the Royal Lady numbered $i$, and contains an uppercase letter $c_i$ ('A'–'Z') and an integer $p_i$, where $c_i$ is the first letter of the name of Lady $i$, and $p_i$ $(p1 = 0$ and $1 \\leq pi \\lt i$ for $i \\gt 1)$ is the number of her mother (or $0$, in the case\nof the First Lady). All the names are unique.\n\nThe remaining $k$ lines each contain one nonempty query string, consisting only of uppercase letters. The sum of the lengths of the query strings is at most $10^6$.", "outputFormat": "Output $k$ lines, with the $i^{th}$ line containing the number of Royal Ladies who have the $i^{th}$ query string as a prefix of their name.", "hint": "Source: ICPC World Finals 2019.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] First of Her Name", "background": "", "description": "众所周知，皇室家族的名字非常有讲究。而作为研究皇室的历史学家的你，最近接到了一个艰巨的任务——分析王国历史中所有皇室夫人的名字。\r\n\r\n王国历史上有 $n$ 位皇室夫人，方便起见，我们将其从 $1$ 至 $n$ 编号。除了 $1$ 号夫人外，其余夫人的名字均为一个大写字母连接着她母亲的名字。而 $1$ 号夫人作为王国的首任王后，她的名字只有一个大写字母。\r\n\r\n例如，由于 `AENERYS` 由 `A` 与 `ENERYS` 组成，因此 `ENERYS` 是 `AENERYS` 的母亲。相似地，`AENERYS` 是 `DAENERYS` 与 `YAENERYS` 的母亲。\r\n\r\n你知道王国历史上所有皇室夫人的姓名与关系，而你需要完成的任务是，对于其他历史学家感兴趣的名字串 $s$，总共有多少位夫人的名字是以 $s$ 起始的。\r\n\r\n例如在样例的皇室族谱中，`S` 至 `AENERYS` 的这一支（包含 `YS`、`RYS`、`ERYS`、`NERYS` 与 `ENERYS` 这几位夫人）均只有一位女儿。接下来 `AENERYS` 有两位女儿，分别是 `DAENERYS`，以及女儿是 `RYAENERYS` 的 `YAENERYS`。\r\n\r\n在这个皇室家族内，有两位夫人的名字以 `RY` 起始，她们是 `RYS` 与 `RYAENERYS`。而 `ERYS` 与 `ENERYS` 均以 `E` 起始。名字以 `N` 起始的仅有一位夫人 `NERYS`。同样地，以 `S` 起始的仅有首位王后 `S`。而没有任何一位夫人的名字以 `AY` 起始。", "inputFormat": "第一行有两个整数 $n,k$，分别代表王国历史上皇室夫人总数，以及其他历史学家感兴趣的名字串的个数。\r\n\r\n接下来 $n$ 行描述所有皇室夫人的姓名与关系。第 $i+1$ 行描述第 $i$ 位夫人的资料 $c_i$ 与 $p_i$，其中字符 $c_i$ 表示她名字的首位字母，$p_i$ 为她母亲的编号。对于编号为 $1$ 的首位王后，$p_1=0$。所有夫人的名字均不重复。\r\n\r\n接下来 $k$ 行，每行为一个大写字母构成的非空串，代表一个其他历史学家感兴趣的名字串。", "outputFormat": "输出 $k$ 行，第 $i$ 行为一个整数，代表总共有多少位夫人的名字是以第 $i$ 个感兴趣的名字串起始的。", "hint": "$1\\leq n\\leq 10^6$，$1\\leq k\\leq 10^6$，$p_1=0$，特别地，对于 $1\\lt i\\leq n$，保证有 $1\\leq p_i\\lt i$。感兴趣的名字串总长不超过 $10^6$。", "locale": "zh-CN"}}}
{"pid": "P6258", "type": "P", "difficulty": 5, "samples": [["6 2\n2\n3\n4\n5\n4\n3\n", "1\n2\n4\n5\n3\n1"], ["5 3\n2\n3\n1\n5\n4\n", "3\n3\n3\n2\n2"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Hobson's Trains", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "Mr. Hobson has retired from running a stable and has invested in a more modern form of transport,trains. He has built a rail network with n stations. However, he has retained his commitment to free the passenger from the burden of too many choices: from each station, a passenger can catch a train to exactly one other station. Such a journey is referred to as a **$leg$**. Note that this is a one-way journey, and it might not be possible to get back again.\n\nHobson also offers exactly one choice of ticket, which allows a passenger to travel up to $k$ legs in one trip. At the exit from each station is an automated ticket reader (only one, so that passengers do not need\nto decide which to use). The reader checks that the distance from the initial station to the final station does not exceed $k$ legs.\n\nEach ticket reader must be programmed with a list of valid starting stations, but the more memory this list needs, the more expensive the machine will be. Help Hobson by determining, for each station $A$, the\nnumber of stations (including $A$) from which a customer can reach $A$ in at most $k$ legs.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l1j8vud2.png)", "inputFormat": "The first line of input contains two integers $n$ and $k$, where $n$ $(2 \\leq n \\leq 5\\times10^5)$ is the number of stations and $k$ $(1 \\leq k \\leq n − 1)$ is the maximum number of legs that may be traveled on a ticket. Then follow $n$ lines, the $i^{th}$ of which contains an integer $d_i$ $(1 \\leq d_i \\leq n$ and $d_i ≠ i)$, the station which may be reached from station $i$ in one leg.\n", "outputFormat": "Output $n$ lines, with the $i^{th}$ line containing the number of stations from which station $i$ can be reached in at most $k$ legs.\n", "hint": "Source: ICPC World Finals 2019.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Hobson's Trains", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "Mr. Hobson has retired from running a stable and has invested in a more modern form of transport,trains. He has built a rail network with n stations. However, he has retained his commitment to free the passenger from the burden of too many choices: from each station, a passenger can catch a train to exactly one other station. Such a journey is referred to as a **$leg$**. Note that this is a one-way journey, and it might not be possible to get back again.\n\nHobson also offers exactly one choice of ticket, which allows a passenger to travel up to $k$ legs in one trip. At the exit from each station is an automated ticket reader (only one, so that passengers do not need\nto decide which to use). The reader checks that the distance from the initial station to the final station does not exceed $k$ legs.\n\nEach ticket reader must be programmed with a list of valid starting stations, but the more memory this list needs, the more expensive the machine will be. Help Hobson by determining, for each station $A$, the\nnumber of stations (including $A$) from which a customer can reach $A$ in at most $k$ legs.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l1j8vud2.png)", "inputFormat": "The first line of input contains two integers $n$ and $k$, where $n$ $(2 \\leq n \\leq 5\\times10^5)$ is the number of stations and $k$ $(1 \\leq k \\leq n − 1)$ is the maximum number of legs that may be traveled on a ticket. Then follow $n$ lines, the $i^{th}$ of which contains an integer $d_i$ $(1 \\leq d_i \\leq n$ and $d_i ≠ i)$, the station which may be reached from station $i$ in one leg.\n", "outputFormat": "Output $n$ lines, with the $i^{th}$ line containing the number of stations from which station $i$ can be reached in at most $k$ legs.\n", "hint": "Source: ICPC World Finals 2019.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Hobson's Trains", "background": null, "description": "Hobson 先生从管理马厩的工作中退休后，投资于一种更加现代的交通方式：火车。\n\n他已经修建了一个包含 $n$ 个火车站的铁路网。然而，他兑现了让乘客摆脱选择困难症的承诺：对于每个站点，乘客只能乘坐火车前往一个站点，别无其它选择。\n\n这样的一段旅程被称作一趟。要注意这是单向的旅程，可能无法再回到出发点。\n\nHobson 同样也只提供一种车票，允许乘客一次旅行的距离不超过 $k$ 趟。在每个站点的出口会有一个自动读票机（只有一个，所以乘客就不用纠结于要用哪个）。机器会检查从始发站到到达站的距离是否不超过 $k$ 趟。\n\n每个读票机必须编入一个合法始发站列表，但是列表消耗的存储空间越多，机器就越贵。\n\n请帮助 Hobson 先生确定：对于每个站点 $A$，能够在最多 $k$ 趟的旅程中到达 $A$ 的站点个数（包含 $A$ 本身）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1hewt4ho.png)\n\n上图为样例输入 1 对应的示意图。每个圆圈代表了一个站点，圆圈旁边的数字为当 $k=2$ 时需要编入读票机的站点编号。", "inputFormat": "第一行包含两个整数 $n, k$，$n$ 为站点个数，$k$ 为一张票允许旅行的最多趟数。  \n接下来 $n$ 行，第 $i$ 行包含一个整数 $d_i$，表示第 $i$ 个站点经过一趟到达的站点。", "outputFormat": "输出 $n$ 行，第 $i$ 行输出能在 $k$ 趟内到达站点 $i$ 的站点数目。\n\n**【译者注】**\n\n在不侵犯原题版权的情况下，本题面中文翻译基于[知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议](http://creativecommons.org/licenses/by-nc-sa/4.0/)发布，注明出处时需指向本题链接。\n\nTranslate By @小粉兔", "hint": "对于全部数据，满足 $2\\le n\\le 5 \\times 10^5,1\\le k\\le n - 1$，对于任意 $1 \\le i \\le n$ 都满足 $1 \\le d_i \\le n$ 且 $d_i\\ne i$。", "locale": "zh-CN"}}}
{"pid": "P6259", "type": "P", "difficulty": 5, "samples": [["4 8 5 7\n.......#\n..#....#\n.###...#\n.....###\nR=lll\nG=ub(B)\nB=ub(m)lib(l)(m)\nH=ib()(mmHllmll)\nI=III\n1 1 w\nG\n1 1 e\nG\n2 2 n\nG\n2 6 w\nBR\n4 1 s\nib(lib()(mmm))(mmmm)\n1 1 e\nH\n2 2 s\nI\n", "1 1 w\ninf\n1 1 w\n2 4 s\n4 4 e\n1 4 e\ninf\n"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "2019", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Karel the Robot", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。", "description": "Did you know that the word \"robot\" is almost 100 years old? It was first introduced in 1920, in the science-fiction theatrical play $R.U.R.$ , written by Karel Capek. As a tribute to this Czech writer, an educational programming language was named Karel many years later at Stanford University. Your task is to implement an interpreter of a simplified version of this programming language.\n\nThe Karel programming language controls a robot named Karel, who lives in a grid of unit squares. Some of the squares are free, while others contain a barrier. Karel always occupies one of the free squares and faces one of the four cardinal directions. The two basic commands are \"move forward\" and \"turn left.\" The language also provides simple conditional and looping statements. The main educational potential of the language lies in the possibility of defining new procedures for more complex tasks.\n\nOur simplified version of the language can be described by the following grammar:\n\n```plain\n<program> := \"\" | <command> <program>\n<command> := \"m\" | \"l\" | <proc-call> |\n             \"i\" <condition> \"(\" <program> \")(\" <program> \")\" |\n             \"u\" <condition> \"(\" <program> \")\"\n<condition> := \"b\" | \"n\" | \"s\" | \"e\" | \"w\"\n<proc-call> := <uppercase-letter>\n<proc-def> := <uppercase-letter> \"=\" <program>\n```\nThere are five types of commands:\n\n- $\\texttt m$ (\"move forward\") advances Karel's position by one grid square in its current heading, unless there is a barrier, in which case the command has no effect.\n- $\\texttt l$ (\"turn left\") makes Karel turn left $90$ degrees.\n- $\\texttt X$ where $\\texttt X$ is any uppercase letter, invokes the procedure named $\\texttt X$. \n- $\\texttt i$ (\"if\") followed by a single-letter condition, and two programs in parentheses. If the condition is satisfied, the first program is executed. Otherwise, the second program is executed.\n- $\\texttt u$ (\"until\") followed by a single-letter condition, and a program in parentheses. If the condition is satisfied, nothing is done. Otherwise, the program is executed and then the command is repeated.\n\nA condition can be either '$b$', which is satisfied if and only if there is a barrier in the next square in Karel's current heading, or one of the four directional letters `n`, `s`, `e`, or `w`, which is satisfied if and only if Karel's current heading is north, south, east, or west, respectively.\n\n\nFor instance, a simple program `ub(m)` can be understood to mean: “keep moving forward until there is a barrier,\" while `un(l)` means \"turn to the north.\" A procedure definition `R=lll` defines a new procedure `R` which effectively means \"turn right.\"\n", "inputFormat": "The first line of input contains four integers $r, c, d$ and $e$, where $r$ and $c$ $(1 \\leq r, c \\leq 40)$ are the dimensions of the grid in which Karel lives, $d$ $(0 \\leq d \\leq 26)$ is the number of procedure definitions, and $e$ $(1 \\leq e \\leq 10)$ is the number of programs to be executed.\n\nThen follow $r$ lines describing the grid (running north to south), each containing c characters (running west to east), each character being either `.` (denoting a free square) or `#` (denoting a barrier). All squares outside this given area are considered barriers, which means Karel may never leave the area.\n\nEach of the next $d$ lines contains a procedure definition, associating a procedure name (one uppercase letter) with a program forming the procedure body. No procedure name is defined more than once. Procedure bodies may contain invocations of procedures that have not yet been defined.\n\nThe last $2e$ lines describe the programs to be executed. Each such description consists of a pair of lines. The first line of each pair contains two integers $i$ and $j$ and a character $h$, where $i$ $(1 \\leq i\\leq r)$ is the row and $j$ $(1 \\leq j \\leq c)$ is the column of Karel's initial position, and $h \\in \\{ \\texttt n, \\texttt s, \\texttt e, \\texttt w\\}$ represents Karel's initial heading. It is guaranteed that the initial position is a free square. The second line of each pair contains a program to be executed from that initial position.\n\nAll procedure bodies and all programs to be executed are at least $1$ and at most $100$ characters long, syntactically correct, and only contain invocations of procedures that are defined. The lines with procedure definitions and programs to be executed contain no whitespace characters.\n", "outputFormat": "For each program execution, output the final position of Karel after the complete program is executed from the respective initial position. Follow the format used to describe initial positions, that is, two numbers and a directional character. If a particular execution never terminates, output `inf` instead.\n", "hint": "Source: ICPC World Finals 2019.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Karel the Robot", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。", "description": "Did you know that the word \"robot\" is almost 100 years old? It was first introduced in 1920, in the science-fiction theatrical play $R.U.R.$ , written by Karel Capek. As a tribute to this Czech writer, an educational programming language was named Karel many years later at Stanford University. Your task is to implement an interpreter of a simplified version of this programming language.\n\nThe Karel programming language controls a robot named Karel, who lives in a grid of unit squares. Some of the squares are free, while others contain a barrier. Karel always occupies one of the free squares and faces one of the four cardinal directions. The two basic commands are \"move forward\" and \"turn left.\" The language also provides simple conditional and looping statements. The main educational potential of the language lies in the possibility of defining new procedures for more complex tasks.\n\nOur simplified version of the language can be described by the following grammar:\n\n```plain\n<program> := \"\" | <command> <program>\n<command> := \"m\" | \"l\" | <proc-call> |\n             \"i\" <condition> \"(\" <program> \")(\" <program> \")\" |\n             \"u\" <condition> \"(\" <program> \")\"\n<condition> := \"b\" | \"n\" | \"s\" | \"e\" | \"w\"\n<proc-call> := <uppercase-letter>\n<proc-def> := <uppercase-letter> \"=\" <program>\n```\nThere are five types of commands:\n\n- $\\texttt m$ (\"move forward\") advances Karel's position by one grid square in its current heading, unless there is a barrier, in which case the command has no effect.\n- $\\texttt l$ (\"turn left\") makes Karel turn left $90$ degrees.\n- $\\texttt X$ where $\\texttt X$ is any uppercase letter, invokes the procedure named $\\texttt X$. \n- $\\texttt i$ (\"if\") followed by a single-letter condition, and two programs in parentheses. If the condition is satisfied, the first program is executed. Otherwise, the second program is executed.\n- $\\texttt u$ (\"until\") followed by a single-letter condition, and a program in parentheses. If the condition is satisfied, nothing is done. Otherwise, the program is executed and then the command is repeated.\n\nA condition can be either '$b$', which is satisfied if and only if there is a barrier in the next square in Karel's current heading, or one of the four directional letters `n`, `s`, `e`, or `w`, which is satisfied if and only if Karel's current heading is north, south, east, or west, respectively.\n\n\nFor instance, a simple program `ub(m)` can be understood to mean: “keep moving forward until there is a barrier,\" while `un(l)` means \"turn to the north.\" A procedure definition `R=lll` defines a new procedure `R` which effectively means \"turn right.\"\n", "inputFormat": "The first line of input contains four integers $r, c, d$ and $e$, where $r$ and $c$ $(1 \\leq r, c \\leq 40)$ are the dimensions of the grid in which Karel lives, $d$ $(0 \\leq d \\leq 26)$ is the number of procedure definitions, and $e$ $(1 \\leq e \\leq 10)$ is the number of programs to be executed.\n\nThen follow $r$ lines describing the grid (running north to south), each containing c characters (running west to east), each character being either `.` (denoting a free square) or `#` (denoting a barrier). All squares outside this given area are considered barriers, which means Karel may never leave the area.\n\nEach of the next $d$ lines contains a procedure definition, associating a procedure name (one uppercase letter) with a program forming the procedure body. No procedure name is defined more than once. Procedure bodies may contain invocations of procedures that have not yet been defined.\n\nThe last $2e$ lines describe the programs to be executed. Each such description consists of a pair of lines. The first line of each pair contains two integers $i$ and $j$ and a character $h$, where $i$ $(1 \\leq i\\leq r)$ is the row and $j$ $(1 \\leq j \\leq c)$ is the column of Karel's initial position, and $h \\in \\{ \\texttt n, \\texttt s, \\texttt e, \\texttt w\\}$ represents Karel's initial heading. It is guaranteed that the initial position is a free square. The second line of each pair contains a program to be executed from that initial position.\n\nAll procedure bodies and all programs to be executed are at least $1$ and at most $100$ characters long, syntactically correct, and only contain invocations of procedures that are defined. The lines with procedure definitions and programs to be executed contain no whitespace characters.\n", "outputFormat": "For each program execution, output the final position of Karel after the complete program is executed from the respective initial position. Follow the format used to describe initial positions, that is, two numbers and a directional character. If a particular execution never terminates, output `inf` instead.\n", "hint": "Source: ICPC World Finals 2019.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Karel the Robot", "background": "", "description": "你知道“机器人”这个词已经快 100 年了吗？它首次出现在 1920 年，由 Karel Capek 编写的科幻戏剧 $R.U.R.$ 中。为了向这位捷克作家致敬，许多年后斯坦福大学将一种教育编程语言命名为 Karel。你的任务是实现这种编程语言的简化版本的解释器。\n\nKarel 编程语言控制一个名叫 Karel 的机器人，它生活在一个单位方格的网格中。一些方格是空的，而另一些则包含障碍物。Karel 总是占据一个空的方格，并面向四个基本方向之一。两个基本命令是“前进”和“左转”。该语言还提供简单的条件和循环语句。该语言的主要教育潜力在于可以定义新的过程来完成更复杂的任务。\n\n我们的简化版本的语言可以通过以下语法描述：\n\n```plain\n<program> := \"\" | <command> <program>\n<command> := \"m\" | \"l\" | <proc-call> |\n             \"i\" <condition> \"(\" <program> \")(\" <program> \")\" |\n             \"u\" <condition> \"(\" <program> \")\"\n<condition> := \"b\" | \"n\" | \"s\" | \"e\" | \"w\"\n<proc-call> := <uppercase-letter>\n<proc-def> := <uppercase-letter> \"=\" <program>\n```\n\n有五种类型的命令：\n\n- $\\texttt m$（“前进”）使 Karel 在其当前方向上前进一个网格单元，除非前方有障碍物，在这种情况下命令无效。\n- $\\texttt l$（“左转”）使 Karel 左转 $90$ 度。\n- $\\texttt X$，其中 $\\texttt X$ 是任何大写字母，调用名为 $\\texttt X$ 的过程。\n- $\\texttt i$（“如果”）后跟一个单字母条件和两个括号中的程序。如果条件满足，则执行第一个程序。否则，执行第二个程序。\n- $\\texttt u$（“直到”）后跟一个单字母条件和一个括号中的程序。如果条件满足，则不执行任何操作。否则，执行程序，然后重复该命令。\n\n条件可以是 '$b$'，当且仅当在 Karel 当前方向的下一个方格中有障碍物时满足，或者是四个方向字母之一 `n`、`s`、`e` 或 `w`，当且仅当 Karel 当前方向分别为北、南、东或西时满足。\n\n例如，一个简单的程序 `ub(m)` 可以理解为：“一直前进直到遇到障碍物”，而 `un(l)` 意味着“转向北”。过程定义 `R=lll` 定义了一个新过程 `R`，其有效含义是“右转”。", "inputFormat": "输入的第一行包含四个整数 $r, c, d$ 和 $e$，其中 $r$ 和 $c$ $(1 \\leq r, c \\leq 40)$ 是 Karel 所在网格的维度，$d$ $(0 \\leq d \\leq 26)$ 是过程定义的数量，$e$ $(1 \\leq e \\leq 10)$ 是要执行的程序数量。\n\n接下来是 $r$ 行描述网格（从北到南），每行包含 $c$ 个字符（从西到东），每个字符要么是 `.`（表示空方格），要么是 `#`（表示障碍物）。该给定区域外的所有方格都被视为障碍物，这意味着 Karel 永远不能离开该区域。\n\n接下来的 $d$ 行中的每一行包含一个过程定义，将一个过程名称（一个大写字母）与形成过程主体的程序关联。没有过程名称被定义多于一次。过程主体可以包含尚未定义的过程调用。\n\n最后 $2e$ 行描述要执行的程序。每个这样的描述由一对行组成。每对的第一行包含两个整数 $i$ 和 $j$ 以及一个字符 $h$，其中 $i$ $(1 \\leq i \\leq r)$ 是行，$j$ $(1 \\leq j \\leq c)$ 是 Karel 的初始位置的列，$h \\in \\{ \\texttt n, \\texttt s, \\texttt e, \\texttt w\\}$ 表示 Karel 的初始方向。保证初始位置是一个空方格。每对的第二行包含一个要从该初始位置执行的程序。\n\n所有过程主体和所有要执行的程序长度至少为 $1$ 且最多为 $100$ 个字符，语法正确，并且只包含已定义的过程调用。包含过程定义和要执行的程序的行不包含空格字符。", "outputFormat": "对于每个程序执行，输出从各自初始位置执行完整程序后 Karel 的最终位置。遵循用于描述初始位置的格式，即两个数字和一个方向字符。如果某个执行永远不会终止，则输出 `inf`。", "hint": "来源：ICPC 世界总决赛 2019。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P6260", "type": "P", "difficulty": 6, "samples": [["3 3\n2 2 2\n4 2 1\n4 4 1", "1\n2\n2"], ["6 4\n3 1 2 2\n4 3 2 2\n6 6 3 2\n7 3 4 3\n3 4 2 4\n2 3 3 5", "1\n2\n5\n5\n4\n3\n"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Miniature Golf", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "A group of friends has just played a round of miniature golf. Miniature golf courses consist of a number of holes. Each player takes a turn to play each hole by hitting a ball repeatedly until it drops into the hole.\nA player's score on that hole is the number of times they hit the ball. \nTo prevent incompetent players slowing down the game too much, there is also an upper limit $l$ (a positive integer) on the score: if a player has hit the ball $l$ times without the ball dropping into the hole, the score for that hole is recorded as $l$ and that player's turn is over. The total score of each player is simply the sum of their scores on all the holes. Naturally, a lower score is considered better.\n\nThere is only one problem: none of the players can remember the value of the integer $l$. They decide that they will not apply any upper limit while playing, allowing each player to keep playing until the ball\ndrops into the hole. After the game they intend to look up the value of $l$ and adjust the scores, replacing any score on a hole that is larger than $l$ with $l$.\n\nThe game has just finished, but the players have not yet looked up $l$. They wonder what their best possible ranks are. For this problem, the rank of a player is the number of players who achieved an equal or lower total score after the scores are adjusted with $l$. For example, if the adjusted scores of the players are $3, 5, 5, 4,$ and $3$, then their ranks are $2, 5, 5, 3$ and $2$ respectively.\n\nGiven the scores of the players on each hole, determine the smallest possible rank for each player.", "inputFormat": "The first line of input contains two integers $p$ and $h$, where $p$ $(2 \\leq p \\leq 500)$ is the number of players and $h$ $(1 \\leq h \\leq 50)$ is the number of holes. The next $p$ lines each contain $h$ positive integers. The $j^{th}$ number on the $i^{th}$ of these lines is the score for player $i$ on hole $j$, and does not exceed $10^9$.\n", "outputFormat": "Output a line with the minimum possible rank for each player, in the same order as players are listed in the input.", "hint": "Source: ICPC World Finals 2019 Problem J: Miniature Golf.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Miniature Golf", "background": "### Warning: If you submit a malicious program, you will be banned.\n### 警告：恶意提交本题将被封号。\n", "description": "A group of friends has just played a round of miniature golf. Miniature golf courses consist of a number of holes. Each player takes a turn to play each hole by hitting a ball repeatedly until it drops into the hole.\nA player's score on that hole is the number of times they hit the ball. \nTo prevent incompetent players slowing down the game too much, there is also an upper limit $l$ (a positive integer) on the score: if a player has hit the ball $l$ times without the ball dropping into the hole, the score for that hole is recorded as $l$ and that player's turn is over. The total score of each player is simply the sum of their scores on all the holes. Naturally, a lower score is considered better.\n\nThere is only one problem: none of the players can remember the value of the integer $l$. They decide that they will not apply any upper limit while playing, allowing each player to keep playing until the ball\ndrops into the hole. After the game they intend to look up the value of $l$ and adjust the scores, replacing any score on a hole that is larger than $l$ with $l$.\n\nThe game has just finished, but the players have not yet looked up $l$. They wonder what their best possible ranks are. For this problem, the rank of a player is the number of players who achieved an equal or lower total score after the scores are adjusted with $l$. For example, if the adjusted scores of the players are $3, 5, 5, 4,$ and $3$, then their ranks are $2, 5, 5, 3$ and $2$ respectively.\n\nGiven the scores of the players on each hole, determine the smallest possible rank for each player.", "inputFormat": "The first line of input contains two integers $p$ and $h$, where $p$ $(2 \\leq p \\leq 500)$ is the number of players and $h$ $(1 \\leq h \\leq 50)$ is the number of holes. The next $p$ lines each contain $h$ positive integers. The $j^{th}$ number on the $i^{th}$ of these lines is the score for player $i$ on hole $j$, and does not exceed $10^9$.\n", "outputFormat": "Output a line with the minimum possible rank for each player, in the same order as players are listed in the input.", "hint": "Source: ICPC World Finals 2019 Problem J: Miniature Golf.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Miniature Golf", "background": "", "description": "几个朋友玩了一场小型的高尔夫。这种小型的高尔夫是由若干个洞组成的。每个玩家轮流玩这个游戏，不停地击球直到球落到每个洞里。玩家在一个洞上的得分是他击球的次数。为了防止捣乱的玩家把游戏速度放慢太多，游戏规则中也会给一个上限$l$（一个正整数）来控制分数：如果一个玩家在一个洞上已经击球$l$次，但是球还没有落到洞里，那么这个玩家在这个洞上的得分就是$l$，并且这个玩家的回合就结束了。一个玩家的总得分就是他在各个洞上的得分之和。自然地，在这个游戏中，分越低越好。\n\n但是有一个问题：没有玩家记得$l$的值。玩家们决定在玩的时候不设置$l$的值，允许每个玩家不断击球，直到球掉到洞里。玩完游戏，他们准备设置$l$的值，并更改那些在洞上的分数大于$l$的值。\n\n游戏结束了，但他们还没有设置$l$。他们想知道自己的最佳排名是什么。一个人的排名是在所有人中，得分比这个人低或和这个人相等的人数（包含自己）。比如，当五个人的得分分别是 $3,5,5,4,3$，那么他们的排名就是 $2,5,5,3,2$。\n\n给你每个玩家在每个洞上的得分，为每一个玩家求出最小的可能的排名。", "inputFormat": "第一行：两个整数 $p$ 和 $h$，$p$（$2 \\le p \\le 500$）是玩家个数，$h$（$1 \\le h \\le 50$）是洞的个数。\n\n接下来$p$行，每行$h$个正整数，第$i$行第$j$列的数表示第$i$个玩家在第$j$个洞上的得分，这些数都不会超过$10^9$。", "outputFormat": "输出 $p$ 行，每行一个正整数，第 $i$ 行表示第 $i$ 个玩家的最小排名。", "hint": "来源：ICPC World Finals 2019 Problem J \n\n题目名称：Miniature Golf", "locale": "zh-CN"}}}
{"pid": "P6261", "type": "P", "difficulty": 7, "samples": [["4\n1 2 3\n6 2 3\n10 2 3\n16 3 4", "0.4\n0\n0.2\n0.171428571429\n0.228571428571"], ["6\n4 1 5\n9 8 7\n13 3 5\n21 5 7\n30 9 1\n2019 20 0", "0.166666666667\n0.466666666667\n0.150000000000\n0.108333333333\n0.091666666667\n0.016666666667\n0.000000000000"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "Special Judge", "O2优化", "ICPC", "WF"], "title": "[ICPC 2019 WF] Traffic Blights", "background": "", "description": "Cars! Where do they come from? Where do they go? Nobody knows. They appear where roads have been built, as if out of nowhere. Some say that no two cars are alike. Some say that if you look closely, you can see the pale ghosts of miserable humans inside them, trapped forever—particularly in\nthe morning and late afternoon. What scientific eye could frame their fearful symmetry?\n\nWell, yours, hopefully. As part of your government's Urban Traffic Control department, you are trying to write a paper on local traffic congestion. It is too dangerous to observe cars in the wild, of course, but you have been given some data on the traffic lights along your town's Main Street, and you would like to do some theoretical calculations about how well-synchronized they are.\n\nMain Street is set out on a line, with traffic lights placed at various points along it. Each traffic light cycles between red and green with a fixed period, being red for $r$ seconds, then green for $g$ seconds, then red for $r$ seconds, and so on. The values of $r$ and $g$ may be different for different traffic lights. At time $0$, all the lights have just turned red.\n\nAssume that an \"ideal\" car mystically appears at the west end of Main Street at a uniformly random real-valued time in the interval $[0, 2019!]$ (where $k!$ is the product of the first $k$ positive integers), driving eastwards at a slow crawl of $1$ meter/second until it hits a red light. What is the probability that it will make it through all the lights without being forced to stop? If it does hit a red light, which one is it likely to hit first?\n\nWrite a program to answer these questions.", "inputFormat": "The first line of input contains an integer $n$ ($1 \\leq n \\leq 500$), the number of traffic lights. Each of the following $n$ lines contains three integers $x$, $r$, and $g$ describing a traffic light, where $x$ ($1 \\leq x \\leq 10^5$) is the position of the light along Main Street in meters, and $r$ and $g$ ($0 \\leq r, g$ and $1 \\leq r + g \\leq 100$) are the durations in seconds of the red and green portions of the light's period (so the light is red from time $0$ to $r$, from time $r + g$ to $2r + g$, and so on).\n\nThe west end of Main Street is at position $0$, and the lights are listed in order of strictly increasing position.", "outputFormat": "For each of the $n$ lights, output a line containing the probability that this light will be the first red light an \"ideal\" car hits. Then output a line containing the probability that an \"ideal\" car makes it all the way without stopping. Your answers should have an absolute error of at most $10^-6$.", "hint": "Source: ICPC 2019 World Finals.", "locale": "en", "translations": {"en": {"title": "[ICPC 2019 WF] Traffic Blights", "background": "", "description": "Cars! Where do they come from? Where do they go? Nobody knows. They appear where roads have been built, as if out of nowhere. Some say that no two cars are alike. Some say that if you look closely, you can see the pale ghosts of miserable humans inside them, trapped forever—particularly in\nthe morning and late afternoon. What scientific eye could frame their fearful symmetry?\n\nWell, yours, hopefully. As part of your government's Urban Traffic Control department, you are trying to write a paper on local traffic congestion. It is too dangerous to observe cars in the wild, of course, but you have been given some data on the traffic lights along your town's Main Street, and you would like to do some theoretical calculations about how well-synchronized they are.\n\nMain Street is set out on a line, with traffic lights placed at various points along it. Each traffic light cycles between red and green with a fixed period, being red for $r$ seconds, then green for $g$ seconds, then red for $r$ seconds, and so on. The values of $r$ and $g$ may be different for different traffic lights. At time $0$, all the lights have just turned red.\n\nAssume that an \"ideal\" car mystically appears at the west end of Main Street at a uniformly random real-valued time in the interval $[0, 2019!]$ (where $k!$ is the product of the first $k$ positive integers), driving eastwards at a slow crawl of $1$ meter/second until it hits a red light. What is the probability that it will make it through all the lights without being forced to stop? If it does hit a red light, which one is it likely to hit first?\n\nWrite a program to answer these questions.", "inputFormat": "The first line of input contains an integer $n$ ($1 \\leq n \\leq 500$), the number of traffic lights. Each of the following $n$ lines contains three integers $x$, $r$, and $g$ describing a traffic light, where $x$ ($1 \\leq x \\leq 10^5$) is the position of the light along Main Street in meters, and $r$ and $g$ ($0 \\leq r, g$ and $1 \\leq r + g \\leq 100$) are the durations in seconds of the red and green portions of the light's period (so the light is red from time $0$ to $r$, from time $r + g$ to $2r + g$, and so on).\n\nThe west end of Main Street is at position $0$, and the lights are listed in order of strictly increasing position.", "outputFormat": "For each of the $n$ lights, output a line containing the probability that this light will be the first red light an \"ideal\" car hits. Then output a line containing the probability that an \"ideal\" car makes it all the way without stopping. Your answers should have an absolute error of at most $10^-6$.", "hint": "Source: ICPC 2019 World Finals.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2019 WF] Traffic Blights", "background": "", "description": "Main 街坐落在一条东西向的直线上，上面有若干位置互异的红绿灯。每个红绿灯以某个固定周期在红绿之间循环。更具体地，它会先持续 $r$ 秒的红灯，再持续 $g$ 秒的绿灯，再持续 $r$ 秒的红灯...如此往复。对于不同的红绿灯，$r$ 和 $g$ 的值可能不同。在时刻 $0$，所有的红绿灯都恰好刚变为红灯。\n\n假设此时有一辆“理想”汽车在前 $2019!$ 秒中的一个随机实数时刻神秘地出现在了 Main 街的最西端，向东以 $1~ \\rm m/s$ 龟速行驶，直到遇到第一个红灯时停下，那么它有多大的概率通过所有红绿灯？如果它停下来了，那么它在每个红绿灯处停下的概率有多大？", "inputFormat": "第一行一个整数 $n$（$1\\le n\\le 500$） 表示红绿灯的数量。\n\n接下来每行三个整数 $x,r,g$（$1\\le x \\le 10^5$，$0\\le r,g$ 且 $1\\le r+g\\le 100$）， 描述一个位置在从西往东 $x$ 米处的，红灯持续时间为 $r$，绿灯持续时间为 $g$ 的红绿灯。\n\n最西侧即 $x=0$ 处，保证 $x$ 严格递增。", "outputFormat": "前 $n$ 行第 $i$ 行每行输出一个实数表示在第 $i$ 个红绿灯停下的概率。\n\n第 $n + 1$ 行输出一个实数表示通过所有红绿灯的概率。\n\n你需要保证绝对误差不超过 $10^{-6}$.", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6262", "type": "P", "difficulty": 7, "samples": [["10 3 5 6", "273459417"], ["2 1 3 4", "21"], ["20010910 666 1 1", "773849796"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "集训队互测", "O2优化"], "title": "[集训队互测 2019] 神树大人挥动魔杖", "background": "### 警告：恶意提交本题将被封号。\n\n神树大人想要做一根魔杖，这样他就可以使用「鸽子固定咒」把神 J 固定住了。\n\n第一天，神树大人在自己身上找了一根木头。神树大人使用了树顶上连神 J 都够不到的树枝。由于这根木头不能被凡人所理解，所以神树大人称它为「迷之木」。\n\n第二天，神树大人需要为施法创造环境。于是神树大人花了数小时造了一个完整的魔法世界，由于这个世界不能被凡人所理解，所以神树大人称它为「大象世界」。\n\n第三天，神树大人需要对迷之木附魔。于是神树大人写了一段咒语并让它在大象世界里运行，由于这段咒语不能被凡人所理解，所以神树大人称它为「花之语」。\n\n神树大人邀请神 J 来到大象世界游玩，神 J 迟了若干天才到。神 J 见神树大人嘴里念念有词，便问道：「你在干什么？」神树大人立即掏出迷之木，对准神 J 大喊道：\n\n「system call Joker remove pigeon protection！system call Joker Δεσμευτική！system call Joker ログアウト禁止！...」\n\n神 J 立刻被固定住了。神树大人很满意，于是离开了大象世界，并命令神 J 留在里面做题。由于这些题不能被凡人所理解，所以神 J 只把简化版给了你。", "description": "有一排 $n$ 个格子，有 $m$ 个人，初始都在 $1$ 号格。\n\n每个人可以选择往前跳一格或者跳两格，跳一格的方法数为 $p$，跳两格的方法数为 $q$，跳出 $n$ 个格子则停止，注意在第 $n$ 个格子仍然能选择跳一或两格。\n\n你需要计算有多少种方法使得每个格子都至少被一个人踩过。", "inputFormat": "第一行输入四个整数，$n,m,p,q$。", "outputFormat": "输出答案对 $998244353$ 取模。", "hint": "#### 数据范围及约定\n\n- 对于 $100\\%$ 的数据，满足 $1 \\le n \\le 10^9$，$1 \\le m \\le 6 \\times 10^4$，$1 \\le p,q \\in [0,998244353)$。\n\n各子任务限制如下：\n\n- 子任务 $1$（ $20$ 分）：$1 \\le n \\le 10^9$，$1 \\le m \\le 100$；\n- 子任务 $2$（ $10$ 分）：$1 \\le n \\le 10^3$；\n- 子任务 $3$（ $10$ 分）：$1 \\le n \\le 10^5$；\n- 子任务 $4$（ $20$ 分）：$1 \\le n \\le 10^9$，$1 \\le m \\le 3 \\times 10^4$，$p=q=1$；\n- 子任务 $5$（ $40$ 分）：无特殊限制；", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2019] 神树大人挥动魔杖", "background": "### 警告：恶意提交本题将被封号。\n\n神树大人想要做一根魔杖，这样他就可以使用「鸽子固定咒」把神 J 固定住了。\n\n第一天，神树大人在自己身上找了一根木头。神树大人使用了树顶上连神 J 都够不到的树枝。由于这根木头不能被凡人所理解，所以神树大人称它为「迷之木」。\n\n第二天，神树大人需要为施法创造环境。于是神树大人花了数小时造了一个完整的魔法世界，由于这个世界不能被凡人所理解，所以神树大人称它为「大象世界」。\n\n第三天，神树大人需要对迷之木附魔。于是神树大人写了一段咒语并让它在大象世界里运行，由于这段咒语不能被凡人所理解，所以神树大人称它为「花之语」。\n\n神树大人邀请神 J 来到大象世界游玩，神 J 迟了若干天才到。神 J 见神树大人嘴里念念有词，便问道：「你在干什么？」神树大人立即掏出迷之木，对准神 J 大喊道：\n\n「system call Joker remove pigeon protection！system call Joker Δεσμευτική！system call Joker ログアウト禁止！...」\n\n神 J 立刻被固定住了。神树大人很满意，于是离开了大象世界，并命令神 J 留在里面做题。由于这些题不能被凡人所理解，所以神 J 只把简化版给了你。", "description": "有一排 $n$ 个格子，有 $m$ 个人，初始都在 $1$ 号格。\n\n每个人可以选择往前跳一格或者跳两格，跳一格的方法数为 $p$，跳两格的方法数为 $q$，跳出 $n$ 个格子则停止，注意在第 $n$ 个格子仍然能选择跳一或两格。\n\n你需要计算有多少种方法使得每个格子都至少被一个人踩过。", "inputFormat": "第一行输入四个整数，$n,m,p,q$。", "outputFormat": "输出答案对 $998244353$ 取模。", "hint": "#### 数据范围及约定\n\n- 对于 $100\\%$ 的数据，满足 $1 \\le n \\le 10^9$，$1 \\le m \\le 6 \\times 10^4$，$1 \\le p,q \\in [0,998244353)$。\n\n各子任务限制如下：\n\n- 子任务 $1$（ $20$ 分）：$1 \\le n \\le 10^9$，$1 \\le m \\le 100$；\n- 子任务 $2$（ $10$ 分）：$1 \\le n \\le 10^3$；\n- 子任务 $3$（ $10$ 分）：$1 \\le n \\le 10^5$；\n- 子任务 $4$（ $20$ 分）：$1 \\le n \\le 10^9$，$1 \\le m \\le 3 \\times 10^4$，$p=q=1$；\n- 子任务 $5$（ $40$ 分）：无特殊限制；", "locale": "zh-CN"}}}
{"pid": "P6263", "type": "P", "difficulty": 1, "samples": [["AON=BOO;", "1\n0\n0\n1\n1\n0\n3\n2\n"], ["PRINT'NY'[NASLA]", "2\n1\n0\n2\n4\n1\n1\n5"], ["VIDI,KO,JE,DOSA", "1\n1\n3\n1\n1\n6\n2 \n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["字符串", "2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] STROJOPIS", "background": null, "description": "正确的打字正成为文化的重要组成部分。如果你仍然没有使用所有的十根手指来打字，你必须重新学习打字——然后你会打字更快，感觉更舒适和愉快。\n\n有很多网站教你正确打字。下图描述了基本原理：用同一根手指按所需的键是同一颜色的。黄色键需要用小指按下，蓝色键需要用无名指，绿色键需要用中指，红色键需要用食指。自然，左手按键盘的左侧（从 `5`、`T`、`G`、`B` 开始向左的键），右手按右侧（从 `6`、`Y`、`H`、`N` 开始向右的键），拇指负责空格。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qhsm2dkz.png)\n\n您的任务是输出每根手指（拇指除外）正确输入给定字符串的分别按下的次数。", "inputFormat": "仅一行一个字符串 $s$。字符串不包含空格，只包含上面图像中包含的字符。", "outputFormat": "输出必须由八行组成，每行一个整数，表示**从左到右**观察到的每个手指的按键次数（拇指除外）。", "hint": "#### 数据规模与约定\n\n令 $|s|$ 表示输入字符串的长度，则对于 $100\\%$ 的数据，有 $1\\le |s|\\le 50$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #3] STROJOPIS", "background": null, "description": "正确的打字正成为文化的重要组成部分。如果你仍然没有使用所有的十根手指来打字，你必须重新学习打字——然后你会打字更快，感觉更舒适和愉快。\n\n有很多网站教你正确打字。下图描述了基本原理：用同一根手指按所需的键是同一颜色的。黄色键需要用小指按下，蓝色键需要用无名指，绿色键需要用中指，红色键需要用食指。自然，左手按键盘的左侧（从 `5`、`T`、`G`、`B` 开始向左的键），右手按右侧（从 `6`、`Y`、`H`、`N` 开始向右的键），拇指负责空格。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qhsm2dkz.png)\n\n您的任务是输出每根手指（拇指除外）正确输入给定字符串的分别按下的次数。", "inputFormat": "仅一行一个字符串 $s$。字符串不包含空格，只包含上面图像中包含的字符。", "outputFormat": "输出必须由八行组成，每行一个整数，表示**从左到右**观察到的每个手指的按键次数（拇指除外）。", "hint": "#### 数据规模与约定\n\n令 $|s|$ 表示输入字符串的长度，则对于 $100\\%$ 的数据，有 $1\\le |s|\\le 50$。", "locale": "zh-CN"}}}
{"pid": "P6264", "type": "P", "difficulty": 3, "samples": [["3 4 2\n1 2\n2 3\n3 2", "1"], ["3 3 1\n1 2\n2 3\n3 1", "-1"], ["4 5 2\n1 3\n2 3\n3 2\n5 1", "3"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["图论", "2014", "O2优化", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] DOM", "background": "", "description": "在一个养老院里，$n$ 位老人正在看电视。这个电视节目由 $m$ 个频道组成，数字从 $1$ 到 $m$ 不等。每个老人都有自己喜欢和讨厌的电视频道。\n\n如果电视正在播放某个老人讨厌的频道，他会站起来，慢慢走向电视机，把频道换成他最喜欢的，然后回到舒适的椅子上。如果有多个老人讨厌现在的频道，他们中最年轻的会站起来，把频道换成他最喜欢的，其余的人都会坐着。\n\n当然，在一次更换频道后，另一位老人可能会觉得新频道无法忍受，所以他会更换该频道。鉴于老人们很顽固，这种情况可能会无限期地持续下去。\n\n对于老人们最喜欢和讨厌的频道以及电视上的初始频道，确定老人们保持快乐所需的频道更改次数。", "inputFormat": "输入的第一行包含三个整数 $n,m$ 和 $p$，分别表示养老院里老人的数量，  电视频道的数量和在电视上显示的初始频道。\n\n以下 $n$ 行中的每一行都包含两个整数 $a_i$ 和 $b_i$，分别表示每个老人最喜欢和最讨厌的频道。\n\n老人的输入顺序是按年龄从小到大排列的。", "outputFormat": "仅一行，输出必须包含所需的频道更改数。如果更改无限期地继续，则输出 `-1`。", "hint": "#### 样例输入输出 1 解释\n最初，电视上是 $2$ 频道。这个频道惹恼了最年轻和最年长的老人，所以最年轻的人站起来，把频道他最喜欢的改成 $1$ 频道，这样每个人都可以一起看 $1$ 频道。\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，保证 $1\\le n,m\\le 10^3$。\n- 对于 $100\\%$ 的数据，保证 $1\\le n,m\\le 10^5$，$1\\le p\\le m$，$1\\le a_i, b_i\\le m$，$a_i \\neq b_i$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #3] DOM", "background": "", "description": "在一个养老院里，$n$ 位老人正在看电视。这个电视节目由 $m$ 个频道组成，数字从 $1$ 到 $m$ 不等。每个老人都有自己喜欢和讨厌的电视频道。\n\n如果电视正在播放某个老人讨厌的频道，他会站起来，慢慢走向电视机，把频道换成他最喜欢的，然后回到舒适的椅子上。如果有多个老人讨厌现在的频道，他们中最年轻的会站起来，把频道换成他最喜欢的，其余的人都会坐着。\n\n当然，在一次更换频道后，另一位老人可能会觉得新频道无法忍受，所以他会更换该频道。鉴于老人们很顽固，这种情况可能会无限期地持续下去。\n\n对于老人们最喜欢和讨厌的频道以及电视上的初始频道，确定老人们保持快乐所需的频道更改次数。", "inputFormat": "输入的第一行包含三个整数 $n,m$ 和 $p$，分别表示养老院里老人的数量，  电视频道的数量和在电视上显示的初始频道。\n\n以下 $n$ 行中的每一行都包含两个整数 $a_i$ 和 $b_i$，分别表示每个老人最喜欢和最讨厌的频道。\n\n老人的输入顺序是按年龄从小到大排列的。", "outputFormat": "仅一行，输出必须包含所需的频道更改数。如果更改无限期地继续，则输出 `-1`。", "hint": "#### 样例输入输出 1 解释\n最初，电视上是 $2$ 频道。这个频道惹恼了最年轻和最年长的老人，所以最年轻的人站起来，把频道他最喜欢的改成 $1$ 频道，这样每个人都可以一起看 $1$ 频道。\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，保证 $1\\le n,m\\le 10^3$。\n- 对于 $100\\%$ 的数据，保证 $1\\le n,m\\le 10^5$，$1\\le p\\le m$，$1\\le a_i, b_i\\le m$，$a_i \\neq b_i$。", "locale": "zh-CN"}}}
{"pid": "P6265", "type": "P", "difficulty": 3, "samples": [["3\n1 5 4\n7 11 3\n9 13 5\n", "28\n........####\n####....#..#\n#..#..###..#\n#..#..#....#\n#..#..#....#\n************\n"], ["6\n2 8 7\n5 13 5\n2 18 3\n23 26 5\n20 31 7\n21 30 10", "61\n...................#########.\n...................#.......#.\n...................#.......#.\n######............##.......##\n#....#............#.........#\n#....######.......#.........#\n#.........#.......#.........#\n#.........######..#.........#\n#..............#..#.........#\n#..............#..#.........#\n*****************************\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2014", "O2优化", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] SILUETA", "background": "画家文森特有一次发现自己身处一个摩天大楼林立的大都市，于是他立刻下来画画，陶醉于这一美妙的景象。由于一些普通程序员无法理解的原因，文森特决定只画眼前摩天大楼的轮廓。不幸的是，在他完成这幅杰作一周后，这幅画被烧了。\n\n为了重建这幅画，文森特向各个方向寻求帮助，现在轮到你了！", "description": "从你的角度来看，文森特的摩天大楼是长方形的，它的边平行于坐标轴，一边位于横坐标上。图片的横坐标应该用字符 `*` 表示，摩天大楼的轮廓用 `#` 表示，其余部分用 `.` 表示。图像的左边缘必须以摩天大楼开始，而图像的右边缘必须以摩天大楼结束。此外，为了验证数学家得到的结果，输出给定轮廓的周长，而不是计算横坐标上的边。", "inputFormat": "第一行输入包含一个整数 $n$，即摩天大楼的数量。\n\n以下 $n$ 行中的每一行都包含三个整数 $l_i,r_i$ 和 $h_i$，分别表示第 $i$ 座摩天大楼的位置。在笛卡尔坐标系中，这座摩天大楼被认为是一个矩形，左下角在 $(l_i,0)$ 中，右上角在 $(r_i,h_i)$ 中。", "outputFormat": "第一行输出一个整数，表示摩天大楼轮廓的周长。\n\n接下来的 $h+1$ 行，其中 $h+1$ 是最高摩天大楼的高度，必须包含题目描述中描述的文森特的绘图。", "hint": "#### 样例输入输出 1 解释 \n\n如下图，蓝色表示摩天大楼的轮廓（字符 `#`），而黄色是文森特绘画中横坐标的一部分（字符 `*`）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ynl2n5os.png)\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，保证 $1\\le n\\le 100$，$1\\le l_i,r_i,h_i\\le 100$。\n- 对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^4$，$1\\le l_i,r_i,h_i\\le 10^3$，$3 \\leq r_i - l_i \\leq 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #3] SILUETA", "background": "画家文森特有一次发现自己身处一个摩天大楼林立的大都市，于是他立刻下来画画，陶醉于这一美妙的景象。由于一些普通程序员无法理解的原因，文森特决定只画眼前摩天大楼的轮廓。不幸的是，在他完成这幅杰作一周后，这幅画被烧了。\n\n为了重建这幅画，文森特向各个方向寻求帮助，现在轮到你了！", "description": "从你的角度来看，文森特的摩天大楼是长方形的，它的边平行于坐标轴，一边位于横坐标上。图片的横坐标应该用字符 `*` 表示，摩天大楼的轮廓用 `#` 表示，其余部分用 `.` 表示。图像的左边缘必须以摩天大楼开始，而图像的右边缘必须以摩天大楼结束。此外，为了验证数学家得到的结果，输出给定轮廓的周长，而不是计算横坐标上的边。", "inputFormat": "第一行输入包含一个整数 $n$，即摩天大楼的数量。\n\n以下 $n$ 行中的每一行都包含三个整数 $l_i,r_i$ 和 $h_i$，分别表示第 $i$ 座摩天大楼的位置。在笛卡尔坐标系中，这座摩天大楼被认为是一个矩形，左下角在 $(l_i,0)$ 中，右上角在 $(r_i,h_i)$ 中。", "outputFormat": "第一行输出一个整数，表示摩天大楼轮廓的周长。\n\n接下来的 $h+1$ 行，其中 $h+1$ 是最高摩天大楼的高度，必须包含题目描述中描述的文森特的绘图。", "hint": "#### 样例输入输出 1 解释 \n\n如下图，蓝色表示摩天大楼的轮廓（字符 `#`），而黄色是文森特绘画中横坐标的一部分（字符 `*`）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ynl2n5os.png)\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，保证 $1\\le n\\le 100$，$1\\le l_i,r_i,h_i\\le 100$。\n- 对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^4$，$1\\le l_i,r_i,h_i\\le 10^3$，$3 \\leq r_i - l_i \\leq 10^3$。", "locale": "zh-CN"}}}
{"pid": "P6267", "type": "P", "difficulty": 3, "samples": [["9", "3"], ["11", "2"], ["12", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2002", "各省省选", "上海"], "title": "[SHOI2002] N的连续数拆分", "background": "", "description": "所有的正整数均可以表示为一个、两个或者多个连续正整数的和。\n\n给定一个不超过 $9\\times 10^{14}$ 的正整数，求出它可以用几种不同的方法表示成连续正整数之和。例如给出 $9$，则有三种方式：$9,4+5,2+3+4$。", "inputFormat": "输入一个正整数 $n$，表示要被拆分的正整数。", "outputFormat": "输出方法个数。", "hint": "$n \\leq 9\\times 10^{14}$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHOI2002] N的连续数拆分", "background": "", "description": "所有的正整数均可以表示为一个、两个或者多个连续正整数的和。\n\n给定一个不超过 $9\\times 10^{14}$ 的正整数，求出它可以用几种不同的方法表示成连续正整数之和。例如给出 $9$，则有三种方式：$9,4+5,2+3+4$。", "inputFormat": "输入一个正整数 $n$，表示要被拆分的正整数。", "outputFormat": "输出方法个数。", "hint": "$n \\leq 9\\times 10^{14}$", "locale": "zh-CN"}}}
{"pid": "P6268", "type": "P", "difficulty": 5, "samples": [["8 6\n0 2\n2 3\n3 5\n1 4\n1 6\n3 1", "5"], ["20 5\n5 2\n4 3\n18 17\n0 11\n13 3\n", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2002", "各省省选", "网络流", "上海", "图论建模", "二分图"], "title": "[SHOI2002] 舞会", "background": "", "description": "某学校要召开一个舞会。已知学校所有 $n$ 名学生中，有些学生曾经互相跳过舞。当然跳过舞的学生一定是一个男生和一个女生。在这个舞会上，要求被邀请的学生中的任何一对男生和女生互相都不能跳过舞。求这个舞会最多能邀请多少个学生参加。", "inputFormat": "输入的第一行是 $n$ 和 $m$ 。其中 $n$ 是可选的学生的总数， $m$ 是已知跳过舞的学生的对数 ( $n \\leq 1000$ ， $m \\leq 2000$ ）。\n\n然后有 $m$ 行，每行包括两个非负整数，表示这两个编号的学生曾经跳过舞。学生的编号从 $0$ 号到 $n - 1$ 号。", "outputFormat": "输出文件仅一行，为一个数字，即能够邀请的最多的学生数。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHOI2002] 舞会", "background": "", "description": "某学校要召开一个舞会。已知学校所有 $n$ 名学生中，有些学生曾经互相跳过舞。当然跳过舞的学生一定是一个男生和一个女生。在这个舞会上，要求被邀请的学生中的任何一对男生和女生互相都不能跳过舞。求这个舞会最多能邀请多少个学生参加。", "inputFormat": "输入的第一行是 $n$ 和 $m$ 。其中 $n$ 是可选的学生的总数， $m$ 是已知跳过舞的学生的对数 ( $n \\leq 1000$ ， $m \\leq 2000$ ）。\n\n然后有 $m$ 行，每行包括两个非负整数，表示这两个编号的学生曾经跳过舞。学生的编号从 $0$ 号到 $n - 1$ 号。", "outputFormat": "输出文件仅一行，为一个数字，即能够邀请的最多的学生数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6269", "type": "P", "difficulty": 3, "samples": [["6", "9"], ["11", "30"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "图论", "2002", "各省省选", "上海"], "title": "[SHOI2002] 空中都市", "background": "", "description": "在未来的空中都市中，有很多个小岛（城区）。现在要求在这些小岛之间架一座桥梁，每座桥是指在两个岛之间的通道。\n\n有个约定，如果 $A$ 与 $B$ 之间有桥，$B$ 与 $C$ 之间有桥，则 $A$ 与 $C$ 之间就不能再架桥了，即对于城市中的任意三个岛，不能在其中的两两之间都架上桥。在这样的约定下，要求架的桥的数量最多。当然不必考虑具体的空间结构问题。", "inputFormat": "输入文件只包含一行，其中仅包含一个非负整数 $n (0 \\leq n \\leq 1000)$，表示小岛的数量。", "outputFormat": "输出文件也只包含一行，即表示最多能架设的桥梁数量。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHOI2002] 空中都市", "background": "", "description": "在未来的空中都市中，有很多个小岛（城区）。现在要求在这些小岛之间架一座桥梁，每座桥是指在两个岛之间的通道。\n\n有个约定，如果 $A$ 与 $B$ 之间有桥，$B$ 与 $C$ 之间有桥，则 $A$ 与 $C$ 之间就不能再架桥了，即对于城市中的任意三个岛，不能在其中的两两之间都架上桥。在这样的约定下，要求架的桥的数量最多。当然不必考虑具体的空间结构问题。", "inputFormat": "输入文件只包含一行，其中仅包含一个非负整数 $n (0 \\leq n \\leq 1000)$，表示小岛的数量。", "outputFormat": "输出文件也只包含一行，即表示最多能架设的桥梁数量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6270", "type": "P", "difficulty": 7, "samples": [["2\n3 7\n1 7\n1 6\n5 1\n2 7\n1 7\n7 1", "7 5\n0 1 5\n1 3 1\n0 1 7\n0 2 6\n0 3 1\n0 3\n0 1 7\n1 2 1\n0 2 1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2014", "Special Judge", "湖北"], "title": "[湖北省队互测 2014] 十万人的地铁", "background": "", "description": "从前有两个人叫陆仁甲和陆仁乙，他们去搭地铁。\n\n陆仁甲要从循礼门出发去广埠屯，而陆仁乙要从广埠屯出发去循礼门。\n\n作为地铁的脑残粉，陆仁甲和陆仁乙很清楚武汉地铁收费的规则。\n\n武汉地铁 $2$ 号线是一条直线，一共 $m$ 个地铁站，依次编号为 $1,\\cdots,m$。\n\n搭乘地铁需要刷一种叫武汉通的公交卡。进站时刷一次，出站时刷一次，在出站时会根据起始站和终点站之间的距离给武汉通扣费。即，如果设 $cost(i, j)$ 表示从编号为 $i$ 的地铁站进，从编号为 $j$ 的地铁站出的代价，则：\n\n$$cost(i,j)=|i-j|$$\n\n机智的陆仁甲和陆仁乙发现，乘车时的起始站是在进站刷卡时记录在武汉通上面的。而且计费跟乘车时间无关，你可以在 $i$ 站进站，在地铁上玩一整天后从 $j$ 站出站，还是付出 $cost(i,j)$ 的代价。\n\n于是陆仁甲和陆仁乙灵机一动，想出了一个绝妙的免费乘车方案。\n\n首先，陆仁甲从循礼门站进站出发，在中途的螃蟹岬站下车逗留。与此同时，陆仁乙从广埠屯站进站出发，也在中途的螃蟹岬站下车逗留。\n\n接着陆仁甲与陆仁乙在螃蟹岬站会面，交换武汉通。\n\n最后，陆仁甲乘地铁前往广埠屯站，此时陆仁甲的武汉通记录的起始站是广埠屯站，所以扣费 $0$ 元。\n\n陆仁乙乘地铁前往循礼门站，此时陆仁乙的武汉通记录的起始站是循礼门站，所以也扣费 $0$ 元。\n\n这样他们就完成了一次免费乘车。\n\n于是陆仁甲和陆仁乙开始思考：假设有 $n$ 个人来搭地铁，分别编号为 $1,\\cdots,n$，第 $i$ 人从第 $s_i$ 站出发去第 $e_i$ 站 $s_i\\ne e_i$，沿最短路坐地铁。即：\n\n- 若 $s_i<e_i$ 则依次经过 $s_i,s_i+1,\\cdots,e_i-1,e_i$。\n- 若 $s_i>e_i$ 则依次经过 $s_i,s_i-1,\\cdots,e_i+1,e_i$。\n\n那么假设他们足够聪明，会在中途下车换票，那么他们乘车的**最小**总代价是多少？\n\n具体乘车方式说明如下：\n\n- 一开始，所有人刷卡进站，第 $i$ 个人在第 $s_i$ 站。\n- 每次可以进行如下两个操作之一：\n- $0\\;x\\;y$：让编号为 $x$ 的人乘地铁到第 $y$ 站下车。**不允许绕路**，即必须往接近 $e_x$ 的方向乘车。而且**不允许从原地出发前往原地**，即 $y$ 不能是第 $x$ 个人现在所在的地铁站编号。你需要保证 $1\\le x\\le n,1\\le y\\le m$。\n- $1\\;x\\;y$：让编号为 $x$ 的人和编号为 $y$ 的人交换武汉通。注意**此时在同一个地铁站的两人**才可以交换车票。你需要保证 $1\\le x\\le n,1\\le y\\le n$。\n- 每次操作时，没有在操作中提到的人会在原地逗留。\n- 所有操作结束后，所有人一起刷卡出站。注意要保证**第 $\\boldsymbol i$ 个人此时在第 $\\boldsymbol{e_i}$ 站**。\n- 最后要使得所有人出站后，武汉通上扣费总和**最小**。求一个最小的乘车方案。\n\n陆仁甲和陆仁乙当然知道怎么做啦！但是他们想考考你……", "inputFormat": "第一行一个正整数 $T$，表示有几组数据。接下来有 $T$ 个数据，对于每组数据：\n\n第一行两个用空格隔开的正整数 $n,m$。表示有 $n$ 个人，$m$ 个地铁站。\n\n接下来 $n$ 行每行两个用空格隔开的正整数 $s_i,e_i$。表示第 $i$ 个人的起始站和终点站。（$s_i\\ne e_i,1\\le s_i,e_i\\le m$）", "outputFormat": "对于每组数据，输出一个最优方案。如果有多组都能让扣费总和最小，输出任意一组即可。\n\n第一行有两个用空格隔开的非负整数 $ans,s$，分别表示最小总代价和操作数。操作数不能太大，要满足 $s\\le400000$。\n\n接下来 $s$ 行每行三个正整数 $type\\;x\\;y$ 表示一个操作。（$type\\in\\{0,1\\}$，$x,y$ 的限制如前所述）", "hint": "对于所有数据，$T\\le6$。\n\n| 编号 | $\\boldsymbol n$ | $\\boldsymbol m$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $=2$ | $=1000$ |\n| $2$ | $=100$ | $=2$ |\n| $3$ | $=4$ | $=5$ |\n| $4$ | $\\le40$ | $\\le100$ |\n| $5\\sim6$ | $\\le100$ | $\\le1000$ |\n| $7\\sim8$ | $\\le2000$ | $\\le2\\times10^4$ |\n| $9$ | $\\le6\\times10^4$ | $\\le10^5$ |\n| $10$ | $\\le10^5$ | $\\le10^6$ |\n\n\n（本题纯属 VFleaKing 脑洞……亲测表示进站再出站扣费 $1.8$ 元，所以不要尝试模仿题目描述中的行为……）\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省队互测 2014] 十万人的地铁", "background": "", "description": "从前有两个人叫陆仁甲和陆仁乙，他们去搭地铁。\n\n陆仁甲要从循礼门出发去广埠屯，而陆仁乙要从广埠屯出发去循礼门。\n\n作为地铁的脑残粉，陆仁甲和陆仁乙很清楚武汉地铁收费的规则。\n\n武汉地铁 $2$ 号线是一条直线，一共 $m$ 个地铁站，依次编号为 $1,\\cdots,m$。\n\n搭乘地铁需要刷一种叫武汉通的公交卡。进站时刷一次，出站时刷一次，在出站时会根据起始站和终点站之间的距离给武汉通扣费。即，如果设 $cost(i, j)$ 表示从编号为 $i$ 的地铁站进，从编号为 $j$ 的地铁站出的代价，则：\n\n$$cost(i,j)=|i-j|$$\n\n机智的陆仁甲和陆仁乙发现，乘车时的起始站是在进站刷卡时记录在武汉通上面的。而且计费跟乘车时间无关，你可以在 $i$ 站进站，在地铁上玩一整天后从 $j$ 站出站，还是付出 $cost(i,j)$ 的代价。\n\n于是陆仁甲和陆仁乙灵机一动，想出了一个绝妙的免费乘车方案。\n\n首先，陆仁甲从循礼门站进站出发，在中途的螃蟹岬站下车逗留。与此同时，陆仁乙从广埠屯站进站出发，也在中途的螃蟹岬站下车逗留。\n\n接着陆仁甲与陆仁乙在螃蟹岬站会面，交换武汉通。\n\n最后，陆仁甲乘地铁前往广埠屯站，此时陆仁甲的武汉通记录的起始站是广埠屯站，所以扣费 $0$ 元。\n\n陆仁乙乘地铁前往循礼门站，此时陆仁乙的武汉通记录的起始站是循礼门站，所以也扣费 $0$ 元。\n\n这样他们就完成了一次免费乘车。\n\n于是陆仁甲和陆仁乙开始思考：假设有 $n$ 个人来搭地铁，分别编号为 $1,\\cdots,n$，第 $i$ 人从第 $s_i$ 站出发去第 $e_i$ 站 $s_i\\ne e_i$，沿最短路坐地铁。即：\n\n- 若 $s_i<e_i$ 则依次经过 $s_i,s_i+1,\\cdots,e_i-1,e_i$。\n- 若 $s_i>e_i$ 则依次经过 $s_i,s_i-1,\\cdots,e_i+1,e_i$。\n\n那么假设他们足够聪明，会在中途下车换票，那么他们乘车的**最小**总代价是多少？\n\n具体乘车方式说明如下：\n\n- 一开始，所有人刷卡进站，第 $i$ 个人在第 $s_i$ 站。\n- 每次可以进行如下两个操作之一：\n- $0\\;x\\;y$：让编号为 $x$ 的人乘地铁到第 $y$ 站下车。**不允许绕路**，即必须往接近 $e_x$ 的方向乘车。而且**不允许从原地出发前往原地**，即 $y$ 不能是第 $x$ 个人现在所在的地铁站编号。你需要保证 $1\\le x\\le n,1\\le y\\le m$。\n- $1\\;x\\;y$：让编号为 $x$ 的人和编号为 $y$ 的人交换武汉通。注意**此时在同一个地铁站的两人**才可以交换车票。你需要保证 $1\\le x\\le n,1\\le y\\le n$。\n- 每次操作时，没有在操作中提到的人会在原地逗留。\n- 所有操作结束后，所有人一起刷卡出站。注意要保证**第 $\\boldsymbol i$ 个人此时在第 $\\boldsymbol{e_i}$ 站**。\n- 最后要使得所有人出站后，武汉通上扣费总和**最小**。求一个最小的乘车方案。\n\n陆仁甲和陆仁乙当然知道怎么做啦！但是他们想考考你……", "inputFormat": "第一行一个正整数 $T$，表示有几组数据。接下来有 $T$ 个数据，对于每组数据：\n\n第一行两个用空格隔开的正整数 $n,m$。表示有 $n$ 个人，$m$ 个地铁站。\n\n接下来 $n$ 行每行两个用空格隔开的正整数 $s_i,e_i$。表示第 $i$ 个人的起始站和终点站。（$s_i\\ne e_i,1\\le s_i,e_i\\le m$）", "outputFormat": "对于每组数据，输出一个最优方案。如果有多组都能让扣费总和最小，输出任意一组即可。\n\n第一行有两个用空格隔开的非负整数 $ans,s$，分别表示最小总代价和操作数。操作数不能太大，要满足 $s\\le400000$。\n\n接下来 $s$ 行每行三个正整数 $type\\;x\\;y$ 表示一个操作。（$type\\in\\{0,1\\}$，$x,y$ 的限制如前所述）", "hint": "对于所有数据，$T\\le6$。\n\n| 编号 | $\\boldsymbol n$ | $\\boldsymbol m$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $=2$ | $=1000$ |\n| $2$ | $=100$ | $=2$ |\n| $3$ | $=4$ | $=5$ |\n| $4$ | $\\le40$ | $\\le100$ |\n| $5\\sim6$ | $\\le100$ | $\\le1000$ |\n| $7\\sim8$ | $\\le2000$ | $\\le2\\times10^4$ |\n| $9$ | $\\le6\\times10^4$ | $\\le10^5$ |\n| $10$ | $\\le10^5$ | $\\le10^6$ |\n\n\n（本题纯属 VFleaKing 脑洞……亲测表示进站再出站扣费 $1.8$ 元，所以不要尝试模仿题目描述中的行为……）\n", "locale": "zh-CN"}}}
{"pid": "P6271", "type": "P", "difficulty": 6, "samples": [["3 2 \n2 1 \n5 1", "1100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "莫比乌斯反演", "湖北"], "title": "[湖北省队互测2014] 一个人的数论", "background": "题目来源：$2014$ 年湖北省队互测Week1\n\n资源来源：[链接](https://tieba.baidu.com/p/3050650090?red_tag=3002680446)", "description": "有一天 hjy96 想到了一个数论问题:\n\n对于一个非负整数 $d$ 和一个正整数 $n$，定义 $f_d(n)$ 为所有小于 $n$ 且与 $n$ 互质的正整数的 $d$ 次方之和。如 $f_3(10) = 1^3 +3^3 +7^3 +9^3$。\n\n现给定 $d, n$，求 $f_d(n)$ 的值。输出答案对 $10^9 + 7$ 取模后的结果。 \n\nhjy96 当然知道怎么做啦! 但是他想考考你......", "inputFormat": "由于 $n$ 可能很大，我们给出 $n$ 的质因数分解式。\n\n$$\nn=\\prod_{i=1}^{w} p_{i}^{\\alpha_{i}}\n$$\n\n第一行有用空格隔开的一个非负整数 $d$, 一个正整数 $w$。\n接下来 $w$ 行，每行有两个用空格隔开的正整数 $p_i$, $\\alpha_i$。(保证 $p_i$ 为素数且互不相同)", "outputFormat": "一行，一个非负整数表示 $f_d(n)$ 对 $10^9 + 7$ 取模后的结果。", "hint": "#### 数据规模与约定\n\n各测试点信息如下表\n\n| 编号 | $d$ | 特殊限制 |\n| :---: | :---: | :---------: |\n| 1 | $\\leq 100$ | $n \\leq 10^5$ |\n| 2 | $=0$ | 无 |\n| 3 | $=1$ | 无 |\n| 4 | $=2$ | 无 |\n| 5 | $\\leq 100$ | $w = 1$，$ \\alpha_1 = 1$ |\n| 6 | $\\leq 100$ | $w = 1$，$ \\alpha_1 = 1$ |\n| 7 | $\\leq 100$ | $ \\prod_{i = 1}^w (\\alpha_i + 1) \\leq 10^5$ |\n| 8 | $\\leq 100$ | $w \\leq 16$ |\n| 9 | $\\leq 100$ | 无 |\n| 10 | $\\leq 100$ | 无 |\n\n对于全部的测试点，保证 $1 \\leq w \\leq 10^3$，$2 \\leq p_i \\leq 10^9$，$1 \\leq \\alpha_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省队互测2014] 一个人的数论", "background": "题目来源：$2014$ 年湖北省队互测Week1\n\n资源来源：[链接](https://tieba.baidu.com/p/3050650090?red_tag=3002680446)", "description": "有一天 hjy96 想到了一个数论问题:\n\n对于一个非负整数 $d$ 和一个正整数 $n$，定义 $f_d(n)$ 为所有小于 $n$ 且与 $n$ 互质的正整数的 $d$ 次方之和。如 $f_3(10) = 1^3 +3^3 +7^3 +9^3$。\n\n现给定 $d, n$，求 $f_d(n)$ 的值。输出答案对 $10^9 + 7$ 取模后的结果。 \n\nhjy96 当然知道怎么做啦! 但是他想考考你......", "inputFormat": "由于 $n$ 可能很大，我们给出 $n$ 的质因数分解式。\n\n$$\nn=\\prod_{i=1}^{w} p_{i}^{\\alpha_{i}}\n$$\n\n第一行有用空格隔开的一个非负整数 $d$, 一个正整数 $w$。\n接下来 $w$ 行，每行有两个用空格隔开的正整数 $p_i$, $\\alpha_i$。(保证 $p_i$ 为素数且互不相同)", "outputFormat": "一行，一个非负整数表示 $f_d(n)$ 对 $10^9 + 7$ 取模后的结果。", "hint": "#### 数据规模与约定\n\n各测试点信息如下表\n\n| 编号 | $d$ | 特殊限制 |\n| :---: | :---: | :---------: |\n| 1 | $\\leq 100$ | $n \\leq 10^5$ |\n| 2 | $=0$ | 无 |\n| 3 | $=1$ | 无 |\n| 4 | $=2$ | 无 |\n| 5 | $\\leq 100$ | $w = 1$，$ \\alpha_1 = 1$ |\n| 6 | $\\leq 100$ | $w = 1$，$ \\alpha_1 = 1$ |\n| 7 | $\\leq 100$ | $ \\prod_{i = 1}^w (\\alpha_i + 1) \\leq 10^5$ |\n| 8 | $\\leq 100$ | $w \\leq 16$ |\n| 9 | $\\leq 100$ | 无 |\n| 10 | $\\leq 100$ | 无 |\n\n对于全部的测试点，保证 $1 \\leq w \\leq 10^3$，$2 \\leq p_i \\leq 10^9$，$1 \\leq \\alpha_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6272", "type": "P", "difficulty": 7, "samples": [["5 10 \nC 1 1 1 \nC 2 1 2 \nQ 1 2 \nC 4 4 4 \nC 5 5 5 \nQ 4 5 \nQ 3 3 \nC 4 2 3 \nC 4 4 4 \nQ 3 4", "2\n4\n3\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "湖北"], "title": "[湖北省队互测2014] 没有人的算术", "background": "题目来源：$2014$ 年湖北省队互测Week1\n\n资源来源：[链接](https://tieba.baidu.com/p/3050650090?red_tag=3002680446)", "description": "万物初始之前，宇宙是无边无际混沌的黑暗，只有上帝之灵穿行其间。\n\n上帝对这无边的黑暗十分不满，就一挥手说:“要有光”，于是世间就有了光。从此，世间 就有了昼与夜的交替。这是上帝创世的第一天。\n\n第二天，上帝仍不满意眼前空洞的景象，就一挥手说：“要有零”。于是世间出现了第一个数：$0$。\n\n第三天，上帝对只有 $0$ 很不满意，就一挥手说：“要有非零数”。于是上帝开始创造新数，每个新数用一个已经创造出来的数的有序对表示，即：\n\n$$\nx = (x_L, x_R)\n$$\n\n于是世间出现了 $(0, 0), (0, (0, 0)), ((0, 0), 0), ((0, 0), (0, 0)), ...$。到了晚上，各种各样千奇百怪的数在大地上奔腾。\n（注：上帝造的这个 “数” 与普通的自然数、有理数之类的不同，这种数是以如上所述的方式递归定义的，总是数对里面是数对，拆分到最后会得到不可再拆的 $0$）\n\n第四天，上帝看到各个数不分彼此，就一挥手说：“要有区别”。于是为了区分每个数，上帝定义等于：\n\n1.  $0 = 0$ 。\n\n2.  对于任意 $x_L, x_R, y_L, y_R$，若 $x_L = y_L$ 且 $x_R = y_R$，则 $(x_L, x_R) = (y_L, y_R)$。\n\n3.  对于任意 $x, y$，$x = y$ 当且仅当满足以上条件之一。反之记作 $x \\not = y$。\n\n第五天，上帝看到各个数乱成一团，就一挥手说：“要有序”。于是为了比较每个数，上帝定义小于：\n\n1. 对于任意 $x$，若 $x\\not = 0$，则 $0 < x$。\n2. 对于任意 $x_L, x_R, y_L, y_R$，若 $x_L < y_L$，则 $(x_L, x_R) < (y_L, y_R)$ 。\n3. 对于任意 $x_L, x_R, y_L, y_R$，若 $x_L = y_L$ 且 $x_R < y_R$，则 $(x_L, x_R) < (y_L, y_R)$。\n4. 对于任意 $x, y$，$x < y$ 当且仅当满足以上条件之一。反之记作 $x\\not < y$。\n\n在此基础上定义小于等于：$x ≤ y \\iff x < y$ 或 $x = y$ 。容易发现：\n\n1. $x ≤ y, y ≤ x ⇒ x = y$ 。\n2. $x ≤ y, y ≤ z ⇒ x ≤ z$ 。\n3. $x ≤ y$ 或 $y ≤ x$ 。\n\n进而定义：\n\n1. $x > y \\Longleftrightarrow  y < x$ 。\n2. $x ≥ y \\Longleftrightarrow   x\\not < y$。\n\n\f至此万物欣欣向荣，和睦一堂。\n\n第六天，由于之前沉迷与算术而忘记去造核酸和蛋白质，所以上帝没办法造人。但是上帝不甘心，就一挥手说：“要有跳蚤”，于是用泥巴捏出了神奇生物跳蚤。\n\n上帝用五天的时间造出天地万物，又在第六天造出了唯一的生命——跳蚤。上帝看到天地万物井然有序、生生不息，自己造的跳蚤正在开心地和数学玩耍，很高兴，便决定把第七天作为休息的日子。\n\n跳蚤每天的生活很简单。一天开始时，他会取一个长度为 $n$ 的数组 $a[1,2,\\cdots,n]$，初始时均为 $0$。\n\n接着他会不断地做下列两件事之一：\n\n1. 在头脑中产生三个正整数 $l, r, k$，然后把 $a[k]$ 重新赋值为 $(a[l], a[r])$ 。特别地，如果 $l = k$ 或 $r = k$ 也是合法的，这不会导致错误，因为跳蚤总是先默默算出 $(a[l], a[r])$ 再给 $a[k]$ 赋值。\n\n    保证 $1 ≤ l, r, k ≤ n$。\n\n2. 在头脑中产生两个正整数 $l, r$，然后计算 $a[l], a[l + 1], \\cdots, a[r − 1], a[r]$ 中的最大值。\n\n     保证 $1 ≤ l ≤ r ≤ n$。\n\n跳蚤当然知道怎么做啦！但是他想考考你……", "inputFormat": "第一行两个正整数 $n, m$，表示长度为 $n$ 的数组，共 $m$ 个操作。接下来 $m$ 行每行表示一个操作:\n\n1. `C l r k` : 赋值操作，执行 $ a[k] = (a[l], a[r])$ 。\n\n2. `Q l r`: 询问操作，计算 $a[l], a[l + 1], ..., a[r − 1], a[r]$ 中的最大值。输出最大值对应的下标。 如果有多个最大值那么取下标最小的那一个。", "outputFormat": "对于每个询问操作输出一行表示相应的结果。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/bj1dxhbv.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省队互测2014] 没有人的算术", "background": "题目来源：$2014$ 年湖北省队互测Week1\n\n资源来源：[链接](https://tieba.baidu.com/p/3050650090?red_tag=3002680446)", "description": "万物初始之前，宇宙是无边无际混沌的黑暗，只有上帝之灵穿行其间。\n\n上帝对这无边的黑暗十分不满，就一挥手说:“要有光”，于是世间就有了光。从此，世间 就有了昼与夜的交替。这是上帝创世的第一天。\n\n第二天，上帝仍不满意眼前空洞的景象，就一挥手说：“要有零”。于是世间出现了第一个数：$0$。\n\n第三天，上帝对只有 $0$ 很不满意，就一挥手说：“要有非零数”。于是上帝开始创造新数，每个新数用一个已经创造出来的数的有序对表示，即：\n\n$$\nx = (x_L, x_R)\n$$\n\n于是世间出现了 $(0, 0), (0, (0, 0)), ((0, 0), 0), ((0, 0), (0, 0)), ...$。到了晚上，各种各样千奇百怪的数在大地上奔腾。\n（注：上帝造的这个 “数” 与普通的自然数、有理数之类的不同，这种数是以如上所述的方式递归定义的，总是数对里面是数对，拆分到最后会得到不可再拆的 $0$）\n\n第四天，上帝看到各个数不分彼此，就一挥手说：“要有区别”。于是为了区分每个数，上帝定义等于：\n\n1.  $0 = 0$ 。\n\n2.  对于任意 $x_L, x_R, y_L, y_R$，若 $x_L = y_L$ 且 $x_R = y_R$，则 $(x_L, x_R) = (y_L, y_R)$。\n\n3.  对于任意 $x, y$，$x = y$ 当且仅当满足以上条件之一。反之记作 $x \\not = y$。\n\n第五天，上帝看到各个数乱成一团，就一挥手说：“要有序”。于是为了比较每个数，上帝定义小于：\n\n1. 对于任意 $x$，若 $x\\not = 0$，则 $0 < x$。\n2. 对于任意 $x_L, x_R, y_L, y_R$，若 $x_L < y_L$，则 $(x_L, x_R) < (y_L, y_R)$ 。\n3. 对于任意 $x_L, x_R, y_L, y_R$，若 $x_L = y_L$ 且 $x_R < y_R$，则 $(x_L, x_R) < (y_L, y_R)$。\n4. 对于任意 $x, y$，$x < y$ 当且仅当满足以上条件之一。反之记作 $x\\not < y$。\n\n在此基础上定义小于等于：$x ≤ y \\iff x < y$ 或 $x = y$ 。容易发现：\n\n1. $x ≤ y, y ≤ x ⇒ x = y$ 。\n2. $x ≤ y, y ≤ z ⇒ x ≤ z$ 。\n3. $x ≤ y$ 或 $y ≤ x$ 。\n\n进而定义：\n\n1. $x > y \\Longleftrightarrow  y < x$ 。\n2. $x ≥ y \\Longleftrightarrow   x\\not < y$。\n\n\f至此万物欣欣向荣，和睦一堂。\n\n第六天，由于之前沉迷与算术而忘记去造核酸和蛋白质，所以上帝没办法造人。但是上帝不甘心，就一挥手说：“要有跳蚤”，于是用泥巴捏出了神奇生物跳蚤。\n\n上帝用五天的时间造出天地万物，又在第六天造出了唯一的生命——跳蚤。上帝看到天地万物井然有序、生生不息，自己造的跳蚤正在开心地和数学玩耍，很高兴，便决定把第七天作为休息的日子。\n\n跳蚤每天的生活很简单。一天开始时，他会取一个长度为 $n$ 的数组 $a[1,2,\\cdots,n]$，初始时均为 $0$。\n\n接着他会不断地做下列两件事之一：\n\n1. 在头脑中产生三个正整数 $l, r, k$，然后把 $a[k]$ 重新赋值为 $(a[l], a[r])$ 。特别地，如果 $l = k$ 或 $r = k$ 也是合法的，这不会导致错误，因为跳蚤总是先默默算出 $(a[l], a[r])$ 再给 $a[k]$ 赋值。\n\n    保证 $1 ≤ l, r, k ≤ n$。\n\n2. 在头脑中产生两个正整数 $l, r$，然后计算 $a[l], a[l + 1], \\cdots, a[r − 1], a[r]$ 中的最大值。\n\n     保证 $1 ≤ l ≤ r ≤ n$。\n\n跳蚤当然知道怎么做啦！但是他想考考你……", "inputFormat": "第一行两个正整数 $n, m$，表示长度为 $n$ 的数组，共 $m$ 个操作。接下来 $m$ 行每行表示一个操作:\n\n1. `C l r k` : 赋值操作，执行 $ a[k] = (a[l], a[r])$ 。\n\n2. `Q l r`: 询问操作，计算 $a[l], a[l + 1], ..., a[r − 1], a[r]$ 中的最大值。输出最大值对应的下标。 如果有多个最大值那么取下标最小的那一个。", "outputFormat": "对于每个询问操作输出一行表示相应的结果。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/bj1dxhbv.png)", "locale": "zh-CN"}}}
{"pid": "P6273", "type": "P", "difficulty": 4, "samples": [["8\nabccbabc", "4"], ["7\nabcABCC", "1"], ["20\nSwSSSwwwwSwSwwSwwwwS", "22"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "枚举", "eJOI（欧洲）", "前缀和"], "title": "[eJOI 2017] 魔法", "background": "", "description": "给定一个长度为 $n$ 的字符串 $S$。设 $S$ 中不同的字符数为 $k$ 。\n\n定义字符串的子串为该字符串某一连续段。\n\n而 ***有魔法的子串*** 被定义为 $S$ **的某一非空子串，满足该子串中不同的字符数为** $k$ **，且每个字符的出现的次数都相同**。\n\n你需要求出给定字符串 $S$ 的不同的 有魔法的子串 的个数。\n\n若两个子串的左右端点不同，则这两个子串不同。", "inputFormat": "第一行：一个整数 $n$ 表示字符串长度。\n\n第二行：一个字符串 $S$ 。", "outputFormat": "一个整数表示答案 $\\bmod (10^9+7)$ 的值。", "hint": "#### 【输入输出样例解释】\n\n**样例 1 解释**\n\n- 满足条件的子串有： $\\texttt{abc},\\texttt{cba},\\texttt{abc},\\texttt{abccba}$\n\n**样例 2 解释**\n\n- 仅子串 $\\texttt{abcABC}$ 为 有魔法的子串（区分大小写，即 $\\texttt{a}\\ne \\texttt{A}$）。\n\n**样例 3 解释**\n\n- 其中一个是 $\\texttt{SwSwwS}$。\n\n#### 【数据规模与约定】\n\n**本题采用多测试点捆绑测试，共有 4 个子任务**。\n\n- Subtask 1（10 points）：$2\\le n\\le 100$。\n- Subtask 2（20 points）：$2\\le n\\le 2\\times 10^3$。\n- Subtask 3（30 points）：$2\\le n\\le 10^5,k=2$ （即 $S$ 中只有两种字符）。\n- Subtask 4（40 points）：无其他限制。\n\n对于所有数据，保证 $2\\le n\\le 10^5$，字符集为 $ [\\texttt{a},\\texttt{z}] \\cup [\\texttt{A},\\texttt{Z}]$\n\n#### 【说明】\n\n原题来自：[eJOI 2017](www.ejoi.org) Problem A [Magic](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_1/EN/magic_statement-en.pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2017] 魔法", "background": "", "description": "给定一个长度为 $n$ 的字符串 $S$。设 $S$ 中不同的字符数为 $k$ 。\n\n定义字符串的子串为该字符串某一连续段。\n\n而 ***有魔法的子串*** 被定义为 $S$ **的某一非空子串，满足该子串中不同的字符数为** $k$ **，且每个字符的出现的次数都相同**。\n\n你需要求出给定字符串 $S$ 的不同的 有魔法的子串 的个数。\n\n若两个子串的左右端点不同，则这两个子串不同。", "inputFormat": "第一行：一个整数 $n$ 表示字符串长度。\n\n第二行：一个字符串 $S$ 。", "outputFormat": "一个整数表示答案 $\\bmod (10^9+7)$ 的值。", "hint": "#### 【输入输出样例解释】\n\n**样例 1 解释**\n\n- 满足条件的子串有： $\\texttt{abc},\\texttt{cba},\\texttt{abc},\\texttt{abccba}$\n\n**样例 2 解释**\n\n- 仅子串 $\\texttt{abcABC}$ 为 有魔法的子串（区分大小写，即 $\\texttt{a}\\ne \\texttt{A}$）。\n\n**样例 3 解释**\n\n- 其中一个是 $\\texttt{SwSwwS}$。\n\n#### 【数据规模与约定】\n\n**本题采用多测试点捆绑测试，共有 4 个子任务**。\n\n- Subtask 1（10 points）：$2\\le n\\le 100$。\n- Subtask 2（20 points）：$2\\le n\\le 2\\times 10^3$。\n- Subtask 3（30 points）：$2\\le n\\le 10^5,k=2$ （即 $S$ 中只有两种字符）。\n- Subtask 4（40 points）：无其他限制。\n\n对于所有数据，保证 $2\\le n\\le 10^5$，字符集为 $ [\\texttt{a},\\texttt{z}] \\cup [\\texttt{A},\\texttt{Z}]$\n\n#### 【说明】\n\n原题来自：[eJOI 2017](www.ejoi.org) Problem A [Magic](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_1/EN/magic_statement-en.pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN"}}}
{"pid": "P6274", "type": "P", "difficulty": 5, "samples": [["6\n", "28"], ["203021", "33628"], ["60357056536", "907882"], ["12156144", "104757552"]], "limits": {"time": [650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650, 650], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "eJOI（欧洲）"], "title": "[eJOI 2017] 六", "background": "", "description": "Elly 正在研究关于 正整数 $N$ 的一些性质，发现 $N$ 有不多于 $6$ 个不同的质因数。\n\n接下来，她以一种特定的方式来生成的一个列表，一开始列表为空。她先写下了 $N$ 的一个大于一的因数 $x$ ，加入列表前，她先要确保 在所有已经在列表中的数中， 不能有 **超过** $1$ **个** 数与 $x$ **不互质**。\n\n------------------------------\n\n举个例子，当 $N=12156144$ 时：\n\n合法的列表有： $ (42), (616, 6, 91, 23),(91, 616, 6, 23), (66, 7), (66, 7, 7, 23, 299, 66), \\\\(143, 13, 66),(42,12156144),\\text{etc.} $\n\n而不合法的有：之一是 $(5,11)$，原因是 $5$ 不是 $N$ 的因子；还有一个是 $ (66, 13, 143)$ ，原因是 $143$ 与其他两个数都不互质。\n\n-----------------------\n\n现在 Elly 希望你计算出给定的 $N$，可以生成几个不同的合法的列表。\n\n**若两个列表长度不同，或存在一个位置使得两个列表的该位置的值不同，那么我们说这两个列表不同的**。", "inputFormat": "一个整数：$N$。", "outputFormat": "一个整数，表示列表的个数 $\\bmod (10^9+7)$ 的值。", "hint": "#### 【输入输出样例解释】\n\n**样例 1 解释**\n\n满足条件的列表有：$(2), (2, 2),\n(2, 2, 3), (2, 2, 3, 3), (2, 3), (2, 3, 2), (2, 3, 2, 3), (2, 3, 3), (2, 3, 3, 2), \\\\ (2, 6), (2, 6,3), (3), (3, 2), (3, 2, 2), (3, 2, 2, 3), (3, 2, 3), (3, 2, 3, 2), (3, 3),\\\\ (3, 3, 2), (3, 3, 2,2), (3, 6), (3, 6, 2), (6), (6, 2), (6, 2, 3), (6, 3), (6, 3, 2), (6, 6)$\n\n以上共 $28$ 种。\n\n**样例 4 解释**\n\n真正的答案为 $14104757650$。\n\n输出 $14104757650 \\bmod (10^9+7)=104757552$\n\n#### 【数据规模与约定】\n\n- 对于所有数据，保证 $1\\le N\\le 10^{15}$\n- 对于约 $30\\%$ 的数据，保证 $N$ 至多有 $2$ 个质因数。\n- 对于约 $60\\%$ 的数据，保证 $N$ 至多有 $4$ 个质因数。\n- 对于 $100\\%$ 的数据，保证 $N$ 至多有 $6$ 个质因数。\n\n#### 【说明】\n\n原题来自：[eJOI 2017](www.ejoi.org) Problem B [Six](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_1/EN/six_statement-en.pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2017] 六", "background": "", "description": "Elly 正在研究关于 正整数 $N$ 的一些性质，发现 $N$ 有不多于 $6$ 个不同的质因数。\n\n接下来，她以一种特定的方式来生成的一个列表，一开始列表为空。她先写下了 $N$ 的一个大于一的因数 $x$ ，加入列表前，她先要确保 在所有已经在列表中的数中， 不能有 **超过** $1$ **个** 数与 $x$ **不互质**。\n\n------------------------------\n\n举个例子，当 $N=12156144$ 时：\n\n合法的列表有： $ (42), (616, 6, 91, 23),(91, 616, 6, 23), (66, 7), (66, 7, 7, 23, 299, 66), \\\\(143, 13, 66),(42,12156144),\\text{etc.} $\n\n而不合法的有：之一是 $(5,11)$，原因是 $5$ 不是 $N$ 的因子；还有一个是 $ (66, 13, 143)$ ，原因是 $143$ 与其他两个数都不互质。\n\n-----------------------\n\n现在 Elly 希望你计算出给定的 $N$，可以生成几个不同的合法的列表。\n\n**若两个列表长度不同，或存在一个位置使得两个列表的该位置的值不同，那么我们说这两个列表不同的**。", "inputFormat": "一个整数：$N$。", "outputFormat": "一个整数，表示列表的个数 $\\bmod (10^9+7)$ 的值。", "hint": "#### 【输入输出样例解释】\n\n**样例 1 解释**\n\n满足条件的列表有：$(2), (2, 2),\n(2, 2, 3), (2, 2, 3, 3), (2, 3), (2, 3, 2), (2, 3, 2, 3), (2, 3, 3), (2, 3, 3, 2), \\\\ (2, 6), (2, 6,3), (3), (3, 2), (3, 2, 2), (3, 2, 2, 3), (3, 2, 3), (3, 2, 3, 2), (3, 3),\\\\ (3, 3, 2), (3, 3, 2,2), (3, 6), (3, 6, 2), (6), (6, 2), (6, 2, 3), (6, 3), (6, 3, 2), (6, 6)$\n\n以上共 $28$ 种。\n\n**样例 4 解释**\n\n真正的答案为 $14104757650$。\n\n输出 $14104757650 \\bmod (10^9+7)=104757552$\n\n#### 【数据规模与约定】\n\n- 对于所有数据，保证 $1\\le N\\le 10^{15}$\n- 对于约 $30\\%$ 的数据，保证 $N$ 至多有 $2$ 个质因数。\n- 对于约 $60\\%$ 的数据，保证 $N$ 至多有 $4$ 个质因数。\n- 对于 $100\\%$ 的数据，保证 $N$ 至多有 $6$ 个质因数。\n\n#### 【说明】\n\n原题来自：[eJOI 2017](www.ejoi.org) Problem B [Six](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_1/EN/six_statement-en.pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN"}}}
{"pid": "P6275", "type": "P", "difficulty": 5, "samples": [["2\n..\n..", "28"], ["4\n..W.\n..WW\nWW..\n...W", "2304"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2020", "USACO", "组合数学"], "title": "[USACO20OPEN] Sprinklers 2: Return of the Alfalfa P", "background": "", "description": "Farmer John 有一块小的田地，形状为一个 $N$ 行 $N$ 列的一个方阵，对于所有的 $1 \\le i,j \\le N$，从上往下的第 $i$ 行的从左往右第 $j$ 个方格记为 $(i,j)$。他有兴趣在他的田地里种植甜玉米和苜蓿。为此，他需要安装一些特殊的洒水器。  \n在方格 $(I,J)$ 中的甜玉米洒水器可以喷洒到所有左下方的方格：即满足 $I \\le i$ 以及 $j \\le J$ 的 $(i,j)$。\n\n在方格 $(I,J)$ 中的苜蓿洒水器可以喷洒到所有右上方的方格：即满足 $i \\le I$ 以及 $J \\le j$ 的 $(i,j)$。\n\n被一个或多个甜玉米洒水器喷洒到的方格可以长出甜玉米；被一个或多个苜蓿洒水器喷洒到的方格可以长出苜蓿。但是被两种洒水器均喷洒到（或均喷洒不到）的方格什么也长不出来。\n\n帮助 Farmer John 求出在他的田地里安装洒水器的方案数（ $\\bmod \\ 10^9 + 7$），每个方格至多安装一个洒水器，使得每个方格均能生长作物（即被恰好一种洒水器喷洒到）。\n\n某些方格正被长毛奶牛占据；这不会阻止这些方格生长作物，但是这些方格里不能安装洒水器。", "inputFormat": "输入的第一行包含一个整数 $N$。  \n对于每一个 $1\\le i\\le N$，第 $i+1$ 行包含一个长为 $N$ 的字符串，表示方阵的第 $i$ 行。字符串中的每个字符为 `W`（表示被一头长毛奶牛占据的方格）或 `.`（未被占据）。", "outputFormat": "输出安装洒水器的方案数 $\\bmod \\ 10^9+7$ 的结果。", "hint": "#### 样例 $1$ 解释：\n以下是所有十四种可以使得 $(1,1)$ 生长甜玉米的方式。（译注：`C` 表示 sweet corn，即甜玉米；`A` 表示 alfalfa，即苜蓿）\n\n```plain\nCC  .C  CA  CC  .C  CA  CA  C.  CA  C.  CC  .C  CC  .C\nCC, CC, CC, .C, .C, .C, CA, CA, .A, .A, C., C., .., ..\n```\n\n#### 样例 $2$ 提示：\n\n这个样例满足第一个子任务的限制。\n\n-----\n\n对于 $100\\%$ 的数据，满足 $1 \\le N \\le 2000$。\n\n共 $16$ 个测试点，其中 $1\\sim 2$ 为样例，其余性质如下：\n\n对于测试点 $3 \\sim 4$，满足 $N \\le 10$ 且最多有 $10$ 个未被占据的格子。  \n对于测试点 $5 \\sim 9$，满足 $N \\le 200$。  \n对于测试点 $10 \\sim 16$，无特殊限制。\n\n---\n\n出题人：Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] Sprinklers 2: Return of the Alfalfa P", "background": "", "description": "Farmer John 有一块小的田地，形状为一个 $N$ 行 $N$ 列的一个方阵，对于所有的 $1 \\le i,j \\le N$，从上往下的第 $i$ 行的从左往右第 $j$ 个方格记为 $(i,j)$。他有兴趣在他的田地里种植甜玉米和苜蓿。为此，他需要安装一些特殊的洒水器。  \n在方格 $(I,J)$ 中的甜玉米洒水器可以喷洒到所有左下方的方格：即满足 $I \\le i$ 以及 $j \\le J$ 的 $(i,j)$。\n\n在方格 $(I,J)$ 中的苜蓿洒水器可以喷洒到所有右上方的方格：即满足 $i \\le I$ 以及 $J \\le j$ 的 $(i,j)$。\n\n被一个或多个甜玉米洒水器喷洒到的方格可以长出甜玉米；被一个或多个苜蓿洒水器喷洒到的方格可以长出苜蓿。但是被两种洒水器均喷洒到（或均喷洒不到）的方格什么也长不出来。\n\n帮助 Farmer John 求出在他的田地里安装洒水器的方案数（ $\\bmod \\ 10^9 + 7$），每个方格至多安装一个洒水器，使得每个方格均能生长作物（即被恰好一种洒水器喷洒到）。\n\n某些方格正被长毛奶牛占据；这不会阻止这些方格生长作物，但是这些方格里不能安装洒水器。", "inputFormat": "输入的第一行包含一个整数 $N$。  \n对于每一个 $1\\le i\\le N$，第 $i+1$ 行包含一个长为 $N$ 的字符串，表示方阵的第 $i$ 行。字符串中的每个字符为 `W`（表示被一头长毛奶牛占据的方格）或 `.`（未被占据）。", "outputFormat": "输出安装洒水器的方案数 $\\bmod \\ 10^9+7$ 的结果。", "hint": "#### 样例 $1$ 解释：\n以下是所有十四种可以使得 $(1,1)$ 生长甜玉米的方式。（译注：`C` 表示 sweet corn，即甜玉米；`A` 表示 alfalfa，即苜蓿）\n\n```plain\nCC  .C  CA  CC  .C  CA  CA  C.  CA  C.  CC  .C  CC  .C\nCC, CC, CC, .C, .C, .C, CA, CA, .A, .A, C., C., .., ..\n```\n\n#### 样例 $2$ 提示：\n\n这个样例满足第一个子任务的限制。\n\n-----\n\n对于 $100\\%$ 的数据，满足 $1 \\le N \\le 2000$。\n\n共 $16$ 个测试点，其中 $1\\sim 2$ 为样例，其余性质如下：\n\n对于测试点 $3 \\sim 4$，满足 $N \\le 10$ 且最多有 $10$ 个未被占据的格子。  \n对于测试点 $5 \\sim 9$，满足 $N \\le 200$。  \n对于测试点 $10 \\sim 16$，无特殊限制。\n\n---\n\n出题人：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P6276", "type": "P", "difficulty": 7, "samples": [["5 1000000007", "369329541"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "USACO", "组合数学", "容斥原理", "生成函数"], "title": "[USACO20OPEN] Exercise P", "background": "", "description": "Farmer John（又）想到了一个新的奶牛晨练方案！  \n如同之前，Farmer John 的 $N$ 头奶牛站成一排。对于 $1\\le i\\le N$ 的每一个 $i$，从左往右第 $i$ 头奶牛的编号为 $i$。他告诉她们重复以下步骤，直到奶牛们与她们开始时的顺序相同。\n\n给定长为 $N$ 的一个排列 $A$，奶牛们改变她们的顺序，使得在改变之前从左往右第 $i$ 头奶牛在改变之后为从左往右第 $A_i$ 头。  \n例如，如果 $A=(1,2,3,4,5)$，那么奶牛们总共进行一步就回到了同样的顺序。如果 $A=(2,3,1,5,4)$，那么奶牛们总共进行六步之后回到起始的顺序。每步之后奶牛们从左往右的顺序如下：\n\n0 步：$(1,2,3,4,5)$  \n1 步：$(3,1,2,5,4)$  \n2 步：$(2,3,1,4,5)$  \n3 步：$(1,2,3,5,4)$  \n4 步：$(3,1,2,4,5)$  \n5 步：$(2,3,1,5,4)$  \n6 步：$(1,2,3,4,5)$  \n**请你计算出所有可能的 $N!$ 种长为 $N$ 的排列 $A$ 回到起始顺序需要的步数的乘积。**\n\n由于这个数字可能非常大，输出答案模 $M$ 的余数（$10^8\\le M\\le 10^9+7$，$M$ 是质数）。\n\n-----\n\n使用 C++ 的选手可以使用 [KACTL](https://github.com/kth-competitive-programming/kactl/blob/master/content/various/FastMod.h) 中的这一代码。这一名为 [Barrett 模乘](https://en.wikipedia.org/wiki/Barrett_reduction) 的算法可以以比通常计算快上数倍的速度计算 $a \\% b$，其中 $b>1$ 为一个编译时未知的常数。（不幸的是，我们没有找到对于 Java 的这样的优化）。（译注：中文选手可以参考 几种取模优化方法[（译自 min-25 的博客）](https://loj.ac/article/327)）\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef unsigned long long ull;\ntypedef __uint128_t L;\nstruct FastMod {\n    ull b, m;\n    FastMod(ull b) : b(b), m(ull((L(1) << 64) / b)) {}\n    ull reduce(ull a) {\n        ull q = (ull)((L(m) * a) >> 64);\n        ull r = a - q * b; // can be proven that 0 <= r < 2*b\n        return r >= b ? r - b : r;\n    }\n};\nFastMod F(2);\n\nint main() {\n    int M = 1000000007; F = FastMod(M);\n    ull x = 10ULL*M+3; \n    cout << x << \" \" << F.reduce(x) << \"\\n\"; // 10000000073 3\n}\n```", "inputFormat": "输入一行包含 $N$ 和 $M$。", "outputFormat": "输出一个整数。", "hint": "#### 样例解释：\n对于每一个 $1\\le i\\le N$，以下序列的第 $i$ 个元素等于奶牛需要使用 $i$ 步的排列数量：$[1,25,20,30,24,20]$。所以答案等于 $1^1\\cdot 2^{25}\\cdot 3^{20}\\cdot 4^{30}\\cdot 5^{24}\\cdot 6^{20}\\equiv 369329541\\pmod{10^9+7}$。\n\n**注意：这个问题的内存限制增加为 512 MB。**\n\n---\n对于 $100\\%$ 的数据，满足 $1\\le N\\le 7500$。\n\n共 $16$ 个测试点，其中 $1$ 为样例，其余性质如下：\n\n测试点  $2$ 满足 $N=8$。  \n测试点 $3\\sim 5$ 满足 $N\\le 50$。  \n测试点 $6\\sim 8$ 满足 $N\\le 500$。  \n测试点 $9\\sim 12$ 满足 $N\\le 3000$。  \n测试点 $13\\sim 16$ 没有额外限制。\n\n----\n  \n出题人：Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] Exercise P", "background": "", "description": "Farmer John（又）想到了一个新的奶牛晨练方案！  \n如同之前，Farmer John 的 $N$ 头奶牛站成一排。对于 $1\\le i\\le N$ 的每一个 $i$，从左往右第 $i$ 头奶牛的编号为 $i$。他告诉她们重复以下步骤，直到奶牛们与她们开始时的顺序相同。\n\n给定长为 $N$ 的一个排列 $A$，奶牛们改变她们的顺序，使得在改变之前从左往右第 $i$ 头奶牛在改变之后为从左往右第 $A_i$ 头。  \n例如，如果 $A=(1,2,3,4,5)$，那么奶牛们总共进行一步就回到了同样的顺序。如果 $A=(2,3,1,5,4)$，那么奶牛们总共进行六步之后回到起始的顺序。每步之后奶牛们从左往右的顺序如下：\n\n0 步：$(1,2,3,4,5)$  \n1 步：$(3,1,2,5,4)$  \n2 步：$(2,3,1,4,5)$  \n3 步：$(1,2,3,5,4)$  \n4 步：$(3,1,2,4,5)$  \n5 步：$(2,3,1,5,4)$  \n6 步：$(1,2,3,4,5)$  \n**请你计算出所有可能的 $N!$ 种长为 $N$ 的排列 $A$ 回到起始顺序需要的步数的乘积。**\n\n由于这个数字可能非常大，输出答案模 $M$ 的余数（$10^8\\le M\\le 10^9+7$，$M$ 是质数）。\n\n-----\n\n使用 C++ 的选手可以使用 [KACTL](https://github.com/kth-competitive-programming/kactl/blob/master/content/various/FastMod.h) 中的这一代码。这一名为 [Barrett 模乘](https://en.wikipedia.org/wiki/Barrett_reduction) 的算法可以以比通常计算快上数倍的速度计算 $a \\% b$，其中 $b>1$ 为一个编译时未知的常数。（不幸的是，我们没有找到对于 Java 的这样的优化）。（译注：中文选手可以参考 几种取模优化方法[（译自 min-25 的博客）](https://loj.ac/article/327)）\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef unsigned long long ull;\ntypedef __uint128_t L;\nstruct FastMod {\n    ull b, m;\n    FastMod(ull b) : b(b), m(ull((L(1) << 64) / b)) {}\n    ull reduce(ull a) {\n        ull q = (ull)((L(m) * a) >> 64);\n        ull r = a - q * b; // can be proven that 0 <= r < 2*b\n        return r >= b ? r - b : r;\n    }\n};\nFastMod F(2);\n\nint main() {\n    int M = 1000000007; F = FastMod(M);\n    ull x = 10ULL*M+3; \n    cout << x << \" \" << F.reduce(x) << \"\\n\"; // 10000000073 3\n}\n```", "inputFormat": "输入一行包含 $N$ 和 $M$。", "outputFormat": "输出一个整数。", "hint": "#### 样例解释：\n对于每一个 $1\\le i\\le N$，以下序列的第 $i$ 个元素等于奶牛需要使用 $i$ 步的排列数量：$[1,25,20,30,24,20]$。所以答案等于 $1^1\\cdot 2^{25}\\cdot 3^{20}\\cdot 4^{30}\\cdot 5^{24}\\cdot 6^{20}\\equiv 369329541\\pmod{10^9+7}$。\n\n**注意：这个问题的内存限制增加为 512 MB。**\n\n---\n对于 $100\\%$ 的数据，满足 $1\\le N\\le 7500$。\n\n共 $16$ 个测试点，其中 $1$ 为样例，其余性质如下：\n\n测试点  $2$ 满足 $N=8$。  \n测试点 $3\\sim 5$ 满足 $N\\le 50$。  \n测试点 $6\\sim 8$ 满足 $N\\le 500$。  \n测试点 $9\\sim 12$ 满足 $N\\le 3000$。  \n测试点 $13\\sim 16$ 没有额外限制。\n\n----\n  \n出题人：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P6277", "type": "P", "difficulty": 7, "samples": [["5\n1 2\n2 3\n3 4\n3 5", "1\n1\n3\n24\n120"], ["8\n1 3\n2 3\n3 4\n4 5\n5 6\n6 7\n6 8", "1\n1\n1\n6\n30\n180\n5040\n40320"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "USACO", "连通块", "组合数学", "容斥原理", "Ad-hoc"], "title": "[USACO20OPEN] Circus P", "background": "", "description": "Farmer John 马戏团中的 $N$ 头奶牛正在为即将到来的演出做准备。演出全部在一棵节点编号为 $1\\ldots N$ 的树上举行。演出的“初始状态”被定义为一个整数 $K$（$1\\leq K\\leq N$）使得奶牛 $1\\ldots K$ 分布在树上的节点上，并且没有任何两头牛位于相同的节点。\n\n在一场演出中，奶牛们可以“移动”任意次数。在一次“移动”中，一头奶牛可以从自己当前所处的节点移动到一个未被占据的相邻节点。如果一个状态可以通过一系列移动到达另一个状态，我们就称这两个初始状态是等价的。\n\n对于每一个 $1\\leq K\\leq N$，你需要帮助奶牛确定有多少类等价的初始状态。即选出最多的起始状态数目，使得它们两两不等价。由于数字可能很大，所以只需输出答案 $\\bmod \\ 10^9+7$ 的结果。\n\n\n", "inputFormat": "第一行一个整数 $N$。\n\n接下来的 $N-1$ 行，每行两个整数 $a_i,b_i$，表示树中有一条连接 $a_i$ 和 $b_i$ 的边。", "outputFormat": "输出共 $N$ 行，对于每一个 $1\\leq i\\leq N$，在第 $i$ 行输出 $K=i$ 时的答案 $\\bmod \\ 10^9+7$ 的结果。", "hint": "#### 样例 $1$ 解释：\n对于 $K=1$ 和 $K=2$，任何两个状态都可以互相到达。\n\n然后考虑 $K=3$，令 $c_i$ 表示奶牛 $i$ 的位置，则状态 $(c_1,c_2,c_3)=(1,2,3)$ 等价于状态 $(1,2,5)$ 和 $(1,3,2)$，但不等价于状态 $(2,1,3)$。\n\n-----\n\n对于 $100\\%$ 的数据，保证 $1 \\le N \\le 10^5$。\n\n共 $20$ 个测试点，其中 $1\\sim 2$ 为样例，其余性质如下：\n\n对于测试点 $3 \\sim 4$，满足 $N \\leq 8$。  \n对于测试点 $5 \\sim 7$，满足 $N \\leq 16$。  \n对于测试点 $8 \\sim 10$，满足 $N \\leq 100$，且这个树为“星形”，最多有一个度数大于 $2$ 的节点。  \n对于测试点 $11 \\sim 15$，满足 $N \\leq 100$。  \n对于测试点 $16 \\sim 20$，无特殊限制。\n\n------\n\n出题人：Dhruv Rohatgi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] Circus P", "background": "", "description": "Farmer John 马戏团中的 $N$ 头奶牛正在为即将到来的演出做准备。演出全部在一棵节点编号为 $1\\ldots N$ 的树上举行。演出的“初始状态”被定义为一个整数 $K$（$1\\leq K\\leq N$）使得奶牛 $1\\ldots K$ 分布在树上的节点上，并且没有任何两头牛位于相同的节点。\n\n在一场演出中，奶牛们可以“移动”任意次数。在一次“移动”中，一头奶牛可以从自己当前所处的节点移动到一个未被占据的相邻节点。如果一个状态可以通过一系列移动到达另一个状态，我们就称这两个初始状态是等价的。\n\n对于每一个 $1\\leq K\\leq N$，你需要帮助奶牛确定有多少类等价的初始状态。即选出最多的起始状态数目，使得它们两两不等价。由于数字可能很大，所以只需输出答案 $\\bmod \\ 10^9+7$ 的结果。\n\n\n", "inputFormat": "第一行一个整数 $N$。\n\n接下来的 $N-1$ 行，每行两个整数 $a_i,b_i$，表示树中有一条连接 $a_i$ 和 $b_i$ 的边。", "outputFormat": "输出共 $N$ 行，对于每一个 $1\\leq i\\leq N$，在第 $i$ 行输出 $K=i$ 时的答案 $\\bmod \\ 10^9+7$ 的结果。", "hint": "#### 样例 $1$ 解释：\n对于 $K=1$ 和 $K=2$，任何两个状态都可以互相到达。\n\n然后考虑 $K=3$，令 $c_i$ 表示奶牛 $i$ 的位置，则状态 $(c_1,c_2,c_3)=(1,2,3)$ 等价于状态 $(1,2,5)$ 和 $(1,3,2)$，但不等价于状态 $(2,1,3)$。\n\n-----\n\n对于 $100\\%$ 的数据，保证 $1 \\le N \\le 10^5$。\n\n共 $20$ 个测试点，其中 $1\\sim 2$ 为样例，其余性质如下：\n\n对于测试点 $3 \\sim 4$，满足 $N \\leq 8$。  \n对于测试点 $5 \\sim 7$，满足 $N \\leq 16$。  \n对于测试点 $8 \\sim 10$，满足 $N \\leq 100$，且这个树为“星形”，最多有一个度数大于 $2$ 的节点。  \n对于测试点 $11 \\sim 15$，满足 $N \\leq 100$。  \n对于测试点 $16 \\sim 20$，无特殊限制。\n\n------\n\n出题人：Dhruv Rohatgi", "locale": "zh-CN"}}}
{"pid": "P6278", "type": "P", "difficulty": 4, "samples": [["5\n5 2 3 3 0", "0\n4\n4\n5\n7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "线段树", "USACO", "树状数组", "扫描线"], "title": "[USACO20OPEN] Haircut G", "background": null, "description": "Farmer John 由于对整理他难以整平的头发感到疲惫，于是决定去理发。他有一排 $N$ 缕头发，第 $i$ 缕头发初始时长度为 $A_i$ 微米（$0\\le A_i\\le N$）。理想情况下，他想要他的头发在长度上单调不降，所以他定义他的头发的“不良度”为逆序对的数量：满足 $i < j$ 及 $A_i > A_j$ 的二元对 $(i,j)$。  \n对于每一个 $j=0,1,\\ldots,N-1$，Farmer John 想要知道他所有长度大于 $j$ 的头发的长度均减少到 $j$ 时他的头发的不良度。\n\n-----\n\n（有趣的事实：人类平均确实有大约 $10^5$ 根头发！）", "inputFormat": "输入的第一行包含 $N$。  \n第二行包含 $A_1,A_2,\\ldots,A_N$。", "outputFormat": "对于每一个 $j=0,1,\\ldots,N-1$，用一行输出 Farmer John 头发的不良度。\n\n-----\n\n  \n**注意这个问题涉及到的整数大小可能需要使用 $64$ 位整数型存储（例如，C/C++ 中的“long long”）。**", "hint": "#### 样例解释：\n\n输出的第四行描述了 Farmer John 的头发长度减少到 $3$ 时的逆序对数量。   \n$A=[3,2,3,3,0]$ 有五个逆序对：$A_1>A_2,\\,A_1>A_5,\\,A_2>A_5,\\,A_3>A_5,$ 和 $A_4>A_5$。\n\n----\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5$。\n\n共 $13$ 个测试点，其中 $1$ 为样例，其余性质如下：\n  \n测试点 $2$ 满足 $N\\le 100$。  \n测试点 $3\\sim 5$ 满足 $N\\le 5000$。  \n测试点 $6\\sim 13$ 没有额外限制。  \n\n-----\n\n\n出题人：Dhruv Rohatgi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] Haircut G", "background": null, "description": "Farmer John 由于对整理他难以整平的头发感到疲惫，于是决定去理发。他有一排 $N$ 缕头发，第 $i$ 缕头发初始时长度为 $A_i$ 微米（$0\\le A_i\\le N$）。理想情况下，他想要他的头发在长度上单调不降，所以他定义他的头发的“不良度”为逆序对的数量：满足 $i < j$ 及 $A_i > A_j$ 的二元对 $(i,j)$。  \n对于每一个 $j=0,1,\\ldots,N-1$，Farmer John 想要知道他所有长度大于 $j$ 的头发的长度均减少到 $j$ 时他的头发的不良度。\n\n-----\n\n（有趣的事实：人类平均确实有大约 $10^5$ 根头发！）", "inputFormat": "输入的第一行包含 $N$。  \n第二行包含 $A_1,A_2,\\ldots,A_N$。", "outputFormat": "对于每一个 $j=0,1,\\ldots,N-1$，用一行输出 Farmer John 头发的不良度。\n\n-----\n\n  \n**注意这个问题涉及到的整数大小可能需要使用 $64$ 位整数型存储（例如，C/C++ 中的“long long”）。**", "hint": "#### 样例解释：\n\n输出的第四行描述了 Farmer John 的头发长度减少到 $3$ 时的逆序对数量。   \n$A=[3,2,3,3,0]$ 有五个逆序对：$A_1>A_2,\\,A_1>A_5,\\,A_2>A_5,\\,A_3>A_5,$ 和 $A_4>A_5$。\n\n----\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5$。\n\n共 $13$ 个测试点，其中 $1$ 为样例，其余性质如下：\n  \n测试点 $2$ 满足 $N\\le 100$。  \n测试点 $3\\sim 5$ 满足 $N\\le 5000$。  \n测试点 $6\\sim 13$ 没有额外限制。  \n\n-----\n\n\n出题人：Dhruv Rohatgi", "locale": "zh-CN"}}}
{"pid": "P6279", "type": "P", "difficulty": 5, "samples": [["9 12\n1 2\n4 2\n5 8\n4 6\n6 9\n2 9\n8 7\n8 3\n7 1\n9 4\n3 5\n3 4", "1\n2\n3\n1\n1\n2\n3\n2\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "USACO", "并查集", "启发式合并"], "title": "[USACO20OPEN] Favorite Colors G", "background": "", "description": "Farmer John 的 $N$ 头奶牛每头都有一种最喜欢的颜色。奶牛们的编号为 $1\\ldots N$，每种颜色也可以用 $1\\ldots N$ 中的一个整数表示。  \n存在 $M$ 对奶牛 $(a,b)$，奶牛 $b$ 仰慕奶牛 $a$。有可能 $a=b$，此时一头奶牛仰慕她自己。对于任意颜色 $c$，如果奶牛 $x$ 和 $y$ 都仰慕一头喜欢颜色 $c$ 的奶牛，那么 $x$ 和 $y$ 喜欢的颜色相同。\n\n给定这些信息，求一种奶牛喜欢颜色的分配方案，使得每头奶牛最喜欢的颜色中不同颜色的数量最大。由于存在多种符合这一性质的分配方案，输出字典序最小的（这意味着你应当依次最小化分配给奶牛 $1 \\ldots N$ 的颜色）。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。  \n以下 $M$ 行每行包含两个空格分隔的整数 $a$ 和 $b$（$1\\le a,b\\le N$），表示奶牛 $b$ 仰慕奶牛 $a$。同一对奶牛可能会在输入中多次出现。", "outputFormat": "对于 $1\\ldots N$ 中的每一个 $i$，用一行输出分配给奶牛 $i$ 的颜色。", "hint": "#### 样例解释：\n\n在下图中，用粗边框圆表示的是最喜欢颜色 $1$ 的奶牛。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/iratxzf8.png)\n\n-----\n\n对于 $100\\%$ 的数据，$1\\le N,M\\le 2\\times 10^5$。\n\n共 $10$ 个测试点，其中 $1$ 为样例，其余性质如下：\n \n测试点 $2\\sim 3$ 满足 $N,M\\le 10^3$。  \n测试点 $4\\sim 10$ 没有额外限制。\n\n-----\n\n出题人：William Lin，Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] Favorite Colors G", "background": "", "description": "Farmer John 的 $N$ 头奶牛每头都有一种最喜欢的颜色。奶牛们的编号为 $1\\ldots N$，每种颜色也可以用 $1\\ldots N$ 中的一个整数表示。  \n存在 $M$ 对奶牛 $(a,b)$，奶牛 $b$ 仰慕奶牛 $a$。有可能 $a=b$，此时一头奶牛仰慕她自己。对于任意颜色 $c$，如果奶牛 $x$ 和 $y$ 都仰慕一头喜欢颜色 $c$ 的奶牛，那么 $x$ 和 $y$ 喜欢的颜色相同。\n\n给定这些信息，求一种奶牛喜欢颜色的分配方案，使得每头奶牛最喜欢的颜色中不同颜色的数量最大。由于存在多种符合这一性质的分配方案，输出字典序最小的（这意味着你应当依次最小化分配给奶牛 $1 \\ldots N$ 的颜色）。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。  \n以下 $M$ 行每行包含两个空格分隔的整数 $a$ 和 $b$（$1\\le a,b\\le N$），表示奶牛 $b$ 仰慕奶牛 $a$。同一对奶牛可能会在输入中多次出现。", "outputFormat": "对于 $1\\ldots N$ 中的每一个 $i$，用一行输出分配给奶牛 $i$ 的颜色。", "hint": "#### 样例解释：\n\n在下图中，用粗边框圆表示的是最喜欢颜色 $1$ 的奶牛。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/iratxzf8.png)\n\n-----\n\n对于 $100\\%$ 的数据，$1\\le N,M\\le 2\\times 10^5$。\n\n共 $10$ 个测试点，其中 $1$ 为样例，其余性质如下：\n \n测试点 $2\\sim 3$ 满足 $N,M\\le 10^3$。  \n测试点 $4\\sim 10$ 没有额外限制。\n\n-----\n\n出题人：William Lin，Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P6280", "type": "P", "difficulty": 5, "samples": [["5 1000000007", "21"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2020", "USACO", "素数判断,质数,筛法"], "title": "[USACO20OPEN] Exercise G", "background": "", "description": "Farmer John（又）想到了一个新的奶牛晨练方案！  \n如同之前，Farmer John 的 $N$ 头奶牛站成一排。对于 $1\\le i\\le N$ 的每一个 $i$，从左往右第 $i$ 头奶牛的编号为 $i$。他告诉她们重复以下步骤，直到奶牛们与她们开始时的顺序相同。\n\n给定长为 $N$ 的一个排列 $A$，奶牛们改变她们的顺序，使得在改变之前从左往右第 $i$ 头奶牛在改变之后为从左往右第 $A_i$ 头。  \n例如，如果 $A=(1,2,3,4,5)$，那么奶牛们总共进行一步。如果 $A=(2,3,1,5,4)$，那么奶牛们总共进行六步。每步之后奶牛们从左往右的顺序如下：\n\n0 步：$(1,2,3,4,5)$  \n1 步：$(3,1,2,5,4)$  \n2 步：$(2,3,1,4,5)$  \n3 步：$(1,2,3,5,4)$  \n4 步：$(3,1,2,4,5)$  \n5 步：$(2,3,1,5,4)$  \n6 步：$(1,2,3,4,5)$  \n**求所有正整数 $K$ 的和，使得存在一个长为 $N$ 的排列，奶牛们需要进行恰好 $K$ 步。**\n\n由于这个数字可能非常大，输出答案模 $M$ 的余数（$10^8\\le M\\le 10^9+7$，$M$ 是质数）。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。", "outputFormat": "输出一个整数。", "hint": "#### 样例解释：\n\n存在排列使得奶牛需要进行 $1$、$2$、$3$、$4$、$5$ 以及 $6$ 步。因此，答案为 $1+2+3+4+5+6=21$。\n\n-----\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^4$。\n\n共 $10$ 个测试点，其中 $1$ 为样例，其余性质如下：\n\n测试点 $2\\sim 5$ 满足 $N\\le 10^2$。  \n测试点 $6\\sim 10$ 没有额外限制。 \n\n----- \n\n出题人：Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] Exercise G", "background": "", "description": "Farmer John（又）想到了一个新的奶牛晨练方案！  \n如同之前，Farmer John 的 $N$ 头奶牛站成一排。对于 $1\\le i\\le N$ 的每一个 $i$，从左往右第 $i$ 头奶牛的编号为 $i$。他告诉她们重复以下步骤，直到奶牛们与她们开始时的顺序相同。\n\n给定长为 $N$ 的一个排列 $A$，奶牛们改变她们的顺序，使得在改变之前从左往右第 $i$ 头奶牛在改变之后为从左往右第 $A_i$ 头。  \n例如，如果 $A=(1,2,3,4,5)$，那么奶牛们总共进行一步。如果 $A=(2,3,1,5,4)$，那么奶牛们总共进行六步。每步之后奶牛们从左往右的顺序如下：\n\n0 步：$(1,2,3,4,5)$  \n1 步：$(3,1,2,5,4)$  \n2 步：$(2,3,1,4,5)$  \n3 步：$(1,2,3,5,4)$  \n4 步：$(3,1,2,4,5)$  \n5 步：$(2,3,1,5,4)$  \n6 步：$(1,2,3,4,5)$  \n**求所有正整数 $K$ 的和，使得存在一个长为 $N$ 的排列，奶牛们需要进行恰好 $K$ 步。**\n\n由于这个数字可能非常大，输出答案模 $M$ 的余数（$10^8\\le M\\le 10^9+7$，$M$ 是质数）。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。", "outputFormat": "输出一个整数。", "hint": "#### 样例解释：\n\n存在排列使得奶牛需要进行 $1$、$2$、$3$、$4$、$5$ 以及 $6$ 步。因此，答案为 $1+2+3+4+5+6=21$。\n\n-----\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^4$。\n\n共 $10$ 个测试点，其中 $1$ 为样例，其余性质如下：\n\n测试点 $2\\sim 5$ 满足 $N\\le 10^2$。  \n测试点 $6\\sim 10$ 没有额外限制。 \n\n----- \n\n出题人：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P6281", "type": "P", "difficulty": 3, "samples": [["5 3\n0 2\n4 7\n9 9", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2020", "二分", "USACO"], "title": "[USACO20OPEN] Social Distancing S", "background": "", "description": "由于高传染性的牛传染病 COWVID-19 的爆发，Farmer John 非常担忧他的奶牛们的健康。\n\n为了限制疾病的传播，Farmer John 的 $N$ 头奶牛（$2\\le N\\le 10^5$）决定践行“社交距离”，分散到农场的各处。农场的形状如一维数轴，上有 $M$ 个互不相交的区间（$1\\le M\\le 10^5$），其中有可用来放牧的青草。奶牛们想要使她们位于不同的整数位置，每个位置上均有草，并且最大化 $D$ 的值，其中 $D$ 为最近的两头奶牛之间的距离。请帮助奶牛们求出 $D$ 的最大可能值。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。以下 $M$ 行每行用两个整数 $a$ 和 $b$ 描述一个区间，其中 $0\\le a\\le b\\le 10^{18}$。没有两个区间有重合部分或在端点处相交。位于一个区间的端点上的奶牛视为在草上。", "outputFormat": "输出 $D$ 的最大可能值，使得所有奶牛之间的距离均不小于 $D$ 单位。保证存在 $D>0$ 的解。", "hint": "### 样例解释\n取到 $D=2$ 的一种方式是令奶牛们处在位置 $0$、$2$、$4$、$6$ 和 $9$。\n\n### 子任务\n- 测试点 $2$-$3$ 满足 $b\\le 10^5$。\n- 测试点 $4$-$10$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] Social Distancing S", "background": "", "description": "由于高传染性的牛传染病 COWVID-19 的爆发，Farmer John 非常担忧他的奶牛们的健康。\n\n为了限制疾病的传播，Farmer John 的 $N$ 头奶牛（$2\\le N\\le 10^5$）决定践行“社交距离”，分散到农场的各处。农场的形状如一维数轴，上有 $M$ 个互不相交的区间（$1\\le M\\le 10^5$），其中有可用来放牧的青草。奶牛们想要使她们位于不同的整数位置，每个位置上均有草，并且最大化 $D$ 的值，其中 $D$ 为最近的两头奶牛之间的距离。请帮助奶牛们求出 $D$ 的最大可能值。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。以下 $M$ 行每行用两个整数 $a$ 和 $b$ 描述一个区间，其中 $0\\le a\\le b\\le 10^{18}$。没有两个区间有重合部分或在端点处相交。位于一个区间的端点上的奶牛视为在草上。", "outputFormat": "输出 $D$ 的最大可能值，使得所有奶牛之间的距离均不小于 $D$ 单位。保证存在 $D>0$ 的解。", "hint": "### 样例解释\n取到 $D=2$ 的一种方式是令奶牛们处在位置 $0$、$2$、$4$、$6$ 和 $9$。\n\n### 子任务\n- 测试点 $2$-$3$ 满足 $b\\le 10^5$。\n- 测试点 $4$-$10$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6282", "type": "P", "difficulty": 3, "samples": [["4 2\n1 2\n1 2\n1 2\n1 2", "2\n2\n2\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "2020", "USACO"], "title": "[USACO20OPEN] Cereal S", "background": "", "description": "Farmer John 的奶牛们的早餐最爱当然是麦片了！事实上，奶牛们的胃口是如此之大，每头奶牛一顿饭可以吃掉整整一箱麦片。\n\n最近农场收到了一份快递，内有 $M$ 种不同种类的麦片（$1\\le M\\le 10^5$）。不幸的是，每种麦片只有一箱！$N$ 头奶牛（$1\\le N\\le 10^5$）中的每头都有她最爱的麦片和第二喜爱的麦片。给定一些可选的麦片，奶牛会执行如下的过程：\n\n- 如果她最爱的麦片还在，取走并离开。\n- 否则，如果她第二喜爱的麦片还在，取走并离开。\n- 否则，她会失望地哞叫一声然后不带走一片麦片地离开。\n\n奶牛们排队领取麦片。对于每一个 $0\\le i\\le N-1$，求如果 Farmer John 从队伍中移除前 $i$ 头奶牛，有多少奶牛会取走一箱麦片。", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $M$。\n\n对于每一个 $1\\le i\\le N$，第 $i$ 行包含两个空格分隔的整数 $f_i$ 和 \n $s_i$（$1\\le f_i,s_i\\le M$，且 $f_i\\neq s_i$），为队伍中第 $i$ 头奶牛最喜爱和第二喜爱的麦片。", "outputFormat": "对于每一个 $0\\le i\\le N-1$，输出一行，包含对于 $i$ 的答案。", "hint": "### 样例解释\n如果至少两头奶牛留下，那么恰有两头奶牛取走了一箱麦片。\n\n### 子任务\n- 测试点 $2$-$3$ 满足 $N,M\\le 10^3$。\n- 测试点 $4$-$10$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] Cereal S", "background": "", "description": "Farmer John 的奶牛们的早餐最爱当然是麦片了！事实上，奶牛们的胃口是如此之大，每头奶牛一顿饭可以吃掉整整一箱麦片。\n\n最近农场收到了一份快递，内有 $M$ 种不同种类的麦片（$1\\le M\\le 10^5$）。不幸的是，每种麦片只有一箱！$N$ 头奶牛（$1\\le N\\le 10^5$）中的每头都有她最爱的麦片和第二喜爱的麦片。给定一些可选的麦片，奶牛会执行如下的过程：\n\n- 如果她最爱的麦片还在，取走并离开。\n- 否则，如果她第二喜爱的麦片还在，取走并离开。\n- 否则，她会失望地哞叫一声然后不带走一片麦片地离开。\n\n奶牛们排队领取麦片。对于每一个 $0\\le i\\le N-1$，求如果 Farmer John 从队伍中移除前 $i$ 头奶牛，有多少奶牛会取走一箱麦片。", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $M$。\n\n对于每一个 $1\\le i\\le N$，第 $i$ 行包含两个空格分隔的整数 $f_i$ 和 \n $s_i$（$1\\le f_i,s_i\\le M$，且 $f_i\\neq s_i$），为队伍中第 $i$ 头奶牛最喜爱和第二喜爱的麦片。", "outputFormat": "对于每一个 $0\\le i\\le N-1$，输出一行，包含对于 $i$ 的答案。", "hint": "### 样例解释\n如果至少两头奶牛留下，那么恰有两头奶牛取走了一箱麦片。\n\n### 子任务\n- 测试点 $2$-$3$ 满足 $N,M\\le 10^3$。\n- 测试点 $4$-$10$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6283", "type": "P", "difficulty": 5, "samples": [["4\n1 0\n0 1\n-1 0\n0 -1", "1"], ["3\n0 0\n1 1\n-1 3", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "USACO", "并查集", "排序", "单调栈"], "title": "[USACO20OPEN] The Moo Particle S", "background": "", "description": "FJ 的奶牛们最近很无聊，她们想到了一种全新的方式缓解无聊：研究高等物理！事实上，她们甚至成功发现了一种新的亚原子粒子，她们将其命名为“哞粒子”。\n\n奶牛们正在进行一项有关 $N$ 个哞粒子的实验（$1\\le N\\le 10^5$）。粒子 $i$ 的“自旋”可以用范围在 $−10^9\\ldots 10^9$ 之间的两个整数 $x_i$ 和 $y_i$ 来描述。有时两个哞粒子会发生相互作用。自旋为 ($x_i,y_i$) 和 ($x_j,y_j$) 的两个粒子之间仅当 $x_i\\le x_j$ 并且 $y_i\\le y_j$ 时会发生相互作用。在这些条件下，有可能这两个粒子中的一个会消失（另一个粒子不会发生任何变化）。在任意给定的时刻，至多只有一次相互作用会发生。\n\n奶牛们想要知道在经过一些任意的相互作用之后剩余的哞粒子的最小数量。", "inputFormat": "输入的第一行包含一个整数 $N$，为哞粒子的初始数量。以下 $N$ 行每行包含两个空格分隔的整数，为一个粒子的自旋。每个粒子的自旋各不相同。", "outputFormat": "输出一个整数，为经过一些任意的相互作用之后剩余的哞粒子的最小数量。", "hint": "### 样例输入输出 1 解释\n\n一个可能的相互作用顺序：\n\n- 粒子 $1$ 和 $4$ 相互作用，粒子 $1$ 消失。\n- 粒子 $2$ 和 $4$ 相互作用，粒子 $4$ 消失。\n- 粒子 $2$ 和 $3$ 相互作用，粒子 $3$ 消失。\n仅留下粒子 $2$。\n\n### 样例输入输出 2 解释\n\n粒子 $3$ 不能与任何其他两个粒子相互作用，所以它必然会留下。粒子 $1$ 和 $2$ 中必然留下至少一个。\n\n### 子任务\n- 测试点 $3$-$6$ 满足 $N\\le 10^3$。\n- 测试点 $7$-$12$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20OPEN] The Moo Particle S", "background": "", "description": "FJ 的奶牛们最近很无聊，她们想到了一种全新的方式缓解无聊：研究高等物理！事实上，她们甚至成功发现了一种新的亚原子粒子，她们将其命名为“哞粒子”。\n\n奶牛们正在进行一项有关 $N$ 个哞粒子的实验（$1\\le N\\le 10^5$）。粒子 $i$ 的“自旋”可以用范围在 $−10^9\\ldots 10^9$ 之间的两个整数 $x_i$ 和 $y_i$ 来描述。有时两个哞粒子会发生相互作用。自旋为 ($x_i,y_i$) 和 ($x_j,y_j$) 的两个粒子之间仅当 $x_i\\le x_j$ 并且 $y_i\\le y_j$ 时会发生相互作用。在这些条件下，有可能这两个粒子中的一个会消失（另一个粒子不会发生任何变化）。在任意给定的时刻，至多只有一次相互作用会发生。\n\n奶牛们想要知道在经过一些任意的相互作用之后剩余的哞粒子的最小数量。", "inputFormat": "输入的第一行包含一个整数 $N$，为哞粒子的初始数量。以下 $N$ 行每行包含两个空格分隔的整数，为一个粒子的自旋。每个粒子的自旋各不相同。", "outputFormat": "输出一个整数，为经过一些任意的相互作用之后剩余的哞粒子的最小数量。", "hint": "### 样例输入输出 1 解释\n\n一个可能的相互作用顺序：\n\n- 粒子 $1$ 和 $4$ 相互作用，粒子 $1$ 消失。\n- 粒子 $2$ 和 $4$ 相互作用，粒子 $4$ 消失。\n- 粒子 $2$ 和 $3$ 相互作用，粒子 $3$ 消失。\n仅留下粒子 $2$。\n\n### 样例输入输出 2 解释\n\n粒子 $3$ 不能与任何其他两个粒子相互作用，所以它必然会留下。粒子 $1$ 和 $2$ 中必然留下至少一个。\n\n### 子任务\n- 测试点 $3$-$6$ 满足 $N\\le 10^3$。\n- 测试点 $7$-$12$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6284", "type": "P", "difficulty": 1, "samples": [["10\n3\n4\n6\n2 ", "28"], ["10\n3\n10\n2\n12 ", "16"], ["15\n3\n15\n10\n20 ", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #1] Tarifa", "background": "", "description": "为了能够在网上冲浪，Pero 购买了一个数据套餐：\n\n- 每月他将获得 $x \\rm{MB}$ 流量。\n- 每月未用完的流量，可以在次月继续使用。\n\n现在，我们知道了 Pero 在使用这个套餐的前 $n$ 个月中，每月使用了多少 $\\rm{MB}$ 流量。请你帮忙计算，第 $n+1$ 月他能使用多少 $\\rm{MB}$ 流量。", "inputFormat": "第一行一个整数 $x$。\n\n第二行一个整数 $n$。\n\n接下来 $n$ 行，每行一个整数 $p_i$，表示第 $i$ 月 Pero 使用了多少 $\\rm{MB}$ 流量。", "outputFormat": "一行，一个整数，表示第 $n+1$ 月 Pero 能使用多少 $\\rm{MB}$ 流量。", "hint": "#### 样例 1 解释\n\n第一月，Pero 能使用 $10\\rm{MB}$ 流量，实际使用 $4\\rm{MB}$ 流量，剩余 $6\\rm{MB}$ 流量。 \n\n第二月，Pero 能使用 $6+10=16(\\rm{MB})$ 流量，实际使用 $6\\rm{MB}$ 流量，剩余 $10\\rm{MB}$ 流量。 \n\n第三月，Pero 能使用 $10+10=20(\\rm{MB})$ 流量，实际使用 $2\\rm{MB}$ 流量，剩余 $18\\rm{MB}$ 流量。\n \n第四月，Pero 能使用 $18+10=28(\\rm{MB)}$ 流量。\n\n---\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le x\\le 100$，$1\\le n\\le 100$，$0\\le p_i\\le 10^4$。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T1 Tarifa_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #1] Tarifa", "background": "", "description": "为了能够在网上冲浪，Pero 购买了一个数据套餐：\n\n- 每月他将获得 $x \\rm{MB}$ 流量。\n- 每月未用完的流量，可以在次月继续使用。\n\n现在，我们知道了 Pero 在使用这个套餐的前 $n$ 个月中，每月使用了多少 $\\rm{MB}$ 流量。请你帮忙计算，第 $n+1$ 月他能使用多少 $\\rm{MB}$ 流量。", "inputFormat": "第一行一个整数 $x$。\n\n第二行一个整数 $n$。\n\n接下来 $n$ 行，每行一个整数 $p_i$，表示第 $i$ 月 Pero 使用了多少 $\\rm{MB}$ 流量。", "outputFormat": "一行，一个整数，表示第 $n+1$ 月 Pero 能使用多少 $\\rm{MB}$ 流量。", "hint": "#### 样例 1 解释\n\n第一月，Pero 能使用 $10\\rm{MB}$ 流量，实际使用 $4\\rm{MB}$ 流量，剩余 $6\\rm{MB}$ 流量。 \n\n第二月，Pero 能使用 $6+10=16(\\rm{MB})$ 流量，实际使用 $6\\rm{MB}$ 流量，剩余 $10\\rm{MB}$ 流量。 \n\n第三月，Pero 能使用 $10+10=20(\\rm{MB})$ 流量，实际使用 $2\\rm{MB}$ 流量，剩余 $18\\rm{MB}$ 流量。\n \n第四月，Pero 能使用 $18+10=28(\\rm{MB)}$ 流量。\n\n---\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le x\\le 100$，$1\\le n\\le 100$，$0\\le p_i\\le 10^4$。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T1 Tarifa_**。", "locale": "zh-CN"}}}
{"pid": "P6285", "type": "P", "difficulty": 3, "samples": [["11\n.....XX...X\n....XX...XX\n...XX...XX.\n...........\n....XXX....\n...........\n.....X.....\n....XX...X.\n...XX...XX.\n...X...XX.. ", "2\n1 4\n7 2 "], ["20\nX..................X\n.X................X.\n..X..............X..\n...X............X...\n....X..........X....\n.....X........X.....\n......X......X......\n.......X....X.......\n........X..X........\n.........XX......... ", "1\n8 10 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #1] Jetpack", "background": "", "description": "Mirko 正在玩一款小游戏。在一个 $10$ 行 $n$ 列的矩阵中，他需要从左下角出发，避免在障碍物处停留，最终到达第 $n$ 列的任意位置。每秒，他都会向右移动一个单位。\n\n在游戏中，Mirko 拥有一个喷气背包（游戏开始时关闭）：\n\n- 打开喷气背包时，每秒他将额外向上移动一个单位（即向右上方移动），直到他处于矩阵顶端的一行。\n- 关闭喷气背包时，每秒他将额外向下移动一个单位（即向右下方移动），直到他处于矩阵底端的一行。\n\n他可以在任意一秒打开喷气背包，并在任意秒后关闭。将此记为一次操作。\n\n现在，Mirko 想让你设计一系列操作，使他能够顺利结束游戏。", "inputFormat": "第一行一个整数 $n$，表示矩阵的列数。\n\n接下来 $10$ 行，每行 $n$ 个字符。表示相应位置是否存在障碍物。字符只可能是 `.` 或 `X`。\n\n- `.` 表示该区域不存在障碍物。\n- `X` 表示该区域存在障碍物。", "outputFormat": "**本题使用 Special Judge**。\n\n第一行一个非负整数 $p$，表示 Mirko 应进行操作的次数。\n\n接下来 $p$ 行，每行两个正整数 $t_i$ 和 $x_i$，表示 Mirko 需要在第 $t_i$ 秒打开喷气背包，并在 $x_i$ 秒后关闭。\n\n若存在多种答案，请输出任意一种。\n\n另外：\n\n- 操作应按时间顺序给出，且在一次操作完成前无法进行其他操作。即 $t_i+x_i\\le t_{i+1}$。\n- 游戏结束后 Mirko 无法进行任何操作。即 $t_i<n$。\n- Mirko 不希望操作次数过多。即 $0\\le p\\le 5\\times 10^4$。", "hint": "#### 样例 1 解释\n\n下图为样例输出一所表示的路径。\n\n```\n.....XX...X\n....XX...XX\n...XX...XX.\n...........\n....XXX....\n.....*...*.\n....*X*.*.*\n...*XX.*.X.\n..*XX...XX.\n**.X...XX.. \n```\n\n---\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^5$。\n\n数据保证至少存在一种方案，能使得 Mirko 能够顺利结束游戏。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T2 Jetpack_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #1] Jetpack", "background": "", "description": "Mirko 正在玩一款小游戏。在一个 $10$ 行 $n$ 列的矩阵中，他需要从左下角出发，避免在障碍物处停留，最终到达第 $n$ 列的任意位置。每秒，他都会向右移动一个单位。\n\n在游戏中，Mirko 拥有一个喷气背包（游戏开始时关闭）：\n\n- 打开喷气背包时，每秒他将额外向上移动一个单位（即向右上方移动），直到他处于矩阵顶端的一行。\n- 关闭喷气背包时，每秒他将额外向下移动一个单位（即向右下方移动），直到他处于矩阵底端的一行。\n\n他可以在任意一秒打开喷气背包，并在任意秒后关闭。将此记为一次操作。\n\n现在，Mirko 想让你设计一系列操作，使他能够顺利结束游戏。", "inputFormat": "第一行一个整数 $n$，表示矩阵的列数。\n\n接下来 $10$ 行，每行 $n$ 个字符。表示相应位置是否存在障碍物。字符只可能是 `.` 或 `X`。\n\n- `.` 表示该区域不存在障碍物。\n- `X` 表示该区域存在障碍物。", "outputFormat": "**本题使用 Special Judge**。\n\n第一行一个非负整数 $p$，表示 Mirko 应进行操作的次数。\n\n接下来 $p$ 行，每行两个正整数 $t_i$ 和 $x_i$，表示 Mirko 需要在第 $t_i$ 秒打开喷气背包，并在 $x_i$ 秒后关闭。\n\n若存在多种答案，请输出任意一种。\n\n另外：\n\n- 操作应按时间顺序给出，且在一次操作完成前无法进行其他操作。即 $t_i+x_i\\le t_{i+1}$。\n- 游戏结束后 Mirko 无法进行任何操作。即 $t_i<n$。\n- Mirko 不希望操作次数过多。即 $0\\le p\\le 5\\times 10^4$。", "hint": "#### 样例 1 解释\n\n下图为样例输出一所表示的路径。\n\n```\n.....XX...X\n....XX...XX\n...XX...XX.\n...........\n....XXX....\n.....*...*.\n....*X*.*.*\n...*XX.*.X.\n..*XX...XX.\n**.X...XX.. \n```\n\n---\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^5$。\n\n数据保证至少存在一种方案，能使得 Mirko 能够顺利结束游戏。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T2 Jetpack_**。", "locale": "zh-CN"}}}
{"pid": "P6286", "type": "P", "difficulty": 5, "samples": [["2\nab\nbc\n2 1 ", "DA\nbacdefghijklmnopqrstuvwxyz "], ["3\nabc\nbcd\nadd\n1 2 3 ", "NE "], ["3\nbbb\nccc\nddd\n2 3 1 ", "DA\nadbcefghijklmnopqrstuvwxyz "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2016", "Special Judge", "拓扑排序", "字典树 Trie", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #1] Cezar", "background": "", "description": "Mirko 想对 $n$ 个单词进行加密。加密过程是这样的：\n\n1.  选择一个英文字母表的排列作为密钥。\n2.  将单词中的 `a` 替换为密钥中的第一个字母，`b` 替换为密钥中的第二个字母……以此类推。\n\n例如，以 `qwertyuiopasdfghjklzxcvbnm` 作为密钥对 `cezar` 加密后，将得到 `etmqk`。\n\n他希望，将所有单词加密并按字典序升序排列后，最初的第 $a_i$ 个单词位于第 $i$ 位。请你判断，这能否实现。如果能，请给出任意一种可行的密钥。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个字符串，表示待加密的单词。\n\n最后一行 $n$ 个整数，表示 $a_i$。", "outputFormat": "**本题使用 Special Judge**。\n\n如果 Mirko 的要求不能实现，输出 `NE`。\n\n否则，输出 `DA`。接下来一行输出任意一种可行的密钥。", "hint": "#### 【样例解释】\n\n**样例 1 解释**\n\n以 `bacdefghijklmnopqrstuvwxyz` 为密钥加密后，得到：\n\n- `ba`\n- `ac`\n\n字典序升序排列后，得到：\n\n- `ac`\n- `ba`\n\n原先的第一个单词在第二位，第二个单词在第一位。符合要求。\n\n**样例 3 解释**\n\n以 `adbcefghijklmnopqrstuvwxyz`  为密钥加密后，得到：\n\n- `ddd`\n- `bbb`\n- `ccc`\n\n字典序升序排列后，得到：\n\n- `bbb`\n- `ddd`\n- `ccc`\n\n原先的第一个单词在第二位，第二个单词在第三位，第三个单词在第一位。符合要求。\n\n---\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2\\le n\\le 100$，$1 \\leq a_i \\leq n$。\n\n所有单词的长度不超过 $100$，且只包含小写字母。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T3 Cezar_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #1] Cezar", "background": "", "description": "Mirko 想对 $n$ 个单词进行加密。加密过程是这样的：\n\n1.  选择一个英文字母表的排列作为密钥。\n2.  将单词中的 `a` 替换为密钥中的第一个字母，`b` 替换为密钥中的第二个字母……以此类推。\n\n例如，以 `qwertyuiopasdfghjklzxcvbnm` 作为密钥对 `cezar` 加密后，将得到 `etmqk`。\n\n他希望，将所有单词加密并按字典序升序排列后，最初的第 $a_i$ 个单词位于第 $i$ 位。请你判断，这能否实现。如果能，请给出任意一种可行的密钥。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个字符串，表示待加密的单词。\n\n最后一行 $n$ 个整数，表示 $a_i$。", "outputFormat": "**本题使用 Special Judge**。\n\n如果 Mirko 的要求不能实现，输出 `NE`。\n\n否则，输出 `DA`。接下来一行输出任意一种可行的密钥。", "hint": "#### 【样例解释】\n\n**样例 1 解释**\n\n以 `bacdefghijklmnopqrstuvwxyz` 为密钥加密后，得到：\n\n- `ba`\n- `ac`\n\n字典序升序排列后，得到：\n\n- `ac`\n- `ba`\n\n原先的第一个单词在第二位，第二个单词在第一位。符合要求。\n\n**样例 3 解释**\n\n以 `adbcefghijklmnopqrstuvwxyz`  为密钥加密后，得到：\n\n- `ddd`\n- `bbb`\n- `ccc`\n\n字典序升序排列后，得到：\n\n- `bbb`\n- `ddd`\n- `ccc`\n\n原先的第一个单词在第二位，第二个单词在第三位，第三个单词在第一位。符合要求。\n\n---\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2\\le n\\le 100$，$1 \\leq a_i \\leq n$。\n\n所有单词的长度不超过 $100$，且只包含小写字母。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T3 Cezar_**。", "locale": "zh-CN"}}}
{"pid": "P6287", "type": "P", "difficulty": 6, "samples": [["2\n1 2\n3\n4 ", "3/1 "], ["5\n1 2\n2 4\n1 3\n5 2\n2\n1\n1\n1 \n3 ", "1/2 "]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2016", "树形 DP", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #1] Mag", "background": "", "description": "你将获得一棵由无向边连接的树。树上每个节点都有一个魔力值。\n\n我们定义，一条路径的魔力值为路径上所有节点魔力值的乘积除以路径上的节点数。\n\n例如，若一条路径包含两个魔力值分别为 $3,5$ 的节点，则这条路径的魔力值为 $3\\times 5/2=7.5$。\n\n请你计算，这棵树上魔力值最小的路径的魔力值。", "inputFormat": "第一行一个整数 $n$，表示树共有 $n$ 个节点，编号为 $1\\dots n$。\n\n接下来 $n-1$ 行，每行两个整数 $a_i,b_i$，表示编号为 $a_i,b_i$ 的两个节点由一条无向边连接。\n\n接下来 $n$ 行，每行一个整数 $x_i$，表示编号为 $i$ 的节点的魔力值。", "outputFormat": "一行，一个既约分数 $p/q$。", "hint": "#### 【样例解释】\n\n**样例 1 解释**\n\n注意，路径可以只包含一个节点。\n\n这棵树上魔力值最小的路径的包含节点 $1$，其魔力值为 $3/1$。\n\n\n**样例 2 解释**\n\n这棵树上魔力值最小的路径的包含节点 $2,4$，其魔力值为 $1\\times 1/2=1/2$。\n\n------------\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le a_i,b_i\\le n$，$1\\le x_i\\le 10^9$。\n\n数据保证，$p,q$ 不会超过 $10^{18}$。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T4 Mag_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #1] Mag", "background": "", "description": "你将获得一棵由无向边连接的树。树上每个节点都有一个魔力值。\n\n我们定义，一条路径的魔力值为路径上所有节点魔力值的乘积除以路径上的节点数。\n\n例如，若一条路径包含两个魔力值分别为 $3,5$ 的节点，则这条路径的魔力值为 $3\\times 5/2=7.5$。\n\n请你计算，这棵树上魔力值最小的路径的魔力值。", "inputFormat": "第一行一个整数 $n$，表示树共有 $n$ 个节点，编号为 $1\\dots n$。\n\n接下来 $n-1$ 行，每行两个整数 $a_i,b_i$，表示编号为 $a_i,b_i$ 的两个节点由一条无向边连接。\n\n接下来 $n$ 行，每行一个整数 $x_i$，表示编号为 $i$ 的节点的魔力值。", "outputFormat": "一行，一个既约分数 $p/q$。", "hint": "#### 【样例解释】\n\n**样例 1 解释**\n\n注意，路径可以只包含一个节点。\n\n这棵树上魔力值最小的路径的包含节点 $1$，其魔力值为 $3/1$。\n\n\n**样例 2 解释**\n\n这棵树上魔力值最小的路径的包含节点 $2,4$，其魔力值为 $1\\times 1/2=1/2$。\n\n------------\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le a_i,b_i\\le n$，$1\\le x_i\\le 10^9$。\n\n数据保证，$p,q$ 不会超过 $10^{18}$。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T4 Mag_**。", "locale": "zh-CN"}}}
{"pid": "P6288", "type": "P", "difficulty": 5, "samples": [["3\n2 3 3\n4 1 10\n2 7 3 ", "2 "], ["4\n3 1 3 3\n5 8 7 10\n4 1 2 6 ", "1 "], ["3\n1 2 3\n8 4 3\n9 2 6 ", "2 "]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #1] Kralj", "background": "", "description": "矮人国和精灵国即将爆发战争！精灵王 Slavko 将 $n$ 个精灵编号为 $1\\dots n$。矮人王 Mirko 则让 $n$ 个矮人围成一个圆环，从某个矮人开始顺时针编号为 $1\\dots n$。\n\n接下来，Mirko 将为每个精灵分配一个数字 $a_i$，表示将与它们决斗的矮人的编号。然而，由于他的粗心，不同精灵分配到的数字可能是相同的。\n\n为了决斗的公平，双方决定：\n\n1.  Slavko 选出一位尚未确定对手的精灵，设其编号为 $i$。\n2.  若编号为 $a_i$ 的矮人尚未确定对手，则将其作为这位精灵的对手。否则，从编号为 $a_i$ 的矮人开始，选择沿圆环顺时针方向第一个尚未确定对手的矮人作为这位精灵的对手。\n3.  重复以上步骤，直到所有矮人及精灵都确定了对手。\n\nSlavko 收集了所有矮人及精灵的力量值。决斗时，力量值大的一方总是获胜。他想知道，通过规划选择精灵的顺序，最多能有多少精灵在决斗中获胜。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $a_i$。\n\n第三行 $n$ 个整数 $p_i$，表示编号为 $i$ 的矮人的力量值。\n\n第四行 $n$ 个整数 $v_i$，表示编号为 $i$ 的精灵的力量值。", "outputFormat": "一行，一个整数，表示最多能有多少精灵在决斗中获胜。", "hint": "#### 样例 1 解释\n\nSlavko 以 $3,2,1$ 的顺序选择精灵。\n\n这样，编号为 $1,2,3$ 的精灵的对手编号分别为 $2,1,3$。\n\n编号为 $1,2$ 的精灵将在决斗中获胜。\n\n------------\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^5$，$1\\le a_i\\le n$，$1\\le p_i,v_i\\le 10^9$。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T5 Kralj_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #1] Kralj", "background": "", "description": "矮人国和精灵国即将爆发战争！精灵王 Slavko 将 $n$ 个精灵编号为 $1\\dots n$。矮人王 Mirko 则让 $n$ 个矮人围成一个圆环，从某个矮人开始顺时针编号为 $1\\dots n$。\n\n接下来，Mirko 将为每个精灵分配一个数字 $a_i$，表示将与它们决斗的矮人的编号。然而，由于他的粗心，不同精灵分配到的数字可能是相同的。\n\n为了决斗的公平，双方决定：\n\n1.  Slavko 选出一位尚未确定对手的精灵，设其编号为 $i$。\n2.  若编号为 $a_i$ 的矮人尚未确定对手，则将其作为这位精灵的对手。否则，从编号为 $a_i$ 的矮人开始，选择沿圆环顺时针方向第一个尚未确定对手的矮人作为这位精灵的对手。\n3.  重复以上步骤，直到所有矮人及精灵都确定了对手。\n\nSlavko 收集了所有矮人及精灵的力量值。决斗时，力量值大的一方总是获胜。他想知道，通过规划选择精灵的顺序，最多能有多少精灵在决斗中获胜。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $a_i$。\n\n第三行 $n$ 个整数 $p_i$，表示编号为 $i$ 的矮人的力量值。\n\n第四行 $n$ 个整数 $v_i$，表示编号为 $i$ 的精灵的力量值。", "outputFormat": "一行，一个整数，表示最多能有多少精灵在决斗中获胜。", "hint": "#### 样例 1 解释\n\nSlavko 以 $3,2,1$ 的顺序选择精灵。\n\n这样，编号为 $1,2,3$ 的精灵的对手编号分别为 $2,1,3$。\n\n编号为 $1,2$ 的精灵将在决斗中获胜。\n\n------------\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^5$，$1\\le a_i\\le n$，$1\\le p_i,v_i\\le 10^9$。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T5 Kralj_**。", "locale": "zh-CN"}}}
{"pid": "P6289", "type": "P", "difficulty": 5, "samples": [["3\na\nab\nabc ", "4 "], ["3\na\nab\nc ", "4 "], ["4\nbaab\nabab\naabb\nbbaa ", "5 "]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "COCI（克罗地亚）", "状压 DP"], "title": "[COCI 2016/2017 #1] Vještica", "background": "", "description": "Matej 面临着一个难题。在此之前，我们必须熟悉一种称作前缀树（`trie`）的数据结构。前缀树以前缀的方式，储存单词：\n\n- 前缀树的每一条边都用英文字母表中的字母表示。\n- 前缀树的根节点表示空前缀。\n- 前缀树的每个其他节点都表示一个非空前缀。依次连接根节点至该节点路径上所标有的字母，即可得到该前缀。\n- 不存在从一个节点出发的、标有相同字母的两条边。\n\n例如，这棵前缀树储存了 `A,to,tea,ted,ten,i,in,inn`：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/etllxob4.png)\n\n现在，Matej 获得了 $n$ 个单词，并可以将其中的一些单词重组。例如 `abc` 可以重组为 `acb,bac,bca,cab,cba`。请你计算，将一些单词重组后，储存这些单词的前缀树节点数的最小值。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个字符串，表示 Matej 获得的单词。", "outputFormat": "一行，一个整数，表示将一些单词重组后，储存这些单词的前缀树节点数的最小值。", "hint": "#### 样例 3 解释\n\n所有单词均可以重组为 `aabb`。显然，前缀树最少的节点数应为 $5$（包含了表示空前缀的根节点）。\n\n------------\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 16$。\n\n所有单词的长度和不超过 $10^6$，且只包含小写字母。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T6 Vještica_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #1] Vještica", "background": "", "description": "Matej 面临着一个难题。在此之前，我们必须熟悉一种称作前缀树（`trie`）的数据结构。前缀树以前缀的方式，储存单词：\n\n- 前缀树的每一条边都用英文字母表中的字母表示。\n- 前缀树的根节点表示空前缀。\n- 前缀树的每个其他节点都表示一个非空前缀。依次连接根节点至该节点路径上所标有的字母，即可得到该前缀。\n- 不存在从一个节点出发的、标有相同字母的两条边。\n\n例如，这棵前缀树储存了 `A,to,tea,ted,ten,i,in,inn`：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/etllxob4.png)\n\n现在，Matej 获得了 $n$ 个单词，并可以将其中的一些单词重组。例如 `abc` 可以重组为 `acb,bac,bca,cab,cba`。请你计算，将一些单词重组后，储存这些单词的前缀树节点数的最小值。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个字符串，表示 Matej 获得的单词。", "outputFormat": "一行，一个整数，表示将一些单词重组后，储存这些单词的前缀树节点数的最小值。", "hint": "#### 样例 3 解释\n\n所有单词均可以重组为 `aabb`。显然，前缀树最少的节点数应为 $5$（包含了表示空前缀的根节点）。\n\n------------\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 16$。\n\n所有单词的长度和不超过 $10^6$，且只包含小写字母。\n\n------------\n\n#### 说明\n\n**题目译自 [COCI2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #1](https://hsin.hr/coci/archive/2016_2017/contest1_tasks.pdf) _T6 Vještica_**。", "locale": "zh-CN"}}}
{"pid": "P6290", "type": "P", "difficulty": 5, "samples": [["4 100 2\n0 1\n2 3\n3 2\n6 10\n0 5\n3 10\n5 1\n7 20", "4 2\n2 4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "eJOI（欧洲）"], "title": "[eJOI 2017] 粒子", "background": "", "description": "两台相距 $L$ 的直线粒子加速器相对放置着。加速器 $A$ 发射 $x$ 粒子，加速器 $B$ 发射 $y$ 粒子。这两种粒子相遇时会碰撞并湮灭。注意，一个 $x$ 粒子可以超越另一个 $x$ 粒子，不会发生任何事。对于 $y$ 粒子也是同理。\n\n在这样的条件下，从 $0$ 时刻开始，$A,B$ 加速器 分别开始发射 $N$ 个 $x,y$ 粒子。每一个粒子都以一个固定的速度移动。$x,y$ 粒子分别被编号为 $1,2,\\cdots N$。\n\n注：在时间 $t$ 内，速度为 $v$ 的粒子移动的路程为 $s = vt$。\n\n$x$ 粒子的发射时刻从编号 $1$ 到 $N$ 分别为：$0 = tx_1 <  tx_2 < tx_3 < \\cdots < tx_N$，速度分别为：$vx_1, vx_2, vx_3, \\cdots, vx_N$。\n\n相应的， $y$ 粒子的发射时刻分别为：$0 = ty_1 <  ty_2 < ty_3 < \\cdots < ty_N$，速度分别为：$vy_1, vy_2, vy_3, \\cdots, vy_N$。\n\n发射粒子的过程中满足：\n\n- 每个粒子会碰撞一个相反类型（$x,y$ 粒子互为相反粒子）的粒子。\n- 当两个粒子碰撞时，所有其他粒子到碰撞点的距离将 $\\ge 1$。在前 $K$ 次碰撞中，这个条件被满足。\n\n------------------------\n\n你的任务是，编写一个程序，确定前 $K$ 次碰撞的粒子对。", "inputFormat": "第一行，三个正整数，由空格隔开：$N,L,K$。\n\n接下来 $N$ 行，每行两个整数：$tx_i,vx_i$。\n\n再接下来 $N$ 行，每行两个整数：$ty_i,vy_i$。", "outputFormat": "输出共 $K$ 行。\n\n每行两个正整数 $i,j$，表示第 $i$ 个 $x$ 粒子和第 $j$ 个 $y$ 粒子。\n\n第 $l$ 行表示第 $i$ 个 $x$ 粒子和第 $j$ 个 $y$ 粒子是第 $l$ 个发生碰撞的，即输出顺序代表碰撞的先后顺序。", "hint": "#### 数据规模与约定\n\n对于所有数据，保证：\n\n- $1 \\le N \\le 5\\times 10^4$。\n- $1 \\le L \\le 10^9$。\n- $1\\le K \\le \\min(10^2,N)$。\n- $tx_i,ty_i \\in [0,10^9]$。\n- $vx_i,vy_i \\in (0,10^9]$。\n\n其中，对于 $30 \\%$ 的数据，有 $1 \\le N \\le 10^3$。\n\n#### 说明\n\n原题来自：[eJOI2017](www.ejoi.org) Problem C [Particles](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_1/EN/particles_statement-en.pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2017] 粒子", "background": "", "description": "两台相距 $L$ 的直线粒子加速器相对放置着。加速器 $A$ 发射 $x$ 粒子，加速器 $B$ 发射 $y$ 粒子。这两种粒子相遇时会碰撞并湮灭。注意，一个 $x$ 粒子可以超越另一个 $x$ 粒子，不会发生任何事。对于 $y$ 粒子也是同理。\n\n在这样的条件下，从 $0$ 时刻开始，$A,B$ 加速器 分别开始发射 $N$ 个 $x,y$ 粒子。每一个粒子都以一个固定的速度移动。$x,y$ 粒子分别被编号为 $1,2,\\cdots N$。\n\n注：在时间 $t$ 内，速度为 $v$ 的粒子移动的路程为 $s = vt$。\n\n$x$ 粒子的发射时刻从编号 $1$ 到 $N$ 分别为：$0 = tx_1 <  tx_2 < tx_3 < \\cdots < tx_N$，速度分别为：$vx_1, vx_2, vx_3, \\cdots, vx_N$。\n\n相应的， $y$ 粒子的发射时刻分别为：$0 = ty_1 <  ty_2 < ty_3 < \\cdots < ty_N$，速度分别为：$vy_1, vy_2, vy_3, \\cdots, vy_N$。\n\n发射粒子的过程中满足：\n\n- 每个粒子会碰撞一个相反类型（$x,y$ 粒子互为相反粒子）的粒子。\n- 当两个粒子碰撞时，所有其他粒子到碰撞点的距离将 $\\ge 1$。在前 $K$ 次碰撞中，这个条件被满足。\n\n------------------------\n\n你的任务是，编写一个程序，确定前 $K$ 次碰撞的粒子对。", "inputFormat": "第一行，三个正整数，由空格隔开：$N,L,K$。\n\n接下来 $N$ 行，每行两个整数：$tx_i,vx_i$。\n\n再接下来 $N$ 行，每行两个整数：$ty_i,vy_i$。", "outputFormat": "输出共 $K$ 行。\n\n每行两个正整数 $i,j$，表示第 $i$ 个 $x$ 粒子和第 $j$ 个 $y$ 粒子。\n\n第 $l$ 行表示第 $i$ 个 $x$ 粒子和第 $j$ 个 $y$ 粒子是第 $l$ 个发生碰撞的，即输出顺序代表碰撞的先后顺序。", "hint": "#### 数据规模与约定\n\n对于所有数据，保证：\n\n- $1 \\le N \\le 5\\times 10^4$。\n- $1 \\le L \\le 10^9$。\n- $1\\le K \\le \\min(10^2,N)$。\n- $tx_i,ty_i \\in [0,10^9]$。\n- $vx_i,vy_i \\in (0,10^9]$。\n\n其中，对于 $30 \\%$ 的数据，有 $1 \\le N \\le 10^3$。\n\n#### 说明\n\n原题来自：[eJOI2017](www.ejoi.org) Problem C [Particles](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_1/EN/particles_statement-en.pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN"}}}
{"pid": "P6291", "type": "P", "difficulty": 6, "samples": [["10", "1 52 29 8 51 28 9 50 37 16\n85 95 59 86 94 66 87 93 65 88\n40 19 100 39 18 76 38 17 77 49\n2 53 30 7 58 27 10 89 36 15\n84 96 60 75 99 67 72 92 64 71\n41 20 82 44 23 90 45 24 78 48\n3 54 31 6 57 26 11 68 35 14\n83 97 61 74 98 62 73 91 63 70\n42 21 81 43 22 80 46 25 79 47\n4 55 32 5 56 33 12 69 34 13"]], "limits": {"time": [450, 450, 450, 450, 450, 450, 450, 450, 450, 450, 450, 450, 450, 450, 450, 450, 450], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "Special Judge", "eJOI（欧洲）"], "title": "[eJOI 2017] 骆驼", "background": "", "description": "我们在棋盘上引入一个新的棋子，称之为“骆驼棋”。棋子跳跃规则：你可以将它移动到水平或垂直方向上的一个位置，使得新位置与旧位置之间隔着 $2$ 格；或者像四个斜对角线的方向之一移动，使得新位置与旧位置之间恰好相隔一个格子。如图，棋盘的中心就是棋子的位置，$8$ 个打上 ”$\\times$“标记的就是可以移动到的位置。显然，棋子不可以跳出棋盘。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f730ijf4.png)\n\n整个棋盘是 $N$ 行 $N$  列的，其中保证 $5 | N$ 。\n\n一开始，棋子在棋盘的左上角。经过一系列移动，使得整个棋盘每一个格子都被走过恰好一次，并且最后的位置与开始位置之间恰好可以以骆驼棋一步互相到达，这就是所谓的”骆驼循环“。\n\n你需要写一个程序，找到给定棋盘的”骆驼循环”。或者判断是否存在“骆驼循环”。", "inputFormat": "输入仅一行，一个正整数 $N$。", "outputFormat": "首先，如果不存在输出 ```NO```。\n\n输出包含一个 $N \\times N$ 的方阵。\n\n方阵包含 $N^2$ 个不同的正整数，大小在 $[1,N^2]$ 范围内，表示每一个格子的访问顺序。那么第一个数字就是 $1$ 。\n\n例如，第 $i$ 行第 $j$ 列的数为 $k$ 说明这一个位置的格子是第 $k$ 个被走到的。详见样例。", "hint": "#### Special Judge 计分标准\n\n如果可行解有多个，输出任意一个就可以拿到这个测试点的分数。\n\n如果输出不完全或发现不正确的情况你可能会得到一个 UKE。\n\n如果在不该输出 ```NO``` 的地方输出了 ```NO``` ，你们你会得到 ```WA```，以及一句 ```wrong output format Expected integer, but \"NO\" found```\n\n#### 输入输出样例解释\n\n棋子移动的方式为：$(1,1)$（表示第一行第一列） $\\rightarrow (4,1) \\rightarrow (7,1) \\rightarrow \\text{etc.}$\n\n最后棋子在 $(3,3)$ 处停止，恰好可以一步走到起点。\n\n附图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uv3273g2.png)\n\n#### 数据规模与约定\n\n对于所有数据，保证 $1\\le N\\le 10^3$，且 $n$ 是 $5$ 的倍数。\n\n本题共 $17$ 个测试点。\n\n- 对于其中一个测试点，有 $N=5$ ，单点分值比例为 $20 \\%$。\n- 对于其他 $16$ 个测试点，无其他限制，单点分值比例为 $5\\%$。\n\n#### 说明\n\n原题来自：[eJOI2017](www.ejoi.org) Problem D [Camel](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_2/EN/camel_statement-en.pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2017] 骆驼", "background": "", "description": "我们在棋盘上引入一个新的棋子，称之为“骆驼棋”。棋子跳跃规则：你可以将它移动到水平或垂直方向上的一个位置，使得新位置与旧位置之间隔着 $2$ 格；或者像四个斜对角线的方向之一移动，使得新位置与旧位置之间恰好相隔一个格子。如图，棋盘的中心就是棋子的位置，$8$ 个打上 ”$\\times$“标记的就是可以移动到的位置。显然，棋子不可以跳出棋盘。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f730ijf4.png)\n\n整个棋盘是 $N$ 行 $N$  列的，其中保证 $5 | N$ 。\n\n一开始，棋子在棋盘的左上角。经过一系列移动，使得整个棋盘每一个格子都被走过恰好一次，并且最后的位置与开始位置之间恰好可以以骆驼棋一步互相到达，这就是所谓的”骆驼循环“。\n\n你需要写一个程序，找到给定棋盘的”骆驼循环”。或者判断是否存在“骆驼循环”。", "inputFormat": "输入仅一行，一个正整数 $N$。", "outputFormat": "首先，如果不存在输出 ```NO```。\n\n输出包含一个 $N \\times N$ 的方阵。\n\n方阵包含 $N^2$ 个不同的正整数，大小在 $[1,N^2]$ 范围内，表示每一个格子的访问顺序。那么第一个数字就是 $1$ 。\n\n例如，第 $i$ 行第 $j$ 列的数为 $k$ 说明这一个位置的格子是第 $k$ 个被走到的。详见样例。", "hint": "#### Special Judge 计分标准\n\n如果可行解有多个，输出任意一个就可以拿到这个测试点的分数。\n\n如果输出不完全或发现不正确的情况你可能会得到一个 UKE。\n\n如果在不该输出 ```NO``` 的地方输出了 ```NO``` ，你们你会得到 ```WA```，以及一句 ```wrong output format Expected integer, but \"NO\" found```\n\n#### 输入输出样例解释\n\n棋子移动的方式为：$(1,1)$（表示第一行第一列） $\\rightarrow (4,1) \\rightarrow (7,1) \\rightarrow \\text{etc.}$\n\n最后棋子在 $(3,3)$ 处停止，恰好可以一步走到起点。\n\n附图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uv3273g2.png)\n\n#### 数据规模与约定\n\n对于所有数据，保证 $1\\le N\\le 10^3$，且 $n$ 是 $5$ 的倍数。\n\n本题共 $17$ 个测试点。\n\n- 对于其中一个测试点，有 $N=5$ ，单点分值比例为 $20 \\%$。\n- 对于其他 $16$ 个测试点，无其他限制，单点分值比例为 $5\\%$。\n\n#### 说明\n\n原题来自：[eJOI2017](www.ejoi.org) Problem D [Camel](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_2/EN/camel_statement-en.pdf)\n\n翻译提供：@[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN"}}}
{"pid": "P6292", "type": "P", "difficulty": 7, "samples": [["aababc\n3\n1 2\n2 4\n3 6", "2\n5\n9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "后缀自动机 SAM", "动态树 LCT"], "title": "区间本质不同子串个数", "background": "", "description": "给定一个长度为 $n$ 的仅包含小写字母的字符串 $S$，$m$ 次询问由 $S$ 的第 $L$ 到第 $R$ 个字符组成的字符串包含多少个本质不同的非空子串。\n\n定义两个字符串 $a,b$ 相同当且仅当 $|a|=|b|$ 并且对于 $i\\in[1,|a|]$ 都有 $a_i=b_i$。", "inputFormat": "第一行一个长度为 $n$ 的字符串 $S$。\n\n第二行一个整数 $m$，表示询问次数。\n\n接下来 $m$ 行，第 $i$ 行包含两个整数 $l_i,r_i$，描述第 $i$ 次询问。", "outputFormat": "$m$ 行，每行一个整数，表示第 $i$ 次询问的答案。", "hint": "#### 样例 1 解释\n\n- 第一次询问，字符串为 $\\texttt{aa}$，包含 $\\texttt{a}$,$\\texttt{aa}$ 共 $2$ 种本质不同子串。\n- 第二次询问，字符串为  $\\texttt{aba}$，包含  $\\texttt{a},\\texttt{b},\\texttt{ab},\\texttt{ba},\\texttt{aba}$, 共  $5$ 种本质不同子串。\n- 第三次询问，字符串为 $\\texttt{babc}$，包含 $\\texttt{a}$,$\\texttt{b}$,$\\texttt{c}$,$\\texttt{ab}$,$\\texttt{ba}$,$\\texttt{bc}$,$\\texttt{bab}$,$\\texttt{abc}$,$\\texttt{babc}$ 共 $9$ 种本质不同子串。\n\n#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，满足 $n\\leq 3\\times 10^3$，$m\\leq 3\\times 10^3$。\n- 对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 10^5$，$1\\leq m\\leq 2\\times 10^5$，$1\\leq l_i\\leq r_i\\leq n(i\\in[1,m])$。", "locale": "zh-CN", "translations": {"en": {"title": "Number of Essentially Different Substrings in an Interval.", "background": "", "description": "Given a string $S$ of length $n$ consisting only of lowercase letters, there are $m$ queries. Each query asks how many essentially different non-empty substrings are contained in the string formed by the $L$-th to the $R$-th characters of $S$.\n\nTwo strings $a, b$ are defined to be the same if and only if $|a|=|b|$ and for all $i\\in[1,|a|]$, we have $a_i=b_i$.", "inputFormat": "The first line contains a string $S$ of length $n$.\n\nThe second line contains an integer $m$, indicating the number of queries.\n\nThe next $m$ lines each contain two integers $l_i, r_i$, describing the $i$-th query.", "outputFormat": "Output $m$ lines, each containing an integer, representing the answer to the $i$-th query.", "hint": "#### Explanation for Sample 1\n\n- For the first query, the string is $\\texttt{aa}$, and it contains $\\texttt{a}$ and $\\texttt{aa}$, for a total of $2$ essentially different substrings.\n- For the second query, the string is $\\texttt{aba}$, and it contains $\\texttt{a},\\texttt{b},\\texttt{ab},\\texttt{ba},\\texttt{aba}$, for a total of $5$ essentially different substrings.\n- For the third query, the string is $\\texttt{babc}$, and it contains $\\texttt{a}$,$\\texttt{b}$,$\\texttt{c}$,$\\texttt{ab}$,$\\texttt{ba}$,$\\texttt{bc}$,$\\texttt{bab}$,$\\texttt{abc}$,$\\texttt{babc}$, for a total of $9$ essentially different substrings.\n\n#### Constraints\n\n- For $20\\%$ of the testdata, $n\\leq 3\\times 10^3$ and $m\\leq 3\\times 10^3$.\n- For $100\\%$ of the testdata, $1\\leq n\\leq 10^5$, $1\\leq m\\leq 2\\times 10^5$, $1\\leq l_i\\leq r_i\\leq n(i\\in[1,m])$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "区间本质不同子串个数", "background": "", "description": "给定一个长度为 $n$ 的仅包含小写字母的字符串 $S$，$m$ 次询问由 $S$ 的第 $L$ 到第 $R$ 个字符组成的字符串包含多少个本质不同的非空子串。\n\n定义两个字符串 $a,b$ 相同当且仅当 $|a|=|b|$ 并且对于 $i\\in[1,|a|]$ 都有 $a_i=b_i$。", "inputFormat": "第一行一个长度为 $n$ 的字符串 $S$。\n\n第二行一个整数 $m$，表示询问次数。\n\n接下来 $m$ 行，第 $i$ 行包含两个整数 $l_i,r_i$，描述第 $i$ 次询问。", "outputFormat": "$m$ 行，每行一个整数，表示第 $i$ 次询问的答案。", "hint": "#### 样例 1 解释\n\n- 第一次询问，字符串为 $\\texttt{aa}$，包含 $\\texttt{a}$,$\\texttt{aa}$ 共 $2$ 种本质不同子串。\n- 第二次询问，字符串为  $\\texttt{aba}$，包含  $\\texttt{a},\\texttt{b},\\texttt{ab},\\texttt{ba},\\texttt{aba}$, 共  $5$ 种本质不同子串。\n- 第三次询问，字符串为 $\\texttt{babc}$，包含 $\\texttt{a}$,$\\texttt{b}$,$\\texttt{c}$,$\\texttt{ab}$,$\\texttt{ba}$,$\\texttt{bc}$,$\\texttt{bab}$,$\\texttt{abc}$,$\\texttt{babc}$ 共 $9$ 种本质不同子串。\n\n#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，满足 $n\\leq 3\\times 10^3$，$m\\leq 3\\times 10^3$。\n- 对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 10^5$，$1\\leq m\\leq 2\\times 10^5$，$1\\leq l_i\\leq r_i\\leq n(i\\in[1,m])$。", "locale": "zh-CN"}}}
{"pid": "P6293", "type": "P", "difficulty": 5, "samples": [["7\n5 5 3 6 2 3 3\n1 6\n5 3\n1 5\n6 2\n2 4\n6 7", "6"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "eJOI（欧洲）", "树形 DP"], "title": "[eJOI 2017] 经验", "background": "", "description": "X 公司有 $n$ 个员工。这个公司的员工之间的关系构成了一个树形结构。CEO 位于结构的顶端（树的根），他有一些下属（树根的子结点），下属又有下属……最后是一些底层员工（叶结点），没有下属。\n\n这些员工被从 $1$ 到 $n$ 标号，且 CEO 的标号为 1。每个员工有一个 **经验值**，第 $i$ 个员工的经验值为 $W_i$ 。\n\n这个公司有一个大工程需要完成，所以公司的管理者想要将这个树形结构分裂重组为更小的团队。分裂的方式应遵循以下的规则：\n\n- 任何一个团队至少由一个人组成，每个员工必须属于恰好一个团队。\n- 对于任何一个团队，假设团队的成员 **按原来的层次等级由低到高排序之后**  为 $\\{j_1,j_2,j_3,...,j_k\\}$ ，那么须满足：对于$\\forall i \\in [1,k-1]$ 满足 $j_i$ 为 $j_{i+1}$ 的上司。\n\n定义一个团队的总经验值为这个团队的所有成员的经验值的极差，换句话说，就是这个团队里所有成员经验值的最大值减去最小值。整个公司得到的总经验值就是所有团队的经验值之和。\n\n你的任务是求出整个公司可以得到的经验值的最大值。", "inputFormat": "第一行，一个整数 $n$；\n\n第二行，$n$ 个整数：$W_1,W_2,...,W_n$。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$ ，表示 $v$ 是 $u$ 的下属。", "outputFormat": "一个整数表示答案。", "hint": "#### 样例 1 解释\n\n![GBNNDJ.png](https://s1.ax1x.com/2020/04/05/GBNNDJ.png)\n\n一种方案是 $\\{1,5,3\\},\\{6,2,4\\},\\{7\\}$。\n\n或者是 $\\{1, 5\\}, \\{3\\}, \\{6, 2, 4\\}, \\{7\\}$。\n\n#### 数据规模与约定\n\n- 对于大约 $20\\%$ 的数据，保证：$n\\le 20$。\n- 对于大约 $50\\%$ 的数据，保证：$n\\le 5\\times 10^3$。\n- 对于另外大约 $10\\%$ 的数据，保证：每个员工至多有一个下属。\n- 对于所有数据，保证：$1\\le n\\le 10^5,0\\le W_i\\le 10^9$。\n\n#### 说明\n\n原题来自：[eJOI2017](www.ejoi.org) Problem E [Experience](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_2/EN/experience_statement-en.pdf)\n\n翻译提供： @[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2017] 经验", "background": "", "description": "X 公司有 $n$ 个员工。这个公司的员工之间的关系构成了一个树形结构。CEO 位于结构的顶端（树的根），他有一些下属（树根的子结点），下属又有下属……最后是一些底层员工（叶结点），没有下属。\n\n这些员工被从 $1$ 到 $n$ 标号，且 CEO 的标号为 1。每个员工有一个 **经验值**，第 $i$ 个员工的经验值为 $W_i$ 。\n\n这个公司有一个大工程需要完成，所以公司的管理者想要将这个树形结构分裂重组为更小的团队。分裂的方式应遵循以下的规则：\n\n- 任何一个团队至少由一个人组成，每个员工必须属于恰好一个团队。\n- 对于任何一个团队，假设团队的成员 **按原来的层次等级由低到高排序之后**  为 $\\{j_1,j_2,j_3,...,j_k\\}$ ，那么须满足：对于$\\forall i \\in [1,k-1]$ 满足 $j_i$ 为 $j_{i+1}$ 的上司。\n\n定义一个团队的总经验值为这个团队的所有成员的经验值的极差，换句话说，就是这个团队里所有成员经验值的最大值减去最小值。整个公司得到的总经验值就是所有团队的经验值之和。\n\n你的任务是求出整个公司可以得到的经验值的最大值。", "inputFormat": "第一行，一个整数 $n$；\n\n第二行，$n$ 个整数：$W_1,W_2,...,W_n$。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$ ，表示 $v$ 是 $u$ 的下属。", "outputFormat": "一个整数表示答案。", "hint": "#### 样例 1 解释\n\n![GBNNDJ.png](https://s1.ax1x.com/2020/04/05/GBNNDJ.png)\n\n一种方案是 $\\{1,5,3\\},\\{6,2,4\\},\\{7\\}$。\n\n或者是 $\\{1, 5\\}, \\{3\\}, \\{6, 2, 4\\}, \\{7\\}$。\n\n#### 数据规模与约定\n\n- 对于大约 $20\\%$ 的数据，保证：$n\\le 20$。\n- 对于大约 $50\\%$ 的数据，保证：$n\\le 5\\times 10^3$。\n- 对于另外大约 $10\\%$ 的数据，保证：每个员工至多有一个下属。\n- 对于所有数据，保证：$1\\le n\\le 10^5,0\\le W_i\\le 10^9$。\n\n#### 说明\n\n原题来自：[eJOI2017](www.ejoi.org) Problem E [Experience](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_2/EN/experience_statement-en.pdf)\n\n翻译提供： @[```_Wallace_```](https://www.luogu.com.cn/user/61430)", "locale": "zh-CN"}}}
{"pid": "P6294", "type": "P", "difficulty": 5, "samples": [["5 2\n2 4 2 3 5\n4 3", "2\n6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "eJOI（欧洲）"], "title": "[eJOI 2017] 游戏", "background": "", "description": "Alice 和 Bob ~~又双叒叕~~ 在玩游戏。\n\n他们有一个由 $n$ 个 $\\le n$ 的正整数组成的序列。序列中的元素被从 $1$ 到 $n$ 标号。序列中可能存在相同的数字。游戏开始时有一个可重集 $S$ ，包含了序列的前 $p$ 个元素。两人现在开始了游戏，Alice 先手。每一步游戏：\n\n1. 玩家选择一个 $S$ 中的数并将其从 $S$ 中取出，然后将自己的分数加上这个取出的数的值（一开始两人的分数都为零）。\n2. 序列中的下一个数字（如果还有剩余）将会被添加到集合 $S$ 中（如果序列已经为空，则跳过此操作）。也就是说，从 $S$ 中取出第一个后，将序列的第 $p+1$ 个数字添加到集合中，在第二个之后，将序列的第 $p+2$ 个数字添加到集合中，以此类推。\n\n游戏进行直到 $S$ 为空为止。我们假设两个玩家都非常聪明（即总是使自己利益最大化）。游戏的结果为 Alice 的分数减去 Bob 的分数。\n\n现在，你的任务是写一个程序，计算 $k$ 个（给定序列相同的）游戏的结果。", "inputFormat": "第一行，两个正整数 $n,k$。\n\n第二行，$n$ 个正整数 $a_1,a_2,...,a_n$，描述游戏开始的序列。\n\n第三行，$k$ 个正整数 $p_1,p_2,...,p_k$，$p_i$ 表示第 $i$ 次游戏，有 $p=p_i$ 。", "outputFormat": "输出包含 $k$ 个正整数，一行一个。\n\n第 $i$ 个正整数表示第 $i$ 次游戏的结果。", "hint": "#### 样例 1 解释\n\n输入确定了你需要处理 $2$ 个游戏。这两个游戏中的序列是相同的，至是开始时的可重集 $S$ 不同。第一个游戏为 $\\{2, 4, 2, 3\\}$ ，第二个为 $\\{2,4,2\\}$ 。\n\n#### 数据规模与约定\n\n- 对于前 $10\\%$ 的数据，保证 $1\\le n\\le 10$。\n- 对于前 $30\\%$ 的数据，保证 $1\\le n\\le 600$。\n- 对于前 $50\\%$ 的数据，保证 $1\\le n\\le 10^4,1\\le k\\le 10^3$。\n- 对于所有数据，保证 $1\\le n\\le 10^5,1\\le k\\le 2\\times 10^3,k\\le n,a_i\\in[1,n],p_i\\in[1,n]$。\n\n#### 说明\n\n原题来自： [eJOI2017](www.ejoi.org) Problem F. [Game](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_2/EN/game_statement-en.pdf)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2017] 游戏", "background": "", "description": "Alice 和 Bob ~~又双叒叕~~ 在玩游戏。\n\n他们有一个由 $n$ 个 $\\le n$ 的正整数组成的序列。序列中的元素被从 $1$ 到 $n$ 标号。序列中可能存在相同的数字。游戏开始时有一个可重集 $S$ ，包含了序列的前 $p$ 个元素。两人现在开始了游戏，Alice 先手。每一步游戏：\n\n1. 玩家选择一个 $S$ 中的数并将其从 $S$ 中取出，然后将自己的分数加上这个取出的数的值（一开始两人的分数都为零）。\n2. 序列中的下一个数字（如果还有剩余）将会被添加到集合 $S$ 中（如果序列已经为空，则跳过此操作）。也就是说，从 $S$ 中取出第一个后，将序列的第 $p+1$ 个数字添加到集合中，在第二个之后，将序列的第 $p+2$ 个数字添加到集合中，以此类推。\n\n游戏进行直到 $S$ 为空为止。我们假设两个玩家都非常聪明（即总是使自己利益最大化）。游戏的结果为 Alice 的分数减去 Bob 的分数。\n\n现在，你的任务是写一个程序，计算 $k$ 个（给定序列相同的）游戏的结果。", "inputFormat": "第一行，两个正整数 $n,k$。\n\n第二行，$n$ 个正整数 $a_1,a_2,...,a_n$，描述游戏开始的序列。\n\n第三行，$k$ 个正整数 $p_1,p_2,...,p_k$，$p_i$ 表示第 $i$ 次游戏，有 $p=p_i$ 。", "outputFormat": "输出包含 $k$ 个正整数，一行一个。\n\n第 $i$ 个正整数表示第 $i$ 次游戏的结果。", "hint": "#### 样例 1 解释\n\n输入确定了你需要处理 $2$ 个游戏。这两个游戏中的序列是相同的，至是开始时的可重集 $S$ 不同。第一个游戏为 $\\{2, 4, 2, 3\\}$ ，第二个为 $\\{2,4,2\\}$ 。\n\n#### 数据规模与约定\n\n- 对于前 $10\\%$ 的数据，保证 $1\\le n\\le 10$。\n- 对于前 $30\\%$ 的数据，保证 $1\\le n\\le 600$。\n- 对于前 $50\\%$ 的数据，保证 $1\\le n\\le 10^4,1\\le k\\le 10^3$。\n- 对于所有数据，保证 $1\\le n\\le 10^5,1\\le k\\le 2\\times 10^3,k\\le n,a_i\\in[1,n],p_i\\in[1,n]$。\n\n#### 说明\n\n原题来自： [eJOI2017](www.ejoi.org) Problem F. [Game](http://ejoi.org/wp-content/themes/ejoi/assets/pdfs/tasks_day_2/EN/game_statement-en.pdf)", "locale": "zh-CN"}}}
{"pid": "P6295", "type": "P", "difficulty": 7, "samples": [["5", "1\n2\n18\n446\n26430"]], "limits": {"time": [1000, 1000], "memory": [128000, 128000]}, "tags": ["洛谷原创", "O2优化", "容斥原理"], "title": "有标号 DAG 计数", "background": "", "description": "对 $n$ 个点有标号的有向无环图进行计数，要求：弱连通图（所有的有向边替换为无向边后的图为连通图）。输出答案对 \n $998244353$ 取模的结果。", "inputFormat": "一个整数 $T$。", "outputFormat": "共 $T$ 行，第 $i(1\\le i\\le T)$ 行输出 $n=i$ 时的答案。", "hint": "第一个点 $T = 2000$。\n\n第二个点 $T = 100000$。", "locale": "zh-CN", "translations": {"en": {"title": "Counting Labeled DAGs", "background": "", "description": "Count the number of labeled directed acyclic graphs (DAGs) on $n$ vertices with the requirement that the graph is weakly connected (that is, after replacing all directed edges with undirected edges, the resulting graph is connected). Output the answer modulo $998244353$.", "inputFormat": "An integer $T$.", "outputFormat": "There are $T$ lines. On the $i$-th line $(1\\le i\\le T)$, output the answer when $n=i$.", "hint": "The first test point has $T = 2000$.\n\nThe second test point has $T = 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "有标号 DAG 计数", "background": "", "description": "对 $n$ 个点有标号的有向无环图进行计数，要求：弱连通图（所有的有向边替换为无向边后的图为连通图）。输出答案对 \n $998244353$ 取模的结果。", "inputFormat": "一个整数 $T$。", "outputFormat": "共 $T$ 行，第 $i(1\\le i\\le T)$ 行输出 $n=i$ 时的答案。", "hint": "第一个点 $T = 2000$。\n\n第二个点 $T = 100000$。", "locale": "zh-CN"}}}
{"pid": "P6296", "type": "P", "difficulty": 7, "samples": [["2 2\n9 18", "45"], ["9 233333\n9 1 8 7 5 6 3 4 2", "100006329"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "递推", "生成函数", "快速傅里叶变换 FFT"], "title": "轮换式 加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P5084)\n\n本题与原题的区别，只有模数和数据范围不同。", "description": "小奔发现，对于任意的 $n$ 个字母，他们构成的轮换式，都表示成 $n$ 个基本轮换式的线性和。\n\n一元的基本轮换式：$a$；\n\n二元：$a+b$，$ab$；\n\n三元：$a+b+c$，$ab+ac+bc$，$abc$；\n\n四元：$a+b+c+d$，$ab+ac+ad+bc+bd+cd$，$abc+abd+bcd$，$abcd$；\n\n......\n\n已知 $n$ 个数的各个基本轮换式的值，求它们的 $m$ 次方和，答案对 $899678209$（$899678209 = 429 \\times 2^{21} + 1$）取模。", "inputFormat": "第一行两个正整数 $n,m$，意义如题目描述。  \n接下来一行 $n$ 个正整数，第 $i$ 个为 $a_i$，表示 $n$ 元 $i$ 次基本轮换式的值。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n可以列出方程 $a+b = 9$，$ab = 18$，容易算出 $a^2+b^2 = 45$。\n\n【数据范围】  \n- 对于 $20\\%$ 的数据，$1\\le n \\le 1000$，$1\\le m \\le 10^4$；  \n- 对于 $60\\%$ 的数据，$1\\le n \\le 1000$，$1\\le m \\le 10^9$；  \n- 对于 $100\\%$ 的数据，$1\\le n \\le 3 \\times 10^4$，$1\\le m \\le 10^9$，$1\\le a_i \\le 10^8$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "轮换式 加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P5084)\n\n本题与原题的区别，只有模数和数据范围不同。", "description": "小奔发现，对于任意的 $n$ 个字母，他们构成的轮换式，都表示成 $n$ 个基本轮换式的线性和。\n\n一元的基本轮换式：$a$；\n\n二元：$a+b$，$ab$；\n\n三元：$a+b+c$，$ab+ac+bc$，$abc$；\n\n四元：$a+b+c+d$，$ab+ac+ad+bc+bd+cd$，$abc+abd+bcd$，$abcd$；\n\n......\n\n已知 $n$ 个数的各个基本轮换式的值，求它们的 $m$ 次方和，答案对 $899678209$（$899678209 = 429 \\times 2^{21} + 1$）取模。", "inputFormat": "第一行两个正整数 $n,m$，意义如题目描述。  \n接下来一行 $n$ 个正整数，第 $i$ 个为 $a_i$，表示 $n$ 元 $i$ 次基本轮换式的值。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n可以列出方程 $a+b = 9$，$ab = 18$，容易算出 $a^2+b^2 = 45$。\n\n【数据范围】  \n- 对于 $20\\%$ 的数据，$1\\le n \\le 1000$，$1\\le m \\le 10^4$；  \n- 对于 $60\\%$ 的数据，$1\\le n \\le 1000$，$1\\le m \\le 10^9$；  \n- 对于 $100\\%$ 的数据，$1\\le n \\le 3 \\times 10^4$，$1\\le m \\le 10^9$，$1\\le a_i \\le 10^8$。\n", "locale": "zh-CN"}}}
{"pid": "P6297", "type": "P", "difficulty": 4, "samples": [["7 1\n1 2 4 2 3 3 4\n", "288\n"], ["6 1\n3 1 2 250000002 1 2\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2020", "枚举"], "title": "替换", "background": null, "description": "Daniel13265 有一串由各种漂亮的贝壳组成的项链，但由于各种原因，这个项链不是环形的，而仅仅是用一根普通的丝线串起来的。项链上的每个贝壳都有一个好看程度 $a_i$，相同种类的贝壳有着相同的好看程度，而不同种类的贝壳有着不同的好看程度。\n\nDaniel13265 定义， 第 $l$ 个至第 $r$ 个这一段贝壳是对称的，当且仅当\n\n$$\\sum_{i=l}^r\\left(a_i-a_{l+r-i}\\right)^2=0$$\n\nDaniel13265 经常从中取出一段贝壳。如果这一段贝壳是对称的，他就会非常高兴；如果这一段贝壳不是对称的，那么他会将其中的某些贝壳替换成新的，以使得这一段贝壳成为对称的。一次替换可以任意地改变任何一个位置上贝壳的好看程度，但是过多的替换会使这一段贝壳脱离原本的模样，所以 Daniel13265 至多会进行 $k$ 次替换。如果一段贝壳在进行至多 $k$ 次替换后能够成为对称的，那么 Daniel13265 就称这一段贝壳是「可观赏的」。\n\nDaniel13265 简单地将第 $l$ 个至第 $r$ 个这一「可观赏的」的贝壳段的「观赏指数」定义为\n\n$$\\prod_{i=l}^ra_i$$\n\n其中 $a_i$ 表示第 $i$ 个贝壳**原本的好看程度**。\n\n他现在很好奇，在这个贝壳组成的项链中，「可观赏的」贝壳段中「观赏指数」的最大值。但是由于这个值可能很大，所以你只需要求出它对 $10^9+7$ 取模后的结果即可。", "inputFormat": "输入共 $2$ 行。\n\n第一行两个正整数 $n,k$，表示这个贝壳组成的项链中贝壳的数目与 Daniel13265 对一段贝壳最多进行替换的次数。  \n第二行 $n$ 个用单个空格隔开的正整数，第 $i$ 个数 $a_i$​ 表示项链上第 $i$ 个贝壳的好看程度。", "outputFormat": "输出一行一个非负整数，表示「可观赏的」贝壳段中「观赏指数」的最大值对 $10^9+7$ 取模后的结果。", "hint": "### 样例解释 #1\n\n「可观赏的」贝壳段有 $[1],[2],[3],[4],[1,2],[2,3],[2,4],[3,3],[3,4],[4,2],[1,2,4],[2,3,3],[2,4,2],[3,3,4],[4,2,3],[2,3,3,4],[4,2,3,3,4]$，其中「观赏指数」最大的贝壳段为 $[4,2,3,3,4]$。\n\n### 样例解释 #2\n\n「可观赏的」的贝壳段中「观赏指数」最大的为 $[2,250000002,1,2]$，其值为 $10^9+8$，对 $10^9+7$ 取模后结果为 $1$。\n\n### 数据范围\n\n**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**\n\n| 子任务编号 | $n\\le$ | $k\\le$ | 分值 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10$ | $10$ |\n| $2$ | $100$ | $100$ | $20$ |\n| $3$ | $1000$ | $0$ | $20$ |\n| $4$ | $1000$ | $1000$ | $50$ |\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le1000$，$0\\le k\\le n$，$1\\le a_i<10^9+7$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "替换", "background": null, "description": "Daniel13265 有一串由各种漂亮的贝壳组成的项链，但由于各种原因，这个项链不是环形的，而仅仅是用一根普通的丝线串起来的。项链上的每个贝壳都有一个好看程度 $a_i$，相同种类的贝壳有着相同的好看程度，而不同种类的贝壳有着不同的好看程度。\n\nDaniel13265 定义， 第 $l$ 个至第 $r$ 个这一段贝壳是对称的，当且仅当\n\n$$\\sum_{i=l}^r\\left(a_i-a_{l+r-i}\\right)^2=0$$\n\nDaniel13265 经常从中取出一段贝壳。如果这一段贝壳是对称的，他就会非常高兴；如果这一段贝壳不是对称的，那么他会将其中的某些贝壳替换成新的，以使得这一段贝壳成为对称的。一次替换可以任意地改变任何一个位置上贝壳的好看程度，但是过多的替换会使这一段贝壳脱离原本的模样，所以 Daniel13265 至多会进行 $k$ 次替换。如果一段贝壳在进行至多 $k$ 次替换后能够成为对称的，那么 Daniel13265 就称这一段贝壳是「可观赏的」。\n\nDaniel13265 简单地将第 $l$ 个至第 $r$ 个这一「可观赏的」的贝壳段的「观赏指数」定义为\n\n$$\\prod_{i=l}^ra_i$$\n\n其中 $a_i$ 表示第 $i$ 个贝壳**原本的好看程度**。\n\n他现在很好奇，在这个贝壳组成的项链中，「可观赏的」贝壳段中「观赏指数」的最大值。但是由于这个值可能很大，所以你只需要求出它对 $10^9+7$ 取模后的结果即可。", "inputFormat": "输入共 $2$ 行。\n\n第一行两个正整数 $n,k$，表示这个贝壳组成的项链中贝壳的数目与 Daniel13265 对一段贝壳最多进行替换的次数。  \n第二行 $n$ 个用单个空格隔开的正整数，第 $i$ 个数 $a_i$​ 表示项链上第 $i$ 个贝壳的好看程度。", "outputFormat": "输出一行一个非负整数，表示「可观赏的」贝壳段中「观赏指数」的最大值对 $10^9+7$ 取模后的结果。", "hint": "### 样例解释 #1\n\n「可观赏的」贝壳段有 $[1],[2],[3],[4],[1,2],[2,3],[2,4],[3,3],[3,4],[4,2],[1,2,4],[2,3,3],[2,4,2],[3,3,4],[4,2,3],[2,3,3,4],[4,2,3,3,4]$，其中「观赏指数」最大的贝壳段为 $[4,2,3,3,4]$。\n\n### 样例解释 #2\n\n「可观赏的」的贝壳段中「观赏指数」最大的为 $[2,250000002,1,2]$，其值为 $10^9+8$，对 $10^9+7$ 取模后结果为 $1$。\n\n### 数据范围\n\n**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**\n\n| 子任务编号 | $n\\le$ | $k\\le$ | 分值 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10$ | $10$ |\n| $2$ | $100$ | $100$ | $20$ |\n| $3$ | $1000$ | $0$ | $20$ |\n| $4$ | $1000$ | $1000$ | $50$ |\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le1000$，$0\\le k\\le n$，$1\\le a_i<10^9+7$。", "locale": "zh-CN"}}}
{"pid": "P6298", "type": "P", "difficulty": 4, "samples": [["5 6 2\n1 2 3 4 6\n", "6 3 1 0 0 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2020", "容斥原理"], "title": "齿轮", "background": "", "description": "Daniel13265 从不知哪里找来了 $n$ 个齿轮，第 $i$ 个齿轮的齿数为不超过 $m$ 的正整数 $a_i$。他现在想把其中 $k$ 个齿轮按照一定的方式拼接在一起。\n\n当齿轮使用一段时间后，就会产生损耗。一个齿轮组的损耗速率是由这个齿轮组的所有齿轮齿数的最大公约数决定的：最大公约数越大，相同的齿之间啮合的频率就会增高，从而损耗的速率就会变快。这个最大公约数又被称为损耗因子。\n\n算出一个齿轮组的损耗因子是很容易的。可是现在 Daniel13265 想要知道，对于可能拼接出的所有齿轮组的损耗因子。\n\nDaniel13265 知道拼接出损耗因子大于 $m$ 的齿轮组是不可能的，而且由于可能拼出的齿轮组的个数很多，你只需要反过来告诉他对于所有的 $t\\in[1, m]$，能够拼接出的损耗因子为 $t$ 的齿轮组的个数对 $10^9+7$ 取模后的结果即可。", "inputFormat": "输入共 $2$ 行。\n  \n第一行包含三个正整数 $n,m,k$，分别表示 Daniel13265 拥有的齿轮个数，齿轮齿数的最大可能值与 Daniel13265 期望的齿轮组的齿轮个数。  \n第二行共 $n$ 个用单个空格隔开的正整数，第 $i$ 个数 $a_i$ 表示第 $i$ 个齿轮的齿数。", "outputFormat": "输出一行 $m$ 个整数，第 $t$ 个数表示能够拼接出的损耗因子为 $t$ 的齿轮组的个数对 $10^9+7$ 取模后的结果。", "hint": "### 样例解释\n\n损耗因子为 $1$ 的齿轮组有 $(1,2),(1,3),(1,4),(1,6),(2,3),(3,4)$ 共 $6$ 个；  \n损耗因子为 $2$ 的齿轮组有 $(2,4),(2,6),(4,6)$ 共 $3$ 个；  \n损耗因子为 $3$ 的齿轮组有 $(3,6)$ 共 $1$ 个。\n\n### 数据范围\n\n**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**\n\n| 子任务编号 | $n\\le$ | $m\\le$ | $k\\le$ | 分值 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10^6$ | $10$ | $10$ |\n| $2$ | $10^3$ | $10^3$ | $10^3$ | $20$ |\n| $3$ | $10^6$ | $10^3$ | $2$ | $5$ |\n| $4$ | $10^6$ | $10^6$ | $1$ | $5$ |\n| $5$ | $10^6$ | $10^6$ | $2$ | $20$ |\n| $6$ | $10^6$ | $10^6$ | $10^6$ | $40$ |\n\n对于 $100\\%$ 的数据，满足 $1\\le k\\le n\\le10^6$，$1\\le a_i\\le m\\le10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "齿轮", "background": "", "description": "Daniel13265 从不知哪里找来了 $n$ 个齿轮，第 $i$ 个齿轮的齿数为不超过 $m$ 的正整数 $a_i$。他现在想把其中 $k$ 个齿轮按照一定的方式拼接在一起。\n\n当齿轮使用一段时间后，就会产生损耗。一个齿轮组的损耗速率是由这个齿轮组的所有齿轮齿数的最大公约数决定的：最大公约数越大，相同的齿之间啮合的频率就会增高，从而损耗的速率就会变快。这个最大公约数又被称为损耗因子。\n\n算出一个齿轮组的损耗因子是很容易的。可是现在 Daniel13265 想要知道，对于可能拼接出的所有齿轮组的损耗因子。\n\nDaniel13265 知道拼接出损耗因子大于 $m$ 的齿轮组是不可能的，而且由于可能拼出的齿轮组的个数很多，你只需要反过来告诉他对于所有的 $t\\in[1, m]$，能够拼接出的损耗因子为 $t$ 的齿轮组的个数对 $10^9+7$ 取模后的结果即可。", "inputFormat": "输入共 $2$ 行。\n  \n第一行包含三个正整数 $n,m,k$，分别表示 Daniel13265 拥有的齿轮个数，齿轮齿数的最大可能值与 Daniel13265 期望的齿轮组的齿轮个数。  \n第二行共 $n$ 个用单个空格隔开的正整数，第 $i$ 个数 $a_i$ 表示第 $i$ 个齿轮的齿数。", "outputFormat": "输出一行 $m$ 个整数，第 $t$ 个数表示能够拼接出的损耗因子为 $t$ 的齿轮组的个数对 $10^9+7$ 取模后的结果。", "hint": "### 样例解释\n\n损耗因子为 $1$ 的齿轮组有 $(1,2),(1,3),(1,4),(1,6),(2,3),(3,4)$ 共 $6$ 个；  \n损耗因子为 $2$ 的齿轮组有 $(2,4),(2,6),(4,6)$ 共 $3$ 个；  \n损耗因子为 $3$ 的齿轮组有 $(3,6)$ 共 $1$ 个。\n\n### 数据范围\n\n**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**\n\n| 子任务编号 | $n\\le$ | $m\\le$ | $k\\le$ | 分值 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10^6$ | $10$ | $10$ |\n| $2$ | $10^3$ | $10^3$ | $10^3$ | $20$ |\n| $3$ | $10^6$ | $10^3$ | $2$ | $5$ |\n| $4$ | $10^6$ | $10^6$ | $1$ | $5$ |\n| $5$ | $10^6$ | $10^6$ | $2$ | $20$ |\n| $6$ | $10^6$ | $10^6$ | $10^6$ | $40$ |\n\n对于 $100\\%$ 的数据，满足 $1\\le k\\le n\\le10^6$，$1\\le a_i\\le m\\le10^6$。", "locale": "zh-CN"}}}
{"pid": "P6299", "type": "P", "difficulty": 6, "samples": [["1 9 2 6\n", "2 1 -3 1 2\n"], ["19674937 18722417 163948077 124500851\n", "146134 -61558 -18260 -10209 221162\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2020", "Special Judge", "扩展欧几里德算法", "构造"], "title": "差别", "background": "", "description": "定义整数 $p,q,r,s$ 与给定的整数 $a,b,c,d$ 的差别度\n\n$$M=\\Big|\\left(a^2+b^2\\right)\\left(p^2+q^2\\right)+\\left(c^2+d^2\\right)\\left(r^2+s^2\\right)+2\\big(ac+bd\\big)\\big(pr-qs\\big)+2\\big(bc-ad\\big)\\big(ps+qr\\big)\\Big|$$\n\n你的任务是求出差别度 $M$ 的非零最小值与取到非零最小值时的一组 $p,q,r,s$。保证差别度 $M$ 的非零最小值存在且小于 $2^{63}$，保证存在一组绝对值都小于 $2^{63}$ 的 $p,q,r,s$ 使得 $M$ 取到非零最小值。", "inputFormat": "输入一行四个整数 $a,b,c,d$，意义如题面所述。", "outputFormat": "输出一行五个整数 $p,q,r,s,M$，表示使差别度 $M$ 取到非零最小值时的一组 $p,q,r,s$ 与此时 $M$ 的值。", "hint": "### 样例解释 #1\n\n显然当 $a=1,b=9,c=2,d=6$ 时，差别度 $M$ 一定为偶数，因此 $M$ 不可能取到小与 $2$ 的非零值。\n\n### 数据范围\n\n| 测试点编号 | 特殊性质 |\n|:-:|:-:|\n| $1$ | $c=d=0$ |\n| $2$ | $a=c=0$ |\n| $3$ | $b=d=0$ |\n| $4$ | $ad=bc$ |\n| $5$ | $\\vert a\\vert,\\vert b\\vert,\\vert c\\vert,\\vert d\\vert\\le10$ |\n| $6\\sim10$ | 无 |\n\n对于 $100\\%$ 的数据，满足 $\\vert a\\vert,\\vert b\\vert,\\vert c\\vert,\\vert d\\vert\\le10^9$。\n\n### 评分方式\n\n**你需要保证每个测试点输出的数的个数为** $5$ **个且** $\\vert p\\vert,\\vert q\\vert,\\vert r\\vert,\\vert s\\vert,\\vert M\\vert<2^{63}$**，以避免出现无法预期的错误。**\n\n对于每个测试点，如果你的 $M$ 与标准输出一致，就能得到 $4$ 分；如果你输出的 $p,q,r,s$ 能使计算结果等于 $M$，就能再获得 $6$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "差别", "background": "", "description": "定义整数 $p,q,r,s$ 与给定的整数 $a,b,c,d$ 的差别度\n\n$$M=\\Big|\\left(a^2+b^2\\right)\\left(p^2+q^2\\right)+\\left(c^2+d^2\\right)\\left(r^2+s^2\\right)+2\\big(ac+bd\\big)\\big(pr-qs\\big)+2\\big(bc-ad\\big)\\big(ps+qr\\big)\\Big|$$\n\n你的任务是求出差别度 $M$ 的非零最小值与取到非零最小值时的一组 $p,q,r,s$。保证差别度 $M$ 的非零最小值存在且小于 $2^{63}$，保证存在一组绝对值都小于 $2^{63}$ 的 $p,q,r,s$ 使得 $M$ 取到非零最小值。", "inputFormat": "输入一行四个整数 $a,b,c,d$，意义如题面所述。", "outputFormat": "输出一行五个整数 $p,q,r,s,M$，表示使差别度 $M$ 取到非零最小值时的一组 $p,q,r,s$ 与此时 $M$ 的值。", "hint": "### 样例解释 #1\n\n显然当 $a=1,b=9,c=2,d=6$ 时，差别度 $M$ 一定为偶数，因此 $M$ 不可能取到小与 $2$ 的非零值。\n\n### 数据范围\n\n| 测试点编号 | 特殊性质 |\n|:-:|:-:|\n| $1$ | $c=d=0$ |\n| $2$ | $a=c=0$ |\n| $3$ | $b=d=0$ |\n| $4$ | $ad=bc$ |\n| $5$ | $\\vert a\\vert,\\vert b\\vert,\\vert c\\vert,\\vert d\\vert\\le10$ |\n| $6\\sim10$ | 无 |\n\n对于 $100\\%$ 的数据，满足 $\\vert a\\vert,\\vert b\\vert,\\vert c\\vert,\\vert d\\vert\\le10^9$。\n\n### 评分方式\n\n**你需要保证每个测试点输出的数的个数为** $5$ **个且** $\\vert p\\vert,\\vert q\\vert,\\vert r\\vert,\\vert s\\vert,\\vert M\\vert<2^{63}$**，以避免出现无法预期的错误。**\n\n对于每个测试点，如果你的 $M$ 与标准输出一致，就能得到 $4$ 分；如果你输出的 $p,q,r,s$ 能使计算结果等于 $M$，就能再获得 $6$ 分。", "locale": "zh-CN"}}}
{"pid": "P6300", "type": "P", "difficulty": 6, "samples": [["7 10\n1 1 2 4 7 8 9\n", "2 9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2020", "O2优化", "枚举", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "悔改", "background": "", "description": "Daniel13265 有一些同样长的小木棍，他把这些木棍随意砍成两段，使得每段的长都不超过 $m$。\n\n现在他想把小木棍拼接成原来的样子，但是却遗失了部分小木棍，而且忘记了自己开始时有多少根木棍和它们的长度。所以他打算把剩下的小木棍拼接出尽可能多的相同长度的木棍。\n\n给出每段小木棍的长度，求出从剩下的木棍中最多能够拼接出的相同长度的木棍的个数与能拼接出来相同长度的木棍个数最多时木棍的最小可能长度。\n", "inputFormat": "输入共 $2$ 行。\n  \n第一行包含两个正整数 $n,m$，分别表示剩余木棍个数与剩余木棍的最大可能长度。  \n第二行共 $n$ 个用单个空格隔开的正整数，第 $i$ 个数 $a_i$ 表示第 $i$ 个木棍的长度。", "outputFormat": "输出一行两个整数，分别表示从剩下的木棍中最多能够拼接出的相同长度的木棍的个数与能拼接出来相同长度的木棍个数最多时木棍的最小可能长度。", "hint": "### 样例解释\n\n如果要拼接出尽量多的长度为 $11$ 的木棍，可以将长度为 $2$ 和 $9$ 的木棍拼接在一起，将长度为 $4$ 和 $7$ 的木棍拼接在一起。然而如果将长度为 $1$ 和 $8$ 的木棍拼接在一起，将长度为 $2$ 和 $7$ 的木棍拼接在一起，可以拼接出 $2$ 根长度为 $9$ 的木棍。  \n\n可以发现能拼接出来相同长度的木棍个数的最大值就是 $2$，此时木棍的长度可能为 $9,10$ 或 $11$，其中最小的为 $9$。\n\n\n### 数据范围\n\n**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**\n\n| 子任务编号 | $n\\le$ | $m\\le$ | 分值 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10^5$ | $5$ |\n| $2$ | $10^3$ | $10^3$ | $10$ |\n| $3$ | $10^3$ | $10^5$ | $10$ |\n| $4$ | $10^5$ | $10$ | $5$ |\n| $5$ | $10^5$ | $10^3$ | $10$ |\n| $6$ | $10^5$ | $10^5$ | $60$ |\n\n对于 $100\\%$ 的数据，满足 $2\\le n,m\\le10^5,1\\le a_i\\le m$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "悔改", "background": "", "description": "Daniel13265 有一些同样长的小木棍，他把这些木棍随意砍成两段，使得每段的长都不超过 $m$。\n\n现在他想把小木棍拼接成原来的样子，但是却遗失了部分小木棍，而且忘记了自己开始时有多少根木棍和它们的长度。所以他打算把剩下的小木棍拼接出尽可能多的相同长度的木棍。\n\n给出每段小木棍的长度，求出从剩下的木棍中最多能够拼接出的相同长度的木棍的个数与能拼接出来相同长度的木棍个数最多时木棍的最小可能长度。\n", "inputFormat": "输入共 $2$ 行。\n  \n第一行包含两个正整数 $n,m$，分别表示剩余木棍个数与剩余木棍的最大可能长度。  \n第二行共 $n$ 个用单个空格隔开的正整数，第 $i$ 个数 $a_i$ 表示第 $i$ 个木棍的长度。", "outputFormat": "输出一行两个整数，分别表示从剩下的木棍中最多能够拼接出的相同长度的木棍的个数与能拼接出来相同长度的木棍个数最多时木棍的最小可能长度。", "hint": "### 样例解释\n\n如果要拼接出尽量多的长度为 $11$ 的木棍，可以将长度为 $2$ 和 $9$ 的木棍拼接在一起，将长度为 $4$ 和 $7$ 的木棍拼接在一起。然而如果将长度为 $1$ 和 $8$ 的木棍拼接在一起，将长度为 $2$ 和 $7$ 的木棍拼接在一起，可以拼接出 $2$ 根长度为 $9$ 的木棍。  \n\n可以发现能拼接出来相同长度的木棍个数的最大值就是 $2$，此时木棍的长度可能为 $9,10$ 或 $11$，其中最小的为 $9$。\n\n\n### 数据范围\n\n**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**\n\n| 子任务编号 | $n\\le$ | $m\\le$ | 分值 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10^5$ | $5$ |\n| $2$ | $10^3$ | $10^3$ | $10$ |\n| $3$ | $10^3$ | $10^5$ | $10$ |\n| $4$ | $10^5$ | $10$ | $5$ |\n| $5$ | $10^5$ | $10^3$ | $10$ |\n| $6$ | $10^5$ | $10^5$ | $60$ |\n\n对于 $100\\%$ 的数据，满足 $2\\le n,m\\le10^5,1\\le a_i\\le m$。", "locale": "zh-CN"}}}
{"pid": "P6301", "type": "P", "difficulty": 5, "samples": [["4 13\n1 0\n1 1\n1 3\n1 3\n3\n7 0\n7 2\n8 3\n4\n2 0\n4\n6 2\n5\n", "8\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["树形数据结构", "2020", "O2优化"], "title": "集合", "background": "", "description": "你需要**在线**维护一个自然数的排序集 $S$ 并支持以下操作：\n\n1. 给一个数 $x$，若 $x$ 不在集合 $S$ 中则将 $x$ 添加到集合 $S$ 中；\n2. 给一个数 $x$，若 $x$ 已在集合 $S$ 中则将 $x$ 从集合 $S$ 中删除。\n\n为了证明你维护了 $S$，你需要在操作过程中回答以下询问：\n\n3. 求集合 $S$ 中最小元素的值，若 $S=\\varnothing$ 则返回 `-1`；\n4. 求集合 $S$ 中最大元素的值，若 $S=\\varnothing$ 则返回 `-1`；\n5. 求集合 $S$ 中元素的数量；\n6. 给一个数 $x$，判断 $x$ 是否在集合内，若在则返回 `1` ，若不在则返回 `0` ；\n7. 给一个数 $x$，求集合 $T=S\\cap[0^-,x)$ 中最大元素的值，若 $T=\\varnothing$ 则返回 `-1`；\n8. 给一个数 $x$，求集合 $T=S\\cap[x,n)$ 中最小元素的值，若 $T=\\varnothing$ 则返回 `-1`。\n\n为了证明你**在线地**维护了 $S$，对于所有在第一次询问后的操作 $1,2$ 与询问 $6,7,8$，实际操作和询问的参数 $x$ 为输入中给出的操作和询问的参数 $x'$ 与上一次询问的返回结果 $\\text{last}$ 之和。即 $x=x'+\\text{last}$。\n\n保证 $0\\le x<n$ 。\n\n初始时 $S=\\varnothing$。", "inputFormat": "输入共 $(m+1)$ 行，其中 $m$ 的意义见下。\n\n第一行两个正整数 $n,m$，其中 $n$ 表示操作与询问的参数 $x$ 的上界，$m$ 表示操作与询问个数的总和。  \n接下来 $m$ 行，每行一个或两个自然数，表示一次操作或者询问。保证每一行为如下八种形式之一：\n1. `1 x'`，表示执行操作 $1$；\n2. `2 x'`，表示执行操作 $2$；\n3. `3`，表示回答询问 $3$；\n4. `4`，表示回答询问 $4$；\n5. `5`，表示回答询问 $5$；\n6. `6 x'`，表示回答询问 $6$；\n7. `7 x'`，表示回答询问 $7$；\n8. `8 x'`，表示回答询问 $8$。", "outputFormat": "为避免输出过多，你只需要输出一行一个整数，表示所有询问的返回结果之和。", "hint": "### 样例解释\n\n实际上执行的操作与回答的询问如下：\n\n```plain\n1 0\n1 1\n1 3\n1 3\n3\t\t->  0\n7 0\t\t-> -1\n7 1\t\t->  0\n8 3\t\t->  3\n4\t\t->  3\n2 3\n4\t\t->  1\n6 3\t\t->  0\n5\t\t->  2\n```\n\n因此输出为 $0+(-1)+0+3+3+1+0+2=8$。\n\n### 数据范围\n\n| 测试点编号 |    $n=$     |    $m=$   | 分值  |\n|:--------------:|:------------:|:-----------:|:-------:|\n|      $1$       | $2^{20}$ | $2^{14}$ |  $5$  |\n|      $2$       | $2^{25}$ | $2^{17}$ |  $5$  |\n|      $3$       | $2^{30}$ | $2^{20}$ | $10$ |\n|      $4$       | $2^{30}$ | $2^{22}$ | $15$ |\n|      $5$       | $2^{30}$ | $2^{22}$ | $15$ |\n|      $6$       | $2^{30}$ | $2^{23}$ | $25$ |\n|      $7$       | $2^{30}$ | $2^{23}$ | $25$ |\n\n对于 $100\\%$ 的数据，满足 $2^{20}\\le n\\le2^{30},2^{14}\\le m\\le 2^{23},0\\le x<n$。\n\n### 提示\n\n**本题输入量较大，建议使用较快的读入方式。**\n\n$0^-$ 表示略小于 $0$ 的一个值，$[0^-,x)$ 可以保证第 $7$ 个操作的 $T$ 恒有意义。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "集合", "background": "", "description": "你需要**在线**维护一个自然数的排序集 $S$ 并支持以下操作：\n\n1. 给一个数 $x$，若 $x$ 不在集合 $S$ 中则将 $x$ 添加到集合 $S$ 中；\n2. 给一个数 $x$，若 $x$ 已在集合 $S$ 中则将 $x$ 从集合 $S$ 中删除。\n\n为了证明你维护了 $S$，你需要在操作过程中回答以下询问：\n\n3. 求集合 $S$ 中最小元素的值，若 $S=\\varnothing$ 则返回 `-1`；\n4. 求集合 $S$ 中最大元素的值，若 $S=\\varnothing$ 则返回 `-1`；\n5. 求集合 $S$ 中元素的数量；\n6. 给一个数 $x$，判断 $x$ 是否在集合内，若在则返回 `1` ，若不在则返回 `0` ；\n7. 给一个数 $x$，求集合 $T=S\\cap[0^-,x)$ 中最大元素的值，若 $T=\\varnothing$ 则返回 `-1`；\n8. 给一个数 $x$，求集合 $T=S\\cap[x,n)$ 中最小元素的值，若 $T=\\varnothing$ 则返回 `-1`。\n\n为了证明你**在线地**维护了 $S$，对于所有在第一次询问后的操作 $1,2$ 与询问 $6,7,8$，实际操作和询问的参数 $x$ 为输入中给出的操作和询问的参数 $x'$ 与上一次询问的返回结果 $\\text{last}$ 之和。即 $x=x'+\\text{last}$。\n\n保证 $0\\le x<n$ 。\n\n初始时 $S=\\varnothing$。", "inputFormat": "输入共 $(m+1)$ 行，其中 $m$ 的意义见下。\n\n第一行两个正整数 $n,m$，其中 $n$ 表示操作与询问的参数 $x$ 的上界，$m$ 表示操作与询问个数的总和。  \n接下来 $m$ 行，每行一个或两个自然数，表示一次操作或者询问。保证每一行为如下八种形式之一：\n1. `1 x'`，表示执行操作 $1$；\n2. `2 x'`，表示执行操作 $2$；\n3. `3`，表示回答询问 $3$；\n4. `4`，表示回答询问 $4$；\n5. `5`，表示回答询问 $5$；\n6. `6 x'`，表示回答询问 $6$；\n7. `7 x'`，表示回答询问 $7$；\n8. `8 x'`，表示回答询问 $8$。", "outputFormat": "为避免输出过多，你只需要输出一行一个整数，表示所有询问的返回结果之和。", "hint": "### 样例解释\n\n实际上执行的操作与回答的询问如下：\n\n```plain\n1 0\n1 1\n1 3\n1 3\n3\t\t->  0\n7 0\t\t-> -1\n7 1\t\t->  0\n8 3\t\t->  3\n4\t\t->  3\n2 3\n4\t\t->  1\n6 3\t\t->  0\n5\t\t->  2\n```\n\n因此输出为 $0+(-1)+0+3+3+1+0+2=8$。\n\n### 数据范围\n\n| 测试点编号 |    $n=$     |    $m=$   | 分值  |\n|:--------------:|:------------:|:-----------:|:-------:|\n|      $1$       | $2^{20}$ | $2^{14}$ |  $5$  |\n|      $2$       | $2^{25}$ | $2^{17}$ |  $5$  |\n|      $3$       | $2^{30}$ | $2^{20}$ | $10$ |\n|      $4$       | $2^{30}$ | $2^{22}$ | $15$ |\n|      $5$       | $2^{30}$ | $2^{22}$ | $15$ |\n|      $6$       | $2^{30}$ | $2^{23}$ | $25$ |\n|      $7$       | $2^{30}$ | $2^{23}$ | $25$ |\n\n对于 $100\\%$ 的数据，满足 $2^{20}\\le n\\le2^{30},2^{14}\\le m\\le 2^{23},0\\le x<n$。\n\n### 提示\n\n**本题输入量较大，建议使用较快的读入方式。**\n\n$0^-$ 表示略小于 $0$ 的一个值，$[0^-,x)$ 可以保证第 $7$ 个操作的 $T$ 恒有意义。", "locale": "zh-CN"}}}
{"pid": "P6302", "type": "P", "difficulty": 6, "samples": [["3 4 1 5 10\n1 2 3 4\n1 2 5 7\n1 2 6 8\n2 3 9 10", "94"], ["4 3 1 2 3\n1 2 2 3\n2 3 5 7\n3 4 7 9", "34"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2019", "NOI", "O2优化", "斜率优化"], "title": "[NOI2019] 回家路线 加强版", "background": "本题是 NOI 2019 回家路线的加强版，除数据范围外均与原题相同。", "description": "猫国的铁路系统中有 $n$ 个站点，从 $1 - n$ 编号。小猫准备从 $1$ 号站点出发，乘坐列车回到猫窝所在的 $n$ 号站点。它查询了能够乘坐的列车，这些列车共 $m$ 班，从 $1 - m$ 编号。小猫将在 $0$ 时刻到达 $1$ 号站点。对于 $i$ 号列车，它将在时刻 $p_i$ 从站点 $x_i$ 出发，在时刻 $q_i$ 直达站点 $y_i$，小猫只能在时刻 $p_i$ 上 $i$ 号列车，也只能在时刻 $q_i$ 下 $i$ 号列车。小猫可以通过多次换乘到达 $n$ 号站点。一次换乘是指对于两班列车，假设分别为 $u$ 号与 $v$ 号列车，若 $y_u = x_v$ 并且 $q_u \\leq p_v$，那么小猫可以乘坐完 $u$ 号列车后在 $y_u$ 号站点等待 $p_v - q_u$ 个时刻，并在时刻 $p_v$ 乘坐 $v$ 号列车。\n\n小猫只想回到猫窝并且减少途中的麻烦，对此它用烦躁值来衡量。\n\n - 小猫在站点等待时将增加烦躁值，对于一次 $t (t \\geq 0)$ 个时刻的等待，烦躁值将增加 $At^2 + Bt + C$，其中 $A, B,C$ 是给定的常数。注意：小猫登上第一班列车前，即从 $0$ 时刻起停留在 $1$ 号站点的那些时刻也算作一次等待。\n\n - 若小猫最终在时刻 $z$ 到达 $n$ 号站点，则烦躁值将再增加 $z$。\n\n形式化地说，若小猫共乘坐了 $k$ 班列车，依次乘坐的列车编号可用序列 $s_1, s_2, \\cdots , s_k$ 表示。该方案被称作一条可行的回家路线，当且仅当它满足下列两个条件：\n\n - $x_{s1} = 1,y_{sk} = n$\n\n - 对于所有 $j (1 \\leq j < k)$，满足 $y_{sj} = x_{s_{j+1}}$ 且 $q_{sj}\\leq p_{s_{j+1}}$ \n\n对于该回家路线，小猫得到的烦躁值将为：\n\n$$q_{s_k}+(A\\times p_{s_1}^2+B\\times p_{s_1}+C)+\\sum_{j=1}^{k-1}(A(p_{s_{j+1}}-q_{s_j})^2+B(p_{s_{j+1}}-q_{s_j})+C)$$\n\n小猫想让自己的烦躁值尽量小，请你帮它求出所有可行的回家路线中，能得到的最小的烦躁值。题目保证至少存在一条可行的回家路线。", "inputFormat": "第一行五个整数 $n, m, A, B,C$，变量意义见题目描述。\n\n接下来 $m$ 行，第 $i$ 行四个整数 $x_i, y_i, p_i, q_i$，分别表示 $i$ 号列车的出发站、到达站、出发时刻与到达时刻。", "outputFormat": "输出仅一行一个整数，表示所求的答案。", "hint": "对于所有的测试点，保证 $2\\le n\\le 10^5$，$1\\le m\\le  10^6$，$0\\le \nA\\le 10$，$0\\le B,C\\le 10^7$，$1\\le x_i,y_i\\le n$，$x_i\\neq y_i$，$0\\le p_i<q_i\\le 4\\times 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2019] 回家路线 加强版", "background": "本题是 NOI 2019 回家路线的加强版，除数据范围外均与原题相同。", "description": "猫国的铁路系统中有 $n$ 个站点，从 $1 - n$ 编号。小猫准备从 $1$ 号站点出发，乘坐列车回到猫窝所在的 $n$ 号站点。它查询了能够乘坐的列车，这些列车共 $m$ 班，从 $1 - m$ 编号。小猫将在 $0$ 时刻到达 $1$ 号站点。对于 $i$ 号列车，它将在时刻 $p_i$ 从站点 $x_i$ 出发，在时刻 $q_i$ 直达站点 $y_i$，小猫只能在时刻 $p_i$ 上 $i$ 号列车，也只能在时刻 $q_i$ 下 $i$ 号列车。小猫可以通过多次换乘到达 $n$ 号站点。一次换乘是指对于两班列车，假设分别为 $u$ 号与 $v$ 号列车，若 $y_u = x_v$ 并且 $q_u \\leq p_v$，那么小猫可以乘坐完 $u$ 号列车后在 $y_u$ 号站点等待 $p_v - q_u$ 个时刻，并在时刻 $p_v$ 乘坐 $v$ 号列车。\n\n小猫只想回到猫窝并且减少途中的麻烦，对此它用烦躁值来衡量。\n\n - 小猫在站点等待时将增加烦躁值，对于一次 $t (t \\geq 0)$ 个时刻的等待，烦躁值将增加 $At^2 + Bt + C$，其中 $A, B,C$ 是给定的常数。注意：小猫登上第一班列车前，即从 $0$ 时刻起停留在 $1$ 号站点的那些时刻也算作一次等待。\n\n - 若小猫最终在时刻 $z$ 到达 $n$ 号站点，则烦躁值将再增加 $z$。\n\n形式化地说，若小猫共乘坐了 $k$ 班列车，依次乘坐的列车编号可用序列 $s_1, s_2, \\cdots , s_k$ 表示。该方案被称作一条可行的回家路线，当且仅当它满足下列两个条件：\n\n - $x_{s1} = 1,y_{sk} = n$\n\n - 对于所有 $j (1 \\leq j < k)$，满足 $y_{sj} = x_{s_{j+1}}$ 且 $q_{sj}\\leq p_{s_{j+1}}$ \n\n对于该回家路线，小猫得到的烦躁值将为：\n\n$$q_{s_k}+(A\\times p_{s_1}^2+B\\times p_{s_1}+C)+\\sum_{j=1}^{k-1}(A(p_{s_{j+1}}-q_{s_j})^2+B(p_{s_{j+1}}-q_{s_j})+C)$$\n\n小猫想让自己的烦躁值尽量小，请你帮它求出所有可行的回家路线中，能得到的最小的烦躁值。题目保证至少存在一条可行的回家路线。", "inputFormat": "第一行五个整数 $n, m, A, B,C$，变量意义见题目描述。\n\n接下来 $m$ 行，第 $i$ 行四个整数 $x_i, y_i, p_i, q_i$，分别表示 $i$ 号列车的出发站、到达站、出发时刻与到达时刻。", "outputFormat": "输出仅一行一个整数，表示所求的答案。", "hint": "对于所有的测试点，保证 $2\\le n\\le 10^5$，$1\\le m\\le  10^6$，$0\\le \nA\\le 10$，$0\\le B,C\\le 10^7$，$1\\le x_i,y_i\\le n$，$x_i\\neq y_i$，$0\\le p_i<q_i\\le 4\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P6303", "type": "P", "difficulty": 6, "samples": [["bab\nbb", "2\n1 0\n1 3"], ["bbbb\naaa", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2018", "Special Judge", "eJOI（欧洲）"], "title": "[eJOI 2018] AB 串", "background": "**题目译自 [eJOI2018](http://ejoi2018.org/) Problem C.** ***AB-Strings***", "description": "你有两个字符串 $s,t$，它们其中仅包含字母 `a` 和 `b`。你可以多次进行如下操作：选出一个 $s$ 的前缀和一个 $t$ 的前缀并交换它们。（注意，这个前缀既**可以为空**也可以为整个串）\n\n你的任务是找出一个操作序列使得进行这些操作后，一个字符串只包含字符 `a`，而另一个只包含字符 `b`。\n\n你应该尽可能的进行最少的操作次数，但非最优解仍可能得到一部分分数，详情见“数据范围与提示”一栏。", "inputFormat": "输入两行为两个字符串 $s,t$。", "outputFormat": "输出第一行为一个整数 $n$（$0\\leq n\\leq 5\\times 10^5$），表示操作总数。\n\n接下来的 $n$ 行，每行包含两个整数 $a_i,b_i$，分别为 $s,t$ 在这次交换中的前缀长度。\n\n如果有多种可能的方案，则可以输出任意一种。", "hint": "#### 样例 $1$ 解释：\n在这个样例中，首先把第一个串 $1$ 个长度的前缀与第二个串 $0$ 个长度的前缀交换，即将 `b` 插入第二个串开头。这时两个串变成了 `ab` 和 `bbb`。接下来把第一个串 $1$ 个长度的前缀与第二个串 $3$ 个长度的前缀交换，即交换 `a` 和 `bbb`，此时两个串变成了 `bbbb` 和 `a` ，达成目标。\n\n#### 样例 $2$ 解释：\n\n已经是最终要求的状态了。\n\n------\n\n#### 计分策略\n\n设 $n$ 为你给出的操作数量，$m$ 为标准答案，**本题使用 SPJ**。\n\n- 如果所有任务中 $n=m$，那么将得到 $100\\%$ 的分数。\n\n- 如果所有任务中 $n\\leq m+2$，那么将得到 $70\\%$ 的分数。（四舍五入到最接近的整数）\n\n- 如果所有任务中 $n\\leq 2m+2$，那么将得到 $50\\%$ 的分数。（四舍五入到最接近的整数）\n\n- 如果所有任务中 $n\\leq 5\\times 10^5$，那么将得到 $30\\%$ 的分数。（四舍五入到最接近的整数）\n\n- 如果至少一个任务中 $n > 5\\times 10^5$，那么将得到 $0\\%$ 的分数。\n\n----\n\n\n\n对于 $100\\%$ 的数据，保证 $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 2\\times 10^5$，$\\lvert s\\rvert,\\lvert t\\rvert$ 分别代表 $s,t$ 的长度，且保证至少有一个串中包含至少一个字符 `a`，至少一个串中包含至少一个字符 `b`。\n\n#### 数据限制\n\n|子任务编号|分数|限制|\n|:-:|:-:|:-:|\n|$1$|$5$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 6$，这两个字符串中共含有一个字符 `a`|\n|$2$|$10$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 6$ |\n|$3$|$20$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 50$ |\n|$4$|$20$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 250$ |\n|$5$|$20$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 2\\times 10^3$ |\n|$6$|$25$|无特殊限制|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2018] AB 串", "background": "**题目译自 [eJOI2018](http://ejoi2018.org/) Problem C.** ***AB-Strings***", "description": "你有两个字符串 $s,t$，它们其中仅包含字母 `a` 和 `b`。你可以多次进行如下操作：选出一个 $s$ 的前缀和一个 $t$ 的前缀并交换它们。（注意，这个前缀既**可以为空**也可以为整个串）\n\n你的任务是找出一个操作序列使得进行这些操作后，一个字符串只包含字符 `a`，而另一个只包含字符 `b`。\n\n你应该尽可能的进行最少的操作次数，但非最优解仍可能得到一部分分数，详情见“数据范围与提示”一栏。", "inputFormat": "输入两行为两个字符串 $s,t$。", "outputFormat": "输出第一行为一个整数 $n$（$0\\leq n\\leq 5\\times 10^5$），表示操作总数。\n\n接下来的 $n$ 行，每行包含两个整数 $a_i,b_i$，分别为 $s,t$ 在这次交换中的前缀长度。\n\n如果有多种可能的方案，则可以输出任意一种。", "hint": "#### 样例 $1$ 解释：\n在这个样例中，首先把第一个串 $1$ 个长度的前缀与第二个串 $0$ 个长度的前缀交换，即将 `b` 插入第二个串开头。这时两个串变成了 `ab` 和 `bbb`。接下来把第一个串 $1$ 个长度的前缀与第二个串 $3$ 个长度的前缀交换，即交换 `a` 和 `bbb`，此时两个串变成了 `bbbb` 和 `a` ，达成目标。\n\n#### 样例 $2$ 解释：\n\n已经是最终要求的状态了。\n\n------\n\n#### 计分策略\n\n设 $n$ 为你给出的操作数量，$m$ 为标准答案，**本题使用 SPJ**。\n\n- 如果所有任务中 $n=m$，那么将得到 $100\\%$ 的分数。\n\n- 如果所有任务中 $n\\leq m+2$，那么将得到 $70\\%$ 的分数。（四舍五入到最接近的整数）\n\n- 如果所有任务中 $n\\leq 2m+2$，那么将得到 $50\\%$ 的分数。（四舍五入到最接近的整数）\n\n- 如果所有任务中 $n\\leq 5\\times 10^5$，那么将得到 $30\\%$ 的分数。（四舍五入到最接近的整数）\n\n- 如果至少一个任务中 $n > 5\\times 10^5$，那么将得到 $0\\%$ 的分数。\n\n----\n\n\n\n对于 $100\\%$ 的数据，保证 $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 2\\times 10^5$，$\\lvert s\\rvert,\\lvert t\\rvert$ 分别代表 $s,t$ 的长度，且保证至少有一个串中包含至少一个字符 `a`，至少一个串中包含至少一个字符 `b`。\n\n#### 数据限制\n\n|子任务编号|分数|限制|\n|:-:|:-:|:-:|\n|$1$|$5$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 6$，这两个字符串中共含有一个字符 `a`|\n|$2$|$10$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 6$ |\n|$3$|$20$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 50$ |\n|$4$|$20$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 250$ |\n|$5$|$20$| $1\\leq \\lvert s\\rvert,\\lvert t\\rvert \\leq 2\\times 10^3$ |\n|$6$|$25$|无特殊限制|", "locale": "zh-CN"}}}
{"pid": "P6304", "type": "P", "difficulty": 4, "samples": [["5\n1 1 1 1 1", "1 2 2"], ["3\n1 2 3", "0 2"], ["5\n1 2 3 2 2", "0 1 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2018", "eJOI（欧洲）"], "title": "[eJOI 2018] 山", "background": "", "description": "Innopolis 城里有 $n$ 座山，第 $i$ 座的高度为 $a_i$。\n\n美观起见，当一座山比它两边的山（如果存在）**严格** 地高时，才能在这座山上建房子。\n\n有一台挖掘机，每小时可以将任意一座山的高度降低 $1$，同一时间挖掘机只能在一座山上工作。山的高度可以被降为 $0$ 或负数。\n\n请求出当 $1\\leq k\\leq \\lceil\\frac{n}{2}\\rceil$ 时，建造 $k$ 座房子（即至少使得 $k$ 座山满足上面的要求）时，挖掘机至少需要工作几小时。", "inputFormat": "第一行，一个整数 $n$。\n\n第二行，$n$ 个整数 $a_{1\\cdots n}$，表示数列 $\\{a_i\\}$。", "outputFormat": "一行，$\\lceil\\frac{n}{2}\\rceil$ 个整数，第 $i$ 个整数表示 $k=i$ 时的答案。", "hint": "【样例一解释】\n\n将山 $2$ 的高度降低 $1$，山的高度变为 $1,0,1,1,1$，此时山 $1$ 满足条件。\n\n再将山 $4$ 的高度降低 $1$，山的高度变为 $1,0,1,0,1$，此时山 $1,3,5$ 满足条件。\n\n---\n\n【数据范围】\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5\\times 10^3$，$1\\leq a_i\\leq 10^5$。\n\n| 子任务编号 | 分数 | 限制 |\n| :----------: | :----------: | :----------: |\n| $1$ | $0$ | 样例 |\n| $2$ | $7$ | $n=3,a_i\\leq 100$ |\n| $3$ | $15$ | $n\\leq 10,a_i\\leq 100$ |\n| $4$ | $13$ | $n\\leq 100,a_i\\leq 100$ |\n| $5$ | $18$ | $n\\leq 100,a_i\\leq 2\\times 10^3$ |\n| $6$ | $22$ | $n\\leq 500$ |\n| $7$ | $25$ | 无特殊限制 |\n\n---\n\n来源：[eJOI2018](http://ejoi2018.org/) Problem A「Hills」\n\n说明：翻译来自 [LOJ](https://loj.ac/problem/2813)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2018] 山", "background": "", "description": "Innopolis 城里有 $n$ 座山，第 $i$ 座的高度为 $a_i$。\n\n美观起见，当一座山比它两边的山（如果存在）**严格** 地高时，才能在这座山上建房子。\n\n有一台挖掘机，每小时可以将任意一座山的高度降低 $1$，同一时间挖掘机只能在一座山上工作。山的高度可以被降为 $0$ 或负数。\n\n请求出当 $1\\leq k\\leq \\lceil\\frac{n}{2}\\rceil$ 时，建造 $k$ 座房子（即至少使得 $k$ 座山满足上面的要求）时，挖掘机至少需要工作几小时。", "inputFormat": "第一行，一个整数 $n$。\n\n第二行，$n$ 个整数 $a_{1\\cdots n}$，表示数列 $\\{a_i\\}$。", "outputFormat": "一行，$\\lceil\\frac{n}{2}\\rceil$ 个整数，第 $i$ 个整数表示 $k=i$ 时的答案。", "hint": "【样例一解释】\n\n将山 $2$ 的高度降低 $1$，山的高度变为 $1,0,1,1,1$，此时山 $1$ 满足条件。\n\n再将山 $4$ 的高度降低 $1$，山的高度变为 $1,0,1,0,1$，此时山 $1,3,5$ 满足条件。\n\n---\n\n【数据范围】\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5\\times 10^3$，$1\\leq a_i\\leq 10^5$。\n\n| 子任务编号 | 分数 | 限制 |\n| :----------: | :----------: | :----------: |\n| $1$ | $0$ | 样例 |\n| $2$ | $7$ | $n=3,a_i\\leq 100$ |\n| $3$ | $15$ | $n\\leq 10,a_i\\leq 100$ |\n| $4$ | $13$ | $n\\leq 100,a_i\\leq 100$ |\n| $5$ | $18$ | $n\\leq 100,a_i\\leq 2\\times 10^3$ |\n| $6$ | $22$ | $n\\leq 500$ |\n| $7$ | $25$ | 无特殊限制 |\n\n---\n\n来源：[eJOI2018](http://ejoi2018.org/) Problem A「Hills」\n\n说明：翻译来自 [LOJ](https://loj.ac/problem/2813)", "locale": "zh-CN"}}}
{"pid": "P6305", "type": "P", "difficulty": 7, "samples": [["5 5\n3 2 3 1 1", "1\n5\n1 4 2 3 5"], ["4 3\n2 1 4 3", "-1"], ["2 0\n2 2", "0"], ["6 9\n6 5 4 3 2 1", "2\n6\n1 6 2 5 3 4\n3\n3 2 1"], ["6 8\n6 5 4 3 2 1", "3\n2\n3 4\n4\n1 6 2 5\n2\n2 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "Special Judge", "eJOI（欧洲）"], "title": "[eJOI 2018] 循环排序", "background": "", "description": "给定一个长为 $n$ 的数列 $\\{a_i\\}$ ，你可以多次进行如下操作：\n\n选定 $k$ 个不同的下标 $i_1,i_2\\cdots,i_k$（其中 $1\\leq i_j\\leq n$），然后将 $a_{i_1}$ 移动到下标 $i_2$ 处，将 $a_{i_2}$ 移动到下标 $i_3$ 处，……，将 $a_{i_{k-1}}$ 移动到下标 $i_k$ 处，将 $a_{i_k}$ 移动到下标 $i_1$ 处。\n\n换言之，你可以按照如下的顺序轮换元素：$i_1\\rightarrow i_2\\rightarrow\\cdots\\rightarrow i_{k}\\rightarrow i_1$。\n\n例如：$n=4,\\{a_i\\}=\\{10,20,30,40\\},i_1=2,i_2=3,i_3=4$ ，则操作完成后的 $a$ 数列变为 $\\{10,40,20,30\\}$。\n\n你的任务是用操作次数最少的方法将整个数列排序成不降的。注意，所有操作中选定下标的个数总和不得超过 $s$ 。如果不存在这样的方法（无解），输出 `-1`。", "inputFormat": "第一行，两个整数，$n$ 和 $s$。\n\n第二行，$n$ 个整数 $a_{1\\cdots n}$，表示数列 $\\{a_i\\}$。", "outputFormat": "如果无解，仅输出 `-1`。\n\n否则，第一行输出一个整数  $q$（可以为 $0$ ，参见样例 3 ），表示最少需要进行的操作次数。\n\n接下来 $2\\times q$ 行描述每次操作。\n\n对于每次操作，先输出一个整数 $k$ 表示此操作选定的下标数量，然后在下一行中输出 $k$ 个整数 $i_{1\\cdots k}$。\n\n在操作次数 $q$ 最少的情况下，你可以输出任意一种可行方案。", "hint": "【样例一解释】\n\n你可以用两次操作 $1\\rightarrow 4\\rightarrow 1$ 和 $2\\rightarrow 3\\rightarrow 5\\rightarrow 2$ 排序数组，但这样会 WA，因为你的任务是最小化 $q$ ，而最优解的 $q=1$。\n\n一种可行的方法是 $1\\rightarrow 4\\rightarrow 2\\rightarrow 3\\rightarrow 5\\rightarrow 1$，即样例输出。\n\n【样例二解释】\n\n所有操作中选定下标的个数总和的最小值为 $4$（一种可行的方法是 $1\\rightarrow 2\\rightarrow 1$ 和 $3\\rightarrow 4\\rightarrow 3$），因此无解。\n\n【样例三解释】\n\n数组已经有序，因此不需要进行操作。\n\n补充说明：样例 4 和 5 满足子任务 6 和 7 的限制。\n\n---\n\n【数据范围】\n\n对于 $100\\%$ 的数据：$1\\leq n\\leq 2\\times 10^5$，$0\\leq s\\leq 2\\times 10^5$，$1\\leq a_i\\leq 10^9$。\n\n| 子任务编号 | 分数 | 限制 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $0$ | 样例 |\n| $2$ | $5$ | $n,s\\leq 2 且 1\\leq a_i\\leq 2$ |\n| $3$ | $5$ | $n\\leq 5$ |\n| $4$ | $5$ | $1\\leq a_i\\leq 2$ |\n| $5$ | $10$ | $a 是个排列，s=2\\times n$ |\n| $6$ | $10$ | $a 是个排列，n\\leq 10^3$ |\n| $7$ | $15$ | $a 是个排列$ |\n| $8$ | $15$ | $s=2\\times n$ |\n| $9$ | $15$ | $n\\leq 10^3$ |\n| $10$ | $20$ | 无特殊限制 |\n\n---\n\n来源：[eJOI2018](http://ejoi2018.org/) Problem F「Cycle Sort」\n\n说明：翻译来自 [LOJ](https://loj.ac/problem/2818)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2018] 循环排序", "background": "", "description": "给定一个长为 $n$ 的数列 $\\{a_i\\}$ ，你可以多次进行如下操作：\n\n选定 $k$ 个不同的下标 $i_1,i_2\\cdots,i_k$（其中 $1\\leq i_j\\leq n$），然后将 $a_{i_1}$ 移动到下标 $i_2$ 处，将 $a_{i_2}$ 移动到下标 $i_3$ 处，……，将 $a_{i_{k-1}}$ 移动到下标 $i_k$ 处，将 $a_{i_k}$ 移动到下标 $i_1$ 处。\n\n换言之，你可以按照如下的顺序轮换元素：$i_1\\rightarrow i_2\\rightarrow\\cdots\\rightarrow i_{k}\\rightarrow i_1$。\n\n例如：$n=4,\\{a_i\\}=\\{10,20,30,40\\},i_1=2,i_2=3,i_3=4$ ，则操作完成后的 $a$ 数列变为 $\\{10,40,20,30\\}$。\n\n你的任务是用操作次数最少的方法将整个数列排序成不降的。注意，所有操作中选定下标的个数总和不得超过 $s$ 。如果不存在这样的方法（无解），输出 `-1`。", "inputFormat": "第一行，两个整数，$n$ 和 $s$。\n\n第二行，$n$ 个整数 $a_{1\\cdots n}$，表示数列 $\\{a_i\\}$。", "outputFormat": "如果无解，仅输出 `-1`。\n\n否则，第一行输出一个整数  $q$（可以为 $0$ ，参见样例 3 ），表示最少需要进行的操作次数。\n\n接下来 $2\\times q$ 行描述每次操作。\n\n对于每次操作，先输出一个整数 $k$ 表示此操作选定的下标数量，然后在下一行中输出 $k$ 个整数 $i_{1\\cdots k}$。\n\n在操作次数 $q$ 最少的情况下，你可以输出任意一种可行方案。", "hint": "【样例一解释】\n\n你可以用两次操作 $1\\rightarrow 4\\rightarrow 1$ 和 $2\\rightarrow 3\\rightarrow 5\\rightarrow 2$ 排序数组，但这样会 WA，因为你的任务是最小化 $q$ ，而最优解的 $q=1$。\n\n一种可行的方法是 $1\\rightarrow 4\\rightarrow 2\\rightarrow 3\\rightarrow 5\\rightarrow 1$，即样例输出。\n\n【样例二解释】\n\n所有操作中选定下标的个数总和的最小值为 $4$（一种可行的方法是 $1\\rightarrow 2\\rightarrow 1$ 和 $3\\rightarrow 4\\rightarrow 3$），因此无解。\n\n【样例三解释】\n\n数组已经有序，因此不需要进行操作。\n\n补充说明：样例 4 和 5 满足子任务 6 和 7 的限制。\n\n---\n\n【数据范围】\n\n对于 $100\\%$ 的数据：$1\\leq n\\leq 2\\times 10^5$，$0\\leq s\\leq 2\\times 10^5$，$1\\leq a_i\\leq 10^9$。\n\n| 子任务编号 | 分数 | 限制 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $0$ | 样例 |\n| $2$ | $5$ | $n,s\\leq 2 且 1\\leq a_i\\leq 2$ |\n| $3$ | $5$ | $n\\leq 5$ |\n| $4$ | $5$ | $1\\leq a_i\\leq 2$ |\n| $5$ | $10$ | $a 是个排列，s=2\\times n$ |\n| $6$ | $10$ | $a 是个排列，n\\leq 10^3$ |\n| $7$ | $15$ | $a 是个排列$ |\n| $8$ | $15$ | $s=2\\times n$ |\n| $9$ | $15$ | $n\\leq 10^3$ |\n| $10$ | $20$ | 无特殊限制 |\n\n---\n\n来源：[eJOI2018](http://ejoi2018.org/) Problem F「Cycle Sort」\n\n说明：翻译来自 [LOJ](https://loj.ac/problem/2818)", "locale": "zh-CN"}}}
{"pid": "P6306", "type": "P", "difficulty": 4, "samples": [["10 3\n1 1 2 2 3 5 3 2 1 3", "5"], ["13 4\n1 1 4 5 1 4 1 4 4 5 5 5 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192]}, "tags": ["2020", "哈希 hashing", "进制"], "title": "「Wdsr-1」小铃的书", "background": "本居小铃在人间之里经营着一家名为“铃奈庵”的书店。店里井井有条地堆放着很多很多书。  \n\n一天，魔理沙来铃奈庵借书，搞得店里十分混乱，魔理沙随身携带的魔导书与铃奈庵的书籍全都混在了一起。", "description": "小铃一共有 $n-1$ 本书，每本书有一个编号 $a_i$，两本书属于同一种类当且仅当两本书的编号相同。  \n\n由于小铃平时将这些书整理得井井有条，因此在小铃的 $n-1$ 本书中，每个种类的书的数量都恰好是 $k$ 的倍数，其中 $k$ 是一给出的常数。\n \n现在，魔理沙的一本编号未知的魔导书与小铃的 $n-1$ 本书混在了一起，而魔理沙只有知道魔导书的编号才能将其找回。  \n\n由于书的数量实在太多，魔理沙找到了你来帮忙，希望聪明的你能帮她求出混入的魔导书的编号。\n\n**注意：魔理沙的魔导书可能与小铃的某本书有着相同的编号。**", "inputFormat": "第一行是两个整数 $n,k$，含义与题目描述一致。\n\n保证 $n\\equiv 1 \\pmod k$ 。\n\n第二行共 $n$ 个整数，表示混在一起的 $n$ 本书的编号 $a_i$ 。", "outputFormat": "共一行一个整数，表示魔理沙的魔导书的编号。", "hint": "#### 样例说明\n\n样例 $1$ 中，小铃的书的编号为 $1,2,3$，分别有 $3$ 本。因此魔导书的编号为 $5$。\n\n样例 $2$ 中，小铃的书的编号为 $1,4,5$，分别有 $4$ 本。因此魔导书的编号为 $1$。\n\n------------------------\n\n#### 数据范围及约定\n\n**本题采取捆绑测试。**\n\n$$\n\\def\\arraystretch{1.5}\n\\def\\cuteran{https://www.luogu.com.cn/paste/iyzwht7l}\n\\begin{array}{|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{分值} \\cr\\hline\n1 & 10^5 & 50 \\cr\\hline\n2 & 10^6 & 25 \\cr\\hline\n3 & 10^7 & 25 \\cr\\hline\n\\end{array}\n$$\n\n对于全部数据，保证 $1 \\le n \\le 10^7$  ，$2 \\le k \\le 10^3$  ，$1 \\le a_i \\le 10^{18}$。保证数据合法，即有且只有一本混入的魔导书。   \n\n-----------------\n\n#### 提示\n\n**请注意时空限制。**\n\n**使用 $\\texttt{cin}$ / $\\texttt{cout}$ 可能超时，这里给出一个快速读入模板：**\n\n```cpp\nlong long qread(){\n    long long w=1,c,ret;\n    while((c=getchar())> '9'||c< '0')\n    w=(c=='-'?-1:1); ret=c-'0';\n    while((c=getchar())>='0'&&c<='9')\n    ret=ret*10+c-'0';\n    return ret*w;\n}\n```\n\n**或者使用这份模板：**\n\n```cpp\ntypedef long long LL;\n#define gc pa==pb&&(pb=(pa=buf)+fread(buf,1,100000,stdin),pa==pb)?EOF:*pa++\nstatic char buf[100000],*pa(buf),*pb(buf);\ninline LL readint() {\n\tLL x=0;char c=gc;\n\twhile(c<'0'||c>'9')c=gc;\n\tfor(;c>='0'&&c<='9';c=gc)x=x*10+(c&15);\n\treturn x;\n}\n```\n\n**其中，在开启 O2 开关的前提下，前者在极限数据下的读入要 $500\\texttt{ms}$，而后者需要 $300\\texttt{ms}$。也就是说，你的程序至少有 $500\\sim 700\\texttt{ms}$ 的时间执行主要算法。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-1」小铃的书", "background": "本居小铃在人间之里经营着一家名为“铃奈庵”的书店。店里井井有条地堆放着很多很多书。  \n\n一天，魔理沙来铃奈庵借书，搞得店里十分混乱，魔理沙随身携带的魔导书与铃奈庵的书籍全都混在了一起。", "description": "小铃一共有 $n-1$ 本书，每本书有一个编号 $a_i$，两本书属于同一种类当且仅当两本书的编号相同。  \n\n由于小铃平时将这些书整理得井井有条，因此在小铃的 $n-1$ 本书中，每个种类的书的数量都恰好是 $k$ 的倍数，其中 $k$ 是一给出的常数。\n \n现在，魔理沙的一本编号未知的魔导书与小铃的 $n-1$ 本书混在了一起，而魔理沙只有知道魔导书的编号才能将其找回。  \n\n由于书的数量实在太多，魔理沙找到了你来帮忙，希望聪明的你能帮她求出混入的魔导书的编号。\n\n**注意：魔理沙的魔导书可能与小铃的某本书有着相同的编号。**", "inputFormat": "第一行是两个整数 $n,k$，含义与题目描述一致。\n\n保证 $n\\equiv 1 \\pmod k$ 。\n\n第二行共 $n$ 个整数，表示混在一起的 $n$ 本书的编号 $a_i$ 。", "outputFormat": "共一行一个整数，表示魔理沙的魔导书的编号。", "hint": "#### 样例说明\n\n样例 $1$ 中，小铃的书的编号为 $1,2,3$，分别有 $3$ 本。因此魔导书的编号为 $5$。\n\n样例 $2$ 中，小铃的书的编号为 $1,4,5$，分别有 $4$ 本。因此魔导书的编号为 $1$。\n\n------------------------\n\n#### 数据范围及约定\n\n**本题采取捆绑测试。**\n\n$$\n\\def\\arraystretch{1.5}\n\\def\\cuteran{https://www.luogu.com.cn/paste/iyzwht7l}\n\\begin{array}{|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{分值} \\cr\\hline\n1 & 10^5 & 50 \\cr\\hline\n2 & 10^6 & 25 \\cr\\hline\n3 & 10^7 & 25 \\cr\\hline\n\\end{array}\n$$\n\n对于全部数据，保证 $1 \\le n \\le 10^7$  ，$2 \\le k \\le 10^3$  ，$1 \\le a_i \\le 10^{18}$。保证数据合法，即有且只有一本混入的魔导书。   \n\n-----------------\n\n#### 提示\n\n**请注意时空限制。**\n\n**使用 $\\texttt{cin}$ / $\\texttt{cout}$ 可能超时，这里给出一个快速读入模板：**\n\n```cpp\nlong long qread(){\n    long long w=1,c,ret;\n    while((c=getchar())> '9'||c< '0')\n    w=(c=='-'?-1:1); ret=c-'0';\n    while((c=getchar())>='0'&&c<='9')\n    ret=ret*10+c-'0';\n    return ret*w;\n}\n```\n\n**或者使用这份模板：**\n\n```cpp\ntypedef long long LL;\n#define gc pa==pb&&(pb=(pa=buf)+fread(buf,1,100000,stdin),pa==pb)?EOF:*pa++\nstatic char buf[100000],*pa(buf),*pb(buf);\ninline LL readint() {\n\tLL x=0;char c=gc;\n\twhile(c<'0'||c>'9')c=gc;\n\tfor(;c>='0'&&c<='9';c=gc)x=x*10+(c&15);\n\treturn x;\n}\n```\n\n**其中，在开启 O2 开关的前提下，前者在极限数据下的读入要 $500\\texttt{ms}$，而后者需要 $300\\texttt{ms}$。也就是说，你的程序至少有 $500\\sim 700\\texttt{ms}$ 的时间执行主要算法。**", "locale": "zh-CN"}}}
{"pid": "P6307", "type": "P", "difficulty": 5, "samples": [["100", "2.0003x10^-2"], ["114", "1.7546x10^-2"], ["223", "8.9689x10^-3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "「Wdsr-1」贤者之石", "background": "帕秋莉·诺蕾姬是一位擅长魔法的魔女，而炼制贤者之石便是她的日常任务。", "description": "帕秋莉摆出了一个边长为 $k-1$（$k$ 个点）的正三角形点阵，每个点上**可以且只能**放一颗元素石。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h84oo82e.png)\n\n在魔界中，正三角形被认为是最美丽而稳定的图形，因此当且仅当放在点阵中的**三颗元素石构成一个正三角形**时，元素石能够被合成为一颗贤者之石。 \n\n帕秋莉规定，假设她在边长为 $k-1$ 的点阵中**随机**选取三个点放置元素石，那么三颗元素石能够合成贤者之石的概率称为 $P_k$ 。（$P_1=0, P_2=1$）  \n\n现在，为了能够难倒智慧的你，帕秋莉想要你求出\n$$\\sum_{k=m}^{+\\infty}P_k$$ \n的值，其中 $m$ 是给定的整数。", "inputFormat": "一行一个整数 $m$。", "outputFormat": "一行一个小数，表示所求的答案。\n\n**你需要保留 $5$ 位有效数字，并且使用科学记数法。**\n\n举例说明：\n\n假设答案为 ``0.0123``，则你需要输出 ``1.2300x10^-2``。\n\n假设答案为 ``1.2345``，则你需要输出 ``1.2345x10^0``。\n", "hint": "#### 数据范围\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|}\\hline\nSubtasks & \\textbf{编号} & m \\\\ \\hline\n1 & [1,15] & \\le 100\\\\\\hline\n2 & [16,35] & \\le 500\\\\\\hline\n3 & [36,40] & \\le 10^3\\\\\\hline\n4 & [41,45] & \\le 10^4\\\\\\hline\n5 & [46,50] & \\le 65535\\\\\\hline\n\\end{array}$$\n\n其中，$[l,r]$ 表示编号为 $l,l+1,\\cdots,r-1,r$ 的测试点。\n\n- 此外，保证 $m\\ge 1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-1」贤者之石", "background": "帕秋莉·诺蕾姬是一位擅长魔法的魔女，而炼制贤者之石便是她的日常任务。", "description": "帕秋莉摆出了一个边长为 $k-1$（$k$ 个点）的正三角形点阵，每个点上**可以且只能**放一颗元素石。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h84oo82e.png)\n\n在魔界中，正三角形被认为是最美丽而稳定的图形，因此当且仅当放在点阵中的**三颗元素石构成一个正三角形**时，元素石能够被合成为一颗贤者之石。 \n\n帕秋莉规定，假设她在边长为 $k-1$ 的点阵中**随机**选取三个点放置元素石，那么三颗元素石能够合成贤者之石的概率称为 $P_k$ 。（$P_1=0, P_2=1$）  \n\n现在，为了能够难倒智慧的你，帕秋莉想要你求出\n$$\\sum_{k=m}^{+\\infty}P_k$$ \n的值，其中 $m$ 是给定的整数。", "inputFormat": "一行一个整数 $m$。", "outputFormat": "一行一个小数，表示所求的答案。\n\n**你需要保留 $5$ 位有效数字，并且使用科学记数法。**\n\n举例说明：\n\n假设答案为 ``0.0123``，则你需要输出 ``1.2300x10^-2``。\n\n假设答案为 ``1.2345``，则你需要输出 ``1.2345x10^0``。\n", "hint": "#### 数据范围\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|}\\hline\nSubtasks & \\textbf{编号} & m \\\\ \\hline\n1 & [1,15] & \\le 100\\\\\\hline\n2 & [16,35] & \\le 500\\\\\\hline\n3 & [36,40] & \\le 10^3\\\\\\hline\n4 & [41,45] & \\le 10^4\\\\\\hline\n5 & [46,50] & \\le 65535\\\\\\hline\n\\end{array}$$\n\n其中，$[l,r]$ 表示编号为 $l,l+1,\\cdots,r-1,r$ 的测试点。\n\n- 此外，保证 $m\\ge 1$。", "locale": "zh-CN"}}}
{"pid": "P6308", "type": "P", "difficulty": 5, "samples": [["10 0 5 233\n", "6942214367\n"], ["1000 9 500 6666\n", "7636746723064426256"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "O2优化", "组合数学", "差分"], "title": "「Wdsr-1」笨蛋结构", "background": "众所周知，琪露诺是笨蛋。", "description": "琪露诺希望维护一个长度为 $n$ 的整数序列 $a$，初始值都为 $0$。\n\n现在琪露诺想要进行 $q$ 次操作，每次选择序列中的一段区间 $[s,s+l-1]$ 并给出两个数字 $w,k$，使对所有的 $i \\in [1,l]$，$a_{s+i-1}$ 加上 $w\\times i^k$ 。  \n\n琪露诺不希望 $k$ 很大，因此她给出了一个整数 $m$，满足 $0\\le k\\le m$。\n\n为了不让头脑简单的琪露诺感到困惑，你只需要输出 依次进行完所有操作后，序列中的每个数字对 $2^{64}$ 取模（即 $\\text{unsigned long long}$ 自然溢出）后的结果即可。\n\n为了帮助你更好的理解题意，这里给出一段伪代码：\n\n$$\\def\\b#1{\\textbf{ #1 }}\\def\\t#1{\\text{ #1 }}\\def\\s{\\quad}\n\\def\\l{\\underline{\\kern{300pt}}\\cr[-10pt]}\n\\def\\r{\\overline{\\underline{\\kern{300pt}}}}\n\\begin{aligned}\n&\\r\\cr&\\b{Algorithm:}\\t{An easy structure}\\cr[-13pt]&\\l\\cr\n&\\begin{aligned}\n    \\t{1.}&\\b{input}n,m,q \\cr\n    \\t{2.}&\\b{for}i=1\\b{to} q \\b{do} \\cr\n    \\t{3.}&\\s\\b{input} s,l,w,k \\cr\n    \\t{4.}&\\s\\b{for} j=1 \\b{to} l \\b{do}\\cr\n    \\t{5.}&\\s\\s a[s+j-1] \\gets a[s+j-1]+w\\times \\t{pow}(j,k) \\cr\n    \\t{6.}&\\s\\b{end}\\cr\n    \\t{7.}&\\b{end}\\cr\n    \\t{8.}&\\b{for} i=1 \\b{to} n \\b{do}\\cr\n    \\t{9.}&\\s\\b{output} a[i]\\cr\n    \\t{10.}&\\b{end}\\cr\n    \\end{aligned}\\cr[-12pt]\n&\\r\\end{aligned}\n%Made by @离散小波变换° .\n%You can find his contributions by searching \"JoesSR\".\n$$\n其中 $\\rm pow(a,b)$ 的含义为 $a^b$。 ", "inputFormat": "请调用下方代码的 `input(n,m,q,S,L,W,K)` 来输入 $n,m,q,s_i,l_i,w_i,k_i$。下标**从一开始**。  \n\n其中 $s,l,w,k$ 的含义与题目描述保持一致。", "outputFormat": "请调用下方代码的 `output(n,R)` 进行输出。其中 $R_i$ 为所有操作结束后的数列，下标**从一开始**。", "hint": "#### 样例一说明\n\n生成的数据为：\n```plain\n10 0 5\n7 1 1558211206 0\n1 3 401324017 0\n4 5 235225636 0\n6 4 2137131141 0\n1 2 3791175968 0\n```\n它的结果是：\n```plain\n4192499985 4192499985 401324017 235225636 235225636 2372356777 3930567983 2372356777 2137131141 0\n```\n\n---\n\n#### 数据生成&数据输出\n\n```cpp\ntypedef unsigned long long u64;\ntypedef unsigned int       u32;\nu32 MT[624],idx;\nvoid _init(u32 seed){\n    MT[0]=seed; idx=0; for(int i=1;i<624;++i) \n    MT[i]=(0x6c078965*(MT[i-1]^((MT[i-1])>>30)+i));\n}\nvoid _gene(){\n    for(int i=0;i<624;++i){\n        int x=MT[i]&0x80000000+(MT[(i+1)%624]&0x7fffffff);\n        MT[i]=MT[(i+397)%624]^(x>>1);\n        if(x&2)MT[i]^=0x9908b0df;\n    }\n}\nu32  _calc(){\n    if(!idx) _gene(); int x=MT[idx];\n    x^=x>>11,x^=(x<<7)&(0x9d2c5680);\n    x^=(x<<15)&0xefc60000,x^=x>>18;\n    idx=(idx+1)%624; return x;\n}\nu64 _get(){u64 ret=_calc()*_calc(); return ret;}\nu64 _get(u64 _l,u64 _r){return _get()%(_r-_l+1ull)+_l;}\nvoid input(int &_n,int &_m,int &_q,int *_S,int *_L,u64 *_W,int *_K){\n    u32 seed; scanf(\"%d%d%d%u\",&_n,&_m,&_q,&seed); _init(seed); int i=1;\n    if(_n>100) for(;i<=_q/4;++i){\n        int _a=_get(1,_n-100),_b=_get(_a+_m,_a+_m+1),_l=_b-_a+1,_k=_get(0,_m);\n        u64 _w=_get(); _S[i]=_a,_L[i]=_l,_W[i]=_w,_K[i]=_k;\n    }\n    if(_n>100) for(;i<=_q/2;++i){\n        int _a=_get(1,100),_b=_get(_n-100,_n),_l=_b-_a+1,_k=_get(0,_m);\n        u64 _w=_get(); _S[i]=_a,_L[i]=_l,_W[i]=_w,_K[i]=_k;\n    }\n    for(;i<=_q;++i){\n        int _a=_get(1,_n),_b=_get(1,_n); if(_a>_b) swap(_a,_b);\n        int _l=_b-_a+1,_k=_get(0,_m); u64 _w=_get();\n        _S[i]=_a,_L[i]=_l,_W[i]=_w,_K[i]=_k;\n    }\n}\nvoid output(int n,u64 *R){\n    u64 ret=n^_get(); for(int i=1;i<=n;i++) ret^=_get()+R[i];\n    printf(\"%llu\\n\",ret);\n}\n```\n其中，调用 `input()` 读入数据；调用 `output()` 输出数据。\n\n**请勿在任何时候调用除了`input`和`output`外的函数，且这两个函数只能调用一次**。\n\n--- \n\n#### 数据范围 \n\n共 $20$ 个测试点，满足如下条件：\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{编号} & n & m & q \\\\ \\hline\n[1,3] & \\le 3\\times 10^3 & =9 & \\le 3\\times 10^3 \\\\\\hline\n[4,5] & \\le 3\\times 10^5 & =0 & \\le 3\\times 10^5 \\\\\\hline\n[6,9] & \\le 3\\times 10^5 & =1 & \\le 3\\times 10^5 \\\\\\hline\n[10,13] & \\le 3\\times 10^5 & =2 & \\le 3\\times 10^5 \\\\\\hline\n[14,16] & \\le 3\\times 10^5 & =9 & \\le 3\\times 10^5 \\\\\\hline\n[17,20] & \\le 5\\times 10^5 & =9 & \\le 1\\times 10^6 \\\\\\hline\n\\end{array}$$\n\n其中，$[l,r]$ 表示编号为 $l,l+1,\\cdots,r-1,r$ 的测试点。\n\n对于 $100\\%$ 的数据，满足 $1\\le l_i \\le l_i+s_i-1 \\le n,0\\le k_i\\le m,0 \\le w\\le 2^{64}-1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-1」笨蛋结构", "background": "众所周知，琪露诺是笨蛋。", "description": "琪露诺希望维护一个长度为 $n$ 的整数序列 $a$，初始值都为 $0$。\n\n现在琪露诺想要进行 $q$ 次操作，每次选择序列中的一段区间 $[s,s+l-1]$ 并给出两个数字 $w,k$，使对所有的 $i \\in [1,l]$，$a_{s+i-1}$ 加上 $w\\times i^k$ 。  \n\n琪露诺不希望 $k$ 很大，因此她给出了一个整数 $m$，满足 $0\\le k\\le m$。\n\n为了不让头脑简单的琪露诺感到困惑，你只需要输出 依次进行完所有操作后，序列中的每个数字对 $2^{64}$ 取模（即 $\\text{unsigned long long}$ 自然溢出）后的结果即可。\n\n为了帮助你更好的理解题意，这里给出一段伪代码：\n\n$$\\def\\b#1{\\textbf{ #1 }}\\def\\t#1{\\text{ #1 }}\\def\\s{\\quad}\n\\def\\l{\\underline{\\kern{300pt}}\\cr[-10pt]}\n\\def\\r{\\overline{\\underline{\\kern{300pt}}}}\n\\begin{aligned}\n&\\r\\cr&\\b{Algorithm:}\\t{An easy structure}\\cr[-13pt]&\\l\\cr\n&\\begin{aligned}\n    \\t{1.}&\\b{input}n,m,q \\cr\n    \\t{2.}&\\b{for}i=1\\b{to} q \\b{do} \\cr\n    \\t{3.}&\\s\\b{input} s,l,w,k \\cr\n    \\t{4.}&\\s\\b{for} j=1 \\b{to} l \\b{do}\\cr\n    \\t{5.}&\\s\\s a[s+j-1] \\gets a[s+j-1]+w\\times \\t{pow}(j,k) \\cr\n    \\t{6.}&\\s\\b{end}\\cr\n    \\t{7.}&\\b{end}\\cr\n    \\t{8.}&\\b{for} i=1 \\b{to} n \\b{do}\\cr\n    \\t{9.}&\\s\\b{output} a[i]\\cr\n    \\t{10.}&\\b{end}\\cr\n    \\end{aligned}\\cr[-12pt]\n&\\r\\end{aligned}\n%Made by @离散小波变换° .\n%You can find his contributions by searching \"JoesSR\".\n$$\n其中 $\\rm pow(a,b)$ 的含义为 $a^b$。 ", "inputFormat": "请调用下方代码的 `input(n,m,q,S,L,W,K)` 来输入 $n,m,q,s_i,l_i,w_i,k_i$。下标**从一开始**。  \n\n其中 $s,l,w,k$ 的含义与题目描述保持一致。", "outputFormat": "请调用下方代码的 `output(n,R)` 进行输出。其中 $R_i$ 为所有操作结束后的数列，下标**从一开始**。", "hint": "#### 样例一说明\n\n生成的数据为：\n```plain\n10 0 5\n7 1 1558211206 0\n1 3 401324017 0\n4 5 235225636 0\n6 4 2137131141 0\n1 2 3791175968 0\n```\n它的结果是：\n```plain\n4192499985 4192499985 401324017 235225636 235225636 2372356777 3930567983 2372356777 2137131141 0\n```\n\n---\n\n#### 数据生成&数据输出\n\n```cpp\ntypedef unsigned long long u64;\ntypedef unsigned int       u32;\nu32 MT[624],idx;\nvoid _init(u32 seed){\n    MT[0]=seed; idx=0; for(int i=1;i<624;++i) \n    MT[i]=(0x6c078965*(MT[i-1]^((MT[i-1])>>30)+i));\n}\nvoid _gene(){\n    for(int i=0;i<624;++i){\n        int x=MT[i]&0x80000000+(MT[(i+1)%624]&0x7fffffff);\n        MT[i]=MT[(i+397)%624]^(x>>1);\n        if(x&2)MT[i]^=0x9908b0df;\n    }\n}\nu32  _calc(){\n    if(!idx) _gene(); int x=MT[idx];\n    x^=x>>11,x^=(x<<7)&(0x9d2c5680);\n    x^=(x<<15)&0xefc60000,x^=x>>18;\n    idx=(idx+1)%624; return x;\n}\nu64 _get(){u64 ret=_calc()*_calc(); return ret;}\nu64 _get(u64 _l,u64 _r){return _get()%(_r-_l+1ull)+_l;}\nvoid input(int &_n,int &_m,int &_q,int *_S,int *_L,u64 *_W,int *_K){\n    u32 seed; scanf(\"%d%d%d%u\",&_n,&_m,&_q,&seed); _init(seed); int i=1;\n    if(_n>100) for(;i<=_q/4;++i){\n        int _a=_get(1,_n-100),_b=_get(_a+_m,_a+_m+1),_l=_b-_a+1,_k=_get(0,_m);\n        u64 _w=_get(); _S[i]=_a,_L[i]=_l,_W[i]=_w,_K[i]=_k;\n    }\n    if(_n>100) for(;i<=_q/2;++i){\n        int _a=_get(1,100),_b=_get(_n-100,_n),_l=_b-_a+1,_k=_get(0,_m);\n        u64 _w=_get(); _S[i]=_a,_L[i]=_l,_W[i]=_w,_K[i]=_k;\n    }\n    for(;i<=_q;++i){\n        int _a=_get(1,_n),_b=_get(1,_n); if(_a>_b) swap(_a,_b);\n        int _l=_b-_a+1,_k=_get(0,_m); u64 _w=_get();\n        _S[i]=_a,_L[i]=_l,_W[i]=_w,_K[i]=_k;\n    }\n}\nvoid output(int n,u64 *R){\n    u64 ret=n^_get(); for(int i=1;i<=n;i++) ret^=_get()+R[i];\n    printf(\"%llu\\n\",ret);\n}\n```\n其中，调用 `input()` 读入数据；调用 `output()` 输出数据。\n\n**请勿在任何时候调用除了`input`和`output`外的函数，且这两个函数只能调用一次**。\n\n--- \n\n#### 数据范围 \n\n共 $20$ 个测试点，满足如下条件：\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{编号} & n & m & q \\\\ \\hline\n[1,3] & \\le 3\\times 10^3 & =9 & \\le 3\\times 10^3 \\\\\\hline\n[4,5] & \\le 3\\times 10^5 & =0 & \\le 3\\times 10^5 \\\\\\hline\n[6,9] & \\le 3\\times 10^5 & =1 & \\le 3\\times 10^5 \\\\\\hline\n[10,13] & \\le 3\\times 10^5 & =2 & \\le 3\\times 10^5 \\\\\\hline\n[14,16] & \\le 3\\times 10^5 & =9 & \\le 3\\times 10^5 \\\\\\hline\n[17,20] & \\le 5\\times 10^5 & =9 & \\le 1\\times 10^6 \\\\\\hline\n\\end{array}$$\n\n其中，$[l,r]$ 表示编号为 $l,l+1,\\cdots,r-1,r$ 的测试点。\n\n对于 $100\\%$ 的数据，满足 $1\\le l_i \\le l_i+s_i-1 \\le n,0\\le k_i\\le m,0 \\le w\\le 2^{64}-1$。", "locale": "zh-CN"}}}
{"pid": "P6309", "type": "P", "difficulty": 5, "samples": [["10 10\n-2 -3 -7 2 -6 7 -3 -5 4 -7 \n0 2 2 0 4 6 2 4 3 3 \n1 4 7\n1 -5 7\n1 -1 8\n2 8 9 2\n2 7 -3 5\n2 7 4 3\n2 2 -1 7\n1 -9 -7\n2 2 3 1\n1 -1 0\n", "9\n82\n9\n0\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树"], "title": "「Wdsr-1」人间之里", "background": "- 这里是幻想乡中最多人类居住的地方。因为有许多妖怪也会光临的店，所以会有各种妖怪到访，不过都是些安份的妖怪，这是一个和平的地方（×1稗田家所在地，毫无疑问也在人类村落。\n\n- 人类必要的生活用品，都能在这里买到。也有一些专门退治妖怪的人住在这，所以这里的生活是较安全的。\n\n- 要说人类村落为什么没有被袭击，那就是妖怪的贤者在背后保护（×2幻想乡的人类灭绝的话，妖怪们也不好过。）。不外出的话，就不会遇上大难。\n\n- 若外出途中遇到比自己强的妖怪（×3高概率的对方比自己强。），就恭恭敬敬地打招呼吧。 还有令人意外的是，有很多店会开到深夜，夜晚会变成妖怪专用店。妖怪多在夜晚活动，店也在那段时间兴旺。可以说妖怪才是很好的客人。\n\n- 特别是卖酒的店，妖怪和人类同乐已成了日常一景。\n\n$$\\tag*{——摘自《东方求闻史纪》}$$", "description": "虽然人间之里可以说是全幻想乡对于人类最安全的地方，但是异变发生时，还是可能会出现意外，所以要建立避难所。\n\n人间之里可以抽象为一条坐标轴，其上有 $n$ 个点上建有房屋。这些房屋的坐标分别为 $x_1,x_2,...,x_n$，且在第 $i$ 座房屋中居住着 $v_i$ 位居民。\n\n每次发生异变时，会有一段**坐标连续**的房屋受到影响，而此时便需要在某一坐标处建立避难所。一个避难所的\"不便程度\"为受影响的房屋中的**每一个居民**与避难所的距离之和。  \n\n（举例来说，假设只有房屋 $i$ 受到了影响，则在 $z$ 处建立避难所的\"不便程度\"为 $v_i*|x_i-z|$ ） \n\n当然，坐落在幻想乡中人间之里的不可能一成不变，所以房屋的位置和居民的数量都可能会发生变化。\n\n具体来说，你需要处理 $m$ 次询问或修改，每一次输入的格式如下：\n\n- `1 l r`，表示询问 当**坐标**位于 $[l,r]$ 范围内的房屋受到异变影响时，在所有建立避难所的方案中，最小的\"不便程度\"是多少。\n\n- `2 a b c`，表示将第 $a$ 座房屋的坐标修改为 $b$，其中居住的村民的数量变为 $c$ 。 \n\n**注意：**\n- 在 $1$ 操作中的\"受到异变影响\"均为假设，所以对之后的查询不产生作用。\n\n- 在 $2$ 操作中发生变化的是第 $a$ 座房屋而不是坐标为 $a$ 的房屋。", "inputFormat": "第一行两个整数，$n,m$。\n\n第二行 $n$ 个整数，$x_i$。\n\n第三行 $n$ 个整数，$v_i$。\n\n接下来 $m$ 行，每行描述一个操作。", "outputFormat": "对于每个 `1 l r` 操作，输出建立避难所的最小\"不便程度\"。", "hint": "**【样例解释】**\n\n对于第一个询问，共有两座房屋受到影响，一处位于 $x=4$ 处，有 $3$ 位村民，一处位于 $x=7$ 处，有 $6$ 位村民。\n\n避难所选在 $x=7$ 处时，\"不便程度\"为：\n\n$$\\left\\vert 7 - 4 \\right\\vert \\times 3 + \\left\\vert 7 - 7 \\right\\vert \\times 6 = 9$$\n\n可以证明 $9$ 是所有建立避难所的方案中\"不便程度\"的最小值。\n\n--------------------\n\n**【数据范围】**\n\n- 对于 $100\\%$ 的数据：\n    \n    $1 \\le n,m \\le 3 \\times 10 ^ 5$。\n\n    $1 \\le a \\le n$，$-10 ^ 9 \\le l \\le r  \\le 10 ^ 9$，$-10 ^ 9 \\le x_i,b \\le 10 ^ 9$，$0 \\le  v_i,c \\le 10 ^ 3$。\n\n- **详细的数据范围：**\n\n    设 $mx$ 为所有输入的整数绝对值的最大值。\n\n    测试点编号 | $n,m \\le$  | $mx \\le$ | 分值\n    :-: | :-: | :-: | :-:\n    $1$ | $100$ | $100$ | $10$\n    $2$ | $8 \\times 10 ^ 3$ | $8 \\times 10 ^ 3$ | $15$\n    $3$ | $8 \\times 10 ^ 3$ | $10 ^ 9$ | $5$\n    $4$ | $10 ^ 5$ | $10 ^ 5$ | $30$\n    $5$ | $10 ^ 5$ | $10 ^ 9$ | $10$\n    $6$ | $3 \\times 10 ^ 5$ | $10 ^ 9$ | $30$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-1」人间之里", "background": "- 这里是幻想乡中最多人类居住的地方。因为有许多妖怪也会光临的店，所以会有各种妖怪到访，不过都是些安份的妖怪，这是一个和平的地方（×1稗田家所在地，毫无疑问也在人类村落。\n\n- 人类必要的生活用品，都能在这里买到。也有一些专门退治妖怪的人住在这，所以这里的生活是较安全的。\n\n- 要说人类村落为什么没有被袭击，那就是妖怪的贤者在背后保护（×2幻想乡的人类灭绝的话，妖怪们也不好过。）。不外出的话，就不会遇上大难。\n\n- 若外出途中遇到比自己强的妖怪（×3高概率的对方比自己强。），就恭恭敬敬地打招呼吧。 还有令人意外的是，有很多店会开到深夜，夜晚会变成妖怪专用店。妖怪多在夜晚活动，店也在那段时间兴旺。可以说妖怪才是很好的客人。\n\n- 特别是卖酒的店，妖怪和人类同乐已成了日常一景。\n\n$$\\tag*{——摘自《东方求闻史纪》}$$", "description": "虽然人间之里可以说是全幻想乡对于人类最安全的地方，但是异变发生时，还是可能会出现意外，所以要建立避难所。\n\n人间之里可以抽象为一条坐标轴，其上有 $n$ 个点上建有房屋。这些房屋的坐标分别为 $x_1,x_2,...,x_n$，且在第 $i$ 座房屋中居住着 $v_i$ 位居民。\n\n每次发生异变时，会有一段**坐标连续**的房屋受到影响，而此时便需要在某一坐标处建立避难所。一个避难所的\"不便程度\"为受影响的房屋中的**每一个居民**与避难所的距离之和。  \n\n（举例来说，假设只有房屋 $i$ 受到了影响，则在 $z$ 处建立避难所的\"不便程度\"为 $v_i*|x_i-z|$ ） \n\n当然，坐落在幻想乡中人间之里的不可能一成不变，所以房屋的位置和居民的数量都可能会发生变化。\n\n具体来说，你需要处理 $m$ 次询问或修改，每一次输入的格式如下：\n\n- `1 l r`，表示询问 当**坐标**位于 $[l,r]$ 范围内的房屋受到异变影响时，在所有建立避难所的方案中，最小的\"不便程度\"是多少。\n\n- `2 a b c`，表示将第 $a$ 座房屋的坐标修改为 $b$，其中居住的村民的数量变为 $c$ 。 \n\n**注意：**\n- 在 $1$ 操作中的\"受到异变影响\"均为假设，所以对之后的查询不产生作用。\n\n- 在 $2$ 操作中发生变化的是第 $a$ 座房屋而不是坐标为 $a$ 的房屋。", "inputFormat": "第一行两个整数，$n,m$。\n\n第二行 $n$ 个整数，$x_i$。\n\n第三行 $n$ 个整数，$v_i$。\n\n接下来 $m$ 行，每行描述一个操作。", "outputFormat": "对于每个 `1 l r` 操作，输出建立避难所的最小\"不便程度\"。", "hint": "**【样例解释】**\n\n对于第一个询问，共有两座房屋受到影响，一处位于 $x=4$ 处，有 $3$ 位村民，一处位于 $x=7$ 处，有 $6$ 位村民。\n\n避难所选在 $x=7$ 处时，\"不便程度\"为：\n\n$$\\left\\vert 7 - 4 \\right\\vert \\times 3 + \\left\\vert 7 - 7 \\right\\vert \\times 6 = 9$$\n\n可以证明 $9$ 是所有建立避难所的方案中\"不便程度\"的最小值。\n\n--------------------\n\n**【数据范围】**\n\n- 对于 $100\\%$ 的数据：\n    \n    $1 \\le n,m \\le 3 \\times 10 ^ 5$。\n\n    $1 \\le a \\le n$，$-10 ^ 9 \\le l \\le r  \\le 10 ^ 9$，$-10 ^ 9 \\le x_i,b \\le 10 ^ 9$，$0 \\le  v_i,c \\le 10 ^ 3$。\n\n- **详细的数据范围：**\n\n    设 $mx$ 为所有输入的整数绝对值的最大值。\n\n    测试点编号 | $n,m \\le$  | $mx \\le$ | 分值\n    :-: | :-: | :-: | :-:\n    $1$ | $100$ | $100$ | $10$\n    $2$ | $8 \\times 10 ^ 3$ | $8 \\times 10 ^ 3$ | $15$\n    $3$ | $8 \\times 10 ^ 3$ | $10 ^ 9$ | $5$\n    $4$ | $10 ^ 5$ | $10 ^ 5$ | $30$\n    $5$ | $10 ^ 5$ | $10 ^ 9$ | $10$\n    $6$ | $3 \\times 10 ^ 5$ | $10 ^ 9$ | $30$", "locale": "zh-CN"}}}
