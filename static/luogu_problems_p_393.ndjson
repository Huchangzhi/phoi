{"pid": "P8971", "type": "P", "difficulty": 4, "samples": [["2\n6 0 4\n1 1 2 2\n1 2 3 4\n1 3 4 2\n0 2 5\n1 4 6 3\n\n6 -1 4\n1 1 2 4\n0 2 3\n0 3 4\n0 2 5\n0 4 6", "5\n6480"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "O2优化", "图遍历"], "title": "『GROI-R1』 虹色的彼岸花", "background": "少年身着春季校服的深灰色外套与黑色短裤，外套内是白净的衬衫。\n\n他的右手不知为何缠着绷带，右眼用头发挡得严严实实，扑面而来的是一种神秘感。\n\n一瓣鲜红的彼岸花，在教室上空无人在意之处打旋。\n\n玘的身世，总是一个谜题吧。\n\n「所以你到底是什么人，又为什么要来这里！」\n\n可是彼岸花显然不想让你知道这些。", "description": "玘给了寒一棵编号为 $1\\sim n$ 的树，这棵树上每个点都有一个点权，同时有些边有边权，有些边没有边权。可是玘把每一个点的点权删除了。寒只知道****点权都是整数，而且在 $l$ 和 $r$ 之间（包含端点）****。而且，点权和边权有着下面的特殊关系：\n\n- 对于****有边权****的边，要求****连接的两个点的点权和为边权****。\n\n- 对于****没有边权的边****，****无限制****。\n\n玘问寒这棵树****有多少种不同的点权填写方式****。两种填写方式不同，当且仅当至少存在一个点的点权不同。可是寒不会做这个题。\n\n寒请你解决这个问题。", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，代表测试数据组数。\n\n对于每一组测试数据：\n\n第一行三个整数 $n,l,r$，代表树上点的个数是 $n$，点权的范围是 $[l,r]$。\n \n接下来 $n-1$ 行，每行先输入一个整数 $op$，$op=0$ 表示这条边没有边权，$op=1$ 表示这条边有边权。\n\n+ 如果 $op=0$，再输入两个整数 $u,v$，表示这条边连接 $u,v$ 两个点。\n\n+ 如果 $op=1$，再输入三个整数 $u,v,w$，表示有一条权值为 $w$ 的边连接 $u,v$ 两个点。", "outputFormat": "对于每个测试点，输出一行一个整数，代表点权填写方式的个数。答案对 $10^9+7$ 取模。", "hint": "**样例解释**\n\n对于样例的第一组测试数据，可以得到下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/91vlqt5k.png)\n\n$5$ 种填写方式分别为：\n\n$\\{0,2,2,0,0,3\\}\\\\\\{0,2,2,0,1,3\\}\\\\\\{0,2,2,0,2,3\\}\\\\\\{0,2,2,0,3,3\\}\\\\\\{0,2,2,0,4,3\\}$\n\n可以证明，不存在别的填写方式。\n\n样例输入中，为了直观，添加了空行。实际数据中不存在多余空行。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{Subtask1}$ | $1\\le n\\le 10$，$0\\le l,r\\le5$ |  | $15$ |\n| $\\text{Subtask2}$ | $1\\le n\\le 2\\times 10^5$，$0\\le l,r\\le5$ |  | $20$ |\n| $\\text{Subtask3}$ | $1\\le n\\le 10$，$-10^9\\le l,r\\le 10^9$ |  | $15$ |\n| $\\text{Subtask4}$ | $1\\le n\\le 2\\times10^5$，$-10^9\\le l,r\\le 10^9$ | 有 | $10$ |\n| $\\text{Subtask5}$ | $1\\le n\\le 2\\times10^5$，$-10^9\\le l,r\\le 10^9$ |  | $40$ |\n\n特殊性质：保证每条边都无边权。\n\n对于 $100\\%$ 的数据，保证 $1\\le T \\le 5$，$1\\le n\\le 2\\times10^5$，$1\\le \\sum n\\le 10^6$，$-10^9\\le l\\le r \\le 10^9$，$-10^9\\le w\\le 10^9$，$op\\in\\{0,1\\}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『GROI-R1』 虹色的彼岸花", "background": "少年身着春季校服的深灰色外套与黑色短裤，外套内是白净的衬衫。\n\n他的右手不知为何缠着绷带，右眼用头发挡得严严实实，扑面而来的是一种神秘感。\n\n一瓣鲜红的彼岸花，在教室上空无人在意之处打旋。\n\n玘的身世，总是一个谜题吧。\n\n「所以你到底是什么人，又为什么要来这里！」\n\n可是彼岸花显然不想让你知道这些。", "description": "玘给了寒一棵编号为 $1\\sim n$ 的树，这棵树上每个点都有一个点权，同时有些边有边权，有些边没有边权。可是玘把每一个点的点权删除了。寒只知道****点权都是整数，而且在 $l$ 和 $r$ 之间（包含端点）****。而且，点权和边权有着下面的特殊关系：\n\n- 对于****有边权****的边，要求****连接的两个点的点权和为边权****。\n\n- 对于****没有边权的边****，****无限制****。\n\n玘问寒这棵树****有多少种不同的点权填写方式****。两种填写方式不同，当且仅当至少存在一个点的点权不同。可是寒不会做这个题。\n\n寒请你解决这个问题。", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，代表测试数据组数。\n\n对于每一组测试数据：\n\n第一行三个整数 $n,l,r$，代表树上点的个数是 $n$，点权的范围是 $[l,r]$。\n \n接下来 $n-1$ 行，每行先输入一个整数 $op$，$op=0$ 表示这条边没有边权，$op=1$ 表示这条边有边权。\n\n+ 如果 $op=0$，再输入两个整数 $u,v$，表示这条边连接 $u,v$ 两个点。\n\n+ 如果 $op=1$，再输入三个整数 $u,v,w$，表示有一条权值为 $w$ 的边连接 $u,v$ 两个点。", "outputFormat": "对于每个测试点，输出一行一个整数，代表点权填写方式的个数。答案对 $10^9+7$ 取模。", "hint": "**样例解释**\n\n对于样例的第一组测试数据，可以得到下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/91vlqt5k.png)\n\n$5$ 种填写方式分别为：\n\n$\\{0,2,2,0,0,3\\}\\\\\\{0,2,2,0,1,3\\}\\\\\\{0,2,2,0,2,3\\}\\\\\\{0,2,2,0,3,3\\}\\\\\\{0,2,2,0,4,3\\}$\n\n可以证明，不存在别的填写方式。\n\n样例输入中，为了直观，添加了空行。实际数据中不存在多余空行。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{Subtask1}$ | $1\\le n\\le 10$，$0\\le l,r\\le5$ |  | $15$ |\n| $\\text{Subtask2}$ | $1\\le n\\le 2\\times 10^5$，$0\\le l,r\\le5$ |  | $20$ |\n| $\\text{Subtask3}$ | $1\\le n\\le 10$，$-10^9\\le l,r\\le 10^9$ |  | $15$ |\n| $\\text{Subtask4}$ | $1\\le n\\le 2\\times10^5$，$-10^9\\le l,r\\le 10^9$ | 有 | $10$ |\n| $\\text{Subtask5}$ | $1\\le n\\le 2\\times10^5$，$-10^9\\le l,r\\le 10^9$ |  | $40$ |\n\n特殊性质：保证每条边都无边权。\n\n对于 $100\\%$ 的数据，保证 $1\\le T \\le 5$，$1\\le n\\le 2\\times10^5$，$1\\le \\sum n\\le 10^6$，$-10^9\\le l\\le r \\le 10^9$，$-10^9\\le w\\le 10^9$，$op\\in\\{0,1\\}$。", "locale": "zh-CN"}}}
{"pid": "P8972", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2 3 4 5\n1 2 0.1\n2 3 0.20\n3 4 0.5\n2 5 0.99\n1 5\n1 4\n4 3", "No\nNo\nYes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "O2优化", "最近公共祖先 LCA"], "title": "『GROI-R1』 一切都已过去", "background": "悦关上窗，拉上帘布。\n\n果然还是想不起来啊。\n\n隐约记得曾和什么人一起做过这样的事。\n\n仰面躺下，手执一只木笺。\n\n「究竟如何，才能拥有“过去”啊……」\n\n她闭上双眼。\n\n「6 岁前的记忆……究竟如何才能寻回？」", "description": "悦正在寻找她的记忆。忽然，她来到了有 $n$ 个节点的一棵树上。树上每一条边都有各自边权，每一个点都有各自的点权。\n\n「把经历都聚拢起来，能完整地复原吗……」\n\n悦从树上的一个点，慢慢地走到了另一个点，可是她什么也没找到。但是，她不知道，玘一直在远处望着她走过的道路。\n\n玘发现，悦全程****没有走回头路****。他想把悦****走过的每一条边的边权乘起来****，可惜他发现他遇到了一个这一生未曾见到过的数字。\n\n「为什么会这样呢？」\n\n玘想到悦是突然出现在树上的，最初的点一定有蹊跷！他****把最初那个点的点权乘上****……\n\n突然，一束彼岸花的红光亮起！世界重新安静了下来。\n\n悦看到了玘留下的字样，可惜她不能从中看出任何过去的记忆。现在，你要帮她判断：把经历都聚拢起来，****能完整地复原过去吗****？我们称悦的一条路径能“复原过去”，当且仅当玘****留下的乘积是一个整数****。\n\n**形式化题面**\n\n给定一棵 $n$ 个节点的树和 $q$ 次询问。每次询问给出两个整数 $x,y$，表示询问树上以 $x$ 和 $y$ 为端点的简单路径上边权乘积与点 $x$ 的点权相乘是否为整数。", "inputFormat": "第一行两个正整数 $n$ 和 $q$，表示树上有 $n$ 个节点编号为 $1\\sim n$，悦在树上走了 $q$ 条路径。\n\n接下来一行 $n$ 个非负整数表示每个点的点权 $a_i$。\n\n接下来 $n-1$ 行每行两个正整数 $u,v$ 和一个非负实数 $w$ 表示 $u,v$ 间有一条边权为 $w$ 的边。\n\n接下来 $q$ 行，每行两个正整数 $x,y$，表示悦从点 $x$ 开始走到了点 $y$。", "outputFormat": "对于悦的每一次询问，你需要输出一行一个字符串。如果悦能够成功复原她的过去，请输出 `Yes`，否则请输出 `No`。", "hint": "**样例解释**\n\n根据输入可以得到下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3e4jqu6f.png)\n\n对于第一个询问 $(1,5)$ 可以发现悦经过的边的边权分别是 $0.1$ 和 $0.99$，她出发的 $1$ 号点的点权为 $1$。$1\\times0.1\\times0.99=0.099$ 不是整数。所以输出 `No`。\n\n对于后面两次询问同理。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $\\text{Subtask1}$ | $n,q\\le3\\times 10^3$ |  | $15$ |\n| $\\text{Subtask2}$ | $n\\le500$，$q\\le10^5$ |  | $10$ |\n| $\\text{Subtask3}$ | $n,q\\le10^5$ | $\\text{BE}$ | $10$ |\n| $\\text{Subtask4}$ | $n,q\\le10^5$ | $\\text{A}$ | $5$ |\n| $\\text{Subtask5}$ | $n,q\\le10^5$ | $\\text{B}$ | $10$ |\n| $\\text{Subtask6}$ | $n,q\\le10^5$ | $\\text{C}$ | $5$ |\n| $\\text{Subtask7}$ | $n,q\\le10^5$ | $\\text{D}$ | $10$ |\n| $\\text{Subtask8}$ | $n,q\\le2×10^5$ |  | $35$ |\n\n特殊性质 $\\text{A}$：保证树退化成一条链。\n\n特殊性质 $\\text{B}$：保证树随机生成（即对于每一个节点随机选择它的父亲节点）。\n\n特殊性质 $\\text{C}$：保证 $w\\in\\{0.1,0.3,0.5,0.7,0.9\\}$。\n\n特殊性质 $\\text{D}$：保证 $w\\in\\{0.1,0.2,0.3,0.4,0.6,0.7,0.8,0.9\\}$。\n\n特殊性质 $\\text{E}$：保证 $w\\le2$ 且 $w$ 小数位数不超过 $1$ 位。\n\n对于 $100\\%$ 的数据满足 $1\\le n,q\\le2\\times10^5$，$0\\le a_i\\le10^9$，$0\\le w\\le10^4$，$1\\le u,v,x,y\\le n$，$x\\ne y$，$w$ 小数位数不超过 $4$ 位。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『GROI-R1』 一切都已过去", "background": "悦关上窗，拉上帘布。\n\n果然还是想不起来啊。\n\n隐约记得曾和什么人一起做过这样的事。\n\n仰面躺下，手执一只木笺。\n\n「究竟如何，才能拥有“过去”啊……」\n\n她闭上双眼。\n\n「6 岁前的记忆……究竟如何才能寻回？」", "description": "悦正在寻找她的记忆。忽然，她来到了有 $n$ 个节点的一棵树上。树上每一条边都有各自边权，每一个点都有各自的点权。\n\n「把经历都聚拢起来，能完整地复原吗……」\n\n悦从树上的一个点，慢慢地走到了另一个点，可是她什么也没找到。但是，她不知道，玘一直在远处望着她走过的道路。\n\n玘发现，悦全程****没有走回头路****。他想把悦****走过的每一条边的边权乘起来****，可惜他发现他遇到了一个这一生未曾见到过的数字。\n\n「为什么会这样呢？」\n\n玘想到悦是突然出现在树上的，最初的点一定有蹊跷！他****把最初那个点的点权乘上****……\n\n突然，一束彼岸花的红光亮起！世界重新安静了下来。\n\n悦看到了玘留下的字样，可惜她不能从中看出任何过去的记忆。现在，你要帮她判断：把经历都聚拢起来，****能完整地复原过去吗****？我们称悦的一条路径能“复原过去”，当且仅当玘****留下的乘积是一个整数****。\n\n**形式化题面**\n\n给定一棵 $n$ 个节点的树和 $q$ 次询问。每次询问给出两个整数 $x,y$，表示询问树上以 $x$ 和 $y$ 为端点的简单路径上边权乘积与点 $x$ 的点权相乘是否为整数。", "inputFormat": "第一行两个正整数 $n$ 和 $q$，表示树上有 $n$ 个节点编号为 $1\\sim n$，悦在树上走了 $q$ 条路径。\n\n接下来一行 $n$ 个非负整数表示每个点的点权 $a_i$。\n\n接下来 $n-1$ 行每行两个正整数 $u,v$ 和一个非负实数 $w$ 表示 $u,v$ 间有一条边权为 $w$ 的边。\n\n接下来 $q$ 行，每行两个正整数 $x,y$，表示悦从点 $x$ 开始走到了点 $y$。", "outputFormat": "对于悦的每一次询问，你需要输出一行一个字符串。如果悦能够成功复原她的过去，请输出 `Yes`，否则请输出 `No`。", "hint": "**样例解释**\n\n根据输入可以得到下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3e4jqu6f.png)\n\n对于第一个询问 $(1,5)$ 可以发现悦经过的边的边权分别是 $0.1$ 和 $0.99$，她出发的 $1$ 号点的点权为 $1$。$1\\times0.1\\times0.99=0.099$ 不是整数。所以输出 `No`。\n\n对于后面两次询问同理。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $\\text{Subtask1}$ | $n,q\\le3\\times 10^3$ |  | $15$ |\n| $\\text{Subtask2}$ | $n\\le500$，$q\\le10^5$ |  | $10$ |\n| $\\text{Subtask3}$ | $n,q\\le10^5$ | $\\text{BE}$ | $10$ |\n| $\\text{Subtask4}$ | $n,q\\le10^5$ | $\\text{A}$ | $5$ |\n| $\\text{Subtask5}$ | $n,q\\le10^5$ | $\\text{B}$ | $10$ |\n| $\\text{Subtask6}$ | $n,q\\le10^5$ | $\\text{C}$ | $5$ |\n| $\\text{Subtask7}$ | $n,q\\le10^5$ | $\\text{D}$ | $10$ |\n| $\\text{Subtask8}$ | $n,q\\le2×10^5$ |  | $35$ |\n\n特殊性质 $\\text{A}$：保证树退化成一条链。\n\n特殊性质 $\\text{B}$：保证树随机生成（即对于每一个节点随机选择它的父亲节点）。\n\n特殊性质 $\\text{C}$：保证 $w\\in\\{0.1,0.3,0.5,0.7,0.9\\}$。\n\n特殊性质 $\\text{D}$：保证 $w\\in\\{0.1,0.2,0.3,0.4,0.6,0.7,0.8,0.9\\}$。\n\n特殊性质 $\\text{E}$：保证 $w\\le2$ 且 $w$ 小数位数不超过 $1$ 位。\n\n对于 $100\\%$ 的数据满足 $1\\le n,q\\le2\\times10^5$，$0\\le a_i\\le10^9$，$0\\le w\\le10^4$，$1\\le u,v,x,y\\le n$，$x\\ne y$，$w$ 小数位数不超过 $4$ 位。", "locale": "zh-CN"}}}
{"pid": "P8973", "type": "P", "difficulty": 5, "samples": [["4\n1 2\n2 3\n2 4", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "图论", "线段树", "点分治", "O2优化", "树形 DP"], "title": "『GROI-R1』 继续深潜，为了同一个梦想", "background": "玘正在折叠床脚几件刚洗净的白衬衫，他注意到身后的声响，向右后转头看去。\n\n以为是“外面的家伙”的他并没有刻意去遮掩自己的右眼——毕竟学院里的人不可能进来。\n\n他看见了那个紫眸的少年；当然寒也看见了那一瞬间的鲜红。\n\n「你什么都没看见。」\n\n玘装作欣赏窗外的晚霞。", "description": "「世上没有无价的情报，」玘露出一丝满意的微笑。\n\n「你懂我的意思吧？」\n\n寒收回手。\n\n玘给出了他留给寒的题。\n\n> 既然紫堇和彼岸花给予了我们异色的瞳孔，我们理所应当是连接在一起的。我称**一棵树上的一个点集是“连接的”**，当且仅当**树上存在一条链能够覆盖这个点集并且这个集合大小不小于 $2$**。我们是独一无二的，可是你知道，一棵树，总是连起来的啊。\n\n「然后呢？」\n\n「现在，你需要告诉我每个点被多少个这样的点集所包含。」\n\n\n玘飘然而去。\n\n湖底之城那封存已久的记忆，被彼岸花和紫堇的力量，揭开了封印的一角。", "inputFormat": "第一行一个正整数 $n$ 表示这棵树有 $n$ 个点编号为 $1\\sim n$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$ 描述一条边。", "outputFormat": "为了防止输出量过大，本题采用以下的输出方式。\n\n设 $ans_i$ 为包含 $i$ 号节点的连接的集合的个数对 $10^9+7$ 取模得到的值，你需要输出 $\\operatorname{xor}_{i=1}^n ans_i\\times i$ 的值。注意这里没有取模运算。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rl9wkbww.png)\n\n**连接**的集合有以下一些：\n- $\\{1,2\\}$\n- $\\{1,3\\}$\n- $\\{1,4\\}$\n- $\\{2,3\\}$\n- $\\{2,4\\}$\n- $\\{3,4\\}$\n- $\\{1,2,3\\}$\n- $\\{1,2,4\\}$\n- $\\{2,3,4\\}$\n\n如 $\\{1,3,4\\}$ 就不是一个连接的集合，因为你找不出一条链使得 $\\{1,3,4\\}$ 为它的子集。\n\n其中 $1,2,3,4$ 号节点分别在 $5,6,5,5$ 个集合中出现。通过计算可得 $\\operatorname{xor}_{i=1}^n ans_i\\times i=18$。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 | 时间限制 |\n| :----------: | :----------: | :----------: | :----------: | :-: |\n| $\\text{Subtask1}$ | $n\\le20$ | | $15$ | $\\text{1s}$ |\n| $\\text{Subtask2}$ | $n\\le100$ | | $15$  | $\\text{1s}$ |\n| $\\text{Subtask3}$ | $n\\le3\\times 10^3$ | | $20$ | $\\text{1s}$ |\n| $\\text{Subtask4}$ | $n\\le5\\times10^5$ | $\\text{A}$ | $15$ | $\\text{2s}$ |\n| $\\text{Subtask5}$ | $n\\le5\\times10^5$ | | $35$ | $\\text{2s}$ |\n\n特殊性质 $\\text{A}$：保证树退化成一条链。\n\n\n对于 $100\\%$ 的数据 $1\\le u,v\\le n\\le5\\times10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『GROI-R1』 继续深潜，为了同一个梦想", "background": "玘正在折叠床脚几件刚洗净的白衬衫，他注意到身后的声响，向右后转头看去。\n\n以为是“外面的家伙”的他并没有刻意去遮掩自己的右眼——毕竟学院里的人不可能进来。\n\n他看见了那个紫眸的少年；当然寒也看见了那一瞬间的鲜红。\n\n「你什么都没看见。」\n\n玘装作欣赏窗外的晚霞。", "description": "「世上没有无价的情报，」玘露出一丝满意的微笑。\n\n「你懂我的意思吧？」\n\n寒收回手。\n\n玘给出了他留给寒的题。\n\n> 既然紫堇和彼岸花给予了我们异色的瞳孔，我们理所应当是连接在一起的。我称**一棵树上的一个点集是“连接的”**，当且仅当**树上存在一条链能够覆盖这个点集并且这个集合大小不小于 $2$**。我们是独一无二的，可是你知道，一棵树，总是连起来的啊。\n\n「然后呢？」\n\n「现在，你需要告诉我每个点被多少个这样的点集所包含。」\n\n\n玘飘然而去。\n\n湖底之城那封存已久的记忆，被彼岸花和紫堇的力量，揭开了封印的一角。", "inputFormat": "第一行一个正整数 $n$ 表示这棵树有 $n$ 个点编号为 $1\\sim n$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$ 描述一条边。", "outputFormat": "为了防止输出量过大，本题采用以下的输出方式。\n\n设 $ans_i$ 为包含 $i$ 号节点的连接的集合的个数对 $10^9+7$ 取模得到的值，你需要输出 $\\operatorname{xor}_{i=1}^n ans_i\\times i$ 的值。注意这里没有取模运算。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rl9wkbww.png)\n\n**连接**的集合有以下一些：\n- $\\{1,2\\}$\n- $\\{1,3\\}$\n- $\\{1,4\\}$\n- $\\{2,3\\}$\n- $\\{2,4\\}$\n- $\\{3,4\\}$\n- $\\{1,2,3\\}$\n- $\\{1,2,4\\}$\n- $\\{2,3,4\\}$\n\n如 $\\{1,3,4\\}$ 就不是一个连接的集合，因为你找不出一条链使得 $\\{1,3,4\\}$ 为它的子集。\n\n其中 $1,2,3,4$ 号节点分别在 $5,6,5,5$ 个集合中出现。通过计算可得 $\\operatorname{xor}_{i=1}^n ans_i\\times i=18$。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 | 时间限制 |\n| :----------: | :----------: | :----------: | :----------: | :-: |\n| $\\text{Subtask1}$ | $n\\le20$ | | $15$ | $\\text{1s}$ |\n| $\\text{Subtask2}$ | $n\\le100$ | | $15$  | $\\text{1s}$ |\n| $\\text{Subtask3}$ | $n\\le3\\times 10^3$ | | $20$ | $\\text{1s}$ |\n| $\\text{Subtask4}$ | $n\\le5\\times10^5$ | $\\text{A}$ | $15$ | $\\text{2s}$ |\n| $\\text{Subtask5}$ | $n\\le5\\times10^5$ | | $35$ | $\\text{2s}$ |\n\n特殊性质 $\\text{A}$：保证树退化成一条链。\n\n\n对于 $100\\%$ 的数据 $1\\le u,v\\le n\\le5\\times10^5$。", "locale": "zh-CN"}}}
{"pid": "P8974", "type": "P", "difficulty": 6, "samples": [["4 2\n1 2\n1 3\n1 4\n2 3\n1 4", "4\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "图论", "O2优化", "最近公共祖先 LCA", "基环树"], "title": "『GROI-R1』 古朴而优雅", "background": "\n会馆内忽地安静了下来。\n\n「敝姓言，名杉。」\n\n他的声音沉稳而凝重，略带沙哑，却不失力度，极具穿透力。每个字都重重地打在耳畔，渗进头脑里，让人想不认真听都难。\n\n「这所学院的院长。」", "description": "杉虽然年事已高，但是还是保持与时俱进。他学习了深度优先遍历算法，觉得这种新潮的东西在一所古朴而优雅的学院里会很受欢迎。所以，他找到了在走廊里晃荡的寒，向他提出了一个问题：\n\n「我们知道，对一棵树进行深度优先遍历可以用下面的伪代码很好地解决。」\n\n$$\n\\begin{array}{l}\n\\text{DFS-TREE}(u)\\\\\n\\begin{array}{ll}\n1 & p\\gets p+1\\\\\n2 & t_p\\gets u\\\\\n3 & vis_u\\gets 1\\\\\n4 & \\textbf{for }\\text{each edge }(u,v)\\in E \\\\\n5 & \\qquad \\textbf{if }vis_v=0\\\\\n6 & \\qquad \\qquad \\text{DFS-TREE}(v)\\\\\n7 & p\\gets p+1\\\\\n8 & t_p\\gets u\\\\\n\\end{array}\n\\end{array}\n$$\n\n起初，所有变量或数组的值均为 $0$。\n\n「我们把调用 $\\text{DFS-TREE}(1)$ 在遍历过程中得到的数组 $t$ 称为这棵树的**遍历顺序**。」\n\n「你看这段代码的第 $4$ 行，这句话**遍历每一条边的顺序是不固定的**。」\n\n寒素来最讨厌不确定的东西，可是碍于院长的颜面，还是继续听下去。\n\n「你能数出这段代码**会生成多少种不同的遍历顺序**吗？」\n\n寒发现他曾经做过这个题，很快地报出了解法。本以为就结束了，可是杉继续说：\n\n「如果我**在树上增加一条边**，你还会做吗？」\n\n寒发现他的那点水平完全不够了，于是他去请教玘。玘却认为这道题目依然很简单，他告诉了寒这道题的做法。可是寒找不到杉了。\n\n这个世界到底怎么了呢？", "inputFormat": "第一行，两个整数 $n$ 和 $q$，表示树上有 $n$ 个结点，编号为 $1\\sim n$，有 $q$ 次询问。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$，描述这棵树上的一条边。\n\n接下来 $q$ 行，每行两个整数 $x,y$，表示在树上添加连接 $x$ 和 $y$ 的一条边，询问有多少种可能的遍历顺序。注意：每次询问是**互相独立的**，也就是说，上一次询问添加的边不会保留到下一次询问。", "outputFormat": "共 $q$ 行，每行一个整数表示这次询问的答案对 $10^9+7$ 取模后得到的值。", "hint": "**样例解释**\n\n对于第一次询问可以得到如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ojeiswc8.png)\n\n能得到的遍历顺序有：\n\n- $\\{1,2,3,3,2,4,4,1\\}$\n- $\\{1,4,4,2,3,3,2,1\\}$\n- $\\{1,3,2,2,3,4,4,1\\}$\n- $\\{1,4,4,3,2,2,3,1\\}$\n\n对于第二次询问可以得到如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6dut5s4r.png)\n\n能得到的遍历顺序有：\n\n- $\\{1,2,2,3,3,4,4,1\\}$\n- $\\{1,2,2,4,4,3,3,1\\}$\n- $\\{1,3,3,2,2,4,4,1\\}$\n- $\\{1,3,3,4,4,2,2,1\\}$\n- $\\{1,4,4,2,2,3,3,1\\}$\n- $\\{1,4,4,3,3,2,2,1\\}$\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 测试点编号 | 数据范围 | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{Subtask1}$ | $n,q\\le8$ |  | $5$ |\n| $\\text{Subtask2}$ | $n,q\\le20$ |  | $10$ |\n| $\\text{Subtask3}$ | $n,q\\le500$ |  | $10$ |\n| $\\text{Subtask4}$ | $n,q\\le3000$ |  | $15$ |\n| $\\text{Subtask5}$ | $n,q\\le2\\times10^5$ | $\\text{A}$ | $15$ |\n| $\\text{Subtask6}$ | $n,q\\le2\\times10^5$ | $\\text{B}$ | $10$ |\n| $\\text{Subtask7}$ | $n,q\\le2\\times10^5$ |  | $35$ |\n\n特殊性质 $\\text{A}$：保证每一次询问的边 $(x,y)\\in E$。\n\n特殊性质 $\\text{B}$：保证树退化成一条链。\n\n对于 $100\\%$ 的数据保证 $1\\le n,q\\le2\\times10^5$，$1\\le u,v,x,y\\le n$，$x\\ne y$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『GROI-R1』 古朴而优雅", "background": "\n会馆内忽地安静了下来。\n\n「敝姓言，名杉。」\n\n他的声音沉稳而凝重，略带沙哑，却不失力度，极具穿透力。每个字都重重地打在耳畔，渗进头脑里，让人想不认真听都难。\n\n「这所学院的院长。」", "description": "杉虽然年事已高，但是还是保持与时俱进。他学习了深度优先遍历算法，觉得这种新潮的东西在一所古朴而优雅的学院里会很受欢迎。所以，他找到了在走廊里晃荡的寒，向他提出了一个问题：\n\n「我们知道，对一棵树进行深度优先遍历可以用下面的伪代码很好地解决。」\n\n$$\n\\begin{array}{l}\n\\text{DFS-TREE}(u)\\\\\n\\begin{array}{ll}\n1 & p\\gets p+1\\\\\n2 & t_p\\gets u\\\\\n3 & vis_u\\gets 1\\\\\n4 & \\textbf{for }\\text{each edge }(u,v)\\in E \\\\\n5 & \\qquad \\textbf{if }vis_v=0\\\\\n6 & \\qquad \\qquad \\text{DFS-TREE}(v)\\\\\n7 & p\\gets p+1\\\\\n8 & t_p\\gets u\\\\\n\\end{array}\n\\end{array}\n$$\n\n起初，所有变量或数组的值均为 $0$。\n\n「我们把调用 $\\text{DFS-TREE}(1)$ 在遍历过程中得到的数组 $t$ 称为这棵树的**遍历顺序**。」\n\n「你看这段代码的第 $4$ 行，这句话**遍历每一条边的顺序是不固定的**。」\n\n寒素来最讨厌不确定的东西，可是碍于院长的颜面，还是继续听下去。\n\n「你能数出这段代码**会生成多少种不同的遍历顺序**吗？」\n\n寒发现他曾经做过这个题，很快地报出了解法。本以为就结束了，可是杉继续说：\n\n「如果我**在树上增加一条边**，你还会做吗？」\n\n寒发现他的那点水平完全不够了，于是他去请教玘。玘却认为这道题目依然很简单，他告诉了寒这道题的做法。可是寒找不到杉了。\n\n这个世界到底怎么了呢？", "inputFormat": "第一行，两个整数 $n$ 和 $q$，表示树上有 $n$ 个结点，编号为 $1\\sim n$，有 $q$ 次询问。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$，描述这棵树上的一条边。\n\n接下来 $q$ 行，每行两个整数 $x,y$，表示在树上添加连接 $x$ 和 $y$ 的一条边，询问有多少种可能的遍历顺序。注意：每次询问是**互相独立的**，也就是说，上一次询问添加的边不会保留到下一次询问。", "outputFormat": "共 $q$ 行，每行一个整数表示这次询问的答案对 $10^9+7$ 取模后得到的值。", "hint": "**样例解释**\n\n对于第一次询问可以得到如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ojeiswc8.png)\n\n能得到的遍历顺序有：\n\n- $\\{1,2,3,3,2,4,4,1\\}$\n- $\\{1,4,4,2,3,3,2,1\\}$\n- $\\{1,3,2,2,3,4,4,1\\}$\n- $\\{1,4,4,3,2,2,3,1\\}$\n\n对于第二次询问可以得到如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6dut5s4r.png)\n\n能得到的遍历顺序有：\n\n- $\\{1,2,2,3,3,4,4,1\\}$\n- $\\{1,2,2,4,4,3,3,1\\}$\n- $\\{1,3,3,2,2,4,4,1\\}$\n- $\\{1,3,3,4,4,2,2,1\\}$\n- $\\{1,4,4,2,2,3,3,1\\}$\n- $\\{1,4,4,3,3,2,2,1\\}$\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 测试点编号 | 数据范围 | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{Subtask1}$ | $n,q\\le8$ |  | $5$ |\n| $\\text{Subtask2}$ | $n,q\\le20$ |  | $10$ |\n| $\\text{Subtask3}$ | $n,q\\le500$ |  | $10$ |\n| $\\text{Subtask4}$ | $n,q\\le3000$ |  | $15$ |\n| $\\text{Subtask5}$ | $n,q\\le2\\times10^5$ | $\\text{A}$ | $15$ |\n| $\\text{Subtask6}$ | $n,q\\le2\\times10^5$ | $\\text{B}$ | $10$ |\n| $\\text{Subtask7}$ | $n,q\\le2\\times10^5$ |  | $35$ |\n\n特殊性质 $\\text{A}$：保证每一次询问的边 $(x,y)\\in E$。\n\n特殊性质 $\\text{B}$：保证树退化成一条链。\n\n对于 $100\\%$ 的数据保证 $1\\le n,q\\le2\\times10^5$，$1\\le u,v,x,y\\le n$，$x\\ne y$。", "locale": "zh-CN"}}}
{"pid": "P8975", "type": "P", "difficulty": 6, "samples": [["6 2 2\n1 2 -2\n1 3 1\n1 4 2\n2 5 -3\n2 6 10\n1 5\n", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "图论", "O2优化", "树形 DP"], "title": "『GROI-R1』 湖底之城", "background": "那年你我仍是无瑕的少年\n\n在夜晚安逸的后院无所顾忌地笑谈人生\n\n——怀念这样毫无猜忌的时光", "description": "悦，玲和荧三个人在湖底之城闲游。湖底之城的道路错综复杂，形成了一棵有 $n$ 个节点的树。\n\n她们三人的手上都有一个计数器，初始都为 $0$。她们每走到一个点的时候，**悦和荧**手上的计数器会自动加上刚刚经过的**这条边的边权**，同时**玲**的计数器会恰好**增加 $1$**。同时，她们整个过程中**没有经过某个点超过一次**。\n\n由于她们的计数器不能存储很大的值，所以，当**玲**的计数器上的值是「湖之数」$p$ 的**倍数**时，**悦可以**将她的计数器上的值减去**荧**的计数器上的值，接下来，**玲和荧**的计数器都会立刻**归零**。\n\n玘现在不知道她们闲游的起点和终点，所以天生计算能力很好的玘对于每一对起点和终点，计算出了悦手上计数器在终点时可能出现的最小值。玘把这个值记作 $f(u,v)$，意思是她们从点 $u$ 走到了点 $v$。可是，玘认为，没有红色彼岸花的寒，一定是算不出来这些答案的。所以，他让寒做一道更简单的题。玘给寒一个长度为 $m$ 的序列 $s$，让寒对于每一个点为 $u$ 时计算 $\\min\\limits_{i=1}^m\\{f(s_i,u)\\}$。\n\n**形式化题面**\n\n给定一个 $n$ 个点的树 $(V,E)$ 和一个正整数 $p$，每一条边有一个整数边权 $w_i$。\n\n我们定义 $f(s,v)$ 表示为对 $u,a,b,c$ 进行若干次**拓展**后可以得到的当 $u=v$ 时的 $a$ 的最小值，其中最开始 $u\\gets s$ 同时 $a,b,c\\gets0$。\n\n**拓展**的定义为依次进行如下操作：\n\n- 选择任意一条边 $(u',v,w)\\in E$ 满足 $u=u'$，令 $u\\gets v,a\\gets a+w,b\\gets b+1,c\\gets c+w$；\n\n- 如果 $p\\mid b$，你****可以****令 $a\\gets a-c,b\\gets 0,c\\gets0$。\n\n特别地，对于每一次**拓展**，你**不能**取一个之前取过的点。\n\n给定序列 $\\{s_m\\}$，对于每个点 $u$ 求 $\\min\\limits_{i=1}^m\\{f(s_i,u)\\}$。\n\n", "inputFormat": "第一行三个整数 $n,m,p$，表示树的节点数为 $n$，编号分别为 $1\\sim n$，「湖之数」为 $p$，序列 $s$ 的长度为 $m$。\n\n接下来 $n-1$ 行每行三个整数 $u,v,w$ 表示存在一条连接 $u,v$ 两个点，边权为 $w$ 的边。\n\n接下来一行 $m$ 个整数表示 $s_{1\\sim m}$ 即 $m$ 个起点。", "outputFormat": "设 $ans_u=\\min\\limits_{i=1}^m\\{f(s_i,u)\\}$，那么你需要输出 $\\text{xor}_{i=1}^n |ans_i|$。其中 $|a|$ 表示 $a$ 的绝对值。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xo9b4yyn.png)\n\n - 如果她们从 $1$ 号点出发，首先有 $f(1,1)=0$。走到点 $2,3,4$ 时悦的计数器上的值分别为 $-2,1,2$，所以 $f(1,2)=-2,f(1,3)=1,f(1,4)=2$。她们走到点 $5,6$ 时，悦的计数器上的值分别为 $-5,8$。由于这时玲的计数器上的值等于 $2$，是 $p$ 的倍数，所以悦**可以**选择让她手上的计数器的值减去荧的计数器的值，不难得出 $f(1,5)=-5,f(1,6)=0$。\n \n- 如果她们从 $5$ 号点出发，同理可得 $f(5,5)=0,f(5,2)=-3,f(5,6)=0,f(5,1)=-5,f(5,4)=-3,f(5,3)=-4$。\n\n综上的 $\\{ans_n\\}=\\{-5,-3,-4,-3,-5,0\\}$。计算可得 $\\text{xor}_{i=1}^n |ans_i|=4$。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $\\text{Subtask1}$ | $m\\le n\\le100$，$p\\le20$ |  | $10$ |\n| $\\text{Subtask2}$ | $m\\le n\\le10^3$，$p\\le100$ |  | $15$ |\n| $\\text{Subtask3}$ | $n\\le10^5$，$p\\le100$，$m=1$ |  | $10$ |\n| $\\text{Subtask4}$ | $m\\le n\\le10^5$，$p=1$ |  | $20$ |\n| $\\text{Subtask5}$ | $m\\le n\\le10^5$，$p\\le100$ | 有 | $10$ |\n| $\\text{Subtask6}$ | $m\\le n\\le10^5$，$p\\le100$ |  | $35$ |\n\n特殊性质：保证树退化成一条链。\n\n对于 $100\\%$ 的数据 $1\\le m\\le n\\le10^5$，$1\\le p\\le100$，$-10^4\\le w\\le10^4$，$1\\le u,v,s_i\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『GROI-R1』 湖底之城", "background": "那年你我仍是无瑕的少年\n\n在夜晚安逸的后院无所顾忌地笑谈人生\n\n——怀念这样毫无猜忌的时光", "description": "悦，玲和荧三个人在湖底之城闲游。湖底之城的道路错综复杂，形成了一棵有 $n$ 个节点的树。\n\n她们三人的手上都有一个计数器，初始都为 $0$。她们每走到一个点的时候，**悦和荧**手上的计数器会自动加上刚刚经过的**这条边的边权**，同时**玲**的计数器会恰好**增加 $1$**。同时，她们整个过程中**没有经过某个点超过一次**。\n\n由于她们的计数器不能存储很大的值，所以，当**玲**的计数器上的值是「湖之数」$p$ 的**倍数**时，**悦可以**将她的计数器上的值减去**荧**的计数器上的值，接下来，**玲和荧**的计数器都会立刻**归零**。\n\n玘现在不知道她们闲游的起点和终点，所以天生计算能力很好的玘对于每一对起点和终点，计算出了悦手上计数器在终点时可能出现的最小值。玘把这个值记作 $f(u,v)$，意思是她们从点 $u$ 走到了点 $v$。可是，玘认为，没有红色彼岸花的寒，一定是算不出来这些答案的。所以，他让寒做一道更简单的题。玘给寒一个长度为 $m$ 的序列 $s$，让寒对于每一个点为 $u$ 时计算 $\\min\\limits_{i=1}^m\\{f(s_i,u)\\}$。\n\n**形式化题面**\n\n给定一个 $n$ 个点的树 $(V,E)$ 和一个正整数 $p$，每一条边有一个整数边权 $w_i$。\n\n我们定义 $f(s,v)$ 表示为对 $u,a,b,c$ 进行若干次**拓展**后可以得到的当 $u=v$ 时的 $a$ 的最小值，其中最开始 $u\\gets s$ 同时 $a,b,c\\gets0$。\n\n**拓展**的定义为依次进行如下操作：\n\n- 选择任意一条边 $(u',v,w)\\in E$ 满足 $u=u'$，令 $u\\gets v,a\\gets a+w,b\\gets b+1,c\\gets c+w$；\n\n- 如果 $p\\mid b$，你****可以****令 $a\\gets a-c,b\\gets 0,c\\gets0$。\n\n特别地，对于每一次**拓展**，你**不能**取一个之前取过的点。\n\n给定序列 $\\{s_m\\}$，对于每个点 $u$ 求 $\\min\\limits_{i=1}^m\\{f(s_i,u)\\}$。\n\n", "inputFormat": "第一行三个整数 $n,m,p$，表示树的节点数为 $n$，编号分别为 $1\\sim n$，「湖之数」为 $p$，序列 $s$ 的长度为 $m$。\n\n接下来 $n-1$ 行每行三个整数 $u,v,w$ 表示存在一条连接 $u,v$ 两个点，边权为 $w$ 的边。\n\n接下来一行 $m$ 个整数表示 $s_{1\\sim m}$ 即 $m$ 个起点。", "outputFormat": "设 $ans_u=\\min\\limits_{i=1}^m\\{f(s_i,u)\\}$，那么你需要输出 $\\text{xor}_{i=1}^n |ans_i|$。其中 $|a|$ 表示 $a$ 的绝对值。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xo9b4yyn.png)\n\n - 如果她们从 $1$ 号点出发，首先有 $f(1,1)=0$。走到点 $2,3,4$ 时悦的计数器上的值分别为 $-2,1,2$，所以 $f(1,2)=-2,f(1,3)=1,f(1,4)=2$。她们走到点 $5,6$ 时，悦的计数器上的值分别为 $-5,8$。由于这时玲的计数器上的值等于 $2$，是 $p$ 的倍数，所以悦**可以**选择让她手上的计数器的值减去荧的计数器的值，不难得出 $f(1,5)=-5,f(1,6)=0$。\n \n- 如果她们从 $5$ 号点出发，同理可得 $f(5,5)=0,f(5,2)=-3,f(5,6)=0,f(5,1)=-5,f(5,4)=-3,f(5,3)=-4$。\n\n综上的 $\\{ans_n\\}=\\{-5,-3,-4,-3,-5,0\\}$。计算可得 $\\text{xor}_{i=1}^n |ans_i|=4$。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $\\text{Subtask1}$ | $m\\le n\\le100$，$p\\le20$ |  | $10$ |\n| $\\text{Subtask2}$ | $m\\le n\\le10^3$，$p\\le100$ |  | $15$ |\n| $\\text{Subtask3}$ | $n\\le10^5$，$p\\le100$，$m=1$ |  | $10$ |\n| $\\text{Subtask4}$ | $m\\le n\\le10^5$，$p=1$ |  | $20$ |\n| $\\text{Subtask5}$ | $m\\le n\\le10^5$，$p\\le100$ | 有 | $10$ |\n| $\\text{Subtask6}$ | $m\\le n\\le10^5$，$p\\le100$ |  | $35$ |\n\n特殊性质：保证树退化成一条链。\n\n对于 $100\\%$ 的数据 $1\\le m\\le n\\le10^5$，$1\\le p\\le100$，$-10^4\\le w\\le10^4$，$1\\le u,v,s_i\\le n$。", "locale": "zh-CN"}}}
{"pid": "P8976", "type": "P", "difficulty": 4, "samples": [["2\n6 6 12\n6 8 14", "1 6 2 5 3 4\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2023", "洛谷原创", "Special Judge", "构造"], "title": "「DTOI-4」排列", "background": "**Update on 2023.2.1：新增一组针对 @[yuanjiabao](https://www.luogu.com.cn/user/455558) 的 Hack 数据，放置于 #21。**\n\n**Update on 2023.2.2：新增一组针对 @[CourtesyWei](https://www.luogu.com.cn/user/664070) 和 @[bizhidaojiaosha](https://www.luogu.com.cn/user/613616) 的 Hack 数据，放置于 #22。**\n\n------------\n\n~~构造一个排列 $p$，使得~~$\\small\\color{white}{下标为奇数的项之和 \\geq a 且下标为偶数的项之和 \\geq b。}$", "description": "小 L 给你一个**偶数** $n$ 和两个整数 $a, b$，请你构造一个长为 $n$ 的排列 $p$，使得其满足 $\\displaystyle\\sum_{i = 1}^{\\frac{n}{2}} p_i \\geq a$ 且 $\\displaystyle\\sum_{i = \\frac{n}{2} + 1}^{n} p_i \\geq b$。", "inputFormat": "**本题有多组测试数据。**\n\n第一行，一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n一行，三个整数 $n, a, b$。", "outputFormat": "对于每组数据，如果无解，输出 $-1$；否则，输出一行，$n$ 个整数，表示你构造出的排列 $p$。\n\n**如有多解，输出任意一组均可。**", "hint": "**本题开启 Special Judge。**\n\n| $\\textbf{Subtask}$ | $n$ | $a, b$ | 分值 |\n| :------: | :------: | :------: | :------: |\n| $1$ | $2 \\leq n \\leq 10$ | 无特殊限制 | $20 \\operatorname{pts}$ |\n| $2$ | 无特殊限制 | $a = b = 0$ | $10 \\operatorname{pts}$ |\n| $3$ | 同上 | $a = 0$ 或 $b = 0$ | $10 \\operatorname{pts}$ |\n| $4$ | 同上 | 无特殊限制 | $60 \\operatorname{pts}$ |\n\n对于 $100\\%$ 的数据，$2 \\leq n, \\sum n \\leq 10^5$，$0 \\leq a, b \\leq \\frac{n(n + 1)}{2}$，$1 \\leq T \\leq 10$，$n$ 为**偶数**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DTOI-4」排列", "background": "**Update on 2023.2.1：新增一组针对 @[yuanjiabao](https://www.luogu.com.cn/user/455558) 的 Hack 数据，放置于 #21。**\n\n**Update on 2023.2.2：新增一组针对 @[CourtesyWei](https://www.luogu.com.cn/user/664070) 和 @[bizhidaojiaosha](https://www.luogu.com.cn/user/613616) 的 Hack 数据，放置于 #22。**\n\n------------\n\n~~构造一个排列 $p$，使得~~$\\small\\color{white}{下标为奇数的项之和 \\geq a 且下标为偶数的项之和 \\geq b。}$", "description": "小 L 给你一个**偶数** $n$ 和两个整数 $a, b$，请你构造一个长为 $n$ 的排列 $p$，使得其满足 $\\displaystyle\\sum_{i = 1}^{\\frac{n}{2}} p_i \\geq a$ 且 $\\displaystyle\\sum_{i = \\frac{n}{2} + 1}^{n} p_i \\geq b$。", "inputFormat": "**本题有多组测试数据。**\n\n第一行，一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n一行，三个整数 $n, a, b$。", "outputFormat": "对于每组数据，如果无解，输出 $-1$；否则，输出一行，$n$ 个整数，表示你构造出的排列 $p$。\n\n**如有多解，输出任意一组均可。**", "hint": "**本题开启 Special Judge。**\n\n| $\\textbf{Subtask}$ | $n$ | $a, b$ | 分值 |\n| :------: | :------: | :------: | :------: |\n| $1$ | $2 \\leq n \\leq 10$ | 无特殊限制 | $20 \\operatorname{pts}$ |\n| $2$ | 无特殊限制 | $a = b = 0$ | $10 \\operatorname{pts}$ |\n| $3$ | 同上 | $a = 0$ 或 $b = 0$ | $10 \\operatorname{pts}$ |\n| $4$ | 同上 | 无特殊限制 | $60 \\operatorname{pts}$ |\n\n对于 $100\\%$ 的数据，$2 \\leq n, \\sum n \\leq 10^5$，$0 \\leq a, b \\leq \\frac{n(n + 1)}{2}$，$1 \\leq T \\leq 10$，$n$ 为**偶数**。", "locale": "zh-CN"}}}
{"pid": "P8977", "type": "P", "difficulty": 4, "samples": [["5\n1 0 -1 1 -1\n1 2\n2 3\n2 4\n1 5", "1 2 4"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "贪心", "2023", "洛谷原创", "O2优化", "深度优先搜索 DFS"], "title": "「DTOI-4」行走", "background": "小 L 感到无聊，于是希望在树上行走。", "description": "小 L 有一棵 $n$ 个点的树，树上点有点权，其中第 $i$ 个点权值为 $a_i$。\n\n他不喜欢奇奇怪怪的权值，于是他保证 $a_i$ 一定是 $-1, 0, 1$ 之一。\n\n他认为在树上行走是有趣的，于是他想要在这棵树上走出一条路径 $P$，其需要满足以下条件：\n\n- $P$ 是一条**可以为空**的**简单有向路径**。\n- 设 $P$ 中依次经过的点为 $P_1, P_2, \\cdots, P_{|P|}$，则你求出的 $P$ 需要满足 $P_1 = 1$。\n- 设 $f(P) = \\displaystyle\\sum_{i = 1}^{|P|} \\frac{a_{P_i}}{2^{i - 1}}$，则你求出的 $P$ 需要满足 $f(P)$ 最大。\n- 在 $f(P)$ 最大的前提下，你求出的 $P$ 还需要满足 $P$ 的字典序最小。\n\n请你求出符合上述条件的路径 $P$。 \n\n------------\n\n关于本题中字典序的定义：\n\n设有两条待比较的路径 $P \\neq Q$。\n\n- 若存在 $1 \\leq i \\leq \\min(|P|, |Q|)$，使得 $\\forall 1 \\leq j < i, P_j = Q_j$ 且 $P_i < Q_i$，则我们称 $P$ 的字典序小于 $Q$。\n- 若存在 $1 \\leq i \\leq \\min(|P|, |Q|)$，使得 $\\forall 1 \\leq j < i, P_j = Q_j$ 且 $P_i > Q_i$，则我们称 $P$ 的字典序大于 $Q$。\n- 若 $\\forall 1 \\leq i \\leq \\min(|P|, |Q|), P_i = Q_i$ 且 $|P| < |Q|$，则我们称 $P$ 的字典序小于 $Q$。\n- 若 $\\forall 1 \\leq i \\leq \\min(|P|, |Q|), P_i = Q_i$ 且 $|P| > |Q|$，则我们称 $P$ 的字典序大于 $Q$。", "inputFormat": "第一行，一个整数 $n$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$；\n\n接下来 $n - 1$ 行，每行两个整数 $u, v$，表示树上的一条边。", "outputFormat": "一行，$|P|$ 个整数，表示你求出的路径 $P$ 中依次经过的点。\n\n**特别的，若 $P$ 为空路径，请不要进行任何输出操作。**", "hint": "#### 样例 #1 解释\n![](https://cdn.luogu.com.cn/upload/image_hosting/c7n2n6i0.png)\n\n$P = [1, 2, 4]$ 时 $f(P) = 1 + 0 + \\frac{1}{4} = \\frac{5}{4}$。可以证明不存在更优的 $P$。\n#### 数据范围\n| $\\textbf{Subtask}$ | $n$ | $a_i$ | 依赖 | 分值 |\n| :------: | :------: | :------: | :------: | :------: |\n| $1$ | $1 \\leq n \\leq 50$ | 无特殊限制 | 无 | $10 \\operatorname{pts}$ |\n| $2$ | $1 \\leq n \\leq 500$ | 同上 | $1$ | $10 \\operatorname{pts}$ |\n| $3$ | $1 \\leq n \\leq 5 \\times 10^3$ | 同上 | $1, 2$ | $10 \\operatorname{pts}$ |\n| $4$ | $1 \\leq n \\leq 10^5$ | 同上 | $1 \\sim 3$ | $20 \\operatorname{pts}$ |\n| $5$ | 无特殊限制 | $a_i \\in \\{-1, 1\\}$ | 无 | $20 \\operatorname{pts}$ |\n| $6$ | 同上 | 无特殊限制 | $1 \\sim 5$ | $30 \\operatorname{pts}$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5 \\times 10^5$，$a_i \\in \\{-1, 0, 1\\}$，$1 \\leq u, v \\leq n$，保证给出的边可以构成一棵**无根树**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DTOI-4」行走", "background": "小 L 感到无聊，于是希望在树上行走。", "description": "小 L 有一棵 $n$ 个点的树，树上点有点权，其中第 $i$ 个点权值为 $a_i$。\n\n他不喜欢奇奇怪怪的权值，于是他保证 $a_i$ 一定是 $-1, 0, 1$ 之一。\n\n他认为在树上行走是有趣的，于是他想要在这棵树上走出一条路径 $P$，其需要满足以下条件：\n\n- $P$ 是一条**可以为空**的**简单有向路径**。\n- 设 $P$ 中依次经过的点为 $P_1, P_2, \\cdots, P_{|P|}$，则你求出的 $P$ 需要满足 $P_1 = 1$。\n- 设 $f(P) = \\displaystyle\\sum_{i = 1}^{|P|} \\frac{a_{P_i}}{2^{i - 1}}$，则你求出的 $P$ 需要满足 $f(P)$ 最大。\n- 在 $f(P)$ 最大的前提下，你求出的 $P$ 还需要满足 $P$ 的字典序最小。\n\n请你求出符合上述条件的路径 $P$。 \n\n------------\n\n关于本题中字典序的定义：\n\n设有两条待比较的路径 $P \\neq Q$。\n\n- 若存在 $1 \\leq i \\leq \\min(|P|, |Q|)$，使得 $\\forall 1 \\leq j < i, P_j = Q_j$ 且 $P_i < Q_i$，则我们称 $P$ 的字典序小于 $Q$。\n- 若存在 $1 \\leq i \\leq \\min(|P|, |Q|)$，使得 $\\forall 1 \\leq j < i, P_j = Q_j$ 且 $P_i > Q_i$，则我们称 $P$ 的字典序大于 $Q$。\n- 若 $\\forall 1 \\leq i \\leq \\min(|P|, |Q|), P_i = Q_i$ 且 $|P| < |Q|$，则我们称 $P$ 的字典序小于 $Q$。\n- 若 $\\forall 1 \\leq i \\leq \\min(|P|, |Q|), P_i = Q_i$ 且 $|P| > |Q|$，则我们称 $P$ 的字典序大于 $Q$。", "inputFormat": "第一行，一个整数 $n$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$；\n\n接下来 $n - 1$ 行，每行两个整数 $u, v$，表示树上的一条边。", "outputFormat": "一行，$|P|$ 个整数，表示你求出的路径 $P$ 中依次经过的点。\n\n**特别的，若 $P$ 为空路径，请不要进行任何输出操作。**", "hint": "#### 样例 #1 解释\n![](https://cdn.luogu.com.cn/upload/image_hosting/c7n2n6i0.png)\n\n$P = [1, 2, 4]$ 时 $f(P) = 1 + 0 + \\frac{1}{4} = \\frac{5}{4}$。可以证明不存在更优的 $P$。\n#### 数据范围\n| $\\textbf{Subtask}$ | $n$ | $a_i$ | 依赖 | 分值 |\n| :------: | :------: | :------: | :------: | :------: |\n| $1$ | $1 \\leq n \\leq 50$ | 无特殊限制 | 无 | $10 \\operatorname{pts}$ |\n| $2$ | $1 \\leq n \\leq 500$ | 同上 | $1$ | $10 \\operatorname{pts}$ |\n| $3$ | $1 \\leq n \\leq 5 \\times 10^3$ | 同上 | $1, 2$ | $10 \\operatorname{pts}$ |\n| $4$ | $1 \\leq n \\leq 10^5$ | 同上 | $1 \\sim 3$ | $20 \\operatorname{pts}$ |\n| $5$ | 无特殊限制 | $a_i \\in \\{-1, 1\\}$ | 无 | $20 \\operatorname{pts}$ |\n| $6$ | 同上 | 无特殊限制 | $1 \\sim 5$ | $30 \\operatorname{pts}$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5 \\times 10^5$，$a_i \\in \\{-1, 0, 1\\}$，$1 \\leq u, v \\leq n$，保证给出的边可以构成一棵**无根树**。", "locale": "zh-CN"}}}
{"pid": "P8978", "type": "P", "difficulty": 7, "samples": [["10 2\n2 8 3 2 5 7 10 4 9 7", "7"], ["30 3\n1 0 1 0 1 0 0 0 0 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0", "0"], ["31 3\n1 0 1 0 1 0 0 0 0 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0 1 1 0 0 0 0 1", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "二分", "单调队列", "2023", "洛谷原创", "O2优化"], "title": "「DTOI-4」中位数", "background": "", "description": "给定一个长度为 $n$ 的整数序列 $a$，你可以进行以下操作不超过 $k$ 次：\n\n- 选择一个区间 $[l, r]$ 满足 $1 \\leq l \\leq r \\leq n$，并将 $[l, r]$ 中的所有数替换为这个区间的中位数。\n\n你要使得操作后 $a$ 的**最小值最大**。\n\n关于此处中位数的定义：对于一个长度为 $len$ 的序列，其中位数定义为该序列中第 $\\lceil \\frac{len}{2} \\rceil$ 小的数。", "inputFormat": "第一行，两个整数 $n, k$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$。", "outputFormat": "一行，表示经过不超过 $k$ 次操作后序列最小值的最大值。", "hint": "| $\\textbf{Subtask}$ | $n$ | 分值 |\n| :------: | :------: | :------: |\n| $1$ | $1 \\leq n \\leq 10$ | $10 \\operatorname{pts}$ |\n| $2$ | $1 \\leq n \\leq 100$ | $10 \\operatorname{pts}$ |\n| $3$ | $1 \\leq n \\leq 10^3$ | $10 \\operatorname{pts}$ |\n| $4$ | $1 \\leq n \\leq 10^4$ | $20 \\operatorname{pts}$ |\n| $5$ | $1 \\leq n \\leq 10^5$ | $20 \\operatorname{pts}$ |\n| $6$ | 无特殊限制 | $30 \\operatorname{pts}$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 4 \\times 10^5$，$0 \\leq k \\leq n$，$0 \\leq a_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DTOI-4」中位数", "background": "", "description": "给定一个长度为 $n$ 的整数序列 $a$，你可以进行以下操作不超过 $k$ 次：\n\n- 选择一个区间 $[l, r]$ 满足 $1 \\leq l \\leq r \\leq n$，并将 $[l, r]$ 中的所有数替换为这个区间的中位数。\n\n你要使得操作后 $a$ 的**最小值最大**。\n\n关于此处中位数的定义：对于一个长度为 $len$ 的序列，其中位数定义为该序列中第 $\\lceil \\frac{len}{2} \\rceil$ 小的数。", "inputFormat": "第一行，两个整数 $n, k$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$。", "outputFormat": "一行，表示经过不超过 $k$ 次操作后序列最小值的最大值。", "hint": "| $\\textbf{Subtask}$ | $n$ | 分值 |\n| :------: | :------: | :------: |\n| $1$ | $1 \\leq n \\leq 10$ | $10 \\operatorname{pts}$ |\n| $2$ | $1 \\leq n \\leq 100$ | $10 \\operatorname{pts}$ |\n| $3$ | $1 \\leq n \\leq 10^3$ | $10 \\operatorname{pts}$ |\n| $4$ | $1 \\leq n \\leq 10^4$ | $20 \\operatorname{pts}$ |\n| $5$ | $1 \\leq n \\leq 10^5$ | $20 \\operatorname{pts}$ |\n| $6$ | 无特殊限制 | $30 \\operatorname{pts}$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 4 \\times 10^5$，$0 \\leq k \\leq n$，$0 \\leq a_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P8979", "type": "P", "difficulty": 7, "samples": [["10 25\n-5 -73 -95 64 15\n-80 -31 -58 15 95 -1 14 -30 31 ", "998096342"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2023", "多项式", "洛谷原创", "O2优化", "线性递推"], "title": "「DTOI-4」白的 Fibonacci", "background": "", "description": "定义 $F(k, n)$ 如下：\n\n$$\nF(k,n) = \n\\left \\{\n\\begin{aligned}\n&st_0\\ && k = 1\\ \\land\\ n = 0 \\\\\n&st_1\\ && k = 1\\ \\land\\ n = 1 \\\\\n&0\\ && k > 1 \\ \\land \\ n < 0 \\\\\n&a \\times F(k, n - 1) + b \\times F(k, n - 2)\\ && k = 1 \\ \\land\\ n > 1 \\\\\n&t_k \\times F(k, n - 1) + s^n \\times F(k - 1, n)\\ && \\text{otherwise}\n\\end{aligned}\n\\right.\n$$\n\n给定 $F$ 递推式的各项系数和 $k, n$，请你求出 $F(k, n) \\bmod 998244353$ 的值。", "inputFormat": "第一行，两个整数 $k, n$；\n\n第二行，五个整数 $st_0, st_1, a, b, s$；\n\n第三行，$k - 1$ 个整数 $t_2, t_3, \\cdots, t_k$。", "outputFormat": "一行一个整数表示答案。", "hint": "| $\\textbf{Subtask}$ | $k \\leq$ | $n \\leq$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $100$ | $100$ | 无 | $5$ |\n| $2$ | $100$ | $2^{63}$ | 无 | $25$ |\n| $3$ | $5000$ | $2^{63}$ | $s = 1, \\forall 2 \\leq i \\leq k, t_i = 1$ | $10$ |\n| $4$ | $5000$ | $2^{63}$ | 无 | $60$ |\n\n对于 $100\\%$ 的数据，$1 \\leq k \\leq 5 \\times 10^3$，$0 \\leq n \\le 2^{63}$，$-998244352 \\leq st_0, st_1, a, b, s, t_i \\leq 998244352$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DTOI-4」白的 Fibonacci", "background": "", "description": "定义 $F(k, n)$ 如下：\n\n$$\nF(k,n) = \n\\left \\{\n\\begin{aligned}\n&st_0\\ && k = 1\\ \\land\\ n = 0 \\\\\n&st_1\\ && k = 1\\ \\land\\ n = 1 \\\\\n&0\\ && k > 1 \\ \\land \\ n < 0 \\\\\n&a \\times F(k, n - 1) + b \\times F(k, n - 2)\\ && k = 1 \\ \\land\\ n > 1 \\\\\n&t_k \\times F(k, n - 1) + s^n \\times F(k - 1, n)\\ && \\text{otherwise}\n\\end{aligned}\n\\right.\n$$\n\n给定 $F$ 递推式的各项系数和 $k, n$，请你求出 $F(k, n) \\bmod 998244353$ 的值。", "inputFormat": "第一行，两个整数 $k, n$；\n\n第二行，五个整数 $st_0, st_1, a, b, s$；\n\n第三行，$k - 1$ 个整数 $t_2, t_3, \\cdots, t_k$。", "outputFormat": "一行一个整数表示答案。", "hint": "| $\\textbf{Subtask}$ | $k \\leq$ | $n \\leq$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $100$ | $100$ | 无 | $5$ |\n| $2$ | $100$ | $2^{63}$ | 无 | $25$ |\n| $3$ | $5000$ | $2^{63}$ | $s = 1, \\forall 2 \\leq i \\leq k, t_i = 1$ | $10$ |\n| $4$ | $5000$ | $2^{63}$ | 无 | $60$ |\n\n对于 $100\\%$ 的数据，$1 \\leq k \\leq 5 \\times 10^3$，$0 \\leq n \\le 2^{63}$，$-998244352 \\leq st_0, st_1, a, b, s, t_i \\leq 998244352$。", "locale": "zh-CN"}}}
{"pid": "P8980", "type": "P", "difficulty": 5, "samples": [["1\n11 3\n8 9 5", "game won't stop"], ["2\n8 5\n8 2 3 5 7 \n24 16\n3 17 18 5 19 4 16 23 7 11 13 18 6 21 22 2\n", "5\n11\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "O2优化", "素数判断,质数,筛法"], "title": "「DROI」Round 1 游戏", "background": "人生，又何尝不是一场游戏呢？", "description": "你将和一名小朋友进行 $T$ 次游戏，每一次游戏的规则如下：\n\n1. 首先，你需要在 $[1,n]$ 中选择一个正整数 $x$。\n\n2. 接下来，小朋友会有 $Q$ 次询问，对于每次询问，他会给出一个 $a_i$（保证 $a_i \\in [1,n]$），你需要回答他 $\\gcd(x,a_i)$ 的值。\n\n3. 当某一轮小朋友得到答案后，如果他能唯一确定你选择的数，那么本次游戏结束。\n\n现在**你提前知道了**小朋友每次询问的 $a_i$，你需要找到一个 $x$，使得游戏持续的轮数最长。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示进行游戏的次数。\n\n对于每次游戏：\n\n第一行两个整数，分别为 $n$ 和 $Q$。\n\n第二行 $Q$ 个整数，其中第 $i$ 个整数表示 $a_i$。", "outputFormat": "对于每次游戏，请输出游戏能持续的最长轮数，如果存在一个 $x$ 使得小朋友在 $Q$ 轮之后也无法唯一确定其值，则输出`game won't stop`。", "hint": "#### 样例解释#1\n\n选取 $11$ 作为 $x$，显然小朋友到游戏结束也无法唯一确定。\n\n------------\n\n#### 样例解释#2\n\n对于第一组数据：选取 $1$ 作为 $x$，小朋友在第五轮结束后可以唯一确定 $x$，可以证明不存在更优的 $x$。\n\n对于第二组数据：同理，选取 $1$ 作为 $x$ 即可。\n\n------------\n\n#### 数据范围\n\n**「本题采用捆绑测试」** \n\n- $\\operatorname{Subtask} 1(20\\%)$：$n,Q\\leq 500$。\n\n- $\\operatorname{Subtask} 2(20\\%)$：$n,Q \\leq 5 \\times 10^4$。\n\n- $\\operatorname{Subtask} 3(30\\%)$：$Q \\leq 10^5$。\n\n- $\\operatorname{Subtask} 4(30\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据：$T \\leq 10$，$1 \\leq a_i \\leq n \\leq 10^{18}$，$1 \\leq Q \\leq 2\\times 10^{6}$，$\\sum Q \\leq 6\\times 10^{6}$。\n\n**本题输入量较大，请用较快的输入方法。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DROI」Round 1 游戏", "background": "人生，又何尝不是一场游戏呢？", "description": "你将和一名小朋友进行 $T$ 次游戏，每一次游戏的规则如下：\n\n1. 首先，你需要在 $[1,n]$ 中选择一个正整数 $x$。\n\n2. 接下来，小朋友会有 $Q$ 次询问，对于每次询问，他会给出一个 $a_i$（保证 $a_i \\in [1,n]$），你需要回答他 $\\gcd(x,a_i)$ 的值。\n\n3. 当某一轮小朋友得到答案后，如果他能唯一确定你选择的数，那么本次游戏结束。\n\n现在**你提前知道了**小朋友每次询问的 $a_i$，你需要找到一个 $x$，使得游戏持续的轮数最长。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示进行游戏的次数。\n\n对于每次游戏：\n\n第一行两个整数，分别为 $n$ 和 $Q$。\n\n第二行 $Q$ 个整数，其中第 $i$ 个整数表示 $a_i$。", "outputFormat": "对于每次游戏，请输出游戏能持续的最长轮数，如果存在一个 $x$ 使得小朋友在 $Q$ 轮之后也无法唯一确定其值，则输出`game won't stop`。", "hint": "#### 样例解释#1\n\n选取 $11$ 作为 $x$，显然小朋友到游戏结束也无法唯一确定。\n\n------------\n\n#### 样例解释#2\n\n对于第一组数据：选取 $1$ 作为 $x$，小朋友在第五轮结束后可以唯一确定 $x$，可以证明不存在更优的 $x$。\n\n对于第二组数据：同理，选取 $1$ 作为 $x$ 即可。\n\n------------\n\n#### 数据范围\n\n**「本题采用捆绑测试」** \n\n- $\\operatorname{Subtask} 1(20\\%)$：$n,Q\\leq 500$。\n\n- $\\operatorname{Subtask} 2(20\\%)$：$n,Q \\leq 5 \\times 10^4$。\n\n- $\\operatorname{Subtask} 3(30\\%)$：$Q \\leq 10^5$。\n\n- $\\operatorname{Subtask} 4(30\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据：$T \\leq 10$，$1 \\leq a_i \\leq n \\leq 10^{18}$，$1 \\leq Q \\leq 2\\times 10^{6}$，$\\sum Q \\leq 6\\times 10^{6}$。\n\n**本题输入量较大，请用较快的输入方法。**", "locale": "zh-CN"}}}
{"pid": "P8981", "type": "P", "difficulty": 5, "samples": [["2 1\n1 2\n", "2"], ["5 2\n1 2\n1 3\n4 1\n5 1\n", "72"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树形数据结构", "洛谷原创", "O2优化", "树形 DP", "树的直径"], "title": "「DROI」Round 1 距离", "background": "没有什么距离是无法跨越的。", "description": "定义一棵树 $G$ 上两点 $u,v$ 之间的距离 $\\operatorname{dis}(u,v)$ 为两点之间点的数量。\n\n若对于树上两点 $u,v$，满足 $\\forall x \\in G,\\operatorname{dis}(u,x) \\leq \\operatorname{dis}(u,v)$ **且** $\\operatorname{dis}(v,x) \\leq \\operatorname{dis}(u,v)$，那么我们称无序点对 $(u,v)$ 为**极远点对**。\n\n同时，树 $G$ 上一点 $x$ 的权值 $v_x$ 定义为：满足两点间最短路径经过 $x$ 的极远点对的数量。\n\n现给定树 $G$，求 $\\sum\\limits_{x \\in G}{v_x^k}$ 对 $998244353$ 取模的值，其中 $k$ 是给定的常数，且 $k \\in [1,2]$。", "inputFormat": "第一行两个数 $n,k$，分别表示树 $G$ 的点数以及给定的常数。\n\n接下来 $n-1$ 行每行两个整数 $u,v$，表示点 $u$ 和点 $v$ 之间有一条边。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "#### 样例解释 #1\n\n$(1,2)$ 为极远点对，所以 $1$ 号和 $2$ 号点点权均为 $1$，$1^1 + 1^1 =2$。\n\n------------\n\n#### 样例解释 #2\n\n极远点对有 $(2,3),(2,4),(2,5),(3,4),(3,5),(4,5)$，故答案为 $4 \\times 3^2 + 6^2 = 72$。\n\n------------\n\n#### 数据范围\n\n| 测试点编号 | $1$ | $2$ | $3$ | $4 \\sim 5$ | $6$ | $7$ | $8 \\sim 9$ | $10$ |\n| :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |\n| $n$ | $300$ | $300$ | $2000$ | $2000$ | $10^5$ | $5 \\times 10^6$ | $10^5$ |  $5 \\times 10^6$|\n| $k$ | $1$ | $2$ | $1$ | $2$ | $1$ | $1$ | $2$ | $2$ |\n\n对于 $100\\%$ 的数据，满足 $n \\leq 5 \\times 10^6$，$1 \\leq  k \\leq 2$。\n\n**本题输入量较大，请用较快的输入方法。**\n\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DROI」Round 1 距离", "background": "没有什么距离是无法跨越的。", "description": "定义一棵树 $G$ 上两点 $u,v$ 之间的距离 $\\operatorname{dis}(u,v)$ 为两点之间点的数量。\n\n若对于树上两点 $u,v$，满足 $\\forall x \\in G,\\operatorname{dis}(u,x) \\leq \\operatorname{dis}(u,v)$ **且** $\\operatorname{dis}(v,x) \\leq \\operatorname{dis}(u,v)$，那么我们称无序点对 $(u,v)$ 为**极远点对**。\n\n同时，树 $G$ 上一点 $x$ 的权值 $v_x$ 定义为：满足两点间最短路径经过 $x$ 的极远点对的数量。\n\n现给定树 $G$，求 $\\sum\\limits_{x \\in G}{v_x^k}$ 对 $998244353$ 取模的值，其中 $k$ 是给定的常数，且 $k \\in [1,2]$。", "inputFormat": "第一行两个数 $n,k$，分别表示树 $G$ 的点数以及给定的常数。\n\n接下来 $n-1$ 行每行两个整数 $u,v$，表示点 $u$ 和点 $v$ 之间有一条边。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "#### 样例解释 #1\n\n$(1,2)$ 为极远点对，所以 $1$ 号和 $2$ 号点点权均为 $1$，$1^1 + 1^1 =2$。\n\n------------\n\n#### 样例解释 #2\n\n极远点对有 $(2,3),(2,4),(2,5),(3,4),(3,5),(4,5)$，故答案为 $4 \\times 3^2 + 6^2 = 72$。\n\n------------\n\n#### 数据范围\n\n| 测试点编号 | $1$ | $2$ | $3$ | $4 \\sim 5$ | $6$ | $7$ | $8 \\sim 9$ | $10$ |\n| :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: | :----: |\n| $n$ | $300$ | $300$ | $2000$ | $2000$ | $10^5$ | $5 \\times 10^6$ | $10^5$ |  $5 \\times 10^6$|\n| $k$ | $1$ | $2$ | $1$ | $2$ | $1$ | $1$ | $2$ | $2$ |\n\n对于 $100\\%$ 的数据，满足 $n \\leq 5 \\times 10^6$，$1 \\leq  k \\leq 2$。\n\n**本题输入量较大，请用较快的输入方法。**\n\n\n", "locale": "zh-CN"}}}
{"pid": "P8982", "type": "P", "difficulty": 5, "samples": [["3\n1 2 3", "1 2 3"], ["3\n9 14 46666666", "9 18 -1"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "洛谷原创", "O2优化"], "title": "「DROI」Round 1 下坠", "background": "下坠是有终点的吗？", "description": "$f$ 是定义在 $\\mathbb{N^+}$ 上的函数。\n\n我们令 $a_i$ 表示 $x$ 从低到高第 $i$ 位，那么 $f(x)= \\prod_{i=1}^{len} (a_i+1)$（$len$ 表示 $x$ 的位数）。\n\n如果对于一个数 $x$，存在 $y$ 使得 $f(y)=x$，那我们称 $x$ 是下坠数。\n\n现在有 $Q$ 次询问，每次询问会给出一个正整数 $k$。\n\n令 $x$ 表示所有下坠数中第 $k$ 小的下坠数，那么请你找到一个**最小的** $y$，使得 $f(y)=x$。若不存在一个 $y \\in [1,10^{18}]$ 满足条件，则输出 $-1$。", "inputFormat": "第一行输入一个整数 $Q$，表示询问次数。\n\n接下输入一行 $Q$ 个数，第 $i$ 个数表示第 $i$ 次询问的 $k$。", "outputFormat": "输出一行 $Q$ 个数，第 $i$ 个数表示第 $i$ 次询问你找到的答案。", "hint": "#### 样例解释 #1\n\n注意到 $f$ 的定义域是 $\\mathbb{N^+}$，所以 $1$ 不是下坠数。则前三个下坠数分别为 $2,3,4$，对应的 $y$ 值则为 $1,2,3$。\n\n------------\n\n#### 样例解释 #2\n\n第 $9$ 和 $14$ 个下坠数分别为 $10$ 和 $18$，其对应的 $y$ 值则为 $9$ 和 $18$。可以证明，第 $46666666$ 个下坠数对应的 $y > 10^{18}$。\n\n------------\n\n#### 数据范围\n\n对于 $100\\%$ 的数据满足：$Q \\leq 10^5$，$k \\leq 5 \\times 10^7$。\n\n其中对于 $10\\%$ 的数据满足：$k \\leq 100$。\n\n对于 $30\\%$ 的数据满足：$k \\leq 5 \\times 10^3$。\n\n对于另外 $20\\%$ 的数据满足：对于所有被询问到的下坠数 $x$，都有 $\\vert x-y \\vert \\leq 100$ 或者 $y > 10^{18}$。\n\n**请注意不同寻常的时间限制。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DROI」Round 1 下坠", "background": "下坠是有终点的吗？", "description": "$f$ 是定义在 $\\mathbb{N^+}$ 上的函数。\n\n我们令 $a_i$ 表示 $x$ 从低到高第 $i$ 位，那么 $f(x)= \\prod_{i=1}^{len} (a_i+1)$（$len$ 表示 $x$ 的位数）。\n\n如果对于一个数 $x$，存在 $y$ 使得 $f(y)=x$，那我们称 $x$ 是下坠数。\n\n现在有 $Q$ 次询问，每次询问会给出一个正整数 $k$。\n\n令 $x$ 表示所有下坠数中第 $k$ 小的下坠数，那么请你找到一个**最小的** $y$，使得 $f(y)=x$。若不存在一个 $y \\in [1,10^{18}]$ 满足条件，则输出 $-1$。", "inputFormat": "第一行输入一个整数 $Q$，表示询问次数。\n\n接下输入一行 $Q$ 个数，第 $i$ 个数表示第 $i$ 次询问的 $k$。", "outputFormat": "输出一行 $Q$ 个数，第 $i$ 个数表示第 $i$ 次询问你找到的答案。", "hint": "#### 样例解释 #1\n\n注意到 $f$ 的定义域是 $\\mathbb{N^+}$，所以 $1$ 不是下坠数。则前三个下坠数分别为 $2,3,4$，对应的 $y$ 值则为 $1,2,3$。\n\n------------\n\n#### 样例解释 #2\n\n第 $9$ 和 $14$ 个下坠数分别为 $10$ 和 $18$，其对应的 $y$ 值则为 $9$ 和 $18$。可以证明，第 $46666666$ 个下坠数对应的 $y > 10^{18}$。\n\n------------\n\n#### 数据范围\n\n对于 $100\\%$ 的数据满足：$Q \\leq 10^5$，$k \\leq 5 \\times 10^7$。\n\n其中对于 $10\\%$ 的数据满足：$k \\leq 100$。\n\n对于 $30\\%$ 的数据满足：$k \\leq 5 \\times 10^3$。\n\n对于另外 $20\\%$ 的数据满足：对于所有被询问到的下坠数 $x$，都有 $\\vert x-y \\vert \\leq 100$ 或者 $y > 10^{18}$。\n\n**请注意不同寻常的时间限制。**", "locale": "zh-CN"}}}
{"pid": "P8983", "type": "P", "difficulty": 6, "samples": [["3 3 5 10\n1 2 6\n7 3 11\n9 44 5\n2 3 1\n1 3 2\n5 10 15 20 25\n6 6 6 6 6", "0"], ["8 8 8 28\n49 11 44 31 25 37 41 1 \n29 38 46 21 21 17 45 47 \n1 37 11 31 8 15 15 47 \n21 47 15 6 11 9 40 28 \n21 29 1 11 39 15 21 35 \n26 20 3 38 1 41 27 21 \n41 41 31 16 11 1 24 3 \n33 15 23 26 7 47 49 8 \n3 8 2 4 6 5 1 7 \n7 5 8 3 6 1 4 2 \n36 13 12 3 38 49 22 55 \n20 24 2 30 26 25 17 25 ", "32"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "洛谷原创", "O2优化", "动态规划优化"], "title": "「DROI」Round 1 失控", "background": "失控的，或许反而是理智的。", "description": "给定一个 $n \\times m$ 的矩阵 $G$ 和两个长度为 $m$ 的排列 $p,q$。\n\n我们称元素 $G_{i,j}$ 是**失控的**，当且仅当 $\\vert G_{i,j} - G_{i-1,p_j} \\vert > C$ **且** $\\vert G_{i,j} - G_{i+1,q_j} \\vert > C$，其中 $C$ 是给定的常数。特殊地，我们规定无论如何第 $1$ 行和第 $n$ 行的元素都不是失控的。\n\n此时再给定两个长度为 $k$ 的序列 $A$ 和 $B$。\n\n你将有 $k$ 种操作：其中第 $i$ 种操作是将某一行所有元素增加 $A_i$，这将会花费 $B_i$ 的代价。**每种操作可以使用的次数不限，但对于每一行，你只可以进行这些操作中的一种或不操作。并且，你必须保证任意相邻两行最多有一行进行操作。**\n\n请问要使得矩阵 $G$ 中所有元素均不失控，至少要花费的代价是多少（数据保证有解）？", "inputFormat": "第一行四个整数，分别为 $n,m,k,C$。\n\n接下来 $n+4$ 行，前 $n$ 行每行 $m$ 个数，表示矩阵 $G$，第 $n+1$ 和 $n+2$ 行每行 $m$ 个数，分别表示排列 $p$ 和 $q$，最后两行每行 $k$ 个数，分别表示序列 $A$ 和 $B$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "#### 样例解释 #1\n\n显然对于样例一，不用进行任何操作就能保证所有元素均不失控。\n\n------------\n\n#### 样例解释 #2\n\n对第三行使用 $3$ 操作，对第七行使用 $4$ 操作即可。可以证明不存在更优的方案。\n\n------------\n\n#### 数据范围\n\n**「本题采用捆绑测试」** \n\n- $\\operatorname{Subtask} 1(10\\%)$：$n,m,k \\leq 8$。\n\n- $\\operatorname{Subtask} 2(30\\%)$：$m\\leq 50,k\\leq 100$。\n\n- $\\operatorname{Subtask} 3(20\\%)$：$m\\leq 50,k\\leq 1000$。\n\n- $\\operatorname{Subtask} 4(40\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据满足：$3 \\leq n\\leq 50$，$1 \\leq m \\leq 300$，$0 \\leq k \\leq 2000$，$C,G_{i,j},A_i,B_i \\leq 10^6$。\n\n**本题输入量较大，请用较快的输入方法。**\n\n------------\n\n#### 提示\n\n- 本题不卡常，如果你认为自己的算法差一点就能跑过下一个 Subtask 却没有跑过，那么请不要纠结于无意义的卡常，因为差的这一点可能需要更优秀的算法来弥补。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DROI」Round 1 失控", "background": "失控的，或许反而是理智的。", "description": "给定一个 $n \\times m$ 的矩阵 $G$ 和两个长度为 $m$ 的排列 $p,q$。\n\n我们称元素 $G_{i,j}$ 是**失控的**，当且仅当 $\\vert G_{i,j} - G_{i-1,p_j} \\vert > C$ **且** $\\vert G_{i,j} - G_{i+1,q_j} \\vert > C$，其中 $C$ 是给定的常数。特殊地，我们规定无论如何第 $1$ 行和第 $n$ 行的元素都不是失控的。\n\n此时再给定两个长度为 $k$ 的序列 $A$ 和 $B$。\n\n你将有 $k$ 种操作：其中第 $i$ 种操作是将某一行所有元素增加 $A_i$，这将会花费 $B_i$ 的代价。**每种操作可以使用的次数不限，但对于每一行，你只可以进行这些操作中的一种或不操作。并且，你必须保证任意相邻两行最多有一行进行操作。**\n\n请问要使得矩阵 $G$ 中所有元素均不失控，至少要花费的代价是多少（数据保证有解）？", "inputFormat": "第一行四个整数，分别为 $n,m,k,C$。\n\n接下来 $n+4$ 行，前 $n$ 行每行 $m$ 个数，表示矩阵 $G$，第 $n+1$ 和 $n+2$ 行每行 $m$ 个数，分别表示排列 $p$ 和 $q$，最后两行每行 $k$ 个数，分别表示序列 $A$ 和 $B$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "#### 样例解释 #1\n\n显然对于样例一，不用进行任何操作就能保证所有元素均不失控。\n\n------------\n\n#### 样例解释 #2\n\n对第三行使用 $3$ 操作，对第七行使用 $4$ 操作即可。可以证明不存在更优的方案。\n\n------------\n\n#### 数据范围\n\n**「本题采用捆绑测试」** \n\n- $\\operatorname{Subtask} 1(10\\%)$：$n,m,k \\leq 8$。\n\n- $\\operatorname{Subtask} 2(30\\%)$：$m\\leq 50,k\\leq 100$。\n\n- $\\operatorname{Subtask} 3(20\\%)$：$m\\leq 50,k\\leq 1000$。\n\n- $\\operatorname{Subtask} 4(40\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据满足：$3 \\leq n\\leq 50$，$1 \\leq m \\leq 300$，$0 \\leq k \\leq 2000$，$C,G_{i,j},A_i,B_i \\leq 10^6$。\n\n**本题输入量较大，请用较快的输入方法。**\n\n------------\n\n#### 提示\n\n- 本题不卡常，如果你认为自己的算法差一点就能跑过下一个 Subtask 却没有跑过，那么请不要纠结于无意义的卡常，因为差的这一点可能需要更优秀的算法来弥补。", "locale": "zh-CN"}}}
{"pid": "P8984", "type": "P", "difficulty": 7, "samples": [["3 2", "1\n0 2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "Special Judge", "O2优化", "CTT（清华集训/北大集训）"], "title": "[北大集训 2021] 末日魔法少女计划", "background": "CTT2021 D1T1", "description": "对于给定的 $n,k$，你需要构造一个只含 $0,1$ 的矩阵 $A_{i,j}$，$0\\le i,j\\le n$，满足：\n\n1. $A_{i,i}=1$；\n2. $A_{i,i+1}=1$；\n3. 对 $i>j$ 有 $A_{i,j}=0$；\n4. 若 $A_{i,j}=1$，$j-i>1$，则存在 $i<t<j$，满足 $A_{i,t}=A_{t,j}=1$；\n5. 对 $i\\le j$ 有 $(A^k)_{i,j}>0$。\n\n你需要输出满足 $A_{i,j}=1$ 且 $j-i>1$ 的每个 $(i,j)$，设这样的 $(i,j)$ 共有 $m$ 个。\n\n若输出不满足要求，则不能得到该测试点的任何分数。若输出满足要求，则根据 $m$ 进行评分。\n", "inputFormat": "一行，两个整数 $n,k$。\n", "outputFormat": "第一行一个整数 $m$，接下来 $m$ 行，每行两个整数 $i,j$，依次表示每个满足 $A_{i,j}=1$ 且 $j-i>1$ 的二元组 $(i,j)$。", "hint": "- $1900\\le n\\le 2000$；\n- $2\\le k\\le 15$。\n\n| $k$  |  $f(k)$  | $s(k)$ |\n| :--: | :------: | :----: |\n| $2$  | $7.9870$ |  $22$  |\n| $3$  | $3.8085$ |  $14$  |\n| $4$  | $2.3960$ |  $11$  |\n| $5$  | $1.9610$ |  $9$   |\n| $6$  | $1.6065$ |  $7$   |\n| $7$  | $1.4515$ |  $6$   |\n| $8$  | $1.2540$ |  $5$   |\n| $9$  | $1.1980$ |  $5 $   |\n| $10$ | $1.0995$ |  $4$   |\n| $11$ | $1.0705$ |  $4 $   |\n| $12$ | $1.0345$ |  $4$   |\n| $13$ | $1.0120$ |  $3$   |\n| $14$ | $1.0015$ |  $3 $   |\n| $15$ | $0.9940$ |  $3$   |\n\n\n\n每个 $2\\le k\\le 15$ 对应一个总分为 $s(k)$ 的子任务，每个子任务的得分是子任务中每个测试点的得分的最小值。\n\n每个测试点的得分为所在子任务的总分的 $\\max\\left(0,1-\\sqrt{\\max\\left(0,\\frac{m}{n\\cdot f(k)}-1\\right)}\\right)$ 倍。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[北大集训 2021] 末日魔法少女计划", "background": "CTT2021 D1T1", "description": "对于给定的 $n,k$，你需要构造一个只含 $0,1$ 的矩阵 $A_{i,j}$，$0\\le i,j\\le n$，满足：\n\n1. $A_{i,i}=1$；\n2. $A_{i,i+1}=1$；\n3. 对 $i>j$ 有 $A_{i,j}=0$；\n4. 若 $A_{i,j}=1$，$j-i>1$，则存在 $i<t<j$，满足 $A_{i,t}=A_{t,j}=1$；\n5. 对 $i\\le j$ 有 $(A^k)_{i,j}>0$。\n\n你需要输出满足 $A_{i,j}=1$ 且 $j-i>1$ 的每个 $(i,j)$，设这样的 $(i,j)$ 共有 $m$ 个。\n\n若输出不满足要求，则不能得到该测试点的任何分数。若输出满足要求，则根据 $m$ 进行评分。\n", "inputFormat": "一行，两个整数 $n,k$。\n", "outputFormat": "第一行一个整数 $m$，接下来 $m$ 行，每行两个整数 $i,j$，依次表示每个满足 $A_{i,j}=1$ 且 $j-i>1$ 的二元组 $(i,j)$。", "hint": "- $1900\\le n\\le 2000$；\n- $2\\le k\\le 15$。\n\n| $k$  |  $f(k)$  | $s(k)$ |\n| :--: | :------: | :----: |\n| $2$  | $7.9870$ |  $22$  |\n| $3$  | $3.8085$ |  $14$  |\n| $4$  | $2.3960$ |  $11$  |\n| $5$  | $1.9610$ |  $9$   |\n| $6$  | $1.6065$ |  $7$   |\n| $7$  | $1.4515$ |  $6$   |\n| $8$  | $1.2540$ |  $5$   |\n| $9$  | $1.1980$ |  $5 $   |\n| $10$ | $1.0995$ |  $4$   |\n| $11$ | $1.0705$ |  $4 $   |\n| $12$ | $1.0345$ |  $4$   |\n| $13$ | $1.0120$ |  $3$   |\n| $14$ | $1.0015$ |  $3 $   |\n| $15$ | $0.9940$ |  $3$   |\n\n\n\n每个 $2\\le k\\le 15$ 对应一个总分为 $s(k)$ 的子任务，每个子任务的得分是子任务中每个测试点的得分的最小值。\n\n每个测试点的得分为所在子任务的总分的 $\\max\\left(0,1-\\sqrt{\\max\\left(0,\\frac{m}{n\\cdot f(k)}-1\\right)}\\right)$ 倍。\n", "locale": "zh-CN"}}}
{"pid": "P8985", "type": "P", "difficulty": 7, "samples": [["10\n+ 2 1 1 3 4\n+ 1 2 2 2 5\n? 2 2 2\n+ 1 1 1 8 2\n? 2 2 1\n? 1 2 2\n- 1\n? 2 2 2\n- 3\n? 1 2 2\n", "2\n7\n5\n5\n2\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "CTT（清华集训/北大集训）"], "title": "[北大集训 2021] 魔塔 OL", "background": "CTT2021 D1T2", "description": "比特游戏公司最近发布了一款新游戏《魔塔 Online》，玩家可以操控勇士在游戏世界中与怪物进行搏斗。在游戏发布之初，魔塔里没有任何怪物，接下来将依次发生 $q$ 个事件，每个事件是以下三种之一：\n\n* `+ x y z a b`：表示游戏发布了新版本，在游戏中新增了一只怪物。如果这是第一只新增的怪物，那么它的编号为 $1$；否则它的编号为最后一只新增的怪物的编号 $+1$。这只怪物位于魔塔的第 $x$ 层，它的等级为 $y$ 级，它的难度为 $z$。如果玩家选择击杀这只怪物，那么需要消耗 $a$ 点血量，在击杀成功后，玩家将得到一支可以恢复 $b$ 点血量的药剂并立即使用。\n* `- k`：表示游戏发布了新版本，编号为 $k$ 的怪物由于平衡性问题下架，它将不会出现在魔塔中。请注意：下架的怪物**仍然保留它们的编号**，未来新增的怪物**不会复用**被下架怪物的编号。\n* `? g l d`：表示一个询问。某玩家希望击杀魔塔前 $g$ 层中**所有**等级**不超过** $l$ 且难度**不超过** $d$ 的怪物。玩家可以按照**任意顺序**去击杀这些怪物，登上新的一层**不需要杀光**当前层的所有怪物，且作战过程中不会受到别的怪物的干扰。你的任务是帮助该玩家计算出征前勇士的血量**最少**是多少。如果某个时刻勇士的血量是**负数**，那么游戏结束，你一定要防止这种情况的发生。\n\n请写一个程序，依次回答每个询问。注意：每个询问只是玩家的一个思考，**不会真正击杀**任何一只怪物。", "inputFormat": "输入的第一行包含一个整数 $q$，表示事件数。\n\n接下来 $q$ 行，每行开头一个字符，随后是几个整数，依次描述每个事件。\n\n输入数据保证 $1\\leq q\\leq 150\\,000$，怪物总数不超过 $50\\,000$，询问数量不超过 $50\\,000$。\n\n对于新增怪物操作，保证 $1\\leq x,y,z\\leq 10\\,000$，且 $0\\leq a,b\\leq 10^9$。\n\n对于下架怪物操作，保证操作合法，且每只怪物不会被重复下架。\n\n对于询问，保证 $1\\leq g,l,d\\leq 10\\,000$。", "outputFormat": "对于每个询问，输出一行一个整数，即出征前勇士的血量的最小值。", "hint": "1. （3 分）怪物总数不超过 $8$，询问数量不超过 $8$。\n2. （7 分）怪物总数不超过 $5\\,000$，询问数量不超过 $5\\,000$。\n3. （10 分）药剂不会回血，且所有怪物的难度都是 $1$。即 $b=0$，且 $z=d=1$。\n4. （17 分）$1\\leq x,y,z,g,l,d\\leq 5$。\n5. （30 分）所有怪物的等级和难度都是 $1$。即 $y=z=l=d=1$。\n6. （33 分）无其他限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[北大集训 2021] 魔塔 OL", "background": "CTT2021 D1T2", "description": "比特游戏公司最近发布了一款新游戏《魔塔 Online》，玩家可以操控勇士在游戏世界中与怪物进行搏斗。在游戏发布之初，魔塔里没有任何怪物，接下来将依次发生 $q$ 个事件，每个事件是以下三种之一：\n\n* `+ x y z a b`：表示游戏发布了新版本，在游戏中新增了一只怪物。如果这是第一只新增的怪物，那么它的编号为 $1$；否则它的编号为最后一只新增的怪物的编号 $+1$。这只怪物位于魔塔的第 $x$ 层，它的等级为 $y$ 级，它的难度为 $z$。如果玩家选择击杀这只怪物，那么需要消耗 $a$ 点血量，在击杀成功后，玩家将得到一支可以恢复 $b$ 点血量的药剂并立即使用。\n* `- k`：表示游戏发布了新版本，编号为 $k$ 的怪物由于平衡性问题下架，它将不会出现在魔塔中。请注意：下架的怪物**仍然保留它们的编号**，未来新增的怪物**不会复用**被下架怪物的编号。\n* `? g l d`：表示一个询问。某玩家希望击杀魔塔前 $g$ 层中**所有**等级**不超过** $l$ 且难度**不超过** $d$ 的怪物。玩家可以按照**任意顺序**去击杀这些怪物，登上新的一层**不需要杀光**当前层的所有怪物，且作战过程中不会受到别的怪物的干扰。你的任务是帮助该玩家计算出征前勇士的血量**最少**是多少。如果某个时刻勇士的血量是**负数**，那么游戏结束，你一定要防止这种情况的发生。\n\n请写一个程序，依次回答每个询问。注意：每个询问只是玩家的一个思考，**不会真正击杀**任何一只怪物。", "inputFormat": "输入的第一行包含一个整数 $q$，表示事件数。\n\n接下来 $q$ 行，每行开头一个字符，随后是几个整数，依次描述每个事件。\n\n输入数据保证 $1\\leq q\\leq 150\\,000$，怪物总数不超过 $50\\,000$，询问数量不超过 $50\\,000$。\n\n对于新增怪物操作，保证 $1\\leq x,y,z\\leq 10\\,000$，且 $0\\leq a,b\\leq 10^9$。\n\n对于下架怪物操作，保证操作合法，且每只怪物不会被重复下架。\n\n对于询问，保证 $1\\leq g,l,d\\leq 10\\,000$。", "outputFormat": "对于每个询问，输出一行一个整数，即出征前勇士的血量的最小值。", "hint": "1. （3 分）怪物总数不超过 $8$，询问数量不超过 $8$。\n2. （7 分）怪物总数不超过 $5\\,000$，询问数量不超过 $5\\,000$。\n3. （10 分）药剂不会回血，且所有怪物的难度都是 $1$。即 $b=0$，且 $z=d=1$。\n4. （17 分）$1\\leq x,y,z,g,l,d\\leq 5$。\n5. （30 分）所有怪物的等级和难度都是 $1$。即 $y=z=l=d=1$。\n6. （33 分）无其他限制。\n", "locale": "zh-CN"}}}
{"pid": "P8986", "type": "P", "difficulty": 5, "samples": [["10 4 6\n2 1 4 7 4 8 3 6 4 8\n", "6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "二分", "2021", "O2优化", "CTT（清华集训/北大集训）", "双指针 two-pointer"], "title": "[北大集训 2021] 基因编辑", "background": "CTT2021 D1T3", "description": "人类目前已经研究出了多种基因编辑技术，其中最传统的一种技术需要用到“限制性核酸内切酶”（简称限制酶）。这种酶能够识别特定的核苷酸序列，并在指定的位点上切割连接相邻核苷酸的磷酸二酯键，产生被称为“末端”的序列切口。只有相匹配的末端才能用 DNA 连接酶进行连接。\n\n假设现在要用基因片段 $A$ 去替换某一载体 $V$ 上的基因片段 $B$。在使用限制酶的编辑技术中，通常需要进行以下操作：\n\n1. 在基因 $A$ 的两端各选择一种限制酶识别位点。这两处识别位点在基因 $B$ 的两端也应当相应存在。\n2. 用所选择的识别位点对应的限制酶对基因 $A$ 进行处理，使得其两端产生相应的末端。将处理后的基因 $A$ 提纯。\n3. 用同样的限制酶切断载体 $V$ 上的识别位点，使得基因 $B$ 与载体 $V$ 断开。纯化出去除了基因 $B$ 的载体 $V'$。\n4. 将载体 $V'$ 与基因 $A$ 混合，并在 DNA 连接酶的帮助下将断开的磷酸二酯键重新接上。\n\n值得一提的是，如果两处识别位点断开后产生了相同的末端，那么在第 4 步中载体 $V'$ 有可能单独连接起来，产生了不包含基因 $A$ 或 $B$ 的载体；也有可能基因 $A$ 反向接入 $V'$，同样产生错误的载体。因此，在实际运用中，通常选取产生不同末端的限制酶对基因 $A$ 和载体 $V$ 进行处理。\n\n公元 3032 年，人类发现了一种掌握了基因编辑技术的外星文明 HD1048576d。当然，这种基因编辑的技术仅限于居住在 HD1048576d 这颗行星上的外星生物的基因。我们人类掌握的基因编辑技术可识别的最小单位是 DNA 序列上的单个碱基，而外星文明的基因编辑技术可识别的最小单位是其基因序列上的单个 noicleobase。出于方便起见，我们可以将单个 noicleobase 用从 $1$ 开始的正整数表示，那么一段外星生命的基因序列就可以被表示成相应的正整数序列。\n\n对于一段长度为 $n$ 的外星生命的基因序列（不妨记其正整数表示为 $s_1, s_2, \\cdots, s_n$），外星文明 HD1048576d 的基因编辑过程如下：\n\n1. 选择一段要编辑的区域 $[l, r]$，即原位替换原序列中 $s_l, s_{l+1}, \\cdots, s_r$ 这部分子序列；\n2. 挑选一对跨过待替换区域的下标 $(i, j)$（即 $1\\le i<l$ 且 $r<j\\le n$），批量生产出 $s_i, \\cdots, s_j$ 这段子序列在编辑后对应的新序列 $s_i, \\cdots, s_{l-1}, t_1, \\cdots, t_k, s_{r+1}, \\cdots, s_j$；\n3. 通过对应的特异性识别工具，将 $s_i, \\cdots, s_j$ 这段子序列从原序列中断开，并将 $s_i, \\cdots, s_{l-1}, t_1, \\cdots, t_k, s_{r+1}, \\cdots, s_j$ 接到序列中，即可得到目标基因序列。\n\n需要注意的是，在步骤 2 中，挑选的这对下标必须对应唯一的 noicleobase 组合。也就是说，能够满足 $s_{i'}=s_i, s_{j'} = s_j$ 且 $i<j$ 的有序对 $\\left(i', j'\\right)$ 必须是唯一的（即为 $(i, j)$），否则特异性识别工具可能切割下其它区段的基因序列；另外，$s_i\\ne s_j$，否则特异性识别工具可能只切割下单个 noicleobase。\n\n另外，由于替换时需要生产新的基因序列，而生产这样的序列需要不小的开销，所以外星文明希望能够最小化需要生产的基因序列长度。显然，最小化这一长度等价于最小化被切割下来的基因子序列的长度，所以实践中一般是通过最小化被切割下来的基因子序列长度来计算最优解的。\n\n现在，他们想考考人类文明的智力水平，于是你被他们从众多高中生中挑选出来解决这一问题。", "inputFormat": "输入的第一行包含三个正整数 $n, l, r$，表示待编辑的基因序列的长度，需要编辑的区域的左端点，和需要编辑的区域的右端点。保证 $3\\le n\\le 10^6$ 且 $1<l\\le r < n$。\n\n输入的第二行包含 $n$ 个正整数 $s_1, \\cdots, s_n$，表示用正整数表示的待编辑的基因序列。保证每个 noicleobase 的编号 $s_i$ 都在 $[1, 10^6]$ 中。", "outputFormat": "如果存在满足外星文明的基因编辑技术限制的基因序列切割方案，则输出一个正整数，表示输出所有方案中，被切割下来的基因子序列的最小值。否则，输出 `-1`，表示不存在满足限制的切割方案。\n", "hint": "最优方案为切割 `1 4 7 4 8 3`。可以证明，没有比这更优秀的满足技术限制的切割方案。\n\n一种比该方案切割长度更短的方案是 `4 7 4 8 3`，但是在这种方案中特异性识别工具可能会断开 `4 8 3`，从而导致产生的目标基因序列出现意外的突变，因此这种切割方案不满足技术限制。\n\n---\n\n对于 $100\\%$ 的数据，保证 $3\\le n \\le 10^6$，$\\forall 1\\le i\\le n, 1\\le s_i\\le 10^6$，且 $1<l\\le r<n$。\n\n本题共有 5 个子任务，你需要通过一个子任务中的所有测试点才能获得该子任务的相应分数。下表为各子任务的数据规模及性质。\n\n| 子任务编号 | 对应分数 | $n\\le$ | $s_i\\le$ | 特殊性质 |\n| :--------: | :------: | :----: | :------: | :------: |\n|    $1$     |   $5$    | $1000$ |  $1000$  | $\\times$ |\n|    $2$     |   $10$   | $1000$ |  $10^6$  | $\\times$ |\n|    $3$     |   $25$   | $10^6$ |  $1000$  | $\\times$ |\n|    $4$     |   $30$   | $10^6$ |  $10^6$  | $\\surd$  |\n|    $5$     |   $30 $   | $10^6$ |  $10^6$  | $\\times$ |\n\n\n\n上表中的“特殊性质”为：$s_1, \\cdots, s_{l - 1}$ 各不相同，且 $s_{r + 1}, \\cdots, s_n$ 各不相同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[北大集训 2021] 基因编辑", "background": "CTT2021 D1T3", "description": "人类目前已经研究出了多种基因编辑技术，其中最传统的一种技术需要用到“限制性核酸内切酶”（简称限制酶）。这种酶能够识别特定的核苷酸序列，并在指定的位点上切割连接相邻核苷酸的磷酸二酯键，产生被称为“末端”的序列切口。只有相匹配的末端才能用 DNA 连接酶进行连接。\n\n假设现在要用基因片段 $A$ 去替换某一载体 $V$ 上的基因片段 $B$。在使用限制酶的编辑技术中，通常需要进行以下操作：\n\n1. 在基因 $A$ 的两端各选择一种限制酶识别位点。这两处识别位点在基因 $B$ 的两端也应当相应存在。\n2. 用所选择的识别位点对应的限制酶对基因 $A$ 进行处理，使得其两端产生相应的末端。将处理后的基因 $A$ 提纯。\n3. 用同样的限制酶切断载体 $V$ 上的识别位点，使得基因 $B$ 与载体 $V$ 断开。纯化出去除了基因 $B$ 的载体 $V'$。\n4. 将载体 $V'$ 与基因 $A$ 混合，并在 DNA 连接酶的帮助下将断开的磷酸二酯键重新接上。\n\n值得一提的是，如果两处识别位点断开后产生了相同的末端，那么在第 4 步中载体 $V'$ 有可能单独连接起来，产生了不包含基因 $A$ 或 $B$ 的载体；也有可能基因 $A$ 反向接入 $V'$，同样产生错误的载体。因此，在实际运用中，通常选取产生不同末端的限制酶对基因 $A$ 和载体 $V$ 进行处理。\n\n公元 3032 年，人类发现了一种掌握了基因编辑技术的外星文明 HD1048576d。当然，这种基因编辑的技术仅限于居住在 HD1048576d 这颗行星上的外星生物的基因。我们人类掌握的基因编辑技术可识别的最小单位是 DNA 序列上的单个碱基，而外星文明的基因编辑技术可识别的最小单位是其基因序列上的单个 noicleobase。出于方便起见，我们可以将单个 noicleobase 用从 $1$ 开始的正整数表示，那么一段外星生命的基因序列就可以被表示成相应的正整数序列。\n\n对于一段长度为 $n$ 的外星生命的基因序列（不妨记其正整数表示为 $s_1, s_2, \\cdots, s_n$），外星文明 HD1048576d 的基因编辑过程如下：\n\n1. 选择一段要编辑的区域 $[l, r]$，即原位替换原序列中 $s_l, s_{l+1}, \\cdots, s_r$ 这部分子序列；\n2. 挑选一对跨过待替换区域的下标 $(i, j)$（即 $1\\le i<l$ 且 $r<j\\le n$），批量生产出 $s_i, \\cdots, s_j$ 这段子序列在编辑后对应的新序列 $s_i, \\cdots, s_{l-1}, t_1, \\cdots, t_k, s_{r+1}, \\cdots, s_j$；\n3. 通过对应的特异性识别工具，将 $s_i, \\cdots, s_j$ 这段子序列从原序列中断开，并将 $s_i, \\cdots, s_{l-1}, t_1, \\cdots, t_k, s_{r+1}, \\cdots, s_j$ 接到序列中，即可得到目标基因序列。\n\n需要注意的是，在步骤 2 中，挑选的这对下标必须对应唯一的 noicleobase 组合。也就是说，能够满足 $s_{i'}=s_i, s_{j'} = s_j$ 且 $i<j$ 的有序对 $\\left(i', j'\\right)$ 必须是唯一的（即为 $(i, j)$），否则特异性识别工具可能切割下其它区段的基因序列；另外，$s_i\\ne s_j$，否则特异性识别工具可能只切割下单个 noicleobase。\n\n另外，由于替换时需要生产新的基因序列，而生产这样的序列需要不小的开销，所以外星文明希望能够最小化需要生产的基因序列长度。显然，最小化这一长度等价于最小化被切割下来的基因子序列的长度，所以实践中一般是通过最小化被切割下来的基因子序列长度来计算最优解的。\n\n现在，他们想考考人类文明的智力水平，于是你被他们从众多高中生中挑选出来解决这一问题。", "inputFormat": "输入的第一行包含三个正整数 $n, l, r$，表示待编辑的基因序列的长度，需要编辑的区域的左端点，和需要编辑的区域的右端点。保证 $3\\le n\\le 10^6$ 且 $1<l\\le r < n$。\n\n输入的第二行包含 $n$ 个正整数 $s_1, \\cdots, s_n$，表示用正整数表示的待编辑的基因序列。保证每个 noicleobase 的编号 $s_i$ 都在 $[1, 10^6]$ 中。", "outputFormat": "如果存在满足外星文明的基因编辑技术限制的基因序列切割方案，则输出一个正整数，表示输出所有方案中，被切割下来的基因子序列的最小值。否则，输出 `-1`，表示不存在满足限制的切割方案。\n", "hint": "最优方案为切割 `1 4 7 4 8 3`。可以证明，没有比这更优秀的满足技术限制的切割方案。\n\n一种比该方案切割长度更短的方案是 `4 7 4 8 3`，但是在这种方案中特异性识别工具可能会断开 `4 8 3`，从而导致产生的目标基因序列出现意外的突变，因此这种切割方案不满足技术限制。\n\n---\n\n对于 $100\\%$ 的数据，保证 $3\\le n \\le 10^6$，$\\forall 1\\le i\\le n, 1\\le s_i\\le 10^6$，且 $1<l\\le r<n$。\n\n本题共有 5 个子任务，你需要通过一个子任务中的所有测试点才能获得该子任务的相应分数。下表为各子任务的数据规模及性质。\n\n| 子任务编号 | 对应分数 | $n\\le$ | $s_i\\le$ | 特殊性质 |\n| :--------: | :------: | :----: | :------: | :------: |\n|    $1$     |   $5$    | $1000$ |  $1000$  | $\\times$ |\n|    $2$     |   $10$   | $1000$ |  $10^6$  | $\\times$ |\n|    $3$     |   $25$   | $10^6$ |  $1000$  | $\\times$ |\n|    $4$     |   $30$   | $10^6$ |  $10^6$  | $\\surd$  |\n|    $5$     |   $30 $   | $10^6$ |  $10^6$  | $\\times$ |\n\n\n\n上表中的“特殊性质”为：$s_1, \\cdots, s_{l - 1}$ 各不相同，且 $s_{r + 1}, \\cdots, s_n$ 各不相同。", "locale": "zh-CN"}}}
{"pid": "P8987", "type": "P", "difficulty": 7, "samples": [["15 15\n6 14 14 6 3 6 4 13 10 3 12 5 11 9 6\n1 9\n1 2\n2\n2\n2\n1 11\n3 4 6\n2\n1 6\n2\n1 9\n1 11\n1 11\n3 4 4\n3 2 13", "33\n9\n107\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "CTT（清华集训/北大集训）"], "title": "[北大集训 2021] 简单数据结构", "background": "CTT2021 D2T1", "description": "小 D 是一位数据结构大师，他特别喜欢研究形式简单的数据结构，今天他想到了这样一道题目：\n\n你有一个长度为 $n$ 的序列 $a$，下面你要进行 $q$ 次修改或询问。\n\n1. 给定 $v$，将所有 $a_i$ 变为 $\\min(a_i, v)$。\n2. 将所有 $a_i$ 变为 $a_i + i$。\n3. 给定 $l, r$，询问 $\\sum_{i=l}^r a_i$。\n\n顶级数据结构大师小 D 轻松的解决了这个问题，现在他打算来考考即将参加 IOI2022 的你，相信你也可以轻松解决这个问题。", "inputFormat": "第一行两个正整数 $n, q$，表示序列的长度与修改/询问的个数。\n\n下面一行 $n$ 个整数 $a_i$，表示初始序列 $a$。\n\n下面 $q$ 行，每行第一个正整数 $op_i$ 表示第 $i$ 次修改/询问的类型。\n\n若 $op_i = 1$，则下面紧跟一个整数 $v_i$，表示进行一次修改 1。\n\n若 $op_i = 2$，则表示进行一次修改 2。\n\n若 $op_i = 3$，则下面紧跟两个正整数 $l_i, r_i$，表示进行一次询问 3。\n", "outputFormat": "若干行，每行一个整数表示答案。", "hint": "| 子任务编号 | 子任务分值 |  $n,q$   |   特殊性质   |\n| :--------: | :--------: | :------: | :----------: |\n|    $1$     |    $10$    |  $5000$  |              |\n|    $2$     |    $20$    | $200000$ |      A       |\n|    $3$     |    $15$    | $200000$ | $op_i\\neq 2$ |\n|    $4$     |    $55$    | $200000$ |              |\n\n\n\n\n$1 \\leq n, q \\leq 2 \\times 10^5$，$0 \\leq a_i, v_i \\leq 10^{12}$。\n\n性质 A 为：$a_i, v_i$ 在 $[0, 10^{12}]$ 随机生成，$op_i$ 在 $[1, 3]$ 随机生成，$[l_i, r_i]$ 在所有可行区间随机生成。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[北大集训 2021] 简单数据结构", "background": "CTT2021 D2T1", "description": "小 D 是一位数据结构大师，他特别喜欢研究形式简单的数据结构，今天他想到了这样一道题目：\n\n你有一个长度为 $n$ 的序列 $a$，下面你要进行 $q$ 次修改或询问。\n\n1. 给定 $v$，将所有 $a_i$ 变为 $\\min(a_i, v)$。\n2. 将所有 $a_i$ 变为 $a_i + i$。\n3. 给定 $l, r$，询问 $\\sum_{i=l}^r a_i$。\n\n顶级数据结构大师小 D 轻松的解决了这个问题，现在他打算来考考即将参加 IOI2022 的你，相信你也可以轻松解决这个问题。", "inputFormat": "第一行两个正整数 $n, q$，表示序列的长度与修改/询问的个数。\n\n下面一行 $n$ 个整数 $a_i$，表示初始序列 $a$。\n\n下面 $q$ 行，每行第一个正整数 $op_i$ 表示第 $i$ 次修改/询问的类型。\n\n若 $op_i = 1$，则下面紧跟一个整数 $v_i$，表示进行一次修改 1。\n\n若 $op_i = 2$，则表示进行一次修改 2。\n\n若 $op_i = 3$，则下面紧跟两个正整数 $l_i, r_i$，表示进行一次询问 3。\n", "outputFormat": "若干行，每行一个整数表示答案。", "hint": "| 子任务编号 | 子任务分值 |  $n,q$   |   特殊性质   |\n| :--------: | :--------: | :------: | :----------: |\n|    $1$     |    $10$    |  $5000$  |              |\n|    $2$     |    $20$    | $200000$ |      A       |\n|    $3$     |    $15$    | $200000$ | $op_i\\neq 2$ |\n|    $4$     |    $55$    | $200000$ |              |\n\n\n\n\n$1 \\leq n, q \\leq 2 \\times 10^5$，$0 \\leq a_i, v_i \\leq 10^{12}$。\n\n性质 A 为：$a_i, v_i$ 在 $[0, 10^{12}]$ 随机生成，$op_i$ 在 $[1, 3]$ 随机生成，$[l_i, r_i]$ 在所有可行区间随机生成。\n", "locale": "zh-CN"}}}
{"pid": "P8988", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "交互题", "Special Judge", "O2优化", "CTT（清华集训/北大集训）"], "title": "[北大集训 2021] Datalab", "background": "CTT2021 D2T2\n\n**特别提醒，由于洛谷交互机制的特殊性，你不能在程序中引用 `datalab.h`，而需要把 `datalab.h` 中的内容加入文件的开头。即，在程序中 `solve` 函数的前面加入以下几行语句：**\n\n```cpp\n#include<bitset>\n#include<vector>\ntypedef std::bitset<8192> Bitset;\nBitset Add(Bitset A,Bitset B);\nstd::vector<int> solve(int k,int LIMIT);\n```", "description": "**这是一道交互题。**\n\n在 AutoLab 平台上有一台奇怪的 $k$ 位计算机，其中 $k$ 是一个固定的常数 $8192 = 2^{13}$。这台计算机的字长恰好为 $\\frac{k}{8} = 1024 = 2^{10}$，且其存储整数的方式如下：\n\n每个整数会存储在连续的 $k$ 个 bit 中。假设将这 $k$ 个连续 bit 的值按照下标从小到大顺次排列后得到的长度为 $k$ 的 01 字符串为 $S$。假设 $S$ 的下标从 $0$ 开始，则这个字符串 $S$ 对应的整数值为 $f(S) = \\sum \\limits_{i=0}^{k-1} [S_i=1] sgn_i 2^i$，其中 $sgn$ 是一个小 W 预先定义的长度为 $k$ 的数组，其下标从 $0$ 开始且 $\\forall 0 \\le i < k,sgn_i \\in \\{-1,1\\}$。出于某些特殊的原因，这台计算机上保证了 $sgn_{k-1} = 1$，$sgn_{k-2} = -1$。而你不知道 $sgn_0,sgn_1,\\cdots,sgn_{k-3}$ 的值。\n\n假设 $L = \\sum \\limits_{i=0}^{k-1} \\min\\{0,sgn_i\\} 2^i$，$R = \\sum \\limits_{i=0}^{k-1} \\max\\{0,sgn_i\\} 2^i$，则发现 $\\forall L \\le x \\le R$，恰好有一个长度为 $k$ 的 01 字符串 $f(T)$，使得 $f(T) = x$（证明略去）。不妨设所有 $[L,R]$ 内的整数构成的集合为 $S$，则 $f$ 是一个从 $\\{0,1\\}^n$ 到 $S$ 的双射。据此我们可以设 $f(x)$ 的反函数 $g(x)$ 存在，且其满足 $\\forall x \\in S,f(g(x)) = x$。\n\n假设存在 $x,y \\in S$ ，则在该计算机上两个整数之间的加法 $\\oplus$ 被定义为 $x \\oplus y \\overset{def}{=} (x + y - L + 2^k) \\bmod 2^k + L$。不难发现 $\\forall x,y \\in S,x \\oplus y \\in S$。因而在这台计算机上加法满足封闭性。同时按照如上规则定义的加法也满足交换律，结合律等性质。这些性质的证明也同样略去。\n\n学生可以通过有限次的询问获得和 $sgn_i$ 相关的信息。每次询问你可以给计算机两个长度为 $k$ 的仅包含 $0,1$ 的字符串 $x,y$，而计算机会返回 $g(f(x) \\oplus f(y))$ 的值。本次的作业要求是在不超过 $m$ 次的询问中求出 $sgn_0,sgn_1,\\cdots,sgn_{k-3}$ 的准确值。\n\n小 Z 是一名聪明绝顶的学生，因而他尝试使用他的 $10^3 \\mathrm{Hz}$ 的超强大脑来手算出每次交互的值。但是他发现给他的处理速度还是跟不上庞大的数据规模。因而它请你帮忙写一个程序，帮助他更快速的完成本次的作业。\n\n---\n\n### 任务\n\n你不需要，也不应该实现主函数，你只需要实现如下一个函数：\n\n1. `std::vector<int> solve(int k,int m)`：\n\n\t- 传入数字的是计算机的字长 $k$ 和询问次数限制 $\\mathrm{m}$。\n\t- 你需要返回一个大小为 $k$ 的 `vector`，其第 $i$ 个元素代表你确定的 $sgn_i$ 的值。\n\n你可以通过如下函数调用 Autolab 上的加法操作。\n\n1. `std::bitset<8192> Add(std::bitset<8192> x,std::bitset<8192> y)`：\n\t- 给定两个大小为 $k$ 的 bitset, 每个 bitset 自低位向高位阅读的结果代表了一个长度为 $k$ 的仅包含 01 的字符串。\n\t- 返回一个大小为 $k$ 的 bitset, 表示 $g(f(x) \\oplus f(y))$ 的值。返回的格式和输入的格式相同。\n\n根据题目要求，你至多只能询问 $\\mathrm{m}$ 次两个整数在这台计算机上的加法结果。也就是说你至多只能调用 $\\mathrm{m}$ 次 `Add` 函数。\n\n评测时，交互库会**恰好**调用 `solve` 一次。\n\n**本题保证所使用的数组 `sgn` 在开始之前已经完全确定，不会根据和你的程序的交互过程动态构造，因此题目中的交互操作都是确定性的，你不需要关心这些操作在交互库中的具体实现。**\n\n**数据保证在调用次数限制下，交互库运行所需的时间不超过 1s；交互库使用的内存大小固定，且不超过 128MB。**\n\n---\n\n### 如何测试你的程序\n\n**试题目录下的 `grader.cpp` 是我们提供的交互库参考实现，最终测试时所用的交互库实现与该参考实现有所不同，因此选手的解法不应该依赖交互库实现。**\n\n1. 你需要在本题目录下使用如下命令编译得到可执行程序：\n   - `g++ grader.cpp sample.cpp -o sample -O2 -lm`\n\n2. 对于编译得到的可执行程序：\n   - 可执行文件将从**标准输入**读入以下格式的数据：\n     - 第一行包含两个整数 $k,\\mathrm{m}$。\n     - 接下来一行 $k$ 个整数，第 $i$ 个数字表示 $sgn_i$。\n   - 读入完成之后，交互库将调用恰好一次函数 $\\texttt{solve}$ 你的函数正确返回后，交互库会判断你的计算是否正确，若正确则会输出 `Correct` 和交互函数调用次数相关信息，否则会输出相应的错误信息。\n\n试题目录下有出题人提供的一份参考代码 `sample.cpp`，注意这份代码 **不保证可以通过所有的测试用例**。\n\n---\n\n### 样例一、二\n\n见附件下载。\n\n这两个样例满足可执行程序的输入格式，因而可以直接输入到可执行程序中。", "inputFormat": "", "outputFormat": "", "hint": "### 评分方式\n\n| subtask | $k$ | $m$ |\n| :----------: | :----------: | :----------: |\n| 1 | $=8192=2^{13}$ | $=8200$ |\n| 2 | $=8192=2^{13}$ | $=5550$ |\n| 3 | $=8192=2^{13}$ | $=4096=2^{12}$ |\n\n对于任意一个子任务中的数据，如果在某一个数据上选手返回了错误的答案，或者是超出了询问次数限制，得分为 $0$。\n\n否则假设在子任务内所有测试点中，询问次数的最大值为 $a$，则对于每个子任务，选手得分为：\n\n- Subtask $1$: $10$\n- Subtask $2$: $15$\n- Subtask $3$: $\\min \\{75,\\lfloor \\frac{13800}{\\max\\{a,1\\}} \\rfloor \\}$\n\n换而言之，当且仅当 $a \\le 184$ 的时候，Subtask $3$ 可以获得满分。\n\n选手在本题为本题三个子任务的得分之和。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[北大集训 2021] Datalab", "background": "CTT2021 D2T2\n\n**特别提醒，由于洛谷交互机制的特殊性，你不能在程序中引用 `datalab.h`，而需要把 `datalab.h` 中的内容加入文件的开头。即，在程序中 `solve` 函数的前面加入以下几行语句：**\n\n```cpp\n#include<bitset>\n#include<vector>\ntypedef std::bitset<8192> Bitset;\nBitset Add(Bitset A,Bitset B);\nstd::vector<int> solve(int k,int LIMIT);\n```", "description": "**这是一道交互题。**\n\n在 AutoLab 平台上有一台奇怪的 $k$ 位计算机，其中 $k$ 是一个固定的常数 $8192 = 2^{13}$。这台计算机的字长恰好为 $\\frac{k}{8} = 1024 = 2^{10}$，且其存储整数的方式如下：\n\n每个整数会存储在连续的 $k$ 个 bit 中。假设将这 $k$ 个连续 bit 的值按照下标从小到大顺次排列后得到的长度为 $k$ 的 01 字符串为 $S$。假设 $S$ 的下标从 $0$ 开始，则这个字符串 $S$ 对应的整数值为 $f(S) = \\sum \\limits_{i=0}^{k-1} [S_i=1] sgn_i 2^i$，其中 $sgn$ 是一个小 W 预先定义的长度为 $k$ 的数组，其下标从 $0$ 开始且 $\\forall 0 \\le i < k,sgn_i \\in \\{-1,1\\}$。出于某些特殊的原因，这台计算机上保证了 $sgn_{k-1} = 1$，$sgn_{k-2} = -1$。而你不知道 $sgn_0,sgn_1,\\cdots,sgn_{k-3}$ 的值。\n\n假设 $L = \\sum \\limits_{i=0}^{k-1} \\min\\{0,sgn_i\\} 2^i$，$R = \\sum \\limits_{i=0}^{k-1} \\max\\{0,sgn_i\\} 2^i$，则发现 $\\forall L \\le x \\le R$，恰好有一个长度为 $k$ 的 01 字符串 $f(T)$，使得 $f(T) = x$（证明略去）。不妨设所有 $[L,R]$ 内的整数构成的集合为 $S$，则 $f$ 是一个从 $\\{0,1\\}^n$ 到 $S$ 的双射。据此我们可以设 $f(x)$ 的反函数 $g(x)$ 存在，且其满足 $\\forall x \\in S,f(g(x)) = x$。\n\n假设存在 $x,y \\in S$ ，则在该计算机上两个整数之间的加法 $\\oplus$ 被定义为 $x \\oplus y \\overset{def}{=} (x + y - L + 2^k) \\bmod 2^k + L$。不难发现 $\\forall x,y \\in S,x \\oplus y \\in S$。因而在这台计算机上加法满足封闭性。同时按照如上规则定义的加法也满足交换律，结合律等性质。这些性质的证明也同样略去。\n\n学生可以通过有限次的询问获得和 $sgn_i$ 相关的信息。每次询问你可以给计算机两个长度为 $k$ 的仅包含 $0,1$ 的字符串 $x,y$，而计算机会返回 $g(f(x) \\oplus f(y))$ 的值。本次的作业要求是在不超过 $m$ 次的询问中求出 $sgn_0,sgn_1,\\cdots,sgn_{k-3}$ 的准确值。\n\n小 Z 是一名聪明绝顶的学生，因而他尝试使用他的 $10^3 \\mathrm{Hz}$ 的超强大脑来手算出每次交互的值。但是他发现给他的处理速度还是跟不上庞大的数据规模。因而它请你帮忙写一个程序，帮助他更快速的完成本次的作业。\n\n---\n\n### 任务\n\n你不需要，也不应该实现主函数，你只需要实现如下一个函数：\n\n1. `std::vector<int> solve(int k,int m)`：\n\n\t- 传入数字的是计算机的字长 $k$ 和询问次数限制 $\\mathrm{m}$。\n\t- 你需要返回一个大小为 $k$ 的 `vector`，其第 $i$ 个元素代表你确定的 $sgn_i$ 的值。\n\n你可以通过如下函数调用 Autolab 上的加法操作。\n\n1. `std::bitset<8192> Add(std::bitset<8192> x,std::bitset<8192> y)`：\n\t- 给定两个大小为 $k$ 的 bitset, 每个 bitset 自低位向高位阅读的结果代表了一个长度为 $k$ 的仅包含 01 的字符串。\n\t- 返回一个大小为 $k$ 的 bitset, 表示 $g(f(x) \\oplus f(y))$ 的值。返回的格式和输入的格式相同。\n\n根据题目要求，你至多只能询问 $\\mathrm{m}$ 次两个整数在这台计算机上的加法结果。也就是说你至多只能调用 $\\mathrm{m}$ 次 `Add` 函数。\n\n评测时，交互库会**恰好**调用 `solve` 一次。\n\n**本题保证所使用的数组 `sgn` 在开始之前已经完全确定，不会根据和你的程序的交互过程动态构造，因此题目中的交互操作都是确定性的，你不需要关心这些操作在交互库中的具体实现。**\n\n**数据保证在调用次数限制下，交互库运行所需的时间不超过 1s；交互库使用的内存大小固定，且不超过 128MB。**\n\n---\n\n### 如何测试你的程序\n\n**试题目录下的 `grader.cpp` 是我们提供的交互库参考实现，最终测试时所用的交互库实现与该参考实现有所不同，因此选手的解法不应该依赖交互库实现。**\n\n1. 你需要在本题目录下使用如下命令编译得到可执行程序：\n   - `g++ grader.cpp sample.cpp -o sample -O2 -lm`\n\n2. 对于编译得到的可执行程序：\n   - 可执行文件将从**标准输入**读入以下格式的数据：\n     - 第一行包含两个整数 $k,\\mathrm{m}$。\n     - 接下来一行 $k$ 个整数，第 $i$ 个数字表示 $sgn_i$。\n   - 读入完成之后，交互库将调用恰好一次函数 $\\texttt{solve}$ 你的函数正确返回后，交互库会判断你的计算是否正确，若正确则会输出 `Correct` 和交互函数调用次数相关信息，否则会输出相应的错误信息。\n\n试题目录下有出题人提供的一份参考代码 `sample.cpp`，注意这份代码 **不保证可以通过所有的测试用例**。\n\n---\n\n### 样例一、二\n\n见附件下载。\n\n这两个样例满足可执行程序的输入格式，因而可以直接输入到可执行程序中。", "inputFormat": "", "outputFormat": "", "hint": "### 评分方式\n\n| subtask | $k$ | $m$ |\n| :----------: | :----------: | :----------: |\n| 1 | $=8192=2^{13}$ | $=8200$ |\n| 2 | $=8192=2^{13}$ | $=5550$ |\n| 3 | $=8192=2^{13}$ | $=4096=2^{12}$ |\n\n对于任意一个子任务中的数据，如果在某一个数据上选手返回了错误的答案，或者是超出了询问次数限制，得分为 $0$。\n\n否则假设在子任务内所有测试点中，询问次数的最大值为 $a$，则对于每个子任务，选手得分为：\n\n- Subtask $1$: $10$\n- Subtask $2$: $15$\n- Subtask $3$: $\\min \\{75,\\lfloor \\frac{13800}{\\max\\{a,1\\}} \\rfloor \\}$\n\n换而言之，当且仅当 $a \\le 184$ 的时候，Subtask $3$ 可以获得满分。\n\n选手在本题为本题三个子任务的得分之和。", "locale": "zh-CN"}}}
{"pid": "P8989", "type": "P", "difficulty": 6, "samples": [["4\n3 2 97\n10 25 233\n6 12345 2333\n1000000000 1000000000000000000 1000000007 \n", "6\n131\n1206\n161905971\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "O2优化", "CTT（清华集训/北大集训）"], "title": "[北大集训 2021] 随机游走", "background": "CTT2021 D2T3", "description": "给定一张 $n$ 个点的有向图，点标号为 $1,2,\\dots,n$，初始时对 $\\forall i\\in\\{1,2,\\dots,n-1\\}$，从 $i$ 到 $i+1$ 有一条有向边。\n\n你可以在其中再加入 $m$ 条有向边（起点终点任意），允许有重边和自环。\n\n小 A 会从 $1$ 出发，以随机游走的形式行动，直到抵达 $n$。你希望最大化小 A 从 $1$ 移动到 $n$ 的期望步数。\n\n定义随机游走是这样的一种移动方式：设小 A 当前在点 $x$，$x$ 有 $d$ 条出边，则小 A 会从这 $d$ 条出边中**等概率**随机选择一条走过去。", "inputFormat": "输入的第一行包含一个正整数 $T$，表示数据组数，保证 $T \\le 10^5$。\n\n接下来 $T$ 行，每行包含三个整数 $n,m,p$，分别表示有向图的点数、你添加的边数以及答案的模数，保证 $1 \\leq n \\leq 10^9$，$0 \\leq m \\leq 10^{18}$，$2\\leq p\\leq 10^9+7$ 且 $p$ 是质数。\n", "outputFormat": "输出 $T$ 行，第 $i$ 行一个整数 $ans$ 表示第 $i$ 组数据中最大的期望步数对 $p$ 取模后的值（可以证明答案是有理数，设其用最简分数表示为 $\\frac{a}{b}$，则你需要满足 $ans \\cdot b \\bmod p=a$，保证这样的 $ans$ 存在）。", "hint": "| 测试包编号 | $n\\le$ |  $m\\le$   | $T\\le$ | 特殊性质 | 分数 |\n| :--------: | :----: | :-------: | :----: | :------: | :--: |\n|    $1$     |  $5$   |    $5$    |  $10$  |    无    | $10$ |\n|    $2$     |  $5$   |  $10^2$   |  $10$  |    无    | $10 $ |\n|    $3$     | $10^8$ |  $10^2$   | $10^2$ |    无    | $20$ |\n|    $4$     |  $50$  |  $3,000$  |  $3$   |    无    | $20 $ |\n|    $5$     | $10^9$ |  $10^9$   | $10^5$ | $m<n-1$  | $10$ |\n|    $6$     | $10^9$ | $10^{18}$ | $10^5$ |    无    | $30$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[北大集训 2021] 随机游走", "background": "CTT2021 D2T3", "description": "给定一张 $n$ 个点的有向图，点标号为 $1,2,\\dots,n$，初始时对 $\\forall i\\in\\{1,2,\\dots,n-1\\}$，从 $i$ 到 $i+1$ 有一条有向边。\n\n你可以在其中再加入 $m$ 条有向边（起点终点任意），允许有重边和自环。\n\n小 A 会从 $1$ 出发，以随机游走的形式行动，直到抵达 $n$。你希望最大化小 A 从 $1$ 移动到 $n$ 的期望步数。\n\n定义随机游走是这样的一种移动方式：设小 A 当前在点 $x$，$x$ 有 $d$ 条出边，则小 A 会从这 $d$ 条出边中**等概率**随机选择一条走过去。", "inputFormat": "输入的第一行包含一个正整数 $T$，表示数据组数，保证 $T \\le 10^5$。\n\n接下来 $T$ 行，每行包含三个整数 $n,m,p$，分别表示有向图的点数、你添加的边数以及答案的模数，保证 $1 \\leq n \\leq 10^9$，$0 \\leq m \\leq 10^{18}$，$2\\leq p\\leq 10^9+7$ 且 $p$ 是质数。\n", "outputFormat": "输出 $T$ 行，第 $i$ 行一个整数 $ans$ 表示第 $i$ 组数据中最大的期望步数对 $p$ 取模后的值（可以证明答案是有理数，设其用最简分数表示为 $\\frac{a}{b}$，则你需要满足 $ans \\cdot b \\bmod p=a$，保证这样的 $ans$ 存在）。", "hint": "| 测试包编号 | $n\\le$ |  $m\\le$   | $T\\le$ | 特殊性质 | 分数 |\n| :--------: | :----: | :-------: | :----: | :------: | :--: |\n|    $1$     |  $5$   |    $5$    |  $10$  |    无    | $10$ |\n|    $2$     |  $5$   |  $10^2$   |  $10$  |    无    | $10 $ |\n|    $3$     | $10^8$ |  $10^2$   | $10^2$ |    无    | $20$ |\n|    $4$     |  $50$  |  $3,000$  |  $3$   |    无    | $20 $ |\n|    $5$     | $10^9$ |  $10^9$   | $10^5$ | $m<n-1$  | $10$ |\n|    $6$     | $10^9$ | $10^{18}$ | $10^5$ |    无    | $30$ |\n", "locale": "zh-CN"}}}
{"pid": "P8990", "type": "P", "difficulty": 7, "samples": [["10 10\n2 1\n3 1\n4 2\n5 1\n6 4\n7 6\n8 5\n9 4\n10 1\n6 4 2 7 8 9 10 3 5\n6 7 10 7\n1 5 8 9\n1 2 10 8\n10 8 7 6\n2 4 2 9\n8 9 1 5\n5 8 8 2\n2 9 10 8\n10 7 4 10\n10 8 8 9\n", "13\n15\n4\n6\n2\n2\n10\n7\n8\n8\n7\n"], ["10 10\n2 1\n3 2\n4 3\n5 4\n6 2\n7 5\n8 7\n9 1\n10 8\n6 8 3 9 2 5 7 10 4 \n1 9 3 9\n4 5 2 7\n2 7 6 7\n8 10 10 1\n6 7 8 1\n3 9 9 8\n1 2 7 3\n2 3 2 9\n8 1 1 7\n2 9 2 8\n", "3\n2\n2\n1\n2\n4\n4\n3\n3\n3\n3\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "CTT（清华集训/北大集训）"], "title": "[北大集训 2021] 小明的树", "background": "CTT2021 D3T1", "description": "小明有一棵以 $1$ 为根的 $n$ 个节点的树，树上每一个非根节点上有一盏灯，他有一个 $2 \\thicksim n$ 的排列 $a_1,a_2,\\dots,a_{n-1}$。他还有一个计数器，初始为 $0$。\n\n他会按照排列依次点亮这 $n-1$ 盏灯，每进行一次点灯操作后，他会检查整个树是否是美丽的，如果是美丽的，计数器会加上此时点灯的节点形成的连通块的个数。\n\n$n-1$ 次点灯后计数器的值，记为这棵树的答案。\n\t\t\t\t\n\n一个树是美丽的当前仅当对于每一个被点亮的节点，这个节点子树内的节点都是点亮的。\n\n小明认为这个问题太简单了，他觉得应该让树动起来。\n\n在初始查询后，他会删掉树中一条边并加上一条边，保证修改后还是一棵树，他想知道每一次修改后将计数器清零后重新点灯并计数，这棵树的答案是多少。", "inputFormat": "第一行两个数 $n,m$ ,表示树的节点数为 $n$，有 $m$ 次修改。\n\n接下来 $n-1$ 行，每行 $2$ 个数，表示一条边。\n\n下一行 $n-1$ 个数 $a_i$，表示一个 $2 \\thicksim n$ 的排列。\n\n接下来 $m$ 行每行四个数，$x_1,y_1,x_2,y_2$ 表示断开 $x_1,y_1$ 间的边并连接 $x_2,y_2$，保证数据合法。", "outputFormat": "共 $m+1$ 行，第一行表示初始树的答案。\n\n接下来 $m$ 行，表示每次修改后树的答案。", "hint": "- 子任务 $1$（$10$ 分）：保证满足 $2 \\leq n \\leq 500000$，$m = 0$。\n\n- 子任务 $2$（$20$ 分）：保证满足 $2 \\leq n \\leq 8000$，$0 \\leq m \\leq 8000$。\n\n- 子任务 $3$（$70$ 分）：保证满足 $2 \\leq n \\leq 500000$，$0\\leq m \\leq 500000$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[北大集训 2021] 小明的树", "background": "CTT2021 D3T1", "description": "小明有一棵以 $1$ 为根的 $n$ 个节点的树，树上每一个非根节点上有一盏灯，他有一个 $2 \\thicksim n$ 的排列 $a_1,a_2,\\dots,a_{n-1}$。他还有一个计数器，初始为 $0$。\n\n他会按照排列依次点亮这 $n-1$ 盏灯，每进行一次点灯操作后，他会检查整个树是否是美丽的，如果是美丽的，计数器会加上此时点灯的节点形成的连通块的个数。\n\n$n-1$ 次点灯后计数器的值，记为这棵树的答案。\n\t\t\t\t\n\n一个树是美丽的当前仅当对于每一个被点亮的节点，这个节点子树内的节点都是点亮的。\n\n小明认为这个问题太简单了，他觉得应该让树动起来。\n\n在初始查询后，他会删掉树中一条边并加上一条边，保证修改后还是一棵树，他想知道每一次修改后将计数器清零后重新点灯并计数，这棵树的答案是多少。", "inputFormat": "第一行两个数 $n,m$ ,表示树的节点数为 $n$，有 $m$ 次修改。\n\n接下来 $n-1$ 行，每行 $2$ 个数，表示一条边。\n\n下一行 $n-1$ 个数 $a_i$，表示一个 $2 \\thicksim n$ 的排列。\n\n接下来 $m$ 行每行四个数，$x_1,y_1,x_2,y_2$ 表示断开 $x_1,y_1$ 间的边并连接 $x_2,y_2$，保证数据合法。", "outputFormat": "共 $m+1$ 行，第一行表示初始树的答案。\n\n接下来 $m$ 行，表示每次修改后树的答案。", "hint": "- 子任务 $1$（$10$ 分）：保证满足 $2 \\leq n \\leq 500000$，$m = 0$。\n\n- 子任务 $2$（$20$ 分）：保证满足 $2 \\leq n \\leq 8000$，$0 \\leq m \\leq 8000$。\n\n- 子任务 $3$（$70$ 分）：保证满足 $2 \\leq n \\leq 500000$，$0\\leq m \\leq 500000$。\n\n", "locale": "zh-CN"}}}
