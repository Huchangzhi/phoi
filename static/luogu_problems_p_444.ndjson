{"pid": "P10000", "type": "P", "difficulty": 7, "samples": [["1\n1\n5 5 101\n1 2 1\n2 3 100\n3 4 10000\n4 2 1000000\n2 5 10\n", "-1 -1 33333401 -1 33333311\n"], ["见下发文件 ex_matrix1.in", "见下发文件 ex_matrix1.ans"], ["见下发文件 ex_matrix2.in", "见下发文件 ex_matrix2.ans"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["集训队互测", "2023", "O2优化"], "title": "[集训队互测 2023] 矩阵快速幂", "background": "请注意：**本题不是矩阵快速幂模板题**。", "description": "给定一张 $n$ 个点 $m$ 条边的边带权有向图，可能有重边和自环。求从 $1$ 出发到每个点恰好走 $k$ 条边的路径权值的最小值 **对 $998244353$ 取模后的结果**。若路径不存在则输出 $-1$。多组数据。\n\n路径权值的定义是路径上所有边的权值之和。", "inputFormat": "第一行一个整数 $S$ 表示子任务编号。\n\n第二行一个整数 $T$ 表示数据组数。\n\n对于每组数据：\n\n- 第一行三个整数 $n, m, k$。\n- 接下来 $m$ 行，每行三个整数 $u, v, w$ 表示一条有向边。", "outputFormat": "对于每组数据，输出一行 $n$ 个由空格隔开的整数表示答案。", "hint": "- Subtask #1（$10$ 分）：$\\sum n ^ 3\\leq 10 ^ 6$，$k\\leq 10 ^ {18}$。\n- Subtask #2（$15$ 分）：$m = 2n - 2$，且对任意 $1\\leq i < n$，存在权值相等的 $(i, i + 1)$ 和 $(i + 1, i)$。\n- Subtask #3（$20$ 分）：$m\\geq 2n - 2$，且对任意 $(u, v)$，存在权值相等的 $(v, u)$，注意 $u$ 可以等于 $v$。依赖于 Subtask #2。\n- Subtask #4（$15$ 分）：$\\sum n ^ 3\\leq 10 ^ 6$，依赖于 Subtask #1。\n- Subtask #5（$15$ 分）：$k\\leq 10 ^ {18}$，依赖于 Subtask #1。\n- Subtask #6（$25$ 分）：无特殊性质。依赖于 Subtask #3，#4，#5。\n\n对于所有数据，$1\\leq S\\leq 6$，$1\\leq T\\leq 10 ^ 4$，$2\\leq n\\leq 300$，$1\\leq m\\leq 2n$，$1\\leq k\\leq 10 ^ {64}$，$1\\leq u, v\\leq n$，$1\\leq w\\leq 10 ^ {18}$。保证 $\\sum n \\leq 2\\times 10 ^ 5$ 且 $\\sum n ^ 3 \\leq 2.7 \\times 10 ^ 7$。\n\n题解在附件 `paper.pdf` 中。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 矩阵快速幂", "background": "请注意：**本题不是矩阵快速幂模板题**。", "description": "给定一张 $n$ 个点 $m$ 条边的边带权有向图，可能有重边和自环。求从 $1$ 出发到每个点恰好走 $k$ 条边的路径权值的最小值 **对 $998244353$ 取模后的结果**。若路径不存在则输出 $-1$。多组数据。\n\n路径权值的定义是路径上所有边的权值之和。", "inputFormat": "第一行一个整数 $S$ 表示子任务编号。\n\n第二行一个整数 $T$ 表示数据组数。\n\n对于每组数据：\n\n- 第一行三个整数 $n, m, k$。\n- 接下来 $m$ 行，每行三个整数 $u, v, w$ 表示一条有向边。", "outputFormat": "对于每组数据，输出一行 $n$ 个由空格隔开的整数表示答案。", "hint": "- Subtask #1（$10$ 分）：$\\sum n ^ 3\\leq 10 ^ 6$，$k\\leq 10 ^ {18}$。\n- Subtask #2（$15$ 分）：$m = 2n - 2$，且对任意 $1\\leq i < n$，存在权值相等的 $(i, i + 1)$ 和 $(i + 1, i)$。\n- Subtask #3（$20$ 分）：$m\\geq 2n - 2$，且对任意 $(u, v)$，存在权值相等的 $(v, u)$，注意 $u$ 可以等于 $v$。依赖于 Subtask #2。\n- Subtask #4（$15$ 分）：$\\sum n ^ 3\\leq 10 ^ 6$，依赖于 Subtask #1。\n- Subtask #5（$15$ 分）：$k\\leq 10 ^ {18}$，依赖于 Subtask #1。\n- Subtask #6（$25$ 分）：无特殊性质。依赖于 Subtask #3，#4，#5。\n\n对于所有数据，$1\\leq S\\leq 6$，$1\\leq T\\leq 10 ^ 4$，$2\\leq n\\leq 300$，$1\\leq m\\leq 2n$，$1\\leq k\\leq 10 ^ {64}$，$1\\leq u, v\\leq n$，$1\\leq w\\leq 10 ^ {18}$。保证 $\\sum n \\leq 2\\times 10 ^ 5$ 且 $\\sum n ^ 3 \\leq 2.7 \\times 10 ^ 7$。\n\n题解在附件 `paper.pdf` 中。", "locale": "zh-CN"}}}
{"pid": "P10001", "type": "P", "difficulty": 7, "samples": [["4\n6 16 2\n17 14 13 5 13 4\n12 5 5 2 10 2\n6 4 2\n8 1 20 10 4 10\n8 1 15 3 4 6\n5 40 7\n21 47 7 25 47 \n9 26 4 4 39 \n5 151 10\n86 84 164 158 160\n43 42 82 79 80", "34\n34\n95\n463"], ["见附件 ex_shop2.in。", "见附件 ex_shop2.out。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["贪心", "线段树", "集训队互测", "2023"], "title": "[集训队互测 2023] 优惠购物", "background": "", "description": "小 C 要购买 $n$ 个物品，这些物品有前置关系，必须**依次**购买（即在购买了第 $i$ 个后才能购买第 $i+1$ 个）。\n\n他初始有 $m$ 张优惠劵和无穷多个金币。每个物品有两个属性，价格 $a_i$ 和优惠劵的使用上限 $b_i(0\\le b_i\\le a_i)$。\n\n购买一个物品的流程如下：\n\n- 选择使用 $x(0\\le x\\le b_i)$ 张优惠券，付出 $a_i-x$ 个金币和 $x$ 张优惠券。\n- 购买完后可得到 $\\lfloor \\frac{a_i-x}{c} \\rfloor$ 张优惠券（即一次购买中，每付出 $c$ 个金币可以得到一张优惠券，$c$ 为给定常数）\n\n小 C 想求出最少花费多少个金币能购买全部物品。", "inputFormat": "本题包含多组数据，第一行包含一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n- 第一行包含三个整数 $n,m,c$。\n- 第二行包含 $n$ 个整数 $a_1,a_2,...,a_n$ 表示每个物品的价格。\n- 第三行包含 $n$ 个整数 $b_1,b_2,...,b_n$ 表示优惠劵的使用上限。", "outputFormat": "对于每组数据输出一行：\n\n- 第一行输出一个整数，表示最少需要的金币数量。", "hint": "对于所有数据，$1\\le \\sum n\\le 10^6,0\\le m,a_i,b_i\\le 10^9,2\\le c\\le 10^9$。\n\n- Subtask 1 (5 pts)：$1\\le T\\le 5,1\\le n\\le 10,1\\le m,\\sum a_i,\\sum b_i\\le 10$\n- Subtask 2 (10 pts)：$a_i=b_i$\n- Subtask 3 (10 pts)：$1\\le \\sum n\\le 500,1\\le \\sum m,\\sum a_i,\\sum b_i\\le 500$\n- Subtask 4 (10 pts)：$1\\le \\sum n\\le 6000,1\\le \\sum m,\\sum a_i,\\sum b_i\\le 6000$\n- Subtask 5 (10 pts)：$1\\le \\sum n\\le 6000$\n- Subtask 6 (15 pts)：$1\\le \\sum n\\le 2\\times 10^5,2\\le c\\le 20$\n- Subtask 7 (10 pts)：$1\\le \\sum n\\le 1\\times 10^6,2\\le c\\le 20$\n- Subtask 8 (15 pts)：$1\\le \\sum n\\le 2\\times 10^5$\n- Subtask 9 (15 pts)：$1\\le \\sum n\\le 1\\times 10^6$\n\n时间限制：$\\texttt{1s}$\n\n空间限制：$\\texttt{2048MB}$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 优惠购物", "background": "", "description": "小 C 要购买 $n$ 个物品，这些物品有前置关系，必须**依次**购买（即在购买了第 $i$ 个后才能购买第 $i+1$ 个）。\n\n他初始有 $m$ 张优惠劵和无穷多个金币。每个物品有两个属性，价格 $a_i$ 和优惠劵的使用上限 $b_i(0\\le b_i\\le a_i)$。\n\n购买一个物品的流程如下：\n\n- 选择使用 $x(0\\le x\\le b_i)$ 张优惠券，付出 $a_i-x$ 个金币和 $x$ 张优惠券。\n- 购买完后可得到 $\\lfloor \\frac{a_i-x}{c} \\rfloor$ 张优惠券（即一次购买中，每付出 $c$ 个金币可以得到一张优惠券，$c$ 为给定常数）\n\n小 C 想求出最少花费多少个金币能购买全部物品。", "inputFormat": "本题包含多组数据，第一行包含一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n- 第一行包含三个整数 $n,m,c$。\n- 第二行包含 $n$ 个整数 $a_1,a_2,...,a_n$ 表示每个物品的价格。\n- 第三行包含 $n$ 个整数 $b_1,b_2,...,b_n$ 表示优惠劵的使用上限。", "outputFormat": "对于每组数据输出一行：\n\n- 第一行输出一个整数，表示最少需要的金币数量。", "hint": "对于所有数据，$1\\le \\sum n\\le 10^6,0\\le m,a_i,b_i\\le 10^9,2\\le c\\le 10^9$。\n\n- Subtask 1 (5 pts)：$1\\le T\\le 5,1\\le n\\le 10,1\\le m,\\sum a_i,\\sum b_i\\le 10$\n- Subtask 2 (10 pts)：$a_i=b_i$\n- Subtask 3 (10 pts)：$1\\le \\sum n\\le 500,1\\le \\sum m,\\sum a_i,\\sum b_i\\le 500$\n- Subtask 4 (10 pts)：$1\\le \\sum n\\le 6000,1\\le \\sum m,\\sum a_i,\\sum b_i\\le 6000$\n- Subtask 5 (10 pts)：$1\\le \\sum n\\le 6000$\n- Subtask 6 (15 pts)：$1\\le \\sum n\\le 2\\times 10^5,2\\le c\\le 20$\n- Subtask 7 (10 pts)：$1\\le \\sum n\\le 1\\times 10^6,2\\le c\\le 20$\n- Subtask 8 (15 pts)：$1\\le \\sum n\\le 2\\times 10^5$\n- Subtask 9 (15 pts)：$1\\le \\sum n\\le 1\\times 10^6$\n\n时间限制：$\\texttt{1s}$\n\n空间限制：$\\texttt{2048MB}$", "locale": "zh-CN"}}}
{"pid": "P10002", "type": "P", "difficulty": 7, "samples": [["3 2 998244353", "2\n4\n20"], ["11 4514 998244353", "4514\n20376196\n299712732\n706663250\n721357660\n977589073\n794002114\n369586566\n663682963\n347458730\n524354925"], ["40 787788 998244853", "787788\n699879231\n445785131\n857102003\n759492151\n898159394\n575712517\n634469464\n412999753\n814233648\n333451903\n852329440\n584109489\n270769240\n532457985\n79235443\n2228568\n266810999\n310877128\n614605839\n485785485\n338520973\n113751992\n692026056\n664258393\n650448721\n505881810\n237159658\n107178163\n629910112\n513627947\n915509519\n737809847\n921731327\n233492829\n202989716\n728903945\n776060784\n105388817\n121481849"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["集训队互测", "2023", "Special Judge", "O2优化"], "title": "[集训队互测 2023] 树哈希", "background": "", "description": "这是一道 [模板题](https://uoj.ac/problem/763)。\n\n给定正整数 $n,q,mod$。保证 $mod$ 是质数。\n\n对于一棵以点 $1$ 为根的有根树 $T$，设 $s(T)$ 为这棵树中最多能选出多少个互不同构的子树（也就是这颗树本质不同的子树个数），那么这个树的权值 $w(T) = q^{s(T)}$。\n\n对于所有 $1 \\le m \\le n$，输出所有大小为 $m$，根为 $1$ 的有标号树的权值之和对 $mod$ 取模后的值。\n\n两棵有根树 $T_1$、$T_2$ 同构当且仅当他们的大小相等，且存在一个顶点排列 $\\sigma$ 使得在 $T_1$ 中 $i$ 是 $j$ 的祖先当且仅当在 $T_2$ 中 $\\sigma(i)$ 是 $\\sigma(j)$ 的祖先。\n", "inputFormat": "一行两个整数，表示 $n,q,mod$。\n", "outputFormat": "输出 $n$ 行，第 $m$ 行表示 $m$ 个点的答案。", "hint": "#### 样例解释 1\n\n$n=3,q=2,mod=998244353$ 时，有三颗不同三个点的根为 $1$ 的有标号树，其中两颗满足 $w(T)=2^3$，另一颗满足 $w(T)=2^2$。因此答案为 $(2 \\times 2^3+2^2) \\bmod 998244353 = 20$。\n\n#### 限制与约定\n\n对于所有测试数据，保证 $n = 100, 10^8 \\le mod \\le 1.01 \\times 10^9, 1 \\le q < mod$，且 $mod$ 是质数。\n\n本题共 $1$ 个子任务，每个子任务 $100$ 分。你在每个子任务中的得分为该子任务所有测试点的得分的最小值。\n\n**你必须按照输出格式输出 $n$ 个数，但是你可以输出错误的答案**。如果你输出了 $c$ 个正确的答案，那么你获得的分数按照如下方式计算：\n\n- 对于 $0 \\le c \\le 20$，你的得分为 $2c$ 分；\n- 对于 $21 \\le c \\le 60$，你的得分为 $c + 20 $ 分。\n- 对于 $61 \\le c \\le 100$，你的得分为 $\\lfloor \\frac{c}{2}\\rfloor + 50$ 分。\n\n时间限制：$\\texttt{4s}$。\n空间限制：$\\texttt{2048MB}$。\n\n你可以使用下面的代码来加速你的取模。\n\n```cpp\nstruct fastmod {\n  typedef unsigned long long u64;\n  typedef __uint128_t u128;\n\n  int m;\n  u64 b;\n\n  fastmod(int m) : m(m), b(((u128)1 << 64) / m) {}\n  int reduce(u64 a) {\n    u64 q = ((u128)a * b) >> 64;\n    int r = a - q * m;\n    return r < m ? r : r - m;\n  }\n} z(2);\nvoid solve() {\n\tlong long mod = 998244353, qwq = 1e9;\n\tz = fastmod(mod);\n\tcout << z.reduce(qwq) << ' ' << qwq % mod << '\\n';\n}\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 树哈希", "background": "", "description": "这是一道 [模板题](https://uoj.ac/problem/763)。\n\n给定正整数 $n,q,mod$。保证 $mod$ 是质数。\n\n对于一棵以点 $1$ 为根的有根树 $T$，设 $s(T)$ 为这棵树中最多能选出多少个互不同构的子树（也就是这颗树本质不同的子树个数），那么这个树的权值 $w(T) = q^{s(T)}$。\n\n对于所有 $1 \\le m \\le n$，输出所有大小为 $m$，根为 $1$ 的有标号树的权值之和对 $mod$ 取模后的值。\n\n两棵有根树 $T_1$、$T_2$ 同构当且仅当他们的大小相等，且存在一个顶点排列 $\\sigma$ 使得在 $T_1$ 中 $i$ 是 $j$ 的祖先当且仅当在 $T_2$ 中 $\\sigma(i)$ 是 $\\sigma(j)$ 的祖先。\n", "inputFormat": "一行两个整数，表示 $n,q,mod$。\n", "outputFormat": "输出 $n$ 行，第 $m$ 行表示 $m$ 个点的答案。", "hint": "#### 样例解释 1\n\n$n=3,q=2,mod=998244353$ 时，有三颗不同三个点的根为 $1$ 的有标号树，其中两颗满足 $w(T)=2^3$，另一颗满足 $w(T)=2^2$。因此答案为 $(2 \\times 2^3+2^2) \\bmod 998244353 = 20$。\n\n#### 限制与约定\n\n对于所有测试数据，保证 $n = 100, 10^8 \\le mod \\le 1.01 \\times 10^9, 1 \\le q < mod$，且 $mod$ 是质数。\n\n本题共 $1$ 个子任务，每个子任务 $100$ 分。你在每个子任务中的得分为该子任务所有测试点的得分的最小值。\n\n**你必须按照输出格式输出 $n$ 个数，但是你可以输出错误的答案**。如果你输出了 $c$ 个正确的答案，那么你获得的分数按照如下方式计算：\n\n- 对于 $0 \\le c \\le 20$，你的得分为 $2c$ 分；\n- 对于 $21 \\le c \\le 60$，你的得分为 $c + 20 $ 分。\n- 对于 $61 \\le c \\le 100$，你的得分为 $\\lfloor \\frac{c}{2}\\rfloor + 50$ 分。\n\n时间限制：$\\texttt{4s}$。\n空间限制：$\\texttt{2048MB}$。\n\n你可以使用下面的代码来加速你的取模。\n\n```cpp\nstruct fastmod {\n  typedef unsigned long long u64;\n  typedef __uint128_t u128;\n\n  int m;\n  u64 b;\n\n  fastmod(int m) : m(m), b(((u128)1 << 64) / m) {}\n  int reduce(u64 a) {\n    u64 q = ((u128)a * b) >> 64;\n    int r = a - q * m;\n    return r < m ? r : r - m;\n  }\n} z(2);\nvoid solve() {\n\tlong long mod = 998244353, qwq = 1e9;\n\tz = fastmod(mod);\n\tcout << z.reduce(qwq) << ' ' << qwq % mod << '\\n';\n}\n```", "locale": "zh-CN"}}}
{"pid": "P10003", "type": "P", "difficulty": 7, "samples": [["1 2 10\n-5 5\n5\n-10 -20 10 20\n10 20 -10 -20", "4.3333333333\n6.5"], ["1 4 10\n-5 5\n5\n10 -10 10 10\n10 10 10 -10\n10 -50 10 50\n10 50 10 -50", "2\n2\n7.6666666667\n10"], ["5 5 10\n-10 -5 0 5 10 15\n9 -4 7 -6 2\n-1 0 -9 -100\n-7 0 7 10\n9 0 -3 20\n12 0 -17 -30\n2 0 19 39", "8.085714\n1.815789\n2.382353\n4.987500\n3.988235"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["贪心", "计算几何", "集训队互测", "2023", "Special Judge", "O2优化", "凸包"], "title": "[集训队互测 2023] 傅里叶与交通系统", "background": "傅里叶荣升巴黎市交通部长。新官上任三把火，傅里叶决定重构巴黎市的交通系统。", "description": "巴黎市的地图可以看成一个无限大的二维平面。傅里叶在上面修建了 $n$ 条传送带：第 $i$ 条传送带修建于 $x\\in[p_{i-1},p_i),y\\in\\mathbb R$ 的区域中。对于 $x<p_0$ 或者 $x\\geq p_n$ 的部分，傅里叶没有修建传送带。\n\n当一个人处于第 $i$ 个传送带的区域内时，他会受传送带影响强制以 $v_i$ 单位长度每秒的速度向 $y$ 坐标增加的方向移动。$v_i$ 可能为负，此时其 $y$ 坐标会以相应的速度减小。\n\n在位于未修建传送带的区域上时，$y$ 坐标不会受到传送带的影响。\n\n除了受传送带带动以外，这个人自己也可以移动。为了避免在速度不同的传送带间移动时出现跌倒事故，傅里叶委托麦克斯韦设计了脚底附有钢板的鞋子，并且在传送带上安装了强力磁铁。穿上这种鞋子后，你将只能 **沿着与某条坐标轴平行，可能与坐标轴同向或反向** 的方向，以不超过 $V$ 单位长度每秒的速度移动。有了这种鞋子，**在从一个传送带移动到另一个传送带时，先前的速度不会被继承，这个人将立刻按照新传送带的移动速度来移动**（自然，自身的移动还是可以同步进行的）。\n\n**个人的运动与传送带的运动是叠加的**。\n\n**在任意时刻，这个人都可以自由调整其运动的速率、方向；可以通过不断在极小间隔内切换方向以达到近似斜向移动的效果，甚至动态调整速率、方向达成近似曲线运动的效果；但是其任意时刻都只能有平行于坐标轴、不超过 $V$ 的瞬时速率。**\n\n**就算在没有铺设传送带的位置上，这个人仍然可以靠他的自由意志移动，不过还是只能沿坐标轴方向以不超过 $V$ 单位长度每秒移动**（问就是麦克斯韦的靴子已经成为概念级装备了）。\n\n现在，傅里叶想知道他的交通系统究竟有多么伟大。因此，他向你提出了 $q$ 组询问，每次询问如果有一个人要从 $(x_1,y_1)$ 走到 $(x_2,y_2)$，最少需要多少时间。因为傅里叶是唯一真神，所以他当然不会设计一个有缺陷的交通系统，因此所有的 $v_i$ 的绝对值均严格小于 $V$，进而总是可以从一个位置走到另一处。（虽然这将会导致就算在最优情况下，通过传送带系统到达目的地的时间也无法小于原本的一半，更多的时候反倒更慢了，但是谁让他是交通部长，而你只是他手下的一个雇员呢？）", "inputFormat": "第一行三个整数 $n,q,V$，表示传送带数目、询问个数以及人的移动速度。\n\n下一行 $n+1$ 个整数 $p_0,p_1,\\dots,p_n$，表示传送带的边界信息。\n\n下一行 $n$ 个整数 $v_1,v_2,\\dots,v_n$，表示每个传送带的速率。\n\n接下来 $q$ 行，每行四个整数 $x_1,y_1,x_2,y_2$，表示此次询问的起讫点。", "outputFormat": "对于每次询问，输出一行一个实数，表示此次移动所需的最小时长，单位为秒。你需要保证输出与标准答案的相对或绝对误差不超过 $10^{-5}$。\n\n- 如果你怀疑你的代码中出现了较大的精度误差，可以尝试使用更多整数和分数以规避浮点数运算，从而减少误差。", "hint": "样例 #4，#5 详见附件。\n\n------------\n\n样例 #1 的解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/u2vazpfo.png)\n\n第一问中，上图是一种极优的行走方式。蓝色区域是传送带所在区域，在其上时我们以 $(3,12)$ 每秒的速度移动（其中自身移动的速度是 $(3,7)$，也即可以看作是三成时间沿着 $x$ 轴正方向、七成时间沿着 $y$ 轴正方向移动；在极短时间内不停切换，可以达成如上图中斜线行走的效果；$(3,7)$ 的自身行走与 $(0,5)$ 的传送带运转叠加成为 $(3,12)$ 的速度向量）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wqjsdrte.png)\n\n第二问中，上图是一种极优的行走方案。\n\n需要注意的是，这两问中能达成最少时间的行走方案不止图中给出的两种。\n\n对于所有数据，均满足 $n,q\\leq1.5\\times10^5$，$-5\\times10^5\\leq p_0<p_1<p_2<\\dots<p_n\\leq5\\times10^5$，$ |x_1|,|y_1|,|x_2|,|y_2|\\leq5\\times10^5$，$0\\leq|v_i|<V\\leq5\\times10^5$。\n\n------------\n\n- Subtask 1（5 分）：保证 $n=0$。\n- Subtask 2（10 分）：保证 $n,q\\leq1000$。\n- Subtask 3（10 分）：保证对于所有询问，$x_1=p_0,x_2=p_n$。\n- Subtask 4（10 分）：保证所有询问的 $x_1$ 全都相等，所有询问的 $x_2$ 全都相等（但不保证 $x_1=x_2$）。\n- Subtask 5（15 分）：保证 $v_i$ 单调不降，且询问的 $x_1\\leq x_2$。\n- Subtask 6（15 分）：保证存在 $i$ 使得 $p_i=x_1=x_2$。（但并不保证所有询问的 $i$ 都相同）\n- Subtask 7（15 分）：保证除 $n,q,V$ 外，其它值都在合法范围内独立随机得到（$p$ 的随机方式是随机 $n+1$ 个不等的 $[-5\\times10^5,5\\times10^5]$ 中的值并排序）。\n- Subtask 8（15 分）：保证 $n,q\\leq5\\times10^4$。\n- Subtask 9（10 分）：无特殊限制。 ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 傅里叶与交通系统", "background": "傅里叶荣升巴黎市交通部长。新官上任三把火，傅里叶决定重构巴黎市的交通系统。", "description": "巴黎市的地图可以看成一个无限大的二维平面。傅里叶在上面修建了 $n$ 条传送带：第 $i$ 条传送带修建于 $x\\in[p_{i-1},p_i),y\\in\\mathbb R$ 的区域中。对于 $x<p_0$ 或者 $x\\geq p_n$ 的部分，傅里叶没有修建传送带。\n\n当一个人处于第 $i$ 个传送带的区域内时，他会受传送带影响强制以 $v_i$ 单位长度每秒的速度向 $y$ 坐标增加的方向移动。$v_i$ 可能为负，此时其 $y$ 坐标会以相应的速度减小。\n\n在位于未修建传送带的区域上时，$y$ 坐标不会受到传送带的影响。\n\n除了受传送带带动以外，这个人自己也可以移动。为了避免在速度不同的传送带间移动时出现跌倒事故，傅里叶委托麦克斯韦设计了脚底附有钢板的鞋子，并且在传送带上安装了强力磁铁。穿上这种鞋子后，你将只能 **沿着与某条坐标轴平行，可能与坐标轴同向或反向** 的方向，以不超过 $V$ 单位长度每秒的速度移动。有了这种鞋子，**在从一个传送带移动到另一个传送带时，先前的速度不会被继承，这个人将立刻按照新传送带的移动速度来移动**（自然，自身的移动还是可以同步进行的）。\n\n**个人的运动与传送带的运动是叠加的**。\n\n**在任意时刻，这个人都可以自由调整其运动的速率、方向；可以通过不断在极小间隔内切换方向以达到近似斜向移动的效果，甚至动态调整速率、方向达成近似曲线运动的效果；但是其任意时刻都只能有平行于坐标轴、不超过 $V$ 的瞬时速率。**\n\n**就算在没有铺设传送带的位置上，这个人仍然可以靠他的自由意志移动，不过还是只能沿坐标轴方向以不超过 $V$ 单位长度每秒移动**（问就是麦克斯韦的靴子已经成为概念级装备了）。\n\n现在，傅里叶想知道他的交通系统究竟有多么伟大。因此，他向你提出了 $q$ 组询问，每次询问如果有一个人要从 $(x_1,y_1)$ 走到 $(x_2,y_2)$，最少需要多少时间。因为傅里叶是唯一真神，所以他当然不会设计一个有缺陷的交通系统，因此所有的 $v_i$ 的绝对值均严格小于 $V$，进而总是可以从一个位置走到另一处。（虽然这将会导致就算在最优情况下，通过传送带系统到达目的地的时间也无法小于原本的一半，更多的时候反倒更慢了，但是谁让他是交通部长，而你只是他手下的一个雇员呢？）", "inputFormat": "第一行三个整数 $n,q,V$，表示传送带数目、询问个数以及人的移动速度。\n\n下一行 $n+1$ 个整数 $p_0,p_1,\\dots,p_n$，表示传送带的边界信息。\n\n下一行 $n$ 个整数 $v_1,v_2,\\dots,v_n$，表示每个传送带的速率。\n\n接下来 $q$ 行，每行四个整数 $x_1,y_1,x_2,y_2$，表示此次询问的起讫点。", "outputFormat": "对于每次询问，输出一行一个实数，表示此次移动所需的最小时长，单位为秒。你需要保证输出与标准答案的相对或绝对误差不超过 $10^{-5}$。\n\n- 如果你怀疑你的代码中出现了较大的精度误差，可以尝试使用更多整数和分数以规避浮点数运算，从而减少误差。", "hint": "样例 #4，#5 详见附件。\n\n------------\n\n样例 #1 的解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/u2vazpfo.png)\n\n第一问中，上图是一种极优的行走方式。蓝色区域是传送带所在区域，在其上时我们以 $(3,12)$ 每秒的速度移动（其中自身移动的速度是 $(3,7)$，也即可以看作是三成时间沿着 $x$ 轴正方向、七成时间沿着 $y$ 轴正方向移动；在极短时间内不停切换，可以达成如上图中斜线行走的效果；$(3,7)$ 的自身行走与 $(0,5)$ 的传送带运转叠加成为 $(3,12)$ 的速度向量）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wqjsdrte.png)\n\n第二问中，上图是一种极优的行走方案。\n\n需要注意的是，这两问中能达成最少时间的行走方案不止图中给出的两种。\n\n对于所有数据，均满足 $n,q\\leq1.5\\times10^5$，$-5\\times10^5\\leq p_0<p_1<p_2<\\dots<p_n\\leq5\\times10^5$，$ |x_1|,|y_1|,|x_2|,|y_2|\\leq5\\times10^5$，$0\\leq|v_i|<V\\leq5\\times10^5$。\n\n------------\n\n- Subtask 1（5 分）：保证 $n=0$。\n- Subtask 2（10 分）：保证 $n,q\\leq1000$。\n- Subtask 3（10 分）：保证对于所有询问，$x_1=p_0,x_2=p_n$。\n- Subtask 4（10 分）：保证所有询问的 $x_1$ 全都相等，所有询问的 $x_2$ 全都相等（但不保证 $x_1=x_2$）。\n- Subtask 5（15 分）：保证 $v_i$ 单调不降，且询问的 $x_1\\leq x_2$。\n- Subtask 6（15 分）：保证存在 $i$ 使得 $p_i=x_1=x_2$。（但并不保证所有询问的 $i$ 都相同）\n- Subtask 7（15 分）：保证除 $n,q,V$ 外，其它值都在合法范围内独立随机得到（$p$ 的随机方式是随机 $n+1$ 个不等的 $[-5\\times10^5,5\\times10^5]$ 中的值并排序）。\n- Subtask 8（15 分）：保证 $n,q\\leq5\\times10^4$。\n- Subtask 9（10 分）：无特殊限制。 ", "locale": "zh-CN"}}}
{"pid": "P10004", "type": "P", "difficulty": 7, "samples": [["3 1000000007", "1 0 0\n0 4 0\n0 0 1"], ["5 1000000007", "1 0 0 0 0\n0 20 6 0 0\n0 6 54 6 0\n0 0 6 20 0\n0 0 0 0 1"], ["10 1000000007", "1 0 0 0 0 0 0 0 0 0\n0 165 462 330 55 1 0 0 0 0\n0 462 9273 22023 13750 2266 66 0 0 0\n0 330 22023 147301 203610 75306 6556 66 0 0 \n0 55 13750 203610 592130 423236 75306 2266 1 0\n0 1 2266 75306 423236 592130 203610 13750 55 0\n0 0 66 6556 75306 203610 147301 22023 330 0\n0 0 0 66 2266 13750 22023 9273 462 0\n0 0 0 0 1 55 330 462 165 0\n0 0 0 0 0 0 0 0 0 1"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2023", "组合数学", "容斥原理"], "title": "[集训队互测 2023] Permutation Counting 2", "background": "", "description": "给定 $n$，对于每组 $x,y\\in [0,n)$ 求出有多少个 $1\\sim n$ 的排列 $p$ 满足以下条件：\n\n- $\\sum\\limits_{i=1}^{n-1}[p_i<p_{i+1}]=x$。\n\n- $\\sum\\limits_{i=1}^{n-1}[p^{-1}_i<p^{-1}_{i+1}]=y$。\n\n其中 $p^{-1}$ 表示 $p$ 的逆排列，满足 $p^{-1}_{p_i}=i$。\n\n答案对给定的质数 $MOD$ 取模。", "inputFormat": "共一行，两个整数，表示 $n,MOD$。", "outputFormat": "共 $n$ 行，每行共 $n$ 个整数，第 $i$ 行第 $j$ 列的数表示 $x=i-1,y=j-1$ 时的答案。", "hint": "对于 $100\\%$ 数据，$1\\le n\\le 500$，$10^9\\le MOD\\le 1.01\\times 10^9$，保证 $MOD$ 为质数。\n\n$\\operatorname{Subtask} 1(10\\%):n\\le 8$。\n\n$\\operatorname{Subtask} 2(15\\%):n\\le 16$。\n\n$\\operatorname{Subtask} 3(25\\%):n\\le 40$。\n\n$\\operatorname{Subtask} 4(25\\%):n\\le 100$。\n\n$\\operatorname{Subtask} 5(25\\%):$ 无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] Permutation Counting 2", "background": "", "description": "给定 $n$，对于每组 $x,y\\in [0,n)$ 求出有多少个 $1\\sim n$ 的排列 $p$ 满足以下条件：\n\n- $\\sum\\limits_{i=1}^{n-1}[p_i<p_{i+1}]=x$。\n\n- $\\sum\\limits_{i=1}^{n-1}[p^{-1}_i<p^{-1}_{i+1}]=y$。\n\n其中 $p^{-1}$ 表示 $p$ 的逆排列，满足 $p^{-1}_{p_i}=i$。\n\n答案对给定的质数 $MOD$ 取模。", "inputFormat": "共一行，两个整数，表示 $n,MOD$。", "outputFormat": "共 $n$ 行，每行共 $n$ 个整数，第 $i$ 行第 $j$ 列的数表示 $x=i-1,y=j-1$ 时的答案。", "hint": "对于 $100\\%$ 数据，$1\\le n\\le 500$，$10^9\\le MOD\\le 1.01\\times 10^9$，保证 $MOD$ 为质数。\n\n$\\operatorname{Subtask} 1(10\\%):n\\le 8$。\n\n$\\operatorname{Subtask} 2(15\\%):n\\le 16$。\n\n$\\operatorname{Subtask} 3(25\\%):n\\le 40$。\n\n$\\operatorname{Subtask} 4(25\\%):n\\le 100$。\n\n$\\operatorname{Subtask} 5(25\\%):$ 无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P10005", "type": "P", "difficulty": 7, "samples": [["2 3 2 1000000007", "966666675"], ["3 5 2 998244353", "148276980"], ["6 10 2 1004535809", "622165218"], ["15 20 2 1064822107", "53789887"], ["30 40 1 265371653", "179937201"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2023", "O2优化"], "title": "[集训队互测 2023] 基础寄术练习题", "background": null, "description": "对于长度为 $n$ 的序列 $a$，定义 $f(a)=\\dfrac{1}{\\prod\\limits_{i=k}^ns_i}$，其中 $s_i$ 为 $\\{a_n\\}$ 的前缀和数组，**$k$ 是给定的常数且 $1\\le k\\le 2$**。\n\n考虑所有满足以下三个条件的序列 $a$：\n\n- $a$ 的长度为 $n$。\n- $\\forall i,j$，$a_i\\ne a_j$。\n- $1\\le a_i\\le m$。\n\n求它们的 $f(a)$ 之和，答案对 $p$ 取模。保证 $p$ 是一个质数。", "inputFormat": "第一行四个整数 $n,m,k,p$，分别代表序列长度，序列元素的上界和模数。", "outputFormat": "一行一个整数表示答案对 $p$ 取模后的结果。", "hint": "对于所有数据，保证 $2\\le n\\le m\\le 100$，$10^8<p<1.07\\times 10^9$ 且 $p$ 为质数，$1\\le k\\le 2$。\n\n- Subtask 1 (10 pts)：$m\\le 20$。\n- Subtask 2 (25 pts)：$k=1$。\n- Subtask 3 (15 pts)：$n=m\\le 30$。\n- Subtask 4 (10 pts)：$m\\le 30$。\n- Subtask 5 (15 pts)：$m\\le 40$。\n- Subtask 6 (10 pts)：$m\\le 70$。\n- Subtask 7 (15 pts)：$m\\le 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 基础寄术练习题", "background": null, "description": "对于长度为 $n$ 的序列 $a$，定义 $f(a)=\\dfrac{1}{\\prod\\limits_{i=k}^ns_i}$，其中 $s_i$ 为 $\\{a_n\\}$ 的前缀和数组，**$k$ 是给定的常数且 $1\\le k\\le 2$**。\n\n考虑所有满足以下三个条件的序列 $a$：\n\n- $a$ 的长度为 $n$。\n- $\\forall i,j$，$a_i\\ne a_j$。\n- $1\\le a_i\\le m$。\n\n求它们的 $f(a)$ 之和，答案对 $p$ 取模。保证 $p$ 是一个质数。", "inputFormat": "第一行四个整数 $n,m,k,p$，分别代表序列长度，序列元素的上界和模数。", "outputFormat": "一行一个整数表示答案对 $p$ 取模后的结果。", "hint": "对于所有数据，保证 $2\\le n\\le m\\le 100$，$10^8<p<1.07\\times 10^9$ 且 $p$ 为质数，$1\\le k\\le 2$。\n\n- Subtask 1 (10 pts)：$m\\le 20$。\n- Subtask 2 (25 pts)：$k=1$。\n- Subtask 3 (15 pts)：$n=m\\le 30$。\n- Subtask 4 (10 pts)：$m\\le 30$。\n- Subtask 5 (15 pts)：$m\\le 40$。\n- Subtask 6 (10 pts)：$m\\le 70$。\n- Subtask 7 (15 pts)：$m\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P10006", "type": "P", "difficulty": 7, "samples": [["5 3\n|{}}}\n2 1\n3 2\n4 1\n5 1", "1 2 0 0"], ["10 8\n|}||}{|{{{\n2 1\n3 1\n4 3\n5 2\n6 5\n7 5\n8 4\n9 2\n10 3", "2 0 1 1 0 0 0 0 0"], ["见附加文件 ex_surreal3.in。", "见附加文件 ex_surreal3.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["点分治", "集训队互测", "2023", "O2优化", "快速数论变换 NTT", "根号分治"], "title": "[集训队互测 2023] 超现实树", "background": "Alek 喜欢打信息竞赛，尤其喜欢超现实树。超现实树，顾名思义，就是树上的超现实数。", "description": "Alek 认为，对于常数 $k$，一个字符串被称为「$k$-超现实数串」，如果其只包含字符 $\\texttt{\\{}, \\texttt{|}, \\texttt{\\}}$，且：\n\n- 空串为 $k$-超现实数串；\n- 如果 $s, t$ 为 $k$-超现实数串，那么 $s + t$ 为 $k$-超现实数串；\n- 如果 $k + 1$ 个字符串 $s_1, s_2, \\cdots, s_{k + 1}$ 都是 $k$-超现实数串，那么 $\\texttt{\\{} + s_1 + \\texttt{|} + s_2 + \\texttt{|} + \\cdots + \\texttt{|} + s_{k + 1} + \\texttt{\\}}$ 为 $k$-超现实数串；\n- $k$-超现实数串仅限于此。\n\n给定一棵 $n$ 个点的无根树，节点编号为 $1 \\sim n$。每个点 $i$ 上有一个字符 $a_i \\in \\{\\texttt{\\{}, \\texttt{|}, \\texttt{\\}}\\}$。\n\n给定整数 $m$，Alek 希望你对 $k = 0, 1, \\cdots, m$ 分别求出：有多少有序对 $(x, y)$，$1 \\leq x, y \\leq n$，使得树上从点 $x$ 到点 $y$ 的唯一简单路径上的字符依次拼接所得字符串是 $k$-超现实数串。", "inputFormat": "第一行两个整数 $n, m$，分别表示树的节点数，和需要求答案的 $k$ 的上限。\n\n第二行一个字符串 $a$，$a$ 的第 $i$ 个字符表示点 $i$ 上的字符。\n\n接下来 $n - 1$ 行，每行两个整数 $x, y$，表示存在一条连接点 $x$ 和点 $y$ 的边。", "outputFormat": "输出一行 $m + 1$ 个整数，分别表示 $k = 0, 1, \\cdots, m$ 时的答案。", "hint": "对于所有数据，有 $2 \\leq n \\leq 10^5$，$0 \\leq m \\leq n - 2$，$a_i \\in \\{\\texttt{\\{}, \\texttt{|}, \\texttt{\\}}\\}$。\n\n- **Subtask 1**（5 分）：$n \\leq 4601$；\n- **Subtask 2**（20 分）：对每条边 $(x, y)$ 有 $y = x + 1$；\n- **Subtask 3**（5 分）：$a_i \\neq \\texttt{|}$, $m = 0$；\n- **Subtask 4**（15 分，依赖 Subtask 3）：$m \\leq 3$；\n- **Subtask 5**（25 分，依赖 Subtask 1）：$n \\leq 5 \\times 10^4$；\n- **Subtask 6**（30 分，依赖 Subtask 1, 2, 3, 4, 5）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 超现实树", "background": "Alek 喜欢打信息竞赛，尤其喜欢超现实树。超现实树，顾名思义，就是树上的超现实数。", "description": "Alek 认为，对于常数 $k$，一个字符串被称为「$k$-超现实数串」，如果其只包含字符 $\\texttt{\\{}, \\texttt{|}, \\texttt{\\}}$，且：\n\n- 空串为 $k$-超现实数串；\n- 如果 $s, t$ 为 $k$-超现实数串，那么 $s + t$ 为 $k$-超现实数串；\n- 如果 $k + 1$ 个字符串 $s_1, s_2, \\cdots, s_{k + 1}$ 都是 $k$-超现实数串，那么 $\\texttt{\\{} + s_1 + \\texttt{|} + s_2 + \\texttt{|} + \\cdots + \\texttt{|} + s_{k + 1} + \\texttt{\\}}$ 为 $k$-超现实数串；\n- $k$-超现实数串仅限于此。\n\n给定一棵 $n$ 个点的无根树，节点编号为 $1 \\sim n$。每个点 $i$ 上有一个字符 $a_i \\in \\{\\texttt{\\{}, \\texttt{|}, \\texttt{\\}}\\}$。\n\n给定整数 $m$，Alek 希望你对 $k = 0, 1, \\cdots, m$ 分别求出：有多少有序对 $(x, y)$，$1 \\leq x, y \\leq n$，使得树上从点 $x$ 到点 $y$ 的唯一简单路径上的字符依次拼接所得字符串是 $k$-超现实数串。", "inputFormat": "第一行两个整数 $n, m$，分别表示树的节点数，和需要求答案的 $k$ 的上限。\n\n第二行一个字符串 $a$，$a$ 的第 $i$ 个字符表示点 $i$ 上的字符。\n\n接下来 $n - 1$ 行，每行两个整数 $x, y$，表示存在一条连接点 $x$ 和点 $y$ 的边。", "outputFormat": "输出一行 $m + 1$ 个整数，分别表示 $k = 0, 1, \\cdots, m$ 时的答案。", "hint": "对于所有数据，有 $2 \\leq n \\leq 10^5$，$0 \\leq m \\leq n - 2$，$a_i \\in \\{\\texttt{\\{}, \\texttt{|}, \\texttt{\\}}\\}$。\n\n- **Subtask 1**（5 分）：$n \\leq 4601$；\n- **Subtask 2**（20 分）：对每条边 $(x, y)$ 有 $y = x + 1$；\n- **Subtask 3**（5 分）：$a_i \\neq \\texttt{|}$, $m = 0$；\n- **Subtask 4**（15 分，依赖 Subtask 3）：$m \\leq 3$；\n- **Subtask 5**（25 分，依赖 Subtask 1）：$n \\leq 5 \\times 10^4$；\n- **Subtask 6**（30 分，依赖 Subtask 1, 2, 3, 4, 5）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P10007", "type": "P", "difficulty": 7, "samples": [["2 1\n1 2 0", "3 7"], ["10 10\n5 9 7 8 0 6 3 2 4 10 1", "59 1687 55618 1937320 69557006 549579657 621247830 250099579 483510144 968467040"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["集训队互测", "2023", "O2优化", "生成函数", "拉格朗日反演"], "title": "[集训队互测 2023] 童话", "background": "~~童话只美在真实却从不续写。~~\n\n童话只美在温柔却从不续写。", "description": "泠珞最近学习了前缀和算法，她写出了以下程序：\n\n```cpp\nread(n),read(a);\nfor(int i=0;i<=n;i++)read(f[i]);\nfor(int t=1;t<=n;t++){\n    for(int i=1;i<=n;i++)f[i]=f[i]+a*f[i-1];\n    ans[t]=f[t];\n}\n```\n\n她发现这个程序在 $n$ 比较大的时候会运行超时，请你帮忙写一个程序帮她计算出 $\\text{ans}_1,\\text{ans}_2,\\cdots,\\text{ans}_n$，由于答案数值过大，你只需告诉她每个数除以 $998244353$ 的余数。", "inputFormat": "第一行两个正整数 $n,a$。\n\n接下来一行 $n+1$ 个非负整数，表示 $f_0,f_1,\\cdots,f_n$。", "outputFormat": "$n$ 个非负整数，表示 $\\text{ans}_1,\\text{ans}_2,\\cdots,\\text{ans}_n$。", "hint": "数据范围：\n\n对于 $100\\%$ 的数据，保证 $2\\leqslant n\\leqslant 10^6,0\\leqslant f_i<998244353,1\\leqslant a<998244353$。\n\n| 子任务编号 |  $n\\leqslant$  | 特殊性质 | 分值 |\n| :--------: | :------------: | :------: | :--: |\n|    $1$     |     $2000$     |          | $5$  |\n|    $2$     |     $10^5$     |    A     | $5$  |\n|    $3$     |     $10^5$     |    BC    | $5$  |\n|    $4$     |     $10^5$     |    BD    | $10$ |\n|    $5$     |     $10^5$     |    C     | $10$ |\n|    $6$     | $5\\times10^4$  |          | $10$ |\n|    $7$     |     $10^5$     |          | $10$ |\n|    $8$     | $2\\times 10^5$ |          | $15$ |\n|    $9$     | $5\\times 10^5$ |          | $15$ |\n|    $10$    |     $10^6$     |          | $15$ |\n\n特殊性质 A：保证 $f_i\\ne 0$ 的 $i$ 数量不超过 $100$。\n\n特殊性质 B：保证 $a=1$。\n\n特殊性质 C：保证对于所有 $i\\in[0,n]$，都满足 $f_i=1$。\n\n特殊性质 D：保证对于所有 $i\\in[0,n]$，都满足 $f_i={i+2\\choose 2}=\\frac{(i+2)(i+1)}{2}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 童话", "background": "~~童话只美在真实却从不续写。~~\n\n童话只美在温柔却从不续写。", "description": "泠珞最近学习了前缀和算法，她写出了以下程序：\n\n```cpp\nread(n),read(a);\nfor(int i=0;i<=n;i++)read(f[i]);\nfor(int t=1;t<=n;t++){\n    for(int i=1;i<=n;i++)f[i]=f[i]+a*f[i-1];\n    ans[t]=f[t];\n}\n```\n\n她发现这个程序在 $n$ 比较大的时候会运行超时，请你帮忙写一个程序帮她计算出 $\\text{ans}_1,\\text{ans}_2,\\cdots,\\text{ans}_n$，由于答案数值过大，你只需告诉她每个数除以 $998244353$ 的余数。", "inputFormat": "第一行两个正整数 $n,a$。\n\n接下来一行 $n+1$ 个非负整数，表示 $f_0,f_1,\\cdots,f_n$。", "outputFormat": "$n$ 个非负整数，表示 $\\text{ans}_1,\\text{ans}_2,\\cdots,\\text{ans}_n$。", "hint": "数据范围：\n\n对于 $100\\%$ 的数据，保证 $2\\leqslant n\\leqslant 10^6,0\\leqslant f_i<998244353,1\\leqslant a<998244353$。\n\n| 子任务编号 |  $n\\leqslant$  | 特殊性质 | 分值 |\n| :--------: | :------------: | :------: | :--: |\n|    $1$     |     $2000$     |          | $5$  |\n|    $2$     |     $10^5$     |    A     | $5$  |\n|    $3$     |     $10^5$     |    BC    | $5$  |\n|    $4$     |     $10^5$     |    BD    | $10$ |\n|    $5$     |     $10^5$     |    C     | $10$ |\n|    $6$     | $5\\times10^4$  |          | $10$ |\n|    $7$     |     $10^5$     |          | $10$ |\n|    $8$     | $2\\times 10^5$ |          | $15$ |\n|    $9$     | $5\\times 10^5$ |          | $15$ |\n|    $10$    |     $10^6$     |          | $15$ |\n\n特殊性质 A：保证 $f_i\\ne 0$ 的 $i$ 数量不超过 $100$。\n\n特殊性质 B：保证 $a=1$。\n\n特殊性质 C：保证对于所有 $i\\in[0,n]$，都满足 $f_i=1$。\n\n特殊性质 D：保证对于所有 $i\\in[0,n]$，都满足 $f_i={i+2\\choose 2}=\\frac{(i+2)(i+1)}{2}$。", "locale": "zh-CN"}}}
{"pid": "P10008", "type": "P", "difficulty": 7, "samples": [["3 2 2\n1 2\n2 3", "4"], ["10 11 2\n1 10\n2 2\n3 3\n5 5\n6 10\n6 7\n6 6\n7 7\n8 10\n8 9\n10 10", "129"], ["40 40 40\n31 34\n9 34\n4 25\n36 38\n8 29\n8 30\n6 26\n17 19\n6 23\n36 39\n11 39\n2 10\n32 37\n32 33\n33 35\n17 21\n8 35\n31 40\n11 25\n11 20\n8 37\n26 36\n22 34\n17 39\n28 38\n26 28\n11 12\n12 15\n12 37\n1 9\n11 23\n5 26\n8 11\n1 23\n12 32\n7 19\n22 28\n20 27\n8 40\n19 40", "567581188"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2022"], "title": "[集训队互测 2022] Range Minimum Element", "background": "", "description": "有一个长度为 $n$，值域为 $[1,c]$ 的正整数序列 $a$。给定 $m$ 个区间 $[l_i,r_i]$，设长度为 $m$ 的序列 $b$ 满足 $\\forall i\\in [1,m],b_i=\\min\\limits_{j=l_i}^{r_i}\\{a_j\\}$。求出 $a$ 在范围内任意取的情况下共能得到多少种不同的 $b$。答案对 $998244353$ 取模。", "inputFormat": "第一行，三个数，依次表示 $n,m,c$。\n\n接下来 $m$ 行，每行两个数 $l_i,r_i$ 表示一个给定的区间。", "outputFormat": "共一行，一个数，表示答案。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 100,1\\le m\\le\\dfrac{n(n+1)}{2},1\\le c<998244353,\\forall i\\in [1,m],1\\le l_i\\le r_i\\le n$。保证给定的 $m$ 个区间两两不同。\n\n$\\operatorname{Subtask}1(5\\%):n,c\\le 5$。\n\n$\\operatorname{Subtask}2(10\\%):c\\le 100$，且对于任意两个有交点的区间一定存在其中一个包含另一个。\n\n$\\operatorname{Subtask}3(15\\%):m\\le 18,c=2$。\n\n$\\operatorname{Subtask}4(20\\%):c=2$。\n\n$\\operatorname{Subtask}5(15\\%):n,c\\le 40$。\n\n$\\operatorname{Subtask}6(15\\%):c\\le 100$。\n\n$\\operatorname{Subtask}7(20\\%):$ 无特殊限制。\n\n#### 样例说明 1\n\n当 $a=(1,1,1)$ 时，$b=(1,1)$。\n\n当 $a=(1,1,2)$ 时，$b=(1,1)$。\n\n当 $a=(1,2,1)$ 时，$b=(1,1)$。\n\n当 $a=(1,2,2)$ 时，$b=(1,2)$。\n\n当 $a=(2,1,1)$ 时，$b=(1,1)$。\n\n当 $a=(2,1,2)$ 时，$b=(1,1)$。\n\n当 $a=(2,2,1)$ 时，$b=(2,1)$。\n\n当 $a=(2,2,2)$ 时，$b=(2,2)$。\n\n因此共能得到 $[1,1],[1,2],[2,1],[2,2]$ 这 $4$ 种不同的 $b$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2022] Range Minimum Element", "background": "", "description": "有一个长度为 $n$，值域为 $[1,c]$ 的正整数序列 $a$。给定 $m$ 个区间 $[l_i,r_i]$，设长度为 $m$ 的序列 $b$ 满足 $\\forall i\\in [1,m],b_i=\\min\\limits_{j=l_i}^{r_i}\\{a_j\\}$。求出 $a$ 在范围内任意取的情况下共能得到多少种不同的 $b$。答案对 $998244353$ 取模。", "inputFormat": "第一行，三个数，依次表示 $n,m,c$。\n\n接下来 $m$ 行，每行两个数 $l_i,r_i$ 表示一个给定的区间。", "outputFormat": "共一行，一个数，表示答案。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 100,1\\le m\\le\\dfrac{n(n+1)}{2},1\\le c<998244353,\\forall i\\in [1,m],1\\le l_i\\le r_i\\le n$。保证给定的 $m$ 个区间两两不同。\n\n$\\operatorname{Subtask}1(5\\%):n,c\\le 5$。\n\n$\\operatorname{Subtask}2(10\\%):c\\le 100$，且对于任意两个有交点的区间一定存在其中一个包含另一个。\n\n$\\operatorname{Subtask}3(15\\%):m\\le 18,c=2$。\n\n$\\operatorname{Subtask}4(20\\%):c=2$。\n\n$\\operatorname{Subtask}5(15\\%):n,c\\le 40$。\n\n$\\operatorname{Subtask}6(15\\%):c\\le 100$。\n\n$\\operatorname{Subtask}7(20\\%):$ 无特殊限制。\n\n#### 样例说明 1\n\n当 $a=(1,1,1)$ 时，$b=(1,1)$。\n\n当 $a=(1,1,2)$ 时，$b=(1,1)$。\n\n当 $a=(1,2,1)$ 时，$b=(1,1)$。\n\n当 $a=(1,2,2)$ 时，$b=(1,2)$。\n\n当 $a=(2,1,1)$ 时，$b=(1,1)$。\n\n当 $a=(2,1,2)$ 时，$b=(1,1)$。\n\n当 $a=(2,2,1)$ 时，$b=(2,1)$。\n\n当 $a=(2,2,2)$ 时，$b=(2,2)$。\n\n因此共能得到 $[1,1],[1,2],[2,1],[2,2]$ 这 $4$ 种不同的 $b$。", "locale": "zh-CN"}}}
{"pid": "P10009", "type": "P", "difficulty": 7, "samples": [["1\n6 6\n1 1 5 1 9 4\n2 5\n1 2 5\n2 4\n1 3 6\n2 6\n1 1 6", "9\n4\n12\n1\n0\n5\n4\n12\n0\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2022", "O2优化"], "title": "[集训队互测 2022] 线段树", "background": "请注意：**本题不是线段树模板题**。", "description": "给定一个长度为 $n$ 的序列 $a_1,a_2,\\cdots a_n$。你需要进行共 $q$ 次下面两种操作：\n\n- `1 l r`：将 $a_{l\\sim r}$ 替换为它的异或差分。形式化地说，令 $b_i := a_i \\text{ xor } a_{i-1}$（$l<i\\leq r$），然后对于每个 $l<i\\leq r$，将 $a_i$ 替换为 $b_i$。\n\n- `2 pos`：查询 $a_{pos}$ 的值。\n\n操作执行完后，你还需要回答最终的 $a$ 序列。", "inputFormat": "第一行包含一个整数 $T$，表示该数据满足第 $T$ 个子任务的限制。\n\n第二行包含两个整数 $n,q$，分别表示序列的长度和操作的个数。\n\n第三行包含 $n$ 个整数 $a_1,a_2,\\cdots,a_n$。\n\n接下来 $q$ 行，每行若干个数，表示一个操作。若操作为第一种操作，则此行包含三个数 `1 l r` 。若操作为第二种操作，则此行包含两个数 `2 pos`。", "outputFormat": "设共有 $q_2$ 个第二种操作，则输出共包含 $q_2+n$ 行。\n\n前 $q_2$ 行，每行输出一个整数，表示该操作的答案。\n\n接下来 $n$ 行，每行输出一个整数，表示最终的 $a$\n 序列。", "hint": "**更多样例见下发文件**。对于第 $i + 1$ 个样例，$T = i$。\n\n### 样例 1 解释\n\n初始时 $a=[1,1,5,1,9,4]$。\n\n第一个操作要求输出 $a_5$，此时 $a_5=9$，故输出 $9$。\n\n第二个操作要求将 $a_{2\\sim 5}$ 替换为它的异或差分，$a_{2\\sim 5}$ 为 $[1,5,1,9]$，它的异或差分为 $[1,4,4,8]$，故操作执行完后，$a$ 序列变为 $[1,1,4,4,8,4]$\n。\n\n第三个操作要求输出 $a_4$，此时 $a_4=4$，故输出 $4$。\n\n第四个操作要求将 $a_{3\\sim 6}$ 替换为它的异或差分， $a_{3\\sim 6}$ 为 $[4,4,8,4]$，它的异或差分为 $[4,0,12,12]$，故操作执行完后， $a$ 序列变为 $[1,1,4,0,12,12]$。\n\n第五个操作要求输出 $a_6$，此时 $a_6=12$，故输出 $12$。\n\n第六个操作要求将 $a_{1\\sim 6}$ 替换为它的异或差分， $a_{1\\sim 6}$ 为 $[1,1,4,0,12,12]$，它的异或差分为 $[1,0,5,4,12,0]$，故操作执行完后，$a$ 序列变为 $[1,0,5,4,12,0]$。\n\n最终的 $a$ 序列为 $[1,0,5,4,12,0]$。\n\n### 数据范围与约定\n\n对于所有数据，保证 $1\\leq n\\leq 2.5\\times 10^5$，$1\\leq q\\leq 10^5$，$0\\leq a_i< 2^{30}$，$1\\leq l\\leq r\\leq n$，$1\\leq pos\\leq n$。\n\n| 子任务编号 |     $n\\leq$      |    $q\\leq$     | 特殊性质 | 分值 |   子任务依赖    |\n| :--------: | :--------------: | :------------: | :------: | :--: | :-------------: |\n|    $1$     |  $2\\times 10^3$  | $2\\times 10^3$ |    无    | $8$  |       无        |\n|    $2$     | $2.5\\times 10^5$ |     $10^5$     |    A     | $4$  |       无        |\n|    $3$     | $2.5\\times 10^5$ |     $10^5$     |    B     | $7$  |       无        |\n|    $4$     | $2.5\\times 10^5$ |     $10^5$     |    CD    | $13$ |       无        |\n|    $5$     | $2.5\\times 10^5$ |     $10^5$     |    DE    | $12$ |       无        |\n|    $6$     | $2.5\\times 10^5$ |     $10^5$     |    D     | $16$ |       $5$       |\n|    $7$     | $2.5\\times 10^5$ |     $10^5$     |    E     | $11$ |       $5$       |\n|    $8$     | $2.5\\times 10^5$ |     $10^5$     |    无    | $29$ | $1,2,3,4,5,6,7$ |\n\n特殊性质 A：$\\forall i\\geq 2, a_i=0$。\n\n特殊性质 B：$0\\leq a_i\\leq 1$。\n\n特殊性质 C：记序列 $a$ 中非零位置个数为 $c$，则 $c\\leq 100$。\n\n特殊性质 D：操作 $1$ 满足 $l=1$，$r=n$。\n\n特殊性质 E：没有操作 $2$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2022] 线段树", "background": "请注意：**本题不是线段树模板题**。", "description": "给定一个长度为 $n$ 的序列 $a_1,a_2,\\cdots a_n$。你需要进行共 $q$ 次下面两种操作：\n\n- `1 l r`：将 $a_{l\\sim r}$ 替换为它的异或差分。形式化地说，令 $b_i := a_i \\text{ xor } a_{i-1}$（$l<i\\leq r$），然后对于每个 $l<i\\leq r$，将 $a_i$ 替换为 $b_i$。\n\n- `2 pos`：查询 $a_{pos}$ 的值。\n\n操作执行完后，你还需要回答最终的 $a$ 序列。", "inputFormat": "第一行包含一个整数 $T$，表示该数据满足第 $T$ 个子任务的限制。\n\n第二行包含两个整数 $n,q$，分别表示序列的长度和操作的个数。\n\n第三行包含 $n$ 个整数 $a_1,a_2,\\cdots,a_n$。\n\n接下来 $q$ 行，每行若干个数，表示一个操作。若操作为第一种操作，则此行包含三个数 `1 l r` 。若操作为第二种操作，则此行包含两个数 `2 pos`。", "outputFormat": "设共有 $q_2$ 个第二种操作，则输出共包含 $q_2+n$ 行。\n\n前 $q_2$ 行，每行输出一个整数，表示该操作的答案。\n\n接下来 $n$ 行，每行输出一个整数，表示最终的 $a$\n 序列。", "hint": "**更多样例见下发文件**。对于第 $i + 1$ 个样例，$T = i$。\n\n### 样例 1 解释\n\n初始时 $a=[1,1,5,1,9,4]$。\n\n第一个操作要求输出 $a_5$，此时 $a_5=9$，故输出 $9$。\n\n第二个操作要求将 $a_{2\\sim 5}$ 替换为它的异或差分，$a_{2\\sim 5}$ 为 $[1,5,1,9]$，它的异或差分为 $[1,4,4,8]$，故操作执行完后，$a$ 序列变为 $[1,1,4,4,8,4]$\n。\n\n第三个操作要求输出 $a_4$，此时 $a_4=4$，故输出 $4$。\n\n第四个操作要求将 $a_{3\\sim 6}$ 替换为它的异或差分， $a_{3\\sim 6}$ 为 $[4,4,8,4]$，它的异或差分为 $[4,0,12,12]$，故操作执行完后， $a$ 序列变为 $[1,1,4,0,12,12]$。\n\n第五个操作要求输出 $a_6$，此时 $a_6=12$，故输出 $12$。\n\n第六个操作要求将 $a_{1\\sim 6}$ 替换为它的异或差分， $a_{1\\sim 6}$ 为 $[1,1,4,0,12,12]$，它的异或差分为 $[1,0,5,4,12,0]$，故操作执行完后，$a$ 序列变为 $[1,0,5,4,12,0]$。\n\n最终的 $a$ 序列为 $[1,0,5,4,12,0]$。\n\n### 数据范围与约定\n\n对于所有数据，保证 $1\\leq n\\leq 2.5\\times 10^5$，$1\\leq q\\leq 10^5$，$0\\leq a_i< 2^{30}$，$1\\leq l\\leq r\\leq n$，$1\\leq pos\\leq n$。\n\n| 子任务编号 |     $n\\leq$      |    $q\\leq$     | 特殊性质 | 分值 |   子任务依赖    |\n| :--------: | :--------------: | :------------: | :------: | :--: | :-------------: |\n|    $1$     |  $2\\times 10^3$  | $2\\times 10^3$ |    无    | $8$  |       无        |\n|    $2$     | $2.5\\times 10^5$ |     $10^5$     |    A     | $4$  |       无        |\n|    $3$     | $2.5\\times 10^5$ |     $10^5$     |    B     | $7$  |       无        |\n|    $4$     | $2.5\\times 10^5$ |     $10^5$     |    CD    | $13$ |       无        |\n|    $5$     | $2.5\\times 10^5$ |     $10^5$     |    DE    | $12$ |       无        |\n|    $6$     | $2.5\\times 10^5$ |     $10^5$     |    D     | $16$ |       $5$       |\n|    $7$     | $2.5\\times 10^5$ |     $10^5$     |    E     | $11$ |       $5$       |\n|    $8$     | $2.5\\times 10^5$ |     $10^5$     |    无    | $29$ | $1,2,3,4,5,6,7$ |\n\n特殊性质 A：$\\forall i\\geq 2, a_i=0$。\n\n特殊性质 B：$0\\leq a_i\\leq 1$。\n\n特殊性质 C：记序列 $a$ 中非零位置个数为 $c$，则 $c\\leq 100$。\n\n特殊性质 D：操作 $1$ 满足 $l=1$，$r=n$。\n\n特殊性质 E：没有操作 $2$。\n", "locale": "zh-CN"}}}
{"pid": "P10010", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "数学", "集训队互测", "2023", "爬山算法 Local search", "模拟退火", "随机调整", "线性规划", "概率论", "线性代数", "随机化"], "title": "[集训队互测 2023] Grievous Lady", "background": "对立从那灰暗的塔楼进入，逐步踏入这个扭曲的迷宫深处。\n\n对立的心突然绞痛起来。\n\n对立后退了一步，扑腾了一下便跪倒下来。\n\n未及碰到，灰黑的地板就突然崩裂瓦解，先一步向下坠落。\n\n先前收集的纷争碎片，连同塔楼本身，一同化作了一场倾盆大雨，包围在对立四周。\n\n异象骤起，对立的思维也陷入一片混乱。\n\n塔楼落入了先前的由光芒碎片组成的欢乐海洋，但对立却被纷争碎片紧紧地包裹着。\n\n在那由光芒和纷争碎片交错的风暴之中，对立所见的只有那些令人厌恶的纷争碎片。\n\n那枚世界尽头的记忆映入了对立的视野。\n\n面对着世界一点点地走向终结的景象，对立的理性在碎裂。\n\n对立意识到，一切美好的记忆不过是须臾，最终都会走向破灭。\n\n四周的碎片依旧在飞旋，对立试图看清那些玻璃碎片的变换。\n\n对立意识到，现在围绕着的那些碎片，正以最恐怖的方式运转。\n\n这个碎片风暴所带来的「忧郁度」，可以被简单地描述为外侧碎片的旋转速度之和乘上内侧碎片的旋转速度之和。\n\n一片玻璃碎片在外侧总是以一种速度正旋，而在内侧总是以另一种速度逆旋。\n\n每片碎片都是是来自不同世界的刹那记忆，故而其转速总可以认为是独立随机指定的。\n\n在残存无几的希望将尽未尽之时，对立只想知道，现在的碎片风暴的忧郁度，也就是最大可能的忧郁度，究竟是多少。", "description": "共有 $n$ 个元素，标号 $1\\sim n$，每个元素 $j$ 有两个正整数权值 $a_j,b_j$。\n\n你要确定一个 $[1,n]\\cap\\mathbb N$ 的子集 $S$，从而最大化\n\n$$\n\\left(\\sum_{k=1}^na_k[k\\in S]\\right)\\left(\\sum_{k=1}^nb_k[k\\notin S]\\right)\n$$\n\n这个问题显然不可做，因此**保证每个 $a_j,b_j$ 分别在 $[1,A]\\cap\\mathbb N,[1,B]\\cap\\mathbb N$ 内独立均匀随机生成**。\n\n现在给定 $n,A,B$ 和每个元素的两个权值 $(a_j,b_j)$，请求出这个最大的答案。", "inputFormat": "本题每个测试点中有多组测试数据。\n\n第一行四个整数，$T,n,A,B$，$T$ 表示该组数据内的数据组数，$n,A,B$ 表示该测试点内的所有数据均对应此 $n,A,B$。\n\n接下来每组数据占 $n$ 行，其中第 $j$ 行两个整数 $a_j,b_j$。\n\n保证 $a_j,b_j$ 在对应范围内独立均匀随机生成。", "outputFormat": "对于每组数据输出一行一个整数，表示其答案。\n\n注意这个答案可能很大，你可能需要使用 `__int128` 类型来进行中间存储与运算，并最后输出。注意你可能需要使用一些正确的输出方式。", "hint": "#### 输入输出样例\n\n**因为本题数据规模太大，直接提交评测会对评测机带来很大压力，本题将提供很多大样例；请尽量减少本题的提交次数。**\n\n请参见下发文件 `grievouslady*.in/ans`，共 $50$ 组，基本按照部分分的方法造。\n\n由于本题保证数据随机，不提供手搓样例。\n\n#### 数据范围与提示\n\n对于所有的数据，保证 $10\\le n\\le3000$，$10^4\\le A,B\\le10^{12}$，$1\\le T\\le50$。\n\n~~本题设置子任务，各子任务~~共 $100$ 个测试点。具体的测试点分布可以见下表。\n\n**本题在洛谷上的版本不设置子任务**。\n\n（**由于表格比较宽，洛谷上较难完整显示，你可能要使用题目页面的“展开”功能**）\n\n|测试点编号|$n$|$A$|$B$|测试点编号|$n$|$A$|$B$|测试点编号|$n$|$A$|$B$|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$1\\sim2$|$=10$|$=10^4$|$=10^4$|$33\\sim34$|$=100$|$=10^4$|$=10^4$|$67\\sim68$|$=1000$|$=10^5$|$=10^{12}$|\n|$3\\sim4$|$=10$|$=10^9$|$=10^9$|$35\\sim36$|$=100$|$=10^5$|$=10^5$|$69\\sim70$|$=1000$|$=10^9$|$=10^9$|\n|$5\\sim6$|$=10$|$=10^{12}$|$=10^{12}$|$37\\sim38$|$=100$|$=10^5$|$=10^9$|$71\\sim72$|$=1000$|$=10^{12}$|$=10^{12}$|\n|$7\\sim8$|$=20$|$=10^4$|$=10^4$|$39\\sim40$|$=100$|$=10^9$|$=10^9$|$73\\sim74$|$=1500$|$=10^5$|$=10^{12}$|\n|$9\\sim10$|$=20$|$=10^9$|$=10^9$|$41\\sim42$|$=100$|$=10^{12}$|$=10^{12}$|$75\\sim76$|$=1500$|$=10^9$|$=10^9$|\n|$11\\sim12$|$=20$|$=10^{12}$|$=10^{12}$|$43\\sim44$|$=200$|$=10^5$|$=10^{12}$|$77\\sim78$|$=1500$|$=10^{12}$|$=10^{12}$|\n|$13\\sim14$|$=30$|$=10^4$|$=10^4$|$45\\sim46$|$=200$|$=10^9$|$=10^9$|$79\\sim80$|$=2000$|$=10^5$|$=10^{12}$|\n|$15\\sim16$|$=30$|$=10^9$|$=10^9$|$47\\sim48$|$=200$|$=10^{12}$|$=10^{12}$|$81\\sim82$|$=2000$|$=10^9$|$=10^9$|\n|$17\\sim18$|$=30$|$=10^{12}$|$=10^{12}$|$49\\sim50$|$=300$|$=10^5$|$=10^{12}$|$83\\sim84$|$=2000$|$=10^{12}$|$=10^{12}$|\n|$19\\sim20$|$=40$|$=10^4$|$=10^4$|$51\\sim52$|$=300$|$=10^9$|$=10^9$|$85\\sim86$|$=2500$|$=10^4$|$=10^9$|\n|$21\\sim22$|$=40$|$=10^9$|$=10^9$|$53\\sim54$|$=300$|$=10^{12}$|$=10^{12}$|$87\\sim88$|$=2500$|$=10^5$|$=10^{12}$|\n|$23\\sim24$|$=40$|$=10^{12}$|$=10^{12}$|$55\\sim56$|$=500$|$=10^5$|$=10^{12}$|$89\\sim90$|$=2500$|$=10^9$|$=10^9$|\n|$25\\sim26$|$=50$|$=10^4$|$=10^4$|$57\\sim58$|$=500$|$=10^9$|$=10^9$|$91\\sim92$|$=2500$|$=10^{12}$|$=10^{12}$|\n|$27\\sim28$|$=50$|$=10^4$|$=10^9$|$59\\sim60$|$=500$|$=10^{12}$|$=10^{12}$|$93\\sim94$|$=3000$|$=10^4$|$=10^9$|\n|$29\\sim30$|$=50$|$=10^9$|$=10^9$|$61\\sim62$|$=800$|$=10^5$|$=10^{12}$|$95\\sim96$|$=3000$|$=10^5$|$=10^{12}$|\n|$31\\sim32$|$=50$|$=10^{12}$|$=10^{12}$|$63\\sim64$|$=800$|$=10^9$|$=10^9$|$97\\sim98$|$=3000$|$=10^9$|$=10^9$|\n|||||$65\\sim66$|$=800$|$=10^{12}$|$=10^{12}$|$99\\sim100$|$=3000$|$=10^{12}$|$=10^{12}$|\n\n~~我们按如下方式布局各测试点~~：\n* ~~subtask $1$：$1\\sim12$，占 $\\rm12pts$~~。\n* ~~subtask $2$：$13\\sim32$，占 $\\rm20pts$~~。\n* ~~subtask $3$：$33\\sim36$，占 $\\rm4pts$~~。\n* ~~subtask $4$：$37\\sim48$，占 $\\rm12pts$~~。\n* ~~subtask $5$：$49\\sim50$，占 $\\rm2pts$~~。\n* ~~subtask $6$：$51\\sim60$，占 $\\rm10pts$~~。\n* ~~subtask $7$：$61\\sim72$，占 $\\rm12pts$~~。\n* ~~subtask $8$：$73\\sim84$，占 $\\rm12pts$~~。\n* ~~subtask $9$：$85\\sim92$，占 $\\rm8pts$~~。\n* ~~subtask $10$：$93\\sim100$，占 $\\rm8pts$~~。\n\n~~**本题不设置子任务依赖，因此请确保经样例测试后你的算法正确后再提交，以免卡评测机**。~~\n\n#### 后记\n\n这个世界——一切——都源于过去。过去的影像，哪怕是欢乐的记忆，就像是白昼过后的黑夜，渐渐导致了这份世界末日。\n\n泪水盈眶。对立的眼神转为一片黑暗。\n\n对立与这些玻璃起了共鸣，围绕于四周的回忆之壳开始崩裂。\n\n对立就身处其中，站在那炫目的光芒前方，已经没有任何情感了。\n\n扭曲的迷宫，也在对立的力量下，悉数损毁……\n\n时光逝去，对立变了。不再激情地收集回忆，而是近乎无意识地走在这世界之中，并不再抱有任何雄心壮志。\n\n如今，对立正在一个破旧坍塌的建筑旁行走着，旋转着某天在废墟中找到的太阳伞。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] Grievous Lady", "background": "对立从那灰暗的塔楼进入，逐步踏入这个扭曲的迷宫深处。\n\n对立的心突然绞痛起来。\n\n对立后退了一步，扑腾了一下便跪倒下来。\n\n未及碰到，灰黑的地板就突然崩裂瓦解，先一步向下坠落。\n\n先前收集的纷争碎片，连同塔楼本身，一同化作了一场倾盆大雨，包围在对立四周。\n\n异象骤起，对立的思维也陷入一片混乱。\n\n塔楼落入了先前的由光芒碎片组成的欢乐海洋，但对立却被纷争碎片紧紧地包裹着。\n\n在那由光芒和纷争碎片交错的风暴之中，对立所见的只有那些令人厌恶的纷争碎片。\n\n那枚世界尽头的记忆映入了对立的视野。\n\n面对着世界一点点地走向终结的景象，对立的理性在碎裂。\n\n对立意识到，一切美好的记忆不过是须臾，最终都会走向破灭。\n\n四周的碎片依旧在飞旋，对立试图看清那些玻璃碎片的变换。\n\n对立意识到，现在围绕着的那些碎片，正以最恐怖的方式运转。\n\n这个碎片风暴所带来的「忧郁度」，可以被简单地描述为外侧碎片的旋转速度之和乘上内侧碎片的旋转速度之和。\n\n一片玻璃碎片在外侧总是以一种速度正旋，而在内侧总是以另一种速度逆旋。\n\n每片碎片都是是来自不同世界的刹那记忆，故而其转速总可以认为是独立随机指定的。\n\n在残存无几的希望将尽未尽之时，对立只想知道，现在的碎片风暴的忧郁度，也就是最大可能的忧郁度，究竟是多少。", "description": "共有 $n$ 个元素，标号 $1\\sim n$，每个元素 $j$ 有两个正整数权值 $a_j,b_j$。\n\n你要确定一个 $[1,n]\\cap\\mathbb N$ 的子集 $S$，从而最大化\n\n$$\n\\left(\\sum_{k=1}^na_k[k\\in S]\\right)\\left(\\sum_{k=1}^nb_k[k\\notin S]\\right)\n$$\n\n这个问题显然不可做，因此**保证每个 $a_j,b_j$ 分别在 $[1,A]\\cap\\mathbb N,[1,B]\\cap\\mathbb N$ 内独立均匀随机生成**。\n\n现在给定 $n,A,B$ 和每个元素的两个权值 $(a_j,b_j)$，请求出这个最大的答案。", "inputFormat": "本题每个测试点中有多组测试数据。\n\n第一行四个整数，$T,n,A,B$，$T$ 表示该组数据内的数据组数，$n,A,B$ 表示该测试点内的所有数据均对应此 $n,A,B$。\n\n接下来每组数据占 $n$ 行，其中第 $j$ 行两个整数 $a_j,b_j$。\n\n保证 $a_j,b_j$ 在对应范围内独立均匀随机生成。", "outputFormat": "对于每组数据输出一行一个整数，表示其答案。\n\n注意这个答案可能很大，你可能需要使用 `__int128` 类型来进行中间存储与运算，并最后输出。注意你可能需要使用一些正确的输出方式。", "hint": "#### 输入输出样例\n\n**因为本题数据规模太大，直接提交评测会对评测机带来很大压力，本题将提供很多大样例；请尽量减少本题的提交次数。**\n\n请参见下发文件 `grievouslady*.in/ans`，共 $50$ 组，基本按照部分分的方法造。\n\n由于本题保证数据随机，不提供手搓样例。\n\n#### 数据范围与提示\n\n对于所有的数据，保证 $10\\le n\\le3000$，$10^4\\le A,B\\le10^{12}$，$1\\le T\\le50$。\n\n~~本题设置子任务，各子任务~~共 $100$ 个测试点。具体的测试点分布可以见下表。\n\n**本题在洛谷上的版本不设置子任务**。\n\n（**由于表格比较宽，洛谷上较难完整显示，你可能要使用题目页面的“展开”功能**）\n\n|测试点编号|$n$|$A$|$B$|测试点编号|$n$|$A$|$B$|测试点编号|$n$|$A$|$B$|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$1\\sim2$|$=10$|$=10^4$|$=10^4$|$33\\sim34$|$=100$|$=10^4$|$=10^4$|$67\\sim68$|$=1000$|$=10^5$|$=10^{12}$|\n|$3\\sim4$|$=10$|$=10^9$|$=10^9$|$35\\sim36$|$=100$|$=10^5$|$=10^5$|$69\\sim70$|$=1000$|$=10^9$|$=10^9$|\n|$5\\sim6$|$=10$|$=10^{12}$|$=10^{12}$|$37\\sim38$|$=100$|$=10^5$|$=10^9$|$71\\sim72$|$=1000$|$=10^{12}$|$=10^{12}$|\n|$7\\sim8$|$=20$|$=10^4$|$=10^4$|$39\\sim40$|$=100$|$=10^9$|$=10^9$|$73\\sim74$|$=1500$|$=10^5$|$=10^{12}$|\n|$9\\sim10$|$=20$|$=10^9$|$=10^9$|$41\\sim42$|$=100$|$=10^{12}$|$=10^{12}$|$75\\sim76$|$=1500$|$=10^9$|$=10^9$|\n|$11\\sim12$|$=20$|$=10^{12}$|$=10^{12}$|$43\\sim44$|$=200$|$=10^5$|$=10^{12}$|$77\\sim78$|$=1500$|$=10^{12}$|$=10^{12}$|\n|$13\\sim14$|$=30$|$=10^4$|$=10^4$|$45\\sim46$|$=200$|$=10^9$|$=10^9$|$79\\sim80$|$=2000$|$=10^5$|$=10^{12}$|\n|$15\\sim16$|$=30$|$=10^9$|$=10^9$|$47\\sim48$|$=200$|$=10^{12}$|$=10^{12}$|$81\\sim82$|$=2000$|$=10^9$|$=10^9$|\n|$17\\sim18$|$=30$|$=10^{12}$|$=10^{12}$|$49\\sim50$|$=300$|$=10^5$|$=10^{12}$|$83\\sim84$|$=2000$|$=10^{12}$|$=10^{12}$|\n|$19\\sim20$|$=40$|$=10^4$|$=10^4$|$51\\sim52$|$=300$|$=10^9$|$=10^9$|$85\\sim86$|$=2500$|$=10^4$|$=10^9$|\n|$21\\sim22$|$=40$|$=10^9$|$=10^9$|$53\\sim54$|$=300$|$=10^{12}$|$=10^{12}$|$87\\sim88$|$=2500$|$=10^5$|$=10^{12}$|\n|$23\\sim24$|$=40$|$=10^{12}$|$=10^{12}$|$55\\sim56$|$=500$|$=10^5$|$=10^{12}$|$89\\sim90$|$=2500$|$=10^9$|$=10^9$|\n|$25\\sim26$|$=50$|$=10^4$|$=10^4$|$57\\sim58$|$=500$|$=10^9$|$=10^9$|$91\\sim92$|$=2500$|$=10^{12}$|$=10^{12}$|\n|$27\\sim28$|$=50$|$=10^4$|$=10^9$|$59\\sim60$|$=500$|$=10^{12}$|$=10^{12}$|$93\\sim94$|$=3000$|$=10^4$|$=10^9$|\n|$29\\sim30$|$=50$|$=10^9$|$=10^9$|$61\\sim62$|$=800$|$=10^5$|$=10^{12}$|$95\\sim96$|$=3000$|$=10^5$|$=10^{12}$|\n|$31\\sim32$|$=50$|$=10^{12}$|$=10^{12}$|$63\\sim64$|$=800$|$=10^9$|$=10^9$|$97\\sim98$|$=3000$|$=10^9$|$=10^9$|\n|||||$65\\sim66$|$=800$|$=10^{12}$|$=10^{12}$|$99\\sim100$|$=3000$|$=10^{12}$|$=10^{12}$|\n\n~~我们按如下方式布局各测试点~~：\n* ~~subtask $1$：$1\\sim12$，占 $\\rm12pts$~~。\n* ~~subtask $2$：$13\\sim32$，占 $\\rm20pts$~~。\n* ~~subtask $3$：$33\\sim36$，占 $\\rm4pts$~~。\n* ~~subtask $4$：$37\\sim48$，占 $\\rm12pts$~~。\n* ~~subtask $5$：$49\\sim50$，占 $\\rm2pts$~~。\n* ~~subtask $6$：$51\\sim60$，占 $\\rm10pts$~~。\n* ~~subtask $7$：$61\\sim72$，占 $\\rm12pts$~~。\n* ~~subtask $8$：$73\\sim84$，占 $\\rm12pts$~~。\n* ~~subtask $9$：$85\\sim92$，占 $\\rm8pts$~~。\n* ~~subtask $10$：$93\\sim100$，占 $\\rm8pts$~~。\n\n~~**本题不设置子任务依赖，因此请确保经样例测试后你的算法正确后再提交，以免卡评测机**。~~\n\n#### 后记\n\n这个世界——一切——都源于过去。过去的影像，哪怕是欢乐的记忆，就像是白昼过后的黑夜，渐渐导致了这份世界末日。\n\n泪水盈眶。对立的眼神转为一片黑暗。\n\n对立与这些玻璃起了共鸣，围绕于四周的回忆之壳开始崩裂。\n\n对立就身处其中，站在那炫目的光芒前方，已经没有任何情感了。\n\n扭曲的迷宫，也在对立的力量下，悉数损毁……\n\n时光逝去，对立变了。不再激情地收集回忆，而是近乎无意识地走在这世界之中，并不再抱有任何雄心壮志。\n\n如今，对立正在一个破旧坍塌的建筑旁行走着，旋转着某天在废墟中找到的太阳伞。", "locale": "zh-CN"}}}
{"pid": "P10011", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2023"], "title": "[集训队互测 2023] 网格图最大流计数", "background": "", "description": "给定 $n,m,k$，和两个正整数序列 $a_{1...n},b_{1...m}$，以及一个 $k\\times k$ 的 $01$ 矩阵 $s_{1...k,1...k}$。\n\n考虑一张有向图 $G=(V,E)$，其中 $V=\\{S,T\\}\\cup(\\{0,1\\}\\times ([1,k]\\cap\\mathbb{Z})^2)$，而 $E=E_1\\cup E_2\\cup E_3$ 由三部分组成：\n\n- $E_1=\\{(S,(0,1,a_i)) \\mid 1\\le i\\le n\\}\\cup\\{((1,k,b_i),T)\\mid 1\\le i\\le m\\}$\n- $E_2=\\{((1,i,j),(0,i+1,j))\\mid1\\le i<k,1\\le j\\le k\\}\\cup \\{(1,i,j),(0,i,j+1))\\mid1\\le i\\le k,1\\le j<k\\}$\n- $E_3=\\{((0,i,j),(1,i,j))\\mid 1\\le i,j\\le k,s_{i,j}=1\\}$\n\n简单来说，你可以看成每个格子 $(i,j),1\\le i,j\\le k$ 被拆成了一个入点 $(0,i,j)$ 和一个出点 $(1,i,j)$。$E_1$ 描述了 $S,T$ 与这些点之间的边，由 $a,b$ 决定；$E_2$ 描述了每个格子的出点连向它上方和右方格子的入点的边；$E_3$ 描述了每个格子的入点连向出点的边，由 $s$ 决定。\n\n现在我们将 $G$ 看成一个网络，每条边的容量是 $1$。你需要求出以 $S$ 为源点，以 $T$ 为汇点的最大流，以及最大流的数量（两个流被认为是不同的，当且仅当存在一条边在两个流中的流量不同）。", "inputFormat": "第一行三个正整数 $n,m,k$。\n\n第二行 $n$ 个正整数 $1\\le a_1<a_2<...<a_n\\le k$。\n\n第三行 $m$ 个正整数 $1\\le b_1<b_2<...<b_m\\le k$。\n\n接下来 $k$ 行，每行一个长度为 $k$ 的 01 字符串，表示矩阵 $s$。", "outputFormat": "输出一行两个非负整数，分别表示最大流和最大流的数量，后者对 $10^9+7$ 取模。", "hint": "样例见下发文件。\n\n对于全部数据，$1\\le n,m\\le k\\le400$。\n\n| 子任务编号 | $n\\le$ | $k\\le$ |       特殊性质       | 子任务分值 |\n| :--------: | :----: | :----: | :------------------: | :--------: |\n|    $1$     |  $7$   |  $7$   |          无          |    $5$     |\n|    $2$     |  $18$  |  $18$  |          无          |    $5$     |\n|    $3$     |  $10$  | $400$  |          无          |    $10$    |\n|    $4$     | $100$  | $400$  |          无          |    $25$    |\n|    $5$     | $400$  | $400$  | $n=m$ 且最大流为 $n$ |    $10$    |\n|    $6$     | $400$  | $400$  |     最大流为 $n$     |    $25$    |\n|    $7$     | $400$  | $400$  |          无          |    $20$    |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 网格图最大流计数", "background": "", "description": "给定 $n,m,k$，和两个正整数序列 $a_{1...n},b_{1...m}$，以及一个 $k\\times k$ 的 $01$ 矩阵 $s_{1...k,1...k}$。\n\n考虑一张有向图 $G=(V,E)$，其中 $V=\\{S,T\\}\\cup(\\{0,1\\}\\times ([1,k]\\cap\\mathbb{Z})^2)$，而 $E=E_1\\cup E_2\\cup E_3$ 由三部分组成：\n\n- $E_1=\\{(S,(0,1,a_i)) \\mid 1\\le i\\le n\\}\\cup\\{((1,k,b_i),T)\\mid 1\\le i\\le m\\}$\n- $E_2=\\{((1,i,j),(0,i+1,j))\\mid1\\le i<k,1\\le j\\le k\\}\\cup \\{(1,i,j),(0,i,j+1))\\mid1\\le i\\le k,1\\le j<k\\}$\n- $E_3=\\{((0,i,j),(1,i,j))\\mid 1\\le i,j\\le k,s_{i,j}=1\\}$\n\n简单来说，你可以看成每个格子 $(i,j),1\\le i,j\\le k$ 被拆成了一个入点 $(0,i,j)$ 和一个出点 $(1,i,j)$。$E_1$ 描述了 $S,T$ 与这些点之间的边，由 $a,b$ 决定；$E_2$ 描述了每个格子的出点连向它上方和右方格子的入点的边；$E_3$ 描述了每个格子的入点连向出点的边，由 $s$ 决定。\n\n现在我们将 $G$ 看成一个网络，每条边的容量是 $1$。你需要求出以 $S$ 为源点，以 $T$ 为汇点的最大流，以及最大流的数量（两个流被认为是不同的，当且仅当存在一条边在两个流中的流量不同）。", "inputFormat": "第一行三个正整数 $n,m,k$。\n\n第二行 $n$ 个正整数 $1\\le a_1<a_2<...<a_n\\le k$。\n\n第三行 $m$ 个正整数 $1\\le b_1<b_2<...<b_m\\le k$。\n\n接下来 $k$ 行，每行一个长度为 $k$ 的 01 字符串，表示矩阵 $s$。", "outputFormat": "输出一行两个非负整数，分别表示最大流和最大流的数量，后者对 $10^9+7$ 取模。", "hint": "样例见下发文件。\n\n对于全部数据，$1\\le n,m\\le k\\le400$。\n\n| 子任务编号 | $n\\le$ | $k\\le$ |       特殊性质       | 子任务分值 |\n| :--------: | :----: | :----: | :------------------: | :--------: |\n|    $1$     |  $7$   |  $7$   |          无          |    $5$     |\n|    $2$     |  $18$  |  $18$  |          无          |    $5$     |\n|    $3$     |  $10$  | $400$  |          无          |    $10$    |\n|    $4$     | $100$  | $400$  |          无          |    $25$    |\n|    $5$     | $400$  | $400$  | $n=m$ 且最大流为 $n$ |    $10$    |\n|    $6$     | $400$  | $400$  |     最大流为 $n$     |    $25$    |\n|    $7$     | $400$  | $400$  |          无          |    $20$    |", "locale": "zh-CN"}}}
{"pid": "P10012", "type": "P", "difficulty": 7, "samples": [["10 10 0 0\n[)]]((()][\n2 10 6\n1 6 6\n1 3 6\n2 5 7\n2 3 3\n2 10 4\n1 7 1\n2 4 4\n2 4 2\n1 5 5\n", "1\n0\n0\n1\n0\n0\n"], ["20 20 0 0\n[)])[)[](()((]]([[)[\n2 9 3\n2 8 10\n1 4 15\n1 5 9\n1 16 10\n1 18 20\n1 1 8\n2 8 9\n1 2 16\n1 10 13\n1 16 9\n1 8 1\n2 20 7\n2 14 11\n1 3 16\n1 15 18\n1 6 4\n2 10 7\n2 2 4\n2 13 2\n", "2\n0\n0\n1\n2\n1\n0\n4\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["集训队互测", "2023"], "title": "[集训队互测 2023] 落日珊瑚", "background": "", "description": "给一个长度为 $n$、包含方括号和圆括号的括号串，定义一个串 $S$ 合法，当且仅当以下几种情况之一：\n\n1.  $S$ 为空串；\n1.  $S= [T]$ 且 $T$ 合法；\n1.  $S= (T)$ 且 $T$ 合法；\n1.  $S=TU$ 且 $T, U$ 合法。\n\n比如 ```()```，```[()]``` 都是一个合法的括号串，但 ```[()]())``` 不是。\n\n定义一个操作叫选择一个区间 $[l, r]$，并把所有在区间里的字符从方括号变圆括号，从圆括号变方括号。\n\n定义一个括号串的权值 $val(S)$ 为：如果这个括号串能通过操作变成合法，就是最小的操作次数；否则是 $0$。\n\n给出 $q$ 次修改查询，有以下两种可能。\n\n1.  修改，给出一个区间 $[l, r]$ 把所有在区间里的字符从方括号变圆括号，从圆括号变方括号。\n2.  查询，给出一个区间 $[l, r]$，求 $\\sum_{[l', r'] \\in [l, r]} val(s[l', r'])$。", "inputFormat": "第一行四个整数 $n, q, T, subtaskid$，分别表示字符串长度，操作次数，强制在线的参数，子任务编号。\n\n接下来一行一个长度为 $n$ 的字符串。\n\n接下来 $q$ 行，每行三个数 $opt, L, R$，表示一次操作。\n\n强制在线，真实的 $l = \\min((L + T \\cdot lastans) \\bmod n + 1, (R + T \\cdot lastans) \\bmod n + 1)$，$r = \\max((L + T \\cdot lastans) \\bmod n + 1, (R + T \\cdot lastans) \\bmod n + 1)$ 其中 $lastans$ 是上一次询问的答案，如果没有上次询问则为 $0$。\n\n**请注意，即使是离线的部分分，也有可能 $L \\neq l$，$R \\neq r$**。", "outputFormat": "若干行，每次询问输出一个答案。", "hint": "对于所有数据，$1 \\le n, q \\le 5\\cdot 10^5$，$0 \\le T \\le 10^9$，$1 \\le l, r \\le n$，$1 \\le opt \\le 2$。\n\n| 子任务编号 |  $n, q \\le $  | 特殊性质 | 分值 |\n| :--------: | :-----------: | :------: | :--: |\n|     1      |      $100$      |    E     |  5   |\n|     2      |     $6000$      |    E     |  5   |\n|     3      |    $10^5$     |    AE    |  5   |\n|     4      | $2\\cdot 10^5$ |    BE    |  5   |\n|     5      | $2\\cdot 10^5$ |   CDE    |  5   |\n|     6      | $2\\cdot 10^5$ |    CE    |  10  |\n|     7      | $2\\cdot 10^5$ |    DE    |  10  |\n|     8      | $2\\cdot 10^5$ |    E     |  10  |\n|     9      | $2\\cdot 10^5$ |    无    |  20  |\n|     10     | $5\\cdot 10^5$ |    无    |  25  |\n\n\n\nA 性质：每个位置有 $\\frac{1}{4}$ 的概率为方圆左右括号。\n\nB 性质：保证没有修改。\n\nC 性质：保证修改为单点修改。\n\nD 性质：保证查询区间 $[l, r]$ 满足 $S[l, r]$ 经过若干次操作可以变成合法串，且不存在另一个 $k \\in [l, r)$，使得 $S[l, k]$ 可以经过若干次操作变成合法串。\n\nE 性质：保证 $T = 0$，即可以离线。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 落日珊瑚", "background": "", "description": "给一个长度为 $n$、包含方括号和圆括号的括号串，定义一个串 $S$ 合法，当且仅当以下几种情况之一：\n\n1.  $S$ 为空串；\n1.  $S= [T]$ 且 $T$ 合法；\n1.  $S= (T)$ 且 $T$ 合法；\n1.  $S=TU$ 且 $T, U$ 合法。\n\n比如 ```()```，```[()]``` 都是一个合法的括号串，但 ```[()]())``` 不是。\n\n定义一个操作叫选择一个区间 $[l, r]$，并把所有在区间里的字符从方括号变圆括号，从圆括号变方括号。\n\n定义一个括号串的权值 $val(S)$ 为：如果这个括号串能通过操作变成合法，就是最小的操作次数；否则是 $0$。\n\n给出 $q$ 次修改查询，有以下两种可能。\n\n1.  修改，给出一个区间 $[l, r]$ 把所有在区间里的字符从方括号变圆括号，从圆括号变方括号。\n2.  查询，给出一个区间 $[l, r]$，求 $\\sum_{[l', r'] \\in [l, r]} val(s[l', r'])$。", "inputFormat": "第一行四个整数 $n, q, T, subtaskid$，分别表示字符串长度，操作次数，强制在线的参数，子任务编号。\n\n接下来一行一个长度为 $n$ 的字符串。\n\n接下来 $q$ 行，每行三个数 $opt, L, R$，表示一次操作。\n\n强制在线，真实的 $l = \\min((L + T \\cdot lastans) \\bmod n + 1, (R + T \\cdot lastans) \\bmod n + 1)$，$r = \\max((L + T \\cdot lastans) \\bmod n + 1, (R + T \\cdot lastans) \\bmod n + 1)$ 其中 $lastans$ 是上一次询问的答案，如果没有上次询问则为 $0$。\n\n**请注意，即使是离线的部分分，也有可能 $L \\neq l$，$R \\neq r$**。", "outputFormat": "若干行，每次询问输出一个答案。", "hint": "对于所有数据，$1 \\le n, q \\le 5\\cdot 10^5$，$0 \\le T \\le 10^9$，$1 \\le l, r \\le n$，$1 \\le opt \\le 2$。\n\n| 子任务编号 |  $n, q \\le $  | 特殊性质 | 分值 |\n| :--------: | :-----------: | :------: | :--: |\n|     1      |      $100$      |    E     |  5   |\n|     2      |     $6000$      |    E     |  5   |\n|     3      |    $10^5$     |    AE    |  5   |\n|     4      | $2\\cdot 10^5$ |    BE    |  5   |\n|     5      | $2\\cdot 10^5$ |   CDE    |  5   |\n|     6      | $2\\cdot 10^5$ |    CE    |  10  |\n|     7      | $2\\cdot 10^5$ |    DE    |  10  |\n|     8      | $2\\cdot 10^5$ |    E     |  10  |\n|     9      | $2\\cdot 10^5$ |    无    |  20  |\n|     10     | $5\\cdot 10^5$ |    无    |  25  |\n\n\n\nA 性质：每个位置有 $\\frac{1}{4}$ 的概率为方圆左右括号。\n\nB 性质：保证没有修改。\n\nC 性质：保证修改为单点修改。\n\nD 性质：保证查询区间 $[l, r]$ 满足 $S[l, r]$ 经过若干次操作可以变成合法串，且不存在另一个 $k \\in [l, r)$，使得 $S[l, k]$ 可以经过若干次操作变成合法串。\n\nE 性质：保证 $T = 0$，即可以离线。", "locale": "zh-CN"}}}
{"pid": "P10013", "type": "P", "difficulty": 6, "samples": [["5\n1 1 3 2\n3 5 4 4 1\n", "18 27 27 15 15 \n"], ["5\n1 1 3 1\n1 2 3 4 5\n", "12 42 32 52 42\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2023", "动态规划优化", "树形 DP"], "title": "[集训队互测 2023] Tree Topological Order Counting", "background": "", "description": "给定一颗 $n$ 个点的有根树，$1$ 是根，记 $u$ 的父亲是 $fa_u$。另给出一长度为 $n$ 的权值序列 $b$。\n\n称一个长度为 $n$ 的排列 $a$ 为这颗树的合法拓扑序，当且仅当 $\\forall 2 \\le u \\le n,a_u > a_{fa_u}$。\n\n对每个点 $u$，定义 $f(u)$ 为，在所有这颗树的合法拓扑序中，$b_{a_u}$ 之和。\n\n现在对 $1 \\le u \\le n$，求 $f(u) \\bmod 10^9+7$。", "inputFormat": "第一行一个整数 $n$ 表示树的点数。\n\n第二行 $n-1$ 个整数，第 $i$ 个表示 $fa_{i+1}$，描述树的结构。\n\n第三行 $n$ 个整数，第 $i$ 个表示 $b_i$，描述权值序列。", "outputFormat": "一行 $n$ 个整数，第 $i$ 个表示 $f(i) \\bmod 10^9+7$。", "hint": "| Subtask | $n \\le$ | 特殊限制 | 分值 |\n| :-----: | :-----: | :------: | :--: |\n|   $1$   |  $10$   |    无    | $5$  |\n|   $2$   |  $20$   |    无    | $10$ |\n|   $3$   |  $100$  |    无    | $15$ |\n|   $4$   |  $350$  |    无    | $15$ |\n|   $5$   | $3000$  |    A     | $15$ |\n|   $6$   | $3000$  |    无    | $20$ |\n|   $7$   | $5000$  |    无    | $20$ |\n\n特殊限制 A：$\\forall 1 \\le i \\le n,b_i=i$。\n\n对于所有数据：$2 \\le n \\le 5000$，$1 \\le fa_i < i$，$0 \\le b_i < 10^9+7$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] Tree Topological Order Counting", "background": "", "description": "给定一颗 $n$ 个点的有根树，$1$ 是根，记 $u$ 的父亲是 $fa_u$。另给出一长度为 $n$ 的权值序列 $b$。\n\n称一个长度为 $n$ 的排列 $a$ 为这颗树的合法拓扑序，当且仅当 $\\forall 2 \\le u \\le n,a_u > a_{fa_u}$。\n\n对每个点 $u$，定义 $f(u)$ 为，在所有这颗树的合法拓扑序中，$b_{a_u}$ 之和。\n\n现在对 $1 \\le u \\le n$，求 $f(u) \\bmod 10^9+7$。", "inputFormat": "第一行一个整数 $n$ 表示树的点数。\n\n第二行 $n-1$ 个整数，第 $i$ 个表示 $fa_{i+1}$，描述树的结构。\n\n第三行 $n$ 个整数，第 $i$ 个表示 $b_i$，描述权值序列。", "outputFormat": "一行 $n$ 个整数，第 $i$ 个表示 $f(i) \\bmod 10^9+7$。", "hint": "| Subtask | $n \\le$ | 特殊限制 | 分值 |\n| :-----: | :-----: | :------: | :--: |\n|   $1$   |  $10$   |    无    | $5$  |\n|   $2$   |  $20$   |    无    | $10$ |\n|   $3$   |  $100$  |    无    | $15$ |\n|   $4$   |  $350$  |    无    | $15$ |\n|   $5$   | $3000$  |    A     | $15$ |\n|   $6$   | $3000$  |    无    | $20$ |\n|   $7$   | $5000$  |    无    | $20$ |\n\n特殊限制 A：$\\forall 1 \\le i \\le n,b_i=i$。\n\n对于所有数据：$2 \\le n \\le 5000$，$1 \\le fa_i < i$，$0 \\le b_i < 10^9+7$。", "locale": "zh-CN"}}}
{"pid": "P10014", "type": "P", "difficulty": 7, "samples": [["3 1\n2\n1 5\n3\n1 2 3\n1\n3\n", "Kaguya\nLily\nKaguya\n"], ["4 2\n2\n1 2\n2\n1 3\n3\n5 6 7\n1\n3\n", "Kaguya\nLily\nKaguya\nKaguya\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["博弈论", "集训队互测", "2023"], "title": "[集训队互测 2023] 茧", "background": "", "description": "Lily 是一个有趣的女孩子。她经常和 Kaguya 玩一些奇怪的游戏。\n\n今天她们在玩一个名为 nim 的游戏。具体地，nim 游戏的规则如下：\n\n- 有若干排数目已知的棋子，两人轮流从任意一排移除任意正整数枚棋子。\n- Lily 先手，无法操作者负，即移除最后一枚棋子者获胜。\n\n因为其最优策略非常简单，所以几局过后，她们就开始感到无趣了。于是，她们在原有规则的基础上增加了一条规则：\n\n- 在一排 $x$ 枚棋子中可以移除 $y$ 枚，当且仅当 $y^k \\le x$。\n\n这下游戏变得有趣了。不过，由于策略比较复杂，Lily 在计算的时候常常感到力不从心。\n\n可以证明，这个游戏的任意一个局面都满足：要么 Lily 有必胜策略，要么 Kaguya 有必胜策略。\n\n于是，Lily 想请你编写一个程序来计算某个局面下谁有必胜策略（Lily 总是先手），以便复盘时分析哪次操作失误了。\n\n由于求知欲旺盛的 Lily 可能会对局面进行比较细致的分析，所以你需要回答她的多次询问。\n\n由于所有局面都是复盘同一局游戏时衍生出来的，所以所有询问的参数 $k$ 都相同。\n\n**本题询问的局面形式比较特殊，详见输入格式。**", "inputFormat": "输入的第一行包含两个整数 $t, k$，分别表示询问次数和操作中的参数。\n\n接下来依次输入每次询问，对于每次询问：\n\n输入的第一行包含一个整数 $n$。\n\n输入的第二行包含 $n$ 个整数 $a_1, \\dots, a_n$。\n\n$(n, a_{1 \\dots n})$ 表示有 $\\sum a_i$ 排棋子，各排所含棋子数分别为 $1 \\dots a_1, 1 \\dots a_2, \\dots, 1 \\dots a_n$。\n\n如果你对博弈论比较熟悉的话，不难发现题意可以转化为：\n\n- 记一排 $x$ 个棋子的 [Grundy value](https://en.wikipedia.org/wiki/Sprague%E2%80%93Grundy_theorem) 为 $g(x)$，设 $h(x)$ 为 $g(x)$ 的前缀异或和，求 $h(a_1) \\dots h(a_n)$ 的异或和是否为 $0$。", "outputFormat": "对于每次询问输出一行一个字符串。\n\n- 若 Lily 有必胜策略，输出 `Lily`；\n- 若 Kaguya 有必胜策略，输出 `Kaguya`。", "hint": "样例三、四、五见下发文件。\n\n对于所有测试数据保证：$1 \\le k \\le 5$，$1 \\le n, \\sum n \\le 10^5$，$1 \\le a_i \\lt 2^{60}$。\n\n每个子任务的具体限制见下表：\n\n| 子任务编号 | $n$                        | $k$             | $a_i$          | 特殊性质 | 分值 |\n| ---------- | -------------------------- | --------------- | -------------- | -------- | ---- |\n| 1          | $\\sum n \\le 10^5$          | $k = 1$         | $a_i < 2^{60}$ |          | $5$  |\n| 2          | $\\sum n \\le 10^5$          | $2 \\le k \\le 5$ | $a_i < 2^{16}$ |          | $5$  |\n| 3          | $\\sum n \\le 10^5$          | $2 \\le k \\le 5$ | $a_i < 2^{22}$ |          | $10$ |\n| 4          | $\\sum n \\le 10^3$，$n = 2$ | $2 \\le k \\le 3$ | $a_i < 2^{32}$ | A        | $10$ |\n| 5          | $\\sum n \\le 10^3$          | $2 \\le k \\le 5$ | $a_i < 2^{32}$ | A        | $10$ |\n| 6          | $\\sum n \\le 10^5$          | $k = 2$         | $a_i < 2^{60}$ | A        | $10$ |\n| 7          | $\\sum n \\le 10^5$          | $k = 3$         | $a_i < 2^{60}$ | A        | $10$ |\n| 8          | $\\sum n \\le 10^3$          | $k = 2$         | $a_i < 2^{32}$ |          | $10$ |\n| 9          | $\\sum n \\le 10^3$          | $k = 3$         | $a_i < 2^{32}$ |          | $10$ |\n| 10         | $\\sum n \\le 10^5$          | $1 \\le k \\le 5$ | $a_i < 2^{60}$ |          | $20$ |\n\n特殊性质 A：保证 $2 \\mid n$，且 $a_{2k - 1} = a_{2k} - 1 \\pod{1 \\le k \\le \\frac n 2}$。\n\n提示：如果你得到了预期之外的 TLE，你或许可以尝试优化你的时间复杂度。\n\n> 微调了题面里的几处用词（）\n>\n> 原题面请以 QOJ 为准（）", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 茧", "background": "", "description": "Lily 是一个有趣的女孩子。她经常和 Kaguya 玩一些奇怪的游戏。\n\n今天她们在玩一个名为 nim 的游戏。具体地，nim 游戏的规则如下：\n\n- 有若干排数目已知的棋子，两人轮流从任意一排移除任意正整数枚棋子。\n- Lily 先手，无法操作者负，即移除最后一枚棋子者获胜。\n\n因为其最优策略非常简单，所以几局过后，她们就开始感到无趣了。于是，她们在原有规则的基础上增加了一条规则：\n\n- 在一排 $x$ 枚棋子中可以移除 $y$ 枚，当且仅当 $y^k \\le x$。\n\n这下游戏变得有趣了。不过，由于策略比较复杂，Lily 在计算的时候常常感到力不从心。\n\n可以证明，这个游戏的任意一个局面都满足：要么 Lily 有必胜策略，要么 Kaguya 有必胜策略。\n\n于是，Lily 想请你编写一个程序来计算某个局面下谁有必胜策略（Lily 总是先手），以便复盘时分析哪次操作失误了。\n\n由于求知欲旺盛的 Lily 可能会对局面进行比较细致的分析，所以你需要回答她的多次询问。\n\n由于所有局面都是复盘同一局游戏时衍生出来的，所以所有询问的参数 $k$ 都相同。\n\n**本题询问的局面形式比较特殊，详见输入格式。**", "inputFormat": "输入的第一行包含两个整数 $t, k$，分别表示询问次数和操作中的参数。\n\n接下来依次输入每次询问，对于每次询问：\n\n输入的第一行包含一个整数 $n$。\n\n输入的第二行包含 $n$ 个整数 $a_1, \\dots, a_n$。\n\n$(n, a_{1 \\dots n})$ 表示有 $\\sum a_i$ 排棋子，各排所含棋子数分别为 $1 \\dots a_1, 1 \\dots a_2, \\dots, 1 \\dots a_n$。\n\n如果你对博弈论比较熟悉的话，不难发现题意可以转化为：\n\n- 记一排 $x$ 个棋子的 [Grundy value](https://en.wikipedia.org/wiki/Sprague%E2%80%93Grundy_theorem) 为 $g(x)$，设 $h(x)$ 为 $g(x)$ 的前缀异或和，求 $h(a_1) \\dots h(a_n)$ 的异或和是否为 $0$。", "outputFormat": "对于每次询问输出一行一个字符串。\n\n- 若 Lily 有必胜策略，输出 `Lily`；\n- 若 Kaguya 有必胜策略，输出 `Kaguya`。", "hint": "样例三、四、五见下发文件。\n\n对于所有测试数据保证：$1 \\le k \\le 5$，$1 \\le n, \\sum n \\le 10^5$，$1 \\le a_i \\lt 2^{60}$。\n\n每个子任务的具体限制见下表：\n\n| 子任务编号 | $n$                        | $k$             | $a_i$          | 特殊性质 | 分值 |\n| ---------- | -------------------------- | --------------- | -------------- | -------- | ---- |\n| 1          | $\\sum n \\le 10^5$          | $k = 1$         | $a_i < 2^{60}$ |          | $5$  |\n| 2          | $\\sum n \\le 10^5$          | $2 \\le k \\le 5$ | $a_i < 2^{16}$ |          | $5$  |\n| 3          | $\\sum n \\le 10^5$          | $2 \\le k \\le 5$ | $a_i < 2^{22}$ |          | $10$ |\n| 4          | $\\sum n \\le 10^3$，$n = 2$ | $2 \\le k \\le 3$ | $a_i < 2^{32}$ | A        | $10$ |\n| 5          | $\\sum n \\le 10^3$          | $2 \\le k \\le 5$ | $a_i < 2^{32}$ | A        | $10$ |\n| 6          | $\\sum n \\le 10^5$          | $k = 2$         | $a_i < 2^{60}$ | A        | $10$ |\n| 7          | $\\sum n \\le 10^5$          | $k = 3$         | $a_i < 2^{60}$ | A        | $10$ |\n| 8          | $\\sum n \\le 10^3$          | $k = 2$         | $a_i < 2^{32}$ |          | $10$ |\n| 9          | $\\sum n \\le 10^3$          | $k = 3$         | $a_i < 2^{32}$ |          | $10$ |\n| 10         | $\\sum n \\le 10^5$          | $1 \\le k \\le 5$ | $a_i < 2^{60}$ |          | $20$ |\n\n特殊性质 A：保证 $2 \\mid n$，且 $a_{2k - 1} = a_{2k} - 1 \\pod{1 \\le k \\le \\frac n 2}$。\n\n提示：如果你得到了预期之外的 TLE，你或许可以尝试优化你的时间复杂度。\n\n> 微调了题面里的几处用词（）\n>\n> 原题面请以 QOJ 为准（）", "locale": "zh-CN"}}}
{"pid": "P10015", "type": "P", "difficulty": 7, "samples": [["2\n1 2 3 3\n2 1 4 4\n", "01\n2\n"], ["4\n1 1 5 5\n2 2 6 6\n3 3 7 7\n4 4 8 8\n", "0000\n2\n"], ["2\n1 1 4 4\n2 2 3 3\n", "00\n2\n"], ["3\n1 2 4 5\n2 3 5 6\n3 1 6 4\n", "-1\n0\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2023"], "title": "[集训队互测 2023] 左蓝右红", "background": "小 S 是一个喜欢音游的女孩子。\n\n2077 年 7 月 7 日，某三维立体音乐游戏的 20.7.7 版本更新了一个塞满直角蛇的谱面 Tnemitnep [Beyond 18+]。但是当小 S 开始游玩这个谱面之后发现，由于游戏 bug，所有的蛇的色彩指示都没了……\n\n但是小 S 作为 ptt 20.77 的 18 星高端玩家，首个理论值这首曲目的位置她势在必得，因此她不想等游戏开发者修复 bug。她决定：通过这个游戏的机制自行计算出所有蛇原本的颜色！\n\n不幸的是，小 S 经过一些简单的推理，发现这个游戏的机制并不足以唯一确定所有蛇的颜色。因此小 S 首先希望通过这个游戏的“左蓝右红”规则计算出一种反手尽量少的染色可能性；同时计算出不同的染色方案数，以获知自己在最坏情况下需要尝试多少次才能正确地接住所有蛇。\n\n小 S 将这个问题抽象成了一个 OI 问题，可是小 S 并不是很会 OI，于是她找到了即将参加 IOI 2024 的你。你能帮助小 S 在别人都还在莫名其妙红蛇 Track Lost 的时候拿下 Tnemitnep BYD 的首杀吗？", "description": "在平面直角坐标系上给定 $n$ 个矩形，形成若干个交点，每个矩形的所有边都平行于坐标轴。**保证没有两个矩形的两条边共线。**\n\n矩形之间会形成若干个交点，每一个矩形都被它上面的交点分成若干段。定义属于一个矩形上的**一段**是该矩形上相邻的两个交点之间的部分。也就是说一个矩形上如果有 $n$ 个交点，就会被划分成 $n$ 段。\n\n现在将每一个矩形上的每一段染色为蓝色或红色。要求：\n\n- 与同一个交点相邻的**同属于一个矩形的**两段不同色；\n- 所有红线形成若干互不相交的封闭曲线；\n- 所有蓝线形成若干互不相交的封闭曲线。\n\n定义两个图形 $R,B$：\n\n- $R$ 为删去所有蓝线后，所有被**奇数个**红色封闭曲线包含的点组成的集合；\n- $B$ 为删去所有红线后，所有被**奇数个**蓝色封闭曲线包含的点组成的集合。\n\n一个方案合法当且仅当它满足上述所有条件，并且**使得 $R\\cap B$ 里面只有有限个点**。\n\n**如果无法理解上述定义，可以参考样例解释。**\n\n你需要分别求出：\n\n- 字典序最小的合法染色方案（字典序在输出格式里面有定义）。\n- 合法染色方案数，对 $20,051,131$（质数）取模。两个染色方案不同当且仅当存在一段，在一种方案中被染成红色，在另一种方案中被染成蓝色。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，第 $i$ 行 4 个整数 $x_{1,i},y_{1,i},x_{2,i},y_{2,i}$，前两个表示左下角坐标，后两个表示右上角坐标。", "outputFormat": "第一行输出字典序最小的合法方案：如果无解，输出一行 `-1`；否则输出一个长度为 $n$ 的 0/1 串。如果在你的方案中，按输入顺序给出的第 $i$ 个矩形的左下角是红色，则你输出的第 $i$ 个整数应该是 $0$；否则应该是 $1$。可以证明给定这些数之后能够唯一确定整个染色方案。如果有多解，你输出的解必须使得**上面描述的 01 序列字典序最小**。\n\n第二行输出合法染色方案数，对 $20,051,131$ 取模。无解时应输出 $0$。", "hint": "样例 5、6、7 见附件。\n\n---\n\n样例 1 解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pnklrf6w.png?x-oss-process=image/resize,m_lfit,h_250,w_750)\n\n如图是给定的矩形在平面直角坐标系上的形态。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wy02h10g.png?x-oss-process=image/resize,m_lfit,h_250,w_750)\n\n如图，标出颜色的地方是属于第 1 个矩形的两段。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/aqhxc9mh.png?x-oss-process=image/resize,m_lfit,h_250,w_750)\n\n如图，标出颜色的地方是属于第 2 个矩形的两段。按照上述图片给出的颜色进行染色可以得到样例输出中给出的合法方案：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kxybwupj.png?x-oss-process=image/resize,m_lfit,h_250)\n\n如下图，左侧方案是不合法的，因为与用圈标出的交点相邻的同属于一个矩形的两段同色；右侧方案也是不合法的，因为 $R$ 与 $B$ 交在图中的紫色正方形内，$R\\cap B$ 包含无限多个点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3pwpnuap.png?x-oss-process=image/resize,m_lfit,h_250)\n\n如下方案是合法的，但是对应字符串 `10` 不是字典序最小的。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bbo2v7ko.png?x-oss-process=image/resize,m_lfit,h_250)\n\n---\n\n样例 2 解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7ukggac8.png?x-oss-process=image/resize,m_lfit,h_250)\n\n左侧的图为给定的所有矩形。\n\n中间的图表示对应的染色方案。每一个矩形都包含 $6$ 段，并且满足与任何一个交点相邻的同属于一个矩形的两段不同色。\n\n右侧的图中，用红色区域标出 $R$ 的范围，蓝色区域标出 $B$ 的范围。两图形的交只包含 $12$ 个点。\n\n---\n\n样例 3 解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/si28rfhb.png?x-oss-process=image/resize,m_lfit,h_250)\n\n如图，该样例中，因为环内部的部分被 $2$ 条红色封闭曲线包含，$2$ 是偶数，所以环内部不属于 $R$，$R$ 形成一个环。\n\n---\n\n数据范围：\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 2\\times 10^5$，$x_{1,i}<x_{2,i}$，$y_{1,i}<y_{2,i}$，$\\{x_{i,j}|1\\leq i\\leq 2,1\\leq j\\leq n\\}=\\{y_{i,j}|1\\leq i\\leq 2,1\\leq j\\leq n\\}=\\{1,2,3,\\cdots,2n\\}$。\n\n- Subtask 1（5 pts）：矩形之间互不相交。\n- Subtask 2（20 pts）：$n\\leq 13$。\n- Subtask 3（20 pts）：$n\\leq 200$。\n- Subtask 4（25 pts）：$n\\leq 2000$。\n- Subtask 5（30 pts）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 左蓝右红", "background": "小 S 是一个喜欢音游的女孩子。\n\n2077 年 7 月 7 日，某三维立体音乐游戏的 20.7.7 版本更新了一个塞满直角蛇的谱面 Tnemitnep [Beyond 18+]。但是当小 S 开始游玩这个谱面之后发现，由于游戏 bug，所有的蛇的色彩指示都没了……\n\n但是小 S 作为 ptt 20.77 的 18 星高端玩家，首个理论值这首曲目的位置她势在必得，因此她不想等游戏开发者修复 bug。她决定：通过这个游戏的机制自行计算出所有蛇原本的颜色！\n\n不幸的是，小 S 经过一些简单的推理，发现这个游戏的机制并不足以唯一确定所有蛇的颜色。因此小 S 首先希望通过这个游戏的“左蓝右红”规则计算出一种反手尽量少的染色可能性；同时计算出不同的染色方案数，以获知自己在最坏情况下需要尝试多少次才能正确地接住所有蛇。\n\n小 S 将这个问题抽象成了一个 OI 问题，可是小 S 并不是很会 OI，于是她找到了即将参加 IOI 2024 的你。你能帮助小 S 在别人都还在莫名其妙红蛇 Track Lost 的时候拿下 Tnemitnep BYD 的首杀吗？", "description": "在平面直角坐标系上给定 $n$ 个矩形，形成若干个交点，每个矩形的所有边都平行于坐标轴。**保证没有两个矩形的两条边共线。**\n\n矩形之间会形成若干个交点，每一个矩形都被它上面的交点分成若干段。定义属于一个矩形上的**一段**是该矩形上相邻的两个交点之间的部分。也就是说一个矩形上如果有 $n$ 个交点，就会被划分成 $n$ 段。\n\n现在将每一个矩形上的每一段染色为蓝色或红色。要求：\n\n- 与同一个交点相邻的**同属于一个矩形的**两段不同色；\n- 所有红线形成若干互不相交的封闭曲线；\n- 所有蓝线形成若干互不相交的封闭曲线。\n\n定义两个图形 $R,B$：\n\n- $R$ 为删去所有蓝线后，所有被**奇数个**红色封闭曲线包含的点组成的集合；\n- $B$ 为删去所有红线后，所有被**奇数个**蓝色封闭曲线包含的点组成的集合。\n\n一个方案合法当且仅当它满足上述所有条件，并且**使得 $R\\cap B$ 里面只有有限个点**。\n\n**如果无法理解上述定义，可以参考样例解释。**\n\n你需要分别求出：\n\n- 字典序最小的合法染色方案（字典序在输出格式里面有定义）。\n- 合法染色方案数，对 $20,051,131$（质数）取模。两个染色方案不同当且仅当存在一段，在一种方案中被染成红色，在另一种方案中被染成蓝色。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，第 $i$ 行 4 个整数 $x_{1,i},y_{1,i},x_{2,i},y_{2,i}$，前两个表示左下角坐标，后两个表示右上角坐标。", "outputFormat": "第一行输出字典序最小的合法方案：如果无解，输出一行 `-1`；否则输出一个长度为 $n$ 的 0/1 串。如果在你的方案中，按输入顺序给出的第 $i$ 个矩形的左下角是红色，则你输出的第 $i$ 个整数应该是 $0$；否则应该是 $1$。可以证明给定这些数之后能够唯一确定整个染色方案。如果有多解，你输出的解必须使得**上面描述的 01 序列字典序最小**。\n\n第二行输出合法染色方案数，对 $20,051,131$ 取模。无解时应输出 $0$。", "hint": "样例 5、6、7 见附件。\n\n---\n\n样例 1 解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pnklrf6w.png?x-oss-process=image/resize,m_lfit,h_250,w_750)\n\n如图是给定的矩形在平面直角坐标系上的形态。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wy02h10g.png?x-oss-process=image/resize,m_lfit,h_250,w_750)\n\n如图，标出颜色的地方是属于第 1 个矩形的两段。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/aqhxc9mh.png?x-oss-process=image/resize,m_lfit,h_250,w_750)\n\n如图，标出颜色的地方是属于第 2 个矩形的两段。按照上述图片给出的颜色进行染色可以得到样例输出中给出的合法方案：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kxybwupj.png?x-oss-process=image/resize,m_lfit,h_250)\n\n如下图，左侧方案是不合法的，因为与用圈标出的交点相邻的同属于一个矩形的两段同色；右侧方案也是不合法的，因为 $R$ 与 $B$ 交在图中的紫色正方形内，$R\\cap B$ 包含无限多个点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3pwpnuap.png?x-oss-process=image/resize,m_lfit,h_250)\n\n如下方案是合法的，但是对应字符串 `10` 不是字典序最小的。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bbo2v7ko.png?x-oss-process=image/resize,m_lfit,h_250)\n\n---\n\n样例 2 解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7ukggac8.png?x-oss-process=image/resize,m_lfit,h_250)\n\n左侧的图为给定的所有矩形。\n\n中间的图表示对应的染色方案。每一个矩形都包含 $6$ 段，并且满足与任何一个交点相邻的同属于一个矩形的两段不同色。\n\n右侧的图中，用红色区域标出 $R$ 的范围，蓝色区域标出 $B$ 的范围。两图形的交只包含 $12$ 个点。\n\n---\n\n样例 3 解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/si28rfhb.png?x-oss-process=image/resize,m_lfit,h_250)\n\n如图，该样例中，因为环内部的部分被 $2$ 条红色封闭曲线包含，$2$ 是偶数，所以环内部不属于 $R$，$R$ 形成一个环。\n\n---\n\n数据范围：\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 2\\times 10^5$，$x_{1,i}<x_{2,i}$，$y_{1,i}<y_{2,i}$，$\\{x_{i,j}|1\\leq i\\leq 2,1\\leq j\\leq n\\}=\\{y_{i,j}|1\\leq i\\leq 2,1\\leq j\\leq n\\}=\\{1,2,3,\\cdots,2n\\}$。\n\n- Subtask 1（5 pts）：矩形之间互不相交。\n- Subtask 2（20 pts）：$n\\leq 13$。\n- Subtask 3（20 pts）：$n\\leq 200$。\n- Subtask 4（25 pts）：$n\\leq 2000$。\n- Subtask 5（30 pts）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P10016", "type": "P", "difficulty": 7, "samples": [["5 4\n1 0 0 0 1\n1 2\n1 3\n3 4\n3 5\n1 2 3\n2 1 3 3\n1 4 5\n2 3 5 3", "19561959\n19561959"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["集训队互测", "2023", "数论", "深度优先搜索 DFS", "最近公共祖先 LCA", "分块", "位运算"], "title": "[集训队互测 2023] 虹", "background": "", "description": "给定一棵 $n$ 个点的树。\n\n- 称点集 $S$ **连通**，当且仅当 $\\forall u,v \\in S$，所有 $u$ 到 $v$ 的简单路径上的点均在 $S$ 中。\n- 称点集 $S$ 是 $[l,r]$ 的**虹**，当且仅当 $S$ **连通**，且 $S$ 包含 $[l,r]$ 中的所有点。\n- 称点集 $S_0$ 是 $[l,r]$ 的**最小虹**，当且仅当 $S_0$ 是 $[l,r]$ 的所有**虹**中大小最小的。可以证明，$S_0$ 是唯一的。\n\n点带权，点 $u$ 的权值为 $w_u$，初始所有点权均为 $0$。同时，给定序列 $\\{z_1,z_2,\\cdots,z_n\\}$。\n\n给定 $q$ 次命令，每次命令形如以下两类之一：\n\n- `1 l r`：令 $S_0$ 为 $[l,r]$ 的**最小虹**，$\\forall u \\in S_0$，将 $w_u$ 加 $1$。\n- `2 l r u`：求 $\\left(\\sum_{i=l}^r 19901991^{z_{\\gcd(i,u)} w_i} \\right) \\bmod {20242024}$ 的值。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个非负整数，依次表示 $z_1,z_2,\\cdots,z_n$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，描述一条树上从 $u$ 到 $v$ 的边。\n\n最后 $q$ 行，每行 $3$ 或 $4$ 个正整数，描述一次命令。\n\n**注意：本题输入文件行末有 `\\r`，请选手自行过滤。**", "outputFormat": "对于每次询问（即第二类命令）输出答案。", "hint": "**本题采用捆绑测试**。\n\n对于所有测试数据保证：$1 \\le n, q \\le 8 \\times 10^4,0 \\le z_i \\le 10^9$，所有命令满足 $1 \\le l \\le r \\le n, 1 \\le u \\le n$，**保证第一类命令的 $(l,r)$ 随机生成**。随机生成方式如下：\n- 在 $[1,n] \\cap \\mathrm{Z}$ 中等概率随机生成 $l$。\n- 在 $[1,n] \\cap \\mathrm{Z}$ 中等概率随机生成 $r$。\n- 若 $l>r$，则交换 $l,r$。\n\n| 子任务编号 | 分值 | $n \\le$ | $q \\le$ | 特殊性质 | 子任务依赖 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :----------: |\n| $1$ | $10$ | $10^3$ | $10^3$ | 无 | 无 |\n| $2$ | $20$ | $65536$ | $65536$ | A, B | 无 |\n| $3$ | $20$ | $65536$ | $65536$ | A | 依赖于子任务 $2$ |\n| $4$ | $30$ | $65536$ | $65536$ | 无 | 依赖于子任务 $1,2,3$ |\n| $5$ | $20$ | $80000$ | $80000$ | 无 | 依赖于子任务 $1,2,3,4$ |\n\n特殊性质 A：保证所有第二类命令均在所有第一类命令之后。\n\n特殊性质 B：保证第二类命令次数 $\\le 20$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] 虹", "background": "", "description": "给定一棵 $n$ 个点的树。\n\n- 称点集 $S$ **连通**，当且仅当 $\\forall u,v \\in S$，所有 $u$ 到 $v$ 的简单路径上的点均在 $S$ 中。\n- 称点集 $S$ 是 $[l,r]$ 的**虹**，当且仅当 $S$ **连通**，且 $S$ 包含 $[l,r]$ 中的所有点。\n- 称点集 $S_0$ 是 $[l,r]$ 的**最小虹**，当且仅当 $S_0$ 是 $[l,r]$ 的所有**虹**中大小最小的。可以证明，$S_0$ 是唯一的。\n\n点带权，点 $u$ 的权值为 $w_u$，初始所有点权均为 $0$。同时，给定序列 $\\{z_1,z_2,\\cdots,z_n\\}$。\n\n给定 $q$ 次命令，每次命令形如以下两类之一：\n\n- `1 l r`：令 $S_0$ 为 $[l,r]$ 的**最小虹**，$\\forall u \\in S_0$，将 $w_u$ 加 $1$。\n- `2 l r u`：求 $\\left(\\sum_{i=l}^r 19901991^{z_{\\gcd(i,u)} w_i} \\right) \\bmod {20242024}$ 的值。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个非负整数，依次表示 $z_1,z_2,\\cdots,z_n$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，描述一条树上从 $u$ 到 $v$ 的边。\n\n最后 $q$ 行，每行 $3$ 或 $4$ 个正整数，描述一次命令。\n\n**注意：本题输入文件行末有 `\\r`，请选手自行过滤。**", "outputFormat": "对于每次询问（即第二类命令）输出答案。", "hint": "**本题采用捆绑测试**。\n\n对于所有测试数据保证：$1 \\le n, q \\le 8 \\times 10^4,0 \\le z_i \\le 10^9$，所有命令满足 $1 \\le l \\le r \\le n, 1 \\le u \\le n$，**保证第一类命令的 $(l,r)$ 随机生成**。随机生成方式如下：\n- 在 $[1,n] \\cap \\mathrm{Z}$ 中等概率随机生成 $l$。\n- 在 $[1,n] \\cap \\mathrm{Z}$ 中等概率随机生成 $r$。\n- 若 $l>r$，则交换 $l,r$。\n\n| 子任务编号 | 分值 | $n \\le$ | $q \\le$ | 特殊性质 | 子任务依赖 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :----------: |\n| $1$ | $10$ | $10^3$ | $10^3$ | 无 | 无 |\n| $2$ | $20$ | $65536$ | $65536$ | A, B | 无 |\n| $3$ | $20$ | $65536$ | $65536$ | A | 依赖于子任务 $2$ |\n| $4$ | $30$ | $65536$ | $65536$ | 无 | 依赖于子任务 $1,2,3$ |\n| $5$ | $20$ | $80000$ | $80000$ | 无 | 依赖于子任务 $1,2,3,4$ |\n\n特殊性质 A：保证所有第二类命令均在所有第一类命令之后。\n\n特殊性质 B：保证第二类命令次数 $\\le 20$。", "locale": "zh-CN"}}}
{"pid": "P10017", "type": "P", "difficulty": 7, "samples": [["9 0\n9\n1 2 1\n3 4 1\n5 6 1\n7 8 1\n2 0 0\n4 0 0\n6 0 0\n8 0 0\n9\n1 2 2\n3 4 1\n5 6 1\n7 8 1\n2 0 0\n4 0 0\n6 0 0\n8 0 0\n5\n1 2 2\n3 4 1\n0 3 1\n2 3 0\n17\n1 2 1\n2 3 0\n3 4 1\n4 0 0\n5 6 1\n6 7 0\n7 8 1\n8 0 0\n9 10 1\n10 11 0\n11 12 1\n12 0 0\n13 14 1\n14 15 0\n15 16 1\n16 0 0\n17\n1 2 1\n2 0 0\n3 4 1\n4 0 0\n5 6 1\n6 0 0\n7 8 1\n8 0 0\n9 10 1\n10 11 0\n11 12 1\n12 0 0\n13 14 1\n14 15 0\n15 16 1\n16 0 0\n17\n1 2 2\n2 0 2\n3 4 2\n4 0 2\n5 6 2\n6 0 2\n7 8 2\n8 0 2\n9 10 2\n10 11 2\n11 12 2\n12 0 2\n13 14 2\n14 15 2\n15 16 2\n16 0 2\n18\n1 2 1\n2 0 0\n3 4 1\n4 0 0\n5 6 1\n6 0 0\n7 8 1\n8 0 0\n9 10 1\n10 11 0\n11 12 1\n12 0 0\n13 14 1\n14 15 0\n15 16 1\n16 0 0\n0 17 2\n18\n1 2 2\n2 0 2\n3 4 2\n4 0 2\n5 6 2\n6 0 2\n7 8 2\n8 0 2\n9 10 2\n10 11 2\n11 12 2\n12 0 2\n13 14 2\n14 15 2\n15 16 2\n16 0 2\n17 0 2\n18\n1 2 2\n2 3 2\n3 4 2\n4 5 2\n5 6 2\n6 7 2\n7 8 2\n8 9 2\n9 10 2\n10 11 2\n11 12 2\n12 13 2\n13 14 2\n14 15 2\n15 16 2\n16 17 2\n17 0 2", "1\n8\n3\n1 1 1 1 0 0 0 0\n1 3\n5 6\n6 7\n9\n2\n0 1 1 1 0 0 0 0\n3 5\n1 7\n5\n2\n0 1 1 0\n4 3\n1 0\n16\n3\n1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0\n5 1\n13 14\n14 9\n14\n5\n1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0\n3 1\n5 6\n14 13\n14 7\n6 9\n16\n3\n0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0\n7 5\n1 3\n13 9\n15\n4\n1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0\n13 3\n1 7\n0 5\n17 9\n16\n4\n1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1\n1 7\n17 0\n5 3\n13 9\n18\n1\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n1 0"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["集训队互测", "2023", "Special Judge", "最近公共祖先 LCA", "均摊分析", "状压 DP"], "title": "[集训队互测 2023] Axium Crisis", "background": "在那灰暗的塔楼前，对立见到了些许光芒碎片。\n\n那些光芒碎片萦绕在对立身旁，宛如繁花点缀。\n\n步入那扭曲的迷宫，对立试图收集其中的纷争碎片，并尝试摧毁这个迷宫。\n\n对立的身旁充斥着光芒和纷争碎片，交错纷飞。\n\n终于，对立来到了那迷宫的最深处。\n\n在那片形状极其古怪的记忆残片上，反射的，是一个世界走向灭亡的回忆。\n\n末日来临，天空撕裂，大地崩坠。\n\n由于这块残片上所承载的「能量」实在过于巨大，对立试图使用其身旁的光芒和纷争碎片来缓和这份巨大的精神上的冲击。\n\n具体的，这块扭曲的残片形成一个「树」的结构，对立将在树的每条边上放上一片光芒或者纷争碎片。\n\n对立将会把这颗树上的边切割成若干条链，使得最终每条边恰好属于其中的某一条链。由于残片的特殊结构，树上的一个节点可以同时属于多条链。\n\n对立会取出一部分链，将放置碎片相同的前缀段进行合并，最后形成一颗新的树，也就是所谓的「Trie 树」。\n\n这颗新的树上的节点越多，就越能缓和对立的情绪，让其冷静下来。\n\n在疯狂中，对立已经给残片上的某些边放上了光芒碎片或者纷争碎片。\n\n一刹那的清醒间，对立意识到了些许不对。因此对立还可以往剩下的边上任意选择光芒或者纷争碎片。\n\n在恍惚间，对立发现自己并不知道如何放置并切割是最优的。\n\n思绪飞快地运转起来。怎样是最优的呢？\n\n相信你已有答案。", "description": "给定一颗 $n$ 个节点的树，节点编号 $0\\sim n-1$。\n\n边有边权，边权一般为 $0$ 或者 $1$；但有的边的边权还未确定。\n\n你要给每条未被确定边权的边确定一个 $0$ 或者 $1$ 的边权，然后从树上取出若干条有向路径，使得这些链两两之间满足**边不相交**。\n\n然后你会把这些路径插入一颗 0/1-Trie，你希望最大化这颗 0/1-Trie 上的节点数。（0/1-Trie 定义略）\n\n你可能需要构造具体的选择方案。", "inputFormat": "本题每个测试点中有多组测试数据。\n\n第一行两个整数 $T,o$，其中 $T$ 表示测试数据组数，$o$ 表示该测试点的一些特殊性质（请参见「数据范围与提示」一节的描述）。\n\n接下来有 $T$ 组测试数据。\n\n每组数据第一行一个整数 $n$，表示点的个数。\n\n接下来 $n-1$ 行，每行三个整数 $u,v,w$，表示一条连接点 $u,v$ 的边。当 $0\\le w\\le 1$ 时，表示这条边边权为 $w$；否则总有 $w=2$，表示这条边的边权还未确定。\n\n保证这些边形成一颗点集为 $0\\sim n-1$ 的树。", "outputFormat": "开头应当输出一个数 $c$（$c\\in\\{0,1\\}$），表示你是否选择在该测试点输出方案，我们会使用 Special Judge 来校验你的输出是否正确。**注意这将影响你在该测试点的得分上限，详见「数据范围与提示」一节的描述**。\n\n对于每组测试数据，首先输出一行一个数 $A$，表示该组数据的答案。\n\n当 $c=1$ 时，还需要继续按如下格式输出你所构造的方案：\n* 先输出一行一个数 $m$，表示你构造的方案中路径的数目。\n* 接下来一行 $n-1$ 个数，每个数为 $0$ 或者 $1$，表示按输入顺序各边的边权。**对于边权本身已经确定的边，请原样输出。**\n* 接下来 $m$ 行，每行两个数 $u,v$，表示树上一条从 $u$ 到 $v$ 的路径。要求 $u\\neq v$，且路径两两**边不相交**。", "hint": "#### 样例解释\n\n这组样例对应的答案文件为：\n\n```plain\n8\n9\n5\n16\n14\n16\n15\n16\n18\n```\n\n样例输出即 `.out` 文件，也就是你要输出的结果，在 $c=1$ 时需要构造一组合法方案。\n\n样例答案即 `.ans` 文件，该文件中仅会给出每组数据的答案，不会给出构造方案。\n\n接下来依次附上这 $9$ 组样例的图示（选择边权前 / 后各一张）。\n\n![sample0_1_1.png](https://sy.hhwdd.com/RequireFile.do?fid=01t7zGM4)![sample0_1_2.png](https://sy.hhwdd.com/RequireFile.do?fid=EHOyk2Uz)\n\n![sample0_2_1.png](https://sy.hhwdd.com/RequireFile.do?fid=FP2WnHn3)![sample0_2_2.png](https://sy.hhwdd.com/RequireFile.do?fid=c4cKvUgH)\n\n![sample0_3_1.png](https://sy.hhwdd.com/RequireFile.do?fid=U4UoWyyU)![sample0_3_2.png](https://sy.hhwdd.com/RequireFile.do?fid=59JlIWvn)\n\n![sample0_4_1.png](https://sy.hhwdd.com/RequireFile.do?fid=cm5NQIRx)![sample0_4_2.png](https://sy.hhwdd.com/RequireFile.do?fid=jM6lGPo8)\n\n![sample0_5_1.png](https://sy.hhwdd.com/RequireFile.do?fid=7jKRZ9i9)![sample0_5_2.png](https://sy.hhwdd.com/RequireFile.do?fid=Fb1HkD1s)\n\n![sample0_6_1.png](https://sy.hhwdd.com/RequireFile.do?fid=CbEmirO0)![sample0_6_2.png](https://sy.hhwdd.com/RequireFile.do?fid=4GrzzBbe)\n\n![sample0_7_1.png](https://sy.hhwdd.com/RequireFile.do?fid=hRWoM1xi)![sample0_7_2.png](https://sy.hhwdd.com/RequireFile.do?fid=8OgPPrFB)\n\n![sample0_8_1.png](https://sy.hhwdd.com/RequireFile.do?fid=ws6t9q9g)![sample0_8_2.png](https://sy.hhwdd.com/RequireFile.do?fid=RkDgZv7G)\n\n![sample0_9_1.png](https://sy.hhwdd.com/RequireFile.do?fid=MlI0m1pW)![sample0_9_2.png](https://sy.hhwdd.com/RequireFile.do?fid=KJLtHLs7)\n\n#### 更多样例\n\n**因为本题数据规模太大，直接提交评测会对评测机带来很大压力，本题将提供很多大样例；请尽量减少本题的提交次数。**\n\n更多样例请参见下发文件 `axiumcrisis*.in/ans`，共 $20$ 组，基本按照部分分的方法造。\n\n注意下发的答案文件中**没有给出构造方案**，仅会给出每组数据的答案。\n\n下发了一个 `checker.cpp`，你可以自行编译并在终端运行校验合法性。具体使用方法请参考「数据范围与提示」一节的描述。正式测评时使用的 Special Judge 与其并不相同。\n\n为了方便你更好地理解题意，此处额外附一个手搓的样例，这份样例未被放入下发文件。\n\n**建议使用该组样例及样例解释校验你对题意的理解，以免误读**。\n\n#### 数据范围与提示\n\n与[互测实际使用的版本](https://qoj.ac/problem/7769)不同，本题此处将采用数据范围更大的版本。\n\n对于所有的数据，保证 $2\\le n\\le18$，$1\\le T\\le3000$。\n\n具体的数据规模分布可以见下表，**各子任务等分，即满分均为 $\\rm5pts$**。其中形如 $(l,r)$ 的一列对应的数据表示 $l\\le n\\le r$ 的数据组数，「无限制」表示无额外限制。\n\n各子任务**捆绑评测**，其分数为该子任务各测试点分数最小值。子任务依赖意味着只有所依赖的子任务分数均非 $0$ 才会评测当前子任务，且分数与所依赖的子任务也取最小值。$o$ 的含义将在之后注明。\n\n|子任务|$(2,4)$|$(5,6)$|$(7,8)$|$(9,11)$|$(12,14)$|$(15,17)$|$(18,18)$|$o$|子任务依赖|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$1$|$\\le1000$|$=0$|$=0$|$=0$|$=0$|$=0$|$=0$|$=0$|无|\n|$2$|无限制|$\\le15$|$=0$|$=0$|$=0$|$=0$|$=0$|$=0$|$1$|\n|$3$|无限制|$\\le500$|$\\le10$|$=0$|$=0$|$=0$|$=0$|$=0$|$2$|\n|$4$|无限制|$\\le1000$|$\\le50$|$\\le10$|$=0$|$=0$|$=0$|$=2$|无|\n|$5$|无限制|$\\le1000$|$\\le50$|$\\le10$|$=0$|$=0$|$=0$|$=3$|无|\n|$6$|无限制|$\\le1000$|$\\le50$|$\\le10$|$=0$|$=0$|$=0$|$=4$|$4$|\n|$7$|无限制|$\\le1000$|$\\le50$|$\\le10$|$=0$|$=0$|$=0$|$=0$|$3,5,6$|\n|$8$|无限制|无限制|$\\le1000$|$\\le60$|$\\le10$|$=0$|$=0$|$=2$|$4$|\n|$9$|无限制|无限制|$\\le1000$|$\\le60$|$\\le10$|$=0$|$=0$|$=3$|$5$|\n|$10$|无限制|无限制|$\\le1000$|$\\le60$|$\\le10$|$=0$|$=0$|$=4$|$6,8$|\n|$11$|无限制|无限制|$\\le1000$|$\\le60$|$\\le10$|$=0$|$=0$|$=0$|$7,9,10$|\n|$12$|无限制|无限制|无限制|$\\le300$|$\\le30$|$\\le10$|$=0$|$=2$|$8$|\n|$13$|无限制|无限制|无限制|$\\le300$|$\\le30$|$\\le10$|$=0$|$=3$|$9$|\n|$14$|无限制|无限制|无限制|$\\le300$|$\\le30$|$\\le10$|$=0$|$=4$|$10,12$|\n|$15$|无限制|无限制|无限制|$\\le300$|$\\le30$|$\\le10$|$=0$|$=0$|$11,13,14$|\n|$16$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=1$|无|\n|$17$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=2$|$12$|\n|$18$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=3$|$13,16$|\n|$19$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=4$|$14,16,17$|\n|$20$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=0$|$15,18,19$|\n\n接下来阐述关于 $o$ 的特殊性质。\n* $o=0$ 时，不保证特殊性质。\n* $o=1$ 时，保证输入中 $w=0$。\n* $o=2$ 时，保证输入中 $w=2$。\n* $o=3$ 时，保证输入中 $w=0$ 或 $w=1$。\n* $o=4$ 时，保证输入中 $w=0$ 或 $w=2$。\n\n接下来阐述是否输出方案对答案带来的影响。\n* 如果选择了 $c=0$，则答案正确时，你将获得该测试点 $80\\%$ 的分数，否则该测试点不得分。\n* 如果选择了 $c=1$，则答案和构造方案**均正确**时，你将获得该测试点的全部分数，**否则该测试点不得分**。\n\n因此如果你的输出方案可能写错，请慎重考虑是否改为不输出方案。\n\n接下来介绍 `checker.cpp` 使用方法。\n\n`checker.cpp` 使用类似于 Testlib 的命令行格式，但是并不基于 Testlib，因此**不需要 `testlib.h` 文件**；同时**兼容 Lemon 格式**。具体的，你可以这么使用：\n\n打开终端，进入 `checker.cpp` 所在文件夹后，首先使用 `g++ checker.cpp -o checker` 命令生成可执行文件（需要本地默认采用 C++11 及以上标准）。\n\n假设输入文件为 `data.in`，输出文件为 `data.out`，标准答案文件为 `data.ans`，则你需要将可执行文件 `checker` 和 `data.in/out/ans` 文件放置于同一文件夹下，然后在终端中输入如下命令执行：\n* 如果你使用 Windows 操作系统，请在 cmd 中使用 `checker data.in data.out data.ans 5` 执行。\n* 如果你使用 Linux 操作系统，请在 bash 中使用 `./checker data.in data.out data.ans 5` 执行。\n\n如命令中去掉最后的这个 `5` 将认为 $c=0$ 时也为 AC。\n\n稍等片刻即会返回提示信息。\n\n如果你使用 Lemon 来进行本地评测，可以把 `checker.cpp` 的可执行文件直接作为 Lemon 中的「自定义校验器」使用。\n\n#### 后记\n\n透过指缝观看着那世界末日之景。对立咽了口口水，靠着那股不知名的勇气，将手从自己的脸上移开。\n\n对立伸出了手，把那世界尽头收入了自己所搜集的无数回忆之中。\n\n其余的悲惨记忆，在这枚残片的映衬下显得不足一提。\n\n对立确信自己已经变得足够强大，理所当然地想立刻把一切都摧毁。\n\n就这样，伴随着那抹真诚的微笑与疲惫的笑声，对立从天空中降落到了地面上。\n\n那座古老的塔楼在这般力量驱使下逐渐陨落。\n\n而对立则怀抱着英雄般的信念，坚定不移地迈步向前。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2023] Axium Crisis", "background": "在那灰暗的塔楼前，对立见到了些许光芒碎片。\n\n那些光芒碎片萦绕在对立身旁，宛如繁花点缀。\n\n步入那扭曲的迷宫，对立试图收集其中的纷争碎片，并尝试摧毁这个迷宫。\n\n对立的身旁充斥着光芒和纷争碎片，交错纷飞。\n\n终于，对立来到了那迷宫的最深处。\n\n在那片形状极其古怪的记忆残片上，反射的，是一个世界走向灭亡的回忆。\n\n末日来临，天空撕裂，大地崩坠。\n\n由于这块残片上所承载的「能量」实在过于巨大，对立试图使用其身旁的光芒和纷争碎片来缓和这份巨大的精神上的冲击。\n\n具体的，这块扭曲的残片形成一个「树」的结构，对立将在树的每条边上放上一片光芒或者纷争碎片。\n\n对立将会把这颗树上的边切割成若干条链，使得最终每条边恰好属于其中的某一条链。由于残片的特殊结构，树上的一个节点可以同时属于多条链。\n\n对立会取出一部分链，将放置碎片相同的前缀段进行合并，最后形成一颗新的树，也就是所谓的「Trie 树」。\n\n这颗新的树上的节点越多，就越能缓和对立的情绪，让其冷静下来。\n\n在疯狂中，对立已经给残片上的某些边放上了光芒碎片或者纷争碎片。\n\n一刹那的清醒间，对立意识到了些许不对。因此对立还可以往剩下的边上任意选择光芒或者纷争碎片。\n\n在恍惚间，对立发现自己并不知道如何放置并切割是最优的。\n\n思绪飞快地运转起来。怎样是最优的呢？\n\n相信你已有答案。", "description": "给定一颗 $n$ 个节点的树，节点编号 $0\\sim n-1$。\n\n边有边权，边权一般为 $0$ 或者 $1$；但有的边的边权还未确定。\n\n你要给每条未被确定边权的边确定一个 $0$ 或者 $1$ 的边权，然后从树上取出若干条有向路径，使得这些链两两之间满足**边不相交**。\n\n然后你会把这些路径插入一颗 0/1-Trie，你希望最大化这颗 0/1-Trie 上的节点数。（0/1-Trie 定义略）\n\n你可能需要构造具体的选择方案。", "inputFormat": "本题每个测试点中有多组测试数据。\n\n第一行两个整数 $T,o$，其中 $T$ 表示测试数据组数，$o$ 表示该测试点的一些特殊性质（请参见「数据范围与提示」一节的描述）。\n\n接下来有 $T$ 组测试数据。\n\n每组数据第一行一个整数 $n$，表示点的个数。\n\n接下来 $n-1$ 行，每行三个整数 $u,v,w$，表示一条连接点 $u,v$ 的边。当 $0\\le w\\le 1$ 时，表示这条边边权为 $w$；否则总有 $w=2$，表示这条边的边权还未确定。\n\n保证这些边形成一颗点集为 $0\\sim n-1$ 的树。", "outputFormat": "开头应当输出一个数 $c$（$c\\in\\{0,1\\}$），表示你是否选择在该测试点输出方案，我们会使用 Special Judge 来校验你的输出是否正确。**注意这将影响你在该测试点的得分上限，详见「数据范围与提示」一节的描述**。\n\n对于每组测试数据，首先输出一行一个数 $A$，表示该组数据的答案。\n\n当 $c=1$ 时，还需要继续按如下格式输出你所构造的方案：\n* 先输出一行一个数 $m$，表示你构造的方案中路径的数目。\n* 接下来一行 $n-1$ 个数，每个数为 $0$ 或者 $1$，表示按输入顺序各边的边权。**对于边权本身已经确定的边，请原样输出。**\n* 接下来 $m$ 行，每行两个数 $u,v$，表示树上一条从 $u$ 到 $v$ 的路径。要求 $u\\neq v$，且路径两两**边不相交**。", "hint": "#### 样例解释\n\n这组样例对应的答案文件为：\n\n```plain\n8\n9\n5\n16\n14\n16\n15\n16\n18\n```\n\n样例输出即 `.out` 文件，也就是你要输出的结果，在 $c=1$ 时需要构造一组合法方案。\n\n样例答案即 `.ans` 文件，该文件中仅会给出每组数据的答案，不会给出构造方案。\n\n接下来依次附上这 $9$ 组样例的图示（选择边权前 / 后各一张）。\n\n![sample0_1_1.png](https://sy.hhwdd.com/RequireFile.do?fid=01t7zGM4)![sample0_1_2.png](https://sy.hhwdd.com/RequireFile.do?fid=EHOyk2Uz)\n\n![sample0_2_1.png](https://sy.hhwdd.com/RequireFile.do?fid=FP2WnHn3)![sample0_2_2.png](https://sy.hhwdd.com/RequireFile.do?fid=c4cKvUgH)\n\n![sample0_3_1.png](https://sy.hhwdd.com/RequireFile.do?fid=U4UoWyyU)![sample0_3_2.png](https://sy.hhwdd.com/RequireFile.do?fid=59JlIWvn)\n\n![sample0_4_1.png](https://sy.hhwdd.com/RequireFile.do?fid=cm5NQIRx)![sample0_4_2.png](https://sy.hhwdd.com/RequireFile.do?fid=jM6lGPo8)\n\n![sample0_5_1.png](https://sy.hhwdd.com/RequireFile.do?fid=7jKRZ9i9)![sample0_5_2.png](https://sy.hhwdd.com/RequireFile.do?fid=Fb1HkD1s)\n\n![sample0_6_1.png](https://sy.hhwdd.com/RequireFile.do?fid=CbEmirO0)![sample0_6_2.png](https://sy.hhwdd.com/RequireFile.do?fid=4GrzzBbe)\n\n![sample0_7_1.png](https://sy.hhwdd.com/RequireFile.do?fid=hRWoM1xi)![sample0_7_2.png](https://sy.hhwdd.com/RequireFile.do?fid=8OgPPrFB)\n\n![sample0_8_1.png](https://sy.hhwdd.com/RequireFile.do?fid=ws6t9q9g)![sample0_8_2.png](https://sy.hhwdd.com/RequireFile.do?fid=RkDgZv7G)\n\n![sample0_9_1.png](https://sy.hhwdd.com/RequireFile.do?fid=MlI0m1pW)![sample0_9_2.png](https://sy.hhwdd.com/RequireFile.do?fid=KJLtHLs7)\n\n#### 更多样例\n\n**因为本题数据规模太大，直接提交评测会对评测机带来很大压力，本题将提供很多大样例；请尽量减少本题的提交次数。**\n\n更多样例请参见下发文件 `axiumcrisis*.in/ans`，共 $20$ 组，基本按照部分分的方法造。\n\n注意下发的答案文件中**没有给出构造方案**，仅会给出每组数据的答案。\n\n下发了一个 `checker.cpp`，你可以自行编译并在终端运行校验合法性。具体使用方法请参考「数据范围与提示」一节的描述。正式测评时使用的 Special Judge 与其并不相同。\n\n为了方便你更好地理解题意，此处额外附一个手搓的样例，这份样例未被放入下发文件。\n\n**建议使用该组样例及样例解释校验你对题意的理解，以免误读**。\n\n#### 数据范围与提示\n\n与[互测实际使用的版本](https://qoj.ac/problem/7769)不同，本题此处将采用数据范围更大的版本。\n\n对于所有的数据，保证 $2\\le n\\le18$，$1\\le T\\le3000$。\n\n具体的数据规模分布可以见下表，**各子任务等分，即满分均为 $\\rm5pts$**。其中形如 $(l,r)$ 的一列对应的数据表示 $l\\le n\\le r$ 的数据组数，「无限制」表示无额外限制。\n\n各子任务**捆绑评测**，其分数为该子任务各测试点分数最小值。子任务依赖意味着只有所依赖的子任务分数均非 $0$ 才会评测当前子任务，且分数与所依赖的子任务也取最小值。$o$ 的含义将在之后注明。\n\n|子任务|$(2,4)$|$(5,6)$|$(7,8)$|$(9,11)$|$(12,14)$|$(15,17)$|$(18,18)$|$o$|子任务依赖|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$1$|$\\le1000$|$=0$|$=0$|$=0$|$=0$|$=0$|$=0$|$=0$|无|\n|$2$|无限制|$\\le15$|$=0$|$=0$|$=0$|$=0$|$=0$|$=0$|$1$|\n|$3$|无限制|$\\le500$|$\\le10$|$=0$|$=0$|$=0$|$=0$|$=0$|$2$|\n|$4$|无限制|$\\le1000$|$\\le50$|$\\le10$|$=0$|$=0$|$=0$|$=2$|无|\n|$5$|无限制|$\\le1000$|$\\le50$|$\\le10$|$=0$|$=0$|$=0$|$=3$|无|\n|$6$|无限制|$\\le1000$|$\\le50$|$\\le10$|$=0$|$=0$|$=0$|$=4$|$4$|\n|$7$|无限制|$\\le1000$|$\\le50$|$\\le10$|$=0$|$=0$|$=0$|$=0$|$3,5,6$|\n|$8$|无限制|无限制|$\\le1000$|$\\le60$|$\\le10$|$=0$|$=0$|$=2$|$4$|\n|$9$|无限制|无限制|$\\le1000$|$\\le60$|$\\le10$|$=0$|$=0$|$=3$|$5$|\n|$10$|无限制|无限制|$\\le1000$|$\\le60$|$\\le10$|$=0$|$=0$|$=4$|$6,8$|\n|$11$|无限制|无限制|$\\le1000$|$\\le60$|$\\le10$|$=0$|$=0$|$=0$|$7,9,10$|\n|$12$|无限制|无限制|无限制|$\\le300$|$\\le30$|$\\le10$|$=0$|$=2$|$8$|\n|$13$|无限制|无限制|无限制|$\\le300$|$\\le30$|$\\le10$|$=0$|$=3$|$9$|\n|$14$|无限制|无限制|无限制|$\\le300$|$\\le30$|$\\le10$|$=0$|$=4$|$10,12$|\n|$15$|无限制|无限制|无限制|$\\le300$|$\\le30$|$\\le10$|$=0$|$=0$|$11,13,14$|\n|$16$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=1$|无|\n|$17$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=2$|$12$|\n|$18$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=3$|$13,16$|\n|$19$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=4$|$14,16,17$|\n|$20$|无限制|无限制|无限制|$\\le500$|$\\le60$|$\\le20$|$\\le10$|$=0$|$15,18,19$|\n\n接下来阐述关于 $o$ 的特殊性质。\n* $o=0$ 时，不保证特殊性质。\n* $o=1$ 时，保证输入中 $w=0$。\n* $o=2$ 时，保证输入中 $w=2$。\n* $o=3$ 时，保证输入中 $w=0$ 或 $w=1$。\n* $o=4$ 时，保证输入中 $w=0$ 或 $w=2$。\n\n接下来阐述是否输出方案对答案带来的影响。\n* 如果选择了 $c=0$，则答案正确时，你将获得该测试点 $80\\%$ 的分数，否则该测试点不得分。\n* 如果选择了 $c=1$，则答案和构造方案**均正确**时，你将获得该测试点的全部分数，**否则该测试点不得分**。\n\n因此如果你的输出方案可能写错，请慎重考虑是否改为不输出方案。\n\n接下来介绍 `checker.cpp` 使用方法。\n\n`checker.cpp` 使用类似于 Testlib 的命令行格式，但是并不基于 Testlib，因此**不需要 `testlib.h` 文件**；同时**兼容 Lemon 格式**。具体的，你可以这么使用：\n\n打开终端，进入 `checker.cpp` 所在文件夹后，首先使用 `g++ checker.cpp -o checker` 命令生成可执行文件（需要本地默认采用 C++11 及以上标准）。\n\n假设输入文件为 `data.in`，输出文件为 `data.out`，标准答案文件为 `data.ans`，则你需要将可执行文件 `checker` 和 `data.in/out/ans` 文件放置于同一文件夹下，然后在终端中输入如下命令执行：\n* 如果你使用 Windows 操作系统，请在 cmd 中使用 `checker data.in data.out data.ans 5` 执行。\n* 如果你使用 Linux 操作系统，请在 bash 中使用 `./checker data.in data.out data.ans 5` 执行。\n\n如命令中去掉最后的这个 `5` 将认为 $c=0$ 时也为 AC。\n\n稍等片刻即会返回提示信息。\n\n如果你使用 Lemon 来进行本地评测，可以把 `checker.cpp` 的可执行文件直接作为 Lemon 中的「自定义校验器」使用。\n\n#### 后记\n\n透过指缝观看着那世界末日之景。对立咽了口口水，靠着那股不知名的勇气，将手从自己的脸上移开。\n\n对立伸出了手，把那世界尽头收入了自己所搜集的无数回忆之中。\n\n其余的悲惨记忆，在这枚残片的映衬下显得不足一提。\n\n对立确信自己已经变得足够强大，理所当然地想立刻把一切都摧毁。\n\n就这样，伴随着那抹真诚的微笑与疲惫的笑声，对立从天空中降落到了地面上。\n\n那座古老的塔楼在这般力量驱使下逐渐陨落。\n\n而对立则怀抱着英雄般的信念，坚定不移地迈步向前。\n\n", "locale": "zh-CN"}}}
{"pid": "P10024", "type": "P", "difficulty": 2, "samples": [["2 5", "2"], ["114514 114514", "1"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "「HCOI-R1」报名人数", "background": "在一个电子展牌上，对于十进制数 $P$，从右到左，从 $P$ 的低位到高位，我们对每一位按照如下的方式进行显示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/taibn0fi.png)\n\n所以，对于数位分别取 $0\\sim 9$，该数位对应所用的短竖线数量分别是 $6, 2, 5, 5, 4, 5, 6, 3, 7, 6$。", "description": "小 R 的家中有一个大型的电子展牌，上面记录着 HCOI-R1 的报名人数。\n\n在小 R 布置完成的时候，HCOI-R1 的报名人数为 $l$。而现在，HCOI-R1 最终的报名人数为 $r$。\n\n小 R 觉得这样的整数数对 $(i, j)$ 是**幸运**的，当且仅当在报名过程中，存在人数为 $i, i + 1, \\dots, j$ 的时刻（也即 $l \\leq i \\leq j \\leq r$），且在 **不含前导 $\\bm 0$** 的情况下，表示 $i, i + 1 \\dots j$ 这些数字所用的短竖线数量相同。\n\n小 R 想知道，对于所有的幸运数对 $(i, j)$，其中 $j - i + 1$，也即数字个数——最大为多少。", "inputFormat": "仅一行，两个整数 $l, r$，表示初始报名人数和最终报名人数。", "outputFormat": "一行一个整数，表示所有数对 $(i, j)$ 中，$j - i + 1$ 的最大值。", "hint": "### 样例解释 1\n\n存在幸运数对 $(2, 3)$，表示它们均需要 $5$ 条短竖线。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n+ Subtask 0（19 pts）：$r \\leq 10^3$。\n+ Subtask 1（33 pts）：$r \\leq 10^6$。\n+ Subtask 2（48 pts）：无特殊限制。\n\n对于所有数据，保证 $1 \\leq l \\leq r \\leq 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「HCOI-R1」报名人数", "background": "在一个电子展牌上，对于十进制数 $P$，从右到左，从 $P$ 的低位到高位，我们对每一位按照如下的方式进行显示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/taibn0fi.png)\n\n所以，对于数位分别取 $0\\sim 9$，该数位对应所用的短竖线数量分别是 $6, 2, 5, 5, 4, 5, 6, 3, 7, 6$。", "description": "小 R 的家中有一个大型的电子展牌，上面记录着 HCOI-R1 的报名人数。\n\n在小 R 布置完成的时候，HCOI-R1 的报名人数为 $l$。而现在，HCOI-R1 最终的报名人数为 $r$。\n\n小 R 觉得这样的整数数对 $(i, j)$ 是**幸运**的，当且仅当在报名过程中，存在人数为 $i, i + 1, \\dots, j$ 的时刻（也即 $l \\leq i \\leq j \\leq r$），且在 **不含前导 $\\bm 0$** 的情况下，表示 $i, i + 1 \\dots j$ 这些数字所用的短竖线数量相同。\n\n小 R 想知道，对于所有的幸运数对 $(i, j)$，其中 $j - i + 1$，也即数字个数——最大为多少。", "inputFormat": "仅一行，两个整数 $l, r$，表示初始报名人数和最终报名人数。", "outputFormat": "一行一个整数，表示所有数对 $(i, j)$ 中，$j - i + 1$ 的最大值。", "hint": "### 样例解释 1\n\n存在幸运数对 $(2, 3)$，表示它们均需要 $5$ 条短竖线。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n+ Subtask 0（19 pts）：$r \\leq 10^3$。\n+ Subtask 1（33 pts）：$r \\leq 10^6$。\n+ Subtask 2（48 pts）：无特殊限制。\n\n对于所有数据，保证 $1 \\leq l \\leq r \\leq 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P10025", "type": "P", "difficulty": 4, "samples": [["2 5 3\n1 1\n1 3\n1 4", "10"], ["7 4 9\n1 4\n2 3\n4 1\n6 2\n7 1\n5 2\n3 4\n1 1\n7 4", "38"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "「HCOI-R1」孤独的 sxz", "background": "sxz 不擅长与人交往，于是他平常都喜欢找偏僻的地方坐着。今天，sxz 来到了食堂，他依旧想找一个偏僻的地方坐着，让他与其他所有人的曼哈顿距离之和最大。", "description": "食堂的座位可以看成一个被划分为 $n\\times m$ 的格子的矩形，长为 $n$，宽为 $m$，矩形内的每一个格子 $(i, j)(i \\in [1, n], j \\in [1, m])$ $(i,j$ 为整数$)$ 都是一个座位。\n\n现在，食堂里已经有了 $k$ 个人，其中第 $i(1 \\leq i \\leq k)$ 个人坐在 $(x_i, y_i)$ 处。sxz 想要找到一个座位，使得该座位与 $k$ 个人的曼哈顿距离之和最大。请你帮他找到这个最大值，剩下的就交给 sxz 吧！\n\n假设 sxz 坐在点 $(a,b)$，那么他和 $k$ 个人的曼哈顿距离之和是 $\\sum_{i=1}^{k}|a-x_i|+|b-y_i|$。\n\n**很显然，sxz 不能和 $\\bm k$ 个人中的任何一个人坐在同一个地方**。", "inputFormat": "第一行包含三个整数 $n, m, k$。\n\n接下来 $k$ 行，第 $i$ 行两个整数描述 $x_i, y_i$。", "outputFormat": "\n仅一行一个整数，描述这个值。注意它可能很大。", "hint": "### 样例解释 1\n\n最佳位置为 $(2,5)$，对于 $3$ 个人的曼哈顿距离分别为 $5, 3, 2$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n+ Subtask 0（15 pts）：$n, m \\leq 100$。\n+ Subtask 1（25 pts）：$n, m \\leq 10000$。\n+ Subtask 2（20 pts）：$k = 3$。\n+ Subtask 3（40 pts）：无特殊限制。\n\n对于所有数据，$1 \\leq n, m \\leq 10^9$，$1\\leq k \\leq \\min\\{4 \\times 10^5, n\\times m-1\\}$，$1 \\leq x_i \\leq n$，$1 \\leq y_i \\leq m$，保证所有 $(x_i, y_i)$ 互不相同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「HCOI-R1」孤独的 sxz", "background": "sxz 不擅长与人交往，于是他平常都喜欢找偏僻的地方坐着。今天，sxz 来到了食堂，他依旧想找一个偏僻的地方坐着，让他与其他所有人的曼哈顿距离之和最大。", "description": "食堂的座位可以看成一个被划分为 $n\\times m$ 的格子的矩形，长为 $n$，宽为 $m$，矩形内的每一个格子 $(i, j)(i \\in [1, n], j \\in [1, m])$ $(i,j$ 为整数$)$ 都是一个座位。\n\n现在，食堂里已经有了 $k$ 个人，其中第 $i(1 \\leq i \\leq k)$ 个人坐在 $(x_i, y_i)$ 处。sxz 想要找到一个座位，使得该座位与 $k$ 个人的曼哈顿距离之和最大。请你帮他找到这个最大值，剩下的就交给 sxz 吧！\n\n假设 sxz 坐在点 $(a,b)$，那么他和 $k$ 个人的曼哈顿距离之和是 $\\sum_{i=1}^{k}|a-x_i|+|b-y_i|$。\n\n**很显然，sxz 不能和 $\\bm k$ 个人中的任何一个人坐在同一个地方**。", "inputFormat": "第一行包含三个整数 $n, m, k$。\n\n接下来 $k$ 行，第 $i$ 行两个整数描述 $x_i, y_i$。", "outputFormat": "\n仅一行一个整数，描述这个值。注意它可能很大。", "hint": "### 样例解释 1\n\n最佳位置为 $(2,5)$，对于 $3$ 个人的曼哈顿距离分别为 $5, 3, 2$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n+ Subtask 0（15 pts）：$n, m \\leq 100$。\n+ Subtask 1（25 pts）：$n, m \\leq 10000$。\n+ Subtask 2（20 pts）：$k = 3$。\n+ Subtask 3（40 pts）：无特殊限制。\n\n对于所有数据，$1 \\leq n, m \\leq 10^9$，$1\\leq k \\leq \\min\\{4 \\times 10^5, n\\times m-1\\}$，$1 \\leq x_i \\leq n$，$1 \\leq y_i \\leq m$，保证所有 $(x_i, y_i)$ 互不相同。", "locale": "zh-CN"}}}
