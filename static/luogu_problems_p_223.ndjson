{"pid": "P5509", "type": "P", "difficulty": 5, "samples": [["5\n2 2\n3 3\n1 4\n2 4\n3 4\n", "3\n7\n1\n381716\n127244\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "逆元"], "title": "派遣", "background": "Steve在洞穴里发现了一张地图，上面标识出了黑暗势力的据点，他决定派遣一些士兵前去", "description": "然而，这些士兵不一定具有与黑暗势力作战的能力，因而最终被派遣的士兵是未知的\n\n为了尽量了解派遣的士兵的情况，Steve需要你帮忙计算一些值\n\nSteve一共有$t$支军队，每支军队的人数都不同\n\n每支军队可以按一定标准排成$n \\times k$的方阵，每个士兵的位置可以用坐标$(x,y)$表示，其中$0\\le x < n,0 \\le y <k$，这个士兵的编号就是$x\\cdot k+y$\n\n位于$(0,0)$位置的士兵是队长，无论任何情况都会被派遣\n\n对于其余的士兵，可以派遣，也可以不派遣\n\n一支$n \\times k$的军队的能力值是这样定义的：\n\n如果所有士兵都被派遣，那么能力值是$1$\n\n如果位于$(x,y)$位置的士兵(编号为$i$)未被派遣，那么能力值变为原来的$\\frac{x}{i-x}$\n\n例如，对于一支$2\\times 2$的军队，如果$(1,1)$位置的士兵(编号为$3$)未被派遣，其他士兵都被派遣，那么能力值为$\\frac{1}{3-1}=\\frac{1}{2}$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(0,1)$位置的士兵(编号为$1$)都未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(1,0)$位置的士兵(编号为$2$)都未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{1}{2-1} = \\frac{1}{2}$\n\n现在，Steve需要你为每一支军队，计算出所有可能派遣方案的能力值之和\n\n为了避免出现分数，输出结果是模$1145141$意义下的值\n\n如果这个值不存在，那么输出$-1$\n\n也就是，如果你的答案为既约分数$\\frac{p}{q}$，你需要找到一个最小的非负整数$a$，满足$p\\equiv q\\cdot a(mod 1145141)$，并输出这个值，如果不存在这样的整数，就输出$-1$\n\n提示：$1145141$是质数", "inputFormat": "第一行一个整数$t$\n\n接下来$t$行，每行两个整数$n,k$", "outputFormat": "$t$行，每行一个整数表示答案", "hint": "第四组数据实际值为$\\frac{7}{3}$\n\n第五组数据实际值为$\\frac{55}{9}$\n\n第一组数据解释：\n\n如果所有士兵都被派遣，那么能力值为$1$\n\n如果$(1,1)$位置的士兵(编号为$3$)未被派遣，那么能力值为$\\frac{1}{3-1}=0.5$\n\n如果$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{0}{1-0} = 0$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$\n\n如果$(1,0)$位置的士兵(编号为$2$)未被派遣，那么能力值为$\\frac{1}{2-1} = 1$\n\n如果$(1,0)$位置的士兵(编号为$2$)和$(1,1)$位置的士兵(编号为$3$)未被派遣，那么能力值为$\\frac{1}{2-1} \\times \\frac{1}{3-1}=0.5$\n\n如果$(1,0)$位置的士兵(编号为$2$)和$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{1}{2-1} \\times \\frac{0}{1-0}=0$\n\n如果只有队长被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} \\times \\frac{1}{2-1}=0$\n\n所以，答案为$1+0.5+0+0+1+0.5+0+0=3$\n\n数据范围：\n\n对于所有数据，$n\\ge 1,k\\ge 2$\n\nSubtask1是比赛时的测试数据：\n\n测试点| 分值| t | $n\\le$| $k\\le$\n:-: | :-: | :-: | :-: | :-:\n1| 10| 5| 5| 5| \n2| 11| 100| 100| 100|\n3| 12| 100000| 5| 100000|\n4| 13| 100000| 100000| 5|\n5| 16| 5| 100000| 100000|\n6| 18| 5| $10^9$| $10^9$|\n7| 20| 100000| $10^9$|$10^9$|\n\nSubtask2包括两个不计分的Hack数据，均满足$t=1$\n\n#8满足#7的性质\n\n#9满足#5的性质", "locale": "zh-CN", "translations": {"en": {"title": "Dispatch", "background": "Steve found a map in a cave. The map marked the strongholds of the dark forces, so he decided to dispatch some soldiers there.", "description": "However, these soldiers may not necessarily have the ability to fight the dark forces, so the final set of dispatched soldiers is unknown.\n\nTo better understand the dispatched soldiers, Steve needs you to help compute some values.\n\nSteve has a total of $t$ armies, and each army has a different number of soldiers.\n\nEach army can be arranged into an $n \\times k$ grid under a certain standard. Each soldier’s position can be represented by coordinates $(x,y)$, where $0 \\le x < n$ and $0 \\le y < k$. The soldier’s index is $x \\cdot k + y$.\n\nThe soldier at position $(0,0)$ is the captain, and will be dispatched no matter what.\n\nFor the remaining soldiers, they may or may not be dispatched.\n\nThe ability value of an $n \\times k$ army is defined as follows:\n\n- If all soldiers are dispatched, then the ability value is $1$.\n- If the soldier at position $(x,y)$ (with index $i$) is not dispatched, then the ability value becomes the previous value multiplied by $\\frac{x}{i-x}$.\n\nFor example, for a $2 \\times 2$ army, if the soldier at $(1,1)$ (index $3$) is not dispatched and all other soldiers are dispatched, then the ability value is $\\frac{1}{3-1}=\\frac{1}{2}$.\n\nIf both the soldier at $(1,1)$ (index $3$) and the soldier at $(0,1)$ (index $1$) are not dispatched, then the ability value is $\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$.\n\nIf both the soldier at $(1,1)$ (index $3$) and the soldier at $(1,0)$ (index $2$) are not dispatched, then the ability value is $\\frac{1}{3-1} \\times \\frac{1}{2-1} = \\frac{1}{2}$.\n\nNow, for each army, Steve needs you to compute the sum of the ability values over all possible dispatch plans.\n\nTo avoid fractions, output the result modulo $1145141$.\n\nIf this value does not exist, output $-1$.\n\nThat is, if your answer is an irreducible fraction $\\frac{p}{q}$, you need to find the smallest non-negative integer $a$ such that $p \\equiv q \\cdot a \\pmod{1145141}$, and output $a$. If no such integer exists, output $-1$.\n\nHint: $1145141$ is a prime number.", "inputFormat": "The first line contains an integer $t$.\n\nThe next $t$ lines each contain two integers $n, k$.", "outputFormat": "Output $t$ lines, each containing one integer representing the answer.", "hint": "The actual value for the 4th group of testdata is $\\frac{7}{3}$.\n\nThe actual value for the 5th group of testdata is $\\frac{55}{9}$.\n\nExplanation for the 1st group of testdata:\n\nIf all soldiers are dispatched, then the ability value is $1$.\n\nIf the soldier at $(1,1)$ (index $3$) is not dispatched, then the ability value is $\\frac{1}{3-1}=0.5$.\n\nIf the soldier at $(0,1)$ (index $1$) is not dispatched, then the ability value is $\\frac{0}{1-0} = 0$.\n\nIf both the soldier at $(1,1)$ (index $3$) and the soldier at $(0,1)$ (index $1$) are not dispatched, then the ability value is $\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$.\n\nIf the soldier at $(1,0)$ (index $2$) is not dispatched, then the ability value is $\\frac{1}{2-1} = 1$.\n\nIf both the soldier at $(1,0)$ (index $2$) and the soldier at $(1,1)$ (index $3$) are not dispatched, then the ability value is $\\frac{1}{2-1} \\times \\frac{1}{3-1}=0.5$.\n\nIf both the soldier at $(1,0)$ (index $2$) and the soldier at $(0,1)$ (index $1$) are not dispatched, then the ability value is $\\frac{1}{2-1} \\times \\frac{0}{1-0}=0$.\n\nIf only the captain is dispatched, then the ability value is $\\frac{1}{3-1} \\times \\frac{0}{1-0} \\times \\frac{1}{2-1}=0$.\n\nSo, the answer is $1+0.5+0+0+1+0.5+0+0=3$.\n\nConstraints:\n\nFor all testdata, $n \\ge 1, k \\ge 2$.\n\nSubtask 1 is the testdata used during the contest:\n\nTest point | Score | $t$ | $n \\le$ | $k \\le$\n:-: | :-: | :-: | :-: | :-:\n1 | 10 | 5 | 5 | 5\n2 | 11 | 100 | 100 | 100\n3 | 12 | 100000 | 5 | 100000\n4 | 13 | 100000 | 100000 | 5\n5 | 16 | 5 | 100000 | 100000\n6 | 18 | 5 | $10^9$ | $10^9$\n7 | 20 | 100000 | $10^9$ | $10^9$\n\nSubtask 2 includes two unscored hack testdata, both satisfying $t=1$.\n\n#8 satisfies the properties of #7.\n\n#9 satisfies the properties of #5.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "派遣", "background": "Steve在洞穴里发现了一张地图，上面标识出了黑暗势力的据点，他决定派遣一些士兵前去", "description": "然而，这些士兵不一定具有与黑暗势力作战的能力，因而最终被派遣的士兵是未知的\n\n为了尽量了解派遣的士兵的情况，Steve需要你帮忙计算一些值\n\nSteve一共有$t$支军队，每支军队的人数都不同\n\n每支军队可以按一定标准排成$n \\times k$的方阵，每个士兵的位置可以用坐标$(x,y)$表示，其中$0\\le x < n,0 \\le y <k$，这个士兵的编号就是$x\\cdot k+y$\n\n位于$(0,0)$位置的士兵是队长，无论任何情况都会被派遣\n\n对于其余的士兵，可以派遣，也可以不派遣\n\n一支$n \\times k$的军队的能力值是这样定义的：\n\n如果所有士兵都被派遣，那么能力值是$1$\n\n如果位于$(x,y)$位置的士兵(编号为$i$)未被派遣，那么能力值变为原来的$\\frac{x}{i-x}$\n\n例如，对于一支$2\\times 2$的军队，如果$(1,1)$位置的士兵(编号为$3$)未被派遣，其他士兵都被派遣，那么能力值为$\\frac{1}{3-1}=\\frac{1}{2}$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(0,1)$位置的士兵(编号为$1$)都未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(1,0)$位置的士兵(编号为$2$)都未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{1}{2-1} = \\frac{1}{2}$\n\n现在，Steve需要你为每一支军队，计算出所有可能派遣方案的能力值之和\n\n为了避免出现分数，输出结果是模$1145141$意义下的值\n\n如果这个值不存在，那么输出$-1$\n\n也就是，如果你的答案为既约分数$\\frac{p}{q}$，你需要找到一个最小的非负整数$a$，满足$p\\equiv q\\cdot a(mod 1145141)$，并输出这个值，如果不存在这样的整数，就输出$-1$\n\n提示：$1145141$是质数", "inputFormat": "第一行一个整数$t$\n\n接下来$t$行，每行两个整数$n,k$", "outputFormat": "$t$行，每行一个整数表示答案", "hint": "第四组数据实际值为$\\frac{7}{3}$\n\n第五组数据实际值为$\\frac{55}{9}$\n\n第一组数据解释：\n\n如果所有士兵都被派遣，那么能力值为$1$\n\n如果$(1,1)$位置的士兵(编号为$3$)未被派遣，那么能力值为$\\frac{1}{3-1}=0.5$\n\n如果$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{0}{1-0} = 0$\n\n如果$(1,1)$位置的士兵(编号为$3$)和$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} = 0$\n\n如果$(1,0)$位置的士兵(编号为$2$)未被派遣，那么能力值为$\\frac{1}{2-1} = 1$\n\n如果$(1,0)$位置的士兵(编号为$2$)和$(1,1)$位置的士兵(编号为$3$)未被派遣，那么能力值为$\\frac{1}{2-1} \\times \\frac{1}{3-1}=0.5$\n\n如果$(1,0)$位置的士兵(编号为$2$)和$(0,1)$位置的士兵(编号为$1$)未被派遣，那么能力值为$\\frac{1}{2-1} \\times \\frac{0}{1-0}=0$\n\n如果只有队长被派遣，那么能力值为$\\frac{1}{3-1} \\times \\frac{0}{1-0} \\times \\frac{1}{2-1}=0$\n\n所以，答案为$1+0.5+0+0+1+0.5+0+0=3$\n\n数据范围：\n\n对于所有数据，$n\\ge 1,k\\ge 2$\n\nSubtask1是比赛时的测试数据：\n\n测试点| 分值| t | $n\\le$| $k\\le$\n:-: | :-: | :-: | :-: | :-:\n1| 10| 5| 5| 5| \n2| 11| 100| 100| 100|\n3| 12| 100000| 5| 100000|\n4| 13| 100000| 100000| 5|\n5| 16| 5| 100000| 100000|\n6| 18| 5| $10^9$| $10^9$|\n7| 20| 100000| $10^9$|$10^9$|\n\nSubtask2包括两个不计分的Hack数据，均满足$t=1$\n\n#8满足#7的性质\n\n#9满足#5的性质", "locale": "zh-CN"}}}
{"pid": "P5510", "type": "P", "difficulty": 6, "samples": [["2 0\n1 1\n3 3\n2 2\n4 4\n9\n1 1 1 1\n1 1 1 2\n1 1 2 2\n2 1 1 1\n1 2 1 2\n1 2 2 2\n2 2 1 1\n2 2 1 2\n2 2 2 2\n", "18\n2\n6\n4\n2\n18\n16\n0\n12\n12\n"], ["2 0\n1 1\n2 2\n2 2\n3 3\n9\n1 1 1 1\n1 1 1 2\n1 1 2 2\n1 2 1 1\n1 2 1 2\n1 2 2 2\n2 2 1 1\n2 2 1 2\n2 2 2 2\n", "11\n2\n5\n3\n2\n11\n9\n0\n6\n6\n"], ["5 0\n1 1\n1 1\n1 1\n2 1\n2 1\n1 1\n1 1\n2 1\n2 1\n3 1\n7\n2 4 1 1\n1 3 3 4\n3 4 5 5\n2 5 4 4\n1 5 5 5\n1 3 1 2\n1 2 3 4\n", "11\n0\n6\n5\n6\n5\n0\n6\n"], ["3 0\n3 1\n2 2\n1 3\n4 4\n5 5\n6 6\n12\n1 3 2 2\n1 2 2 3\n3 1 1 2\n2 1 3 1\n1 1 2 3\n3 1 3 1\n3 2 2 3\n1 2 3 3\n1 2 1 3\n3 2 1 1\n2 2 1 3\n3 3 1 2\n", "90\n30\n33\n54\n45\n11\n90\n55\n18\n45\n20\n30\n27\n"], ["3 2 233 5 10\n", "15618218285282996994"], ["3 0\n3 754517792\n1 842082509\n4 600944080\n2 592435186\n5 348652025\n5 247250863\n10\n1 3 3 2\n3 2 1 1\n2 2 3 2\n2 1 2 1\n3 3 3 1\n2 3 3 2\n1 3 3 3\n1 3 3 3\n2 2 1 3\n2 1 2 1\n", "988687952\n712318441\n204869162\n71500349\n703342331\n285345621\n783818790\n712318441\n712318441\n276369511\n703342331\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "排序", "前缀和"], "title": "水晶", "background": "2019/12/27 修改最后一个点的数据范围\n\nSteve带领军队到达了黑暗势力的据点\n\n然而，他发现黑暗势力正在使用水晶保护自己\n\n为了突破防御，Steve开始用武器攻击水晶", "description": "黑暗势力的水晶已经排成了一排，而且数量很多\n\n水晶可分为$n$组，第$i$组内有$a_i$个水晶，并且防御力均为$na_i$\n\nSteve的武器也已经排成了一排，而且数量也很多\n\n武器也可分为$n$组，第$i$组内有$b_i$个武器，并且攻击力均为$nb_i$\n\n每一轮攻击中，黑暗势力会选择一个水晶，Steve会选择一个武器\n\n如果这个武器的攻击力大于水晶的防御力，这次攻击就有效\n\n然而，水晶和武器数量太多了，Steve很难知道具体选择了哪个水晶，哪个武器\n\n现在Steve希望知道：\n\n1.对于所有可能的情况，有多少种选法是一次有效的攻击\n\n2.如果已经知道选用水晶的防御力在第$x$组水晶的防御力和第$y$组水晶的防御力之间，且选用武器的攻击力在第$z$组武器的攻击力和第$u$组武器的攻击力之间，那么，有多少种选法是一次有效的攻击\n\n也就是，选择的水晶防御力不小于第$x$组水晶和第$y$组水晶防御力的较小值，不大于两者的较大值，武器同理\n\n两个选法不同，当且仅当选用的水晶或武器不同（可以在同一组）\n\n由于战事紧迫，你需要迅速回答问题才能让Steve作出下一轮攻击的决策\n\n因此，部分测试点强制在线\n\n为了避免答案过大，答案对$998244353$取模", "inputFormat": "由于输入输出规模较大，使用下面的模板完成数据生成，具体格式请看模板和样例\n\n评测时，所有测试点都只会输入5个数，输出1个数，因此你不需要输入输出优化\n\n为便于调试，该模板可以手动指定数据，并输出每一个询问的答案，只需要输入的$k=0$\n\n对于所有测试点，保证调用交互库消耗的时间不超过300ms\n```\n#include<cstdio>\nusing namespace std;\n#define u32 unsigned int\n#define u64 unsigned long long\nint cl;\nconst int N=2500007;\nconst long long M=998244353LL;\nint n,q,k;\nint a[N],na[N],b[N],nb[N];\nint x,y,z,u;\nnamespace lib{\n    u64 read(){\n        u64 n=0;\n        char c=getchar();\n        while(c<'0'||c>'9')c=getchar();\n        while(c>='0'&&c<='9'){\n            n=n*10+c-'0';\n            c=getchar();\n        }\n        return n;\n    }\n    char r[30];\n    void write(u64 num){\n        if(num==0){\n            putchar('0');\n            return;\n        }\n        int t=0;\n        while(num){\n            r[t++]=num%10+'0';\n            num/=10;\n        }\n        while(t)putchar(r[--t]);\n    }\n    u64 s;\n    u64 rand(u64 l,u64 r){\n        s=s*19260817+1;\n        return ((s>>8)%(r-l+1)+l);\n    }\n    int ra,t;\n    void init(){\n        n=read();k=read();\n        if(k<2){\n            for(int i=1;i<=n;i++){\n                a[i]=read();na[i]=read();\n            }\n            for(int i=1;i<=n;i++){\n                b[i]=read();nb[i]=read();\n            }\n        }else{\n            s=read();ra=read();\n            u64 bacs=s;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\ta[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//na[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\t//a[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tna[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            bacs=s;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\tb[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//nb[i]=((s>>8)%(M-1)+1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\t//b[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tnb[i]=((s>>8)%(M-1)+1);\n            }\n        }\n        q=read();\n    }\n    u64 lastans;\n    u64 res;\n    void reply(u64 num){\n        if(k<2){\n            write(num);putchar('\\n');\n        }else{\n            res=res*233+num;\n        }\n        lastans^=num;\n    }\n    void query(){\n        if(k<2){\n            x=read();y=read();z=read();u=read();\n        }else{\n        \ts=s*19260817+1;\n        \tx=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \ty=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tz=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tu=((s>>8)%n+1);\n            //x=rand(1,n);y=rand(1,n);z=rand(1,n);u=rand(1,n);\n        }\n        if(k&1){\n        \tint t=lastans%n+1;\n        \tif((x+=t)>n)x-=n;\n        \tif((y+=t)>n)y-=n;\n        \tif((z+=t)>n)z-=n;\n        \tif((u+=t)>n)u-=n;\n            /*x=(x+lastans)%n+1;\n            y=(y+lastans)%n+1;\n            z=(z+lastans)%n+1;\n            u=(u+lastans)%n+1;*/\n        }\n    }\n    void stop(){\n        if(k>=2){write(res);putchar('\\n');}\n    }\n}\nint main(){\n\tlib::init();\n\t//现在你可以使用生成的a,na,b,nb\n\t\n    //回答第一问\n    \n\tlib::reply(233);\n\t\n\tfor(int i=1;i<=q;i++){\n\t\tlib::query();\n\t\t\n\t\t//回答第二问 \n        \n\t\tlib::reply(233);\n\t}\n\tlib::stop();\n}\n```", "outputFormat": "如果$k=0$，则会分别输出每一问的答案\n\n否则，只会输出一个整数用于检查结果是否正确", "hint": "样例1解释：\n\n当选择第二组武器时，一定能进行一次有效攻击\n\n当选择第一组武器时，只有选择第一组水晶才能进行一次有效攻击\n\n因而，不难求出每一问的答案\n\n建议根据样例进一步理解题意\n\n样例5与样例6一致\n\n数据范围：\n\n对于所有数据，满足$1\\le x,y,z,u \\le n$，$1\\le a_i,b_i\\le 10^9$，$1\\le na_i,nb_i\\le 998244352$\n\n如未特别说明，$k=3$，即：由模板生成数据，强制在线\n\n如果$k=2$，那么这组数据仍由生成器生成，但不强制在线，也就是你可以在不回答询问的情况下得到下一个询问的真实值，随后按顺序回答即可\n\n测试点| 分值| n | q| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1| 4| 100| 100| $k=2$| \n2| 14| 3000| 3000| $k=2$|\n3| 11| 100000| 100000| $a_i,b_i\\le 100$|\n4| 10| 15| 4000000| |\n5| 12| 100| 4000000| |\n6| 14| 5000| 4000000| |\n7| 16| 100000| 100000| |\n8| 19| 2500000| 4000000| |", "locale": "zh-CN", "translations": {"en": {"title": "Crystal", "background": "2019/12/27: Modified the Constraints of the last test point.\n\nSteve led his army to the stronghold of the dark forces.\n\nHowever, he found that the dark forces were using crystals to protect themselves.\n\nTo break through the defense, Steve began attacking the crystals with weapons.", "description": "The dark forces’ crystals have been lined up in a row, and there are many of them.\n\nThe crystals can be divided into $n$ groups. The $i$-th group contains $a_i$ crystals, and their defense value is $na_i$.\n\nSteve’s weapons have also been lined up in a row, and there are many of them.\n\nThe weapons can also be divided into $n$ groups. The $i$-th group contains $b_i$ weapons, and their attack value is $nb_i$.\n\nIn each round of attack, the dark forces will choose one crystal, and Steve will choose one weapon.\n\nIf the weapon’s attack value is greater than the crystal’s defense value, then this attack is effective.\n\nHowever, there are too many crystals and weapons, so it is hard for Steve to know exactly which crystal and which weapon were chosen.\n\nNow Steve wants to know:\n\n1. For all possible situations, how many ways of choosing result in an effective attack.\n\n2. If it is already known that the chosen crystal’s defense value is between the defense values of the crystals in group $x$ and group $y$, and the chosen weapon’s attack value is between the attack values of the weapons in group $z$ and group $u$, then how many ways of choosing result in an effective attack.\n\nThat is, the chosen crystal’s defense value is not less than the smaller of the defense values of group $x$ and group $y$, and not greater than the larger of them; similarly for the weapon.\n\nTwo choices are different if and only if the chosen crystal or the chosen weapon is different (they may be in the same group).\n\nSince the battle is urgent, you need to answer the questions quickly so that Steve can decide the next round of attacks.\n\nTherefore, some test points require online answering.\n\nTo avoid the answer being too large, take the answer modulo $998244353$.", "inputFormat": "Because the input/output size is large, use the following template to generate the data. For the exact format, see the template and samples.\n\nDuring judging, all test points will only input 5 numbers and output 1 number, so you do not need to optimize input/output.\n\nFor easier debugging, this template can manually specify the data and output the answer to each query; in that case you only need to input $k=0$.\n\nFor all test points, it is guaranteed that the time consumed by calling the interaction library does not exceed 300 ms.\n```\n#include<cstdio>\nusing namespace std;\n#define u32 unsigned int\n#define u64 unsigned long long\nint cl;\nconst int N=2500007;\nconst long long M=998244353LL;\nint n,q,k;\nint a[N],na[N],b[N],nb[N];\nint x,y,z,u;\nnamespace lib{\n    u64 read(){\n        u64 n=0;\n        char c=getchar();\n        while(c<'0'||c>'9')c=getchar();\n        while(c>='0'&&c<='9'){\n            n=n*10+c-'0';\n            c=getchar();\n        }\n        return n;\n    }\n    char r[30];\n    void write(u64 num){\n        if(num==0){\n            putchar('0');\n            return;\n        }\n        int t=0;\n        while(num){\n            r[t++]=num%10+'0';\n            num/=10;\n        }\n        while(t)putchar(r[--t]);\n    }\n    u64 s;\n    u64 rand(u64 l,u64 r){\n        s=s*19260817+1;\n        return ((s>>8)%(r-l+1)+l);\n    }\n    int ra,t;\n    void init(){\n        n=read();k=read();\n        if(k<2){\n            for(int i=1;i<=n;i++){\n                a[i]=read();na[i]=read();\n            }\n            for(int i=1;i<=n;i++){\n                b[i]=read();nb[i]=read();\n            }\n        }else{\n            s=read();ra=read();\n            u64 bacs=s;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\ta[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//na[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\t//a[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tna[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            bacs=s;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\tb[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//nb[i]=((s>>8)%(M-1)+1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\t//b[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tnb[i]=((s>>8)%(M-1)+1);\n            }\n        }\n        q=read();\n    }\n    u64 lastans;\n    u64 res;\n    void reply(u64 num){\n        if(k<2){\n            write(num);putchar('\\n');\n        }else{\n            res=res*233+num;\n        }\n        lastans^=num;\n    }\n    void query(){\n        if(k<2){\n            x=read();y=read();z=read();u=read();\n        }else{\n        \ts=s*19260817+1;\n        \tx=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \ty=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tz=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tu=((s>>8)%n+1);\n            //x=rand(1,n);y=rand(1,n);z=rand(1,n);u=rand(1,n);\n        }\n        if(k&1){\n        \tint t=lastans%n+1;\n        \tif((x+=t)>n)x-=n;\n        \tif((y+=t)>n)y-=n;\n        \tif((z+=t)>n)z-=n;\n        \tif((u+=t)>n)u-=n;\n            /*x=(x+lastans)%n+1;\n            y=(y+lastans)%n+1;\n            z=(z+lastans)%n+1;\n            u=(u+lastans)%n+1;*/\n        }\n    }\n    void stop(){\n        if(k>=2){write(res);putchar('\\n');}\n    }\n}\nint main(){\n\tlib::init();\n\t//现在你可以使用生成的a,na,b,nb\n\t\n    //回答第一问\n    \n\tlib::reply(233);\n\t\n\tfor(int i=1;i<=q;i++){\n\t\tlib::query();\n\t\t\n\t\t//回答第二问 \n        \n\t\tlib::reply(233);\n\t}\n\tlib::stop();\n}\n```", "outputFormat": "If $k=0$, the answer to each question will be output separately.\n\nOtherwise, only one integer will be output to check whether the result is correct.", "hint": "Explanation for Sample 1:\n\nWhen choosing the weapons in the second group, you can always make an effective attack.\n\nWhen choosing the weapons in the first group, only choosing the crystals in the first group can make an effective attack.\n\nTherefore, it is not hard to find the answer to each question.\n\nIt is recommended to further understand the statement based on the samples.\n\nSample 5 is the same as Sample 6.\n\nConstraints:\n\nFor all data, $1 \\le x,y,z,u \\le n$, $1 \\le a_i,b_i \\le 10^9$, and $1 \\le na_i,nb_i \\le 998244352$.\n\nUnless otherwise specified, $k=3$, i.e., the data is generated by the template and online answering is required.\n\nIf $k=2$, the data is still generated by the generator, but online answering is not required. That is, you can get the real value of the next query without answering the current query, and then answer them in order afterward.\n\nTest Point | Score | $n$ | $q$ | Special Property\n:-: | :-: | :-: | :-: | :-:\n1 | 4 | 100 | 100 | $k=2$\n2 | 14 | 3000 | 3000 | $k=2$\n3 | 11 | 100000 | 100000 | $a_i,b_i \\le 100$\n4 | 10 | 15 | 4000000 |\n5 | 12 | 100 | 4000000 |\n6 | 14 | 5000 | 4000000 |\n7 | 16 | 100000 | 100000 |\n8 | 19 | 2500000 | 4000000 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "水晶", "background": "2019/12/27 修改最后一个点的数据范围\n\nSteve带领军队到达了黑暗势力的据点\n\n然而，他发现黑暗势力正在使用水晶保护自己\n\n为了突破防御，Steve开始用武器攻击水晶", "description": "黑暗势力的水晶已经排成了一排，而且数量很多\n\n水晶可分为$n$组，第$i$组内有$a_i$个水晶，并且防御力均为$na_i$\n\nSteve的武器也已经排成了一排，而且数量也很多\n\n武器也可分为$n$组，第$i$组内有$b_i$个武器，并且攻击力均为$nb_i$\n\n每一轮攻击中，黑暗势力会选择一个水晶，Steve会选择一个武器\n\n如果这个武器的攻击力大于水晶的防御力，这次攻击就有效\n\n然而，水晶和武器数量太多了，Steve很难知道具体选择了哪个水晶，哪个武器\n\n现在Steve希望知道：\n\n1.对于所有可能的情况，有多少种选法是一次有效的攻击\n\n2.如果已经知道选用水晶的防御力在第$x$组水晶的防御力和第$y$组水晶的防御力之间，且选用武器的攻击力在第$z$组武器的攻击力和第$u$组武器的攻击力之间，那么，有多少种选法是一次有效的攻击\n\n也就是，选择的水晶防御力不小于第$x$组水晶和第$y$组水晶防御力的较小值，不大于两者的较大值，武器同理\n\n两个选法不同，当且仅当选用的水晶或武器不同（可以在同一组）\n\n由于战事紧迫，你需要迅速回答问题才能让Steve作出下一轮攻击的决策\n\n因此，部分测试点强制在线\n\n为了避免答案过大，答案对$998244353$取模", "inputFormat": "由于输入输出规模较大，使用下面的模板完成数据生成，具体格式请看模板和样例\n\n评测时，所有测试点都只会输入5个数，输出1个数，因此你不需要输入输出优化\n\n为便于调试，该模板可以手动指定数据，并输出每一个询问的答案，只需要输入的$k=0$\n\n对于所有测试点，保证调用交互库消耗的时间不超过300ms\n```\n#include<cstdio>\nusing namespace std;\n#define u32 unsigned int\n#define u64 unsigned long long\nint cl;\nconst int N=2500007;\nconst long long M=998244353LL;\nint n,q,k;\nint a[N],na[N],b[N],nb[N];\nint x,y,z,u;\nnamespace lib{\n    u64 read(){\n        u64 n=0;\n        char c=getchar();\n        while(c<'0'||c>'9')c=getchar();\n        while(c>='0'&&c<='9'){\n            n=n*10+c-'0';\n            c=getchar();\n        }\n        return n;\n    }\n    char r[30];\n    void write(u64 num){\n        if(num==0){\n            putchar('0');\n            return;\n        }\n        int t=0;\n        while(num){\n            r[t++]=num%10+'0';\n            num/=10;\n        }\n        while(t)putchar(r[--t]);\n    }\n    u64 s;\n    u64 rand(u64 l,u64 r){\n        s=s*19260817+1;\n        return ((s>>8)%(r-l+1)+l);\n    }\n    int ra,t;\n    void init(){\n        n=read();k=read();\n        if(k<2){\n            for(int i=1;i<=n;i++){\n                a[i]=read();na[i]=read();\n            }\n            for(int i=1;i<=n;i++){\n                b[i]=read();nb[i]=read();\n            }\n        }else{\n            s=read();ra=read();\n            u64 bacs=s;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\ta[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//na[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n            \ts=s*19260817+1;\n        \t\t//a[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tna[i]=((s>>8)%(M-1)+1);\n                //na[i]=rand(1,M-1);\n            }\n            bacs=s;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\tb[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\t//nb[i]=((s>>8)%(M-1)+1);\n            }\n            s=bacs;\n            for(int i=1;i<=n;i++){\n                s=s*19260817+1;\n        \t\t//b[i]=((s>>8)%ra+1);\n                //a[i]=rand(1,ra);\n                s=s*19260817+1;\n        \t\tnb[i]=((s>>8)%(M-1)+1);\n            }\n        }\n        q=read();\n    }\n    u64 lastans;\n    u64 res;\n    void reply(u64 num){\n        if(k<2){\n            write(num);putchar('\\n');\n        }else{\n            res=res*233+num;\n        }\n        lastans^=num;\n    }\n    void query(){\n        if(k<2){\n            x=read();y=read();z=read();u=read();\n        }else{\n        \ts=s*19260817+1;\n        \tx=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \ty=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tz=((s>>8)%n+1);\n        \ts=s*19260817+1;\n        \tu=((s>>8)%n+1);\n            //x=rand(1,n);y=rand(1,n);z=rand(1,n);u=rand(1,n);\n        }\n        if(k&1){\n        \tint t=lastans%n+1;\n        \tif((x+=t)>n)x-=n;\n        \tif((y+=t)>n)y-=n;\n        \tif((z+=t)>n)z-=n;\n        \tif((u+=t)>n)u-=n;\n            /*x=(x+lastans)%n+1;\n            y=(y+lastans)%n+1;\n            z=(z+lastans)%n+1;\n            u=(u+lastans)%n+1;*/\n        }\n    }\n    void stop(){\n        if(k>=2){write(res);putchar('\\n');}\n    }\n}\nint main(){\n\tlib::init();\n\t//现在你可以使用生成的a,na,b,nb\n\t\n    //回答第一问\n    \n\tlib::reply(233);\n\t\n\tfor(int i=1;i<=q;i++){\n\t\tlib::query();\n\t\t\n\t\t//回答第二问 \n        \n\t\tlib::reply(233);\n\t}\n\tlib::stop();\n}\n```", "outputFormat": "如果$k=0$，则会分别输出每一问的答案\n\n否则，只会输出一个整数用于检查结果是否正确", "hint": "样例1解释：\n\n当选择第二组武器时，一定能进行一次有效攻击\n\n当选择第一组武器时，只有选择第一组水晶才能进行一次有效攻击\n\n因而，不难求出每一问的答案\n\n建议根据样例进一步理解题意\n\n样例5与样例6一致\n\n数据范围：\n\n对于所有数据，满足$1\\le x,y,z,u \\le n$，$1\\le a_i,b_i\\le 10^9$，$1\\le na_i,nb_i\\le 998244352$\n\n如未特别说明，$k=3$，即：由模板生成数据，强制在线\n\n如果$k=2$，那么这组数据仍由生成器生成，但不强制在线，也就是你可以在不回答询问的情况下得到下一个询问的真实值，随后按顺序回答即可\n\n测试点| 分值| n | q| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1| 4| 100| 100| $k=2$| \n2| 14| 3000| 3000| $k=2$|\n3| 11| 100000| 100000| $a_i,b_i\\le 100$|\n4| 10| 15| 4000000| |\n5| 12| 100| 4000000| |\n6| 14| 5000| 4000000| |\n7| 16| 100000| 100000| |\n8| 19| 2500000| 4000000| |", "locale": "zh-CN"}}}
{"pid": "P5511", "type": "P", "difficulty": 7, "samples": [["10 8 0\n1 1 5 1\n3 1 3 5\n1 1 5 3\n2 2 3 3\n1 1 5 3\n1 1 5 5\n3 3 4 2\n1 1 5 3\n", "5\n2\n2\n4\n2\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "树套树", "分块"], "title": "决战", "background": "Steve 成功突破了水晶防御，即将和黑暗势力进行决战。", "description": "然而黑暗势力具有改变地形的能力，给军队的前进造成了很大困难\n\n为了使军队更快前进，Steve 将核武器带到了前线，用来破坏地形\n\n另外，Steve 很关心当前的地形情况\n\n具体地说，前线的地形可分为 $n$ 段，初始高度为 $0$，决战时会发生 $m$ 个事件，事件可以是：\n\n1. Steve 询问区间 $[l,r]$ 内，有几段小于给定的高度 $h$。\n2. Steve 使用核武器，使得区间 $[l,r]$ 内高度大于 $h$ 的段的高度减少到 $h$。\n3. 黑暗势力改变地形，使得区间 $[l,r]$ 内高度小于 $h$ 的段的高度增加到 $h$。\n\n由于战事非常紧迫，所以部分测试点强制在线。\n\n对于 $k=1$ 的测试点，设上次事件 1 的答案为 $lastans$，你需要将 $l,r,h$ 分别与 $lastans$ 取异或后得到实际数值，如果还没有回答过事件 1，那么 $lastans=0$。", "inputFormat": "第一行 $3$ 个整数 $n,m,k$。\n\n接下来 $m$ 行，每行 $4$ 个整数，描述一个事件。\n\n第一个整数 $opt$ 表示事件种类，接下来 $3$ 个整数 $l,r,h$，含义如题所述。\n\n**数据中存在 $l>r$ 的情况，此时请直接忽略这次操作。**", "outputFormat": "对于每个事件 1，输出一行一个整数，表示询问的答案。", "hint": "样例解释：\n\n```\n[00000]00000=>5[TTTTT]\n[000]0000000\n[55500]00000=>2[FFFTT]\n5[55]0000000\n[53300]00000=>2[FFFTT]\n[53300]00000=>4[FTTTT]\n53[30]000000\n[53320]00000=>2[FFFTT]\n```\n\n数据范围：\n\n对于所有数据，保证 $1\\le l \\le r \\le n,0\\le h \\le 10^9$。\n\nSubtask1 是比赛时的数据。\n\n测试点| 分值| n | m| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1| 4| 1000| 1000| | \n2| 14| 100000| 100000| $h\\le 1$|\n3| 11| 100000| 100000| |\n4| 10| $10^9$| 1000| |\n5| 12| $10^9$| 100000| $k=1,h\\le 1$|\n6| 14| $10^9$| 100000| *|\n7| 16| $10^9$| 100000| |\n8| 19| $10^9$| 100000| $k=1$|\n\n对于第 $6$ 个测试点，保证所有事件 $1$ 都在事件 $2$ 和 $3$ 之后。\n\nSubtask2 为不计分的 Hack 数据，现在仅包含一组数据，满足 #8 的性质。\n\n$\\color{white}\\texttt{不保证数据随机}$", "locale": "zh-CN", "translations": {"en": {"title": "Final Battle", "background": "Steve has successfully broken through the crystal defense and is about to fight the dark forces in a final battle.", "description": "However, the dark forces can change the terrain, which makes it very difficult for the army to advance.\n\nTo help the army move faster, Steve brought nuclear weapons to the front line to destroy the terrain.\n\nAlso, Steve cares a lot about the current terrain situation.\n\nSpecifically, the front-line terrain can be divided into $n$ segments, with initial height $0$. During the final battle, $m$ events will happen. An event can be:\n\n1. Steve asks: in the interval $[l,r]$, how many segments have height less than the given height $h$.\n2. Steve uses nuclear weapons: in the interval $[l,r]$, for segments whose height is greater than $h$, reduce their height to $h$.\n3. The dark forces change the terrain: in the interval $[l,r]$, for segments whose height is less than $h$, increase their height to $h$.\n\nBecause the battle is very urgent, some test points require online processing.\n\nFor test points with $k=1$, let the answer to the last type 1 event be $lastans$. You need to XOR $l$, $r$, and $h$ with $lastans$ respectively to get the actual values. If no type 1 event has been answered yet, then $lastans=0$.", "inputFormat": "The first line contains $3$ integers $n,m,k$.\n\nThe next $m$ lines each contain $4$ integers describing an event.\n\nThe first integer $opt$ indicates the event type, followed by $3$ integers $l,r,h$, with meanings as described above.\n\n**There are cases where $l>r$ in the testdata. In this case, please ignore this operation directly.**", "outputFormat": "For each type 1 event, output one integer per line, which is the answer to the query.", "hint": "Sample explanation:\n\n```\n[00000]00000=>5[TTTTT]\n[000]0000000\n[55500]00000=>2[FFFTT]\n5[55]0000000\n[53300]00000=>2[FFFTT]\n[53300]00000=>4[FTTTT]\n53[30]000000\n[53320]00000=>2[FFFTT]\n```\n\nConstraints:\n\nFor all data, it is guaranteed that $1\\le l \\le r \\le n,0\\le h \\le 10^9$.\n\nSubtask 1 is the data used during the contest.\n\nTest point | Score | $n$ | $m$ | Special property\n:-: | :-: | :-: | :-: | :-:\n1 | 4 | 1000 | 1000 |\n2 | 14 | 100000 | 100000 | $h\\le 1$\n3 | 11 | 100000 | 100000 |\n4 | 10 | $10^9$ | 1000 |\n5 | 12 | $10^9$ | 100000 | $k=1,h\\le 1$\n6 | 14 | $10^9$ | 100000 | *\n7 | 16 | $10^9$ | 100000 |\n8 | 19 | $10^9$ | 100000 | $k=1$\n\nFor test point 6, it is guaranteed that all type 1 events occur after type 2 and type 3 events.\n\nSubtask 2 is unscored hack data. It currently only contains one dataset, satisfying the property of #8.\n\n$\\color{white}\\texttt{No guarantee that the data is random}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "决战", "background": "Steve 成功突破了水晶防御，即将和黑暗势力进行决战。", "description": "然而黑暗势力具有改变地形的能力，给军队的前进造成了很大困难\n\n为了使军队更快前进，Steve 将核武器带到了前线，用来破坏地形\n\n另外，Steve 很关心当前的地形情况\n\n具体地说，前线的地形可分为 $n$ 段，初始高度为 $0$，决战时会发生 $m$ 个事件，事件可以是：\n\n1. Steve 询问区间 $[l,r]$ 内，有几段小于给定的高度 $h$。\n2. Steve 使用核武器，使得区间 $[l,r]$ 内高度大于 $h$ 的段的高度减少到 $h$。\n3. 黑暗势力改变地形，使得区间 $[l,r]$ 内高度小于 $h$ 的段的高度增加到 $h$。\n\n由于战事非常紧迫，所以部分测试点强制在线。\n\n对于 $k=1$ 的测试点，设上次事件 1 的答案为 $lastans$，你需要将 $l,r,h$ 分别与 $lastans$ 取异或后得到实际数值，如果还没有回答过事件 1，那么 $lastans=0$。", "inputFormat": "第一行 $3$ 个整数 $n,m,k$。\n\n接下来 $m$ 行，每行 $4$ 个整数，描述一个事件。\n\n第一个整数 $opt$ 表示事件种类，接下来 $3$ 个整数 $l,r,h$，含义如题所述。\n\n**数据中存在 $l>r$ 的情况，此时请直接忽略这次操作。**", "outputFormat": "对于每个事件 1，输出一行一个整数，表示询问的答案。", "hint": "样例解释：\n\n```\n[00000]00000=>5[TTTTT]\n[000]0000000\n[55500]00000=>2[FFFTT]\n5[55]0000000\n[53300]00000=>2[FFFTT]\n[53300]00000=>4[FTTTT]\n53[30]000000\n[53320]00000=>2[FFFTT]\n```\n\n数据范围：\n\n对于所有数据，保证 $1\\le l \\le r \\le n,0\\le h \\le 10^9$。\n\nSubtask1 是比赛时的数据。\n\n测试点| 分值| n | m| 特殊性质\n:-: | :-: | :-: | :-: | :-:\n1| 4| 1000| 1000| | \n2| 14| 100000| 100000| $h\\le 1$|\n3| 11| 100000| 100000| |\n4| 10| $10^9$| 1000| |\n5| 12| $10^9$| 100000| $k=1,h\\le 1$|\n6| 14| $10^9$| 100000| *|\n7| 16| $10^9$| 100000| |\n8| 19| $10^9$| 100000| $k=1$|\n\n对于第 $6$ 个测试点，保证所有事件 $1$ 都在事件 $2$ 和 $3$ 之后。\n\nSubtask2 为不计分的 Hack 数据，现在仅包含一组数据，满足 #8 的性质。\n\n$\\color{white}\\texttt{不保证数据随机}$", "locale": "zh-CN"}}}
{"pid": "P5512", "type": "P", "difficulty": 5, "samples": [["2", "1 2\n4 3"], ["1", "NO"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "Special Judge"], "title": "[NOIP 1997 提高组] 棋盘问题 加强版", "background": "[P1549](https://www.luogu.org/problem/P1549) 数据加强版。\n\n**数据从 5 扩大到了 10。**\n\n\n\n因为本题数据可能存在诸多争议，故特开一题用来测试加强版数据。", "description": "在 $N \\times N$（$1 \\le N \\le 10$）的棋盘上，填入 $1, 2, \\dots, N ^ 2$ 共 $N ^ 2$ 个数，使得任意两个相邻的数之和为素数。\n\n例如：当 $N = 2$ 时，有：\n\n| $1$ | $2$ |\n| :-----------: | :-----------: |\n| $4$ | $3$ |\n\n其相邻数的和为素数的有：\n\n$1+2,1+4,4+3,2+3$\n\n当 $N=4$ 时，一种可以填写的方案如下：\n\n| $1$ | $2$ | $11$ | $12$ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $16$ | $15$ | $8$ | $5$ |\n| $13$ | $4$ | $9$ | $14$ |\n| $6$ | $7$ | $10$ | $3$ |\n\n在这里我们约定：左上角的格子里必须填数字 $1$。", "inputFormat": "一行一个整数 $N$。", "outputFormat": "如有多种解，则输出第一行、第一列之和为最小的排列方案；若无解，则输出 `NO`。", "hint": "$N\\leq10$\n\n $N=1,2,...,10$ 的数据都各有一个点，由于某些原因， $N$ 不一定与测试点编号相等。\n\n----\n\n**数据新修复于 `2020.1.20`**", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 1997 Senior] Chessboard Problem Enhanced Version", "background": "An enhanced testdata version of [P1549](https://www.luogu.org/problem/P1549).\n\n**The testdata has been expanded from 5 to 10.**\n\nBecause the testdata for this problem may have many disputes, a separate problem is created to test the enhanced version testdata.", "description": "On an $N \\times N$ chessboard ($1 \\le N \\le 10$), fill in $N ^ 2$ numbers $1, 2, \\dots, N ^ 2$, such that the sum of any two adjacent numbers is a prime number.\n\nFor example, when $N = 2$, one solution is:\n\n| $1$ | $2$ |\n| :-----------: | :-----------: |\n| $4$ | $3$ |\n\nThe adjacent pairs whose sums are prime are:\n\n$1+2,1+4,4+3,2+3$\n\nWhen $N = 4$, one possible filling is:\n\n| $1$ | $2$ | $11$ | $12$ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $16$ | $15$ | $8$ | $5$ |\n| $13$ | $4$ | $9$ | $14$ |\n| $6$ | $7$ | $10$ | $3$ |\n\nHere we require that the top-left cell must contain the number $1$.", "inputFormat": "One line with an integer $N$.", "outputFormat": "If there are multiple solutions, output the arrangement with the smallest sum of the first row and the first column. If there is no solution, output `NO`.", "hint": "$N\\leq10$\n\nFor $N=1,2,\\dots,10$, each has one test point. For some reasons, $N$ is not necessarily the same as the test point ID.\n\n----\n\n**The testdata was newly fixed on `2020.1.20`.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 1997 提高组] 棋盘问题 加强版", "background": "[P1549](https://www.luogu.org/problem/P1549) 数据加强版。\n\n**数据从 5 扩大到了 10。**\n\n\n\n因为本题数据可能存在诸多争议，故特开一题用来测试加强版数据。", "description": "在 $N \\times N$（$1 \\le N \\le 10$）的棋盘上，填入 $1, 2, \\dots, N ^ 2$ 共 $N ^ 2$ 个数，使得任意两个相邻的数之和为素数。\n\n例如：当 $N = 2$ 时，有：\n\n| $1$ | $2$ |\n| :-----------: | :-----------: |\n| $4$ | $3$ |\n\n其相邻数的和为素数的有：\n\n$1+2,1+4,4+3,2+3$\n\n当 $N=4$ 时，一种可以填写的方案如下：\n\n| $1$ | $2$ | $11$ | $12$ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $16$ | $15$ | $8$ | $5$ |\n| $13$ | $4$ | $9$ | $14$ |\n| $6$ | $7$ | $10$ | $3$ |\n\n在这里我们约定：左上角的格子里必须填数字 $1$。", "inputFormat": "一行一个整数 $N$。", "outputFormat": "如有多种解，则输出第一行、第一列之和为最小的排列方案；若无解，则输出 `NO`。", "hint": "$N\\leq10$\n\n $N=1,2,...,10$ 的数据都各有一个点，由于某些原因， $N$ 不一定与测试点编号相等。\n\n----\n\n**数据新修复于 `2020.1.20`**", "locale": "zh-CN"}}}
{"pid": "P5513", "type": "P", "difficulty": 6, "samples": [["221LU\n12L2", "3"], ["111RRRRRRR\n222", "0"], ["11111\n222222", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "CEOI（中欧）"], "title": "[CEOI 2013] Board", "background": "", "description": "给出这样一棵“二叉树”:\n - 每个节点有左右两个儿子，并如下定义每个节点的高度：假设父亲节点的高度为 $h$，那么他的两个儿子的节点的高度都是 $h+1$，相同高度的所有节点称作一层。\n\n - 每个节点的左儿子的子树都在右儿子的子树的左边，每一层相邻的两个节点之间有一条边。 下面是一个例子：\n\n![](https://cdn.luogu.com.cn/upload/pic/74384.png)\n\n每一条图上的路径用一个字符串表示，字符串中的每一个字符表示一 个移动。字符仅包含如下五种：\n\n - $\\tt 1$：表示移动到当前节点的左儿子 \n - $\\tt 2$：表示移动到当前节点的右儿子\n - $\\tt U$：表示移动到当前节点的父亲节点 \n - $\\tt L$：表示移动到当前节点同层的左边的节点（保证当前节点在这一层中不是最左边的节点）\n - $\\tt R$：表示移动到当前节点同层的右边的节点（保证当前节点在这一层中不是最右边的节点）\n\n 用一条路径来表示这条路径的终点，例如路径：$\\tt  221LU$ 就表示上图中的节点 $A$。 给出两条路径，你的任务是求出着两条路径的终点之间的最短路。", "inputFormat": "输入两行，每行一个字符串，分别表示两条路径。", "outputFormat": "输出一行，表示两个节点之间的最短路。", "hint": "用 $D$ 表示所有经过的节点中，深度最大的节点的深度；$S$ 表示输入字符串的最大长度。 \n\n- 对于 $10\\%$ 的数据，$D \\leq 10$;\n- 对于 $30\\%$ 的数据，$D \\leq 50$;\n- 对于 $50\\%$ 的数据，$D \\leq 10^3$;\n- 对于 $70\\%$ 的数据，$D\\leq 2 \\times 10^4$; \n- 对于 $100\\%$ 的数据，$D \\leq 10^5, S \\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CEOI 2013] Board", "background": "", "description": "Consider the following “binary tree”:\n\n- Each node has two children, left and right. The height of each node is defined as follows: if the height of a parent node is $h$, then the heights of both of its children are $h+1$. All nodes with the same height form one level.\n\n- The subtree of a node’s left child is to the left of the subtree of its right child. Between every two adjacent nodes on the same level, there is an edge. An example is shown below:\n\n![](https://cdn.luogu.com.cn/upload/pic/74384.png)\n\nEach path in the graph is represented by a string, where each character represents one move. The characters are only the following five types:\n\n- $\\tt 1$: move to the left child of the current node.\n- $\\tt 2$: move to the right child of the current node.\n- $\\tt U$: move to the parent of the current node.\n- $\\tt L$: move to the node on the same level immediately to the left of the current node (it is guaranteed that the current node is not the leftmost node on this level).\n- $\\tt R$: move to the node on the same level immediately to the right of the current node (it is guaranteed that the current node is not the rightmost node on this level).\n\nA path denotes its endpoint. For example, the path $\\tt 221LU$ denotes node $A$ in the figure above. Given two paths, your task is to find the shortest path length between the endpoints of these two paths.", "inputFormat": "Two lines, each containing a string, representing the two paths.", "outputFormat": "Output one line, the length of the shortest path between the two nodes.", "hint": "Let $D$ be the maximum depth among all nodes visited, and let $S$ be the maximum length of the input strings.\n\n- For $10\\%$ of the testdata, $D \\leq 10$.\n- For $30\\%$ of the testdata, $D \\leq 50$.\n- For $50\\%$ of the testdata, $D \\leq 10^3$.\n- For $70\\%$ of the testdata, $D \\leq 2 \\times 10^4$.\n- For $100\\%$ of the testdata, $D \\leq 10^5, S \\leq 10^5$.\n\n# Input Format\n\nTwo lines, each containing a string, representing the two paths.\n\n# Output Format\n\nOutput one line, the length of the shortest path between the two nodes.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CEOI 2013] Board", "background": "", "description": "给出这样一棵“二叉树”:\n - 每个节点有左右两个儿子，并如下定义每个节点的高度：假设父亲节点的高度为 $h$，那么他的两个儿子的节点的高度都是 $h+1$，相同高度的所有节点称作一层。\n\n - 每个节点的左儿子的子树都在右儿子的子树的左边，每一层相邻的两个节点之间有一条边。 下面是一个例子：\n\n![](https://cdn.luogu.com.cn/upload/pic/74384.png)\n\n每一条图上的路径用一个字符串表示，字符串中的每一个字符表示一 个移动。字符仅包含如下五种：\n\n - $\\tt 1$：表示移动到当前节点的左儿子 \n - $\\tt 2$：表示移动到当前节点的右儿子\n - $\\tt U$：表示移动到当前节点的父亲节点 \n - $\\tt L$：表示移动到当前节点同层的左边的节点（保证当前节点在这一层中不是最左边的节点）\n - $\\tt R$：表示移动到当前节点同层的右边的节点（保证当前节点在这一层中不是最右边的节点）\n\n 用一条路径来表示这条路径的终点，例如路径：$\\tt  221LU$ 就表示上图中的节点 $A$。 给出两条路径，你的任务是求出着两条路径的终点之间的最短路。", "inputFormat": "输入两行，每行一个字符串，分别表示两条路径。", "outputFormat": "输出一行，表示两个节点之间的最短路。", "hint": "用 $D$ 表示所有经过的节点中，深度最大的节点的深度；$S$ 表示输入字符串的最大长度。 \n\n- 对于 $10\\%$ 的数据，$D \\leq 10$;\n- 对于 $30\\%$ 的数据，$D \\leq 50$;\n- 对于 $50\\%$ 的数据，$D \\leq 10^3$;\n- 对于 $70\\%$ 的数据，$D\\leq 2 \\times 10^4$; \n- 对于 $100\\%$ 的数据，$D \\leq 10^5, S \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5514", "type": "P", "difficulty": 2, "samples": [["3\n1 2 5", "6"], ["6\n9 18 36 25 9 32\n", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "贪心", "2019", "洛谷原创", "O2优化"], "title": "[MtOI2019] 永夜的报应", "background": "在这世上有一乡一林一竹亭，也有一主一仆一仇敌。\n\n有人曾经想拍下他们的身影，却被可爱的兔子迷惑了心神。\n\n那些迷途中的人啊，终究会消失在不灭的永夜中……  ", "description": "蓬莱山 辉夜(Kaguya)手里有一堆数字。\n\n辉夜手里有 $n$ 个非负整数 $a_1,a_2\\cdots a_n$，由于辉夜去打 Gal Game 去了，她希望智慧的你来帮忙。  \n\n* 你需要将这些数分成若干组，满足 $n$ 个数中的每一个数都恰好被分到了一个组中，且每一组至少包含一个数。  \n\n定义一组数的权值为该组内所有数的**异或和**。请求出一种分组方案，使得分出的所有组数的权值之和最小，输出权值之和的最小值。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示给定的非负整数的数量。\n\n接下来一行包含 $n$ 个非负整数 $a_1,a_2\\cdots a_n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "**样例 $1$ 解释：**\n\n一种最优的分组方案如下：\n\n- 将第 $1$ 个数和第 $3$ 个数分为一组，该组的权值为 $1\\oplus 5 = 4$；\n- 将第 $2$ 个数分为一组，该组的权值为 $2$。\n\n该分组方案的所有组的权值之和为 $4 + 2 = 6$，可以证明，不存在权值之和更小的分组方案。\n\n**样例 $2$ 解释：**\n\n一种最优的分组方案如下：\n\n- 将第 $1$ 个数和第 $5$ 个数分为一组，该组的权值为 $9\\oplus 9 = 0$；\n- 将第 $2$ 个数和第 $4$ 个数分为一组，该组的权值为 $18\\oplus 25 = 11$；\n- 将第 $3$ 个数和第 $6$ 个数分为一组，该组的权值为 $36\\oplus 32 = 4$。\n\n该分组方案的所有组的权值之和为 $0 + 11 + 4 = 15$。可以证明，不存在权值之和更小的分组方案。\n\n### 子任务\n\n- 对于 $80\\%$ 的数据，满足 $n\\leq 15$。\n- 对于 $100\\%$ 的数据，满足 $n\\leq 10^6,a_i \\leq 10^9$。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T1\n\n出题人：disangan233\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Retribution of the Eternal Night", "background": "In this world, there is a village, a forest, and a bamboo pavilion; there is also a master, a servant, and an enemy.\n\nSomeone once wanted to capture their silhouettes, but their mind was confused by cute rabbits.\n\nThose who lose their way will eventually disappear into the unquenchable eternal night.", "description": "Houraisan Kaguya (Kaguya) has a bunch of numbers.\n\nKaguya has $n$ non-negative integers $a_1,a_2\\cdots a_n$. Since Kaguya went to play a Gal Game, she hopes that you, who are wise, can help.\n\n- You need to divide these numbers into several groups, such that each of the $n$ numbers is assigned to exactly one group, and each group contains at least one number.\n\nDefine the weight of a group as the **xor sum** of all numbers in that group. Please find a grouping plan that minimizes the sum of the weights of all groups, and output this minimum value.", "inputFormat": "The first line contains a positive integer $n$, representing the number of given non-negative integers.\n\nThe next line contains $n$ non-negative integers $a_1,a_2\\cdots a_n$.", "outputFormat": "Output one line with one integer representing the answer.", "hint": "**Explanation for Sample $1$:**\n\nOne optimal grouping plan is:\n\n- Put the $1$st number and the $3$rd number into one group, whose weight is $1\\oplus 5 = 4$.\n- Put the $2$nd number into one group, whose weight is $2$.\n\nThe sum of the weights of all groups is $4 + 2 = 6$. It can be proven that there is no grouping plan with a smaller total weight sum.\n\n**Explanation for Sample $2$:**\n\nOne optimal grouping plan is:\n\n- Put the $1$st number and the $5$th number into one group, whose weight is $9\\oplus 9 = 0$.\n- Put the $2$nd number and the $4$th number into one group, whose weight is $18\\oplus 25 = 11$.\n- Put the $3$rd number and the $6$th number into one group, whose weight is $36\\oplus 32 = 4$.\n\nThe sum of the weights of all groups is $0 + 11 + 4 = 15$. It can be proven that there is no grouping plan with a smaller total weight sum.\n\n### Subtasks\n\n- For $80\\%$ of the testdata, $n\\leq 15$.\n- For $100\\%$ of the testdata, $n\\leq 10^6,a_i \\leq 10^9$.\n\n### Source\n\n[Lost Home 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T1\n\nProblem setter: disangan233\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 永夜的报应", "background": "在这世上有一乡一林一竹亭，也有一主一仆一仇敌。\n\n有人曾经想拍下他们的身影，却被可爱的兔子迷惑了心神。\n\n那些迷途中的人啊，终究会消失在不灭的永夜中……  ", "description": "蓬莱山 辉夜(Kaguya)手里有一堆数字。\n\n辉夜手里有 $n$ 个非负整数 $a_1,a_2\\cdots a_n$，由于辉夜去打 Gal Game 去了，她希望智慧的你来帮忙。  \n\n* 你需要将这些数分成若干组，满足 $n$ 个数中的每一个数都恰好被分到了一个组中，且每一组至少包含一个数。  \n\n定义一组数的权值为该组内所有数的**异或和**。请求出一种分组方案，使得分出的所有组数的权值之和最小，输出权值之和的最小值。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示给定的非负整数的数量。\n\n接下来一行包含 $n$ 个非负整数 $a_1,a_2\\cdots a_n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "**样例 $1$ 解释：**\n\n一种最优的分组方案如下：\n\n- 将第 $1$ 个数和第 $3$ 个数分为一组，该组的权值为 $1\\oplus 5 = 4$；\n- 将第 $2$ 个数分为一组，该组的权值为 $2$。\n\n该分组方案的所有组的权值之和为 $4 + 2 = 6$，可以证明，不存在权值之和更小的分组方案。\n\n**样例 $2$ 解释：**\n\n一种最优的分组方案如下：\n\n- 将第 $1$ 个数和第 $5$ 个数分为一组，该组的权值为 $9\\oplus 9 = 0$；\n- 将第 $2$ 个数和第 $4$ 个数分为一组，该组的权值为 $18\\oplus 25 = 11$；\n- 将第 $3$ 个数和第 $6$ 个数分为一组，该组的权值为 $36\\oplus 32 = 4$。\n\n该分组方案的所有组的权值之和为 $0 + 11 + 4 = 15$。可以证明，不存在权值之和更小的分组方案。\n\n### 子任务\n\n- 对于 $80\\%$ 的数据，满足 $n\\leq 15$。\n- 对于 $100\\%$ 的数据，满足 $n\\leq 10^6,a_i \\leq 10^9$。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T1\n\n出题人：disangan233\n\n", "locale": "zh-CN"}}}
{"pid": "P5515", "type": "P", "difficulty": 4, "samples": [["500 233 0", "0.00503"], ["10000 3141592653 0", "0.10166"], ["50000 1314159 0", "0.50722"], ["50000 1314159 1", "1.51676"], ["1000000 5201314 0", "10.30487"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "洛谷原创", "Special Judge", "O2优化", "微积分"], "title": "[MtOI2019] 灵梦的计算器", "background": "**注: 该背景部分改编自 disangan233 中考前买计算器的真实事件。**  \n\n博丽 灵梦 (Hakurei Reimu) 在成功抢回八云 紫 (Yakumo Yukari) 用隙间偷走的香火钱后，她和依神 紫苑 (Yorigami Shion) 去香霖堂买东西啦！  \n\n灵梦想买一个计算器来计算神社的香火钱，但是因为香霖堂的东西太贵了，她选择使用河童重工网络 (Kawashiro Nitori's Network,KNN) 网购一个 Casio 计算器。\n\n但出人意料的是，灵梦使用 KNN 买回来的 Casio 是个假货，最多只能显示整数部分（即向下取整）。   \n\n灵梦很苦恼，因为这个计算器可能会导致一些特别大的误差。所以灵梦想让拥有外界的式神(指电脑)的你帮她解决一个问题。", "description": "灵梦得到了3个实数 $n$ ，$a$ ，$b$ ( $4\\le n\\le 5,5 \\le a,b \\le 10$ ) ，她成功地计算了 $n^a+n^b$，得到了一个只显示整数部分的结果。  \n\n灵梦想知道，若存在一个实数 $n'(n' \\geq 0)$，使得 ${n'}^a+{n'}^b$ 的结果在计算器上与 $n^a+n^b$ 的结果显示出来**完全一致**时，$n'$ 的变化范围，即 $n'$ 的最大值与最小值之差。  \n\n如果你不知道如何计算 $n^k$，请使用`cmath`库的`pow()`函数，`pow(n,k)`的结果即为 $n^k$ 的结果。    \n\n---\n\n为了提高本题的难度，灵梦给你设置了 $T$ 组询问。而为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问(代码来自河童重工)：  \n\n~~~cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#define uint unsigned int\n\tuint sd;int op;\n\tinline void init() {scanf(\"%u %d\", &sd, &op);}\n\tinline uint uint_rand()\n\t{\n\t\tsd ^= sd << 13;\n\t\tsd ^= sd >> 7;\n\t\tsd ^= sd << 11;\n\t\treturn sd;\n\t}\n\tinline double get_n()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn x + 4;\n\t}\n\tinline double get_k()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn (x + 1) * 5;\n\t}\n\tinline void read(double &n,double &a, double &b)\n\t{\n\t\tn = get_n(); a = get_k();\n\t\tif (op) b = a;\n\t\telse b = get_k(); \n\t}\n}\n~~~\n\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::read(n,a,b)` 函数后得到的便是第 $i$ 次询问的 $n_i$, $a_i$ 和 $b_i$。     \n\n为了减少你的输出量，令第 $i$ 次询问的答案为 $s_i$，你只需要输出 $\\sum^{T}_{i=1} s_i$ 。如果你的答案与标准答案的绝对误差在 $10^{-2}$ 以内，你的答案则被视为是正确答案。\n\n本题数据的生成采用时间复杂度**远远劣于**普通算法的高 (da) 精 (bao) 度 (li) 算法来保证精度，本题数据保证**单次询问的误差**小于 $10^{-10}$，**所以本题的SPJ范围对于正解来说是完全足够的。**\n\n---\n\n为了让你更好地做题，这里给出了关于 $op$ 的说明：   \n\n* 当 $op=1$ 时，有 $a=b$，否则无特殊限定。  ", "inputFormat": "输入共一行，包含 $3$ 个正整数  $T$，$seed$，$op$，含义见题目描述。", "outputFormat": "输出共一行，输出题目描述中要求输出的答案。", "hint": "### 子任务\n\n![QQ图片20190707214000.png](https://i.loli.net/2019/07/07/5d21f64bc09c827059.png)\n\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T2\n\n出题人：disangan233\n\n验题人：suwakow\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Reimu's Calculator.", "background": "**Note: This background is adapted from a real event where disangan233 bought a calculator before the high school entrance exam.**  \n\nAfter Hakurei Reimu successfully took back the donation money that Yakumo Yukari stole using gaps, she and Yorigami Shion went to Kourindou to buy things!  \n\nReimu wanted to buy a calculator to compute the shrine’s donation money, but since the goods in Kourindou were too expensive, she chose to buy a Casio calculator online via Kawashiro Nitori's Network (KNN).\n\nUnexpectedly, the Casio she bought through KNN was a fake. It can display only the integer part (i.e., it always rounds down).  \n\nReimu is troubled, because this calculator may cause some especially large errors. So Reimu wants you, who have a shikigami from the Outside World (meaning a computer), to help her solve a problem.", "description": "Reimu is given 3 real numbers $n$, $a$, $b$ ($4 \\le n \\le 5$, $5 \\le a,b \\le 10$). She successfully computed $n^a+n^b$, and got a result that shows only the integer part on the calculator.  \n\nReimu wants to know: if there exists a real number $n'(n' \\geq 0)$ such that the result of ${n'}^a+{n'}^b$ shown on the calculator is **exactly the same** as the result shown for $n^a+n^b$, then what is the range of possible values of $n'$, i.e., the difference between the maximum and minimum possible $n'$.  \n\nIf you do not know how to compute $n^k$, please use the `pow()` function in the `cmath` library. The result of `pow(n,k)` is $n^k$.    \n\n---\n\nTo increase the difficulty of this problem, Reimu gives you $T$ queries. To reduce your input and output to some extent, we generate the queries using the following code (the code comes from Kawashiro Heavy Industries):\n\n~~~cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#define uint unsigned int\n\tuint sd;int op;\n\tinline void init() {scanf(\"%u %d\", &sd, &op);}\n\tinline uint uint_rand()\n\t{\n\t\tsd ^= sd << 13;\n\t\tsd ^= sd >> 7;\n\t\tsd ^= sd << 11;\n\t\treturn sd;\n\t}\n\tinline double get_n()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn x + 4;\n\t}\n\tinline double get_k()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn (x + 1) * 5;\n\t}\n\tinline void read(double &n,double &a, double &b)\n\t{\n\t\tn = get_n(); a = get_k();\n\t\tif (op) b = a;\n\t\telse b = get_k(); \n\t}\n}\n~~~\n\nAfter calling `Mker::init()`, when you call `Mker::read(n,a,b)` for the $i$-th time, you will obtain the $i$-th query’s $n_i$, $a_i$, and $b_i$.     \n\nTo reduce your output, let the answer to the $i$-th query be $s_i$. You only need to output $\\sum^{T}_{i=1} s_i$. If the absolute error between your answer and the standard answer is within $10^{-2}$, your answer will be considered correct.\n\nThe testdata of this problem is generated using a high (da) precision (bao) algorithm with a time complexity **much worse** than normal algorithms, to ensure accuracy. The testdata guarantees that the **error of each single query** is less than $10^{-10}$, so the SPJ tolerance for this problem is completely sufficient for correct solutions.\n\n---\n\nTo help you solve the problem, here is an explanation of $op$:  \n\n* When $op=1$, we have $a=b$. Otherwise, there is no special constraint.", "inputFormat": "The input contains one line with $3$ positive integers $T$, $seed$, $op$. Their meanings are described in the problem statement.", "outputFormat": "Output one line, the answer required in the problem statement.", "hint": "### Subtasks\n\n![QQ图片20190707214000.png](https://i.loli.net/2019/07/07/5d21f64bc09c827059.png)\n\n\n### Source\n\n[Lost House 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T2\n\nProblem setter: disangan233\n\nProblem reviewer: suwakow\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 灵梦的计算器", "background": "**注: 该背景部分改编自 disangan233 中考前买计算器的真实事件。**  \n\n博丽 灵梦 (Hakurei Reimu) 在成功抢回八云 紫 (Yakumo Yukari) 用隙间偷走的香火钱后，她和依神 紫苑 (Yorigami Shion) 去香霖堂买东西啦！  \n\n灵梦想买一个计算器来计算神社的香火钱，但是因为香霖堂的东西太贵了，她选择使用河童重工网络 (Kawashiro Nitori's Network,KNN) 网购一个 Casio 计算器。\n\n但出人意料的是，灵梦使用 KNN 买回来的 Casio 是个假货，最多只能显示整数部分（即向下取整）。   \n\n灵梦很苦恼，因为这个计算器可能会导致一些特别大的误差。所以灵梦想让拥有外界的式神(指电脑)的你帮她解决一个问题。", "description": "灵梦得到了3个实数 $n$ ，$a$ ，$b$ ( $4\\le n\\le 5,5 \\le a,b \\le 10$ ) ，她成功地计算了 $n^a+n^b$，得到了一个只显示整数部分的结果。  \n\n灵梦想知道，若存在一个实数 $n'(n' \\geq 0)$，使得 ${n'}^a+{n'}^b$ 的结果在计算器上与 $n^a+n^b$ 的结果显示出来**完全一致**时，$n'$ 的变化范围，即 $n'$ 的最大值与最小值之差。  \n\n如果你不知道如何计算 $n^k$，请使用`cmath`库的`pow()`函数，`pow(n,k)`的结果即为 $n^k$ 的结果。    \n\n---\n\n为了提高本题的难度，灵梦给你设置了 $T$ 组询问。而为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问(代码来自河童重工)：  \n\n~~~cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#define uint unsigned int\n\tuint sd;int op;\n\tinline void init() {scanf(\"%u %d\", &sd, &op);}\n\tinline uint uint_rand()\n\t{\n\t\tsd ^= sd << 13;\n\t\tsd ^= sd >> 7;\n\t\tsd ^= sd << 11;\n\t\treturn sd;\n\t}\n\tinline double get_n()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn x + 4;\n\t}\n\tinline double get_k()\n\t{\n\t\tdouble x = (double) (uint_rand() % 100000) / 100000;\n\t\treturn (x + 1) * 5;\n\t}\n\tinline void read(double &n,double &a, double &b)\n\t{\n\t\tn = get_n(); a = get_k();\n\t\tif (op) b = a;\n\t\telse b = get_k(); \n\t}\n}\n~~~\n\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::read(n,a,b)` 函数后得到的便是第 $i$ 次询问的 $n_i$, $a_i$ 和 $b_i$。     \n\n为了减少你的输出量，令第 $i$ 次询问的答案为 $s_i$，你只需要输出 $\\sum^{T}_{i=1} s_i$ 。如果你的答案与标准答案的绝对误差在 $10^{-2}$ 以内，你的答案则被视为是正确答案。\n\n本题数据的生成采用时间复杂度**远远劣于**普通算法的高 (da) 精 (bao) 度 (li) 算法来保证精度，本题数据保证**单次询问的误差**小于 $10^{-10}$，**所以本题的SPJ范围对于正解来说是完全足够的。**\n\n---\n\n为了让你更好地做题，这里给出了关于 $op$ 的说明：   \n\n* 当 $op=1$ 时，有 $a=b$，否则无特殊限定。  ", "inputFormat": "输入共一行，包含 $3$ 个正整数  $T$，$seed$，$op$，含义见题目描述。", "outputFormat": "输出共一行，输出题目描述中要求输出的答案。", "hint": "### 子任务\n\n![QQ图片20190707214000.png](https://i.loli.net/2019/07/07/5d21f64bc09c827059.png)\n\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T2\n\n出题人：disangan233\n\n验题人：suwakow\n", "locale": "zh-CN"}}}
{"pid": "P5516", "type": "P", "difficulty": 6, "samples": [["NACLYFISHAKIOI\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0", "164.9"], ["DSGAY\n1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0\n1.0 1.0 1.0 1.0 1.0\n\n", "16.0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262139, 262139, 262139, 262139, 262139, 262139, 262139, 262139, 262139, 262139]}, "tags": ["动态规划 DP", "2019", "洛谷原创", "O2优化", "期望"], "title": "[MtOI2019] 小铃的烦恼", "background": "在幻想乡中，本居 小铃(Motoori Kosuzu)不仅经常被人撞，还要整理铃奈庵的书籍，她有很多烦恼。", "description": "小铃每天都会整理一次铃奈庵的书籍。这次桌子上有 $n$ 本魔法书，这些书一次排成一排，每本书有一个魔法属性和编号。\n\n最开始这些书的魔法属性都是一样的，但是因为被人多次使用，魔法属性发生了变化，小铃想让所有书的魔法属性重新全部相同。\n\n这次小铃找到了雾雨 魔理沙(Kirisame Marisa)帮忙整理书籍，每次魔理沙可以释放选定魔法，魔法会随机选择两本书 $a,b$ ( $a$ 不等于 $b$ )。\n\n选定这两本书后，魔理沙会释放转移魔法，使得有 $p_{a,b}\\ (p_{a,b}\\in (0,1])$ 的概率，第 $b$ 本书的魔法属性变成第 $a$ 本书的魔法属性。也就是说有 $1-p_{a,b}$ 的概率，使得你**即使选定了 $a,b$ 两本书，但是魔法属性的转移不成功，意味着这次操作是无效的** 。\n\n注意 $p_{a,b}$ 是对于**转移是否成功的概率**，和随机选择两本书的操作互不影响。\n\n现在小铃想知道，求期望操作多少次，才能使所有的书魔法属性都一样？由于时间紧迫，小铃找到了你，希望你可以帮其解决这个问题，不然小铃就不会给你这题的分了。", "inputFormat": "第一行一个字符串，第 $i$ 个字符表示第 $i$ 本书的魔法属性，注意每本书的魔法属性为 $A$ 到 $Z$ 的所有的大写字母中的任意一字母。(设字符串的长度为 $n$ ) 。\n\n第二行到第 $n+1$ 行，每行 $n$ 个实数，第 $i$ 行的第 $j$ 个数表示 $p_{i,j}$ 。", "outputFormat": "结果，精确到小数点后 $1$ 位。", "hint": "对于前 $10\\%$ 的数据，$n\\leq 10$，且最多有一种不同的魔法属性。\n\n对于另外 $20\\%$ 的数据，$n\\leq10$，且最多有两种不同的魔法属性，并且其中一种的魔法属性的个数小于等于 $1$  。\n\n对于 $100\\%$ 的数据，$n\\leq2\\times 10^3$ 。\n\n对于所有数据，满足 $\\left(\\sum\\limits_{a=1}^{n}\\sum\\limits_{b=1}^{n}p_{a,b}\\right) = n^2$ 。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T3\n\n出题人：Qiuly \n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Kosuzu's Troubles", "background": "In Gensokyo, Motoori Kosuzu not only often gets bumped into by others, but also has to organize the books in Suzunaan. She has many troubles.", "description": "Kosuzu organizes the books in Suzunaan once every day. This time there are $n$ magic books on the table, placed in a row. Each book has a magic attribute and an index.\n\nAt the beginning, all books had the same magic attribute. However, after being used many times, their magic attributes changed. Kosuzu wants all books to have the same magic attribute again.\n\nThis time Kosuzu asks Kirisame Marisa for help. Each time, Marisa can cast a chosen spell, and the spell will randomly choose two books $a,b$ (where $a$ is not equal to $b$).\n\nAfter these two books are chosen, Marisa casts a transfer spell: with probability $p_{a,b}\\ (p_{a,b}\\in (0,1])$, the magic attribute of book $b$ becomes the magic attribute of book $a$. That is, with probability $1-p_{a,b}$, **even if you have chosen books $a,b$, the transfer fails, meaning this operation is invalid**.\n\nNote that $p_{a,b}$ is the **probability that the transfer succeeds**, and it does not affect the random process of choosing the two books.\n\nNow Kosuzu wants to know: what is the expected number of operations needed to make the magic attributes of all books identical? Since time is tight, Kosuzu asks you for help. Otherwise, she will not give you the points for this problem.", "inputFormat": "The first line contains a string. The $i$-th character represents the magic attribute of the $i$-th book. Note that each book’s magic attribute is any uppercase letter from $A$ to $Z$. (Let the length of the string be $n$.)\n\nLines $2$ to $n+1$ each contain $n$ real numbers. The $j$-th number on the $i$-th of these lines represents $p_{i,j}$.", "outputFormat": "Output the answer, accurate to $1$ digit after the decimal point.", "hint": "For the first $10\\%$ of the testdata, $n\\leq 10$, and there is at most one kind of magic attribute.\n\nFor another $20\\%$ of the testdata, $n\\leq 10$, and there are at most two kinds of magic attributes, and the count of one of the attributes is at most $1$.\n\nFor $100\\%$ of the testdata, $n\\leq2\\times 10^3$.\n\nFor all testdata, $\\left(\\sum\\limits_{a=1}^{n}\\sum\\limits_{b=1}^{n}p_{a,b}\\right) = n^2$.\n\n### Source\n\n[Meituzhijia 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T3\n\nProblem setter: Qiuly\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 小铃的烦恼", "background": "在幻想乡中，本居 小铃(Motoori Kosuzu)不仅经常被人撞，还要整理铃奈庵的书籍，她有很多烦恼。", "description": "小铃每天都会整理一次铃奈庵的书籍。这次桌子上有 $n$ 本魔法书，这些书一次排成一排，每本书有一个魔法属性和编号。\n\n最开始这些书的魔法属性都是一样的，但是因为被人多次使用，魔法属性发生了变化，小铃想让所有书的魔法属性重新全部相同。\n\n这次小铃找到了雾雨 魔理沙(Kirisame Marisa)帮忙整理书籍，每次魔理沙可以释放选定魔法，魔法会随机选择两本书 $a,b$ ( $a$ 不等于 $b$ )。\n\n选定这两本书后，魔理沙会释放转移魔法，使得有 $p_{a,b}\\ (p_{a,b}\\in (0,1])$ 的概率，第 $b$ 本书的魔法属性变成第 $a$ 本书的魔法属性。也就是说有 $1-p_{a,b}$ 的概率，使得你**即使选定了 $a,b$ 两本书，但是魔法属性的转移不成功，意味着这次操作是无效的** 。\n\n注意 $p_{a,b}$ 是对于**转移是否成功的概率**，和随机选择两本书的操作互不影响。\n\n现在小铃想知道，求期望操作多少次，才能使所有的书魔法属性都一样？由于时间紧迫，小铃找到了你，希望你可以帮其解决这个问题，不然小铃就不会给你这题的分了。", "inputFormat": "第一行一个字符串，第 $i$ 个字符表示第 $i$ 本书的魔法属性，注意每本书的魔法属性为 $A$ 到 $Z$ 的所有的大写字母中的任意一字母。(设字符串的长度为 $n$ ) 。\n\n第二行到第 $n+1$ 行，每行 $n$ 个实数，第 $i$ 行的第 $j$ 个数表示 $p_{i,j}$ 。", "outputFormat": "结果，精确到小数点后 $1$ 位。", "hint": "对于前 $10\\%$ 的数据，$n\\leq 10$，且最多有一种不同的魔法属性。\n\n对于另外 $20\\%$ 的数据，$n\\leq10$，且最多有两种不同的魔法属性，并且其中一种的魔法属性的个数小于等于 $1$  。\n\n对于 $100\\%$ 的数据，$n\\leq2\\times 10^3$ 。\n\n对于所有数据，满足 $\\left(\\sum\\limits_{a=1}^{n}\\sum\\limits_{b=1}^{n}p_{a,b}\\right) = n^2$ 。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T3\n\n出题人：Qiuly \n", "locale": "zh-CN"}}}
{"pid": "P5517", "type": "P", "difficulty": 6, "samples": [["142857 1145141919 0", "562611141"], ["142857 1145141919 1", "894946216"], ["142857 1145141919 2", "771134436"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2019", "洛谷原创", "O2优化", "矩阵加速", "生成函数", "线性递推"], "title": "[MtOI2019] 幻想乡数学竞赛", "background": "一年一度的幻想乡数学竞赛 (thMO) 又要开始了。\n\n幻想乡中学习数学的少 (lao) 女 (tai) 们 (po) 和冰之妖精 baka 一起准备着 thMO。\n\n但是在那一刻，幻想乡日复一日的宁静被打破了。\n\n广播里，播放起了死亡的歌曲！\n\n在那一刻，人们又回想起了被算数支配的恐惧。  \n\n就剩下 baka，baka，baka，baka 的声音在幻想乡里回荡。  \n \n\n---  \n\n河城 荷取 (Kawashiro Nitori) 正坐在 thMO2019 的考场上！  \n因为荷取有着她的[超级计算机](https://www.luogu.org/problemnew/show/P4911)，在成功地用光学迷彩覆盖了计算机之后，荷取在 thMO2019 的考场上所向披靡。  \n\n* 荷取用她的超级计算机 $0 \\,\\mathrm{ms}$ 跑出了这么一道题：  \n\n  * $\\exists \\{ a_n\\} (n=0,1,\\cdots ,10^{18})$，已知 $a_0=2,a_1=5,a_{n+2}=3a_{n+1}-2a_n$，求 $a_n\\bmod 10^{9}+7$\n\n* 荷取：显然，这个题可以用矩阵乘法 + 快速幂，可以 $O(\\log n)$ 水过去，差不多就这样：\n\n$$\n\\begin{bmatrix} a_n & a_{n+1} \\end{bmatrix}=\\begin{bmatrix} a_0 & a_1 \\end{bmatrix} \\times \\begin{bmatrix} 3 & 1 \\\\ -2 & 0 \\end{bmatrix}^n\n$$      \n  \n但是荷取遇到了一道她不会的题，她正在寻求你的帮助呢！ ", "description": "存在一个数列 $\\{ a_n\\} (n\\in \\{ 0,1,2,\\cdots ,2^{64}-1\\} )$。  \n已知 $a_0=-3,a_1=-6,a_2=-12,a_n=3a_{n-1}+a_{n-2}-3a_{n-3}+3^n$。  \n\n* 现在给你一个非负整数 $n$ ，令 $p=10^{9}+7$，请你求出 $a_n \\bmod p$。 \n\n* **注：若 $a_n<0$ ，请输出 $(a_n \\bmod p+p)\\bmod p$。**    \n  \n  \n为了更充分地考验你的水平，荷取设置了 $T$ 组询问。\n\n* 为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问：  \n  \n```cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#include<climits>\n\t#define ull unsigned long long\n\t#define uint unsigned int\n\tull sd;int op;\n\tinline void init() {scanf(\"%llu %d\", &sd, &op);}\n\tinline ull ull_rand()\n\t{\n\t\tsd ^= sd << 43;\n\t\tsd ^= sd >> 29;\n\t\tsd ^= sd << 34;\n\t\treturn sd;\n\t}\n\tinline ull rand()\n\t{\n\t\tif (op == 0) return ull_rand() % USHRT_MAX + 1;\n\t\tif (op == 1) return ull_rand() % UINT_MAX + 1; \n\t\tif (op == 2) return ull_rand();\n\t}\n}\n```  \n\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::rand()` 函数时返回的便是第 $i$ 次询问的 $n_i$。\n\n在这里给出 $op$ 的限制：\n\n* 如果 $op=0$，满足 $n_i \\leq 2^{16}$。\n\n* 如果 $op=1$，满足 $n_i \\leq 2^{32}$。\n\n* 如果 $op=2$，满足 $n_i \\leq 2^{64}-1$。\n\n为了减少你的输出量，你只需要输出所有询问答案的**异或和**。\n\n\n\n", "inputFormat": "第一行三个整数，输入 $T$ ， $seed$ 和 $op$。", "outputFormat": "第一行一个整数，输出 $T$ 组询问的答案的**异或和**。  ", "hint": "### 子任务  \n\n![png](https://i.loli.net/2019/04/19/5cb9bb2c6c1d6.png)  \n\n### 题目来源\n\n[迷途之家 2019 联赛](https://www.luogu.org/contest/20135)(MtOI2019) T4\n\n出题人：disangan233\n\n验题人：suwakow\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Gensokyo Mathematics Contest", "background": "The annual Gensokyo Mathematics Contest (thMO) is about to begin again.\n\nThe young (actually old) girls (actually housewives) who study math in Gensokyo, together with the ice fairy baka, are preparing for thMO.\n\nBut at that moment, the day-by-day peace of Gensokyo was broken.\n\nOn the radio, a song of death started playing!\n\nAt that moment, people recalled the fear of being ruled by arithmetic again.\n\nOnly the voice of baka, baka, baka, baka echoed throughout Gensokyo.\n\n---\n\nKawashiro Nitori is sitting in the thMO2019 exam room!  \nBecause Nitori has her [supercomputer](https://www.luogu.org/problemnew/show/P4911), after successfully covering it with optical camouflage, she became unstoppable in the thMO2019 exam.\n\n* Nitori used her supercomputer to solve this problem in $0 \\,\\mathrm{ms}$:\n\n  * $\\exists \\{ a_n\\} (n=0,1,\\cdots ,10^{18})$，given $a_0=2,a_1=5,a_{n+2}=3a_{n+1}-2a_n$, find $a_n\\bmod 10^{9}+7$\n\n* Nitori: Obviously, this can be done with matrix multiplication + fast exponentiation, and you can pass it in $O(\\log n)$, roughly like this:\n\n$$\n\\begin{bmatrix} a_n & a_{n+1} \\end{bmatrix}=\\begin{bmatrix} a_0 & a_1 \\end{bmatrix} \\times \\begin{bmatrix} 3 & 1 \\\\ -2 & 0 \\end{bmatrix}^n\n$$\n\nBut Nitori encountered a problem she cannot solve, and she is asking for your help!", "description": "There exists a sequence $\\{ a_n\\} (n\\in \\{ 0,1,2,\\cdots ,2^{64}-1\\} )$.  \nGiven $a_0=-3,a_1=-6,a_2=-12,a_n=3a_{n-1}+a_{n-2}-3a_{n-3}+3^n$.\n\n* Now you are given a non-negative integer $n$. Let $p=10^{9}+7$. Please compute $a_n \\bmod p$.\n\n* **Note: if $a_n<0$, please output $(a_n \\bmod p+p)\\bmod p$.**\n\nTo test your skills more thoroughly, Nitori prepared $T$ queries.\n\n* To reduce the amount of input and output to some extent, we generate the queries using the following code:\n\n```cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#include<climits>\n\t#define ull unsigned long long\n\t#define uint unsigned int\n\tull sd;int op;\n\tinline void init() {scanf(\"%llu %d\", &sd, &op);}\n\tinline ull ull_rand()\n\t{\n\t\tsd ^= sd << 43;\n\t\tsd ^= sd >> 29;\n\t\tsd ^= sd << 34;\n\t\treturn sd;\n\t}\n\tinline ull rand()\n\t{\n\t\tif (op == 0) return ull_rand() % USHRT_MAX + 1;\n\t\tif (op == 1) return ull_rand() % UINT_MAX + 1; \n\t\tif (op == 2) return ull_rand();\n\t}\n}\n```\n\nAfter calling `Mker::init()`, the value returned by your $i$-th call to `Mker::rand()` is the $n_i$ of the $i$-th query.\n\nThe constraints on $op$ are as follows:\n\n* If $op=0$, then $n_i \\leq 2^{16}$.\n\n* If $op=1$, then $n_i \\leq 2^{32}$.\n\n* If $op=2$, then $n_i \\leq 2^{64}-1$.\n\nTo reduce your output size, you only need to output the **xor sum** of the answers of all queries.", "inputFormat": "The first line contains three integers: $T$, $seed$, and $op$.", "outputFormat": "Output one integer: the **xor sum** of the answers to the $T$ queries.", "hint": "### Subtasks\n\n![png](https://i.loli.net/2019/04/19/5cb9bb2c6c1d6.png)\n\n### Source\n\n[Lost Home 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T4\n\nProblem setter: disangan233\n\nProblem tester: suwakow\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 幻想乡数学竞赛", "background": "一年一度的幻想乡数学竞赛 (thMO) 又要开始了。\n\n幻想乡中学习数学的少 (lao) 女 (tai) 们 (po) 和冰之妖精 baka 一起准备着 thMO。\n\n但是在那一刻，幻想乡日复一日的宁静被打破了。\n\n广播里，播放起了死亡的歌曲！\n\n在那一刻，人们又回想起了被算数支配的恐惧。  \n\n就剩下 baka，baka，baka，baka 的声音在幻想乡里回荡。  \n \n\n---  \n\n河城 荷取 (Kawashiro Nitori) 正坐在 thMO2019 的考场上！  \n因为荷取有着她的[超级计算机](https://www.luogu.org/problemnew/show/P4911)，在成功地用光学迷彩覆盖了计算机之后，荷取在 thMO2019 的考场上所向披靡。  \n\n* 荷取用她的超级计算机 $0 \\,\\mathrm{ms}$ 跑出了这么一道题：  \n\n  * $\\exists \\{ a_n\\} (n=0,1,\\cdots ,10^{18})$，已知 $a_0=2,a_1=5,a_{n+2}=3a_{n+1}-2a_n$，求 $a_n\\bmod 10^{9}+7$\n\n* 荷取：显然，这个题可以用矩阵乘法 + 快速幂，可以 $O(\\log n)$ 水过去，差不多就这样：\n\n$$\n\\begin{bmatrix} a_n & a_{n+1} \\end{bmatrix}=\\begin{bmatrix} a_0 & a_1 \\end{bmatrix} \\times \\begin{bmatrix} 3 & 1 \\\\ -2 & 0 \\end{bmatrix}^n\n$$      \n  \n但是荷取遇到了一道她不会的题，她正在寻求你的帮助呢！ ", "description": "存在一个数列 $\\{ a_n\\} (n\\in \\{ 0,1,2,\\cdots ,2^{64}-1\\} )$。  \n已知 $a_0=-3,a_1=-6,a_2=-12,a_n=3a_{n-1}+a_{n-2}-3a_{n-3}+3^n$。  \n\n* 现在给你一个非负整数 $n$ ，令 $p=10^{9}+7$，请你求出 $a_n \\bmod p$。 \n\n* **注：若 $a_n<0$ ，请输出 $(a_n \\bmod p+p)\\bmod p$。**    \n  \n  \n为了更充分地考验你的水平，荷取设置了 $T$ 组询问。\n\n* 为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问：  \n  \n```cpp\nnamespace Mker\n{\n//  Powered By Kawashiro_Nitori\n//  Made In Gensokyo, Nihon\n\t#include<climits>\n\t#define ull unsigned long long\n\t#define uint unsigned int\n\tull sd;int op;\n\tinline void init() {scanf(\"%llu %d\", &sd, &op);}\n\tinline ull ull_rand()\n\t{\n\t\tsd ^= sd << 43;\n\t\tsd ^= sd >> 29;\n\t\tsd ^= sd << 34;\n\t\treturn sd;\n\t}\n\tinline ull rand()\n\t{\n\t\tif (op == 0) return ull_rand() % USHRT_MAX + 1;\n\t\tif (op == 1) return ull_rand() % UINT_MAX + 1; \n\t\tif (op == 2) return ull_rand();\n\t}\n}\n```  \n\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::rand()` 函数时返回的便是第 $i$ 次询问的 $n_i$。\n\n在这里给出 $op$ 的限制：\n\n* 如果 $op=0$，满足 $n_i \\leq 2^{16}$。\n\n* 如果 $op=1$，满足 $n_i \\leq 2^{32}$。\n\n* 如果 $op=2$，满足 $n_i \\leq 2^{64}-1$。\n\n为了减少你的输出量，你只需要输出所有询问答案的**异或和**。\n\n\n\n", "inputFormat": "第一行三个整数，输入 $T$ ， $seed$ 和 $op$。", "outputFormat": "第一行一个整数，输出 $T$ 组询问的答案的**异或和**。  ", "hint": "### 子任务  \n\n![png](https://i.loli.net/2019/04/19/5cb9bb2c6c1d6.png)  \n\n### 题目来源\n\n[迷途之家 2019 联赛](https://www.luogu.org/contest/20135)(MtOI2019) T4\n\n出题人：disangan233\n\n验题人：suwakow\n", "locale": "zh-CN"}}}
{"pid": "P5518", "type": "P", "difficulty": 7, "samples": [["3 998244853\n1 1 1\n2 2 2\n3 3 3\n", "1 1 1\n16 4096 16\n180292630 873575259 180292630\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "洛谷原创", "Special Judge", "O2优化", "莫比乌斯反演", "整除分块"], "title": "[MtOI2019] 幽灵乐团 / 莫比乌斯反演基础练习题", "background": "白玉楼中，冥界的音乐会开始了。\n\nLunasa，Lyrica 和 Merlin 正在演奏。", "description": "东风谷 早苗(Kochiya Sanae)非常喜欢幽灵乐团的演奏，她想对她们的演奏评分。\n\n因为幽灵乐团有 $3$ 个人，所以我们可以用 $3$ 个正整数 $A,B,C$ 来表示出乐团演奏的分数，她们的演奏分数可以表示为\n\n$$\\prod_{i=1}^{A}\\prod_{j=1}^{B}\\prod_{k=1}^{C}\\left(\\frac{\\text{lcm}(i,j)}{\\gcd(i,k)}\\right)^{f(type)}$$\n\n因为音乐在不同的部分会有不同的听觉感受，所以 $type$ 会在 $\\{0,1,2\\}$ 中发生变化，其中：\n\n$$\\begin{aligned}\nf(0)&=1 \\cr\nf(1)&=i \\times j \\times k \\cr\nf(2)&=\\gcd(i,j,k)\n\\end{aligned}$$\n\n因为乐团的歌实在太好听了，导致分数特别高，所以她们的分数要对给定的正整数 $p$ 取模。\n\n因为有很多歌曲要演奏，所以早苗给出了 $T$ 组询问。", "inputFormat": "第一行两个正整数 $T$，$p$，含义详见题目描述。\n\n接下来 $T$ 行，每行三个正整数 $A,B,C$ 表示每组询问。", "outputFormat": "$T$ 行，每行三个正整数分别表示 $type=0/1/2$ 的时候给定式子的值。", "hint": "### 数据范围及约定\n\n对于 $10\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 50 $$  \n\n对于 $20\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 100 $$\n\n另有 $10\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 100\\ \\ \\ \\ \\ A=B=C $$  \n\n对于 $60\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 10^3 $$\n\n对于 $100\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 10^5 \\ \\ \\ \\ 10^7 \\leq p \\leq 1.05\\times 10^9\\ \\ \\ \\ p\\in \\{ prime\\} \\ \\ \\ \\ T =70$$\n\n---\n\n早苗非常善良，就算你不知道所有的正确答案，她也会给你一些分数。 \n \n* 如果你的第一列是正确的，她将会给你这个测试点 $20\\%$ 的分数。\n* 如果你的第二列是正确的，她将会给你这个测试点 $40\\%$ 的分数。\n* 如果你的第三列是正确的，她将会给你这个测试点 $40\\%$ 的分数。  \n\n所以就算你不知道答案是什么，也请你在你不知道的那些地方输出 $[0,2^{31})$ 内的整数，否则可能会造成不可预估的错误。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T5\n\n出题人：CYJian \n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Ghost Band / Basic Practice of Möbius Inversion.", "background": "In Hakugyokurou, the concert in the Netherworld has begun.\n\nLunasa, Lyrica, and Merlin are performing.", "description": "Kochiya Sanae really likes the performance of the Ghost Band, and she wants to score their performance.\n\nSince the Ghost Band has $3$ members, we can use three positive integers $A,B,C$ to represent the score of the band’s performance. Their performance score can be written as\n\n$$\\prod_{i=1}^{A}\\prod_{j=1}^{B}\\prod_{k=1}^{C}\\left(\\frac{\\text{lcm}(i,j)}{\\gcd(i,k)}\\right)^{f(type)}$$\n\nBecause the music sounds different in different parts, $type$ changes within $\\{0,1,2\\}$, where:\n\n$$\\begin{aligned}\nf(0)&=1 \\cr\nf(1)&=i \\times j \\times k \\cr\nf(2)&=\\gcd(i,j,k)\n\\end{aligned}$$\n\nBecause the band’s songs are so good that the score becomes very large, the score should be taken modulo a given positive integer $p$.\n\nSince there are many songs to perform, Sanae gives $T$ queries.", "inputFormat": "The first line contains two positive integers $T$ and $p$, as described above.\n\nThe next $T$ lines each contain three positive integers $A,B,C$, representing one query.", "outputFormat": "Output $T$ lines. Each line contains three positive integers, representing the value of the given expression when $type=0/1/2$, respectively.", "hint": "### Constraints and Notes\n\nFor $10\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 50 $$\n\nFor $20\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 100 $$\n\nAnother $10\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 100\\ \\ \\ \\ \\ A=B=C $$\n\nFor $60\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 10^3 $$\n\nFor $100\\%$ of the testdata:\n\n$$ 1\\leq A,B,C\\leq 10^5 \\ \\ \\ \\ 10^7 \\leq p \\leq 1.05\\times 10^9\\ \\ \\ \\ p\\in \\{ prime\\} \\ \\ \\ \\ T =70$$\n\n---\n\nSanae is very kind. Even if you do not know all the correct answers, she will still give you some points.\n\n* If your first column is correct, she will give you $20\\%$ of the score for this test point.\n* If your second column is correct, she will give you $40\\%$ of the score for this test point.\n* If your third column is correct, she will give you $40\\%$ of the score for this test point.\n\nSo even if you do not know what the answers are, please output an integer in $[0,2^{31})$ for the parts you do not know, otherwise it may cause unpredictable errors.\n\n### Source\n\n[Lost House 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T5.\n\nProblem setter: CYJian.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 幽灵乐团 / 莫比乌斯反演基础练习题", "background": "白玉楼中，冥界的音乐会开始了。\n\nLunasa，Lyrica 和 Merlin 正在演奏。", "description": "东风谷 早苗(Kochiya Sanae)非常喜欢幽灵乐团的演奏，她想对她们的演奏评分。\n\n因为幽灵乐团有 $3$ 个人，所以我们可以用 $3$ 个正整数 $A,B,C$ 来表示出乐团演奏的分数，她们的演奏分数可以表示为\n\n$$\\prod_{i=1}^{A}\\prod_{j=1}^{B}\\prod_{k=1}^{C}\\left(\\frac{\\text{lcm}(i,j)}{\\gcd(i,k)}\\right)^{f(type)}$$\n\n因为音乐在不同的部分会有不同的听觉感受，所以 $type$ 会在 $\\{0,1,2\\}$ 中发生变化，其中：\n\n$$\\begin{aligned}\nf(0)&=1 \\cr\nf(1)&=i \\times j \\times k \\cr\nf(2)&=\\gcd(i,j,k)\n\\end{aligned}$$\n\n因为乐团的歌实在太好听了，导致分数特别高，所以她们的分数要对给定的正整数 $p$ 取模。\n\n因为有很多歌曲要演奏，所以早苗给出了 $T$ 组询问。", "inputFormat": "第一行两个正整数 $T$，$p$，含义详见题目描述。\n\n接下来 $T$ 行，每行三个正整数 $A,B,C$ 表示每组询问。", "outputFormat": "$T$ 行，每行三个正整数分别表示 $type=0/1/2$ 的时候给定式子的值。", "hint": "### 数据范围及约定\n\n对于 $10\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 50 $$  \n\n对于 $20\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 100 $$\n\n另有 $10\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 100\\ \\ \\ \\ \\ A=B=C $$  \n\n对于 $60\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 10^3 $$\n\n对于 $100\\%$ 的数据：  \n\n$$ 1\\leq A,B,C\\leq 10^5 \\ \\ \\ \\ 10^7 \\leq p \\leq 1.05\\times 10^9\\ \\ \\ \\ p\\in \\{ prime\\} \\ \\ \\ \\ T =70$$\n\n---\n\n早苗非常善良，就算你不知道所有的正确答案，她也会给你一些分数。 \n \n* 如果你的第一列是正确的，她将会给你这个测试点 $20\\%$ 的分数。\n* 如果你的第二列是正确的，她将会给你这个测试点 $40\\%$ 的分数。\n* 如果你的第三列是正确的，她将会给你这个测试点 $40\\%$ 的分数。  \n\n所以就算你不知道答案是什么，也请你在你不知道的那些地方输出 $[0,2^{31})$ 内的整数，否则可能会造成不可预估的错误。\n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T5\n\n出题人：CYJian \n", "locale": "zh-CN"}}}
{"pid": "P5519", "type": "P", "difficulty": 7, "samples": [["1 1926", "2"], ["23 3", "509581943"], ["1919 810", "252250482"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2019", "洛谷原创", "O2优化", "线性递推", "快速傅里叶变换 FFT", "Lucas 定理"], "title": "[MtOI2019] 埋骨于弘川", "background": "在幻想乡中，冥界的樱花一年又一年地往复开放。\n\n在 Yuyuko 的心中，出现了一棵樱花树，一个与花朵息息相关的序列，和一个伤感的问题。\n\n那些曾经奋斗过的 OIer 们啊，如今又在何方呢？", "description": "在幻想乡，西行寺 幽幽子(Yuyuko)是一个以贪吃著名的亡灵，她拥有操纵死亡的能力。\n\nYuyuko 通过外界的式神——电脑，对OI进行了深刻的研究 ，她发现了一些惊人的事实：\n\n* OIer 们放弃了太多其他同学们拥有的东西，在题海中寻求自己的梦想。  \n\n* 但是 AFO 的 OIer 们，跟死亡又有什么区别呢？他们或许已经失去了自己的梦想……\n\n这时幽幽子发现，天空中飘舞的樱花组成了两个整数 $n$，$k$。于此同时，在樱花树下，出现了一个函数 $f(x,y)$ 的描述：\n\n$$f(x,y) = \\begin{cases} 2 & , x=1 \\\\ 2^x& , 2\\le x \\le 42,y = 0 \\\\ \\prod\\limits_{i=1}^{42} f(x-i,y)^i & , x \\ge 43,y = 0 \\\\ f(x-1,y)f(x,y-1) & , x\\ge 2,y \\ge 1\\end{cases}$$\n\n\n\n幽幽子想让你计算出 $f(n,k) \\bmod 998244353$，她认为这个函数象征着OIer们......", "inputFormat": "两个整数 $n,k$", "outputFormat": "一个正整数 $f(n,k) \\bmod 998244353$", "hint": "【样例 $1$ 解释】\n\n根据定义，$f(1,1926)=2$。\n\n【数据范围与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1 (7 points)：$1\\le n,k \\le 1000$   \nSubtask 2 (11 points)：$1\\le n \\le 10^{18}$，$k=0$   \nSubtask 3 (13 points)：$1\\le n \\le 10^{18}$，$k=1$   \nSubtask 4 (29 points)：$1\\le n \\le 10^{18}$，$0\\le k \\le 1000$   \nSubtask 5 (40 points)：无特殊限制\n\n对于 $100\\%$ 的数据：$1\\le n \\le 10^{18}$，$0\\le k \\le 30000$   \n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T6\n\n出题人：NaCly_Fish \n\n验题人：Imagine \n\n题面：disangan233\n\n**此题稍有卡常，请注意优化代码常数。**", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Buried Bones in Hongchuan.", "background": "In Gensokyo, the cherry blossoms of the Netherworld bloom again and again, repeating year after year.\n\nIn Yuyuko’s heart, there appeared a cherry tree, a sequence closely tied to blossoms, and a sad question.\n\nThose OIers who once struggled—where are they now?", "description": "In Gensokyo, Saigyouji Yuyuko (Yuyuko) is a ghost famous for being a big eater, and she has the power to control death.\n\nThrough an external shikigami from the outside world—a computer—Yuyuko conducted deep research on OI, and discovered some shocking facts:\n\n* OIers gave up too many things that other classmates had, searching for their dreams in a sea of problems.\n\n* But for OIers who are AFO, what difference is there from death? Perhaps they have already lost their dreams...\n\nAt this moment, Yuyuko found that the cherry blossoms dancing in the sky formed two integers $n$, $k$. Meanwhile, under the cherry tree, a description of a function $f(x,y)$ appeared:\n\n$$f(x,y) = \\begin{cases} 2 & , x=1 \\\\ 2^x& , 2\\le x \\le 42,y = 0 \\\\ \\prod\\limits_{i=1}^{42} f(x-i,y)^i & , x \\ge 43,y = 0 \\\\ f(x-1,y)f(x,y-1) & , x\\ge 2,y \\ge 1\\end{cases}$$\n\nYuyuko wants you to compute $f(n,k) \\bmod 998244353$. She believes this function symbolizes OIers...", "inputFormat": "Two integers $n,k$.", "outputFormat": "A positive integer $f(n,k) \\bmod 998244353$.", "hint": "[Sample $1$ Explanation]\n\nAccording to the definition, $f(1,1926)=2$.\n\n[Constraints and Notes]\n\n**This problem uses bundled testdata.**\n\nSubtask 1 (7 points): $1\\le n,k \\le 1000$  \nSubtask 2 (11 points): $1\\le n \\le 10^{18}$, $k=0$  \nSubtask 3 (13 points): $1\\le n \\le 10^{18}$, $k=1$  \nSubtask 4 (29 points): $1\\le n \\le 10^{18}$, $0\\le k \\le 1000$  \nSubtask 5 (40 points): No special restrictions.\n\nFor $100\\%$ of the testdata: $1\\le n \\le 10^{18}$, $0\\le k \\le 30000$.\n\n### Source\n\n[Lost Home 2019 League](https://www.luogu.org/contest/20135) (MtOI2019) T6.\n\nProblem setter: NaCly_Fish.\n\nProblem reviewer: Imagine.\n\nStatement: disangan233.\n\n**This problem is slightly strict on time limits, so please optimize constant factors in your code.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 埋骨于弘川", "background": "在幻想乡中，冥界的樱花一年又一年地往复开放。\n\n在 Yuyuko 的心中，出现了一棵樱花树，一个与花朵息息相关的序列，和一个伤感的问题。\n\n那些曾经奋斗过的 OIer 们啊，如今又在何方呢？", "description": "在幻想乡，西行寺 幽幽子(Yuyuko)是一个以贪吃著名的亡灵，她拥有操纵死亡的能力。\n\nYuyuko 通过外界的式神——电脑，对OI进行了深刻的研究 ，她发现了一些惊人的事实：\n\n* OIer 们放弃了太多其他同学们拥有的东西，在题海中寻求自己的梦想。  \n\n* 但是 AFO 的 OIer 们，跟死亡又有什么区别呢？他们或许已经失去了自己的梦想……\n\n这时幽幽子发现，天空中飘舞的樱花组成了两个整数 $n$，$k$。于此同时，在樱花树下，出现了一个函数 $f(x,y)$ 的描述：\n\n$$f(x,y) = \\begin{cases} 2 & , x=1 \\\\ 2^x& , 2\\le x \\le 42,y = 0 \\\\ \\prod\\limits_{i=1}^{42} f(x-i,y)^i & , x \\ge 43,y = 0 \\\\ f(x-1,y)f(x,y-1) & , x\\ge 2,y \\ge 1\\end{cases}$$\n\n\n\n幽幽子想让你计算出 $f(n,k) \\bmod 998244353$，她认为这个函数象征着OIer们......", "inputFormat": "两个整数 $n,k$", "outputFormat": "一个正整数 $f(n,k) \\bmod 998244353$", "hint": "【样例 $1$ 解释】\n\n根据定义，$f(1,1926)=2$。\n\n【数据范围与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1 (7 points)：$1\\le n,k \\le 1000$   \nSubtask 2 (11 points)：$1\\le n \\le 10^{18}$，$k=0$   \nSubtask 3 (13 points)：$1\\le n \\le 10^{18}$，$k=1$   \nSubtask 4 (29 points)：$1\\le n \\le 10^{18}$，$0\\le k \\le 1000$   \nSubtask 5 (40 points)：无特殊限制\n\n对于 $100\\%$ 的数据：$1\\le n \\le 10^{18}$，$0\\le k \\le 30000$   \n\n### 题目来源\n\n[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T6\n\n出题人：NaCly_Fish \n\n验题人：Imagine \n\n题面：disangan233\n\n**此题稍有卡常，请注意优化代码常数。**", "locale": "zh-CN"}}}
{"pid": "P5520", "type": "P", "difficulty": 3, "samples": [["1 3 2 19260718", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "2019", "O2优化", "组合数学", "排列组合"], "title": "[yLOI2019] 青原樱", "background": "> 星川之下皆萤火尘埃，  \n> 我独行在人潮你天真而待。  \n> 相遇若是借丹青着色，  \n> 青原上 绯樱如海。\n\n——银临《青原樱》(Cover 人衣大人)", "description": "扶苏是一个非常喜欢边听古风鸽边写数学题的人，因此这道题其实是个五三原题。\n\n扶苏希望重现青原上樱花盛开的景色，于是他准备了很多**互不相同**樱花树幼苗，准备种成一行。\n\n这一行中，一共有 $n$ 个位置可以种下樱花，而扶苏准备了 $m$ 支幼苗。由于樱花盛放时对左右空间需求非常大，所以樱花不能紧挨着种植，也就是任意两支幼苗之间必须至少存在一个不种花的空位置。\n\n按照这种方式种花并不难，但是令扶苏感到好奇的是一共有多少合法的方案让他把这 $m$ 支幼苗都种下去。一个方案是合法的当且仅当他满足上一段中叙述的要求。如果我们将花按照 $1,2,3,\\dots,m$ 编号，两种方案不同当且仅当被选择种花的位置不同或从左向右数花的编号序列不同。\n\n为了避免输出过大，答案对一个参数 $p$ 取模。", "inputFormat": "每个输入文件中有且仅有一组测试数据。\n\n测试数据只有一行四个整数，依次代表 $type,~n,~m,~p$，其中 $type$ 是一个帮助你判断测试点类型的参数，会在数据范围中说明。 ", "outputFormat": "输出一行一个整数，代表答案对 $p$ 取模的结果。\n", "hint": "#### 样例输入输出 1 解释\n一共有 $2$ 个樱花幼苗， $3$ 个种花的位置，如果给幼苗编号为 $1,~2$，位置编号为 $1,~2,~3$，那么两种方案分别如下：\n\n| 位置 | $1$ | $2$ | $3$ |\n| :---: | :---: | :---: | :---: |\n| 方案 1 | 幼苗 $1$ | 空 | 幼苗 $2$ |\n| 方案 2 | 幼苗 $2$ | 空 | 幼苗 $1$ |\n\n---\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 6 个子任务**。\n\n| 子任务编号 | $n \\leq$ | $m \\leq$ | $type=$ | 特殊性质 | 子任务分值 |\n| :----------: | :--------: | :----------: | :-------: | :--------: | :-----------: |\n| 1 | $1$ | $1$ | $0$ | 特殊性质 1 | $5$ |\n| 2 | $20$ | $20$ | $1$ | 特殊性质 1 | $15$ |\n| 3 | $400$ | $200$ | $2$ | 无 | $20$ |\n| 4 | $2000$ | $2000$ | $3$ | 无 | $20$ |\n| 5 | $2000000$ | $1000000$ | $4$| 特殊性质 2 | $20$ | \n| 6 | $2000000$ | $1000000$ | $5$| 无 | $20$ | \n\n特殊性质 1：保证对应测试点的**实际**方案数(在取模前)不超过 $10^6$\n\n特殊性质 2：保证 $p$ 是一个质数。\n\n对于 $100\\%$ 的数据，保证：\n- $1 \\leq n \\leq 2 \\times 10^6$。\n- $1 \\leq m \\leq 10^6 $。\n- $1 \\leq p \\leq 10^9$。\n- $1 \\leq m \\leq \\lceil\\frac{n}{2} \\rceil$。\n\n---\n\n#### 提示\n\n- 请使用合适的数据类型来进行运算，避免溢出。\n- 参数 $type$ 可以帮助你快速的判断子任务编号。\n", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2019] Qingyuan Sakura.", "background": "> Under the star river, all is firefly dust,  \n> I walk alone in the crowd while you wait, innocent.  \n> If meeting is borrowing colors from paintings,  \n> On Qingyuan, crimson sakura is like a sea.  \n>\n> — Yin Lin, \"Qingyuan Sakura\" (Cover: Renyi Daren).", "description": "Fusu really likes writing math problems while listening to ancient-style music, so this problem is actually an original question from *Wusan*.\n\nFusu wants to recreate the scenery of sakura blooming on Qingyuan, so he prepared many **pairwise distinct** sakura saplings and plans to plant them in a single row.\n\nIn this row, there are $n$ positions where sakura can be planted, and Fusu prepared $m$ saplings. Because sakura needs a lot of space on both sides when in full bloom, sakura cannot be planted next to each other. That is, between any two saplings, there must be at least one empty position where no flower is planted.\n\nPlanting in this way is not hard, but what Fusu is curious about is: how many valid plans are there to plant all $m$ saplings? A plan is valid if and only if it satisfies the requirement described in the previous paragraph. If we number the saplings as $1,2,3,\\dots,m$, then two plans are different if and only if the chosen planting positions are different, or the sequence of sapling numbers from left to right is different.\n\nTo avoid overly large output, take the answer modulo a parameter $p$.", "inputFormat": "Each input file contains exactly one set of testdata.\n\nThe testdata consists of one line with four integers, in order $type,~n,~m,~p$, where $type$ is a parameter that helps you determine the test point type, as described in the Constraints.", "outputFormat": "Output one line containing one integer, which is the answer modulo $p$.", "hint": "#### Explanation of Sample Input/Output 1\n\nThere are $2$ sakura saplings and $3$ planting positions. If the saplings are numbered $1,~2$ and the positions are numbered $1,~2,~3$, then the two plans are as follows:\n\n| Position | $1$ | $2$ | $3$ |\n| :---: | :---: | :---: | :---: |\n| Plan 1 | Sapling $1$ | Empty | Sapling $2$ |\n| Plan 2 | Sapling $2$ | Empty | Sapling $1$ |\n\n---\n\n#### Constraints and Agreements\n\n**This problem uses bundled testing with 6 subtasks in total**.\n\n| Subtask ID | $n \\leq$ | $m \\leq$ | $type=$ | Special Property | Subtask Score |\n| :----------: | :--------: | :----------: | :-------: | :--------: | :-----------: |\n| 1 | $1$ | $1$ | $0$ | Special Property 1 | $5$ |\n| 2 | $20$ | $20$ | $1$ | Special Property 1 | $15$ |\n| 3 | $400$ | $200$ | $2$ | None | $20$ |\n| 4 | $2000$ | $2000$ | $3$ | None | $20$ |\n| 5 | $2000000$ | $1000000$ | $4$ | Special Property 2 | $20$ |\n| 6 | $2000000$ | $1000000$ | $5$ | None | $20$ |\n\nSpecial Property 1: It is guaranteed that the **actual** number of plans for the corresponding test points (before taking modulo) does not exceed $10^6$.\n\nSpecial Property 2: It is guaranteed that $p$ is a prime.\n\nFor $100\\%$ of the data, it is guaranteed that:\n- $1 \\leq n \\leq 2 \\times 10^6$.\n- $1 \\leq m \\leq 10^6$.\n- $1 \\leq p \\leq 10^9$.\n- $1 \\leq m \\leq \\lceil\\frac{n}{2} \\rceil$.\n\n---\n\n#### Notes\n\n- Please use appropriate data types for computations to avoid overflow.\n- The parameter $type$ can help you quickly determine the subtask ID.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2019] 青原樱", "background": "> 星川之下皆萤火尘埃，  \n> 我独行在人潮你天真而待。  \n> 相遇若是借丹青着色，  \n> 青原上 绯樱如海。\n\n——银临《青原樱》(Cover 人衣大人)", "description": "扶苏是一个非常喜欢边听古风鸽边写数学题的人，因此这道题其实是个五三原题。\n\n扶苏希望重现青原上樱花盛开的景色，于是他准备了很多**互不相同**樱花树幼苗，准备种成一行。\n\n这一行中，一共有 $n$ 个位置可以种下樱花，而扶苏准备了 $m$ 支幼苗。由于樱花盛放时对左右空间需求非常大，所以樱花不能紧挨着种植，也就是任意两支幼苗之间必须至少存在一个不种花的空位置。\n\n按照这种方式种花并不难，但是令扶苏感到好奇的是一共有多少合法的方案让他把这 $m$ 支幼苗都种下去。一个方案是合法的当且仅当他满足上一段中叙述的要求。如果我们将花按照 $1,2,3,\\dots,m$ 编号，两种方案不同当且仅当被选择种花的位置不同或从左向右数花的编号序列不同。\n\n为了避免输出过大，答案对一个参数 $p$ 取模。", "inputFormat": "每个输入文件中有且仅有一组测试数据。\n\n测试数据只有一行四个整数，依次代表 $type,~n,~m,~p$，其中 $type$ 是一个帮助你判断测试点类型的参数，会在数据范围中说明。 ", "outputFormat": "输出一行一个整数，代表答案对 $p$ 取模的结果。\n", "hint": "#### 样例输入输出 1 解释\n一共有 $2$ 个樱花幼苗， $3$ 个种花的位置，如果给幼苗编号为 $1,~2$，位置编号为 $1,~2,~3$，那么两种方案分别如下：\n\n| 位置 | $1$ | $2$ | $3$ |\n| :---: | :---: | :---: | :---: |\n| 方案 1 | 幼苗 $1$ | 空 | 幼苗 $2$ |\n| 方案 2 | 幼苗 $2$ | 空 | 幼苗 $1$ |\n\n---\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 6 个子任务**。\n\n| 子任务编号 | $n \\leq$ | $m \\leq$ | $type=$ | 特殊性质 | 子任务分值 |\n| :----------: | :--------: | :----------: | :-------: | :--------: | :-----------: |\n| 1 | $1$ | $1$ | $0$ | 特殊性质 1 | $5$ |\n| 2 | $20$ | $20$ | $1$ | 特殊性质 1 | $15$ |\n| 3 | $400$ | $200$ | $2$ | 无 | $20$ |\n| 4 | $2000$ | $2000$ | $3$ | 无 | $20$ |\n| 5 | $2000000$ | $1000000$ | $4$| 特殊性质 2 | $20$ | \n| 6 | $2000000$ | $1000000$ | $5$| 无 | $20$ | \n\n特殊性质 1：保证对应测试点的**实际**方案数(在取模前)不超过 $10^6$\n\n特殊性质 2：保证 $p$ 是一个质数。\n\n对于 $100\\%$ 的数据，保证：\n- $1 \\leq n \\leq 2 \\times 10^6$。\n- $1 \\leq m \\leq 10^6 $。\n- $1 \\leq p \\leq 10^9$。\n- $1 \\leq m \\leq \\lceil\\frac{n}{2} \\rceil$。\n\n---\n\n#### 提示\n\n- 请使用合适的数据类型来进行运算，避免溢出。\n- 参数 $type$ 可以帮助你快速的判断子任务编号。\n", "locale": "zh-CN"}}}
{"pid": "P5521", "type": "P", "difficulty": 5, "samples": [["3 \n1 2 \n1 1 1", "2 2 1"], ["3\n1 1\n1 1 1", "3 1 1"], ["6\n1 1 2 3 4\n3 14 1 5 12 15", "21 20 13 20 12 15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2019", "O2优化", "排序", "深度优先搜索 DFS", "树形 DP"], "title": "[yLOI2019] 梅深不见冬", "background": "> 风，吹起梅岭的深冬；霜，如惊涛一样汹涌；  \n> 雪，飘落后把所有烧成空，像这场，捕捉不到的梦。   \n> 醒来时已是多年之久，宫门铜环才长了铁锈，也开始生出离愁。\n\n——银临《梅深不见冬》", "description": "扶苏从深冬的梅岭走出，来到了一棵有 $n$ 个节点的有根树上。\n\n如果你不知道什么是树，可以认为树是一个边数恰好比节点个数少一的简单无向连通图。\n\n如果我们规定 $x$ 是树 $T$ 的根，那么定义任意一个节点 $y$ 到根的路径就是从 $y$ 出发不重复经过节点到达 $x$ 所经过的所经过的点构成的点集。可以证明这样的点集有且仅有一个。\n\n定义一个节点 $u$ 是节点 $v$ 的孩子，当且仅当 $u$ 与 $v$ 相连且 $u$ 不在 $v$ 到根的路径中。如果 $u$ 是 $v$ 的孩子，那么定义 $v$ 是 $u$ 的家长节点。\n\n如果我是 @[\\_rqy](https://www.luogu.org/space/show?uid=7868) 那种~~毒瘤~~神仙的话，可能会问你每个节点的孩子数不超过 $k$ 的 $n$ 个节点的带标号无根树一共有多少个，可惜这个问题我也不会，所以我不会问你这么毒瘤的问题。\n\n扶苏从这棵 $n$ 个节点的树的 $1$ 号节点出发，沿着树上的边行走。当然我们规定 $1$ 号节点是这棵树的根。他所行走的规定是：当扶苏在节点 $u$ 时，扶苏要么在 $u$ 的孩子中选择一个**没有到达过**的节点 $v$ 并行走到 $v$，要么选择回到 $u$ 的家长节点。\n\n现在给每个节点一个权值 $w$，其中 $i$ 号节点的权值为 $w_i$。他想给这棵树的某个节点放上从梅岭带出的梅花。我们规定扶苏能在节点 $u$ 放上梅花当且仅当满足如下条件：\n\n> 扶苏当前在节点 $u$。\n>\n> 对于 $u$ 的所有孩子 $v$，节点 $v$ 被放上了 $w_v$ 朵梅花。\n\n同时，扶苏可以在**任意时刻**收回**任意节点**上的梅花，在收回梅花时不需要走到对应节点。\n\n现在扶苏想问问你，对于每个节点，如果他想在 $i$ 号节点上放 $w_i$ 朵梅花，那么他最少要从梅岭带出多少朵梅花。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n数据的第一行是一个整数 $n$ 代表树的节点个数。\n\n第二行有 $n-1$ 个用空格隔开的整数，第 $i$ 个整数 $p_i$ 代表第 $i+1$ 号节点的家长节点编号。\n\n第三行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表 $w_i$。", "outputFormat": "输出一行 $n$ 个用空格隔开的整数，第 $i$ 个整数代表想在 $i$ 号节点上放 $w_i$ 朵梅花需要准备的梅花个数。", "hint": "#### 输入输出样例 1 解释\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72286.png)\n\n样例 1 的输入如上图，每个节点都需要放一朵梅花。\n\n如果在 1 号节点放梅花，则从 1 号点运动到 2 号点，然后运动到 3 号点，在 3 号点上放一朵梅花，返回 2 号点，在 2 号点上放一朵梅花，同时收回 3 号点的梅花，然后返回 1 号点，将从 3 号点收回的梅花放到 1 号点即可。一共需要两朵梅花。\n\n在 2、3 号节点放梅花的方案类似。\n\n#### 输入输出样例 3 解释\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72287.png)\n\n样例 3 的输入如左图。\n\n先从 1 号节点运动至 3 号节点，再运动至 5 号节点，在 5 号节点上放置 $12$ 朵梅花，然后返回 3 号节点，在 3 号节点上放置 $1$ 朵梅花，收回五号节点的 $12$ 朵梅花，返回 1 号节点。\n\n然后运动到 2 号节点，通过 4 号节点运动到 6 号节点，放下 $15$ 朵梅花，返回 4 号节点放下 $5$ 朵梅花，此时树上有的梅花数为 $5 + 15 + 1 = 21$，分别在 4 号、6 号和 3 号节点上。然后收回 6 号节点的梅花，返回 2 号节点，放下 $14$ 朵梅花，收回 4 号节点的，返回 1 号节点，在 1 号节点上放置 $3$ 朵梅花，即可达到在 1 号节点上放梅花的目的。\n\n可以验证最小花费为 $21$。其他节点的答案同理。\n\n请注意，其他节点的答案不一定是按照该节点的运动路径行走得到的。\n\n---\n\n#### 数据规模与约定\n\n| 测试点编号 |  $n = $  | 测试点编号 |  $n = $  |\n| :--------: | :------: | :--------: | :------: |\n|     1      |   $1$    |     11     | $100003$ |\n|     2      |   $8$    |     12     | $100003$ |\n|     3      |   $8$    |     13     | $100003$ |\n|     4      |   $8$    |     14     | $100003$ |\n|     5      |   $8$    |     15     | $100004$ |\n|     6      | $100000$ |     16     | $100004$ |\n|     7      | $100000$ |     17     | $100004$ |\n|     8      | $100002$ |     18     | $100004$ |\n|     9      | $100002$ |     19     | $100004$ |\n|     10     | $100002$ |     20     | $100004$ |\n\n- 对于测试点 5、6，满足特殊性质：每个节点的孩子结点个数不超过 $2$。\n- 对于测试点 8 到测试点 10，满足特殊性质：每个节点的孩子节点个数不超过 $5$。\n- 对于测试点 11 到测试点 14，满足特殊性质：任意一个节点到根的路径上的点数不超过 $3$，也即树高不超过 $3$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5 + 4,~1 \\leq p_i \\leq i,~1 \\leq w_i \\leq 1000$。\n\n---\n\n#### 提示\n\n- $n$ 的末位数字可以帮助你快速的判断测试点所具有的的特殊性质。", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2019] Deep in the Plum Forest, Winter Is Nowhere to Be Seen", "background": "> The wind blows up the deep winter of Meiling; the frost surges like raging waves;  \n> The snow falls and burns everything into emptiness, like this dream that cannot be caught.  \n> When I wake up, many years have passed; the bronze rings on the palace gates have grown rusty, and sorrow begins to grow as well.  \n\n— Yin Lin, *Deep in the Plum Forest, Winter Is Nowhere to Be Seen*.", "description": "Fu Su walks out of the deep winter Meiling and arrives at a rooted tree with $n$ nodes.\n\nIf you do not know what a tree is, you may think of it as a simple undirected connected graph whose number of edges is exactly one less than the number of nodes.\n\nIf we specify that $x$ is the root of a tree $T$, then for any node $y$, the path from $y$ to the root is defined as the set of nodes passed through when starting from $y$ and reaching $x$ without visiting any node twice. It can be proven that such a set is unique.\n\nA node $u$ is a child of node $v$ if and only if $u$ is connected to $v$ and $u$ is not on the path from $v$ to the root. If $u$ is a child of $v$, then $v$ is the parent node of $u$.\n\nIf I were a ~~toxic~~ genius like @[\\_rqy](https://www.luogu.org/space/show?uid=7868), I might ask you how many labeled unrooted trees with $n$ nodes exist such that every node has at most $k$ children. Unfortunately I cannot solve that either, so I will not ask such a painful question.\n\nFu Su starts from node $1$ of this $n$-node tree and walks along the edges. We define node $1$ as the root of the tree. His movement rule is: when Fu Su is at node $u$, he either chooses a node $v$ among the children of $u$ that he has **not visited** and moves to $v$, or he chooses to return to the parent node of $u$.\n\nNow each node has a weight $w$, where the weight of node $i$ is $w_i$. He wants to place plum blossoms brought from Meiling onto some node of the tree. We say Fu Su can place plum blossoms on node $u$ if and only if the following conditions are satisfied:\n\n> Fu Su is currently at node $u$.\n>\n> For every child $v$ of $u$, node $v$ has been placed with $w_v$ plum blossoms.\n\nMeanwhile, Fu Su can take back the plum blossoms on **any node** at **any time**, and he does not need to walk to that node when taking them back.\n\nNow Fu Su asks you: for each node, if he wants to place $w_i$ plum blossoms on node $i$, what is the minimum number of plum blossoms he needs to bring out from Meiling?", "inputFormat": "Each input file contains one and only one set of testdata.\n\nThe first line contains an integer $n$, the number of nodes in the tree.\n\nThe second line contains $n - 1$ integers separated by spaces. The $i$-th integer $p_i$ denotes the index of the parent of node $i + 1$.\n\nThe third line contains $n$ integers separated by spaces. The $i$-th integer denotes $w_i$.", "outputFormat": "Output one line with $n$ integers separated by spaces. The $i$-th integer denotes the number of plum blossoms that need to be prepared to place $w_i$ plum blossoms on node $i$.", "hint": "#### Explanation for Sample Input/Output 1\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72286.png)\n\nThe input of Sample 1 is shown in the figure above. Every node needs to be placed with one plum blossom.\n\nIf we place plum blossoms on node $1$, we move from node $1$ to node $2$, then to node $3$, place one plum blossom on node $3$, return to node $2$, place one plum blossom on node $2$, and at the same time take back the plum blossom on node $3$. Then return to node $1$, and place the plum blossom taken back from node $3$ onto node $1$. In total, we need two plum blossoms.\n\nThe plans for placing plum blossoms on nodes $2$ and $3$ are similar.\n\n#### Explanation for Sample Input/Output 3\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72287.png)\n\nThe input of Sample 3 is shown in the left figure.\n\nFirst move from node $1$ to node $3$, then to node $5$, place $12$ plum blossoms on node $5$, then return to node $3$, place $1$ plum blossom on node $3$, take back the $12$ plum blossoms on node $5$, and return to node $1$.\n\nThen move to node $2$, and move through node $4$ to node $6$, place $15$ plum blossoms, return to node $4$ and place $5$ plum blossoms. At this moment, the number of plum blossoms on the tree is $5 + 15 + 1 = 21$, located at nodes $4$, $6$, and $3$. Then take back the plum blossoms on node $6$, return to node $2$, place $14$ plum blossoms, take back the blossoms on node $4$, return to node $1$, and place $3$ plum blossoms on node $1$, thus achieving the goal of placing plum blossoms on node $1$.\n\nIt can be verified that the minimum cost is $21$. The answers for other nodes are similar.\n\nPlease note that the answers for other nodes are not necessarily obtained by walking along the movement path of that node.\n\n---\n\n#### Constraints and Agreements\n\n| Test Point ID |  $n = $  | Test Point ID |  $n = $  |\n| :----------: | :------: | :----------: | :------: |\n|      1       |   $1$    |      11      | $100003$ |\n|      2       |   $8$    |      12      | $100003$ |\n|      3       |   $8$    |      13      | $100003$ |\n|      4       |   $8$    |      14      | $100003$ |\n|      5       |   $8$    |      15      | $100004$ |\n|      6       | $100000$ |      16      | $100004$ |\n|      7       | $100000$ |      17      | $100004$ |\n|      8       | $100002$ |      18      | $100004$ |\n|      9       | $100002$ |      19      | $100004$ |\n|      10      | $100002$ |      20      | $100004$ |\n\n- For test points 5 and 6, a special property holds: each node has at most $2$ child nodes.\n- For test points 8 to 10, a special property holds: each node has at most $5$ child nodes.\n- For test points 11 to 14, a special property holds: the number of nodes on the path from any node to the root is at most $3$, i.e. the height of the tree is at most $3$.\n- For $100\\%$ of the data, it is guaranteed that $1 \\leq n \\leq 10^5 + 4,~1 \\leq p_i \\leq i,~1 \\leq w_i \\leq 1000$.\n\n---\n\n#### Hint\n\n- The last digit of $n$ can help you quickly determine the special property of the test point.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2019] 梅深不见冬", "background": "> 风，吹起梅岭的深冬；霜，如惊涛一样汹涌；  \n> 雪，飘落后把所有烧成空，像这场，捕捉不到的梦。   \n> 醒来时已是多年之久，宫门铜环才长了铁锈，也开始生出离愁。\n\n——银临《梅深不见冬》", "description": "扶苏从深冬的梅岭走出，来到了一棵有 $n$ 个节点的有根树上。\n\n如果你不知道什么是树，可以认为树是一个边数恰好比节点个数少一的简单无向连通图。\n\n如果我们规定 $x$ 是树 $T$ 的根，那么定义任意一个节点 $y$ 到根的路径就是从 $y$ 出发不重复经过节点到达 $x$ 所经过的所经过的点构成的点集。可以证明这样的点集有且仅有一个。\n\n定义一个节点 $u$ 是节点 $v$ 的孩子，当且仅当 $u$ 与 $v$ 相连且 $u$ 不在 $v$ 到根的路径中。如果 $u$ 是 $v$ 的孩子，那么定义 $v$ 是 $u$ 的家长节点。\n\n如果我是 @[\\_rqy](https://www.luogu.org/space/show?uid=7868) 那种~~毒瘤~~神仙的话，可能会问你每个节点的孩子数不超过 $k$ 的 $n$ 个节点的带标号无根树一共有多少个，可惜这个问题我也不会，所以我不会问你这么毒瘤的问题。\n\n扶苏从这棵 $n$ 个节点的树的 $1$ 号节点出发，沿着树上的边行走。当然我们规定 $1$ 号节点是这棵树的根。他所行走的规定是：当扶苏在节点 $u$ 时，扶苏要么在 $u$ 的孩子中选择一个**没有到达过**的节点 $v$ 并行走到 $v$，要么选择回到 $u$ 的家长节点。\n\n现在给每个节点一个权值 $w$，其中 $i$ 号节点的权值为 $w_i$。他想给这棵树的某个节点放上从梅岭带出的梅花。我们规定扶苏能在节点 $u$ 放上梅花当且仅当满足如下条件：\n\n> 扶苏当前在节点 $u$。\n>\n> 对于 $u$ 的所有孩子 $v$，节点 $v$ 被放上了 $w_v$ 朵梅花。\n\n同时，扶苏可以在**任意时刻**收回**任意节点**上的梅花，在收回梅花时不需要走到对应节点。\n\n现在扶苏想问问你，对于每个节点，如果他想在 $i$ 号节点上放 $w_i$ 朵梅花，那么他最少要从梅岭带出多少朵梅花。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n数据的第一行是一个整数 $n$ 代表树的节点个数。\n\n第二行有 $n-1$ 个用空格隔开的整数，第 $i$ 个整数 $p_i$ 代表第 $i+1$ 号节点的家长节点编号。\n\n第三行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表 $w_i$。", "outputFormat": "输出一行 $n$ 个用空格隔开的整数，第 $i$ 个整数代表想在 $i$ 号节点上放 $w_i$ 朵梅花需要准备的梅花个数。", "hint": "#### 输入输出样例 1 解释\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72286.png)\n\n样例 1 的输入如上图，每个节点都需要放一朵梅花。\n\n如果在 1 号节点放梅花，则从 1 号点运动到 2 号点，然后运动到 3 号点，在 3 号点上放一朵梅花，返回 2 号点，在 2 号点上放一朵梅花，同时收回 3 号点的梅花，然后返回 1 号点，将从 3 号点收回的梅花放到 1 号点即可。一共需要两朵梅花。\n\n在 2、3 号节点放梅花的方案类似。\n\n#### 输入输出样例 3 解释\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/72287.png)\n\n样例 3 的输入如左图。\n\n先从 1 号节点运动至 3 号节点，再运动至 5 号节点，在 5 号节点上放置 $12$ 朵梅花，然后返回 3 号节点，在 3 号节点上放置 $1$ 朵梅花，收回五号节点的 $12$ 朵梅花，返回 1 号节点。\n\n然后运动到 2 号节点，通过 4 号节点运动到 6 号节点，放下 $15$ 朵梅花，返回 4 号节点放下 $5$ 朵梅花，此时树上有的梅花数为 $5 + 15 + 1 = 21$，分别在 4 号、6 号和 3 号节点上。然后收回 6 号节点的梅花，返回 2 号节点，放下 $14$ 朵梅花，收回 4 号节点的，返回 1 号节点，在 1 号节点上放置 $3$ 朵梅花，即可达到在 1 号节点上放梅花的目的。\n\n可以验证最小花费为 $21$。其他节点的答案同理。\n\n请注意，其他节点的答案不一定是按照该节点的运动路径行走得到的。\n\n---\n\n#### 数据规模与约定\n\n| 测试点编号 |  $n = $  | 测试点编号 |  $n = $  |\n| :--------: | :------: | :--------: | :------: |\n|     1      |   $1$    |     11     | $100003$ |\n|     2      |   $8$    |     12     | $100003$ |\n|     3      |   $8$    |     13     | $100003$ |\n|     4      |   $8$    |     14     | $100003$ |\n|     5      |   $8$    |     15     | $100004$ |\n|     6      | $100000$ |     16     | $100004$ |\n|     7      | $100000$ |     17     | $100004$ |\n|     8      | $100002$ |     18     | $100004$ |\n|     9      | $100002$ |     19     | $100004$ |\n|     10     | $100002$ |     20     | $100004$ |\n\n- 对于测试点 5、6，满足特殊性质：每个节点的孩子结点个数不超过 $2$。\n- 对于测试点 8 到测试点 10，满足特殊性质：每个节点的孩子节点个数不超过 $5$。\n- 对于测试点 11 到测试点 14，满足特殊性质：任意一个节点到根的路径上的点数不超过 $3$，也即树高不超过 $3$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5 + 4,~1 \\leq p_i \\leq i,~1 \\leq w_i \\leq 1000$。\n\n---\n\n#### 提示\n\n- $n$ 的末位数字可以帮助你快速的判断测试点所具有的的特殊性质。", "locale": "zh-CN"}}}
{"pid": "P5522", "type": "P", "difficulty": 5, "samples": [["3 3 5\n010\n0?0\n1?0\n0 1 2\n0 2 3\n1 3 0??\n0 2 3\n0 1 3", "2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2019", "线段树", "树状数组", "O2优化", "位运算", "状压 DP"], "title": "[yLOI2019] 棠梨煎雪", "background": "> 岁岁花藻檐下共将棠梨煎雪，  \n> 自总角至你我某日辗转天边。  \n> 天淡天青，宿雨沾襟，  \n> 一年一会信笺却只见寥寥数言。\n\n——银临《棠梨煎雪》", "description": "扶苏正在听《棠梨煎雪》的时候，@[spitfirekindergarten](https://www.luogu.org/space/show?uid=61795) 发来一道 [IOI2018 集训队作业题](http://uoj.ac/problem/425)：我切了这集训队题，辣鸡扶苏快过来做题。扶苏定睛一看，这不 s\\* 题嘛，写了一发交上去才发现自己看错题目了。但是写完的代码不能浪费，于是就有了这道题。\n\n歌词中的主人公与她的朋友一年会有一次互相写信给对方，一共通信了 $m$ 年。为了简化问题，我们认为她们每封信的内容都是一条二进制码，并且所有二进制码的长度都是 $n$。即每封信的内容都是一个长度为 $n$ 的字符串，这个字符串只含字符 ``0`` 或 ``1``。\n\n这天她拿出了朋友写给她的所有信件，其中第 $i$ 年的写的信件编号为 $i$。由于信件保存时间过久，上面有一些字符已经模糊不清，我们将这样的位置记为 ``?``，``?`` 字符可以被解释为 ``0`` 或 ``1``。由于她的朋友也是人，符合人类的本质，所以朋友在一段连续的时间中书写的内容可能是相同的。现在她想问问你，对于一段连续的年份区间 $[l,r]$ 中的所有信件，假如朋友在这段时间展示了人类的本质，所写的是同一句话，那么这一句话一共有多少种可能的组成。也即一共有多少字符串 $S$，满足在这个区间内的所有信件的内容都可能是 $S$。\n\n一个长度为 $n$ 的只含 ``0,1,?`` 的字符串 $A$ 可能是一个字符串 $B$ 当且仅当 $B$ 满足如下条件：\n\n- $B$ 的长度也是 $n$ 。\n- $B$ 中只含字符 ``0,1``。\n- $A$ 中所有为 ``0`` 的位置在 $B$ 中也是 ``0``。\n- $A$ 中所有为 ``1`` 的位置在 $B$ 中也是 ``1``。\n- $A$ 中为 ``?`` 的位置在 $B$ 中可以为 ``0`` 也可以是 ``1``。\n\n同时她可能会突然发现看错了某年的信的内容，于是她可能会把某一年的信的内容修改为一个别的只含 ``0``,``1``,``?`` 的长度为 $n$ 的字符串。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n输入数据第一行为三个用空格隔开的整数，分别代表代表字符串长度 $n$，字符串个数 $m$ 和操作次数 $q$。\n\n下面 $m$ 行，每行是一个长度为 $n$ 的字符串，第 $(i + 1)$ 行的字符串 $s_i$ 代表第 $i$ 年信的内容。\n\n下面 $q$ 行，每行的第一个数字是操作编号 $opt$。\n\n- 如果 $opt=0$，那么后面接两个整数 $[l,~r]$，代表一次查询操作。\n- 如果 $opt=1$，那么后面接一个整数 $pos$，在一个空格后会有一个长度为 $n$ 的字符串 $t$，代表将第 $pos$ 个字符串修改为新的字符串 $t$。", "outputFormat": "为了避免输出过大，请你输出一行一个数代表所有查询的答案异或和对 $0$ 取异或的结果。", "hint": "### 样例 1 解释\n\n- 对于第一次询问，只有串 ``010`` 符合要求。\n- 对于第二次询问，由于第二个串的第一位为 ``0``，第三个串的第一位为 ``1``，故没有串符合要求。\n- 修改后将第三个串修改为 ``0??``。\n- 对于第四次询问，有两个串符合要求，分别为 ``000`` 和 ``010``。\n- 对于第五次询问，只有 ``010`` 符合要求。\n\n故答案为 $1,0,2,1$，他们的异或和再异或 $0$ 的值为 $2$。\n\n---\n\n### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 7 个子任务**。\n\n| 子任务编号 |  $m = $  |  $q = $   | $n = $ | 子任务分数 |\n| :--------: | :------: | :-------: | :----: | :--------: |\n|    $1$     |   $1$    |    $0$    |  $1$   |    $5$     |\n|    $2$     |  $102$   |   $102$   |  $10$  |    $10$    |\n|    $3$     |  $1003$  |  $1003$   |  $10$  |    $15$    |\n|    $4$     |  $1004$  |  $10004$  |  $30$  |    $15$    |\n|    $5$     | $100005$ | $500005$  |  $1$   |    $15$    |\n|    $6$     | $100006$ |  $50006$  |  $30$  |    $10$    |\n|    $7$     | $100007$ | $1000007$ |  $30$  |    $30$    |\n\n对于全部的测试点，保证：\n- $1 \\leq m \\leq 10^5 + 7$，$0 \\leq q \\leq 10^6 + 7$，$1 \\leq n \\leq 30$。\n- $0 \\leq opt \\leq 1$，$1 \\leq pos \\leq m$，$1 \\leq l \\leq r \\leq m$。\n- $s_i, t$ 的长度均为 $n$ 且只含有字符 `0`,`1`,`?`。\n- 输入字符串的总长度不超过 $5 \\times 10^6$。数据在 Linux 下生成，即换行符不含 `\\r`。\n\n---\n\n#### 提示\n\n- 请注意常数因子对程序效率造成的影响。\n- 请注意数据读入对程序效率造成的影响。\n- 请注意输入的问号为英文问号，即其 ASCII 值为 $63$。\n\n注: 为减少错误做法的通过率，时限于 2020 年 7 月由 2000ms 改为 1500ms。", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2019] Tangli Jianxue", "background": "> Year after year, under the eaves with flower patterns, we boil snow with tangli,  \n> From childhood to some day when you and I drift to the ends of the sky.  \n> The sky is pale, the sky is blue; the night rain wets my clothes,  \n> Once a year, the letters arrive, yet there are only a few words.\n\n— Yinlin, “Tangli Jianxue”.", "description": "While Fusu was listening to “Tangli Jianxue”, @[spitfirekindergarten](https://www.luogu.org/space/show?uid=61795) sent an [IOI2018 CTT homework problem](http://uoj.ac/problem/425): “I’ve solved this CTT problem, you trash Fusu, come and do it.” Fusu took a closer look—wasn’t this an s\\* problem? He coded and submitted it, only to find he had misread the statement. But the finished code could not be wasted, so this problem was created.\n\nThe protagonist in the lyrics and her friend write letters to each other once a year, for a total of $m$ years. To simplify the problem, we assume that the content of each letter is a binary code, and all binary codes have length $n$. That is, each letter is a string of length $n$ containing only characters `0` or `1`.\n\nOne day she took out all the letters her friend wrote to her. The letter written in year $i$ is numbered $i$. Because the letters have been kept for too long, some characters have become blurred. We mark such positions as `?`. A `?` character can be interpreted as `0` or `1`. Since her friend is also a human and thus follows human nature, the content written during a continuous period of time may be the same. Now she wants to ask you: for all letters in a continuous year interval $[l,r]$, assuming her friend showed “human nature” in this period and wrote the same sentence, how many possible sentences can that sentence be? In other words, how many strings $S$ are there such that every letter in this interval could have content $S$?\n\nA string $A$ of length $n$ containing only `0,1,?` could be a string $B$ if and only if $B$ satisfies:\n\n- The length of $B$ is also $n$.\n- $B$ contains only characters `0,1`.\n- Every position that is `0` in $A$ is also `0` in $B$.\n- Every position that is `1` in $A$ is also `1` in $B$.\n- Every position that is `?` in $A$ can be `0` or `1` in $B$.\n\nShe may also suddenly realize that she misread the content of some year’s letter, so she may modify the content of a certain year’s letter into another length-$n$ string containing only `0`,`1`,`?`.", "inputFormat": "Each input file contains exactly one test case.\n\nThe first line contains three integers separated by spaces, representing the string length $n$, the number of strings $m$, and the number of operations $q$.\n\nThe next $m$ lines each contain a string of length $n$. The string $s_i$ on line $(i + 1)$ represents the content of the letter in year $i$.\n\nThe next $q$ lines describe operations. The first number of each line is the operation code $opt$.\n\n- If $opt=0$, it is followed by two integers $[l,~r]$, representing a query operation.\n- If $opt=1$, it is followed by an integer $pos$, then after a space a string $t$ of length $n$, representing modifying the $pos$-th string to the new string $t$.", "outputFormat": "To avoid an excessively large output, output one line with one number: the XOR of the answers of all queries, and then XOR it with $0$.", "hint": "### Sample 1 Explanation\n\n- For the first query, only the string `010` satisfies the requirement.\n- For the second query, since the first bit of the second string is `0` and the first bit of the third string is `1`, no string satisfies the requirement.\n- After the modification, the third string becomes `0??`.\n- For the fourth query, there are two valid strings: `000` and `010`.\n- For the fifth query, only `010` is valid.\n\nTherefore the answers are $1,0,2,1$. Their XOR, and then XOR with $0$, equals $2$.\n\n---\n\n### Constraints\n\n**This problem uses bundled subtasks, with a total of 7 subtasks**.\n\n| Subtask ID |  $m = $  |  $q = $   | $n = $ | Subtask Score |\n| :--------: | :------: | :-------: | :----: | :-----------: |\n|    $1$     |   $1$    |    $0$    |  $1$   |      $5$      |\n|    $2$     |  $102$   |   $102$   |  $10$  |     $10$      |\n|    $3$     |  $1003$  |  $1003$   |  $10$  |     $15$      |\n|    $4$     |  $1004$  |  $10004$  |  $30$  |     $15$      |\n|    $5$     | $100005$ | $500005$  |  $1$   |     $15$      |\n|    $6$     | $100006$ |  $50006$  |  $30$  |     $10$      |\n|    $7$     | $100007$ | $1000007$ |  $30$  |     $30$      |\n\nFor all testdata, it is guaranteed that:\n\n- $1 \\leq m \\leq 10^5 + 7$, $0 \\leq q \\leq 10^6 + 7$, $1 \\leq n \\leq 30$.\n- $0 \\leq opt \\leq 1$, $1 \\leq pos \\leq m$, $1 \\leq l \\leq r \\leq m$.\n- The lengths of $s_i$ and $t$ are both $n$, and they contain only `0`,`1`,`?`.\n- The total length of input strings does not exceed $5 \\times 10^6$. The data is generated under Linux, so line breaks do not include `\\r`.\n\n---\n\n#### Hint\n\n- Please pay attention to the impact of constant factors on program efficiency.\n- Please pay attention to the impact of input reading on program efficiency.\n- Please note that the question mark in the input is the English question mark, whose ASCII value is $63$.\n\nNote: To reduce the acceptance rate of incorrect solutions, the time limit was changed from 2000 ms to 1500 ms in July 2020.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2019] 棠梨煎雪", "background": "> 岁岁花藻檐下共将棠梨煎雪，  \n> 自总角至你我某日辗转天边。  \n> 天淡天青，宿雨沾襟，  \n> 一年一会信笺却只见寥寥数言。\n\n——银临《棠梨煎雪》", "description": "扶苏正在听《棠梨煎雪》的时候，@[spitfirekindergarten](https://www.luogu.org/space/show?uid=61795) 发来一道 [IOI2018 集训队作业题](http://uoj.ac/problem/425)：我切了这集训队题，辣鸡扶苏快过来做题。扶苏定睛一看，这不 s\\* 题嘛，写了一发交上去才发现自己看错题目了。但是写完的代码不能浪费，于是就有了这道题。\n\n歌词中的主人公与她的朋友一年会有一次互相写信给对方，一共通信了 $m$ 年。为了简化问题，我们认为她们每封信的内容都是一条二进制码，并且所有二进制码的长度都是 $n$。即每封信的内容都是一个长度为 $n$ 的字符串，这个字符串只含字符 ``0`` 或 ``1``。\n\n这天她拿出了朋友写给她的所有信件，其中第 $i$ 年的写的信件编号为 $i$。由于信件保存时间过久，上面有一些字符已经模糊不清，我们将这样的位置记为 ``?``，``?`` 字符可以被解释为 ``0`` 或 ``1``。由于她的朋友也是人，符合人类的本质，所以朋友在一段连续的时间中书写的内容可能是相同的。现在她想问问你，对于一段连续的年份区间 $[l,r]$ 中的所有信件，假如朋友在这段时间展示了人类的本质，所写的是同一句话，那么这一句话一共有多少种可能的组成。也即一共有多少字符串 $S$，满足在这个区间内的所有信件的内容都可能是 $S$。\n\n一个长度为 $n$ 的只含 ``0,1,?`` 的字符串 $A$ 可能是一个字符串 $B$ 当且仅当 $B$ 满足如下条件：\n\n- $B$ 的长度也是 $n$ 。\n- $B$ 中只含字符 ``0,1``。\n- $A$ 中所有为 ``0`` 的位置在 $B$ 中也是 ``0``。\n- $A$ 中所有为 ``1`` 的位置在 $B$ 中也是 ``1``。\n- $A$ 中为 ``?`` 的位置在 $B$ 中可以为 ``0`` 也可以是 ``1``。\n\n同时她可能会突然发现看错了某年的信的内容，于是她可能会把某一年的信的内容修改为一个别的只含 ``0``,``1``,``?`` 的长度为 $n$ 的字符串。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n输入数据第一行为三个用空格隔开的整数，分别代表代表字符串长度 $n$，字符串个数 $m$ 和操作次数 $q$。\n\n下面 $m$ 行，每行是一个长度为 $n$ 的字符串，第 $(i + 1)$ 行的字符串 $s_i$ 代表第 $i$ 年信的内容。\n\n下面 $q$ 行，每行的第一个数字是操作编号 $opt$。\n\n- 如果 $opt=0$，那么后面接两个整数 $[l,~r]$，代表一次查询操作。\n- 如果 $opt=1$，那么后面接一个整数 $pos$，在一个空格后会有一个长度为 $n$ 的字符串 $t$，代表将第 $pos$ 个字符串修改为新的字符串 $t$。", "outputFormat": "为了避免输出过大，请你输出一行一个数代表所有查询的答案异或和对 $0$ 取异或的结果。", "hint": "### 样例 1 解释\n\n- 对于第一次询问，只有串 ``010`` 符合要求。\n- 对于第二次询问，由于第二个串的第一位为 ``0``，第三个串的第一位为 ``1``，故没有串符合要求。\n- 修改后将第三个串修改为 ``0??``。\n- 对于第四次询问，有两个串符合要求，分别为 ``000`` 和 ``010``。\n- 对于第五次询问，只有 ``010`` 符合要求。\n\n故答案为 $1,0,2,1$，他们的异或和再异或 $0$ 的值为 $2$。\n\n---\n\n### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 7 个子任务**。\n\n| 子任务编号 |  $m = $  |  $q = $   | $n = $ | 子任务分数 |\n| :--------: | :------: | :-------: | :----: | :--------: |\n|    $1$     |   $1$    |    $0$    |  $1$   |    $5$     |\n|    $2$     |  $102$   |   $102$   |  $10$  |    $10$    |\n|    $3$     |  $1003$  |  $1003$   |  $10$  |    $15$    |\n|    $4$     |  $1004$  |  $10004$  |  $30$  |    $15$    |\n|    $5$     | $100005$ | $500005$  |  $1$   |    $15$    |\n|    $6$     | $100006$ |  $50006$  |  $30$  |    $10$    |\n|    $7$     | $100007$ | $1000007$ |  $30$  |    $30$    |\n\n对于全部的测试点，保证：\n- $1 \\leq m \\leq 10^5 + 7$，$0 \\leq q \\leq 10^6 + 7$，$1 \\leq n \\leq 30$。\n- $0 \\leq opt \\leq 1$，$1 \\leq pos \\leq m$，$1 \\leq l \\leq r \\leq m$。\n- $s_i, t$ 的长度均为 $n$ 且只含有字符 `0`,`1`,`?`。\n- 输入字符串的总长度不超过 $5 \\times 10^6$。数据在 Linux 下生成，即换行符不含 `\\r`。\n\n---\n\n#### 提示\n\n- 请注意常数因子对程序效率造成的影响。\n- 请注意数据读入对程序效率造成的影响。\n- 请注意输入的问号为英文问号，即其 ASCII 值为 $63$。\n\n注: 为减少错误做法的通过率，时限于 2020 年 7 月由 2000ms 改为 1500ms。", "locale": "zh-CN"}}}
{"pid": "P5523", "type": "P", "difficulty": 6, "samples": [["6\n233 666 250 0", "0 0 0 0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "枚举", "位运算"], "title": "[yLOI2019] 珍珠", "background": "> 别叹息太多告别，至少相遇很真切。  \n> 摇曳着盛放枯竭，时间从未停歇。  \n> 天涯浪迹的白雪，念念不忘山川蝴蝶。  \n> 听说有人孤负黑夜，偏要点亮人间的月。\n\n——银临《珍珠》", "description": "扶苏给了你一个放珍珠的小匣子，这个匣子在左右两端都可以无限制的加入珍珠，珍珠在匣子里会排成一列，每次在左端加入珍珠，这个珍珠会被加入到这个珍珠序列的最左侧，在右端加入则会被加入到珍珠序列的最右侧。初始时，匣子是空的。\n\n这些珍珠要么是黑色的，要么是白色的，为了方便起见，我们将白色看作 $0$，黑色看作 $1$。\n\n在人鱼的世界中，定义颜色 $A$ **组合** 颜色 $B$ 为 $A\\operatorname{nand}B$，读作 $A$ 与非 $B$。\n\n定义 $A \\operatorname{nand} B = \\operatorname{not} (A \\operatorname{and}B)$ ，其中 $\\operatorname{and}$ 运算代表二进制与运算，$\\operatorname{not}$ 运算代表二进制非运算。\n\n定义位置 $x$ 到位置 $y$ 的组合和为：\n\n从 $x$ 开始向 $y$ ，第一个颜色组合第二个颜色的结果组合第三个颜色，得到的结果组合第四个颜色……一直组合到位置 $y$ 的颜色的结果。特别的，$x = y$ 时，组合和为该颜色。\n\n形式化的，设 $C_{x, y}$ 为序列 $A$ 从 $x$ 到 $y$ 的组合和，则\n$$C_{x, y} = \\begin{cases} C_{x, y - 1} \\operatorname{nand} A_y & x < y \\\\  C_{x, y + 1} \\operatorname{nand} A_y & x > y \\\\ A_x &x = y \\end{cases}$$\n\n例如，给定序列 $1, 1, 0, 0$，从 $2$ 到 $4$ 的组合和为 \n\n$$(1 \\operatorname{nand} 0) \\operatorname{nand} 0 = 1 \\operatorname{nand} 0 = 1$$\n\n从 $3$ 到 $1$ 的组合和为\n\n$$(0 \\operatorname{nand} 1) \\operatorname{nand} 1 = 1 \\operatorname{nand} 1 = 0$$\n\n从 $2$ 到 $2$ 的组合和为\n\n$$1$$\n\n扶苏会在匣子的两边加入一些珍珠，或者给定一个位置 $p$，询问你从左向右数第 $1$ 个位置到从左向右数第 $p$ 个位置的组合和，或者从右向左数第 $1$ 个位置到从右向左数第 $p$ 个位置的组合和。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n数据的第一行是一个整数 $n$，代表扶苏的操作个数。\n\n由于正常读入每个操作所需要的输入量过大，因此我们采用下面的生成器来生成每个操作。\n\n```cpp\n#include <cstdio>\n\nnamespace Maker {\n\ntypedef unsigned int uit;\n\nbool __sp;\nuit __x, __y, __z;\nint __type, __k, __m;\n\ntemplate <typename T>\ninline void qr(T &x) {\n  char ch = getchar(), lst = ' ';\n  while ((ch > '9') || (ch < '0')) lst = ch, ch = getchar();\n  while ((ch >= '0') && (ch <= '9')) x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();\n  if (lst == '-') x = -x;\n}\n\ntemplate <typename T>\ninline void Begin(const T &x) {\n  __type = x % 10;\n  qr(__x); qr(__y); qr(__z); qr(__m);\n  __sp = (__type == 3) || (__type == 4); __type &= 1;\n}\n\ninline uit __Next_Integer() {\n  __x ^= __y << (__z & 31);\n  __y ^= __z >> (__x & 31);\n  __z ^= __x << (__y & 31);\n  __x ^= __x >> 5; __y ^= __y << 13; __z ^= __z >> 6;\n  return __x;\n}\n\ninline uit Rand() { return __Next_Integer(); }\n\ntemplate <typename Tx, typename Ty, typename Tz>\ninline void Get_Nextline(Tx &x, Ty &y, Tz &z) {\n  if (__m) {\n    --__m;\n    x = 0; y = 0; z = 0;\n    qr(x); qr(y); qr(z);\n    if (x == 0) {\n      ++__k;\n    }\n  } else {\n    x = Rand() & 1; y = Rand() & 1;\n    if (__k == 0) { x = 0; }\n    if (x == 0) {\n      ++__k;\n      if (__sp) {\n        z = __type;\n      } else {\n        z = Rand() & 1;\n      }\n    } else {\n      int dk = __k >> 1;\n      if (dk == 0) {\n        z = 1;\n      } else {\n        z = Rand() % dk + dk;\n      }\n    }\n  }\n}\n\n}\n```\n\n对于 C/C++ 选手，我们提供了如上的数据生成代码（C 选手请使用 C++ 语言提交)，请将他们直接复制到你的代码中。\n\n对于非 C/C++ 选手，请你自行按照上面代码的内容，自行写出你所使用语言的对应生成器。\n\n下面的内容只针对 C++ 选手，请其他语言的选手自行按照对应语言的语法来完成代码。\n\n在读入 $n$ 这个数字以后，请你调用 ``Maker`` 命名空间中的 ``Begin`` 函数，函数的参数为 $n$。换句话说，你的代码中需要出现类似 ``Maker::Begin(n)`` 的语句。\n\n在调用完 ``Maker::Begin`` 函数以后，生成器就可以开始工作了。一共有 $n$ 次操作，每次操作时请你调用 ``Maker::Get_Nextline`` 函数，传入三个**整形**变量，(不妨设为 $x,y,z$)，每次函数调用结束以后，$x,y,z$ 的值都会被修改，作为每次操作的参数。具体含义如下：\n\n> 每次操作会有三个整数作为参数， 依次记为 $x,y,z$\n>\n> - 如果 $x = 0$，则代表这是一次插入操作；\n> - 如果 $x = 1$，则代表这是一次查询。\n> - 如果 $y = 0$，则代表插入操作是从左侧进行的，或者查询的位置是从左向右数的；\n> - 如果 $y = 1$，则代表插入操作是从右侧进行的，或者查询的位置是从右向左数的。\n> - 如果 $x = 0$，则 $z$ 是一个非零即一的整数，代表插入珍珠的颜色，$0$ 代表白色，$1$ 代表黑色；\n> - 如果 $x = 1$，则 $z$ 代表查询从第一个到第 $z$ 个位置的组合和。组合和的方向和位置的方向由参数 $y$ 决定。\n\n对于 C/C++ 选手，我们提供了模板程序([模板程序链接](https://www.luogu.org/paste/lk7wn4a1))，在这个程序中，已经做好了变量的读入和生成器的初始化，同时能够自动获取 $x,y,z$ 的值，你需要做的只是每次依照题意进行一个操作，最终输出答案。你可以自主选择是否使用这个模板，最终的评测得分与你的代码内容**无关**。\n\n**特别提醒：不建议使用 ``fread`` 等直接从输入中大量读取信息然后保存的函数对 $n$ 进行读入，如果你非要这么做，请你自行重写 ``Maker::Begin()`` 中的读入部分。**\n\n**从输入数据的第二行起，所有的数据都会被生成器自动读入（包括第二行），不需要你再行读入**。\n\n输入数据的第二行是四个整数 $a,b,c,m$，其中 $a,b,c$ 是生成器的参数，$m$ 为需要额外读入的操作数。\n\n为了在某种意义上避免因为生成的操作完全随机而产生的乱搞做法，我们将首先额外读入 $m$ 个给定的操作，然后再行随机。\n\n以下 $m$ 行，每行三个整数 $x,~y,~z$，代表一次操作。\n\n请特别注意，这 $m$ 次操作会被生成器**自动读入**。", "outputFormat": "为了避免输出过大，请输出一行四个用空格隔开的整数，分别代表所有的查询中：\n\n- 一共有多少次查询的结果为 $1$。\n- 一共有多少次查询的操作编号为奇数且查询结果为 $0$。\n- 一共有多少次查询的操作编号为偶数且查询结果为 $1$。\n- 一共有多少次查询的操作编号是 $1024$ 的倍数且查询结果为 $0$。\n\n定义第 $i$ 次操作的操作编号为 $i$。\n\n**注意，一次插入也算做一次操作**。", "hint": "#### 样例输入输出 1 解释\n\n第一次操作，$x=0,y=1,z=0$，在匣子右端插入一个 $0$，那么匣子里的珍珠序列为 $\\{0\\}$\n\n第二次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。\n\n第三次操作，$x = 0,y = 1,z = 1$，在匣子右端插入一个 $1$，匣子里的珍珠序列为 $\\{0,~1\\}$\n\n第四次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。\n\n第五次操作，$x = 0,y = 0,z = 0$，在匣子左侧插入一个 $0$，那么匣子里的珍珠序列为 $\\{0,~0,~1\\}$\n\n第六次操作，$x = 0,y = 1,z = 1$，在匣子右侧插入一个 $1$，那么匣子的珍珠序列为 $\\{0,~0,~1,~1\\}$\n\n没有任何一次查询的结果满足【输出格式】中提到的任意一种情况，于是输出 ``0 0 0 0``。\n\n---\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 $7$ 个子任务**。\n\n- Subtask 1（5 points）：$n = m = 0$。\n- Subtask 2（15 points）：$n = 1001$。\n- Subtask 3（15 points）：$n = 10^5 + 2$。\n- Subtask 4（10 points）：$n = 10^7 + 3$，对于所有 $x = 0$ 的操作，保证 $z = 1$。\n- Subtask 5（10 points）：$n = 10^7 + 4$，对于所有 $x = 0$ 的操作，保证 $z = 0$。\n- Subtask 6（15 points）：$n = 10^7 + 5$，$m = 0$。\n- Subtask 7（30 points）：$n = 10^7 + 6$。\n\n对于全部的测试点，保证 $0 \\leq n \\leq 10^7 + 6$，$0 \\leq m \\leq \\min(n, 10^6)$，$x, y \\in \\{0, 1\\}$，且对于所有 $x = 0$ 的操作，保证  $z \\in \\{0, 1\\}$，若设 $k$ 为在任一查询时匣子里的珍珠个数，则保证对于 $x = 1$ 的操作，$1 \\leq z \\leq k$，匣子为空时不会有查询操作。\n\n---\n\n#### 提示与说明\n\n- 请注意常数因子对程序效率造成的影响。\n- $n$ 的末位数字可以帮助你快速的判断测试点所属的子任务。\n- 由于涉及到非操作，与非运算可能不具备一些常见位运算的运算律，请格外注意。\n- std 使用 C++ 语言，保证时限是 std 用时的 1.5 倍以上，**但是不保证其他语言能够通过本题**。\n- 对于 C++ 选手，如果你直接复制上面的生成器，保证生成器运行总时间不超过 300ms。", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2019] Pearls", "background": "> Do not sigh too much for farewells; at least the meeting was real.  \n> Swaying between blooming and withering, time has never stopped.  \n> Snow drifting at the edge of the world, never forgetting mountains and butterflies.  \n> I heard someone let down the dark night, yet insisted on lighting the moon for the human world.\n>\n> — Yin Lin, “Pearls”.", "description": "Fusu gives you a small box for holding pearls. This box can add pearls without limit at both the left and right ends. Pearls in the box will line up into a sequence. Each time you add a pearl on the left end, it is inserted to the leftmost of the sequence; adding on the right end inserts it to the rightmost. Initially, the box is empty.\n\nEach pearl is either black or white. For convenience, we treat white as $0$ and black as $1$.\n\nIn the mermaid world, combining color $A$ with color $B$ is defined as $A\\operatorname{nand}B$, read as “$A$ NAND $B$”.\n\nDefine\n$A \\operatorname{nand} B = \\operatorname{not} (A \\operatorname{and}B)$,\nwhere $\\operatorname{and}$ is the binary AND operation and $\\operatorname{not}$ is the binary NOT operation.\n\nDefine the combined value from position $x$ to position $y$ as:\n\nStarting from $x$ towards $y$, combine the first color with the second color, then combine the result with the third color, then combine that result with the fourth color, and so on, until combining with the color at position $y$. In particular, when $x = y$, the combined value is just that color.\n\nFormally, let $C_{x, y}$ be the combined value of sequence $A$ from $x$ to $y$. Then\n$$C_{x, y} = \\begin{cases} C_{x, y - 1} \\operatorname{nand} A_y & x < y \\\\  C_{x, y + 1} \\operatorname{nand} A_y & x > y \\\\ A_x &x = y \\end{cases}$$\n\nFor example, given the sequence $1, 1, 0, 0$, the combined value from $2$ to $4$ is\n\n$$(1 \\operatorname{nand} 0) \\operatorname{nand} 0 = 1 \\operatorname{nand} 0 = 1$$\n\nThe combined value from $3$ to $1$ is\n\n$$(0 \\operatorname{nand} 1) \\operatorname{nand} 1 = 1 \\operatorname{nand} 1 = 0$$\n\nThe combined value from $2$ to $2$ is\n\n$$1$$\n\nFusu will add some pearls to both ends of the box, or give a position $p$ and ask you for the combined value from the $1$st position (counting left to right) to the $p$-th position (counting left to right), or from the $1$st position (counting right to left) to the $p$-th position (counting right to left).", "inputFormat": "Each input file contains exactly one set of testdata.\n\nThe first line contains an integer $n$, which is the number of operations performed by Fusu.\n\nSince reading each operation normally would require too much input, we use the following generator to generate each operation.\n\n```cpp\n#include <cstdio>\n\nnamespace Maker {\n\ntypedef unsigned int uit;\n\nbool __sp;\nuit __x, __y, __z;\nint __type, __k, __m;\n\ntemplate <typename T>\ninline void qr(T &x) {\n  char ch = getchar(), lst = ' ';\n  while ((ch > '9') || (ch < '0')) lst = ch, ch = getchar();\n  while ((ch >= '0') && (ch <= '9')) x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();\n  if (lst == '-') x = -x;\n}\n\ntemplate <typename T>\ninline void Begin(const T &x) {\n  __type = x % 10;\n  qr(__x); qr(__y); qr(__z); qr(__m);\n  __sp = (__type == 3) || (__type == 4); __type &= 1;\n}\n\ninline uit __Next_Integer() {\n  __x ^= __y << (__z & 31);\n  __y ^= __z >> (__x & 31);\n  __z ^= __x << (__y & 31);\n  __x ^= __x >> 5; __y ^= __y << 13; __z ^= __z >> 6;\n  return __x;\n}\n\ninline uit Rand() { return __Next_Integer(); }\n\ntemplate <typename Tx, typename Ty, typename Tz>\ninline void Get_Nextline(Tx &x, Ty &y, Tz &z) {\n  if (__m) {\n    --__m;\n    x = 0; y = 0; z = 0;\n    qr(x); qr(y); qr(z);\n    if (x == 0) {\n      ++__k;\n    }\n  } else {\n    x = Rand() & 1; y = Rand() & 1;\n    if (__k == 0) { x = 0; }\n    if (x == 0) {\n      ++__k;\n      if (__sp) {\n        z = __type;\n      } else {\n        z = Rand() & 1;\n      }\n    } else {\n      int dk = __k >> 1;\n      if (dk == 0) {\n        z = 1;\n      } else {\n        z = Rand() % dk + dk;\n      }\n    }\n  }\n}\n\n}\n```\n\nFor C/C++ users, we provide the generator code above (C users must submit in C++). Please copy it directly into your code.\n\nFor non-C/C++ users, please implement the corresponding generator in your own language according to the code above.\n\nThe following content is only for C++ users. Users of other languages should adapt it according to their language syntax.\n\nAfter reading $n$, you should call the `Begin` function in the `Maker` namespace, with parameter $n$. In other words, your code needs a statement like `Maker::Begin(n)`.\n\nAfter calling `Maker::Begin`, the generator starts working. There are $n$ operations. For each operation, call `Maker::Get_Nextline`, passing in three **integer** variables (say $x, y, z$). After each call, the values of $x, y, z$ will be modified and used as the parameters of the operation. The meanings are as follows:\n\n> Each operation has three integers as parameters, denoted $x, y, z$ in order.\n>\n> - If $x = 0$, this is an insertion operation.\n> - If $x = 1$, this is a query.\n> - If $y = 0$, the insertion is performed from the left side, or the query positions are counted from left to right.\n> - If $y = 1$, the insertion is performed from the right side, or the query positions are counted from right to left.\n> - If $x = 0$, then $z$ is an integer equal to $0$ or $1$, representing the color of the inserted pearl: $0$ means white and $1$ means black.\n> - If $x = 1$, then $z$ represents querying the combined value from the $1$st to the $z$-th position. The direction of combination and the direction of counting positions are determined by $y$.\n\nFor C/C++ users, we provide a template program ([template program link](https://www.luogu.org/paste/lk7wn4a1)). In this program, the input and generator initialization are already done, and it can automatically obtain $x, y, z$. You only need to perform one operation each time as required by the statement and finally output the answer. You may choose whether to use this template; your final score is **unrelated** to your code content.\n\n**Special reminder: it is not recommended to use functions like `fread` to read a large amount of input and then parse $n$. If you insist on doing so, please rewrite the input-reading part in `Maker::Begin()`.**\n\n**Starting from the second line of the input, all data will be automatically read by the generator (including the second line), and you do not need to read it manually.**\n\nThe second line of the input contains four integers $a, b, c, m$, where $a, b, c$ are parameters of the generator, and $m$ is the number of operations that need to be additionally read.\n\nTo, in some sense, avoid “messy” solutions caused by fully random operations, we will first additionally read $m$ given operations, and then generate random ones.\n\nIn the next $m$ lines, each line contains three integers $x,~y,~z$, representing one operation.\n\nPlease note that these $m$ operations will be **automatically read** by the generator.", "outputFormat": "To avoid overly large output, output one line with four integers separated by spaces, representing among all queries:\n\n- How many queries have result $1$.\n- How many queries have an odd operation index and result $0$.\n- How many queries have an even operation index and result $1$.\n- How many queries have an operation index that is a multiple of $1024$ and result $0$.\n\nDefine the operation index of the $i$-th operation as $i$.\n\n**Note that an insertion also counts as an operation.**", "hint": "#### Explanation of Sample Input/Output 1\n\nFor the first operation, $x = 0, y = 1, z = 0$. Insert a $0$ at the right end, so the pearl sequence in the box is $\\{0\\}$.\n\nFor the second operation, $x = 1, y = 0, z = 1$. Query the combined value from the first element to the first element counting from left to right. The answer is $0$.\n\nFor the third operation, $x = 0, y = 1, z = 1$. Insert a $1$ at the right end, so the sequence becomes $\\{0,~1\\}$.\n\nFor the fourth operation, $x = 1, y = 0, z = 1$. Query the combined value from the first element to the first element counting from left to right. The answer is $0$.\n\nFor the fifth operation, $x = 0, y = 0, z = 0$. Insert a $0$ at the left end, so the sequence becomes $\\{0,~0,~1\\}$.\n\nFor the sixth operation, $x = 0, y = 1, z = 1$. Insert a $1$ at the right end, so the sequence becomes $\\{0,~0,~1,~1\\}$.\n\nNo query result satisfies any of the cases mentioned in the “Output Format”, so the output is `0 0 0 0`.\n\n---\n\n#### Constraints and Conventions\n\n**This problem uses bundled subtasks, with a total of $7$ subtasks.**\n\n- Subtask 1 (5 points): $n = m = 0$.\n- Subtask 2 (15 points): $n = 1001$.\n- Subtask 3 (15 points): $n = 10^5 + 2$.\n- Subtask 4 (10 points): $n = 10^7 + 3$. For all operations with $x = 0$, it is guaranteed that $z = 1$.\n- Subtask 5 (10 points): $n = 10^7 + 4$. For all operations with $x = 0$, it is guaranteed that $z = 0$.\n- Subtask 6 (15 points): $n = 10^7 + 5$, $m = 0$.\n- Subtask 7 (30 points): $n = 10^7 + 6$.\n\nFor all test cases, it is guaranteed that $0 \\leq n \\leq 10^7 + 6$, $0 \\leq m \\leq \\min(n, 10^6)$, $x, y \\in \\{0, 1\\}$, and for all operations with $x = 0$, it is guaranteed that $z \\in \\{0, 1\\}$. Let $k$ be the number of pearls in the box at any query time; then for operations with $x = 1$, it is guaranteed that $1 \\leq z \\leq k$. There will be no query operation when the box is empty.\n\n---\n\n#### Notes and Additional Information\n\n- Please pay attention to the impact of constant factors on program efficiency.\n- The last digit of $n$ can help you quickly determine which subtask the test case belongs to.\n- Since NAND and NOT are involved, NAND may not satisfy some common bitwise operation laws. Please be especially careful.\n- `std` uses C++, and the time limit is guaranteed to be at least $1.5$ times the runtime of `std`, **but it is not guaranteed that other languages can pass this problem**.\n- For C++ users, if you copy the generator above directly, it is guaranteed that the total runtime of the generator does not exceed 300 ms.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2019] 珍珠", "background": "> 别叹息太多告别，至少相遇很真切。  \n> 摇曳着盛放枯竭，时间从未停歇。  \n> 天涯浪迹的白雪，念念不忘山川蝴蝶。  \n> 听说有人孤负黑夜，偏要点亮人间的月。\n\n——银临《珍珠》", "description": "扶苏给了你一个放珍珠的小匣子，这个匣子在左右两端都可以无限制的加入珍珠，珍珠在匣子里会排成一列，每次在左端加入珍珠，这个珍珠会被加入到这个珍珠序列的最左侧，在右端加入则会被加入到珍珠序列的最右侧。初始时，匣子是空的。\n\n这些珍珠要么是黑色的，要么是白色的，为了方便起见，我们将白色看作 $0$，黑色看作 $1$。\n\n在人鱼的世界中，定义颜色 $A$ **组合** 颜色 $B$ 为 $A\\operatorname{nand}B$，读作 $A$ 与非 $B$。\n\n定义 $A \\operatorname{nand} B = \\operatorname{not} (A \\operatorname{and}B)$ ，其中 $\\operatorname{and}$ 运算代表二进制与运算，$\\operatorname{not}$ 运算代表二进制非运算。\n\n定义位置 $x$ 到位置 $y$ 的组合和为：\n\n从 $x$ 开始向 $y$ ，第一个颜色组合第二个颜色的结果组合第三个颜色，得到的结果组合第四个颜色……一直组合到位置 $y$ 的颜色的结果。特别的，$x = y$ 时，组合和为该颜色。\n\n形式化的，设 $C_{x, y}$ 为序列 $A$ 从 $x$ 到 $y$ 的组合和，则\n$$C_{x, y} = \\begin{cases} C_{x, y - 1} \\operatorname{nand} A_y & x < y \\\\  C_{x, y + 1} \\operatorname{nand} A_y & x > y \\\\ A_x &x = y \\end{cases}$$\n\n例如，给定序列 $1, 1, 0, 0$，从 $2$ 到 $4$ 的组合和为 \n\n$$(1 \\operatorname{nand} 0) \\operatorname{nand} 0 = 1 \\operatorname{nand} 0 = 1$$\n\n从 $3$ 到 $1$ 的组合和为\n\n$$(0 \\operatorname{nand} 1) \\operatorname{nand} 1 = 1 \\operatorname{nand} 1 = 0$$\n\n从 $2$ 到 $2$ 的组合和为\n\n$$1$$\n\n扶苏会在匣子的两边加入一些珍珠，或者给定一个位置 $p$，询问你从左向右数第 $1$ 个位置到从左向右数第 $p$ 个位置的组合和，或者从右向左数第 $1$ 个位置到从右向左数第 $p$ 个位置的组合和。", "inputFormat": "每个输入文件中都有且仅有一组测试数据。\n\n数据的第一行是一个整数 $n$，代表扶苏的操作个数。\n\n由于正常读入每个操作所需要的输入量过大，因此我们采用下面的生成器来生成每个操作。\n\n```cpp\n#include <cstdio>\n\nnamespace Maker {\n\ntypedef unsigned int uit;\n\nbool __sp;\nuit __x, __y, __z;\nint __type, __k, __m;\n\ntemplate <typename T>\ninline void qr(T &x) {\n  char ch = getchar(), lst = ' ';\n  while ((ch > '9') || (ch < '0')) lst = ch, ch = getchar();\n  while ((ch >= '0') && (ch <= '9')) x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();\n  if (lst == '-') x = -x;\n}\n\ntemplate <typename T>\ninline void Begin(const T &x) {\n  __type = x % 10;\n  qr(__x); qr(__y); qr(__z); qr(__m);\n  __sp = (__type == 3) || (__type == 4); __type &= 1;\n}\n\ninline uit __Next_Integer() {\n  __x ^= __y << (__z & 31);\n  __y ^= __z >> (__x & 31);\n  __z ^= __x << (__y & 31);\n  __x ^= __x >> 5; __y ^= __y << 13; __z ^= __z >> 6;\n  return __x;\n}\n\ninline uit Rand() { return __Next_Integer(); }\n\ntemplate <typename Tx, typename Ty, typename Tz>\ninline void Get_Nextline(Tx &x, Ty &y, Tz &z) {\n  if (__m) {\n    --__m;\n    x = 0; y = 0; z = 0;\n    qr(x); qr(y); qr(z);\n    if (x == 0) {\n      ++__k;\n    }\n  } else {\n    x = Rand() & 1; y = Rand() & 1;\n    if (__k == 0) { x = 0; }\n    if (x == 0) {\n      ++__k;\n      if (__sp) {\n        z = __type;\n      } else {\n        z = Rand() & 1;\n      }\n    } else {\n      int dk = __k >> 1;\n      if (dk == 0) {\n        z = 1;\n      } else {\n        z = Rand() % dk + dk;\n      }\n    }\n  }\n}\n\n}\n```\n\n对于 C/C++ 选手，我们提供了如上的数据生成代码（C 选手请使用 C++ 语言提交)，请将他们直接复制到你的代码中。\n\n对于非 C/C++ 选手，请你自行按照上面代码的内容，自行写出你所使用语言的对应生成器。\n\n下面的内容只针对 C++ 选手，请其他语言的选手自行按照对应语言的语法来完成代码。\n\n在读入 $n$ 这个数字以后，请你调用 ``Maker`` 命名空间中的 ``Begin`` 函数，函数的参数为 $n$。换句话说，你的代码中需要出现类似 ``Maker::Begin(n)`` 的语句。\n\n在调用完 ``Maker::Begin`` 函数以后，生成器就可以开始工作了。一共有 $n$ 次操作，每次操作时请你调用 ``Maker::Get_Nextline`` 函数，传入三个**整形**变量，(不妨设为 $x,y,z$)，每次函数调用结束以后，$x,y,z$ 的值都会被修改，作为每次操作的参数。具体含义如下：\n\n> 每次操作会有三个整数作为参数， 依次记为 $x,y,z$\n>\n> - 如果 $x = 0$，则代表这是一次插入操作；\n> - 如果 $x = 1$，则代表这是一次查询。\n> - 如果 $y = 0$，则代表插入操作是从左侧进行的，或者查询的位置是从左向右数的；\n> - 如果 $y = 1$，则代表插入操作是从右侧进行的，或者查询的位置是从右向左数的。\n> - 如果 $x = 0$，则 $z$ 是一个非零即一的整数，代表插入珍珠的颜色，$0$ 代表白色，$1$ 代表黑色；\n> - 如果 $x = 1$，则 $z$ 代表查询从第一个到第 $z$ 个位置的组合和。组合和的方向和位置的方向由参数 $y$ 决定。\n\n对于 C/C++ 选手，我们提供了模板程序([模板程序链接](https://www.luogu.org/paste/lk7wn4a1))，在这个程序中，已经做好了变量的读入和生成器的初始化，同时能够自动获取 $x,y,z$ 的值，你需要做的只是每次依照题意进行一个操作，最终输出答案。你可以自主选择是否使用这个模板，最终的评测得分与你的代码内容**无关**。\n\n**特别提醒：不建议使用 ``fread`` 等直接从输入中大量读取信息然后保存的函数对 $n$ 进行读入，如果你非要这么做，请你自行重写 ``Maker::Begin()`` 中的读入部分。**\n\n**从输入数据的第二行起，所有的数据都会被生成器自动读入（包括第二行），不需要你再行读入**。\n\n输入数据的第二行是四个整数 $a,b,c,m$，其中 $a,b,c$ 是生成器的参数，$m$ 为需要额外读入的操作数。\n\n为了在某种意义上避免因为生成的操作完全随机而产生的乱搞做法，我们将首先额外读入 $m$ 个给定的操作，然后再行随机。\n\n以下 $m$ 行，每行三个整数 $x,~y,~z$，代表一次操作。\n\n请特别注意，这 $m$ 次操作会被生成器**自动读入**。", "outputFormat": "为了避免输出过大，请输出一行四个用空格隔开的整数，分别代表所有的查询中：\n\n- 一共有多少次查询的结果为 $1$。\n- 一共有多少次查询的操作编号为奇数且查询结果为 $0$。\n- 一共有多少次查询的操作编号为偶数且查询结果为 $1$。\n- 一共有多少次查询的操作编号是 $1024$ 的倍数且查询结果为 $0$。\n\n定义第 $i$ 次操作的操作编号为 $i$。\n\n**注意，一次插入也算做一次操作**。", "hint": "#### 样例输入输出 1 解释\n\n第一次操作，$x=0,y=1,z=0$，在匣子右端插入一个 $0$，那么匣子里的珍珠序列为 $\\{0\\}$\n\n第二次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。\n\n第三次操作，$x = 0,y = 1,z = 1$，在匣子右端插入一个 $1$，匣子里的珍珠序列为 $\\{0,~1\\}$\n\n第四次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。\n\n第五次操作，$x = 0,y = 0,z = 0$，在匣子左侧插入一个 $0$，那么匣子里的珍珠序列为 $\\{0,~0,~1\\}$\n\n第六次操作，$x = 0,y = 1,z = 1$，在匣子右侧插入一个 $1$，那么匣子的珍珠序列为 $\\{0,~0,~1,~1\\}$\n\n没有任何一次查询的结果满足【输出格式】中提到的任意一种情况，于是输出 ``0 0 0 0``。\n\n---\n\n#### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 $7$ 个子任务**。\n\n- Subtask 1（5 points）：$n = m = 0$。\n- Subtask 2（15 points）：$n = 1001$。\n- Subtask 3（15 points）：$n = 10^5 + 2$。\n- Subtask 4（10 points）：$n = 10^7 + 3$，对于所有 $x = 0$ 的操作，保证 $z = 1$。\n- Subtask 5（10 points）：$n = 10^7 + 4$，对于所有 $x = 0$ 的操作，保证 $z = 0$。\n- Subtask 6（15 points）：$n = 10^7 + 5$，$m = 0$。\n- Subtask 7（30 points）：$n = 10^7 + 6$。\n\n对于全部的测试点，保证 $0 \\leq n \\leq 10^7 + 6$，$0 \\leq m \\leq \\min(n, 10^6)$，$x, y \\in \\{0, 1\\}$，且对于所有 $x = 0$ 的操作，保证  $z \\in \\{0, 1\\}$，若设 $k$ 为在任一查询时匣子里的珍珠个数，则保证对于 $x = 1$ 的操作，$1 \\leq z \\leq k$，匣子为空时不会有查询操作。\n\n---\n\n#### 提示与说明\n\n- 请注意常数因子对程序效率造成的影响。\n- $n$ 的末位数字可以帮助你快速的判断测试点所属的子任务。\n- 由于涉及到非操作，与非运算可能不具备一些常见位运算的运算律，请格外注意。\n- std 使用 C++ 语言，保证时限是 std 用时的 1.5 倍以上，**但是不保证其他语言能够通过本题**。\n- 对于 C++ 选手，如果你直接复制上面的生成器，保证生成器运行总时间不超过 300ms。", "locale": "zh-CN"}}}
{"pid": "P5524", "type": "P", "difficulty": 6, "samples": [["5 10 6\n3 1\n3 5\n2 5 5 10\n3 1\n2 5 5 5\n3 5\n3 1\n1 1 5\n2 5 5 3\n3 5\n5 6\n3 6\n1 10\n2 8\n3 10\n7 8", "5\n5\n8\n5\n8\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "O2优化", "Ynoi"], "title": "[Ynoi2012] NOIP2015 充满了希望", "background": "", "description": "给一个长为 $n$ 的序列，有 $m$ 个操作，操作编号从 $1$ 到 $m$，每个操作为：\n\n`1 x y`：将序列位置为 $x,y$ 的两个元素交换。\n\n`2 l r x`：将序列区间 $[l,r]$ 内所有元素修改为 $x$。\n\n`3 x`：查询序列 $x$ 位置的值。\n\n现在有 $q$ 次查询，每次查询给出一个操作的区间 $[l,r]$：\n\n先将序列中的元素全部置为 $0$，之后依次进行从 $l$ 到 $r$ 的所有操作，求出所有这些操作中所有 $3$ 操作的答案的和。\n\n查询之间独立。", "inputFormat": "第一行三个数表示 $n,m,q$。\n\n之后 $m$ 行，每行 $2$ 到 $4$ 个数，依次表示每个操作。\n\n之后 $q$ 行，每行两个数 $l,r$，查询依次进行 $[l,r]$ 的所有操作，所有 $3$ 操作的答案的和。", "outputFormat": "对于每次查询，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477&ccz181078，Solution：nzhtl1477&ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $10\\%$ 的数据，满足 $1\\le n,m,q\\le 1000$。\n\n对于 $40\\%$ 的数据，满足 $1\\le n,m,q\\le 10^5$。\n\n对于另外 $20\\%$ 的数据，没有 $1$ 操作。\n\n对于另外 $20\\%$ 的数据，没有 $2$ 操作。\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m,q\\le 10^6$，$1\\le x\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2012] NOIP2015 充满了希望", "background": "", "description": "给一个长为 $n$ 的序列，有 $m$ 个操作，操作编号从 $1$ 到 $m$，每个操作为：\n\n`1 x y`：将序列位置为 $x,y$ 的两个元素交换。\n\n`2 l r x`：将序列区间 $[l,r]$ 内所有元素修改为 $x$。\n\n`3 x`：查询序列 $x$ 位置的值。\n\n现在有 $q$ 次查询，每次查询给出一个操作的区间 $[l,r]$：\n\n先将序列中的元素全部置为 $0$，之后依次进行从 $l$ 到 $r$ 的所有操作，求出所有这些操作中所有 $3$ 操作的答案的和。\n\n查询之间独立。", "inputFormat": "第一行三个数表示 $n,m,q$。\n\n之后 $m$ 行，每行 $2$ 到 $4$ 个数，依次表示每个操作。\n\n之后 $q$ 行，每行两个数 $l,r$，查询依次进行 $[l,r]$ 的所有操作，所有 $3$ 操作的答案的和。", "outputFormat": "对于每次查询，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477&ccz181078，Solution：nzhtl1477&ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $10\\%$ 的数据，满足 $1\\le n,m,q\\le 1000$。\n\n对于 $40\\%$ 的数据，满足 $1\\le n,m,q\\le 10^5$。\n\n对于另外 $20\\%$ 的数据，没有 $1$ 操作。\n\n对于另外 $20\\%$ 的数据，没有 $2$ 操作。\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m,q\\le 10^6$，$1\\le x\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5525", "type": "P", "difficulty": 6, "samples": [["1\n8\n1 10\n1 -10\n10 1\n8 -5\n-10 0\n8 6\n-4 8\n-6 8\n15\n2 -1 3\n8 -1 6\n-7 -10 2\n-10 -1 4\n7 10 10\n-1 -7 9\n-5 0 5\n-5 5 4\n10 -7 4\n-5 5 1\n2 1 6\n10 3 7\n-2 0 3\n-2 0 7\n-9 -6 6", "100000000110100"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "O2优化", "Ynoi"], "title": "[Ynoi2012] WC2016 充满了失望", "background": "", "description": "在平面直角坐标系中，\n\n给 $n$ 个点，这 $n$ 个点是可达的，如果点 $A,B$ 可达则线段 $AB$ 上的点均可达。\n\n给 $m$ 个圆，问有哪些圆满足圆内任意点都是可达的。", "inputFormat": "第一行一个整数 $T$，表示数据组数；\n\n接下来 $T$ 组数据，每组数据中：\n\n第一行一个整数 $n$，\n\n接下来 $n$ 行每行两个整数 $x_i,y_i$，表示点，\n\n接下来一行一个整数 $m$，\n\n接下来 $m$ 行每行三个整数 $X_i,Y_i,R_i$，表示圆。", "outputFormat": "每组数据输出一行，一个长度 $m$ 的 `01` 串，表示答案（`0` 表示圆内存在不可达的点，`1` 表示圆内所有点可达）", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n样例解释：\n\n红色的点为样例中给出的点，橙色的圆表示答案为 `1` 的询问，蓝色的圆表示答案为 `0` 的询问。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2hsha1je.png)\n\n$1\\leq n,m\\leq 5\\times 10^5$，$1\\leq R_i\\leq 10^6$，$-10^6\\leq x_i,y_i,X_i,Y_i\\leq 10^6$，$\\sum n\\leq 5\\times 10^5$，$\\sum \n m\\leq 5\\times 10^5$。\n\n保证当 $R_i$ 变化不超过 $1$ 时，答案不发生变化。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2012] WC2016 Full of Disappointment", "background": "", "description": "In the 2D Cartesian coordinate system,\n\nYou are given $n$ points. These $n$ points are reachable. If points $A, B$ are reachable, then all points on the segment $AB$ are also reachable.\n\nYou are given $m$ circles. Determine which circles satisfy that every point inside the circle is reachable.", "inputFormat": "The first line contains an integer $T$, which indicates the number of test cases.\n\nThen there are $T$ test cases. For each test case:\n\nThe first line contains an integer $n$.\n\nThe next $n$ lines each contain two integers $x_i, y_i$, representing a point.\n\nThe next line contains an integer $m$.\n\nThe next $m$ lines each contain three integers $X_i, Y_i, R_i$, representing a circle.", "outputFormat": "For each test case, output one line: a `01` string of length $m$, representing the answers (`0` means there exists an unreachable point inside the circle, `1` means all points inside the circle are reachable).", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078.\n\nSample explanation:\n\nThe red points are the points given in the sample. The orange circles indicate queries with answer `1`, and the blue circles indicate queries with answer `0`.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2hsha1je.png)\n\nConstraints: $1\\leq n,m\\leq 5\\times 10^5$, $1\\leq R_i\\leq 10^6$, $-10^6\\leq x_i,y_i,X_i,Y_i\\leq 10^6$, $\\sum n\\leq 5\\times 10^5$, $\\sum m\\leq 5\\times 10^5$.\n\nIt is guaranteed that when $R_i$ changes by no more than $1$, the answer does not change.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2012] WC2016 充满了失望", "background": "", "description": "在平面直角坐标系中，\n\n给 $n$ 个点，这 $n$ 个点是可达的，如果点 $A,B$ 可达则线段 $AB$ 上的点均可达。\n\n给 $m$ 个圆，问有哪些圆满足圆内任意点都是可达的。", "inputFormat": "第一行一个整数 $T$，表示数据组数；\n\n接下来 $T$ 组数据，每组数据中：\n\n第一行一个整数 $n$，\n\n接下来 $n$ 行每行两个整数 $x_i,y_i$，表示点，\n\n接下来一行一个整数 $m$，\n\n接下来 $m$ 行每行三个整数 $X_i,Y_i,R_i$，表示圆。", "outputFormat": "每组数据输出一行，一个长度 $m$ 的 `01` 串，表示答案（`0` 表示圆内存在不可达的点，`1` 表示圆内所有点可达）", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n样例解释：\n\n红色的点为样例中给出的点，橙色的圆表示答案为 `1` 的询问，蓝色的圆表示答案为 `0` 的询问。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2hsha1je.png)\n\n$1\\leq n,m\\leq 5\\times 10^5$，$1\\leq R_i\\leq 10^6$，$-10^6\\leq x_i,y_i,X_i,Y_i\\leq 10^6$，$\\sum n\\leq 5\\times 10^5$，$\\sum \n m\\leq 5\\times 10^5$。\n\n保证当 $R_i$ 变化不超过 $1$ 时，答案不发生变化。", "locale": "zh-CN"}}}
{"pid": "P5526", "type": "P", "difficulty": 7, "samples": [["5 3\n1 2 1 2 3\n1 2\n1 3\n3 4\n3 5\n3 3\n4 1\n4 3", "47\n51\n49\n45"], ["6 1\n1 1 1 1 1 1\n1 2\n2 3\n3 4\n4 5\n5 6\n1 2", "36\n46"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2012", "O2优化", "Ynoi"], "title": "[Ynoi2012] 惊惶的 SCOI2016", "background": "", "description": "给你一棵 $n$ 个节点的树，每个点有个颜色，有 $m$ 次修改，每次修改需要输出树上所有有向简单路径的颜色数的和。", "inputFormat": "第一行，输入两个整数 $n$ 和 $m$。\n\n第二行，输入 $n$ 个整数 $c_1,c_2,\\ldots,c_n$（$1\\leq c_i\\leq n$）。其中 $c_i$ 为 $i$ 节点的初始颜色。\n\n接下来 $n-1$ 行每行包括两个整数 $u,v$（$1\\leq u,v\\leq n$），这表示 $u$ 与 $v$ 之间有一条边。\n\n接着 $m$ 行每行包括两个整数 $u,x$（$1\\leq u,x\\leq n$）表示将节点 $u$ 的颜色修改为 $x$。", "outputFormat": "输出 $m+1$ 行，每行一个整数，为初始这个树上所有路径颜色数的和，以及每次修改后的这个值。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $2\\leq n\\leq 4\\times 10^5$，$1\\leq m\\leq 4\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2012] Panic SCOI2016", "background": "", "description": "You are given a tree with $n$ nodes. Each node has a color. There are $m$ modifications. For each modification, you need to output the sum, over all directed simple paths in the tree, of the number of distinct colors on the path.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThe second line contains $n$ integers $c_1,c_2,\\ldots,c_n$ ($1\\leq c_i\\leq n$), where $c_i$ is the initial color of node $i$.\n\nThe next $n-1$ lines each contain two integers $u,v$ ($1\\leq u,v\\leq n$), indicating that there is an edge between $u$ and $v$.\n\nThen follow $m$ lines, each containing two integers $u,x$ ($1\\leq u,x\\leq n$), meaning to change the color of node $u$ to $x$.", "outputFormat": "Output $m+1$ lines, each containing one integer: the sum of the number of colors over all paths in the tree for the initial tree, and the value after each modification.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477\n\nFor $100\\%$ of the testdata, $2\\leq n\\leq 4\\times 10^5$ and $1\\leq m\\leq 4\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2012] 惊惶的 SCOI2016", "background": "", "description": "给你一棵 $n$ 个节点的树，每个点有个颜色，有 $m$ 次修改，每次修改需要输出树上所有有向简单路径的颜色数的和。", "inputFormat": "第一行，输入两个整数 $n$ 和 $m$。\n\n第二行，输入 $n$ 个整数 $c_1,c_2,\\ldots,c_n$（$1\\leq c_i\\leq n$）。其中 $c_i$ 为 $i$ 节点的初始颜色。\n\n接下来 $n-1$ 行每行包括两个整数 $u,v$（$1\\leq u,v\\leq n$），这表示 $u$ 与 $v$ 之间有一条边。\n\n接着 $m$ 行每行包括两个整数 $u,x$（$1\\leq u,x\\leq n$）表示将节点 $u$ 的颜色修改为 $x$。", "outputFormat": "输出 $m+1$ 行，每行一个整数，为初始这个树上所有路径颜色数的和，以及每次修改后的这个值。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $2\\leq n\\leq 4\\times 10^5$，$1\\leq m\\leq 4\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5529", "type": "P", "difficulty": 7, "samples": [["10\n0 1 1 1 3 4 2 4 2 3\n16 20 29 16 23 6 29 21 1 22\n10\n3 4\n3 4\n2 6 20\n2 1 8\n2 2 8\n1 9 21\n3 6\n3 2\n1 3 11\n1 4 17\n", "16 2 2\n16 2 2\n20 1 1\n8 3 2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "平衡树", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2012] 梦断 SCOI2017", "background": "", "description": "有 $n$ 个学生构成了一棵有根树，每个学生有一个 $\\text{gpa}$。\n\n定义一个学生所在的**专业**为仅保留两端学生 $\\text{gpa}$ 相同的边时，这个学生所在的连通分量。\n\n定义一个专业的**怨气值**是 $max(dep[a]-dep[b]+1)$ $s.t$. $a,b$是专业中的学生，$dep_{根}=0$，$dep_{w}=dep_{w的父亲}+1$。\n\n操作 1 ：给出 $x$ 和 $y$，把学生 $x$ 的 $\\text{gpa}$ 改成 $y$。\n\n操作 2 ：给出 $x$ 和 $y$，把学生 $x$ 所在的专业中所有点 $\\text{gpa}$ 改为 $y$。\n\n操作 3 ：给出 $x$，问学生 $x$ 的 $\\text{gpa}$，$x$ 所在专业的人数，$x$所在专业的怨气值。", "inputFormat": "第一行一个数 $n$。\n\n第二行 $n$ 个数表示每个节点的父亲，其中第 $i$ 个数 $<i$，且 $1$ 节点的父亲为 $0$。\n\n第三行 $n$ 个数表示每个学生的 $\\text{gpa}$。\n\n第四行一个数 $m$。\n\n之后 $m$ 行，每行一个两或三个数表示一次操作，类型如上述。", "outputFormat": "对于每个 $3$ 操作，输出一行三个数，中间用空格隔开，依次表示：学生 $x$ 的 $\\text{gpa}$，$x$ 所在专业的人数，$x$ 所在专业的怨气值。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n定义 $\\text{gpa}$ 共有 $c$ 种。\n\n对于 $40\\%$ 的数据，$n,m \\le 1000$。\n\n对于另外 $40\\%$ 的数据，$n,m \\le 10^{5}$，$c=2$，$\\text{gpa}$ 的范围在 $[1,2]$ 中。\n\n对于 $100\\%$ 的数据，$n,m \\le 10^5$，$c=30$，$\\text{gpa}$ 的范围在 $[1,30]$ 中。\n\n我都懒得喷 THU 了。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2012] Dream Broken SCOI2017", "background": "", "description": "There are $n$ students forming a rooted tree, and each student has a $\\text{gpa}$.\n\nDefine a student’s **major** as the connected component that contains this student after keeping only the edges whose two endpoints have the same $\\text{gpa}$.\n\nDefine the **resentment value** of a major as $max(dep[a]-dep[b]+1)$ $s.t$. $a,b$ are students in the major, $dep_{root}=0$, and $dep_{w}=dep_{w's\\ father}+1$.\n\nOperation 1: given $x$ and $y$, change student $x$’s $\\text{gpa}$ to $y$.\n\nOperation 2: given $x$ and $y$, change the $\\text{gpa}$ of all nodes in the major containing student $x$ to $y$.\n\nOperation 3: given $x$, ask for student $x$’s $\\text{gpa}$, the number of students in the major containing $x$, and the resentment value of the major containing $x$.", "inputFormat": "The first line contains an integer $n$.\n\nThe second line contains $n$ integers representing the parent of each node. The $i$-th integer is $< i$, and the parent of node $1$ is $0$.\n\nThe third line contains $n$ integers representing each student’s $\\text{gpa}$.\n\nThe fourth line contains an integer $m$.\n\nThen follow $m$ lines. Each line contains two or three integers representing one operation, with types as described above.", "outputFormat": "For each operation of type $3$, output one line with three integers separated by spaces, in order: student $x$’s $\\text{gpa}$, the number of students in the major containing $x$, and the resentment value of the major containing $x$.", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078\n\nAssume there are a total of $c$ kinds of $\\text{gpa}$.\n\nFor $40\\%$ of the testdata, $n,m \\le 1000$.\n\nFor another $40\\%$ of the testdata, $n,m \\le 10^{5}$, $c=2$, and $\\text{gpa}$ is in $[1,2]$.\n\nFor $100\\%$ of the testdata, $n,m \\le 10^5$, $c=30$, and $\\text{gpa}$ is in $[1,30]$.\n\nI am too lazy to even complain about THU.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2012] 梦断 SCOI2017", "background": "", "description": "有 $n$ 个学生构成了一棵有根树，每个学生有一个 $\\text{gpa}$。\n\n定义一个学生所在的**专业**为仅保留两端学生 $\\text{gpa}$ 相同的边时，这个学生所在的连通分量。\n\n定义一个专业的**怨气值**是 $max(dep[a]-dep[b]+1)$ $s.t$. $a,b$是专业中的学生，$dep_{根}=0$，$dep_{w}=dep_{w的父亲}+1$。\n\n操作 1 ：给出 $x$ 和 $y$，把学生 $x$ 的 $\\text{gpa}$ 改成 $y$。\n\n操作 2 ：给出 $x$ 和 $y$，把学生 $x$ 所在的专业中所有点 $\\text{gpa}$ 改为 $y$。\n\n操作 3 ：给出 $x$，问学生 $x$ 的 $\\text{gpa}$，$x$ 所在专业的人数，$x$所在专业的怨气值。", "inputFormat": "第一行一个数 $n$。\n\n第二行 $n$ 个数表示每个节点的父亲，其中第 $i$ 个数 $<i$，且 $1$ 节点的父亲为 $0$。\n\n第三行 $n$ 个数表示每个学生的 $\\text{gpa}$。\n\n第四行一个数 $m$。\n\n之后 $m$ 行，每行一个两或三个数表示一次操作，类型如上述。", "outputFormat": "对于每个 $3$ 操作，输出一行三个数，中间用空格隔开，依次表示：学生 $x$ 的 $\\text{gpa}$，$x$ 所在专业的人数，$x$ 所在专业的怨气值。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n定义 $\\text{gpa}$ 共有 $c$ 种。\n\n对于 $40\\%$ 的数据，$n,m \\le 1000$。\n\n对于另外 $40\\%$ 的数据，$n,m \\le 10^{5}$，$c=2$，$\\text{gpa}$ 的范围在 $[1,2]$ 中。\n\n对于 $100\\%$ 的数据，$n,m \\le 10^5$，$c=30$，$\\text{gpa}$ 的范围在 $[1,30]$ 中。\n\n我都懒得喷 THU 了。", "locale": "zh-CN"}}}
{"pid": "P5530", "type": "P", "difficulty": 5, "samples": [["4 5 1 4\n2 1 2 1\n3 4 3 1\n2 3 1 2\n3 1 1 4\n2 4 2 4", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2002", "最短路", "BalticOI（波罗的海）"], "title": "[BalticOI 2002] 双调路径", "background": "", "description": "如今的道路收费发展很快。道路的密度越来越大，因此选择最佳路径是很现实的问题。城市的道路是双向的，每条道路有固定的旅行时间以及需要支付的费用。\n\n路径是连续经过的道路组成的。总时间是各条道路旅行时间的和，总费用是各条道路所支付费用的总和。一条路径越快，或者费用越低，该路径就越好。严格地说，如果一条路径比别的路径更快，而且不需要支付更多费用，它就比较好。反过来也如此理解。如果没有一条路径比某路径更好，则该路径被称为最小路径。\n\n这样的最小的路径有可能不止一条，或者根本不存在路径。\n\n问题：读入网络，计算最小路径的总数。费用时间都相同的两条最小路径只算作一条。你只要输出不同种类的最小路径数即可。", "inputFormat": "第一行有四个整数，城市总数 $n$，道路总数 $m$，起点和终点城市 $s,e$。\n$\\newline$\n接下来的 $m$ 行每行描述了一条道路的信息：两个端点 $p,r$，费用 $c$，以及时间 $t$；\n$\\newline$\n两个城市之间可能有多条路径连接。", "outputFormat": "输出一行一个数，表示最小路径的总数。", "hint": "**数据范围：**\n- $1\\leq{n}\\leq100$，$0\\leq{m}\\leq300$。\n- $1\\leq{s,e,p,r}\\leq{n}$，$0\\leq{c,t}\\leq100$。\n- $s\\neq{e}，p\\neq{r}$。\n\n**样例解释：**\n\n![样例输入](https://z3.ax1x.com/2021/09/24/4DN3xP.png)\n\n从 $1$ 到 $4$ 有 $4$ 条路径。为 $1\\rightarrow 2\\rightarrow 4$（费用为 $4$，时间为 $5$），$1\\rightarrow 3\\rightarrow 4$（费用为 $4$，时间为 $5$），$1\\rightarrow 2\\rightarrow 3\\rightarrow 4$（费用为 $6$，时间为 $4$），$1\\rightarrow 3\\rightarrow 2\\rightarrow 4$（费用为 $4$，时间为 $10$）。\n\n$1\\rightarrow 3\\rightarrow 4$ 和 $1\\rightarrow 2\\rightarrow 4$ 比 $1\\rightarrow 3\\rightarrow 2\\rightarrow 4$ 更好。有两种最佳路径：费用为 $4$，时间为 $5$（$1\\rightarrow 2\\rightarrow 4$ 和 $1\\rightarrow 3\\rightarrow 4$）和 费用为 $6$，时间为 $4$（$1\\rightarrow 2\\rightarrow 3\\rightarrow 4$）。", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2002] Bitonic Paths.", "background": "", "description": "Nowadays, road toll systems are developing fast. The density of roads is getting higher and higher, so choosing the best route is a very practical problem. The roads in a city are bidirectional. Each road has a fixed travel time and a fee that must be paid.\n\nA path is made up of consecutive roads. The total time is the sum of travel times of all roads on the path, and the total fee is the sum of fees paid on all roads on the path. A path is better if it is faster, or if it costs less. More strictly, if one path is faster than another path and does not require paying more, then it is better. The reverse can be understood in the same way. If no path is better than a given path, then this path is called a minimal path.\n\nSuch minimal paths may be more than one, or there may be no path at all.\n\nTask: given the network, compute the total number of minimal paths. Two minimal paths with the same fee and time are counted as one. You only need to output the number of different types of minimal paths.", "inputFormat": "The first line contains four integers: the number of cities $n$, the number of roads $m$, and the start and end cities $s, e$.\n$\\newline$\nThe next $m$ lines each describe one road: its two endpoints $p, r$, the fee $c$, and the time $t$.\n$\\newline$\nThere may be multiple roads connecting the same pair of cities.", "outputFormat": "Output one line with one integer, representing the total number of minimal paths.", "hint": "**Constraints:**\n- $1\\leq{n}\\leq100$, $0\\leq{m}\\leq300$.\n- $1\\leq{s,e,p,r}\\leq{n}$, $0\\leq{c,t}\\leq100$.\n- $s\\neq{e}$, $p\\neq{r}$.\n\n**Sample Explanation:**\n\n![Sample Input](https://z3.ax1x.com/2021/09/24/4DN3xP.png)\n\nThere are $4$ paths from $1$ to $4$: $1\\rightarrow 2\\rightarrow 4$ (fee $4$, time $5$), $1\\rightarrow 3\\rightarrow 4$ (fee $4$, time $5$), $1\\rightarrow 2\\rightarrow 3\\rightarrow 4$ (fee $6$, time $4$), and $1\\rightarrow 3\\rightarrow 2\\rightarrow 4$ (fee $4$, time $10$).\n\n$1\\rightarrow 3\\rightarrow 4$ and $1\\rightarrow 2\\rightarrow 4$ are better than $1\\rightarrow 3\\rightarrow 2\\rightarrow 4$. There are two types of best paths: fee $4$, time $5$ ($1\\rightarrow 2\\rightarrow 4$ and $1\\rightarrow 3\\rightarrow 4$), and fee $6$, time $4$ ($1\\rightarrow 2\\rightarrow 3\\rightarrow 4$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2002] 双调路径", "background": "", "description": "如今的道路收费发展很快。道路的密度越来越大，因此选择最佳路径是很现实的问题。城市的道路是双向的，每条道路有固定的旅行时间以及需要支付的费用。\n\n路径是连续经过的道路组成的。总时间是各条道路旅行时间的和，总费用是各条道路所支付费用的总和。一条路径越快，或者费用越低，该路径就越好。严格地说，如果一条路径比别的路径更快，而且不需要支付更多费用，它就比较好。反过来也如此理解。如果没有一条路径比某路径更好，则该路径被称为最小路径。\n\n这样的最小的路径有可能不止一条，或者根本不存在路径。\n\n问题：读入网络，计算最小路径的总数。费用时间都相同的两条最小路径只算作一条。你只要输出不同种类的最小路径数即可。", "inputFormat": "第一行有四个整数，城市总数 $n$，道路总数 $m$，起点和终点城市 $s,e$。\n$\\newline$\n接下来的 $m$ 行每行描述了一条道路的信息：两个端点 $p,r$，费用 $c$，以及时间 $t$；\n$\\newline$\n两个城市之间可能有多条路径连接。", "outputFormat": "输出一行一个数，表示最小路径的总数。", "hint": "**数据范围：**\n- $1\\leq{n}\\leq100$，$0\\leq{m}\\leq300$。\n- $1\\leq{s,e,p,r}\\leq{n}$，$0\\leq{c,t}\\leq100$。\n- $s\\neq{e}，p\\neq{r}$。\n\n**样例解释：**\n\n![样例输入](https://z3.ax1x.com/2021/09/24/4DN3xP.png)\n\n从 $1$ 到 $4$ 有 $4$ 条路径。为 $1\\rightarrow 2\\rightarrow 4$（费用为 $4$，时间为 $5$），$1\\rightarrow 3\\rightarrow 4$（费用为 $4$，时间为 $5$），$1\\rightarrow 2\\rightarrow 3\\rightarrow 4$（费用为 $6$，时间为 $4$），$1\\rightarrow 3\\rightarrow 2\\rightarrow 4$（费用为 $4$，时间为 $10$）。\n\n$1\\rightarrow 3\\rightarrow 4$ 和 $1\\rightarrow 2\\rightarrow 4$ 比 $1\\rightarrow 3\\rightarrow 2\\rightarrow 4$ 更好。有两种最佳路径：费用为 $4$，时间为 $5$（$1\\rightarrow 2\\rightarrow 4$ 和 $1\\rightarrow 3\\rightarrow 4$）和 费用为 $6$，时间为 $4$（$1\\rightarrow 2\\rightarrow 3\\rightarrow 4$）。", "locale": "zh-CN"}}}
