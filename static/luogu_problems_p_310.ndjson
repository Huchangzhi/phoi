{"pid": "P7276", "type": "P", "difficulty": 5, "samples": [["7 4\n1 2\n2 3\n2 4\n1 5\n5 6\n6 7\n3 4 5 7", "6"], ["1 1\n1", "0"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "送给好友的礼物", "background": "小 M 和小 B 是一对好朋友，她们很喜欢草莓。", "description": "给定一棵包含 $n$ 个结点的树 $T$，结点从 $1 \\sim n$ 顺序编号。\n\n小 M 和小 B 在时刻 $0$ 都在 $1$ 号结点。从时刻 $1$ 开始的每个时刻初，小 M 和小 B 都可以选择：移动到一个和自己所在结点直接相连的结点，或者停留在当前所在的结点。\n\n树上有 $k$ 个草莓，它们分布在 $k$ 个不同的结点上。小 M 和小 B 想要收集到所有的草莓，任何一个时刻末，如果小 M 或者小 B 在某一个草莓所在的结点上，那么这个草莓就被收集了。\n\n她们不想花费太多的时间，因此你需要回答：至少在第几时刻末，小 M 和小 B 可以收集到所有的草莓，并且都回到结点 $1$。", "inputFormat": "第一行两个整数 $n, k$（$1 \\leq k \\leq n \\leq 415$），分别表示树的结点个数和草莓的个数。  \n接下来 $n - 1$ 行，每行两个整数 $u$ 和 $v$，表示树上有一条从 $u$ 到 $v$ 的边。  \n接下来一行 $k$ 个互不相同的整数 $a_1, a_2, \\ldots , a_k$，分别表示这 $k$ 个草莓所在的结点。", "outputFormat": "一行一个整数，所求答案。", "hint": "**【样例解释 #1】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bhe4q1zn.png)\n\n小 M 的路线是：$1 \\to 2 \\to 3 \\to 2 \\to 4 \\to 2 \\to 1$。\n\n小 B 的路线是：$1 \\to 5 \\to 6 \\to 7 \\to 6 \\to 5 \\to 1$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（$6$ 分）：$n \\leq 3$。\n- Subtask 2（$1$ 分）：$k = 1$。\n- Subtask 3（$11$ 分）：$n \\leq 7$。\n- Subtask 4（$17$ 分）：$k \\leq 20$。\n- Subtask 5（$42$ 分）：$n \\leq 90$。\n- Subtask 6（$23$ 分）：无特殊限制。\n\n对于 $100 \\%$ 的数据，$1 \\leq k \\leq n \\leq 415$，$1 \\leq u, v \\leq n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "送给好友的礼物", "background": "小 M 和小 B 是一对好朋友，她们很喜欢草莓。", "description": "给定一棵包含 $n$ 个结点的树 $T$，结点从 $1 \\sim n$ 顺序编号。\n\n小 M 和小 B 在时刻 $0$ 都在 $1$ 号结点。从时刻 $1$ 开始的每个时刻初，小 M 和小 B 都可以选择：移动到一个和自己所在结点直接相连的结点，或者停留在当前所在的结点。\n\n树上有 $k$ 个草莓，它们分布在 $k$ 个不同的结点上。小 M 和小 B 想要收集到所有的草莓，任何一个时刻末，如果小 M 或者小 B 在某一个草莓所在的结点上，那么这个草莓就被收集了。\n\n她们不想花费太多的时间，因此你需要回答：至少在第几时刻末，小 M 和小 B 可以收集到所有的草莓，并且都回到结点 $1$。", "inputFormat": "第一行两个整数 $n, k$（$1 \\leq k \\leq n \\leq 415$），分别表示树的结点个数和草莓的个数。  \n接下来 $n - 1$ 行，每行两个整数 $u$ 和 $v$，表示树上有一条从 $u$ 到 $v$ 的边。  \n接下来一行 $k$ 个互不相同的整数 $a_1, a_2, \\ldots , a_k$，分别表示这 $k$ 个草莓所在的结点。", "outputFormat": "一行一个整数，所求答案。", "hint": "**【样例解释 #1】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bhe4q1zn.png)\n\n小 M 的路线是：$1 \\to 2 \\to 3 \\to 2 \\to 4 \\to 2 \\to 1$。\n\n小 B 的路线是：$1 \\to 5 \\to 6 \\to 7 \\to 6 \\to 5 \\to 1$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（$6$ 分）：$n \\leq 3$。\n- Subtask 2（$1$ 分）：$k = 1$。\n- Subtask 3（$11$ 分）：$n \\leq 7$。\n- Subtask 4（$17$ 分）：$k \\leq 20$。\n- Subtask 5（$42$ 分）：$n \\leq 90$。\n- Subtask 6（$23$ 分）：无特殊限制。\n\n对于 $100 \\%$ 的数据，$1 \\leq k \\leq n \\leq 415$，$1 \\leq u, v \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P7277", "type": "P", "difficulty": 7, "samples": [["4 4 4", "1328"], ["6 6 6", "410114"], ["10000000000 114514 100", "603074925"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "平凡点滴", "background": "少年看见他的桌上有一本书。  \n翻开着其中一页。  \n上面只有一道题。", "description": "他写下一个函数 $f(n)$。  \n它是这么定义的：  \n记 $n$ 的质因子分解式中每个质因子的最大次数为 $g(n)$，例如 $g(2)=1,g(12)=2$。  \n**注意**：本题中假设 $g(1)=1$。样例及数据已修正。  \n则 $f(n) = \\max(m-g(n)+1,0) n^k$。  \n其中 $m,k$ 都是他将给定你的参数。\n\n他希望你求出\n$$\n\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^n f(\\gcd(i,j))\n$$\n\n并对 $998244353$ 取模。", "inputFormat": "第一行，三个正整数 $n,m,k$。", "outputFormat": "一行，一个非负整数，表示答案。", "hint": "对于 $70\\%$ 的数据，$n \\le 10^7$；  \n对于 $50\\%$ 的数据，$m \\le 33$；  \n对于 $100\\%$ 的数据，$1 \\le n \\le 10^{10}$, $1 \\le m < 998244353$, $1 \\le k \\le 100$。\n\n除此之外，添加一组来自 @[cqbzljsqwq](/user/154560) 的 Hack 数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "平凡点滴", "background": "少年看见他的桌上有一本书。  \n翻开着其中一页。  \n上面只有一道题。", "description": "他写下一个函数 $f(n)$。  \n它是这么定义的：  \n记 $n$ 的质因子分解式中每个质因子的最大次数为 $g(n)$，例如 $g(2)=1,g(12)=2$。  \n**注意**：本题中假设 $g(1)=1$。样例及数据已修正。  \n则 $f(n) = \\max(m-g(n)+1,0) n^k$。  \n其中 $m,k$ 都是他将给定你的参数。\n\n他希望你求出\n$$\n\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^n f(\\gcd(i,j))\n$$\n\n并对 $998244353$ 取模。", "inputFormat": "第一行，三个正整数 $n,m,k$。", "outputFormat": "一行，一个非负整数，表示答案。", "hint": "对于 $70\\%$ 的数据，$n \\le 10^7$；  \n对于 $50\\%$ 的数据，$m \\le 33$；  \n对于 $100\\%$ 的数据，$1 \\le n \\le 10^{10}$, $1 \\le m < 998244353$, $1 \\le k \\le 100$。\n\n除此之外，添加一组来自 @[cqbzljsqwq](/user/154560) 的 Hack 数据。", "locale": "zh-CN"}}}
{"pid": "P7278", "type": "P", "difficulty": 6, "samples": [["3 2", "0"], ["4 2", "20"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "纯洁憧憬", "background": "少年对他的憧憬，简直连续不断。  \n少年的思绪，如同许多数字的排列一般凌乱。", "description": "对于一个 $n$ 阶排列 $p_1,\\dots,p_n$ 和一个区间 $[l,r]$，若 $\\max\\limits_{l\\le i\\le r} p_i - \\min\\limits_{l\\le i\\le r} p_i = r - l$，则称 $[l,r]$ 为一个**连续段**。\n\n对于一个连续段 $[l,r]$，若其满足 $2 \\le r - l + 1 < n$，则称 $[l,r]$ 为一个**非平凡连续段**。\n\n**少年的思绪**可以抽象成一个**至少存在一个**长度大于 $k$ 的非平凡连续段的排列。\n\n少年会给定 $n,k$，并询问你有多少 $n$ 阶排列可能是少年的思绪。答案对 $10^9 + 7$ 取模。", "inputFormat": "第一行，两个正整数 $n,k$。", "outputFormat": "一行，一个非负整数表示答案。", "hint": "对于 $20\\%$ 的数据，$n \\le 10$；  \n对于 $100\\%$ 的数据，$1 \\le k < n \\le 400$。\n\n#### 样例解释\n\n对于第二个样例，不满足条件的排列有以下 $4$ 种：\n1. $[2,1,4,3]$；\n1. $[2,4,1,3]$；\n1. $[3,4,1,2]$；\n1. $[3,1,4,2]$。\n\n另外 $4!-4=20$ 种方案都满足条件，可能是少年的思绪。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "纯洁憧憬", "background": "少年对他的憧憬，简直连续不断。  \n少年的思绪，如同许多数字的排列一般凌乱。", "description": "对于一个 $n$ 阶排列 $p_1,\\dots,p_n$ 和一个区间 $[l,r]$，若 $\\max\\limits_{l\\le i\\le r} p_i - \\min\\limits_{l\\le i\\le r} p_i = r - l$，则称 $[l,r]$ 为一个**连续段**。\n\n对于一个连续段 $[l,r]$，若其满足 $2 \\le r - l + 1 < n$，则称 $[l,r]$ 为一个**非平凡连续段**。\n\n**少年的思绪**可以抽象成一个**至少存在一个**长度大于 $k$ 的非平凡连续段的排列。\n\n少年会给定 $n,k$，并询问你有多少 $n$ 阶排列可能是少年的思绪。答案对 $10^9 + 7$ 取模。", "inputFormat": "第一行，两个正整数 $n,k$。", "outputFormat": "一行，一个非负整数表示答案。", "hint": "对于 $20\\%$ 的数据，$n \\le 10$；  \n对于 $100\\%$ 的数据，$1 \\le k < n \\le 400$。\n\n#### 样例解释\n\n对于第二个样例，不满足条件的排列有以下 $4$ 种：\n1. $[2,1,4,3]$；\n1. $[2,4,1,3]$；\n1. $[3,4,1,2]$；\n1. $[3,1,4,2]$。\n\n另外 $4!-4=20$ 种方案都满足条件，可能是少年的思绪。", "locale": "zh-CN"}}}
{"pid": "P7279", "type": "P", "difficulty": 6, "samples": [["5\nabcbc\n0 1 2 3 4\n2 7", "2"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "光棱碎片", "background": "碎片在少年的世界里四处飘散。  \n最后被少年收集起，成为一列仿若无意义的字符。", "description": "少年只剩一个字符串 $S$，它的长度为 $n$，下标以 $1 \\dots n$ 编号；  \n以及一个数组 $a_{1\\dots n}$。\n\n少年写出了两个数 $L,R$ 并尝试寻找那些被光芒照耀过的碎片：  \n对于 $S$ 中两个出现位置不同而本质相同的子串 $(S_{l_1\\dots r_1},S_{l_2\\dots r_2})$，若 $L \\le (a_{r_1} \\oplus a_{r_2}) + (r_1 - l_1 + 1) \\le R$，则这两个子串之间存在光芒。  \n其中 $S_{l\\dots r}$ 表示 $S$ 的下标在 $[l,r]$ 内的字符顺次连接构成的子串，$\\oplus$ 表示按位异或运算。\n\n少年试图寻找，有多少对子串之间存在光芒。  \n子串对是无序的。具体地，$(S_{l_1\\dots r_1},S_{l_2\\dots r_2})$ 和 $(S_{l_2\\dots r_2},S_{l_1\\dots r_1})$ 视为一个子串对。  \n而你只需要将答案对 $998244353$ 取模之后告诉他就行了。", "inputFormat": "第一行，一个正整数 $n$。  \n第二行，一个字符串 $S$。  \n第三行，$n$ 个非负整数 $a_{1\\dots n}$。  \n第四行，两个非负整数 $L,R$。", "outputFormat": "一行，一个非负整数，表示答案。", "hint": "对于 $20\\%$ 的数据，$n \\le 100$；    \n对于 $50\\%$ 的数据，$n \\le 10^3$；  \n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$, $0 \\le a_i,L,R \\le 10^5$, $L \\le R$, $S$ 只包含小写字母。\n\n**「出题人的馈赠」**  \n勇敢一点。相信某算法的常数。你想到的可能就是垃圾标算。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "光棱碎片", "background": "碎片在少年的世界里四处飘散。  \n最后被少年收集起，成为一列仿若无意义的字符。", "description": "少年只剩一个字符串 $S$，它的长度为 $n$，下标以 $1 \\dots n$ 编号；  \n以及一个数组 $a_{1\\dots n}$。\n\n少年写出了两个数 $L,R$ 并尝试寻找那些被光芒照耀过的碎片：  \n对于 $S$ 中两个出现位置不同而本质相同的子串 $(S_{l_1\\dots r_1},S_{l_2\\dots r_2})$，若 $L \\le (a_{r_1} \\oplus a_{r_2}) + (r_1 - l_1 + 1) \\le R$，则这两个子串之间存在光芒。  \n其中 $S_{l\\dots r}$ 表示 $S$ 的下标在 $[l,r]$ 内的字符顺次连接构成的子串，$\\oplus$ 表示按位异或运算。\n\n少年试图寻找，有多少对子串之间存在光芒。  \n子串对是无序的。具体地，$(S_{l_1\\dots r_1},S_{l_2\\dots r_2})$ 和 $(S_{l_2\\dots r_2},S_{l_1\\dots r_1})$ 视为一个子串对。  \n而你只需要将答案对 $998244353$ 取模之后告诉他就行了。", "inputFormat": "第一行，一个正整数 $n$。  \n第二行，一个字符串 $S$。  \n第三行，$n$ 个非负整数 $a_{1\\dots n}$。  \n第四行，两个非负整数 $L,R$。", "outputFormat": "一行，一个非负整数，表示答案。", "hint": "对于 $20\\%$ 的数据，$n \\le 100$；    \n对于 $50\\%$ 的数据，$n \\le 10^3$；  \n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$, $0 \\le a_i,L,R \\le 10^5$, $L \\le R$, $S$ 只包含小写字母。\n\n**「出题人的馈赠」**  \n勇敢一点。相信某算法的常数。你想到的可能就是垃圾标算。", "locale": "zh-CN"}}}
{"pid": "P7280", "type": "P", "difficulty": 2, "samples": [["1 2\n3\n1 1\n1 2\n1 3", "2"], ["2 1 2\n4\n2 1 4\n3 1 2 3\n2 3 4\n3 3 5 7", "2"], ["1 4\n3\n1 1\n1 2\n1 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #4] Pizza", "background": "在一个漫长而痛苦的一天快要结束时，Mirko 决定订一个比萨来提神。在他书桌的一堆纸中，他找到了一个附近比萨店的传单。", "description": "比萨店提供 $m$ 种不同的比萨。比萨的配料使用正整数来编号。第 $i$ 个比萨有 $k_i$ 种配料，编号分别为 $b_{i,1},b_{i,2},\\cdots,b_{i,k_i}$。\n\nMirko 在食物面前格外挑剔。他不喜欢其中的 $n$ 种配料，即编号为 $a_1,a_2,\\cdots,a_n$ 的配料，因此他想订购一个没有上述配料的比萨。求 Mirko 能订购的比萨的数量。", "inputFormat": "第一行输入一个整数 $n$，表示 Mirko 不喜欢的配料的种数。接下来输入 $n$ 个互不相同的整数 $a_i$，表示 Mirko 不喜欢配料所对应的编号。\n\n第二行输入一个整数 $m$，表示比萨的数量。\n\n接下来的 $m$ 行，第 $i$ 行输入一个整数 $k_i$，表示第 $i$ 个比萨的配料数量。接下来输入 $k_i$ 个互不相同的整数 $b_{i,j}$，表示该比萨的配料编号。\n\n不会出现两个具有完全相同配料的比萨。", "outputFormat": "输出 Mirko 能订购的比萨的数量。", "hint": "#### 数据规模与约定\n\n对于 $40\\%$ 的数据，$n=k_1=k_2=\\cdots=k_m=1$。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,a_i,k_i,b_{i,j} \\le 100$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T1 Pizza_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #4] Pizza", "background": "在一个漫长而痛苦的一天快要结束时，Mirko 决定订一个比萨来提神。在他书桌的一堆纸中，他找到了一个附近比萨店的传单。", "description": "比萨店提供 $m$ 种不同的比萨。比萨的配料使用正整数来编号。第 $i$ 个比萨有 $k_i$ 种配料，编号分别为 $b_{i,1},b_{i,2},\\cdots,b_{i,k_i}$。\n\nMirko 在食物面前格外挑剔。他不喜欢其中的 $n$ 种配料，即编号为 $a_1,a_2,\\cdots,a_n$ 的配料，因此他想订购一个没有上述配料的比萨。求 Mirko 能订购的比萨的数量。", "inputFormat": "第一行输入一个整数 $n$，表示 Mirko 不喜欢的配料的种数。接下来输入 $n$ 个互不相同的整数 $a_i$，表示 Mirko 不喜欢配料所对应的编号。\n\n第二行输入一个整数 $m$，表示比萨的数量。\n\n接下来的 $m$ 行，第 $i$ 行输入一个整数 $k_i$，表示第 $i$ 个比萨的配料数量。接下来输入 $k_i$ 个互不相同的整数 $b_{i,j}$，表示该比萨的配料编号。\n\n不会出现两个具有完全相同配料的比萨。", "outputFormat": "输出 Mirko 能订购的比萨的数量。", "hint": "#### 数据规模与约定\n\n对于 $40\\%$ 的数据，$n=k_1=k_2=\\cdots=k_m=1$。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,a_i,k_i,b_{i,j} \\le 100$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T1 Pizza_。**", "locale": "zh-CN"}}}
{"pid": "P7281", "type": "P", "difficulty": 4, "samples": [["2\n9 10 3 6\n2 5 7 9", "DA\nNE"], ["6\n1 2 3 4\n1 4 2 3\n2 3 1 4\n1 3 2 4\n19 22 55 57\n55 57 19 22", "DA\nNE\nDA\nDA\nDA\nDA"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2020", "数论", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #4] Vepar", "background": "", "description": "给定两组正整数 $\\{a,a+1,\\cdots,b\\}$ 和 $\\{c,c+1,\\cdots,d\\}$。判断 $c \\cdot (c+1)\\cdots d$ 能否被 $a \\cdot (a+1)\\cdots b$ 整除。", "inputFormat": "第一行输入一个整数 $t$，表示数据组数。\n\n接下来的 $t$ 行，输入四个整数 $a_i,b_i,c_i,d_i$。", "outputFormat": "输出共 $t$ 行。对于第 $i$ 行，如果 $c_i \\cdot (c_i+1)\\cdots d_i$ 能够被 $a_i \\cdot (a_i+1)\\cdots b_i$ 整除，就输出 `DA`，否则输出 `NE`。", "hint": "#### 样例 1 解释\n\n按照题意分别相乘得到 $9 \\times 10=90$ 和 $3 \\times 4 \\times 5 \\times 6=360$。由于 $90$ 能被 $360$ 整除，因此输出 `DA`。\n\n我们得到 $2 \\times 3 \\times 4 \\times 5=120$ 和 $7 \\times 8 \\times 9=504$。而 $120$ 不能被 $504$ 整除，因此输出 `NE`。\n\n#### 数据规模与约定\n\n本题**不采用捆绑评测**，通过对应测试点就可以拿到对应的分数，但有若干个约束。\n\n| 约束编号 | 分值 | 数据范围及约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $10$ | $a_i,b_i,c_i,d_i \\le 50$ |\n| $2$ | $20$ | $a_i,b_i,c_i,d_i \\le 1000$ |\n| $3$ | $10$ | $a_i=1$ |\n| $4$ | $30$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le t \\le 10$，$1 \\le a_i \\le b_i \\le 10^7$，$1 \\le c_i \\le d_i \\le 10^7$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T2 Vepar_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #4] Vepar", "background": "", "description": "给定两组正整数 $\\{a,a+1,\\cdots,b\\}$ 和 $\\{c,c+1,\\cdots,d\\}$。判断 $c \\cdot (c+1)\\cdots d$ 能否被 $a \\cdot (a+1)\\cdots b$ 整除。", "inputFormat": "第一行输入一个整数 $t$，表示数据组数。\n\n接下来的 $t$ 行，输入四个整数 $a_i,b_i,c_i,d_i$。", "outputFormat": "输出共 $t$ 行。对于第 $i$ 行，如果 $c_i \\cdot (c_i+1)\\cdots d_i$ 能够被 $a_i \\cdot (a_i+1)\\cdots b_i$ 整除，就输出 `DA`，否则输出 `NE`。", "hint": "#### 样例 1 解释\n\n按照题意分别相乘得到 $9 \\times 10=90$ 和 $3 \\times 4 \\times 5 \\times 6=360$。由于 $90$ 能被 $360$ 整除，因此输出 `DA`。\n\n我们得到 $2 \\times 3 \\times 4 \\times 5=120$ 和 $7 \\times 8 \\times 9=504$。而 $120$ 不能被 $504$ 整除，因此输出 `NE`。\n\n#### 数据规模与约定\n\n本题**不采用捆绑评测**，通过对应测试点就可以拿到对应的分数，但有若干个约束。\n\n| 约束编号 | 分值 | 数据范围及约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $10$ | $a_i,b_i,c_i,d_i \\le 50$ |\n| $2$ | $20$ | $a_i,b_i,c_i,d_i \\le 1000$ |\n| $3$ | $10$ | $a_i=1$ |\n| $4$ | $30$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le t \\le 10$，$1 \\le a_i \\le b_i \\le 10^7$，$1 \\le c_i \\le d_i \\le 10^7$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T2 Vepar_。**", "locale": "zh-CN"}}}
{"pid": "P7282", "type": "P", "difficulty": 4, "samples": [["8\n3 4 6 9 12 18 36 72", "1\n2 3\n1 2 3\n1 2 3 1\n2 3 1 2 3\n1 2 3 1 2 3\n1 2 3 1 2 3 1"], ["2\n10 101", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2020", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #4] Hop", "background": "> 杰瑞米是一个牛蛙，是我的一个好朋友。", "description": "有 $n$ 片百合花，它们分别从 $1$ 到 $n$ 依次编号。第 $i$ 片上有一个整数 $x_i$，而序列 $(x_i)_{1 \\le i \\le n}$ 单调递增。\n\n三只青蛙到来。\n\n每对满足 $a \\lt b$ 的百合 $(a,b)$ 必须属于青蛙 $1,2$ 或 $3$ 中的其中一只。\n\n当百合 $(i,j)$ 属于一只青蛙且 $x_j$ 能被 $x_i$ 整除时（$j \\gt i$），该青蛙可以从 $i$ 号百合跳动到第 $j$ 号。\n\n请找出一种分类方案，使得任何一只青蛙都不会连续跳动超过 $3$ 次。", "inputFormat": "第一行输入一个正整数 $n$，表示百合花的数量。\n\n第二行输入 $n$ 个正整数 $x_i$，表示百合花上的整数。", "outputFormat": "输出 $n-1$ 行。第 $i$ 行输出 $i$ 个整数，其中该行第 $j$ 个整数表示 $(j,i+1)$ 所归属的青蛙。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d4bitfzs.png)\n\n青蛙 $1,2,3$ 分别用蓝、绿和红色代替。\n\n蓝蛙可以从 $x_1=3$ 跳动到 $x_4=9$，再跳动到 $x_7=36$，再到 $x_8=72$。该青蛙只能进行 $3$ 次连续的跳动。\n\n绿蛙可以从 $x_2=4$ 跳动到 $x_5=12$，再跳动到 $x_7=36$。该青蛙只能进行 $2$ 次连续的跳动。\n\n红蛙不能从 $x_2=4$ 跳动到 $x_3=6$，因为 $6$ 不能被 $4$ 整除。\n\n#### 数据规模与约定\n\n**本题采用捆绑评测。**\n\n| Subtask | 分值 | 数据范围及约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $10$ | $n \\le 30$ |\n| $2$ | $100$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 1000$，$1 \\le x_i \\le 10^{18}$。\n\n#### 评分方式\n\n在输出方案中，如果其中一只青蛙可以连续跳动 $k$ 次，其中 $k \\gt 3$，而没有青蛙可以连续跳动 $k+1$ 次，则对应测试点的分数为 $f(k)·x$ 分，其中：\n\n$$f(k)=\\dfrac{1}{10}·\n\\begin{cases}\n11-k & (4 \\le k \\le 5) \\cr\n8-\\lfloor {\\dfrac{k}{2}} \\rfloor & (6 \\le k \\le 11) \\cr\n1 & (12 \\le k \\le 19) \\cr\n0 & (k \\ge 20) \\cr\n\\end{cases}$$\n\n而 $x$ 为对应子任务的总分。每个子任务的得分等于该子任务中所有测试点得分的最小值。\n\n因本题的评分方式特殊，因而启用非官方的自行编写的 [Special Judge](https://www.luogu.com.cn/paste/mfhbmugl)，也可以在附件中下载。欢迎大家 hack（可私信或直接发帖）。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T3 Hop_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #4] Hop", "background": "> 杰瑞米是一个牛蛙，是我的一个好朋友。", "description": "有 $n$ 片百合花，它们分别从 $1$ 到 $n$ 依次编号。第 $i$ 片上有一个整数 $x_i$，而序列 $(x_i)_{1 \\le i \\le n}$ 单调递增。\n\n三只青蛙到来。\n\n每对满足 $a \\lt b$ 的百合 $(a,b)$ 必须属于青蛙 $1,2$ 或 $3$ 中的其中一只。\n\n当百合 $(i,j)$ 属于一只青蛙且 $x_j$ 能被 $x_i$ 整除时（$j \\gt i$），该青蛙可以从 $i$ 号百合跳动到第 $j$ 号。\n\n请找出一种分类方案，使得任何一只青蛙都不会连续跳动超过 $3$ 次。", "inputFormat": "第一行输入一个正整数 $n$，表示百合花的数量。\n\n第二行输入 $n$ 个正整数 $x_i$，表示百合花上的整数。", "outputFormat": "输出 $n-1$ 行。第 $i$ 行输出 $i$ 个整数，其中该行第 $j$ 个整数表示 $(j,i+1)$ 所归属的青蛙。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d4bitfzs.png)\n\n青蛙 $1,2,3$ 分别用蓝、绿和红色代替。\n\n蓝蛙可以从 $x_1=3$ 跳动到 $x_4=9$，再跳动到 $x_7=36$，再到 $x_8=72$。该青蛙只能进行 $3$ 次连续的跳动。\n\n绿蛙可以从 $x_2=4$ 跳动到 $x_5=12$，再跳动到 $x_7=36$。该青蛙只能进行 $2$ 次连续的跳动。\n\n红蛙不能从 $x_2=4$ 跳动到 $x_3=6$，因为 $6$ 不能被 $4$ 整除。\n\n#### 数据规模与约定\n\n**本题采用捆绑评测。**\n\n| Subtask | 分值 | 数据范围及约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $10$ | $n \\le 30$ |\n| $2$ | $100$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 1000$，$1 \\le x_i \\le 10^{18}$。\n\n#### 评分方式\n\n在输出方案中，如果其中一只青蛙可以连续跳动 $k$ 次，其中 $k \\gt 3$，而没有青蛙可以连续跳动 $k+1$ 次，则对应测试点的分数为 $f(k)·x$ 分，其中：\n\n$$f(k)=\\dfrac{1}{10}·\n\\begin{cases}\n11-k & (4 \\le k \\le 5) \\cr\n8-\\lfloor {\\dfrac{k}{2}} \\rfloor & (6 \\le k \\le 11) \\cr\n1 & (12 \\le k \\le 19) \\cr\n0 & (k \\ge 20) \\cr\n\\end{cases}$$\n\n而 $x$ 为对应子任务的总分。每个子任务的得分等于该子任务中所有测试点得分的最小值。\n\n因本题的评分方式特殊，因而启用非官方的自行编写的 [Special Judge](https://www.luogu.com.cn/paste/mfhbmugl)，也可以在附件中下载。欢迎大家 hack（可私信或直接发帖）。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T3 Hop_。**", "locale": "zh-CN"}}}
{"pid": "P7283", "type": "P", "difficulty": 6, "samples": [["3 1\n1 2 3\n1 3 2", "6"], ["4 1\n1 2 1\n2 3 2\n3 4 3", "6"], ["5 2\n1 2 2\n1 3 3\n3 4 2\n3 5 4", "8"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #4] Janjetina", "background": "疫情封禁期间，克罗地亚的所有餐厅均被关闭。\n\nMalnar 先生为此十分伤感。但他不久发现并没有必要感到如此伤心，因此他决定将在封禁结束后周游克罗地亚，并在最好的餐厅中享用最美味的羊肉。", "description": "Malnar 先生将访问 $n$ 个城市，分别用整数 $1$ 到 $n$ 表示。同时，他经过调研发现，有 $n-1$ 条连接其中两个城市的双向路。\n\n每条路上均有一家提供羊肉的餐厅，同时给定每个餐厅可以订购的最大羊肉的重量。\n\n他将选择两个城市 $x$ 和 $y$，并以最短路径（指经过的最少的路）从 $x$ 到达 $y$。他将且仅将在一家餐厅停留，且这家餐厅为可提供羊肉重量最多的一家（如果有多家这样的餐厅，他将会选择任意一家），并将订购的羊肉全部吃光。\n\n如果通过一种长度为 $l$ 的路径可以吃到 $w$ 千克的羊肉，且 $w-l \\ge k$，那么 Malnar 先生就称之为**满意的**。一种路径的长度等同于其经过路的条数。\n\n求有多少个有序数对 $(x,y)$，使得从 $x$ 到 $y$ 的最短路径是满意的。", "inputFormat": "第一行输入整数 $n,k$，其中 $n$ 表示城市的个数。\n\n接下来的 $n-1$ 行，每行输入三个整数 $x,y,w$，表示有一条连接城市 $x,y$ 的路，且这条道路有一家提供 $w$ 千克羊肉的餐厅。", "outputFormat": "输出满足题意的有序数对的个数。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/orifach0.png)\n\n满足题意的有序数对有 $(1,3),(3,1),(1,5),(5,1),(3,5),(5,3),(4,5),(5,4)$。\n\n#### 数据规模与约定\n\n**本题采用捆绑评测。**\n\n| Subtask | 分值 | 数据范围及约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $15$ | $1 \\le n \\le 1000$ |\n| $2$ | $35$ | 城市 $i$ 和 $i+1$ （$1 \\le i \\le n-1$）直接相连（即最短距离为 $1$） |\n| $2$ | $60$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le n,k,w \\le 10^5$，$1 \\le x,y \\le n,x \\neq y$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T4 Janjetina_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #4] Janjetina", "background": "疫情封禁期间，克罗地亚的所有餐厅均被关闭。\n\nMalnar 先生为此十分伤感。但他不久发现并没有必要感到如此伤心，因此他决定将在封禁结束后周游克罗地亚，并在最好的餐厅中享用最美味的羊肉。", "description": "Malnar 先生将访问 $n$ 个城市，分别用整数 $1$ 到 $n$ 表示。同时，他经过调研发现，有 $n-1$ 条连接其中两个城市的双向路。\n\n每条路上均有一家提供羊肉的餐厅，同时给定每个餐厅可以订购的最大羊肉的重量。\n\n他将选择两个城市 $x$ 和 $y$，并以最短路径（指经过的最少的路）从 $x$ 到达 $y$。他将且仅将在一家餐厅停留，且这家餐厅为可提供羊肉重量最多的一家（如果有多家这样的餐厅，他将会选择任意一家），并将订购的羊肉全部吃光。\n\n如果通过一种长度为 $l$ 的路径可以吃到 $w$ 千克的羊肉，且 $w-l \\ge k$，那么 Malnar 先生就称之为**满意的**。一种路径的长度等同于其经过路的条数。\n\n求有多少个有序数对 $(x,y)$，使得从 $x$ 到 $y$ 的最短路径是满意的。", "inputFormat": "第一行输入整数 $n,k$，其中 $n$ 表示城市的个数。\n\n接下来的 $n-1$ 行，每行输入三个整数 $x,y,w$，表示有一条连接城市 $x,y$ 的路，且这条道路有一家提供 $w$ 千克羊肉的餐厅。", "outputFormat": "输出满足题意的有序数对的个数。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/orifach0.png)\n\n满足题意的有序数对有 $(1,3),(3,1),(1,5),(5,1),(3,5),(5,3),(4,5),(5,4)$。\n\n#### 数据规模与约定\n\n**本题采用捆绑评测。**\n\n| Subtask | 分值 | 数据范围及约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $15$ | $1 \\le n \\le 1000$ |\n| $2$ | $35$ | 城市 $i$ 和 $i+1$ （$1 \\le i \\le n-1$）直接相连（即最短距离为 $1$） |\n| $2$ | $60$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le n,k,w \\le 10^5$，$1 \\le x,y \\le n,x \\neq y$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T4 Janjetina_。**", "locale": "zh-CN"}}}
{"pid": "P7284", "type": "P", "difficulty": 4, "samples": [["3 3\n>vo\nvv>\nx>>", "1\n>vo\nvv>\nx<>"], ["3 6\n>>vv<<\n^ovvx^\n^<<>>^", "2\n>>vv<<\n^o>>x^\n^<<>>^"], ["4 4\nx.v.\n.>.<\n>.<.\n.^.o", "4\nx<<.\n.>^<\n>.<^\n.^.o"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "Special Judge", "O2优化", "广度优先搜索 BFS", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #4] Patkice II", "background": "", "description": "Netflix 的经商人员想要制作一个有关三只鸭子之旅的系列改编。\n\n在 COCI20/21 的第一轮中，鸭子们位于一个洋流的地图中，鸭子们一同出行。鸭子们的起始岛屿用 `o` 表示。鸭子们可以往四个方向进行旅行，分别是：西 $\\to$ 东（`>`），东 $\\to$ 西（`<`），北 $\\to$ 南（`v`） 和南 $\\to$ 北（`^`）。当鸭子们位于洋流的点上时，它们将会向洋流的方向移动一个单位。\n\n平静的海面用 `.` 表示。如果洋流把鸭子们带到了平静的海面、到达地图之外或者回到起始小岛处，它们就会停止旅行。鸭子们想要前往的目的地岛屿用 `x` 表示。\n\n为了让情节更加吸引人，Netflix 进行了改编：现在海面上可能会出现旋涡（鸭子们可能会困在其中）和可把鸭子带到地图之外的洋流。\n\n因此，原先地图被迫改变。但在即将到来的截止期的情况下，导演犯了几个错误：鸭子们不能再通过洋流到达目的地岛屿。\n\nNetflix 导演是非常重要的人，因此他们并不花时间思考情节漏洞。你的任务是替换地图中的几个字符，使得鸭子们能够从起始岛屿到达目的地岛屿。\n\n因情节需要，字符 `o` 和 `x` 不能被修改。其他字符（`<>v^.`）分别表示洋流和平静的海面。你可以用 `<>v^.` 中的任意字符来替换原先地图中 `<>v^.` 的任意字符。", "inputFormat": "第一行输入两个整数 $r$ 和 $s$，分别表示地图的行数和列数。\n\n接下来的 $r$ 行，每行包含 $s$ 个字符，字符必为 `o<>v^.x` 中的其中一个。保证地图上分别只有一个 `o` 和 `x`，并且它们不相邻。", "outputFormat": "第一行输出 $k$，表示需要进行改变的字符的最少数量。\n\n接下来的 $r$ 行，每行输出 $s$ 个字符，表示改变后的地图。\n\n如果有多种符合题意的地图，请输出任意一种。", "hint": "#### 数据规模与约定\n\n**本题采用捆绑评测，自动开启 O2 优化。**\n\n| Subtask | 分值 | 数据范围及约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $30$ | $3 \\le r,s \\le 20$ |\n| $2$ | $80$ | 无 |\n\n对于 $100\\%$ 的数据，$3 \\le r,s \\le 2000$。\n\n#### 评分方式\n\n如果一个子任务中的所有数据中，第一行均正确，那么可以得到该子任务一半的分数。\n\n本题启用非官方的自行编写的 [Special Judge](https://www.luogu.com.cn/paste/d4nbx1ua)，也可以在附件中下载。欢迎大家 hack（可私信或直接发帖）。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T5 Patkice II_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #4] Patkice II", "background": "", "description": "Netflix 的经商人员想要制作一个有关三只鸭子之旅的系列改编。\n\n在 COCI20/21 的第一轮中，鸭子们位于一个洋流的地图中，鸭子们一同出行。鸭子们的起始岛屿用 `o` 表示。鸭子们可以往四个方向进行旅行，分别是：西 $\\to$ 东（`>`），东 $\\to$ 西（`<`），北 $\\to$ 南（`v`） 和南 $\\to$ 北（`^`）。当鸭子们位于洋流的点上时，它们将会向洋流的方向移动一个单位。\n\n平静的海面用 `.` 表示。如果洋流把鸭子们带到了平静的海面、到达地图之外或者回到起始小岛处，它们就会停止旅行。鸭子们想要前往的目的地岛屿用 `x` 表示。\n\n为了让情节更加吸引人，Netflix 进行了改编：现在海面上可能会出现旋涡（鸭子们可能会困在其中）和可把鸭子带到地图之外的洋流。\n\n因此，原先地图被迫改变。但在即将到来的截止期的情况下，导演犯了几个错误：鸭子们不能再通过洋流到达目的地岛屿。\n\nNetflix 导演是非常重要的人，因此他们并不花时间思考情节漏洞。你的任务是替换地图中的几个字符，使得鸭子们能够从起始岛屿到达目的地岛屿。\n\n因情节需要，字符 `o` 和 `x` 不能被修改。其他字符（`<>v^.`）分别表示洋流和平静的海面。你可以用 `<>v^.` 中的任意字符来替换原先地图中 `<>v^.` 的任意字符。", "inputFormat": "第一行输入两个整数 $r$ 和 $s$，分别表示地图的行数和列数。\n\n接下来的 $r$ 行，每行包含 $s$ 个字符，字符必为 `o<>v^.x` 中的其中一个。保证地图上分别只有一个 `o` 和 `x`，并且它们不相邻。", "outputFormat": "第一行输出 $k$，表示需要进行改变的字符的最少数量。\n\n接下来的 $r$ 行，每行输出 $s$ 个字符，表示改变后的地图。\n\n如果有多种符合题意的地图，请输出任意一种。", "hint": "#### 数据规模与约定\n\n**本题采用捆绑评测，自动开启 O2 优化。**\n\n| Subtask | 分值 | 数据范围及约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $30$ | $3 \\le r,s \\le 20$ |\n| $2$ | $80$ | 无 |\n\n对于 $100\\%$ 的数据，$3 \\le r,s \\le 2000$。\n\n#### 评分方式\n\n如果一个子任务中的所有数据中，第一行均正确，那么可以得到该子任务一半的分数。\n\n本题启用非官方的自行编写的 [Special Judge](https://www.luogu.com.cn/paste/d4nbx1ua)，也可以在附件中下载。欢迎大家 hack（可私信或直接发帖）。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T5 Patkice II_。**", "locale": "zh-CN"}}}
{"pid": "P7285", "type": "P", "difficulty": 1, "samples": [["1\n1\n1", "1\n1"], ["2\n3\n1 0 1\n5\n0 1 0 1 0", "2\n1 1 1\n2\n0 1 1 1 1"]], "limits": {"time": [1000, 1000, 1000], "memory": [131072, 131072, 131072]}, "tags": ["贪心", "Special Judge", "构造", "洛谷月赛"], "title": "「EZEC-5」修改数组", "background": "", "description": "给定一个长度为 $n$、元素由 $0$ 或 $1$ 组成的数组。\n\n现在可以**选择若干（可以为 0）个值为 $0$ 的元素，将其修改为 $1$**。\n\n记：\n\n- $x$ 为数组中最长连续 $1$ 子段的长度（规定，若所有数均为 $0$，则 $x$ 为 $0$）；\n- $y$ 为修改的元素的个数。\n\n\n\n求要怎么修改才能使 $x-y$ **最大**，并构造一个方案（输出修改后的数组）。", "inputFormat": "**本题含有多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。\n\n接下来 $2\\times T$ 行，每 $2$ 行表示一组数据。\n\n在一组数据中，第一行一个整数 $n$，表示数组的长度；\n\n第二行 $n$ 个整数（0 或 1），表示给定的数组。", "outputFormat": "共 $2\\times T$ 行，每 $2$ 行表示一组数据。\n\n在一组数据中，第一行输出一个整数表示 $x-y$ 的最大值；\n\n第二行 $n$ 个整数（0 或 1）表示修改以后的数组。**如有多个方案，任意输出一种即可。**", "hint": "**本题采用捆绑测试。**\n\n对于所有数据，保证 $T\\le10,1\\le n\\le 10^5$，数组元素 $\\in \\{0,1\\}$。\n\n- Subtask 1(70 points)：保证 $1\\le n\\le 10$；\n- Subtask 2(30 points)：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-5」修改数组", "background": "", "description": "给定一个长度为 $n$、元素由 $0$ 或 $1$ 组成的数组。\n\n现在可以**选择若干（可以为 0）个值为 $0$ 的元素，将其修改为 $1$**。\n\n记：\n\n- $x$ 为数组中最长连续 $1$ 子段的长度（规定，若所有数均为 $0$，则 $x$ 为 $0$）；\n- $y$ 为修改的元素的个数。\n\n\n\n求要怎么修改才能使 $x-y$ **最大**，并构造一个方案（输出修改后的数组）。", "inputFormat": "**本题含有多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。\n\n接下来 $2\\times T$ 行，每 $2$ 行表示一组数据。\n\n在一组数据中，第一行一个整数 $n$，表示数组的长度；\n\n第二行 $n$ 个整数（0 或 1），表示给定的数组。", "outputFormat": "共 $2\\times T$ 行，每 $2$ 行表示一组数据。\n\n在一组数据中，第一行输出一个整数表示 $x-y$ 的最大值；\n\n第二行 $n$ 个整数（0 或 1）表示修改以后的数组。**如有多个方案，任意输出一种即可。**", "hint": "**本题采用捆绑测试。**\n\n对于所有数据，保证 $T\\le10,1\\le n\\le 10^5$，数组元素 $\\in \\{0,1\\}$。\n\n- Subtask 1(70 points)：保证 $1\\le n\\le 10$；\n- Subtask 2(30 points)：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7286", "type": "P", "difficulty": 3, "samples": [["3\n3 2 1", "6"], ["5\n3 4 5 4 3", "28"]], "limits": {"time": [700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷月赛"], "title": "「EZEC-5」人赢", "background": "> “我们在 小 Z 面前秀个恩爱吧。”\\\n>“好的。”\n\n小 Z 发现他身边都是人赢，这使他非常自闭。\n\n小 Z 又看着身边的潇，不禁陷入了沉思……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b1ij58kc.png)", "description": "潇有一个数组 $k$，下标为 $1$ 到 $n$ 。\n\n潇定义 $f(x,y)=\\begin{cases} \\min(k_x,k_y) \\times (x + y) &x \\ne y \\\\ k_x\\times x&x=y \\end{cases}$ 。\n\n潇想知道对于任意的 $1 \\le x,y \\le n$，$f(x,y)$ 的最大值是多少。但是她不会做，于是就问了善良的小 Z，然而非常想在妹子面前表现的小 Z 发现他也不会做，就只能够求助善良的你了。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $k$，第 $i$ 个整数为 $k_i$。含义如上文。", "outputFormat": "一行一个整数，表示对于任意的 $1 \\le x,y \\le n$，$f(x,y)$ 的最大值。", "hint": "### 数据范围\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 points）：$1 \\le n \\le 5000$。\n\n- Subtask 2（10 points）：保证所有 $k_{i}$ 都相等。\n\n- Subtask 3（20 points）：$k_i \\le 10^3$。\n\n- Subtask 4（50 points）：无特殊性质。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$，$1 \\le k_{i} \\le 10^9$。\n\n------------\n\n本题加强版：[link](https://www.luogu.com.cn/problem/P7291)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-5」人赢", "background": "> “我们在 小 Z 面前秀个恩爱吧。”\\\n>“好的。”\n\n小 Z 发现他身边都是人赢，这使他非常自闭。\n\n小 Z 又看着身边的潇，不禁陷入了沉思……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b1ij58kc.png)", "description": "潇有一个数组 $k$，下标为 $1$ 到 $n$ 。\n\n潇定义 $f(x,y)=\\begin{cases} \\min(k_x,k_y) \\times (x + y) &x \\ne y \\\\ k_x\\times x&x=y \\end{cases}$ 。\n\n潇想知道对于任意的 $1 \\le x,y \\le n$，$f(x,y)$ 的最大值是多少。但是她不会做，于是就问了善良的小 Z，然而非常想在妹子面前表现的小 Z 发现他也不会做，就只能够求助善良的你了。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $k$，第 $i$ 个整数为 $k_i$。含义如上文。", "outputFormat": "一行一个整数，表示对于任意的 $1 \\le x,y \\le n$，$f(x,y)$ 的最大值。", "hint": "### 数据范围\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 points）：$1 \\le n \\le 5000$。\n\n- Subtask 2（10 points）：保证所有 $k_{i}$ 都相等。\n\n- Subtask 3（20 points）：$k_i \\le 10^3$。\n\n- Subtask 4（50 points）：无特殊性质。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$，$1 \\le k_{i} \\le 10^9$。\n\n------------\n\n本题加强版：[link](https://www.luogu.com.cn/problem/P7291)。", "locale": "zh-CN"}}}
{"pid": "P7287", "type": "P", "difficulty": 5, "samples": [["5 2 3 102\n-3 -1 1 -2 0", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "二分", "O2优化", "洛谷月赛"], "title": "「EZEC-5」魔法", "background": "", "description": "小明是一个魔法师。\n\n他有一个可以被施魔法的数列 $A$ 。\n\n他有两种魔法：\n\n1. 花费 $a$ 魔法值，选择 $A$ 中的一个区间 $[l,r]$ ，将 $A_{l},A_{l+1}...A_{r}$ 全部 $+1$ 。\n2. 花费 $b$ 魔法值，选择 $A$ 中的一个区间 $[l,r]$ ，将 $A_{l},A_{l+1}...A_{r}$ 全部 $\\times 2$ 。\n\n现在小明想对 $A$ 序列施若干次魔法，使其存在一个子区间元素之和不小于 $s$ 。请求出小明需要花费的最小魔法值。", "inputFormat": "第一行四个整数 $n,a,b,s$，表示序列长度，两种魔法的代价，以及元素之和的要求。\n\n接下来一行 $n$ 个整数，表示初始序列。", "outputFormat": "一个整数，表示最小花费。", "hint": "【本题开启捆绑测试】\n\n对于 $10\\%$ 的数据，$n \\leq 5， |A_i|,s\\le 100$。\n\n对于另外 $20\\%$ 的数据，$n = 10^3$。\n\n对于另外 $5\\%$ 的数据，$A_i \\ge 0$。\n\n对于另外 $25\\%$ 的数据，$a,b \\le 3$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^{5}$ , $1 \\leq a,b \\leq 10^9$ , $- 10^{9} \\leq A_{i} \\leq  10^{9}$ , $1 \\leq s \\leq 10^{9}$\n\n【样例解释】：\n\n对于样例，最佳方法之一为使用一次魔法 1 改变 (1,4)，三次魔法 1 改变 (2,5)，三次魔法 2 改变 (2,5)。\n\n```\n-3 -1 1 -2 0\n\n-2 0 2 -1 0\n-2 1 3 0 1\n-2 2 4 1 2\n-2 3 5 2 3\n-2 6 10 4 6\n-2 12 20 8 12\n-2 24 40 16 24\n\n-2+24+40+16+24 >= 102\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-5」魔法", "background": "", "description": "小明是一个魔法师。\n\n他有一个可以被施魔法的数列 $A$ 。\n\n他有两种魔法：\n\n1. 花费 $a$ 魔法值，选择 $A$ 中的一个区间 $[l,r]$ ，将 $A_{l},A_{l+1}...A_{r}$ 全部 $+1$ 。\n2. 花费 $b$ 魔法值，选择 $A$ 中的一个区间 $[l,r]$ ，将 $A_{l},A_{l+1}...A_{r}$ 全部 $\\times 2$ 。\n\n现在小明想对 $A$ 序列施若干次魔法，使其存在一个子区间元素之和不小于 $s$ 。请求出小明需要花费的最小魔法值。", "inputFormat": "第一行四个整数 $n,a,b,s$，表示序列长度，两种魔法的代价，以及元素之和的要求。\n\n接下来一行 $n$ 个整数，表示初始序列。", "outputFormat": "一个整数，表示最小花费。", "hint": "【本题开启捆绑测试】\n\n对于 $10\\%$ 的数据，$n \\leq 5， |A_i|,s\\le 100$。\n\n对于另外 $20\\%$ 的数据，$n = 10^3$。\n\n对于另外 $5\\%$ 的数据，$A_i \\ge 0$。\n\n对于另外 $25\\%$ 的数据，$a,b \\le 3$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^{5}$ , $1 \\leq a,b \\leq 10^9$ , $- 10^{9} \\leq A_{i} \\leq  10^{9}$ , $1 \\leq s \\leq 10^{9}$\n\n【样例解释】：\n\n对于样例，最佳方法之一为使用一次魔法 1 改变 (1,4)，三次魔法 1 改变 (2,5)，三次魔法 2 改变 (2,5)。\n\n```\n-3 -1 1 -2 0\n\n-2 0 2 -1 0\n-2 1 3 0 1\n-2 2 4 1 2\n-2 3 5 2 3\n-2 6 10 4 6\n-2 12 20 8 12\n-2 24 40 16 24\n\n-2+24+40+16+24 >= 102\n```", "locale": "zh-CN"}}}
{"pid": "P7288", "type": "P", "difficulty": 5, "samples": [["4 3\n1 2 3 4\n1 2\n2 3\n3 4\n1\n2\n3\n", "140\n40"], ["7 2\n1 1 1 1 1 1 1\n1 2\n1 3\n2 6\n2 4\n1 5\n3 7\n2\n6", "70\n52"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "洛谷月赛"], "title": "「EZEC-5」树木的愤怒", "background": "小 L 总是在卑微地被强大的人吊打，其中包括小 Y。", "description": "小 L 和 小 Y 是好朋友。有一天，小 L 拿来了一棵 $n$ 个点的有权值的树。第 $u$ 个点的权值为 $a_u$。但是小 Y 讨厌树，所以二话不说直接把树上的一条边给断了。\n\n小 L 很愤怒，但是为了保持该有礼貌，他决定做好事情后再把这条边连起来。但是，他总是操作失误，导致不但没法连起来，还会有另一条边被断掉。于是，这棵树就被分成了 $3$ 个连通块。\n\n小 Y 看不下去了，于是在割掉边后，开始思考一个对他来说很难的问题。他想知道，在割掉第 $x$ 条边后，由于小 L 还会因为操作失误割掉一条边，则最后所形成的 **3 个连通块的权值和的乘积的所有情况的总和** 是多少。即设这三个连通块分别为 $a,b,c$，求在已经割掉一条边的情况下 \n\n$$\n(\\sum_{u\\in a} a_u)\\times (\\sum_{u\\in b} a_u) \\times (\\sum_{u\\in c} a_u)\n$$\n\n的总和。\n\n由于愤怒，每次你算好后，小 L 都会对你帮助小 Y 算出的答案不理不顾，于是小 Y 只好把图恢复到原来那棵树，再割掉一条边，你也得再帮助小 Y 算一次，即再进行一次可能不一样的询问。你需要这样帮助小 Y 一共 $q$ 次，即回答 $q$ 个询问。又因为小 L 和小 Y 都很讨厌太大的数，所以请你用输出这个总和对 $99991$ 取模的结果。又因为输出太耗费时间，你只需要输出所有询问的答案对 $99991$ 取模的总和以及异或和即可。", "inputFormat": "第一行两个正整数 $n, q$。\n\n第二行 $n$ 个非负整数代表 $a_{1,2,...,n}$。\n\n后面 $n-1$ 行中，第 $i$ 行两个正整数 $(u,v)$ 代表第 $i$ 条边 $(u,v)$。\n\n后面 $q$ 个正整数，第 $i$ 个代表第 $i$ 次询问所割掉的边。注意，各个询问是独立的。\n\n", "outputFormat": "输出一共两行。\n\n第一行输出所有的答案对 $99991$ 取模后的和（注意，最终输出可能大于等于 $99991$）。\n\n第二行输出所有的答案对 $99991$ 取模后的异或和。", "hint": "**样例说明**\n\n对于样例一的第一个询问。已经割掉了第一条边（即边 $(1,2)$）。若小 L 再割掉的边是 $(2,3)$，那么 3 个连通块的权值和的乘积为 $1\\times 2\\times (3+4)=14$。若小 L 再割掉的边是 $(3,4)$，那么 3 个连通块的权值和的乘积为 $1\\times (2+3)\\times 4=20$。所以输出为 $14+20=34$。\n\n对于样例一的第二个询问。已经割掉了第二条边（即边 $(2,3)$）。若小 L 再割掉的边是 $(1,2)$，那么 3 个连通块的权值和的乘积为 $1\\times 2\\times (3+4)=14$。若小 L 再割掉的边是 $(3,4)$，那么 3 个连通块的权值和的乘积为 $(1+2)\\times 3\\times 4=36$。所以输出为 $14+36=50$。\n\n同理，我们可以求出样例一的第三个询问，答案为 $20+36=56$。\n\n所以三个答案的总和是 $140$，异或和是 $40$。\n\n---\n**数据规模**\n\n$\\texttt{Subtask 1 (1 pts) } a_i=0$。  \n$\\texttt{Subtask 2 (5 pts) } n,q\\le 300$。  \n$\\texttt{Subtask 3 (14 pts) } n\\le 300$。  \n$\\texttt{Subtask 4 (20 pts) } n\\le 5000$。  \n$\\texttt{Subtask 5 (10 pts) } u=v-1$。  \n$\\texttt{Subtask 6 (50 pts) }$ 没有特殊限制。\n\n对于全部数据，满足 $2 \\le n, q \\le {10}^6$，$0 \\le a_i \\le {10}^6$。\n\n---\n\nidea by lgswdn  \ntested by LHQing, Karry5307", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-5」树木的愤怒", "background": "小 L 总是在卑微地被强大的人吊打，其中包括小 Y。", "description": "小 L 和 小 Y 是好朋友。有一天，小 L 拿来了一棵 $n$ 个点的有权值的树。第 $u$ 个点的权值为 $a_u$。但是小 Y 讨厌树，所以二话不说直接把树上的一条边给断了。\n\n小 L 很愤怒，但是为了保持该有礼貌，他决定做好事情后再把这条边连起来。但是，他总是操作失误，导致不但没法连起来，还会有另一条边被断掉。于是，这棵树就被分成了 $3$ 个连通块。\n\n小 Y 看不下去了，于是在割掉边后，开始思考一个对他来说很难的问题。他想知道，在割掉第 $x$ 条边后，由于小 L 还会因为操作失误割掉一条边，则最后所形成的 **3 个连通块的权值和的乘积的所有情况的总和** 是多少。即设这三个连通块分别为 $a,b,c$，求在已经割掉一条边的情况下 \n\n$$\n(\\sum_{u\\in a} a_u)\\times (\\sum_{u\\in b} a_u) \\times (\\sum_{u\\in c} a_u)\n$$\n\n的总和。\n\n由于愤怒，每次你算好后，小 L 都会对你帮助小 Y 算出的答案不理不顾，于是小 Y 只好把图恢复到原来那棵树，再割掉一条边，你也得再帮助小 Y 算一次，即再进行一次可能不一样的询问。你需要这样帮助小 Y 一共 $q$ 次，即回答 $q$ 个询问。又因为小 L 和小 Y 都很讨厌太大的数，所以请你用输出这个总和对 $99991$ 取模的结果。又因为输出太耗费时间，你只需要输出所有询问的答案对 $99991$ 取模的总和以及异或和即可。", "inputFormat": "第一行两个正整数 $n, q$。\n\n第二行 $n$ 个非负整数代表 $a_{1,2,...,n}$。\n\n后面 $n-1$ 行中，第 $i$ 行两个正整数 $(u,v)$ 代表第 $i$ 条边 $(u,v)$。\n\n后面 $q$ 个正整数，第 $i$ 个代表第 $i$ 次询问所割掉的边。注意，各个询问是独立的。\n\n", "outputFormat": "输出一共两行。\n\n第一行输出所有的答案对 $99991$ 取模后的和（注意，最终输出可能大于等于 $99991$）。\n\n第二行输出所有的答案对 $99991$ 取模后的异或和。", "hint": "**样例说明**\n\n对于样例一的第一个询问。已经割掉了第一条边（即边 $(1,2)$）。若小 L 再割掉的边是 $(2,3)$，那么 3 个连通块的权值和的乘积为 $1\\times 2\\times (3+4)=14$。若小 L 再割掉的边是 $(3,4)$，那么 3 个连通块的权值和的乘积为 $1\\times (2+3)\\times 4=20$。所以输出为 $14+20=34$。\n\n对于样例一的第二个询问。已经割掉了第二条边（即边 $(2,3)$）。若小 L 再割掉的边是 $(1,2)$，那么 3 个连通块的权值和的乘积为 $1\\times 2\\times (3+4)=14$。若小 L 再割掉的边是 $(3,4)$，那么 3 个连通块的权值和的乘积为 $(1+2)\\times 3\\times 4=36$。所以输出为 $14+36=50$。\n\n同理，我们可以求出样例一的第三个询问，答案为 $20+36=56$。\n\n所以三个答案的总和是 $140$，异或和是 $40$。\n\n---\n**数据规模**\n\n$\\texttt{Subtask 1 (1 pts) } a_i=0$。  \n$\\texttt{Subtask 2 (5 pts) } n,q\\le 300$。  \n$\\texttt{Subtask 3 (14 pts) } n\\le 300$。  \n$\\texttt{Subtask 4 (20 pts) } n\\le 5000$。  \n$\\texttt{Subtask 5 (10 pts) } u=v-1$。  \n$\\texttt{Subtask 6 (50 pts) }$ 没有特殊限制。\n\n对于全部数据，满足 $2 \\le n, q \\le {10}^6$，$0 \\le a_i \\le {10}^6$。\n\n---\n\nidea by lgswdn  \ntested by LHQing, Karry5307", "locale": "zh-CN"}}}
{"pid": "P7289", "type": "P", "difficulty": 7, "samples": [["2 10\n3 1\n5 2", "2\n16"]], "limits": {"time": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "递推", "O2优化", "组合数学", "排列组合", "生成函数", "微积分", "积分", "级数", "快速傅里叶变换 FFT", "快速数论变换 NTT", "洛谷月赛"], "title": "「EZEC-5」「KrOI2021」Chasse Neige", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/kben34ml.png)\n\n『我喜欢雪。』\n\n『之前虽然讨厌寒冷，现在却是最喜欢了。』\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sbuj1tnc.png)", "description": "Rikka 给了你 $T$ 组询问，每组询问给定两个正整数 $n,k$，你需要告诉 Rikka 有多少个长度为 $n$ 的排列 $\\pi$ 满足如下条件：\n\n- $\\pi_1<\\pi_2$\n\n- $\\pi_{n-1}>\\pi_{n}$\n\n- 恰好存在 $k$ 个位置 $i(2\\leq i\\leq n-1)$ 满足 $\\pi_{i-1}<\\pi_{i}$ 且 $\\pi_{i}>\\pi_{i+1}$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $T,r$，表示询问次数以及 $n$ 的值域。\n\n接下来 $T$ 行，每行两个整数 $n,k$，意义如题意所示。", "outputFormat": "$T$ 行，每行一个正整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n对于第一组询问，$n=3,k=1$，$(1,3,2)$ 和 $(2,3,1)$ 均满足条件，答案为 $2$。\n\n对于第二组询问，满足条件的排列为：\n\n$$(1,3,2,5,4),(1,4,2,5,3),(1,4,3,5,2),(1,5,2,4,3),(1,5,3,4,2)\\\\(2,3,1,5,4),(2,4,1,5,3),(2,4,3,5,1),(2,5,1,4,3),(2,5,3,4,1)\\\\(3,4,1,5,2),(3,4,2,5,1),(3,5,1,4,2),(3,5,2,4,1),(4,5,1,3,2),(4,5,2,3,1)$$\n\n共 $16$ 个，所以答案为 $16$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $T\\leq $ | $r\\leq $ | 其他限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $1$ | $10$ |  |\n| Subtask 2 | $5$ | $2\\times 10^5$ | $10$ |  |\n| Subtask 3 | $13$ | $1$ | $2\\times 10^3$ |  |\n| Subtask 4 | $13$ | $2\\times 10^5$ | $2\\times 10^3$ |  |\n| Subtask 5 | $16$ | $2\\times 10^5$ | $2\\times 10^5$ | $k=\\lfloor\\frac{n-1}{2}\\rfloor$ 且 $n$ 为奇数 |\n| Subtask 6 | $16$ | $2\\times 10^5$ | $2\\times 10^5$ | $k=\\lfloor\\frac{n-1}{2}\\rfloor-1$ |\n| Subtask 7 | $36$ | $2\\times 10^5$ | $2\\times 10^5$ |  |\n\n对于 $100\\%$ 的数据，$1\\leq T\\leq 2\\times 10^5,3\\leq n\\leq r\\leq 2\\times 10^5,\\max(1,\\lfloor\\frac{n-1}{2}\\rfloor-10)\\leq k\\leq \\lfloor\\frac{n-1}{2}\\rfloor$。\n\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-5」「KrOI2021」Chasse Neige", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/kben34ml.png)\n\n『我喜欢雪。』\n\n『之前虽然讨厌寒冷，现在却是最喜欢了。』\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sbuj1tnc.png)", "description": "Rikka 给了你 $T$ 组询问，每组询问给定两个正整数 $n,k$，你需要告诉 Rikka 有多少个长度为 $n$ 的排列 $\\pi$ 满足如下条件：\n\n- $\\pi_1<\\pi_2$\n\n- $\\pi_{n-1}>\\pi_{n}$\n\n- 恰好存在 $k$ 个位置 $i(2\\leq i\\leq n-1)$ 满足 $\\pi_{i-1}<\\pi_{i}$ 且 $\\pi_{i}>\\pi_{i+1}$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $T,r$，表示询问次数以及 $n$ 的值域。\n\n接下来 $T$ 行，每行两个整数 $n,k$，意义如题意所示。", "outputFormat": "$T$ 行，每行一个正整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n对于第一组询问，$n=3,k=1$，$(1,3,2)$ 和 $(2,3,1)$ 均满足条件，答案为 $2$。\n\n对于第二组询问，满足条件的排列为：\n\n$$(1,3,2,5,4),(1,4,2,5,3),(1,4,3,5,2),(1,5,2,4,3),(1,5,3,4,2)\\\\(2,3,1,5,4),(2,4,1,5,3),(2,4,3,5,1),(2,5,1,4,3),(2,5,3,4,1)\\\\(3,4,1,5,2),(3,4,2,5,1),(3,5,1,4,2),(3,5,2,4,1),(4,5,1,3,2),(4,5,2,3,1)$$\n\n共 $16$ 个，所以答案为 $16$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $T\\leq $ | $r\\leq $ | 其他限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $1$ | $10$ |  |\n| Subtask 2 | $5$ | $2\\times 10^5$ | $10$ |  |\n| Subtask 3 | $13$ | $1$ | $2\\times 10^3$ |  |\n| Subtask 4 | $13$ | $2\\times 10^5$ | $2\\times 10^3$ |  |\n| Subtask 5 | $16$ | $2\\times 10^5$ | $2\\times 10^5$ | $k=\\lfloor\\frac{n-1}{2}\\rfloor$ 且 $n$ 为奇数 |\n| Subtask 6 | $16$ | $2\\times 10^5$ | $2\\times 10^5$ | $k=\\lfloor\\frac{n-1}{2}\\rfloor-1$ |\n| Subtask 7 | $36$ | $2\\times 10^5$ | $2\\times 10^5$ |  |\n\n对于 $100\\%$ 的数据，$1\\leq T\\leq 2\\times 10^5,3\\leq n\\leq r\\leq 2\\times 10^5,\\max(1,\\lfloor\\frac{n-1}{2}\\rfloor-10)\\leq k\\leq \\lfloor\\frac{n-1}{2}\\rfloor$。\n\n\n", "locale": "zh-CN"}}}
{"pid": "P7290", "type": "P", "difficulty": 7, "samples": [["10\n1 8\n5 9\n5 6\n2 8\n3 7\n4 5\n3 7\n6 7\n3 9\n5 10\n10\n2 4 2 5\n5 9 8 10\n2 9 3 6\n3 7 6 9\n1 10 2 9\n4 5 1 7\n9 10 4 9\n2 3 6 9\n1 7 6 7\n3 10 3 4\n", "2\n3\n4\n3\n7\n7\n1\n2\n2\n2\n"]], "limits": {"time": [30000, 30000, 30000, 30000, 30000, 30000, 30000, 30000, 30000], "memory": [340992, 340992, 340992, 340992, 340992, 340992, 340992, 340992, 340992]}, "tags": ["O2优化", "洛谷月赛"], "title": "「EZEC-5」暴力出奇迹", "background": "### 滥用本题评测将封号！", "description": "给定一个平面，有 $n$ 个竖直线段，第 $i$ 条的端点是 $(i,a_i)$ 和 $(i,b_i)$。\n\n有 $m$ 次查询，每次查询给定 $l,r,x,y$，查询对所有 $(x,i)$ 和 $(y,i)$ 连接成的水平线段，满足 $l\\le i\\le r$，其最多能与多少竖直线段相交，定义端点为 $(i,a_1)$ 和 $(i,a_2)$ 的竖直线段与端点为 $(b_1,j)$ 和 $(b_2,j)$ 的水平线段相交，当且仅当 $a_1\\le j\\le a_2$ 且 $b_1\\le i\\le b_2$，注意当线段两端点重合时，如果有其他线段经过这个重合点，仍然算作相交。", "inputFormat": "第一行一个数表示 $n$。\n\n之后 $n$ 行，第 $i$ 行两个数 $a_i,b_i$ 表示 第 $i$ 条竖直线段的两个端点，保证 $a_i \\le b_i$。\n\n之后一行一个数表示 $m$。\n\n之后 $m$ 行，每行四个数表示一次询问的 $l,r,x,y$。", "outputFormat": "对于每次询问，输出一行一个数表示答案。", "hint": "注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^5,1\\le m\\le 9\\times 10^5$，$1\\le l,r,x,y,a_i,b_i\\le n$。\n\n---\n\n## 以下为旧数据范围\n\n对于其中 $5\\%$ 的数据，为样例 1。\n\n对于另外 $14\\%$ 的数据，$m=1$。\n\n对于另外 $5\\%$ 的数据，$n,m\\leq 500$。\n\n对于另外 $14\\%$ 的数据，$n\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n,m\\leq 2000$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 20000$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^4,1\\le m\\le 5\\times 10^5$，$1\\le l,r,x,y,a_i,b_i\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-5」暴力出奇迹", "background": "### 滥用本题评测将封号！", "description": "给定一个平面，有 $n$ 个竖直线段，第 $i$ 条的端点是 $(i,a_i)$ 和 $(i,b_i)$。\n\n有 $m$ 次查询，每次查询给定 $l,r,x,y$，查询对所有 $(x,i)$ 和 $(y,i)$ 连接成的水平线段，满足 $l\\le i\\le r$，其最多能与多少竖直线段相交，定义端点为 $(i,a_1)$ 和 $(i,a_2)$ 的竖直线段与端点为 $(b_1,j)$ 和 $(b_2,j)$ 的水平线段相交，当且仅当 $a_1\\le j\\le a_2$ 且 $b_1\\le i\\le b_2$，注意当线段两端点重合时，如果有其他线段经过这个重合点，仍然算作相交。", "inputFormat": "第一行一个数表示 $n$。\n\n之后 $n$ 行，第 $i$ 行两个数 $a_i,b_i$ 表示 第 $i$ 条竖直线段的两个端点，保证 $a_i \\le b_i$。\n\n之后一行一个数表示 $m$。\n\n之后 $m$ 行，每行四个数表示一次询问的 $l,r,x,y$。", "outputFormat": "对于每次询问，输出一行一个数表示答案。", "hint": "注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^5,1\\le m\\le 9\\times 10^5$，$1\\le l,r,x,y,a_i,b_i\\le n$。\n\n---\n\n## 以下为旧数据范围\n\n对于其中 $5\\%$ 的数据，为样例 1。\n\n对于另外 $14\\%$ 的数据，$m=1$。\n\n对于另外 $5\\%$ 的数据，$n,m\\leq 500$。\n\n对于另外 $14\\%$ 的数据，$n\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n,m\\leq 2000$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 20000$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^4,1\\le m\\le 5\\times 10^5$，$1\\le l,r,x,y,a_i,b_i\\le n$。", "locale": "zh-CN"}}}
{"pid": "P7291", "type": "P", "difficulty": 4, "samples": [["3\n3 2 1", "6"], ["5\n3 4 5 4 3", "28"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "「EZEC-5」人赢 加强版", "background": "> “我们在 小 Z 面前秀个恩爱吧。”\\\n>“好的。”\n\n小 Z 发现他身边都是人赢，这使他非常自闭。\n\n小 Z 又看着身边的潇，不禁陷入了沉思……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b1ij58kc.png)", "description": "潇有一个数组 $k$，下标为 $1$ 到 $n$ 。\n\n潇定义 $f(x,y)=\\begin{cases} \\min(k_x,k_y) \\times (x + y) &x \\ne y \\\\ k_x\\times x&x=y \\end{cases}$ 。\n\n潇想知道对于任意的 $1 \\le x,y \\le n$，$f(x,y)$ 的最大值是多少。但是她不会做，于是就问了善良的 小 Z，然而非常想在妹子面前表现的 小 Z 发现他也不会做，就只能够求助善良的你了。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $k$，第 $i$ 个整数为 $k_i$。含义如上文。", "outputFormat": "一行一个整数，表示对于任意的 $1 \\le x,y \\le n$，$f(x,y)$ 的最大值。", "hint": "### 数据范围\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 points）：$1 \\le n \\le 50$。\n\n- Subtask 2（20 points）：$1 \\le n \\le 5000$。\n\n- Subtask 3（20 points）：$1 \\le n \\le 10^6$。\n\n- Subtask 4（10 points）：保证所有 $k_{i}$ 都相等。\n\n- Subtask 5（40 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^7$，$1 \\le k_{i} \\le 10^9$。\n\n**本题建议使用较快的读入方式。**\n\nstd 使用的快读：\n\n```cpp\n#define getchar()(p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-5」人赢 加强版", "background": "> “我们在 小 Z 面前秀个恩爱吧。”\\\n>“好的。”\n\n小 Z 发现他身边都是人赢，这使他非常自闭。\n\n小 Z 又看着身边的潇，不禁陷入了沉思……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b1ij58kc.png)", "description": "潇有一个数组 $k$，下标为 $1$ 到 $n$ 。\n\n潇定义 $f(x,y)=\\begin{cases} \\min(k_x,k_y) \\times (x + y) &x \\ne y \\\\ k_x\\times x&x=y \\end{cases}$ 。\n\n潇想知道对于任意的 $1 \\le x,y \\le n$，$f(x,y)$ 的最大值是多少。但是她不会做，于是就问了善良的 小 Z，然而非常想在妹子面前表现的 小 Z 发现他也不会做，就只能够求助善良的你了。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $k$，第 $i$ 个整数为 $k_i$。含义如上文。", "outputFormat": "一行一个整数，表示对于任意的 $1 \\le x,y \\le n$，$f(x,y)$ 的最大值。", "hint": "### 数据范围\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 points）：$1 \\le n \\le 50$。\n\n- Subtask 2（20 points）：$1 \\le n \\le 5000$。\n\n- Subtask 3（20 points）：$1 \\le n \\le 10^6$。\n\n- Subtask 4（10 points）：保证所有 $k_{i}$ 都相等。\n\n- Subtask 5（40 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^7$，$1 \\le k_{i} \\le 10^9$。\n\n**本题建议使用较快的读入方式。**\n\nstd 使用的快读：\n\n```cpp\n#define getchar()(p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\n```", "locale": "zh-CN"}}}
{"pid": "P7292", "type": "P", "difficulty": 7, "samples": [["2 10\n3 1\n5 2", "2\n16"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "递推", "O2优化", "组合数学", "排列组合", "生成函数", "微积分", "积分", "级数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「EZEC-5」「KrOI2021」Chasse Neige 加强版", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/kben34ml.png)\n\n『我喜欢雪。』\n\n『之前虽然讨厌寒冷，现在却是最喜欢了。』\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sbuj1tnc.png)", "description": "**本题与原题的区别是 $r$ 的范围扩大了，应该能卡掉 $O(n\\log^2n)$ 的分治 FFT 做法，如果有分治 FFT 能过请联系我。同时，如果你的做法是 $O(n\\log n)$ 的话，请注意常数优化。**\n\nRikka 给了你 $T$ 组询问，每组询问给定两个正整数 $n,k$，你需要告诉 Rikka 有多少个长度为 $n$ 的排列 $\\pi$ 满足如下条件：\n\n- $\\pi_1<\\pi_2$\n\n- $\\pi_{n-1}>\\pi_{n}$\n\n- 恰好存在 $k$ 个位置 $i(2\\leq i\\leq n-1)$ 满足 $\\pi_{i-1}<\\pi_{i}$ 且 $\\pi_{i}>\\pi_{i+1}$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $T,r$，表示询问次数以及 $n$ 的值域。\n\n接下来 $T$ 行，每行两个整数 $n,k$，意义如题意所示。", "outputFormat": "$T$ 行，每行一个正整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n对于第一组询问，$n=3,k=1$，$(1,3,2)$ 和 $(2,3,1)$ 均满足条件，答案为 $2$。\n\n对于第二组询问，满足条件的排列为：\n\n$$(1,3,2,5,4),(1,4,2,5,3),(1,4,3,5,2),(1,5,2,4,3),(1,5,3,4,2)\\\\(2,3,1,5,4),(2,4,1,5,3),(2,4,3,5,1),(2,5,1,4,3),(2,5,3,4,1)\\\\(3,4,1,5,2),(3,4,2,5,1),(3,5,1,4,2),(3,5,2,4,1),(4,5,1,3,2),(4,5,2,3,1)$$\n\n共 $16$ 个，所以答案为 $16$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq T\\leq 2\\times 10^5,3\\leq n\\leq r\\leq 10^6,\\max(1,\\lfloor\\frac{n-1}{2}\\rfloor-10)\\leq k\\leq \\lfloor\\frac{n-1}{2}\\rfloor$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-5」「KrOI2021」Chasse Neige 加强版", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/kben34ml.png)\n\n『我喜欢雪。』\n\n『之前虽然讨厌寒冷，现在却是最喜欢了。』\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sbuj1tnc.png)", "description": "**本题与原题的区别是 $r$ 的范围扩大了，应该能卡掉 $O(n\\log^2n)$ 的分治 FFT 做法，如果有分治 FFT 能过请联系我。同时，如果你的做法是 $O(n\\log n)$ 的话，请注意常数优化。**\n\nRikka 给了你 $T$ 组询问，每组询问给定两个正整数 $n,k$，你需要告诉 Rikka 有多少个长度为 $n$ 的排列 $\\pi$ 满足如下条件：\n\n- $\\pi_1<\\pi_2$\n\n- $\\pi_{n-1}>\\pi_{n}$\n\n- 恰好存在 $k$ 个位置 $i(2\\leq i\\leq n-1)$ 满足 $\\pi_{i-1}<\\pi_{i}$ 且 $\\pi_{i}>\\pi_{i+1}$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $T,r$，表示询问次数以及 $n$ 的值域。\n\n接下来 $T$ 行，每行两个整数 $n,k$，意义如题意所示。", "outputFormat": "$T$ 行，每行一个正整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n对于第一组询问，$n=3,k=1$，$(1,3,2)$ 和 $(2,3,1)$ 均满足条件，答案为 $2$。\n\n对于第二组询问，满足条件的排列为：\n\n$$(1,3,2,5,4),(1,4,2,5,3),(1,4,3,5,2),(1,5,2,4,3),(1,5,3,4,2)\\\\(2,3,1,5,4),(2,4,1,5,3),(2,4,3,5,1),(2,5,1,4,3),(2,5,3,4,1)\\\\(3,4,1,5,2),(3,4,2,5,1),(3,5,1,4,2),(3,5,2,4,1),(4,5,1,3,2),(4,5,2,3,1)$$\n\n共 $16$ 个，所以答案为 $16$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq T\\leq 2\\times 10^5,3\\leq n\\leq r\\leq 10^6,\\max(1,\\lfloor\\frac{n-1}{2}\\rfloor-10)\\leq k\\leq \\lfloor\\frac{n-1}{2}\\rfloor$。", "locale": "zh-CN"}}}
{"pid": "P7293", "type": "P", "difficulty": 5, "samples": [["2\n\n2 1\n1 2\n\n4 4\n1 2\n2 3\n3 4\n4 1", "4"], ["3\n\n4 4\n1 2\n2 3\n3 1\n3 4\n\n6 5\n1 2\n2 3\n3 4\n4 5\n5 6\n\n7 7\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 1", "706"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "线段树", "USACO", "2021", "O2优化", "组合数学", "容斥原理", "扫描线"], "title": "[USACO21JAN] Sum of Distances P", "background": "", "description": "Bessie 有一些无向连通图 $G_1,G_2,…,G_K$（$2≤K≤5⋅10^4$）。对于每一个 $1≤i≤K$，$G_i$ 有 $N_i$（$N_i≥2$）个编号为 $1…N_i$ 的结点与 $M_i$（$M_i≥N_i−1$）条边。$G_i$ 可能含有自环，但同一对结点之间不会存在多条边。 现在 Elsie 用 $N_1⋅N_2⋯N_K$ 个结点建立了一个新的无向图 $G$，每个结点用一个 $K$ 元组 $(j_1,j_2,…,j_K)$ 标号，其中 $1≤j_i≤N_i$。若对于所有的 $1≤i≤K$，$j_i$ 与 $k_i$ 在 $G_i$ 中连有一条边，则在 $G$ 中结点 $(j_1,j_2,…,j_K)$ 和 $(k_1,k_2,…,k_K)$ 之间连有一条边。 定义 $G$ 中位于同一连通分量的两个结点的 *距离* 为从一个结点到另一个结点的路径上的最小边数。计算 $G$ 中结点 $(1,1,…,1)$ 与所有与其在同一连通分量的结点的距离之和，对 $10^9+7$ 取模。", "inputFormat": "输入的第一行包含 $K$，为图的数量。\n\n每个图的描述的第一行包含 $N_i$ 和 $M_i$，以下是 $M_i$ 条边。\n\n为提高可读性，相邻的图之间用一个空行隔开。输入保证 $∑N_i≤10^5$ 以及 $∑M_i≤2⋅10^5$。", "outputFormat": "输出结点 $(1,1,…,1)$ 与所有该结点可以到达的结点的距离之和，对 $10^9+7$ 取模。\n\n", "hint": "#### 样例 1 解释\n\n$G$ 包含 $2⋅4=8$ 个结点，其中 $4$ 个结点不与结点 $(1,1)$ 连通。有 $2$ 个结点与 $(1,1)$ 的距离为 $1$，$1$ 个结点的距离为 $2$。所以答案为 $2⋅1+1⋅2=4$。 \n\n#### 样例 2 解释\n\n$G$ 包含 $4⋅6⋅7=168$ 个结点，均与结点 $(1,1,1)$ 连通。对于每一个 $i∈[1,7]$，与结点 $(1,1,1)$ 距离为 $i$ 的结点数量为下列数组中的第 $i$ 个元素：$[4,23,28,36,40,24,12]$。\n\n#### 测试点特性\n\n - 测试点 $3-4$ 满足 $∏N_i≤300$。\n - 测试点 $5-10$ 满足 $∑N_i≤300$。\n - 测试点 $11-20$ 没有额外限制。\n\n供题：Benjamin Qi ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21JAN] Sum of Distances P", "background": "", "description": "Bessie 有一些无向连通图 $G_1,G_2,…,G_K$（$2≤K≤5⋅10^4$）。对于每一个 $1≤i≤K$，$G_i$ 有 $N_i$（$N_i≥2$）个编号为 $1…N_i$ 的结点与 $M_i$（$M_i≥N_i−1$）条边。$G_i$ 可能含有自环，但同一对结点之间不会存在多条边。 现在 Elsie 用 $N_1⋅N_2⋯N_K$ 个结点建立了一个新的无向图 $G$，每个结点用一个 $K$ 元组 $(j_1,j_2,…,j_K)$ 标号，其中 $1≤j_i≤N_i$。若对于所有的 $1≤i≤K$，$j_i$ 与 $k_i$ 在 $G_i$ 中连有一条边，则在 $G$ 中结点 $(j_1,j_2,…,j_K)$ 和 $(k_1,k_2,…,k_K)$ 之间连有一条边。 定义 $G$ 中位于同一连通分量的两个结点的 *距离* 为从一个结点到另一个结点的路径上的最小边数。计算 $G$ 中结点 $(1,1,…,1)$ 与所有与其在同一连通分量的结点的距离之和，对 $10^9+7$ 取模。", "inputFormat": "输入的第一行包含 $K$，为图的数量。\n\n每个图的描述的第一行包含 $N_i$ 和 $M_i$，以下是 $M_i$ 条边。\n\n为提高可读性，相邻的图之间用一个空行隔开。输入保证 $∑N_i≤10^5$ 以及 $∑M_i≤2⋅10^5$。", "outputFormat": "输出结点 $(1,1,…,1)$ 与所有该结点可以到达的结点的距离之和，对 $10^9+7$ 取模。\n\n", "hint": "#### 样例 1 解释\n\n$G$ 包含 $2⋅4=8$ 个结点，其中 $4$ 个结点不与结点 $(1,1)$ 连通。有 $2$ 个结点与 $(1,1)$ 的距离为 $1$，$1$ 个结点的距离为 $2$。所以答案为 $2⋅1+1⋅2=4$。 \n\n#### 样例 2 解释\n\n$G$ 包含 $4⋅6⋅7=168$ 个结点，均与结点 $(1,1,1)$ 连通。对于每一个 $i∈[1,7]$，与结点 $(1,1,1)$ 距离为 $i$ 的结点数量为下列数组中的第 $i$ 个元素：$[4,23,28,36,40,24,12]$。\n\n#### 测试点特性\n\n - 测试点 $3-4$ 满足 $∏N_i≤300$。\n - 测试点 $5-10$ 满足 $∑N_i≤300$。\n - 测试点 $11-20$ 没有额外限制。\n\n供题：Benjamin Qi ", "locale": "zh-CN"}}}
{"pid": "P7294", "type": "P", "difficulty": 7, "samples": [["5 4\n1 100 100 20\n20\n1 1\n2 1\n3 1\n4 1\n5 1\n1 2\n2 2\n3 2\n4 2\n5 2\n1 3\n2 3\n3 3\n4 3\n5 3\n1 4\n2 4\n3 4\n4 4\n5 4", "0\n1\n2\n3\n4\n1\n5\n11\n19\n29\n2\n9\n20\n35\n54\n3\n13\n29\n49\n69"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["二分", "USACO", "2021", "O2优化", "凸包", "单调栈", "组合优化", "保序回归"], "title": "[USACO21JAN] Minimum Cost Paths P", "background": "", "description": "Farmer John 的牧草地可以看作是一个$N×M$（$2≤N≤10^9, 2≤M≤2⋅10^5$）的正方形方格组成的二维方阵（想象一个巨大的棋盘）。对于 $x∈[1,N],y∈[1,M]$，从上往下第 $x$ 行、从左往右第 $y$ 列的方格记为 $(x,y)$。此外，对于每一个 $y∈[1,M]$，第 $y$ 列拥有一个代价 $c_y$（$1≤c_y≤10^9$）。\n\nBessie 从方格 $(1,1)$ 出发。如果她现在位于方格 $(x,y)$，则她可以执行以下操作之一：\n\n-  如果 $y<M$，Bessie 可以以 $x^2$ 的代价移动到下一列（$y$ 增加一）。\n- 如果 $x<N$，Bessie 可以以 $c_y$ 的代价移动到下一行（$x$ 增加一）。 \n\n给定 $Q$（$1≤Q≤2⋅10^5$）个独立的询问，每个询问给定 $(x_i,y_i)$（$x_i∈[1,N],y_i∈[1,M]$），计算 Bessie 从 $(1,1)$ 移动到 $(x_i,y_i)$ 的最小总代价。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。\n\n第二行包含 $M$ 个空格分隔的整数 $c_1,c_2,…,c_M$。\n\n第三行包含 $Q$。 \n\n最后 $Q$ 行每行包含两个空格分隔的整数 $x_i$ 和 $y_i$。", "outputFormat": "输出 $Q$ 行，为每个询问的答案。\n\n注意本题计算中所使用的整数大小可能需要使用 64 位整数型（例如，C/C++ 中的 long long）。", "hint": "#### 样例 1 解释\n\n输出以方阵形式表示如下：\n\n```\n    1  2  3  4\n  *--*--*--*--*\n1 | 0| 1| 2| 3|\n  *--*--*--*--*\n2 | 1| 5| 9|13|\n  *--*--*--*--*\n3 | 2|11|20|29|\n  *--*--*--*--*\n4 | 3|19|35|49|\n  *--*--*--*--*\n5 | 4|29|54|69|\n  *--*--*--*--*\n```\n\n#### 测试点性质：\n\n - 测试点 1-3 满足 $N,M≤2000$。\n - 测试点 4-8 满足 $c_2>c_3>⋯>c_M$。\n - 测试点 9-15 满足 $N≤2⋅10^5$。\n - 测试点 16-20 没有额外限制。\n\n供题：Benjamin Qi ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21JAN] Minimum Cost Paths P", "background": "", "description": "Farmer John 的牧草地可以看作是一个$N×M$（$2≤N≤10^9, 2≤M≤2⋅10^5$）的正方形方格组成的二维方阵（想象一个巨大的棋盘）。对于 $x∈[1,N],y∈[1,M]$，从上往下第 $x$ 行、从左往右第 $y$ 列的方格记为 $(x,y)$。此外，对于每一个 $y∈[1,M]$，第 $y$ 列拥有一个代价 $c_y$（$1≤c_y≤10^9$）。\n\nBessie 从方格 $(1,1)$ 出发。如果她现在位于方格 $(x,y)$，则她可以执行以下操作之一：\n\n-  如果 $y<M$，Bessie 可以以 $x^2$ 的代价移动到下一列（$y$ 增加一）。\n- 如果 $x<N$，Bessie 可以以 $c_y$ 的代价移动到下一行（$x$ 增加一）。 \n\n给定 $Q$（$1≤Q≤2⋅10^5$）个独立的询问，每个询问给定 $(x_i,y_i)$（$x_i∈[1,N],y_i∈[1,M]$），计算 Bessie 从 $(1,1)$ 移动到 $(x_i,y_i)$ 的最小总代价。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。\n\n第二行包含 $M$ 个空格分隔的整数 $c_1,c_2,…,c_M$。\n\n第三行包含 $Q$。 \n\n最后 $Q$ 行每行包含两个空格分隔的整数 $x_i$ 和 $y_i$。", "outputFormat": "输出 $Q$ 行，为每个询问的答案。\n\n注意本题计算中所使用的整数大小可能需要使用 64 位整数型（例如，C/C++ 中的 long long）。", "hint": "#### 样例 1 解释\n\n输出以方阵形式表示如下：\n\n```\n    1  2  3  4\n  *--*--*--*--*\n1 | 0| 1| 2| 3|\n  *--*--*--*--*\n2 | 1| 5| 9|13|\n  *--*--*--*--*\n3 | 2|11|20|29|\n  *--*--*--*--*\n4 | 3|19|35|49|\n  *--*--*--*--*\n5 | 4|29|54|69|\n  *--*--*--*--*\n```\n\n#### 测试点性质：\n\n - 测试点 1-3 满足 $N,M≤2000$。\n - 测试点 4-8 满足 $c_2>c_3>⋯>c_M$。\n - 测试点 9-15 满足 $N≤2⋅10^5$。\n - 测试点 16-20 没有额外限制。\n\n供题：Benjamin Qi ", "locale": "zh-CN"}}}
{"pid": "P7295", "type": "P", "difficulty": 7, "samples": [["4 8 9\nABBAAAAA\nABAAAABA\nCAADABBA\nAAAAAAAA\n1 1 4 8\n3 5 3 8\n1 3 2 4\n1 4 2 5\n1 1 3 3\n4 4 4 4\n2 6 4 8\n3 5 4 6\n1 6 3 8", "6\n3\n2\n1\n4\n1\n3\n2\n2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "USACO", "并查集", "2021", "cdq 分治", "广度优先搜索 BFS", "平面图欧拉公式", "前缀和", "栈", "分块"], "title": "[USACO21JAN] Paint by Letters P", "background": "", "description": "Bessie 最近收到了一套颜料。画布可以用一个 $N×M$ 的矩形方阵表示，其中行从上往下编号为 $1…N$，列从左往右编号为 $1…M$（$1≤N,M≤1000$）。被涂色的方格的颜色可以用一个 `A` 到 `Z` 的大写字母表示。初始时，所有方格均未被涂色，每个方格至多只能被涂色一次。\n\nBessie 指定了每个方格她所希望的颜色。她一笔可以将一些组成连通分量的方格涂上颜色，也就是说这些方格之间可以通过相邻方格互相到达。如果两个方格有公共边则认为它们是相邻的。\n\n例如，$3×3$ 的画布\n\n```\nAAB\nBBA\nBBB\n```\n\n可以用如下四笔完成涂色：\n\n```\n...    ..B    AAB    AAB    AAB\n... -> ... -> ... -> BB. -> BBA\n...    ...    ...    BBB    BBB\n```\n\n使用少于四笔不可能得到最终结果。\n\n作为一名先锋派艺术家，Bessie 只会对这个画布中的一个子矩形进行涂色。现在，她正在考虑 $Q$\n个候选子矩形（$1≤Q≤1000$），每一候选给定四个整数 $x_1$、$y_1$、$x_2$ 和 $y_2$，表示由第 $x_1$ 行到第 $x_2$ 行及第 $y_1$ 列到第 $y_2$ 列的所有方格组成的子矩形。\n\n对于每个候选子矩形，将所有子矩形内的方格都涂上所希望的颜色，并且子矩形外的方格均不涂色，最少需要涂多少笔？注意在这个过程中 Bessie 并没有真正进行任何的涂色，所以对于每个候选的回答是独立的。\n\n注意：本题每个测试点的时间限制为默认限制的 1.5 倍，且内存限制为默认限制的 2 倍，为 512MB。 ", "inputFormat": "输入的第一行包含 $N$、$M$ 和 $Q$。\n\n以下 $N$ 行每行包含一个由 $M$ 个大写字母组成的字符串，表示画布每行所希望的颜色。\n\n以下 $Q$ 行每行包含四个空格分隔的整数 $x_1,y_1,x_2,y_2$，表示一个候选子矩形（$1≤x_1≤x_2≤N$, $1≤y_1≤y_2≤M$）。", "outputFormat": "对于 $Q$ 个候选子矩形的每一个，输出一行，包含答案。", "hint": "#### 样例 1 解释\n\n第一个候选由整个画布组成，可以用六笔完成涂色。\n\n第二个候选的子矩形所希望的颜色为\n\n```\nABBA\n```\n\n可以用三笔完成涂色。注意，尽管在考虑整个画布时方格 $(3,5)$ 和 $(3,8)$ 可以用一笔涂上颜色 $A$，但如果仅考虑子矩形内的方格则并非如此。 \n\n#### 测试点性质：\n\n - 测试点 1-2 满足 $N,M≤50$。\n - 测试点 3-5 中，画布不包含由单一颜色所组成的环。也就是说，不存在由不同方格所组成的序列 $c_1,c_2,c_3,…,c_k$ 满足以下条件：\n   - $k>2$\n   - 所有的 $c_1,…,c_k$ 颜色相同。\n   - 对于所有的 $1≤i<k$，$c_i$ 与 $c_i+1$ 相邻。\n   - $c_k$ 与 $c_1$ 相邻。\n   注意，问题描述中的 3×3 画布包含单一颜色所组成的环（左下角的四个 B）。\n - 测试点 6-8 中，每个由相同期望颜色的方格组成的连通分量均能够被一个四边平行于坐标轴的两行两列的正方形所包含。问题描述中的 $3×3$ 画布不符合这一性质（由五个 B 组成的连通分量不能被一个两行两列的正方形包含）。\n - 测试点 9-11 中，每个由相同期望颜色的方格组成的连通分量均能够被一个四边平行于坐标轴的三行三列的正方形所包含。问题描述中的 $3×3$ 画布符合这一性质。\n - 测试点 12-20 没有额外限制。\n\n供题：Andi Qu ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21JAN] Paint by Letters P", "background": "", "description": "Bessie 最近收到了一套颜料。画布可以用一个 $N×M$ 的矩形方阵表示，其中行从上往下编号为 $1…N$，列从左往右编号为 $1…M$（$1≤N,M≤1000$）。被涂色的方格的颜色可以用一个 `A` 到 `Z` 的大写字母表示。初始时，所有方格均未被涂色，每个方格至多只能被涂色一次。\n\nBessie 指定了每个方格她所希望的颜色。她一笔可以将一些组成连通分量的方格涂上颜色，也就是说这些方格之间可以通过相邻方格互相到达。如果两个方格有公共边则认为它们是相邻的。\n\n例如，$3×3$ 的画布\n\n```\nAAB\nBBA\nBBB\n```\n\n可以用如下四笔完成涂色：\n\n```\n...    ..B    AAB    AAB    AAB\n... -> ... -> ... -> BB. -> BBA\n...    ...    ...    BBB    BBB\n```\n\n使用少于四笔不可能得到最终结果。\n\n作为一名先锋派艺术家，Bessie 只会对这个画布中的一个子矩形进行涂色。现在，她正在考虑 $Q$\n个候选子矩形（$1≤Q≤1000$），每一候选给定四个整数 $x_1$、$y_1$、$x_2$ 和 $y_2$，表示由第 $x_1$ 行到第 $x_2$ 行及第 $y_1$ 列到第 $y_2$ 列的所有方格组成的子矩形。\n\n对于每个候选子矩形，将所有子矩形内的方格都涂上所希望的颜色，并且子矩形外的方格均不涂色，最少需要涂多少笔？注意在这个过程中 Bessie 并没有真正进行任何的涂色，所以对于每个候选的回答是独立的。\n\n注意：本题每个测试点的时间限制为默认限制的 1.5 倍，且内存限制为默认限制的 2 倍，为 512MB。 ", "inputFormat": "输入的第一行包含 $N$、$M$ 和 $Q$。\n\n以下 $N$ 行每行包含一个由 $M$ 个大写字母组成的字符串，表示画布每行所希望的颜色。\n\n以下 $Q$ 行每行包含四个空格分隔的整数 $x_1,y_1,x_2,y_2$，表示一个候选子矩形（$1≤x_1≤x_2≤N$, $1≤y_1≤y_2≤M$）。", "outputFormat": "对于 $Q$ 个候选子矩形的每一个，输出一行，包含答案。", "hint": "#### 样例 1 解释\n\n第一个候选由整个画布组成，可以用六笔完成涂色。\n\n第二个候选的子矩形所希望的颜色为\n\n```\nABBA\n```\n\n可以用三笔完成涂色。注意，尽管在考虑整个画布时方格 $(3,5)$ 和 $(3,8)$ 可以用一笔涂上颜色 $A$，但如果仅考虑子矩形内的方格则并非如此。 \n\n#### 测试点性质：\n\n - 测试点 1-2 满足 $N,M≤50$。\n - 测试点 3-5 中，画布不包含由单一颜色所组成的环。也就是说，不存在由不同方格所组成的序列 $c_1,c_2,c_3,…,c_k$ 满足以下条件：\n   - $k>2$\n   - 所有的 $c_1,…,c_k$ 颜色相同。\n   - 对于所有的 $1≤i<k$，$c_i$ 与 $c_i+1$ 相邻。\n   - $c_k$ 与 $c_1$ 相邻。\n   注意，问题描述中的 3×3 画布包含单一颜色所组成的环（左下角的四个 B）。\n - 测试点 6-8 中，每个由相同期望颜色的方格组成的连通分量均能够被一个四边平行于坐标轴的两行两列的正方形所包含。问题描述中的 $3×3$ 画布不符合这一性质（由五个 B 组成的连通分量不能被一个两行两列的正方形包含）。\n - 测试点 9-11 中，每个由相同期望颜色的方格组成的连通分量均能够被一个四边平行于坐标轴的三行三列的正方形所包含。问题描述中的 $3×3$ 画布符合这一性质。\n - 测试点 12-20 没有额外限制。\n\n供题：Andi Qu ", "locale": "zh-CN"}}}
