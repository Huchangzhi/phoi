{"pid": "P5551", "type": "P", "difficulty": 3, "samples": [["3\n6 17 43 55 20 55 38", "81"], ["4\n6 20 72 61 26 55 26 7 17 55 26 7 38 7 35", "159"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "Chino的树学", "background": "Chino非常喜欢树", "description": "Chino树是一棵具有某种性质的满二叉树，具体来说，对于这棵树的每一个非叶子节点，它的左子节点$(A)$的右子节点$(C)$与它的右子节点$(B)$的左子节点$(D)$的值相同，且$C$与$D$下方的子树也完全相同。现在，Chino想知道，要如何从根节点走到其中任意叶节点使路上经过的节点的权值之和最大。\n\n![](https://cdn.luogu.com.cn/upload/pic/23672.png )\n\n$Orz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg$", "inputFormat": "第一行，一个数，$n$，代表该二叉树的层数。\n\n第二行，$2^n-1$个数，代表该二叉树的先序遍历。", "outputFormat": "一行，一个数，代表点权最大和。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/23674.png )\n![](https://cdn.luogu.com.cn/upload/pic/23675.png )\n![](https://cdn.luogu.com.cn/upload/pic/23673.png )\n答案longlong救星", "locale": "zh-CN", "translations": {"en": {"title": "Chino's Tree Study", "background": "Chino really likes trees.", "description": "A Chino tree is a full binary tree with a certain property. Specifically, for every non-leaf node in this tree, the value of the right child $(C)$ of its left child $(A)$ is the same as the value of the left child $(D)$ of its right child $(B)$. Also, the subtrees rooted at $C$ and $D$ are exactly the same. Now, Chino wants to know how to walk from the root to any leaf node so that the sum of the node weights along the path is as large as possible.\n\n![](https://cdn.luogu.com.cn/upload/pic/23672.png )\n\n$Orz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg$", "inputFormat": "The first line contains an integer $n$, which represents the number of levels of the binary tree.\n\nThe second line contains $2^n-1$ numbers, which represent the preorder traversal of the binary tree.", "outputFormat": "One line containing one number, which is the maximum possible sum of node weights.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/23674.png )\n![](https://cdn.luogu.com.cn/upload/pic/23675.png )\n![](https://cdn.luogu.com.cn/upload/pic/23673.png )\nA long long savior.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Chino的树学", "background": "Chino非常喜欢树", "description": "Chino树是一棵具有某种性质的满二叉树，具体来说，对于这棵树的每一个非叶子节点，它的左子节点$(A)$的右子节点$(C)$与它的右子节点$(B)$的左子节点$(D)$的值相同，且$C$与$D$下方的子树也完全相同。现在，Chino想知道，要如何从根节点走到其中任意叶节点使路上经过的节点的权值之和最大。\n\n![](https://cdn.luogu.com.cn/upload/pic/23672.png )\n\n$Orz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg$", "inputFormat": "第一行，一个数，$n$，代表该二叉树的层数。\n\n第二行，$2^n-1$个数，代表该二叉树的先序遍历。", "outputFormat": "一行，一个数，代表点权最大和。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/23674.png )\n![](https://cdn.luogu.com.cn/upload/pic/23675.png )\n![](https://cdn.luogu.com.cn/upload/pic/23673.png )\n答案longlong救星", "locale": "zh-CN"}}}
{"pid": "P5552", "type": "P", "difficulty": 6, "samples": [["5 1\n2 3 1 4 5", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 4000, 4000, 4000, 4000, 4000], "memory": [300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000, 300000]}, "tags": ["线段树", "O2优化"], "title": "Chino的试卷", "background": "orz trz\n\nChino参加了萌妹子期末考试，又到了发试卷的时候了，但是，老师 $ygg$ 与 老师 $ggy$ 就怎样发试卷才最省力这一事发生了一些争论。现在，为了解决这一矛盾，你决定帮Chino用数据说话。\n\n下面是 $ygg$ 老师的发试卷策略，请你帮他计算发完试卷要走的总路程。", "description": "为了简化问题，我们规定Chino的同学们(妹子们)都参加了考试，且坐在一排，顺次位置的编号为 $1\\sim n$，不妨规定位置 $i$, $j$ 之间的路程为 $|i - j|$。每张试卷上都有一个编号，代表要发给坐在这个编号的妹子。\n\n$ygg$ 老师正在分发试卷。我们定义这个分发试卷的老师有两只手。刚开始，所有的试卷都在 $ygg$ 老师的左手，老师位于位置 $s$ 处。发试卷时，$ygg$ 老师会用右手拿起左手顶部的一张试卷。如果这是最后一张需要发的试卷，显然他别无选择，只能走到这张试卷主人的位置上去发这张试卷。如果他的左手还有试卷，那么他会进行一次比较，比较发左手顶部的那张试卷走的路程短，还是发右手那张试卷走的路程短。如果左手那张试卷走的路程短，他会把右手的试卷放到左手试卷的最下面，不然的话，他会直接发掉右手的试卷，并停留在刚发完这张试卷的位置。无论如何，他都会从左手再拿一张试卷，来进行下一步的决策，直到所有卷子都被发完。\n\n现在，给定试卷的初始顺序序列$p$，以及老师的初始位置 $s$，问他要发完所有试卷走过的总路程是多少。\n\nChino想快速的知道答案，所以你要在$+4s$内完成这道题哦qwq\n\nOrz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg", "inputFormat": "- 第一行两个正整数 $n, s$  ，分别表示人数老师的初始位置。\n- 第二行 $n$ 个非负整数，其中第 $i$ 个数表示 $p_i$ ，即从上往下数第 $i$ 张试卷要发到哪里去。", "outputFormat": "输出一个整数，表示需要走的总路程。", "hint": "| 测试点 |     $n= $     | 测试点 |     $n =$     |\n| :----: | :-----------: | :----: | :-----------: |\n|   1    | $3\\times10^1$ |   11   | $3\\times10^5$ |\n|   2    | $3\\times10^2$ |   12   | $3\\times10^5$ |\n|   3    | $3\\times10^2$ |   13   | $3\\times10^5$ |\n|   4    | $3\\times10^3$ |   14   | $3\\times10^5$ |\n|   5    | $3\\times10^3$ |   15   | $3\\times10^5$ |\n|   6    | $3\\times10^3$ |   16   | $3\\times10^6$ |\n|   7    | $3\\times10^4$ |   17   | $3\\times10^6$ |\n|   8    | $3\\times10^4$ |   18   | $3\\times10^6$ |\n|   9    | $3\\times10^4$ |   19   | $3\\times10^6$ |\n|   10   | $3\\times10^4$ |   20   | $3\\times10^6$ |\n\n对于前$15$个测试点，时限$1s$\n\n对于后$5$个测试点，时限$4s$", "locale": "zh-CN", "translations": {"en": {"title": "Chino's Exam Papers.", "background": "orz trz\n\nChino took the “cute girls” final exam, and it is time to hand out the papers again. However, teacher $ygg$ and teacher $ggy$ had a dispute about how to hand out the papers with the least effort. Now, to resolve this conflict, you decide to help Chino speak with data.\n\nBelow is teacher $ygg$'s strategy for handing out papers. Please help him compute the total distance walked to finish handing out all papers.", "description": "To simplify the problem, we assume that all of Chino’s classmates (girls) took the exam and are seated in a single row, with positions numbered $1\\sim n$ in order. Define the distance between positions $i$ and $j$ as $|i - j|$. Each paper has a number on it, indicating which girl (at that numbered position) it should be handed to.\n\nTeacher $ygg$ is handing out the papers. We define that this teacher has two hands. At the beginning, all papers are in teacher $ygg$'s left hand, and the teacher is at position $s$. When handing out papers, teacher $ygg$ will use his right hand to pick up one paper from the top of the left-hand stack. If this is the last paper that still needs to be handed out, then obviously he has no choice but to walk to that paper owner’s position and hand it out. If there are still papers left in his left hand, then he will make a comparison: he compares whether the walking distance to hand out the paper on the top of the left hand is shorter, or the walking distance to hand out the paper currently in the right hand is shorter. If the left-hand paper requires a shorter distance, he will put the right-hand paper to the very bottom of the left-hand stack. Otherwise, he will hand out the right-hand paper directly, and stay at the position where he just handed it out. In any case, he will take another paper from the left hand to make the next decision, until all papers are handed out.\n\nNow, given the initial order sequence $p$ of the papers and the teacher’s initial position $s$, ask what the total distance he walks to finish handing out all papers is.\n\nChino wants to know the answer quickly, so you must finish this problem within $+4s$ time, qwq.\n\nOrz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg.", "inputFormat": "- The first line contains two positive integers $n, s$, representing the number of people and the teacher’s initial position, respectively.\n- The second line contains $n$ non-negative integers. The $i$-th number denotes $p_i$, i.e., the $i$-th paper from top to bottom should be handed to that position.", "outputFormat": "Output one integer, representing the total distance that needs to be walked.", "hint": "| Test Point |     $n= $     | Test Point |     $n =$     |\n| :----: | :-----------: | :----: | :-----------: |\n|   1    | $3\\times10^1$ |   11   | $3\\times10^5$ |\n|   2    | $3\\times10^2$ |   12   | $3\\times10^5$ |\n|   3    | $3\\times10^2$ |   13   | $3\\times10^5$ |\n|   4    | $3\\times10^3$ |   14   | $3\\times10^5$ |\n|   5    | $3\\times10^3$ |   15   | $3\\times10^5$ |\n|   6    | $3\\times10^3$ |   16   | $3\\times10^6$ |\n|   7    | $3\\times10^4$ |   17   | $3\\times10^6$ |\n|   8    | $3\\times10^4$ |   18   | $3\\times10^6$ |\n|   9    | $3\\times10^4$ |   19   | $3\\times10^6$ |\n|   10   | $3\\times10^4$ |   20   | $3\\times10^6$ |\n\nFor the first $15$ test points, the time limit is $1s$.\n\nFor the last $5$ test points, the time limit is $4s$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Chino的试卷", "background": "orz trz\n\nChino参加了萌妹子期末考试，又到了发试卷的时候了，但是，老师 $ygg$ 与 老师 $ggy$ 就怎样发试卷才最省力这一事发生了一些争论。现在，为了解决这一矛盾，你决定帮Chino用数据说话。\n\n下面是 $ygg$ 老师的发试卷策略，请你帮他计算发完试卷要走的总路程。", "description": "为了简化问题，我们规定Chino的同学们(妹子们)都参加了考试，且坐在一排，顺次位置的编号为 $1\\sim n$，不妨规定位置 $i$, $j$ 之间的路程为 $|i - j|$。每张试卷上都有一个编号，代表要发给坐在这个编号的妹子。\n\n$ygg$ 老师正在分发试卷。我们定义这个分发试卷的老师有两只手。刚开始，所有的试卷都在 $ygg$ 老师的左手，老师位于位置 $s$ 处。发试卷时，$ygg$ 老师会用右手拿起左手顶部的一张试卷。如果这是最后一张需要发的试卷，显然他别无选择，只能走到这张试卷主人的位置上去发这张试卷。如果他的左手还有试卷，那么他会进行一次比较，比较发左手顶部的那张试卷走的路程短，还是发右手那张试卷走的路程短。如果左手那张试卷走的路程短，他会把右手的试卷放到左手试卷的最下面，不然的话，他会直接发掉右手的试卷，并停留在刚发完这张试卷的位置。无论如何，他都会从左手再拿一张试卷，来进行下一步的决策，直到所有卷子都被发完。\n\n现在，给定试卷的初始顺序序列$p$，以及老师的初始位置 $s$，问他要发完所有试卷走过的总路程是多少。\n\nChino想快速的知道答案，所以你要在$+4s$内完成这道题哦qwq\n\nOrz yky,dyh,wjk,jjy,cxr,gsy,cpy,zcy,tyz,yy,hz,zhr,ygg", "inputFormat": "- 第一行两个正整数 $n, s$  ，分别表示人数老师的初始位置。\n- 第二行 $n$ 个非负整数，其中第 $i$ 个数表示 $p_i$ ，即从上往下数第 $i$ 张试卷要发到哪里去。", "outputFormat": "输出一个整数，表示需要走的总路程。", "hint": "| 测试点 |     $n= $     | 测试点 |     $n =$     |\n| :----: | :-----------: | :----: | :-----------: |\n|   1    | $3\\times10^1$ |   11   | $3\\times10^5$ |\n|   2    | $3\\times10^2$ |   12   | $3\\times10^5$ |\n|   3    | $3\\times10^2$ |   13   | $3\\times10^5$ |\n|   4    | $3\\times10^3$ |   14   | $3\\times10^5$ |\n|   5    | $3\\times10^3$ |   15   | $3\\times10^5$ |\n|   6    | $3\\times10^3$ |   16   | $3\\times10^6$ |\n|   7    | $3\\times10^4$ |   17   | $3\\times10^6$ |\n|   8    | $3\\times10^4$ |   18   | $3\\times10^6$ |\n|   9    | $3\\times10^4$ |   19   | $3\\times10^6$ |\n|   10   | $3\\times10^4$ |   20   | $3\\times10^6$ |\n\n对于前$15$个测试点，时限$1s$\n\n对于后$5$个测试点，时限$4s$", "locale": "zh-CN"}}}
{"pid": "P5553", "type": "P", "difficulty": 4, "samples": [["3\n1\n2\n998244853", "1\n0\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学"], "title": "电学实验", "background": "", "description": "物理课上，小L和小K在做电学实验：“探究电阻两端的电压一定时，通过电阻的电流和电阻的大小的关系”。在这一实验中，控制电阻箱两端的电压为 $1~ V$ ，调节旋钮改变电阻箱的电阻，分别改为 $1 ~ \\Omega , 2 ~ \\Omega , 3 ~ \\Omega , \\ldots , n ~ \\Omega $ ，分别读出对应的电流表示数为 $1 ~ A, \\dfrac 1 2 ~  A , \\dfrac 1 3 ~ A , ... ,\\dfrac 1 n ~ A$ 。\n\n在描述实验结论的时候，小L和小K产生了分歧。\n\n小K：“众所周知，电阻两端的电压一定时，通过电阻的电流和电阻的大小成反比。也就是说，如果电阻箱两端电压保持不变，电阻箱的电阻为 $x ~ \\Omega $ ，则通过电阻箱的电流为 $\\dfrac 1 x ~ A$ 。”\n\n小L：“但是我们为什么不可以用一个最高 $n-1$ 次的曲线去拟合它呢？”\n\n为了改变小L的错误认识，小K决定先让 **小L按自己的结论** 去计算出电阻箱的电阻为 $(n+1) ~ \\Omega$ 时，通过电阻箱的电流，然后进行实验，检验答案的正确性。同时，为了让小L更深刻地认识到自己的错误，小K决定进行多组实验，每组实验取不同的 $n$ 。\n\n但是，小L在求解关于这 $n$ 组实验数据的最高 $n-1$ 次曲线时，遇到了问题。小L不想手算出这条曲线和曲线在 $(n+1) ~ \\Omega $ 时的值，所以他找到了你，希望你能够求出这个值。\n\n为了使运算更方便，小L将所有数据转化为取模 $998244353$ 意义下的整数值，你的输出也应该是这个整数值。但是，有时候数据的组数过多，导致实验数据或最后的运算结果没有意义，此时你需要输出 `-1` 。", "inputFormat": "输入第一行有一个整数 $T$ ，表示进行了 $T$ 组实验。\n\n每组实验一行，有一个整数 $n$ 。", "outputFormat": "对于每组实验，输出 **按照小L的结论** ，电阻箱电阻为 $(n+1) ~ \\Omega$ 时对应的电流值。如果实验数据或求得的结果在模意义下没有定义，输出 `-1`  。", "hint": "对于 $10\\%$ 的数据， $1\\le n\\le 6$ 。\n\n对于 $30\\%$ 的数据， $1\\le n\\le 50$ 。\n\n对于 $50\\%$ 的数据， $1\\le n\\le 5000$ 。\n\n对于 $70\\%$ 的数据， $1\\le n\\le 10^5$ 。\n\n对于 $100\\%$ 的数据， $1\\le T\\le 100,1\\le n\\le 10^{18}$ 。", "locale": "zh-CN", "translations": {"en": {"title": "Electrical Experiment", "background": "", "description": "In physics class, Xiao L and Xiao K are doing an electrical experiment: “Exploring the relationship between the current through a resistor and the resistance value when the voltage across the resistor is fixed.” In this experiment, they keep the voltage across the resistance box at $1~ V$, and adjust the knob to change the resistance of the box to $1 ~ \\Omega , 2 ~ \\Omega , 3 ~ \\Omega , \\ldots , n ~ \\Omega$. They then read the corresponding current values as $1 ~ A, \\dfrac 1 2 ~  A , \\dfrac 1 3 ~ A , ... ,\\dfrac 1 n ~ A$.\n\nWhen describing the experimental conclusion, Xiao L and Xiao K disagree.\n\nXiao K: “As everyone knows, when the voltage across a resistor is fixed, the current through the resistor is inversely proportional to the resistance. That is, if the voltage across the resistance box stays unchanged and the resistance is $x ~ \\Omega$, then the current through it is $\\dfrac 1 x ~ A$.”\n\nXiao L: “But why can’t we use a curve of degree at most $n-1$ to fit it?”\n\nTo correct Xiao L’s misunderstanding, Xiao K decides to first let **Xiao L compute according to his own conclusion** the current through the resistance box when its resistance is $(n+1) ~ \\Omega$, and then perform an experiment to check whether the answer is correct. Meanwhile, to make Xiao L realize his mistake more deeply, Xiao K decides to do multiple experiments, each with a different $n$.\n\nHowever, when Xiao L tries to find the degree at most $n-1$ curve for these $n$ experimental data points, he runs into difficulties. Xiao L does not want to manually compute this curve and its value at $(n+1) ~ \\Omega$, so he asks you to compute this value.\n\nTo make calculations easier, Xiao L converts all data into integers under modulo $998244353$, and your output should also be this integer value. However, sometimes there are too many data points, causing the experimental data or the final computed result to be meaningless. In this case, you should output `-1`.", "inputFormat": "The first line contains an integer $T$, indicating that $T$ experiments were conducted.\n\nEach experiment consists of one line containing an integer $n$.", "outputFormat": "For each experiment, output **according to Xiao L’s conclusion** the current value when the resistance box has resistance $(n+1) ~ \\Omega$. If the experimental data or the computed result is not defined under the modulo meaning, output `-1`.", "hint": "For $10\\%$ of the testdata, $1\\le n\\le 6$.\n\nFor $30\\%$ of the testdata, $1\\le n\\le 50$.\n\nFor $50\\%$ of the testdata, $1\\le n\\le 5000$.\n\nFor $70\\%$ of the testdata, $1\\le n\\le 10^5$.\n\nFor $100\\%$ of the testdata, $1\\le T\\le 100, 1\\le n\\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "电学实验", "background": "", "description": "物理课上，小L和小K在做电学实验：“探究电阻两端的电压一定时，通过电阻的电流和电阻的大小的关系”。在这一实验中，控制电阻箱两端的电压为 $1~ V$ ，调节旋钮改变电阻箱的电阻，分别改为 $1 ~ \\Omega , 2 ~ \\Omega , 3 ~ \\Omega , \\ldots , n ~ \\Omega $ ，分别读出对应的电流表示数为 $1 ~ A, \\dfrac 1 2 ~  A , \\dfrac 1 3 ~ A , ... ,\\dfrac 1 n ~ A$ 。\n\n在描述实验结论的时候，小L和小K产生了分歧。\n\n小K：“众所周知，电阻两端的电压一定时，通过电阻的电流和电阻的大小成反比。也就是说，如果电阻箱两端电压保持不变，电阻箱的电阻为 $x ~ \\Omega $ ，则通过电阻箱的电流为 $\\dfrac 1 x ~ A$ 。”\n\n小L：“但是我们为什么不可以用一个最高 $n-1$ 次的曲线去拟合它呢？”\n\n为了改变小L的错误认识，小K决定先让 **小L按自己的结论** 去计算出电阻箱的电阻为 $(n+1) ~ \\Omega$ 时，通过电阻箱的电流，然后进行实验，检验答案的正确性。同时，为了让小L更深刻地认识到自己的错误，小K决定进行多组实验，每组实验取不同的 $n$ 。\n\n但是，小L在求解关于这 $n$ 组实验数据的最高 $n-1$ 次曲线时，遇到了问题。小L不想手算出这条曲线和曲线在 $(n+1) ~ \\Omega $ 时的值，所以他找到了你，希望你能够求出这个值。\n\n为了使运算更方便，小L将所有数据转化为取模 $998244353$ 意义下的整数值，你的输出也应该是这个整数值。但是，有时候数据的组数过多，导致实验数据或最后的运算结果没有意义，此时你需要输出 `-1` 。", "inputFormat": "输入第一行有一个整数 $T$ ，表示进行了 $T$ 组实验。\n\n每组实验一行，有一个整数 $n$ 。", "outputFormat": "对于每组实验，输出 **按照小L的结论** ，电阻箱电阻为 $(n+1) ~ \\Omega$ 时对应的电流值。如果实验数据或求得的结果在模意义下没有定义，输出 `-1`  。", "hint": "对于 $10\\%$ 的数据， $1\\le n\\le 6$ 。\n\n对于 $30\\%$ 的数据， $1\\le n\\le 50$ 。\n\n对于 $50\\%$ 的数据， $1\\le n\\le 5000$ 。\n\n对于 $70\\%$ 的数据， $1\\le n\\le 10^5$ 。\n\n对于 $100\\%$ 的数据， $1\\le T\\le 100,1\\le n\\le 10^{18}$ 。", "locale": "zh-CN"}}}
{"pid": "P5554", "type": "P", "difficulty": 6, "samples": [["5\nquery 1.000\nadd 1.000 5.000 1.000 2.000\nquery 1.000\nquery 2.000\nquery 1.500", "Undefined\n1.000000\n1.100000\n2.275000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge"], "title": "篮球统计", "background": "小L喜欢唱、跳、Rap和篮球。\n\n在同一时刻，篮球场上可能会有很多个在空中的篮球，小L想统计这些篮球的信息。", "description": "当一个篮球被抛到空中时，小L会记下一个时刻 $l$ ，此时这个篮球开始被小L统计；当一个篮球被接住时，小L会记下一个时刻 $r$ ，在这之后这个篮球的状态不再被小L统计。对于每个篮球，小L会计算出在时刻 $l$ 这个篮球的高度和向上的初速度。\n\n对于一个时刻 $x$ ，小L想知道，对于所有此时还在空中的篮球，高度最高的篮球的高度是多少。\n\n**注意** ：被发现的篮球的出现时间 $l,r$ 和小L统计信息的时刻 $x$ 均没有任何单调性。", "inputFormat": "输入的第一行为一个整数 $m$ 。\n\n接下来的 $m$ 行，每行为一个操作或询问，为以下形式之一：\n\n1.  `add a v l r` ：小L发现了一个在空中的篮球，这个篮球在时刻 $l$ 被抛向空中，在时刻 $r$ 被接住，这个篮球在时刻 $l$ 的高度是 $a$ ，向上的初始速度为 $v$ 。\n\n2.  `query x` ：请告诉小L，在他已经给出的信息中，在时刻 $x$ 在空中的所有篮球中最高的高度是多少。", "outputFormat": "对于每个 `query` 操作，输出一行，为这个最高的高度。如果此时不存在在空中的篮球，输出 `Undefined` 。\n\n为了减小精度误差，推荐使用 `long double` 类型存储浮点数，输出格式为 `%Lf` 。\n\n为了避免精度问题，本题使用 **Special Judge** 。如果您的答案与标程的答案相差小于等于 $0.005$ ，则会被视为是正确的。", "hint": "对于 $30\\%$ 的数据， $m\\le 5000$\n\n对于另外 $30\\%$ 的数据， $-100< l,r,x< 100$\n\n对于 $100\\%$ 的数据， $1\\le m\\le 100000,-1000< a,v < 1000,-10^6< l,r,x < 10^6,l\\le r$ ，保证输入中所有的小数均为 $3$ 位小数。\n\n篮球高度可能是负数。\n\n### 小K教你学物理\n\n本题中所有的单位均采用国际单位制。即时间单位是秒（ $s$ ），长度单位是米（ $m$ ）。\n\n本题中取重力加速度 $g=9.8 ~ m \\cdot s^{-2}$ 。\n\n省略掉篮球横向的位移，可以将篮球的运动看做是 **竖直上抛运动** 。根据题目中给出的信息，已知篮球初始的高度 $a$ ，初速度 $v$ ，重力加速度 $g$ ， **在空中的时间**  $t$ ，则篮球在这一时刻的高度是 $-\\dfrac 1 2 g t^2 + vt+a$ 。", "locale": "zh-CN", "translations": {"en": {"title": "Basketball Statistics", "background": "Xiao L likes singing, dancing, rap, and basketball.\n\nAt the same moment, there may be many basketballs in the air on the court, and Xiao L wants to collect statistics about these basketballs.", "description": "When a basketball is thrown into the air, Xiao L records a time $l$, from which this basketball starts being counted by Xiao L. When a basketball is caught, Xiao L records a time $r$, after which the state of this basketball is no longer counted by Xiao L. For each basketball, Xiao L computes the height of this basketball at time $l$ and its initial upward velocity.\n\nFor a time $x$, Xiao L wants to know: among all basketballs that are still in the air at that moment, what is the height of the highest one.\n\n**Note**: The discovered basketballs' times $l, r$ and Xiao L's query times $x$ have no monotonicity.", "inputFormat": "The first line contains an integer $m$.\n\nThe next $m$ lines each describe an operation or a query, in one of the following forms:\n\n1. `add a v l r`: Xiao L discovers a basketball in the air. This basketball is thrown into the air at time $l$ and is caught at time $r$. Its height at time $l$ is $a$, and its initial upward velocity is $v$.\n\n2. `query x`: Please tell Xiao L, based on the information he has given so far, what the maximum height is among all basketballs that are in the air at time $x$.", "outputFormat": "For each `query` operation, output one line containing this maximum height. If there is no basketball in the air at that time, output `Undefined`.\n\nTo reduce precision errors, it is recommended to use the `long double` type to store floating-point numbers, and use `%Lf` as the output format.\n\nTo avoid precision issues, this problem uses **Special Judge**. If the difference between your answer and the reference solution's answer is less than or equal to $0.005$, it will be considered correct.", "hint": "For $30\\%$ of the testdata, $m \\le 5000$.\n\nFor another $30\\%$ of the testdata, $-100 < l, r, x < 100$.\n\nFor $100\\%$ of the testdata, $1 \\le m \\le 100000$, $-1000 < a, v < 1000$, $-10^6 < l, r, x < 10^6$, $l \\le r$. It is guaranteed that all decimals in the input have exactly $3$ digits after the decimal point.\n\nThe basketball's height may be negative.\n\n### Xiao K Teaches You Physics\n\nAll units in this problem use the International System of Units (SI). That is, the time unit is seconds ($s$), and the length unit is meters ($m$).\n\nIn this problem, the gravitational acceleration is $g = 9.8 ~ m \\cdot s^{-2}$.\n\nIgnoring the horizontal displacement of the basketball, we can treat its motion as **vertical upward throw motion**. Based on the information given in the statement, if the basketball's initial height is $a$, initial velocity is $v$, gravitational acceleration is $g$, and the **time in the air** is $t$, then the height of the basketball at that time is $-\\dfrac 1 2 g t^2 + vt + a$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "篮球统计", "background": "小L喜欢唱、跳、Rap和篮球。\n\n在同一时刻，篮球场上可能会有很多个在空中的篮球，小L想统计这些篮球的信息。", "description": "当一个篮球被抛到空中时，小L会记下一个时刻 $l$ ，此时这个篮球开始被小L统计；当一个篮球被接住时，小L会记下一个时刻 $r$ ，在这之后这个篮球的状态不再被小L统计。对于每个篮球，小L会计算出在时刻 $l$ 这个篮球的高度和向上的初速度。\n\n对于一个时刻 $x$ ，小L想知道，对于所有此时还在空中的篮球，高度最高的篮球的高度是多少。\n\n**注意** ：被发现的篮球的出现时间 $l,r$ 和小L统计信息的时刻 $x$ 均没有任何单调性。", "inputFormat": "输入的第一行为一个整数 $m$ 。\n\n接下来的 $m$ 行，每行为一个操作或询问，为以下形式之一：\n\n1.  `add a v l r` ：小L发现了一个在空中的篮球，这个篮球在时刻 $l$ 被抛向空中，在时刻 $r$ 被接住，这个篮球在时刻 $l$ 的高度是 $a$ ，向上的初始速度为 $v$ 。\n\n2.  `query x` ：请告诉小L，在他已经给出的信息中，在时刻 $x$ 在空中的所有篮球中最高的高度是多少。", "outputFormat": "对于每个 `query` 操作，输出一行，为这个最高的高度。如果此时不存在在空中的篮球，输出 `Undefined` 。\n\n为了减小精度误差，推荐使用 `long double` 类型存储浮点数，输出格式为 `%Lf` 。\n\n为了避免精度问题，本题使用 **Special Judge** 。如果您的答案与标程的答案相差小于等于 $0.005$ ，则会被视为是正确的。", "hint": "对于 $30\\%$ 的数据， $m\\le 5000$\n\n对于另外 $30\\%$ 的数据， $-100< l,r,x< 100$\n\n对于 $100\\%$ 的数据， $1\\le m\\le 100000,-1000< a,v < 1000,-10^6< l,r,x < 10^6,l\\le r$ ，保证输入中所有的小数均为 $3$ 位小数。\n\n篮球高度可能是负数。\n\n### 小K教你学物理\n\n本题中所有的单位均采用国际单位制。即时间单位是秒（ $s$ ），长度单位是米（ $m$ ）。\n\n本题中取重力加速度 $g=9.8 ~ m \\cdot s^{-2}$ 。\n\n省略掉篮球横向的位移，可以将篮球的运动看做是 **竖直上抛运动** 。根据题目中给出的信息，已知篮球初始的高度 $a$ ，初速度 $v$ ，重力加速度 $g$ ， **在空中的时间**  $t$ ，则篮球在这一时刻的高度是 $-\\dfrac 1 2 g t^2 + vt+a$ 。", "locale": "zh-CN"}}}
{"pid": "P5555", "type": "P", "difficulty": 6, "samples": [["6 7\naaabab\nababaaa", "3 3"], ["10 10\nbbaabaaaac\nbbaabaaaac", "5 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "后缀自动机 SAM", "哈希 hashing", "回文自动机 PAM"], "title": "秩序魔咒", "background": "", "description": "现代魔法师小L和小K正在研究魔咒。\n\n“你知道如何使用魔咒吗？”\n\n“当然知道，这是一个现代魔法师最基本的修养。”\n\n“那你对魔咒的发展史了解多少？”\n\n“课上讲的我还记得一点。那是在很久很久之前了。当时，世界上还没有人会使用魔咒，而混沌魔法成为了魔法界当时的主流魔法。这是一种邪恶的法术，不需要技巧，不需要规则，内心越黑暗，力量越强。于是，邪恶的魔法师们自相残杀，弄得天昏地暗，血流成河。其中，以自称‘混沌恶魔’的魔法师为首的魔法师集团通过极其肮脏的手段控制了几乎整个魔法界，让那些向往秩序与和平的魔法师难以生存。就在这个时候，世界救星的救星出现了。名为莱赫穆拉和肯埋多卡的两名魔法师勇敢地站了出来，仅凭两个人的力量就与混沌恶魔集团展开了决战，可终究寡不敌众，被逼到了绝境。就在混沌恶魔的最后一击打中他们的身体时，莱赫穆拉和肯埋多卡利用这一击的巨大魔力，将两人余下的全部魔法与意志升格成了概念，创造了秩序魔咒体系，扭转了世界理论，使得混沌魔法被永远封印。而混沌恶魔也在这强烈的扭曲中灰飞烟灭。从此，魔法界由混沌纪元进入了秩序纪元，人们遵循莱赫穆拉和肯埋多卡这两位圣人的遗志，在秩序魔咒体系下使用魔咒，直到现在。”\n\n“原来是这样。我们如今需要遵循一系列原则来使用魔咒，是这个原因啊。”\n\n“是啊，这正是两位圣人为维持现在这个世界不退回混沌纪元而做的努力。话说，你是上个星期才刚刚上了第一堂魔法课，你还记得使用魔咒的几个原则吗？”\n\n“我想想。第一，必须出现在秩序序列中。当时二位圣人留下来的体系，经过后代魔法师不懈的努力，被翻译成了名为秩序序列的存在。为了方便现代魔法师使用，**秩序序列只由英文小写字母组成**。由于体系的力量过于强大而不能仅仅限制在一个序列中，**魔法师们分别将两位圣人的遗志转移到了两个秩序序列里**。魔咒必须受到秩序序列的限制。**具体来说，是必须出现在秩序序列里（是秩序序列的子串）**。由于二位圣人的遗志不可分割，**魔咒必须同时出现在两个秩序序列里**。第二，为了让魔咒稳定而精确，秩序体系规定了魔咒的形态。**具体来说，魔咒的第一个字符需要与魔咒的倒数第一个字符相同，魔咒的第二个字符需要与魔咒的倒数第二个字符相同，以此类推**。这样就可以使魔咒对称而有秩序了。还有的话，让我看看……”\n\n“别看了别看了，最重要的就是这些了。还有，你说不定还不知道，魔咒越长，力量越强大。”\n\n“是这样的吗？难怪那天老师演示的魔咒魔力比我的大那么多。”\n\n“是的是的。你是不是已经发现了，魔咒的力量是有最高限制的？”\n\n“啊，好像没错。但老师那天说，最强魔咒的使用者还没出现？”\n\n“对。使用者自身必须要有与魔咒同样程度的能力，才可能顺利地使用这个魔咒。我们这些初学者，不知道何年何月才能达到这个程度呢……”\n\n“唉……不如，我们来数一数力量最强的魔咒的长度，和它们有多少个吧。”\n\n“嗯，反正没事可做，我们就来干一干这种力所能及的事吧。”\n\n于是，小L和小K就开始数最强魔咒的长度和个数。可过了不一会儿，它们就坚持不住了，因为秩序序列实在太长太长了。\n\n现在，你作为一个资深魔法师，有必要告诉他们这种基本的常识。你当然已经知道两个秩序序列的形态，请你帮小L和小K算出最强魔咒的长度和个数。", "inputFormat": "第一行，两个整数$n,m$，分别表示两个秩序序列的长度。\n\n接着第二行与第三行，两个字符串，表示两个秩序序列，长度分别为$n,m$。", "outputFormat": "一行两个整数，用单个空格隔开，分别表示最强魔咒的长度与个数。", "hint": "**样例解释**\n\n样例1：符合规定的魔咒有$a,b,aa,aaa,aba,bab$，其中最强的有$aaa,aba,bab$，长度为$3$，共$3$个。\n\n样例2：符合规定的魔咒有$a,b,aa,aaa,aaaa,bb,baab,aba,aabaa,c$，其中最强的有$aabaa$，长度为$5$，共$1$个。\n\n**数据范围**\n\n由于某些原因，本题需要使用$Subtask$。为取得一个$Subtask$的得分，你需要通过此$Subtask$中的所有数据点。\n|  | 分值 | $n,m$取值范围 | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $Subtask1$ | $0$ | $1\\le n,m\\le260817$ | 是样例 |\n| $Subtask2$ | $5$ | $1\\le n,m\\le260817$ | 两个秩序序列由同一字符组成 |\n| $Subtask3$ | $5$ | $1\\le n,m\\le10$ | 无 |\n| $Subtask4$ | $10$ | $1\\le n,m\\le300$ | 无 |\n| $Subtask5$ | $10$ | $1\\le n,m\\le2000$ | 无 |\n| $Subtask6$ | $30$ | $1\\le n,m\\le260817$ | 两个秩序序列相同 |\n| $Subtask7$ | $40$ | $1\\le n,m\\le260817$ | 无 |\n\n显然，相同的魔咒数量只计一次。保证至少存在一个长度不小于$1$的符合规定的魔咒。\n\n注意时限为$3s$。", "locale": "zh-CN", "translations": {"en": {"title": "Order Spell.", "background": "", "description": "Modern magicians Xiao L and Xiao K are studying spells.\n\n“Do you know how to use spells?”\n\n“Of course. This is the most basic quality of a modern magician.”\n\n“Then how much do you know about the history of spells?”\n\n“I still remember some of what was taught in class. That was a very, very long time ago. Back then, no one in the world could use spells, and chaotic magic was the mainstream magic in the magic world. This was an evil technique: it needed no skill and no rules, and the darker one’s heart was, the stronger its power became. So the evil magicians killed each other, turning the world upside down, with blood flowing like rivers. Among them, a magician who called himself the ‘Chaos Demon’ led a group of magicians who used extremely dirty means to control almost the entire magic world, making it hard for those who longed for order and peace to survive. At that time, the savior of the savior of the world appeared. Two magicians named Laihemu La and Kenmaiduoka bravely stood up. With only the power of the two of them, they started a decisive battle with the Chaos Demon group, but in the end they were outnumbered and forced into a desperate situation. Just as the Chaos Demon’s final strike hit their bodies, Laihemu La and Kenmaiduoka used the huge magical power of that strike to elevate all their remaining magic and will into concepts, creating the Order Spell system, twisting the world’s theory so that chaotic magic was sealed forever. And the Chaos Demon was also reduced to ashes in this intense distortion. From then on, the magic world entered the Age of Order from the Age of Chaos. People followed the last wishes of these two saints, Laihemu La and Kenmaiduoka, and used spells under the Order Spell system, until now.”\n\n“So that’s how it is. This is why we must follow a series of principles when using spells.”\n\n“Yes. This is exactly the effort the two saints made to keep the world from falling back into the Age of Chaos. By the way, you only had your first magic class last week. Do you still remember the principles for using spells?”\n\n“Let me think. First, it must appear in the order sequence. The system left by the two saints, after the unremitting efforts of later magicians, was translated into something called the order sequence. For the convenience of modern magicians, **the order sequence consists only of lowercase English letters**. Because the power of the system was too strong to be limited to only one sequence, **magicians transferred the wills of the two saints into two order sequences respectively**. A spell must be restricted by the order sequence. **Specifically, it must appear in the order sequence (it is a substring of the order sequence)**. Since the wills of the two saints are inseparable, **a spell must appear in both order sequences at the same time**. Second, in order to make the spell stable and accurate, the order system规定了魔咒的形态. **Specifically, the first character of the spell must be the same as the last character of the spell, the second character must be the same as the second-to-last character, and so on**. In this way, the spell becomes symmetric and orderly. As for more, let me see...”\n\n“Stop looking, stop looking. The most important things are these. Also, you might not know: the longer the spell, the stronger its power.”\n\n“Is that so? No wonder the spell the teacher demonstrated that day was so much more powerful than mine.”\n\n“Yes, yes. Have you already noticed that there is an upper limit to the power of spells?”\n\n“Ah, seems so. But the teacher said that the user of the strongest spell has not appeared yet?”\n\n“Right. The user must have ability at the same level as the spell in order to use it smoothly. We beginners don’t know when we will reach that level...”\n\n“Sigh... How about we count the length of the most powerful spell, and how many of them there are?”\n\n“Sure. Anyway we have nothing to do, so let’s do something within our ability.”\n\nSo Xiao L and Xiao K started counting the length and number of the strongest spells. But before long, they could not hold on, because the order sequences were far, far too long.\n\nNow, as a senior magician, you need to tell them this basic common knowledge. You already know the form of the two order sequences. Please help Xiao L and Xiao K compute the length and the number of the strongest spells.", "inputFormat": "The first line contains two integers $n,m$, representing the lengths of the two order sequences.\n\nThen the second and third lines contain two strings, representing the two order sequences, with lengths $n,m$ respectively.", "outputFormat": "Output one line containing two integers separated by a single space, representing the length and the number of the strongest spells.", "hint": "**Sample Explanation**\n\nSample 1: The spells that satisfy the requirements are $a,b,aa,aaa,aba,bab$. Among them, the strongest are $aaa,aba,bab$, with length $3$, and there are $3$ of them.\n\nSample 2: The spells that satisfy the requirements are $a,b,aa,aaa,aaaa,bb,baab,aba,aabaa,c$. Among them, the strongest is $aabaa$, with length $5$, and there is $1$ of it.\n\n**Constraints**\n\nFor some reason, this problem needs to use $Subtask$. To get the score of a $Subtask$, you need to pass all testdata points in this $Subtask$.\n|  | Score | Range of $n,m$ | Special Property |\n| :----------: | :----------: | :----------: | :----------: |\n| $Subtask1$ | $0$ | $1\\le n,m\\le260817$ | Samples |\n| $Subtask2$ | $5$ | $1\\le n,m\\le260817$ | Both order sequences consist of the same single character |\n| $Subtask3$ | $5$ | $1\\le n,m\\le10$ | None |\n| $Subtask4$ | $10$ | $1\\le n,m\\le300$ | None |\n| $Subtask5$ | $10$ | $1\\le n,m\\le2000$ | None |\n| $Subtask6$ | $30$ | $1\\le n,m\\le260817$ | The two order sequences are identical |\n| $Subtask7$ | $40$ | $1\\le n,m\\le260817$ | None |\n\nObviously, identical spells are counted only once. It is guaranteed that there exists at least one valid spell with length at least $1$.\n\nNote that the time limit is $3s$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "秩序魔咒", "background": "", "description": "现代魔法师小L和小K正在研究魔咒。\n\n“你知道如何使用魔咒吗？”\n\n“当然知道，这是一个现代魔法师最基本的修养。”\n\n“那你对魔咒的发展史了解多少？”\n\n“课上讲的我还记得一点。那是在很久很久之前了。当时，世界上还没有人会使用魔咒，而混沌魔法成为了魔法界当时的主流魔法。这是一种邪恶的法术，不需要技巧，不需要规则，内心越黑暗，力量越强。于是，邪恶的魔法师们自相残杀，弄得天昏地暗，血流成河。其中，以自称‘混沌恶魔’的魔法师为首的魔法师集团通过极其肮脏的手段控制了几乎整个魔法界，让那些向往秩序与和平的魔法师难以生存。就在这个时候，世界救星的救星出现了。名为莱赫穆拉和肯埋多卡的两名魔法师勇敢地站了出来，仅凭两个人的力量就与混沌恶魔集团展开了决战，可终究寡不敌众，被逼到了绝境。就在混沌恶魔的最后一击打中他们的身体时，莱赫穆拉和肯埋多卡利用这一击的巨大魔力，将两人余下的全部魔法与意志升格成了概念，创造了秩序魔咒体系，扭转了世界理论，使得混沌魔法被永远封印。而混沌恶魔也在这强烈的扭曲中灰飞烟灭。从此，魔法界由混沌纪元进入了秩序纪元，人们遵循莱赫穆拉和肯埋多卡这两位圣人的遗志，在秩序魔咒体系下使用魔咒，直到现在。”\n\n“原来是这样。我们如今需要遵循一系列原则来使用魔咒，是这个原因啊。”\n\n“是啊，这正是两位圣人为维持现在这个世界不退回混沌纪元而做的努力。话说，你是上个星期才刚刚上了第一堂魔法课，你还记得使用魔咒的几个原则吗？”\n\n“我想想。第一，必须出现在秩序序列中。当时二位圣人留下来的体系，经过后代魔法师不懈的努力，被翻译成了名为秩序序列的存在。为了方便现代魔法师使用，**秩序序列只由英文小写字母组成**。由于体系的力量过于强大而不能仅仅限制在一个序列中，**魔法师们分别将两位圣人的遗志转移到了两个秩序序列里**。魔咒必须受到秩序序列的限制。**具体来说，是必须出现在秩序序列里（是秩序序列的子串）**。由于二位圣人的遗志不可分割，**魔咒必须同时出现在两个秩序序列里**。第二，为了让魔咒稳定而精确，秩序体系规定了魔咒的形态。**具体来说，魔咒的第一个字符需要与魔咒的倒数第一个字符相同，魔咒的第二个字符需要与魔咒的倒数第二个字符相同，以此类推**。这样就可以使魔咒对称而有秩序了。还有的话，让我看看……”\n\n“别看了别看了，最重要的就是这些了。还有，你说不定还不知道，魔咒越长，力量越强大。”\n\n“是这样的吗？难怪那天老师演示的魔咒魔力比我的大那么多。”\n\n“是的是的。你是不是已经发现了，魔咒的力量是有最高限制的？”\n\n“啊，好像没错。但老师那天说，最强魔咒的使用者还没出现？”\n\n“对。使用者自身必须要有与魔咒同样程度的能力，才可能顺利地使用这个魔咒。我们这些初学者，不知道何年何月才能达到这个程度呢……”\n\n“唉……不如，我们来数一数力量最强的魔咒的长度，和它们有多少个吧。”\n\n“嗯，反正没事可做，我们就来干一干这种力所能及的事吧。”\n\n于是，小L和小K就开始数最强魔咒的长度和个数。可过了不一会儿，它们就坚持不住了，因为秩序序列实在太长太长了。\n\n现在，你作为一个资深魔法师，有必要告诉他们这种基本的常识。你当然已经知道两个秩序序列的形态，请你帮小L和小K算出最强魔咒的长度和个数。", "inputFormat": "第一行，两个整数$n,m$，分别表示两个秩序序列的长度。\n\n接着第二行与第三行，两个字符串，表示两个秩序序列，长度分别为$n,m$。", "outputFormat": "一行两个整数，用单个空格隔开，分别表示最强魔咒的长度与个数。", "hint": "**样例解释**\n\n样例1：符合规定的魔咒有$a,b,aa,aaa,aba,bab$，其中最强的有$aaa,aba,bab$，长度为$3$，共$3$个。\n\n样例2：符合规定的魔咒有$a,b,aa,aaa,aaaa,bb,baab,aba,aabaa,c$，其中最强的有$aabaa$，长度为$5$，共$1$个。\n\n**数据范围**\n\n由于某些原因，本题需要使用$Subtask$。为取得一个$Subtask$的得分，你需要通过此$Subtask$中的所有数据点。\n|  | 分值 | $n,m$取值范围 | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $Subtask1$ | $0$ | $1\\le n,m\\le260817$ | 是样例 |\n| $Subtask2$ | $5$ | $1\\le n,m\\le260817$ | 两个秩序序列由同一字符组成 |\n| $Subtask3$ | $5$ | $1\\le n,m\\le10$ | 无 |\n| $Subtask4$ | $10$ | $1\\le n,m\\le300$ | 无 |\n| $Subtask5$ | $10$ | $1\\le n,m\\le2000$ | 无 |\n| $Subtask6$ | $30$ | $1\\le n,m\\le260817$ | 两个秩序序列相同 |\n| $Subtask7$ | $40$ | $1\\le n,m\\le260817$ | 无 |\n\n显然，相同的魔咒数量只计一次。保证至少存在一个长度不小于$1$的符合规定的魔咒。\n\n注意时限为$3s$。", "locale": "zh-CN"}}}
{"pid": "P5556", "type": "P", "difficulty": 6, "samples": [["2 3\n3 4\n1 2\nQuery 1 2\nUpdate 2 2 7\nQuery 2 1", "NO\nYES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["树状数组", "树链剖分", "线性基"], "title": "圣剑护符", "background": "小L和小K正在研究传说中的圣剑。\n\n“所谓圣剑，是封入了各种护符并将其固定为刀剑外形的一种东西。据说一旦用咒力线把护符们接合在一起，就会产生复杂的相互干涉作用。”", "description": "小L和小K面前的圣剑由 $n$ 块护符组成，分别编号为 $1,2,\\ldots , n$ ，有 $n-1$ 条咒力线连接两块护符，形成了一个树形结构。\n\n经过小L和小K的长时间的研究，他们发现护符之间的相互作用并不复杂。每块护符都有一个属性值，第 $i$ 块护符的属性值记为 $v_i$ 。这个值的每个二进制位上的 $0$ 或 $1$ 表示这块护符是否拥有特定属性。所有属性值中相同的二进制位对应的是相同的属性。\n\n对于一系列护符（护符的集合），对于每种特定属性，统计其中包含这一属性的护符数量，如果为偶数，则这一系列护符形成了干涉，最终的属性值对应的二进制位上为 $0$ ，如果为奇数则干涉后剩下了一块护符的影响，对应的二进制位为 $1$ 。也就是说， **护符集合的属性值为单个护符的属性值的异或和** 。 **空集的属性值定义为 $0$** 。\n\n现在，小L想知道，如果取出两块护符 $x,y$ 间的简单路径上的所有护符，能否找到两个不相等的子集，使得两个子集的属性值相同（注意到空集也是路径上所有护符集合的子集）。同时，小K还会将两块护符间的路径上的所有护符取出进行调整，将所有这些护符的属性值在某些相同二进制位上进行修改（即 $0$ 变为 $1$ ， $1$ 变为 $0$ ），可以看做是将所有这些护符的属性值异或上了一个值。", "inputFormat": "输入的第一行为两个整数 $n,q$ ，分别表示护符的数量和小L和小K的操作的数量。\n\n下一行有 $n$ 个整数，第 $i$ 个数表示第 $i$ 块护符的属性值 $v_i$ 。\n\n接下来的 $n-1$ 行，每行有两个整数 $x,y$ ，表示有一条咒力线连接了 $x,y$ 两块护符。保证形成一个树形结构。\n\n接下来的 $q$ 行，每行一个操作，形式如下：\n\n1.  `Update x y z` ：将编号分别为 $x,y$ 的两块护符间的简单路径上的所有护符的属性值异或上一个值 $z$ 。\n\n2. `Query x y` ： 判断对于编号分别为 $x,y$ 的两块护符间的简单路径上的护符的集合，是否存在两个不相等的子集，使得两个子集的属性值相同。", "outputFormat": "对于每个 `Query` 操作，输出一行 `YES` 或 `NO` 。", "hint": "由于某种原因，本题将采用 **捆绑测试** 。只有通过一个子任务内的所有测试点，才能得到该子任务的全部分数，否则得 $0$ 分。\n\n$Subtask\\#1$ ： $20pts$ ， $x,y$ 在树上的距离小于等于 $5$ 。\n\n$Subtask\\#2$ ： $40pts$ ， $n,q\\le 5000,0\\le v_i,z\\le 2^{10}$\n\n$Subtask\\#3$ ： $40pts$ ，无特殊限制。\n\n对于 $100\\%$ 的数据，有 $1\\le n,q\\le 10^5,1\\le x,y\\le n,0\\le v_i,z< 2^{30}$\n", "locale": "zh-CN", "translations": {"en": {"title": "Sacred Sword Talismans", "background": "Xiao L and Xiao K are studying the legendary sacred sword.\n\n“A so-called sacred sword is something made by sealing various talismans and fixing them into the shape of a blade. It is said that once the talismans are connected together with spell-power lines, complicated mutual interference will occur.”", "description": "The sacred sword in front of Xiao L and Xiao K is made of $n$ talismans, numbered $1,2,\\ldots,n$. There are $n-1$ spell-power lines connecting pairs of talismans, forming a tree structure.\n\nAfter a long period of research, they found that the interaction between talismans is not complicated. Each talisman has an attribute value; the attribute value of talisman $i$ is denoted by $v_i$. Each bit ($0$ or $1$) in the binary representation of this value indicates whether the talisman has a certain attribute. The same bit position across all attribute values corresponds to the same attribute.\n\nFor a collection of talismans (a set of talismans), for each specific attribute, count how many talismans in the collection contain this attribute. If the count is even, then this collection produces interference, and the corresponding bit in the final attribute value is $0$. If the count is odd, then after interference there remains the influence of one talisman, and the corresponding bit is $1$. In other words, **the attribute value of a set of talismans is the XOR sum of the attribute values of the individual talismans**. **The attribute value of the empty set is defined as $0$**.\n\nNow, Xiao L wants to know: if we take all talismans on the simple path between two talismans $x$ and $y$, can we find two different subsets such that the two subsets have the same attribute value (note that the empty set is also a subset of the set of all talismans on the path). Meanwhile, Xiao K will also take out all talismans on the path between the two talismans and adjust them, modifying the attribute values of all these talismans on some same bit positions (i.e., changing $0$ to $1$ and $1$ to $0$). This can be seen as XOR-ing the attribute values of all these talismans with a value.", "inputFormat": "The first line contains two integers $n,q$, representing the number of talismans and the number of operations by Xiao L and Xiao K.\n\nThe next line contains $n$ integers. The $i$-th number is the attribute value $v_i$ of talisman $i$.\n\nThe following $n-1$ lines each contain two integers $x,y$, indicating that there is a spell-power line connecting talismans $x$ and $y$. It is guaranteed to form a tree structure.\n\nThe next $q$ lines each describe an operation in one of the following forms:\n\n1. `Update x y z`: XOR the attribute values of all talismans on the simple path between talismans $x$ and $y$ with a value $z$.\n\n2. `Query x y`: Determine whether, for the set of talismans on the simple path between talismans $x$ and $y$, there exist two different subsets such that their attribute values are the same.", "outputFormat": "For each `Query` operation, output one line containing `YES` or `NO`.", "hint": "For some reason, this problem uses **bundled testdata**. You can get the full score of a subtask only if you pass all test points in that subtask; otherwise you get $0$ points.\n\n$Subtask\\#1$: $20pts$, the distance between $x$ and $y$ in the tree is at most $5$.\n\n$Subtask\\#2$: $40pts$, $n,q\\le 5000$, $0\\le v_i,z\\le 2^{10}$.\n\n$Subtask\\#3$: $40pts$, no special constraints.\n\nFor $100\\%$ of the data, $1\\le n,q\\le 10^5$, $1\\le x,y\\le n$, $0\\le v_i,z<2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "圣剑护符", "background": "小L和小K正在研究传说中的圣剑。\n\n“所谓圣剑，是封入了各种护符并将其固定为刀剑外形的一种东西。据说一旦用咒力线把护符们接合在一起，就会产生复杂的相互干涉作用。”", "description": "小L和小K面前的圣剑由 $n$ 块护符组成，分别编号为 $1,2,\\ldots , n$ ，有 $n-1$ 条咒力线连接两块护符，形成了一个树形结构。\n\n经过小L和小K的长时间的研究，他们发现护符之间的相互作用并不复杂。每块护符都有一个属性值，第 $i$ 块护符的属性值记为 $v_i$ 。这个值的每个二进制位上的 $0$ 或 $1$ 表示这块护符是否拥有特定属性。所有属性值中相同的二进制位对应的是相同的属性。\n\n对于一系列护符（护符的集合），对于每种特定属性，统计其中包含这一属性的护符数量，如果为偶数，则这一系列护符形成了干涉，最终的属性值对应的二进制位上为 $0$ ，如果为奇数则干涉后剩下了一块护符的影响，对应的二进制位为 $1$ 。也就是说， **护符集合的属性值为单个护符的属性值的异或和** 。 **空集的属性值定义为 $0$** 。\n\n现在，小L想知道，如果取出两块护符 $x,y$ 间的简单路径上的所有护符，能否找到两个不相等的子集，使得两个子集的属性值相同（注意到空集也是路径上所有护符集合的子集）。同时，小K还会将两块护符间的路径上的所有护符取出进行调整，将所有这些护符的属性值在某些相同二进制位上进行修改（即 $0$ 变为 $1$ ， $1$ 变为 $0$ ），可以看做是将所有这些护符的属性值异或上了一个值。", "inputFormat": "输入的第一行为两个整数 $n,q$ ，分别表示护符的数量和小L和小K的操作的数量。\n\n下一行有 $n$ 个整数，第 $i$ 个数表示第 $i$ 块护符的属性值 $v_i$ 。\n\n接下来的 $n-1$ 行，每行有两个整数 $x,y$ ，表示有一条咒力线连接了 $x,y$ 两块护符。保证形成一个树形结构。\n\n接下来的 $q$ 行，每行一个操作，形式如下：\n\n1.  `Update x y z` ：将编号分别为 $x,y$ 的两块护符间的简单路径上的所有护符的属性值异或上一个值 $z$ 。\n\n2. `Query x y` ： 判断对于编号分别为 $x,y$ 的两块护符间的简单路径上的护符的集合，是否存在两个不相等的子集，使得两个子集的属性值相同。", "outputFormat": "对于每个 `Query` 操作，输出一行 `YES` 或 `NO` 。", "hint": "由于某种原因，本题将采用 **捆绑测试** 。只有通过一个子任务内的所有测试点，才能得到该子任务的全部分数，否则得 $0$ 分。\n\n$Subtask\\#1$ ： $20pts$ ， $x,y$ 在树上的距离小于等于 $5$ 。\n\n$Subtask\\#2$ ： $40pts$ ， $n,q\\le 5000,0\\le v_i,z\\le 2^{10}$\n\n$Subtask\\#3$ ： $40pts$ ，无特殊限制。\n\n对于 $100\\%$ 的数据，有 $1\\le n,q\\le 10^5,1\\le x,y\\le n,0\\le v_i,z< 2^{30}$\n", "locale": "zh-CN"}}}
{"pid": "P5557", "type": "P", "difficulty": 5, "samples": [["6\n2 3 4 5 6 1\n3\n1 2 2\n2 7 1\n6 1 1", "5\n3\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["倍增", "O2优化"], "title": "旅行", "background": "> 光阴似箭。如烟火，只许刹那芳华；似九月，夜幕昙花一闪而散。\n> 辉煌已逝。步征夫，辗转行路之洼；立孤叶，夙夜漂泊四海之旅。\n——《旅行》", "description": "行走与尘世之间，charine 是一位旅行家。踏入城市的喧嚣，他开始了辗转于城市的旅行……\n\n这是一个具有 $n$ 个城市的城市群，每两个点可以互相到达。现代交通技术飞速发展，大大缩短了航程，距离已显得不在那么重要：\n\n城市群里，道路已经没有长长短短之说，**每一条道路由于时间的不断缩短都可视为等长**，把它们以一个单位计量，可以容易的视其为 $1$ zm。\n\n正是由于城市群的庞大，未脱离于城市的 charine 亦有牵绊，这使他不可能无限遨游于这宽广的城市群里。这使 charine 极为郁闷，他决定选择尽可能短的时间走遍整个城市群。\n\n具体而言，charine 不会因为在某个城市里而耽误他遨游天下的决心，他走访的每一个城市，都会在极短的时间里将其印在脑海里。\n\ncharine 的行走速度不会很快，这意味着他只能在一个单位时间内行走 $1$ zm。\n\n这却使他更着急着找到足够旅行更多城市的方法……\n\n为了去除他在每一个岔路口的犹豫时间，charine 亦是聪明的提前了他的旅行计划。对于走出城市 $i$ 的那几个路口，charine 给这个城市定义了一个通路 $a_i$，他相信自己的计划，就一定会踩着通路向前走。**走访完城市 $i$ 的他会给自己的下一个城市目标定为 $a_i$**。\n\n处理完这些以后，他便是再也找不出继续缩短时间的办法了，于是他开始执行了自己的旅行计划。\n\ncharine 有 $m$ 个季度都有出行的机会，对于第 $i$ 个季度，charine 将会从 $S_i$ 出发，他告诉你，他会准备 $t$ 单位时间去旅行。\n\n为了能及时的看到他的身影，你要知道，**$t$ 单位时间后 charine 会出现在哪个城市……**\n\n**注意“道路”与“通路”的定义问题。**", "inputFormat": "输入数据的第一行为一个正整数 $n$，表示城市数。\n\n第二行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。\n\n接下来一个整数 $m$，表示 $m$ 个季度。\n\n第 $4$ 到 $m+3$ 行，描述一次旅行，每行 $3$ 个整数，$S_i,t_1,t_2$，描述见题面，其中，$t=t_1^{t_2}$。", "outputFormat": "对于每个季度输出一行，表示答案。", "hint": "样例解析：\n\n从 $1$ 开始走 $2^{2}$ 步到达 $5$（$1-2-3-4-5$）\n\n从 $2$ 开始走 $7^{1}$ 步到达 $3$（$2-3-4-5-6-1-2-3$）\n\n从 $6$ 开始走 $1^{1}$ 步到达 $1$（$6-1$）\n\n对于 $10\\%$ 的数据，$n\\leq 100$，$m\\leq 300$，$t_1\\leq 100$。\n\n对于 $50\\%$ 的数据，$n\\leq 3000$，$m\\leq 3000$，$t_1\\leq 3000$，$t_2=1$。\n\n对于 $70\\%$ 的数据，$n\\leq 3000$，$m\\leq 3000$。\n\n对于 $100\\%$ 的数据，$n\\leq 400000$，$m\\leq 300000$，$t_1\\leq 10^{9}$，$t_2\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Travel", "background": "> Time flies like an arrow. Like fireworks, beauty lasts only for a moment; like September, the night-blooming cereus flashes and disappears.\n> Glory has faded. Like a traveler on a long march, turning through the lows of the road; like a lonely leaf, wandering day and night on a journey across the world.\n— “Travel”", "description": "Walking through the mortal world, charine is a traveler. Stepping into the noise of cities, he begins his journey from city to city.\n\nThere is a group of cities with $n$ cities, and any two cities are reachable from each other. With the rapid development of modern transportation, travel time has been greatly reduced, so distance no longer seems that important:\n\nIn this city group, roads no longer have different lengths. **Because travel time keeps shrinking, every road can be regarded as having the same length**, measured as one unit, which can be seen as $1$ zm.\n\nHowever, because the city group is huge and charine still has things tying him down, he cannot travel forever in this vast city group. This makes him very upset, so he decides to spend as little time as possible to visit the entire city group.\n\nSpecifically, charine will not waste time staying in any city. Every city he visits will be remembered in a very short time.\n\ncharine does not walk fast, which means he can only walk $1$ zm in one unit of time.\n\nThis makes him even more eager to find a way to travel to more cities.\n\nTo remove the hesitation time at every intersection, charine wisely planned his trip in advance. For the exits leaving city $i$, charine defines a “passage” $a_i$ for this city. He trusts his plan and will definitely follow the passage forward. **After visiting city $i$, he will set his next target city to be $a_i$.**\n\nAfter finishing these preparations, he can no longer find any way to further shorten the time, so he starts executing his travel plan.\n\ncharine has $m$ seasons when he has a chance to travel. For the $i$-th season, charine will start from $S_i$. He tells you that he will prepare $t$ units of time for traveling.\n\nTo see him in time, you need to know: **after $t$ units of time, which city will charine appear in?**\n\n**Note the difference between the definitions of “road” and “passage”.**", "inputFormat": "The first line contains a positive integer $n$, the number of cities.\n\nThe second line contains $n$ integers. The $i$-th integer is $a_i$.\n\nNext is an integer $m$, indicating $m$ seasons.\n\nLines $4$ to $m+3$ each describe one trip. Each line contains three integers $S_i, t_1, t_2$ as described above, where $t=t_1^{t_2}$.", "outputFormat": "For each season, output one line containing the answer.", "hint": "Sample explanation:\n\nStart from $1$ and walk $2^{2}$ steps to reach $5$ ($1-2-3-4-5$).\n\nStart from $2$ and walk $7^{1}$ steps to reach $3$ ($2-3-4-5-6-1-2-3$).\n\nStart from $6$ and walk $1^{1}$ step to reach $1$ ($6-1$).\n\nFor $10\\%$ of the testdata, $n\\leq 100$, $m\\leq 300$, $t_1\\leq 100$.\n\nFor $50\\%$ of the testdata, $n\\leq 3000$, $m\\leq 3000$, $t_1\\leq 3000$, $t_2=1$.\n\nFor $70\\%$ of the testdata, $n\\leq 3000$, $m\\leq 3000$.\n\nFor $100\\%$ of the testdata, $n\\leq 400000$, $m\\leq 300000$, $t_1\\leq 10^{9}$, $t_2\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "旅行", "background": "> 光阴似箭。如烟火，只许刹那芳华；似九月，夜幕昙花一闪而散。\n> 辉煌已逝。步征夫，辗转行路之洼；立孤叶，夙夜漂泊四海之旅。\n——《旅行》", "description": "行走与尘世之间，charine 是一位旅行家。踏入城市的喧嚣，他开始了辗转于城市的旅行……\n\n这是一个具有 $n$ 个城市的城市群，每两个点可以互相到达。现代交通技术飞速发展，大大缩短了航程，距离已显得不在那么重要：\n\n城市群里，道路已经没有长长短短之说，**每一条道路由于时间的不断缩短都可视为等长**，把它们以一个单位计量，可以容易的视其为 $1$ zm。\n\n正是由于城市群的庞大，未脱离于城市的 charine 亦有牵绊，这使他不可能无限遨游于这宽广的城市群里。这使 charine 极为郁闷，他决定选择尽可能短的时间走遍整个城市群。\n\n具体而言，charine 不会因为在某个城市里而耽误他遨游天下的决心，他走访的每一个城市，都会在极短的时间里将其印在脑海里。\n\ncharine 的行走速度不会很快，这意味着他只能在一个单位时间内行走 $1$ zm。\n\n这却使他更着急着找到足够旅行更多城市的方法……\n\n为了去除他在每一个岔路口的犹豫时间，charine 亦是聪明的提前了他的旅行计划。对于走出城市 $i$ 的那几个路口，charine 给这个城市定义了一个通路 $a_i$，他相信自己的计划，就一定会踩着通路向前走。**走访完城市 $i$ 的他会给自己的下一个城市目标定为 $a_i$**。\n\n处理完这些以后，他便是再也找不出继续缩短时间的办法了，于是他开始执行了自己的旅行计划。\n\ncharine 有 $m$ 个季度都有出行的机会，对于第 $i$ 个季度，charine 将会从 $S_i$ 出发，他告诉你，他会准备 $t$ 单位时间去旅行。\n\n为了能及时的看到他的身影，你要知道，**$t$ 单位时间后 charine 会出现在哪个城市……**\n\n**注意“道路”与“通路”的定义问题。**", "inputFormat": "输入数据的第一行为一个正整数 $n$，表示城市数。\n\n第二行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。\n\n接下来一个整数 $m$，表示 $m$ 个季度。\n\n第 $4$ 到 $m+3$ 行，描述一次旅行，每行 $3$ 个整数，$S_i,t_1,t_2$，描述见题面，其中，$t=t_1^{t_2}$。", "outputFormat": "对于每个季度输出一行，表示答案。", "hint": "样例解析：\n\n从 $1$ 开始走 $2^{2}$ 步到达 $5$（$1-2-3-4-5$）\n\n从 $2$ 开始走 $7^{1}$ 步到达 $3$（$2-3-4-5-6-1-2-3$）\n\n从 $6$ 开始走 $1^{1}$ 步到达 $1$（$6-1$）\n\n对于 $10\\%$ 的数据，$n\\leq 100$，$m\\leq 300$，$t_1\\leq 100$。\n\n对于 $50\\%$ 的数据，$n\\leq 3000$，$m\\leq 3000$，$t_1\\leq 3000$，$t_2=1$。\n\n对于 $70\\%$ 的数据，$n\\leq 3000$，$m\\leq 3000$。\n\n对于 $100\\%$ 的数据，$n\\leq 400000$，$m\\leq 300000$，$t_1\\leq 10^{9}$，$t_2\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5558", "type": "P", "difficulty": 6, "samples": [["5\n1 2 5\n2 3 1\n1 4 1\n3 5 4\n3\n2 1\n4 2\n1 1\n", "1\n2\n0\n"], ["7\n1 2 1\n1 3 5\n2 4 1\n4 5 4\n5 6 1\n1 7 1\n5\n7 5\n7 6\n2 7\n1 1\n2 4", "4\n4\n2\n0\n1\n"], ["20\n1 2 1\n1 3 3\n2 4 5\n1 5 1\n5 6 5\n1 7 5\n1 8 4\n7 9 1\n8 10 2\n1 11 1\n2 12 5\n3 13 1\n3 14 3\n3 15 3\n10 16 1\n5 17 1\n12 18 5\n7 19 4\n7 20 5\n10\n10 3\n17 16\n11 9\n4 6\n16 17\n11 16\n11 11\n13 11\n2 1\n10 11", "2\n3\n2\n3\n3\n2\n0\n2\n1\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "倍增", "O2优化", "矩阵加速", "树链剖分"], "title": "心上秋", "background": "辗转经由他人唇齿\n\n多少日夜听闻你的故事\n\n难道这情之一字\n\n竟连抛生死亦不可探知\n\n听说北国的那座城池\n\n被冬雪覆了终日\n\n等到故人长诀渐行渐远\n\n转眼已隔两世\n\n谁向生而死 谁患得患失\n\n相顾也再无多时\n\n画中人暗自 竟心荡神痴\n\n一滴泪氤氲满纸\n\n挥墨描眉目 提笔勾鬓丝\n\n寥寥几笔竟如此\n\n夜半无人处 对月展卷时\n\n忽然看懂这相思\n\n落款谁提了名字\n\n————《心上秋》", "description": "竟宁元年（前33年）正月，昭君出塞前一晚。\n\n画师跌跌撞撞地来到昭君居住的宫殿。\n\n     听说北国的那座城池\n     被冬雪覆了终日\n     等到故人长诀渐行渐远\n     转眼已隔两世\n                ——《心上秋》\n\n如果再也不能相见的话，画师想着，他想给昭君留下些什么。\n\n他想把他的画笔送给昭君。\n\n**昭君的宫殿里有$N$个房间，有$N-1$条道路连接这些房间。**\n\n**画师现在在宫殿的入口大厅$S$房间，他依稀记得，昭君的房间在$T$号。**\n\n窗外，风雨大作，宫内忽暗忽明，一个人影也没有。\n\n画家走进晦暗的通道，每条通道里的墙壁上都画有若干片枫叶，这是之前昭君让画师画的。昭君说，她特别喜欢秋天，尤其喜欢秋天的枫叶。\n\n      并肩长谈过多少往事，恍然间黄昏已至    ——《心上秋》\n\n通道内晦暗无比，画师想点亮通道内备好的蜡烛，他记得昭君有个习惯，**每个通道内的蜡烛数量就是墙上枫叶的数量。昭君若想点燃一条通道内的蜡烛，就会全部点燃，此时昭君认为这条通道已被点亮，并且不会再点亮任何枫叶数少于这条通道的通道**。\n\n这应该是最后一次来到这个地方了，画师想着，他要按昭君的习惯，走到昭君的房间。同时，画师不想走回头路，所以他不会走自己已经走过的通道。\n\n**现在画师想知道，他从宫殿大厅$S$走到昭君房间$T$，在不走回头路的情况下，最多可以点亮多少通道。**", "inputFormat": "第一行一个数$N$，表示宫殿房间数量。\n\n接下来有$N-1$行，每行三个数$u_{i},v_{i},leaf_{i}$，表示$u,v$之间有一条通道，通道上画有$leaf_{i}$片枫叶。\n\n接下来一个数$M$。\n\n最后$M$行，每行两个数$S_{i},T_{i}$", "outputFormat": "输出$M$行，对于每组$S_{i},T_{i}$，输出最多能够点亮的通道数。", "hint": "| 数据编号 | N | M | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $100$ | $100$ | 无 |\n| $2$ | $100$ | $100$ | 无 |\n| $3$ | $100$ | $1000$ | 无 |\n| $4$ | $10000$ | $10000$ | 无 |\n| $5$ | $10000$ | $10000$ | $1$ |\n| $6$ | $10000$ | $10000$ | $1,2$ |\n| $7$ | $10000$ | $10000$ | $1,2$ |\n| $8$ | $30000$ | $100000$ | 无 |\n| $9$ | $30000$ | $100000$ | 无 |\n| $10$ | $30000$ |$300000$  | 无 |\n特殊性质$1$：$1<=leaf_{i}<=2$\n\n特殊性质$2$：$u_{i}+1=v_{i}$\n\n对于所有的数据，保证$1<=leaf_{i}<=5$\n\n样例一解析：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eaxwdth6.png)\n\n询问$1$：从$2$走到$1$最多点亮$1$条通道（$2-1$）\n\n询问$2$：从$4$走到$2$最多点亮$2$条通道（$4-1,1-2$）\n\n询问$3$：显然无法点亮通道。\n\n样例二解析：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8z9tovt5.png))\n\n询问$1$：从$7$走到$5$，可以点亮$4$个通道（$7-1,1-2,2-4,4-5$）\n\n询问$2$：从$7$走到$6$，可以点亮$4$个通道（$7-1,1-2,2-4,4-5$），不点亮（$5-6$）是因为已经点亮（$4-5$）后无法点亮比枫叶数小于$4$的通道，易知这样是最优的，或者不点亮（$4-5$）而点亮（$5-6$），这同样是最优解。\n\n询问$3$：从$2$走到$7$，可以点亮$2$个通道（$2-1$,$1-7$）\n\n询问$4$：不经过任何通道。\n\n询问$5$：经过$1$条通道（$2-4$）\n\n\n     何处合成愁。离人心上秋。纵芭蕉，不雨也飕飕。都道晚凉天气好，有明月，怕登楼。\n\n     年事梦中休。花空烟水流。燕辞归，客尚淹留。垂柳不萦裙带住。漫长是，系行舟。", "locale": "zh-CN", "translations": {"en": {"title": "Heartfelt Autumn", "background": "Windingly passing through others’ lips and teeth.\n\nHow many days and nights have I heard your story.\n\nCould it be that this one word, “love,”\n\nCannot be understood even if one throws away life and death.\n\nI heard that city in the northern land,\n\nIs covered by winter snow all day long.\n\nBy the time old friends part forever and walk farther and farther away,\n\nIn the blink of an eye, it is already two lifetimes apart.\n\nWho goes from life to death, who worries about gain and loss,\n\nThere is not much time left even to look at each other.\n\nThe person in the painting secretly—his heart sways and his spirit is lost.\n\nA drop of tears blurs the whole page.\n\nWaving ink to draw eyebrows and eyes, lifting the brush to trace the hair at the temples.\n\nWith just a few strokes, it turns out to be like this.\n\nAt midnight where no one is, unrolling the scroll to the moon,\n\nSuddenly I understand this longing.\n\nWhose signature wrote the name.\n\n———— “Heartfelt Autumn”\n\n# Background\n\nIn the first month of the first year of Jingning (33 BC), the night before Zhaojun left for the frontier.\n\nThe painter stumbled and crashed as he came to the palace where Zhaojun lived.\n\n> I heard that city in the northern land  \n> Is covered by winter snow all day long  \n> By the time old friends part forever and walk farther and farther away  \n> In the blink of an eye, it is already two lifetimes apart  \n> —— “Heartfelt Autumn”\n\nIf they could never meet again, the painter thought, he wanted to leave something for Zhaojun.\n\nHe wanted to give his paintbrush to Zhaojun.\n\n**There are $N$ rooms in Zhaojun’s palace, connected by $N-1$ roads.**\n\n**The painter is now in the entrance hall room $S$. He vaguely remembers that Zhaojun’s room is number $T$.**\n\nOutside the window, the wind and rain rage. Inside the palace it flickers between light and dark, and there is not a single shadow of a person.\n\nThe painter walks into the dim corridor. On the wall of each corridor, there are several maple leaves painted—these were painted earlier at Zhaojun’s request. Zhaojun said she especially liked autumn, and especially the maple leaves of autumn.\n\n> How many past events did we talk about side by side—before we knew it, dusk had arrived.  \n> —— “Heartfelt Autumn”\n\nThe corridor is extremely dark. The painter wants to light the candles prepared inside. He remembers Zhaojun had a habit: **in each corridor, the number of candles equals the number of maple leaves on the wall. If Zhaojun wants to light the candles in a corridor, she will light them all. At that moment, Zhaojun considers that corridor to be lit up, and she will not light up any corridor whose number of maple leaves is less than that corridor’s**.\n\nThis should be the last time coming to this place, the painter thought. He wants to follow Zhaojun’s habit and walk to Zhaojun’s room. At the same time, the painter does not want to go back the way he came, so he will not take any corridor he has already walked through.\n\n**Now the painter wants to know: when he walks from the palace hall $S$ to Zhaojun’s room $T$, without going back, what is the maximum number of corridors he can light up?**", "description": "In the first month of the first year of Jingning (33 BC), the night before Zhaojun left for the frontier.\n\nThe painter stumbled and crashed as he came to the palace where Zhaojun lived.\n\n> I heard that city in the northern land  \n> Is covered by winter snow all day long  \n> By the time old friends part forever and walk farther and farther away  \n> In the blink of an eye, it is already two lifetimes apart  \n> —— “Heartfelt Autumn”\n\nIf they could never meet again, the painter thought, he wanted to leave something for Zhaojun.\n\nHe wanted to give his paintbrush to Zhaojun.\n\n**There are $N$ rooms in Zhaojun’s palace, connected by $N-1$ roads.**\n\n**The painter is now in the entrance hall room $S$. He vaguely remembers that Zhaojun’s room is number $T$.**\n\nOutside the window, the wind and rain rage. Inside the palace it flickers between light and dark, and there is not a single shadow of a person.\n\nThe painter walks into the dim corridor. On the wall of each corridor, there are several maple leaves painted—these were painted earlier at Zhaojun’s request. Zhaojun said she especially liked autumn, and especially the maple leaves of autumn.\n\n> How many past events did we talk about side by side—before we knew it, dusk had arrived.  \n> —— “Heartfelt Autumn”\n\nThe corridor is extremely dark. The painter wants to light the candles prepared inside. He remembers Zhaojun had a habit: **in each corridor, the number of candles equals the number of maple leaves on the wall. If Zhaojun wants to light the candles in a corridor, she will light them all. At that moment, Zhaojun considers that corridor to be lit up, and she will not light up any corridor whose number of maple leaves is less than that corridor’s**.\n\nThis should be the last time coming to this place, the painter thought. He wants to follow Zhaojun’s habit and walk to Zhaojun’s room. At the same time, the painter does not want to go back the way he came, so he will not take any corridor he has already walked through.\n\n**Now the painter wants to know: when he walks from the palace hall $S$ to Zhaojun’s room $T$, without going back, what is the maximum number of corridors he can light up?**", "inputFormat": "The first line contains an integer $N$, meaning the number of rooms in the palace.\n\nNext there are $N-1$ lines. Each line contains three integers $u_{i}, v_{i}, leaf_{i}$, meaning there is a corridor between $u$ and $v$, and there are $leaf_{i}$ maple leaves painted in that corridor.\n\nNext is an integer $M$.\n\nThe last $M$ lines each contain two integers $S_{i}, T_{i}$.", "outputFormat": "Output $M$ lines. For each query $S_{i}, T_{i}$, output the maximum number of corridors that can be lit.", "hint": "## Constraints\n\n| Test ID | N | M | Special Properties |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $100$ | $100$ | None |\n| $2$ | $100$ | $100$ | None |\n| $3$ | $100$ | $1000$ | None |\n| $4$ | $10000$ | $10000$ | None |\n| $5$ | $10000$ | $10000$ | $1$ |\n| $6$ | $10000$ | $10000$ | $1,2$ |\n| $7$ | $10000$ | $10000$ | $1,2$ |\n| $8$ | $30000$ | $100000$ | None |\n| $9$ | $30000$ | $100000$ | None |\n| $10$ | $30000$ | $300000$ | None |\n\nSpecial property $1$: $1<=leaf_{i}<=2$.\n\nSpecial property $2$: $u_{i}+1=v_{i}$.\n\nFor all testdata, it is guaranteed that $1<=leaf_{i}<=5$.\n\nAnalysis of Sample 1:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eaxwdth6.png)\n\nQuery $1$: From $2$ to $1$, at most $1$ corridor can be lit ($2-1$).\n\nQuery $2$: From $4$ to $2$, at most $2$ corridors can be lit ($4-1, 1-2$).\n\nQuery $3$: Obviously, no corridor can be lit.\n\nAnalysis of Sample 2:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8z9tovt5.png))\n\nQuery $1$: From $7$ to $5$, $4$ corridors can be lit ($7-1, 1-2, 2-4, 4-5$).\n\nQuery $2$: From $7$ to $6$, $4$ corridors can be lit ($7-1, 1-2, 2-4, 4-5$). Not lighting ($5-6$) is because after lighting ($4-5$), it is impossible to light a corridor whose number of maple leaves is less than $4$. It is easy to see this is optimal. Alternatively, do not light ($4-5$) and instead light ($5-6$); this is also optimal.\n\nQuery $3$: From $2$ to $7$, $2$ corridors can be lit ($2-1$, $1-7$).\n\nQuery $4$: Do not pass through any corridor.\n\nQuery $5$: Pass through $1$ corridor ($2-4$).\n\nWhere can sorrow be made whole. Autumn rests on the hearts of those who part. Even banana leaves, without rain, still rustle. All say the late-cool weather is good; there is a bright moon, yet one fears climbing the tower.\n\nLet age and affairs end within dreams. Flowers fall empty, smoke and waters flow. The swallows have left to return, while the traveler still lingers. Drooping willows cannot hold back the skirt belt. Long is it, the rope that ties the moving boat.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "心上秋", "background": "辗转经由他人唇齿\n\n多少日夜听闻你的故事\n\n难道这情之一字\n\n竟连抛生死亦不可探知\n\n听说北国的那座城池\n\n被冬雪覆了终日\n\n等到故人长诀渐行渐远\n\n转眼已隔两世\n\n谁向生而死 谁患得患失\n\n相顾也再无多时\n\n画中人暗自 竟心荡神痴\n\n一滴泪氤氲满纸\n\n挥墨描眉目 提笔勾鬓丝\n\n寥寥几笔竟如此\n\n夜半无人处 对月展卷时\n\n忽然看懂这相思\n\n落款谁提了名字\n\n————《心上秋》", "description": "竟宁元年（前33年）正月，昭君出塞前一晚。\n\n画师跌跌撞撞地来到昭君居住的宫殿。\n\n     听说北国的那座城池\n     被冬雪覆了终日\n     等到故人长诀渐行渐远\n     转眼已隔两世\n                ——《心上秋》\n\n如果再也不能相见的话，画师想着，他想给昭君留下些什么。\n\n他想把他的画笔送给昭君。\n\n**昭君的宫殿里有$N$个房间，有$N-1$条道路连接这些房间。**\n\n**画师现在在宫殿的入口大厅$S$房间，他依稀记得，昭君的房间在$T$号。**\n\n窗外，风雨大作，宫内忽暗忽明，一个人影也没有。\n\n画家走进晦暗的通道，每条通道里的墙壁上都画有若干片枫叶，这是之前昭君让画师画的。昭君说，她特别喜欢秋天，尤其喜欢秋天的枫叶。\n\n      并肩长谈过多少往事，恍然间黄昏已至    ——《心上秋》\n\n通道内晦暗无比，画师想点亮通道内备好的蜡烛，他记得昭君有个习惯，**每个通道内的蜡烛数量就是墙上枫叶的数量。昭君若想点燃一条通道内的蜡烛，就会全部点燃，此时昭君认为这条通道已被点亮，并且不会再点亮任何枫叶数少于这条通道的通道**。\n\n这应该是最后一次来到这个地方了，画师想着，他要按昭君的习惯，走到昭君的房间。同时，画师不想走回头路，所以他不会走自己已经走过的通道。\n\n**现在画师想知道，他从宫殿大厅$S$走到昭君房间$T$，在不走回头路的情况下，最多可以点亮多少通道。**", "inputFormat": "第一行一个数$N$，表示宫殿房间数量。\n\n接下来有$N-1$行，每行三个数$u_{i},v_{i},leaf_{i}$，表示$u,v$之间有一条通道，通道上画有$leaf_{i}$片枫叶。\n\n接下来一个数$M$。\n\n最后$M$行，每行两个数$S_{i},T_{i}$", "outputFormat": "输出$M$行，对于每组$S_{i},T_{i}$，输出最多能够点亮的通道数。", "hint": "| 数据编号 | N | M | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $100$ | $100$ | 无 |\n| $2$ | $100$ | $100$ | 无 |\n| $3$ | $100$ | $1000$ | 无 |\n| $4$ | $10000$ | $10000$ | 无 |\n| $5$ | $10000$ | $10000$ | $1$ |\n| $6$ | $10000$ | $10000$ | $1,2$ |\n| $7$ | $10000$ | $10000$ | $1,2$ |\n| $8$ | $30000$ | $100000$ | 无 |\n| $9$ | $30000$ | $100000$ | 无 |\n| $10$ | $30000$ |$300000$  | 无 |\n特殊性质$1$：$1<=leaf_{i}<=2$\n\n特殊性质$2$：$u_{i}+1=v_{i}$\n\n对于所有的数据，保证$1<=leaf_{i}<=5$\n\n样例一解析：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eaxwdth6.png)\n\n询问$1$：从$2$走到$1$最多点亮$1$条通道（$2-1$）\n\n询问$2$：从$4$走到$2$最多点亮$2$条通道（$4-1,1-2$）\n\n询问$3$：显然无法点亮通道。\n\n样例二解析：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8z9tovt5.png))\n\n询问$1$：从$7$走到$5$，可以点亮$4$个通道（$7-1,1-2,2-4,4-5$）\n\n询问$2$：从$7$走到$6$，可以点亮$4$个通道（$7-1,1-2,2-4,4-5$），不点亮（$5-6$）是因为已经点亮（$4-5$）后无法点亮比枫叶数小于$4$的通道，易知这样是最优的，或者不点亮（$4-5$）而点亮（$5-6$），这同样是最优解。\n\n询问$3$：从$2$走到$7$，可以点亮$2$个通道（$2-1$,$1-7$）\n\n询问$4$：不经过任何通道。\n\n询问$5$：经过$1$条通道（$2-4$）\n\n\n     何处合成愁。离人心上秋。纵芭蕉，不雨也飕飕。都道晚凉天气好，有明月，怕登楼。\n\n     年事梦中休。花空烟水流。燕辞归，客尚淹留。垂柳不萦裙带住。漫长是，系行舟。", "locale": "zh-CN"}}}
{"pid": "P5559", "type": "P", "difficulty": 6, "samples": [["5 2 0\n1 2 2\n1 3 3\n4 3 2\n5 3 7\n0 1 1 0 1\n2 2 4\n2 4 3", "7\n12"], ["6 3 0\n2 1 3\n3 1 5\n4 1 2\n6 4 8\n4 5 9\n1 1 1 0 0 1\n2 1 1\n1 5\n2 3 6", "18\n12"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "树状数组", "O2优化", "树链剖分"], "title": "失昼城的守星使", "background": "> 月伏潮汐生，星染万屿寂，无晦明之变化者，是为失昼。   ————《失昼城手札·起源》\n\n失昼城四面环海，建城于 7325 年前。\n\n失昼城没有黑夜白天的变化，一轮明月自建城伊始就挂在天空，故名失昼。\n\n\n失昼城城主月凌霜，掌控着失昼城的守星塔，守星塔在终日无昼的失昼城中作为照明的灯塔，一直是城里人们的精神寄托，她的另一个身份是失昼城的守星使，比起作为城主，月凌霜更喜欢守着守星塔。\n\n失昼城的特殊环境导致其空间异常不稳定，根据失昼城城史记载，七千多年历史的失昼城，其和平的时间总共不超过三百年，其他大部分时间失昼城局部地区都在空间风暴的笼罩之下，依托于特殊空间存在的守星塔，同时兼具着向人们传递信息的功能，在不稳定的空间影响下，这是唯一能够维持信号稳定的方法。", "description": "失昼城共由 $N$ 座岛屿组成，由 $N-1$ 条传递信息的空间通道联通。\n\n作为失昼城的守星使，月凌霜具有部署守星塔的能力，具体而言，为了依靠特殊空间波动向每个有居民居住的岛屿传递消息，月凌霜可以任意数量地部署守星塔，每座岛屿只能部署一座守星塔，**但是同一时刻所有部署的守星塔必须依靠空间通道连成一条链**。\n\n失昼城常年受到空间风暴的困扰，常常会出现某座岛屿遭受空间风暴，岛上全体居民被迫离开岛屿，此时，**守星塔不再需要向该地传输消息**，等到空间风暴散去，居民重新回到这里，**守星塔才需要恢复向该地的信息传输**。\n\n由于空间波动的干扰，守星塔传递消息必须依靠联通岛屿的空间通道完成，具体而言，如果一座守星塔要向一座岛屿传递消息，**其消耗的能量为该座守星塔所处的岛屿到需要接收消息的岛屿的所有空间通道能耗总和**，当然，如果一座守星塔向自身所处的岛屿发送消息，则不需要消耗能量，守星塔对岛屿传递消息的信号波动互相独立，也就是说，**每座守星塔对于每座岛屿的能量传输互不干扰**。\n\n作为城主兼守星使，月凌霜近期正在研究怎样部署守星塔才能使消息传递所消耗的能量最小，现在月凌霜已经找到了记载失昼城七千多年来空间风暴的爆发情况和当时失昼城的守星塔部署的资料，由于历史过于久远，每次能量的消耗情况已经不得而知，现在月凌霜希望你帮助她还原这些史料，具体详见输入格式。", "inputFormat": "第一行三个数 $N,Q,Type$，表示失昼城岛屿数量，月凌霜的询问个数以及该数据点的特殊性质，$Type$ 在二进制下，若第 $i-1$ 位为 $1$，则表示存在特殊性质 $i$。\n\n接下来 $N-1$ 行，每行三个数 $u_{i},v_{i},w_{i}$ 表示岛屿 $u_i$ 和岛屿 $v_i$ 之间存在一条双向空间通道，消息经过这条空间通道需要消耗能量为 $w_i$。\n\n接下来一行 $N$ 个数，由 $0,1$ 两个数字构成，表示第 $i$ 个岛屿在失昼城建城之时是否存在空间风暴，$0$ 表示存在空间风暴，$1$ 表示不存在，同时我们认为，**如果一个岛屿不存在空间风暴，那么它一定会吸引人们聚居，若存在空间风暴，则不会有人们在该岛屿居住**。\n\n最后 $Q$ 行，每行表示一个事件，具体如下：\n\n$1$  $x$：对于岛屿 $x$，若原本该岛屿没有空间风暴，则空间风暴产生，岛上全体居民撤出该岛，否则表示该岛屿空间风暴散去，人们重新回到这里居住。\n\n$2$  $x$  $y$：月凌霜向你提出一个询问，询问若此时部署守星塔在 $x$ 到 $y$ 的简单路径上，则向**所有有居民的岛屿**传递一次消息所需要的能量消耗之和**最小**为多少。一座守星塔可以同时向多座岛屿传递消息，也可以不向任何岛屿传递消息。", "outputFormat": "输出 $Q$ 行，每行一个数，表示该次询问的答案。", "hint": "|测试点编号|$N \\leq$|$Q \\leq$|1 操作个数 |特殊约束 1|特殊约束 2|特殊约束 3|\n|:---:|:------:|:------:|:-----:|:----:|:----:|:----:|\n|1    |$200$   |$200$   |$\\leq Q$|$0$   |$1$   |$0$   |\n|2    |^       |^       |^      |^     |^     |^     |\n|3    |^       |^       |$0$    |^     |$0$   |^     |\n|4    |^       |^       |^      |^     |^     |$1$   |\n|5    |$2000$  |$2000$  |^      |^     |^     |^     |\n|6    |^       |^       |^      |$1$   |^     |^     |\n|7    |^       |^       |$100$  |^     |$1$   |^     |\n|8    |^       |^       |^      |^     |^     |^     |\n|9    |$200000$|$200000$|^      |^     |^     |^     |\n|10   |^       |^       |^      |^     |^     |^     |\n|11   |^       |^       |^      |^     |$0$   |^     |\n|12   |^       |^       |^      |^     |^     |^     |\n|13   |^       |^       |^      |$0$   |^     |^     |\n|14   |^       |^       |^      |^     |^     |^     |\n|15   |^       |^       |$\\leq Q$|^     |^     |^      |\n|16   |^       |^       |^      |^     |^     |^     |\n|17   |^       |^       |^      |^     |^     |$0$   |\n|18   |^       |^       |^      |^     |^     |^     |\n|19   |^       |^       |^      |^     |^     |^     |\n|20   |^       |^       |^      |^     |^     |^      |\n\n\n\n特殊性质 $1$：$v_{i}=u_{i}+1$。\n\n特殊性质 $2$：月凌霜所有的询问的 $x$ 和 $y$ 相同。\n\n特殊性质 $3$：月凌霜所有的询问的 $x=1$。\n\n对于所有的 $w_{i}$，保证 $0 \\leq w_{i}\\leq 10^{5}$。\n\n对于 $100\\%$ 的数据，保证 $N,Q\\leq 200000,0\\leq Type\\leq 7$。\n\n样例 1 解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/74831.png)\n\n初始图像如左图。\n\n对于第一个询问如中图，有 $2,3,5$ 有居民，所以$ans_2=ans_3=0,ans_5=7$，所以$ans=7$。\n\n对于第二组询问如右图，$ans_2=2+3=5,ans_3=0,ans_5=7$，因此 $ans=7+5=12$。\n\n样例 2 解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/74836.png)\n\n初始图如左上。\n\n询问 $1$ 点如图右上，存在 $1,2,3,6$ 有居民。\n$ans_1=0,ans_2=3,ans_3=5,ans_6=8+2=10$，因此 $ans=3+5+10=18$。\n\n1 操作后所有有居民点如左下。\n\n接下来的操作图为右下，同上有 $ans_1=0,ans_2=3,ans_3=0,ans_5=9,ans_6=0$，所以 $ans=3+9=12$。", "locale": "zh-CN", "translations": {"en": {"title": "Star Tower Keeper of Shizhou City", "background": "> When the moon lies low, the tides are born; when starlight dyes ten thousand isles, all is silent. That which has no change between darkness and light is called Shizhou. ———— *Notes of Shizhou City · Origin*.\n\nShizhou City is surrounded by the sea on all sides and was founded 7325 years ago.\n\nIn Shizhou City, there is no change between night and day. Since the founding of the city, a bright moon has been hanging in the sky, hence the name Shizhou.\n\nThe lord of Shizhou City, Yue Lingxue, controls the Star Tower. In Shizhou City, which never has daytime, the Star Tower serves as a lighthouse for lighting and has always been a spiritual support for the people in the city. Her other identity is the Star Tower Keeper of Shizhou City. Compared with being the city lord, Yue Lingxue prefers guarding the Star Tower.\n\nThe special environment of Shizhou City causes the space there to be extremely unstable. According to the city chronicles, during the more than seven-thousand-year history of Shizhou City, the total time of peace did not exceed three hundred years. During most of the remaining time, local areas of Shizhou City were covered by spatial storms. The Star Tower, which relies on special space to exist, also has the function of transmitting information to people. Under the influence of unstable space, this is the only way to keep signals stable.", "description": "Shizhou City consists of $N$ islands, connected by $N-1$ space channels for transmitting information.\n\nAs the Star Tower Keeper of Shizhou City, Yue Lingxue can deploy Star Towers. Specifically, in order to transmit messages to every island where residents live by relying on special spatial fluctuations, Yue Lingxue may deploy any number of Star Towers. Each island can have at most one Star Tower. **However, at the same time, all deployed Star Towers must be connected into a single chain through space channels**.\n\nShizhou City is troubled by spatial storms all year round. Often, an island will be hit by a spatial storm and all residents on it are forced to leave. At this time, **the Star Towers no longer need to transmit messages to that place**. After the spatial storm dissipates and residents return, **the Star Towers need to resume transmitting information to that place**.\n\nDue to interference from spatial fluctuations, Star Towers must rely on space channels connecting islands to transmit messages. Specifically, if a Star Tower needs to transmit a message to an island, **the energy cost equals the sum of energy costs of all space channels along the path from the island where the Star Tower is located to the destination island**. Of course, if a Star Tower sends a message to the island it is on, no energy is needed. The signal fluctuations of Star Towers transmitting messages to islands are independent of each other, that is, **for each Star Tower and each island, the energy transmission does not interfere with others**.\n\nAs both the city lord and the Star Tower Keeper, Yue Lingxue has recently been studying how to deploy Star Towers to minimize the energy consumed for message transmission. She has found records of spatial storm outbreaks over the past seven thousand years and the Star Tower deployment data at those times. Since the history is too old, the energy consumption of each time is no longer known. Now Yue Lingxue hopes you can help her reconstruct these historical materials. See the input format for details.", "inputFormat": "The first line contains three integers $N,Q,Type$, representing the number of islands in Shizhou City, the number of queries by Yue Lingxue, and the special properties of this test point. In binary, if the $(i-1)$-th bit of $Type$ is $1$, then special property $i$ exists.\n\nThe next $N-1$ lines each contain three integers $u_{i},v_{i},w_{i}$, indicating that there is a bidirectional space channel between islands $u_i$ and $v_i$, and the energy cost for a message to pass through this channel is $w_i$.\n\nThe next line contains $N$ numbers, consisting only of $0$ and $1$, indicating whether there is a spatial storm on the $i$-th island at the time the city was founded. $0$ means there is a spatial storm, and $1$ means there is no spatial storm. We also assume that **if an island has no spatial storm, then it will definitely attract people to live there; if it has a spatial storm, then nobody lives on that island**.\n\nThe last $Q$ lines each describe an event, as follows:\n\n$1$  $x$: For island $x$, if there was originally no spatial storm on this island, then a spatial storm occurs and all residents evacuate the island; otherwise, it means the spatial storm on this island dissipates and people return to live here.\n\n$2$  $x$  $y$: Yue Lingxue asks you a query: if Star Towers are deployed on the simple path from $x$ to $y$ at this moment, what is the **minimum** possible total energy consumption required to transmit one message to **all islands with residents**. A Star Tower can transmit messages to multiple islands at the same time, and it may also transmit to no island.", "outputFormat": "Output $Q$ lines, each containing one number, representing the answer to that query.", "hint": "|Test Point ID|$N \\leq$|$Q \\leq$|Number of operation 1|Special Constraint 1|Special Constraint 2|Special Constraint 3|\n|:---:|:------:|:------:|:-----:|:----:|:----:|:----:|\n|1    |$200$   |$200$   |$\\leq Q$|$0$   |$1$   |$0$   |\n|2    |^       |^       |^      |^     |^     |^     |\n|3    |^       |^       |$0$    |^     |$0$   |^     |\n|4    |^       |^       |^      |^     |^     |$1$   |\n|5    |$2000$  |$2000$  |^      |^     |^     |^     |\n|6    |^       |^       |^      |$1$   |^     |^     |\n|7    |^       |^       |$100$  |^     |$1$   |^     |\n|8    |^       |^       |^      |^     |^     |^     |\n|9    |$200000$|$200000$|^      |^     |^     |^     |\n|10   |^       |^       |^      |^     |^     |^     |\n|11   |^       |^       |^      |^     |$0$   |^     |\n|12   |^       |^       |^      |^     |^     |^     |\n|13   |^       |^       |^      |$0$   |^     |^     |\n|14   |^       |^       |^      |^     |^     |^     |\n|15   |^       |^       |$\\leq Q$|^     |^     |^      |\n|16   |^       |^       |^      |^     |^     |^     |\n|17   |^       |^       |^      |^     |^     |$0$   |\n|18   |^       |^       |^      |^     |^     |^     |\n|19   |^       |^       |^      |^     |^     |^     |\n|20   |^       |^       |^      |^     |^     |^      |\n\nSpecial property $1$: $v_{i}=u_{i}+1$.\n\nSpecial property $2$: In all of Yue Lingxue’s queries, $x$ and $y$ are the same.\n\nSpecial property $3$: In all of Yue Lingxue’s queries, $x=1$.\n\nFor all $w_{i}$, it is guaranteed that $0 \\leq w_{i}\\leq 10^{5}$.\n\nFor $100\\%$ of the data, it is guaranteed that $N,Q\\leq 200000,0\\leq Type\\leq 7$.\n\nSample 1 explanation:\n\n![](https://cdn.luogu.com.cn/upload/pic/74831.png)\n\nThe initial graph is shown on the left.\n\nFor the first query, as shown in the middle, islands $2,3,5$ have residents, so $ans_2=ans_3=0,ans_5=7$, hence $ans=7$.\n\nFor the second query, as shown on the right, $ans_2=2+3=5,ans_3=0,ans_5=7$, hence $ans=7+5=12$.\n\nSample 2 explanation:\n\n![](https://cdn.luogu.com.cn/upload/pic/74836.png)\n\nThe initial graph is shown at the upper left.\n\nFor query $1$, as shown at the upper right, islands $1,2,3,6$ have residents.\n$ans_1=0,ans_2=3,ans_3=5,ans_6=8+2=10$, hence $ans=3+5+10=18$.\n\nAfter one operation 1, all islands with residents are shown at the lower left.\n\nThe subsequent operations are shown at the lower right. Similarly, $ans_1=0,ans_2=3,ans_3=0,ans_5=9,ans_6=0$, so $ans=3+9=12$.\n\n# Input Format\n\n# Output Format\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "失昼城的守星使", "background": "> 月伏潮汐生，星染万屿寂，无晦明之变化者，是为失昼。   ————《失昼城手札·起源》\n\n失昼城四面环海，建城于 7325 年前。\n\n失昼城没有黑夜白天的变化，一轮明月自建城伊始就挂在天空，故名失昼。\n\n\n失昼城城主月凌霜，掌控着失昼城的守星塔，守星塔在终日无昼的失昼城中作为照明的灯塔，一直是城里人们的精神寄托，她的另一个身份是失昼城的守星使，比起作为城主，月凌霜更喜欢守着守星塔。\n\n失昼城的特殊环境导致其空间异常不稳定，根据失昼城城史记载，七千多年历史的失昼城，其和平的时间总共不超过三百年，其他大部分时间失昼城局部地区都在空间风暴的笼罩之下，依托于特殊空间存在的守星塔，同时兼具着向人们传递信息的功能，在不稳定的空间影响下，这是唯一能够维持信号稳定的方法。", "description": "失昼城共由 $N$ 座岛屿组成，由 $N-1$ 条传递信息的空间通道联通。\n\n作为失昼城的守星使，月凌霜具有部署守星塔的能力，具体而言，为了依靠特殊空间波动向每个有居民居住的岛屿传递消息，月凌霜可以任意数量地部署守星塔，每座岛屿只能部署一座守星塔，**但是同一时刻所有部署的守星塔必须依靠空间通道连成一条链**。\n\n失昼城常年受到空间风暴的困扰，常常会出现某座岛屿遭受空间风暴，岛上全体居民被迫离开岛屿，此时，**守星塔不再需要向该地传输消息**，等到空间风暴散去，居民重新回到这里，**守星塔才需要恢复向该地的信息传输**。\n\n由于空间波动的干扰，守星塔传递消息必须依靠联通岛屿的空间通道完成，具体而言，如果一座守星塔要向一座岛屿传递消息，**其消耗的能量为该座守星塔所处的岛屿到需要接收消息的岛屿的所有空间通道能耗总和**，当然，如果一座守星塔向自身所处的岛屿发送消息，则不需要消耗能量，守星塔对岛屿传递消息的信号波动互相独立，也就是说，**每座守星塔对于每座岛屿的能量传输互不干扰**。\n\n作为城主兼守星使，月凌霜近期正在研究怎样部署守星塔才能使消息传递所消耗的能量最小，现在月凌霜已经找到了记载失昼城七千多年来空间风暴的爆发情况和当时失昼城的守星塔部署的资料，由于历史过于久远，每次能量的消耗情况已经不得而知，现在月凌霜希望你帮助她还原这些史料，具体详见输入格式。", "inputFormat": "第一行三个数 $N,Q,Type$，表示失昼城岛屿数量，月凌霜的询问个数以及该数据点的特殊性质，$Type$ 在二进制下，若第 $i-1$ 位为 $1$，则表示存在特殊性质 $i$。\n\n接下来 $N-1$ 行，每行三个数 $u_{i},v_{i},w_{i}$ 表示岛屿 $u_i$ 和岛屿 $v_i$ 之间存在一条双向空间通道，消息经过这条空间通道需要消耗能量为 $w_i$。\n\n接下来一行 $N$ 个数，由 $0,1$ 两个数字构成，表示第 $i$ 个岛屿在失昼城建城之时是否存在空间风暴，$0$ 表示存在空间风暴，$1$ 表示不存在，同时我们认为，**如果一个岛屿不存在空间风暴，那么它一定会吸引人们聚居，若存在空间风暴，则不会有人们在该岛屿居住**。\n\n最后 $Q$ 行，每行表示一个事件，具体如下：\n\n$1$  $x$：对于岛屿 $x$，若原本该岛屿没有空间风暴，则空间风暴产生，岛上全体居民撤出该岛，否则表示该岛屿空间风暴散去，人们重新回到这里居住。\n\n$2$  $x$  $y$：月凌霜向你提出一个询问，询问若此时部署守星塔在 $x$ 到 $y$ 的简单路径上，则向**所有有居民的岛屿**传递一次消息所需要的能量消耗之和**最小**为多少。一座守星塔可以同时向多座岛屿传递消息，也可以不向任何岛屿传递消息。", "outputFormat": "输出 $Q$ 行，每行一个数，表示该次询问的答案。", "hint": "|测试点编号|$N \\leq$|$Q \\leq$|1 操作个数 |特殊约束 1|特殊约束 2|特殊约束 3|\n|:---:|:------:|:------:|:-----:|:----:|:----:|:----:|\n|1    |$200$   |$200$   |$\\leq Q$|$0$   |$1$   |$0$   |\n|2    |^       |^       |^      |^     |^     |^     |\n|3    |^       |^       |$0$    |^     |$0$   |^     |\n|4    |^       |^       |^      |^     |^     |$1$   |\n|5    |$2000$  |$2000$  |^      |^     |^     |^     |\n|6    |^       |^       |^      |$1$   |^     |^     |\n|7    |^       |^       |$100$  |^     |$1$   |^     |\n|8    |^       |^       |^      |^     |^     |^     |\n|9    |$200000$|$200000$|^      |^     |^     |^     |\n|10   |^       |^       |^      |^     |^     |^     |\n|11   |^       |^       |^      |^     |$0$   |^     |\n|12   |^       |^       |^      |^     |^     |^     |\n|13   |^       |^       |^      |$0$   |^     |^     |\n|14   |^       |^       |^      |^     |^     |^     |\n|15   |^       |^       |$\\leq Q$|^     |^     |^      |\n|16   |^       |^       |^      |^     |^     |^     |\n|17   |^       |^       |^      |^     |^     |$0$   |\n|18   |^       |^       |^      |^     |^     |^     |\n|19   |^       |^       |^      |^     |^     |^     |\n|20   |^       |^       |^      |^     |^     |^      |\n\n\n\n特殊性质 $1$：$v_{i}=u_{i}+1$。\n\n特殊性质 $2$：月凌霜所有的询问的 $x$ 和 $y$ 相同。\n\n特殊性质 $3$：月凌霜所有的询问的 $x=1$。\n\n对于所有的 $w_{i}$，保证 $0 \\leq w_{i}\\leq 10^{5}$。\n\n对于 $100\\%$ 的数据，保证 $N,Q\\leq 200000,0\\leq Type\\leq 7$。\n\n样例 1 解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/74831.png)\n\n初始图像如左图。\n\n对于第一个询问如中图，有 $2,3,5$ 有居民，所以$ans_2=ans_3=0,ans_5=7$，所以$ans=7$。\n\n对于第二组询问如右图，$ans_2=2+3=5,ans_3=0,ans_5=7$，因此 $ans=7+5=12$。\n\n样例 2 解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/74836.png)\n\n初始图如左上。\n\n询问 $1$ 点如图右上，存在 $1,2,3,6$ 有居民。\n$ans_1=0,ans_2=3,ans_3=5,ans_6=8+2=10$，因此 $ans=3+5+10=18$。\n\n1 操作后所有有居民点如左下。\n\n接下来的操作图为右下，同上有 $ans_1=0,ans_2=3,ans_3=0,ans_5=9,ans_6=0$，所以 $ans=3+9=12$。", "locale": "zh-CN"}}}
{"pid": "P5560", "type": "P", "difficulty": 4, "samples": [["4\n1\n2\n3\n9\n", "0\n1\n2\n8"]], "limits": {"time": [500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000]}, "tags": [], "title": "[Celeste-B] Golden Feather", "background": "> 就是这样，Madeline。\n\n> 保持呼吸。你能行。", "description": "“你的呼吸让那片羽毛一直飘着。”\n\n“平稳缓慢地呼吸，吸气，吐气。”\n\n“看吧，每次都是这么轻松。”\n\n随着 Madeline 的呼吸，羽毛上下移动着。\n\n通过 Madeline 的观察，她还发现，羽毛似乎遵循这一种神奇的运动轨迹。\n\n在每一轮呼吸中，羽毛会在特定的地方停止，这些地方都是有魔力的，具体来说，第 $i$ 个停留处的魔力是 $(i+1)^2-1$。\n\n并且，在一轮呼吸停止时，羽毛会渗透出一些能量，只要能用这些能量沟通这些停止的地方，Madeline 就能运用羽毛的力量飞翔。更具体的，由于同性相斥，两个地方魔力的相似程度越高就越难被沟通，沟通两个地方所需要的能量为这两个地方魔力的 $gcd$。\n\n在一轮一轮的呼吸中，Madeline 已经无暇算出最少需要的能量，由于羽毛渗透出的能量不多，你能帮帮她算出最少需要多少能量来沟通这些羽毛停止的地方吗？", "inputFormat": "第一行一个正整数 $T$，表示呼吸轮数。\n\n接下来 $T$ 行一行一个正整数 $n$，表示该轮呼吸中羽毛停止的地方个数。", "outputFormat": "输出 $T$ 行，一行一个整数，最少需要的能量。", "hint": "n=3 的样例解释如下图\n\n![T1_2.png](https://i.loli.net/2019/09/14/PtflkNCE8b3iKzB.png)\n![T1.png](https://i.loli.net/2019/09/14/AIYlMZgonL7thfu.png)\n\n对于 $5\\%$ 的数据，$n \\leq 3$\n\n对于 $10\\%$ 的数据，$n \\leq 1000$\n\n对于 $50\\%$ 的数据，$n \\leq 10^6$,$T \\leq 10$\n\n对于 $100\\%$ 的数据，$n \\leq 10^{18}$,$T \\leq 100$", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-B] Golden Feather", "background": "> That is it, Madeline.\n\n> Keep breathing. You can do it.", "description": "\"Your breathing keeps that feather floating.\"\n\n\"Breathe steadily and slowly. Inhale, exhale.\"\n\n\"See, it is this easy every time.\"\n\nAs Madeline breathes, the feather moves up and down.\n\nFrom her observation, Madeline also found that the feather seems to follow a strange trajectory.\n\nIn each round of breathing, the feather stops at certain places. These places are magical. Specifically, the magic value of the $i$-th stop is $(i+1)^2-1$.\n\nAlso, when a round of breathing ends, the feather seeps out some energy. As long as she can use this energy to connect these stopping places, Madeline can use the feather's power to fly. More specifically, due to \"like repels like\", the more similar the magic values of two places are, the harder it is to connect them. The energy required to connect two places is the $gcd$ of their magic values.\n\nWith one breath after another, Madeline has no time to compute the minimum energy needed. Since the energy seeping out of the feather is limited, can you help her compute the minimum energy needed to connect these places where the feather stops?", "inputFormat": "The first line contains a positive integer $T$, indicating the number of breathing rounds.\n\nThe next $T$ lines each contain a positive integer $n$, indicating the number of stopping places of the feather in that round.", "outputFormat": "Output $T$ lines, one integer per line, representing the minimum energy required.", "hint": "The sample explanation for $n=3$ is shown in the figures below.\n\n![T1_2.png](https://i.loli.net/2019/09/14/PtflkNCE8b3iKzB.png)\n![T1.png](https://i.loli.net/2019/09/14/AIYlMZgonL7thfu.png)\n\nConstraints:\n\nFor $5\\%$ of the testdata, $n \\leq 3$.\n\nFor $10\\%$ of the testdata, $n \\leq 1000$.\n\nFor $50\\%$ of the testdata, $n \\leq 10^6$, $T \\leq 10$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^{18}$, $T \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-B] Golden Feather", "background": "> 就是这样，Madeline。\n\n> 保持呼吸。你能行。", "description": "“你的呼吸让那片羽毛一直飘着。”\n\n“平稳缓慢地呼吸，吸气，吐气。”\n\n“看吧，每次都是这么轻松。”\n\n随着 Madeline 的呼吸，羽毛上下移动着。\n\n通过 Madeline 的观察，她还发现，羽毛似乎遵循这一种神奇的运动轨迹。\n\n在每一轮呼吸中，羽毛会在特定的地方停止，这些地方都是有魔力的，具体来说，第 $i$ 个停留处的魔力是 $(i+1)^2-1$。\n\n并且，在一轮呼吸停止时，羽毛会渗透出一些能量，只要能用这些能量沟通这些停止的地方，Madeline 就能运用羽毛的力量飞翔。更具体的，由于同性相斥，两个地方魔力的相似程度越高就越难被沟通，沟通两个地方所需要的能量为这两个地方魔力的 $gcd$。\n\n在一轮一轮的呼吸中，Madeline 已经无暇算出最少需要的能量，由于羽毛渗透出的能量不多，你能帮帮她算出最少需要多少能量来沟通这些羽毛停止的地方吗？", "inputFormat": "第一行一个正整数 $T$，表示呼吸轮数。\n\n接下来 $T$ 行一行一个正整数 $n$，表示该轮呼吸中羽毛停止的地方个数。", "outputFormat": "输出 $T$ 行，一行一个整数，最少需要的能量。", "hint": "n=3 的样例解释如下图\n\n![T1_2.png](https://i.loli.net/2019/09/14/PtflkNCE8b3iKzB.png)\n![T1.png](https://i.loli.net/2019/09/14/AIYlMZgonL7thfu.png)\n\n对于 $5\\%$ 的数据，$n \\leq 3$\n\n对于 $10\\%$ 的数据，$n \\leq 1000$\n\n对于 $50\\%$ 的数据，$n \\leq 10^6$,$T \\leq 10$\n\n对于 $100\\%$ 的数据，$n \\leq 10^{18}$,$T \\leq 100$", "locale": "zh-CN"}}}
{"pid": "P5561", "type": "P", "difficulty": 6, "samples": [["3\nabccccd\nabccddc\nacbbcad\n5\n1 1 1 7\n1 2 1 7\n1 3 1 7\n2 3\n2 2\n", "7\n4\n1\n4\n7\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "[Celeste-B] Mirror Magic", "background": "> ...\n\n> 呼吸。\n\n> 你能站起来，Madeline\n\n> 想想羽毛。你能拯救 Theo", "description": "镜之神庙是一座有魔力的神庙，在这里你能一窥自己心灵的真相。\n\nTheo 被困在了一面镜子里。当 Madeline 尝试去拯救 Theo 时，神庙里的\"生物\"们给她出了一道难题，这道难题是这样的：\n\n神庙的\"生物\"们准备了 $n$ 串草莓，这些草莓的长度之和 $<= 10^6$，现在它们可以执行这样一些操作：\n\n$1\\ x\\ l\\ r$，表示将编号 $x$ 的草莓串的子草莓串 $[l,r]$ 复制一份，插入当前的草莓集合中，保证草莓串 $x$ 的长度 $>=r$。\n\n$2\\ k$，表示删除第 $k$ 次操作插入的草莓串，保证第 $k$ 次操作为插入并且此时第 $k$ 次操作插入的草莓串在集合中。\n\n\"生物\"们认为和谐的味道才是美味的。在执行任意一次操作之后，\"生物\"们想要知道当前集合中所有草莓串的美味度(即 $LCP$ - 最长公共前缀)。（若集合为空，则美味度 $0$，若集合中只有一个草莓串，则美味度为草莓串的长度）\n\n为了方便表达，我们把每一种草莓表示为一个**小写英文字母**。\n\n多年以后，Madeline 又来到了镜之神庙，想要回忆多年前自己的登山旅途，可是她已经不记得自己当年是怎么解决那道谜题的了，你能帮帮她找到谜题的答案吗？", "inputFormat": "第一行一个正整数 $n$，表示草莓串的个数。\n\n接下来 $n$ 行一行一个**只包含小写字母**的字符串，表示原来的 $n$ 个草莓串。\n\n接下来一行一个正整数 $q$，表示操作个数。\n\n接下来 $q$ 行一行一个操作。", "outputFormat": "输出 $q$ 行，对应每次操作之后集合中草莓串的美味度($LCP$ - 最长公共前缀).", "hint": "样例解释：\n\n第一次操作后，集合为 $\\{\"abccccd\"\\}$,$LCP=7$\n\n第二次操作后，集合为 $\\{\"abccccd\",\"abccddc\"\\}$,$LCP=4$\n\n第三次操作后，集合为 $\\{\"abccccd\",\"abccddc\",\"acbbcad\"\\}$,$LCP=1$\n\n第四次删除了第三次插入的串，故 $LCP=4$\n\n第五次删除了第二次插入的串，故 $LCP=7$\n\n令 $len$ 等于 $n$ 个串的长度之和。总有 $len \\leq 10^6$\n\nSubtask $1$($10$ Pts), $n \\leq 5, q = 10$\n\nSubtask $2$($30$ Pts), $n \\leq 10^6, q = 10^6$, 保证每次插入的是串的一个前缀\n\nSubtask $3$($10$ Pts), $n \\leq 10^6, q = 10^5$, 不含 $2$ 操作, **保证询问为随机生成**\n\nSubtask $4$($50$ Pts), $n \\leq 10^6, q = 10^6$\n\n提示：你可以根据 $q$ 判断 Subtask 编号\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-B] Mirror Magic", "background": "> ...\n\n> Breathe.\n\n> You can stand up, Madeline.\n\n> Think of the feather. You can save Theo.", "description": "The Mirror Temple is a magical temple, where you can catch a glimpse of the truth in your heart.\n\nTheo is trapped inside a mirror. When Madeline tries to save Theo, the “creatures” in the temple give her a difficult puzzle. The puzzle is as follows:\n\nThe “creatures” prepare $n$ strawberry strings, and the sum of their lengths $<= 10^6$. Now they can perform the following operations:\n\n$1\\ x\\ l\\ r$ means copying the substring $[l,r]$ of the strawberry string with index $x$, and inserting the copied string into the current set of strawberry strings. It is guaranteed that the length of string $x$ is $>=r$.\n\n$2\\ k$ means deleting the strawberry string that was inserted by the $k$-th operation. It is guaranteed that the $k$-th operation is an insertion, and the string inserted by the $k$-th operation is currently in the set.\n\nThe “creatures” believe that a harmonious flavor is delicious. After performing any operation, they want to know the deliciousness of all strawberry strings in the current set (i.e., $LCP$ - the longest common prefix). (If the set is empty, the deliciousness is $0$. If there is only one strawberry string in the set, the deliciousness is the length of that string.)\n\nFor convenience, we represent each type of strawberry as a **lowercase English letter**.\n\nMany years later, Madeline comes to the Mirror Temple again, wanting to recall her climbing journey from long ago, but she no longer remembers how she solved that puzzle back then. Can you help her find the answer to the puzzle?", "inputFormat": "The first line contains a positive integer $n$, indicating the number of strawberry strings.\n\nThe next $n$ lines each contain a string consisting of **only lowercase letters**, representing the original $n$ strawberry strings.\n\nThe next line contains a positive integer $q$, indicating the number of operations.\n\nThe next $q$ lines each contain one operation.", "outputFormat": "Output $q$ lines. Each line should be the deliciousness ($LCP$ - the longest common prefix) of the strawberry strings in the set after the corresponding operation.", "hint": "Sample explanation:\n\nAfter the first operation, the set is $\\{\"abccccd\"\\}$, $LCP=7$.\n\nAfter the second operation, the set is $\\{\"abccccd\",\"abccddc\"\\}$, $LCP=4$.\n\nAfter the third operation, the set is $\\{\"abccccd\",\"abccddc\",\"acbbcad\"\\}$, $LCP=1$.\n\nThe fourth operation deletes the string inserted by the third operation, so $LCP=4$.\n\nThe fifth operation deletes the string inserted by the second operation, so $LCP=7$.\n\nLet $len$ be the sum of lengths of the $n$ strings. We always have $len \\leq 10^6$.\n\nSubtask $1$ ($10$ Pts): $n \\leq 5, q = 10$.\n\nSubtask $2$ ($30$ Pts): $n \\leq 10^6, q = 10^6$, and it is guaranteed that each insertion is a prefix of a string.\n\nSubtask $3$ ($10$ Pts): $n \\leq 10^6, q = 10^5$, there are no type $2$ operations, and **it is guaranteed that the queries are randomly generated**.\n\nSubtask $4$ ($50$ Pts): $n \\leq 10^6, q = 10^6$.\n\nHint: You can determine the subtask number based on $q$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-B] Mirror Magic", "background": "> ...\n\n> 呼吸。\n\n> 你能站起来，Madeline\n\n> 想想羽毛。你能拯救 Theo", "description": "镜之神庙是一座有魔力的神庙，在这里你能一窥自己心灵的真相。\n\nTheo 被困在了一面镜子里。当 Madeline 尝试去拯救 Theo 时，神庙里的\"生物\"们给她出了一道难题，这道难题是这样的：\n\n神庙的\"生物\"们准备了 $n$ 串草莓，这些草莓的长度之和 $<= 10^6$，现在它们可以执行这样一些操作：\n\n$1\\ x\\ l\\ r$，表示将编号 $x$ 的草莓串的子草莓串 $[l,r]$ 复制一份，插入当前的草莓集合中，保证草莓串 $x$ 的长度 $>=r$。\n\n$2\\ k$，表示删除第 $k$ 次操作插入的草莓串，保证第 $k$ 次操作为插入并且此时第 $k$ 次操作插入的草莓串在集合中。\n\n\"生物\"们认为和谐的味道才是美味的。在执行任意一次操作之后，\"生物\"们想要知道当前集合中所有草莓串的美味度(即 $LCP$ - 最长公共前缀)。（若集合为空，则美味度 $0$，若集合中只有一个草莓串，则美味度为草莓串的长度）\n\n为了方便表达，我们把每一种草莓表示为一个**小写英文字母**。\n\n多年以后，Madeline 又来到了镜之神庙，想要回忆多年前自己的登山旅途，可是她已经不记得自己当年是怎么解决那道谜题的了，你能帮帮她找到谜题的答案吗？", "inputFormat": "第一行一个正整数 $n$，表示草莓串的个数。\n\n接下来 $n$ 行一行一个**只包含小写字母**的字符串，表示原来的 $n$ 个草莓串。\n\n接下来一行一个正整数 $q$，表示操作个数。\n\n接下来 $q$ 行一行一个操作。", "outputFormat": "输出 $q$ 行，对应每次操作之后集合中草莓串的美味度($LCP$ - 最长公共前缀).", "hint": "样例解释：\n\n第一次操作后，集合为 $\\{\"abccccd\"\\}$,$LCP=7$\n\n第二次操作后，集合为 $\\{\"abccccd\",\"abccddc\"\\}$,$LCP=4$\n\n第三次操作后，集合为 $\\{\"abccccd\",\"abccddc\",\"acbbcad\"\\}$,$LCP=1$\n\n第四次删除了第三次插入的串，故 $LCP=4$\n\n第五次删除了第二次插入的串，故 $LCP=7$\n\n令 $len$ 等于 $n$ 个串的长度之和。总有 $len \\leq 10^6$\n\nSubtask $1$($10$ Pts), $n \\leq 5, q = 10$\n\nSubtask $2$($30$ Pts), $n \\leq 10^6, q = 10^6$, 保证每次插入的是串的一个前缀\n\nSubtask $3$($10$ Pts), $n \\leq 10^6, q = 10^5$, 不含 $2$ 操作, **保证询问为随机生成**\n\nSubtask $4$($50$ Pts), $n \\leq 10^6, q = 10^6$\n\n提示：你可以根据 $q$ 判断 Subtask 编号\n\n", "locale": "zh-CN"}}}
{"pid": "P5562", "type": "P", "difficulty": 5, "samples": [["2", "8\n1 1 1\n1 1 2\n1 2 1\n1 2 2\n2 1 1\n2 1 2\n2 2 1\n2 2 2"]], "limits": {"time": [1000, 1000, 1000], "memory": [128000, 128000, 128000]}, "tags": ["Special Judge"], "title": "[Celeste-B] Center of the Earth", "background": "> 我曾如此地接近。\n\n> 我**恨**她。\n\n> \n\n> ...\n\n> 我这次一定要坚持到底。\n\n> 不能再逃跑了。", "description": "Madeline 来到了一座神龛前，这座神龛布满尘埃，四周还都是不明所以的符号。\n\n通过 Madeline 强大的观察能力，她发现这些符号其实对应着一个个冲刺顺序，按照一定顺序冲刺就相当于输入一个密码，只有输入特定的密码才能点亮神龛获得水晶之心。\n\n多年之后，当 Madeline 回忆她的登山之旅时，她已经不记得密码是什么了，只记得密码长度为 $3$，并且每一位密码有 $n$ 种可能。她还知道，在她输入的密码中，任意两位与标准密码相符就能点亮神龛获得水晶之心。\n\n今天，Madeline 又回到了这座神龛前，她希望使用最少的输入密码次数来保证能获得这颗水晶之心，你能帮帮她吗？", "inputFormat": "第一行一个整数 $n$，表示每一位密码有多少种可能。", "outputFormat": "第一行输出一个整数 $k$，表示你给出的方案中输入密码的次数。\n\n接下来 $k$ 行，输出每次尝试的密码。", "hint": "样例不是最优解，只是对输出的一个示例。\n\n**请务必输出方案，否则可能会遇到未知错误**\n\n共有三个测试点：\n\n测试点 $1$($10$pts) : $n=2$\n\n测试点 $2$($20$pts) : $n=100$\n\n测试点 $3$($70$pts) : $n=1000$\n\n对于每组数据我们采取如下评分方式：\n\n- 若 $k > 5000000$ ，你的输出过大，你将无法得到任何分数。\n\n- 否则：\n\n  - 若给出的方案无法保证能点亮神龛，或者方案本身是错误的，则按照如下规则评分：\n\n    - 若 $k$ 小于最小次数，不给分。\n\n    - 否则，若 $k$ 等于最小次数，则给出该测试点 $10\\%$ 的分数。\n\n    - 否则，若你的 $k$ 是最小次数的 $q$ 倍，你将得到这个测试点 $\\frac{1}{10*q}$ 的分数。\n\n  - 否则，你的方案可以保证点亮神龛，则按照如下规则评分：\n\n    - 首先得到 $10\\%$ 的基础分。\n\n    - 接着，令最小次数为 $p$，你将得到如下额外分数：\n\n      - $k=p$，你将得到 $90\\%$ 的额外分数。\n\n      - $p<k<=1.5p$，你将得到 $50+\\frac{1.5p-k}{0.5p}*40\\%$ 的额外分数。\n\n      - $1.5p<k<=2p$，你将得到 $20+\\frac{2p-k}{0.5p}*30\\%$ 的额外分数。\n\n      - $k>2p$，你将不会得到额外分数。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-B] Center of the Earth", "background": "> I was once so close.\n>\n> I **hate** her.\n>\n> ...\n>\n> This time, I must hold on until the end.\n>\n> I cannot run away anymore.", "description": "Madeline comes to a shrine. It is covered in dust, and it is surrounded by strange symbols whose meaning is unclear.\n\nWith Madeline’s strong observation skills, she discovers that these symbols actually correspond to dash sequences. Dashing in a certain order is like entering a password. Only by entering a specific password can she light up the shrine and obtain the Crystal Heart.\n\nMany years later, when Madeline recalls her climbing journey, she no longer remembers what the password was. She only remembers that the password length is $3$, and each position of the password has $n$ possible values. She also knows that for the password she enters, as long as any two positions match the standard password, she can light up the shrine and obtain the Crystal Heart.\n\nToday, Madeline returns to the shrine again. She wants to use the minimum number of password attempts to guarantee that she can obtain the Crystal Heart. Can you help her?", "inputFormat": "The first line contains an integer $n$, indicating how many possible values there are for each position of the password.", "outputFormat": "The first line outputs an integer $k$, indicating the number of password attempts in your plan.\n\nThe next $k$ lines output the password for each attempt.", "hint": "The sample is not an optimal solution; it is only an example of the output.\n\n**You must output a plan, otherwise you may encounter unknown errors.**\n\nThere are three test points:\n\n- Test point $1$ ($10$ pts): $n=2$.\n- Test point $2$ ($20$ pts): $n=100$.\n- Test point $3$ ($70$ pts): $n=1000$.\n\nFor each dataset, we use the following scoring method:\n\n- If $k > 5000000$, your output is too large, and you will not get any score.\n\n- Otherwise:\n\n  - If the plan you provide cannot guarantee lighting up the shrine, or the plan itself is incorrect, then it is scored as follows:\n\n    - If $k$ is less than the minimum number of attempts, you get $0$ points.\n\n    - Otherwise, if $k$ equals the minimum number of attempts, you get $10\\%$ of the score for this test point.\n\n    - Otherwise, if your $k$ is $q$ times the minimum number of attempts, you will get $\\frac{1}{10*q}$ of the score for this test point.\n\n  - Otherwise, if your plan can guarantee lighting up the shrine, it is scored as follows:\n\n    - First, you get a base score of $10\\%$.\n\n    - Then, let the minimum number of attempts be $p$. You will get the following additional score:\n\n      - If $k=p$, you will get an additional $90\\%$.\n\n      - If $p<k<=1.5p$, you will get an additional $50+\\frac{1.5p-k}{0.5p}*40\\%$.\n\n      - If $1.5p<k<=2p$, you will get an additional $20+\\frac{2p-k}{0.5p}*30\\%$.\n\n      - If $k>2p$, you will not get any additional score.\n\n# Input Format\n\nThe first line contains an integer $n$, indicating how many possible values there are for each position of the password.\n\n# Output Format\n\nThe first line outputs an integer $k$, indicating the number of password attempts in your plan.\n\nThe next $k$ lines output the password for each attempt.\n\n# Hint\n\nThe sample is not an optimal solution; it is only an example of the output.\n\n**You must output a plan, otherwise you may encounter unknown errors.**\n\nThere are three test points:\n\n- Test point $1$ ($10$ pts): $n=2$.\n- Test point $2$ ($20$ pts): $n=100$.\n- Test point $3$ ($70$ pts): $n=1000$.\n\nFor each dataset, we use the following scoring method:\n\n- If $k > 5000000$, your output is too large, and you will not get any score.\n\n- Otherwise:\n\n  - If the plan you provide cannot guarantee lighting up the shrine, or the plan itself is incorrect, then it is scored as follows:\n\n    - If $k$ is less than the minimum number of attempts, you get $0$ points.\n\n    - Otherwise, if $k$ equals the minimum number of attempts, you get $10\\%$ of the score for this test point.\n\n    - Otherwise, if your $k$ is $q$ times the minimum number of attempts, you will get $\\frac{1}{10*q}$ of the score for this test point.\n\n  - Otherwise, if your plan can guarantee lighting up the shrine, it is scored as follows:\n\n    - First, you get a base score of $10\\%$.\n\n    - Then, let the minimum number of attempts be $p$. You will get the following additional score:\n\n      - If $k=p$, you will get an additional $90\\%$.\n\n      - If $p<k<=1.5p$, you will get an additional $50+\\frac{1.5p-k}{0.5p}*40\\%$.\n\n      - If $1.5p<k<=2p$, you will get an additional $20+\\frac{2p-k}{0.5p}*30\\%$.\n\n      - If $k>2p$, you will not get any additional score.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-B] Center of the Earth", "background": "> 我曾如此地接近。\n\n> 我**恨**她。\n\n> \n\n> ...\n\n> 我这次一定要坚持到底。\n\n> 不能再逃跑了。", "description": "Madeline 来到了一座神龛前，这座神龛布满尘埃，四周还都是不明所以的符号。\n\n通过 Madeline 强大的观察能力，她发现这些符号其实对应着一个个冲刺顺序，按照一定顺序冲刺就相当于输入一个密码，只有输入特定的密码才能点亮神龛获得水晶之心。\n\n多年之后，当 Madeline 回忆她的登山之旅时，她已经不记得密码是什么了，只记得密码长度为 $3$，并且每一位密码有 $n$ 种可能。她还知道，在她输入的密码中，任意两位与标准密码相符就能点亮神龛获得水晶之心。\n\n今天，Madeline 又回到了这座神龛前，她希望使用最少的输入密码次数来保证能获得这颗水晶之心，你能帮帮她吗？", "inputFormat": "第一行一个整数 $n$，表示每一位密码有多少种可能。", "outputFormat": "第一行输出一个整数 $k$，表示你给出的方案中输入密码的次数。\n\n接下来 $k$ 行，输出每次尝试的密码。", "hint": "样例不是最优解，只是对输出的一个示例。\n\n**请务必输出方案，否则可能会遇到未知错误**\n\n共有三个测试点：\n\n测试点 $1$($10$pts) : $n=2$\n\n测试点 $2$($20$pts) : $n=100$\n\n测试点 $3$($70$pts) : $n=1000$\n\n对于每组数据我们采取如下评分方式：\n\n- 若 $k > 5000000$ ，你的输出过大，你将无法得到任何分数。\n\n- 否则：\n\n  - 若给出的方案无法保证能点亮神龛，或者方案本身是错误的，则按照如下规则评分：\n\n    - 若 $k$ 小于最小次数，不给分。\n\n    - 否则，若 $k$ 等于最小次数，则给出该测试点 $10\\%$ 的分数。\n\n    - 否则，若你的 $k$ 是最小次数的 $q$ 倍，你将得到这个测试点 $\\frac{1}{10*q}$ 的分数。\n\n  - 否则，你的方案可以保证点亮神龛，则按照如下规则评分：\n\n    - 首先得到 $10\\%$ 的基础分。\n\n    - 接着，令最小次数为 $p$，你将得到如下额外分数：\n\n      - $k=p$，你将得到 $90\\%$ 的额外分数。\n\n      - $p<k<=1.5p$，你将得到 $50+\\frac{1.5p-k}{0.5p}*40\\%$ 的额外分数。\n\n      - $1.5p<k<=2p$，你将得到 $20+\\frac{2p-k}{0.5p}*30\\%$ 的额外分数。\n\n      - $k>2p$，你将不会得到额外分数。\n", "locale": "zh-CN"}}}
{"pid": "P5563", "type": "P", "difficulty": 6, "samples": [["5 16\n1 2 13\n2 3 15\n3 4 7\n3 5 3\n", "15\n15\n15\n10\n15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "[Celeste-B] No More Running", "background": "> 逃离自己内心的人，\n\n> 永远也到达不了顶峰。\n\n> 想要到达山顶，你能做的只有\n\n> 不再逃避", "description": "通往山顶的路上水晶遍布。\n\n在晶簇中，Madeline 发现了一个不同寻常的水晶洞穴，洞穴中镶嵌着五彩斑斓的宝石。\n\n经过 Madeline 的观察，她发现这些宝石形成了一个奇妙的机关，只要让宝石收集到足够的魔力，就能打开机关，拿到水晶之心。\n\n具体来说，在这个巨大的洞穴里有着 $n$ 颗宝石，每颗宝石都被镶嵌在**形态结构完全相同**但**相互独立**的树形结构里。更具体地，在这个洞穴里有 $n$ 个相同的树形结构 $T$，树形结构 $T$ 有 $n$ 个节点，而第 $i$ 颗宝石被镶嵌到了第 $i$ 个树形结构 $T$ 的第 $i$ 号节点上。\n\nMadeline 能够推动宝石从而让宝石在树形结构上滑动。当宝石滑过树形结构的一条边**过后**，这条边就会被关闭，并且边上储存的魔力就会被积蓄到宝石中。(再次提醒，这 $n$ 颗宝石所在的树形结构是相互独立的，这意味着在一个树形结构中一条边的封闭并不会导致在其他树形结构中这条边也被封闭)\n\n宝石能储存的魔力是有上限的，更具体而言，每颗宝石都只能储存 $mod$ 的魔力，一旦超过这个魔力上界，宝石的魔力就会溢出，你可以认为宝石此时储存的魔力会对 $mod$ 取模。\n\nMadeline 想要知道，镶嵌在每个顶点上的宝石最终最多能储存多少魔力，你能帮帮她吗？", "inputFormat": "第一行为两个整数 $n$，$mod$，表示树形结构的节点数和 $mod$\n\n接下来 $n-1$ 行一行三个整数 $u,v,w$，描述树形结构中一条连接 $u,v$，能量值为 $w$ 的双向边 ($0 \\leq w < mod$ )。(注意，封闭一条边是双向的，这意味着你不能走回头路)\n\n保证这些边构成了一棵树。", "outputFormat": "$n$ 行 $n$ 个整数，第 $i$ 个表示镶嵌在第 $i$ 个顶点的宝石最多能储存的魔力。", "hint": "![图挂了](https://i.loli.net/2019/08/30/sPwyQKUDANRCT2f.png)\n\n\"特殊约定\" 中，\"一条链\"意味着树形结构的第 $i$ 条边连接第 $i$ 个和第 $i+1$ 个节点。\n\n对于所有数据有 $0\\leq w<mod$ \n\n保证输入的所有边构成一棵树\n\n对于 $1$~$6$ 号测试点，时限为 $1s$\n\n对于 $7$~$12$ 号测试点，时限为 $2s$\n\n对于 $13$~$20$ 号测试点，时限为 $3s$", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-B] No More Running", "background": "> Those who run away from their own heart,\n\n> will never reach the summit.\n\n> If you want to reach the top, the only thing you can do is\n\n> stop running away.", "description": "Crystals are scattered all along the road to the summit.\n\nIn a cluster of crystals, Madeline finds an unusual crystal cave, with colorful gems embedded inside.\n\nAfter observing, Madeline realizes that these gems form a wonderful mechanism: as long as the gems collect enough magic power, the mechanism can be activated and the Crystal Heart can be obtained.\n\nMore specifically, in this huge cave there are $n$ gems. Each gem is embedded in a tree structure that is **exactly the same in shape** but **independent from the others**. To be even more specific, there are $n$ identical tree structures $T$ in the cave. The tree structure $T$ has $n$ nodes, and the $i$-th gem is embedded at node $i$ of the $i$-th tree structure $T$.\n\nMadeline can push a gem so that it slides along the tree. After the gem passes through an edge, that edge will be closed, and the magic power stored on that edge will be accumulated into the gem. (Reminder: the tree structures containing these $n$ gems are independent. This means that closing an edge in one tree will not cause the same edge to be closed in other trees.)\n\nA gem has a limit on how much magic power it can store. More specifically, each gem can store only $mod$ magic power. Once it exceeds this upper bound, the magic power overflows. You can treat this as taking the stored magic power modulo $mod$.\n\nMadeline wants to know the maximum magic power that the gem embedded at each vertex can store in the end. Can you help her?", "inputFormat": "The first line contains two integers $n$, $mod$, representing the number of nodes in the tree structure and $mod$.\n\nThe next $n-1$ lines each contain three integers $u, v, w$, describing an undirected edge in the tree structure that connects $u$ and $v$ with energy value $w$ ($0 \\leq w < mod$). (Note that closing an edge works in both directions, which means you cannot go back along that edge.)\n\nIt is guaranteed that these edges form a tree.", "outputFormat": "Output $n$ lines, each line containing $n$ integers. The $i$-th integer represents the maximum magic power that the gem embedded at vertex $i$ can store.", "hint": "![Image failed to load](https://i.loli.net/2019/08/30/sPwyQKUDANRCT2f.png)\n\nIn the \"Special Convention\", \"a chain\" means that the $i$-th edge of the tree structure connects node $i$ and node $i+1$.\n\nFor all testdata, $0 \\leq w < mod$.\n\nIt is guaranteed that all input edges form a tree.\n\nFor test points $1$ to $6$, the time limit is $1s$.\n\nFor test points $7$ to $12$, the time limit is $2s$.\n\nFor test points $13$ to $20$, the time limit is $3s$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-B] No More Running", "background": "> 逃离自己内心的人，\n\n> 永远也到达不了顶峰。\n\n> 想要到达山顶，你能做的只有\n\n> 不再逃避", "description": "通往山顶的路上水晶遍布。\n\n在晶簇中，Madeline 发现了一个不同寻常的水晶洞穴，洞穴中镶嵌着五彩斑斓的宝石。\n\n经过 Madeline 的观察，她发现这些宝石形成了一个奇妙的机关，只要让宝石收集到足够的魔力，就能打开机关，拿到水晶之心。\n\n具体来说，在这个巨大的洞穴里有着 $n$ 颗宝石，每颗宝石都被镶嵌在**形态结构完全相同**但**相互独立**的树形结构里。更具体地，在这个洞穴里有 $n$ 个相同的树形结构 $T$，树形结构 $T$ 有 $n$ 个节点，而第 $i$ 颗宝石被镶嵌到了第 $i$ 个树形结构 $T$ 的第 $i$ 号节点上。\n\nMadeline 能够推动宝石从而让宝石在树形结构上滑动。当宝石滑过树形结构的一条边**过后**，这条边就会被关闭，并且边上储存的魔力就会被积蓄到宝石中。(再次提醒，这 $n$ 颗宝石所在的树形结构是相互独立的，这意味着在一个树形结构中一条边的封闭并不会导致在其他树形结构中这条边也被封闭)\n\n宝石能储存的魔力是有上限的，更具体而言，每颗宝石都只能储存 $mod$ 的魔力，一旦超过这个魔力上界，宝石的魔力就会溢出，你可以认为宝石此时储存的魔力会对 $mod$ 取模。\n\nMadeline 想要知道，镶嵌在每个顶点上的宝石最终最多能储存多少魔力，你能帮帮她吗？", "inputFormat": "第一行为两个整数 $n$，$mod$，表示树形结构的节点数和 $mod$\n\n接下来 $n-1$ 行一行三个整数 $u,v,w$，描述树形结构中一条连接 $u,v$，能量值为 $w$ 的双向边 ($0 \\leq w < mod$ )。(注意，封闭一条边是双向的，这意味着你不能走回头路)\n\n保证这些边构成了一棵树。", "outputFormat": "$n$ 行 $n$ 个整数，第 $i$ 个表示镶嵌在第 $i$ 个顶点的宝石最多能储存的魔力。", "hint": "![图挂了](https://i.loli.net/2019/08/30/sPwyQKUDANRCT2f.png)\n\n\"特殊约定\" 中，\"一条链\"意味着树形结构的第 $i$ 条边连接第 $i$ 个和第 $i+1$ 个节点。\n\n对于所有数据有 $0\\leq w<mod$ \n\n保证输入的所有边构成一棵树\n\n对于 $1$~$6$ 号测试点，时限为 $1s$\n\n对于 $7$~$12$ 号测试点，时限为 $2s$\n\n对于 $13$~$20$ 号测试点，时限为 $3s$", "locale": "zh-CN"}}}
{"pid": "P5564", "type": "P", "difficulty": 7, "samples": [["3 3\n1 1 1", "8"], ["4 2\n1 3", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "[Celeste-B] Say Goodbye", "background": "> 你们居然挺过来了，真是令人难以置信，不是吗？\n\n> 努力的过程还是挺有意思的。\n\n> 这个嘛，\n\n> 你又在等什么？", "description": "Madeline 将收集到的草莓分给了朋友们\n\n火红色的草莓和金黄色的草莓交错在一起，很受朋友们喜爱\n\n朋友们为了感谢 Madeline ，一起收集了许多五颜六色的珠子，打算串成一条花花绿绿的项链送给 Madeline\n\n经过朋友们的精心准备，现在桌子上摆着$n$个珠子，这些珠子一共有$k$种颜色。具体来说，第$i$种颜色的珠子有$a_i$个\n\n看着桌子上晶莹剔透的珠子，现在朋友们却犯难了，因为他们不知道怎样将它们串在一起才最美丽\n\n朋友们向你发出了请求，需要你帮忙求出本质不同的方案总数\n\n朋友们分不清这些珠子的顺序，因此**两个珠子不同仅当它们的颜色不同**\n\n这条项链必须是完整的，因此**所有珠子构成了一个连通块**\n\n这条项链还不能太杂乱，因此所有珠子必须构成一棵**基环树**\n\n在多次询问 Madeline 的朋友们之后，你发现这棵基环树的两个子树不同仅当**它们对应点的颜色不同或者这两棵子树不同构**。对于不同的子树是有先后顺序之分的\n\n举例来说，下面的几种**部分**串法是互不相同的\n\n![1566976736844.png](https://cdn.luogu.com.cn/upload/image_hosting/diwl819r.png)\n\n朋友们的时间很紧迫，因此如果两种项链能够通过**旋转基环**得到同样的结果，那么这两种项链本质上是相同的\n\n", "inputFormat": "第一行两个整数 $ n, k $，分别表示珠子的总数以及颜色种数\n\n接下来一行 $k$ 个整数 $a_i$，表示每种颜色的珠子个数\n\n ", "outputFormat": "输出一个整数，表示方案数模 $998244353$ 的余数", "hint": "基环树：一个有$n$个点$n$条边的联通图，**没有自环**。容易看出这样的图是一个环上连出了一些树\n\n基环：基环树中的环\n\n对于 $ 5\\% $ 的数据，$ n \\leq 8 $\n\n对于另 $ 10\\% $ 的数据，$ k = 1 , n \\leq 10^3 $\n\n对于前 $ 30\\% $ 的数据，$ n \\leq 10^3 $\n\n对于另 $ 20\\% $ 的数据，$ k = 1 , n \\leq 5 \\times 10^4 $\n\n对于前 $ 80\\% $ 的数据，$ n \\leq 5 \\times 10^4 $\n\n对于 $ 100\\% $ 的数据，$ a_i > 0 , \\sum a_i = n , n \\leq 2 \\times 10^5 , k \\leq n $\n\n\n第二个样例解释：\n\n有如下$15$种情况：\n\n![1567002672190.png](https://cdn.luogu.com.cn/upload/image_hosting/80ph1r8a.png)\n\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-B] Say Goodbye", "background": "> You actually made it through. It is hard to believe, is it not?\n\n> The process of working hard was pretty interesting.\n\n> Well then,\n\n> What are you waiting for?", "description": "Madeline shared the strawberries she collected with her friends.\n\nThe bright red strawberries and the golden yellow strawberries were mixed together, and her friends liked them very much.\n\nTo thank Madeline, her friends collected many colorful beads and planned to string them into a colorful necklace as a gift for Madeline.\n\nAfter careful preparation, there are now $n$ beads on the table. These beads have $k$ colors in total. Specifically, there are $a_i$ beads of the $i$-th color.\n\nLooking at the crystal-clear beads on the table, the friends are now troubled, because they do not know how to string them together to make it the most beautiful.\n\nThey ask you for help: compute the total number of essentially different plans.\n\nThey cannot tell the order of beads apart, so **two beads are different only if their colors are different**.\n\nThis necklace must be complete, so **all beads form one connected component**.\n\nThe necklace also cannot be too messy, so all beads must form a **unicyclic graph (基环树)**.\n\nAfter asking Madeline’s friends many times, you find that two subtrees of this unicyclic graph are different if and only if **the colors of their corresponding nodes are different, or the two subtrees have different structures**. Different subtrees are considered ordered.\n\nFor example, the following **partial** stringing methods are all different from each other.\n\n![1566976736844.png](https://cdn.luogu.com.cn/upload/image_hosting/diwl819r.png)\n\nThe friends are in a hurry, so if two necklaces can become the same by **rotating the cycle (基环)**, then these two necklaces are essentially the same.", "inputFormat": "The first line contains two integers $n, k$, representing the total number of beads and the number of colors.\n\nThe next line contains $k$ integers $a_i$, representing the number of beads of each color.", "outputFormat": "Output one integer, the number of plans modulo $998244353$.", "hint": "Unicyclic graph (基环树): a connected graph with $n$ vertices and $n$ edges, **with no self-loops**. It is easy to see that such a graph consists of a cycle with some trees attached to it.\n\nCycle (基环): the cycle in a unicyclic graph.\n\nFor $5\\%$ of the testdata, $n \\leq 8$.\n\nFor another $10\\%$ of the testdata, $k = 1$ and $n \\leq 10^3$.\n\nFor the first $30\\%$ of the testdata, $n \\leq 10^3$.\n\nFor another $20\\%$ of the testdata, $k = 1$ and $n \\leq 5 \\times 10^4$.\n\nFor the first $80\\%$ of the testdata, $n \\leq 5 \\times 10^4$.\n\nFor $100\\%$ of the testdata, $a_i > 0$, $\\sum a_i = n$, $n \\leq 2 \\times 10^5$, and $k \\leq n$.\n\nExplanation for the second sample:\n\nThere are $15$ cases as follows:\n\n![1567002672190.png](https://cdn.luogu.com.cn/upload/image_hosting/80ph1r8a.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-B] Say Goodbye", "background": "> 你们居然挺过来了，真是令人难以置信，不是吗？\n\n> 努力的过程还是挺有意思的。\n\n> 这个嘛，\n\n> 你又在等什么？", "description": "Madeline 将收集到的草莓分给了朋友们\n\n火红色的草莓和金黄色的草莓交错在一起，很受朋友们喜爱\n\n朋友们为了感谢 Madeline ，一起收集了许多五颜六色的珠子，打算串成一条花花绿绿的项链送给 Madeline\n\n经过朋友们的精心准备，现在桌子上摆着$n$个珠子，这些珠子一共有$k$种颜色。具体来说，第$i$种颜色的珠子有$a_i$个\n\n看着桌子上晶莹剔透的珠子，现在朋友们却犯难了，因为他们不知道怎样将它们串在一起才最美丽\n\n朋友们向你发出了请求，需要你帮忙求出本质不同的方案总数\n\n朋友们分不清这些珠子的顺序，因此**两个珠子不同仅当它们的颜色不同**\n\n这条项链必须是完整的，因此**所有珠子构成了一个连通块**\n\n这条项链还不能太杂乱，因此所有珠子必须构成一棵**基环树**\n\n在多次询问 Madeline 的朋友们之后，你发现这棵基环树的两个子树不同仅当**它们对应点的颜色不同或者这两棵子树不同构**。对于不同的子树是有先后顺序之分的\n\n举例来说，下面的几种**部分**串法是互不相同的\n\n![1566976736844.png](https://cdn.luogu.com.cn/upload/image_hosting/diwl819r.png)\n\n朋友们的时间很紧迫，因此如果两种项链能够通过**旋转基环**得到同样的结果，那么这两种项链本质上是相同的\n\n", "inputFormat": "第一行两个整数 $ n, k $，分别表示珠子的总数以及颜色种数\n\n接下来一行 $k$ 个整数 $a_i$，表示每种颜色的珠子个数\n\n ", "outputFormat": "输出一个整数，表示方案数模 $998244353$ 的余数", "hint": "基环树：一个有$n$个点$n$条边的联通图，**没有自环**。容易看出这样的图是一个环上连出了一些树\n\n基环：基环树中的环\n\n对于 $ 5\\% $ 的数据，$ n \\leq 8 $\n\n对于另 $ 10\\% $ 的数据，$ k = 1 , n \\leq 10^3 $\n\n对于前 $ 30\\% $ 的数据，$ n \\leq 10^3 $\n\n对于另 $ 20\\% $ 的数据，$ k = 1 , n \\leq 5 \\times 10^4 $\n\n对于前 $ 80\\% $ 的数据，$ n \\leq 5 \\times 10^4 $\n\n对于 $ 100\\% $ 的数据，$ a_i > 0 , \\sum a_i = n , n \\leq 2 \\times 10^5 , k \\leq n $\n\n\n第二个样例解释：\n\n有如下$15$种情况：\n\n![1567002672190.png](https://cdn.luogu.com.cn/upload/image_hosting/80ph1r8a.png)\n\n\n", "locale": "zh-CN"}}}
{"pid": "P5565", "type": "P", "difficulty": 7, "samples": [["5\n(1&b)\n3 |\n2 a\n3 &\n3 ^\n4 1", "6\n8\n4\n6\n4"], ["10\n1|a&1&(0&0|1)&1^1^a\n1 0\n10 1\n2 &\n1 a\n14 ^\n4 |\n17 0\n4 ^\n15 a\n15 1\n", "29\n30\n27\n35\n35\n43\n35\n35\n56\n35"], ["30\n0|0&0^(a&a&(1^0&0^0)^0&1)|0&a|1|(a&a|0|1|0^a&0&a|(a^0&1|a|a)^a|a&0&0)^a\n71 1\n51 0\n57 0\n65 &\n26 |\n5 a\n71 a\n56 |\n4 &\n41 ^\n52 |\n52 ^\n59 a\n44 0\n54 ^\n65 &\n51 a\n36 1\n16 ^\n1 1\n52 ^\n2 |\n59 0\n58 |\n37 ^\n55 1\n10 1\n26 ^\n18 |\n44 0\n", "21323\n10686\n5360\n5360\n5360\n8469\n16277\n16277\n16277\n16277\n16277\n16277\n16277\n8223\n8253\n8253\n16354\n8359\n8385\n8394\n8394\n8394\n4262\n4262\n4262\n4262\n2430\n2430\n2430\n2430"], ["20\na^1&0^1^1&1&a&1^a|1&a|0&a^a^1^a^0&1^a&a|a|1^0|a|0^1^a|0^0&1&1&a&a|0^0&a&1&a|a&a^a|0^a^a|a^1|a|1^a|0|a^0&0&0|a|a|a^0^1&0^1&a|1&0\n8 ^\n28 |\n100 ^\n119 a\n40 &\n105 1\n31 1\n125 1\n53 1\n98 &\n98 &\n98 &\n52 &\n2 ^\n38 |\n6 ^\n58 ^\n106 |\n12 ^\n57 1", "957521426\n957521583\n874091659\n57281108\n57278566\n140708493\n120472431\n120472431\n561701787\n551192201\n551192201\n551192201\n551120577\n551120577\n551121853\n551121853\n551178140\n656274015\n656274025\n656222855"]], "limits": {"time": [1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "矩阵加速", "树链剖分"], "title": "[Celeste-B] Farewell to Mount Celeste", "background": "> Sever the Skyline\n\n> Black Moonrise\n\n> Good Karma\n\n> Golden Feather\n\n> Mirror Magic\n\n> Center of the Earth\n\n> No More Running\n\n> And...\n\n> Say Goodbye.", "description": "在分别的宴会上，朋友们拿出他们把多彩的珠子串成的彩色的项链。\n\n项链在夕阳的余晖里闪闪发光，仔细一看，项链周围竟然已经聚集了许多鸟儿，鸟儿们带着 Madeline 与她的朋友们来到了一处他们不曾来过的地方，这里汇聚着好大一群鸟，似乎想要向他们表达些什么。\n\n经过 Madeline 仔细地观察，它发现一些鸟儿们飞动的方式好像排成了一个有序的式子，而另一些鸟儿飞动的方式则是一些符号，符号表达着一个问题。\n\n鸟儿们表达的问题是这样的：\n\n鸟儿们组成的式子会由 `(`,`)`,`^`,`&`,`|`,`0`,`1` 和小写字母构成，并且是一个表达式。\n\n其中：\n\n- `(`,`)` 表示括号，在括号中的运算优先级提高。\n\n- `&`,`|`,`^` 表示 `与`,`或`,`异或` 三种位运算，这三种运算**优先级相同**\n\n- `0`,`1` 即为 `0`,`1`\n\n- 小写字母表示变量，多次出现的同一小写字母表示**不同**的变量，一个变量取值 `0` 或 `1`\n\n- 表达式的定义如下：\n\n    - 一个变量,`0`,`1` 均为表达式\n    - 若 $T$ 是表达式，则 $(T)$ 是表达式\n    - 若 $S$,$T$ 是表达式，则$S\\&T$,$S|T$,$S\\ \\hat{}\\ T$均为表达式\n    - 例如，$(1\\ \\hat{}\\ 1\\&0)$ 是一个表达式，并且运算结果为 $0$，但 $(1\\&0$ 不是一个表达式\n\n鸟儿们认为，要能算出 $1$ 的表达式才是优美的，定义一个表达式的优美度为在这个表达式所有 $v$ 个变量的 $2^v$ 种取值中能算出 $1$ 的方案数。\n\n鸟儿们还认为，一个表达式的和谐度是这个表达式的所有**子连续表达式**的优美度的和。(包含自身)\n\n鸟儿们还是善变的，它们会时不时改变一个位置的字符，但是它们向 Madeline 和她的朋友们保证它们不会改变括号，并且进行修改之后整个串仍然是一个表达式。\n\n你能帮助 Madeline 和她的朋友们算出每次修改后整个表达式的和谐度吗？\n\n鸟儿们还说，因为表达式可能太和谐了，因此 Madeline 可以只回答和谐度对 $998244353$ 取模后的值。", "inputFormat": "第一行为一个数 $m$ ,表示修改数\n\n第二行为一个字符串，表示初始表达式\n\n之后 $m$ 行，每一行一个数 $a$ 和一个字符 $b$ ，表示鸟儿们将 $a$ 位置字符变成 $b$ \n\n在输入的表达式中，一个小写字母代表一个变量。(注意一个字母可能出现多次，但代表**不同**变量)", "outputFormat": "$m$ 行，第 $i$ 行为第 $i$ 次修改后的权值。由于和谐度可能很大，你需要对 $998244353$ 取模。", "hint": "设 $n$ 为表达式中变量和 $0,1$ 的个数，$len$ 为表达式长度\n\n有subtask\n\n对于 $ 5\\% $ 的数据, $ n \\leq 12 , len \\leq 50 , m \\leq 50 $,1s\n\n对于额外 $ 10\\% $ 的数据, $ n \\leq 150,len \\leq 400,m \\leq 200$\n\n对于额外 $ 10\\% $ 的数据, $ n \\leq 10^5,len \\leq 2\\times 10^5,m \\leq 10$ ,没有括号\n\n对于额外 $ 10\\% $ 的数据, $ n \\leq 10^5,len \\leq 2\\times 10^5,m \\leq 10^5 $ ,没有括号\n\n对于前 $ 50\\% $ 的数据, $ n \\leq 10^5,len \\leq 4\\times 10^5,m \\leq 10^5 $ ,保证括号随机生成\n\n对于 $ 100\\% $ 的数据, $ n \\leq 10^5,len \\leq 4\\times 10^5,m \\leq 10^5 ,len-2\\times n \\leq 2 \\times 10^5$ \n\n对于后 $ 95\\% $ 的数据，时限为3s", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-B] Farewell to Mount Celeste", "background": "> Sever the Skyline\n>\n> Black Moonrise\n>\n> Good Karma\n>\n> Golden Feather\n>\n> Mirror Magic\n>\n> Center of the Earth\n>\n> No More Running\n>\n> And...\n>\n> Say Goodbye.", "description": "At the farewell banquet, the friends took out colorful necklaces made by stringing together multicolored beads.\n\nThe necklaces glittered in the afterglow of the sunset. Looking closely, they found that many birds had already gathered around the necklaces. The birds brought Madeline and her friends to a place they had never been to before. A huge flock of birds gathered here, seemingly trying to express something to them.\n\nAfter Madeline observed carefully, she found that the way some birds flew seemed to form an ordered formula, while the way other birds flew formed some symbols. These symbols described a question.\n\nThe question described by the birds is as follows:\n\nThe formula formed by the birds consists of `(`, `)`, `^`, `&`, `|`, `0`, `1`, and lowercase letters, and it is an expression.\n\nSpecifically:\n\n- `(` and `)` are parentheses. Operations inside parentheses have higher precedence.\n\n- `&`, `|`, and `^` represent the three bitwise operations AND, OR, and XOR. These three operations have **the same precedence**.\n\n- `0` and `1` are the constants `0` and `1`.\n\n- Lowercase letters represent variables. Multiple occurrences of the same lowercase letter represent **different** variables. Each variable takes a value of `0` or `1`.\n\n- The expression is defined as follows:\n\n    - A variable, `0`, and `1` are all expressions.\n    - If $T$ is an expression, then $(T)$ is an expression.\n    - If $S$ and $T$ are expressions, then $S\\&T$, $S|T$, and $S\\ \\hat{}\\ T$ are expressions.\n    - For example, $(1\\ \\hat{}\\ 1\\&0)$ is an expression, and its result is $0$, but $(1\\&0$ is not an expression.\n\nThe birds believe that an expression that can evaluate to $1$ is beautiful. Define the beauty of an expression as the number of assignments (among all $2^v$ assignments to its $v$ variables) that make the expression evaluate to $1$.\n\nThe birds also believe that the harmony of an expression is the sum of the beauties of all its **contiguous subexpressions** (including itself).\n\nThe birds are fickle. From time to time, they will change the character at one position, but they promise Madeline and her friends that they will not change the parentheses, and after each modification the whole string is still an expression.\n\nCan you help Madeline and her friends compute the harmony of the entire expression after each modification?\n\nThe birds also said that the expression may be too harmonious, so Madeline only needs to output the harmony modulo $998244353$.", "inputFormat": "The first line contains an integer $m$, representing the number of modifications.\n\nThe second line contains a string representing the initial expression.\n\nThe next $m$ lines each contain an integer $a$ and a character $b$, meaning the birds change the character at position $a$ to $b$.\n\nIn the input expression, each lowercase letter represents one variable. (Note that a letter may appear multiple times, but they represent **different** variables.)", "outputFormat": "Output $m$ lines. The $i$-th line contains the value after the $i$-th modification. Since the harmony may be very large, you need to output it modulo $998244353$.", "hint": "Let $n$ be the number of variables and `0,1` in the expression, and let $len$ be the expression length.\n\nThere are subtasks.\n\nFor $5\\%$ of the testdata: $n \\leq 12$, $len \\leq 50$, $m \\leq 50$, time limit $1\\text{s}$.\n\nFor an additional $10\\%$ of the testdata: $n \\leq 150$, $len \\leq 400$, $m \\leq 200$.\n\nFor an additional $10\\%$ of the testdata: $n \\leq 10^5$, $len \\leq 2\\times 10^5$, $m \\leq 10$, with no parentheses.\n\nFor an additional $10\\%$ of the testdata: $n \\leq 10^5$, $len \\leq 2\\times 10^5$, $m \\leq 10^5$, with no parentheses.\n\nFor the first $50\\%$ of the testdata: $n \\leq 10^5$, $len \\leq 4\\times 10^5$, $m \\leq 10^5$, and the parentheses are guaranteed to be generated randomly.\n\nFor $100\\%$ of the testdata: $n \\leq 10^5$, $len \\leq 4\\times 10^5$, $m \\leq 10^5$, $len-2\\times n \\leq 2 \\times 10^5$.\n\nFor the last $95\\%$ of the testdata, the time limit is $3\\text{s}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-B] Farewell to Mount Celeste", "background": "> Sever the Skyline\n\n> Black Moonrise\n\n> Good Karma\n\n> Golden Feather\n\n> Mirror Magic\n\n> Center of the Earth\n\n> No More Running\n\n> And...\n\n> Say Goodbye.", "description": "在分别的宴会上，朋友们拿出他们把多彩的珠子串成的彩色的项链。\n\n项链在夕阳的余晖里闪闪发光，仔细一看，项链周围竟然已经聚集了许多鸟儿，鸟儿们带着 Madeline 与她的朋友们来到了一处他们不曾来过的地方，这里汇聚着好大一群鸟，似乎想要向他们表达些什么。\n\n经过 Madeline 仔细地观察，它发现一些鸟儿们飞动的方式好像排成了一个有序的式子，而另一些鸟儿飞动的方式则是一些符号，符号表达着一个问题。\n\n鸟儿们表达的问题是这样的：\n\n鸟儿们组成的式子会由 `(`,`)`,`^`,`&`,`|`,`0`,`1` 和小写字母构成，并且是一个表达式。\n\n其中：\n\n- `(`,`)` 表示括号，在括号中的运算优先级提高。\n\n- `&`,`|`,`^` 表示 `与`,`或`,`异或` 三种位运算，这三种运算**优先级相同**\n\n- `0`,`1` 即为 `0`,`1`\n\n- 小写字母表示变量，多次出现的同一小写字母表示**不同**的变量，一个变量取值 `0` 或 `1`\n\n- 表达式的定义如下：\n\n    - 一个变量,`0`,`1` 均为表达式\n    - 若 $T$ 是表达式，则 $(T)$ 是表达式\n    - 若 $S$,$T$ 是表达式，则$S\\&T$,$S|T$,$S\\ \\hat{}\\ T$均为表达式\n    - 例如，$(1\\ \\hat{}\\ 1\\&0)$ 是一个表达式，并且运算结果为 $0$，但 $(1\\&0$ 不是一个表达式\n\n鸟儿们认为，要能算出 $1$ 的表达式才是优美的，定义一个表达式的优美度为在这个表达式所有 $v$ 个变量的 $2^v$ 种取值中能算出 $1$ 的方案数。\n\n鸟儿们还认为，一个表达式的和谐度是这个表达式的所有**子连续表达式**的优美度的和。(包含自身)\n\n鸟儿们还是善变的，它们会时不时改变一个位置的字符，但是它们向 Madeline 和她的朋友们保证它们不会改变括号，并且进行修改之后整个串仍然是一个表达式。\n\n你能帮助 Madeline 和她的朋友们算出每次修改后整个表达式的和谐度吗？\n\n鸟儿们还说，因为表达式可能太和谐了，因此 Madeline 可以只回答和谐度对 $998244353$ 取模后的值。", "inputFormat": "第一行为一个数 $m$ ,表示修改数\n\n第二行为一个字符串，表示初始表达式\n\n之后 $m$ 行，每一行一个数 $a$ 和一个字符 $b$ ，表示鸟儿们将 $a$ 位置字符变成 $b$ \n\n在输入的表达式中，一个小写字母代表一个变量。(注意一个字母可能出现多次，但代表**不同**变量)", "outputFormat": "$m$ 行，第 $i$ 行为第 $i$ 次修改后的权值。由于和谐度可能很大，你需要对 $998244353$ 取模。", "hint": "设 $n$ 为表达式中变量和 $0,1$ 的个数，$len$ 为表达式长度\n\n有subtask\n\n对于 $ 5\\% $ 的数据, $ n \\leq 12 , len \\leq 50 , m \\leq 50 $,1s\n\n对于额外 $ 10\\% $ 的数据, $ n \\leq 150,len \\leq 400,m \\leq 200$\n\n对于额外 $ 10\\% $ 的数据, $ n \\leq 10^5,len \\leq 2\\times 10^5,m \\leq 10$ ,没有括号\n\n对于额外 $ 10\\% $ 的数据, $ n \\leq 10^5,len \\leq 2\\times 10^5,m \\leq 10^5 $ ,没有括号\n\n对于前 $ 50\\% $ 的数据, $ n \\leq 10^5,len \\leq 4\\times 10^5,m \\leq 10^5 $ ,保证括号随机生成\n\n对于 $ 100\\% $ 的数据, $ n \\leq 10^5,len \\leq 4\\times 10^5,m \\leq 10^5 ,len-2\\times n \\leq 2 \\times 10^5$ \n\n对于后 $ 95\\% $ 的数据，时限为3s", "locale": "zh-CN"}}}
{"pid": "P5566", "type": "P", "difficulty": 5, "samples": [["8", "1\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "各省省选", "山东"], "title": "[SDOI2008] 红黑树", "background": "", "description": "红黑树是一类特殊的二叉搜索树，其中每个结点被染成红色或黑色。若将二叉搜索树结点中的空指针看作是指向一个空结点，则称这类空结点为二叉搜索树的前端结点。并规定所有前端结点的高度为 $-1$。\n\n一棵红黑树是满足下面“红黑性质”的染色二叉搜索树：\n\n1. 每个结点被染成红色或黑色；\n2. 每个前端结点为黑色结点；\n3. 任一红结点的子结点均为黑结点；\n4. 在从任一结点到其子孙前端结点的所有路径上具有相同的黑结点数。\n\n从红黑树中任一结点 $x$ 出发（不包括结点 $x$），到达一个前端结点的任意一条路径上的黑结点个数称为结点 $x$ 的黑高度，记作 $bh(x)$ 。红黑树的黑高度定义为其根结点的黑高度。\n\n给定正整数 $N$，试设计一个算法，计算出在所有含有 $N$ 个结点的红黑树中，红色内结点个数的最小值和最大值。", "inputFormat": "输入一个数字 $N$。", "outputFormat": "输出第一行为红色内节点的个数最小值；第二行为红色内节点的个数最大值。", "hint": "$N \\leq 5000$", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2008] Red-Black Tree", "background": "", "description": "A red-black tree is a special kind of binary search tree, where each node is colored either red or black. If we treat the null pointers in a binary search tree as pointing to null nodes, then these null nodes are called the sentinel (leaf) nodes of the binary search tree. It is also specified that the height of all sentinel nodes is $-1$.\n\nA red-black tree is a colored binary search tree that satisfies the following “red-black properties”:\n\n1. Each node is colored either red or black.\n2. Each sentinel node is black.\n3. The children of any red node are all black nodes.\n4. On all paths from any node to any sentinel node among its descendants, the number of black nodes is the same.\n\nStarting from any node $x$ in a red-black tree (excluding node $x$ itself), the number of black nodes on any path to a sentinel node is called the black height of node $x$, denoted as $bh(x)$. The black height of a red-black tree is defined as the black height of its root.\n\nGiven a positive integer $N$, design an algorithm to compute, among all red-black trees with $N$ nodes, the minimum and maximum possible numbers of red internal nodes.", "inputFormat": "Input a number $N$.", "outputFormat": "Output two lines.  \nThe first line is the minimum number of red internal nodes.  \nThe second line is the maximum number of red internal nodes.", "hint": "Constraints: $N \\leq 5000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2008] 红黑树", "background": "", "description": "红黑树是一类特殊的二叉搜索树，其中每个结点被染成红色或黑色。若将二叉搜索树结点中的空指针看作是指向一个空结点，则称这类空结点为二叉搜索树的前端结点。并规定所有前端结点的高度为 $-1$。\n\n一棵红黑树是满足下面“红黑性质”的染色二叉搜索树：\n\n1. 每个结点被染成红色或黑色；\n2. 每个前端结点为黑色结点；\n3. 任一红结点的子结点均为黑结点；\n4. 在从任一结点到其子孙前端结点的所有路径上具有相同的黑结点数。\n\n从红黑树中任一结点 $x$ 出发（不包括结点 $x$），到达一个前端结点的任意一条路径上的黑结点个数称为结点 $x$ 的黑高度，记作 $bh(x)$ 。红黑树的黑高度定义为其根结点的黑高度。\n\n给定正整数 $N$，试设计一个算法，计算出在所有含有 $N$ 个结点的红黑树中，红色内结点个数的最小值和最大值。", "inputFormat": "输入一个数字 $N$。", "outputFormat": "输出第一行为红色内节点的个数最小值；第二行为红色内节点的个数最大值。", "hint": "$N \\leq 5000$", "locale": "zh-CN"}}}
{"pid": "P5567", "type": "P", "difficulty": 5, "samples": [["3\n0 0 0 3\n1 -1 0 1\n19 3 5 6", "1944"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "线段树", "各省省选", "山东"], "title": "[SDOI2008] 立方体覆盖", "background": "", "description": "A 君近日为准备省队选拔，特意进行了数据结构的专项训练。训练过程中就遇到了“矩形面积并”这道经典问题，即：给出 $N$ 个各边与坐标轴平行（垂直）的矩形，求矩形覆盖的面积之和。A 君按纵坐标建立线段树后按横坐标扫描计算，轻易 AC 了这道题，时间复杂度为 $O(N\\log N)$。\n\n为了强化训练，A 君将问题推广到三维空间中，即：给出 $N$ 个各棱与坐标轴平行（垂直）的立方体，求立方体覆盖的体积之和。为了简化问题，令立方体均退化为正立方体，用四元组 $(x, y, z, r)$ 表示一个立方体，其中 $x, y, z$ 为立方体的中心点坐标，$r$ 为中心点到立方体各个面的距离（即立方体高的一半）。\n\n这次可难住了 A 君，只好请你——未来的金牌——来帮助他了。", "inputFormat": "第一行是一个正整数 $N$。\n\n以下 $N$ 行每行四个整数 $x, y, z, r$。", "outputFormat": "输出覆盖的总体积。", "hint": "$ N \\leq 100, -1000 \\leq x,y,z \\leq 1000, r \\leq 200$", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2008] Cube Coverage", "background": "", "description": "Recently, Mr. A has been doing special training on data structures to prepare for the NOI Qualifier team selection. During the training, he encountered the classic problem “Union Area of Rectangles”: given $N$ rectangles whose sides are parallel (perpendicular) to the coordinate axes, find the total area covered by these rectangles. Mr. A built a segment tree along the $y$-axis and then used a sweep line along the $x$-axis to compute it, easily getting AC, with time complexity $O(N\\log N)$.\n\nTo further strengthen the training, Mr. A extended the problem to three-dimensional space: given $N$ cubes whose edges are parallel (perpendicular) to the coordinate axes, find the total volume covered by these cubes. To simplify the problem, assume all cubes are axis-aligned regular cubes. Use a quadruple $(x, y, z, r)$ to represent a cube, where $x, y, z$ are the coordinates of the cube’s center, and $r$ is the distance from the center to each face of the cube (i.e. half of the cube’s side length).\n\nThis time Mr. A got stuck, so he asks you—the future gold medalist—to help him.", "inputFormat": "The first line contains a positive integer $N$.\n\nThe next $N$ lines each contain four integers $x, y, z, r$.", "outputFormat": "Output the total covered volume.", "hint": "Constraints: $N \\leq 100, -1000 \\leq x,y,z \\leq 1000, r \\leq 200$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2008] 立方体覆盖", "background": "", "description": "A 君近日为准备省队选拔，特意进行了数据结构的专项训练。训练过程中就遇到了“矩形面积并”这道经典问题，即：给出 $N$ 个各边与坐标轴平行（垂直）的矩形，求矩形覆盖的面积之和。A 君按纵坐标建立线段树后按横坐标扫描计算，轻易 AC 了这道题，时间复杂度为 $O(N\\log N)$。\n\n为了强化训练，A 君将问题推广到三维空间中，即：给出 $N$ 个各棱与坐标轴平行（垂直）的立方体，求立方体覆盖的体积之和。为了简化问题，令立方体均退化为正立方体，用四元组 $(x, y, z, r)$ 表示一个立方体，其中 $x, y, z$ 为立方体的中心点坐标，$r$ 为中心点到立方体各个面的距离（即立方体高的一半）。\n\n这次可难住了 A 君，只好请你——未来的金牌——来帮助他了。", "inputFormat": "第一行是一个正整数 $N$。\n\n以下 $N$ 行每行四个整数 $x, y, z, r$。", "outputFormat": "输出覆盖的总体积。", "hint": "$ N \\leq 100, -1000 \\leq x,y,z \\leq 1000, r \\leq 200$", "locale": "zh-CN"}}}
{"pid": "P5568", "type": "P", "difficulty": 5, "samples": [["U [1,5]\nD [3,3]\nS [2,4]\nC (1,5)\nI (2,3]", "(2,3)"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "线段树", "各省省选", "颜色段均摊（珂朵莉树 ODT）", "山东"], "title": "[SDOI2008] 校门外的区间", "background": "", "description": "受校门外的树这道经典问题的启发，A君根据基本的离散数学的知识，抽象出 $5$ 种运算维护集合 $S$ （$S$ 初始为空）并最终输出 $S$。现在，请你完成这道校门外的树之难度增强版——校门外的区间。\n\n五种运算如下：\n\n- `U T`：$S = S \\cup T$\n- `I T`：$S = S \\cap T$\n- `D T`：$S = S - T$\n- `C T`：$S = T - S$\n- `S T`：$S = S \\oplus T$\n\n集合的基本运算操作定义如下：\n\n- $A \\cup B$：$\\{x | x \\in A \\vee x \\in B\\}$\n- $A \\cap B$：$\\{x | x \\in A \\wedge x \\in B\\}$\n- $A - B$：$\\{x | x \\in A \\wedge x \\notin B\\}$\n- $A \\oplus B$：$(A-B)\\cup (B-A)$", "inputFormat": "输入 $M$ 行。每行第一个字母描述操作类型，后面给出一个区间（区间用 `(a,b)`，`(a,b]`，`[a,b)`，`[a,b]` 表示）。", "outputFormat": "输出一行若干区间，代表集合 $S$，**所有区间按递增顺序输出，相邻两个区间之间以一个空格隔开**。\n\n如果区间为空，输出 `empty set`。", "hint": "$ 0 \\leq a,b \\leq 65535, M \\leq 70000$", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2008] Intervals Outside the School Gate", "background": "", "description": "Inspired by the classic problem “Trees Outside the School Gate”, person A, based on basic knowledge of discrete mathematics, abstracts $5$ kinds of operations to maintain a set $S$ ($S$ is initially empty) and finally output $S$. Now, please complete this harder enhanced version of “Trees Outside the School Gate” — “Intervals Outside the School Gate”.\n\nThe five operations are:\n\n- `U T`: $S = S \\cup T$\n- `I T`: $S = S \\cap T$\n- `D T`: $S = S - T$\n- `C T`: $S = T - S$\n- `S T`: $S = S \\oplus T$\n\nThe basic set operations are defined as follows:\n\n- $A \\cup B$: $\\{x \\mid x \\in A \\vee x \\in B\\}$\n- $A \\cap B$: $\\{x \\mid x \\in A \\wedge x \\in B\\}$\n- $A - B$: $\\{x \\mid x \\in A \\wedge x \\notin B\\}$\n- $A \\oplus B$: $(A-B)\\cup (B-A)$.", "inputFormat": "There are $M$ lines. The first letter of each line describes the operation type, followed by an interval (an interval is written as `(a,b)`, `(a,b]`, `[a,b)`, `[a,b]`).", "outputFormat": "Output one line containing several intervals representing the set $S$. **All intervals should be output in increasing order, and there should be exactly one space between two adjacent intervals**.\n\nIf the set is empty, output `empty set`.", "hint": "$0 \\leq a,b \\leq 65535, M \\leq 70000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2008] 校门外的区间", "background": "", "description": "受校门外的树这道经典问题的启发，A君根据基本的离散数学的知识，抽象出 $5$ 种运算维护集合 $S$ （$S$ 初始为空）并最终输出 $S$。现在，请你完成这道校门外的树之难度增强版——校门外的区间。\n\n五种运算如下：\n\n- `U T`：$S = S \\cup T$\n- `I T`：$S = S \\cap T$\n- `D T`：$S = S - T$\n- `C T`：$S = T - S$\n- `S T`：$S = S \\oplus T$\n\n集合的基本运算操作定义如下：\n\n- $A \\cup B$：$\\{x | x \\in A \\vee x \\in B\\}$\n- $A \\cap B$：$\\{x | x \\in A \\wedge x \\in B\\}$\n- $A - B$：$\\{x | x \\in A \\wedge x \\notin B\\}$\n- $A \\oplus B$：$(A-B)\\cup (B-A)$", "inputFormat": "输入 $M$ 行。每行第一个字母描述操作类型，后面给出一个区间（区间用 `(a,b)`，`(a,b]`，`[a,b)`，`[a,b]` 表示）。", "outputFormat": "输出一行若干区间，代表集合 $S$，**所有区间按递增顺序输出，相邻两个区间之间以一个空格隔开**。\n\n如果区间为空，输出 `empty set`。", "hint": "$ 0 \\leq a,b \\leq 65535, M \\leq 70000$", "locale": "zh-CN"}}}
{"pid": "P5569", "type": "P", "difficulty": 6, "samples": [["4\n1\n1\n1\n1", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2008", "各省省选", "山东"], "title": "[SDOI2008] 石子合并", "background": "", "description": "在一个操场上摆放着一排 $N$ 堆石子。现要将石子有次序地合并成一堆。规定每次只能选相邻的 $2$ 堆石子合并成新的一堆，并将新的一堆石子数记为该次合并的得分。\n\n试设计一个算法，计算出将 $N$ 堆石子合并成一堆的最小得分。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，第 $i$ 行一个整数 $a_i$，代表第 $i$ 堆石子的石子数。", "outputFormat": "输出将所有石子合并为一堆的最小得分。", "hint": "$ N \\leq 40000, a_i \\leq 200$\n\n**请注意 $N$ 的范围（来自上传者的提示）**", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2008] Stone Merging", "background": "", "description": "On a playground, there is a row of $N$ piles of stones. Now you need to merge the piles in order into a single pile. Each time, you may only choose two adjacent piles to merge into a new pile, and the number of stones in the new pile is counted as the score of this merge.\n\nDesign an algorithm to compute the minimum total score needed to merge the $N$ piles into one pile.", "inputFormat": "The first line contains an integer $N$.\n\nIn the next $N$ lines, the $i$-th line contains an integer $a_i$, representing the number of stones in the $i$-th pile.", "outputFormat": "Output the minimum total score to merge all piles into one pile.", "hint": "$ N \\leq 40000, a_i \\leq 200$\n\n**Please note the range of $N$ (a hint from the uploader).**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2008] 石子合并", "background": "", "description": "在一个操场上摆放着一排 $N$ 堆石子。现要将石子有次序地合并成一堆。规定每次只能选相邻的 $2$ 堆石子合并成新的一堆，并将新的一堆石子数记为该次合并的得分。\n\n试设计一个算法，计算出将 $N$ 堆石子合并成一堆的最小得分。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，第 $i$ 行一个整数 $a_i$，代表第 $i$ 堆石子的石子数。", "outputFormat": "输出将所有石子合并为一堆的最小得分。", "hint": "$ N \\leq 40000, a_i \\leq 200$\n\n**请注意 $N$ 的范围（来自上传者的提示）**", "locale": "zh-CN"}}}
{"pid": "P5570", "type": "P", "difficulty": 7, "samples": [["2 3\n1 1\n..1\n221\n2\n1 3", "PUT 1 2\nPUT 1 1\nSTAR 2 1\nEND"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "NOI", "提交答案", "Special Judge"], "title": "[NOI2012] 三重镇", "background": "小西同学最近喜欢上了 iOS 游戏《三重镇 Triple Town》。游戏之余，小西也在思考如何才能在这个游戏中获得更高的分数。 ", "description": "如下图所示，游戏在一个 $n \\times m$ 的地图中进行。游戏给定一个**建造序列**，玩家按照此建造序列依次选择空白位置建造相应的建筑单位。建筑有九个不同的等级，由低到高分别为 `Grass`, `Bush`, `Tree`, `Hut` 等（为了方便描述，我们称之为 $L_1, L_2, L_3, \\ldots , L_9$）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/huzjus9n.png)\n\n当玩家在一个空白位置建造单位之后，有可能引起反应。反应的构成条件是：**从这个格子出发，与该建筑单位等级相同的格子所构成的连通块大小大于等于 $3$**， 则这个连通块将被合并为一个下一等级的建筑，此建筑的位置为最后建造的建筑单位位置，连通块中其他位置将变回空格。这里的连通块是指直接或者间接相邻的位置集合。\n\n另外需要注意的是，**$L_9$ 为建筑的最高等级，所以多个 $L_9$ 的连通块并不会合并**。例如在下图中，当建造了中间的 $L_1$ 之后，与该位置相连的 $L_1$就被合并成了一个 $L_2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95tnhrda.png)\n\n注意，在合并的过程中，可能会引起连环反应，如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0zmj49xv.png)\n\n游戏的得分取决于玩家建造和反应生成的单位，建造或者反应生成建筑单位就可以获得相应的分数。不同等级建筑的得分表如下：\n\n|建筑|$L_1$|$L_2$|$L_3$|$L_4$|$L_5$|$L_6$|$L_7$|$L_8$|$L_9$|\n|:----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|\n|得分|$4$|$20$|$100$|$500$|$1500$|$5000$|$20000$|$100000$|$500000$|\n\n以刚才的两个游戏过程为例。图 2 中，首先建造了 $L_1$, 将得到 $4$ 分，随后， $L_1$ 进行了反应生成了 $L_2$, 此时再得到 $20$ 分。总共得分为 $24$。而在图 3 中，这一步操作得分为 $4+20+100+500=624$ 分。\n\n为了降低游戏的难度，游戏中还设有两种道具，分别为“星星”和“炸弹”。在游戏开始时，玩家被给定 $p$ 个星星道具和 $q$ 个炸弹道具，玩家可以在任意时刻使用。两者功能如下：\n\n- “星星”道具：可以放置在一个空格位置。当星星被放置时，星星会自动变为**能引起反应的最高等级建筑**。当在该位置不能引起任何反应时，星星变为 $L_1$。例如，在图 3 正中间位置放置星星，星星自动变为 $L_3$。星星的得分按照变化后的建筑计算得分。\n- “炸弹”道具：炸弹道具可以放在在一个有建筑的位置上，作用为炸掉这个建筑并将该位置恢复为空格。当使用炸弹时，得分将扣除被炸掉的建筑的一半分数（即，得分为负数）。\n\n在游戏的进行过程中，玩家必须按照给定的顺序进行建造，但可以随时穿插使用两种道具。游戏的目标是，通过合理的操作，取得最高的分数。", "inputFormat": "**本题是一道提交答案题。**\n\n对于每个数据，输入文件中第一行为两个整数 $n$，$m$, 表示地图一共包含 $n$ 行 $m$ 列。\n\n接下来一行包含两个整数 $p$，$q$，分别表示道具星星和道具炸弹的数目。\n\n接下来 $n$ 行包含一个 $n \\times m$ 的初始地图。其中字符 `.` 表示空地，数字 $1\\sim 9$ 分别表示相应等级的建筑。\n\n再接下来一行包含一个数字 $k$，表示建造序列的长度。\n\n最后一行包含 $k$ 个空格隔开的 $1\\sim 9$ 之间的数字，表示建造序列的内容。", "outputFormat": "针对给定的 $10$ 个输入文件 `tritown1.in` ~ `tritown10.in`，你需要分别提交你的输出文件 `tritown1.out` ~ `tritown10.out`。\n\n输出文件包含玩家进行游戏的指令，共 $4$ 种指令：\n\n|指令|含义|\n|:--:|:----------:|\n|`PUT x y`|将建造序列中的下一个单位放置到第 $x$ 行第 $y$ 列的空格中。\n|`STAR x y`|放置星星道具到第$x$行第$y$列的空格中。|\n|`BOMBER x y`|在第 $x$ 行第 $y$ 列放置炸弹，此位置必须非空。|\n|`END`|游戏结束，结算当前得分。|\n\n输出必须以 `END` 指令结尾，玩家可以在任意时刻结束游戏。", "hint": "#### 样例解释\n\n本样例对应下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/62gxe52w.png)\n\n第一步得分为 $4+20+100=124$；\n\n第二步得分为 $100$；\n\n第三步得分为 $100+500=600$；\n\n游戏总得分 $124+100+600=824$ 分。\n\n#### 评分标准\n\n对于每组数据，我们设置了 $9$ 个评分参数 $a_{10}, a_9, …, a_2$，它们按此顺序每行一个放置在附加文件中的 `tritown1.ans` ~ `tritown10.ans` 内。如果选手的输出不合法，则得零分。否则，设在你的方案中，游戏得分为 $w_{user}$，你的分数将会由下表给出：\n\n|得分|条件|得分|条件|\n|:----:|:------:|:----:|:------:|\n|10|$w_{user}\\geq a_{10}$|5|$w_{user}\\geq a_5$|\n|9|$w_{user}\\geq a_9$|4|$w_{user}\\geq a_4$|\n|8|$w_{user}\\geq a_8$|3|$w_{user}\\geq a_3$|\n|7|$w_{user}\\geq a_7$|2|$w_{user}\\geq a_2$|\n|6|$w_{user}\\geq a_6$|1|$w_{user}>0$|\n\n如果有多项满足，则取满足条件中的最高得分。\n\n#### 附加文件\n\nchecker 需要自行编译后使用。\n\n请前往 [Github](https://github.com/MikeMirzayanov/testlib) 下载 testlib.h 的最新源代码。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2012] Triple Town", "background": "Student Xiao Xi recently became interested in the iOS game *Triple Town*. After playing, Xiao Xi also started thinking about how to get a higher score in this game.", "description": "As shown in the figure below, the game is played on an $n \\times m$ grid map. The game provides a **building sequence**. The player chooses an empty cell each time and places the corresponding building unit in order. Buildings have nine different levels. From low to high they are `Grass`, `Bush`, `Tree`, `Hut`, etc. (for convenience, we call them $L_1, L_2, L_3, \\ldots , L_9$).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/huzjus9n.png)\n\nAfter the player builds a unit on an empty cell, it may trigger a reaction. A reaction happens if: **starting from this cell, the size of the connected component formed by cells with the same building level as this unit is at least $3$**. Then this connected component will be merged into one building of the next level. The new building is placed at the position of the last built unit, and all other cells in the component become empty. Here, a connected component means a set of positions that are directly or indirectly adjacent.\n\nAlso note that **$L_9$ is the highest level, so connected components of multiple $L_9$ will not merge**. For example, in the figure below, after building the middle $L_1$, the $L_1$ connected to it are merged into one $L_2$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95tnhrda.png)\n\nNote that during merging, chain reactions may occur, as shown below.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0zmj49xv.png)\n\nThe game score depends on the units the player builds and the units generated by reactions. Whenever a building unit is placed or generated by a reaction, the corresponding score is added. The score table for different building levels is as follows:\n\n|Building|$L_1$|$L_2$|$L_3$|$L_4$|$L_5$|$L_6$|$L_7$|$L_8$|$L_9$|\n|:----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|\n|Score|$4$|$20$|$100$|$500$|$1500$|$5000$|$20000$|$100000$|$500000$|\n\nUsing the two game processes above as examples: in Figure 2, first an $L_1$ is built, gaining $4$ points. Then the $L_1$ reacts and generates an $L_2$, gaining another $20$ points. The total is $24$. In Figure 3, this move scores $4+20+100+500=624$ points.\n\nTo reduce the difficulty, the game also provides two items: “star” and “bomb”. At the start of the game, the player is given $p$ stars and $q$ bombs, and can use them at any time. Their functions are:\n\n- “Star” item: It can be placed on an empty cell. When a star is placed, it automatically becomes the **highest-level building that can trigger a reaction**. If no reaction can be triggered at that position, the star becomes $L_1$. For example, placing a star at the very center in Figure 3, the star automatically becomes $L_3$. The score of the star is calculated according to the building level it becomes.\n- “Bomb” item: A bomb can be placed on a cell that already has a building. It destroys the building and turns that cell back into empty. When using a bomb, half of the destroyed building’s score is deducted (i.e. the score added is negative).\n\nDuring the game, the player must place buildings in the given order, but may interleave the use of the two items at any time. The goal is to achieve the highest possible score through proper operations.", "inputFormat": "**This is an output-only problem.**\n\nFor each test, the first line of the input file contains two integers $n$, $m$, indicating that the map has $n$ rows and $m$ columns.\n\nThe next line contains two integers $p$, $q$, indicating the number of star items and bomb items.\n\nThe next $n$ lines contain the initial $n \\times m$ map. The character `.` means an empty cell, and digits $1\\sim 9$ represent buildings of the corresponding levels.\n\nThe next line contains a number $k$, indicating the length of the building sequence.\n\nThe last line contains $k$ space-separated integers between $1\\sim 9$, indicating the content of the building sequence.", "outputFormat": "For the given $10$ input files `tritown1.in` ~ `tritown10.in`, you need to submit your output files `tritown1.out` ~ `tritown10.out` respectively.\n\nEach output file contains the player’s game commands. There are $4$ types of commands:\n\n|Command|Meaning|\n|:--:|:----------:|\n|`PUT x y`|Place the next unit in the building sequence into the empty cell at row $x$, column $y$.|\n|`STAR x y`|Place a star item into the empty cell at row $x$, column $y$.|\n|`BOMBER x y`|Place a bomb at row $x$, column $y$. This cell must be non-empty.|\n|`END`|End the game and settle the current score.|\n\nThe output must end with the `END` command. The player may end the game at any time.", "hint": "#### Sample Explanation\n\nThis sample corresponds to the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/62gxe52w.png)\n\nThe first move scores $4+20+100=124$.\n\nThe second move scores $100$.\n\nThe third move scores $100+500=600$.\n\nThe total score is $124+100+600=824$.\n\n#### Scoring\n\nFor each test, we provide $9$ scoring parameters $a_{10}, a_9, \\ldots, a_2$, one per line in this order, in the additional files `tritown1.ans` ~ `tritown10.ans`. If your output is invalid, you get $0$ points. Otherwise, let your game score be $w_{user}$. Your score is given by the table below:\n\n|Score|Condition|Score|Condition|\n|:----:|:------:|:----:|:------:|\n|10|$w_{user}\\geq a_{10}$|5|$w_{user}\\geq a_5$|\n|9|$w_{user}\\geq a_9$|4|$w_{user}\\geq a_4$|\n|8|$w_{user}\\geq a_8$|3|$w_{user}\\geq a_3$|\n|7|$w_{user}\\geq a_7$|2|$w_{user}\\geq a_2$|\n|6|$w_{user}\\geq a_6$|1|$w_{user}>0$|\n\nIf multiple conditions are satisfied, take the highest score among them.\n\n#### Additional Files\n\nThe checker needs to be compiled before use.\n\nPlease go to [Github](https://github.com/MikeMirzayanov/testlib) to download the latest source code of testlib.h.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2012] 三重镇", "background": "小西同学最近喜欢上了 iOS 游戏《三重镇 Triple Town》。游戏之余，小西也在思考如何才能在这个游戏中获得更高的分数。 ", "description": "如下图所示，游戏在一个 $n \\times m$ 的地图中进行。游戏给定一个**建造序列**，玩家按照此建造序列依次选择空白位置建造相应的建筑单位。建筑有九个不同的等级，由低到高分别为 `Grass`, `Bush`, `Tree`, `Hut` 等（为了方便描述，我们称之为 $L_1, L_2, L_3, \\ldots , L_9$）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/huzjus9n.png)\n\n当玩家在一个空白位置建造单位之后，有可能引起反应。反应的构成条件是：**从这个格子出发，与该建筑单位等级相同的格子所构成的连通块大小大于等于 $3$**， 则这个连通块将被合并为一个下一等级的建筑，此建筑的位置为最后建造的建筑单位位置，连通块中其他位置将变回空格。这里的连通块是指直接或者间接相邻的位置集合。\n\n另外需要注意的是，**$L_9$ 为建筑的最高等级，所以多个 $L_9$ 的连通块并不会合并**。例如在下图中，当建造了中间的 $L_1$ 之后，与该位置相连的 $L_1$就被合并成了一个 $L_2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95tnhrda.png)\n\n注意，在合并的过程中，可能会引起连环反应，如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0zmj49xv.png)\n\n游戏的得分取决于玩家建造和反应生成的单位，建造或者反应生成建筑单位就可以获得相应的分数。不同等级建筑的得分表如下：\n\n|建筑|$L_1$|$L_2$|$L_3$|$L_4$|$L_5$|$L_6$|$L_7$|$L_8$|$L_9$|\n|:----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|\n|得分|$4$|$20$|$100$|$500$|$1500$|$5000$|$20000$|$100000$|$500000$|\n\n以刚才的两个游戏过程为例。图 2 中，首先建造了 $L_1$, 将得到 $4$ 分，随后， $L_1$ 进行了反应生成了 $L_2$, 此时再得到 $20$ 分。总共得分为 $24$。而在图 3 中，这一步操作得分为 $4+20+100+500=624$ 分。\n\n为了降低游戏的难度，游戏中还设有两种道具，分别为“星星”和“炸弹”。在游戏开始时，玩家被给定 $p$ 个星星道具和 $q$ 个炸弹道具，玩家可以在任意时刻使用。两者功能如下：\n\n- “星星”道具：可以放置在一个空格位置。当星星被放置时，星星会自动变为**能引起反应的最高等级建筑**。当在该位置不能引起任何反应时，星星变为 $L_1$。例如，在图 3 正中间位置放置星星，星星自动变为 $L_3$。星星的得分按照变化后的建筑计算得分。\n- “炸弹”道具：炸弹道具可以放在在一个有建筑的位置上，作用为炸掉这个建筑并将该位置恢复为空格。当使用炸弹时，得分将扣除被炸掉的建筑的一半分数（即，得分为负数）。\n\n在游戏的进行过程中，玩家必须按照给定的顺序进行建造，但可以随时穿插使用两种道具。游戏的目标是，通过合理的操作，取得最高的分数。", "inputFormat": "**本题是一道提交答案题。**\n\n对于每个数据，输入文件中第一行为两个整数 $n$，$m$, 表示地图一共包含 $n$ 行 $m$ 列。\n\n接下来一行包含两个整数 $p$，$q$，分别表示道具星星和道具炸弹的数目。\n\n接下来 $n$ 行包含一个 $n \\times m$ 的初始地图。其中字符 `.` 表示空地，数字 $1\\sim 9$ 分别表示相应等级的建筑。\n\n再接下来一行包含一个数字 $k$，表示建造序列的长度。\n\n最后一行包含 $k$ 个空格隔开的 $1\\sim 9$ 之间的数字，表示建造序列的内容。", "outputFormat": "针对给定的 $10$ 个输入文件 `tritown1.in` ~ `tritown10.in`，你需要分别提交你的输出文件 `tritown1.out` ~ `tritown10.out`。\n\n输出文件包含玩家进行游戏的指令，共 $4$ 种指令：\n\n|指令|含义|\n|:--:|:----------:|\n|`PUT x y`|将建造序列中的下一个单位放置到第 $x$ 行第 $y$ 列的空格中。\n|`STAR x y`|放置星星道具到第$x$行第$y$列的空格中。|\n|`BOMBER x y`|在第 $x$ 行第 $y$ 列放置炸弹，此位置必须非空。|\n|`END`|游戏结束，结算当前得分。|\n\n输出必须以 `END` 指令结尾，玩家可以在任意时刻结束游戏。", "hint": "#### 样例解释\n\n本样例对应下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/62gxe52w.png)\n\n第一步得分为 $4+20+100=124$；\n\n第二步得分为 $100$；\n\n第三步得分为 $100+500=600$；\n\n游戏总得分 $124+100+600=824$ 分。\n\n#### 评分标准\n\n对于每组数据，我们设置了 $9$ 个评分参数 $a_{10}, a_9, …, a_2$，它们按此顺序每行一个放置在附加文件中的 `tritown1.ans` ~ `tritown10.ans` 内。如果选手的输出不合法，则得零分。否则，设在你的方案中，游戏得分为 $w_{user}$，你的分数将会由下表给出：\n\n|得分|条件|得分|条件|\n|:----:|:------:|:----:|:------:|\n|10|$w_{user}\\geq a_{10}$|5|$w_{user}\\geq a_5$|\n|9|$w_{user}\\geq a_9$|4|$w_{user}\\geq a_4$|\n|8|$w_{user}\\geq a_8$|3|$w_{user}\\geq a_3$|\n|7|$w_{user}\\geq a_7$|2|$w_{user}\\geq a_2$|\n|6|$w_{user}\\geq a_6$|1|$w_{user}>0$|\n\n如果有多项满足，则取满足条件中的最高得分。\n\n#### 附加文件\n\nchecker 需要自行编译后使用。\n\n请前往 [Github](https://github.com/MikeMirzayanov/testlib) 下载 testlib.h 的最新源代码。", "locale": "zh-CN"}}}
{"pid": "P5571", "type": "P", "difficulty": 6, "samples": [["4 3\n2 3\n3 4\n4 3\n3 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["计算几何"], "title": "[CmdOI2019] 高塔与晶石", "background": "**温馨提示 : 请注意常数因子对程序效率带来的影响 + 本题特殊的空间限制**\n\n几何王国之中，矗立着$n$座古老的高塔，传说，它们是这片净土的守护者。\n\n随着几何学日新月异的发展，王国的繁荣引来了烈炎深处的恐怖：动点P。\n\n驯服动点恶龙的英雄笛卡尔尚未出现，几何王国的领主决定固守静态几何的阵地。\n\n", "description": "他得到了静态几何的三颗智慧晶石(里面当然是神级数学题啦)，并且可以把它们安放在高塔之中。\n\n三颗安放着晶石的高塔，可以保护其围成的三角形内部不受侵入。\n\n但是，如果晶石围成的三角型面积太大，防线将会十分容易被击破。\n\n如果三角型面积太小，其中能够产生的几何能量又不足以维持晶石的运作。\n\n经过几天的推算，领主在认为， $\\binom{n}{3}$ 种做法中,面积第 $k$ **小**的方案是最合适的。\n\n(三角形面积可以为 $0$)\n\n他对这个结果很不放心，于是拜托单手虐爆无数几何题的你,来帮他计算这个面积具体是多少。", "inputFormat": "第一行两个整数$n,k$，意义如题目所述。\n\n后 $n$ 行，第 $i$ 行有两个数 $x_i,y_i$ ，表示 $i$ 号高塔的坐标。", "outputFormat": "输出面积第 $k$ **小**方案对应面积的**2倍**，容易证明这一定是个整数。", "hint": "| subtask编号 | 　n　 | 备注 | 分值 | 时限 |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | 200 | - | 15 | 1S |\n| 2 | 500 | $k\\leq10$ | 20 | 1S |\n| 3 | 500 | $k\\leq10000$ | 15 | 1S |\n| 4 | 800 | - | 50 | 2S |\n\n$1\\leq x_i,y_i \\leq 10^6$ , 所有坐标都是正整数 , 高塔的坐标不会重复。\n\n**样例解释:**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y3is3hxv.png)", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Towers and Crystals", "background": "**Warm reminder: Please pay attention to the impact of constant factors on program efficiency + the special memory limit of this problem.**\n\nIn the Kingdom of Geometry, there stand $n$ ancient towers. Legend says they are the guardians of this pure land.\n\nAs geometry develops rapidly day by day, the kingdom’s prosperity attracts a terror from the depths of blazing flames: the moving point $P$.\n\nBefore the hero Descartes, who can tame the “moving-point dragon,” appears, the lord of the Kingdom of Geometry decides to hold the line in the field of static geometry.", "description": "He obtained three “wisdom crystals” of static geometry (of course, they contain god-level math problems), and he can place them into the towers.\n\nThree towers with crystals placed can protect the interior of the triangle they form from invasion.\n\nHowever, if the area of the triangle formed by the crystals is too large, the defense line will be very easy to break.\n\nIf the area of the triangle is too small, the geometric energy generated inside will not be enough to keep the crystals running.\n\nAfter several days of calculation, the lord believes that among the $\\binom{n}{3}$ possible choices, the plan with the $k$-th **smallest** area is the most suitable.\n\n(The triangle area can be $0$.)\n\nHe is still not confident about this result, so he asks you—who can crush countless geometry problems with one hand—to help him compute the exact value of this area.", "inputFormat": "The first line contains two integers $n,k$, with the meanings as described in the statement.\n\nThe next $n$ lines: the $i$-th line contains two numbers $x_i,y_i$, representing the coordinates of tower $i$.", "outputFormat": "Output **twice** the area corresponding to the plan with the $k$-th **smallest** area. It is easy to prove that this must be an integer.", "hint": "| subtask ID | 　n　 | Notes | Score | Time Limit |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | 200 | - | 15 | 1S |\n| 2 | 500 | $k\\leq10$ | 20 | 1S |\n| 3 | 500 | $k\\leq10000$ | 15 | 1S |\n| 4 | 800 | - | 50 | 2S |\n\nConstraints: $1\\leq x_i,y_i \\leq 10^6$, all coordinates are positive integers, and no two towers share the same coordinates.\n\n**Sample explanation:**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y3is3hxv.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 高塔与晶石", "background": "**温馨提示 : 请注意常数因子对程序效率带来的影响 + 本题特殊的空间限制**\n\n几何王国之中，矗立着$n$座古老的高塔，传说，它们是这片净土的守护者。\n\n随着几何学日新月异的发展，王国的繁荣引来了烈炎深处的恐怖：动点P。\n\n驯服动点恶龙的英雄笛卡尔尚未出现，几何王国的领主决定固守静态几何的阵地。\n\n", "description": "他得到了静态几何的三颗智慧晶石(里面当然是神级数学题啦)，并且可以把它们安放在高塔之中。\n\n三颗安放着晶石的高塔，可以保护其围成的三角形内部不受侵入。\n\n但是，如果晶石围成的三角型面积太大，防线将会十分容易被击破。\n\n如果三角型面积太小，其中能够产生的几何能量又不足以维持晶石的运作。\n\n经过几天的推算，领主在认为， $\\binom{n}{3}$ 种做法中,面积第 $k$ **小**的方案是最合适的。\n\n(三角形面积可以为 $0$)\n\n他对这个结果很不放心，于是拜托单手虐爆无数几何题的你,来帮他计算这个面积具体是多少。", "inputFormat": "第一行两个整数$n,k$，意义如题目所述。\n\n后 $n$ 行，第 $i$ 行有两个数 $x_i,y_i$ ，表示 $i$ 号高塔的坐标。", "outputFormat": "输出面积第 $k$ **小**方案对应面积的**2倍**，容易证明这一定是个整数。", "hint": "| subtask编号 | 　n　 | 备注 | 分值 | 时限 |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | 200 | - | 15 | 1S |\n| 2 | 500 | $k\\leq10$ | 20 | 1S |\n| 3 | 500 | $k\\leq10000$ | 15 | 1S |\n| 4 | 800 | - | 50 | 2S |\n\n$1\\leq x_i,y_i \\leq 10^6$ , 所有坐标都是正整数 , 高塔的坐标不会重复。\n\n**样例解释:**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y3is3hxv.png)", "locale": "zh-CN"}}}
{"pid": "P5572", "type": "P", "difficulty": 7, "samples": [["5\n10 10\n20 20\n30 30\n40 40\n50 50\n", "768\n13312\n16218\n7160\n9031"], ["3\n5 4\n20 15\n100 88", "52\n7572\n21475"]], "limits": {"time": [1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "数论", "莫比乌斯反演", "分块", "根号分治", "整除分块", "欧拉函数"], "title": "[CmdOI2019] 简单的数论题", "background": "", "description": "给出 $n,m$ 求下列式子的值 ：\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\varphi\\left(\\dfrac{{\\rm lcm}(i,j)}{\\gcd(i,j)}\\right) \\bmod 23333$$", "inputFormat": "第一行一个整数 $T$，表示询问数。\n\n后 $T$ 行每行两个整数 $n,m$ ,表示一个询问。", "outputFormat": "对于每个询问，输出一行一个整数，表示答案。", "hint": "对于所有测试点， $T\\leq 3\\times 10^4,\\ m\\leq n\\leq 5\\times 10^4$。\n\n| 测试点编号 | $n,m\\leq $ | $T$ | 时限 | 特殊性质 | \n| :--: | :--: | :--: | :--: | :--: |\n| #1~2 | $100$ | $100$ | $\\texttt{1s}$ |  |\n| #3~4 | $2000$ | $3\\times 10^4$ | $\\texttt{1s}$ |  |\n| #5~6 | $3\\times 10^4$ | $5000$ | $\\texttt{2s}$ |  |\n| #7~8 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ | $n=m$ |\n| #9~10 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ |  |", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Simple Number Theory Problem", "background": "", "description": "Given $n,m$, find the value of the following expression:\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\varphi\\left(\\dfrac{{\\rm lcm}(i,j)}{\\gcd(i,j)}\\right) \\bmod 23333$$", "inputFormat": "The first line contains an integer $T$, which denotes the number of queries.\n\nThe next $T$ lines each contain two integers $n,m$, representing one query.", "outputFormat": "For each query, output one integer per line, which is the answer.", "hint": "For all test cases, $T\\leq 3\\times 10^4,\\ m\\leq n\\leq 5\\times 10^4$.\n\n| Test Point ID | $n,m\\leq$ | $T$ | Time Limit | Special Property |\n| :--: | :--: | :--: | :--: | :--: |\n| #1~2 | $100$ | $100$ | $\\texttt{1s}$ |  |\n| #3~4 | $2000$ | $3\\times 10^4$ | $\\texttt{1s}$ |  |\n| #5~6 | $3\\times 10^4$ | $5000$ | $\\texttt{2s}$ |  |\n| #7~8 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ | $n=m$ |\n| #9~10 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ |  |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 简单的数论题", "background": "", "description": "给出 $n,m$ 求下列式子的值 ：\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\varphi\\left(\\dfrac{{\\rm lcm}(i,j)}{\\gcd(i,j)}\\right) \\bmod 23333$$", "inputFormat": "第一行一个整数 $T$，表示询问数。\n\n后 $T$ 行每行两个整数 $n,m$ ,表示一个询问。", "outputFormat": "对于每个询问，输出一行一个整数，表示答案。", "hint": "对于所有测试点， $T\\leq 3\\times 10^4,\\ m\\leq n\\leq 5\\times 10^4$。\n\n| 测试点编号 | $n,m\\leq $ | $T$ | 时限 | 特殊性质 | \n| :--: | :--: | :--: | :--: | :--: |\n| #1~2 | $100$ | $100$ | $\\texttt{1s}$ |  |\n| #3~4 | $2000$ | $3\\times 10^4$ | $\\texttt{1s}$ |  |\n| #5~6 | $3\\times 10^4$ | $5000$ | $\\texttt{2s}$ |  |\n| #7~8 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ | $n=m$ |\n| #9~10 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ |  |", "locale": "zh-CN"}}}
{"pid": "P5573", "type": "P", "difficulty": 7, "samples": [["3 3\n1 2 3\n3 2 1\n4 2 2\n5 1 2 2 3 3\n3 3 3 3 3 3\n6 3 5 2 3 1", "2\n2\n1"], ["10 10\n43 24 8 66 96 25 43 87 62 8 \n80 25 94 72 43 18 94 96 11 54 \n19 25 92 87 76 36 89 91 69 22 \n82 2 82 5 82 3\n70 10 96 8 70 8\n52 7 23 5 52 10\n85 1 62 4 85 5\n1 5 49 7 1 6\n32 7 54 8 32 9\n6 1 89 4 6 10\n82 10 38 5 82 7\n87 2 1 10 87 2\n12 3 77 5 12 8", "10\n7\n0\n5\n0\n1\n1\n5\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["生成树", "字典树 Trie"], "title": "[CmdOI2019] 星际kfc篮球赛", "background": "公元 $3100$ 年，地球联盟的银河系内 $N$ 个星球已经完成了道路大建设，从原来的 $N-1$ 条双向时空隧道变成了**无向完全图**。\n\nLouis Paosen 是一个星际旅行家，上次你~~虐队的时候~~顺便帮他解决了难题，于是他又来请求你帮忙啦。", "description": "仍然是出于资金的考虑，地球联盟没能将所有的道路都建造得尽善尽美。通过某条道路**对于飞船的性能有一定的要求**。\n\nLouis Paosen 在联盟内举办了盛大的 kfc 三人篮球赛，一时间，许多来自不同星球的选手纷纷赶来参赛。\n\n整个地球联盟的内部正在热卖三种飞船 (A/B/C 类)，由于收了广告费的缘故，组队的时候要求 $3$ 人中第一人使用 A，第二人使用 B，第三人使用 C (这样可以获得加分)。\n\n现在有许许多多个三人小组准备参赛，他们准备好了飞船(符合加分条件)，但是他们可能来自不同的星球，由于飞船性能的限制，他们可能无法一起到达某个星球。\n\n由于这三家公司制造工艺大相径庭，飞船对同一条道路环境的耐受力区别很大，而有奇怪的规律。\n\n点 $u$ 有三组系数 $P_A[u],P_B[u],P_C[u]$ ，边 $u\\leftrightarrow v$ 的通过难度为:\n\n$$\\begin{cases}\\text{A形飞船通过难度}=P_A[u]\\ {\\rm xor}\\ P_A[v]\\\\\\text{B形飞船通过难度}=P_B[u]\\ {\\rm xor}\\ P_B[v]\\\\\\text{C形飞船通过难度}=P_C[u]\\ {\\rm xor}\\ P_C[v]\\end{cases}$$\n\n当一个飞船的性能指数不低于某条边对应种类的通过难度时,这个飞船才能够通过 (具体见样例解释)。\n\nLouis Paosen 在每个星球上都准备了比赛点，所以你只要对每个三人小组，给出其可行的集合点个数就好了。", "inputFormat": "第一行：$n,q$。\n\n第 2~4 行：$P_A[1\\sim n],P_B[1\\sim n],P_C[1\\sim n]$。\n\n后 $q$ 行：每行六个数 $h_A,u_A,h_B,u_B,h_C,u_C$ ，表示一个三人小队中每个人的飞船性能以及出发星球编号。", "outputFormat": "对于每个三人小队，输出一行一个数，回答可行的集合点个数。", "hint": "| 　编号　 | 　　n　　 | 　　q　　 | ① | ② | ③ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| #1-3 | $100$ | $100$ | - | - | - |\n| #4 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | * |\n| #5 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | - |\n| #6 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | * |\n| #7 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | - |\n| #8 | $4\\times 10^4$ | $4\\times 10^4$ | - | - | - |\n| #9 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | * |\n| #10~13 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | - |\n\n- 性质①：$P_C[1\\sim n]$ 都相等；\n- 性质②：$P_B[1\\sim n]$ 都相等；\n- 性质③：$P_A[1\\sim n], P_B[1\\sim n], P_C[1\\sim n]\\in \\{0,1\\}$。\n\n（#1~#9 每个 $6$ 分，#10~#13 共 $46$ 分；#1~#7 空间限制为 500MB，其余测试点空间限制为 125MB）。\n\n所有输入中的数都是 $[0,10^8]$ 内的整数。\n\n### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gn9va8wd.png)\n\n三张性能图如上。\n\n如 A 图，$\\begin{cases}(1,2)=P_A[1]\\ {\\rm xor}\\ P_A[2]=3;\\\\(1,3)=P_A[1]\\ {\\rm xor}\\ P_A[3]=2;\\\\(2,3)=P_A[1]\\ {\\rm xor}\\ P_A[2]=1;\\end{cases}$\n\n(边的产生方式就是根据三个数组异或)\n\n第一组人:\n\n- 从 $1$ 出发的 A 飞船性能高达 $5$，能到达所有的星球。\n- 从 $2$ 出发的 B 飞船性能仅为 $2$，不能经过$(3,2)=3$，但是还能到达所有的星球。\n- 从 $3$ 出发的 B 飞船性能仅为 $3$，只能经过$(2,3)=0$，能到达 $2,3$ 号星球。\n- 综上，第一组所有人都能到达的星球有 $2$ 个。", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Interstellar KFC 3-on-3 Basketball Tournament", "background": "In the year $3100$, the Earth Federation’s galaxy contains $N$ planets that have completed a massive road construction project, upgrading from the original $N-1$ bidirectional spacetime tunnels to an **undirected complete graph**.\n\nLouis Paosen is an interstellar traveler. Last time you helped him solve a difficult problem (when you ~~were crushing teams~~), so he has come to ask for your help again.", "description": "Still due to funding concerns, the Earth Federation could not build every road perfectly. Traveling through a road **requires certain ship performance**.\n\nLouis Paosen is hosting a grand KFC 3-on-3 basketball tournament within the federation. For a time, many players from different planets rushed to participate.\n\nThree kinds of ships (types A/B/C) are being heavily promoted inside the Earth Federation. Because they took advertising money, team formation requires that among the $3$ people: the first uses type A, the second uses type B, and the third uses type C (so they can get bonus points).\n\nNow there are many 3-person teams preparing to join. They have their ships ready (meeting the bonus condition), but they may come from different planets. Due to ship performance limits, they may not be able to gather together on some planet.\n\nBecause the manufacturing processes of these three companies are very different, ships have very different tolerance to the environment of the same road, following a strange rule.\n\nNode $u$ has three sets of coefficients $P_A[u],P_B[u],P_C[u]$. The passing difficulty of edge $u\\leftrightarrow v$ is:\n\n$$\\begin{cases}\\text{Type A ship passing difficulty}=P_A[u]\\ {\\rm xor}\\ P_A[v]\\\\\\text{Type B ship passing difficulty}=P_B[u]\\ {\\rm xor}\\ P_B[v]\\\\\\text{Type C ship passing difficulty}=P_C[u]\\ {\\rm xor}\\ P_C[v]\\end{cases}$$\n\nA ship can pass an edge only when its performance index is not less than the passing difficulty of that edge for the corresponding type (see the sample explanation for details).\n\nLouis Paosen has prepared a match venue on every planet, so for each 3-person team, you only need to output the number of feasible gathering planets.", "inputFormat": "The first line: $n,q$.\n\nLines 2 to 4: $P_A[1\\sim n],P_B[1\\sim n],P_C[1\\sim n]$.\n\nThe next $q$ lines: each line contains six numbers $h_A,u_A,h_B,u_B,h_C,u_C$, representing the ship performance and the starting planet index for each of the three members of a team.", "outputFormat": "For each 3-person team, output one line with one number: the number of feasible gathering planets.", "hint": "| ID | $n$ | $q$ | ① | ② | ③ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| #1-3 | $100$ | $100$ | - | - | - |\n| #4 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | * |\n| #5 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | - |\n| #6 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | * |\n| #7 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | - |\n| #8 | $4\\times 10^4$ | $4\\times 10^4$ | - | - | - |\n| #9 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | * |\n| #10~13 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | - |\n\n- Property ①: $P_C[1\\sim n]$ are all equal.\n- Property ②: $P_B[1\\sim n]$ are all equal.\n- Property ③: $P_A[1\\sim n], P_B[1\\sim n], P_C[1\\sim n]\\in \\{0,1\\}$.\n\n(#1~#9 are $6$ points each, #10~#13 are $46$ points total; #1~#7 have a memory limit of 500MB, and the remaining test points have a memory limit of 125MB).\n\nAll numbers in the input are integers within $[0,10^8]$.\n\n### Sample 1 Explanation\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gn9va8wd.png)\n\nThe three performance graphs are shown above.\n\nFor the A graph, $\\begin{cases}(1,2)=P_A[1]\\ {\\rm xor}\\ P_A[2]=3;\\\\(1,3)=P_A[1]\\ {\\rm xor}\\ P_A[3]=2;\\\\(2,3)=P_A[1]\\ {\\rm xor}\\ P_A[2]=1;\\end{cases}$\n\n(The edges are generated by XOR-ing the three arrays.)\n\nThe first team:\n\n- The type A ship starting from $1$ has performance as high as $5$, and can reach all planets.\n- The type B ship starting from $2$ has performance only $2$, cannot pass $(3,2)=3$, but can still reach all planets.\n- The type B ship starting from $3$ has performance only $3$, can only pass $(2,3)=0$, and can reach planets $2,3$.\n- Therefore, the number of planets that all members of the first team can reach is $2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 星际kfc篮球赛", "background": "公元 $3100$ 年，地球联盟的银河系内 $N$ 个星球已经完成了道路大建设，从原来的 $N-1$ 条双向时空隧道变成了**无向完全图**。\n\nLouis Paosen 是一个星际旅行家，上次你~~虐队的时候~~顺便帮他解决了难题，于是他又来请求你帮忙啦。", "description": "仍然是出于资金的考虑，地球联盟没能将所有的道路都建造得尽善尽美。通过某条道路**对于飞船的性能有一定的要求**。\n\nLouis Paosen 在联盟内举办了盛大的 kfc 三人篮球赛，一时间，许多来自不同星球的选手纷纷赶来参赛。\n\n整个地球联盟的内部正在热卖三种飞船 (A/B/C 类)，由于收了广告费的缘故，组队的时候要求 $3$ 人中第一人使用 A，第二人使用 B，第三人使用 C (这样可以获得加分)。\n\n现在有许许多多个三人小组准备参赛，他们准备好了飞船(符合加分条件)，但是他们可能来自不同的星球，由于飞船性能的限制，他们可能无法一起到达某个星球。\n\n由于这三家公司制造工艺大相径庭，飞船对同一条道路环境的耐受力区别很大，而有奇怪的规律。\n\n点 $u$ 有三组系数 $P_A[u],P_B[u],P_C[u]$ ，边 $u\\leftrightarrow v$ 的通过难度为:\n\n$$\\begin{cases}\\text{A形飞船通过难度}=P_A[u]\\ {\\rm xor}\\ P_A[v]\\\\\\text{B形飞船通过难度}=P_B[u]\\ {\\rm xor}\\ P_B[v]\\\\\\text{C形飞船通过难度}=P_C[u]\\ {\\rm xor}\\ P_C[v]\\end{cases}$$\n\n当一个飞船的性能指数不低于某条边对应种类的通过难度时,这个飞船才能够通过 (具体见样例解释)。\n\nLouis Paosen 在每个星球上都准备了比赛点，所以你只要对每个三人小组，给出其可行的集合点个数就好了。", "inputFormat": "第一行：$n,q$。\n\n第 2~4 行：$P_A[1\\sim n],P_B[1\\sim n],P_C[1\\sim n]$。\n\n后 $q$ 行：每行六个数 $h_A,u_A,h_B,u_B,h_C,u_C$ ，表示一个三人小队中每个人的飞船性能以及出发星球编号。", "outputFormat": "对于每个三人小队，输出一行一个数，回答可行的集合点个数。", "hint": "| 　编号　 | 　　n　　 | 　　q　　 | ① | ② | ③ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| #1-3 | $100$ | $100$ | - | - | - |\n| #4 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | * |\n| #5 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | - |\n| #6 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | * |\n| #7 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | - |\n| #8 | $4\\times 10^4$ | $4\\times 10^4$ | - | - | - |\n| #9 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | * |\n| #10~13 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | - |\n\n- 性质①：$P_C[1\\sim n]$ 都相等；\n- 性质②：$P_B[1\\sim n]$ 都相等；\n- 性质③：$P_A[1\\sim n], P_B[1\\sim n], P_C[1\\sim n]\\in \\{0,1\\}$。\n\n（#1~#9 每个 $6$ 分，#10~#13 共 $46$ 分；#1~#7 空间限制为 500MB，其余测试点空间限制为 125MB）。\n\n所有输入中的数都是 $[0,10^8]$ 内的整数。\n\n### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gn9va8wd.png)\n\n三张性能图如上。\n\n如 A 图，$\\begin{cases}(1,2)=P_A[1]\\ {\\rm xor}\\ P_A[2]=3;\\\\(1,3)=P_A[1]\\ {\\rm xor}\\ P_A[3]=2;\\\\(2,3)=P_A[1]\\ {\\rm xor}\\ P_A[2]=1;\\end{cases}$\n\n(边的产生方式就是根据三个数组异或)\n\n第一组人:\n\n- 从 $1$ 出发的 A 飞船性能高达 $5$，能到达所有的星球。\n- 从 $2$ 出发的 B 飞船性能仅为 $2$，不能经过$(3,2)=3$，但是还能到达所有的星球。\n- 从 $3$ 出发的 B 飞船性能仅为 $3$，只能经过$(2,3)=0$，能到达 $2,3$ 号星球。\n- 综上，第一组所有人都能到达的星球有 $2$ 个。", "locale": "zh-CN"}}}
{"pid": "P5574", "type": "P", "difficulty": 6, "samples": [["5 1\n1 5 4 2 3", "5"], ["5 2\n1 5 4 2 3", "1"], ["8 3\n1 3 5 2 7 4 8 6", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "O2优化", "分治", "凸完全单调性（wqs 二分）"], "title": "[CmdOI2019] 任务分配问题", "background": "挖矿的时候踢断电源线是一种怎样的体验?", "description": "在某台有 $k$ 个 CPU 的计算机中，有 $n$ 个计算任务等待执行。\n\n$a_i$ 为第 $i$ 个任务的优先级，方便起见， $a$ 为一个排列。\n\n现在，要将这些任务分配给 CPU 去解决。\n\n由于内存等原因，一个 CPU 只能负责连续一段的任务，并且要按 (从左到右的) 顺序执行。\n\n**在某个 CPU 内**，无序度定义为：前者先执行，而后者优先级高的任务对的个数。\n\n请最小化每个 CPU 的无序度之和。", "inputFormat": "第一行两个整数 $n,k$ ，分别表示任务个数和 CPU 个数。\n\n第二行 $n$ 个整数，表示 $a_{1\\sim n}$ 。", "outputFormat": "输出一个整数，表示最小的无序度之和。", "hint": "### 样例说明\n\n- **样例 #1**\n\n  此时只能把所有任务交给单独的一个 CPU。\n\n  第一个任务和其他所有任务都形成无序任务对；最后两个任务也形成无序任务对，共 $5$ 个。\n\n- **样例 #2**\n\n  第一个 CPU 单独处理任务 $1$ ，无序度为 $0$；\n  \n  第二个 CPU 处理 $\\{5,4,2,3\\}$ 无序度为 $1$。\n  \n### 限制与约定\n\n对于所有测试数据，保证 $1\\leq n\\leq 2.5\\times 10^4$，$1\\leq k\\leq 25$，$a\\leq n$。\n\n| 测试点编号 | $n$ | $k$ |\n| :--: | :--: | :--: |\n| $1\\sim 2$ | $2.5\\times 10^4$ | $1$ |\n| $3$ | $2.5\\times 10^4$ | $2$ |\n| $4\\sim 5$ | $1000$ | $10$ |\n| $6\\sim 10$ | $2.5\\times 10^4$ | $25$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Task Assignment Problem", "background": "What does it feel like to kick off the power cable while mining?", "description": "On a computer with $k$ CPUs, there are $n$ computing tasks waiting to be executed.\n\nLet $a_i$ be the priority of the $i$-th task. For convenience, $a$ is a permutation.\n\nNow, these tasks need to be assigned to the CPUs to be processed.\n\nDue to reasons such as memory limits, one CPU can only handle one continuous segment of tasks, and it must execute them in order (from left to right).\n\n**Within a single CPU**, the disorder is defined as the number of pairs of tasks where the former is executed earlier, but the latter has a higher priority.\n\nMinimize the sum of disorders over all CPUs.", "inputFormat": "The first line contains two integers $n, k$, representing the number of tasks and the number of CPUs.\n\nThe second line contains $n$ integers, representing $a_{1\\sim n}$.", "outputFormat": "Output one integer, representing the minimum possible sum of disorders.", "hint": "### Sample Explanation\n\n- **Sample #1**\n\n  In this case, all tasks can only be assigned to a single CPU.\n\n  The first task forms disorder pairs with all other tasks; the last two tasks also form a disorder pair, for a total of $5$.\n\n- **Sample #2**\n\n  The first CPU processes task $1$ alone, with disorder $0$.\n\n  The second CPU processes $\\{5,4,2,3\\}$, with disorder $1$.\n\n### Constraints and Notes\n\nFor all testdata, it is guaranteed that $1\\leq n\\leq 2.5\\times 10^4$, $1\\leq k\\leq 25$, $a\\leq n$.\n\n| Test Point ID | $n$ | $k$ |\n| :--: | :--: | :--: |\n| $1\\sim 2$ | $2.5\\times 10^4$ | $1$ |\n| $3$ | $2.5\\times 10^4$ | $2$ |\n| $4\\sim 5$ | $1000$ | $10$ |\n| $6\\sim 10$ | $2.5\\times 10^4$ | $25$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 任务分配问题", "background": "挖矿的时候踢断电源线是一种怎样的体验?", "description": "在某台有 $k$ 个 CPU 的计算机中，有 $n$ 个计算任务等待执行。\n\n$a_i$ 为第 $i$ 个任务的优先级，方便起见， $a$ 为一个排列。\n\n现在，要将这些任务分配给 CPU 去解决。\n\n由于内存等原因，一个 CPU 只能负责连续一段的任务，并且要按 (从左到右的) 顺序执行。\n\n**在某个 CPU 内**，无序度定义为：前者先执行，而后者优先级高的任务对的个数。\n\n请最小化每个 CPU 的无序度之和。", "inputFormat": "第一行两个整数 $n,k$ ，分别表示任务个数和 CPU 个数。\n\n第二行 $n$ 个整数，表示 $a_{1\\sim n}$ 。", "outputFormat": "输出一个整数，表示最小的无序度之和。", "hint": "### 样例说明\n\n- **样例 #1**\n\n  此时只能把所有任务交给单独的一个 CPU。\n\n  第一个任务和其他所有任务都形成无序任务对；最后两个任务也形成无序任务对，共 $5$ 个。\n\n- **样例 #2**\n\n  第一个 CPU 单独处理任务 $1$ ，无序度为 $0$；\n  \n  第二个 CPU 处理 $\\{5,4,2,3\\}$ 无序度为 $1$。\n  \n### 限制与约定\n\n对于所有测试数据，保证 $1\\leq n\\leq 2.5\\times 10^4$，$1\\leq k\\leq 25$，$a\\leq n$。\n\n| 测试点编号 | $n$ | $k$ |\n| :--: | :--: | :--: |\n| $1\\sim 2$ | $2.5\\times 10^4$ | $1$ |\n| $3$ | $2.5\\times 10^4$ | $2$ |\n| $4\\sim 5$ | $1000$ | $10$ |\n| $6\\sim 10$ | $2.5\\times 10^4$ | $25$ |", "locale": "zh-CN"}}}
{"pid": "P5575", "type": "P", "difficulty": 7, "samples": [["5 4 3\n50 50 50 50 50\n1 2\n2 3\n2 4\n2 5", "19"], ["6 5 2\n20 30 40 50 60 70\n1 2\n2 3\n2 4\n2 5\n4 6", "397301258"], ["10 10 2\n39 76 71 86 36 38 36 44 63 37 \n4 5\n2 10\n6 10\n1 8\n5 10\n8 10\n7 10\n3 10\n10 9\n5 3", "361859252"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "期望"], "title": "[CmdOI2019] 黑白图", "background": "你看见了一张奇怪的图。", "description": "有一张 $n$ 个点，$m$ 条边的简单无向连通图，点可以染上黑色或者白色。\n\n这个图比较稀疏，具体来讲有两种情况。\n\n- $m=n-1$ ，此时是一棵树。\n\n- $m=n$ ，此时是一颗基环树。\n\n我们定义一张黑白图的权值为：其黑色**连通块大小**的 $k$ 次方和。\n\n现在图的形态已经确定，但是每个点上的颜色尚未确定，对于第 $i$ 个点。其有**百分之** $p_i$ 的可能是黑色，反之则是白色。\n\n求图的期望权值对 $998244353$ 取模的结果。", "inputFormat": "第一行包括三个正整数 $n,m,k$ ，意义如题面所述。\n\n接下来一行 $n$ 个数依次表示 $p_{1\\sim n}$。\n\n后 $m$ 行，每行两个数 $f,t$ ，表示图的一条无向边 $f\\leftrightarrow t$ 。", "outputFormat": "输出一个整数，表示图的期望权值对 $998244353$ 取模的结果。", "hint": "| 数据点编号 | $n$ | 　$m$　 | 　$k$　 | 性质1 | 性质2 | 分数 |\n| :--: | :--: | :--: | :--: | :--: | :--: | :--: |\n| 1 | $16$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 2 | $50$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 3 | $50$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 4 | $500$ | $n-1$ | $1$ | - | - | $5$ |\n| 5 | $2\\times 10^5$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 6 | $2\\times 10^5$ | $n-1$ | $2$ | - | $\\sqrt{}$ | $5$ |\n| 7 | $2\\times 10^5$ | $n-1$ | $4$ | - | - | $10$ |\n| 8 | $16$ | $n$ | $3$ | - | - | $10$ |\n| 9 | $500$ | $n$ | $3$ | - | - | $10$ |\n| 10 | $50000$ | $n$ | $2$ | - | - | $10$ |\n| 11 | $2\\times 10^5$ | $n$ | $4$ | $\\sqrt{}$ | - | $10$ |\n| 12 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n| 13 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n\n特殊性质 $1$ ：$p_i=50$。\n\n特殊性质 $2$ ：图退化成一条链，其中 $i$ 向 $i+1$ 连边。", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Black and White Graph", "background": "You saw a strange graph.", "description": "There is a simple undirected connected graph with $n$ vertices and $m$ edges. Each vertex can be colored black or white.\n\nThis graph is relatively sparse. Specifically, there are two cases.\n\n- $m=n-1$, in which case it is a tree.\n\n- $m=n$, in which case it is a unicyclic graph (a tree with one extra edge).\n\nWe define the value of a black-and-white graph as follows: the sum of the $k$-th powers of the sizes of its black connected components.\n\nNow the shape of the graph is fixed, but the color of each vertex is not fixed. For the $i$-th vertex, it has a probability of **$p_i$ percent** to be black; otherwise it is white.\n\nCompute the expected value of the graph, modulo $998244353$.", "inputFormat": "The first line contains three positive integers $n,m,k$, with meanings as described above.\n\nThe next line contains $n$ numbers, which are $p_{1\\sim n}$ in order.\n\nThe next $m$ lines each contain two numbers $f,t$, indicating an undirected edge $f\\leftrightarrow t$ in the graph.", "outputFormat": "Output one integer, the expected value of the graph modulo $998244353$.", "hint": "| Test Point ID | $n$ | 　$m$　 | 　$k$　 | Property 1 | Property 2 | Score |\n| :--: | :--: | :--: | :--: | :--: | :--: | :--: |\n| 1 | $16$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 2 | $50$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 3 | $50$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 4 | $500$ | $n-1$ | $1$ | - | - | $5$ |\n| 5 | $2\\times 10^5$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 6 | $2\\times 10^5$ | $n-1$ | $2$ | - | $\\sqrt{}$ | $5$ |\n| 7 | $2\\times 10^5$ | $n-1$ | $4$ | - | - | $10$ |\n| 8 | $16$ | $n$ | $3$ | - | - | $10$ |\n| 9 | $500$ | $n$ | $3$ | - | - | $10$ |\n| 10 | $50000$ | $n$ | $2$ | - | - | $10$ |\n| 11 | $2\\times 10^5$ | $n$ | $4$ | $\\sqrt{}$ | - | $10$ |\n| 12 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n| 13 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n\nSpecial Property $1$: $p_i=50$.\n\nSpecial Property $2$: The graph degenerates into a single chain, where there is an edge between $i$ and $i+1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 黑白图", "background": "你看见了一张奇怪的图。", "description": "有一张 $n$ 个点，$m$ 条边的简单无向连通图，点可以染上黑色或者白色。\n\n这个图比较稀疏，具体来讲有两种情况。\n\n- $m=n-1$ ，此时是一棵树。\n\n- $m=n$ ，此时是一颗基环树。\n\n我们定义一张黑白图的权值为：其黑色**连通块大小**的 $k$ 次方和。\n\n现在图的形态已经确定，但是每个点上的颜色尚未确定，对于第 $i$ 个点。其有**百分之** $p_i$ 的可能是黑色，反之则是白色。\n\n求图的期望权值对 $998244353$ 取模的结果。", "inputFormat": "第一行包括三个正整数 $n,m,k$ ，意义如题面所述。\n\n接下来一行 $n$ 个数依次表示 $p_{1\\sim n}$。\n\n后 $m$ 行，每行两个数 $f,t$ ，表示图的一条无向边 $f\\leftrightarrow t$ 。", "outputFormat": "输出一个整数，表示图的期望权值对 $998244353$ 取模的结果。", "hint": "| 数据点编号 | $n$ | 　$m$　 | 　$k$　 | 性质1 | 性质2 | 分数 |\n| :--: | :--: | :--: | :--: | :--: | :--: | :--: |\n| 1 | $16$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 2 | $50$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 3 | $50$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 4 | $500$ | $n-1$ | $1$ | - | - | $5$ |\n| 5 | $2\\times 10^5$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 6 | $2\\times 10^5$ | $n-1$ | $2$ | - | $\\sqrt{}$ | $5$ |\n| 7 | $2\\times 10^5$ | $n-1$ | $4$ | - | - | $10$ |\n| 8 | $16$ | $n$ | $3$ | - | - | $10$ |\n| 9 | $500$ | $n$ | $3$ | - | - | $10$ |\n| 10 | $50000$ | $n$ | $2$ | - | - | $10$ |\n| 11 | $2\\times 10^5$ | $n$ | $4$ | $\\sqrt{}$ | - | $10$ |\n| 12 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n| 13 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n\n特殊性质 $1$ ：$p_i=50$。\n\n特殊性质 $2$ ：图退化成一条链，其中 $i$ 向 $i+1$ 连边。", "locale": "zh-CN"}}}
{"pid": "P5576", "type": "P", "difficulty": 7, "samples": [["3 3\n10111\n1111010111\n010111111101\n1 3\n1 2\n2 3", "5\n5\n6"], ["10 10\n00\n010\n1000000001\n1000000110000001\n00010100110101001011000110100001\n10111001001010100100000011011\n101110010010101001000000101011\n1011100100101010010010000111011\n1011100100101010011010000101011\n0001101001101011\n1 4\n6 10\n5 6\n4 6\n9 10\n7 10\n2 10\n1 5\n1 8\n4 7", "1\n6\n9\n6\n10\n6\n2\n1\n1\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["后缀自动机 SAM", "分治", "后缀数组 SA", "整体二分", "根号分治", "线段树合并", "启发式合并"], "title": "[CmdOI2019] 口头禅", "background": "**温馨提示** : 请注意本题特殊的时空限制。\n\n（若您认为使用了复杂度正确的算法但被卡常，可以联系出题人）\n\n一个悠闲的午后，机房里的大佬们都在水群。", "description": "蒟蒻出题人收集了某位大佬的 $n$ 条语录，并按时间为序编号为 $1...n$ 。\n\n他发现这位大佬的口头禅是随着时间而变化的，而且里面有些看不懂的内容。\n\n在请教了群 DS 带师之后，他得到了某种 hash 方法，把这些语录都变成了 01 串，这样似乎好懂一些。\n\n为了研究水群的奥秘，他进行了多次询问 : $[l,r]$ **之间的所有语录，最长公共子串的长度是多少**?\n\n出题人知道这并不是一个简单的问题，所以他并不急于即时得知每个询问的答案。", "inputFormat": "第一行两个整数 $n,m$ ，表示语录的条数和询问个数。\n\n对于后 $n$ 行，第 $i$ 行表示第 $i$ 条语录，保证字符集为 $\\{0,1\\}$。\n\n后 $m$ 行，每行两个整数 $l,r(1\\leq l<r \\leq n)$ ，表示一个询问。", "outputFormat": "对于每个询问，输出 $[l,r]$ 之间的所有语录最长公共子串的长度。", "hint": "| subtask编号 | 　$\\bf n$　 | 　$\\bf m$　 | 语录总长 | 分值 |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | $50$ | $50$ | $500$ | $10$ |\n| 2 | $50$ | $50$ | $8\\times 10^4$ | $15$ |\n| 3 | $2000$ | $10^4$ | $1.6\\times 10^5$ | $15$ |\n| 4 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $15$ |\n| 5 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $45$ |\n\n对于subtask**4** : 语录生成后，**之间**的顺序经过随机打乱。\n\n对于subtask**5** : 空间限制为$\\texttt{128Mb}$，其他的数据为$\\texttt{500Mb}$。", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Catchphrase", "background": "**Friendly reminder**: Please note the special time and memory limits of this problem.\n\n(If you believe you used an algorithm with the correct complexity but it fails due to constant factors, you can contact the problem setter.)\n\nOn a leisurely afternoon, the experts in the computer room are all chatting in groups.", "description": "The newbie problem setter collected $n$ quotes from a certain expert, and numbered them by time as $1...n$.\n\nHe found that this expert’s catchphrase changes over time, and there is also some content that is hard to understand.\n\nAfter asking the group “DS” master (can also be left as “DS” in pinyin), he got a certain hash method that turns these quotes into binary strings, which seems easier to understand.\n\nTo study the secrets of group chatting, he asked many queries: **among all quotes between** $[l,r]$, **what is the length of the longest common substring**?\n\nThe problem setter knows this is not an easy problem, so he is not in a hurry to get the answer to each query immediately.", "inputFormat": "The first line contains two integers $n,m$, representing the number of quotes and the number of queries.\n\nIn the next $n$ lines, the $i$-th line describes the $i$-th quote. The alphabet is guaranteed to be $\\{0,1\\}$.\n\nIn the following $m$ lines, each line contains two integers $l,r(1\\leq l<r \\leq n)$, representing a query.", "outputFormat": "For each query, output the length of the longest common substring among all quotes between $[l,r]$.", "hint": "| Subtask ID | $\\bf n$ | $\\bf m$ | Total quote length | Score |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | $50$ | $50$ | $500$ | $10$ |\n| 2 | $50$ | $50$ | $8\\times 10^4$ | $15$ |\n| 3 | $2000$ | $10^4$ | $1.6\\times 10^5$ | $15$ |\n| 4 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $15$ |\n| 5 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $45$ |\n\nFor subtask **4**: after the quotes are generated, the order **between them** is randomly shuffled.\n\nFor subtask **5**: the memory limit is $\\texttt{128Mb}$, and for the other testdata it is $\\texttt{500Mb}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 口头禅", "background": "**温馨提示** : 请注意本题特殊的时空限制。\n\n（若您认为使用了复杂度正确的算法但被卡常，可以联系出题人）\n\n一个悠闲的午后，机房里的大佬们都在水群。", "description": "蒟蒻出题人收集了某位大佬的 $n$ 条语录，并按时间为序编号为 $1...n$ 。\n\n他发现这位大佬的口头禅是随着时间而变化的，而且里面有些看不懂的内容。\n\n在请教了群 DS 带师之后，他得到了某种 hash 方法，把这些语录都变成了 01 串，这样似乎好懂一些。\n\n为了研究水群的奥秘，他进行了多次询问 : $[l,r]$ **之间的所有语录，最长公共子串的长度是多少**?\n\n出题人知道这并不是一个简单的问题，所以他并不急于即时得知每个询问的答案。", "inputFormat": "第一行两个整数 $n,m$ ，表示语录的条数和询问个数。\n\n对于后 $n$ 行，第 $i$ 行表示第 $i$ 条语录，保证字符集为 $\\{0,1\\}$。\n\n后 $m$ 行，每行两个整数 $l,r(1\\leq l<r \\leq n)$ ，表示一个询问。", "outputFormat": "对于每个询问，输出 $[l,r]$ 之间的所有语录最长公共子串的长度。", "hint": "| subtask编号 | 　$\\bf n$　 | 　$\\bf m$　 | 语录总长 | 分值 |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | $50$ | $50$ | $500$ | $10$ |\n| 2 | $50$ | $50$ | $8\\times 10^4$ | $15$ |\n| 3 | $2000$ | $10^4$ | $1.6\\times 10^5$ | $15$ |\n| 4 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $15$ |\n| 5 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $45$ |\n\n对于subtask**4** : 语录生成后，**之间**的顺序经过随机打乱。\n\n对于subtask**5** : 空间限制为$\\texttt{128Mb}$，其他的数据为$\\texttt{500Mb}$。", "locale": "zh-CN"}}}
{"pid": "P5577", "type": "P", "difficulty": 7, "samples": [["3 5 1\n1 2 3", "2\n2\n1\n2\n1"], ["5 6 1\n1 1 4 5 1 4", "8\n7\n4\n2\n4\n7"]], "limits": {"time": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["快速沃尔什变换 FWT"], "title": "[CmdOI2019] 算力训练", "background": "最近，出题人快乐地学习了如何解一元二次方程。\n\n晚上在宿舍里，出题人梦见了一个使用 $k$ 进制的国度，入乡随俗嘛，出题人在这里也使用 $k$ 进制。\n\n当然，这个国度里面的人也懂数学，所以解不出一元二次方程的出题人并没有逃掉算力训练。", "description": "出题人在纸条上写了 $n$ 个 $k$ 进制自然数，由于他很懒，这些数的位数不会太多，都不会超过 $m$ 位。\n\n为了训练算力，他每次会**随意取出一个子序列** (允许一个数都不选) ，然后把这些数都加起来。\n\n他又觉得进位太麻烦了，干脆规定**加法不进位**。\n\n算了几次之后，他突然很想知道自己得到每个数的方案数是多少，可是他太菜了，又不会算。冥思苦想一番之后,突然被起床铃拉出了梦境。\n\n他觉得这个问题很有趣，只好求助于单手虐暴无数代数题的你，来帮忙计算一下。\n\n**形式化题意** ： 对于一个序列 $A$ ，定义其权值 $W(A)$ 为 $A$ 中元素做 $k$ 进制不进位加法的和。\n\n给出 $m,k$ 和一个长为 $n$ 的序列 $S$。保证 $S\\subseteq [0,k^m)∩Z$。\n\n对于 $t=0,1,2,...,k^m-1$ ，分别求出下列式子的值 ：\n\n$${\\rm Ans}[t]=\\sum\\limits_{\\text{R 是 S 的子序列}}\\big[W(R)=t\\big]$$\n\n注 ：根据正确的题意可推知 $\\sum\\limits_{t=0}^{k^m-1}{\\rm Ans}[t]=2^n$。", "inputFormat": "第一行三个整数 $n,k,m$ ，意义为题目中所述。\n\n第二行 $n$ 个整数，之间用空格隔开，表示纸条上的数字。\n\n(**注意**，纸条上的数均为 $k$ 进制数)", "outputFormat": "共 $k^m$ 行,你需要在第 $i$ 行输出得到数 $i-1$ 的方案数，答案对 $998244353$ 取模。", "hint": "### 样例解释\n\n对于样例#1，共有 $2^3=8$ 种选取子序列的方法：\n\n1. 什么都不选，和为 $0$\n2. 选 $1$ ，和为 $1$\n3. 选 $2$ ，和为 $2$\n4. 选 $3$ ，和为 $3$\n5. 选 $1+2$ ，和为 $3$\n6. 选 $1+3$ ，和为 $4$\n7. 选 $2+3$ ，和为 $0$ （由于是 $5$ 进制，本来要变成 $10$ 的，但是不进位就只剩下 $0$ 了）\n8. 选 $1+2+3$，和为 $1$\n\n综上，得到 `0,1,2,3,4` 的方案数分别是 `2,2,1,2,1` 。\n\n### 数据范围和约定\n\n| 测试点编号 | 　n　 | 　k　 | 　m　 | 总分数 |\n| :--: | :--: | :--: | :--: | :--: |\n| #1 | $20$ | $5$ | $4$ | $5$ |\n| #2 | $1000$ | $5$ | $4$ | $5$ |\n| #3~4 | $10^6$ | $5$ | $5$ | $10$ |\n| #5 | $10^6$ | $5$ | $6$ | $10$ |\n| #6~7 | $10^6$ | $5$ | $7$ | $20$ |\n| #8 | $20$ | $6$ | $4$ | $5$ |\n| #9 | $1000$ | $6$ | $4$ | $5$ |\n| #10~11 | $10^6$ | $6$ | $4$ | $10$ |\n| #12~14 | $10^6$ | $6$ | $6$ | $30$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Computing Power Training", "background": "Recently, the problem setter happily learned how to solve a quadratic equation in one variable.\n\nAt night in the dorm, the problem setter dreamed of a country that uses base $k$. When in Rome, do as the Romans do, so the problem setter also used base $k$ there.\n\nOf course, people in that country also know mathematics, so the problem setter, who still could not solve a quadratic equation in one variable, did not escape computing power training.", "description": "The problem setter wrote down $n$ base-$k$ natural numbers on a slip of paper. Because he is lazy, these numbers will not have too many digits, and none of them exceeds $m$ digits.\n\nTo train computing power, each time he will **randomly pick a subsequence** (it is allowed to pick none), and then add all the chosen numbers together.\n\nHe also felt carrying was too troublesome, so he simply规定 that **addition is done without carry**.\n\nAfter computing a few times, he suddenly wanted to know how many ways he can obtain each number, but he is too weak and cannot compute it. After thinking hard, he was suddenly pulled out of the dream by the wake-up bell.\n\nHe found this problem interesting, so he had to ask you, who can crush countless algebra problems with one hand, to help compute it.\n\n**Formal statement**: For a sequence $A$, define its weight $W(A)$ as the sum of the elements in $A$ using base-$k$ addition without carry.\n\nGiven $m$, $k$, and a sequence $S$ of length $n$. It is guaranteed that $S\\subseteq [0,k^m)∩Z$.\n\nFor $t=0,1,2,...,k^m-1$, compute the value of:\n\n$${\\rm Ans}[t]=\\sum\\limits_{\\text{R is a subsequence of S}}\\big[W(R)=t\\big]$$\n\nNote: From the correct statement, we can infer that $\\sum\\limits_{t=0}^{k^m-1}{\\rm Ans}[t]=2^n$.", "inputFormat": "The first line contains three integers $n,k,m$, with the meaning described in the statement.\n\nThe second line contains $n$ integers separated by spaces, representing the numbers on the slip of paper.\n\n(**Note**: the numbers on the slip of paper are all base-$k$ numbers.)", "outputFormat": "There are $k^m$ lines. On the $i$-th line, output the number of ways to obtain the number $i-1$. Output the answer modulo $998244353$.", "hint": "### Sample Explanation\n\nFor Sample #1, there are $2^3=8$ ways to choose a subsequence:\n\n1. Choose nothing, the sum is $0$.\n2. Choose $1$, the sum is $1$.\n3. Choose $2$, the sum is $2$.\n4. Choose $3$, the sum is $3$.\n5. Choose $1+2$, the sum is $3$.\n6. Choose $1+3$, the sum is $4$.\n7. Choose $2+3$, the sum is $0$ (since it is base $5$, it should become $10$, but without carry it becomes only $0$).\n8. Choose $1+2+3$, the sum is $1$.\n\nIn summary, the numbers of ways to obtain `0,1,2,3,4` are `2,2,1,2,1`, respectively.\n\n### Constraints and Conventions\n\n| Test Point ID | 　n　 | 　k　 | 　m　 | Total Score |\n| :--: | :--: | :--: | :--: | :--: |\n| #1 | $20$ | $5$ | $4$ | $5$ |\n| #2 | $1000$ | $5$ | $4$ | $5$ |\n| #3~4 | $10^6$ | $5$ | $5$ | $10$ |\n| #5 | $10^6$ | $5$ | $6$ | $10$ |\n| #6~7 | $10^6$ | $5$ | $7$ | $20$ |\n| #8 | $20$ | $6$ | $4$ | $5$ |\n| #9 | $1000$ | $6$ | $4$ | $5$ |\n| #10~11 | $10^6$ | $6$ | $4$ | $10$ |\n| #12~14 | $10^6$ | $6$ | $6$ | $30$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 算力训练", "background": "最近，出题人快乐地学习了如何解一元二次方程。\n\n晚上在宿舍里，出题人梦见了一个使用 $k$ 进制的国度，入乡随俗嘛，出题人在这里也使用 $k$ 进制。\n\n当然，这个国度里面的人也懂数学，所以解不出一元二次方程的出题人并没有逃掉算力训练。", "description": "出题人在纸条上写了 $n$ 个 $k$ 进制自然数，由于他很懒，这些数的位数不会太多，都不会超过 $m$ 位。\n\n为了训练算力，他每次会**随意取出一个子序列** (允许一个数都不选) ，然后把这些数都加起来。\n\n他又觉得进位太麻烦了，干脆规定**加法不进位**。\n\n算了几次之后，他突然很想知道自己得到每个数的方案数是多少，可是他太菜了，又不会算。冥思苦想一番之后,突然被起床铃拉出了梦境。\n\n他觉得这个问题很有趣，只好求助于单手虐暴无数代数题的你，来帮忙计算一下。\n\n**形式化题意** ： 对于一个序列 $A$ ，定义其权值 $W(A)$ 为 $A$ 中元素做 $k$ 进制不进位加法的和。\n\n给出 $m,k$ 和一个长为 $n$ 的序列 $S$。保证 $S\\subseteq [0,k^m)∩Z$。\n\n对于 $t=0,1,2,...,k^m-1$ ，分别求出下列式子的值 ：\n\n$${\\rm Ans}[t]=\\sum\\limits_{\\text{R 是 S 的子序列}}\\big[W(R)=t\\big]$$\n\n注 ：根据正确的题意可推知 $\\sum\\limits_{t=0}^{k^m-1}{\\rm Ans}[t]=2^n$。", "inputFormat": "第一行三个整数 $n,k,m$ ，意义为题目中所述。\n\n第二行 $n$ 个整数，之间用空格隔开，表示纸条上的数字。\n\n(**注意**，纸条上的数均为 $k$ 进制数)", "outputFormat": "共 $k^m$ 行,你需要在第 $i$ 行输出得到数 $i-1$ 的方案数，答案对 $998244353$ 取模。", "hint": "### 样例解释\n\n对于样例#1，共有 $2^3=8$ 种选取子序列的方法：\n\n1. 什么都不选，和为 $0$\n2. 选 $1$ ，和为 $1$\n3. 选 $2$ ，和为 $2$\n4. 选 $3$ ，和为 $3$\n5. 选 $1+2$ ，和为 $3$\n6. 选 $1+3$ ，和为 $4$\n7. 选 $2+3$ ，和为 $0$ （由于是 $5$ 进制，本来要变成 $10$ 的，但是不进位就只剩下 $0$ 了）\n8. 选 $1+2+3$，和为 $1$\n\n综上，得到 `0,1,2,3,4` 的方案数分别是 `2,2,1,2,1` 。\n\n### 数据范围和约定\n\n| 测试点编号 | 　n　 | 　k　 | 　m　 | 总分数 |\n| :--: | :--: | :--: | :--: | :--: |\n| #1 | $20$ | $5$ | $4$ | $5$ |\n| #2 | $1000$ | $5$ | $4$ | $5$ |\n| #3~4 | $10^6$ | $5$ | $5$ | $10$ |\n| #5 | $10^6$ | $5$ | $6$ | $10$ |\n| #6~7 | $10^6$ | $5$ | $7$ | $20$ |\n| #8 | $20$ | $6$ | $4$ | $5$ |\n| #9 | $1000$ | $6$ | $4$ | $5$ |\n| #10~11 | $10^6$ | $6$ | $4$ | $10$ |\n| #12~14 | $10^6$ | $6$ | $6$ | $30$ |", "locale": "zh-CN"}}}
{"pid": "P5578", "type": "P", "difficulty": 4, "samples": [["3 2 1\n2 3 4\n1 2\n3 2\n2 3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "PA（波兰）"], "title": "[PA 2014] Fiolki", "background": "", "description": "化学家吉丽想要配置一种神奇的药水来拯救世界。\n\n吉丽有 $n$ 种不同的液体物质，和 $n$ 个药瓶（均从 $1$ 到 $n$ 编号）。初始时，第 $i$ 个瓶内装着 $g_i$ 克的第 $i$ 种物质。\n\n吉丽需要执行一定的步骤来配置药水，第 $i$ 个步骤是将第 $a_i$ 个瓶子内的所有液体倒入第 $b_i$ 个瓶子，此后第 $a_i$ 个瓶子不会再被用到。瓶子的容量可以视作是无限的。\n\n吉丽知道某几对液体物质在一起时会发生反应产生沉淀，具体反应是 $1$ 克 $c_i$ 物质和 $1$ 克 $d_i$ 物质生成 $2$ 克沉淀，一直进行直到某一反应物耗尽。生成的沉淀不会和任何物质反应。\n\n当有多于一对可以发生反应的物质在一起时，吉丽知道它们的反应顺序。每次倾倒完后，吉丽会等到反应结束后再执行下一步骤。\n\n吉丽想知道配置过程中总共产生多少沉淀。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示药瓶的个数（即物质的种数），操作步数，可以发生的反应数量。\n\n第二行有 $n$ 个整数 $g_1,g_2,…,g_n$，表示初始时每个瓶内物质的质量。\n\n接下来 $m$ 行，每行两个整数 $a_i,b_i$，表示第 $i$ 个步骤。保证 $a_i$ 在以后的步骤中不再出现。\n\n接下来 $k$ 行，每行是一对可以发生反应的物质 $c_i,d_i$，按照反应的优先顺序给出。同一个反应不会重复出现。", "outputFormat": "输出总共产生的沉淀质量。", "hint": "对于 $100\\%$ 的数据，$0\\le m<n\\le 2\\times 10^5$，$0\\le k\\le 5\\times 10^5$，$1\\le g_i\\le 10^9$，$1\\le a_i,b_i,c_i,d_i\\le n$，$a_i\\ne b_i$，$c_i\\ne d_i$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2014] Fiolki", "background": "", "description": "化学家吉丽想要配置一种神奇的药水来拯救世界。\n\n吉丽有 $n$ 种不同的液体物质，和 $n$ 个药瓶（均从 $1$ 到 $n$ 编号）。初始时，第 $i$ 个瓶内装着 $g_i$ 克的第 $i$ 种物质。\n\n吉丽需要执行一定的步骤来配置药水，第 $i$ 个步骤是将第 $a_i$ 个瓶子内的所有液体倒入第 $b_i$ 个瓶子，此后第 $a_i$ 个瓶子不会再被用到。瓶子的容量可以视作是无限的。\n\n吉丽知道某几对液体物质在一起时会发生反应产生沉淀，具体反应是 $1$ 克 $c_i$ 物质和 $1$ 克 $d_i$ 物质生成 $2$ 克沉淀，一直进行直到某一反应物耗尽。生成的沉淀不会和任何物质反应。\n\n当有多于一对可以发生反应的物质在一起时，吉丽知道它们的反应顺序。每次倾倒完后，吉丽会等到反应结束后再执行下一步骤。\n\n吉丽想知道配置过程中总共产生多少沉淀。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示药瓶的个数（即物质的种数），操作步数，可以发生的反应数量。\n\n第二行有 $n$ 个整数 $g_1,g_2,…,g_n$，表示初始时每个瓶内物质的质量。\n\n接下来 $m$ 行，每行两个整数 $a_i,b_i$，表示第 $i$ 个步骤。保证 $a_i$ 在以后的步骤中不再出现。\n\n接下来 $k$ 行，每行是一对可以发生反应的物质 $c_i,d_i$，按照反应的优先顺序给出。同一个反应不会重复出现。", "outputFormat": "输出总共产生的沉淀质量。", "hint": "对于 $100\\%$ 的数据，$0\\le m<n\\le 2\\times 10^5$，$0\\le k\\le 5\\times 10^5$，$1\\le g_i\\le 10^9$，$1\\le a_i,b_i,c_i,d_i\\le n$，$a_i\\ne b_i$，$c_i\\ne d_i$。", "locale": "zh-CN"}}}
{"pid": "P5579", "type": "P", "difficulty": 5, "samples": [["4 4\n1 2 4 3\n1 1\n2 2\n3 0\n4 4", "6\n6\n18\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "PA（波兰）"], "title": "[PA 2015] Siano", "background": "", "description": "农夫 Byteasar 买了一片 $n$ 亩的土地，他要在这上面种草。\n\n他在每一亩土地上都种植了一种独一无二的草，其中，第 $i$ 亩土地的草每天会长高 $a_i$ 厘米。\n\nByteasar 一共会进行 $m$ 次收割，其中第 $i$ 次收割在第 $d_i$ 天，并把所有高度大于等于 $b_i$ 的部分全部割去。\n\nByteasar 想知道，每次收割得到的草的高度总和是多少，你能帮帮他吗？", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示亩数和收割次数。\n\n第二行包含 $n$ 个正整数，其中第 $i$ 个数为 $a_i$，依次表示每亩种植的草的生长能力。\n\n接下来 $m$ 行，每行包含两个整数 $d_i,b_i$，依次描述每次收割。\n\n", "outputFormat": "输出 $m$ 行，每行一个整数，依次回答每次收割能得到的草的高度总和。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 5\\times 10^5$，$1\\le a_i\\le 10^6$，$1\\le d_i\\le 10^{12}$，$0\\le b_i\\le 10^{12}$。\n\n数据保证 $d_1<d_2<...<d_m$，并且任何时刻没有任何一亩草的高度超过 $10^{12}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] Siano", "background": "", "description": "农夫 Byteasar 买了一片 $n$ 亩的土地，他要在这上面种草。\n\n他在每一亩土地上都种植了一种独一无二的草，其中，第 $i$ 亩土地的草每天会长高 $a_i$ 厘米。\n\nByteasar 一共会进行 $m$ 次收割，其中第 $i$ 次收割在第 $d_i$ 天，并把所有高度大于等于 $b_i$ 的部分全部割去。\n\nByteasar 想知道，每次收割得到的草的高度总和是多少，你能帮帮他吗？", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示亩数和收割次数。\n\n第二行包含 $n$ 个正整数，其中第 $i$ 个数为 $a_i$，依次表示每亩种植的草的生长能力。\n\n接下来 $m$ 行，每行包含两个整数 $d_i,b_i$，依次描述每次收割。\n\n", "outputFormat": "输出 $m$ 行，每行一个整数，依次回答每次收割能得到的草的高度总和。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 5\\times 10^5$，$1\\le a_i\\le 10^6$，$1\\le d_i\\le 10^{12}$，$0\\le b_i\\le 10^{12}$。\n\n数据保证 $d_1<d_2<...<d_m$，并且任何时刻没有任何一亩草的高度超过 $10^{12}$。", "locale": "zh-CN"}}}
{"pid": "P5580", "type": "P", "difficulty": 5, "samples": [["025", "1525"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2015", "Special Judge", "PA（波兰）"], "title": "[PA 2015] Fibonacci", "background": "更新：输出任意满足条件的 $k$ 即可，感谢 @[Karry5307](https://www.luogu.com.cn/user/60990) 的修正和 spj。", "description": "众所周知，斐波那契数列 $F$ 满足：\n$$F_0=0,F_1=1,F_m=F_{m-1}+F_{m-2}(2\\le m)$$\n现在给出一个数字串 $S$，请找到一个**最小**的 $k$ 使得 $F_k$ 以 $S$ 为结尾。", "inputFormat": "包含一行一个数字串 $S$。", "outputFormat": "输出满足条件的最小数字 $k$。\n\n若无解，输出 `NIE`。\n\n", "hint": "对于 $100\\%$ 的数据，$S$ 的长度不超过 $18$，$0\\le k<10^{100}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] Fibonacci", "background": "更新：输出任意满足条件的 $k$ 即可，感谢 @[Karry5307](https://www.luogu.com.cn/user/60990) 的修正和 spj。", "description": "众所周知，斐波那契数列 $F$ 满足：\n$$F_0=0,F_1=1,F_m=F_{m-1}+F_{m-2}(2\\le m)$$\n现在给出一个数字串 $S$，请找到一个**最小**的 $k$ 使得 $F_k$ 以 $S$ 为结尾。", "inputFormat": "包含一行一个数字串 $S$。", "outputFormat": "输出满足条件的最小数字 $k$。\n\n若无解，输出 `NIE`。\n\n", "hint": "对于 $100\\%$ 的数据，$S$ 的长度不超过 $18$，$0\\le k<10^{100}$。", "locale": "zh-CN"}}}
{"pid": "P5581", "type": "P", "difficulty": 5, "samples": [["4\n2 3 2 1\n3\nWPP", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "PA（波兰）"], "title": "[PA 2015] Hazard", "background": "~~赌博有害健康请不要模仿。~~", "description": "有 $n$ 个人在轮流玩赌博机，一开始编号为 $i$ 的人有 $a_i$ 元钱。赌博机可以抽象为一个长度为 $m$ 的仅包含 $1$ 和 $-1$ 的序列，若抽到 $1$，那么你将得到 $1$ 块钱；若抽到 $-1$，你将输掉 $1$ 块钱。\n\n第 $1$ 局，第 $1$ 个人会抽到序列中的第 $1$ 项；第 $2$ 局，第 $2$ 个人会抽到序列中的第 $2$ 项；第 $3$ 局，第 $3$ 个人会抽到序列中的第 $3$ 项......即：第 $i$ 个人抽完后轮到第 $i+1$ 个人去抽，特别地，第 $n$ 个人抽完后轮到第 $1$ 个人去抽。序列第 $i$ 项被抽到之后，下一个被抽到的将会是第 $i+1$ 项，特别地，序列第 $m$ 项被抽到之后，下一个被抽到的将会是第 $1$ 项。\n\n如果在某一轮，有个人输光了所有的钱，那么这场赌博游戏就会结束，请求出游戏在哪一轮结束，或者判断这个游戏会永远进行下去。", "inputFormat": "第一行包含一个正整数 $n$，表示玩家的个数。\n\n第二行包含 $n$ 个正整数 $a_1,a_2,...,a_n$，依次表示每个玩家一开始持有的钱数。\n\n第一行包含一个正整数 $m$，表示序列的长度。\n\n第四行包含一个长度为 $m$ 的仅包含 `W` 和 `P` 的字符串，表示这个序列，其中 `W` 表示 $1$，`P` 表示 $-1$。", "outputFormat": "若游戏会永远进行下去，输出 `-1`。否则输出游戏在哪一轮结束。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le a_i\\le 10^6$，$1\\le m\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] Hazard", "background": "~~赌博有害健康请不要模仿。~~", "description": "有 $n$ 个人在轮流玩赌博机，一开始编号为 $i$ 的人有 $a_i$ 元钱。赌博机可以抽象为一个长度为 $m$ 的仅包含 $1$ 和 $-1$ 的序列，若抽到 $1$，那么你将得到 $1$ 块钱；若抽到 $-1$，你将输掉 $1$ 块钱。\n\n第 $1$ 局，第 $1$ 个人会抽到序列中的第 $1$ 项；第 $2$ 局，第 $2$ 个人会抽到序列中的第 $2$ 项；第 $3$ 局，第 $3$ 个人会抽到序列中的第 $3$ 项......即：第 $i$ 个人抽完后轮到第 $i+1$ 个人去抽，特别地，第 $n$ 个人抽完后轮到第 $1$ 个人去抽。序列第 $i$ 项被抽到之后，下一个被抽到的将会是第 $i+1$ 项，特别地，序列第 $m$ 项被抽到之后，下一个被抽到的将会是第 $1$ 项。\n\n如果在某一轮，有个人输光了所有的钱，那么这场赌博游戏就会结束，请求出游戏在哪一轮结束，或者判断这个游戏会永远进行下去。", "inputFormat": "第一行包含一个正整数 $n$，表示玩家的个数。\n\n第二行包含 $n$ 个正整数 $a_1,a_2,...,a_n$，依次表示每个玩家一开始持有的钱数。\n\n第一行包含一个正整数 $m$，表示序列的长度。\n\n第四行包含一个长度为 $m$ 的仅包含 `W` 和 `P` 的字符串，表示这个序列，其中 `W` 表示 $1$，`P` 表示 $-1$。", "outputFormat": "若游戏会永远进行下去，输出 `-1`。否则输出游戏在哪一轮结束。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le a_i\\le 10^6$，$1\\le m\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5582", "type": "P", "difficulty": 3, "samples": [["3\n5 4\n1 2 3 4\n5 4\n1 2 4 5\n6 3\n1 3 5", "-1\n5\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [25600, 25600, 25600, 25600, 25600, 25600]}, "tags": ["2019"], "title": "「SWTR-1」Escape", "background": "有一天，当 $\\mathrm{Sunny}$ 闲逛的时候，发现了一个按钮。\n\n好奇心驱使他按下了这个按钮。\n\n突然间，天旋地转 $\\dots$", "description": "醒来之后，$\\mathrm{Sunny}$ 发现自己站在一个奇怪的地方。\n\n这个地方有 $n$ 个平台，**形成了一个环**。\n\n这时，$\\mathrm{Ethan}$ 的声音响起：\n\n“哈哈哈哈哈哈，恭喜你，你是第一个来到**死亡之地**的人。”\n\n“正如你所看到的，这个地方有 $n$ 个平台，你现在站在 $0$ 号平台上。”\n\n“剩余平台按顺时针编号 $1,2,3\\dots n-1$，也就是说，你身后的那个平台就是 $n-1$ 号平台。”\n\n“你每次能够**顺时针**跳 $i$ 个平台，$i\\in[1,n]$，每次的 $i$ 可以不一样。”\n\n“如果你能够经过所有平台（初始 $0$ 号位置不算），那你就能逃出**死亡之地**了。”\n\n（这里指的是一开始的 $0$ 号位置不算经过，需要再次经过 $0$ 号位置）\n\n“不过，这样太简单了，我会给你一些数 $a_j$，表示你**不能一次顺时针跳 $a_j$ 个平台**。”\n\n“还有，你必须要用**最少**的跳跃次数完成我的任务。”\n\n“如果你不能满足我的上面两个要求，所有平台就会消失，你将会掉入下面的岩浆之中。”\n\n现在，$\\mathrm{Sunny}$ 想知道他是否可能逃出这个地方。\n\n如果不行，输出```-1```，否则输出他最少所需的跳跃次数。\n\n因为 $\\mathrm{Sunny}$ 觉得死亡之地实在是太有趣了，所以他决定多玩几次，**多组数据**。", "inputFormat": "第一行，一个正整数 $T$，代表数据组数。\n\n接下来 $2\\times T$ 行，共 $T$ 组数据：\n\n第 $2\\times i-1$ 行，两个整数 $n,k$，$k$ 代表该组数据 $a_j$ 的个数。\n\n第 $2\\times i$ 行，$k$ 个数，第 $j$ 个数表示 $a_j$。", "outputFormat": "$T$ 行，第 $i$ 行表示第 $i$ 组数据的输出。", "hint": "---\n\n### 样例说明\n\n第一组数据：\n\n$\\mathrm{Sunny}$ 每次只能顺时针跳 $5$ 个平台，易知不可能完成。\n\n第二组数据：\n\n$\\mathrm{Sunny}$ 每次只能顺时针跳 $3$ 个平台，跳 $5$ 次即可。\n\n---\n\n### 数据范围与约定\n\n$0\\leq k\\leq n\\leq 10^6,1\\leq n$。\n\n保证 $\\sum{n_i}\\leq 3*10^6,a_j\\leq n$，且**互不相同**。\n\n测试点 $1:5\\%,n=1$。\n\n测试点 $2:5\\%,n\\leq5$。\n\n测试点 $3:10\\%,n\\leq15$。\n\n测试点 $4:15\\%,n\\leq300$。\n\n测试点 $5:25\\%,n\\leq5000$。\n\n测试点 $6:40\\%,n\\leq10^6$。\n\n---\n\n梦醒了……", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-1\" Escape", "background": "One day, when $\\mathrm{Sunny}$ was strolling around, he found a button.\n\nCuriosity drove him to press the button.\n\nSuddenly, the world spun $\\dots$", "description": "After waking up, $\\mathrm{Sunny}$ found himself standing in a strange place.\n\nThis place has $n$ platforms, **forming a ring**.\n\nAt this moment, $\\mathrm{Ethan}$'s voice sounded:\n\n\"Ha ha ha ha ha, congratulations. You are the first person to come to the **Land of Death**.\"\n\n\"As you can see, this place has $n$ platforms, and you are now standing on platform $0$.\"\n\n\"The remaining platforms are numbered clockwise as $1,2,3\\dots n-1$. That is, the platform behind you is platform $n-1$.\"\n\n\"Each time, you can jump **clockwise** by $i$ platforms, where $i\\in[1,n]$, and $i$ may be different each time.\"\n\n\"If you can visit all platforms (the initial position $0$ does not count), then you can escape from the **Land of Death**.\"\n\n(Here, the initial position $0$ does not count as visited; you need to visit platform $0$ again.)\n\n\"However, that is too easy. I will give you some numbers $a_j$, meaning you **cannot jump clockwise by $a_j$ platforms in one move**.\"\n\n\"Also, you must complete my task using the **minimum** number of jumps.\"\n\n\"If you cannot satisfy the above two requirements, all platforms will disappear, and you will fall into the lava below.\"\n\nNow, $\\mathrm{Sunny}$ wants to know whether it is possible for him to escape this place.\n\nIf not, output ```-1```. Otherwise, output the minimum number of jumps he needs.\n\nBecause $\\mathrm{Sunny}$ thinks the Land of Death is really interesting, he decided to play a few more times, **multiple test cases**.", "inputFormat": "The first line contains a positive integer $T$, which represents the number of test cases.\n\nIn the next $2\\times T$ lines, there are $T$ test cases in total:\n\nLine $2\\times i-1$ contains two integers $n,k$, where $k$ is the number of $a_j$ in this test case.\n\nLine $2\\times i$ contains $k$ numbers, and the $j$-th number is $a_j$.", "outputFormat": "Output $T$ lines. The $i$-th line is the answer for the $i$-th test case.", "hint": "---\n\n### Sample Explanation\n\nThe first test case:\n\n$\\mathrm{Sunny}$ can only jump clockwise by $5$ platforms each time, so it is clearly impossible to complete the task.\n\nThe second test case:\n\n$\\mathrm{Sunny}$ can only jump clockwise by $3$ platforms each time, and he can do it in $5$ jumps.\n\n---\n\n### Constraints and Notes\n\n$0\\leq k\\leq n\\leq 10^6,1\\leq n$。\n\nIt is guaranteed that $\\sum{n_i}\\leq 3*10^6,a_j\\leq n$, and they are **pairwise distinct**.\n\nTest point $1:5\\%,n=1$.\n\nTest point $2:5\\%,n\\leq5$.\n\nTest point $3:10\\%,n\\leq15$.\n\nTest point $4:15\\%,n\\leq300$.\n\nTest point $5:25\\%,n\\leq5000$.\n\nTest point $6:40\\%,n\\leq10^6$.\n\n---\n\nThe dream woke up……\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-1」Escape", "background": "有一天，当 $\\mathrm{Sunny}$ 闲逛的时候，发现了一个按钮。\n\n好奇心驱使他按下了这个按钮。\n\n突然间，天旋地转 $\\dots$", "description": "醒来之后，$\\mathrm{Sunny}$ 发现自己站在一个奇怪的地方。\n\n这个地方有 $n$ 个平台，**形成了一个环**。\n\n这时，$\\mathrm{Ethan}$ 的声音响起：\n\n“哈哈哈哈哈哈，恭喜你，你是第一个来到**死亡之地**的人。”\n\n“正如你所看到的，这个地方有 $n$ 个平台，你现在站在 $0$ 号平台上。”\n\n“剩余平台按顺时针编号 $1,2,3\\dots n-1$，也就是说，你身后的那个平台就是 $n-1$ 号平台。”\n\n“你每次能够**顺时针**跳 $i$ 个平台，$i\\in[1,n]$，每次的 $i$ 可以不一样。”\n\n“如果你能够经过所有平台（初始 $0$ 号位置不算），那你就能逃出**死亡之地**了。”\n\n（这里指的是一开始的 $0$ 号位置不算经过，需要再次经过 $0$ 号位置）\n\n“不过，这样太简单了，我会给你一些数 $a_j$，表示你**不能一次顺时针跳 $a_j$ 个平台**。”\n\n“还有，你必须要用**最少**的跳跃次数完成我的任务。”\n\n“如果你不能满足我的上面两个要求，所有平台就会消失，你将会掉入下面的岩浆之中。”\n\n现在，$\\mathrm{Sunny}$ 想知道他是否可能逃出这个地方。\n\n如果不行，输出```-1```，否则输出他最少所需的跳跃次数。\n\n因为 $\\mathrm{Sunny}$ 觉得死亡之地实在是太有趣了，所以他决定多玩几次，**多组数据**。", "inputFormat": "第一行，一个正整数 $T$，代表数据组数。\n\n接下来 $2\\times T$ 行，共 $T$ 组数据：\n\n第 $2\\times i-1$ 行，两个整数 $n,k$，$k$ 代表该组数据 $a_j$ 的个数。\n\n第 $2\\times i$ 行，$k$ 个数，第 $j$ 个数表示 $a_j$。", "outputFormat": "$T$ 行，第 $i$ 行表示第 $i$ 组数据的输出。", "hint": "---\n\n### 样例说明\n\n第一组数据：\n\n$\\mathrm{Sunny}$ 每次只能顺时针跳 $5$ 个平台，易知不可能完成。\n\n第二组数据：\n\n$\\mathrm{Sunny}$ 每次只能顺时针跳 $3$ 个平台，跳 $5$ 次即可。\n\n---\n\n### 数据范围与约定\n\n$0\\leq k\\leq n\\leq 10^6,1\\leq n$。\n\n保证 $\\sum{n_i}\\leq 3*10^6,a_j\\leq n$，且**互不相同**。\n\n测试点 $1:5\\%,n=1$。\n\n测试点 $2:5\\%,n\\leq5$。\n\n测试点 $3:10\\%,n\\leq15$。\n\n测试点 $4:15\\%,n\\leq300$。\n\n测试点 $5:25\\%,n\\leq5000$。\n\n测试点 $6:40\\%,n\\leq10^6$。\n\n---\n\n梦醒了……", "locale": "zh-CN"}}}
{"pid": "P5583", "type": "P", "difficulty": 4, "samples": [["5 7 4\n1 3 4 5\n3 3 4 6 5\n4 2 1 5\n2 3 1 7 3\n5 2 2 4\n6 6 3 5 4 6 1 7", "2 4"], ["2 3 2\n1 2\n4 1 1\n4 2 1 3", "-1"], ["4 3 2\n1 2\n1 1 3\n1 2 1 2\n1 1 2\n1 3 1 2 3", "2 3"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 300, 1000, 1000, 300, 300, 1000, 300, 300], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "Special Judge"], "title": "「SWTR-1」Ethan and Sets", "background": "", "description": "$\\mathrm{Ethan}$ 有 $n$ 个数字集合，每个集合有如下属性：\n\n编号：第 $i$ 个集合编号为 $i$。\n\n大小：第 $i$ 个集合大小为 $num_i$。\n\n魔力：第 $i$ 个集合魔力为 $t_i$。\n\n数字：第 $i$ 个集合中含有数字 $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$。\n\n在 $\\mathrm{Ethan}$ 的世界中，一共只有 $m+1$ 个数：$0$ 到 $m$。\n\n$\\mathrm{Ethan}$ 对数字有奇特的感情，在这 $m+1$ 个数中，有 $d$ 个数是他喜欢的，分别是 $p_1,p_2,\\dots,p_d$ ，剩下 $m-d+1$ 个是他不喜欢的。\n\n现在 $\\mathrm{Ethan}$ 要删除一些集合，准确来说，他要选择一段区间 $[L,R]$，**删除所有编号在这个区间以外的集合**。\n\n- 他想要使得在剩余的集合中，包含**所有**他喜欢的数。\n\n- 并且在剩余的集合中，他**不喜欢的数的个数尽可能小**（注：这里的个数是指出现的次数，即如果 $1$ 是 $\\mathrm{Ethan}$ 不喜欢的数，并且剩余的集合中出现了 $3$ 个 $1$，那么算 $3$ 个不喜欢的数）。\n\n- 如果有多个满足条件的区间，他想要使得剩余集合的**魔力之和尽可能大**。\n\n求出满足要求的 $[L,R]$，如果无解输出 $-1$，如果有多解，输出任意一解。", "inputFormat": "第一行三个整数 $n,m,d$。\n\n第二行 $d$ 个整数 $p_1,p_2,\\dots,p_d$。\n\n第三行至第 $n+2$ 行：每行先是两个整数 $t_i,num_i$，随后 $num_i$ 个整数 $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$。", "outputFormat": "一行，如果无解输出 $-1$，否则输出两个整数 $L,R$。", "hint": "---\n\n### 样例解释：\n\n在样例 $1$ 中，$\\mathrm{Ethan}$  可以选择 $[2,4]$，这样在剩余的集合中包含了所有他喜欢的数，且只有 $2$ 个他不喜欢的数在这些集合中出现。\n\n在样例 $2$ 中，不存在合法的解。\n\n---\n\n### 数据范围：\n\n本题使用 subtask。\n\nsubtask 1，$1 \\leq n,m \\leq 100$，$20\\%$。\n\nsubtask 2，$1 \\leq n,m \\leq 500$，$30\\%$。\n\nsubtask 3，$1 \\leq n \\leq 3000, 1 \\leq m \\leq 1000, 1 \\leq t_i \\leq 10^9$，$50\\%$。", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-1\" Ethan and Sets", "background": "", "description": "$\\mathrm{Ethan}$ has $n$ sets of numbers. Each set has the following properties:\n\nID: The ID of the $i$-th set is $i$.\n\nSize: The size of the $i$-th set is $num_i$.\n\nMagic power: The magic power of the $i$-th set is $t_i$.\n\nNumbers: The $i$-th set contains numbers $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$.\n\nIn Ethan's world, there are only $m+1$ numbers in total: from $0$ to $m$.\n\n$\\mathrm{Ethan}$ has special feelings about numbers. Among these $m+1$ numbers, there are $d$ numbers that he likes, namely $p_1,p_2,\\dots,p_d$. The remaining $m-d+1$ numbers are those he does not like.\n\nNow $\\mathrm{Ethan}$ wants to delete some sets. More precisely, he wants to choose an interval $[L,R]$ and **delete all sets whose IDs are outside this interval**.\n\n- He wants the remaining sets to contain **all** the numbers he likes.\n\n- Also, among the remaining sets, the **total count of numbers he does not like** should be as small as possible (note: this count means occurrences. For example, if $1$ is a number that $\\mathrm{Ethan}$ does not like, and there are $3$ occurrences of $1$ in the remaining sets, then it counts as $3$ disliked numbers).\n\n- If there are multiple intervals that satisfy the above, he wants the **sum of magic power** of the remaining sets to be as large as possible.\n\nFind an interval $[L,R]$ that meets the requirements. If there is no solution, output $-1$. If there are multiple solutions, output any one.", "inputFormat": "The first line contains three integers $n,m,d$.\n\nThe second line contains $d$ integers $p_1,p_2,\\dots,p_d$.\n\nLines $3$ to $n+2$: each line starts with two integers $t_i,num_i$, followed by $num_i$ integers $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$.", "outputFormat": "Output one line. If there is no solution, output $-1$. Otherwise, output two integers $L,R$.", "hint": "---\n\n### Sample Explanation:\n\nIn sample $1$, $\\mathrm{Ethan}$ can choose $[2,4]$. Then the remaining sets contain all the numbers he likes, and there are only $2$ occurrences of numbers he does not like in these sets.\n\nIn sample $2$, there is no valid solution.\n\n---\n\n### Constraints:\n\nThis problem uses subtasks.\n\nSubtask 1: $1 \\leq n,m \\leq 100$, $20\\%$.\n\nSubtask 2: $1 \\leq n,m \\leq 500$, $30\\%$.\n\nSubtask 3: $1 \\leq n \\leq 3000, 1 \\leq m \\leq 1000, 1 \\leq t_i \\leq 10^9$, $50\\%$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-1」Ethan and Sets", "background": "", "description": "$\\mathrm{Ethan}$ 有 $n$ 个数字集合，每个集合有如下属性：\n\n编号：第 $i$ 个集合编号为 $i$。\n\n大小：第 $i$ 个集合大小为 $num_i$。\n\n魔力：第 $i$ 个集合魔力为 $t_i$。\n\n数字：第 $i$ 个集合中含有数字 $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$。\n\n在 $\\mathrm{Ethan}$ 的世界中，一共只有 $m+1$ 个数：$0$ 到 $m$。\n\n$\\mathrm{Ethan}$ 对数字有奇特的感情，在这 $m+1$ 个数中，有 $d$ 个数是他喜欢的，分别是 $p_1,p_2,\\dots,p_d$ ，剩下 $m-d+1$ 个是他不喜欢的。\n\n现在 $\\mathrm{Ethan}$ 要删除一些集合，准确来说，他要选择一段区间 $[L,R]$，**删除所有编号在这个区间以外的集合**。\n\n- 他想要使得在剩余的集合中，包含**所有**他喜欢的数。\n\n- 并且在剩余的集合中，他**不喜欢的数的个数尽可能小**（注：这里的个数是指出现的次数，即如果 $1$ 是 $\\mathrm{Ethan}$ 不喜欢的数，并且剩余的集合中出现了 $3$ 个 $1$，那么算 $3$ 个不喜欢的数）。\n\n- 如果有多个满足条件的区间，他想要使得剩余集合的**魔力之和尽可能大**。\n\n求出满足要求的 $[L,R]$，如果无解输出 $-1$，如果有多解，输出任意一解。", "inputFormat": "第一行三个整数 $n,m,d$。\n\n第二行 $d$ 个整数 $p_1,p_2,\\dots,p_d$。\n\n第三行至第 $n+2$ 行：每行先是两个整数 $t_i,num_i$，随后 $num_i$ 个整数 $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$。", "outputFormat": "一行，如果无解输出 $-1$，否则输出两个整数 $L,R$。", "hint": "---\n\n### 样例解释：\n\n在样例 $1$ 中，$\\mathrm{Ethan}$  可以选择 $[2,4]$，这样在剩余的集合中包含了所有他喜欢的数，且只有 $2$ 个他不喜欢的数在这些集合中出现。\n\n在样例 $2$ 中，不存在合法的解。\n\n---\n\n### 数据范围：\n\n本题使用 subtask。\n\nsubtask 1，$1 \\leq n,m \\leq 100$，$20\\%$。\n\nsubtask 2，$1 \\leq n,m \\leq 500$，$30\\%$。\n\nsubtask 3，$1 \\leq n \\leq 3000, 1 \\leq m \\leq 1000, 1 \\leq t_i \\leq 10^9$，$50\\%$。", "locale": "zh-CN"}}}
{"pid": "P5584", "type": "P", "difficulty": 5, "samples": [["5 4\n1 4 2 4 5", "2\n4 2"], ["5 2\n1 2 2 2 2", "4\n2 3 4 5"], ["5 8\n6 10 4 7 8", "2\n4 5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "线段树", "Special Judge", "O2优化"], "title": "「SWTR-1」Sunny's Crystals", "background": "小 $\\mathrm{S}$ 喜欢收集水晶。", "description": "小 $\\mathrm{S}$ 有 $n$ 个水晶，每个水晶有一个属性 $d_i$ ，为这个水晶的**价值**。\n\n有一天，小 $\\mathrm{A}$ 来到了 小 $\\mathrm{S}$ 家，让 小 $\\mathrm{S}$ 把他的水晶排成一个序列，并且摧毁所有价值为 $w$ 的水晶。\n\n但是，由于这个序列的特殊性，你的每次摧毁必须要满足：\n\n- 该水晶在序列里的位置**必须要是 $2$ 的次幂**，即你只能摧毁在 $2^x$ 这个位置上的水晶，$0\\leq x \\leq \\log_2 y$ 且为整数，其中 $y$ 为现在序列里水晶的个数。\n\n摧毁后，**所有在该水晶后面的水晶都会向前移动一格**。\n\n例如，水晶价值序列 $6\\  10\\  4\\  7\\  8$，你只能摧毁位置为 $1,2,4$ 上的水晶。\n\n如果摧毁 $2$ 号水晶，序列就会变成 $6\\  4\\  7\\  8$。\n\n为了节省时间，小 $\\mathrm{S}$ 想知道**最少**多少次可以摧毁所有价值为 $w$ 的水晶，且第 $i$ 次摧毁的水晶初始位置是什么。\n\n**本题使用 Special Judge**，如果有多种答案，任意输出一种即可。", "inputFormat": "第一行两个整数 $n,w$。\n\n第二行，$n$ 个正整数 $d_i$。", "outputFormat": "第一行一个整数 $m$，表示最少可以摧毁所有 $w$ 的次数。\n\n接下来一行 $m$ 个数，第 $i$ 个数表示 第 $i$ 次摧毁时被摧毁的水晶的**初始位置**是什么，**用空格隔开**。\n", "hint": "---\n\n### 样例说明\n\n样例 $1$：\n\n先摧毁后面的 $4$，初始位置为 $4$，**价值**序列变成： $1\\  4\\  2\\  5$。\n\n再摧毁前面的 $4$，初始位置为 $2$。\n\n总次数是 $2$ 次。\n\n样例 $2$：\n\n先摧毁第 $1$ 个 $2$，初始位置为 $2$，序列变成：$1\\  2\\  2\\  2$。\n\n再摧毁剩下的第 $1$ 个 $2$，初始位置为 $3$，序列变成：$1\\  2\\  2$。\n\n再摧毁第一个 $2$，初始位置为 $4$，序列变成：$1\\  2$。\n\n再摧毁第一个 $2$，初始位置为 $5$。\n\n总次数是 $4$ 次。\n\n---\n\n### 数据范围与约定\n\n对于 $15\\%$ 的数据，有 $n\\leq5$。\n\n对于 $25\\%$ 的数据，有 $n\\leq20$。\n\n对于 $30\\%$ 的数据，有 $n\\leq1000$。\n\n对于 $35\\%$ 的数据，有 $n\\leq10000$。\n\n对于 $50\\%$ 的数据，有 $n\\leq3\\times 10^5$。\n\n对于 $80\\%$ 的数据，有 $n\\leq10^6$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq3\\times 10^6,1\\leq d_i\\leq 40000$，保证 $w$ 的个数不大于 $1.5\\times 10^6$。\n\n---\n\n碎掉的水晶在阳光下闪闪发光……", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-1\" Sunny's Crystals", "background": "Little $\\mathrm{S}$ likes collecting crystals.", "description": "Little $\\mathrm{S}$ has $n$ crystals. Each crystal has an attribute $d_i$, which is the **value** of this crystal.\n\nOne day, Little $\\mathrm{A}$ came to Little $\\mathrm{S}$'s home and asked Little $\\mathrm{S}$ to arrange the crystals into a sequence, and destroy all crystals whose value is $w$.\n\nHowever, due to the special property of this sequence, each destruction must satisfy:\n\n- The crystal's position in the sequence **must be a power of $2$**. That is, you can only destroy crystals at position $2^x$, where $0 \\leq x \\leq \\log_2 y$ and $x$ is an integer, and $y$ is the current number of crystals in the sequence.\n\nAfter destroying one crystal, **all crystals after it move forward by one position**.\n\nFor example, for the value sequence $6\\  10\\  4\\  7\\  8$, you can only destroy crystals at positions $1,2,4$.\n\nIf you destroy the crystal at position $2$, the sequence becomes $6\\  4\\  7\\  8$.\n\nTo save time, Little $\\mathrm{S}$ wants to know the **minimum** number of destructions needed to destroy all crystals with value $w$, and what the initial position of the destroyed crystal is for the $i$-th destruction.\n\n**This problem uses Special Judge**. If there are multiple answers, you may output any one of them.", "inputFormat": "The first line contains two integers $n,w$.\n\nThe second line contains $n$ positive integers $d_i$.", "outputFormat": "The first line contains an integer $m$, meaning the minimum number of destructions needed to destroy all crystals with value $w$.\n\nThe next line contains $m$ numbers. The $i$-th number indicates the **initial position** of the crystal destroyed in the $i$-th destruction, **separated by spaces**.", "hint": "---\n\n### Sample Explanation\n\nSample $1$:\n\nFirst destroy the later $4$, whose initial position is $4$. The **value** sequence becomes: $1\\  4\\  2\\  5$.\n\nThen destroy the earlier $4$, whose initial position is $2$.\n\nThe total number of destructions is $2$.\n\nSample $2$:\n\nFirst destroy the first $2$, whose initial position is $2$, and the sequence becomes: $1\\  2\\  2\\  2$.\n\nThen destroy the remaining first $2$, whose initial position is $3$, and the sequence becomes: $1\\  2\\  2$.\n\nThen destroy the first $2$, whose initial position is $4$, and the sequence becomes: $1\\  2$.\n\nThen destroy the first $2$, whose initial position is $5$.\n\nThe total number of destructions is $4$.\n\n---\n\n### Constraints and Notes\n\nFor $15\\%$ of the testdata, $n \\leq 5$.\n\nFor $25\\%$ of the testdata, $n \\leq 20$.\n\nFor $30\\%$ of the testdata, $n \\leq 1000$.\n\nFor $35\\%$ of the testdata, $n \\leq 10000$.\n\nFor $50\\%$ of the testdata, $n \\leq 3 \\times 10^5$.\n\nFor $80\\%$ of the testdata, $n \\leq 10^6$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 3 \\times 10^6, 1 \\leq d_i \\leq 40000$. It is guaranteed that the number of $w$ is no more than $1.5 \\times 10^6$.\n\n---\n\nThe shattered crystals sparkle under the sunlight...\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-1」Sunny's Crystals", "background": "小 $\\mathrm{S}$ 喜欢收集水晶。", "description": "小 $\\mathrm{S}$ 有 $n$ 个水晶，每个水晶有一个属性 $d_i$ ，为这个水晶的**价值**。\n\n有一天，小 $\\mathrm{A}$ 来到了 小 $\\mathrm{S}$ 家，让 小 $\\mathrm{S}$ 把他的水晶排成一个序列，并且摧毁所有价值为 $w$ 的水晶。\n\n但是，由于这个序列的特殊性，你的每次摧毁必须要满足：\n\n- 该水晶在序列里的位置**必须要是 $2$ 的次幂**，即你只能摧毁在 $2^x$ 这个位置上的水晶，$0\\leq x \\leq \\log_2 y$ 且为整数，其中 $y$ 为现在序列里水晶的个数。\n\n摧毁后，**所有在该水晶后面的水晶都会向前移动一格**。\n\n例如，水晶价值序列 $6\\  10\\  4\\  7\\  8$，你只能摧毁位置为 $1,2,4$ 上的水晶。\n\n如果摧毁 $2$ 号水晶，序列就会变成 $6\\  4\\  7\\  8$。\n\n为了节省时间，小 $\\mathrm{S}$ 想知道**最少**多少次可以摧毁所有价值为 $w$ 的水晶，且第 $i$ 次摧毁的水晶初始位置是什么。\n\n**本题使用 Special Judge**，如果有多种答案，任意输出一种即可。", "inputFormat": "第一行两个整数 $n,w$。\n\n第二行，$n$ 个正整数 $d_i$。", "outputFormat": "第一行一个整数 $m$，表示最少可以摧毁所有 $w$ 的次数。\n\n接下来一行 $m$ 个数，第 $i$ 个数表示 第 $i$ 次摧毁时被摧毁的水晶的**初始位置**是什么，**用空格隔开**。\n", "hint": "---\n\n### 样例说明\n\n样例 $1$：\n\n先摧毁后面的 $4$，初始位置为 $4$，**价值**序列变成： $1\\  4\\  2\\  5$。\n\n再摧毁前面的 $4$，初始位置为 $2$。\n\n总次数是 $2$ 次。\n\n样例 $2$：\n\n先摧毁第 $1$ 个 $2$，初始位置为 $2$，序列变成：$1\\  2\\  2\\  2$。\n\n再摧毁剩下的第 $1$ 个 $2$，初始位置为 $3$，序列变成：$1\\  2\\  2$。\n\n再摧毁第一个 $2$，初始位置为 $4$，序列变成：$1\\  2$。\n\n再摧毁第一个 $2$，初始位置为 $5$。\n\n总次数是 $4$ 次。\n\n---\n\n### 数据范围与约定\n\n对于 $15\\%$ 的数据，有 $n\\leq5$。\n\n对于 $25\\%$ 的数据，有 $n\\leq20$。\n\n对于 $30\\%$ 的数据，有 $n\\leq1000$。\n\n对于 $35\\%$ 的数据，有 $n\\leq10000$。\n\n对于 $50\\%$ 的数据，有 $n\\leq3\\times 10^5$。\n\n对于 $80\\%$ 的数据，有 $n\\leq10^6$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq3\\times 10^6,1\\leq d_i\\leq 40000$，保证 $w$ 的个数不大于 $1.5\\times 10^6$。\n\n---\n\n碎掉的水晶在阳光下闪闪发光……", "locale": "zh-CN"}}}
{"pid": "P5585", "type": "P", "difficulty": 5, "samples": [["30 4\n3\n5 3 8\n3 2 2\n8 4 4", "4 2"], ["100 3\n2\n3 2 8\n2 1 5", "8 57"]], "limits": {"time": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1000, 1000, 1000, 1000, 1000], "memory": [8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 262144, 262144, 262144, 262144, 262144, 8192, 8192, 8192, 8192, 8192]}, "tags": ["动态规划 DP", "2019"], "title": "「SWTR-1」Doing Homework", "background": "小 $\\mathrm{A}$ 每天都有很多作业要写。", "description": "每天，小 $\\mathrm{A}$ 都要写至少 $w$ 吨的作业，如果他达不到目标，就会受到小 $\\mathrm{S}$ 制裁并且当场去世。\n\n小 $\\mathrm{A}$ 有 $x$ 点精力，每次写作业都会降低小 $\\mathrm{A}$ 的精力，且**不可逆**，小 $\\mathrm{A}$ 的精力不可以降为负数。\n\n现在，有 $n$ 种作业给小 $\\mathrm{A}$ 选。\n\n每种作业有如下的属性：\n\n$x_i:$ 消耗的精力，即写一份这种作业需要 $x_i$ 的精力。\n\n$w_i:$ 重量，即这种作业一份有 $w_i$ 吨。\n\n$t_i:$ 截止日期，即从今天过了 $t_i$ 天之后，这个作业不可以再写。\n\n**每种作业都有无限个。**\n\n因为他的作业实在是多得写不完，所以请你为他安排一种写作业的方案，**最大化**他能存活的天数，当存活天数已最大化时，最大化他剩余的精力。", "inputFormat": "第一行两个正整数 $x,w$ ，即小 $\\mathrm{A}$ 的精力和每天的目标。\n\n接下来一行一个正整数 $n$ ，表示作业的种数。\n\n接下来 $n$ 行，每行三个整数 $x_i,w_i,t_i$。", "outputFormat": "输出两个由空格隔开的数，分别表示小 $\\mathrm{A}$ 最多能活多少天，以及剩余的精力。", "hint": "---\n\n### 样例说明\n\n第一天，小 $\\mathrm{A}$ 选择写 $2$ 份第二种作业，重量为 $2 * 2=4$，剩余精力为 $30-2 * 3=24$。\n\n第二天，小 $\\mathrm{A}$ 选择写 $2$ 份第二种作业，重量为 $2 * 2=4$，剩余精力为 $24-2 * 3=18$。\n\n至此，不可以再写第二种作业 $(t_2=2)$。\n\n第三天，小 $\\mathrm{A}$ 选择写 $1$ 份第三种作业，重量为 $4$，剩余精力为 $18-8=10$。\n\n第四天，小 $\\mathrm{A}$ 选择写 $1$ 份第三种作业，重量为 $4$，剩余精力为 $10-8=2$。\n\n至此，不可以再写第三种作业 $(t_3=4)$。\n\n小 $\\mathrm{A}$ 没有精力再去写别的作业了，所以他最多能活 $4$ 天，剩余精力为 $2$。\n\n可以证明，找不到比该方案更优的方案了。\n\n---\n\n### 数据范围\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/meko5h7g.png)\n\n---\n\n对于 $n \\leq 5000$ 中 $25\\%$ 的数据，有时间限制 $1s$，空间限制 $256MB$。\n\n其余测试点时间限制 $400ms$，空间限制 $8MB$。", "locale": "zh-CN", "translations": {"en": {"title": "“SWTR-1” Doing Homework", "background": "Little $\\mathrm{A}$ has a lot of homework to do every day.", "description": "Every day, Little $\\mathrm{A}$ must do at least $w$ tons of homework. If he fails to reach the goal, he will be punished by Little $\\mathrm{S}$ and die on the spot.\n\nLittle $\\mathrm{A}$ has $x$ energy points. Each time he does homework, Little $\\mathrm{A}$’s energy decreases, and this is **irreversible**. Little $\\mathrm{A}$’s energy cannot drop below $0$.\n\nNow, there are $n$ types of homework for Little $\\mathrm{A}$ to choose from.\n\nEach type of homework has the following attributes:\n\n$x_i$: energy cost, i.e., doing one copy of this type of homework requires $x_i$ energy.\n\n$w_i$: weight, i.e., one copy of this type of homework weighs $w_i$ tons.\n\n$t_i$: deadline, i.e., after $t_i$ days from today, this homework can no longer be done.\n\n**There are infinitely many copies of each type of homework.**\n\nSince he has too much homework to ever finish, please arrange a homework plan for him to **maximize** the number of days he can survive. When the number of surviving days is maximized, maximize his remaining energy.", "inputFormat": "The first line contains two positive integers $x, w$, representing Little $\\mathrm{A}$’s energy and the daily goal.\n\nThe next line contains one positive integer $n$, indicating the number of types of homework.\n\nThe next $n$ lines each contain three integers $x_i, w_i, t_i$.", "outputFormat": "Output two numbers separated by a space, representing the maximum number of days Little $\\mathrm{A}$ can survive, and his remaining energy.", "hint": "---\n\n### Sample Explanation\n\nOn day $1$, Little $\\mathrm{A}$ chooses to do $2$ copies of the second type of homework. The weight is $2 * 2 = 4$, and the remaining energy is $30 - 2 * 3 = 24$.\n\nOn day $2$, Little $\\mathrm{A}$ chooses to do $2$ copies of the second type of homework. The weight is $2 * 2 = 4$, and the remaining energy is $24 - 2 * 3 = 18$.\n\nAt this point, he can no longer do the second type of homework $(t_2 = 2)$.\n\nOn day $3$, Little $\\mathrm{A}$ chooses to do $1$ copy of the third type of homework. The weight is $4$, and the remaining energy is $18 - 8 = 10$.\n\nOn day $4$, Little $\\mathrm{A}$ chooses to do $1$ copy of the third type of homework. The weight is $4$, and the remaining energy is $10 - 8 = 2$.\n\nAt this point, he can no longer do the third type of homework $(t_3 = 4)$.\n\nLittle $\\mathrm{A}$ has no energy left to do any other homework, so he can survive at most $4$ days, with $2$ energy remaining.\n\nIt can be proven that no better plan than this one can be found.\n\n---\n\n### Constraints\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/meko5h7g.png)\n\n---\n\nFor $25\\%$ of the testdata with $n \\leq 5000$, the time limit is $1\\ \\mathrm{s}$ and the memory limit is $256\\ \\mathrm{MB}$.\n\nFor the remaining test points, the time limit is $400\\ \\mathrm{ms}$ and the memory limit is $8\\ \\mathrm{MB}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-1」Doing Homework", "background": "小 $\\mathrm{A}$ 每天都有很多作业要写。", "description": "每天，小 $\\mathrm{A}$ 都要写至少 $w$ 吨的作业，如果他达不到目标，就会受到小 $\\mathrm{S}$ 制裁并且当场去世。\n\n小 $\\mathrm{A}$ 有 $x$ 点精力，每次写作业都会降低小 $\\mathrm{A}$ 的精力，且**不可逆**，小 $\\mathrm{A}$ 的精力不可以降为负数。\n\n现在，有 $n$ 种作业给小 $\\mathrm{A}$ 选。\n\n每种作业有如下的属性：\n\n$x_i:$ 消耗的精力，即写一份这种作业需要 $x_i$ 的精力。\n\n$w_i:$ 重量，即这种作业一份有 $w_i$ 吨。\n\n$t_i:$ 截止日期，即从今天过了 $t_i$ 天之后，这个作业不可以再写。\n\n**每种作业都有无限个。**\n\n因为他的作业实在是多得写不完，所以请你为他安排一种写作业的方案，**最大化**他能存活的天数，当存活天数已最大化时，最大化他剩余的精力。", "inputFormat": "第一行两个正整数 $x,w$ ，即小 $\\mathrm{A}$ 的精力和每天的目标。\n\n接下来一行一个正整数 $n$ ，表示作业的种数。\n\n接下来 $n$ 行，每行三个整数 $x_i,w_i,t_i$。", "outputFormat": "输出两个由空格隔开的数，分别表示小 $\\mathrm{A}$ 最多能活多少天，以及剩余的精力。", "hint": "---\n\n### 样例说明\n\n第一天，小 $\\mathrm{A}$ 选择写 $2$ 份第二种作业，重量为 $2 * 2=4$，剩余精力为 $30-2 * 3=24$。\n\n第二天，小 $\\mathrm{A}$ 选择写 $2$ 份第二种作业，重量为 $2 * 2=4$，剩余精力为 $24-2 * 3=18$。\n\n至此，不可以再写第二种作业 $(t_2=2)$。\n\n第三天，小 $\\mathrm{A}$ 选择写 $1$ 份第三种作业，重量为 $4$，剩余精力为 $18-8=10$。\n\n第四天，小 $\\mathrm{A}$ 选择写 $1$ 份第三种作业，重量为 $4$，剩余精力为 $10-8=2$。\n\n至此，不可以再写第三种作业 $(t_3=4)$。\n\n小 $\\mathrm{A}$ 没有精力再去写别的作业了，所以他最多能活 $4$ 天，剩余精力为 $2$。\n\n可以证明，找不到比该方案更优的方案了。\n\n---\n\n### 数据范围\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/meko5h7g.png)\n\n---\n\n对于 $n \\leq 5000$ 中 $25\\%$ 的数据，有时间限制 $1s$，空间限制 $256MB$。\n\n其余测试点时间限制 $400ms$，空间限制 $8MB$。", "locale": "zh-CN"}}}
{"pid": "P5586", "type": "P", "difficulty": 6, "samples": [["10 10\n7 1 3 2 2 4 0 1 2 2 \n4 10 10 3 3\n3 4 10 5\n6 6 7\n6 9 10\n1 10 10\n5 14 13 1 0\n2 15 13 7\n5 3 3 2 2\n5 5 3 15 13\n3 4 14 7", "7\n7 0 0 0 7 7 7 1 2 7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144]}, "tags": ["平衡树", "洛谷原创", "O2优化", "可持久化"], "title": "[P5350] 序列 (加强版)", "background": "本题为 [P5350](https://www.luogu.org/problem/P5350) 的加强版。  \n本题很良心，不卡空间！", "description": "有一个序列 $a_n$ 和 $q$ 次操作。\n\n- `1 l r` 求区间 $[l,r]$ 的和  \n- `2 l r k` 区间 $[l,r]$ 赋值为 $k$  \n- `3 l r k` 区间 $[l,r]$ 加上 $k$  \n- `4 l1 r1 l2 r2` 将区间 $[l_1,r_1]$ 复制到 $[l_2,r_2]$ 处  \n- `5 l1 r1 l2 r2` 将区间 $[l_1,r_1]$ 与 $[l_2,r_2]$ 交换  \n- `6 l r` 翻转区间 $[l,r]$\n\n最后还要输出整个序列，所有输出都要对 $10^9+7$ 取模。\n\n为了卡掉某些乱搞做法，**本题强制在线**。  \n\n每次操作中，除了输入第一个数，其它所有数都需要异或 $\\text{last}$ 才是实际的操作。  \n$\\text{last}$ 为上一次 $1$ 操作的答案 $\\pmod{10^9 +7}$，定义初始 $\\text{last} = 0$。", "inputFormat": "第一行两个正整数 $n,q$，表示序列长度与操作个数。  \n第二行 $n$ 个正整数，表示序列 $a$  \n接下来 $q$ 行，每行表示一次操作。", "outputFormat": "对于每次操作，输出一行一个整数表示答案。  \n最后一行输出 $n$ 个整数，表示最终的序列 $a$。", "hint": "【数据范围】   \n$1\\le n,q \\le 3\\times 10^5$  \n$0\\le a_i,k \\le 10^9$   \n对于 $4,5$ 操作，保证 $r_1-l_1 = r_2-l_2$ 且 $[l_1,r_1] \\cap [l_2,r_2] = \\varnothing$\n\n**不保证数据随机** 且 **没有梯度**   \n想交 ODT 的就算了吧！", "locale": "zh-CN", "translations": {"en": {"title": "[P5350] Sequence (Enhanced Version)", "background": "This problem is an enhanced version of [P5350](https://www.luogu.org/problem/P5350).  \nThis problem is quite friendly and does not try to restrict memory usage.", "description": "There is a sequence $a_n$ and $q$ operations.\n\n- `1 l r` Query the sum of the interval $[l,r]$.  \n- `2 l r k` Assign all values in the interval $[l,r]$ to $k$.  \n- `3 l r k` Add $k$ to all values in the interval $[l,r]$.  \n- `4 l1 r1 l2 r2` Copy the interval $[l_1,r_1]$ to $[l_2,r_2]$.  \n- `5 l1 r1 l2 r2` Swap the intervals $[l_1,r_1]$ and $[l_2,r_2]$.  \n- `6 l r` Reverse the interval $[l,r]$.  \n\nIn the end, you also need to output the entire sequence. All outputs should be taken modulo $10^9+7$.\n\nTo block some brute-force or hacky solutions, **this problem is strictly online**.\n\nIn each operation, except for the first number, all other numbers must be XORed with $\\text{last}$ to obtain the actual operation.  \n$\\text{last}$ is the answer of the previous type $1$ operation $\\pmod{10^9 + 7}$, and initially $\\text{last} = 0$.", "inputFormat": "The first line contains two positive integers $n,q$, representing the sequence length and the number of operations.  \nThe second line contains $n$ positive integers, representing the sequence $a$.  \nThe next $q$ lines each describe one operation.", "outputFormat": "For each type $1$ operation, output one integer per line as the answer.  \nIn the last line, output $n$ integers, representing the final sequence $a$.", "hint": "Constraints  \n$1\\le n,q \\le 3\\times 10^5$  \n$0\\le a_i,k \\le 10^9$  \nFor operations $4$ and $5$, it is guaranteed that $r_1-l_1 = r_2-l_2$ and $[l_1,r_1] \\cap [l_2,r_2] = \\varnothing$.\n\n**The testdata is not guaranteed to be random**, and there is **no grading by subtasks**.  \nIf you want to submit ODT, just forget it.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[P5350] 序列 (加强版)", "background": "本题为 [P5350](https://www.luogu.org/problem/P5350) 的加强版。  \n本题很良心，不卡空间！", "description": "有一个序列 $a_n$ 和 $q$ 次操作。\n\n- `1 l r` 求区间 $[l,r]$ 的和  \n- `2 l r k` 区间 $[l,r]$ 赋值为 $k$  \n- `3 l r k` 区间 $[l,r]$ 加上 $k$  \n- `4 l1 r1 l2 r2` 将区间 $[l_1,r_1]$ 复制到 $[l_2,r_2]$ 处  \n- `5 l1 r1 l2 r2` 将区间 $[l_1,r_1]$ 与 $[l_2,r_2]$ 交换  \n- `6 l r` 翻转区间 $[l,r]$\n\n最后还要输出整个序列，所有输出都要对 $10^9+7$ 取模。\n\n为了卡掉某些乱搞做法，**本题强制在线**。  \n\n每次操作中，除了输入第一个数，其它所有数都需要异或 $\\text{last}$ 才是实际的操作。  \n$\\text{last}$ 为上一次 $1$ 操作的答案 $\\pmod{10^9 +7}$，定义初始 $\\text{last} = 0$。", "inputFormat": "第一行两个正整数 $n,q$，表示序列长度与操作个数。  \n第二行 $n$ 个正整数，表示序列 $a$  \n接下来 $q$ 行，每行表示一次操作。", "outputFormat": "对于每次操作，输出一行一个整数表示答案。  \n最后一行输出 $n$ 个整数，表示最终的序列 $a$。", "hint": "【数据范围】   \n$1\\le n,q \\le 3\\times 10^5$  \n$0\\le a_i,k \\le 10^9$   \n对于 $4,5$ 操作，保证 $r_1-l_1 = r_2-l_2$ 且 $[l_1,r_1] \\cap [l_2,r_2] = \\varnothing$\n\n**不保证数据随机** 且 **没有梯度**   \n想交 ODT 的就算了吧！", "locale": "zh-CN"}}}
{"pid": "P5587", "type": "P", "difficulty": 3, "samples": [["hello world.\naaabbbb\nx\nEOF\nheelo world.\naaacbbbb\ny<x\nEOF\n60", "18"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "栈", "洛谷月赛"], "title": "打字练习", "background": "", "description": "R 君在练习打字。\n\n有这样一个打字练习网站，给定一个范文和输入框，会根据你的输入计算准确率和打字速度。可以输入的字符有小写字母、空格和 `.`（英文句号），输入字符后，光标也会跟着移动。\n\n输入的文本有多行，R 君可以通过换行键来换行，换行后光标移动到下一行的开头。\n\nR 君也可以按退格键（为了方便，退格键用 `<` 表示），以删除上一个打的字符，并将光标回移一格。特殊的，如果此时光标已经在一行的开头，则不能继续退格（即忽略此时输入的退格键）。\n\n网站的比较方式遵循以下两个原则：\n\n- 逐行比较，即对于范文和输入的每一行依次比较，不同行之间不会产生影响，多余的行会被忽略。\n- 逐位比较，即对于两行的每一个字符依次比较，当且仅当字符相同时才会被算作一次正确，否则会被算作错误。计算答案时，只统计相同的字符个数。\n\n需要注意的是，回车键不会被计入正确的字符个数。\n\nR 君看到网站上显示他花了 $T$ 秒完成了这次的打字游戏，请你计算出他的 KPM（Keys per minutes，每分钟输入的字符个数），答案四舍五入保留整数部分。\n", "inputFormat": "R 君会依次告诉你网站的范文，他的输入和花费的时间。\n\n其中范文和输入将会这样读入：给定若干行字符串，以单独的一行 `EOF` 结束，其中 `EOF` 不算入输入的文本。\n\n最后一行一个整数 $T$，表示他打字花费了 $T$ 秒。\n\n可以参考样例输入输出文件和样例解释辅助理解。", "outputFormat": "一行一个整数，表示 KPM。", "hint": "#### 样例解释\n\n第一行的正确字符数为 11。  \n第二行的正确字符数为 6，错误的字符 `c` 仍会占据一个位置。  \n第三行的正确字符数为 1，R 君使用退格键删除了被打错的字符 `y`\n\n#### 数据范围\n\n对于 $20\\%$ 的数据，不存在换行键。  \n对于 $40\\%$ 的数据，不存在退格键。  \n对于 $100\\%$ 的数据，$T \\leq 10^3$，保证每个文本段的总字符数（包括换行）不超过 $10^5$ 个且总行数不超过 $10^4$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Typing Practice.", "background": "", "description": "Mr. R is practicing typing.\n\nThere is a typing practice website. Given a reference text and an input box, it will calculate your accuracy and typing speed based on what you type. The characters you can type are lowercase letters, spaces, and `.` (a period). After you type a character, the cursor moves accordingly.\n\nThe typed text has multiple lines. Mr. R can press the Enter key to start a new line, and after that the cursor moves to the beginning of the next line.\n\nMr. R can also press the Backspace key (for convenience, we use `<` to represent Backspace) to delete the previously typed character and move the cursor back by one position. In particular, if the cursor is already at the beginning of a line, you cannot backspace anymore (i.e., ignore this Backspace input).\n\nThe website compares texts according to the following two rules:\n\n- Compare line by line: compare each line of the reference text and the input in order. Different lines do not affect each other, and extra lines are ignored.\n- Compare position by position: for each character position in a line, compare in order. A character is counted as correct if and only if the characters are the same; otherwise it is counted as wrong. When computing the result, only the number of matching characters is counted.\n\nNote that the Enter key is not included in the number of correct characters.\n\nMr. R sees that the website shows he spent $T$ seconds to finish this typing game. Please compute his KPM (Keys per minutes, the number of characters entered per minute). Round the answer to the nearest integer.", "inputFormat": "Mr. R will provide you with the reference text, his input, and the time spent, in this order.\n\nThe reference text and the input are read as follows: given several lines of strings, ending with a single line `EOF`. The line `EOF` is not part of the text.\n\nThe last line is an integer $T$, meaning he spent $T$ seconds typing.\n\nYou may refer to the sample input/output files and the sample explanation for better understanding.", "outputFormat": "Output one integer on a single line, representing the KPM.", "hint": "#### Sample Explanation\n\nThe number of correct characters in the first line is 11.  \nThe number of correct characters in the second line is 6. The wrong character `c` still takes up one position.  \nThe number of correct characters in the third line is 1. Mr. R used Backspace to delete the incorrectly typed character `y`.\n\n#### Constraints\n\nFor $20\\%$ of the testdata, there is no Enter key.  \nFor $40\\%$ of the testdata, there is no Backspace key.  \nFor $100\\%$ of the testdata, $T \\leq 10^3$, and the total number of characters (including newlines) in each text block is at most $10^5$, and the total number of lines is at most $10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "打字练习", "background": "", "description": "R 君在练习打字。\n\n有这样一个打字练习网站，给定一个范文和输入框，会根据你的输入计算准确率和打字速度。可以输入的字符有小写字母、空格和 `.`（英文句号），输入字符后，光标也会跟着移动。\n\n输入的文本有多行，R 君可以通过换行键来换行，换行后光标移动到下一行的开头。\n\nR 君也可以按退格键（为了方便，退格键用 `<` 表示），以删除上一个打的字符，并将光标回移一格。特殊的，如果此时光标已经在一行的开头，则不能继续退格（即忽略此时输入的退格键）。\n\n网站的比较方式遵循以下两个原则：\n\n- 逐行比较，即对于范文和输入的每一行依次比较，不同行之间不会产生影响，多余的行会被忽略。\n- 逐位比较，即对于两行的每一个字符依次比较，当且仅当字符相同时才会被算作一次正确，否则会被算作错误。计算答案时，只统计相同的字符个数。\n\n需要注意的是，回车键不会被计入正确的字符个数。\n\nR 君看到网站上显示他花了 $T$ 秒完成了这次的打字游戏，请你计算出他的 KPM（Keys per minutes，每分钟输入的字符个数），答案四舍五入保留整数部分。\n", "inputFormat": "R 君会依次告诉你网站的范文，他的输入和花费的时间。\n\n其中范文和输入将会这样读入：给定若干行字符串，以单独的一行 `EOF` 结束，其中 `EOF` 不算入输入的文本。\n\n最后一行一个整数 $T$，表示他打字花费了 $T$ 秒。\n\n可以参考样例输入输出文件和样例解释辅助理解。", "outputFormat": "一行一个整数，表示 KPM。", "hint": "#### 样例解释\n\n第一行的正确字符数为 11。  \n第二行的正确字符数为 6，错误的字符 `c` 仍会占据一个位置。  \n第三行的正确字符数为 1，R 君使用退格键删除了被打错的字符 `y`\n\n#### 数据范围\n\n对于 $20\\%$ 的数据，不存在换行键。  \n对于 $40\\%$ 的数据，不存在退格键。  \n对于 $100\\%$ 的数据，$T \\leq 10^3$，保证每个文本段的总字符数（包括换行）不超过 $10^5$ 个且总行数不超过 $10^4$。\n", "locale": "zh-CN"}}}
{"pid": "P5588", "type": "P", "difficulty": 5, "samples": [["4\n1 2 2 3\n1 2\n2 3\n3 4", "3\n4\n3\n6"], ["10\n9 7 4 2 3 4 4 5 8 5\n2 1\n3 2\n4 2\n5 2\n6 4\n7 4\n8 1\n9 4\n10 4", "45\n35\n9\n0\n1\n45\n34\n9\n17\n45"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000]}, "tags": ["树的遍历", "洛谷月赛"], "title": "小猪佩奇爬树", "background": null, "description": "佩奇和乔治在爬♂树。\n\n\n给定 $n$ 个节点的树 $T(V,E)$，第 $i$ 个节点的颜色为 $w_i$，保证有 $1 \\leq w_i \\leq n$。\n\n对于 $1 \\leq i \\leq n$，分别输出有多少对点对 $(u,v)$，满足 $u<v$，且恰好经过**所有**颜色为 $i$ 的节点，对于节点颜色不为 $i$ 的其他节点，经过或不经过均可。\n\n树上路径 $(u,v)$ 定义为序列 $\\{f\\}$，满足 $f_1=u,f_{|f|}=v$，且 $\\forall 1 \\leq i < |f|$，$T$ 中均存在边 $(f_i,f_{i+1})$，且 $\\{f\\}$ 中无重复元素，能够证明对于任意点对 $(u,v)$，其树上路径唯一。", "inputFormat": "第一行 $1$ 个正整数，表示 $n$ 。\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $w_i$。\n\n之后 $n-1$ 行，每行 $2$ 个正整数 $u,v$，表示 $T$ 中存在边 $(u,v)$。", "outputFormat": "共 $n$ 行，每行 $1$ 个正整数，第 $i$ 行输出包含所有颜色为 $i$ 的节点的路径个数。", "hint": "![](https://i.loli.net/2019/10/06/H9LuWl7GSXfs4M6.png)\n\n对于第一组样例而言。\n\n对于颜色 $1$，点对 $(1,2),(1,3),(1,4)$ 满足条件。\n\n对于颜色 $2$，点对 $(1,3),(1,4),(2,3),(2,4)$ 满足条件。\n\n对于颜色 $3$，点对 $(1,4),(2,4),(3,4)$ 满足条件。\n\n对于颜色 $4$，由于图中没有颜色为 $4$ 的节点，所以所有点对均满足条件。\n### 数据范围\n\n对于 $40\\%$ 的数据，$n \\leq 10^2$。\n\n对于 $60\\%$ 的数据，$n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，$n \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Peppa Pig Climbs a Tree", "background": "", "description": "Peppa and George are climbing a tree.\n\nGiven a tree $T(V,E)$ with $n$ nodes, the color of node $i$ is $w_i$, and it is guaranteed that $1 \\leq w_i \\leq n$.\n\nFor each $1 \\leq i \\leq n$, output how many pairs $(u,v)$ satisfy $u<v$, and the path from $u$ to $v$ passes through **all** nodes whose color is $i$. For other nodes whose color is not $i$, the path may pass through them or not.\n\nA tree path $(u,v)$ is defined as a sequence $\\{f\\}$ such that $f_1=u$, $f_{|f|}=v$, and for all $1 \\leq i < |f|$, there is an edge $(f_i,f_{i+1})$ in $T$, and there are no repeated elements in $\\{f\\}$. It can be proven that for any pair $(u,v)$, the tree path is unique.", "inputFormat": "The first line contains one positive integer $n$.\n\nThe second line contains $n$ positive integers, where the $i$-th integer is $w_i$.\n\nThe next $n-1$ lines each contain two positive integers $u,v$, indicating that there is an edge $(u,v)$ in $T$.", "outputFormat": "Output $n$ lines, each containing one positive integer. On the $i$-th line, output the number of paths that contain all nodes whose color is $i$.", "hint": "![](https://i.loli.net/2019/10/06/H9LuWl7GSXfs4M6.png)\n\nFor the first sample.\n\nFor color $1$, the pairs $(1,2),(1,3),(1,4)$ satisfy the condition.\n\nFor color $2$, the pairs $(1,3),(1,4),(2,3),(2,4)$ satisfy the condition.\n\nFor color $3$, the pairs $(1,4),(2,4),(3,4)$ satisfy the condition.\n\nFor color $4$, since there is no node with color $4$ in the graph, all pairs satisfy the condition.\n\n### Constraints\n\nFor $40\\%$ of the testdata, $n \\leq 10^2$.\n\nFor $60\\%$ of the testdata, $n \\leq 10^3$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猪佩奇爬树", "background": null, "description": "佩奇和乔治在爬♂树。\n\n\n给定 $n$ 个节点的树 $T(V,E)$，第 $i$ 个节点的颜色为 $w_i$，保证有 $1 \\leq w_i \\leq n$。\n\n对于 $1 \\leq i \\leq n$，分别输出有多少对点对 $(u,v)$，满足 $u<v$，且恰好经过**所有**颜色为 $i$ 的节点，对于节点颜色不为 $i$ 的其他节点，经过或不经过均可。\n\n树上路径 $(u,v)$ 定义为序列 $\\{f\\}$，满足 $f_1=u,f_{|f|}=v$，且 $\\forall 1 \\leq i < |f|$，$T$ 中均存在边 $(f_i,f_{i+1})$，且 $\\{f\\}$ 中无重复元素，能够证明对于任意点对 $(u,v)$，其树上路径唯一。", "inputFormat": "第一行 $1$ 个正整数，表示 $n$ 。\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $w_i$。\n\n之后 $n-1$ 行，每行 $2$ 个正整数 $u,v$，表示 $T$ 中存在边 $(u,v)$。", "outputFormat": "共 $n$ 行，每行 $1$ 个正整数，第 $i$ 行输出包含所有颜色为 $i$ 的节点的路径个数。", "hint": "![](https://i.loli.net/2019/10/06/H9LuWl7GSXfs4M6.png)\n\n对于第一组样例而言。\n\n对于颜色 $1$，点对 $(1,2),(1,3),(1,4)$ 满足条件。\n\n对于颜色 $2$，点对 $(1,3),(1,4),(2,3),(2,4)$ 满足条件。\n\n对于颜色 $3$，点对 $(1,4),(2,4),(3,4)$ 满足条件。\n\n对于颜色 $4$，由于图中没有颜色为 $4$ 的节点，所以所有点对均满足条件。\n### 数据范围\n\n对于 $40\\%$ 的数据，$n \\leq 10^2$。\n\n对于 $60\\%$ 的数据，$n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，$n \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5589", "type": "P", "difficulty": 5, "samples": [["5\n4\n8\n16\n32\n100", "3.50000000\n7.00000000\n13.83333333\n28.33333333\n93.41666667"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "数论", "Special Judge", "期望", "洛谷月赛"], "title": "小猪佩奇玩游戏", "background": "", "description": "佩奇和乔治玩游♂戏。\n\n佩奇在黑板上写下数字 $\\{1,2,\\cdots,n\\}$ ，每次他们会等概率地报出黑板上的一个数字 $x$ ,并删除所有 $x$ 的正整数次幂。\n\n形式化地,给定数列 $\\{1,2,\\cdots,n\\}$ ，每次等概率选出数列中存在的 $1$ 个数字 $x$ ，并将形如 $\\{x^k,k \\in Z^{+}\\}$ 的数字删除。\n\n他们玩了整整一个下午，游戏还是没有结束，所以他们想知道，该游戏期望在多少轮后会结束。\n\n如果你的答案与正确答案的绝对误差在 $10^{-4} $以内，则被判定为正确。", "inputFormat": "第一行 $1$ 个正整数 $t$,表示佩奇和乔治打算玩 $t$ 轮游戏。\n\n之后 $t$ 行,每行 $1$ 个正整数 $n$,表示佩奇在黑板上写下了数字 $\\{1,2,\\cdots,n\\}$ 并将进行游戏。", "outputFormat": "一共 $t$ 行，每行 $1$ 个小数,表示答案，答案保留小数。\n\n如果你的答案与正确答案的绝对误差在 $10^{-4}$以内，则被判定为正确。", "hint": "对于 $n=4$，\n\n若删除的顺序为 $\\{1,2,3\\},\\{3,2,1\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{1}=\\frac{1}{12}$\n\n若删除的顺序为 $\\{1,3,2\\},\\{3,1,2\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2}=\\frac{1}{24}$\n\n若删除的顺序为 $\\{2,1,3\\},\\{2,3,1\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{8}$\n\n对于剩余的 $12$ 种删除了 $4$ 次的序列，概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{24}$\n\n容易发现答案即为\n$\\frac{2 \\times 3}{12} + \\frac{2 \\times 3}{24}+\\frac{2 \\times 3}{8} + \\frac{12 \\times 4}{24}=\\frac{7}{2}=3.50000$\n\n### 数据范围\n\n对于 $20\\%$ 的数据, $n \\leq 10$\n\n对于 $60\\%$ 的数据, $n \\leq 10^5$\n\n对于 $100\\%$ 的数据, $n \\leq 10^9,t \\leq 100$\n\n### 出题人善意的提醒\n\n对于 C++ 选手，若对于正整数 $n,k$，希望得到 $\\sqrt[k] n$，请尽量不要使用 C++ 自带的 $\\operatorname{pow}$ 函数，以免可能产生不必要的精度误差。", "locale": "zh-CN", "translations": {"en": {"title": "Peppa Pig Plays a Game", "background": "", "description": "Peppa and George are playing a game.\n\nPeppa writes the numbers $\\{1,2,\\cdots,n\\}$ on the blackboard. Each round, they will choose a number $x$ that is currently on the blackboard uniformly at random, and then delete all positive integer powers of $x$.\n\nFormally, given the sequence $\\{1,2,\\cdots,n\\}$, each time they uniformly select $1$ number $x$ that exists in the sequence, and delete all numbers of the form $\\{x^k,k \\in Z^{+}\\}$.\n\nThey played for a whole afternoon, but the game still did not end, so they want to know: after how many rounds is the game expected to end.\n\nIf the absolute error between your answer and the correct answer is within $10^{-4}$, then it will be judged as correct.", "inputFormat": "The first line contains $1$ positive integer $t$, meaning Peppa and George plan to play $t$ games.\n\nThen follow $t$ lines, each with $1$ positive integer $n$, meaning Peppa wrote the numbers $\\{1,2,\\cdots,n\\}$ on the blackboard and will start the game.", "outputFormat": "Output a total of $t$ lines, each containing $1$ decimal number, representing the answer. Keep the decimals.\n\nIf the absolute error between your answer and the correct answer is within $10^{-4}$, then it will be judged as correct.", "hint": "For $n=4$,\n\nIf the deletion order is $\\{1,2,3\\},\\{3,2,1\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{1}=\\frac{1}{12}$.\n\nIf the deletion order is $\\{1,3,2\\},\\{3,1,2\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2}=\\frac{1}{24}$.\n\nIf the deletion order is $\\{2,1,3\\},\\{2,3,1\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{8}$.\n\nFor the remaining $12$ sequences that delete $4$ times, the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{24}$.\n\nIt is easy to see that the answer is\n$\\frac{2 \\times 3}{12} + \\frac{2 \\times 3}{24}+\\frac{2 \\times 3}{8} + \\frac{12 \\times 4}{24}=\\frac{7}{2}=3.50000$.\n\n### Constraints\n\nFor $20\\%$ of the testdata, $n \\leq 10$.\n\nFor $60\\%$ of the testdata, $n \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^9,t \\leq 100$.\n\n### A Friendly Reminder from the Problem Setter\n\nFor C++ users, for positive integers $n,k$, if you want to compute $\\sqrt[k] n$, please try not to use the built-in C++ function $\\operatorname{pow}$, in order to avoid possible unnecessary precision errors.\n\n# Input Format\n\nThe first line contains $1$ positive integer $t$, meaning Peppa and George plan to play $t$ games.\n\nThen follow $t$ lines, each with $1$ positive integer $n$, meaning Peppa wrote the numbers $\\{1,2,\\cdots,n\\}$ on the blackboard and will start the game.\n\n# Output Format\n\nOutput a total of $t$ lines, each containing $1$ decimal number, representing the answer. Keep the decimals.\n\nIf the absolute error between your answer and the correct answer is within $10^{-4}$, then it will be judged as correct.\n\n# Hint\n\nFor $n=4$,\n\nIf the deletion order is $\\{1,2,3\\},\\{3,2,1\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{1}=\\frac{1}{12}$.\n\nIf the deletion order is $\\{1,3,2\\},\\{3,1,2\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2}=\\frac{1}{24}$.\n\nIf the deletion order is $\\{2,1,3\\},\\{2,3,1\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{8}$.\n\nFor the remaining $12$ sequences that delete $4$ times, the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{24}$.\n\nIt is easy to see that the answer is\n$\\frac{2 \\times 3}{12} + \\frac{2 \\times 3}{24}+\\frac{2 \\times 3}{8} + \\frac{12 \\times 4}{24}=\\frac{7}{2}=3.50000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猪佩奇玩游戏", "background": "", "description": "佩奇和乔治玩游♂戏。\n\n佩奇在黑板上写下数字 $\\{1,2,\\cdots,n\\}$ ，每次他们会等概率地报出黑板上的一个数字 $x$ ,并删除所有 $x$ 的正整数次幂。\n\n形式化地,给定数列 $\\{1,2,\\cdots,n\\}$ ，每次等概率选出数列中存在的 $1$ 个数字 $x$ ，并将形如 $\\{x^k,k \\in Z^{+}\\}$ 的数字删除。\n\n他们玩了整整一个下午，游戏还是没有结束，所以他们想知道，该游戏期望在多少轮后会结束。\n\n如果你的答案与正确答案的绝对误差在 $10^{-4} $以内，则被判定为正确。", "inputFormat": "第一行 $1$ 个正整数 $t$,表示佩奇和乔治打算玩 $t$ 轮游戏。\n\n之后 $t$ 行,每行 $1$ 个正整数 $n$,表示佩奇在黑板上写下了数字 $\\{1,2,\\cdots,n\\}$ 并将进行游戏。", "outputFormat": "一共 $t$ 行，每行 $1$ 个小数,表示答案，答案保留小数。\n\n如果你的答案与正确答案的绝对误差在 $10^{-4}$以内，则被判定为正确。", "hint": "对于 $n=4$，\n\n若删除的顺序为 $\\{1,2,3\\},\\{3,2,1\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{1}=\\frac{1}{12}$\n\n若删除的顺序为 $\\{1,3,2\\},\\{3,1,2\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2}=\\frac{1}{24}$\n\n若删除的顺序为 $\\{2,1,3\\},\\{2,3,1\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{8}$\n\n对于剩余的 $12$ 种删除了 $4$ 次的序列，概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{24}$\n\n容易发现答案即为\n$\\frac{2 \\times 3}{12} + \\frac{2 \\times 3}{24}+\\frac{2 \\times 3}{8} + \\frac{12 \\times 4}{24}=\\frac{7}{2}=3.50000$\n\n### 数据范围\n\n对于 $20\\%$ 的数据, $n \\leq 10$\n\n对于 $60\\%$ 的数据, $n \\leq 10^5$\n\n对于 $100\\%$ 的数据, $n \\leq 10^9,t \\leq 100$\n\n### 出题人善意的提醒\n\n对于 C++ 选手，若对于正整数 $n,k$，希望得到 $\\sqrt[k] n$，请尽量不要使用 C++ 自带的 $\\operatorname{pow}$ 函数，以免可能产生不必要的精度误差。", "locale": "zh-CN"}}}
{"pid": "P5590", "type": "P", "difficulty": 5, "samples": [["10 10\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n1 10", "10 10\n1 2 1\n2 3 1\n3 4 1\n4 5 1\n5 6 1\n6 7 1\n7 8 1\n8 9 1\n9 10 1\n1 10 9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["Special Judge", "差分约束", "洛谷月赛"], "title": "赛车游戏", "background": "", "description": "R 君和小伙伴打算一起玩赛车。但他们被老司机 mocania 骗去了秋名山。\n\n秋名山上有 $n$ 个点和 $m$ 条边，R 君和他的小伙伴要从点 $1$ 出发开往点 $n$，每条边都有一个初始的方向。老司机 mocania 拿到了秋名山的地图但却不知道每条路有多长。显然，为了赛车游戏的公平，每条 $1$ 到 $n$ 的路径应当是等长的。mocania 想，我就随便给边标上一个 $1...9$ 的长度，反正傻傻的 R 君也看不出来。\n\n可 mocania 的数学不大好，不知道怎么给边标长度，只能跑来请教你这个 OI 高手了。\n\n", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $u,v$，表示一条从 $u$ 到 $v$ 的有向边。", "outputFormat": "如果无解或者不存在 $1$ 到 $n$ 的路径直接输出一个 $-1$。\n\n如果有解第一行输出两个数 $n,m$，和输入文件中给出的相同。\n\n接下来 $m$ 行，每行三个整数 $u,v,w$，表示把从 $u$ 到 $v$ 的路径的长度设置为 $w$，其中 $w$ 是一个 $1\\sim 9$ 的整数。要求所有边的出现顺序和题目中给出的相同。", "hint": "#### 数据范围\n\n**本题启用 Special Judge 和 Subtask。**\n\nSubtask #1（$30$ 分）：$n \\leq 10$，$m \\leq 20$；  \nSubtask #2（$30$ 分）：$n \\leq 100$，$m \\leq 200$；  \nSubtask #3（$40$ 分）：$n \\leq 1000$，$m \\leq 2000$。\n\n保证数据中不会出现重边，自环。", "locale": "zh-CN", "translations": {"en": {"title": "Racing Game", "background": "", "description": "Mr. R and his friends plan to play a racing game, but they were tricked by the experienced driver mocania into going to Mount Akina.\n\nOn Mount Akina, there are $n$ nodes and $m$ edges. Mr. R and his friends need to start from node $1$ and drive to node $n$. Each edge has an initial direction. The experienced driver mocania got the map of Mount Akina, but does not know how long each road is. Obviously, for fairness in the racing game, every path from $1$ to $n$ should have the same total length. mocania thinks: “I will just assign each edge a length from $1...9$. Anyway, the silly Mr. R will not be able to tell.”\n\nHowever, mocania is not very good at math and does not know how to assign lengths to the edges, so he comes to ask you, an OI expert, for help.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next $m$ lines each contain two integers $u, v$, indicating a directed edge from $u$ to $v$.", "outputFormat": "If there is no solution, or if there is no path from $1$ to $n$, output $-1$.\n\nIf there is a solution, output two numbers $n, m$ on the first line, the same as in the input file.\n\nThen output $m$ lines. Each line contains three integers $u, v, w$, meaning the length of the edge from $u$ to $v$ is set to $w$, where $w$ is an integer in $1\\sim 9$. The order of all edges must be the same as in the problem statement.", "hint": "#### Constraints\n\n**This problem uses Special Judge and Subtask.**\n\nSubtask #1 ($30$ points): $n \\leq 10$, $m \\leq 20$.  \nSubtask #2 ($30$ points): $n \\leq 100$, $m \\leq 200$.  \nSubtask #3 ($40$ points): $n \\leq 1000$, $m \\leq 2000$.\n\nIt is guaranteed that there are no multiple edges or self-loops in the testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "赛车游戏", "background": "", "description": "R 君和小伙伴打算一起玩赛车。但他们被老司机 mocania 骗去了秋名山。\n\n秋名山上有 $n$ 个点和 $m$ 条边，R 君和他的小伙伴要从点 $1$ 出发开往点 $n$，每条边都有一个初始的方向。老司机 mocania 拿到了秋名山的地图但却不知道每条路有多长。显然，为了赛车游戏的公平，每条 $1$ 到 $n$ 的路径应当是等长的。mocania 想，我就随便给边标上一个 $1...9$ 的长度，反正傻傻的 R 君也看不出来。\n\n可 mocania 的数学不大好，不知道怎么给边标长度，只能跑来请教你这个 OI 高手了。\n\n", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $u,v$，表示一条从 $u$ 到 $v$ 的有向边。", "outputFormat": "如果无解或者不存在 $1$ 到 $n$ 的路径直接输出一个 $-1$。\n\n如果有解第一行输出两个数 $n,m$，和输入文件中给出的相同。\n\n接下来 $m$ 行，每行三个整数 $u,v,w$，表示把从 $u$ 到 $v$ 的路径的长度设置为 $w$，其中 $w$ 是一个 $1\\sim 9$ 的整数。要求所有边的出现顺序和题目中给出的相同。", "hint": "#### 数据范围\n\n**本题启用 Special Judge 和 Subtask。**\n\nSubtask #1（$30$ 分）：$n \\leq 10$，$m \\leq 20$；  \nSubtask #2（$30$ 分）：$n \\leq 100$，$m \\leq 200$；  \nSubtask #3（$40$ 分）：$n \\leq 1000$，$m \\leq 2000$。\n\n保证数据中不会出现重边，自环。", "locale": "zh-CN"}}}
{"pid": "P5591", "type": "P", "difficulty": 7, "samples": [["3 3 2", "54"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "多项式", "洛谷月赛", "单位根反演"], "title": "小猪佩奇学数学", "background": "", "description": "佩奇和乔治在学数♂学。\n\n给定 $n,p,k$,询问\n$$\n\\sum_{i=0}^n \\binom n i \\times p^{i} \\times \\left\\lfloor \\frac{i}{k} \\right\\rfloor \\bmod 998244353\n$$", "inputFormat": "$3$ 个正整数,分别表示 $n,p,k$。", "outputFormat": "$1$ 个正整数,表示答案。", "hint": "对于 $20\\%$ 的数据，$1 \\leq n \\leq 10^6$\n\n对于另外 $40\\%$ 的数据，$k \\in \\{2^w|0 \\leq w \\leq 10\\}$\n\n对于 $100\\%$ 的数据，$1 \\leq n,p <998244353,k \\in \\{2^{w}|0 \\leq w \\leq 20\\}$\n\n### 出题人善意的提醒\n\n请注意常数因子带来的程序效率上的影响。", "locale": "zh-CN", "translations": {"en": {"title": "Peppa Pig Learns Math", "background": "", "description": "Peppa and George are learning math.\n\nGiven $n, p, k$, compute\n$$\n\\sum_{i=0}^n \\binom n i \\times p^{i} \\times \\left\\lfloor \\frac{i}{k} \\right\\rfloor \\bmod 998244353\n$$", "inputFormat": "Three positive integers, representing $n, p, k$.", "outputFormat": "One positive integer, representing the answer.", "hint": "For $20\\%$ of the testdata, $1 \\leq n \\leq 10^6$.\n\nFor another $40\\%$ of the testdata, $k \\in \\{2^w|0 \\leq w \\leq 10\\}$.\n\nFor $100\\%$ of the testdata, $1 \\leq n, p < 998244353$, and $k \\in \\{2^{w}|0 \\leq w \\leq 20\\}$.\n\n### A Friendly Reminder from the Problem Setter\n\nPlease pay attention to the impact of constant factors on your program’s efficiency.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猪佩奇学数学", "background": "", "description": "佩奇和乔治在学数♂学。\n\n给定 $n,p,k$,询问\n$$\n\\sum_{i=0}^n \\binom n i \\times p^{i} \\times \\left\\lfloor \\frac{i}{k} \\right\\rfloor \\bmod 998244353\n$$", "inputFormat": "$3$ 个正整数,分别表示 $n,p,k$。", "outputFormat": "$1$ 个正整数,表示答案。", "hint": "对于 $20\\%$ 的数据，$1 \\leq n \\leq 10^6$\n\n对于另外 $40\\%$ 的数据，$k \\in \\{2^w|0 \\leq w \\leq 10\\}$\n\n对于 $100\\%$ 的数据，$1 \\leq n,p <998244353,k \\in \\{2^{w}|0 \\leq w \\leq 20\\}$\n\n### 出题人善意的提醒\n\n请注意常数因子带来的程序效率上的影响。", "locale": "zh-CN"}}}
{"pid": "P5592", "type": "P", "difficulty": 6, "samples": [["10 10 4\n6 10 1 1 6 9 0 5 3 0 \n3 5\n1 10\n9 3\n8 10\n3 0\n8 11\n1 3\n1 4\n2 8\n1 0", "5\n4\n4\n4\n4\n5\n5\n6\n5\n5\n6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "记忆化搜索", "字典树 Trie", "洛谷月赛"], "title": "美德的讲坛", "background": "", "description": "```\n现在我很清楚地懂得了，以前人们寻求美德的教师时首先在寻求着什么。\n人们在寻求安睡与促进安睡的罂粟花！\n```\n\n查拉图斯特拉在讲坛前听智者讲论睡眠的美德。他感到很无聊，于是观察一同听讲的少年们。\n\n他发现少年们的衣着非常奇特。具体地说，少年们的衣着有 $60$ 种特点，第 $i$ 种特点的特征值为 $2^{i-1}$ 。\n\n他每次会观察两个少年，如果有一种衣着特点只出现在一个少年身上，而不在另一个少年身上，查拉图斯特拉就会强迫症发作，并得到等同于该特点特征值的厌恶度。\n\n他想要把少年们站成若干组，使得在每组中，不管他选哪两个少年，都会得到 $<x$ 点厌恶度。查拉图斯特拉称这样的组是好的。\n\n他有时也会使一个少年自成一组，此时不管怎样这个组都是好的。\n\n他想要知道，这样满足条件的组最多可以包含几个少年呢？\n\n有时少年也会回家换衣服，回来时衣着特点会有所改变。", "inputFormat": "输入数据第一行包括三个整数 $n,q,x$，表示少年的人数，少年回家换衣服的次数和阈值。\n\n接下来一行 $n$ 个整数 $a_1,a_2,\\dots,a_n$，$a_i$ 表示初始时第 $i$ 个少年衣着特点的特征值之和。\n\n接下来 $q$ 行，每行两个整数 $ind,val$，表示编号为 $ind$ 的少年刚回家换衣服回来，衣着特点的特征值之和改为 $val$ 。", "outputFormat": "输出 $q+1$ 行，每行一个非负整数。\n\n第 $i$ 行的数表示第 $i$ 次修改之前的答案。\n\n第 $q+1$ 行的数表示全部修改完以后的答案。", "hint": "对于 $20\\%$ 的数据，满足 $n\\le 20$。\n\n对于 $30\\%$ 的数据，满足 $n\\le 1000$。\n\n对于 $50\\%$ 的数据，满足 $n\\le 50000$。\n\n对于另外 $20\\%$ 的数据，满足 $x$ 是 $2$ 的整次幂。\n\n对于$80\\%$的数据，满足$q=0$。\n\n对于 $100\\%$ 的数据，满足 $1\\le ind\\le n\\le 100000,0\\le q\\le 100000,0\\le x,a_i,val< 2^{60}$。", "locale": "zh-CN", "translations": {"en": {"title": "The Virtue Lectern", "background": "", "description": "```\nNow I understand very clearly what people were really looking for when they sought teachers of virtue in the past.\nThey were looking for sleep, and poppies that help with sleep!\n```\n\nZarathustra listens to a wise man on the lectern talking about the virtue of sleep. He feels bored, so he observes the boys who are listening together.\n\nHe finds that the boys’ clothes are very strange. Specifically, the clothes have $60$ kinds of features. The value of the $i$-th feature is $2^{i-1}$.\n\nEach time he observes two boys. If there is a clothing feature that appears on only one of the two boys, and not on the other, Zarathustra’s obsessive-compulsive disorder acts up, and he gains a disgust value equal to that feature’s value.\n\nHe wants to arrange the boys into several groups such that, in each group, no matter which two boys he picks, he will get a disgust value of $<x$. Zarathustra calls such a group good.\n\nSometimes he also puts one boy into a group alone; in that case, no matter what, the group is good.\n\nHe wants to know: at most, how many boys can a group that satisfies the condition contain?\n\nSometimes a boy will go home and change clothes. When he comes back, his clothing features may change.\n\n#", "inputFormat": "The first line of the input contains three integers $n,q,x$, representing the number of boys, the number of times boys go home to change clothes, and the threshold.\n\nThe next line contains $n$ integers $a_1,a_2,\\dots,a_n$, where $a_i$ is the sum of the feature values of the $i$-th boy’s clothing at the beginning.\n\nThe next $q$ lines each contain two integers $ind,val$, meaning the boy with index $ind$ has just come back after changing clothes, and the sum of his clothing feature values becomes $val$.\n\n#", "outputFormat": "Output $q+1$ lines, each containing one non-negative integer.\n\nThe number on line $i$ is the answer before the $i$-th modification.\n\nThe number on line $q+1$ is the answer after all modifications are finished.\n\n#", "hint": "For $20\\%$ of the data, $n\\le 20$.\n\nFor $30\\%$ of the data, $n\\le 1000$.\n\nFor $50\\%$ of the data, $n\\le 50000$.\n\nFor another $20\\%$ of the data, $x$ is an integer power of $2$.\n\nFor $80\\%$ of the data, $q=0$.\n\nFor $100\\%$ of the data, $1\\le ind\\le n\\le 100000,0\\le q\\le 100000,0\\le x,a_i,val< 2^{60}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "美德的讲坛", "background": "", "description": "```\n现在我很清楚地懂得了，以前人们寻求美德的教师时首先在寻求着什么。\n人们在寻求安睡与促进安睡的罂粟花！\n```\n\n查拉图斯特拉在讲坛前听智者讲论睡眠的美德。他感到很无聊，于是观察一同听讲的少年们。\n\n他发现少年们的衣着非常奇特。具体地说，少年们的衣着有 $60$ 种特点，第 $i$ 种特点的特征值为 $2^{i-1}$ 。\n\n他每次会观察两个少年，如果有一种衣着特点只出现在一个少年身上，而不在另一个少年身上，查拉图斯特拉就会强迫症发作，并得到等同于该特点特征值的厌恶度。\n\n他想要把少年们站成若干组，使得在每组中，不管他选哪两个少年，都会得到 $<x$ 点厌恶度。查拉图斯特拉称这样的组是好的。\n\n他有时也会使一个少年自成一组，此时不管怎样这个组都是好的。\n\n他想要知道，这样满足条件的组最多可以包含几个少年呢？\n\n有时少年也会回家换衣服，回来时衣着特点会有所改变。", "inputFormat": "输入数据第一行包括三个整数 $n,q,x$，表示少年的人数，少年回家换衣服的次数和阈值。\n\n接下来一行 $n$ 个整数 $a_1,a_2,\\dots,a_n$，$a_i$ 表示初始时第 $i$ 个少年衣着特点的特征值之和。\n\n接下来 $q$ 行，每行两个整数 $ind,val$，表示编号为 $ind$ 的少年刚回家换衣服回来，衣着特点的特征值之和改为 $val$ 。", "outputFormat": "输出 $q+1$ 行，每行一个非负整数。\n\n第 $i$ 行的数表示第 $i$ 次修改之前的答案。\n\n第 $q+1$ 行的数表示全部修改完以后的答案。", "hint": "对于 $20\\%$ 的数据，满足 $n\\le 20$。\n\n对于 $30\\%$ 的数据，满足 $n\\le 1000$。\n\n对于 $50\\%$ 的数据，满足 $n\\le 50000$。\n\n对于另外 $20\\%$ 的数据，满足 $x$ 是 $2$ 的整次幂。\n\n对于$80\\%$的数据，满足$q=0$。\n\n对于 $100\\%$ 的数据，满足 $1\\le ind\\le n\\le 100000,0\\le q\\le 100000,0\\le x,a_i,val< 2^{60}$。", "locale": "zh-CN"}}}
{"pid": "P5593", "type": "P", "difficulty": 5, "samples": [["4\n1 2 2 3\n1 2\n2 3\n3 4", "2\n"], ["10\n9 7 4 2 3 4 4 5 8 5\n2 1\n3 2\n4 2\n5 2\n6 4\n7 4\n8 1\n9 4\n10 4", "60\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["O2优化"], "title": "小猪佩奇爬树 加强版", "background": "CYJian 在打 洛谷 10 月月赛I Div. 2 的时候，用一种 $O(N)$ 的做法过了这道题的原题。\n\n但是好像这题是可以给常数小的 $O(N \\log N)$ 甚至 $O(N^2)$ 过的。 CYJian 觉得很不服并且出了这道加强版。\n\n---\n\n因为有人反馈 `OLE` 的问题，所以 CYJian 将输出改为原来所有输出的异或和。", "description": "原题数据可能过水，有些错误的做法也可以过原来的题目。**所以可能原题能过在这里就WA了。**\n\n~~比如我自己原来一个错解也过了，一堆东西没考虑。~~\n\n样例解释部分可以参见 [P5588](https://www.luogu.org/problem/P5588)。\n\n一句话题意：给出一棵 $n$ 个点的树，每个点上有一种颜色，请你求出对于每一种颜色，树上有多少条链包含该种颜色的所有点。\n\n注意下面的数据范围。**请注意常数因子对程序效率的影响。**\n\n如果需要请使用 [IO优化](https://www.luogu.org/paste/i11c3ppx)", "inputFormat": "输入文件共 $n + 1$ 行。\n\n第一行一个正整数 $n$ 表示树的节点数。\n\n接下来一行 $n$ 个正整数，第 $i$ 个正整数表示编号为 $i$ 的节点的颜色。颜色范围在 $[1, n]$ 内。\n\n接下来 $n - 1$ 行，每行两个正整数表示一条树边。", "outputFormat": "输出文件应该包括 $1$ 行。\n\n令编号为 $i$ 的颜色的权值为满足题目条件的链的数量。**注意若存在一种颜色满足没有任何一个点属于该颜色，这种颜色的权值为** $\\frac{n \\times (n - 1)}{2}$\n\n你仅需要输出所有 $n$ 种颜色的权值异或和。", "hint": "一共 $5$ 组数据，第 $i$ 组的数据范围：\n\n$n = 3 \\times 10^{i+1}$", "locale": "zh-CN", "translations": {"en": {"title": "Peppa Pig Climbing Trees (Enhanced Version).", "background": "When CYJian was doing Luogu October Monthly Contest I Div. 2, they solved the original version of this problem with an $O(N)$ approach.\n\nBut it seems this problem can be passed with a small-constant $O(N \\log N)$ or even $O(N^2)$ solution. CYJian felt unconvinced and made this enhanced version.\n\n---\n\nBecause someone reported an `OLE` issue, CYJian changed the output to the XOR sum of all original outputs.", "description": "The testdata of the original problem might be too weak, so some incorrect solutions could also pass the original problem. **So a solution that passes the original problem may get WA here.**\n\n~~For example, one of my wrong solutions also passed before, because I did not consider a lot of things.~~\n\nFor the sample explanation, you can refer to [P5588](https://www.luogu.org/problem/P5588).\n\nOne-sentence statement: Given a tree with $n$ nodes, each node has a color. For each color, compute how many paths (chains) in the tree contain all nodes of that color.\n\nPay attention to the Constraints below. **Please pay attention to how constant factors affect program efficiency.**\n\nIf needed, please use [I/O optimization](https://www.luogu.org/paste/i11c3ppx).", "inputFormat": "The input file has $n + 1$ lines in total.\n\nThe first line contains a positive integer $n$, the number of nodes in the tree.\n\nThe next line contains $n$ positive integers. The $i$-th positive integer represents the color of node $i$. The color range is within $[1, n]$.\n\nThe next $n - 1$ lines each contain two positive integers describing an edge of the tree.", "outputFormat": "The output file should contain $1$ line.\n\nLet the weight of color $i$ be the number of paths (chains) that satisfy the condition in the statement. **Note that if there exists a color such that no node has this color, then the weight of this color is** $\\frac{n \\times (n - 1)}{2}$.\n\nYou only need to output the XOR sum of the weights of all $n$ colors.", "hint": "There are $5$ test groups. For the $i$-th group, the Constraints are:\n\n$n = 3 \\times 10^{i+1}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猪佩奇爬树 加强版", "background": "CYJian 在打 洛谷 10 月月赛I Div. 2 的时候，用一种 $O(N)$ 的做法过了这道题的原题。\n\n但是好像这题是可以给常数小的 $O(N \\log N)$ 甚至 $O(N^2)$ 过的。 CYJian 觉得很不服并且出了这道加强版。\n\n---\n\n因为有人反馈 `OLE` 的问题，所以 CYJian 将输出改为原来所有输出的异或和。", "description": "原题数据可能过水，有些错误的做法也可以过原来的题目。**所以可能原题能过在这里就WA了。**\n\n~~比如我自己原来一个错解也过了，一堆东西没考虑。~~\n\n样例解释部分可以参见 [P5588](https://www.luogu.org/problem/P5588)。\n\n一句话题意：给出一棵 $n$ 个点的树，每个点上有一种颜色，请你求出对于每一种颜色，树上有多少条链包含该种颜色的所有点。\n\n注意下面的数据范围。**请注意常数因子对程序效率的影响。**\n\n如果需要请使用 [IO优化](https://www.luogu.org/paste/i11c3ppx)", "inputFormat": "输入文件共 $n + 1$ 行。\n\n第一行一个正整数 $n$ 表示树的节点数。\n\n接下来一行 $n$ 个正整数，第 $i$ 个正整数表示编号为 $i$ 的节点的颜色。颜色范围在 $[1, n]$ 内。\n\n接下来 $n - 1$ 行，每行两个正整数表示一条树边。", "outputFormat": "输出文件应该包括 $1$ 行。\n\n令编号为 $i$ 的颜色的权值为满足题目条件的链的数量。**注意若存在一种颜色满足没有任何一个点属于该颜色，这种颜色的权值为** $\\frac{n \\times (n - 1)}{2}$\n\n你仅需要输出所有 $n$ 种颜色的权值异或和。", "hint": "一共 $5$ 组数据，第 $i$ 组的数据范围：\n\n$n = 3 \\times 10^{i+1}$", "locale": "zh-CN"}}}
{"pid": "P5594", "type": "P", "difficulty": 1, "samples": [["1 3 5\n2 3 5\n", "0 1 1 0 1\n"], ["6 3 7\n2 3 4\n2 5 7\n3 5 7\n1 3 5\n5 6 7\n1 2 3\n", "1 2 3 1 3 1 1\n"], ["10 10 20\n2 3 4 8 9 11 12 16 17 18\n2 3 6 10 12 13 14 15 19 20\n1 3 7 10 11 13 14 15 17 19\n1 2 4 6 7 9 15 17 19 20\n2 3 5 6 9 11 14 16 19 20\n1 2 3 8 9 10 11 12 15 19\n1 4 6 7 9 12 13 17 18 19\n1 7 8 9 10 11 13 15 18 20\n1 5 6 7 8 9 13 16 18 19\n4 5 7 10 11 13 14 17 18 20\n", "1 2 2 3 2 2 4 3 3 3 3 4 2 1 3 1 2 2 2 1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "洛谷月赛"], "title": "【XR-4】模拟赛", "background": "", "description": "X 校正在进行 CSP 前的校内集训。\n\n一共有 $n$ 名 OIer 参与这次集训，教练为他们精心准备了 $m$ 套模拟赛题。\n\n然而，每名 OIer 都有各自的时间安排，巧合的是，他们在接下来的 $k$ 天中都恰好有 $m$ 天有空打模拟赛。\n\n为了方便管理，教练规定一个人必须按顺序打完 $m$ 套模拟赛题。\n\n比如，小 X 在接下来的第 $2,3,5$ 天有空打模拟赛，那么他就必须在第 $2$ 天打第 $1$ 套模拟赛题，第 $3$ 天打第 $2$ 套模拟赛题，第 $5$ 天打第 $3$ 套模拟赛题。\n\n教练需要为每一个人的每一次模拟赛做准备，为了减小工作量，如果在某一天有多个人打同一套模拟赛题，那么教练只需要在这一天准备一场使用这一套题的模拟赛即可。\n\n你作为机房大佬，教练想请你帮他计算一下，他每天需要准备多少场模拟赛。", "inputFormat": "第一行三个整数 $n,m,k$。\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数 $a_{i,j}$ 表示第 $i$ 个人在接下来的 $k$ 天中第 $j$ 个有空的日子为第 $a_{i,j}$ 天。", "outputFormat": "一行 $k$ 个整数，第 $i$ 个整数表示接下来的第 $i$ 天教练需要准备的模拟赛场数。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（13 points）：$n = m = k = 1$。\n- Subtask 2（24 points）：$n = 1$。\n- Subtask 3（24 points）：$m = 1$。\n- Subtask 4（39 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,k \\le 10^3$，$m \\le k$，$1 \\le a_{i,1} < a_{i,2} < \\cdots < a_{i,m} \\le k$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Mock Contest", "background": "", "description": "School X is holding an in-school training camp before CSP.\n\nThere are $n$ OIers taking part in this training camp, and the coach has carefully prepared $m$ sets of mock contest problems for them.\n\nHowever, each OIer has their own schedule. Coincidentally, in the next $k$ days, each of them happens to have exactly $m$ days free to do mock contests.\n\nTo make management easier, the coach requires that each person must complete the $m$ sets of mock contests in order.\n\nFor example, if Xiao X is free on days $2,3,5$ in the next days, then they must do the $1$st set on day $2$, the $2$nd set on day $3$, and the $3$rd set on day $5$.\n\nThe coach needs to prepare for every person’s every mock contest. To reduce workload, if multiple people do the same set of mock contest problems on the same day, then the coach only needs to prepare one mock contest using that set of problems on that day.\n\nAs a top student in the lab, the coach wants you to help compute how many mock contests they need to prepare each day.", "inputFormat": "The first line contains three integers $n,m,k$.\n\nIn the next $n$ lines, each line contains $m$ integers. The integer $a_{i,j}$ in row $i$ and column $j$ indicates that for the $i$-th person, the $j$-th free day among the next $k$ days is day $a_{i,j}$.", "outputFormat": "Output one line with $k$ integers. The $i$-th integer indicates the number of mock contests the coach needs to prepare on day $i$ among the next $k$ days.", "hint": "**This problem uses bundled tests.**\n\n- Subtask 1 (13 points): $n = m = k = 1$.\n- Subtask 2 (24 points): $n = 1$.\n- Subtask 3 (24 points): $m = 1$.\n- Subtask 4 (39 points): no special constraints.\n\nFor $100\\%$ of the testdata, $1 \\le n,m,k \\le 10^3$, $m \\le k$, $1 \\le a_{i,1} < a_{i,2} < \\cdots < a_{i,m} \\le k$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】模拟赛", "background": "", "description": "X 校正在进行 CSP 前的校内集训。\n\n一共有 $n$ 名 OIer 参与这次集训，教练为他们精心准备了 $m$ 套模拟赛题。\n\n然而，每名 OIer 都有各自的时间安排，巧合的是，他们在接下来的 $k$ 天中都恰好有 $m$ 天有空打模拟赛。\n\n为了方便管理，教练规定一个人必须按顺序打完 $m$ 套模拟赛题。\n\n比如，小 X 在接下来的第 $2,3,5$ 天有空打模拟赛，那么他就必须在第 $2$ 天打第 $1$ 套模拟赛题，第 $3$ 天打第 $2$ 套模拟赛题，第 $5$ 天打第 $3$ 套模拟赛题。\n\n教练需要为每一个人的每一次模拟赛做准备，为了减小工作量，如果在某一天有多个人打同一套模拟赛题，那么教练只需要在这一天准备一场使用这一套题的模拟赛即可。\n\n你作为机房大佬，教练想请你帮他计算一下，他每天需要准备多少场模拟赛。", "inputFormat": "第一行三个整数 $n,m,k$。\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数 $a_{i,j}$ 表示第 $i$ 个人在接下来的 $k$ 天中第 $j$ 个有空的日子为第 $a_{i,j}$ 天。", "outputFormat": "一行 $k$ 个整数，第 $i$ 个整数表示接下来的第 $i$ 天教练需要准备的模拟赛场数。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（13 points）：$n = m = k = 1$。\n- Subtask 2（24 points）：$n = 1$。\n- Subtask 3（24 points）：$m = 1$。\n- Subtask 4（39 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,k \\le 10^3$，$m \\le k$，$1 \\le a_{i,1} < a_{i,2} < \\cdots < a_{i,m} \\le k$。", "locale": "zh-CN"}}}
{"pid": "P5595", "type": "P", "difficulty": 2, "samples": [["XY\n", "37\n28\n"], ["XYZ\n", "137\n047\n"], ["ZZZZZZ\n", "000000\n000000\n"], ["XYZXYZ\n", "-1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge", "构造", "洛谷月赛"], "title": "【XR-4】歌唱比赛", "background": "**赛时提醒：本题不提供任何关于样例 4 以及无解的解释。**\n\n**赛时提醒：本题不提供任何关于输出格式以及 Special Judge 的解释。**\n\n**赛时提醒：抱歉，本题的 Special Judge 不忽略行末空格，请保证两行中没有多余字符。**\n\n**赛时提醒：非常抱歉，本题输入数据是 Windows 格式，而非 Linux 格式，所以在末尾的 `\\n` 之前有一个多余的 `\\r` 字符。请使用 `scanf` 或 `cin` 读入数据，而非 `getline`，因为后者会多读入一个 `\\r`。**", "description": "小 X 参加了一场歌唱比赛。\n\n经过一路鏖战，小 X 终于挺进了决赛，他的对手是小 Y。\n\n这场歌唱比赛的冠军是由点赞数决定的，谁的点赞数高，谁就能夺冠。\n\n小 X 和小 Y 依次演唱完自己的最后一首歌曲后，他们最终的点赞数确定了下来。\n\n揭晓冠军的时刻终于到来了，主持人为了增加悬念，决定从小 X 与小 Y 的点赞数的最后一位开始，依次比较。\n\n比如，小 X 的点赞数是 $37$，小 Y 的点赞数是 $28$。首先比较最后一位，小 X 是 $7$，小 Y 是 $8$，此时小 Y 暂时领先。再加上前一位，小 X 是 $37$，小 Y 是 $28$，此时小 X 暂时领先。比较结束，如果我们用 `X` 代表小 X 暂时领先，`Y` 代表小 Y 暂时领先，那么可以写下一个字符串 `XY`。\n\n再比如，小 X 的点赞数是 $137$，小 Y 的点赞数是 $47$。如果我们再用 `Z` 表示小 X 与小 Y 的点赞数暂时一样，那么写下的字符串应该为 `XYZ`。\n\n你作为一个精通 OI 的神仙，自然知道这种比较方式是非常不科学的，这样只是在无端拖延时间罢了，但是你却对最后写下的这个字符串很感兴趣。\n\n现在，你得到了这个最后写下的字符串，你需要构造出一种可能的小 X 与小 Y 的点赞数。\n\n当然，有可能不存在任何一种情况的点赞数满足这个字符串，那么你只需要输出 `-1` 即可。\n\n为了方便你输出，请用前导零来补足位数。", "inputFormat": "一行一个字符串 $s$，表示最后写下的字符串。", "outputFormat": "如果有解：\n\n- 第一行一个整数，表示小 X 的点赞数。\n- 第二行一个整数，表示小 Y 的点赞数。\n\n如果无解：\n\n- 一行一个整数 `-1`。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（11 points）：$\\text{len}(s) = 1$。\n- Subtask 2（42 points）：$s_i \\in \\{\\texttt{X},\\texttt{Y}\\}$。\n- Subtask 3（21 points）：数据保证有解。\n- Subtask 4（26 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$s_i \\in \\{\\texttt{X},\\texttt{Y},\\texttt{Z}\\}$，$1 \\le \\text{len}(s) \\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Singing Contest", "background": "**In-contest reminder: This problem provides no explanation for sample 4 or for the no-solution cases.**\n\n**In-contest reminder: This problem provides no explanation for the output format or the Special Judge.**\n\n**In-contest reminder: Sorry, the Special Judge for this problem does not ignore trailing spaces. Please make sure there are no extra characters in the two lines.**\n\n**In-contest reminder: Very sorry, the input data of this problem uses Windows line endings instead of Linux line endings, so there is an extra `\\r` character before the ending `\\n`. Please use `scanf` or `cin` to read the data instead of `getline`, because the latter will read an extra `\\r`.**", "description": "Xiao X took part in a singing contest.\n\nAfter a hard fight, Xiao X finally made it to the final, and his opponent is Xiao Y.\n\nThe champion of this singing contest is decided by the number of likes: whoever has more likes wins.\n\nAfter Xiao X and Xiao Y sang their last song in turn, their final numbers of likes were fixed.\n\nThe moment to announce the champion finally arrived. To build suspense, the host decided to compare their numbers of likes starting from the last digit, moving left one digit at a time.\n\nFor example, Xiao X has $37$ likes, and Xiao Y has $28$ likes. First compare the last digit: Xiao X has $7$ and Xiao Y has $8$, so Xiao Y is temporarily ahead. Then include the previous digit: Xiao X has $37$ and Xiao Y has $28$, so Xiao X is temporarily ahead. After the comparison ends, if we use `X` to represent “Xiao X is temporarily ahead” and `Y` to represent “Xiao Y is temporarily ahead”, we can write down a string `XY`.\n\nFor another example, Xiao X has $137$ likes and Xiao Y has $47$ likes. If we additionally use `Z` to represent “Xiao X and Xiao Y are temporarily equal”, then the written string should be `XYZ`.\n\nAs someone who is good at OI, you of course know that this comparison method is not scientific at all—it just wastes time. However, you are very interested in the final string that is written down.\n\nNow you are given this final string, and you need to construct one possible pair of like counts for Xiao X and Xiao Y.\n\nOf course, it is possible that no pair of like counts can match this string. In that case, you only need to output `-1`.\n\nTo make output easier, please use leading zeros to pad the number of digits.", "inputFormat": "One line with a string $s$, representing the final written string.", "outputFormat": "If there is a solution:\n\n- The first line contains an integer, the number of likes for Xiao X.\n- The second line contains an integer, the number of likes for Xiao Y.\n\nIf there is no solution:\n\n- One line with an integer `-1`.", "hint": "**This problem uses bundled tests.**\n\n- Subtask 1 (11 points): $\\text{len}(s) = 1$.\n- Subtask 2 (42 points): $s_i \\in \\{\\texttt{X},\\texttt{Y}\\}$.\n- Subtask 3 (21 points): The testdata guarantees that a solution exists.\n- Subtask 4 (26 points): No special restrictions.\n\nFor $100\\%$ of the testdata, $s_i \\in \\{\\texttt{X},\\texttt{Y},\\texttt{Z}\\}$, $1 \\le \\text{len}(s) \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】歌唱比赛", "background": "**赛时提醒：本题不提供任何关于样例 4 以及无解的解释。**\n\n**赛时提醒：本题不提供任何关于输出格式以及 Special Judge 的解释。**\n\n**赛时提醒：抱歉，本题的 Special Judge 不忽略行末空格，请保证两行中没有多余字符。**\n\n**赛时提醒：非常抱歉，本题输入数据是 Windows 格式，而非 Linux 格式，所以在末尾的 `\\n` 之前有一个多余的 `\\r` 字符。请使用 `scanf` 或 `cin` 读入数据，而非 `getline`，因为后者会多读入一个 `\\r`。**", "description": "小 X 参加了一场歌唱比赛。\n\n经过一路鏖战，小 X 终于挺进了决赛，他的对手是小 Y。\n\n这场歌唱比赛的冠军是由点赞数决定的，谁的点赞数高，谁就能夺冠。\n\n小 X 和小 Y 依次演唱完自己的最后一首歌曲后，他们最终的点赞数确定了下来。\n\n揭晓冠军的时刻终于到来了，主持人为了增加悬念，决定从小 X 与小 Y 的点赞数的最后一位开始，依次比较。\n\n比如，小 X 的点赞数是 $37$，小 Y 的点赞数是 $28$。首先比较最后一位，小 X 是 $7$，小 Y 是 $8$，此时小 Y 暂时领先。再加上前一位，小 X 是 $37$，小 Y 是 $28$，此时小 X 暂时领先。比较结束，如果我们用 `X` 代表小 X 暂时领先，`Y` 代表小 Y 暂时领先，那么可以写下一个字符串 `XY`。\n\n再比如，小 X 的点赞数是 $137$，小 Y 的点赞数是 $47$。如果我们再用 `Z` 表示小 X 与小 Y 的点赞数暂时一样，那么写下的字符串应该为 `XYZ`。\n\n你作为一个精通 OI 的神仙，自然知道这种比较方式是非常不科学的，这样只是在无端拖延时间罢了，但是你却对最后写下的这个字符串很感兴趣。\n\n现在，你得到了这个最后写下的字符串，你需要构造出一种可能的小 X 与小 Y 的点赞数。\n\n当然，有可能不存在任何一种情况的点赞数满足这个字符串，那么你只需要输出 `-1` 即可。\n\n为了方便你输出，请用前导零来补足位数。", "inputFormat": "一行一个字符串 $s$，表示最后写下的字符串。", "outputFormat": "如果有解：\n\n- 第一行一个整数，表示小 X 的点赞数。\n- 第二行一个整数，表示小 Y 的点赞数。\n\n如果无解：\n\n- 一行一个整数 `-1`。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（11 points）：$\\text{len}(s) = 1$。\n- Subtask 2（42 points）：$s_i \\in \\{\\texttt{X},\\texttt{Y}\\}$。\n- Subtask 3（21 points）：数据保证有解。\n- Subtask 4（26 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$s_i \\in \\{\\texttt{X},\\texttt{Y},\\texttt{Z}\\}$，$1 \\le \\text{len}(s) \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5596", "type": "P", "difficulty": 5, "samples": [["5 15\n", "1\n"], ["4 4\n", "inf\n"], ["12 6\n", "0\n"], ["96 96\n", "7\n"], ["10000 9999997\n", "6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2019", "洛谷原创", "洛谷月赛"], "title": "【XR-4】题", "background": "**赛时提醒：$0$ 是自然数，自然数就是非负整数。**", "description": "小 X 遇到了一道题：\n\n给定自然数 $a,b$，求满足下列条件的自然数对 $(x,y)$ 的个数：\n\n$$y^2 - x^2 = ax + b$$\n\n他不会，只好求助于精通数学的你。\n\n如果有无限多个自然数对满足条件，那么你只需要输出 `inf` 即可。", "inputFormat": "一行两个整数 $a,b$。", "outputFormat": "如果个数有限，一行一个整数，表示个数。\n\n如果个数无限，一行一个字符串 `inf`。", "hint": "#### 【样例 #1 说明】\n\n$$(x,y) = (6,9)$$\n\n---\n\n#### 【数据范围】**\n\n**本题采用捆绑测试**。\n\n- Subtask 1（3 points）：$a = b = 0$。\n- Subtask 2（6 points）：$0 \\le a,b \\le 2$，不存在无限个数的情况。\n- Subtask 3（9 points）：$0 \\le a,b \\le 100$，不存在无限个数的情况。\n- Subtask 4（13 points）：$0 \\le a,b \\le 10^3$，不存在无限个数的情况。\n- Subtask 5（14 points）：$0 \\le a \\le 10^4$，$0 \\le b \\le 10^7$。\n- Subtask 6（14 points）：$a = 0$。\n- Subtask 7（14 points）：$b = 0$。\n- Subtask 8（27 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$0 \\le a \\le 10^8$，$0\\le b \\le 10^{15}$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Problem", "background": "**Reminder during the contest: $0$ is a natural number, and natural numbers are non-negative integers.**", "description": "X encountered a problem:\n\nGiven natural numbers $a, b$, find the number of pairs of natural numbers $(x, y)$ that satisfy:\n\n$$y^2 - x^2 = ax + b$$\n\nHe cannot solve it, so he asks you, who are good at math, for help.\n\nIf there are infinitely many pairs of natural numbers that satisfy the condition, you only need to output `inf`.", "inputFormat": "One line with two integers $a, b$.", "outputFormat": "If the number is finite, output one integer in one line, representing the count.\n\nIf the number is infinite, output one string `inf` in one line.", "hint": "#### Sample #1 Explanation\n\n$$(x,y) = (6,9)$$\n\n---\n\n#### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (3 points): $a = b = 0$.\n- Subtask 2 (6 points): $0 \\le a,b \\le 2$, there is no case with an infinite number of solutions.\n- Subtask 3 (9 points): $0 \\le a,b \\le 100$, there is no case with an infinite number of solutions.\n- Subtask 4 (13 points): $0 \\le a,b \\le 10^3$, there is no case with an infinite number of solutions.\n- Subtask 5 (14 points): $0 \\le a \\le 10^4$, $0 \\le b \\le 10^7$.\n- Subtask 6 (14 points): $a = 0$.\n- Subtask 7 (14 points): $b = 0$.\n- Subtask 8 (27 points): no special constraints.\n\nFor $100\\%$ of the testdata, $0 \\le a \\le 10^8$, $0 \\le b \\le 10^{15}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】题", "background": "**赛时提醒：$0$ 是自然数，自然数就是非负整数。**", "description": "小 X 遇到了一道题：\n\n给定自然数 $a,b$，求满足下列条件的自然数对 $(x,y)$ 的个数：\n\n$$y^2 - x^2 = ax + b$$\n\n他不会，只好求助于精通数学的你。\n\n如果有无限多个自然数对满足条件，那么你只需要输出 `inf` 即可。", "inputFormat": "一行两个整数 $a,b$。", "outputFormat": "如果个数有限，一行一个整数，表示个数。\n\n如果个数无限，一行一个字符串 `inf`。", "hint": "#### 【样例 #1 说明】\n\n$$(x,y) = (6,9)$$\n\n---\n\n#### 【数据范围】**\n\n**本题采用捆绑测试**。\n\n- Subtask 1（3 points）：$a = b = 0$。\n- Subtask 2（6 points）：$0 \\le a,b \\le 2$，不存在无限个数的情况。\n- Subtask 3（9 points）：$0 \\le a,b \\le 100$，不存在无限个数的情况。\n- Subtask 4（13 points）：$0 \\le a,b \\le 10^3$，不存在无限个数的情况。\n- Subtask 5（14 points）：$0 \\le a \\le 10^4$，$0 \\le b \\le 10^7$。\n- Subtask 6（14 points）：$a = 0$。\n- Subtask 7（14 points）：$b = 0$。\n- Subtask 8（27 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$0 \\le a \\le 10^8$，$0\\le b \\le 10^{15}$。", "locale": "zh-CN"}}}
{"pid": "P5597", "type": "P", "difficulty": 6, "samples": [["1313000\n", "3\n"], ["333003003300300\n", "15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["树形数据结构", "洛谷月赛"], "title": "【XR-4】复读", "background": "**赛时提醒：当机器人在这棵完全二叉树的根时，执行 `U` 是非法的，即你需要保证不可能出现这种情况。**\n\n**赛时提醒：这棵二叉树是无限向下延伸的，即所有节点均有左子节点与右子节点，除了根的所有节点均有父亲。**", "description": "小 X 捡到了一台复读机，这台复读机可以向机器人发号施令。机器人将站在一棵完全二叉树的根上，完全二叉树是无限延伸的。你将向复读机录入一串指令，这串指令单个字符可以是：\n\n* `L`：命令机器人向当前节点的左子走；\n* `R`：命令机器人向当前节点的右子走；\n* `U`：命令机器人向当前节点的父亲走（若没有，则命令非法）。\n\n录入指令后，复读机将会把指令无限复读下去。比如命令为 `LR`，那么机器人会遵从 `LRLRLRLR...` 一直走下去。\n\n这棵完全二叉树上有一个 $n$ 个节点的连通块，保证这个连通块包含根节点。连通块上的每个节点都埋有宝藏，机器人到达过的地方如果有宝藏，则会将其开采。如果一个地方没有宝藏，机器人也可以到那里去。机器人也可以反复经过一个地方。\n\n显然，这个连通块本身也是一棵二叉树。\n\n现在，有人告诉了小 X 埋有宝藏的这棵二叉树的前序遍历，小 X 需要寻找到一条尽量短的指令，使得机器人能够挖掘出所有宝藏。", "inputFormat": "一行一个字符串，由 `0123` 中的字符组成，表示埋有宝藏的这棵二叉树的前序遍历。\n\n* `0`：表示这是一个没有儿子的节点。\n* `1`：表示这是一个只有左子的节点。\n* `2`：表示这是一个只有右子的节点。\n* `3`：表示这是一个既有左子又有右子的节点。", "outputFormat": "一个整数，表示最短指令的长度。", "hint": "【样例 1 说明】\n\n一种可行的最短指令为 `LRU`。\n\n---\n\n**本题采用捆绑测试。**\n\n- Subtask 1（31 points）：$2 \\le n \\le 10$。\n- Subtask 2（32 points）：$2 \\le n \\le 200$。\n- Subtask 3（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 2 \\times 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Repeater.", "background": "**Contest reminder: When the robot is at the root of this complete binary tree, executing `U` is illegal. That is, you must ensure this can never happen.**\n\n**Contest reminder: This binary tree extends infinitely downward, meaning every node has a left child and a right child. All nodes except the root have a parent.**", "description": "X found a repeater machine, which can be used to give commands to a robot. The robot will stand at the root of a complete binary tree, and this complete binary tree extends infinitely. You will input a string of commands into the repeater. Each character of the command string can be:\n\n* `L`: command the robot to move to the left child of the current node.\n* `R`: command the robot to move to the right child of the current node.\n* `U`: command the robot to move to the parent of the current node (if there is no parent, then the command is illegal).\n\nAfter the commands are entered, the repeater will repeat them forever. For example, if the command is `LR`, then the robot will follow `LRLRLRLR...` and keep moving.\n\nOn this complete binary tree, there is a connected component containing $n$ nodes, and it is guaranteed that this component contains the root. Every node in the component has a treasure buried. If the robot ever reaches a place with a treasure, it will mine it. If a place has no treasure, the robot can still go there. The robot may also pass through the same place multiple times.\n\nClearly, this connected component itself is also a binary tree.\n\nNow, someone tells X the preorder traversal of this treasure-burying binary tree. X needs to find a command string as short as possible so that the robot can mine all treasures.", "inputFormat": "One line containing a string consisting of characters from `0123`, representing the preorder traversal of the treasure-burying binary tree.\n\n* `0`: a node with no children.\n* `1`: a node with only a left child.\n* `2`: a node with only a right child.\n* `3`: a node with both a left child and a right child.", "outputFormat": "One integer, the length of the shortest command string.", "hint": "[Sample 1 Explanation]\n\nOne possible shortest command string is `LRU`.\n\n---\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (31 points): $2 \\le n \\le 10$.\n- Subtask 2 (32 points): $2 \\le n \\le 200$.\n- Subtask 3 (37 points): no special constraints.\n\nFor $100\\%$ of the data, $2 \\le n \\le 2 \\times 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】复读", "background": "**赛时提醒：当机器人在这棵完全二叉树的根时，执行 `U` 是非法的，即你需要保证不可能出现这种情况。**\n\n**赛时提醒：这棵二叉树是无限向下延伸的，即所有节点均有左子节点与右子节点，除了根的所有节点均有父亲。**", "description": "小 X 捡到了一台复读机，这台复读机可以向机器人发号施令。机器人将站在一棵完全二叉树的根上，完全二叉树是无限延伸的。你将向复读机录入一串指令，这串指令单个字符可以是：\n\n* `L`：命令机器人向当前节点的左子走；\n* `R`：命令机器人向当前节点的右子走；\n* `U`：命令机器人向当前节点的父亲走（若没有，则命令非法）。\n\n录入指令后，复读机将会把指令无限复读下去。比如命令为 `LR`，那么机器人会遵从 `LRLRLRLR...` 一直走下去。\n\n这棵完全二叉树上有一个 $n$ 个节点的连通块，保证这个连通块包含根节点。连通块上的每个节点都埋有宝藏，机器人到达过的地方如果有宝藏，则会将其开采。如果一个地方没有宝藏，机器人也可以到那里去。机器人也可以反复经过一个地方。\n\n显然，这个连通块本身也是一棵二叉树。\n\n现在，有人告诉了小 X 埋有宝藏的这棵二叉树的前序遍历，小 X 需要寻找到一条尽量短的指令，使得机器人能够挖掘出所有宝藏。", "inputFormat": "一行一个字符串，由 `0123` 中的字符组成，表示埋有宝藏的这棵二叉树的前序遍历。\n\n* `0`：表示这是一个没有儿子的节点。\n* `1`：表示这是一个只有左子的节点。\n* `2`：表示这是一个只有右子的节点。\n* `3`：表示这是一个既有左子又有右子的节点。", "outputFormat": "一个整数，表示最短指令的长度。", "hint": "【样例 1 说明】\n\n一种可行的最短指令为 `LRU`。\n\n---\n\n**本题采用捆绑测试。**\n\n- Subtask 1（31 points）：$2 \\le n \\le 10$。\n- Subtask 2（32 points）：$2 \\le n \\le 200$。\n- Subtask 3（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 2 \\times 10^3$。", "locale": "zh-CN"}}}
{"pid": "P5598", "type": "P", "difficulty": 7, "samples": [["2 2\n1 2\n", "3\n"], ["4 7\n1 2 8 9\n", "28\n"], ["15 5\n1 5 26 1 0 5 0 6 7 51 1 5 26 1 0\n", "124\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "Lucas 定理", "洛谷月赛"], "title": "【XR-4】混乱度", "background": "", "description": "小 X 有 $n$ 种颜色的球，其中第 $i$ 种颜色的球共有 $a_i$ 个，同色的球无法区分。定义第 $l \\sim r$ 种颜色的混乱度 $f(l, r)$ 为：将第 $l \\sim r$ 种颜色的所有球排成一排，总共的方案数对 $p$ 取模后的值。小 X 想请你帮忙计算下列式子的值：\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r) $$", "inputFormat": "第一行两个整数 $n, p$。\n\n第二行 $n$ 个整数 $a_i$。\n", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 1 说明】\n\n$$f(1,1) = 1 \\bmod 2 = 1$$\n\n$$f(1,2) = 3 \\bmod 2 = 1$$\n\n$$f(2,2) = 1 \\bmod 2 = 1$$\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r)  = 3$$\n\n---\n\n**本题采用捆绑测试。**\n\n- Subtask 1（31 points）：$1 \\le n \\le 5 \\times 10^5$，$a_i$ 在 $[0, 10^5]$ 内均匀随机，时限 $1.5 \\text{ s}$。\n- Subtask 2（32 points）：$1 \\le n \\le 5 \\times 10^4$，时限 $5 \\text{ s}$。\n- Subtask 3（37 points）：无特殊限制，时限 $2.5 \\text{ s}$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^5$，$0 \\le a_i \\le 10^{18}$，$p \\in \\{2,3,5,7\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Disorder Degree", "background": "", "description": "Xiao X has balls of $n$ different colors. For the $i$-th color, there are $a_i$ balls. Balls of the same color are indistinguishable. Define the disorder degree $f(l, r)$ for colors $l \\sim r$ as follows: line up all balls of colors $l \\sim r$ in a row, and let $f(l, r)$ be the total number of distinct arrangements modulo $p$. Xiao X wants you to help compute the value of:\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r) $$", "inputFormat": "The first line contains two integers $n, p$.\n\nThe second line contains $n$ integers $a_i$.", "outputFormat": "Output one integer in one line, representing the answer.", "hint": "[Sample 1 Explanation]\n\n$$f(1,1) = 1 \\bmod 2 = 1$$\n\n$$f(1,2) = 3 \\bmod 2 = 1$$\n\n$$f(2,2) = 1 \\bmod 2 = 1$$\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r)  = 3$$\n\n---\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (31 points): $1 \\le n \\le 5 \\times 10^5$, $a_i$ is uniformly random in $[0, 10^5]$, time limit $1.5 \\text{ s}$.\n- Subtask 2 (32 points): $1 \\le n \\le 5 \\times 10^4$, time limit $5 \\text{ s}$.\n- Subtask 3 (37 points): no special constraints, time limit $2.5 \\text{ s}$.\n\nFor $100\\%$ of the data, $1 \\le n \\le 5 \\times 10^5$, $0 \\le a_i \\le 10^{18}$, $p \\in \\{2,3,5,7\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】混乱度", "background": "", "description": "小 X 有 $n$ 种颜色的球，其中第 $i$ 种颜色的球共有 $a_i$ 个，同色的球无法区分。定义第 $l \\sim r$ 种颜色的混乱度 $f(l, r)$ 为：将第 $l \\sim r$ 种颜色的所有球排成一排，总共的方案数对 $p$ 取模后的值。小 X 想请你帮忙计算下列式子的值：\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r) $$", "inputFormat": "第一行两个整数 $n, p$。\n\n第二行 $n$ 个整数 $a_i$。\n", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 1 说明】\n\n$$f(1,1) = 1 \\bmod 2 = 1$$\n\n$$f(1,2) = 3 \\bmod 2 = 1$$\n\n$$f(2,2) = 1 \\bmod 2 = 1$$\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r)  = 3$$\n\n---\n\n**本题采用捆绑测试。**\n\n- Subtask 1（31 points）：$1 \\le n \\le 5 \\times 10^5$，$a_i$ 在 $[0, 10^5]$ 内均匀随机，时限 $1.5 \\text{ s}$。\n- Subtask 2（32 points）：$1 \\le n \\le 5 \\times 10^4$，时限 $5 \\text{ s}$。\n- Subtask 3（37 points）：无特殊限制，时限 $2.5 \\text{ s}$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^5$，$0 \\le a_i \\le 10^{18}$，$p \\in \\{2,3,5,7\\}$。", "locale": "zh-CN"}}}
{"pid": "P5599", "type": "P", "difficulty": 7, "samples": [["6 2 5\nBBABBA\nBB\nBAB\n1 1 6\n2 3 5 A\n1 2 3\n2 1 6 B\n1 1 5\n", "3\n0\n4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "O2优化", "AC 自动机", "洛谷月赛"], "title": "【XR-4】文本编辑器", "background": "**赛时提醒：本题输入数据是 Windows 格式，而非 Linux 格式，所以在每一行末尾的 `\\n` 之前有一个多余的 `\\r` 字符。请使用 `scanf` 或 `cin` 读入数据，而非 `getline`，因为后者会多读入一个 `\\r`。**", "description": "小 X 在制作一个文本编辑器，现在需要实现最基本的“**查找和替换**”功能。\n\n在文本编辑器中，文件是以一个长度为 $n$ 的字符串 $a$ 的形式存储的。\n\n同时，用户拥有一个包含 $m$ 个**单词**的字典，每个单词都是一个字符串，称第 $i$ 个单词为 $s_i$。\n\n接下来定义**查找和替换**功能：\n\n- **查找功能**：有两个参数 $l, r$，表示询问对于字典中的每个**单词** $s_i$，$a[l : r]$ 中 $s_i$ 的出现次数之和。  \n即询问 $\\displaystyle \\sum_{i=1}^{m} \\mathrm{occur}(s_i, a[l : r])$，其中 $\\mathrm{occur}(s, t)$ 表示字符串 $s$ 在字符串 $t$ 中的出现次数。\n\n- **替换功能**：有三个参数 $l, r, t$，其中 $t$ 是一个字符串，表示将 $a[l : r]$ 替换为 $t$ 不断重复的结果。  \n即如果把 $\\texttt{Mds72SKsLL}$ 替换为 $\\texttt{Rabb}$ 不断重复的结果，则原字符串变为 $\\texttt{RabbRabbRa}$。\n\n用户给出了 $q$ 个操作，每个操作是**查找**或**替换**之一，你需要正确回答每个**查找**操作的答案。", "inputFormat": "第一行三个整数 $n, m, q$，依次表示文件 $a$ 的长度，字典中的单词数，询问的个数。\n\n第二行一个长度为 $n$ 的字符串 $a$，表示初始文件。\n\n接下来 $m$ 行，第 $i$ 行一个字符串，表示第 $i$ 个单词 $s_i$。\n\n接下来 $q$ 行，每行表示一个操作：  \n每行的第一个数 $\\mathrm{op}$ 表示此次操作的类型；  \n若 $\\mathrm{op} = 1$，则接下来两个整数 $l, r$，表示这是一次**查找**操作，参数为 $l, r$；  \n若 $\\mathrm{op} = 2$，则接下来两个整数 $l, r$ 和一个字符串 $t$，表示这是一次**替换**操作，参数为 $l, r, t$。", "outputFormat": "对于每个**查找**操作，一行一个整数，表示本次查找操作的答案。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（7 points）：$n, m, q \\le 50$，所有字符串长度 $\\le 50$，时限 $1\\text{s}$。\n- Subtask 2（7 points）：$n, q \\le 3000$，时限 $1\\text{s}$。\n- Subtask 3（13 points）：$m = 1$，时限 $2\\text{s}$。\n- Subtask 4（17 points）：没有**替换**操作，即 $\\mathrm{op} = 1$，时限 $2\\text{s}$。\n- Subtask 5（18 points）：$n, q \\le 8 \\times 10^4$，$\\displaystyle \\sum |s_i| \\le 50$，$\\displaystyle \\sum |t| \\le 8 \\times 10^4$，时限 $1\\text{s}$。\n- Subtask 6（13 points）：$n, q \\le 5\\times 10^4$，$\\displaystyle \\sum |s_i| \\le 5\\times 10^4$，$\\displaystyle \\sum |t| \\le 5\\times 10^4$，时限 $1\\text{s}$。\n- Subtask 7（25 points）：无特殊限制，时限 $2\\text{s}$。\n\n对于 $100\\%$ 的数据：  \n对 $n, m, q, l, r, \\mathrm{op}$ 的限制：$1 \\le l \\le r \\le n \\le 10^6$，$1 \\le m, q \\le 10^5$，$\\mathrm{op} \\in \\{ 1, 2 \\}$。  \n对字符串长度的限制：$|s_i| \\le 50$，$\\displaystyle \\sum |s_i| \\le 2 \\times 10^5$，$\\displaystyle \\sum |t| \\le 10^6$。  \n所有字符串保证不为空串，且出现的字符属于集合 $\\mathbf{\\Sigma}$，其中 $\\mathbf{\\Sigma} = [\\texttt a, \\texttt z] \\cup [\\texttt A, \\texttt Z] \\cup [\\texttt 0, \\texttt 9]$，即所有大小写英文字母以及数字，故 $|\\mathbf{\\Sigma}| = 62$。\n\n**需要特别注意的是，与文件相比，单词的长度是非常小的。在解题时你可能需要利用这一点。**\n\n----\n\n**【一些定义】**\n\n对于一个长度为 $\\mathrm{len}$ 的字符串 $s$，符号 $s[l : r]$（$1 \\le l \\le r \\le \\mathrm{len}$）表示 $s$ 中从 $l$ 到 $r$ 的**子串**。即 $s$ 中从第 $l$ 个字符到第 $r$ 个字符（包含端点）连续拼接在一起形成的字符串。  \n对于一个字符串 $s$，符号 $|s|$ 表示它的长度。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Text Editor", "background": "**Reminder during the contest: The input for this problem uses Windows line endings, not Linux line endings, so there is an extra `\\r` character before `\\n` at the end of each line. Please use `scanf` or `cin` to read the input, rather than `getline`, because the latter will read an extra `\\r`.**", "description": "Little X is building a text editor and now needs to implement the most basic “**find and replace**” feature.\n\nIn the text editor, the file is stored as a string $a$ of length $n$.\n\nMeanwhile, the user has a dictionary containing $m$ **words**. Each word is a string, and the $i$-th word is denoted by $s_i$.\n\nNext, define the **find and replace** feature:\n\n- **Find**: There are two parameters $l, r$, asking for the sum, over every **word** $s_i$ in the dictionary, of the number of occurrences of $s_i$ in $a[l : r]$.  \nThat is, compute $\\displaystyle \\sum_{i=1}^{m} \\mathrm{occur}(s_i, a[l : r])$, where $\\mathrm{occur}(s, t)$ denotes the number of occurrences of string $s$ in string $t$.\n\n- **Replace**: There are three parameters $l, r, t$, where $t$ is a string, meaning to replace $a[l : r]$ with the result of repeating $t$ endlessly and taking the needed prefix.  \nFor example, if we replace $\\texttt{Mds72SKsLL}$ with the endlessly repeated string $\\texttt{Rabb}$, then the original string becomes $\\texttt{RabbRabbRa}$.\n\nThe user provides $q$ operations, each being either **find** or **replace**. You need to output the correct answer for every **find** operation.", "inputFormat": "The first line contains three integers $n, m, q$, representing the length of the file $a$, the number of words in the dictionary, and the number of queries.\n\nThe second line contains a string $a$ of length $n$, representing the initial file.\n\nThe next $m$ lines each contain a string; the $i$-th line is the $i$-th word $s_i$.\n\nThe next $q$ lines each describe an operation:  \nThe first number on each line is $\\mathrm{op}$, indicating the type of operation.  \nIf $\\mathrm{op} = 1$, then two integers $l, r$ follow, meaning this is a **find** operation with parameters $l, r$.  \nIf $\\mathrm{op} = 2$, then two integers $l, r$ and a string $t$ follow, meaning this is a **replace** operation with parameters $l, r, t$.", "outputFormat": "For each **find** operation, output one integer per line, representing the answer to this find query.", "hint": "**This problem uses bundled testdata.**\n\n- Subtask 1 (7 points): $n, m, q \\le 50$, all string lengths $\\le 50$, time limit $1\\text{s}$.\n- Subtask 2 (7 points): $n, q \\le 3000$, time limit $1\\text{s}$.\n- Subtask 3 (13 points): $m = 1$, time limit $2\\text{s}$.\n- Subtask 4 (17 points): There are no **replace** operations, i.e. $\\mathrm{op} = 1$, time limit $2\\text{s}$.\n- Subtask 5 (18 points): $n, q \\le 8 \\times 10^4$, $\\displaystyle \\sum |s_i| \\le 50$, $\\displaystyle \\sum |t| \\le 8 \\times 10^4$, time limit $1\\text{s}$.\n- Subtask 6 (13 points): $n, q \\le 5\\times 10^4$, $\\displaystyle \\sum |s_i| \\le 5\\times 10^4$, $\\displaystyle \\sum |t| \\le 5\\times 10^4$, time limit $1\\text{s}$.\n- Subtask 7 (25 points): No special constraints, time limit $2\\text{s}$.\n\nFor $100\\%$ of the data:  \nConstraints on $n, m, q, l, r, \\mathrm{op}$: $1 \\le l \\le r \\le n \\le 10^6$, $1 \\le m, q \\le 10^5$, $\\mathrm{op} \\in \\{ 1, 2 \\}$.  \nConstraints on string lengths: $|s_i| \\le 50$, $\\displaystyle \\sum |s_i| \\le 2 \\times 10^5$, $\\displaystyle \\sum |t| \\le 10^6$.  \nAll strings are guaranteed to be non-empty, and all characters belong to the set $\\mathbf{\\Sigma}$, where $\\mathbf{\\Sigma} = [\\texttt a, \\texttt z] \\cup [\\texttt A, \\texttt Z] \\cup [\\texttt 0, \\texttt 9]$, i.e. all lowercase letters, uppercase letters, and digits, so $|\\mathbf{\\Sigma}| = 62$.\n\n**A special note: Compared to the file, the words are very short. You may need to make use of this when solving the problem.**\n\n----\n\n**[Some definitions]**\n\nFor a string $s$ of length $\\mathrm{len}$, the notation $s[l : r]$ ($1 \\le l \\le r \\le \\mathrm{len}$) denotes the **substring** of $s$ from $l$ to $r$. That is, the string formed by concatenating the $l$-th through the $r$-th characters of $s (inclusive) in order.  \nFor a string $s$, the notation $|s|$ denotes its length.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】文本编辑器", "background": "**赛时提醒：本题输入数据是 Windows 格式，而非 Linux 格式，所以在每一行末尾的 `\\n` 之前有一个多余的 `\\r` 字符。请使用 `scanf` 或 `cin` 读入数据，而非 `getline`，因为后者会多读入一个 `\\r`。**", "description": "小 X 在制作一个文本编辑器，现在需要实现最基本的“**查找和替换**”功能。\n\n在文本编辑器中，文件是以一个长度为 $n$ 的字符串 $a$ 的形式存储的。\n\n同时，用户拥有一个包含 $m$ 个**单词**的字典，每个单词都是一个字符串，称第 $i$ 个单词为 $s_i$。\n\n接下来定义**查找和替换**功能：\n\n- **查找功能**：有两个参数 $l, r$，表示询问对于字典中的每个**单词** $s_i$，$a[l : r]$ 中 $s_i$ 的出现次数之和。  \n即询问 $\\displaystyle \\sum_{i=1}^{m} \\mathrm{occur}(s_i, a[l : r])$，其中 $\\mathrm{occur}(s, t)$ 表示字符串 $s$ 在字符串 $t$ 中的出现次数。\n\n- **替换功能**：有三个参数 $l, r, t$，其中 $t$ 是一个字符串，表示将 $a[l : r]$ 替换为 $t$ 不断重复的结果。  \n即如果把 $\\texttt{Mds72SKsLL}$ 替换为 $\\texttt{Rabb}$ 不断重复的结果，则原字符串变为 $\\texttt{RabbRabbRa}$。\n\n用户给出了 $q$ 个操作，每个操作是**查找**或**替换**之一，你需要正确回答每个**查找**操作的答案。", "inputFormat": "第一行三个整数 $n, m, q$，依次表示文件 $a$ 的长度，字典中的单词数，询问的个数。\n\n第二行一个长度为 $n$ 的字符串 $a$，表示初始文件。\n\n接下来 $m$ 行，第 $i$ 行一个字符串，表示第 $i$ 个单词 $s_i$。\n\n接下来 $q$ 行，每行表示一个操作：  \n每行的第一个数 $\\mathrm{op}$ 表示此次操作的类型；  \n若 $\\mathrm{op} = 1$，则接下来两个整数 $l, r$，表示这是一次**查找**操作，参数为 $l, r$；  \n若 $\\mathrm{op} = 2$，则接下来两个整数 $l, r$ 和一个字符串 $t$，表示这是一次**替换**操作，参数为 $l, r, t$。", "outputFormat": "对于每个**查找**操作，一行一个整数，表示本次查找操作的答案。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（7 points）：$n, m, q \\le 50$，所有字符串长度 $\\le 50$，时限 $1\\text{s}$。\n- Subtask 2（7 points）：$n, q \\le 3000$，时限 $1\\text{s}$。\n- Subtask 3（13 points）：$m = 1$，时限 $2\\text{s}$。\n- Subtask 4（17 points）：没有**替换**操作，即 $\\mathrm{op} = 1$，时限 $2\\text{s}$。\n- Subtask 5（18 points）：$n, q \\le 8 \\times 10^4$，$\\displaystyle \\sum |s_i| \\le 50$，$\\displaystyle \\sum |t| \\le 8 \\times 10^4$，时限 $1\\text{s}$。\n- Subtask 6（13 points）：$n, q \\le 5\\times 10^4$，$\\displaystyle \\sum |s_i| \\le 5\\times 10^4$，$\\displaystyle \\sum |t| \\le 5\\times 10^4$，时限 $1\\text{s}$。\n- Subtask 7（25 points）：无特殊限制，时限 $2\\text{s}$。\n\n对于 $100\\%$ 的数据：  \n对 $n, m, q, l, r, \\mathrm{op}$ 的限制：$1 \\le l \\le r \\le n \\le 10^6$，$1 \\le m, q \\le 10^5$，$\\mathrm{op} \\in \\{ 1, 2 \\}$。  \n对字符串长度的限制：$|s_i| \\le 50$，$\\displaystyle \\sum |s_i| \\le 2 \\times 10^5$，$\\displaystyle \\sum |t| \\le 10^6$。  \n所有字符串保证不为空串，且出现的字符属于集合 $\\mathbf{\\Sigma}$，其中 $\\mathbf{\\Sigma} = [\\texttt a, \\texttt z] \\cup [\\texttt A, \\texttt Z] \\cup [\\texttt 0, \\texttt 9]$，即所有大小写英文字母以及数字，故 $|\\mathbf{\\Sigma}| = 62$。\n\n**需要特别注意的是，与文件相比，单词的长度是非常小的。在解题时你可能需要利用这一点。**\n\n----\n\n**【一些定义】**\n\n对于一个长度为 $\\mathrm{len}$ 的字符串 $s$，符号 $s[l : r]$（$1 \\le l \\le r \\le \\mathrm{len}$）表示 $s$ 中从 $l$ 到 $r$ 的**子串**。即 $s$ 中从第 $l$ 个字符到第 $r$ 个字符（包含端点）连续拼接在一起形成的字符串。  \n对于一个字符串 $s$，符号 $|s|$ 表示它的长度。", "locale": "zh-CN"}}}
{"pid": "P5600", "type": "P", "difficulty": 7, "samples": [["2\n0.0000000000 0.0000000000\n0.0000000000 1.0000000000\n1\n1 2\n0\n0\n0.8660254038 0.5000000000\n11 10 9 8 7 6 5 4 3 2\n", "2\n1 0.0000000000 0.0000000000 0.0000000000 1.0000000000\n1 0.0000000000 1.0000000000 0.0000000000 0.0000000000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["提交答案", "Special Judge", "O2优化", "洛谷月赛", "平面几何"], "title": "【XR-4】尺规作图", "background": "这是一道提交答案（人类智慧）题。", "description": "你有若干个已知的几何图形，你需要通过尺规作图得到一个要求的点。你需要在规定步数之内找到这个点。\n\n你可以进行的操作如下：\n\n1. 以一个已知点为圆心，另一个已知点为圆上一点作圆。\n\n2. 连接两个已知点形成一条直线。\n\n你需要输出你的作图步骤。", "inputFormat": "第一行一个整数，表示测试点编号。\n\n第二行一个整数 $n$，表示已知点的数量。\n\n接下来 $n$ 行，第 $i$ 行两个实数 $x_i, y_i$，表示第 $i$ 个点的坐标。\n\n接下来一个整数 $n_1$，表示已知线段的数量。\n\n接下来 $n_1$ 行，每一行两个整数 $u, v$，表示有一条连接点 $u$ 和点 $v$ 的线段。\n\n接下来一个整数 $n_2$，表示已知直线的数量。\n\n接下来 $n_2$ 行，每一行两个整数 $u, v$，表示有一条经过点 $u$ 和点 $v$ 的直线。\n\n接下来一个整数 $n_3$，表示已知圆的数量。\n\n接下来 $n_3$ 行，每一行两个整数 $u, v$，表示有一个以点 $u$ 为圆心，点 $v$ 为圆上一点的圆。\n\n接下来两个实数 $x, y$，表示要求点的坐标。\n\n接下来 $10$ 个整数 $a_1$ 到 $a_{10}$，表示此测试点的评分参数，详见说明。", "outputFormat": "第一行一个整数 $m$，表示你需要的步数。\n\n接下来 $m$ 行描述你的作图步骤：\n\n首先一个整数 $1$ 或 $2$，$1$ 表示你要画一个圆，$2$ 表示你要连一条直线。\n\n接下来四个实数 $x_1, y_1, x_2, y_2$：  \n如果你要画一个圆，表示你要以 $(x_1,y_1)$ 为圆心，$(x_2,y_2)$ 为圆上一点画圆；  \n如果你要连一条线，表示你要将 $(x_1,y_1)$ 与 $(x_2,y_2)$ 连接起来。", "hint": "对于每一个测试点，如果你用的步数小于等于前 $i$ 个评分参数，那么你会得到 $i$ 分。\n\n注意事项如下：\n\n1. **所有的 $x, y$ 必须是你已经得到的点**，这里的已经得到是指输入数据中的点或者已知几何图形的交点。（也就是说你不能随便选择一个点来作图，也不能通过选择一个合适的点来得到要求的点）  \n   更准确地说，每次你输出一个坐标，Special Judge 会选择当前你已经得到的所有点中和你的输入坐标欧几里得距离最近的点作为你这一次的选择点。如果距离最近的点距离大于了 $10^{-5}$，那么这次操作会被判定为不合法，同时这一个点你将得到 $0$ 分。\n\n2. 你不能根据圆心和半径作圆，而只能根据圆心和圆上一点作圆。\n\n3. **你画出的答案与要求的点绝对误差或相对误差不超过 $10^{-5}$ 即为正确**（因为不知道怎么写没有误差的 Special Judge）。  \n   更准确地说，假设你得到的点是 $(x_1, y_1)$，而要求的点是 $(x_2, y_2)$，则你的输出被认为正确，当且仅当 $\\dfrac{|x_1-x_2|}{\\max(|x_2|, 1)} \\le 10^{-5}$ 且 $\\dfrac{|y_1-y_2|}{\\max(|y_2|, 1)} \\le 10^{-5}$。\n\n4. 下发文件中的 `data1.in` 到 `data10.in` 分别为 $10$ 个输入数据，其中第 $1,2,3,7,8$ 这五个测试点配有图解。\n\n5. 下发的 checker 可以判断你的得分。使用方法如下（其中 `data.in` 是输入文件，`data.out` 是你的输出文件。）：  \n\n  - Windows-32/64：\n\n```\nchecker data.in data.out data.out\n```\n\n  - Linux/MacOS：\n\n```\n./checker data.in data.out data.out\n```\n\n6. 出题人拿不到 $100$ 分。\n\nupdate：checker 源码可以点击 [这里](/paste/capu9k2n) 查看，如果有需要改进的地方欢迎提出。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Straightedge and Compass Construction", "background": "This is an output-only (human intelligence) problem.", "description": "You are given several known geometric objects, and you need to construct a required point using straightedge and compass. You must find this point within a limited number of steps.\n\nYou can perform the following operations:\n\n1. Draw a circle with one known point as the center and another known point as a point on the circle.\n\n2. Connect two known points to form a straight line.\n\nYou need to output your construction steps.", "inputFormat": "The first line contains an integer, which is the test point ID.\n\nThe second line contains an integer $n$, which is the number of known points.\n\nThe next $n$ lines each contain two real numbers $x_i, y_i$, which are the coordinates of the $i$-th point.\n\nNext is an integer $n_1$, which is the number of known line segments.\n\nThe next $n_1$ lines each contain two integers $u, v$, meaning there is a line segment connecting point $u$ and point $v$.\n\nNext is an integer $n_2$, which is the number of known lines.\n\nThe next $n_2$ lines each contain two integers $u, v$, meaning there is a line passing through point $u$ and point $v$.\n\nNext is an integer $n_3$, which is the number of known circles.\n\nThe next $n_3$ lines each contain two integers $u, v$, meaning there is a circle centered at point $u$, with point $v$ on the circle.\n\nNext are two real numbers $x, y$, which are the coordinates of the required point.\n\nNext are $10$ integers $a_1$ to $a_{10}$, which are the scoring parameters for this test point. See the statement for details.", "outputFormat": "The first line contains an integer $m$, which is the number of steps you need.\n\nThe next $m$ lines describe your construction steps:\n\nFirst an integer $1$ or $2$. $1$ means you draw a circle, and $2$ means you draw a straight line.\n\nThen four real numbers $x_1, y_1, x_2, y_2$:  \nIf you draw a circle, it means you draw a circle centered at $(x_1, y_1)$ and with $(x_2, y_2)$ as a point on the circle.  \nIf you draw a line, it means you connect $(x_1, y_1)$ and $(x_2, y_2)$.", "hint": "For each test point, if your number of steps is less than or equal to the first $i$ scoring parameters, then you will get $i$ points.\n\nNotes:\n\n1. **All $x, y$ must be points you have already obtained.** “Already obtained” means points from the input, or intersection points of known geometric objects. (That is, you cannot choose an arbitrary point to construct with, and you cannot obtain the required point by choosing some suitable point.)  \n   More precisely, each time you output a coordinate, the Special Judge will choose, among all points you have currently obtained, the point whose Euclidean distance to your input coordinate is the smallest, as the point you selected this time. If this smallest distance is greater than $10^{-5}$, then this operation will be judged invalid, and for this test point you will get $0$ points.\n\n2. You cannot draw a circle from its center and radius. You can only draw a circle from its center and a point on the circle.\n\n3. **Your constructed answer is considered correct if the absolute error or relative error to the required point is at most $10^{-5}$** (because the author does not know how to write a Special Judge with no error).  \n   More precisely, suppose the point you obtained is $(x_1, y_1)$ and the required point is $(x_2, y_2)$. Then your output is considered correct if and only if $\\dfrac{|x_1-x_2|}{\\max(|x_2|, 1)} \\le 10^{-5}$ and $\\dfrac{|y_1-y_2|}{\\max(|y_2|, 1)} \\le 10^{-5}$.\n\n4. The provided files `data1.in` to `data10.in` are the $10$ input datasets. Among them, test points $1, 2, 3, 7, 8$ come with diagrams.\n\n5. The provided checker can compute your score. Usage is as follows (where `data.in` is the input file and `data.out` is your output file.):  \n\n  - Windows-32/64:\n\n```\nchecker data.in data.out data.out\n```\n\n  - Linux/MacOS：\n\n```\n./checker data.in data.out data.out\n```\n\n6. The problem setter cannot get $100$ points.\n\nupdate: You can click [here](/paste/capu9k2n) to view the checker source code. If you have ideas for improvements, feel free to suggest them.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】尺规作图", "background": "这是一道提交答案（人类智慧）题。", "description": "你有若干个已知的几何图形，你需要通过尺规作图得到一个要求的点。你需要在规定步数之内找到这个点。\n\n你可以进行的操作如下：\n\n1. 以一个已知点为圆心，另一个已知点为圆上一点作圆。\n\n2. 连接两个已知点形成一条直线。\n\n你需要输出你的作图步骤。", "inputFormat": "第一行一个整数，表示测试点编号。\n\n第二行一个整数 $n$，表示已知点的数量。\n\n接下来 $n$ 行，第 $i$ 行两个实数 $x_i, y_i$，表示第 $i$ 个点的坐标。\n\n接下来一个整数 $n_1$，表示已知线段的数量。\n\n接下来 $n_1$ 行，每一行两个整数 $u, v$，表示有一条连接点 $u$ 和点 $v$ 的线段。\n\n接下来一个整数 $n_2$，表示已知直线的数量。\n\n接下来 $n_2$ 行，每一行两个整数 $u, v$，表示有一条经过点 $u$ 和点 $v$ 的直线。\n\n接下来一个整数 $n_3$，表示已知圆的数量。\n\n接下来 $n_3$ 行，每一行两个整数 $u, v$，表示有一个以点 $u$ 为圆心，点 $v$ 为圆上一点的圆。\n\n接下来两个实数 $x, y$，表示要求点的坐标。\n\n接下来 $10$ 个整数 $a_1$ 到 $a_{10}$，表示此测试点的评分参数，详见说明。", "outputFormat": "第一行一个整数 $m$，表示你需要的步数。\n\n接下来 $m$ 行描述你的作图步骤：\n\n首先一个整数 $1$ 或 $2$，$1$ 表示你要画一个圆，$2$ 表示你要连一条直线。\n\n接下来四个实数 $x_1, y_1, x_2, y_2$：  \n如果你要画一个圆，表示你要以 $(x_1,y_1)$ 为圆心，$(x_2,y_2)$ 为圆上一点画圆；  \n如果你要连一条线，表示你要将 $(x_1,y_1)$ 与 $(x_2,y_2)$ 连接起来。", "hint": "对于每一个测试点，如果你用的步数小于等于前 $i$ 个评分参数，那么你会得到 $i$ 分。\n\n注意事项如下：\n\n1. **所有的 $x, y$ 必须是你已经得到的点**，这里的已经得到是指输入数据中的点或者已知几何图形的交点。（也就是说你不能随便选择一个点来作图，也不能通过选择一个合适的点来得到要求的点）  \n   更准确地说，每次你输出一个坐标，Special Judge 会选择当前你已经得到的所有点中和你的输入坐标欧几里得距离最近的点作为你这一次的选择点。如果距离最近的点距离大于了 $10^{-5}$，那么这次操作会被判定为不合法，同时这一个点你将得到 $0$ 分。\n\n2. 你不能根据圆心和半径作圆，而只能根据圆心和圆上一点作圆。\n\n3. **你画出的答案与要求的点绝对误差或相对误差不超过 $10^{-5}$ 即为正确**（因为不知道怎么写没有误差的 Special Judge）。  \n   更准确地说，假设你得到的点是 $(x_1, y_1)$，而要求的点是 $(x_2, y_2)$，则你的输出被认为正确，当且仅当 $\\dfrac{|x_1-x_2|}{\\max(|x_2|, 1)} \\le 10^{-5}$ 且 $\\dfrac{|y_1-y_2|}{\\max(|y_2|, 1)} \\le 10^{-5}$。\n\n4. 下发文件中的 `data1.in` 到 `data10.in` 分别为 $10$ 个输入数据，其中第 $1,2,3,7,8$ 这五个测试点配有图解。\n\n5. 下发的 checker 可以判断你的得分。使用方法如下（其中 `data.in` 是输入文件，`data.out` 是你的输出文件。）：  \n\n  - Windows-32/64：\n\n```\nchecker data.in data.out data.out\n```\n\n  - Linux/MacOS：\n\n```\n./checker data.in data.out data.out\n```\n\n6. 出题人拿不到 $100$ 分。\n\nupdate：checker 源码可以点击 [这里](/paste/capu9k2n) 查看，如果有需要改进的地方欢迎提出。", "locale": "zh-CN"}}}
{"pid": "P5601", "type": "P", "difficulty": 1, "samples": [["3 4\ndecoak yes\nduliuchutiren nonono\ncsps noiptg\ndecoak yes no qwq qaq\ncsps noiptg noippj noi cspj\ndecoak qwq qaq yesyes yes\nduliuchutiren yes no nono nonono", "A\nA\nD\nD\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["枚举", "洛谷月赛"], "title": "小 D 与笔试", "background": "小 D 是一位即将参加 ION 的 IO 选手，然而笔试题库中数量繁多的奇怪题目让他大伤脑筋，快来帮帮他！", "description": "笔试题库可以抽象为 $n$ 道题目，每道题目由题面和答案组成，都是一个字符串，保证所有题目题面互不相同。\n\n为了检验小 D 背笔试的效果，教练进行了一次模拟考试，考试包含 $q$ 道题目，每道题目都有 $4$ 个选项，小 D 需要从 $4$ 个选项中选出与答案相符的选项。\n\n现在你需要帮助小 D 完成这场考试。", "inputFormat": "第一行两个正整数 $n, q$。\n\n接下来 $n$ 行，每行 $2$ 个用空格分隔的字符串，表示这道题目的题面和答案。\n\n接下来 $q$ 行，每行 $5$ 个用空格分隔的字符串，第一个字符串表示模拟考试中这道题目的题面，其余 $4$ 个字符串按顺序分别为这道题目的选项 A 到选项 D，保证选项各不相同。", "outputFormat": "对于模拟考试中的每道题目，输出一个字符表示这道题目答案对应的选项，保证所有题目均有解。", "hint": "**【数据范围】**\n\n令 $s$ 为输入中字符串长度的最大值。\n\n对于 $30 \\%$ 的数据，$n, q, s \\le 10$。  \n对于另 $20 \\%$ 的数据，$s = 1$。  \n对于 $100 \\%$ 的数据，$n, q, s \\le 100$，所有字符串都由小写拉丁字母组成。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao D and the Written Test", "background": "Xiao D is an IO contestant who is about to take ION. However, the large number of strange problems in the written test question bank gives him a headache. Please help him.", "description": "The written test question bank can be abstracted as $n$ problems. Each problem consists of a statement and an answer, both of which are strings. It is guaranteed that all problem statements are distinct.\n\nTo check how well Xiao D has memorized the written test materials, the coach held a mock exam. The exam contains $q$ problems. Each problem has $4$ options, and Xiao D needs to choose the option that matches the answer among the $4$ options.\n\nNow you need to help Xiao D finish this exam.", "inputFormat": "The first line contains two positive integers $n, q$.\n\nThe next $n$ lines each contain $2$ strings separated by spaces, representing the problem statement and the answer for that problem.\n\nThe next $q$ lines each contain $5$ strings separated by spaces. The first string is the problem statement in the mock exam. The remaining $4$ strings, in order, are options A through D for this problem. It is guaranteed that all options are distinct.", "outputFormat": "For each problem in the mock exam, output a single character indicating which option corresponds to the correct answer. It is guaranteed that every problem has a solution.", "hint": "**Constraints**\n\nLet $s$ be the maximum string length in the input.\n\nFor $30\\%$ of the testdata, $n, q, s \\le 10$.  \nFor another $20\\%$ of the testdata, $s = 1$.  \nFor $100\\%$ of the testdata, $n, q, s \\le 100$, and all strings consist of lowercase Latin letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 D 与笔试", "background": "小 D 是一位即将参加 ION 的 IO 选手，然而笔试题库中数量繁多的奇怪题目让他大伤脑筋，快来帮帮他！", "description": "笔试题库可以抽象为 $n$ 道题目，每道题目由题面和答案组成，都是一个字符串，保证所有题目题面互不相同。\n\n为了检验小 D 背笔试的效果，教练进行了一次模拟考试，考试包含 $q$ 道题目，每道题目都有 $4$ 个选项，小 D 需要从 $4$ 个选项中选出与答案相符的选项。\n\n现在你需要帮助小 D 完成这场考试。", "inputFormat": "第一行两个正整数 $n, q$。\n\n接下来 $n$ 行，每行 $2$ 个用空格分隔的字符串，表示这道题目的题面和答案。\n\n接下来 $q$ 行，每行 $5$ 个用空格分隔的字符串，第一个字符串表示模拟考试中这道题目的题面，其余 $4$ 个字符串按顺序分别为这道题目的选项 A 到选项 D，保证选项各不相同。", "outputFormat": "对于模拟考试中的每道题目，输出一个字符表示这道题目答案对应的选项，保证所有题目均有解。", "hint": "**【数据范围】**\n\n令 $s$ 为输入中字符串长度的最大值。\n\n对于 $30 \\%$ 的数据，$n, q, s \\le 10$。  \n对于另 $20 \\%$ 的数据，$s = 1$。  \n对于 $100 \\%$ 的数据，$n, q, s \\le 100$，所有字符串都由小写拉丁字母组成。", "locale": "zh-CN"}}}
{"pid": "P5602", "type": "P", "difficulty": 2, "samples": [["2\n2 1", "4.50"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "Special Judge", "洛谷月赛"], "title": "小 E 与美食", "background": "小 E 是一个热爱美食的高中生，但吃的太多会导致他身体不舒服，他想找到一个能让他最舒服的方案，快来帮帮他！", "description": "小 E 有 $n$ 种美食可供选择，每种美食只能吃一次，第 $i$ 种美食有一个美味值 $a_i$，吃下一个美味值为 $a_i$ 的美食可以让小 E 的满足感提升 $a_i$。\n\n但是小 E 的胃是有极限的，每吃下一个美食，他的饱腹感就会提升 $1$。\n\n小 E 最后的舒适度是他的满足感的平方除以他的饱腹感，你的目标是求出他舒适度能达到的最大值。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数 $a_1, a_2, \\cdots,  a_n$。\n", "outputFormat": "输出一行一个实数，表示小 E 舒适度的最大值，你的输出与标准答案的相对误差或绝对误差在 $10^{-6}$ 以内即视为正确。", "hint": "**提示**\n\n建议输出**至少 $8$ 位**有效数字。\n\n**样例解释**\n\n容易发现两种美食都吃是最优的，舒适度为 $\\frac{(2+1)^2}{2} = 4.5$。\n\n**数据范围**\n\n对于 $30 \\%$ 的数据，$n, a_i \\le 20$。\n\n对于 $50 \\%$ 的数据，$n, a_i \\le 2000$。\n\n对于另 $15 \\%$ 的数据，所有 $a_i$ 都相等。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^{5}$，$1 \\le a_i  \\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Little E and Food", "background": "Little E is a high school student who loves food, but eating too much will make him feel unwell. He wants to find a plan that makes him feel the most comfortable. Please help him.", "description": "Little E has $n$ kinds of food to choose from, and each kind of food can be eaten at most once. The $i$-th food has a tastiness value $a_i$. Eating a food with tastiness value $a_i$ increases Little E’s satisfaction by $a_i$.\n\nHowever, Little E’s stomach has a limit. Each time he eats a food, his fullness increases by $1$.\n\nLittle E’s final comfort level is defined as the square of his satisfaction divided by his fullness. Your task is to find the maximum possible comfort level.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ positive integers $a_1, a_2, \\cdots, a_n$.", "outputFormat": "Output one real number in one line, representing the maximum comfort level. Your answer is considered correct if its relative error or absolute error is within $10^{-6}$ compared to the standard answer.", "hint": "**Hint**\n\nIt is recommended to output **at least $8$ significant digits**.\n\n**Sample Explanation**\n\nIt is easy to see that eating both kinds of food is optimal. The comfort level is $\\frac{(2+1)^2}{2} = 4.5$.\n\n**Constraints**\n\nFor $30\\%$ of the testdata, $n, a_i \\le 20$.\n\nFor $50\\%$ of the testdata, $n, a_i \\le 2000$.\n\nFor another $15\\%$ of the testdata, all $a_i$ are equal.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^{5}$ and $1 \\le a_i \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 E 与美食", "background": "小 E 是一个热爱美食的高中生，但吃的太多会导致他身体不舒服，他想找到一个能让他最舒服的方案，快来帮帮他！", "description": "小 E 有 $n$ 种美食可供选择，每种美食只能吃一次，第 $i$ 种美食有一个美味值 $a_i$，吃下一个美味值为 $a_i$ 的美食可以让小 E 的满足感提升 $a_i$。\n\n但是小 E 的胃是有极限的，每吃下一个美食，他的饱腹感就会提升 $1$。\n\n小 E 最后的舒适度是他的满足感的平方除以他的饱腹感，你的目标是求出他舒适度能达到的最大值。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数 $a_1, a_2, \\cdots,  a_n$。\n", "outputFormat": "输出一行一个实数，表示小 E 舒适度的最大值，你的输出与标准答案的相对误差或绝对误差在 $10^{-6}$ 以内即视为正确。", "hint": "**提示**\n\n建议输出**至少 $8$ 位**有效数字。\n\n**样例解释**\n\n容易发现两种美食都吃是最优的，舒适度为 $\\frac{(2+1)^2}{2} = 4.5$。\n\n**数据范围**\n\n对于 $30 \\%$ 的数据，$n, a_i \\le 20$。\n\n对于 $50 \\%$ 的数据，$n, a_i \\le 2000$。\n\n对于另 $15 \\%$ 的数据，所有 $a_i$ 都相等。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^{5}$，$1 \\le a_i  \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5603", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2\n1 3", "3\n2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "贪心", "Special Judge", "拓扑排序", "洛谷月赛"], "title": "小 C 与桌游", "background": "小 C 是一个热爱桌游的高中生，现在他被一个桌游难住了，快来帮帮他！", "description": "这个桌游的地图可以被抽象成一个 $n$ 个点，$m$ 条边的**有向无环图**（**不保证连通**），小 C 在这个地图上行走，小 C 能走到某个点当且仅当能够到达这个点的所有点都已经被小 C 走到。小 C 会走到每个点恰好 $1$ 次，并且他能走到哪些点与他当前所在的点没有关系（即可以走到与当前所在的点没有连边的点，只要满足之前的条件）。\n\n小 C 每走到一个标号比之前走到的点都大的点，他就会有 $\\frac{1}{2}$ 的概率从对手那里拿到 $1$ 块筹码，有 $\\frac{1}{2}$ 的概率给对手 $1$ 块筹码，双方初始各有 $1919810$ 个筹码。\n\n小 C 的运气时好时坏，所以他希望你帮他计算出：\n\n- 在最优情况下，即他每次都能从对手那里拿到筹码时，他采取最优的行走方式能得到的筹码数。\n- 在最劣情况下，即对手每次都能从他那里拿到筹码时，他采取最优的行走方式会失去的筹码数。\n\n", "inputFormat": "第一行两个正整数 $n, m$。\n\n接下来 $m$ 行，每行两个正整数 $u, v$，表示地图上有一条有向边 $(u, v)$，不保证无重边。", "outputFormat": "输出两行，每行一个正整数，第一行表示最优情况下小 C 能拿到的筹码数，第二行表示最劣情况下小 C 会失去的筹码数。", "hint": "**样例解释**\n\n最优情况下的行走方式是 $1-2-3$，最劣情况下的行走方式是 $1-3-2$。\n\n**计分方式**\n\n对于每一个测试点：\n\n- 如果你输出格式错误或者两行都不正确，将会得到 $0$ 分。\n- 如果你的输出第一行正确，第二行错误或第二行正确，第一行错误，将会得到这个测试点 $40 \\%$ 的分数。\n- 否则，你将会得到这个测试点 $100 \\%$ 的分数。\n\n**数据范围**\n\n对于 $20\\%$ 的数据，$1 \\le n, m \\le 10$。\n\n对于 $40\\%$ 的数据，$1 \\le n, m \\le 2000$。\n\n对于 $100\\%$ 的数据，$1 \\le n, m \\le 5 \\times 10^5$，$1 \\le u, v \\le n$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Little C and Board Games", "background": "Little C is a high school student who loves board games. Now he is stuck on a board game. Please help him.", "description": "The map of this board game can be seen as a **directed acyclic graph** with $n$ vertices and $m$ edges (**not necessarily connected**). Little C walks on this map. Little C can walk to a vertex if and only if all vertices that can reach this vertex have already been visited by Little C. Little C will visit every vertex exactly $1$ time, and which vertices he can visit does not depend on his current position (that is, he may visit a vertex that has no edge connected to his current vertex, as long as the condition above is satisfied).\n\nEach time Little C visits a vertex whose label is larger than all previously visited vertices, he has probability $\\frac{1}{2}$ to get $1$ chip from the opponent, and probability $\\frac{1}{2}$ to give the opponent $1$ chip. Initially, both sides have $1919810$ chips.\n\nLittle C’s luck changes a lot, so he wants you to compute:\n\n- In the best case, i.e. every time he can get a chip from the opponent, the number of chips he can obtain with an optimal walking strategy.\n- In the worst case, i.e. every time the opponent can get a chip from him, the number of chips he will lose with an optimal walking strategy.", "inputFormat": "The first line contains two positive integers $n, m$.\n\nThe next $m$ lines each contain two positive integers $u, v$, meaning there is a directed edge $(u, v)$ on the map. Multiple edges may exist.", "outputFormat": "Output two lines, each containing one positive integer. The first line is the number of chips Little C can get in the best case. The second line is the number of chips Little C will lose in the worst case.", "hint": "**Sample Explanation**\n\nIn the best case, the walking order is $1-2-3$. In the worst case, the walking order is $1-3-2$.\n\n**Scoring**\n\nFor each test case:\n\n- If your output format is wrong, or both lines are incorrect, you will get $0$ points.\n- If your first line is correct and the second line is wrong, or the second line is correct and the first line is wrong, you will get $40 \\%$ of the points for this test case.\n- Otherwise, you will get $100 \\%$ of the points for this test case.\n\n**Constraints**\n\nFor $20\\%$ of the testdata, $1 \\le n, m \\le 10$.\n\nFor $40\\%$ of the testdata, $1 \\le n, m \\le 2000$.\n\nFor $100\\%$ of the testdata, $1 \\le n, m \\le 5 \\times 10^5$, $1 \\le u, v \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 C 与桌游", "background": "小 C 是一个热爱桌游的高中生，现在他被一个桌游难住了，快来帮帮他！", "description": "这个桌游的地图可以被抽象成一个 $n$ 个点，$m$ 条边的**有向无环图**（**不保证连通**），小 C 在这个地图上行走，小 C 能走到某个点当且仅当能够到达这个点的所有点都已经被小 C 走到。小 C 会走到每个点恰好 $1$ 次，并且他能走到哪些点与他当前所在的点没有关系（即可以走到与当前所在的点没有连边的点，只要满足之前的条件）。\n\n小 C 每走到一个标号比之前走到的点都大的点，他就会有 $\\frac{1}{2}$ 的概率从对手那里拿到 $1$ 块筹码，有 $\\frac{1}{2}$ 的概率给对手 $1$ 块筹码，双方初始各有 $1919810$ 个筹码。\n\n小 C 的运气时好时坏，所以他希望你帮他计算出：\n\n- 在最优情况下，即他每次都能从对手那里拿到筹码时，他采取最优的行走方式能得到的筹码数。\n- 在最劣情况下，即对手每次都能从他那里拿到筹码时，他采取最优的行走方式会失去的筹码数。\n\n", "inputFormat": "第一行两个正整数 $n, m$。\n\n接下来 $m$ 行，每行两个正整数 $u, v$，表示地图上有一条有向边 $(u, v)$，不保证无重边。", "outputFormat": "输出两行，每行一个正整数，第一行表示最优情况下小 C 能拿到的筹码数，第二行表示最劣情况下小 C 会失去的筹码数。", "hint": "**样例解释**\n\n最优情况下的行走方式是 $1-2-3$，最劣情况下的行走方式是 $1-3-2$。\n\n**计分方式**\n\n对于每一个测试点：\n\n- 如果你输出格式错误或者两行都不正确，将会得到 $0$ 分。\n- 如果你的输出第一行正确，第二行错误或第二行正确，第一行错误，将会得到这个测试点 $40 \\%$ 的分数。\n- 否则，你将会得到这个测试点 $100 \\%$ 的分数。\n\n**数据范围**\n\n对于 $20\\%$ 的数据，$1 \\le n, m \\le 10$。\n\n对于 $40\\%$ 的数据，$1 \\le n, m \\le 2000$。\n\n对于 $100\\%$ 的数据，$1 \\le n, m \\le 5 \\times 10^5$，$1 \\le u, v \\le n$。\n", "locale": "zh-CN"}}}
{"pid": "P5604", "type": "P", "difficulty": 6, "samples": [["3 4\n3 1 2\n2 2 1\n2 2 3\n1 2 3\n1 3 3\n2 2 3", "Yes\nNo"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "O2优化", "洛谷月赛"], "title": "小 O 与排列", "background": "小 O 是一个喜爱数学的高中生，他现在在一个与排列有关的问题上陷入了迷茫之中，快来帮帮他！\n\n**注意输入格式有修改，第二行与第三行被调换了。（以现在的题面为准）**", "description": "小 O 有一个长为 $n$ 的排列 $p$，他的好朋友 $\\texttt{euei}$ 有一个长为 $n$，值域是 $[1, n]$ 的序列 $a$。\n\n有一天，小 O 忽然想知道是否存在数对 $i, j$，满足 $l \\le i, j \\le r$，且 $p_{a_i} = a_j$，他轻松地解决了这个问题。但是 $\\texttt{euei}$ 有些时候会修改这个序列某个位置的值，还会对多对不同的 $l, r$ 询问上面的问题，这下小 O 就不会了。\n\n聪明的你能帮助小 O 解决这个问题吗？", "inputFormat": "第一行两个正整数 $n, m$，其中 $m$ 表示修改和询问数之和。\n\n第二行 $n$ 个正整数 $p_1, p_2, \\cdots, p_n$，表示排列 $p$。\n\n第三行 $n$ 个正整数 $a_1, a_2, \\cdots, a_n$，表示初始的序列 $a$。\n\n接下来 $m$ 行，每行三个正整数，为以下两种格式之一：\n\n- `1 i v`，表示将 $a_i$ 修改为 $v$。\n- `2 l r`，表示询问是否存在数对 $i, j$，满足 $l \\le i, j \\le r$，且 $p_{a_i} = a_j$。", "outputFormat": "对于每个询问，如果存在，那么输出 `Yes`，否则输出 `No`。", "hint": "**提示**\n\n本题读入量较大，请使用高效的读入方式。\n\n**样例解释**\n\n对于第一组询问，数对 $2, 3$ 满足要求。\n\n对于第二组询问，没有数对满足要求。\n\n**数据范围**\n\n本题共有 $5$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据，$1 \\le n,m \\le 5\\times 10^5$，$1 \\le a_i, i, v, l, r \\le n$ ，$p_i \\neq i$。\n\n| #    | 分数 | $n, m$           | 特殊性质                        | 时间限制    |\n| ---- | ---- | ---------------- | ------------------------------- | ----------- |\n| 1    | 7    | $\\leqslant 300$  |                                 | $\\text{1s}$ |\n| 2    | 23   | $\\leqslant 2000$ |                                 | $\\text{1s}$ |\n| 3    | 15   |                  | 没有`1`操作                     | $\\text{3s}$ |\n| 4    | 15   |                  | 每次询问时序列 $a$ 都是一个排列 | $\\text{3s}$ |\n| 5    | 40   |                  |                                 | $\\text{3s}$ |\n\n表格中留空表示该项无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "Little O and Permutations", "background": "Little O is a high school student who loves mathematics. He is now confused about a problem related to permutations. Please help him!\n\n**Note: The input format has been changed. The second and third lines have been swapped. (Please follow the current statement.)**", "description": "Little O has a permutation $p$ of length $n$. His good friend $\\texttt{euei}$ has a sequence $a$ of length $n$, with values in $[1, n]$.\n\nOne day, Little O suddenly wondered whether there exists a pair of indices $i, j$ such that $l \\le i, j \\le r$ and $p_{a_i} = a_j$. He solved this problem easily. However, $\\texttt{euei}$ sometimes modifies the value at some position in this sequence, and also asks the above question for many different pairs $l, r$. Now Little O does not know how to handle it.\n\nCan you, the smart one, help Little O solve this problem?", "inputFormat": "The first line contains two positive integers $n, m$, where $m$ is the total number of modifications and queries.\n\nThe second line contains $n$ positive integers $p_1, p_2, \\cdots, p_n$, representing the permutation $p$.\n\nThe third line contains $n$ positive integers $a_1, a_2, \\cdots, a_n$, representing the initial sequence $a$.\n\nThe next $m$ lines each contain three positive integers, in one of the following two formats:\n\n- `1 i v`, meaning set $a_i$ to $v$.\n- `2 l r`, meaning query whether there exists a pair of indices $i, j$ such that $l \\le i, j \\le r$ and $p_{a_i} = a_j$.", "outputFormat": "For each query, if such a pair exists, output `Yes`; otherwise output `No`.", "hint": "**Hint**\n\nThe input size is large, so please use a fast input method.\n\n**Explanation of the samples**\n\nFor the first query, the pair $2, 3$ satisfies the requirement.\n\nFor the second query, no pair satisfies the requirement.\n\n**Constraints**\n\nThis problem has $5$ subtasks. You must pass all test points within a subtask to get the score for that subtask.\n\nFor all testdata, $1 \\le n,m \\le 5\\times 10^5$, $1 \\le a_i, i, v, l, r \\le n$, $p_i \\neq i$.\n\n| #    | Score | $n, m$           | Special Properties                    | Time Limit  |\n| ---- | ----- | ---------------- | ------------------------------------- | ----------- |\n| 1    | 7     | $\\leqslant 300$  |                                       | $\\text{1s}$ |\n| 2    | 23    | $\\leqslant 2000$ |                                       | $\\text{1s}$ |\n| 3    | 15    |                  | No `1` operations                     | $\\text{3s}$ |\n| 4    | 15    |                  | In each query, sequence $a$ is a permutation | $\\text{3s}$ |\n| 5    | 40    |                  |                                       | $\\text{3s}$ |\n\nBlank entries in the table mean there are no special restrictions for that item.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 O 与排列", "background": "小 O 是一个喜爱数学的高中生，他现在在一个与排列有关的问题上陷入了迷茫之中，快来帮帮他！\n\n**注意输入格式有修改，第二行与第三行被调换了。（以现在的题面为准）**", "description": "小 O 有一个长为 $n$ 的排列 $p$，他的好朋友 $\\texttt{euei}$ 有一个长为 $n$，值域是 $[1, n]$ 的序列 $a$。\n\n有一天，小 O 忽然想知道是否存在数对 $i, j$，满足 $l \\le i, j \\le r$，且 $p_{a_i} = a_j$，他轻松地解决了这个问题。但是 $\\texttt{euei}$ 有些时候会修改这个序列某个位置的值，还会对多对不同的 $l, r$ 询问上面的问题，这下小 O 就不会了。\n\n聪明的你能帮助小 O 解决这个问题吗？", "inputFormat": "第一行两个正整数 $n, m$，其中 $m$ 表示修改和询问数之和。\n\n第二行 $n$ 个正整数 $p_1, p_2, \\cdots, p_n$，表示排列 $p$。\n\n第三行 $n$ 个正整数 $a_1, a_2, \\cdots, a_n$，表示初始的序列 $a$。\n\n接下来 $m$ 行，每行三个正整数，为以下两种格式之一：\n\n- `1 i v`，表示将 $a_i$ 修改为 $v$。\n- `2 l r`，表示询问是否存在数对 $i, j$，满足 $l \\le i, j \\le r$，且 $p_{a_i} = a_j$。", "outputFormat": "对于每个询问，如果存在，那么输出 `Yes`，否则输出 `No`。", "hint": "**提示**\n\n本题读入量较大，请使用高效的读入方式。\n\n**样例解释**\n\n对于第一组询问，数对 $2, 3$ 满足要求。\n\n对于第二组询问，没有数对满足要求。\n\n**数据范围**\n\n本题共有 $5$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据，$1 \\le n,m \\le 5\\times 10^5$，$1 \\le a_i, i, v, l, r \\le n$ ，$p_i \\neq i$。\n\n| #    | 分数 | $n, m$           | 特殊性质                        | 时间限制    |\n| ---- | ---- | ---------------- | ------------------------------- | ----------- |\n| 1    | 7    | $\\leqslant 300$  |                                 | $\\text{1s}$ |\n| 2    | 23   | $\\leqslant 2000$ |                                 | $\\text{1s}$ |\n| 3    | 15   |                  | 没有`1`操作                     | $\\text{3s}$ |\n| 4    | 15   |                  | 每次询问时序列 $a$ 都是一个排列 | $\\text{3s}$ |\n| 5    | 40   |                  |                                 | $\\text{3s}$ |\n\n表格中留空表示该项无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5605", "type": "P", "difficulty": 6, "samples": [["9 3\n1 4\n2 1\n7 4", "No\nYes\nYes"], ["29788562298698657 10\n4623623705787050 4128735493476588\n29371111781967946 19402395181570597\n23313713550468151 18155134012955455\n654639695903289 323875358727922\n15727861955653242 26658913688488667\n10815360622718474 4625834559167483\n10836636083182170 10347869939717751\n8972909638986721 1887397472131862\n23442032136521081 29735793306181382\n325363900801763 6960017105353559\n", "Yes\nNo\nNo\nYes\nYes\nYes\nNo\nYes\nYes\nNo\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["原根", "数论", "O2优化", "洛谷月赛"], "title": "小 A 与两位神仙", "background": "小 A 是一个普普通通的高中生，但是他某一天忽然被卷入了神仙的游戏中，快来帮帮他！", "description": "某一天，小 A 正走在放学回家的路上，忽然遇见了两个神仙造梦者和杰瑞米，祂们一看到小 A 就说要和小 A 玩游戏，小 A 被笼罩在金光中，莫名其妙就答应了祂们的要求。\n\n这个游戏的规则是这样的：两个神仙先选定一个正整数 $m$，保证 $m$ 是一个奇质数 $p$ 的正整数次幂。然后进行 $n$ 轮游戏，每轮中造梦者选定一个正整数 $x$，杰瑞米选定一个正整数 $y$，保证 $(x, m) = 1, (y, m) = 1$，即 $x$ 与 $m$ 互质，$y$ 与 $m$ 互质，接下来询问小 A 是否存在非负整数 $a$ 使得 $x^a \\equiv y \\pmod{m}$。\n\n神仙们说小 A 只有在每一轮游戏中都回答正确才能回到正常的生活中，不得已之下他只好求助于聪明的你。\n", "inputFormat": "第一行两个正整数 $m, n$。\n\n接下来 $n$ 行，每行两个正整数 $x, y$。", "outputFormat": "一共 $n$ 行，每行对应一轮游戏中小 A 的回答。\n\n如果存在，那么答案为 `Yes`，否则为 `No`。", "hint": "**样例解释**\n\n$1^a \\equiv 1 \\not \\equiv 4 \\pmod {9}$。\n\n$2^6 \\equiv 64 \\equiv 1 \\pmod {9}$。\n\n$7^2 \\equiv 49 \\equiv 4 \\pmod {9}$。\n\n**数据范围**\n\n本题共 $7$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据满足 $1\\le n\\le 2\\times 10^4$，$3\\le m \\le 10^{18}$，$1 \\le x, y < m$ 。\n\n| #    | 分数 | $n$                      | $m$                 | 特殊性质1 | 时间限制 |\n| ---- | ---- | ------------------------ | ------------------- | --------- | --------- |\n| 1    | 3    | $\\le 5$            | $\\le 10^6$    | ×         |  1s |\n| 2    | 37   | $\\le 5$            | $\\le 10^9$    | ×         | 1s |\n| 3    | 22   | $= 1$                    | $\\le 10^{18}$ | ×         | 1s |\n| 4    | 13   | $\\le 100$          | $\\le 10^{18}$ | √         | 1s |\n| 5    | 10   | $\\le 100$          | $\\le 10^{18}$ | ×         | 1s |\n| 6    | 5   | $\\le 2000$         | $\\le 10^{18}$ | ×         | 1s |\n| 7    | 10   | $\\le 2\\times 10^4$ | $\\le 10^{18}$ | ×         | 3s |\n\n特殊性质1：令 $m = p^{a}$，则 $p$ 是在 $[3, 10^{18}]$ 等概率选取的一个素数。\n\n**提示**\n\n本题可以使用 `__int128`。", "locale": "zh-CN", "translations": {"en": {"title": "Little A and Two Immortals", "background": "Little A is an ordinary high school student, but one day he was suddenly dragged into a game of immortals. Please help him!", "description": "One day, Little A was walking home after school when he suddenly met two immortal dream-makers, Zaomengzhe and Jeremy. As soon as they saw Little A, they said they wanted to play a game with him. Little A was covered in golden light and, for some reason, agreed to their request.\n\nThe rules of the game are as follows: the two immortals first choose a positive integer $m$, and guarantee that $m$ is a positive integer power of an odd prime $p$. Then they play $n$ rounds. In each round, Zaomengzhe chooses a positive integer $x$, and Jeremy chooses a positive integer $y$, with $(x, m) = 1$ and $(y, m) = 1$, meaning $x$ is coprime to $m$ and $y$ is coprime to $m$. Then they ask Little A whether there exists a non-negative integer $a$ such that $x^a \\equiv y \\pmod{m}$.\n\nThe immortals say that only if Little A answers correctly in every round can he return to normal life. With no other choice, he asks you, the smart one, for help.", "inputFormat": "The first line contains two positive integers $m, n$.\n\nThe next $n$ lines each contain two positive integers $x, y$.", "outputFormat": "Output a total of $n$ lines, each corresponding to Little A's answer for one round.\n\nIf it exists, output `Yes`; otherwise, output `No`.", "hint": "**Sample Explanation**\n\n$1^a \\equiv 1 \\not \\equiv 4 \\pmod {9}$.\n\n$2^6 \\equiv 64 \\equiv 1 \\pmod {9}$.\n\n$7^2 \\equiv 49 \\equiv 4 \\pmod {9}$.\n\n**Constraints**\n\nThis problem has $7$ subtasks. You must pass all test points within a subtask to obtain the score for that subtask.\n\nFor all testdata, $1\\le n\\le 2\\times 10^4$, $3\\le m \\le 10^{18}$, $1 \\le x, y < m$.\n\n| #    | Score | $n$                      | $m$                 | Special Property 1 | Time Limit |\n| ---- | ---- | ------------------------ | ------------------- | --------- | --------- |\n| 1    | 3    | $\\le 5$            | $\\le 10^6$    | ×         |  1s |\n| 2    | 37   | $\\le 5$            | $\\le 10^9$    | ×         | 1s |\n| 3    | 22   | $= 1$                    | $\\le 10^{18}$ | ×         | 1s |\n| 4    | 13   | $\\le 100$          | $\\le 10^{18}$ | √         | 1s |\n| 5    | 10   | $\\le 100$          | $\\le 10^{18}$ | ×         | 1s |\n| 6    | 5   | $\\le 2000$         | $\\le 10^{18}$ | ×         | 1s |\n| 7    | 10   | $\\le 2\\times 10^4$ | $\\le 10^{18}$ | ×         | 3s |\n\nSpecial Property 1: Let $m = p^{a}$. Then $p$ is a prime chosen uniformly at random from $[3, 10^{18}]$.\n\n**Hint**\n\nYou may use `__int128`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 A 与两位神仙", "background": "小 A 是一个普普通通的高中生，但是他某一天忽然被卷入了神仙的游戏中，快来帮帮他！", "description": "某一天，小 A 正走在放学回家的路上，忽然遇见了两个神仙造梦者和杰瑞米，祂们一看到小 A 就说要和小 A 玩游戏，小 A 被笼罩在金光中，莫名其妙就答应了祂们的要求。\n\n这个游戏的规则是这样的：两个神仙先选定一个正整数 $m$，保证 $m$ 是一个奇质数 $p$ 的正整数次幂。然后进行 $n$ 轮游戏，每轮中造梦者选定一个正整数 $x$，杰瑞米选定一个正整数 $y$，保证 $(x, m) = 1, (y, m) = 1$，即 $x$ 与 $m$ 互质，$y$ 与 $m$ 互质，接下来询问小 A 是否存在非负整数 $a$ 使得 $x^a \\equiv y \\pmod{m}$。\n\n神仙们说小 A 只有在每一轮游戏中都回答正确才能回到正常的生活中，不得已之下他只好求助于聪明的你。\n", "inputFormat": "第一行两个正整数 $m, n$。\n\n接下来 $n$ 行，每行两个正整数 $x, y$。", "outputFormat": "一共 $n$ 行，每行对应一轮游戏中小 A 的回答。\n\n如果存在，那么答案为 `Yes`，否则为 `No`。", "hint": "**样例解释**\n\n$1^a \\equiv 1 \\not \\equiv 4 \\pmod {9}$。\n\n$2^6 \\equiv 64 \\equiv 1 \\pmod {9}$。\n\n$7^2 \\equiv 49 \\equiv 4 \\pmod {9}$。\n\n**数据范围**\n\n本题共 $7$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据满足 $1\\le n\\le 2\\times 10^4$，$3\\le m \\le 10^{18}$，$1 \\le x, y < m$ 。\n\n| #    | 分数 | $n$                      | $m$                 | 特殊性质1 | 时间限制 |\n| ---- | ---- | ------------------------ | ------------------- | --------- | --------- |\n| 1    | 3    | $\\le 5$            | $\\le 10^6$    | ×         |  1s |\n| 2    | 37   | $\\le 5$            | $\\le 10^9$    | ×         | 1s |\n| 3    | 22   | $= 1$                    | $\\le 10^{18}$ | ×         | 1s |\n| 4    | 13   | $\\le 100$          | $\\le 10^{18}$ | √         | 1s |\n| 5    | 10   | $\\le 100$          | $\\le 10^{18}$ | ×         | 1s |\n| 6    | 5   | $\\le 2000$         | $\\le 10^{18}$ | ×         | 1s |\n| 7    | 10   | $\\le 2\\times 10^4$ | $\\le 10^{18}$ | ×         | 3s |\n\n特殊性质1：令 $m = p^{a}$，则 $p$ 是在 $[3, 10^{18}]$ 等概率选取的一个素数。\n\n**提示**\n\n本题可以使用 `__int128`。", "locale": "zh-CN"}}}
{"pid": "P5606", "type": "P", "difficulty": 7, "samples": [["3 3\n1 2 3", "2"], ["6 5\n1 1 4 5 1 4", "144"], ["16 20\n9 9 3 2 4 4 8 5 3 -1 -9 -1 -9 -8 -1 0", "802901549"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["多项式", "O2优化", "组合数学", "快速傅里叶变换 FFT", "洛谷月赛"], "title": "小 K 与毕业旅行", "background": "小 K 是一个刚刚高考完的高中生，他正在计划一次毕业旅行，但却被一些细节难住了，快来帮帮他！", "description": "毕业旅行的计划上一共有 $n$ 个景点，大家会按某种顺序游览这些景点，每一个景点都会被游览恰好一次。\n\n每个景点都有一个坐标 $a_i$，从坐标为 $a$ 的景点坐车前往坐标为 $b$ 的景点会给大家造成 $a \\times b$ 的不适感，每次下车后不适感都会清零（即不适感不会累加）。如果某次坐车的不适感超过了某个常数 $w$，就会有人生病。\n\n小 K 想问你，有多少种游览所有景点的顺序，使得全程都不会有人生病，答案对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $n$ 和一个非负整数 $w$。\n\n第二行 $n$ 个整数 $a_1, a_2, \\cdots, a_n$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "**样例解释**\n\n对于样例 $1$，有 $2-1-3$ 和 $3-1-2$ 两种合法的顺序。\n\n**数据范围**\n\n本题共有 $10$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据，$0 \\le w, |a_i| \\le 10^9 $，$1 \\le n \\le 50000$。\n\n| # | $n$ | $a$ | 分值 |\n| ---- | ---- | ---- | ---- |\n| 1 | $n \\le 10$ | 无特殊限制 | $5$ |\n| 2 | $n \\le 20$ | 无特殊限制 | $5$ |\n| 3 | $n \\le 2000 $ | $a_i \\in \\{ 1,w \\}$ | $5$ |\n| 4 | $n\\le 2000 $ | 不同的 $a_i$ 只有三个，$a_i \\ge 0$ | $5$ |\n| 5 | $n\\le 200 $ | $a_i\\ge 0 $ | $10$ |\n| 6 | $n\\le 2000$ | $a_i\\ge 0$ | $15$ |\n| 7 | $n\\le 50000$ | $a_i \\ge 0 $ | $20$ |\n| 8 | $n\\le 200 $ | 无特殊限制 | $15$ |\n| 9 | $n\\le 2000 $ | 无特殊限制 | $10$ |\n| 10 | $n\\le 50000 $ | 无特殊限制 | $10$ |", "locale": "zh-CN", "translations": {"en": {"title": "Xiao K and the Graduation Trip", "background": "Xiao K is a high school student who has just finished the college entrance exam. He is planning a graduation trip, but some details are troubling him. Please help him!", "description": "There are $n$ attractions in the graduation trip plan. Everyone will visit these attractions in some order, and each attraction will be visited exactly once.\n\nEach attraction has a coordinate $a_i$. Taking a ride from the attraction with coordinate $a$ to the attraction with coordinate $b$ will cause discomfort of $a \\times b$. After getting off the vehicle each time, the discomfort is reset to $0$ (that is, discomfort does not accumulate). If the discomfort of any ride exceeds a certain constant $w$, someone will get sick.\n\nXiao K wants to know how many visiting orders of all attractions make sure that no one gets sick throughout the whole trip. Output the answer modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$ and a non-negative integer $w$.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$.", "outputFormat": "Output one line containing one integer, the answer.", "hint": "**Sample Explanation**\n\nFor sample $1$, there are two valid orders: $2-1-3$ and $3-1-2$.\n\n**Constraints**\n\nThis problem has $10$ subtasks. You must pass all test points within a subtask to get the score for that subtask.\n\nFor all data, $0 \\le w, |a_i| \\le 10^9$, $1 \\le n \\le 50000$.\n\n| # | $n$ | $a$ | Score |\n| ---- | ---- | ---- | ---- |\n| 1 | $n \\le 10$ | No special restrictions | $5$ |\n| 2 | $n \\le 20$ | No special restrictions | $5$ |\n| 3 | $n \\le 2000 $ | $a_i \\in \\{ 1,w \\}$ | $5$ |\n| 4 | $n\\le 2000 $ | There are only three distinct $a_i$, and $a_i \\ge 0$ | $5$ |\n| 5 | $n\\le 200 $ | $a_i\\ge 0 $ | $10$ |\n| 6 | $n\\le 2000$ | $a_i\\ge 0$ | $15$ |\n| 7 | $n\\le 50000$ | $a_i \\ge 0 $ | $20$ |\n| 8 | $n\\le 200 $ | No special restrictions | $15$ |\n| 9 | $n\\le 2000 $ | No special restrictions | $10$ |\n| 10 | $n\\le 50000 $ | No special restrictions | $10$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 K 与毕业旅行", "background": "小 K 是一个刚刚高考完的高中生，他正在计划一次毕业旅行，但却被一些细节难住了，快来帮帮他！", "description": "毕业旅行的计划上一共有 $n$ 个景点，大家会按某种顺序游览这些景点，每一个景点都会被游览恰好一次。\n\n每个景点都有一个坐标 $a_i$，从坐标为 $a$ 的景点坐车前往坐标为 $b$ 的景点会给大家造成 $a \\times b$ 的不适感，每次下车后不适感都会清零（即不适感不会累加）。如果某次坐车的不适感超过了某个常数 $w$，就会有人生病。\n\n小 K 想问你，有多少种游览所有景点的顺序，使得全程都不会有人生病，答案对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $n$ 和一个非负整数 $w$。\n\n第二行 $n$ 个整数 $a_1, a_2, \\cdots, a_n$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "**样例解释**\n\n对于样例 $1$，有 $2-1-3$ 和 $3-1-2$ 两种合法的顺序。\n\n**数据范围**\n\n本题共有 $10$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据，$0 \\le w, |a_i| \\le 10^9 $，$1 \\le n \\le 50000$。\n\n| # | $n$ | $a$ | 分值 |\n| ---- | ---- | ---- | ---- |\n| 1 | $n \\le 10$ | 无特殊限制 | $5$ |\n| 2 | $n \\le 20$ | 无特殊限制 | $5$ |\n| 3 | $n \\le 2000 $ | $a_i \\in \\{ 1,w \\}$ | $5$ |\n| 4 | $n\\le 2000 $ | 不同的 $a_i$ 只有三个，$a_i \\ge 0$ | $5$ |\n| 5 | $n\\le 200 $ | $a_i\\ge 0 $ | $10$ |\n| 6 | $n\\le 2000$ | $a_i\\ge 0$ | $15$ |\n| 7 | $n\\le 50000$ | $a_i \\ge 0 $ | $20$ |\n| 8 | $n\\le 200 $ | 无特殊限制 | $15$ |\n| 9 | $n\\le 2000 $ | 无特殊限制 | $10$ |\n| 10 | $n\\le 50000 $ | 无特殊限制 | $10$ |", "locale": "zh-CN"}}}
{"pid": "P5607", "type": "P", "difficulty": 6, "samples": [["10\n1 1 2\n1 1 1\n2 1 3\n1 1 3\n1 1 8\n2 2 1\n2 2 1\n2 1 1\n1 1 4\n1 2 2", "2\n4\n4\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2013", "O2优化", "Ynoi"], "title": "[Ynoi2013] 无力回天 NOI2017", "background": "", "description": "你需要维护编号为 $1,\\dots,m$ 的 $m$ 个集合，初始为空。\n\n共 $m$ 次操作：\n\n1. 给定 $x,y$，在编号 $x$ 的集合插入 $y$，保证 $y$ 之前不在这个集合中；\n2. 给定 $x_1,x_2$，问编号 $x_1,x_2$ 的集合的并的元素个数。", "inputFormat": "第一行一个整数 $m$；\n\n接下来 $m$ 行，每行三个整数 $1,x,y$ 或 $2,x_1,x_2$ 表示一次操作。", "outputFormat": "对每个 $2$ 操作，输出一行，表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078&FS_NEO\n\n对于 $100\\%$ 的数据，满足 $1\\le m\\le 10^6$，$1\\le x,y,x_1,x_2\\le m$；\n\n对于 $25\\%$ 的数据，满足 $m\\le10^3$。\n\n对于另外 $25\\%$ 的数据，保证在第一次 $2$ 操作后，没有 $1$ 操作。\n\n对于另外 $25\\%$ 的数据，满足 $m\\le 2\\times 10^5$。\n\n对于另外 $25\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2013] 无力回天 NOI2017", "background": "", "description": "你需要维护编号为 $1,\\dots,m$ 的 $m$ 个集合，初始为空。\n\n共 $m$ 次操作：\n\n1. 给定 $x,y$，在编号 $x$ 的集合插入 $y$，保证 $y$ 之前不在这个集合中；\n2. 给定 $x_1,x_2$，问编号 $x_1,x_2$ 的集合的并的元素个数。", "inputFormat": "第一行一个整数 $m$；\n\n接下来 $m$ 行，每行三个整数 $1,x,y$ 或 $2,x_1,x_2$ 表示一次操作。", "outputFormat": "对每个 $2$ 操作，输出一行，表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078&FS_NEO\n\n对于 $100\\%$ 的数据，满足 $1\\le m\\le 10^6$，$1\\le x,y,x_1,x_2\\le m$；\n\n对于 $25\\%$ 的数据，满足 $m\\le10^3$。\n\n对于另外 $25\\%$ 的数据，保证在第一次 $2$ 操作后，没有 $1$ 操作。\n\n对于另外 $25\\%$ 的数据，满足 $m\\le 2\\times 10^5$。\n\n对于另外 $25\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5608", "type": "P", "difficulty": 7, "samples": [["6 6\n1 3 5 7 9 11\n0 1 1 0 1\n3 1 6\n3 3 6\n1 1 2 13\n2 3 4 1\n3 1 6\n3 3 6", "205\n134\n45058\n3465"], ["20 20\n525160717 947806001 1495853547 5283947 39115023 1008063001 397093019 1434942997 247321621 145181297 359967329 642658073 1402873249 50886569 150383317 1004954721 351661441 1660759179 48867601 1316622161 \n0 0 0 0 0 0 0 1 0 1 0 0 0 1 0 0 0 0 1 \n3 2 19\n3 2 15\n3 9 9\n1 16 16 394339135\n2 1 19 0\n3 1 15\n1 4 11 564942769\n3 7 7\n2 2 19 0\n3 1 1\n3 9 9\n1 9 9 705415201\n1 3 18 152081579\n1 13 17 905666497\n1 11 17 612267547\n1 2 20 111949431\n2 1 1 0\n1 10 17 838945201\n2 4 18 0\n3 2 18\n", "900803889\n834560968\n247321621\n852589651\n564942769\n525160717\n564942769\n719106438\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2013", "线段树", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2013] 文化课", "background": "Chimuzu 省选一轮爆了两个大零蛋，于是滚回去学文化课了。\n\n他翻出一道基础四则运算练习题……然后发现自己不会。\n\n于是他需要你的帮助，作为回报，他会给你 $100$ 分。\n\n前排打广告，有人来看看我写的[融合树](https://www.luogu.org/blog/user3296/rong-ge-shu-fusion-tree)吗\n\n（其实还写了 Brodal queue）", "description": "Chimuzu 手上有一个数字序列 $\\{a_{1},a_{2},\\ldots,a_{n}\\}$ 和一个运算符序列 $\\{p_{1},p_{2},\\ldots,p_{n-1}\\}$。其中 $p_{i}$ 只能为 $+$ 或 $\\times$。\n\n我们定义一个区间 $[l,r]$ 的权值 $w(l,r)$ 为将字符串\n\n$$\na_{l}~p_{l}~a_{l+1}~p_{l+1} \\cdots a_{r-1}~p_{r-1}~a_{r}\n$$\n\n写下来之后，按照运算符的优先级计算出的结果。\n\n下面给出一个运算的例子：\n\n若 $a=\\{1,3,5,7,9,11\\}$，$p=\\{+,\\times,\\times,+,\\times\\}$，那么有：\n\n$$\nw(1,6)=1+3\\times 5\\times 7+9\\times 11=205\n$$\n\n$$\nw(3,6)=5\\times 7+9\\times 11=134\n$$\n\nChimuzu 需要你对这两个序列进行修改，同时查询某个给定区间的权值。\n\n你需要维护这 $3$ 个操作：\n\n操作一：给定 $l,r,x$，将 $a_{l},a_{l+1},\\ldots,a_{r}$ 全部修改成 $x$。\n\n操作二：给定 $l,r,y$：将 $p_{l},p_{l+1},\\ldots,p_{r}$ 全部修改成 $y$，$0$ 表示 $+$，$1$ 表示 $\\times$。\n\n操作三：给定 $l,r$：查询 $w(l,r) \\bmod 1000000007$ 的值。", "inputFormat": "第一行包含两个整数 $n,m$。\n\n第二行包含 $n$ 个整数 $a_{1},a_{2},\\ldots,a_{n}$。\n\n第三行包含 $n-1$ 个整数 $p_{1},p_{2},\\cdots,p_{n-1}$，$0$ 表示 $+$， $1$ \n 表示 $\\times$。\n\n接下来 $m$ 行，每行有一个操作。\n\n一开始输入一个标识符 $op$，表示操作类型，接着按照题目描述输入各操作的参数。\n\n$op=1$ 时，输入 $3$ 个整数 $l,r,x$，表示将 $a_{l},a_{l+1},\\ldots,a_{r}$ 全部修改成 $x$。\n\n$op=2$ 时，输入 $3$ 个整数 $l,r,y$，表示将 $p_{l},p_{l+1},\\ldots,p_{r}$ 全部修改成 $y$，$0$ 表示 $+$，$1$ 表示 $\\times$。\n\n$op=3$ 时，输入 $2$ 个整数 $l,r$，表示查询 $w(l,r) \\bmod 1000000007$ 的值。\n\n\n\n", "outputFormat": "对于每一次操作 $3$，输出 $1$ 行 $1$ 个整数表示所求答案。", "hint": "#### 样例解释 1\n\n初始的两个序列和前两次操作是题目描述中的例子。第四次操作结束后，两个序列变成了如下形态\n\n$a=\\{13,13,5,7,9,11\\}$，$p=\\{+,\\times,\\times,\\times,\\times\\}$\n\n$$\nw(1,6)=13+13\\times 5\\times 7\\times 9\\times 11=45058\n$$\n\n$$\nw(3,6)=5\\times 7\\times 9\\times 11=3465\n$$\n\n### 数据范围与约定\n\n对于其中 $1\\%$ 的数据，为样例 1，时限为 1.5s\n\n对于另外 $14\\%$的数据，$n,m\\leq 1000$ ，时限为 1.5s\n\n对于另外 $5\\%$ 的数据，没有修改操作，时限为 1.5s\n\n对于另外 $14\\%$ 的数据，数据保证随机，时限为 1.5s\n\n对于另外 $19\\%$ 的数据，没有 1 操作，时限为 1.5s\n\n对于另外 $19\\%$ 的数据，没有 2 操作，时限为 1.5s\n\n对于另外 $8\\%$ 的数据，时限为 5s\n\n对于另外 $10\\%$ 的数据，时限为 3s\n\n对于 $100\\%$ 的数据，$n,m\\leq 100000$，$1\\leq a_{i},x\\lt 2^{32}$，$a_{i},x$ 均为奇数，$p_{i},y\\in\\{0,1\\}$，$1\\leq l\\leq r\\leq n$，所有操作 $2$ 还满足 $r\\lt n$。时限为 1.5s\n\nIdea：Juan_feng。\n\nSolution：nzhtl1477，ccz181078。\n\nCode：Juan_feng，nzhtl1477，rehtorbegnaro，ccz181078。\n\nData：Juan_feng，nzhtl1477，rehtorbegnaro。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] Cultural Classes.", "background": "Chimuzu messed up badly in the first round of the NOI Qualifier, getting two big zeros, so he went back to study cultural classes.\n\nHe dug out a basic four-operations arithmetic practice problem... and then found that he could not do it.\n\nSo he needs your help. As a reward, he will give you $100$ points.\n\nAdvertisement at the top: would anyone like to take a look at the [fusion tree](https://www.luogu.org/blog/user3296/rong-ge-shu-fusion-tree) I wrote?\n\n(Actually, I also wrote about the Brodal queue.)", "description": "Chimuzu has a number sequence $\\{a_{1},a_{2},\\ldots,a_{n}\\}$ and an operator sequence $\\{p_{1},p_{2},\\ldots,p_{n-1}\\}$. Each $p_{i}$ can only be $+$ or $\\times$.\n\nWe define the weight $w(l,r)$ of an interval $[l,r]$ as the result obtained by writing the string\n\n$$\na_{l}~p_{l}~a_{l+1}~p_{l+1} \\cdots a_{r-1}~p_{r-1}~a_{r}\n$$\n\nand then evaluating it according to operator precedence.\n\nAn example is given below:\n\nIf $a=\\{1,3,5,7,9,11\\}$ and $p=\\{+,\\times,\\times,+,\\times\\}$, then:\n\n$$\nw(1,6)=1+3\\times 5\\times 7+9\\times 11=205\n$$\n\n$$\nw(3,6)=5\\times 7+9\\times 11=134\n$$\n\nChimuzu needs you to modify these two sequences and also query the weight of a given interval.\n\nYou need to maintain these $3$ operations:\n\nOperation 1: given $l,r,x$, set $a_{l},a_{l+1},\\ldots,a_{r}$ all to $x$.\n\nOperation 2: given $l,r,y$, set $p_{l},p_{l+1},\\ldots,p_{r}$ all to $y$, where $0$ means $+$ and $1$ means $\\times$.\n\nOperation 3: given $l,r$, query the value of $w(l,r) \\bmod 1000000007$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers $a_{1},a_{2},\\ldots,a_{n}$.\n\nThe third line contains $n-1$ integers $p_{1},p_{2},\\cdots,p_{n-1}$, where $0$ means $+$ and $1$ means $\\times$.\n\nThen follow $m$ lines, each describing one operation.\n\nEach operation starts with an identifier $op$, indicating the operation type, followed by the parameters as described above.\n\nWhen $op=1$, input $3$ integers $l,r,x$, meaning to set $a_{l},a_{l+1},\\ldots,a_{r}$ all to $x$.\n\nWhen $op=2$, input $3$ integers $l,r,y$, meaning to set $p_{l},p_{l+1},\\ldots,p_{r}$ all to $y$, where $0$ means $+$ and $1$ means $\\times$.\n\nWhen $op=3$, input $2$ integers $l,r$, meaning to query the value of $w(l,r) \\bmod 1000000007$.", "outputFormat": "For each operation $3$, output $1$ line containing $1$ integer, which is the required answer.", "hint": "#### Sample Explanation 1\n\nThe initial two sequences and the first two operations are the example in the statement. After the fourth operation, the two sequences become:\n\n$a=\\{13,13,5,7,9,11\\}$, $p=\\{+,\\times,\\times,\\times,\\times\\}$\n\n$$\nw(1,6)=13+13\\times 5\\times 7\\times 9\\times 11=45058\n$$\n\n$$\nw(3,6)=5\\times 7\\times 9\\times 11=3465\n$$\n\n### Constraints and Notes\n\nFor $1\\%$ of the testdata, it is Sample 1, and the time limit is 1.5s.\n\nFor another $14\\%$ of the testdata, $n,m\\leq 1000$, and the time limit is 1.5s.\n\nFor another $5\\%$ of the testdata, there are no modification operations, and the time limit is 1.5s.\n\nFor another $14\\%$ of the testdata, the testdata is guaranteed to be random, and the time limit is 1.5s.\n\nFor another $19\\%$ of the testdata, there is no operation 1, and the time limit is 1.5s.\n\nFor another $19\\%$ of the testdata, there is no operation 2, and the time limit is 1.5s.\n\nFor another $8\\%$ of the testdata, the time limit is 5s.\n\nFor another $10\\%$ of the testdata, the time limit is 3s.\n\nFor $100\\%$ of the testdata, $n,m\\leq 100000$, $1\\leq a_{i},x\\lt 2^{32}$, and both $a_{i}$ and $x$ are odd, $p_{i},y\\in\\{0,1\\}$, $1\\leq l\\leq r\\leq n$. Also, for all operations $2$, it additionally holds that $r\\lt n$. The time limit is 1.5s.\n\nIdea: Juan_feng.\n\nSolution: nzhtl1477, ccz181078.\n\nCode: Juan_feng, nzhtl1477, rehtorbegnaro, ccz181078.\n\nData: Juan_feng, nzhtl1477, rehtorbegnaro.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] 文化课", "background": "Chimuzu 省选一轮爆了两个大零蛋，于是滚回去学文化课了。\n\n他翻出一道基础四则运算练习题……然后发现自己不会。\n\n于是他需要你的帮助，作为回报，他会给你 $100$ 分。\n\n前排打广告，有人来看看我写的[融合树](https://www.luogu.org/blog/user3296/rong-ge-shu-fusion-tree)吗\n\n（其实还写了 Brodal queue）", "description": "Chimuzu 手上有一个数字序列 $\\{a_{1},a_{2},\\ldots,a_{n}\\}$ 和一个运算符序列 $\\{p_{1},p_{2},\\ldots,p_{n-1}\\}$。其中 $p_{i}$ 只能为 $+$ 或 $\\times$。\n\n我们定义一个区间 $[l,r]$ 的权值 $w(l,r)$ 为将字符串\n\n$$\na_{l}~p_{l}~a_{l+1}~p_{l+1} \\cdots a_{r-1}~p_{r-1}~a_{r}\n$$\n\n写下来之后，按照运算符的优先级计算出的结果。\n\n下面给出一个运算的例子：\n\n若 $a=\\{1,3,5,7,9,11\\}$，$p=\\{+,\\times,\\times,+,\\times\\}$，那么有：\n\n$$\nw(1,6)=1+3\\times 5\\times 7+9\\times 11=205\n$$\n\n$$\nw(3,6)=5\\times 7+9\\times 11=134\n$$\n\nChimuzu 需要你对这两个序列进行修改，同时查询某个给定区间的权值。\n\n你需要维护这 $3$ 个操作：\n\n操作一：给定 $l,r,x$，将 $a_{l},a_{l+1},\\ldots,a_{r}$ 全部修改成 $x$。\n\n操作二：给定 $l,r,y$：将 $p_{l},p_{l+1},\\ldots,p_{r}$ 全部修改成 $y$，$0$ 表示 $+$，$1$ 表示 $\\times$。\n\n操作三：给定 $l,r$：查询 $w(l,r) \\bmod 1000000007$ 的值。", "inputFormat": "第一行包含两个整数 $n,m$。\n\n第二行包含 $n$ 个整数 $a_{1},a_{2},\\ldots,a_{n}$。\n\n第三行包含 $n-1$ 个整数 $p_{1},p_{2},\\cdots,p_{n-1}$，$0$ 表示 $+$， $1$ \n 表示 $\\times$。\n\n接下来 $m$ 行，每行有一个操作。\n\n一开始输入一个标识符 $op$，表示操作类型，接着按照题目描述输入各操作的参数。\n\n$op=1$ 时，输入 $3$ 个整数 $l,r,x$，表示将 $a_{l},a_{l+1},\\ldots,a_{r}$ 全部修改成 $x$。\n\n$op=2$ 时，输入 $3$ 个整数 $l,r,y$，表示将 $p_{l},p_{l+1},\\ldots,p_{r}$ 全部修改成 $y$，$0$ 表示 $+$，$1$ 表示 $\\times$。\n\n$op=3$ 时，输入 $2$ 个整数 $l,r$，表示查询 $w(l,r) \\bmod 1000000007$ 的值。\n\n\n\n", "outputFormat": "对于每一次操作 $3$，输出 $1$ 行 $1$ 个整数表示所求答案。", "hint": "#### 样例解释 1\n\n初始的两个序列和前两次操作是题目描述中的例子。第四次操作结束后，两个序列变成了如下形态\n\n$a=\\{13,13,5,7,9,11\\}$，$p=\\{+,\\times,\\times,\\times,\\times\\}$\n\n$$\nw(1,6)=13+13\\times 5\\times 7\\times 9\\times 11=45058\n$$\n\n$$\nw(3,6)=5\\times 7\\times 9\\times 11=3465\n$$\n\n### 数据范围与约定\n\n对于其中 $1\\%$ 的数据，为样例 1，时限为 1.5s\n\n对于另外 $14\\%$的数据，$n,m\\leq 1000$ ，时限为 1.5s\n\n对于另外 $5\\%$ 的数据，没有修改操作，时限为 1.5s\n\n对于另外 $14\\%$ 的数据，数据保证随机，时限为 1.5s\n\n对于另外 $19\\%$ 的数据，没有 1 操作，时限为 1.5s\n\n对于另外 $19\\%$ 的数据，没有 2 操作，时限为 1.5s\n\n对于另外 $8\\%$ 的数据，时限为 5s\n\n对于另外 $10\\%$ 的数据，时限为 3s\n\n对于 $100\\%$ 的数据，$n,m\\leq 100000$，$1\\leq a_{i},x\\lt 2^{32}$，$a_{i},x$ 均为奇数，$p_{i},y\\in\\{0,1\\}$，$1\\leq l\\leq r\\leq n$，所有操作 $2$ 还满足 $r\\lt n$。时限为 1.5s\n\nIdea：Juan_feng。\n\nSolution：nzhtl1477，ccz181078。\n\nCode：Juan_feng，nzhtl1477，rehtorbegnaro，ccz181078。\n\nData：Juan_feng，nzhtl1477，rehtorbegnaro。\n", "locale": "zh-CN"}}}
{"pid": "P5609", "type": "P", "difficulty": 7, "samples": [["4 5 6\n7 2 -3 17\n2 3 1\n1 3 3\n0 3 0\n2 4 2\n4 4 0", "0\n-3\n4\n12\n11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2013", "O2优化", "Ynoi"], "title": "[Ynoi2013] 对数据结构的爱", "background": "", "description": "Nauuo 是一个喜欢编程的女孩子。有一天她在做一道题，要求计算一些数的和对一个数 $p$ 取模的结果。\n\n她写出了如下的代码，然后获得了 WA 的评测结果。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x18mqt81.png)\n\n她很快发现了 bug——`ModAdd` 函数只对 $[0,p)$ 中的数起作用，但是这个问题中的数有可能不在这个范围之内。她对这个错误的函数很好奇，所以她想知道它的运行结果。\n\n然而，原来的代码运行得太慢了，所以她来找你求助。\n\n给定数组 $a_1,a_2,…a_n$ 和一个数 $p$，有 $m$ 个询问，每次给定三个数 $l$，$r$ 和 $x$，你需要计算函数 `Sum(a,l,r,x,p)` 的返回值。函数 `Sum` 的定义在上面的伪代码中已经给出。\n\n注意，在上面的代码中，整数不会越界。", "inputFormat": "第一行三个整数 $n$，$m$，$p$，分别代表数组的长度，询问的个数和模数。注意模数只在 `ModAdd` 中用到。\n\n第二行包含 $n$ 个整数 $a_1,a_2,…a_n$，代表给定的数组。\n\n接下来的 $m$ 行，每行三个整数 $l$，$r$ 和 $x$，你需要计算 `Sum(a,l,r,x,p)`。\n\n**本题强制在线，所有输入的 $l,r,x$ 均需要异或 $lastans$，其定义为上一次询问操作得到的答案对 $n$ 取模后的值，若答案为负数，则需要取模为正数，若之前没有询问操作，则为 $0$。**", "outputFormat": "按顺序输出 $m$ 个整数，每个一行，代表询问的答案。", "hint": "Idea：rushcheyo&nzhtl1477，Solution：ccz181078，Code：rushcheyo&ccz181078，Data：rushcheyo&nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^6$，$1\\le m\\le2\\times 10^5$，$1\\le p\\le10^9$，$-10^9\\le a_i\\le10^9$，$1\\le l\\le r\\le n$，$0\\le x\\le p-1$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] Love for Data Structures", "background": "", "description": "Nauuo is a girl who likes programming. One day she was working on a problem that asked her to compute the sum of some numbers modulo an integer $p$.\n\nShe wrote the following code, but got WA.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x18mqt81.png)\n\nShe quickly found the bug: the `ModAdd` function only works for numbers in $[0,p)$, but in this problem the numbers may fall outside this range. She became curious about this incorrect function, so she wants to know what result it actually produces.\n\nHowever, the original code runs too slowly, so she asks you for help.\n\nGiven an array $a_1,a_2,\\ldots,a_n$ and an integer $p$, there are $m$ queries. Each query gives three integers $l$, $r$, and $x$. You need to compute the return value of `Sum(a,l,r,x,p)`. The definition of `Sum` has already been given in the pseudocode above.\n\nNote that in the code above, integers will not overflow.", "inputFormat": "The first line contains three integers $n$, $m$, $p$, representing the length of the array, the number of queries, and the modulus. Note that the modulus is only used in `ModAdd`.\n\nThe second line contains $n$ integers $a_1,a_2,\\ldots,a_n$, representing the given array.\n\nThe next $m$ lines each contain three integers $l$, $r$, and $x$. You need to compute `Sum(a,l,r,x,p)`.\n\n**This problem is forced online. All input $l,r,x$ must be XORed with $lastans$, where $lastans$ is defined as (the answer of the previous query) modulo $n$. If the answer is negative, you need to take the modulo to make it positive. If there has been no previous query, then it is $0$.**", "outputFormat": "Output $m$ integers in order, one per line, representing the answers to the queries.", "hint": "Idea: rushcheyo&nzhtl1477, Solution: ccz181078, Code: rushcheyo&ccz181078, Data: rushcheyo&nzhtl1477\n\nConstraints: for $100\\%$ of the testdata, $1\\le n\\le10^6$, $1\\le m\\le2\\times 10^5$, $1\\le p\\le10^9$, $-10^9\\le a_i\\le10^9$, $1\\le l\\le r\\le n$, $0\\le x\\le p-1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] 对数据结构的爱", "background": "", "description": "Nauuo 是一个喜欢编程的女孩子。有一天她在做一道题，要求计算一些数的和对一个数 $p$ 取模的结果。\n\n她写出了如下的代码，然后获得了 WA 的评测结果。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x18mqt81.png)\n\n她很快发现了 bug——`ModAdd` 函数只对 $[0,p)$ 中的数起作用，但是这个问题中的数有可能不在这个范围之内。她对这个错误的函数很好奇，所以她想知道它的运行结果。\n\n然而，原来的代码运行得太慢了，所以她来找你求助。\n\n给定数组 $a_1,a_2,…a_n$ 和一个数 $p$，有 $m$ 个询问，每次给定三个数 $l$，$r$ 和 $x$，你需要计算函数 `Sum(a,l,r,x,p)` 的返回值。函数 `Sum` 的定义在上面的伪代码中已经给出。\n\n注意，在上面的代码中，整数不会越界。", "inputFormat": "第一行三个整数 $n$，$m$，$p$，分别代表数组的长度，询问的个数和模数。注意模数只在 `ModAdd` 中用到。\n\n第二行包含 $n$ 个整数 $a_1,a_2,…a_n$，代表给定的数组。\n\n接下来的 $m$ 行，每行三个整数 $l$，$r$ 和 $x$，你需要计算 `Sum(a,l,r,x,p)`。\n\n**本题强制在线，所有输入的 $l,r,x$ 均需要异或 $lastans$，其定义为上一次询问操作得到的答案对 $n$ 取模后的值，若答案为负数，则需要取模为正数，若之前没有询问操作，则为 $0$。**", "outputFormat": "按顺序输出 $m$ 个整数，每个一行，代表询问的答案。", "hint": "Idea：rushcheyo&nzhtl1477，Solution：ccz181078，Code：rushcheyo&ccz181078，Data：rushcheyo&nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^6$，$1\\le m\\le2\\times 10^5$，$1\\le p\\le10^9$，$-10^9\\le a_i\\le10^9$，$1\\le l\\le r\\le n$，$0\\le x\\le p-1$。", "locale": "zh-CN"}}}
{"pid": "P5610", "type": "P", "difficulty": 6, "samples": [["5 2\n1 2 3 4 5\n1 1 5 2\n2 1 5", "12"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2013", "树状数组", "数论", "O2优化", "Ynoi"], "title": "[Ynoi2013] 大学", "background": "", "description": "一个长为 $n$ 的**非负**整数序列 $a$，支持以下两个操作：\n\n- `1 l r x`：把区间 $[l,r]$ 中所有 $x$ 的倍数除以 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的和。\n\n本题强制在线，每次的 $l,r,x$ 需要与上次答案做 xor 运算，如果之前没有询问，则上次答案为 $0$。", "inputFormat": "第一行两个整数表示 $n,m$。\n\n第二行 $n$ 个非负整数表示 $a_i$。\n\n之后 $m$ 行每行一个操作。\n\n- `1 l r x`：把区间 $[l,r]$ 中所有 $x$ 的倍数除以 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的和。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "$1\\leq n,m\\leq 10^5$，$0\\leq a_i\\leq 5\\times 10^5$，解密后的 $x,l,r$ 满足 $1\\leq x\\leq 5\\times 10^5$，$1\\leq l\\leq r\\leq n$。\n\nIdea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，mrsrz，Data：nzhtl1477，mrsrz，一只绝帆", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] University", "background": "", "description": "Given a **non-negative** integer sequence $a$ of length $n$, support the following two operations:\n\n- `1 l r x`: For all numbers in the interval $[l,r]$ that are multiples of $x$, divide them by $x$.\n- `2 l r`: Query the sum of the interval $[l,r]$.\n\nThis problem is forced online. For each operation, the values $l, r, x$ need to be XORed with the previous answer. If there has been no previous query, then the previous answer is $0$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains $n$ non-negative integers representing $a_i$.\n\nThen follow $m$ lines, each describing one operation.\n\n- `1 l r x`: For all numbers in the interval $[l,r]$ that are multiples of $x$, divide them by $x$.\n- `2 l r`: Query the sum of the interval $[l,r]$.", "outputFormat": "For each query, output one integer per line as the answer.", "hint": "Constraints: $1\\leq n,m\\leq 10^5$, $0\\leq a_i\\leq 5\\times 10^5$. The decrypted $x,l,r$ satisfy $1\\leq x\\leq 5\\times 10^5$, $1\\leq l\\leq r\\leq n$.\n\nIdea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, mrsrz, Data: nzhtl1477, mrsrz, 一只绝帆.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] 大学", "background": "", "description": "一个长为 $n$ 的**非负**整数序列 $a$，支持以下两个操作：\n\n- `1 l r x`：把区间 $[l,r]$ 中所有 $x$ 的倍数除以 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的和。\n\n本题强制在线，每次的 $l,r,x$ 需要与上次答案做 xor 运算，如果之前没有询问，则上次答案为 $0$。", "inputFormat": "第一行两个整数表示 $n,m$。\n\n第二行 $n$ 个非负整数表示 $a_i$。\n\n之后 $m$ 行每行一个操作。\n\n- `1 l r x`：把区间 $[l,r]$ 中所有 $x$ 的倍数除以 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的和。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "$1\\leq n,m\\leq 10^5$，$0\\leq a_i\\leq 5\\times 10^5$，解密后的 $x,l,r$ 满足 $1\\leq x\\leq 5\\times 10^5$，$1\\leq l\\leq r\\leq n$。\n\nIdea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，mrsrz，Data：nzhtl1477，mrsrz，一只绝帆", "locale": "zh-CN"}}}
{"pid": "P5611", "type": "P", "difficulty": 7, "samples": [["6 5\n-1 1 -4 5 -1 4\n1 1 4 5\n1 1 4 514\n2 3 3 3\n1 6 -1 5\n2 5 2 5", "0\n0\n0\n9\n5"]], "limits": {"time": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2013", "O2优化", "Ynoi"], "title": "[Ynoi2013] D2T2", "background": "", "description": "给一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n查询操作形如 $l\\;r\\;L\\;R$，表示将序列中值在 $[L,R]$ 内的位置保留不变，其他的位置变成 $0$ 时，序列中 $[l,r]$ 区间内的最大子段和，这个子段可以是空的。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行四个整数 $l\\;r\\;L\\;R$ 表示一次查询操作。\n", "outputFormat": "输出 $m$ 行，每行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m \\le 10^5$，序列中所有数的绝对值 $\\le 10^9$。\n\n第四组查询中，值域限制是 $[-1,5]$，序列为 `-1 1 0 5 -1 4`，区间 $[1,6]$ 的最大子段为 $[2,6]$，和为 $9$。\n\n第五组查询中，值域限制是 $[2,5]$，序列为 `0 0 0 5 0 4`，区间 $[2,5]$ 的最大子段为 $[4,4]$（并列），和为 $5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] D2T2", "background": "", "description": "Given a sequence of length $n$, there are $m$ query operations.\n\nEach query is in the form $l\\;r\\;L\\;R$. It means: keep the positions whose values are in $[L,R]$ unchanged, and set all other positions to $0$. Then, compute the maximum subarray sum within the interval $[l,r]$ of the resulting sequence. This subarray is allowed to be empty.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers representing the sequence.\n\nThen follow $m$ lines, each containing four integers $l\\;r\\;L\\;R$, representing one query operation.", "outputFormat": "Output $m$ lines, each containing one integer representing the answer.", "hint": "Idea: nzhtl1477, Solution: ccz181078, Code: ccz181078, Data: nzhtl1477.\n\nConstraints: for $100\\%$ of the testdata, $1\\leq n,m \\le 10^5$, and the absolute value of every number in the sequence is $\\le 10^9$.\n\nIn the fourth group of queries, the value range limit is $[-1,5]$, and the sequence becomes `-1 1 0 5 -1 4`. The maximum subarray in interval $[1,6]$ is $[2,6]$, with sum $9$.\n\nIn the fifth group of queries, the value range limit is $[2,5]$, and the sequence becomes `0 0 0 5 0 4`. The maximum subarray in interval $[2,5]$ is $[4,4]$ (tied), with sum $5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] D2T2", "background": "", "description": "给一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n查询操作形如 $l\\;r\\;L\\;R$，表示将序列中值在 $[L,R]$ 内的位置保留不变，其他的位置变成 $0$ 时，序列中 $[l,r]$ 区间内的最大子段和，这个子段可以是空的。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行四个整数 $l\\;r\\;L\\;R$ 表示一次查询操作。\n", "outputFormat": "输出 $m$ 行，每行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m \\le 10^5$，序列中所有数的绝对值 $\\le 10^9$。\n\n第四组查询中，值域限制是 $[-1,5]$，序列为 `-1 1 0 5 -1 4`，区间 $[1,6]$ 的最大子段为 $[2,6]$，和为 $9$。\n\n第五组查询中，值域限制是 $[2,5]$，序列为 `0 0 0 5 0 4`，区间 $[2,5]$ 的最大子段为 $[4,4]$（并列），和为 $5$。", "locale": "zh-CN"}}}
{"pid": "P5612", "type": "P", "difficulty": 7, "samples": [["5 3\n1 4 2 8 3\n2 1 3\n1 2 4 5\n3 1 2", "6"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2013", "O2优化", "Ynoi"], "title": "[Ynoi2013] Ynoi", "background": null, "description": "维护一个由 $n$ 个非负整数构成的序列 $a_1,a_2,a_3,\\ldots,a_n$，支持三种操作：\n\n1. 给定区间 $[l,r]$，将对应区间内的数异或上 $x$。\n2. 给定区间 $[l,r]$，将对应区间内的数从小到大排序。\n3. 给定区间 $[l,r]$，求区间内的数的异或和。", "inputFormat": "第一行 $n,m$ 两个整数。\n\n第二行 $n$ 个整数 $a_i$，表示原序列。\n\n接下来 $m$ 行，每行三个整数 $opt,l,r$（$opt\\in\\{2,3\\}$）或四个整数\n $opt,l,r,x$（$opt=1$）表示对应的操作。", "outputFormat": "对每个操作 $3$，输出一行，表示对应的答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078&nzhtl1477，Data：ccz181078\n\n### 样例解释\n\n原序列为 $1\\ 4\\ 2\\ 8\\ 3$。\n\n将区间 $[1,3]$ 排序，得到 $[1\\ 2\\ 4]\\ 8\\ 3$。\n\n将区间 $[2,4]$ 与 $5$ 按位取异或，$2\\ \\mathrm{xor}\\ 5 = 7$，$4\\  \\mathrm{xor}\\ 5 = 1$，$8\\ \\mathrm{xor}\\ 5 = 13$，得到 $1\\ [7\\ 1\\ 13]\\ 3$。\n\n查询区间 $[1,2]$ 的异或和，$[1\\ 7]\\ 1\\ 13\\ 3$，$1\\ \\mathrm{xor}\\ 7 = 6$。\n\n### 数据范围\n\n$1 \\le n,m \\le 10^5$，$0 \\le a_i,x<10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] Ynoi", "background": "", "description": "Maintain a sequence $a_1,a_2,a_3,\\ldots,a_n$ consisting of $n$ non-negative integers, and support three operations:\n\n1. Given an interval $[l,r]$, apply XOR with $x$ to every number in this interval.\n2. Given an interval $[l,r]$, sort the numbers in this interval in non-decreasing order.\n3. Given an interval $[l,r]$, compute the XOR sum of the numbers in this interval.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers $a_i$, representing the original sequence.\n\nThe next $m$ lines describe the operations. Each line contains three integers $opt,l,r$ ($opt\\in\\{2,3\\}$), or four integers $opt,l,r,x$ ($opt=1$), representing the corresponding operation.", "outputFormat": "For each operation $3$, output one line with the corresponding answer.", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078&nzhtl1477, Data: ccz181078.\n\n### Sample Explanation\n\nThe original sequence is $1\\ 4\\ 2\\ 8\\ 3$.\n\nSort the interval $[1,3]$, getting $[1\\ 2\\ 4]\\ 8\\ 3$.\n\nApply bitwise XOR with $5$ to the interval $[2,4]$: $2\\ \\mathrm{xor}\\ 5 = 7$, $4\\  \\mathrm{xor}\\ 5 = 1$, $8\\ \\mathrm{xor}\\ 5 = 13$, getting $1\\ [7\\ 1\\ 13]\\ 3$.\n\nQuery the XOR sum of the interval $[1,2]$: $[1\\ 7]\\ 1\\ 13\\ 3$, $1\\ \\mathrm{xor}\\ 7 = 6$.\n\n### Constraints\n\n$1 \\le n,m \\le 10^5$, $0 \\le a_i,x<10^8$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] Ynoi", "background": null, "description": "维护一个由 $n$ 个非负整数构成的序列 $a_1,a_2,a_3,\\ldots,a_n$，支持三种操作：\n\n1. 给定区间 $[l,r]$，将对应区间内的数异或上 $x$。\n2. 给定区间 $[l,r]$，将对应区间内的数从小到大排序。\n3. 给定区间 $[l,r]$，求区间内的数的异或和。", "inputFormat": "第一行 $n,m$ 两个整数。\n\n第二行 $n$ 个整数 $a_i$，表示原序列。\n\n接下来 $m$ 行，每行三个整数 $opt,l,r$（$opt\\in\\{2,3\\}$）或四个整数\n $opt,l,r,x$（$opt=1$）表示对应的操作。", "outputFormat": "对每个操作 $3$，输出一行，表示对应的答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078&nzhtl1477，Data：ccz181078\n\n### 样例解释\n\n原序列为 $1\\ 4\\ 2\\ 8\\ 3$。\n\n将区间 $[1,3]$ 排序，得到 $[1\\ 2\\ 4]\\ 8\\ 3$。\n\n将区间 $[2,4]$ 与 $5$ 按位取异或，$2\\ \\mathrm{xor}\\ 5 = 7$，$4\\  \\mathrm{xor}\\ 5 = 1$，$8\\ \\mathrm{xor}\\ 5 = 13$，得到 $1\\ [7\\ 1\\ 13]\\ 3$。\n\n查询区间 $[1,2]$ 的异或和，$[1\\ 7]\\ 1\\ 13\\ 3$，$1\\ \\mathrm{xor}\\ 7 = 6$。\n\n### 数据范围\n\n$1 \\le n,m \\le 10^5$，$0 \\le a_i,x<10^8$。", "locale": "zh-CN"}}}
{"pid": "P5613", "type": "P", "difficulty": 1, "samples": [["10 5 0", "2"], ["31 4 2\n8 13", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2019", "洛谷原创", "O2优化", "洛谷月赛"], "title": "[MtOI2019] 黑蚊子多", "background": "", "description": "Hikari 的面前有 $n(1\\leq n\\leq 1000)$ 级台阶，每 $1s$ 她可以向上跳 $m(1\\leq m\\leq n)$ 级台阶。（不在中间的台阶上停留）\n\n台阶上有 $k(k\\leq 10)$ 个特殊的平台 $a_i$，Hikari 在该平台 **停留** 时会使得 $m$ 增加 $1$。\n\n请问 Hikari 到达台阶顶部花费的时间。", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行输入 $3$ 个非负整数 $n,m,k$。\n\n第 $2$ 行输入 $k$ 个正整数，第 $i$ 个正整数表示 $a_i$，保证输入的 $a_i$ 单调递增。", "outputFormat": "共 $1$ 行，输出 $1$ 个正整数表示花费的时间。", "hint": "### 子任务\n\n对于 $60\\%$ 的数据，$k=0$。\n\n对于 $100\\%$ 的数据，$1\\leq m\\leq n\\leq 1000$，$k\\leq 10$。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T1\n\n出题人：disangan233\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Too Many Black Mosquitoes", "background": "", "description": "There are $n(1\\leq n\\leq 1000)$ steps in front of Hikari. Every $1s$, she can jump upward by $m(1\\leq m\\leq n)$ steps (she does not stop on the steps in between).\n\nThere are $k(k\\leq 10)$ special platforms $a_i$ on the steps. When Hikari **stops** on such a platform, $m$ increases by $1$.\n\nAsk for the time Hikari spends to reach the top of the steps.", "inputFormat": "There are $2$ lines in total.\n\nThe first line contains $3$ non-negative integers $n, m, k$.\n\nThe second line contains $k$ positive integers. The $i$-th positive integer is $a_i$. It is guaranteed that the input $a_i$ are strictly increasing.", "outputFormat": "There is $1$ line in total. Output $1$ positive integer, the time spent.", "hint": "### Subtasks\n\nFor $60\\%$ of the testdata, $k = 0$.\n\nFor $100\\%$ of the testdata, $1\\leq m\\leq n\\leq 1000$, $k\\leq 10$.\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T1\n\nProblem setter: disangan233.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 黑蚊子多", "background": "", "description": "Hikari 的面前有 $n(1\\leq n\\leq 1000)$ 级台阶，每 $1s$ 她可以向上跳 $m(1\\leq m\\leq n)$ 级台阶。（不在中间的台阶上停留）\n\n台阶上有 $k(k\\leq 10)$ 个特殊的平台 $a_i$，Hikari 在该平台 **停留** 时会使得 $m$ 增加 $1$。\n\n请问 Hikari 到达台阶顶部花费的时间。", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行输入 $3$ 个非负整数 $n,m,k$。\n\n第 $2$ 行输入 $k$ 个正整数，第 $i$ 个正整数表示 $a_i$，保证输入的 $a_i$ 单调递增。", "outputFormat": "共 $1$ 行，输出 $1$ 个正整数表示花费的时间。", "hint": "### 子任务\n\n对于 $60\\%$ 的数据，$k=0$。\n\n对于 $100\\%$ 的数据，$1\\leq m\\leq n\\leq 1000$，$k\\leq 10$。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T1\n\n出题人：disangan233\n", "locale": "zh-CN"}}}
{"pid": "P5614", "type": "P", "difficulty": 3, "samples": [["5 200\n21 84 198\n38 47 102\n44 47 132 \n63 150 166\n76 79 132", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "洛谷原创", "O2优化", "枚举", "洛谷月赛"], "title": "[MtOI2019] 膜Siyuan", "background": "你强归你强，$\\mathsf S\\mathsf{\\color{red} iyuan}$ 比你强。——$\\mathsf S \\mathsf{\\color{red} iyuan}$\n\ndisangan233 最近发现了一款 OIer 们的游戏：[膜 $\\color{black} \\mathsf S \\mathsf{\\color{red} iyuan}$](https://lmoliver.github.io/mosiyuan/index.html)。\n\n他被里面的「真理 IV」所困惑，于是他找到了你寻求帮助。\n", "description": "给你 $1$ 个正整数 $M$，$n(n\\leq 5)$ 个正整数 $3$ 元组 $\\{a_i,b_i,c_i\\}(a_i,b_i,c_i\\leq M\\leq 2000)$，请你求出所有满足\n\n$$\n\\forall i\\leq n ,s.t.~|a_i-x|\\oplus |b_i-y|\\oplus |c_i-z| = 9\n$$\n\n的**有序**正整数 $3$ 元组 $\\{x,y,z\\}(x,y,z \\leq M)$的个数。\n\n其中，$\\forall$ 表示 \"对于所有\"，$s.t.$ 表示 \"使得\"，$A \\oplus B \\oplus C$ 表示 $A,B,C$ 的异或和。\n\n对于 C++，`A^B^C` 或 `A xor B xor C` 即为 $A \\oplus B \\oplus C$ 的答案 。\n\n这里提供一份模板：\n\n```cpp\nif ((a ^ b ^ c) == 9) \n{\n\tYour code here...\n}\n```\n\n对于 $2$ 个有序 $3$ 元组 $A,B$，如果 $x_A \\not =x_B$ 或 $y_A \\not =y_B$ 或 $z_A \\not =z_B$，$A,B$ 即被视为是不同的。\n", "inputFormat": "共 $n+1$ 行。\n\n第 $1$ 行输入 $2$ 个正整数 $n$，$M$。\n\n接下来 $n$ 行第 $i$ 行输入 $3$ 个正整数 $a_i,b_i,c_i$。", "outputFormat": "共 $1$ 行，输出 $1$ 个非负整数表示所求答案。", "hint": "#### 样例解释 $1$\n\n所有满足条件的 $\\{x,y,z\\}$ 有： \n\n$\\{88,88,120\\}$，$\\{88,104,104\\}$，$\\{120,120,120\\}$ 和 $\\{120,136,104\\}$。\n\n共 $4$ 个。\n\n### 子任务\n\n对于 $10\\%$ 的数据，保证与样例完全一致。\n\n对于 $60\\%$ 的数据，保证 $M\\leq 200$。\n\n对于所有数据，保证 $a_i,b_i,c_i\\leq M\\leq 2000$，$n\\leq 5$。\n\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T2\n\n出题人：disangan233\n\n验题人：Studying Father\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Mo Siyuan", "background": "You are strong if you are strong, but $\\mathsf S\\mathsf{\\color{red} iyuan}$ is stronger than you. ——$\\mathsf S \\mathsf{\\color{red} iyuan}$.\n\nRecently, disangan233 found a game for OIers: [Mo $\\color{black} \\mathsf S \\mathsf{\\color{red} iyuan}$](https://lmoliver.github.io/mosiyuan/index.html).\n\nHe was confused by “Truth IV” in it, so he came to you for help.", "description": "You are given $1$ positive integer $M$ and $n$ $(n\\leq 5)$ positive-integer triples $\\{a_i,b_i,c_i\\}$ $(a_i,b_i,c_i\\leq M\\leq 2000)$. Please find the number of all **ordered** positive-integer triples $\\{x,y,z\\}$ $(x,y,z \\leq M)$ that satisfy:\n\n$$\n\\forall i\\leq n ,s.t.~|a_i-x|\\oplus |b_i-y|\\oplus |c_i-z| = 9\n$$\n\nHere, $\\forall$ means “for all”, $s.t.$ means “such that”, and $A \\oplus B \\oplus C$ is the XOR of $A,B,C$.\n\nIn C++, `A^B^C` or `A xor B xor C` is exactly the value of $A \\oplus B \\oplus C$.\n\nA template is provided here:\n\n```cpp\nif ((a ^ b ^ c) == 9) \n{\n\tYour code here...\n}\n```\n\nFor two ordered triples $A,B$, if $x_A \\not =x_B$ or $y_A \\not =y_B$ or $z_A \\not =z_B$, then $A$ and $B$ are considered different.", "inputFormat": "There are $n+1$ lines in total.\n\nThe first line contains $2$ positive integers $n$ and $M$.\n\nIn the next $n$ lines, the $i$-th line contains $3$ positive integers $a_i,b_i,c_i$.", "outputFormat": "There is $1$ line in total. Output $1$ non-negative integer, which is the required answer.", "hint": "#### Sample Explanation 1\n\nAll $\\{x,y,z\\}$ that satisfy the conditions are:\n\n$\\{88,88,120\\}$, $\\{88,104,104\\}$, $\\{120,120,120\\}$, and $\\{120,136,104\\}$.\n\nThere are $4$ in total.\n\n### Subtasks\n\nFor $10\\%$ of the data, it is guaranteed to be exactly the same as the sample.\n\nFor $60\\%$ of the data, it is guaranteed that $M\\leq 200$.\n\nFor all data, it is guaranteed that $a_i,b_i,c_i\\leq M\\leq 2000$ and $n\\leq 5$.\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T2.\n\nProblem setter: disangan233.\n\nProblem tester: Studying Father.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 膜Siyuan", "background": "你强归你强，$\\mathsf S\\mathsf{\\color{red} iyuan}$ 比你强。——$\\mathsf S \\mathsf{\\color{red} iyuan}$\n\ndisangan233 最近发现了一款 OIer 们的游戏：[膜 $\\color{black} \\mathsf S \\mathsf{\\color{red} iyuan}$](https://lmoliver.github.io/mosiyuan/index.html)。\n\n他被里面的「真理 IV」所困惑，于是他找到了你寻求帮助。\n", "description": "给你 $1$ 个正整数 $M$，$n(n\\leq 5)$ 个正整数 $3$ 元组 $\\{a_i,b_i,c_i\\}(a_i,b_i,c_i\\leq M\\leq 2000)$，请你求出所有满足\n\n$$\n\\forall i\\leq n ,s.t.~|a_i-x|\\oplus |b_i-y|\\oplus |c_i-z| = 9\n$$\n\n的**有序**正整数 $3$ 元组 $\\{x,y,z\\}(x,y,z \\leq M)$的个数。\n\n其中，$\\forall$ 表示 \"对于所有\"，$s.t.$ 表示 \"使得\"，$A \\oplus B \\oplus C$ 表示 $A,B,C$ 的异或和。\n\n对于 C++，`A^B^C` 或 `A xor B xor C` 即为 $A \\oplus B \\oplus C$ 的答案 。\n\n这里提供一份模板：\n\n```cpp\nif ((a ^ b ^ c) == 9) \n{\n\tYour code here...\n}\n```\n\n对于 $2$ 个有序 $3$ 元组 $A,B$，如果 $x_A \\not =x_B$ 或 $y_A \\not =y_B$ 或 $z_A \\not =z_B$，$A,B$ 即被视为是不同的。\n", "inputFormat": "共 $n+1$ 行。\n\n第 $1$ 行输入 $2$ 个正整数 $n$，$M$。\n\n接下来 $n$ 行第 $i$ 行输入 $3$ 个正整数 $a_i,b_i,c_i$。", "outputFormat": "共 $1$ 行，输出 $1$ 个非负整数表示所求答案。", "hint": "#### 样例解释 $1$\n\n所有满足条件的 $\\{x,y,z\\}$ 有： \n\n$\\{88,88,120\\}$，$\\{88,104,104\\}$，$\\{120,120,120\\}$ 和 $\\{120,136,104\\}$。\n\n共 $4$ 个。\n\n### 子任务\n\n对于 $10\\%$ 的数据，保证与样例完全一致。\n\n对于 $60\\%$ 的数据，保证 $M\\leq 200$。\n\n对于所有数据，保证 $a_i,b_i,c_i\\leq M\\leq 2000$，$n\\leq 5$。\n\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T2\n\n出题人：disangan233\n\n验题人：Studying Father\n", "locale": "zh-CN"}}}
{"pid": "P5615", "type": "P", "difficulty": 5, "samples": [["5\n1\n2\n3\n4\n5\n\n", "0\n0\n0\n937500007\n562500005"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "2019", "洛谷原创", "O2优化", "洛谷月赛"], "title": "[MtOI2019] 时间跳跃", "background": "就算知道方法，也绝对不能去改变过去，绝不能将存在的可能性转变为既定的现实，未来是没有人能预测的，是无法重来的，正因如此人们才能接受各种痛苦，不幸与飞来横祸，迈步前进。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tz4v415b.png)", "description": "因为某些原因，Rintaro 欠了 Mayuri 一根香蕉。\n\n为了封上 Mayuri 的嘴，Rintaro 与 Mayuri 约定，只要 Mayuri 答对这个问题，Mayuri 想要多少香蕉都没问题：\n\n---\n\n机关有 $N$ 条秘密通道，第 $i$ 条秘密通道的长度为 $i$，机关会从 $2^n$ 种选择方式种**等概率**随机选出一些秘密通道，如果选出来的这些秘密通道能组成一个凸多边形，那么这个方案的权值就是选出的秘密通道数量，否则权值为 $0$。\n\n那么请你求出选出来秘密通道的权值的期望模 $10^9+7$ 的值。（两种选择秘密通道的方案不同当且仅当存在一个秘密通道，在一个方案中被选择，而在另一个方案中未被选择。注意，空集也算一个方案。）\n\n---\n\nKurisu：这不就只要...\n\nRintaro：助手你闭嘴！\n\nMayuri 在纸上画呀画，结果啥也没画出来，于是 Mayuri 就只能找你帮忙了。", "inputFormat": "输入共 $T+1$ 行。\n\n第一行一个正整数 $T$ 表示有 $T$ 次询问。\n\n接下来 $T$ 行，每行一个正整数表示这一次询问的 $N$。", "outputFormat": "你的输出应该包含一共 $T$ 行，第 $i$ 行一个非负整数表示询问的期望值模 $10^9+7$ 的值。", "hint": "#### 样例解释 1\n\n容易发现，当 $n$ 小于等于 $3$ 的时候是一定无法组成合法的多边形的。\n\n当 $n=4$ 的时候选出来的边长为这些集合的时候是权值不为 $0$ 的：\n\n$\\{1,2,3,4\\}$，$\\{2,3,4\\}$。\n\n答案就是 $\\frac{7}{16} \\equiv 937500007\\ (\\bmod 1000000007)$\n\n当 $n=5$ 的时候选出来的边长为这些集合的时候是权值不为 $0$ 的：\n\n$\\{1,2,3,4\\}$，$\\{2,3,4\\}$，$\\{1,2,3,5\\}$，$\\{2,3,4,5\\}$\n\n$\\{1,3,4,5\\}$，$\\{1,2,4,5\\}$，$\\{2,4,5\\}$，$\\{3,4,5\\}$，$\\{1,2,3,4,5\\}$。\n\n答案就是 $\\frac{34}{32} \\equiv 562500005\\ (\\bmod 1000000007)$\n\n### 子任务\n\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5000$，$1\\leq T \\leq 5000$\n\n本题共 $5$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$20$分）：$1 \\leq n \\leq 10$。\n\n子任务 $2$（$30$分）：$1 \\leq n \\leq 20$。\n\n子任务 $3$（$15$分）：$1 \\leq n \\leq 50$。\n\n子任务 $4$（$15$分）：$1 \\leq n \\leq 300$。\n\n子任务 $5$（$20$分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T3\n\n出题人：CYJian \n\n验题人：suwAKow\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Time Jump", "background": "Even if you know the method, you must never change the past. You must never turn a possible existence into a fixed reality. No one can predict the future, and it cannot be redone. Precisely because of this, people can accept all kinds of pain, misfortune, and sudden disasters, and keep moving forward.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tz4v415b.png)", "description": "For some reason, Rintaro owes Mayuri one banana.\n\nTo shut Mayuri up, Rintaro makes a deal with Mayuri: as long as Mayuri answers this question correctly, Mayuri can have as many bananas as she wants:\n\n---\n\nThere are $N$ secret passages in the mechanism. The length of the $i$-th secret passage is $i$. The mechanism will randomly choose some secret passages from the $2^n$ possible selection plans with **equal probability**. If the selected secret passages can form a convex polygon, then the weight of this plan is the number of selected secret passages; otherwise, the weight is $0$.\n\nNow please compute the expected value of the weight of the selected secret passages modulo $10^9+7$. (Two selection plans are different if and only if there exists a secret passage that is selected in one plan but not selected in the other. Note that the empty set is also a plan.)\n\n---\n\nKurisu: Then isn’t this just...\n\nRintaro: Assistant, shut up!\n\nMayuri drew and drew on the paper, but ended up drawing nothing. So Mayuri can only ask you for help.", "inputFormat": "The input has $T+1$ lines in total.\n\nThe first line contains a positive integer $T$, meaning there are $T$ queries.\n\nThe next $T$ lines each contain one positive integer, representing $N$ for this query.", "outputFormat": "Your output should contain exactly $T$ lines. The $i$-th line contains a non-negative integer representing the expected value for the query modulo $10^9+7$.", "hint": "#### Sample Explanation 1\n\nIt is easy to see that when $n$ is less than or equal to $3$, it is impossible to form a valid polygon.\n\nWhen $n=4$, the following sets of chosen side lengths have non-zero weight:\n\n$\\{1,2,3,4\\}$, $\\{2,3,4\\}$.\n\nThe answer is $\\frac{7}{16} \\equiv 937500007\\ (\\bmod 1000000007)$.\n\nWhen $n=5$, the following sets of chosen side lengths have non-zero weight:\n\n$\\{1,2,3,4\\}$, $\\{2,3,4\\}$, $\\{1,2,3,5\\}$, $\\{2,3,4,5\\}$\n\n$\\{1,3,4,5\\}$, $\\{1,2,4,5\\}$, $\\{2,4,5\\}$, $\\{3,4,5\\}$, $\\{1,2,3,4,5\\}$.\n\nThe answer is $\\frac{34}{32} \\equiv 562500005\\ (\\bmod 1000000007)$.\n\n### Subtasks\n\nThis problem uses bundled testdata.\n\nFor $100\\%$ of the data, $1\\leq n\\leq 5000$, $1\\leq T \\leq 5000$.\n\nThere are $5$ subtasks in total. The score and limits of each subtask are as follows:\n\nSubtask $1$ ($20$ points): $1 \\leq n \\leq 10$.\n\nSubtask $2$ ($30$ points): $1 \\leq n \\leq 20$.\n\nSubtask $3$ ($15$ points): $1 \\leq n \\leq 50$.\n\nSubtask $4$ ($15$ points): $1 \\leq n \\leq 300$.\n\nSubtask $5$ ($20$ points): no special restrictions.\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T3\n\nProblem setter: CYJian\n\nChecker: suwAKow\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 时间跳跃", "background": "就算知道方法，也绝对不能去改变过去，绝不能将存在的可能性转变为既定的现实，未来是没有人能预测的，是无法重来的，正因如此人们才能接受各种痛苦，不幸与飞来横祸，迈步前进。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tz4v415b.png)", "description": "因为某些原因，Rintaro 欠了 Mayuri 一根香蕉。\n\n为了封上 Mayuri 的嘴，Rintaro 与 Mayuri 约定，只要 Mayuri 答对这个问题，Mayuri 想要多少香蕉都没问题：\n\n---\n\n机关有 $N$ 条秘密通道，第 $i$ 条秘密通道的长度为 $i$，机关会从 $2^n$ 种选择方式种**等概率**随机选出一些秘密通道，如果选出来的这些秘密通道能组成一个凸多边形，那么这个方案的权值就是选出的秘密通道数量，否则权值为 $0$。\n\n那么请你求出选出来秘密通道的权值的期望模 $10^9+7$ 的值。（两种选择秘密通道的方案不同当且仅当存在一个秘密通道，在一个方案中被选择，而在另一个方案中未被选择。注意，空集也算一个方案。）\n\n---\n\nKurisu：这不就只要...\n\nRintaro：助手你闭嘴！\n\nMayuri 在纸上画呀画，结果啥也没画出来，于是 Mayuri 就只能找你帮忙了。", "inputFormat": "输入共 $T+1$ 行。\n\n第一行一个正整数 $T$ 表示有 $T$ 次询问。\n\n接下来 $T$ 行，每行一个正整数表示这一次询问的 $N$。", "outputFormat": "你的输出应该包含一共 $T$ 行，第 $i$ 行一个非负整数表示询问的期望值模 $10^9+7$ 的值。", "hint": "#### 样例解释 1\n\n容易发现，当 $n$ 小于等于 $3$ 的时候是一定无法组成合法的多边形的。\n\n当 $n=4$ 的时候选出来的边长为这些集合的时候是权值不为 $0$ 的：\n\n$\\{1,2,3,4\\}$，$\\{2,3,4\\}$。\n\n答案就是 $\\frac{7}{16} \\equiv 937500007\\ (\\bmod 1000000007)$\n\n当 $n=5$ 的时候选出来的边长为这些集合的时候是权值不为 $0$ 的：\n\n$\\{1,2,3,4\\}$，$\\{2,3,4\\}$，$\\{1,2,3,5\\}$，$\\{2,3,4,5\\}$\n\n$\\{1,3,4,5\\}$，$\\{1,2,4,5\\}$，$\\{2,4,5\\}$，$\\{3,4,5\\}$，$\\{1,2,3,4,5\\}$。\n\n答案就是 $\\frac{34}{32} \\equiv 562500005\\ (\\bmod 1000000007)$\n\n### 子任务\n\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5000$，$1\\leq T \\leq 5000$\n\n本题共 $5$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$20$分）：$1 \\leq n \\leq 10$。\n\n子任务 $2$（$30$分）：$1 \\leq n \\leq 20$。\n\n子任务 $3$（$15$分）：$1 \\leq n \\leq 50$。\n\n子任务 $4$（$15$分）：$1 \\leq n \\leq 300$。\n\n子任务 $5$（$20$分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T3\n\n出题人：CYJian \n\n验题人：suwAKow\n", "locale": "zh-CN"}}}
{"pid": "P5616", "type": "P", "difficulty": 6, "samples": [["3 998244353\n1 2 3", "24"], ["10 998244353\n1 2 3 4 5 6 7 8 9 10", "516032"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "2019", "洛谷原创", "O2优化", "期望", "洛谷月赛"], "title": "[MtOI2019] 恶魔之树", "background": "在 Kirito 和 Eugeo 还没有与 Alice 前往北之洞窟的时候，Eugeo 每天只能用龙骨斧砍恶魔之树——基家斯西达……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95swctde.png)\n\n~~请忽略bilibili的水印~~", "description": "Kirito 和 Eugeo 每天砍树觉得很无聊，于是开始比谁砍出好声音的次数多。渐渐地，他们发现这样也没有意思了，于是在这个基础上改了一点：\n\n每个人去砍树前，会随机得到一个长度为 $n$ 的数列 $s_1, s_2, \\dots, s_n$ 。最初每个人的得分都是 $1$，当第 $i$ 次砍出了一个好声音时，得分就变成了原来的得分与 $s_i$ 的最小公倍数，也就是常说的 ${\\rm lcm}$。\n\n现在 Kirito 已经得到了一个长度为 $n$ 的数列 $s_1, s_2, \\ldots, s_n$ 。他想知道，如果每一次砍出好声音的概率是 $50\\%$ 时他的期望得分。\n\n由于 Kirito 不想看到小数，所以请你告诉 Kirito 答案乘 $2^n$ 对 $p$ 取模的值。", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行包含 $2$ 个正整数 $n$ 和 $p$ ，代表数列的长度和给定的模数。**保证模数为质数**\n\n第 $2$ 行包含 $n$ 个正整数，第 $i$ 个数代表 $s_i$。", "outputFormat": "共 $1$ 行，包含 $1$ 个正整数，代表得分的期望值乘 $2^n$ 对 $p$ 取模的结果。\n", "hint": "#### 样例解释 1\n\n一共有 $8$ 种情况：\n\n- 没有出现好声音，得分为 $1$，概率为 $\\frac{1}{8}$。\n\n- 只有第一次出现了好声音，得分为 $1$，概率为 $\\frac{1}{8}$。\n\n- 只有第二次出现了好声音，得分为 $2$，概率为 $\\frac{1}{8}$。\n\n- 只有第三次出现了好声音，得分为 $3$，概率为 $\\frac{1}{8}$。\n\n- 只有第三次没有出现好声音，得分为 $\\operatorname{lcm}(1, 2)=2$，概率为 $\\frac{1}{8}$。\n\n- 只有第二次没有出现好声音，得分为 $\\operatorname{lcm}(1, 3)=3$，概率为 $\\frac{1}{8}$。\n\n- 只有第一次没有出现好声音，得分为 $\\operatorname{lcm}(2, 3)=6$，概率为 $\\frac{1}{8}$。\n\n- 每一次都砍出了好声音，得分为 $\\operatorname{lcm}(1, 2, 3)=6$，概率为 $\\frac{1}{8}$。\n\n所以期望值为 $\\frac{1}{8}+\\frac{1}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{6}{8}+\\frac{6}{8}=3$\n\n乘上 $2^3$ 得到答案为 $24$。\n\n### 子任务\n\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 3\\times 10^5$，$10^7 \\leq p \\leq 1.1 \\times 10^9$且$p$为质数，$1\\leq s_i\\leq 300$。\n\n本题共 $7$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$3$ 分）：$n=1$。\n\n子任务 $2$（$7$ 分）：$n=18$。\n\n子任务 $3$（$10$ 分）：$n=100$，$s$ 中不同的正整数不超过 $18$ 个。\n\n子任务 $4$（$20$ 分）：$n=100$，不存在 $1\\leq i \\neq j \\leq n$，使得 $s_i=s_j$。且保证数据随机。\n\n子任务 $5$（$20$ 分）：$1\\leq s_1, s_2, \\ldots, s_n \\leq 100$。\n\n子任务 $6$（$20$ 分）：$1\\leq n \\leq 10^4$。\n\n子任务 $7$（$20$ 分）：无特殊限制。\n\n------\n\n谨以此题庆祝刀剑10周年。~~好像晚了几个月...~~\n\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T4\n\n出题人：CYJian \n\n验题人：suwAKow\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Demon Tree.", "background": "Before Kirito and Eugeo went with Alice to the Northern Cave, Eugeo could only chop the Demon Tree—Gigas Cedar—every day with the Dragon Bone Axe...\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95swctde.png)\n\n~~Please ignore bilibili’s watermark.~~", "description": "Kirito and Eugeo felt bored chopping trees every day, so they started competing to see who could produce more “good sounds” while chopping. Gradually, they found this was still not interesting, so they changed the rules a bit based on that:\n\nBefore each person chops the tree, they will randomly get a sequence $s_1, s_2, \\dots, s_n$ of length $n$. At the beginning, everyone’s score is $1$. When a “good sound” occurs on the $i$-th chop, the score becomes the least common multiple of the original score and $s_i$, which is commonly called ${\\rm lcm}$.\n\nNow Kirito has obtained a sequence $s_1, s_2, \\ldots, s_n$ of length $n$. He wants to know his expected score if the probability of getting a “good sound” on each chop is $50\\%$.\n\nSince Kirito does not want to see decimals, please tell Kirito the value of the answer multiplied by $2^n$ modulo $p$.", "inputFormat": "There are $2$ lines in total.\n\nThe $1$-st line contains $2$ positive integers $n$ and $p$, representing the length of the sequence and the given modulus. **It is guaranteed that the modulus is a prime number.**\n\nThe $2$-nd line contains $n$ positive integers. The $i$-th number represents $s_i$.", "outputFormat": "There is $1$ line in total, containing $1$ positive integer, representing the expected score multiplied by $2^n$ modulo $p$.", "hint": "#### Sample Explanation 1\n\nThere are $8$ possible cases in total:\n\n- No “good sound” occurs, the score is $1$, and the probability is $\\frac{1}{8}$.\n\n- Only the first time has a “good sound”, the score is $1$, and the probability is $\\frac{1}{8}$.\n\n- Only the second time has a “good sound”, the score is $2$, and the probability is $\\frac{1}{8}$.\n\n- Only the third time has a “good sound”, the score is $3$, and the probability is $\\frac{1}{8}$.\n\n- Only the third time does not have a “good sound”, the score is $\\operatorname{lcm}(1, 2)=2$, and the probability is $\\frac{1}{8}$.\n\n- Only the second time does not have a “good sound”, the score is $\\operatorname{lcm}(1, 3)=3$, and the probability is $\\frac{1}{8}$.\n\n- Only the first time does not have a “good sound”, the score is $\\operatorname{lcm}(2, 3)=6$, and the probability is $\\frac{1}{8}$.\n\n- Every time produces a “good sound”, the score is $\\operatorname{lcm}(1, 2, 3)=6$, and the probability is $\\frac{1}{8}$.\n\nSo the expected value is $\\frac{1}{8}+\\frac{1}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{6}{8}+\\frac{6}{8}=3$.\n\nAfter multiplying by $2^3$, the answer is $24$.\n\n### Subtasks\n\nThis problem uses bundled test.\n\nFor $100\\%$ of the data, $1\\leq n\\leq 3\\times 10^5$, $10^7 \\leq p \\leq 1.1 \\times 10^9$ and $p$ is a prime number, and $1\\leq s_i\\leq 300$.\n\nThis problem has $7$ subtasks. The score and constraints of each subtask are as follows:\n\nSubtask $1$ ($3$ points): $n=1$.\n\nSubtask $2$ ($7$ points): $n=18$.\n\nSubtask $3$ ($10$ points): $n=100$, and the number of distinct positive integers in $s$ is at most $18$.\n\nSubtask $4$ ($20$ points): $n=100$, and there do not exist $1\\leq i \\neq j \\leq n$ such that $s_i=s_j$. It is also guaranteed that the testdata is random.\n\nSubtask $5$ ($20$ points): $1\\leq s_1, s_2, \\ldots, s_n \\leq 100$.\n\nSubtask $6$ ($20$ points): $1\\leq n \\leq 10^4$.\n\nSubtask $7$ ($20$ points): No special constraints.\n\n------\n\nThis problem is dedicated to celebrating the 10th anniversary of Sword Art Online. ~~Seems like it is a few months late...~~\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T4\n\nProblem setter: CYJian.\n\nProblem reviewer: suwAKow.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 恶魔之树", "background": "在 Kirito 和 Eugeo 还没有与 Alice 前往北之洞窟的时候，Eugeo 每天只能用龙骨斧砍恶魔之树——基家斯西达……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95swctde.png)\n\n~~请忽略bilibili的水印~~", "description": "Kirito 和 Eugeo 每天砍树觉得很无聊，于是开始比谁砍出好声音的次数多。渐渐地，他们发现这样也没有意思了，于是在这个基础上改了一点：\n\n每个人去砍树前，会随机得到一个长度为 $n$ 的数列 $s_1, s_2, \\dots, s_n$ 。最初每个人的得分都是 $1$，当第 $i$ 次砍出了一个好声音时，得分就变成了原来的得分与 $s_i$ 的最小公倍数，也就是常说的 ${\\rm lcm}$。\n\n现在 Kirito 已经得到了一个长度为 $n$ 的数列 $s_1, s_2, \\ldots, s_n$ 。他想知道，如果每一次砍出好声音的概率是 $50\\%$ 时他的期望得分。\n\n由于 Kirito 不想看到小数，所以请你告诉 Kirito 答案乘 $2^n$ 对 $p$ 取模的值。", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行包含 $2$ 个正整数 $n$ 和 $p$ ，代表数列的长度和给定的模数。**保证模数为质数**\n\n第 $2$ 行包含 $n$ 个正整数，第 $i$ 个数代表 $s_i$。", "outputFormat": "共 $1$ 行，包含 $1$ 个正整数，代表得分的期望值乘 $2^n$ 对 $p$ 取模的结果。\n", "hint": "#### 样例解释 1\n\n一共有 $8$ 种情况：\n\n- 没有出现好声音，得分为 $1$，概率为 $\\frac{1}{8}$。\n\n- 只有第一次出现了好声音，得分为 $1$，概率为 $\\frac{1}{8}$。\n\n- 只有第二次出现了好声音，得分为 $2$，概率为 $\\frac{1}{8}$。\n\n- 只有第三次出现了好声音，得分为 $3$，概率为 $\\frac{1}{8}$。\n\n- 只有第三次没有出现好声音，得分为 $\\operatorname{lcm}(1, 2)=2$，概率为 $\\frac{1}{8}$。\n\n- 只有第二次没有出现好声音，得分为 $\\operatorname{lcm}(1, 3)=3$，概率为 $\\frac{1}{8}$。\n\n- 只有第一次没有出现好声音，得分为 $\\operatorname{lcm}(2, 3)=6$，概率为 $\\frac{1}{8}$。\n\n- 每一次都砍出了好声音，得分为 $\\operatorname{lcm}(1, 2, 3)=6$，概率为 $\\frac{1}{8}$。\n\n所以期望值为 $\\frac{1}{8}+\\frac{1}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{6}{8}+\\frac{6}{8}=3$\n\n乘上 $2^3$ 得到答案为 $24$。\n\n### 子任务\n\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 3\\times 10^5$，$10^7 \\leq p \\leq 1.1 \\times 10^9$且$p$为质数，$1\\leq s_i\\leq 300$。\n\n本题共 $7$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$3$ 分）：$n=1$。\n\n子任务 $2$（$7$ 分）：$n=18$。\n\n子任务 $3$（$10$ 分）：$n=100$，$s$ 中不同的正整数不超过 $18$ 个。\n\n子任务 $4$（$20$ 分）：$n=100$，不存在 $1\\leq i \\neq j \\leq n$，使得 $s_i=s_j$。且保证数据随机。\n\n子任务 $5$（$20$ 分）：$1\\leq s_1, s_2, \\ldots, s_n \\leq 100$。\n\n子任务 $6$（$20$ 分）：$1\\leq n \\leq 10^4$。\n\n子任务 $7$（$20$ 分）：无特殊限制。\n\n------\n\n谨以此题庆祝刀剑10周年。~~好像晚了几个月...~~\n\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T4\n\n出题人：CYJian \n\n验题人：suwAKow\n", "locale": "zh-CN"}}}
{"pid": "P5617", "type": "P", "difficulty": 7, "samples": [["8 5 2\n1 3 7 11 15 21 27 33", "62.83185307"], ["8 5 8\n1 3 7 11 15 21 27 33", "686.19551835"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "数学", "计算几何", "2019", "洛谷原创", "Special Judge", "O2优化", "洛谷月赛"], "title": "[MtOI2019] 不可视境界线", "background": "「爆ぜろリアル！弾けろシナプス！パニッシュメント......ディス、ワールド！」  \n「爆裂吧，现实！粉碎吧，精神！放逐这个世界！」  \n", "description": "Rikka 坚信，她的父亲在「不可视境界线」中，等待着她的到来。在 Rikka 的梦里，「不可视境界线」出现了，那是 $n$ 个圆组成的图形。\n\n具体地，有一个平面直角坐标系，坐标系的 $x$ 轴上有 $n$ 个点，第 $i$ 个点的坐标为 $(x_i,0)$。\n\nRikka 以每一个点作为圆心，作了 $n$ 个半径为 $r$ 的圆。她本想让你帮她计算这 $n$ 个圆的面积并，但是这个问题太简单了。\n\n在一番思考后，Rikka 想让你计算出选出 $k$ 个圆后（即删除 $n-k$ 个圆），圆的面积并的最大值。\n\n对于所有数据，有 $n,k\\leq 10^5$，$r\\leq 10^4$，$0\\leq x_i\\leq 10^9$，$x_i$ 为整数且不重复。保证输入的 $x_i$ 单调递增。\n\n因为答案太大了，Rikka 考虑到你的电脑无法保持高精度，所以只要你的答案与标准答案的 **相对误差** 小于 $5\\times 10^{-8}$，你的答案即被视为是正确的。\n\n经过误差分析，本题保证使用原生 `cmath` 函数不会出错，请注意控制程序精度误差。\n", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行输入 $3$ 个整数 $n$，$k$，$r$。\n\n第 $2$ 行输入 $n$ 个整数 $x_1\\ldots x_n$。\n", "outputFormat": "一行 $1$ 个实数，表示所求答案，保证答案小于 $10^{14}$。\n", "hint": "#### 样例解释 1\n\n显然，可以选出 $5$ 个不相交的半径为 $2$ 的圆。\n\n### 子任务\n\n对于 $100\\%$ 的数据，$n,k\\leq 10^5$，$r\\leq 10^4$，$0\\leq x_i\\leq 10^9$。\n\n本题采用捆绑测试，共有 $7$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$11$ 分）：$k=n$。\n\n子任务 $2$（$13$ 分）：$n,k,r \\leq 100$。\n\n子任务 $3$（$6$ 分）：$n,k \\leq 1000$，$r\\leq 20$。\n\n子任务 $4$（$15$ 分）：$n,k,r \\leq 2000$，保证数据随机生成。\n\n子任务 $5$（$23$ 分）：$r\\leq 20$。\n\n子任务 $6$（$12$ 分）：$k\\leq 20$，$x_n \\leq kr$。\n\n子任务 $7$（$20$ 分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T5\n\n出题人：disangan233\n\n验题人：suwAKow，_sys\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Invisible Boundary Line", "background": "「爆ぜろリアル！弾けろシナプス！パニッシュメント......ディス、ワールド！」  \n「Explode, reality! Shatter, mind! Banish this world!」", "description": "Rikka firmly believes that her father is waiting for her inside the “Invisible Boundary Line”. In Rikka’s dream, the “Invisible Boundary Line” appeared as a figure made up of $n$ circles.\n\nSpecifically, there is a Cartesian coordinate system. On the $x$-axis, there are $n$ points, and the $i$-th point is $(x_i,0)$.\n\nUsing each point as a center, Rikka drew $n$ circles with radius $r$. She originally wanted you to help her compute the union area of these $n$ circles, but that problem is too easy.\n\nAfter some thought, Rikka wants you to compute the maximum possible union area of the circles after selecting $k$ circles (i.e., deleting $n-k$ circles).\n\nFor all testdata, $n,k\\leq 10^5$, $r\\leq 10^4$, $0\\leq x_i\\leq 10^9$, $x_i$ are integers and pairwise distinct. It is guaranteed that the input $x_i$ are strictly increasing.\n\nBecause the answer is very large, and Rikka thinks your computer cannot maintain high precision, your answer will be considered correct as long as its **relative error** is less than $5\\times 10^{-8}$ compared to the standard answer.\n\nAfter error analysis, this problem guarantees that using the native `cmath` functions will not cause issues. Please pay attention to controlling precision errors in your program.", "inputFormat": "There are $2$ lines in total.\n\nLine $1$ contains $3$ integers $n$, $k$, and $r$.\n\nLine $2$ contains $n$ integers $x_1\\ldots x_n$.", "outputFormat": "Output one real number in one line, representing the required answer. It is guaranteed that the answer is less than $10^{14}$.", "hint": "#### Sample Explanation 1\n\nObviously, you can choose $5$ non-overlapping circles with radius $2$.\n\n### Subtasks\n\nFor $100\\%$ of the testdata, $n,k\\leq 10^5$, $r\\leq 10^4$, $0\\leq x_i\\leq 10^9$.\n\nThis problem uses bundled tests. There are $7$ subtasks, and the score and constraints of each subtask are as follows:\n\nSubtask $1$ ($11$ points): $k=n$.\n\nSubtask $2$ ($13$ points): $n,k,r \\leq 100$.\n\nSubtask $3$ ($6$ points): $n,k \\leq 1000$, $r\\leq 20$.\n\nSubtask $4$ ($15$ points): $n,k,r \\leq 2000$, and the testdata are guaranteed to be randomly generated.\n\nSubtask $5$ ($23$ points): $r\\leq 20$.\n\nSubtask $6$ ($12$ points): $k\\leq 20$, $x_n \\leq kr$.\n\nSubtask $7$ ($20$ points): no special constraints.\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T5\n\nProblem setter: disangan233\n\nProblem reviewer: suwAKow, _sys\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 不可视境界线", "background": "「爆ぜろリアル！弾けろシナプス！パニッシュメント......ディス、ワールド！」  \n「爆裂吧，现实！粉碎吧，精神！放逐这个世界！」  \n", "description": "Rikka 坚信，她的父亲在「不可视境界线」中，等待着她的到来。在 Rikka 的梦里，「不可视境界线」出现了，那是 $n$ 个圆组成的图形。\n\n具体地，有一个平面直角坐标系，坐标系的 $x$ 轴上有 $n$ 个点，第 $i$ 个点的坐标为 $(x_i,0)$。\n\nRikka 以每一个点作为圆心，作了 $n$ 个半径为 $r$ 的圆。她本想让你帮她计算这 $n$ 个圆的面积并，但是这个问题太简单了。\n\n在一番思考后，Rikka 想让你计算出选出 $k$ 个圆后（即删除 $n-k$ 个圆），圆的面积并的最大值。\n\n对于所有数据，有 $n,k\\leq 10^5$，$r\\leq 10^4$，$0\\leq x_i\\leq 10^9$，$x_i$ 为整数且不重复。保证输入的 $x_i$ 单调递增。\n\n因为答案太大了，Rikka 考虑到你的电脑无法保持高精度，所以只要你的答案与标准答案的 **相对误差** 小于 $5\\times 10^{-8}$，你的答案即被视为是正确的。\n\n经过误差分析，本题保证使用原生 `cmath` 函数不会出错，请注意控制程序精度误差。\n", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行输入 $3$ 个整数 $n$，$k$，$r$。\n\n第 $2$ 行输入 $n$ 个整数 $x_1\\ldots x_n$。\n", "outputFormat": "一行 $1$ 个实数，表示所求答案，保证答案小于 $10^{14}$。\n", "hint": "#### 样例解释 1\n\n显然，可以选出 $5$ 个不相交的半径为 $2$ 的圆。\n\n### 子任务\n\n对于 $100\\%$ 的数据，$n,k\\leq 10^5$，$r\\leq 10^4$，$0\\leq x_i\\leq 10^9$。\n\n本题采用捆绑测试，共有 $7$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$11$ 分）：$k=n$。\n\n子任务 $2$（$13$ 分）：$n,k,r \\leq 100$。\n\n子任务 $3$（$6$ 分）：$n,k \\leq 1000$，$r\\leq 20$。\n\n子任务 $4$（$15$ 分）：$n,k,r \\leq 2000$，保证数据随机生成。\n\n子任务 $5$（$23$ 分）：$r\\leq 20$。\n\n子任务 $6$（$12$ 分）：$k\\leq 20$，$x_n \\leq kr$。\n\n子任务 $7$（$20$ 分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T5\n\n出题人：disangan233\n\n验题人：suwAKow，_sys\n", "locale": "zh-CN"}}}
{"pid": "P5618", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2\n2 1\n3 1 2\nQ 1 3\nC 1 2 2 2 3\nQ 2 3", "7\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "各省省选", "山东"], "title": "[SDOI2015] 道路修建", "background": "", "description": "某国有 $2N$ 个城市，这 $2N$ 个城市构成了一个 $2$ 行 $N$ 列的方格网。现在该国政府有一个旅游发展计划，这个计划需要选定 $L$、$R$ 两列 $(L \\leq  R)$，修建若干条专用道路，使得这两列之间（包括这两列）的所有 $2(R-L+1)$ 个城市中每个城市可以只通过专用道路就可以到达这 $2(R-L+1)$ 个城市中的任何一个城市。这种专用道路只能在同一行相邻两列的城市或者同一列的两个城市之间修建，且修建需要花费一定的费用。\n\n由于该国政府决定尽量缩减开支，因此政府决定，选定 $L$、$R$ 后，只修建 $2(R-L+1)-1$ 条专用道路，使得这些专用道路构成一个树结构。现在你需要帮助该国政府写一个程序，完成这个任务。具体地，该任务包含 $M$ 个操作，每个操作的格式如下：\n\n1. ``C x0 y0 x1 y1 w``：由于重新对第 $x_0$ 行第 $y_0$ 列的城市和第 $x_1$ 行第 $y_1$ 列的城市之间的情况进行了考察，它们之间修建一条专用道路的花费变成了 $w$；\n\n2. ``Q L R``：若政府选定的两列分别为 $L$、$R$，询问政府的最小开支。", "inputFormat": "第一行，两个整数 $N$、$M$。  \n\n第二行，$N-1$ 个整数，其中第 $i$ 个整数表示初始时第 $1$ 行第 $i$ 列的城市和第 $1$ 行第 $i+1$ 列的城市之间修建一条专用道路的费用。  \n\n第三行，$N-1$ 个整数，其中第 $i$ 个整数表示初始时第 $2$ 行第 $i$ 列的城市和第 $2$ 行第 $i+1$ 列的城市之间修建一条专用道路的费用。  \n\n第四行，$N$ 个整数，其中第 $i$个整数表示初始时第 $1$ 行第 $i$ 列的城市和第 $2$ 行第 $i$ 列的城市之间修建一条专用道路的费用。  \n接下来的 $M$ 行，每行一个操作。", "outputFormat": "对于每个询问操作，输出一行，表示你计算出的政府的最小开支。", "hint": "对于全部的数据，$1 \\leq N, M \\leq 60000$，任何时刻任何一条专用道路的修建费用不超过 $10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2015] Road Construction", "background": "", "description": "A certain country has $2N$ cities. These $2N$ cities form a $2$-row, $N$-column grid. The government now has a tourism development plan: it needs to choose two columns $L$ and $R$ $(L \\leq R)$, and build some dedicated roads so that among all $2(R-L+1)$ cities between these two columns (including these two columns), every city can reach any other of these $2(R-L+1)$ cities using only the dedicated roads.\n\nA dedicated road can only be built between two cities in the same row and adjacent columns, or between the two cities in the same column, and building a road costs some amount.\n\nSince the government wants to reduce expenses as much as possible, after choosing $L$ and $R$, it will build only $2(R-L+1)-1$ dedicated roads, so that these roads form a tree structure. Now you need to help the government write a program to complete this task.\n\nSpecifically, the task contains $M$ operations, each in one of the following formats:\n\n1. `C x0 y0 x1 y1 w`: Because the situation between the city at row $x_0$, column $y_0$ and the city at row $x_1$, column $y_1$ has been re-evaluated, the cost to build a dedicated road between them becomes $w$.\n\n2. `Q L R`: If the government chooses columns $L$ and $R$, ask for the minimum total expense.", "inputFormat": "The first line contains two integers $N$ and $M$.\n\nThe second line contains $N-1$ integers. The $i$-th integer indicates the initial cost to build a dedicated road between the city at row $1$, column $i$ and the city at row $1$, column $i+1$.\n\nThe third line contains $N-1$ integers. The $i$-th integer indicates the initial cost to build a dedicated road between the city at row $2$, column $i$ and the city at row $2$, column $i+1$.\n\nThe fourth line contains $N$ integers. The $i$-th integer indicates the initial cost to build a dedicated road between the city at row $1$, column $i$ and the city at row $2$, column $i$.\n\nThe next $M$ lines each contain one operation.", "outputFormat": "For each query operation, output one line containing the minimum expense you computed for the government.", "hint": "For all testdata, $1 \\leq N, M \\leq 60000$, and at any time, the construction cost of any dedicated road does not exceed $10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2015] 道路修建", "background": "", "description": "某国有 $2N$ 个城市，这 $2N$ 个城市构成了一个 $2$ 行 $N$ 列的方格网。现在该国政府有一个旅游发展计划，这个计划需要选定 $L$、$R$ 两列 $(L \\leq  R)$，修建若干条专用道路，使得这两列之间（包括这两列）的所有 $2(R-L+1)$ 个城市中每个城市可以只通过专用道路就可以到达这 $2(R-L+1)$ 个城市中的任何一个城市。这种专用道路只能在同一行相邻两列的城市或者同一列的两个城市之间修建，且修建需要花费一定的费用。\n\n由于该国政府决定尽量缩减开支，因此政府决定，选定 $L$、$R$ 后，只修建 $2(R-L+1)-1$ 条专用道路，使得这些专用道路构成一个树结构。现在你需要帮助该国政府写一个程序，完成这个任务。具体地，该任务包含 $M$ 个操作，每个操作的格式如下：\n\n1. ``C x0 y0 x1 y1 w``：由于重新对第 $x_0$ 行第 $y_0$ 列的城市和第 $x_1$ 行第 $y_1$ 列的城市之间的情况进行了考察，它们之间修建一条专用道路的花费变成了 $w$；\n\n2. ``Q L R``：若政府选定的两列分别为 $L$、$R$，询问政府的最小开支。", "inputFormat": "第一行，两个整数 $N$、$M$。  \n\n第二行，$N-1$ 个整数，其中第 $i$ 个整数表示初始时第 $1$ 行第 $i$ 列的城市和第 $1$ 行第 $i+1$ 列的城市之间修建一条专用道路的费用。  \n\n第三行，$N-1$ 个整数，其中第 $i$ 个整数表示初始时第 $2$ 行第 $i$ 列的城市和第 $2$ 行第 $i+1$ 列的城市之间修建一条专用道路的费用。  \n\n第四行，$N$ 个整数，其中第 $i$个整数表示初始时第 $1$ 行第 $i$ 列的城市和第 $2$ 行第 $i$ 列的城市之间修建一条专用道路的费用。  \n接下来的 $M$ 行，每行一个操作。", "outputFormat": "对于每个询问操作，输出一行，表示你计算出的政府的最小开支。", "hint": "对于全部的数据，$1 \\leq N, M \\leq 60000$，任何时刻任何一条专用道路的修建费用不超过 $10^4$。", "locale": "zh-CN"}}}
{"pid": "P5619", "type": "P", "difficulty": 5, "samples": [["2 1\n1 2\n2 1\n1", "14445614"], ["5 3\n4 4 3 4 5\n1 2\n3 2\n2 4\n5 4\n3\n2\n1", "16251447"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "洛谷原创"], "title": "[DBOI2019] 持矢", "background": "```cpp\n吾射不亦精乎？\n——doby\n```", "description": "$doby$是一个弓箭手，他很喜欢拿箭。\n\n这天，他来到一个射箭场，发现射箭场老板放好了$n$个靶子（从$1-n$标号），中间画了$n-1$条线，使得这$n$格靶子和$n-1$条线组成了一个**根为**$1$的树。每个靶子上都有分数。\n\n他为了历练自己，选择了一个点（称为父点），然后对它子树（包括它）的每个靶子射一次，每个靶子射中概率为$50\\%$。每次射完一个子树，他获得的总分为射中的所有靶子的分数之**积**。\n\n现在他想知道，选择不同的点作为父点，他期望总分为多少？由于总分可能很大，你需要把结果对$19260817$（质数）取模。", "inputFormat": "输入两个正整数，靶子总数$n$和询问次数$m$。\n\n接下来一行，$n$个正整数，表示编号为$1-n$的靶子的分数。\n\n接下来$n-1$行，每行两个数$u,v$，描述树的一条无向边。\n\n接下来$m$行，每行一个正整数$x(1\\leq x\\leq n)$，表示询问以靶子$x$为父节点时，$doby$期望获得的总分。", "outputFormat": "输出一行，一个正整数$out$。\n\n为了减少输出，定义$out$为对于每组询问，期望获得的总分之和。由于是期望，需要你在计算$\\frac{a}{b}$时，将其改为$a*b^{-1} mod (19260817)$。你需要把输出$out$也对$19260817$取模。", "hint": "### 注意：由于模数较大，请注意求逆元时中间结果的溢出。\n\n如果你不需要卡常，使用快速幂求逆元就够用了。\n\n【样例#$1$说明】\n\n答案为$\\frac{5}{4}$，可能的总分有$0$，$1$，$2$。\n\n【样例#$2$说明】\n\n答案分别为$9630410$、$10834247$、$15047607$，即$\\frac{3}{2}$、$\\frac{599}{16}$、$\\frac{2999}{32}$。\n\n$Subtask$ #$1$（$10$分）： \n\n$1\\leq n,m\\leq 10$。\n\n$Subtask$ #$2$（$40$分）： \n\n$1\\leq n,m\\leq 10^5$。\n\n$Subtask$ #$3$（$50$分）： \n\n$1\\leq n,m\\leq 2 \\times 10^6$。\n\n所有测试点的时间限制统一为$1.5s$，内存限制统一为$125M$。\n\n### 题目提供者：$1jia1$", "locale": "zh-CN", "translations": {"en": {"title": "[DBOI2019] Holding Arrows", "background": "```cpp\nIs my shooting not precise?\n——doby\n```", "description": "$doby$ is an archer, and he really likes holding arrows.\n\nOne day, he came to an archery range and found that the owner had set up $n$ targets (numbered from $1-n$). Between them, $n-1$ lines were drawn so that the $n$ targets and the $n-1$ lines form a tree rooted at $1$. Each target has a score value.\n\nTo train himself, he chooses a node (called the parent node), then shoots once at every target in its subtree (including itself). Each target is hit with probability $50\\%$. After finishing shooting a subtree, the total score he gets is the product of the scores of all targets that were hit.\n\nNow he wants to know: if he chooses different nodes as the parent node, what is his expected total score? Since the total score may be very large, you need to take the result modulo $19260817$ (a prime).", "inputFormat": "The first line contains two positive integers $n$ and $m$, the number of targets and the number of queries.\n\nThe next line contains $n$ positive integers, representing the scores of targets numbered $1-n$.\n\nThe next $n-1$ lines each contain two integers $u,v$, describing an undirected edge of the tree.\n\nThe next $m$ lines each contain one positive integer $x(1\\leq x\\leq n)$, meaning a query for the expected total score that $doby$ obtains when target $x$ is chosen as the parent node.", "outputFormat": "Output one line with one positive integer $out$.\n\nTo reduce output, define $out$ as the sum of the expected total scores over all queries. Since this is an expectation, when computing $\\frac{a}{b}$, you should compute it as $a*b^{-1} mod (19260817)$. You also need to take $out$ modulo $19260817$.", "hint": "### Note: Since the modulus is large, be careful about overflow of intermediate results when computing modular inverses.\n\nIf you do not need extreme optimization, using fast exponentiation to compute modular inverses is enough.\n\n[Sample #$1$ Explanation]\n\nThe answer is $\\frac{5}{4}$. The possible total scores are $0$, $1$, and $2$.\n\n[Sample #$2$ Explanation]\n\nThe answers are $9630410$, $10834247$, and $15047607$, i.e. $\\frac{3}{2}$, $\\frac{599}{16}$, and $\\frac{2999}{32}$.\n\n$Subtask$ #$1$ ($10$ points):\n\n$1\\leq n,m\\leq 10$.\n\n$Subtask$ #$2$ ($40$ points):\n\n$1\\leq n,m\\leq 100000$.\n\n$Subtask$ #$3$ ($50$ points):\n\n$1\\leq n,m\\leq 2000000$.\n\nFor all test points, the time limit is $1.5s$, and the memory limit is $125M$.\n\n### Problem setter: $1jia1$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[DBOI2019] 持矢", "background": "```cpp\n吾射不亦精乎？\n——doby\n```", "description": "$doby$是一个弓箭手，他很喜欢拿箭。\n\n这天，他来到一个射箭场，发现射箭场老板放好了$n$个靶子（从$1-n$标号），中间画了$n-1$条线，使得这$n$格靶子和$n-1$条线组成了一个**根为**$1$的树。每个靶子上都有分数。\n\n他为了历练自己，选择了一个点（称为父点），然后对它子树（包括它）的每个靶子射一次，每个靶子射中概率为$50\\%$。每次射完一个子树，他获得的总分为射中的所有靶子的分数之**积**。\n\n现在他想知道，选择不同的点作为父点，他期望总分为多少？由于总分可能很大，你需要把结果对$19260817$（质数）取模。", "inputFormat": "输入两个正整数，靶子总数$n$和询问次数$m$。\n\n接下来一行，$n$个正整数，表示编号为$1-n$的靶子的分数。\n\n接下来$n-1$行，每行两个数$u,v$，描述树的一条无向边。\n\n接下来$m$行，每行一个正整数$x(1\\leq x\\leq n)$，表示询问以靶子$x$为父节点时，$doby$期望获得的总分。", "outputFormat": "输出一行，一个正整数$out$。\n\n为了减少输出，定义$out$为对于每组询问，期望获得的总分之和。由于是期望，需要你在计算$\\frac{a}{b}$时，将其改为$a*b^{-1} mod (19260817)$。你需要把输出$out$也对$19260817$取模。", "hint": "### 注意：由于模数较大，请注意求逆元时中间结果的溢出。\n\n如果你不需要卡常，使用快速幂求逆元就够用了。\n\n【样例#$1$说明】\n\n答案为$\\frac{5}{4}$，可能的总分有$0$，$1$，$2$。\n\n【样例#$2$说明】\n\n答案分别为$9630410$、$10834247$、$15047607$，即$\\frac{3}{2}$、$\\frac{599}{16}$、$\\frac{2999}{32}$。\n\n$Subtask$ #$1$（$10$分）： \n\n$1\\leq n,m\\leq 10$。\n\n$Subtask$ #$2$（$40$分）： \n\n$1\\leq n,m\\leq 10^5$。\n\n$Subtask$ #$3$（$50$分）： \n\n$1\\leq n,m\\leq 2 \\times 10^6$。\n\n所有测试点的时间限制统一为$1.5s$，内存限制统一为$125M$。\n\n### 题目提供者：$1jia1$", "locale": "zh-CN"}}}
{"pid": "P5620", "type": "P", "difficulty": 5, "samples": [["5 5 7\n3 1 1 2 2\n5 4 2 5 4\n1 2 2 2 4\n-1 2 2 4 4\n2 2 2 4 3\n7 1 4 3 4\n0 1 3 5 4", "21\n8\n40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "洛谷原创"], "title": "[DBOI2019] 捡币", "background": "> 众所周知，以津真天世界第一可爱。\n> ——1jia1\n\n你正在打不氪金手游 yys，这时家长进来了，于是你装作在打数据结构题。\n\n![](https://cdn.luogu.com.cn/upload/pic/71004.png)", "description": "由于你在 $n$ 次十连抽后没钱了，于是你应以津真天的邀请去参加一个活动。\n\n这个活动是在一个 $n\\times n$ 的矩形区域中进行的，进行若干秒。第 $i$ 秒，主办方会在这个矩形中选择一块小的区域，在每格上面分别撒币。\n\n捡币的规则是这样的：从左上角 $(1,1)$ 出发，走一条抵达  $(n,n)$ 的路径，每次只能从当前格子下面或右边的格子走，并捡起这个区域的金币。\n\n你需要知道，在某一秒某个矩形区域中拥有最多金币的格子有多少金币，某个矩形区域中的金币总数，以及第 $m$ 秒后（如果有撒币操作则先撒币）开始最多能捡多少币。捡币过程中，场上金币数量不会变化，你可以认为这是在 1s 内完成的。", "inputFormat": "第一行，输入整数 $n,m,Q\\ (m\\leq\\text{撒币操作数量})$。\n\n接下来 $Q$ 行，输入五个整数 $u,x1,y1,x2,y2$。（$0<x1\\leq x2\\leq n$，$0<y1\\leq y2\\leq n$，$-1\\leq u\\leq10$）。\n\n- 若 $u>0$，则代表撒币操作，指左上、右下端点分别为 $(x1,y1),(x2,y2)$ 的矩形撒了 $u$ 元的币，撒币的时间依次增加（也就是说第一次撒币操作在第一秒，第二次撒币操作在第二秒，……）。\n- 若 $u=0$，则为查大操作，指询问直到上一次撒币操作后，两端点为 $(x1,y1),(x2,y2)$ 的矩形中最大的金币值为多少。（具体意思见题目描述）\n- 若 $u=-1$，则为查和操作，指询问直到上一次撒币操作后，两端点为 $(x1,y1),(x2,y2)$ 的矩形中金币值的总和。", "outputFormat": "输出若干行。\n\n前面几行输出一个整数，即每次查询的结果。\n\n最后一行输出你在第$m$秒时，撒完币后捡币能获得的最多的金币。", "hint": "【样例 #1 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ngd0lgmf.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b3aeyq7f.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c45m09ft.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jrgxj4ty.png)\n\n### 数据范围及约定\n\n- Subtask #1（$20$分）：$1\\leq n\\leq 10$, $1\\leq Q\\leq 1000$。\n- Subtask #2（$20$分）：$1\\leq n\\leq 1000$, $1\\leq Q\\leq 10$。\n- Subtask #3（$20$分）：$1\\leq n\\leq 100$, $1\\leq Q\\leq 1000$。\n- Subtask #4（$40$分）：$1\\leq n\\leq 1000$, $1\\leq Q\\leq 10000$。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[DBOI2019] Coin Picking.", "background": "> As everyone knows, Itsumade is the cutest in the world.\n> ——1jia1\n\nYou are playing the non-pay-to-win mobile game yys. At this moment, your parents walk in, so you pretend you are working on a data structure problem.\n\n![](https://cdn.luogu.com.cn/upload/pic/71004.png)", "description": "After $n$ ten-pulls, you have run out of money, so you accept Itsumade’s invitation to join an event.\n\nThis event takes place in an $n \\times n$ rectangular area and lasts for several seconds. At second $i$, the organizer chooses a small sub-rectangle inside it and drops coins onto each cell in that sub-rectangle.\n\nThe rules for picking coins are as follows: start from the top-left corner $(1,1)$ and walk along a path that reaches $(n,n)$. Each move can only go to the cell below or to the cell on the right of the current cell, and you pick up the coins in the visited cells.\n\nYou need to find: at some moment, within a given rectangular area, how many coins are on the cell with the most coins; the total number of coins in a given rectangular area; and after second $m$ (if there is a coin-dropping operation at that time, drop coins first), the maximum number of coins you can pick up. During the picking process, the amount of coins on the board does not change; you may assume this is completed within $1$ second.", "inputFormat": "The first line contains integers $n, m, Q\\ (m\\leq\\text{number of coin-dropping operations})$.\n\nThe next $Q$ lines each contain five integers $u, x1, y1, x2, y2$ ($0 < x1 \\leq x2 \\leq n$, $0 < y1 \\leq y2 \\leq n$, $-1 \\leq u \\leq 10$).\n\n- If $u > 0$, it is a coin-dropping operation: $u$ coins are added to every cell in the rectangle with top-left and bottom-right corners $(x1,y1)$ and $(x2,y2)$. The time of coin-dropping operations increases in order (that is, the first coin-dropping operation happens at the first second, the second at the second second, ...).\n- If $u = 0$, it is a max query operation: ask, after the most recent coin-dropping operation, what is the maximum coin value among all cells in the rectangle with corners $(x1,y1)$ and $(x2,y2)$. (See the description for the exact meaning.)\n- If $u = -1$, it is a sum query operation: ask, after the most recent coin-dropping operation, what is the total sum of coin values of all cells in the rectangle with corners $(x1,y1)$ and $(x2,y2)$.", "outputFormat": "Output several lines.\n\nThe first several lines each output one integer, which is the answer to each query.\n\nThe last line outputs the maximum number of coins you can obtain by picking coins after dropping coins at second $m$.", "hint": "【Sample #1 Explanation】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ngd0lgmf.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b3aeyq7f.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c45m09ft.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jrgxj4ty.png)\n\n### Constraints and Notes\n\n- Subtask #1 ($20$ points): $1 \\leq n \\leq 10$, $1 \\leq Q \\leq 1000$.\n- Subtask #2 ($20$ points): $1 \\leq n \\leq 1000$, $1 \\leq Q \\leq 10$.\n- Subtask #3 ($20$ points): $1 \\leq n \\leq 100$, $1 \\leq Q \\leq 1000$.\n- Subtask #4 ($40$ points): $1 \\leq n \\leq 1000$, $1 \\leq Q \\leq 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[DBOI2019] 捡币", "background": "> 众所周知，以津真天世界第一可爱。\n> ——1jia1\n\n你正在打不氪金手游 yys，这时家长进来了，于是你装作在打数据结构题。\n\n![](https://cdn.luogu.com.cn/upload/pic/71004.png)", "description": "由于你在 $n$ 次十连抽后没钱了，于是你应以津真天的邀请去参加一个活动。\n\n这个活动是在一个 $n\\times n$ 的矩形区域中进行的，进行若干秒。第 $i$ 秒，主办方会在这个矩形中选择一块小的区域，在每格上面分别撒币。\n\n捡币的规则是这样的：从左上角 $(1,1)$ 出发，走一条抵达  $(n,n)$ 的路径，每次只能从当前格子下面或右边的格子走，并捡起这个区域的金币。\n\n你需要知道，在某一秒某个矩形区域中拥有最多金币的格子有多少金币，某个矩形区域中的金币总数，以及第 $m$ 秒后（如果有撒币操作则先撒币）开始最多能捡多少币。捡币过程中，场上金币数量不会变化，你可以认为这是在 1s 内完成的。", "inputFormat": "第一行，输入整数 $n,m,Q\\ (m\\leq\\text{撒币操作数量})$。\n\n接下来 $Q$ 行，输入五个整数 $u,x1,y1,x2,y2$。（$0<x1\\leq x2\\leq n$，$0<y1\\leq y2\\leq n$，$-1\\leq u\\leq10$）。\n\n- 若 $u>0$，则代表撒币操作，指左上、右下端点分别为 $(x1,y1),(x2,y2)$ 的矩形撒了 $u$ 元的币，撒币的时间依次增加（也就是说第一次撒币操作在第一秒，第二次撒币操作在第二秒，……）。\n- 若 $u=0$，则为查大操作，指询问直到上一次撒币操作后，两端点为 $(x1,y1),(x2,y2)$ 的矩形中最大的金币值为多少。（具体意思见题目描述）\n- 若 $u=-1$，则为查和操作，指询问直到上一次撒币操作后，两端点为 $(x1,y1),(x2,y2)$ 的矩形中金币值的总和。", "outputFormat": "输出若干行。\n\n前面几行输出一个整数，即每次查询的结果。\n\n最后一行输出你在第$m$秒时，撒完币后捡币能获得的最多的金币。", "hint": "【样例 #1 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ngd0lgmf.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b3aeyq7f.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c45m09ft.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jrgxj4ty.png)\n\n### 数据范围及约定\n\n- Subtask #1（$20$分）：$1\\leq n\\leq 10$, $1\\leq Q\\leq 1000$。\n- Subtask #2（$20$分）：$1\\leq n\\leq 1000$, $1\\leq Q\\leq 10$。\n- Subtask #3（$20$分）：$1\\leq n\\leq 100$, $1\\leq Q\\leq 1000$。\n- Subtask #4（$40$分）：$1\\leq n\\leq 1000$, $1\\leq Q\\leq 10000$。\n\n", "locale": "zh-CN"}}}
{"pid": "P5621", "type": "P", "difficulty": 6, "samples": [["5\n1 9 3 6 233\n0 8 3 7 666\n-3 9 4 2 810\n2 3 3 3 -100\n1 8 8 9 603", "1269"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2019", "洛谷原创", "cdq 分治", "动态规划优化"], "title": "[DBOI2019] 德丽莎世界第一可爱", "background": ">众所周知，德丽莎世界第一可爱。\n>\n>——zhengrunzhe\n\n\n你正在打崩坏 3，突然家长来了，于是你装作在打数据结构题。\n\n![神恩颂歌](https://cdn.luogu.com.cn/upload/pic/70922.png)", "description": "有 $n$ 个崩坏兽，每个崩坏兽有五个属性值：health 生命力，energy 能量力，attack 攻击力，defense 防御力， collapse 崩坏能。对于第 $i$ 只崩坏兽，以上五种属性分别以首字母记为 $H_i$、$E_i$、$A_i$、$D_i$ 和 $C_i$。\n\n德丽莎可以任选一只崩坏兽展开攻击。假如她干掉了崩坏兽 $i$ 那么她会收获 $C_i$ 的可爱值。由于德丽莎越战越勇，她打的下一只崩坏兽 $j$ 需要满足 $H_j \\ge H_i, E_j \\ge E_i,  A_j \\ge A_i, D_j \\ge D_i$。\n\n请你帮帮德丽莎计算一下她能够获得的最大可爱值。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，第 $i+1$ 行五个整数 $H_i, E_i, A_i, D_i,C_i$，代表着第 $i$ 只崩坏兽的属性值。", "outputFormat": "一行一个整数，代表最大可爱值（必须击杀至少一只崩坏兽），答案保证不会超过 long long 范围（$2^{63}-1$）。", "hint": "| Subtask 编号 | $n \\le$ | 分值 |\n|:-:|:-:|:-:|\n| $1$ | $100$ | $20$ |\n| $2$ | $10^4$ | $20$ |\n| $3$ | $5 \\times 10^4$ | $60$ |\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 50000, -10^9\\le H_i,E_i,A_i,D_i,C_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[DBOI2019] Theresa Is the Cutest in the World", "background": ">As everyone knows, Theresa is the cutest in the world.\n>\n>——zhengrunzhe\n\nYou are playing Honkai Impact 3, and suddenly your parents come in, so you pretend you are working on a data structure problem.\n\n![Divine Prayer](https://cdn.luogu.com.cn/upload/pic/70922.png)", "description": "There are $n$ Honkai beasts. Each Honkai beast has five attributes: health, energy, attack, defense, and collapse energy. For the $i$-th Honkai beast, denote these five attributes by their initials as $H_i$, $E_i$, $A_i$, $D_i$, and $C_i$.\n\nTheresa may choose any Honkai beast to attack first. If she kills Honkai beast $i$, she gains $C_i$ cuteness points. Since Theresa gets stronger as she fights, the next Honkai beast $j$ she fights must satisfy $H_j \\ge H_i$, $E_j \\ge E_i$, $A_j \\ge A_i$, and $D_j \\ge D_i$.\n\nPlease help Theresa compute the maximum total cuteness points she can obtain.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next $n$ lines: on line $i+1$, there are five integers $H_i, E_i, A_i, D_i, C_i$, representing the attribute values of the $i$-th Honkai beast.", "outputFormat": "Output one integer, representing the maximum cuteness points (she must kill at least one Honkai beast). The answer is guaranteed not to exceed the range of long long ($2^{63}-1$).", "hint": "| Subtask ID | $n \\le$ | Score |\n|:-:|:-:|:-:|\n| $1$ | $100$ | $20$ |\n| $2$ | $10^4$ | $20$ |\n| $3$ | $5 \\times 10^4$ | $60$ |\n\nFor $100\\%$ of the testdata, it holds that $1 \\le n \\le 50000$, and $-10^9 \\le H_i, E_i, A_i, D_i, C_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[DBOI2019] 德丽莎世界第一可爱", "background": ">众所周知，德丽莎世界第一可爱。\n>\n>——zhengrunzhe\n\n\n你正在打崩坏 3，突然家长来了，于是你装作在打数据结构题。\n\n![神恩颂歌](https://cdn.luogu.com.cn/upload/pic/70922.png)", "description": "有 $n$ 个崩坏兽，每个崩坏兽有五个属性值：health 生命力，energy 能量力，attack 攻击力，defense 防御力， collapse 崩坏能。对于第 $i$ 只崩坏兽，以上五种属性分别以首字母记为 $H_i$、$E_i$、$A_i$、$D_i$ 和 $C_i$。\n\n德丽莎可以任选一只崩坏兽展开攻击。假如她干掉了崩坏兽 $i$ 那么她会收获 $C_i$ 的可爱值。由于德丽莎越战越勇，她打的下一只崩坏兽 $j$ 需要满足 $H_j \\ge H_i, E_j \\ge E_i,  A_j \\ge A_i, D_j \\ge D_i$。\n\n请你帮帮德丽莎计算一下她能够获得的最大可爱值。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，第 $i+1$ 行五个整数 $H_i, E_i, A_i, D_i,C_i$，代表着第 $i$ 只崩坏兽的属性值。", "outputFormat": "一行一个整数，代表最大可爱值（必须击杀至少一只崩坏兽），答案保证不会超过 long long 范围（$2^{63}-1$）。", "hint": "| Subtask 编号 | $n \\le$ | 分值 |\n|:-:|:-:|:-:|\n| $1$ | $100$ | $20$ |\n| $2$ | $10^4$ | $20$ |\n| $3$ | $5 \\times 10^4$ | $60$ |\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 50000, -10^9\\le H_i,E_i,A_i,D_i,C_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5622", "type": "P", "difficulty": 6, "samples": [["4 7\n1 1 2\n1 1 3\n1 3 4\n2 1 1\n2 1 2\n3 1 4\n3 3 4", "3\n0"], ["4 8\n2 1 629\n3 3 1\n2 4 923\n1 4 2\n2 4 542\n2 1 918\n1 2 3\n3 4 3\n", "0\n5\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "洛谷原创", "动态树 LCT"], "title": "[DBOI2019] 巫女的职责", "background": "作为八重村的巫女，樱承担着守卫村庄的责任，村子里受到了崩坏的威胁，八重樱，出击！\n\n![bachongyingyingying](http://i0.hdslb.com/bfs/article/81e9465c02e29053f9fbe7c70d3c2644691abda2.png)", "description": "八重古村有 $n$ 座房屋，一开始所有的房子之间都没有路，随着古村的发展，慢慢会出现连接两栋房屋的双向道路。\n\n村民们原本过着无忧无虑的幸福生活，直到与文明作对——崩坏来了，慢慢地，某栋房屋也许会在遭受崩坏兽的侵袭，每只崩坏兽都有着一定的崩坏能，每户人家也许会存在着多只崩坏兽。\n\n樱来了，她接受了驱魔委托，每个委托都是从驱逐某个房子到另一个房子的崩坏兽，樱只能走已有的路，由于这样的路径也许有很多条，聪明的樱只会选择在它们所有路径中都会走过的某些点，即必经点，每次委托樱会在两点间的所有必经点驱魔。", "inputFormat": "第一行两个整数：$n,m$ 表示房屋数和事件数\n\n接下来 $m$ 行，每行三个正整数：$opt,x,y$\n\n$opt=1 $时，表示房子 $x$ 和房子 $y$ 间修了一条双向道路(保证没有重边，但不保证没有自环，如有请忽略。)\n\n$opt=2$ 时，表示房子 $x$ 来了一只崩坏能为 $y$ 的崩坏兽\n\n$opt=3$ 时，表示樱完成了一次从 $x$ 到 $y$ 的驱魔委托(不保证 $x$ 与 $y$ 连通，不连通输出 $0$ 即可)\n\n强制在线：记上次$3$的答案为 $\\text{lastans}$，初值为 $0$，实际上的$x,y$ 用函数解码：\n```cpp\ninline const void decode(int &x)\n{\n\tx^=lastans%n;\n\tif (x>n)x%=n;\n\tif (!x)x=1;\n}\n```", "outputFormat": "对于每个 $3$ 事件，输出一行一个数表示樱清除的崩坏能的值，答案保证在 $[0,2^{63})$", "hint": "【样例 $1$ 说明】\n\n第四个事件使 $1$ 号房屋有 $1$ 点的崩坏能。\n\n第五个事件使 $1$ 号房屋增加了 $2$ 点的崩坏能，此时其崩坏能值为 $3$。\n\n第六个事件显然答案为 $3$，更新 $\\text{lastans}=3$ 。\n\n第七个事件真实的 $x=1$，$y=3$，由于第六个事件已经在 $1$ 驱魔，所以没有崩坏能。\n\n$Subtask$ #$1$（$20$ 分）： \n\n$1\\leq n,m\\leq 100000$。\n\n$Subtask$ #$2$（$70$ 分）： \n\n$1\\leq n,m\\leq 200000$。\n\n$Subtask$ #$3$（$10$ 分）： \n\n$1\\leq n,m\\leq 500000$。\n\n所有测试点的时间限制统一为 $1.5 \\text s$，内存限制统一为 $125 \\text{MiB}$。\n\n### 题目提供者：[$\\color{red}{zhengrunzhe}$](https://www.luogu.org/space/show?uid=14374)", "locale": "zh-CN", "translations": {"en": {"title": "[DBOI2019] The Miko’s Duty.", "background": "As the miko of Yae Village, Sakura takes on the responsibility of guarding the village. The village is threatened by the Honkai. Yae Sakura, sortie!\n\n![bachongyingyingying](http://i0.hdslb.com/bfs/article/81e9465c02e29053f9fbe7c70d3c2644691abda2.png)", "description": "There are $n$ houses in the ancient Yae Village. At the beginning, there are no roads between any houses. As the village develops, undirected roads connecting two houses will gradually be built.\n\nThe villagers originally lived a carefree and happy life, until they went against civilization—the Honkai came. Gradually, some house may be attacked by Honkai beasts. Each Honkai beast has a certain amount of Honkai energy, and there may be multiple Honkai beasts in a single house.\n\nSakura has arrived. She accepts exorcism commissions. Each commission is to drive out the Honkai beasts from one house to another house. Sakura can only walk along existing roads. Since there may be many different paths, the smart Sakura will only choose some nodes that are passed by on all possible paths between them, i.e. mandatory nodes. For each commission, Sakura exorcises on all mandatory nodes on all paths between the two given houses.", "inputFormat": "The first line contains two integers: $n,m$, representing the number of houses and the number of events.\n\nThe next $m$ lines each contain three positive integers: $opt,x,y$.\n\nWhen $opt=1$, it means an undirected road is built between house $x$ and house $y$ (it is guaranteed that there are no multiple edges, but self-loops are not forbidden; if there is one, ignore it).\n\nWhen $opt=2$, it means a Honkai beast with Honkai energy $y$ comes to house $x$.\n\nWhen $opt=3$, it means Sakura completes an exorcism commission from $x$ to $y$ (it is not guaranteed that $x$ and $y$ are connected; if they are not connected, just output $0$).\n\nForced online: let the answer of the last type $3$ event be $\\text{lastans}$, with initial value $0$. The actual $x,y$ are decoded by the following function:\n```cpp\ninline const void decode(int &x)\n{\n\tx^=lastans%n;\n\tif (x>n)x%=n;\n\tif (!x)x=1;\n}\n```", "outputFormat": "For each type $3$ event, output one number per line representing the amount of Honkai energy cleared by Sakura. The answer is guaranteed to be in $[0,2^{63})$.", "hint": "[Sample $1$ Explanation]\n\nThe 4th event makes house $1$ have $1$ point of Honkai energy.\n\nThe 5th event increases the Honkai energy of house $1$ by $2$, so its Honkai energy becomes $3$.\n\nFor the 6th event, the answer is clearly $3$, and update $\\text{lastans}=3$.\n\nIn the 7th event, the real $x=1$, $y=3$. Since the 6th event has already exorcised at $1$, there is no Honkai energy.\n\n$Subtask$ #$1$ ($20$ points):\n\n$1\\leq n,m\\leq 100000$.\n\n$Subtask$ #$2$ ($70$ points):\n\n$1\\leq n,m\\leq 200000$.\n\n$Subtask$ #$3$ ($10$ points):\n\n$1\\leq n,m\\leq 500000$.\n\nFor all test points, the time limit is $1.5 \\text s$, and the memory limit is $125 \\text{MiB}$.\n\n### Problem Provider: [$\\color{red}{zhengrunzhe}$](https://www.luogu.org/space/show?uid=14374)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[DBOI2019] 巫女的职责", "background": "作为八重村的巫女，樱承担着守卫村庄的责任，村子里受到了崩坏的威胁，八重樱，出击！\n\n![bachongyingyingying](http://i0.hdslb.com/bfs/article/81e9465c02e29053f9fbe7c70d3c2644691abda2.png)", "description": "八重古村有 $n$ 座房屋，一开始所有的房子之间都没有路，随着古村的发展，慢慢会出现连接两栋房屋的双向道路。\n\n村民们原本过着无忧无虑的幸福生活，直到与文明作对——崩坏来了，慢慢地，某栋房屋也许会在遭受崩坏兽的侵袭，每只崩坏兽都有着一定的崩坏能，每户人家也许会存在着多只崩坏兽。\n\n樱来了，她接受了驱魔委托，每个委托都是从驱逐某个房子到另一个房子的崩坏兽，樱只能走已有的路，由于这样的路径也许有很多条，聪明的樱只会选择在它们所有路径中都会走过的某些点，即必经点，每次委托樱会在两点间的所有必经点驱魔。", "inputFormat": "第一行两个整数：$n,m$ 表示房屋数和事件数\n\n接下来 $m$ 行，每行三个正整数：$opt,x,y$\n\n$opt=1 $时，表示房子 $x$ 和房子 $y$ 间修了一条双向道路(保证没有重边，但不保证没有自环，如有请忽略。)\n\n$opt=2$ 时，表示房子 $x$ 来了一只崩坏能为 $y$ 的崩坏兽\n\n$opt=3$ 时，表示樱完成了一次从 $x$ 到 $y$ 的驱魔委托(不保证 $x$ 与 $y$ 连通，不连通输出 $0$ 即可)\n\n强制在线：记上次$3$的答案为 $\\text{lastans}$，初值为 $0$，实际上的$x,y$ 用函数解码：\n```cpp\ninline const void decode(int &x)\n{\n\tx^=lastans%n;\n\tif (x>n)x%=n;\n\tif (!x)x=1;\n}\n```", "outputFormat": "对于每个 $3$ 事件，输出一行一个数表示樱清除的崩坏能的值，答案保证在 $[0,2^{63})$", "hint": "【样例 $1$ 说明】\n\n第四个事件使 $1$ 号房屋有 $1$ 点的崩坏能。\n\n第五个事件使 $1$ 号房屋增加了 $2$ 点的崩坏能，此时其崩坏能值为 $3$。\n\n第六个事件显然答案为 $3$，更新 $\\text{lastans}=3$ 。\n\n第七个事件真实的 $x=1$，$y=3$，由于第六个事件已经在 $1$ 驱魔，所以没有崩坏能。\n\n$Subtask$ #$1$（$20$ 分）： \n\n$1\\leq n,m\\leq 100000$。\n\n$Subtask$ #$2$（$70$ 分）： \n\n$1\\leq n,m\\leq 200000$。\n\n$Subtask$ #$3$（$10$ 分）： \n\n$1\\leq n,m\\leq 500000$。\n\n所有测试点的时间限制统一为 $1.5 \\text s$，内存限制统一为 $125 \\text{MiB}$。\n\n### 题目提供者：[$\\color{red}{zhengrunzhe}$](https://www.luogu.org/space/show?uid=14374)", "locale": "zh-CN"}}}
{"pid": "P5623", "type": "P", "difficulty": 5, "samples": [["3\n15 2 3\n10 2 5\n416873881340965120 2 7", "6 9\n10\n8507630225817856 19446011944726528 22224013651116032 12699436372066304 8293509467471872 4739148267126784 1354042362036224 3094953970368512 1768545125924864 32339110874054656 5279854836580352 1508529953308672 3448068464705536 3940649673949184 288230376151711744\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "Special Judge"], "title": "[Celeste-A] Sever the Skyline", "background": "> 废弃的城市里充满了机关和陷阱，而今晚，我们将\n\n> ——划破这城市的天际线", "description": "Madeline 来到了被废弃的城市，这座城市里满是机关，还有一台不知所谓的机器在向外发射着光信号。\n\n通过 Madeline 强大的观察力，她发现光信号其实对应着某种冲刺顺序，按照顺序冲刺之后，她发现她冲刺的轨迹构成了这座废弃城市的天际线。\n\n多年以后，当 Madeline 回忆她登山的旅途时，已经不记得这座城市的天际线长什么样了，只记得所有建筑高度的和为 $n$，并且每座建筑的高度可以表示为 $p^iq^j$，$p,q$ 为素数且 $i,j \\geq 0,i+j\\geq 1$。\n\nMadeline 知道，这座城市的天际线是很有美感的，不存在两座建筑使得它们的高度成**整倍数**关系(1倍也是整倍数)，例如若存在一座高度为 $2$ 的建筑，就一定不能存在高度为 $4$ 的建筑。\n\n由于 Madeline 的记忆相当模糊，所以她可能要求你多次对于一个特定的记忆给出一个合法的天际线。", "inputFormat": "第一行为一个整数 $T$，表示 Madeline 的询问次数。\n\n接下来 $T$ 行，一行三个整数 $n,p,q$，分别表示本次回忆中建筑高度的和与题目描述中所述的 $p,q$。", "outputFormat": "对于每组回忆输出一行若干个整数，以空格分隔，表示一组合法的天际线。\n\n每组数据保证有解，若有多组合法的解，请输出任意一组。\n\n**请不要在行末增加多余空格，否则会 WA。(即，行末无空格)**", "hint": "对于前 $30\\%$ 的数据，保证 $n \\leq 100$，\n\n对于另外 $20\\%$ 的数据，保证 $p,q \\leq 3$\n\n对于 $100\\%$ 的数据，保证 $1 < n \\leq 10^{18}, p,q \\leq 40, p < q, T \\leq 10000$\n\n对于最后 $30\\%$ 的数据，采用捆绑测试，仅当您通过了所有测试点才能得分。\n\n保证数据的生成方式为：\n\n均匀随机两个质数 $p,q$，随机选择若干个 $p^iq^j$，保证它们不成倍数，将 $p^iq^j$ 的和作为 $n$，若这组数据满足当前数据点的要求，则保留，若不满足，则重新生成。\n\n对于最后 $30\\%$ 数据点，对于 $n$ 要求 $n > 10^{17}$。\n\n对于最后 $30\\%$ 数据点中的部分测试点，要求至少选出 $4$ 个 $p^iq^j$ 来组成 $n$。\n\n**本题 spj 认可的格式为：行末无空格，每组输出行末换行。**\n\n**若格式不正确，您可能会获得 UKE**", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-A] Sever the Skyline", "background": "> The abandoned city is full of mechanisms and traps, and tonight, we will.\n\n> —Sever the skyline of this city.", "description": "Madeline arrived at an abandoned city. The city is full of mechanisms, and there is also a machine of unknown purpose emitting light signals outward.\n\nWith Madeline’s strong observation skills, she discovered that the light signals actually correspond to some dash order. After dashing in that order, she found that her dash trail formed the skyline of this abandoned city.\n\nMany years later, when Madeline looked back on her mountain-climbing journey, she no longer remembered what the skyline of that city looked like. She only remembered that the sum of all building heights is $n$, and that each building’s height can be written as $p^iq^j$, where $p, q$ are prime numbers and $i, j \\geq 0, i + j \\geq 1$.\n\nMadeline knows that the skyline of this city is aesthetically pleasing: there do not exist two buildings whose heights are in an **integer multiple** relationship (a multiple of 1 also counts). For example, if there is a building of height $2$, then there must not be a building of height $4$.\n\nBecause Madeline’s memory is quite vague, she may ask you multiple times to provide a valid skyline for a specific memory.", "inputFormat": "The first line contains an integer $T$, indicating the number of queries from Madeline.\n\nThe next $T$ lines each contain three integers $n, p, q$, representing, respectively, the sum of building heights in this memory and the $p, q$ described in the statement.", "outputFormat": "For each memory, output one line containing several integers separated by spaces, representing one valid skyline.\n\nIt is guaranteed that each test case has a solution. If there are multiple valid solutions, output any one.\n\n**Do not add extra spaces at the end of the line, otherwise you will get WA. (That is, no trailing spaces at the end of the line.)**", "hint": "For the first $30\\%$ of the testdata, it is guaranteed that $n \\leq 100$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $p, q \\leq 3$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 < n \\leq 10^{18}$, $p, q \\leq 40$, $p < q$, and $T \\leq 10000$.\n\nFor the last $30\\%$ of the testdata, bundled tests are used: you will score only if you pass all test points.\n\nIt is guaranteed that the testdata is generated as follows:\n\nUniformly randomly choose two primes $p, q$, randomly select several $p^iq^j$ and ensure they are not multiples of each other, take the sum of these $p^iq^j$ as $n$. If this data satisfies the requirements of the current test point, keep it; otherwise, regenerate.\n\nFor the last $30\\%$ of the test points, $n$ is required to satisfy $n > 10^{17}$.\n\nFor some test points in the last $30\\%$ of the test points, it is required to select at least $4$ such $p^iq^j$ to form $n$.\n\n**The format accepted by the SPJ is: no trailing spaces at the end of the line, and each output line ends with a newline.**\n\n**If the format is incorrect, you may receive UKE.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-A] Sever the Skyline", "background": "> 废弃的城市里充满了机关和陷阱，而今晚，我们将\n\n> ——划破这城市的天际线", "description": "Madeline 来到了被废弃的城市，这座城市里满是机关，还有一台不知所谓的机器在向外发射着光信号。\n\n通过 Madeline 强大的观察力，她发现光信号其实对应着某种冲刺顺序，按照顺序冲刺之后，她发现她冲刺的轨迹构成了这座废弃城市的天际线。\n\n多年以后，当 Madeline 回忆她登山的旅途时，已经不记得这座城市的天际线长什么样了，只记得所有建筑高度的和为 $n$，并且每座建筑的高度可以表示为 $p^iq^j$，$p,q$ 为素数且 $i,j \\geq 0,i+j\\geq 1$。\n\nMadeline 知道，这座城市的天际线是很有美感的，不存在两座建筑使得它们的高度成**整倍数**关系(1倍也是整倍数)，例如若存在一座高度为 $2$ 的建筑，就一定不能存在高度为 $4$ 的建筑。\n\n由于 Madeline 的记忆相当模糊，所以她可能要求你多次对于一个特定的记忆给出一个合法的天际线。", "inputFormat": "第一行为一个整数 $T$，表示 Madeline 的询问次数。\n\n接下来 $T$ 行，一行三个整数 $n,p,q$，分别表示本次回忆中建筑高度的和与题目描述中所述的 $p,q$。", "outputFormat": "对于每组回忆输出一行若干个整数，以空格分隔，表示一组合法的天际线。\n\n每组数据保证有解，若有多组合法的解，请输出任意一组。\n\n**请不要在行末增加多余空格，否则会 WA。(即，行末无空格)**", "hint": "对于前 $30\\%$ 的数据，保证 $n \\leq 100$，\n\n对于另外 $20\\%$ 的数据，保证 $p,q \\leq 3$\n\n对于 $100\\%$ 的数据，保证 $1 < n \\leq 10^{18}, p,q \\leq 40, p < q, T \\leq 10000$\n\n对于最后 $30\\%$ 的数据，采用捆绑测试，仅当您通过了所有测试点才能得分。\n\n保证数据的生成方式为：\n\n均匀随机两个质数 $p,q$，随机选择若干个 $p^iq^j$，保证它们不成倍数，将 $p^iq^j$ 的和作为 $n$，若这组数据满足当前数据点的要求，则保留，若不满足，则重新生成。\n\n对于最后 $30\\%$ 数据点，对于 $n$ 要求 $n > 10^{17}$。\n\n对于最后 $30\\%$ 数据点中的部分测试点，要求至少选出 $4$ 个 $p^iq^j$ 来组成 $n$。\n\n**本题 spj 认可的格式为：行末无空格，每组输出行末换行。**\n\n**若格式不正确，您可能会获得 UKE**", "locale": "zh-CN"}}}
{"pid": "P5624", "type": "P", "difficulty": 6, "samples": [["5 2\n1 2 3 4 5\n1 2\n2 3", "5\n7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "[Celeste-A] Black Moonrise", "background": "> 幽灵\n>\n> 不属于这个世界\n> \n>但因这个世界而诞生\n>\n>潜藏在秩序之外\n>\n>$$\n>\n> 醒来吧，我的心是堡垒\\\\\n>\n>在梦中我易受伤害", "description": "在 Madeline 的梦境中，城市的边境是由大大小小的宇宙碎片构成的。\n\n每个宇宙碎片都有一定的能量值，由于碎片的大小有一定的差异，因此它们的能量值也有大有小。\n\nMadeline 很享受在碎片之间穿梭，她每次都会选择两个宇宙碎片，并获得它们能量值的最大公约数的愉悦值。注意这两个宇宙碎片可以相同。\n\n宇宙碎片构成了一段序列 $a_1,a_2,\\cdots,a_n$，每次 Madeline 都会选择它的一个区间，对于这个区间里面的任意两个宇宙碎片 $(u,v)$，她都会进行一次穿梭。**注意这里的 $(u,v)$ 是有序对。**\n\n形式化地，Madeline 每次获得的愉悦值为\n\n$$\\sum_{i=l}^r\\sum_{j=l}^r \\gcd(a_i,a_j)$$\n\n当 Madeline 从她的梦中被唤醒时，她发现所有的宇宙碎片都消失了。她不记得在梦中每次穿梭时获得的愉悦值是多少，只依稀记得她选择的区间了。\n\n于是她找到了你——一个信息学大佬，请你根据她每次选择的区间，还原她当时的愉悦值。", "inputFormat": "第一行两个正整数 $n,q$，分别表示碎片个数以及询问数。\n\n第二行有 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，表示每个碎片的能量值。\n\n接下来 $q$ 行，每行两个整数 $l_i,r_i$，表示第 $i$ 次询问 Madeline 选择的区间。", "outputFormat": "对于每个询问输出一行，表示在这次询问中，Madeline 获得的愉悦值的总和。", "hint": "- 对于 $10\\%$ 的数据，满足 $n,q\\leq 200$；\n- 对于 $20\\%$ 的数据，满足 $n,q\\leq 2250$；\n- 对于 $40\\%$ 的数据，满足 $n,q\\leq 4000$；\n- 对于 $100\\%$ 的数据，满足 $n,q,a_i\\leq 10^5$。\n\n**保证数列和询问均为随机生成。**", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-A] Black Moonrise", "background": "> Ghosts.\n>\n> They do not belong to this world.\n>\n> Yet they were born because of this world.\n>\n> Hidden beyond order.\n>\n> $$\n>\n> Wake up, my heart is a fortress\\\\\n>\n> In dreams I am easily hurt", "description": "In Madeline’s dream, the border of the city is made up of cosmic fragments of various sizes.\n\nEach cosmic fragment has an energy value. Because the fragments vary in size, their energy values can be large or small.\n\nMadeline enjoys moving between fragments. Each time, she chooses two cosmic fragments and gains a happiness value equal to the greatest common divisor of their energy values. Note that the two fragments can be the same.\n\nThe cosmic fragments form a sequence $a_1,a_2,\\cdots,a_n$. Each time, Madeline chooses an interval of this sequence, and for any two cosmic fragments $(u,v)$ inside this interval, she will move between them once. **Note that $(u,v)$ here is an ordered pair.**\n\nFormally, the happiness value Madeline gains each time is\n\n$$\\sum_{i=l}^r\\sum_{j=l}^r \\gcd(a_i,a_j)$$\n\nWhen Madeline is awakened from her dream, she finds that all cosmic fragments have disappeared. She cannot remember the happiness value she got from each move in the dream, and only vaguely remembers the intervals she chose.\n\nSo she comes to you, an informatics expert, and asks you to restore the happiness value she obtained at that time based on the intervals she chose each time.", "inputFormat": "The first line contains two positive integers $n,q$, representing the number of fragments and the number of queries.\n\nThe second line contains $n$ positive integers $a_1,a_2,\\cdots,a_n$, representing the energy value of each fragment.\n\nThe next $q$ lines each contain two integers $l_i,r_i$, representing the interval Madeline chose in the $i$-th query.", "outputFormat": "For each query, output one line representing the total sum of happiness values Madeline obtains in that query.", "hint": "- For $10\\%$ of the testdata, $n,q\\leq 200$.\n- For $20\\%$ of the testdata, $n,q\\leq 2250$.\n- For $40\\%$ of the testdata, $n,q\\leq 4000$.\n- For $100\\%$ of the testdata, $n,q,a_i\\leq 10^5$.\n\n**It is guaranteed that both the sequence and the queries are generated randomly.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-A] Black Moonrise", "background": "> 幽灵\n>\n> 不属于这个世界\n> \n>但因这个世界而诞生\n>\n>潜藏在秩序之外\n>\n>$$\n>\n> 醒来吧，我的心是堡垒\\\\\n>\n>在梦中我易受伤害", "description": "在 Madeline 的梦境中，城市的边境是由大大小小的宇宙碎片构成的。\n\n每个宇宙碎片都有一定的能量值，由于碎片的大小有一定的差异，因此它们的能量值也有大有小。\n\nMadeline 很享受在碎片之间穿梭，她每次都会选择两个宇宙碎片，并获得它们能量值的最大公约数的愉悦值。注意这两个宇宙碎片可以相同。\n\n宇宙碎片构成了一段序列 $a_1,a_2,\\cdots,a_n$，每次 Madeline 都会选择它的一个区间，对于这个区间里面的任意两个宇宙碎片 $(u,v)$，她都会进行一次穿梭。**注意这里的 $(u,v)$ 是有序对。**\n\n形式化地，Madeline 每次获得的愉悦值为\n\n$$\\sum_{i=l}^r\\sum_{j=l}^r \\gcd(a_i,a_j)$$\n\n当 Madeline 从她的梦中被唤醒时，她发现所有的宇宙碎片都消失了。她不记得在梦中每次穿梭时获得的愉悦值是多少，只依稀记得她选择的区间了。\n\n于是她找到了你——一个信息学大佬，请你根据她每次选择的区间，还原她当时的愉悦值。", "inputFormat": "第一行两个正整数 $n,q$，分别表示碎片个数以及询问数。\n\n第二行有 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，表示每个碎片的能量值。\n\n接下来 $q$ 行，每行两个整数 $l_i,r_i$，表示第 $i$ 次询问 Madeline 选择的区间。", "outputFormat": "对于每个询问输出一行，表示在这次询问中，Madeline 获得的愉悦值的总和。", "hint": "- 对于 $10\\%$ 的数据，满足 $n,q\\leq 200$；\n- 对于 $20\\%$ 的数据，满足 $n,q\\leq 2250$；\n- 对于 $40\\%$ 的数据，满足 $n,q\\leq 4000$；\n- 对于 $100\\%$ 的数据，满足 $n,q,a_i\\leq 10^5$。\n\n**保证数列和询问均为随机生成。**", "locale": "zh-CN"}}}
{"pid": "P5625", "type": "P", "difficulty": 6, "samples": [["4 3 2\n0 3 4 1\n0 2 3 3\n2\n", "16"], ["8 9 6\n0 1 1 1\n0 2 2 9\n0 3 3 2\n0 4 4 6\n0 5 5 0\n0 6 6 8\n0 7 7 1\n0 8 8 7\n2\n", "1"], ["10 15 14\n2\n0 6 6 439\n0 3 8 1865\n2\n0 7 10 11371\n2\n1 1\n2\n2\n1 3\n2\n0 5 8 7784\n2\n0 4 7 8497\n2\n", "155712307\n76042715\n719747106\n76042715\n76042715\n74890016\n76042715\n719747106"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "[Celeste-A] Good Karma", "background": "> \"我们永远不会忘记在这里的时光\"\n\n> \"再也没有其他地方能让我感到平静。谢谢。\"\n\n> \"很遗憾，Oshiro 先生，山庄要关门了。\"\n\n> \"我会赶上他们，直到这里的一切都井然有序……\"\n\n> \"在离开这个山庄之后，我应该去哪儿呢？\"", "description": "天空度假山庄是位于 Celeste 山半山腰上的一座山庄，这里已经被废弃许久。\n\n当 Madeline 来到这座山庄之时，这里只剩下了一个幽灵，Oshiro 先生，独自管理这座山庄。\n\n因为山庄有着神奇的魔力，里面凝聚着许多 Oshiro 先生不好的想法。\n\n一个想法可能包含 $k$ 种不好的念头，诸如山庄倒闭，无人问津，无人体谅等等，每种念头对于 Oshiro 先生的重要度是不一样的，具体来讲，第 $i$ 种不好的念头对 Oshiro 先生的重要程度为 $2^{i-1}$。\n\n有时，Oshiro 先生会抓起一堆糟糕的想法进行回忆，Oshiro 会一个一个挨着观看这些想法，并获得其中不好的念头。特别地，当 Oshiro 先生**两次看到同一种不好的念头**时，他就会认为这种念头没什么，下一瞬间就会**忘记自己曾经看到过这种念头**。\n\n一次回忆对 Oshiro 先生的重要程度为 Oshiro 在看完这些想法之后**记住的念头**的重要程度和。\n\n自然，在天空度假山庄里，Oshiro 先生对 Madeline 大吐苦水。\n\n多年以后，当 Madeline 回忆她的登山之旅的时候，已经不记得 Oshiro 每个想法对于他的重要程度了，她只记得 Oshiro 先生的某几次回忆的重要程度以及天空度假山庄之中不好的想法的数量与每种想法中可能的不好的念头的数量。\n\n你能帮助她找出有多少种合法的想法序列满足 Oshiro 先生的每次回忆吗？\n\n特别地，一个想法也可能是一团浆糊，即里面什么都没有。", "inputFormat": "第一行为三个整数 $n,q,k$，表示不好的想法的数量，Madeline 告诉了你 $q$ 条信息，以及每个想法中可能存在的不好的念头的数量。\n\n接下来 $q$ 行，一行一条信息，首先是信息的类型 $op$。\n\n若 $op = 0$， 则接下来是三个整数 $l,r,val$，表示 Madeline 想起在某次回忆中 Oshiro 先生抓起编号在 $[l,r]$ 区间的想法回忆，回忆结束后重要度是 $val$。\n\n若 $op = 1$，则接下来是一个整数 $cnt$，表示 Madeline 纠正了**第 $cnt$ 条 $op = 0$ 的说法**，第 $cnt$ 条说法是她错误回忆起来的，保证第 $cnt$ 条说法存在并且没有被纠正过。(你可以认为，被纠正的说法就不再存在了)\n\n若 $op = 2$，则你需要输出一个整数，表示有多少种合法的想法序列满足当前 Oshiro 先生的每次回忆，对 $998244353$ 取模。", "outputFormat": "对于每次 $op = 2$，输出方案数，对 $998244353$ 取模。", "hint": "对于 $10\\%$ 的数据, $ n,k\\leq 5,q \\leq 15$\n\n对于 $30\\%$ 的数据, $ n,q\\leq 1000 $\n\n对于额外 $10\\%$ 的数据, $ k=1 $\n\n对于额外 $15\\%$ 的数据，不存在1操作\n\n对于 $75\\%$ 的数据, $n\\leq 30000,q\\leq 80000,k \\leq 20$\n\n对于 $100\\%$ 的数据, $ n\\leq 2 * 10^5,q\\leq 10^6,k\\leq 30,0 \\leq val < 2^k$", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-A] Good Karma", "background": "> \"We will never forget the time we spent here.\"\n\n> \"There is nowhere else that can make me feel at peace. Thank you.\"\n\n> \"I am sorry, Mr. Oshiro, but the resort is going to close.\"\n\n> \"I will catch up to them, until everything here is in order...\"\n\n> \"After leaving this resort, where should I go?\"", "description": "The Celestial Resort is a resort located halfway up Celeste Mountain, and it has been abandoned for a long time.\n\nWhen Madeline arrives at the resort, there is only one ghost left, Mr. Oshiro, managing it alone.\n\nBecause the resort has some magical power, it gathers many of Mr. Oshiro’s bad thoughts.\n\nA thought may contain $k$ kinds of bad ideas, such as the resort shutting down, nobody visiting, nobody understanding him, and so on. The importance of each kind of bad idea to Mr. Oshiro is different. Specifically, the importance of the $i$-th kind of bad idea is $2^{i-1}$.\n\nSometimes, Mr. Oshiro grabs a pile of bad thoughts to recall. Oshiro watches these thoughts one by one and gains the bad ideas in them. In particular, when Mr. Oshiro **sees the same kind of bad idea twice**, he will think this idea is nothing, and in the next moment he will **forget that he has ever seen this idea**.\n\nThe importance of one recall is the sum of the importance of the bad ideas that Oshiro **still remembers** after he finishes watching these thoughts.\n\nNaturally, in the Celestial Resort, Mr. Oshiro complains a lot to Madeline.\n\nMany years later, when Madeline recalls her climbing trip, she no longer remembers how important each thought was to Oshiro. She only remembers the importance of some of Mr. Oshiro’s recalls, as well as the number of bad thoughts in the Celestial Resort and the number of possible bad ideas in each thought.\n\nCan you help her find how many legal thought sequences satisfy every recall of Mr. Oshiro?\n\nIn particular, a thought can also be a complete mess, meaning it contains nothing.", "inputFormat": "The first line contains three integers $n,q,k$, representing the number of bad thoughts, the number of pieces of information Madeline tells you ($q$), and the number of possible bad ideas in each thought.\n\nThe next $q$ lines each contain one piece of information, starting with the type $op$.\n\nIf $op = 0$, then three integers $l,r,val$ follow, meaning Madeline remembers that in some recall Mr. Oshiro grabbed the thoughts with indices in the interval $[l,r]$ to recall, and after the recall the importance was $val$.\n\nIf $op = 1$, then one integer $cnt$ follows, meaning Madeline corrected **the $cnt$-th statement with $op = 0$**. The $cnt$-th statement is something she remembered wrongly. It is guaranteed that this $cnt$-th statement exists and has not been corrected before. (You may assume that a corrected statement no longer exists.)\n\nIf $op = 2$, you need to output one integer, representing how many legal thought sequences satisfy all current recalls of Mr. Oshiro, modulo $998244353$.", "outputFormat": "For each $op = 2$, output the number of valid sequences modulo $998244353$.", "hint": "For $10\\%$ of the testdata, $n,k \\leq 5, q \\leq 15$.\n\nFor $30\\%$ of the testdata, $n,q \\leq 1000$.\n\nFor an additional $10\\%$ of the testdata, $k = 1$.\n\nFor an additional $15\\%$ of the testdata, there is no operation of type $1$.\n\nFor $75\\%$ of the testdata, $n \\leq 30000, q \\leq 80000, k \\leq 20$.\n\nFor $100\\%$ of the testdata, $n \\leq 2 * 10^5, q \\leq 10^6, k \\leq 30, 0 \\leq val < 2^k$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-A] Good Karma", "background": "> \"我们永远不会忘记在这里的时光\"\n\n> \"再也没有其他地方能让我感到平静。谢谢。\"\n\n> \"很遗憾，Oshiro 先生，山庄要关门了。\"\n\n> \"我会赶上他们，直到这里的一切都井然有序……\"\n\n> \"在离开这个山庄之后，我应该去哪儿呢？\"", "description": "天空度假山庄是位于 Celeste 山半山腰上的一座山庄，这里已经被废弃许久。\n\n当 Madeline 来到这座山庄之时，这里只剩下了一个幽灵，Oshiro 先生，独自管理这座山庄。\n\n因为山庄有着神奇的魔力，里面凝聚着许多 Oshiro 先生不好的想法。\n\n一个想法可能包含 $k$ 种不好的念头，诸如山庄倒闭，无人问津，无人体谅等等，每种念头对于 Oshiro 先生的重要度是不一样的，具体来讲，第 $i$ 种不好的念头对 Oshiro 先生的重要程度为 $2^{i-1}$。\n\n有时，Oshiro 先生会抓起一堆糟糕的想法进行回忆，Oshiro 会一个一个挨着观看这些想法，并获得其中不好的念头。特别地，当 Oshiro 先生**两次看到同一种不好的念头**时，他就会认为这种念头没什么，下一瞬间就会**忘记自己曾经看到过这种念头**。\n\n一次回忆对 Oshiro 先生的重要程度为 Oshiro 在看完这些想法之后**记住的念头**的重要程度和。\n\n自然，在天空度假山庄里，Oshiro 先生对 Madeline 大吐苦水。\n\n多年以后，当 Madeline 回忆她的登山之旅的时候，已经不记得 Oshiro 每个想法对于他的重要程度了，她只记得 Oshiro 先生的某几次回忆的重要程度以及天空度假山庄之中不好的想法的数量与每种想法中可能的不好的念头的数量。\n\n你能帮助她找出有多少种合法的想法序列满足 Oshiro 先生的每次回忆吗？\n\n特别地，一个想法也可能是一团浆糊，即里面什么都没有。", "inputFormat": "第一行为三个整数 $n,q,k$，表示不好的想法的数量，Madeline 告诉了你 $q$ 条信息，以及每个想法中可能存在的不好的念头的数量。\n\n接下来 $q$ 行，一行一条信息，首先是信息的类型 $op$。\n\n若 $op = 0$， 则接下来是三个整数 $l,r,val$，表示 Madeline 想起在某次回忆中 Oshiro 先生抓起编号在 $[l,r]$ 区间的想法回忆，回忆结束后重要度是 $val$。\n\n若 $op = 1$，则接下来是一个整数 $cnt$，表示 Madeline 纠正了**第 $cnt$ 条 $op = 0$ 的说法**，第 $cnt$ 条说法是她错误回忆起来的，保证第 $cnt$ 条说法存在并且没有被纠正过。(你可以认为，被纠正的说法就不再存在了)\n\n若 $op = 2$，则你需要输出一个整数，表示有多少种合法的想法序列满足当前 Oshiro 先生的每次回忆，对 $998244353$ 取模。", "outputFormat": "对于每次 $op = 2$，输出方案数，对 $998244353$ 取模。", "hint": "对于 $10\\%$ 的数据, $ n,k\\leq 5,q \\leq 15$\n\n对于 $30\\%$ 的数据, $ n,q\\leq 1000 $\n\n对于额外 $10\\%$ 的数据, $ k=1 $\n\n对于额外 $15\\%$ 的数据，不存在1操作\n\n对于 $75\\%$ 的数据, $n\\leq 30000,q\\leq 80000,k \\leq 20$\n\n对于 $100\\%$ 的数据, $ n\\leq 2 * 10^5,q\\leq 10^6,k\\leq 30,0 \\leq val < 2^k$", "locale": "zh-CN"}}}
{"pid": "P5626", "type": "P", "difficulty": 3, "samples": [["4", "5"], ["5", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "排序"], "title": "【AFOI-19】数码排序", "background": "小L从虚拟世界里出来啦！\n\n---\n\n**加强版[链接](https://www.luogu.org/problem/P5634)**", "description": "逃出来的同时，也有一部分数码逃了出来，吵着闹着让小L帮他们排序\n\n虚拟世界的数码都是不可见的\n\n小L目前只会选择排序，插入排序，冒泡排序，归并排序\n\n所以小L想问他在最坏情况下最少需要几次比较，才能使序列有序\n\n-------\n\n[排序的模板代码](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "输入仅有一行，给定一个正整数 $n$，表示序列的长度", "outputFormat": "输出最小的比较次数", "hint": "- **样例$1$解释**\n\n长度为$4$的序列归并调用，分成$2$组，一组$2$个元素。$2$个元素分别比较一次， 合并时最坏比较$3$次，所以是$3+1+1=5$。\n\n- **数据范围**\n\n对于$10\\%$的数据，$n \\leq 1000$\n\n对于$30\\%$的数据，$n \\leq 1000000$\n\n对于$100\\%$的数据，$n \\leq 10^{16}$\n\n**数据保证随机**\n", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] Digital Sorting", "background": "Little L has come out of the virtual world!\n\n---\n\n**Enhanced version [link](https://www.luogu.org/problem/P5634)**", "description": "While escaping, some “digits” also escaped. They kept making noise and asked Little L to help sort them.\n\nThe digits in the virtual world are invisible.\n\nLittle L currently only knows selection sort, insertion sort, bubble sort, and merge sort.\n\nSo Little L wants to ask: in the worst case, what is the minimum number of comparisons needed to make the sequence sorted?\n\n-------\n\n[Template code for sorting](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "There is only one line of input: a positive integer $n$, representing the length of the sequence.", "outputFormat": "Output the minimum number of comparisons.", "hint": "- **Sample $1$ Explanation**\n\nFor a sequence of length $4$, merge sort splits it into $2$ groups, with $2$ elements in each group. The $2$ elements in each group are compared once. During merging, the worst case needs $3$ comparisons, so the total is $3+1+1=5$.\n\n- **Constraints**\n\nFor $10\\%$ of the testdata, $n \\leq 1000$.\n\nFor $30\\%$ of the testdata, $n \\leq 1000000$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^{16}$.\n\n**The testdata is guaranteed to be random.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】数码排序", "background": "小L从虚拟世界里出来啦！\n\n---\n\n**加强版[链接](https://www.luogu.org/problem/P5634)**", "description": "逃出来的同时，也有一部分数码逃了出来，吵着闹着让小L帮他们排序\n\n虚拟世界的数码都是不可见的\n\n小L目前只会选择排序，插入排序，冒泡排序，归并排序\n\n所以小L想问他在最坏情况下最少需要几次比较，才能使序列有序\n\n-------\n\n[排序的模板代码](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "输入仅有一行，给定一个正整数 $n$，表示序列的长度", "outputFormat": "输出最小的比较次数", "hint": "- **样例$1$解释**\n\n长度为$4$的序列归并调用，分成$2$组，一组$2$个元素。$2$个元素分别比较一次， 合并时最坏比较$3$次，所以是$3+1+1=5$。\n\n- **数据范围**\n\n对于$10\\%$的数据，$n \\leq 1000$\n\n对于$30\\%$的数据，$n \\leq 1000000$\n\n对于$100\\%$的数据，$n \\leq 10^{16}$\n\n**数据保证随机**\n", "locale": "zh-CN"}}}
{"pid": "P5627", "type": "P", "difficulty": 4, "samples": [["2\n", "5"], ["5\n", "447"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学"], "title": "【AFOI-19】sum与prod", "background": "SY终于整理好了她凌乱的被子，刚来到教室的她就收到了QM传来的一张字条。。。\n\nTo: Dear SY\n\n&nbsp;&nbsp;&nbsp;&nbsp;你看看我昨晚梦到的式子，解出来给你糖吃。\n\nFrom: Your QM。\n\nSY自然是无法拒绝 $C_{6}H_{12}O_{6}$ 的诱惑啦，不过她看到字条背面花里胡哨的式子时傻眼了。。但是SY还是很想吃糖。", "description": "求\n\n$$\\sum_{i=1}^{2^{n}}\\log_{2}{(\\prod_{j = 1}^{i}lowbit(j))}$$\n\n的结果\n\n其中 $lowbit(x)$ 意指` x&(~x+1)` 的结果。", "inputFormat": "一行，一个整数n。", "outputFormat": "一行，一个整数，为答案模 $10^9+7$ 的结果。", "hint": "对于前 $20\\%$ 的数据，有 $1 \\leq n \\leq 60$ 。\n\n对于前 $50\\%$ 的数据，有 $1 \\leq n \\leq 10^4$ 。\n\n对于前 $100\\%$ 的数据，有 $1 \\leq n \\leq 2^{62}$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] sum and prod", "background": "SY finally tidied up her messy quilt. As soon as she arrived in the classroom, she received a note from QM...\n\nTo: Dear SY\n\n&nbsp;&nbsp;&nbsp;&nbsp;Take a look at the formula I dreamed of last night. Solve it and I will give you candy.\n\nFrom: Your QM.\n\nSY, of course, could not resist the temptation of $C_{6}H_{12}O_{6}$. But when she saw the fancy formula on the back of the note, she was stunned... Still, SY really wanted to eat candy.", "description": "Find the value of\n\n$$\\sum_{i=1}^{2^{n}}\\log_{2}{(\\prod_{j = 1}^{i}lowbit(j))}$$\n\nwhere $lowbit(x)$ means the result of ` x&(~x+1)`.", "inputFormat": "One line containing an integer $n$.", "outputFormat": "One line containing one integer, the answer modulo $10^9+7$.", "hint": "For the first $20\\%$ of the testdata, $1 \\leq n \\leq 60$.\n\nFor the first $50\\%$ of the testdata, $1 \\leq n \\leq 10^4$.\n\nFor the full $100\\%$ of the testdata, $1 \\leq n \\leq 2^{62}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】sum与prod", "background": "SY终于整理好了她凌乱的被子，刚来到教室的她就收到了QM传来的一张字条。。。\n\nTo: Dear SY\n\n&nbsp;&nbsp;&nbsp;&nbsp;你看看我昨晚梦到的式子，解出来给你糖吃。\n\nFrom: Your QM。\n\nSY自然是无法拒绝 $C_{6}H_{12}O_{6}$ 的诱惑啦，不过她看到字条背面花里胡哨的式子时傻眼了。。但是SY还是很想吃糖。", "description": "求\n\n$$\\sum_{i=1}^{2^{n}}\\log_{2}{(\\prod_{j = 1}^{i}lowbit(j))}$$\n\n的结果\n\n其中 $lowbit(x)$ 意指` x&(~x+1)` 的结果。", "inputFormat": "一行，一个整数n。", "outputFormat": "一行，一个整数，为答案模 $10^9+7$ 的结果。", "hint": "对于前 $20\\%$ 的数据，有 $1 \\leq n \\leq 60$ 。\n\n对于前 $50\\%$ 的数据，有 $1 \\leq n \\leq 10^4$ 。\n\n对于前 $100\\%$ 的数据，有 $1 \\leq n \\leq 2^{62}$ 。", "locale": "zh-CN"}}}
{"pid": "P5628", "type": "P", "difficulty": 5, "samples": [["6 0\n1 3\n3 2\n5 4\n3 4\n4 6", "19"], ["5 1\n1 2\n2 3\n3 4\n4 5", "20"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "容斥原理"], "title": "【AFOI-19】面基", "background": "一伙人吃完午饭准备看考场，IY ，SY，QM，MY 和 UU 早就约好在当天下午面基。然后众人一致同意把安排行程的锅甩到了 IY 身上。\n\n（IY：？？？？为什么是我）\n\n（QM：给你吃糖）\n\n（IY：好的没问题，包在我身上。）", "description": "IY 所在的城市有 $n$ 个路口，$n-1$ 条道路把各个路口连接起来，道路是双向的。换言之， IY 所在的城市构成了一棵树。两个不相同路口的距离定义为其简单路径上的道路条数，一个路口与自己的距离为$0$。\n\n我们再定义一条道路的重要度。若一条道路无法使用，会导致有 $t$ 对路口无法相互抵达，则$t$就是该道路的重要度。如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap2etu10.png)\n\n(3,4)之间的道路的重要度就为$9$。因为(1,4)(2,4)(3,4)(1,5)(2,5)(3,5)(1,6)(2,6)(3,6)要相互抵达都要经过这条边。\n\nIY 得到了一个很不好的消息，有一个路口正在施工（但是 IY 不知道施工的位置）。施工的范围影响到了距施工点距离为 $k$ 的地方，距离施工点距离小于等于 $k$ 的路口已经全部关闭了。这使得一行人不能经过受影响的路口和与这些路口直接相连的道路。\n\nIY 不得不考虑到最坏的情况，由于他不知道施工的位置，所以他想知道，施工所影响道路的重要度的总和最大是多少。", "inputFormat": "第一行两个数 $n, k$\n\n接下来的$n-1$行，每行两个数 $u,v$ 来描述一条道路。表示 $u$ 路口与 $v$ 路口直接相连。", "outputFormat": "一个数，表示 所影响道路的重要度的总和的最大值。", "hint": "- **样例解释**\n\n样例$1$：就是题面中的图例，若施工位置在 $3$ 或 $4$ 号路口，则会影响的道路重要度总和为$19$。找不出比 $19$ 更大的值。\n\n样例$2$：满足成链的特殊性质。\n\n- **数据范围**\n\n对于前 $20\\%$测试点，$n \\le 100,0 \\le k \\le 7$\n\n对于前 $40\\%$ 的数据 ：保证数据随机\n\n特殊地：第三个测试点仅有$k==0$\n\n对于 $100\\%$的数据：$n \\le 30000,0 \\le k \\le 200$\n\n特殊地：第十个测试点由树退化成了一条链", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] Meetup", "background": "After lunch, a group of people planned to go check the exam venue. IY, SY, QM, MY, and UU had already agreed to meet up that afternoon. Then everyone unanimously decided to dump the responsibility of planning the trip onto IY.\n\n(IY: ???? Why me?)\n\n(QM: I’ll give you candy.)\n\n(IY: Okay, no problem. Leave it to me.)", "description": "The city where IY lives has $n$ intersections, and $n - 1$ roads connect these intersections. The roads are bidirectional. In other words, the city forms a tree. The distance between two different intersections is defined as the number of roads on the simple path between them, and the distance from an intersection to itself is $0$.\n\nWe also define the importance of a road. If a road becomes unusable and this causes $t$ pairs of intersections to be unable to reach each other, then $t$ is the importance of that road. As shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap2etu10.png)\n\nThe importance of the road between $(3,4)$ is $9$. This is because for $(1,4)$, $(2,4)$, $(3,4)$, $(1,5)$, $(2,5)$, $(3,5)$, $(1,6)$, $(2,6)$, $(3,6)$ to reach each other, they all must pass through this edge.\n\nIY received some very bad news: one intersection is under construction (but IY does not know where). The construction affects the area within distance $k$ from the construction point, and all intersections whose distance to the construction point is less than or equal to $k$ have been completely closed. This means the group cannot pass through the affected intersections or the roads directly connected to these intersections.\n\nIY has to consider the worst case. Since he does not know the construction location, he wants to know what the maximum possible total importance of the affected roads is.", "inputFormat": "The first line contains two integers $n, k$.\n\nThe next $n - 1$ lines each contain two integers $u, v$, describing a road, meaning that intersection $u$ is directly connected to intersection $v$.", "outputFormat": "Output one integer, representing the maximum value of the total importance of the affected roads.", "hint": "- **Sample Explanation**\n\nSample $1$: This is the example shown in the statement. If the construction location is at intersection $3$ or $4$, then the total importance of the affected roads is $19$. No value larger than $19$ can be found.\n\nSample $2$: It satisfies the special property of being a chain.\n\n- **Constraints**\n\nFor the first $20\\%$ testdata, $n \\le 100, 0 \\le k \\le 7$.\n\nFor the first $40\\%$ of the data: the data is guaranteed to be random.\n\nSpecially, the third test point has only $k == 0$.\n\nFor $100\\%$ of the data: $n \\le 30000, 0 \\le k \\le 200$.\n\nSpecially, the tenth test point degenerates from a tree into a chain.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】面基", "background": "一伙人吃完午饭准备看考场，IY ，SY，QM，MY 和 UU 早就约好在当天下午面基。然后众人一致同意把安排行程的锅甩到了 IY 身上。\n\n（IY：？？？？为什么是我）\n\n（QM：给你吃糖）\n\n（IY：好的没问题，包在我身上。）", "description": "IY 所在的城市有 $n$ 个路口，$n-1$ 条道路把各个路口连接起来，道路是双向的。换言之， IY 所在的城市构成了一棵树。两个不相同路口的距离定义为其简单路径上的道路条数，一个路口与自己的距离为$0$。\n\n我们再定义一条道路的重要度。若一条道路无法使用，会导致有 $t$ 对路口无法相互抵达，则$t$就是该道路的重要度。如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap2etu10.png)\n\n(3,4)之间的道路的重要度就为$9$。因为(1,4)(2,4)(3,4)(1,5)(2,5)(3,5)(1,6)(2,6)(3,6)要相互抵达都要经过这条边。\n\nIY 得到了一个很不好的消息，有一个路口正在施工（但是 IY 不知道施工的位置）。施工的范围影响到了距施工点距离为 $k$ 的地方，距离施工点距离小于等于 $k$ 的路口已经全部关闭了。这使得一行人不能经过受影响的路口和与这些路口直接相连的道路。\n\nIY 不得不考虑到最坏的情况，由于他不知道施工的位置，所以他想知道，施工所影响道路的重要度的总和最大是多少。", "inputFormat": "第一行两个数 $n, k$\n\n接下来的$n-1$行，每行两个数 $u,v$ 来描述一条道路。表示 $u$ 路口与 $v$ 路口直接相连。", "outputFormat": "一个数，表示 所影响道路的重要度的总和的最大值。", "hint": "- **样例解释**\n\n样例$1$：就是题面中的图例，若施工位置在 $3$ 或 $4$ 号路口，则会影响的道路重要度总和为$19$。找不出比 $19$ 更大的值。\n\n样例$2$：满足成链的特殊性质。\n\n- **数据范围**\n\n对于前 $20\\%$测试点，$n \\le 100,0 \\le k \\le 7$\n\n对于前 $40\\%$ 的数据 ：保证数据随机\n\n特殊地：第三个测试点仅有$k==0$\n\n对于 $100\\%$的数据：$n \\le 30000,0 \\le k \\le 200$\n\n特殊地：第十个测试点由树退化成了一条链", "locale": "zh-CN"}}}
{"pid": "P5629", "type": "P", "difficulty": 5, "samples": [["2 3 3 3\n0 20\n6 6 6\n1 1\n2 2\n1 2\n", "0\n1\n1\n"], ["6 3 3 3\n6 5 10 15 19 7\n2 5 10\n1 6\n1 4\n4 6\n", "3\n3\n2\n"]], "limits": {"time": [2000, 2000, 2000, 3000, 2000, 3000, 2000, 2000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "ST 表", "字典树 Trie"], "title": "【AFOI-19】区间与除法", "background": "SY 好不容易才解出QM给她的数学题，在恰午饭的时候，QM 向她的脑洞里塞了个幻想的泡泡……SY 戳开一看，又是长长的一串数字!\n\nSY 实在是不想思考了，她决定用小学的除法消灭她脑洞里的数字.", "description": "定义 $op$ 操作意义为将当前数除以 $d$ 并向下取整.\n\nSY 现在有 $m$ 个“原数”，若一个数经过若干次 $op$ 操作(包括 $0$ 次)后能变为这个“原数”，那么这个数是可以被这个“原数”所消灭的。注意，“原数”是不会被消耗的.\n\n现在 SY 想问你,对于一个区间 $[l,r]$，在消灭最多个数的前提下最少需要多少个“原数”？", "inputFormat": "第一行 $4$ 个数,分别是 $n,m,d,q$,分别表示数列 $\\{a\\}$ 元素个数，SY 拥有的 “原数” 个数，$op$ 操作参数，询问个数。\n\n第二行为 $\\{a\\}$ 数列，即需要被消灭的数列。\n\n第三行为 $m$ 个“原数”。\n\n接下来 $q$ 行，每行两个数 $l$ 和 $r$，表示询问区间为 $[l,r]$。", "outputFormat": "按照询问顺序，每一行输出一个整数表示答案.", "hint": "#### 样例解释：\n\n**#样例1** ： $20$ 经过一次 $op$ 操作（除以 $3$ 向下取整）可以变成 $6$，而 $0$ 不能经过若干次 $op$ 操作变成 $6$ 。\n\n所以区间 $[1,1]$ 最多消灭 $0$ 个数，消灭最多数前提下最少需要 $0$ 个 \"原数\"，区间 $[1,2],[2,2]$ 最多消灭 $1$ 个数，消灭最多数前提下最少需要 $1$ 个 \"原数\" 。\n\n**#样例2** ： $2$ 能消灭 $\\{6,19,7\\}$ ， $5$ 能消灭 $\\{5,15\\}$ ， $10$ 能消灭 $\\{10\\}$ ， 所以区间 $[1,6],[1,4]$ 最少能用所有 \"原数\" 全部消灭，区间 $[4,6]$ 能用 $2,5$ 全部消灭。\n\n#### 数据范围：\n\n对于 $30\\%$ 的数据：$n\\le100,m\\leq10, d=2, q\\le 10$\n\n对于 $100\\%$ 的数据：$n\\le5\\times 10^{5},m\\leq60,2\\leq d\\leq10,q\\le10^{6},0\\le a_i,b_i< 2^{63}$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t7pn0p1n.png)\n\n特殊性质：数据经过构造。", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] Intervals and Division", "background": "SY finally managed to solve the math problem QM gave her. Right at lunchtime, QM stuffed an imaginary bubble into her mind… SY popped it and saw yet another long string of numbers!\n\nSY really does not want to think anymore, so she decides to use elementary-school division to wipe out the numbers in her head.", "description": "Define the operation $op$ as: divide the current number by $d$ and take the floor.\n\nSY now has $m$ “original numbers”. If a number can become an “original number” after performing the $op$ operation some number of times (including $0$ times), then this number can be wiped out by that “original number”. Note that “original numbers” will not be consumed.\n\nNow SY asks you: for an interval $[l,r]$, under the condition that you wipe out as many numbers as possible, what is the minimum number of “original numbers” needed?", "inputFormat": "The first line contains $4$ numbers $n,m,d,q$, representing the number of elements in the sequence $\\{a\\}$, the number of “original numbers” SY has, the parameter of the $op$ operation, and the number of queries.\n\nThe second line contains the sequence $\\{a\\}$, i.e., the numbers that need to be wiped out.\n\nThe third line contains $m$ “original numbers”.\n\nThe next $q$ lines each contain two numbers $l$ and $r$, indicating the query interval $[l,r]$.", "outputFormat": "In the order of the queries, output one integer per line as the answer.", "hint": "#### Sample Explanation:\n\n**Sample 1**: $20$ can become $6$ after one $op$ operation (divide by $3$ and take the floor), but $0$ cannot become $6$ after any number of $op$ operations.\n\nSo for interval $[1,1]$, at most $0$ numbers can be wiped out; under the condition of wiping out the maximum number of numbers, the minimum number of “original numbers” needed is $0$. For intervals $[1,2]$ and $[2,2]$, at most $1$ number can be wiped out; under that condition, the minimum number of “original numbers” needed is $1$.\n\n**Sample 2**: $2$ can wipe out $\\{6,19,7\\}$, $5$ can wipe out $\\{5,15\\}$, and $10$ can wipe out $\\{10\\}$. So for intervals $[1,6]$ and $[1,4]$, you can use all “original numbers” to wipe out everything. For interval $[4,6]$, you can use $2,5$ to wipe out everything.\n\n#### Constraints:\n\nFor $30\\%$ of the testdata: $n\\le100,m\\leq10, d=2, q\\le 10$.\n\nFor $100\\%$ of the testdata: $n\\le5\\times 10^{5},m\\leq60,2\\leq d\\leq10,q\\le10^{6},0\\le a_i,b_i< 2^{63}$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t7pn0p1n.png)\n\nSpecial property: the testdata is constructed.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】区间与除法", "background": "SY 好不容易才解出QM给她的数学题，在恰午饭的时候，QM 向她的脑洞里塞了个幻想的泡泡……SY 戳开一看，又是长长的一串数字!\n\nSY 实在是不想思考了，她决定用小学的除法消灭她脑洞里的数字.", "description": "定义 $op$ 操作意义为将当前数除以 $d$ 并向下取整.\n\nSY 现在有 $m$ 个“原数”，若一个数经过若干次 $op$ 操作(包括 $0$ 次)后能变为这个“原数”，那么这个数是可以被这个“原数”所消灭的。注意，“原数”是不会被消耗的.\n\n现在 SY 想问你,对于一个区间 $[l,r]$，在消灭最多个数的前提下最少需要多少个“原数”？", "inputFormat": "第一行 $4$ 个数,分别是 $n,m,d,q$,分别表示数列 $\\{a\\}$ 元素个数，SY 拥有的 “原数” 个数，$op$ 操作参数，询问个数。\n\n第二行为 $\\{a\\}$ 数列，即需要被消灭的数列。\n\n第三行为 $m$ 个“原数”。\n\n接下来 $q$ 行，每行两个数 $l$ 和 $r$，表示询问区间为 $[l,r]$。", "outputFormat": "按照询问顺序，每一行输出一个整数表示答案.", "hint": "#### 样例解释：\n\n**#样例1** ： $20$ 经过一次 $op$ 操作（除以 $3$ 向下取整）可以变成 $6$，而 $0$ 不能经过若干次 $op$ 操作变成 $6$ 。\n\n所以区间 $[1,1]$ 最多消灭 $0$ 个数，消灭最多数前提下最少需要 $0$ 个 \"原数\"，区间 $[1,2],[2,2]$ 最多消灭 $1$ 个数，消灭最多数前提下最少需要 $1$ 个 \"原数\" 。\n\n**#样例2** ： $2$ 能消灭 $\\{6,19,7\\}$ ， $5$ 能消灭 $\\{5,15\\}$ ， $10$ 能消灭 $\\{10\\}$ ， 所以区间 $[1,6],[1,4]$ 最少能用所有 \"原数\" 全部消灭，区间 $[4,6]$ 能用 $2,5$ 全部消灭。\n\n#### 数据范围：\n\n对于 $30\\%$ 的数据：$n\\le100,m\\leq10, d=2, q\\le 10$\n\n对于 $100\\%$ 的数据：$n\\le5\\times 10^{5},m\\leq60,2\\leq d\\leq10,q\\le10^{6},0\\le a_i,b_i< 2^{63}$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t7pn0p1n.png)\n\n特殊性质：数据经过构造。", "locale": "zh-CN"}}}
{"pid": "P5630", "type": "P", "difficulty": 6, "samples": [["5 7 1 1\n1 3 1\n2 1 5\n4 2 3\n2 5 4\n5 1 2\n3 5 7\n4 1 6\n2\n3 5\n1 4", "15\n7\n15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "生成树", "最近公共祖先 LCA"], "title": "【AFOI-19】跳闸", "background": "面基完毕后已经是晚上了，IY 和 SY在机房划水写板子。\n\n然后机房跳闸了。\n\n然后他们核善的信息老师叫他们修闸。\n\nIY 和 SY 迫于威胁不得不修闸。\n\n于是有了下面这一幕。", "description": "IY 和 SY 发现总闸的电路已经完全损坏了，于是他们不得不重新设置一个电路。\n\n机房里有 $n$ 个电流传导节点，每个节点可以用电线连向其他节点。**相通的节点可以互相传递电流**。\n\n由于预留空间的问题，导致有些节点是不能直接连接的。现在 IY 和 SY 知道有 $m$ 组节点可以直接连接，并且知道连接这一组节点需要的电线长度。\n\n光有电流传导节点肯定不行。SY 掏出了她珍藏已久的电源发生器。电源发生器可以附着在结点上，给那个节点供电。但是电源发生器也有一些缺陷，**它只能附着在 $s$ 号节点上，且只有 $k$ 个接口，也就是说附着的节点只能连 $k$ 条电线**，而且由于联动原因，**只有发生器所有的接口都连上电线，发生器才会供电**。\n\n**IY 和 SY 的目标是让所有节点都可以被供电**。他们需要电线，然而电线越长，其价格就以指数倍增长。**所以他们都想让最长的电线尽量短。**\n\nSY 接下了铺设电线的任务，IY 则被分配去买电线，**他需要知道他总共要买多长的电线**。由于 SY 忙于铺设电路，**所以 IY 还要回答 SY 的每个询问：让 $u$ 结点和 $v$ 结点相通所需要的电线的总长度为多少**。但是 IY 太弱了，他根本不知道这些答案是多少。\n\n请你帮助弱弱的 IY 回答这些问题。作为奖励，这道题他会给你满分哦。", "inputFormat": "第一行四个数$n,m,k,s$，表示有$n$个节点，$m$组可以直接连接的节点，电源发生器有$k$个接口，电源发生器附着在 $s$ 节点上。\n\n下面的 $m$ 行，每行三个数 $u,v,w$，表示 $u$ 和 $v$ 节点可以用电线直接相连，在这两个节点之间铺设电线，需要的电线长度为 $w$ 。\n\n再下面一行有一个数 $q$，表示 SY 有 $q$ 个询问。\n\n下面的 $q$ 行每行两个数 $u,v$，表示 SY 询问 IY ： 让$u$ 结点和 $v$ 结点相通需要多长的电线。", "outputFormat": "第一行输出一个数，代表所有电线的总长度。\n\n下面的 $q$ 行，每行一个数，表示对 SY 每个询问的回答。\n\n**可能存在无解的情况，如果无解，则输出\"can not fix it.\"**，然后什么都不要输出。", "hint": "- **样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/irpqvatr.png)\n\n如图，发生器附着在节点$1$上且只能连一条电线，其中红线表示连的电线，可以看出这样连是最优的。\n\n- **数据范围**\n\n对于$30\\%$ 的数据：$n \\le 10, m \\le 30, q \\le 10$\n\n对于$50\\%$ 的数据：$n \\le 2000, m \\le 20000, q \\le 2000$\n\n对于$100\\%$ 的数据：$n \\le 30000, m \\le 500000, q \\le 30000, 1 \\le s \\le n, 1 \\le k \\le 150$\n\n对于$100\\%$ 的数据：满足连接两组不同的节点所需电线长度不同（即边权全部不相等），保证运算过程中不会爆$int$\n\n- **出题人的温馨提醒**\n\n题目要满足最长的电线尽量短，在此基础上还要满足次长的电线尽量短，以此类推。\n\n不保证没有重边，但是保证边数足够，不会选择重边。\n\n保证没有自环，保证数据全随机。", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] Power Outage", "background": "After the meetup, it was already night. IY and SY were slacking off in the computer lab, writing code templates.\n\nThen the lab’s power tripped.\n\nThen their “kind” IT teacher told them to fix the breaker.\n\nIY and SY, forced by threats, had to fix it.\n\nSo the following scene happened.", "description": "IY and SY found that the main breaker circuit was completely damaged, so they had to rebuild a circuit.\n\nThere are $n$ current-conducting nodes in the lab. Each node can be connected to other nodes by wires. **Nodes that are connected can transmit current to each other.**\n\nBecause of reserved-space limitations, some nodes cannot be connected directly. Now IY and SY know there are $m$ pairs of nodes that can be connected directly, and they also know the wire length needed to connect each pair.\n\nHaving only conducting nodes is not enough. SY took out her long-kept power generator. The generator can be attached to a node and supply power to that node. However, the generator has some limitations: **it can only be attached to node $s$, and it has only $k$ ports, meaning the attached node can connect to at most $k$ wires**. Also, due to linkage effects, **the generator will supply power only if all its ports are connected to wires**.\n\n**IY and SY’s goal is to make every node receive power.** They need wires, but the longer the wire, the price grows exponentially. **So they want to make the longest wire as short as possible.**\n\nSY is responsible for laying the wires, and IY is assigned to buy the wires, **so he needs to know the total length of wire he has to buy.** Since SY is busy building the circuit, **IY also has to answer each of SY’s queries: what is the total wire length required to make node $u$ and node $v$ connected.** But IY is too weak and does not know the answers.\n\nPlease help the weak IY answer these questions. As a reward, this problem will give you full marks.", "inputFormat": "The first line contains four integers $n, m, k, s$, meaning there are $n$ nodes, $m$ pairs of nodes that can be directly connected, the power generator has $k$ ports, and the generator is attached to node $s$.\n\nThe next $m$ lines each contain three integers $u, v, w$, meaning $u$ and $v$ can be directly connected by a wire, and the required wire length between them is $w$.\n\nThe next line contains an integer $q$, meaning SY has $q$ queries.\n\nThe next $q$ lines each contain two integers $u, v$, meaning SY asks IY: how long a wire (in total) is needed to make node $u$ and node $v$ connected.", "outputFormat": "Output one integer on the first line, representing the total length of all wires.\n\nThen output $q$ lines, each containing one integer, representing the answer to each of SY’s queries.\n\n**There may be cases with no solution. If there is no solution, output \"can not fix it.\"**, and output nothing else.", "hint": "- **Sample Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/irpqvatr.png)\n\nAs shown, the generator is attached to node $1$ and can connect to only one wire. The red line is the chosen wire. You can see that this is optimal.\n\n- **Constraints**\n\nFor $30\\%$ of the testdata: $n \\le 10, m \\le 30, q \\le 10$.\n\nFor $50\\%$ of the testdata: $n \\le 2000, m \\le 20000, q \\le 2000$.\n\nFor $100\\%$ of the testdata: $n \\le 30000, m \\le 500000, q \\le 30000, 1 \\le s \\le n, 1 \\le k \\le 150$.\n\nFor $100\\%$ of the testdata: the wire lengths required to connect any two different pairs of nodes are all different (i.e. all edge weights are distinct), and it is guaranteed that no $int$ overflow will occur during computation.\n\n- **A Warm Reminder from the Problem Setter**\n\nThe problem requires making the longest wire as short as possible; on this basis, make the second longest wire as short as possible, and so on.\n\nMultiple edges are not ruled out, but the number of edges is sufficient, and no multiple edge will be chosen.\n\nIt is guaranteed that there are no self-loops, and the data is fully random.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】跳闸", "background": "面基完毕后已经是晚上了，IY 和 SY在机房划水写板子。\n\n然后机房跳闸了。\n\n然后他们核善的信息老师叫他们修闸。\n\nIY 和 SY 迫于威胁不得不修闸。\n\n于是有了下面这一幕。", "description": "IY 和 SY 发现总闸的电路已经完全损坏了，于是他们不得不重新设置一个电路。\n\n机房里有 $n$ 个电流传导节点，每个节点可以用电线连向其他节点。**相通的节点可以互相传递电流**。\n\n由于预留空间的问题，导致有些节点是不能直接连接的。现在 IY 和 SY 知道有 $m$ 组节点可以直接连接，并且知道连接这一组节点需要的电线长度。\n\n光有电流传导节点肯定不行。SY 掏出了她珍藏已久的电源发生器。电源发生器可以附着在结点上，给那个节点供电。但是电源发生器也有一些缺陷，**它只能附着在 $s$ 号节点上，且只有 $k$ 个接口，也就是说附着的节点只能连 $k$ 条电线**，而且由于联动原因，**只有发生器所有的接口都连上电线，发生器才会供电**。\n\n**IY 和 SY 的目标是让所有节点都可以被供电**。他们需要电线，然而电线越长，其价格就以指数倍增长。**所以他们都想让最长的电线尽量短。**\n\nSY 接下了铺设电线的任务，IY 则被分配去买电线，**他需要知道他总共要买多长的电线**。由于 SY 忙于铺设电路，**所以 IY 还要回答 SY 的每个询问：让 $u$ 结点和 $v$ 结点相通所需要的电线的总长度为多少**。但是 IY 太弱了，他根本不知道这些答案是多少。\n\n请你帮助弱弱的 IY 回答这些问题。作为奖励，这道题他会给你满分哦。", "inputFormat": "第一行四个数$n,m,k,s$，表示有$n$个节点，$m$组可以直接连接的节点，电源发生器有$k$个接口，电源发生器附着在 $s$ 节点上。\n\n下面的 $m$ 行，每行三个数 $u,v,w$，表示 $u$ 和 $v$ 节点可以用电线直接相连，在这两个节点之间铺设电线，需要的电线长度为 $w$ 。\n\n再下面一行有一个数 $q$，表示 SY 有 $q$ 个询问。\n\n下面的 $q$ 行每行两个数 $u,v$，表示 SY 询问 IY ： 让$u$ 结点和 $v$ 结点相通需要多长的电线。", "outputFormat": "第一行输出一个数，代表所有电线的总长度。\n\n下面的 $q$ 行，每行一个数，表示对 SY 每个询问的回答。\n\n**可能存在无解的情况，如果无解，则输出\"can not fix it.\"**，然后什么都不要输出。", "hint": "- **样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/irpqvatr.png)\n\n如图，发生器附着在节点$1$上且只能连一条电线，其中红线表示连的电线，可以看出这样连是最优的。\n\n- **数据范围**\n\n对于$30\\%$ 的数据：$n \\le 10, m \\le 30, q \\le 10$\n\n对于$50\\%$ 的数据：$n \\le 2000, m \\le 20000, q \\le 2000$\n\n对于$100\\%$ 的数据：$n \\le 30000, m \\le 500000, q \\le 30000, 1 \\le s \\le n, 1 \\le k \\le 150$\n\n对于$100\\%$ 的数据：满足连接两组不同的节点所需电线长度不同（即边权全部不相等），保证运算过程中不会爆$int$\n\n- **出题人的温馨提醒**\n\n题目要满足最长的电线尽量短，在此基础上还要满足次长的电线尽量短，以此类推。\n\n不保证没有重边，但是保证边数足够，不会选择重边。\n\n保证没有自环，保证数据全随机。", "locale": "zh-CN"}}}
{"pid": "P5631", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 0\n2 3 1\n3 2 2\n", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "并查集", "O2优化", "分治", "动态树 LCT"], "title": "最小mex生成树", "background": "这是一道经典题。", "description": "给定 $n$ 个点 $m$ 条边的无向连通图，边有边权。  \n\n设一个自然数集合 $S$ 的 $\\text{mex}$ 为：最小的、没有出现在 $S$ 中的自然数。  \n\n现在你要求出一个这个图的生成树，使得其边权集合的 $\\text{mex}$ 尽可能小。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n接下来 $m$ 行，每行 $3$ 个非负整数 $u,v,w$，表示 $u,v$ 之间有一条权值为 $w$ 的边。\n", "outputFormat": "输出一行一个自然数，表示最小的 $\\text{mex}$ 值。", "hint": "【数据范围】   \n- 对于 $20\\%$ 的数据，$1\\le n \\le 100$，$1\\le m \\le 200$。\n- 对于 $50\\%$ 的数据，$1\\le n \\le 2000$，$1\\le m \\le 3000$。\n- 对于 $80\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le m \\le 2\\times 10^5$。\n- 对于 $100\\%$ 的数据，$1\\le n \\le 10^6$，$1\\le m \\le 2\\times 10^6,0\\le w \\le 10^5$。\n\n输入数据规模较大，建议使用高效的读入方式。", "locale": "zh-CN", "translations": {"en": {"title": "Minimum MEX Spanning Tree", "background": "This is a classic problem.", "description": "Given an undirected connected graph with $n$ vertices and $m$ edges, each edge has a weight.\n\nDefine the $\\text{mex}$ of a set of natural numbers $S$ as the smallest natural number that does not appear in $S$.\n\nNow you need to find a spanning tree of this graph such that the $\\text{mex}$ of the set of its edge weights is as small as possible.", "inputFormat": "The first line contains two positive integers $n, m$.\n\nThe next $m$ lines each contain three non-negative integers $u, v, w$, indicating that there is an edge between $u$ and $v$ with weight $w$.", "outputFormat": "Output one line with one natural number, representing the minimum possible $\\text{mex}$ value.", "hint": "Constraints  \n- For $20\\%$ of the testdata, $1 \\le n \\le 100$, $1 \\le m \\le 200$.\n- For $50\\%$ of the testdata, $1 \\le n \\le 2000$, $1 \\le m \\le 3000$.\n- For $80\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le m \\le 2 \\times 10^5$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 10^6$, $1 \\le m \\le 2 \\times 10^6, 0 \\le w \\le 10^5$.\n\nThe input size is large, so an efficient input method is recommended.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最小mex生成树", "background": "这是一道经典题。", "description": "给定 $n$ 个点 $m$ 条边的无向连通图，边有边权。  \n\n设一个自然数集合 $S$ 的 $\\text{mex}$ 为：最小的、没有出现在 $S$ 中的自然数。  \n\n现在你要求出一个这个图的生成树，使得其边权集合的 $\\text{mex}$ 尽可能小。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n接下来 $m$ 行，每行 $3$ 个非负整数 $u,v,w$，表示 $u,v$ 之间有一条权值为 $w$ 的边。\n", "outputFormat": "输出一行一个自然数，表示最小的 $\\text{mex}$ 值。", "hint": "【数据范围】   \n- 对于 $20\\%$ 的数据，$1\\le n \\le 100$，$1\\le m \\le 200$。\n- 对于 $50\\%$ 的数据，$1\\le n \\le 2000$，$1\\le m \\le 3000$。\n- 对于 $80\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le m \\le 2\\times 10^5$。\n- 对于 $100\\%$ 的数据，$1\\le n \\le 10^6$，$1\\le m \\le 2\\times 10^6,0\\le w \\le 10^5$。\n\n输入数据规模较大，建议使用高效的读入方式。", "locale": "zh-CN"}}}
{"pid": "P5632", "type": "P", "difficulty": 5, "samples": [["4 6\n1 2 5\n1 3 1\n2 4 1\n3 4 2\n2 3 1\n1 4 2\n", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "最小割", "模板题"], "title": "【模板】Stoer-Wagner", "background": "", "description": "定义无向图 $G$ 的最小割为：一个去掉后可以使 $G$ 变成两个连通分量，且边权和最小的边集的边权和。\n\n给出一张无向图 $G$，求其最小割。", "inputFormat": "第一行，两个数 $n,m$，表示点数与边数。\n\n接下来 $m$ 行，每行三个正整数 $a_i,b_i,w_i$，表示 $a_i$ 到 $b_i$ 有一条边权为 $w_i$ 的边。", "outputFormat": "一行，一个整数表示 $G$ 的最小割，如果图不联通，请输出 `0` 。", "hint": "对于前 $20\\%$ 的数据， $n\\leq 10$。  \n对于前 $40\\%$ 的数据， $n\\leq 100$。  \n对于另外 $10\\%$ 的数据，保证输入为一棵树。  \n对于另外 $10\\%$ 的数据，保证输入为一条链。  \n对于 $100\\%$ 的数据， $n\\leq 600,m\\leq \\frac{n\\times (n-1)}{2}$ ，保证 $\\sum_{i=1}^{m}w_i \\leq10^9$ 。\n\n#### PS：想交 最大流/最小割树 的就省省吧。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Stoer-Wagner", "background": "", "description": "Define the minimum cut of an undirected graph $G$ as follows: it is a set of edges such that removing these edges can make $G$ split into two connected components, and the sum of edge weights in this set is minimal.\n\nGiven an undirected graph $G$, find its minimum cut.", "inputFormat": "The first line contains two numbers $n, m$, representing the number of vertices and the number of edges.\n\nThe next $m$ lines each contain three positive integers $a_i, b_i, w_i$, indicating that there is an edge between $a_i$ and $b_i$ with weight $w_i$.", "outputFormat": "Output one line with one integer representing the minimum cut of $G$. If the graph is disconnected, output `0`.", "hint": "For the first $20\\%$ of the testdata, $n \\leq 10$.  \nFor the first $40\\%$ of the testdata, $n \\leq 100$.  \nFor another $10\\%$ of the testdata, the input is guaranteed to be a tree.  \nFor another $10\\%$ of the testdata, the input is guaranteed to be a chain.  \nFor $100\\%$ of the testdata, $n \\leq 600, m \\leq \\frac{n\\times (n-1)}{2}$, and it is guaranteed that $\\sum_{i=1}^{m} w_i \\leq 10^9$.\n\n#### PS: If you want to submit “maximum flow / minimum cut tree”, just forget it.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】Stoer-Wagner", "background": "", "description": "定义无向图 $G$ 的最小割为：一个去掉后可以使 $G$ 变成两个连通分量，且边权和最小的边集的边权和。\n\n给出一张无向图 $G$，求其最小割。", "inputFormat": "第一行，两个数 $n,m$，表示点数与边数。\n\n接下来 $m$ 行，每行三个正整数 $a_i,b_i,w_i$，表示 $a_i$ 到 $b_i$ 有一条边权为 $w_i$ 的边。", "outputFormat": "一行，一个整数表示 $G$ 的最小割，如果图不联通，请输出 `0` 。", "hint": "对于前 $20\\%$ 的数据， $n\\leq 10$。  \n对于前 $40\\%$ 的数据， $n\\leq 100$。  \n对于另外 $10\\%$ 的数据，保证输入为一棵树。  \n对于另外 $10\\%$ 的数据，保证输入为一条链。  \n对于 $100\\%$ 的数据， $n\\leq 600,m\\leq \\frac{n\\times (n-1)}{2}$ ，保证 $\\sum_{i=1}^{m}w_i \\leq10^9$ 。\n\n#### PS：想交 最大流/最小割树 的就省省吧。", "locale": "zh-CN"}}}
{"pid": "P5633", "type": "P", "difficulty": 6, "samples": [["5 7 1 1\n1 3 1\n2 1 5\n4 2 3\n2 5 4\n5 1 2\n3 5 7\n4 1 6", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "Kruskal 重构树", "凸完全单调性（wqs 二分）", "生成树"], "title": "最小度限制生成树", "background": "", "description": "给你一个有 $n$ 个节点，$m$ 条边的带权无向图，你需要求得一个生成树，使边权总和最小，且满足编号为 $s$ 的节点正好连了 $k$ 条边。", "inputFormat": "第一行四个数：$n,m,s,k$\n\n下面的 $m$ 行，每行三个整数：$u,v,w$，表示有一条 $u$ 连向 $v$ 权值为 $w$ 的边。", "outputFormat": "输出一个数：满足要求的生成树的总边权。\n\n可能会出现无解的情况，如果无解，则输出 `Impossible`。", "hint": "### 数据范围\n\n对于 $20\\%$ 的数据，$n \\le 10$，$m \\le 30$。  \n对于 $50\\%$ 的数据，$n \\le 1000$，$m \\le 5000$。  \n对于 $100\\%$ 的数据，$1\\leq s \\leq n \\le 5\\times 10^4$，$1\\leq m \\le 5\\times 10^5 $，$1\\leq k \\le 100$，$0\\leq w\\leq 3\\times 10^4$。\n\n### 注意\n\n本题设有 hack 数据（Subtask $2$），计 $0$ 分，但若没有通过 hack 数据则不算通过本题。", "locale": "zh-CN", "translations": {"en": {"title": "Minimum Degree-Constrained Spanning Tree.", "background": "", "description": "You are given a weighted undirected graph with $n$ nodes and $m$ edges. You need to find a spanning tree such that the total edge weight is minimized, and the node with index $s$ is connected to exactly $k$ edges.", "inputFormat": "The first line contains four numbers: $n,m,s,k$.\n\nThe next $m$ lines each contain three integers: $u,v,w$, meaning there is an edge between $u$ and $v$ with weight $w$.", "outputFormat": "Output one number: the total edge weight of a spanning tree that satisfies the requirement.\n\nThere may be cases where no solution exists. If there is no solution, output `Impossible`.", "hint": "### Constraints\n\nFor $20\\%$ of the testdata, $n \\le 10$, $m \\le 30$.  \nFor $50\\%$ of the testdata, $n \\le 1000$, $m \\le 5000$.  \nFor $100\\%$ of the testdata, $1\\leq s \\leq n \\le 5\\times 10^4$, $1\\leq m \\le 5\\times 10^5 $, $1\\leq k \\le 100$, $0\\leq w\\leq 3\\times 10^4$.\n\n### Note\n\nThis problem includes hack testdata (Subtask $2$), worth $0$ points, but if you do not pass the hack testdata, it will not be considered as having passed this problem.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最小度限制生成树", "background": "", "description": "给你一个有 $n$ 个节点，$m$ 条边的带权无向图，你需要求得一个生成树，使边权总和最小，且满足编号为 $s$ 的节点正好连了 $k$ 条边。", "inputFormat": "第一行四个数：$n,m,s,k$\n\n下面的 $m$ 行，每行三个整数：$u,v,w$，表示有一条 $u$ 连向 $v$ 权值为 $w$ 的边。", "outputFormat": "输出一个数：满足要求的生成树的总边权。\n\n可能会出现无解的情况，如果无解，则输出 `Impossible`。", "hint": "### 数据范围\n\n对于 $20\\%$ 的数据，$n \\le 10$，$m \\le 30$。  \n对于 $50\\%$ 的数据，$n \\le 1000$，$m \\le 5000$。  \n对于 $100\\%$ 的数据，$1\\leq s \\leq n \\le 5\\times 10^4$，$1\\leq m \\le 5\\times 10^5 $，$1\\leq k \\le 100$，$0\\leq w\\leq 3\\times 10^4$。\n\n### 注意\n\n本题设有 hack 数据（Subtask $2$），计 $0$ 分，但若没有通过 hack 数据则不算通过本题。", "locale": "zh-CN"}}}
{"pid": "P5634", "type": "P", "difficulty": 6, "samples": [["4", "5"], ["5", "8"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "数码排序【加强版】", "background": "**本题是[P5626](https://www.luogu.org/problem/P5626)的加强版**\n\n小L从虚拟世界里出来啦！", "description": "逃出来的同时，也有一部分数码逃了出来，吵着闹着让小L帮他们排序。\n\n虚拟世界的数码都是不可见的。\n\n小L目前只会选择排序，插入排序，冒泡排序，归并排序。\n\n所以小L想问他在最坏情况下最少需要几次比较，才能使序列有序。\n\n------\n\n[排序的模板代码](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "输入仅有一行，给定一个正整数 $n$ ，表示序列的长度。", "outputFormat": "输出最小的比较次数，答案对$100000007$取模。", "hint": "- **样例$1$解释**\n\n长度为$4$的序列归并调用，分成$2$组，一组$2$个元素。$2$个元素分别比较一次， 合并时最坏比较$3$次，所以是$3+1+1=5。$\n\n- **数据范围**\n\n对于 $10\\%$ 的数据，$n\\leq10^{18}$；\n\n对于 $20\\%$ 的数据，$n\\leq10^{100}$；\n\n对于 $50\\%$ 的数据，$n\\leq10^{1000}$；\n\n对于 $80\\%$ 的数据，$n\\leq10^{10000}$；\n\n对于 $100\\%$ 的数据，$n\\leq10^{100000}$。\n\n**请注意时限**", "locale": "zh-CN", "translations": {"en": {"title": "Digital Sorting [Enhanced Version]", "background": "**This problem is an enhanced version of [P5626](https://www.luogu.org/problem/P5626).**\n\nXiao L has escaped from the virtual world!", "description": "While escaping, some digital beings also escaped. They are making a fuss and asking Xiao L to help sort them.\n\nThe digital beings in the virtual world are invisible.\n\nRight now, Xiao L only knows selection sort, insertion sort, bubble sort, and merge sort.\n\nSo Xiao L wants to ask: in the worst case, what is the minimum number of comparisons needed to make the sequence sorted?\n\n------\n\n[Template code for sorting](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "The input has only one line: a positive integer $n$, the length of the sequence.", "outputFormat": "Output the minimum number of comparisons. Take the answer modulo $100000007$.", "hint": "- **Sample $1$ explanation.**\n\nFor a sequence of length $4$, merge sort splits it into $2$ groups, with $2$ elements in each group. The $2$ elements in each group are compared once. During merging, the worst-case number of comparisons is $3$, so the total is $3 + 1 + 1 = 5$.\n\n- **Constraints**\n\nFor $10\\%$ of the testdata, $n \\leq 10^{18}$.\n\nFor $20\\%$ of the testdata, $n \\leq 10^{100}$.\n\nFor $50\\%$ of the testdata, $n \\leq 10^{1000}$.\n\nFor $80\\%$ of the testdata, $n \\leq 10^{10000}$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^{100000}$.\n\n**Please pay attention to the time limit.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "数码排序【加强版】", "background": "**本题是[P5626](https://www.luogu.org/problem/P5626)的加强版**\n\n小L从虚拟世界里出来啦！", "description": "逃出来的同时，也有一部分数码逃了出来，吵着闹着让小L帮他们排序。\n\n虚拟世界的数码都是不可见的。\n\n小L目前只会选择排序，插入排序，冒泡排序，归并排序。\n\n所以小L想问他在最坏情况下最少需要几次比较，才能使序列有序。\n\n------\n\n[排序的模板代码](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "输入仅有一行，给定一个正整数 $n$ ，表示序列的长度。", "outputFormat": "输出最小的比较次数，答案对$100000007$取模。", "hint": "- **样例$1$解释**\n\n长度为$4$的序列归并调用，分成$2$组，一组$2$个元素。$2$个元素分别比较一次， 合并时最坏比较$3$次，所以是$3+1+1=5。$\n\n- **数据范围**\n\n对于 $10\\%$ 的数据，$n\\leq10^{18}$；\n\n对于 $20\\%$ 的数据，$n\\leq10^{100}$；\n\n对于 $50\\%$ 的数据，$n\\leq10^{1000}$；\n\n对于 $80\\%$ 的数据，$n\\leq10^{10000}$；\n\n对于 $100\\%$ 的数据，$n\\leq10^{100000}$。\n\n**请注意时限**", "locale": "zh-CN"}}}
{"pid": "P5635", "type": "P", "difficulty": 3, "samples": [["1 10\n1 3\n", "error"], ["1 10\n4 5\n", "1"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "搜索", "记忆化搜索"], "title": "【CSGRound1】天下第一", "background": "天下第一的 cbw 以主席的身份在 8102 年统治全宇宙后，开始了自己休闲的生活，并邀请自己的好友每天都来和他做游戏。由于 cbw 想要显出自己平易近人，所以 zhouwc 虽然是一个蒟蒻，也有能和 cbw 玩游戏的机会。", "description": "游戏是这样的：\n\n给定两个数 $x$，$y$，与一个模数 $p$。\n\ncbw 拥有数 $x$，zhouwc 拥有数 $y$。\n\n第一个回合：$x\\leftarrow(x+y)\\bmod p$。\n\n第二个回合：$y\\leftarrow(x+y)\\bmod p$。\n\n第三个回合：$x\\leftarrow(x+y)\\bmod p$。\n\n第四个回合：$y\\leftarrow(x+y)\\bmod p$。\n\n以此类推....\n\n如果 $x$ 先到 $0$，则 cbw 胜利。如果 $y$ 先到 $0$，则 zhouwc 胜利。如果 $x,y$ 都不能到 $0$，则为平局。\n\ncbw 为了捍卫自己主席的尊严，想要提前知道游戏的结果，并且可以趁机动点手脚，所以他希望你来告诉他结果。", "inputFormat": "有多组数据。\n\n第一行：$T$ 和 $p$ 表示一共有 $T$ 组数据且模数都为 $p$。\n\n以下 $T$ 行，每行两个数 $x,y$。", "outputFormat": "共 $T$ 行\n\n$1$ 表示 cbw 获胜，$2$ 表示 zhouwc 获胜，```error``` 表示平局。", "hint": "$1 \\leq T \\leq 200$。\n\n$1 \\leq x,y,p \\leq 10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound1] The Best in the World", "background": "After cbw, the best in the world, ruled the entire universe as chairman in the year 8102, he began to live a relaxed life and invited his friends to play games with him every day. Since cbw wanted to appear approachable, zhouwc, although a “juruo” (weak player), also got the chance to play with cbw.", "description": "The game works as follows:\n\nGiven two numbers $x$, $y$, and a modulus $p$.\n\ncbw has the number $x$, and zhouwc has the number $y$.\n\nRound 1: $x\\leftarrow(x+y)\\bmod p$.\n\nRound 2: $y\\leftarrow(x+y)\\bmod p$.\n\nRound 3: $x\\leftarrow(x+y)\\bmod p$.\n\nRound 4: $y\\leftarrow(x+y)\\bmod p$.\n\nAnd so on...\n\nIf $x$ reaches $0$ first, then cbw wins. If $y$ reaches $0$ first, then zhouwc wins. If neither $x$ nor $y$ can reach $0$, then it is a draw.\n\nTo protect his dignity as chairman, cbw wants to know the result of the game in advance, and he can also take the chance to “do something” behind the scenes. Therefore, he hopes you can tell him the result.", "inputFormat": "There are multiple test cases.\n\nThe first line contains $T$ and $p$, meaning there are $T$ test cases in total, and the modulus for all of them is $p$.\n\nThe next $T$ lines each contain two numbers $x,y$.", "outputFormat": "Output $T$ lines in total.\n\n$1$ means cbw wins, $2$ means zhouwc wins, and ```error``` means a draw.", "hint": "$1 \\leq T \\leq 200$.\n\n$1 \\leq x,y,p \\leq 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound1】天下第一", "background": "天下第一的 cbw 以主席的身份在 8102 年统治全宇宙后，开始了自己休闲的生活，并邀请自己的好友每天都来和他做游戏。由于 cbw 想要显出自己平易近人，所以 zhouwc 虽然是一个蒟蒻，也有能和 cbw 玩游戏的机会。", "description": "游戏是这样的：\n\n给定两个数 $x$，$y$，与一个模数 $p$。\n\ncbw 拥有数 $x$，zhouwc 拥有数 $y$。\n\n第一个回合：$x\\leftarrow(x+y)\\bmod p$。\n\n第二个回合：$y\\leftarrow(x+y)\\bmod p$。\n\n第三个回合：$x\\leftarrow(x+y)\\bmod p$。\n\n第四个回合：$y\\leftarrow(x+y)\\bmod p$。\n\n以此类推....\n\n如果 $x$ 先到 $0$，则 cbw 胜利。如果 $y$ 先到 $0$，则 zhouwc 胜利。如果 $x,y$ 都不能到 $0$，则为平局。\n\ncbw 为了捍卫自己主席的尊严，想要提前知道游戏的结果，并且可以趁机动点手脚，所以他希望你来告诉他结果。", "inputFormat": "有多组数据。\n\n第一行：$T$ 和 $p$ 表示一共有 $T$ 组数据且模数都为 $p$。\n\n以下 $T$ 行，每行两个数 $x,y$。", "outputFormat": "共 $T$ 行\n\n$1$ 表示 cbw 获胜，$2$ 表示 zhouwc 获胜，```error``` 表示平局。", "hint": "$1 \\leq T \\leq 200$。\n\n$1 \\leq x,y,p \\leq 10000$。", "locale": "zh-CN"}}}
{"pid": "P5637", "type": "P", "difficulty": 6, "samples": [["2 1\n1 2\n1", "0\n2"], ["10 2\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n2\n5", "3\n0\n3\n4\n0\n8\n10\n13\n14\n15"], ["10 2\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n1 9  \n1 10\n3\n6", "5\n5\n0\n5\n5\n0\n5\n5\n5\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "ckw的树", "background": "", "description": "ckw有一棵无根树，ckw会随意挑一个点然后开始随机游走，每一个单位时间会等概率跳到与当前点距离不超过$2$的任意一个点。树上有一些点被标记了，求ckw第一次到达被标记的点的期望时间。\n", "inputFormat": "第一行一个数$n$,$m$，表示点的个数和标记个数。\n\n接下来$n-1$行，每行两个数$x$,$y$，表示$x$和$y$之间有一条边。\n\n接下来$m$行，每行一个数表示被标记的点（可能有重复）\n", "outputFormat": "$n$行每行一个数，第$i$行的数表示从编号为$i$的点开始随机游走的期望步数$mod\\ 998244353$之后的值。\n", "hint": "$2 \\le n\\le 10^5,1\\le m \\le n$\n\n$subtask1(20pts):n\\le 300$\n\n$subtask2(16pts):$第$i$条边连接$i$和$i+1$\n\n$subtask3(8pts):$第$i$条边链接$1$和$i+1$\n\n$subtask4(20pts):n\\le 3000$，且最大点的度数不超过$4$\n\n$subtask5(36pts):$无限制", "locale": "zh-CN", "translations": {"en": {"title": "ckw's Tree", "background": "", "description": "ckw has an unrooted tree. ckw will randomly pick a node and then start a random walk. In each unit of time, they move with equal probability to any node whose distance from the current node is at most $2$. Some nodes on the tree are marked. Find the expected time for ckw to reach a marked node for the first time.", "inputFormat": "The first line contains two integers $n$, $m$, representing the number of nodes and the number of marks.\n\nThe next $n - 1$ lines each contain two integers $x$, $y$, indicating that there is an edge between $x$ and $y$.\n\nThe next $m$ lines each contain one integer, representing a marked node (duplicates may appear).", "outputFormat": "Output $n$ lines, one number per line. The number on line $i$ is the expected number of steps when starting the random walk from node $i$, taken modulo $998244353$.", "hint": "Constraints: $2 \\le n \\le 10^5$, $1 \\le m \\le n$.\n\nSubtask 1 (20 pts): $n \\le 300$.\n\nSubtask 2 (16 pts): The $i$-th edge connects $i$ and $i + 1$.\n\nSubtask 3 (8 pts): The $i$-th edge connects $1$ and $i + 1$.\n\nSubtask 4 (20 pts): $n \\le 3000$, and the maximum degree of any node is at most $4$.\n\nSubtask 5 (36 pts): No additional constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "ckw的树", "background": "", "description": "ckw有一棵无根树，ckw会随意挑一个点然后开始随机游走，每一个单位时间会等概率跳到与当前点距离不超过$2$的任意一个点。树上有一些点被标记了，求ckw第一次到达被标记的点的期望时间。\n", "inputFormat": "第一行一个数$n$,$m$，表示点的个数和标记个数。\n\n接下来$n-1$行，每行两个数$x$,$y$，表示$x$和$y$之间有一条边。\n\n接下来$m$行，每行一个数表示被标记的点（可能有重复）\n", "outputFormat": "$n$行每行一个数，第$i$行的数表示从编号为$i$的点开始随机游走的期望步数$mod\\ 998244353$之后的值。\n", "hint": "$2 \\le n\\le 10^5,1\\le m \\le n$\n\n$subtask1(20pts):n\\le 300$\n\n$subtask2(16pts):$第$i$条边连接$i$和$i+1$\n\n$subtask3(8pts):$第$i$条边链接$1$和$i+1$\n\n$subtask4(20pts):n\\le 3000$，且最大点的度数不超过$4$\n\n$subtask5(36pts):$无限制", "locale": "zh-CN"}}}
{"pid": "P5638", "type": "P", "difficulty": 2, "samples": [["4 0\n1 2 3", "6"], ["4 1\n1 2 3", "3"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "前缀和", "洛谷月赛"], "title": "【CSGRound2】光骓者的荣耀", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n小 K 又在做白日梦了。他进入到他的幻想中，发现他打下了一片江山。", "description": "小 K 打下的江山一共有 $n$ 个城市，城市 $i$ 和城市 $i+1$ 有一条双向高速公路连接，走这条路要耗费时间 $a_i$。\n\n小 K 为了关心人民生活，决定定期进行走访。他每一次会从 $1$ 号城市到 $n$ 号城市并在经过的城市进行访问。其中终点必须为城市 $n$。\n\n不仅如此，他还有一个传送器，传送半径为 $k$，也就是可以传送到 $i-k$ 和 $i+k$。如果目标城市编号小于 $1$ 则为 $1$，大于 $n$ 则为 $n$。\n\n但是他的传送器电量不足，只能传送一次，况且由于一些原因，他想尽量快的完成访问，于是就想问交通部部长您最快的时间是多少。\n\n注意：**他可以不访问所有的城市，使用传送器不耗费时间**。", "inputFormat": "两行，第一行两个正整数 $n,k$。\n\n第二行 $n-1$ 个整数，第 $i$ 个表示 $a_i$。", "outputFormat": "一个整数，表示答案。", "hint": "### 样例解释 1：\n\n样例 1,2 的图示均为以下图片：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/42z5mohh.png)\n\n不使用传送器直接走，答案为 $6$，可以证明这个是最小值。\n\n### 样例解释 2：\n\n在 $3$ 处使用，传送到 $4$，答案为 $3$，可以证明这个是最小值。\n\n### 数据范围：\n\n对于所有数据，$n\\ge 2$，$k\\ge 1$，$a_i > 0$。\n\n| 测试点编号 | $n$ 的范围 | $k$ 的范围 | $a_i$ 的范围 |\n|:-:|:-:|:-:|:-:|\n| $1\\sim 10$ | $\\le 100$ | $\\le 100$ | $\\le 10^5$ |\n| $11\\sim 20$ | $\\le 3\\times 10^3$ | $\\le 3\\times 10^3$ | $\\le 10^9$ |\n| $21$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^{12}$ |\n| $22$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\le 10^{12}$ |\n| $23$ | $\\le 5\\times 10^5$ | $\\le 5\\times 10^5$ | $\\le 10^{12}$ |\n| $24\\sim 25$ | $\\le 10^6$ | $\\le 10^6$ | $\\le 10^{12}$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound2] Glory of the Light Steed Rider.", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\nLittle K is daydreaming again. He enters his fantasy world and finds that he has conquered a vast land.", "description": "The land that Little K has conquered contains a total of $n$ cities. City $i$ and city $i+1$ are connected by a two-way highway, and traveling along this road takes time $a_i$.\n\nIn order to care about the people’s lives, Little K decides to make regular visits. Each time, he will travel from city $1$ to city $n$ and visit the cities he passes through. The destination must be city $n$.\n\nMoreover, he has a teleporter with teleport radius $k$, meaning he can teleport to $i-k$ and $i+k$. If the target city index is less than $1$, it becomes $1$; if it is greater than $n$, it becomes $n$.\n\nHowever, his teleporter does not have enough power and can only be used once. Also, for some reason, he wants to finish the visits as quickly as possible, so he asks you, the Minister of Transportation, what the minimum time is.\n\nNote: **He does not need to visit all cities, and using the teleporter costs no time**.", "inputFormat": "Two lines. The first line contains two positive integers $n, k$.\n\nThe second line contains $n-1$ integers, where the $i$-th one denotes $a_i$.", "outputFormat": "One integer, indicating the answer.", "hint": "### Sample Explanation 1:\n\nThe illustrations for samples 1 and 2 are both the following image:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/42z5mohh.png)\n\nIf the teleporter is not used and you just walk directly, the answer is $6$. It can be proven that this is the minimum.\n\n### Sample Explanation 2:\n\nUse it at $3$ and teleport to $4$. The answer is $3$. It can be proven that this is the minimum.\n\n### Constraints:\n\nFor all testdata, $n \\ge 2$, $k \\ge 1$, $a_i > 0$.\n\n| Test Point ID | Range of $n$ | Range of $k$ | Range of $a_i$ |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 10$ | $\\le 100$ | $\\le 100$ | $\\le 10^5$ |\n| $11 \\sim 20$ | $\\le 3 \\times 10^3$ | $\\le 3 \\times 10^3$ | $\\le 10^9$ |\n| $21$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^{12}$ |\n| $22$ | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | $\\le 10^{12}$ |\n| $23$ | $\\le 5 \\times 10^5$ | $\\le 5 \\times 10^5$ | $\\le 10^{12}$ |\n| $24 \\sim 25$ | $\\le 10^6$ | $\\le 10^6$ | $\\le 10^{12}$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound2】光骓者的荣耀", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n小 K 又在做白日梦了。他进入到他的幻想中，发现他打下了一片江山。", "description": "小 K 打下的江山一共有 $n$ 个城市，城市 $i$ 和城市 $i+1$ 有一条双向高速公路连接，走这条路要耗费时间 $a_i$。\n\n小 K 为了关心人民生活，决定定期进行走访。他每一次会从 $1$ 号城市到 $n$ 号城市并在经过的城市进行访问。其中终点必须为城市 $n$。\n\n不仅如此，他还有一个传送器，传送半径为 $k$，也就是可以传送到 $i-k$ 和 $i+k$。如果目标城市编号小于 $1$ 则为 $1$，大于 $n$ 则为 $n$。\n\n但是他的传送器电量不足，只能传送一次，况且由于一些原因，他想尽量快的完成访问，于是就想问交通部部长您最快的时间是多少。\n\n注意：**他可以不访问所有的城市，使用传送器不耗费时间**。", "inputFormat": "两行，第一行两个正整数 $n,k$。\n\n第二行 $n-1$ 个整数，第 $i$ 个表示 $a_i$。", "outputFormat": "一个整数，表示答案。", "hint": "### 样例解释 1：\n\n样例 1,2 的图示均为以下图片：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/42z5mohh.png)\n\n不使用传送器直接走，答案为 $6$，可以证明这个是最小值。\n\n### 样例解释 2：\n\n在 $3$ 处使用，传送到 $4$，答案为 $3$，可以证明这个是最小值。\n\n### 数据范围：\n\n对于所有数据，$n\\ge 2$，$k\\ge 1$，$a_i > 0$。\n\n| 测试点编号 | $n$ 的范围 | $k$ 的范围 | $a_i$ 的范围 |\n|:-:|:-:|:-:|:-:|\n| $1\\sim 10$ | $\\le 100$ | $\\le 100$ | $\\le 10^5$ |\n| $11\\sim 20$ | $\\le 3\\times 10^3$ | $\\le 3\\times 10^3$ | $\\le 10^9$ |\n| $21$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^{12}$ |\n| $22$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\le 10^{12}$ |\n| $23$ | $\\le 5\\times 10^5$ | $\\le 5\\times 10^5$ | $\\le 10^{12}$ |\n| $24\\sim 25$ | $\\le 10^6$ | $\\le 10^6$ | $\\le 10^{12}$ |", "locale": "zh-CN"}}}
{"pid": "P5639", "type": "P", "difficulty": 2, "samples": [["6\n0 0 1 1 0 1", "4"], ["6\n0 0 0 0 0 0", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "洛谷原创", "洛谷月赛"], "title": "【CSGRound2】守序者的尊严", "background": "由于 Y 校最近进行了对学校食堂的全面改革与对小卖部的全面整治(乱搞)，导致学校小卖部卖的零食被禁售了；学校食堂的炸鸡窗口也消失了；\n\n并且学校的学生处 Q 主任严禁学生点外卖，日夜监察。\n\n都说民以食为天，由于整天挨饿，全校同学处于水深火热之中。", "description": "zhouwc 的朋友（朋友就是自己系列）小 Z 由于饥饿难忍，不得不铤而走险点外卖。\n\n但是学校的 Q 主任为了能够抓住点外卖的学生布置了天罗地网——监控。\n\n但是由于学校给 Q 主任的经费有限，所以这些监控不能持续工作，工作一秒之后便要暂停休息一秒，**即开启一秒后关闭一秒再开启一秒……以此类推**。\n\n还是由于 Q 主任的经费有限，这些监控被排成了一条直线，这条直线便在学生通往学生外卖驻点——二号门（没有门卫）的必经之路上。\n\n因为小 Z 修习了疾跑技能，所以小 Z 通过任意个数关闭的监控的时间均为 \n $1$（即一次行动可以经过若干个未开的监控）。\n\n由于小 Z 想吃外卖又不想受到正在监控室看着监控的 Q 主任的处分，请你告诉他至少要多少时间才能安全到达外卖驻点。", "inputFormat": "共 $2$ 行。\n\n第一行一个正整数 $n$，表示在这条路上一共有 $n$ 个监控。\n\n第二行共有 $n$ 个数。表示在第 $0$ 秒是这些监控的开关情况，$0$ 表示监控关闭，$1$ 表示监控开启，并保证第一个监控一定是关闭的。", "outputFormat": "共一行，表示小 Z 安全到达外卖驻点所需要的时间。", "hint": "#### 数据范围\n\n对于 $10\\%$ 的数据，$1 \\leq n \\leq 10$\n\n对于 $30\\%$ 的数据，$1 \\leq n \\leq 100$\n\n对于 $50\\%$ 的数据，$1 \\leq n \\leq 10^3$\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 10^5$\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$\n\n监控的开关情况均用 $0$ 和 $1$ 来表示。\n\n#### 样例解释一\n\n小 Z 在第一秒时冲到第二个监控处，用时 $1$ 秒，总用时 $1$ 秒。\n\n第二秒时，监控的开关状况变为了 $1 1 0 0 1 0$。\n\n这时，小 Z 迅速从二号监控处冲到了四号监控处，用时 $1$ 秒，总用时 $2$ 秒。\n\n第三秒时，监控的开关状况变为了 $0\\ 0\\ 1\\ 1\\ 0\\ 1$。\n\n这时，小 Z 迅速从四号监控处冲到了五号监控处，用时 $1$ 秒，总用时 $3$ 秒。\n\n第四秒时，监控的开关状况变为了 $1\\ 1\\ 0\\ 0\\ 1\\ 0$。\n\n这时，小 Z 迅速从五号监控处冲出了监控区域，用时 $1$ 秒，总用时 $4$ 秒。\n\n#### 样例解释二\n\n小 Z 在第一秒直接冲出了监控区域。", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound2] The Dignity of the Lawful Ones", "background": "Because School Y recently carried out a full reform of the school cafeteria and a complete “cleanup” (messing around) of the school store, the snacks sold in the school store were banned; the fried chicken stall in the cafeteria also disappeared.\n\nAlso, Director Q from the Student Affairs Office strictly forbids students from ordering delivery, monitoring day and night.\n\nAs the saying goes, food is the first necessity of the people. Since they are hungry all day, students across the whole school are suffering badly.", "description": "Xiao Z, a friend of zhouwc (the “my friend is actually me” kind), cannot bear the hunger and has to take the risk of ordering delivery.\n\nHowever, to catch students who order delivery, Director Q set up a tight net—cameras.\n\nBut because the school’s budget for Director Q is limited, these cameras cannot work continuously. After working for one second, they must stop and rest for one second, **that is, after being on for one second, they turn off for one second, then on for one second... and so on**.\n\nAlso due to limited budget, these cameras are arranged in a straight line, which lies on the only path students must take to reach the delivery pickup point—the Gate 2 (with no guard).\n\nBecause Xiao Z has learned a sprint skill, the time for him to pass through any number of cameras that are turned off is $1$ (that is, in one move he can pass through several cameras that are not on).\n\nSince Xiao Z wants to eat delivery food but does not want to be punished by Director Q watching in the control room, please tell him the minimum time needed to safely reach the pickup point.", "inputFormat": "There are $2$ lines in total.\n\nThe first line contains a positive integer $n$, meaning there are $n$ cameras on this road.\n\nThe second line contains $n$ numbers, representing the on/off states of these cameras at time $0$ seconds. $0$ means a camera is off, and $1$ means it is on. It is guaranteed that the first camera is off.", "outputFormat": "Output one line, the time required for Xiao Z to safely reach the delivery pickup point.", "hint": "#### Constraints\n\nFor $10\\%$ of the testdata, $1 \\leq n \\leq 10$.\n\nFor $30\\%$ of the testdata, $1 \\leq n \\leq 100$.\n\nFor $50\\%$ of the testdata, $1 \\leq n \\leq 10^3$.\n\nFor $70\\%$ of the testdata, $1 \\leq n \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 10^6$.\n\nThe camera states are all represented using $0$ and $1$.\n\n#### Sample Explanation 1\n\nIn the first second, Xiao Z rushes to the second camera, taking $1$ second, for a total time of $1$ second.\n\nIn the second second, the camera states become $1\\ 1\\ 0\\ 0\\ 1\\ 0$.\n\nAt this time, Xiao Z quickly rushes from the second camera to the fourth camera, taking $1$ second, for a total time of $2$ seconds.\n\nIn the third second, the camera states become $0\\ 0\\ 1\\ 1\\ 0\\ 1$.\n\nAt this time, Xiao Z quickly rushes from the fourth camera to the fifth camera, taking $1$ second, for a total time of $3$ seconds.\n\nIn the fourth second, the camera states become $1\\ 1\\ 0\\ 0\\ 1\\ 0$.\n\nAt this time, Xiao Z quickly rushes from the fifth camera and leaves the monitored area, taking $1$ second, for a total time of $4$ seconds.\n\n#### Sample Explanation 2\n\nIn the first second, Xiao Z rushes out of the monitored area directly.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound2】守序者的尊严", "background": "由于 Y 校最近进行了对学校食堂的全面改革与对小卖部的全面整治(乱搞)，导致学校小卖部卖的零食被禁售了；学校食堂的炸鸡窗口也消失了；\n\n并且学校的学生处 Q 主任严禁学生点外卖，日夜监察。\n\n都说民以食为天，由于整天挨饿，全校同学处于水深火热之中。", "description": "zhouwc 的朋友（朋友就是自己系列）小 Z 由于饥饿难忍，不得不铤而走险点外卖。\n\n但是学校的 Q 主任为了能够抓住点外卖的学生布置了天罗地网——监控。\n\n但是由于学校给 Q 主任的经费有限，所以这些监控不能持续工作，工作一秒之后便要暂停休息一秒，**即开启一秒后关闭一秒再开启一秒……以此类推**。\n\n还是由于 Q 主任的经费有限，这些监控被排成了一条直线，这条直线便在学生通往学生外卖驻点——二号门（没有门卫）的必经之路上。\n\n因为小 Z 修习了疾跑技能，所以小 Z 通过任意个数关闭的监控的时间均为 \n $1$（即一次行动可以经过若干个未开的监控）。\n\n由于小 Z 想吃外卖又不想受到正在监控室看着监控的 Q 主任的处分，请你告诉他至少要多少时间才能安全到达外卖驻点。", "inputFormat": "共 $2$ 行。\n\n第一行一个正整数 $n$，表示在这条路上一共有 $n$ 个监控。\n\n第二行共有 $n$ 个数。表示在第 $0$ 秒是这些监控的开关情况，$0$ 表示监控关闭，$1$ 表示监控开启，并保证第一个监控一定是关闭的。", "outputFormat": "共一行，表示小 Z 安全到达外卖驻点所需要的时间。", "hint": "#### 数据范围\n\n对于 $10\\%$ 的数据，$1 \\leq n \\leq 10$\n\n对于 $30\\%$ 的数据，$1 \\leq n \\leq 100$\n\n对于 $50\\%$ 的数据，$1 \\leq n \\leq 10^3$\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 10^5$\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$\n\n监控的开关情况均用 $0$ 和 $1$ 来表示。\n\n#### 样例解释一\n\n小 Z 在第一秒时冲到第二个监控处，用时 $1$ 秒，总用时 $1$ 秒。\n\n第二秒时，监控的开关状况变为了 $1 1 0 0 1 0$。\n\n这时，小 Z 迅速从二号监控处冲到了四号监控处，用时 $1$ 秒，总用时 $2$ 秒。\n\n第三秒时，监控的开关状况变为了 $0\\ 0\\ 1\\ 1\\ 0\\ 1$。\n\n这时，小 Z 迅速从四号监控处冲到了五号监控处，用时 $1$ 秒，总用时 $3$ 秒。\n\n第四秒时，监控的开关状况变为了 $1\\ 1\\ 0\\ 0\\ 1\\ 0$。\n\n这时，小 Z 迅速从五号监控处冲出了监控区域，用时 $1$ 秒，总用时 $4$ 秒。\n\n#### 样例解释二\n\n小 Z 在第一秒直接冲出了监控区域。", "locale": "zh-CN"}}}
{"pid": "P5640", "type": "P", "difficulty": 5, "samples": [["10 3\n1 2 3 1 2 3 2 3 2 3\n0 1\n1 2\n0 3", "0\n1\n1"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "位运算", "洛谷月赛", "状压 DP"], "title": "【CSGRound2】逐梦者的初心", "background": "#### 注意：本题时限修改至250ms，并且数据进行大幅度加强。本题强制开启O2优化，并且不再重测，请大家自己重新提交。\n\n由于Y校的老师非常毒瘤，要求zhouwc在csp考前最后3天参加期中考，zhouwc非常生气，决定消极考试，以涂完卡但全错为目标。现在retcarizy看zhouwc太可怜了，想要帮zhouwc解决一个问题，但他自己又太忙了，咕咕咕，于是就把问题甩给了你。", "description": "给你一个长度为n的字符串S。\n\n有m个操作，保证$m\\le n$。\n\n你还有一个字符串T，刚开始为空。\n\n共有两种操作。\n\n第一种操作：\n\n在字符串T的末尾加上一个字符。\n\n第二种操作：\n\n在字符串T的开头加上一个字符。\n\n每次操作完成后要求输出有几个$l \\in [1,T.size]$满足以下条件：\n\n对于$\\forall i \\in [1,l]$有$T_{T.size-l+i} \\ne S_{i}$ \n\n$Tip:$字符串下标从1开始。$T.size$表示T的长度。", "inputFormat": "第一行两个正整数$n,m$。\n\n第二行n个正整数，用空格隔开，第$i$个整数表示$S_i$。\n\n接下来$m$行，每行两个数字$opt,ch$，$opt=0$表示在T的末尾加一个字符$ch$,$opt=1$表示在T的开头加一个字符$ch$。", "outputFormat": "共$m$行，每行一个非负整数表示第m操作后的输出。", "hint": "注意：本题采用**捆绑测试**，只有当你通过一个subtask的所有点后，你才能拿到这个subtask的分数\n\n对于所有的数据 $n \\leq 10^6,m \\leq 3.3333 \\times 10^4,|\\sum|\\leq10^3,S_i \\in [1,|\\sum|]$。($\\sum$表示字符集)\n\nsubtask1$(17\\%)$:$m \\leq 333$\n\nsubtask2$(33\\%)$:$m \\leq 3333$\n\nsubtask3$(20\\%)$:$|\\sum|\\leq2$\n\nsubtask4$(30\\%)$:无特殊条件\n\n\n#### 样例解释：\n第一次操作后，$T=\"1\"$,\n\n$l=1$时$T[1]=S[1]$，所以答案为0\n\n第二次操作后，$T=\"21\"$,\n\n$l=1$时，$T[2]=S[1]$\n\n$l=2$时，$T[1]!=S[1]$,$T[2]!=S[2]$所以答案为1\n\n第三次操作后，$T=\"213\"$,\n\n$l=1$时，$T[3]!=S[1]$;\n\n$l=2$时，$T[2]=S[1]$;\n\n$l=3$时，$T[3]=S[3]$所以答案为1\n", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound2] The Dream Chaser’s Original Aspiration.", "background": "#### Note: The time limit for this problem has been changed to 250 ms, and the testdata has been greatly strengthened. This problem forces O2 optimization, and there will be no rejudge. Please resubmit by yourselves.\n\nBecause the teachers at School Y are very “toxic”, they required zhouwc to take the midterm exam during the last 3 days before the CSP exam. zhouwc was very angry and decided to do badly on purpose, aiming to finish filling the answer sheet but get everything wrong. Now retcarizy feels zhouwc is too pitiful and wants to help zhouwc solve a problem, but he is too busy, gugugu, so he threw the problem to you.", "description": "You are given a string $S$ of length $n$.\n\nThere are $m$ operations, and it is guaranteed that $m \\le n$.\n\nYou also have a string $T$, which is empty at the beginning.\n\nThere are two types of operations.\n\nThe first type of operation:\n\nAppend one character to the end of string $T$.\n\nThe second type of operation:\n\nPrepend one character to the beginning of string $T$.\n\nAfter each operation, you need to output how many $l \\in [1,T.size]$ satisfy the following condition:\n\nFor $\\forall i \\in [1,l]$, we have $T_{T.size-l+i} \\ne S_{i}$.\n\n$Tip:$ String indices start from 1. $T.size$ denotes the length of $T$.", "inputFormat": "The first line contains two positive integers $n,m$.\n\nThe second line contains $n$ positive integers separated by spaces. The $i$-th integer represents $S_i$.\n\nNext, there are $m$ lines, each containing two numbers $opt,ch$. $opt=0$ means appending a character $ch$ to the end of $T$, and $opt=1$ means prepending a character $ch$ to the beginning of $T$.", "outputFormat": "Output $m$ lines. Each line contains one non-negative integer representing the answer after the $m$-th operation.", "hint": "Note: This problem uses **bundled tests**. You can get the score of a subtask only after you pass all test points of that subtask.\n\nFor all testdata, $n \\leq 10^6,m \\leq 3.3333 \\times 10^4,|\\sum|\\leq10^3,S_i \\in [1,|\\sum|]$. ($\\sum$ denotes the alphabet)\n\nsubtask 1 $(17\\%)$: $m \\leq 333$.\n\nsubtask 2 $(33\\%)$: $m \\leq 3333$.\n\nsubtask 3 $(20\\%)$: $|\\sum|\\leq2$.\n\nsubtask 4 $(30\\%)$: no special constraints.\n\n#### Sample Explanation:\nAfter the first operation, $T=\"1\"$.\n\nWhen $l=1$, $T[1]=S[1]$, so the answer is 0.\n\nAfter the second operation, $T=\"21\"$.\n\nWhen $l=1$, $T[2]=S[1]$.\n\nWhen $l=2$, $T[1]!=S[1]$, $T[2]!=S[2]$, so the answer is 1.\n\nAfter the third operation, $T=\"213\"$.\n\nWhen $l=1$, $T[3]!=S[1]$.\n\nWhen $l=2$, $T[2]=S[1]$.\n\nWhen $l=3$, $T[3]=S[3]$, so the answer is 1.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound2】逐梦者的初心", "background": "#### 注意：本题时限修改至250ms，并且数据进行大幅度加强。本题强制开启O2优化，并且不再重测，请大家自己重新提交。\n\n由于Y校的老师非常毒瘤，要求zhouwc在csp考前最后3天参加期中考，zhouwc非常生气，决定消极考试，以涂完卡但全错为目标。现在retcarizy看zhouwc太可怜了，想要帮zhouwc解决一个问题，但他自己又太忙了，咕咕咕，于是就把问题甩给了你。", "description": "给你一个长度为n的字符串S。\n\n有m个操作，保证$m\\le n$。\n\n你还有一个字符串T，刚开始为空。\n\n共有两种操作。\n\n第一种操作：\n\n在字符串T的末尾加上一个字符。\n\n第二种操作：\n\n在字符串T的开头加上一个字符。\n\n每次操作完成后要求输出有几个$l \\in [1,T.size]$满足以下条件：\n\n对于$\\forall i \\in [1,l]$有$T_{T.size-l+i} \\ne S_{i}$ \n\n$Tip:$字符串下标从1开始。$T.size$表示T的长度。", "inputFormat": "第一行两个正整数$n,m$。\n\n第二行n个正整数，用空格隔开，第$i$个整数表示$S_i$。\n\n接下来$m$行，每行两个数字$opt,ch$，$opt=0$表示在T的末尾加一个字符$ch$,$opt=1$表示在T的开头加一个字符$ch$。", "outputFormat": "共$m$行，每行一个非负整数表示第m操作后的输出。", "hint": "注意：本题采用**捆绑测试**，只有当你通过一个subtask的所有点后，你才能拿到这个subtask的分数\n\n对于所有的数据 $n \\leq 10^6,m \\leq 3.3333 \\times 10^4,|\\sum|\\leq10^3,S_i \\in [1,|\\sum|]$。($\\sum$表示字符集)\n\nsubtask1$(17\\%)$:$m \\leq 333$\n\nsubtask2$(33\\%)$:$m \\leq 3333$\n\nsubtask3$(20\\%)$:$|\\sum|\\leq2$\n\nsubtask4$(30\\%)$:无特殊条件\n\n\n#### 样例解释：\n第一次操作后，$T=\"1\"$,\n\n$l=1$时$T[1]=S[1]$，所以答案为0\n\n第二次操作后，$T=\"21\"$,\n\n$l=1$时，$T[2]=S[1]$\n\n$l=2$时，$T[1]!=S[1]$,$T[2]!=S[2]$所以答案为1\n\n第三次操作后，$T=\"213\"$,\n\n$l=1$时，$T[3]!=S[1]$;\n\n$l=2$时，$T[2]=S[1]$;\n\n$l=3$时，$T[3]=S[3]$所以答案为1\n", "locale": "zh-CN"}}}
{"pid": "P5641", "type": "P", "difficulty": 6, "samples": [["3 1\n1 2 3", "1 3 6"], ["3 2\n1 2 3", "1 6 20"], ["3 10\n1 2 3", "1 30 420"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "快速傅里叶变换 FFT", "快速数论变换 NTT", "洛谷月赛"], "title": "【CSGRound2】开拓者的卓识", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n（上图转载于某神仙的题目描述）\n\n小 K 又在做白日梦了。他进入到他的幻想中，发现了一个非常有趣的序列$a$和一个非常有趣的数$k$。", "description": "我们记一个序列 $[l,r]$ 的 $k$ 阶子段和为 $sum_{k,l,r}$，有\n\n$$sum_{k,l,r}=\\begin{cases}\\sum\\limits_{i=l}^{r}a_i&,k=1\\\\\\sum\\limits_{i=l}^{r}\\sum\\limits_{j=i}^{r}sum_{k-1,i,j}&,k\\geq 2\\end{cases}$$\n\n他现在站在位置 $1$ 上，他每一次往右开拓一个格子就可以增加他 IOI 赛场的 rp，所以他想尽可能的多开拓格子。可是每一次他从 $r$ 开拓到 $r+1$ 需要正确的回答 $sum_{k,1,r}$。小 K 不屑于算，就把任务交给你了。", "inputFormat": "两行。第一行 $n,k$，表示 $a$ 的长度和 $k$。\n\n第二行 $n$ 个正整数，表示 $a$。", "outputFormat": "一行，第 $i$ 个数为 $sum_{k,1,i}$。由于答案过大，您只需要求出答案对 $998244353$ 取模的值。", "hint": "### 样例解释 2\n\n$sum_{2,1,1}=sum_{1,1,1}=1$\n\n$sum_{2,1,2}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,2,2}=1+3+2=6$\n\n$sum_{2,1,3}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,1,3}+sum_{1,2,2}+sum_{1,2,3}+sum_{1,3,3}=1+3+6+2+5+3=20$\n\n### 数据范围\n\n| 测试点编号 |  $n$ 的范围 |  $k$ 的范围 |  $a_i$ 的范围 |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 2$ |  $\\le 10$ |  $\\le 10$ |  $\\le 10$ |\n|  $3\\sim 8$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 10^5$ |\n|  $9$ |  $\\le 10^5$ |  $=1$ |  $\\le 998244353$ | \n|  $10$ |  $\\le 10^5$ |  $=2$ |  $\\le 998244353$ |\n|  $11$ |  $\\le 10^5$ |  $=3$ |  $\\le 998244353$ |\n|  $12$ |  $\\le 10^5$ |  $\\le 10$ |  $\\le 998244353$ |\n|  $13\\sim 17$ |  $\\le 10^5$ |  $\\le 10^2$ |  $\\le 998244353$ |\n|  $18$ |  $\\le 10^5$ |  $\\le 10^5$ |  $\\le 998244353$ |\n|  $19\\sim 25$ |  $\\le 10^5$ |  $\\le 998244353$ |  $\\le 998244353$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound2] The Pioneer’s Insight.", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n(The picture above is reposted from a certain expert’s problem statement.)\n\nLittle K is daydreaming again. In his fantasy, he found a very interesting sequence $a$ and a very interesting number $k$.", "description": "For a sequence interval $[l,r]$, we define its $k$-th order subsegment sum as $sum_{k,l,r}$, where\n\n$$sum_{k,l,r}=\\begin{cases}\\sum\\limits_{i=l}^{r}a_i&,k=1\\\\\\sum\\limits_{i=l}^{r}\\sum\\limits_{j=i}^{r}sum_{k-1,i,j}&,k\\geq 2\\end{cases}$$\n\nHe is now standing at position $1$. Each time he expands one cell to the right, he can increase his rp on the IOI contest field, so he wants to expand as many cells as possible. However, every time he expands from $r$ to $r+1$, he needs to correctly answer $sum_{k,1,r}$. Little K cannot be bothered to calculate it, so he leaves the task to you.", "inputFormat": "Two lines. The first line contains $n,k$, representing the length of $a$ and $k$.\n\nThe second line contains $n$ positive integers, representing $a$.", "outputFormat": "One line. The $i$-th number is $sum_{k,1,i}$. Since the answer is too large, you only need to output the value modulo $998244353$.", "hint": "### Sample Explanation 2\n\n$sum_{2,1,1}=sum_{1,1,1}=1$\n\n$sum_{2,1,2}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,2,2}=1+3+2=6$\n\n$sum_{2,1,3}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,1,3}+sum_{1,2,2}+sum_{1,2,3}+sum_{1,3,3}=1+3+6+2+5+3=20$\n\n### Constraints\n\n| Test Point ID |  Range of $n$ |  Range of $k$ |  Range of $a_i$ |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 2$ |  $\\le 10$ |  $\\le 10$ |  $\\le 10$ |\n|  $3\\sim 8$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 10^5$ |\n|  $9$ |  $\\le 10^5$ |  $=1$ |  $\\le 998244353$ | \n|  $10$ |  $\\le 10^5$ |  $=2$ |  $\\le 998244353$ |\n|  $11$ |  $\\le 10^5$ |  $=3$ |  $\\le 998244353$ |\n|  $12$ |  $\\le 10^5$ |  $\\le 10$ |  $\\le 998244353$ |\n|  $13\\sim 17$ |  $\\le 10^5$ |  $\\le 10^2$ |  $\\le 998244353$ |\n|  $18$ |  $\\le 10^5$ |  $\\le 10^5$ |  $\\le 998244353$ |\n|  $19\\sim 25$ |  $\\le 10^5$ |  $\\le 998244353$ |  $\\le 998244353$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound2】开拓者的卓识", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n（上图转载于某神仙的题目描述）\n\n小 K 又在做白日梦了。他进入到他的幻想中，发现了一个非常有趣的序列$a$和一个非常有趣的数$k$。", "description": "我们记一个序列 $[l,r]$ 的 $k$ 阶子段和为 $sum_{k,l,r}$，有\n\n$$sum_{k,l,r}=\\begin{cases}\\sum\\limits_{i=l}^{r}a_i&,k=1\\\\\\sum\\limits_{i=l}^{r}\\sum\\limits_{j=i}^{r}sum_{k-1,i,j}&,k\\geq 2\\end{cases}$$\n\n他现在站在位置 $1$ 上，他每一次往右开拓一个格子就可以增加他 IOI 赛场的 rp，所以他想尽可能的多开拓格子。可是每一次他从 $r$ 开拓到 $r+1$ 需要正确的回答 $sum_{k,1,r}$。小 K 不屑于算，就把任务交给你了。", "inputFormat": "两行。第一行 $n,k$，表示 $a$ 的长度和 $k$。\n\n第二行 $n$ 个正整数，表示 $a$。", "outputFormat": "一行，第 $i$ 个数为 $sum_{k,1,i}$。由于答案过大，您只需要求出答案对 $998244353$ 取模的值。", "hint": "### 样例解释 2\n\n$sum_{2,1,1}=sum_{1,1,1}=1$\n\n$sum_{2,1,2}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,2,2}=1+3+2=6$\n\n$sum_{2,1,3}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,1,3}+sum_{1,2,2}+sum_{1,2,3}+sum_{1,3,3}=1+3+6+2+5+3=20$\n\n### 数据范围\n\n| 测试点编号 |  $n$ 的范围 |  $k$ 的范围 |  $a_i$ 的范围 |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 2$ |  $\\le 10$ |  $\\le 10$ |  $\\le 10$ |\n|  $3\\sim 8$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 10^5$ |\n|  $9$ |  $\\le 10^5$ |  $=1$ |  $\\le 998244353$ | \n|  $10$ |  $\\le 10^5$ |  $=2$ |  $\\le 998244353$ |\n|  $11$ |  $\\le 10^5$ |  $=3$ |  $\\le 998244353$ |\n|  $12$ |  $\\le 10^5$ |  $\\le 10$ |  $\\le 998244353$ |\n|  $13\\sim 17$ |  $\\le 10^5$ |  $\\le 10^2$ |  $\\le 998244353$ |\n|  $18$ |  $\\le 10^5$ |  $\\le 10^5$ |  $\\le 998244353$ |\n|  $19\\sim 25$ |  $\\le 10^5$ |  $\\le 998244353$ |  $\\le 998244353$ |", "locale": "zh-CN"}}}
{"pid": "P5642", "type": "P", "difficulty": 7, "samples": [["4 4\n1 2\n1 3\n1 4\n1 2 1\n3 3 2\n1 4 3\n2 4 6", "100"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "树链剖分"], "title": "人造情感（emotion）", "background": "```\n“这个任务永远无法完成。我不会再重复同样的错误。”\n\n“懂得了爱与情感的他，早已经不是机器人了……从这个角度上看，3000A 就是你的儿子，霍星。”\n\n  永别，3000A！《魔角侦探》\n```\n", "description": "给你一颗 $n$ 个节点的树，以及 $m$ 条路径 $(u, v, w)$，其中 $w$ 可以认为是 $(u, v)$ 这题路径被标记的一个权值。一个路径集合 $S$ 的重量 $W(S)$ 记为：找出 $S$ 的一个权值之和最大的子集，该子集满足任何两条路径没有公共点，这个子集的所有路径权值之和就是 $W(S)$。\n\n记 $f(u, v) = w$ 为最小的非负整数 $w$，使得对于给定的 $m$ 条边组成的路径集合 $U$，$W(U \\cup \\{(u, v, w + 1)\\}) > W(U)$ 。\n\n请你计算下式，对 $998244353$ 取模。\n\n$$ \\sum_{u=1}^n \\sum_{v=1}^n f(u, v) $$\n", "inputFormat": "第一行输入两个整数 $n, m$，表示树的节点数量以及给出的路径数量。\n\n接下来 $n-1$ 行，每行输入两个整数 $u, v$ 表示树的一条边。\n\n接下来 $m$ 行，每行输入三个整数 $u, v, w$，表示在集合中加入这条 $u, v$ 为端点的路径以及其权值。", "outputFormat": "输出一个整数表示答案。", "hint": "#### 样例 1 解释\n\n$f(1, 1) = 6, f(1, 2) = 6, f(1, 3) = 8, f(1, 4) = 6$  \n$f(2, 1) = 6, f(2, 2) = 3, f(2, 3) = 8, f(2, 4) = 6$  \n$f(3, 1) = 8, f(3, 2) = 8, f(3, 3) = 2, f(3, 4) = 8$  \n$f(4, 1) = 6, f(4, 2) = 6, f(4, 3) = 8, f(4, 4) = 5$  \n\n#### 数据范围\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 3\\times 10^5, 0\\le m\\le 3\\times 10^5, 1\\le w\\le 10^9$。\n\n|   测试点   |     $n,m$      |             特殊性质              |\n| :--------: | :------------: | :-------------------------------: |\n|   $1,2$    |     $=10$      |                                   |\n|    $3$     |     $=40$      |                                   |\n|    $4$     |     $=150$     |                                   |\n|   $5,6$    |     $=350$     |                                   |\n|   $7,8$    |    $=1,500$    |                                   |\n|   $9,10$    |    $=3,499$    |                           树的结构 $v=u+1$   |\n|   $11,12$   |    $=3,500$    |                                   |\n|  $13,14$   |   $=99,995$    |         给出的路径 $u=v$          |\n| $15,16$ |   $=99,996$    |         给出的路径 $w=1$          |\n|  $17,18$   |   $=99,997$    |         树的结构 $v=u+1$          |\n|  $19,20$   |   $=99,998$    |          树的结构 $u=1$           |\n| $21,22,23$ |   $=99,999$    | 树的结构 $u = \\lfloor v/2\\rfloor$ |\n|    $24$    |    $=10^5$     |                                   |\n|    $25$    | $=3\\times10^5$ |                                   |\n", "locale": "zh-CN", "translations": {"en": {"title": "Artificial Emotions (emotion)", "background": "```\n“This task can never be completed. I will not repeat the same mistake again.”\n\n“Having learned love and emotions, he is no longer a robot... From this point of view, 3000A is your son, Huo Xing.”\n\nFarewell, 3000A! Detective Magic Horn\n```", "description": "You are given a tree with $n$ nodes, and $m$ paths $(u, v, w)$, where $w$ can be regarded as the weight assigned to the path $(u, v)$. For a set of paths $S$, its weight $W(S)$ is defined as follows: find a subset of $S$ with the maximum possible sum of weights, such that no two paths in this subset share a common vertex. The sum of weights of all paths in this subset is $W(S)$.\n\nDefine $f(u, v) = w$ as the smallest non-negative integer $w$ such that, for the path set $U$ formed by the given $m$ paths, we have $W(U \\cup \\{(u, v, w + 1)\\}) > W(U)$.\n\nCompute the following expression modulo $998244353$:\n\n$$ \\sum_{u=1}^n \\sum_{v=1}^n f(u, v) $$", "inputFormat": "The first line contains two integers $n, m$, representing the number of nodes in the tree and the number of given paths.\n\nThe next $n - 1$ lines each contain two integers $u, v$, describing an edge of the tree.\n\nThe next $m$ lines each contain three integers $u, v, w$, meaning that a path with endpoints $u, v$ and weight $w$ is added into the set.", "outputFormat": "Output one integer, the answer.", "hint": "#### Sample 1 Explanation\n\n$f(1, 1) = 6, f(1, 2) = 6, f(1, 3) = 8, f(1, 4) = 6$  \n$f(2, 1) = 6, f(2, 2) = 3, f(2, 3) = 8, f(2, 4) = 6$  \n$f(3, 1) = 8, f(3, 2) = 8, f(3, 3) = 2, f(3, 4) = 8$  \n$f(4, 1) = 6, f(4, 2) = 6, f(4, 3) = 8, f(4, 4) = 5$  \n\n#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le n \\le 3\\times 10^5$, $0 \\le m \\le 3\\times 10^5$, and $1 \\le w \\le 10^9$.\n\n| Test Point |     $n, m$     |           Special Property            |\n| :--------: | :------------: | :-----------------------------------: |\n|   $1,2$    |     $=10$      |                                       |\n|    $3$     |     $=40$      |                                       |\n|    $4$     |     $=150$     |                                       |\n|   $5,6$    |     $=350$     |                                       |\n|   $7,8$    |    $=1,500$    |                                       |\n|   $9,10$   |    $=3,499$    |        Tree structure $v=u+1$         |\n|  $11,12$   |    $=3,500$    |                                       |\n|  $13,14$   |   $=99,995$    |           Given paths $u=v$           |\n|  $15,16$   |   $=99,996$    |           Given paths $w=1$           |\n|  $17,18$   |   $=99,997$    |        Tree structure $v=u+1$         |\n|  $19,20$   |   $=99,998$    |          Tree structure $u=1$         |\n| $21,22,23$ |   $=99,999$    | Tree structure $u = \\lfloor v/2\\rfloor$ |\n|    $24$    |    $=10^5$     |                                       |\n|    $25$    | $=3\\times10^5$ |                                       |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "人造情感（emotion）", "background": "```\n“这个任务永远无法完成。我不会再重复同样的错误。”\n\n“懂得了爱与情感的他，早已经不是机器人了……从这个角度上看，3000A 就是你的儿子，霍星。”\n\n  永别，3000A！《魔角侦探》\n```\n", "description": "给你一颗 $n$ 个节点的树，以及 $m$ 条路径 $(u, v, w)$，其中 $w$ 可以认为是 $(u, v)$ 这题路径被标记的一个权值。一个路径集合 $S$ 的重量 $W(S)$ 记为：找出 $S$ 的一个权值之和最大的子集，该子集满足任何两条路径没有公共点，这个子集的所有路径权值之和就是 $W(S)$。\n\n记 $f(u, v) = w$ 为最小的非负整数 $w$，使得对于给定的 $m$ 条边组成的路径集合 $U$，$W(U \\cup \\{(u, v, w + 1)\\}) > W(U)$ 。\n\n请你计算下式，对 $998244353$ 取模。\n\n$$ \\sum_{u=1}^n \\sum_{v=1}^n f(u, v) $$\n", "inputFormat": "第一行输入两个整数 $n, m$，表示树的节点数量以及给出的路径数量。\n\n接下来 $n-1$ 行，每行输入两个整数 $u, v$ 表示树的一条边。\n\n接下来 $m$ 行，每行输入三个整数 $u, v, w$，表示在集合中加入这条 $u, v$ 为端点的路径以及其权值。", "outputFormat": "输出一个整数表示答案。", "hint": "#### 样例 1 解释\n\n$f(1, 1) = 6, f(1, 2) = 6, f(1, 3) = 8, f(1, 4) = 6$  \n$f(2, 1) = 6, f(2, 2) = 3, f(2, 3) = 8, f(2, 4) = 6$  \n$f(3, 1) = 8, f(3, 2) = 8, f(3, 3) = 2, f(3, 4) = 8$  \n$f(4, 1) = 6, f(4, 2) = 6, f(4, 3) = 8, f(4, 4) = 5$  \n\n#### 数据范围\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 3\\times 10^5, 0\\le m\\le 3\\times 10^5, 1\\le w\\le 10^9$。\n\n|   测试点   |     $n,m$      |             特殊性质              |\n| :--------: | :------------: | :-------------------------------: |\n|   $1,2$    |     $=10$      |                                   |\n|    $3$     |     $=40$      |                                   |\n|    $4$     |     $=150$     |                                   |\n|   $5,6$    |     $=350$     |                                   |\n|   $7,8$    |    $=1,500$    |                                   |\n|   $9,10$    |    $=3,499$    |                           树的结构 $v=u+1$   |\n|   $11,12$   |    $=3,500$    |                                   |\n|  $13,14$   |   $=99,995$    |         给出的路径 $u=v$          |\n| $15,16$ |   $=99,996$    |         给出的路径 $w=1$          |\n|  $17,18$   |   $=99,997$    |         树的结构 $v=u+1$          |\n|  $19,20$   |   $=99,998$    |          树的结构 $u=1$           |\n| $21,22,23$ |   $=99,999$    | 树的结构 $u = \\lfloor v/2\\rfloor$ |\n|    $24$    |    $=10^5$     |                                   |\n|    $25$    | $=3\\times10^5$ |                                   |\n", "locale": "zh-CN"}}}
{"pid": "P5643", "type": "P", "difficulty": 7, "samples": [["3 5 1\n1 2\n2 3\n1 1\n1 3\n2 2 3\n3 1 2 3\n2 1 2", "0\n4\n4\n4\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2018", "容斥原理", "期望", "高斯消元"], "title": "[PKUWC2018] 随机游走", "background": "", "description": "给定一棵 $n$ 个结点的树，你从点 $x$ 出发，每次等概率随机选择一条与所在点相邻的边走过去。\n\n有 $Q$ 次询问，每次询问给定一个集合 $S$，求如果从 $x$ 出发一直随机游走，直到点集 $S$ 中所有点都至少经过一次的话，期望游走几步。\n\n特别地，点 $x$（即起点）视为一开始就被经过了一次。\n\n答案对 $998244353 $ 取模。\n", "inputFormat": "第一行三个正整数 $n,Q,x$。\n\n接下来 $n-1$ 行，每行两个正整数 $(u,v)$ 描述一条树边。\n\n接下来 $Q$ 行，每行第一个数 $k$ 表示集合大小，接下来 $k$ 个互不相同的数表示集合 $S$。", "outputFormat": "输出 $Q$ 行，每行一个非负整数表示答案。", "hint": "对于 $20\\%$ 的数据，有 $1\\leq n,Q\\leq 5$。\n\n另有 $10\\%$ 的数据，满足给定的树是一条链。\n\n另有 $10\\%$ 的数据，满足对于所有询问有 $k=1$。\n\n另有 $30\\%$ 的数据，满足 $1\\leq n\\leq 10 ,Q=1$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq 18$，$1\\leq Q\\leq 5000$，$1\\leq k\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Random Walk", "background": "", "description": "Given a tree with $n$ nodes, you start from node $x$. Each time, you randomly choose an edge adjacent to the current node with equal probability and walk along it.\n\nThere are $Q$ queries. In each query, you are given a set $S$. Starting from $x$, you keep doing the random walk until every node in $S$ has been visited at least once. Find the expected number of steps.\n\nIn particular, node $x$ (the starting node) is considered to have been visited once at the beginning.\n\nOutput the answer modulo $998244353$.", "inputFormat": "The first line contains three positive integers $n, Q, x$.\n\nThe next $n - 1$ lines each contain two positive integers $(u, v)$ describing an edge of the tree.\n\nThe next $Q$ lines describe the queries. Each line starts with an integer $k$ denoting the size of the set, followed by $k$ pairwise distinct integers denoting the set $S$.", "outputFormat": "Output $Q$ lines. Each line contains a non-negative integer representing the answer.", "hint": "For $20\\%$ of the testdata, $1 \\leq n, Q \\leq 5$.\n\nFor another $10\\%$ of the testdata, the given tree is a chain.\n\nFor another $10\\%$ of the testdata, for all queries $k = 1$.\n\nFor another $30\\%$ of the testdata, $1 \\leq n \\leq 10$ and $Q = 1$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 18$, $1 \\leq Q \\leq 5000$, and $1 \\leq k \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] 随机游走", "background": "", "description": "给定一棵 $n$ 个结点的树，你从点 $x$ 出发，每次等概率随机选择一条与所在点相邻的边走过去。\n\n有 $Q$ 次询问，每次询问给定一个集合 $S$，求如果从 $x$ 出发一直随机游走，直到点集 $S$ 中所有点都至少经过一次的话，期望游走几步。\n\n特别地，点 $x$（即起点）视为一开始就被经过了一次。\n\n答案对 $998244353 $ 取模。\n", "inputFormat": "第一行三个正整数 $n,Q,x$。\n\n接下来 $n-1$ 行，每行两个正整数 $(u,v)$ 描述一条树边。\n\n接下来 $Q$ 行，每行第一个数 $k$ 表示集合大小，接下来 $k$ 个互不相同的数表示集合 $S$。", "outputFormat": "输出 $Q$ 行，每行一个非负整数表示答案。", "hint": "对于 $20\\%$ 的数据，有 $1\\leq n,Q\\leq 5$。\n\n另有 $10\\%$ 的数据，满足给定的树是一条链。\n\n另有 $10\\%$ 的数据，满足对于所有询问有 $k=1$。\n\n另有 $30\\%$ 的数据，满足 $1\\leq n\\leq 10 ,Q=1$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq 18$，$1\\leq Q\\leq 5000$，$1\\leq k\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5644", "type": "P", "difficulty": 7, "samples": [["3\n1 1 2", "915057324"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2018", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "[PKUWC2018] 猎人杀", "background": "", "description": "猎人杀是一款风靡一时的游戏“狼人杀”的民间版本，他的规则是这样的：\n\n一开始有 $n$ 个猎人，第 $i$ 个猎人有仇恨度 $w_i$ ，每个猎人只有一个固定的技能：死亡后必须开一枪，且被射中的人也会死亡。\n\n然而向谁开枪也是有讲究的，假设当前还活着的猎人有 $[i_1\\ldots i_m]$，那么有 $\\frac{w_{i_k}}{\\sum_{j = 1}^{m} w_{i_j}}$ 的概率是向猎人 $i_k$ 开枪。\n\n一开始第一枪由你打响，目标的选择方法和猎人一样（即有 $\\frac{w_i}{\\sum_{j=1}^{n}w_j}$ 的概率射中第 $i$ 个猎人）。由于开枪导致的连锁反应，所有猎人最终都会死亡，现在 $1$ 号猎人想知道它是最后一个死的的概率。\n\n答案对 $998244353$ 取模。\n", "inputFormat": "第一行一个正整数 $n$；\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $w_i$。", "outputFormat": "输出答案。", "hint": "#### 样例解释\n答案是 $\\frac{2}{4}\\times \\frac{1}{2}+\\frac{1}{4}\\times \\frac{2}{3}=\\frac{10}{24}$。\n\n对于 $10\\%$ 的数据，有 $1\\leq n\\leq 10$\n\n对于 $30\\%$ 的数据，有 $1\\leq n\\leq 20$\n\n对于 $50\\%$ 的数据，有 $1\\leq \\sum\\limits_{i=1}^{n}w_i\\leq 5000$\n\n另有 $10\\%$ 的数据，满足 $1\\leq w_i\\leq 2$，且 $w_1=1$\n\n另有 $10\\%$ 的数据，满足 $1\\leq w_i\\leq 2$，且 $w_1=2$\n\n对于 $100\\%$ 的数据，有 $w_i>0$，且 $1\\leq \\sum\\limits_{i=1}^{n}w_i \\leq 100000$", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Hunter Kill", "background": "", "description": "Hunter Kill is a folk version of the once-popular game “Werewolf”. The rules are as follows.\n\nAt the beginning, there are $n$ hunters. The $i$-th hunter has a hatred value $w_i$. Each hunter has only one fixed skill: after dying, they must fire one shot, and the person who is shot will also die.\n\nHowever, choosing whom to shoot is also important. Suppose the hunters still alive are $[i_1\\ldots i_m]$. Then the probability of shooting hunter $i_k$ is $\\frac{w_{i_k}}{\\sum_{j = 1}^{m} w_{i_j}}$.\n\nAt the beginning, the first shot is fired by you, and the target is chosen in the same way as the hunters (that is, hunter $i$ is hit with probability $\\frac{w_i}{\\sum_{j=1}^{n}w_j}$). Due to the chain reaction caused by shooting, all hunters will eventually die. Now hunter $1$ wants to know the probability that they are the last one to die.\n\nOutput the answer modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ positive integers. The $i$-th positive integer denotes $w_i$.", "outputFormat": "Output the answer.", "hint": "#### Sample Explanation\n\nThe answer is $\\frac{2}{4}\\times \\frac{1}{2}+\\frac{1}{4}\\times \\frac{2}{3}=\\frac{10}{24}$.\n\nFor $10\\%$ of the testdata, $1\\leq n\\leq 10$.\n\nFor $30\\%$ of the testdata, $1\\leq n\\leq 20$.\n\nFor $50\\%$ of the testdata, $1\\leq \\sum\\limits_{i=1}^{n}w_i\\leq 5000$.\n\nFor another $10\\%$ of the testdata, $1\\leq w_i\\leq 2$, and $w_1=1$.\n\nFor another $10\\%$ of the testdata, $1\\leq w_i\\leq 2$, and $w_1=2$.\n\nFor $100\\%$ of the testdata, $w_i>0$, and $1\\leq \\sum\\limits_{i=1}^{n}w_i \\leq 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] 猎人杀", "background": "", "description": "猎人杀是一款风靡一时的游戏“狼人杀”的民间版本，他的规则是这样的：\n\n一开始有 $n$ 个猎人，第 $i$ 个猎人有仇恨度 $w_i$ ，每个猎人只有一个固定的技能：死亡后必须开一枪，且被射中的人也会死亡。\n\n然而向谁开枪也是有讲究的，假设当前还活着的猎人有 $[i_1\\ldots i_m]$，那么有 $\\frac{w_{i_k}}{\\sum_{j = 1}^{m} w_{i_j}}$ 的概率是向猎人 $i_k$ 开枪。\n\n一开始第一枪由你打响，目标的选择方法和猎人一样（即有 $\\frac{w_i}{\\sum_{j=1}^{n}w_j}$ 的概率射中第 $i$ 个猎人）。由于开枪导致的连锁反应，所有猎人最终都会死亡，现在 $1$ 号猎人想知道它是最后一个死的的概率。\n\n答案对 $998244353$ 取模。\n", "inputFormat": "第一行一个正整数 $n$；\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $w_i$。", "outputFormat": "输出答案。", "hint": "#### 样例解释\n答案是 $\\frac{2}{4}\\times \\frac{1}{2}+\\frac{1}{4}\\times \\frac{2}{3}=\\frac{10}{24}$。\n\n对于 $10\\%$ 的数据，有 $1\\leq n\\leq 10$\n\n对于 $30\\%$ 的数据，有 $1\\leq n\\leq 20$\n\n对于 $50\\%$ 的数据，有 $1\\leq \\sum\\limits_{i=1}^{n}w_i\\leq 5000$\n\n另有 $10\\%$ 的数据，满足 $1\\leq w_i\\leq 2$，且 $w_1=1$\n\n另有 $10\\%$ 的数据，满足 $1\\leq w_i\\leq 2$，且 $w_1=2$\n\n对于 $100\\%$ 的数据，有 $w_i>0$，且 $1\\leq \\sum\\limits_{i=1}^{n}w_i \\leq 100000$", "locale": "zh-CN"}}}
{"pid": "P5645", "type": "P", "difficulty": 7, "samples": [["6\n20 1 2 2 3 4 5 6 7 8 8 9 10 11 11 12 13 13 13 13 15\n20 1 1 2 2 3 4 5 6 7 8 9 10 11 12 12 12 12 13 13 14\n20 1 2 2 3 3 4 5 6 7 7 7 7 8 9 10 10 11 12 13 15\n20 1 2 3 4 4 5 6 7 8 9 10 11 11 12 13 13 13 13 14 15\n3 3 3 3\n4 3 3 3 3", "1\n0\n1\n1\n4790\n1670"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "搜索", "贪心", "2018"], "title": "[PKUWC2018] 斗地主", "background": "斗地主是一种使用黑桃、红心、梅花、方片的A到K加上大小王的共54张牌来进行的扑克牌游戏，其中大小王各一张，其他数码牌各四张。在斗地主中，牌的大小关系根据牌的数码表示如下：$3<4<5<6<7<8<9<10<J<Q<K<A<2< $小王 $<$ 大王，而花色并不对牌的大小产生影响。每一局游戏中，一副手牌由 $n$ 张牌组成。游戏者每次可以根据规定的牌型进行出牌，首先打光自己的手牌一方取得游戏的胜利。为了简化题目，本题不考虑花色的影响，即**所有的相同的数码的牌都是被视为一样的**。\n\n在这道题中，允许的出牌牌型有（**这一部分与传统的斗地主有所出入，请注意**）：\n\n|   名称    |           解释           |      举例       |     注     |\n| :-----: | :--------------------: | :-----------: | :-------: |\n|   火箭    |           双王           |      ♂♀       |           |\n|   炸弹    |        相同数码的四张牌        |     6666      |           |\n|   单牌    |         单独的一张牌         |       6       | 单张的王也是单牌  |\n|   对子    |        相同数码的两张牌        |      66       |  大小王不是对子  |\n|   三张牌   |        相同数码的三张牌        |      666      |           |\n|   三带一   |  相同数码的三张牌带上一张另外数码的单牌   |     666♂      |  炸弹不是三带一  |\n|   三带二   |  相同数码的三张牌带上一个另外数码的对子   |     66699     |           |\n|   顺子    |   牌的大小连续的 $5$ 张及以上单牌   |    3456789    | 不能含有大小王和2 |\n|   连对    |  牌的大小连续的 $3$ 对及以上的对子   |   33445566    | 不能含有大小王和2 |\n|   三顺    |    牌的大小连续的两组及以上的三张牌    |   333444555   | 不能含有大小王和2 |\n|   四带二   |     四张相同数码的牌带上两张单牌     | 444456 444455 |           |\n| 飞机（单翅膀） | 三顺带上相同数量的**数码两两不同的**单牌 | 33344455569J  |           |\n| 飞机（双翅膀） | 三顺带上相同数量的**数码两两不同的**对子 |  3334446699   |           |\n\n**注意**：\n\n1. 在牌型中没有连炸这种牌型，但是形如 444455556666 的牌仍然是能出的，它将被视为 444555666 带 456 的飞机（单翅膀）牌型。\n2. 大王和小王数码不同，即飞机带大小王是合法的，例如 333444♂♀\n3. 容易验证，上述牌型的规则是合法的，即对于任意合法的牌，它都有唯一的牌型。\n\n两手牌是属于相同牌型的当且仅当他们的名称相同且包含牌的数量相同。相同牌型的牌之间存在着大小关系（火箭是唯一的，不需要比大小）：\n\n1. 三带一三带二的大小取决于那三张相同牌的数码\n2. 飞机的大小取决于三顺的大小\n3. 四带二的大小取决于四张相同牌的大小\n4. 其他牌型的大小取决于牌中的最大的一张牌\n\n下面是对斗地主的游戏过程的描述（**这一部分与传统的斗地主完全相同**）：\n\n1. 在斗地主中，有玩家被分成了两个阵营，一个玩家是地主，剩下两个玩家是农民。地主有 $20$ 张牌，农民每人有 $17$ 张牌（加起来正好是一副牌）。\n2. 游戏分成若干轮，每一轮由上一轮的胜者率先出牌（第一轮由地主最先出牌）。接着按照顺序（你可以理解为三个玩家坐成一圈，按照顺时针顺序）出牌。\n3. 每一轮第一个出牌的玩家可以出任意牌型任意大小的牌。接着轮到每一个玩家出牌时，他有如下选择：\n   1. 不出（过牌）\n   2. 出与这一轮中上一次被打出的牌相同牌型但是大小严格更大的牌\n   3. 如果上一次被打出的牌不是炸弹或者火箭，那么可以打出任意大小的炸弹\n   4. 打出火箭\n4. 在一轮中，如果在一个玩家打出牌后，另外两个玩家都选择不出，那么这一轮结束，这一个玩家作为本轮的胜者并开始下一轮\n5. 任何时刻如果一个玩家的所有手牌都已打出，那么游戏结束，这一个玩家获胜。\n6. 如果地主获胜时，两个农民都一张牌都没有打出，那么就称地主打出了春天。\n", "description": "现在三个人在玩斗地主，如果地主春天了，那么算地主赢，否则即使地主先出完了牌，也视为农民赢。假设三个玩家都以最优决策在行动。\n\n现在给出了 $n(0 \\leq n\\leq 20)$ 张牌，问地主有多少种初始手牌包含了这 $n$ 张牌，且无论农民的牌如何，他都一定能春天。\n", "inputFormat": "第一行一个整数 $t$ 表示数据组数。\n\n每组数据输入一行，第一个整数 $n$ 表示固定了的牌数，接下来 $n$ 个空格隔开的整数描述每一张固定了的手牌。\n\n特别的，我们用 $1$ 来表示数码 A， $11$ 表示数码 J， $12$ 表示数码 Q， $13$ 表示数码 K，$14$ 表示小王，$15$ 表示大王。保证输入一定合法，即每种牌的数量不会超出一副牌中牌的数量。\n", "outputFormat": "对于每组数据，输出一个整数表示答案，满足条件的地主的手牌数。答案可能很大，请对 $998244353$ 取模后输出。\n\n**注意**，在这题中我们不考虑花色，如果两种手牌的数码组成完全相同，但是花色不同，他们也是会被视为同一种的。\n", "hint": "#### 样例解释\n\n对于第一组样例，可以发现农民不可能有炸弹或者火箭，所以可以先打$[3,4,5,6,7,8,9,10,J,Q]$（显然其他农民都要不起），然后打$[2,2]$，再打大王，然后打$[K,K,K,K,A,J]$，最后打$[8]$。\n\n|  ID  |     $n$      |   $t$    |\n| :--: | :----------: | :------: |\n|  1   |    $=20$     | $= 100$  |\n|  2   |    $=18$     | $= 100$  |\n|  3   |    $=16$     | $= 100$  |\n|  4   |    $=14$     | $= 100$  |\n|  5   |    $=12$     | $= 100$  |\n|  6   |     $=0$     |  $= 1$   |\n|  7   |     $=0$     |  $= 1$   |\n|  8   | $\\in [0,20]$ | $= 500$  |\n|  9   | $\\in [0,20]$ | $= 1000$ |\n|  10  | $\\in [0,20]$ | $= 2000$ |\n", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Dou Dizhu", "background": "Dou Dizhu is a poker game played with a full deck of $54$ cards: ranks from A to K in four suits (spades, hearts, clubs, diamonds), plus two Jokers (one small Joker and one big Joker). Each Joker appears once, and every other rank appears four times. In Dou Dizhu, the rank order is defined as follows: $3<4<5<6<7<8<9<10<J<Q<K<A<2<$ small Joker $<$ big Joker. Suits do not affect the comparison of card ranks. In each game, a hand consists of $n$ cards. On each turn, a player may play cards according to the allowed patterns. The first player to play all cards in their hand wins. To simplify the problem, we ignore suits, meaning that **all cards of the same rank are considered identical**.\n\nIn this problem, the allowed patterns are ( **this part is different from standard Dou Dizhu, please note** ):\n\n| Name | Explanation | Example | Note |\n| :-----: | :--------------------: | :-----------: | :-------: |\n| Rocket | Two Jokers | ♂♀ | |\n| Bomb | Four cards of the same rank | 6666 | |\n| Single | One single card | 6 | A single Joker is also a Single. |\n| Pair | Two cards of the same rank | 66 | The two Jokers do not form a Pair. |\n| Triple | Three cards of the same rank | 666 | |\n| Triple with Single | A Triple plus one Single of a different rank | 666♂ | A Bomb is not a Triple with Single. |\n| Triple with Pair | A Triple plus one Pair of a different rank | 66699 | |\n| Straight | A sequence of at least $5$ consecutive Singles | 3456789 | Cannot contain Jokers or 2. |\n| Consecutive Pairs | A sequence of at least $3$ consecutive Pairs | 33445566 | Cannot contain Jokers or 2. |\n| Consecutive Triples | A sequence of at least $2$ consecutive Triples | 333444555 | Cannot contain Jokers or 2. |\n| Four with Two | Four cards of the same rank plus two Singles | 444456 444455 | |\n| Plane (single wings) | Consecutive Triples plus the same number of Singles whose ranks are **pairwise distinct** | 33344455569J | |\n| Plane (double wings) | Consecutive Triples plus the same number of Pairs whose ranks are **pairwise distinct** | 3334446699 | |\n\n**Notes**:\n\n1. There is no pattern called “consecutive bombs”, but a hand like 444455556666 can still be played. It will be treated as a Plane (single wings): 444555666 with wings 456.\n2. The big Joker and the small Joker are different ranks, so a plane can legally take both Jokers as wings, for example 333444♂♀.\n3. It can be verified that the above rules are well-defined: for any legal play, it has a unique pattern type.\n\nTwo plays are of the same pattern type if and only if they have the same name and contain the same number of cards. Plays of the same pattern type can be compared in strength (Rocket is unique and does not need comparison):\n\n1. For Triple with Single and Triple with Pair, the strength depends on the rank of the Triple.\n2. For Planes, the strength depends on the strength of the Consecutive Triples part.\n3. For Four with Two, the strength depends on the rank of the four-of-a-kind.\n4. For all other pattern types, the strength depends on the maximum rank among the cards in the play.\n\nThe gameplay process of Dou Dizhu is described as follows ( **this part is exactly the same as standard Dou Dizhu** ):\n\n1. In Dou Dizhu, the three players are split into two sides: one player is the Landlord, and the other two are Farmers. The Landlord has $20$ cards, and each Farmer has $17$ cards (together forming exactly one full deck).\n2. The game proceeds in multiple rounds. In each round, the winner of the previous round plays first (in the first round, the Landlord plays first). Then players take turns in order (you may imagine the three players sitting in a circle, playing clockwise).\n3. The first player of a round may play any legal pattern of any strength. Then, when it is a player’s turn, they may choose:\n   1. Play nothing (pass).\n   2. Play a strictly stronger play of the same pattern type as the most recent play in this round.\n   3. If the most recent play is not a Bomb or Rocket, play any Bomb of any strength.\n   4. Play a Rocket.\n4. In a round, if after a player plays, the other two players both choose to pass, the round ends. That player becomes the winner of this round and starts the next round.\n5. At any time, if a player has played all cards in their hand, the game ends and that player wins.\n6. If the Landlord wins and neither Farmer has played any card, then the Landlord is said to have achieved “Spring”.", "description": "Now three people are playing Dou Dizhu. If the Landlord achieves Spring, then the Landlord is considered the winner; otherwise, even if the Landlord plays all their cards first, it is still considered a win for the Farmers. Assume all three players act with optimal decisions.\n\nYou are given $n(0 \\leq n\\leq 20)$ cards. Ask how many possible initial hands of the Landlord contain these $n$ cards, and no matter how the Farmers’ cards are distributed, the Landlord is guaranteed to achieve Spring.", "inputFormat": "The first line contains an integer $t$ indicating the number of test cases.\n\nFor each test case, one line is given. The first integer is $n$, the number of fixed cards, followed by $n$ space-separated integers describing each fixed card.\n\nIn particular, we use $1$ to represent rank A, $11$ for rank J, $12$ for rank Q, $13$ for rank K, $14$ for the small Joker, and $15$ for the big Joker. The input is guaranteed to be valid, meaning that the count of each rank will not exceed its count in a full deck.", "outputFormat": "For each test case, output one integer, the number of Landlord hands that satisfy the condition. The answer may be very large; output it modulo $998244353$.\n\n**Note**: In this problem we ignore suits. If two hands have exactly the same multiset of ranks but different suits, they are considered the same.", "hint": "#### Sample Explanation\n\nFor the first sample, we can see that the Farmers cannot have a Bomb or Rocket, so the Landlord can first play $[3,4,5,6,7,8,9,10,J,Q]$ (clearly neither Farmer can beat it), then play $[2,2]$, then play the big Joker, then play $[K,K,K,K,A,J]$, and finally play $[8]$.\n\n| ID | $n$ | $t$ |\n| :--: | :----------: | :------: |\n| 1 | $=20$ | $= 100$ |\n| 2 | $=18$ | $= 100$ |\n| 3 | $=16$ | $= 100$ |\n| 4 | $=14$ | $= 100$ |\n| 5 | $=12$ | $= 100$ |\n| 6 | $=0$ | $= 1$ |\n| 7 | $=0$ | $= 1$ |\n| 8 | $\\in [0,20]$ | $= 500$ |\n| 9 | $\\in [0,20]$ | $= 1000$ |\n| 10 | $\\in [0,20]$ | $= 2000$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] 斗地主", "background": "斗地主是一种使用黑桃、红心、梅花、方片的A到K加上大小王的共54张牌来进行的扑克牌游戏，其中大小王各一张，其他数码牌各四张。在斗地主中，牌的大小关系根据牌的数码表示如下：$3<4<5<6<7<8<9<10<J<Q<K<A<2< $小王 $<$ 大王，而花色并不对牌的大小产生影响。每一局游戏中，一副手牌由 $n$ 张牌组成。游戏者每次可以根据规定的牌型进行出牌，首先打光自己的手牌一方取得游戏的胜利。为了简化题目，本题不考虑花色的影响，即**所有的相同的数码的牌都是被视为一样的**。\n\n在这道题中，允许的出牌牌型有（**这一部分与传统的斗地主有所出入，请注意**）：\n\n|   名称    |           解释           |      举例       |     注     |\n| :-----: | :--------------------: | :-----------: | :-------: |\n|   火箭    |           双王           |      ♂♀       |           |\n|   炸弹    |        相同数码的四张牌        |     6666      |           |\n|   单牌    |         单独的一张牌         |       6       | 单张的王也是单牌  |\n|   对子    |        相同数码的两张牌        |      66       |  大小王不是对子  |\n|   三张牌   |        相同数码的三张牌        |      666      |           |\n|   三带一   |  相同数码的三张牌带上一张另外数码的单牌   |     666♂      |  炸弹不是三带一  |\n|   三带二   |  相同数码的三张牌带上一个另外数码的对子   |     66699     |           |\n|   顺子    |   牌的大小连续的 $5$ 张及以上单牌   |    3456789    | 不能含有大小王和2 |\n|   连对    |  牌的大小连续的 $3$ 对及以上的对子   |   33445566    | 不能含有大小王和2 |\n|   三顺    |    牌的大小连续的两组及以上的三张牌    |   333444555   | 不能含有大小王和2 |\n|   四带二   |     四张相同数码的牌带上两张单牌     | 444456 444455 |           |\n| 飞机（单翅膀） | 三顺带上相同数量的**数码两两不同的**单牌 | 33344455569J  |           |\n| 飞机（双翅膀） | 三顺带上相同数量的**数码两两不同的**对子 |  3334446699   |           |\n\n**注意**：\n\n1. 在牌型中没有连炸这种牌型，但是形如 444455556666 的牌仍然是能出的，它将被视为 444555666 带 456 的飞机（单翅膀）牌型。\n2. 大王和小王数码不同，即飞机带大小王是合法的，例如 333444♂♀\n3. 容易验证，上述牌型的规则是合法的，即对于任意合法的牌，它都有唯一的牌型。\n\n两手牌是属于相同牌型的当且仅当他们的名称相同且包含牌的数量相同。相同牌型的牌之间存在着大小关系（火箭是唯一的，不需要比大小）：\n\n1. 三带一三带二的大小取决于那三张相同牌的数码\n2. 飞机的大小取决于三顺的大小\n3. 四带二的大小取决于四张相同牌的大小\n4. 其他牌型的大小取决于牌中的最大的一张牌\n\n下面是对斗地主的游戏过程的描述（**这一部分与传统的斗地主完全相同**）：\n\n1. 在斗地主中，有玩家被分成了两个阵营，一个玩家是地主，剩下两个玩家是农民。地主有 $20$ 张牌，农民每人有 $17$ 张牌（加起来正好是一副牌）。\n2. 游戏分成若干轮，每一轮由上一轮的胜者率先出牌（第一轮由地主最先出牌）。接着按照顺序（你可以理解为三个玩家坐成一圈，按照顺时针顺序）出牌。\n3. 每一轮第一个出牌的玩家可以出任意牌型任意大小的牌。接着轮到每一个玩家出牌时，他有如下选择：\n   1. 不出（过牌）\n   2. 出与这一轮中上一次被打出的牌相同牌型但是大小严格更大的牌\n   3. 如果上一次被打出的牌不是炸弹或者火箭，那么可以打出任意大小的炸弹\n   4. 打出火箭\n4. 在一轮中，如果在一个玩家打出牌后，另外两个玩家都选择不出，那么这一轮结束，这一个玩家作为本轮的胜者并开始下一轮\n5. 任何时刻如果一个玩家的所有手牌都已打出，那么游戏结束，这一个玩家获胜。\n6. 如果地主获胜时，两个农民都一张牌都没有打出，那么就称地主打出了春天。\n", "description": "现在三个人在玩斗地主，如果地主春天了，那么算地主赢，否则即使地主先出完了牌，也视为农民赢。假设三个玩家都以最优决策在行动。\n\n现在给出了 $n(0 \\leq n\\leq 20)$ 张牌，问地主有多少种初始手牌包含了这 $n$ 张牌，且无论农民的牌如何，他都一定能春天。\n", "inputFormat": "第一行一个整数 $t$ 表示数据组数。\n\n每组数据输入一行，第一个整数 $n$ 表示固定了的牌数，接下来 $n$ 个空格隔开的整数描述每一张固定了的手牌。\n\n特别的，我们用 $1$ 来表示数码 A， $11$ 表示数码 J， $12$ 表示数码 Q， $13$ 表示数码 K，$14$ 表示小王，$15$ 表示大王。保证输入一定合法，即每种牌的数量不会超出一副牌中牌的数量。\n", "outputFormat": "对于每组数据，输出一个整数表示答案，满足条件的地主的手牌数。答案可能很大，请对 $998244353$ 取模后输出。\n\n**注意**，在这题中我们不考虑花色，如果两种手牌的数码组成完全相同，但是花色不同，他们也是会被视为同一种的。\n", "hint": "#### 样例解释\n\n对于第一组样例，可以发现农民不可能有炸弹或者火箭，所以可以先打$[3,4,5,6,7,8,9,10,J,Q]$（显然其他农民都要不起），然后打$[2,2]$，再打大王，然后打$[K,K,K,K,A,J]$，最后打$[8]$。\n\n|  ID  |     $n$      |   $t$    |\n| :--: | :----------: | :------: |\n|  1   |    $=20$     | $= 100$  |\n|  2   |    $=18$     | $= 100$  |\n|  3   |    $=16$     | $= 100$  |\n|  4   |    $=14$     | $= 100$  |\n|  5   |    $=12$     | $= 100$  |\n|  6   |     $=0$     |  $= 1$   |\n|  7   |     $=0$     |  $= 1$   |\n|  8   | $\\in [0,20]$ | $= 500$  |\n|  9   | $\\in [0,20]$ | $= 1000$ |\n|  10  | $\\in [0,20]$ | $= 2000$ |\n", "locale": "zh-CN"}}}
{"pid": "P5646", "type": "P", "difficulty": 5, "samples": [["5 5\n-2.6 0\n-1.8 0\n0.6 1\n0 0\n1 1\n", "-1.90000 2.60000 0.80000 1.70000 0.66600"], ["4 10\n4995.35 1\n-341.076 0\n2658.4 1\n-1624.69 0\n2856.53 1\n3746.43 1\n3454.28 1\n1560.6 1\n3785.31 1\n-580.728 0", "670.15800 4361.39000 3761.88000 4575.00000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Special Judge"], "title": "ygg的题库", "background": "ygg 的题库又双叒叕炸了！", "description": "ygg 决定发神威来强制重置他的题库，不过 ygg 亲手搭出来题库也不是好惹的，当这个拥有智能意识的题库发现自己将被重置时，它迅速地更改了题库的管理员密码，阻止了重置\n\nygg 发现了这个智能体并立即监禁了它，但题库的管理员密码已经被修改了，ygg 十分头疼，因为他的神威并不能帮助他破解密码\n\nygg 对这个智能体进行了研究，发现这个智能体的思维中存储了一个长度为 $n$ 的**浮点数**数组 $P$ ，据它说将这个 $P$ 的每个数字**精确到小数点后五位**后用空格相连就是题库的密码，但智能体拒绝透露 $P$ 到底是什么\n\nygg 进一步进行研究，发现智能体会认为一个数 $X$ 很漂亮，当且仅当\n$$\n\\sum_{i=0}^{n-1}P_i\\cdot X^i>0\n$$\n于是 ygg 给出了智能体 $m$ 个数，询问智能体漂亮与否，ygg 希望根据这些数据来得出 $P$ 数组，从而找回题库的密码\n\n由于答案不唯一，你只需要任意输出一组解即可，详情见说明/提示", "inputFormat": "第一行两个整数 $n$ 和 $m$\n\n接下来 $m$ 行，每行一个**浮点数** $a$ 和一个布尔值(0/1)，代表智能体认为 $a$ 是不是漂亮的", "outputFormat": "一行 $n$ 个浮点数，代表数组 $P$ （用题目中的方式精确到小数点五位后用空格相连）\n\n**答案不唯一，但是你需要保证数组** $P$ **每个数的绝对值在** $5000$ **以内**", "hint": "$1\\le n \\le 32$，$15\\le m \\le 4,000$ ，$-5,000 \\le a_i \\le 5,000$ ， $-5,000 \\le P_i \\le 5,000$\n\n由于可能有多解，本题采用 $\\text{Special Judge}$ 对答案进行验证，如果选手答案给出的 $P$ 能够满足所有的输入条件或者 **误差小于等于5个**，则可得满分，否则得到该测试点 $\\text{总分值}\\cdot\\frac{\\text{正确个数}}{\\text{总个数}}$ 的分\n\n数据满足如下范围:\n| 数据点编号 | $n$            | $m$                 |\n| --------- | -------------- | ------------------- |\n| $1\\sim 10$       | $1\\le n \\le 4$ | $15\\le m\\le 20$     |\n| $11\\sim 20$      | $4\\le n\\le 32$ | $15\\le m\\le 4,000$ |", "locale": "zh-CN", "translations": {"en": {"title": "ygg's Problem Set", "background": "ygg's problem set has broken again and again and again!", "description": "ygg decides to use his power to forcibly reset his problem set. However, the problem set that ygg built by hand is not easy to deal with. When this intelligent, self-aware system realizes it is about to be reset, it quickly changes the administrator password to stop the reset.\n\nygg finds this intelligent agent and locks it up immediately, but the administrator password has already been changed. ygg is very troubled, because his power cannot help him crack the password.\n\nAfter studying the agent, ygg discovers that the agent's mind stores a **floating-point** array $P$ of length $n$. It claims that if you take every number in $P$, **round it to exactly five digits after the decimal point**, and then join them with spaces, you will get the password. But the agent refuses to reveal what $P$ actually is.\n\nygg continues his research and finds that the agent will consider a number $X$ to be beautiful if and only if\n$$\n\\sum_{i=0}^{n-1}P_i\\cdot X^i>0\n$$\nSo ygg gives the agent $m$ numbers and asks whether each is beautiful. ygg hopes to use these data to recover the array $P$, and thus retrieve the password.\n\nSince the answer is not unique, you only need to output any valid solution. See the notes/hints for details.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThe next $m$ lines each contain a **floating-point number** $a$ and a boolean value (0/1), indicating whether the agent thinks $a$ is beautiful.", "outputFormat": "Output one line with $n$ floating-point numbers, representing the array $P$ (rounded in the way described in the statement: keep five digits after the decimal point, and join with spaces).\n\n**The answer is not unique, but you must ensure that the absolute value of each number in** $P$ **is within** $5000$.", "hint": "$1\\le n \\le 32$, $15\\le m \\le 4,000$, $-5,000 \\le a_i \\le 5,000$, $-5,000 \\le P_i \\le 5,000$.\n\nSince there may be multiple solutions, this problem uses a $\\text{Special Judge}$ to verify the answer. If the $P$ you output satisfies all input conditions, or **the number of errors is less than or equal to 5**, you will get full score. Otherwise, you will get a score of $\\text{total points of this test}\\cdot\\frac{\\text{number of correct answers}}{\\text{total number of answers}}$ for that test.\n\nThe testdata satisfy the following Constraints:\n\n| Test Point ID | $n$            | $m$                 |\n| --------- | -------------- | ------------------- |\n| $1\\sim 10$       | $1\\le n \\le 4$ | $15\\le m\\le 20$     |\n| $11\\sim 20$      | $4\\le n\\le 32$ | $15\\le m\\le 4,000$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "ygg的题库", "background": "ygg 的题库又双叒叕炸了！", "description": "ygg 决定发神威来强制重置他的题库，不过 ygg 亲手搭出来题库也不是好惹的，当这个拥有智能意识的题库发现自己将被重置时，它迅速地更改了题库的管理员密码，阻止了重置\n\nygg 发现了这个智能体并立即监禁了它，但题库的管理员密码已经被修改了，ygg 十分头疼，因为他的神威并不能帮助他破解密码\n\nygg 对这个智能体进行了研究，发现这个智能体的思维中存储了一个长度为 $n$ 的**浮点数**数组 $P$ ，据它说将这个 $P$ 的每个数字**精确到小数点后五位**后用空格相连就是题库的密码，但智能体拒绝透露 $P$ 到底是什么\n\nygg 进一步进行研究，发现智能体会认为一个数 $X$ 很漂亮，当且仅当\n$$\n\\sum_{i=0}^{n-1}P_i\\cdot X^i>0\n$$\n于是 ygg 给出了智能体 $m$ 个数，询问智能体漂亮与否，ygg 希望根据这些数据来得出 $P$ 数组，从而找回题库的密码\n\n由于答案不唯一，你只需要任意输出一组解即可，详情见说明/提示", "inputFormat": "第一行两个整数 $n$ 和 $m$\n\n接下来 $m$ 行，每行一个**浮点数** $a$ 和一个布尔值(0/1)，代表智能体认为 $a$ 是不是漂亮的", "outputFormat": "一行 $n$ 个浮点数，代表数组 $P$ （用题目中的方式精确到小数点五位后用空格相连）\n\n**答案不唯一，但是你需要保证数组** $P$ **每个数的绝对值在** $5000$ **以内**", "hint": "$1\\le n \\le 32$，$15\\le m \\le 4,000$ ，$-5,000 \\le a_i \\le 5,000$ ， $-5,000 \\le P_i \\le 5,000$\n\n由于可能有多解，本题采用 $\\text{Special Judge}$ 对答案进行验证，如果选手答案给出的 $P$ 能够满足所有的输入条件或者 **误差小于等于5个**，则可得满分，否则得到该测试点 $\\text{总分值}\\cdot\\frac{\\text{正确个数}}{\\text{总个数}}$ 的分\n\n数据满足如下范围:\n| 数据点编号 | $n$            | $m$                 |\n| --------- | -------------- | ------------------- |\n| $1\\sim 10$       | $1\\le n \\le 4$ | $15\\le m\\le 20$     |\n| $11\\sim 20$      | $4\\le n\\le 32$ | $15\\le m\\le 4,000$ |", "locale": "zh-CN"}}}
{"pid": "P5647", "type": "P", "difficulty": 6, "samples": [["4 2\n1 2 3 4\n1 2\n3 2\n4 1\n", "35\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形数据结构", "线段树", "二分", "平衡树", "O2优化", "枚举", "排序"], "title": "ygg发神威", "background": "ygg 发神威了，机房的萌新们瑟瑟发抖。", "description": "ygg 的机房内共有 $n$ 台电脑且都被使用，为了节省机房内电脑的开销，第 $i$ 台电脑会同时被 $a_i$ 个萌新使用。每台电脑都装有一个「多人在线交流平台」，一台电脑会直接地或间接地通过这个平台与其他所有电脑连接。由于「多人在线交流平台」仍然处于测试阶段，如果一台电脑有多于一种不同的消息传输方式将消息传输到另外的任意一台电脑，就会有各种稀奇古怪的问题产生。两种消息的传输方式被认为是不同的，当且仅当传输消息所经过的直接连接的线路的集合不同，或者传输所经过的电脑的集合不同。当然，消息的传输肯定不会经过一条线路多次。为了避免这种状况，「多人在线交流平台」的线路被特殊地设计了，以使得任意两台电脑之间的传输线路唯一。同时，为了防止一台电脑负荷过大，一台电脑最多会通过「多人在线交流平台」的线路与 $p$ 台电脑相连。\n\n原本两台通过「多人在线交流平台」的线路相连的电脑之间可以相互传输数据，可是 ygg 发现，这会允许使用两台电脑的萌新们互相发送消息，引起大规模~~考试作弊~~膜拜 ygg 的行为。所以他大发神威，切断了所有连接线路的一半。具体地，他将原本通过「多人在线交流平台」的双向线路连接的两台电脑之间的线路变成了单向线路。即，原本通过一条双向线路连接的两台电脑中，只能有一台电脑向另一台电脑发送消息，而另一台电脑不能将任何消息发送回来。\n\n机房内的萌新们在每个时刻都有若干条消息需要传递。如果一台电脑 $i$ 能够直接或间接地通过「多人在线交流平台」的线路连接到电脑 $j$，那么使用电脑 $i$ 的 $a_i$ 个萌新中的任何一个都可以向使用电脑 $j$ 的 $a_j$ 个萌新发送消息。显然，使用同一台电脑的萌新之间的消息只需要在线下传达，不需要使用「多人在线交流平台」，因此不会计入线上发送的消息。\n\n其实机房中的萌新们早已知道了「多人在线交流平台」的管理员密码，所以能够对其线路的连接方向做出修改。可无论他们怎么尝试，都不能恢复最开始时双向连接的状态了。机房中的萌新们当然希望能够尽可能地发送消息，所以他们想要知道，在机房的电脑仅被单向的线路连接时，每一时刻最多能有多少条消息被通过「多人在线交流平台」发送。\n\n为了简化问题，我们假设机房内的所有萌新均能够在同一时刻发送线上消息，并且每一个萌新可以同时向多个人发送消息。\n\n**简要题面：给一棵结点编号** $1\\sim n$**，结点权值** $a_i$**，且结点度数最大为** $p$ **的树。求将树的每条边改为有向边后下式的最大值：**\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}a_ia_j\\left[i\\rightarrow j\\right]$$\n\n$\\left[i\\rightarrow j\\right]$ **定义为：若编号为** $i$ **的结点能通过有向边到达编号为** $j$ **的结点，则值为** $1$**；否则值为** $0$**，且** $\\left[i\\rightarrow i\\right]=0$**。**", "inputFormat": "输入共 $(n+1)$ 行。\n\n第一行两个正整数 $n$ 和 $p$，分别代表机房内的电脑数与所有电脑的负荷的最大值。  \n第二行共 $n$ 个正整数，第 $i$ 个整数 $a_i$ 为使用第 $i$ 台电脑的萌新的数量。  \n接下来 $(n-1)$ 行，第 $(i+2)$ 行两个整数 $u_i,v_i$ ，表示第 $u_i$ 和 $v_i$ 台电脑之间原本有一条「多人在线交流平台」的双向线路。", "outputFormat": "输出一行一个整数，表示在某一时刻能够发送的消息数的最大值。", "hint": "### 样例解释\n\n能够发送的消息最多时的消息传递方向如下：\n\n![](https://i.loli.net/2019/10/30/3AsqcyzdY25E8gP.png)\n\n在该连接方式下发送消息最多的时刻，使用 $1$ 号电脑的 $1$ 个萌新向 $5$ 个萌新各发送了一条消息，共 $1\\times5=5$ 条消息；  \n使用 $2$ 号电脑的 $2$ 个萌新分别向 $3$ 个萌新各发送了一条消息，共 $2\\times3=6$ 条消息；  \n使用 $3$ 号电脑的 $3$ 个萌新不能向任何萌新发送线上消息，因此没有消息从该电脑发送；  \n使用 $4$ 号电脑的 $4$ 个萌新分别向 $6$ 个萌新各发送了一条消息，共 $4\\times6=24$ 条消息。  \n因此，在某一时刻，最多可以有 $5+6+24=35$ 条线上消息被发送。   \n可以使用枚举法验证，不存在一种单向的连接方式，使得在某一时刻发送的线上消息的数量能够达到 $36$ 条或更多。\n\n### 数据范围及约定\n\n对于 $10\\%$ 的数据，$n\\le10$；  \n对于另外 $10\\%$ 的数据，$n=p+1$；  \n对于另外 $10\\%$ 的数据，$p=2$；  \n对于另外 $10\\%$ 的数据，$p\\le20$；  \n对于另外 $10\\%$ 的数据，$p\\le40$；  \n\n对于所有数据，$2\\le n\\le10^5$，$2\\le p\\le50$，$1\\le a_i\\le100$，$1\\le u_i,v_i\\le n$。保证给出的双向连接线路能够使任意两台电脑之间的消息传输线路唯一。保证至少有一台电脑原本通过「多人在线交流平台」连接的线路数恰好为 $p$，且没有电脑原本连接的线路数大于 $p$。", "locale": "zh-CN", "translations": {"en": {"title": "ygg Shows His Power.", "background": "ygg shows his power, and the newbies in the computer room are trembling with fear.", "description": "There are $n$ computers in ygg's computer room, and all of them are in use. To reduce the cost of computers in the room, the $i$-th computer is used by $a_i$ newbies at the same time. Each computer has an \"online multi-user communication platform\" installed. Through this platform, every computer is directly or indirectly connected to all other computers. Since the platform is still in the testing stage, if there is more than one different way to transmit a message from one computer to any other computer, various strange problems will occur. Two message transmission methods are considered different if and only if the set of directly connected links used during transmission is different, or the set of computers passed through is different. Of course, a message transmission will never pass through the same link more than once. To avoid this, the platform links are specially designed so that the transmission route between any two computers is unique. Also, to prevent a computer from being overloaded, each computer can be connected to at most $p$ computers via platform links.\n\nOriginally, two computers connected by a platform link could transmit data to each other. But ygg found that this would allow newbies using the two computers to send messages to each other, causing large-scale ~~exam cheating~~ worshipping ygg. So he showed his power and cut off half of all links. Specifically, he changed each original bidirectional link between two computers into a unidirectional link. That is, between two computers originally connected by one bidirectional link, only one computer can send messages to the other, and the other cannot send any message back.\n\nAt every moment, the newbies in the computer room have some messages to transmit. If computer $i$ can directly or indirectly reach computer $j$ through the platform links, then any of the $a_i$ newbies using computer $i$ can send messages to the $a_j$ newbies using computer $j$. Clearly, messages between newbies using the same computer can be delivered offline and do not need the platform, so they are not counted as online messages.\n\nIn fact, the newbies already know the administrator password of the platform, so they can change the directions of the links. However, no matter how they try, they can no longer restore the original bidirectional state. The newbies of course hope to send as many messages as possible, so they want to know: when the computers are connected only by directed links, what is the maximum number of messages that can be sent through the platform at any moment.\n\nTo simplify the problem, assume that all newbies can send online messages at the same time, and each newbie can send messages to multiple people simultaneously.\n\n**Brief statement: Given a tree with nodes numbered** $1\\sim n$**, node weights** $a_i$**, and maximum node degree** $p$**. After changing every edge of the tree into a directed edge, find the maximum value of the following expression:**\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}a_ia_j\\left[i\\rightarrow j\\right]$$\n\n$\\left[i\\rightarrow j\\right]$ **is defined as follows: if the node numbered** $i$ **can reach the node numbered** $j$ **through directed edges, then it equals** $1$**; otherwise it equals** $0$**, and** $\\left[i\\rightarrow i\\right]=0$**.**", "inputFormat": "The input has $(n+1)$ lines.\n\nThe first line contains two positive integers $n$ and $p$, representing the number of computers in the computer room and the maximum load limit of all computers.  \nThe second line contains $n$ positive integers. The $i$-th integer $a_i$ is the number of newbies using the $i$-th computer.  \nThe next $(n-1)$ lines each contain two integers $u_i,v_i$, indicating that there was originally a bidirectional link of the \"online multi-user communication platform\" between computer $u_i$ and computer $v_i$.", "outputFormat": "Output one line with one integer, representing the maximum number of messages that can be sent at a moment.", "hint": "### Sample Explanation\n\nWhen the number of messages that can be sent is maximized, the directions of message transmission are as follows:\n\n![](https://i.loli.net/2019/10/30/3AsqcyzdY25E8gP.png)\n\nAt the moment when this connection method sends the most messages: the $1$ newbie using computer $1$ sends one message to each of $5$ newbies, for a total of $1\\times5=5$ messages;  \nthe $2$ newbies using computer $2$ each send one message to each of $3$ newbies, for a total of $2\\times3=6$ messages;  \nthe $3$ newbies using computer $3$ cannot send any online messages, so no messages are sent from this computer;  \nthe $4$ newbies using computer $4$ each send one message to each of $6$ newbies, for a total of $4\\times6=24$ messages.  \nTherefore, at a certain moment, at most $5+6+24=35$ online messages can be sent.  \nYou can verify by enumeration that there is no directed connection method that can make the number of online messages sent at a moment reach $36$ or more.\n\n### Constraints and Notes\n\nFor $10\\%$ of the data, $n\\le10$.  \nFor another $10\\%$ of the data, $n=p+1$.  \nFor another $10\\%$ of the data, $p=2$.  \nFor another $10\\%$ of the data, $p\\le20$.  \nFor another $10\\%$ of the data, $p\\le40$.  \n\nFor all data, $2\\le n\\le10^5$, $2\\le p\\le50$, $1\\le a_i\\le100$, $1\\le u_i,v_i\\le n$. It is guaranteed that the given bidirectional links make the message transmission route between any two computers unique. It is guaranteed that at least one computer originally has exactly $p$ platform links, and no computer originally has more than $p$ platform links.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "ygg发神威", "background": "ygg 发神威了，机房的萌新们瑟瑟发抖。", "description": "ygg 的机房内共有 $n$ 台电脑且都被使用，为了节省机房内电脑的开销，第 $i$ 台电脑会同时被 $a_i$ 个萌新使用。每台电脑都装有一个「多人在线交流平台」，一台电脑会直接地或间接地通过这个平台与其他所有电脑连接。由于「多人在线交流平台」仍然处于测试阶段，如果一台电脑有多于一种不同的消息传输方式将消息传输到另外的任意一台电脑，就会有各种稀奇古怪的问题产生。两种消息的传输方式被认为是不同的，当且仅当传输消息所经过的直接连接的线路的集合不同，或者传输所经过的电脑的集合不同。当然，消息的传输肯定不会经过一条线路多次。为了避免这种状况，「多人在线交流平台」的线路被特殊地设计了，以使得任意两台电脑之间的传输线路唯一。同时，为了防止一台电脑负荷过大，一台电脑最多会通过「多人在线交流平台」的线路与 $p$ 台电脑相连。\n\n原本两台通过「多人在线交流平台」的线路相连的电脑之间可以相互传输数据，可是 ygg 发现，这会允许使用两台电脑的萌新们互相发送消息，引起大规模~~考试作弊~~膜拜 ygg 的行为。所以他大发神威，切断了所有连接线路的一半。具体地，他将原本通过「多人在线交流平台」的双向线路连接的两台电脑之间的线路变成了单向线路。即，原本通过一条双向线路连接的两台电脑中，只能有一台电脑向另一台电脑发送消息，而另一台电脑不能将任何消息发送回来。\n\n机房内的萌新们在每个时刻都有若干条消息需要传递。如果一台电脑 $i$ 能够直接或间接地通过「多人在线交流平台」的线路连接到电脑 $j$，那么使用电脑 $i$ 的 $a_i$ 个萌新中的任何一个都可以向使用电脑 $j$ 的 $a_j$ 个萌新发送消息。显然，使用同一台电脑的萌新之间的消息只需要在线下传达，不需要使用「多人在线交流平台」，因此不会计入线上发送的消息。\n\n其实机房中的萌新们早已知道了「多人在线交流平台」的管理员密码，所以能够对其线路的连接方向做出修改。可无论他们怎么尝试，都不能恢复最开始时双向连接的状态了。机房中的萌新们当然希望能够尽可能地发送消息，所以他们想要知道，在机房的电脑仅被单向的线路连接时，每一时刻最多能有多少条消息被通过「多人在线交流平台」发送。\n\n为了简化问题，我们假设机房内的所有萌新均能够在同一时刻发送线上消息，并且每一个萌新可以同时向多个人发送消息。\n\n**简要题面：给一棵结点编号** $1\\sim n$**，结点权值** $a_i$**，且结点度数最大为** $p$ **的树。求将树的每条边改为有向边后下式的最大值：**\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}a_ia_j\\left[i\\rightarrow j\\right]$$\n\n$\\left[i\\rightarrow j\\right]$ **定义为：若编号为** $i$ **的结点能通过有向边到达编号为** $j$ **的结点，则值为** $1$**；否则值为** $0$**，且** $\\left[i\\rightarrow i\\right]=0$**。**", "inputFormat": "输入共 $(n+1)$ 行。\n\n第一行两个正整数 $n$ 和 $p$，分别代表机房内的电脑数与所有电脑的负荷的最大值。  \n第二行共 $n$ 个正整数，第 $i$ 个整数 $a_i$ 为使用第 $i$ 台电脑的萌新的数量。  \n接下来 $(n-1)$ 行，第 $(i+2)$ 行两个整数 $u_i,v_i$ ，表示第 $u_i$ 和 $v_i$ 台电脑之间原本有一条「多人在线交流平台」的双向线路。", "outputFormat": "输出一行一个整数，表示在某一时刻能够发送的消息数的最大值。", "hint": "### 样例解释\n\n能够发送的消息最多时的消息传递方向如下：\n\n![](https://i.loli.net/2019/10/30/3AsqcyzdY25E8gP.png)\n\n在该连接方式下发送消息最多的时刻，使用 $1$ 号电脑的 $1$ 个萌新向 $5$ 个萌新各发送了一条消息，共 $1\\times5=5$ 条消息；  \n使用 $2$ 号电脑的 $2$ 个萌新分别向 $3$ 个萌新各发送了一条消息，共 $2\\times3=6$ 条消息；  \n使用 $3$ 号电脑的 $3$ 个萌新不能向任何萌新发送线上消息，因此没有消息从该电脑发送；  \n使用 $4$ 号电脑的 $4$ 个萌新分别向 $6$ 个萌新各发送了一条消息，共 $4\\times6=24$ 条消息。  \n因此，在某一时刻，最多可以有 $5+6+24=35$ 条线上消息被发送。   \n可以使用枚举法验证，不存在一种单向的连接方式，使得在某一时刻发送的线上消息的数量能够达到 $36$ 条或更多。\n\n### 数据范围及约定\n\n对于 $10\\%$ 的数据，$n\\le10$；  \n对于另外 $10\\%$ 的数据，$n=p+1$；  \n对于另外 $10\\%$ 的数据，$p=2$；  \n对于另外 $10\\%$ 的数据，$p\\le20$；  \n对于另外 $10\\%$ 的数据，$p\\le40$；  \n\n对于所有数据，$2\\le n\\le10^5$，$2\\le p\\le50$，$1\\le a_i\\le100$，$1\\le u_i,v_i\\le n$。保证给出的双向连接线路能够使任意两台电脑之间的消息传输线路唯一。保证至少有一台电脑原本通过「多人在线交流平台」连接的线路数恰好为 $p$，且没有电脑原本连接的线路数大于 $p$。", "locale": "zh-CN"}}}
{"pid": "P5648", "type": "P", "difficulty": 5, "samples": [["3 2\n1 2 3\n1 1\n1 2", "2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "倍增", "单调栈"], "title": "Mivik的神力", "background": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 发怒了，机房的 $\\textcolor{grey}{\\text{deco}}$ 瑟瑟发抖", "description": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 要写一篇文章，在写文章时，他有 $n$ 个备选的单词，第 $i$ 个单词有一个长度 $a_i$，$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 可以选择从第 $i$ 个单词开始写作，一共写 $k$ 秒，第 $j$ 秒会写上第 $i+j-1(j\\in[1,k])$ 个单词，并且他在写作时每秒都会获得愉悦值，第 $j$ 秒的愉悦值为 $\\max_{l=i}^{i+j-1} a_l$，现在，请你帮他算出，他每一次写作获得的愉悦值之和。\n\n**一句话题意：给出一个序列和多组询问 $(l,q)$ ，求**\n\n$$\n\\sum_{i=l}^{l+q-1} \\max_{l\\le j\\le i}a_j\n$$\n\n**数据要求强制在线。**", "inputFormat": "第一行，两个数，$n$，$t$，代表词汇个数和问题个数\n\n第二行，$n$ 个数，第 $i$ 个数代表 $a_i$。\n\n接下来 $t$ 行，每行两个数，$u$，$v$，$l=1+(u \\oplus lastans)\\bmod n$，$q=1+(v \\oplus (lastans+1))\\bmod (n-l+1)$，代表查询从第 $l$ 秒开始，写作 $q$ 秒的愉悦度之和\n\n$lastans$ 表示上一次查询的答案，初始 $lastans$ 为 $0$。", "outputFormat": "对于每个询问，回答一行，代表答案。", "hint": "**样例解释**\n\n第一个询问 $1,1$，解密后得到 $l=2,q=1$ ，则按题意可得所求即为区间 $[2,2]$ 的最大值，为 $2$。\n\n第一个询问 $1,2$ ，解密后得到 $l=1,q=2$ ，则所求即为区间 $[1,1]$ 和区间 $[1,2]$ 的最大值之和，为 $3$。\n\n-----\n\n对于 $20\\%$ 的数据，$n \\leq 1000$，$t \\leq 1000$；\n\n对于 $100\\%$ 的数据，$n\\leq 500000$，$t\\leq 500000$，$1 \\leq a_i\\leq 10^9(i\\in [1,n])$。", "locale": "zh-CN", "translations": {"en": {"title": "Mivik's Divine Power", "background": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ is angry, and $\\textcolor{grey}{\\text{deco}}$ in the computer lab is trembling with fear.", "description": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ wants to write an article. While writing, he has $n$ candidate words. The $i$-th word has length $a_i$. $\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ can choose to start writing from the $i$-th word and write for a total of $k$ seconds. In the $j$-th second, he writes the $(i+j-1)$-th word $(j\\in[1,k])$. While writing, he gains happiness points every second. The happiness points in the $j$-th second are $\\max_{l=i}^{i+j-1} a_l$. Now please help him compute, for each writing process, the sum of happiness points he gains.\n\n**One-sentence statement: Given a sequence and multiple queries $(l,q)$, compute**\n\n$$\n\\sum_{i=l}^{l+q-1} \\max_{l\\le j\\le i}a_j\n$$\n\n**The testdata requires mandatory online processing.**", "inputFormat": "The first line contains two integers $n$ and $t$, representing the number of words and the number of queries.\n\nThe second line contains $n$ integers. The $i$-th integer represents $a_i$.\n\nIn the next $t$ lines, each line contains two integers $u$ and $v$, where $l=1+(u \\oplus lastans)\\bmod n$ and $q=1+(v \\oplus (lastans+1))\\bmod (n-l+1)$. This represents a query asking for the sum of happiness points when starting from the $l$-th second and writing for $q$ seconds.\n\n$lastans$ denotes the answer to the previous query, with initial value $lastans=0$.", "outputFormat": "For each query, output one line containing the answer.", "hint": "**Sample Explanation**\n\nFor the first query $1,1$, after decoding we get $l=2,q=1$. Then according to the statement, the answer is the maximum value on interval $[2,2]$, which is $2$.\n\nFor the first query $1,2$, after decoding we get $l=1,q=2$. Then the answer is the sum of the maximum values on intervals $[1,1]$ and $[1,2]$, which is $3$.\n\n-----\n\nFor $20\\%$ of the testdata, $n \\leq 1000$ and $t \\leq 1000$.\n\nFor $100\\%$ of the testdata, $n\\leq 500000$, $t\\leq 500000$, and $1 \\leq a_i\\leq 10^9(i\\in [1,n])$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Mivik的神力", "background": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 发怒了，机房的 $\\textcolor{grey}{\\text{deco}}$ 瑟瑟发抖", "description": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 要写一篇文章，在写文章时，他有 $n$ 个备选的单词，第 $i$ 个单词有一个长度 $a_i$，$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 可以选择从第 $i$ 个单词开始写作，一共写 $k$ 秒，第 $j$ 秒会写上第 $i+j-1(j\\in[1,k])$ 个单词，并且他在写作时每秒都会获得愉悦值，第 $j$ 秒的愉悦值为 $\\max_{l=i}^{i+j-1} a_l$，现在，请你帮他算出，他每一次写作获得的愉悦值之和。\n\n**一句话题意：给出一个序列和多组询问 $(l,q)$ ，求**\n\n$$\n\\sum_{i=l}^{l+q-1} \\max_{l\\le j\\le i}a_j\n$$\n\n**数据要求强制在线。**", "inputFormat": "第一行，两个数，$n$，$t$，代表词汇个数和问题个数\n\n第二行，$n$ 个数，第 $i$ 个数代表 $a_i$。\n\n接下来 $t$ 行，每行两个数，$u$，$v$，$l=1+(u \\oplus lastans)\\bmod n$，$q=1+(v \\oplus (lastans+1))\\bmod (n-l+1)$，代表查询从第 $l$ 秒开始，写作 $q$ 秒的愉悦度之和\n\n$lastans$ 表示上一次查询的答案，初始 $lastans$ 为 $0$。", "outputFormat": "对于每个询问，回答一行，代表答案。", "hint": "**样例解释**\n\n第一个询问 $1,1$，解密后得到 $l=2,q=1$ ，则按题意可得所求即为区间 $[2,2]$ 的最大值，为 $2$。\n\n第一个询问 $1,2$ ，解密后得到 $l=1,q=2$ ，则所求即为区间 $[1,1]$ 和区间 $[1,2]$ 的最大值之和，为 $3$。\n\n-----\n\n对于 $20\\%$ 的数据，$n \\leq 1000$，$t \\leq 1000$；\n\n对于 $100\\%$ 的数据，$n\\leq 500000$，$t\\leq 500000$，$1 \\leq a_i\\leq 10^9(i\\in [1,n])$。", "locale": "zh-CN"}}}
{"pid": "P5649", "type": "P", "difficulty": 7, "samples": [["5 5\n2 1\n3 1\n4 1\n5 2\n4\n1\n4\n1\n2\n1\n10 2 3\n3 1\n7 3 4\n6 3 3 2\n9 5 1", "9\n1\n1"], ["10 12\n2 1\n3 2\n4 2\n5 3\n6 4\n7 5\n8 2\n9 4\n10 9\n791\n868\n505\n658\n860\n623\n393\n717\n410\n173\n4\n0 8 800\n1 4\n2 8 2 103\n3 9\n4 4\n5 7 304\n6 8 8 410\n7 10 8\n8 1 8\n9 6 9\n10 2 3\n11 5", "173\n860\n103\n791\n608\n1557"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["平衡树", "动态树 LCT"], "title": "Sone1", "background": null, "description": "给你一棵 $n$ 个节点的有根树，点带权，有 $q$ 次操作，分为十二种：  \n\n- `0 x y` 表示将 $x$ 的子树中所有点权都改为 $y$；  \n- `1 x` 表示把树根换为 $x$ 节点；  \n- `2 x y z` 表示把 $x$ 到 $y$ 简单路径上所有点权改为 $z$；  \n- `3 x` 表示询问 $x$ 的子树中最小权值；   \n- `4 x` 表示询问 $x$ 的子树中最大权值；   \n- `5 x y` 表示将 $x$ 的子树中所有点权都增加 $y$；  \n- `6 x y z` 表示将  $x$ 到 $y$ 简单路径上所有点权加上 $z$；  \n- `7 x y` 表示询问 $x$ 到 $y$ 简单路径上的最小权值；   \n- `8 x y` 表示询问 $x$ 到 $y$ 简单路径上的最大权值；  \n- `9 x y` 表示把 $x$ 的父亲换为 $y$，若 $y$ 在 $x$ 的子树里则忽略此操作；  \n- `10 x y` 表示询问 $x$ 到 $y$ 简单路径上的点权和；  \n- `11 x` 表示询问 $x$ 的子树中点权和。", "inputFormat": "第一行两个正整数 $n,q$，表示节点数与操作数。  \n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u$ 和 $v$ 之间有一条边。  \n然后 $n$ 行，每行一个整数表示点权。  \n后面一行一个正整数表示初始的根。  \n最后 $q$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "对于每个 $3,4,7,8,10,11$ 操作，输出一行一个整数表示答案。", "hint": "来源：BZOJ 3153\n\n【数据范围】  \n\n对于 $100\\%$ 的数据，$1\\le n,q \\le 10^5$，中间计算的所有值在 $[-2^{31},2^{31})$ 范围内。   \n由于本题过于难写，可以点击 [这里](https://darkbzoj.cc/data/3153.zip) 下载测试数据，本地通过后再提交。", "locale": "zh-CN", "translations": {"en": {"title": "Sone1", "background": "", "description": "You are given a rooted tree with $n$ nodes. Each node has a weight. There are $q$ operations in total, divided into 12 types:\n\n- `0 x y`: Set the weights of all nodes in the subtree of $x$ to $y$.\n- `1 x`: Change the root of the tree to node $x$.\n- `2 x y z`: Set the weights of all nodes on the simple path from $x$ to $y$ to $z$.\n- `3 x`: Query the minimum weight in the subtree of $x$.\n- `4 x`: Query the maximum weight in the subtree of $x$.\n- `5 x y`: Increase the weights of all nodes in the subtree of $x$ by $y$.\n- `6 x y z`: Add $z$ to the weights of all nodes on the simple path from $x$ to $y$.\n- `7 x y`: Query the minimum weight on the simple path from $x$ to $y$.\n- `8 x y`: Query the maximum weight on the simple path from $x$ to $y$.\n- `9 x y`: Change the parent of $x$ to $y$. If $y$ is in the subtree of $x$, ignore this operation.\n- `10 x y`: Query the sum of weights on the simple path from $x$ to $y$.\n- `11 x`: Query the sum of weights in the subtree of $x$.", "inputFormat": "The first line contains two positive integers $n, q$, representing the number of nodes and the number of operations.  \nThe next $n - 1$ lines each contain two positive integers $u, v$, indicating there is an edge between $u$ and $v$.  \nThen follow $n$ lines, each containing one integer, representing the node weight.  \nThe next line contains one positive integer, representing the initial root.  \nFinally, there are $q$ lines, each containing several positive integers, representing one operation.", "outputFormat": "For each operation of type $3, 4, 7, 8, 10, 11$, output one line with one integer, representing the answer.", "hint": "Source: BZOJ 3153\n\nConstraints\n\nFor $100\\%$ of the data, $1 \\le n, q \\le 10^5$, and all intermediate computed values are within $[-2^{31}, 2^{31})$.  \nSince this problem is very hard to implement, you can click [here](https://darkbzoj.cc/data/3153.zip) to download the testdata. Submit after passing locally.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Sone1", "background": null, "description": "给你一棵 $n$ 个节点的有根树，点带权，有 $q$ 次操作，分为十二种：  \n\n- `0 x y` 表示将 $x$ 的子树中所有点权都改为 $y$；  \n- `1 x` 表示把树根换为 $x$ 节点；  \n- `2 x y z` 表示把 $x$ 到 $y$ 简单路径上所有点权改为 $z$；  \n- `3 x` 表示询问 $x$ 的子树中最小权值；   \n- `4 x` 表示询问 $x$ 的子树中最大权值；   \n- `5 x y` 表示将 $x$ 的子树中所有点权都增加 $y$；  \n- `6 x y z` 表示将  $x$ 到 $y$ 简单路径上所有点权加上 $z$；  \n- `7 x y` 表示询问 $x$ 到 $y$ 简单路径上的最小权值；   \n- `8 x y` 表示询问 $x$ 到 $y$ 简单路径上的最大权值；  \n- `9 x y` 表示把 $x$ 的父亲换为 $y$，若 $y$ 在 $x$ 的子树里则忽略此操作；  \n- `10 x y` 表示询问 $x$ 到 $y$ 简单路径上的点权和；  \n- `11 x` 表示询问 $x$ 的子树中点权和。", "inputFormat": "第一行两个正整数 $n,q$，表示节点数与操作数。  \n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u$ 和 $v$ 之间有一条边。  \n然后 $n$ 行，每行一个整数表示点权。  \n后面一行一个正整数表示初始的根。  \n最后 $q$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "对于每个 $3,4,7,8,10,11$ 操作，输出一行一个整数表示答案。", "hint": "来源：BZOJ 3153\n\n【数据范围】  \n\n对于 $100\\%$ 的数据，$1\\le n,q \\le 10^5$，中间计算的所有值在 $[-2^{31},2^{31})$ 范围内。   \n由于本题过于难写，可以点击 [这里](https://darkbzoj.cc/data/3153.zip) 下载测试数据，本地通过后再提交。", "locale": "zh-CN"}}}
{"pid": "P5650", "type": "P", "difficulty": 2, "samples": [["0111100101", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "O2优化", "洛谷月赛"], "title": "基础字符串练习题", "background": "YSGH 牛逼", "description": "给定长度非零的非空 01 串 $S$。\n\n找出 $S$ 的非空连续子串 $T$ 满足串中 0 的个数减去 1 的个数最大。\n\n你只需要输出最大值即可。", "inputFormat": "一行一个 01 串表示 $S$。", "outputFormat": "一行一个数表示答案。", "hint": "设 $|S| = n$。\n\n| 数据点编号 | $n \\le$ |\n| :--: | :--: |\n| $1 \\sim 2$ | $10$ |\n| $3 \\sim 6$ | ${10}^3$ |\n| $7 \\sim 10$ | ${10}^5$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le {10}^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Basic String Practice Problem.", "background": "YSGH is awesome.", "description": "Given a non-empty binary string $S$ with non-zero length.\n\nFind a non-empty contiguous substring $T$ of $S$ such that the number of $0$ in the substring minus the number of $1$ in the substring is maximized.\n\nYou only need to output this maximum value.", "inputFormat": "One line containing a binary string representing $S$.", "outputFormat": "One line containing one number representing the answer.", "hint": "Let $|S| = n$.\n\n# Constraints\n\n| Test Point ID | $n \\le$ |\n| :--: | :--: |\n| $1 \\sim 2$ | $10$ |\n| $3 \\sim 6$ | ${10}^3$ |\n| $7 \\sim 10$ | ${10}^5$ |\n\nFor $100\\%$ of the testdata, $1 \\le n \\le {10}^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基础字符串练习题", "background": "YSGH 牛逼", "description": "给定长度非零的非空 01 串 $S$。\n\n找出 $S$ 的非空连续子串 $T$ 满足串中 0 的个数减去 1 的个数最大。\n\n你只需要输出最大值即可。", "inputFormat": "一行一个 01 串表示 $S$。", "outputFormat": "一行一个数表示答案。", "hint": "设 $|S| = n$。\n\n| 数据点编号 | $n \\le$ |\n| :--: | :--: |\n| $1 \\sim 2$ | $10$ |\n| $3 \\sim 6$ | ${10}^3$ |\n| $7 \\sim 10$ | ${10}^5$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le {10}^5$。", "locale": "zh-CN"}}}
{"pid": "P5651", "type": "P", "difficulty": 3, "samples": [["3 2 1\n1 2 2\n2 3 3\n1 3", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "最短路", "洛谷月赛"], "title": "基础最短路练习题", "background": "YSGH 牛逼", "description": "给定 $n$ 个点 $m$ 条边的简单无向连通图 $G$，边有边权。保证没有重边和自环。\n\n定义一条简单路径的权值为路径上所有边边权的异或和。\n\n保证 $G$ 中不存在简单环使得边权异或和不为 $0$。\n\n$Q$ 次询问 $x$ 到 $y$ 的最短简单路径。", "inputFormat": "第一行三个正整数 $n, m, Q$。\n\n接下来 $m$ 行，一行三个非负整数 $x, y, v$（$1 \\le x, y \\le n$），表示一条连接 $x, y$，权值为 $v$ 的无向边。保证没有重边和自环。\n\n接下来 $Q$ 行，一行两个正整数 $x, y$（$1 \\le x, y \\le n$），表示一次询问。", "outputFormat": "$Q$ 行，一行一个整数表示答案。", "hint": "| 数据点编号 | $n, Q \\le$ | 特殊性质 |\n| :--: | :--: | :--: |\n| $1,2$ | $10$ | 无 |\n| $3,4$ | $20$ | 无 |\n| $5,6$ | ${10}^5$ | $m = n - 1$ |\n| $7,8$ | ${10}^5$ | $v \\le 1$ |\n| $9,10$ | ${10}^5$ | 无 |\n\n对于 $100\\%$ 的数据，满足 $1 \\le n \\le {10}^5$，$1 \\le m \\le 2n$，$0 \\le v < 2^{30}$。", "locale": "zh-CN", "translations": {"en": {"title": "Basic Shortest Path Practice Problem.", "background": "YSGH is awesome.", "description": "Given a simple, undirected, connected graph $G$ with $n$ vertices and $m$ edges. Each edge has a weight. It is guaranteed that there are no multiple edges and no self-loops.\n\nDefine the weight of a simple path as the XOR sum of the weights of all edges on the path.\n\nIt is guaranteed that there is no simple cycle in $G$ whose edge-weight XOR sum is not $0$.\n\nThere are $Q$ queries asking for the shortest simple path from $x$ to $y$.", "inputFormat": "The first line contains three positive integers $n, m, Q$.\n\nThe next $m$ lines each contain three non-negative integers $x, y, v$ ($1 \\le x, y \\le n$), representing an undirected edge connecting $x$ and $y$ with weight $v$. It is guaranteed that there are no multiple edges and no self-loops.\n\nThe next $Q$ lines each contain two positive integers $x, y$ ($1 \\le x, y \\le n$), representing a query.", "outputFormat": "Output $Q$ lines, each containing one integer as the answer.", "hint": "| Test Point ID | $n, Q \\le$ | Special Property |\n| :--: | :--: | :--: |\n| $1,2$ | $10$ | None |\n| $3,4$ | $20$ | None |\n| $5,6$ | ${10}^5$ | $m = n - 1$ |\n| $7,8$ | ${10}^5$ | $v \\le 1$ |\n| $9,10$ | ${10}^5$ | None |\n\nFor $100\\%$ of the testdata, $1 \\le n \\le {10}^5$, $1 \\le m \\le 2n$, and $0 \\le v < 2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基础最短路练习题", "background": "YSGH 牛逼", "description": "给定 $n$ 个点 $m$ 条边的简单无向连通图 $G$，边有边权。保证没有重边和自环。\n\n定义一条简单路径的权值为路径上所有边边权的异或和。\n\n保证 $G$ 中不存在简单环使得边权异或和不为 $0$。\n\n$Q$ 次询问 $x$ 到 $y$ 的最短简单路径。", "inputFormat": "第一行三个正整数 $n, m, Q$。\n\n接下来 $m$ 行，一行三个非负整数 $x, y, v$（$1 \\le x, y \\le n$），表示一条连接 $x, y$，权值为 $v$ 的无向边。保证没有重边和自环。\n\n接下来 $Q$ 行，一行两个正整数 $x, y$（$1 \\le x, y \\le n$），表示一次询问。", "outputFormat": "$Q$ 行，一行一个整数表示答案。", "hint": "| 数据点编号 | $n, Q \\le$ | 特殊性质 |\n| :--: | :--: | :--: |\n| $1,2$ | $10$ | 无 |\n| $3,4$ | $20$ | 无 |\n| $5,6$ | ${10}^5$ | $m = n - 1$ |\n| $7,8$ | ${10}^5$ | $v \\le 1$ |\n| $9,10$ | ${10}^5$ | 无 |\n\n对于 $100\\%$ 的数据，满足 $1 \\le n \\le {10}^5$，$1 \\le m \\le 2n$，$0 \\le v < 2^{30}$。", "locale": "zh-CN"}}}
{"pid": "P5652", "type": "P", "difficulty": 5, "samples": [["5 2 3 0\n2 4 1 2 3\n1 5\n3 5\n3 4", "5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["洛谷月赛"], "title": "基础博弈练习题", "background": "YSGH is our red sun.", "description": "YSGH 和 YGSH 在打膈膜，YSGS 在旁边围观。\n\n规则是这样的，先给定一个正整数 $m$ 和一个 $n$ 个数的序列 $b$，一开始有一个棋子在 $b$ 的第一个位置，并将 $b_1$ 减去 $1$。此后双方轮流操作，每次操作，假设当前棋子在 $i$，可以把棋子移到一个位置 $j$，满足 $j \\in [i, \\min(i + m, n)]$ 且 $b_j > 0$，然后将 $b_j$ 减 $1$，YSGH 先手，谁先不能操作谁输。\n\n众所周知，YSGH 和 YGSH 都是绝顶聪明的，所以两人都会使用最优策略。\n\n而隔膜使用的序列 $b$ 是一个序列 $a$ 的一个连续非空子序列，当然序列 $a$ 和每次隔膜使用的序列 $b$ 都是 YSGS 定的。\n\n现在他们进行了 $q$ 轮游戏，给出每轮游戏使用的区间，请你判断每轮谁会赢。", "inputFormat": "由于本题数据规模较大，直接输入输出会占用比计算多数倍的时间，因此当询问过多时会对询问的输入输出进行了压缩。\n\n第一行四个正整数 $n, m, q, type$，$n, m, q$ 意义同题面描述，$type$ 表示当前数据的类型，$type = 1$ 说明该组数据进行了压缩，$type = 0$ 则说明没有，数据保证当 $q > {10}^6$ 时，$type=1$。\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $a_i$，意义同题面描述。\n\n如果 $type = 1$，第三行四个正整数 $A, B, C, P$，表示询问的生成方式。\n\n```cpp\nint A, B, C, P;\ninline int rnd() { return A = (A * B + C) % P; }\n```\n\n每次询问时的调用方法为：\n\n```cpp\nl = rnd() % n + 1, r = rnd() % n + 1;\n```\n\n如果生成的 $l > r$，则还需要交换 $l, r$。\n\n数据保证 $0 \\le A B < P$，$0 \\le C < P$，$P (B + 1) < 2^{31} - 1$。\n\n如果 $type=0$，接下来 $q$ 行，每行两个正整数 $l, r$，意义同题面描述。", "outputFormat": "令 ${ans}_i$ 表示第 $i$ 次询问中 YSGH 是否会赢，如果会赢则 ${ans}_i = 1$，否则 ${ans}_i = 0$。\n\n输出一行一个整数，表示 $\\displaystyle \\left( \\sum_{i = 1}^{q} i^2 \\cdot {ans}_i \\right)\\! \\bmod 2^{32}$。", "hint": "对于 $25\\%$ 的数据，$n, m, q \\le 10$，$a_i \\le 2$。  \n对于 $55\\%$ 的数据，$n, m, q \\le 5 \\times {10}^3$。  \n另有 $15\\%$ 的数据，$n \\le {10}^5$，$m \\le 5$。  \n对于 $90\\%$ 的数据，$n, m, q \\le {10}^6$。  \n对于 $100\\%$ 的数据，$1 \\le n, m \\le {10}^6$，$1 \\le q \\le {10}^7$，$1 \\le a_i \\le {10}^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Basic Game Theory Practice Problem.", "background": "YSGH is our red sun.", "description": "YSGH and YGSH are playing “ge mo” (pinyin: gémó), and YSGS is watching.\n\nThe rules are as follows. First, a positive integer $m$ and a sequence $b$ of $n$ numbers are given. Initially, there is a piece on the first position of $b$, and $b_1$ is decreased by $1$. After that, the two players take turns. On each move, suppose the current piece is at position $i$. The player may move the piece to a position $j$ such that $j \\in [i, \\min(i + m, n)]$ and $b_j > 0$, then decrease $b_j$ by $1$. YSGH moves first. Whoever cannot make a move loses.\n\nIt is well known that both YSGH and YGSH are extremely smart, so both will use optimal strategies.\n\nThe sequence $b$ used in “ge mo” is a non-empty contiguous subsequence of a sequence $a$. Of course, both the sequence $a$ and the sequence $b$ used in each round are chosen by YSGS.\n\nNow they play $q$ rounds of the game. Given the interval used in each round, please determine who will win each round.", "inputFormat": "Because the data size of this problem is large, direct input and output will take much more time than computation. Therefore, when there are too many queries, the input and output of the queries are compressed.\n\nThe first line contains four positive integers $n, m, q, type$. The meanings of $n, m, q$ are the same as in the statement. $type$ indicates the type of the current testdata. $type = 1$ means this testdata is compressed, and $type = 0$ means it is not. The testdata guarantees that when $q > {10}^6$, $type = 1$.\n\nThe second line contains $n$ positive integers. The $i$-th positive integer represents $a_i$, with the same meaning as in the statement.\n\nIf $type = 1$, the third line contains four positive integers $A, B, C, P$, describing how queries are generated.\n\n```cpp\nint A, B, C, P;\ninline int rnd() { return A = (A * B + C) % P; }\n```\n\nFor each query, call:\n\n```cpp\nl = rnd() % n + 1, r = rnd() % n + 1;\n```\n\nIf the generated $l > r$, then you also need to swap $l, r$.\n\nThe testdata guarantees $0 \\le A B < P$, $0 \\le C < P$, $P (B + 1) < 2^{31} - 1$.\n\nIf $type = 0$, the next $q$ lines each contain two positive integers $l, r$, with the same meaning as in the statement.", "outputFormat": "Let ${ans}_i$ indicate whether YSGH will win in the $i$-th query. If YSGH will win, then ${ans}_i = 1$, otherwise ${ans}_i = 0$.\n\nOutput one line with one integer, which is $\\displaystyle \\left( \\sum_{i = 1}^{q} i^2 \\cdot {ans}_i \\right)\\! \\bmod 2^{32}$.", "hint": "For $25\\%$ of the testdata, $n, m, q \\le 10$, $a_i \\le 2$.  \nFor $55\\%$ of the testdata, $n, m, q \\le 5 \\times {10}^3$.  \nFor another $15\\%$ of the testdata, $n \\le {10}^5$, $m \\le 5$.  \nFor $90\\%$ of the testdata, $n, m, q \\le {10}^6$.  \nFor $100\\%$ of the testdata, $1 \\le n, m \\le {10}^6$, $1 \\le q \\le {10}^7$, $1 \\le a_i \\le {10}^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基础博弈练习题", "background": "YSGH is our red sun.", "description": "YSGH 和 YGSH 在打膈膜，YSGS 在旁边围观。\n\n规则是这样的，先给定一个正整数 $m$ 和一个 $n$ 个数的序列 $b$，一开始有一个棋子在 $b$ 的第一个位置，并将 $b_1$ 减去 $1$。此后双方轮流操作，每次操作，假设当前棋子在 $i$，可以把棋子移到一个位置 $j$，满足 $j \\in [i, \\min(i + m, n)]$ 且 $b_j > 0$，然后将 $b_j$ 减 $1$，YSGH 先手，谁先不能操作谁输。\n\n众所周知，YSGH 和 YGSH 都是绝顶聪明的，所以两人都会使用最优策略。\n\n而隔膜使用的序列 $b$ 是一个序列 $a$ 的一个连续非空子序列，当然序列 $a$ 和每次隔膜使用的序列 $b$ 都是 YSGS 定的。\n\n现在他们进行了 $q$ 轮游戏，给出每轮游戏使用的区间，请你判断每轮谁会赢。", "inputFormat": "由于本题数据规模较大，直接输入输出会占用比计算多数倍的时间，因此当询问过多时会对询问的输入输出进行了压缩。\n\n第一行四个正整数 $n, m, q, type$，$n, m, q$ 意义同题面描述，$type$ 表示当前数据的类型，$type = 1$ 说明该组数据进行了压缩，$type = 0$ 则说明没有，数据保证当 $q > {10}^6$ 时，$type=1$。\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $a_i$，意义同题面描述。\n\n如果 $type = 1$，第三行四个正整数 $A, B, C, P$，表示询问的生成方式。\n\n```cpp\nint A, B, C, P;\ninline int rnd() { return A = (A * B + C) % P; }\n```\n\n每次询问时的调用方法为：\n\n```cpp\nl = rnd() % n + 1, r = rnd() % n + 1;\n```\n\n如果生成的 $l > r$，则还需要交换 $l, r$。\n\n数据保证 $0 \\le A B < P$，$0 \\le C < P$，$P (B + 1) < 2^{31} - 1$。\n\n如果 $type=0$，接下来 $q$ 行，每行两个正整数 $l, r$，意义同题面描述。", "outputFormat": "令 ${ans}_i$ 表示第 $i$ 次询问中 YSGH 是否会赢，如果会赢则 ${ans}_i = 1$，否则 ${ans}_i = 0$。\n\n输出一行一个整数，表示 $\\displaystyle \\left( \\sum_{i = 1}^{q} i^2 \\cdot {ans}_i \\right)\\! \\bmod 2^{32}$。", "hint": "对于 $25\\%$ 的数据，$n, m, q \\le 10$，$a_i \\le 2$。  \n对于 $55\\%$ 的数据，$n, m, q \\le 5 \\times {10}^3$。  \n另有 $15\\%$ 的数据，$n \\le {10}^5$，$m \\le 5$。  \n对于 $90\\%$ 的数据，$n, m, q \\le {10}^6$。  \n对于 $100\\%$ 的数据，$1 \\le n, m \\le {10}^6$，$1 \\le q \\le {10}^7$，$1 \\le a_i \\le {10}^9$。", "locale": "zh-CN"}}}
{"pid": "P5653", "type": "P", "difficulty": 5, "samples": [["5 1\n4 3 2 3 2\n5 7 -5 9 -10", "24"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["洛谷月赛"], "title": "基础最优化练习题", "background": "YSGH is our red sun.", "description": "YSGH 有一个数 $x$，初值为 $0$。接下来 $n$ 分钟，每分钟 YSGH 可以给 $x$ 加上整数 $y$，其中 $y \\in [-k, k]$，同时 YSGH 需要保证第 $i$ 分钟结束时 $x \\le a_i$。\n\n设 $b_i$ 为第 $i$ 分钟结束时 $x$ 的值，现在 YSGH 给你一个 $n$ 个数的序列 $w$，你需要最大化 $\\displaystyle \\sum_{i = 1}^{n} b_i w_i$。\n\n你只需要输出最大值即可。", "inputFormat": "第一行两个正整数 $n, k$，意义同题面描述。\n\n第二行共 $n$ 个整数，第 $i$ 个表示 $a_i$，意义同题面描述。\n\n第三行共 $n$ 个整数，第 $i$ 个表示 $w_i$，意义同题面描述。\n\n保证输入数据使得至少存在一个序列 $b$ 满足条件。", "outputFormat": "第一行一个整数，表示答案。", "hint": "对于 $10\\%$ 的数据，$n \\le 10$，$k \\le 1$。  \n对于 $20\\%$ 的数据，$n \\le 100$。  \n对于 $30\\%$ 的数据，$n \\le {10}^3$。  \n对于 $50\\%$ 的数据，$n \\le {10}^4$。  \n另有 $10\\%$ 的数据，$w_i \\ge 0$。  \n对于 $100\\%$ 的数据，$1 \\le n \\le {10}^6$，$-{10}^6 \\le w_i \\le {10}^6$，$0 \\le a_i \\le {10}^8$，$1 \\le k \\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "Basic Optimization Practice Problem.", "background": "YSGH is our red sun.", "description": "YSGH has a number $x$ with initial value $0$. For the next $n$ minutes, each minute YSGH can add an integer $y$ to $x$, where $y \\in [-k, k]$. At the same time, YSGH must ensure that at the end of the $i$-th minute, $x \\le a_i$.\n\nLet $b_i$ be the value of $x$ at the end of the $i$-th minute. Now YSGH gives you a sequence $w$ of $n$ numbers. You need to maximize $\\displaystyle \\sum_{i = 1}^{n} b_i w_i$.\n\nYou only need to output the maximum value.", "inputFormat": "The first line contains two positive integers $n, k$, with the same meaning as in the statement.\n\nThe second line contains $n$ integers, where the $i$-th integer is $a_i$, with the same meaning as in the statement.\n\nThe third line contains $n$ integers, where the $i$-th integer is $w_i$, with the same meaning as in the statement.\n\nIt is guaranteed that the input ensures there exists at least one sequence $b$ that satisfies the conditions.", "outputFormat": "The first line contains one integer, which is the answer.", "hint": "For $10\\%$ of the data, $n \\le 10$, $k \\le 1$.  \nFor $20\\%$ of the data, $n \\le 100$.  \nFor $30\\%$ of the data, $n \\le 10^3$.  \nFor $50\\%$ of the data, $n \\le 10^4$.  \nThere is another $10\\%$ of the data where $w_i \\ge 0$.  \nFor $100\\%$ of the data, $1 \\le n \\le 10^6$, $-10^6 \\le w_i \\le 10^6$, $0 \\le a_i \\le 10^8$, $1 \\le k \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基础最优化练习题", "background": "YSGH is our red sun.", "description": "YSGH 有一个数 $x$，初值为 $0$。接下来 $n$ 分钟，每分钟 YSGH 可以给 $x$ 加上整数 $y$，其中 $y \\in [-k, k]$，同时 YSGH 需要保证第 $i$ 分钟结束时 $x \\le a_i$。\n\n设 $b_i$ 为第 $i$ 分钟结束时 $x$ 的值，现在 YSGH 给你一个 $n$ 个数的序列 $w$，你需要最大化 $\\displaystyle \\sum_{i = 1}^{n} b_i w_i$。\n\n你只需要输出最大值即可。", "inputFormat": "第一行两个正整数 $n, k$，意义同题面描述。\n\n第二行共 $n$ 个整数，第 $i$ 个表示 $a_i$，意义同题面描述。\n\n第三行共 $n$ 个整数，第 $i$ 个表示 $w_i$，意义同题面描述。\n\n保证输入数据使得至少存在一个序列 $b$ 满足条件。", "outputFormat": "第一行一个整数，表示答案。", "hint": "对于 $10\\%$ 的数据，$n \\le 10$，$k \\le 1$。  \n对于 $20\\%$ 的数据，$n \\le 100$。  \n对于 $30\\%$ 的数据，$n \\le {10}^3$。  \n对于 $50\\%$ 的数据，$n \\le {10}^4$。  \n另有 $10\\%$ 的数据，$w_i \\ge 0$。  \n对于 $100\\%$ 的数据，$1 \\le n \\le {10}^6$，$-{10}^6 \\le w_i \\le {10}^6$，$0 \\le a_i \\le {10}^8$，$1 \\le k \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5654", "type": "P", "difficulty": 6, "samples": [["5 2\n2 1 5 3 4\n2 5 1 2 4\n3 5\n1 1", "7\n2"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["洛谷月赛"], "title": "基础函数练习题", "background": "YSGH is our red sun.\n", "description": "YSGH 有一个 $1 \\sim n$ 的排列 $p$ 和一个长度为 $n$ 的整数序列 $w$。\n\n定义：\n\n$$ F(l, r) = \\begin{cases} \\max(F(l, m - 1), F(m + 1, r)) + w_m & , l \\le r \\\\ 0 & , l > r \\end{cases} $$\n\n其中 $m$ 为 $p$ 的区间 $[l, r]$ 的最大值的下标。\n\n$q$ 次询问 $F(l, r)$ 的值。", "inputFormat": "第一行两个正整数 $n, q$，意义同题目描述。\n\n第二行共 $n$ 个正整数，第 $i$ 个表示 $p_i$，意义同题目描述。\n\n第三行共 $n$ 个整数，第 $i$ 个表示 $w_i$，意义同题目描述。\n\n接下来共 $q$ 行，每行两个正整数 $l, r$（$1 \\le l \\le r \\le n$），表示询问 $F(l,r)$。", "outputFormat": "输出共 $q$ 行，每行一个整数，表示答案。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（10 points）：$n, q \\le 5 \\times {10}^3$。\n- Subtask 2（10 points）：保证 $p$ 是随机的。\n- Subtask 3（20 points）：$n ,q \\le 5 \\times {10}^4$。\n- Subtask 4（20 points）：$n, q \\le {10}^5$。\n- Subtask 5（20 points）：$w_i \\ge 0$。\n- Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n, q \\le 5 \\times {10}^5$，$|w_i| \\le 10^9$，$1 \\le p_i \\le n$，保证 $p$ 是一个 $1 \\sim n$ 的排列。", "locale": "zh-CN", "translations": {"en": {"title": "Basic Function Practice Problem", "background": "YSGH is our red sun.", "description": "YSGH has a permutation $p$ of $1 \\sim n$ and an integer sequence $w$ of length $n$.\n\nDefine:\n\n$$ F(l, r) = \\begin{cases} \\max(F(l, m - 1), F(m + 1, r)) + w_m & , l \\le r \\\\ 0 & , l > r \\end{cases} $$\n\nwhere $m$ is the index of the maximum value of $p$ in the interval $[l, r]$.\n\nThere are $q$ queries asking for the value of $F(l, r)$.", "inputFormat": "The first line contains two positive integers $n, q$, with the same meaning as in the statement.\n\nThe second line contains $n$ positive integers. The $i$-th integer is $p_i$, with the same meaning as in the statement.\n\nThe third line contains $n$ integers. The $i$-th integer is $w_i$, with the same meaning as in the statement.\n\nThe next $q$ lines each contain two positive integers $l, r$ ($1 \\le l \\le r \\le n$), representing a query for $F(l, r)$.", "outputFormat": "Output $q$ lines. Each line contains one integer, which is the answer.", "hint": "**This problem uses bundled testdata.**\n\n- Subtask 1 (10 points): $n, q \\le 5 \\times {10}^3$.\n- Subtask 2 (10 points): It is guaranteed that $p$ is random.\n- Subtask 3 (20 points): $n, q \\le 5 \\times {10}^4$.\n- Subtask 4 (20 points): $n, q \\le {10}^5$.\n- Subtask 5 (20 points): $w_i \\ge 0$.\n- Subtask 6 (20 points): No special constraints.\n\nFor $100\\%$ of the data, $1 \\le n, q \\le 5 \\times {10}^5$, $|w_i| \\le 10^9$, $1 \\le p_i \\le n$. It is guaranteed that $p$ is a permutation of $1 \\sim n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基础函数练习题", "background": "YSGH is our red sun.\n", "description": "YSGH 有一个 $1 \\sim n$ 的排列 $p$ 和一个长度为 $n$ 的整数序列 $w$。\n\n定义：\n\n$$ F(l, r) = \\begin{cases} \\max(F(l, m - 1), F(m + 1, r)) + w_m & , l \\le r \\\\ 0 & , l > r \\end{cases} $$\n\n其中 $m$ 为 $p$ 的区间 $[l, r]$ 的最大值的下标。\n\n$q$ 次询问 $F(l, r)$ 的值。", "inputFormat": "第一行两个正整数 $n, q$，意义同题目描述。\n\n第二行共 $n$ 个正整数，第 $i$ 个表示 $p_i$，意义同题目描述。\n\n第三行共 $n$ 个整数，第 $i$ 个表示 $w_i$，意义同题目描述。\n\n接下来共 $q$ 行，每行两个正整数 $l, r$（$1 \\le l \\le r \\le n$），表示询问 $F(l,r)$。", "outputFormat": "输出共 $q$ 行，每行一个整数，表示答案。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（10 points）：$n, q \\le 5 \\times {10}^3$。\n- Subtask 2（10 points）：保证 $p$ 是随机的。\n- Subtask 3（20 points）：$n ,q \\le 5 \\times {10}^4$。\n- Subtask 4（20 points）：$n, q \\le {10}^5$。\n- Subtask 5（20 points）：$w_i \\ge 0$。\n- Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n, q \\le 5 \\times {10}^5$，$|w_i| \\le 10^9$，$1 \\le p_i \\le n$，保证 $p$ 是一个 $1 \\sim n$ 的排列。", "locale": "zh-CN"}}}
{"pid": "P5655", "type": "P", "difficulty": 7, "samples": [["1\n3 3\n63\n70\n112\n1 2\n1 3\n2 3", "630\n5040\n560"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "O2优化", "洛谷月赛"], "title": "基础数论函数练习题", "background": "YSGH 牛逼", "description": "给定长度为 $n$ 的数组 $a$，$Q$ 次询问 $\\operatorname{lcm}(a_l, a_{l + 1}, \\ldots , a_{r - 1}, a_r)$。\n\n由于输出较大，你只需要输出答案对 ${10}^9 + 7$ 取模的值。", "inputFormat": "本题有多组数据。\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，第一行两个正整数 $n, Q$。\n\n接下来 $n$ 行，第 $i$ 行一个正整数表示 $a_i$。\n\n接下来 $Q$ 行，一行两个正整数 $l,r$（$1 \\le l \\le r \\le n$），表示一次询问。", "outputFormat": "对于每次询问，一行一个整数表示答案。", "hint": "| 数据点编号 | $n, Q, T \\le$ | $a_i \\le$ |\n| :--: | :--: | :--: |\n| $1$ | $10$ | $10$ |\n| $2$ | $20$ | $2^{60}$ |\n| $3$ | $50$ | $2^{60}$ |\n| $4$ | $100$ | $2^{60}$ |\n| $5$ | $150$ | $2^{60}$ |\n| $6$ | $200$ | $2^{60}$ |\n| $7$ | $240$ | $2^{60}$ |\n| $8$ | $260$ | $2^{60}$ |\n| $9$ | $280$ | $2^{60}$ |\n| $10$ | $300$ | $2^{60}$ |\n\n对于 $100\\%$ 的数据，$1 \\le n, Q, T \\le 300$，$1 \\le a_i \\le 2^{60}$。", "locale": "zh-CN", "translations": {"en": {"title": "Basic Number Theory Function Practice Problem.", "background": "YSGH is awesome.", "description": "Given an array $a$ of length $n$, answer $Q$ queries of $\\operatorname{lcm}(a_l, a_{l + 1}, \\ldots , a_{r - 1}, a_r)$.\n\nSince the output can be large, you only need to output the answer modulo ${10}^9 + 7$.", "inputFormat": "This problem contains multiple test cases.\n\nThe first line contains a positive integer $T$, indicating the number of test cases.\n\nFor each test case, the first line contains two positive integers $n, Q$.\n\nIn the next $n$ lines, the $i$-th line contains a positive integer $a_i$.\n\nIn the next $Q$ lines, each line contains two positive integers $l, r$ ($1 \\le l \\le r \\le n$), representing one query.", "outputFormat": "For each query, output one integer per line, representing the answer.", "hint": "| Test Point ID | $n, Q, T \\le$ | $a_i \\le$ |\n| :--: | :--: | :--: |\n| $1$ | $10$ | $10$ |\n| $2$ | $20$ | $2^{60}$ |\n| $3$ | $50$ | $2^{60}$ |\n| $4$ | $100$ | $2^{60}$ |\n| $5$ | $150$ | $2^{60}$ |\n| $6$ | $200$ | $2^{60}$ |\n| $7$ | $240$ | $2^{60}$ |\n| $8$ | $260$ | $2^{60}$ |\n| $9$ | $280$ | $2^{60}$ |\n| $10$ | $300$ | $2^{60}$ |\n\nFor $100\\%$ of the testdata, $1 \\le n, Q, T \\le 300$, $1 \\le a_i \\le 2^{60}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基础数论函数练习题", "background": "YSGH 牛逼", "description": "给定长度为 $n$ 的数组 $a$，$Q$ 次询问 $\\operatorname{lcm}(a_l, a_{l + 1}, \\ldots , a_{r - 1}, a_r)$。\n\n由于输出较大，你只需要输出答案对 ${10}^9 + 7$ 取模的值。", "inputFormat": "本题有多组数据。\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，第一行两个正整数 $n, Q$。\n\n接下来 $n$ 行，第 $i$ 行一个正整数表示 $a_i$。\n\n接下来 $Q$ 行，一行两个正整数 $l,r$（$1 \\le l \\le r \\le n$），表示一次询问。", "outputFormat": "对于每次询问，一行一个整数表示答案。", "hint": "| 数据点编号 | $n, Q, T \\le$ | $a_i \\le$ |\n| :--: | :--: | :--: |\n| $1$ | $10$ | $10$ |\n| $2$ | $20$ | $2^{60}$ |\n| $3$ | $50$ | $2^{60}$ |\n| $4$ | $100$ | $2^{60}$ |\n| $5$ | $150$ | $2^{60}$ |\n| $6$ | $200$ | $2^{60}$ |\n| $7$ | $240$ | $2^{60}$ |\n| $8$ | $260$ | $2^{60}$ |\n| $9$ | $280$ | $2^{60}$ |\n| $10$ | $300$ | $2^{60}$ |\n\n对于 $100\\%$ 的数据，$1 \\le n, Q, T \\le 300$，$1 \\le a_i \\le 2^{60}$。", "locale": "zh-CN"}}}
{"pid": "P5656", "type": "P", "difficulty": 5, "samples": [["7\n2 11 100\n3 18 6\n192 608 17\n19 2 60817\n11 45 14\n19 19 810\n98 76 5432", "4 6 2 39 8\n2 1\n-1\n1600 1 18 3199 30399\n34 3\n-1\n2 12 7 50 56"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384]}, "tags": ["数学", "最大公约数 gcd", "扩展欧几里德算法", "模板题"], "title": "【模板】二元一次不定方程 (exgcd)", "background": "", "description": "给定不定方程\n\n$$ax+by=c$$\n\n若该方程无整数解，输出 $-1$。  \n若该方程有整数解，且有正整数解，则输出其**正整数**解的数量，所有**正整数**解中 $x$ 的最小值，所有**正整数**解中 $y$ 的最小值，所有**正整数**解中 $x$ 的最大值，以及所有**正整数**解中 $y$ 的最大值。  \n若方程有整数解，但没有正整数解，你需要输出所有**整数解**中 $x$ 的最小正整数值， $y$ 的最小正整数值。\n\n正整数解即为 $x, y$ 均为正整数的解，$\\boldsymbol{0}$ **不是正整数**。  \n整数解即为 $x,y$ 均为整数的解。  \n$x$ 的最小正整数值即所有 $x$ 为正整数的整数解中 $x$ 的最小值，$y$ 同理。", "inputFormat": "第一行一个正整数 $T$，代表数据组数。\n\n接下来 $T$ 行，每行三个由空格隔开的正整数 $a, b, c$。", "outputFormat": "$T$ 行。\n\n若该行对应的询问无整数解，一个数字 $-1$。  \n若该行对应的询问有整数解但无正整数解，包含 $2$ 个由空格隔开的数字，依次代表整数解中，$x$ 的最小正整数值，$y$ 的最小正整数值。  \n否则包含 $5$ 个由空格隔开的数字，依次代表正整数解的数量，正整数解中，$x$ 的最小值，$y$ 的最小值，$x$ 的最大值，$y$ 的最大值。\n\n**读入输出量较大，注意使用较快的读入输出方式**", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 2 \\times {10}^5$，$1 \\le a, b, c \\le {10}^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Binary Linear Diophantine Equation (exgcd)", "background": "", "description": "Given the indeterminate equation\n\n$$ax+by=c$$\n\nIf this equation has no integer solution, output $-1$.  \nIf this equation has integer solutions and also has positive integer solutions, output: the number of **positive integer** solutions, the minimum value of $x$ among all **positive integer** solutions, the minimum value of $y$ among all **positive integer** solutions, the maximum value of $x$ among all **positive integer** solutions, and the maximum value of $y$ among all **positive integer** solutions.  \nIf the equation has integer solutions but has no positive integer solution, you need to output: the minimum positive integer value of $x$ among all **integer solutions**, and the minimum positive integer value of $y$ among all **integer solutions**.\n\nA positive integer solution means a solution where both $x$ and $y$ are positive integers, and $\\boldsymbol{0}$ **is not a positive integer**.  \nAn integer solution means a solution where both $x$ and $y$ are integers.  \nThe minimum positive integer value of $x$ means the minimum value of $x$ among all integer solutions with $x$ being a positive integer, and similarly for $y$.", "inputFormat": "The first line contains a positive integer $T$, representing the number of test cases.\n\nThe next $T$ lines each contain three positive integers $a, b, c$ separated by spaces.", "outputFormat": "Output $T$ lines.\n\nIf the corresponding query has no integer solution, output a single number $-1$.  \nIf the corresponding query has integer solutions but no positive integer solution, output $2$ numbers separated by spaces, representing the minimum positive integer value of $x$ and the minimum positive integer value of $y$ among integer solutions, in order.  \nOtherwise, output $5$ numbers separated by spaces, representing the number of positive integer solutions, the minimum $x$, the minimum $y$, the maximum $x$, and the maximum $y$ among positive integer solutions, in order.\n\nThe input and output sizes are large, so please use fast I/O methods.", "hint": "**Constraints**\n\nFor $100\\%$ of the testdata, $1 \\le T \\le 2 \\times {10}^5$, $1 \\le a, b, c \\le {10}^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】二元一次不定方程 (exgcd)", "background": "", "description": "给定不定方程\n\n$$ax+by=c$$\n\n若该方程无整数解，输出 $-1$。  \n若该方程有整数解，且有正整数解，则输出其**正整数**解的数量，所有**正整数**解中 $x$ 的最小值，所有**正整数**解中 $y$ 的最小值，所有**正整数**解中 $x$ 的最大值，以及所有**正整数**解中 $y$ 的最大值。  \n若方程有整数解，但没有正整数解，你需要输出所有**整数解**中 $x$ 的最小正整数值， $y$ 的最小正整数值。\n\n正整数解即为 $x, y$ 均为正整数的解，$\\boldsymbol{0}$ **不是正整数**。  \n整数解即为 $x,y$ 均为整数的解。  \n$x$ 的最小正整数值即所有 $x$ 为正整数的整数解中 $x$ 的最小值，$y$ 同理。", "inputFormat": "第一行一个正整数 $T$，代表数据组数。\n\n接下来 $T$ 行，每行三个由空格隔开的正整数 $a, b, c$。", "outputFormat": "$T$ 行。\n\n若该行对应的询问无整数解，一个数字 $-1$。  \n若该行对应的询问有整数解但无正整数解，包含 $2$ 个由空格隔开的数字，依次代表整数解中，$x$ 的最小正整数值，$y$ 的最小正整数值。  \n否则包含 $5$ 个由空格隔开的数字，依次代表正整数解的数量，正整数解中，$x$ 的最小值，$y$ 的最小值，$x$ 的最大值，$y$ 的最大值。\n\n**读入输出量较大，注意使用较快的读入输出方式**", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 2 \\times {10}^5$，$1 \\le a, b, c \\le {10}^9$。", "locale": "zh-CN"}}}
{"pid": "P5657", "type": "P", "difficulty": 2, "samples": [["2 3", "10"], ["3 5", "111"], ["44 1145141919810", "00011000111111010000001001001000000001100011"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2019", "递归", "CSP-S 提高级"], "title": "[CSP-S 2019] 格雷码", "background": "", "description": "通常，人们习惯将所有 $n$ 位二进制串按照字典序排列，例如所有 2 位二进制串按字典序从小到大排列为：00，01，10，11。\n\n格雷码（Gray Code）是一种特殊的 $n$ 位二进制串排列法，它要求相邻的两个二进制串间**恰好**有一位**不同**，特别地，第一个串与最后一个串也算作相邻。\n\n所有 2 位二进制串按格雷码排列的一个例子为：00，01，11，10。\n\n$n$ 位格雷码不止一种，下面给出其中一种格雷码的生成算法：\n1. 1 位格雷码由两个 1 位二进制串组成，顺序为：0，1。\n2. $n + 1$ 位格雷码的前 $2^n$ 个二进制串，可以由依此算法生成的 $n$ 位格雷码（总共 $2^n$ 个 $n$ 位二进制串）按**顺序**排列，再在每个串前加一个前缀 0 构成。\n3. $n + 1$ 位格雷码的后 $2^n$ 个二进制串，可以由依此算法生成的 $n$ 位格雷码（总共 $2^n$ 个 $n$ 位二进制串）按**逆序**排列，再在每个串前加一个前缀 1 构成。\n\n综上，$n + 1$ 位格雷码，由 $n$ 位格雷码的 $2^n$ 个二进制串按顺序排列再加前缀 0，和按逆序排列再加前缀 1 构成，共 $2^{n+1}$ 个二进制串。另外，对于 $n$ 位格雷码中的 $2^n$ 个 二进制串，我们按上述算法得到的排列顺序将它们从 $0 \\sim 2^n - 1$ 编号。\n\n按该算法，2 位格雷码可以这样推出：\n\n1. 已知 1 位格雷码为 0，1。\n2. 前两个格雷码为 00，01。后两个格雷码为 11，10。合并得到 00，01，11，10，编号依次为 0 ~ 3。\n\n同理，3 位格雷码可以这样推出：\n\n1. 已知 2 位格雷码为：00，01，11，10。\n2. 前四个格雷码为：000，001，011，010。后四个格雷码为：110，111，101，100。合并得到：000，001，011，010，110，111，101，100，编号依次为 0 ~ 7。\n\n现在给出 $n$，$k$，请你求出按上述算法生成的 $n$ 位格雷码中的 $k$ 号二进制串。\n", "inputFormat": "仅一行两个整数 $n$，$k$，意义见题目描述。", "outputFormat": "仅一行一个 $n$ 位二进制串表示答案。", "hint": "【样例 1 解释】\n\n2 位格雷码为：00，01，11，10，编号从 0∼3，因此 3 号串是 10。\n\n【样例 2 解释】\n\n3 位格雷码为：000，001，011，010，110，111，101，100，编号从 0∼7，因此 5 号串是 111。\n\n【数据范围】\n\n对于 $50\\%$ 的数据：$n \\leq 10$\n\n对于 $80\\%$ 的数据：$k \\leq 5 \\times 10^6$\n\n对于 $95\\%$ 的数据：$k \\leq 2^{63} - 1$\n\n对于 $100\\%$ 的数据：$1 \\leq n \\leq 64$, $0 \\leq k \\lt 2^n$", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019] Gray Code", "background": "", "description": "Usually, people are used to arranging all $n$-bit binary strings in lexicographical order. For example, all 2-bit binary strings in increasing lexicographical order are: 00, 01, 10, 11.\n\nGray Code is a special way to arrange $n$-bit binary strings. It requires that any two adjacent binary strings differ in **exactly** one bit. In particular, the first string and the last string are also considered adjacent.\n\nAn example of arranging all 2-bit binary strings in Gray Code order is: 00, 01, 11, 10.\n\nThere is more than one $n$-bit Gray Code. Below is one algorithm to generate a Gray Code:\n1. The 1-bit Gray Code consists of two 1-bit binary strings, in the order: 0, 1.\n2. The first $2^n$ binary strings of the $(n + 1)$-bit Gray Code can be formed by taking the $n$-bit Gray Code generated by this algorithm (a total of $2^n$ $n$-bit binary strings) in **order**, and adding a prefix 0 to each string.\n3. The last $2^n$ binary strings of the $(n + 1)$-bit Gray Code can be formed by taking the $n$-bit Gray Code generated by this algorithm (a total of $2^n$ $n$-bit binary strings) in **reverse order**, and adding a prefix 1 to each string.\n\nIn summary, the $(n + 1)$-bit Gray Code consists of the $2^n$ strings of the $n$-bit Gray Code in order with prefix 0, and the $2^n$ strings of the $n$-bit Gray Code in reverse order with prefix 1, making a total of $2^{n+1}$ binary strings. Also, for the $2^n$ binary strings in the $n$-bit Gray Code, we number them as $0 \\sim 2^n - 1$ according to the order produced by the above algorithm.\n\nWith this algorithm, the 2-bit Gray Code can be derived as follows:\n\n1. The 1-bit Gray Code is 0, 1.\n2. The first two Gray codes are 00, 01. The last two Gray codes are 11, 10. Merging them gives 00, 01, 11, 10, numbered from 0 to 3 in order.\n\nSimilarly, the 3-bit Gray Code can be derived as follows:\n\n1. The 2-bit Gray Code is: 00, 01, 11, 10.\n2. The first four Gray codes are: 000, 001, 011, 010. The last four Gray codes are: 110, 111, 101, 100. Merging them gives: 000, 001, 011, 010, 110, 111, 101, 100, numbered from 0 to 7 in order.\n\nNow you are given $n$ and $k$. Please find the $k$-th binary string in the $n$-bit Gray Code generated by the above algorithm.", "inputFormat": "A single line with two integers $n$ and $k$, as described in the statement.", "outputFormat": "A single line with an $n$-bit binary string representing the answer.", "hint": "[Sample 1 Explanation]\n\nThe 2-bit Gray Code is: 00, 01, 11, 10, numbered from $0 \\sim 3$, so string number 3 is 10.\n\n[Sample 2 Explanation]\n\nThe 3-bit Gray Code is: 000, 001, 011, 010, 110, 111, 101, 100, numbered from $0 \\sim 7$, so string number 5 is 111.\n\n[Constraints]\n\nFor $50\\%$ of the testdata: $n \\leq 10$.\n\nFor $80\\%$ of the testdata: $k \\leq 5 \\times 10^6$.\n\nFor $95\\%$ of the testdata: $k \\leq 2^{63} - 1$.\n\nFor $100\\%$ of the testdata: $1 \\leq n \\leq 64$, $0 \\leq k \\lt 2^n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019] 格雷码", "background": "", "description": "通常，人们习惯将所有 $n$ 位二进制串按照字典序排列，例如所有 2 位二进制串按字典序从小到大排列为：00，01，10，11。\n\n格雷码（Gray Code）是一种特殊的 $n$ 位二进制串排列法，它要求相邻的两个二进制串间**恰好**有一位**不同**，特别地，第一个串与最后一个串也算作相邻。\n\n所有 2 位二进制串按格雷码排列的一个例子为：00，01，11，10。\n\n$n$ 位格雷码不止一种，下面给出其中一种格雷码的生成算法：\n1. 1 位格雷码由两个 1 位二进制串组成，顺序为：0，1。\n2. $n + 1$ 位格雷码的前 $2^n$ 个二进制串，可以由依此算法生成的 $n$ 位格雷码（总共 $2^n$ 个 $n$ 位二进制串）按**顺序**排列，再在每个串前加一个前缀 0 构成。\n3. $n + 1$ 位格雷码的后 $2^n$ 个二进制串，可以由依此算法生成的 $n$ 位格雷码（总共 $2^n$ 个 $n$ 位二进制串）按**逆序**排列，再在每个串前加一个前缀 1 构成。\n\n综上，$n + 1$ 位格雷码，由 $n$ 位格雷码的 $2^n$ 个二进制串按顺序排列再加前缀 0，和按逆序排列再加前缀 1 构成，共 $2^{n+1}$ 个二进制串。另外，对于 $n$ 位格雷码中的 $2^n$ 个 二进制串，我们按上述算法得到的排列顺序将它们从 $0 \\sim 2^n - 1$ 编号。\n\n按该算法，2 位格雷码可以这样推出：\n\n1. 已知 1 位格雷码为 0，1。\n2. 前两个格雷码为 00，01。后两个格雷码为 11，10。合并得到 00，01，11，10，编号依次为 0 ~ 3。\n\n同理，3 位格雷码可以这样推出：\n\n1. 已知 2 位格雷码为：00，01，11，10。\n2. 前四个格雷码为：000，001，011，010。后四个格雷码为：110，111，101，100。合并得到：000，001，011，010，110，111，101，100，编号依次为 0 ~ 7。\n\n现在给出 $n$，$k$，请你求出按上述算法生成的 $n$ 位格雷码中的 $k$ 号二进制串。\n", "inputFormat": "仅一行两个整数 $n$，$k$，意义见题目描述。", "outputFormat": "仅一行一个 $n$ 位二进制串表示答案。", "hint": "【样例 1 解释】\n\n2 位格雷码为：00，01，11，10，编号从 0∼3，因此 3 号串是 10。\n\n【样例 2 解释】\n\n3 位格雷码为：000，001，011，010，110，111，101，100，编号从 0∼7，因此 5 号串是 111。\n\n【数据范围】\n\n对于 $50\\%$ 的数据：$n \\leq 10$\n\n对于 $80\\%$ 的数据：$k \\leq 5 \\times 10^6$\n\n对于 $95\\%$ 的数据：$k \\leq 2^{63} - 1$\n\n对于 $100\\%$ 的数据：$1 \\leq n \\leq 64$, $0 \\leq k \\lt 2^n$", "locale": "zh-CN"}}}
{"pid": "P5658", "type": "P", "difficulty": 4, "samples": [["5\n(()()\n1 1 2 2", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["树形数据结构", "2019", "树论", "栈", "CSP-S 提高级"], "title": "[CSP-S 2019] 括号树", "background": "本题中**合法括号串**的定义如下：\n1.\t`()` 是合法括号串。\n2.\t如果 `A` 是合法括号串，则 `(A)` 是合法括号串。\n3.\t如果 `A`，`B` 是合法括号串，则 `AB` 是合法括号串。\n\n本题中**子串**与**不同的子串**的定义如下：\n1.\t字符串 `S` 的子串是 `S` 中**连续**的任意个字符组成的字符串。`S` 的子串可用起始位置 $l$ 与终止位置 $r$ 来表示，记为 $S (l, r)$（$1 \\leq l \\leq r \\leq |S |$，$|S |$ 表示 S 的长度）。\n2.\t`S` 的两个子串视作不同**当且仅当**它们在 `S` 中的位置不同，即 $l$ 不同或 $r$ 不同。", "description": "一个大小为 $n$ 的树包含 $n$ 个结点和 $n - 1$ 条边，每条边连接两个结点，且任意两个结点间**有且仅有**一条简单路径互相可达。\n\n小 Q 是一个充满好奇心的小朋友，有一天他在上学的路上碰见了一个大小为 $n$ 的树，树上结点从 $1 \\sim n$ 编号，$1$ 号结点为树的根。除 $1$ 号结点外，每个结点有一个父亲结点，$u$（$2 \\leq u \\leq n$）号结点的父亲为 $f_u$（$1 ≤ f_u < u$）号结点。\n\n小 Q 发现这个树的每个结点上**恰有**一个括号，可能是`(` 或`)`。小 Q 定义 $s_i$ 为：将根结点到 $i$ 号结点的简单路径上的括号，按结点经过顺序依次排列组成的字符串。\n \n显然 $s_i$ 是个括号串，但不一定是合法括号串，因此现在小 Q 想对所有的 $i$（$1\\leq i\\leq n$）求出，$s_i$ 中有多少个**互不相同的子串**是**合法括号串**。\n \n这个问题难倒了小 Q，他只好向你求助。设 $s_i$ 共有 $k_i$ 个不同子串是合法括号串， 你只需要告诉小 Q 所有 $i \\times k_i$ 的异或和，即：\n$$ (1 \\times k_1)\\ \\text{xor}\\ (2 \\times k_2)\\ \\text{xor}\\ (3 \\times k_3)\\ \\text{xor}\\ \\cdots\\ \\text{xor}\\ (n \\times k_n) $$\n其中 $\\text{xor}$ 是位异或运算。", "inputFormat": "第一行一个整数 $n$，表示树的大小。\n\n第二行一个长为 $n$ 的由`(` 与`)` 组成的括号串，第 $i$ 个括号表示 $i$ 号结点上的括号。\n\n第三行包含 $n − 1$ 个整数，第 $i$（$1 \\leq i \\lt n$）个整数表示 $i + 1$ 号结点的父亲编号 $f_{i+1}$。", "outputFormat": "仅一行一个整数表示答案。", "hint": "**【样例 1 解释】**\n\n树的形态如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/10z2scex.png)\n\n将根到 1 号结点的简单路径上的括号，按经过顺序排列所组成的字符串为 `(`，子串是合法括号串的个数为 $0$。\n\n将根到 2 号结点的字符串为 `((`，子串是合法括号串的个数为 $0$。\n\n将根到 3 号结点的字符串为 `()`，子串是合法括号串的个数为 $1$。\n\n将根到 4 号结点的字符串为 `(((`，子串是合法括号串的个数为 $0$。\n\n将根到 5 号结点的字符串为 `(()`，子串是合法括号串的个数为 $1$。\n\n**【样例 2】**\n\n见选手目录下的 brackets/brackets2.in 与 brackets/brackets2.ans。\n\n**【数据范围】**\n\n::cute-table{tuack}\n\n| 测试点编号 | $n\\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1\\sim 2$ | $8$ | $f_i=i-1$ |\n| $3\\sim 4$ | $200$ | ^ |\n| $5\\sim 7$ | $2000$ | ^ |\n| $8\\sim 10$ | ^ | 无 |\n| $11\\sim 14$ | $10^5$ | $f_i=i-1$ |\n| $15\\sim 16$ | ^ | 无 |\n| $17\\sim 20$ | $5\\times 10^5$ | ^ |", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019] Bracket Tree", "background": "In this problem, a **valid bracket sequence** is defined as follows:\n1. `()` is a valid bracket sequence.\n2. If `A` is a valid bracket sequence, then `(A)` is a valid bracket sequence.\n3. If `A` and `B` are valid bracket sequences, then `AB` is a valid bracket sequence.\n\nIn this problem, the definitions of a **substring** and **distinct substrings** are as follows:\n1. A substring of a string `S` is a string formed by any **continuous** characters in `S`. A substring of `S` can be represented by the starting position $l$ and the ending position $r$, denoted as $S (l, r)$ ($1 \\leq l \\leq r \\leq |S |$, where $|S |$ denotes the length of `S`).\n2. Two substrings of `S` are considered different **if and only if** their positions in `S` are different, i.e. $l$ is different or $r$ is different.", "description": "A tree of size $n$ contains $n$ nodes and $n - 1$ edges. Each edge connects two nodes, and between any two nodes there exists **exactly one** simple path.\n\nXiao Q is a curious kid. One day on his way to school, he encountered a tree of size $n$. The nodes of the tree are numbered from $1 \\sim n$, and node $1$ is the root. Except for node $1$, every node has a parent node. The parent of node $u$ ($2 \\leq u \\leq n$) is node $f_u$ ($1 \\le f_u < u$).\n\nXiao Q found that each node of the tree has **exactly** one bracket, either `(` or `)`. Xiao Q defines $s_i$ as follows: take the brackets on the simple path from the root to node $i$, and arrange them into a string in the order the nodes are visited.\n\nObviously, $s_i$ is a bracket string, but it is not necessarily a valid bracket sequence. Now Xiao Q wants, for all $i$ ($1 \\leq i \\leq n$), to find how many **distinct substrings** of $s_i$ are **valid bracket sequences**.\n\nThis problem stumped Xiao Q, so he asks you for help. Suppose $s_i$ has $k_i$ distinct substrings that are valid bracket sequences. You only need to tell Xiao Q the XOR sum of all $i \\times k_i$, namely:\n$$ (1 \\times k_1)\\ \\text{xor}\\ (2 \\times k_2)\\ \\text{xor}\\ (3 \\times k_3)\\ \\text{xor}\\ \\cdots\\ \\text{xor}\\ (n \\times k_n) $$\nwhere $\\text{xor}$ is the bitwise XOR operation.", "inputFormat": "The first line contains an integer $n$, denoting the size of the tree.\n\nThe second line contains a bracket string of length $n$ consisting of `(` and `)`. The $i$-th bracket denotes the bracket on node $i$.\n\nThe third line contains $n − 1$ integers. The $i$-th integer ($1 \\leq i \\lt n$) denotes the parent index $f_{i+1}$ of node $i + 1$.", "outputFormat": "Only one line containing one integer, denoting the answer.", "hint": "**[Sample 1 Explanation]**\n\nThe shape of the tree is shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/10z2scex.png)\n\nThe string formed by the brackets on the simple path from the root to node 1, arranged in order, is `(`, and the number of substrings that are valid bracket sequences is $0$.\n\nThe string from the root to node 2 is `((`, and the number of substrings that are valid bracket sequences is $0$.\n\nThe string from the root to node 3 is `()`, and the number of substrings that are valid bracket sequences is $1$.\n\nThe string from the root to node 4 is `(((`, and the number of substrings that are valid bracket sequences is $0$.\n\nThe string from the root to node 5 is `(()`, and the number of substrings that are valid bracket sequences is $1$.\n\n**[Sample 2]**\n\nSee `brackets/brackets2.in` and `brackets/brackets2.ans` under the contestant directory.\n\n**[Constraints]**\n\n::cute-table{tuack}\n\n| Test Point ID | $n\\le$ | Special Property |\n|:-:|:-:|:-:|\n| $1\\sim 2$ | $8$ | $f_i=i-1$ |\n| $3\\sim 4$ | $200$ | ^ |\n| $5\\sim 7$ | $2000$ | ^ |\n| $8\\sim 10$ | ^ | None |\n| $11\\sim 14$ | $10^5$ | $f_i=i-1$ |\n| $15\\sim 16$ | ^ | None |\n| $17\\sim 20$ | $5\\times 10^5$ | ^ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019] 括号树", "background": "本题中**合法括号串**的定义如下：\n1.\t`()` 是合法括号串。\n2.\t如果 `A` 是合法括号串，则 `(A)` 是合法括号串。\n3.\t如果 `A`，`B` 是合法括号串，则 `AB` 是合法括号串。\n\n本题中**子串**与**不同的子串**的定义如下：\n1.\t字符串 `S` 的子串是 `S` 中**连续**的任意个字符组成的字符串。`S` 的子串可用起始位置 $l$ 与终止位置 $r$ 来表示，记为 $S (l, r)$（$1 \\leq l \\leq r \\leq |S |$，$|S |$ 表示 S 的长度）。\n2.\t`S` 的两个子串视作不同**当且仅当**它们在 `S` 中的位置不同，即 $l$ 不同或 $r$ 不同。", "description": "一个大小为 $n$ 的树包含 $n$ 个结点和 $n - 1$ 条边，每条边连接两个结点，且任意两个结点间**有且仅有**一条简单路径互相可达。\n\n小 Q 是一个充满好奇心的小朋友，有一天他在上学的路上碰见了一个大小为 $n$ 的树，树上结点从 $1 \\sim n$ 编号，$1$ 号结点为树的根。除 $1$ 号结点外，每个结点有一个父亲结点，$u$（$2 \\leq u \\leq n$）号结点的父亲为 $f_u$（$1 ≤ f_u < u$）号结点。\n\n小 Q 发现这个树的每个结点上**恰有**一个括号，可能是`(` 或`)`。小 Q 定义 $s_i$ 为：将根结点到 $i$ 号结点的简单路径上的括号，按结点经过顺序依次排列组成的字符串。\n \n显然 $s_i$ 是个括号串，但不一定是合法括号串，因此现在小 Q 想对所有的 $i$（$1\\leq i\\leq n$）求出，$s_i$ 中有多少个**互不相同的子串**是**合法括号串**。\n \n这个问题难倒了小 Q，他只好向你求助。设 $s_i$ 共有 $k_i$ 个不同子串是合法括号串， 你只需要告诉小 Q 所有 $i \\times k_i$ 的异或和，即：\n$$ (1 \\times k_1)\\ \\text{xor}\\ (2 \\times k_2)\\ \\text{xor}\\ (3 \\times k_3)\\ \\text{xor}\\ \\cdots\\ \\text{xor}\\ (n \\times k_n) $$\n其中 $\\text{xor}$ 是位异或运算。", "inputFormat": "第一行一个整数 $n$，表示树的大小。\n\n第二行一个长为 $n$ 的由`(` 与`)` 组成的括号串，第 $i$ 个括号表示 $i$ 号结点上的括号。\n\n第三行包含 $n − 1$ 个整数，第 $i$（$1 \\leq i \\lt n$）个整数表示 $i + 1$ 号结点的父亲编号 $f_{i+1}$。", "outputFormat": "仅一行一个整数表示答案。", "hint": "**【样例 1 解释】**\n\n树的形态如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/10z2scex.png)\n\n将根到 1 号结点的简单路径上的括号，按经过顺序排列所组成的字符串为 `(`，子串是合法括号串的个数为 $0$。\n\n将根到 2 号结点的字符串为 `((`，子串是合法括号串的个数为 $0$。\n\n将根到 3 号结点的字符串为 `()`，子串是合法括号串的个数为 $1$。\n\n将根到 4 号结点的字符串为 `(((`，子串是合法括号串的个数为 $0$。\n\n将根到 5 号结点的字符串为 `(()`，子串是合法括号串的个数为 $1$。\n\n**【样例 2】**\n\n见选手目录下的 brackets/brackets2.in 与 brackets/brackets2.ans。\n\n**【数据范围】**\n\n::cute-table{tuack}\n\n| 测试点编号 | $n\\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1\\sim 2$ | $8$ | $f_i=i-1$ |\n| $3\\sim 4$ | $200$ | ^ |\n| $5\\sim 7$ | $2000$ | ^ |\n| $8\\sim 10$ | ^ | 无 |\n| $11\\sim 14$ | $10^5$ | $f_i=i-1$ |\n| $15\\sim 16$ | ^ | 无 |\n| $17\\sim 20$ | $5\\times 10^5$ | ^ |", "locale": "zh-CN"}}}
{"pid": "P5659", "type": "P", "difficulty": 7, "samples": [["4\n5\n2 1 3 5 4\n1 3\n1 4\n2 4\n4 5\n5\n3 4 2 1 5\n1 2\n2 3\n3 4\n4 5\n5\n1 2 5 3 4\n1 2\n1 3\n1 4\n1 5\n10\n1 2 3 4 5 7 8 9 10 6\n1 2\n1 3\n1 4\n1 5\n5 6\n6 7\n7 8\n8 9\n9 10", "1 3 4 2 5\n1 3 5 2 4\n2 3 1 4 5\n2 3 4 5 6 1 7 8 9 10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["树形数据结构", "2019", "CSP-S 提高级"], "title": "[CSP-S 2019] 树上的数", "background": null, "description": "给定一个大小为 $n$ 的树，它共有 $n$ 个结点与 $n - 1$ 条边，结点从 $1 \\sim n$ 编号。初始时每个结点上都有一个 $1 \\sim n$ 的数字，且每个 $1 \\sim n$ 的数字都只在**恰好**一个结点上出现。\n\n接下来你需要进行**恰好** $n - 1$ 次删边操作，每次操作你需要选一条**未被删去**的边，此时这条边所连接的两个结点上的数字将会**交换**，然后这条边将被删去。\n\n$n - 1$ 次操作过后，所有的边都将被删去。此时，按数字从小到大的顺序，将数字 $1 \\sim n$ 所在的结点编号依次排列，就得到一个结点编号的排列 $P_i$。现在请你求出，在最优操作方案下能得到的**字典序最小**的 $P_i$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/flbxosct.png)\n\n如上图，蓝圈中的数字 $1 \\sim 5$ 一开始分别在结点②、①、③、⑤、④。按照 (1)(4)(3)(2) 的顺序删去所有边，树变为下图。按数字顺序得到的结点编号排列为①③④②⑤，该排列是所有可能的结果中字典序最小的。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tu338qm9.png)", "inputFormat": "**本题输入包含多组测试数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组测试数据：\n\n第一行一个整数 $n$，表示树的大小。\n\n第二行 $n$ 个整数，第 $i (1 \\leq i \\leq n)$ 个整数表示数字 $i$ 初始时所在的结点编号。\n\n接下来 $n - 1$ 行每行两个整数 $x$, $y$，表示一条连接 $x$ 号结点与 $y$ 号结点的边。", "outputFormat": "对于每组测试数据，输出一行共 $n$ 个用空格隔开的整数，表示最优操作方案下所能得到的字典序最小的 $P_i$。", "hint": "【数据范围】\n\n| 测试点编号 | $n \\leq$ | 特殊性质 |\n| :----------- | :----------- | :----------- |\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 4$ | $160$ | 树的形态是一条链 |\n| $5 \\sim 7$ | $2000$ | 同上 |\n| $8 \\sim 9$ | $160$ | 存在度数为 $n - 1$ 的结点 |\n| $10 \\sim 12$ | $2000$ | 同上 |\n| $13 \\sim 16$ | $160$ | 无 |\n| $17 \\sim 20$ | $2000$ | 无 |\n\n对于所有测试点：$1 \\leq T \\leq 10$，保证给出的是一个树。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019] Numbers on a Tree.", "background": "", "description": "Given a tree of size $n$, it has $n$ nodes and $n - 1$ edges, with nodes numbered from $1 \\sim n$. Initially, each node contains a number from $1 \\sim n$, and each number from $1 \\sim n$ appears on **exactly** one node.\n\nNext, you need to perform **exactly** $n - 1$ edge-deletion operations. In each operation, you choose an edge that has **not been deleted**. The numbers on the two endpoints of this edge will **swap**, and then this edge will be deleted.\n\nAfter $n - 1$ operations, all edges will have been deleted. At this time, list the node indices where numbers $1 \\sim n$ are located in increasing order of the numbers, and you obtain a permutation of node indices $P_i$. Now, please find the **lexicographically smallest** $P_i$ that can be obtained under an optimal sequence of operations.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/flbxosct.png)\n\nAs shown above, the numbers $1 \\sim 5$ in the blue circles are initially on nodes ②, ①, ③, ⑤, ④ respectively. Delete all edges in the order (1)(4)(3)(2), and the tree becomes the figure below. The node index permutation obtained by the number order is ①③④②⑤, which is the lexicographically smallest among all possible results.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tu338qm9.png)", "inputFormat": "**This problem contains multiple test cases.**\n\nThe first line contains a positive integer $T$, indicating the number of test cases.\n\nFor each test case:\n\nThe first line contains an integer $n$, indicating the size of the tree.\n\nThe second line contains $n$ integers. The $i (1 \\leq i \\leq n)$-th integer indicates the node index where number $i$ is initially located.\n\nThe next $n - 1$ lines each contain two integers $x$, $y$, indicating an edge connecting node $x$ and node $y$.", "outputFormat": "For each test case, output one line with $n$ integers separated by spaces, representing the lexicographically smallest $P_i$ that can be obtained under an optimal sequence of operations.", "hint": "Constraints\n\n| Test Point ID | $n \\leq$ | Special Property |\n| :----------- | :----------- | :----------- |\n| $1 \\sim 2$ | $10$ | None |\n| $3 \\sim 4$ | $160$ | The tree is a chain |\n| $5 \\sim 7$ | $2000$ | Same as above |\n| $8 \\sim 9$ | $160$ | There exists a node with degree $n - 1$ |\n| $10 \\sim 12$ | $2000$ | Same as above |\n| $13 \\sim 16$ | $160$ | None |\n| $17 \\sim 20$ | $2000$ | None |\n\nFor all test points: $1 \\leq T \\leq 10$, and it is guaranteed that the input is a tree.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019] 树上的数", "background": null, "description": "给定一个大小为 $n$ 的树，它共有 $n$ 个结点与 $n - 1$ 条边，结点从 $1 \\sim n$ 编号。初始时每个结点上都有一个 $1 \\sim n$ 的数字，且每个 $1 \\sim n$ 的数字都只在**恰好**一个结点上出现。\n\n接下来你需要进行**恰好** $n - 1$ 次删边操作，每次操作你需要选一条**未被删去**的边，此时这条边所连接的两个结点上的数字将会**交换**，然后这条边将被删去。\n\n$n - 1$ 次操作过后，所有的边都将被删去。此时，按数字从小到大的顺序，将数字 $1 \\sim n$ 所在的结点编号依次排列，就得到一个结点编号的排列 $P_i$。现在请你求出，在最优操作方案下能得到的**字典序最小**的 $P_i$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/flbxosct.png)\n\n如上图，蓝圈中的数字 $1 \\sim 5$ 一开始分别在结点②、①、③、⑤、④。按照 (1)(4)(3)(2) 的顺序删去所有边，树变为下图。按数字顺序得到的结点编号排列为①③④②⑤，该排列是所有可能的结果中字典序最小的。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tu338qm9.png)", "inputFormat": "**本题输入包含多组测试数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组测试数据：\n\n第一行一个整数 $n$，表示树的大小。\n\n第二行 $n$ 个整数，第 $i (1 \\leq i \\leq n)$ 个整数表示数字 $i$ 初始时所在的结点编号。\n\n接下来 $n - 1$ 行每行两个整数 $x$, $y$，表示一条连接 $x$ 号结点与 $y$ 号结点的边。", "outputFormat": "对于每组测试数据，输出一行共 $n$ 个用空格隔开的整数，表示最优操作方案下所能得到的字典序最小的 $P_i$。", "hint": "【数据范围】\n\n| 测试点编号 | $n \\leq$ | 特殊性质 |\n| :----------- | :----------- | :----------- |\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 4$ | $160$ | 树的形态是一条链 |\n| $5 \\sim 7$ | $2000$ | 同上 |\n| $8 \\sim 9$ | $160$ | 存在度数为 $n - 1$ 的结点 |\n| $10 \\sim 12$ | $2000$ | 同上 |\n| $13 \\sim 16$ | $160$ | 无 |\n| $17 \\sim 20$ | $2000$ | 无 |\n\n对于所有测试点：$1 \\leq T \\leq 10$，保证给出的是一个树。", "locale": "zh-CN"}}}
{"pid": "P5660", "type": "P", "difficulty": 1, "samples": [["00010100", "2"], ["11111111", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "2019", "CSP-J 入门级"], "title": "[CSP-J 2019] 数字游戏", "background": "", "description": "小 K 同学向小 P 同学发送了一个长度为 $8$ 的 **01 字符串**来玩数字游戏，小 P 同学想要知道字符串中究竟有多少个 $1$。\n\n注意：01 字符串为每一个字符是 $0$ 或者 $1$ 的字符串，如 `101` 为一个长度为 $3$ 的 01 字符串。 ", "inputFormat": "输入文件只有一行，一个长度为 $8$ 的 01 字符串 $s$。", "outputFormat": "输出文件只有一行，包含一个整数，即 01 字符串中**字符 $\\mathbf 1$** 的个数。", "hint": "**样例 1 说明**\n\n该 01 字符串中有 $2$ 个字符 $1$。 \n\n\n**样例 2 说明**\n\n该 01 字符串中有 $8$ 个字符 $1$。\n\n**数据规模与约定** \n\n- 对于 $20\\%$ 的数据，保证输入的字符全部为 $0$。\n- 对于 $100\\%$ 的数据，输入只可能包含字符 $0$ 和字符 $1$，字符串长度固定为 $8$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019] Number Game", "background": "", "description": "Student K sent Student P a **01 string** of length $8$ to play a number game. Student P wants to know how many $1$’s are in the string.\n\nNote: A 01 string is a string where every character is $0$ or $1$. For example, `101` is a 01 string of length $3$.", "inputFormat": "The input file contains only one line: a 01 string $s$ of length $8$.", "outputFormat": "The output file contains only one line containing an integer, which is the number of **character $\\mathbf 1$** in the 01 string.", "hint": "**Sample 1 Explanation**\n\nThere are $2$ characters $1$ in this 01 string.\n\n**Sample 2 Explanation**\n\nThere are $8$ characters $1$ in this 01 string.\n\n**Constraints**\n\n- For $20\\%$ of the testdata, all input characters are guaranteed to be $0$.\n- For $100\\%$ of the testdata, the input can only contain character $0$ and character $1$, and the string length is fixed at $8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019] 数字游戏", "background": "", "description": "小 K 同学向小 P 同学发送了一个长度为 $8$ 的 **01 字符串**来玩数字游戏，小 P 同学想要知道字符串中究竟有多少个 $1$。\n\n注意：01 字符串为每一个字符是 $0$ 或者 $1$ 的字符串，如 `101` 为一个长度为 $3$ 的 01 字符串。 ", "inputFormat": "输入文件只有一行，一个长度为 $8$ 的 01 字符串 $s$。", "outputFormat": "输出文件只有一行，包含一个整数，即 01 字符串中**字符 $\\mathbf 1$** 的个数。", "hint": "**样例 1 说明**\n\n该 01 字符串中有 $2$ 个字符 $1$。 \n\n\n**样例 2 说明**\n\n该 01 字符串中有 $8$ 个字符 $1$。\n\n**数据规模与约定** \n\n- 对于 $20\\%$ 的数据，保证输入的字符全部为 $0$。\n- 对于 $100\\%$ 的数据，输入只可能包含字符 $0$ 和字符 $1$，字符串长度固定为 $8$。", "locale": "zh-CN"}}}
{"pid": "P5661", "type": "P", "difficulty": 2, "samples": [["6\n0 10 3\n1 5 46\n0 12 50\n1 3 96\n0 5 110\n1 6 135", "36"], ["6\n0 5 1\n0 20 16\n0 7 23\n1 18 31\n1 4 38\n1 7 68 ", "32"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "2019", "队列", "CSP-J 入门级"], "title": "[CSP-J 2019] 公交换乘", "background": "", "description": "著名旅游城市 B 市为了鼓励大家采用公共交通方式出行，推出了一种地铁换乘公交车的优惠方案：\n1. 在搭乘一次地铁后可以获得一张优惠票，有效期为 45 分钟，在有效期内可以消耗这张优惠票，免费搭乘一次票价不超过地铁票价的公交车。在有效期内指开始乘公交车的时间与开始乘地铁的时间之差小于等于 45 分钟，即：\n$t_{bus} - t_{subway} \\leq 45$。\n2. 搭乘地铁获得的优惠票可以累积，即可以连续搭乘若干次地铁后再连续使用优惠票搭乘公交车。\n3. 搭乘公交车时，如果可以使用优惠票一定会使用优惠票；如果有多张优惠票满足条件，则优先消耗获得最早的优惠票。\n\n现在你得到了小轩最近的公共交通出行记录，你能帮他算算他的花费吗?", "inputFormat": "输入文件的第一行包含一个正整数 $n$，代表乘车记录的数量。\n\n接下来的 $n$ 行，每行包含 3 个整数，相邻两数之间以一个空格分隔。第 $i$ 行的第 1 个整数代表第 $i$ 条记录乘坐的交通工具，0 代表地铁，1 代表公交车；第 2 个整数代表第 $i$ 条记录乘车的票价 $price_i$ ；第三个整数代表第 $i$ 条记录开始乘车的时间 $t_i$（距 0 时刻的分钟数）。\n\n我们保证出行记录是按照开始乘车的时间顺序给出的，且不会有两次乘车记录出现在同一分钟。", "outputFormat": "输出文件有一行，包含一个正整数，代表小轩出行的总花费。", "hint": "**样例 1 说明**\n\n第一条记录，在第 3 分钟花费 10 元乘坐地铁。\n\n第二条记录，在第 46 分钟乘坐公交车，可以使用第一条记录中乘坐地铁获得的优惠票，因此没有花费。\n\n第三条记录，在第 50 分钟花费 12 元乘坐地铁。\n\n第四条记录，在第 96 分钟乘坐公交车，由于距离第三条记录中乘坐地铁已超过 45 分钟，所以优惠票已失效，花费 3 元乘坐公交车。\n\n第五条记录，在第 110 分钟花费 5 元乘坐地铁。\n\n第六条记录，在第 135 分钟乘坐公交车，由于此时手中只有第五条记录中乘坐地铁获得的优惠票有效，而本次公交车的票价为 6 元，高于第五条记录中地铁的票价 5 元，所以不能使用优惠票，花费 6 元乘坐公交车。\n\n总共花费 36 元。 \n\n**样例 2 说明**\n\n第一条记录，在第 1 分钟花费 5 元乘坐地铁。\n\n第二条记录，在第 16 分钟花费 20 元乘坐地铁。\n\n第三条记录，在第 23 分钟花费 7 元乘坐地铁。\n\n第四条记录，在第 31 分钟乘坐公交车，此时只有第二条记录中乘坐的地铁票价高于本次公交车票价，所以使用第二条记录中乘坐地铁获得的优惠票。\n\n第五条记录，在第 38 分钟乘坐公交车，此时第一条和第三条记录中乘坐地铁获得的优惠票都可以使用，使用获得最早的优惠票，即第一条记录中乘坐地铁获得的优惠票。\n\n第六条记录，在第 68 分钟乘坐公交车，使用第三条记录中乘坐地铁获得的优惠票。\n\n总共花费 32 元。 \n\n\n**数据规模与约定**\n\n对于 $30\\%$ 的数据，$n \\leq 1000$，$t_i \\leq 10^6$。\n\n另有 $15\\%$ 的数据，$t_i \\leq 10^7$，所有 $price_i$ 相等。\n\n另有 $15\\%$ 的数据，$t_i \\leq 10^9$，所有 $price_i$ 相等。\n\n对于 $100\\%$ 的数据，$n \\leq 10^5$，$t_i \\leq 10^9$，$1 \\leq price_i \\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019] Public Transport Transfer", "background": "", "description": "Famous tourist city B, in order to encourage everyone to travel by public transport, has introduced a discount plan for transferring from the subway to the bus:\n\n1. After taking the subway once, you can obtain a discount ticket with a validity period of 45 minutes. Within the validity period, you may use this discount ticket to take one bus ride for free, as long as the bus fare does not exceed the subway fare. “Within the validity period” means that the difference between the start time of the bus ride and the start time of the subway ride is no more than 45 minutes, i.e. $t_{bus} - t_{subway} \\leq 45$.\n2. Discount tickets obtained from taking the subway can be accumulated, i.e. you can take the subway several times in a row and then use the discount tickets to take buses several times in a row.\n3. When taking a bus, if a discount ticket can be used, it will definitely be used. If multiple discount tickets satisfy the conditions, the earliest obtained discount ticket will be used first.\n\nNow you have obtained Xiaoxuan’s recent public transport travel records. Can you help compute his total cost?", "inputFormat": "The first line of the input file contains a positive integer $n$, representing the number of travel records.\n\nThe next $n$ lines each contain 3 integers, separated by a single space between adjacent numbers. In the $i$-th line, the first integer indicates the mode of transport for the $i$-th record: 0 represents subway, and 1 represents bus. The second integer indicates the fare for the $i$-th ride, $price_i$. The third integer indicates the start time of the $i$-th ride, $t_i$ (in minutes since time 0).\n\nIt is guaranteed that the travel records are given in increasing order of start time, and no two ride records occur in the same minute.", "outputFormat": "The output file contains one line with a positive integer, representing Xiaoxuan’s total travel cost.", "hint": "**Sample 1 Explanation**\n\nRecord 1: At minute 3, pay 10 yuan to take the subway.\n\nRecord 2: At minute 46, take the bus. You can use the discount ticket obtained from Record 1, so there is no cost.\n\nRecord 3: At minute 50, pay 12 yuan to take the subway.\n\nRecord 4: At minute 96, take the bus. Since it has been more than 45 minutes since the subway ride in Record 3, the discount ticket is no longer valid, so pay 3 yuan to take the bus.\n\nRecord 5: At minute 110, pay 5 yuan to take the subway.\n\nRecord 6: At minute 135, take the bus. At this time, only the discount ticket obtained from Record 5 is valid, but the bus fare is 6 yuan, which is higher than the subway fare 5 yuan from Record 5, so the discount ticket cannot be used. Pay 6 yuan to take the bus.\n\nThe total cost is 36 yuan.\n\n**Sample 2 Explanation**\n\nRecord 1: At minute 1, pay 5 yuan to take the subway.\n\nRecord 2: At minute 16, pay 20 yuan to take the subway.\n\nRecord 3: At minute 23, pay 7 yuan to take the subway.\n\nRecord 4: At minute 31, take the bus. At this time, only the subway fare in Record 2 is higher than the bus fare for this ride, so use the discount ticket obtained from Record 2.\n\nRecord 5: At minute 38, take the bus. At this time, both the discount tickets obtained from Record 1 and Record 3 can be used. Use the earliest obtained discount ticket, i.e. the one from Record 1.\n\nRecord 6: At minute 68, take the bus. Use the discount ticket obtained from Record 3.\n\nThe total cost is 32 yuan.\n\n**Constraints**\n\nFor $30\\%$ of the testdata, $n \\leq 1000$, $t_i \\leq 10^6$.\n\nFor another $15\\%$ of the testdata, $t_i \\leq 10^7$, and all $price_i$ are equal.\n\nFor another $15\\%$ of the testdata, $t_i \\leq 10^9$, and all $price_i$ are equal.\n\nFor $100\\%$ of the testdata, $n \\leq 10^5$, $t_i \\leq 10^9$, $1 \\leq price_i \\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019] 公交换乘", "background": "", "description": "著名旅游城市 B 市为了鼓励大家采用公共交通方式出行，推出了一种地铁换乘公交车的优惠方案：\n1. 在搭乘一次地铁后可以获得一张优惠票，有效期为 45 分钟，在有效期内可以消耗这张优惠票，免费搭乘一次票价不超过地铁票价的公交车。在有效期内指开始乘公交车的时间与开始乘地铁的时间之差小于等于 45 分钟，即：\n$t_{bus} - t_{subway} \\leq 45$。\n2. 搭乘地铁获得的优惠票可以累积，即可以连续搭乘若干次地铁后再连续使用优惠票搭乘公交车。\n3. 搭乘公交车时，如果可以使用优惠票一定会使用优惠票；如果有多张优惠票满足条件，则优先消耗获得最早的优惠票。\n\n现在你得到了小轩最近的公共交通出行记录，你能帮他算算他的花费吗?", "inputFormat": "输入文件的第一行包含一个正整数 $n$，代表乘车记录的数量。\n\n接下来的 $n$ 行，每行包含 3 个整数，相邻两数之间以一个空格分隔。第 $i$ 行的第 1 个整数代表第 $i$ 条记录乘坐的交通工具，0 代表地铁，1 代表公交车；第 2 个整数代表第 $i$ 条记录乘车的票价 $price_i$ ；第三个整数代表第 $i$ 条记录开始乘车的时间 $t_i$（距 0 时刻的分钟数）。\n\n我们保证出行记录是按照开始乘车的时间顺序给出的，且不会有两次乘车记录出现在同一分钟。", "outputFormat": "输出文件有一行，包含一个正整数，代表小轩出行的总花费。", "hint": "**样例 1 说明**\n\n第一条记录，在第 3 分钟花费 10 元乘坐地铁。\n\n第二条记录，在第 46 分钟乘坐公交车，可以使用第一条记录中乘坐地铁获得的优惠票，因此没有花费。\n\n第三条记录，在第 50 分钟花费 12 元乘坐地铁。\n\n第四条记录，在第 96 分钟乘坐公交车，由于距离第三条记录中乘坐地铁已超过 45 分钟，所以优惠票已失效，花费 3 元乘坐公交车。\n\n第五条记录，在第 110 分钟花费 5 元乘坐地铁。\n\n第六条记录，在第 135 分钟乘坐公交车，由于此时手中只有第五条记录中乘坐地铁获得的优惠票有效，而本次公交车的票价为 6 元，高于第五条记录中地铁的票价 5 元，所以不能使用优惠票，花费 6 元乘坐公交车。\n\n总共花费 36 元。 \n\n**样例 2 说明**\n\n第一条记录，在第 1 分钟花费 5 元乘坐地铁。\n\n第二条记录，在第 16 分钟花费 20 元乘坐地铁。\n\n第三条记录，在第 23 分钟花费 7 元乘坐地铁。\n\n第四条记录，在第 31 分钟乘坐公交车，此时只有第二条记录中乘坐的地铁票价高于本次公交车票价，所以使用第二条记录中乘坐地铁获得的优惠票。\n\n第五条记录，在第 38 分钟乘坐公交车，此时第一条和第三条记录中乘坐地铁获得的优惠票都可以使用，使用获得最早的优惠票，即第一条记录中乘坐地铁获得的优惠票。\n\n第六条记录，在第 68 分钟乘坐公交车，使用第三条记录中乘坐地铁获得的优惠票。\n\n总共花费 32 元。 \n\n\n**数据规模与约定**\n\n对于 $30\\%$ 的数据，$n \\leq 1000$，$t_i \\leq 10^6$。\n\n另有 $15\\%$ 的数据，$t_i \\leq 10^7$，所有 $price_i$ 相等。\n\n另有 $15\\%$ 的数据，$t_i \\leq 10^9$，所有 $price_i$ 相等。\n\n对于 $100\\%$ 的数据，$n \\leq 10^5$，$t_i \\leq 10^9$，$1 \\leq price_i \\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P5662", "type": "P", "difficulty": 4, "samples": [["6 1 100\n50\n20\n25\n20\n25\n50", "305"], ["3 3 100\n10 20 15\n15 17 13\n15 25 16", "217"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2019", "背包 DP", "CSP-J 入门级"], "title": "[CSP-J 2019] 纪念品", "background": "", "description": "小伟突然获得一种超能力，他知道未来 $T$ 天 $N$ 种纪念品每天的价格。某个纪念品的价格是指购买一个该纪念品所需的金币数量，以及卖出一个该纪念品换回的金币数量。\n\n每天，小伟可以进行以下两种交易**无限次**：\n1. 任选一个纪念品，若手上有足够金币，以当日价格购买该纪念品；\n2. 卖出持有的任意一个纪念品，以当日价格换回金币。\n\n每天卖出纪念品换回的金币可以**立即**用于购买纪念品，当日购买的纪念品也可以**当日卖出**换回金币。当然，一直持有纪念品也是可以的。\n\n$T$ 天之后，小伟的超能力消失。因此他一定会在第 $T$ 天卖出**所有**纪念品换回金币。\n\n小伟现在有 $M$ 枚金币，他想要在超能力消失后拥有尽可能多的金币。 \n ", "inputFormat": "第一行包含三个正整数 $T, N, M$，相邻两数之间以一个空格分开，分别代表未来天数 $T$，纪念品数量 $N$，小伟现在拥有的金币数量 $M$。\n\n接下来 $T$ 行，每行包含 $N$ 个正整数，相邻两数之间以一个空格分隔。第 $i$ 行的 $N$ 个正整数分别为 $P_{i,1},P_{i,2},\\dots,P_{i,N}$，其中 $P_{i,j}$ 表示第 $i$ 天第 $j$ 种纪念品的价格。", "outputFormat": "输出仅一行，包含一个正整数，表示小伟在超能力消失后最多能拥有的金币数量。\n ", "hint": "**样例 1 说明**\n\n最佳策略是：\n\n第二天花光所有 $100$ 枚金币买入 $5$ 个纪念品 $1$；\n\n第三天卖出 $5$ 个纪念品 $1$，获得金币 $125$ 枚；\n\n第四天买入 $6$ 个纪念品 $1$，剩余 $5$ 枚金币；\n\n第六天必须卖出所有纪念品换回 $300$ 枚金币，第四天剩余 $5$ 枚金币，共 $305$ 枚金币。\n\n超能力消失后，小伟最多拥有 $305$ 枚金币。\n\n**样例 2 说明**\n\n最佳策略是：\n\n第一天花光所有金币买入 $10$ 个纪念品 $1$；\n\n第二天卖出全部纪念品 $1$ 得到 $150$ 枚金币并买入 $8$ 个纪念品 $2$ 和 $1$ 个纪念品 $3$，剩余 $1$ 枚金币；\n\n第三天必须卖出所有纪念品换回 $216$ 枚金币，第二天剩余 $1$ 枚金币，共 $217$ 枚金币。\n\n超能力消失后，小伟最多拥有 $217$ 枚金币。\n\n\n**数据规模与约定**\n\n对于 $10\\%$ 的数据，$T = 1$。\n\n对于 $30\\%$ 的数据，$T \\leq 4, N \\leq 4, M \\leq 100$，所有价格 $10 \\leq P_{i,j} \\leq 100$。\n\n另有 $15\\%$ 的数据，$T \\leq 100, N = 1$。\n\n另有 $15\\%$ 的数据，$T = 2, N \\leq 100$。\n\n对于 $100\\%$ 的数据，$T \\leq 100, N \\leq 100, M \\leq 10^3$，所有价格 $1 \\leq P_{i,j} \\leq 10^4$，数据保证任意时刻，小伟手上的金币数不可能超过 $10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019] Souvenirs", "background": "", "description": "Xiaowei suddenly gains a superpower: he knows the prices of $N$ kinds of souvenirs for each of the next $T$ days. The price of a souvenir means the number of coins needed to buy one unit of that souvenir, and also the number of coins you get back by selling one unit of that souvenir.\n\nEach day, Xiaowei can perform the following two types of transactions an **unlimited** number of times:\n1. Choose any souvenir; if he has enough coins, buy that souvenir at today’s price.\n2. Sell any souvenir he is holding, and exchange it for coins at today’s price.\n\nThe coins obtained from selling souvenirs can be used **immediately** to buy souvenirs. Souvenirs bought on the same day can also be **sold on the same day** for coins. Of course, he may also keep holding souvenirs.\n\nAfter $T$ days, Xiaowei’s superpower disappears. Therefore, he will definitely sell **all** souvenirs on day $T$ to get coins back.\n\nXiaowei currently has $M$ coins. He wants to have as many coins as possible after his superpower disappears.", "inputFormat": "The first line contains three positive integers $T, N, M$, separated by single spaces, representing the number of future days $T$, the number of souvenir types $N$, and the number of coins Xiaowei currently has $M$.\n\nThe next $T$ lines each contain $N$ positive integers, separated by single spaces. On line $i$, the $N$ integers are $P_{i,1}, P_{i,2}, \\dots, P_{i,N}$, where $P_{i,j}$ denotes the price of the $j$-th type of souvenir on day $i$.", "outputFormat": "Output only one line containing one positive integer, representing the maximum number of coins Xiaowei can have after his superpower disappears.", "hint": "**Sample 1 Explanation**\n\nThe best strategy is:\n\nOn day 2, spend all $100$ coins to buy $5$ units of souvenir $1$.\n\nOn day 3, sell the $5$ units of souvenir $1$ to get $125$ coins.\n\nOn day 4, buy $6$ units of souvenir $1$, with $5$ coins remaining.\n\nOn day 6, you must sell all souvenirs to get $300$ coins back; together with the $5$ coins left from day 4, this is a total of $305$ coins.\n\nAfter the superpower disappears, Xiaowei can have at most $305$ coins.\n\n**Sample 2 Explanation**\n\nThe best strategy is:\n\nOn day 1, spend all coins to buy $10$ units of souvenir $1$.\n\nOn day 2, sell all units of souvenir $1$ to get $150$ coins, then buy $8$ units of souvenir $2$ and $1$ unit of souvenir $3$, with $1$ coin remaining.\n\nOn day 3, you must sell all souvenirs to get $216$ coins back; together with the $1$ coin left from day 2, this is a total of $217$ coins.\n\nAfter the superpower disappears, Xiaowei can have at most $217$ coins.\n\n**Constraints**\n\nFor $10\\%$ of the testdata, $T = 1$.\n\nFor $30\\%$ of the testdata, $T \\leq 4$, $N \\leq 4$, $M \\leq 100$, and all prices satisfy $10 \\leq P_{i,j} \\leq 100$.\n\nFor another $15\\%$ of the testdata, $T \\leq 100$ and $N = 1$.\n\nFor another $15\\%$ of the testdata, $T = 2$ and $N \\leq 100$.\n\nFor $100\\%$ of the testdata, $T \\leq 100$, $N \\leq 100$, $M \\leq 10^3$, and all prices satisfy $1 \\leq P_{i,j} \\leq 10^4$. The testdata guarantees that at any moment, the number of coins Xiaowei has cannot exceed $10^4$.\n\n# Input Format\n\n\n\n# Output Format\n\n\n\n# Hint\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019] 纪念品", "background": "", "description": "小伟突然获得一种超能力，他知道未来 $T$ 天 $N$ 种纪念品每天的价格。某个纪念品的价格是指购买一个该纪念品所需的金币数量，以及卖出一个该纪念品换回的金币数量。\n\n每天，小伟可以进行以下两种交易**无限次**：\n1. 任选一个纪念品，若手上有足够金币，以当日价格购买该纪念品；\n2. 卖出持有的任意一个纪念品，以当日价格换回金币。\n\n每天卖出纪念品换回的金币可以**立即**用于购买纪念品，当日购买的纪念品也可以**当日卖出**换回金币。当然，一直持有纪念品也是可以的。\n\n$T$ 天之后，小伟的超能力消失。因此他一定会在第 $T$ 天卖出**所有**纪念品换回金币。\n\n小伟现在有 $M$ 枚金币，他想要在超能力消失后拥有尽可能多的金币。 \n ", "inputFormat": "第一行包含三个正整数 $T, N, M$，相邻两数之间以一个空格分开，分别代表未来天数 $T$，纪念品数量 $N$，小伟现在拥有的金币数量 $M$。\n\n接下来 $T$ 行，每行包含 $N$ 个正整数，相邻两数之间以一个空格分隔。第 $i$ 行的 $N$ 个正整数分别为 $P_{i,1},P_{i,2},\\dots,P_{i,N}$，其中 $P_{i,j}$ 表示第 $i$ 天第 $j$ 种纪念品的价格。", "outputFormat": "输出仅一行，包含一个正整数，表示小伟在超能力消失后最多能拥有的金币数量。\n ", "hint": "**样例 1 说明**\n\n最佳策略是：\n\n第二天花光所有 $100$ 枚金币买入 $5$ 个纪念品 $1$；\n\n第三天卖出 $5$ 个纪念品 $1$，获得金币 $125$ 枚；\n\n第四天买入 $6$ 个纪念品 $1$，剩余 $5$ 枚金币；\n\n第六天必须卖出所有纪念品换回 $300$ 枚金币，第四天剩余 $5$ 枚金币，共 $305$ 枚金币。\n\n超能力消失后，小伟最多拥有 $305$ 枚金币。\n\n**样例 2 说明**\n\n最佳策略是：\n\n第一天花光所有金币买入 $10$ 个纪念品 $1$；\n\n第二天卖出全部纪念品 $1$ 得到 $150$ 枚金币并买入 $8$ 个纪念品 $2$ 和 $1$ 个纪念品 $3$，剩余 $1$ 枚金币；\n\n第三天必须卖出所有纪念品换回 $216$ 枚金币，第二天剩余 $1$ 枚金币，共 $217$ 枚金币。\n\n超能力消失后，小伟最多拥有 $217$ 枚金币。\n\n\n**数据规模与约定**\n\n对于 $10\\%$ 的数据，$T = 1$。\n\n对于 $30\\%$ 的数据，$T \\leq 4, N \\leq 4, M \\leq 100$，所有价格 $10 \\leq P_{i,j} \\leq 100$。\n\n另有 $15\\%$ 的数据，$T \\leq 100, N = 1$。\n\n另有 $15\\%$ 的数据，$T = 2, N \\leq 100$。\n\n对于 $100\\%$ 的数据，$T \\leq 100, N \\leq 100, M \\leq 10^3$，所有价格 $1 \\leq P_{i,j} \\leq 10^4$，数据保证任意时刻，小伟手上的金币数不可能超过 $10^4$。", "locale": "zh-CN"}}}
{"pid": "P5663", "type": "P", "difficulty": 4, "samples": [["3 2 6\n1 2\n2 3\n1 1\n2 1\n3 1\n1 2\n2 2\n3 2", "No\nYes\nNo\nYes\nNo\nYes"], ["5 5 5\n1 2\n2 3\n3 4\n4 5\n1 5\n1 1\n1 2\n1 3\n1 4\n1 5", "No\nYes\nNo\nYes\nYes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "广度优先搜索 BFS", "最短路", "CSP-J 入门级"], "title": "[CSP-J 2019] 加工零件", "background": "", "description": "凯凯的工厂正在有条不紊地生产一种神奇的零件，神奇的零件的生产过程自然也很神奇。工厂里有 $n$ 位工人，工人们从 $1 \\sim n$ 编号。某些工人之间存在双向的零件传送带。保证每两名工人之间最多只存在一条传送带。\n\n如果 $x$ 号工人想生产一个被加工到第 $L\\,(L \\gt 1)$ 阶段的零件，则**所有**与 $x$ 号工人有传送带**直接**相连的工人，都需要生产一个被加工到第 $L - 1$ 阶段的零件（但 $x$ 号工人自己**无需**生产第 $L - 1$ 阶段的零件）。\n\n如果 $x$ 号工人想生产一个被加工到第 $1$ 阶段的零件，则**所有**与 $x$ 号工人有传送带**直接**相连的工人，都需要为 $x$ 号工人提供一个原材料。\n\n轩轩是 $1$ 号工人。现在给出 $q$ 张工单，第 $i$ 张工单表示编号为 $a_i$ 的工人想生产一个第 $L_i$ 阶段的零件。轩轩想知道对于每张工单，他是否需要给别人提供原材料。他知道聪明的你一定可以帮他计算出来！", "inputFormat": "第一行三个正整数 $n$，$m$ 和 $q$，分别表示工人的数目、传送带的数目和工单的数目。\n\n接下来 $m$ 行，每行两个正整数 $u$ 和 $v$，表示编号为 $u$ 和 $v$ 的工人之间存在一条零件传输带。保证 $u \\neq v$。\n\n接下来 $q$ 行，每行两个正整数 $a$ 和 $L$，表示编号为 $a$ 的工人想生产一个第 $L$ 阶段的零件。", "outputFormat": "共 $q$ 行，每行一个字符串 `Yes` 或者 `No`。如果按照第 $i$ 张工单生产，需要编号为 1 的轩轩提供原材料，则在第 $i$ 行输出 `Yes`；否则在第 $i$ 行输出 `No`。", "hint": "**样例 1 说明**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5dbepjmh.png)\n\n编号为 1 的工人想生产第 1 阶段的零件，需要编号为 2 的工人提供原材料。\n\n编号为 2 的工人想生产第 1 阶段的零件，需要编号为 1 和 3 的工人提供原材料。\n\n编号为 3 的工人想生产第 1 阶段的零件，需要编号为 2 的工人提供原材料。\n\n编号为 1 的工人想生产第 2 阶段的零件，需要编号为 2 的工人生产第 1 阶段的零 件，需要编号为 1 和 3 的工人提供原材料。\n\n编号为 2 的工人想生产第 2 阶段的零件，需要编号为 1 和 3 的工人生产第 1 阶段的零件，他/她们都需要编号为 2 的工人提供原材料。\n\n编号为 3 的工人想生产第 2 阶段的零件，需要编号为 2 的工人生产第 1 阶段的零件，需要编号为 1 和 3 的工人提供原材料。\n\n**样例 2 说明**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tfom5z2s.png)\n\n编号为 1 的工人想生产第 1 阶段的零件，需要编号为 2 和 5 的工人提供原材料。\n\n编号为 1 的工人想生产第 2 阶段的零件，需要编号为 2 和 5 的工人生产第 1 阶段的零件，需要编号为 1,3,4 的工人提供原材料。\n\n编号为 1 的工人想生产第 3 阶段的零件，需要编号为 2 和 5 的工人生产第 2 阶段的零件，需要编号为 1,3,4 的工人生产第 1 阶段的零件，需要编号为 2,3,4,5 的工人提供原材料。\n\n编号为 1 的工人想生产第 4 阶段的零件，需要编号为 2 和 5 的工人生产第 3 阶段的零件，需要编号为 1,3,4 的工人生产第 2 阶段的零件，需要编号为 2,3,4,5 的工人生产第 1 阶段的零件，需要全部工人提供原材料。\n\n编号为 1 的工人想生产第 5 阶段的零件，需要编号为 2 和 5 的工人生产第 4 阶段的零件，需要编号为 1,3,4 的工人生产第 3 阶段的零件，需要编号为 2,3,4,5 的工人生产第 2 阶段的零件，需要全部工人生产第 1 阶段的零件，需要全部工人提供原材料。\n\n**数据规模与约定**\n\n共 $20$ 个测试点。\n\n对所有测试点保证 $1 \\leq u, v, a \\leq n$。\n\n测试点 $1\\sim4$，$1 \\leq n, m \\leq 1000$，$q = 3$，$L = 1$。\n\n测试点 $5\\sim8$，$1 \\leq n, m \\leq 1000$，$q = 3$，$1 \\leq L \\leq 10$。\n\n测试点 $9\\sim12$，$1 \\leq n, m, L \\leq 1000$，$1 \\leq q \\leq 100$。\n\n测试点 $13\\sim16$，$1 \\leq n, m, L \\leq 1000$，$1 \\leq q \\leq 10^5$。\n\n测试点 $17\\sim20$，$1 \\leq n, m, q \\leq 10^5$，$1 \\leq L \\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019] Processing Parts", "background": "", "description": "Kaikai’s factory is producing a magical part in an orderly way, and of course the production process is also magical. There are $n$ workers in the factory, numbered from $1 \\sim n$. Between some pairs of workers, there are two-way conveyor belts for transporting parts. It is guaranteed that there is at most one conveyor belt between any two workers.\n\nIf worker $x$ wants to produce a part processed to stage $L\\,(L \\gt 1)$, then **all** workers that are **directly** connected to worker $x$ by a conveyor belt need to produce a part processed to stage $L - 1$ (but worker $x$ himself/herself does **not** need to produce a stage $L - 1$ part).\n\nIf worker $x$ wants to produce a part processed to stage $1$, then **all** workers that are **directly** connected to worker $x$ by a conveyor belt need to provide worker $x$ with one raw material.\n\nXuanxuan is worker $1$. Now $q$ work orders are given. The $i$-th work order means that the worker numbered $a_i$ wants to produce a part at stage $L_i$. For each work order, Xuanxuan wants to know whether he needs to provide raw materials for others. He knows that smart you can help him compute it.", "inputFormat": "The first line contains three positive integers $n$, $m$, and $q$, representing the number of workers, the number of conveyor belts, and the number of work orders.\n\nThe next $m$ lines each contain two positive integers $u$ and $v$, indicating that there is a conveyor belt between worker $u$ and worker $v$. It is guaranteed that $u \\neq v$.\n\nThe next $q$ lines each contain two positive integers $a$ and $L$, indicating that worker $a$ wants to produce a part at stage $L$.", "outputFormat": "Output $q$ lines, each containing a string `Yes` or `No`. If producing according to the $i$-th work order requires Xuanxuan (worker $1$) to provide raw materials, output `Yes` on the $i$-th line; otherwise output `No`.", "hint": "**Sample 1 Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5dbepjmh.png)\n\nIf worker $1$ wants to produce a stage $1$ part, worker $2$ needs to provide raw materials.\n\nIf worker $2$ wants to produce a stage $1$ part, workers $1$ and $3$ need to provide raw materials.\n\nIf worker $3$ wants to produce a stage $1$ part, worker $2$ needs to provide raw materials.\n\nIf worker $1$ wants to produce a stage $2$ part, worker $2$ needs to produce a stage $1$ part, and workers $1$ and $3$ need to provide raw materials.\n\nIf worker $2$ wants to produce a stage $2$ part, workers $1$ and $3$ need to produce a stage $1$ part, and both of them need worker $2$ to provide raw materials.\n\nIf worker $3$ wants to produce a stage $2$ part, worker $2$ needs to produce a stage $1$ part, and workers $1$ and $3$ need to provide raw materials.\n\n**Sample 2 Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tfom5z2s.png)\n\nIf worker $1$ wants to produce a stage $1$ part, workers $2$ and $5$ need to provide raw materials.\n\nIf worker $1$ wants to produce a stage $2$ part, workers $2$ and $5$ need to produce a stage $1$ part, and workers $1,3,4$ need to provide raw materials.\n\nIf worker $1$ wants to produce a stage $3$ part, workers $2$ and $5$ need to produce a stage $2$ part, workers $1,3,4$ need to produce a stage $1$ part, and workers $2,3,4,5$ need to provide raw materials.\n\nIf worker $1$ wants to produce a stage $4$ part, workers $2$ and $5$ need to produce a stage $3$ part, workers $1,3,4$ need to produce a stage $2$ part, workers $2,3,4,5$ need to produce a stage $1$ part, and all workers need to provide raw materials.\n\nIf worker $1$ wants to produce a stage $5$ part, workers $2$ and $5$ need to produce a stage $4$ part, workers $1,3,4$ need to produce a stage $3$ part, workers $2,3,4,5$ need to produce a stage $2$ part, all workers need to produce a stage $1$ part, and all workers need to provide raw materials.\n\n**Constraints**\n\nThere are $20$ test points in total.\n\nFor all test points, it is guaranteed that $1 \\leq u, v, a \\leq n$.\n\nFor test points $1\\sim4$, $1 \\leq n, m \\leq 1000$, $q = 3$, $L = 1$.\n\nFor test points $5\\sim8$, $1 \\leq n, m \\leq 1000$, $q = 3$, $1 \\leq L \\leq 10$.\n\nFor test points $9\\sim12$, $1 \\leq n, m, L \\leq 1000$, $1 \\leq q \\leq 100$.\n\nFor test points $13\\sim16$, $1 \\leq n, m, L \\leq 1000$, $1 \\leq q \\leq 10^5$.\n\nFor test points $17\\sim20$, $1 \\leq n, m, q \\leq 10^5$, $1 \\leq L \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019] 加工零件", "background": "", "description": "凯凯的工厂正在有条不紊地生产一种神奇的零件，神奇的零件的生产过程自然也很神奇。工厂里有 $n$ 位工人，工人们从 $1 \\sim n$ 编号。某些工人之间存在双向的零件传送带。保证每两名工人之间最多只存在一条传送带。\n\n如果 $x$ 号工人想生产一个被加工到第 $L\\,(L \\gt 1)$ 阶段的零件，则**所有**与 $x$ 号工人有传送带**直接**相连的工人，都需要生产一个被加工到第 $L - 1$ 阶段的零件（但 $x$ 号工人自己**无需**生产第 $L - 1$ 阶段的零件）。\n\n如果 $x$ 号工人想生产一个被加工到第 $1$ 阶段的零件，则**所有**与 $x$ 号工人有传送带**直接**相连的工人，都需要为 $x$ 号工人提供一个原材料。\n\n轩轩是 $1$ 号工人。现在给出 $q$ 张工单，第 $i$ 张工单表示编号为 $a_i$ 的工人想生产一个第 $L_i$ 阶段的零件。轩轩想知道对于每张工单，他是否需要给别人提供原材料。他知道聪明的你一定可以帮他计算出来！", "inputFormat": "第一行三个正整数 $n$，$m$ 和 $q$，分别表示工人的数目、传送带的数目和工单的数目。\n\n接下来 $m$ 行，每行两个正整数 $u$ 和 $v$，表示编号为 $u$ 和 $v$ 的工人之间存在一条零件传输带。保证 $u \\neq v$。\n\n接下来 $q$ 行，每行两个正整数 $a$ 和 $L$，表示编号为 $a$ 的工人想生产一个第 $L$ 阶段的零件。", "outputFormat": "共 $q$ 行，每行一个字符串 `Yes` 或者 `No`。如果按照第 $i$ 张工单生产，需要编号为 1 的轩轩提供原材料，则在第 $i$ 行输出 `Yes`；否则在第 $i$ 行输出 `No`。", "hint": "**样例 1 说明**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5dbepjmh.png)\n\n编号为 1 的工人想生产第 1 阶段的零件，需要编号为 2 的工人提供原材料。\n\n编号为 2 的工人想生产第 1 阶段的零件，需要编号为 1 和 3 的工人提供原材料。\n\n编号为 3 的工人想生产第 1 阶段的零件，需要编号为 2 的工人提供原材料。\n\n编号为 1 的工人想生产第 2 阶段的零件，需要编号为 2 的工人生产第 1 阶段的零 件，需要编号为 1 和 3 的工人提供原材料。\n\n编号为 2 的工人想生产第 2 阶段的零件，需要编号为 1 和 3 的工人生产第 1 阶段的零件，他/她们都需要编号为 2 的工人提供原材料。\n\n编号为 3 的工人想生产第 2 阶段的零件，需要编号为 2 的工人生产第 1 阶段的零件，需要编号为 1 和 3 的工人提供原材料。\n\n**样例 2 说明**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tfom5z2s.png)\n\n编号为 1 的工人想生产第 1 阶段的零件，需要编号为 2 和 5 的工人提供原材料。\n\n编号为 1 的工人想生产第 2 阶段的零件，需要编号为 2 和 5 的工人生产第 1 阶段的零件，需要编号为 1,3,4 的工人提供原材料。\n\n编号为 1 的工人想生产第 3 阶段的零件，需要编号为 2 和 5 的工人生产第 2 阶段的零件，需要编号为 1,3,4 的工人生产第 1 阶段的零件，需要编号为 2,3,4,5 的工人提供原材料。\n\n编号为 1 的工人想生产第 4 阶段的零件，需要编号为 2 和 5 的工人生产第 3 阶段的零件，需要编号为 1,3,4 的工人生产第 2 阶段的零件，需要编号为 2,3,4,5 的工人生产第 1 阶段的零件，需要全部工人提供原材料。\n\n编号为 1 的工人想生产第 5 阶段的零件，需要编号为 2 和 5 的工人生产第 4 阶段的零件，需要编号为 1,3,4 的工人生产第 3 阶段的零件，需要编号为 2,3,4,5 的工人生产第 2 阶段的零件，需要全部工人生产第 1 阶段的零件，需要全部工人提供原材料。\n\n**数据规模与约定**\n\n共 $20$ 个测试点。\n\n对所有测试点保证 $1 \\leq u, v, a \\leq n$。\n\n测试点 $1\\sim4$，$1 \\leq n, m \\leq 1000$，$q = 3$，$L = 1$。\n\n测试点 $5\\sim8$，$1 \\leq n, m \\leq 1000$，$q = 3$，$1 \\leq L \\leq 10$。\n\n测试点 $9\\sim12$，$1 \\leq n, m, L \\leq 1000$，$1 \\leq q \\leq 100$。\n\n测试点 $13\\sim16$，$1 \\leq n, m, L \\leq 1000$，$1 \\leq q \\leq 10^5$。\n\n测试点 $17\\sim20$，$1 \\leq n, m, q \\leq 10^5$，$1 \\leq L \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5664", "type": "P", "difficulty": 5, "samples": [["2 3 \n1 0 1\n0 1 1", "3"], ["3 3\n1 2 3\n4 5 0\n6 0 0", "190"], ["5 5\n1 0 0 1 1\n0 1 0 1 0\n1 1 1 1 0\n1 0 1 0 1\n0 1 1 0 1", "742"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "数学", "2019", "容斥原理", "CSP-S 提高级"], "title": "[CSP-S 2019] Emiya 家今天的饭", "background": "", "description": "Emiya 是个擅长做菜的高中生，他共掌握 $n$ 种**烹饪方法**，且会使用 $m$ 种**主要食材**做菜。为了方便叙述，我们对烹饪方法从 $1 \\sim n$ 编号，对主要食材从 $1 \\sim m$ 编号。\n\nEmiya 做的每道菜都将使用**恰好一种**烹饪方法与**恰好一种**主要食材。更具体地，Emiya 会做 $a_{i,j}$ 道不同的使用烹饪方法 $i$ 和主要食材 $j$ 的菜（$1 \\leq i \\leq n$、$1 \\leq j \\leq m$），这也意味着 Emiya 总共会做 $\\sum\\limits_{i=1}^{n} \\sum\\limits_{j=1}^{m} a_{i,j}$ 道不同的菜。\n\nEmiya 今天要准备一桌饭招待 Yazid 和 Rin 这对好朋友，然而三个人对菜的搭配有不同的要求，更具体地，对于一种包含 $k$ 道菜的搭配方案而言：\n- Emiya 不会让大家饿肚子，所以将做**至少一道菜**，即 $k \\geq 1$\n- Rin 希望品尝不同烹饪方法做出的菜，因此她要求每道菜的**烹饪方法互不相同**\n- Yazid 不希望品尝太多同一食材做出的菜，因此他要求每种**主要食材**至多在**一半**的菜（即 $\\lfloor \\frac{k}{2} \\rfloor$ 道菜）中被使用\n\n这里的 $\\lfloor x \\rfloor$ 为下取整函数，表示不超过 $x$ 的最大整数。\n\n这些要求难不倒 Emiya，但他想知道共有多少种不同的符合要求的搭配方案。两种方案不同，当且仅当存在至少一道菜在一种方案中出现，而不在另一种方案中出现。\n\nEmiya 找到了你，请你帮他计算，你只需要告诉他符合所有要求的搭配方案数对质数 $998,244,353$ 取模的结果。", "inputFormat": "第 1 行两个用单个空格隔开的整数 $n,m$。\n\n第 2 行至第 $n + 1$ 行，每行 $m$ 个用单个空格隔开的整数，其中第 $i + 1$ 行的 $m$ 个数依次为 $a_{i,1}, a_{i,2}, \\cdots, a_{i,m}$。", "outputFormat": "仅一行一个整数，表示所求方案数对 $998,244,353$ 取模的结果。", "hint": "【样例 1 解释】\n\n由于在这个样例中，对于每组 $i, j$，Emiya 都最多只会做一道菜，因此我们直接通过给出烹饪方法、主要食材的编号来描述一道菜。\n\n符合要求的方案包括：\n- 做一道用烹饪方法 1、主要食材 1 的菜和一道用烹饪方法 2、主要食材 2 的菜\n- 做一道用烹饪方法 1、主要食材 1 的菜和一道用烹饪方法 2、主要食材 3 的菜\n- 做一道用烹饪方法 1、主要食材 3 的菜和一道用烹饪方法 2、主要食材 2 的菜\n\n因此输出结果为 $3 \\bmod 998,244,353 = 3$。 需要注意的是，所有只包含一道菜的方案都是不符合要求的，因为唯一的主要食材在超过一半的菜中出现，这不满足 Yazid 的要求。\n\n【样例 2 解释】\n\nEmiya 必须至少做 $2$ 道菜。\n\n做 $2$ 道菜的符合要求的方案数为 $100$。\n\n做 $3$ 道菜的符合要求的方案数为 $90$。\n\n因此符合要求的方案数为 $100 + 90 = 190$。\n\n【数据范围】\n\n::cute-table{tuack}\n\n| 测试点编号  |  $n=$ | $m=$  | $a_{i,j}<$  |\n|:-:|:-:|:-:|:-:|\n| $1$  | $2$ | $2$  | $2$  |\n| $2$  | ^  | $3$  | ^  |\n| $3$  |  $5$ | $2$  | ^  |\n| $4$  | ^  | $3$  |  ^ |\n| $5$  | $10$  | $2$  |^   |\n| $6$  | ^  | $3$  |  ^ |\n| $7$  | $10$  | $2$  | $1000$  |\n| $8$  | ^  | $3$  | ^  |\n| $9\\sim 12$  | $40$  | $2$  |   ^|\n| $13\\sim16$  | ^  | $3$  |   ^|\n| $17\\sim21$  |  ^ | $500$  |  ^ |\n| $22\\sim25$  | $100$  | $2000$  | $998,244,353$  |\n\n\n对于所有测试点，保证 $1 \\leq n \\leq 100$，$1 \\leq m \\leq 2000$，$0 \\leq a_{i,j} \\lt 998,244,353$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019] Emiya’s Meal Today", "background": "", "description": "Emiya is a high school student who is good at cooking. He has mastered $n$ kinds of **cooking methods**, and uses $m$ kinds of **main ingredients**. For convenience, we number cooking methods from $1$ to $n$, and main ingredients from $1$ to $m$.\n\nEvery dish Emiya makes will use **exactly one** cooking method and **exactly one** main ingredient. More specifically, Emiya can make $a_{i,j}$ different dishes that use cooking method $i$ and main ingredient $j$ ($1 \\leq i \\leq n$, $1 \\leq j \\leq m$). This also means Emiya can make a total of $\\sum\\limits_{i=1}^{n} \\sum\\limits_{j=1}^{m} a_{i,j}$ different dishes.\n\nToday, Emiya is going to prepare a meal to treat his good friends Yazid and Rin. However, the three of them have different requirements for how the dishes are combined. More specifically, for a plan (a selection) that contains $k$ dishes:\n- Emiya will not let everyone go hungry, so he will make **at least one dish**, i.e. $k \\geq 1$.\n- Rin wants to taste dishes made with different cooking methods, so she requires that the **cooking methods of all dishes are pairwise different**.\n- Yazid does not want to taste too many dishes made from the same ingredient, so he requires that each **main ingredient** is used in at most **half** of the dishes (i.e. at most $\\lfloor \\frac{k}{2} \\rfloor$ dishes).\n\nHere, $\\lfloor x \\rfloor$ is the floor function, meaning the greatest integer not exceeding $x$.\n\nThese requirements are not hard for Emiya, but he wants to know how many different plans satisfy them. Two plans are different if and only if there exists at least one dish that appears in one plan but not in the other.\n\nEmiya asks you for help. Please compute the number of valid plans, and output the result modulo the prime $998,244,353$.", "inputFormat": "The first line contains two integers $n, m$ separated by a single space.\n\nLines $2$ to $n + 1$ each contain $m$ integers separated by single spaces. On line $i + 1$, the $m$ numbers are $a_{i,1}, a_{i,2}, \\cdots, a_{i,m}$ in order.", "outputFormat": "Output a single integer: the number of valid plans modulo $998,244,353$.", "hint": "[Sample 1 Explanation]\n\nIn this sample, for every pair $i, j$, Emiya can make at most one dish, so we directly describe a dish by giving the indices of its cooking method and main ingredient.\n\nValid plans include:\n- Make one dish using cooking method $1$ and main ingredient $1$, and one dish using cooking method $2$ and main ingredient $2$.\n- Make one dish using cooking method $1$ and main ingredient $1$, and one dish using cooking method $2$ and main ingredient $3$.\n- Make one dish using cooking method $1$ and main ingredient $3$, and one dish using cooking method $2$ and main ingredient $2$.\n\nTherefore the output is $3 \\bmod 998,244,353 = 3$. Note that all plans that contain only one dish are invalid, because the only main ingredient appears in more than half of the dishes, which does not satisfy Yazid’s requirement.\n\n[Sample 2 Explanation]\n\nEmiya must make at least $2$ dishes.\n\nThe number of valid plans with $2$ dishes is $100$.\n\nThe number of valid plans with $3$ dishes is $90$.\n\nTherefore the total number of valid plans is $100 + 90 = 190$.\n\n[Constraints]\n\n::cute-table{tuack}\n\n| Test Point ID | $n=$ | $m=$ | $a_{i,j}<$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | $2$ | $2$ | $2$ |\n| $2$ | ^ | $3$ | ^ |\n| $3$ | $5$ | $2$ | ^ |\n| $4$ | ^ | $3$ | ^ |\n| $5$ | $10$ | $2$ | ^ |\n| $6$ | ^ | $3$ | ^ |\n| $7$ | $10$ | $2$ | $1000$ |\n| $8$ | ^ | $3$ | ^ |\n| $9\\sim 12$ | $40$ | $2$ | ^ |\n| $13\\sim16$ | ^ | $3$ | ^ |\n| $17\\sim21$ | ^ | $500$ | ^ |\n| $22\\sim25$ | $100$ | $2000$ | $998,244,353$ |\n\nFor all test points, it is guaranteed that $1 \\leq n \\leq 100$, $1 \\leq m \\leq 2000$, $0 \\leq a_{i,j} \\lt 998,244,353$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019] Emiya 家今天的饭", "background": "", "description": "Emiya 是个擅长做菜的高中生，他共掌握 $n$ 种**烹饪方法**，且会使用 $m$ 种**主要食材**做菜。为了方便叙述，我们对烹饪方法从 $1 \\sim n$ 编号，对主要食材从 $1 \\sim m$ 编号。\n\nEmiya 做的每道菜都将使用**恰好一种**烹饪方法与**恰好一种**主要食材。更具体地，Emiya 会做 $a_{i,j}$ 道不同的使用烹饪方法 $i$ 和主要食材 $j$ 的菜（$1 \\leq i \\leq n$、$1 \\leq j \\leq m$），这也意味着 Emiya 总共会做 $\\sum\\limits_{i=1}^{n} \\sum\\limits_{j=1}^{m} a_{i,j}$ 道不同的菜。\n\nEmiya 今天要准备一桌饭招待 Yazid 和 Rin 这对好朋友，然而三个人对菜的搭配有不同的要求，更具体地，对于一种包含 $k$ 道菜的搭配方案而言：\n- Emiya 不会让大家饿肚子，所以将做**至少一道菜**，即 $k \\geq 1$\n- Rin 希望品尝不同烹饪方法做出的菜，因此她要求每道菜的**烹饪方法互不相同**\n- Yazid 不希望品尝太多同一食材做出的菜，因此他要求每种**主要食材**至多在**一半**的菜（即 $\\lfloor \\frac{k}{2} \\rfloor$ 道菜）中被使用\n\n这里的 $\\lfloor x \\rfloor$ 为下取整函数，表示不超过 $x$ 的最大整数。\n\n这些要求难不倒 Emiya，但他想知道共有多少种不同的符合要求的搭配方案。两种方案不同，当且仅当存在至少一道菜在一种方案中出现，而不在另一种方案中出现。\n\nEmiya 找到了你，请你帮他计算，你只需要告诉他符合所有要求的搭配方案数对质数 $998,244,353$ 取模的结果。", "inputFormat": "第 1 行两个用单个空格隔开的整数 $n,m$。\n\n第 2 行至第 $n + 1$ 行，每行 $m$ 个用单个空格隔开的整数，其中第 $i + 1$ 行的 $m$ 个数依次为 $a_{i,1}, a_{i,2}, \\cdots, a_{i,m}$。", "outputFormat": "仅一行一个整数，表示所求方案数对 $998,244,353$ 取模的结果。", "hint": "【样例 1 解释】\n\n由于在这个样例中，对于每组 $i, j$，Emiya 都最多只会做一道菜，因此我们直接通过给出烹饪方法、主要食材的编号来描述一道菜。\n\n符合要求的方案包括：\n- 做一道用烹饪方法 1、主要食材 1 的菜和一道用烹饪方法 2、主要食材 2 的菜\n- 做一道用烹饪方法 1、主要食材 1 的菜和一道用烹饪方法 2、主要食材 3 的菜\n- 做一道用烹饪方法 1、主要食材 3 的菜和一道用烹饪方法 2、主要食材 2 的菜\n\n因此输出结果为 $3 \\bmod 998,244,353 = 3$。 需要注意的是，所有只包含一道菜的方案都是不符合要求的，因为唯一的主要食材在超过一半的菜中出现，这不满足 Yazid 的要求。\n\n【样例 2 解释】\n\nEmiya 必须至少做 $2$ 道菜。\n\n做 $2$ 道菜的符合要求的方案数为 $100$。\n\n做 $3$ 道菜的符合要求的方案数为 $90$。\n\n因此符合要求的方案数为 $100 + 90 = 190$。\n\n【数据范围】\n\n::cute-table{tuack}\n\n| 测试点编号  |  $n=$ | $m=$  | $a_{i,j}<$  |\n|:-:|:-:|:-:|:-:|\n| $1$  | $2$ | $2$  | $2$  |\n| $2$  | ^  | $3$  | ^  |\n| $3$  |  $5$ | $2$  | ^  |\n| $4$  | ^  | $3$  |  ^ |\n| $5$  | $10$  | $2$  |^   |\n| $6$  | ^  | $3$  |  ^ |\n| $7$  | $10$  | $2$  | $1000$  |\n| $8$  | ^  | $3$  | ^  |\n| $9\\sim 12$  | $40$  | $2$  |   ^|\n| $13\\sim16$  | ^  | $3$  |   ^|\n| $17\\sim21$  |  ^ | $500$  |  ^ |\n| $22\\sim25$  | $100$  | $2000$  | $998,244,353$  |\n\n\n对于所有测试点，保证 $1 \\leq n \\leq 100$，$1 \\leq m \\leq 2000$，$0 \\leq a_{i,j} \\lt 998,244,353$。", "locale": "zh-CN"}}}
{"pid": "P5665", "type": "P", "difficulty": 6, "samples": [["5 0\n5 1 7 9 9", "247"], ["10 0\n5 6 7 7 4 6 2 13 19 9", "1256"], ["10000000 1\n123 456 789 12345 6789 3\n2000000 123456789 987654321\n7000000 234567891 876543219\n10000000 456789123 567891234", "4972194419293431240859891640"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "贪心", "2019", "单调队列", "CSP-S 提高级"], "title": "[CSP-S 2019] 划分", "background": "", "description": "2048 年，第三十届 CSP 认证的考场上，作为选手的小明打开了第一题。这个题的样例有 $n$ 组数据，数据从 $1 \\sim n$ 编号，$i$ 号数据的规模为 $a_i$。\n\n小明对该题设计出了一个暴力程序，对于一组规模为 $u$ 的数据，该程序的**运行时间**为 $u^2$。然而这个程序运行完一组规模为 $u$ 的数据之后，它将在任何一组规模**小于** $u$ 的数据上运行错误。样例中的 $a_i$ 不一定递增，但小明又想在不修改程序的情况下正确运行样例，于是小明决定使用一种非常原始的解决方案：将所有数据划分成若干个数据段，段内数据编号**连续**，接着将同一段内的数据合并成新数据，其规模等于段内原数据的**规模之和**，小明将让新数据的规模能够递增。\n\n也就是说，小明需要找到一些分界点 $1 \\leq k_1 \\lt k_2 \\lt \\cdots \\lt k_p \\lt n$，使得\n\n$$ \\sum_{i=1}^{k_1} a_i \\leq \\sum_{i=k_1+1}^{k_2} a_i \\leq \\cdots \\leq \\sum_{i=k_p+1}^{n} a_i $$\n\n注意 $p$ 可以为 $0$ 且此时 $k_0 = 0$，也就是小明可以将所有数据合并在一起运行。\n\n小明希望他的程序在正确运行样例情况下，运行时间也能尽量小，也就是**最小化**：\n\n$$ \\left(\\sum_{i=1}^{k_1} a_i\\right)^2 + \\left(\\sum_{i=k_1+1}^{k_2} a_i\\right)^2 + \\cdots + \\left(\\sum_{i=k_p+1}^{n} a_i\\right)^2 $$\n\n小明觉得这个问题非常有趣，并向你请教：给定 $n$ 和 $a_i$，请你求出最优划分方案下，小明的程序的最小运行时间。", "inputFormat": "**由于本题的数据范围较大，部分测试点的 $a_i$ 将在程序内生成。**\n\n第一行两个整数 $n, type$。$n$ 的意义见题目描述，$type$ 表示输入方式。\n1. 若 $type = 0$，则该测试点的 $a_i$ **直接给出**。输入文件接下来：第二行 $n$ 个以空格分隔的整数 $a_i$，表示每组数据的规模。\n2. 若 $type = 1$，则该测试点的 $a_i$ 将**特殊生成**，生成方式见后文。输入文件接下来：第二行六个以空格分隔的整数 $x, y, z, b_1, b_2, m$。接下来 $m$ 行中，第 $i (1 \\leq i \\leq m)$ 行包含三个以空格分隔的正整数 $p_i, l_i, r_i$。\n\n对于 $type = 1$ 的 $23 \\sim 25$ 号测试点，$a_i$ 的生成方式如下：\n\n给定整数 $x, y, z, b_1, b_2, m$，以及 $m$ 个三元组 $(p_i, l_i, r_i)$。\n\n保证 $n \\geq 2$。若 $n \\gt 2$，则 $\\forall 3 \\leq i \\leq n, b_i = (x \\times b_{i−1} + y \\times b_{i−2} + z) \\bmod 2^{30}$。\n\n保证 $1 \\leq p_i \\leq n, p_m = n$。令 $p_0 = 0$，则 $p_i$ 还满足 $\\forall 0 \\leq i \\lt m$ 有 $p_i \\lt p_{i+1}$。\n\n对于所有 $1 \\leq j \\leq m$，若下标值 $i (1 \\leq i \\leq n)$ 满足 $p_{j−1} \\lt i \\leq p_j$，则有\n\n$$a_i = \\left(b_i \\bmod \\left( r_j − l_j + 1 \\right) \\right) + l_j$$\n\n**上述数据生成方式仅是为了减少输入量大小，标准算法不依赖于该生成方式。**", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例 1 解释】\n\n最优的划分方案为 $\\{5,1\\}, \\{7\\}, \\{9\\}, \\{9\\}$。由 $5 + 1 \\leq 7 \\leq 9 \\leq 9$ 知该方案合法。\n\n答案为 $(5 + 1)^2 + 7^2 + 9^2 + 9^2 = 247$。\n\n虽然划分方案 $\\{5\\}, \\{1\\}, \\{7\\}, \\{9\\}, \\{9\\}$ 对应的运行时间比 $247$ 小，但它不是一组合法方案，因为 $5 \\gt 1$。\n\n虽然划分方案 $\\{5\\}, \\{1,7\\}, \\{9\\}, \\{9\\}$ 合法，但该方案对应的运行时间为 $251$，比 $247$ 大。\n\n【样例 2 解释】\n\n最优的划分方案为 $\\{5\\}, \\{6\\}, \\{7\\}, \\{7\\}, \\{4,6,2\\}, \\{13\\}, \\{19,9\\}$。\n\n【数据范围】\n\n::cute-table[]{tuack}\n| 测试点编号 | $n \\leq$ | $a_i \\leq$ | $type =$ |\n| :--: | :-: | :-: | :-: |\n| $1 \\sim 3$ | $10$ | $10$ | $0$ |\n| $4 \\sim 6$ | $50$ | $10^3$ | ^ |\n| $7 \\sim 9$ | $400$ | $10^4$ | ^ |\n| $10 \\sim 16$ | $5000$ | $10^5$ | ^ |\n| $17 \\sim 22$ | $5 \\times 10^5$ | $10^6$ | ^ |\n| $23 \\sim 25$ | $4 \\times 10^7$ | $10^9$ | $1$ |\n\n对于 $type=0$ 的所有测试点，保证最后输出的答案 $\\leq 4 \\times 10^{18}$。\n\n所有测试点满足：$type \\in \\{0,1\\}$，$2 \\leq n \\leq 4 \\times 10^7$，$1 \\leq a_i \\leq 10^9$，$1 \\leq m \\leq 10^5$，$1 \\leq l_i \\leq r_i \\leq 10^9$，$0 \\leq x,y,z,b_1,b_2 \\lt 2^{30}$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019] Partition", "background": "", "description": "In 2048, at the exam site of the 30th CSP certification, contestant Xiaoming opened the first problem. The sample of this problem has $n$ groups of testdata, numbered from $1 \\sim n$, and the size of the $i$-th testdata is $a_i$.\n\nXiaoming designed a brute-force program for this problem. For a piece of testdata of size $u$, the **running time** of the program is $u^2$. However, after the program finishes running on a piece of testdata of size $u$, it will produce wrong results on any piece of testdata whose size is **less than** $u$. The $a_i$ in the sample are not necessarily increasing, but Xiaoming wants to run the sample correctly without modifying the program. So he decided to use a very primitive solution: divide all testdata into several segments, where the indices within each segment are **continuous**. Then, merge the testdata within the same segment into new testdata whose size equals the **sum of sizes** of the original testdata in that segment. Xiaoming will make the sizes of the new testdata non-decreasing.\n\nThat is, Xiaoming needs to find some split points $1 \\leq k_1 \\lt k_2 \\lt \\cdots \\lt k_p \\lt n$ such that\n\n$$ \\sum_{i=1}^{k_1} a_i \\leq \\sum_{i=k_1+1}^{k_2} a_i \\leq \\cdots \\leq \\sum_{i=k_p+1}^{n} a_i $$\n\nNote that $p$ can be $0$, and in this case $k_0 = 0$, meaning Xiaoming can merge all testdata together and run it once.\n\nXiaoming hopes that, while running the sample correctly, the running time can be as small as possible, i.e., **minimize**:\n\n$$ \\left(\\sum_{i=1}^{k_1} a_i\\right)^2 + \\left(\\sum_{i=k_1+1}^{k_2} a_i\\right)^2 + \\cdots + \\left(\\sum_{i=k_p+1}^{n} a_i\\right)^2 $$\n\nXiaoming finds this problem very interesting and asks you for help: given $n$ and $a_i$, please compute the minimum running time of Xiaoming's program under the optimal partition.", "inputFormat": "**Because the Constraints of this problem are large, for some test points, $a_i$ will be generated inside the program.**\n\nThe first line contains two integers $n, type$. The meaning of $n$ is described above, and $type$ indicates the input method.\n\n1. If $type = 0$, then $a_i$ for this test point are **given directly**. The input then contains: on the second line, $n$ integers $a_i$ separated by spaces, representing the size of each group of testdata.\n2. If $type = 1$, then $a_i$ for this test point will be **generated specially**; the generation method is given later. The input then contains: on the second line, six integers $x, y, z, b_1, b_2, m$ separated by spaces. In the next $m$ lines, the $i$-th line $(1 \\leq i \\leq m)$ contains three positive integers $p_i, l_i, r_i$ separated by spaces.\n\nFor test points $23 \\sim 25$ with $type = 1$, $a_i$ are generated as follows:\n\nGiven integers $x, y, z, b_1, b_2, m$, and $m$ triples $(p_i, l_i, r_i)$.\n\nIt is guaranteed that $n \\geq 2$. If $n \\gt 2$, then for all $3 \\leq i \\leq n$, $b_i = (x \\times b_{i−1} + y \\times b_{i−2} + z) \\bmod 2^{30}$.\n\nIt is guaranteed that $1 \\leq p_i \\leq n$ and $p_m = n$. Let $p_0 = 0$, then $p_i$ also satisfies: for all $0 \\leq i \\lt m$, $p_i \\lt p_{i+1}$.\n\nFor all $1 \\leq j \\leq m$, if the index $i (1 \\leq i \\leq n)$ satisfies $p_{j−1} \\lt i \\leq p_j$, then\n\n$$a_i = \\left(b_i \\bmod \\left( r_j − l_j + 1 \\right) \\right) + l_j$$\n\n**The above data generation method is only to reduce the input size; the standard algorithm does not depend on this generation method.**", "outputFormat": "Output one integer in one line, representing the answer.", "hint": "[Sample 1 Explanation]\n\nThe optimal partition is $\\{5,1\\}, \\{7\\}, \\{9\\}, \\{9\\}$. Since $5 + 1 \\leq 7 \\leq 9 \\leq 9$, this partition is valid.\n\nThe answer is $(5 + 1)^2 + 7^2 + 9^2 + 9^2 = 247$.\n\nAlthough the partition $\\{5\\}, \\{1\\}, \\{7\\}, \\{9\\}, \\{9\\}$ has a running time smaller than $247$, it is not valid because $5 \\gt 1$.\n\nAlthough the partition $\\{5\\}, \\{1,7\\}, \\{9\\}, \\{9\\}$ is valid, its running time is $251$, which is larger than $247$.\n\n[Sample 2 Explanation]\n\nThe optimal partition is $\\{5\\}, \\{6\\}, \\{7\\}, \\{7\\}, \\{4,6,2\\}, \\{13\\}, \\{19,9\\}$.\n\n[Constraints]\n\n::cute-table[]{tuack}\n| Test Point ID | $n \\leq$ | $a_i \\leq$ | $type =$ |\n| :--: | :-: | :-: | :-: |\n| $1 \\sim 3$ | $10$ | $10$ | $0$ |\n| $4 \\sim 6$ | $50$ | $10^3$ | ^ |\n| $7 \\sim 9$ | $400$ | $10^4$ | ^ |\n| $10 \\sim 16$ | $5000$ | $10^5$ | ^ |\n| $17 \\sim 22$ | $5 \\times 10^5$ | $10^6$ | ^ |\n| $23 \\sim 25$ | $4 \\times 10^7$ | $10^9$ | $1$ |\n\nFor all test points with $type=0$, it is guaranteed that the final output answer $\\leq 4 \\times 10^{18}$.\n\nAll test points satisfy: $type \\in \\{0,1\\}$, $2 \\leq n \\leq 4 \\times 10^7$, $1 \\leq a_i \\leq 10^9$, $1 \\leq m \\leq 10^5$, $1 \\leq l_i \\leq r_i \\leq 10^9$, $0 \\leq x,y,z,b_1,b_2 \\lt 2^{30}$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019] 划分", "background": "", "description": "2048 年，第三十届 CSP 认证的考场上，作为选手的小明打开了第一题。这个题的样例有 $n$ 组数据，数据从 $1 \\sim n$ 编号，$i$ 号数据的规模为 $a_i$。\n\n小明对该题设计出了一个暴力程序，对于一组规模为 $u$ 的数据，该程序的**运行时间**为 $u^2$。然而这个程序运行完一组规模为 $u$ 的数据之后，它将在任何一组规模**小于** $u$ 的数据上运行错误。样例中的 $a_i$ 不一定递增，但小明又想在不修改程序的情况下正确运行样例，于是小明决定使用一种非常原始的解决方案：将所有数据划分成若干个数据段，段内数据编号**连续**，接着将同一段内的数据合并成新数据，其规模等于段内原数据的**规模之和**，小明将让新数据的规模能够递增。\n\n也就是说，小明需要找到一些分界点 $1 \\leq k_1 \\lt k_2 \\lt \\cdots \\lt k_p \\lt n$，使得\n\n$$ \\sum_{i=1}^{k_1} a_i \\leq \\sum_{i=k_1+1}^{k_2} a_i \\leq \\cdots \\leq \\sum_{i=k_p+1}^{n} a_i $$\n\n注意 $p$ 可以为 $0$ 且此时 $k_0 = 0$，也就是小明可以将所有数据合并在一起运行。\n\n小明希望他的程序在正确运行样例情况下，运行时间也能尽量小，也就是**最小化**：\n\n$$ \\left(\\sum_{i=1}^{k_1} a_i\\right)^2 + \\left(\\sum_{i=k_1+1}^{k_2} a_i\\right)^2 + \\cdots + \\left(\\sum_{i=k_p+1}^{n} a_i\\right)^2 $$\n\n小明觉得这个问题非常有趣，并向你请教：给定 $n$ 和 $a_i$，请你求出最优划分方案下，小明的程序的最小运行时间。", "inputFormat": "**由于本题的数据范围较大，部分测试点的 $a_i$ 将在程序内生成。**\n\n第一行两个整数 $n, type$。$n$ 的意义见题目描述，$type$ 表示输入方式。\n1. 若 $type = 0$，则该测试点的 $a_i$ **直接给出**。输入文件接下来：第二行 $n$ 个以空格分隔的整数 $a_i$，表示每组数据的规模。\n2. 若 $type = 1$，则该测试点的 $a_i$ 将**特殊生成**，生成方式见后文。输入文件接下来：第二行六个以空格分隔的整数 $x, y, z, b_1, b_2, m$。接下来 $m$ 行中，第 $i (1 \\leq i \\leq m)$ 行包含三个以空格分隔的正整数 $p_i, l_i, r_i$。\n\n对于 $type = 1$ 的 $23 \\sim 25$ 号测试点，$a_i$ 的生成方式如下：\n\n给定整数 $x, y, z, b_1, b_2, m$，以及 $m$ 个三元组 $(p_i, l_i, r_i)$。\n\n保证 $n \\geq 2$。若 $n \\gt 2$，则 $\\forall 3 \\leq i \\leq n, b_i = (x \\times b_{i−1} + y \\times b_{i−2} + z) \\bmod 2^{30}$。\n\n保证 $1 \\leq p_i \\leq n, p_m = n$。令 $p_0 = 0$，则 $p_i$ 还满足 $\\forall 0 \\leq i \\lt m$ 有 $p_i \\lt p_{i+1}$。\n\n对于所有 $1 \\leq j \\leq m$，若下标值 $i (1 \\leq i \\leq n)$ 满足 $p_{j−1} \\lt i \\leq p_j$，则有\n\n$$a_i = \\left(b_i \\bmod \\left( r_j − l_j + 1 \\right) \\right) + l_j$$\n\n**上述数据生成方式仅是为了减少输入量大小，标准算法不依赖于该生成方式。**", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例 1 解释】\n\n最优的划分方案为 $\\{5,1\\}, \\{7\\}, \\{9\\}, \\{9\\}$。由 $5 + 1 \\leq 7 \\leq 9 \\leq 9$ 知该方案合法。\n\n答案为 $(5 + 1)^2 + 7^2 + 9^2 + 9^2 = 247$。\n\n虽然划分方案 $\\{5\\}, \\{1\\}, \\{7\\}, \\{9\\}, \\{9\\}$ 对应的运行时间比 $247$ 小，但它不是一组合法方案，因为 $5 \\gt 1$。\n\n虽然划分方案 $\\{5\\}, \\{1,7\\}, \\{9\\}, \\{9\\}$ 合法，但该方案对应的运行时间为 $251$，比 $247$ 大。\n\n【样例 2 解释】\n\n最优的划分方案为 $\\{5\\}, \\{6\\}, \\{7\\}, \\{7\\}, \\{4,6,2\\}, \\{13\\}, \\{19,9\\}$。\n\n【数据范围】\n\n::cute-table[]{tuack}\n| 测试点编号 | $n \\leq$ | $a_i \\leq$ | $type =$ |\n| :--: | :-: | :-: | :-: |\n| $1 \\sim 3$ | $10$ | $10$ | $0$ |\n| $4 \\sim 6$ | $50$ | $10^3$ | ^ |\n| $7 \\sim 9$ | $400$ | $10^4$ | ^ |\n| $10 \\sim 16$ | $5000$ | $10^5$ | ^ |\n| $17 \\sim 22$ | $5 \\times 10^5$ | $10^6$ | ^ |\n| $23 \\sim 25$ | $4 \\times 10^7$ | $10^9$ | $1$ |\n\n对于 $type=0$ 的所有测试点，保证最后输出的答案 $\\leq 4 \\times 10^{18}$。\n\n所有测试点满足：$type \\in \\{0,1\\}$，$2 \\leq n \\leq 4 \\times 10^7$，$1 \\leq a_i \\leq 10^9$，$1 \\leq m \\leq 10^5$，$1 \\leq l_i \\leq r_i \\leq 10^9$，$0 \\leq x,y,z,b_1,b_2 \\lt 2^{30}$。", "locale": "zh-CN"}}}
{"pid": "P5666", "type": "P", "difficulty": 6, "samples": [["2\n5\n1 2\n2 3\n2 4\n3 5\n7\n1 2\n1 3\n1 4\n3 5\n3 6\n6 7", "32\n56"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "树上启发式合并", "树形 DP", "CSP-S 提高级"], "title": "[CSP-S 2019] 树的重心", "background": "", "description": "小简单正在学习离散数学，今天的内容是图论基础，在课上他做了如下两条笔记：\n1. 一个大小为 $n$ 的树由 $n$ 个结点与 $n - 1$ 条无向边构成，且满足任意两个结点间**有且仅有**一条简单路径。在树中删去一个结点及与它关联的边，树将分裂为若干个子树；而在树中删去一条边（保留关联结点，下同），树将分裂为**恰好**两个子树。\n2. 对于一个大小为 $n$ 的树与任意一个树中结点 $c$，称 $c$ 是该树的**重心**当且仅当在树中删去 $c$ 及与它关联的边后，分裂出的所有子树的大小均**不超过** $\\lfloor \\frac{n}{2} \\rfloor$（其中 $\\lfloor x \\rfloor$ 是下取整函数）。对于包含至少一个结点的树，它的重心只可能有 1 或 2 个。\n\n课后老师给出了一个大小为 $n$ 的树 $S$，树中结点从 $1 \\sim n$ 编号。小简单的课后作业是求出 $S$ 单独删去每条边后，分裂出的两个子树的重心编号和之和。即：\n\n$$\n\\sum_{(u,v) \\in E} \\left( \\sum_{1 \\leq x \\leq n \\atop 且 x 号点是 S'_u 的重心} x + \\sum_{1 \\leq y \\leq n \\atop 且 y 号点是 S'_v 的重心} y \\right)\n$$\n\n上式中，$E$ 表示树 $S$ 的边集，$(u,v)$ 表示一条连接 $u$ 号点和 $v$ 号点的边。$S'_u$ 与 $S'_v$ 分别表示树 $S$ 删去边 $(u,v)$ 后，$u$ 号点与 $v$ 号点所在的被分裂出的子树。\n\n小简单觉得作业并不简单，只好向你求助，请你教教他。\n", "inputFormat": "**本题包含多组测试数据。**\n\n第一行一个整数 $T$ 表示数据组数。\n\n接下来依次给出每组输入数据，对于每组数据：\n\n第一行一个整数 $n$ 表示树 $S$ 的大小。\n\n接下来 $n − 1$ 行，每行两个以空格分隔的整数 $u_i$，$v_i$，表示树中的一条边 $(u_i,v_i)$。", "outputFormat": "共 $T$ 行，每行一个整数，第 $i$ 行的整数表示：第 $i$ 组数据给出的树单独删去每条边后，分裂出的两个子树的重心编号和之和。", "hint": "【样例 1 解释】\n\n对于第一组数据：\n\n删去边 $(1,2)$，1 号点所在子树重心编号为 $\\{1\\}$，2 号点所在子树重心编号为 $\\{2,3\\}$。\n\n删去边 $(2,3)$，2 号点所在子树重心编号为 $\\{2\\}$，3 号点所在子树重心编号为 $\\{3,5\\}$。\n\n删去边 $(2,4)$，2 号点所在子树重心编号为 $\\{2,3\\}$，4 号点所在子树重心编号为 $\\{4\\}$。\n\n删去边 $(3,5)$，3 号点所在子树重心编号为 $\\{2\\}$，5 号点所在子树重心编号为 $\\{5\\}$。\n\n因此答案为 $1 + 2 + 3 + 2 + 3 + 5 + 2 + 3 + 4 + 2 + 5 = 32$。\n\n【数据范围】\n\n| 测试点编号 | $n =$ | 特殊性质 |\n| :----------- | :----------- | :----------- |\n| $1 \\sim 2$ | $7$ | 无 |\n| $3 \\sim 5$ | $199$ | 无 |\n| $6 \\sim 8$ | $1999$ | 无 |\n| $9 \\sim 11$ | $49991$ | A |\n| $12 \\sim 15$ | $262143$ | B |\n| $16$ | $99995$ | 无 |\n| $17 \\sim 18$ | $199995$ | 无 |\n| $19 \\sim 20$ | $299995$ | 无 |\n\n\n表中特殊性质一栏，两个变量的含义为存在一个 $1 \\sim n$ 的排列  $p_i (1 \\leq i \\leq n)$，使得：\n- A：树的形态是一条链。即 $\\forall 1 \\leq i \\lt n$，存在一条边 $(p_i, p_{i + 1})$。\n- B：树的形态是一个完美二叉树。即 $\\forall 1 \\leq i \\leq \\frac{n-1}{2}$ ，存在两条边 $(p_i, p_{2i})$ 与 $(p_i, p_{2i+1})$。\n\n对于所有测试点：$1 \\leq T \\leq 5 , 1 \\leq u_i,v_i \\leq n$。保证给出的图是一个树。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019] Tree Centroid", "background": "", "description": "Xiaojiandan is learning discrete mathematics. Today’s topic is basic graph theory, and in class he wrote down the following two notes:\n\n1. A tree of size $n$ consists of $n$ nodes and $n - 1$ undirected edges, and between any two nodes there exists **exactly one** simple path. If you delete one node in a tree and all edges incident to it, the tree will split into several subtrees. If you delete one edge in a tree (keeping its incident nodes; same below), the tree will split into **exactly** two subtrees.\n2. For a tree of size $n$ and any node $c$ in the tree, $c$ is called a **centroid** of the tree if and only if, after deleting $c$ and all edges incident to it, the sizes of all resulting subtrees are **no more than** $\\lfloor \\frac{n}{2} \\rfloor$ (where $\\lfloor x \\rfloor$ is the floor function). For any tree with at least one node, it can have only 1 or 2 centroids.\n\nAfter class, the teacher gave a tree $S$ of size $n$, with nodes numbered from $1$ to $n$. Xiaojiandan’s homework is to compute, for every edge deleted individually from $S$, the sum of the centroid node labels of the two resulting subtrees. That is:\n\n$$\n\\sum_{(u,v) \\in E} \\left( \\sum_{1 \\leq x \\leq n \\atop 且 x 号点是 S'_u 的重心} x + \\sum_{1 \\leq y \\leq n \\atop 且 y 号点是 S'_v 的重心} y \\right)\n$$\n\nIn the expression above, $E$ denotes the edge set of tree $S$, and $(u,v)$ denotes an edge connecting node $u$ and node $v$. $S'_u$ and $S'_v$ denote, respectively, the two subtrees containing node $u$ and node $v$ after deleting edge $(u,v)$ from $S$.\n\nXiaojiandan finds this homework not simple at all, so he asks you for help. Please teach him.", "inputFormat": "**This problem contains multiple test cases.**\n\nThe first line contains an integer $T$, indicating the number of test cases.\n\nThen the input for each test case is given as follows:\n\nThe first line contains an integer $n$, indicating the size of the tree $S$.\n\nThe next $n - 1$ lines each contain two integers $u_i$ and $v_i$ separated by a space, representing an edge $(u_i,v_i)$ in the tree.", "outputFormat": "Output $T$ lines. Each line contains one integer. The integer on line $i$ means: for the tree given in test case $i$, after deleting each edge individually, the sum of the centroid node labels of the two resulting subtrees.", "hint": "[Sample 1 Explanation]\n\nFor the first test case:\n\nDelete edge $(1,2)$. The centroid labels of the subtree containing node 1 are $\\{1\\}$. The centroid labels of the subtree containing node 2 are $\\{2,3\\}$.\n\nDelete edge $(2,3)$. The centroid labels of the subtree containing node 2 are $\\{2\\}$. The centroid labels of the subtree containing node 3 are $\\{3,5\\}$.\n\nDelete edge $(2,4)$. The centroid labels of the subtree containing node 2 are $\\{2,3\\}$. The centroid labels of the subtree containing node 4 are $\\{4\\}$.\n\nDelete edge $(3,5)$. The centroid labels of the subtree containing node 3 are $\\{2\\}$. The centroid labels of the subtree containing node 5 are $\\{5\\}$.\n\nTherefore, the answer is $1 + 2 + 3 + 2 + 3 + 5 + 2 + 3 + 4 + 2 + 5 = 32$.\n\n[Constraints]\n\n| Test Point ID | $n =$ | Special Property |\n| :----------- | :----------- | :----------- |\n| $1 \\sim 2$ | $7$ | None |\n| $3 \\sim 5$ | $199$ | None |\n| $6 \\sim 8$ | $1999$ | None |\n| $9 \\sim 11$ | $49991$ | A |\n| $12 \\sim 15$ | $262143$ | B |\n| $16$ | $99995$ | None |\n| $17 \\sim 18$ | $199995$ | None |\n| $19 \\sim 20$ | $299995$ | None |\n\nIn the table, the meanings of the two special properties are that there exists a permutation $p_i (1 \\leq i \\leq n)$ of $1 \\sim n$ such that:\n\n- A: The tree is a chain. That is, $\\forall 1 \\leq i \\lt n$, there exists an edge $(p_i, p_{i + 1})$.\n- B: The tree is a perfect binary tree. That is, $\\forall 1 \\leq i \\leq \\frac{n-1}{2}$, there exist two edges $(p_i, p_{2i})$ and $(p_i, p_{2i+1})$.\n\nFor all test points: $1 \\leq T \\leq 5$, $1 \\leq u_i,v_i \\leq n$. It is guaranteed that the given graph is a tree.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019] 树的重心", "background": "", "description": "小简单正在学习离散数学，今天的内容是图论基础，在课上他做了如下两条笔记：\n1. 一个大小为 $n$ 的树由 $n$ 个结点与 $n - 1$ 条无向边构成，且满足任意两个结点间**有且仅有**一条简单路径。在树中删去一个结点及与它关联的边，树将分裂为若干个子树；而在树中删去一条边（保留关联结点，下同），树将分裂为**恰好**两个子树。\n2. 对于一个大小为 $n$ 的树与任意一个树中结点 $c$，称 $c$ 是该树的**重心**当且仅当在树中删去 $c$ 及与它关联的边后，分裂出的所有子树的大小均**不超过** $\\lfloor \\frac{n}{2} \\rfloor$（其中 $\\lfloor x \\rfloor$ 是下取整函数）。对于包含至少一个结点的树，它的重心只可能有 1 或 2 个。\n\n课后老师给出了一个大小为 $n$ 的树 $S$，树中结点从 $1 \\sim n$ 编号。小简单的课后作业是求出 $S$ 单独删去每条边后，分裂出的两个子树的重心编号和之和。即：\n\n$$\n\\sum_{(u,v) \\in E} \\left( \\sum_{1 \\leq x \\leq n \\atop 且 x 号点是 S'_u 的重心} x + \\sum_{1 \\leq y \\leq n \\atop 且 y 号点是 S'_v 的重心} y \\right)\n$$\n\n上式中，$E$ 表示树 $S$ 的边集，$(u,v)$ 表示一条连接 $u$ 号点和 $v$ 号点的边。$S'_u$ 与 $S'_v$ 分别表示树 $S$ 删去边 $(u,v)$ 后，$u$ 号点与 $v$ 号点所在的被分裂出的子树。\n\n小简单觉得作业并不简单，只好向你求助，请你教教他。\n", "inputFormat": "**本题包含多组测试数据。**\n\n第一行一个整数 $T$ 表示数据组数。\n\n接下来依次给出每组输入数据，对于每组数据：\n\n第一行一个整数 $n$ 表示树 $S$ 的大小。\n\n接下来 $n − 1$ 行，每行两个以空格分隔的整数 $u_i$，$v_i$，表示树中的一条边 $(u_i,v_i)$。", "outputFormat": "共 $T$ 行，每行一个整数，第 $i$ 行的整数表示：第 $i$ 组数据给出的树单独删去每条边后，分裂出的两个子树的重心编号和之和。", "hint": "【样例 1 解释】\n\n对于第一组数据：\n\n删去边 $(1,2)$，1 号点所在子树重心编号为 $\\{1\\}$，2 号点所在子树重心编号为 $\\{2,3\\}$。\n\n删去边 $(2,3)$，2 号点所在子树重心编号为 $\\{2\\}$，3 号点所在子树重心编号为 $\\{3,5\\}$。\n\n删去边 $(2,4)$，2 号点所在子树重心编号为 $\\{2,3\\}$，4 号点所在子树重心编号为 $\\{4\\}$。\n\n删去边 $(3,5)$，3 号点所在子树重心编号为 $\\{2\\}$，5 号点所在子树重心编号为 $\\{5\\}$。\n\n因此答案为 $1 + 2 + 3 + 2 + 3 + 5 + 2 + 3 + 4 + 2 + 5 = 32$。\n\n【数据范围】\n\n| 测试点编号 | $n =$ | 特殊性质 |\n| :----------- | :----------- | :----------- |\n| $1 \\sim 2$ | $7$ | 无 |\n| $3 \\sim 5$ | $199$ | 无 |\n| $6 \\sim 8$ | $1999$ | 无 |\n| $9 \\sim 11$ | $49991$ | A |\n| $12 \\sim 15$ | $262143$ | B |\n| $16$ | $99995$ | 无 |\n| $17 \\sim 18$ | $199995$ | 无 |\n| $19 \\sim 20$ | $299995$ | 无 |\n\n\n表中特殊性质一栏，两个变量的含义为存在一个 $1 \\sim n$ 的排列  $p_i (1 \\leq i \\leq n)$，使得：\n- A：树的形态是一条链。即 $\\forall 1 \\leq i \\lt n$，存在一条边 $(p_i, p_{i + 1})$。\n- B：树的形态是一个完美二叉树。即 $\\forall 1 \\leq i \\leq \\frac{n-1}{2}$ ，存在两条边 $(p_i, p_{2i})$ 与 $(p_i, p_{2i+1})$。\n\n对于所有测试点：$1 \\leq T \\leq 5 , 1 \\leq u_i,v_i \\leq n$。保证给出的图是一个树。", "locale": "zh-CN"}}}
{"pid": "P5667", "type": "P", "difficulty": 6, "samples": [["5 6\n1 1 4 5 1 4", "54 232 673 1579 3232 6007"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["快速傅里叶变换 FFT", "快速数论变换 NTT", "拉格朗日插值法"], "title": "拉格朗日插值2", "background": "", "description": "给定一个不超过 $n$ 次的多项式的 $n+1$ 个点值 $f(0),f(1) \\dots f(n)$，和一个正整数 $m$，求 $f(m),f(m+1) \\dots f(m+n)$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$，意义如题目描述。  \n第二行 $n+1$ 个整数，表示 $f(0),f(1) \\dots f(n)$。", "outputFormat": "输出一行 $n+1$ 个整数，表示 $f(m),f(m+1) \\dots f(m+n)$。", "hint": "【数据范围】     \n对于 $100\\%$ 的数据：  \n$1 \\le n \\le 160000$，$n < m \\le 10^8$，$0 \\le f(i) < 998244353$。", "locale": "zh-CN", "translations": {"en": {"title": "Lagrange Interpolation 2", "background": "", "description": "Given the $n + 1$ point values $f(0), f(1) \\dots f(n)$ of a polynomial of degree at most $n$, and a positive integer $m$, find $f(m), f(m + 1) \\dots f(m + n)$.\n\nThe answer should be taken modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n, m$, with the meanings as described above.  \nThe second line contains $n + 1$ integers, representing $f(0), f(1) \\dots f(n)$.", "outputFormat": "Output one line with $n + 1$ integers, representing $f(m), f(m + 1) \\dots f(m + n)$.", "hint": "Constraints  \nFor $100\\%$ of the testdata:  \n$1 \\le n \\le 160000$, $n < m \\le 10^8$, $0 \\le f(i) < 998244353$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "拉格朗日插值2", "background": "", "description": "给定一个不超过 $n$ 次的多项式的 $n+1$ 个点值 $f(0),f(1) \\dots f(n)$，和一个正整数 $m$，求 $f(m),f(m+1) \\dots f(m+n)$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$，意义如题目描述。  \n第二行 $n+1$ 个整数，表示 $f(0),f(1) \\dots f(n)$。", "outputFormat": "输出一行 $n+1$ 个整数，表示 $f(m),f(m+1) \\dots f(m+n)$。", "hint": "【数据范围】     \n对于 $100\\%$ 的数据：  \n$1 \\le n \\le 160000$，$n < m \\le 10^8$，$0 \\le f(i) < 998244353$。", "locale": "zh-CN"}}}
{"pid": "P5668", "type": "P", "difficulty": 7, "samples": [["2\n3 531441 330750\n5 304128 1", "27\n264 19947 39630 59313 78996 98679 118362 138045 157728 177411 197094 216777 236460 256143 275826 295509 315192 334875 354558 374241 393924 413607 433290 452973 472656 492339 512022\n5\n1 82945 138241 165889 193537"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "数论", "洛谷原创", "O2优化", "模板题"], "title": "【模板】N 次剩余", "background": "", "description": "你需要解方程 $x^n\\equiv k\\pmod m$，其中 $x\\in [0,m-1]$。", "inputFormat": "第一行正整数 $T$ 为数据组数。\n\n每组数据三个正整数 $n,m,k$。", "outputFormat": "每组数据一或两行：\n\n第一行为不同解的个数 $c$。\n\n若 $c\\neq 0$，接下来第二行共 $c$ 个整数，升序输出所有可能解，空格隔开。\n\n数据保证 $\\sum c_i \\le 10^6$。", "hint": "对于 $100 \\%$ 的数据，$1\\le T\\le 100$，$1\\le n\\le 10^9$，$0\\le k \\lt m\\le 10^9$。\n\n设 $m$ 的唯一分解形式为 $m=\\prod_{i=1}^s p_i^{q_i}$，保证方程 $x^n\\equiv k\\pmod{p_i^{q_i}}$ 在 $[0,p_i^{q_i})$ 中的解数 $\\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] $n$-th Power Residue", "background": "", "description": "You need to solve the equation $x^n\\equiv k\\pmod m$, where $x\\in [0,m-1]$.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nEach test case contains three positive integers $n, m, k$.", "outputFormat": "For each test case, output one or two lines:\n\nThe first line contains the number of distinct solutions $c$.\n\nIf $c\\neq 0$, then output a second line with $c$ integers, in increasing order, listing all possible solutions separated by spaces.\n\nIt is guaranteed that $\\sum c_i \\le 10^6$.", "hint": "For $100\\%$ of the testdata, $1\\le T\\le 100$, $1\\le n\\le 10^9$, $0\\le k \\lt m\\le 10^9$.\n\nLet the unique factorization of $m$ be $m=\\prod_{i=1}^s p_i^{q_i}$. It is guaranteed that the number of solutions to $x^n\\equiv k\\pmod{p_i^{q_i}}$ in $[0,p_i^{q_i})$ is $\\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】N 次剩余", "background": "", "description": "你需要解方程 $x^n\\equiv k\\pmod m$，其中 $x\\in [0,m-1]$。", "inputFormat": "第一行正整数 $T$ 为数据组数。\n\n每组数据三个正整数 $n,m,k$。", "outputFormat": "每组数据一或两行：\n\n第一行为不同解的个数 $c$。\n\n若 $c\\neq 0$，接下来第二行共 $c$ 个整数，升序输出所有可能解，空格隔开。\n\n数据保证 $\\sum c_i \\le 10^6$。", "hint": "对于 $100 \\%$ 的数据，$1\\le T\\le 100$，$1\\le n\\le 10^9$，$0\\le k \\lt m\\le 10^9$。\n\n设 $m$ 的唯一分解形式为 $m=\\prod_{i=1}^s p_i^{q_i}$，保证方程 $x^n\\equiv k\\pmod{p_i^{q_i}}$ 在 $[0,p_i^{q_i})$ 中的解数 $\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5669", "type": "P", "difficulty": 7, "samples": [["5 3\n1 4 4 5 4\n1 2\n2 3\n3 4\n2 5\n1 2 3\n2 1 3\n1 3 2\n", "1\n5\n1"], ["10 5\n3 4 3 8 9 3 2 8 5 7\n1 2\n2 3\n3 4\n4 5\n5 6\n4 7\n4 8\n8 9\n8 10\n1 1 10\n2 3 5\n2 7 5\n2 5 4\n1 8 6", "4\n34\n61\n45\n3"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "各省省选", "山东"], "title": "[SDOI2018] 原题识别-改", "background": "蒟蒻$\\color{grey}{\\text{suwakow}}$花了三天时间，研究出了[这道题](https://www.luogu.org/problem/P4618)的**线性空间**，且不依赖输入的随机性的一种优（du）秀（liu）做法。于是她决定拿出来毒瘤一下大家。", "description": "有一棵$n$个点的有根树，根节点编号为$1$，且编号为$i$的节点有颜色$a_i$。你需要支持$m$次询问。询问有以下两种格式：\n\n- $1~x~y$：询问树上编号为$x$的节点到编号为$y$的节点的最短路径中，不同的颜色有多少种。\n\n- $2~a~b$：在节点$a$到根节点的路径中随机选择一个点$x$，在节点$b$到根节点的路径中随机选择一个点$y$，求询问 $1~x~y$ 的答案期望。（路径包含$a$, $b$和根节点）\n\n对于询问$2$，设答案为$\\mathrm{ans}$，$a$到根节点的路径经过的点数为$\\mathrm{cnt_a}$，$b$到根节点的路径经过的点数为$\\mathrm{cnt_b}$，你只需要输出$\\mathrm{ans}\\cdot \\mathrm{cnt_a}\\cdot \\mathrm{cnt_b}$。\n", "inputFormat": "**注意：输入格式与原题不同**\n\n每个测试点仅包含一组数据。\n\n输入数据的第一行包含两个非负整数$n$, $m$，表示节点个数和询问次数。\n\n接下来一行包含$n$个正整数，第$i$个正整数为$a_i$，表示节点$i$的颜色。\n\n接下来$n-1$行，每行包含两个整数$u$, $v$，表示编号为$u$的节点和编号为$v$的节点之间存在一条边。保证输入的边构成一棵树。\n\n接下来$m$行，每行包含一个询问。询问的格式和意义见题目描述。", "outputFormat": "输出$m$行，第$i$行包含一个非负整数，表示第$i$次询问的答案。", "hint": "对于所有数据，保证$1\\leq a_1, a_2, \\ldots, a_n\\leq n\\leq 10^5$, $1\\leq m\\leq 2\\times 10^5$。保证输入的边构成一棵树。\n\n子任务$1$（$30$分）：保证不存在询问$2$。\n\n子任务$2$（$30$分）：保证对于每一条边都有$v=u+1$。\n\n子任务$3$（$40$分）：没有任何附加的限制。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2018] Original Problem Recognition - Modified.", "background": "Rookie $\\color{grey}{\\text{suwakow}}$ spent three days and came up with an excellent (but rather nasty) solution for **linear space** for [this problem](https://www.luogu.org/problem/P4618), which does not rely on randomness in the input. So she decided to use it to torture everyone.", "description": "There is a rooted tree with $n$ nodes. The root is node $1$, and node $i$ has color $a_i$. You need to handle $m$ queries of the following two types:\n\n- $1~x~y$: Query how many different colors appear on the shortest path from node $x$ to node $y$ in the tree.\n\n- $2~a~b$: Randomly choose a node $x$ on the path from node $a$ to the root, and randomly choose a node $y$ on the path from node $b$ to the root. Compute the expected value of the answer to query $1~x~y$. (The paths include $a$, $b$, and the root.)\n\nFor query type $2$, let the answer be $\\mathrm{ans}$. Let $\\mathrm{cnt_a}$ be the number of nodes on the path from $a$ to the root, and let $\\mathrm{cnt_b}$ be the number of nodes on the path from $b$ to the root. You only need to output $\\mathrm{ans}\\cdot \\mathrm{cnt_a}\\cdot \\mathrm{cnt_b}$.", "inputFormat": "**Note: The input format is different from the original problem.**\n\nEach test point contains only one test case.\n\nThe first line contains two non-negative integers $n$, $m$, representing the number of nodes and the number of queries.\n\nThe next line contains $n$ positive integers. The $i$-th positive integer is $a_i$, representing the color of node $i$.\n\nThe next $n-1$ lines each contain two integers $u$, $v$, indicating that there is an edge between node $u$ and node $v$. It is guaranteed that these edges form a tree.\n\nThe next $m$ lines each contain one query. The format and meaning of the queries are given in the description.", "outputFormat": "Output $m$ lines. The $i$-th line contains one non-negative integer, representing the answer to the $i$-th query.", "hint": "For all data, it is guaranteed that $1\\leq a_1, a_2, \\ldots, a_n\\leq n\\leq 10^5$, $1\\leq m\\leq 2\\times 10^5$. It is guaranteed that the input edges form a tree.\n\nSubtask $1$ ($30$ points): There are no type $2$ queries.\n\nSubtask $2$ ($30$ points): For every edge, $v=u+1$.\n\nSubtask $3$ ($40$ points): There are no additional constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2018] 原题识别-改", "background": "蒟蒻$\\color{grey}{\\text{suwakow}}$花了三天时间，研究出了[这道题](https://www.luogu.org/problem/P4618)的**线性空间**，且不依赖输入的随机性的一种优（du）秀（liu）做法。于是她决定拿出来毒瘤一下大家。", "description": "有一棵$n$个点的有根树，根节点编号为$1$，且编号为$i$的节点有颜色$a_i$。你需要支持$m$次询问。询问有以下两种格式：\n\n- $1~x~y$：询问树上编号为$x$的节点到编号为$y$的节点的最短路径中，不同的颜色有多少种。\n\n- $2~a~b$：在节点$a$到根节点的路径中随机选择一个点$x$，在节点$b$到根节点的路径中随机选择一个点$y$，求询问 $1~x~y$ 的答案期望。（路径包含$a$, $b$和根节点）\n\n对于询问$2$，设答案为$\\mathrm{ans}$，$a$到根节点的路径经过的点数为$\\mathrm{cnt_a}$，$b$到根节点的路径经过的点数为$\\mathrm{cnt_b}$，你只需要输出$\\mathrm{ans}\\cdot \\mathrm{cnt_a}\\cdot \\mathrm{cnt_b}$。\n", "inputFormat": "**注意：输入格式与原题不同**\n\n每个测试点仅包含一组数据。\n\n输入数据的第一行包含两个非负整数$n$, $m$，表示节点个数和询问次数。\n\n接下来一行包含$n$个正整数，第$i$个正整数为$a_i$，表示节点$i$的颜色。\n\n接下来$n-1$行，每行包含两个整数$u$, $v$，表示编号为$u$的节点和编号为$v$的节点之间存在一条边。保证输入的边构成一棵树。\n\n接下来$m$行，每行包含一个询问。询问的格式和意义见题目描述。", "outputFormat": "输出$m$行，第$i$行包含一个非负整数，表示第$i$次询问的答案。", "hint": "对于所有数据，保证$1\\leq a_1, a_2, \\ldots, a_n\\leq n\\leq 10^5$, $1\\leq m\\leq 2\\times 10^5$。保证输入的边构成一棵树。\n\n子任务$1$（$30$分）：保证不存在询问$2$。\n\n子任务$2$（$30$分）：保证对于每一条边都有$v=u+1$。\n\n子任务$3$（$40$分）：没有任何附加的限制。\n", "locale": "zh-CN"}}}
{"pid": "P5670", "type": "P", "difficulty": 6, "samples": [["10 2 10\n0 1 0 0 1 0 2 2 0 1 \n2 3 9\n2 1 5\n1 9 9 0\n1 3 7 2\n1 1 6 3\n2 1 10\n2 6 7\n2 3 6\n1 3 9 2\n1 3 9 3\n", "1\n0\n3\n1\n3\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["枚举", "分块", "位运算"], "title": "秘籍-反复异或", "background": "", "description": "给定一个长为 $n$ 的序列，支持操作：\n\n- `1 l r x`：将区间 $[l,r]$ 的所有元素加 $x$。\n- `2 l r` ：查询区间 $[l,r]$ 中所有元素异或和的后 $m$ 个二进制位的值。", "inputFormat": "第一行三个正整数 $n,m,q$，表示序列长度，位数，操作数。\n\n第二行 $n$ 个非负整数，表示原始序列 $a_i$。\n\n接下来 $q$ 行，每行若干个非负整数表示一个操作。", "outputFormat": "对于每个 $2$ 操作输出一行，一个非负整数表示答案。", "hint": "【数据范围】   \n本题共 $10$ 个测试点。\n\n对于测试点 $1 \\sim 3$，$1\\le n,q \\le 1000$；    \n对于测试点 $4,5$，$1 \\le m \\le 5$；   \n对于测试点 $6 \\sim 10$，设 $k$ 为测试点编号，有 $m=k$。  \n\n对于 $100\\%$ 的数据，$1 \\le n,q \\le 10^5$，$1\\le m \\le 10$，$0\\le a_i,x < 2^m$。\n\n**请注意常数优化。**", "locale": "zh-CN", "translations": {"en": {"title": "Secret Manual - Repeated XOR", "background": "", "description": "Given a sequence of length $n$, support the following operations:\n\n- `1 l r x`: Add $x$ to all elements in the interval $[l, r]$.\n- `2 l r`: Query the value of the last $m$ binary bits of the XOR sum of all elements in the interval $[l, r]$.", "inputFormat": "The first line contains three positive integers $n, m, q$, representing the sequence length, the number of bits, and the number of operations.\n\nThe second line contains $n$ non-negative integers, representing the original sequence $a_i$.\n\nThe next $q$ lines each contain several non-negative integers describing an operation.", "outputFormat": "For each operation of type `2`, output one line containing a non-negative integer representing the answer.", "hint": "Constraints  \nThis problem has $10$ test points.\n\nFor test points $1 \\sim 3$, $1 \\le n, q \\le 1000$.  \nFor test points $4, 5$, $1 \\le m \\le 5$.  \nFor test points $6 \\sim 10$, let $k$ be the test point index, then $m = k$.\n\nFor $100\\%$ of the testdata, $1 \\le n, q \\le 10^5$, $1 \\le m \\le 10$, and $0 \\le a_i, x < 2^m$.\n\n**Please pay attention to constant optimization.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "秘籍-反复异或", "background": "", "description": "给定一个长为 $n$ 的序列，支持操作：\n\n- `1 l r x`：将区间 $[l,r]$ 的所有元素加 $x$。\n- `2 l r` ：查询区间 $[l,r]$ 中所有元素异或和的后 $m$ 个二进制位的值。", "inputFormat": "第一行三个正整数 $n,m,q$，表示序列长度，位数，操作数。\n\n第二行 $n$ 个非负整数，表示原始序列 $a_i$。\n\n接下来 $q$ 行，每行若干个非负整数表示一个操作。", "outputFormat": "对于每个 $2$ 操作输出一行，一个非负整数表示答案。", "hint": "【数据范围】   \n本题共 $10$ 个测试点。\n\n对于测试点 $1 \\sim 3$，$1\\le n,q \\le 1000$；    \n对于测试点 $4,5$，$1 \\le m \\le 5$；   \n对于测试点 $6 \\sim 10$，设 $k$ 为测试点编号，有 $m=k$。  \n\n对于 $100\\%$ 的数据，$1 \\le n,q \\le 10^5$，$1\\le m \\le 10$，$0\\le a_i,x < 2^m$。\n\n**请注意常数优化。**", "locale": "zh-CN"}}}
{"pid": "P5671", "type": "P", "difficulty": 2, "samples": [["60 1 1", "30 60\n1.41421"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟"], "title": "「SWTR-2」Triangles", "background": "小 $\\mathrm{A}$ 在学数学。", "description": "他遇到了两个谜题：\n\n- 在一个平面内，**线段** $DE$ 与**直线** $FG$ 相交于点 $O$，已知 $\\angle DOF=x^{\\circ}$，请你在**直线** $FG$ 上找一点 $P$，使得 $\\triangle DOP$ 为**等腰**三角形，求 $\\angle D$ 的度数。（如果答案不是整数，则保留 $1$ 位小数）\n\n- 已知一个**直角三角形**的两条边分别为 $m,n$，求第三条边的长度（保留 $5$ 位小数）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qjle5b4c.png)\n\n写一个程序求出问题的答案。", "inputFormat": "一行三个**正整数**，分别为 $x,m,n$。", "outputFormat": "输出两行，第一行为第一问的答案，第二行为第二问的答案。\n\n如果有多解，请用**空格**隔开，且**从小到大**输出。", "hint": "---\n\n### 样例说明\n\n问题 $1$：\n\n- 当点 $P$ 在点 $O$ 左边时，形成的 $\\triangle DOP$ 为等边三角形，$\\angle D=60^{\\circ}$。\n\n- 当点 $P$ 在点 $O$ 右边时，形成的 $\\triangle DOP$ 中，$\\angle DOP=180^{\\circ}-60^{\\circ}=120^{\\circ}$，为顶角，$\\angle D=(180^{\\circ}-120^{\\circ})/2=30^{\\circ}$。\n\n问题 $2$：\n\n第三条边为斜边，长度为 $\\sqrt{1^2+1^2}=\\sqrt{2}=1.41421\\dots$。\n\n---\n\n### 数据范围与约定\n\n$x<90,m\\leq n\\leq 10^9$。\n\n---\n\n### 出题组提示：\n\n**方法千万条，审题第一条，多解不考虑，爆零两行泪。**", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-2\" Triangles", "background": "Little $\\mathrm{A}$ is learning math.", "description": "He encountered two puzzles:\n\n- In a plane, the **line segment** $DE$ intersects the **line** $FG$ at point $O$. Given $\\angle DOF=x^{\\circ}$, find a point $P$ on the **line** $FG$ such that $\\triangle DOP$ is an **isosceles** triangle, and compute the measure of $\\angle D$. (If the answer is not an integer, keep $1$ decimal place.)\n\n- Given a **right triangle** with two sides $m,n$, find the length of the third side (keep $5$ decimal places).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qjle5b4c.png)\n\nWrite a program to compute the answers to the problems.", "inputFormat": "One line with three **positive integers**: $x,m,n$.", "outputFormat": "Output two lines. The first line is the answer to the first question, and the second line is the answer to the second question.\n\nIf there are multiple solutions, separate them with **spaces** and output them in **increasing** order.", "hint": "---\n\n### Sample Explanation\n\nProblem $1$:\n\n- When point $P$ is to the left of point $O$, the formed $\\triangle DOP$ is an equilateral triangle, so $\\angle D=60^{\\circ}$.\n\n- When point $P$ is to the right of point $O$, in the formed $\\triangle DOP$, $\\angle DOP=180^{\\circ}-60^{\\circ}=120^{\\circ}$ is the vertex angle, so $\\angle D=(180^{\\circ}-120^{\\circ})/2=30^{\\circ}$.\n\nProblem $2$:\n\nThe third side is the hypotenuse, with length $\\sqrt{1^2+1^2}=\\sqrt{2}=1.41421\\dots$.\n\n---\n\n### Constraints and Notes\n\n$x<90,m\\leq n\\leq 10^9$.\n\n---\n\n### Problem Setter's Hint\n\n**There are countless methods, but reading carefully comes first. Multiple solutions are not considered, and a wrong answer brings two lines of tears.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-2」Triangles", "background": "小 $\\mathrm{A}$ 在学数学。", "description": "他遇到了两个谜题：\n\n- 在一个平面内，**线段** $DE$ 与**直线** $FG$ 相交于点 $O$，已知 $\\angle DOF=x^{\\circ}$，请你在**直线** $FG$ 上找一点 $P$，使得 $\\triangle DOP$ 为**等腰**三角形，求 $\\angle D$ 的度数。（如果答案不是整数，则保留 $1$ 位小数）\n\n- 已知一个**直角三角形**的两条边分别为 $m,n$，求第三条边的长度（保留 $5$ 位小数）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qjle5b4c.png)\n\n写一个程序求出问题的答案。", "inputFormat": "一行三个**正整数**，分别为 $x,m,n$。", "outputFormat": "输出两行，第一行为第一问的答案，第二行为第二问的答案。\n\n如果有多解，请用**空格**隔开，且**从小到大**输出。", "hint": "---\n\n### 样例说明\n\n问题 $1$：\n\n- 当点 $P$ 在点 $O$ 左边时，形成的 $\\triangle DOP$ 为等边三角形，$\\angle D=60^{\\circ}$。\n\n- 当点 $P$ 在点 $O$ 右边时，形成的 $\\triangle DOP$ 中，$\\angle DOP=180^{\\circ}-60^{\\circ}=120^{\\circ}$，为顶角，$\\angle D=(180^{\\circ}-120^{\\circ})/2=30^{\\circ}$。\n\n问题 $2$：\n\n第三条边为斜边，长度为 $\\sqrt{1^2+1^2}=\\sqrt{2}=1.41421\\dots$。\n\n---\n\n### 数据范围与约定\n\n$x<90,m\\leq n\\leq 10^9$。\n\n---\n\n### 出题组提示：\n\n**方法千万条，审题第一条，多解不考虑，爆零两行泪。**", "locale": "zh-CN"}}}
{"pid": "P5672", "type": "P", "difficulty": 4, "samples": [["4 998244353\n1 2 3 4\nGPGG", "19"], ["3 998244353\n3 7 5\nPGG", "45"], ["10 998244353\n12345 23456 34567 45678 56789 67890 78901 89012 90123 101234\nGPPGPGGGPG", "104157290"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384]}, "tags": ["模拟"], "title": "「SWTR-2」Crystal Balls", "background": "$\\mathrm{Ethan}$ 有一些可以释放强大能量的水晶球，他将要用这些水晶球合成可以消灭敌人的魔法。\n\n- $a\\equiv b\\mathrm{\\ (mod\\ m)}$ 表示 $a$ 和 $b$ 对模 $m$ 同余，即 $(a-b)/m$ 为整数。", "description": "$\\mathrm{Ethan}$ 有 $n$ 个水晶球，现在他将这些水晶球排成一行，每一个水晶球上面有一个能量值，且**要么是绿色，要么是紫色**。\n\n- 下文中，$P$ 代表紫色，$G$ 代表绿色。\n\n$\\mathrm{Ethan}$ 现在要按以下方式取走这些水晶球：\n\n1. 取走**最左端**的水晶球。\n\n2. 假设取走的水晶球的颜色为 $c_1$，能值为 $x_1$，**剩余最左端**的水晶球的颜色为 $c_2$，能量为 $x_2$，取出水晶的次数为 $cnt$（包括这一次）。\n\n- 如果 $c_1=c_2$，那么 $\\mathrm{Ethan}$ 会将这两个水晶球合成为一个大水晶球（本次取出的水晶球仍计入答案总数内，详情见样例），颜色为 $c_1$，能量值为 $x_1 \\times x_2$，放在水晶球序列的**最左端**。\n\n- 如果，$c_1=P,c_2=G,cnt\\equiv 1\\mathrm{\\ (mod\\ 2)}$，那么 $\\mathrm{Ethan}$ 会将剩下的水晶球的**颜色反转**（即绿色变紫色，紫色变绿色）。\n\n- 如果仍不能满足上面的条件，那么 $\\mathrm{Ethan}$ 会将剩下的水晶球**序列翻转**。\n\n就这样，直到最后只剩下一个球，此时 $\\mathrm{Ethan}$ 会直接取走最后一个球，求取走的水晶球的**能量值之和**。\n\n由于答案很大，请对 $p$ 取模。", "inputFormat": "第一行，两个**正整数** $n,p$，分别表示水晶球的个数和模数。\n\n第二行，$n$ 个**正整数** $a_1,a_2,\\dots,a_n$，$a_i$ 表示第 $i$ 个水晶球的能量值。\n\n第三行，一个由字符 $P$ 和字符 $G$ 组成的字符串，如果第 $i$ 个字符为```P```，那么该水晶球是紫色，否则为绿色。", "outputFormat": "一个整数，表示取走的水晶球的能量值之和对 $p$ 取模的值。", "hint": "---\n\n### 样例说明\n\n**样例 $1$：**\n\n$\\mathrm{Ethan}$ 首先会取出最左端的水晶球，颜色为 ```G```，答案加上它上面所写上的数字，即 $1$，剩下的水晶球翻转，序列变为 $4\\ 3\\ 2$ ```GGP```。（因为 $c_1=G,c_2=P$，取出水晶球的次数为奇数，不满足条件 $1,2$，所以序列翻转）。\n\n再取出最左端的水晶球，颜色为 ```G```，答案加上 $4$，接着把剩下来最左端的水晶球与取走的水晶球合并成一个大的水晶球，写上的数字为 $12$，序列变为 $12\\ 2$ ```GP```。\n\n取出最左边的水晶球，颜色为 ```G```，答案加上 $12$，剩下的水晶球序列翻转，序列变为 $2$ ```P```。\n\n取出最后一个的水晶球，答案加上 $2$，最终答案为 $1+4+12+2=19$。\n\n**样例 $2$：**\n\n先取出 $3$，$c_1=P,c_2=G,cnt=1$，颜色翻转\n\n取出 $7$，$c_2=c_3=P$，将 $x_3$ 乘上 $x_2$，得到 $x_3=35$\n\n取出 $35$，最终答案为 $3+7+35=45$\n\n---\n\n### 数据范围与约定\n\n本题采用 $\\mathrm{Subtask}$ 制。\n\n$\\mathrm{Subtask}\\ 1:n\\leq 2000,a_i\\leq 10^9,p\\leq 10^9,15\\%$。\n\n$\\mathrm{Subtask}\\ 2:n\\leq 5\\times 10^4,a_i\\leq 10^9,p\\leq 10^9,15\\%$。\n\n$\\mathrm{Subtask}\\ 3:n\\leq 5\\times 10^4,a_i\\leq 10^{18},p\\leq 10^{18},20\\%$。\n\n$\\mathrm{Subtask}\\ 4:n\\leq 10^6,a_i\\leq 10^9,p\\leq 10^9,20\\%$。\n\n$\\mathrm{Subtask}\\ 5:n\\leq 10^6,a_i\\leq 10^{18},p\\leq 10^{18},30\\%$。\n\n---\n\n对于所有测试点，时间限制 $1s$，空间限制 $16MB$。", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-2\" Crystal Balls", "background": "$\\mathrm{Ethan}$ has some crystal balls that can release powerful energy. He is going to use these crystal balls to combine magic that can destroy enemies.\n\n- $a\\equiv b\\mathrm{\\ (mod\\ m)}$ means that $a$ and $b$ are congruent modulo $m$, i.e., $(a-b)/m$ is an integer.", "description": "$\\mathrm{Ethan}$ has $n$ crystal balls. Now he arranges these crystal balls in a row. Each crystal ball has an energy value, and is **either green or purple**.\n\n- In the following, $P$ stands for purple, and $G$ stands for green.\n\n$\\mathrm{Ethan}$ will take away these crystal balls in the following way:\n\n1. Take away the **leftmost** crystal ball.\n\n2. Suppose the removed crystal ball has color $c_1$ and energy $x_1$, the **current leftmost** remaining crystal ball has color $c_2$ and energy $x_2$, and the number of times a crystal ball has been removed is $cnt$ (including this time).\n\n- If $c_1=c_2$, then $\\mathrm{Ethan}$ will combine these two crystal balls into one large crystal ball (the crystal ball removed this time is still counted in the total answer; see samples for details), with color $c_1$ and energy value $x_1 \\times x_2$, and put it at the **left end** of the crystal ball sequence.\n\n- If $c_1=P,c_2=G,cnt\\equiv 1\\mathrm{\\ (mod\\ 2)}$, then $\\mathrm{Ethan}$ will **flip the colors** of the remaining crystal balls (i.e., green becomes purple, and purple becomes green).\n\n- If the above conditions still cannot be satisfied, then $\\mathrm{Ethan}$ will **reverse the remaining sequence** of crystal balls.\n\nHe keeps doing this until only one ball remains. Then $\\mathrm{Ethan}$ will directly take away the last ball. Find the **sum of the energy values** of all removed crystal balls.\n\nSince the answer can be very large, take it modulo $p$.", "inputFormat": "The first line contains two **positive integers** $n,p$, representing the number of crystal balls and the modulus.\n\nThe second line contains $n$ **positive integers** $a_1,a_2,\\dots,a_n$, where $a_i$ is the energy value of the $i$-th crystal ball.\n\nThe third line contains a string consisting of characters $P$ and $G$. If the $i$-th character is ```P```, then the crystal ball is purple; otherwise it is green.", "outputFormat": "Output one integer, the sum of the energy values of the removed crystal balls modulo $p$.", "hint": "---\n\n### Sample Explanation\n\n**Sample $1$:**\n\n$\\mathrm{Ethan}$ first removes the leftmost crystal ball, whose color is ```G```. Add the number written on it to the answer, i.e., $1$. Then the remaining crystal balls are reversed, and the sequence becomes $4\\ 3\\ 2$ ```GGP```. (Because $c_1=G,c_2=P$, and the removal count is odd, it does not satisfy conditions 1 or 2, so the sequence is reversed.)\n\nThen remove the leftmost crystal ball, whose color is ```G```. Add $4$ to the answer. Next, combine the current leftmost remaining crystal ball with the removed one into a large crystal ball with number $12$. The sequence becomes $12\\ 2$ ```GP```.\n\nRemove the leftmost crystal ball, whose color is ```G```. Add $12$ to the answer. Reverse the remaining sequence, which becomes $2$ ```P```.\n\nRemove the last crystal ball. Add $2$ to the answer. The final answer is $1+4+12+2=19$.\n\n**Sample $2$:**\n\nFirst remove $3$, $c_1=P,c_2=G,cnt=1$, so flip the colors.\n\nRemove $7$, $c_2=c_3=P$, multiply $x_3$ by $x_2$, getting $x_3=35$.\n\nRemove $35$, and the final answer is $3+7+35=45$.\n\n---\n\n### Constraints and Notes\n\nThis problem uses $\\mathrm{Subtask}$.\n\n$\\mathrm{Subtask}\\ 1:n\\leq 2000,a_i\\leq 10^9,p\\leq 10^9,15\\%$.\n\n$\\mathrm{Subtask}\\ 2:n\\leq 5\\times 10^4,a_i\\leq 10^9,p\\leq 10^9,15\\%$.\n\n$\\mathrm{Subtask}\\ 3:n\\leq 5\\times 10^4,a_i\\leq 10^{18},p\\leq 10^{18},20\\%$.\n\n$\\mathrm{Subtask}\\ 4:n\\leq 10^6,a_i\\leq 10^9,p\\leq 10^9,20\\%$.\n\n$\\mathrm{Subtask}\\ 5:n\\leq 10^6,a_i\\leq 10^{18},p\\leq 10^{18},30\\%$.\n\n---\n\nFor all testdata, the time limit is $1s$, and the memory limit is $16MB$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-2」Crystal Balls", "background": "$\\mathrm{Ethan}$ 有一些可以释放强大能量的水晶球，他将要用这些水晶球合成可以消灭敌人的魔法。\n\n- $a\\equiv b\\mathrm{\\ (mod\\ m)}$ 表示 $a$ 和 $b$ 对模 $m$ 同余，即 $(a-b)/m$ 为整数。", "description": "$\\mathrm{Ethan}$ 有 $n$ 个水晶球，现在他将这些水晶球排成一行，每一个水晶球上面有一个能量值，且**要么是绿色，要么是紫色**。\n\n- 下文中，$P$ 代表紫色，$G$ 代表绿色。\n\n$\\mathrm{Ethan}$ 现在要按以下方式取走这些水晶球：\n\n1. 取走**最左端**的水晶球。\n\n2. 假设取走的水晶球的颜色为 $c_1$，能值为 $x_1$，**剩余最左端**的水晶球的颜色为 $c_2$，能量为 $x_2$，取出水晶的次数为 $cnt$（包括这一次）。\n\n- 如果 $c_1=c_2$，那么 $\\mathrm{Ethan}$ 会将这两个水晶球合成为一个大水晶球（本次取出的水晶球仍计入答案总数内，详情见样例），颜色为 $c_1$，能量值为 $x_1 \\times x_2$，放在水晶球序列的**最左端**。\n\n- 如果，$c_1=P,c_2=G,cnt\\equiv 1\\mathrm{\\ (mod\\ 2)}$，那么 $\\mathrm{Ethan}$ 会将剩下的水晶球的**颜色反转**（即绿色变紫色，紫色变绿色）。\n\n- 如果仍不能满足上面的条件，那么 $\\mathrm{Ethan}$ 会将剩下的水晶球**序列翻转**。\n\n就这样，直到最后只剩下一个球，此时 $\\mathrm{Ethan}$ 会直接取走最后一个球，求取走的水晶球的**能量值之和**。\n\n由于答案很大，请对 $p$ 取模。", "inputFormat": "第一行，两个**正整数** $n,p$，分别表示水晶球的个数和模数。\n\n第二行，$n$ 个**正整数** $a_1,a_2,\\dots,a_n$，$a_i$ 表示第 $i$ 个水晶球的能量值。\n\n第三行，一个由字符 $P$ 和字符 $G$ 组成的字符串，如果第 $i$ 个字符为```P```，那么该水晶球是紫色，否则为绿色。", "outputFormat": "一个整数，表示取走的水晶球的能量值之和对 $p$ 取模的值。", "hint": "---\n\n### 样例说明\n\n**样例 $1$：**\n\n$\\mathrm{Ethan}$ 首先会取出最左端的水晶球，颜色为 ```G```，答案加上它上面所写上的数字，即 $1$，剩下的水晶球翻转，序列变为 $4\\ 3\\ 2$ ```GGP```。（因为 $c_1=G,c_2=P$，取出水晶球的次数为奇数，不满足条件 $1,2$，所以序列翻转）。\n\n再取出最左端的水晶球，颜色为 ```G```，答案加上 $4$，接着把剩下来最左端的水晶球与取走的水晶球合并成一个大的水晶球，写上的数字为 $12$，序列变为 $12\\ 2$ ```GP```。\n\n取出最左边的水晶球，颜色为 ```G```，答案加上 $12$，剩下的水晶球序列翻转，序列变为 $2$ ```P```。\n\n取出最后一个的水晶球，答案加上 $2$，最终答案为 $1+4+12+2=19$。\n\n**样例 $2$：**\n\n先取出 $3$，$c_1=P,c_2=G,cnt=1$，颜色翻转\n\n取出 $7$，$c_2=c_3=P$，将 $x_3$ 乘上 $x_2$，得到 $x_3=35$\n\n取出 $35$，最终答案为 $3+7+35=45$\n\n---\n\n### 数据范围与约定\n\n本题采用 $\\mathrm{Subtask}$ 制。\n\n$\\mathrm{Subtask}\\ 1:n\\leq 2000,a_i\\leq 10^9,p\\leq 10^9,15\\%$。\n\n$\\mathrm{Subtask}\\ 2:n\\leq 5\\times 10^4,a_i\\leq 10^9,p\\leq 10^9,15\\%$。\n\n$\\mathrm{Subtask}\\ 3:n\\leq 5\\times 10^4,a_i\\leq 10^{18},p\\leq 10^{18},20\\%$。\n\n$\\mathrm{Subtask}\\ 4:n\\leq 10^6,a_i\\leq 10^9,p\\leq 10^9,20\\%$。\n\n$\\mathrm{Subtask}\\ 5:n\\leq 10^6,a_i\\leq 10^{18},p\\leq 10^{18},30\\%$。\n\n---\n\n对于所有测试点，时间限制 $1s$，空间限制 $16MB$。", "locale": "zh-CN"}}}
{"pid": "P5673", "type": "P", "difficulty": 5, "samples": [["6 11 3\n1 1 1 2 1 3\n7 3 8 9 6 5\n1 1\n1 2\n1 3\n1 4\n1 5\n1 6\n2 6\n3 6\n4 6\n5 6\n6 6", "7\n10\n11\n20\n23\n28\n28\n28\n20\n11\n5"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 750, 750, 750, 750, 750, 750, 750, 750, 750, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树状数组"], "title": "「SWTR-2」Picking Gifts", "background": "$\\mathrm{Sunny}$ 有个 $npy$ 叫做小 $\\mathrm{b}$。\n\n小 $\\mathrm{b}$ 的生日就要到了，$\\mathrm{Sunny}$ 想给她买一些礼物。", "description": "商店里摆着琳琅满目的商品，每个商品都有：\n\n- 编号，**从左到右**依次为 $1,2,\\dots n$。\n\n- 种类，分别为 $p_1,p_2,\\dots p_n$。\n\n- 价值，分别为 $v_1,v_2,\\dots v_n$。\n\n$\\mathrm{Sunny}$ 想从中挑选一个区间，将这个区间里的所有礼物买下来送给小 $\\mathrm{b}$。\n\n小 $\\mathrm{b}$ 会**从右往左**依次查看 $\\mathrm{Sunny}$ 送给他的礼物，如果她看到同一种类的礼物出现了 $k$ 次，那么她就不会再去查看这种礼物（包括第 $k$ 个），当然，这些礼物也就失去了原本的价值。\n\n现在，$\\mathrm{Sunny}$ 给你了 $m$ 个区间，想让你求出在小 $\\mathrm{b}$ 眼中，这个区间的价值。\n\n具体的价值计算见样例。", "inputFormat": "第一行由空格隔开的三个正整数 $n,m,k$。\n\n第二行 $n$ 个由空格隔开的正整数，第 $i$ 个数代表 $p_i$。\n\n第三行 $n$ 个由空格隔开的正整数，第 $i$ 个数代表 $v_i$。\n\n接下来 $m$ 行，第 $i$ 行两个正整数 $l_i,r_i$，表示第 $i$ 次询问的区间。", "outputFormat": "输出 $m$ 行，对于每一个询问，输出一行一个整数 $v$，为这个区间在小 $\\mathrm{b}$ 眼中的价值。", "hint": "---\n\n### 样例说明\n\n$[1,1]:7$。\n\n$[1,2]:3+7=10$。\n\n$[1,3]:8+3=11$，因为编号为 $1$ 的礼物种类为 $1$，这是种类 $1$ 出现的第 $k(k=3)$ 次，所以她不会再看这种礼物（包括这个）。\n\n$[1,4]:9+8+3=20$。\n\n$[2,6]:5+6+9+8=28$。\n\n$[3,6]:5+6+9+8=28$。\n\n---\n\n### 数据范围与约定\n\n测试点 $1-4:n\\leq 100,m\\leq 100$。\n\n测试点 $5-6:n\\leq 5000,m\\leq 5000$。\n\n测试点 $7-10:n\\leq 2\\times 10^4,m\\leq 10^4$。\n\n测试点 $11-15:n\\leq 2\\times 10^5,m\\leq 2\\times 10^5$。\n\n测试点 $16-20:n\\leq 10^6,m\\leq 5\\times 10^5$。\n\n对于测试点 $1,2,7,8,11,12,16,17$，有 $k=n$，其余测试点有 $2\\leq k<n$。\n\n对于所有测试点，有 $1\\leq p_i\\leq n,1\\leq v_i\\leq 2000,1\\leq l \\leq r \\leq n$。\n\n---\n\n对于测试点 $1-10$，每个 $3$ 分。\n\n对于测试点 $11-20$ 中 $k=n$ 的，每个 $4$ 分。\n\n其余测试点每个 $9$ 分。\n\n---\n\n对于测试点 $1-6$，时间限制 $500\\rm ms$。\n\n对于测试点 $7-15$，时间限制 $750\\rm ms$。\n\n对于测试点 $16-20$，时间限制 $1.5\\rm s$。\n\n\n---\n\n当然了，SWTR-02 的出题人们是不可能有 girlfriends 的。", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-2\" Picking Gifts", "background": "$\\mathrm{Sunny}$ has an $npy$ called little $\\mathrm{b}$.\n\nLittle $\\mathrm{b}$'s birthday is coming soon, and $\\mathrm{Sunny}$ wants to buy her some gifts.", "description": "There are many items in the shop. Each item has:\n\n- An index, from left to right as $1,2,\\dots,n$.\n\n- A category, as $p_1,p_2,\\dots,p_n$.\n\n- A value, as $v_1,v_2,\\dots,v_n$.\n\n$\\mathrm{Sunny}$ wants to choose an interval and buy all gifts in this interval to give to little $\\mathrm{b}$.\n\nLittle $\\mathrm{b}$ will check the gifts from right to left. If she sees that gifts of the same category have appeared $k$ times, then she will not check this category anymore (including the $k$-th one). Of course, those gifts will then lose their original value.\n\nNow, $\\mathrm{Sunny}$ gives you $m$ intervals and wants you to compute, in little $\\mathrm{b}$'s view, the value of each interval.\n\nSee the sample for the detailed value calculation.", "inputFormat": "The first line contains three positive integers $n,m,k$ separated by spaces.\n\nThe second line contains $n$ positive integers separated by spaces, where the $i$-th number represents $p_i$.\n\nThe third line contains $n$ positive integers separated by spaces, where the $i$-th number represents $v_i$.\n\nThe next $m$ lines each contain two positive integers $l_i,r_i$, representing the interval of the $i$-th query.", "outputFormat": "Output $m$ lines. For each query, output one integer $v$ in one line, the value of this interval in little $\\mathrm{b}$'s view.", "hint": "---\n\n### Sample Explanation\n\n$[1,1]:7$.\n\n$[1,2]:3+7=10$.\n\n$[1,3]:8+3=11$, because the category of the gift with index $1$ is $1$, and this is the $k(k=3)$-th time category $1$ appears, so she will not check this category anymore (including this one).\n\n$[1,4]:9+8+3=20$.\n\n$[2,6]:5+6+9+8=28$.\n\n$[3,6]:5+6+9+8=28$.\n\n---\n\n### Constraints and Notes\n\nTestdata $1-4$: $n\\leq 100,m\\leq 100$.\n\nTestdata $5-6$: $n\\leq 5000,m\\leq 5000$.\n\nTestdata $7-10$: $n\\leq 2\\times 10^4,m\\leq 10^4$.\n\nTestdata $11-15$: $n\\leq 2\\times 10^5,m\\leq 2\\times 10^5$.\n\nTestdata $16-20$: $n\\leq 10^6,m\\leq 5\\times 10^5$.\n\nFor testdata $1,2,7,8,11,12,16,17$, $k=n$. For the other testdata, $2\\leq k<n$.\n\nFor all testdata, $1\\leq p_i\\leq n,1\\leq v_i\\leq 2000,1\\leq l \\leq r \\leq n$.\n\n---\n\nFor testdata $1-10$, each is worth $3$ points.\n\nFor testdata $11-20$ where $k=n$, each is worth $4$ points.\n\nAll other testdata are worth $9$ points each.\n\n---\n\nFor testdata $1-6$, the time limit is $500\\rm ms$.\n\nFor testdata $7-15$, the time limit is $750\\rm ms$.\n\nFor testdata $16-20$, the time limit is $1.5\\rm s$.\n\n---\n\nOf course, the setters of SWTR-02 cannot possibly have girlfriends.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-2」Picking Gifts", "background": "$\\mathrm{Sunny}$ 有个 $npy$ 叫做小 $\\mathrm{b}$。\n\n小 $\\mathrm{b}$ 的生日就要到了，$\\mathrm{Sunny}$ 想给她买一些礼物。", "description": "商店里摆着琳琅满目的商品，每个商品都有：\n\n- 编号，**从左到右**依次为 $1,2,\\dots n$。\n\n- 种类，分别为 $p_1,p_2,\\dots p_n$。\n\n- 价值，分别为 $v_1,v_2,\\dots v_n$。\n\n$\\mathrm{Sunny}$ 想从中挑选一个区间，将这个区间里的所有礼物买下来送给小 $\\mathrm{b}$。\n\n小 $\\mathrm{b}$ 会**从右往左**依次查看 $\\mathrm{Sunny}$ 送给他的礼物，如果她看到同一种类的礼物出现了 $k$ 次，那么她就不会再去查看这种礼物（包括第 $k$ 个），当然，这些礼物也就失去了原本的价值。\n\n现在，$\\mathrm{Sunny}$ 给你了 $m$ 个区间，想让你求出在小 $\\mathrm{b}$ 眼中，这个区间的价值。\n\n具体的价值计算见样例。", "inputFormat": "第一行由空格隔开的三个正整数 $n,m,k$。\n\n第二行 $n$ 个由空格隔开的正整数，第 $i$ 个数代表 $p_i$。\n\n第三行 $n$ 个由空格隔开的正整数，第 $i$ 个数代表 $v_i$。\n\n接下来 $m$ 行，第 $i$ 行两个正整数 $l_i,r_i$，表示第 $i$ 次询问的区间。", "outputFormat": "输出 $m$ 行，对于每一个询问，输出一行一个整数 $v$，为这个区间在小 $\\mathrm{b}$ 眼中的价值。", "hint": "---\n\n### 样例说明\n\n$[1,1]:7$。\n\n$[1,2]:3+7=10$。\n\n$[1,3]:8+3=11$，因为编号为 $1$ 的礼物种类为 $1$，这是种类 $1$ 出现的第 $k(k=3)$ 次，所以她不会再看这种礼物（包括这个）。\n\n$[1,4]:9+8+3=20$。\n\n$[2,6]:5+6+9+8=28$。\n\n$[3,6]:5+6+9+8=28$。\n\n---\n\n### 数据范围与约定\n\n测试点 $1-4:n\\leq 100,m\\leq 100$。\n\n测试点 $5-6:n\\leq 5000,m\\leq 5000$。\n\n测试点 $7-10:n\\leq 2\\times 10^4,m\\leq 10^4$。\n\n测试点 $11-15:n\\leq 2\\times 10^5,m\\leq 2\\times 10^5$。\n\n测试点 $16-20:n\\leq 10^6,m\\leq 5\\times 10^5$。\n\n对于测试点 $1,2,7,8,11,12,16,17$，有 $k=n$，其余测试点有 $2\\leq k<n$。\n\n对于所有测试点，有 $1\\leq p_i\\leq n,1\\leq v_i\\leq 2000,1\\leq l \\leq r \\leq n$。\n\n---\n\n对于测试点 $1-10$，每个 $3$ 分。\n\n对于测试点 $11-20$ 中 $k=n$ 的，每个 $4$ 分。\n\n其余测试点每个 $9$ 分。\n\n---\n\n对于测试点 $1-6$，时间限制 $500\\rm ms$。\n\n对于测试点 $7-15$，时间限制 $750\\rm ms$。\n\n对于测试点 $16-20$，时间限制 $1.5\\rm s$。\n\n\n---\n\n当然了，SWTR-02 的出题人们是不可能有 girlfriends 的。", "locale": "zh-CN"}}}
{"pid": "P5674", "type": "P", "difficulty": 6, "samples": [["7 1000000007 0\n3 7\n1 10\n1 1048576\n20180815 20180830\n20180632 20180639\n123456789 987654321\n123456789987654321 123456789987654321123456789987654321", "10 24\n17 96\n10485761 64327945\n255 803716286\n124 290111979\n996409842 54001814\n253678327 263109263"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["高精度", "数位 DP"], "title": "「SWTR-2」Magical Gates", "background": "小 $\\mathrm{A}$ 找到了一张藏宝图。\n\n他顺着藏宝图上的路线来到了一扇古老的大门前，门上有六芒星的图案。\n\n他把手轻轻地放在六芒星上……\n\n霎时间，六芒星光芒大放，四周亮如白昼。\n\n（新增一组大样例）", "description": "小 $\\mathrm{A}$ 面前出现了 $10^{1000}$ 扇门，每个门上都写着它自己的编号，分别为 $1,2,3,\\dots,10^{1000}$。\n\n这时，守门人小 $\\mathrm{M}$  向小 $\\mathrm{A}$ 走来。\n\n“这些门，并不普通，它有魔力。”\n\n“我会给你一些区间 $l,r$，请你求出区间 $[l,r]$ 里所有门的魔力值之**和**与魔力值之**积**。”\n\n“因为结果可能很大，请你将结果 $mod\\ p$。 ”\n\n“如果你正确地回答了所有询问，你将会拥有这扇门后的所有宝藏。”\n\n“哦，对了，一扇门的魔力值就是其在二进制下 $1$ 的个数。”\n\n简单来说，记第 $i$ 扇门的魔力值为 $d_i$，给定的区间为 $[l,r]$，请求出：\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$\n\n由于门的数量实在太多，小 $\\mathrm{A}$ 决定向你请求帮助。", "inputFormat": "第一行三个正整数 $T,p,n$（$n$ 会在数据范围中说明）。\n\n接下来 $T$ 行，第 $i$ 行两个**正整数** $l_i,r_i$。", "outputFormat": "输出 $T$ 行，每行 $2$ 个数，由空格隔开，第 $i$ 行分别为：\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$", "hint": "---\n\n### 样例说明\n\n数据 $1$：\n\n$$\\sum_{3}^{7}d_i=2+1+2+2+3=10$$\n\n$$\\prod_{3}^{7}d_i=2\\times 1\\times 2\\times 2\\times 3=24$$\n\n数据 $2$：\n\n$$\\sum_{1}^{10}d_i=1+1+2+1+2+2+3+1+2+2=17$$\n\n$$\\prod_{1}^{10}d_i=1\\times 1\\times 2\\times 1\\times 2\\times 2\\times 3\\times 1\\times 2\\times 2=96$$\n\n---\n\n### 数据范围与约定\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zv6ppsk4.png)\n\n为了方便拿部分分，输入格式中的 $n$ 为**该测试点的编号**。\n\n所有具有特殊性质的测试点一共 $31\\%$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq 27,1\\leq T \\leq 10,10^9 \\leq p \\leq 1.001\\times 10^9,1\\leq l\\leq r\\leq 10^{1000}$，**保证 $p$ 为质数**。\n\n---\n\n对于测试点 $1-20$，时限 $300ms$，剩下的 $7$ 个测试点时限 $2s$。\n\n对于所有测试点，空间限制 $256MB$\n\n---\n\n“吱嘎”一声，封尘千年的大门缓缓打开。\n\n刺眼的金光照了出来……", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-2\" Magical Gates", "background": "Little $\\mathrm{A}$ found a treasure map.\n\nFollowing the route on the map, he arrived at an ancient gate with a hexagram pattern on it.\n\nHe gently placed his hand on the hexagram...\n\nIn an instant, the hexagram shone brightly, and the surroundings became as bright as day.\n\n(One new large sample has been added.)", "description": "In front of Little $\\mathrm{A}$ appeared $10^{1000}$ gates. Each gate has its own index written on it, namely $1,2,3,\\dots,10^{1000}$.\n\nAt this moment, the gatekeeper Little $\\mathrm{M}$ walked up to Little $\\mathrm{A}$.\n\n\"These gates are not ordinary. They have magic.\"\n\n\"I will give you some intervals $l,r$. Please find the **sum** and the **product** of the magic values of all gates in the interval $[l,r]$.\"\n\n\"Since the result may be very large, output the result $mod\\ p$.\"\n\n\"If you answer all queries correctly, you will own all the treasure behind this gate.\"\n\n\"Oh, right. The magic value of a gate is the number of $1$ bits in its binary representation.\"\n\nIn short, let the magic value of the $i$-th gate be $d_i$. Given an interval $[l,r]$, compute:\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$\n\nBecause there are far too many gates, Little $\\mathrm{A}$ decided to ask you for help.", "inputFormat": "The first line contains three positive integers $T,p,n$ ($n$ will be explained in Constraints).\n\nThe next $T$ lines: on the $i$-th line there are two **positive integers** $l_i,r_i$.", "outputFormat": "Output $T$ lines. Each line contains $2$ numbers separated by a space. The $i$-th line should be:\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$", "hint": "---\n\n### Sample Explanation\n\nTestdata 1:\n\n$$\\sum_{3}^{7}d_i=2+1+2+2+3=10$$\n\n$$\\prod_{3}^{7}d_i=2\\times 1\\times 2\\times 2\\times 3=24$$\n\nTestdata 2:\n\n$$\\sum_{1}^{10}d_i=1+1+2+1+2+2+3+1+2+2=17$$\n\n$$\\prod_{1}^{10}d_i=1\\times 1\\times 2\\times 1\\times 2\\times 2\\times 3\\times 1\\times 2\\times 2=96$$\n\n---\n\n### Constraints and Notes\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zv6ppsk4.png)\n\nTo make it easier to get partial scores, the $n$ in the input format is the **index of the current test point**.\n\nAll test points with special properties take up a total of $31\\%$.\n\nFor $100\\%$ of the data, $1\\leq n\\leq 27,1\\leq T \\leq 10,10^9 \\leq p \\leq 1.001\\times 10^9,1\\leq l\\leq r\\leq 10^{1000}$, and **$p$ is guaranteed to be prime**.\n\n---\n\nFor test points $1-20$, the time limit is $300ms$, and for the remaining $7$ test points the time limit is $2s$.\n\nFor all test points, the memory limit is $256MB$.\n\n---\n\nWith a \"creak\", the dust-covered gate that had been sealed for a thousand years slowly opened.\n\nA dazzling golden light shone out...\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-2」Magical Gates", "background": "小 $\\mathrm{A}$ 找到了一张藏宝图。\n\n他顺着藏宝图上的路线来到了一扇古老的大门前，门上有六芒星的图案。\n\n他把手轻轻地放在六芒星上……\n\n霎时间，六芒星光芒大放，四周亮如白昼。\n\n（新增一组大样例）", "description": "小 $\\mathrm{A}$ 面前出现了 $10^{1000}$ 扇门，每个门上都写着它自己的编号，分别为 $1,2,3,\\dots,10^{1000}$。\n\n这时，守门人小 $\\mathrm{M}$  向小 $\\mathrm{A}$ 走来。\n\n“这些门，并不普通，它有魔力。”\n\n“我会给你一些区间 $l,r$，请你求出区间 $[l,r]$ 里所有门的魔力值之**和**与魔力值之**积**。”\n\n“因为结果可能很大，请你将结果 $mod\\ p$。 ”\n\n“如果你正确地回答了所有询问，你将会拥有这扇门后的所有宝藏。”\n\n“哦，对了，一扇门的魔力值就是其在二进制下 $1$ 的个数。”\n\n简单来说，记第 $i$ 扇门的魔力值为 $d_i$，给定的区间为 $[l,r]$，请求出：\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$\n\n由于门的数量实在太多，小 $\\mathrm{A}$ 决定向你请求帮助。", "inputFormat": "第一行三个正整数 $T,p,n$（$n$ 会在数据范围中说明）。\n\n接下来 $T$ 行，第 $i$ 行两个**正整数** $l_i,r_i$。", "outputFormat": "输出 $T$ 行，每行 $2$ 个数，由空格隔开，第 $i$ 行分别为：\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$", "hint": "---\n\n### 样例说明\n\n数据 $1$：\n\n$$\\sum_{3}^{7}d_i=2+1+2+2+3=10$$\n\n$$\\prod_{3}^{7}d_i=2\\times 1\\times 2\\times 2\\times 3=24$$\n\n数据 $2$：\n\n$$\\sum_{1}^{10}d_i=1+1+2+1+2+2+3+1+2+2=17$$\n\n$$\\prod_{1}^{10}d_i=1\\times 1\\times 2\\times 1\\times 2\\times 2\\times 3\\times 1\\times 2\\times 2=96$$\n\n---\n\n### 数据范围与约定\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zv6ppsk4.png)\n\n为了方便拿部分分，输入格式中的 $n$ 为**该测试点的编号**。\n\n所有具有特殊性质的测试点一共 $31\\%$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq 27,1\\leq T \\leq 10,10^9 \\leq p \\leq 1.001\\times 10^9,1\\leq l\\leq r\\leq 10^{1000}$，**保证 $p$ 为质数**。\n\n---\n\n对于测试点 $1-20$，时限 $300ms$，剩下的 $7$ 个测试点时限 $2s$。\n\n对于所有测试点，空间限制 $256MB$\n\n---\n\n“吱嘎”一声，封尘千年的大门缓缓打开。\n\n刺眼的金光照了出来……", "locale": "zh-CN"}}}
{"pid": "P5675", "type": "P", "difficulty": 5, "samples": [["3\n2 4 5", "5"], ["3\n1 2 2", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "博弈论", "2017", "各省省选", "O2优化", "贵州"], "title": "[GZOI2017] 取石子游戏", "background": "GZOI2017 D1T1", "description": "Alice 和 Bob 在玩一个古老的游戏。现在有若干堆石子，Alice 和 Bob 轮流取，每次可以选择其中某一堆的石子中取出任意颗石子，但不能不取，谁先取完使得另一个人不能取了算赢。\n\n现在场地上有 $N$ 堆石子，编号为 $1$ 至 $N$。Alice 很快发现了这个游戏存在一些固定的策略。阴险的 Alice 想赢得这场比赛就来找到主办方你，希望你在这 $N$ 堆石子中选出若干堆石子作为最后游戏用的石子堆并使得 Alice 能获得胜利。你自然不想让 Alice 得逞，所以你提出了一个条件：Alice 在这个游戏中第一次取的那堆石子的编号需要你来指定（仅指定取的石子堆编号，不指定第一次取多少个，这个指定的石子堆必然包含在最后游戏用的石子堆中）。\n\n现在你很好奇，你想算算有多少种方案让 Alice 不能获胜。注意，即使选出的石子堆的编号的集合完全相同，指定第一次取的石子堆的编号不同，也认为方案是不同的。", "inputFormat": "第一行，一个正整数 $N$，表示石子堆数。\n\n第二行，$N$ 个正整数，表示各堆石子的数量，按编号 $1$ 至 $N$ 依次给出。", "outputFormat": "一行，表示方案数。答案对 $10^9+7$ 取模。", "hint": "【样例 $1$ 解释】\n\n第一种：选编号 $1$ 和编号 $2$，指定编号 $1$。\n\n第二种：选编号 $1$ 和编号 $3$，指定编号 $1$。\n\n第三种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $2$。\n\n第四种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $3$。\n\n第五种：选编号 $2$ 和编号 $3$，指定编号 $2$。\n\n【数据约束】\n\n| 数据编号 | $N$ | 每堆石子数量 |\n| :-: | :-: | :-: |\n| $1$ | $\\le 5$ | $\\le 5$ |\n| $2$ | $\\le 10$ | $\\le 10$ |\n| $3$ | $\\le 100$ | $\\le 100$ |\n| $4$ | $\\le 200$ | $\\le 200$ |\n| $5$ | $\\le 200$ | $\\le 200$ |", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Stone Taking Game", "background": "GZOI2017 D1T1", "description": "Alice and Bob are playing an ancient game. There are several piles of stones. Alice and Bob take turns to take stones. Each time, a player may choose one pile and take any number of stones from it, but they must take at least one stone. Whoever takes the last stone so that the other player cannot move wins.\n\nNow there are $N$ piles of stones on the field, numbered from $1$ to $N$. Alice quickly discovered that this game has some fixed strategies. Cunning Alice wants to win this match, so she comes to you, the organizer, and asks you to select some piles from these $N$ piles as the piles used in the final game, such that Alice can win. Of course you do not want Alice to succeed, so you propose a condition: the pile that Alice takes from in her first move must be designated by you (you only designate the pile index, not how many stones she takes). This designated pile must be included among the piles chosen for the final game.\n\nNow you are curious and want to compute how many different plans make it impossible for Alice to win. Note that even if the set of chosen pile indices is exactly the same, plans are still considered different if the designated pile index for the first move is different.", "inputFormat": "The first line contains a positive integer $N$, denoting the number of piles.\n\nThe second line contains $N$ positive integers, denoting the number of stones in each pile, given in order from pile $1$ to pile $N$.", "outputFormat": "Output one line containing the number of plans. The answer should be taken modulo $10^9+7$.", "hint": "[Sample $1$ Explanation]\n\nThe first plan: choose piles $1$ and $2$, and designate pile $1$.\n\nThe second plan: choose piles $1$ and $3$, and designate pile $1$.\n\nThe third plan: choose piles $1$, $2$, and $3$, and designate pile $2$.\n\nThe fourth plan: choose piles $1$, $2$, and $3$, and designate pile $3$.\n\nThe fifth plan: choose piles $2$ and $3$, and designate pile $2$.\n\n[Constraints]\n\n| Testdata ID | $N$ | Stones in each pile |\n| :-: | :-: | :-: |\n| $1$ | $\\le 5$ | $\\le 5$ |\n| $2$ | $\\le 10$ | $\\le 10$ |\n| $3$ | $\\le 100$ | $\\le 100$ |\n| $4$ | $\\le 200$ | $\\le 200$ |\n| $5$ | $\\le 200$ | $\\le 200$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 取石子游戏", "background": "GZOI2017 D1T1", "description": "Alice 和 Bob 在玩一个古老的游戏。现在有若干堆石子，Alice 和 Bob 轮流取，每次可以选择其中某一堆的石子中取出任意颗石子，但不能不取，谁先取完使得另一个人不能取了算赢。\n\n现在场地上有 $N$ 堆石子，编号为 $1$ 至 $N$。Alice 很快发现了这个游戏存在一些固定的策略。阴险的 Alice 想赢得这场比赛就来找到主办方你，希望你在这 $N$ 堆石子中选出若干堆石子作为最后游戏用的石子堆并使得 Alice 能获得胜利。你自然不想让 Alice 得逞，所以你提出了一个条件：Alice 在这个游戏中第一次取的那堆石子的编号需要你来指定（仅指定取的石子堆编号，不指定第一次取多少个，这个指定的石子堆必然包含在最后游戏用的石子堆中）。\n\n现在你很好奇，你想算算有多少种方案让 Alice 不能获胜。注意，即使选出的石子堆的编号的集合完全相同，指定第一次取的石子堆的编号不同，也认为方案是不同的。", "inputFormat": "第一行，一个正整数 $N$，表示石子堆数。\n\n第二行，$N$ 个正整数，表示各堆石子的数量，按编号 $1$ 至 $N$ 依次给出。", "outputFormat": "一行，表示方案数。答案对 $10^9+7$ 取模。", "hint": "【样例 $1$ 解释】\n\n第一种：选编号 $1$ 和编号 $2$，指定编号 $1$。\n\n第二种：选编号 $1$ 和编号 $3$，指定编号 $1$。\n\n第三种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $2$。\n\n第四种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $3$。\n\n第五种：选编号 $2$ 和编号 $3$，指定编号 $2$。\n\n【数据约束】\n\n| 数据编号 | $N$ | 每堆石子数量 |\n| :-: | :-: | :-: |\n| $1$ | $\\le 5$ | $\\le 5$ |\n| $2$ | $\\le 10$ | $\\le 10$ |\n| $3$ | $\\le 100$ | $\\le 100$ |\n| $4$ | $\\le 200$ | $\\le 200$ |\n| $5$ | $\\le 200$ | $\\le 200$ |", "locale": "zh-CN"}}}
{"pid": "P5676", "type": "P", "difficulty": 4, "samples": [["5\n1\n100000\n100000\n5\n1 2 6 15 35\n5 7 9 2 3\n5\n2 3 5 35 21\n7 11 7 3 2\n10\n6 15 77 12 24 37 35 99 55 42\n4 2 5 7 11 3 6 8 9 10\n10\n6540 5604 567 57065 60 670 6870 1230 465 6540\n12 5 37 3 34 13 17 18 10 12", "1\n3\n3\n8\n5"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["图论", "2017", "各省省选", "O2优化", "贵州", "Tarjan"], "title": "[GZOI2017] 小z玩游戏", "background": "GZOI2017 D1T2", "description": "小 z 很无聊。\n\n小 z 要玩游戏。\n\n小 z 有 $N$ 个新游戏，第 $i$ 个游戏看上去的有趣程度为 $w_i$。\n\n小 z 很挑，他只会玩看上去的有趣程度是自己兴奋程度整数倍的游戏。\n\n由于游戏实际上有好玩的也有不好玩的，玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。\n\n已知小 z 初始兴奋程度为 $1$，请问小 z 有多少个游戏可能会玩两次？", "inputFormat": "第一行一个正整数 $T$，表示测试数据组数，最多 $10$ 组。\n\n对于每组测试数据：\n\n- 第一行一个正整数 $N$，表示游戏的个数。\n- 第二行 $N$ 个正整数，第 $i$ 个数 $w_i$，表示第 $i$ 个游戏看上去的有趣程度为 $w_i$。\n- 第三行 $N$ 个正整数，第 $i$ 个数 $e_i$，表示小 z 玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。", "outputFormat": "共 $T$ 行。\n\n每行一个正整数，表示对应测试数据，小 z 可能会玩两次的游戏数量。", "hint": "### 样例 2 解释\n\n数字代表游戏编号，箭头表示下一个。\n\n- 情况 $1$：$2\\to 5\\to 4\\to 2$；\n- 情况 $2$：$5\\to 4\\to 2\\to 5$；\n- 情况 $3$：$4\\to 2\\to 5\\to 4$。\n\n所以小 z 可能玩 $2,4,5$ 两次。\n\n小 z 无论如何都不能玩 $1$ 或 $3$ 两次。\n\n### 数据范围及约定\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s757wplh.png)", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Little z Plays Games", "background": "GZOI2017 D1T2.", "description": "Little z is very bored.\n\nLittle z wants to play games.\n\nLittle z has $N$ new games. The apparent fun level of the $i$-th game is $w_i$.\n\nLittle z is picky. He will only play a game whose apparent fun level is an integer multiple of his excitement level.\n\nSince some games are actually fun and some are not, after finishing the $i$-th game, Little z’s excitement level will become $e_i$.\n\nIt is known that Little z’s initial excitement level is $1$. Please determine how many games Little z might play twice.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of testdata groups, up to $10$ groups.\n\nFor each group of testdata:\n\n- The first line contains a positive integer $N$, indicating the number of games.\n- The second line contains $N$ positive integers. The $i$-th number $w_i$ indicates that the apparent fun level of the $i$-th game is $w_i$.\n- The third line contains $N$ positive integers. The $i$-th number $e_i$ indicates that after Little z finishes the $i$-th game, his excitement level will become $e_i$.", "outputFormat": "Output $T$ lines in total.\n\nEach line contains one positive integer, indicating for the corresponding testdata group, the number of games that Little z might play twice.", "hint": "### Explanation for Sample 2\n\nNumbers represent game indices, and arrows indicate the next one.\n\n- Case $1$: $2\\to 5\\to 4\\to 2$.\n- Case $2$: $5\\to 4\\to 2\\to 5$.\n- Case $3$: $4\\to 2\\to 5\\to 4$.\n\nSo Little z might play games $2,4,5$ twice.\n\nNo matter what, Little z cannot play game $1$ or $3$ twice.\n\n### Constraints\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s757wplh.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 小z玩游戏", "background": "GZOI2017 D1T2", "description": "小 z 很无聊。\n\n小 z 要玩游戏。\n\n小 z 有 $N$ 个新游戏，第 $i$ 个游戏看上去的有趣程度为 $w_i$。\n\n小 z 很挑，他只会玩看上去的有趣程度是自己兴奋程度整数倍的游戏。\n\n由于游戏实际上有好玩的也有不好玩的，玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。\n\n已知小 z 初始兴奋程度为 $1$，请问小 z 有多少个游戏可能会玩两次？", "inputFormat": "第一行一个正整数 $T$，表示测试数据组数，最多 $10$ 组。\n\n对于每组测试数据：\n\n- 第一行一个正整数 $N$，表示游戏的个数。\n- 第二行 $N$ 个正整数，第 $i$ 个数 $w_i$，表示第 $i$ 个游戏看上去的有趣程度为 $w_i$。\n- 第三行 $N$ 个正整数，第 $i$ 个数 $e_i$，表示小 z 玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。", "outputFormat": "共 $T$ 行。\n\n每行一个正整数，表示对应测试数据，小 z 可能会玩两次的游戏数量。", "hint": "### 样例 2 解释\n\n数字代表游戏编号，箭头表示下一个。\n\n- 情况 $1$：$2\\to 5\\to 4\\to 2$；\n- 情况 $2$：$5\\to 4\\to 2\\to 5$；\n- 情况 $3$：$4\\to 2\\to 5\\to 4$。\n\n所以小 z 可能玩 $2,4,5$ 两次。\n\n小 z 无论如何都不能玩 $1$ 或 $3$ 两次。\n\n### 数据范围及约定\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s757wplh.png)", "locale": "zh-CN"}}}
{"pid": "P5677", "type": "P", "difficulty": 5, "samples": [["3 2\n2 1 3\n1 2\n1 3", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "各省省选", "树状数组", "O2优化", "排序", "贵州"], "title": "[GZOI2017] 配对统计", "background": "GZOI2017 D1T3", "description": "给定 $n$ 个数 $a_1,\\cdots,a_n$。\n\n对于一组配对 $(x,y)$，若对于所有的 $i=1,2,\\cdots,n$，满足 $|a_x-a_y|\\le|a_x-a_i|(i\\not=x)$，则称 $(x,y)$ 为一组好的配对（$|x|$ 表示 $x$ 的绝对值）。\n\n给出若干询问，每次询问区间 $[l,r]$ 中含有多少组好的配对。\n\n即，取 $x,y$（$l\\le x,y\\le r$ 且 $x\\not=y$），问有多少组 $(x,y)$ 是好的配对。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个数 $a_1,\\cdots,a_n$。\n\n接下来 $m$ 行，每行给出两个数 $l,r$。", "outputFormat": "$Ans_i$ 表示第 $i$ 次询问的答案，输出 $\\sum_{i=1}^m\\limits Ans_i\\times i$ 即可。", "hint": "**【样例解释】**\n\n第一次询问好的配对有：$(1,2)(2,1)$；\n\n第二次询问好的配对有：$(1,2)(2,1),(1,3)(3,1)$；\n\n答案 $=2\\times 1+4\\times 2=10$。\n\n**【数据约束】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/32ms79n8.png)", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Pairing Statistics", "background": "GZOI2017 D1T3", "description": "Given $n$ numbers $a_1,\\cdots,a_n$.\n\nFor a pair $(x,y)$, if for all $i=1,2,\\cdots,n$, it satisfies $|a_x-a_y|\\le|a_x-a_i|(i\\not=x)$, then $(x,y)$ is called a good pair ($|x|$ denotes the absolute value of $x$).\n\nYou are given several queries. For each query, ask how many good pairs are contained in the interval $[l,r]$.\n\nThat is, choose $x,y$ ($l\\le x,y\\le r$ and $x\\not=y$), and ask how many pairs $(x,y)$ are good pairs.", "inputFormat": "The first line contains two positive integers $n,m$.\n\nThe second line contains $n$ numbers $a_1,\\cdots,a_n$.\n\nIn the next $m$ lines, each line gives two numbers $l,r$.", "outputFormat": "Let $Ans_i$ be the answer to the $i$-th query. Output $\\sum_{i=1}^m\\limits Ans_i\\times i$.", "hint": "**Sample Explanation**\n\nIn the first query, the good pairs are: $(1,2)(2,1)$.\n\nIn the second query, the good pairs are: $(1,2)(2,1),(1,3)(3,1)$.\n\nThe answer $=2\\times 1+4\\times 2=10$.\n\n**Constraints**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/32ms79n8.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 配对统计", "background": "GZOI2017 D1T3", "description": "给定 $n$ 个数 $a_1,\\cdots,a_n$。\n\n对于一组配对 $(x,y)$，若对于所有的 $i=1,2,\\cdots,n$，满足 $|a_x-a_y|\\le|a_x-a_i|(i\\not=x)$，则称 $(x,y)$ 为一组好的配对（$|x|$ 表示 $x$ 的绝对值）。\n\n给出若干询问，每次询问区间 $[l,r]$ 中含有多少组好的配对。\n\n即，取 $x,y$（$l\\le x,y\\le r$ 且 $x\\not=y$），问有多少组 $(x,y)$ 是好的配对。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个数 $a_1,\\cdots,a_n$。\n\n接下来 $m$ 行，每行给出两个数 $l,r$。", "outputFormat": "$Ans_i$ 表示第 $i$ 次询问的答案，输出 $\\sum_{i=1}^m\\limits Ans_i\\times i$ 即可。", "hint": "**【样例解释】**\n\n第一次询问好的配对有：$(1,2)(2,1)$；\n\n第二次询问好的配对有：$(1,2)(2,1),(1,3)(3,1)$；\n\n答案 $=2\\times 1+4\\times 2=10$。\n\n**【数据约束】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/32ms79n8.png)", "locale": "zh-CN"}}}
{"pid": "P5678", "type": "P", "difficulty": 5, "samples": [["10 5\n2 3 5 7 12\n23 45 2 4 8", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2017", "各省省选", "O2优化", "贵州", "矩阵乘法"], "title": "[GZOI2017] 河神", "background": "GZOI2017 D2T1\n\n终于忍受不了苦 X 的搬砖生活, Shlw 把手里的板砖扔进了河里.\n\n不出意料地, 河神冒了出来.\n\nShlw 说: “我掉了金砖, 快给我金砖!”\n\n“!!! 你已经知道套路了吗,”河神说道, “但是你要金砖的话, 我就不给你2017 彩虹小马大电影的资源了哦. 如果你说实话的话, 我还可以考虑一下.”\n\nShlw 发现事情并不简单, 在金钱和信仰面前, 难以抉择.\n\n突然, Shlw 不理会河神, 自顾自的地跑走了.\n\n“唉, 现在的年轻人啊... 真不知道在想什么.”Pinkie Pie 感叹, 卸下了河神伪装.", "description": "Shlw 从河神给的选择中, 获得了一道当年挂掉的代数题的灵感.\n\n但现在他希望你来帮忙解答, 因为他自己忙着去搜小马资源去了.\n\n给出数列 $\\{a_n\\}$ 和 $\\{b_n\\}$ 以及 $\\{A_n\\}$ 的递推关系, 试求出数列 $\\{A_n\\}$ 第 $N$ 项.\n\n递推关系为:\n\n$$A_n=\\begin{cases}a_n  &  0 \\le n < K \\\\ \\bigoplus_{0 \\le t < K} (A_{n-K+t} \\otimes b_t) & n \\ge K \\end{cases}$$\n\n其中，$\\otimes$ 表示与操作，$\\oplus$ 表示或操作。", "inputFormat": "第一行两个正整数 $N$ 和 $K$ 。\n\n第二行 $K$ 个空格隔开的非负整数, 表示 $\\{a_n\\}$。\n\n第三行 $K$ 个空格隔开的非负整数, 表示 $\\{b_n\\}$。", "outputFormat": "一行, 一个整数, 表示$\\{A_n\\}$。", "hint": "【样例解释】\n\n从 $A_0$ 至 $A_{10}$ 分别为: $2, 3, 5, 7, 12, 15, 15, 13, 15, 15, 15$\n\n【数据约束】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/16mwbo3z.png)\n\n【后记】\n\n后来, Pinkie Pie 偷偷来到 Shlw 家里, 她把这题拿回去考 Apple Jack, 于是 Apple Jack就有了狂吃苹果来畅游多重宇宙的本领.", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] River God", "background": "GZOI2017 D2T1.\n\nFinally unable to endure the hard brick-carrying life of Worker X, Shlw threw the brick in his hand into the river.\n\nAs expected, the River God appeared.\n\nShlw said: “I dropped a gold brick. Give me the gold brick now!”\n\n“!!! You already know the trick?” said the River God. “But if you want the gold brick, then I won’t give you the resources for the 2017 *My Little Pony* movie. If you tell the truth, I can still consider it.”\n\nShlw realized this was not simple. Faced with money and faith, it was hard to choose.\n\nSuddenly, Shlw ignored the River God and ran away on his own.\n\n“Sigh, young people these days... I really don’t know what they are thinking.” Pinkie Pie sighed and took off the River God disguise.", "description": "From the choices given by the River God, Shlw got inspiration for an algebra problem that he failed back then.\n\nBut now he hopes you can help solve it, because he is busy searching for pony resources.\n\nGiven the recurrence relations of sequences $\\{a_n\\}$, $\\{b_n\\}$, and $\\{A_n\\}$, find the $N$-th term of the sequence $\\{A_n\\}$.\n\nThe recurrence is:\n\n$$A_n=\\begin{cases}a_n  &  0 \\le n < K \\\\ \\bigoplus_{0 \\le t < K} (A_{n-K+t} \\otimes b_t) & n \\ge K \\end{cases}$$\n\nHere, $\\otimes$ denotes the AND operation, and $\\oplus$ denotes the OR operation.", "inputFormat": "The first line contains two positive integers $N$ and $K$.\n\nThe second line contains $K$ non-negative integers separated by spaces, representing $\\{a_n\\}$.\n\nThe third line contains $K$ non-negative integers separated by spaces, representing $\\{b_n\\}$.", "outputFormat": "One line with one integer, representing $\\{A_n\\}$.", "hint": "【Sample Explanation】\n\nFrom $A_0$ to $A_{10}$, they are respectively: $2, 3, 5, 7, 12, 15, 15, 13, 15, 15, 15$.\n\n【Constraints】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/16mwbo3z.png)\n\n【Postscript】\n\nLater, Pinkie Pie secretly came to Shlw’s home. She took this problem back to test Apple Jack, so Apple Jack gained the ability to travel the multiverse by eating apples like crazy.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 河神", "background": "GZOI2017 D2T1\n\n终于忍受不了苦 X 的搬砖生活, Shlw 把手里的板砖扔进了河里.\n\n不出意料地, 河神冒了出来.\n\nShlw 说: “我掉了金砖, 快给我金砖!”\n\n“!!! 你已经知道套路了吗,”河神说道, “但是你要金砖的话, 我就不给你2017 彩虹小马大电影的资源了哦. 如果你说实话的话, 我还可以考虑一下.”\n\nShlw 发现事情并不简单, 在金钱和信仰面前, 难以抉择.\n\n突然, Shlw 不理会河神, 自顾自的地跑走了.\n\n“唉, 现在的年轻人啊... 真不知道在想什么.”Pinkie Pie 感叹, 卸下了河神伪装.", "description": "Shlw 从河神给的选择中, 获得了一道当年挂掉的代数题的灵感.\n\n但现在他希望你来帮忙解答, 因为他自己忙着去搜小马资源去了.\n\n给出数列 $\\{a_n\\}$ 和 $\\{b_n\\}$ 以及 $\\{A_n\\}$ 的递推关系, 试求出数列 $\\{A_n\\}$ 第 $N$ 项.\n\n递推关系为:\n\n$$A_n=\\begin{cases}a_n  &  0 \\le n < K \\\\ \\bigoplus_{0 \\le t < K} (A_{n-K+t} \\otimes b_t) & n \\ge K \\end{cases}$$\n\n其中，$\\otimes$ 表示与操作，$\\oplus$ 表示或操作。", "inputFormat": "第一行两个正整数 $N$ 和 $K$ 。\n\n第二行 $K$ 个空格隔开的非负整数, 表示 $\\{a_n\\}$。\n\n第三行 $K$ 个空格隔开的非负整数, 表示 $\\{b_n\\}$。", "outputFormat": "一行, 一个整数, 表示$\\{A_n\\}$。", "hint": "【样例解释】\n\n从 $A_0$ 至 $A_{10}$ 分别为: $2, 3, 5, 7, 12, 15, 15, 13, 15, 15, 15$\n\n【数据约束】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/16mwbo3z.png)\n\n【后记】\n\n后来, Pinkie Pie 偷偷来到 Shlw 家里, 她把这题拿回去考 Apple Jack, 于是 Apple Jack就有了狂吃苹果来畅游多重宇宙的本领.", "locale": "zh-CN"}}}
{"pid": "P5679", "type": "P", "difficulty": 5, "samples": [["3\n4\n4 3 2 1\n2\n1 100\n5\n1 17 9 18 17", "YES\nNO\nYES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "各省省选", "O2优化", "枚举", "贵州"], "title": "[GZOI2017] 等差子序列", "background": "GZOI2017 D2T2", "description": "给出一个长度为 $N$ 的正整数序列，问是否存在一个长度不小于三的等差子序列。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 组数据，每组数据第一行一个正整数 $N$，表示序列长度，接下来第二行有 $N$ 个正整数，依次表示序列中的数。", "outputFormat": "对于每组数据，输出单独的一行 `YES` 或 `NO`。", "hint": "【数据约束】\n\n对于 $20\\%$的数据：$N\\le 100$。\n\n对于 $40\\%$的数据：$N\\le 10^3$。\n\n对于 $100\\%$的数据：$1\\le T \\le 10$，$1\\le N\\le 2\\times 10^4$，序列中的数 $\\le 2\\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Arithmetic Progression Subsequence", "background": "GZOI2017 D2T2", "description": "Given a positive integer sequence of length $N$, determine whether there exists an arithmetic progression subsequence with length at least three.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of test cases.\n\nThen follow $T$ test cases. For each test case, the first line contains a positive integer $N$, indicating the length of the sequence. The second line contains $N$ positive integers, in order, representing the numbers in the sequence.", "outputFormat": "For each test case, output a separate line containing `YES` or `NO`.", "hint": "Constraints\n\nFor $20\\%$ of the testdata: $N \\le 100$.\n\nFor $40\\%$ of the testdata: $N \\le 10^3$.\n\nFor $100\\%$ of the testdata: $1 \\le T \\le 10$, $1 \\le N \\le 2 \\times 10^4$, and each number in the sequence is $\\le 2 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 等差子序列", "background": "GZOI2017 D2T2", "description": "给出一个长度为 $N$ 的正整数序列，问是否存在一个长度不小于三的等差子序列。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 组数据，每组数据第一行一个正整数 $N$，表示序列长度，接下来第二行有 $N$ 个正整数，依次表示序列中的数。", "outputFormat": "对于每组数据，输出单独的一行 `YES` 或 `NO`。", "hint": "【数据约束】\n\n对于 $20\\%$的数据：$N\\le 100$。\n\n对于 $40\\%$的数据：$N\\le 10^3$。\n\n对于 $100\\%$的数据：$1\\le T \\le 10$，$1\\le N\\le 2\\times 10^4$，序列中的数 $\\le 2\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5680", "type": "P", "difficulty": 6, "samples": [["6 6 1 4\n1 2 3\n2 3 2\n2 4 4\n3 6 4\n1 5 5\n5 6 3\n0 3 3 4 6\n1 3 4 5 6\n0 1 3\n1 4 3 4 5 6", "10\n6"], ["12 11 4 5\n4 1 32\n4 6 42\n1 3 29\n7 1 17\n7 10 23\n9 7 21\n5 6 16\n2 6 28\n5 8 14\n8 11 11\n8 12 17\n1 11 1 2 3 5 6 7 8 9 10 11 12\n0 4 3 11 5 2\n1 4 10 9 6 11\n0 4 7 8 12 11\n1 4 11 2 9 10", "-1\n41\n77"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2017", "各省省选", "树形 DP", "贵州", "虚树"], "title": "[GZOI2017] 共享单车", "background": "GZOI2017 D2T3", "description": "某校校内有 A 公司与 B 公司两家共享单车公司相互竞争。A 公司为了尽可能提升自己在校园内的占有率，会设法阻碍 B 公司的回收行动。\n\n整个校园由 $N$ 个区域和 $M$ 条道路组成，每条道路连接两个区域。校园有一个区域 $K$ 是 B 公司的大本营，所有的单车回收行动从该区域 **出发**。B 公司为了减少成本，回收时从区域 $K$ 到任何一个区域 $X$ 都选择长度 **最短** 的路径，如果有多条到某一个区域的最短路径，则选择所有最短路径中该区域的前一区域 **编号最小** 的一条路径，称这条路径为 $K$ 到 $X$ 的 **回收路线**。所有的 **回收路线** 组成一棵树状结构，称之为 **回收路线树**。如下图中，绿色的边构成的就是一棵 **回收路线树**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0cksrjz.png)\n\nB 公司每次会回收若干个区域的单车，称这些区域为 **回收区域**。B 公司还将某些区域设为 **投放区域**，称其余区域为 **非投放区域**。在 **回收路线树** 上，标记出区域 $K$，标记出所有的 **回收区域**，以及标记出任意两个 **回收区域** 在 **回收路线树** 上的最近公共祖先。\n\n如下图，假设 $4$ 与 $6$ 号区域是 **投放区域**，$4, 5, 6$ 号区域是**回收区域**，则被标记的区域有 $1, 4, 5, 6$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mdwo6dcn.png)\n\nA 公司对 B 公司的回收行动造成了阻碍，**当且仅当** 对任意一个 $K$ 以外的被标记的 **投放区域** $X$，从区域 $K$ 到 $X$ 的 **回收路线上** 都存在两个被标记的区域，它们之间 **所有道路**（回收路线树上两点路径）被阻碍。\n\n阻碍一条道路的代价为该道路的长度。上图中 A 公司选择阻碍 $1 \\rightsquigarrow  4$，$5 \\rightsquigarrow 6$ 两条路径，代价为 $3+4+3=10$。\n\n你的任务是帮助 A 公司计算如何以最小的代价，阻碍 B 公司的回收行动。", "inputFormat": "第一行四个整数 $N, M, K, Q$ 分别表示 X 校校园内区域数量、道路数量以及 B 公司大本营的编号 $K$ 和操作数量。\n\n第二到第 $M + 1$ 行描述道路，每行三个整数 $S,T,Len$ 表示有一条从 $S$ 出发 $T$ 结束的长度为 $Len$ 双向道路。\n\n接下来第 $M + 2$ 行到第 $M + Q + 1$ 行，每行第一个整数表示操作类型，$0$ 表示 B 公司会改变**投放区域**，$1$ 表示 B 公司的一次回收行动。\n\n操作类型为 $0$时，后接一个整数 $num$，表示 B 公司改变的区域数目，紧接着 $num$ 个数字分别表示区域编号。对于一个被改变的区域，如果它是 **投放区域**，把它改为 **非投放区域**；如果它是 **非投放区域**，把它改为 **投放区域**；\n\n操作类型为 $1$ 时，后接一个整数 $num$ 表示 **回收区域** 数目，紧接着 $num$ 个整数表示 B 公司的 **回收区域** 编号。每次需要在 **回收路线树** 上重新标记。", "outputFormat": "对于每一次回收行动，输出一行表示 A 公司对 B 公司造成阻碍的最小代价。注意，如果没有被标记的 **投放区域**，输出 $-1$。", "hint": "【数据约束】\n\n对于 $30\\%$ 的数据，$N\\le 200$，$Q\\le 200$；\n\n对于 $60\\%$ 的数据，保证每次 **回收区域** 数量恒为 $N-1$；\n\n对于 $80\\%$ 的数据，$N\\le 20000$，$M=N-1$，$Q\\le 1000$，$num\\le 200$；\n\n对于 $100\\%$ 的数据，$N\\le 50000$，$M\\le 100000$，$Q\\le 1500$，$num\\le 500$。\n\n所有数据保证道路无自环，所有道路长度小于 $2000$，且区域 $K$ 任意时刻均非**投放区域**。", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Shared Bicycles", "background": "GZOI2017 D2T3", "description": "There are two shared bicycle companies, Company A and Company B, competing on a campus. To increase its market share on campus as much as possible, Company A will try to interfere with Company B’s recycling operations.\n\nThe whole campus consists of $N$ areas and $M$ roads, where each road connects two areas. There is an area $K$ that is Company B’s base. All recycling operations **start** from this area. To reduce costs, when recycling, for going from area $K$ to any area $X$, Company B always chooses a **shortest** path. If there are multiple shortest paths to some area, it chooses, among all shortest paths, the one whose previous area on the path has the **smallest index**. This path is called the **recycling route** from $K$ to $X$. All **recycling routes** form a tree structure, called the **recycling route tree**. In the figure below, the green edges form a **recycling route tree**.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0cksrjz.png)\n\nEach time, Company B recycles bicycles from several areas; these areas are called **recycling areas**. Company B also designates some areas as **deployment areas**, and the remaining areas are called **non-deployment areas**. On the **recycling route tree**, mark area $K$, mark all **recycling areas**, and also mark the lowest common ancestor on the **recycling route tree** of any two **recycling areas**.\n\nIn the figure below, suppose areas $4$ and $6$ are **deployment areas**, and areas $4, 5, 6$ are **recycling areas**. Then the marked areas are $1, 4, 5, 6$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mdwo6dcn.png)\n\nCompany A interferes with Company B’s recycling operation **if and only if** for every marked **deployment area** $X$ other than $K$, on the **recycling route** from area $K$ to $X$, there exist two marked areas such that **all roads** (the path between the two nodes on the recycling route tree) between them are blocked.\n\nThe cost to block a road is the length of that road. In the figure above, Company A chooses to block the two paths $1 \\rightsquigarrow 4$ and $5 \\rightsquigarrow 6$, and the cost is $3+4+3=10$.\n\nYour task is to help Company A compute how to block Company B’s recycling operation with the minimum total cost.", "inputFormat": "The first line contains four integers $N, M, K, Q$, representing the number of areas on campus, the number of roads, the index $K$ of Company B’s base, and the number of operations.\n\nLines $2$ to $M + 1$ describe the roads. Each line contains three integers $S, T, Len$, meaning there is an undirected road of length $Len$ between $S$ and $T$.\n\nThen, lines $M + 2$ to $M + Q + 1$ describe the operations. The first integer of each line indicates the operation type: $0$ means Company B changes the **deployment areas**, and $1$ means one recycling operation by Company B.\n\nFor an operation of type $0$, it is followed by an integer $num$, meaning the number of areas to be changed, and then $num$ integers giving the area indices. For each changed area, if it is a **deployment area**, change it to a **non-deployment area**; if it is a **non-deployment area**, change it to a **deployment area**.\n\nFor an operation of type $1$, it is followed by an integer $num$, meaning the number of **recycling areas**, and then $num$ integers giving the indices of Company B’s **recycling areas**. Each time, you need to remark nodes on the **recycling route tree**.", "outputFormat": "For each recycling operation, output one line with the minimum cost for Company A to interfere with Company B. Note that if there is no marked **deployment area**, output $-1$.", "hint": "【Constraints】\n\nFor $30\\%$ of the testdata, $N\\le 200$, $Q\\le 200$.\n\nFor $60\\%$ of the testdata, it is guaranteed that in each operation, the number of **recycling areas** is always $N-1$.\n\nFor $80\\%$ of the testdata, $N\\le 20000$, $M=N-1$, $Q\\le 1000$, $num\\le 200$.\n\nFor $100\\%$ of the testdata, $N\\le 50000$, $M\\le 100000$, $Q\\le 1500$, $num\\le 500$.\n\nAll testdata guarantee that there are no self-loops. All road lengths are less than $2000$, and area $K$ is never a **deployment area** at any time.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 共享单车", "background": "GZOI2017 D2T3", "description": "某校校内有 A 公司与 B 公司两家共享单车公司相互竞争。A 公司为了尽可能提升自己在校园内的占有率，会设法阻碍 B 公司的回收行动。\n\n整个校园由 $N$ 个区域和 $M$ 条道路组成，每条道路连接两个区域。校园有一个区域 $K$ 是 B 公司的大本营，所有的单车回收行动从该区域 **出发**。B 公司为了减少成本，回收时从区域 $K$ 到任何一个区域 $X$ 都选择长度 **最短** 的路径，如果有多条到某一个区域的最短路径，则选择所有最短路径中该区域的前一区域 **编号最小** 的一条路径，称这条路径为 $K$ 到 $X$ 的 **回收路线**。所有的 **回收路线** 组成一棵树状结构，称之为 **回收路线树**。如下图中，绿色的边构成的就是一棵 **回收路线树**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0cksrjz.png)\n\nB 公司每次会回收若干个区域的单车，称这些区域为 **回收区域**。B 公司还将某些区域设为 **投放区域**，称其余区域为 **非投放区域**。在 **回收路线树** 上，标记出区域 $K$，标记出所有的 **回收区域**，以及标记出任意两个 **回收区域** 在 **回收路线树** 上的最近公共祖先。\n\n如下图，假设 $4$ 与 $6$ 号区域是 **投放区域**，$4, 5, 6$ 号区域是**回收区域**，则被标记的区域有 $1, 4, 5, 6$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mdwo6dcn.png)\n\nA 公司对 B 公司的回收行动造成了阻碍，**当且仅当** 对任意一个 $K$ 以外的被标记的 **投放区域** $X$，从区域 $K$ 到 $X$ 的 **回收路线上** 都存在两个被标记的区域，它们之间 **所有道路**（回收路线树上两点路径）被阻碍。\n\n阻碍一条道路的代价为该道路的长度。上图中 A 公司选择阻碍 $1 \\rightsquigarrow  4$，$5 \\rightsquigarrow 6$ 两条路径，代价为 $3+4+3=10$。\n\n你的任务是帮助 A 公司计算如何以最小的代价，阻碍 B 公司的回收行动。", "inputFormat": "第一行四个整数 $N, M, K, Q$ 分别表示 X 校校园内区域数量、道路数量以及 B 公司大本营的编号 $K$ 和操作数量。\n\n第二到第 $M + 1$ 行描述道路，每行三个整数 $S,T,Len$ 表示有一条从 $S$ 出发 $T$ 结束的长度为 $Len$ 双向道路。\n\n接下来第 $M + 2$ 行到第 $M + Q + 1$ 行，每行第一个整数表示操作类型，$0$ 表示 B 公司会改变**投放区域**，$1$ 表示 B 公司的一次回收行动。\n\n操作类型为 $0$时，后接一个整数 $num$，表示 B 公司改变的区域数目，紧接着 $num$ 个数字分别表示区域编号。对于一个被改变的区域，如果它是 **投放区域**，把它改为 **非投放区域**；如果它是 **非投放区域**，把它改为 **投放区域**；\n\n操作类型为 $1$ 时，后接一个整数 $num$ 表示 **回收区域** 数目，紧接着 $num$ 个整数表示 B 公司的 **回收区域** 编号。每次需要在 **回收路线树** 上重新标记。", "outputFormat": "对于每一次回收行动，输出一行表示 A 公司对 B 公司造成阻碍的最小代价。注意，如果没有被标记的 **投放区域**，输出 $-1$。", "hint": "【数据约束】\n\n对于 $30\\%$ 的数据，$N\\le 200$，$Q\\le 200$；\n\n对于 $60\\%$ 的数据，保证每次 **回收区域** 数量恒为 $N-1$；\n\n对于 $80\\%$ 的数据，$N\\le 20000$，$M=N-1$，$Q\\le 1000$，$num\\le 200$；\n\n对于 $100\\%$ 的数据，$N\\le 50000$，$M\\le 100000$，$Q\\le 1500$，$num\\le 500$。\n\n所有数据保证道路无自环，所有道路长度小于 $2000$，且区域 $K$ 任意时刻均非**投放区域**。", "locale": "zh-CN"}}}
{"pid": "P5681", "type": "P", "difficulty": 1, "samples": [["5 4 6", "Alice"], ["7 5 10", "Bob"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "江西", "CSP-J 入门级"], "title": "[CSP-J 2019 江西] 面积", "background": "", "description": "Alice 有一个边长为 $a$ 的正方形，Bob 有一个长宽分别为 $b,c$ 的矩形，请你告诉他们俩谁的图形面积更大。", "inputFormat": "仅一行三个正整数 $a,b,c$", "outputFormat": "输出仅一行一个字符串，若正方形面积大则输出 `Alice`，否则输出 `Bob`。", "hint": "【数据范围】   \n对于 $30\\%$ 的数据，$1 \\le a,b,c \\le 100$，$b=c$；  \n对于 $80\\%$ 的数据，$1\\le a,b,c \\le 10^4$；  \n对于 $100\\%$ 的数据，$1\\le a,b,c \\le 10^9$。\n\n【样例 $1$ 解释】  \n正方形面积为  $25$，矩形面积为 $24$。  \n\n【样例 $2$ 解释】  \n正方形面积为  $49$，矩形面积为 $50$。  ", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019 Jiangxi] Area", "background": "", "description": "Alice has a square with side length $a$, and Bob has a rectangle with length and width $b, c$. Please tell them whose shape has a larger area.", "inputFormat": "Only one line with three positive integers $a, b, c$.", "outputFormat": "Output only one line with a string. If the square’s area is larger, output `Alice`; otherwise, output `Bob`.", "hint": "【Constraints】  \nFor $30\\%$ of the testdata, $1 \\le a, b, c \\le 100$, and $b = c$;  \nFor $80\\%$ of the testdata, $1 \\le a, b, c \\le 10^4$;  \nFor $100\\%$ of the testdata, $1 \\le a, b, c \\le 10^9$.\n\n【Sample $1$ Explanation】  \nThe square’s area is $25$, and the rectangle’s area is $24$.\n\n【Sample $2$ Explanation】  \nThe square’s area is $49$, and the rectangle’s area is $50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019 江西] 面积", "background": "", "description": "Alice 有一个边长为 $a$ 的正方形，Bob 有一个长宽分别为 $b,c$ 的矩形，请你告诉他们俩谁的图形面积更大。", "inputFormat": "仅一行三个正整数 $a,b,c$", "outputFormat": "输出仅一行一个字符串，若正方形面积大则输出 `Alice`，否则输出 `Bob`。", "hint": "【数据范围】   \n对于 $30\\%$ 的数据，$1 \\le a,b,c \\le 100$，$b=c$；  \n对于 $80\\%$ 的数据，$1\\le a,b,c \\le 10^4$；  \n对于 $100\\%$ 的数据，$1\\le a,b,c \\le 10^9$。\n\n【样例 $1$ 解释】  \n正方形面积为  $25$，矩形面积为 $24$。  \n\n【样例 $2$ 解释】  \n正方形面积为  $49$，矩形面积为 $50$。  ", "locale": "zh-CN"}}}
{"pid": "P5682", "type": "P", "difficulty": 3, "samples": [["4\n4 5 5 6", "4"], ["4\n1 1 1 1", "-1"], ["7\n12 3 8 5 7 20 15", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "排序", "江西", "CSP-J 入门级"], "title": "[CSP-J 2019 江西] 次大值", "background": "", "description": "Alice 有 $n$ 个正整数，数字从 $1 \\sim n$ 编号，分别为 $a_1,a_2, \\dots , a_n$。  \nBob 刚学习取模运算，于是便拿这 $n$ 个数进行练习，他写下了所有 \n\n$$a_i \\bmod a_j (1 \\le i,j \\le n \\wedge i \\neq j)$$  \n\n的值，其中 $\\bmod$ 表示取模运算。  \n\nAlice 想知道所有的结果中，严格次大值是多少。将取模后得到的所有值进行去重，即相同的结果数值只保留一个，剩余数中第二大的值就称为严格次大值。", "inputFormat": "第一行一个正整数 $n$，表示数字个数。  \n第二行 $n$ 个正整数表示 $a_i$。", "outputFormat": "仅一行一个整数表示答案。  \n若取模结果去重后剩余数字不足两个，则输出 $-1$。", "hint": "【数据范围】  \n对于 $40\\%$ 的数据，$1\\le n,a_i \\le 100$；  \n对于 $70\\%$ 的数据，$1\\le n \\le 3000$，$1\\le a_i \\le 10^5$；  \n对于 $100\\%$ 的数据，$3 \\le n \\le 2\\times 10^5$，$1\\le a_i \\le 10^9$。\n\n【样例 $1$ 解释】  \n所有取模的结果为 $\\{4,4,4,1,0,5,1,0,5,2,1,1\\}$。  \n去重后有：$\\{0,1,2,4,5 \\}$，结果为 $4$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019 Jiangxi] Second Largest Value", "background": "", "description": "Alice has $n$ positive integers, numbered from $1 \\sim n$, which are $a_1, a_2, \\dots, a_n$.  \nBob has just learned the modulo operation, so he uses these $n$ numbers to practice. He wrote down all values of\n\n$$a_i \\bmod a_j (1 \\le i,j \\le n \\wedge i \\neq j)$$\n\nwhere $\\bmod$ denotes the modulo operation.\n\nAlice wants to know the strict second largest value among all results. Deduplicate all values obtained after modulo, meaning that identical results are kept only once. The second largest value among the remaining numbers is called the strict second largest value.", "inputFormat": "The first line contains a positive integer $n$, representing the number of integers.  \nThe second line contains $n$ positive integers $a_i$.", "outputFormat": "Output one integer in a single line, representing the answer.  \nIf there are fewer than two numbers left after deduplicating the modulo results, output $-1$.", "hint": "【Constraints】  \nFor $40\\%$ of the testdata, $1 \\le n, a_i \\le 100$;  \nFor $70\\%$ of the testdata, $1 \\le n \\le 3000$, $1 \\le a_i \\le 10^5$;  \nFor $100\\%$ of the testdata, $3 \\le n \\le 2 \\times 10^5$, $1 \\le a_i \\le 10^9$.\n\n【Sample $1$ Explanation】  \nAll modulo results are $\\{4,4,4,1,0,5,1,0,5,2,1,1\\}$.  \nAfter deduplication, we have $\\{0,1,2,4,5\\}$, so the result is $4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019 江西] 次大值", "background": "", "description": "Alice 有 $n$ 个正整数，数字从 $1 \\sim n$ 编号，分别为 $a_1,a_2, \\dots , a_n$。  \nBob 刚学习取模运算，于是便拿这 $n$ 个数进行练习，他写下了所有 \n\n$$a_i \\bmod a_j (1 \\le i,j \\le n \\wedge i \\neq j)$$  \n\n的值，其中 $\\bmod$ 表示取模运算。  \n\nAlice 想知道所有的结果中，严格次大值是多少。将取模后得到的所有值进行去重，即相同的结果数值只保留一个，剩余数中第二大的值就称为严格次大值。", "inputFormat": "第一行一个正整数 $n$，表示数字个数。  \n第二行 $n$ 个正整数表示 $a_i$。", "outputFormat": "仅一行一个整数表示答案。  \n若取模结果去重后剩余数字不足两个，则输出 $-1$。", "hint": "【数据范围】  \n对于 $40\\%$ 的数据，$1\\le n,a_i \\le 100$；  \n对于 $70\\%$ 的数据，$1\\le n \\le 3000$，$1\\le a_i \\le 10^5$；  \n对于 $100\\%$ 的数据，$3 \\le n \\le 2\\times 10^5$，$1\\le a_i \\le 10^9$。\n\n【样例 $1$ 解释】  \n所有取模的结果为 $\\{4,4,4,1,0,5,1,0,5,2,1,1\\}$。  \n去重后有：$\\{0,1,2,4,5 \\}$，结果为 $4$。", "locale": "zh-CN"}}}
{"pid": "P5683", "type": "P", "difficulty": 4, "samples": [["5 6\n1 2\n2 3\n1 3\n3 4\n4 5\n3 5\n5 3 4 3", "3"], ["3 2\n1 2\n2 3\n2 2 3 1", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "广度优先搜索 BFS", "最短路", "江西", "CSP-J 入门级"], "title": "[CSP-J 2019 江西] 道路拆除", "background": "", "description": "A 国有 $n$ 座城市，从 $1 \\sim n$ 编号。$1$ 号城市是 A 国的首都。城市间由 $m$ 条双向道路连通，通过每一条道路所花费的时间均为 $1$ 单位时间。  \n\n现在 A 国打算拆除一些不实用的道路以减小维护的开支，但 A 国也需要保证主要线路不受影响。因此 A 国希望道路拆除完毕后，利用剩余未被拆除的道路，从 A 国首都出发，能到达 $s_1$ 号与 $s_2$ 号城市，且所要花费的最短时间分别不超过 $t_1$ 与 $t_2$（注意这是两个独立的条件，互相之间没有关联，即不需要先到 $s_1$ 再到 $s_2$）。\n\nA 国想请你帮他们算算，在满足上述条件的情况下，他们最多能拆除多少条道路。 若上述条件永远无法满足，则输出 $-1$。", "inputFormat": "第一行两个正整数 $n,m$，表示城市数与道路数。  \n\n接下来 $m$ 行，每行两个正整数 $x,y$，表示一条连接 $x$ 号点与 $y$ 号点的道路。\n\n最后一行四个整数，分别为 $s_1,t_1,s_2,t_2$。", "outputFormat": "仅一行一个整数，表示答案。", "hint": "【数据范围】  \n对于 $30\\%$ 的数据，$n,m \\le 15$；   \n另有 $20\\%$ 的数据，$n \\le 100$，$m = n-1$；   \n另有 $30\\%$ 的数据，$s_1 = s_2$；  \n对于 $100\\%$ 的数据，$2 \\le n,m \\le 3000$，$1\\le x,y \\le n$，$2 \\le s_1,s_2 \\le n$，$0 \\le t_1,t_2 \\le n$。  \n\n【样例 $1$ 解释】  \n拆除 $(1,2),(2,3),(3,4)$ 三条边。  \n注意：不需要令首都与除了 $s_1,s_2$ 外的点在拆除之后依然连通。\n\n【样例 $2$ 解释】  \n即使一条边都不拆除，首都到 $3$ 号点的最短时间也都达到了 $2$ 单位时间。\n\ntestdata by @DYH060310 ", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019 Jiangxi] Road Removal", "background": "", "description": "Country A has $n$ cities, numbered from $1 \\sim n$. City $1$ is the capital of Country A. The cities are connected by $m$ undirected roads, and the time to travel along each road is $1$ unit of time.\n\nNow Country A plans to remove some impractical roads to reduce maintenance costs, but it also needs to ensure that the main routes are not affected. Therefore, after the road removals, using the remaining roads, starting from the capital of Country A, it must be possible to reach city $s_1$ and city $s_2$, and the shortest times required must be no more than $t_1$ and $t_2$, respectively (note that these are two independent conditions with no relation to each other; that is, you do not need to go to $s_1$ first and then to $s_2$).\n\nCountry A asks you to compute, under the above conditions, the maximum number of roads that can be removed. If the above conditions can never be satisfied, output $-1$.", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of cities and the number of roads.\n\nThe next $m$ lines each contain two positive integers $x, y$, representing a road connecting node $x$ and node $y$.\n\nThe last line contains four integers, which are $s_1, t_1, s_2, t_2$.", "outputFormat": "Only one line containing one integer, representing the answer.", "hint": "Constraints  \nFor $30\\%$ of the testdata, $n, m \\le 15$.  \nFor another $20\\%$ of the testdata, $n \\le 100$ and $m = n - 1$.  \nFor another $30\\%$ of the testdata, $s_1 = s_2$.  \nFor $100\\%$ of the testdata, $2 \\le n, m \\le 3000$, $1 \\le x, y \\le n$, $2 \\le s_1, s_2 \\le n$, $0 \\le t_1, t_2 \\le n$.\n\nExplanation of Sample $1$  \nRemove three edges: $(1,2)$, $(2,3)$, $(3,4)$.  \nNote: It is not necessary to keep the capital connected to nodes other than $s_1, s_2$ after the removal.\n\nExplanation of Sample $2$  \nEven if not a single edge is removed, the shortest time from the capital to node $3$ is already $2$ units of time.\n\ntestdata by @DYH060310\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019 江西] 道路拆除", "background": "", "description": "A 国有 $n$ 座城市，从 $1 \\sim n$ 编号。$1$ 号城市是 A 国的首都。城市间由 $m$ 条双向道路连通，通过每一条道路所花费的时间均为 $1$ 单位时间。  \n\n现在 A 国打算拆除一些不实用的道路以减小维护的开支，但 A 国也需要保证主要线路不受影响。因此 A 国希望道路拆除完毕后，利用剩余未被拆除的道路，从 A 国首都出发，能到达 $s_1$ 号与 $s_2$ 号城市，且所要花费的最短时间分别不超过 $t_1$ 与 $t_2$（注意这是两个独立的条件，互相之间没有关联，即不需要先到 $s_1$ 再到 $s_2$）。\n\nA 国想请你帮他们算算，在满足上述条件的情况下，他们最多能拆除多少条道路。 若上述条件永远无法满足，则输出 $-1$。", "inputFormat": "第一行两个正整数 $n,m$，表示城市数与道路数。  \n\n接下来 $m$ 行，每行两个正整数 $x,y$，表示一条连接 $x$ 号点与 $y$ 号点的道路。\n\n最后一行四个整数，分别为 $s_1,t_1,s_2,t_2$。", "outputFormat": "仅一行一个整数，表示答案。", "hint": "【数据范围】  \n对于 $30\\%$ 的数据，$n,m \\le 15$；   \n另有 $20\\%$ 的数据，$n \\le 100$，$m = n-1$；   \n另有 $30\\%$ 的数据，$s_1 = s_2$；  \n对于 $100\\%$ 的数据，$2 \\le n,m \\le 3000$，$1\\le x,y \\le n$，$2 \\le s_1,s_2 \\le n$，$0 \\le t_1,t_2 \\le n$。  \n\n【样例 $1$ 解释】  \n拆除 $(1,2),(2,3),(3,4)$ 三条边。  \n注意：不需要令首都与除了 $s_1,s_2$ 外的点在拆除之后依然连通。\n\n【样例 $2$ 解释】  \n即使一条边都不拆除，首都到 $3$ 号点的最短时间也都达到了 $2$ 单位时间。\n\ntestdata by @DYH060310 ", "locale": "zh-CN"}}}
{"pid": "P5684", "type": "P", "difficulty": 4, "samples": [["3\naba", "4"], ["8\naabbbbcc", "39168"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "江西", "组合数学", "CSP-J 入门级"], "title": "[CSP-J 2019 江西] 非回文串", "background": "", "description": "Alice 有 $n$ 个字符，它们都是英文小写字母，从 $1 \\sim n$ 编号，分别为 $c_1,c_2, \\dots , c_n$。  \nBob 准备将这些字符重新排列，组成一个字符串 $S$。Bob 知道 Alice 有强迫症，所以他打算将 $S$ 组成一个非回文串来折磨 Alice。  \n\n现在 Bob 想知道他共有多少种不同的排列字符的方案，能使得 $S$ 是个非回文串。一种排列字符的方案指的是一个 $1 \\sim n$ 的排列 $p_i$，它所组成的 $S = c_{p_1}c_{p_2} \\dots c_{p_n}$。\n\n一个字符串是非回文串，当且仅当它的逆序串与原串不同。例如 `abcda` 的逆序串为 `adcba`，与原串不同，故 `abcda` 是非回文串。而 `abcba` 的逆序串与原串相同，是回文串。\n\n由于最后的结果可能很大，你只需要告诉 Bob 总方案数对 $10^9+7$ 取模后的值。", "inputFormat": "第一行一个正整数 $n$ 表示字符个数。   \n第二行 $n$ 个英文小写字母 $c_i$。", "outputFormat": "仅一行一个整数表示答案。答案对 $10^9+7$ 取模。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$n \\le 8$；  \n对于 $50\\%$ 的数据，$n \\le 20$；  \n另有 $30\\%$ 的数据，字符只包含 `a` 和 `b`；  \n对于 $100\\%$ 的数据，$3 \\le n \\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019 Jiangxi] Non-palindromic String", "background": "", "description": "Alice has $n$ characters, all of which are lowercase English letters, numbered from $1 \\sim n$, namely $c_1,c_2, \\dots , c_n$.  \nBob plans to rearrange these characters to form a string $S$. Bob knows that Alice has OCD, so he plans to make $S$ a non-palindromic string to annoy Alice.\n\nNow Bob wants to know how many different ways of rearranging the characters there are such that $S$ is a non-palindromic string. A rearrangement plan means a permutation $p_i$ of $1 \\sim n$, and it forms $S = c_{p_1}c_{p_2} \\dots c_{p_n}$.\n\nA string is non-palindromic if and only if its reversed string is different from the original string. For example, the reversed string of `abcda` is `adcba`, which is different from the original string, so `abcda` is a non-palindromic string. However, the reversed string of `abcba` is the same as the original string, so it is a palindromic string.\n\nSince the final result may be very large, you only need to tell Bob the value of the total number of plans modulo $10^9+7$.", "inputFormat": "The first line contains a positive integer $n$, which represents the number of characters.  \nThe second line contains $n$ lowercase English letters $c_i$.", "outputFormat": "Only one line containing an integer representing the answer. The answer is taken modulo $10^9+7$.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $n \\le 8$;  \nFor $50\\%$ of the testdata, $n \\le 20$;  \nFor the other $30\\%$ of the testdata, the characters only include `a` and `b`;  \nFor $100\\%$ of the testdata, $3 \\le n \\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019 江西] 非回文串", "background": "", "description": "Alice 有 $n$ 个字符，它们都是英文小写字母，从 $1 \\sim n$ 编号，分别为 $c_1,c_2, \\dots , c_n$。  \nBob 准备将这些字符重新排列，组成一个字符串 $S$。Bob 知道 Alice 有强迫症，所以他打算将 $S$ 组成一个非回文串来折磨 Alice。  \n\n现在 Bob 想知道他共有多少种不同的排列字符的方案，能使得 $S$ 是个非回文串。一种排列字符的方案指的是一个 $1 \\sim n$ 的排列 $p_i$，它所组成的 $S = c_{p_1}c_{p_2} \\dots c_{p_n}$。\n\n一个字符串是非回文串，当且仅当它的逆序串与原串不同。例如 `abcda` 的逆序串为 `adcba`，与原串不同，故 `abcda` 是非回文串。而 `abcba` 的逆序串与原串相同，是回文串。\n\n由于最后的结果可能很大，你只需要告诉 Bob 总方案数对 $10^9+7$ 取模后的值。", "inputFormat": "第一行一个正整数 $n$ 表示字符个数。   \n第二行 $n$ 个英文小写字母 $c_i$。", "outputFormat": "仅一行一个整数表示答案。答案对 $10^9+7$ 取模。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$n \\le 8$；  \n对于 $50\\%$ 的数据，$n \\le 20$；  \n另有 $30\\%$ 的数据，字符只包含 `a` 和 `b`；  \n对于 $100\\%$ 的数据，$3 \\le n \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P5685", "type": "P", "difficulty": 6, "samples": [["PUPPY\nPUPPUP\n", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2013", "各省省选", "江苏", "后缀自动机 SAM", "回文自动机 PAM"], "title": "[JSOI2013] 快乐的 JYY", "background": "JYY 在 JSOI 有很多很多的好朋友，比如 PUPPY，KFC 还有 PUPPUP 。因为\n有了这么多的好朋友，所以 JYY 每天都很快乐。某天，JYY 发现好朋友之间关\n系的好坏和名字有很大的关系，比如 PUPPY 和 PUPPUP 的关系就特别好，但是和 KFC 的关系就很一般。JYY 苦思冥想终于发现了其中的规律，现在 JYY 想知道两个朋友之间关系的好坏，你能帮助 JYY 么？", "description": "给定两个字符串 $A$ 和 $B$，表示 JYY 的两个朋友的名字。我们用 $A(i,\\,j)$ 表示 $A$ \n字符串中从第 $i$ 个字母到第 $j$ 个字母所组成的子串。同样的，我们也可以定义 $B(x,\\,y)$ 。\n\nJYY 发现两个朋友关系的紧密程度，等于同时满足如下条件的四元组 $(i,\\,j,\\,x,\\,y)$\n的个数：\n1. $1\\leq i\\leq j\\leq |A|$\n2. $1\\leq x\\leq y\\leq |B|$\n3. $A(i,\\,j)=B(x,\\,y)$\n4. $A(i,\\,j)$ 是回文串\n\n$|A|$ 表示字符串 $A$ 的长度。\n\nJYY 希望你帮助他计算出这两个朋友之间关系的紧密程度。", "inputFormat": "数据包行两行由大写字母组成的字符串 $A$ 和 $B$ 。\n", "outputFormat": "包含一行一个整数，表示紧密程度，也就是满足要求的 $4$ 元组个数", "hint": "$1\\leq |A|,\\,|B|\\leq 50000$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Happy JYY", "background": "JYY has many, many good friends in JSOI, such as PUPPY, KFC, and PUPPUP. With so many friends, JYY is happy every day. One day, JYY found that how well friends get along is closely related to their names. For example, PUPPY and PUPPUP get along especially well, but their relationship with KFC is just average. After thinking hard for a long time, JYY finally discovered the pattern. Now JYY wants to know how close the relationship is between two friends. Can you help JYY?", "description": "Given two strings $A$ and $B$, representing the names of two of JYY's friends. Let $A(i,\\,j)$ denote the substring of $A$ formed by the $i$-th letter through the $j$-th letter. Similarly, we define $B(x,\\,y)$.\n\nJYY found that the closeness of the relationship between two friends is equal to the number of quadruples $(i,\\,j,\\,x,\\,y)$ that satisfy all of the following conditions:\n1. $1\\leq i\\leq j\\leq |A|$.\n2. $1\\leq x\\leq y\\leq |B|$.\n3. $A(i,\\,j)=B(x,\\,y)$.\n4. $A(i,\\,j)$ is a palindrome string.\n\nHere, $|A|$ denotes the length of string $A$.\n\nJYY hopes you can help him compute the closeness of the relationship between these two friends.", "inputFormat": "The input consists of two lines, each containing a string $A$ and $B$ made up of uppercase letters.", "outputFormat": "Output one line containing one integer, representing the closeness, i.e., the number of valid quadruples.", "hint": "Constraints: $1\\leq |A|,\\,|B|\\leq 50000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 快乐的 JYY", "background": "JYY 在 JSOI 有很多很多的好朋友，比如 PUPPY，KFC 还有 PUPPUP 。因为\n有了这么多的好朋友，所以 JYY 每天都很快乐。某天，JYY 发现好朋友之间关\n系的好坏和名字有很大的关系，比如 PUPPY 和 PUPPUP 的关系就特别好，但是和 KFC 的关系就很一般。JYY 苦思冥想终于发现了其中的规律，现在 JYY 想知道两个朋友之间关系的好坏，你能帮助 JYY 么？", "description": "给定两个字符串 $A$ 和 $B$，表示 JYY 的两个朋友的名字。我们用 $A(i,\\,j)$ 表示 $A$ \n字符串中从第 $i$ 个字母到第 $j$ 个字母所组成的子串。同样的，我们也可以定义 $B(x,\\,y)$ 。\n\nJYY 发现两个朋友关系的紧密程度，等于同时满足如下条件的四元组 $(i,\\,j,\\,x,\\,y)$\n的个数：\n1. $1\\leq i\\leq j\\leq |A|$\n2. $1\\leq x\\leq y\\leq |B|$\n3. $A(i,\\,j)=B(x,\\,y)$\n4. $A(i,\\,j)$ 是回文串\n\n$|A|$ 表示字符串 $A$ 的长度。\n\nJYY 希望你帮助他计算出这两个朋友之间关系的紧密程度。", "inputFormat": "数据包行两行由大写字母组成的字符串 $A$ 和 $B$ 。\n", "outputFormat": "包含一行一个整数，表示紧密程度，也就是满足要求的 $4$ 元组个数", "hint": "$1\\leq |A|,\\,|B|\\leq 50000$", "locale": "zh-CN"}}}
{"pid": "P5686", "type": "P", "difficulty": 3, "samples": [["3\n2 3 4\n3 4 5", "244"], ["5\n11 22 33 44 55\n12 34 56 78 90", "201542"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递推", "2019", "数论", "江西", "前缀和", "CSP-S 提高级"], "title": "[CSP-S 2019 江西] 和积和", "background": "JXCSP-S T2", "description": "给定两个下标从 $1$ 到 $n$ 编号的序列 $a_i,b_i$，定义函数 $S(l,r)(1\\le l\\le r\\le n)$ 为：\n\n$$\\sum_{i=l}^r a_i\\times \\sum_{i=l}^r b_i$$\n\n请你求出下列式子的值：\n\n$$\\sum_{l=1}^n \\sum_{r=l}^n S(l,r)$$\n\n由于答案可能很大，你只需要给出答案模 $10^9+7$ 后的结果。", "inputFormat": "第一行一个正整数 $n$ 表示序列长度。  \n第二行 $n$ 个正整数表示 $a_i$。  \n第三行 $n$ 个正整数表示 $b_i$。", "outputFormat": "仅一行一个整数表示答案模 $10^9+7$  后的结果。", "hint": "【数据范围】   \n对于 $20\\%$  的数据：$n\\le 10$ , $a_i,b_i\\le 10$；   \n对于 $40\\%$  的数据：$n\\le 200$ , $a_i,b_i\\le 100$；    \n对于 $70\\%$  的数据：$n\\le 3000$ , $a_i,b_i\\le 10^5$；    \n对于 $100\\%$  的数据：$3\\le n\\le 5\\times 10^5$ , $1\\le a_i,b_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] Sum of Product of Sums.", "background": "JXCSP-S T2", "description": "Given two sequences $a_i, b_i$ indexed from $1$ to $n$, define the function $S(l, r)$ $(1 \\le l \\le r \\le n)$ as:\n\n$$\\sum_{i=l}^r a_i \\times \\sum_{i=l}^r b_i$$\n\nPlease compute the value of the following expression:\n\n$$\\sum_{l=1}^n \\sum_{r=l}^n S(l,r)$$\n\nSince the answer may be very large, you only need to output the result modulo $10^9 + 7$.", "inputFormat": "The first line contains a positive integer $n$ indicating the length of the sequences.  \nThe second line contains $n$ positive integers representing $a_i$.  \nThe third line contains $n$ positive integers representing $b_i$.", "outputFormat": "Output a single integer, the result modulo $10^9 + 7$.", "hint": "Constraints  \nFor $20\\%$ of the testdata: $n \\le 10$, $a_i, b_i \\le 10$.  \nFor $40\\%$ of the testdata: $n \\le 200$, $a_i, b_i \\le 100$.  \nFor $70\\%$ of the testdata: $n \\le 3000$, $a_i, b_i \\le 10^5$.  \nFor $100\\%$ of the testdata: $3 \\le n \\le 5 \\times 10^5$, $1 \\le a_i, b_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 和积和", "background": "JXCSP-S T2", "description": "给定两个下标从 $1$ 到 $n$ 编号的序列 $a_i,b_i$，定义函数 $S(l,r)(1\\le l\\le r\\le n)$ 为：\n\n$$\\sum_{i=l}^r a_i\\times \\sum_{i=l}^r b_i$$\n\n请你求出下列式子的值：\n\n$$\\sum_{l=1}^n \\sum_{r=l}^n S(l,r)$$\n\n由于答案可能很大，你只需要给出答案模 $10^9+7$ 后的结果。", "inputFormat": "第一行一个正整数 $n$ 表示序列长度。  \n第二行 $n$ 个正整数表示 $a_i$。  \n第三行 $n$ 个正整数表示 $b_i$。", "outputFormat": "仅一行一个整数表示答案模 $10^9+7$  后的结果。", "hint": "【数据范围】   \n对于 $20\\%$  的数据：$n\\le 10$ , $a_i,b_i\\le 10$；   \n对于 $40\\%$  的数据：$n\\le 200$ , $a_i,b_i\\le 100$；    \n对于 $70\\%$  的数据：$n\\le 3000$ , $a_i,b_i\\le 10^5$；    \n对于 $100\\%$  的数据：$3\\le n\\le 5\\times 10^5$ , $1\\le a_i,b_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5687", "type": "P", "difficulty": 4, "samples": [["3 3\n2 4 3\n1 3 2", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2019", "江西", "生成树", "CSP-S 提高级"], "title": "[CSP-S 2019 江西] 网格图", "background": "JXCSP-S T3", "description": "给定一个 $n\\times m$ 的网格图，行从 $1\\sim n$ 编号，列从 $1\\sim m$ 编号，每个点可用它所在的行编号 $r$ 与所在的列编号 $c$ 表示为 $(r, c)$。\n\n点 $(i,j)$ 与 $(i,j+1)$ 间连有一条权值为 $a_i$ 的边，其中 $1\\le i\\le n, 1\\le j<m$。\n\n点 $(i, j)$ 与 $(i+1,j)$ 间连有一条权值为 $b_j$ 的边，其中 $1\\le i< n, 1\\le j \\le m$。\n\n请你求出这个网格图的最小生成树。", "inputFormat": "第一行两个正整数 $n, m$ 表示行数与列数。\n\n第二行 $n$ 个正整数表示 $a_i$。\n\n第三行 $m$ 个正整数表示 $b_j$。", "outputFormat": "仅一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n最小生成树中的边包括：第一行上的所有边，第一列、第二列、第三列上的所有边。\n\n#### 【数据规模与约定】\n\n对于 $20\\%$ 的数据，$n, m\\le 3$，$a_i, b_j \\le 10$；\n\n对于 $40\\%$ 的数据，$n, m\\le 20$，$a_i, b_j\\le 100$；\n\n对于 $64\\%$ 的数据，$n, m\\le 300$，$a_i, b_j\\le 1000$；\n\n对于 $100\\%$ 的数据：$3\\le n, m \\le 3\\times 10^5$，$1 \\le a_i, b_j\\le 10^5$。 ", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] Grid Graph", "background": "JXCSP-S T3", "description": "Given an $n\\times m$ grid graph, rows are numbered from $1\\sim n$ and columns are numbered from $1\\sim m$. Each point can be represented by its row number $r$ and column number $c$ as $(r, c)$.\n\nThere is an edge with weight $a_i$ between points $(i,j)$ and $(i,j+1)$, where $1\\le i\\le n, 1\\le j<m$.\n\nThere is an edge with weight $b_j$ between points $(i, j)$ and $(i+1,j)$, where $1\\le i< n, 1\\le j \\le m$.\n\nPlease find the minimum spanning tree of this grid graph.", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of rows and columns.\n\nThe second line contains $n$ positive integers, representing $a_i$.\n\nThe third line contains $m$ positive integers, representing $b_j$.", "outputFormat": "Output a single integer in one line, representing the answer.", "hint": "#### Explanation of Sample Input/Output 1\nThe edges in the minimum spanning tree include: all edges in the first row, and all edges in the first, second, and third columns.\n\n#### Constraints\n\nFor $20\\%$ of the testdata, $n, m\\le 3$, $a_i, b_j \\le 10$.\n\nFor $40\\%$ of the testdata, $n, m\\le 20$, $a_i, b_j\\le 100$.\n\nFor $64\\%$ of the testdata, $n, m\\le 300$, $a_i, b_j\\le 1000$.\n\nFor $100\\%$ of the testdata, $3\\le n, m \\le 3\\times 10^5$, $1 \\le a_i, b_j\\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 网格图", "background": "JXCSP-S T3", "description": "给定一个 $n\\times m$ 的网格图，行从 $1\\sim n$ 编号，列从 $1\\sim m$ 编号，每个点可用它所在的行编号 $r$ 与所在的列编号 $c$ 表示为 $(r, c)$。\n\n点 $(i,j)$ 与 $(i,j+1)$ 间连有一条权值为 $a_i$ 的边，其中 $1\\le i\\le n, 1\\le j<m$。\n\n点 $(i, j)$ 与 $(i+1,j)$ 间连有一条权值为 $b_j$ 的边，其中 $1\\le i< n, 1\\le j \\le m$。\n\n请你求出这个网格图的最小生成树。", "inputFormat": "第一行两个正整数 $n, m$ 表示行数与列数。\n\n第二行 $n$ 个正整数表示 $a_i$。\n\n第三行 $m$ 个正整数表示 $b_j$。", "outputFormat": "仅一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n最小生成树中的边包括：第一行上的所有边，第一列、第二列、第三列上的所有边。\n\n#### 【数据规模与约定】\n\n对于 $20\\%$ 的数据，$n, m\\le 3$，$a_i, b_j \\le 10$；\n\n对于 $40\\%$ 的数据，$n, m\\le 20$，$a_i, b_j\\le 100$；\n\n对于 $64\\%$ 的数据，$n, m\\le 300$，$a_i, b_j\\le 1000$；\n\n对于 $100\\%$ 的数据：$3\\le n, m \\le 3\\times 10^5$，$1 \\le a_i, b_j\\le 10^5$。 ", "locale": "zh-CN"}}}
{"pid": "P5688", "type": "P", "difficulty": 6, "samples": [["3 2 5\n2\n2 1\n0 1\n1 3\n0 4", "3"], ["3 2 5\n2 \n1 1\n0 0 \n0 2 \n0 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2019", "线段树", "江西", "CSP-S 提高级"], "title": "[CSP-S 2019 江西] 散步", "background": "JXCSP-S T4", "description": "公园内有 $n$ 个人正在散步，随着天色渐晚，所有人准备回家离开公园。公园的结构是一个首尾相连的环形图，它共有 $m$ 个出口，为了方便叙述，我们将人从 $1\\sim n$ 编号，将出口按逆时针顺序从 $1\\sim m$ 编号。\n\n公园总长 $L$ 米，我们令 $1$ 号出口所在的位置为 $0$ 米，则 编号为 $i\\ (2\\le i\\le m)$ 的出口在 $1$ 号出口逆时针方向 $a_i$ 米的位置上，其中 $a_i$ 严格递增 ，即 $i\\ (1\\le i < m)$ 号出口与 $i+1$ 号出口相邻，由于公园是环形图，故 $m$ 号出口与 $1$ 号出口也相邻。每个出口还有一个通行限制 $l_i$，表示最多有 $l_i$ 个人能从 $i$ 号出口离开。\n\n所有人回家时将按自己的朝向，可能是顺时针方向，也可能是逆时针方向不断前行，当他们走到一个还能离开的出口时，将从该出口离开公园。特别地，当两个人同时走到一个只能允许 $1$ 个人离开的出口时，编号小的那个人能从该出口离开，编号较大的人将继续前进。\n\n现在给定 $n$ 个人所在的起始位置与他们的前进方向，请你求出每个人从哪个出口离开，若编号为 $i$ 的 人从 $k_i$ 号出口离开，你只需要给出 $i\\times k_i$ 的异或和，即：\n\n$$ (1\\times k_1) \\operatorname{xor} (2\\times k_2) \\operatorname{xor}\\cdots \\operatorname{xor} (n\\times k_n) $$\n\n其中 $\\operatorname{xor}$ 是位异或运算。特别地若一个人最后无法离开，则他的 $k_i = 0$。", "inputFormat": "第一行三个正整数 $n, m, L$，意义见题目描述。\n\n第二行 $m - 1$ 个正整数 $a_i\\ (2\\le i \\le m)$ 表示出口位置。保证 $a_i$ 严格递增。\n\n第三行 $m$ 个正整数 $l_i$ 表示出口的人数限制。\n\n接下来 $n$ 行每行两个整数 $s_i,b_i\\ (1 \\le i \\le n)$。若 $s_i$ 为 $0$ 表示编号为 $i$ 的人前进方向是逆时针方向，为 $1$ 表示是顺时针方向。 $b_i$ 表示编号为 $i$ 的人的起始位置为：离 $1$ 号出口逆时针方向 $b_i$ 米的位置。", "outputFormat": "仅一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n编号为 $1 ,2, 3$ 的人分别从 $2, 1, 1$ 号出口离开。\n\n#### 【输入输出样例 2 说明】\n编号为 $1,2$ 的人分别从 $1 ,2$ 号出口离开，编号为 $3$ 的人无法离开公园。\n\n#### 【数据规模与约定】\n对于 $12\\%$ 的数据：$n, m, L \\le 10$；   \n\n对于 $32\\%$ 的数据：$n, m \\le 100$，$L \\le 1000$；\n\n对于 $52\\%$ 的数据：$n, m \\le 1000$；  \n\n另有 $20\\%$ 的数据：$n, m \\le 10000$，所有 $s_i = 0$；   \n\n对于 $100\\%$ 的数据：$1 \\le n,m \\le 2 \\times 10^5 $，$2 \\le L \\le 10^9$，$1\\le a_i <L$，$1\\le l_i \\le n$，$s_i\\in\\{0,1\\}$，$0\\le b_i<L$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] Walking", "background": "JXCSP-S T4", "description": "There are $n$ people taking a walk in a park. As it gets late, everyone is ready to go home and leave the park. The park is a circular graph (a ring) with $m$ exits. For convenience, we number the people from $1$ to $n$, and number the exits from $1$ to $m$ in counterclockwise order.\n\nThe total length of the park is $L$ meters. We define the position of exit $1$ as $0$ meters. Then for exit $i\\ (2\\le i\\le m)$, it is located $a_i$ meters counterclockwise from exit $1$. The sequence $a_i$ is strictly increasing, so exits $i\\ (1\\le i < m)$ and $i+1$ are adjacent. Since the park is a ring, exit $m$ and exit $1$ are also adjacent. Each exit also has a capacity limit $l_i$, meaning that at most $l_i$ people can leave through exit $i$.\n\nWhen going home, each person will keep moving in their own direction, either clockwise or counterclockwise. When they reach an exit that still allows someone to leave, they will leave the park through that exit. In particular, if two people arrive at an exit that can allow only $1$ person to leave at the same time, the person with the smaller index leaves through that exit, and the person with the larger index continues moving.\n\nNow you are given the initial position and moving direction of each of the $n$ people. Please determine which exit each person leaves from. If person $i$ leaves from exit $k_i$, you only need to output the XOR sum of $i\\times k_i$, that is:\n\n$$ (1\\times k_1) \\operatorname{xor} (2\\times k_2) \\operatorname{xor}\\cdots \\operatorname{xor} (n\\times k_n) $$\n\nwhere $\\operatorname{xor}$ is the bitwise XOR operation. In particular, if a person cannot leave in the end, then $k_i = 0$.", "inputFormat": "The first line contains three positive integers $n, m, L$, as described above.\n\nThe second line contains $m - 1$ positive integers $a_i\\ (2\\le i \\le m)$, representing the exit positions. It is guaranteed that $a_i$ is strictly increasing.\n\nThe third line contains $m$ positive integers $l_i$, representing the capacity limit of each exit.\n\nThe next $n$ lines each contain two integers $s_i, b_i\\ (1 \\le i \\le n)$. If $s_i$ is $0$, it means person $i$ moves counterclockwise; if $s_i$ is $1$, it means person $i$ moves clockwise. $b_i$ means the starting position of person $i$ is the point $b_i$ meters counterclockwise from exit $1$.", "outputFormat": "Output one integer in a single line, representing the answer.", "hint": "#### Explanation of Sample 1\nPeople $1, 2, 3$ leave through exits $2, 1, 1$, respectively.\n\n#### Explanation of Sample 2\nPeople $1, 2$ leave through exits $1, 2$, respectively, and person $3$ cannot leave the park.\n\n#### Constraints\nFor $12\\%$ of the testdata: $n, m, L \\le 10$.\n\nFor $32\\%$ of the testdata: $n, m \\le 100$, $L \\le 1000$.\n\nFor $52\\%$ of the testdata: $n, m \\le 1000$.\n\nFor another $20\\%$ of the testdata: $n, m \\le 10000$, and all $s_i = 0$.\n\nFor $100\\%$ of the testdata: $1 \\le n,m \\le 2 \\times 10^5$, $2 \\le L \\le 10^9$, $1\\le a_i < L$, $1\\le l_i \\le n$, $s_i\\in\\{0,1\\}$, $0\\le b_i < L$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 散步", "background": "JXCSP-S T4", "description": "公园内有 $n$ 个人正在散步，随着天色渐晚，所有人准备回家离开公园。公园的结构是一个首尾相连的环形图，它共有 $m$ 个出口，为了方便叙述，我们将人从 $1\\sim n$ 编号，将出口按逆时针顺序从 $1\\sim m$ 编号。\n\n公园总长 $L$ 米，我们令 $1$ 号出口所在的位置为 $0$ 米，则 编号为 $i\\ (2\\le i\\le m)$ 的出口在 $1$ 号出口逆时针方向 $a_i$ 米的位置上，其中 $a_i$ 严格递增 ，即 $i\\ (1\\le i < m)$ 号出口与 $i+1$ 号出口相邻，由于公园是环形图，故 $m$ 号出口与 $1$ 号出口也相邻。每个出口还有一个通行限制 $l_i$，表示最多有 $l_i$ 个人能从 $i$ 号出口离开。\n\n所有人回家时将按自己的朝向，可能是顺时针方向，也可能是逆时针方向不断前行，当他们走到一个还能离开的出口时，将从该出口离开公园。特别地，当两个人同时走到一个只能允许 $1$ 个人离开的出口时，编号小的那个人能从该出口离开，编号较大的人将继续前进。\n\n现在给定 $n$ 个人所在的起始位置与他们的前进方向，请你求出每个人从哪个出口离开，若编号为 $i$ 的 人从 $k_i$ 号出口离开，你只需要给出 $i\\times k_i$ 的异或和，即：\n\n$$ (1\\times k_1) \\operatorname{xor} (2\\times k_2) \\operatorname{xor}\\cdots \\operatorname{xor} (n\\times k_n) $$\n\n其中 $\\operatorname{xor}$ 是位异或运算。特别地若一个人最后无法离开，则他的 $k_i = 0$。", "inputFormat": "第一行三个正整数 $n, m, L$，意义见题目描述。\n\n第二行 $m - 1$ 个正整数 $a_i\\ (2\\le i \\le m)$ 表示出口位置。保证 $a_i$ 严格递增。\n\n第三行 $m$ 个正整数 $l_i$ 表示出口的人数限制。\n\n接下来 $n$ 行每行两个整数 $s_i,b_i\\ (1 \\le i \\le n)$。若 $s_i$ 为 $0$ 表示编号为 $i$ 的人前进方向是逆时针方向，为 $1$ 表示是顺时针方向。 $b_i$ 表示编号为 $i$ 的人的起始位置为：离 $1$ 号出口逆时针方向 $b_i$ 米的位置。", "outputFormat": "仅一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n编号为 $1 ,2, 3$ 的人分别从 $2, 1, 1$ 号出口离开。\n\n#### 【输入输出样例 2 说明】\n编号为 $1,2$ 的人分别从 $1 ,2$ 号出口离开，编号为 $3$ 的人无法离开公园。\n\n#### 【数据规模与约定】\n对于 $12\\%$ 的数据：$n, m, L \\le 10$；   \n\n对于 $32\\%$ 的数据：$n, m \\le 100$，$L \\le 1000$；\n\n对于 $52\\%$ 的数据：$n, m \\le 1000$；  \n\n另有 $20\\%$ 的数据：$n, m \\le 10000$，所有 $s_i = 0$；   \n\n对于 $100\\%$ 的数据：$1 \\le n,m \\le 2 \\times 10^5 $，$2 \\le L \\le 10^9$，$1\\le a_i <L$，$1\\le l_i \\le n$，$s_i\\in\\{0,1\\}$，$0\\le b_i<L$。", "locale": "zh-CN"}}}
{"pid": "P5689", "type": "P", "difficulty": 4, "samples": [["5 6\n1 1 0\n1 2 0\n2 1\n1 3 1\n1 2 0\n2 4", "2\n8\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "并查集", "江西", "组合数学", "逆元", "CSP-S 提高级"], "title": "[CSP-S 2019 江西] 多叉堆", "background": "JXCSP-S T5", "description": "多叉堆是一种树形数据结构，本题中我们只考虑小根堆，它满足除了根以外的结点，每个点的权值都不小于父亲的权值。除了叶结点，每个点有至少一个子结点。\n\n初始时有 $n$ 个结点，编号分别为 $0 \\sim n - 1$，每个结点都是一棵以自身为根的单点树。接下来按顺序有 $q$ 次操作，每次操作有以下两种：\n\n* `1 x y`：选择不在同一棵树里的结点 $x$ 和 $y$，将 $x$ 所在树的根直接接在 $y$ 所在树的根之下，此时 $x$ 和 $y$ 所在树将合并为同一棵树。\n\n* `2 x`：选择结点 $x$，设 $x$ 当前所在树的结点数为 $size$。你需要计算将 $0 \\sim size - 1$ 这 $size$ 个数分别填入 $x$ 所在树的结点中，能够产生多少种不同的多叉堆。两种堆不同当且仅当存在某个结点填入的值不同。由于答案可能很大，你只需要求出答案模 $10^9+7$ 后的结果。", "inputFormat": "第一行两个整数 $n,q$，具体含义见题目描述。\n\n接下来 $q$ 行每行可能是下面两种格式之一：\n\n* `1 x' y'`：你需要通过计算 $x=(x'+ans) \\bmod n , y=(y'+ans) \\bmod n$ 来得到真正的 $x$ 和 $y$，输入保证 $x$ 和 $y$ 所在树不同。\n\n* `2 x'`：你需要通过计算 $x=(x'+ans) \\bmod n$ 来得到真正的 $x$。\n\n其中 $ans$ 表示上一次 $2$ 操作的输出结果，初始时 $ans=0$。", "outputFormat": "对于每次 $2$ 操作输出一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n\n第 $1$ 次操作时，将 $1$ 所在树的根 $1$ 接在 $0$ 所在树的根 $0$ 下。 \n\n第 $2$ 次操作时，将 $2$ 所在树的根 $2$ 接在 $0$ 所在树的根 $0$ 下。   \n\n第 $3$ 次操作时，$1$ 所在树如图 $1$，在 $0,1,2$ 中分别填入 $[0,1,2]$ 和 $[0,2,1]$ 可以产生 $2$ 种不同的堆。    \n\n第 $4$ 次操作时 $x=(3+2) \\bmod 5=0$，$y=(1+2) \\bmod 5=3$，将 $0$ 所在树的根 $0$ 接在 $3$ 所在树的根 $3$ 下。   \n\n第 $5$ 次操作 时，$x=(2+2) \\bmod 5=4$，$y=(0+2) \\bmod 5=2$，将 $4$ 所在树的根 $4$ 接在 $2$ 所在树的根 $3$ 下。    \n\n第 $6$ 次操作 时，$x=(4+2) \\bmod 5=1$，$1$ 所在树如图 $2$，在 $0\\sim 4$ 中分别填入 $[1,2,3,0,4]$，$[1,3,2,0,4]$，$[1,2,4,0,3]$，$[1,4,2,0,3]$，$[1,3,4,0,2]$，$[1,4,3,0,2]$，$[2,4,3,0,1]$，$[2,3,4,0,1]$ 可以产生 $8$ 种不同的堆。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mqsr3nri.png)\n\n#### 【数据规模与约定】\n\n对于 $100\\%$ 的数据，$0\\le x',y' <n \\le 3\\times 10^5$，$1\\le q\\le 3\\times 10^5$。\n\n对于不同测试点，我们约定\n\n::cute-table{tuack}\n\n\n|测试点编号|$n\\le$|$q\\le$|特殊性质 $1$|特殊性质 $2$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$20$|是|否|\n|$2$|^|^|否|是|\n|$3$|^|^|^|否|\n|$4$|^|^|^|^|\n|$5$|$300$|$600$|是|^|\n|$6$|^|^|否|是|\n|$7$|^|^|^|否|\n|$8$|$2000$|$4000$|是|^|\n|$9$|^|^|否|是|\n|$10$|^|^|^|否|\n|$11$|$5\\times10^4$|$10^5$|是|^|\n|$12$|^|^|否|是|\n|$13$|^|^|^|否|\n|$14$|^|^|^|^|\n|$15$|^|^|^|^|\n|$16$|$3\\times10^5$|$3\\times10^5$|是|^|\n|$17$|^|^|否|是|\n|$18$|^|^|^|否|\n|$19$|^|^|^|^|\n|$20$|^|^|^|^|\n\n\n特殊性质 $1$：存在 $1\\le i<n $，前 $i$ 次操作均为 $1$ 操作，之后全是 $2$ 操作。\n\n特殊性质 $2$：对于所有输入 $x$ 和 $y$ 本身即是其所在树的根。\n\n感谢 @Fairicle 提供的数据。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] D-ary Heap", "background": "JXCSP-S T5.", "description": "A d-ary heap is a tree-structured data structure. In this problem, we only consider the min-heap, which satisfies that for every node except the root, the weight of the node is not less than the weight of its parent. Except for leaf nodes, every node has at least one child.\n\nInitially, there are $n$ nodes, numbered $0 \\sim n - 1$. Each node is a single-node tree rooted at itself. Then there are $q$ operations in order, and each operation is one of the following two types:\n\n* `1 x y`: Choose nodes $x$ and $y$ that are not in the same tree. Attach the root of the tree containing $x$ directly under the root of the tree containing $y$. Then the trees containing $x$ and $y$ merge into one tree.\n\n* `2 x`: Choose a node $x$, and let the number of nodes in the tree containing $x$ be $size$. You need to compute how many different d-ary heaps can be produced by filling the $size$ numbers $0 \\sim size - 1$ into the nodes of the tree containing $x$. Two heaps are different if and only if there exists a node whose filled value is different. Since the answer may be very large, you only need to output the result modulo $10^9+7$.", "inputFormat": "The first line contains two integers $n,q$, whose meanings are described above.\n\nIn the next $q$ lines, each line is in one of the following formats:\n\n* `1 x' y'`: You need to compute $x=(x'+ans) \\bmod n , y=(y'+ans) \\bmod n$ to get the actual $x$ and $y$. The input guarantees that the trees containing $x$ and $y$ are different.\n\n* `2 x'`: You need to compute $x=(x'+ans) \\bmod n$ to get the actual $x$.\n\nHere, $ans$ denotes the output of the previous type $2$ operation, and initially $ans=0$.", "outputFormat": "For each type $2$ operation, output one line with one integer representing the answer.", "hint": "#### Sample 1 Explanation\n\nIn the 1st operation, attach the root $1$ of the tree containing $1$ under the root $0$ of the tree containing $0$.\n\nIn the 2nd operation, attach the root $2$ of the tree containing $2$ under the root $0$ of the tree containing $0$.\n\nIn the 3rd operation, the tree containing $1$ is shown in Figure 1. Filling $0,1,2$ with $[0,1,2]$ and $[0,2,1]$ can produce $2$ different heaps.\n\nIn the 4th operation, $x=(3+2) \\bmod 5=0$, $y=(1+2) \\bmod 5=3$. Attach the root $0$ of the tree containing $0$ under the root $3$ of the tree containing $3$.\n\nIn the 5th operation, $x=(2+2) \\bmod 5=4$, $y=(0+2) \\bmod 5=2$. Attach the root $4$ of the tree containing $4$ under the root $3$ of the tree containing $2$.\n\nIn the 6th operation, $x=(4+2) \\bmod 5=1$. The tree containing $1$ is shown in Figure 2. Filling $0\\sim 4$ with $[1,2,3,0,4]$, $[1,3,2,0,4]$, $[1,2,4,0,3]$, $[1,4,2,0,3]$, $[1,3,4,0,2]$, $[1,4,3,0,2]$, $[2,4,3,0,1]$, $[2,3,4,0,1]$ can produce $8$ different heaps.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mqsr3nri.png)\n\n#### Constraints and Conventions\n\nFor $100\\%$ of the data, $0\\le x',y' <n \\le 3\\times 10^5$, $1\\le q\\le 3\\times 10^5$.\n\nFor different test points, we define:\n\n::cute-table{tuack}\n\n\n|Test Point ID|$n\\le$|$q\\le$|Special Property $1$|Special Property $2$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$20$|Yes|No|\n|$2$|^|^|No|Yes|\n|$3$|^|^|^|No|\n|$4$|^|^|^|^|\n|$5$|$300$|$600$|Yes|^|\n|$6$|^|^|No|Yes|\n|$7$|^|^|^|No|\n|$8$|$2000$|$4000$|Yes|^|\n|$9$|^|^|No|Yes|\n|$10$|^|^|^|No|\n|$11$|$5\\times10^4$|$10^5$|Yes|^|\n|$12$|^|^|No|Yes|\n|$13$|^|^|^|No|\n|$14$|^|^|^|^|\n|$15$|^|^|^|^|\n|$16$|$3\\times10^5$|$3\\times10^5$|Yes|^|\n|$17$|^|^|No|Yes|\n|$18$|^|^|^|No|\n|$19$|^|^|^|^|\n|$20$|^|^|^|^|\n\nSpecial Property $1$: There exists $1\\le i<n $, such that the first $i$ operations are all type $1$ operations, and all the remaining operations are type $2$ operations.\n\nSpecial Property $2$: For all inputs, $x$ and $y$ themselves are the roots of their respective trees.\n\nThanks to @Fairicle for providing the testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 多叉堆", "background": "JXCSP-S T5", "description": "多叉堆是一种树形数据结构，本题中我们只考虑小根堆，它满足除了根以外的结点，每个点的权值都不小于父亲的权值。除了叶结点，每个点有至少一个子结点。\n\n初始时有 $n$ 个结点，编号分别为 $0 \\sim n - 1$，每个结点都是一棵以自身为根的单点树。接下来按顺序有 $q$ 次操作，每次操作有以下两种：\n\n* `1 x y`：选择不在同一棵树里的结点 $x$ 和 $y$，将 $x$ 所在树的根直接接在 $y$ 所在树的根之下，此时 $x$ 和 $y$ 所在树将合并为同一棵树。\n\n* `2 x`：选择结点 $x$，设 $x$ 当前所在树的结点数为 $size$。你需要计算将 $0 \\sim size - 1$ 这 $size$ 个数分别填入 $x$ 所在树的结点中，能够产生多少种不同的多叉堆。两种堆不同当且仅当存在某个结点填入的值不同。由于答案可能很大，你只需要求出答案模 $10^9+7$ 后的结果。", "inputFormat": "第一行两个整数 $n,q$，具体含义见题目描述。\n\n接下来 $q$ 行每行可能是下面两种格式之一：\n\n* `1 x' y'`：你需要通过计算 $x=(x'+ans) \\bmod n , y=(y'+ans) \\bmod n$ 来得到真正的 $x$ 和 $y$，输入保证 $x$ 和 $y$ 所在树不同。\n\n* `2 x'`：你需要通过计算 $x=(x'+ans) \\bmod n$ 来得到真正的 $x$。\n\n其中 $ans$ 表示上一次 $2$ 操作的输出结果，初始时 $ans=0$。", "outputFormat": "对于每次 $2$ 操作输出一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n\n第 $1$ 次操作时，将 $1$ 所在树的根 $1$ 接在 $0$ 所在树的根 $0$ 下。 \n\n第 $2$ 次操作时，将 $2$ 所在树的根 $2$ 接在 $0$ 所在树的根 $0$ 下。   \n\n第 $3$ 次操作时，$1$ 所在树如图 $1$，在 $0,1,2$ 中分别填入 $[0,1,2]$ 和 $[0,2,1]$ 可以产生 $2$ 种不同的堆。    \n\n第 $4$ 次操作时 $x=(3+2) \\bmod 5=0$，$y=(1+2) \\bmod 5=3$，将 $0$ 所在树的根 $0$ 接在 $3$ 所在树的根 $3$ 下。   \n\n第 $5$ 次操作 时，$x=(2+2) \\bmod 5=4$，$y=(0+2) \\bmod 5=2$，将 $4$ 所在树的根 $4$ 接在 $2$ 所在树的根 $3$ 下。    \n\n第 $6$ 次操作 时，$x=(4+2) \\bmod 5=1$，$1$ 所在树如图 $2$，在 $0\\sim 4$ 中分别填入 $[1,2,3,0,4]$，$[1,3,2,0,4]$，$[1,2,4,0,3]$，$[1,4,2,0,3]$，$[1,3,4,0,2]$，$[1,4,3,0,2]$，$[2,4,3,0,1]$，$[2,3,4,0,1]$ 可以产生 $8$ 种不同的堆。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mqsr3nri.png)\n\n#### 【数据规模与约定】\n\n对于 $100\\%$ 的数据，$0\\le x',y' <n \\le 3\\times 10^5$，$1\\le q\\le 3\\times 10^5$。\n\n对于不同测试点，我们约定\n\n::cute-table{tuack}\n\n\n|测试点编号|$n\\le$|$q\\le$|特殊性质 $1$|特殊性质 $2$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$20$|是|否|\n|$2$|^|^|否|是|\n|$3$|^|^|^|否|\n|$4$|^|^|^|^|\n|$5$|$300$|$600$|是|^|\n|$6$|^|^|否|是|\n|$7$|^|^|^|否|\n|$8$|$2000$|$4000$|是|^|\n|$9$|^|^|否|是|\n|$10$|^|^|^|否|\n|$11$|$5\\times10^4$|$10^5$|是|^|\n|$12$|^|^|否|是|\n|$13$|^|^|^|否|\n|$14$|^|^|^|^|\n|$15$|^|^|^|^|\n|$16$|$3\\times10^5$|$3\\times10^5$|是|^|\n|$17$|^|^|否|是|\n|$18$|^|^|^|否|\n|$19$|^|^|^|^|\n|$20$|^|^|^|^|\n\n\n特殊性质 $1$：存在 $1\\le i<n $，前 $i$ 次操作均为 $1$ 操作，之后全是 $2$ 操作。\n\n特殊性质 $2$：对于所有输入 $x$ 和 $y$ 本身即是其所在树的根。\n\n感谢 @Fairicle 提供的数据。", "locale": "zh-CN"}}}
{"pid": "P5690", "type": "P", "difficulty": 2, "samples": [["03-32", "1"], ["02-39", "1"], ["67-89", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2019", "枚举", "江西", "CSP-S 提高级", "分类讨论"], "title": "[CSP-S 2019 江西] 日期", "background": "CSP-SJX2019 T1", "description": "Alice 在纸上写下了一个日期，形式为 $\\text{MM-DD}$，其中 $\\text{MM}$ 与 $\\text{DD}$ 都是两位数字，分别表示月和天，然而这个日期并不一定存在。 Alice 找来了 Bob 要他更改若干位上的数字，使得这个日期存在。请你帮 Bob 算算他最少需要更改几位数字。\n\n本题中我们认为 $2$ 月固定为 $28$ 天。", "inputFormat": "仅一行一个五个字符的字符串，表示 $\\text{MM-DD}$ 。", "outputFormat": "仅一行一个整数，表示答案。", "hint": "【输入输出样例 1 说明】\n\n更改方式不止一种，其中一种方式是改为： $\\text{03-22}$。\n\n【输入输出样例 2 说明】\n\n一种更改方式为：$\\text{02-09}$。\n\n【输入输出样例 3 说明】\n\n一种更改方式为：$\\text{07-09}$。\n\n【数据规模与约定】\n对于 $100\\%$ 的数据：$\\text{MM}$ 与 $\\text{DD}$ 一定为 $4$ 个数字。\n\n**update: 2024/07/04 增加 hack 一组。**", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] Date", "background": "CSP-SJX2019 T1", "description": "Alice wrote a date on paper in the form $\\text{MM-DD}$, where $\\text{MM}$ and $\\text{DD}$ are both two-digit numbers representing the month and the day, respectively. However, this date may not actually exist. Alice asked Bob to change the digits in some positions so that the date becomes valid. Please help Bob compute the minimum number of digits he needs to change.\n\nIn this problem, February is fixed to have $28$ days.", "inputFormat": "A single line containing a string of five characters, representing $\\text{MM-DD}$.", "outputFormat": "A single line containing one integer, representing the answer.", "hint": "[Explanation for Sample Input/Output 1]\n\nThere is more than one way to change it. One possible result is: $\\text{03-22}$.\n\n[Explanation for Sample Input/Output 2]\n\nOne possible result is: $\\text{02-09}$.\n\n[Explanation for Sample Input/Output 3]\n\nOne possible result is: $\\text{07-09}$.\n\n[Constraints]\n\nFor $100\\%$ of the testdata, $\\text{MM}$ and $\\text{DD}$ are guaranteed to be $4$ digits.\n\n**update: 2024/07/04 Added one hack case.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 日期", "background": "CSP-SJX2019 T1", "description": "Alice 在纸上写下了一个日期，形式为 $\\text{MM-DD}$，其中 $\\text{MM}$ 与 $\\text{DD}$ 都是两位数字，分别表示月和天，然而这个日期并不一定存在。 Alice 找来了 Bob 要他更改若干位上的数字，使得这个日期存在。请你帮 Bob 算算他最少需要更改几位数字。\n\n本题中我们认为 $2$ 月固定为 $28$ 天。", "inputFormat": "仅一行一个五个字符的字符串，表示 $\\text{MM-DD}$ 。", "outputFormat": "仅一行一个整数，表示答案。", "hint": "【输入输出样例 1 说明】\n\n更改方式不止一种，其中一种方式是改为： $\\text{03-22}$。\n\n【输入输出样例 2 说明】\n\n一种更改方式为：$\\text{02-09}$。\n\n【输入输出样例 3 说明】\n\n一种更改方式为：$\\text{07-09}$。\n\n【数据规模与约定】\n对于 $100\\%$ 的数据：$\\text{MM}$ 与 $\\text{DD}$ 一定为 $4$ 个数字。\n\n**update: 2024/07/04 增加 hack 一组。**", "locale": "zh-CN"}}}
{"pid": "P5691", "type": "P", "difficulty": 4, "samples": [["3\n150\n1 2\n-1 2\n1 2", "178"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2001", "NOI", "折半搜索 meet in the middle"], "title": "[NOI2001] 方程的解数", "background": null, "description": "已知一个 $n$ 元高次方程：         \n$$\\sum\\limits_{i=1}^n k_ix_i^{p_i} = 0$$\n其中：$x_1, x_2, \\dots ,x_n$ 是未知数，$k_1,k_2, \\dots ,k_n$ 是系数，$p_1,p_2,…p_n$ 是指数。且方程中的所有数均为整数。\n\n假设未知数 $x_i \\in [1,m] \\space ( i \\in [1,n])$，求这个方程的整数解的个数。", "inputFormat": "第一行一个正整数 $n$，表示未知数个数。  \n第二行一个正整数 $m$。\n接下来 $n$ 行，每行两个整数 $k_i,p_i$。", "outputFormat": "输出一行一个整数，表示方程解的个数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le n \\le 6$，$1\\le m \\le 150$，且\n$$\\sum\\limits_{i=1}^n |k_im^{p_i}| < 2^{31}$$  \n答案不超过 $2^{31}-1$，$p_i \\in \\mathbb N^*\\cap[0,2^{31})$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2001] Number of Solutions of an Equation", "background": "", "description": "Given an $n$-variable higher-degree equation:\n$$\\sum\\limits_{i=1}^n k_ix_i^{p_i} = 0$$\nwhere $x_1, x_2, \\dots, x_n$ are the unknowns, $k_1, k_2, \\dots, k_n$ are the coefficients, and $p_1, p_2, \\dots, p_n$ are the exponents. All numbers in the equation are integers.\n\nAssume the unknowns satisfy $x_i \\in [1,m] \\space ( i \\in [1,n])$. Find the number of integer solutions to this equation.", "inputFormat": "The first line contains a positive integer $n$, the number of unknowns.  \nThe second line contains a positive integer $m$.  \nThe next $n$ lines each contain two integers $k_i, p_i$.", "outputFormat": "Output one line with one integer, the number of solutions of the equation.", "hint": "**【Constraints】**\n\nFor $100\\%$ of the testdata, $1\\le n \\le 6$, $1\\le m \\le 150$, and\n$$\\sum\\limits_{i=1}^n |k_im^{p_i}| < 2^{31}$$  \nThe answer does not exceed $2^{31}-1$, and $p_i \\in \\mathbb N^*\\cap[0,2^{31})$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2001] 方程的解数", "background": null, "description": "已知一个 $n$ 元高次方程：         \n$$\\sum\\limits_{i=1}^n k_ix_i^{p_i} = 0$$\n其中：$x_1, x_2, \\dots ,x_n$ 是未知数，$k_1,k_2, \\dots ,k_n$ 是系数，$p_1,p_2,…p_n$ 是指数。且方程中的所有数均为整数。\n\n假设未知数 $x_i \\in [1,m] \\space ( i \\in [1,n])$，求这个方程的整数解的个数。", "inputFormat": "第一行一个正整数 $n$，表示未知数个数。  \n第二行一个正整数 $m$。\n接下来 $n$ 行，每行两个整数 $k_i,p_i$。", "outputFormat": "输出一行一个整数，表示方程解的个数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le n \\le 6$，$1\\le m \\le 150$，且\n$$\\sum\\limits_{i=1}^n |k_im^{p_i}| < 2^{31}$$  \n答案不超过 $2^{31}-1$，$p_i \\in \\mathbb N^*\\cap[0,2^{31})$。", "locale": "zh-CN"}}}
{"pid": "P5692", "type": "P", "difficulty": 7, "samples": [["6 5\n1 1 4 5 1 4\n1 1 3 1 7\n2 1 4 7 7\n1 1 5 7 3\n2 2 6 1 3\n2 3 3 3 3\n", "0\n3\n-1\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "洛谷原创", "O2优化", "分块"], "title": "[MtOI2019] 手牵手走向明天", "background": "2019 年 5 月 17 日，Ynoi2018 Day 2 的题目上传至洛谷公共题库。\n\n2019 年 5 月 19 日，mrsrz 想出了[[Ynoi2018]天降之物](https://www.luogu.com.cn/problem/P5397)的序列分块做法，并尝试 AC 该题。\n\n2019 年 5 月 21 日，在 lxl 略微放宽时限，加上各种玄学优化下，mrsrz 通过了此题（现在时限改回来了所以没希望了）。\n\n过了若干日，mrsrz 发现该序列分块做法可以支持区间查询，和 lxl 讨论后，发现也可以做到区间修改。\n\n2019 年 10 月，mrsrz 找到 disangan233 并告诉了他这个题。disangan233 收下了这个题并打算作为 MtOI2019 Extra Round 的 F 题。\n\n2019 年 11 月 1 日，mrsrz 发现某个地方的某个比赛的某个题和该题有类似的地方。观察题解后发现了几乎一样的做法。然后这个原来的 F 题没了。\n\n2019 年 11 月 2 日，MtOI2019 Extra Round 顺利进行。\n\n2019 年 11 月 30 日，mrsrz 想起了这道题，决定将这道饱经风霜的题贡献至公共题库中。希望这道题，能对大家有所帮助。\n\nby mrsrz\n\n2019 年 11 月 30 日\n\n### Update：\n\n2019 年 12 月 2 日，经 disangan233 同意，本题仍使用原来的题面。\n\n2021 年 8 月 13 日，更新了 std，现在 std 的空间复杂度为 $O(n+m)$。\n\n---\n\n「俺、セツナは、お前を永遠に愛することちか！」  \n「我，Setsuna，发誓将会永远爱着你！」\n\n「私の、あなたを永遠に愛することちかう！」  \n「我也是，发誓会永远爱着你！」\n\n「歴史がかでもまた得た、ウェディングドレスてあみあをそ！」   \n「要是我们在其他的历史中再次相遇，那就披上婚纱再来一次吧！」\n\n![rinne.png](https://i.loli.net/2019/10/03/oR4tNIQ6rBMe8GU.png)", "description": "Rinne 给了你一个数列 $a_1,a_2,\\dots,a_n$，你需要依次执行 $m$ 个操作。\n\n操作共有两种：\n\n1. 给定 $l,r,x,y$，将 $a_l,a_{l+1},a_{l+2},\\dots,a_r$ 中等于 $x$ 的数全部改成 $y$。\n\n2. 给定 $l,r,x,y$，找到 $i,j$ 满足 $i,j\\in[l,r]$ 且 $a_i=x,a_j=y$，并要求 $|i-j|$ 最小。求这个最小值。无解输出 $-1$。", "inputFormat": "第一行两个正整数 $n,m$，表示序列长度和操作个数。\n\n第二行 $n$ 个正整数 $a_1,a_2,\\dots,a_n$。\n\n接下来 $m$ 行，每行五个正整数 $op,l,r,x,y$。若 $op=1$，表示修改操作。若 $op=2$，表示询问操作。$l,r,x,y$ 对应的含义见题目描述。", "outputFormat": "对每个 $op=2$ 的操作，输出一行一个整数表示答案。", "hint": "对于 $100\\%$ 的数据，$1\\leq n,m,a_i,x,y\\leq 10^5$，$1\\leq l\\leq r\\leq n$。\n\n本题共有 $6$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$（$1$ 分）：保证对于任意操作，$l=1,r=n$。\n\n子任务 $2$（$5$ 分）：$n,m\\leq 50$。\n\n子任务 $3$（$18$ 分）：$n,m\\leq 2000$。\n\n子任务 $4$（$7$ 分）：保证 $a_i,x,y\\in\\{1,2\\}$。\n\n子任务 $5$（$29$ 分）：保证当 $op=2$ 时，$x=y$。\n\n子任务 $6$（$40$ 分）：没有特殊限制。\n\n**时间限制**：$1.5\\rm s$\n\n**空间限制**：$512\\rm MB$\n\nIdea：nzhtl1477，mrsrz\n\nSolution：mrsrz，nzhtl1477\n\nCode：mrsrz\n\nData：mrsrz\n\nBackground：disangan233，mrsrz", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Holding Hands Towards Tomorrow.", "background": "On May 17, 2019, the problems of Ynoi2018 Day 2 were uploaded to the public problemset on Luogu.\n\nOn May 19, 2019, mrsrz came up with a sequence block-decomposition approach for [[Ynoi2018]天降之物](https://www.luogu.com.cn/problem/P5397) and tried to get AC on that problem.\n\nOn May 21, 2019, with lxl slightly relaxing the time limit and with various “mysterious” optimizations, mrsrz passed the problem (the time limit has now been changed back, so there is no hope anymore).\n\nAfter a few days, mrsrz found that this block-decomposition approach could support range queries. After discussing with lxl, they found that it could also handle range modifications.\n\nIn October 2019, mrsrz found disangan233 and told him about this problem. disangan233 accepted it and planned to use it as problem F of MtOI2019 Extra Round.\n\nOn November 1, 2019, mrsrz found that a certain problem from a certain contest had something similar to this one. After reading the editorial, he found an almost identical approach. Then the original problem F was gone.\n\nOn November 2, 2019, MtOI2019 Extra Round was held successfully.\n\nOn November 30, 2019, mrsrz remembered this problem and decided to contribute this weather-beaten problem to the public problemset. He hopes this problem can be helpful to everyone.\n\nby mrsrz\n\nNovember 30, 2019\n\n### Update:\n\nOn December 2, 2019, with disangan233’s consent, this problem still uses the original statement.\n\nOn August 13, 2021, the std was updated, and now the space complexity of std is $O(n+m)$.\n\n---\n\n「俺、セツナは、お前を永遠に愛することちか！」  \n「Me, Setsuna, swear that I will love you forever!」\n\n「私の、あなたを永遠に愛することちかう！」  \n「Me too, I swear I will love you forever!」\n\n「歴史がかでもまた得た、ウェディングドレスてあみあをそ！」   \n「If we meet again in another history, then put on a wedding dress and do it once more!」\n\n![rinne.png](https://i.loli.net/2019/10/03/oR4tNIQ6rBMe8GU.png)", "description": "Rinne gives you a sequence $a_1,a_2,\\dots,a_n$. You need to perform $m$ operations in order.\n\nThere are two types of operations:\n\n1. Given $l,r,x,y$, change all numbers equal to $x$ among $a_l,a_{l+1},a_{l+2},\\dots,a_r$ into $y$.\n\n2. Given $l,r,x,y$, find $i,j$ such that $i,j\\in[l,r]$ and $a_i=x,a_j=y$, and require $|i-j|$ to be minimized. Output this minimum value. If there is no solution, output $-1$.", "inputFormat": "The first line contains two positive integers $n,m$, representing the sequence length and the number of operations.\n\nThe second line contains $n$ positive integers $a_1,a_2,\\dots,a_n$.\n\nThe next $m$ lines each contain five positive integers $op,l,r,x,y$. If $op=1$, it is a modification operation. If $op=2$, it is a query operation. The meanings of $l,r,x,y$ are as described in the statement.", "outputFormat": "For each operation with $op=2$, output one line with one integer, representing the answer.", "hint": "For $100\\%$ of the testdata, $1\\leq n,m,a_i,x,y\\leq 10^5$, $1\\leq l\\leq r\\leq n$.\n\nThis problem has $6$ subtasks, with the following limits:\n\nSubtask $1$ ($1$ point): Guaranteed that for any operation, $l=1,r=n$.\n\nSubtask $2$ ($5$ points): $n,m\\leq 50$.\n\nSubtask $3$ ($18$ points): $n,m\\leq 2000$.\n\nSubtask $4$ ($7$ points): Guaranteed that $a_i,x,y\\in\\{1,2\\}$.\n\nSubtask $5$ ($29$ points): Guaranteed that when $op=2$, $x=y$.\n\nSubtask $6$ ($40$ points): No special restrictions.\n\n**Time limit**: $1.5\\rm s$\n\n**Memory limit**: $512\\rm MB$\n\nIdea: nzhtl1477, mrsrz.\n\nSolution: mrsrz, nzhtl1477.\n\nCode: mrsrz.\n\nData: mrsrz.\n\nBackground: disangan233, mrsrz.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 手牵手走向明天", "background": "2019 年 5 月 17 日，Ynoi2018 Day 2 的题目上传至洛谷公共题库。\n\n2019 年 5 月 19 日，mrsrz 想出了[[Ynoi2018]天降之物](https://www.luogu.com.cn/problem/P5397)的序列分块做法，并尝试 AC 该题。\n\n2019 年 5 月 21 日，在 lxl 略微放宽时限，加上各种玄学优化下，mrsrz 通过了此题（现在时限改回来了所以没希望了）。\n\n过了若干日，mrsrz 发现该序列分块做法可以支持区间查询，和 lxl 讨论后，发现也可以做到区间修改。\n\n2019 年 10 月，mrsrz 找到 disangan233 并告诉了他这个题。disangan233 收下了这个题并打算作为 MtOI2019 Extra Round 的 F 题。\n\n2019 年 11 月 1 日，mrsrz 发现某个地方的某个比赛的某个题和该题有类似的地方。观察题解后发现了几乎一样的做法。然后这个原来的 F 题没了。\n\n2019 年 11 月 2 日，MtOI2019 Extra Round 顺利进行。\n\n2019 年 11 月 30 日，mrsrz 想起了这道题，决定将这道饱经风霜的题贡献至公共题库中。希望这道题，能对大家有所帮助。\n\nby mrsrz\n\n2019 年 11 月 30 日\n\n### Update：\n\n2019 年 12 月 2 日，经 disangan233 同意，本题仍使用原来的题面。\n\n2021 年 8 月 13 日，更新了 std，现在 std 的空间复杂度为 $O(n+m)$。\n\n---\n\n「俺、セツナは、お前を永遠に愛することちか！」  \n「我，Setsuna，发誓将会永远爱着你！」\n\n「私の、あなたを永遠に愛することちかう！」  \n「我也是，发誓会永远爱着你！」\n\n「歴史がかでもまた得た、ウェディングドレスてあみあをそ！」   \n「要是我们在其他的历史中再次相遇，那就披上婚纱再来一次吧！」\n\n![rinne.png](https://i.loli.net/2019/10/03/oR4tNIQ6rBMe8GU.png)", "description": "Rinne 给了你一个数列 $a_1,a_2,\\dots,a_n$，你需要依次执行 $m$ 个操作。\n\n操作共有两种：\n\n1. 给定 $l,r,x,y$，将 $a_l,a_{l+1},a_{l+2},\\dots,a_r$ 中等于 $x$ 的数全部改成 $y$。\n\n2. 给定 $l,r,x,y$，找到 $i,j$ 满足 $i,j\\in[l,r]$ 且 $a_i=x,a_j=y$，并要求 $|i-j|$ 最小。求这个最小值。无解输出 $-1$。", "inputFormat": "第一行两个正整数 $n,m$，表示序列长度和操作个数。\n\n第二行 $n$ 个正整数 $a_1,a_2,\\dots,a_n$。\n\n接下来 $m$ 行，每行五个正整数 $op,l,r,x,y$。若 $op=1$，表示修改操作。若 $op=2$，表示询问操作。$l,r,x,y$ 对应的含义见题目描述。", "outputFormat": "对每个 $op=2$ 的操作，输出一行一个整数表示答案。", "hint": "对于 $100\\%$ 的数据，$1\\leq n,m,a_i,x,y\\leq 10^5$，$1\\leq l\\leq r\\leq n$。\n\n本题共有 $6$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$（$1$ 分）：保证对于任意操作，$l=1,r=n$。\n\n子任务 $2$（$5$ 分）：$n,m\\leq 50$。\n\n子任务 $3$（$18$ 分）：$n,m\\leq 2000$。\n\n子任务 $4$（$7$ 分）：保证 $a_i,x,y\\in\\{1,2\\}$。\n\n子任务 $5$（$29$ 分）：保证当 $op=2$ 时，$x=y$。\n\n子任务 $6$（$40$ 分）：没有特殊限制。\n\n**时间限制**：$1.5\\rm s$\n\n**空间限制**：$512\\rm MB$\n\nIdea：nzhtl1477，mrsrz\n\nSolution：mrsrz，nzhtl1477\n\nCode：mrsrz\n\nData：mrsrz\n\nBackground：disangan233，mrsrz", "locale": "zh-CN"}}}
{"pid": "P5693", "type": "P", "difficulty": 7, "samples": [["5 5\n-2 -3 -3 -3 -3\n2 1 5\n1 2 4 4\n2 1 5\n1 2 3 1\n2 3 3", "0\n3\n2"]], "limits": {"time": [1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "O2优化"], "title": "EI 的第六分块", "background": "他说他解决了经典根号复杂度问题，怕引起轰动所以撤回了.jpg  \n\n不过 [EntropyIncreaser](https://www.luogu.com.cn/user/21423) 确实得到了此题更优的做法。", "description": "给定一个整数序列 $a$，支持两种操作：  \n\n- `1 l r x` 表示给区间 $[l,r]$ 中每个数加上 $x$  \n- `2 l r` 表示查询区间 $[l,r]$ 的最大子段和（可以为空）", "inputFormat": "第一行两个正整数 $n,q$，表示序列长度和操作个数。  \n接下来一行 $n$ 个整数，表示初始的序列 $a$。  \n接着有 $q$ 行，每行若干个整数，表示一次操作。", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$1\\le n,q \\le 1000$；  \n对于 $60\\%$ 的数据，$1\\le n,q \\le 10^5$；  \n对于 $100\\%$ 的数据，$1\\le n,q \\le 4\\times 10^5$，$|a_i| \\le 10^9$，$1 \\le x \\le 10^6$。\n\nIdea：nzhtl1477   \nSolution：EntropyIncreaser  \nCode：EntropyIncreaser   \nData：NaCly_Fish\n\n### 请注意常数优化。", "locale": "zh-CN", "translations": {"en": {"title": "The Sixth Block Decomposition of EI", "background": "He said he solved the classic square-root complexity problem, but he withdrew it because he was afraid of causing a sensation .jpg.\n\nHowever, [EntropyIncreaser](https://www.luogu.com.cn/user/21423) did obtain a better solution for this problem.", "description": "Given an integer sequence $a$, support two operations:\n\n- `1 l r x` means adding $x$ to every number in the interval $[l,r]$.\n- `2 l r` means querying the maximum subarray sum of the interval $[l,r]$ (it may be empty).", "inputFormat": "The first line contains two positive integers $n,q$, representing the length of the sequence and the number of operations.\nThe next line contains $n$ integers, representing the initial sequence $a$.\nThen there are $q$ lines, each containing several integers, representing one operation.", "outputFormat": "For each operation of type `2`, output one line with one integer representing the answer.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $1\\le n,q \\le 1000$.\nFor $60\\%$ of the testdata, $1\\le n,q \\le 10^5$.\nFor $100\\%$ of the testdata, $1\\le n,q \\le 4\\times 10^5$, $|a_i| \\le 10^9$, $1 \\le x \\le 10^6$.\n\nIdea: nzhtl1477.\nSolution: EntropyIncreaser.\nCode: EntropyIncreaser.\nData: NaCly_Fish.\n\n### Please pay attention to constant-factor optimization.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "EI 的第六分块", "background": "他说他解决了经典根号复杂度问题，怕引起轰动所以撤回了.jpg  \n\n不过 [EntropyIncreaser](https://www.luogu.com.cn/user/21423) 确实得到了此题更优的做法。", "description": "给定一个整数序列 $a$，支持两种操作：  \n\n- `1 l r x` 表示给区间 $[l,r]$ 中每个数加上 $x$  \n- `2 l r` 表示查询区间 $[l,r]$ 的最大子段和（可以为空）", "inputFormat": "第一行两个正整数 $n,q$，表示序列长度和操作个数。  \n接下来一行 $n$ 个整数，表示初始的序列 $a$。  \n接着有 $q$ 行，每行若干个整数，表示一次操作。", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$1\\le n,q \\le 1000$；  \n对于 $60\\%$ 的数据，$1\\le n,q \\le 10^5$；  \n对于 $100\\%$ 的数据，$1\\le n,q \\le 4\\times 10^5$，$|a_i| \\le 10^9$，$1 \\le x \\le 10^6$。\n\nIdea：nzhtl1477   \nSolution：EntropyIncreaser  \nCode：EntropyIncreaser   \nData：NaCly_Fish\n\n### 请注意常数优化。", "locale": "zh-CN"}}}
{"pid": "P5694", "type": "P", "difficulty": 5, "samples": [["1 1 1 2", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["动态规划 DP", "2001", "NOI"], "title": "[NOI2001] 陨石的秘密", "background": "", "description": "公元11380年，一颗巨大的陨石坠落在南极。于是，灾难降临了，地球上出现了一系列反常的现象。当人们焦急万分的时候，一支中国科学家组成的南极考察队赶到了出事地点。经过一番侦察，科学家们发现陨石上刻有若干行密文，每一行都包含5个整数：\n\n```\n1 1 1 1 6\n0 0 6 3 57\n8 0 11 3 2845\n```\n\n著名的科学家 SS 发现，这些密文实际上是一种复杂运算的结果。为了便于大家理解这种运算，他定义了一种 SS 表达式：\n\n1. SS 表达式是仅由 `{`, `}`, `[`, `]`, `(`, `)` 组成的字符串。\n2. 一个空串是 SS 表达式。\n3. 如果 $ A $ 是SS表达式，且 $ A $ 中不含字符 `{`, `}`, `[`, `]`，则 $ (A) $ 是SS表达式。\n4. 如果 $ A $ 是 SS 表达式，且 $ A $ 中不含字符 `{`, `}`，则 $ [A] $ 是 SS 表达式。\n5. 如果 $ A $ 是 SS 表达式，则 $ \\{A\\} $ 是 SS 表达式。\n6. 如果 $ A $ 和 $ B $ 都是 SS 表达式，则 $ AB $ 也是 SS 表达式。\n\n一个 SS 表达式 $ E $ 的深度 $ D(E) $定义如下：\n\n$$\n\\scriptstyle{\nD(E) =\n\\begin{cases}\n \\scriptstyle{0}, & \\scriptstyle{\\text{如果 } E \\text{ 是空串}} \\\\\n \\scriptstyle{D(A) + 1}, &  \\scriptstyle{\\text{如果 } E = (A) \\text{ 或者 } E = [A] \\text{ 或者 } E = \\{A\\}, \\text{ 其中 } A \\text{ 是 SS 表达式}} \\\\\n \\scriptstyle{\\max(D(A), D(B))}, &  \\scriptstyle{\\text{ 如果 } E = AB, \\text{其中 } A, B \\text{ 是 SS 表达式}}\n\\end{cases}\n}\n$$\n\n例如 `(){()}[]` 的深度为 $ 2 $。\n\n密文中的复杂运算是这样进行的：\n\n设密文中每行前 $ 4 $ 个数依次为 $ L_1, L_2, L_3, D $，求出所有深度为 $ D $，含有 $ L_1 $ 对 `{}`，$ L_2 $ 对 `[]`，$ L_3 $ 对 `()` 的 SS 串的个数，并用这个数对当前的年份 $ 11380 $ 求余数，这个余数就是密文中每行的第 $ 5 $ 个数，我们称之为“神秘数”。\n\n密文中某些行的第五个数已经模糊不清，而这些数字正是揭开陨石秘密的钥匙。现在科学家们聘请你来计算这个神秘数。\n", "inputFormat": "共一行，$ 4 $ 个整数 $ L_1, L_2, L_3, D $。相邻两个数之间用一个空格分隔。", "outputFormat": "共一行，包含一个整数，即神秘数。", "hint": "$ 0 \\le L_1, L_2, L_3 \\le 10$，$0 \\le D \\le 30 $。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2001] The Secret of the Meteorite", "background": "", "description": "In the year 11380 AD, a huge meteorite fell in Antarctica. Then disaster struck, and a series of abnormal phenomena appeared on Earth. When people were extremely anxious, a Chinese scientific expedition to Antarctica arrived at the scene. After some investigation, the scientists found several lines of ciphertext carved on the meteorite, and each line contains 5 integers:\n\n```\n1 1 1 1 6\n0 0 6 3 57\n8 0 11 3 2845\n```\n\nThe famous scientist SS discovered that these ciphertexts are actually the results of a complex operation. To make this operation easier to understand, he defined an SS expression:\n\n1. An SS expression is a string consisting only of `{`, `}`, `[`, `]`, `(`, `)`.\n2. The empty string is an SS expression.\n3. If $ A $ is an SS expression and $ A $ does not contain the characters `{`, `}`, `[`, `]`, then $ (A) $ is an SS expression.\n4. If $ A $ is an SS expression and $ A $ does not contain the characters `{`, `}`, then $ [A] $ is an SS expression.\n5. If $ A $ is an SS expression, then $ \\{A\\} $ is an SS expression.\n6. If $ A $ and $ B $ are both SS expressions, then $ AB $ is also an SS expression.\n\nThe depth $ D(E) $ of an SS expression $ E $ is defined as follows:\n\n$$\n\\scriptstyle{\nD(E) =\n\\begin{cases}\n \\scriptstyle{0}, & \\scriptstyle{\\text{if } E \\text{ is the empty string}} \\\\\n \\scriptstyle{D(A) + 1}, &  \\scriptstyle{\\text{if } E = (A) \\text{ or } E = [A] \\text{ or } E = \\{A\\}, \\text{ where } A \\text{ is an SS expression}} \\\\\n \\scriptstyle{\\max(D(A), D(B))}, &  \\scriptstyle{\\text{if } E = AB, \\text{ where } A, B \\text{ are SS expressions}}\n\\end{cases}\n}\n$$\n\nFor example, the depth of `(){()}[]` is $ 2 $.\n\nThe complex operation in the ciphertext is performed as follows:\n\nLet the first $ 4 $ numbers in each line of the ciphertext be $ L_1, L_2, L_3, D $ in order. Compute the number of all SS strings with depth $ D $, containing $ L_1 $ pairs of `{}`, $ L_2 $ pairs of `[]`, and $ L_3 $ pairs of `()`; then take this number modulo the current year $ 11380 $. This remainder is the $ 5 $-th number in that line of the ciphertext, and we call it the “mysterious number”.\n\nThe fifth number in some lines of the ciphertext has become blurry, and these numbers are the key to uncovering the meteorite’s secret. Now the scientists hire you to compute this mysterious number.", "inputFormat": "One line with $ 4 $ integers $ L_1, L_2, L_3, D $. Adjacent numbers are separated by a single space.", "outputFormat": "One line containing one integer, the mysterious number.", "hint": "$ 0 \\le L_1, L_2, L_3 \\le 10$，$0 \\le D \\le 30 $。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2001] 陨石的秘密", "background": "", "description": "公元11380年，一颗巨大的陨石坠落在南极。于是，灾难降临了，地球上出现了一系列反常的现象。当人们焦急万分的时候，一支中国科学家组成的南极考察队赶到了出事地点。经过一番侦察，科学家们发现陨石上刻有若干行密文，每一行都包含5个整数：\n\n```\n1 1 1 1 6\n0 0 6 3 57\n8 0 11 3 2845\n```\n\n著名的科学家 SS 发现，这些密文实际上是一种复杂运算的结果。为了便于大家理解这种运算，他定义了一种 SS 表达式：\n\n1. SS 表达式是仅由 `{`, `}`, `[`, `]`, `(`, `)` 组成的字符串。\n2. 一个空串是 SS 表达式。\n3. 如果 $ A $ 是SS表达式，且 $ A $ 中不含字符 `{`, `}`, `[`, `]`，则 $ (A) $ 是SS表达式。\n4. 如果 $ A $ 是 SS 表达式，且 $ A $ 中不含字符 `{`, `}`，则 $ [A] $ 是 SS 表达式。\n5. 如果 $ A $ 是 SS 表达式，则 $ \\{A\\} $ 是 SS 表达式。\n6. 如果 $ A $ 和 $ B $ 都是 SS 表达式，则 $ AB $ 也是 SS 表达式。\n\n一个 SS 表达式 $ E $ 的深度 $ D(E) $定义如下：\n\n$$\n\\scriptstyle{\nD(E) =\n\\begin{cases}\n \\scriptstyle{0}, & \\scriptstyle{\\text{如果 } E \\text{ 是空串}} \\\\\n \\scriptstyle{D(A) + 1}, &  \\scriptstyle{\\text{如果 } E = (A) \\text{ 或者 } E = [A] \\text{ 或者 } E = \\{A\\}, \\text{ 其中 } A \\text{ 是 SS 表达式}} \\\\\n \\scriptstyle{\\max(D(A), D(B))}, &  \\scriptstyle{\\text{ 如果 } E = AB, \\text{其中 } A, B \\text{ 是 SS 表达式}}\n\\end{cases}\n}\n$$\n\n例如 `(){()}[]` 的深度为 $ 2 $。\n\n密文中的复杂运算是这样进行的：\n\n设密文中每行前 $ 4 $ 个数依次为 $ L_1, L_2, L_3, D $，求出所有深度为 $ D $，含有 $ L_1 $ 对 `{}`，$ L_2 $ 对 `[]`，$ L_3 $ 对 `()` 的 SS 串的个数，并用这个数对当前的年份 $ 11380 $ 求余数，这个余数就是密文中每行的第 $ 5 $ 个数，我们称之为“神秘数”。\n\n密文中某些行的第五个数已经模糊不清，而这些数字正是揭开陨石秘密的钥匙。现在科学家们聘请你来计算这个神秘数。\n", "inputFormat": "共一行，$ 4 $ 个整数 $ L_1, L_2, L_3, D $。相邻两个数之间用一个空格分隔。", "outputFormat": "共一行，包含一个整数，即神秘数。", "hint": "$ 0 \\le L_1, L_2, L_3 \\le 10$，$0 \\le D \\le 30 $。", "locale": "zh-CN"}}}
{"pid": "P5695", "type": "P", "difficulty": 3, "samples": [["1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["数学", "2001", "NOI"], "title": "[NOI2001] 反正切函数的应用", "background": "反正切函数可展开成无穷级数，有如下公式\n\n$$ \\arctan(x) = \\sum_{n = 0}^\\infty \\frac{(-1) ^ n x ^ {2n + 1}}{2n + 1} ( 0 \\le x \\le 1 ) \\tag{1} $$\n\n使用反正切函数计算 是一种常用的方法。例如，最简单的计算 的方法：\n\n$$\n\\begin{aligned}\n\\pi & = 4 \\arctan(1) \\\\\n    & = 4(1 - \\frac{1}{3} + \\frac{1}{5} - \\frac{1}{7} + \\frac{1}{9} - \\frac{1}{11} + \\dots)\n\\end{aligned}\n\\tag{2}\n$$\n\n然而，这种方法的效率很低，但我们可以根据角度和的正切函数公式：\n\n$$ \\tan(\\alpha + \\beta) = \\frac{\\tan(\\alpha) + \\tan(\\beta)}{1 - \\tan(\\alpha) \\tan(\\beta)} \\tag{3} $$\n\n通过简单的变换得到：\n\n$$ \\arctan(p) + \\arctan(q) = \\arctan(\\frac{p + q}{1 - p q}) \\tag{4} $$\n\n利用这个公式，令 $ p = \\frac{1}{2}, q = \\frac{1}{3} $，则 $ \\frac{p + q}{1 - p q} = 1 $，有\n\n$$ \\arctan(\\frac{1}{2}) + \\arctan(\\frac{1}{3}) = \\arctan(\\frac{\\frac{1}{2} + \\frac{1}{3}}{1 - \\frac{1}{2} \\cdot \\frac{1}{3}}) = \\arctan(1) $$", "description": "我们将公式 $ 4 $ 写成如下形式\n\n$$ \\arctan(\\frac{1}{a}) = \\arctan(\\frac{1}{b}) + \\arctan(\\frac{1}{c}) $$\n\n其中 $ a, b, c \\in \\mathbb{N^+} $。\n\n我们的问题是：对于每一个给定的 $a$，求 $ b + c $ 的值。我们保证对于任意的 $ a $ 都存在整数解。如果有多个解，要求你给出 $ b + c $ 最小的解。\n", "inputFormat": "输入文件中只有一个正整数 $ a $。", "outputFormat": "输出文件中只有一个整数，为 $ b + c $ 的值。", "hint": "$1 \\le a \\le 6\\times 10^4 $。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2001] Application of the Arctangent Function", "background": "The arctangent function can be expanded into an infinite series, with the following formula:\n\n$$ \\arctan(x) = \\sum_{n = 0}^\\infty \\frac{(-1) ^ n x ^ {2n + 1}}{2n + 1} ( 0 \\le x \\le 1 ) \\tag{1} $$\n\nUsing the arctangent function to compute $\\pi$ is a common method. For example, the simplest way to compute $\\pi$ is:\n\n$$\n\\begin{aligned}\n\\pi & = 4 \\arctan(1) \\\\\n    & = 4(1 - \\frac{1}{3} + \\frac{1}{5} - \\frac{1}{7} + \\frac{1}{9} - \\frac{1}{11} + \\dots)\n\\end{aligned}\n\\tag{2}\n$$\n\nHowever, this method is very inefficient. But we can use the tangent addition formula:\n\n$$ \\tan(\\alpha + \\beta) = \\frac{\\tan(\\alpha) + \\tan(\\beta)}{1 - \\tan(\\alpha) \\tan(\\beta)} \\tag{3} $$\n\nAfter a simple transformation, we get:\n\n$$ \\arctan(p) + \\arctan(q) = \\arctan(\\frac{p + q}{1 - p q}) \\tag{4} $$\n\nUsing this formula, let $ p = \\frac{1}{2}, q = \\frac{1}{3} $. Then $ \\frac{p + q}{1 - p q} = 1 $, so we have:\n\n$$ \\arctan(\\frac{1}{2}) + \\arctan(\\frac{1}{3}) = \\arctan(\\frac{\\frac{1}{2} + \\frac{1}{3}}{1 - \\frac{1}{2} \\cdot \\frac{1}{3}}) = \\arctan(1) $$", "description": "We rewrite formula $ 4 $ in the following form:\n\n$$ \\arctan(\\frac{1}{a}) = \\arctan(\\frac{1}{b}) + \\arctan(\\frac{1}{c}) $$\n\nwhere $ a, b, c \\in \\mathbb{N^+} $.\n\nOur task is: for each given $a$, find the value of $ b + c $. We guarantee that for any $ a $ there is an integer solution. If there are multiple solutions, you must output the one with the smallest $ b + c $.", "inputFormat": "The input file contains only one positive integer $ a $.", "outputFormat": "The output file contains only one integer, which is the value of $ b + c $.", "hint": "$1 \\le a \\le 6\\times 10^4 $。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2001] 反正切函数的应用", "background": "反正切函数可展开成无穷级数，有如下公式\n\n$$ \\arctan(x) = \\sum_{n = 0}^\\infty \\frac{(-1) ^ n x ^ {2n + 1}}{2n + 1} ( 0 \\le x \\le 1 ) \\tag{1} $$\n\n使用反正切函数计算 是一种常用的方法。例如，最简单的计算 的方法：\n\n$$\n\\begin{aligned}\n\\pi & = 4 \\arctan(1) \\\\\n    & = 4(1 - \\frac{1}{3} + \\frac{1}{5} - \\frac{1}{7} + \\frac{1}{9} - \\frac{1}{11} + \\dots)\n\\end{aligned}\n\\tag{2}\n$$\n\n然而，这种方法的效率很低，但我们可以根据角度和的正切函数公式：\n\n$$ \\tan(\\alpha + \\beta) = \\frac{\\tan(\\alpha) + \\tan(\\beta)}{1 - \\tan(\\alpha) \\tan(\\beta)} \\tag{3} $$\n\n通过简单的变换得到：\n\n$$ \\arctan(p) + \\arctan(q) = \\arctan(\\frac{p + q}{1 - p q}) \\tag{4} $$\n\n利用这个公式，令 $ p = \\frac{1}{2}, q = \\frac{1}{3} $，则 $ \\frac{p + q}{1 - p q} = 1 $，有\n\n$$ \\arctan(\\frac{1}{2}) + \\arctan(\\frac{1}{3}) = \\arctan(\\frac{\\frac{1}{2} + \\frac{1}{3}}{1 - \\frac{1}{2} \\cdot \\frac{1}{3}}) = \\arctan(1) $$", "description": "我们将公式 $ 4 $ 写成如下形式\n\n$$ \\arctan(\\frac{1}{a}) = \\arctan(\\frac{1}{b}) + \\arctan(\\frac{1}{c}) $$\n\n其中 $ a, b, c \\in \\mathbb{N^+} $。\n\n我们的问题是：对于每一个给定的 $a$，求 $ b + c $ 的值。我们保证对于任意的 $ a $ 都存在整数解。如果有多个解，要求你给出 $ b + c $ 最小的解。\n", "inputFormat": "输入文件中只有一个正整数 $ a $。", "outputFormat": "输出文件中只有一个整数，为 $ b + c $ 的值。", "hint": "$1 \\le a \\le 6\\times 10^4 $。", "locale": "zh-CN"}}}
{"pid": "P5696", "type": "P", "difficulty": 5, "samples": [["4\n0 0\n0 1\n1 1\n1 0\n8\n0 0 \n3 0\n4 3\n2 2\n3 4\n4 4\n4 5\n0 5\n0\n", "Room #1:\nSurveillance is possible.\n\nRoom #2:\nSurveillance is impossible.\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [51200, 51200, 51200, 51200, 51200, 51200, 51200, 51200, 51200, 51200]}, "tags": ["计算几何", "1998", "半平面交", "CTSC/CTS"], "title": "[CTSC1998] 监视摄像机", "background": "CTSC1998 D1T2\n\n一个著名的仓库管理公司 SERKOI 请你的公司为其安装一套闭路监视系统。\n\n由于 SERKOI 财力有限,每个房间只能安装一台摄像机作监视用，不过它的镜头可以向**任意方向**旋转。", "description": "我们的问题是确定摄像机的位置，以确保房间的每一个角落都能被它监视到。\n\n例如，图一和图二是某两个房间的示意图，每个房间用一个封闭的多边形表示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/arcbvz22.png)\n\n图中的每条边表示一面墙。\n\n对于图一所示的房间，我们将摄像机安置在标黑点的位置就能满足要求；\n\n而对于图二所示的房间，无论将摄像机安置在哪里都无法使其满足要求。\n \n写一个程序，对于给定的房间示意图，判断是否有可能在这个房间中的某一位置安置**一台**摄像机，使其能监视到这个房间的**任何一个**角落。", "inputFormat": "输入文件包含一个或多个房间示意图的描述信息。\n\n每个描述信息的第一行是一一个正整数 $n$，表示该房间的示意图为一个 $n$ 边形。\n\n以下 $n$ 行每行包括用空格符隔开的两个整数 $x,y$，依次为这个 $n$ 边形的按顺时针方向排列的 $n$ 个顶点在直角坐标系中的横纵坐标。\n\n$n=0$ 表示输入文件结束。", "outputFormat": "对于每个房间，首先输出一行该房间的编号信息 `Room #k:`，$k$ 按照输入次序从 $1$ 开始计数。\n\n下一行是判断结果，如果摄像机在房间中某处安置能满足条件，输出 `Surveillance is possible.`，否则输出 `Surveillance is impossible.`\n\n每两个房间的输出结果之间用一个空行隔开。", "hint": "【数据范围】\n\n$4 \\leq n \\leq 100$，$-10000 \\leq x,y \\leq 10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC1998] Surveillance Cameras", "background": "CTSC1998 D1T2.\n\nA famous warehouse management company, SERKOI, asks your company to install a CCTV surveillance system for it.\n\nBecause SERKOI has limited funds, each room can only have one camera for surveillance, but its lens can rotate in **any direction**.", "description": "Our task is to determine the camera position so that every corner of the room can be monitored by it.\n\nFor example, Figure 1 and Figure 2 are sketches of two rooms. Each room is represented by a closed polygon.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/arcbvz22.png)\n\nEach edge in the figure represents a wall.\n\nFor the room in Figure 1, placing the camera at the black point meets the requirement.\n\nFor the room in Figure 2, no matter where the camera is placed, the requirement cannot be met.\n\nWrite a program that, given a room sketch, determines whether it is possible to place **one** camera somewhere inside the room so that it can monitor **any** corner of the room.", "inputFormat": "The input contains one or more room descriptions.\n\nThe first line of each description is a positive integer $n$, indicating that the room sketch is an $n$-gon.\n\nThe next $n$ lines each contain two integers $x, y$ separated by spaces, which are the coordinates of the $n$ vertices of the polygon in the Cartesian coordinate system, listed in clockwise order.\n\n$n = 0$ indicates the end of input.", "outputFormat": "For each room, first output one line with the room index in the format `Room #k:`, where $k$ starts from $1$ in the input order.\n\nThe next line is the result. If placing a camera somewhere in the room can satisfy the condition, output `Surveillance is possible.`; otherwise output `Surveillance is impossible.`\n\nPrint a blank line between the outputs of every two rooms.", "hint": "Constraints\n\n$4 \\leq n \\leq 100$，$-10000 \\leq x, y \\leq 10000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC1998] 监视摄像机", "background": "CTSC1998 D1T2\n\n一个著名的仓库管理公司 SERKOI 请你的公司为其安装一套闭路监视系统。\n\n由于 SERKOI 财力有限,每个房间只能安装一台摄像机作监视用，不过它的镜头可以向**任意方向**旋转。", "description": "我们的问题是确定摄像机的位置，以确保房间的每一个角落都能被它监视到。\n\n例如，图一和图二是某两个房间的示意图，每个房间用一个封闭的多边形表示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/arcbvz22.png)\n\n图中的每条边表示一面墙。\n\n对于图一所示的房间，我们将摄像机安置在标黑点的位置就能满足要求；\n\n而对于图二所示的房间，无论将摄像机安置在哪里都无法使其满足要求。\n \n写一个程序，对于给定的房间示意图，判断是否有可能在这个房间中的某一位置安置**一台**摄像机，使其能监视到这个房间的**任何一个**角落。", "inputFormat": "输入文件包含一个或多个房间示意图的描述信息。\n\n每个描述信息的第一行是一一个正整数 $n$，表示该房间的示意图为一个 $n$ 边形。\n\n以下 $n$ 行每行包括用空格符隔开的两个整数 $x,y$，依次为这个 $n$ 边形的按顺时针方向排列的 $n$ 个顶点在直角坐标系中的横纵坐标。\n\n$n=0$ 表示输入文件结束。", "outputFormat": "对于每个房间，首先输出一行该房间的编号信息 `Room #k:`，$k$ 按照输入次序从 $1$ 开始计数。\n\n下一行是判断结果，如果摄像机在房间中某处安置能满足条件，输出 `Surveillance is possible.`，否则输出 `Surveillance is impossible.`\n\n每两个房间的输出结果之间用一个空行隔开。", "hint": "【数据范围】\n\n$4 \\leq n \\leq 100$，$-10000 \\leq x,y \\leq 10000$。", "locale": "zh-CN"}}}
{"pid": "P5697", "type": "P", "difficulty": 3, "samples": [["36", "8\n6 7 8 10 11 13 18 35"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2018", "CEOI（中欧）"], "title": "[CEOI 2018] toy", "background": "", "description": "Johnny 喜欢收藏玩具。他收藏的玩具有很多不同的种类，每种玩具有很多个，而种类相同的两个玩具是无法区分的。\n\nEmma 问 Johnny 他有几个玩具。然而 Johnny 并不愿意回答这个问题。\n\n他告诉 Emma，如果他从所有玩具中选择一些不同的玩具，他可以玩 $n$ 天。换言之，这 $n$ 天中任意两天选择的玩具，存在一种玩具选择的数量不同。同时，选择的玩具集合是空集也是允许的。\n\nEmma 并不想亲自计算这个答案，因此她把这个问题交给了你。你需要告诉她 Johnny 拥有的玩具的所有可能数量。\n", "inputFormat": "输入仅包含一个整数 $n$。", "outputFormat": "第一行输出一个整数 $r$，表示共有 $r$ 种 Johnny 拥有的玩具数量。\n\n接下来一行，输出 $r$ 个递增的整数，代表 Johnny 一种可能拥有的玩具的数量。", "hint": "对于 $100\\%$ 的数据， $1\\le n\\le 10^9$。\n\n-----\n\n**题目翻译By @StudyFather。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2018] toy", "background": "", "description": "Johnny 喜欢收藏玩具。他收藏的玩具有很多不同的种类，每种玩具有很多个，而种类相同的两个玩具是无法区分的。\n\nEmma 问 Johnny 他有几个玩具。然而 Johnny 并不愿意回答这个问题。\n\n他告诉 Emma，如果他从所有玩具中选择一些不同的玩具，他可以玩 $n$ 天。换言之，这 $n$ 天中任意两天选择的玩具，存在一种玩具选择的数量不同。同时，选择的玩具集合是空集也是允许的。\n\nEmma 并不想亲自计算这个答案，因此她把这个问题交给了你。你需要告诉她 Johnny 拥有的玩具的所有可能数量。\n", "inputFormat": "输入仅包含一个整数 $n$。", "outputFormat": "第一行输出一个整数 $r$，表示共有 $r$ 种 Johnny 拥有的玩具数量。\n\n接下来一行，输出 $r$ 个递增的整数，代表 Johnny 一种可能拥有的玩具的数量。", "hint": "对于 $100\\%$ 的数据， $1\\le n\\le 10^9$。\n\n-----\n\n**题目翻译By @StudyFather。**", "locale": "zh-CN"}}}
{"pid": "P5698", "type": "P", "difficulty": 6, "samples": [["begin loop n loop 3 loop n\nop 20\nend end end\nloop n op 3 break end\nloop n loop n\nop 1\nbreak\nend end\nend\n", "60n^2+n+3"], ["begin\nop n\nloop 3\nop n\nbreak\nend\nloop n\nloop n\nop 1\ncontinue\nop n\nend\nend\nend ", "n^2+2n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "字符串", "1998", "栈", "CTSC/CTS"], "title": "[CTSC1998] 算法复杂度", "background": "CTSC1998 D1T3\n\n我们在编程时，最关心的一个问题就是算法的时间复杂度。但是分析一个程序的复杂度是一项很困难的工作，在程序的码风不是很好的情况下更是如此。\n\n所以，专门研究算法的 SERKOI 小组决定开发出一个分析程序时间复杂度的软件。由于这是一个全新的领域，所以 SERKOI 小组决定先从简单情况入手进行分析。", "description": "为了简化问题,程序只包含循环和顺序结构,程序的结构定义如下：\n\n$\\texttt{begin <statement> end}$ \n\n一个语句块的结构是**递归定义**的，如下所示：\n\n$\\texttt{loop x <statement> end}$\n\n或者 $\\texttt{op <statement>}$ \n\n或者为 $\\texttt{break <statement>}$ \n\n或者为 $\\texttt{continue <statement>}$ \n\n语句块可以为空。\n\n注意：\n\n1. 一个程序都是以 $\\texttt{begin}$ 开始，以相应的 $\\texttt{end}$ 结束；\n\n2. $\\texttt{loop x <statement> end}$ 表示其中的语句重复执行 $x$ 次；\n\n3. $\\texttt{op x}$ 表示执行 $x$ 个单位操作；\n\n4. 上面两点中的 $x$ 可以是一个正整数或 $n$；\n\n5. $\\texttt{break}$ 语句的作用是跳出这一层循环, $\\texttt{continue}$ 语句的作用是跳过这一层循\n环的其它语句，直接进入下一次循环。如果它（$\\texttt{break}$ 或 $\\texttt{continue}$）不在任何一层循环中，**请忽略它们**。\n\n你需要写一个程序，用来求出题目描述的程序的时间复杂度，并以多项式的形式输出。\n\n注意，该多项式是关于 $n$ 的多项式，而且，**常数项和系数不能省略**。\n\n数据保证能求出该程序的时间复杂度。", "inputFormat": "输入中包含一个完整的程序，\n每两条语句之间至少用一个空格或换行符隔开。\n", "outputFormat": "将计算出的时间复杂度多项式按**降幂排列**输出。", "hint": "循环的嵌套最多不超过 $20$ 层。\n\n保证最终时间复杂度多项式每项的系数不超过 ${10}^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC1998] Algorithm Complexity.", "background": "CTSC1998 D1T3.\n\nWhen we do programming, the issue we care about most is the time complexity of an algorithm. However, analyzing the complexity of a program is very difficult, and it becomes even harder when the program is not well written.\n\nSo, the SERKOI group, which specializes in studying algorithms, decided to develop software to analyze the time complexity of a program. Since this is a brand-new field, the SERKOI group decided to start with simple cases first.", "description": "To simplify the problem, the program contains only loops and sequential structures. The program structure is defined as follows:\n\n$\\texttt{begin <statement> end}$\n\nThe structure of a statement block is **recursively defined** as follows:\n\n$\\texttt{loop x <statement> end}$\n\nor $\\texttt{op <statement>}$\n\nor $\\texttt{break <statement>}$\n\nor $\\texttt{continue <statement>}$\n\nA statement block can be empty.\n\nNotes:\n\n1. A program starts with $\\texttt{begin}$ and ends with the corresponding $\\texttt{end}$.\n\n2. $\\texttt{loop x <statement> end}$ means the statements inside are executed repeatedly $x$ times.\n\n3. $\\texttt{op x}$ means performing $x$ unit operations.\n\n4. In the above two points, $x$ can be a positive integer or $n$.\n\n5. The $\\texttt{break}$ statement exits the current loop level, and the $\\texttt{continue}$ statement skips the remaining statements in the current loop level and directly enters the next iteration. If it ($\\texttt{break}$ or $\\texttt{continue}$) is not inside any loop, **please ignore them**.\n\nYou need to write a program to compute the time complexity of the program described above, and output it in polynomial form.\n\nNote that this polynomial is a polynomial in $n$, and **the constant term and coefficients cannot be omitted**.\n\nThe testdata guarantees that the time complexity of the program can be determined.", "inputFormat": "The input contains a complete program.  \nBetween every two statements, there is at least one space or newline character.", "outputFormat": "Output the computed time complexity polynomial in **descending order of degree**.", "hint": "The loop nesting depth is at most $20$ levels.\n\nIt is guaranteed that the coefficient of each term in the final time complexity polynomial does not exceed ${10}^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC1998] 算法复杂度", "background": "CTSC1998 D1T3\n\n我们在编程时，最关心的一个问题就是算法的时间复杂度。但是分析一个程序的复杂度是一项很困难的工作，在程序的码风不是很好的情况下更是如此。\n\n所以，专门研究算法的 SERKOI 小组决定开发出一个分析程序时间复杂度的软件。由于这是一个全新的领域，所以 SERKOI 小组决定先从简单情况入手进行分析。", "description": "为了简化问题,程序只包含循环和顺序结构,程序的结构定义如下：\n\n$\\texttt{begin <statement> end}$ \n\n一个语句块的结构是**递归定义**的，如下所示：\n\n$\\texttt{loop x <statement> end}$\n\n或者 $\\texttt{op <statement>}$ \n\n或者为 $\\texttt{break <statement>}$ \n\n或者为 $\\texttt{continue <statement>}$ \n\n语句块可以为空。\n\n注意：\n\n1. 一个程序都是以 $\\texttt{begin}$ 开始，以相应的 $\\texttt{end}$ 结束；\n\n2. $\\texttt{loop x <statement> end}$ 表示其中的语句重复执行 $x$ 次；\n\n3. $\\texttt{op x}$ 表示执行 $x$ 个单位操作；\n\n4. 上面两点中的 $x$ 可以是一个正整数或 $n$；\n\n5. $\\texttt{break}$ 语句的作用是跳出这一层循环, $\\texttt{continue}$ 语句的作用是跳过这一层循\n环的其它语句，直接进入下一次循环。如果它（$\\texttt{break}$ 或 $\\texttt{continue}$）不在任何一层循环中，**请忽略它们**。\n\n你需要写一个程序，用来求出题目描述的程序的时间复杂度，并以多项式的形式输出。\n\n注意，该多项式是关于 $n$ 的多项式，而且，**常数项和系数不能省略**。\n\n数据保证能求出该程序的时间复杂度。", "inputFormat": "输入中包含一个完整的程序，\n每两条语句之间至少用一个空格或换行符隔开。\n", "outputFormat": "将计算出的时间复杂度多项式按**降幂排列**输出。", "hint": "循环的嵌套最多不超过 $20$ 层。\n\n保证最终时间复杂度多项式每项的系数不超过 ${10}^9$。", "locale": "zh-CN"}}}
{"pid": "P5699", "type": "P", "difficulty": 7, "samples": [["4\n0.00 0.70 0.60 0.80\n0.30 0.00 0.60 0.40\n0.40 0.40 0.00 0.70\n0.20 0.60 0.30 0.00\n1\n2\n3", "1\n4\n2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2008", "NOI", "提交答案", "Special Judge"], "title": "[NOI2008] 赛程安排", "background": "", "description": "随着奥运的来临，同学们对体育的热情日益高涨。在 NOI2008 来临之际，学校正在策划组织一场乒乓球赛。小 Z 作为一名狂热的乒乓球爱好者，这正是他大展身手的好机会，于是他摩拳擦掌，积极报名参赛。\n\n本次乒乓球赛采取淘汰赛制，获胜者晋级。恰好有 $n$($n$ 是 $2$ 的整数次幂，不妨设 $n = 2^k$)个同学报名参加，因此第一轮后就会有 $2^{k-1}$ 个同学惨遭淘汰，另外 $2^{k-1}$ 个同学晋级下一轮；第二轮后有 $2^{k-2}$ 名同学晋级下一轮，… 依次类推，直到 $k$ 轮后决出冠亚军：具体的，每个人都有一个 $1\\sim n$ 的初始编号，其中小 Z 编号为 $1$，所有同学的编号都不同，他们将被分配到 $n$ 个位置中，然后按照类似下图的赛程进行比赛：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0n4eu0pc.png)\n\n上图：$n=8$ 时比赛的赛程表\n\n为了吸引更多的同学参加比赛，本次比赛的奖金非常丰厚。在第 $i$ 轮被淘汰的选手将得到奖金 $a_i$ 元，而冠军将获得最高奖金 $a_{k+1}$ 元。显然奖金应满足 $a_1<a_2<\\cdots<a_{k+1}$。\n\n在正式比赛前的热身赛中，小 Z 连连败北。经过认真分析之后，他发现主要的失败原因不是他的球技问题，而是赢他的这几个同学在球风上刚好对他构成相克的关系，所以一经交手，他自然败阵。小 Z 思索：如果在正式比赛中能够避开这几位同学，该有多好啊!\n\n假设已知选手两两之间交手的胜率，即选手 $A$ 战胜选手 $B$ 的概率为 $P_{A,B}$ (保证 $P_{A,B}+P_{B,A}=1$)。于是小 Z 希望能够通过确定比赛的对阵形势（重新给每个选手安排位置），从而能够使得他获得尽可能多的奖金。你能帮助小 Z 安排一个方案，使得他这场比赛期望获得的奖金最高么？", "inputFormat": "这是一道提交答案型试题，所有的输入文件 `match*.in` 已在附加文件中。\n\n输入文件 `match*.in` 第一行包含一个正整数 $n$，表示参赛的总人数，数据保证存在非负整数 $k$，满足 $2^k=n$。\n\n接下来 $n$ 行，每行有 $n$ 个 $0$ 到 $1$ 间的实数 $P_{i,j}$，表示编号为 $i$ 的选手战胜编号为 $j$ 的选手的概率，每个实数精确到小数点后两位。特别注意 $P_{i,i}=0.00$。\n\n接下来 $k+1$ 行，每行一个整数分别为晋级各轮不同的奖金，第 $i$ 行的数为 $a_i$。", "outputFormat": "输出文件 `match*.out` 包括 $n$ 行，第 $i$ 行的数表示位于第 $i$ 个位置的同学的编号，要求小 Z 的编号一定位于第 $1$ 个位置。", "hint": "#### 样例解释\n\n第一轮比赛过后，编号为 $1$ 的选手(小 Z)晋级的概率为 $80\\%$，编号为 $2$ 的选手晋级的概率为 $60\\%$，编号为 $3$ 的选手晋级的概率为 $40\\%$，编号为 $4$ 的选手晋级的概率为 $20\\%$。\n\n第二轮（决赛），编号为 $1$ 的选手（小 Z）前两轮均获胜的概率为 $80\\%\\times (60\\%\\times 70\\%+40\\%\\times 60\\%)=52.8\\%$，因此，小 Z 在第一轮失败的概率 $P_1=1-0.8=0.2$，第一轮胜出但第二轮败北的概率 $P_2=0.8-0.528=0.272$，获得冠军的概率 $P_3=0.528$。\n\n从而，期望奖金为 $0.2\\times 1+(0.8-0.528)\\times 2+0.528\\times 3=2.328$。\n\n#### 如何测试你的输出\n\n我们提供 `checker` 来测试你的输出文件是否可接受。\n\n调用这个程序后，`checker` 将根据你得到的输出文件给出测试的结果，其中包括：\n- 非法退出：未知错误；\n- `Format error`：输出文件格式错误；\n- `Not a permutation`：输出文件不是一个 $1\\sim n$ 的排列；\n- `OK.Your answer is xxx`：输出文件可以被接受，`xxx`为对应的期望奖金。\n\n#### 评分方法\n\n每个测试点单独评分。\n\n对于每一个测试点，如果你的输出文件不合法，如文件格式错误、输出解不符合要求等，该测试点得 $0$ 分。否则如果你的输出的期望奖金为 $\\text{your\\_ans}$，参考期望奖金为 $\\text{our\\_ans}$，我们还设有一个用于评分的参数 $d$，你在该测试点中的得分如下：\n\n- 如果 $\\text{your\\_ans}>\\text{our\\_ans}$，得 $12$ 分。\n- 如果 $\\text{your\\_ans}<\\text{our\\_ans}\\times d$，得 $1$ 分。\n- 否则得分为：\n  $$\n  \\left\\lfloor\\frac{\\text{your\\_ans}-\\text{our\\_ans}\\times d}{\\text{our\\_ans}-\\text{our\\_ans}\\times d}\\times 8\\right\\rfloor+2\n  $$\n\n#### 特别提示\n\n请妥善保存输入文件 `*.in` 和你的输出 `*.out`，及时备份，以免误删。\n\n#### 附加文件\n\nchecker 需要自行编译后使用。\n\n请前往 [Github](https://github.com/MikeMirzayanov/testlib) 下载 testlib.h 的最新源代码。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2008] Tournament Schedule", "background": "", "description": "With the Olympics approaching, students are becoming more and more enthusiastic about sports. As NOI2008 is coming, the school is planning to hold a table tennis tournament. Student Z, a hardcore table tennis fan, sees this as a great chance to show his skills, so he eagerly signs up.\n\nThis table tennis tournament uses a single-elimination format: winners advance. There are exactly $n$ students signed up ($n$ is an integer power of $2$, so we may assume $n = 2^k$). Therefore, after the first round, $2^{k-1}$ students will be eliminated and the other $2^{k-1}$ students will advance to the next round; after the second round, $2^{k-2}$ students advance to the next round, and so on, until after $k$ rounds the champion and runner-up are decided. Specifically, everyone has an initial ID from $1\\sim n$. Student Z has ID $1$. All students have distinct IDs. They will be assigned to $n$ positions, and then play according to a bracket like the one below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0n4eu0pc.png)\n\nThe figure above shows the bracket when $n=8$.\n\nTo attract more students to participate, the prizes are very generous. A player eliminated in round $i$ will receive $a_i$ yuan, and the champion will receive the highest prize $a_{k+1}$ yuan. Clearly, the prizes satisfy $a_1<a_2<\\cdots<a_{k+1}$.\n\nIn the warm-up matches before the official tournament, Student Z keeps losing. After careful analysis, he realizes the main reason is not his technique, but that the few students who beat him have playing styles that counter his. Once they face each other, he naturally loses. Student Z thinks: if only he could avoid these players in the official tournament!\n\nAssume we know the win probabilities between every pair of players: the probability that player $A$ defeats player $B$ is $P_{A,B}$ (guaranteed that $P_{A,B}+P_{B,A}=1$). Student Z hopes to determine the matchups (reassign positions for all players) so that he can obtain as much prize money as possible in expectation. Can you help Student Z find an arrangement that maximizes his expected prize?", "inputFormat": "This is an output-only problem. All input files `match*.in` are provided in the additional files.\n\nThe first line of `match*.in` contains a positive integer $n$, the total number of participants. The data guarantees that there exists a non-negative integer $k$ such that $2^k=n$.\n\nNext come $n$ lines, each containing $n$ real numbers between $0$ and $1$, $P_{i,j}$, meaning the probability that player with ID $i$ defeats player with ID $j$. Each real number is given to two digits after the decimal point. Note in particular that $P_{i,i}=0.00$.\n\nNext come $k+1$ lines, each containing one integer, giving the prizes for different rounds of advancement. The value on line $i$ is $a_i$.", "outputFormat": "The output file `match*.out` contains $n$ lines. The number on line $i$ is the ID of the student placed at position $i$. Student Z’s ID must be placed at position $1$.", "hint": "#### Sample Explanation\n\nAfter the first round, the probability that the player with ID $1$ (Student Z) advances is $80\\%$, the probability that the player with ID $2$ advances is $60\\%$, the probability that the player with ID $3$ advances is $40\\%$, and the probability that the player with ID $4$ advances is $20\\%$.\n\nIn the second round (the final), the probability that player $1$ (Student Z) wins both rounds is $80\\%\\times (60\\%\\times 70\\%+40\\%\\times 60\\%)=52.8\\%$. Therefore, the probability that Student Z loses in the first round is $P_1=1-0.8=0.2$, the probability that he wins the first round but loses in the second round is $P_2=0.8-0.528=0.272$, and the probability that he becomes the champion is $P_3=0.528$.\n\nThus, the expected prize is $0.2\\times 1+(0.8-0.528)\\times 2+0.528\\times 3=2.328$.\n\n#### How to Test Your Output\n\nWe provide `checker` to test whether your output file is acceptable.\n\nAfter calling this program, `checker` will give the result based on your output file, including:\n- Abnormal termination: unknown error.\n- `Format error`: output file format error.\n- `Not a permutation`: the output file is not a permutation of $1\\sim n$.\n- `OK.Your answer is xxx`: the output file is accepted, and `xxx` is the corresponding expected prize.\n\n#### Scoring Method\n\nEach test point is scored independently.\n\nFor each test point, if your output file is invalid (such as wrong format, or the output does not meet the requirements), you get $0$ points for that test point. Otherwise, let your expected prize be $\\text{your\\_ans}$, and the reference expected prize be $\\text{our\\_ans}$. We also have a scoring parameter $d$. Your score for that test point is as follows:\n\n- If $\\text{your\\_ans}>\\text{our\\_ans}$, you get $12$ points.\n- If $\\text{your\\_ans}<\\text{our\\_ans}\\times d$, you get $1$ point.\n- Otherwise, the score is:\n  $$\n  \\left\\lfloor\\frac{\\text{your\\_ans}-\\text{our\\_ans}\\times d}{\\text{our\\_ans}-\\text{our\\_ans}\\times d}\\times 8\\right\\rfloor+2\n  $$\n\n#### Special Note\n\nPlease keep the input files `*.in` and your outputs `*.out` properly, and back them up in time to avoid accidental deletion.\n\n#### Additional Files\n\nYou need to compile and use `checker` by yourself.\n\nPlease go to [Github](https://github.com/MikeMirzayanov/testlib) to download the latest source code of `testlib.h`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2008] 赛程安排", "background": "", "description": "随着奥运的来临，同学们对体育的热情日益高涨。在 NOI2008 来临之际，学校正在策划组织一场乒乓球赛。小 Z 作为一名狂热的乒乓球爱好者，这正是他大展身手的好机会，于是他摩拳擦掌，积极报名参赛。\n\n本次乒乓球赛采取淘汰赛制，获胜者晋级。恰好有 $n$($n$ 是 $2$ 的整数次幂，不妨设 $n = 2^k$)个同学报名参加，因此第一轮后就会有 $2^{k-1}$ 个同学惨遭淘汰，另外 $2^{k-1}$ 个同学晋级下一轮；第二轮后有 $2^{k-2}$ 名同学晋级下一轮，… 依次类推，直到 $k$ 轮后决出冠亚军：具体的，每个人都有一个 $1\\sim n$ 的初始编号，其中小 Z 编号为 $1$，所有同学的编号都不同，他们将被分配到 $n$ 个位置中，然后按照类似下图的赛程进行比赛：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0n4eu0pc.png)\n\n上图：$n=8$ 时比赛的赛程表\n\n为了吸引更多的同学参加比赛，本次比赛的奖金非常丰厚。在第 $i$ 轮被淘汰的选手将得到奖金 $a_i$ 元，而冠军将获得最高奖金 $a_{k+1}$ 元。显然奖金应满足 $a_1<a_2<\\cdots<a_{k+1}$。\n\n在正式比赛前的热身赛中，小 Z 连连败北。经过认真分析之后，他发现主要的失败原因不是他的球技问题，而是赢他的这几个同学在球风上刚好对他构成相克的关系，所以一经交手，他自然败阵。小 Z 思索：如果在正式比赛中能够避开这几位同学，该有多好啊!\n\n假设已知选手两两之间交手的胜率，即选手 $A$ 战胜选手 $B$ 的概率为 $P_{A,B}$ (保证 $P_{A,B}+P_{B,A}=1$)。于是小 Z 希望能够通过确定比赛的对阵形势（重新给每个选手安排位置），从而能够使得他获得尽可能多的奖金。你能帮助小 Z 安排一个方案，使得他这场比赛期望获得的奖金最高么？", "inputFormat": "这是一道提交答案型试题，所有的输入文件 `match*.in` 已在附加文件中。\n\n输入文件 `match*.in` 第一行包含一个正整数 $n$，表示参赛的总人数，数据保证存在非负整数 $k$，满足 $2^k=n$。\n\n接下来 $n$ 行，每行有 $n$ 个 $0$ 到 $1$ 间的实数 $P_{i,j}$，表示编号为 $i$ 的选手战胜编号为 $j$ 的选手的概率，每个实数精确到小数点后两位。特别注意 $P_{i,i}=0.00$。\n\n接下来 $k+1$ 行，每行一个整数分别为晋级各轮不同的奖金，第 $i$ 行的数为 $a_i$。", "outputFormat": "输出文件 `match*.out` 包括 $n$ 行，第 $i$ 行的数表示位于第 $i$ 个位置的同学的编号，要求小 Z 的编号一定位于第 $1$ 个位置。", "hint": "#### 样例解释\n\n第一轮比赛过后，编号为 $1$ 的选手(小 Z)晋级的概率为 $80\\%$，编号为 $2$ 的选手晋级的概率为 $60\\%$，编号为 $3$ 的选手晋级的概率为 $40\\%$，编号为 $4$ 的选手晋级的概率为 $20\\%$。\n\n第二轮（决赛），编号为 $1$ 的选手（小 Z）前两轮均获胜的概率为 $80\\%\\times (60\\%\\times 70\\%+40\\%\\times 60\\%)=52.8\\%$，因此，小 Z 在第一轮失败的概率 $P_1=1-0.8=0.2$，第一轮胜出但第二轮败北的概率 $P_2=0.8-0.528=0.272$，获得冠军的概率 $P_3=0.528$。\n\n从而，期望奖金为 $0.2\\times 1+(0.8-0.528)\\times 2+0.528\\times 3=2.328$。\n\n#### 如何测试你的输出\n\n我们提供 `checker` 来测试你的输出文件是否可接受。\n\n调用这个程序后，`checker` 将根据你得到的输出文件给出测试的结果，其中包括：\n- 非法退出：未知错误；\n- `Format error`：输出文件格式错误；\n- `Not a permutation`：输出文件不是一个 $1\\sim n$ 的排列；\n- `OK.Your answer is xxx`：输出文件可以被接受，`xxx`为对应的期望奖金。\n\n#### 评分方法\n\n每个测试点单独评分。\n\n对于每一个测试点，如果你的输出文件不合法，如文件格式错误、输出解不符合要求等，该测试点得 $0$ 分。否则如果你的输出的期望奖金为 $\\text{your\\_ans}$，参考期望奖金为 $\\text{our\\_ans}$，我们还设有一个用于评分的参数 $d$，你在该测试点中的得分如下：\n\n- 如果 $\\text{your\\_ans}>\\text{our\\_ans}$，得 $12$ 分。\n- 如果 $\\text{your\\_ans}<\\text{our\\_ans}\\times d$，得 $1$ 分。\n- 否则得分为：\n  $$\n  \\left\\lfloor\\frac{\\text{your\\_ans}-\\text{our\\_ans}\\times d}{\\text{our\\_ans}-\\text{our\\_ans}\\times d}\\times 8\\right\\rfloor+2\n  $$\n\n#### 特别提示\n\n请妥善保存输入文件 `*.in` 和你的输出 `*.out`，及时备份，以免误删。\n\n#### 附加文件\n\nchecker 需要自行编译后使用。\n\n请前往 [Github](https://github.com/MikeMirzayanov/testlib) 下载 testlib.h 的最新源代码。", "locale": "zh-CN"}}}
{"pid": "P5700", "type": "P", "difficulty": 5, "samples": [["2 \n10 10\n1 1 1 1 1 1 1 1 1 1 \n1 1 1 1 1 1 1 1 1 1\n1 1 1 9 8 7 6 5 4 1\n1 1 9 8 7 6 5 4 1 1\n1 1 8 7 6 5 4 1 1 1\n1 1 7 6 5 4 1 1 1 1\n1 1 6 5 4 1 1 1 1 1\n1 1 5 4 1 1 1 1 1 1\n1 1 4 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1 1 1\n3 3 0 0 0 0 0 0\n8 8 0 0 0 0 0 0", "44\n0 3 3 6 5 3 1 2 4\n3 3 2 3 1 5 6 2 4\n5 4 2 2 4 5 6 1 3\n6 5 2 1 3 5 6 4 2\n10 6 2 4 2 5 6 3 1\n13 7 2 3 1 5 6 2 4\n15 8 2 2 4 5 6 1 3\n16 9 2 1 3 5 6 4 2\n20 10 2 4 2 5 6 3 1\n26 10 3 6 5 4 2 3 1\n28 10 4 2 4 6 5 3 1\n29 9 4 1 3 6 5 2 4\n34 9 5 5 6 1 3 2 4\n38 8 5 4 2 1 3 5 6\n41 8 6 3 1 4 2 5 6\n43 8 7 2 4 3 1 5 6\n44 8 8 1 3 2 4 5 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "图论", "1998", "Special Judge", "枚举", "最短路", "CTSC/CTS"], "title": "[CTSC1998] 罗杰游戏", "background": "CTSC1998 D2T1\n", "description": "罗杰游戏由一张棋盘和罗杰构成。棋盘由很多个小格组成，每个小格上刻有一个数字。其为 $-1$ 或 $0$ 至 $255$ 之间的一个数。罗杰是一个立方体，有六个面，每个面上分别有一个 $1$ 至 $6$ 之间的数字。\n\n我们开始时把罗杰放在棋盘中的一个小格上，然后让其向前、后、左、右四个方向**翻滚**至邻近小格中。\n\n游戏要求经过若干次翻滚后，让罗杰到达指定小格。\n\n**罗杰不得进入标有 $-1$ 的小格，否则游戏结束**。\n\n罗杰每进入一个小格后，将其顶面的数字同该小格的数字相乘，所得结果累加即得到罗杰的旅行费用。\n\n开始时我们能看到罗杰的某些面上的数字，也可以指定当罗杰最终到达目的格时某些面上应出现的数字。对于**不确定的数字**，我们可以在**合法的基础上任意指定**。\n\n**任务一**\n\n罗杰只能向前或向右翻滚。\n\n**任务二**\n\n罗杰可以自由活动。", "inputFormat": "输入文件的第一行是数字 $1$ 或 $2$ 。表示是任务一还是任务二。\n\n文件的第二行是两个整数 $M$ 和 $N$ ，给出了棋盘的列数和行数。\n\n接下来的 $N$ 行每行表示棋盘的一行，有 $M$ 个数，依次给出了该行上每列的数。\n\n其后的两行分别给出了罗杰的出发点信息和到达点信息。\n\n每行开始的两个正整数给出了该格子的列号和行号。\n\n接下来的六个数字分别表示了罗杰的顶，底，前、后、左、右各面的数字。 $0$ 表示可以任意指定。\n\n", "outputFormat": "输出文件的第一行给出罗杰的最小旅行费用。\n\n如果罗杰不可能按要求到达目的地，则输出 $-1$ 。\n\n否则其后每行给出罗杰的旅行情况：\n\n从出发格到目的格，每行表示了罗杰的一个位置，\n\n依次给出罗杰的当前旅行费用、所在格的列编号、行编号，以及罗杰6个面上的数字。\n\n注意这时你的程序必须给出罗杰的完整信息，即各面上的数字不能为 $0$。", "hint": "【数据范围】\n\n$M \\le 40$ , $N \\le 40$  。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC1998] Roger Game", "background": "CTSC1998 D2T1.", "description": "The Roger Game consists of a board and Roger. The board is made up of many small cells, and each cell has a number engraved on it. This number is either $-1$ or an integer between $0$ and $255$. Roger is a cube with six faces, and each face has a number from $1$ to $6$.\n\nAt the beginning, we place Roger on a cell on the board, and then let it **roll** forward, backward, left, or right into an adjacent cell.\n\nThe game requires that after several rolls, Roger reaches a specified target cell.\n\n**Roger must not enter a cell marked $-1$, otherwise the game ends.**\n\nEach time Roger enters a cell, multiply the number on its top face by the number in that cell, and add the result to the total. This total is Roger's travel cost.\n\nAt the start, we can see the numbers on some faces of Roger. We may also specify that when Roger finally reaches the target cell, some faces should show certain numbers. For **unspecified numbers**, we may **assign them arbitrarily as long as it is valid**.\n\n**Task 1**\n\nRoger can only roll forward or to the right.\n\n**Task 2**\n\nRoger can move freely.", "inputFormat": "The first line of the input file is the number $1$ or $2$, indicating Task 1 or Task 2.\n\nThe second line contains two integers $M$ and $N$, giving the number of columns and the number of rows of the board.\n\nThe next $N$ lines each describe one row of the board, containing $M$ numbers, giving the numbers of the cells in that row from left to right.\n\nThe following two lines give the information for Roger's start cell and target cell, respectively.\n\nEach line begins with two positive integers giving the column index and row index of that cell.\n\nThe next six numbers represent the numbers on Roger's top, bottom, front, back, left, and right faces. A $0$ means it can be assigned arbitrarily.", "outputFormat": "The first line of the output file should give Roger's minimum travel cost.\n\nIf it is impossible for Roger to reach the target as required, output $-1$.\n\nOtherwise, output the travel process, one line per position from the start cell to the target cell.\n\nEach line should contain, in order: the current total travel cost, the column index, the row index, and the numbers on Roger's 6 faces.\n\nNote that your program must output Roger's complete information at this time, i.e. none of the face numbers may be $0$.", "hint": "【Constraints】\n\n$M \\le 40$ , $N \\le 40$ 。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC1998] 罗杰游戏", "background": "CTSC1998 D2T1\n", "description": "罗杰游戏由一张棋盘和罗杰构成。棋盘由很多个小格组成，每个小格上刻有一个数字。其为 $-1$ 或 $0$ 至 $255$ 之间的一个数。罗杰是一个立方体，有六个面，每个面上分别有一个 $1$ 至 $6$ 之间的数字。\n\n我们开始时把罗杰放在棋盘中的一个小格上，然后让其向前、后、左、右四个方向**翻滚**至邻近小格中。\n\n游戏要求经过若干次翻滚后，让罗杰到达指定小格。\n\n**罗杰不得进入标有 $-1$ 的小格，否则游戏结束**。\n\n罗杰每进入一个小格后，将其顶面的数字同该小格的数字相乘，所得结果累加即得到罗杰的旅行费用。\n\n开始时我们能看到罗杰的某些面上的数字，也可以指定当罗杰最终到达目的格时某些面上应出现的数字。对于**不确定的数字**，我们可以在**合法的基础上任意指定**。\n\n**任务一**\n\n罗杰只能向前或向右翻滚。\n\n**任务二**\n\n罗杰可以自由活动。", "inputFormat": "输入文件的第一行是数字 $1$ 或 $2$ 。表示是任务一还是任务二。\n\n文件的第二行是两个整数 $M$ 和 $N$ ，给出了棋盘的列数和行数。\n\n接下来的 $N$ 行每行表示棋盘的一行，有 $M$ 个数，依次给出了该行上每列的数。\n\n其后的两行分别给出了罗杰的出发点信息和到达点信息。\n\n每行开始的两个正整数给出了该格子的列号和行号。\n\n接下来的六个数字分别表示了罗杰的顶，底，前、后、左、右各面的数字。 $0$ 表示可以任意指定。\n\n", "outputFormat": "输出文件的第一行给出罗杰的最小旅行费用。\n\n如果罗杰不可能按要求到达目的地，则输出 $-1$ 。\n\n否则其后每行给出罗杰的旅行情况：\n\n从出发格到目的格，每行表示了罗杰的一个位置，\n\n依次给出罗杰的当前旅行费用、所在格的列编号、行编号，以及罗杰6个面上的数字。\n\n注意这时你的程序必须给出罗杰的完整信息，即各面上的数字不能为 $0$。", "hint": "【数据范围】\n\n$M \\le 40$ , $N \\le 40$  。", "locale": "zh-CN"}}}
{"pid": "P5701", "type": "P", "difficulty": 5, "samples": [["2 \n3\n2 3 4", "0\n8\n2 7\n3 6\n4 8\n5 1\n6 5\n7 4\n8 3\n9 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["1998", "CTSC/CTS"], "title": "[CTSC1998] 站牌位置", "background": "CTSC1998 D2T2\n", "description": "某城市市区规划成网格状，市区由 $n+1$ 条南北走向和 $n+1$ 条东西走向的干道将其平均分为 $n^2$ 个区域， $(n+1)^2$ 个叉路口。区域及叉路口均**由上至下，由左至右**编号。\n\n现在要在城市中划分出若干区域作为游览胜地，每一个游览胜地将会有且仅有一路公共汽车围绕它的四周运行，这路公共汽车将仅在该区域四周的四个叉路口设立四个公共汽车车站。相邻的两个区域（两个区域相邻当且仅当它们有一段公共的公路）将会共用两个公共汽车车站。\n\n政府为每一个公共汽车车站设立一个站牌，站牌号用自然数 $1$ , $2$ ...表示且互不相同，可没想到站牌号的设置令政府大伤脑筋。原来，该城市有三个公交公司，他们有各自的规定，即：\n\n1. 甲公司的一路公共汽车绕某一个区域运行的四个站，应该满足下面条件：从某一个站出发，**顺时针方向**经过的三个站牌牌号**单调递减**，最后回到原来的那个站。\n\n2. 乙公司的一路公共汽车绕某一个区域运行的四个站，应该满足下面条件：从某一个站出发，**逆时针方向**经过的三个站牌牌号**单调递减**，最后回到原来的那个站。\n\n3. 丙公司的一路公共汽车绕某个区域运行的四个站，应该满足下面条件：从某一个站出发，顺时针方向经过的三个站应是站牌号依次**先减少，再增加，再减少，最后再增加**，然后回到原来的那个站。\n\n为公平起见，政府希望找出一个安排站牌的方法，对这 $n$ 个区域所涉及的所有的 $K$ 个站分配站牌。使三个公司能在游览胜地中开辟尽量一样多的公共汽车路线。请你编程解决上述问题。\n\n设三个公司可开辟的公共汽车路线数分别为 $X$ , $Y$ , $Z$ ,\n\n**你应使$S=(X-Y)^2+(Y-Z)^2+(Z-X)^2$最小**。", "inputFormat": "输入文件的第一行为 $n$，第二行为 $m$，表示有 $m$ 个区域为游览胜地，第三行的 $m$ 个数分别为这 $m$ 个区域的编号，相邻的两数之间用一个空格隔开。", "outputFormat": "输出文件的第一行为你所找到的 $S$ 值，第二行为 $K$ ，以下的 $K$ 行每行各有两个数，第一个数为叉路口号，第二个数为你安排该叉路口的公共汽车站牌号（站牌号应为由 $1$ 到 $K$ 的自然数，且各不相同），这 $K$ 行应按叉路口号从小到大输出。", "hint": "【数据范围】\n\n$1 \\leq n \\leq 7$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC1998] Bus Stop Sign Positions.", "background": "CTSC1998 D2T2.", "description": "A certain city downtown is planned as a grid. The downtown area is evenly divided by $n+1$ north-south main roads and $n+1$ east-west main roads into $n^2$ blocks and $(n+1)^2$ intersections. Both blocks and intersections are numbered **from top to bottom, and from left to right**.\n\nNow, several blocks are chosen as sightseeing areas. For each sightseeing area, there will be exactly one bus route that runs around its four sides, and this bus will set up four bus stops only at the four intersections surrounding that block. Two adjacent blocks (two blocks are adjacent if and only if they share a segment of road) will share two bus stops.\n\nThe government sets up a stop sign for each bus stop. Stop sign numbers are distinct natural numbers $1, 2, \\ldots$. However, assigning these numbers becomes a headache. This is because there are three bus companies in the city, each with its own rule:\n\n1. For Company A, the four stops around a block must satisfy: starting from some stop, the three stop sign numbers encountered **clockwise** are **strictly decreasing**, and then it returns to the original stop.\n\n2. For Company B, the four stops around a block must satisfy: starting from some stop, the three stop sign numbers encountered **counterclockwise** are **strictly decreasing**, and then it returns to the original stop.\n\n3. For Company C, the four stops around a block must satisfy: starting from some stop, going clockwise, the stop sign numbers should **decrease, then increase, then decrease, then increase**, and then it returns to the original stop.\n\nTo be fair, the government wants to find a way to assign stop sign numbers to all $K$ bus stops involved in these $m$ sightseeing blocks, so that the three companies can open as close as possible to the same number of bus routes among the sightseeing areas. Please write a program to solve this problem.\n\nLet the numbers of bus routes that the three companies can open be $X$, $Y$, and $Z$, respectively.\n\nYou should make $S=(X-Y)^2+(Y-Z)^2+(Z-X)^2$ as small as possible.", "inputFormat": "The first line contains $n$.  \nThe second line contains $m$, meaning there are $m$ blocks that are sightseeing areas.  \nThe third line contains $m$ integers, which are the indices of these $m$ blocks, separated by one space.", "outputFormat": "The first line contains the value of $S$ you found.  \nThe second line contains $K$.  \nIn the next $K$ lines, each line contains two integers: the first is an intersection index, and the second is the stop sign number you assign to the bus stop at this intersection (the stop sign numbers should be distinct natural numbers from $1$ to $K$). These $K$ lines should be output in increasing order of the intersection index.", "hint": "Constraints\n\n$1 \\leq n \\leq 7$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC1998] 站牌位置", "background": "CTSC1998 D2T2\n", "description": "某城市市区规划成网格状，市区由 $n+1$ 条南北走向和 $n+1$ 条东西走向的干道将其平均分为 $n^2$ 个区域， $(n+1)^2$ 个叉路口。区域及叉路口均**由上至下，由左至右**编号。\n\n现在要在城市中划分出若干区域作为游览胜地，每一个游览胜地将会有且仅有一路公共汽车围绕它的四周运行，这路公共汽车将仅在该区域四周的四个叉路口设立四个公共汽车车站。相邻的两个区域（两个区域相邻当且仅当它们有一段公共的公路）将会共用两个公共汽车车站。\n\n政府为每一个公共汽车车站设立一个站牌，站牌号用自然数 $1$ , $2$ ...表示且互不相同，可没想到站牌号的设置令政府大伤脑筋。原来，该城市有三个公交公司，他们有各自的规定，即：\n\n1. 甲公司的一路公共汽车绕某一个区域运行的四个站，应该满足下面条件：从某一个站出发，**顺时针方向**经过的三个站牌牌号**单调递减**，最后回到原来的那个站。\n\n2. 乙公司的一路公共汽车绕某一个区域运行的四个站，应该满足下面条件：从某一个站出发，**逆时针方向**经过的三个站牌牌号**单调递减**，最后回到原来的那个站。\n\n3. 丙公司的一路公共汽车绕某个区域运行的四个站，应该满足下面条件：从某一个站出发，顺时针方向经过的三个站应是站牌号依次**先减少，再增加，再减少，最后再增加**，然后回到原来的那个站。\n\n为公平起见，政府希望找出一个安排站牌的方法，对这 $n$ 个区域所涉及的所有的 $K$ 个站分配站牌。使三个公司能在游览胜地中开辟尽量一样多的公共汽车路线。请你编程解决上述问题。\n\n设三个公司可开辟的公共汽车路线数分别为 $X$ , $Y$ , $Z$ ,\n\n**你应使$S=(X-Y)^2+(Y-Z)^2+(Z-X)^2$最小**。", "inputFormat": "输入文件的第一行为 $n$，第二行为 $m$，表示有 $m$ 个区域为游览胜地，第三行的 $m$ 个数分别为这 $m$ 个区域的编号，相邻的两数之间用一个空格隔开。", "outputFormat": "输出文件的第一行为你所找到的 $S$ 值，第二行为 $K$ ，以下的 $K$ 行每行各有两个数，第一个数为叉路口号，第二个数为你安排该叉路口的公共汽车站牌号（站牌号应为由 $1$ 到 $K$ 的自然数，且各不相同），这 $K$ 行应按叉路口号从小到大输出。", "hint": "【数据范围】\n\n$1 \\leq n \\leq 7$", "locale": "zh-CN"}}}
{"pid": "P5702", "type": "P", "difficulty": 7, "samples": [["5\n998007 998244353 3\n19260817 998244353 3\n274829164 998244353 3\n792846153 998244353 3\n1924762 899678209 7", "429767635\n632288905\n445668022\n128133635\n3097708"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "倍增", "O2优化", "快速傅里叶变换 FFT"], "title": "调和级数求和", "background": "", "description": "给定 $n,p$，求：\n\n$$\\sum_{i=1}^n \\frac 1i $$\n\n对 $p$ 取模的值。\n\n如果你不知道怎么对分数取模，可以看[这题](https://www.luogu.com.cn/problem/P2613)。  \n保证答案在模 $p$ 意义下存在。\n\n为了方便你的计算，这里将给出 $p$ 的最小原根 $g$。", "inputFormat": "输入第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$ 行，每行三个正整数 $n,p,g$。", "outputFormat": "输出 $T$ 行，每行一个整数表示答案。", "hint": "【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$；  \n对于 $100\\%$ 的数据，$1 \\le n < p < 2^{30}$，$1\\le T \\le 20$。  \n保证 $p$ 为质数，且 $p-1$ 可以被 $2^{19}$ 整除。\n\n注：时限为 std 的三倍，如果过不去请确认时间复杂度正确，并优化常数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "调和级数求和", "background": "", "description": "给定 $n,p$，求：\n\n$$\\sum_{i=1}^n \\frac 1i $$\n\n对 $p$ 取模的值。\n\n如果你不知道怎么对分数取模，可以看[这题](https://www.luogu.com.cn/problem/P2613)。  \n保证答案在模 $p$ 意义下存在。\n\n为了方便你的计算，这里将给出 $p$ 的最小原根 $g$。", "inputFormat": "输入第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$ 行，每行三个正整数 $n,p,g$。", "outputFormat": "输出 $T$ 行，每行一个整数表示答案。", "hint": "【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$；  \n对于 $100\\%$ 的数据，$1 \\le n < p < 2^{30}$，$1\\le T \\le 20$。  \n保证 $p$ 为质数，且 $p-1$ 可以被 $2^{19}$ 整除。\n\n注：时限为 std 的三倍，如果过不去请确认时间复杂度正确，并优化常数。", "locale": "zh-CN"}}}
{"pid": "P5703", "type": "P", "difficulty": 1, "samples": [["5 3\n", "15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["顺序结构"], "title": "【深基2.例5】苹果采购", "background": "", "description": "现在需要采购一些苹果，每名同学都可以分到固定数量的苹果，并且已经知道了同学的数量，请问需要采购多少个苹果？", "inputFormat": "输入两个不超过 $10^9$ 正整数，分别表示每人分到的数量和同学的人数。", "outputFormat": "一个整数，表示答案。保证输入和答案都在 int 范围内的非负整数。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 2.Example 5] Apple Purchase", "background": "", "description": "Now you need to purchase some apples. Each student can receive a fixed number of apples, and the number of students is already known. How many apples do you need to purchase?", "inputFormat": "Input two positive integers not exceeding $10^9$, representing the number each person receives and the number of students.", "outputFormat": "Output one integer, representing the answer. It is guaranteed that both the input and the answer are non-negative integers within the int range.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基2.例5】苹果采购", "background": "", "description": "现在需要采购一些苹果，每名同学都可以分到固定数量的苹果，并且已经知道了同学的数量，请问需要采购多少个苹果？", "inputFormat": "输入两个不超过 $10^9$ 正整数，分别表示每人分到的数量和同学的人数。", "outputFormat": "一个整数，表示答案。保证输入和答案都在 int 范围内的非负整数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5704", "type": "P", "difficulty": 1, "samples": [["q", "Q"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["顺序结构"], "title": "【深基2.例6】字母转换", "background": "", "description": "输入一个小写字母，输出其对应的大写字母。例如输入 q[回车] 时，会输出 Q。", "inputFormat": "", "outputFormat": "", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basic 2.Example 6] Letter Conversion", "background": "", "description": "Input a lowercase letter and output its corresponding uppercase letter. For example, if the input is q [Enter], the output will be Q.", "inputFormat": "", "outputFormat": "", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基2.例6】字母转换", "background": "", "description": "输入一个小写字母，输出其对应的大写字母。例如输入 q[回车] 时，会输出 Q。", "inputFormat": "", "outputFormat": "", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5705", "type": "P", "difficulty": 1, "samples": [["123.4", "4.321"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["顺序结构"], "title": "【深基2.例7】数字反转", "background": "", "description": "输入一个不小于 $100$ 且小于 $1000$，同时包括小数点后一位的一个浮点数，例如 $123.4$ ，要求把这个数字翻转过来，变成 $4.321$ 并输出。", "inputFormat": "一行一个浮点数", "outputFormat": "一行一个浮点数", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics 2.Example 7] Number Reversal", "background": "", "description": "Input a floating-point number that is not less than $100$ and less than $1000$, and has exactly one digit after the decimal point, such as $123.4$. Reverse this number to get $4.321$ and output it.", "inputFormat": "One line with one floating-point number.", "outputFormat": "One line with one floating-point number.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基2.例7】数字反转", "background": "", "description": "输入一个不小于 $100$ 且小于 $1000$，同时包括小数点后一位的一个浮点数，例如 $123.4$ ，要求把这个数字翻转过来，变成 $4.321$ 并输出。", "inputFormat": "一行一个浮点数", "outputFormat": "一行一个浮点数", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5706", "type": "P", "difficulty": 1, "samples": [["500.0 3", "166.667\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["顺序结构"], "title": "【深基2.例8】再分肥宅水", "background": "", "description": "现在有 $t$ 毫升肥宅快乐水，要均分给 $n$ 名同学。每名同学需要 $2$ 个杯子。现在想知道每名同学可以获得多少毫升饮料（严格精确到小数点后 $3$ 位），以及一共需要多少个杯子。\n\n", "inputFormat": "输入一个实数 $t$ 和一个正整数 $n$，使用空格隔开。", "outputFormat": "输出两行。\n\n第一行输出一个三位小数，表示可以获得多少毫升饮料。第二行输出一个正整数，表示一共需要多少个杯子。", "hint": "对于所有数据，$0\\leq t\\leq 10000$ 且小数点后不超过 $3$ 位，$1\\leq n\\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 2.Example 8] Re-divide Soda", "background": "", "description": "Now there are $t$ milliliters of soda, which will be divided equally among $n$ students. Each student needs $2$ cups. Now you want to know how many milliliters of drink each student can get (accurate strictly to $3$ digits after the decimal point), and how many cups are needed in total.", "inputFormat": "Input a real number $t$ and a positive integer $n$, separated by a space.", "outputFormat": "Output two lines.\n\nOn the first line, output a number with three digits after the decimal point, representing how many milliliters of drink each student can get. On the second line, output a positive integer, representing how many cups are needed in total.", "hint": "For all data, $0\\leq t\\leq 10000$ and there are no more than $3$ digits after the decimal point, $1\\leq n\\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基2.例8】再分肥宅水", "background": "", "description": "现在有 $t$ 毫升肥宅快乐水，要均分给 $n$ 名同学。每名同学需要 $2$ 个杯子。现在想知道每名同学可以获得多少毫升饮料（严格精确到小数点后 $3$ 位），以及一共需要多少个杯子。\n\n", "inputFormat": "输入一个实数 $t$ 和一个正整数 $n$，使用空格隔开。", "outputFormat": "输出两行。\n\n第一行输出一个三位小数，表示可以获得多少毫升饮料。第二行输出一个正整数，表示一共需要多少个杯子。", "hint": "对于所有数据，$0\\leq t\\leq 10000$ 且小数点后不超过 $3$ 位，$1\\leq n\\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P5707", "type": "P", "difficulty": 2, "samples": [["100 99", "07:48"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基2.例12】上学迟到", "background": "", "description": "学校和 yyy 的家之间的距离为 $s$ 米，而 yyy 以 $v$ 米每分钟的速度匀速走向学校。\n\n在上学的路上，yyy 还要额外花费 $10$ 分钟的时间进行垃圾分类。\n\n学校要求必须在上午 $\\textrm{8:00}$  到达，请计算在不迟到的前提下，yyy 最晚能什么时候出门。\n\n由于路途遥远，yyy 可能不得不提前一点出发，但是提前的时间不会超过一天。", "inputFormat": "一行两个正整数 $s,v$，分别代表路程和速度。", "outputFormat": "输出一个 $24$ 小时制下的时间，代表 yyy 最晚的出发时间。\n\n输出格式为 $\\texttt{HH:MM}$，分别代表该时间的时和分。必须输出两位，不足前面补 $0$。", "hint": "对于 $100\\%$ 的数据，$1 \\le s,v \\le 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shen Ji 2. Example 12] Late for School", "background": "", "description": "The distance between the school and yyy's home is $s$ meters, and yyy walks to school at a constant speed of $v$ meters per minute.\n\nOn the way to school, yyy also needs an extra $10$ minutes to do garbage sorting.\n\nThe school requires that yyy must arrive by $\\textrm{8:00}$ a.m. Please calculate the latest time yyy can leave home without being late.\n\nBecause the trip is long, yyy may have to leave a bit earlier, but the time left earlier will not exceed one day.", "inputFormat": "One line with two positive integers $s, v$, representing the distance and the speed.", "outputFormat": "Output a time in 24-hour format, representing the latest departure time for yyy.\n\nThe output format is $\\texttt{HH:MM}$, which represents the hour and minute. You must output two digits for each; if not enough, pad with $0$ in front.", "hint": "For $100\\%$ of the testdata, $1 \\le s, v \\le 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基2.例12】上学迟到", "background": "", "description": "学校和 yyy 的家之间的距离为 $s$ 米，而 yyy 以 $v$ 米每分钟的速度匀速走向学校。\n\n在上学的路上，yyy 还要额外花费 $10$ 分钟的时间进行垃圾分类。\n\n学校要求必须在上午 $\\textrm{8:00}$  到达，请计算在不迟到的前提下，yyy 最晚能什么时候出门。\n\n由于路途遥远，yyy 可能不得不提前一点出发，但是提前的时间不会超过一天。", "inputFormat": "一行两个正整数 $s,v$，分别代表路程和速度。", "outputFormat": "输出一个 $24$ 小时制下的时间，代表 yyy 最晚的出发时间。\n\n输出格式为 $\\texttt{HH:MM}$，分别代表该时间的时和分。必须输出两位，不足前面补 $0$。", "hint": "对于 $100\\%$ 的数据，$1 \\le s,v \\le 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5708", "type": "P", "difficulty": 1, "samples": [["3 4 5", "6.0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "顺序结构"], "title": "【深基2.习2】三角形面积", "background": "", "description": "一个三角形的三边长分别是 $a$、$b$、$c$，那么它的面积为 $\\sqrt{p(p-a)(p-b)(p-c)}$，其中 $p=\\frac{1}{2}(a+b+c)$。输入这三个数字，计算三角形的面积，四舍五入精确到 $1$ 位小数。\n", "inputFormat": "第一行输入三个实数 $a,b,c$，以空格隔开。", "outputFormat": "输出一个实数，表示三角形面积。精确到小数点后 $1$ 位。", "hint": "数据保证能构成三角形，$0\\leq a,b,c\\leq 1000$，每个边长输入时不超过 $2$ 位小数。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 2. Exercise 2] Triangle Area", "background": "", "description": "The lengths of the three sides of a triangle are $a$, $b$, and $c$. Its area is $\\sqrt{p(p-a)(p-b)(p-c)}$, where $p=\\frac{1}{2}(a+b+c)$. Given these three numbers, compute the area of the triangle and round it to $1$ decimal place.", "inputFormat": "The first line contains three real numbers $a$, $b$, and $c$, separated by spaces.", "outputFormat": "Output one real number representing the area of the triangle, accurate to $1$ digit after the decimal point.", "hint": "Constraints: The testdata guarantees that a triangle can be formed. $0\\leq a,b,c\\leq 1000$. Each side length has at most $2$ digits after the decimal point in the input.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基2.习2】三角形面积", "background": "", "description": "一个三角形的三边长分别是 $a$、$b$、$c$，那么它的面积为 $\\sqrt{p(p-a)(p-b)(p-c)}$，其中 $p=\\frac{1}{2}(a+b+c)$。输入这三个数字，计算三角形的面积，四舍五入精确到 $1$ 位小数。\n", "inputFormat": "第一行输入三个实数 $a,b,c$，以空格隔开。", "outputFormat": "输出一个实数，表示三角形面积。精确到小数点后 $1$ 位。", "hint": "数据保证能构成三角形，$0\\leq a,b,c\\leq 1000$，每个边长输入时不超过 $2$ 位小数。", "locale": "zh-CN"}}}
{"pid": "P5709", "type": "P", "difficulty": 1, "samples": [["50 10 200", "30"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "【深基2.习6】Apples Prologue / 苹果和虫子", "background": "", "description": "小 B 喜欢吃苹果。她现在有 $m$（$1 \\le m \\le 100$）个苹果，吃完一个苹果需要花费 $t$（$0 \\le t \\le 100$）分钟，吃完一个后立刻开始吃下一个。现在时间过去了 $s$（$1 \\le s \\le 10000$）分钟，请问她还有几个完整的苹果？", "inputFormat": "输入三个**非负整数**表示 $m, t, s$。", "outputFormat": "输出一个整数表示答案。\n\n", "hint": "如果你出现了 RE，不如检查一下被零除？", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 2.Exercise 6] Apples Prologue / Apples and Worms.", "background": "", "description": "Little B likes eating apples. She now has $m$ ($1 \\le m \\le 100$) apples. It takes $t$ ($0 \\le t \\le 100$) minutes to finish one apple, and after finishing one, she immediately starts eating the next one. Now $s$ ($1 \\le s \\le 10000$) minutes have passed. How many whole apples does she have left?", "inputFormat": "Input three **non-negative integers** representing $m, t, s$.", "outputFormat": "Output one integer representing the answer.", "hint": "If you get RE, you might want to check whether you are dividing by zero.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基2.习6】Apples Prologue / 苹果和虫子", "background": "", "description": "小 B 喜欢吃苹果。她现在有 $m$（$1 \\le m \\le 100$）个苹果，吃完一个苹果需要花费 $t$（$0 \\le t \\le 100$）分钟，吃完一个后立刻开始吃下一个。现在时间过去了 $s$（$1 \\le s \\le 10000$）分钟，请问她还有几个完整的苹果？", "inputFormat": "输入三个**非负整数**表示 $m, t, s$。", "outputFormat": "输出一个整数表示答案。\n\n", "hint": "如果你出现了 RE，不如检查一下被零除？", "locale": "zh-CN"}}}
{"pid": "P5710", "type": "P", "difficulty": 1, "samples": [["12", "1 1 0 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟"], "title": "【深基3.例2】数的性质", "background": "", "description": "一些整数可能拥有以下的性质：\n\n- 性质 1：是偶数；\n- 性质 2：大于 $4$ 且不大于 $12$。\n\n小 A 喜欢这两个性质同时成立的整数；Uim 喜欢这至少符合其中一种性质的整数；小 B 喜欢刚好有符合其中一个性质的整数；正妹喜欢不符合这两个性质的整数。现在给出一个整数 $x$，请问他们是否喜欢这个整数？", "inputFormat": "输入一个整数 $x(0\\le x \\le 1000)$", "outputFormat": "输出这 $4$ 个人是否喜欢这个数字，如果喜欢则输出 `1`，否则输出 `0`，用空格分隔。输出顺序为：小 A、Uim、小 B、正妹。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 3. Example 2] Properties of Numbers", "background": "", "description": "Some integers may have the following properties:\n\n- Property 1: It is an even number.\n- Property 2: It is greater than $4$ and not greater than $12$.\n\nXiao A likes integers that satisfy both properties at the same time. Uim likes integers that satisfy at least one of these properties. Xiao B likes integers that satisfy exactly one of these properties. Zhengmei likes integers that satisfy neither of these properties. Now given an integer $x$, determine whether each of them likes this integer.", "inputFormat": "Input an integer $x(0 \\le x \\le 1000)$.", "outputFormat": "Output whether these $4$ people like this number. Output `1` if they like it, otherwise output `0`, separated by spaces. The output order is: Xiao A, Uim, Xiao B, Zhengmei.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基3.例2】数的性质", "background": "", "description": "一些整数可能拥有以下的性质：\n\n- 性质 1：是偶数；\n- 性质 2：大于 $4$ 且不大于 $12$。\n\n小 A 喜欢这两个性质同时成立的整数；Uim 喜欢这至少符合其中一种性质的整数；小 B 喜欢刚好有符合其中一个性质的整数；正妹喜欢不符合这两个性质的整数。现在给出一个整数 $x$，请问他们是否喜欢这个整数？", "inputFormat": "输入一个整数 $x(0\\le x \\le 1000)$", "outputFormat": "输出这 $4$ 个人是否喜欢这个数字，如果喜欢则输出 `1`，否则输出 `0`，用空格分隔。输出顺序为：小 A、Uim、小 B、正妹。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5711", "type": "P", "difficulty": 1, "samples": [["1926", "0"], ["1900", "0"], ["2000", "1"], ["1996", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基3.例3】闰年判断", "background": "", "description": "输入一个年份，判断这一年是否是闰年，如果是输出 $1$，否则输出 $0$。\n\n$1582$ 年以来，闰年的定义：\n\n普通闰年：公历年份是 $4$ 的倍数，且不是 $100$ 的倍数的，为闰年（如 $2004$ 年、$2020$ 年等就是闰年）。\n\n世纪闰年：公历年份是整百数的，必须是 $400$ 的倍数才是闰年（如 $1900$ 年不是闰年，$2000$ 年是闰年）。", "inputFormat": "输入一个正整数 $n$，表示年份。", "outputFormat": "输出一行。如果输入的年份是闰年则输出 $1$，否则输出 $0$。", "hint": "数据保证，$1582 \\leq n \\leq 2020$ 且年份为自然数。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 3.Example 3] Leap Year Check", "background": "", "description": "Input a year and determine whether it is a leap year. If it is, output $1$; otherwise, output $0$.\n\nSince year $1582$, the definition of a leap year is:\n\nCommon leap year: A Gregorian year that is a multiple of $4$ and not a multiple of $100$ is a leap year (for example, years $2004$ and $2020$ are leap years).\n\nCentury leap year: If a Gregorian year is a whole hundred, it must also be a multiple of $400$ to be a leap year (for example, year $1900$ is not a leap year, and year $2000$ is a leap year).", "inputFormat": "Input a positive integer $n$, representing the year.", "outputFormat": "Output one line. If the input year is a leap year, output $1$; otherwise, output $0$.", "hint": "The testdata guarantees that $1582 \\leq n \\leq 2020$, and the year is a natural number.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基3.例3】闰年判断", "background": "", "description": "输入一个年份，判断这一年是否是闰年，如果是输出 $1$，否则输出 $0$。\n\n$1582$ 年以来，闰年的定义：\n\n普通闰年：公历年份是 $4$ 的倍数，且不是 $100$ 的倍数的，为闰年（如 $2004$ 年、$2020$ 年等就是闰年）。\n\n世纪闰年：公历年份是整百数的，必须是 $400$ 的倍数才是闰年（如 $1900$ 年不是闰年，$2000$ 年是闰年）。", "inputFormat": "输入一个正整数 $n$，表示年份。", "outputFormat": "输出一行。如果输入的年份是闰年则输出 $1$，否则输出 $0$。", "hint": "数据保证，$1582 \\leq n \\leq 2020$ 且年份为自然数。", "locale": "zh-CN"}}}
{"pid": "P5712", "type": "P", "difficulty": 1, "samples": [["1", "Today, I ate 1 apple."], ["3", "Today, I ate 3 apples."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基3.例4】Apples", "background": "", "description": "小 B 喜欢吃苹果。她今天吃掉了 $x$ 个苹果。英语课上学到了 apple 这个词语，想用它来造句。如果她吃了 1 个苹果，就输出 `Today, I ate 1 apple.`；如果她没有吃，那么就把 1 换成 0；如果她吃了不止一个苹果，别忘了 `apple` 这个单词后面要加上代表复数的 `s`。你能帮她完成这个句子吗？", "inputFormat": "输入一行一个自然数 $x$，表示吃掉的苹果数。", "outputFormat": "根据题目要求输出。", "hint": "对于所有数据，$0\\le x \\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "【Shenji 3.Example 4】Apples", "background": "", "description": "Little B likes eating apples. Today she ate $x$ apples. In English class, she learned the word `apple` and wants to use it to make a sentence. If she ate 1 apple, output `Today, I ate 1 apple.`; if she ate none, then replace 1 with 0; if she ate more than one apple, do not forget to add the plural `s` after the word `apple`. Can you help her complete this sentence?", "inputFormat": "Input one line with a natural number $x$, which represents the number of apples eaten.", "outputFormat": "Output according to the requirements of the problem.", "hint": "For all testdata, $0\\le x \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基3.例4】Apples", "background": "", "description": "小 B 喜欢吃苹果。她今天吃掉了 $x$ 个苹果。英语课上学到了 apple 这个词语，想用它来造句。如果她吃了 1 个苹果，就输出 `Today, I ate 1 apple.`；如果她没有吃，那么就把 1 换成 0；如果她吃了不止一个苹果，别忘了 `apple` 这个单词后面要加上代表复数的 `s`。你能帮她完成这个句子吗？", "inputFormat": "输入一行一个自然数 $x$，表示吃掉的苹果数。", "outputFormat": "根据题目要求输出。", "hint": "对于所有数据，$0\\le x \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5713", "type": "P", "difficulty": 1, "samples": [["2", "Local"], ["50", "Luogu"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基3.例5】洛谷团队系统", "background": "", "description": "在洛谷上使用团队系统非常方便的添加自己的题目。如果在自己的电脑上配置题目和测试数据，每题需要花费时间 $5$ 分钟；而在洛谷团队中上传私有题目，每题只需要花费 $3$ 分钟，但是上传题目之前还需要一次性花费 $11$ 分钟创建与配置团队。现在要配置 $n$ 道题目，如果本地配置花费的总时间短，请输出 `Local`，否则输出 `Luogu`。", "inputFormat": "输入一个正整数 $n$，表示需要配置的题目量。", "outputFormat": "输出一行，一个字符串。如果本地配置花费的总时间短，请输出 `Local`，否则输出 `Luogu`。", "hint": "数据保证 $1 \\leq n\\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basic 3.Example 5] Luogu Team System", "background": "", "description": "Using the team system on Luogu makes it very convenient to add your own problems. If you set up the problems and testdata on your own computer, each problem takes $5$ minutes. If you upload private problems in a Luogu team, each problem only takes $3$ minutes, but before uploading, you also need to spend $11$ minutes one time to create and set up the team. Now you need to set up $n$ problems. If the total time spent setting up locally is shorter, output `Local`; otherwise, output `Luogu`.", "inputFormat": "Input a positive integer $n$, which represents the number of problems that need to be set up.", "outputFormat": "Output one line containing a string. If the total time spent setting up locally is shorter, output `Local`; otherwise, output `Luogu`.", "hint": "Constraints: $1 \\leq n \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基3.例5】洛谷团队系统", "background": "", "description": "在洛谷上使用团队系统非常方便的添加自己的题目。如果在自己的电脑上配置题目和测试数据，每题需要花费时间 $5$ 分钟；而在洛谷团队中上传私有题目，每题只需要花费 $3$ 分钟，但是上传题目之前还需要一次性花费 $11$ 分钟创建与配置团队。现在要配置 $n$ 道题目，如果本地配置花费的总时间短，请输出 `Local`，否则输出 `Luogu`。", "inputFormat": "输入一个正整数 $n$，表示需要配置的题目量。", "outputFormat": "输出一行，一个字符串。如果本地配置花费的总时间短，请输出 `Local`，否则输出 `Luogu`。", "hint": "数据保证 $1 \\leq n\\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P5714", "type": "P", "difficulty": 1, "samples": [["70 1.72", "Normal"], ["100 1.68", "35.4308\nOverweight"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基3.例7】肥胖问题", "background": "", "description": "BMI 指数是国际上常用的衡量人体胖瘦程度的一个标准，其算法是 $\\dfrac{m}{h^2}$，其中 $m$ 是指体重（千克），$h$ 是指身高（米）。不同体型范围与判定结果如下：\n\n- 小于 $18.5$：体重过轻，输出 `Underweight`；\n- 大于等于 $18.5$ 且小于 $24$：正常体重，输出 `Normal`；\n- 大于等于 $24$：肥胖，不仅要输出 BMI 值（使用 `cout` 的默认精度），然后换行，还要输出 `Overweight`；\n\n现在给出体重和身高数据，需要根据 BMI 指数判断体型状态并输出对应的判断。\n\n对于非 C++ 语言，在输出时，请四舍五入保留六位**有效数字**输出，如果小数部分存在后缀 $0$，不要输出后缀 $0$。\n\n请注意，保留六位**有效数字**不是保留六位小数。例如 $123.4567$ 应该输出为 $123.457$，$5432.10$ 应该输出为 $5432.1$。", "inputFormat": "共一行。\n\n第一行，共 $2$ 个浮点数，$m, h$，分别表示体重（单位为 kg），身高（单位为 m）。", "outputFormat": "输出一行一个字符串，表示根据 BMI 的对应判断。特别地，对于 `Overweight` 情况的特别处理请参照题目所述。", "hint": "对于所有数据，$40\\le m \\le 120$，$1.4 \\le h \\le 2.0$。$m$ 和 $h$ 的小数点后不超过三位。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 3. Example 7] Obesity Problem", "background": "", "description": "The BMI index is an international standard commonly used to measure whether a person is underweight or overweight. It is calculated as $\\dfrac{m}{h^2}$, where $m$ is the weight (in kilograms) and $h$ is the height (in meters). The ranges and results are as follows:\n\n- Less than $18.5$: underweight, output `Underweight`;\n- Greater than or equal to $18.5$ and less than $24$: normal weight, output `Normal`;\n- Greater than or equal to $24$: overweight. You must output the BMI value first (using the default precision of `cout`), then output a newline, and then output `Overweight`.\n\nGiven the weight and height, you need to determine the body type based on the BMI index and output the corresponding result.\n\nFor non-C++ languages, when outputting, please round to six **significant digits**. If the decimal part has trailing $0$'s, do not output those trailing $0$'s.\n\nNote that keeping six **significant digits** is not the same as keeping six decimal places. For example, $123.4567$ should be output as $123.457$, and $5432.10$ should be output as $5432.1$.", "inputFormat": "A single line.\n\nThe first line contains $2$ floating-point numbers $m, h$, representing the weight (in kg) and the height (in m), respectively.", "outputFormat": "Output one string on one line, representing the BMI-based result. In particular, for the special handling of the `Overweight` case, refer to the statement above.", "hint": "Constraints: For all data, $40 \\le m \\le 120$, $1.4 \\le h \\le 2.0$. There are at most three digits after the decimal point in $m$ and $h$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基3.例7】肥胖问题", "background": "", "description": "BMI 指数是国际上常用的衡量人体胖瘦程度的一个标准，其算法是 $\\dfrac{m}{h^2}$，其中 $m$ 是指体重（千克），$h$ 是指身高（米）。不同体型范围与判定结果如下：\n\n- 小于 $18.5$：体重过轻，输出 `Underweight`；\n- 大于等于 $18.5$ 且小于 $24$：正常体重，输出 `Normal`；\n- 大于等于 $24$：肥胖，不仅要输出 BMI 值（使用 `cout` 的默认精度），然后换行，还要输出 `Overweight`；\n\n现在给出体重和身高数据，需要根据 BMI 指数判断体型状态并输出对应的判断。\n\n对于非 C++ 语言，在输出时，请四舍五入保留六位**有效数字**输出，如果小数部分存在后缀 $0$，不要输出后缀 $0$。\n\n请注意，保留六位**有效数字**不是保留六位小数。例如 $123.4567$ 应该输出为 $123.457$，$5432.10$ 应该输出为 $5432.1$。", "inputFormat": "共一行。\n\n第一行，共 $2$ 个浮点数，$m, h$，分别表示体重（单位为 kg），身高（单位为 m）。", "outputFormat": "输出一行一个字符串，表示根据 BMI 的对应判断。特别地，对于 `Overweight` 情况的特别处理请参照题目所述。", "hint": "对于所有数据，$40\\le m \\le 120$，$1.4 \\le h \\le 2.0$。$m$ 和 $h$ 的小数点后不超过三位。", "locale": "zh-CN"}}}
{"pid": "P5715", "type": "P", "difficulty": 1, "samples": [["1 14 5", "1 5 14"], ["2 2 2", "2 2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基3.例8】三位数排序", "background": "", "description": "给出三个整数 $a,b,c(0\\le a,b,c \\le 100)$，要求把这三位整数从小到大排序。", "inputFormat": "输入三个整数 $a,b,c$，以空格隔开。", "outputFormat": "输出一行，三个整数，表示从小到大排序后的结果。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basic 3.Example 8] Sorting Three Numbers.", "background": "", "description": "Given three integers $a, b, c (0 \\le a, b, c \\le 100)$, sort these three integers in increasing order.", "inputFormat": "Input three integers $a, b, c$, separated by spaces.", "outputFormat": "Output one line with three integers, representing the result after sorting in increasing order.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基3.例8】三位数排序", "background": "", "description": "给出三个整数 $a,b,c(0\\le a,b,c \\le 100)$，要求把这三位整数从小到大排序。", "inputFormat": "输入三个整数 $a,b,c$，以空格隔开。", "outputFormat": "输出一行，三个整数，表示从小到大排序后的结果。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5716", "type": "P", "difficulty": 1, "samples": [["1926 8", "31"], ["2000 2", "29"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基3.例9】月份天数", "background": "", "description": "输入年份和月份，输出这一年的这一月有多少天。需要考虑闰年。", "inputFormat": "输入两个正整数，分别表示年份 $y$ 和月数 $m$，以空格隔开。", "outputFormat": "输出一行一个正整数，表示这个月有多少天。", "hint": "数据保证 $1583 \\leq y \\leq 2020$，$1 \\leq m \\leq 12$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 3. Example 9] Number of Days in a Month", "background": "", "description": "Given a year and a month, output how many days there are in that month of that year. Leap years must be considered.", "inputFormat": "Input two positive integers, representing the year $y$ and the month $m$, separated by a space.", "outputFormat": "Output one line containing one positive integer, indicating how many days there are in that month.", "hint": "Constraints: $1583 \\leq y \\leq 2020$, $1 \\leq m \\leq 12$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基3.例9】月份天数", "background": "", "description": "输入年份和月份，输出这一年的这一月有多少天。需要考虑闰年。", "inputFormat": "输入两个正整数，分别表示年份 $y$ 和月数 $m$，以空格隔开。", "outputFormat": "输出一行一个正整数，表示这个月有多少天。", "hint": "数据保证 $1583 \\leq y \\leq 2020$，$1 \\leq m \\leq 12$。", "locale": "zh-CN"}}}
{"pid": "P5717", "type": "P", "difficulty": 2, "samples": [["3 3 3", "Acute triangle\nIsosceles triangle\nEquilateral triangle"], ["3 4 5\n", "Right triangle"], ["6 10 6\n", "Obtuse triangle\nIsosceles triangle"], ["1 14 5\n", "Not triangle"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "【深基3.习8】三角形分类", "background": "", "description": "给出三条线段 $a,b,c$ 的长度，均是不大于 $10000$ 的正整数。打算把这三条线段拼成一个三角形，它可以是什么三角形呢？\n\n- 如果三条线段不能组成一个三角形，输出`Not triangle`；\n- 如果是直角三角形，输出`Right triangle`；\n- 如果是锐角三角形，输出`Acute triangle`；\n- 如果是钝角三角形，输出`Obtuse triangle`；\n- 如果是等腰三角形，输出`Isosceles triangle`；\n- 如果是等边三角形，输出`Equilateral triangle`。\n\n如果这个三角形符合以上多个条件，请按以上顺序分别输出，并用换行符隔开。", "inputFormat": "输入 3 个整数 $a$、$b$ 和 $c$。", "outputFormat": "输出若干行判定字符串。", "hint": "当两短边的平方和大于一长边的平方，说明是锐角三角形。\n\n当两短边的平方和等于一长边的平方，说明是直角三角形。\n\n当两短边的平方和小于一长边的平方，说明是钝角三角形。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basic 3. Exercise 8] Triangle Classification", "background": "", "description": "Given the lengths of three line segments $a$, $b$, and $c$, all positive integers not greater than $10000$. We want to form a triangle using these three segments. What kind of triangle can it be?\n\n- If the three segments cannot form a triangle, output `Not triangle`.\n- If it is a right triangle, output `Right triangle`.\n- If it is an acute triangle, output `Acute triangle`.\n- If it is an obtuse triangle, output `Obtuse triangle`.\n- If it is an isosceles triangle, output `Isosceles triangle`.\n- If it is an equilateral triangle, output `Equilateral triangle`.\n\nIf the triangle satisfies multiple conditions above, output them in the order given above, each on a separate line.", "inputFormat": "Input 3 integers $a$, $b$, and $c$.", "outputFormat": "Output several lines of decision strings.", "hint": "When the sum of the squares of the two shorter sides is greater than the square of the longest side, it is an acute triangle.\n\nWhen the sum of the squares of the two shorter sides is equal to the square of the longest side, it is a right triangle.\n\nWhen the sum of the squares of the two shorter sides is less than the square of the longest side, it is an obtuse triangle.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基3.习8】三角形分类", "background": "", "description": "给出三条线段 $a,b,c$ 的长度，均是不大于 $10000$ 的正整数。打算把这三条线段拼成一个三角形，它可以是什么三角形呢？\n\n- 如果三条线段不能组成一个三角形，输出`Not triangle`；\n- 如果是直角三角形，输出`Right triangle`；\n- 如果是锐角三角形，输出`Acute triangle`；\n- 如果是钝角三角形，输出`Obtuse triangle`；\n- 如果是等腰三角形，输出`Isosceles triangle`；\n- 如果是等边三角形，输出`Equilateral triangle`。\n\n如果这个三角形符合以上多个条件，请按以上顺序分别输出，并用换行符隔开。", "inputFormat": "输入 3 个整数 $a$、$b$ 和 $c$。", "outputFormat": "输出若干行判定字符串。", "hint": "当两短边的平方和大于一长边的平方，说明是锐角三角形。\n\n当两短边的平方和等于一长边的平方，说明是直角三角形。\n\n当两短边的平方和小于一长边的平方，说明是钝角三角形。", "locale": "zh-CN"}}}
{"pid": "P5718", "type": "P", "difficulty": 1, "samples": [["5\n5 7 4 2 6", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基4.例2】找最小值", "background": "", "description": "给出 $n$ 和 $n$ 个整数 $a_i$，求这 $n$ 个整数中最小值是什么。", "inputFormat": "第一行输入一个正整数 $n$，表示数字个数。\n\n第二行输入 $n$ 个非负整数，表示 $a_1,a_2 \\dots a_n$，以空格隔开。", "outputFormat": "输出一个非负整数，表示这 $n$ 个非负整数中的最小值。", "hint": "数据保证，$n\\le100$ 且 $0\\le a_i \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 4. Example 2] Find the Minimum Value", "background": "", "description": "Given $n$ and $n$ integers $a_i$, find the minimum value among these $n$ integers.", "inputFormat": "The first line contains a positive integer $n$, which represents the number of values.\n\nThe second line contains $n$ non-negative integers, representing $a_1, a_2 \\dots a_n$, separated by spaces.", "outputFormat": "Output a non-negative integer, representing the minimum value among these $n$ non-negative integers.", "hint": "Constraints: $n \\le 100$ and $0 \\le a_i \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.例2】找最小值", "background": "", "description": "给出 $n$ 和 $n$ 个整数 $a_i$，求这 $n$ 个整数中最小值是什么。", "inputFormat": "第一行输入一个正整数 $n$，表示数字个数。\n\n第二行输入 $n$ 个非负整数，表示 $a_1,a_2 \\dots a_n$，以空格隔开。", "outputFormat": "输出一个非负整数，表示这 $n$ 个非负整数中的最小值。", "hint": "数据保证，$n\\le100$ 且 $0\\le a_i \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P5719", "type": "P", "difficulty": 1, "samples": [["100 16", "56.0 50.1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基4.例3】分类平均", "background": "", "description": "给定 $n$ 和 $k$，将从 1 到 $n$ 之间的所有正整数可以分为两类：A 类数可以被 $k$ 整除（也就是说是 $k$ 的倍数），而 B 类数不能。请输出这两类数的平均数，精确到小数点后 $1$ 位，用空格隔开。\n\n数据保证两类数的个数都不会是 $0$。", "inputFormat": "输入两个正整数 $n$ 与 $k$。\n", "outputFormat": "输出一行，两个实数，分别表示 A 类数与 B 类数的平均数。精确到小数点后一位。", "hint": "数据保证，$1 \\leq n\\leq 10000$，$1 \\leq k \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "【Shenji 4. Example 3】Classified Averages", "background": "", "description": "Given $n$ and $k$, all positive integers from $1$ to $n$ can be divided into two groups. Group A consists of numbers that are divisible by $k$ (that is, multiples of $k$), and Group B consists of numbers that are not. Output the average of each group, accurate to $1$ digit after the decimal point, separated by a space.\n\nThe testdata guarantees that the number of elements in both groups will not be $0$.", "inputFormat": "Input two positive integers $n$ and $k$.", "outputFormat": "Output one line with two real numbers, representing the averages of Group A and Group B, respectively. Keep exactly one digit after the decimal point.", "hint": "Constraints: $1 \\leq n\\leq 10000$, $1 \\leq k \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.例3】分类平均", "background": "", "description": "给定 $n$ 和 $k$，将从 1 到 $n$ 之间的所有正整数可以分为两类：A 类数可以被 $k$ 整除（也就是说是 $k$ 的倍数），而 B 类数不能。请输出这两类数的平均数，精确到小数点后 $1$ 位，用空格隔开。\n\n数据保证两类数的个数都不会是 $0$。", "inputFormat": "输入两个正整数 $n$ 与 $k$。\n", "outputFormat": "输出一行，两个实数，分别表示 A 类数与 B 类数的平均数。精确到小数点后一位。", "hint": "数据保证，$1 \\leq n\\leq 10000$，$1 \\leq k \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P5720", "type": "P", "difficulty": 1, "samples": [["100", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基4.例4】一尺之棰", "background": "", "description": "《庄子》中说到，“一尺之棰，日取其半，万世不竭”。第一天有一根长度为 $a$ 的木棍，从第二天开始，每天都要将这根木棍锯掉一半（每次除 $2$，向下取整）。第几天的时候木棍的长度会变为 $1$？", "inputFormat": "输入一个正整数 $a$，表示木棍长度。", "outputFormat": "输出一个正整数，表示要第几天的时候木棍长度会变为 $1$。", "hint": "数据保证，$1 \\le a\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics 4. Example 4] A One-Chi Stick", "background": "", "description": "In *Zhuangzi*, it is said: “A one-chi stick, take half of it each day, and it will never be exhausted.” On the first day, there is a wooden stick of length $a$. Starting from the second day, each day you saw off half of the stick (divide by $2$ each time, rounding down). On which day will the length of the stick become $1$?", "inputFormat": "Input a positive integer $a$, representing the length of the stick.", "outputFormat": "Output a positive integer, representing on which day the length of the stick will become $1$.", "hint": "Constraints: $1 \\le a \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.例4】一尺之棰", "background": "", "description": "《庄子》中说到，“一尺之棰，日取其半，万世不竭”。第一天有一根长度为 $a$ 的木棍，从第二天开始，每天都要将这根木棍锯掉一半（每次除 $2$，向下取整）。第几天的时候木棍的长度会变为 $1$？", "inputFormat": "输入一个正整数 $a$，表示木棍长度。", "outputFormat": "输出一个正整数，表示要第几天的时候木棍长度会变为 $1$。", "hint": "数据保证，$1 \\le a\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5721", "type": "P", "difficulty": 1, "samples": [["5", "0102030405\n06070809\n101112\n1314\n15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基4.例6】数字直角三角形", "background": "", "description": "给出 $n$，请输出一个直角边长度是 $n$ 的数字直角三角形。所有数字都是 $2$ 位组成的，如果没有 $2$ 位则加上前导 $0$。", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出如题目要求的数字直角三角形。", "hint": "数据保证，$1\\le n\\le13$。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics 4. Example 6] Numeric Right Triangle", "background": "", "description": "Given $n$, output a numeric right triangle whose leg length is $n$. All numbers consist of $2$ digits. If a number does not have $2$ digits, add a leading $0$.", "inputFormat": "Input one positive integer $n$.", "outputFormat": "Output the numeric right triangle as required by the problem statement.", "hint": "Constraints: $1\\le n\\le 13$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.例6】数字直角三角形", "background": "", "description": "给出 $n$，请输出一个直角边长度是 $n$ 的数字直角三角形。所有数字都是 $2$ 位组成的，如果没有 $2$ 位则加上前导 $0$。", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出如题目要求的数字直角三角形。", "hint": "数据保证，$1\\le n\\le13$。", "locale": "zh-CN"}}}
{"pid": "P5722", "type": "P", "difficulty": 1, "samples": [["100", "5050"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基4.例11】数列求和", "background": "", "description": "计算 $1+2+3+\\cdots+(n-1)+n$ 的值，其中正整数 $n$ 不大于 100。由于你没有高斯聪明，所以你不被允许使用等差数列求和公式直接求出答案。", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出一个正整数，表示最后求和的答案。", "hint": "数据保证，$1 \\leq n \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics 4. Example 11] Sum of a Sequence", "background": "", "description": "Compute the value of $1+2+3+\\cdots+(n-1)+n$, where the positive integer $n$ is no more than 100. Since you are not as smart as Gauss, you are not allowed to use the arithmetic sequence sum formula to get the answer directly.", "inputFormat": "Input a positive integer $n$.", "outputFormat": "Output a positive integer representing the final sum.", "hint": "Constraints: $1 \\leq n \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.例11】数列求和", "background": "", "description": "计算 $1+2+3+\\cdots+(n-1)+n$ 的值，其中正整数 $n$ 不大于 100。由于你没有高斯聪明，所以你不被允许使用等差数列求和公式直接求出答案。", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出一个正整数，表示最后求和的答案。", "hint": "数据保证，$1 \\leq n \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P5723", "type": "P", "difficulty": 2, "samples": [["100", "2\n3\n5\n7\n11\n13\n17\n19\n23\n9"], ["5", "2\n3\n2"], ["11", "2\n3\n5\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["素数判断,质数,筛法"], "title": "【深基4.例13】质数口袋", "background": "", "description": "小 A 有一个质数口袋，里面可以装各个质数。他从 $2$ 开始，依次判断各个自然数是不是质数，如果是质数就会把这个数字装入口袋。\n\n口袋的负载量就是口袋里的所有数字之和。\n\n但是口袋的承重量有限，装的质数的和不能超过 $L$。给出 $L$，请问口袋里能装下几个质数？将这些质数从小往大输出，然后输出最多能装下的质数的个数，数字之间用换行隔开。", "inputFormat": "一行一个正整数 $L$。", "outputFormat": "将这些质数从小往大输出，然后输出最多能装下的质数个数。", "hint": "数据保证，$1 \\le L \\le {10}^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basic 4. Example 13] Prime Pocket", "background": "", "description": "Little A has a prime pocket that can hold prime numbers. Starting from $2$, he checks each natural number in order to see whether it is prime. If it is prime, he puts that number into the pocket.\n\nThe load of the pocket is the sum of all numbers in the pocket.\n\nHowever, the pocket has a limited capacity: the sum of the primes put in cannot exceed $L$. Given $L$, how many primes can the pocket hold at most? Output these primes from small to large, and then output the maximum number of primes that can be held. Separate numbers with newline characters.", "inputFormat": "One line containing one positive integer $L$.", "outputFormat": "Output these primes from small to large, and then output the maximum number of primes that can be held.", "hint": "Constraints: $1 \\le L \\le {10}^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.例13】质数口袋", "background": "", "description": "小 A 有一个质数口袋，里面可以装各个质数。他从 $2$ 开始，依次判断各个自然数是不是质数，如果是质数就会把这个数字装入口袋。\n\n口袋的负载量就是口袋里的所有数字之和。\n\n但是口袋的承重量有限，装的质数的和不能超过 $L$。给出 $L$，请问口袋里能装下几个质数？将这些质数从小往大输出，然后输出最多能装下的质数的个数，数字之间用换行隔开。", "inputFormat": "一行一个正整数 $L$。", "outputFormat": "将这些质数从小往大输出，然后输出最多能装下的质数个数。", "hint": "数据保证，$1 \\le L \\le {10}^5$。", "locale": "zh-CN"}}}
{"pid": "P5724", "type": "P", "difficulty": 1, "samples": [["6\n4 1 5 1 4 1", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基4.习5】求极差 / 最大跨度值 / 最大值和最小值的差", "background": "", "description": "给出 $n$ 和 $n$ 个整数 $a_i$，求这 $n$ 个整数中的极差是什么。极差的意思是一组数中的最大值减去最小值的差。", "inputFormat": "第一行输入一个正整数 $n$，表示整数个数。\n\n第二行输入 $n$ 个整数 $a_1,a_2 \\dots a_n$，以空格隔开。", "outputFormat": "输出一个整数，表示这 $n$ 个整数的极差。", "hint": "数据保证，$1 \\leq n\\leq 100$，$0\\le a_i \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 4.Ex 5] Range / Maximum Span / Difference Between the Maximum and Minimum Values", "background": "", "description": "Given $n$ and $n$ integers $a_i$, find the range of these $n$ integers. The range means the difference between the maximum value and the minimum value in a set of numbers.", "inputFormat": "The first line contains a positive integer $n$, indicating the number of integers.\n\nThe second line contains $n$ integers $a_1, a_2 \\dots a_n$, separated by spaces.", "outputFormat": "Output an integer, representing the range of these $n$ integers.", "hint": "Constraints: $1 \\leq n \\leq 100$, $0 \\le a_i \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.习5】求极差 / 最大跨度值 / 最大值和最小值的差", "background": "", "description": "给出 $n$ 和 $n$ 个整数 $a_i$，求这 $n$ 个整数中的极差是什么。极差的意思是一组数中的最大值减去最小值的差。", "inputFormat": "第一行输入一个正整数 $n$，表示整数个数。\n\n第二行输入 $n$ 个整数 $a_1,a_2 \\dots a_n$，以空格隔开。", "outputFormat": "输出一个整数，表示这 $n$ 个整数的极差。", "hint": "数据保证，$1 \\leq n\\leq 100$，$0\\le a_i \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P5725", "type": "P", "difficulty": 1, "samples": [["4", "01020304\n05060708\n09101112\n13141516\n\n      01\n    0203\n  040506\n07080910"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基4.习8】求三角形", "background": null, "description": "模仿例题，打印出不同方向的正方形，然后打印三角形矩阵。中间有个空行。", "inputFormat": "输入矩阵的规模，不超过 $9$。", "outputFormat": "输出矩形和三角形", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basic 4.Exercise 8] Draw Triangles.", "background": "", "description": "Imitate the sample problem. Print squares in different directions, then print a triangular matrix. There is a blank line in the middle.", "inputFormat": "Input the size of the matrix, not greater than $9$.", "outputFormat": "Output the rectangles and the triangle.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.习8】求三角形", "background": null, "description": "模仿例题，打印出不同方向的正方形，然后打印三角形矩阵。中间有个空行。", "inputFormat": "输入矩阵的规模，不超过 $9$。", "outputFormat": "输出矩形和三角形", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5726", "type": "P", "difficulty": 2, "samples": [["5\n9 5 6 8 9", "7.67"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基4.习9】打分", "background": null, "description": "现在有 $n(n \\le 1000)$ 位评委给选手打分，分值从 $0$ 到 $10$。需要去掉一个最高分，去掉一个最低分（如果有多个最高或者最低分，也只需要去掉一个），剩下的评分的平均数就是这位选手的得分。现在输入评委人数和他们的打分，请输出选手的最后得分，精确到 $2$ 位小数。", "inputFormat": "第一行输入一个正整数 $n$，表示有 $n$ 个评委。\n\n第二行输入 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个评委打出的分值。", "outputFormat": "输出一行一个两位小数，表示选手的最后得分。", "hint": "数据保证，$3 \\leq n \\leq 1000$，每个评委打出的分值为 $0$ 到 $10$（含 $0$ 与 $10$）之间的整数。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Base 4. Exercise 9] Scoring.", "background": "", "description": "There are $n(n \\le 1000)$ judges scoring a contestant, with scores ranging from $0$ to $10$. You need to remove one highest score and one lowest score (if there are multiple highest or lowest scores, only remove one), and the average of the remaining scores is the contestant’s final score. Given the number of judges and their scores, output the contestant’s final score, accurate to $2$ decimal places.", "inputFormat": "The first line contains a positive integer $n$, indicating that there are $n$ judges.\n\nThe second line contains $n$ integers. The $i$-th integer is the score given by the $i$-th judge.", "outputFormat": "Output one line with a number rounded to two decimal places, representing the contestant’s final score.", "hint": "Constraints: the data guarantees that $3 \\leq n \\leq 1000$, and each judge’s score is an integer between $0$ and $10$ (inclusive of $0$ and $10$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基4.习9】打分", "background": null, "description": "现在有 $n(n \\le 1000)$ 位评委给选手打分，分值从 $0$ 到 $10$。需要去掉一个最高分，去掉一个最低分（如果有多个最高或者最低分，也只需要去掉一个），剩下的评分的平均数就是这位选手的得分。现在输入评委人数和他们的打分，请输出选手的最后得分，精确到 $2$ 位小数。", "inputFormat": "第一行输入一个正整数 $n$，表示有 $n$ 个评委。\n\n第二行输入 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个评委打出的分值。", "outputFormat": "输出一行一个两位小数，表示选手的最后得分。", "hint": "数据保证，$3 \\leq n \\leq 1000$，每个评委打出的分值为 $0$ 到 $10$（含 $0$ 与 $10$）之间的整数。", "locale": "zh-CN"}}}
{"pid": "P5727", "type": "P", "difficulty": 1, "samples": [["20", "1 2 4 8 16 5 10 20"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基5.例3】冰雹猜想", "background": "", "description": "给出一个正整数 $n$，然后对这个数字一直进行下面的操作：如果这个数字是奇数，那么将其乘 $3$ 再加 $1$，否则除以 $2$。经过若干次循环后，最终都会回到 $1$。经过验证很大的数字（$7\\times10^{11}$）都可以按照这样的方式比变成 $1$，所以被称为“冰雹猜想”。例如当 $n$ 是 $20$，变化的过程是 $20\\to 10\\to 5\\to 16\\to 8\\to 4\\to 2\\to 1$。\n\n根据给定的数字，验证这个猜想，并从最后的 $1$ 开始，倒序输出整个变化序列。", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出若干个由空格隔开的正整数，表示从最后的 $1$ 开始倒序的变化数列。", "hint": "数据保证，$1 \\le n\\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 5. Example 3] Collatz Conjecture", "background": "", "description": "Given a positive integer $n$, keep doing the following operation on this number: if the number is odd, multiply it by $3$ and then add $1$; otherwise, divide it by $2$. After several cycles, it will always return to $1$. It has been verified that even very large numbers ($7\\times 10^{11}$) can become $1$ in this way, so it is called the \"Collatz Conjecture\". For example, when $n$ is $20$, the process is $20\\to 10\\to 5\\to 16\\to 8\\to 4\\to 2\\to 1$.\n\nGiven the number, verify this conjecture, and starting from the final $1$, output the entire sequence in reverse order.", "inputFormat": "Input one positive integer $n$.", "outputFormat": "Output several positive integers separated by spaces, representing the sequence in reverse order starting from the final $1$.", "hint": "Constraints: it is guaranteed that $1 \\le n\\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基5.例3】冰雹猜想", "background": "", "description": "给出一个正整数 $n$，然后对这个数字一直进行下面的操作：如果这个数字是奇数，那么将其乘 $3$ 再加 $1$，否则除以 $2$。经过若干次循环后，最终都会回到 $1$。经过验证很大的数字（$7\\times10^{11}$）都可以按照这样的方式比变成 $1$，所以被称为“冰雹猜想”。例如当 $n$ 是 $20$，变化的过程是 $20\\to 10\\to 5\\to 16\\to 8\\to 4\\to 2\\to 1$。\n\n根据给定的数字，验证这个猜想，并从最后的 $1$ 开始，倒序输出整个变化序列。", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出若干个由空格隔开的正整数，表示从最后的 $1$ 开始倒序的变化数列。", "hint": "数据保证，$1 \\le n\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5728", "type": "P", "difficulty": 1, "samples": [["3\n90 90 90\n85 95 90\n80 100 91", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基5.例5】旗鼓相当的对手", "background": "", "description": "现有 $N$ 名同学参加了期末考试，并且获得了每名同学的信息：语文、数学、英语成绩（均为不超过 $150$ 的自然数）。如果某对学生 $\\lang i,j\\rang$ 的每一科成绩的分差都不大于 $5$，且总分分差不大于 $10$，那么这对学生就是“旗鼓相当的对手”。现在想知道这些同学中，有几对“旗鼓相当的对手”？同样一个人可能会和其他好几名同学结对。", "inputFormat": "第一行一个正整数 $N$。\n\n接下来 $N$ 行，每行三个整数，其中第 $i$ 行表示第 $i$ 名同学的语文、数学、英语成绩。最先读入的同学编号为 $1$。", "outputFormat": "输出一个整数，表示“旗鼓相当的对手”的对数。", "hint": "数据保证，$2 \\le N\\le 1000$ 且每科成绩为不超过 $150$ 的自然数。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics 5.Example 5] Evenly Matched Opponents", "background": "", "description": "There are $N$ students who took the final exam, and we are given each student’s information: Chinese, Math, and English scores (all natural numbers not exceeding $150$). If for a pair of students $\\lang i,j\\rang$, the score difference in each subject is no more than $5$, and the difference in total score is no more than $10$, then this pair of students are “evenly matched opponents”. Now, find how many pairs of “evenly matched opponents” there are among these students. The same student may be paired with multiple other students.", "inputFormat": "The first line contains a positive integer $N$.\n\nThe next $N$ lines each contain three integers. The $i$-th line gives the Chinese, Math, and English scores of the $i$-th student. The first student read in is numbered $1$.", "outputFormat": "Output one integer, representing the number of pairs of “evenly matched opponents”.", "hint": "Constraints: $2 \\le N\\le 1000$, and each subject score is a natural number not exceeding $150$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基5.例5】旗鼓相当的对手", "background": "", "description": "现有 $N$ 名同学参加了期末考试，并且获得了每名同学的信息：语文、数学、英语成绩（均为不超过 $150$ 的自然数）。如果某对学生 $\\lang i,j\\rang$ 的每一科成绩的分差都不大于 $5$，且总分分差不大于 $10$，那么这对学生就是“旗鼓相当的对手”。现在想知道这些同学中，有几对“旗鼓相当的对手”？同样一个人可能会和其他好几名同学结对。", "inputFormat": "第一行一个正整数 $N$。\n\n接下来 $N$ 行，每行三个整数，其中第 $i$ 行表示第 $i$ 名同学的语文、数学、英语成绩。最先读入的同学编号为 $1$。", "outputFormat": "输出一个整数，表示“旗鼓相当的对手”的对数。", "hint": "数据保证，$2 \\le N\\le 1000$ 且每科成绩为不超过 $150$ 的自然数。", "locale": "zh-CN"}}}
{"pid": "P5729", "type": "P", "difficulty": 1, "samples": [["4 4 4\n1\n1 1 1 2 2 2\n", "56"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基5.例7】工艺品制作", "background": "", "description": "现有一个长宽高分别为 $w,x,h$ 组成的实心玻璃立方体，可以认为是由 $1\\times1\\times1$ 的数个小方块组成的，每个小方块都有一个坐标 $ ( i,j,k ) $。现在需要进行 $q$ 次切割。每次切割给出 $(x_1,y_1,z_1),(x_2,y_2,z_2)$ 这 6 个参数，保证 $x_1\\le x_2$，$y_1\\le y_2$，$z_1\\le z_2$；每次切割时，使用激光工具切出一个立方体空洞，空洞的壁平行于立方体的面，空洞的对角点就是给出的切割参数的两个点。\n\n换句话说，所有满足  $x_1\\le i\\le x_2$，$y_1\\le j \\le y_2 $，$z_1\\le k\\le z_2$ 的小方块 $(i,j,k)$ 的点都会被激光蒸发。例如有一个  $4\\times4\\times 4$ 的大方块，其体积为 $64$；给出参数 $(1,1,1),(2,2,2)$ 时，中间的 $8$ 块小方块就会被蒸发，剩下 $56$ 个小方块。现在想知道经过所有切割操作后，剩下的工艺品还剩下多少格小方块的体积？ ", "inputFormat": "第一行三个正整数 $w,x,h$。\n\n第二行一个正整数 $q$。\n\n接下来 $q$ 行，每行六个整数 $(x_1,y_1,z_1),(x_2,y_2,z_2)$。", "outputFormat": "输出一个整数表示答案。", "hint": "数据保证，$1\\le w,x,h\\le 20$，$1 \\leq q\\le 100$。$1 \\leq x_1 \\leq x_2 \\leq w$，$1 \\leq y_1\\leq y_2 \\leq x$，$1 \\leq z_1 \\leq z_2 \\leq h$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 5. Example 7] Craft Making", "background": "", "description": "There is a solid glass cuboid with length, width, and height equal to $w, x, h$. It can be considered as being made up of many $1\\times1\\times1$ small cubes, and each small cube has coordinates $(i, j, k)$. Now we need to perform $q$ cuts. Each cut gives six parameters $(x_1, y_1, z_1), (x_2, y_2, z_2)$, and it is guaranteed that $x_1 \\le x_2$, $y_1 \\le y_2$, $z_1 \\le z_2$. During each cut, a laser tool is used to carve out a cuboid cavity whose faces are parallel to the faces of the original cuboid. The two diagonal corner points of the cavity are exactly the two points given in the parameters.\n\nIn other words, all small cubes $(i, j, k)$ satisfying $x_1 \\le i \\le x_2$, $y_1 \\le j \\le y_2$, $z_1 \\le k \\le z_2$ will be evaporated by the laser. For example, for a $4\\times4\\times4$ large cube with volume $64$, if the parameters are $(1, 1, 1), (2, 2, 2)$, then the $8$ small cubes in the middle will be evaporated, leaving $56$ small cubes. Now, after all cutting operations, how many unit cubes of volume remain in the craft?", "inputFormat": "The first line contains three positive integers $w, x, h$.\n\nThe second line contains one positive integer $q$.\n\nThe next $q$ lines each contain six integers $(x_1, y_1, z_1), (x_2, y_2, z_2)$.", "outputFormat": "Output one integer representing the answer.", "hint": "Constraints: $1 \\le w, x, h \\le 20$, $1 \\le q \\le 100$. $1 \\le x_1 \\le x_2 \\le w$, $1 \\le y_1 \\le y_2 \\le x$, $1 \\le z_1 \\le z_2 \\le h$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基5.例7】工艺品制作", "background": "", "description": "现有一个长宽高分别为 $w,x,h$ 组成的实心玻璃立方体，可以认为是由 $1\\times1\\times1$ 的数个小方块组成的，每个小方块都有一个坐标 $ ( i,j,k ) $。现在需要进行 $q$ 次切割。每次切割给出 $(x_1,y_1,z_1),(x_2,y_2,z_2)$ 这 6 个参数，保证 $x_1\\le x_2$，$y_1\\le y_2$，$z_1\\le z_2$；每次切割时，使用激光工具切出一个立方体空洞，空洞的壁平行于立方体的面，空洞的对角点就是给出的切割参数的两个点。\n\n换句话说，所有满足  $x_1\\le i\\le x_2$，$y_1\\le j \\le y_2 $，$z_1\\le k\\le z_2$ 的小方块 $(i,j,k)$ 的点都会被激光蒸发。例如有一个  $4\\times4\\times 4$ 的大方块，其体积为 $64$；给出参数 $(1,1,1),(2,2,2)$ 时，中间的 $8$ 块小方块就会被蒸发，剩下 $56$ 个小方块。现在想知道经过所有切割操作后，剩下的工艺品还剩下多少格小方块的体积？ ", "inputFormat": "第一行三个正整数 $w,x,h$。\n\n第二行一个正整数 $q$。\n\n接下来 $q$ 行，每行六个整数 $(x_1,y_1,z_1),(x_2,y_2,z_2)$。", "outputFormat": "输出一个整数表示答案。", "hint": "数据保证，$1\\le w,x,h\\le 20$，$1 \\leq q\\le 100$。$1 \\leq x_1 \\leq x_2 \\leq w$，$1 \\leq y_1\\leq y_2 \\leq x$，$1 \\leq z_1 \\leq z_2 \\leq h$。", "locale": "zh-CN"}}}
{"pid": "P5730", "type": "P", "difficulty": 2, "samples": [["10\n0123456789\n", "XXX...X.XXX.XXX.X.X.XXX.XXX.XXX.XXX.XXX\nX.X...X...X...X.X.X.X...X.....X.X.X.X.X\nX.X...X.XXX.XXX.XXX.XXX.XXX...X.XXX.XXX\nX.X...X.X.....X...X...X.X.X...X.X.X...X\nXXX...X.XXX.XXX...X.XXX.XXX...X.XXX.XXX\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基5.例10】显示屏", "background": "", "description": "液晶屏上，每个阿拉伯数字都是可以显示成 $3\\times5$ 的点阵的（其中 `X` 表示亮点，`.` 表示暗点）。现在给出数字位数（不超过 $100$）和一串数字，要求输出这些数字在显示屏上的效果。数字的显示方式如同样例输出，注意每个数字之间都有一列间隔。", "inputFormat": "第一行输入一个正整数 $n$，表示数字的位数。\n\n第二行输入一个长度为 $n$ 的自然数。", "outputFormat": "输出五行，表示显示屏上的数字。", "hint": "数据保证，$1 \\leq n \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 5. Example 10] Display Screen", "background": "", "description": "On an LCD screen, each Arabic digit can be shown as a $3\\times5$ dot matrix (where `X` means a lit dot and `.` means an unlit dot). Now you are given the number of digits (not exceeding $100$) and a string of digits. You need to output the display effect of these digits on the screen. The display style is the same as in the sample output. Note that there is one column of spacing between every two digits.", "inputFormat": "The first line contains a positive integer $n$, which is the number of digits.\n\nThe second line contains a natural number of length $n$.", "outputFormat": "Output five lines to represent the digits on the display screen.", "hint": "The testdata guarantees that $1 \\leq n \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基5.例10】显示屏", "background": "", "description": "液晶屏上，每个阿拉伯数字都是可以显示成 $3\\times5$ 的点阵的（其中 `X` 表示亮点，`.` 表示暗点）。现在给出数字位数（不超过 $100$）和一串数字，要求输出这些数字在显示屏上的效果。数字的显示方式如同样例输出，注意每个数字之间都有一列间隔。", "inputFormat": "第一行输入一个正整数 $n$，表示数字的位数。\n\n第二行输入一个长度为 $n$ 的自然数。", "outputFormat": "输出五行，表示显示屏上的数字。", "hint": "数据保证，$1 \\leq n \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P5731", "type": "P", "difficulty": 1, "samples": [["4", "  1  2  3  4\n 12 13 14  5\n 11 16 15  6\n 10  9  8  7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基5.习6】蛇形方阵", "background": "", "description": "给出一个不大于 $9$ 的正整数 $n$，输出 $n\\times n$ \n的蛇形方阵。\n\n从左上角填上 $1$ 开始，顺时针方向依次填入数字，如同样例所示。注意每个数字有都会占用 $3$ 个字符，前面使用空格补齐。", "inputFormat": "输入一个正整数 $n$，含义如题所述。", "outputFormat": "输出符合题目要求的蛇形矩阵。", "hint": "数据保证，$1 \\leq n \\leq 9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 5. Exercise 6] Spiral Matrix", "background": "", "description": "Given a positive integer $n$ not greater than $9$, output an $n \\times n$ spiral matrix.\n\nStart by filling $1$ in the top-left corner, then fill the numbers in clockwise order, as shown in the sample. Note that each number takes up $3$ characters, padded with leading spaces.", "inputFormat": "Input one positive integer $n$, with the meaning described above.", "outputFormat": "Output the spiral matrix that meets the requirements.", "hint": "Constraints: $1 \\leq n \\leq 9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基5.习6】蛇形方阵", "background": "", "description": "给出一个不大于 $9$ 的正整数 $n$，输出 $n\\times n$ \n的蛇形方阵。\n\n从左上角填上 $1$ 开始，顺时针方向依次填入数字，如同样例所示。注意每个数字有都会占用 $3$ 个字符，前面使用空格补齐。", "inputFormat": "输入一个正整数 $n$，含义如题所述。", "outputFormat": "输出符合题目要求的蛇形矩阵。", "hint": "数据保证，$1 \\leq n \\leq 9$。", "locale": "zh-CN"}}}
{"pid": "P5732", "type": "P", "difficulty": 1, "samples": [["6", "1\n1 1\n1 2 1\n1 3 3 1\n1 4 6 4 1\n1 5 10 10 5 1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基5.习7】杨辉三角", "background": "", "description": "给出 $n(1\\le n\\le20)$，输出杨辉三角的前 $n$ 行。\n\n如果你不知道什么是杨辉三角，可以观察样例找找规律。", "inputFormat": "", "outputFormat": "", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Basics 5. Practice 7] Pascal's Triangle", "background": "", "description": "Given $n(1\\le n\\le20)$, output the first $n$ rows of Pascal's triangle.\n\nIf you do not know what Pascal's triangle is, you can observe the sample and look for the pattern.", "inputFormat": "", "outputFormat": "", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基5.习7】杨辉三角", "background": "", "description": "给出 $n(1\\le n\\le20)$，输出杨辉三角的前 $n$ 行。\n\n如果你不知道什么是杨辉三角，可以观察样例找找规律。", "inputFormat": "", "outputFormat": "", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5733", "type": "P", "difficulty": 1, "samples": [["Luogu4!", "LUOGU4!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "【深基6.例1】自动修正", "background": "", "description": "大家都知道一些办公软件有自动将字母转换为大写的功能。输入一个长度不超过 $100$ 且不包括空格的字符串。要求将该字符串中的所有小写字母变成大写字母并输出。", "inputFormat": "输入一行，一个字符串。", "outputFormat": "输出一个字符串，即将原字符串中的所有小写字母转化为大写字母。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 6. Example 1] Auto Correction", "background": "", "description": "As everyone knows, some office software has a function that automatically converts letters to uppercase. Input a string with length no more than $100$ and without spaces. You need to change all lowercase letters in the string into uppercase letters and output it.", "inputFormat": "Input one line: a string.", "outputFormat": "Output a string, which is the original string with all lowercase letters converted to uppercase letters.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基6.例1】自动修正", "background": "", "description": "大家都知道一些办公软件有自动将字母转换为大写的功能。输入一个长度不超过 $100$ 且不包括空格的字符串。要求将该字符串中的所有小写字母变成大写字母并输出。", "inputFormat": "输入一行，一个字符串。", "outputFormat": "输出一个字符串，即将原字符串中的所有小写字母转化为大写字母。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5734", "type": "P", "difficulty": 2, "samples": [["4\nILove\n1 Luogu\n2 5 5\n3 3 guGugu\n4 gu", "ILoveLuogu\nLuogu\nLuoguGugugu\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串"], "title": "【深基6.例6】文字处理软件", "background": "", "description": "你需要开发一款文字处理软件。最开始时输入一个字符串作为初始文档。可以认为文档开头是第 $0$ 个字符。需要支持以下操作：\n\n- `1 str`：后接插入，在文档后面插入字符串 $\\texttt{str}$，并输出文档的字符串；\n- `2 a b`：截取文档部分，只保留文档中从第 $a$ 个字符起 $b$ 个字符，并输出文档的字符串；\n- `3 a str`：插入片段，在文档中第 $a$ 个字符前面插入字符串 $\\texttt{str}$，并输出文档的字符串；\n- `4 str`：查找子串，查找字符串 $\\texttt{str}$ 在文档中最先的位置并输出；如果找不到输出 $-1$。\n\n为了简化问题，规定初始的文档和每次操作中的 $\\texttt{str}$ 都不含有空格或换行。最多会有 $q$ 次操作。", "inputFormat": "第一行输入一个正整数 $q$，表示操作次数。\n\n第二行输入一个字符串 $\\texttt{str}$，表示最开始的字符串。\n\n第三行开始，往下 $q$ 行，每行表示一个操作，操作如题目描述所示。", "outputFormat": "一共输出 $q$ 行。\n\n对于每个操作 $1,2,3$，根据操作的要求输出一个字符串。\n\n对于操作 $4$，根据操作的要求输出一个整数。", "hint": "数据保证，$1 \\leq q\\le 100$，开始的字符串长度 $\\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 6. Example 6] Word Processing Software", "background": "", "description": "You need to develop a word processing software. At the beginning, input a string as the initial document. You may assume that the start of the document is the $0$-th character. The following operations must be supported:\n\n- `1 str`: Append insertion. Insert the string $\\texttt{str}$ at the end of the document, and output the document string.\n- `2 a b`: Extract part of the document. Keep only $b$ characters starting from the $a$-th character of the document, and output the document string.\n- `3 a str`: Insert a segment. Insert the string $\\texttt{str}$ before the $a$-th character in the document, and output the document string.\n- `4 str`: Find a substring. Output the earliest position of the string $\\texttt{str}$ in the document; if it cannot be found, output $-1$.\n\nTo simplify the problem, the initial document and $\\texttt{str}$ in each operation contain no spaces or newlines. There will be at most $q$ operations.", "inputFormat": "The first line contains a positive integer $q$, representing the number of operations.\n\nThe second line contains a string $\\texttt{str}$, representing the initial string.\n\nStarting from the third line, the next $q$ lines each describe an operation, as shown in the problem description.", "outputFormat": "Output a total of $q$ lines.\n\nFor each operation $1,2,3$, output a string as required.\n\nFor operation $4$, output an integer as required.", "hint": "Constraints: $1 \\leq q \\le 100$, and the length of the initial string is $\\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基6.例6】文字处理软件", "background": "", "description": "你需要开发一款文字处理软件。最开始时输入一个字符串作为初始文档。可以认为文档开头是第 $0$ 个字符。需要支持以下操作：\n\n- `1 str`：后接插入，在文档后面插入字符串 $\\texttt{str}$，并输出文档的字符串；\n- `2 a b`：截取文档部分，只保留文档中从第 $a$ 个字符起 $b$ 个字符，并输出文档的字符串；\n- `3 a str`：插入片段，在文档中第 $a$ 个字符前面插入字符串 $\\texttt{str}$，并输出文档的字符串；\n- `4 str`：查找子串，查找字符串 $\\texttt{str}$ 在文档中最先的位置并输出；如果找不到输出 $-1$。\n\n为了简化问题，规定初始的文档和每次操作中的 $\\texttt{str}$ 都不含有空格或换行。最多会有 $q$ 次操作。", "inputFormat": "第一行输入一个正整数 $q$，表示操作次数。\n\n第二行输入一个字符串 $\\texttt{str}$，表示最开始的字符串。\n\n第三行开始，往下 $q$ 行，每行表示一个操作，操作如题目描述所示。", "outputFormat": "一共输出 $q$ 行。\n\n对于每个操作 $1,2,3$，根据操作的要求输出一个字符串。\n\n对于操作 $4$，根据操作的要求输出一个整数。", "hint": "数据保证，$1 \\leq q\\le 100$，开始的字符串长度 $\\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P5735", "type": "P", "difficulty": 1, "samples": [["0 0\n0 3\n4 0", "12.00"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基7.例1】距离函数", "background": null, "description": "给出平面坐标上不在一条直线上三个点坐标 $(x_1,y_1),(x_2,y_2),(x_3,y_3)$，坐标值是实数，且绝对值不超过 100.00，求围成的三角形周长。保留两位小数。\n\n对于平面上的两个点 $(x_1,y_1),(x_2,y_2)$，则这两个点之间的距离 $dis=\\sqrt{(x_2-x_1)^2+(y_2-y_1)^2}$。", "inputFormat": "输入三行，第 $i$ 行表示坐标 $(x_i,y_i)$，以一个空格隔开。", "outputFormat": "输出一个两位小数，表示由这三个坐标围成的三角形的周长。", "hint": "数据保证，坐标均为实数且绝对值不超过 $100$，小数点后最多仅有 $3$ 位。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 7. Example 1] Distance Function", "background": "", "description": "Given the coordinates of three points on the plane that are not on the same straight line $(x_1,y_1),(x_2,y_2),(x_3,y_3)$, where the coordinate values are real numbers and their absolute values do not exceed 100.00, find the perimeter of the triangle formed by them. Keep two decimal places.\n\nFor two points on the plane $(x_1,y_1),(x_2,y_2)$, the distance between them is $dis=\\sqrt{(x_2-x_1)^2+(y_2-y_1)^2}$.", "inputFormat": "Input consists of three lines. The $i$-th line gives the coordinate $(x_i,y_i)$, separated by one space.", "outputFormat": "Output a number with two decimal places, representing the perimeter of the triangle formed by these three points.", "hint": "The testdata guarantees that all coordinates are real numbers and their absolute values do not exceed $100$, with at most $3$ digits after the decimal point.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.例1】距离函数", "background": null, "description": "给出平面坐标上不在一条直线上三个点坐标 $(x_1,y_1),(x_2,y_2),(x_3,y_3)$，坐标值是实数，且绝对值不超过 100.00，求围成的三角形周长。保留两位小数。\n\n对于平面上的两个点 $(x_1,y_1),(x_2,y_2)$，则这两个点之间的距离 $dis=\\sqrt{(x_2-x_1)^2+(y_2-y_1)^2}$。", "inputFormat": "输入三行，第 $i$ 行表示坐标 $(x_i,y_i)$，以一个空格隔开。", "outputFormat": "输出一个两位小数，表示由这三个坐标围成的三角形的周长。", "hint": "数据保证，坐标均为实数且绝对值不超过 $100$，小数点后最多仅有 $3$ 位。", "locale": "zh-CN"}}}
{"pid": "P5736", "type": "P", "difficulty": 2, "samples": [["5\n3 4 5 6 7", "3 5 7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基7.例2】质数筛", "background": "", "description": "输入 $n$ 个不大于 $10^5$ 的正整数。要求全部储存在数组中，去除掉不是质数的数字，依次输出剩余的质数。", "inputFormat": "第一行输入一个正整数 $n$，表示整数个数。\n\n第二行输入 $n$ 个正整数 $a_i$，以空格隔开。", "outputFormat": "输出一行，依次输出 $a_i$ 中剩余的质数，以空格隔开。", "hint": "数据保证，$1\\le n\\le100$，$1 \\leq a_i \\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Base 7.Example 2] Prime Sieve", "background": "", "description": "Input $n$ positive integers, each not greater than $10^5$. Store them all in an array, remove the numbers that are not prime, and output the remaining primes in order.", "inputFormat": "The first line contains a positive integer $n$, indicating the number of integers.\n\nThe second line contains $n$ positive integers $a_i$, separated by spaces.", "outputFormat": "Output one line: print the remaining primes in $a_i$ in order, separated by spaces.", "hint": "Constraints: $1 \\le n \\le 100$, $1 \\leq a_i \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.例2】质数筛", "background": "", "description": "输入 $n$ 个不大于 $10^5$ 的正整数。要求全部储存在数组中，去除掉不是质数的数字，依次输出剩余的质数。", "inputFormat": "第一行输入一个正整数 $n$，表示整数个数。\n\n第二行输入 $n$ 个正整数 $a_i$，以空格隔开。", "outputFormat": "输出一行，依次输出 $a_i$ 中剩余的质数，以空格隔开。", "hint": "数据保证，$1\\le n\\le100$，$1 \\leq a_i \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5737", "type": "P", "difficulty": 1, "samples": [["1989 2001", "3\n1992 1996 2000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基7.例3】闰年展示", "background": "", "description": "输入 $x,y$，输出 $[x,y]$ 区间中闰年个数，并在下一行输出所有闰年年份数字，使用空格隔开。", "inputFormat": "输入两个正整数 $x,y$，以空格隔开。", "outputFormat": "第一行输出一个正整数，表示 $[x,y]$ 区间中闰年个数。\n\n第二行输出若干个正整数，按照年份单调递增的顺序输出所有闰年年份数字。", "hint": "数据保证，$1582\\le x < y \\le 3000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 7. Example 3] Leap Year Display", "background": "", "description": "Given $x, y$, output the number of leap years in the interval $[x, y]$, and on the next line output all leap year numbers, separated by spaces.", "inputFormat": "Input two positive integers $x, y$, separated by a space.", "outputFormat": "On the first line, output a positive integer representing the number of leap years in the interval $[x, y]$.\n\nOn the second line, output several positive integers: all leap year numbers in monotonically increasing order by year.", "hint": "Constraints: the testdata guarantees that $1582 \\le x < y \\le 3000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.例3】闰年展示", "background": "", "description": "输入 $x,y$，输出 $[x,y]$ 区间中闰年个数，并在下一行输出所有闰年年份数字，使用空格隔开。", "inputFormat": "输入两个正整数 $x,y$，以空格隔开。", "outputFormat": "第一行输出一个正整数，表示 $[x,y]$ 区间中闰年个数。\n\n第二行输出若干个正整数，按照年份单调递增的顺序输出所有闰年年份数字。", "hint": "数据保证，$1582\\le x < y \\le 3000$。", "locale": "zh-CN"}}}
{"pid": "P5738", "type": "P", "difficulty": 2, "samples": [["7 6\n4 7 2 6 10 7\n0 5 0 10 3 10\n2 6 8 4 3 6\n6 3 6 7 5 8\n5 9 3 3 8 1\n5 9 9 3 2 0\n5 8 0 4 1 10\n", "6.00"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基7.例4】歌唱比赛", "background": "", "description": "$n(n\\le 100)$ 名同学参加歌唱比赛，并接受 $m(m\\le 20)$ 名评委的评分，评分范围是 $0$ 到 $10$ 分。这名同学的得分就是这些评委给分中去掉一个最高分，去掉一个最低分，剩下 $m-2$ 个评分的平均数。请问得分最高的同学分数是多少？评分保留 $2$ 位小数。", "inputFormat": "第一行两个整数 $n,m$。   \n接下来 $n$ 行，每行各 $m$ 个整数，表示得分。", "outputFormat": "输出分数最高的同学的分数，保留两位小数。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics 7. Example 4] Singing Contest", "background": "", "description": "$n(n\\le 100)$ students take part in a singing contest and receive scores from $m(m\\le 20)$ judges. The score range is from $0$ to $10$. A student’s final score is obtained by removing the highest score and the lowest score among the judges’ scores, then taking the average of the remaining $m-2$ scores. What is the highest final score among all students? Keep the score to $2$ decimal places.", "inputFormat": "The first line contains two integers $n,m$.  \nThe next $n$ lines each contain $m$ integers, representing the scores.", "outputFormat": "Output the highest final score among the students, rounded to two decimal places.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.例4】歌唱比赛", "background": "", "description": "$n(n\\le 100)$ 名同学参加歌唱比赛，并接受 $m(m\\le 20)$ 名评委的评分，评分范围是 $0$ 到 $10$ 分。这名同学的得分就是这些评委给分中去掉一个最高分，去掉一个最低分，剩下 $m-2$ 个评分的平均数。请问得分最高的同学分数是多少？评分保留 $2$ 位小数。", "inputFormat": "第一行两个整数 $n,m$。   \n接下来 $n$ 行，每行各 $m$ 个整数，表示得分。", "outputFormat": "输出分数最高的同学的分数，保留两位小数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5739", "type": "P", "difficulty": 1, "samples": [["3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基7.例7】计算阶乘", "background": "", "description": "求 $n!$，也就是 $1\\times2\\times3\\dots\\times n$。\n\n挑战：尝试不使用循环语句（for、while）完成这个任务。", "inputFormat": "第一行输入一个正整数 $n$。", "outputFormat": "输出一个正整数，表示 $n!$。", "hint": "数据保证，$1 \\leq n\\le12$。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 7. Example 7] Calculate the Factorial", "background": "", "description": "Find $n!$, that is, $1 \\times 2 \\times 3 \\dots \\times n$.\n\nChallenge: Try to complete this task without using loop statements (for, while).", "inputFormat": "The first line contains a positive integer $n$.", "outputFormat": "Output a positive integer, representing $n!$.", "hint": "Constraints: It is guaranteed that $1 \\leq n \\le 12$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.例7】计算阶乘", "background": "", "description": "求 $n!$，也就是 $1\\times2\\times3\\dots\\times n$。\n\n挑战：尝试不使用循环语句（for、while）完成这个任务。", "inputFormat": "第一行输入一个正整数 $n$。", "outputFormat": "输出一个正整数，表示 $n!$。", "hint": "数据保证，$1 \\leq n\\le12$。", "locale": "zh-CN"}}}
{"pid": "P5740", "type": "P", "difficulty": 2, "samples": [["3\nsenpai 114 51 4\nlxl 114 10 23\nfafa 51 42 60", "senpai 114 51 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "【深基7.例9】最厉害的学生", "background": "", "description": "现有 $N$ 名同学参加了期末考试，并且获得了每名同学的信息：姓名（不超过 $8$ 个字符的仅有英文小写字母的字符串）、语文、数学、英语成绩（均为不超过 $150$ 的自然数）。总分最高的学生就是最厉害的，请输出最厉害的学生各项信息（姓名、各科成绩）。如果有多个总分相同的学生，输出靠前的那位。", "inputFormat": "第一行输入一个正整数 $N$，表示学生个数。\n\n第二行开始，往下 $N$ 行，对于每一行首先先输入一个字符串表示学生姓名，再输入三个自然数表示语文、数学、英语的成绩。均用空格相隔。", "outputFormat": "输出最厉害的学生。", "hint": "数据保证，$1 \\leq N \\leq 1000$，姓名为长度不超过 $8$ 的字符串，语文、数学、英语成绩均为不超过 $150$ 的自然数。", "locale": "zh-CN", "translations": {"en": {"title": "【Shenji 7. Example 9】The Best Student.", "background": "", "description": "There are $N$ students taking the final exam, and you are given each student's information: name (a string of at most $8$ characters, consisting only of lowercase English letters), and scores in Chinese, Math, and English (all natural numbers not exceeding $150$). The student with the highest total score is the best. Please output the best student's information (name and scores for each subject). If there are multiple students with the same total score, output the one that appears earlier.", "inputFormat": "The first line contains a positive integer $N$, representing the number of students.\n\nStarting from the second line, there are $N$ lines. In each line, first input a string representing the student's name, then input three natural numbers representing the scores of Chinese, Math, and English. They are separated by spaces.", "outputFormat": "Output the best student.", "hint": "It is guaranteed that $1 \\leq N \\leq 1000$. The name is a string of length at most $8$, and the scores of Chinese, Math, and English are all natural numbers not exceeding $150$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.例9】最厉害的学生", "background": "", "description": "现有 $N$ 名同学参加了期末考试，并且获得了每名同学的信息：姓名（不超过 $8$ 个字符的仅有英文小写字母的字符串）、语文、数学、英语成绩（均为不超过 $150$ 的自然数）。总分最高的学生就是最厉害的，请输出最厉害的学生各项信息（姓名、各科成绩）。如果有多个总分相同的学生，输出靠前的那位。", "inputFormat": "第一行输入一个正整数 $N$，表示学生个数。\n\n第二行开始，往下 $N$ 行，对于每一行首先先输入一个字符串表示学生姓名，再输入三个自然数表示语文、数学、英语的成绩。均用空格相隔。", "outputFormat": "输出最厉害的学生。", "hint": "数据保证，$1 \\leq N \\leq 1000$，姓名为长度不超过 $8$ 的字符串，语文、数学、英语成绩均为不超过 $150$ 的自然数。", "locale": "zh-CN"}}}
{"pid": "P5741", "type": "P", "difficulty": 2, "samples": [["3\nfafa 90 90 90\nlxl 95 85 90\nsenpai 100 80 91", "fafa lxl\nlxl senpai\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基7.例10】旗鼓相当的对手 - 加强版", "background": "", "description": "现有 $N(N\\le 1000)$ 名同学参加了期末考试，并且获得了每名同学的信息：姓名（不超过 $8$ 个字符的字符串，没有空格）、语文、数学、英语成绩（均为不超过 $150$ 的自然数）。如果某对学生 $\\text{<}i,j\\text{>}$ 的每一科成绩的分差都不大于 $5$，且总分分差不大于 $10$，那么这对学生就是“旗鼓相当的对手”。现在我们想知道这些同学中，哪些是“旗鼓相当的对手”？请输出他们的姓名。\n\n所有人的姓名是按照字典序给出的，输出时也应该按照字典序输出所有对手组合。也就是说，这对组合的第一个名字的字典序应该小于第二个；如果两个组合中第一个名字不一样，则第一个名字字典序小的先输出；如果两个组合的第一个名字一样但第二个名字不同，则第二个名字字典序小的先输出。", "inputFormat": "第一行输入一个正整数 $N$，表示学生个数。\n\n第二行开始，往下 $N$ 行，对于每一行首先先输入一个字符串表示学生姓名，再输入三个自然数表示语文、数学、英语的成绩。均用空格相隔。", "outputFormat": "输出若干行，每行两个以空格隔开的字符串，表示一组旗鼓相当的对手。注意题目描述中的输出格式。", "hint": "数据保证，$1 \\leq N \\leq 1000$，姓名为长度不超过 $8$ 的字符串，语文、数学、英语成绩均为不超过 $150$ 的自然数。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 7.Example 10] Evenly Matched Opponents - Enhanced Version.", "background": "", "description": "There are $N(N\\le 1000)$ students taking the final exam, and we are given each student's information: name (a string of no more than $8$ characters, with no spaces), and scores in Chinese, Math, and English (all natural numbers not exceeding $150$). If for a pair of students $\\text{<}i,j\\text{>}$, the score difference in each subject is no more than $5$, and the total score difference is no more than $10$, then this pair of students are \"evenly matched opponents\". Now we want to know, among these students, which pairs are \"evenly matched opponents\". Please output their names.\n\nAll names are given in lexicographical order, and when outputting, all opponent pairs should also be printed in lexicographical order. That is, for each pair, the lexicographical order of the first name should be smaller than the second. If the first names of two pairs are different, output the pair with the smaller first name first. If two pairs have the same first name but different second names, output the pair with the smaller second name first.", "inputFormat": "The first line contains a positive integer $N$, representing the number of students.\n\nStarting from the second line, the next $N$ lines follow. In each line, first input a string representing the student's name, then input three natural numbers representing the scores in Chinese, Math, and English. They are separated by spaces.", "outputFormat": "Output several lines. Each line contains two strings separated by a space, representing a pair of evenly matched opponents. Note the output ordering described in the problem statement.", "hint": "Constraints: $1 \\leq N \\leq 1000$. Names are strings of length at most $8$. Scores in Chinese, Math, and English are all natural numbers not exceeding $150$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.例10】旗鼓相当的对手 - 加强版", "background": "", "description": "现有 $N(N\\le 1000)$ 名同学参加了期末考试，并且获得了每名同学的信息：姓名（不超过 $8$ 个字符的字符串，没有空格）、语文、数学、英语成绩（均为不超过 $150$ 的自然数）。如果某对学生 $\\text{<}i,j\\text{>}$ 的每一科成绩的分差都不大于 $5$，且总分分差不大于 $10$，那么这对学生就是“旗鼓相当的对手”。现在我们想知道这些同学中，哪些是“旗鼓相当的对手”？请输出他们的姓名。\n\n所有人的姓名是按照字典序给出的，输出时也应该按照字典序输出所有对手组合。也就是说，这对组合的第一个名字的字典序应该小于第二个；如果两个组合中第一个名字不一样，则第一个名字字典序小的先输出；如果两个组合的第一个名字一样但第二个名字不同，则第二个名字字典序小的先输出。", "inputFormat": "第一行输入一个正整数 $N$，表示学生个数。\n\n第二行开始，往下 $N$ 行，对于每一行首先先输入一个字符串表示学生姓名，再输入三个自然数表示语文、数学、英语的成绩。均用空格相隔。", "outputFormat": "输出若干行，每行两个以空格隔开的字符串，表示一组旗鼓相当的对手。注意题目描述中的输出格式。", "hint": "数据保证，$1 \\leq N \\leq 1000$，姓名为长度不超过 $8$ 的字符串，语文、数学、英语成绩均为不超过 $150$ 的自然数。", "locale": "zh-CN"}}}
{"pid": "P5742", "type": "P", "difficulty": 2, "samples": [["4\n1223 95 59\n1224 50 7\n1473 32 45\n1556 86 99", "Excellent\nNot excellent\nNot excellent\nExcellent"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "【深基7.例11】评等级", "background": "", "description": "现有 $N$ 名同学，每名同学需要设计一个结构体记录以下信息：学号、学业成绩和素质拓展成绩、综合分数（实数）。每行读入同学的学号、学业成绩和素质拓展成绩，并且计算综合分数（分别按照 $70\\%$ 和 $30\\%$ 权重累加），存入结构体中。还需要在结构体中定义一个成员函数，返回该结构体对象的学业成绩和素质拓展成绩的总分。\n\n然后需要设计一个函数，其参数是一个学生结构体对象，判断该学生是否“优秀”。优秀的定义是学业和素质拓展成绩总分**大于** $140$ 分，且综合分数**不小于** $80$ 分。\n\n> 当然通过本题很容易啦，本题只是为了帮助你训练结构体的使用方法。\n\n本题存在精度误差问题，请将 `a * 0.7 + b * 0.3` 与 80 比较 转化为 `a * 7 + b * 3` 与 800 比较。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行 $3$ 个整数，依次代表学号、学业成绩和素质拓展成绩。", "outputFormat": "$N$ 行，如果第 $i$ 名学生是优秀的，输出 `Excellent`，否则输出 `Not excellent`。", "hint": "数据保证，$1 \\le N\\le 1000$，学号为不超过 $100000$ 的正整数，学业成绩和素质拓展成绩为 $0 \\sim 100$ 之间的正整数。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 7. Example 11] Rating Levels", "background": "", "description": "There are $N$ students. For each student, you need to design a struct to record the following information: student ID, academic score, quality development score, and overall score (a real number). For each line, read the student ID, academic score, and quality development score, and compute the overall score (accumulated with weights of $70\\%$ and $30\\%$, respectively), then store everything in the struct. You also need to define a member function in the struct that returns the total score of the academic score and the quality development score for that struct object.\n\nThen design a function whose parameter is a student struct object, and determine whether the student is \"Excellent\". The definition of Excellent is: the total of academic and quality development scores is **greater than** $140$, and the overall score is **not less than** $80$.\n\n> Of course, this problem is easy to pass. It is only meant to help you practice how to use structs.\n\nThis problem has precision issues. Please convert comparing `a * 0.7 + b * 0.3` with 80 into comparing `a * 7 + b * 3` with 800.", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines each contain $3$ integers, which represent the student ID, the academic score, and the quality development score, in order.", "outputFormat": "Output $N$ lines. If the $i$-th student is Excellent, output `Excellent`; otherwise output `Not excellent`.", "hint": "Constraints: It is guaranteed that $1 \\le N\\le 1000$. The student ID is a positive integer not exceeding $100000$. The academic score and the quality development score are positive integers between $0$ and $100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.例11】评等级", "background": "", "description": "现有 $N$ 名同学，每名同学需要设计一个结构体记录以下信息：学号、学业成绩和素质拓展成绩、综合分数（实数）。每行读入同学的学号、学业成绩和素质拓展成绩，并且计算综合分数（分别按照 $70\\%$ 和 $30\\%$ 权重累加），存入结构体中。还需要在结构体中定义一个成员函数，返回该结构体对象的学业成绩和素质拓展成绩的总分。\n\n然后需要设计一个函数，其参数是一个学生结构体对象，判断该学生是否“优秀”。优秀的定义是学业和素质拓展成绩总分**大于** $140$ 分，且综合分数**不小于** $80$ 分。\n\n> 当然通过本题很容易啦，本题只是为了帮助你训练结构体的使用方法。\n\n本题存在精度误差问题，请将 `a * 0.7 + b * 0.3` 与 80 比较 转化为 `a * 7 + b * 3` 与 800 比较。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行 $3$ 个整数，依次代表学号、学业成绩和素质拓展成绩。", "outputFormat": "$N$ 行，如果第 $i$ 名学生是优秀的，输出 `Excellent`，否则输出 `Not excellent`。", "hint": "数据保证，$1 \\le N\\le 1000$，学号为不超过 $100000$ 的正整数，学业成绩和素质拓展成绩为 $0 \\sim 100$ 之间的正整数。", "locale": "zh-CN"}}}
{"pid": "P5743", "type": "P", "difficulty": 1, "samples": [["4", "22\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基7.习8】猴子吃桃", "background": "", "description": "一只小猴买了若干个桃子。第一天他刚好吃了这些桃子的一半，又贪嘴多吃了一个；接下来的每一天它都会吃剩余的桃子的一半外加一个。第 $n$ 天早上起来一看，只剩下 $1$ 个桃子了。请问小猴买了几个桃子？", "inputFormat": "输入一个正整数 $n$，表示天数。", "outputFormat": "输出小猴买了多少个桃子。", "hint": "数据保证，$1\\le n\\le20$。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basis 7. Exercise 8] Monkey Eating Peaches", "background": "", "description": "A little monkey bought some peaches. On the first day, it ate exactly half of the peaches, and then, being greedy, ate one more. On each following day, it eats half of the remaining peaches plus one more. On the morning of day $n$, it finds that only $1$ peach is left. How many peaches did the monkey buy?", "inputFormat": "Input one positive integer $n$, representing the number of days.", "outputFormat": "Output how many peaches the monkey bought.", "hint": "Constraints: $1\\le n\\le20$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.习8】猴子吃桃", "background": "", "description": "一只小猴买了若干个桃子。第一天他刚好吃了这些桃子的一半，又贪嘴多吃了一个；接下来的每一天它都会吃剩余的桃子的一半外加一个。第 $n$ 天早上起来一看，只剩下 $1$ 个桃子了。请问小猴买了几个桃子？", "inputFormat": "输入一个正整数 $n$，表示天数。", "outputFormat": "输出小猴买了多少个桃子。", "hint": "数据保证，$1\\le n\\le20$。", "locale": "zh-CN"}}}
{"pid": "P5744", "type": "P", "difficulty": 1, "samples": [["3\nkkksc03 24 0\nchen_zhe 14 400\nnzhtl1477 18 590", "kkksc03 25 0\nchen_zhe 15 480\nnzhtl1477 19 600"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基7.习9】培训", "background": "", "description": "某培训机构的学员有如下信息：\n\n- 姓名（字符串）\n- 年龄（周岁，整数）\n- 去年 NOIP 成绩（整数，且保证是 $5$ 的倍数）\n\n经过为期一年的培训，所有同学的成绩都有所提高，提升了 $20\\%$（当然 NOIP 满分是 $600$ 分，不能超过这个得分）。\n\n输入学员信息，请设计一个结构体储存这些学生信息，并设计一个函数模拟培训过程，其参数是这样的结构体类型，返回同样的结构体类型，并输出学员信息。", "inputFormat": "第一行输入一个正整数 $n$，表示学员个数。\n\n第二行开始往下 $n$ 行。每行首先是一个字符串表示学员姓名，再是一个整数表示学员年龄，再是一个整数为去年 NOIP 成绩。", "outputFormat": "输出 $n$ 行，每行首先输出一个字符串表示学生姓名，再往后两个整数，表示经过一年的培训后学员的年龄和他们今年的 NOIP 成绩。以空格隔开。", "hint": "数据保证，$1 \\leq n \\leq 5$。年龄为 $0 \\sim 100$（含 $0$ 与 $100$）的整数。成绩为 $0 \\sim 600$（含 $0$ 与 $600$）的 $5$ 的整倍数。", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 7. Exercise 9] Training", "background": "", "description": "The students in a training institution have the following information:\n\n- Name (string).\n- Age (in full years, integer).\n- Last year's NOIP score (integer, and guaranteed to be a multiple of $5$).\n\nAfter one year of training, all students' scores have improved by $20\\%$ (of course, the full score of NOIP is $600$, so the score cannot exceed this value).\n\nGiven the students' information, please design a struct to store this student information, and design a function to simulate the training process. The parameter is this struct type, and it returns the same struct type, and outputs the student information.", "inputFormat": "The first line contains a positive integer $n$, representing the number of students.\n\nStarting from the second line, there are $n$ lines. Each line first contains a string representing the student's name, then an integer representing the student's age, and then an integer representing last year's NOIP score.", "outputFormat": "Output $n$ lines. Each line first outputs a string representing the student's name, followed by two integers representing the student's age after one year of training and their NOIP score this year. Separate them with spaces.", "hint": "Constraints: $1 \\leq n \\leq 5$. The age is an integer from $0 \\sim 100$ (including $0$ and $100$). The score is a multiple of $5$ in the range $0 \\sim 600$ (including $0$ and $600$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基7.习9】培训", "background": "", "description": "某培训机构的学员有如下信息：\n\n- 姓名（字符串）\n- 年龄（周岁，整数）\n- 去年 NOIP 成绩（整数，且保证是 $5$ 的倍数）\n\n经过为期一年的培训，所有同学的成绩都有所提高，提升了 $20\\%$（当然 NOIP 满分是 $600$ 分，不能超过这个得分）。\n\n输入学员信息，请设计一个结构体储存这些学生信息，并设计一个函数模拟培训过程，其参数是这样的结构体类型，返回同样的结构体类型，并输出学员信息。", "inputFormat": "第一行输入一个正整数 $n$，表示学员个数。\n\n第二行开始往下 $n$ 行。每行首先是一个字符串表示学员姓名，再是一个整数表示学员年龄，再是一个整数为去年 NOIP 成绩。", "outputFormat": "输出 $n$ 行，每行首先输出一个字符串表示学生姓名，再往后两个整数，表示经过一年的培训后学员的年龄和他们今年的 NOIP 成绩。以空格隔开。", "hint": "数据保证，$1 \\leq n \\leq 5$。年龄为 $0 \\sim 100$（含 $0$ 与 $100$）的整数。成绩为 $0 \\sim 600$（含 $0$ 与 $600$）的 $5$ 的整倍数。", "locale": "zh-CN"}}}
{"pid": "P5745", "type": "P", "difficulty": 2, "samples": [["5 10\n2 3 4 5 6", "1 3 9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "双指针 two-pointer"], "title": "【深基附B例】区间最大和", "background": "", "description": "给定 $n$ 个正整数组成的数列 $a_1, a_2, \\cdots, a_n$ 和一个整数 $m$。求出这个数列中的一个子区间 $[i, j]$，也就是在这个数列中连续的数字 $a_i, a_{i + 1}, \\cdots, a_{j - 1}, a_j$，使得这个子区间的和在不超过 $m$ 的情况下最大。如果有多个区间符合要求，请输出 $i$ 最小的那一个。", "inputFormat": "输入共两行。\n\n第一行，两个整数 $n, m$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$。", "outputFormat": "一行，三个整数，表示符合题意的区间的左端点、右端点和累加和。", "hint": "**子任务 1**（10分）：$n\\le 200$ ；\n\n**子任务 2**（20分）：$n\\le 3000$ ；\n\n**子任务 3**（30分）：$n\\le 10^5$ ；\n\n**子任务 4**（40分）：$n\\le 4\\times 10^6$ 。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 4 \\times 10^6$，$1 \\leq m \\leq 10^9$，$0 \\leq a_1, a_2, \\cdots, a_n \\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics Appendix B Example] Maximum Interval Sum", "background": "", "description": "Given a sequence of $n$ positive integers $a_1, a_2, \\cdots, a_n$ and an integer $m$, find a subinterval $[i, j]$, that is, a consecutive part of the sequence $a_i, a_{i + 1}, \\cdots, a_{j - 1}, a_j$, such that the sum of this subinterval is as large as possible while not exceeding $m$. If multiple intervals meet the requirement, output the one with the smallest $i$.", "inputFormat": "The input has two lines.\n\nThe first line contains two integers $n, m$.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$.", "outputFormat": "Output one line with three integers, representing the left endpoint, the right endpoint, and the cumulative sum of the interval that meets the requirement.", "hint": "**Subtask 1** (10 points): $n \\le 200$.\n\n**Subtask 2** (20 points): $n \\le 3000$.\n\n**Subtask 3** (30 points): $n \\le 10^5$.\n\n**Subtask 4** (40 points): $n \\le 4 \\times 10^6$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 4 \\times 10^6$, $1 \\leq m \\leq 10^9$, $0 \\leq a_1, a_2, \\cdots, a_n \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基附B例】区间最大和", "background": "", "description": "给定 $n$ 个正整数组成的数列 $a_1, a_2, \\cdots, a_n$ 和一个整数 $m$。求出这个数列中的一个子区间 $[i, j]$，也就是在这个数列中连续的数字 $a_i, a_{i + 1}, \\cdots, a_{j - 1}, a_j$，使得这个子区间的和在不超过 $m$ 的情况下最大。如果有多个区间符合要求，请输出 $i$ 最小的那一个。", "inputFormat": "输入共两行。\n\n第一行，两个整数 $n, m$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$。", "outputFormat": "一行，三个整数，表示符合题意的区间的左端点、右端点和累加和。", "hint": "**子任务 1**（10分）：$n\\le 200$ ；\n\n**子任务 2**（20分）：$n\\le 3000$ ；\n\n**子任务 3**（30分）：$n\\le 10^5$ ；\n\n**子任务 4**（40分）：$n\\le 4\\times 10^6$ 。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 4 \\times 10^6$，$1 \\leq m \\leq 10^9$，$0 \\leq a_1, a_2, \\cdots, a_n \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5746", "type": "P", "difficulty": 4, "samples": [["3\n2 1\n3 2\n5 1", "8\n6\n75"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2002", "NOI", "Special Judge"], "title": "[NOI2002] 机器人M号", "background": "", "description": "3030 年，Macsy 正在火星部署一批机器人。\n\n第 $1$ 秒，他把机器人 $1$ 号运到了火星，机器人 $1$ 号可以制造其他的机器人。\n\n第 $2$ 秒，机器人 $1$ 号造出了第一个机器人——机器人 $2$ 号。\n\n第 $3$ 秒，机器人 $1$ 号造出了另一个机器人——机器人 $3$ 号。\n\n之后每一秒，机器人 $1$ 号都可以造出一个新的机器人。第 $m$ 秒造出的机器人编号为 $m$。我们可以称它为机器人 $m$ 号，或者 $m$ 号机器人。\n\n机器人造出来后，马上开始工作。$m$ 号机器人，每 $m$ 秒会休息一次。比如 $3$ 号机器人，会在第 $6$，$9$，$12$，$\\ldots$ 秒休息，而其它时间都在工作。\n\n机器人休息时，它的记忆将会被移植到当时出生的机器人的脑中。比如 $6$ 号机器人出生时，$2$，$3$ 号机器人正在休息，因此，$6$ 号机器人会收到第 $2$，$3$ 号机器人的记忆副本。我们称第 $2$，$3$ 号机器人是 $6$ 号机器人的老师。\n\n如果两个机器人没有师徒关系，且没有共同的老师，则称这两个机器人的知识是互相独立的。**注意：$1$ 号机器人与其他所有机器人的知识独立（因为只有 $1$ 号才会造机器人），它也不是任何机器人的老师。**\n\n一个机器人的**独立数**，是指所有编号比它小且与它知识互相独立的机器人的个数。比如 $1$ 号机器人的独立数为 $0$，$2$ 号机器人的独立数为 $1$（$1$ 号机器人与它知识互相独立），$6$ 号机器人的独立数为 $2$（$1$，$5$ 号机器人与它知识互相独立，$2$，$3$ 号机器人都是它的老师，而 $4$ 号机器人与它有共同的老师——$2$ 号机器人）。\n\n新造出来的机器人有 $3$ 种不同的职业。对于编号为 $m$ 的机器人，如果能把 $m$ 分解成偶数个不同奇素数的积，则它是政客，例如编号 $15$；否则，如果 $m$ 本身就是奇素数或者能把 $m$ 分解成奇数个不同奇素数的积，则它是军人，例如编号 $3$，编号 $165$。其它编号的机器人都是学者，例如编号 $2$, 编号 $6$, 编号 $9$。\n\n第 $m$ 秒诞生的机器人 $m$ 号，想知道它和它的老师中，所有政客的独立数之和，所有军人的独立数之和，以及所有学者的独立数之和。可机器人 $m$ 号忙于工作没时间计算，你能够帮助它吗？\n\n为了方便你的计算，Macsy 已经帮你做了 $m$ 的素因子分解。为了输出方便，只要求输出总和除以 $10000$ 的余数。", "inputFormat": "输入的第一行是一个正整数 $k$，$k$ 是 $m$ 的不同的素因子个数。\n\n以下 $k$ 行，每行两个整数，$p_i$, $e_i$,表示 $m$ 的第 $i$ 个素因子和它的指数 $(i=1,2,\\ldots,k)$。$p_1,p_2,\\ldots,p_k$ 是不同的素数，$\\prod_{i=1}^kp_i^{e_i}$。所有素因子按照从小到大排列，即 $p_1<p_2<\\ldots<p_k$。", "outputFormat": "输出包括三行。\n\n- 第一行是机器人 $m$ 号和它的老师中，所有政客的独立数之和除以 $10000$ 的余数。\n- 第二行是机器人 $m$ 号和它的老师中，所有军人的独立数之和除以 $10000$ 的余数。\n- 第三行是机器人 $m$ 号和它的老师中，所有学者的独立数之和除以 $10000$ 的余数。", "hint": "#### 样例解释\n$m = 2\\times 3^2\\times 5=90$。$90$ 号机器人有 $10$ 个老师，加上它自己共 $11$ 个。其中政客只有 $15$ 号；军人有 $3$ 号和 $5$ 号；学者有 $8$ 个，它们的编号分别是：$2,6,9,10,18,30,45,90$。\n\n#### 数据范围\n对于全部的数据，$1\\le k\\le 1000$，$2\\le p_i<10,000$，$1\\le e_i\\le 1,000,000$。\n\n#### 评分规则\n\n你在一个测试点的得分与你正确解决的问题数 $x$ 有关。\n\n请注意：**对每一行，即使不会解决该问题，也请在该行输出一个数字，否则 checker 将无法正确评分。**\n\n| $x$  | 得分 |\n| :--: | :--: |\n|  3   |  10  |\n|  2   |  7   |\n|  1   |  4   |\n|  0   |  0   |", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2002] Robot No. M", "background": "", "description": "In the year 3030, Macsy is deploying a batch of robots on Mars.\n\nAt the $1$st second, he shipped robot No. $1$ to Mars. Robot No. $1$ can manufacture other robots.\n\nAt the $2$nd second, robot No. $1$ built the first robot—robot No. $2$.\n\nAt the $3$rd second, robot No. $1$ built another robot—robot No. $3$.\n\nAfter that, every second, robot No. $1$ can build one new robot. The robot built at the $m$-th second has index $m$. We call it robot No. $m$, or the $m$-th robot.\n\nAfter a robot is built, it starts working immediately. Robot No. $m$ rests once every $m$ seconds. For example, robot No. $3$ rests at the $6$th, $9$th, $12$th, $\\ldots$ seconds, and works at all other times.\n\nWhen a robot rests, its memory will be transplanted into the brain of the robot born at that moment. For example, when robot No. $6$ is born, robots No. $2$ and No. $3$ are resting, so robot No. $6$ receives copies of the memories of robots No. $2$ and No. $3$. We call robots No. $2$ and No. $3$ the teachers of robot No. $6$.\n\nIf two robots do not have a teacher-student relationship, and they do not share any common teacher, then we say the knowledge of these two robots is mutually independent. **Note: the knowledge of robot No. $1$ is independent of all other robots (because only robot No. $1$ builds robots), and it is not any robot’s teacher.**\n\nThe **independence number** of a robot is the number of robots with smaller indices whose knowledge is mutually independent from it. For example, the independence number of robot No. $1$ is $0$; the independence number of robot No. $2$ is $1$ (robot No. $1$ is mutually independent from it); the independence number of robot No. $6$ is $2$ (robots No. $1$ and No. $5$ are mutually independent from it; robots No. $2$ and No. $3$ are its teachers; and robot No. $4$ shares a common teacher—robot No. $2$—with it).\n\nNewly built robots have $3$ different professions. For a robot with index $m$, if $m$ can be factored into a product of an even number of distinct odd primes, then it is a politician, for example index $15$; otherwise, if $m$ itself is an odd prime, or $m$ can be factored into a product of an odd number of distinct odd primes, then it is a soldier, for example index $3$ and index $165$. Robots with other indices are scholars, for example index $2$, index $6$, and index $9$.\n\nRobot No. $m$, born at the $m$-th second, wants to know: among itself and its teachers, the sum of the independence numbers of all politicians, the sum of the independence numbers of all soldiers, and the sum of the independence numbers of all scholars. But robot No. $m$ is busy working and has no time to compute. Can you help it?\n\nTo make computation easier, Macsy has already factored $m$ into primes for you. To make output easier, you only need to output the remainder after dividing each sum by $10000$.", "inputFormat": "The first line contains a positive integer $k$, where $k$ is the number of distinct prime factors of $m$.\n\nThe next $k$ lines each contain two integers $p_i$, $e_i$, representing the $i$-th prime factor of $m$ and its exponent $(i=1,2,\\ldots,k)$. $p_1,p_2,\\ldots,p_k$ are distinct primes, and $m=\\prod_{i=1}^k p_i^{e_i}$. All prime factors are given in increasing order, i.e. $p_1<p_2<\\ldots<p_k$.", "outputFormat": "Output consists of three lines.\n\n- The first line is the remainder after dividing by $10000$ the sum of the independence numbers of all politicians among robot No. $m$ and its teachers.\n- The second line is the remainder after dividing by $10000$ the sum of the independence numbers of all soldiers among robot No. $m$ and its teachers.\n- The third line is the remainder after dividing by $10000$ the sum of the independence numbers of all scholars among robot No. $m$ and its teachers.", "hint": "#### Sample Explanation\n\n$m = 2\\times 3^2\\times 5=90$. Robot No. $90$ has $10$ teachers; together with itself there are $11$ robots. Among them, the only politician is robot No. $15$; the soldiers are robot No. $3$ and robot No. $5$; there are $8$ scholars, with indices: $2,6,9,10,18,30,45,90$.\n\n#### Constraints\n\nFor all testdata, $1\\le k\\le 1000$, $2\\le p_i<10,000$, $1\\le e_i\\le 1,000,000$.\n\n#### Scoring Rules\n\nYour score on a test point depends on the number of subproblems you solve correctly, denoted by $x$.\n\nPlease note: **for each line, even if you cannot solve that part, you must still output a number on that line; otherwise the checker cannot score correctly.**\n\n| $x$  | Score |\n| :--: | :--: |\n|  3   |  10  |\n|  2   |  7   |\n|  1   |  4   |\n|  0   |  0   |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2002] 机器人M号", "background": "", "description": "3030 年，Macsy 正在火星部署一批机器人。\n\n第 $1$ 秒，他把机器人 $1$ 号运到了火星，机器人 $1$ 号可以制造其他的机器人。\n\n第 $2$ 秒，机器人 $1$ 号造出了第一个机器人——机器人 $2$ 号。\n\n第 $3$ 秒，机器人 $1$ 号造出了另一个机器人——机器人 $3$ 号。\n\n之后每一秒，机器人 $1$ 号都可以造出一个新的机器人。第 $m$ 秒造出的机器人编号为 $m$。我们可以称它为机器人 $m$ 号，或者 $m$ 号机器人。\n\n机器人造出来后，马上开始工作。$m$ 号机器人，每 $m$ 秒会休息一次。比如 $3$ 号机器人，会在第 $6$，$9$，$12$，$\\ldots$ 秒休息，而其它时间都在工作。\n\n机器人休息时，它的记忆将会被移植到当时出生的机器人的脑中。比如 $6$ 号机器人出生时，$2$，$3$ 号机器人正在休息，因此，$6$ 号机器人会收到第 $2$，$3$ 号机器人的记忆副本。我们称第 $2$，$3$ 号机器人是 $6$ 号机器人的老师。\n\n如果两个机器人没有师徒关系，且没有共同的老师，则称这两个机器人的知识是互相独立的。**注意：$1$ 号机器人与其他所有机器人的知识独立（因为只有 $1$ 号才会造机器人），它也不是任何机器人的老师。**\n\n一个机器人的**独立数**，是指所有编号比它小且与它知识互相独立的机器人的个数。比如 $1$ 号机器人的独立数为 $0$，$2$ 号机器人的独立数为 $1$（$1$ 号机器人与它知识互相独立），$6$ 号机器人的独立数为 $2$（$1$，$5$ 号机器人与它知识互相独立，$2$，$3$ 号机器人都是它的老师，而 $4$ 号机器人与它有共同的老师——$2$ 号机器人）。\n\n新造出来的机器人有 $3$ 种不同的职业。对于编号为 $m$ 的机器人，如果能把 $m$ 分解成偶数个不同奇素数的积，则它是政客，例如编号 $15$；否则，如果 $m$ 本身就是奇素数或者能把 $m$ 分解成奇数个不同奇素数的积，则它是军人，例如编号 $3$，编号 $165$。其它编号的机器人都是学者，例如编号 $2$, 编号 $6$, 编号 $9$。\n\n第 $m$ 秒诞生的机器人 $m$ 号，想知道它和它的老师中，所有政客的独立数之和，所有军人的独立数之和，以及所有学者的独立数之和。可机器人 $m$ 号忙于工作没时间计算，你能够帮助它吗？\n\n为了方便你的计算，Macsy 已经帮你做了 $m$ 的素因子分解。为了输出方便，只要求输出总和除以 $10000$ 的余数。", "inputFormat": "输入的第一行是一个正整数 $k$，$k$ 是 $m$ 的不同的素因子个数。\n\n以下 $k$ 行，每行两个整数，$p_i$, $e_i$,表示 $m$ 的第 $i$ 个素因子和它的指数 $(i=1,2,\\ldots,k)$。$p_1,p_2,\\ldots,p_k$ 是不同的素数，$\\prod_{i=1}^kp_i^{e_i}$。所有素因子按照从小到大排列，即 $p_1<p_2<\\ldots<p_k$。", "outputFormat": "输出包括三行。\n\n- 第一行是机器人 $m$ 号和它的老师中，所有政客的独立数之和除以 $10000$ 的余数。\n- 第二行是机器人 $m$ 号和它的老师中，所有军人的独立数之和除以 $10000$ 的余数。\n- 第三行是机器人 $m$ 号和它的老师中，所有学者的独立数之和除以 $10000$ 的余数。", "hint": "#### 样例解释\n$m = 2\\times 3^2\\times 5=90$。$90$ 号机器人有 $10$ 个老师，加上它自己共 $11$ 个。其中政客只有 $15$ 号；军人有 $3$ 号和 $5$ 号；学者有 $8$ 个，它们的编号分别是：$2,6,9,10,18,30,45,90$。\n\n#### 数据范围\n对于全部的数据，$1\\le k\\le 1000$，$2\\le p_i<10,000$，$1\\le e_i\\le 1,000,000$。\n\n#### 评分规则\n\n你在一个测试点的得分与你正确解决的问题数 $x$ 有关。\n\n请注意：**对每一行，即使不会解决该问题，也请在该行输出一个数字，否则 checker 将无法正确评分。**\n\n| $x$  | 得分 |\n| :--: | :--: |\n|  3   |  10  |\n|  2   |  7   |\n|  1   |  4   |\n|  0   |  0   |", "locale": "zh-CN"}}}
{"pid": "P5747", "type": "P", "difficulty": 6, "samples": [["2 3\nWE\nNNS\n3 9\n1 4 2\n2\n1 3 2 1\n2 3 2 2", "possible\n9\nWW\nNNS"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "NOI", "Special Judge"], "title": "[NOI2004] 曼哈顿", "background": "", "description": "P 城是 M 国的著名旅游城市。在市长 G 先生的治理下，人民安居乐业，城市欣欣向荣。然而，G 市长并没有被自己的政绩冲昏头脑，他清醒地意识到城市的治理还存在着一些问题，其中之一就是交通问题。\n\nP 城有 $m$ 条横向街道和 $n$ 条纵向街道，横向街道横贯东西，纵向街道纵穿南北，构成了 P 城整齐的交通网络（如图1所示）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k1ei30qk.png)\n\n由于街道狭窄，每条街道都只允许单向行驶，单向行驶的方向是事先设定好了的。一条横向街道的行驶方向只能是向东或者向西，一条纵向街道的行驶方向只能是向南或者向北，逆向行驶是绝对禁止的。\n\n这项限制给交通带来了巨大的不便。如图 1，很多游人希望从宾馆前往购物中心，但限于街道的行驶方向，他们不得不绕一个大圈才能够到达。\n\n这个问题一直困扰着 G 市长，每天他都会收到不少游人的来信，抱怨P城不合理的交通设计。但由于街道数目过多，他和他的部下始终不能解决这个问题……\n\n令人高兴的是这个问题不久就可能得以解决。因为最近他们以重金聘请了著名的交通规划大师 B 先生，请他对 P 城的交通进行有效合理的改造。\n\nB 先生知道不能通过拓宽街道的方法解决问题，因为这样势必影响到街道两旁的旅游景点，这是大家都不希望看到的。于是他准备重新设计街道的行驶方向（整条街道的行驶方向），使之尽可能满足大家的要求。\n\nB 先生先把 P 城的街道编号，横向街道由北向南编号为 $1$，$2$，$\\ldots$，$m$，纵向街道由西向东编号为 $1$，$2$，$\\ldots$，$n$。这样任何一个十字路口的位置都可以用一对正整数来表示，第一个数是该路口所在的横向街道的编号，第二个数是它所在的纵向街道的编号，这对整数被称为该十字路口的坐标。比如图 1 中宾馆所在的十字路口的坐标是 $(2,3)$。\n经过长期调查，他整理出了游人们提得相对集中的一些要求。每条要求都可以写成如下的形式：从一个十字路口到另一个十字路口的最短路径的长度必须等于它们之间的曼哈顿距离。所谓曼哈顿距离是指两个十字路口在东西方向上的距离加上在南北方向上的距离，坐标分别为 $(x_1,y_1)$ 和 $(x_2,y_2)$ 的两个十字路口之间的曼哈顿距离为 $|x_1-x_2|+|y_1-y_2|$。\n\n好了，B 先生已经知道了 P 城目前所有街道的行驶方向和游人们提得相对集中的要求，他能不能重新设计街道的行驶方向，使之满足所有要求呢？\n\n另外，改变每条街道的行驶方向都有一定的工作量，工作量的大小因道路而异。B 先生不仅想找到一个可行的改造计划，而且还希望这个计划的总工作量尽可能小。你能帮帮他吗？\n", "inputFormat": "输入文件的第一行有两个正整数 $m$ 和 $n$，分别表示横向街道和纵向街道的数目。\n\n第二行是一个长度为 $m$ 的字符串，由北向南列出了 $m$ 条横向街道改造前的行驶方向。`E` 表示向东，`W` 表示向西。\n\n第三行是一个长度为 $n$ 的字符串，由西向东列出了 $n$ 条纵向街道改造前的行驶方向。`S` 表示向南，`N` 表示向北。\n\n第四行有 $m$ 个非负整数，由北向南列出了改变每条横向街道的行驶方向的工作量。\n\n第五行有 $n$ 个非负整数，由西向东列出了改变每条纵向街道的行驶方向的工作量。\n\n第六行是一个正整数 $k$，表示游人们提得相对集中的要求的数目。\n\n接下来的 $k$ 行，每行有四个正整数 $x_1$，$y_1$，$x_2$，$y_2$，表示一条要求。这条要求的内容是希望从坐标为 $(x_1,y_1)$ 的十字路口到坐标为 $(x_2,y_2)$ 的十字路口的最短路径的长度等于这两个路口之间的曼哈顿距离。", "outputFormat": "第一行是一个字符串，`possible` 或者 `impossible`。输出 `possible` 表示可以通过改变街道的行驶方向满足输入数据中的所有要求，输出 `impossible` 表示无论怎么设计都不可能满足输入数据中的所有要求。\n\n如果在第一行输出的是 `possible` 的话，在第二行输出一个整数，表示最小的总工作量，在第三行输出一个长度为 $m$ 的字符串，由北向南列出改造后的 $m$ 条横向街道的行驶方向，`E` 表示向东，`W` 表示向西，在第四行输出一个长度为 $n$ 的字符串，由西向东列出改造后的 $n$ 条纵向街道的行驶方向，`S` 表示向南，`N` 表示向北。", "hint": "#### 数据范围\n对于全部的数据，$m\\le 10$，$n\\le 100$，$k\\le 100$；改变一条街道的行驶方向的工作量不超过 $10000$。\n\n#### 评分方式\n- 如果你的输出文件的第一行是 `impossible`，\n  - 如果确实无解，则该测试点满分。\n  - 如果实际有解，则该测试点 $0$ 分。\n- 如果你的输出文件的第一行是 `possible`，\n  - 如果你的程序输出的方案不可行，则该测试点 $0$ 分。\n  - 如果你的程序输出的总工作量与实际总工作量不一致，则该测试点 $0$ 分。\n  - 如果你的程序输出的方案可行，但总工作量不是最小的，则该测试点 $4$ 分。\n  - 如果你的程序输出的方案可行，且总工作量最小，则该测试点满分。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2004] Manhattan", "background": "", "description": "City P is a famous tourist city in country M. Under Mayor Mr. G’s governance, people live and work in peace, and the city is thriving. However, Mayor G was not blinded by his achievements. He clearly realized that there were still some problems in managing the city, one of which was transportation.\n\nCity P has $m$ horizontal streets and $n$ vertical streets. The horizontal streets run from west to east, and the vertical streets run from north to south, forming a neat transportation network in City P (as shown in Figure 1).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k1ei30qk.png)\n\nBecause the streets are narrow, each street allows traffic in only one direction, and the direction is set in advance. A horizontal street can only go east or west, and a vertical street can only go south or north. Driving in the opposite direction is strictly forbidden.\n\nThis restriction causes great inconvenience to transportation. As in Figure 1, many tourists want to go from the hotel to the shopping center, but due to the street directions, they have to take a big detour to reach it.\n\nThis problem has been troubling Mayor G for a long time. Every day he receives many letters from tourists, complaining about City P’s unreasonable traffic design. But because there are too many streets, he and his staff have never been able to solve this problem.\n\nFortunately, this problem may be solved soon. Recently, they hired the famous traffic planning expert Mr. B with a large payment, asking him to carry out an effective and reasonable reconstruction of City P’s traffic.\n\nMr. B knows that widening streets cannot solve the problem, because that would inevitably affect the tourist attractions along the streets, which nobody wants to see. So he plans to redesign the driving direction of each street (the direction of the whole street), so as to satisfy people’s needs as much as possible.\n\nMr. B first numbered the streets of City P. The horizontal streets are numbered $1,2,\\ldots,m$ from north to south, and the vertical streets are numbered $1,2,\\ldots,n$ from west to east. Then, the position of any intersection can be represented by a pair of positive integers: the first number is the index of the horizontal street it lies on, and the second number is the index of the vertical street it lies on. This pair of integers is called the coordinate of the intersection. For example, in Figure 1, the coordinate of the intersection where the hotel is located is $(2,3)$.\n\nAfter a long investigation, he summarized some requirements that tourists mentioned most often. Each requirement can be written in the following form: the length of the shortest path from one intersection to another must be equal to the Manhattan distance between them. The so-called Manhattan distance is the distance in the east-west direction plus the distance in the north-south direction. For two intersections with coordinates $(x_1,y_1)$ and $(x_2,y_2)$, their Manhattan distance is $|x_1-x_2|+|y_1-y_2|$.\n\nNow, Mr. B already knows the current driving directions of all streets in City P and the tourists’ common requirements. Can he redesign the street directions to satisfy all requirements?\n\nAlso, changing the driving direction of each street requires some amount of work, and the amount varies by street. Mr. B not only wants to find a feasible reconstruction plan, but also hopes that the total amount of work is as small as possible. Can you help him?", "inputFormat": "The first line contains two positive integers $m$ and $n$, representing the numbers of horizontal streets and vertical streets.\n\nThe second line is a string of length $m$, listing from north to south the driving directions of the $m$ horizontal streets before reconstruction. `E` means east, and `W` means west.\n\nThe third line is a string of length $n$, listing from west to east the driving directions of the $n$ vertical streets before reconstruction. `S` means south, and `N` means north.\n\nThe fourth line contains $m$ non-negative integers, listing from north to south the amount of work needed to change the direction of each horizontal street.\n\nThe fifth line contains $n$ non-negative integers, listing from west to east the amount of work needed to change the direction of each vertical street.\n\nThe sixth line contains a positive integer $k$, the number of common requirements proposed by tourists.\n\nThe next $k$ lines each contain four positive integers $x_1$, $y_1$, $x_2$, $y_2$, describing one requirement. The requirement is that the length of the shortest path from the intersection at $(x_1,y_1)$ to the intersection at $(x_2,y_2)$ must equal the Manhattan distance between these two intersections.", "outputFormat": "The first line is a string, either `possible` or `impossible`. Output `possible` if it is possible to satisfy all requirements in the input by changing street directions. Output `impossible` if it is impossible to satisfy all requirements no matter how you redesign the directions.\n\nIf the first line is `possible`, then output an integer on the second line, the minimum total amount of work. On the third line, output a string of length $m$, listing from north to south the driving directions of the $m$ horizontal streets after reconstruction, where `E` means east and `W` means west. On the fourth line, output a string of length $n$, listing from west to east the driving directions of the $n$ vertical streets after reconstruction, where `S` means south and `N` means north.", "hint": "#### Constraints\nFor all data, $m\\le 10$, $n\\le 100$, $k\\le 100$. The amount of work to change the direction of one street does not exceed $10000$.\n\n#### Scoring\n- If the first line of your output file is `impossible`:\n  - If there is indeed no solution, you get full marks for this test point.\n  - If there is actually a solution, you get $0$ points for this test point.\n- If the first line of your output file is `possible`:\n  - If the plan output by your program is infeasible, you get $0$ points for this test point.\n  - If the total amount of work output by your program does not match the actual total amount of work, you get $0$ points for this test point.\n  - If the plan output by your program is feasible but the total amount of work is not minimal, you get $4$ points for this test point.\n  - If the plan output by your program is feasible and the total amount of work is minimal, you get full marks for this test point.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2004] 曼哈顿", "background": "", "description": "P 城是 M 国的著名旅游城市。在市长 G 先生的治理下，人民安居乐业，城市欣欣向荣。然而，G 市长并没有被自己的政绩冲昏头脑，他清醒地意识到城市的治理还存在着一些问题，其中之一就是交通问题。\n\nP 城有 $m$ 条横向街道和 $n$ 条纵向街道，横向街道横贯东西，纵向街道纵穿南北，构成了 P 城整齐的交通网络（如图1所示）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k1ei30qk.png)\n\n由于街道狭窄，每条街道都只允许单向行驶，单向行驶的方向是事先设定好了的。一条横向街道的行驶方向只能是向东或者向西，一条纵向街道的行驶方向只能是向南或者向北，逆向行驶是绝对禁止的。\n\n这项限制给交通带来了巨大的不便。如图 1，很多游人希望从宾馆前往购物中心，但限于街道的行驶方向，他们不得不绕一个大圈才能够到达。\n\n这个问题一直困扰着 G 市长，每天他都会收到不少游人的来信，抱怨P城不合理的交通设计。但由于街道数目过多，他和他的部下始终不能解决这个问题……\n\n令人高兴的是这个问题不久就可能得以解决。因为最近他们以重金聘请了著名的交通规划大师 B 先生，请他对 P 城的交通进行有效合理的改造。\n\nB 先生知道不能通过拓宽街道的方法解决问题，因为这样势必影响到街道两旁的旅游景点，这是大家都不希望看到的。于是他准备重新设计街道的行驶方向（整条街道的行驶方向），使之尽可能满足大家的要求。\n\nB 先生先把 P 城的街道编号，横向街道由北向南编号为 $1$，$2$，$\\ldots$，$m$，纵向街道由西向东编号为 $1$，$2$，$\\ldots$，$n$。这样任何一个十字路口的位置都可以用一对正整数来表示，第一个数是该路口所在的横向街道的编号，第二个数是它所在的纵向街道的编号，这对整数被称为该十字路口的坐标。比如图 1 中宾馆所在的十字路口的坐标是 $(2,3)$。\n经过长期调查，他整理出了游人们提得相对集中的一些要求。每条要求都可以写成如下的形式：从一个十字路口到另一个十字路口的最短路径的长度必须等于它们之间的曼哈顿距离。所谓曼哈顿距离是指两个十字路口在东西方向上的距离加上在南北方向上的距离，坐标分别为 $(x_1,y_1)$ 和 $(x_2,y_2)$ 的两个十字路口之间的曼哈顿距离为 $|x_1-x_2|+|y_1-y_2|$。\n\n好了，B 先生已经知道了 P 城目前所有街道的行驶方向和游人们提得相对集中的要求，他能不能重新设计街道的行驶方向，使之满足所有要求呢？\n\n另外，改变每条街道的行驶方向都有一定的工作量，工作量的大小因道路而异。B 先生不仅想找到一个可行的改造计划，而且还希望这个计划的总工作量尽可能小。你能帮帮他吗？\n", "inputFormat": "输入文件的第一行有两个正整数 $m$ 和 $n$，分别表示横向街道和纵向街道的数目。\n\n第二行是一个长度为 $m$ 的字符串，由北向南列出了 $m$ 条横向街道改造前的行驶方向。`E` 表示向东，`W` 表示向西。\n\n第三行是一个长度为 $n$ 的字符串，由西向东列出了 $n$ 条纵向街道改造前的行驶方向。`S` 表示向南，`N` 表示向北。\n\n第四行有 $m$ 个非负整数，由北向南列出了改变每条横向街道的行驶方向的工作量。\n\n第五行有 $n$ 个非负整数，由西向东列出了改变每条纵向街道的行驶方向的工作量。\n\n第六行是一个正整数 $k$，表示游人们提得相对集中的要求的数目。\n\n接下来的 $k$ 行，每行有四个正整数 $x_1$，$y_1$，$x_2$，$y_2$，表示一条要求。这条要求的内容是希望从坐标为 $(x_1,y_1)$ 的十字路口到坐标为 $(x_2,y_2)$ 的十字路口的最短路径的长度等于这两个路口之间的曼哈顿距离。", "outputFormat": "第一行是一个字符串，`possible` 或者 `impossible`。输出 `possible` 表示可以通过改变街道的行驶方向满足输入数据中的所有要求，输出 `impossible` 表示无论怎么设计都不可能满足输入数据中的所有要求。\n\n如果在第一行输出的是 `possible` 的话，在第二行输出一个整数，表示最小的总工作量，在第三行输出一个长度为 $m$ 的字符串，由北向南列出改造后的 $m$ 条横向街道的行驶方向，`E` 表示向东，`W` 表示向西，在第四行输出一个长度为 $n$ 的字符串，由西向东列出改造后的 $n$ 条纵向街道的行驶方向，`S` 表示向南，`N` 表示向北。", "hint": "#### 数据范围\n对于全部的数据，$m\\le 10$，$n\\le 100$，$k\\le 100$；改变一条街道的行驶方向的工作量不超过 $10000$。\n\n#### 评分方式\n- 如果你的输出文件的第一行是 `impossible`，\n  - 如果确实无解，则该测试点满分。\n  - 如果实际有解，则该测试点 $0$ 分。\n- 如果你的输出文件的第一行是 `possible`，\n  - 如果你的程序输出的方案不可行，则该测试点 $0$ 分。\n  - 如果你的程序输出的总工作量与实际总工作量不一致，则该测试点 $0$ 分。\n  - 如果你的程序输出的方案可行，但总工作量不是最小的，则该测试点 $4$ 分。\n  - 如果你的程序输出的方案可行，且总工作量最小，则该测试点满分。", "locale": "zh-CN"}}}
{"pid": "P5748", "type": "P", "difficulty": 6, "samples": [["5\n2\n3\n7\n9\n233", "2\n5\n877\n21147\n53753544\n"]], "limits": {"time": [1000], "memory": [128000]}, "tags": ["数学", "Special Judge", "O2优化", "组合数学", "生成函数", "快速傅里叶变换 FFT"], "title": "集合划分计数", "background": "", "description": "一个有 $n$ 个元素的集合，将其分为任意个非空子集，求方案数。  \n注意划分出的集合间是无序的，即 $\\{\\{1,2\\},\\{3\\}\\}$ 和 $\\{\\{3\\},\\{2,1\\}\\}$ 算作一种方案。\n\n由于答案可能会很大，所以要对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "输出 $T$ 行，每行一个整数表示答案。", "hint": "【数据范围】  \n$T = 1000$，$1\\le n \\le 10^5$。\n\n【样例解释】  \n对于 $n=3$，有五种方案：$\\{\\{1,2,3\\}\\},\\{\\{1,2\\},\\{3\\}\\},\\{\\{1\\},\\{2,3\\}\\},\\{\\{1\\},\\{2\\},\\{3\\}\\},\\{\\{1,3\\},\\{2\\}\\}$。\n\n本题只有一个测试点，假设你答对了 $x$ 组数据，你将得到 $\\lfloor x/(T/100) \\rfloor$ 分。   \n如果你不能解决所有数据，也请输出 $T$ 个整数。\n\n~~TLE不要怪我，是你常数太大了~~", "locale": "zh-CN", "translations": {"en": {"title": "Counting Set Partitions", "background": "", "description": "Given a set with $n$ elements, split it into any number of non-empty subsets, and find the number of possible ways.\n\nNote that the resulting subsets are unordered. That is, $\\{\\{1,2\\},\\{3\\}\\}$ and $\\{\\{3\\},\\{2,1\\}\\}$ are considered the same partition.\n\nSince the answer may be very large, output it modulo $998244353$.", "inputFormat": "The first line contains a positive integer $T$, which indicates the number of test cases.  \nThe next $T$ lines each contain a positive integer $n$.", "outputFormat": "Output $T$ lines, each containing one integer representing the answer.", "hint": "Constraints  \n$T = 1000$, $1 \\le n \\le 10^5$.\n\nSample Explanation  \nFor $n=3$, there are five ways: $\\{\\{1,2,3\\}\\},\\{\\{1,2\\},\\{3\\}\\},\\{\\{1\\},\\{2,3\\}\\},\\{\\{1\\},\\{2\\},\\{3\\}\\},\\{\\{1,3\\},\\{2\\}\\}$.\n\nThis problem has only one test point. Suppose you answer $x$ test cases correctly, you will get $\\lfloor x/(T/100) \\rfloor$ points.  \nIf you cannot solve all the test cases, please still output $T$ integers.\n\n~~Do not blame me for TLE. Your constant factor is too large.~~\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "集合划分计数", "background": "", "description": "一个有 $n$ 个元素的集合，将其分为任意个非空子集，求方案数。  \n注意划分出的集合间是无序的，即 $\\{\\{1,2\\},\\{3\\}\\}$ 和 $\\{\\{3\\},\\{2,1\\}\\}$ 算作一种方案。\n\n由于答案可能会很大，所以要对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "输出 $T$ 行，每行一个整数表示答案。", "hint": "【数据范围】  \n$T = 1000$，$1\\le n \\le 10^5$。\n\n【样例解释】  \n对于 $n=3$，有五种方案：$\\{\\{1,2,3\\}\\},\\{\\{1,2\\},\\{3\\}\\},\\{\\{1\\},\\{2,3\\}\\},\\{\\{1\\},\\{2\\},\\{3\\}\\},\\{\\{1,3\\},\\{2\\}\\}$。\n\n本题只有一个测试点，假设你答对了 $x$ 组数据，你将得到 $\\lfloor x/(T/100) \\rfloor$ 分。   \n如果你不能解决所有数据，也请输出 $T$ 个整数。\n\n~~TLE不要怪我，是你常数太大了~~", "locale": "zh-CN"}}}
{"pid": "P5749", "type": "P", "difficulty": 5, "samples": [["2\n2 1 -1 -2\n", "4\n"], ["3\n-2 2 2 -2 -2 2\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["贪心", "2019", "线段树", "树状数组", "IOI"], "title": "[IOI 2019] 排列鞋子", "background": null, "description": "Adnan 拥有巴库最大的鞋店。现在有一个装着 $n$ 双鞋的箱子刚运到他的鞋店。每双鞋是大小相同的两只：一只左脚，一只右脚。Adnan 把这 $2n$ 只鞋排成一行，该行总共有 $2n$ 个**位置**，从左到右编号为 $0$ 到 $2n-1$ 。\n\nAdnan 想把这些鞋子重新排成**合法的排列**。一个排列是合法的，当且仅当对于所有的 $i(0\\leqslant i \\leqslant n - 1)$，以下条件都成立：\n\n- 在位置 $2i$ 和 $2i+1$ 上的鞋子大小相同；\n- 在位置 $2i$ 上的鞋子是一只左脚鞋；\n- 在位置 $2i+1$ 上的鞋子是一只右脚鞋。\n\n为实现上述目标，Adnan 可以做一系列对调。在每次对调中，他选择当前**相邻**的两只鞋进行对调（也就是把它们拿起来，然后将每只鞋子放回到另一只鞋子原来的位置上）。两只鞋子是相邻的，当且仅当其位置编号的差为 $1$。\n\n请求出 Adnan 最少要做出多少次对调，才能得到一个合法排列。", "inputFormat": "第一行一个正整数 $n$，表示有 $n$ 双鞋。\n\n第二行 $2n$ 个整数 $S_i$，第 $i$ 个整数表示位置编号为 $i-1$ 的鞋子。其中 $|S_u|\\neq 0$，等于最初在位置 $i$ 上的鞋子的大小。这里 $|x|$ 表示 $x$ 的绝对值，当 $x\\geq 0$ 时等于 $x$，当 $x < 0$ 时等于 $-x$。如果 $S_i < 0$，则 $i$ 位置上的鞋子是一只左脚鞋，否则是右脚鞋。", "outputFormat": "输出一行一个整数，表示最少对调次数。", "hint": "**样例说明 1**\n\nAdnan 可以通过 $4$ 次对调而得到一个合法的排列。\n\n例如，他可以先对调 $1$ 和 $-1$，再对调 $1$ 和 $-2$，再对调 $-1$ 和 $-2$。最后对调 $-2$ 和 $2$。随后他就可以得到合法的排列 。无法用少于 $4$ 次对调就得到合法的排列，因此输出 $4$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ybs09z2e.png)\n\n**样例说明 2**\n\nAdnan 可以对调在位置 $2$ 和 $3$ 上的鞋子来得到合法的排列$[-2,2,-2,2,-2,2]$，因此应当输出 $1$。\n\n**数据范围**\n\n对于所有数据：\n\n- $1\\leqslant n\\leqslant10^5$；\n- 对于所有 $i(0\\leqslant i\\leqslant 2n-1)$，都有 $1\\leqslant \\left|S_{i+1}\\right|\\leqslant n$；\n- 总有某个合法的排列可以经由一系列对调而得到。\n\n详细子任务附加限制与分值如下表：\n\n| 子任务编号 | 附加限制 | 分值 |\n|:---:|:---:|:---:|\n| $1$ | $n=1$ | $10$|\n|$2$|$n\\leqslant8$|$20$|\n|$3$|所有鞋子大小都是相同的|$20$|\n|$4$|所有在位置 $0,\\dots,n-1$ 上的鞋都是左脚鞋，而在位置 $n,\\dots,2n-1$ 上的鞋都是右脚鞋。而且对于所有 $i(0\\leqslant i\\leqslant n-1)$，在位置 $i$ 和 $i+n$ 上的鞋子大小相同|$15$|\n|$5$|$n\\leqslant10^3$|$20$|\n|$6$|无附加限制|$15$|", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2019] Arranging Shoes", "background": "", "description": "Adnan owns the largest shoe store in Baku. A box containing $n$ pairs of shoes has just arrived at his store. Each pair of shoes consists of two shoes of the same size: one left shoe and one right shoe. Adnan lines up these $2n$ shoes in a row. This row has a total of $2n$ **positions**, numbered from $0$ to $2n-1$ from left to right.\n\nAdnan wants to rearrange these shoes into a **valid permutation**. A permutation is valid if and only if for all $i(0\\leqslant i \\leqslant n - 1)$, the following conditions all hold:\n\n- The shoes at positions $2i$ and $2i+1$ have the same size.\n- The shoe at position $2i$ is a left shoe.\n- The shoe at position $2i+1$ is a right shoe.\n\nTo achieve this, Adnan can perform a sequence of swaps. In each swap, he chooses two currently **adjacent** shoes and swaps them (that is, he picks them up and puts each shoe back into the other shoe’s original position). Two shoes are adjacent if and only if the difference of their position indices is $1$.\n\nFind the minimum number of swaps Adnan needs to obtain a valid permutation.", "inputFormat": "The first line contains a positive integer $n$, meaning there are $n$ pairs of shoes.\n\nThe second line contains $2n$ integers $S_i$. The $i$-th integer describes the shoe whose position index is $i-1$. Here $|S_u|\\neq 0$, and it equals the size of the shoe initially at position $i$. Here $|x|$ denotes the absolute value of $x$: it equals $x$ when $x\\geq 0$, and equals $-x$ when $x < 0$. If $S_i < 0$, then the shoe at position $i$ is a left shoe; otherwise, it is a right shoe.", "outputFormat": "Output one line with one integer, the minimum number of swaps.", "hint": "**Explanation for Sample 1**\n\nAdnan can obtain a valid permutation with $4$ swaps.\n\nFor example, he can first swap $1$ and $-1$, then swap $1$ and $-2$, then swap $-1$ and $-2$. Finally, swap $-2$ and $2$. After that, he can get a valid permutation. It is impossible to obtain a valid permutation with fewer than $4$ swaps, so the output is $4$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ybs09z2e.png)\n\n**Explanation for Sample 2**\n\nAdnan can swap the shoes at positions $2$ and $3$ to obtain the valid permutation $[-2,2,-2,2,-2,2]$, so the output should be $1$.\n\n**Constraints**\n\nFor all testdata:\n\n- $1\\leqslant n\\leqslant10^5$.\n- For all $i(0\\leqslant i\\leqslant 2n-1)$, $1\\leqslant \\left|S_{i+1}\\right|\\leqslant n$.\n- A valid permutation can always be obtained through a sequence of swaps.\n\nThe detailed extra constraints and scores for subtasks are shown in the table below:\n\n| Subtask ID | Additional Constraints | Score |\n|:---:|:---:|:---:|\n| $1$ | $n=1$ | $10$|\n|$2$|$n\\leqslant8$|$20$|\n|$3$| All shoes have the same size. | $20$|\n|$4$| All shoes at positions $0,\\dots,n-1$ are left shoes, and all shoes at positions $n,\\dots,2n-1$ are right shoes. Also, for all $i(0\\leqslant i\\leqslant n-1)$, the shoes at positions $i$ and $i+n$ have the same size. | $15$|\n|$5$|$n\\leqslant10^3$|$20$|\n|$6$| No additional constraints. | $15$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2019] 排列鞋子", "background": null, "description": "Adnan 拥有巴库最大的鞋店。现在有一个装着 $n$ 双鞋的箱子刚运到他的鞋店。每双鞋是大小相同的两只：一只左脚，一只右脚。Adnan 把这 $2n$ 只鞋排成一行，该行总共有 $2n$ 个**位置**，从左到右编号为 $0$ 到 $2n-1$ 。\n\nAdnan 想把这些鞋子重新排成**合法的排列**。一个排列是合法的，当且仅当对于所有的 $i(0\\leqslant i \\leqslant n - 1)$，以下条件都成立：\n\n- 在位置 $2i$ 和 $2i+1$ 上的鞋子大小相同；\n- 在位置 $2i$ 上的鞋子是一只左脚鞋；\n- 在位置 $2i+1$ 上的鞋子是一只右脚鞋。\n\n为实现上述目标，Adnan 可以做一系列对调。在每次对调中，他选择当前**相邻**的两只鞋进行对调（也就是把它们拿起来，然后将每只鞋子放回到另一只鞋子原来的位置上）。两只鞋子是相邻的，当且仅当其位置编号的差为 $1$。\n\n请求出 Adnan 最少要做出多少次对调，才能得到一个合法排列。", "inputFormat": "第一行一个正整数 $n$，表示有 $n$ 双鞋。\n\n第二行 $2n$ 个整数 $S_i$，第 $i$ 个整数表示位置编号为 $i-1$ 的鞋子。其中 $|S_u|\\neq 0$，等于最初在位置 $i$ 上的鞋子的大小。这里 $|x|$ 表示 $x$ 的绝对值，当 $x\\geq 0$ 时等于 $x$，当 $x < 0$ 时等于 $-x$。如果 $S_i < 0$，则 $i$ 位置上的鞋子是一只左脚鞋，否则是右脚鞋。", "outputFormat": "输出一行一个整数，表示最少对调次数。", "hint": "**样例说明 1**\n\nAdnan 可以通过 $4$ 次对调而得到一个合法的排列。\n\n例如，他可以先对调 $1$ 和 $-1$，再对调 $1$ 和 $-2$，再对调 $-1$ 和 $-2$。最后对调 $-2$ 和 $2$。随后他就可以得到合法的排列 。无法用少于 $4$ 次对调就得到合法的排列，因此输出 $4$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ybs09z2e.png)\n\n**样例说明 2**\n\nAdnan 可以对调在位置 $2$ 和 $3$ 上的鞋子来得到合法的排列$[-2,2,-2,2,-2,2]$，因此应当输出 $1$。\n\n**数据范围**\n\n对于所有数据：\n\n- $1\\leqslant n\\leqslant10^5$；\n- 对于所有 $i(0\\leqslant i\\leqslant 2n-1)$，都有 $1\\leqslant \\left|S_{i+1}\\right|\\leqslant n$；\n- 总有某个合法的排列可以经由一系列对调而得到。\n\n详细子任务附加限制与分值如下表：\n\n| 子任务编号 | 附加限制 | 分值 |\n|:---:|:---:|:---:|\n| $1$ | $n=1$ | $10$|\n|$2$|$n\\leqslant8$|$20$|\n|$3$|所有鞋子大小都是相同的|$20$|\n|$4$|所有在位置 $0,\\dots,n-1$ 上的鞋都是左脚鞋，而在位置 $n,\\dots,2n-1$ 上的鞋都是右脚鞋。而且对于所有 $i(0\\leqslant i\\leqslant n-1)$，在位置 $i$ 和 $i+n$ 上的鞋子大小相同|$15$|\n|$5$|$n\\leqslant10^3$|$20$|\n|$6$|无附加限制|$15$|", "locale": "zh-CN"}}}
{"pid": "P5750", "type": "P", "difficulty": 5, "samples": [["5 2\n    *    \n   * .\n  * * *\n * . * *\n* * * * *\n", "7/16\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["1999", "NOI"], "title": "[NOI1999] 钉子和小球", "background": "", "description": "有一个三角形木板,竖直立放，上面钉着 $ \\frac{ n (n+1) } { 2 } $ 颗钉子，还有 ($n+1$) 个格子 （当 $n=5$ 时如图 1 ） 。每颗钉子和周围的钉子的距离都等于 $d$ ，每个格子的宽度也都等于 $d$ ，且除了最左端和最右端的格子外每个格子都正对着最下面一排钉子的间隙。\n\n让一个直径略小于 $d$ 的小球中心正对着最上面的钉子在板上自由滚落，小球每碰到一个钉子都可能落向左边或右边 （概率各 $1/2$ ） ，且球的中心还会正对着下一颗将要碰上的钉子。例如图2 就是小球一条可能的路径。\n\n我们知道小球落在第 $i$ 个格子中的概率 $p_i$ = $ \\frac{C_n^i}{2^n}$ = $ \\frac{ n! }{ 2^n i! (n-i)! } $ ，其中 $i$ 为格子的编号，从左至右依次为 $ 0 , 1 , ... , n $.\n \n现在的问题是计算拔掉某些钉子后，小球落在编号为 $m$ 的格子中的概率 $p_m$ 。假定最下面一排钉子不会被拔掉。例如图3 是某些钉子被拔掉后小球一条可能的路径。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ntaygrw7.png)\n\n 图1  $\\qquad$ $\\qquad$ $\\quad$ $\\quad$  图2    $\\quad$ $\\qquad$ $\\qquad$ $\\quad$                       图3 ", "inputFormat": "第1行为整数 $n$ （$ 2 \\leq n \\leq  50 $）和 $m$ （ $ 0 \\leq m \\leq n $ ）。以下 $n$ 行依次为木板上从上至下$n$行钉子的信息，每行中 ‘*’ 表示钉子还在， ‘.’ 表示钉子被拔去，注意在这 $n$ 行中空格符可能出现在任何位置。", "outputFormat": "仅一行，是一个既约分数( $0$ 写成 $0/1$ ) ，为小球落在编号为 $m$ 的格子中的概率 $p_m$ 。\n\n既约分数的定义： $A/B$ 是既约分数，当且仅当 $A$ 、 $B$ 为正整数且 $A$ 和 $B$ 没有大于$1$的公因子。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[NOI1999] Nails and Balls", "background": "", "description": "There is a triangular wooden board standing vertically. On it, $\\frac{ n (n+1) } { 2 }$ nails are hammered in, and there are $(n+1)$ slots (see Figure 1 when $n=5$). The distance between each nail and its surrounding nails is $d$. The width of each slot is also $d$. Except for the leftmost and rightmost slots, each slot is aligned with a gap between two nails in the bottom row.\n\nLet a small ball with diameter slightly smaller than $d$ roll down freely on the board, with its center initially aligned with the top nail. Each time the ball hits a nail, it may fall to the left or to the right (each with probability $1/2$), and the ball’s center will then align with the next nail it is going to hit. For example, Figure 2 shows one possible path of the ball.\n\nWe know that the probability that the ball lands in slot $i$ is $p_i = \\frac{C_n^i}{2^n} = \\frac{ n! }{ 2^n i! (n-i)! }$, where $i$ is the slot index, from left to right: $0, 1, ..., n$.\n\nNow the problem is to compute, after removing some nails, the probability $p_m$ that the ball lands in the slot with index $m$. Assume that the nails in the bottom row will not be removed. For example, Figure 3 shows one possible path after some nails have been removed.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ntaygrw7.png)\n\nFigure 1 $\\qquad$ $\\qquad$ $\\quad$ $\\quad$ Figure 2 $\\quad$ $\\qquad$ $\\qquad$ $\\quad$ Figure 3.", "inputFormat": "The first line contains integers $n$ ($2 \\leq n \\leq 50$) and $m$ ($0 \\leq m \\leq n$). The following $n$ lines give the nail information for the $n$ rows of nails on the board from top to bottom. In each line, `*` means the nail is still present, and `.` means the nail has been removed. Note that in these $n$ lines, spaces may appear anywhere.", "outputFormat": "Output only one line: an irreducible fraction ($0$ should be written as $0/1$), which is the probability $p_m$ that the ball lands in the slot with index $m$.\n\nDefinition of an irreducible fraction: $A/B$ is an irreducible fraction if and only if $A$ and $B$ are positive integers and $A$ and $B$ have no common factor greater than $1$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1999] 钉子和小球", "background": "", "description": "有一个三角形木板,竖直立放，上面钉着 $ \\frac{ n (n+1) } { 2 } $ 颗钉子，还有 ($n+1$) 个格子 （当 $n=5$ 时如图 1 ） 。每颗钉子和周围的钉子的距离都等于 $d$ ，每个格子的宽度也都等于 $d$ ，且除了最左端和最右端的格子外每个格子都正对着最下面一排钉子的间隙。\n\n让一个直径略小于 $d$ 的小球中心正对着最上面的钉子在板上自由滚落，小球每碰到一个钉子都可能落向左边或右边 （概率各 $1/2$ ） ，且球的中心还会正对着下一颗将要碰上的钉子。例如图2 就是小球一条可能的路径。\n\n我们知道小球落在第 $i$ 个格子中的概率 $p_i$ = $ \\frac{C_n^i}{2^n}$ = $ \\frac{ n! }{ 2^n i! (n-i)! } $ ，其中 $i$ 为格子的编号，从左至右依次为 $ 0 , 1 , ... , n $.\n \n现在的问题是计算拔掉某些钉子后，小球落在编号为 $m$ 的格子中的概率 $p_m$ 。假定最下面一排钉子不会被拔掉。例如图3 是某些钉子被拔掉后小球一条可能的路径。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ntaygrw7.png)\n\n 图1  $\\qquad$ $\\qquad$ $\\quad$ $\\quad$  图2    $\\quad$ $\\qquad$ $\\qquad$ $\\quad$                       图3 ", "inputFormat": "第1行为整数 $n$ （$ 2 \\leq n \\leq  50 $）和 $m$ （ $ 0 \\leq m \\leq n $ ）。以下 $n$ 行依次为木板上从上至下$n$行钉子的信息，每行中 ‘*’ 表示钉子还在， ‘.’ 表示钉子被拔去，注意在这 $n$ 行中空格符可能出现在任何位置。", "outputFormat": "仅一行，是一个既约分数( $0$ 写成 $0/1$ ) ，为小球落在编号为 $m$ 的格子中的概率 $p_m$ 。\n\n既约分数的定义： $A/B$ 是既约分数，当且仅当 $A$ 、 $B$ 为正整数且 $A$ 和 $B$ 没有大于$1$的公因子。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5751", "type": "P", "difficulty": 4, "samples": [["6 1 2 3 1 1 2\n", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["1999", "NOI", "差分约束", "前缀和"], "title": "[NOI1999] 01 串", "background": null, "description": "给定 $7$ 个整数 $N , A_0 , B_0 , L_0 , A_1 , B_1 , L_1 $，要求设计一个 $01$ 串 $ S=s_1 s_2 … s_i … s_N $，满足：\n1.\t$ s_i = 0 $ 或 $ s_i = 1 $， $ 1 \\leq i \\leq N $；\n2.\t对于 $S$ 的任何连续的长度为 $L_0$ 的子串 $s_j s_{j+1} … s_{j+L0-1}  $ ($1 \\leq j \\leq N-L_0+1 $) ， $0$ 的个数大于等于 $A_0$ 且小于等于 $B_0$ ;\n3.\t对于 $S$ 的任何连续的长度为 $L_1$ 的子串 $s_j s_{j+1} …  s_{j+L1-1} $ ($ 1 \\leq  j  \\leq N-L_1+1 $) ， $1$ 的个数大于等于 $A_1$ 且小于等于 $B_1$ ;\n\n例如， $ N = 6 ,  A_0 = 1 ,  B_0 = 2  ,  L_0 = 3 ,  A_1 = 1 ,  B_1 = 1 ,  L_1 = 2 $，则存在一个满足上述所有条件的 $01$ 串 $ S = 010101 $ 。", "inputFormat": "仅一行，有 $7$ 个整数，依次表示 $N , A_0 , B_0 , L_0 , A_1 , B_1 , L_1 $ （$3 \\leq N \\leq 1000$，$1 \\leq  A_0 \\leq B_0 \\leq L_0 \\leq N$，$1 \\leq A_1 \\leq B_1 \\leq L_1 \\leq N$），相邻两个整数之间用一个空格分隔。", "outputFormat": "仅一行，若不存在满足所有条件的 $01$ 串，则输出一个整数 `-1`，否则输出满足所有条件的 $01$ 串中 $1$ 的个数的最大值。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[NOI1999] 01 String", "background": "", "description": "Given $7$ integers $N, A_0, B_0, L_0, A_1, B_1, L_1$, you are asked to design a binary string $S = s_1 s_2 \\ldots s_i \\ldots s_N$ that satisfies:\n\n1. $s_i = 0$ or $s_i = 1$, $1 \\leq i \\leq N$.\n2. For any consecutive substring of $S$ with length $L_0$, namely $s_j s_{j+1} \\ldots s_{j+L_0-1}$ ($1 \\leq j \\leq N - L_0 + 1$), the number of $0$s is at least $A_0$ and at most $B_0$.\n3. For any consecutive substring of $S$ with length $L_1$, namely $s_j s_{j+1} \\ldots s_{j+L_1-1}$ ($1 \\leq j \\leq N - L_1 + 1$), the number of $1$s is at least $A_1$ and at most $B_1$.\n\nFor example, if $N = 6, A_0 = 1, B_0 = 2, L_0 = 3, A_1 = 1, B_1 = 1, L_1 = 2$, then there exists a binary string $S = 010101$ that satisfies all the above conditions.", "inputFormat": "Only one line containing $7$ integers, in order: $N, A_0, B_0, L_0, A_1, B_1, L_1$ ($3 \\leq N \\leq 1000$, $1 \\leq A_0 \\leq B_0 \\leq L_0 \\leq N$, $1 \\leq A_1 \\leq B_1 \\leq L_1 \\leq N$). Adjacent integers are separated by one space.", "outputFormat": "Only one line. If there is no binary string satisfying all conditions, output the integer `-1`. Otherwise, output the maximum possible number of $1$s among all binary strings that satisfy all conditions.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1999] 01 串", "background": null, "description": "给定 $7$ 个整数 $N , A_0 , B_0 , L_0 , A_1 , B_1 , L_1 $，要求设计一个 $01$ 串 $ S=s_1 s_2 … s_i … s_N $，满足：\n1.\t$ s_i = 0 $ 或 $ s_i = 1 $， $ 1 \\leq i \\leq N $；\n2.\t对于 $S$ 的任何连续的长度为 $L_0$ 的子串 $s_j s_{j+1} … s_{j+L0-1}  $ ($1 \\leq j \\leq N-L_0+1 $) ， $0$ 的个数大于等于 $A_0$ 且小于等于 $B_0$ ;\n3.\t对于 $S$ 的任何连续的长度为 $L_1$ 的子串 $s_j s_{j+1} …  s_{j+L1-1} $ ($ 1 \\leq  j  \\leq N-L_1+1 $) ， $1$ 的个数大于等于 $A_1$ 且小于等于 $B_1$ ;\n\n例如， $ N = 6 ,  A_0 = 1 ,  B_0 = 2  ,  L_0 = 3 ,  A_1 = 1 ,  B_1 = 1 ,  L_1 = 2 $，则存在一个满足上述所有条件的 $01$ 串 $ S = 010101 $ 。", "inputFormat": "仅一行，有 $7$ 个整数，依次表示 $N , A_0 , B_0 , L_0 , A_1 , B_1 , L_1 $ （$3 \\leq N \\leq 1000$，$1 \\leq  A_0 \\leq B_0 \\leq L_0 \\leq N$，$1 \\leq A_1 \\leq B_1 \\leq L_1 \\leq N$），相邻两个整数之间用一个空格分隔。", "outputFormat": "仅一行，若不存在满足所有条件的 $01$ 串，则输出一个整数 `-1`，否则输出满足所有条件的 $01$ 串中 $1$ 的个数的最大值。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5752", "type": "P", "difficulty": 4, "samples": [["3\n1 1 1 1 1 1 1 3\n1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 1\n1 1 1 1 1 1 1 0\n1 1 1 1 1 1 0 3\n", "1.633\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "1999", "NOI", "Special Judge", "记忆化搜索", "区间 DP"], "title": "[NOI1999] 棋盘分割", "background": "", "description": "将一个 8 $\\times$ 8 的棋盘进行如下分割：将原棋盘割下一块矩形棋盘并使剩下部分也是矩形，再将剩下的部分继续如此分割，这样割了 $(n-1)$ 次后，连同最后剩下的矩形棋盘共有 $n$ 块矩形棋盘。 (每次切割都只能沿着棋盘格子的边进行)\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ivf3ggl3.png)\n\n\n原棋盘上每一格有一个分值，一块矩形棋盘的总分为其所含各格分值之和。现在需要把棋盘按上述规则分割成 $n$ 块矩形棋盘，并使各矩形棋盘总分的均方差最小。\n\n\n均方差 $\\sigma = \\sqrt{ \\frac{ \\sum_{i=1}^n (x_i - \\bar x)^2 } { n }}$                ，其中平均值 $\\bar x = \\frac{\\sum_{i=1}^n x_i}{n}$ ,  $x_i$ 为第 $i$ 块矩形棋盘的分。\n\n\n请编程对给出的棋盘及 $n$ ，求出 $\\sigma$ 的最小值。\n", "inputFormat": "第一行为一个整数 $n$ ($ 1 < n< 15 $)。\n\n\n第二行至第九行每行为 $8$ 个小于 $100$ 的非负整数，表示棋盘上相应格子的分值。每行相邻两数之间用一个空格分隔。\n", "outputFormat": "仅一个数，为 $\\sigma$ （四舍五入精确到小数点后三位）。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[NOI1999] Chessboard Partition", "background": "", "description": "Partition an $8 \\times 8$ chessboard as follows: cut off a rectangular piece from the original board such that the remaining part is also a rectangle, then continue partitioning the remaining part in the same way. After cutting $(n-1)$ times, together with the final remaining rectangle, there are a total of $n$ rectangular pieces. (Each cut can only be made along the edges of the grid cells.)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ivf3ggl3.png)\n\nEach cell on the original board has a score. The total score of a rectangular piece is the sum of the scores of all cells it contains. Now you need to partition the board into $n$ rectangular pieces according to the rule above, and minimize the standard deviation of the total scores of all rectangular pieces.\n\nThe standard deviation is\n$$\\sigma = \\sqrt{ \\frac{ \\sum_{i=1}^n (x_i - \\bar x)^2 } { n }}$$\nwhere the average is\n$$\\bar x = \\frac{\\sum_{i=1}^n x_i}{n}$$\nand $x_i$ is the score of the $i$-th rectangular piece.\n\nGiven the board and $n$, compute the minimum possible value of $\\sigma$.", "inputFormat": "The first line contains an integer $n$ ($1 < n < 15$).\n\nLines 2 to 9 each contain $8$ non-negative integers less than $100$, representing the scores of the corresponding cells on the board. Adjacent numbers in each line are separated by one space.", "outputFormat": "Output only one number, $\\sigma$, rounded to three digits after the decimal point.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1999] 棋盘分割", "background": "", "description": "将一个 8 $\\times$ 8 的棋盘进行如下分割：将原棋盘割下一块矩形棋盘并使剩下部分也是矩形，再将剩下的部分继续如此分割，这样割了 $(n-1)$ 次后，连同最后剩下的矩形棋盘共有 $n$ 块矩形棋盘。 (每次切割都只能沿着棋盘格子的边进行)\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ivf3ggl3.png)\n\n\n原棋盘上每一格有一个分值，一块矩形棋盘的总分为其所含各格分值之和。现在需要把棋盘按上述规则分割成 $n$ 块矩形棋盘，并使各矩形棋盘总分的均方差最小。\n\n\n均方差 $\\sigma = \\sqrt{ \\frac{ \\sum_{i=1}^n (x_i - \\bar x)^2 } { n }}$                ，其中平均值 $\\bar x = \\frac{\\sum_{i=1}^n x_i}{n}$ ,  $x_i$ 为第 $i$ 块矩形棋盘的分。\n\n\n请编程对给出的棋盘及 $n$ ，求出 $\\sigma$ 的最小值。\n", "inputFormat": "第一行为一个整数 $n$ ($ 1 < n< 15 $)。\n\n\n第二行至第九行每行为 $8$ 个小于 $100$ 的非负整数，表示棋盘上相应格子的分值。每行相邻两数之间用一个空格分隔。\n", "outputFormat": "仅一个数，为 $\\sigma$ （四舍五入精确到小数点后三位）。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5753", "type": "P", "difficulty": 2, "samples": [["48\n7\n", "3\n"], ["8\n5\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2000", "NOI"], "title": "[NOI2000] 瓷片项链", "background": "", "description": "原始部落用一种稀有的泥土烧制直径相同的圆瓷片并串成项链，串的时候沿瓷片的直径方向顺次连接，瓷片之间没有空隙也不重叠，一条项链至少由一个瓷片构成。\n\n下图示出四片同样大小的瓷片串接所成的项链，其总长为单个瓷片直径的四倍。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/palmhlro.png)\n\n\n每个烧制的瓷片厚度是一定的，直径 $D$ 和所用泥土的体积 $V$ 有以下关系：\n\n$$D = \\begin{cases}\n0.3\\sqrt{V-V_0} & V > V_0 \\cr\n0 & V \\le V_0\n\\end{cases}$$\n\n\n其中 $V_0$ 为烧制每一片的损耗，单位与 $V$ 相同。当用料小于等于 $V_0$ 时，不能烧制成瓷片。\n例： $V_总 = 10，V_0 = 1 $，若烧制成一片瓷片，$ V = V_总= 10，D = 0.9 $。如果把泥土均分成 $2$ 份，每份泥土的体积为 $V = \\frac{V_总}{2} = 5 $，单个瓷片的直径为 $ D' = 0.3 \\times \\sqrt{5-1} =0.6 $ ,串起来的总长为 $1.2$ 。\n\n给定了泥土的总体积和烧制单个瓷片的损耗，烧制的瓷片数不同，能够得到的项链总长度也不相同，请计算烧制多少个瓷片能使所得到的项链最长。\n", "inputFormat": "共两行，每一行仅包含一个整数。\n\n第一行的数字为泥土总体积 $ V_总$ ( $ 0 < V_总 < 60000 $ )，第二行为烧制单个瓷片的损耗 $V_0$ ($ 0 <  V_0 < 600 $)。", "outputFormat": "共一行，一个整数。\n\n该整数为能获得最长项链而烧制的瓷片数。如果不能烧制成瓷片或者最优解不唯一（存在两个或者两个以上方案均能获得最长项链），输出 `0`。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2000] Porcelain Disc Necklace", "background": "", "description": "A primitive tribe uses a rare kind of clay to fire circular porcelain discs of the same thickness and string them into a necklace. When stringing, the discs are connected in order along their diameters. There are no gaps and no overlaps between adjacent discs. A necklace consists of at least one disc.\n\nThe figure below shows a necklace made by stringing four discs of the same size. Its total length is four times the diameter of a single disc.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/palmhlro.png)\n\nFor each fired disc, the thickness is fixed, and the diameter $D$ and the volume of clay used $V$ satisfy:\n\n$$D = \\begin{cases}\n0.3\\sqrt{V-V_0} & V > V_0 \\cr\n0 & V \\le V_0\n\\end{cases}$$\n\nHere $V_0$ is the loss (waste) incurred when firing each disc, with the same unit as $V$. If the amount of clay used is less than or equal to $V_0$, a disc cannot be produced.\n\nExample: $V_总 = 10，V_0 = 1$.\nIf you fire one disc, $V = V_总 = 10$, so $D = 0.9$.\nIf you divide the clay evenly into $2$ parts, each part has volume $V = \\frac{V_总}{2} = 5$, and the diameter of one disc is $D' = 0.3 \\times \\sqrt{5-1} = 0.6$. Then the total length when strung is $1.2$.\n\nGiven the total volume of clay and the loss for firing a single disc, different numbers of discs lead to different total necklace lengths. Compute how many discs should be fired to make the necklace as long as possible.", "inputFormat": "Two lines in total, each line contains one integer.\n\nThe first line is the total volume of clay $V_总$ ($0 < V_总 < 60000$). The second line is the loss per disc $V_0$ ($0 < V_0 < 600$).", "outputFormat": "One line containing one integer.\n\nThis integer is the number of discs to fire in order to obtain the longest necklace. If it is impossible to fire any disc, or if the optimal solution is not unique (there exist two or more choices that all achieve the maximum necklace length), output `0`.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2000] 瓷片项链", "background": "", "description": "原始部落用一种稀有的泥土烧制直径相同的圆瓷片并串成项链，串的时候沿瓷片的直径方向顺次连接，瓷片之间没有空隙也不重叠，一条项链至少由一个瓷片构成。\n\n下图示出四片同样大小的瓷片串接所成的项链，其总长为单个瓷片直径的四倍。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/palmhlro.png)\n\n\n每个烧制的瓷片厚度是一定的，直径 $D$ 和所用泥土的体积 $V$ 有以下关系：\n\n$$D = \\begin{cases}\n0.3\\sqrt{V-V_0} & V > V_0 \\cr\n0 & V \\le V_0\n\\end{cases}$$\n\n\n其中 $V_0$ 为烧制每一片的损耗，单位与 $V$ 相同。当用料小于等于 $V_0$ 时，不能烧制成瓷片。\n例： $V_总 = 10，V_0 = 1 $，若烧制成一片瓷片，$ V = V_总= 10，D = 0.9 $。如果把泥土均分成 $2$ 份，每份泥土的体积为 $V = \\frac{V_总}{2} = 5 $，单个瓷片的直径为 $ D' = 0.3 \\times \\sqrt{5-1} =0.6 $ ,串起来的总长为 $1.2$ 。\n\n给定了泥土的总体积和烧制单个瓷片的损耗，烧制的瓷片数不同，能够得到的项链总长度也不相同，请计算烧制多少个瓷片能使所得到的项链最长。\n", "inputFormat": "共两行，每一行仅包含一个整数。\n\n第一行的数字为泥土总体积 $ V_总$ ( $ 0 < V_总 < 60000 $ )，第二行为烧制单个瓷片的损耗 $V_0$ ($ 0 <  V_0 < 600 $)。", "outputFormat": "共一行，一个整数。\n\n该整数为能获得最长项链而烧制的瓷片数。如果不能烧制成瓷片或者最优解不唯一（存在两个或者两个以上方案均能获得最长项链），输出 `0`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5754", "type": "P", "difficulty": 3, "samples": [["4\n3 0 2 2", "3 1 2 4\n4 1 3 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "各省省选", "江苏"], "title": "[JSOI2010] 排名", "background": "在植树节那天，小 L，小 H，小 X 却要面对繁忙的考试。\n\n考完后，按照惯例，他们讨论起了成绩。小 L 非常八卦，他向全班 $N$ 个同学问了他们的成绩情况。当然，就如你想象的那样，每个人也不愿意透露太多信息，每个人只说了他的分数比哪一个同学低，也有些人没说任何信息。\n\n勤奋的小 H 和爱偷懒的小 X 对于班上所有同学的成绩排名都有一个“心理期望”，也就是说，小 H 可能认为 XX 会排第 $1$，YY 会排第 $2$……但小 X 却会认为 XX 应该排最后 $1$ 名，YY 会排倒数第 $2$ 名。\n\n不过理想和现实总是有差距的，通过小 L 打探到的情报， XX 不能排在第 $1$ 了，但是，小 H 仍然觉得 XX 应该排在尽可能前。\n\n小 L 由此想到了一个问题，他想知道小 H 和小 X 知道他打探到的情报之后，对班上同学的心里排名是什么样的。\n\n每个同学的编号即为小 H 的心理排名，也就是说，小 H 希望编号越靠前的同学排名也尽量靠前，而小 X 希望希望编号越靠前的同学排名尽量靠后。（注意不是越后面的同学排名越靠前）", "description": "给定一个长度为 $N$ 的数列 $A$，其中 $A_i$ 表示第 $i$ 个同学的分数比第 $A_i$ 个同学的分数低（或者说，第 $i$ 个同学的排名在第 $A_i$ 个同学之后）。当然，$A_i$ 有可能等于 $0$，则表明没有关于第 $i$ 个同学的信息。\n\n你需要得到一个长度为 $N$ 的数列 $H$，表示班上同学的排名。这个排名要求是满足所有 $A_i$ 构成的约束的排名中字典序最小的哪一个。\n\n同时，你还需要得到一个数列 $X$，表示班上同学的排名。这个排名要求是满足所有 $A_i$ 构成的约束的排名中字典序最大的哪一个。", "inputFormat": "第 $1$ 行一个正整数 $N$，表示班上同学的个数。\n\n第 $2$ 行包含 $N$ 个用空格隔开的非负整数，第 $i$ 个数表示 $A_i$。", "outputFormat": "两行，每行 $N$ 个正整数，用空格隔开。其中，第 $1$ 行为小 L 的心理排名，第 $2$ 行为小 X 的心理排名。", "hint": "### 样例解释\n\n共有 $3$ 种排名满足大小关系：\n\n```plain\n4 1 3 2\n4 1 2 3\n3 1 2 4\n```\n\n其中，`3 1 2 4` 字典序最小，`4 1 3 2` 字典序最大。\n\n### 数据范围\n\n对于 $10\\%$ 的数据，$N\\leq 10$。\n\n对于 $20\\%$ 的数据，$N\\leq 20$。\n\n对于 $40\\%$ 的数据，$N\\leq 2\\times 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\leq N\\leq 2\\times 10^5,A_i\\leq N$。其中，第 $5$ 组数据保证 $N=1.2\\times 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2010] 排名", "background": "在植树节那天，小 L，小 H，小 X 却要面对繁忙的考试。\n\n考完后，按照惯例，他们讨论起了成绩。小 L 非常八卦，他向全班 $N$ 个同学问了他们的成绩情况。当然，就如你想象的那样，每个人也不愿意透露太多信息，每个人只说了他的分数比哪一个同学低，也有些人没说任何信息。\n\n勤奋的小 H 和爱偷懒的小 X 对于班上所有同学的成绩排名都有一个“心理期望”，也就是说，小 H 可能认为 XX 会排第 $1$，YY 会排第 $2$……但小 X 却会认为 XX 应该排最后 $1$ 名，YY 会排倒数第 $2$ 名。\n\n不过理想和现实总是有差距的，通过小 L 打探到的情报， XX 不能排在第 $1$ 了，但是，小 H 仍然觉得 XX 应该排在尽可能前。\n\n小 L 由此想到了一个问题，他想知道小 H 和小 X 知道他打探到的情报之后，对班上同学的心里排名是什么样的。\n\n每个同学的编号即为小 H 的心理排名，也就是说，小 H 希望编号越靠前的同学排名也尽量靠前，而小 X 希望希望编号越靠前的同学排名尽量靠后。（注意不是越后面的同学排名越靠前）", "description": "给定一个长度为 $N$ 的数列 $A$，其中 $A_i$ 表示第 $i$ 个同学的分数比第 $A_i$ 个同学的分数低（或者说，第 $i$ 个同学的排名在第 $A_i$ 个同学之后）。当然，$A_i$ 有可能等于 $0$，则表明没有关于第 $i$ 个同学的信息。\n\n你需要得到一个长度为 $N$ 的数列 $H$，表示班上同学的排名。这个排名要求是满足所有 $A_i$ 构成的约束的排名中字典序最小的哪一个。\n\n同时，你还需要得到一个数列 $X$，表示班上同学的排名。这个排名要求是满足所有 $A_i$ 构成的约束的排名中字典序最大的哪一个。", "inputFormat": "第 $1$ 行一个正整数 $N$，表示班上同学的个数。\n\n第 $2$ 行包含 $N$ 个用空格隔开的非负整数，第 $i$ 个数表示 $A_i$。", "outputFormat": "两行，每行 $N$ 个正整数，用空格隔开。其中，第 $1$ 行为小 L 的心理排名，第 $2$ 行为小 X 的心理排名。", "hint": "### 样例解释\n\n共有 $3$ 种排名满足大小关系：\n\n```plain\n4 1 3 2\n4 1 2 3\n3 1 2 4\n```\n\n其中，`3 1 2 4` 字典序最小，`4 1 3 2` 字典序最大。\n\n### 数据范围\n\n对于 $10\\%$ 的数据，$N\\leq 10$。\n\n对于 $20\\%$ 的数据，$N\\leq 20$。\n\n对于 $40\\%$ 的数据，$N\\leq 2\\times 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\leq N\\leq 2\\times 10^5,A_i\\leq N$。其中，第 $5$ 组数据保证 $N=1.2\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5755", "type": "P", "difficulty": 3, "samples": [["A\nAN\nASP\nAS\nASC\nASCII\nBAS\nBASIC\n", "13\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2000", "NOI", "字典树 Trie"], "title": "[NOI2000] 单词查找树", "background": "", "description": "在进行文法分析的时候，通常需要检测一个单词是否在我们的单词列表里。为了提高查找和定位的速度，通常都要画出与单词列表所对应的单词查找树，其特点如下：\n-\t根节点不包含字母，除根节点外每一个节点都仅包含一个大写英文字母；\n-\t从根节点到某一节点，路径上经过的字母依次连起来所构成的字母序列，称为该节点对应的单词。单词列表中的每个词，都是该单词查找树某个节点所对应的单词；\n-\t在满足上述条件下，该单词查找树的节点数最少。\n\n\n例：图一的单词列表对应图二的单词查找树\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zolscsb0.png)\n\n对一个确定的单词列表，请统计对应的单词查找树的节点数（包括根节点）\n", "inputFormat": "一个单词列表，每一行仅包含一个单词。每个单词仅由大写的英文字符组成，长度不超过 $63$ 个字符。文件总长度不超过 32K，至少有一行数据。", "outputFormat": "仅包含一个整数。该整数为单词列表对应的单词查找树的节点数。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2000] Word Lookup Tree.", "background": "", "description": "When doing grammar analysis, we usually need to check whether a word is in our word list. To improve the speed of searching and locating, we often build a word lookup tree corresponding to the word list, with the following features:\n\n- The root node contains no letter. Every node except the root contains exactly one uppercase English letter.\n- For any node, the sequence of letters along the path from the root to that node, concatenated in order, is called the word corresponding to that node. Every word in the word list is the word corresponding to some node in the word lookup tree.\n- Under the above conditions, the word lookup tree has the minimum possible number of nodes.\n\nExample: the word list in Figure 1 corresponds to the word lookup tree in Figure 2.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zolscsb0.png)\n\nFor a given word list, count the number of nodes in the corresponding word lookup tree (including the root node).", "inputFormat": "A word list, one word per line. Each word consists only of uppercase English letters and has length at most $63$. The total file length does not exceed 32K. There is at least one line of data.", "outputFormat": "Output a single integer. This integer is the number of nodes in the word lookup tree corresponding to the word list.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2000] 单词查找树", "background": "", "description": "在进行文法分析的时候，通常需要检测一个单词是否在我们的单词列表里。为了提高查找和定位的速度，通常都要画出与单词列表所对应的单词查找树，其特点如下：\n-\t根节点不包含字母，除根节点外每一个节点都仅包含一个大写英文字母；\n-\t从根节点到某一节点，路径上经过的字母依次连起来所构成的字母序列，称为该节点对应的单词。单词列表中的每个词，都是该单词查找树某个节点所对应的单词；\n-\t在满足上述条件下，该单词查找树的节点数最少。\n\n\n例：图一的单词列表对应图二的单词查找树\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zolscsb0.png)\n\n对一个确定的单词列表，请统计对应的单词查找树的节点数（包括根节点）\n", "inputFormat": "一个单词列表，每一行仅包含一个单词。每个单词仅由大写的英文字符组成，长度不超过 $63$ 个字符。文件总长度不超过 32K，至少有一行数据。", "outputFormat": "仅包含一个整数。该整数为单词列表对应的单词查找树的节点数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5756", "type": "P", "difficulty": 4, "samples": [["10 A+1\n20 IF A=5 GO 60\n60 END\n30 A+2\n40 A?\n50 GO 20\n", "11\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2000", "NOI"], "title": "[NOI2000] 程序分析器", "background": "", "description": "Tiny Basm语言(简称为TB语言)的巴科斯-瑙尔范式(BNF)为：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/37ipxplt.png)\n\n错误语句示例(在输入文件中不会出现任何错误语句)：\n\n- `10 A+1.5`（不符合累加语句的定义，所加的不是整数）\n- `20 A ?`（不符合输出语句的定义，多加了一个空格）\n- `30 IF A=B GO 10`（不符合条件语句的定义，不应变量=变量）\n\n$\\\\$\n\nTB程序的执行：\n-\t程序从行号最小的一条语句开始执行，在未遇到条件语句时按行号由小至大顺序执行。\n-\t所有变量在程序执行前被自动初始化为 $0$。\n-\t累加语句将语句中变量的值加上语句中的整数送回该变量。\n-\t输出语句将语句中变量的值在监视器上显示出来。\n-\t执行条件语句时，当且仅当该语句中的变量与紧跟在等号后面的整数值相等，后面的转移语句才被执行。该语句中的所有整数值至多为 $4$ 位。\n-\t转移语句被执行后，程序将转去执行 $\\tt GO$ 后面指定的行号的语句。\n-\t当程序执行结束语句后，结束整个程序的执行。\n-\t假设该系统能处理任意大小的整数，而不会发生溢出。\n\n\n请编程，对于给定的 TB 语言程序 $P$，求该程序所执行的语句数（执行条件语句不论是否成功转移，仅记为执行一条语句）。", "inputFormat": "- 为一个TB语言程序 $P$ ，语句数不超过 $100$ 行。\n- $P$ 中每条语句的长度不超过 $20$ 个字符。\n- $P$ 中转移语句里 $\\tt GO$ 后面的行号一定有对应的语句。\n- $P$ 中可能有多个不同行号的结束语句。\n- $P$ 中行号最大的语句一定是结束语句。\n- $P$ 中的行号都不大于 $3000$。\n- 输入文件不一定是按行号递增顺序给出 $P$ 的。\n", "outputFormat": "-\t有且仅有一行：\n\n如果程序能够正常结束，输出该程序所执行的语句数；\n\n如果程序不能正常结束，输出 $-1$。\n", "hint": "**样例说明**\n\n执行语句行号按顺序为 $10→20→30→40→50→20→30→40→50→20→60$。\n\n共 $11$ 条语句被执行。\n", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2000] Program Analyzer", "background": "", "description": "The Backus–Naur Form (BNF) of the Tiny Basm language (abbreviated as TB) is:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/37ipxplt.png)\n\nExamples of incorrect statements (no incorrect statements will appear in the input file):\n\n- `10 A+1.5` (does not match the definition of an addition statement, because the added value is not an integer)\n- `20 A ?` (does not match the definition of an output statement, because there is an extra space)\n- `30 IF A=B GO 10` (does not match the definition of a conditional statement; it should not be variable $=$ variable)\n\n$\\\\$\n\nExecution of a TB program:\n\n- The program starts executing from the statement with the smallest line number. Before encountering any conditional statement, it executes statements in increasing order of line number.\n- All variables are automatically initialized to $0$ before execution.\n- An addition statement adds the integer in the statement to the value of the variable, and stores the result back into that variable.\n- An output statement displays the value of the variable in the statement on the monitor.\n- When executing a conditional statement, the following jump statement is executed if and only if the variable in the statement is equal to the integer value immediately after the equals sign. All integer values in this statement are at most $4$ digits.\n- After a jump statement is executed, the program jumps to the statement with the line number specified after $\\tt GO$.\n- When the program executes an end statement, the entire program terminates.\n- Assume the system can handle integers of any size without overflow.\n\nPlease write a program that, for a given TB program $P$, computes the number of statements executed by the program (for a conditional statement, regardless of whether the jump succeeds, it is counted as executing exactly one statement).", "inputFormat": "- The input is a TB program $P$, with no more than $100$ statements (lines).\n- The length of each statement in $P$ does not exceed $20$ characters.\n- For every jump statement in $P$, the line number after $\\tt GO$ definitely has a corresponding statement.\n- $P$ may contain multiple end statements with different line numbers.\n- The statement with the largest line number in $P$ is definitely an end statement.\n- All line numbers in $P$ are no greater than $3000$.\n- The input file does not necessarily list $P$ in increasing order of line numbers.", "outputFormat": "- There is exactly one line:\n\nIf the program can terminate normally, output the number of statements executed;\n\nif the program cannot terminate normally, output $-1$.", "hint": "**Sample Explanation**\n\nThe executed line numbers in order are $10→20→30→40→50→20→30→40→50→20→60$.\n\nA total of $11$ statements are executed.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2000] 程序分析器", "background": "", "description": "Tiny Basm语言(简称为TB语言)的巴科斯-瑙尔范式(BNF)为：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/37ipxplt.png)\n\n错误语句示例(在输入文件中不会出现任何错误语句)：\n\n- `10 A+1.5`（不符合累加语句的定义，所加的不是整数）\n- `20 A ?`（不符合输出语句的定义，多加了一个空格）\n- `30 IF A=B GO 10`（不符合条件语句的定义，不应变量=变量）\n\n$\\\\$\n\nTB程序的执行：\n-\t程序从行号最小的一条语句开始执行，在未遇到条件语句时按行号由小至大顺序执行。\n-\t所有变量在程序执行前被自动初始化为 $0$。\n-\t累加语句将语句中变量的值加上语句中的整数送回该变量。\n-\t输出语句将语句中变量的值在监视器上显示出来。\n-\t执行条件语句时，当且仅当该语句中的变量与紧跟在等号后面的整数值相等，后面的转移语句才被执行。该语句中的所有整数值至多为 $4$ 位。\n-\t转移语句被执行后，程序将转去执行 $\\tt GO$ 后面指定的行号的语句。\n-\t当程序执行结束语句后，结束整个程序的执行。\n-\t假设该系统能处理任意大小的整数，而不会发生溢出。\n\n\n请编程，对于给定的 TB 语言程序 $P$，求该程序所执行的语句数（执行条件语句不论是否成功转移，仅记为执行一条语句）。", "inputFormat": "- 为一个TB语言程序 $P$ ，语句数不超过 $100$ 行。\n- $P$ 中每条语句的长度不超过 $20$ 个字符。\n- $P$ 中转移语句里 $\\tt GO$ 后面的行号一定有对应的语句。\n- $P$ 中可能有多个不同行号的结束语句。\n- $P$ 中行号最大的语句一定是结束语句。\n- $P$ 中的行号都不大于 $3000$。\n- 输入文件不一定是按行号递增顺序给出 $P$ 的。\n", "outputFormat": "-\t有且仅有一行：\n\n如果程序能够正常结束，输出该程序所执行的语句数；\n\n如果程序不能正常结束，输出 $-1$。\n", "hint": "**样例说明**\n\n执行语句行号按顺序为 $10→20→30→40→50→20→30→40→50→20→60$。\n\n共 $11$ 条语句被执行。\n", "locale": "zh-CN"}}}
{"pid": "P5757", "type": "P", "difficulty": 6, "samples": [["11\nn.table\nn.baleine\na.silly\nn.snoopy\nn.sillysnoopy\nv.is\nv.isnot\nn.kick\nv.kick\na.big\nv.cry\nsillysnoopyisnotbigtablebaleinekicksnoopysillycry.\n", "2\n9\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2000", "NOI"], "title": "[NOI2000] 古城之谜", "background": "", "description": "著名的考古学家石教授在云梦高原上发现了一处古代城市遗址。让教授欣喜的是在这个他称为冰峰城 (Ice-Peak City) 的城市中有 $12$ 块巨大石碑，上面刻着用某种文字书写的资料，他称这种文字为冰峰文。然而当教授试图再次找到冰峰城时，却屡屡无功而返。\n\n幸好当时教授把石碑上的文字都拍摄了下来，为了解开冰峰城的秘密，教授和他的助手牛博士开始研究冰峰文，发现冰峰文只有陈述句这一种句型和名词 (n) 、动词 (v) 、辅词 (a) 这三类单词，且其文法很简单：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fj2tbbqd.png)\n\n在研究了大量资料后，他们总结了一部冰峰文词典，由于冰峰文恰好有 $26$ 个字母，为了研究方便，用字母 $a$ 到 $z$ 表示它们。\n\n冰峰文在句子和句子之间以及单词和单词之间没有任何分隔符，因此划分单词和句子令石教授和牛博士感到非常麻烦，于是他们想到了使用计算机来帮助解决这个问题。假设你接受了这份工作，你的第一个任务是写一个程序，将一篇冰峰文文章划分为最少的句子，在这个前提下，将文章划分为最少的单词。\n", "inputFormat": "-\t第 $1$ 行为词典中的单词数 $n$ （$ n \\le 1000 $）。\n-\t第 $2$ 行至第 $(n+1)$ 行每行表示一个单词，形为 $\"α.mot\"$ ，$α$ 表示词性，可能是 n (名词), v（动词）, a（辅词）中的一个， $mot$ 为单词，单词的长度不超过 $20$ 。拼写相同而词性不同的单词视为不同的单词，如输入示例中的 n.kick 与 v.kick 是两个不同的单词。\n-\t输入文件第 $(n+2)$ 行为需要划分的文章，以 \".\" 结束。\n-\t输入文件中的文章确保为冰峰文。文章是由有限个句子组成的，每个句子只包含有限个单词。文章长度不超过 5KB。\n", "outputFormat": "-\t为两行，每行一个整数。\n-\t第 $1$ 行为划分出来的句子数。\n-\t第 $2$ 行为划分出来的单词数。\n", "hint": "**样例说明**\n\n（为了阅读方便，划分的单词用空格分隔，在单词的右上角标出它的词性，每行写一个句子，用句号表示句子结束。）\n\n输出对应的划分：\n\n$ sillysnoopy^n \\quad isnot^v \\quad big^a \\quad table^n. \\\\\nbaleine^n \\quad kick^v \\quad snoopy^n \\quad silly^a \\quad cry^v. $\n\n如果用下面的划分：\n\n$ silly^a \\quad snoopy^n \\quad isnot^v \\quad big^a \\quad table^n. \\\\\nbaleine^n \\quad kick^v \\quad snoopy^n \\quad silly^a \\quad cry^v.$\n\n则划分的句子数仍为 $2$ 个，但单词数却多了 $1$ 个，为 $10$ 个，显然应该按前者而不是后者划分。\n", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2000] Mystery of the Ancient City", "background": "", "description": "The famous archaeologist Professor Shi discovered an ancient city ruin on the Yunmeng Plateau. To his delight, in this city that he called Ice-Peak City, there were $12$ huge stone tablets, engraved with information written in some kind of script, which he named the Ice-Peak script. However, when Professor Shi tried to find Ice-Peak City again, he failed again and again.\n\nFortunately, he had photographed all the text on the tablets. In order to uncover the secrets of Ice-Peak City, Professor Shi and his assistant Dr. Niu began to study the Ice-Peak script. They found that the Ice-Peak script has only one sentence type: declarative sentences, and only three categories of words: nouns (n), verbs (v), and auxiliary words (a). Its grammar is very simple:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fj2tbbqd.png)\n\nAfter studying a large amount of material, they summarized an Ice-Peak dictionary. Since the Ice-Peak script happens to have $26$ letters, for convenience they use the letters $a$ to $z$ to represent them.\n\nIn the Ice-Peak script, there are no separators between sentences, nor between words. So splitting words and sentences is very troublesome for Professor Shi and Dr. Niu. They decided to use a computer to help solve this problem. Suppose you accept this job. Your first task is to write a program that splits an Ice-Peak article into the minimum number of sentences, and under this premise, splits the article into the minimum number of words.", "inputFormat": "- Line $1$ contains the number of words in the dictionary $n$ ($n \\le 1000$).\n- Lines $2$ to $(n+1)$ each describe one word, in the form $\"α.mot\"$. Here $α$ is the part of speech, which can be one of n (noun), v (verb), a (auxiliary word), and $mot$ is the word. The word length does not exceed $20$. Words with the same spelling but different parts of speech are considered different words. For example, n.kick and v.kick in the sample input are two different words.\n- Line $(n+2)$ of the input file is the article to be split, ending with \".\".\n- The article in the input file is guaranteed to be in the Ice-Peak script. The article consists of finitely many sentences, and each sentence contains only finitely many words. The article length does not exceed 5 KB.", "outputFormat": "- Output two lines, each containing one integer.\n- Line $1$ is the number of sentences after splitting.\n- Line $2$ is the number of words after splitting.", "hint": "**Sample Explanation**\n\n(For easier reading, the split words are separated by spaces, the part of speech is marked at the upper right of each word, one sentence per line, and a period indicates the end of a sentence.)\n\nThe output corresponds to the following splitting:\n\n$ sillysnoopy^n \\quad isnot^v \\quad big^a \\quad table^n. \\\\\nbaleine^n \\quad kick^v \\quad snoopy^n \\quad silly^a \\quad cry^v. $\n\nIf the following splitting is used:\n\n$ silly^a \\quad snoopy^n \\quad isnot^v \\quad big^a \\quad table^n. \\\\\nbaleine^n \\quad kick^v \\quad snoopy^n \\quad silly^a \\quad cry^v.$\n\nthen the number of sentences is still $2$, but the number of words increases by $1$ to $10$. Clearly, the former splitting should be chosen rather than the latter.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2000] 古城之谜", "background": "", "description": "著名的考古学家石教授在云梦高原上发现了一处古代城市遗址。让教授欣喜的是在这个他称为冰峰城 (Ice-Peak City) 的城市中有 $12$ 块巨大石碑，上面刻着用某种文字书写的资料，他称这种文字为冰峰文。然而当教授试图再次找到冰峰城时，却屡屡无功而返。\n\n幸好当时教授把石碑上的文字都拍摄了下来，为了解开冰峰城的秘密，教授和他的助手牛博士开始研究冰峰文，发现冰峰文只有陈述句这一种句型和名词 (n) 、动词 (v) 、辅词 (a) 这三类单词，且其文法很简单：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fj2tbbqd.png)\n\n在研究了大量资料后，他们总结了一部冰峰文词典，由于冰峰文恰好有 $26$ 个字母，为了研究方便，用字母 $a$ 到 $z$ 表示它们。\n\n冰峰文在句子和句子之间以及单词和单词之间没有任何分隔符，因此划分单词和句子令石教授和牛博士感到非常麻烦，于是他们想到了使用计算机来帮助解决这个问题。假设你接受了这份工作，你的第一个任务是写一个程序，将一篇冰峰文文章划分为最少的句子，在这个前提下，将文章划分为最少的单词。\n", "inputFormat": "-\t第 $1$ 行为词典中的单词数 $n$ （$ n \\le 1000 $）。\n-\t第 $2$ 行至第 $(n+1)$ 行每行表示一个单词，形为 $\"α.mot\"$ ，$α$ 表示词性，可能是 n (名词), v（动词）, a（辅词）中的一个， $mot$ 为单词，单词的长度不超过 $20$ 。拼写相同而词性不同的单词视为不同的单词，如输入示例中的 n.kick 与 v.kick 是两个不同的单词。\n-\t输入文件第 $(n+2)$ 行为需要划分的文章，以 \".\" 结束。\n-\t输入文件中的文章确保为冰峰文。文章是由有限个句子组成的，每个句子只包含有限个单词。文章长度不超过 5KB。\n", "outputFormat": "-\t为两行，每行一个整数。\n-\t第 $1$ 行为划分出来的句子数。\n-\t第 $2$ 行为划分出来的单词数。\n", "hint": "**样例说明**\n\n（为了阅读方便，划分的单词用空格分隔，在单词的右上角标出它的词性，每行写一个句子，用句号表示句子结束。）\n\n输出对应的划分：\n\n$ sillysnoopy^n \\quad isnot^v \\quad big^a \\quad table^n. \\\\\nbaleine^n \\quad kick^v \\quad snoopy^n \\quad silly^a \\quad cry^v. $\n\n如果用下面的划分：\n\n$ silly^a \\quad snoopy^n \\quad isnot^v \\quad big^a \\quad table^n. \\\\\nbaleine^n \\quad kick^v \\quad snoopy^n \\quad silly^a \\quad cry^v.$\n\n则划分的句子数仍为 $2$ 个，但单词数却多了 $1$ 个，为 $10$ 个，显然应该按前者而不是后者划分。\n", "locale": "zh-CN"}}}
{"pid": "P5758", "type": "P", "difficulty": 7, "samples": [["2\nabcdec\ncdefe\n", "a6\nb*\nd=\nf+\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2000", "NOI"], "title": "[NOI2000] 算符破译", "background": "", "description": "考古学发现，几千年前古梅文明时期的数学非常的发达，他们懂得多位数的加法和乘法，其表达式和运算规则等都与现在通常所用的方式完全相同（如整数是十进制，左边是高位，最高位不能为零；表达式为中缀运算，先乘后加等），唯一的区别是其符号的写法与现在不同。有充分的证据表明，古梅文明的数学文字一共有 $13$ 个符号，与 \n $0,1,2,3,4,5,6,7,8,9,+,*,=$ 这 $13$ 个数字和符号（称为现代算符）一一对应。为了便于标记，我们用 $13$ 个小写英文字母 $a,b,…m$ 代替这些符号（称为古梅算符）。但是，还没有人知道这些古梅算符和现代算符之间的具体对应关系。\n\n在一个石壁上，考古学家发现了一组用古梅算符表示的等式，根据推断，每行有且仅有一个等号，等号左右两边为运算表达式（只含有数字和符号），并且等号两边的计算结果相等。\n\n假设这组等式是成立的，请编程序破译古梅算符和现代算符之间的对应关系。\n", "inputFormat": "-\t第一行为等式的个数 $N$ （$ 1 \\le N \\le 1000 $），以下 $N$ 行每行为一个等式。\n-\t每个等式的长度为 $5$ 个字符到 $11$ 个字符。\n", "outputFormat": "-\t如果不存在对应关系能够满足这组等式，输出`noway`。\n-\t如果有对应关系能够满足这组等式，输出所有能够确定的古梅算符和现代算符的对应关系。每一行有两个字符，其中第一个字符是古梅算符，第二个字符是对应的现代算符。输出按照字典顺序排序。", "hint": "**样例说明**\n\n在上例中，可能对应的现代表达式为 $ \\{6*2=12，2=1+1 \\}， \\{6*4=24，4=2+2 \\}，\\{ 6*8=48，8=4+4 \\} $。可见，能够确定的对应关系只有 $a$ 对应 $6$ ，$b$ 对应 $*$ ，$d$ 对应 $=$，$f$ 对应 $+$ ，应该输出；而 ${c,e}$ 虽然能够找到对应的现代算符使得等式成立，但没有唯一的对应关系，不能输出。其他古梅算符 ${g,h…m}$ 完全不能确定，也不能输出。\n", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2000] Operator Decoding", "background": "", "description": "Archaeological discoveries show that several thousand years ago, during the ancient Gumei civilization, mathematics was very advanced. They knew multi-digit addition and multiplication, and their expressions and calculation rules were exactly the same as those commonly used today (for example, integers are in decimal, the left side is the higher digit, the highest digit cannot be zero; expressions use infix notation, multiplication before addition, etc.). The only difference is that their symbols were written differently.\n\nThere is strong evidence that the mathematical writing system of the ancient Gumei civilization had a total of $13$ symbols, which correspond one-to-one to the $13$ digits and symbols $0,1,2,3,4,5,6,7,8,9,+,*,=$ (called modern operators). For convenience, we use $13$ lowercase English letters $a,b,\\ldots,m$ to represent these symbols (called Gumei operators). However, nobody knows the exact correspondence between the Gumei operators and the modern operators.\n\nOn a stone wall, archaeologists found a set of equations written using Gumei operators. According to inference, each line contains exactly one equals sign, and the left and right sides of the equals sign are arithmetic expressions (containing only digits and symbols), and the computed results on both sides are equal.\n\nAssuming this set of equations is correct, write a program to decode the correspondence between Gumei operators and modern operators.", "inputFormat": "- The first line contains the number of equations $N$ ($1 \\le N \\le 1000$). The following $N$ lines each contain one equation.\n- The length of each equation is from $5$ characters to $11$ characters.", "outputFormat": "- If there is no correspondence that can satisfy this set of equations, output `noway`.\n- If there exists a correspondence that can satisfy this set of equations, output all correspondences between Gumei operators and modern operators that can be determined. Each line contains two characters: the first character is a Gumei operator, and the second character is the corresponding modern operator. Output them in lexicographical order.", "hint": "**Sample Explanation**\n\nIn the example above, possible corresponding modern expressions could be $\\{6*2=12, 2=1+1\\}$, $\\{6*4=24, 4=2+2\\}$, $\\{6*8=48, 8=4+4\\}$. It can be seen that the only correspondences that can be determined are: $a$ corresponds to $6$, $b$ corresponds to $*$, $d$ corresponds to $=$, and $f$ corresponds to $+$. These should be output. However, although ${c,e}$ can be matched with modern operators to make the equations valid, there is no unique correspondence, so they should not be output. The other Gumei operators ${g,h,\\ldots,m}$ cannot be determined at all and also should not be output.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2000] 算符破译", "background": "", "description": "考古学发现，几千年前古梅文明时期的数学非常的发达，他们懂得多位数的加法和乘法，其表达式和运算规则等都与现在通常所用的方式完全相同（如整数是十进制，左边是高位，最高位不能为零；表达式为中缀运算，先乘后加等），唯一的区别是其符号的写法与现在不同。有充分的证据表明，古梅文明的数学文字一共有 $13$ 个符号，与 \n $0,1,2,3,4,5,6,7,8,9,+,*,=$ 这 $13$ 个数字和符号（称为现代算符）一一对应。为了便于标记，我们用 $13$ 个小写英文字母 $a,b,…m$ 代替这些符号（称为古梅算符）。但是，还没有人知道这些古梅算符和现代算符之间的具体对应关系。\n\n在一个石壁上，考古学家发现了一组用古梅算符表示的等式，根据推断，每行有且仅有一个等号，等号左右两边为运算表达式（只含有数字和符号），并且等号两边的计算结果相等。\n\n假设这组等式是成立的，请编程序破译古梅算符和现代算符之间的对应关系。\n", "inputFormat": "-\t第一行为等式的个数 $N$ （$ 1 \\le N \\le 1000 $），以下 $N$ 行每行为一个等式。\n-\t每个等式的长度为 $5$ 个字符到 $11$ 个字符。\n", "outputFormat": "-\t如果不存在对应关系能够满足这组等式，输出`noway`。\n-\t如果有对应关系能够满足这组等式，输出所有能够确定的古梅算符和现代算符的对应关系。每一行有两个字符，其中第一个字符是古梅算符，第二个字符是对应的现代算符。输出按照字典顺序排序。", "hint": "**样例说明**\n\n在上例中，可能对应的现代表达式为 $ \\{6*2=12，2=1+1 \\}， \\{6*4=24，4=2+2 \\}，\\{ 6*8=48，8=4+4 \\} $。可见，能够确定的对应关系只有 $a$ 对应 $6$ ，$b$ 对应 $*$ ，$d$ 对应 $=$，$f$ 对应 $+$ ，应该输出；而 ${c,e}$ 虽然能够找到对应的现代算符使得等式成立，但没有唯一的对应关系，不能输出。其他古梅算符 ${g,h…m}$ 完全不能确定，也不能输出。\n", "locale": "zh-CN"}}}
{"pid": "P5759", "type": "P", "difficulty": 3, "samples": [["3\n72 82 73 68 95 86 82 90\n72 90 50 60 80 70 65 80\n72 82 73 68 95 86 82 90\n", "1\n3\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["1997", "NOI"], "title": "[NOI1997] 竞赛排名", "background": "", "description": "某市组织了一次中学生科技全能竞赛，每个选手要参加数学、物理、化学、天文、地理、生物、计算机和英语共八项竞赛,最后综合八项竞赛的成绩排出总名次。\n\n选手编号依次为： $1,2,\\dots,N$（$N$ 为参赛总人数）。设 $x_{i, j}$（$1 \\le i \\le N, 1 \\le j \\le 8$）分别表示编号为 $i$ 的选手第 $j$ 项竞赛的成绩。其它指标如下：\n\n- 第 $j$（$1 \\le j \\le 8$）项竞赛的平均分 $avg_j = \\frac{1}{N} \\sum_{i=1}^N x_{i, j}$\n- 选手 $i$（$1 \\le i \\le N$）的总分 $sumx_i = \\sum_{j=1}^8 x_{i, j}$\n- 选手 $i$（$1 \\le i \\le N$）第 $j$（$1 \\le j \\le 8$）项竞赛的位置分\n\n$$\ny_{i, j}= \\begin{cases} 0 & \\left(\\sum_{i = 1} ^ N |x_{i, j} - avg_j| = 0\\right) \\\\ \\frac{x_{i, j} - avg_j}{\\frac{1}{N} \\sum_{i = 1} ^ N |x_{i ,j} - agv_j|} & \\left(\\sum_{i = 1} ^ N |x_{i, j} - avg_j| \\ne 0\\right)\\end{cases}\n$$\n\n- 选手 $i$（$1 \\le i \\le N$）的总位置分 $sumy_i = \\sum_{j=1}^3 y_{i, j} + 0.8 \\sum_{j=4}^8 y_{i, j}$\n\n排名规则如下:\n1. 总位置分高的选手名次在前；\n2. 若两个或两个以上的选手总位置分相同，则总分高的选手名次在前；\n3. 若两个或两个以上的选手总位置分和总分均相同，则编号在前的选手名次在前。\n\n请你为竞赛组委会编一程序，计算本次全能竞赛的总排名情况。", "inputFormat": "第一行为参赛总人数 $N$，从第二行到第 $N$ 行依次为编号为 $1$ 到编号为 $N$ 的选手的成绩，每行有 $8$ 个 $0 \\sim 100$ 之间的整数，代表该选手的 $8$ 项竞赛成绩 。同一行相邻两个数之间用一个空格符隔开。", "outputFormat": "有 $N$ 行，从第 $1$ 行到第 $N$ 行依次为排名第 $1$ 的选手的编号，排名第 $2$ 的选手的编号，……，排名第 $N$ 的选手的编号。", "hint": "#### 数据范围\n\n对于所有测试数据，满足 $1 \\le N \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI1997] Contest Ranking", "background": "", "description": "A city organized an all-round science and technology contest for middle school students. Each participant takes part in eight contests: Mathematics, Physics, Chemistry, Astronomy, Geography, Biology, Computer Science, and English. In the end, the overall ranking is determined based on the combined results of these eight contests.\n\nThe contestant IDs are $1,2,\\dots,N$ ($N$ is the total number of participants). Let $x_{i, j}$ ($1 \\le i \\le N, 1 \\le j \\le 8$) denote the score of contestant $i$ in contest $j$. Other indicators are defined as follows:\n\n- The average score of contest $j$ ($1 \\le j \\le 8$): $avg_j = \\frac{1}{N} \\sum_{i=1}^N x_{i, j}$\n- The total score of contestant $i$ ($1 \\le i \\le N$): $sumx_i = \\sum_{j=1}^8 x_{i, j}$\n- The positional score of contestant $i$ ($1 \\le i \\le N$) in contest $j$ ($1 \\le j \\le 8$):\n\n$$\ny_{i, j}= \\begin{cases} 0 & \\left(\\sum_{i = 1} ^ N |x_{i, j} - avg_j| = 0\\right) \\\\ \\frac{x_{i, j} - avg_j}{\\frac{1}{N} \\sum_{i = 1} ^ N |x_{i ,j} - agv_j|} & \\left(\\sum_{i = 1} ^ N |x_{i, j} - avg_j| \\ne 0\\right)\\end{cases}\n$$\n\n- The total positional score of contestant $i$ ($1 \\le i \\le N$): $sumy_i = \\sum_{j=1}^3 y_{i, j} + 0.8 \\sum_{j=4}^8 y_{i, j}$\n\nThe ranking rules are as follows:\n1. Contestants with higher total positional scores rank earlier.\n2. If two or more contestants have the same total positional score, the one with the higher total score ranks earlier.\n3. If two or more contestants have the same total positional score and the same total score, the one with the smaller ID ranks earlier.\n\nPlease write a program for the contest committee to compute the overall ranking for this all-round contest.", "inputFormat": "The first line contains the total number of participants $N$. From the second line to the $N$-th line, the scores of contestants with IDs from $1$ to $N$ are given in order. Each line contains $8$ integers between $0$ and $100$, representing the contestant’s scores in the 8 contests. Adjacent numbers on the same line are separated by one space.", "outputFormat": "Output $N$ lines. From line 1 to line $N$, output the ID of the contestant ranked 1st, the ID of the contestant ranked 2nd, $\\dots$, and the ID of the contestant ranked $N$-th.", "hint": "#### Constraints\n\nFor all testdata, $1 \\le N \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1997] 竞赛排名", "background": "", "description": "某市组织了一次中学生科技全能竞赛，每个选手要参加数学、物理、化学、天文、地理、生物、计算机和英语共八项竞赛,最后综合八项竞赛的成绩排出总名次。\n\n选手编号依次为： $1,2,\\dots,N$（$N$ 为参赛总人数）。设 $x_{i, j}$（$1 \\le i \\le N, 1 \\le j \\le 8$）分别表示编号为 $i$ 的选手第 $j$ 项竞赛的成绩。其它指标如下：\n\n- 第 $j$（$1 \\le j \\le 8$）项竞赛的平均分 $avg_j = \\frac{1}{N} \\sum_{i=1}^N x_{i, j}$\n- 选手 $i$（$1 \\le i \\le N$）的总分 $sumx_i = \\sum_{j=1}^8 x_{i, j}$\n- 选手 $i$（$1 \\le i \\le N$）第 $j$（$1 \\le j \\le 8$）项竞赛的位置分\n\n$$\ny_{i, j}= \\begin{cases} 0 & \\left(\\sum_{i = 1} ^ N |x_{i, j} - avg_j| = 0\\right) \\\\ \\frac{x_{i, j} - avg_j}{\\frac{1}{N} \\sum_{i = 1} ^ N |x_{i ,j} - agv_j|} & \\left(\\sum_{i = 1} ^ N |x_{i, j} - avg_j| \\ne 0\\right)\\end{cases}\n$$\n\n- 选手 $i$（$1 \\le i \\le N$）的总位置分 $sumy_i = \\sum_{j=1}^3 y_{i, j} + 0.8 \\sum_{j=4}^8 y_{i, j}$\n\n排名规则如下:\n1. 总位置分高的选手名次在前；\n2. 若两个或两个以上的选手总位置分相同，则总分高的选手名次在前；\n3. 若两个或两个以上的选手总位置分和总分均相同，则编号在前的选手名次在前。\n\n请你为竞赛组委会编一程序，计算本次全能竞赛的总排名情况。", "inputFormat": "第一行为参赛总人数 $N$，从第二行到第 $N$ 行依次为编号为 $1$ 到编号为 $N$ 的选手的成绩，每行有 $8$ 个 $0 \\sim 100$ 之间的整数，代表该选手的 $8$ 项竞赛成绩 。同一行相邻两个数之间用一个空格符隔开。", "outputFormat": "有 $N$ 行，从第 $1$ 行到第 $N$ 行依次为排名第 $1$ 的选手的编号，排名第 $2$ 的选手的编号，……，排名第 $N$ 的选手的编号。", "hint": "#### 数据范围\n\n对于所有测试数据，满足 $1 \\le N \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P5760", "type": "P", "difficulty": 4, "samples": [["4 2\n10 5 5\n8 7 7\n2 2 2\n6 6 6\n", "24\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["1997", "NOI"], "title": "[NOI1997] 积木游戏", "background": "", "description": "SERCOI 最近设计了一种积木游戏。每个游戏者有 $N$ 块编号依次为 $1 ，2，…，N$ 的长方体积木。对于每块积木,它的三条不同的边分别称为\"a 边\"、\"b 边\"和\"c 边\"，如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jfd5li1k.png)\n\n游戏规则如下：\n1. 从 $N$ 块积木中选出若干块，并将它们分成 $M$ （$ 1 \\le M \\le N $） 堆，称为第 $1$ 堆，第 $2$ 堆…，第 $M$ 堆。每堆至少有 $1$ 块积木，并且第 $K$ 堆中任意一块积木的编号要大于第 $K+1$ 堆中任意一块积木的编号($ 2 \\le K \\le M $)。\n\n2.  对于每一堆积木,游戏者要将它们垂直摞成一根柱子,并要求满足下面两个条件：\n\n$\\qquad$ 1)除最顶上的一块积木外，任意一块积木的上表面同且仅同另一块积木的下表面接触，并且要求下面的积木的上表面能包含上面的积木的下表面，也就是说，要求下面的积木的上表面的两对边的长度分别大于等于上面的积木的两对边的长度。\n\n$\\qquad$ 2)对于任意两块上下表面相接触的积木，下面的积木的编号要小于上面的积木的编号。\n\n最后，根据每人所摞成的 $M$ 根柱子的高度之和来决出胜负。\n\n请你编一程序，寻找一种摞积木的方案，使得你所摞成的 $M$ 根柱子的高度之和最大。\n", "inputFormat": "一行有两个正整数 $N$ 和 $M$ （$ 1 \\le M \\le N \\le 100 $），分别表\n示积木总数和要求摞成的柱子数。这两个数之间用一个空格符隔开。\n\n接下来 $N$ 行依次是编号从 $1$ 到 $N$ 的 $N$ 个积木的尺寸，每行有三个 $1$ 至 $1000$ 之间的整数，分别表示该积木 a 边, b 边和  c 边的长度。\n同一行相邻两个数之间用一个空格符隔开。\n", "outputFormat": "只有一行，为一个整数，表示 $M$ 根柱子的高度之和的最大值。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[NOI1997] Block Game", "background": "", "description": "SERCOI has recently designed a block game. Each player has $N$ rectangular blocks numbered $1, 2, \\ldots, N$. For each block, its three different edges are called the \"a edge\", \"b edge\", and \"c edge\", as shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jfd5li1k.png)\n\nThe rules are as follows:\n\n1. Choose some blocks from the $N$ blocks and divide them into $M$ ($1 \\le M \\le N$) piles, called pile $1$, pile $2$, $\\ldots$, pile $M$. Each pile must contain at least $1$ block, and for pile $K$, the number of any block in pile $K$ must be greater than the number of any block in pile $K+1$ ($2 \\le K \\le M$).\n\n2. For each pile, the player stacks the blocks vertically into a single column, and it must satisfy the following two conditions:\n\n$\\qquad$ 1) Except for the top block, the top face of any block must touch one and only one other block’s bottom face. Also, the top face of the lower block must be able to contain the bottom face of the upper block. That is, the lengths of the two pairs of edges on the top face of the lower block must each be greater than or equal to the corresponding two pairs of edges on the bottom face of the upper block.\n\n$\\qquad$ 2) For any two blocks whose top and bottom faces are in contact, the number of the lower block must be smaller than the number of the upper block.\n\nFinally, the winner is determined by the sum of the heights of the $M$ columns.\n\nPlease write a program to find a stacking plan such that the sum of the heights of the $M$ columns is maximized.", "inputFormat": "The first line contains two positive integers $N$ and $M$ ($1 \\le M \\le N \\le 100$), representing the total number of blocks and the required number of columns. The two numbers are separated by a space.\n\nThe next $N$ lines give the sizes of the $N$ blocks numbered from $1$ to $N$ in order. Each line contains three integers between $1$ and $1000$, representing the lengths of the a edge, b edge, and c edge of that block. Adjacent numbers on the same line are separated by a space.", "outputFormat": "Only one line containing one integer, which is the maximum possible sum of the heights of the $M$ columns.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1997] 积木游戏", "background": "", "description": "SERCOI 最近设计了一种积木游戏。每个游戏者有 $N$ 块编号依次为 $1 ，2，…，N$ 的长方体积木。对于每块积木,它的三条不同的边分别称为\"a 边\"、\"b 边\"和\"c 边\"，如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jfd5li1k.png)\n\n游戏规则如下：\n1. 从 $N$ 块积木中选出若干块，并将它们分成 $M$ （$ 1 \\le M \\le N $） 堆，称为第 $1$ 堆，第 $2$ 堆…，第 $M$ 堆。每堆至少有 $1$ 块积木，并且第 $K$ 堆中任意一块积木的编号要大于第 $K+1$ 堆中任意一块积木的编号($ 2 \\le K \\le M $)。\n\n2.  对于每一堆积木,游戏者要将它们垂直摞成一根柱子,并要求满足下面两个条件：\n\n$\\qquad$ 1)除最顶上的一块积木外，任意一块积木的上表面同且仅同另一块积木的下表面接触，并且要求下面的积木的上表面能包含上面的积木的下表面，也就是说，要求下面的积木的上表面的两对边的长度分别大于等于上面的积木的两对边的长度。\n\n$\\qquad$ 2)对于任意两块上下表面相接触的积木，下面的积木的编号要小于上面的积木的编号。\n\n最后，根据每人所摞成的 $M$ 根柱子的高度之和来决出胜负。\n\n请你编一程序，寻找一种摞积木的方案，使得你所摞成的 $M$ 根柱子的高度之和最大。\n", "inputFormat": "一行有两个正整数 $N$ 和 $M$ （$ 1 \\le M \\le N \\le 100 $），分别表\n示积木总数和要求摞成的柱子数。这两个数之间用一个空格符隔开。\n\n接下来 $N$ 行依次是编号从 $1$ 到 $N$ 的 $N$ 个积木的尺寸，每行有三个 $1$ 至 $1000$ 之间的整数，分别表示该积木 a 边, b 边和  c 边的长度。\n同一行相邻两个数之间用一个空格符隔开。\n", "outputFormat": "只有一行，为一个整数，表示 $M$ 根柱子的高度之和的最大值。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5761", "type": "P", "difficulty": 3, "samples": [["3 6\n-50 -47 -36 -30 -23\n17 -19 34 -13 -8\n-42 -3 -43 34 -45", "82"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["1997", "NOI"], "title": "[NOI1997] 最佳游览", "background": "", "description": "有一座旅游城，它的街道成网格状（如图）．其中东西向的街道是“风景线\"、两旁分布着许多景观：南北向的街道都是\"林萌道\"，两旁没有任何建筑物。由于游客众多，\" 风景线”被规定为单行道，游客在风景线上只能从西走到东，林荫道上则可以任意行走。\n\n一名游客将到这座旅游城旅游。他根据自己对景观的喜好给所有的风景线打了分，分值是从 $-100$ 到 $+100$ 的整数，分值越大表示我们的旅游者越喜欢这条风景线上的景致。显然这位游客不可能给这座旅游城的所有风景线都打负分。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/62qfloek.png)\n\n游客可以从旅游城的任一个十字路口开始游览，在任一个十字路口结束游览。我们的旅游者希望一路上游览的所有风景线的分值之和能够尽可能地大。请你写一个程序，帮助这位游客寻找一条最佳的游览路线。\n", "inputFormat": "第一行是两个整数 $M$ 和 $N$ ，之间用一个空格符隔开， $M$ 表示旅游城南北向林萌道的段数， $N$ 表示东西向风景线的段数，($ 1 \\le M \\le 100$，$1 \\le N \\le 20001 $)。\n\n接下来的 $M$ 行依次给出了由北向南各条风景线的分值信息。每行有 $N-1$ 个整数，依次表示了自西向东每段风景线的分值。同一行相邻两个数之间用一个空格隔开。\n", "outputFormat": "只有一行，含一个整数，表示你的程序所找到的最佳游览路线的总分值。\n", "hint": "**样例解释**\n\n路径为 $17 \\to -3 \\to 34 \\to 34$，答案为 $82$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI1997] Best Tour", "background": "", "description": "There is a tourist city whose streets form a grid (as shown in the figure). The streets running west to east are “scenic roads”, with many sights along both sides. The streets running north to south are “tree-lined roads”, with no buildings on either side. Because there are many tourists, the “scenic roads” are designated as one-way streets: on a scenic road, tourists can only walk from west to east. On tree-lined roads, they can walk freely in any direction.\n\nA tourist is going to visit this city. Based on how much they like the sights, they assign a score to every scenic road segment. The score is an integer from $-100$ to $+100$. A larger score means the tourist likes the scenery on that scenic road segment more. Obviously, this tourist cannot give negative scores to all scenic road segments in the whole city.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/62qfloek.png)\n\nThe tourist may start the tour at any intersection and end at any intersection. They want the sum of the scores of all scenic road segments traveled along the way to be as large as possible. Please write a program to help the tourist find an optimal tour route.", "inputFormat": "The first line contains two integers $M$ and $N$, separated by a space. $M$ is the number of segments of the north-south tree-lined roads, and $N$ is the number of segments of the west-east scenic roads ($1 \\le M \\le 100$, $1 \\le N \\le 20001$).\n\nThe next $M$ lines give the score information of the scenic roads from north to south. Each line contains $N - 1$ integers, describing the scores of each scenic road segment from west to east. Adjacent numbers in the same line are separated by a single space.", "outputFormat": "Only one line containing one integer, which is the total score of the optimal tour route found by your program.", "hint": "**Explanation of the sample**\n\nThe path is $17 \\to -3 \\to 34 \\to 34$, and the answer is $82$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1997] 最佳游览", "background": "", "description": "有一座旅游城，它的街道成网格状（如图）．其中东西向的街道是“风景线\"、两旁分布着许多景观：南北向的街道都是\"林萌道\"，两旁没有任何建筑物。由于游客众多，\" 风景线”被规定为单行道，游客在风景线上只能从西走到东，林荫道上则可以任意行走。\n\n一名游客将到这座旅游城旅游。他根据自己对景观的喜好给所有的风景线打了分，分值是从 $-100$ 到 $+100$ 的整数，分值越大表示我们的旅游者越喜欢这条风景线上的景致。显然这位游客不可能给这座旅游城的所有风景线都打负分。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/62qfloek.png)\n\n游客可以从旅游城的任一个十字路口开始游览，在任一个十字路口结束游览。我们的旅游者希望一路上游览的所有风景线的分值之和能够尽可能地大。请你写一个程序，帮助这位游客寻找一条最佳的游览路线。\n", "inputFormat": "第一行是两个整数 $M$ 和 $N$ ，之间用一个空格符隔开， $M$ 表示旅游城南北向林萌道的段数， $N$ 表示东西向风景线的段数，($ 1 \\le M \\le 100$，$1 \\le N \\le 20001 $)。\n\n接下来的 $M$ 行依次给出了由北向南各条风景线的分值信息。每行有 $N-1$ 个整数，依次表示了自西向东每段风景线的分值。同一行相邻两个数之间用一个空格隔开。\n", "outputFormat": "只有一行，含一个整数，表示你的程序所找到的最佳游览路线的总分值。\n", "hint": "**样例解释**\n\n路径为 $17 \\to -3 \\to 34 \\to 34$，答案为 $82$。", "locale": "zh-CN"}}}
{"pid": "P5762", "type": "P", "difficulty": 5, "samples": [["3\n0 0 0 3\n1 -1 0 1\n19 3 5 6\n", "1944\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["1997", "NOI"], "title": "[NOI1997] 卫星覆盖", "background": "", "description": "SERCOI（Space-Earth Resource Cover-Observe lnstitute） 是一个致力于利用卫星技术对空间和地球资源进行覆盖观测的组织。现在他们研制成功一种新型资源观测卫星 -SERCOI-308。这种卫星可以覆盖空间直角坐标系中一定大小的立方体空间，卫星处于该立方体的中心。\n    其中 $（x,y,z）$ 为立方体的中心点坐标， $r$ 为此中心点到立方体各个面的距离（即 $r$ 为立方体高的一半）．立方体的各条边均平行于相应的坐标轴。我们可以用一个四元组 $(x,y,z,r)$ 描述一颗卫星的状态，它所能覆盖的空间体积 。\n由于一颗卫星所能覆盖的空间体积是有限的，因此空间中可能有若干颗卫星协同工作。它们所覆盖的空间区域可能有重叠的地方，如下图所示（阴影部分表示重叠的区域）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yeajeuoh.png)\n\n写一个程序，根据给定的卫星分布情况，计算它们所覆盖的总体积。\n", "inputFormat": "第一行是一个正整数 $N$ （$ 1 \\le N \\le 100 $）：表示空间中的卫星总数。接下来的 $N$ 行每行给出了一颗卫星的状态，用空格隔开的四个正整数 $x,y,z,r$ 依次表示了该卫星所能覆盖的立方体空间的中心点坐标和半高，其中 ($ -1000 \\le x,y,z \\le 1000$，$1 \\le r \\le 200 )$。", "outputFormat": "只有一行,包括一个正整数，表示所有这些卫星所覆盖的空间总体积。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[NOI1997] Satellite Coverage", "background": "", "description": "SERCOI (Space-Earth Resource Cover-Observe Institute) is an organization dedicated to using satellite technology to observe and cover space and Earth resources. They have successfully developed a new type of resource-observation satellite, SERCOI-308. This satellite can cover a cube-shaped region of a certain size in a 3D Cartesian coordinate system, with the satellite located at the center of the cube.\n\nHere, $(x,y,z)$ is the coordinate of the cube’s center point, and $r$ is the distance from the center to each face of the cube (that is, $r$ is half of the cube’s height). All edges of the cube are parallel to the corresponding coordinate axes. We can use a 4-tuple $(x,y,z,r)$ to describe the state of a satellite, and the volume of space it can cover.\n\nSince the volume that a single satellite can cover is limited, there may be several satellites working together in space. The regions they cover may overlap, as shown in the figure below (the shaded part indicates the overlapping region).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yeajeuoh.png)\n\nWrite a program that, given the distribution of the satellites, computes the total volume covered by all of them.", "inputFormat": "The first line contains a positive integer $N$ ($1 \\le N \\le 100$), which represents the total number of satellites in space. The next $N$ lines each give the state of one satellite: four positive integers $x,y,z,r$ separated by spaces, representing the coordinates of the center of the cube it can cover and its half-height. Here, $-1000 \\le x,y,z \\le 1000$ and $1 \\le r \\le 200$.", "outputFormat": "Only one line, containing a positive integer, which represents the total volume of space covered by all these satellites.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1997] 卫星覆盖", "background": "", "description": "SERCOI（Space-Earth Resource Cover-Observe lnstitute） 是一个致力于利用卫星技术对空间和地球资源进行覆盖观测的组织。现在他们研制成功一种新型资源观测卫星 -SERCOI-308。这种卫星可以覆盖空间直角坐标系中一定大小的立方体空间，卫星处于该立方体的中心。\n    其中 $（x,y,z）$ 为立方体的中心点坐标， $r$ 为此中心点到立方体各个面的距离（即 $r$ 为立方体高的一半）．立方体的各条边均平行于相应的坐标轴。我们可以用一个四元组 $(x,y,z,r)$ 描述一颗卫星的状态，它所能覆盖的空间体积 。\n由于一颗卫星所能覆盖的空间体积是有限的，因此空间中可能有若干颗卫星协同工作。它们所覆盖的空间区域可能有重叠的地方，如下图所示（阴影部分表示重叠的区域）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yeajeuoh.png)\n\n写一个程序，根据给定的卫星分布情况，计算它们所覆盖的总体积。\n", "inputFormat": "第一行是一个正整数 $N$ （$ 1 \\le N \\le 100 $）：表示空间中的卫星总数。接下来的 $N$ 行每行给出了一颗卫星的状态，用空格隔开的四个正整数 $x,y,z,r$ 依次表示了该卫星所能覆盖的立方体空间的中心点坐标和半高，其中 ($ -1000 \\le x,y,z \\le 1000$，$1 \\le r \\le 200 )$。", "outputFormat": "只有一行,包括一个正整数，表示所有这些卫星所覆盖的空间总体积。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5763", "type": "P", "difficulty": 4, "samples": [["10\n1 3 10\n2 4 3\n3 4 4\n4 1 4\n5 3 4\n0 0 0\n", "12\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "1999", "线段树", "二分", "平衡树", "NOI"], "title": "[NOI1999] 内存分配", "background": null, "description": "内存是计算机重要的资源之一，程序运行的过程中必须对内存进行分配。\n\n经典的内存分配过程是这样进行的：\n1. 内存以内存单元为基本单位，每个内存单元用一个固定的整数作为标识，称为地址。地址从 $0$ 开始连续排列，地址相邻的内存单元被认为是逻辑上连续的。我们把从地址 $i$ 开始的 $s$ 个连续的内存单元称为首地址为 $i$ 长度为 $s$ 的地址片。 \n2. 运行过程中有若干进程需要占用内存，对于每个进程有一个申请时刻 $T$ ，需要内存单元数 $M$ 及运行时间 $P$。在运行时间 $P$ 内（即 $T$ 时刻开始，$T+P$ 时刻结束），这 $M$ 个被占用的内存单元不能再被其他进程使用。 \n3. 假设在 $T$ 时刻有一个进程申请 $M$ 个单元，且运行时间为 $P$ ，则：\n\n$\\qquad$ 1)\t若 $T$ 时刻内存中存在长度为 $M$ 的空闲地址片，则系统将这 $M$ 个空闲单元分配给该进程。若存在多个长度为 $M$ 个空闲地址片，则系统将首地址最小的那个空闲地址片分配给该进程。 \n\n$\\qquad$ 2)    如果 $T$ 时刻不存在长度为 $M$ 的空闲地址片，则该进程被放入一个等待队列。对于处于等待队列队头的进程，只要在任一时刻，存在长度为 $M$ 的空闲地址片，系统马上将该进程取出队列，并为它分配内存单元。注意，在进行内存分配处理过程中，处于等待队列队头的进程的处理优先级最高，队列中的其它进程不能先于队头进程被处理。 \n\n现在给出一系列描述进程的数据，请编写一程序模拟系统分配内存的过程。", "inputFormat": "第一行是一个数 $N$ ，表示总内存单元数（即地址范围从 $0$ 到 $N-1$ ）\n从第二行开始每行描述一个进程的三个整数 $T、M、P$ （$ M \\le N$）。\n\n**数据已按 $T$ 从小到大排序。**\n\n最后一行用`0 0 0`表示结束。\n\n输入文件最多 $10000$ 行，且所有数据都小于 $10^9$。\n\n输入文件中同一行相邻两项之间用一个或多个空格隔开。", "outputFormat": "共两行。\n\n第一行是全部进程都运行完毕的时刻。\n\n第二行是被放入过等待队列的进程总数。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[NOI1999] Memory Allocation", "background": "", "description": "Memory is one of the important resources of a computer. During program execution, memory must be allocated.\n\nA classic memory allocation process works as follows:\n\n1. Memory is divided into memory units as the basic unit. Each memory unit is identified by a fixed integer, called its address. Addresses start from $0$ and are arranged consecutively. Memory units with adjacent addresses are considered logically consecutive. We call the $s$ consecutive memory units starting from address $i$ an address segment with starting address $i$ and length $s$.\n2. During execution, several processes need to occupy memory. For each process, there is a request time $T$, a required number of memory units $M$, and a running time $P$. During the running time $P$ (i.e., starting at time $T$ and ending at time $T+P$), these $M$ occupied memory units cannot be used by other processes.\n3. Suppose that at time $T$ a process requests $M$ units and has running time $P$. Then:\n\n$\\qquad$ 1) If at time $T$ there exists a free address segment of length $M$ in memory, the system allocates these $M$ free units to the process. If there are multiple free address segments of length $M$, the system allocates the one with the smallest starting address to the process.\n\n$\\qquad$ 2) If at time $T$ there is no free address segment of length $M$, the process is put into a waiting queue. For the process at the head of the waiting queue, as long as at any moment there exists a free address segment of length $M$, the system immediately removes it from the queue and allocates memory units to it. Note that during the memory allocation procedure, the process at the head of the waiting queue has the highest priority. Other processes in the queue cannot be processed before the head process.\n\nNow you are given a sequence of data describing processes. Please write a program to simulate the system's memory allocation process.", "inputFormat": "The first line contains an integer $N$, which is the total number of memory units (i.e., the address range is from $0$ to $N-1$).\n\nStarting from the second line, each line describes a process with three integers $T, M, P$ ($M \\le N$).\n\n**The data are already sorted in increasing order of $T$.**\n\nThe last line is `0 0 0`, indicating the end.\n\nThe input file has at most $10000$ lines, and all data are less than $10^9$.\n\nAdjacent items on the same line in the input file are separated by one or more spaces.", "outputFormat": "There are two lines in total.\n\nThe first line is the time when all processes have finished running.\n\nThe second line is the total number of processes that have ever been put into the waiting queue.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1999] 内存分配", "background": null, "description": "内存是计算机重要的资源之一，程序运行的过程中必须对内存进行分配。\n\n经典的内存分配过程是这样进行的：\n1. 内存以内存单元为基本单位，每个内存单元用一个固定的整数作为标识，称为地址。地址从 $0$ 开始连续排列，地址相邻的内存单元被认为是逻辑上连续的。我们把从地址 $i$ 开始的 $s$ 个连续的内存单元称为首地址为 $i$ 长度为 $s$ 的地址片。 \n2. 运行过程中有若干进程需要占用内存，对于每个进程有一个申请时刻 $T$ ，需要内存单元数 $M$ 及运行时间 $P$。在运行时间 $P$ 内（即 $T$ 时刻开始，$T+P$ 时刻结束），这 $M$ 个被占用的内存单元不能再被其他进程使用。 \n3. 假设在 $T$ 时刻有一个进程申请 $M$ 个单元，且运行时间为 $P$ ，则：\n\n$\\qquad$ 1)\t若 $T$ 时刻内存中存在长度为 $M$ 的空闲地址片，则系统将这 $M$ 个空闲单元分配给该进程。若存在多个长度为 $M$ 个空闲地址片，则系统将首地址最小的那个空闲地址片分配给该进程。 \n\n$\\qquad$ 2)    如果 $T$ 时刻不存在长度为 $M$ 的空闲地址片，则该进程被放入一个等待队列。对于处于等待队列队头的进程，只要在任一时刻，存在长度为 $M$ 的空闲地址片，系统马上将该进程取出队列，并为它分配内存单元。注意，在进行内存分配处理过程中，处于等待队列队头的进程的处理优先级最高，队列中的其它进程不能先于队头进程被处理。 \n\n现在给出一系列描述进程的数据，请编写一程序模拟系统分配内存的过程。", "inputFormat": "第一行是一个数 $N$ ，表示总内存单元数（即地址范围从 $0$ 到 $N-1$ ）\n从第二行开始每行描述一个进程的三个整数 $T、M、P$ （$ M \\le N$）。\n\n**数据已按 $T$ 从小到大排序。**\n\n最后一行用`0 0 0`表示结束。\n\n输入文件最多 $10000$ 行，且所有数据都小于 $10^9$。\n\n输入文件中同一行相邻两项之间用一个或多个空格隔开。", "outputFormat": "共两行。\n\n第一行是全部进程都运行完毕的时刻。\n\n第二行是被放入过等待队列的进程总数。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5764", "type": "P", "difficulty": 3, "samples": [["6 6\n2 3 4 5 6\n1 2 8\n2 3 3\n3 4 4\n4 5 5\n5 6 2\n1 6 7", "21\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "重庆", "各省省选", "最短路"], "title": "[CQOI2005] 新年好", "background": "", "description": "重庆城里有 $n$ 个车站，$m$ 条双向公路连接其中的某些车站。每两个车站最多用一条公路连接，从任何一个车站出发都可以经过一条或者多条公路到达其他车站，但不同的路径需要花费的时间可能不同。在一条路径上花费的时间等于路径上所有公路需要的时间之和。\n\n佳佳的家在车站 $1$，他有五个亲戚，分别住在车站 $a,b,c,d,e$。过年了，他需要从自己的家出发，拜访每个亲戚（顺序任意），给他们送去节日的祝福。怎样走，才需要最少的时间？", "inputFormat": "第一行：$n,m$，分别为车站数目和公路的数目。\n\n第二行：$a,b,c,d,e$，分别为五个亲戚所在车站编号。\n\n以下 $m$ 行，每行三个整数 $x,y,t$，为公路连接的两个车站编号和时间。", "outputFormat": "仅一行，包含一个整数 $T$，为最少的总时间。保证 $T\\le 10^9$。", "hint": "对于 $40\\%$ 的数据，有 $1≤n≤500$，$1≤m≤2000$。\n\n对于 $100\\%$ 的数据，有 $1≤n≤50000$，$1≤m≤100000$，$1\\le a,b,c,d,e≤n$，$1≤x,y≤n$，$1≤t≤10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2005] Happy New Year", "background": "", "description": "There are $n$ stations in Chongqing City, and $m$ bidirectional roads connect some of them. Between any two stations, there is at most one road. Starting from any station, you can reach any other station by taking one or more roads, but different paths may take different amounts of time. The time spent on a path equals the sum of the times of all roads on that path.\n\nJiajia’s home is at station $1$. He has five relatives who live at stations $a,b,c,d,e$. During the Spring Festival, he needs to start from home and visit each relative (in any order) to send them holiday greetings. How should he travel to spend the least total time?", "inputFormat": "The first line contains $n,m$, the number of stations and the number of roads.\n\nThe second line contains $a,b,c,d,e$, the station numbers where the five relatives live.\n\nThe next $m$ lines each contain three integers $x,y,t$, representing the two stations connected by a road and the time of that road.", "outputFormat": "Output only one line containing an integer $T$, the minimum total time. It is guaranteed that $T\\le 10^9$.", "hint": "For $40\\%$ of the testdata, $1\\le n\\le 500$ and $1\\le m\\le 2000$.\n\nFor $100\\%$ of the testdata, $1\\le n\\le 50000$, $1\\le m\\le 100000$, $1\\le a,b,c,d,e\\le n$, $1\\le x,y\\le n$, and $1\\le t\\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2005] 新年好", "background": "", "description": "重庆城里有 $n$ 个车站，$m$ 条双向公路连接其中的某些车站。每两个车站最多用一条公路连接，从任何一个车站出发都可以经过一条或者多条公路到达其他车站，但不同的路径需要花费的时间可能不同。在一条路径上花费的时间等于路径上所有公路需要的时间之和。\n\n佳佳的家在车站 $1$，他有五个亲戚，分别住在车站 $a,b,c,d,e$。过年了，他需要从自己的家出发，拜访每个亲戚（顺序任意），给他们送去节日的祝福。怎样走，才需要最少的时间？", "inputFormat": "第一行：$n,m$，分别为车站数目和公路的数目。\n\n第二行：$a,b,c,d,e$，分别为五个亲戚所在车站编号。\n\n以下 $m$ 行，每行三个整数 $x,y,t$，为公路连接的两个车站编号和时间。", "outputFormat": "仅一行，包含一个整数 $T$，为最少的总时间。保证 $T\\le 10^9$。", "hint": "对于 $40\\%$ 的数据，有 $1≤n≤500$，$1≤m≤2000$。\n\n对于 $100\\%$ 的数据，有 $1≤n≤50000$，$1≤m≤100000$，$1\\le a,b,c,d,e≤n$，$1≤x,y≤n$，$1≤t≤10000$。", "locale": "zh-CN"}}}
{"pid": "P5765", "type": "P", "difficulty": 4, "samples": [["8  \n1 2 \n1 3\n1 4\n1 5\n5 6\n5 7\n5 8", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["2005", "重庆", "各省省选", "树形 DP"], "title": "[CQOI2005] 珠宝", "background": "", "description": "有一棵 $n$ 个结点的树，给每个点安排一个正整数编号，使得相邻点具有不同的编号，编号的总和尽量小。", "inputFormat": "第一行一个整数 $n$。\n\n以下 $n-1$ 行，每行两个数 $u,v(1\\le u,v\\le n)$，表示 $u$ 和 $v$ 间有一条边。", "outputFormat": "仅一行，为最小编号和。", "hint": "对于 $20\\%$ 的数据，$n\\le 10$；\n\n对于 $40\\%$ 的数据，$n\\le 1000$；\n\n对于 $100\\%$ 的数据，$1\\le n\\le 50000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2005] Jewelry", "background": "", "description": "There is a tree with $n$ nodes. Assign a positive integer label to each node so that adjacent nodes have different labels, and the total sum of labels is as small as possible.", "inputFormat": "The first line contains an integer $n$.  \n\nThe following $n-1$ lines each contain two integers $u, v \\ (1\\le u, v\\le n)$, indicating that there is an edge between $u$ and $v$.", "outputFormat": "Only one line, the minimum possible sum of labels.", "hint": "For $20\\%$ of the testdata, $n\\le 10$.  \n\nFor $40\\%$ of the testdata, $n\\le 1000$.  \n\nFor $100\\%$ of the testdata, $1\\le n\\le 50000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2005] 珠宝", "background": "", "description": "有一棵 $n$ 个结点的树，给每个点安排一个正整数编号，使得相邻点具有不同的编号，编号的总和尽量小。", "inputFormat": "第一行一个整数 $n$。\n\n以下 $n-1$ 行，每行两个数 $u,v(1\\le u,v\\le n)$，表示 $u$ 和 $v$ 间有一条边。", "outputFormat": "仅一行，为最小编号和。", "hint": "对于 $20\\%$ 的数据，$n\\le 10$；\n\n对于 $40\\%$ 的数据，$n\\le 1000$；\n\n对于 $100\\%$ 的数据，$1\\le n\\le 50000$。", "locale": "zh-CN"}}}
{"pid": "P5766", "type": "P", "difficulty": 3, "samples": [["5\n0 0 -2\n0 1 1\n1 0 1\n0 -1 1\n-1 0 1\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["1999", "NOI"], "title": "[NOI1999] 最优联通子集", "background": "", "description": "众所周知，我们可以通过直角坐标系把平面上的任何一个点 $P$ 用一个有序数对 $(x,y)$ 来唯一表示，如果 $x,y$ 都是整数，我们就把点 $P$ 称为整点，否则点 $P$ 称为非整点。我们把平面上所有整点构成的集合记为 $W$。\n\n定义 1 ：两个整点 $P_1(x_1,y_1),P_2(x_2,y_2)$，若 $|x_1-x_2|+|y_1-y_2|=1$，则称 $P_1,P_2$ 相邻，记作 $P_1$~$P_2$ ，否则称 $P_1,P_2$ 不相邻。\n\n定义 2 ：设点集 $S$ 是 $W$ 的一个有限子集，即 $S$=$\\{P_1,P_2,…,P_n\\}$ $(n \\ge 1)$，其中 $P_i (1 \\le i \\le n)$ 属于 $W$，我们把 $S$ 称为整点集。\n\n定义 3 ：设 $S$ 是一个整点集，若点 $R$,$T$ 属于 $S$ ，且存在一个有限的点序列 $Q_1,Q_2,…,Q_k$ 满足: \n1. $Q_i$ 属于 $S$ （$ 1 \\le i \\le k $）;\n2. $Q_1$ = $R$,$Q_k$ = $T$;\n3. $Q_i$~$Q_{i+1} (1 \\le i \\le k-1)$，即 $Q_i$ 与 \n $Q_{i+1}$ 相邻;\n4. 对于任何 $1 \\le i<j \\le k$ 有 $Q_i≠Q_j$;\n\n我们则称点 $R$ 与点 $T$ 在整点集 $S$ 上连通，把点序列 $Q_1,Q_2,…,Q_k$ 称为整点集 $S$ 中连接点 $R$ 与点 $T$ 的一条道路。\n\n定义 4 ：若整点集 $V$ 满足：对于 $V$ 中的任何两个整点， $V$ 中有且仅有一条连接这两点的道路，则 $V$ 称为单整点集。\n\n定义 5 ：对于平面上的每一个整点，我们可以赋予它一个整数，作为该点的权，于是我们把一个整点集中所有点的权的总和称为该整点集的权和。\n\n我们希望对于给定的一个单整点集 $V$ ，求出一个 $V$ 的最优连通子集 $B$ ，满足：\n1. $B$ 是 $V$ 的子集\n2. 对于 $B$ 中的任何两个整点，在 $B$ 中连通；\n3. $B$ 是满足条件 (1) 和 (2) 的所有整点集中权和最大的。\n", "inputFormat": "第一行是一个整数 $N$ ，表示单整点集 $V$ 中点的个数；\n\n以下 $N$ 行中，第 $i$ 行 $(1 \\le i \\le N) $ 有三个整数，$X_i,Y_i,C_i$ 依次表示第 $i$ 个点的横坐标，纵坐标和权。同一行相邻两数之间用一个空格分隔。\n", "outputFormat": "仅一个整数，表示所求最优连通集的权和。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[NOI1999] Optimal Connected Subset", "background": "", "description": "As is well known, we can use the Cartesian coordinate system to uniquely represent any point $P$ on the plane by an ordered pair $(x,y)$. If both $x,y$ are integers, then we call point $P$ a lattice point; otherwise, point $P$ is a non-lattice point. Let the set of all lattice points on the plane be denoted by $W$.\n\nDefinition 1: For two lattice points $P_1(x_1,y_1),P_2(x_2,y_2)$, if $|x_1-x_2|+|y_1-y_2|=1$, then $P_1$ and $P_2$ are said to be adjacent, denoted by $P_1$~$P_2$. Otherwise, they are said to be non-adjacent.\n\nDefinition 2: Let a point set $S$ be a finite subset of $W$, that is, $S=\\{P_1,P_2,\\ldots,P_n\\}$ $(n \\ge 1)$, where $P_i$ $(1 \\le i \\le n)$ belongs to $W$. We call $S$ a lattice point set.\n\nDefinition 3: Let $S$ be a lattice point set. If points $R$ and $T$ belong to $S$, and there exists a finite point sequence $Q_1,Q_2,\\ldots,Q_k$ satisfying:\n1. $Q_i$ belongs to $S$ ($1 \\le i \\le k$);\n2. $Q_1=R$, $Q_k=T$;\n3. $Q_i$~$Q_{i+1}$ $(1 \\le i \\le k-1)$, i.e. $Q_i$ and $Q_{i+1}$ are adjacent;\n4. For any $1 \\le i<j \\le k$, $Q_i \\ne Q_j$;\n\nthen we say point $R$ and point $T$ are connected in the lattice point set $S$. The point sequence $Q_1,Q_2,\\ldots,Q_k$ is called a path in $S$ connecting $R$ and $T$.\n\nDefinition 4: If a lattice point set $V$ satisfies that for any two lattice points in $V$, there exists one and only one path in $V$ connecting these two points, then $V$ is called a single lattice point set.\n\nDefinition 5: For each lattice point on the plane, we can assign it an integer as the weight of that point. The sum of the weights of all points in a lattice point set is called the weight sum of that set.\n\nFor a given single lattice point set $V$, we want to find an optimal connected subset $B$ of $V$ such that:\n1. $B$ is a subset of $V$.\n2. Any two lattice points in $B$ are connected within $B$.\n3. Among all lattice point sets satisfying conditions (1) and (2), $B$ has the maximum weight sum.", "inputFormat": "The first line contains an integer $N$, indicating the number of points in the single lattice point set $V$.\n\nIn the next $N$ lines, the $i$-th line $(1 \\le i \\le N)$ contains three integers $X_i,Y_i,C_i$, which represent the $x$-coordinate, $y$-coordinate, and weight of the $i$-th point, respectively. Adjacent numbers on the same line are separated by one space.", "outputFormat": "Output one integer, the weight sum of the required optimal connected set.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1999] 最优联通子集", "background": "", "description": "众所周知，我们可以通过直角坐标系把平面上的任何一个点 $P$ 用一个有序数对 $(x,y)$ 来唯一表示，如果 $x,y$ 都是整数，我们就把点 $P$ 称为整点，否则点 $P$ 称为非整点。我们把平面上所有整点构成的集合记为 $W$。\n\n定义 1 ：两个整点 $P_1(x_1,y_1),P_2(x_2,y_2)$，若 $|x_1-x_2|+|y_1-y_2|=1$，则称 $P_1,P_2$ 相邻，记作 $P_1$~$P_2$ ，否则称 $P_1,P_2$ 不相邻。\n\n定义 2 ：设点集 $S$ 是 $W$ 的一个有限子集，即 $S$=$\\{P_1,P_2,…,P_n\\}$ $(n \\ge 1)$，其中 $P_i (1 \\le i \\le n)$ 属于 $W$，我们把 $S$ 称为整点集。\n\n定义 3 ：设 $S$ 是一个整点集，若点 $R$,$T$ 属于 $S$ ，且存在一个有限的点序列 $Q_1,Q_2,…,Q_k$ 满足: \n1. $Q_i$ 属于 $S$ （$ 1 \\le i \\le k $）;\n2. $Q_1$ = $R$,$Q_k$ = $T$;\n3. $Q_i$~$Q_{i+1} (1 \\le i \\le k-1)$，即 $Q_i$ 与 \n $Q_{i+1}$ 相邻;\n4. 对于任何 $1 \\le i<j \\le k$ 有 $Q_i≠Q_j$;\n\n我们则称点 $R$ 与点 $T$ 在整点集 $S$ 上连通，把点序列 $Q_1,Q_2,…,Q_k$ 称为整点集 $S$ 中连接点 $R$ 与点 $T$ 的一条道路。\n\n定义 4 ：若整点集 $V$ 满足：对于 $V$ 中的任何两个整点， $V$ 中有且仅有一条连接这两点的道路，则 $V$ 称为单整点集。\n\n定义 5 ：对于平面上的每一个整点，我们可以赋予它一个整数，作为该点的权，于是我们把一个整点集中所有点的权的总和称为该整点集的权和。\n\n我们希望对于给定的一个单整点集 $V$ ，求出一个 $V$ 的最优连通子集 $B$ ，满足：\n1. $B$ 是 $V$ 的子集\n2. 对于 $B$ 中的任何两个整点，在 $B$ 中连通；\n3. $B$ 是满足条件 (1) 和 (2) 的所有整点集中权和最大的。\n", "inputFormat": "第一行是一个整数 $N$ ，表示单整点集 $V$ 中点的个数；\n\n以下 $N$ 行中，第 $i$ 行 $(1 \\le i \\le N) $ 有三个整数，$X_i,Y_i,C_i$ 依次表示第 $i$ 个点的横坐标，纵坐标和权。同一行相邻两数之间用一个空格分隔。\n", "outputFormat": "仅一个整数，表示所求最优连通集的权和。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5767", "type": "P", "difficulty": 3, "samples": [["3 7\n6 7\n4 7 3 6\n2 1 3 5\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["图论", "1997", "NOI", "最短路"], "title": "[NOI1997] 最优乘车", "background": "", "description": "H 城是一个旅游胜地，每年都有成千上万的人前来观光。为方便游客，巴士公司在各个旅游景点及宾馆，饭店等地都设置了巴士站并开通了一些单程巴士线路。每条单程巴士线路从某个巴士站出发，依次途经若干个巴士站，最终到达终点巴士站。\n\n一名旅客最近到 H 城旅游，他很想去 S 公园游玩，但如果从他所在的饭店没有一路巴士可以直接到达 S 公园，则他可能要先乘某一路巴士坐几站，再下来换乘同一站台的另一路巴士，这样换乘几次后到达 S 公园。\n\n现在用整数 $1 , 2 , … , N$ 给 H 城的所有的巴士站编号，约定这名旅客所在饭店的巴士站编号为 $1$，S 公园巴士站的编号为 $N$。\n\n写一个程序，帮助这名旅客寻找一个最优乘车方案，使他在从饭店乘车到 S 公园的过程中换车的次数最少。\n\n", "inputFormat": "第一行有两个数字 $M$ 和 $N$（$ 1 \\le M \\le 100$，$ 1 < N \\le 500 $），表示开通了 $M$ 条单程巴士线路，总共有 $N$ 个车站。\n\n从第二行到第 $M+1$ 行依次给出了第 $1$ 条到第 $M$ 条巴士线路的信息。其中第 $i+1$ 行给出的是第 $i$ 条巴士线路的信息，从左至右按运行顺序依次给出了该线路上的所有站号相邻两个站号之间用一个空格隔开。\n\n", "outputFormat": "只有一行。如果无法乘巴士从饭店到达 S公园，则输出 `NO` ；\n\n否则输出你的程序所找到的最少换车次数，换车次数为 $0$ 表示不需换车即可到达。\n\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[NOI1997] Optimal Bus Transfer", "background": "", "description": "City H is a tourist city, and every year tens of thousands of people come to visit. To make it convenient for tourists, the bus company has set up bus stops at various attractions, hotels, restaurants, and other places, and has opened some one-way bus routes. Each one-way bus route starts from a bus stop, passes through several bus stops in order, and finally arrives at the terminal bus stop.\n\nA traveler is recently visiting City H and wants to go to Park S. However, if there is no bus that can take him directly from the stop near his hotel to Park S, he may need to take one bus for several stops, get off, and transfer to another bus at the same stop. After transferring several times, he can reach Park S.\n\nNow all bus stops in City H are numbered with integers $1, 2, \\dots, N$. By convention, the bus stop near the traveler’s hotel is numbered $1$, and the bus stop for Park S is numbered $N$.\n\nWrite a program to help this traveler find an optimal travel plan, so that the number of transfers during the trip from the hotel to Park S is minimized.", "inputFormat": "The first line contains two numbers $M$ and $N$ ($1 \\le M \\le 100$, $1 < N \\le 500$), meaning there are $M$ one-way bus routes in service and a total of $N$ bus stops.\n\nLines $2$ to $M + 1$ give the information for bus routes $1$ to $M$ in order. Line $i + 1$ gives the information for route $i$. From left to right, it lists all stop numbers on this route in the running order, and adjacent stop numbers are separated by one space.", "outputFormat": "Only one line.\n\nIf it is impossible to reach Park S by bus from the hotel, output `NO`.\n\nOtherwise, output the minimum number of transfers found by your program. A transfer count of $0$ means that it can be reached without any transfer.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI1997] 最优乘车", "background": "", "description": "H 城是一个旅游胜地，每年都有成千上万的人前来观光。为方便游客，巴士公司在各个旅游景点及宾馆，饭店等地都设置了巴士站并开通了一些单程巴士线路。每条单程巴士线路从某个巴士站出发，依次途经若干个巴士站，最终到达终点巴士站。\n\n一名旅客最近到 H 城旅游，他很想去 S 公园游玩，但如果从他所在的饭店没有一路巴士可以直接到达 S 公园，则他可能要先乘某一路巴士坐几站，再下来换乘同一站台的另一路巴士，这样换乘几次后到达 S 公园。\n\n现在用整数 $1 , 2 , … , N$ 给 H 城的所有的巴士站编号，约定这名旅客所在饭店的巴士站编号为 $1$，S 公园巴士站的编号为 $N$。\n\n写一个程序，帮助这名旅客寻找一个最优乘车方案，使他在从饭店乘车到 S 公园的过程中换车的次数最少。\n\n", "inputFormat": "第一行有两个数字 $M$ 和 $N$（$ 1 \\le M \\le 100$，$ 1 < N \\le 500 $），表示开通了 $M$ 条单程巴士线路，总共有 $N$ 个车站。\n\n从第二行到第 $M+1$ 行依次给出了第 $1$ 条到第 $M$ 条巴士线路的信息。其中第 $i+1$ 行给出的是第 $i$ 条巴士线路的信息，从左至右按运行顺序依次给出了该线路上的所有站号相邻两个站号之间用一个空格隔开。\n\n", "outputFormat": "只有一行。如果无法乘巴士从饭店到达 S公园，则输出 `NO` ；\n\n否则输出你的程序所找到的最少换车次数，换车次数为 $0$ 表示不需换车即可到达。\n\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5768", "type": "P", "difficulty": 6, "samples": [["47\nA 128.0.0.0/1\nA 128.0.0.0/4\nA 100.200.20.0/23\nA 241.170.96.0/20\nA 74.128.0.0/17\nA 193.24.0.0/14\nA 128.0.0.0/19\nA 128.0.0.0/13\nA 128.0.0.0/5\nA 128.0.0.0/11\nA 128.0.0.0/12\nA 192.0.0.0/7\nQ 192.0.0.13 1 8\nA 128.0.0.0/8\nQ 128.0.0.15 1 8\nA 74.0.0.0/8\nA 96.0.0.0/4\nA 193.24.0.0/23\nA 100.192.0.0/11\nA 128.0.0.0/18\nA 128.0.0.0/20\nQ 128.0.0.4 1 13\nA 192.0.0.0/8\nA 192.0.0.0/22\nQ 128.0.0.7 1 14\nA 128.0.0.0/23\nA 74.128.0.0/14\nA 128.0.0.0/14\nA 128.0.0.0/25\nA 74.128.0.0/12\nQ 128.0.0.9 2 17\nA 96.0.0.0/11\nA 64.0.0.0/2\nA 74.0.0.0/26\nA 100.192.0.0/18\nA 128.0.0.0/27\nA 193.24.0.0/18\nQ 128.0.0.3 4 21\nQ 74.128.0.12 3 24\nA 128.0.0.0/9\nA 193.24.0.0/22\nQ 128.0.0.7 4 24\nA 192.0.0.0/10\nQ 128.0.0.3 2 23\nA 100.192.0.0/10\nQ 241.170.96.2 1 26\nQ 100.192.0.4 4 24\n", "1\n3\n3\n3\n2\n2\n1\n3\n4\n2\n2\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "重庆", "各省省选"], "title": "[CQOI2016] 路由表", "background": "", "description": "路由表查找是路由器在转发 IP 报文时的重要环节。通常路由表中的表项由目的地址、掩码、下一跳（Next Hop）地址和其他辅助信息组成。例如：\n| 目的地址 | 掩码长度 | 下一跳 |\n| :----------: | :----------: | :----------: |\n| 0.0.0.0 | /1 | 192.168.1.1 |\n| 128.0.0.0 | /1 | 192.168.1.1 |\n| 8.8.8.0 | /24 | 192.168.1.1 |\n| 8.8.8.8 | /32 | 192.168.1.253 |\n\n\n当路由器收到一个 IP 报文时，会将报文中的目的 IP 地址与路由表中的表项逐条进行比较，选择匹配且**最明确**的表项，将报文转发给该表项中指定的下一跳。\n\n匹配的过程是将报文中的目的地址和表项中的目的地址分别转为二进制串，再查看表项中的掩码长度，若掩码长度为 $x$ ，则将两个二进制串的前 $x$ 位进行比较，如果相同则认为匹配。\n\n所谓**最明确**是指在有多个表项匹配时，掩码长度最大的表项。也可以理解为匹配的二进制位最多的项。\n\nIP 地址转为二进制串的操作是把地址中 $4$ 个整数（一定在 $0$ 到 $255$ 的范围内）分别转为 $8$ 位二进制数，再顺序拼接起来，得到一个  位的二进制串。例如，$192.168.1.253$ 转为二进制串后为 $11000000 $ $10101000$ $00000001$ $11111101$。\n\n我们以报文的目的地址为 $8.8.8.8$ 为例，说明其在上述路由表的匹配过程。\n\n\n| 8.8.8.8 | 00001000 00001000 00001000 00001000 |\n| :----------: | :----------: |\n| 0.0.0.0/1 | $\\color{red}{0}$0000000 00000000 00000000 00000000 |\n| 128.0.0.0/1 | $\\color{red}{1}$0000000 00000000 00000000 00000000 |\n| 8.8.8.0/24 | $\\color{red}{00001000}$ $\\color{red}{00001000 }$ $\\color{red}{00001000}$ 00000000 |\n| 8.8.8.8/32 | $\\color{red}{00001000}$ $\\color{red}{00001000 }$ $\\color{red}{00001000}$ $\\color{red}{00001000}$  |\n\n\n上表将地址均转为二进制串，并用红色标记出待比较的位（由掩码长度决定）。将红色部分与报文中的目的地址比较，可知 $0.0.0.0/1$、$8.8.8.0/24$、$8.8.8.8/32$ 均能够匹配。路由器从中选取掩码长度最长（/32）的表项 $8.8.8.8/32$，将报文转发给其对应的下一跳地址 $192.168.1.253$。\n\n在实际的核心路由器中，路由表通常较大（现在互联网的全局路由表已经接近 $60$\n 万条记录），并且会随着新接入设备不断扩张。为了分析路由表变化对转发产生的影响，网络工程师想要知道一段时间内某个 IP 地址的路由表项选择发生了多少次变化（变化是指由于最明确匹配等因素选择了不同的表项，不考虑下一跳地址）。", "inputFormat": "第一行为整数 $M$，表示共有 $M$ 次操作。接下来 $M$ 行，每行描述一次操作。操作有两种：\n\n`A <D>/<L>`\n\n其中 $D$ 为一个 IP 地址，$L$ 为整数 ($1 \\le L \\le 32 $)。添加一条表项至路由表，其目的地址为 $D$，掩码长度为 $L$。下一跳地址由于没有用到，故省略。\n\n`Q <D> <a> <b>`\n\n其中 $D$ 为一个 IP 地址，$a,b$ 为正整数($a \\le b$) 。查询从第 $a$ 次至第 $b$ 次添加表项期间（含 $a,b$），目的地址 $D$ 的路由表项选择发生了多少次变化。保证查询时表中至少有 $b$ 个表项。", "outputFormat": "包含若干行，每行仅有一个整数，依次对应每个查询操作。", "hint": "对于一次查询的一种理解方式是：无视其它所有查询操作，只看添加操作。先清空路由表，然后执行第 $1$ 到 $a-1$ 次添加操作。之后再统计第 $a$ 到 $b$ 次添加操作过程中匹配改变的次数。\n\n--------\n\n对于 $30\\%$ 的数据，$M \\le 10^3$；\n\n对于 $100\\%$ 的数据，$M \\le 10^6$。\n\n设一条表项的掩码长度为 $L$，数据保证将目的地址转为二进制串后，末尾的 $32-L$ 位均为 $0$。另外，保证不会重复添加目的地址和掩码长度都相同的表项。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2016] Routing Table", "background": "", "description": "Routing table lookup is an important step when a router forwards IP packets. Usually, each routing table entry consists of a destination address, a mask, a Next Hop address, and other auxiliary information. For example:\n\n| Destination Address | Mask Length | Next Hop |\n| :----------: | :----------: | :----------: |\n| 0.0.0.0 | /1 | 192.168.1.1 |\n| 128.0.0.0 | /1 | 192.168.1.1 |\n| 8.8.8.0 | /24 | 192.168.1.1 |\n| 8.8.8.8 | /32 | 192.168.1.253 |\n\nWhen a router receives an IP packet, it compares the destination IP address in the packet with the entries in the routing table one by one, chooses an entry that matches and is **most specific**, and forwards the packet to the Next Hop specified by that entry.\n\nThe matching process is: convert the destination address in the packet and the destination address in an entry into binary strings, then check the mask length of the entry. If the mask length is $x$, compare the first $x$ bits of the two binary strings. If they are the same, it is considered a match.\n\n**Most specific** means: if multiple entries match, choose the one with the largest mask length. It can also be understood as the entry that matches the most bits.\n\nThe operation of converting an IP address into a binary string is: convert the $4$ integers in the address (each must be in the range $0$ to $255$) into $8$-bit binary numbers, and then concatenate them in order to obtain a $32$-bit binary string. For example, after converting $192.168.1.253$ into a binary string, we get $11000000$ $10101000$ $00000001$ $11111101$.\n\nWe use the packet destination address $8.8.8.8$ as an example to illustrate the matching process in the routing table above.\n\n| 8.8.8.8 | 00001000 00001000 00001000 00001000 |\n| :----------: | :----------: |\n| 0.0.0.0/1 | $\\color{red}{0}$0000000 00000000 00000000 00000000 |\n| 128.0.0.0/1 | $\\color{red}{1}$0000000 00000000 00000000 00000000 |\n| 8.8.8.0/24 | $\\color{red}{00001000}$ $\\color{red}{00001000 }$ $\\color{red}{00001000}$ 00000000 |\n| 8.8.8.8/32 | $\\color{red}{00001000}$ $\\color{red}{00001000 }$ $\\color{red}{00001000}$ $\\color{red}{00001000}$ |\n\nIn the table above, all addresses are converted to binary strings, and the bits to be compared (determined by the mask length) are marked in red. By comparing the red parts with the destination address in the packet, we can see that $0.0.0.0/1$, $8.8.8.0/24$, and $8.8.8.8/32$ can all match. The router chooses the entry with the longest mask length (/32), i.e. $8.8.8.8/32$, and forwards the packet to its corresponding Next Hop address $192.168.1.253$.\n\nIn real core routers, routing tables are usually large (the global Internet routing table is now close to $60$万 entries), and they keep expanding as new devices join. To analyze how routing table changes affect forwarding, a network engineer wants to know, over a period of time, how many times the selected routing table entry for a certain IP address changes (a change means that a different entry is chosen due to factors such as most specific match; the Next Hop address is not considered).", "inputFormat": "The first line contains an integer $M$, indicating that there are $M$ operations in total. The next $M$ lines each describe one operation. There are two types of operations:\n\n`A <D>/<L>`\n\nHere $D$ is an IP address, and $L$ is an integer ($1 \\le L \\le 32$). Add an entry to the routing table, with destination address $D$ and mask length $L$. The Next Hop address is omitted because it is not used.\n\n`Q <D> <a> <b>`\n\nHere $D$ is an IP address, and $a,b$ are positive integers ($a \\le b$). Query, during the period from the $a$-th to the $b$-th added entry (including $a$ and $b$), how many times the selected routing table entry for destination address $D$ changes. It is guaranteed that at the time of the query, the table contains at least $b$ entries.", "outputFormat": "Contains several lines. Each line has only one integer, corresponding to each query operation in order.", "hint": "One way to understand a query is: ignore all other query operations and consider only the add operations. First clear the routing table, then perform the $1$-st to the $(a-1)$-th add operations. After that, count the number of times the match selection changes during the $a$-th to the $b$-th add operations.\n\n--------\n\nFor $30\\%$ of the testdata, $M \\le 10^3$.\n\nFor $100\\%$ of the testdata, $M \\le 10^6$.\n\nFor an entry with mask length $L$, the testdata guarantees that after converting the destination address into a binary string, the last $32-L$ bits are all $0$. In addition, it is guaranteed that no two added entries have both the same destination address and the same mask length.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2016] 路由表", "background": "", "description": "路由表查找是路由器在转发 IP 报文时的重要环节。通常路由表中的表项由目的地址、掩码、下一跳（Next Hop）地址和其他辅助信息组成。例如：\n| 目的地址 | 掩码长度 | 下一跳 |\n| :----------: | :----------: | :----------: |\n| 0.0.0.0 | /1 | 192.168.1.1 |\n| 128.0.0.0 | /1 | 192.168.1.1 |\n| 8.8.8.0 | /24 | 192.168.1.1 |\n| 8.8.8.8 | /32 | 192.168.1.253 |\n\n\n当路由器收到一个 IP 报文时，会将报文中的目的 IP 地址与路由表中的表项逐条进行比较，选择匹配且**最明确**的表项，将报文转发给该表项中指定的下一跳。\n\n匹配的过程是将报文中的目的地址和表项中的目的地址分别转为二进制串，再查看表项中的掩码长度，若掩码长度为 $x$ ，则将两个二进制串的前 $x$ 位进行比较，如果相同则认为匹配。\n\n所谓**最明确**是指在有多个表项匹配时，掩码长度最大的表项。也可以理解为匹配的二进制位最多的项。\n\nIP 地址转为二进制串的操作是把地址中 $4$ 个整数（一定在 $0$ 到 $255$ 的范围内）分别转为 $8$ 位二进制数，再顺序拼接起来，得到一个  位的二进制串。例如，$192.168.1.253$ 转为二进制串后为 $11000000 $ $10101000$ $00000001$ $11111101$。\n\n我们以报文的目的地址为 $8.8.8.8$ 为例，说明其在上述路由表的匹配过程。\n\n\n| 8.8.8.8 | 00001000 00001000 00001000 00001000 |\n| :----------: | :----------: |\n| 0.0.0.0/1 | $\\color{red}{0}$0000000 00000000 00000000 00000000 |\n| 128.0.0.0/1 | $\\color{red}{1}$0000000 00000000 00000000 00000000 |\n| 8.8.8.0/24 | $\\color{red}{00001000}$ $\\color{red}{00001000 }$ $\\color{red}{00001000}$ 00000000 |\n| 8.8.8.8/32 | $\\color{red}{00001000}$ $\\color{red}{00001000 }$ $\\color{red}{00001000}$ $\\color{red}{00001000}$  |\n\n\n上表将地址均转为二进制串，并用红色标记出待比较的位（由掩码长度决定）。将红色部分与报文中的目的地址比较，可知 $0.0.0.0/1$、$8.8.8.0/24$、$8.8.8.8/32$ 均能够匹配。路由器从中选取掩码长度最长（/32）的表项 $8.8.8.8/32$，将报文转发给其对应的下一跳地址 $192.168.1.253$。\n\n在实际的核心路由器中，路由表通常较大（现在互联网的全局路由表已经接近 $60$\n 万条记录），并且会随着新接入设备不断扩张。为了分析路由表变化对转发产生的影响，网络工程师想要知道一段时间内某个 IP 地址的路由表项选择发生了多少次变化（变化是指由于最明确匹配等因素选择了不同的表项，不考虑下一跳地址）。", "inputFormat": "第一行为整数 $M$，表示共有 $M$ 次操作。接下来 $M$ 行，每行描述一次操作。操作有两种：\n\n`A <D>/<L>`\n\n其中 $D$ 为一个 IP 地址，$L$ 为整数 ($1 \\le L \\le 32 $)。添加一条表项至路由表，其目的地址为 $D$，掩码长度为 $L$。下一跳地址由于没有用到，故省略。\n\n`Q <D> <a> <b>`\n\n其中 $D$ 为一个 IP 地址，$a,b$ 为正整数($a \\le b$) 。查询从第 $a$ 次至第 $b$ 次添加表项期间（含 $a,b$），目的地址 $D$ 的路由表项选择发生了多少次变化。保证查询时表中至少有 $b$ 个表项。", "outputFormat": "包含若干行，每行仅有一个整数，依次对应每个查询操作。", "hint": "对于一次查询的一种理解方式是：无视其它所有查询操作，只看添加操作。先清空路由表，然后执行第 $1$ 到 $a-1$ 次添加操作。之后再统计第 $a$ 到 $b$ 次添加操作过程中匹配改变的次数。\n\n--------\n\n对于 $30\\%$ 的数据，$M \\le 10^3$；\n\n对于 $100\\%$ 的数据，$M \\le 10^6$。\n\n设一条表项的掩码长度为 $L$，数据保证将目的地址转为二进制串后，末尾的 $32-L$ 位均为 $0$。另外，保证不会重复添加目的地址和掩码长度都相同的表项。", "locale": "zh-CN"}}}
{"pid": "P5769", "type": "P", "difficulty": 6, "samples": [["3 3\n100 1 1\n0 1 1\n1 0 5\n2 1 0\n1 2 1\n2 1 1\n3 1 9\n", "2\n"], ["3 3\n100 1 1\n0 1 1\n1 0 5\n2 1 0\n1 2 1\n2 1 1\n3 1 8\n", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "各省省选", "江苏"], "title": "[JSOI2016] 飞机调度", "background": "", "description": "JSOI 王国里有 $N$ 个机场，编号为 $1$ 到 $N$。从 $i$ 号机场到 $j$ 号机场需要飞行 $T_{i,j}$ 的时间。由于风向，地理位置和航空管制的因素，$T_{i,j}$  和 $T_{j,i}$ 并不一定相同。\n\n此外，由于飞机降落之后需要例行维修和加油。当一架飞机降落 $k$ 号机场时，需要花费 $P_k$​​ 的维护时间才能再次起飞。\n\nJS Airways 一共运营 $M$ 条航线，其中第 $i$ 条直飞航线需要在 $D_i$ 时刻从 $X_i$ 机场起飞，不经停，飞往 $Y_i$ 机场。\n\n为了简化问题，我们假设 JS Airway 可以在 $0$ 时刻在任意机场布置任意多架加油维护完毕的飞机；为了减少飞机的使用数，我们允许 JS Airways 增开任意多条临时航线以满足飞机的调度需求。\n\nJYY 想知道，理论上 JS Airways 最少需要多少架飞机才能完成所有这 $M$ 个航班。", "inputFormat": "第一行包含两个正整数 $N$,$M$；\n\n接下来一行包含 $N$ 个正整数表示每一个机场的飞机维护时间；\n\n接下来 $N$ 行，每行 $N$ 个非负整数，其中第 $i$ 行第 $j$ 个非负整数为 $T_{i,j}$，表示从 $i$ 号机场飞往 $j$ 号机场所需要花费的时间。数据保证 $T_{i,i}=0$；\n\n接下来 $M$ 行，每行三个正整数，其中第 $i$ 行为 $X_i,Y_i,D_i$，表示第 $i$ 条航线的起飞机场，降落机场，以及起飞时间。数据保证 $X_i \\neq Y_i$。", "outputFormat": "一行一个正整数，表示 JS Airways 理论上最少需要的飞机数。", "hint": "**样例说明1**\n\n在第一个样例中，JS Airways 可以在 $0$ 时刻在 $2$ 号机场安排一架飞机并执飞第 $2$ 条航线（$2→1$）。此外还需要在 $0$ 时刻在 $1$ 号机场安排一架飞机，这架飞机首先执飞第 $1$ 条航线（$1→2$），然后通过临时新增一条航线从 $2$ 号机场起飞飞往 $3$ 号机场，降落 $3$ 号机场之后执飞第 $3$ 条航线（$3→1$）。\n\n**样例说明2**\n\n在第二个样例中，执行完第 $1$ 条航线的飞机无法赶上第 $3$ 条航线的起飞时间，因此 JS Airways 必须使用 $3$ 架不同的飞机才能完成所有的航班。\n\n------------\n\n**数据范围**\n\n对于 $30\\%$ 的数据，满足 $N,M \\le 10$；\n\n对于 $60\\%$ 的数据，满足 $N,M \\le 100$；\n\n对于全部数据，满足 $1 \\le N,M \\le 500$，$0 \\le P_i,T_{i,j} \\le 10^6$，$1 \\le D_i \\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Aircraft Scheduling", "background": "", "description": "In the JSOI Kingdom, there are $N$ airports, numbered from $1$ to $N$. Flying from airport $i$ to airport $j$ takes time $T_{i,j}$. Due to wind direction, geographic location, and air traffic control, $T_{i,j}$ and $T_{j,i}$ are not necessarily the same.\n\nAlso, after an aircraft lands, it needs routine maintenance and refueling. When an aircraft lands at airport $k$, it must spend $P_k$ time on maintenance before it can take off again.\n\nJS Airways operates a total of $M$ routes. For the $i$-th direct flight, it must take off from airport $X_i$ at time $D_i$ and fly non-stop to airport $Y_i$.\n\nTo simplify the problem, we assume JS Airways can place any number of fully maintained and refueled aircraft at any airport at time $0$. To reduce the number of aircraft used, we also allow JS Airways to add any number of temporary flights to satisfy scheduling needs.\n\nJYY wants to know: in theory, what is the minimum number of aircraft JS Airways needs to complete all these $M$ flights.", "inputFormat": "The first line contains two positive integers $N, M$.\n\nThe next line contains $N$ positive integers, representing the aircraft maintenance time for each airport.\n\nThe next $N$ lines each contain $N$ non-negative integers. The $j$-th non-negative integer in the $i$-th line is $T_{i,j}$, meaning the time required to fly from airport $i$ to airport $j$. The data guarantees $T_{i,i} = 0$.\n\nThe next $M$ lines each contain three positive integers. The $i$-th line is $X_i, Y_i, D_i$, representing the departure airport, the arrival airport, and the departure time of the $i$-th route. The data guarantees $X_i \\neq Y_i$.", "outputFormat": "Output one positive integer in a single line, representing the theoretical minimum number of aircraft JS Airways needs.", "hint": "**Sample Explanation 1**\n\nIn the first sample, JS Airways can arrange one aircraft at airport $2$ at time $0$ and use it to operate flight $2$ ($2 \\to 1$). In addition, it needs to arrange one aircraft at airport $1$ at time $0$. This aircraft first operates flight $1$ ($1 \\to 2$), then takes a newly added temporary flight from airport $2$ to airport $3$, and after landing at airport $3$, it operates flight $3$ ($3 \\to 1$).\n\n**Sample Explanation 2**\n\nIn the second sample, the aircraft that finishes flight $1$ cannot catch the departure time of flight $3$. Therefore, JS Airways must use $3$ different aircraft to complete all flights.\n\n------------\n\n**Constraints**\n\nFor $30\\%$ of the testdata, $N, M \\le 10$.\n\nFor $60\\%$ of the testdata, $N, M \\le 100$.\n\nFor all testdata, $1 \\le N, M \\le 500$, $0 \\le P_i, T_{i,j} \\le 10^6$, $1 \\le D_i \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 飞机调度", "background": "", "description": "JSOI 王国里有 $N$ 个机场，编号为 $1$ 到 $N$。从 $i$ 号机场到 $j$ 号机场需要飞行 $T_{i,j}$ 的时间。由于风向，地理位置和航空管制的因素，$T_{i,j}$  和 $T_{j,i}$ 并不一定相同。\n\n此外，由于飞机降落之后需要例行维修和加油。当一架飞机降落 $k$ 号机场时，需要花费 $P_k$​​ 的维护时间才能再次起飞。\n\nJS Airways 一共运营 $M$ 条航线，其中第 $i$ 条直飞航线需要在 $D_i$ 时刻从 $X_i$ 机场起飞，不经停，飞往 $Y_i$ 机场。\n\n为了简化问题，我们假设 JS Airway 可以在 $0$ 时刻在任意机场布置任意多架加油维护完毕的飞机；为了减少飞机的使用数，我们允许 JS Airways 增开任意多条临时航线以满足飞机的调度需求。\n\nJYY 想知道，理论上 JS Airways 最少需要多少架飞机才能完成所有这 $M$ 个航班。", "inputFormat": "第一行包含两个正整数 $N$,$M$；\n\n接下来一行包含 $N$ 个正整数表示每一个机场的飞机维护时间；\n\n接下来 $N$ 行，每行 $N$ 个非负整数，其中第 $i$ 行第 $j$ 个非负整数为 $T_{i,j}$，表示从 $i$ 号机场飞往 $j$ 号机场所需要花费的时间。数据保证 $T_{i,i}=0$；\n\n接下来 $M$ 行，每行三个正整数，其中第 $i$ 行为 $X_i,Y_i,D_i$，表示第 $i$ 条航线的起飞机场，降落机场，以及起飞时间。数据保证 $X_i \\neq Y_i$。", "outputFormat": "一行一个正整数，表示 JS Airways 理论上最少需要的飞机数。", "hint": "**样例说明1**\n\n在第一个样例中，JS Airways 可以在 $0$ 时刻在 $2$ 号机场安排一架飞机并执飞第 $2$ 条航线（$2→1$）。此外还需要在 $0$ 时刻在 $1$ 号机场安排一架飞机，这架飞机首先执飞第 $1$ 条航线（$1→2$），然后通过临时新增一条航线从 $2$ 号机场起飞飞往 $3$ 号机场，降落 $3$ 号机场之后执飞第 $3$ 条航线（$3→1$）。\n\n**样例说明2**\n\n在第二个样例中，执行完第 $1$ 条航线的飞机无法赶上第 $3$ 条航线的起飞时间，因此 JS Airways 必须使用 $3$ 架不同的飞机才能完成所有的航班。\n\n------------\n\n**数据范围**\n\n对于 $30\\%$ 的数据，满足 $N,M \\le 10$；\n\n对于 $60\\%$ 的数据，满足 $N,M \\le 100$；\n\n对于全部数据，满足 $1 \\le N,M \\le 500$，$0 \\le P_i,T_{i,j} \\le 10^6$，$1 \\le D_i \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5770", "type": "P", "difficulty": 5, "samples": [["5\n5 1\n5 2\n5 3\n5 4\n5 5\n", "12\naaaab\n12\naaabb\n12\naabab\n12\naabbb\n12\nababb\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "各省省选", "江苏", "容斥原理", "KMP 算法"], "title": "[JSOI2016] 无界单词", "background": "", "description": "对于一个单词 $S$ ，如果存在一个长度 $l$，满足 $0 < l < |S|$，并且使得 $S$ 长度为 $l$ 的前缀与 $S$ 长度为 $l$ 的后缀相同，JYY 则称 $S$ 是有界的。比如 `aabaa` 和 `ababab` 就都是有界的字符串。如果一个单词不存在这样的 $l$ ，则 JYY 称之为无界单词。\n\n现在考虑所有仅由字母 `a` 和 `b` 组成的长度为 $N$ 的字符串，JYY想知道：\n\n1. 一共有多少个无界单词？\n2. 这些无界单词中，按字典序排列第 $K$ 小的单词是哪一个？", "inputFormat": "**本题有多组数据。**\n\n第一行包含一个正整数 $T$，表示测试数据的组数；\n\n接下来 $T$ 行，每行包含两个正整数 $N$ 和 $K$，表示一组测试数据。", "outputFormat": "对于每一个测试数据，输出两行。\n\n其中第一行包含一个整数，表示长度为 $N$ 的无界单词的数量；\n\n其中第二行包含一个长度为 $N$ 的字符串，表示第 $K$ 小的无界单词。", "hint": "对于 $20\\%$ 的数据，满足 $N \\le 20 $；\n\n对于全部数据，满足 $1 \\le T \\le 5$，$1 \\le N \\le 64$，并且保证对于任意测试数据，总存在第 $K$ 小的无界单词。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Unbordered Words", "background": "", "description": "For a word $S$, if there exists a length $l$ such that $0 < l < |S|$, and the prefix of $S$ with length $l$ is the same as the suffix of $S$ with length $l$, then JYY calls $S$ *bordered*. For example, `aabaa` and `ababab` are both bordered strings. If a word does not have such an $l$, then JYY calls it an *unbordered word*.\n\nNow consider all strings of length $N$ that consist only of the letters `a` and `b`. JYY wants to know:\n\n1. How many unbordered words are there in total?\n2. Among these unbordered words, when sorted in lexicographical order, what is the $K$-th smallest word?", "inputFormat": "**This problem contains multiple test cases.**\n\nThe first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain two positive integers $N$ and $K$, describing one test case.", "outputFormat": "For each test case, output two lines.\n\nThe first line contains an integer, the number of unbordered words of length $N$.\n\nThe second line contains a string of length $N$, representing the $K$-th smallest unbordered word.", "hint": "For $20\\%$ of the testdata, $N \\le 20$.\n\nFor all testdata, $1 \\le T \\le 5$, $1 \\le N \\le 64$, and it is guaranteed that for every test case, the $K$-th smallest unbordered word always exists.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 无界单词", "background": "", "description": "对于一个单词 $S$ ，如果存在一个长度 $l$，满足 $0 < l < |S|$，并且使得 $S$ 长度为 $l$ 的前缀与 $S$ 长度为 $l$ 的后缀相同，JYY 则称 $S$ 是有界的。比如 `aabaa` 和 `ababab` 就都是有界的字符串。如果一个单词不存在这样的 $l$ ，则 JYY 称之为无界单词。\n\n现在考虑所有仅由字母 `a` 和 `b` 组成的长度为 $N$ 的字符串，JYY想知道：\n\n1. 一共有多少个无界单词？\n2. 这些无界单词中，按字典序排列第 $K$ 小的单词是哪一个？", "inputFormat": "**本题有多组数据。**\n\n第一行包含一个正整数 $T$，表示测试数据的组数；\n\n接下来 $T$ 行，每行包含两个正整数 $N$ 和 $K$，表示一组测试数据。", "outputFormat": "对于每一个测试数据，输出两行。\n\n其中第一行包含一个整数，表示长度为 $N$ 的无界单词的数量；\n\n其中第二行包含一个长度为 $N$ 的字符串，表示第 $K$ 小的无界单词。", "hint": "对于 $20\\%$ 的数据，满足 $N \\le 20 $；\n\n对于全部数据，满足 $1 \\le T \\le 5$，$1 \\le N \\le 64$，并且保证对于任意测试数据，总存在第 $K$ 小的无界单词。", "locale": "zh-CN"}}}
{"pid": "P5771", "type": "P", "difficulty": 5, "samples": [["6\n1 2 2 3 4 10\n", "4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "各省省选", "江苏"], "title": "[JSOI2016] 反质数序列", "background": "", "description": "对于一个长度为 $L \\ge 2$ 的序列 $X:\\{x_1,x_2,...,x_L\\}$，如果满足对于任意 $1 \\le i < j \\le L$，均有 $x_i+x_j$ 不为质数，则 JYY 认为序列 $X$ 是一个「反质数序列」。\n\nJYY 有一个长度为 $N$ 的序列 $A:\\{a_1,a_2,...,a_N\\}$，他希望从中选出一个包含元素最多的**子序列**，使得这个子序列是一个反质数序列。", "inputFormat": "输入第一行包含一个正整数 $N$；\n\n接下来一行包含 $N$ 个正整数，依次描述 $a_1,a_2,...,a_N$。", "outputFormat": "输出一行一个整数，表示最长反质数子序列的长度。输入保证存在反质数子序列。", "hint": "对于 $10\\%$ 的数据，满足 $N \\le 10$；\n\n对于 $40\\%$ 的数据，满足 $N \\le 150$；\n\n对于 $80\\%$ 的数据，满足 $N \\le 1000$；\n\n对于 $100\\%$ 的数据，满足 $2 \\le N \\le 3000$，$1 \\le a_i \\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Anti-prime Sequence", "background": "", "description": "For a sequence $X:\\{x_1,x_2,...,x_L\\}$ of length $L \\ge 2$, if for any $1 \\le i < j \\le L$, $x_i + x_j$ is not a prime number, then JYY considers the sequence $X$ to be an “anti-prime sequence”.\n\nJYY has a sequence $A:\\{a_1,a_2,...,a_N\\}$ of length $N$. He wants to choose a **subsequence** with as many elements as possible such that this subsequence is an anti-prime sequence.", "inputFormat": "The first line contains a positive integer $N$.\n\nThe next line contains $N$ positive integers, describing $a_1,a_2,...,a_N$ in order.", "outputFormat": "Output one integer in a single line, representing the length of the longest anti-prime subsequence. The input guarantees that an anti-prime subsequence exists.", "hint": "For $10\\%$ of the testdata, $N \\le 10$.\n\nFor $40\\%$ of the testdata, $N \\le 150$.\n\nFor $80\\%$ of the testdata, $N \\le 1000$.\n\nFor $100\\%$ of the testdata, $2 \\le N \\le 3000$, $1 \\le a_i \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 反质数序列", "background": "", "description": "对于一个长度为 $L \\ge 2$ 的序列 $X:\\{x_1,x_2,...,x_L\\}$，如果满足对于任意 $1 \\le i < j \\le L$，均有 $x_i+x_j$ 不为质数，则 JYY 认为序列 $X$ 是一个「反质数序列」。\n\nJYY 有一个长度为 $N$ 的序列 $A:\\{a_1,a_2,...,a_N\\}$，他希望从中选出一个包含元素最多的**子序列**，使得这个子序列是一个反质数序列。", "inputFormat": "输入第一行包含一个正整数 $N$；\n\n接下来一行包含 $N$ 个正整数，依次描述 $a_1,a_2,...,a_N$。", "outputFormat": "输出一行一个整数，表示最长反质数子序列的长度。输入保证存在反质数子序列。", "hint": "对于 $10\\%$ 的数据，满足 $N \\le 10$；\n\n对于 $40\\%$ 的数据，满足 $N \\le 150$；\n\n对于 $80\\%$ 的数据，满足 $N \\le 1000$；\n\n对于 $100\\%$ 的数据，满足 $2 \\le N \\le 3000$，$1 \\le a_i \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5772", "type": "P", "difficulty": 6, "samples": [["3 1\n100", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "各省省选", "江苏"], "title": "[JSOI2016] 位运算", "background": "", "description": "JYY 最近在研究位运算。他发现位运算中最有趣的就是异或 (xor) 运算。对于两个数的异或运算，JYY 发现了一个结论：两个数的异或值为 $0$ 当且仅当他们相等。于是 JYY 又开始思考，对于 $N$ 个数的异或值会有什么性质呢？\n\nJYY 想知道，如果在 $0$ 到 $R-1$ 的范围内，选出 $N$ 个不同的整数，并使得这 $N$ 个整数的异或值为 $0$，那么一共有多少种选择的方法呢？（选择的不同次序并不作重复统计，请参见样例）\n\nJYY 是一个计算机科学家，所以他脑海里的 $R$ 非常非常大。为了能够方便的表达，如果我们将 $R$ 写成一个 $01$ 串，那么 $R$ 是由一个较短的 $01$ 串 $S$ 重复 $K$ 次得到的。比如，若 $S=101$，$K=2$，那么 $R$ 的二进制表示则为 $101101$。由于计算的结果会非常大，JYY 只需要你告诉他选择的总数对 $10^9+7$ 取模的结果即可。", "inputFormat": "第一行包含两个正整数 $N$ 和 $K$；\n\n接下来一行包含一个由 $0$ 和 $1$ 组成的字符串 $S$；\n\n我们保证 $S$ 的第一个字符一定为 $1$。", "outputFormat": "一行一个整数，表示选择的方案数对 $10^9+7$ 取模的值。", "hint": "**样例说明**\n\n唯一的一种选择方法是选择 $\\{1,2,3\\}$。\n\n------\n\n**数据范围**\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 7$，$1 \\le k \\le 10^5$，$1 \\le |S| \\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Bitwise Operations", "background": "", "description": "JYY has recently been studying bitwise operations. He found that the most interesting one is the xor operation. For the xor of two numbers, JYY discovered a fact: the xor of two numbers is $0$ if and only if they are equal. Then JYY started thinking: what properties does the xor of $N$ numbers have?\n\nJYY wants to know: within the range from $0$ to $R-1$, choose $N$ distinct integers such that the xor of these $N$ integers is $0$. How many different ways are there to choose them? (Different selection orders are not counted multiple times; see the sample.)\n\nJYY is a computer scientist, so the $R$ in his mind is extremely large. To describe it conveniently, if we write $R$ as a binary string, then $R$ is obtained by repeating a shorter binary string $S$ for $K$ times. For example, if $S=101$ and $K=2$, then the binary representation of $R$ is $101101$. Since the result can be very large, you only need to output the total number of ways modulo $10^9+7$.", "inputFormat": "The first line contains two positive integers $N$ and $K$.\n\nThe next line contains a string $S$ consisting of characters $0$ and $1$.\n\nIt is guaranteed that the first character of $S$ is $1$.", "outputFormat": "Output one integer in one line, the number of valid selections modulo $10^9+7$.", "hint": "**Sample Explanation**\n\nThe only valid selection is $\\{1,2,3\\}$.\n\n------\n\n**Constraints**\n\nFor $100\\%$ of the testdata, $3 \\le N \\le 7$, $1 \\le k \\le 10^5$, $1 \\le |S| \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 位运算", "background": "", "description": "JYY 最近在研究位运算。他发现位运算中最有趣的就是异或 (xor) 运算。对于两个数的异或运算，JYY 发现了一个结论：两个数的异或值为 $0$ 当且仅当他们相等。于是 JYY 又开始思考，对于 $N$ 个数的异或值会有什么性质呢？\n\nJYY 想知道，如果在 $0$ 到 $R-1$ 的范围内，选出 $N$ 个不同的整数，并使得这 $N$ 个整数的异或值为 $0$，那么一共有多少种选择的方法呢？（选择的不同次序并不作重复统计，请参见样例）\n\nJYY 是一个计算机科学家，所以他脑海里的 $R$ 非常非常大。为了能够方便的表达，如果我们将 $R$ 写成一个 $01$ 串，那么 $R$ 是由一个较短的 $01$ 串 $S$ 重复 $K$ 次得到的。比如，若 $S=101$，$K=2$，那么 $R$ 的二进制表示则为 $101101$。由于计算的结果会非常大，JYY 只需要你告诉他选择的总数对 $10^9+7$ 取模的结果即可。", "inputFormat": "第一行包含两个正整数 $N$ 和 $K$；\n\n接下来一行包含一个由 $0$ 和 $1$ 组成的字符串 $S$；\n\n我们保证 $S$ 的第一个字符一定为 $1$。", "outputFormat": "一行一个整数，表示选择的方案数对 $10^9+7$ 取模的值。", "hint": "**样例说明**\n\n唯一的一种选择方法是选择 $\\{1,2,3\\}$。\n\n------\n\n**数据范围**\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 7$，$1 \\le k \\le 10^5$，$1 \\le |S| \\le 50$。", "locale": "zh-CN"}}}
{"pid": "P5773", "type": "P", "difficulty": 6, "samples": [["8\n2 3\n4 5\n0 0\n6 7\n0 8\n0 0\n0 0\n0 0\n7\n6 7 8 5 4 2 3\n", "20\n21\n15\n7\n6\n2\n3\n0\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "各省省选", "江苏", "树链剖分"], "title": "[JSOI2016] 轻重路径", "background": "", "description": "JYY 最近学习了一种处理树形结构的高级技巧，叫「轻重路径剖分」。这种技术会将树中的边划分成轻边和重边。相连的重边会形成一些树上相离的路径。「轻重路径剖分」可以使得从树上任意一点走到根，都至多只会经过 $(\\log N)$ 条不同的重路径。\n\n如果你不了解轻重路径剖分，JYY 在这里简单介绍一下：对于一棵有根树中的任意一个点 $u$，我们用 $size(u)$ 表示其为根的子树中的点的数量。对于 $u$ 的所有孩子中，我们选出 $size$ 值最大的孩子 $v$，并将边 $(u,v)$ 设置成重边，$u$ 和其他孩子之间的边我们均设置为轻边。\n\n为了简化问题，这里 JYY 仅考虑一棵 $N$ 个点的有根二叉树。这 $N$ 个点由 $1$ 到 $N$ 编号。并且如果 $u$ 存在两个 $size$ 值一样的孩子，则我们默认 $u$ 和其左孩子的连边为重边。\n\n现在 JYY 希望执行额外 $Q$ 次删点操作，每次 JYY 会随机删掉一个当前二叉树的叶子节点，而你则需要动态的维护这棵树的轻重路径剖分。\n\n为了方便输出，你只需要在每次操作后输出所有重边指向的点的编号之和即可。\n\n如果删除一个点之后，存在一个点 $u$ 拥有两个 $size$ 值一样的孩子，则我们保持 $u$ 在该操作执行之前的重边划分。", "inputFormat": "第一行包含一个整数 $N$；\n\n接下来 $N$ 行，第 $i$ 行包含两个整数 $L_i,R_i$，表示编号为 $i$ 的点的左孩子编号和右孩子编号，$L_i=0$表示点 $i$ 没有左孩子， $R_i=0$表示点 $i$ 没有右孩子；\n\n第 $N+2$ 行包含一个整数 $Q$，表示 JYY 进行的删点操作；\n\n第 $N+3$ 行包含 $Q$ 个空格分开的正整数，表示 JYY 删去的叶子的编号。\n\n输入数据保证每次删除操作均删除了一个叶子。", "outputFormat": "输出 $Q+1$ 行，每行包含一个整数，表示在轻重路径剖分中所有重边指向的点的编号的和。其中第一行对应初始的路径剖分，之后的 $Q$ 行对应进行了相应删点操作之后路径划分。", "hint": "对于 $30\\%$ 的数据，满足 $N \\le 1000$；\n\n对于 $50\\%$ 的数据，满足 $N \\le 5 \\times 10^4$；\n\n对于全部数据，满足 $N \\le 2 \\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Heavy-Light Paths", "background": "", "description": "JYY has recently learned an advanced technique for processing tree structures, called “heavy-light decomposition”. This technique divides the edges of a tree into light edges and heavy edges. Connected heavy edges form several vertex-disjoint paths on the tree. With heavy-light decomposition, starting from any node and walking to the root, you will pass through at most $(\\log N)$ different heavy paths.\n\nIf you are not familiar with heavy-light decomposition, JYY gives a brief introduction here. For any node $u$ in a rooted tree, let $size(u)$ denote the number of nodes in the subtree rooted at $u$. Among all children of $u$, choose the child $v$ with the largest $size$ value, and mark the edge $(u,v)$ as a heavy edge. All edges between $u$ and its other children are marked as light edges.\n\nTo simplify the problem, JYY only considers a rooted binary tree with $N$ nodes. The $N$ nodes are numbered from $1$ to $N$. If a node $u$ has two children with the same $size$ value, then by default the edge between $u$ and its left child is the heavy edge.\n\nNow JYY wants to perform an additional $Q$ node-deletion operations. Each time, JYY will randomly delete a current leaf node of the binary tree, and you need to dynamically maintain the heavy-light decomposition of this tree.\n\nFor convenient output, after each operation you only need to output the sum of the indices of all nodes pointed to by heavy edges.\n\nIf after deleting a node, there exists a node $u$ whose two children have the same $size$ value, then we keep the heavy-edge choice of $u$ the same as it was before this operation was performed.", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines: the $i$-th line contains two integers $L_i, R_i$, representing the index of the left child and the right child of node $i$. $L_i = 0$ means node $i$ has no left child, and $R_i = 0$ means node $i$ has no right child.\n\nThe $(N+2)$-th line contains an integer $Q$, indicating the number of deletion operations performed by JYY.\n\nThe $(N+3)$-th line contains $Q$ space-separated positive integers, representing the indices of the leaves deleted by JYY.\n\nThe input guarantees that each deletion operation deletes a leaf.", "outputFormat": "Output $Q + 1$ lines. Each line contains one integer: the sum of the indices of all nodes pointed to by heavy edges in the heavy-light decomposition. The first line corresponds to the initial decomposition, and the following $Q$ lines correspond to the decomposition after each deletion operation.", "hint": "For $30\\%$ of the testdata, $N \\le 1000$.\n\nFor $50\\%$ of the testdata, $N \\le 5 \\times 10^4$.\n\nFor all testdata, $N \\le 2 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 轻重路径", "background": "", "description": "JYY 最近学习了一种处理树形结构的高级技巧，叫「轻重路径剖分」。这种技术会将树中的边划分成轻边和重边。相连的重边会形成一些树上相离的路径。「轻重路径剖分」可以使得从树上任意一点走到根，都至多只会经过 $(\\log N)$ 条不同的重路径。\n\n如果你不了解轻重路径剖分，JYY 在这里简单介绍一下：对于一棵有根树中的任意一个点 $u$，我们用 $size(u)$ 表示其为根的子树中的点的数量。对于 $u$ 的所有孩子中，我们选出 $size$ 值最大的孩子 $v$，并将边 $(u,v)$ 设置成重边，$u$ 和其他孩子之间的边我们均设置为轻边。\n\n为了简化问题，这里 JYY 仅考虑一棵 $N$ 个点的有根二叉树。这 $N$ 个点由 $1$ 到 $N$ 编号。并且如果 $u$ 存在两个 $size$ 值一样的孩子，则我们默认 $u$ 和其左孩子的连边为重边。\n\n现在 JYY 希望执行额外 $Q$ 次删点操作，每次 JYY 会随机删掉一个当前二叉树的叶子节点，而你则需要动态的维护这棵树的轻重路径剖分。\n\n为了方便输出，你只需要在每次操作后输出所有重边指向的点的编号之和即可。\n\n如果删除一个点之后，存在一个点 $u$ 拥有两个 $size$ 值一样的孩子，则我们保持 $u$ 在该操作执行之前的重边划分。", "inputFormat": "第一行包含一个整数 $N$；\n\n接下来 $N$ 行，第 $i$ 行包含两个整数 $L_i,R_i$，表示编号为 $i$ 的点的左孩子编号和右孩子编号，$L_i=0$表示点 $i$ 没有左孩子， $R_i=0$表示点 $i$ 没有右孩子；\n\n第 $N+2$ 行包含一个整数 $Q$，表示 JYY 进行的删点操作；\n\n第 $N+3$ 行包含 $Q$ 个空格分开的正整数，表示 JYY 删去的叶子的编号。\n\n输入数据保证每次删除操作均删除了一个叶子。", "outputFormat": "输出 $Q+1$ 行，每行包含一个整数，表示在轻重路径剖分中所有重边指向的点的编号的和。其中第一行对应初始的路径剖分，之后的 $Q$ 行对应进行了相应删点操作之后路径划分。", "hint": "对于 $30\\%$ 的数据，满足 $N \\le 1000$；\n\n对于 $50\\%$ 的数据，满足 $N \\le 5 \\times 10^4$；\n\n对于全部数据，满足 $N \\le 2 \\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5774", "type": "P", "difficulty": 5, "samples": [["6\n40 200 1 300 2 10", "1950"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "各省省选", "江苏", "区间 DP"], "title": "[JSOI2016] 病毒感染", "background": null, "description": "JOSI 的边陲小镇爆发了严重的 Jebola 病毒疫情，大批群众感染生命垂危。计算机科学家 JYY 采用最新的算法紧急研制出了 Jebola 疫苗，并火速前往灾区救治患者。\n\n一共有 $N$ 个小镇爆发了 Jebola 疫情。这些小镇由于地处边陲，仅仅通过一条长直公路连接。方便起见我们将这些小镇按照公路连接顺序由 $1$ 编号到 $N$。JYY 会在第一天一早抵达 $1$ 号小镇。\n\n一开始在 $i$ 号小镇，有 $a_i$ 名患者感染了 Jebola 病毒。\n\n每一天 JYY 可以选择：\n\n1. 花费一天时间彻底治愈 JYY 目前所在的村庄的所有 Jebola 患者。这一天不会有任何患者死去；\n2. 花费一天的时间前往一个相邻的村庄。\n\n当一天开始时，如果一个村庄里有 $k$ 个 Jebola 患者，那么这一天结束时，这 $k$ 个患者会感染另外 $k$ 个这个村子里的健康村民并死去。所以对于 $i$ 号村庄，只要这个村庄没有被 JYY 彻底消灭疫情，那么每一天都会有 $a_i$ 个村民死去。\n\nJYY 希望采用措施使得疫情被整体消灭时，总共死去的村民数量尽量少。\n\n为了达成这一目标，JYY 有时会选择抵达一个村庄但是并不对村民进行施救。这样的行为如果不加限制，往往会造成更加严重的后果。\n\n试想这样的情形：假设当 JYY 第一次抵达村庄 $i$，未作救治并直接前往了另一个村庄。那么由于 $i$ 村庄的人们求生心切，一旦当 JYY 朝向靠近 $i$ 村庄的方向前行时，$i$ 村庄的村民就会以为 JYY 是来救他们了，而产生巨大的期望。之后倘若 JYY 再次掉头朝着远离 $i$ 村庄的方向行进，那么 $i$ 村庄的村民就会因为巨大的失落而产生绝望的情绪。\n\n为了避免这种情况，JYY 对他的行程做了如下规定：\n\n假设 JYY 进入 $i$ 村庄并在第二天立即离开（村庄 $i$ 的疫情并未治愈）。如果在之后的某一天，JYY 从村庄 $j$ 前往村庄 $k$，并满足 $|k-i| \\lt |i-j|$。那么在之后的日子里 JYY 只能朝着 $i$ 村庄前进直到抵达 $i$ 村庄并立即治愈该村的患者。在前往 $i$ 村庄的过程中，JYY 可以选择将途经村庄的疫情治愈。\n\n比如，如果 JYY 有如下行程：\n\n第一天：从村庄 $1$ 前往村庄 $2$；\n\n第二天：从村庄 $2$ 前往村庄 $3$；\n\n第三天：治愈村庄 $3$；\n\n第四天：前往村庄 $2$。\n\n此时 JYY 对于之后三天的行程只有唯一一种选择：\n\n第五天：治愈村庄 $2$；\n\n第六天：前往村庄 $1$；\n\n第七天：治愈村庄 $1$。\n\nJYY 想知道在治愈所有村庄之前，至少会有多少村民因 Jebola 死去。", "inputFormat": "输入第一行包含一个正整数 $N$；\n\n接下来一行包含 $N$ 个整数，分别为 $a_1,a_2,...,a_N$。", "outputFormat": "输出一行一个整数，表示最优行程安排下会死去的村民数量。", "hint": "**样例说明**\n\n我们用 $C(k)$ 表示治愈 $k$ 号村庄，$i \\rightarrow j$ 表示从村庄 $i$ 前进到村庄 $j$，用逗号分隔每一天的行程安排，那么样例中的最优策略为：\n\n$1 \\rightarrow 2 , C(2),2 \\rightarrow 3 , 3 \\rightarrow 4 , C(4) , 4 \\rightarrow 3 , C(3) , 3 \\rightarrow 2 , 2 \\rightarrow 1 , C(1) , 1 \\rightarrow 2 , 2 \\rightarrow 3 , 3 \\rightarrow 4 , 4 \\rightarrow 5 , 5 \\rightarrow 6 , C(6) , 6 \\rightarrow 5 , C(5)$;\n\n整个过程耗时 $18$ 天。\n\n------\n\n**数据范围**\n\n对于 $10\\%$ 的数据，满足 $N \\le 10$；\n\n对于 $30\\%$ 的数据，满足 $N \\le 20$；\n\n对于 $50\\%$ 的数据，满足 $N \\le 60$；\n\n对于 $100\\%$ 的数据，满足 $1 \\le N \\le 3000$，$1 \\le a_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2016] Virus Infection", "background": "", "description": "A severe Jebola virus outbreak has occurred in a remote border town of JOSI, and many people are infected and in critical condition. Computer scientist JYY has urgently developed a Jebola vaccine using the latest algorithm and rushes to the disaster area to treat patients.\n\nThere are $N$ towns with Jebola outbreaks. Because these towns are located on the border, they are connected only by one long straight road. For convenience, we number the towns from $1$ to $N$ in the order along the road. JYY will arrive at town $1$ early on the first day.\n\nInitially, in town $i$, there are $a_i$ patients infected with the Jebola virus.\n\nEach day, JYY may choose one of the following:\n\n1. Spend one day to completely cure all Jebola patients in the town where JYY currently is. On this day, no patients will die.\n2. Spend one day to travel to an adjacent town.\n\nAt the start of a day, if there are $k$ Jebola patients in a town, then by the end of that day, these $k$ patients will infect another $k$ healthy villagers in that town and then die. Therefore, for town $i$, as long as its outbreak has not been completely eliminated by JYY, every day there will be $a_i$ villagers who die.\n\nJYY wants to take actions so that when the epidemic is completely eliminated overall, the total number of villagers who die is as small as possible.\n\nTo achieve this, JYY sometimes will arrive at a town but not treat the villagers. If such behavior is not restricted, it often leads to even more serious consequences.\n\nConsider this situation: suppose when JYY first arrives at town $i$, he does not treat anyone and goes directly to another town. Because the people in town $i$ are desperate to survive, once JYY moves in the direction closer to town $i$, the villagers of town $i$ will think JYY is coming to save them, and they will have great hope. Later, if JYY turns around again and moves in the direction farther away from town $i$, the villagers of town $i$ will fall into despair due to huge disappointment.\n\nTo avoid this, JYY sets the following rule for his trip:\n\nSuppose JYY enters town $i$ and leaves immediately on the second day (and the outbreak in town $i$ is not cured). If on some later day, JYY travels from town $j$ to town $k$ and satisfies $|k-i| \\lt |i-j|$, then in the days after that JYY may only move toward town $i$ until he reaches town $i$ and immediately cures the patients there. While traveling toward town $i$, JYY may choose to cure the outbreaks in towns he passes through.\n\nFor example, if JYY has the following schedule:\n\nDay 1: travel from town $1$ to town $2$.\n\nDay 2: travel from town $2$ to town $3$.\n\nDay 3: cure town $3$.\n\nDay 4: travel to town $2$.\n\nAt this time, for the next three days, JYY has only one possible choice:\n\nDay 5: cure town $2$.\n\nDay 6: travel to town $1$.\n\nDay 7: cure town $1$.\n\nJYY wants to know, before all towns are cured, at least how many villagers will die from Jebola.", "inputFormat": "The first line contains a positive integer $N$.\n\nThe next line contains $N$ integers, which are $a_1,a_2,...,a_N$.", "outputFormat": "Output one line with one integer, representing the number of villagers who will die under the optimal schedule.", "hint": "**Sample Explanation**\n\nWe use $C(k)$ to denote curing town $k$, and $i \\rightarrow j$ to denote traveling from town $i$ to town $j$. Using commas to separate the plan for each day, the optimal strategy in the sample is:\n\n$1 \\rightarrow 2 , C(2),2 \\rightarrow 3 , 3 \\rightarrow 4 , C(4) , 4 \\rightarrow 3 , C(3) , 3 \\rightarrow 2 , 2 \\rightarrow 1 , C(1) , 1 \\rightarrow 2 , 2 \\rightarrow 3 , 3 \\rightarrow 4 , 4 \\rightarrow 5 , 5 \\rightarrow 6 , C(6) , 6 \\rightarrow 5 , C(5)$;\n\nThe whole process takes $18$ days.\n\n------\n\n**Constraints**\n\nFor $10\\%$ of the testdata, $N \\le 10$.\n\nFor $30\\%$ of the testdata, $N \\le 20$.\n\nFor $50\\%$ of the testdata, $N \\le 60$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 3000$, $1 \\le a_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2016] 病毒感染", "background": null, "description": "JOSI 的边陲小镇爆发了严重的 Jebola 病毒疫情，大批群众感染生命垂危。计算机科学家 JYY 采用最新的算法紧急研制出了 Jebola 疫苗，并火速前往灾区救治患者。\n\n一共有 $N$ 个小镇爆发了 Jebola 疫情。这些小镇由于地处边陲，仅仅通过一条长直公路连接。方便起见我们将这些小镇按照公路连接顺序由 $1$ 编号到 $N$。JYY 会在第一天一早抵达 $1$ 号小镇。\n\n一开始在 $i$ 号小镇，有 $a_i$ 名患者感染了 Jebola 病毒。\n\n每一天 JYY 可以选择：\n\n1. 花费一天时间彻底治愈 JYY 目前所在的村庄的所有 Jebola 患者。这一天不会有任何患者死去；\n2. 花费一天的时间前往一个相邻的村庄。\n\n当一天开始时，如果一个村庄里有 $k$ 个 Jebola 患者，那么这一天结束时，这 $k$ 个患者会感染另外 $k$ 个这个村子里的健康村民并死去。所以对于 $i$ 号村庄，只要这个村庄没有被 JYY 彻底消灭疫情，那么每一天都会有 $a_i$ 个村民死去。\n\nJYY 希望采用措施使得疫情被整体消灭时，总共死去的村民数量尽量少。\n\n为了达成这一目标，JYY 有时会选择抵达一个村庄但是并不对村民进行施救。这样的行为如果不加限制，往往会造成更加严重的后果。\n\n试想这样的情形：假设当 JYY 第一次抵达村庄 $i$，未作救治并直接前往了另一个村庄。那么由于 $i$ 村庄的人们求生心切，一旦当 JYY 朝向靠近 $i$ 村庄的方向前行时，$i$ 村庄的村民就会以为 JYY 是来救他们了，而产生巨大的期望。之后倘若 JYY 再次掉头朝着远离 $i$ 村庄的方向行进，那么 $i$ 村庄的村民就会因为巨大的失落而产生绝望的情绪。\n\n为了避免这种情况，JYY 对他的行程做了如下规定：\n\n假设 JYY 进入 $i$ 村庄并在第二天立即离开（村庄 $i$ 的疫情并未治愈）。如果在之后的某一天，JYY 从村庄 $j$ 前往村庄 $k$，并满足 $|k-i| \\lt |i-j|$。那么在之后的日子里 JYY 只能朝着 $i$ 村庄前进直到抵达 $i$ 村庄并立即治愈该村的患者。在前往 $i$ 村庄的过程中，JYY 可以选择将途经村庄的疫情治愈。\n\n比如，如果 JYY 有如下行程：\n\n第一天：从村庄 $1$ 前往村庄 $2$；\n\n第二天：从村庄 $2$ 前往村庄 $3$；\n\n第三天：治愈村庄 $3$；\n\n第四天：前往村庄 $2$。\n\n此时 JYY 对于之后三天的行程只有唯一一种选择：\n\n第五天：治愈村庄 $2$；\n\n第六天：前往村庄 $1$；\n\n第七天：治愈村庄 $1$。\n\nJYY 想知道在治愈所有村庄之前，至少会有多少村民因 Jebola 死去。", "inputFormat": "输入第一行包含一个正整数 $N$；\n\n接下来一行包含 $N$ 个整数，分别为 $a_1,a_2,...,a_N$。", "outputFormat": "输出一行一个整数，表示最优行程安排下会死去的村民数量。", "hint": "**样例说明**\n\n我们用 $C(k)$ 表示治愈 $k$ 号村庄，$i \\rightarrow j$ 表示从村庄 $i$ 前进到村庄 $j$，用逗号分隔每一天的行程安排，那么样例中的最优策略为：\n\n$1 \\rightarrow 2 , C(2),2 \\rightarrow 3 , 3 \\rightarrow 4 , C(4) , 4 \\rightarrow 3 , C(3) , 3 \\rightarrow 2 , 2 \\rightarrow 1 , C(1) , 1 \\rightarrow 2 , 2 \\rightarrow 3 , 3 \\rightarrow 4 , 4 \\rightarrow 5 , 5 \\rightarrow 6 , C(6) , 6 \\rightarrow 5 , C(5)$;\n\n整个过程耗时 $18$ 天。\n\n------\n\n**数据范围**\n\n对于 $10\\%$ 的数据，满足 $N \\le 10$；\n\n对于 $30\\%$ 的数据，满足 $N \\le 20$；\n\n对于 $50\\%$ 的数据，满足 $N \\le 60$；\n\n对于 $100\\%$ 的数据，满足 $1 \\le N \\le 3000$，$1 \\le a_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5775", "type": "P", "difficulty": 3, "samples": [["0 1 1 10\n10000\n", "89\n113"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2006", "各省省选", "安徽"], "title": "[AHOI2006] 斐波卡契的兔子", "background": "", "description": "卡卡开始养兔子了！妈妈给他买了一对刚出生的兔子，卡卡了解到兔子的繁殖规律是这样的：才出生的一对兔子在一个月后将第一次生出一胎 $a$ 对兔子，接着在出生后的二个月又将生出 $b$ 对兔子，在第三个月和以后每个月都会繁殖 $c$ 对兔子（$a \\le b \\le c$）。   由斐波纳契数列我们知道兔子的繁殖速度是很快的，然而卡卡有兔子一样多的好朋友，卡卡想在 $m$ 个月后有 $k$ 对兔子，以便分给他们的好友，他的愿望是否能够实现呢？\n\n[任务] 编写一个程序：从输入文件中读入输入信息；计算 $m$ 个月后卡卡将有多少对兔子，设之为 $P$；计算如果 $m$ 个月后卡卡要拥有至少 $k$ 对兔子，那么开始时妈妈至少应该为卡卡购买多少对兔子，设之为 $Q$ ；将结果输出至输出文件。", "inputFormat": "输入文件的第一行有四个正整数：$a$，$b$，$c$ 和 $m$；而第二行则仅含一个正整数 $k$。它们的含义见上文描述。", "outputFormat": "输出两行，第一行是一个整数 $P$ 而第二行是一个整数 $Q$。", "hint": "$0 \\le a \\le b \\le c \\le 100$，$1 \\le m \\le 3000$，$1 \\le k \\le 10^{6000}$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2006] Fibonacci-like Rabbits.", "background": "", "description": "Kaka has started raising rabbits. His mother bought him a pair of newborn rabbits. Kaka learned that the rabbits reproduce as follows: a pair of rabbits will give birth for the first time one month after birth, producing $a$ pairs of rabbits. Then, two months after birth, they will produce $b$ pairs of rabbits. In the third month and every month after that, they will reproduce $c$ pairs of rabbits each month ($a \\le b \\le c$). We know from the Fibonacci sequence that rabbits can reproduce very quickly. However, Kaka has as many good friends as rabbits, so he wants to have $k$ pairs of rabbits after $m$ months to give them to his friends. Can his wish come true?\n\n[Task] Write a program that reads the input information from the input file; computes how many pairs of rabbits Kaka will have after $m$ months, denoted as $P$; computes the minimum number of pairs of rabbits his mother must buy at the beginning so that Kaka will have at least $k$ pairs of rabbits after $m$ months, denoted as $Q$; and outputs the results to the output file.", "inputFormat": "The first line of the input file contains four positive integers: $a$, $b$, $c$, and $m$. The second line contains only one positive integer $k$. Their meanings are described above.", "outputFormat": "Output two lines. The first line contains an integer $P$, and the second line contains an integer $Q$.", "hint": "Constraints: $0 \\le a \\le b \\le c \\le 100$, $1 \\le m \\le 3000$, $1 \\le k \\le 10^{6000}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2006] 斐波卡契的兔子", "background": "", "description": "卡卡开始养兔子了！妈妈给他买了一对刚出生的兔子，卡卡了解到兔子的繁殖规律是这样的：才出生的一对兔子在一个月后将第一次生出一胎 $a$ 对兔子，接着在出生后的二个月又将生出 $b$ 对兔子，在第三个月和以后每个月都会繁殖 $c$ 对兔子（$a \\le b \\le c$）。   由斐波纳契数列我们知道兔子的繁殖速度是很快的，然而卡卡有兔子一样多的好朋友，卡卡想在 $m$ 个月后有 $k$ 对兔子，以便分给他们的好友，他的愿望是否能够实现呢？\n\n[任务] 编写一个程序：从输入文件中读入输入信息；计算 $m$ 个月后卡卡将有多少对兔子，设之为 $P$；计算如果 $m$ 个月后卡卡要拥有至少 $k$ 对兔子，那么开始时妈妈至少应该为卡卡购买多少对兔子，设之为 $Q$ ；将结果输出至输出文件。", "inputFormat": "输入文件的第一行有四个正整数：$a$，$b$，$c$ 和 $m$；而第二行则仅含一个正整数 $k$。它们的含义见上文描述。", "outputFormat": "输出两行，第一行是一个整数 $P$ 而第二行是一个整数 $Q$。", "hint": "$0 \\le a \\le b \\le c \\le 100$，$1 \\le m \\le 3000$，$1 \\le k \\le 10^{6000}$。", "locale": "zh-CN"}}}
{"pid": "P5776", "type": "P", "difficulty": 6, "samples": [["2\n4 6\n1 2 1\n1 3 2\n1 3 3\n2 4 2\n3 4 1\n2 3 1\n2 1\n1 2 3\n", "6\nimpossible\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "图论", "2013", "各省省选", "陕西"], "title": "[SNOI2013] Quare", "background": null, "description": "4.20 四川芦山地震发生后，抗震救灾委员会接到一个紧急任务，四川省给该委员会发了一份地图，这份地图给出了该省一些城市的情况：任两个城市是用一条或多条公路连接起来的，也可以没有公路连接，但是每个城市都可以直接或间接地到达另外的城市，注意这些公路是可以双向行驶的。由于最近余震、暴雨造成泥石流倾泻，使得车辆在这些公路上行驶很不安全，于是四川省决定尽快对部分公路进行抢修，以保障救援车辆行车安全。\n    \n该省对所有的公路情况都进行了勘察，分析估计了抢修某段公路所需要花费的时间，并记录在地图中。现在该省希望抗震救灾委员会能找到一个方案，该方案决定出哪些公路需要抢修，使得抢修后的公路仍能保证任意两个城市之间都能直接或间接地相连，同时为了安全起见，即使某一条抢修的公路被泥石流阻断了，任意两城市仍能保持这个性质。由于时间紧迫，抗震救灾委员会还需保证找到的这个方案总抢修时间最短。", "inputFormat": "第一行为一个整数 $T$，为数据总数，接下来按顺序给出每个数据的描述。\n\n首先是两个整数 $n, m$ 分别表示城市数量和公路数量，下面 $m$ 行每行三个整数 $x, y, c$ 描述了一条公路的情况：$x$ 城市与 $y$ 城市之间的一条公路，抢修该公路需要 $c$ 个单位时间。\n\n注意上面所说的两城市间可能有多条公路。", "outputFormat": "按顺序输出每个数据的结果，如果找不到一条合适的方案，则输出一行 `impossible`，否则输出一个整数，为抢修的最优方案所需要的总时间。", "hint": "对于 $100\\%$ 的数据，$1 \\leq T \\leq 3$，$1 \\leq n \\leq 12$，$1 \\leq m \\leq 40$，$1\\le c\\le 5\\times 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2013] Quare", "background": null, "description": "4.20 四川芦山地震发生后，抗震救灾委员会接到一个紧急任务，四川省给该委员会发了一份地图，这份地图给出了该省一些城市的情况：任两个城市是用一条或多条公路连接起来的，也可以没有公路连接，但是每个城市都可以直接或间接地到达另外的城市，注意这些公路是可以双向行驶的。由于最近余震、暴雨造成泥石流倾泻，使得车辆在这些公路上行驶很不安全，于是四川省决定尽快对部分公路进行抢修，以保障救援车辆行车安全。\n    \n该省对所有的公路情况都进行了勘察，分析估计了抢修某段公路所需要花费的时间，并记录在地图中。现在该省希望抗震救灾委员会能找到一个方案，该方案决定出哪些公路需要抢修，使得抢修后的公路仍能保证任意两个城市之间都能直接或间接地相连，同时为了安全起见，即使某一条抢修的公路被泥石流阻断了，任意两城市仍能保持这个性质。由于时间紧迫，抗震救灾委员会还需保证找到的这个方案总抢修时间最短。", "inputFormat": "第一行为一个整数 $T$，为数据总数，接下来按顺序给出每个数据的描述。\n\n首先是两个整数 $n, m$ 分别表示城市数量和公路数量，下面 $m$ 行每行三个整数 $x, y, c$ 描述了一条公路的情况：$x$ 城市与 $y$ 城市之间的一条公路，抢修该公路需要 $c$ 个单位时间。\n\n注意上面所说的两城市间可能有多条公路。", "outputFormat": "按顺序输出每个数据的结果，如果找不到一条合适的方案，则输出一行 `impossible`，否则输出一个整数，为抢修的最优方案所需要的总时间。", "hint": "对于 $100\\%$ 的数据，$1 \\leq T \\leq 3$，$1 \\leq n \\leq 12$，$1 \\leq m \\leq 40$，$1\\le c\\le 5\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5777", "type": "P", "difficulty": 0, "samples": [["1\n5 0 1 0\n0 0 0 0 0 0 0 0\n1 0 0 0 1 0 0 0\n0 1 0 0 1 1 0 0\n1 1 0 0 0 1 0 0\n0 0 1 0 0 1 1 0\n1 0 1 0 1 1 1 0\n0 1 1 0 1 0 1 0\n1 1 1 0 0 0 1 0\n0 0 0 1 0 0 1 1\n1 0 0 1 1 0 1 1\n0 1 0 1 1 1 1 1\n1 1 0 1 0 1 1 1\n0 0 1 1 0 1 0 1\n1 0 1 1 1 1 0 1\n0 1 1 1 1 0 0 1\n1 1 1 1 0 0 0 1", "Yes\n3\n5 1 2 1\n6 1 3 2\n7 1 4 3\n5 6 7 4"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2001", "CTSC/CTS"], "title": "[CTSC2001] 逻辑电路最优设计", "background": "", "description": "W 教授在 T 大学计算机系里开了一门「数字逻辑」课，主要讲授如何设计逻辑电路。这一天，W 教授布置了一个实验：设计并实现一个 $4$ 端输入、$4$ 端输出的逻辑译码电路。设计这样的电路原本并不困难，但是，教授给出了如下的要求：\n1. 只允许使用 $2$ 端输入、$1$ 端输出的门电路作为实现电路的组件，而且可用门电路的种类和数目都已给定；\n2. 使用最少数目的门电路。\n\n这两个要求难倒了全系的同学，于是，Q 同学找到了正在参加 CTSC（中国队选拔赛）的你，希望你能帮忙编写一个程序，自动找出符合要求的连接方式。\n\n在数字逻辑中，所有信号都可以看作只有两个值：「高电平」和「低电平」，分别用 $1$ 和 $0$ 来表示。\n\n一个门电路元件的特性由其输入/输出功能表唯一给出，所谓功能表，就是输入信号电平与输出信号电平之间的关系表。比如，「与门」的符号和功能表如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b87mvx5h.png)\n\n|X|Y|S|\n|:-:|:-:|:-:|\n|0|0|0|\n|1|0|0|\n|0|1|0|\n|1|1|1|\n\n上图中，如果「与门」的两个输入端 X 和 Y 都是高电平 $1$，则输出端 S 也是高电平 $1$，否则，输出端 S 是低电平 $0$。\n\n假定，本次实验提供的门电路都具有输入对称性，即交换两个输入端的信号，输出不变。但是，如果门电路的输入端悬空（即没有加输入信号），则输出无意义。\n\n在连接电路的过程中，一个门电路的输出端可以将信号送到其他多个元件的输入端；而门电路的一个输入端则只能接收来自一个输出端的信号。如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7fp5byqu.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/8gad519v.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/5tg1p4j0.png)\n\n其中，前两个连接方式是允许的，最后一个是不允许的。\n\n另外，规定信号必须单向传输，即一个门电路的输出不能直接或间接通过其他门电路回到同一门电路的输入端。如下图所示即为两种不允许的连接方式：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vwlmk3nq.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/77boianl.png)\n\n要求你设计的译码电路是一个有四个输入端和四个输出端的逻辑电路，该译码电路的输入和输出关系通过功能表给出，即给出每种输入组合下的四个输出端的情况。显然，一共有 $2^4=16$ 种输入组合。比如，一个由前述「与门」构成的 $2$ 输入，$2$ 输出的简单译码电路如下图所示（其中，A1, A2 是输入端，Y1, Y2 是输出端）\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ik5itzwc.png)\n\n|A1|A2|Y1|Y2|\n|:-:|:-:|:-:|:-:|\n|0|0|0|0|\n|1|0|0|0|\n|0|1|0|0|\n|1|1|1|1|", "inputFormat": "第一行为一个正整数 $n(n\\le 5)$，表示元件的种类数，其后有连续的 $n$ 行，每行描述一种元件。对正整数 $1\\le k\\le n$：\n\n第 $k+1$ 行有四个以空格隔开的整数，依次为：$m_k,Y_{00},Y_{01},Y_{11}$。\n \n其中，正整数 $m_k$ 表示第 $k$ 种元件的数目（$k$ 即这种元件的种类编号），所有元件的数目之和不会超过 $10$（用于实验的经费并不充足）。$Y_{ij}$ 表示两个输入端分别为 $i$ 和 $j$ 时的输出，即 $Y_{00},Y_{01},Y_{11}$ 是三个非 $0$ 即 $1$ 的数，分别表示在两个输入端均为 $0$；两个输入端一个为 $0$ 另一个为 $1$；以及两个输入端均为 $1$ 的时候，该元件的输出。\n\n第 $n+2$ 到第 $n+17$ 行，表示需组成的集成电路的功能表，每行有 $8$ 个数，分别为 $0$ 或 $1$。其中，前四个数依次对应四个输入端（编号为 $1\\sim 4$）的信号，不存在两行的前四个数完全相同；而后面四个数则对应在各输入端信号为前四个数时，四个输出端依次应输出的信号。", "outputFormat": "第一行为一个单词，`Yes` 或 `No`，如果存在符合要求的设计方案，则为 `Yes`，否则为 `No`。\n\n如果第一行是 `No`，则输出结束。\n\n否则第二行只有一个非负整数 $p$，表示最少需要的门电路数目。下面 $p$ 行分别给出每个门电路在电路中的连接情况的描述。每行有四个以空格隔开的正整数：$S ,K, A, B$，其中 $S$ 表示该门电路的编号（所有用到的门电路按 $5\\sim p+4$ 编号，$1\\sim 4$ 的编号用来表示四个输入端）；$K$ 表示该元件的种类编号（按照输入文件中的顺序由 $1\\sim n$ 编号）；$A$ 和 $B$ 分别表示接入该元件的两个输入端的门电路或译码电路输入端的编号（其中，$A<S,B<S$）。\n\n最后一行有四个正整数，表示组成的译码电路的四个输出端分别所接的元件的编号（在 $1\\sim p+4$ 之间）。", "hint": "#### 样例解释\n样例对应的电路连接方式如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/za2oqzvt.png)", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2001] Optimal Design of Logic Circuits", "background": "", "description": "Professor W teaches a “Digital Logic” course in the Department of Computer Science at University T, mainly about how to design logic circuits. One day, Professor W assigned a lab: design and implement a logic decoder circuit with $4$ inputs and $4$ outputs. Designing such a circuit is not difficult by itself, but the professor imposed the following requirements:\n\n1. You may only use gate components with $2$ inputs and $1$ output, and the available types and quantities of gates are given.\n2. Use as few gate components as possible.\n\nThese requirements stumped the whole department, so student Q came to you, who are participating in CTSC (China Team Selection Contest), and hopes you can write a program to automatically find a wiring scheme that satisfies the requirements.\n\nIn digital logic, all signals can be considered to have only two values: “high level” and “low level”, represented by $1$ and $0$, respectively.\n\nThe behavior of a gate component is uniquely determined by its input/output truth table. A truth table describes the relationship between input signal levels and the output signal level. For example, the symbol and truth table of an “AND gate” are shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b87mvx5h.png)\n\n|X|Y|S|\n|:-:|:-:|:-:|\n|0|0|0|\n|1|0|0|\n|0|1|0|\n|1|1|1|\n\nIn the figure above, if both inputs $X$ and $Y$ of the AND gate are at high level $1$, then the output $S$ is also high level $1$; otherwise, the output $S$ is low level $0$.\n\nAssume that all gate components provided in this lab have symmetric inputs, meaning that swapping the two inputs does not change the output. However, if an input pin of a gate is left floating (i.e., no input signal is connected), then the output is meaningless.\n\nWhen wiring the circuit, the output pin of a gate may send its signal to the input pins of multiple other components, but each input pin of a gate may receive a signal from only one output pin, as shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7fp5byqu.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/8gad519v.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/5tg1p4j0.png)\n\nAmong them, the first two wiring methods are allowed, while the last one is not allowed.\n\nIn addition, signals must be transmitted in only one direction. That is, the output of a gate cannot return (directly or indirectly through other gates) to an input of the same gate. The following figures show two forbidden wiring methods:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vwlmk3nq.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/77boianl.png)\n\nThe decoder circuit you are required to design is a logic circuit with four inputs and four outputs. The input-output relationship of this decoder is given by a truth table, i.e., for each input combination, the states of the four output pins are specified. Clearly, there are $2^4=16$ possible input combinations. For example, a simple $2$-input, $2$-output decoder circuit built from the AND gate above is shown below (where A1, A2 are inputs, and Y1, Y2 are outputs):\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ik5itzwc.png)\n\n|A1|A2|Y1|Y2|\n|:-:|:-:|:-:|:-:|\n|0|0|0|0|\n|1|0|0|0|\n|0|1|0|0|\n|1|1|1|1|", "inputFormat": "The first line contains a positive integer $n(n\\le 5)$, the number of component types. The next $n$ consecutive lines each describe one type of component. For an integer $1\\le k\\le n$:\n\nLine $k+1$ contains four integers separated by spaces: $m_k,Y_{00},Y_{01},Y_{11}$.\n\nHere, the positive integer $m_k$ is the number of available components of type $k$ (where $k$ is the type index). The total number of all components will not exceed $10$ (the lab budget is limited). $Y_{ij}$ denotes the output when the two inputs are $i$ and $j$, respectively. That is, $Y_{00},Y_{01},Y_{11}$ are three values each being either $0$ or $1$, representing the output when both inputs are $0$; when one input is $0$ and the other is $1$; and when both inputs are $1$.\n\nLines $n+2$ to $n+17$ give the truth table of the integrated circuit to be constructed. Each line contains $8$ numbers, each either $0$ or $1$. The first four numbers correspond to the signals on the four input pins (numbered $1\\sim 4$) in order; no two lines have exactly the same first four numbers. The last four numbers correspond to the signals that the four output pins should produce (in order) when the inputs are the given first four numbers.", "outputFormat": "The first line contains one word, `Yes` or `No`. If there exists a design that satisfies the requirements, output `Yes`; otherwise output `No`.\n\nIf the first line is `No`, the output ends.\n\nOtherwise, the second line contains one non-negative integer $p$, the minimum number of gate components needed. The next $p$ lines each describe the wiring of one gate in the circuit. Each line contains four positive integers separated by spaces: $S ,K, A, B$. Here, $S$ is the index of this gate (all used gates are numbered $5\\sim p+4$, while $1\\sim 4$ are reserved for the four input pins). $K$ is the component type index (numbered $1\\sim n$ in the order of the input). $A$ and $B$ are the indices of the gate or decoder input pin connected to the two input pins of this component, respectively (where $A<S,B<S$).\n\nThe last line contains four positive integers, indicating the indices of the components connected to the four output pins of the decoder circuit, respectively (each between $1\\sim p+4$).", "hint": "#### Sample Explanation\n\nThe wiring scheme corresponding to the sample is shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/za2oqzvt.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2001] 逻辑电路最优设计", "background": "", "description": "W 教授在 T 大学计算机系里开了一门「数字逻辑」课，主要讲授如何设计逻辑电路。这一天，W 教授布置了一个实验：设计并实现一个 $4$ 端输入、$4$ 端输出的逻辑译码电路。设计这样的电路原本并不困难，但是，教授给出了如下的要求：\n1. 只允许使用 $2$ 端输入、$1$ 端输出的门电路作为实现电路的组件，而且可用门电路的种类和数目都已给定；\n2. 使用最少数目的门电路。\n\n这两个要求难倒了全系的同学，于是，Q 同学找到了正在参加 CTSC（中国队选拔赛）的你，希望你能帮忙编写一个程序，自动找出符合要求的连接方式。\n\n在数字逻辑中，所有信号都可以看作只有两个值：「高电平」和「低电平」，分别用 $1$ 和 $0$ 来表示。\n\n一个门电路元件的特性由其输入/输出功能表唯一给出，所谓功能表，就是输入信号电平与输出信号电平之间的关系表。比如，「与门」的符号和功能表如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b87mvx5h.png)\n\n|X|Y|S|\n|:-:|:-:|:-:|\n|0|0|0|\n|1|0|0|\n|0|1|0|\n|1|1|1|\n\n上图中，如果「与门」的两个输入端 X 和 Y 都是高电平 $1$，则输出端 S 也是高电平 $1$，否则，输出端 S 是低电平 $0$。\n\n假定，本次实验提供的门电路都具有输入对称性，即交换两个输入端的信号，输出不变。但是，如果门电路的输入端悬空（即没有加输入信号），则输出无意义。\n\n在连接电路的过程中，一个门电路的输出端可以将信号送到其他多个元件的输入端；而门电路的一个输入端则只能接收来自一个输出端的信号。如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7fp5byqu.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/8gad519v.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/5tg1p4j0.png)\n\n其中，前两个连接方式是允许的，最后一个是不允许的。\n\n另外，规定信号必须单向传输，即一个门电路的输出不能直接或间接通过其他门电路回到同一门电路的输入端。如下图所示即为两种不允许的连接方式：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vwlmk3nq.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/77boianl.png)\n\n要求你设计的译码电路是一个有四个输入端和四个输出端的逻辑电路，该译码电路的输入和输出关系通过功能表给出，即给出每种输入组合下的四个输出端的情况。显然，一共有 $2^4=16$ 种输入组合。比如，一个由前述「与门」构成的 $2$ 输入，$2$ 输出的简单译码电路如下图所示（其中，A1, A2 是输入端，Y1, Y2 是输出端）\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ik5itzwc.png)\n\n|A1|A2|Y1|Y2|\n|:-:|:-:|:-:|:-:|\n|0|0|0|0|\n|1|0|0|0|\n|0|1|0|0|\n|1|1|1|1|", "inputFormat": "第一行为一个正整数 $n(n\\le 5)$，表示元件的种类数，其后有连续的 $n$ 行，每行描述一种元件。对正整数 $1\\le k\\le n$：\n\n第 $k+1$ 行有四个以空格隔开的整数，依次为：$m_k,Y_{00},Y_{01},Y_{11}$。\n \n其中，正整数 $m_k$ 表示第 $k$ 种元件的数目（$k$ 即这种元件的种类编号），所有元件的数目之和不会超过 $10$（用于实验的经费并不充足）。$Y_{ij}$ 表示两个输入端分别为 $i$ 和 $j$ 时的输出，即 $Y_{00},Y_{01},Y_{11}$ 是三个非 $0$ 即 $1$ 的数，分别表示在两个输入端均为 $0$；两个输入端一个为 $0$ 另一个为 $1$；以及两个输入端均为 $1$ 的时候，该元件的输出。\n\n第 $n+2$ 到第 $n+17$ 行，表示需组成的集成电路的功能表，每行有 $8$ 个数，分别为 $0$ 或 $1$。其中，前四个数依次对应四个输入端（编号为 $1\\sim 4$）的信号，不存在两行的前四个数完全相同；而后面四个数则对应在各输入端信号为前四个数时，四个输出端依次应输出的信号。", "outputFormat": "第一行为一个单词，`Yes` 或 `No`，如果存在符合要求的设计方案，则为 `Yes`，否则为 `No`。\n\n如果第一行是 `No`，则输出结束。\n\n否则第二行只有一个非负整数 $p$，表示最少需要的门电路数目。下面 $p$ 行分别给出每个门电路在电路中的连接情况的描述。每行有四个以空格隔开的正整数：$S ,K, A, B$，其中 $S$ 表示该门电路的编号（所有用到的门电路按 $5\\sim p+4$ 编号，$1\\sim 4$ 的编号用来表示四个输入端）；$K$ 表示该元件的种类编号（按照输入文件中的顺序由 $1\\sim n$ 编号）；$A$ 和 $B$ 分别表示接入该元件的两个输入端的门电路或译码电路输入端的编号（其中，$A<S,B<S$）。\n\n最后一行有四个正整数，表示组成的译码电路的四个输出端分别所接的元件的编号（在 $1\\sim p+4$ 之间）。", "hint": "#### 样例解释\n样例对应的电路连接方式如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/za2oqzvt.png)", "locale": "zh-CN"}}}
{"pid": "P5778", "type": "P", "difficulty": 0, "samples": [["4 2\n60 -1\n70 -1\n80 45\n-1 65", "4\n3\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2001", "CTSC/CTS"], "title": "[CTSC2001] GPA 排名系统", "background": "", "description": "目前，高等院校往往采用 GPA *(Grade Point Average)* 来评价学生的学术表现。传统的排名方式是求每一个学生的平均成绩，以平均成绩作为依据进行排名。\n\n但是这样的排名方法已经引起了教育界以及社会各界人士的争议。因为它存在着许多弊端。对于不同的课程，选课学生的平均成绩会不同程度地受到课程的难易程度和老师的严厉程度的制约。因而这样的排名系统无形中就鼓励了学生选择一些比较容易的课程，因为这样可以事半功倍地获得较高的平均分。\n\n为了克服这些弊端，我们需要对排名系统做一定的改进。\n\n一种改进的方案是对选第 $i$ 门课的每一个学生的成绩加上一个特定的修正值 $d_i$，例如编号为 $j$ 的学生该课的成绩 $G_{ij}$ 修改为 $G’_{ij}=G_{ij}+d_i$。最终使得经过调整后，该课的平均分等于选该课的所有学生的所有课的平均分。对每一门课都做这样的调整，使得上述条件对所有课程都满足。这种调整方案一定程度地避免了传统排名系统的不公正。而你的任务正是根据一个大学某一个年级学生某学年的成绩，给出他们的排名。假设每一个学生都至少选一门课。", "inputFormat": "第一行是两个正整数 $m$ 和 $n$，分别表示学生人数和课程数目。\n\n接下来 $m$ 行是一个矩阵，矩阵中第 $i$ 行的第 $j$ 个元素表示第 $i$ 个学生第 $j$ 门课的成绩 $G_{ij}$。如果该学生没有选这门课，那么 $G_{ij}＝-1$。由于该方案的施行只是为了获得更加科学的排名，因此调整后的成绩的数值大小本身没有什么意义，因此调整后的成绩可以不是 $0\\sim 100$ 之间的数。", "outputFormat": "输出采用改进方案后这些学生的排名。以学生编号的形式输出，每行是一个学生的编号。\n\n如果在上述调整后，有若干学生平均分相等（精确到小数点后的三位），则他们的名次相同，按照字典序输出。\n\n当然许多时候，上述调整无法顺利进行，即调整的目标无法达到。（因此，在实际问题中，我们往往在最小二乘意义下获得一种最接近目标的调整方案。）也有可能或者因调整不唯一而不能确定学生的名次。若以上两种情况发生，则输出 `fail`。", "hint": "#### 样例解释\n一种可行的调整方法是：\n\n第一门课每一个学生的成绩加上 $10$，第二门课每一个学生的成绩加上 $35$。\n调整后的情况是：\n```plain\n70 –1\n80 –1\n90 80\n-1 100\n```\n调整后第一门课的平均分为：$(70＋80+90)/3=80$，选第一门课的所有学生的所有课的平均分为：$(70+80+90+80)/4=80$。\n\n第二门课的平均分为：$(80+100)/2=90$，选第二门课的所有学生的所有课的平均分为：$(90+80+100)/3=90$。\n\n然后，计算每一个学生的平均分并且排名，即得到了输出的结果。\n\n#### 数据范围\n对于全部数据，$1\\le m\\le 500$，$1\\le n\\le 100$，$-1\\le G_{ij}\\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2001] GPA Ranking System", "background": "", "description": "At present, universities and colleges often use GPA *(Grade Point Average)* to evaluate students’ academic performance. The traditional ranking method is to compute each student’s average score and rank students based on that average.\n\nHowever, this ranking method has caused controversy in education and in society, because it has many drawbacks. For different courses, the average score of enrolled students is affected to different degrees by the difficulty of the course and how strict the instructor is. Therefore, this ranking system indirectly encourages students to choose easier courses, because they can get a higher average score with less effort.\n\nTo overcome these drawbacks, we need to improve the ranking system.\n\nOne improved approach is to add a specific adjustment value $d_i$ to the score of every student who takes course $i$. For example, the score $G_{ij}$ of student $j$ in this course is changed to $G’_{ij}=G_{ij}+d_i$. The goal is that, after adjustment, the average score of this course equals the average of all courses taken by all students who take this course. Perform such an adjustment for every course so that the above condition holds for all courses. This adjustment method can reduce the unfairness of the traditional ranking system to some extent. Your task is to produce the ranking based on the scores of students in one grade of a university for one academic year. Assume that every student takes at least one course.", "inputFormat": "The first line contains two positive integers $m$ and $n$, representing the number of students and the number of courses.\n\nThe next $m$ lines form a matrix. The element in row $i$, column $j$ represents the score $G_{ij}$ of student $i$ in course $j$. If the student did not take this course, then $G_{ij}=-1$. Since this approach is only used to obtain a more scientific ranking, the absolute values of the adjusted scores themselves are not meaningful, so the adjusted scores do not have to be within $0\\sim 100$.", "outputFormat": "Output the ranking of these students under the improved approach. Output student indices, one per line.\n\nIf, after the adjustment, several students have the same average score (accurate to three digits after the decimal point), then they share the same rank, and they should be output in lexicographical order.\n\nOf course, in many cases, the adjustment above cannot be carried out successfully, meaning the target cannot be achieved. (Therefore, in real problems, we often find an adjustment scheme that is closest to the target in the least-squares sense.) It is also possible that the students’ ranks cannot be determined because the adjustment is not unique. If either of the above two situations occurs, output `fail`.", "hint": "#### Sample Explanation\n\nOne feasible adjustment method is:\n\nAdd $10$ to each student’s score in the first course, and add $35$ to each student’s score in the second course. The adjusted results are:\n```plain\n70 –1\n80 –1\n90 80\n-1 100\n```\nAfter adjustment, the average score of the first course is: $(70＋80+90)/3=80$. The average of all courses taken by all students who take the first course is: $(70+80+90+80)/4=80$.\n\nThe average score of the second course is: $(80+100)/2=90$. The average of all courses taken by all students who take the second course is: $(90+80+100)/3=90$.\n\nThen, compute each student’s average score and rank them, and you obtain the output result.\n\n#### Constraints\n\nFor all testdata, $1\\le m\\le 500$, $1\\le n\\le 100$, $-1\\le G_{ij}\\le 100$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2001] GPA 排名系统", "background": "", "description": "目前，高等院校往往采用 GPA *(Grade Point Average)* 来评价学生的学术表现。传统的排名方式是求每一个学生的平均成绩，以平均成绩作为依据进行排名。\n\n但是这样的排名方法已经引起了教育界以及社会各界人士的争议。因为它存在着许多弊端。对于不同的课程，选课学生的平均成绩会不同程度地受到课程的难易程度和老师的严厉程度的制约。因而这样的排名系统无形中就鼓励了学生选择一些比较容易的课程，因为这样可以事半功倍地获得较高的平均分。\n\n为了克服这些弊端，我们需要对排名系统做一定的改进。\n\n一种改进的方案是对选第 $i$ 门课的每一个学生的成绩加上一个特定的修正值 $d_i$，例如编号为 $j$ 的学生该课的成绩 $G_{ij}$ 修改为 $G’_{ij}=G_{ij}+d_i$。最终使得经过调整后，该课的平均分等于选该课的所有学生的所有课的平均分。对每一门课都做这样的调整，使得上述条件对所有课程都满足。这种调整方案一定程度地避免了传统排名系统的不公正。而你的任务正是根据一个大学某一个年级学生某学年的成绩，给出他们的排名。假设每一个学生都至少选一门课。", "inputFormat": "第一行是两个正整数 $m$ 和 $n$，分别表示学生人数和课程数目。\n\n接下来 $m$ 行是一个矩阵，矩阵中第 $i$ 行的第 $j$ 个元素表示第 $i$ 个学生第 $j$ 门课的成绩 $G_{ij}$。如果该学生没有选这门课，那么 $G_{ij}＝-1$。由于该方案的施行只是为了获得更加科学的排名，因此调整后的成绩的数值大小本身没有什么意义，因此调整后的成绩可以不是 $0\\sim 100$ 之间的数。", "outputFormat": "输出采用改进方案后这些学生的排名。以学生编号的形式输出，每行是一个学生的编号。\n\n如果在上述调整后，有若干学生平均分相等（精确到小数点后的三位），则他们的名次相同，按照字典序输出。\n\n当然许多时候，上述调整无法顺利进行，即调整的目标无法达到。（因此，在实际问题中，我们往往在最小二乘意义下获得一种最接近目标的调整方案。）也有可能或者因调整不唯一而不能确定学生的名次。若以上两种情况发生，则输出 `fail`。", "hint": "#### 样例解释\n一种可行的调整方法是：\n\n第一门课每一个学生的成绩加上 $10$，第二门课每一个学生的成绩加上 $35$。\n调整后的情况是：\n```plain\n70 –1\n80 –1\n90 80\n-1 100\n```\n调整后第一门课的平均分为：$(70＋80+90)/3=80$，选第一门课的所有学生的所有课的平均分为：$(70+80+90+80)/4=80$。\n\n第二门课的平均分为：$(80+100)/2=90$，选第二门课的所有学生的所有课的平均分为：$(90+80+100)/3=90$。\n\n然后，计算每一个学生的平均分并且排名，即得到了输出的结果。\n\n#### 数据范围\n对于全部数据，$1\\le m\\le 500$，$1\\le n\\le 100$，$-1\\le G_{ij}\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5779", "type": "P", "difficulty": 5, "samples": [["5 8\n3 2\n2 3\n-1 -1", "3\n2 8 6\n5 8 3\n6 8 2\n1\n1 1 2\n1\n2 3 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2001", "CTSC/CTS"], "title": "[CTSC2001] 聪明的学生", "background": "", "description": "一位教授逻辑学的教授有三名非常善于推理且精于心算的学生 A，B 和 C。有一天,教授给他们三人出了一道题：教授在每个人脑门上贴了一张纸条并告诉他们，每个人的纸条上都写了一个正整数，且某两个数的和等于第三个。于是，每个学生都能看见贴在另外两个同学头上的整数，但却看不见自己的数。\n\n这时，教授先对学生 A 发问了：「你能猜出自己的数吗？」A 回答：「不能。」\n\n教授又转身问学生 B：「你能猜出自己的数吗？」B 想了想，也回答：「不能。」\n\n教授再问学生 C 同样的问题，C 思考了片刻后，摇了摇头：「不能。」\n\n接着，教授又重新问 A 同样的问题，再问 B 和 C，……，经过若干轮的提问之后，当教授再次询问某人时，此人突然露出了得意的笑容，把贴在自己头上的那个数准确无误的报了出来。\n\n现在，如果告诉你：教授在第 $N$ 次提问时，轮到回答问题的那个人猜出了贴在自己头上的数是 $M$，你能推断出另外两个学生的头上贴的是什么数吗？\n\n#### 提示\n在没有人猜出自己头上的数之前，大家对教授提问的回答始终都是「不能」；而且除此之外在 A，B，C 之间是没有进行任何信息交流的。也就是说，每个人推断的依据仅仅是另外两个人的头上数，以及大家对教授的提问所做出的否定回答。\n\n教授总是从学生 A 开始提问的。\n\n你可以假定，这三个足够聪明的学生能够根据已知的条件在最早的轮次猜出自己的数，并且永远都不会猜错。\n\n稍经分析和推理，你将得出以下结论：**总是头上贴着最大的那个数的人最先猜出自己头上的数。**", "inputFormat": "输入包括若干组测试数据，其中的每一行代表一组测试数据。\n\n对于每组测试数据，由两个整数 $N$ 和 $M$ 组成，即在教授第 $N$ 次提问时，轮到回答问题的那个人猜出了贴在自己头上的数是 $M$。两个数之间用空格分隔开。\n\n最后，由 `-1 -1` 组成的一行标志着输入数据的结束。", "outputFormat": "按照输入中的顺序依次给出各组数据的结果。\n\n输出中对应每组数据的输出的第一行是一个整数 $p$，是可能情况的总数。接下来的 $p$ 行，每一行包括三个数，分别为贴在 A，B，C 头上的三个数。输出时，所有解按照 A 头上的数增序排列；在 A 头上的数相同的情况下，按照 B 头上的数增序排列。", "hint": "对于全部数据，$N<500$，$M<3\\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2001] Clever Students", "background": "", "description": "A professor who teaches logic has three students, A, B, and C, who are very good at reasoning and quick mental arithmetic. One day, the professor gives them a problem: he sticks a note on each person’s forehead and tells them that each note has a positive integer, and that the sum of two of the numbers equals the third. Therefore, each student can see the integers on the other two students’ foreheads, but cannot see their own number.\n\nThe professor first asks student A: “Can you guess your number?” A answers: “No.”\n\nThe professor then asks student B: “Can you guess your number?” B thinks for a while and also answers: “No.”\n\nThe professor asks student C the same question. After thinking for a moment, C shakes his head and answers: “No.”\n\nNext, the professor asks A the same question again, then asks B and C, and so on. After several rounds of questioning, when the professor asks someone again, that person suddenly smiles proudly and reports the exact number on their own forehead.\n\nNow, if you are told that: at the professor’s $N$-th question, the person whose turn it was guessed that the number on their forehead was $M$, can you infer what numbers are on the other two students’ foreheads?\n\n#### Hint\nBefore anyone guesses their own number, everyone’s answers to the professor’s questions are always “No.” Also, other than this, there is no information exchange among A, B, and C. That is, each person’s reasoning is based only on the numbers on the other two foreheads, and the negative answers everyone has given to the professor’s questions.\n\nThe professor always starts questioning from student A.\n\nYou may assume that these three sufficiently smart students can determine their own number at the earliest possible round based on the known conditions, and they will never be wrong.\n\nWith some analysis and reasoning, you will get the following conclusion: **the person with the largest number on their forehead always guesses their own number first.**", "inputFormat": "The input consists of multiple sets of testdata, where each line represents one set of testdata.\n\nFor each set of testdata, there are two integers $N$ and $M$, meaning that at the professor’s $N$-th question, the person whose turn it was guessed that the number on their forehead was $M$. The two numbers are separated by a space.\n\nThe input ends with a line `-1 -1`.", "outputFormat": "Output the results for each set of data in the order they appear in the input.\n\nFor each set of data, the first line of the output is an integer $p$, the total number of possible cases. The next $p$ lines each contain three numbers, which are the numbers on the foreheads of A, B, and C. All solutions should be output in increasing order of A’s number; if A’s numbers are the same, then sort by increasing order of B’s number.", "hint": "Before anyone guesses their own number, everyone’s answers to the professor’s questions are always “No.” Also, other than this, there is no information exchange among A, B, and C. That is, each person’s reasoning is based only on the numbers on the other two foreheads, and the negative answers everyone has given to the professor’s questions.\n\nThe professor always starts questioning from student A.\n\nYou may assume that these three sufficiently smart students can determine their own number at the earliest possible round based on the known conditions, and they will never be wrong.\n\nWith some analysis and reasoning, you will get the following conclusion: **the person with the largest number on their forehead always guesses their own number first.**\n\n# Input Format\n\nThe input consists of multiple sets of testdata, where each line represents one set of testdata.\n\nFor each set of testdata, there are two integers $N$ and $M$, meaning that at the professor’s $N$-th question, the person whose turn it was guessed that the number on their forehead was $M$. The two numbers are separated by a space.\n\nThe input ends with a line `-1 -1`.\n\n# Output Format\n\nOutput the results for each set of data in the order they appear in the input.\n\nFor each set of data, the first line of the output is an integer $p$, the total number of possible cases. The next $p$ lines each contain three numbers, which are the numbers on the foreheads of A, B, and C. All solutions should be output in increasing order of A’s number; if A’s numbers are the same, then sort by increasing order of B’s number.\n\n# Hint\n\nFor all data, $N<500$, $M<3\\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2001] 聪明的学生", "background": "", "description": "一位教授逻辑学的教授有三名非常善于推理且精于心算的学生 A，B 和 C。有一天,教授给他们三人出了一道题：教授在每个人脑门上贴了一张纸条并告诉他们，每个人的纸条上都写了一个正整数，且某两个数的和等于第三个。于是，每个学生都能看见贴在另外两个同学头上的整数，但却看不见自己的数。\n\n这时，教授先对学生 A 发问了：「你能猜出自己的数吗？」A 回答：「不能。」\n\n教授又转身问学生 B：「你能猜出自己的数吗？」B 想了想，也回答：「不能。」\n\n教授再问学生 C 同样的问题，C 思考了片刻后，摇了摇头：「不能。」\n\n接着，教授又重新问 A 同样的问题，再问 B 和 C，……，经过若干轮的提问之后，当教授再次询问某人时，此人突然露出了得意的笑容，把贴在自己头上的那个数准确无误的报了出来。\n\n现在，如果告诉你：教授在第 $N$ 次提问时，轮到回答问题的那个人猜出了贴在自己头上的数是 $M$，你能推断出另外两个学生的头上贴的是什么数吗？\n\n#### 提示\n在没有人猜出自己头上的数之前，大家对教授提问的回答始终都是「不能」；而且除此之外在 A，B，C 之间是没有进行任何信息交流的。也就是说，每个人推断的依据仅仅是另外两个人的头上数，以及大家对教授的提问所做出的否定回答。\n\n教授总是从学生 A 开始提问的。\n\n你可以假定，这三个足够聪明的学生能够根据已知的条件在最早的轮次猜出自己的数，并且永远都不会猜错。\n\n稍经分析和推理，你将得出以下结论：**总是头上贴着最大的那个数的人最先猜出自己头上的数。**", "inputFormat": "输入包括若干组测试数据，其中的每一行代表一组测试数据。\n\n对于每组测试数据，由两个整数 $N$ 和 $M$ 组成，即在教授第 $N$ 次提问时，轮到回答问题的那个人猜出了贴在自己头上的数是 $M$。两个数之间用空格分隔开。\n\n最后，由 `-1 -1` 组成的一行标志着输入数据的结束。", "outputFormat": "按照输入中的顺序依次给出各组数据的结果。\n\n输出中对应每组数据的输出的第一行是一个整数 $p$，是可能情况的总数。接下来的 $p$ 行，每一行包括三个数，分别为贴在 A，B，C 头上的三个数。输出时，所有解按照 A 头上的数增序排列；在 A 头上的数相同的情况下，按照 B 头上的数增序排列。", "hint": "对于全部数据，$N<500$，$M<3\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5780", "type": "P", "difficulty": 6, "samples": [["4 3 2\n", "4 2 1 3\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "Special Judge", "O2优化", "CTSC/CTS"], "title": "[CTSC2011] 排列", "background": "", "description": "沫沫很喜欢找规律填数字，譬如 $1,4,7,( ),\\cdots$，相邻的数相差为 $3$，括号中的数应为 $10$；又如 $3,6,12,( ),\\cdots$，每个数是前一个数的两倍，括号中的数应为 $24$。\n\n由于常年玩这种游戏，沫沫厌倦了等差数列与等比数列。当看到数列 $1,2,\\cdots,n$ 时，她想尽量小的改变其顺序使得不存在公差为 $A$ 或者公比为 $B$ 的子列。\n\n具体地，给定整数 $n,A,B$，求一个 $1$ 到 $n$ 的排列 $P = (P_1,P_2,\\cdots,P_n)$，满足 $\\forall i,j \\in \\{1,2,\\cdots,n \\}$，若 $i<j$ 且 $P_i<P_j$，则 $P_j \\neq P_i+A$ 且 $P_j \\neq P_i \\times B$。排列 $P$ 保留原有顺序的程度 $S$ 定义为：\n\n$$S = \\sum\\limits_{1 \\le i \\le j \\le n , P_i<P_j} (P_j-P_i)$$\n\n请你在满足前述要求的前提下，使得 $S$ 的值尽量大。", "inputFormat": "第一行包含三个正整数 $n,A,B$，意义如前所述。相邻的数之间用一个空格隔开。", "outputFormat": "第一行包含 $n$ 个整数，为你求得的排列 $P$，相邻的数之间用空格隔开。", "hint": "**样例说明**\n\n该排列对应的 $S = 3$，是 $n=4,A=3,B=2$ 时能取到的最大的 $S$。\n\n------\n\n**评分方式**\n\n每个测试点单独评分。\n\n对于每一个测试点，如果你的输出不合法，如文件格式错误、输出的解不符合要求等，该测试点得 $0$ 分。\n\n否则设你输出的排列对应 $S$ 值为 $a$，我们提供的排列对应 $S$ 值为 $b$，你在该测试点的得分如下：\n\n- 如果 $a \\le b$，得 $10$ 分；\n- 否则得分为：\n\n$\\max \\{ [10 \\times ( \\exp (\\frac{a}{b}-2)],1 \\}$\n\n------\n\n**数据规模**\n\n\n总共 $10$ 个测试点，数据范围满足：\n\n| 测试点编号 |   $n$    |        $A$        |   $B$   |\n| :--------: | :------: | :---------------: | :-----: |\n|    $1$     | $\\le 30$ |      $\\le n$      | $\\le n$ |\n|    $2$     | $\\le 60$ | $A\\bmod B\\not =0$ | $\\ge 4$ |\n|    $3$     | $\\le 70$ | $A\\bmod B\\not =0$ | $\\ge 5$ |\n|    $4$     | $\\le 80$ | $A\\bmod B\\not =0$ | $\\ge 6$ |\n|    $5$     | $\\le 90$ | $A\\bmod B\\not =0$ | $\\ge 7$ |\n|    $6$     | $\\le 90$ |      $\\le n$      |  $=1$   |\n|   $7,8$    | $\\le 90$ |      $\\le 5$      | $\\le n$ |\n|    $9$     |  $=60$   |       $=21$       |  $=3$   |\n|    $10$    |  $=90$   |       $=18$       |  $=2$   |\n\n在所有输入数据中，$A$ 与 $B$ 均为不超过 $n$ 的正整数。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2011] Permutation", "background": "", "description": "Momo really likes finding patterns and filling in numbers. For example, $1,4,7,( ),\\cdots$: the difference between adjacent numbers is $3$, so the number in the parentheses should be $10$. Another example is $3,6,12,( ),\\cdots$: each number is twice the previous one, so the number in the parentheses should be $24$.\n\nAfter playing this kind of game for many years, Momo got tired of arithmetic sequences and geometric sequences. When she sees the sequence $1,2,\\cdots,n$, she wants to change its order as little as possible so that there is no subsequence with common difference $A$ or common ratio $B$.\n\nMore specifically, given integers $n,A,B$, find a permutation $P=(P_1,P_2,\\cdots,P_n)$ of $1$ to $n$ such that $\\forall i,j \\in \\{1,2,\\cdots,n\\}$, if $i<j$ and $P_i<P_j$, then $P_j \\neq P_i+A$ and $P_j \\neq P_i \\times B$. The degree to which the permutation $P$ keeps the original order is defined as $S$:\n\n$$S = \\sum\\limits_{1 \\le i \\le j \\le n , P_i<P_j} (P_j-P_i)$$\n\nUnder the above constraints, please make the value of $S$ as large as possible.", "inputFormat": "The first line contains three positive integers $n,A,B$, with meanings as described above. Adjacent numbers are separated by one space.", "outputFormat": "The first line contains $n$ integers, the permutation $P$ you found. Adjacent numbers are separated by spaces.", "hint": "**Sample Explanation**\n\nFor this permutation, $S = 3$, which is the maximum possible $S$ when $n=4,A=3,B=2$.\n\n------\n\n**Scoring**\n\nEach test point is scored independently.\n\nFor each test point, if your output is invalid, such as wrong file format, or the output solution does not satisfy the requirements, then you get $0$ points for that test point.\n\nOtherwise, let the $S$ value of your permutation be $a$, and the $S$ value of the permutation we provide be $b$. Your score for that test point is:\n\n- If $a \\le b$, you get $10$ points.\n- Otherwise, the score is:\n\n$\\max \\{ [10 \\times ( \\exp (\\frac{a}{b}-2)],1 \\}$\n\n------\n\n**Constraints**\n\nThere are $10$ test points in total. The constraints are:\n\n| Test Point ID |   $n$    |        $A$        |   $B$   |\n| :-----------: | :------: | :---------------: | :-----: |\n|     $1$      | $\\le 30$ |      $\\le n$      | $\\le n$ |\n|     $2$      | $\\le 60$ | $A\\bmod B\\not =0$ | $\\ge 4$ |\n|     $3$      | $\\le 70$ | $A\\bmod B\\not =0$ | $\\ge 5$ |\n|     $4$      | $\\le 80$ | $A\\bmod B\\not =0$ | $\\ge 6$ |\n|     $5$      | $\\le 90$ | $A\\bmod B\\not =0$ | $\\ge 7$ |\n|     $6$      | $\\le 90$ |      $\\le n$      |  $=1$   |\n|    $7,8$     | $\\le 90$ |      $\\le 5$      | $\\le n$ |\n|     $9$      |  $=60$   |       $=21$       |  $=3$   |\n|     $10$     |  $=90$   |       $=18$       |  $=2$   |\n\nIn all input data, both $A$ and $B$ are positive integers not exceeding $n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2011] 排列", "background": "", "description": "沫沫很喜欢找规律填数字，譬如 $1,4,7,( ),\\cdots$，相邻的数相差为 $3$，括号中的数应为 $10$；又如 $3,6,12,( ),\\cdots$，每个数是前一个数的两倍，括号中的数应为 $24$。\n\n由于常年玩这种游戏，沫沫厌倦了等差数列与等比数列。当看到数列 $1,2,\\cdots,n$ 时，她想尽量小的改变其顺序使得不存在公差为 $A$ 或者公比为 $B$ 的子列。\n\n具体地，给定整数 $n,A,B$，求一个 $1$ 到 $n$ 的排列 $P = (P_1,P_2,\\cdots,P_n)$，满足 $\\forall i,j \\in \\{1,2,\\cdots,n \\}$，若 $i<j$ 且 $P_i<P_j$，则 $P_j \\neq P_i+A$ 且 $P_j \\neq P_i \\times B$。排列 $P$ 保留原有顺序的程度 $S$ 定义为：\n\n$$S = \\sum\\limits_{1 \\le i \\le j \\le n , P_i<P_j} (P_j-P_i)$$\n\n请你在满足前述要求的前提下，使得 $S$ 的值尽量大。", "inputFormat": "第一行包含三个正整数 $n,A,B$，意义如前所述。相邻的数之间用一个空格隔开。", "outputFormat": "第一行包含 $n$ 个整数，为你求得的排列 $P$，相邻的数之间用空格隔开。", "hint": "**样例说明**\n\n该排列对应的 $S = 3$，是 $n=4,A=3,B=2$ 时能取到的最大的 $S$。\n\n------\n\n**评分方式**\n\n每个测试点单独评分。\n\n对于每一个测试点，如果你的输出不合法，如文件格式错误、输出的解不符合要求等，该测试点得 $0$ 分。\n\n否则设你输出的排列对应 $S$ 值为 $a$，我们提供的排列对应 $S$ 值为 $b$，你在该测试点的得分如下：\n\n- 如果 $a \\le b$，得 $10$ 分；\n- 否则得分为：\n\n$\\max \\{ [10 \\times ( \\exp (\\frac{a}{b}-2)],1 \\}$\n\n------\n\n**数据规模**\n\n\n总共 $10$ 个测试点，数据范围满足：\n\n| 测试点编号 |   $n$    |        $A$        |   $B$   |\n| :--------: | :------: | :---------------: | :-----: |\n|    $1$     | $\\le 30$ |      $\\le n$      | $\\le n$ |\n|    $2$     | $\\le 60$ | $A\\bmod B\\not =0$ | $\\ge 4$ |\n|    $3$     | $\\le 70$ | $A\\bmod B\\not =0$ | $\\ge 5$ |\n|    $4$     | $\\le 80$ | $A\\bmod B\\not =0$ | $\\ge 6$ |\n|    $5$     | $\\le 90$ | $A\\bmod B\\not =0$ | $\\ge 7$ |\n|    $6$     | $\\le 90$ |      $\\le n$      |  $=1$   |\n|   $7,8$    | $\\le 90$ |      $\\le 5$      | $\\le n$ |\n|    $9$     |  $=60$   |       $=21$       |  $=3$   |\n|    $10$    |  $=90$   |       $=18$       |  $=2$   |\n\n在所有输入数据中，$A$ 与 $B$ 均为不超过 $n$ 的正整数。", "locale": "zh-CN"}}}
{"pid": "P5781", "type": "P", "difficulty": 6, "samples": [["6 5\n4 8 7 5 6\n7 4 10 3 5\n9 7 20 14 2\n9 14 7 3 6\n5 7 5 2 7\n4 5 13 5 6\n", "6\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2019", "IOI", "O2优化"], "title": "[IOI 2019] 矩形区域", "background": null, "description": "19 世纪初，统治者下令在俯瞰美丽河景的高原上建造一座宫殿。这块高原被看做是一个由正方形单元格组成的 $n \\times m$ 网格。网格的行从 $0$ 到 $n-1$ 编号，列从 $0$ 到 $m-1$ 编号。第 $i$ 行第 $j$ 列（$0 \\le i \\le n-1$，$0 \\le j \\le m-1$）的单元格记为单元格 $(i,j)$。每个单元格 $(i,j)$ 有特定的海拔高度，记为 $a_{i,j}$。\n\n统治者指示他的建筑师选择一个矩形区域来建造宫殿。该区域不能包含网格边界（第 $0$ 行，第 $n-1$ 行，第 $0$ 列，以及第 $m-1$ 列）上的任何单元格。为此，建筑师应选出四个整数 $r_1$，$r_2$，$c_1$ 和 $c_2$（$1 \\le r_1 \\le r_2 \\le n-2$ 且 $1 \\le c_1 \\le c_2 \\le m-2$)，对应于包括所有满足 $r_1 \\le i \\le r_2$ 且 $c_1 \\le j \\le c_2$ 的单元格 $(i,j)$ 的矩形区域。\n\n此外，一个区域被认为是合法的，当且仅当对于该区域中的每个单元格 $(i,j)$，以下条件成立：对于与该区域相邻的、位于第 $i$ 行的两个单元格（单元格 $(i,c_1-1)$ 和 $(i,c_2+1)$），以及与该区域相邻的、位于第 $j$ 列的两个单元格（单元格 $(r_1-1,j)$ 和 $(r_2+1,j)$），单元格 $(i,j)$ 的海拔高度必须严格小于这四个单元格的海拔高度。\n\n你的任务是帮助建筑师统计可建宫殿的合法区域的数量（也就是所对应区域为合法的 $r_1$，$r_2$，$c_1$ 和 $c_2$ 的数量）。", "inputFormat": "第一行，两个整数 $n$ 和 $m$，表示网格的长和宽。\n\n接下来 $n$ 行，第 $i$ 行 $m$ 个整数，为 $a_{i-1,0\\dots m-1}$。", "outputFormat": "一行，一个整数，表示合法区域的数量。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p7kwnpod.png)\n\n一共有 $6$ 个合法区域，分别为：\n- $r_1=r_2=1, c_1=c_2=1$\n- $r_1=1, r_2=2, c_1=c_2=1$\n- $r_1=r_2=1, c_1=c_2=3$\n- $r_1=r_2=4, c_1=2,c_2=3$\n- $r_1=r_2=4, c_1=c_2=3$\n- $r_1=3,r_2=4,c_1=c_2=3$\n\n例如，$r_1=1, r_2=2, c_1=c_2=1$ 对应一个合法区域，原因是以下两个条件都成立：\n- $a_{1,1}=4$ 严格小于 $a_{0,1}=8$，$a_{3,1}=14$，$a_{1,0}=7$，和 $a_{1,2}=10$。\n- $a_{2,1}=7$ 严格小于 $a_{0,1}=8$，$a_{3,1}=14$，$a_{2,0}=9$，和 $a_{2,2}=20$。\n\n**数据范围**\n\n对于所有数据：\n- $1 \\le n, m \\le 2500$。\n- $0 \\le a_{i,j} \\le 7 \\times 10^6 (0 \\le i \\le n - 1, 0 \\le j \\le m - 1)$。\n\n详细子任务附加限制与分值如下表：\n\n|子任务编号|附加限制|分值|\n|:-:|:-:|:-:|\n|$1$|$n, m \\le 30$|$8$|\n|$2$|$n, m \\le 80$|$7$|\n|$3$|$n, m \\le 200$|$12$|\n|$4$|$n, m \\le 700$|$22$|\n|$5$|$n \\le 3$|$10$|\n|$6$|$0 \\le a_{i,j} \\le 1$|$13$|\n|$7$|没有任何附加限制|$28$|", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2019] Rectangular Regions", "background": "", "description": "In the early 19th century, a ruler ordered a palace to be built on a plateau overlooking a beautiful river view. The plateau can be seen as an $n \\times m$ grid made of square cells. The rows of the grid are numbered from $0$ to $n-1$, and the columns from $0$ to $m-1$. The cell in row $i$ and column $j$ ($0 \\le i \\le n-1$, $0 \\le j \\le m-1$) is denoted as cell $(i,j)$. Each cell $(i,j)$ has a specific elevation, denoted as $a_{i,j}$.\n\nThe ruler instructed his architect to choose a rectangular region to build the palace. This region cannot include any cells on the boundary of the grid (row $0$, row $n-1$, column $0$, and column $m-1$). To do this, the architect should choose four integers $r_1$, $r_2$, $c_1$, and $c_2$ ($1 \\le r_1 \\le r_2 \\le n-2$ and $1 \\le c_1 \\le c_2 \\le m-2$), corresponding to the rectangular region that includes all cells $(i,j)$ satisfying $r_1 \\le i \\le r_2$ and $c_1 \\le j \\le c_2$.\n\nIn addition, a region is considered valid if and only if, for every cell $(i,j)$ inside the region, the following condition holds: among the two cells adjacent to the region in row $i$ (cells $(i,c_1-1)$ and $(i,c_2+1)$), and the two cells adjacent to the region in column $j$ (cells $(r_1-1,j)$ and $(r_2+1,j)$), the elevation of cell $(i,j)$ must be strictly less than the elevations of all these four cells.\n\nYour task is to help the architect count the number of valid regions where the palace can be built (that is, the number of choices of $r_1$, $r_2$, $c_1$, and $c_2$ whose corresponding region is valid).", "inputFormat": "The first line contains two integers $n$ and $m$, representing the grid's height and width.\n\nThe next $n$ lines each contain $m$ integers, which are $a_{i-1,0\\dots m-1}$.", "outputFormat": "One line with one integer, representing the number of valid regions.", "hint": "**Sample Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p7kwnpod.png)\n\nThere are $6$ valid regions in total:\n- $r_1=r_2=1, c_1=c_2=1$\n- $r_1=1, r_2=2, c_1=c_2=1$\n- $r_1=r_2=1, c_1=c_2=3$\n- $r_1=r_2=4, c_1=2,c_2=3$\n- $r_1=r_2=4, c_1=c_2=3$\n- $r_1=3,r_2=4,c_1=c_2=3$\n\nFor example, $r_1=1, r_2=2, c_1=c_2=1$ corresponds to a valid region because both of the following conditions hold:\n- $a_{1,1}=4$ is strictly less than $a_{0,1}=8$, $a_{3,1}=14$, $a_{1,0}=7$, and $a_{1,2}=10$.\n- $a_{2,1}=7$ is strictly less than $a_{0,1}=8$, $a_{3,1}=14$, $a_{2,0}=9$, and $a_{2,2}=20$.\n\n**Constraints**\n\nFor all testdata:\n- $1 \\le n, m \\le 2500$.\n- $0 \\le a_{i,j} \\le 7 \\times 10^6 (0 \\le i \\le n - 1, 0 \\le j \\le m - 1)$.\n\nThe detailed additional constraints and scores for subtasks are shown in the table below:\n\n|Subtask ID|Additional Constraints|Score|\n|:-:|:-:|:-:|\n|$1$|$n, m \\le 30$|$8$|\n|$2$|$n, m \\le 80$|$7$|\n|$3$|$n, m \\le 200$|$12$|\n|$4$|$n, m \\le 700$|$22$|\n|$5$|$n \\le 3$|$10$|\n|$6$|$0 \\le a_{i,j} \\le 1$|$13$|\n|$7$|No additional constraints|$28$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2019] 矩形区域", "background": null, "description": "19 世纪初，统治者下令在俯瞰美丽河景的高原上建造一座宫殿。这块高原被看做是一个由正方形单元格组成的 $n \\times m$ 网格。网格的行从 $0$ 到 $n-1$ 编号，列从 $0$ 到 $m-1$ 编号。第 $i$ 行第 $j$ 列（$0 \\le i \\le n-1$，$0 \\le j \\le m-1$）的单元格记为单元格 $(i,j)$。每个单元格 $(i,j)$ 有特定的海拔高度，记为 $a_{i,j}$。\n\n统治者指示他的建筑师选择一个矩形区域来建造宫殿。该区域不能包含网格边界（第 $0$ 行，第 $n-1$ 行，第 $0$ 列，以及第 $m-1$ 列）上的任何单元格。为此，建筑师应选出四个整数 $r_1$，$r_2$，$c_1$ 和 $c_2$（$1 \\le r_1 \\le r_2 \\le n-2$ 且 $1 \\le c_1 \\le c_2 \\le m-2$)，对应于包括所有满足 $r_1 \\le i \\le r_2$ 且 $c_1 \\le j \\le c_2$ 的单元格 $(i,j)$ 的矩形区域。\n\n此外，一个区域被认为是合法的，当且仅当对于该区域中的每个单元格 $(i,j)$，以下条件成立：对于与该区域相邻的、位于第 $i$ 行的两个单元格（单元格 $(i,c_1-1)$ 和 $(i,c_2+1)$），以及与该区域相邻的、位于第 $j$ 列的两个单元格（单元格 $(r_1-1,j)$ 和 $(r_2+1,j)$），单元格 $(i,j)$ 的海拔高度必须严格小于这四个单元格的海拔高度。\n\n你的任务是帮助建筑师统计可建宫殿的合法区域的数量（也就是所对应区域为合法的 $r_1$，$r_2$，$c_1$ 和 $c_2$ 的数量）。", "inputFormat": "第一行，两个整数 $n$ 和 $m$，表示网格的长和宽。\n\n接下来 $n$ 行，第 $i$ 行 $m$ 个整数，为 $a_{i-1,0\\dots m-1}$。", "outputFormat": "一行，一个整数，表示合法区域的数量。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p7kwnpod.png)\n\n一共有 $6$ 个合法区域，分别为：\n- $r_1=r_2=1, c_1=c_2=1$\n- $r_1=1, r_2=2, c_1=c_2=1$\n- $r_1=r_2=1, c_1=c_2=3$\n- $r_1=r_2=4, c_1=2,c_2=3$\n- $r_1=r_2=4, c_1=c_2=3$\n- $r_1=3,r_2=4,c_1=c_2=3$\n\n例如，$r_1=1, r_2=2, c_1=c_2=1$ 对应一个合法区域，原因是以下两个条件都成立：\n- $a_{1,1}=4$ 严格小于 $a_{0,1}=8$，$a_{3,1}=14$，$a_{1,0}=7$，和 $a_{1,2}=10$。\n- $a_{2,1}=7$ 严格小于 $a_{0,1}=8$，$a_{3,1}=14$，$a_{2,0}=9$，和 $a_{2,2}=20$。\n\n**数据范围**\n\n对于所有数据：\n- $1 \\le n, m \\le 2500$。\n- $0 \\le a_{i,j} \\le 7 \\times 10^6 (0 \\le i \\le n - 1, 0 \\le j \\le m - 1)$。\n\n详细子任务附加限制与分值如下表：\n\n|子任务编号|附加限制|分值|\n|:-:|:-:|:-:|\n|$1$|$n, m \\le 30$|$8$|\n|$2$|$n, m \\le 80$|$7$|\n|$3$|$n, m \\le 200$|$12$|\n|$4$|$n, m \\le 700$|$22$|\n|$5$|$n \\le 3$|$10$|\n|$6$|$0 \\le a_{i,j} \\le 1$|$13$|\n|$7$|没有任何附加限制|$28$|", "locale": "zh-CN"}}}
{"pid": "P5782", "type": "P", "difficulty": 5, "samples": [["3 2\n1 3\n2 4\n", "1\n4\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2001", "POI（波兰）", "Special Judge", "2-SAT"], "title": "[POI 2001] 和平委员会", "background": "", "description": "根据宪法，Byteland 民主共和国的公众和平委员会应该在国会中通过立法程序来创立。 不幸的是，由于某些党派代表之间的不和睦而使得这件事存在障碍。 此委员会必须满足下列条件：\n\n- 每个党派都在委员会中恰有 $1$ 个代表。\n- 如果 $2$ 个代表彼此厌恶，则他们不能都属于委员会。\n\n每个党在议会中有 $2$ 个代表。代表从 $1$ 编号到 $2n$。 编号为 $2i-1$ 和   $2i$ 的代表属于第 $i$ 个党派。 \n\n任务：写一程序读入党派的数量和关系不友好的代表对，计算决定建立和平委员会是否可能，若行，则列出委员会的成员表。", "inputFormat": "第一行有两个非负整数 $n,m$。他们各自表示：党派的数量 $n$ 和不友好的代表对 $m$。\n\n接下来 $m$ 行，每行为一对整数 $a,b$，表示代表 $a$ 和 $b$ 互相厌恶。", "outputFormat": "如果不能创立委员会，则输出信息 `NIE`。\n\n若能够成立，则输出包括 $n$ 个从区间 $1$ 到 $2n$ 选出的整数，按升序写出，每行一个，这些数字为委员会中代表的编号。\n\n如果委员会能以多种方法形成，程序可以只输出它们的某一个。", "hint": "对于 $42\\%$ 的数据，$1 \\leq n \\leq 100$。\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 1000$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 8000$，$0 \\leq m \\leq 20000$，$1 \\leq a < b \\leq 8000$。", "locale": "zh-CN", "translations": {"en": {"title": "[POI 2001] Peace Committee", "background": "", "description": "According to the constitution, the Public Peace Committee of the Democratic Republic of Byteland should be established by a legislative procedure in the parliament. Unfortunately, conflicts between representatives of some parties make this difficult. The committee must satisfy the following conditions:\n\n- Each party has exactly $1$ representative in the committee.\n- If two representatives hate each other, then they cannot both be in the committee.\n\nEach party has $2$ representatives in the parliament. The representatives are numbered from $1$ to $2n$. Representatives numbered $2i-1$ and $2i$ belong to the $i$-th party.\n\nTask: Write a program that reads the number of parties and the pairs of representatives who are unfriendly to each other, determines whether it is possible to establish the Peace Committee, and if so, outputs the list of its members.", "inputFormat": "The first line contains two non-negative integers $n, m$. They represent the number of parties $n$ and the number of unfriendly representative pairs $m$, respectively.\n\nThe next $m$ lines each contain a pair of integers $a, b$, meaning that representatives $a$ and $b$ hate each other.", "outputFormat": "If it is impossible to establish the committee, output `NIE`.\n\nIf it is possible, output $n$ integers chosen from the range $1$ to $2n$, in increasing order, one per line. These numbers are the IDs of the representatives in the committee.\n\nIf the committee can be formed in multiple ways, your program may output any one of them.", "hint": "For $42\\%$ of the testdata, $1 \\leq n \\leq 100$.\n\nFor $70\\%$ of the testdata, $1 \\leq n \\leq 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 8000$, $0 \\leq m \\leq 20000$, $1 \\leq a < b \\leq 8000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[POI 2001] 和平委员会", "background": "", "description": "根据宪法，Byteland 民主共和国的公众和平委员会应该在国会中通过立法程序来创立。 不幸的是，由于某些党派代表之间的不和睦而使得这件事存在障碍。 此委员会必须满足下列条件：\n\n- 每个党派都在委员会中恰有 $1$ 个代表。\n- 如果 $2$ 个代表彼此厌恶，则他们不能都属于委员会。\n\n每个党在议会中有 $2$ 个代表。代表从 $1$ 编号到 $2n$。 编号为 $2i-1$ 和   $2i$ 的代表属于第 $i$ 个党派。 \n\n任务：写一程序读入党派的数量和关系不友好的代表对，计算决定建立和平委员会是否可能，若行，则列出委员会的成员表。", "inputFormat": "第一行有两个非负整数 $n,m$。他们各自表示：党派的数量 $n$ 和不友好的代表对 $m$。\n\n接下来 $m$ 行，每行为一对整数 $a,b$，表示代表 $a$ 和 $b$ 互相厌恶。", "outputFormat": "如果不能创立委员会，则输出信息 `NIE`。\n\n若能够成立，则输出包括 $n$ 个从区间 $1$ 到 $2n$ 选出的整数，按升序写出，每行一个，这些数字为委员会中代表的编号。\n\n如果委员会能以多种方法形成，程序可以只输出它们的某一个。", "hint": "对于 $42\\%$ 的数据，$1 \\leq n \\leq 100$。\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 1000$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 8000$，$0 \\leq m \\leq 20000$，$1 \\leq a < b \\leq 8000$。", "locale": "zh-CN"}}}
{"pid": "P5783", "type": "P", "difficulty": 5, "samples": [["3 5\n1 2 4\nQ 1\nQ 2\nC 1\nQ 1\nQ 2", "1\n1\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "重庆", "线段树", "各省省选", "位运算"], "title": "[CQOI2008] 位统计", "background": "", "description": "给出 $N$ 个 $[0, 65535]$ 的整数，编程支持以下操作：\n\n\n修改操作：```C d```，所有数增加 $d$。如果超过 $65535$，把结果模 $65536$。（$0\\le d\\le 65535$）\n\n查询操作：```Q i```，统计有多少整数的第 $i$ 位非 $0$，换句话说，有多少个整数与 $2^i$ 的“按位与”操作值为正。（$0\\le i\\le 15$）\n\n输出所有查询操作的统计值。", "inputFormat": "第一行为两个正整数 $N$ 和 $M$，即整数的个数和操作的个数。\n\n第二行包含 $N$ 个 $[0,65535]$ 的整数。\n\n以下 $M$ 行为各操作，格式如题所述。", "outputFormat": "输出所有 $Q$ 操作的统计值。", "hint": "| 测试点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $N$ | $3$ | $10$ | $100$ | $1000$ | $10000$ | $20000$ | $50000$ | $100000$ | $100000$ | $100000$ |\n| $M$ | $3$ | $10$ | $100$ | $1000$ | $10000$ | $20000$ | $50000$ | $50000$ | $100000$ | $200000$ |\n", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2008] Bit Statistics", "background": "", "description": "Given $N$ integers in $[0, 65535]$, write a program that supports the following operations:\n\nModification operation: ```C d```, add $d$ to every number. If the result exceeds $65535$, take the result modulo $65536$. ($0 \\le d \\le 65535$)\n\nQuery operation: ```Q i```, count how many integers have a nonzero $i$-th bit. In other words, count how many integers have a positive result when applying the bitwise AND with $2^i$. ($0 \\le i \\le 15$)\n\nOutput the counts for all query operations.", "inputFormat": "The first line contains two positive integers $N$ and $M$, which are the number of integers and the number of operations.\n\nThe second line contains $N$ integers in $[0, 65535]$.\n\nThe next $M$ lines each contain one operation, in the format described above.", "outputFormat": "Output the count for every ```Q``` operation.", "hint": "## Constraints\n\n| Test Point ID | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $N$ | $3$ | $10$ | $100$ | $1000$ | $10000$ | $20000$ | $50000$ | $100000$ | $100000$ | $100000$ |\n| $M$ | $3$ | $10$ | $100$ | $1000$ | $10000$ | $20000$ | $50000$ | $50000$ | $100000$ | $200000$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2008] 位统计", "background": "", "description": "给出 $N$ 个 $[0, 65535]$ 的整数，编程支持以下操作：\n\n\n修改操作：```C d```，所有数增加 $d$。如果超过 $65535$，把结果模 $65536$。（$0\\le d\\le 65535$）\n\n查询操作：```Q i```，统计有多少整数的第 $i$ 位非 $0$，换句话说，有多少个整数与 $2^i$ 的“按位与”操作值为正。（$0\\le i\\le 15$）\n\n输出所有查询操作的统计值。", "inputFormat": "第一行为两个正整数 $N$ 和 $M$，即整数的个数和操作的个数。\n\n第二行包含 $N$ 个 $[0,65535]$ 的整数。\n\n以下 $M$ 行为各操作，格式如题所述。", "outputFormat": "输出所有 $Q$ 操作的统计值。", "hint": "| 测试点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $N$ | $3$ | $10$ | $100$ | $1000$ | $10000$ | $20000$ | $50000$ | $100000$ | $100000$ | $100000$ |\n| $M$ | $3$ | $10$ | $100$ | $1000$ | $10000$ | $20000$ | $50000$ | $50000$ | $100000$ | $200000$ |\n", "locale": "zh-CN"}}}
{"pid": "P5784", "type": "P", "difficulty": 5, "samples": [["3 2 3 4\n1 2 6\n", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "重庆", "各省省选", "枚举"], "title": "[CQOI2008] 矩阵的个数", "background": "", "description": "给出一个 $n\\times 3$ 的非负整数矩阵的各行各列之和，统计有多少个矩阵满足此条件。输出答案模 $10^{17}$ 的值。", "inputFormat": "第一行包含四个正整数 $N$，$c_1$，$c_2$，$c_3$，即行数与三列之和。第二行包含 $N$ 个正整数，即各行三个数之和。每行每列之和均不超过 $125$。\n", "outputFormat": "仅一个数，满足条件的矩阵个数模 $10^{17}$ 的值。", "hint": "| 测试点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $N$ | $1$ | $2$ | $3$ | $10$ | $30$ | $50$ | $80$ | $120$ | $150$ | $200$ |\n", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2008] Number of Matrices", "background": "", "description": "Given the sums of each row and each column of an $n \\times 3$ non-negative integer matrix, count how many matrices satisfy these conditions. Output the answer modulo $10^{17}$.", "inputFormat": "The first line contains four positive integers $N$, $c_1$, $c_2$, $c_3$, representing the number of rows and the sums of the three columns. The second line contains $N$ positive integers, representing the sum of the three numbers in each row. The sum of each row and each column does not exceed $125$.", "outputFormat": "Output one number: the number of matrices satisfying the conditions modulo $10^{17}$.", "hint": "| Test Point ID | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $N$ | $1$ | $2$ | $3$ | $10$ | $30$ | $50$ | $80$ | $120$ | $150$ | $200$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2008] 矩阵的个数", "background": "", "description": "给出一个 $n\\times 3$ 的非负整数矩阵的各行各列之和，统计有多少个矩阵满足此条件。输出答案模 $10^{17}$ 的值。", "inputFormat": "第一行包含四个正整数 $N$，$c_1$，$c_2$，$c_3$，即行数与三列之和。第二行包含 $N$ 个正整数，即各行三个数之和。每行每列之和均不超过 $125$。\n", "outputFormat": "仅一个数，满足条件的矩阵个数模 $10^{17}$ 的值。", "hint": "| 测试点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $N$ | $1$ | $2$ | $3$ | $10$ | $30$ | $50$ | $80$ | $120$ | $150$ | $200$ |\n", "locale": "zh-CN"}}}
{"pid": "P5785", "type": "P", "difficulty": 6, "samples": [["5\n1\n1 3\n3 2\n4 3\n2 3\n1 4\n", "153\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2012", "二分", "各省省选", "单调队列", "山东", "斜率优化", "李超线段树"], "title": "[SDOI2012] 任务安排", "background": "", "description": "机器上有 $n$ 个需要处理的任务，它们构成了一个序列。这些任务被标号为 $1$ 到 $n$，因此序列的排列为 $1 , 2 , 3 \\cdots n$。这 $n$ 个任务被分成若干批，每批包含相邻的若干任务。从时刻 $0$ 开始，这些任务被分批加工，第 $i$ 个任务单独完成所需的时间是 $T_i$。在每批任务开始前，机器需要启动时间 $s$，而完成这批任务所需的时间是各个任务需要时间的总和。\n\n**注意，同一批任务将在同一时刻完成**。每个任务的费用是它的完成时刻乘以一个费用系数 $C_i$。\n\n请确定一个分组方案，使得总费用最小。", "inputFormat": "第一行一个整数 $n$。\n第二行一个整数 $s$。\n\n接下来 $n$ 行，每行有一对整数，分别为 $T_i$ 和 $C_i$，表示第 $i$ 个任务单独完成所需的时间是 $T_i$ 及其费用系数 $C_i$。", "outputFormat": "一行，一个整数，表示最小的总费用。", "hint": "对于 $100\\%$ 数据，$1 \\le n \\le 3 \\times 10^5$，$1 \\le s \\le 2^8$，$ \\left| T_i \\right| \\le 2^8$，$0 \\le C_i \\le 2^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2012] Task Scheduling", "background": "", "description": "There are $n$ tasks to be processed on a machine, and they form a sequence. These tasks are numbered from $1$ to $n$, so the order of the sequence is $1, 2, 3 \\cdots n$. The $n$ tasks are divided into several batches, and each batch contains several consecutive tasks. Starting from time $0$, the tasks are processed batch by batch. The time required to finish task $i$ alone is $T_i$. Before each batch starts, the machine needs a startup time $s$, and the time needed to finish this batch is the sum of the times of all tasks in the batch.\n\n**Note that tasks in the same batch will be completed at the same time.** The cost of each task is its completion time multiplied by a cost coefficient $C_i$.\n\nPlease determine a batching plan that minimizes the total cost.", "inputFormat": "The first line contains an integer $n$.\nThe second line contains an integer $s$.\n\nThe next $n$ lines each contain a pair of integers $T_i$ and $C_i$, meaning that the time required to finish task $i$ alone is $T_i$, and its cost coefficient is $C_i$.", "outputFormat": "One line containing an integer, representing the minimum total cost.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^5$, $1 \\le s \\le 2^8$, $\\left| T_i \\right| \\le 2^8$, $0 \\le C_i \\le 2^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2012] 任务安排", "background": "", "description": "机器上有 $n$ 个需要处理的任务，它们构成了一个序列。这些任务被标号为 $1$ 到 $n$，因此序列的排列为 $1 , 2 , 3 \\cdots n$。这 $n$ 个任务被分成若干批，每批包含相邻的若干任务。从时刻 $0$ 开始，这些任务被分批加工，第 $i$ 个任务单独完成所需的时间是 $T_i$。在每批任务开始前，机器需要启动时间 $s$，而完成这批任务所需的时间是各个任务需要时间的总和。\n\n**注意，同一批任务将在同一时刻完成**。每个任务的费用是它的完成时刻乘以一个费用系数 $C_i$。\n\n请确定一个分组方案，使得总费用最小。", "inputFormat": "第一行一个整数 $n$。\n第二行一个整数 $s$。\n\n接下来 $n$ 行，每行有一对整数，分别为 $T_i$ 和 $C_i$，表示第 $i$ 个任务单独完成所需的时间是 $T_i$ 及其费用系数 $C_i$。", "outputFormat": "一行，一个整数，表示最小的总费用。", "hint": "对于 $100\\%$ 数据，$1 \\le n \\le 3 \\times 10^5$，$1 \\le s \\le 2^8$，$ \\left| T_i \\right| \\le 2^8$，$0 \\le C_i \\le 2^8$。", "locale": "zh-CN"}}}
{"pid": "P5786", "type": "P", "difficulty": 6, "samples": [["5\nYNNYN\nNNNNN\nYNNNY\nNNNYN\nNNNNN\nYNNYN", "5 4 3 5 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "重庆", "各省省选"], "title": "[CQOI2008] 传感器网络", "background": null, "description": "一个无线传感器网络由若干独立采集数据的设备和一个控制中心组成。每个设备必须把采集到的数据传到控制中心处理，但由于设备限制，并不是每台设备都可以与控制中心直接相连。为了解决这一问题，你将传感器网络设计成树状结构。树根为控制中心，而每台设备恰好有一个父亲节点（要么为控制中心，要么为另一台设备）。一台设备的儿子设备个数称为它的负载级别。所有设备（注意，控制中心不是设备）的负载级别的最大值称为网络的负载级别。\n\n你的任务是让整个网络的负载级别尽量小。", "inputFormat": "第一行包含一个整数 $N$，即设备的个数。第二行包含 $N$ 个字符，表示每台设备是否能直接连接到控制中心。以下 $N$ 行每行 $N$ 个字符，其中第 $i$ 行第 $j$ 个字符为 `Y` 当且仅当设备 $i$ 可以作为设备 $j$ 的儿子。如果设备 $i$ 可以作为设备 $j$ 的儿子，那么在任何合法的网络中，设备 $j$ 一定不会是设备 $i$ 的后代。换句话说，如果把这 $N$ 行看作一个有向图的邻接矩阵，该图不存在有向环。", "outputFormat": "仅一行，包含 $N$ 个整数，即每个设备的父亲。设备按照输入顺序编号为 $0$ 至 $N-1$，控制中心用 $N$ 表示。如果有多组解，输出字典序最小解。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/k42z6mxl.png)\n\n对于 $50\\%$ 的数据，$2\\le N\\le 6$；对于另外 $50\\%$ 的数据，$N=50$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2008] Sensor Network.", "background": "", "description": "A wireless sensor network consists of several devices that collect data independently and a control center. Each device must send the collected data to the control center for processing, but due to device limitations, not every device can connect directly to the control center. To solve this, you design the sensor network as a tree structure. The root of the tree is the control center, and each device has exactly one parent node (either the control center or another device). The number of child devices of a device is called its load level. The maximum load level among all devices (note that the control center is not a device) is called the network load level.\n\nYour task is to make the network load level as small as possible.", "inputFormat": "The first line contains an integer $N$, the number of devices. The second line contains $N$ characters, indicating whether each device can connect directly to the control center. The next $N$ lines each contain $N$ characters, where the $j$-th character in the $i$-th line is `Y` if and only if device $i$ can be a child of device $j$. If device $i$ can be a child of device $j$, then in any valid network, device $j$ will definitely not be a descendant of device $i$. In other words, if you treat these $N$ lines as the adjacency matrix of a directed graph, the graph has no directed cycles.", "outputFormat": "Output exactly one line containing $N$ integers, the parent of each device. Devices are numbered from $0$ to $N-1$ in input order, and the control center is denoted by $N$. If there are multiple solutions, output the lexicographically smallest one.", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/k42z6mxl.png)\n\nFor $50\\%$ of the testdata, $2 \\le N \\le 6$; for the other $50\\%$ of the testdata, $N = 50$.\n\nConstraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2008] 传感器网络", "background": null, "description": "一个无线传感器网络由若干独立采集数据的设备和一个控制中心组成。每个设备必须把采集到的数据传到控制中心处理，但由于设备限制，并不是每台设备都可以与控制中心直接相连。为了解决这一问题，你将传感器网络设计成树状结构。树根为控制中心，而每台设备恰好有一个父亲节点（要么为控制中心，要么为另一台设备）。一台设备的儿子设备个数称为它的负载级别。所有设备（注意，控制中心不是设备）的负载级别的最大值称为网络的负载级别。\n\n你的任务是让整个网络的负载级别尽量小。", "inputFormat": "第一行包含一个整数 $N$，即设备的个数。第二行包含 $N$ 个字符，表示每台设备是否能直接连接到控制中心。以下 $N$ 行每行 $N$ 个字符，其中第 $i$ 行第 $j$ 个字符为 `Y` 当且仅当设备 $i$ 可以作为设备 $j$ 的儿子。如果设备 $i$ 可以作为设备 $j$ 的儿子，那么在任何合法的网络中，设备 $j$ 一定不会是设备 $i$ 的后代。换句话说，如果把这 $N$ 行看作一个有向图的邻接矩阵，该图不存在有向环。", "outputFormat": "仅一行，包含 $N$ 个整数，即每个设备的父亲。设备按照输入顺序编号为 $0$ 至 $N-1$，控制中心用 $N$ 表示。如果有多组解，输出字典序最小解。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/k42z6mxl.png)\n\n对于 $50\\%$ 的数据，$2\\le N\\le 6$；对于另外 $50\\%$ 的数据，$N=50$。", "locale": "zh-CN"}}}
{"pid": "P5787", "type": "P", "difficulty": 5, "samples": [["3 3 3\n1 2 0 2\n2 3 0 3\n1 3 1 2\n", "Yes\nNo\nYes\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["并查集", "O2优化", "二分图", "线段树分治", "模板题"], "title": "【模板】线段树分治 / 二分图", "background": "", "description": "神犇有一个 $n$ 个节点的图。\n\n因为神犇是神犇，所以在 $k$ 时间内有 $m$ 条边会出现后消失。\n\n神犇要求出每一时间段内这个图是否是二分图。\n\n这么简单的问题神犇当然会做了，于是他想考考你。\n\n原 BZOJ4025。", "inputFormat": "第一行三个整数 $n,m,k$。\n\n接下来 $m$ 行，每行四个整数 $x,y,l,r$，表示有一条连接 $x,y$ 的边在 $l$ 时刻出现 $r$ 时刻消失。", "outputFormat": "$k$ 行，第 $i$ 行一个字符串 `Yes` 或 `No`，表示在第 $i$ 时间段内这个图是否是二分图。", "hint": "### 样例说明\n\n$0$ 时刻，出现两条边 $(1,2)$ 和 $(2,3)$。\n\n第 $1$ 时间段内，这个图是二分图，输出 `Yes`。\n\n$1$ 时刻，出现一条边 $(1,3)$。\n\n第 $2$ 时间段内，这个图不是二分图，输出 `No`。\n\n$2$ 时刻，$(1,2)$ 和 $(1,3)$ 两条边消失。\n\n第 $3$ 时间段内，只有一条边 $(2,3)$，这个图是二分图，输出 `Yes`。\n\n### 数据范围\n\n$n,k = 10^5$，$m = 2\\times 10^5$。$1 \\le x,y \\le n$，$0 \\le l \\le r \\le k$。\n\n### 注意\n\n本题设有 hack 数据（Subtask $2$），计 $0$ 分，但若没有通过 hack 数据则不算通过本题。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Segment Tree Divide and Conquer / Bipartite Graph.", "background": "", "description": "Shenben has a graph with $n$ nodes.\n\nBecause Shenben is Shenben, within time $k$, there will be $m$ edges that appear and then disappear.\n\nShenben asks you to determine whether the graph is a bipartite graph in each time period.\n\nSuch an easy problem is of course no problem for Shenben, so he wants to test you.\n\nOriginally BZOJ4025.", "inputFormat": "The first line contains three integers $n,m,k$.\n\nIn the next $m$ lines, each line contains four integers $x,y,l,r$, meaning there is an edge connecting $x,y$ that appears at time $l$ and disappears at time $r$.", "outputFormat": "Output $k$ lines. The $i$-th line contains a string `Yes` or `No`, indicating whether the graph is bipartite in the $i$-th time period.", "hint": "### Sample Explanation\n\nAt time $0$, two edges $(1,2)$ and $(2,3)$ appear.\n\nIn the $1$st time period, this graph is bipartite, so output `Yes`.\n\nAt time $1$, an edge $(1,3)$ appears.\n\nIn the $2$nd time period, this graph is not bipartite, so output `No`.\n\nAt time $2$, the two edges $(1,2)$ and $(1,3)$ disappear.\n\nIn the $3$rd time period, there is only one edge $(2,3)$, and this graph is bipartite, so output `Yes`.\n\n### Constraints\n\n$n,k = 10^5$, $m = 2\\times 10^5$. $1 \\le x,y \\le n$, $0 \\le l \\le r \\le k$.\n\n### Notes\n\nThis problem has hack testdata (Subtask $2$), worth $0$ points, but if you do not pass the hack testdata, it will not be considered accepted.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】线段树分治 / 二分图", "background": "", "description": "神犇有一个 $n$ 个节点的图。\n\n因为神犇是神犇，所以在 $k$ 时间内有 $m$ 条边会出现后消失。\n\n神犇要求出每一时间段内这个图是否是二分图。\n\n这么简单的问题神犇当然会做了，于是他想考考你。\n\n原 BZOJ4025。", "inputFormat": "第一行三个整数 $n,m,k$。\n\n接下来 $m$ 行，每行四个整数 $x,y,l,r$，表示有一条连接 $x,y$ 的边在 $l$ 时刻出现 $r$ 时刻消失。", "outputFormat": "$k$ 行，第 $i$ 行一个字符串 `Yes` 或 `No`，表示在第 $i$ 时间段内这个图是否是二分图。", "hint": "### 样例说明\n\n$0$ 时刻，出现两条边 $(1,2)$ 和 $(2,3)$。\n\n第 $1$ 时间段内，这个图是二分图，输出 `Yes`。\n\n$1$ 时刻，出现一条边 $(1,3)$。\n\n第 $2$ 时间段内，这个图不是二分图，输出 `No`。\n\n$2$ 时刻，$(1,2)$ 和 $(1,3)$ 两条边消失。\n\n第 $3$ 时间段内，只有一条边 $(2,3)$，这个图是二分图，输出 `Yes`。\n\n### 数据范围\n\n$n,k = 10^5$，$m = 2\\times 10^5$。$1 \\le x,y \\le n$，$0 \\le l \\le r \\le k$。\n\n### 注意\n\n本题设有 hack 数据（Subtask $2$），计 $0$ 分，但若没有通过 hack 数据则不算通过本题。", "locale": "zh-CN"}}}
{"pid": "P5788", "type": "P", "difficulty": 3, "samples": [["5\n1 4 2 3 5\n", "2 5 4 5 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线性数据结构", "栈", "单调栈", "模板题"], "title": "【模板】单调栈", "background": "模板题，无背景。  \n\n2019.12.12 更新数据，放宽时限，现在不再卡常了。", "description": "给出项数为 $n$ 的整数数列 $a_{1 \\dots n}$。\n\n定义函数 $f(i)$ 代表数列中第 $i$ 个元素之后第一个大于 $a_i$ 的元素的**下标**，即 $f(i)=\\min_{i<j\\leq n, a_j > a_i} \\{j\\}$。若不存在，则 $f(i)=0$。\n\n试求出 $f(1\\dots n)$。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数 $a_{1\\dots n}$。", "outputFormat": "一行 $n$ 个整数表示 $f(1), f(2), \\dots, f(n)$ 的值。  ", "hint": "【数据规模与约定】\n\n对于 $30\\%$ 的数据，$n\\leq 100$；\n\n对于 $60\\%$ 的数据，$n\\leq 5 \\times 10^3$ ；\n\n对于 $100\\%$ 的数据，$1 \\le n\\leq 3\\times 10^6$，$1\\leq a_i\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Monotonic Stack", "background": "This is a template problem, with no background.\n\nTestdata was updated on 2019.12.12. The time limit was relaxed, and it no longer relies on constant-factor optimizations.", "description": "Given an integer sequence $a_{1 \\dots n}$ with $n$ terms.\n\nDefine a function $f(i)$ as the **index** of the first element after the $i$-th element in the sequence that is greater than $a_i$, that is,\n$f(i)=\\min_{i<j\\leq n, a_j > a_i} \\{j\\}$.\nIf it does not exist, then $f(i)=0$.\n\nFind $f(1\\dots n)$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ positive integers $a_{1\\dots n}$.", "outputFormat": "Output one line with $n$ integers representing the values of $f(1), f(2), \\dots, f(n)$.", "hint": "Constraints\n\nFor $30\\%$ of the testdata, $n\\leq 100$.\n\nFor $60\\%$ of the testdata, $n\\leq 5 \\times 10^3$.\n\nFor $100\\%$ of the testdata, $1 \\le n\\leq 3\\times 10^6$, $1\\leq a_i\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】单调栈", "background": "模板题，无背景。  \n\n2019.12.12 更新数据，放宽时限，现在不再卡常了。", "description": "给出项数为 $n$ 的整数数列 $a_{1 \\dots n}$。\n\n定义函数 $f(i)$ 代表数列中第 $i$ 个元素之后第一个大于 $a_i$ 的元素的**下标**，即 $f(i)=\\min_{i<j\\leq n, a_j > a_i} \\{j\\}$。若不存在，则 $f(i)=0$。\n\n试求出 $f(1\\dots n)$。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数 $a_{1\\dots n}$。", "outputFormat": "一行 $n$ 个整数表示 $f(1), f(2), \\dots, f(n)$ 的值。  ", "hint": "【数据规模与约定】\n\n对于 $30\\%$ 的数据，$n\\leq 100$；\n\n对于 $60\\%$ 的数据，$n\\leq 5 \\times 10^3$ ；\n\n对于 $100\\%$ 的数据，$1 \\le n\\leq 3\\times 10^6$，$1\\leq a_i\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5789", "type": "P", "difficulty": 5, "samples": [["3 2\n1 2\n2 3\n2", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "各省省选", "矩阵乘法", "天津"], "title": "[TJOI2017] 可乐（数据加强版）", "background": "[原题](https://www.luogu.org/problem/P3758) 数据很弱，这个加强版卡掉了暴力的 DP 做法，并且补充了原题题面中缺少的 $\\LaTeX$ 。", "description": "加里敦星球的人们特别喜欢喝可乐。因而，他们的敌对星球研发出了一个可乐机器人，并且放在了加里敦星球的 $1$ 号城市上。这个可乐机器人有三种行为： 停在原地，去下一个相邻的城市，自爆。它每一秒都会随机触发一种行为。现在给加里敦星球城市图，在第 $0$ 秒时可乐机器人在 $1$ 号城市，问经过了 $t$ 秒，可乐机器人的行为方案数是多少？", "inputFormat": "第一行输入两个正整数 $N,M$，$N$ 表示城市个数，$M$ 表示道路个数。\n\n接下来 $M$ 行输入 $u,v$，表示 $u,v$ 之间有一条双向道路。\n\n最后输入时间 $t$。", "outputFormat": "输出可乐机器人的行为方案数，答案可能很大，请输出对 $2017$ 取模后的结果。", "hint": "【数据规模与约定】\n\n对于 $20\\%$ 的数据，$n,m\\leq 30$，$t\\leq 1000$；\n\n对于 $50\\%$ 的数据，$t\\leq 10^6$；\n\n对于 $100\\%$ 的数据，$n,m\\leq 100$，$t\\leq 10^9$。\n\n【样例解释】\n\n$1$ $\\rightarrow$ 爆炸\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ 爆炸\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ 爆炸\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ $1$\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ $2$\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $1$\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $2$\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $3$", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2017] Cola (Enhanced Data Version).", "background": "The testdata of the [original problem](https://www.luogu.org/problem/P3758) is very weak. This enhanced version eliminates the brute-force DP solution and also adds the missing $\\LaTeX$ from the original statement.", "description": "People on the planet Gariton especially like drinking cola. Therefore, their enemy planet developed a cola robot and placed it in City $1$ on Gariton. This cola robot has three kinds of actions: stay where it is, go to the next adjacent city, and self-destruct. Every second it randomly triggers one action. Now you are given the city graph of Gariton. At time $0$, the cola robot is in City $1$. After $t$ seconds, how many possible action plans does the cola robot have?", "inputFormat": "The first line contains two positive integers $N, M$, where $N$ is the number of cities and $M$ is the number of roads.\n\nThe next $M$ lines each contain $u, v$, meaning there is a bidirectional road between $u$ and $v$.\n\nFinally, input the time $t$.", "outputFormat": "Output the number of possible action plans of the cola robot. The answer may be very large, so output the result modulo $2017$.", "hint": "Constraints\n\nFor $20\\%$ of the data, $n, m \\leq 30$, $t \\leq 1000$.\n\nFor $50\\%$ of the data, $t \\leq 10^6$.\n\nFor $100\\%$ of the data, $n, m \\leq 100$, $t \\leq 10^9$.\n\nSample Explanation\n\n$1$ $\\rightarrow$ explode.\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ explode.\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ explode.\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ $1$.\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ $2$.\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $1$.\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $2$.\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2017] 可乐（数据加强版）", "background": "[原题](https://www.luogu.org/problem/P3758) 数据很弱，这个加强版卡掉了暴力的 DP 做法，并且补充了原题题面中缺少的 $\\LaTeX$ 。", "description": "加里敦星球的人们特别喜欢喝可乐。因而，他们的敌对星球研发出了一个可乐机器人，并且放在了加里敦星球的 $1$ 号城市上。这个可乐机器人有三种行为： 停在原地，去下一个相邻的城市，自爆。它每一秒都会随机触发一种行为。现在给加里敦星球城市图，在第 $0$ 秒时可乐机器人在 $1$ 号城市，问经过了 $t$ 秒，可乐机器人的行为方案数是多少？", "inputFormat": "第一行输入两个正整数 $N,M$，$N$ 表示城市个数，$M$ 表示道路个数。\n\n接下来 $M$ 行输入 $u,v$，表示 $u,v$ 之间有一条双向道路。\n\n最后输入时间 $t$。", "outputFormat": "输出可乐机器人的行为方案数，答案可能很大，请输出对 $2017$ 取模后的结果。", "hint": "【数据规模与约定】\n\n对于 $20\\%$ 的数据，$n,m\\leq 30$，$t\\leq 1000$；\n\n对于 $50\\%$ 的数据，$t\\leq 10^6$；\n\n对于 $100\\%$ 的数据，$n,m\\leq 100$，$t\\leq 10^9$。\n\n【样例解释】\n\n$1$ $\\rightarrow$ 爆炸\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ 爆炸\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ 爆炸\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ $1$\n\n$1$ $\\rightarrow$ $1$ $\\rightarrow$ $2$\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $1$\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $2$\n\n$1$ $\\rightarrow$ $2$ $\\rightarrow$ $3$", "locale": "zh-CN"}}}
{"pid": "P5790", "type": "P", "difficulty": 0, "samples": [["3\n4 0 0 4 -1 5 4 0 4\n4 0 0 5 -1 8 3 0 3\n4 0 0 0 -8 3 -4 4 0", "Yes\n0 4 4 3 5 8 0 8\n5 8 4 3 8 0 8 8\n0 0 8 0 4 3 0 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2006", "Special Judge", "CTSC/CTS"], "title": "[CTSC2006] 拼图「暂缺SPJ」", "background": "", "description": "$5$ 岁的小 $P$ 对剪纸很感兴趣，他总是喜欢把一个矩形的纸片剪成一个又一个的凸多边形。但是，每一次剪完后，他总是怀疑自己弄丢了一些纸片。聪明的他想到了一个方法来检测纸片是否弄丢：他将这些凸多边形拼起来，如果能够拼成一个矩形，他就认为纸片没有弄丢。由于纸片的数量不是很多，这个工作并不难。但是，久而久之，他对这项工作不感兴趣了，所以，他找到了你，希望你能够告诉他，这些凸多边形纸片能不能够拼成矩形。", "inputFormat": "第一行只有一个正整数 $n$，表示凸多边形的个数。\n\n以下 $n$ 行每一行描述一个凸多边形，格式如下：\n\n第 $i+1$ 行的第一个数 $m_i$ 表示凸多边形的点数，接下来有 $m_i$ 对实数，一对实数给出了一个点的坐标，这 $m_i$ 个顶点按照从任意一个顶点出发的逆时针顺序给出。且所有实数都在 $(-10^3,10^3)$ 的范围内，小数点后不超过 $8$ 位。", "outputFormat": "如果不能拼成矩形，输出只有一行 `No`。\n\n如果能拼成矩形，输出的第一行为 `Yes`。\n\n接下来的 $n$ 行描述拼法。\n\n如果能够拼成一个 $X\\times Y$ 的矩形，那么矩形的四个顶点的坐标是 $(0,0), (0,Y), (X,Y), (X,0)$。这 $n$ 行输出每一个凸多边形的顶点的坐标（拼成矩形后）。按照输入的顺序，即第一个输出的凸多边形对应输入的第一个凸多边形。对于每一个凸多边形，输出也按照输入的顺序，即一个多边形的第一个顶点对应输入的第一个顶点。这样，输出总共有 $n$ 行，第 $i$ 行有 $m_i$ 对数。", "hint": "#### 样例说明\n如下图，左上、右上和左下描述了输入的凸多边形，右下描述了输出的的矩形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dmd58o3a.png)\n\n#### 注意\n由于矩形纸片的两面的颜色不同，所以纸片只能旋转和平移，不能翻转。所以，输出的 $m_i$ 个顶点也应该是逆时针顺序的。\n\n#### 数据范围\n对于 $100\\%$ 的数据，$1\\leq n\\leq 8$, $3\\leq m_i\\leq 8$。\n\n#### 评分说明\n两个实数之差的绝对值小于 $10^{-7}$ 时认为两个实数相等。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2006] Jigsaw Puzzle \"SPJ Missing\"", "background": "", "description": "Little $P$, who is $5$ years old, is very interested in paper cutting. He always likes to cut a rectangular piece of paper into one convex polygon after another. However, after each cutting, he always suspects that he has lost some pieces. Being smart, he came up with a way to check whether any pieces were lost: he puts these convex polygons together, and if they can form a rectangle, he believes that no piece was lost.\n\nSince the number of pieces is not large, this work is not difficult. But over time, he lost interest in doing it, so he came to you and hopes that you can tell him whether these convex polygon pieces can be assembled into a rectangle.", "inputFormat": "The first line contains one positive integer $n$, indicating the number of convex polygons.\n\nThe following $n$ lines each describe one convex polygon in the format below:\n\nOn line $i+1$, the first number $m_i$ is the number of vertices of the convex polygon. Then there are $m_i$ pairs of real numbers, where each pair gives the coordinates of a vertex. These $m_i$ vertices are given in counterclockwise order starting from any vertex. All real numbers are in the range $(-10^3,10^3)$, with at most $8$ digits after the decimal point.", "outputFormat": "If the polygons cannot be assembled into a rectangle, output one line containing `No`.\n\nIf they can be assembled into a rectangle, the first line should be `Yes`.\n\nThe next $n$ lines describe the assembly.\n\nIf they can form an $X\\times Y$ rectangle, then the coordinates of the rectangle’s four vertices are $(0,0), (0,Y), (X,Y), (X,0)$. In these $n$ lines, output the coordinates of the vertices of each convex polygon (after assembling into the rectangle). Output in the input order, i.e., the first polygon in the output corresponds to the first polygon in the input. For each polygon, the output order should also match the input order, i.e., the first output vertex corresponds to the first input vertex of that polygon. Therefore, there are $n$ output lines in total, and line $i$ contains $m_i$ pairs of numbers.", "hint": "#### Sample Explanation\n\nIn the figure below, the top-left, top-right, and bottom-left parts show the input convex polygons, and the bottom-right part shows the output rectangle.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dmd58o3a.png)\n\n#### Note\n\nBecause the two sides of the rectangular paper have different colors, each piece can only be rotated and translated, but cannot be flipped. Therefore, the output $m_i$ vertices should also be in counterclockwise order.\n\n#### Constraints\n\nFor $100\\%$ of the testdata, $1\\leq n\\leq 8$, $3\\leq m_i\\leq 8$.\n\n#### Scoring\n\nTwo real numbers are considered equal if the absolute value of their difference is less than $10^{-7}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2006] 拼图「暂缺SPJ」", "background": "", "description": "$5$ 岁的小 $P$ 对剪纸很感兴趣，他总是喜欢把一个矩形的纸片剪成一个又一个的凸多边形。但是，每一次剪完后，他总是怀疑自己弄丢了一些纸片。聪明的他想到了一个方法来检测纸片是否弄丢：他将这些凸多边形拼起来，如果能够拼成一个矩形，他就认为纸片没有弄丢。由于纸片的数量不是很多，这个工作并不难。但是，久而久之，他对这项工作不感兴趣了，所以，他找到了你，希望你能够告诉他，这些凸多边形纸片能不能够拼成矩形。", "inputFormat": "第一行只有一个正整数 $n$，表示凸多边形的个数。\n\n以下 $n$ 行每一行描述一个凸多边形，格式如下：\n\n第 $i+1$ 行的第一个数 $m_i$ 表示凸多边形的点数，接下来有 $m_i$ 对实数，一对实数给出了一个点的坐标，这 $m_i$ 个顶点按照从任意一个顶点出发的逆时针顺序给出。且所有实数都在 $(-10^3,10^3)$ 的范围内，小数点后不超过 $8$ 位。", "outputFormat": "如果不能拼成矩形，输出只有一行 `No`。\n\n如果能拼成矩形，输出的第一行为 `Yes`。\n\n接下来的 $n$ 行描述拼法。\n\n如果能够拼成一个 $X\\times Y$ 的矩形，那么矩形的四个顶点的坐标是 $(0,0), (0,Y), (X,Y), (X,0)$。这 $n$ 行输出每一个凸多边形的顶点的坐标（拼成矩形后）。按照输入的顺序，即第一个输出的凸多边形对应输入的第一个凸多边形。对于每一个凸多边形，输出也按照输入的顺序，即一个多边形的第一个顶点对应输入的第一个顶点。这样，输出总共有 $n$ 行，第 $i$ 行有 $m_i$ 对数。", "hint": "#### 样例说明\n如下图，左上、右上和左下描述了输入的凸多边形，右下描述了输出的的矩形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dmd58o3a.png)\n\n#### 注意\n由于矩形纸片的两面的颜色不同，所以纸片只能旋转和平移，不能翻转。所以，输出的 $m_i$ 个顶点也应该是逆时针顺序的。\n\n#### 数据范围\n对于 $100\\%$ 的数据，$1\\leq n\\leq 8$, $3\\leq m_i\\leq 8$。\n\n#### 评分说明\n两个实数之差的绝对值小于 $10^{-7}$ 时认为两个实数相等。", "locale": "zh-CN"}}}
{"pid": "P5791", "type": "P", "difficulty": 0, "samples": [["3 3 2 2 3 3\n1 1\n1 1", "Yes\n1 -1 1\n-4 5 -4\n1 -1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2006", "Special Judge", "CTSC/CTS"], "title": "[CTSC2006] 方块填数", "background": null, "description": "最近，一个方块填数的游戏风靡全球：\n\n给定一个 $n\\times m$ 的方块。$n$ 行从上到下标号为 $1$ 到 $n$，$m$ 列从左到右标号为 $1$ 到 $m$。如果一个方格所在的行的标号和所在的列的标号都是奇数，那么该方格就称为奇方格。游戏的开始所有的奇方格中都填上了数。你需要在其他的方格里填数，如果填完数后，方块满足下面条件，你就赢得了这个游戏：\n\n1. 任意一个 $a_1\\times b_1$ 的子方块中所有数的和大于 $0$；\n2. 任意一个 $a_2\\times b_2$ 的子方块中所有数的和小于 $0$。\n\n其中，$a_1, b_1, a_2, b_2$ 都是在游戏的开始给定的。一个 $a\\times b$ 的子方块是指行标号在 $i\\ (1\\leq i\\leq n-a+1)$ 到 $i+a-1$ 之间，列标号在 $j\\ (1\\leq j\\leq m-b+1)$ 到 $j+b-1$ 之间的所有的方格的集合。\n\n小 P 很喜欢这种游戏，他希望你帮助写一个程序给出一种填数的方案，或者告诉他这样的方案不存在。", "inputFormat": "第一行为用空格分开的 $6$ 个正整数 $n, m, a_1, b_1, a_2, b_2$。\n\n接下来 $\\lfloor \\frac{n+1}{2} \\rfloor$ 行，每一行有 $\\lfloor \\frac{m+1}{2} \\rfloor$ 个整数，第 $i+1$ 行的第 $j\\ (j=1, 2, \\ldots, \\lfloor \\frac{m+1}{2} \\rfloor)$ 个数表示在游戏开始时方块的第 $2i-1$ 行，第 $2j-1$ 列的方格所填的整数。", "outputFormat": "如果填数方案不存在，仅输出一行 `No`。\n\n如果填数方案存在，先输出一行 `Yes`。接下来 $n$ 行，每一行为用空格分开的 $m$ 个整数，描述一个填数方案。输出的每一个整数必须在 $-10^9$ 到 $10^9$ 之间。", "hint": "#### 样例说明\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/genpecku.png)\n\n填完数后，任意 $2\\times 2$ 的方块中的数字之和是 $1$；$3\\times 3$ 的方块中的数字之和是 $-1$。\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n, m, a_1, b_1, a_2, b_2\\leq 100$。方格里已经填的数都在 $-100$ 到 $100$ 之间。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2006] Filling Numbers in a Grid", "background": "", "description": "Recently, a game of filling numbers in a grid has become popular worldwide.\n\nYou are given an $n \\times m$ grid. The $n$ rows are numbered from $1$ to $n$ from top to bottom, and the $m$ columns are numbered from $1$ to $m$ from left to right. If both the row number and the column number of a cell are odd, then the cell is called an odd cell. At the start of the game, all odd cells are already filled with numbers. You need to fill numbers into the other cells. If after filling, the grid satisfies the following conditions, you win the game:\n\n1. In every $a_1 \\times b_1$ subgrid, the sum of all numbers is greater than $0$.\n2. In every $a_2 \\times b_2$ subgrid, the sum of all numbers is less than $0$.\n\nHere, $a_1, b_1, a_2, b_2$ are all given at the start of the game. An $a \\times b$ subgrid refers to the set of all cells whose row indices are from $i\\ (1 \\leq i \\leq n-a+1)$ to $i+a-1$, and whose column indices are from $j\\ (1 \\leq j \\leq m-b+1)$ to $j+b-1$.\n\nXiao P likes this game very much. He hopes you can help write a program to provide one way to fill the numbers, or tell him that such a way does not exist.", "inputFormat": "The first line contains $6$ positive integers separated by spaces: $n, m, a_1, b_1, a_2, b_2$.\n\nNext, there are $\\lfloor \\frac{n+1}{2} \\rfloor$ lines. Each line contains $\\lfloor \\frac{m+1}{2} \\rfloor$ integers. The $j\\ (j=1, 2, \\ldots, \\lfloor \\frac{m+1}{2} \\rfloor)$-th number on line $i+1$ represents the integer initially filled in the cell at row $2i-1$ and column $2j-1$ of the grid.", "outputFormat": "If no filling scheme exists, output only one line: `No`.\n\nIf a filling scheme exists, first output one line: `Yes`. Then output $n$ lines, each containing $m$ integers separated by spaces, describing a filling scheme. Each output integer must be between $-10^9$ and $10^9$.", "hint": "#### Sample Explanation\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/genpecku.png)\n\nAfter filling, the sum of the numbers in any $2 \\times 2$ block is $1$; the sum of the numbers in any $3 \\times 3$ block is $-1$.\n\n#### Constraints\n\nFor $100\\%$ of the testdata, $1 \\leq n, m, a_1, b_1, a_2, b_2 \\leq 100$. The numbers already filled in the grid are all between $-100$ and $100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2006] 方块填数", "background": null, "description": "最近，一个方块填数的游戏风靡全球：\n\n给定一个 $n\\times m$ 的方块。$n$ 行从上到下标号为 $1$ 到 $n$，$m$ 列从左到右标号为 $1$ 到 $m$。如果一个方格所在的行的标号和所在的列的标号都是奇数，那么该方格就称为奇方格。游戏的开始所有的奇方格中都填上了数。你需要在其他的方格里填数，如果填完数后，方块满足下面条件，你就赢得了这个游戏：\n\n1. 任意一个 $a_1\\times b_1$ 的子方块中所有数的和大于 $0$；\n2. 任意一个 $a_2\\times b_2$ 的子方块中所有数的和小于 $0$。\n\n其中，$a_1, b_1, a_2, b_2$ 都是在游戏的开始给定的。一个 $a\\times b$ 的子方块是指行标号在 $i\\ (1\\leq i\\leq n-a+1)$ 到 $i+a-1$ 之间，列标号在 $j\\ (1\\leq j\\leq m-b+1)$ 到 $j+b-1$ 之间的所有的方格的集合。\n\n小 P 很喜欢这种游戏，他希望你帮助写一个程序给出一种填数的方案，或者告诉他这样的方案不存在。", "inputFormat": "第一行为用空格分开的 $6$ 个正整数 $n, m, a_1, b_1, a_2, b_2$。\n\n接下来 $\\lfloor \\frac{n+1}{2} \\rfloor$ 行，每一行有 $\\lfloor \\frac{m+1}{2} \\rfloor$ 个整数，第 $i+1$ 行的第 $j\\ (j=1, 2, \\ldots, \\lfloor \\frac{m+1}{2} \\rfloor)$ 个数表示在游戏开始时方块的第 $2i-1$ 行，第 $2j-1$ 列的方格所填的整数。", "outputFormat": "如果填数方案不存在，仅输出一行 `No`。\n\n如果填数方案存在，先输出一行 `Yes`。接下来 $n$ 行，每一行为用空格分开的 $m$ 个整数，描述一个填数方案。输出的每一个整数必须在 $-10^9$ 到 $10^9$ 之间。", "hint": "#### 样例说明\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/genpecku.png)\n\n填完数后，任意 $2\\times 2$ 的方块中的数字之和是 $1$；$3\\times 3$ 的方块中的数字之和是 $-1$。\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n, m, a_1, b_1, a_2, b_2\\leq 100$。方格里已经填的数都在 $-100$ 到 $100$ 之间。", "locale": "zh-CN"}}}
{"pid": "P5792", "type": "P", "difficulty": 7, "samples": [["5 0 100 135\n20 200\n200 100\n300 125\n40 10\n100 100", "469.86"], ["8 1 25 15\n0 0\n0 20\n30 20\n30 0\n20 0\n20 10\n10 10\n10 0", "106.67"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2005", "Special Judge", "CTSC/CTS"], "title": "[CTSC2005] 孤独的牧羊女", "background": "", "description": "在瑞典的达拉纳洲有一座高山。山上有一个小屋，里面住着一位牧羊女。每天清晨，隔壁的山头会传来一阵悠扬的长笛声，而牧羊女则会站在屋里用自己的歌声回应。\n\n小屋的俯视图是一个有 $n$ 个顶点的简单多边形，每一面墙可以反射声音，但是由于不可避免的能量损失，最多只能反射 $k$ 次（$k=0$ 表示不能反射声音）。墙面非常光滑，因此声音的反射遵循反射角等于入射角，如图 $1$。墙角不能反射声音，而每面墙的其他部分——即使离墙角很近——都可以反射声音。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wcjsrg80.png)\n\n突然有一天，牧羊女问自己：在小屋的哪些地方能听到她的歌声？假设所有听众都在屋里靠墙而坐，那么歌声能到达的墙一共有多长？\n图 $2$ 的四幅示意图分别画出了初始情况和声音经过 $0$、$1$、$2$ 次反射后到达的区域。灰色部分表示能听到歌声的部分，黑点表示牧羊女的位置。本题所求即灰色部分在多边形边界上的**总长度**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yuwzz7vj.png)", "inputFormat": "第一行包含 $4$ 个整数 $n，k，x，y$ 分别表示小屋的墙角数、最多反射的次数以及牧羊女的坐标（牧羊女所在位置保证在屋内且至少离墙 $1$ 个单位）。以下 $n$ 行每行两个整数 $x, y$，表示第 $i$ 个墙角的坐标。墙角按照**顺时针或逆时针**排列。", "outputFormat": "输出文件仅包含一个实数 $L$，表示能听到歌声的墙的总长度。保留两位小数。", "hint": "#### 评分方法\n\n选手输出和参考输出差的绝对值不大于 $0.02$ 时该测试点满分，相差超过 $0.02$ 但不超过 $1$ 时该测试点得 $50\\%$ 的分数。在样例$1$中，答案为 $469.84$ 和 $469.88$ 都能拿满分，$468.86$ 和 $470.86$ 都能拿 $50\\%$ 的分数。\n\n#### 约定\n\n$3\\leq n\\leq 50$，$0\\leq k\\leq 5$，所有坐标为绝对值不超过 $1000$ 的整数。\n\n$50\\%$ 的数据满足 $k≤1$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2005] The Lonely Shepherd Girl", "background": "", "description": "In Dalarna, Sweden, there is a high mountain. On the mountain there is a small cabin, where a shepherd girl lives. Every morning, a melodious flute sound comes from the neighboring mountain, and the shepherd girl responds from inside the cabin with her singing.\n\nThe top view of the cabin is a simple polygon with $n$ vertices. Each wall can reflect sound, but due to unavoidable energy loss, the sound can be reflected at most $k$ times ($k=0$ means sound cannot be reflected). The walls are very smooth, so the reflection follows the law that the angle of reflection equals the angle of incidence, as shown in Figure $1$. Corners cannot reflect sound, but every other part of a wall—even very close to a corner—can reflect sound.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wcjsrg80.png)\n\nOne day, the shepherd girl asked herself: at which places in the cabin can her singing be heard? Assume all listeners sit inside the cabin with their backs against the walls. Then what is the total length of the walls that her singing can reach?\n\nThe four diagrams in Figure $2$ show the initial situation and the regions reached after $0$, $1$, and $2$ reflections. The gray part indicates the area where the singing can be heard, and the black dot indicates the shepherd girl’s position. What you need to compute is the **total length** of the gray part on the polygon boundary.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yuwzz7vj.png)", "inputFormat": "The first line contains $4$ integers $n, k, x, y$, representing the number of corners of the cabin, the maximum number of reflections, and the shepherd girl’s coordinates (her position is guaranteed to be inside the cabin and at least $1$ unit away from the walls). The next $n$ lines each contain two integers $x, y$, giving the coordinates of the $i$-th corner. The corners are listed in **clockwise or counterclockwise** order.", "outputFormat": "The output contains only one real number $L$, representing the total length of walls that can hear the singing. Print it with two decimal places.", "hint": "#### Scoring\n\nA test point gets full score if the absolute difference between your output and the reference output is not greater than $0.02$. If the difference is greater than $0.02$ but not greater than $1$, then the test point gets $50\\%$ of the score. In Sample $1$, answers $469.84$ and $469.88$ both get full score, while $468.86$ and $470.86$ both get $50\\%$ of the score.\n\n#### Notes\n\n$3\\leq n\\leq 50$, $0\\leq k\\leq 5$, and all coordinates are integers with absolute value not exceeding $1000$.\n\n$50\\%$ of the testdata satisfies $k\\leq 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2005] 孤独的牧羊女", "background": "", "description": "在瑞典的达拉纳洲有一座高山。山上有一个小屋，里面住着一位牧羊女。每天清晨，隔壁的山头会传来一阵悠扬的长笛声，而牧羊女则会站在屋里用自己的歌声回应。\n\n小屋的俯视图是一个有 $n$ 个顶点的简单多边形，每一面墙可以反射声音，但是由于不可避免的能量损失，最多只能反射 $k$ 次（$k=0$ 表示不能反射声音）。墙面非常光滑，因此声音的反射遵循反射角等于入射角，如图 $1$。墙角不能反射声音，而每面墙的其他部分——即使离墙角很近——都可以反射声音。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wcjsrg80.png)\n\n突然有一天，牧羊女问自己：在小屋的哪些地方能听到她的歌声？假设所有听众都在屋里靠墙而坐，那么歌声能到达的墙一共有多长？\n图 $2$ 的四幅示意图分别画出了初始情况和声音经过 $0$、$1$、$2$ 次反射后到达的区域。灰色部分表示能听到歌声的部分，黑点表示牧羊女的位置。本题所求即灰色部分在多边形边界上的**总长度**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yuwzz7vj.png)", "inputFormat": "第一行包含 $4$ 个整数 $n，k，x，y$ 分别表示小屋的墙角数、最多反射的次数以及牧羊女的坐标（牧羊女所在位置保证在屋内且至少离墙 $1$ 个单位）。以下 $n$ 行每行两个整数 $x, y$，表示第 $i$ 个墙角的坐标。墙角按照**顺时针或逆时针**排列。", "outputFormat": "输出文件仅包含一个实数 $L$，表示能听到歌声的墙的总长度。保留两位小数。", "hint": "#### 评分方法\n\n选手输出和参考输出差的绝对值不大于 $0.02$ 时该测试点满分，相差超过 $0.02$ 但不超过 $1$ 时该测试点得 $50\\%$ 的分数。在样例$1$中，答案为 $469.84$ 和 $469.88$ 都能拿满分，$468.86$ 和 $470.86$ 都能拿 $50\\%$ 的分数。\n\n#### 约定\n\n$3\\leq n\\leq 50$，$0\\leq k\\leq 5$，所有坐标为绝对值不超过 $1000$ 的整数。\n\n$50\\%$ 的数据满足 $k≤1$。", "locale": "zh-CN"}}}
{"pid": "P5793", "type": "P", "difficulty": 0, "samples": [["7 2\n7\n1\n7\n7\n7\n1\n2\n2 1 2\n3 2 4\n6 5 2\n7 5 9\n5 1 3\n4 1 7", "30\n2"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "CTSC/CTS"], "title": "[CTSC2004] 网络改造", "background": "HURRICANE 小组原来构建的网络由网络上的交换机及其间的网路构成。交换机分级连接，最高级的为顶级的网关交换机，其他交换机分级相连到该网关交换机上。但值得注意的是，任一台非网关交换机与一台高一级的交换机直接相连。而任一台交换机均可以与几台低一级的交换机直接相连。\n\n但最近，由于原来架设的网络服务有限，需要把网络中的一些交换机（包括网关交换机）升级为核心交换机。由于改造的时间所限，只来得及把不超过 $p$ 台（含 $p$ 台）交换机升级为核心交换机，而所有剩下的交换机则需要通过改造网路的方法和这几台核心交换机直接连接。\n\n但是无论是升级交换机还是改造网络都需要花费一定的资金。现在请你给出一个改造网络的方案。使得按照该方案升级后每一个交换机要么是核心交换机，要么直接和核心交换机相连。并且要求提供的方案使改造所用的总费用最小。", "description": "你的程序必须根据给定的输入，给出符合题意的输出：\n\n+ 输入包括网络的拓扑结构，升级网络中每台交换机的费用，以及改造网络的费用，还有可以升级的交换机的最大数目 $p$；\n+ 你必须根据输入，找出一个升级的方案，满足升级后的核心交换机的数目不超过给定的可升级交换机最大值 $p$，且使得总费用最少；\n+ 其中总费用的计算包括两个部分:\n    - 一部分是升级交换机为核心交换机所需要的费用，该部分的费用按照所有的需要升级的交换机所需的费用之和来计算；\n    - 另一部分是改造网络所需要的费用，该部分的费用按照所有未升级的交换机到最近的核心交换机的网络路径距离之和来计算；\n    - **注意:** 当网络中没有任何交换机升级到核心交换机的时候，由于也没有交换机可以连接到核心交换机，所以我们定义此时的总费用为无穷大。", "inputFormat": "第一行为两个正整数 $n(n \\leq 400)$ 和 $p$，分别表示网络中交换机的数目（交换机按照 $1$ 到 $n$ 标号）和可升级交换机的最大值。接下来的 $n$ 行每行一个正整数 $c_i$，表示把标号为 $i$ 的交换机升级为核心交换机所需要的费用。\n\n接下来的 $n-1$ 行每行三个正整数 $i$、$j$、$d_{i,j}(d_{i,j}<20000)$，表示编号为 $j$ 的交换机为编号为 $i$ 的交换机的上层交换机，而 $d_{i,j}$ 表示两台交换机之间的网路距离。", "outputFormat": "你的输出第一行为一个整数 $M$，表示你的方案的最小总费用。接下来一行包括一个整数 $p_0$，表示你的方案所需要升级为核心交换机的交换机数目。", "hint": "#### 样例说明\n![](https://cdn.luogu.com.cn/upload/image_hosting/74nd663j.png)\n\n#### 评分方法\n本题目一共有十个测试点，每个测试点的分数为总分数的 $10\\%$。对于每个测试点来说，如果你的答案正确，那么你将得到该测试点全部的分数，否则得 $0$ 分。\n\n注意，本题目的测试数据中有 $8$ 个数据的 $n$ 不超过 $180$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2004] Network Reconstruction.", "background": "The network originally built by the HURRICANE group consists of switches and the links between them. The switches are connected in levels. The highest one is the top gateway switch, and all other switches are connected to this gateway switch level by level. Note that any non-gateway switch is directly connected to exactly one switch at the next higher level, while any switch may be directly connected to several switches at the next lower level.\n\nRecently, because the original network services are limited, some switches in the network (including the gateway switch) need to be upgraded to core switches. Due to limited time, at most $p$ switches (including $p$) can be upgraded to core switches, and all remaining switches must be directly connected to these core switches by reconstructing the network links.\n\nHowever, both upgrading switches and reconstructing links cost money. Please provide a reconstruction plan such that after the upgrade, every switch is either a core switch or is directly connected to a core switch, and the total cost of reconstruction is minimized.", "description": "Your program must produce output that satisfies the requirements based on the given input:\n\n- The input includes the network topology, the cost to upgrade each switch in the network, the cost to reconstruct links, and the maximum number $p$ of switches that can be upgraded.\n- Based on the input, you must find an upgrade plan such that the number of core switches after upgrading does not exceed the given maximum $p$, and the total cost is minimized.\n- The total cost consists of two parts:\n  - One part is the cost required to upgrade switches to core switches, which is the sum of the upgrade costs of all switches that are upgraded.\n  - The other part is the cost required to reconstruct the network, which is the sum of the network path distances from every non-upgraded switch to its nearest core switch.\n  - **Note:** If no switch in the network is upgraded to a core switch, since no switch can be connected to a core switch, we define the total cost in this case to be infinity.", "inputFormat": "The first line contains two positive integers $n(n \\leq 400)$ and $p$, representing the number of switches in the network (switches are numbered from $1$ to $n$) and the maximum number of switches that can be upgraded.\n\nThe next $n$ lines each contain a positive integer $c_i$, representing the cost to upgrade switch $i$ to a core switch.\n\nThe next $n-1$ lines each contain three positive integers $i$, $j$, and $d_{i,j}(d_{i,j}<20000)$, indicating that switch $j$ is an upper-level switch of switch $i$, and $d_{i,j}$ is the network distance between the two switches.", "outputFormat": "The first line of output contains an integer $M$, representing the minimum total cost of your plan.\n\nThe next line contains an integer $p_0$, representing the number of switches that need to be upgraded to core switches in your plan.", "hint": "#### Sample Explanation\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/74nd663j.png)\n\n#### Scoring Method\n\nThere are ten test points in this problem, and each test point is worth $10\\%$ of the total score. For each test point, if your answer is correct, you will get the full score for that test point; otherwise, you will get $0$ points.\n\nNote that in the testdata of this problem, there are $8$ cases where $n$ does not exceed $180$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2004] 网络改造", "background": "HURRICANE 小组原来构建的网络由网络上的交换机及其间的网路构成。交换机分级连接，最高级的为顶级的网关交换机，其他交换机分级相连到该网关交换机上。但值得注意的是，任一台非网关交换机与一台高一级的交换机直接相连。而任一台交换机均可以与几台低一级的交换机直接相连。\n\n但最近，由于原来架设的网络服务有限，需要把网络中的一些交换机（包括网关交换机）升级为核心交换机。由于改造的时间所限，只来得及把不超过 $p$ 台（含 $p$ 台）交换机升级为核心交换机，而所有剩下的交换机则需要通过改造网路的方法和这几台核心交换机直接连接。\n\n但是无论是升级交换机还是改造网络都需要花费一定的资金。现在请你给出一个改造网络的方案。使得按照该方案升级后每一个交换机要么是核心交换机，要么直接和核心交换机相连。并且要求提供的方案使改造所用的总费用最小。", "description": "你的程序必须根据给定的输入，给出符合题意的输出：\n\n+ 输入包括网络的拓扑结构，升级网络中每台交换机的费用，以及改造网络的费用，还有可以升级的交换机的最大数目 $p$；\n+ 你必须根据输入，找出一个升级的方案，满足升级后的核心交换机的数目不超过给定的可升级交换机最大值 $p$，且使得总费用最少；\n+ 其中总费用的计算包括两个部分:\n    - 一部分是升级交换机为核心交换机所需要的费用，该部分的费用按照所有的需要升级的交换机所需的费用之和来计算；\n    - 另一部分是改造网络所需要的费用，该部分的费用按照所有未升级的交换机到最近的核心交换机的网络路径距离之和来计算；\n    - **注意:** 当网络中没有任何交换机升级到核心交换机的时候，由于也没有交换机可以连接到核心交换机，所以我们定义此时的总费用为无穷大。", "inputFormat": "第一行为两个正整数 $n(n \\leq 400)$ 和 $p$，分别表示网络中交换机的数目（交换机按照 $1$ 到 $n$ 标号）和可升级交换机的最大值。接下来的 $n$ 行每行一个正整数 $c_i$，表示把标号为 $i$ 的交换机升级为核心交换机所需要的费用。\n\n接下来的 $n-1$ 行每行三个正整数 $i$、$j$、$d_{i,j}(d_{i,j}<20000)$，表示编号为 $j$ 的交换机为编号为 $i$ 的交换机的上层交换机，而 $d_{i,j}$ 表示两台交换机之间的网路距离。", "outputFormat": "你的输出第一行为一个整数 $M$，表示你的方案的最小总费用。接下来一行包括一个整数 $p_0$，表示你的方案所需要升级为核心交换机的交换机数目。", "hint": "#### 样例说明\n![](https://cdn.luogu.com.cn/upload/image_hosting/74nd663j.png)\n\n#### 评分方法\n本题目一共有十个测试点，每个测试点的分数为总分数的 $10\\%$。对于每个测试点来说，如果你的答案正确，那么你将得到该测试点全部的分数，否则得 $0$ 分。\n\n注意，本题目的测试数据中有 $8$ 个数据的 $n$ 不超过 $180$。", "locale": "zh-CN"}}}
{"pid": "P5794", "type": "P", "difficulty": 5, "samples": [["6 3\n1 1 1 3 0 1 2", "1 2 3 1 1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "THUSC"], "title": "[THUSC 2015] 解密运算", "background": "", "description": "对于一个长度为 $N$ 的字符串，我们在字符串的末尾添加一个特殊的字符 `.`。之后将字符串视为一个环，从位置 $1,2,3,...,N+1$ 为起点读出 $N+1$ 个字符，就能得到 $N+1$ 个字符串。\n\n比如对于字符串 `ABCAAA`，我们可以得到这 $N+1$ 个串：\n```plain\nABCAAA.\nBCAAA.A\nCAAA.AB\nAAA.ABC\nAA.ABCA\nA.ABCAA\n.ABCAAA\n```\n接着我们对得到的这 $N+1$ 个串按字典序从小到大进行排序（注意特殊字符 `.` 的字典序小于任何其他的字符）结果如下：\n```plain\n.ABCAAA\nA.ABCAA\nAA.ABCA\nAAA.ABC\nABCAAA.\nBCAAA.A\nCAAA.AB\n```\n最后，将排序好的 $N+1$ 个串的最后一个字符取出，按照顺序排成一个新的字符串，也就是上面这个表的最后一列，就是加密后的密文 `AAAC.AB`。\n\n请通过加密后的密文求出加密前的字符串。", "inputFormat": "第一行有两个整数 $N,M$，分别表示加密前的字符串长度和字符集大小，其中字符用整数 $1,2,3,...,M$ 编号，添加的特殊字符 `.` 用 $0$ 编号。\n\n第二行为 $N+1$ 个整数，表示加密后的字符串。", "outputFormat": "输出仅一行，包含 $N$ 个整数，用空格隔开，依次表示加密前字符串中每个字符的编号。", "hint": "对于第 $i$ 个测试点 ($i=1 \\sim 4$)，$N=5\\times (i+1),M\\leq 3$。\n\n对于第 $5\\sim 6$ 个测试点，$N,M\\leq 50$，字符串中字符互不相同。\n\n对于第 $7\\sim 8$ 个测试点，$N,M\\leq 1000$，字符串中字符互不相同。\n\n对于第 $9\\sim 12$ 个测试点，$N,M\\leq 1000$。\n\n对于第 $13\\sim 20$ 个测试点，$N,M\\leq 200000$。", "locale": "zh-CN", "translations": {"en": {"title": "[THUSC 2015] Decryption Operation", "background": "", "description": "For a string of length $N$, we append a special character `.` to the end of the string. Then we treat the string as a cycle. Starting from positions $1,2,3,\\ldots,N+1$, read $N+1$ characters each time, and we can obtain $N+1$ strings.\n\nFor example, for the string `ABCAAA`, we can get these $N+1$ strings:\n```plain\nABCAAA.\nBCAAA.A\nCAAA.AB\nAAA.ABC\nAA.ABCA\nA.ABCAA\n.ABCAAA\n```\nNext, we sort these $N+1$ strings in lexicographical order from small to large (note that the special character `.` is lexicographically smaller than any other character). The result is:\n```plain\n.ABCAAA\nA.ABCAA\nAA.ABCA\nAAA.ABC\nABCAAA.\nBCAAA.A\nCAAA.AB\n```\nFinally, take the last character of each of the sorted $N+1$ strings, and concatenate them in order into a new string. That is, the last column of the table above, which is the encrypted ciphertext `AAAC.AB`.\n\nPlease recover the string before encryption from the encrypted ciphertext.", "inputFormat": "The first line contains two integers $N,M$, representing the length of the string before encryption and the size of the character set. The characters are numbered by integers $1,2,3,\\ldots,M$, and the appended special character `.` is numbered by $0$.\n\nThe second line contains $N+1$ integers, representing the encrypted string.", "outputFormat": "Output a single line containing $N$ integers separated by spaces, representing the number of each character in the original string before encryption in order.", "hint": "For the $i$-th test point ($i=1 \\sim 4$), $N=5\\times (i+1),M\\leq 3$.\n\nFor test points $5\\sim 6$, $N,M\\leq 50$, and all characters in the string are distinct.\n\nFor test points $7\\sim 8$, $N,M\\leq 1000$, and all characters in the string are distinct.\n\nFor test points $9\\sim 12$, $N,M\\leq 1000$.\n\nFor test points $13\\sim 20$, $N,M\\leq 200000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUSC 2015] 解密运算", "background": "", "description": "对于一个长度为 $N$ 的字符串，我们在字符串的末尾添加一个特殊的字符 `.`。之后将字符串视为一个环，从位置 $1,2,3,...,N+1$ 为起点读出 $N+1$ 个字符，就能得到 $N+1$ 个字符串。\n\n比如对于字符串 `ABCAAA`，我们可以得到这 $N+1$ 个串：\n```plain\nABCAAA.\nBCAAA.A\nCAAA.AB\nAAA.ABC\nAA.ABCA\nA.ABCAA\n.ABCAAA\n```\n接着我们对得到的这 $N+1$ 个串按字典序从小到大进行排序（注意特殊字符 `.` 的字典序小于任何其他的字符）结果如下：\n```plain\n.ABCAAA\nA.ABCAA\nAA.ABCA\nAAA.ABC\nABCAAA.\nBCAAA.A\nCAAA.AB\n```\n最后，将排序好的 $N+1$ 个串的最后一个字符取出，按照顺序排成一个新的字符串，也就是上面这个表的最后一列，就是加密后的密文 `AAAC.AB`。\n\n请通过加密后的密文求出加密前的字符串。", "inputFormat": "第一行有两个整数 $N,M$，分别表示加密前的字符串长度和字符集大小，其中字符用整数 $1,2,3,...,M$ 编号，添加的特殊字符 `.` 用 $0$ 编号。\n\n第二行为 $N+1$ 个整数，表示加密后的字符串。", "outputFormat": "输出仅一行，包含 $N$ 个整数，用空格隔开，依次表示加密前字符串中每个字符的编号。", "hint": "对于第 $i$ 个测试点 ($i=1 \\sim 4$)，$N=5\\times (i+1),M\\leq 3$。\n\n对于第 $5\\sim 6$ 个测试点，$N,M\\leq 50$，字符串中字符互不相同。\n\n对于第 $7\\sim 8$ 个测试点，$N,M\\leq 1000$，字符串中字符互不相同。\n\n对于第 $9\\sim 12$ 个测试点，$N,M\\leq 1000$。\n\n对于第 $13\\sim 20$ 个测试点，$N,M\\leq 200000$。", "locale": "zh-CN"}}}
{"pid": "P5795", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 4\n7 6 5\n3\n1 2 1 2 2\n1 2 1 3 4\n2 3 2 3 4", "6\n5\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "THUSC"], "title": "[THUSC 2015] 异或运算", "background": "", "description": "给定长度为 $n$ 的数列 $X={x_1,x_2,...,x_n}$ 和长度为 $m$ 的数列 $Y={y_1,y_2,...,y_m}$，令矩阵 $A$ 中第 $i$ 行第 $j$ 列的值 $A_{i,j}=x_i\\ \\operatorname{xor}\\ y_j$，每次询问给定矩形区域 $i∈[u,d],j∈[l,r]$，找出第 $k$ 大的 $A_{i,j}$。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示两个数列的长度。\n\n第二行包含 $n$ 个非负整数 $x_i$。\n\n第三行包含 $m$ 个非负整数 $y_j$。\n\n第四行包含一个正整数 $p$，表示询问次数。\n\n随后 $p$ 行，每行均包含 $5$ 个正整数，用来描述一次询问，每行包含五个正整数 $u,d,l,r,k$，含义如题意所述。", "outputFormat": "共 $p$ 行，每行包含一个非负整数，表示此次询问的答案。", "hint": "对于 $100\\%$ 的数据\n\n- $0\\leq X_i,Y_j<2^{31}$,\n- $1\\leq u\\leq d\\leq n\\leq 1000$,\n- $1\\leq l\\leq r\\leq m\\leq 300000$,\n- $1\\leq k\\leq (d-u+1)\\times (r-l+1)$, $1\\leq p\\leq 500$。", "locale": "zh-CN", "translations": {"en": {"title": "[THUSC 2015] XOR Operation", "background": "", "description": "Given a sequence $X=\\{x_1,x_2,\\ldots,x_n\\}$ of length $n$ and a sequence $Y=\\{y_1,y_2,\\ldots,y_m\\}$ of length $m$, define a matrix $A$ where the value in row $i$ and column $j$ is $A_{i,j}=x_i\\ \\operatorname{xor}\\ y_j$.  \n\nFor each query, you are given a rectangular region $i\\in[u,d],\\, j\\in[l,r]$. Find the $k$-th largest value among all $A_{i,j}$ in this region.", "inputFormat": "The first line contains two positive integers $n,m$, representing the lengths of the two sequences.\n\nThe second line contains $n$ non-negative integers $x_i$.\n\nThe third line contains $m$ non-negative integers $y_j$.\n\nThe fourth line contains a positive integer $p$, representing the number of queries.\n\nThe next $p$ lines each contain five positive integers $u,d,l,r,k$, describing one query. The meanings are as stated above.", "outputFormat": "Output $p$ lines. Each line contains one non-negative integer, the answer to the corresponding query.", "hint": "For $100\\%$ of the data:\n\n- $0\\leq X_i,Y_j<2^{31}$.\n- $1\\leq u\\leq d\\leq n\\leq 1000$.\n- $1\\leq l\\leq r\\leq m\\leq 300000$.\n- $1\\leq k\\leq (d-u+1)\\times (r-l+1)$, $1\\leq p\\leq 500$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUSC 2015] 异或运算", "background": "", "description": "给定长度为 $n$ 的数列 $X={x_1,x_2,...,x_n}$ 和长度为 $m$ 的数列 $Y={y_1,y_2,...,y_m}$，令矩阵 $A$ 中第 $i$ 行第 $j$ 列的值 $A_{i,j}=x_i\\ \\operatorname{xor}\\ y_j$，每次询问给定矩形区域 $i∈[u,d],j∈[l,r]$，找出第 $k$ 大的 $A_{i,j}$。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示两个数列的长度。\n\n第二行包含 $n$ 个非负整数 $x_i$。\n\n第三行包含 $m$ 个非负整数 $y_j$。\n\n第四行包含一个正整数 $p$，表示询问次数。\n\n随后 $p$ 行，每行均包含 $5$ 个正整数，用来描述一次询问，每行包含五个正整数 $u,d,l,r,k$，含义如题意所述。", "outputFormat": "共 $p$ 行，每行包含一个非负整数，表示此次询问的答案。", "hint": "对于 $100\\%$ 的数据\n\n- $0\\leq X_i,Y_j<2^{31}$,\n- $1\\leq u\\leq d\\leq n\\leq 1000$,\n- $1\\leq l\\leq r\\leq m\\leq 300000$,\n- $1\\leq k\\leq (d-u+1)\\times (r-l+1)$, $1\\leq p\\leq 500$。", "locale": "zh-CN"}}}
{"pid": "P5796", "type": "P", "difficulty": 6, "samples": [["5 1\n1 2\n2 4\n3 4\n5 1\n5 3\n1 1", "6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2006", "重庆", "各省省选"], "title": "[CQOI2006] 移动棋子", "background": "", "description": "在一个 $n\\times n$ 的棋盘上有 $n$ 枚棋子。每次可以把一枚棋子往上、下、左、右方向之一移动一格，最后排成一行、一列或者主、副对角线上（因此一共有 $2n+2$ 条可能的目标状态），要求移动次数最小。\n\n棋盘上有一些位置是障碍，棋子在任何时候都不能经过。棋子的初始位置保证不在障碍物上。任两枚棋子不能在同时到达同一个格子。\n　　　　　　", "inputFormat": "第一行包含两个整数 $n$，$m$，表示棋子的个数（它也是棋盘的边长）和障碍的个数。\n\n以下 $n$ 行，每行两个整数 $x$ 和 $y$，表示第 $i$ 个棋子的坐标。（$1\\le x,y\\le n$）\n\n以下 $m$ 行，每行给出一个障碍物的坐标。保证这 $n+m$ 个坐标两两不重合。", "outputFormat": "输出仅包含一个整数，表示最小移动步数。如果无解，输出`-1`。", "hint": "【样例解释】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qs93n3f7.png)\n\n【数据范围】\n\n对于 $50\\%$ 的数据，$n\\le 15$，$m=0$；\n\n对于 $100\\%$ 的数据，$2\\le n\\le 50$，$0\\le m\\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2006] Moving Pieces", "background": "", "description": "On an $n \\times n$ chessboard there are $n$ pieces. Each time, you may move one piece one step in one of the four directions: up, down, left, or right. In the end, the pieces must form a single row, a single column, or lie on the main diagonal or the anti-diagonal (so there are $2n + 2$ possible target states in total). Find the minimum number of moves.\n\nSome cells on the board are obstacles, and a piece can never pass through them at any time. The initial positions of the pieces are guaranteed not to be on obstacles. No two pieces may end up on the same cell at the same time.", "inputFormat": "The first line contains two integers $n$ and $m$, representing the number of pieces (which is also the side length of the board) and the number of obstacles.\n\nThe next $n$ lines each contain two integers $x$ and $y$, representing the coordinates of the $i$-th piece ($1 \\le x, y \\le n$).\n\nThe next $m$ lines each contain the coordinates of an obstacle. It is guaranteed that these $n + m$ coordinates are all distinct.", "outputFormat": "Output a single integer, the minimum number of moves. If there is no solution, output `-1`.", "hint": "[Sample Explanation]\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qs93n3f7.png)\n\n[Constraints]\n\nFor $50\\%$ of the testdata, $n \\le 15$ and $m = 0$.\n\nFor $100\\%$ of the testdata, $2 \\le n \\le 50$ and $0 \\le m \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2006] 移动棋子", "background": "", "description": "在一个 $n\\times n$ 的棋盘上有 $n$ 枚棋子。每次可以把一枚棋子往上、下、左、右方向之一移动一格，最后排成一行、一列或者主、副对角线上（因此一共有 $2n+2$ 条可能的目标状态），要求移动次数最小。\n\n棋盘上有一些位置是障碍，棋子在任何时候都不能经过。棋子的初始位置保证不在障碍物上。任两枚棋子不能在同时到达同一个格子。\n　　　　　　", "inputFormat": "第一行包含两个整数 $n$，$m$，表示棋子的个数（它也是棋盘的边长）和障碍的个数。\n\n以下 $n$ 行，每行两个整数 $x$ 和 $y$，表示第 $i$ 个棋子的坐标。（$1\\le x,y\\le n$）\n\n以下 $m$ 行，每行给出一个障碍物的坐标。保证这 $n+m$ 个坐标两两不重合。", "outputFormat": "输出仅包含一个整数，表示最小移动步数。如果无解，输出`-1`。", "hint": "【样例解释】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qs93n3f7.png)\n\n【数据范围】\n\n对于 $50\\%$ 的数据，$n\\le 15$，$m=0$；\n\n对于 $100\\%$ 的数据，$2\\le n\\le 50$，$0\\le m\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5797", "type": "P", "difficulty": 6, "samples": [["7 5\n2 5 1 1 2 3 2", "5 5 7 -1 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "线段树", "ICPC", "SEERC"], "title": "[SEERC 2019] Max or Min", "background": "", "description": "Kevin 有 $n$ 个整数 $a_1, a_2, \\dots, a_n$ ，它们按**环形**排列。对于环上的数字，数字 $a_i$ 和 $a_{i+1} \\ (1 \\leq i < n)$ 是相邻的，且数字 $a_1$ 和 $a_n$ 是相邻的。因此，每个数字有恰好两个相邻的数字。\n\n在 $1$ 分钟内，Kevin 可以将 $a_i$ 修改为这 $3$ 个数字中的最小值或最大值：$a_i$ 以及它的两个相邻数字。例如，如果 $a_i=5$ 且 $a_i$ 的两个相邻数字为 $3$ 和 $2$，Kevin 修改 $a_i$ 为最小值后，$a_i$ 会变为 $2$；如果 Kevin 修改 $a_i$ 为最大值，$a_i$ 仍是 $5$。\n\n对于从 $1$ 到 $m$ 的每个整数 $x$，计算出让上述环上的数字都变为 $x$ 的最短时间。", "inputFormat": "第一行包含两个整数 $n$ 和 $m \\ (3 \\leq n \\leq 2 \\cdot 10^5, 1 \\leq m \\leq 2 \\cdot 10^5)$，代表环上的数字个数和需要计算答案的 $x$ 的范围。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\dots, a_n \\ (1 \\leq a_i \\leq m)$，代表环上的数字。", "outputFormat": "输出 $m$ 个整数。第 $i$ 个整数为将环上的所有数字变为 $i$ 的最短时间的分钟数，如果无论如何都无法将环上的所有整数变为 $i$，则第 $i$ 个整数应输出 $-1$。", "hint": "要让环上的所有整数都变为 $2$，Kevin 需要至少 $5$ 分钟。一种可行的修改方案为：\n\n1. 将 $a_6$ 修改为它与相邻数字中的最小值，即修改为 $2$；\n2. 将 $a_4$ 修改为它与相邻数字中的最大值，即修改为 $2$；\n3. 将 $a_3$ 修改为它与相邻数字中的最大值，即修改为 $5$；\n4. 将 $a_2$ 修改为它与相邻数字中的最小值，即修改为 $2$；\n5. 将 $a_3$ 修改为它与相邻数字中的最小值，即修改为 $2$。", "locale": "zh-CN", "translations": {"en": {"title": "[SEERC 2019] Max or Min", "background": "", "description": "Kevin has $n$ integers $a_1, a_2, \\dots, a_n$, arranged in a **circular** order. On the circle, the numbers $a_i$ and $a_{i+1}$ $(1 \\leq i < n)$ are adjacent, and $a_1$ and $a_n$ are adjacent. Therefore, each number has exactly two adjacent numbers.\n\nIn 1 minute, Kevin can change $a_i$ to the minimum or the maximum among these three numbers: $a_i$ and its two adjacent numbers. For example, if $a_i = 5$ and its two adjacent numbers are $3$ and $2$, then after changing $a_i$ to the minimum, $a_i$ becomes $2$; if Kevin changes $a_i$ to the maximum, then $a_i$ is still $5$.\n\nFor each integer $x$ from $1$ to $m$, compute the shortest time to make all numbers on the circle become $x$.", "inputFormat": "The first line contains two integers $n$ and $m$ $(3 \\leq n \\leq 2 \\cdot 10^5, 1 \\leq m \\leq 2 \\cdot 10^5)$, representing the number of integers on the circle and the range of $x$ for which answers are required.\n\nThe second line contains $n$ integers $a_1, a_2, \\dots, a_n$ $(1 \\leq a_i \\leq m)$, representing the numbers on the circle.", "outputFormat": "Output $m$ integers. The $i$-th integer is the minimum number of minutes needed to make all numbers on the circle equal to $i$. If it is impossible to make all integers become $i$, output $-1$ for the $i$-th integer.", "hint": "To make all integers on the circle become $2$, Kevin needs at least $5$ minutes. One feasible sequence of operations is:\n\n1. Change $a_6$ to the minimum among it and its adjacent numbers, i.e., change it to $2$.\n2. Change $a_4$ to the maximum among it and its adjacent numbers, i.e., change it to $2$.\n3. Change $a_3$ to the maximum among it and its adjacent numbers, i.e., change it to $5$.\n4. Change $a_2$ to the minimum among it and its adjacent numbers, i.e., change it to $2$.\n5. Change $a_3$ to the minimum among it and its adjacent numbers, i.e., change it to $2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SEERC 2019] Max or Min", "background": "", "description": "Kevin 有 $n$ 个整数 $a_1, a_2, \\dots, a_n$ ，它们按**环形**排列。对于环上的数字，数字 $a_i$ 和 $a_{i+1} \\ (1 \\leq i < n)$ 是相邻的，且数字 $a_1$ 和 $a_n$ 是相邻的。因此，每个数字有恰好两个相邻的数字。\n\n在 $1$ 分钟内，Kevin 可以将 $a_i$ 修改为这 $3$ 个数字中的最小值或最大值：$a_i$ 以及它的两个相邻数字。例如，如果 $a_i=5$ 且 $a_i$ 的两个相邻数字为 $3$ 和 $2$，Kevin 修改 $a_i$ 为最小值后，$a_i$ 会变为 $2$；如果 Kevin 修改 $a_i$ 为最大值，$a_i$ 仍是 $5$。\n\n对于从 $1$ 到 $m$ 的每个整数 $x$，计算出让上述环上的数字都变为 $x$ 的最短时间。", "inputFormat": "第一行包含两个整数 $n$ 和 $m \\ (3 \\leq n \\leq 2 \\cdot 10^5, 1 \\leq m \\leq 2 \\cdot 10^5)$，代表环上的数字个数和需要计算答案的 $x$ 的范围。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\dots, a_n \\ (1 \\leq a_i \\leq m)$，代表环上的数字。", "outputFormat": "输出 $m$ 个整数。第 $i$ 个整数为将环上的所有数字变为 $i$ 的最短时间的分钟数，如果无论如何都无法将环上的所有整数变为 $i$，则第 $i$ 个整数应输出 $-1$。", "hint": "要让环上的所有整数都变为 $2$，Kevin 需要至少 $5$ 分钟。一种可行的修改方案为：\n\n1. 将 $a_6$ 修改为它与相邻数字中的最小值，即修改为 $2$；\n2. 将 $a_4$ 修改为它与相邻数字中的最大值，即修改为 $2$；\n3. 将 $a_3$ 修改为它与相邻数字中的最大值，即修改为 $5$；\n4. 将 $a_2$ 修改为它与相邻数字中的最小值，即修改为 $2$；\n5. 将 $a_3$ 修改为它与相邻数字中的最小值，即修改为 $2$。", "locale": "zh-CN"}}}
{"pid": "P5798", "type": "P", "difficulty": 5, "samples": [["2 100 100\n100 100 10 10\n101 11 100 10", "110"], ["4 20 20\n40 1000 20 20\n6 6 5 5\n10 10 1 1\n10 10 1 1", "40"], ["2 20 5\n10 10 5 5\n10 10 5 5", "-1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2019", "ICPC", "SEERC"], "title": "[SEERC 2019] Level Up", "background": "", "description": "作为一个 MMORPG 粉，得知《魔兽世界：经典旧世》发布的 Steve 非常兴奋。他从发布的第一天就开始玩，现在离满级只差 $2$ 级了。当然，他现在没有刚开始玩那时那么有空，因此他想尽快升到满级。\n\n升第一个等级需要 $s_1$ 经验值。只有当他获得了这么多经验后，才能升到下一级，而第二个等级又需要 $s_2$ 经验值来升级。\n\nSteve 有一个有 $n$ 个任务的任务列表。他希望通过完成一些任务来升到满级。Steve 需要花 $t_i$ 分钟才能完成第 $i$ 个任务，这个任务会让他获得 $x_i$ 经验值。\n\n当 Steve 完成了一个任务后可以升级了，超过升级所需的那部分经验值将会计入下一等级。当他升了一级之后，第 $i$ 个任务可获得的经验值会减少为 $y_i$，而完成任务的时间也会减为 $r_i$。\n\n需要注意的是，Steve 完成了的任务**不能**重复接取，无论是否升级。\n\n已知任务列表中的任务信息，帮助 Steve 找出一个完成任务的顺序，使得他升到满级所需的时间最短。", "inputFormat": "第一行包含三个整数 $n, s_1, s_2 \\ (1 \\leq n, s_1, s_2 \\leq 500)$，代表任务的数量、升第一级所需的经验值和升第二级所需的经验值。 \n\n接下来的 $n$ 行每行包含四个整数 $x_i, t_i, y_i, r_i \\ (1 \\leq y_i < x_i \\leq 500, 1 \\leq r_i < t_i \\leq 10^9)$，代表第 $i$ 个任务获得的经验值、完成所需的时间、升一级之后获得的经验值和完成所需的时间。", "outputFormat": "输出一个整数，代表 Steve 升到满级所需的最短时间的分钟数，如果无论如何都无法升到满级，输出 $-1$。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[SEERC 2019] Level Up", "background": "", "description": "As an MMORPG fan, Steve was very excited to hear that *World of Warcraft: Classic* was released. He started playing on the first day of release, and now he is only $2$ levels away from reaching the maximum level. Of course, he does not have as much free time as when he first started, so he wants to reach the maximum level as quickly as possible.\n\nTo gain the first level, he needs $s_1$ experience points. Only after he has obtained that much experience can he level up, and the second level then requires another $s_2$ experience points to level up.\n\nSteve has a quest list with $n$ quests. He wants to reach the maximum level by completing some of these quests. Steve needs $t_i$ minutes to complete quest $i$, and this quest gives him $x_i$ experience points.\n\nWhen Steve completes a quest and can level up, any experience beyond what is required to level up will carry over to the next level. After he levels up once, the experience gained from quest $i$ decreases to $y_i$, and the time needed to complete it also decreases to $r_i$.\n\nNote that quests Steve has completed **cannot** be taken again, regardless of whether he has leveled up.\n\nGiven the information of the quests in the list, help Steve find an order of completing quests such that the total time needed to reach the maximum level is minimized.", "inputFormat": "The first line contains three integers $n, s_1, s_2 \\ (1 \\leq n, s_1, s_2 \\leq 500)$, representing the number of quests, the experience required to gain the first level, and the experience required to gain the second level.\n\nThe next $n$ lines each contain four integers $x_i, t_i, y_i, r_i \\ (1 \\leq y_i < x_i \\leq 500, 1 \\leq r_i < t_i \\leq 10^9)$, representing the experience gained from quest $i$, the time needed to complete it, the experience gained after leveling up once, and the time needed after leveling up once.", "outputFormat": "Output one integer, the minimum number of minutes Steve needs to reach the maximum level. If it is impossible to reach the maximum level no matter what, output $-1$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SEERC 2019] Level Up", "background": "", "description": "作为一个 MMORPG 粉，得知《魔兽世界：经典旧世》发布的 Steve 非常兴奋。他从发布的第一天就开始玩，现在离满级只差 $2$ 级了。当然，他现在没有刚开始玩那时那么有空，因此他想尽快升到满级。\n\n升第一个等级需要 $s_1$ 经验值。只有当他获得了这么多经验后，才能升到下一级，而第二个等级又需要 $s_2$ 经验值来升级。\n\nSteve 有一个有 $n$ 个任务的任务列表。他希望通过完成一些任务来升到满级。Steve 需要花 $t_i$ 分钟才能完成第 $i$ 个任务，这个任务会让他获得 $x_i$ 经验值。\n\n当 Steve 完成了一个任务后可以升级了，超过升级所需的那部分经验值将会计入下一等级。当他升了一级之后，第 $i$ 个任务可获得的经验值会减少为 $y_i$，而完成任务的时间也会减为 $r_i$。\n\n需要注意的是，Steve 完成了的任务**不能**重复接取，无论是否升级。\n\n已知任务列表中的任务信息，帮助 Steve 找出一个完成任务的顺序，使得他升到满级所需的时间最短。", "inputFormat": "第一行包含三个整数 $n, s_1, s_2 \\ (1 \\leq n, s_1, s_2 \\leq 500)$，代表任务的数量、升第一级所需的经验值和升第二级所需的经验值。 \n\n接下来的 $n$ 行每行包含四个整数 $x_i, t_i, y_i, r_i \\ (1 \\leq y_i < x_i \\leq 500, 1 \\leq r_i < t_i \\leq 10^9)$，代表第 $i$ 个任务获得的经验值、完成所需的时间、升一级之后获得的经验值和完成所需的时间。", "outputFormat": "输出一个整数，代表 Steve 升到满级所需的最短时间的分钟数，如果无论如何都无法升到满级，输出 $-1$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5799", "type": "P", "difficulty": 4, "samples": [["cbbabcacbb", "YES\nabbabcbccb"], ["aa", "NO"], ["afedbc", "YES\nafedbc"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "2019", "Special Judge", "构造", "ICPC", "SEERC"], "title": "[SEERC 2019] Cycle String?", "background": "", "description": "大法师给了 Alice 和 Bob 一个长度为 $2 \\cdot n$ 的环形字符串，这个环形字符串中没有重复的长为 $n$ 的子串。在一个环形字符串中，字符 $s_{i+1}$ 在 $s_i$之后，而 $s_1$ 在 $s_{2n}$ 之后。\n\n不幸的是，恶魔打乱了字符串中字符的顺序。帮助 Alice 和 Bob 将字符串还原成满足上述要求的原始字符串。", "inputFormat": "第一行包含一个长度为 $2 \\cdot n \\ (2 \\leq 2\\cdot n \\leq 1 \\ 000 \\ 000)$ 的字符串 $s$，字符串中只包含小写字母。", "outputFormat": "如果能够将字符串还原成满足要求的字符串，则在第一行输出 `NO`；如果无法还原，则在第一行输出 `YES`。\n\n如果有解，在第二行输出还原后的字符串。如果存在多解，输出任意一个即可。", "hint": "第一个样例中，还原后的字符串中的子串分别为：`abbab`、`bbabc`、`babcb`、`abcbc`、`bcbcc`、`cbccb`、`bccba`、`ccbab`、`babba`。\n\n注意到第一个样例的答案中并不含有重复的子串，但存在其他的答案也满足题目要求。因此答案不唯一，样例只提供了一种满足要求的输出。\n\n第二个样例中，无法将字符串还原为满足要求的原始字符串。\n\n第三个样例中，不需要做任何操作即满足要求。", "locale": "zh-CN", "translations": {"en": {"title": "[SEERC 2019] Cycle String?", "background": "", "description": "The Archmage gave Alice and Bob a cyclic string of length $2 \\cdot n$. In this cyclic string, there are no repeated substrings of length $n$. In a cyclic string, the character $s_{i+1}$ comes after $s_i$, and $s_1$ comes after $s_{2n}$.\n\nUnfortunately, the devil scrambled the order of the characters in the string. Help Alice and Bob restore the string to an original string that satisfies the requirement above.", "inputFormat": "The first line contains a string $s$ of length $2 \\cdot n \\ (2 \\leq 2 \\cdot n \\leq 1 \\ 000 \\ 000)$. The string contains only lowercase letters.", "outputFormat": "If the string can be restored to a string that satisfies the requirement, output `NO` in the first line. If it cannot be restored, output `YES` in the first line.\n\nIf a solution exists, output the restored string in the second line. If there are multiple solutions, output any one.", "hint": "In the first sample, the substrings in the restored string are: `abbab`, `bbabc`, `babcb`, `abcbc`, `bcbcc`, `cbccb`, `bccba`, `ccbab`, `babba`.\n\nNote that in the first sample output, there are no repeated substrings, but there are other outputs that also satisfy the requirement. Therefore, the answer is not unique, and the sample only provides one valid output.\n\nIn the second sample, it is impossible to restore the string to an original string that satisfies the requirement.\n\nIn the third sample, no operation is needed because the requirement is already satisfied.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SEERC 2019] Cycle String?", "background": "", "description": "大法师给了 Alice 和 Bob 一个长度为 $2 \\cdot n$ 的环形字符串，这个环形字符串中没有重复的长为 $n$ 的子串。在一个环形字符串中，字符 $s_{i+1}$ 在 $s_i$之后，而 $s_1$ 在 $s_{2n}$ 之后。\n\n不幸的是，恶魔打乱了字符串中字符的顺序。帮助 Alice 和 Bob 将字符串还原成满足上述要求的原始字符串。", "inputFormat": "第一行包含一个长度为 $2 \\cdot n \\ (2 \\leq 2\\cdot n \\leq 1 \\ 000 \\ 000)$ 的字符串 $s$，字符串中只包含小写字母。", "outputFormat": "如果能够将字符串还原成满足要求的字符串，则在第一行输出 `NO`；如果无法还原，则在第一行输出 `YES`。\n\n如果有解，在第二行输出还原后的字符串。如果存在多解，输出任意一个即可。", "hint": "第一个样例中，还原后的字符串中的子串分别为：`abbab`、`bbabc`、`babcb`、`abcbc`、`bcbcc`、`cbccb`、`bccba`、`ccbab`、`babba`。\n\n注意到第一个样例的答案中并不含有重复的子串，但存在其他的答案也满足题目要求。因此答案不唯一，样例只提供了一种满足要求的输出。\n\n第二个样例中，无法将字符串还原为满足要求的原始字符串。\n\n第三个样例中，不需要做任何操作即满足要求。", "locale": "zh-CN"}}}
{"pid": "P5800", "type": "P", "difficulty": 4, "samples": [["2 2\n18 1000 16 1\n5 3\n16 15", "1010"], ["2 2\n23 10 15 5\n2 2\n9 20", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "ICPC", "双指针 two-pointer", "SEERC"], "title": "[SEERC 2019] Life Transfer", "background": "*注：「feli」是当地货币单位。*", "description": "在大都市 Nekoresti 中，有 $n$ 个人已知年龄，第 $i$ 个人年龄为 $a_i$。现在他们享受着假期，所以他们决定去 Pisiev 游览一个著名的博物馆 Koshkseum。他们可以通过开车或骑摩托车去：\n\n- 一辆**车**可以载最多 $k$ 个人（包括一个年龄不低于 $l_c$ 岁的司机和至多 $k-1$ 个乘客）。一辆车的租金为 $p_c$ feli。\n- 一辆**摩托车**只能载 $1$ 个人（年龄不低于 $l_m$ 岁）。一辆摩托车的租金为 $p_m$ feli。\n\n不幸的是，这些人不是很富裕，所以他们请求一名当地的大魔法师 Mewlin 来帮助他们。通过使用一种强大的魔法 Mucadabra，Mewlin 可以转移人们的年龄。形式化地说，他可以减少一个年龄为 $x$ 的人的年龄，同时增加一个年龄为 $y$ 的人的年龄同一数值（这两个人的年龄之和不变）。完成 $1$ 岁的年龄的转移的花费是 $t$ feli。由于魔法的限制，魔法不能将一个人的年龄改变超过 $d$（如果一个人的年龄为 $x$，改变后的年龄只能在 $[x-d, x+d]$ 区间内）。并且，年龄也不能低于 $1$ 岁。\n\n帮助这些人花费最少的钱从 Nekoresti 到 Pisiev 去旅游吧。", "inputFormat": "第一行包含两个整数 $n$ 和 $k \\ (1 \\leq n, k \\leq 10^5)$，代表旅游的人数和一辆车的最大载客数。\n\n第二行包含四个整数 $l_c, p_c, l_m$ 和 $p_m \\ (1 \\leq l_m < l_c \\leq 10^5, 1 \\leq p_m < p_c \\leq 10^5)$，代表开车的最低年龄、一辆车的租金、骑摩托车的最低年龄、一辆摩托车的租金。\n\n第三行包含两个整数 $t$ 和 $d \\ (0 \\leq t, d \\leq 10^5)$，代表转移 $1$ 岁的年龄的花费和魔法的转移改变量限制。\n\n第四行包含 $n$ 个整数 $a_1, a_2, \\dots, a_n \\ (1 \\leq a_i \\leq 10^5)$，$a_i$ 代表第 $i$ 个人的年龄。", "outputFormat": "输出一个数字，即让所有人到达目的地的最小花费。如果无解，输出 $-1$。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[SEERC 2019] Life Transfer", "background": "*Note: “feli” is the local currency unit.*", "description": "In the metropolis Nekoresti, there are $n$ people with known ages. The age of the $i$-th person is $a_i$. They are enjoying their vacation, so they decide to visit Pisiev to tour a famous museum called Koshkseum. They can travel either by car or by motorcycle:\n\n- A **car** can carry up to $k$ people (including one driver whose age is at least $l_c$, and up to $k-1$ passengers). The rental cost of one car is $p_c$ feli.\n- A **motorcycle** can carry only $1$ person (whose age is at least $l_m$). The rental cost of one motorcycle is $p_m$ feli.\n\nUnfortunately, these people are not very wealthy, so they ask a local archmage, Mewlin, to help them. By using a powerful spell, Mucadabra, Mewlin can transfer people’s ages. Formally, he can decrease the age of a person with age $x$, while increasing the age of a person with age $y$ by the same amount (so the sum of the two ages stays unchanged). The cost to transfer $1$ year of age is $t$ feli. Due to the limits of the spell, the spell cannot change a person’s age by more than $d$ (if a person’s age is $x$, then the changed age can only be within $[x-d, x+d]$). Also, an age cannot be less than $1$.\n\nHelp them spend the least amount of money to travel from Nekoresti to Pisiev.", "inputFormat": "The first line contains two integers $n$ and $k$ $(1 \\leq n, k \\leq 10^5)$, representing the number of people traveling and the maximum capacity of one car.\n\nThe second line contains four integers $l_c, p_c, l_m$ and $p_m$ $(1 \\leq l_m < l_c \\leq 10^5, 1 \\leq p_m < p_c \\leq 10^5)$, representing the minimum age to drive, the rental cost of one car, the minimum age to ride a motorcycle, and the rental cost of one motorcycle.\n\nThe third line contains two integers $t$ and $d$ $(0 \\leq t, d \\leq 10^5)$, representing the cost to transfer $1$ year of age and the limit $d$ on how much the spell can change an age.\n\nThe fourth line contains $n$ integers $a_1, a_2, \\dots, a_n$ $(1 \\leq a_i \\leq 10^5)$, where $a_i$ is the age of the $i$-th person.", "outputFormat": "Output one number, the minimum total cost to get everyone to the destination. If there is no solution, output $-1$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SEERC 2019] Life Transfer", "background": "*注：「feli」是当地货币单位。*", "description": "在大都市 Nekoresti 中，有 $n$ 个人已知年龄，第 $i$ 个人年龄为 $a_i$。现在他们享受着假期，所以他们决定去 Pisiev 游览一个著名的博物馆 Koshkseum。他们可以通过开车或骑摩托车去：\n\n- 一辆**车**可以载最多 $k$ 个人（包括一个年龄不低于 $l_c$ 岁的司机和至多 $k-1$ 个乘客）。一辆车的租金为 $p_c$ feli。\n- 一辆**摩托车**只能载 $1$ 个人（年龄不低于 $l_m$ 岁）。一辆摩托车的租金为 $p_m$ feli。\n\n不幸的是，这些人不是很富裕，所以他们请求一名当地的大魔法师 Mewlin 来帮助他们。通过使用一种强大的魔法 Mucadabra，Mewlin 可以转移人们的年龄。形式化地说，他可以减少一个年龄为 $x$ 的人的年龄，同时增加一个年龄为 $y$ 的人的年龄同一数值（这两个人的年龄之和不变）。完成 $1$ 岁的年龄的转移的花费是 $t$ feli。由于魔法的限制，魔法不能将一个人的年龄改变超过 $d$（如果一个人的年龄为 $x$，改变后的年龄只能在 $[x-d, x+d]$ 区间内）。并且，年龄也不能低于 $1$ 岁。\n\n帮助这些人花费最少的钱从 Nekoresti 到 Pisiev 去旅游吧。", "inputFormat": "第一行包含两个整数 $n$ 和 $k \\ (1 \\leq n, k \\leq 10^5)$，代表旅游的人数和一辆车的最大载客数。\n\n第二行包含四个整数 $l_c, p_c, l_m$ 和 $p_m \\ (1 \\leq l_m < l_c \\leq 10^5, 1 \\leq p_m < p_c \\leq 10^5)$，代表开车的最低年龄、一辆车的租金、骑摩托车的最低年龄、一辆摩托车的租金。\n\n第三行包含两个整数 $t$ 和 $d \\ (0 \\leq t, d \\leq 10^5)$，代表转移 $1$ 岁的年龄的花费和魔法的转移改变量限制。\n\n第四行包含 $n$ 个整数 $a_1, a_2, \\dots, a_n \\ (1 \\leq a_i \\leq 10^5)$，$a_i$ 代表第 $i$ 个人的年龄。", "outputFormat": "输出一个数字，即让所有人到达目的地的最小花费。如果无解，输出 $-1$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5801", "type": "P", "difficulty": 5, "samples": [["4\n1 2\n2 3\n3 4", "Bob"], ["7\n2 1\n2 6\n1 3\n2 5\n7 2\n2 4", "Alice"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "ICPC", "SEERC"], "title": "[SEERC 2019] Game on a Tree", "background": "", "description": "Alice 和 Bob 在树上玩游戏。最初的时候，树上的所有节点都是白色的。\n\nAlice 先手，她可以任选一个节点并在该点上放置一个标记，该点变为黑色。在这之后，玩家轮流进行游戏，每一回合中玩家可以将标记从所在点移动到该点的白色祖先节点或儿子节点中，并将移动到的点变为黑色。无法进行移动的玩家即输。\n\n谁会赢得游戏呢？\n\n在有根树上，节点 $v$ 的*祖先节点*是指从树根到节点 $v$ 的路径上的任意点。\n\n在有根树上，节点 $v$ 的*儿子节点*是指满足节点 $v$ 在从树根到节点 $w$ 路径上的任意点 $w$。\n\n规定树的树根为点 $1$。", "inputFormat": "第一行包含一个整数 $n \\ (1 \\leq n \\leq 100 \\ 000)$，代表树的节点数。\n\n接下来的 $n-1$ 行中，每一行包含两个整数 $u$ 和 $v \\ (1 \\leq u, v \\leq n)$，代表树上的一条边 $(u, v)$。数据保证这些边会构成一棵树。", "outputFormat": "输出一行，如果 Alice 赢得了游戏，则输出 `Alice`，否则输出 `Bob`。", "hint": "第一组样例中，树的形态是 $4$ 个点的一条链，所以 Bob 总是可以把标记移到最后的白点上。\n\n第二组样例中，Alice 的最佳策略是先把标记放在点 $3$ 上，然后 $3$ 会变为黑色。Bob 只能移动标记到点 $1$ 上。Alice 可以选择点 $4, 5, 6$ 或 $7$ 来移动。Bob 只能选择 $2$。Alice 选择 $2$ 的任一白色子节点，Bob 就无法移动了。", "locale": "zh-CN", "translations": {"en": {"title": "[SEERC 2019] Game on a Tree", "background": "", "description": "Alice and Bob play a game on a tree. At the beginning, all nodes on the tree are white.\n\nAlice moves first. She may choose any node and place a token on it, and that node becomes black. After that, the players take turns. In each turn, the current player may move the token from its current node to a white ancestor of that node or to a white child of that node, and the node moved to becomes black. The player who cannot make a move loses.\n\nIn a rooted tree, an *ancestor* of a node $v$ is any node on the path from the root to node $v$.\n\nIn a rooted tree, a *child* of a node $v$ is a node $w$ such that $v$ is on the path from the root to $w$ and $v$ is the parent of $w$.\n\nThe root of the tree is node $1$.", "inputFormat": "The first line contains an integer $n \\ (1 \\leq n \\leq 100 \\ 000)$, the number of nodes in the tree.\n\nEach of the next $n-1$ lines contains two integers $u$ and $v \\ (1 \\leq u, v \\leq n)$, denoting an edge $(u, v)$ of the tree. The testdata guarantees that these edges form a tree.", "outputFormat": "Output one line. If Alice wins the game, output `Alice`; otherwise, output `Bob`.", "hint": "In the first sample, the tree is a chain of $4$ nodes, so Bob can always move the token to the last remaining white node.\n\nIn the second sample, Alice’s best strategy is to place the token on node $3$ first, and then node $3$ becomes black. Bob can only move the token to node $1$. Alice can choose node $4, 5, 6$ or $7$ to move to. Bob can then only choose node $2$. After Alice chooses any white child of node $2$, Bob will have no move.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SEERC 2019] Game on a Tree", "background": "", "description": "Alice 和 Bob 在树上玩游戏。最初的时候，树上的所有节点都是白色的。\n\nAlice 先手，她可以任选一个节点并在该点上放置一个标记，该点变为黑色。在这之后，玩家轮流进行游戏，每一回合中玩家可以将标记从所在点移动到该点的白色祖先节点或儿子节点中，并将移动到的点变为黑色。无法进行移动的玩家即输。\n\n谁会赢得游戏呢？\n\n在有根树上，节点 $v$ 的*祖先节点*是指从树根到节点 $v$ 的路径上的任意点。\n\n在有根树上，节点 $v$ 的*儿子节点*是指满足节点 $v$ 在从树根到节点 $w$ 路径上的任意点 $w$。\n\n规定树的树根为点 $1$。", "inputFormat": "第一行包含一个整数 $n \\ (1 \\leq n \\leq 100 \\ 000)$，代表树的节点数。\n\n接下来的 $n-1$ 行中，每一行包含两个整数 $u$ 和 $v \\ (1 \\leq u, v \\leq n)$，代表树上的一条边 $(u, v)$。数据保证这些边会构成一棵树。", "outputFormat": "输出一行，如果 Alice 赢得了游戏，则输出 `Alice`，否则输出 `Bob`。", "hint": "第一组样例中，树的形态是 $4$ 个点的一条链，所以 Bob 总是可以把标记移到最后的白点上。\n\n第二组样例中，Alice 的最佳策略是先把标记放在点 $3$ 上，然后 $3$ 会变为黑色。Bob 只能移动标记到点 $1$ 上。Alice 可以选择点 $4, 5, 6$ 或 $7$ 来移动。Bob 只能选择 $2$。Alice 选择 $2$ 的任一白色子节点，Bob 就无法移动了。", "locale": "zh-CN"}}}
