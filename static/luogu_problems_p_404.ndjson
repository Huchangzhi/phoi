{"pid": "P9195", "type": "P", "difficulty": 6, "samples": [["4 2\n1\n0\n1\n2", "4\n2 2\n1 1\n2 3\n1 2"], ["3 2\n2\n0\n1", "3\n1 2\n1 3\n2 1"], ["2 2\n0\n1", "-1"], ["5 3\n1\n0\n1\n0\n1", "9\n1 4\n1 5\n2 1\n2 1\n2 2\n1 1\n1 2\n2 3\n2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2016", "Special Judge", "构造", "JOI（日本）"], "title": "[JOI Open 2016] JOIRIS", "background": "**译自 [JOI Open 2016](https://contests.ioi-jp.org/open-2016/index.html) T1 「JOIRIS」**", "description": "JOIRIS 的游戏区域名叫「井」，是一个宽度为 $N$，高度足够大的矩形网格。位于左数第 $i$ 列，从下往上数第 $j$ 列的格子记作 $(i,j)$。游戏过程中，每个格子要不有一个方块，要不没有方块。\n\n开始时，在第 $i$ 列有且仅有 $(i,1), (i,2),\\cdots, (i, A_i)$ 有方块。\n\n接下来，$10^4$ 个 $1 \\times K$ 的骨牌一个个下落，玩家要依次放置骨牌。每次放置骨牌按照如下方式进行：\n\n玩家先选择骨牌是横向放置还是纵向放置。  \n- 若选择纵向，玩家还需再选择一个整数 $x$（$1 \\le x \\le N$）。一个骨牌会下落到第 $x$ 列最上方方块的上面一行。若第 $x$ 列没有方块，骨牌会下落到井底。  \n- 若选择横向，玩家还需再选择一个整数 $x$（$1 \\le x \\le N-K+1$）。一个骨牌会下落到第 $x$ 列至第 $x+K-1$ 列最上方方块的上面一行。若第 $x$ 列至第 $x+K-1$ 列没有方块，骨牌会下落到井底。\n\n每个骨牌停止下落后，系统将从井底往上逐行检查，如果有一行格子被方块填满，该行的所有方块都会消失，且上方的所有方块向下移动 $1$ 格。\n\n此时检查井中是否有方块，如果井中没有方块，游戏结束，玩家胜利，否则玩家开始放置下一个骨牌。\n\n保证开始时最底下一行没有被方块填满。请判断玩家能否胜利，如果可能，则输出一种方案。", "inputFormat": "输入共 $N + 1$ 行。\n\n第一行含有两个整数 $N,K$。  \n在接下来的 $N$ 行中，第 $i$ 行（$1 \\le i \\le N$）有一个整数 $A_i$。", "outputFormat": "如果玩家无法胜利，请输出一行一个 $-1$。\n\n否则请输出 $X+1$ 行，其中 $X$ 表示消去所有棋子所需要的步数：\n\n第一行包含一个整数 $X$。接下来第 $i$ 行（$1 \\le i \\le X$）表示你的方案。\n\n- 如果第 $i$ 个下落的骨牌纵向放置，输出两个整数，第一个整数为 $1$，第二个整数 $x$ 表示玩家放置零件的位置（如题目描述中所述）。\n- 如果第 $i$ 个下落的骨牌横向放置，输出两个整数，第一个整数为 $2$，第二个整数 $x$ 表示玩家放置零件的位置（如题目描述中所述）。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zi0vapef.png)\n\n\n### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n对于所有数据，$2\\le N\\le 50$，$1\\le K\\le N$，$0\\le A_i \\le 50$。\n\n- Subtask 1（15 points）：$K=2$ 且 $N$ 为奇数。\n- Subtask 2（15 points）：$K=2$ 且 $N$ 为偶数。\n- Subtask 3（15 points）：$K$ 能够整除 $N$。\n- Subtask 4（55 points）：没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI Open 2016] JOIRIS", "background": "**译自 [JOI Open 2016](https://contests.ioi-jp.org/open-2016/index.html) T1 「JOIRIS」**", "description": "JOIRIS 的游戏区域名叫「井」，是一个宽度为 $N$，高度足够大的矩形网格。位于左数第 $i$ 列，从下往上数第 $j$ 列的格子记作 $(i,j)$。游戏过程中，每个格子要不有一个方块，要不没有方块。\n\n开始时，在第 $i$ 列有且仅有 $(i,1), (i,2),\\cdots, (i, A_i)$ 有方块。\n\n接下来，$10^4$ 个 $1 \\times K$ 的骨牌一个个下落，玩家要依次放置骨牌。每次放置骨牌按照如下方式进行：\n\n玩家先选择骨牌是横向放置还是纵向放置。  \n- 若选择纵向，玩家还需再选择一个整数 $x$（$1 \\le x \\le N$）。一个骨牌会下落到第 $x$ 列最上方方块的上面一行。若第 $x$ 列没有方块，骨牌会下落到井底。  \n- 若选择横向，玩家还需再选择一个整数 $x$（$1 \\le x \\le N-K+1$）。一个骨牌会下落到第 $x$ 列至第 $x+K-1$ 列最上方方块的上面一行。若第 $x$ 列至第 $x+K-1$ 列没有方块，骨牌会下落到井底。\n\n每个骨牌停止下落后，系统将从井底往上逐行检查，如果有一行格子被方块填满，该行的所有方块都会消失，且上方的所有方块向下移动 $1$ 格。\n\n此时检查井中是否有方块，如果井中没有方块，游戏结束，玩家胜利，否则玩家开始放置下一个骨牌。\n\n保证开始时最底下一行没有被方块填满。请判断玩家能否胜利，如果可能，则输出一种方案。", "inputFormat": "输入共 $N + 1$ 行。\n\n第一行含有两个整数 $N,K$。  \n在接下来的 $N$ 行中，第 $i$ 行（$1 \\le i \\le N$）有一个整数 $A_i$。", "outputFormat": "如果玩家无法胜利，请输出一行一个 $-1$。\n\n否则请输出 $X+1$ 行，其中 $X$ 表示消去所有棋子所需要的步数：\n\n第一行包含一个整数 $X$。接下来第 $i$ 行（$1 \\le i \\le X$）表示你的方案。\n\n- 如果第 $i$ 个下落的骨牌纵向放置，输出两个整数，第一个整数为 $1$，第二个整数 $x$ 表示玩家放置零件的位置（如题目描述中所述）。\n- 如果第 $i$ 个下落的骨牌横向放置，输出两个整数，第一个整数为 $2$，第二个整数 $x$ 表示玩家放置零件的位置（如题目描述中所述）。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zi0vapef.png)\n\n\n### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n对于所有数据，$2\\le N\\le 50$，$1\\le K\\le N$，$0\\le A_i \\le 50$。\n\n- Subtask 1（15 points）：$K=2$ 且 $N$ 为奇数。\n- Subtask 2（15 points）：$K=2$ 且 $N$ 为偶数。\n- Subtask 3（15 points）：$K$ 能够整除 $N$。\n- Subtask 4（55 points）：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P9196", "type": "P", "difficulty": 6, "samples": [["2 3\nAUGC\nAGC\nG C\nAU C\nA C", "0\n1\n2"], ["3 3\nAA\nAA\nAGA\nAA AA\nAG GA\nAG GA", "2\n1\n1"], ["8 7\nGCGCUACCCCAACACAAGGCAAGAUAUA\nG\nGGAC\nGCGG\nU\nGCGCUACCCCAACACAAGGCAAGAUGGUC\nGCCG\nGCGCUGA\nGCGCUACCC A\nGCGCUACCCC AC\nGCG C\nGCGC A\nG G\nG C\nG GGA", "1\n0\n1\n2\n3\n2\n0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2016", "字典树 Trie", "AC 自动机", "JOI（日本）"], "title": "[JOI Open 2016] 销售基因链 / Selling RNA Strands", "background": "**译自 [JOI Open 2016](https://contests.ioi-jp.org/open-2016/index.html) T2 「RNA 鎖の販売 / Selling RNA Strands」**", "description": "基因库中有 $N$ 个字符串，这些字符串仅由 `A`，`G`，`U`，`C` 组成（保证每个字符串都仅包含这四种字母）。\n\n有 $M$ 组查询，每组查询包含两个字符串 $P,Q$，试求：基因库中有多少个字符串同时存在前缀 $P$ 和后缀 $Q$。\n\n举个例子，`GAC` 存在前缀 `G`、`GA`、`GAC`，存在后缀 `C`、`AC`、`GAC`，那么我们可以说：`GAC` 同时存在前缀 `GA` 和后缀 `AC`。", "inputFormat": "输入共 $N + M + 1$ 行。\n\n第一行有两个整数 $N, M$。  \n在接下来的 $N$ 行中，每行一个字符串 $S_i$，表示基因库中的一个字符串。  \n在接下来的 $M$ 行中，每行有两个用空格分隔的字符串，表示一组查询。", "outputFormat": "输出共 $M$ 行，每行一个整数，表示符合查询条件的字符串的数量。", "hint": "### 样例 1 解释\n\n第一组查询：无法找到；  \n第二组查询：`AUGC` 满足条件；  \n第三组查询：`AUGC` 和 `AGC` 满足条件。\n\n### 样例 2 解释\n\n注意基因库中的字符串可以重复。\n\n### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n对于所有数据，$1\\le N, M \\leq 10 ^ 5$，$1 \\leq |S_i|, |P_j|, |Q_j| \\le 10^5$，$1\\le\\sum |S_i|, \\sum |P_j|, \\sum |Q_j| \\le 2\\times 10^6$。\n\n- Subtask 1（10 points）：$N, M, |S_i|, |P_j|, |Q_j| \\le 100$。\n- Subtask 2（25 points）：$N, M\\le 5000$。\n- Subtask 3（25 points）：$\\sum |S_i|, \\sum|P_j|, \\sum |Q_j| \\le 10^5$。\n- Subtask 4（40 points）：没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI Open 2016] 销售基因链 / Selling RNA Strands", "background": "**译自 [JOI Open 2016](https://contests.ioi-jp.org/open-2016/index.html) T2 「RNA 鎖の販売 / Selling RNA Strands」**", "description": "基因库中有 $N$ 个字符串，这些字符串仅由 `A`，`G`，`U`，`C` 组成（保证每个字符串都仅包含这四种字母）。\n\n有 $M$ 组查询，每组查询包含两个字符串 $P,Q$，试求：基因库中有多少个字符串同时存在前缀 $P$ 和后缀 $Q$。\n\n举个例子，`GAC` 存在前缀 `G`、`GA`、`GAC`，存在后缀 `C`、`AC`、`GAC`，那么我们可以说：`GAC` 同时存在前缀 `GA` 和后缀 `AC`。", "inputFormat": "输入共 $N + M + 1$ 行。\n\n第一行有两个整数 $N, M$。  \n在接下来的 $N$ 行中，每行一个字符串 $S_i$，表示基因库中的一个字符串。  \n在接下来的 $M$ 行中，每行有两个用空格分隔的字符串，表示一组查询。", "outputFormat": "输出共 $M$ 行，每行一个整数，表示符合查询条件的字符串的数量。", "hint": "### 样例 1 解释\n\n第一组查询：无法找到；  \n第二组查询：`AUGC` 满足条件；  \n第三组查询：`AUGC` 和 `AGC` 满足条件。\n\n### 样例 2 解释\n\n注意基因库中的字符串可以重复。\n\n### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n对于所有数据，$1\\le N, M \\leq 10 ^ 5$，$1 \\leq |S_i|, |P_j|, |Q_j| \\le 10^5$，$1\\le\\sum |S_i|, \\sum |P_j|, \\sum |Q_j| \\le 2\\times 10^6$。\n\n- Subtask 1（10 points）：$N, M, |S_i|, |P_j|, |Q_j| \\le 100$。\n- Subtask 2（25 points）：$N, M\\le 5000$。\n- Subtask 3（25 points）：$\\sum |S_i|, \\sum|P_j|, \\sum |Q_j| \\le 10^5$。\n- Subtask 4（40 points）：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P9197", "type": "P", "difficulty": 6, "samples": [["4 10\n3 6 2 9", "6"], ["8 35\n3 7 1 5 10 2 11 6", "31384"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2016", "JOI（日本）"], "title": "[JOI Open 2016] 摩天大楼 / Skyscraper", "background": "**译自 [JOI Open 2016](https://contests.ioi-jp.org/open-2016/index.html) T3 「高層ビル街 / Skyscraper」**", "description": "将互不相同的 $N$ 个整数 $A_1, A_2, \\cdots, A_N$ 按照一定顺序排列。\n\n假设排列为 $f_1, f_2, \\cdots, f_N$，要求：$| f_1 - f_2| + | f_2 - f_3| + \\cdots + | f_{N-1} - f_N| \\leq L$。\n\n求满足题意的排列的方案数对 $10^9+7$ 取模后的结果。", "inputFormat": "输入共两行。\n\n第一行有两个整数 $N, L$。  \n第二行有 $N$ 个整数 $A_1, A_2, \\cdots, A_N$。", "outputFormat": "输出共一行一个整数，表示方案数对 $10^9+7$ 取模后的结果。", "hint": "### 样例 1 解释\n\n满足条件的六种方案分别为：\n$$\n\\begin{matrix}\n2\\ 3\\ 6\\ 9,& |2 - 3| + |3 - 6| + |6 - 9| &=& 7 \\\\\n2\\ 3\\ 9\\ 6,& |2 - 3| + |3 - 9| + |9 - 6| &=& 10 \\\\\n3\\ 2\\ 6\\ 9,& |3 - 2| + |2 - 6| + |6 - 9| &=& 8 \\\\\n6\\ 9\\ 3\\ 2,& |6 - 9| + |9 - 3| + |3 - 2| &=& 10 \\\\\n9\\ 6\\ 2\\ 3,& |9 - 6| + |6 - 2| + |2 - 3| &=& 8 \\\\\n9\\ 6\\ 3\\ 2,& |9 - 6| + |6 - 3| + |3 - 2| &=& 7 \\\\\n\\end{matrix}\n$$\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le N\\le 100$，$1\\le L\\le 1000$，$1\\le A_i\\le 1000$。\n\n- Subtask 1（5 points）：$N\\le 8$。\n- Subtask 2（15 points）：$N\\le 14$，$L\\le 100$。\n- Subtask 3（80 points）：没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI Open 2016] 摩天大楼 / Skyscraper", "background": "**译自 [JOI Open 2016](https://contests.ioi-jp.org/open-2016/index.html) T3 「高層ビル街 / Skyscraper」**", "description": "将互不相同的 $N$ 个整数 $A_1, A_2, \\cdots, A_N$ 按照一定顺序排列。\n\n假设排列为 $f_1, f_2, \\cdots, f_N$，要求：$| f_1 - f_2| + | f_2 - f_3| + \\cdots + | f_{N-1} - f_N| \\leq L$。\n\n求满足题意的排列的方案数对 $10^9+7$ 取模后的结果。", "inputFormat": "输入共两行。\n\n第一行有两个整数 $N, L$。  \n第二行有 $N$ 个整数 $A_1, A_2, \\cdots, A_N$。", "outputFormat": "输出共一行一个整数，表示方案数对 $10^9+7$ 取模后的结果。", "hint": "### 样例 1 解释\n\n满足条件的六种方案分别为：\n$$\n\\begin{matrix}\n2\\ 3\\ 6\\ 9,& |2 - 3| + |3 - 6| + |6 - 9| &=& 7 \\\\\n2\\ 3\\ 9\\ 6,& |2 - 3| + |3 - 9| + |9 - 6| &=& 10 \\\\\n3\\ 2\\ 6\\ 9,& |3 - 2| + |2 - 6| + |6 - 9| &=& 8 \\\\\n6\\ 9\\ 3\\ 2,& |6 - 9| + |9 - 3| + |3 - 2| &=& 10 \\\\\n9\\ 6\\ 2\\ 3,& |9 - 6| + |6 - 2| + |2 - 3| &=& 8 \\\\\n9\\ 6\\ 3\\ 2,& |9 - 6| + |6 - 3| + |3 - 2| &=& 7 \\\\\n\\end{matrix}\n$$\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le N\\le 100$，$1\\le L\\le 1000$，$1\\le A_i\\le 1000$。\n\n- Subtask 1（5 points）：$N\\le 8$。\n- Subtask 2（15 points）：$N\\le 14$，$L\\le 100$。\n- Subtask 3（80 points）：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P9198", "type": "P", "difficulty": 1, "samples": [["6 6 9\n1 2 3 4\n5 6 3 4\n1 5 3 4\n5 1 3 4\n1 3 2 260\n1 4 2 4\n2 2 3 5\n2 5 3 7\n2 2 3 258", "No\nNo\nNo\nYes\nNo\nYes\nNo\nNo\nYes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "洛谷原创", "O2优化", "洛谷月赛"], "title": "「GMOI R2-T1」轴对称", "background": "", "description": "你有一个 $n$ 行 $m$ 列的图片（矩阵），该图片的像素为 $n\\times m$。\n\n初始时，所有像素块均为黑色，RGB 是 $(0,0,0)$。每一次操作可以将一个像素块的 RGB 中的一个数字改变。\n\n在每次操作过后，请你输出图片是否左右对称？\n\n左右对称：即对于任何的 $i,j$，总满足第 $i$ 行第 $j$ 列的像素与第 $i$ 行第 $m-j+1$ 列的像素的 RGB 值相等。 ", "inputFormat": "第一行三个整数 $n,m,q$，$q$ 代表操作次数。\n\n接下来 $q$ 行，每行输入四个整数 $i,j,t,c$，表示将第 $i$ 行第 $j$ 列的格子的 RGB 值的第 $t$ 个数增加 $c$，任何一个 RGB 值的任何一个数如果超出 $255$ 则自动对 $256$ 取模。", "outputFormat": "每次操作过后，如果图片左右对称，输出 `Yes`，否则输出 `No`。每组询问的输出之间用换行隔开。", "hint": "**本题使用 Subtask 捆绑测试。**\n\n| Subtask | $n\\le$ | $m\\le$ | $q\\le$ | $t\\le$ | $c\\le$ | 对应测试点 | 总分 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $10$ | $2$ | $50$ | $1$ | $255$ | $1\\sim2$ | $10$ |\n| $1$ | $100$ | $2$ | $500$ | $3$ | $10^9$ | $3\\sim4$ | $15$ |\n| $2$ | $100$ | $100$ | $500$ | $3$ | $10^9$ | $5\\sim6$ | $15$ |\n| $3$ | $100$ | $100$ | $1$ | $3$ | $10^9$ | $7\\sim9$ | $15$ |\n| $4$ | $100$ | $100$ | $500$ | $3$ | $10^9$ | $10\\sim12$ | $45$ |\n\n**对于 Subtask 2**，保证每个变量等概率随机生成。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 100$，$1\\le q\\le 500$，$1\\le i\\le n$，$1\\le j\\le m$，$t\\in \\{1,2,3\\}$，$1\\le c\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「GMOI R2-T1」轴对称", "background": "", "description": "你有一个 $n$ 行 $m$ 列的图片（矩阵），该图片的像素为 $n\\times m$。\n\n初始时，所有像素块均为黑色，RGB 是 $(0,0,0)$。每一次操作可以将一个像素块的 RGB 中的一个数字改变。\n\n在每次操作过后，请你输出图片是否左右对称？\n\n左右对称：即对于任何的 $i,j$，总满足第 $i$ 行第 $j$ 列的像素与第 $i$ 行第 $m-j+1$ 列的像素的 RGB 值相等。 ", "inputFormat": "第一行三个整数 $n,m,q$，$q$ 代表操作次数。\n\n接下来 $q$ 行，每行输入四个整数 $i,j,t,c$，表示将第 $i$ 行第 $j$ 列的格子的 RGB 值的第 $t$ 个数增加 $c$，任何一个 RGB 值的任何一个数如果超出 $255$ 则自动对 $256$ 取模。", "outputFormat": "每次操作过后，如果图片左右对称，输出 `Yes`，否则输出 `No`。每组询问的输出之间用换行隔开。", "hint": "**本题使用 Subtask 捆绑测试。**\n\n| Subtask | $n\\le$ | $m\\le$ | $q\\le$ | $t\\le$ | $c\\le$ | 对应测试点 | 总分 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $10$ | $2$ | $50$ | $1$ | $255$ | $1\\sim2$ | $10$ |\n| $1$ | $100$ | $2$ | $500$ | $3$ | $10^9$ | $3\\sim4$ | $15$ |\n| $2$ | $100$ | $100$ | $500$ | $3$ | $10^9$ | $5\\sim6$ | $15$ |\n| $3$ | $100$ | $100$ | $1$ | $3$ | $10^9$ | $7\\sim9$ | $15$ |\n| $4$ | $100$ | $100$ | $500$ | $3$ | $10^9$ | $10\\sim12$ | $45$ |\n\n**对于 Subtask 2**，保证每个变量等概率随机生成。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 100$，$1\\le q\\le 500$，$1\\le i\\le n$，$1\\le j\\le m$，$t\\in \\{1,2,3\\}$，$1\\le c\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P9199", "type": "P", "difficulty": 3, "samples": [["5 2\n1 0 1 3 0", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "洛谷原创", "O2优化", "构造", "洛谷月赛"], "title": "「GMOI R2-T2」猫耳小", "background": "**本题与 [加强版](https://www.luogu.com.cn/problem/P9202) 的区别在于数据范围和输出格式。在这一版本中，$n\\le 5\\times 10^3$，值域为 $5\\times 10^3$，你不需要给出构造。**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r8a6ylx3.png)", "description": "小 R 是一个可爱的猫耳女孩子，她喜欢研究数列的 $\\operatorname{mex}\\text{*}$。\n\n现在她有一个长度为 $n$ 的数列 $a$。她讨厌整数 $k$，因此她希望修改数列 $a$ 的若干个元素为任意**自然数**，使得 $a$ 的任意**连续非空子串**的 $\\operatorname{mex}$ 都不等于 $k$。\n\n请你求出最少需要修改多少个元素。\n\n$\\text{*}$ 本题中，数列的 $\\operatorname{mex}$ 被定义为数列中最小未出现的**自然数**，例如：\n\n- $\\operatorname{mex}\\{1,2,3\\}=0$，因为 $0$ 是自然数。\n- $\\operatorname{mex}\\{0,1,3\\}=2$。\n- $\\operatorname{mex}\\{0,1,2\\}=3$。", "inputFormat": "第一行两个整数 $n,k$，表示数列长度和小 R 讨厌的数。\n\n第二行 $n$ 个整数，第 $i$ 个整数为 $a_i$，表示这个数列的第 $i$ 项。", "outputFormat": "一行一个整数，表示最少需要修改的元素个数。", "hint": "**样例解释**\n\n一种方案是将 $\\{1,0,1,3,0\\}$ 改为 $\\{1,1,1,3,2\\}$，共改动两个元素。\n\n可以证明不存在更优的方案。\n\n---\n\n**本题使用 Subtask 捆绑测试。**\n\n| Subtask | $n\\le$ | $k\\le$ | $a_i\\le$ | 特殊性质 | 对应测试点 | 总分 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $6$ | $6$ | $6$ | $-$ | $1\\sim 2$ | $10$ |\n| $1$ | $100$ | $5\\times 10^3$ | $5\\times 10^3$ | $-$ | $3\\sim 5$ | $20$ |\n| $2$ | $5\\times 10^3$ | $1$ | $5\\times 10^3$ | $-$ | $6\\sim 10$ | $20$ |\n| $3$ | $5\\times 10^3$ | $5\\times 10^3$ | $5\\times 10^3$ | $\\bf A$ | $11\\sim 15$ | $20$ |\n| $4$ | $5\\times 10^3$ | $5\\times 10^3$ | $5\\times 10^3$ | $-$ | $16\\sim 20$ | $30$ |\n\n特殊性质 $\\bf A$：保证 $a_i < k$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^3$，$0\\le k,a_i\\le 5\\times 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「GMOI R2-T2」猫耳小", "background": "**本题与 [加强版](https://www.luogu.com.cn/problem/P9202) 的区别在于数据范围和输出格式。在这一版本中，$n\\le 5\\times 10^3$，值域为 $5\\times 10^3$，你不需要给出构造。**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r8a6ylx3.png)", "description": "小 R 是一个可爱的猫耳女孩子，她喜欢研究数列的 $\\operatorname{mex}\\text{*}$。\n\n现在她有一个长度为 $n$ 的数列 $a$。她讨厌整数 $k$，因此她希望修改数列 $a$ 的若干个元素为任意**自然数**，使得 $a$ 的任意**连续非空子串**的 $\\operatorname{mex}$ 都不等于 $k$。\n\n请你求出最少需要修改多少个元素。\n\n$\\text{*}$ 本题中，数列的 $\\operatorname{mex}$ 被定义为数列中最小未出现的**自然数**，例如：\n\n- $\\operatorname{mex}\\{1,2,3\\}=0$，因为 $0$ 是自然数。\n- $\\operatorname{mex}\\{0,1,3\\}=2$。\n- $\\operatorname{mex}\\{0,1,2\\}=3$。", "inputFormat": "第一行两个整数 $n,k$，表示数列长度和小 R 讨厌的数。\n\n第二行 $n$ 个整数，第 $i$ 个整数为 $a_i$，表示这个数列的第 $i$ 项。", "outputFormat": "一行一个整数，表示最少需要修改的元素个数。", "hint": "**样例解释**\n\n一种方案是将 $\\{1,0,1,3,0\\}$ 改为 $\\{1,1,1,3,2\\}$，共改动两个元素。\n\n可以证明不存在更优的方案。\n\n---\n\n**本题使用 Subtask 捆绑测试。**\n\n| Subtask | $n\\le$ | $k\\le$ | $a_i\\le$ | 特殊性质 | 对应测试点 | 总分 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $6$ | $6$ | $6$ | $-$ | $1\\sim 2$ | $10$ |\n| $1$ | $100$ | $5\\times 10^3$ | $5\\times 10^3$ | $-$ | $3\\sim 5$ | $20$ |\n| $2$ | $5\\times 10^3$ | $1$ | $5\\times 10^3$ | $-$ | $6\\sim 10$ | $20$ |\n| $3$ | $5\\times 10^3$ | $5\\times 10^3$ | $5\\times 10^3$ | $\\bf A$ | $11\\sim 15$ | $20$ |\n| $4$ | $5\\times 10^3$ | $5\\times 10^3$ | $5\\times 10^3$ | $-$ | $16\\sim 20$ | $30$ |\n\n特殊性质 $\\bf A$：保证 $a_i < k$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^3$，$0\\le k,a_i\\le 5\\times 10^3$。", "locale": "zh-CN"}}}
{"pid": "P9200", "type": "P", "difficulty": 6, "samples": [["3\n1 3 2 2\n3 -5 1", "9"], ["12\n4 7 7 8 8 4 5 5 9 10 1 1 10 \n0 -5 7 8 1 -1 -6 8 2 4 10 8 ", "509"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "线段树", "二分", "树状数组", "洛谷原创", "O2优化", "枚举", "洛谷月赛"], "title": "「GMOI R2-T3」粒子环游", "background": "热爱珂学的小 Z 正在进行一项无聊的实验。", "description": "实验室中有一个由 $n$ 个实验腔连接而成的环形轨道，其中第 $i$ 个实验腔顺时针连向第 $i+1$ 个实验腔（特别的，第 $n$ 个实验腔连向第 $1$ 个实验腔）。同时还有一个标号为 $n+1$ 的新建实验腔要接入这个环形轨道。它可以接在任意两个原本相连的实验腔之间。\n\n第 $i$ 个实验腔可以将带电荷量为 $Q$ 的粒子运输到它的下一个实验腔，这个过程花费的能量为 $\\vert Q \\vert \\times c_i$。除此之外，第 $i$ 个实验腔本身就存储了量为 $e_i$ 的电荷（电荷量有正负）。由于众所周知的电荷守恒定律，第 $n+1$ 个实验腔储存的电荷量与前 $n$ 个实验腔储存的总电荷量的代数和为 $0$。\n\n小 Z 有一个原本不带电的粒子。等到第 $n+1$ 个实验腔接入轨道后，他要任选一个实验腔（包括第 $n+1$ 个）作为出发点，将粒子放入，并使之在实验腔的能量驱动下顺时针环游一周回到出发点。粒子每到达一个实验腔（包括出发点），它所带电荷量就会变成原来所带的电荷量和这个实验腔所储存的电荷量的代数和。\n\n**注意：电荷量会先加上实验腔所含电荷量，再计算能量贡献。**\n\n现在，小 Z 想知道，在所有接入新建实验腔并选定出发点的方案中，粒子环游一周所需的能量最少为多少？", "inputFormat": "第一行为一个正整数 $n$ ，表示环形轨道原有实验腔数。\n\n第二行有 $n+1$ 个非负整数，依次表示 $c_1,c_2,...,c_{n+1}$。\n\n第三行有 $n$ 个整数，依次表示 $e_1,e_2,...,e_{n}$。", "outputFormat": "输出共一行，包括一个数，表示粒子环游一周所需的最少能量。", "hint": "样例 $1$ 解释：一种最优方案为将 $4$ 号实验腔接在 $3$ 号实验腔与 $1$ 号实验腔之间，以 $4$ 号实验腔为出发点，花费能量为 $ 1\\times 2\\ +\\ 4\\times 1\\ + \\vert -1 \\vert \\times 3 \\ +\\ 0 \\times 2 =9$。\n\n**本题采用 Subtask 捆绑测试。**\n\n| Subtask | $n\\le$ | $c_i\\le$ | $\\vert e_i\\vert$ | 特殊性质 | 对应测试点 | 总分 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $300$ | $100$ | $100$ | $-$ | $1\\sim 5$ | $10$ |\n| $1$ | $10^3$ | $10^3$ | $10^3$ | $\\bf A$ | $6\\sim 7$ | $5$ |\n| $2$ | $10^4$ | $10^4$ | $10^4$ | $-$ | $8\\sim12$ | $15$ |\n| $3$ | $10^5$ | $10^5$ | $10^5$ | $\\bf B$ | $13\\sim 16$ | $10$ |\n| $4$ | $2.5\\times 10^5$ | $10^5$ |$10^5$ | $-$ | $17\\sim 25$ | $60$ |\n\n特殊性质 $\\bf A$：对于所有的 $i\\in[1,n+1](i\\in \\Z)$，满足 $c_i=0$。\n\n特殊性质 $\\bf B$：对于所有的 $i\\in[1,n+1](i\\in \\Z)$，满足 $c_i=1$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 2.5\\times 10^5$，$0\\le c_i\\le 10^5$，$0\\le |e_i|\\le 10^5$。\n\n保证答案在 long long 范围内。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「GMOI R2-T3」粒子环游", "background": "热爱珂学的小 Z 正在进行一项无聊的实验。", "description": "实验室中有一个由 $n$ 个实验腔连接而成的环形轨道，其中第 $i$ 个实验腔顺时针连向第 $i+1$ 个实验腔（特别的，第 $n$ 个实验腔连向第 $1$ 个实验腔）。同时还有一个标号为 $n+1$ 的新建实验腔要接入这个环形轨道。它可以接在任意两个原本相连的实验腔之间。\n\n第 $i$ 个实验腔可以将带电荷量为 $Q$ 的粒子运输到它的下一个实验腔，这个过程花费的能量为 $\\vert Q \\vert \\times c_i$。除此之外，第 $i$ 个实验腔本身就存储了量为 $e_i$ 的电荷（电荷量有正负）。由于众所周知的电荷守恒定律，第 $n+1$ 个实验腔储存的电荷量与前 $n$ 个实验腔储存的总电荷量的代数和为 $0$。\n\n小 Z 有一个原本不带电的粒子。等到第 $n+1$ 个实验腔接入轨道后，他要任选一个实验腔（包括第 $n+1$ 个）作为出发点，将粒子放入，并使之在实验腔的能量驱动下顺时针环游一周回到出发点。粒子每到达一个实验腔（包括出发点），它所带电荷量就会变成原来所带的电荷量和这个实验腔所储存的电荷量的代数和。\n\n**注意：电荷量会先加上实验腔所含电荷量，再计算能量贡献。**\n\n现在，小 Z 想知道，在所有接入新建实验腔并选定出发点的方案中，粒子环游一周所需的能量最少为多少？", "inputFormat": "第一行为一个正整数 $n$ ，表示环形轨道原有实验腔数。\n\n第二行有 $n+1$ 个非负整数，依次表示 $c_1,c_2,...,c_{n+1}$。\n\n第三行有 $n$ 个整数，依次表示 $e_1,e_2,...,e_{n}$。", "outputFormat": "输出共一行，包括一个数，表示粒子环游一周所需的最少能量。", "hint": "样例 $1$ 解释：一种最优方案为将 $4$ 号实验腔接在 $3$ 号实验腔与 $1$ 号实验腔之间，以 $4$ 号实验腔为出发点，花费能量为 $ 1\\times 2\\ +\\ 4\\times 1\\ + \\vert -1 \\vert \\times 3 \\ +\\ 0 \\times 2 =9$。\n\n**本题采用 Subtask 捆绑测试。**\n\n| Subtask | $n\\le$ | $c_i\\le$ | $\\vert e_i\\vert$ | 特殊性质 | 对应测试点 | 总分 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $300$ | $100$ | $100$ | $-$ | $1\\sim 5$ | $10$ |\n| $1$ | $10^3$ | $10^3$ | $10^3$ | $\\bf A$ | $6\\sim 7$ | $5$ |\n| $2$ | $10^4$ | $10^4$ | $10^4$ | $-$ | $8\\sim12$ | $15$ |\n| $3$ | $10^5$ | $10^5$ | $10^5$ | $\\bf B$ | $13\\sim 16$ | $10$ |\n| $4$ | $2.5\\times 10^5$ | $10^5$ |$10^5$ | $-$ | $17\\sim 25$ | $60$ |\n\n特殊性质 $\\bf A$：对于所有的 $i\\in[1,n+1](i\\in \\Z)$，满足 $c_i=0$。\n\n特殊性质 $\\bf B$：对于所有的 $i\\in[1,n+1](i\\in \\Z)$，满足 $c_i=1$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 2.5\\times 10^5$，$0\\le c_i\\le 10^5$，$0\\le |e_i|\\le 10^5$。\n\n保证答案在 long long 范围内。", "locale": "zh-CN"}}}
{"pid": "P9201", "type": "P", "difficulty": 7, "samples": [["4 3\n1 010\n2 001\n3 000\n3 001", "52"], ["5 4\n1 1000\n4 0100\n1 0000\n2 0001\n2 0000", "128"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "O2优化", "动态树 LCT", "扫描线", "基环树", "洛谷月赛", "分类讨论"], "title": "「GMOI R2-T4」电子木鱼", "background": "运营电子资本，招聘赛博佛祖，积累虚拟功德。\n\n功德无量，随喜赞叹。\n\n111", "description": "给你 $n$，表示一共有 $n$ 位赛博佛祖，编号依次为 $1 \\sim n$。\n\n第 $i\\ (1 \\leq i \\leq n)$ 位赛博佛祖可以对应为一个二元组 $\\langle S_i, d_i \\rangle$，其中 $S$ 在任意时刻均为 $\\{1, 2, 3, \\dots, m\\}$ 的一个子集（可以为空），而 $d_i$ 为 $1 \\sim m$ 间的整数。\n\n如果在某一时刻，存在一位赛博佛祖的 $S_i$ 为空集，佛祖会感到很开心而给你加功德。具体地，他会敲响第 $d_i$ 个木鱼，并 **在下一时刻同时** 影响所有的 $n$ 位赛博佛祖（包括他自己）。对第 $j(1 \\leq j \\leq n)$ 位赛博佛祖，如果 $d_i \\in S_j$，那么将从 $S_j$ 内删去 $d_i$；否则向 $S_j$ 内加入 $d_i$。如果有多位赛博佛祖的 $S_i$ 为空集，取编号最小的 $i$ 为你加功德。\n\n现在作为电子资本家的你，想要功德无量。你想知道，最少再请来几位赛博佛祖，可以使得你的这些佛祖们 **源源不断地** 为你加功德。假设这个答案是 $s$（可以为 $0$），那么新的佛祖们的编号依次为 $(n+1) \\sim (n+s)$。\n\n**因为你是个资本家，有时候你不想请那么多佛祖**。所以你有许多组询问，对于一组 $l, r$，设 $f(l, r)$ 表示如果初始只有 $[l, r]$ 之间的佛祖，答案将会是多少，注意，每组询问相互独立，上一次添加的佛祖不会延续到以后的询问中。\n\n为了避免太多的输出，你只需要输出： \n\n$$\\sum\\limits_{l=1}^n\\sum\\limits_{r=l}^n f(l,r)\\times2^l$$\n\n即可，答案对 $10^9 + 7$ 取模。", "inputFormat": "第一行，两个整数 $n, m$。\n\n接下来 $n$ 行，第 $i$ 行首先一个整数描述 $d_i$，接着一个长度为 $m$ 的 $\\texttt{01}$ 字符串表示 $S_i$。如果第 $j$ 个字符为 $1$，表示 $j \\in S_i$；否则 $j \\notin S_i$。", "outputFormat": "一行，表示最终答案取模后的值。", "hint": "### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 0（10 pts）：$n \\leq 10$，$m \\leq 5$。\n- Subtask 1（10 pts）：$n \\leq 300$，$m \\leq 10$。\n- Subtask 2（15 pts）：$n \\leq 1024$，$m \\leq 10$。保证每个 $S_i$ 均不同。\n- Subtask 3（15 pts）：$n \\leq 10^4$。\n- Subtask 4（10 pts）：每个 $S_i$ 均在 $2^m$ 种情况中等概率随机生成，$d_i$ 均在 $m$ 种情况中等概率随机生成。\n- Subtask 5（40 pts）：无特殊限制。\n\n对于所有数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 17$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「GMOI R2-T4」电子木鱼", "background": "运营电子资本，招聘赛博佛祖，积累虚拟功德。\n\n功德无量，随喜赞叹。\n\n111", "description": "给你 $n$，表示一共有 $n$ 位赛博佛祖，编号依次为 $1 \\sim n$。\n\n第 $i\\ (1 \\leq i \\leq n)$ 位赛博佛祖可以对应为一个二元组 $\\langle S_i, d_i \\rangle$，其中 $S$ 在任意时刻均为 $\\{1, 2, 3, \\dots, m\\}$ 的一个子集（可以为空），而 $d_i$ 为 $1 \\sim m$ 间的整数。\n\n如果在某一时刻，存在一位赛博佛祖的 $S_i$ 为空集，佛祖会感到很开心而给你加功德。具体地，他会敲响第 $d_i$ 个木鱼，并 **在下一时刻同时** 影响所有的 $n$ 位赛博佛祖（包括他自己）。对第 $j(1 \\leq j \\leq n)$ 位赛博佛祖，如果 $d_i \\in S_j$，那么将从 $S_j$ 内删去 $d_i$；否则向 $S_j$ 内加入 $d_i$。如果有多位赛博佛祖的 $S_i$ 为空集，取编号最小的 $i$ 为你加功德。\n\n现在作为电子资本家的你，想要功德无量。你想知道，最少再请来几位赛博佛祖，可以使得你的这些佛祖们 **源源不断地** 为你加功德。假设这个答案是 $s$（可以为 $0$），那么新的佛祖们的编号依次为 $(n+1) \\sim (n+s)$。\n\n**因为你是个资本家，有时候你不想请那么多佛祖**。所以你有许多组询问，对于一组 $l, r$，设 $f(l, r)$ 表示如果初始只有 $[l, r]$ 之间的佛祖，答案将会是多少，注意，每组询问相互独立，上一次添加的佛祖不会延续到以后的询问中。\n\n为了避免太多的输出，你只需要输出： \n\n$$\\sum\\limits_{l=1}^n\\sum\\limits_{r=l}^n f(l,r)\\times2^l$$\n\n即可，答案对 $10^9 + 7$ 取模。", "inputFormat": "第一行，两个整数 $n, m$。\n\n接下来 $n$ 行，第 $i$ 行首先一个整数描述 $d_i$，接着一个长度为 $m$ 的 $\\texttt{01}$ 字符串表示 $S_i$。如果第 $j$ 个字符为 $1$，表示 $j \\in S_i$；否则 $j \\notin S_i$。", "outputFormat": "一行，表示最终答案取模后的值。", "hint": "### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 0（10 pts）：$n \\leq 10$，$m \\leq 5$。\n- Subtask 1（10 pts）：$n \\leq 300$，$m \\leq 10$。\n- Subtask 2（15 pts）：$n \\leq 1024$，$m \\leq 10$。保证每个 $S_i$ 均不同。\n- Subtask 3（15 pts）：$n \\leq 10^4$。\n- Subtask 4（10 pts）：每个 $S_i$ 均在 $2^m$ 种情况中等概率随机生成，$d_i$ 均在 $m$ 种情况中等概率随机生成。\n- Subtask 5（40 pts）：无特殊限制。\n\n对于所有数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 17$。", "locale": "zh-CN"}}}
{"pid": "P9202", "type": "P", "difficulty": 4, "samples": [["5 2\n1 0 1 3 0", "2\n1 1 1 3 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "洛谷原创", "Special Judge", "O2优化", "构造", "洛谷月赛"], "title": "「GMOI R2-T2」猫耳小（加强版）", "background": "**本题与 [原题](https://www.luogu.com.cn/problem/P9199) 的区别在于数据范围和输出格式。在这一版本中，$n\\le 10^6$，值域为 $10^9$，你需要给出构造。**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r8a6ylx3.png)", "description": "小 R 是一个可爱的猫耳女孩子，她喜欢研究数列的 $\\operatorname{mex}\\text{*}$。\n\n现在她有一个长度为 $n$ 的数列 $a$。她讨厌整数 $k$，因此她希望修改数列 $a$ 的若干个元素为任意**自然数**，使得 $a$ 的任意**连续非空子串**的 $\\operatorname{mex}$ 都不等于 $k$。\n\n请你求出最少需要修改多少个元素，并给出方案。\n\n$\\text{*}$ 本题中，数列的 $\\operatorname{mex}$ 被定义为数列中最小未出现的**自然数**，例如：\n\n- $\\operatorname{mex}\\{1,2,3\\}=0$，因为 $0$ 是自然数。\n- $\\operatorname{mex}\\{0,1,3\\}=2$。\n- $\\operatorname{mex}\\{0,1,2\\}=3$。", "inputFormat": "第一行两个整数 $n,k$，表示数列长度和小 R 讨厌的数。\n\n第二行 $n$ 个整数，第 $i$ 个整数为 $a_i$，表示这个数列的第 $i$ 项。", "outputFormat": "第一行一个整数，表示最少需要修改的元素个数。\n\n第二行 $n$ 个整数，表示修改后的数列。你需要保证修改后的数列的每个数在 $[0,10^9]\\cap\\Z$ 的范围内。", "hint": "**样例解释**\n\n一种方案是将 $\\{1,0,1,3,0\\}$ 改为 $\\{1,1,1,3,2\\}$，共改动两个元素。\n\n可以证明不存在更优的方案。\n\n---\n\n**评分方式**\n\n本题采用自定义校验器（Special Judge）进行评测。\n\n对于每个测试点，如果你的最小步数正确，可以得到 $30\\%$ 的分数。在此基础上，如果方案也正确，可以得到满分。\n\n请注意：即使你不会给出方案，也请按照输出格式在第二行输出 $n$ 个整数。\n\n---\n\n**本题采用捆绑测试，数据无梯度。**\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$0\\le k,a_i\\le 10^9$。\n\n本题读写量较大，建议使用效率较高的读写方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「GMOI R2-T2」猫耳小（加强版）", "background": "**本题与 [原题](https://www.luogu.com.cn/problem/P9199) 的区别在于数据范围和输出格式。在这一版本中，$n\\le 10^6$，值域为 $10^9$，你需要给出构造。**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r8a6ylx3.png)", "description": "小 R 是一个可爱的猫耳女孩子，她喜欢研究数列的 $\\operatorname{mex}\\text{*}$。\n\n现在她有一个长度为 $n$ 的数列 $a$。她讨厌整数 $k$，因此她希望修改数列 $a$ 的若干个元素为任意**自然数**，使得 $a$ 的任意**连续非空子串**的 $\\operatorname{mex}$ 都不等于 $k$。\n\n请你求出最少需要修改多少个元素，并给出方案。\n\n$\\text{*}$ 本题中，数列的 $\\operatorname{mex}$ 被定义为数列中最小未出现的**自然数**，例如：\n\n- $\\operatorname{mex}\\{1,2,3\\}=0$，因为 $0$ 是自然数。\n- $\\operatorname{mex}\\{0,1,3\\}=2$。\n- $\\operatorname{mex}\\{0,1,2\\}=3$。", "inputFormat": "第一行两个整数 $n,k$，表示数列长度和小 R 讨厌的数。\n\n第二行 $n$ 个整数，第 $i$ 个整数为 $a_i$，表示这个数列的第 $i$ 项。", "outputFormat": "第一行一个整数，表示最少需要修改的元素个数。\n\n第二行 $n$ 个整数，表示修改后的数列。你需要保证修改后的数列的每个数在 $[0,10^9]\\cap\\Z$ 的范围内。", "hint": "**样例解释**\n\n一种方案是将 $\\{1,0,1,3,0\\}$ 改为 $\\{1,1,1,3,2\\}$，共改动两个元素。\n\n可以证明不存在更优的方案。\n\n---\n\n**评分方式**\n\n本题采用自定义校验器（Special Judge）进行评测。\n\n对于每个测试点，如果你的最小步数正确，可以得到 $30\\%$ 的分数。在此基础上，如果方案也正确，可以得到满分。\n\n请注意：即使你不会给出方案，也请按照输出格式在第二行输出 $n$ 个整数。\n\n---\n\n**本题采用捆绑测试，数据无梯度。**\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$0\\le k,a_i\\le 10^9$。\n\n本题读写量较大，建议使用效率较高的读写方式。", "locale": "zh-CN"}}}
{"pid": "P9203", "type": "P", "difficulty": 1, "samples": [["100.000000000000 999999.000000000000\n", "YES"], ["114.123456789000 514.123456789000\n", "YES"], ["0.333333333333 0.333333333334\n", "NO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "传智杯"], "title": "时效「月岩笠的诅咒」", "background": "蓬莱之药，被诅咒的不死之药。\n\n奉命将蓬莱之药投入富士山中销毁的月岩笠，最终打算把蓬莱之药改投入八岳销毁。在下山途中妹红将其踹下山，抢到了蓬莱之药。\n\n那已经是千年前的事情了。", "description": "时间节点上发生过的两件事情的时间可被看作两实数 $a,b$。我们称两个事件满足「周年」关系，当且仅当可以通过执行以下两种操作（可以 $0$ 次）使其相等：\n\n- 将 $a$ 加上 $1$，即 $a\\gets a+1$；\n- 将 $b$ 加上 $1$，即 $b\\gets b+1$。\n\n现在给定实数 $a,b$，询问它们是否满足「周年」。", "inputFormat": "输入共一行两个实数 $a,b$。输入保留到小数点后 $12$ 位。", "outputFormat": "输出共一行。如果存在合法方案，输出 $\\verb!YES!$，否则输出 $\\verb!NO!$。", "hint": "对于全部数据，保证 $0<a,b\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "时效「月岩笠的诅咒」", "background": "蓬莱之药，被诅咒的不死之药。\n\n奉命将蓬莱之药投入富士山中销毁的月岩笠，最终打算把蓬莱之药改投入八岳销毁。在下山途中妹红将其踹下山，抢到了蓬莱之药。\n\n那已经是千年前的事情了。", "description": "时间节点上发生过的两件事情的时间可被看作两实数 $a,b$。我们称两个事件满足「周年」关系，当且仅当可以通过执行以下两种操作（可以 $0$ 次）使其相等：\n\n- 将 $a$ 加上 $1$，即 $a\\gets a+1$；\n- 将 $b$ 加上 $1$，即 $b\\gets b+1$。\n\n现在给定实数 $a,b$，询问它们是否满足「周年」。", "inputFormat": "输入共一行两个实数 $a,b$。输入保留到小数点后 $12$ 位。", "outputFormat": "输出共一行。如果存在合法方案，输出 $\\verb!YES!$，否则输出 $\\verb!NO!$。", "hint": "对于全部数据，保证 $0<a,b\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P9204", "type": "P", "difficulty": 2, "samples": [["2 7 5 2", "9"], ["2 2 3 2", "-1\n"], ["0 0 1000000000 1000000000\n", "2000000000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "传智杯"], "title": "不死「火鸟　−凤翼天翔−」", "background": "拥有了「不死」的能力的藤原妹红，同时获得了操纵火焰的力量，是不死鸟的化身。\n\n不死鸟，和凤凰是同一种生物吗？", "description": "妹红可以操纵火鸟。火鸟可以看作在边长**无限大**的棋盘上放置着的一枚棋子 $A$，$A$ 位于 $(x_1,y_1)$ 处。$A$ 以如下规则移动：\n\n- 在奇数次移动时，$A$ 只能向右上或者左下移动一格，如下图红色箭头；\n- 在偶数次移动时，$A$ 只能向右下或者左上移动一格，如下图蓝色箭头。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rk4bjeya.png)\n\n由于棋盘无限大，因此 $x,y$ 的取值可以为负数。\n\n每一步行动时 $A$ 不能待在原地不移动。现在需要把 $A$ 移动到坐标为 $(x_2,y_2)$ 的 $B$ 位置，最少要多少步？特别地，若不存在这样的方案，输出 $-1$。\n\n如下图所示是 $A=(2,7)$，$B=(5,2)$ 的情况。一种移动次数最小的方案已在图上标出，需要 $9$ 步。红色线段表示奇数次的移动，蓝色线段表示偶数次的移动。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mzwrv7q0.png)", "inputFormat": "输入共一行四个整数 $x_1,y_1,x_2,y_2$，描述 $A,B$ 的坐标。", "outputFormat": "输出共一行一个整数。如果存在一条从 $A$ 到 $B$ 的移动方案，输出移动的最小步数；否则输出 $-1$。", "hint": "### 数据范围及约定\n\n对于全部数据，保证 $0\\le x_1,y_1,x_2,y_2\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "不死「火鸟　−凤翼天翔−」", "background": "拥有了「不死」的能力的藤原妹红，同时获得了操纵火焰的力量，是不死鸟的化身。\n\n不死鸟，和凤凰是同一种生物吗？", "description": "妹红可以操纵火鸟。火鸟可以看作在边长**无限大**的棋盘上放置着的一枚棋子 $A$，$A$ 位于 $(x_1,y_1)$ 处。$A$ 以如下规则移动：\n\n- 在奇数次移动时，$A$ 只能向右上或者左下移动一格，如下图红色箭头；\n- 在偶数次移动时，$A$ 只能向右下或者左上移动一格，如下图蓝色箭头。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rk4bjeya.png)\n\n由于棋盘无限大，因此 $x,y$ 的取值可以为负数。\n\n每一步行动时 $A$ 不能待在原地不移动。现在需要把 $A$ 移动到坐标为 $(x_2,y_2)$ 的 $B$ 位置，最少要多少步？特别地，若不存在这样的方案，输出 $-1$。\n\n如下图所示是 $A=(2,7)$，$B=(5,2)$ 的情况。一种移动次数最小的方案已在图上标出，需要 $9$ 步。红色线段表示奇数次的移动，蓝色线段表示偶数次的移动。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mzwrv7q0.png)", "inputFormat": "输入共一行四个整数 $x_1,y_1,x_2,y_2$，描述 $A,B$ 的坐标。", "outputFormat": "输出共一行一个整数。如果存在一条从 $A$ 到 $B$ 的移动方案，输出移动的最小步数；否则输出 $-1$。", "hint": "### 数据范围及约定\n\n对于全部数据，保证 $0\\le x_1,y_1,x_2,y_2\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P9205", "type": "P", "difficulty": 2, "samples": [["3 2 1\n1 0\n1 0\n0 1\n", "3\n\n"], ["15 8 4\n9 0\n9 1\n9 1\n8 1\n8 2\n8 3\n7 3\n6 3\n5 3\n4 3\n3 3\n2 4\n2 5\n1 6\n0 7\n", "24\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "传智杯"], "title": "藤原「灭罪寺院伤」", "background": "藤原氏，权倾一时的重臣。凭借着炙手可热的权势，杀害了政敌长屋王而触碰到了最高的权力。\n\n是天谴吗？即使修缮寺庙积德行善，藤原四兄弟最终覆灭在了天花之下。", "description": "环环相扣的因果报应可看成平面上的 $n$ 个小正方形，它们的边长分别为 $1,2,3,\\cdots,n$。初始时，编号较小的正方形被编号较大的正方形完全包含：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w5f6nucw.png)\n\n为了方便记录正方形的位置，我们取正方形左上角的坐标 $(x_i,y_i)$ 为正方形的坐标。此时可以唯一确定该正方形。\n\n现在需要将最小的正方形的位置移动到 $(x_{\\rm end},y_{\\rm end})$，移动过程满足：\n\n- 每次**最多移动一个**正方形，可以往上下左右四个方向之一移动一个单位长度。\n- 在移动过程中，需要保证**较小正方形会被较大的正方形包含**。\n\n请求出最少次数。", "inputFormat": "第一行有三个整数 $n, x_{\\mathrm{end}},y_{\\mathrm{end}}$，含义如题面所示。\n\n接下来 $n$ 行，每行有两个整数 $x_i,y_i$，描述第 $i$ 小的正方形左上角的坐标。", "outputFormat": "输出共一行一个整数，表示最小的操作步数。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dcghf89y.png)\n\n### 数据范围及约定\n\n对于全部数据，$1\\le n\\le 10^5$，$0\\le x_i,y_i,x_{\\mathrm{end}},y_{\\mathrm{end}}\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "藤原「灭罪寺院伤」", "background": "藤原氏，权倾一时的重臣。凭借着炙手可热的权势，杀害了政敌长屋王而触碰到了最高的权力。\n\n是天谴吗？即使修缮寺庙积德行善，藤原四兄弟最终覆灭在了天花之下。", "description": "环环相扣的因果报应可看成平面上的 $n$ 个小正方形，它们的边长分别为 $1,2,3,\\cdots,n$。初始时，编号较小的正方形被编号较大的正方形完全包含：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w5f6nucw.png)\n\n为了方便记录正方形的位置，我们取正方形左上角的坐标 $(x_i,y_i)$ 为正方形的坐标。此时可以唯一确定该正方形。\n\n现在需要将最小的正方形的位置移动到 $(x_{\\rm end},y_{\\rm end})$，移动过程满足：\n\n- 每次**最多移动一个**正方形，可以往上下左右四个方向之一移动一个单位长度。\n- 在移动过程中，需要保证**较小正方形会被较大的正方形包含**。\n\n请求出最少次数。", "inputFormat": "第一行有三个整数 $n, x_{\\mathrm{end}},y_{\\mathrm{end}}$，含义如题面所示。\n\n接下来 $n$ 行，每行有两个整数 $x_i,y_i$，描述第 $i$ 小的正方形左上角的坐标。", "outputFormat": "输出共一行一个整数，表示最小的操作步数。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dcghf89y.png)\n\n### 数据范围及约定\n\n对于全部数据，$1\\le n\\le 10^5$，$0\\le x_i,y_i,x_{\\mathrm{end}},y_{\\mathrm{end}}\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P9206", "type": "P", "difficulty": 2, "samples": [["10 1\n3 2 6 4 1 1 3 8 7 3\n1\n", "27\n1 1 2 3 3 3 4 6 7 8 \n"], ["15 1\n15 14 13 12 10 11 9 8 7 4 5 6 3 2 1\n1\n", "116\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15\n"], ["15 3\n15 14 13 12 10 11 9 8 7 4 5 6 3 2 1      \n9 3 1", "68\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "排序", "传智杯"], "title": "不死「徐福时空」", "background": "徐福是秦朝齐地方士。\n\n奉秦皇之命，徐福率三千童男童女踏上了寻找传说中的「蓬莱之药」的征途。但最后再也没有回来。\n\n徐福最终去了哪里？有没有找到蓬莱之药？这些问题已经无关紧要了。", "description": "时间的流逝可以抽象成对数字序列进行排序所花费的时间。不同排序策略花费的时间是不同的。这里介绍一种人类探索排序过程中具有里程碑意义的一种排序算法：希尔排序。\n\n希尔排序可以被视为一种对插入排序的优化。为了研究希尔排序的运行效率，我们希望你实现一个简单的希尔排序的过程。在这之前，我们会规范插入排序的具体流程以及评价一个插入排序的过程的「代价」。\n\n### 插入排序\n\n对于一个长度为 $n$ 的数组 $a=[a_1,a_2,\\cdots,a_n]$，插入排序的思想是，从前到后枚举每一个元素，将其插入到正确的位置上去：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bzr46ykp.png)\n\n如图所示是一个典型的插入排序的过程。在第 $i$ 轮中我们把下标为 $i$ 的元素插入到了**排好序的部分中第一个比 $\\bm{a_i}$ 大的元素之前**。假设 $a_i$ 最终被插入到了 $b_i$ 位置，那么我们称这一轮的代价为 $|a_i-b_i|+1$，整个插入排序的过程的代价就是每一轮的代价之和。\n\n### 希尔排序\n\n为了减小插入排序的代价，我们引入了希尔排序。希尔排序将整个排序过程分成了若干轮，每一轮会按照一定的间隔把元素分组，对每一组内的元素分别进行排序。在最后一轮，希尔排序会对整个数组进行一次最终的插入排序。\n\n具体的分组方式是，选定一个整数 $d$，划分为如下组别：\n\n- 下标为 $1,1+d,1+2d,\\cdots$ 的元素；\n- 下标为 $2,2+d,2+2d,\\cdots$ 的元素；\n- 下标为 $3,3+d,3+2d,\\cdots$ 的元素；\n- ……\n- 下标为 $d,2d,3d,\\cdots$ 的元素。\n\n下面是**一轮**希尔排序的过程。我们选定 $d=3$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ladynhmo.png)\n\n希尔排序每一轮分别选取 $d$，并且在最后一轮取 $d=1$，每一轮都进行这样的排序，最终得到一个有序的数组。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/msa25yb1.png)\n\n虽然看上去进行了很多轮插入排序，但是最终每一轮插入排序的代价之和可能会远小于对整个数组进行单次插入排序的代价（上述例子中体现得并不明显，可以参考样例 $2,3$ 给出的例子）。\n\n事实上，希尔排序是人类发现的第一个最坏复杂度低于 $\\Theta (n^2)$ 的排序算法。例如，当取 $d=2^k-1,\\ k=\\lfloor\\log_2 n\\rfloor,\\lfloor\\log_2 n\\rfloor-1,\\lfloor\\log_2 n\\rfloor-2,\\cdots,1$ 时，整个过程的最坏时间复杂度为 $\\mathcal \\Theta(n^{3/2})$。", "inputFormat": "第一行有两个整数 $n,m$，分别表示待排序的数组的长度以及希尔排序进行的轮数。\n\n第二行有 $n$ 个整数 $a_1,a_2,\\cdots,a_n$，描述数组里的元素。\n\n第三行有 $m$ 个整数 $d_1,d_2,\\cdots,d_m$，描述每一轮选取的 $d$ 的值。数据保证 $d_m=1$。", "outputFormat": "第一行输出一个整数 $\\mathrm{cost}$，表示整个希尔排序过程中插入排序产生的代价之和。\n\n第二行输出 $n$ 个整数，表示数组 $a$ 排序后的结果。", "hint": "### 数据范围及约定\n\n对于全部数据，保证 $1\\le n\\le 10^5$，$1\\le m\\le 100$，$\\mathrm{cost}\\le 5\\times 10^7$，$1\\le a_i\\le 10^9$，$1\\le d_i\\le n$，$d_m=1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "不死「徐福时空」", "background": "徐福是秦朝齐地方士。\n\n奉秦皇之命，徐福率三千童男童女踏上了寻找传说中的「蓬莱之药」的征途。但最后再也没有回来。\n\n徐福最终去了哪里？有没有找到蓬莱之药？这些问题已经无关紧要了。", "description": "时间的流逝可以抽象成对数字序列进行排序所花费的时间。不同排序策略花费的时间是不同的。这里介绍一种人类探索排序过程中具有里程碑意义的一种排序算法：希尔排序。\n\n希尔排序可以被视为一种对插入排序的优化。为了研究希尔排序的运行效率，我们希望你实现一个简单的希尔排序的过程。在这之前，我们会规范插入排序的具体流程以及评价一个插入排序的过程的「代价」。\n\n### 插入排序\n\n对于一个长度为 $n$ 的数组 $a=[a_1,a_2,\\cdots,a_n]$，插入排序的思想是，从前到后枚举每一个元素，将其插入到正确的位置上去：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bzr46ykp.png)\n\n如图所示是一个典型的插入排序的过程。在第 $i$ 轮中我们把下标为 $i$ 的元素插入到了**排好序的部分中第一个比 $\\bm{a_i}$ 大的元素之前**。假设 $a_i$ 最终被插入到了 $b_i$ 位置，那么我们称这一轮的代价为 $|a_i-b_i|+1$，整个插入排序的过程的代价就是每一轮的代价之和。\n\n### 希尔排序\n\n为了减小插入排序的代价，我们引入了希尔排序。希尔排序将整个排序过程分成了若干轮，每一轮会按照一定的间隔把元素分组，对每一组内的元素分别进行排序。在最后一轮，希尔排序会对整个数组进行一次最终的插入排序。\n\n具体的分组方式是，选定一个整数 $d$，划分为如下组别：\n\n- 下标为 $1,1+d,1+2d,\\cdots$ 的元素；\n- 下标为 $2,2+d,2+2d,\\cdots$ 的元素；\n- 下标为 $3,3+d,3+2d,\\cdots$ 的元素；\n- ……\n- 下标为 $d,2d,3d,\\cdots$ 的元素。\n\n下面是**一轮**希尔排序的过程。我们选定 $d=3$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ladynhmo.png)\n\n希尔排序每一轮分别选取 $d$，并且在最后一轮取 $d=1$，每一轮都进行这样的排序，最终得到一个有序的数组。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/msa25yb1.png)\n\n虽然看上去进行了很多轮插入排序，但是最终每一轮插入排序的代价之和可能会远小于对整个数组进行单次插入排序的代价（上述例子中体现得并不明显，可以参考样例 $2,3$ 给出的例子）。\n\n事实上，希尔排序是人类发现的第一个最坏复杂度低于 $\\Theta (n^2)$ 的排序算法。例如，当取 $d=2^k-1,\\ k=\\lfloor\\log_2 n\\rfloor,\\lfloor\\log_2 n\\rfloor-1,\\lfloor\\log_2 n\\rfloor-2,\\cdots,1$ 时，整个过程的最坏时间复杂度为 $\\mathcal \\Theta(n^{3/2})$。", "inputFormat": "第一行有两个整数 $n,m$，分别表示待排序的数组的长度以及希尔排序进行的轮数。\n\n第二行有 $n$ 个整数 $a_1,a_2,\\cdots,a_n$，描述数组里的元素。\n\n第三行有 $m$ 个整数 $d_1,d_2,\\cdots,d_m$，描述每一轮选取的 $d$ 的值。数据保证 $d_m=1$。", "outputFormat": "第一行输出一个整数 $\\mathrm{cost}$，表示整个希尔排序过程中插入排序产生的代价之和。\n\n第二行输出 $n$ 个整数，表示数组 $a$ 排序后的结果。", "hint": "### 数据范围及约定\n\n对于全部数据，保证 $1\\le n\\le 10^5$，$1\\le m\\le 100$，$\\mathrm{cost}\\le 5\\times 10^7$，$1\\le a_i\\le 10^9$，$1\\le d_i\\le n$，$d_m=1$。", "locale": "zh-CN"}}}
{"pid": "P9207", "type": "P", "difficulty": 3, "samples": [["3 3\n1 2 3\n", "2\n"], ["10 4\n-3 5 6 -4 5 3 -4 1 -1 0", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "传智杯"], "title": "灭罪「正直者之死」", "background": "正直的人，坚强不屈的人，刚正不阿的人。\n\n大约这样的人会处处吃亏吧，不过这样的观点大约是从欺骗者的眼光里看到的。正直的人，即使是在死后，也是最为人尊敬的吧。", "description": "有一台计算器，使用 $k$ 位的带符号整型来对数字进行存储。也就是说，一个变量能够表示的范围是 $[-2^{k-1},2^{k-1})$。现在我们希望使用该计算器计算一系列数 $a_1,a_2,\\cdots,a_n$ 的和。计算的伪代码如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7p0loptk.png)\n\n由于奇怪的特性，如果两个变量在相加时得到的结果在 $[-2^{k-1},2^{k-1})$ 之外，即发生了溢出，那么这台计算器就会卡死，再也无法进行计算了。\n\n为了防止这样的事情发生，一个变通的方法是**更改 $a_i$ 的排列顺序**。容易发现这样不会改变计算出的和的值。\n\n不过，可能不存在一种方案，使得计算出这 $n$ 个数并且计算机不爆炸。但我们还是希望，计算出**尽量多**的数字的和。", "inputFormat": "第一行有两个整数 $n,k$，分别表示元素个数和整型位数。\n\n第二行有 $n$ 个整数 $a_1,a_2,\\cdots,a_n$。", "outputFormat": "共一行一个整数，表示最多能将多少个数字计算出和。", "hint": "### 样例解释\n\n- 对于样例 $1$，一种最优的方案是 $[a_1,a_2,a_3]$，这样可以在计算出前两个数的情况下不溢出。\n- 对于样例 $2$，一种最优的方案是 $[a_{10},a_1,a_2,a_5,a_4,a_7,a_6,a_8,a_9,a_3]$，这样可以在计算前 $9$ 个数的情况下不溢出。\n\n### 数据范围及约定\n\n对于全部数据，保证 $1\\le n\\le 500$，$1< k\\le 8$，$-2^{k-1}\\le a_i<2^{k-1}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "灭罪「正直者之死」", "background": "正直的人，坚强不屈的人，刚正不阿的人。\n\n大约这样的人会处处吃亏吧，不过这样的观点大约是从欺骗者的眼光里看到的。正直的人，即使是在死后，也是最为人尊敬的吧。", "description": "有一台计算器，使用 $k$ 位的带符号整型来对数字进行存储。也就是说，一个变量能够表示的范围是 $[-2^{k-1},2^{k-1})$。现在我们希望使用该计算器计算一系列数 $a_1,a_2,\\cdots,a_n$ 的和。计算的伪代码如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7p0loptk.png)\n\n由于奇怪的特性，如果两个变量在相加时得到的结果在 $[-2^{k-1},2^{k-1})$ 之外，即发生了溢出，那么这台计算器就会卡死，再也无法进行计算了。\n\n为了防止这样的事情发生，一个变通的方法是**更改 $a_i$ 的排列顺序**。容易发现这样不会改变计算出的和的值。\n\n不过，可能不存在一种方案，使得计算出这 $n$ 个数并且计算机不爆炸。但我们还是希望，计算出**尽量多**的数字的和。", "inputFormat": "第一行有两个整数 $n,k$，分别表示元素个数和整型位数。\n\n第二行有 $n$ 个整数 $a_1,a_2,\\cdots,a_n$。", "outputFormat": "共一行一个整数，表示最多能将多少个数字计算出和。", "hint": "### 样例解释\n\n- 对于样例 $1$，一种最优的方案是 $[a_1,a_2,a_3]$，这样可以在计算出前两个数的情况下不溢出。\n- 对于样例 $2$，一种最优的方案是 $[a_{10},a_1,a_2,a_5,a_4,a_7,a_6,a_8,a_9,a_3]$，这样可以在计算前 $9$ 个数的情况下不溢出。\n\n### 数据范围及约定\n\n对于全部数据，保证 $1\\le n\\le 500$，$1< k\\le 8$，$-2^{k-1}\\le a_i<2^{k-1}$。", "locale": "zh-CN"}}}
{"pid": "P9208", "type": "P", "difficulty": 4, "samples": [["3 998244853\n1 2\n1 3\n2 1 2\n1 2 2", "10"], ["5 998244353\n1 2\n1 3\n1 4\n4 5\n5 5 5 2 3\n6 6 1 5 3", "4656"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形数据结构", "前缀和", "传智杯"], "title": "虚人「无」", "background": "一点也不美丽的不死鸟。\n\n那双锐爪，沾染了无辜的鲜血。", "description": "给定二元序列 $\\{(v_i,c_i)\\}$ 和一棵以 $1$ 为根的有根树。第 $i$ 个点的点权是 $(v_i,c_i)$。\n\n- 定义一个非根节点的权值为其子树内的 $c$ 的积乘上其子树补的 $v$ 的积。\n- 定义一个根节点的权值为其子树内的 $c$ 的积。\n\n形式化的讲，若 $u$ 不为根节点，则 $u$ 的权值 $f_u$ 为：\n\n$$f_u=\\prod\\limits_{v\\in \\operatorname{substree}(u)} c_v\\times \\prod\\limits_{v\\notin \\operatorname{substree}(u)} v_v$$\n\n否则，其权值 $f_u$ 为：\n\n$$f_u=\\prod\\limits_{v=1}^n c_v$$\n\n试求整棵树**所有节点的权值之和**，答案对 $m$ 取模。请注意：**保证 $\\bm m$ 是质数**。\n\n\n", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $n-1$ 行，每行两个数 $u,v$，表示 $u,v$ 之间有一条边。\n\n接下来一行 $n$ 个数，表示 $c_{1, 2, \\dots, n}$。\n\n接下来一行 $n$ 个数，表示 $v_{1, 2, \\dots, n}$。\n", "outputFormat": "输出一个数，表示答案对 $m$ 取模后的结果。", "hint": "### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/olehwn2w.png)\n\n（图片有误，应该交换 $v,c$ 的权值。）\n\n### 数据范围及约定\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\leq 3\\times 10^5$，$1\\leq v_i,c_i,m\\leq 10^9$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "虚人「无」", "background": "一点也不美丽的不死鸟。\n\n那双锐爪，沾染了无辜的鲜血。", "description": "给定二元序列 $\\{(v_i,c_i)\\}$ 和一棵以 $1$ 为根的有根树。第 $i$ 个点的点权是 $(v_i,c_i)$。\n\n- 定义一个非根节点的权值为其子树内的 $c$ 的积乘上其子树补的 $v$ 的积。\n- 定义一个根节点的权值为其子树内的 $c$ 的积。\n\n形式化的讲，若 $u$ 不为根节点，则 $u$ 的权值 $f_u$ 为：\n\n$$f_u=\\prod\\limits_{v\\in \\operatorname{substree}(u)} c_v\\times \\prod\\limits_{v\\notin \\operatorname{substree}(u)} v_v$$\n\n否则，其权值 $f_u$ 为：\n\n$$f_u=\\prod\\limits_{v=1}^n c_v$$\n\n试求整棵树**所有节点的权值之和**，答案对 $m$ 取模。请注意：**保证 $\\bm m$ 是质数**。\n\n\n", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $n-1$ 行，每行两个数 $u,v$，表示 $u,v$ 之间有一条边。\n\n接下来一行 $n$ 个数，表示 $c_{1, 2, \\dots, n}$。\n\n接下来一行 $n$ 个数，表示 $v_{1, 2, \\dots, n}$。\n", "outputFormat": "输出一个数，表示答案对 $m$ 取模后的结果。", "hint": "### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/olehwn2w.png)\n\n（图片有误，应该交换 $v,c$ 的权值。）\n\n### 数据范围及约定\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\leq 3\\times 10^5$，$1\\leq v_i,c_i,m\\leq 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P9209", "type": "P", "difficulty": 4, "samples": [["3\n18 20 22\n1 2 3\n1 4 3", "54"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "传智杯"], "title": "不灭「不死鸟之尾」", "background": "不死鸟之尾，一种量产型的羽毛。可用作药品。\n\n虽说是量产型，可是从哪里可以得到这种万能之药呢？", "description": "有一个包含 $n$ 个停车位的停车场，里面的停车位排成了一排，最左边和最右边都是墙壁。\n\n有 $n$ 辆车要按顺序依次停入这个停车场，在停入第 $i$ 辆车时，这辆车要停入的位置左右两边的空位越多，停进去需要的时间也就会越少，具体地，如果其左边连续的空位数量为 $l$，其右边连续的空位数量为 $r$，那么停入该辆车所需时间为 $W_i-L_i\\cdot l-R_i\\cdot r$，其中 $W_i,L_i,R_i$ 会给出（特别的，停车所需要的时间不会是负数，所以我们保证 $W_i\\ge L_i\\cdot n+R_i\\cdot n$）。\n\n对于连续空位的解释：例如，下图中箭头所指位置左边连续空位为 $1$，右边连续空位为 $2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s1zpjfnq.png)\n\n请依次确定每一辆车停入的位置，使得停入所有车所需时间最小。", "inputFormat": "输入第一行一个整数 $n$。\n\n接下来三行，每行 $n$ 个整数：第一行第 $i$ 个数给出 $W_i$，第二行第 $i$ 个数给出 $L_i$，第三行第 $i$ 个数给出 $R_i$。保证 $W_i\\ge L_i\\cdot n+R_i\\cdot n$，$L_i,R_i\\ge 0$。", "outputFormat": "输出一个数表示所需要的最少时间。", "hint": "#### 样例解释 1\n\n第 $1$ 辆车停入从左往右数第 $3$ 个停车位，此时该停车位左边有 $2$ 个连续空位，右边没有连续空位，所需时间 $18-1\\times 2-1\\times 0=16$。\n\n第 $2$ 辆车停入从左往右数第 $1$ 个停车位，此时该停车位左边没有连续空位，右边有 $1$ 个连续空位，所需时间 $20-2\\times 0-4\\times 1=16$。\n\n第 $3$ 辆车停入从左往右数第 $2$ 个停车位，此时该停车位左右都没有连续空位，所需时间 $22-3\\times 0-3\\times 0=22$。\n\n停入所有车需要时间 $16+16+22=54$。\n\n#### 数据范围\n\n对于所有数据，保证 $1\\le n\\le 10^5$，$0\\le L_i,R_i\\le 10^5$，$nL_i+nR_i\\le W_i\\le 2\\times 10^{10}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "不灭「不死鸟之尾」", "background": "不死鸟之尾，一种量产型的羽毛。可用作药品。\n\n虽说是量产型，可是从哪里可以得到这种万能之药呢？", "description": "有一个包含 $n$ 个停车位的停车场，里面的停车位排成了一排，最左边和最右边都是墙壁。\n\n有 $n$ 辆车要按顺序依次停入这个停车场，在停入第 $i$ 辆车时，这辆车要停入的位置左右两边的空位越多，停进去需要的时间也就会越少，具体地，如果其左边连续的空位数量为 $l$，其右边连续的空位数量为 $r$，那么停入该辆车所需时间为 $W_i-L_i\\cdot l-R_i\\cdot r$，其中 $W_i,L_i,R_i$ 会给出（特别的，停车所需要的时间不会是负数，所以我们保证 $W_i\\ge L_i\\cdot n+R_i\\cdot n$）。\n\n对于连续空位的解释：例如，下图中箭头所指位置左边连续空位为 $1$，右边连续空位为 $2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s1zpjfnq.png)\n\n请依次确定每一辆车停入的位置，使得停入所有车所需时间最小。", "inputFormat": "输入第一行一个整数 $n$。\n\n接下来三行，每行 $n$ 个整数：第一行第 $i$ 个数给出 $W_i$，第二行第 $i$ 个数给出 $L_i$，第三行第 $i$ 个数给出 $R_i$。保证 $W_i\\ge L_i\\cdot n+R_i\\cdot n$，$L_i,R_i\\ge 0$。", "outputFormat": "输出一个数表示所需要的最少时间。", "hint": "#### 样例解释 1\n\n第 $1$ 辆车停入从左往右数第 $3$ 个停车位，此时该停车位左边有 $2$ 个连续空位，右边没有连续空位，所需时间 $18-1\\times 2-1\\times 0=16$。\n\n第 $2$ 辆车停入从左往右数第 $1$ 个停车位，此时该停车位左边没有连续空位，右边有 $1$ 个连续空位，所需时间 $20-2\\times 0-4\\times 1=16$。\n\n第 $3$ 辆车停入从左往右数第 $2$ 个停车位，此时该停车位左右都没有连续空位，所需时间 $22-3\\times 0-3\\times 0=22$。\n\n停入所有车需要时间 $16+16+22=54$。\n\n#### 数据范围\n\n对于所有数据，保证 $1\\le n\\le 10^5$，$0\\le L_i,R_i\\le 10^5$，$nL_i+nR_i\\le W_i\\le 2\\times 10^{10}$。", "locale": "zh-CN"}}}
{"pid": "P9210", "type": "P", "difficulty": 5, "samples": [["10\n1 2\n2 3\n3 4\n3 5\n2 6\n6 7\n1 8\n8 9\n8 10", "9"], ["17\n1 2\n2 3\n3 4\n4 5\n4 6\n3 7\n7 8\n7 9\n7 10\n2 11\n2 12\n1 13\n13 14\n14 15\n14 16\n13 17", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形 DP", "传智杯", "单调栈"], "title": "蓬莱「凯风快晴　−富士火山−」", "background": "富士山，被当地人称为「神山」。这是一座休眠火山，最近一次喷发在 $300$ 年前。\n\n向这样的山中投入不死之药，想必会直接喷发吧。如此便理解为什么月岩笠最终抗命。", "description": "所谓的山，是一种上细下粗的结构。能不能在「树」里也找到这样的结构呢？\n\n给定一个以 $1$ 为根的大小为 $n$ 的有根树 $T$。你需要找到满足宽度单调不减的**导出子树**中最大的一棵：\n\n- 记该导出子树为 $T_0$，共有 $k$ 层。\n- 记 $T_0$ 的根节点的深度为 $1$，计算出 $T_0$ 中每个结点的深度 $d_i$。由此定义 $T_0$ 第 $i$ 层的宽度 $w_i$ 为「所有深度为 $i$ 的节点的个数」。\n- 你需要使得 $w_i$ 单调不减。即，$w_1\\le w_2\\le \\cdots \\le w_k$。\n\n记原树的点集和边集分别为 $V,E$。导出子树是原树的一个**连通块**，它的点集 $V_0\\subseteq V$，边集 $E_0$ 是 $E$ 当中所有端点均在 $V_0$ 内的边。导出子树的根，是组成它的所有节点中**在原树内深度最浅的那一个**。$T$ 也可以被认为是自身的一棵导出子树。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wcbeo1a0.png)\n\n如图所示，绿色的区域和橙色的区域分别是原树的导出子树。它们的根分别为 $2$ 和 $13$。\n\n**注意**：导出子树的定义略微不同于子树的定义。请不要将两者混淆。\n\n请找到最大的符合条件的导出子树的大小。", "inputFormat": "第一行一个正整数 $n$，表示整棵树的大小。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$，描述树上的一条边。", "outputFormat": "输出共一行一个整数，表示最大的符合条件的导出子树的大小。", "hint": "### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pzq47a3e.png)\n\n如图所示，标灰的节点是两个样例中选出来的导出子树。\n\n- 样例 $1$ 找到的导出子树，每一层的宽度分别为 $\\{1,2,3,3\\}$。\n- 样例 $2$ 找到的导出子树，每一层的宽度分别为 $\\{1,2,4,4,5\\}$。\n### 数据范围及约定\n\n对于全部数据，$1\\le n\\le 5\\times 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "蓬莱「凯风快晴　−富士火山−」", "background": "富士山，被当地人称为「神山」。这是一座休眠火山，最近一次喷发在 $300$ 年前。\n\n向这样的山中投入不死之药，想必会直接喷发吧。如此便理解为什么月岩笠最终抗命。", "description": "所谓的山，是一种上细下粗的结构。能不能在「树」里也找到这样的结构呢？\n\n给定一个以 $1$ 为根的大小为 $n$ 的有根树 $T$。你需要找到满足宽度单调不减的**导出子树**中最大的一棵：\n\n- 记该导出子树为 $T_0$，共有 $k$ 层。\n- 记 $T_0$ 的根节点的深度为 $1$，计算出 $T_0$ 中每个结点的深度 $d_i$。由此定义 $T_0$ 第 $i$ 层的宽度 $w_i$ 为「所有深度为 $i$ 的节点的个数」。\n- 你需要使得 $w_i$ 单调不减。即，$w_1\\le w_2\\le \\cdots \\le w_k$。\n\n记原树的点集和边集分别为 $V,E$。导出子树是原树的一个**连通块**，它的点集 $V_0\\subseteq V$，边集 $E_0$ 是 $E$ 当中所有端点均在 $V_0$ 内的边。导出子树的根，是组成它的所有节点中**在原树内深度最浅的那一个**。$T$ 也可以被认为是自身的一棵导出子树。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wcbeo1a0.png)\n\n如图所示，绿色的区域和橙色的区域分别是原树的导出子树。它们的根分别为 $2$ 和 $13$。\n\n**注意**：导出子树的定义略微不同于子树的定义。请不要将两者混淆。\n\n请找到最大的符合条件的导出子树的大小。", "inputFormat": "第一行一个正整数 $n$，表示整棵树的大小。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$，描述树上的一条边。", "outputFormat": "输出共一行一个整数，表示最大的符合条件的导出子树的大小。", "hint": "### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pzq47a3e.png)\n\n如图所示，标灰的节点是两个样例中选出来的导出子树。\n\n- 样例 $1$ 找到的导出子树，每一层的宽度分别为 $\\{1,2,3,3\\}$。\n- 样例 $2$ 找到的导出子树，每一层的宽度分别为 $\\{1,2,4,4,5\\}$。\n### 数据范围及约定\n\n对于全部数据，$1\\le n\\le 5\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P9211", "type": "P", "difficulty": 6, "samples": [["25 8 5 10\naaacdaabbbaabccaabcdaabcd\n", "5\naaacd"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "Special Judge", "随机化", "传智杯"], "title": "「不死鸟附体」", "background": "死而复生，生而复死。所谓的不死鸟就是这样的一种生物，在无尽的时间里无尽地循环往复。\n\n果然最好还是别获得不老不死的能力吧。", "description": "不死鸟的「一生」可以被看成一个长度不超过 $l_{\\max}$ 的字符串 $S_0$。在无尽的轮回后形成了一个无限长的字符串 $S_{\\mathrm{inf}}=S_0+S_0+S_0+\\cdots$。现在截取 $S_{\\mathrm{inf}}$ 前 $l$ 个字符，作为可观测时间里不死鸟的生命 $S_{\\mathrm{fin}}$。\n\n然而所谓的轮回并不是机械死板的循环往复。因此，$S_\\mathrm{fin}$ 当中会有**不超过 $n$ 个字符**被修改成了别的字符，变成了 $S_{\\mathrm{real}}$。\n\n现在观测到了 $S_{\\mathrm{real}}$，我们希望找到这轮回的周期 $S_0$。然而由于不死鸟的轮回太过漫长，我们只希望找到这样一个 $S_0'$，使得由它生成的 $S_\\mathrm{fin}'$ 修改**不超过 $m$ 个字符**后就可以变成 $S_{\\mathrm{real}}$。\n", "inputFormat": "第一行有四个正整数 $l,l_{\\max},n,m$。\n\n第二行描述观测到的长度为 $l$ 的字符串 $S_{\\mathrm{real}}$。", "outputFormat": "第一行输出一个正整数 $l_0$，表示你所找到的 $S_0$ 的长度。你应当保证 $1\\le l_0\\le l_{\\max}$。\n\n第二行输出一个长度为 $l_0$ 的字符串 $S_0$，表示你所找到的字符串。", "hint": "### 样例解释\n\n样例仅供理解题意，**不符合数据范围的约束**。具体约束请参见「数据范围及约定」。\n\n生成 $S_{\\mathrm{real}}$ 所用的 $S_0=\\verb!aabcd!$。\n\n- 由此生成 $S_{\\mathrm{inf}}=\\verb!aabcdaabcdaabcdaabcdaabcd!\\cdots$；\n- 由此生成 $S_{\\mathrm{fin}}=\\verb!aabcdaabcdaabcdaabcdaabcd!$；\n- 由此生成 $S_{\\mathrm{real}\\kern{-2.5pt}}=\\verb!aaacdaabbbaabccaabcdaabcd!$。\n\n样例输出给出了一个可能的 $S_0'=\\verb!aaacd!$。由此计算出 $S_{\\mathrm{fin}}'$ 与 $S_{\\mathrm{real}}$ 的差距：\n\n$$\\begin{aligned}\nS_{\\mathrm{fin}}'=&\\texttt{aaacdaa\\textcolor{red}a\\textcolor{red}c\\textcolor{red}daa\\textcolor{red}ac\\textcolor{red}daa\\textcolor{red}acdaa\\textcolor{red}acd}\\cr\nS_{\\mathrm{real}}=&\\texttt{aaacdaabbbaabccaabcdaabcd}\\cr\n\\end{aligned}$$\n\n相差为 $7$，不超过 $m=10$，可以被接受。\n\n### 数据范围及约定\n\n对于全部数据，保证 $l=3\\times 10^5$，$n=3\\times 10^3$，$m=10^4$，$1\\le l_{\\max} \\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「不死鸟附体」", "background": "死而复生，生而复死。所谓的不死鸟就是这样的一种生物，在无尽的时间里无尽地循环往复。\n\n果然最好还是别获得不老不死的能力吧。", "description": "不死鸟的「一生」可以被看成一个长度不超过 $l_{\\max}$ 的字符串 $S_0$。在无尽的轮回后形成了一个无限长的字符串 $S_{\\mathrm{inf}}=S_0+S_0+S_0+\\cdots$。现在截取 $S_{\\mathrm{inf}}$ 前 $l$ 个字符，作为可观测时间里不死鸟的生命 $S_{\\mathrm{fin}}$。\n\n然而所谓的轮回并不是机械死板的循环往复。因此，$S_\\mathrm{fin}$ 当中会有**不超过 $n$ 个字符**被修改成了别的字符，变成了 $S_{\\mathrm{real}}$。\n\n现在观测到了 $S_{\\mathrm{real}}$，我们希望找到这轮回的周期 $S_0$。然而由于不死鸟的轮回太过漫长，我们只希望找到这样一个 $S_0'$，使得由它生成的 $S_\\mathrm{fin}'$ 修改**不超过 $m$ 个字符**后就可以变成 $S_{\\mathrm{real}}$。\n", "inputFormat": "第一行有四个正整数 $l,l_{\\max},n,m$。\n\n第二行描述观测到的长度为 $l$ 的字符串 $S_{\\mathrm{real}}$。", "outputFormat": "第一行输出一个正整数 $l_0$，表示你所找到的 $S_0$ 的长度。你应当保证 $1\\le l_0\\le l_{\\max}$。\n\n第二行输出一个长度为 $l_0$ 的字符串 $S_0$，表示你所找到的字符串。", "hint": "### 样例解释\n\n样例仅供理解题意，**不符合数据范围的约束**。具体约束请参见「数据范围及约定」。\n\n生成 $S_{\\mathrm{real}}$ 所用的 $S_0=\\verb!aabcd!$。\n\n- 由此生成 $S_{\\mathrm{inf}}=\\verb!aabcdaabcdaabcdaabcdaabcd!\\cdots$；\n- 由此生成 $S_{\\mathrm{fin}}=\\verb!aabcdaabcdaabcdaabcdaabcd!$；\n- 由此生成 $S_{\\mathrm{real}\\kern{-2.5pt}}=\\verb!aaacdaabbbaabccaabcdaabcd!$。\n\n样例输出给出了一个可能的 $S_0'=\\verb!aaacd!$。由此计算出 $S_{\\mathrm{fin}}'$ 与 $S_{\\mathrm{real}}$ 的差距：\n\n$$\\begin{aligned}\nS_{\\mathrm{fin}}'=&\\texttt{aaacdaa\\textcolor{red}a\\textcolor{red}c\\textcolor{red}daa\\textcolor{red}ac\\textcolor{red}daa\\textcolor{red}acdaa\\textcolor{red}acd}\\cr\nS_{\\mathrm{real}}=&\\texttt{aaacdaabbbaabccaabcdaabcd}\\cr\n\\end{aligned}$$\n\n相差为 $7$，不超过 $m=10$，可以被接受。\n\n### 数据范围及约定\n\n对于全部数据，保证 $l=3\\times 10^5$，$n=3\\times 10^3$，$m=10^4$，$1\\le l_{\\max} \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P9212", "type": "P", "difficulty": 6, "samples": [["10 5\n4 3 2 5 8 5 3 3 1 2\n1 10 3 7 6\n4 10 5 5 4\n2 7 1 2 9\n5 9 3 4 7\n1 3 5 1 8", "4\n0\n6\n3\n2\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "分块", "根号分治", "传智杯"], "title": "「蓬莱人形」", "background": "不老不死的妹红，还能称之为「人类」吗？\n\n超脱了生死的人类，本来就是不可思议的啊。", "description": "为了证明人类的可能性，你需要解决一个问题。\n\n给定序列 $a=[a_1,a_2,\\cdots,a_n]$。现在有 $q$ 次询问：\n\n- 每次给定二元组 $(x,y)$、模数 $m$，以及一个区间 $[l,r]$。求出有多少 $i\\in [l,r]$ 满足 $(a_i+x)\\bmod m<(a_i+y)\\bmod m$。", "inputFormat": "第一行有两个正整数 $n, q$，表示序列长度及询问次数。\n\n第二行有 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，描述序列 $a$。\n\n接下来 $q$ 行，每行有五个整数 $l_i,r_i,x_i,y_i,m_i$，描述一组询问。", "outputFormat": "输出共 $q$ 行。第 $i$ 行输出第 $i$ 次询问的结果。", "hint": "### 样例解释\n\n- 对于第一组询问，符合条件的元素的下标为 $1, 2, 7, 8$；\n- 对于第二组询问，没有符合条件的元素；\n- 对于第三组询问，符合条件的元素的下标为 $2, 3, 4, 5, 6, 7$；\n- 对于第四组询问，符合条件的元素的下标为 $5, 6, 9$；\n- 对于第五组询问，符合条件的元素的下标为 $1, 2$。\n\n### 数据范围及约定\n\n对于全部数据，$1\\le n\\le 10^5$，$1\\le q\\le 5\\times 10^5$，$1\\le a_i,x_i,y_i,m_i\\le 10^5$，$1\\le l_i\\le r_i\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「蓬莱人形」", "background": "不老不死的妹红，还能称之为「人类」吗？\n\n超脱了生死的人类，本来就是不可思议的啊。", "description": "为了证明人类的可能性，你需要解决一个问题。\n\n给定序列 $a=[a_1,a_2,\\cdots,a_n]$。现在有 $q$ 次询问：\n\n- 每次给定二元组 $(x,y)$、模数 $m$，以及一个区间 $[l,r]$。求出有多少 $i\\in [l,r]$ 满足 $(a_i+x)\\bmod m<(a_i+y)\\bmod m$。", "inputFormat": "第一行有两个正整数 $n, q$，表示序列长度及询问次数。\n\n第二行有 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，描述序列 $a$。\n\n接下来 $q$ 行，每行有五个整数 $l_i,r_i,x_i,y_i,m_i$，描述一组询问。", "outputFormat": "输出共 $q$ 行。第 $i$ 行输出第 $i$ 次询问的结果。", "hint": "### 样例解释\n\n- 对于第一组询问，符合条件的元素的下标为 $1, 2, 7, 8$；\n- 对于第二组询问，没有符合条件的元素；\n- 对于第三组询问，符合条件的元素的下标为 $2, 3, 4, 5, 6, 7$；\n- 对于第四组询问，符合条件的元素的下标为 $5, 6, 9$；\n- 对于第五组询问，符合条件的元素的下标为 $1, 2$。\n\n### 数据范围及约定\n\n对于全部数据，$1\\le n\\le 10^5$，$1\\le q\\le 5\\times 10^5$，$1\\le a_i,x_i,y_i,m_i\\le 10^5$，$1\\le l_i\\le r_i\\le n$。", "locale": "zh-CN"}}}
{"pid": "P9213", "type": "P", "difficulty": 2, "samples": [["1\n8 2 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "Special Judge", "O2优化", "语言月赛"], "title": "[入门赛 #11] 移植柳树 (Hard Version)", "background": "**本题与 Easy Version 题意完全相同，不同的地方仅在于数据范围和单个测试点内含有的测试组数量。**\n\nHG 在上学的路上无聊的走着，看着这马路边的一排柳树，他的脑子里突然冒出了个奇怪的问题……", "description": "假设总共有 $n$ 棵柳树，每一棵间隔都为 $x$。\n\n现在他需要对这些树做一些操作，使得在「这 $n$ 棵树的起点不变」的同时，任意两棵树的间隔都为 $y$（$y > x$）。\n\n他被允许做的操作如下；\n\n\n- 移植树木：将一个位置的树木移到另一个位置上。\n\n如果对「起点不变」这个概念有疑惑，可以参照「样例解释」中的图例。\n\n显然操作是需要体力的，HG 想要让尽可能多的树维持原状。现在 HG 想知道，为了达成「任意两棵树的间隔都为 $y$」这个目标，他最多可以让多少棵树保持在原来的位置。\n\n请你帮帮他吧！", "inputFormat": "**本题单个测试点内含有多组测试数据。**\n\n输入共 $T + 1$ 行。\n\n第一行为一个整数 $T$，代表测试数据组数。  \n接下来 $T$ 行，每行三个整数 $n, x, y$，依次表示柳树的数量，未调整前每棵的间隔，想要达成的每棵的间隔。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示对于对应的输入数据，为了达成「任意两棵树的间隔都为 $y$」的目标， HG 最多可以让多少棵树保持在原来的位置。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6uguqush.png)\n\n图中的方块代表树。第一行为调整前，第二行为调整后的情况。标出的三个绿色的方块是不需要移动的树，除此之外其他树都需要移动。\n\n### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq T \\leq 10 ^ 5$，$1 \\leq n \\leq 10 ^ {18}$，$1 \\leq x < y \\leq 10 ^ 9$。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[入门赛 #11] 移植柳树 (Hard Version)", "background": "**本题与 Easy Version 题意完全相同，不同的地方仅在于数据范围和单个测试点内含有的测试组数量。**\n\nHG 在上学的路上无聊的走着，看着这马路边的一排柳树，他的脑子里突然冒出了个奇怪的问题……", "description": "假设总共有 $n$ 棵柳树，每一棵间隔都为 $x$。\n\n现在他需要对这些树做一些操作，使得在「这 $n$ 棵树的起点不变」的同时，任意两棵树的间隔都为 $y$（$y > x$）。\n\n他被允许做的操作如下；\n\n\n- 移植树木：将一个位置的树木移到另一个位置上。\n\n如果对「起点不变」这个概念有疑惑，可以参照「样例解释」中的图例。\n\n显然操作是需要体力的，HG 想要让尽可能多的树维持原状。现在 HG 想知道，为了达成「任意两棵树的间隔都为 $y$」这个目标，他最多可以让多少棵树保持在原来的位置。\n\n请你帮帮他吧！", "inputFormat": "**本题单个测试点内含有多组测试数据。**\n\n输入共 $T + 1$ 行。\n\n第一行为一个整数 $T$，代表测试数据组数。  \n接下来 $T$ 行，每行三个整数 $n, x, y$，依次表示柳树的数量，未调整前每棵的间隔，想要达成的每棵的间隔。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示对于对应的输入数据，为了达成「任意两棵树的间隔都为 $y$」的目标， HG 最多可以让多少棵树保持在原来的位置。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6uguqush.png)\n\n图中的方块代表树。第一行为调整前，第二行为调整后的情况。标出的三个绿色的方块是不需要移动的树，除此之外其他树都需要移动。\n\n### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq T \\leq 10 ^ 5$，$1 \\leq n \\leq 10 ^ {18}$，$1 \\leq x < y \\leq 10 ^ 9$。  ", "locale": "zh-CN"}}}
{"pid": "P9214", "type": "P", "difficulty": 2, "samples": [["5 10\n13 50 90 38 60 64 60 77 6 24", "1 6\n2 8\n3\n4 7\n5 9 10"], ["12 7\n85 99 82 90 14 11 15", "1\n2\n3\n4\n5\n6\n7\n0\n0\n0\n0\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "Special Judge", "O2优化", "语言月赛"], "title": "[入门赛 #11] 洛谷评测机模拟器 (Hard Version)", "background": "**本题与 Easy Version 题意完全相同，不同的地方在于数据范围。**\n\n现在假装你是洛谷评测机。这一天，洛谷同时进行了 PION 自测、SCP 自测、ION 自测等等比赛。成千上万的评测落到了你的身上！", "description": "现在已经知道你有 $n$ 个相同性能的评测节点，它们被分别标号为 $1, 2, \\cdots, n$。一个评测节点在同一时间只能处理一个评测任务。\n\n在某一时刻，$m$ 个评测任务同时涌入了你。我们将这些任务分别标号为 $1, 2, \\cdots, m$。这些评测任务需要的评测时间分别为 $t _ 1 , t _ 2, \\cdots, t _ m$。每个评测任务**需要且仅需要一个**评测节点来运行，因此你会按照如下方式按照 $1 \\sim m$ 的顺序依次将这些评测任务分配到评测节点上：\n\n对于某个耗时 $t _ i$ 的评测任务，你需要找到目前**累积评测时间**最小的评测节点将任务放入。如果有多个评测节点**累积评测时间**相同且最小，则找一个**标号最小**的节点将任务放入。\n\n> 「累积评测时间」定义：假设对于某个评测节点，其被分配了 $a _ 1, a _ 2, \\cdots, a _ k$ 共 $k$ 个任务。那么这个评测节点的「累积评测时间」就是 $t _ {a _ 1} + t _ {a _ 2} + \\cdots + t _ {a _ k}$。显然的，如果某个评测节点从未被分配过这 $m$ 个任务中的任何一个，那么这个评测节点的「累积评测时间」是 $0$。\n\n现在，你需要统计出，你的这 $n$ 个评测节点分别接受了哪一些评测任务。", "inputFormat": "输入共两行。\n\n第一行为两个整数 $n, m$，代表评测节点数量和评测任务数量。  \n第二行为 $m$ 个整数 $t _ 1, t _ 2, \\cdots, t _ m$，依次代表这 $m$ 个评测任务的所需时间。", "outputFormat": "输出共 $n$ 行，每行若干个整数，两两之间以一个空格隔开。\n\n对于第 $i$ 行，输出第 $i$ 个评测节点接受的评测任务编号从小到大排序后的结果。如果第 $i$ 个评测节点没有被分配任务，那么输出一行一个 $0$。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n, m \\leq 5 \\times 10 ^ 5$，$0 \\leq t _ i \\leq 10 ^ 9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[入门赛 #11] 洛谷评测机模拟器 (Hard Version)", "background": "**本题与 Easy Version 题意完全相同，不同的地方在于数据范围。**\n\n现在假装你是洛谷评测机。这一天，洛谷同时进行了 PION 自测、SCP 自测、ION 自测等等比赛。成千上万的评测落到了你的身上！", "description": "现在已经知道你有 $n$ 个相同性能的评测节点，它们被分别标号为 $1, 2, \\cdots, n$。一个评测节点在同一时间只能处理一个评测任务。\n\n在某一时刻，$m$ 个评测任务同时涌入了你。我们将这些任务分别标号为 $1, 2, \\cdots, m$。这些评测任务需要的评测时间分别为 $t _ 1 , t _ 2, \\cdots, t _ m$。每个评测任务**需要且仅需要一个**评测节点来运行，因此你会按照如下方式按照 $1 \\sim m$ 的顺序依次将这些评测任务分配到评测节点上：\n\n对于某个耗时 $t _ i$ 的评测任务，你需要找到目前**累积评测时间**最小的评测节点将任务放入。如果有多个评测节点**累积评测时间**相同且最小，则找一个**标号最小**的节点将任务放入。\n\n> 「累积评测时间」定义：假设对于某个评测节点，其被分配了 $a _ 1, a _ 2, \\cdots, a _ k$ 共 $k$ 个任务。那么这个评测节点的「累积评测时间」就是 $t _ {a _ 1} + t _ {a _ 2} + \\cdots + t _ {a _ k}$。显然的，如果某个评测节点从未被分配过这 $m$ 个任务中的任何一个，那么这个评测节点的「累积评测时间」是 $0$。\n\n现在，你需要统计出，你的这 $n$ 个评测节点分别接受了哪一些评测任务。", "inputFormat": "输入共两行。\n\n第一行为两个整数 $n, m$，代表评测节点数量和评测任务数量。  \n第二行为 $m$ 个整数 $t _ 1, t _ 2, \\cdots, t _ m$，依次代表这 $m$ 个评测任务的所需时间。", "outputFormat": "输出共 $n$ 行，每行若干个整数，两两之间以一个空格隔开。\n\n对于第 $i$ 行，输出第 $i$ 个评测节点接受的评测任务编号从小到大排序后的结果。如果第 $i$ 个评测节点没有被分配任务，那么输出一行一个 $0$。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n, m \\leq 5 \\times 10 ^ 5$，$0 \\leq t _ i \\leq 10 ^ 9$。", "locale": "zh-CN"}}}
