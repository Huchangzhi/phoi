{"pid": "P5046", "type": "P", "difficulty": 6, "samples": [["4 1\n1 4 2 3\n2 4", "2"]], "limits": {"time": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2019 模拟赛] Yuno loves sqrt technology I", "background": "![](https://cdn.luogu.com.cn/upload/pic/44003.png)\n", "description": "给你一个长为 $n$ 的**排列**，$m$ 次询问，每次查询一个区间的逆序对数，强制在线。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个正整数表示这个**排列**。\n\n之后 $m$ 行，每行两个整数表示查询的区间。\n\n本题强制在线，每次查询输入的数要 xor 上 $lastans$，第一次询问默认 $lastans=0$。", "outputFormat": "输出m行，每行一个数表示这次询问的答案", "hint": "$1\\leq n,m\\leq 10^5$。\n\n我们已经有了低于 $n^{1.5}$ 的在线算法。\n\nSource\nBy nzhtl1477", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2019 Mock Contest] Yuno loves sqrt technology I", "background": "![](https://cdn.luogu.com.cn/upload/pic/44003.png)", "description": "You are given a **permutation** of length $n$ and $m$ queries. Each query asks for the number of inversion pairs in a subarray interval, and the queries must be answered online.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains $n$ positive integers representing this **permutation**.\n\nThe next $m$ lines each contain two integers representing the query interval.\n\nThis problem is strictly online: for each query, the input numbers must be xor-ed with $lastans$. For the first query, $lastans = 0$ by default.", "outputFormat": "Output $m$ lines. Each line contains one integer, the answer to the corresponding query.", "hint": "$1 \\le n, m \\le 10^5$.\n\nWe already have an online algorithm with time complexity below $n^{1.5}$.\n\nSource: By nzhtl1477.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2019 模拟赛] Yuno loves sqrt technology I", "background": "![](https://cdn.luogu.com.cn/upload/pic/44003.png)\n", "description": "给你一个长为 $n$ 的**排列**，$m$ 次询问，每次查询一个区间的逆序对数，强制在线。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个正整数表示这个**排列**。\n\n之后 $m$ 行，每行两个整数表示查询的区间。\n\n本题强制在线，每次查询输入的数要 xor 上 $lastans$，第一次询问默认 $lastans=0$。", "outputFormat": "输出m行，每行一个数表示这次询问的答案", "hint": "$1\\leq n,m\\leq 10^5$。\n\n我们已经有了低于 $n^{1.5}$ 的在线算法。\n\nSource\nBy nzhtl1477", "locale": "zh-CN"}}}
{"pid": "P5047", "type": "P", "difficulty": 6, "samples": [["4 1\n1 4 2 3\n2 4", "2"]], "limits": {"time": [250, 250, 250, 250, 250], "memory": [32000, 32000, 32000, 32000, 32000]}, "tags": ["2019", "莫队", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2019 模拟赛] Yuno loves sqrt technology II", "background": "![](https://cdn.luogu.com.cn/upload/pic/44005.png)\n", "description": "给你一个长为 $n$ 的序列 $a$，$m$ 次询问，每次查询一个区间的逆序对数。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行两个整数表示查询的区间。", "outputFormat": "输出 $m$ 行，每行一个整数表示这次询问的答案。", "hint": "$1\\leq n,m \\leq 10^5$，$0 \\leq a_i \\leq 10^9$。\n\n我们已经有了低于 $n^{1.5}$ 的算法。\n\nSource\nBy nzhtl1477", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2019 Mock Contest] Yuno loves sqrt technology II", "background": "![](https://cdn.luogu.com.cn/upload/pic/44005.png)", "description": "You are given a sequence $a$ of length $n$ and $m$ queries. For each query, you need to find the number of inversion pairs in a given interval.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains $n$ integers representing the sequence.\n\nThen follow $m$ lines, each containing two integers representing the query interval.", "outputFormat": "Output $m$ lines, each with one integer representing the answer to the query.", "hint": "$1 \\leq n, m \\leq 10^5$, $0 \\leq a_i \\leq 10^9$.\n\nWe already have an algorithm faster than $n^{1.5}$.\n\nSource  \nBy nzhtl1477\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2019 模拟赛] Yuno loves sqrt technology II", "background": "![](https://cdn.luogu.com.cn/upload/pic/44005.png)\n", "description": "给你一个长为 $n$ 的序列 $a$，$m$ 次询问，每次查询一个区间的逆序对数。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行两个整数表示查询的区间。", "outputFormat": "输出 $m$ 行，每行一个整数表示这次询问的答案。", "hint": "$1\\leq n,m \\leq 10^5$，$0 \\leq a_i \\leq 10^9$。\n\n我们已经有了低于 $n^{1.5}$ 的算法。\n\nSource\nBy nzhtl1477", "locale": "zh-CN"}}}
{"pid": "P5048", "type": "P", "difficulty": 6, "samples": [["4 1\n2 3 3 3\n2 4", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000], "memory": [64000, 64000, 64000, 64000, 64000]}, "tags": ["2019", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2019 模拟赛] Yuno loves sqrt technology III", "background": "![](https://cdn.luogu.com.cn/upload/pic/44006.png)", "description": "给你一个长为 $n$ 的序列 $a$，$m$ 次询问，每次查询一个区间的众数的出现次数，强制在线。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行两个数表示查询的区间。\n\n本题强制在线，每次查询输入的数要 $\\operatorname{xor}$ 上 $lastans$，第一次询问默认 $lastans=0$。", "outputFormat": "输出 $m$ 行，每行一个数表示这次询问的答案。", "hint": "$1\\leq n,m,a_i \\leq 5\\times 10^5$。\n\n存在 $O( n^{1.48541} )$ 的算法。\n\nSource By nzhtl1477.", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2019 Mock Contest] Yuno loves sqrt technology III", "background": "![](https://cdn.luogu.com.cn/upload/pic/44006.png)", "description": "You are given a sequence $a$ of length $n$ and $m$ queries. For each query, you need to output the number of occurrences of the mode in a given interval, and the queries are forced to be online.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains $n$ integers representing the sequence.\n\nThen follow $m$ lines, each containing two numbers representing the query interval.\n\nThis problem is forced to be online: in each query, the input numbers should be $\\operatorname{xor}$ with $lastans$. For the first query, $lastans = 0$ by default.", "outputFormat": "Output $m$ lines, each line contains one integer representing the answer to the query.", "hint": "$1\\leq n, m, a_i \\leq 5\\times 10^5$。\n\nThere exists an $O( n^{1.48541} )$ algorithm.\n\nSource By nzhtl1477.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2019 模拟赛] Yuno loves sqrt technology III", "background": "![](https://cdn.luogu.com.cn/upload/pic/44006.png)", "description": "给你一个长为 $n$ 的序列 $a$，$m$ 次询问，每次查询一个区间的众数的出现次数，强制在线。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行两个数表示查询的区间。\n\n本题强制在线，每次查询输入的数要 $\\operatorname{xor}$ 上 $lastans$，第一次询问默认 $lastans=0$。", "outputFormat": "输出 $m$ 行，每行一个数表示这次询问的答案。", "hint": "$1\\leq n,m,a_i \\leq 5\\times 10^5$。\n\n存在 $O( n^{1.48541} )$ 的算法。\n\nSource By nzhtl1477.", "locale": "zh-CN"}}}
{"pid": "P5049", "type": "P", "difficulty": 6, "samples": [["6 5 \n1 3 \n2 3 \n2 5 \n3 4 \n4 6", "1 3 2 5 4 6"], ["6 6 \n1 3 \n2 3 \n2 5 \n3 4 \n4 5 \n4 6", "1 3 2 4 5 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2018", "NOIP 提高组", "基环树"], "title": "[NOIP 2018 提高组] 旅行 加强版", "background": "", "description": "小 Y 是一个爱好旅行的 OIer。她来到 X 国，打算将各个城市都玩一遍。 \n  \n小Y了解到，X 国的 $n$ 个城市之间有 $m$ 条双向道路。每条双向道路连接两个城市。 不存在两条连接同一对城市的道路，也不存在一条连接一个城市和它本身的道路。并且， 从任意一个城市出发，通过这些道路都可以到达任意一个其他城市。小 Y 只能通过这些 道路从一个城市前往另一个城市。   \n\n小 Y 的旅行方案是这样的：任意选定一个城市作为起点，然后从起点开始，每次可 以选择一条与当前城市相连的道路，走向一个没有去过的城市，或者沿着第一次访问该 城市时经过的道路后退到上一个城市。当小 Y 回到起点时，她可以选择结束这次旅行或 继续旅行。需要注意的是，小 Y 要求在旅行方案中，每个城市都被访问到。   \n\n为了让自己的旅行更有意义，小 Y 决定在每到达一个新的城市（包括起点）时，将 它的编号记录下来。她知道这样会形成一个长度为 $n$ 的序列。她希望这个序列的字典序 最小，你能帮帮她吗？  对于两个长度均为 $n$ 的序列 $A$ 和 $B$，当且仅当存在一个正整数 $x$，满足以下条件时， 我们说序列 $A$ 的字典序小于 $B$。 \n  \n- 对于任意正整数 $1 ≤ i < x$，序列 $A$ 的第 $i$ 个元素 $A_i$ 和序列 $B$ 的第 $i$ 个元素 $B_i$ 相同。   \n- 序列 $A$ 的第 $x$ 个元素的值小于序列 $B$ 的第 $x$ 个元素的值。 ", "inputFormat": "输入文件共 $m + 1$ 行。第一行包含两个整数 $n,m(m ≤ n)$，中间用一个空格分隔。\n \n接下来 m 行，每行包含两个整数 $u,v (1 ≤ u,v ≤ n)$ ，表示编号为 $u$ 和 $v$ 的城市之 间有一条道路，两个整数之间用一个空格分隔。 ", "outputFormat": "输出文件包含一行，$n$ 个整数，表示字典序最小的序列。相邻两个整数之间用一个 空格分隔。 ", "hint": "【数据规模与约定】   \n\n对于 $100\\%$ 的数据和所有样例， $1 \\le n \\le 500000 $ 且 $m = n - 1$ 或 $m = n$ 。\n\n具体规定详见正常版本（除 testcase11-13）", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Senior] Travel Enhanced Version.", "background": "", "description": "Xiao Y is an OIer who loves traveling. She came to Country X and plans to visit all the cities.\n\nXiao Y learned that there are $n$ cities in Country X with $m$ two-way roads between them. Each two-way road connects two cities. There are no two roads connecting the same pair of cities, and there is no road connecting a city to itself. Also, starting from any city, one can reach any other city through these roads. Xiao Y can only travel from one city to another using these roads.\n\nXiao Y's travel plan is as follows: she can choose any city as the starting point, and then starting from the starting point, each time she can choose a road connected to the current city to go to a city she has not visited yet, or she can go back to the previous city along the road she used when she first visited the current city. When Xiao Y returns to the starting point, she may choose to end the trip or continue traveling. Note that Xiao Y requires that in the travel plan, every city must be visited.\n\nTo make her trip more meaningful, Xiao Y decides that each time she arrives at a new city (including the starting point), she will record its index. She knows this will form a sequence of length $n$. She wants this sequence to be lexicographically smallest. Can you help her?\n\nFor two sequences $A$ and $B$ of length $n$, we say that $A$ is lexicographically smaller than $B$ if and only if there exists a positive integer $x$ such that the following conditions hold:\n\n- For any positive integer $1 \\le i < x$, the $i$-th element $A_i$ of $A$ is equal to the $i$-th element $B_i$ of $B$.\n- The value of the $x$-th element of $A$ is less than the value of the $x$-th element of $B$.", "inputFormat": "The input file contains a total of $m + 1$ lines. The first line contains two integers $n, m (m \\le n)$, separated by a single space.\n\nThe next $m$ lines each contain two integers $u, v (1 \\le u, v \\le n)$, indicating that there is a road between the cities indexed $u$ and $v$. The two integers are separated by a single space.", "outputFormat": "The output file contains one line with $n$ integers, representing the lexicographically smallest sequence. Adjacent integers are separated by a single space.", "hint": "Constraints.\n\nFor $100\\%$ of the data and all samples, $1 \\le n \\le 500000$ and $m = n - 1$ or $m = n$.\n\nFor detailed specifications, see the normal version (excluding testcase11-13).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 提高组] 旅行 加强版", "background": "", "description": "小 Y 是一个爱好旅行的 OIer。她来到 X 国，打算将各个城市都玩一遍。 \n  \n小Y了解到，X 国的 $n$ 个城市之间有 $m$ 条双向道路。每条双向道路连接两个城市。 不存在两条连接同一对城市的道路，也不存在一条连接一个城市和它本身的道路。并且， 从任意一个城市出发，通过这些道路都可以到达任意一个其他城市。小 Y 只能通过这些 道路从一个城市前往另一个城市。   \n\n小 Y 的旅行方案是这样的：任意选定一个城市作为起点，然后从起点开始，每次可 以选择一条与当前城市相连的道路，走向一个没有去过的城市，或者沿着第一次访问该 城市时经过的道路后退到上一个城市。当小 Y 回到起点时，她可以选择结束这次旅行或 继续旅行。需要注意的是，小 Y 要求在旅行方案中，每个城市都被访问到。   \n\n为了让自己的旅行更有意义，小 Y 决定在每到达一个新的城市（包括起点）时，将 它的编号记录下来。她知道这样会形成一个长度为 $n$ 的序列。她希望这个序列的字典序 最小，你能帮帮她吗？  对于两个长度均为 $n$ 的序列 $A$ 和 $B$，当且仅当存在一个正整数 $x$，满足以下条件时， 我们说序列 $A$ 的字典序小于 $B$。 \n  \n- 对于任意正整数 $1 ≤ i < x$，序列 $A$ 的第 $i$ 个元素 $A_i$ 和序列 $B$ 的第 $i$ 个元素 $B_i$ 相同。   \n- 序列 $A$ 的第 $x$ 个元素的值小于序列 $B$ 的第 $x$ 个元素的值。 ", "inputFormat": "输入文件共 $m + 1$ 行。第一行包含两个整数 $n,m(m ≤ n)$，中间用一个空格分隔。\n \n接下来 m 行，每行包含两个整数 $u,v (1 ≤ u,v ≤ n)$ ，表示编号为 $u$ 和 $v$ 的城市之 间有一条道路，两个整数之间用一个空格分隔。 ", "outputFormat": "输出文件包含一行，$n$ 个整数，表示字典序最小的序列。相邻两个整数之间用一个 空格分隔。 ", "hint": "【数据规模与约定】   \n\n对于 $100\\%$ 的数据和所有样例， $1 \\le n \\le 500000 $ 且 $m = n - 1$ 或 $m = n$ 。\n\n具体规定详见正常版本（除 testcase11-13）", "locale": "zh-CN"}}}
{"pid": "P5050", "type": "P", "difficulty": 7, "samples": [["10 10\n18 2 6 17 7 19 17 6 2 12 14\n4 15 5 20 2 6 20 12 16 5\n", "18147258\n804760733\n161737928\n73381527\n23750\n973451550\n73381527\n525589927\n842520242\n161737928\n"]], "limits": {"time": [1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式多点求值", "background": "", "description": "给定一个 $n$ 次多项式 $f(x)$ ，现在请你对于 $i \\in [1,m]$ ，求出 $f(a_i)$ 。", "inputFormat": "第一行两个正整数 $n,m$ 表示多项式的次数及你要求的点值的数量。\n\n第二行 $n+1$ 个非负整数，由低到高地给出多项式的系数。\n\n第三行 $m$ 个非负整数，表示 $a_i$ 。", "outputFormat": "一共 $m$ 行，每行 $1$ 个非负整数。\n\n第 $i$ 行的数字表示 $f(a_i)$ 。\n\n答案对 $998244353$ 取模。", "hint": "$n,m \\in [1,64000]$，$a_i,[x^i]f(x) \\in [0,998244352]$ 。\n\n$[x^i]f(x)$ 表示 $f(x)$ 的 $i$ 次项系数。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Multipoint Evaluation of a Polynomial", "background": "", "description": "Given an $n$-degree polynomial $f(x)$, for each $i \\in [1,m]$, compute $f(a_i)$.", "inputFormat": "The first line contains two positive integers $n,m$, representing the degree of the polynomial and the number of points to evaluate.\n\nThe second line contains $n+1$ non-negative integers, giving the coefficients of the polynomial from low degree to high degree.\n\nThe third line contains $m$ non-negative integers, representing $a_i$.", "outputFormat": "Output a total of $m$ lines, each containing $1$ non-negative integer.\n\nThe number on line $i$ represents $f(a_i)$.\n\nThe answer should be taken modulo $998244353$.", "hint": "Constraints: $n,m \\in [1,64000]$, $a_i,[x^i]f(x) \\in [0,998244352]$.\n\n$[x^i]f(x)$ represents the coefficient of the $i$-th term of $f(x)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式多点求值", "background": "", "description": "给定一个 $n$ 次多项式 $f(x)$ ，现在请你对于 $i \\in [1,m]$ ，求出 $f(a_i)$ 。", "inputFormat": "第一行两个正整数 $n,m$ 表示多项式的次数及你要求的点值的数量。\n\n第二行 $n+1$ 个非负整数，由低到高地给出多项式的系数。\n\n第三行 $m$ 个非负整数，表示 $a_i$ 。", "outputFormat": "一共 $m$ 行，每行 $1$ 个非负整数。\n\n第 $i$ 行的数字表示 $f(a_i)$ 。\n\n答案对 $998244353$ 取模。", "hint": "$n,m \\in [1,64000]$，$a_i,[x^i]f(x) \\in [0,998244352]$ 。\n\n$[x^i]f(x)$ 表示 $f(x)$ 的 $i$ 次项系数。", "locale": "zh-CN"}}}
{"pid": "P5051", "type": "P", "difficulty": 2, "samples": [["2 1 3", "2 1"], ["3 2 7", "2 3 2"], ["4 5 6", "5 1 0 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #7] Timovi", "background": "", "description": "We need to arrange M kids in N teams. We begin by placing K kids in each team, starting\nfrom the first to the $N^{th}$\nteam. When we finish with the $N^{th}$\nteam, we switch directions and\ncontinue, placing K kids in each team, from the $(N-1)^{th}$\nto the first team, respectively. When\nwe finish with the first team, we switch directions again and continue the process from the\nsecond to the $N^{th}$\nteam, respectively, and so on until there are no kids left to distribute. For\nexample, if we have three teams, we will place K kids in teams in the following order: first\nteam, second team, third team, second team, first team, second team, etc.\n\nIf, at any points, there are less than K kids left to place in the current team, we place all the\nremaining kids in that team and end the process.\n\nOutput the number of kids in each team when the process ends.", "inputFormat": "The first line of input contains the integers N (2 ≤ N ≤ 200 000), K and M\n(1 ≤ K ≤ M ≤ 2 000 000 000) from the task.", "outputFormat": "In a single line, output the number of kids in each of the N teams, respectively from the first\nto the $N^{th}$\nteam.", "hint": "In test cases worth a total of 40 points, it will hold M / K ≤ 200 000.\n", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #7] Timovi", "background": "", "description": "We need to arrange M kids in N teams. We begin by placing K kids in each team, starting\nfrom the first to the $N^{th}$\nteam. When we finish with the $N^{th}$\nteam, we switch directions and\ncontinue, placing K kids in each team, from the $(N-1)^{th}$\nto the first team, respectively. When\nwe finish with the first team, we switch directions again and continue the process from the\nsecond to the $N^{th}$\nteam, respectively, and so on until there are no kids left to distribute. For\nexample, if we have three teams, we will place K kids in teams in the following order: first\nteam, second team, third team, second team, first team, second team, etc.\n\nIf, at any points, there are less than K kids left to place in the current team, we place all the\nremaining kids in that team and end the process.\n\nOutput the number of kids in each team when the process ends.", "inputFormat": "The first line of input contains the integers N (2 ≤ N ≤ 200 000), K and M\n(1 ≤ K ≤ M ≤ 2 000 000 000) from the task.", "outputFormat": "In a single line, output the number of kids in each of the N teams, respectively from the first\nto the $N^{th}$\nteam.", "hint": "In test cases worth a total of 40 points, it will hold M / K ≤ 200 000.\n", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #7] Timovi", "background": "", "description": "把$m$个人放在$n$个队伍里。\n规则：\n- 每次放$k$个人\n- 顺序为$1^{th}$->$2^{th}$->$3^{th}$->……->$(n-1)^{th}$->$n^{th}$->$(n-1)^{th}$->$(n-2)^{th}$->……->$2^{th}$->$1^{th}$->$2^{th}$->……\n- 一直重复到$\\text{当前剩余人数}<k$为止。此时剩下的人全部放在当前队里", "inputFormat": "", "outputFormat": "", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5052", "type": "P", "difficulty": 5, "samples": [["10 5 4\n1 30 4\n3 5 7\n7 10 12\n9 100 23", "115 "], ["20 8 7\n1 35 14\n4 57 1\n6 32 2\n9 94 28\n14 78 8\n15 8 1\n17 55 3\n", "172"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #7] Go", "background": "", "description": "Branimirko is still a passionate player of the world-renowned game Pokémon Go. Recently,\nhe decided to organize a competition in catching Pokémon. It will be held in Ilica street in\nZagreb, and the main sponsor is his friend Slavko. The reward is, of course, candy!\n\nIlica is, as we all know, the longest street in Zagreb. There are N houses on the same side of\nthe street, and each house has a house number between 1 and N. The competition begins\nat house number K.\n\nBefore the competition, Branimirko looked at the map and saw M Pokémon. Each Pokémon\nis located at its (distinct) house number Ai\n, is valued at Bi candy, and can be caught only in\nthe next Ti seconds, after which it disappears from the map and is impossible to catch.\n\nBranimirko can visit one house number per second. Also, when he catches a Pokémon, that\nPokémon disappears from the map.\n\nSince Branimirko really likes candy, he asked for your help.\n\nHelp him and determine the maximal amount of candy he can get!", "inputFormat": "The first line of input contains integers N, K (1 ≤ K ≤ N ≤ 1 000) and M (1 ≤ M ≤ 100), the\nnumber of houses, the starting house number and the number of Pokémon.\n\nEach of the following M lines contains integers $A_i$\n(1 ≤ $A_i$ ≤ N), $B_i$\n(1 ≤ $B_i$ ≤ 100) and $T_i$\n(1 ≤ $T_i$ ≤\n2 000) from the task.\nIn the input data, the Pokémon will always be in a strictly ascending order by house number $A_i$ .", "outputFormat": "You must output the required maximal amount of candy from the task.\n", "hint": "In test cases worth 20% of total points, it will hold M ≤ 10.\n\nIn additional 20% of total points, it will hold M ≤ 20.\n\n**Clarification of the first test case:**\n\nOne strategy is that Branimirko first catches the Pokémon at house number 3 (5 candy), then,\nrespectively, house numbers 7 (10 candy) and 9 (100 candy) for a total of 115 candy.\n\nNotice that Branimirko can’t catch the Pokémon at house number 1, because he can’t reach it in time\nfrom his starting position (house number 5).", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #7] Go", "background": "", "description": "Branimirko is still a passionate player of the world-renowned game Pokémon Go. Recently,\nhe decided to organize a competition in catching Pokémon. It will be held in Ilica street in\nZagreb, and the main sponsor is his friend Slavko. The reward is, of course, candy!\n\nIlica is, as we all know, the longest street in Zagreb. There are N houses on the same side of\nthe street, and each house has a house number between 1 and N. The competition begins\nat house number K.\n\nBefore the competition, Branimirko looked at the map and saw M Pokémon. Each Pokémon\nis located at its (distinct) house number Ai\n, is valued at Bi candy, and can be caught only in\nthe next Ti seconds, after which it disappears from the map and is impossible to catch.\n\nBranimirko can visit one house number per second. Also, when he catches a Pokémon, that\nPokémon disappears from the map.\n\nSince Branimirko really likes candy, he asked for your help.\n\nHelp him and determine the maximal amount of candy he can get!", "inputFormat": "The first line of input contains integers N, K (1 ≤ K ≤ N ≤ 1 000) and M (1 ≤ M ≤ 100), the\nnumber of houses, the starting house number and the number of Pokémon.\n\nEach of the following M lines contains integers $A_i$\n(1 ≤ $A_i$ ≤ N), $B_i$\n(1 ≤ $B_i$ ≤ 100) and $T_i$\n(1 ≤ $T_i$ ≤\n2 000) from the task.\nIn the input data, the Pokémon will always be in a strictly ascending order by house number $A_i$ .", "outputFormat": "You must output the required maximal amount of candy from the task.\n", "hint": "In test cases worth 20% of total points, it will hold M ≤ 10.\n\nIn additional 20% of total points, it will hold M ≤ 20.\n\n**Clarification of the first test case:**\n\nOne strategy is that Branimirko first catches the Pokémon at house number 3 (5 candy), then,\nrespectively, house numbers 7 (10 candy) and 9 (100 candy) for a total of 115 candy.\n\nNotice that Branimirko can’t catch the Pokémon at house number 1, because he can’t reach it in time\nfrom his starting position (house number 5).", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #7] Go", "background": "", "description": "Branimirko 是世界著名游戏 Pokémon Go 的一位热情玩家。最近，他决定组织一场抓小精灵的比赛。比赛将在 Zagreb 的 Ilica 大街举行，主要赞助商是他的朋友 Slavko。奖励当然是糖果!\n\n我们都知道，Ilica 是 Zagreb 最长的街道。在街道的同一侧有 $N$ 栋房子，房子从左到右分别依次有 $1$ 到 $N$ 的门牌号。\n\n比赛前，Branimirko 看了看地图，发现了一共有 $M$ 只小精灵。每个小精灵都位于自己的各不相同的房子里，第 $i$ 个房子门牌号为 $A_i$，小精灵价值 $B_i$ 个糖果，并且只能在 $T_i$ 秒内被抓，之后它就会从地图上消失。\n\nBranimirko 第 $1$ 秒在门牌号为 $K$ 的房子。接下来每一秒它可以移动到门牌号相邻的房子，或者不移动。当他在一个时刻和一只小精灵处在相同的房子时，他就会抓住这只小精灵，获得其对应的糖果，且这只小精灵就从地图上消失了。\n\n因为 Branimirko 真的很喜欢糖果，所以他请求你的帮助。\n\n帮助他求出他可以得到多少糖果。", "inputFormat": "输入的第一行包含三个整数 $N,K$（$1\\le K\\le N\\le 10^3$）和 $M$（$1\\le M\\le 100$），代表房子数目，比赛开始的房子门牌号和小精灵的数量。\n\n接下来的 $M$ 行每一行都包含三个整数 $A_i$（$1\\le A_i\\le N$），$B_i$（$1\\le B_i\\le 100$）和 $T_i$（$1\\le T_i\\le 2000$）。在输入数据中，小精灵始终按照房间号 $A_i$ 严格升序给出。", "outputFormat": "输出可获取的最大糖果数量。\n\n\n### 说明\n\n在测试用例中，对于 $20\\%$ 的数据，满足 $M\\le 10$。\n\n对于另外 $20\\%$ 的数据，满足 $M\\le 20$。\n\n### 样例 1 解释\n\n一种策略是，Branimirko 首先在第 $3$ 个房子（$5$ 颗糖果）捕捉小精灵，然后分别在第 $7$ 个房子（$10$ 颗糖果）和第 $9$ 个房子（$100$ 颗糖果），总共 $115$ 颗糖果。\n\n注意到 Branimirko 无法在 $1$ 号房子里抓住小精灵，因为他无法从他的起始位置（$5$ 号房子）及时到达这里。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5053", "type": "P", "difficulty": 3, "samples": [["12 13\n..+--+.......\n+-|..|.......\n|.|.1|--+....\n|.+--+..|....\n|......+----+\n+---+..|..2.|\n....|..+----+\n.+--+........\n.|...........\n+---+........\n|.3.|........\n+---+........", "2\n3\n1"], ["8 10\n..........\n.......+-+\n...+---|1|\n...|...+-+\n...|......\n..+-+.....\n..|2|.....\n..+-+.....\n", "2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #7] Clickbait", "background": "", "description": "While surfing online, Slavko came across an ad displaying a system of containers and pipes\n(an example of such system is illustrated in the image below) with the message: “If container\n**1** starts filling up with water, determine the order in which the containers get filled up.”\n\n![](https://cdn.luogu.com.cn/upload/pic/44318.png)\n\nThe system consists of K containers denoted with numbers from 1 to K, and we can describe\nit using a matrix of characters with N rows and M columns. The containers are **in the shape of a rectangle**​, and the outlines of the containers and pipes are shown with the following\ncharacters:\n\n-  ‘-’ if it’s a horizontal part of the outline,\n-  ‘|’ if it’s a vertical part of the outline, and\n-  ‘+’ if it’s a spot where the horizontal and vertical parts of the outline connect. An exception is where the containers and pipes connect. In that case, the container outline dominates (see sample tests).\n\nIn an arbitrary place within each container, there is a string of digits that represent the label\nof the container, and all the other fields in the matrix are equal to ‘.’ (dot).\n\nAll containers except the one labeled with 1 have **exactly one** supply pipe that enters the\ncontainer in its **upper side**​. The container labeled with 1 does not have a supply pipe.\n\nThe containers can have multiple (also possible, zero) discharge pipes that leave the\ncontainer out of its **lateral side**​. The places where discharge pipes leave a container will be\nin mutually **distinct rows** in the matrix.\n\nThe pipes directly connect two containers, which means that **it is not possible** to split the\npipes or connect multiple pipes into one, and no two pipes will intersect. On their way,\nlooking from the source to the destination container, the pipes always descend to the\nfollowing row or stay in the same row. In other words, they never go back to the previous\nrow, so the water can flow freely from one container to another.\n\nThe water enters a container until it is full. If the water level reaches the level of the\ndischarge pipe, the water will flow through that pipe until the container the pipe leads into is\nfilled up.\n\nHelp Slavko and determine the order in which the containers will fill up.\n\n**Please note:**\n- The test data is such that each character ‘+’ is surrounded with **exactly one character** ‘-’ to the left or the right side and **exactly one** character ‘|’ to the upper or lower side, and **all other** adjacent characters in directions up, down, left and right will be equal to ‘.’ (dot).\n- The only places where the pipe in the matrix is in a field adjacent to the container outline are the places where the pipe enters or exits the container. In other words, a pipe will never run right next to a container (except where it connects with the\ncontainer). The entry for the supply pipe is labeled with the character ‘|’ above a container, whereas the exit of the discharge pipe is labeled with the character ‘-’ on the lateral side of a container.", "inputFormat": "The first line contains two integers N and M (1 ≤ N, M ≤ 1000), matrix dimensions.\n\nThe following N lines contain M characters describing the container system.", "outputFormat": "You must output K lines. The $i^{th}$\nline contains the label of the container that fills up $i^{th}$\n. A\nsolution will always exist and will be unique.", "hint": "In test cases worth 70% of total points, it will hold N, M ≤ 100.\n\n**Clarification of the first test case:**\n\nContainer 1 starts filling up with water.\n\nThe water level in container 1 grows, and in one moment reaches the level of the discharge pipe leading to container 2. The water flows through the pipe until container 2 fills up.\n\nAfter that, the water level in container 1 keeps growing until it reaches the level of the discharge pipe leading to container 3, which fills up next.\n\nFinally, the water level in container 1 keeps growing and the container fills up.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #7] Clickbait", "background": "", "description": "While surfing online, Slavko came across an ad displaying a system of containers and pipes\n(an example of such system is illustrated in the image below) with the message: “If container\n**1** starts filling up with water, determine the order in which the containers get filled up.”\n\n![](https://cdn.luogu.com.cn/upload/pic/44318.png)\n\nThe system consists of K containers denoted with numbers from 1 to K, and we can describe\nit using a matrix of characters with N rows and M columns. The containers are **in the shape of a rectangle**​, and the outlines of the containers and pipes are shown with the following\ncharacters:\n\n-  ‘-’ if it’s a horizontal part of the outline,\n-  ‘|’ if it’s a vertical part of the outline, and\n-  ‘+’ if it’s a spot where the horizontal and vertical parts of the outline connect. An exception is where the containers and pipes connect. In that case, the container outline dominates (see sample tests).\n\nIn an arbitrary place within each container, there is a string of digits that represent the label\nof the container, and all the other fields in the matrix are equal to ‘.’ (dot).\n\nAll containers except the one labeled with 1 have **exactly one** supply pipe that enters the\ncontainer in its **upper side**​. The container labeled with 1 does not have a supply pipe.\n\nThe containers can have multiple (also possible, zero) discharge pipes that leave the\ncontainer out of its **lateral side**​. The places where discharge pipes leave a container will be\nin mutually **distinct rows** in the matrix.\n\nThe pipes directly connect two containers, which means that **it is not possible** to split the\npipes or connect multiple pipes into one, and no two pipes will intersect. On their way,\nlooking from the source to the destination container, the pipes always descend to the\nfollowing row or stay in the same row. In other words, they never go back to the previous\nrow, so the water can flow freely from one container to another.\n\nThe water enters a container until it is full. If the water level reaches the level of the\ndischarge pipe, the water will flow through that pipe until the container the pipe leads into is\nfilled up.\n\nHelp Slavko and determine the order in which the containers will fill up.\n\n**Please note:**\n- The test data is such that each character ‘+’ is surrounded with **exactly one character** ‘-’ to the left or the right side and **exactly one** character ‘|’ to the upper or lower side, and **all other** adjacent characters in directions up, down, left and right will be equal to ‘.’ (dot).\n- The only places where the pipe in the matrix is in a field adjacent to the container outline are the places where the pipe enters or exits the container. In other words, a pipe will never run right next to a container (except where it connects with the\ncontainer). The entry for the supply pipe is labeled with the character ‘|’ above a container, whereas the exit of the discharge pipe is labeled with the character ‘-’ on the lateral side of a container.", "inputFormat": "The first line contains two integers N and M (1 ≤ N, M ≤ 1000), matrix dimensions.\n\nThe following N lines contain M characters describing the container system.", "outputFormat": "You must output K lines. The $i^{th}$\nline contains the label of the container that fills up $i^{th}$\n. A\nsolution will always exist and will be unique.", "hint": "In test cases worth 70% of total points, it will hold N, M ≤ 100.\n\n**Clarification of the first test case:**\n\nContainer 1 starts filling up with water.\n\nThe water level in container 1 grows, and in one moment reaches the level of the discharge pipe leading to container 2. The water flows through the pipe until container 2 fills up.\n\nAfter that, the water level in container 1 keeps growing until it reaches the level of the discharge pipe leading to container 3, which fills up next.\n\nFinally, the water level in container 1 keeps growing and the container fills up.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #7] Clickbait", "background": "", "description": "在上网的时候，Slavko遇到了一个广告，这个广告上面有一个由容器和管道组成的系统（如图是一个系统的例子）和一行字：“如果往编号为1的容器里注水，请确定这些容器被注满水的顺序。”\n这个系统包含K个编号为1到K的容器，并且我们可以用一个N×M的矩阵来描述它。**这些容器的形状为长方形**。容器和管道的轮廓将用这些字符表示：\n- 如果字符为‘-’，那么这个位置是容器和管道的轮廓的水平部分。\n- 如果字符为‘|’，那么这个位置是容器和管道的轮廓的垂直部分。\n- 如果字符为‘+’，那么这个位置同时是容器和管道的轮廓的水平和垂直部分。（即容器的四个角，管道的拐弯部分），一个例外是容器与管道的相交部分，在这个位置不使用+。\n在每一个容器内的某个位置内，都存在一个表示这个容器编号的数字串。矩阵内既不是容器和管道的轮廓，又不是表示容器编号的数字串的位置上的字符为'.'。\n除了编号为1的容器以外，所有的容器的**顶部都接入且只接入了一条可以使水进入容器的**管道。编号为1的容器的顶部没有管道。\n每个容器的**侧面**可以接入多条（也可以没有）可以使水流出容器的管道。**没有两个可以使水流出容器的管道与容器的连接处在同一个高度。**\n管道必须有方向的连接两个容器，这也就意味着一条管道**不能**在某些地方分成两条管道，或是两条管道交汇成一条管道，并且没有两条管道会相交。并且管道永远不会向上拐弯，所以可以保证管道里的水可以正常的向下流动并且流入对应接入的容器里。\n水只能进入没有被装满水的容器。如果一个容器中的水位达到了可以使水流出的管道的高度，水将会流入这个管道的另一端所接入的容器里，直到那个容器满了为止。\n请帮助Slavko确定这些容器被注满水的顺序。\n**请注意：**\n- 在矩阵中，每一个字符'+'都**有且仅有一个**'-'字符在其左边或右边与其相邻，并且**有且仅有一个**'|'字符在其上边或下边与其相邻。其余的与其相邻的字符将均为'.'。\n- 在字符矩阵中，管道与容器轮廓相邻的唯一可能的位置是管道与容器连接的位置。换句话说，除了管道与容器连接的情况，管道不可能与容器相邻。在与容器连接的位置，管道使水流入容器的一端用'|'标识，使水流出容器的一端用'-'标识。", "inputFormat": "第一行，两个整数N,M(1≤N,M≤1000)，表示矩阵的大小。\n接下来的N行，每行M个字符，描述了如题目所述的容器系统。", "outputFormat": "你必须输出K行。第i行表示第i个被注满水的容器的编号。输入保证存在唯一解。\n\n说明\n\n对于$70%$的数据，满足N,M≤100。\n样例1的解释：\n开始向容器1注水。\n容器1中的水位升高，并且在某个时刻达到通向容器2的管道的高度。水流进管道并最终流向容器2，直到容器2装满水为止。\n此后，容器1中的水位继续升高，直到达到通向容器3的管道的高度，水流进管道并最终流向容器3，直到容器3装满水为止。\n最后，容器1中的水位持续升高，直到容器1装满水。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5054", "type": "P", "difficulty": 4, "samples": [["3 5\n9 2 5\n1 2\n1 3\n", "14"], ["4 5\n1 1 1 2\n1 2\n2 3\n3 4\n", "3"], ["5 10\n1 3 5 2 4\n5 2\n3 1\n2 3\n4 2", "15"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #7] Dostavljač", "background": "", "description": "Ever since Krešo started growing chili peppers, N restaurants all over Croatia showed\ninterest in his peppers so they could enrich their dishes with real spice. Because of high\ndemand, Krešo decided to start working as a delivery guy of chili peppers.\n\nThe restaurants are denoted with numbers from 1 to N and are mutually connected with N -\n1 roads such that traveling between any two restaurants is possible. Krešo begins his\njourney in the restaurant denoted with 1. In one unit of time, he can either drive to the\nadjacent restaurant or deliver the peppers to the current restaurant. For each restaurant, we\nknow the required amount of peppers $A_i$.\n\nSince delivering goods is tiring, Krešo decided to spend a total of M units of time on delivery\nand travel, after which he plans to take a break.\n\nDetermine the maximal amount of peppers Krešo can deliver in the given timeframe. You\ncan assume that Krešo always carries an unlimited supply of peppers.", "inputFormat": "The first line of input contains two integers N and M (1 ≤ N, M ≤ 500), the number of\nrestaurants and the time Krešo plans to spend delivering peppers.\n\nThe second line of input contains N integers $A_i$\n(1 ≤ $A_i$ ≤ $10^6$\n), the required amount of peppers\nfor restaurants denoted with i (1 ≤ i ≤ N).\n\nEach of the following N - 1 lines contains two integers U and V (1 ≤ U, V ≤ N, U ≠ V) that\nrepresent the road between restaurants U and V.", "outputFormat": "You must output the maximal amount of peppers Krešo can deliver in the given timeframe.\n", "hint": "**Clarification of the first test case:**\n\nIn the first step, Krešo will deliver the peppers to restaurant 1.\n\nIn the second step, Krešo will travel to restaurant 3.\n\nIn the third step, Krešo will deliver the peppers to restaurant 3.\n\nHe is left with 2 units of time, in which he can drive to restaurant 2, but he lacks one unit of time to\ndeliver the peppers to that restaurant.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #7] Dostavljač", "background": "", "description": "Ever since Krešo started growing chili peppers, N restaurants all over Croatia showed\ninterest in his peppers so they could enrich their dishes with real spice. Because of high\ndemand, Krešo decided to start working as a delivery guy of chili peppers.\n\nThe restaurants are denoted with numbers from 1 to N and are mutually connected with N -\n1 roads such that traveling between any two restaurants is possible. Krešo begins his\njourney in the restaurant denoted with 1. In one unit of time, he can either drive to the\nadjacent restaurant or deliver the peppers to the current restaurant. For each restaurant, we\nknow the required amount of peppers $A_i$.\n\nSince delivering goods is tiring, Krešo decided to spend a total of M units of time on delivery\nand travel, after which he plans to take a break.\n\nDetermine the maximal amount of peppers Krešo can deliver in the given timeframe. You\ncan assume that Krešo always carries an unlimited supply of peppers.", "inputFormat": "The first line of input contains two integers N and M (1 ≤ N, M ≤ 500), the number of\nrestaurants and the time Krešo plans to spend delivering peppers.\n\nThe second line of input contains N integers $A_i$\n(1 ≤ $A_i$ ≤ $10^6$\n), the required amount of peppers\nfor restaurants denoted with i (1 ≤ i ≤ N).\n\nEach of the following N - 1 lines contains two integers U and V (1 ≤ U, V ≤ N, U ≠ V) that\nrepresent the road between restaurants U and V.", "outputFormat": "You must output the maximal amount of peppers Krešo can deliver in the given timeframe.\n", "hint": "**Clarification of the first test case:**\n\nIn the first step, Krešo will deliver the peppers to restaurant 1.\n\nIn the second step, Krešo will travel to restaurant 3.\n\nIn the third step, Krešo will deliver the peppers to restaurant 3.\n\nHe is left with 2 units of time, in which he can drive to restaurant 2, but he lacks one unit of time to\ndeliver the peppers to that restaurant.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #7] Dostavljač", "background": "", "description": "自从 Krešo 开始种植辣椒以来，克罗地亚各地的 $N$ 家餐馆都对他的辣椒感兴趣，因此他们可以用真正的香料来丰富他们的菜肴。由于需求量很大，Krešo 决定开始作为辣椒的送货员。\n\n餐馆用从 $1$ 到 $N$ 的数字表示，并且与 $N - 1$ 个道路相互连接，使得可以在任何两个餐馆之间旅行。Krešo 在 $1$ 号餐厅开始他的旅程。在一个单位的时间里，他可以开车到相邻的餐厅或将辣椒送到现在的餐馆。对于每家餐厅，我们都知道所需的辣椒数量 $A_i$。\n\n由于交付货物很累，Krešo 决定在交付和旅行上花费总共 $M$ 个单位的时间，之后他计划休息一下。\n\n确定 Krešo 在给定时间范围内可以提供的最大辣椒数量。你可以假设 Krešo 总是带有无限量的辣椒。", "inputFormat": "第一行输入包含两个整数 $N$ 和 $M$（$1 \\le N, M \\le 500$），餐馆数量和 Krešo 计划用于交付辣椒的时间。\n\n第二行输入包含 $N$ 个整数 $A_i$（$1 \\le A_i \\le 10^6$），用 $i$ 表示的餐馆所需的辣椒数量（$1 \\le i \\le N$）。\n\n以下 $N - 1$ 行中的每一行包含两个整数 $U$ 和 $V$（$1 \\le U, V \\le N$，$U \\ne V$），其表示餐馆 $U$ 和 $V$ 之间的道路。", "outputFormat": "您必须输出 Krešo 在给定时间范围内可以提供的最大量的辣椒。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5055", "type": "P", "difficulty": 6, "samples": [["10\n0 1 0 1\n1 1 1 2\n2 4 1 2\n3 1 2 0\n4 4 2 1\n5 3 5 7\n6 4 5 6\n4 1 7 1\n8 3 4 6\n9 4 4 1", "3\n4\n5\n10"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["平衡树", "可持久化", "模板题"], "title": "【模板】可持久化文艺平衡树", "background": "这是一道模板题。", "description": "您需要写一种数据结构，来维护一个序列，其中需要提供以下操作（**对于各个以往的历史版本**）：\n\n1. 在第 $p$ 个数后插入数 $x$。\n2. 删除第 $p$ 个数。\n3. 翻转区间 $[l,r]$，例如原序列是 $\\{5,4,3,2,1\\}$，翻转区间 $[2,4]$ 后，结果是 $\\{5,2,3,4,1\\}$。\n4. 查询区间 $[l,r]$ 中所有数的和。\n\n**和原本平衡树不同的一点是，每一次的任何操作都是基于某一个历史版本，同时生成一个新的版本（操作 $4$ 即保持原版本无变化），新版本即编号为此次操作的序号。**\n\n**本题强制在线。**", "inputFormat": "第一行包含一个整数 $n$，表示操作的总数。\n\n接下来 $n$ 行，每行前两个整数 $v_i, \\mathrm{opt}_i$，$v_i$ 表示基于的过去版本号（$0 \\le v_i < i$），$\\mathrm{opt}_i$ 表示操作的序号（$1 \\le \\mathrm{opt}_i \\le 4$）。\n\n若 $\\mathrm{opt}_i=1$，则接下来两个整数 $p_i, x_i$，表示操作为在第 $p_i$ 个数后插入数 $x$ 。  \n若 $\\mathrm{opt}_i=2$，则接下来一个整数 $p_i$，表示操作为删除第 $p_i$ 个数。  \n若 $\\mathrm{opt}_i=3$，则接下来两个整数 $l_i, r_i$，表示操作为翻转区间 $[l_i, r_i]$。  \n若 $\\mathrm{opt}_i=4$，则接下来两个整数 $l_i, r_i$，表示操作为查询区间 $[l_i, r_i]$ 的和。\n\n**强制在线规则：**  \n**令当前操作之前的最后一次 $4$ 操作的答案为 $lastans$（如果之前没有 $4$ 操作，则 $lastans=0$）。**  \n**则此次操作的 $p_i,x_i$ 或 $l_i,r_i$ 均按位异或上 $lastans$ 即可得到真实的 $p_i,x_i$ 或 $l_i,r_i$。**", "outputFormat": "对于每个序号为 $4$ 的查询操作，输出一行一个数表示区间的和。", "hint": ":::info[样例解释]\n样例明文：\n```\n10\n0 1 0 1\n1 1 1 2\n2 4 1 2\n3 1 1 3\n4 4 1 2\n5 3 1 3\n6 4 1 2\n4 1 2 4\n8 3 1 3\n9 4 1 4\n```\n完成所有操作后总共生成了 $11$ 个版本：\n\n版本 $0$（初始版本）：$\\varnothing$\n\n版本 $1$：$\\{1\\}$\n\n版本 $2$：$\\{1,2\\}$\n\n版本 $3$：$\\{1,2\\}$（这个操作查询区间 $\\left[1,2\\right]$ 的和，输出了 $3$。）\n\n版本 $4$：$\\{1,3,2\\}$\n\n版本 $5$：$\\{1,3,2\\}$（这个操作查询区间 $\\left[1,2\\right]$ 的和，输出了 $4$。）\n\n版本 $6$：$\\{2,3,1\\}$\n\n版本 $7$：$\\{2,3,1\\}$（这个操作查询区间 $\\left[1,2\\right]$ 的和，输出了 $5$。）\n\n版本 $8$：$\\{1,3,4,2\\}$\n\n版本 $9$：$\\{4,3,1,2\\}$\n\n版本 $10$：$\\{4,3,1,2\\}$（这个操作查询区间 $\\left[1,4\\right]$ 的和，输出了 $10$。）\n::::\n\n**强制在线：以下针对 $p_i, x_i, l_i, r_i$ 的限制均是按位异或 $lastans$ 后的限制。**\n\n- 对于 $6$ 个测试点，$n \\le 5000$。\n- 对于另外 $6$ 个测试点，$v_i = i - 1$。\n- 欢迎用户加强数据，可联系管理员或出题人。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$|x_i| < {10}^6$。\n\n假设基于的历史版本的序列长度为 $len \\ge 1$，有：  \n若 $\\mathrm{opt}_i=1$，则 $0 \\le p_i \\le len$。  \n若 $\\mathrm{opt}_i=2$，则 $1 \\le p_i \\le len$。  \n若 $\\mathrm{opt}_i=3$，则 $1 \\le l_i \\le r_i \\le len$。  \n若 $\\mathrm{opt}_i=4$，则 $1 \\le l_i \\le r_i \\le len$。\n\n假设基于的历史版本的序列长度为 $0$，有：  \n$\\mathrm{opt}_i=1$，$p_i=0$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Persistent “Literary” Balanced Tree", "background": "This is a template problem.", "description": "You need to implement a data structure to maintain a sequence, supporting the following operations (**for every past historical version**):\n\n1. Insert a number $x$ after the $p$-th number.\n2. Delete the $p$-th number.\n3. Reverse the interval $[l,r]$. For example, if the original sequence is $\\{5,4,3,2,1\\}$, after reversing $[2,4]$, it becomes $\\{5,2,3,4,1\\}$.\n4. Query the sum of all numbers in the interval $[l,r]$.\n\n**Different from an ordinary balanced tree, every operation is performed based on some historical version, and generates a new version (operation $4$ keeps the original version unchanged). The new version is numbered as the index of this operation.**\n\n**This problem is strictly online.**", "inputFormat": "The first line contains an integer $n$, the total number of operations.\n\nThe next $n$ lines each start with two integers $v_i, \\mathrm{opt}_i$. Here, $v_i$ is the index of the past version it is based on ($0 \\le v_i < i$), and $\\mathrm{opt}_i$ is the operation type ($1 \\le \\mathrm{opt}_i \\le 4$).\n\nIf $\\mathrm{opt}_i=1$, then two more integers $p_i, x_i$ follow, meaning: insert number $x$ after the $p_i$-th number.  \nIf $\\mathrm{opt}_i=2$, then one more integer $p_i$ follows, meaning: delete the $p_i$-th number.  \nIf $\\mathrm{opt}_i=3$, then two more integers $l_i, r_i$ follow, meaning: reverse the interval $[l_i, r_i]$.  \nIf $\\mathrm{opt}_i=4$, then two more integers $l_i, r_i$ follow, meaning: query the sum of the interval $[l_i, r_i]$.\n\n**Strict online rule:**  \n**Let the answer of the last operation of type $4$ before the current operation be $lastans$ (if there is no previous type $4$ operation, then $lastans=0$).**  \n**Then $p_i,x_i$ or $l_i,r_i$ of this operation are each XORed bitwise with $lastans$ to obtain the real $p_i,x_i$ or $l_i,r_i$.**", "outputFormat": "For each query operation with type $4$, output one line with one number: the sum of the interval.", "hint": ":::info[Sample Explanation]\nThe sample input:\n```\n10\n0 1 0 1\n1 1 1 2\n2 4 1 2\n3 1 1 3\n4 4 1 2\n5 3 1 3\n6 4 1 2\n4 1 2 4\n8 3 1 3\n9 4 1 4\n```\nAfter all operations, a total of $11$ versions are generated:\n\nVersion $0$ (initial version): $\\varnothing$\n\nVersion $1$: $\\{1\\}$\n\nVersion $2$: $\\{1,2\\}$\n\nVersion $3$: $\\{1,2\\}$ (this operation queries the sum on $\\left[1,2\\right]$ and outputs $3$.)\n\nVersion $4$: $\\{1,3,2\\}$\n\nVersion $5$: $\\{1,3,2\\}$ (this operation queries the sum on $\\left[1,2\\right]$ and outputs $4$.)\n\nVersion $6$: $\\{2,3,1\\}$\n\nVersion $7$: $\\{2,3,1\\}$ (this operation queries the sum on $\\left[1,2\\right]$ and outputs $5$.)\n\nVersion $8$: $\\{1,3,4,2\\}$\n\nVersion $9$: $\\{4,3,1,2\\}$\n\nVersion $10$: $\\{4,3,1,2\\}$ (this operation queries the sum on $\\left[1,4\\right]$ and outputs $10$.)\n::::\n\n**Strict online: the following constraints on $p_i, x_i, l_i, r_i$ are after XORing with $lastans$.**\n\n- For $6$ test points, $n \\le 5000$.\n- For another $6$ test points, $v_i = i - 1$.\n- Users are welcome to strengthen the testdata. You may contact the administrator or the problem setter.\n\nFor $100\\%$ of the data, $1 \\le n \\le 2 \\times {10}^5$, $|x_i| < {10}^6$.\n\nAssume the sequence length of the referenced historical version is $len \\ge 1$, then:  \nIf $\\mathrm{opt}_i=1$, then $0 \\le p_i \\le len$.  \nIf $\\mathrm{opt}_i=2$, then $1 \\le p_i \\le len$.  \nIf $\\mathrm{opt}_i=3$, then $1 \\le l_i \\le r_i \\le len$.  \nIf $\\mathrm{opt}_i=4$, then $1 \\le l_i \\le r_i \\le len$.\n\nAssume the sequence length of the referenced historical version is $0$, then:  \n$\\mathrm{opt}_i=1$, $p_i=0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】可持久化文艺平衡树", "background": "这是一道模板题。", "description": "您需要写一种数据结构，来维护一个序列，其中需要提供以下操作（**对于各个以往的历史版本**）：\n\n1. 在第 $p$ 个数后插入数 $x$。\n2. 删除第 $p$ 个数。\n3. 翻转区间 $[l,r]$，例如原序列是 $\\{5,4,3,2,1\\}$，翻转区间 $[2,4]$ 后，结果是 $\\{5,2,3,4,1\\}$。\n4. 查询区间 $[l,r]$ 中所有数的和。\n\n**和原本平衡树不同的一点是，每一次的任何操作都是基于某一个历史版本，同时生成一个新的版本（操作 $4$ 即保持原版本无变化），新版本即编号为此次操作的序号。**\n\n**本题强制在线。**", "inputFormat": "第一行包含一个整数 $n$，表示操作的总数。\n\n接下来 $n$ 行，每行前两个整数 $v_i, \\mathrm{opt}_i$，$v_i$ 表示基于的过去版本号（$0 \\le v_i < i$），$\\mathrm{opt}_i$ 表示操作的序号（$1 \\le \\mathrm{opt}_i \\le 4$）。\n\n若 $\\mathrm{opt}_i=1$，则接下来两个整数 $p_i, x_i$，表示操作为在第 $p_i$ 个数后插入数 $x$ 。  \n若 $\\mathrm{opt}_i=2$，则接下来一个整数 $p_i$，表示操作为删除第 $p_i$ 个数。  \n若 $\\mathrm{opt}_i=3$，则接下来两个整数 $l_i, r_i$，表示操作为翻转区间 $[l_i, r_i]$。  \n若 $\\mathrm{opt}_i=4$，则接下来两个整数 $l_i, r_i$，表示操作为查询区间 $[l_i, r_i]$ 的和。\n\n**强制在线规则：**  \n**令当前操作之前的最后一次 $4$ 操作的答案为 $lastans$（如果之前没有 $4$ 操作，则 $lastans=0$）。**  \n**则此次操作的 $p_i,x_i$ 或 $l_i,r_i$ 均按位异或上 $lastans$ 即可得到真实的 $p_i,x_i$ 或 $l_i,r_i$。**", "outputFormat": "对于每个序号为 $4$ 的查询操作，输出一行一个数表示区间的和。", "hint": ":::info[样例解释]\n样例明文：\n```\n10\n0 1 0 1\n1 1 1 2\n2 4 1 2\n3 1 1 3\n4 4 1 2\n5 3 1 3\n6 4 1 2\n4 1 2 4\n8 3 1 3\n9 4 1 4\n```\n完成所有操作后总共生成了 $11$ 个版本：\n\n版本 $0$（初始版本）：$\\varnothing$\n\n版本 $1$：$\\{1\\}$\n\n版本 $2$：$\\{1,2\\}$\n\n版本 $3$：$\\{1,2\\}$（这个操作查询区间 $\\left[1,2\\right]$ 的和，输出了 $3$。）\n\n版本 $4$：$\\{1,3,2\\}$\n\n版本 $5$：$\\{1,3,2\\}$（这个操作查询区间 $\\left[1,2\\right]$ 的和，输出了 $4$。）\n\n版本 $6$：$\\{2,3,1\\}$\n\n版本 $7$：$\\{2,3,1\\}$（这个操作查询区间 $\\left[1,2\\right]$ 的和，输出了 $5$。）\n\n版本 $8$：$\\{1,3,4,2\\}$\n\n版本 $9$：$\\{4,3,1,2\\}$\n\n版本 $10$：$\\{4,3,1,2\\}$（这个操作查询区间 $\\left[1,4\\right]$ 的和，输出了 $10$。）\n::::\n\n**强制在线：以下针对 $p_i, x_i, l_i, r_i$ 的限制均是按位异或 $lastans$ 后的限制。**\n\n- 对于 $6$ 个测试点，$n \\le 5000$。\n- 对于另外 $6$ 个测试点，$v_i = i - 1$。\n- 欢迎用户加强数据，可联系管理员或出题人。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$|x_i| < {10}^6$。\n\n假设基于的历史版本的序列长度为 $len \\ge 1$，有：  \n若 $\\mathrm{opt}_i=1$，则 $0 \\le p_i \\le len$。  \n若 $\\mathrm{opt}_i=2$，则 $1 \\le p_i \\le len$。  \n若 $\\mathrm{opt}_i=3$，则 $1 \\le l_i \\le r_i \\le len$。  \n若 $\\mathrm{opt}_i=4$，则 $1 \\le l_i \\le r_i \\le len$。\n\n假设基于的历史版本的序列长度为 $0$，有：  \n$\\mathrm{opt}_i=1$，$p_i=0$。", "locale": "zh-CN"}}}
{"pid": "P5056", "type": "P", "difficulty": 7, "samples": [["4 4\n**..\n....\n....\n....", "2"], ["4 4\n....\n....\n....\n....", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["轮廓线 DP", "模板题"], "title": "【模板】插头 DP", "background": "ural 1519 \n\n陈丹琦《基于连通性状态压缩的动态规划问题》中的例题。", "description": "给出 $n\\times m$ 的方格，有些格子不能铺线，其它格子必须铺，形成一个闭合回路。问有多少种铺法？", "inputFormat": "第一行，两个整数，分别代表 $n,m$。\n\n从第二行到第 $(n+1)$ 行，每行有一个长度为 $m$ 的只含 `*` 和 `.` 的字符串，`*` 表不能铺线，`.` 表必须铺。", "outputFormat": "输出一行一个整数，表示总方案数。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $2\\le n,m\\le 12$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Plug DP.", "background": "ural 1519.\n\nAn example problem from Chen Danqi’s article *Dynamic Programming Problems Based on Connectivity State Compression*.", "description": "Given an $n\\times m$ grid, some cells cannot be used to place lines, and all other cells must be used to place lines, forming one closed loop. How many different ways are there to place the lines?", "inputFormat": "The first line contains two integers, representing $n$ and $m$.\n\nFrom the second line to the $(n+1)$-th line, each line contains a string of length $m$ consisting only of `*` and `.`, where `*` means you cannot place lines in this cell, and `.` means you must place lines in this cell.", "outputFormat": "Output one line with one integer, representing the total number of valid ways.", "hint": "#### Constraints\n\n- For $100\\%$ of the testdata, $2\\le n,m\\le 12$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】插头 DP", "background": "ural 1519 \n\n陈丹琦《基于连通性状态压缩的动态规划问题》中的例题。", "description": "给出 $n\\times m$ 的方格，有些格子不能铺线，其它格子必须铺，形成一个闭合回路。问有多少种铺法？", "inputFormat": "第一行，两个整数，分别代表 $n,m$。\n\n从第二行到第 $(n+1)$ 行，每行有一个长度为 $m$ 的只含 `*` 和 `.` 的字符串，`*` 表不能铺线，`.` 表必须铺。", "outputFormat": "输出一行一个整数，表示总方案数。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $2\\le n,m\\le 12$。", "locale": "zh-CN"}}}
{"pid": "P5057", "type": "P", "difficulty": 4, "samples": [["20 10\n1 1 10\n2 6\n2 12\n1 5 12\n2 6\n2 15\n1 6 16\n1 11 17\n2 12\n2 6", "1\n0\n0\n0\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2006", "重庆", "线段树", "各省省选", "树状数组"], "title": "[CQOI2006] 简单题", "background": "", "description": "有一个 $n$ 个元素的数组，每个元素初始均为 $0$。有 $m$ 条指令，每条指令为两种操作中的一种：\n1. 让其中一段连续序列数字反转；（即 $0$ 变 $1$，$1$ 变 $0$）\n2. 询问某个元素的值。\n\n例如当 $n=20$ 时，$10$ 条指令如下：\n\n![](https://cdn.luogu.com.cn/upload/pic/44663.png)\n", "inputFormat": "第一行包含两个整数 $n,m$，表示数组的长度和指令的条数。\n\n接下来 $m$ 行，每行的第一个数 $t$ 表示操作的种类：\n\n* 若 $t=1$，则接下来有两个数 $L,R$，表示反转区间 $[L,R]$ 的每个数；\n* 若 $t=2$，则接下来只有一个数 $i$，表示询问的下标。", "outputFormat": "每个操作 $2$ 输出一行（非 $0$ 即 $1$），表示每次操作 $2$ 的回答。", "hint": "对于 $50\\%$ 的数据，$1 \\le n \\le 10^3$，$1 \\le m \\le 10^4$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le m \\le 5 \\times 10^5$，保证 $L \\le R$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2006] Simple Problem", "background": "", "description": "There is an array with $n$ elements, and each element is initially $0$. There are $m$ instructions, and each instruction is one of the following two operations:\n\n1. Flip all numbers in a continuous segment. (That is, $0$ becomes $1$, and $1$ becomes $0$.)\n2. Query the value of a certain element.\n\nFor example, when $n=20$, the $10$ instructions are as follows:\n\n![](https://cdn.luogu.com.cn/upload/pic/44663.png)", "inputFormat": "The first line contains two integers $n, m$, representing the length of the array and the number of instructions.\n\nIn the next $m$ lines, the first number is $t$, representing the type of operation:\n\n- If $t = 1$, then two numbers $L, R$ follow, meaning to flip every number in the interval $[L, R]$.\n- If $t = 2$, then only one number $i$ follows, meaning to query the index.", "outputFormat": "For each operation $2$, output one line (either $0$ or $1$), representing the answer to that query.", "hint": "For $50\\%$ of the testdata, $1 \\le n \\le 10^3$, $1 \\le m \\le 10^4$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le m \\le 5 \\times 10^5$, and it is guaranteed that $L \\le R$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2006] 简单题", "background": "", "description": "有一个 $n$ 个元素的数组，每个元素初始均为 $0$。有 $m$ 条指令，每条指令为两种操作中的一种：\n1. 让其中一段连续序列数字反转；（即 $0$ 变 $1$，$1$ 变 $0$）\n2. 询问某个元素的值。\n\n例如当 $n=20$ 时，$10$ 条指令如下：\n\n![](https://cdn.luogu.com.cn/upload/pic/44663.png)\n", "inputFormat": "第一行包含两个整数 $n,m$，表示数组的长度和指令的条数。\n\n接下来 $m$ 行，每行的第一个数 $t$ 表示操作的种类：\n\n* 若 $t=1$，则接下来有两个数 $L,R$，表示反转区间 $[L,R]$ 的每个数；\n* 若 $t=2$，则接下来只有一个数 $i$，表示询问的下标。", "outputFormat": "每个操作 $2$ 输出一行（非 $0$ 即 $1$），表示每次操作 $2$ 的回答。", "hint": "对于 $50\\%$ 的数据，$1 \\le n \\le 10^3$，$1 \\le m \\le 10^4$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le m \\le 5 \\times 10^5$，保证 $L \\le R$。", "locale": "zh-CN"}}}
{"pid": "P5058", "type": "P", "difficulty": 5, "samples": [["5\n2 1\n2 5\n1 4\n5 3\n2 3\n5 1\n0 0\n4 2", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "各省省选", "浙江", "Tarjan", "双连通分量"], "title": "[ZJOI2004] 嗅探器", "background": "", "description": "某军搞信息对抗实战演习，红军成功地侵入了蓝军的内部网络。\n\n蓝军共有两个信息中心，红军计划在某台中间服务器上安装一个嗅探器，从而能够侦听到两个信息中心互相交换的所有信息。\n\n但是蓝军的网络相当的庞大，数据包从一个信息中心传到另一个信息中心可以不止有一条通路。\n\n现在需要你尽快地解决这个问题，应该把嗅探器安装在哪个中间服务器上才能保证所有的数据包都能被捕获？", "inputFormat": "输入文件的第一行一个整数 $n$，表示蓝军网络中服务器的数目。\n\n接下来若干行是对蓝军网络的拓扑结构描述，每行是两个整数 $i,j$ 表示编号为 $i$ 和编号为 $j$ 的两台服务器间存在双向连接。\n\n服务器的编号从 $1$ 开始，一行两个 $0$ 表示网络的拓扑结构描述结束，再接下来是两个整数 $a,b$ 分别表示两个中心服务器的编号。", "outputFormat": "输出满足条件的服务器编号。如果有多个解输出编号最小的一个，如果找不到任何解，输出 `No solution`。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 2 \\times 10^5$，边数不超过 $5 \\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2004] Sniffer", "background": "", "description": "In an information warfare exercise, the Red side successfully broke into the Blue side’s internal network.\n\nThe Blue side has two information centers. The Red side plans to install a sniffer on some intermediate server so that it can listen to all information exchanged between the two information centers.\n\nHowever, the Blue side’s network is very large, and packets can travel from one information center to the other through more than one path.\n\nNow you need to solve this problem as quickly as possible: on which intermediate server should the sniffer be installed to ensure that all packets can be captured?", "inputFormat": "The first line contains an integer $n$, which is the number of servers in the Blue side’s network.\n\nThe next several lines describe the network topology. Each line contains two integers $i, j$, meaning there is a bidirectional connection between server $i$ and server $j$.\n\nServer IDs start from $1$. A line with two $0$ indicates the end of the topology description. After that, there are two integers $a, b$, which are the IDs of the two center servers.", "outputFormat": "Output the ID of a server that satisfies the requirement. If there are multiple solutions, output the one with the smallest ID. If no solution can be found, output `No solution`.", "hint": "For $100\\%$ of the testdata, $1 \\le n \\le 2 \\times 10^5$, and the number of edges does not exceed $5 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2004] 嗅探器", "background": "", "description": "某军搞信息对抗实战演习，红军成功地侵入了蓝军的内部网络。\n\n蓝军共有两个信息中心，红军计划在某台中间服务器上安装一个嗅探器，从而能够侦听到两个信息中心互相交换的所有信息。\n\n但是蓝军的网络相当的庞大，数据包从一个信息中心传到另一个信息中心可以不止有一条通路。\n\n现在需要你尽快地解决这个问题，应该把嗅探器安装在哪个中间服务器上才能保证所有的数据包都能被捕获？", "inputFormat": "输入文件的第一行一个整数 $n$，表示蓝军网络中服务器的数目。\n\n接下来若干行是对蓝军网络的拓扑结构描述，每行是两个整数 $i,j$ 表示编号为 $i$ 和编号为 $j$ 的两台服务器间存在双向连接。\n\n服务器的编号从 $1$ 开始，一行两个 $0$ 表示网络的拓扑结构描述结束，再接下来是两个整数 $a,b$ 分别表示两个中心服务器的编号。", "outputFormat": "输出满足条件的服务器编号。如果有多个解输出编号最小的一个，如果找不到任何解，输出 `No solution`。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 2 \\times 10^5$，边数不超过 $5 \\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5059", "type": "P", "difficulty": 5, "samples": [["1 10007", "0"], ["2 1000000000", "1"], ["7 1000000000", "612231936"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2018", "矩阵加速"], "title": "中国象棋", "background": "gjm 非常喜欢研究棋类问题，最近，他在钻研中国象棋 QwQ", "description": "现在，gjm 脑海里有一个 $N \\times N$ 的棋盘，其上共有 $N \\times N$ 个格子， gjm 开始在棋盘上的格点上摆放卒，已知卒仅会攻击往左边一个格点和往右边一个格点上的棋子，现在 gjm 开始在棋盘上摆放任意多个卒，满足：\n\n1. 每一行都至少摆放有两个卒\n2. 任意两个卒都不会互相攻击\n\ngjm 现在想知道，满足上述条件，有多少种摆放卒的方案？由于答案可能很大，你只需输出方案数对 $P$ 取模的结果即可。\n\n两种方案被认为不同当且仅当存在同一格点的摆放情况不同。", "inputFormat": "一行两个正整数，分别为 $N$ 和 $P$。", "outputFormat": "一行一个整数，即在 $N \\times N$ 棋盘中摆放卒的方案数对 $P$ 取模的结果 。", "hint": "**样例1解释**\n\n很明显没有方案\n\n**样例2解释**（$0$ 表示格点上无卒，$1$ 表示格点上有卒）\n\n仅有一种方案：\n\n$1$ $0$ $1$\n\n$1$ $0$ $1$\n\n$1$ $0$ $1$\n\n该样例以及解释无误\n\n**样例3解释**\n太大了无法列出所有方案，故不予解释\n\n对于 $20\\%$ 的数据，$N≤100$，$P≤10^{9}$\n\n对于 $50\\%$ 的数据，$N≤10^5$，$P≤10^{9}$\n\n对于 $100\\%$ 的数据 ，$N≤10^{18}$，$P≤10^{18}$\n\nBy：学无止境", "locale": "zh-CN", "translations": {"en": {"title": "Chinese Chess.", "background": "gjm really likes studying board game problems. Recently, he has been researching Chinese chess QwQ.", "description": "Now, in gjm’s mind there is an $N \\times N$ chessboard, with a total of $N \\times N$ cells. gjm starts placing pawns on the grid points of the board. It is known that a pawn only attacks pieces on the grid point one step to its left and one step to its right. Now gjm places any number of pawns on the board, satisfying:\n\n1. Each row has at least two pawns placed.\n2. No two pawns attack each other.\n\ngjm now wants to know: how many pawn placement schemes satisfy the above conditions? Since the answer may be very large, you only need to output the number of schemes modulo $P$.\n\nTwo schemes are considered different if and only if there exists at least one grid point where the placement differs.", "inputFormat": "One line with two positive integers, $N$ and $P$.", "outputFormat": "One line with one integer, the number of pawn placement schemes on an $N \\times N$ board modulo $P$.", "hint": "**Explanation for Sample 1**\n\nObviously, there is no valid scheme.\n\n**Explanation for Sample 2** ($0$ means no pawn on the grid point, $1$ means there is a pawn on the grid point.)\n\nThere is only one scheme:\n\n$1$ $0$ $1$\n\n$1$ $0$ $1$\n\n$1$ $0$ $1$\n\nThis sample and its explanation are correct.\n\n**Explanation for Sample 3**\n\nIt is too large to list all schemes, so no explanation is given.\n\nConstraints:\n\nFor $20\\%$ of the testdata, $N \\le 100$, $P \\le 10^{9}$.\n\nFor $50\\%$ of the testdata, $N \\le 10^5$, $P \\le 10^{9}$.\n\nFor $100\\%$ of the testdata, $N \\le 10^{18}$, $P \\le 10^{18}$.\n\nBy: Endless Learning.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "中国象棋", "background": "gjm 非常喜欢研究棋类问题，最近，他在钻研中国象棋 QwQ", "description": "现在，gjm 脑海里有一个 $N \\times N$ 的棋盘，其上共有 $N \\times N$ 个格子， gjm 开始在棋盘上的格点上摆放卒，已知卒仅会攻击往左边一个格点和往右边一个格点上的棋子，现在 gjm 开始在棋盘上摆放任意多个卒，满足：\n\n1. 每一行都至少摆放有两个卒\n2. 任意两个卒都不会互相攻击\n\ngjm 现在想知道，满足上述条件，有多少种摆放卒的方案？由于答案可能很大，你只需输出方案数对 $P$ 取模的结果即可。\n\n两种方案被认为不同当且仅当存在同一格点的摆放情况不同。", "inputFormat": "一行两个正整数，分别为 $N$ 和 $P$。", "outputFormat": "一行一个整数，即在 $N \\times N$ 棋盘中摆放卒的方案数对 $P$ 取模的结果 。", "hint": "**样例1解释**\n\n很明显没有方案\n\n**样例2解释**（$0$ 表示格点上无卒，$1$ 表示格点上有卒）\n\n仅有一种方案：\n\n$1$ $0$ $1$\n\n$1$ $0$ $1$\n\n$1$ $0$ $1$\n\n该样例以及解释无误\n\n**样例3解释**\n太大了无法列出所有方案，故不予解释\n\n对于 $20\\%$ 的数据，$N≤100$，$P≤10^{9}$\n\n对于 $50\\%$ 的数据，$N≤10^5$，$P≤10^{9}$\n\n对于 $100\\%$ 的数据 ，$N≤10^{18}$，$P≤10^{18}$\n\nBy：学无止境", "locale": "zh-CN"}}}
{"pid": "P5060", "type": "P", "difficulty": 4, "samples": [["2 2 3 1 2\n1 2 1\n2 2 1", "3\n1->2->2->2"], ["4 6 3 2 3\n2 1 7\n2 4 0\n4 3 6\n1 4 0 \n2 3 1\n2 3 9", "6\n2->4->3"], ["3 3 5 1 3\n1 2 15\n2 3 7\n1 3 3 ", "jjc fails in travelling"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "最短路"], "title": "旅行", "background": "$jjc$ 非常喜欢旅行~~（smy）~~！\n\n", "description": "**$NOIP$ $2018$** 已经结束了，$jjc$ 决定去全国各地旅行，每个地方都有许多巨佬，他拥有一张地图来帮助他规划一条从 $A $ 地 到 $B $ 地 的路线，地图上有 $N $ 个地点编号为 $1$~$N$ ，有 $ M $ 条道路将不同(或相同)地点有向连通。\n\n现在，$jjc$ 已经知道了通过第 $ i $ 条路从 $u_i $ 地 直接走到 $v_i $ 地 会遇到多少名巨佬，他将记录遇见的每一名巨佬的名字（不管是否记录过）。但是，每记录一名巨佬的名字就需要使用一张便签，便签以袋为单位出售，$jjc$ 选购的便签每一小袋有 $P$ 张。$jjc$ 不希望他购买的便签被浪费，因此他希望他旅程结束后他购买的每一袋便签都 **恰好** 被用完。除此以外，$jjc$ 正在存钱来$......QwQ$，他得减少消费，因此他希望这次旅行能消耗尽量少的便签。\n\n然而，他不知道怎么才能找到最合适的路径，作为巨佬中的一员，你能帮 $jjc $ 解决这个问题，找到符合条件的最佳路径吗？\n", "inputFormat": "第一行，给出五个整数，依次是$N$、$M$、$P$、起点$A$的编号、终点$B$的编号 \n\n从第二行到第$M+1$行描述道路的信息，每行三个整数，依次是第$i$条道路连接的两个地点的起点编号$u_i$、终点编号$v_i$ 及这条道路上会遇见的巨佬数量$num_i$", "outputFormat": "若存在满足条件路线，请输出两行，第一行一个整数，表示选择最佳路径上会遇见的巨佬总数，第二行输出从起点$A$到终点$B$的最佳路径的详细路线，数据保证答案是唯一的。\n\n若无满足条件的路线 ，请输出一行一个字符串“$jjc$ $fails$ $in$ $travelling$” $($不含引号$)$", "hint": "本题有 $ 3 $ 个 $ Subtask $\n\n对$30$%的数据，$2≤N≤100$ ，$2≤M≤5000$ ，$1≤P≤50$\n\n对另外$20$%的数据 ，$ 2≤N≤5×10^4$，$M≤2×10^5$，$P=1$\n\n对另外$50$%的数据 ，$ 2≤N≤5×10^4$，$M≤2×10^5$，$1≤P≤50$ \n\n对于所有数据，$1≤A,B,u_i,v_i≤N$，$0≤num_i≤10^8 $  \n\n$By : $ 学无止境", "locale": "zh-CN", "translations": {"en": {"title": "Travel", "background": "$jjc$ really likes traveling ~~(smy)~~!", "description": "**$NOIP$ $2018$** has ended, and $jjc$ decided to travel around the country. Each place has many “big shots”. He has a map to help him plan a route from location $A$ to location $B$. The map has $N$ locations numbered from $1$ to $N$, and there are $M$ directed roads connecting different (or the same) locations.\n\nNow, $jjc$ already knows how many “big shots” he will meet when taking the $i$-th road directly from $u_i$ to $v_i$. He will write down the name of every “big shot” he meets (no matter whether the name has been written down before). However, each time he writes down one name, he needs to use one sticky note. Sticky notes are sold in bags, and each small bag that $jjc$ buys contains $P$ notes. $jjc$ does not want any sticky notes he buys to be wasted, so he wants every bag of notes he buys to be used up **exactly** when the trip ends. Besides that, $jjc$ is saving money for $......QwQ$, so he needs to spend less. Therefore, he wants this trip to use as few sticky notes as possible.\n\nHowever, he does not know how to find the best route. As one of the “big shots”, can you help $jjc$ solve this problem and find the optimal path that satisfies the conditions?", "inputFormat": "The first line contains five integers, in order: $N$, $M$, $P$, the index of the start point $A$, and the index of the end point $B$.\n\nLines $2$ to $M+1$ describe the roads. Each line contains three integers: the start point index $u_i$ and end point index $v_i$ of the $i$-th road, and the number of “big shots” met on this road $num_i$.", "outputFormat": "If there exists a route that satisfies the conditions, output two lines. The first line contains one integer, the total number of “big shots” met on the chosen optimal path. The second line outputs the detailed route of the optimal path from $A$ to $B$. The testdata guarantees that the answer is unique.\n\nIf no such route exists, output one line containing the string “$jjc$ $fails$ $in$ $travelling$” (without quotes).", "hint": "This problem has $3$ subtasks.\n\nFor $30\\%$ of the testdata: $2 \\le N \\le 100$, $2 \\le M \\le 5000$, $1 \\le P \\le 50$.\n\nFor another $20\\%$ of the testdata: $2 \\le N \\le 5 \\times 10^4$, $M \\le 2 \\times 10^5$, $P = 1$.\n\nFor another $50\\%$ of the testdata: $2 \\le N \\le 5 \\times 10^4$, $M \\le 2 \\times 10^5$, $1 \\le P \\le 50$.\n\nFor all testdata: $1 \\le A, B, u_i, v_i \\le N$, $0 \\le num_i \\le 10^8$.\n\n$By : $ Never Stop Learning.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "旅行", "background": "$jjc$ 非常喜欢旅行~~（smy）~~！\n\n", "description": "**$NOIP$ $2018$** 已经结束了，$jjc$ 决定去全国各地旅行，每个地方都有许多巨佬，他拥有一张地图来帮助他规划一条从 $A $ 地 到 $B $ 地 的路线，地图上有 $N $ 个地点编号为 $1$~$N$ ，有 $ M $ 条道路将不同(或相同)地点有向连通。\n\n现在，$jjc$ 已经知道了通过第 $ i $ 条路从 $u_i $ 地 直接走到 $v_i $ 地 会遇到多少名巨佬，他将记录遇见的每一名巨佬的名字（不管是否记录过）。但是，每记录一名巨佬的名字就需要使用一张便签，便签以袋为单位出售，$jjc$ 选购的便签每一小袋有 $P$ 张。$jjc$ 不希望他购买的便签被浪费，因此他希望他旅程结束后他购买的每一袋便签都 **恰好** 被用完。除此以外，$jjc$ 正在存钱来$......QwQ$，他得减少消费，因此他希望这次旅行能消耗尽量少的便签。\n\n然而，他不知道怎么才能找到最合适的路径，作为巨佬中的一员，你能帮 $jjc $ 解决这个问题，找到符合条件的最佳路径吗？\n", "inputFormat": "第一行，给出五个整数，依次是$N$、$M$、$P$、起点$A$的编号、终点$B$的编号 \n\n从第二行到第$M+1$行描述道路的信息，每行三个整数，依次是第$i$条道路连接的两个地点的起点编号$u_i$、终点编号$v_i$ 及这条道路上会遇见的巨佬数量$num_i$", "outputFormat": "若存在满足条件路线，请输出两行，第一行一个整数，表示选择最佳路径上会遇见的巨佬总数，第二行输出从起点$A$到终点$B$的最佳路径的详细路线，数据保证答案是唯一的。\n\n若无满足条件的路线 ，请输出一行一个字符串“$jjc$ $fails$ $in$ $travelling$” $($不含引号$)$", "hint": "本题有 $ 3 $ 个 $ Subtask $\n\n对$30$%的数据，$2≤N≤100$ ，$2≤M≤5000$ ，$1≤P≤50$\n\n对另外$20$%的数据 ，$ 2≤N≤5×10^4$，$M≤2×10^5$，$P=1$\n\n对另外$50$%的数据 ，$ 2≤N≤5×10^4$，$M≤2×10^5$，$1≤P≤50$ \n\n对于所有数据，$1≤A,B,u_i,v_i≤N$，$0≤num_i≤10^8 $  \n\n$By : $ 学无止境", "locale": "zh-CN"}}}
{"pid": "P5061", "type": "P", "difficulty": 6, "samples": [["4 4\n3 4\n1 2\n2 4\n2 3", "2 0\n0"], ["10 2\n1 7\n3 5\n", "-1\n2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "Special Judge"], "title": "秘密任务", "background": ">飞雪连天射白鹿，笑书神侠倚碧鸳。\n\n>谨纪念金庸先生。\n\n 但是这与本题没有联系。\n", "description": "wgr 是 $R$ 国军队总指挥官。现在，他决定组织两个小队分别去执行两个秘密任务。\n\nwgr 将派出 $N$ 名战士来执行这两个任务，他们的编号为 $1 \\sim N$ 。由于任务无比重要，wgr 需要使派出的队伍配合绝对默契 。配合绝对默契指队伍中**任何**两名战士的配合都是默契的。同时，他还需要使两个队伍的战斗力差距尽可能小，队伍的战斗力定义为 $F=2^{k}$，$k$ 为队伍的人数，不允许有人剩余。\n\nwgr 已经知道哪些战士之间的配合是默契的，但由于时间紧迫，wgr 来不及慢慢整理资料了，现在，他请你以最快的速度帮他完成资料的整理，并告诉他：\n\n1. 一共有多少种不同的分组方案。两种方案被认为是不同的当且仅当其两支队伍战斗力差值不同。\n2. 所有分组方案中，最小的战斗力差值是多少，由于这个差值可能很大，请对  $10^9+7$ 取模后再输出。\n3. 有多少对战士配合默契但是不可能被分在同一小组。\n\n**注意：** 特别地，由于队伍的默契程度十分重要，一支队伍 $N$ 名战士另一支队伍 $0$ 名战士也是合法的分组方案。\n", "inputFormat": "第一行两个正整数 $N,M$。 \n\n接下来 $M$ 行每行两个正整数 $x,y$，表示编号为 $x$ 的战士与编号为 $y$ 的战士之间配合默契。\n", "outputFormat": "输出共两行。\n\n第一行，如果存在合法的方案，输出一行两个数，为分组方案数与最小的战斗力差值模 $10^9+7$ 的结果；如果不存在合法的分组方案，第一行输出一个数 $-1$ 即可。\n\n第二行，输出一个整数，表示有多少对战士配合默契但是不可能被分在同一小组。", "hint": "本题共有三个 Subtask。\n\n- Subtask 1：共 $5$ 个测试点，一个测试点 $5$ 分，满足 $N≤30$；\n- Subtask 2：共 $3$ 个测试点，一个测试点 $10$ 分，满足 $N≤300$；\n- Subtask 3：共 $3$ 个测试点，一个测试点 $15$ 分，满足 $N≤2500$。 \n\n对于所有的数据，不会重复说明同一组关系，$1\\le x,y\\le  n$ 且 $x\\neq y$。此外保证 $0\\le m≤n\\times (n-1)/2$。\n\n\n本题开启 Special Judge：\n\n- 若你的答案第一行输出正确你可以得到该测试点 $60\\%$ 的分数；\n- 若你的答案第二行输出正确你可以得到该测试点 $40\\%$ 的分数。\n\n为了确保你能够得到部分分，**请按格式要求输出**。\n", "locale": "zh-CN", "translations": {"en": {"title": "Secret Mission", "background": ">Snow flies across the sky as arrows shoot at the white deer; smiling, I write of heroes leaning on green mandarin ducks.\n\n>In memory of Mr. Jin Yong.\n\nHowever, this has nothing to do with this problem.", "description": "wgr is the commander-in-chief of the army of country $R$. Now, he decides to organize two squads to carry out two secret missions.\n\nwgr will send $N$ soldiers to do these two missions, numbered $1 \\sim N$. Since the missions are extremely important, wgr needs the dispatched squads to have perfect cooperation. Perfect cooperation means that **any** two soldiers within the same squad cooperate well with each other. At the same time, he wants the difference in combat power between the two squads to be as small as possible. The combat power of a squad is defined as $F=2^{k}$, where $k$ is the number of soldiers in the squad. No one is allowed to be left unassigned.\n\nwgr already knows which pairs of soldiers cooperate well, but due to time pressure, he cannot organize the information carefully. He asks you to help him finish organizing the information as fast as possible, and tell him:\n\n1. How many different grouping plans are there in total. Two plans are considered different if and only if the difference in combat power between the two squads is different.\n2. Among all grouping plans, what is the minimum combat power difference. Since this difference may be very large, output it modulo $10^9+7$.\n3. How many pairs of soldiers cooperate well but can never be assigned to the same squad.\n\n**Note:** In particular, since squad cooperation is extremely important, a plan where one squad has $N$ soldiers and the other squad has $0$ soldiers is also a valid grouping plan.", "inputFormat": "The first line contains two positive integers $N,M$.\n\nThe next $M$ lines each contain two positive integers $x,y$, meaning that soldier $x$ and soldier $y$ cooperate well with each other.", "outputFormat": "Output consists of two lines.\n\nOn the first line, if there exists a valid plan, output two numbers: the number of grouping plans and the minimum combat power difference modulo $10^9+7$. If no valid plan exists, output a single number $-1$ on the first line.\n\nOn the second line, output one integer: the number of pairs of soldiers who cooperate well but can never be assigned to the same squad.", "hint": "This problem has three subtasks.\n\n- Subtask 1: $5$ test points, $5$ points each, with $N \\le 30$.\n- Subtask 2: $3$ test points, $10$ points each, with $N \\le 300$.\n- Subtask 3: $3$ test points, $15$ points each, with $N \\le 2500$.\n\nFor all testdata, the same relationship will not be given repeatedly. $1 \\le x,y \\le n$ and $x \\neq y$. Also, it is guaranteed that $0 \\le m \\le n \\times (n-1)/2$.\n\nThis problem uses a Special Judge.\n\n- If the output on the first line is correct, you can get $60\\%$ of the score for that test point.\n- If the output on the second line is correct, you can get $40\\%$ of the score for that test point.\n\nTo make sure you can get partial points, **please output according to the required format**.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "秘密任务", "background": ">飞雪连天射白鹿，笑书神侠倚碧鸳。\n\n>谨纪念金庸先生。\n\n 但是这与本题没有联系。\n", "description": "wgr 是 $R$ 国军队总指挥官。现在，他决定组织两个小队分别去执行两个秘密任务。\n\nwgr 将派出 $N$ 名战士来执行这两个任务，他们的编号为 $1 \\sim N$ 。由于任务无比重要，wgr 需要使派出的队伍配合绝对默契 。配合绝对默契指队伍中**任何**两名战士的配合都是默契的。同时，他还需要使两个队伍的战斗力差距尽可能小，队伍的战斗力定义为 $F=2^{k}$，$k$ 为队伍的人数，不允许有人剩余。\n\nwgr 已经知道哪些战士之间的配合是默契的，但由于时间紧迫，wgr 来不及慢慢整理资料了，现在，他请你以最快的速度帮他完成资料的整理，并告诉他：\n\n1. 一共有多少种不同的分组方案。两种方案被认为是不同的当且仅当其两支队伍战斗力差值不同。\n2. 所有分组方案中，最小的战斗力差值是多少，由于这个差值可能很大，请对  $10^9+7$ 取模后再输出。\n3. 有多少对战士配合默契但是不可能被分在同一小组。\n\n**注意：** 特别地，由于队伍的默契程度十分重要，一支队伍 $N$ 名战士另一支队伍 $0$ 名战士也是合法的分组方案。\n", "inputFormat": "第一行两个正整数 $N,M$。 \n\n接下来 $M$ 行每行两个正整数 $x,y$，表示编号为 $x$ 的战士与编号为 $y$ 的战士之间配合默契。\n", "outputFormat": "输出共两行。\n\n第一行，如果存在合法的方案，输出一行两个数，为分组方案数与最小的战斗力差值模 $10^9+7$ 的结果；如果不存在合法的分组方案，第一行输出一个数 $-1$ 即可。\n\n第二行，输出一个整数，表示有多少对战士配合默契但是不可能被分在同一小组。", "hint": "本题共有三个 Subtask。\n\n- Subtask 1：共 $5$ 个测试点，一个测试点 $5$ 分，满足 $N≤30$；\n- Subtask 2：共 $3$ 个测试点，一个测试点 $10$ 分，满足 $N≤300$；\n- Subtask 3：共 $3$ 个测试点，一个测试点 $15$ 分，满足 $N≤2500$。 \n\n对于所有的数据，不会重复说明同一组关系，$1\\le x,y\\le  n$ 且 $x\\neq y$。此外保证 $0\\le m≤n\\times (n-1)/2$。\n\n\n本题开启 Special Judge：\n\n- 若你的答案第一行输出正确你可以得到该测试点 $60\\%$ 的分数；\n- 若你的答案第二行输出正确你可以得到该测试点 $40\\%$ 的分数。\n\n为了确保你能够得到部分分，**请按格式要求输出**。\n", "locale": "zh-CN"}}}
{"pid": "P5062", "type": "P", "difficulty": 6, "samples": [["10\n2 5\n1 3\n1 4\n2 3\n2 4\n2 5\n1 4\n2 3\n2 4\n2 5", "0\n0\n2\n3\n0\n0\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "平衡树", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2014] 在太阳西斜的这个世界里", "background": "![](https://cdn.luogu.com.cn/upload/pic/45500.png)  \n现在我的梦想实现了 也留下了美好的回忆  \n可以说没有任何遗憾了吧   \n![](https://cdn.luogu.com.cn/upload/pic/45511.png)  \n今天真是多谢你了  \n让我体验了许多美好  \n这全都是托你的福   \n我留下了如同美梦一般的回忆 不过时间到了  \n最后我还想拜托你一件事  \n![](https://cdn.luogu.com.cn/upload/pic/45522.png)  \n希望你可以把我忘掉  ", "description": "珂朵莉需要维护一棵初始为空的红黑树，进行 $n$ 次操作。\n\n对于重复的整数，我们认为插入时间晚的一个更小。\n\n操作有两类：\n\n* $op=1$：在红黑树上插入一个整数$x$。\n* $op=2$：给出 $x$，询问从 $1$ 到 $x$ 的整数中等概率选取一个插入到红黑树上，造成的旋转次数的期望值，方便起见，你只要输出 期望值$\\times x$，（可以证明这是一个整数）。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行两个由空格分隔的整数 $op,x$，表示一次操作。\n", "outputFormat": "对每个 $op=2$ 的操作，输出一行，包含一个整数，表示答案。", "hint": "红黑树是一棵二叉查找树，每个点有颜色（红/黑）。\n\n每次执行插入操作时，新插入的点为红色，操作方式和普通二叉查找树相同。\n\n如果出现两个红色的点互为父子，如图进行调整（操作是左右对称的，对称操作在图中不再重复列出；黑色三角形表示空或以黑色点为根的子树），调整可能需要连续进行多次。\n\n调整完毕后，把根设为黑色。\n\n![](https://cdn.luogu.com.cn/upload/pic/45533.png)  \n\nIdea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n$1\\leq n\\leq 2\\times 10^5$，$1\\leq op\\leq 2$，$1\\leq x\\leq 10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2014] In This World Where the Sun Slants West", "background": "![](https://cdn.luogu.com.cn/upload/pic/45500.png)  \nNow my dream has come true, and I have also留下了美好的回忆 (liú xià le měi hǎo de huí yì).  \nYou could say there are no regrets at all.  \n![](https://cdn.luogu.com.cn/upload/pic/45511.png)  \nThank you so much for today.  \nYou let me experience so many wonderful things.  \nAll of this is thanks to you.  \nI have memories like a beautiful dream, but the time has come.  \nFinally, I want to ask you for one more favor.  \n![](https://cdn.luogu.com.cn/upload/pic/45522.png)  \nI hope you can forget me.", "description": "Chtholly needs to maintain a red-black tree that is initially empty, and perform $n$ operations.\n\nFor duplicate integers, we consider the one inserted later to be smaller.\n\nThere are two types of operations:\n\n* $op=1$: Insert an integer $x$ into the red-black tree.\n* $op=2$: Given $x$, suppose we choose an integer uniformly at random from $1$ to $x$ and insert it into the red-black tree. Query the expected number of rotations caused by this insertion. For convenience, you only need to output $\\text{expected value} \\times x$ (it can be proven that this is an integer).", "inputFormat": "The first line contains an integer $n$.\n\nThe next $n$ lines each contain two integers $op,x$ separated by a space, representing one operation.", "outputFormat": "For each operation with $op=2$, output one line containing one integer, which is the answer.", "hint": "A red-black tree is a binary search tree where each node has a color (red/black).\n\nEach time an insertion is performed, the newly inserted node is red, and the insertion process is the same as in a normal binary search tree.\n\nIf two red nodes become a parent-child pair, adjust as shown in the figure (the operations are left-right symmetric, and symmetric cases are not repeated in the figure; the black triangle represents null or a subtree rooted at a black node). The adjustment may need to be performed multiple times in a row.\n\nAfter the adjustment, set the root to black.\n\n![](https://cdn.luogu.com.cn/upload/pic/45533.png)  \n\nIdea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078\n\nConstraints: $1\\leq n\\leq 2\\times 10^5$，$1\\leq op\\leq 2$，$1\\leq x\\leq 10^8$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2014] 在太阳西斜的这个世界里", "background": "![](https://cdn.luogu.com.cn/upload/pic/45500.png)  \n现在我的梦想实现了 也留下了美好的回忆  \n可以说没有任何遗憾了吧   \n![](https://cdn.luogu.com.cn/upload/pic/45511.png)  \n今天真是多谢你了  \n让我体验了许多美好  \n这全都是托你的福   \n我留下了如同美梦一般的回忆 不过时间到了  \n最后我还想拜托你一件事  \n![](https://cdn.luogu.com.cn/upload/pic/45522.png)  \n希望你可以把我忘掉  ", "description": "珂朵莉需要维护一棵初始为空的红黑树，进行 $n$ 次操作。\n\n对于重复的整数，我们认为插入时间晚的一个更小。\n\n操作有两类：\n\n* $op=1$：在红黑树上插入一个整数$x$。\n* $op=2$：给出 $x$，询问从 $1$ 到 $x$ 的整数中等概率选取一个插入到红黑树上，造成的旋转次数的期望值，方便起见，你只要输出 期望值$\\times x$，（可以证明这是一个整数）。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行两个由空格分隔的整数 $op,x$，表示一次操作。\n", "outputFormat": "对每个 $op=2$ 的操作，输出一行，包含一个整数，表示答案。", "hint": "红黑树是一棵二叉查找树，每个点有颜色（红/黑）。\n\n每次执行插入操作时，新插入的点为红色，操作方式和普通二叉查找树相同。\n\n如果出现两个红色的点互为父子，如图进行调整（操作是左右对称的，对称操作在图中不再重复列出；黑色三角形表示空或以黑色点为根的子树），调整可能需要连续进行多次。\n\n调整完毕后，把根设为黑色。\n\n![](https://cdn.luogu.com.cn/upload/pic/45533.png)  \n\nIdea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n$1\\leq n\\leq 2\\times 10^5$，$1\\leq op\\leq 2$，$1\\leq x\\leq 10^8$。", "locale": "zh-CN"}}}
{"pid": "P5063", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 3 9\n2 1 2 1\n2 1 3 1", "1\n1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "二分", "O2优化", "排序", "分块", "Ynoi"], "title": "[Ynoi Easy Round 2014] 置身天上之森", "background": "![](https://cdn.luogu.com.cn/upload/pic/45593.png)  \n如果，我是说如果  \n我再过五天就会死掉的话  \n你可以再温柔的对待我一点吗？  \n![](https://cdn.luogu.com.cn/upload/pic/45555.png)  \n运气真好  \n牺牲我一个就可以了  \n怎么样，就是这么一回事   \n![](https://cdn.luogu.com.cn/upload/pic/45566.png)  \n你现在愿意答应我最后的愿望吗？  \n那个...就是...比如说...对了  \n![](https://cdn.luogu.com.cn/upload/pic/45577.png)  \n让你吻我之类的  \n你愿意吗 \n![](https://cdn.luogu.com.cn/upload/pic/45586.png)  \n在自己消失之前  \n心怀不想消失的愿望  \n希望让某个人记住我   \n希望能留下羁绊  \n我这么希望着，又有什么不可以的吗  \n![](https://cdn.luogu.com.cn/upload/pic/45501.png)  ", "description": "线段树是一种特殊的二叉树，满足以下性质：  \n每个点和一个区间对应，且有一个整数权值；  \n根节点对应的区间是 $[1,n]$；  \n如果一个点对应的区间是 $[l,r]$，且 $l<r$，那么它的左孩子和右孩子分别对应区间 $[l,m]$ 和 $[m+1,r]$，其中 $m=\\lfloor\\frac{l+r}{2}\\rfloor$；  \n如果一个点对应的区间是 $[l,r]$，且 $l=r$，那么这个点是叶子；\n如果一个点不是叶子，那么它的权值等于左孩子和右孩子的权值之和。  \n珂朵莉需要维护一棵线段树，叶子的权值初始为 $0$，接下来会进行 $m$ 次操作:  \n操作 $1$：给出 $l,r,a$，对每个 $x$（$l\\leq x\\leq r$），将 $[x,x]$ 对应的叶子的权值加上 $a$，非叶节点的权值相应变化；  \n操作 $2$：给出 $l,r,a$，询问有多少个线段树上的点，满足这个点对应的区间被 $[l,r]$ 包含，且权值小于等于 $a$。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行包含四个整数 $op,l,r,a$，表示一次操作，其中 $op$ 表示操作类型。\n", "outputFormat": "对每个 $op=2$ 的操作，输出一行，包含一个整数，表示答案", "hint": "Idea：zcysky，\n\nSolution：nzhtl1477( $O( m\\sqrt{n\\log n})$ solution )，ccz181078( $O( m\\sqrt{n})$ solution )\n\nCode：nzhtl1477( $O( m\\sqrt{n} \\log n)$ code )，ccz181078( $O( m\\sqrt{n\\log n})$ code )，\n\nData：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^5$，$1\\leq l\\leq r\\leq n$，$1\\leq op\\leq 2$，$-10^5\\leq a\\leq 10^5$。  \n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2014] In the Forest Above the Sky", "background": "![](https://cdn.luogu.com.cn/upload/pic/45593.png)  \nIf, I mean if,  \nI were going to die in five more days,  \ncould you treat me a bit more gently?  \n![](https://cdn.luogu.com.cn/upload/pic/45555.png)  \nSuch good luck.  \nSacrificing only me will be enough.  \nThat is how it is.  \n![](https://cdn.luogu.com.cn/upload/pic/45566.png)  \nAre you willing to grant my last wish now?  \nUm... well... for example... right.  \n![](https://cdn.luogu.com.cn/upload/pic/45577.png)  \nLike letting you kiss me.  \nWould you?  \n![](https://cdn.luogu.com.cn/upload/pic/45586.png)  \nBefore I disappear,  \nI hold the wish that I do not want to disappear.  \nI hope someone will remember me.  \nI hope to leave behind a bond.  \nI wish for this—what is wrong with that?  \n![](https://cdn.luogu.com.cn/upload/pic/45501.png)", "description": "A segment tree is a special binary tree that satisfies the following properties:  \nEach node corresponds to an interval and has an integer weight.  \nThe interval corresponding to the root is $[1,n]$.  \nIf a node corresponds to interval $[l,r]$ and $l<r$, then its left child and right child correspond to intervals $[l,m]$ and $[m+1,r]$, where $m=\\lfloor\\frac{l+r}{2}\\rfloor$.  \nIf a node corresponds to interval $[l,r]$ and $l=r$, then this node is a leaf.  \nIf a node is not a leaf, then its weight equals the sum of the weights of its left child and right child.  \n\nChtholly (ke duo li, 珂朵莉) needs to maintain a segment tree. The initial weights of the leaves are $0$. Then $m$ operations will be performed:  \n\nOperation $1$: given $l,r,a$, for every $x$ ($l\\leq x\\leq r$), add $a$ to the weight of the leaf corresponding to $[x,x]$, and the weights of non-leaf nodes change accordingly.  \n\nOperation $2$: given $l,r,a$, ask how many nodes in the segment tree satisfy that the interval corresponding to this node is contained in $[l,r]$, and its weight is less than or equal to $a$.", "inputFormat": "The first line contains two integers $n,m$.  \n\nIn the next $m$ lines, each line contains four integers $op,l,r,a$, representing one operation, where $op$ indicates the operation type.", "outputFormat": "For each operation with $op=2$, output one line containing one integer, which is the answer.", "hint": "Idea: zcysky.  \n\nSolution: nzhtl1477 ( $O( m\\sqrt{n\\log n})$ solution ), ccz181078 ( $O( m\\sqrt{n})$ solution ).  \n\nCode: nzhtl1477 ( $O( m\\sqrt{n} \\log n)$ code ), ccz181078 ( $O( m\\sqrt{n\\log n})$ code ).  \n\nData: nzhtl1477.  \n\nConstraints: for $100\\%$ of the testdata, $1\\leq n,m\\leq 10^5$, $1\\leq l\\leq r\\leq n$, $1\\leq op\\leq 2$, $-10^5\\leq a\\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2014] 置身天上之森", "background": "![](https://cdn.luogu.com.cn/upload/pic/45593.png)  \n如果，我是说如果  \n我再过五天就会死掉的话  \n你可以再温柔的对待我一点吗？  \n![](https://cdn.luogu.com.cn/upload/pic/45555.png)  \n运气真好  \n牺牲我一个就可以了  \n怎么样，就是这么一回事   \n![](https://cdn.luogu.com.cn/upload/pic/45566.png)  \n你现在愿意答应我最后的愿望吗？  \n那个...就是...比如说...对了  \n![](https://cdn.luogu.com.cn/upload/pic/45577.png)  \n让你吻我之类的  \n你愿意吗 \n![](https://cdn.luogu.com.cn/upload/pic/45586.png)  \n在自己消失之前  \n心怀不想消失的愿望  \n希望让某个人记住我   \n希望能留下羁绊  \n我这么希望着，又有什么不可以的吗  \n![](https://cdn.luogu.com.cn/upload/pic/45501.png)  ", "description": "线段树是一种特殊的二叉树，满足以下性质：  \n每个点和一个区间对应，且有一个整数权值；  \n根节点对应的区间是 $[1,n]$；  \n如果一个点对应的区间是 $[l,r]$，且 $l<r$，那么它的左孩子和右孩子分别对应区间 $[l,m]$ 和 $[m+1,r]$，其中 $m=\\lfloor\\frac{l+r}{2}\\rfloor$；  \n如果一个点对应的区间是 $[l,r]$，且 $l=r$，那么这个点是叶子；\n如果一个点不是叶子，那么它的权值等于左孩子和右孩子的权值之和。  \n珂朵莉需要维护一棵线段树，叶子的权值初始为 $0$，接下来会进行 $m$ 次操作:  \n操作 $1$：给出 $l,r,a$，对每个 $x$（$l\\leq x\\leq r$），将 $[x,x]$ 对应的叶子的权值加上 $a$，非叶节点的权值相应变化；  \n操作 $2$：给出 $l,r,a$，询问有多少个线段树上的点，满足这个点对应的区间被 $[l,r]$ 包含，且权值小于等于 $a$。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行包含四个整数 $op,l,r,a$，表示一次操作，其中 $op$ 表示操作类型。\n", "outputFormat": "对每个 $op=2$ 的操作，输出一行，包含一个整数，表示答案", "hint": "Idea：zcysky，\n\nSolution：nzhtl1477( $O( m\\sqrt{n\\log n})$ solution )，ccz181078( $O( m\\sqrt{n})$ solution )\n\nCode：nzhtl1477( $O( m\\sqrt{n} \\log n)$ code )，ccz181078( $O( m\\sqrt{n\\log n})$ code )，\n\nData：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^5$，$1\\leq l\\leq r\\leq n$，$1\\leq op\\leq 2$，$-10^5\\leq a\\leq 10^5$。  \n", "locale": "zh-CN"}}}
{"pid": "P5064", "type": "P", "difficulty": 6, "samples": [["6 10\n816801151 223885531 110182151 94271893 319888699 106363731 \n1 1 3\n1 3 5\n1 2 4\n1 4 6\n1 1 2\n3 1 1\n2 4\n1 1 2\n3 1 4\n2 7", "94271893\n223885531"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480, 20480]}, "tags": ["2014", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2014] 等这场战争结束之后", "background": "我真的能变强吗？\n![](https://cdn.luogu.com.cn/upload/pic/45502.png)  \n【就算你不愿意，我也会逼你变强】  \n那么承蒙你的一片美意，我就直说了吧    \n![](https://cdn.luogu.com.cn/upload/pic/45503.png)  \n那个嘛...  \n我才不想变强呢~！   \n【那这样吧，只要你从战场上活着回来】  \n【我可以答应你随便一个要求，随便什么都行】   \n诶？  \n![](https://cdn.luogu.com.cn/upload/pic/45504.png)  \n【结婚什么的当然免谈啦】  \n你说什么都行的...  \n![](https://cdn.luogu.com.cn/upload/pic/45505.png)  \n点心...  \n你之前不是在食堂做了点心吗  \n那么黄油蛋糕你会做吗  \n![](https://cdn.luogu.com.cn/upload/pic/45506.png)  \n我的姐姐...也就是前辈们当中  \n有一个人每次从战场上活着回来之后  \n都会一脸陶醉地品尝黄油蛋糕  \n所以...拜托你了  \n【偏偏挑这个...】  \n【没问题，我会让你吃到吐的】  \n【所以，你一定要活着回来】  ", "description": "给你一个图，每个点有点权，最开始没有边。\n\n有一些操作：\n\n1. 添加一条 $x$ 与 $y$ 之间的双向边。\n2. 回到第 $x$ 次操作后的状态（注意这里的 $x$ 可以是 $0$，即回到初始状态）。\n3. 查询 $x$ 所在联通块能到的点中点权第 $y$ 小的值，如果不存在，那么输出 $-1$。", "inputFormat": "第一行输入两个整数 $n,m$，表示有 $n$ 个点，$m$ 个操作。\n\n之后一行 $n$ 个数，表示每个点的点权。\n\n之后 $m$ 行，每行有三种可能的操作：\n\n`1 x y`\n\n`2 x`\n\n`3 x y`\n\n意义见题面。", "outputFormat": "对所有 $3$ 的操作，输出一行，包含一个整数，表示答案。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477( $O( nm/w )$ Time , $O( n\\log n )$ Space )，ccz181078( $O( m\\sqrt{n\\log n} )$ Time ，$O(n\\sqrt{n\\log n} )$ Space ) ，shadowice1984( $O( m\\sqrt{n\\log n} )$ Time , $O( n\\log n )$ Space ) , zx2003( $O( m\\sqrt{n} )$ Time ，$O( n )$ Space )\n\nCode：nzhtl1477( $O( nm/w )$ Time , $O( n\\log n )$ Space )，ccz181078( $O( m\\sqrt{n\\log n} )$ Time , $O( n\\sqrt{n\\log n} )$ Space ) ，shadowice1984( $O( m\\sqrt{n\\log n} )$ Time ，$O( n\\log n )$ Space )，zx2003( $O( m\\sqrt{n} )$ Time ，$O( n )$ Space )\n\nData：nzhtl1477( partially uploaded )\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^5$，$0\\leq a_i\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2014] After This War Ends", "background": "Can I really become stronger?  \n![](https://cdn.luogu.com.cn/upload/pic/45502.png)  \n【Even if you don’t want to, I will force you to become stronger.】  \nThen, thanks for your kindness, I’ll say it directly.  \n![](https://cdn.luogu.com.cn/upload/pic/45503.png)  \nWell...  \nI don’t want to become stronger at all~!  \n【Then how about this: as long as you come back alive from the battlefield.】  \n【I can promise you any one request, anything at all.】  \nHuh?  \n![](https://cdn.luogu.com.cn/upload/pic/45504.png)  \n【Marriage is of course out of the question.】  \nYou said anything...  \n![](https://cdn.luogu.com.cn/upload/pic/45505.png)  \nDesserts...  \nDidn’t you make desserts in the cafeteria before?  \nThen, can you make butter cake?  \n![](https://cdn.luogu.com.cn/upload/pic/45506.png)  \nMy older sister... that is, among the seniors,  \nthere is someone who, every time she comes back alive from the battlefield,  \nwill taste butter cake with a blissful look on her face.  \nSo... please.  \n【Of all things, you picked this...】  \n【No problem. I’ll make you eat until you throw up.】  \n【So, you must come back alive.】", "description": "You are given a graph. Each vertex has a weight, and initially there are no edges.\n\nThere are some operations:\n\n1. Add an undirected edge between $x$ and $y$.\n2. Revert to the state after the $x$-th operation (note that $x$ can be $0$, which means reverting to the initial state).\n3. Query the $y$-th smallest vertex weight among the vertices reachable in the connected component containing $x$. If it does not exist, output $-1$.", "inputFormat": "The first line contains two integers $n,m$, meaning there are $n$ vertices and $m$ operations.\n\nThe next line contains $n$ numbers, giving the weight of each vertex.\n\nThen follow $m$ lines, each being one of the following three types:\n\n`1 x y`\n\n`2 x`\n\n`3 x y`\n\nTheir meanings are as described in the statement.", "outputFormat": "For every operation of type $3$, output one line containing one integer, which is the answer.", "hint": "Idea: nzhtl1477.\n\nSolution: nzhtl1477( $O( nm/w )$ Time , $O( n\\log n )$ Space )，ccz181078( $O( m\\sqrt{n\\log n} )$ Time ，$O(n\\sqrt{n\\log n} )$ Space ) ，shadowice1984( $O( m\\sqrt{n\\log n} )$ Time , $O( n\\log n )$ Space ) , zx2003( $O( m\\sqrt{n} )$ Time ，$O( n )$ Space ).\n\nCode: nzhtl1477( $O( nm/w )$ Time , $O( n\\log n )$ Space )，ccz181078( $O( m\\sqrt{n\\log n} )$ Time , $O( n\\sqrt{n\\log n} )$ Space ) ，shadowice1984( $O( m\\sqrt{n\\log n} )$ Time ，$O( n\\log n )$ Space )，zx2003( $O( m\\sqrt{n} )$ Time ，$O( n )$ Space ).\n\nData: nzhtl1477( partially uploaded ).\n\nConstraints: for $100\\%$ of the testdata, $1\\leq n,m\\leq 10^5$ and $0\\leq a_i\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2014] 等这场战争结束之后", "background": "我真的能变强吗？\n![](https://cdn.luogu.com.cn/upload/pic/45502.png)  \n【就算你不愿意，我也会逼你变强】  \n那么承蒙你的一片美意，我就直说了吧    \n![](https://cdn.luogu.com.cn/upload/pic/45503.png)  \n那个嘛...  \n我才不想变强呢~！   \n【那这样吧，只要你从战场上活着回来】  \n【我可以答应你随便一个要求，随便什么都行】   \n诶？  \n![](https://cdn.luogu.com.cn/upload/pic/45504.png)  \n【结婚什么的当然免谈啦】  \n你说什么都行的...  \n![](https://cdn.luogu.com.cn/upload/pic/45505.png)  \n点心...  \n你之前不是在食堂做了点心吗  \n那么黄油蛋糕你会做吗  \n![](https://cdn.luogu.com.cn/upload/pic/45506.png)  \n我的姐姐...也就是前辈们当中  \n有一个人每次从战场上活着回来之后  \n都会一脸陶醉地品尝黄油蛋糕  \n所以...拜托你了  \n【偏偏挑这个...】  \n【没问题，我会让你吃到吐的】  \n【所以，你一定要活着回来】  ", "description": "给你一个图，每个点有点权，最开始没有边。\n\n有一些操作：\n\n1. 添加一条 $x$ 与 $y$ 之间的双向边。\n2. 回到第 $x$ 次操作后的状态（注意这里的 $x$ 可以是 $0$，即回到初始状态）。\n3. 查询 $x$ 所在联通块能到的点中点权第 $y$ 小的值，如果不存在，那么输出 $-1$。", "inputFormat": "第一行输入两个整数 $n,m$，表示有 $n$ 个点，$m$ 个操作。\n\n之后一行 $n$ 个数，表示每个点的点权。\n\n之后 $m$ 行，每行有三种可能的操作：\n\n`1 x y`\n\n`2 x`\n\n`3 x y`\n\n意义见题面。", "outputFormat": "对所有 $3$ 的操作，输出一行，包含一个整数，表示答案。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477( $O( nm/w )$ Time , $O( n\\log n )$ Space )，ccz181078( $O( m\\sqrt{n\\log n} )$ Time ，$O(n\\sqrt{n\\log n} )$ Space ) ，shadowice1984( $O( m\\sqrt{n\\log n} )$ Time , $O( n\\log n )$ Space ) , zx2003( $O( m\\sqrt{n} )$ Time ，$O( n )$ Space )\n\nCode：nzhtl1477( $O( nm/w )$ Time , $O( n\\log n )$ Space )，ccz181078( $O( m\\sqrt{n\\log n} )$ Time , $O( n\\sqrt{n\\log n} )$ Space ) ，shadowice1984( $O( m\\sqrt{n\\log n} )$ Time ，$O( n\\log n )$ Space )，zx2003( $O( m\\sqrt{n} )$ Time ，$O( n )$ Space )\n\nData：nzhtl1477( partially uploaded )\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^5$，$0\\leq a_i\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5065", "type": "P", "difficulty": 6, "samples": [["2 3\n0 2 \n2 3\n1 1 1\n2 3", "-1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2014] 不归之人与望眼欲穿的人们", "background": "【第一船队发来联络了】  \n【是关于第15号悬浮岛的战斗结果】  \n【15号悬浮岛的保卫作战...】  \n【失败了...】  \n![](https://cdn.luogu.com.cn/upload/pic/45508.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45509.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45510.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45512.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45513.png)   \n![](https://cdn.luogu.com.cn/upload/pic/45514.png)  ", "description": "珂朵莉给了你一个序列，支持单点修改，或者询问满足区间 or 和**大于等于**一个数的区间的最短可能长度，无解输出 $-1$。", "inputFormat": "第一行有两个整数 $n,m$。\n\n接下来一行 $n$ 个整数，表示这个序列 $a$。\n\n接下来 $m$ 行，形如：\n\n* $1\\ i\\ x$ 表示将 $a_i$ 修改为 $x$。\n* $2\\ k$ 表示询问最短的一个长度，满足存在一个该长度的区间，其 or 和 $\\geq k$。  ", "outputFormat": "对所有 $2$ 操作，输出一行，包含一个整数，表示答案，无解输出 $-1$。", "hint": "Idea：kczno1，\n\nSolution：kczno1( $O( m\\sqrt n\\log a )$ solution )，liu_cheng_ao($O( m\\log^2 n\\log^2 a$ ) solution )，142857cs($O( m\\log n\\log^2 a$ ) solution )\n\nCode：kczno1( $O( m\\sqrt n\\log a )$ code )，liu_cheng_ao($O( m\\log^2 n\\log^2a$ ) code )\n\n，Data：kczno1\n\n对于 $100\\%$ 的数据，$0\\leq a_i,k\\leq 2^{30}$，$1\\leq n,m\\leq 5\\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2014] The People Who Never Return and the People Who Wait in Vain.", "background": "【The First Fleet has sent a message】  \n【It is about the battle result of Floating Island No. 15】  \n【The defense operation of Floating Island No. 15...】  \n【Has failed...】  \n![](https://cdn.luogu.com.cn/upload/pic/45508.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45509.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45510.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45512.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45513.png)   \n![](https://cdn.luogu.com.cn/upload/pic/45514.png)", "description": "Chtholly gives you a sequence. It supports point updates, and queries asking for the minimum possible length of an interval whose bitwise OR sum is **greater than or equal to** a given number. If there is no solution, output $-1$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next line contains $n$ integers, representing the sequence $a$.\n\nThe next $m$ lines are in one of the following forms:\n\n* $1\\ i\\ x$: set $a_i$ to $x$.\n* $2\\ k$: query the minimum length such that there exists an interval of that length whose bitwise OR sum is $\\geq k$.", "outputFormat": "For every operation of type $2$, output one line containing an integer, the answer. If there is no solution, output $-1$.", "hint": "Idea: kczno1.\n\nSolution: kczno1 ($O( m\\sqrt n\\log a )$ solution), liu_cheng_ao ($O( m\\log^2 n\\log^2 a )$ solution), 142857cs ($O( m\\log n\\log^2 a )$ solution).\n\nCode: kczno1 ($O( m\\sqrt n\\log a )$ code), liu_cheng_ao ($O( m\\log^2 n\\log^2a$ ) code).\n\nData: kczno1.\n\nConstraints: For $100\\%$ of the testdata, $0\\leq a_i, k\\leq 2^{30}$, $1\\leq n, m\\leq 5\\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2014] 不归之人与望眼欲穿的人们", "background": "【第一船队发来联络了】  \n【是关于第15号悬浮岛的战斗结果】  \n【15号悬浮岛的保卫作战...】  \n【失败了...】  \n![](https://cdn.luogu.com.cn/upload/pic/45508.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45509.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45510.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45512.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45513.png)   \n![](https://cdn.luogu.com.cn/upload/pic/45514.png)  ", "description": "珂朵莉给了你一个序列，支持单点修改，或者询问满足区间 or 和**大于等于**一个数的区间的最短可能长度，无解输出 $-1$。", "inputFormat": "第一行有两个整数 $n,m$。\n\n接下来一行 $n$ 个整数，表示这个序列 $a$。\n\n接下来 $m$ 行，形如：\n\n* $1\\ i\\ x$ 表示将 $a_i$ 修改为 $x$。\n* $2\\ k$ 表示询问最短的一个长度，满足存在一个该长度的区间，其 or 和 $\\geq k$。  ", "outputFormat": "对所有 $2$ 操作，输出一行，包含一个整数，表示答案，无解输出 $-1$。", "hint": "Idea：kczno1，\n\nSolution：kczno1( $O( m\\sqrt n\\log a )$ solution )，liu_cheng_ao($O( m\\log^2 n\\log^2 a$ ) solution )，142857cs($O( m\\log n\\log^2 a$ ) solution )\n\nCode：kczno1( $O( m\\sqrt n\\log a )$ code )，liu_cheng_ao($O( m\\log^2 n\\log^2a$ ) code )\n\n，Data：kczno1\n\n对于 $100\\%$ 的数据，$0\\leq a_i,k\\leq 2^{30}$，$1\\leq n,m\\leq 5\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5066", "type": "P", "difficulty": 7, "samples": [["5 5\n0 1 0 0 1\n3 2 5\n5 2 5\n2 2 2\n6 1 5\n7 1 5", "1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 8000, 8000, 8000, 8000, 8000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2014", "平衡树", "颜色段均摊（珂朵莉树 ODT）", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2014] 人人本着正义之名", "background": "那是什么？  \n【不是第六兽，是新的兽？】  \n【我从来没见过那种玩意啊】  \n![](https://cdn.luogu.com.cn/upload/pic/45515.png)    \n【全员退避】  \n【现已确认出现预料之外的兽】  \n【根据这一事态，将作战确认为失败，放弃15号岛】  \n怎么会...  \n![](https://cdn.luogu.com.cn/upload/pic/45516.png)   \n我和他约好了的  \n绝对要活着回去  \n![](https://cdn.luogu.com.cn/upload/pic/45517.png)   \n对他说“我回来了”，然后品尝黄油蛋糕  \n所以，要是世界终结的话我会很伤脑筋的  \n![](https://cdn.luogu.com.cn/upload/pic/45518.png)   \n融没于晨雾之中的树林  \n啊...？  \n![](https://cdn.luogu.com.cn/upload/pic/45519.png)  \n【牛奶迹.耀眼花瓣.狂风气团】  \n【挂于墙上的鲱鱼.倒立的刺猬.袋中的风琴】  \n这是什么...？  \n![](https://cdn.luogu.com.cn/upload/pic/45520.png)  \n你其实...很想战斗的对吧  \n虽然我不知道你有什么打算，但是已经够了  \n![](https://cdn.luogu.com.cn/upload/pic/45521.png)  \n你已经不用战斗了  \n因为你的战斗，已经由我，由我们继承下来了  \n【其实我很感激你】  \n【一直以来，我心里就只想着死】  \n![](https://cdn.luogu.com.cn/upload/pic/45523.png)  \n【渴望去往那些等着我回去的家伙身边，这是我唯一的愿望】  \n【但是遇见你们之后，我有了一些改变】  \n【我又开始渴望获得一个容身之处了】  \n【遇见你之后，我得到了一些救赎】  \n【能够等到你平安归来，我现在...】  \n【嗯，可以说，感受到了一丝幸福】  \n啊...？   \n![](https://cdn.luogu.com.cn/upload/pic/45524.png)  \n【不...等一下，你别这么露骨地和我拉开距离啊】  \n【也别露出一副“这个不知廉耻的生物是怎样”的表情啊】   \n【不过话说回来，你观察我观察地很仔细啊】  \n哈哈...  \n因为喜欢上了嘛~   \n![](https://cdn.luogu.com.cn/upload/pic/45525.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45526.png)  \n【由不得我啊】  \n你要去的话我会生气的，我会大发雷霆的  \n【珂朵莉...】   \n![](https://cdn.luogu.com.cn/upload/pic/45527.png)  \n【对不起】\n![](https://cdn.luogu.com.cn/upload/pic/45528.png)  \n我等你  \n![](https://cdn.luogu.com.cn/upload/pic/45529.png)  \n我会等着你的，所以一定要回来哦   \n![](https://cdn.luogu.com.cn/upload/pic/45530.png)  \n【我保证，一定会回来的】  \n嗯  \n说好了哦~   \n![](https://cdn.luogu.com.cn/upload/pic/45531.png)   ", "description": "你需要帮珂朵莉维护一个长为 $n$ 的 `01`序列 $a$，有 $m$ 个操作：  \n- `1 l r`：把区间 $[l,r]$ 的数变成 $0$。\n- `2 l r`：把区间 $[l,r]$ 的数变成 $1$。\n- `3 l r`：$[l,r-1]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i+1}$ 按位或的值，这些数同时进行这个操作。\n- `4 l r`：$[l+1,r]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i-1}$ 按位或的值，这些数同时进行这个操作。\n- `5 l r`：$[l,r-1]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i+1}$ 按位与的值，这些数同时进行这个操作。\n- `6 l r`：$[l+1,r]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i-1}$ 按位与的值，这些数同时进行这个操作。\n- `7 l r`：查询区间 $[l,r]$ 的和。\n\n本题强制在线，每次的 $l,r$ 需要与上次答案做 $\\operatorname{xor}$ 运算，如果之前没有询问，则上次答案为 $0$。", "inputFormat": "第一行两个整数表示 $n$ 和 $m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n之后 $m$ 行，每行三个整数 $opt,l,r$，表示是哪一种操作以及操作对应的区间。\n", "outputFormat": "对于每个查询操作输出一行一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n序列每次的样子：\n$$0\\ 1\\ 0\\ 0\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 1\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n\n对于 $30\\%$ 的数据，$n,m\\leq 1000$。\n\n对于 $50\\%$ 的数据，$n,m\\leq 10^5$。\n\n对于另外 $30\\%$ 的数据，操作和序列均随机生成。\n\n对于另外 $10\\%$ 的数据，$n,m\\leq 10^6$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 3 \\times 10^6$，$0\\leq a_i\\leq 1$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2014] Everyone in the Name of Justice.", "background": "What is that?  \n【Not the Sixth Beast, but a new beast?】  \n【I have never seen that thing before.】  \n![](https://cdn.luogu.com.cn/upload/pic/45515.png)    \n【All personnel retreat.】  \n【An unexpected beast has been confirmed.】  \n【Based on this situation, confirm the operation as a failure and abandon Island No. 15.】  \nHow could this be...  \n![](https://cdn.luogu.com.cn/upload/pic/45516.png)   \nI made a promise with him.  \nWe must come back alive, no matter what.  \n![](https://cdn.luogu.com.cn/upload/pic/45517.png)   \nI will tell him, “I’m back,” and then taste the butter cake.  \nSo if the world ends, I will be in big trouble.  \n![](https://cdn.luogu.com.cn/upload/pic/45518.png)   \nA forest melting into the morning mist.  \nAh...?  \n![](https://cdn.luogu.com.cn/upload/pic/45519.png)  \n【Milk traces, dazzling petals, a whirlwind air mass.】  \n【A herring hung on the wall, an upside-down hedgehog, an organ in a bag.】  \nWhat is this...?  \n![](https://cdn.luogu.com.cn/upload/pic/45520.png)  \nActually... you really want to fight, right?  \nAlthough I do not know what you are planning, it is enough already.  \n![](https://cdn.luogu.com.cn/upload/pic/45521.png)  \nYou do not need to fight anymore.  \nBecause your fight has already been inherited by me, by us.  \n【Actually, I am very grateful to you.】  \n【All this time, all I could think about was dying.】  \n![](https://cdn.luogu.com.cn/upload/pic/45523.png)  \n【Longing to go back to those guys waiting for me, that was my only wish.】  \n【But after meeting you, I changed a little.】  \n【I started longing for a place to belong again.】  \n【After meeting you, I found some salvation.】  \n【Being able to wait until you return safely, right now I...】  \n【Well, you could say I feel a bit of happiness.】  \nAh...?  \n![](https://cdn.luogu.com.cn/upload/pic/45524.png)  \n【N-no... wait, do not distance yourself from me so directly.】  \n【And do not make that face like “what is this shameless creature doing.”】  \n【But then again, you observed me very carefully.】  \nHaha...  \nBecause I fell for you~  \n![](https://cdn.luogu.com.cn/upload/pic/45525.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45526.png)  \n【I cannot help it.】  \nIf you go, I will be angry, I will rage.  \n【Chtholly...】  \n![](https://cdn.luogu.com.cn/upload/pic/45527.png)  \n【Sorry.】  \n![](https://cdn.luogu.com.cn/upload/pic/45528.png)  \nI will wait for you.  \n![](https://cdn.luogu.com.cn/upload/pic/45529.png)  \nI will wait for you, so you must come back.  \n![](https://cdn.luogu.com.cn/upload/pic/45530.png)  \n【I promise, I will definitely come back.】  \nMm.  \nIt is a promise~  \n![](https://cdn.luogu.com.cn/upload/pic/45531.png)", "description": "You need to help Chtholly maintain a `01` sequence $a$ of length $n$. There are $m$ operations:  \n- `1 l r`: Set all numbers in interval $[l,r]$ to $0$.  \n- `2 l r`: Set all numbers in interval $[l,r]$ to $1$.  \n- `3 l r`: For all $a_i$ in $[l,r-1]$, change it to the bitwise OR of $a_i$ and $a_{i+1}$. These changes are performed simultaneously.  \n- `4 l r`: For all $a_i$ in $[l+1,r]$, change it to the bitwise OR of $a_i$ and $a_{i-1}$. These changes are performed simultaneously.  \n- `5 l r`: For all $a_i$ in $[l,r-1]$, change it to the bitwise AND of $a_i$ and $a_{i+1}$. These changes are performed simultaneously.  \n- `6 l r`: For all $a_i$ in $[l+1,r]$, change it to the bitwise AND of $a_i$ and $a_{i-1}$. These changes are performed simultaneously.  \n- `7 l r`: Query the sum over interval $[l,r]$.  \n\nThis problem is forced online. Each $l,r$ needs to be XORed with the previous answer using $\\operatorname{xor}$. If there has been no query before, then the previous answer is $0$.", "inputFormat": "The first line contains two integers $n$ and $m$.  \n\nThe second line contains $n$ integers representing the sequence $a$.  \n\nThen follow $m$ lines, each containing three integers $opt,l,r$, indicating which operation it is and the interval it applies to.", "outputFormat": "For each query operation, output one line with one number as the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nThe sequence after each step:\n$$0\\ 1\\ 0\\ 0\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 1\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n\nFor $30\\%$ of the testdata, $n,m\\leq 1000$.  \n\nFor $50\\%$ of the testdata, $n,m\\leq 10^5$.  \n\nFor another $30\\%$ of the testdata, both the operations and the sequence are generated randomly.  \n\nFor another $10\\%$ of the testdata, $n,m\\leq 10^6$.  \n\nConstraints: for $100\\%$ of the testdata, $1\\leq n,m\\leq 3 \\times 10^6$, $0\\leq a_i\\leq 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2014] 人人本着正义之名", "background": "那是什么？  \n【不是第六兽，是新的兽？】  \n【我从来没见过那种玩意啊】  \n![](https://cdn.luogu.com.cn/upload/pic/45515.png)    \n【全员退避】  \n【现已确认出现预料之外的兽】  \n【根据这一事态，将作战确认为失败，放弃15号岛】  \n怎么会...  \n![](https://cdn.luogu.com.cn/upload/pic/45516.png)   \n我和他约好了的  \n绝对要活着回去  \n![](https://cdn.luogu.com.cn/upload/pic/45517.png)   \n对他说“我回来了”，然后品尝黄油蛋糕  \n所以，要是世界终结的话我会很伤脑筋的  \n![](https://cdn.luogu.com.cn/upload/pic/45518.png)   \n融没于晨雾之中的树林  \n啊...？  \n![](https://cdn.luogu.com.cn/upload/pic/45519.png)  \n【牛奶迹.耀眼花瓣.狂风气团】  \n【挂于墙上的鲱鱼.倒立的刺猬.袋中的风琴】  \n这是什么...？  \n![](https://cdn.luogu.com.cn/upload/pic/45520.png)  \n你其实...很想战斗的对吧  \n虽然我不知道你有什么打算，但是已经够了  \n![](https://cdn.luogu.com.cn/upload/pic/45521.png)  \n你已经不用战斗了  \n因为你的战斗，已经由我，由我们继承下来了  \n【其实我很感激你】  \n【一直以来，我心里就只想着死】  \n![](https://cdn.luogu.com.cn/upload/pic/45523.png)  \n【渴望去往那些等着我回去的家伙身边，这是我唯一的愿望】  \n【但是遇见你们之后，我有了一些改变】  \n【我又开始渴望获得一个容身之处了】  \n【遇见你之后，我得到了一些救赎】  \n【能够等到你平安归来，我现在...】  \n【嗯，可以说，感受到了一丝幸福】  \n啊...？   \n![](https://cdn.luogu.com.cn/upload/pic/45524.png)  \n【不...等一下，你别这么露骨地和我拉开距离啊】  \n【也别露出一副“这个不知廉耻的生物是怎样”的表情啊】   \n【不过话说回来，你观察我观察地很仔细啊】  \n哈哈...  \n因为喜欢上了嘛~   \n![](https://cdn.luogu.com.cn/upload/pic/45525.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45526.png)  \n【由不得我啊】  \n你要去的话我会生气的，我会大发雷霆的  \n【珂朵莉...】   \n![](https://cdn.luogu.com.cn/upload/pic/45527.png)  \n【对不起】\n![](https://cdn.luogu.com.cn/upload/pic/45528.png)  \n我等你  \n![](https://cdn.luogu.com.cn/upload/pic/45529.png)  \n我会等着你的，所以一定要回来哦   \n![](https://cdn.luogu.com.cn/upload/pic/45530.png)  \n【我保证，一定会回来的】  \n嗯  \n说好了哦~   \n![](https://cdn.luogu.com.cn/upload/pic/45531.png)   ", "description": "你需要帮珂朵莉维护一个长为 $n$ 的 `01`序列 $a$，有 $m$ 个操作：  \n- `1 l r`：把区间 $[l,r]$ 的数变成 $0$。\n- `2 l r`：把区间 $[l,r]$ 的数变成 $1$。\n- `3 l r`：$[l,r-1]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i+1}$ 按位或的值，这些数同时进行这个操作。\n- `4 l r`：$[l+1,r]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i-1}$ 按位或的值，这些数同时进行这个操作。\n- `5 l r`：$[l,r-1]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i+1}$ 按位与的值，这些数同时进行这个操作。\n- `6 l r`：$[l+1,r]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i-1}$ 按位与的值，这些数同时进行这个操作。\n- `7 l r`：查询区间 $[l,r]$ 的和。\n\n本题强制在线，每次的 $l,r$ 需要与上次答案做 $\\operatorname{xor}$ 运算，如果之前没有询问，则上次答案为 $0$。", "inputFormat": "第一行两个整数表示 $n$ 和 $m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n之后 $m$ 行，每行三个整数 $opt,l,r$，表示是哪一种操作以及操作对应的区间。\n", "outputFormat": "对于每个查询操作输出一行一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n序列每次的样子：\n$$0\\ 1\\ 0\\ 0\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 1\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n\n对于 $30\\%$ 的数据，$n,m\\leq 1000$。\n\n对于 $50\\%$ 的数据，$n,m\\leq 10^5$。\n\n对于另外 $30\\%$ 的数据，操作和序列均随机生成。\n\n对于另外 $10\\%$ 的数据，$n,m\\leq 10^6$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 3 \\times 10^6$，$0\\leq a_i\\leq 1$。", "locale": "zh-CN"}}}
{"pid": "P5067", "type": "P", "difficulty": 7, "samples": [["5 12\n2*(3)\n2 1 1\n2 4 4\n2 1 5\n1 3 2\n2 1 5\n2 1 4\n2 1 3\n2 2 3\n1 1 (\n1 2 5\n1 3 +\n2 1 5", "2\n3\n6\n-1\n46\n4\n-1\n8"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2014", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2014] 长存不灭的过去、逐渐消逝的未来", "background": "![](https://cdn.luogu.com.cn/upload/pic/45532.png)  \n【她遵守了约定哦...】  \n【从不可能存活的战场上】  \n【一心想着要见到技官...想要向技官撒娇...】  \n【才保留下了一点点寿命...平安回来了哦...】  \n没错...她遵守了约定...  \n可我却什么都没能和她说  \n什么都没能为她做  \n什么都...  \n![](https://cdn.luogu.com.cn/upload/pic/45534.png)  \n......  \n珂朵莉......  \n![](https://cdn.luogu.com.cn/upload/pic/45535.png)  \n以前我碰上他人的悲剧或是不幸这种无可奈何的事情时  \n总是设法想去改变什么  \n但是我的力量一直过于渺小...  \n![](https://cdn.luogu.com.cn/upload/pic/45536.png)  \n到最后什么忙都没帮上...  \n我应该已经有深切体会了才对...  \n我想让珂朵莉幸福...  \n真受不了那个家伙...  \n像我这样的男人，到底有什么地方能让她看上啊...  \n![](https://cdn.luogu.com.cn/upload/pic/45537.png)  \n【你连这点事情都想不明白吗？】  \n【因为你...是让我见识了许许多的第一次的人...】  \n【在露天摊贩街上，是你第一次救了我】  \n【是你第一次带我去视野开阔的地方眺望风景】  \n【是你让我第一次产生了各种各样的感情】  \n【你是第一个让我依赖的人，也是第一个将我击败的对手】  \n![](https://cdn.luogu.com.cn/upload/pic/45538.png)  \n【啊...真要数起来根本数不完...】  \n【所以，我第一个喜欢上的人是你，是理所当然的事情】  \n![](https://cdn.luogu.com.cn/upload/pic/45539.png)  \n【这点小事你好歹得察觉到啊，笨~蛋】  \n【我...究竟是怎么了？】  \n【我记得我回到仓库，做了奇怪的梦】  \n![](https://cdn.luogu.com.cn/upload/pic/45540.png)    \n【你久久不回来...】  \n【你怎么了，露出这种表情？】  \n欢迎回来...珂朵莉  \n![](https://cdn.luogu.com.cn/upload/pic/45541.png)  \n欢迎回来...  \n![](https://cdn.luogu.com.cn/upload/pic/45542.png)  ", "description": "珂朵莉定义项为指若干个（$\\ge1$）数字（$0\\cdots 9$）相连得到的字符串（如 `123` `000` 是合法的项，`** *-1 +5` 是不合法的项）。一个合法的表达式可以为一个项（如 `233`）、两个表达式以 `+ -*` 相连（如`2*3+5*5` `6-6*6`）、一个表达式在左右添一对括号（如 (`2*3*3`)）。\n\n注意：空串不是一个合法的表达式。\n\n在一开始，你会得到一个长为 $n$ 的字符串，之后会给定 $m$ 个操作。 有两种操作：\n\n`1 x y` 表示将位置 $x$ 的字符改成 $y$。\n\n`2 l r` 表示询问 $[l,r]$ 的字符串作为表达式求值在 $\\bmod (10^9+7)$ 意义下的结果。若该串不是一个合法的表达式，结果为 $-1$。", "inputFormat": "第一行有两个整数 $n,m$。\n\n第二行有一个长为 $n$ 的字符串。\n\n接下来 $m$ 行，每行为 `1 x y` 或 `2 l r`，分别表示两种操作。\n", "outputFormat": "对所有 $2$ 的操作，输出一行，包含一个整数，表示答案。", "hint": "Idea：mcfx，Solution：mcfx，Code：mcfx，Data：mcfx\n\n$1\\leq n,m \\leq 10^5$，$1 \\leq l\\leq r\\leq n$，$1\\leq x\\leq n$。\n\n字符集为 `0 1 2 3 4 5 6 7 8 9 + - * ( )`\n\n若将 `(` 作为 $1$，`)` 作为 $-1$，其他字符作为 $0$，则保证在任意时刻，该串的任意前缀和的绝对值不超过 $50$。  ", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2014] The Past That Lasts Forever, The Future That Gradually Fades Away", "background": "![](https://cdn.luogu.com.cn/upload/pic/45532.png)  \n【She kept the promise...】  \n【From a battlefield where no one could possibly survive】  \n【Only thinking of meeting the technician officer... wanting to act cute to the technician officer...】  \n【That was why she managed to preserve just a tiny bit of lifespan... and came back safely...】  \nThat’s right... she kept the promise...  \nBut I couldn’t say anything to her.  \nI couldn’t do anything for her.  \nNothing...  \n![](https://cdn.luogu.com.cn/upload/pic/45534.png)  \n......  \nChtholly......  \n![](https://cdn.luogu.com.cn/upload/pic/45535.png)  \nIn the past, whenever I ran into helpless things like other people’s tragedies or misfortunes,  \nI always tried to change something.  \nBut my power has always been far too small...  \n![](https://cdn.luogu.com.cn/upload/pic/45536.png)  \nIn the end, I couldn’t help at all...  \nI should have already understood that deeply...  \nI want Chtholly to be happy...  \nI really can’t stand that guy...  \nA man like me, what on earth is there that she could fall for...  \n![](https://cdn.luogu.com.cn/upload/pic/45537.png)  \n【You can’t even figure out something this simple?】  \n【Because you... are the person who let me experience so, so many firsts...】  \n【On the open-air street stalls, you saved me for the first time】  \n【You were the first to take me to a place with a wide view to look at the scenery】  \n【You made me feel all kinds of emotions for the first time】  \n【You were the first person I relied on, and also the first opponent who defeated me】  \n![](https://cdn.luogu.com.cn/upload/pic/45538.png)  \n【Ah... if I really start counting, I can’t even finish counting...】  \n【So, it’s only natural that the first person I fell in love with was you】  \n![](https://cdn.luogu.com.cn/upload/pic/45539.png)  \n【At least you should have noticed something this small, you i-di-ot】  \n【I... what is wrong with me?】  \n【I remember I went back to the warehouse, and had a strange dream】  \n![](https://cdn.luogu.com.cn/upload/pic/45540.png)  \n【You didn’t come back for a long time...】  \n【What’s wrong, why are you making that face?】  \nWelcome back... Chtholly.  \n![](https://cdn.luogu.com.cn/upload/pic/45541.png)  \nWelcome back...  \n![](https://cdn.luogu.com.cn/upload/pic/45542.png)", "description": "Chtholly defines a *term* as a string formed by concatenating several ($\\ge 1$) digits ($0\\cdots 9$) (for example, `123` and `000` are valid terms, while `** *-1 +5` are invalid terms). A valid expression can be:\n\n- A term (e.g. `233`).\n- Two expressions connected by `+ - *` (e.g. `2*3+5*5`, `6-6*6`).\n- An expression with a pair of parentheses added to its left and right (e.g. (`2*3*3`)).\n\nNote: the empty string is not a valid expression.\n\nInitially, you are given a string of length $n$. Then $m$ operations are given. There are two types of operations:\n\n- `1 x y`: change the character at position $x$ to $y$.\n- `2 l r`: query the value of the substring $[l, r]$ as an expression modulo $\\bmod (10^9+7)$. If the substring is not a valid expression, the result is $-1$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains a string of length $n$.\n\nThe next $m$ lines each contain `1 x y` or `2 l r`, representing the two types of operations.", "outputFormat": "For every operation of type `2`, output one line containing one integer, which is the answer.", "hint": "Idea: mcfx, Solution: mcfx, Code: mcfx, Data: mcfx.\n\nConstraints: $1\\leq n, m \\leq 10^5$, $1 \\leq l \\leq r \\leq n$, $1 \\leq x \\leq n$.\n\nThe character set is `0 1 2 3 4 5 6 7 8 9 + - * ( )`.\n\nIf we treat `(` as $1$, `)` as $-1$, and other characters as $0$, then it is guaranteed that at any moment, for any prefix of the string, the absolute value of the prefix sum is at most $50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2014] 长存不灭的过去、逐渐消逝的未来", "background": "![](https://cdn.luogu.com.cn/upload/pic/45532.png)  \n【她遵守了约定哦...】  \n【从不可能存活的战场上】  \n【一心想着要见到技官...想要向技官撒娇...】  \n【才保留下了一点点寿命...平安回来了哦...】  \n没错...她遵守了约定...  \n可我却什么都没能和她说  \n什么都没能为她做  \n什么都...  \n![](https://cdn.luogu.com.cn/upload/pic/45534.png)  \n......  \n珂朵莉......  \n![](https://cdn.luogu.com.cn/upload/pic/45535.png)  \n以前我碰上他人的悲剧或是不幸这种无可奈何的事情时  \n总是设法想去改变什么  \n但是我的力量一直过于渺小...  \n![](https://cdn.luogu.com.cn/upload/pic/45536.png)  \n到最后什么忙都没帮上...  \n我应该已经有深切体会了才对...  \n我想让珂朵莉幸福...  \n真受不了那个家伙...  \n像我这样的男人，到底有什么地方能让她看上啊...  \n![](https://cdn.luogu.com.cn/upload/pic/45537.png)  \n【你连这点事情都想不明白吗？】  \n【因为你...是让我见识了许许多的第一次的人...】  \n【在露天摊贩街上，是你第一次救了我】  \n【是你第一次带我去视野开阔的地方眺望风景】  \n【是你让我第一次产生了各种各样的感情】  \n【你是第一个让我依赖的人，也是第一个将我击败的对手】  \n![](https://cdn.luogu.com.cn/upload/pic/45538.png)  \n【啊...真要数起来根本数不完...】  \n【所以，我第一个喜欢上的人是你，是理所当然的事情】  \n![](https://cdn.luogu.com.cn/upload/pic/45539.png)  \n【这点小事你好歹得察觉到啊，笨~蛋】  \n【我...究竟是怎么了？】  \n【我记得我回到仓库，做了奇怪的梦】  \n![](https://cdn.luogu.com.cn/upload/pic/45540.png)    \n【你久久不回来...】  \n【你怎么了，露出这种表情？】  \n欢迎回来...珂朵莉  \n![](https://cdn.luogu.com.cn/upload/pic/45541.png)  \n欢迎回来...  \n![](https://cdn.luogu.com.cn/upload/pic/45542.png)  ", "description": "珂朵莉定义项为指若干个（$\\ge1$）数字（$0\\cdots 9$）相连得到的字符串（如 `123` `000` 是合法的项，`** *-1 +5` 是不合法的项）。一个合法的表达式可以为一个项（如 `233`）、两个表达式以 `+ -*` 相连（如`2*3+5*5` `6-6*6`）、一个表达式在左右添一对括号（如 (`2*3*3`)）。\n\n注意：空串不是一个合法的表达式。\n\n在一开始，你会得到一个长为 $n$ 的字符串，之后会给定 $m$ 个操作。 有两种操作：\n\n`1 x y` 表示将位置 $x$ 的字符改成 $y$。\n\n`2 l r` 表示询问 $[l,r]$ 的字符串作为表达式求值在 $\\bmod (10^9+7)$ 意义下的结果。若该串不是一个合法的表达式，结果为 $-1$。", "inputFormat": "第一行有两个整数 $n,m$。\n\n第二行有一个长为 $n$ 的字符串。\n\n接下来 $m$ 行，每行为 `1 x y` 或 `2 l r`，分别表示两种操作。\n", "outputFormat": "对所有 $2$ 的操作，输出一行，包含一个整数，表示答案。", "hint": "Idea：mcfx，Solution：mcfx，Code：mcfx，Data：mcfx\n\n$1\\leq n,m \\leq 10^5$，$1 \\leq l\\leq r\\leq n$，$1\\leq x\\leq n$。\n\n字符集为 `0 1 2 3 4 5 6 7 8 9 + - * ( )`\n\n若将 `(` 作为 $1$，`)` 作为 $-1$，其他字符作为 $0$，则保证在任意时刻，该串的任意前缀和的绝对值不超过 $50$。  ", "locale": "zh-CN"}}}
{"pid": "P5068", "type": "P", "difficulty": 6, "samples": [["10 10\n2 7 9\n1 6\n2 7 10\n1 10\n1 7\n2 7 10\n1 7\n1 1\n2 6 7\n1 4", "3\n8\n11\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2015", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2015] 我回来了", "background": "我遵守了...  \n约...约定  \n![](https://cdn.luogu.com.cn/upload/pic/45543.png)  \n【你非常努力啊】  \n我非常非常努力哦...  \n![](https://cdn.luogu.com.cn/upload/pic/45545.png)  \n【虽然昨天也说过这句话了...】   \n【欢迎回来，珂朵莉】  \n![](https://cdn.luogu.com.cn/upload/pic/45546.png)  \n我回来了...  \n终于说出口了...  \n【是啊，我终于听见了】  \n红色的头发，会不会奇怪？  \n【很漂亮的颜色，和你很搭哦】   \n是吗...  \n我...我已经没事了  \n【真的吗？身体状况没问题吗？】   \n【要是硬撑的话，我可不会饶过你啊】  \n没事的，做饭啊洗衣服啊，还留着很多活要干呢   \n【可别太拼了哦】  \n![](https://cdn.luogu.com.cn/upload/pic/45547.png)  \n哼，你就做好心理准备等着吧  \n![](https://cdn.luogu.com.cn/upload/pic/45548.png)  ", "description": "珂朵莉在玩炉石传说的时候总是打不出教科书般的亵渎，于是他重新写了一个炉石传说’，并且将亵渎的描述改为：“等概率随机在 $[L,R]$ 中选出一个整数作为伤害值 $d$，对所有随从造成 $d$ 点伤害，如果有随从死亡，则再次施放该法术，但伤害值不重新随机；如果没有随从死亡，则停止释放”，还去掉了场面上随从上限和亵渎最多触发14次的限制。\n\n珂朵莉不知道这个改版亵渎的效果怎么样，于是他打算进行一些测试，其中共进行 $m$ 次如下类型的操作：\n\n1. 在场面上加入一个血量为 $h$ 的随从，这里随从的血量都不能超过 $n$；\n2. 给定 $L, R$，询问亵渎期望触发多少次；\n\n珂朵莉只会做操作1，于是他就把操作2交给你啦。", "inputFormat": "第一行两个由空格分隔的整数 $n\\;m$；\n\n接下来 $m$ 行，每行表示一次操作，操作1表示为 $1\\;h$，操作2表示为 $2\\;L\\;R$；\n", "outputFormat": "为避免输出小数，对每次操作2，输出一个整数表示期望值与 $(R-L+1)$ 的乘积。", "hint": "Idea：oscar，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，保证：\n$1\\le n\\le 10^5$，每次1操作有 $1\\le h\\le n$，每次2操作有 $1\\le L\\le R\\le n$；\n$1\\le m\\le 10^6$；\n以上所有数值均为整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi Easy Round 2015] 我回来了", "background": "我遵守了...  \n约...约定  \n![](https://cdn.luogu.com.cn/upload/pic/45543.png)  \n【你非常努力啊】  \n我非常非常努力哦...  \n![](https://cdn.luogu.com.cn/upload/pic/45545.png)  \n【虽然昨天也说过这句话了...】   \n【欢迎回来，珂朵莉】  \n![](https://cdn.luogu.com.cn/upload/pic/45546.png)  \n我回来了...  \n终于说出口了...  \n【是啊，我终于听见了】  \n红色的头发，会不会奇怪？  \n【很漂亮的颜色，和你很搭哦】   \n是吗...  \n我...我已经没事了  \n【真的吗？身体状况没问题吗？】   \n【要是硬撑的话，我可不会饶过你啊】  \n没事的，做饭啊洗衣服啊，还留着很多活要干呢   \n【可别太拼了哦】  \n![](https://cdn.luogu.com.cn/upload/pic/45547.png)  \n哼，你就做好心理准备等着吧  \n![](https://cdn.luogu.com.cn/upload/pic/45548.png)  ", "description": "珂朵莉在玩炉石传说的时候总是打不出教科书般的亵渎，于是他重新写了一个炉石传说’，并且将亵渎的描述改为：“等概率随机在 $[L,R]$ 中选出一个整数作为伤害值 $d$，对所有随从造成 $d$ 点伤害，如果有随从死亡，则再次施放该法术，但伤害值不重新随机；如果没有随从死亡，则停止释放”，还去掉了场面上随从上限和亵渎最多触发14次的限制。\n\n珂朵莉不知道这个改版亵渎的效果怎么样，于是他打算进行一些测试，其中共进行 $m$ 次如下类型的操作：\n\n1. 在场面上加入一个血量为 $h$ 的随从，这里随从的血量都不能超过 $n$；\n2. 给定 $L, R$，询问亵渎期望触发多少次；\n\n珂朵莉只会做操作1，于是他就把操作2交给你啦。", "inputFormat": "第一行两个由空格分隔的整数 $n\\;m$；\n\n接下来 $m$ 行，每行表示一次操作，操作1表示为 $1\\;h$，操作2表示为 $2\\;L\\;R$；\n", "outputFormat": "为避免输出小数，对每次操作2，输出一个整数表示期望值与 $(R-L+1)$ 的乘积。", "hint": "Idea：oscar，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，保证：\n$1\\le n\\le 10^5$，每次1操作有 $1\\le h\\le n$，每次2操作有 $1\\le L\\le R\\le n$；\n$1\\le m\\le 10^6$；\n以上所有数值均为整数。", "locale": "zh-CN"}}}
{"pid": "P5069", "type": "P", "difficulty": 6, "samples": [["4\n3\n6\n6\n4\n3\n4 4\n3 5\n1 8", "10\n10\n13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "线段树", "O2优化", "Ynoi", "STL"], "title": "[Ynoi Easy Round 2015] 纵使日薄西山", "background": "【你好像很开心嘛】  \n因为很少有机会和你单独出来走动嘛  \n应该说，好像以前一直没有吧？   \n【我们第一次见面的时候，不就一起逛过很多地方吗？】 \n![](https://cdn.luogu.com.cn/upload/pic/45549.png)  \n诶？啊...对  \n但是那个...总觉得和现在的感觉不太一样嘛  \n好吧，快点走吧！   \n【珂朵莉...】   \n![](https://cdn.luogu.com.cn/upload/pic/45550.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45551.png)  \n真是的，别发出那种像是快哭的声音啦，你是大人吧  \n我没事，你看  \n诶...  \n啊，这...这孩子也没事  \n![](https://cdn.luogu.com.cn/upload/pic/45552.png)  \n【要是出现什么意外，我...】  \n【我还以为自己又会在这么近的地方失去你...】   \n![](https://cdn.luogu.com.cn/upload/pic/45553.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45554.png)  \n红色头发的少女  \n在  \n看着这里  ", "description": "珂朵莉想让你维护一个长度为 $n$ 的正整数序列 $a_1,a_2,\\ldots,a_n$，支持修改序列中某个位置的值。\n\n每次修改后问对序列重复进行以下操作，需要进行几次操作才能使序列变为全 $0$（询问后序列和询问前相同，不会变为全 $0$）：\n\n选出序列中最大值的出现位置，若有多个最大值则选位置标号最小的一个，设位置为 $x$，则将 $a_{x-1},a_x,a_{x+1}$ 的值减 $1$，如果序列中存在小于 $0$ 的数，则把对应的数改为 $0$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个整数 $a_i$。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个用空格分隔的整数 $x_i,y_i$，表示把 $a_{x_i}$ 修改为 $y_i$。  \n", "outputFormat": "$q$ 行，每行一个整数表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n$1\\leq n,q\\leq 10^5$，$1\\leq x_i\\leq n$，$1\\leq a_i,y_i\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] Even as the Sun Sets in the West", "background": "【You seem very happy.】  \nBecause I rarely get a chance to go out alone with you.  \nOr rather, it seems like we never really had before, right?  \n【Didn’t we go to lots of places together when we first met?】  \n![](https://cdn.luogu.com.cn/upload/pic/45549.png)  \nHuh? Ah... right.  \nBut, well... it just feels kind of different from now.  \nAlright, hurry up, let’s go!  \n【Chtholly...】  \n![](https://cdn.luogu.com.cn/upload/pic/45550.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45551.png)  \nSeriously, don’t make a sound like you’re about to cry. You’re an adult, aren’t you?  \nI’m fine, look.  \nEh...  \nAh, th-this kid is also fine.  \n![](https://cdn.luogu.com.cn/upload/pic/45552.png)  \n【If anything unexpected happens, I...】  \n【I thought I would lose you again, this close...】  \n![](https://cdn.luogu.com.cn/upload/pic/45553.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45554.png)  \nA red-haired girl.  \nIs  \nWatching here.", "description": "Chtholly wants you to maintain a positive integer sequence of length $n$, $a_1,a_2,\\ldots,a_n$, supporting updates that modify the value at some position.\n\nAfter each update, you are asked: if we repeatedly perform the following operation on the sequence, how many operations are needed to make the sequence become all $0$ (after the query, the sequence is the same as before the query; it will not actually become all $0$)?\n\nChoose a position where the maximum value in the sequence occurs. If there are multiple maximum values, choose the one with the smallest index. Let the position be $x$. Then decrease $a_{x-1},a_x,a_{x+1}$ by $1$. If there exists a number less than $0$ in the sequence, change that number to $0$.", "inputFormat": "The first line contains an integer $n$.\n\nThe next $n$ lines each contain one integer $a_i$.\n\nThe next line contains an integer $q$.\n\nThe next $q$ lines each contain two integers $x_i,y_i$ separated by a space, meaning to modify $a_{x_i}$ to $y_i$.", "outputFormat": "Output $q$ lines, each containing one integer representing the answer.", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078\n\nConstraints: $1\\leq n,q\\leq 10^5$, $1\\leq x_i\\leq n$, $1\\leq a_i,y_i\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 纵使日薄西山", "background": "【你好像很开心嘛】  \n因为很少有机会和你单独出来走动嘛  \n应该说，好像以前一直没有吧？   \n【我们第一次见面的时候，不就一起逛过很多地方吗？】 \n![](https://cdn.luogu.com.cn/upload/pic/45549.png)  \n诶？啊...对  \n但是那个...总觉得和现在的感觉不太一样嘛  \n好吧，快点走吧！   \n【珂朵莉...】   \n![](https://cdn.luogu.com.cn/upload/pic/45550.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45551.png)  \n真是的，别发出那种像是快哭的声音啦，你是大人吧  \n我没事，你看  \n诶...  \n啊，这...这孩子也没事  \n![](https://cdn.luogu.com.cn/upload/pic/45552.png)  \n【要是出现什么意外，我...】  \n【我还以为自己又会在这么近的地方失去你...】   \n![](https://cdn.luogu.com.cn/upload/pic/45553.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45554.png)  \n红色头发的少女  \n在  \n看着这里  ", "description": "珂朵莉想让你维护一个长度为 $n$ 的正整数序列 $a_1,a_2,\\ldots,a_n$，支持修改序列中某个位置的值。\n\n每次修改后问对序列重复进行以下操作，需要进行几次操作才能使序列变为全 $0$（询问后序列和询问前相同，不会变为全 $0$）：\n\n选出序列中最大值的出现位置，若有多个最大值则选位置标号最小的一个，设位置为 $x$，则将 $a_{x-1},a_x,a_{x+1}$ 的值减 $1$，如果序列中存在小于 $0$ 的数，则把对应的数改为 $0$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个整数 $a_i$。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个用空格分隔的整数 $x_i,y_i$，表示把 $a_{x_i}$ 修改为 $y_i$。  \n", "outputFormat": "$q$ 行，每行一个整数表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n$1\\leq n,q\\leq 10^5$，$1\\leq x_i\\leq n$，$1\\leq a_i,y_i\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5070", "type": "P", "difficulty": 6, "samples": [["8 9\n2 3 3 3 3 6 6 6\n1 8\n2 3\n4 5\n6 8\n1 2\n3 4\n5 6\n3 8\n5 5", "1100000000\n1000000000\n1000000000\n1000000000\n0100000000\n1000000000\n2000000000\n2000000000\n1000000000"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2015] 即便看不到未来", "background": "![](https://cdn.luogu.com.cn/upload/pic/45556.png)  \n我不会再闷闷不乐了  \n那撕裂胸口的悲伤  \n还有快流下来的眼泪  \n全都是塑造出现在的我的东西  \n![](https://cdn.luogu.com.cn/upload/pic/45557.png)  \n烦恼  \n灰心  \n痛苦  \n喜悦  \n全部不可或缺  \n现在站在这里的不是别人  \n![](https://cdn.luogu.com.cn/upload/pic/45558.png)  \n毫无疑问是我自己，是珂朵莉   \n对，至少现在如此  \n![](https://cdn.luogu.com.cn/upload/pic/45559.png)  \n记忆慢慢地缺失  \n人格在逐渐崩坏   \n抱歉  \n你们当中   \n已经有一半的人我不记得了...   \n忘记的名字还可以重新记住  \n但是失去的记忆却无可挽回   \n这个将要崩坏的自己，还能被称作珂朵莉吗...？  \n![](https://cdn.luogu.com.cn/upload/pic/45560.png)  \n可即便这样的感情，我也想要毫无保留地去珍惜   \n因为如果连这种感情都失去的时候  \n我大概就会...彻底消失吧   ", "description": "珂朵莉给了你一个序列，每次查询一段区间中长度为 $1,2,\\ldots,10$ 的极长值域连续段个数。\n定义值域连续段为：\n\n* 把区间里面所有数排序后去重，设排序后得到的序列为 $b$。\n* 如果对于二元组 $(l,r)$ 满足 $b_l,b_{l+1},\\ldots,b_r$ 中每个数为前一个数 $+1$。\n* 而且对于二元组 $(l,r+1)$，$(l-1,r)$ 均不满足，我们称 $(l,r)$ 为一个长度为 $r-l+1$ 的极长值域连续段。", "inputFormat": "第一行两个整数 $n,m$，表示序列的长度和查询的次数。\n\n之后一行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行每行两个整数 $l,r$ 表示查询的区间。\n", "outputFormat": "对于每次询问，输出一个长度为 $10$ 的字符串，第 $i$ 个字符表示长度为 $i$ 的极长连续段个数 $\\bmod 10$的结果。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：mcfx，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq10^6$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] Even If I Cannot See the Future", "background": "![](https://cdn.luogu.com.cn/upload/pic/45556.png)  \nI will not be depressed anymore.  \nThat sadness that tears open my chest,  \nand the tears that are about to fall,  \nare all things that shaped who I am now.  \n![](https://cdn.luogu.com.cn/upload/pic/45557.png)  \nWorries,  \ndiscouragement,  \npain,  \njoy,  \nnone of them can be missing.  \nThe one standing here now is not someone else.  \n![](https://cdn.luogu.com.cn/upload/pic/45558.png)  \nWithout a doubt, it is me myself, it is Ke Duoli (pinyin: Kē Duō Lí).  \nYes, at least for now.  \n![](https://cdn.luogu.com.cn/upload/pic/45559.png)  \nMy memories are slowly disappearing,  \nand my personality is gradually falling apart.  \nSorry.  \nAmong you,  \nthere are already half of you that I cannot remember...  \nForgotten names can be remembered again,  \nbut lost memories can never be recovered.  \nCan this self that is about to collapse still be called Ke Duoli...?  \n![](https://cdn.luogu.com.cn/upload/pic/45560.png)  \nBut even with feelings like this, I still want to cherish them without holding anything back.  \nBecause if I lose even this kind of feeling,  \nI will probably... disappear completely.", "description": "Ke Duoli gives you a sequence. For each query, you need to count, in a given interval, the number of maximal consecutive value-range segments of lengths $1,2,\\ldots,10$.\n\nA consecutive value-range segment is defined as follows:\n\n* Sort all numbers in the interval and remove duplicates. Let the resulting sequence be $b$.\n* For a pair $(l,r)$, if every number in $b_l,b_{l+1},\\ldots,b_r$ is equal to the previous number $+1$.\n* And for the pairs $(l,r+1)$ and $(l-1,r)$, neither satisfies the condition above, then we call $(l,r)$ a maximal consecutive value-range segment, with length $r-l+1$.", "inputFormat": "The first line contains two integers $n,m$, representing the length of the sequence and the number of queries.\n\nThe next line contains $n$ integers representing the sequence.\n\nThen follow $m$ lines, each containing two integers $l,r$, representing the query interval.", "outputFormat": "For each query, output a string of length $10$. The $i$-th character represents the number of maximal consecutive segments of length $i$ modulo $10$.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: mcfx, Data: nzhtl1477.\n\nFor $100\\%$ of the testdata, $1\\leq n,m,a_i\\leq10^6$, $1\\leq l\\leq r\\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 即便看不到未来", "background": "![](https://cdn.luogu.com.cn/upload/pic/45556.png)  \n我不会再闷闷不乐了  \n那撕裂胸口的悲伤  \n还有快流下来的眼泪  \n全都是塑造出现在的我的东西  \n![](https://cdn.luogu.com.cn/upload/pic/45557.png)  \n烦恼  \n灰心  \n痛苦  \n喜悦  \n全部不可或缺  \n现在站在这里的不是别人  \n![](https://cdn.luogu.com.cn/upload/pic/45558.png)  \n毫无疑问是我自己，是珂朵莉   \n对，至少现在如此  \n![](https://cdn.luogu.com.cn/upload/pic/45559.png)  \n记忆慢慢地缺失  \n人格在逐渐崩坏   \n抱歉  \n你们当中   \n已经有一半的人我不记得了...   \n忘记的名字还可以重新记住  \n但是失去的记忆却无可挽回   \n这个将要崩坏的自己，还能被称作珂朵莉吗...？  \n![](https://cdn.luogu.com.cn/upload/pic/45560.png)  \n可即便这样的感情，我也想要毫无保留地去珍惜   \n因为如果连这种感情都失去的时候  \n我大概就会...彻底消失吧   ", "description": "珂朵莉给了你一个序列，每次查询一段区间中长度为 $1,2,\\ldots,10$ 的极长值域连续段个数。\n定义值域连续段为：\n\n* 把区间里面所有数排序后去重，设排序后得到的序列为 $b$。\n* 如果对于二元组 $(l,r)$ 满足 $b_l,b_{l+1},\\ldots,b_r$ 中每个数为前一个数 $+1$。\n* 而且对于二元组 $(l,r+1)$，$(l-1,r)$ 均不满足，我们称 $(l,r)$ 为一个长度为 $r-l+1$ 的极长值域连续段。", "inputFormat": "第一行两个整数 $n,m$，表示序列的长度和查询的次数。\n\n之后一行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行每行两个整数 $l,r$ 表示查询的区间。\n", "outputFormat": "对于每次询问，输出一个长度为 $10$ 的字符串，第 $i$ 个字符表示长度为 $i$ 的极长连续段个数 $\\bmod 10$的结果。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：mcfx，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq10^6$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5071", "type": "P", "difficulty": 6, "samples": [["5 5\n64 2 18 9 100\n1 5\n2 4\n2 3\n1 4\n3 4", "165\n15\n9\n45\n10"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "莫队", "O2优化", "素数判断,质数,筛法", "Ynoi"], "title": "[Ynoi Easy Round 2015] 此时此刻的光辉", "background": "难道说...  \n这么说来...给珂朵莉她们...  \n正给珂朵莉带来痛苦的是...  \n![](https://cdn.luogu.com.cn/upload/pic/45561.png)  \n【威廉？】  \n【威廉，说真的，你到底怎么了？】  \n【出什么事了？】  \n【啊...】 \n![](https://cdn.luogu.com.cn/upload/pic/45562.png)   \n你不慌张吗  \n【别看我这样，其实我心脏确实有在猛跳】  \n【但是呢，虽然我不知道发生了什么事】  \n![](https://cdn.luogu.com.cn/upload/pic/45563.png)  \n【可一直爱逞强的你，难得会对我露出软弱的一面嘛~】   \n【高兴的心情，还有希望你打起精神的心情加在一起】  \n【要远远胜过惊慌的情绪】  \n![](https://cdn.luogu.com.cn/upload/pic/45564.png)  \n你...  \n【你刚才，流露着一副要是没人管你就会自己消失的表情哦？】  \n【虽然非常难为情，但我实在不能撇下你】  \n![](https://cdn.luogu.com.cn/upload/pic/45565.png)  \n你是个...好女人啊...  \n![](https://cdn.luogu.com.cn/upload/pic/45567.png)  \n【抱歉，我没有听清楚，再说一遍】  \n没什么啦...  \n![](https://cdn.luogu.com.cn/upload/pic/45568.png)  \n【啊...你还死撑】  \n【再说一遍，再说一遍就好】  \n和我结婚吧  \n![](https://cdn.luogu.com.cn/upload/pic/45569.png)  \n【不对...嗯？】  \n我终于找到了  \n找到了渴望去保护的人  \n找到了渴望回去的归宿  \n觉得自己还可以继续生存下去  \n总算真切地认识到自己还有继续生存的价值和资格  \n所以...  \n我要给你幸福  \n![](https://cdn.luogu.com.cn/upload/pic/45570.png)  \n【嗯】  \n【我也不会离开你身边的】  \n【永远，永远和你在一起哦】   ", "description": "珂朵莉给你了一个长为 $n$ 的序列，有 $m$ 次查询，每次查询一段区间的乘积的约数个数 $\\bmod 19260817$ 的值。", "inputFormat": "第一行两个整数 $n,m$。  \n\n第二行 $n$ 个整数表示这个序列 $a_i$。\n\n之后 $m$ 行，每行两个整数 $l,r$ 表示查询的区间  \n", "outputFormat": "$m$ 行，每行输出一个整数表示答案", "hint": "Idea：will7101，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n$1\\leq n,m\\leq 10^5$，$1 \\leq a_i \\leq10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] The Glory of This Moment", "background": "Could it be...  \nSo that means... for Chtholly and the others...  \nWhat is bringing Chtholly pain is...  \n![](https://cdn.luogu.com.cn/upload/pic/45561.png)  \n【William?】  \n【William, seriously, what happened to you?】  \n【What’s wrong?】  \n【Ah...】  \n![](https://cdn.luogu.com.cn/upload/pic/45562.png)  \nAren’t you panicking?  \n【Don’t be fooled by how I look, my heart is indeed pounding】  \n【But, even though I don’t know what happened】  \n![](https://cdn.luogu.com.cn/upload/pic/45563.png)  \n【You, who always like to act tough, are finally showing me a weak side for once~】  \n【The happiness, and the feeling of wanting you to cheer up, added together】  \n【Far outweigh the feeling of panic】  \n![](https://cdn.luogu.com.cn/upload/pic/45564.png)  \nYou...  \n【Just now, you had this look like you’d disappear by yourself if nobody cared about you, you know?】  \n【Although it’s very embarrassing, I really can’t just leave you alone】  \n![](https://cdn.luogu.com.cn/upload/pic/45565.png)  \nYou are... a good woman...  \n![](https://cdn.luogu.com.cn/upload/pic/45567.png)  \n【Sorry, I didn’t hear clearly. Say that again.】  \nIt’s nothing...  \n![](https://cdn.luogu.com.cn/upload/pic/45568.png)  \n【Ah... you’re still forcing yourself】  \n【Say it again. Just say it again.】  \nMarry me.  \n![](https://cdn.luogu.com.cn/upload/pic/45569.png)  \n【No... huh?】  \nI finally found it.  \nI found someone I long to protect.  \nI found a home I long to return to.  \nI feel like I can keep living.  \nAt last, I truly realized that I still have the value and the right to keep living.  \nSo...  \nI will give you happiness.  \n![](https://cdn.luogu.com.cn/upload/pic/45570.png)  \n【Mm.】  \n【I won’t leave your side either.】  \n【Forever, forever, I’ll be with you.】", "description": "Chtholly gives you a sequence of length $n$. There are $m$ queries. For each query, you need to compute the number of divisors of the product of a subarray, taken $\\bmod 19260817$.", "inputFormat": "The first line contains two integers $n, m$.  \n\nThe second line contains $n$ integers, representing the sequence $a_i$.  \n\nThen follow $m$ lines, each containing two integers $l, r$, representing the queried interval.", "outputFormat": "Output $m$ lines. Each line contains one integer, the answer to the corresponding query.", "hint": "Idea: will7101, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.  \n\nConstraints: $1 \\leq n, m \\leq 10^5$, $1 \\leq a_i \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 此时此刻的光辉", "background": "难道说...  \n这么说来...给珂朵莉她们...  \n正给珂朵莉带来痛苦的是...  \n![](https://cdn.luogu.com.cn/upload/pic/45561.png)  \n【威廉？】  \n【威廉，说真的，你到底怎么了？】  \n【出什么事了？】  \n【啊...】 \n![](https://cdn.luogu.com.cn/upload/pic/45562.png)   \n你不慌张吗  \n【别看我这样，其实我心脏确实有在猛跳】  \n【但是呢，虽然我不知道发生了什么事】  \n![](https://cdn.luogu.com.cn/upload/pic/45563.png)  \n【可一直爱逞强的你，难得会对我露出软弱的一面嘛~】   \n【高兴的心情，还有希望你打起精神的心情加在一起】  \n【要远远胜过惊慌的情绪】  \n![](https://cdn.luogu.com.cn/upload/pic/45564.png)  \n你...  \n【你刚才，流露着一副要是没人管你就会自己消失的表情哦？】  \n【虽然非常难为情，但我实在不能撇下你】  \n![](https://cdn.luogu.com.cn/upload/pic/45565.png)  \n你是个...好女人啊...  \n![](https://cdn.luogu.com.cn/upload/pic/45567.png)  \n【抱歉，我没有听清楚，再说一遍】  \n没什么啦...  \n![](https://cdn.luogu.com.cn/upload/pic/45568.png)  \n【啊...你还死撑】  \n【再说一遍，再说一遍就好】  \n和我结婚吧  \n![](https://cdn.luogu.com.cn/upload/pic/45569.png)  \n【不对...嗯？】  \n我终于找到了  \n找到了渴望去保护的人  \n找到了渴望回去的归宿  \n觉得自己还可以继续生存下去  \n总算真切地认识到自己还有继续生存的价值和资格  \n所以...  \n我要给你幸福  \n![](https://cdn.luogu.com.cn/upload/pic/45570.png)  \n【嗯】  \n【我也不会离开你身边的】  \n【永远，永远和你在一起哦】   ", "description": "珂朵莉给你了一个长为 $n$ 的序列，有 $m$ 次查询，每次查询一段区间的乘积的约数个数 $\\bmod 19260817$ 的值。", "inputFormat": "第一行两个整数 $n,m$。  \n\n第二行 $n$ 个整数表示这个序列 $a_i$。\n\n之后 $m$ 行，每行两个整数 $l,r$ 表示查询的区间  \n", "outputFormat": "$m$ 行，每行输出一个整数表示答案", "hint": "Idea：will7101，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n$1\\leq n,m\\leq 10^5$，$1 \\leq a_i \\leq10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P5072", "type": "P", "difficulty": 6, "samples": [["5 5\n1 2 2 3 4\n1 2 233333\n2 3 333333\n1 5 5\n3 5 15\n2 4 8", "6\n6\n1\n6\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "莫队", "O2优化", "分块", "Ynoi", "链表"], "title": "[Ynoi Easy Round 2015] 盼君勿忘", "background": "说起来，幸福本身就是因人而异的  \n有些人认为只要能混口饭吃就行了  \n有些人只要有书读就能满足  \n![](https://cdn.luogu.com.cn/upload/pic/45571.png)  \n有些人认为只有全力地生存才是最重要的  \n有些人只要得到克服某种目标的瞬间就能满足  \n有些人只要某个人得到幸福，自己就会跟着幸福  \n也有些人则令人伤透脑筋地刚好相反  \n![](https://cdn.luogu.com.cn/upload/pic/45572.png)\n但是，大部分人都没有自觉  \n他们不知道究竟什么能给自己带来幸福  \n但是，他们会异口同声地表示想要获得幸福  \n那样的人即使能察觉到幸福  \n也没办法变得幸福  \n最重要的是要敢于正视自己的内心  \n![](https://cdn.luogu.com.cn/upload/pic/45573.png)  \n【珂朵莉已经基本上不剩什么了】  \n![](https://cdn.luogu.com.cn/upload/pic/45574.png)  \n【心灵和身体，珂朵莉基本上快要全部失去了】  \n![](https://cdn.luogu.com.cn/upload/pic/45575.png)  \n【全部被我替换了】  \n![](https://cdn.luogu.com.cn/upload/pic/45576.png)  \n【幸好你在失去一切之前，回到了这里】  \n【喜悦和悲伤】  \n【还有喜欢某个人的情绪】  \n【现在依旧还残存着一些吧？】  \n嗯...  \n确实还有那么一丝...  \n【那就没问题了】  \n【珂朵莉你，依旧是珂朵莉】  \n![](https://cdn.luogu.com.cn/upload/pic/45578.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45579.png)  \n威...廉...？   \n![](https://cdn.luogu.com.cn/upload/pic/45580.png)  \n", "description": "珂朵莉给了你一个序列，每次查询一个区间 $[l,r]$ 中所有子序列分别去重后的和 $\\bmod\\ p$。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行三个整数 $l,r,p$ 表示查询的区间与模数。\n", "outputFormat": "$m$ 行，每行输出一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i \\leq 10^5$，$1\\leq p\\leq 10^9$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] Please Do Not Forget", "background": "Generally speaking, happiness itself differs from person to person.  \nSome people think it is enough as long as they can get something to eat.  \nSome people are satisfied as long as they can read books.  \n![](https://cdn.luogu.com.cn/upload/pic/45571.png)  \nSome people think that surviving with all their strength is the most important thing.  \nSome people are satisfied the moment they overcome some goal.  \nSome people feel happy as long as someone else becomes happy, and they become happy along with them.  \nAnd there are also people who are, to make you rack your brain, exactly the opposite.  \n![](https://cdn.luogu.com.cn/upload/pic/45572.png)  \nHowever, most people are not aware of themselves.  \nThey do not know what exactly can bring them happiness.  \nBut they will say in unison that they want to obtain happiness.  \nEven if such people can notice happiness,  \nthey still cannot become happy.  \nThe most important thing is to dare to face your own heart directly.  \n![](https://cdn.luogu.com.cn/upload/pic/45573.png)  \n【Chtholly basically has almost nothing left】  \n![](https://cdn.luogu.com.cn/upload/pic/45574.png)  \n【In mind and body, Chtholly has basically almost lost everything】  \n![](https://cdn.luogu.com.cn/upload/pic/45575.png)  \n【I replaced all of it】  \n![](https://cdn.luogu.com.cn/upload/pic/45576.png)  \n【Luckily, before you lost everything, you came back here】  \n【Joy and sorrow】  \n【And the feeling of liking someone】  \n【There are still some of them left now, right?】  \nMm...  \nThere is indeed just a little bit left...  \n【Then there is no problem】  \n【Chtholly, you are still Chtholly】  \n![](https://cdn.luogu.com.cn/upload/pic/45578.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45579.png)  \nWi... llem...?  \n![](https://cdn.luogu.com.cn/upload/pic/45580.png)", "description": "Chtholly gives you a sequence. For each query, compute the sum of all subsequences in the interval $[l,r]$ after removing duplicates within each subsequence, and output the result $\\bmod\\ p$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers representing the sequence.\n\nThen follow $m$ lines, each containing three integers $l,r,p$, describing the queried interval and the modulus.", "outputFormat": "Output $m$ lines. Each line contains one integer, the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nConstraints: For $100\\%$ of the testdata, $1\\leq n,m,a_i \\leq 10^5$, $1\\leq p\\leq 10^9$, $1\\leq l\\leq r\\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 盼君勿忘", "background": "说起来，幸福本身就是因人而异的  \n有些人认为只要能混口饭吃就行了  \n有些人只要有书读就能满足  \n![](https://cdn.luogu.com.cn/upload/pic/45571.png)  \n有些人认为只有全力地生存才是最重要的  \n有些人只要得到克服某种目标的瞬间就能满足  \n有些人只要某个人得到幸福，自己就会跟着幸福  \n也有些人则令人伤透脑筋地刚好相反  \n![](https://cdn.luogu.com.cn/upload/pic/45572.png)\n但是，大部分人都没有自觉  \n他们不知道究竟什么能给自己带来幸福  \n但是，他们会异口同声地表示想要获得幸福  \n那样的人即使能察觉到幸福  \n也没办法变得幸福  \n最重要的是要敢于正视自己的内心  \n![](https://cdn.luogu.com.cn/upload/pic/45573.png)  \n【珂朵莉已经基本上不剩什么了】  \n![](https://cdn.luogu.com.cn/upload/pic/45574.png)  \n【心灵和身体，珂朵莉基本上快要全部失去了】  \n![](https://cdn.luogu.com.cn/upload/pic/45575.png)  \n【全部被我替换了】  \n![](https://cdn.luogu.com.cn/upload/pic/45576.png)  \n【幸好你在失去一切之前，回到了这里】  \n【喜悦和悲伤】  \n【还有喜欢某个人的情绪】  \n【现在依旧还残存着一些吧？】  \n嗯...  \n确实还有那么一丝...  \n【那就没问题了】  \n【珂朵莉你，依旧是珂朵莉】  \n![](https://cdn.luogu.com.cn/upload/pic/45578.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45579.png)  \n威...廉...？   \n![](https://cdn.luogu.com.cn/upload/pic/45580.png)  \n", "description": "珂朵莉给了你一个序列，每次查询一个区间 $[l,r]$ 中所有子序列分别去重后的和 $\\bmod\\ p$。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行三个整数 $l,r,p$ 表示查询的区间与模数。\n", "outputFormat": "$m$ 行，每行输出一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i \\leq 10^5$，$1\\leq p\\leq 10^9$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5073", "type": "P", "difficulty": 7, "samples": [["5 7\n-10 -3 -2 -4 -5\n2 2 4\n1 5\n2 2 4\n1 3\n2 1 5\n1 2\n2 3 5", "0\n6\n18\n19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2015", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2015] 世上最幸福的女孩", "background": "我有一个请求  \n最后的请求  \n我感觉自己好像跟他有过约定  \n说好了那个人以后不必再战斗  \n说好了那个人的战斗全部由我来继承   \n而且我还有话想对他说，所以拜托你了  \n![](https://cdn.luogu.com.cn/upload/pic/45581.png)  \n【无论如何都要？】  \n嗯，无论如何都要  \n【但是，如果再来一次，珂朵莉就会彻底消失了哦？】  \n【不光是回忆，包括那所有珍贵的情感】  \n【全都会彻底消失的哦！？】  \n那还挺让人受不了的呢  \n但是呢，比起消失，我更加讨厌就这么结束啊  \n【珂朵莉...】  \n所以，拜托你了  \n让我再一次，回到那个地方吧   \n![](https://cdn.luogu.com.cn/upload/pic/45582.png)  \n“珂朵莉，加油”  \n![](https://cdn.luogu.com.cn/upload/pic/45583.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45584.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45585.png)  \n威廉…  \n谢谢你…", "description": "在最后的最后，珂朵莉给了你一个长为 $n$ 的序列，有 $m$ 个操作：\n\n1. 全局加（即序列的所有数加）。\n2. 查询区间最大子段和。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个数表示这个序列。\n\n之后 $m$ 行，每行一个操作。\n\n* $1\\ x$ : 所有数都加上 $x$。\n* $2\\ l\\ r$ : 查询区间 $[l,r]$ 内的最大子段和（可以不选数，此时最大子段和是 $0$）。", "outputFormat": "对于每个询问，输出一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：nzhtl1477&w33z8kqrqk8zzzx33，Data：nzhtl1477\n\n$1\\leq n \\leq 3\\times 10^5$，$1 \\leq m \\leq 6\\times 10^5$，序列中的数绝对值 $\\leq 2\\times 10^9$，$1$ 操作中的 $x$ 的绝对值 $\\leq 5\\times 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] The Happiest Girl in the World.", "background": "I have a request.  \nThe final request.  \nI feel like I once made a promise with him.  \nWe agreed that person would not have to fight anymore in the future.  \nWe agreed that I would inherit all of that person’s battles.  \nAnd I still have something I want to say to him, so please.  \n![](https://cdn.luogu.com.cn/upload/pic/45581.png)  \n【No matter what, you must?】  \nYes, no matter what.  \n【But if you do it again, Ctholly will disappear completely.】  \n【Not only the memories, but also all those precious feelings.】  \n【All of them will disappear completely!?】  \nThat would be pretty unbearable.  \nBut compared to disappearing, I hate even more that it ends like this.  \n【Ctholly...】  \nSo, please.  \nLet me return to that place once again.  \n![](https://cdn.luogu.com.cn/upload/pic/45582.png)  \n“Ctholly, you can do it.”  \n![](https://cdn.luogu.com.cn/upload/pic/45583.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45584.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45585.png)  \nWillem...  \nThank you...", "description": "At the very end, Ctholly gives you a sequence of length $n$, with $m$ operations:\n\n1. Global add (i.e., add to all numbers in the sequence).\n2. Query the maximum subarray sum in an interval.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ numbers representing the sequence.\n\nThen follow $m$ lines, each describing one operation.\n\n* $1\\ x$ : Add $x$ to all numbers.\n* $2\\ l\\ r$ : Query the maximum subarray sum in the interval $[l,r]$ (you may choose no elements; in this case the maximum subarray sum is $0$).", "outputFormat": "For each query, output one number as the answer.", "hint": "Idea: nzhtl1477, Solution: ccz181078, Code: nzhtl1477&w33z8kqrqk8zzzx33, Data: nzhtl1477.\n\nConstraints: $1\\leq n \\leq 3\\times 10^5$, $1 \\leq m \\leq 6\\times 10^5$, the absolute value of numbers in the sequence $\\leq 2\\times 10^9$, and the absolute value of $x$ in operation $1$ is $\\leq 5\\times 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 世上最幸福的女孩", "background": "我有一个请求  \n最后的请求  \n我感觉自己好像跟他有过约定  \n说好了那个人以后不必再战斗  \n说好了那个人的战斗全部由我来继承   \n而且我还有话想对他说，所以拜托你了  \n![](https://cdn.luogu.com.cn/upload/pic/45581.png)  \n【无论如何都要？】  \n嗯，无论如何都要  \n【但是，如果再来一次，珂朵莉就会彻底消失了哦？】  \n【不光是回忆，包括那所有珍贵的情感】  \n【全都会彻底消失的哦！？】  \n那还挺让人受不了的呢  \n但是呢，比起消失，我更加讨厌就这么结束啊  \n【珂朵莉...】  \n所以，拜托你了  \n让我再一次，回到那个地方吧   \n![](https://cdn.luogu.com.cn/upload/pic/45582.png)  \n“珂朵莉，加油”  \n![](https://cdn.luogu.com.cn/upload/pic/45583.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45584.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45585.png)  \n威廉…  \n谢谢你…", "description": "在最后的最后，珂朵莉给了你一个长为 $n$ 的序列，有 $m$ 个操作：\n\n1. 全局加（即序列的所有数加）。\n2. 查询区间最大子段和。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个数表示这个序列。\n\n之后 $m$ 行，每行一个操作。\n\n* $1\\ x$ : 所有数都加上 $x$。\n* $2\\ l\\ r$ : 查询区间 $[l,r]$ 内的最大子段和（可以不选数，此时最大子段和是 $0$）。", "outputFormat": "对于每个询问，输出一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：nzhtl1477&w33z8kqrqk8zzzx33，Data：nzhtl1477\n\n$1\\leq n \\leq 3\\times 10^5$，$1 \\leq m \\leq 6\\times 10^5$，序列中的数绝对值 $\\leq 2\\times 10^9$，$1$ 操作中的 $x$ 的绝对值 $\\leq 5\\times 10^7$。", "locale": "zh-CN"}}}
{"pid": "P5074", "type": "P", "difficulty": 6, "samples": [["2\n6 3\n1 1 1\n1 0 1\n1 1 1\n1 1 1\n1 0 1\n1 1 1\n2 4\n1 1 1 1\n1 1 1 1", "3\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "轮廓线 DP"], "title": "Eat the Trees", "background": "HDU1693：Eat the Trees", "description": "给出 $n \\times m$ 的方格，有些格子不能铺线，其它格子必须铺，可以形成多个闭合回路。问有多少种铺法？", "inputFormat": "每个测试点多组数据。第一行一个正整数 $T$，表示有 $T$ 组数据。\n\n对于每组数据：\n\n第 $1$ 行，两个整数 $n,m\\ (2 \\le n,m \\le 12)$。\n\n从第 $2$ 行到第 $n+1$ 行，每行 $m$ 个数字（$1$ 或者 $0$），$1$ 表铺线，$0$ 表不铺线。", "outputFormat": "每组数据输出一个整数，表示方案数。保证答案小于 $2^{63}$。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "Eat the Trees", "background": "HDU1693: Eat the Trees", "description": "Given an $n \\times m$ grid, some cells cannot be filled with lines, and all other cells must be filled. Multiple closed loops can be formed. Ask how many different ways there are to fill the grid?", "inputFormat": "Multiple test cases per input file. The first line contains a positive integer $T$, meaning there are $T$ test cases.\n\nFor each test case:\n\nLine $1$: two integers $n, m\\ (2 \\le n, m \\le 12)$.\n\nLines $2$ to $n + 1$: each line contains $m$ digits ($1$ or $0$). $1$ means this cell must be filled with lines, and $0$ means this cell is not filled with lines.", "outputFormat": "For each test case, output one integer, representing the number of valid ways. It is guaranteed that the answer is less than $2^{63}$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Eat the Trees", "background": "HDU1693：Eat the Trees", "description": "给出 $n \\times m$ 的方格，有些格子不能铺线，其它格子必须铺，可以形成多个闭合回路。问有多少种铺法？", "inputFormat": "每个测试点多组数据。第一行一个正整数 $T$，表示有 $T$ 组数据。\n\n对于每组数据：\n\n第 $1$ 行，两个整数 $n,m\\ (2 \\le n,m \\le 12)$。\n\n从第 $2$ 行到第 $n+1$ 行，每行 $m$ 个数字（$1$ 或者 $0$），$1$ 表铺线，$0$ 表不铺线。", "outputFormat": "每组数据输出一个整数，表示方案数。保证答案小于 $2^{63}$。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5075", "type": "P", "difficulty": 7, "samples": [["4 100\n4\n1\n0\n0\n", "63\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2012", "各省省选", "江苏", "O2优化", "快速傅里叶变换 FFT"], "title": "[JSOI2012] 分零食", "background": "", "description": "这里是欢乐的进香河，这里是欢乐的幼儿园。\n\n今天是 2 月 14 日，星期二。在这个特殊的日子里，老师带着同学们欢乐地跳着，笑着。校长从幼儿园旁边的小吃店买了大量的零食决定分给同学们。听到这个消息，所有同学都安安静静地排好了队，大家都知道，校长不喜欢调皮的孩子。\n\n同学们依次排成了一列，其中有 $A$ 位小朋友，有三个共同的欢乐系数 $O$，$S$ 和 $U$。如果有一位小朋友得到了 $x$ 个糖果，那么她的欢乐程度就是 $f(x)=Ox^2+Sx+U$。\n\n现在校长开始分糖果了，一共有 $M$ 个糖果。有些小朋友可能得不到糖果，对于那些得不到糖果的小朋友来说，欢乐程度就是 $1$。如果一位小朋友得不到糖果，那么在她身后的小朋友们也都得不到糖果（即这一列得不到糖果的小朋友一定是最后的连续若干位）。\n\n所有分糖果的方案都是等概率的。现在问题是：期望情况下，所有小朋友的欢乐程度的乘积是多少？呆呆同学很快就有了一个思路，只要知道总的方案个数 $T$ 和所有方案下欢乐程度乘积的总和 $S$，就可以得到答案 $ans=\\frac{S}{T}$。现在他已经求出来了 $T$ 的答案，但是 $S$ 怎么求呢？他就不知道了。你能告诉他么？\n\n因为答案很大，你只需要告诉他 $S$ 对 $P$ 取模后的结果。\n\n后记：\n\n虽然大家都知道，即便知道了 $T$，知道了 $S$ 对 $P$ 取模后的结果，也没有办法知道期望情况下，所有小朋友欢乐程度的乘积。但是，当呆呆想到这一点的时候，已经彻底绝望了。", "inputFormat": "第一行有两个整数，分别是 $M$ 和 $P$。\n\n第二行有一个整数 $A$。\n\n第三行有一个整数 $O$。\n\n第四行有一个整数 $S$。\n\n第五行有一个整数 $U$。", "outputFormat": "一个整数 $S$，因为答案可能很大，你只需要输出 $S$ 对 $P$ 取模后的结果。", "hint": "**样例解释：**\n\n函数 $f(x)=x^2$。一共有 $4$ 份零食，$4$ 位同学。如果只有第一个同学得到，欢乐程度为 $16$，若前两位同学得到，欢乐程度的所有可能依次为 $9, 9, 16$，若有三位同学得到，欢乐程度有 $4, 4, 4$，最后一种情况，每一个同学都得到了零食，欢乐程度为 $1$。相加后得到 $S=63$。\n\n**数据范围：**\n\n对于 $40 \\%$ 的数据，$M \\leq 150$。  \n对于 $60 \\%$ 的数据，$M \\leq 2000$。  \n对于 $80 \\%$ 的数据，$M \\leq 6000$。  \n对于 $100 \\%$ 的数据，$M \\leq 10000, P \\leq 255, A \\leq 10^8, O \\leq 4, S \\leq 300, U \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] Distributing Snacks", "background": "", "description": "This is the joyful Jingxiang River, and this is a joyful kindergarten.\n\nToday is February 14, Tuesday. On this special day, the teacher leads the children to dance and laugh happily. The principal bought a large amount of snacks from a snack shop next to the kindergarten and decided to give them to the children. Hearing this news, all the children quietly lined up. Everyone knows that the principal does not like naughty kids.\n\nThe children stand in a single line in order. There are $A$ children, and there are three shared joy coefficients $O$, $S$, and $U$. If a child receives $x$ candies, then her happiness is $f(x)=Ox^2+Sx+U$.\n\nNow the principal starts handing out candies. There are $M$ candies in total. Some children may receive no candies. For those children who receive no candies, the happiness is $1$. If a child receives no candies, then all children behind her also receive no candies (that is, the children who receive no candies must form a consecutive suffix at the end of the line).\n\nAll candy-distribution plans are equally likely. The question is: in expectation, what is the product of the happiness values of all children? Student Daidai quickly came up with an idea: as long as he knows the total number of plans $T$ and the sum $S$ of the happiness-product over all plans, he can get the answer $ans=\\frac{S}{T}$. He has already computed $T$, but he does not know how to compute $S$. Can you tell him?\n\nBecause the answer is very large, you only need to output $S \\bmod P$.\n\nPostscript:\n\nAlthough everyone knows that even if you know $T$ and $S \\bmod P$, there is still no way to know the expected product of the happiness values of all children. However, when Daidai realized this, he was already completely hopeless.", "inputFormat": "The first line contains two integers, $M$ and $P$.\n\nThe second line contains an integer $A$.\n\nThe third line contains an integer $O$.\n\nThe fourth line contains an integer $S$.\n\nThe fifth line contains an integer $U$.", "outputFormat": "Output one integer $S$. Since the answer may be very large, you only need to output $S \\bmod P$.", "hint": "**Sample Explanation:**\n\nThe function is $f(x)=x^2$. There are $4$ snacks and $4$ students. If only the first student receives candies, the happiness is $16$. If the first two students receive candies, then the possible happiness values (for all distributions) are $9, 9, 16$ in order. If three students receive candies, the happiness values are $4, 4, 4$. In the last case, every student receives snacks, and the happiness is $1$. Adding them up gives $S=63$.\n\n**Constraints:**\n\nFor $40\\%$ of the testdata, $M \\leq 150$.  \nFor $60\\%$ of the testdata, $M \\leq 2000$.  \nFor $80\\%$ of the testdata, $M \\leq 6000$.  \nFor $100\\%$ of the testdata, $M \\leq 10000, P \\leq 255, A \\leq 10^8, O \\leq 4, S \\leq 300, U \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 分零食", "background": "", "description": "这里是欢乐的进香河，这里是欢乐的幼儿园。\n\n今天是 2 月 14 日，星期二。在这个特殊的日子里，老师带着同学们欢乐地跳着，笑着。校长从幼儿园旁边的小吃店买了大量的零食决定分给同学们。听到这个消息，所有同学都安安静静地排好了队，大家都知道，校长不喜欢调皮的孩子。\n\n同学们依次排成了一列，其中有 $A$ 位小朋友，有三个共同的欢乐系数 $O$，$S$ 和 $U$。如果有一位小朋友得到了 $x$ 个糖果，那么她的欢乐程度就是 $f(x)=Ox^2+Sx+U$。\n\n现在校长开始分糖果了，一共有 $M$ 个糖果。有些小朋友可能得不到糖果，对于那些得不到糖果的小朋友来说，欢乐程度就是 $1$。如果一位小朋友得不到糖果，那么在她身后的小朋友们也都得不到糖果（即这一列得不到糖果的小朋友一定是最后的连续若干位）。\n\n所有分糖果的方案都是等概率的。现在问题是：期望情况下，所有小朋友的欢乐程度的乘积是多少？呆呆同学很快就有了一个思路，只要知道总的方案个数 $T$ 和所有方案下欢乐程度乘积的总和 $S$，就可以得到答案 $ans=\\frac{S}{T}$。现在他已经求出来了 $T$ 的答案，但是 $S$ 怎么求呢？他就不知道了。你能告诉他么？\n\n因为答案很大，你只需要告诉他 $S$ 对 $P$ 取模后的结果。\n\n后记：\n\n虽然大家都知道，即便知道了 $T$，知道了 $S$ 对 $P$ 取模后的结果，也没有办法知道期望情况下，所有小朋友欢乐程度的乘积。但是，当呆呆想到这一点的时候，已经彻底绝望了。", "inputFormat": "第一行有两个整数，分别是 $M$ 和 $P$。\n\n第二行有一个整数 $A$。\n\n第三行有一个整数 $O$。\n\n第四行有一个整数 $S$。\n\n第五行有一个整数 $U$。", "outputFormat": "一个整数 $S$，因为答案可能很大，你只需要输出 $S$ 对 $P$ 取模后的结果。", "hint": "**样例解释：**\n\n函数 $f(x)=x^2$。一共有 $4$ 份零食，$4$ 位同学。如果只有第一个同学得到，欢乐程度为 $16$，若前两位同学得到，欢乐程度的所有可能依次为 $9, 9, 16$，若有三位同学得到，欢乐程度有 $4, 4, 4$，最后一种情况，每一个同学都得到了零食，欢乐程度为 $1$。相加后得到 $S=63$。\n\n**数据范围：**\n\n对于 $40 \\%$ 的数据，$M \\leq 150$。  \n对于 $60 \\%$ 的数据，$M \\leq 2000$。  \n对于 $80 \\%$ 的数据，$M \\leq 6000$。  \n对于 $100 \\%$ 的数据，$M \\leq 10000, P \\leq 255, A \\leq 10^8, O \\leq 4, S \\leq 300, U \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P5076", "type": "P", "difficulty": 4, "samples": [["7\n5 1\n5 3\n5 5\n1 3\n2 2\n3 3\n4 3", "2\n3\n1\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "树形数据结构", "平衡树"], "title": "【深基16.例7】普通二叉树（简化版）", "background": "", "description": "您需要写一种数据结构，来维护一些数（都是绝对值 $10^9$ 以内的数）的集合，最开始时集合是空的。其中需要提供以下操作，操作次数 $q$ 不超过 $10^4$：\n\n1. 定义数 $x$ 的排名为集合中小于 $x$ 的数的个数 $+1$。查询数 $x$ 的排名。**注意 $x$ 不一定在集合里**。\n2. 查询排名为 $x(x\\ge 1)$ 的数。**保证集合里至少有 $x$ 个数**。\n3. 求 $x$ 的前驱（前驱定义为小于 $x$，且最大的数）。若不存在则输出 $-2147483647$。\n4. 求 $x$ 的后继（后继定义为大于 $x$，且最小的数）。若不存在则输出 $2147483647$。\n5. 插入一个数 $x$，本题的数据保证插入前 $x$ 不在集合中。\n\n保证执行 $1,3,4$ 操作时，集合中有至少一个元素。", "inputFormat": "第一行是一个整数 $q$，表示操作次数。\n\n接下来 $q$ 行，每行两个整数 $op,x$，分别表示操作序号以及操作的参数 $x$。", "outputFormat": "输出有若干行。对于操作 $1,2,3,4$，输出一个整数，表示该操作的结果。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 16. Example 7] Ordinary Binary Tree (Simplified Version).", "background": "", "description": "You need to implement a data structure to maintain a set of numbers (all numbers have absolute value within $10^9$). The set is initially empty. You need to support the following operations, and the number of operations $q$ does not exceed $10^4$:\n\n1. Define the rank of a number $x$ as the number of elements in the set that are less than $x$, plus $1$. Query the rank of $x$. **Note that $x$ may not be in the set**.\n2. Query the number whose rank is $x$ ($x \\ge 1$). **It is guaranteed that the set contains at least $x$ numbers**.\n3. Find the predecessor of $x$ (the predecessor is defined as the largest number that is less than $x$). If it does not exist, output $-2147483647$.\n4. Find the successor of $x$ (the successor is defined as the smallest number that is greater than $x$). If it does not exist, output $2147483647$.\n5. Insert a number $x$. The testdata guarantees that before insertion, $x$ is not in the set.\n\nIt is guaranteed that when performing operations $1$, $3$, and $4$, the set contains at least one element.", "inputFormat": "The first line contains an integer $q$, indicating the number of operations.\n\nIn the next $q$ lines, each line contains two integers $op, x$, representing the operation index and the parameter $x$.", "outputFormat": "Output several lines. For operations $1$, $2$, $3$, and $4$, output one integer representing the result of the operation.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基16.例7】普通二叉树（简化版）", "background": "", "description": "您需要写一种数据结构，来维护一些数（都是绝对值 $10^9$ 以内的数）的集合，最开始时集合是空的。其中需要提供以下操作，操作次数 $q$ 不超过 $10^4$：\n\n1. 定义数 $x$ 的排名为集合中小于 $x$ 的数的个数 $+1$。查询数 $x$ 的排名。**注意 $x$ 不一定在集合里**。\n2. 查询排名为 $x(x\\ge 1)$ 的数。**保证集合里至少有 $x$ 个数**。\n3. 求 $x$ 的前驱（前驱定义为小于 $x$，且最大的数）。若不存在则输出 $-2147483647$。\n4. 求 $x$ 的后继（后继定义为大于 $x$，且最小的数）。若不存在则输出 $2147483647$。\n5. 插入一个数 $x$，本题的数据保证插入前 $x$ 不在集合中。\n\n保证执行 $1,3,4$ 操作时，集合中有至少一个元素。", "inputFormat": "第一行是一个整数 $q$，表示操作次数。\n\n接下来 $q$ 行，每行两个整数 $op,x$，分别表示操作序号以及操作的参数 $x$。", "outputFormat": "输出有若干行。对于操作 $1,2,3,4$，输出一个整数，表示该操作的结果。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5077", "type": "P", "difficulty": 3, "samples": [["9", "2 4"], ["16", "16 16"], ["1000000007", "500000003 500000004"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": [], "title": "Tweetuzki 爱等差数列", "background": "", "description": "Tweetuzki 特别喜欢等差数列。尤其是公差为 $1$ 且全为正整数的等差数列。\n\n显然，对于每一个数 $s$，都能找到一个对应的公差为 $1$ 且全为正整数的等差数列各项之和为 $s$。这时，Tweetuzki 想知道，满足这样条件的等差数列，最小的首项是多少。\n\n由于 Tweetuzki 的数学非常差，尤其是因式分解，所以请你告诉他结果。", "inputFormat": "输入仅包含一行一个整数 $s$ $(1 \\le s \\le 10^{12})$.", "outputFormat": "输出两个正整数，分别表示这个等差数列的首项和末项。请注意输出最小的首项。", "hint": "**样例解释 1**\n\n$2 + 3 + 4 = 9$\n\n**样例解释 2**\n\n$16 = 16$\n\n## 数据范围\n\n对于 $10\\%$ 的数据，$s \\le 10^6$。  \n对于 $100\\%$ 的数据，$1 \\le s \\le 10^{12}$。\n\n## 提示\n\n若有一个数列 $a$，每一项 $a_i$ 都满足 $a_i \\in \\mathbb{N_{+}}$ 且 $a_i - a_{i - 1} = a_{i + 1} - a_i = 1$，则称这个数列为一个公差为 $1$ 且全为正整数的等差数列。", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Arithmetic Progressions", "background": "", "description": "Tweetuzki especially likes arithmetic progressions. In particular, he likes arithmetic progressions with common difference $1$ and all terms being positive integers.\n\nObviously, for every number $s$, we can find an arithmetic progression with common difference $1$ and all terms being positive integers such that the sum of its terms is $s$. Now, Tweetuzki wants to know: among all such arithmetic progressions, what is the smallest possible first term.\n\nSince Tweetuzki is very bad at math, especially at factoring, please tell him the answer.", "inputFormat": "The input contains only one line with an integer $s$ $(1 \\le s \\le 10^{12})$.", "outputFormat": "Output two positive integers, representing the first term and the last term of the arithmetic progression. Note that you must output the smallest possible first term.", "hint": "**Sample Explanation 1**\n\n$2 + 3 + 4 = 9$\n\n**Sample Explanation 2**\n\n$16 = 16$\n\n## Constraints\n\nFor $10\\%$ of the testdata, $s \\le 10^6$.  \nFor $100\\%$ of the testdata, $1 \\le s \\le 10^{12}$.\n\nIf there is a sequence $a$ where each term $a_i$ satisfies $a_i \\in \\mathbb{N_{+}}$ and $a_i - a_{i - 1} = a_{i + 1} - a_i = 1$, then this sequence is called an arithmetic progression with common difference $1$ and all terms being positive integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱等差数列", "background": "", "description": "Tweetuzki 特别喜欢等差数列。尤其是公差为 $1$ 且全为正整数的等差数列。\n\n显然，对于每一个数 $s$，都能找到一个对应的公差为 $1$ 且全为正整数的等差数列各项之和为 $s$。这时，Tweetuzki 想知道，满足这样条件的等差数列，最小的首项是多少。\n\n由于 Tweetuzki 的数学非常差，尤其是因式分解，所以请你告诉他结果。", "inputFormat": "输入仅包含一行一个整数 $s$ $(1 \\le s \\le 10^{12})$.", "outputFormat": "输出两个正整数，分别表示这个等差数列的首项和末项。请注意输出最小的首项。", "hint": "**样例解释 1**\n\n$2 + 3 + 4 = 9$\n\n**样例解释 2**\n\n$16 = 16$\n\n## 数据范围\n\n对于 $10\\%$ 的数据，$s \\le 10^6$。  \n对于 $100\\%$ 的数据，$1 \\le s \\le 10^{12}$。\n\n## 提示\n\n若有一个数列 $a$，每一项 $a_i$ 都满足 $a_i \\in \\mathbb{N_{+}}$ 且 $a_i - a_{i - 1} = a_{i + 1} - a_i = 1$，则称这个数列为一个公差为 $1$ 且全为正整数的等差数列。", "locale": "zh-CN"}}}
{"pid": "P5078", "type": "P", "difficulty": 5, "samples": [["5\n7 8 1 2 5", "87\n1 2 5 8 7"], ["5\n7 99 1 5 2", "530\n7 1 2 5 99"], ["8\n1 9 2 6 0 8 1 7", "206\n1 2 0 1 7 8 6 9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心"], "title": "Tweetuzki 爱军训", "background": "", "description": "Tweetuzki 仍然记得，初一军训的时候，有关他们班的教官的一些事儿。\n\nTweetuzki 所在的班级有 $n$ 名学生，座号从 $1$ 到 $n$。有一次，教官命令班上的 $n$ 名学生按照座号顺序从左到右排成一排站好军姿，其中 $1$ 号学生在最左边，$n$ 号学生在最右边。\n\n由于同学们站了很久，怨声载道，仁慈的教官又不希望大家一起解散导致混乱的局面，于是想了一个办法：教官从最左边——也就是 $1$ 号学生身旁出发，走到 $n$ 号学生右边后，再折返回到 $1$ 号同学旁边。在教官在从 $1$ 号同学走到 $n$ 号同学这段路上，当走到某位同学身边时，他可以选择让这位同学出列，也可以等到折返的时候再使这名同学出列。\n\n但是有一些同学在军训过程中表现极坏，因此教官希望他们晚一些出列休息。对于 $i$ 号同学，定义他的“坏值”为 $w_i$。教官希望在一次往返过程中，使得所有学生出列，且最大化 $\\sum_{i = 1}^n r_i \\times w_i$ 的值，其中 $r_i$ 表示 $i$ 号同学是第 $r_i$ 位出列的学生。机智的教官一下子就想出了这个方案，Tweetuzki 大为惊讶，于是他去请教教官如何做到。可是他的胆子很小而且“坏值”很大，教官可能不会告诉他，所以他就找到了你。", "inputFormat": "第一行一个整数 $n$ ( $5 \\le n \\le 10^6$ )。  \n第二行包含 $n$ 个整数，描述这 $n$ 个同学的坏值 $w_1, w_2, w_3, …, w_n$ $(0 \\le w_i \\le 10^6)$。", "outputFormat": "第一行一个整数，表示最大值。  \n接下来一行包含 $n$ 个这个数，描述一个合理的出列顺序，输出的是对应同学的“坏值”，详见样例。如果有多个满足条件的出列顺序，请输出出列的人序号字典序最小的。", "hint": "### 样例解释 1\n\n在去的路上让 $3, 4, 5$ 号同学出列，回来时让 $2, 1$ 号同学出列。总的值为 $5 \\times 7 + 4 \\times 8 + 1 \\times 1 + 2 \\times 2 + 3 \\times 5 = 87$，可以证明没有使得答案大于 $87$ 的方案。\n\n### 数据范围\n\n本题共设 $20$ 组测试点，每组测试数据 $5$ 分。\n\n对于 $10\\%$ 的数据，$n \\le 8$。  \n对于 $30\\%$ 的数据，$n \\le 20$。  \n对于 $60\\%$ 的数据，$n \\le 1000$。  \n对于 $100\\%$ 的数据，$5 \\le n \\le 10^6$，$0 \\le w_i \\le 10^6$。  ", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Military Training.", "background": "", "description": "Tweetuzki still remembers some things about the instructor of their class during the military training in Grade 7.\n\nThere are $n$ students in Tweetuzki’s class, with seat numbers from $1$ to $n$. Once, the instructor ordered the $n$ students to stand in a line from left to right in increasing seat number, where student $1$ is on the far left and student $n$ is on the far right.\n\nSince the students had been standing for a long time and complained a lot, the kind instructor also did not want everyone to be dismissed at the same time and cause chaos, so he came up with a method: the instructor starts from the far left (next to student $1$), walks to the right side of student $n$, then turns back and returns to student $1$. During the trip from student $1$ to student $n$, when the instructor reaches a student, he may choose to dismiss this student from the line, or wait until the return trip to dismiss the student.\n\nHowever, some students behaved very badly during the training, so the instructor wants them to rest later. For student $i$, define their “badness value” as $w_i$. The instructor wants, within one round trip, to have all students dismissed, and maximize the value of $\\sum_{i = 1}^n r_i \\times w_i$, where $r_i$ means student $i$ is the $r_i$-th student to be dismissed. The clever instructor immediately found a plan, and Tweetuzki was amazed, so he asked the instructor how to do it. But he is timid and has a large “badness value”, so the instructor might not tell him, and thus he came to you.", "inputFormat": "The first line contains an integer $n$ ( $5 \\le n \\le 10^6$ ).  \nThe second line contains $n$ integers describing the badness values $w_1, w_2, w_3, …, w_n$ ( $0 \\le w_i \\le 10^6$ ).", "outputFormat": "The first line contains an integer, the maximum value.  \nThe next line contains $n$ integers describing a valid dismissal order. Output the corresponding students’ “badness values”; see the sample for details. If there are multiple valid dismissal orders, output the one with the lexicographically smallest sequence of dismissed student indices.", "hint": "### Sample Explanation 1\n\nOn the way there, dismiss students $3, 4, 5$. On the way back, dismiss students $2, 1$. The total value is $5 \\times 7 + 4 \\times 8 + 1 \\times 1 + 2 \\times 2 + 3 \\times 5 = 87$, and it can be proven that no plan can achieve a value greater than $87$.\n\n### Constraints\n\nThis problem has $20$ test points, and each group of testdata is worth $5$ points.\n\nFor $10\\%$ of the data, $n \\le 8$.  \nFor $30\\%$ of the data, $n \\le 20$.  \nFor $60\\%$ of the data, $n \\le 1000$.  \nFor $100\\%$ of the data, $5 \\le n \\le 10^6$, $0 \\le w_i \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱军训", "background": "", "description": "Tweetuzki 仍然记得，初一军训的时候，有关他们班的教官的一些事儿。\n\nTweetuzki 所在的班级有 $n$ 名学生，座号从 $1$ 到 $n$。有一次，教官命令班上的 $n$ 名学生按照座号顺序从左到右排成一排站好军姿，其中 $1$ 号学生在最左边，$n$ 号学生在最右边。\n\n由于同学们站了很久，怨声载道，仁慈的教官又不希望大家一起解散导致混乱的局面，于是想了一个办法：教官从最左边——也就是 $1$ 号学生身旁出发，走到 $n$ 号学生右边后，再折返回到 $1$ 号同学旁边。在教官在从 $1$ 号同学走到 $n$ 号同学这段路上，当走到某位同学身边时，他可以选择让这位同学出列，也可以等到折返的时候再使这名同学出列。\n\n但是有一些同学在军训过程中表现极坏，因此教官希望他们晚一些出列休息。对于 $i$ 号同学，定义他的“坏值”为 $w_i$。教官希望在一次往返过程中，使得所有学生出列，且最大化 $\\sum_{i = 1}^n r_i \\times w_i$ 的值，其中 $r_i$ 表示 $i$ 号同学是第 $r_i$ 位出列的学生。机智的教官一下子就想出了这个方案，Tweetuzki 大为惊讶，于是他去请教教官如何做到。可是他的胆子很小而且“坏值”很大，教官可能不会告诉他，所以他就找到了你。", "inputFormat": "第一行一个整数 $n$ ( $5 \\le n \\le 10^6$ )。  \n第二行包含 $n$ 个整数，描述这 $n$ 个同学的坏值 $w_1, w_2, w_3, …, w_n$ $(0 \\le w_i \\le 10^6)$。", "outputFormat": "第一行一个整数，表示最大值。  \n接下来一行包含 $n$ 个这个数，描述一个合理的出列顺序，输出的是对应同学的“坏值”，详见样例。如果有多个满足条件的出列顺序，请输出出列的人序号字典序最小的。", "hint": "### 样例解释 1\n\n在去的路上让 $3, 4, 5$ 号同学出列，回来时让 $2, 1$ 号同学出列。总的值为 $5 \\times 7 + 4 \\times 8 + 1 \\times 1 + 2 \\times 2 + 3 \\times 5 = 87$，可以证明没有使得答案大于 $87$ 的方案。\n\n### 数据范围\n\n本题共设 $20$ 组测试点，每组测试数据 $5$ 分。\n\n对于 $10\\%$ 的数据，$n \\le 8$。  \n对于 $30\\%$ 的数据，$n \\le 20$。  \n对于 $60\\%$ 的数据，$n \\le 1000$。  \n对于 $100\\%$ 的数据，$5 \\le n \\le 10^6$，$0 \\le w_i \\le 10^6$。  ", "locale": "zh-CN"}}}
{"pid": "P5079", "type": "P", "difficulty": 3, "samples": [["6 10\n# . . . . . # . . #\n# . . . # . # . . #\n# . . . # . # . . #\n# . . . # . # . . #\n# . . . # . # . . #\n. . . . # . . . . .", "1111"], ["8 37\n. . . # # # . . . . . . . . . . . . . . . . . . # # # . # . . . . . . . .\n. # . # . # . . . . . . . . # # # . . . . . . . # . # . # . . . . . . . .\n. # . # # # . . . . . . . . # . . . # # # . . . # # # . # . . # # # . . .\n. # . . . # . . . # # # . . # # # . # . # . . . # . # . # . . . . # . . .\n. # . # # # . . . . . # . . # . # . # . # . . . # # # . # . . . . # . . .\n. # . . . . . . . # # # . . # # # . # . # . . . . . . . . . . . . # . . .\n. . . . . . . . . # . . . . . . . . # # # . . . . . . . . . . . . # . . .\n. . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . .\n", "19260817"], ["9 94\n# # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n# . # . . . . . . . . . . . . . . . . . . . . . . . . # . # . . . . . . . . . . # . . . . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n# . # . . . # . . . . . . . . . . . . . . . # # # . . # . # . . . . . . . . . . # # # . . . . . . . . . # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n# . # . . . # . . # # # . . . . . . . . . . . . # . . # # # . . . . . . . . . . . . # . . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n# # # . . . # . . . . # . . . . . . . . . . # # # . . . . # . . . . . . . . . . # # # . . . . . . . . . # . # . . . . . . . # # # . . . . . . # # # . . . . . . . . . # # # . . . . . . . .\n. . . . . . # . . # # # . . . . . . . . . . . . # . . . . # . . . . . . . . . . . . . . . . . . . . . . # # # . . . . . . . . . # . . . . . . # . # . . . . . . . . . # . # . . . . . . . .\n. . . . . . # . . # . . . . . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . # . . . . . . # # # . . . . . . . . . # # # . . . . . . . .\n. . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . # . . . . . . # . # . . . . . . . . . . . # . . . . . . . .\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . # . . . . . . # # # . . . . . . . . . # # # . . . . . . . .\n", "0123456789\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": [], "title": "Tweetuzki 爱伊图", "background": "Tweetuzki 的教练最近常常在群里发有关「伊图科技」的文章。「伊图科技」是一家专注于计算机视觉技术的上海创业公司，其人脸识别技术在世界处于领先地位。2018 年 6 月，在全球工业界黄金标准 FRVT 测试中，依图在千万分之一误报下识别准确率接近 $99\\%$，是全球工业界在此项指标下的最好水平，这是依图科技连续第二年摘得此项竞赛的冠军，也是首个夺得此项竞赛冠军的中国团队。2018 年 11 月 16 日，美国国家标准与技术研究院（NIST）公布了全球权威人脸识别比赛（FRVT）最新报告，依图算法继续保持第一，在千万分之一误报下的识别准确率超过 $99\\%$，是目前全球人脸识别技术的最好水平。\n\n更重要的是，伊图科技的创始人，是附中的毕业生——Tweetuzki 的学长呢！人脸识别真的好难呢！Tweetuzki 常常幻想，要是自己的程序能有学长们的亿万分之一厉害，那就很好了呢！", "description": "Tweetuzki 希望设计出一个程序，这个程序应当能识别输入矩阵中隐藏的数字。\n\n输入的是一个 $r \\times c$ 的字符矩阵，矩阵中的元素只有 `. `或 `#`。其中 `#` 可以构成一些数字。输入的矩阵将严格遵守以下规则：\n\n- 除 $1$ 占 $5 \\times 1$ 的长方形区域外，其余数字均占 $5 \\times 3$ 的长方形区域。\n\n- 相邻两个数字间至少有一列 `.`，即**数字不会贴在一块儿**；且数字**只会左右排放**，不会上下排放。这两点综合起来可以表述为：对于两个数字 $A$ 和 $B$（$A$ 在 $B$ 的左侧），若它们在横向上延伸的区间分别为 $[l_A, r_A]$ 和 $[l_B, r_B]$，那么一定满足 $l_B \\ge r_A + 2$。\n\n- 数字的组成严格按照如下所列：\n\n  ```plain\n  数字的组成方式：\n  #   # # #   # # #   # . #   # # #   # # #   # # #   # # #   # # #   # # # \n  #   . . #   . . #   # . #   # . .   # . .   . . #   # . #   # . #   # . # \n  #   # # #   # # #   # # #   # # #   # # #   . . #   # # #   # # #   # . # \n  #   # . .   . . #   . . #   . . #   # . #   . . #   # . #   . . #   # . # \n  #   # # #   # # #   . . #   # # #   # # #   . . #   # # #   # # #   # # # \n  \n  所代表的数字：\n  1     2       3       4       5       6       7       8       9       0\n  ```\n\n  **数字不会倾斜、放大或缩小。**具体可见样例。\n\n- 除构成数字的长方形区域外，其余位置皆由 `.` 填充。保证所有的 `#` 的连通块一定都能够组成数字，且一定满足上述规则。\n\n由于 Tweetuzki 太弱了，于是向你求助，聪明的你，能不能帮助 Tweetuzki 解决这个问题呢？", "inputFormat": "第一行两个正整数 $r, c$ $(5 \\le r \\le 10, 3 \\le c \\le 10^5)$，表示矩阵的行数和列数。  \n接下来 $r$ 行，每行输入 $c$ 个字符，用空格隔开，保证只含有 `.` 和 `#` 两种字符。输入矩阵保证合法且一定含有隐藏数字。", "outputFormat": "输出仅包含一行一个只含数字的字符串，**按照顺序**输出这个矩阵中隐藏的数字。", "hint": "### 样例解释\n\n建议复制进记事本（或各种 IDE）中用等宽字体查看。 \n\n###  子任务\n\n**_Subtask_ #1 _(30 points)_**：矩阵中仅有数字 $1$。  \n**_Subtask_ #2 _(30 points)_**：矩阵中不含有数字 $1$ 和 $4$。  \n**_Subtask_ #3 _(40 points)_**：无特殊性质。", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Yitu.", "background": "Tweetuzki’s coach has recently often shared articles about “Yitu Technology” in the group chat. “Yitu Technology” is a Shanghai startup focusing on computer vision technology, and its face recognition technology is at a leading level worldwide. In June 2018, in the global industry gold-standard FRVT test, with a false positive rate of one in ten million, Yitu’s recognition accuracy was close to $99\\%$, reaching the best level in the global industry under this metric. This was the second year in a row that Yitu Technology won the championship of this competition, and it was also the first Chinese team to win this competition. On November 16, 2018, the U.S. National Institute of Standards and Technology (NIST) released the latest report of the world’s authoritative face recognition competition (FRVT). Yitu’s algorithm continued to rank first, and with a false positive rate of one in ten million, its recognition accuracy exceeded $99\\%$, which is currently the best level of face recognition technology in the world.\n\nMore importantly, the founder of Yitu Technology is a graduate of the affiliated high school, and also Tweetuzki’s senior! Face recognition is really hard! Tweetuzki often imagines that if their own program could be even one hundred-millionth as powerful as their seniors’, that would be great.", "description": "Tweetuzki wants to design a program that can recognize the digits hidden in the input matrix.\n\nThe input is a $r \\times c$ character matrix. Each element is either `.` or `#`. The `#` symbols can form some digits. The input matrix will strictly follow the rules below:\n\n- Except for digit $1$, which occupies a $5 \\times 1$ rectangular area, all other digits occupy a $5 \\times 3$ rectangular area.\n\n- There is at least one column of `.` between two adjacent digits, meaning **digits will not stick together**. Also, digits are **only placed left to right**, never stacked vertically. Combining these two points: for two digits $A$ and $B$ (with $A$ to the left of $B$), if their horizontal spans are $[l_A, r_A]$ and $[l_B, r_B]$, then it must hold that $l_B \\ge r_A + 2$.\n\n- Digits are composed exactly as listed below:\n\n  ```plain\n  Digit patterns:\n  #   # # #   # # #   # # #   # . #   # # #   # # #   # # #   # # #   # # # \n  #   . . #   . . #   # . #   # . #   # . .   # . .   . . #   # . #   # . # \n  #   # # #   # # #   # # #   # # #   # # #   # # #   . . #   # # #   # . # \n  #   # . .   . . #   . . #   . . #   # . #   # . #   . . #   # . #   # . # \n  #   # # #   # # #   . . #   # # #   # # #   # # #   . . #   # # #   # # # \n  \n  Digits represented:\n  1     2       3       4       5       6       7       8       9       0\n  ```\n\n  **Digits will not be slanted, enlarged, or reduced.** See the samples for details.\n\n- Except for the rectangular areas that form digits, all other positions are filled with `.`. It is guaranteed that every connected component of `#` can form a digit and that all the rules above are satisfied.\n\nSince Tweetuzki is too weak, they ask you for help. Can you, the smart one, help Tweetuzki solve this problem?", "inputFormat": "The first line contains two positive integers $r, c$ $(5 \\le r \\le 10, 3 \\le c \\le 10^5)$, representing the number of rows and columns of the matrix.  \nNext come $r$ lines. Each line contains $c$ characters separated by spaces, and they are guaranteed to be only `.` and `#`. The input matrix is guaranteed to be valid and must contain hidden digits.", "outputFormat": "Output exactly one line containing a string consisting only of digits, outputting the hidden digits in this matrix **in order**.", "hint": "### Sample Explanation\n\nIt is recommended to copy it into Notepad (or various IDEs) and view it with a monospaced font.\n\n### Subtasks\n\n**_Subtask_ #1 _(30 points)_**: The matrix contains only digit $1$.  \n**_Subtask_ #2 _(30 points)_**: The matrix contains no digit $1$ or $4$.  \n**_Subtask_ #3 _(40 points)_**: No special properties.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱伊图", "background": "Tweetuzki 的教练最近常常在群里发有关「伊图科技」的文章。「伊图科技」是一家专注于计算机视觉技术的上海创业公司，其人脸识别技术在世界处于领先地位。2018 年 6 月，在全球工业界黄金标准 FRVT 测试中，依图在千万分之一误报下识别准确率接近 $99\\%$，是全球工业界在此项指标下的最好水平，这是依图科技连续第二年摘得此项竞赛的冠军，也是首个夺得此项竞赛冠军的中国团队。2018 年 11 月 16 日，美国国家标准与技术研究院（NIST）公布了全球权威人脸识别比赛（FRVT）最新报告，依图算法继续保持第一，在千万分之一误报下的识别准确率超过 $99\\%$，是目前全球人脸识别技术的最好水平。\n\n更重要的是，伊图科技的创始人，是附中的毕业生——Tweetuzki 的学长呢！人脸识别真的好难呢！Tweetuzki 常常幻想，要是自己的程序能有学长们的亿万分之一厉害，那就很好了呢！", "description": "Tweetuzki 希望设计出一个程序，这个程序应当能识别输入矩阵中隐藏的数字。\n\n输入的是一个 $r \\times c$ 的字符矩阵，矩阵中的元素只有 `. `或 `#`。其中 `#` 可以构成一些数字。输入的矩阵将严格遵守以下规则：\n\n- 除 $1$ 占 $5 \\times 1$ 的长方形区域外，其余数字均占 $5 \\times 3$ 的长方形区域。\n\n- 相邻两个数字间至少有一列 `.`，即**数字不会贴在一块儿**；且数字**只会左右排放**，不会上下排放。这两点综合起来可以表述为：对于两个数字 $A$ 和 $B$（$A$ 在 $B$ 的左侧），若它们在横向上延伸的区间分别为 $[l_A, r_A]$ 和 $[l_B, r_B]$，那么一定满足 $l_B \\ge r_A + 2$。\n\n- 数字的组成严格按照如下所列：\n\n  ```plain\n  数字的组成方式：\n  #   # # #   # # #   # . #   # # #   # # #   # # #   # # #   # # #   # # # \n  #   . . #   . . #   # . #   # . .   # . .   . . #   # . #   # . #   # . # \n  #   # # #   # # #   # # #   # # #   # # #   . . #   # # #   # # #   # . # \n  #   # . .   . . #   . . #   . . #   # . #   . . #   # . #   . . #   # . # \n  #   # # #   # # #   . . #   # # #   # # #   . . #   # # #   # # #   # # # \n  \n  所代表的数字：\n  1     2       3       4       5       6       7       8       9       0\n  ```\n\n  **数字不会倾斜、放大或缩小。**具体可见样例。\n\n- 除构成数字的长方形区域外，其余位置皆由 `.` 填充。保证所有的 `#` 的连通块一定都能够组成数字，且一定满足上述规则。\n\n由于 Tweetuzki 太弱了，于是向你求助，聪明的你，能不能帮助 Tweetuzki 解决这个问题呢？", "inputFormat": "第一行两个正整数 $r, c$ $(5 \\le r \\le 10, 3 \\le c \\le 10^5)$，表示矩阵的行数和列数。  \n接下来 $r$ 行，每行输入 $c$ 个字符，用空格隔开，保证只含有 `.` 和 `#` 两种字符。输入矩阵保证合法且一定含有隐藏数字。", "outputFormat": "输出仅包含一行一个只含数字的字符串，**按照顺序**输出这个矩阵中隐藏的数字。", "hint": "### 样例解释\n\n建议复制进记事本（或各种 IDE）中用等宽字体查看。 \n\n###  子任务\n\n**_Subtask_ #1 _(30 points)_**：矩阵中仅有数字 $1$。  \n**_Subtask_ #2 _(30 points)_**：矩阵中不含有数字 $1$ 和 $4$。  \n**_Subtask_ #3 _(40 points)_**：无特殊性质。", "locale": "zh-CN"}}}
{"pid": "P5080", "type": "P", "difficulty": 5, "samples": [["6\n4 8 6 3 12 9\n", "6\n9 3 6 12 4 8 \n"], ["4\n42 28 84 126\n", "4\n126 42 84 28 \n"], ["5\n4 8 16 12 24", "4\n12 24 8 16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Special Judge"], "title": "Tweetuzki 爱序列", "background": "本题为改编题", "description": "Tweetuzki 有一个长度为 $n$ 的序列 $a_1, a_2, \\cdots, a_n$。\n\n他希望找出一个最大的 $k$，满足在原序列中存在一些数 $b_1, b_2, \\cdots, b_k$（可打散在原序列中的顺序），满足对于任意的 $i(1 \\le i < k)$，$b_i \\div 3 = b_{i+1}$（这时 $b_i$ 必须能够被 $3$ 整除）或 $b_i \\times 2 = b_{i+1}$。并输出这个序列。", "inputFormat": "第一行一个正整数 $n(2 \\le n \\le 10^5)$，表示序列的长度。  \n第二行包含 $n$ 个正整数，$a_1, a_2, \\cdots, a_n(1 \\le a_i \\le 3 \\times 10^{18})$，描述这个数列。", "outputFormat": "第一行一个正整数 $k$，表示最大的 $k$。  \n第二行 $k$ 个正整数 $b_1, b_2, \\cdots, b_n$，描述你选择的数。", "hint": "**_Subtask_ #1 _(20 points)_：$2 \\le n \\le 8$；**  \n**_Subtask_ #2 _(30 points)_：$2 \\le n \\le 100, 1 \\le a_i \\le 7 \\times 10^8$；**  \n**_Subtask_ #3 _(20 points)_：$2 \\le n \\le 1000, 1 \\le a_i \\le 1000$；**  \n**_Subtask_ #4 _(30 points)_：$2 \\le n \\le 10^5, 1 \\le a_i \\le 3 \\times 10^{18}$。**", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Sequences", "background": "This problem is an adapted problem.", "description": "Tweetuzki has a sequence $a_1, a_2, \\cdots, a_n$ of length $n$.\n\nHe wants to find the maximum $k$ such that there exist some numbers $b_1, b_2, \\cdots, b_k$ in the original sequence (not necessarily in the same order as in the original sequence), satisfying that for any $i(1 \\le i < k)$, either $b_i \\div 3 = b_{i+1}$ (in this case, $b_i$ must be divisible by $3$) or $b_i \\times 2 = b_{i+1}$. Output this sequence as well.", "inputFormat": "The first line contains a positive integer $n(2 \\le n \\le 10^5)$, representing the length of the sequence.  \nThe second line contains $n$ positive integers $a_1, a_2, \\cdots, a_n(1 \\le a_i \\le 3 \\times 10^{18})$, describing the sequence.", "outputFormat": "The first line contains a positive integer $k$, representing the maximum $k$.  \nThe second line contains $k$ positive integers $b_1, b_2, \\cdots, b_k$, describing the numbers you chose.", "hint": "**_Subtask_ #1 _(20 points)_：$2 \\le n \\le 8$；**  \n**_Subtask_ #2 _(30 points)_：$2 \\le n \\le 100, 1 \\le a_i \\le 7 \\times 10^8$；**  \n**_Subtask_ #3 _(20 points)_：$2 \\le n \\le 1000, 1 \\le a_i \\le 1000$；**  \n**_Subtask_ #4 _(30 points)_：$2 \\le n \\le 10^5, 1 \\le a_i \\le 3 \\times 10^{18}$。**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱序列", "background": "本题为改编题", "description": "Tweetuzki 有一个长度为 $n$ 的序列 $a_1, a_2, \\cdots, a_n$。\n\n他希望找出一个最大的 $k$，满足在原序列中存在一些数 $b_1, b_2, \\cdots, b_k$（可打散在原序列中的顺序），满足对于任意的 $i(1 \\le i < k)$，$b_i \\div 3 = b_{i+1}$（这时 $b_i$ 必须能够被 $3$ 整除）或 $b_i \\times 2 = b_{i+1}$。并输出这个序列。", "inputFormat": "第一行一个正整数 $n(2 \\le n \\le 10^5)$，表示序列的长度。  \n第二行包含 $n$ 个正整数，$a_1, a_2, \\cdots, a_n(1 \\le a_i \\le 3 \\times 10^{18})$，描述这个数列。", "outputFormat": "第一行一个正整数 $k$，表示最大的 $k$。  \n第二行 $k$ 个正整数 $b_1, b_2, \\cdots, b_n$，描述你选择的数。", "hint": "**_Subtask_ #1 _(20 points)_：$2 \\le n \\le 8$；**  \n**_Subtask_ #2 _(30 points)_：$2 \\le n \\le 100, 1 \\le a_i \\le 7 \\times 10^8$；**  \n**_Subtask_ #3 _(20 points)_：$2 \\le n \\le 1000, 1 \\le a_i \\le 1000$；**  \n**_Subtask_ #4 _(30 points)_：$2 \\le n \\le 10^5, 1 \\le a_i \\le 3 \\times 10^{18}$。**", "locale": "zh-CN"}}}
{"pid": "P5081", "type": "P", "difficulty": 5, "samples": [["1", "1"], ["2", "3"], ["3", "10020162"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": [], "title": "Tweetuzki 爱取球", "background": "本题为被指出的改编题……~~害怕被爆破~~", "description": "Tweetuzki 有一个袋子，袋子中有 $N$ 个无差别的球。Tweetuzki 每次随机取出一个球后放回。求取遍所有球的期望次数。\n\n取遍是指，袋子中所有球都被取出来过至少一次。", "inputFormat": "一行一个整数 $N$ $(1 \\le N \\le 10^7)$。", "outputFormat": "一行一个整数，表示期望次数。由于这个数可能很大，输出对 $20040313$ （是个质数）取模。", "hint": "### 样例解释 1\n\n第一次取出一个球即可取遍所有球。\n\n### 样例解释 2\n\n两次就取遍所有球的概率为 $\\frac{1}{2}$，三次取遍所有球的概率为 $\\frac{1}{4}$，四次取遍所有球的概率为 $\\frac{1}{8}$，……，$k$ 次取遍所有球的概率为 $\\frac{1}{2^{k-1}}$。故：\n\n$$E(2) = \\frac{2}{2} + \\frac{3}{4} + \\frac{4}{8} + \\frac{5}{16} + \\cdots = 3$$\n\n### 样例解释 3\n\n通过试验及计算可得：\n\n$$E(3) = \\frac{11}{2}$$\n\n对 $20040313$ 取模后答案为 $10020162$。\n\n## 数据范围及约定\n\n对于 $30\\%$ 的数据，$N \\le 5$。  \n对于 $70\\%$ 的数据，$N \\le 10^5$。  \n对于 $100\\%$ 的数据，$1 \\le N \\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Drawing Balls", "background": "This problem is an adaptation that got called out… ~~afraid of getting blasted~~.", "description": "Tweetuzki has a bag with $N$ indistinguishable balls. Each time, Tweetuzki randomly draws one ball and then puts it back. Find the expected number of draws needed to have drawn every ball at least once.\n\n“Having drawn all balls” means that every ball in the bag has been drawn at least once.", "inputFormat": "One line with one integer $N$ $(1 \\le N \\le 10^7)$.", "outputFormat": "Output one integer on one line, representing the expected number of draws. Since this number may be very large, output it modulo $20040313$ (a prime).", "hint": "### Sample Explanation 1\n\nDrawing one ball the first time is enough to have drawn all balls.\n\n### Sample Explanation 2\n\nThe probability of having drawn all balls in two draws is $\\frac{1}{2}$, in three draws is $\\frac{1}{4}$, in four draws is $\\frac{1}{8}$, …, and in $k$ draws is $\\frac{1}{2^{k-1}}$. Therefore:\n\n$$E(2) = \\frac{2}{2} + \\frac{3}{4} + \\frac{4}{8} + \\frac{5}{16} + \\cdots = 3$$\n\n### Sample Explanation 3\n\nBy experiments and calculation, we get:\n\n$$E(3) = \\frac{11}{2}$$\n\nAfter taking modulo $20040313$, the answer is $10020162$.\n\n## Constraints\n\nFor $30\\%$ of the testdata, $N \\le 5$.  \nFor $70\\%$ of the testdata, $N \\le 10^5$.  \nFor $100\\%$ of the testdata, $1 \\le N \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱取球", "background": "本题为被指出的改编题……~~害怕被爆破~~", "description": "Tweetuzki 有一个袋子，袋子中有 $N$ 个无差别的球。Tweetuzki 每次随机取出一个球后放回。求取遍所有球的期望次数。\n\n取遍是指，袋子中所有球都被取出来过至少一次。", "inputFormat": "一行一个整数 $N$ $(1 \\le N \\le 10^7)$。", "outputFormat": "一行一个整数，表示期望次数。由于这个数可能很大，输出对 $20040313$ （是个质数）取模。", "hint": "### 样例解释 1\n\n第一次取出一个球即可取遍所有球。\n\n### 样例解释 2\n\n两次就取遍所有球的概率为 $\\frac{1}{2}$，三次取遍所有球的概率为 $\\frac{1}{4}$，四次取遍所有球的概率为 $\\frac{1}{8}$，……，$k$ 次取遍所有球的概率为 $\\frac{1}{2^{k-1}}$。故：\n\n$$E(2) = \\frac{2}{2} + \\frac{3}{4} + \\frac{4}{8} + \\frac{5}{16} + \\cdots = 3$$\n\n### 样例解释 3\n\n通过试验及计算可得：\n\n$$E(3) = \\frac{11}{2}$$\n\n对 $20040313$ 取模后答案为 $10020162$。\n\n## 数据范围及约定\n\n对于 $30\\%$ 的数据，$N \\le 5$。  \n对于 $70\\%$ 的数据，$N \\le 10^5$。  \n对于 $100\\%$ 的数据，$1 \\le N \\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P5082", "type": "P", "difficulty": 1, "samples": [["3\n10 10 10\n5 5 5", "4.000000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2018"], "title": "成绩", "background": "小奔的score\n\n题解：https://blog.csdn.net/kkkksc03/article/details/84928268\n\n说一句：本题已放开空间范围（不过真的貌似不用开数组就可以A呀", "description": "小奔的期末考试结束了。\n\n他的成绩不久之后就会发下来。\n\n给出一个考试成绩表格，例如：\n\n| 科目/分值种类 | 语文 | 数学|英语  |\n| :----------: | :----------: | :----------: | :----------: |\n|  满分| $100$ |$120$  |$150$  |\n| 实际得分 |  $99$|$73$  |$100$  |\n\n当然。学校的老师认为如果录入如此多的成绩不好算分，于是他想要你的综合成绩评定\n\n综合成绩评定指：(每一科的满分之和\\*3-每一科的实际得分之和\\*2)÷每科所扣除分数的和。\n\n小奔想请你给出他的综合成绩，你能做到吗？", "inputFormat": "第一行给出一个整数$n$，表示科目的总数。\n第二行$n$个整数$a_i$,表示第$i$门课程的满分。\n第三行$n$个整数$b_i$,表示第$i$门课程小奔的实际得分。", "outputFormat": "一行一个数，表示他的综合成绩。结果保留$6$位小数", "hint": "对于$20$%的数据，数据为样例\n\n对于$100$%的数据，$n<=1e7$", "locale": "zh-CN", "translations": {"en": {"title": "Grades", "background": "Xiao Ben’s score.\n\nSolution: https://blog.csdn.net/kkkksc03/article/details/84928268\n\nOne note: the memory limit for this problem has been relaxed (but it seems you can get AC without even using arrays).", "description": "Xiao Ben’s final exams have ended.\n\nHis grades will be released soon.\n\nYou are given an exam score table, for example:\n\n| Subject / Score Type | Chinese | Math | English |\n| :------------------: | :-----: | :--: | :-----: |\n| Full score | $100$ | $120$ | $150$ |\n| Actual score | $99$ | $73$ | $100$ |\n\nOf course, the teachers at school think that entering so many grades makes it hard to calculate, so they want you to compute a comprehensive grade evaluation.\n\nThe comprehensive grade evaluation is defined as: $(\\text{sum of full scores} \\times 3 - \\text{sum of actual scores} \\times 2) \\div \\text{sum of points deducted for each subject}$.\n\nXiao Ben wants you to output his comprehensive grade. Can you do it?", "inputFormat": "The first line contains an integer $n$, the total number of subjects.  \nThe second line contains $n$ integers $a_i$, where $a_i$ is the full score of the $i$-th subject.  \nThe third line contains $n$ integers $b_i$, where $b_i$ is Xiao Ben’s actual score in the $i$-th subject.", "outputFormat": "Output one number in a single line, representing his comprehensive grade. Keep $6$ digits after the decimal point.", "hint": "For $20$% of the testdata, the data is the sample.\n\nFor $100$% of the testdata, $n \\le 1e7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "成绩", "background": "小奔的score\n\n题解：https://blog.csdn.net/kkkksc03/article/details/84928268\n\n说一句：本题已放开空间范围（不过真的貌似不用开数组就可以A呀", "description": "小奔的期末考试结束了。\n\n他的成绩不久之后就会发下来。\n\n给出一个考试成绩表格，例如：\n\n| 科目/分值种类 | 语文 | 数学|英语  |\n| :----------: | :----------: | :----------: | :----------: |\n|  满分| $100$ |$120$  |$150$  |\n| 实际得分 |  $99$|$73$  |$100$  |\n\n当然。学校的老师认为如果录入如此多的成绩不好算分，于是他想要你的综合成绩评定\n\n综合成绩评定指：(每一科的满分之和\\*3-每一科的实际得分之和\\*2)÷每科所扣除分数的和。\n\n小奔想请你给出他的综合成绩，你能做到吗？", "inputFormat": "第一行给出一个整数$n$，表示科目的总数。\n第二行$n$个整数$a_i$,表示第$i$门课程的满分。\n第三行$n$个整数$b_i$,表示第$i$门课程小奔的实际得分。", "outputFormat": "一行一个数，表示他的综合成绩。结果保留$6$位小数", "hint": "对于$20$%的数据，数据为样例\n\n对于$100$%的数据，$n<=1e7$", "locale": "zh-CN"}}}
{"pid": "P5083", "type": "P", "difficulty": 6, "samples": [["5 6\n1 1\n1 223", "11\n2\n224"]], "limits": {"time": [2000, 200, 2000, 2000, 2000, 2000, 2000, 2000, 200, 200], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "函数", "background": "", "description": "小奔有一个二元函数 $f(a,b)$。\n\n如果 $a<2$ 或 $b<2$ 返回 $a+b$。\n\n其他情况则返回以下四个式子的最大值（除号均为整除）：\n\n$$a+b$$\n\n$$g(a/2)+g(a/3)+g(a/8)+g(a/9)+b$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+a$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+g(a/2)+g(a/3)+g(a/8)+g(a/9)$$\n\n其中，$g(n)$ 返回 $\\max(g(n/2)+g(n/3)+g(n/8)+g(n/9),n)$，当 $n=0$ 时返回 $0$。\n\n当然，白痴都想得到可以记忆化求出较小的 $f(a,b)$，所以小奔才不会考你那么简单的题呢。\n\n他想问你当 $a,b$ 都小于 $10^{16}$ 时，$f(a,b)$ 的值。\n", "inputFormat": "包含多组数据。\n\n每组数据，包含一行，两个正整数 $a,b$。", "outputFormat": "每组数据输出一行，即 $f(a,b)$ 的值。\n", "hint": "对于 $40\\%$ 的数据，$a,b<10^7$。\n\n对于 $70\\%$ 的数据，时间限制 $2$ 秒。\n\n对于 $100\\%$ 的数据，$a,b<10^{16}$。数据组数不超过 $10^4$ 组。", "locale": "zh-CN", "translations": {"en": {"title": "Function", "background": "", "description": "Xiaoben has a binary function $f(a,b)$.\n\nIf $a<2$ or $b<2$, it returns $a+b$.\n\nOtherwise, it returns the maximum of the following four expressions (all divisions are integer divisions):\n\n$$a+b$$\n\n$$g(a/2)+g(a/3)+g(a/8)+g(a/9)+b$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+a$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+g(a/2)+g(a/3)+g(a/8)+g(a/9)$$\n\nHere, $g(n)$ returns $\\max(g(n/2)+g(n/3)+g(n/8)+g(n/9),n)$, and it returns $0$ when $n=0$.\n\nOf course, even an idiot can figure out that you can use memoization to compute smaller values of $f(a,b)$, so Xiaoben will not test you with such an easy problem.\n\nHe wants you to find the value of $f(a,b)$ when both $a$ and $b$ are less than $10^{16}$.", "inputFormat": "The input contains multiple test cases.\n\nEach test case consists of one line with two positive integers $a,b$.", "outputFormat": "For each test case, output one line containing the value of $f(a,b)$.", "hint": "For $40\\%$ of the testdata, $a,b<10^7$.\n\nFor $70\\%$ of the testdata, the time limit is $2$ seconds.\n\nFor $100\\%$ of the testdata, $a,b<10^{16}$. The number of test cases does not exceed $10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "函数", "background": "", "description": "小奔有一个二元函数 $f(a,b)$。\n\n如果 $a<2$ 或 $b<2$ 返回 $a+b$。\n\n其他情况则返回以下四个式子的最大值（除号均为整除）：\n\n$$a+b$$\n\n$$g(a/2)+g(a/3)+g(a/8)+g(a/9)+b$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+a$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+g(a/2)+g(a/3)+g(a/8)+g(a/9)$$\n\n其中，$g(n)$ 返回 $\\max(g(n/2)+g(n/3)+g(n/8)+g(n/9),n)$，当 $n=0$ 时返回 $0$。\n\n当然，白痴都想得到可以记忆化求出较小的 $f(a,b)$，所以小奔才不会考你那么简单的题呢。\n\n他想问你当 $a,b$ 都小于 $10^{16}$ 时，$f(a,b)$ 的值。\n", "inputFormat": "包含多组数据。\n\n每组数据，包含一行，两个正整数 $a,b$。", "outputFormat": "每组数据输出一行，即 $f(a,b)$ 的值。\n", "hint": "对于 $40\\%$ 的数据，$a,b<10^7$。\n\n对于 $70\\%$ 的数据，时间限制 $2$ 秒。\n\n对于 $100\\%$ 的数据，$a,b<10^{16}$。数据组数不超过 $10^4$ 组。", "locale": "zh-CN"}}}
{"pid": "P5084", "type": "P", "difficulty": 6, "samples": [["2 2\n9 18", "45"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递推"], "title": "轮换式", "background": null, "description": "小奔发现，对于任意的 $n$ 个字母，他们构成的轮换式，都表示成 $n$ 个基本 \n$1\\sim n$ 次基本轮换式的线性和。\n\n一元的基本轮换式：$a$；\n\n二元：$a+b,ab$；\n\n三元：$a+b+c,ab+ac+bc,abc$；\n\n四元：$a+b+c+d,ab+ac+bc+ad+bd+cd,abc+abd+acd+bcd,abcd$；\n\n………………\n\n同样的，对于任意的 $n$ 个字母，给出他们的几个基本轮换式，都可以求出这几个字母的值。\n\n但是小奔突然大发慈悲，他只需要你求出这些字母的 $m$ 次方和模 $10^7+29$ 的值。", "inputFormat": "第一行是字母个数 $n$，次数 $m$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个为 $a_i$ $(0<a_i\\le 10000)$，从左到右分别是 $1\\sim n$ 次 $n$ 元基本轮换式的值。", "outputFormat": "一个数，要求的答案。", "hint": "本题共有 $3$ 个子任务。\n\nSubtask 1（12 pts）：$n\\le 2$；\n\nSubtask 2（28 pts）：$n=3$；\n\nSubtask 3（60 pts）：$n=4$。\n\n对于所有数据，$0\\le m\\le 100000$。", "locale": "zh-CN", "translations": {"en": {"title": "Rotational Form", "background": "", "description": "Xiao Ben found that, for any $n$ letters, the “rotational form” they form can always be expressed as a linear combination of the $n$ basic rotational forms of degrees $1 \\sim n$.\n\nUnary basic rotational form: $a$.\n\nBinary: $a+b,ab$.\n\nTernary: $a+b+c,ab+ac+bc,abc$.\n\nQuaternary: $a+b+c+d,ab+ac+bc+ad+bd+cd,abc+abd+acd+bcd,abcd$.\n\nAnd so on.\n\nSimilarly, for any $n$ letters, if you are given several of their basic rotational forms, you can determine the values of these letters.\n\nHowever, Xiao Ben suddenly showed mercy: he only asks you to compute the sum of the $m$-th powers of these letters modulo $10^7+29$.", "inputFormat": "The first line contains the number of letters $n$ and the exponent $m$.\n\nThe next line contains $n$ positive integers. The $i$-th number is $a_i$ $(0<a_i\\le 10000)$, which from left to right are the values of the $n$-variable basic rotational forms of degrees $1 \\sim n$.", "outputFormat": "Output one number, the required answer.", "hint": "This problem has $3$ subtasks.\n\nSubtask 1 (12 pts): $n\\le 2$.\n\nSubtask 2 (28 pts): $n=3$.\n\nSubtask 3 (60 pts): $n=4$.\n\nFor all data, $0\\le m\\le 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "轮换式", "background": null, "description": "小奔发现，对于任意的 $n$ 个字母，他们构成的轮换式，都表示成 $n$ 个基本 \n$1\\sim n$ 次基本轮换式的线性和。\n\n一元的基本轮换式：$a$；\n\n二元：$a+b,ab$；\n\n三元：$a+b+c,ab+ac+bc,abc$；\n\n四元：$a+b+c+d,ab+ac+bc+ad+bd+cd,abc+abd+acd+bcd,abcd$；\n\n………………\n\n同样的，对于任意的 $n$ 个字母，给出他们的几个基本轮换式，都可以求出这几个字母的值。\n\n但是小奔突然大发慈悲，他只需要你求出这些字母的 $m$ 次方和模 $10^7+29$ 的值。", "inputFormat": "第一行是字母个数 $n$，次数 $m$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个为 $a_i$ $(0<a_i\\le 10000)$，从左到右分别是 $1\\sim n$ 次 $n$ 元基本轮换式的值。", "outputFormat": "一个数，要求的答案。", "hint": "本题共有 $3$ 个子任务。\n\nSubtask 1（12 pts）：$n\\le 2$；\n\nSubtask 2（28 pts）：$n=3$；\n\nSubtask 3（60 pts）：$n=4$。\n\n对于所有数据，$0\\le m\\le 100000$。", "locale": "zh-CN"}}}
{"pid": "P5085", "type": "P", "difficulty": 7, "samples": [["5 7 50 2 1\n1 2\n3 2", "5 1 1 0 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "大奔的方案", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/83188325\n\n五个海盗抢到了 $100$ 个金币，每一颗都一样的大小和价值连城。\n\n他们决定这么分： \n\n1. 抽签决定自己的号 $[1, 2, 3, 4, 5]$；\n2. 首先，由 $1$ 号提出分配方案，然后大家 $5$ 人进行表决，当且仅当不少于半数的人同意时，按照他的提案进行分配，否则将被扔入大海喂鲨鱼。\n3. 如果 $1$ 号死后，再由 $2$ 号提出分配方案，然后大家 $4$ 人进行表决，当且仅当不少于半数的人同意时，按照他的提案进行分配，否则将被扔入大海喂鲨鱼。 \n4. 以此类推……\n\n每个海盗都是很聪明的人，他们遵循如下原则：\n\n1. 保命；\n2. 如果满足条件 $1$，那么想办法获得更多的钱；\n3. 如果满足条件 $1, 2$，那么想办法杀更多的人。\n\n那么最终的分配方案会是怎样的呢？\n\n海盗们让小奔求出：若是 $N$ 个海盗抢到了 $M$ 个金币，并且要不少于 $P\\%$ 的人投赞成票，他们会如何分配呢？\n\n请你给出 $N$ 个海盗分 $M$ 个金币且要不少于 $P\\%$ 的人投赞成票的解法，并保证结果号码较小的分到的金币尽可能的多。\n\n**但是**，现实中并不会那么过于残忍，每个海盗也拥有自己的帮派，同一个帮派的人会互相投赞成票。\n\n作为友情的代价，那个人必须分自己帮派里的每个人一定的金币，如果有一个人（不包括自己）没有被满足，那么整个帮派的人会同时投反对票。\n\n新的结果又会是如何呢？", "description": "如果 A 和 B 是朋友，B 和 C 也是朋友，那么说 A、B、C 都是同一个帮派里的。\n\n现给出 $x$ 个兄弟关系，请你弄清其中的帮派关系，再求出 $n$ 个海盗分 $m$ 个金币的最新方法。\n\n毒瘤预警：\n\n**当然，你仍然需要保证结果号码较小的分到的金币尽可能的多，哪怕破坏帮派之间的关系。（自行理解）**", "inputFormat": "第一行，五个数 $n, m, p, x, k$ 之间用空格隔开，分别表示强盗数目，金币数目，最低赞成百分比，兄弟关系总数以及所谓的友情所需要的代价。\n\n接下来 $X$ 行，每行两个数，$i, j$，表示 $i$ 和 $j$ 是兄弟关系（或是说在同一个帮派）。", "outputFormat": "只有一行，$N$ 个数之间用空格隔开，表示最后的结果。\n\n如果某个海盗死了，输出 $-1$ 代替。", "hint": "### 数据范围及约定\n\n对于100%的数据：$1\\le n\\le 1000$，$0\\le m\\le 10^5$，$1\\le p\\le 100$，$1\\le x\\le 500$，$1\\le k\\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "Big Ben’s Plan.", "background": "Solution: https://blog.csdn.net/kkkksc03/article/details/83188325.\n\nFive pirates have seized $100$ gold coins, each of the same size and extremely valuable.\n\nThey decide to distribute them as follows:\n\n1. Draw lots to decide their numbers $[1, 2, 3, 4, 5]$.\n2. First, pirate $1$ proposes a distribution plan. Then all $5$ pirates vote. If and only if no fewer than half of them agree, the distribution is carried out according to his proposal; otherwise, he will be thrown into the sea to feed the sharks.\n3. If pirate $1$ dies, then pirate $2$ proposes a distribution plan. Then all $4$ remaining pirates vote. If and only if no fewer than half of them agree, the distribution is carried out according to his proposal; otherwise, he will be thrown into the sea to feed the sharks.\n4. And so on...\n\nEach pirate is very smart and follows these rules:\n\n1. Stay alive.\n2. If rule $1$ is satisfied, try to get as many coins as possible.\n3. If rules $1, 2$ are satisfied, try to kill as many people as possible.\n\nSo what will the final distribution plan be?\n\nThe pirates ask Xiao Ben to compute: if there are $N$ pirates who seized $M$ gold coins, and at least $P\\%$ of the voters must vote in favor, how will they distribute the coins?\n\nPlease give a method for $N$ pirates to split $M$ coins with at least $P\\%$ votes in favor, and ensure that pirates with smaller numbers receive as many coins as possible.\n\n**However**, in reality it will not be so cruel. Each pirate also has their own gang, and people in the same gang will vote in favor of each other.\n\nAs the price of friendship, the proposer must give every other person in their gang a certain number of coins. If any one person (excluding the proposer themself) is not satisfied, then everyone in that gang will vote against at the same time.\n\nWhat will the new result be?", "description": "If A and B are friends, and B and C are also friends, then A, B, and C are all in the same gang.\n\nNow you are given $x$ brotherhood relations. Please determine the gang relationships, and then find the new method for $n$ pirates to split $m$ coins.\n\nWarning: toxic problem.\n\n**Of course, you still need to ensure that pirates with smaller numbers receive as many coins as possible, even if it breaks relationships between gangs. (Figure it out yourself.)**", "inputFormat": "The first line contains five integers $n, m, p, x, k$ separated by spaces, representing the number of pirates, the number of coins, the minimum approval percentage, the total number of brotherhood relations, and the so-called friendship cost.\n\nThe next $X$ lines each contain two integers $i, j$, meaning $i$ and $j$ have a brotherhood relation (that is, they are in the same gang).", "outputFormat": "Only one line containing $N$ integers separated by spaces, representing the final result.\n\nIf a pirate dies, output $-1$ instead.", "hint": "### Constraints and Notes\n\nFor $100\\%$ of the testdata: $1\\le n\\le 1000$, $0\\le m\\le 10^5$, $1\\le p\\le 100$, $1\\le x\\le 500$, $1\\le k\\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "大奔的方案", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/83188325\n\n五个海盗抢到了 $100$ 个金币，每一颗都一样的大小和价值连城。\n\n他们决定这么分： \n\n1. 抽签决定自己的号 $[1, 2, 3, 4, 5]$；\n2. 首先，由 $1$ 号提出分配方案，然后大家 $5$ 人进行表决，当且仅当不少于半数的人同意时，按照他的提案进行分配，否则将被扔入大海喂鲨鱼。\n3. 如果 $1$ 号死后，再由 $2$ 号提出分配方案，然后大家 $4$ 人进行表决，当且仅当不少于半数的人同意时，按照他的提案进行分配，否则将被扔入大海喂鲨鱼。 \n4. 以此类推……\n\n每个海盗都是很聪明的人，他们遵循如下原则：\n\n1. 保命；\n2. 如果满足条件 $1$，那么想办法获得更多的钱；\n3. 如果满足条件 $1, 2$，那么想办法杀更多的人。\n\n那么最终的分配方案会是怎样的呢？\n\n海盗们让小奔求出：若是 $N$ 个海盗抢到了 $M$ 个金币，并且要不少于 $P\\%$ 的人投赞成票，他们会如何分配呢？\n\n请你给出 $N$ 个海盗分 $M$ 个金币且要不少于 $P\\%$ 的人投赞成票的解法，并保证结果号码较小的分到的金币尽可能的多。\n\n**但是**，现实中并不会那么过于残忍，每个海盗也拥有自己的帮派，同一个帮派的人会互相投赞成票。\n\n作为友情的代价，那个人必须分自己帮派里的每个人一定的金币，如果有一个人（不包括自己）没有被满足，那么整个帮派的人会同时投反对票。\n\n新的结果又会是如何呢？", "description": "如果 A 和 B 是朋友，B 和 C 也是朋友，那么说 A、B、C 都是同一个帮派里的。\n\n现给出 $x$ 个兄弟关系，请你弄清其中的帮派关系，再求出 $n$ 个海盗分 $m$ 个金币的最新方法。\n\n毒瘤预警：\n\n**当然，你仍然需要保证结果号码较小的分到的金币尽可能的多，哪怕破坏帮派之间的关系。（自行理解）**", "inputFormat": "第一行，五个数 $n, m, p, x, k$ 之间用空格隔开，分别表示强盗数目，金币数目，最低赞成百分比，兄弟关系总数以及所谓的友情所需要的代价。\n\n接下来 $X$ 行，每行两个数，$i, j$，表示 $i$ 和 $j$ 是兄弟关系（或是说在同一个帮派）。", "outputFormat": "只有一行，$N$ 个数之间用空格隔开，表示最后的结果。\n\n如果某个海盗死了，输出 $-1$ 代替。", "hint": "### 数据范围及约定\n\n对于100%的数据：$1\\le n\\le 1000$，$0\\le m\\le 10^5$，$1\\le p\\le 100$，$1\\le x\\le 500$，$1\\le k\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5086", "type": "P", "difficulty": 3, "samples": [["7\n1 2 3 4\n2 3 4 5\n1 4 3 3\n5 2 3 5\n2 4 5 6\n1 4 3 3\n2 5 4 4", "1 13"], ["10\n1 4 3 2\n4 4 4 4\n2 3 4 5\n1 1 1 1\n1 2 3 1\n3 4 2 1\n2 4 5 2\n8 9 7 6\n0 0 0 0\n1 2 3 4", "2 14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "排序"], "title": "坐标", "background": "题解：<https://blog.csdn.net/kkkksc03/article/details/84928342>。\n\n小奔知道 Minecraft 的坐标参数有三个，分别是 $X, Y, Z$，但是在小奔的眼中，有第四个参数 $Q$，表示对这个坐标的喜爱，比如有些位置是小奔的家，$Q$ 的值会大，而有些地方是危险的矿洞，所以 $Q$ 的值小。", "description": "有 $N$ 个坐标。对于第 $i$ 个坐标的参数 $\\{X _ i, Y _ i, Z _ i, Q _ i\\}$ 和 $\\{X _ j, Y _ j, Z _ j, Q _ j\\}$ 存在 $X _ i - X _ j = Y _ i - Y _ j = Z _ i - Z _ j = Q _ i - Q _ j$ 则称该坐标为优美坐标。现给出 $N$ 个坐标，小奔想知道所有优美坐标的 $j - i$ 的最小值和 $i + j$ 的最大值，你能帮帮他吗？", "inputFormat": "输入有 $n + 1$ 行，第一行为一个数 $n$，接下来输入 $n$ 行，每行 $X, Y, Z, Q$ 四个整数。", "outputFormat": "输出只有一行，包括 $j - i$ 的最小值和 $i + j$ 的最大值，中间用空格隔开，数据保证有解。", "hint": "### 样例 1 解释：\n\n$(1, 2, 3, 4)$ 和 $(2, 3, 4, 5)$ 或 $(1, 4, 3, 3)$ 和 $(2, 5, 4, 4)$ 构成最小值。\n\n$(1, 4, 3, 3)$ 和 $(2, 5, 4, 4)$，$6 + 7 = 13$ 为最大值。\n\n### 数据规模与约定\n\n对于 $30\\%$ 的数据，$n \\le 10 ^ 3$；    \n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10 ^ 5 $，$X, Y, Z, Q$ 均在 `int` 范围内。", "locale": "zh-CN", "translations": {"en": {"title": "Coordinates", "background": "Solution write-up: <https://blog.csdn.net/kkkksc03/article/details/84928342>.\n\nXiaoben knows that Minecraft coordinates have three parameters: $X$, $Y$, and $Z$. But in Xiaoben’s eyes, there is a fourth parameter $Q$, which represents how much he likes this location. For example, some places are Xiaoben’s home, so $Q$ will be large; some places are dangerous mines, so $Q$ will be small.", "description": "There are $N$ coordinates. For the $i$-th coordinate with parameters $\\{X _ i, Y _ i, Z _ i, Q _ i\\}$ and the $j$-th coordinate with parameters $\\{X _ j, Y _ j, Z _ j, Q _ j\\}$, if\n$X _ i - X _ j = Y _ i - Y _ j = Z _ i - Z _ j = Q _ i - Q _ j$,\nthen these coordinates are called beautiful coordinates.\n\nGiven $N$ coordinates, Xiaoben wants to know the minimum value of $j - i$ and the maximum value of $i + j$ among all beautiful coordinate pairs. Can you help him?", "inputFormat": "The input has $n + 1$ lines. The first line contains an integer $n$. Then follow $n$ lines, each containing four integers $X$, $Y$, $Z$, and $Q$.", "outputFormat": "Output one line containing the minimum value of $j - i$ and the maximum value of $i + j$, separated by a space. The testdata guarantees that a solution exists.", "hint": "### Explanation for Sample 1\n\n$(1, 2, 3, 4)$ and $(2, 3, 4, 5)$, or $(1, 4, 3, 3)$ and $(2, 5, 4, 4)$, achieve the minimum value.\n\nFor $(1, 4, 3, 3)$ and $(2, 5, 4, 4)$, $6 + 7 = 13$ is the maximum value.\n\n### Constraints\n\nFor $30\\%$ of the data, $n \\le 10 ^ 3$.\n\nFor $100\\%$ of the data, $1 \\le n \\le 5 \\times 10 ^ 5$, and $X$, $Y$, $Z$, $Q$ are all within the `int` range.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "坐标", "background": "题解：<https://blog.csdn.net/kkkksc03/article/details/84928342>。\n\n小奔知道 Minecraft 的坐标参数有三个，分别是 $X, Y, Z$，但是在小奔的眼中，有第四个参数 $Q$，表示对这个坐标的喜爱，比如有些位置是小奔的家，$Q$ 的值会大，而有些地方是危险的矿洞，所以 $Q$ 的值小。", "description": "有 $N$ 个坐标。对于第 $i$ 个坐标的参数 $\\{X _ i, Y _ i, Z _ i, Q _ i\\}$ 和 $\\{X _ j, Y _ j, Z _ j, Q _ j\\}$ 存在 $X _ i - X _ j = Y _ i - Y _ j = Z _ i - Z _ j = Q _ i - Q _ j$ 则称该坐标为优美坐标。现给出 $N$ 个坐标，小奔想知道所有优美坐标的 $j - i$ 的最小值和 $i + j$ 的最大值，你能帮帮他吗？", "inputFormat": "输入有 $n + 1$ 行，第一行为一个数 $n$，接下来输入 $n$ 行，每行 $X, Y, Z, Q$ 四个整数。", "outputFormat": "输出只有一行，包括 $j - i$ 的最小值和 $i + j$ 的最大值，中间用空格隔开，数据保证有解。", "hint": "### 样例 1 解释：\n\n$(1, 2, 3, 4)$ 和 $(2, 3, 4, 5)$ 或 $(1, 4, 3, 3)$ 和 $(2, 5, 4, 4)$ 构成最小值。\n\n$(1, 4, 3, 3)$ 和 $(2, 5, 4, 4)$，$6 + 7 = 13$ 为最大值。\n\n### 数据规模与约定\n\n对于 $30\\%$ 的数据，$n \\le 10 ^ 3$；    \n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10 ^ 5 $，$X, Y, Z, Q$ 均在 `int` 范围内。", "locale": "zh-CN"}}}
{"pid": "P5087", "type": "P", "difficulty": 3, "samples": [["3 3\n1 1 1", "1"], ["4 3\n1 1 1 2", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "数学", "background": "在```小奔```这片神奇的土地上，有一个毒瘤教练```小奔```。\n\n题解：https://blog.csdn.net/kkkksc03/article/details/84928333", "description": "小奔热衷于乘法，他最喜欢做的事情是：从一个有 $N$ 个元素的序列里取出 $K$ 个数，（注意：不能取同一个元素好几次，取不同但是值相同的元素则是允许的）\n然后算出这$K$个数的积作为这个组合的分数。\n\n小奔想试遍所有的这些组合，然后算出所有这些组合的分数之和。但是他还要\n出模拟赛虐爆我们这些蒟蒻，所以他只好把这个任务交给了你。\n\n小奔（~~在某些方面~~）还是很仁慈的，所以你不用写高精度，只要输出答案取模 $10^9+7$ 的结果就可以了。", "inputFormat": "第一行两个整数 $N$ 和 $K$。\n\n第二行 $N$ 个整数 $A_i$ 描述序列。", "outputFormat": "一行一个整数表示答案。", "hint": "#### 样例#2解释：\n\n```小奔```可以取```{A[1],A[2],A[3]},{A[1],A[2],A[4]},{A[1],A[3],A[4]},{A[2],A[3],A[4]}```四种组合，它们的分值分别是 $1,2,2,2$。加起来就是 $7$。\n\n#### 数据范围：\n\n对于 $10\\%$ 的数据，$N\\le 5000,K\\le 2$；\n\n对于 $30\\%$ 的数据，$N\\le 10^5,K\\le 3$；\n\n对于 $50\\%$ 的数据，$N\\le 10^5,K\\le 5$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5,1\\le K \\le 300 \\& \\& K\\le N,1\\le A[i]\\le 10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "Math.", "background": "On the magical land of `Xiaoben`, there is an infamous coach `Xiaoben`.\n\nSolution write-up: https://blog.csdn.net/kkkksc03/article/details/84928333.", "description": "`Xiaoben` loves multiplication. His favorite thing to do is: choose $K$ numbers from a sequence with $N$ elements (note: you cannot choose the same element multiple times, but choosing different elements with the same value is allowed), and then take the product of these $K$ numbers as the score of this combination.\n\n`Xiaoben` wants to try all such combinations and compute the sum of the scores of all combinations. But he also needs to run a mock contest to crush us newbies, so he has to hand this task to you.\n\n`Xiaoben` (~~in some ways~~) is still very kind, so you do not need to use big integers. You only need to output the answer modulo $10^9+7$.", "inputFormat": "The first line contains two integers $N$ and $K$.\n\nThe second line contains $N$ integers $A_i$ describing the sequence.", "outputFormat": "Output one integer in one line, representing the answer.", "hint": "#### Explanation for Sample #2:\n\n`Xiaoben` can choose four combinations: `{A[1],A[2],A[3]},{A[1],A[2],A[4]},{A[1],A[3],A[4]},{A[2],A[3],A[4]}`. Their scores are $1,2,2,2$ respectively. The total is $7$.\n\n#### Constraints:\n\nFor $10\\%$ of the testdata, $N\\le 5000, K\\le 2$.\n\nFor $30\\%$ of the testdata, $N\\le 10^5, K\\le 3$.\n\nFor $50\\%$ of the testdata, $N\\le 10^5, K\\le 5$.\n\nFor $100\\%$ of the testdata, $1\\le N\\le 10^5, 1\\le K \\le 300 \\& \\& K\\le N, 1\\le A[i]\\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "数学", "background": "在```小奔```这片神奇的土地上，有一个毒瘤教练```小奔```。\n\n题解：https://blog.csdn.net/kkkksc03/article/details/84928333", "description": "小奔热衷于乘法，他最喜欢做的事情是：从一个有 $N$ 个元素的序列里取出 $K$ 个数，（注意：不能取同一个元素好几次，取不同但是值相同的元素则是允许的）\n然后算出这$K$个数的积作为这个组合的分数。\n\n小奔想试遍所有的这些组合，然后算出所有这些组合的分数之和。但是他还要\n出模拟赛虐爆我们这些蒟蒻，所以他只好把这个任务交给了你。\n\n小奔（~~在某些方面~~）还是很仁慈的，所以你不用写高精度，只要输出答案取模 $10^9+7$ 的结果就可以了。", "inputFormat": "第一行两个整数 $N$ 和 $K$。\n\n第二行 $N$ 个整数 $A_i$ 描述序列。", "outputFormat": "一行一个整数表示答案。", "hint": "#### 样例#2解释：\n\n```小奔```可以取```{A[1],A[2],A[3]},{A[1],A[2],A[4]},{A[1],A[3],A[4]},{A[2],A[3],A[4]}```四种组合，它们的分值分别是 $1,2,2,2$。加起来就是 $7$。\n\n#### 数据范围：\n\n对于 $10\\%$ 的数据，$N\\le 5000,K\\le 2$；\n\n对于 $30\\%$ 的数据，$N\\le 10^5,K\\le 3$；\n\n对于 $50\\%$ 的数据，$N\\le 10^5,K\\le 5$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5,1\\le K \\le 300 \\& \\& K\\le N,1\\le A[i]\\le 10^8$。", "locale": "zh-CN"}}}
{"pid": "P5088", "type": "P", "difficulty": 5, "samples": [["3 4\n1 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "矩形", "background": "小奔月考考的可棒了！作为奖励，老师给了他一只激光笔。", "description": "但老师永远不是白给小奔奖品的。他告诉小奔：反射角等于入射角。并让他解决下面的问题：\n\n如果有一个矩形，长和宽之比为 $N:M$，现在有一束激光从左上角射出，且与长 $N$ 的夹角为 $\\zeta°$（$0\\le \\zeta° \\le 90$），且满足 $\\cot \\zeta°  = A:B$，求最少需要多少次反射才能重新反射入四个角当中的任意一个角呢？\n\n![](https://cdn.luogu.com.cn/upload/pic/37985.png)", "inputFormat": "两行，第一行两个数 $N$，$M$，表示长和宽之比；\n\n第二行两个数 $A$，$B$，表示 $\\cot\\zeta°$ 。", "outputFormat": "一个正整数，表示最少需要的反射次数。", "hint": "对于 $10\\%$ 的数据, $A=B=1$。\n\n对于另 $10\\%$ 的数据，$N=M$。\n\n对于 $50\\%$ 的数据，$0\\le A,B,M,N\\le10^5$。\n\n对于 $100\\%$ 的数据，$0\\le A,B,M,N\\le10^{10}$。", "locale": "zh-CN", "translations": {"en": {"title": "Rectangle", "background": "Xiao Ben did very well on the monthly exam. As a reward, the teacher gave him a laser pointer.", "description": "However, the teacher never gives Xiao Ben a prize for free. He told Xiao Ben that the angle of reflection equals the angle of incidence, and asked him to solve the following problem.\n\nGiven a rectangle whose length-to-width ratio is $N:M$. A laser beam is emitted from the top-left corner, and the angle between the beam and the side of length $N$ is $\\zeta°$ ($0\\le \\zeta° \\le 90$). It also satisfies $\\cot \\zeta° = A:B$. Find the minimum number of reflections needed for the beam to enter (after reflections) any one of the four corners again.\n\n![](https://cdn.luogu.com.cn/upload/pic/37985.png)", "inputFormat": "Two lines.\n\nThe first line contains two numbers $N$ and $M$, representing the ratio of the length to the width.\n\nThe second line contains two numbers $A$ and $B$, representing $\\cot\\zeta°$.", "outputFormat": "One positive integer, representing the minimum number of reflections needed.", "hint": "For $10\\%$ of the testdata, $A=B=1$.\n\nFor another $10\\%$ of the testdata, $N=M$.\n\nFor $50\\%$ of the testdata, $0\\le A,B,M,N\\le10^5$.\n\nFor $100\\%$ of the testdata, $0\\le A,B,M,N\\le10^{10}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "矩形", "background": "小奔月考考的可棒了！作为奖励，老师给了他一只激光笔。", "description": "但老师永远不是白给小奔奖品的。他告诉小奔：反射角等于入射角。并让他解决下面的问题：\n\n如果有一个矩形，长和宽之比为 $N:M$，现在有一束激光从左上角射出，且与长 $N$ 的夹角为 $\\zeta°$（$0\\le \\zeta° \\le 90$），且满足 $\\cot \\zeta°  = A:B$，求最少需要多少次反射才能重新反射入四个角当中的任意一个角呢？\n\n![](https://cdn.luogu.com.cn/upload/pic/37985.png)", "inputFormat": "两行，第一行两个数 $N$，$M$，表示长和宽之比；\n\n第二行两个数 $A$，$B$，表示 $\\cot\\zeta°$ 。", "outputFormat": "一个正整数，表示最少需要的反射次数。", "hint": "对于 $10\\%$ 的数据, $A=B=1$。\n\n对于另 $10\\%$ 的数据，$N=M$。\n\n对于 $50\\%$ 的数据，$0\\le A,B,M,N\\le10^5$。\n\n对于 $100\\%$ 的数据，$0\\le A,B,M,N\\le10^{10}$。", "locale": "zh-CN"}}}
{"pid": "P5089", "type": "P", "difficulty": 5, "samples": [["2 2 3\n1 2\n2 2\n2 1", "0"], ["1 5 3\n1 3\n1 1\n1 5", "2"], ["4 3 6\n1 2\n1 3\n2 2\n2 3\n3 1\n3 3", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "eJOI（欧洲）"], "title": "[eJOI 2018] 元素周期表", "background": "**本题译自 [eJOI2018](http://ejoi2018.org/) Problem D「Chemical table」**\n\n", "description": "Innopolis 大学的教授正努力研究元素周期表。他们知道，有 $n \\times m$ 种元素，形成了一个 $n$ 行 $m$ 列的矩阵。\n\n研究表明，如果元素周期表上有一个元素 A，且元素 B 与它在同一列（A 与 B 不能在同一周期），元素 C 在同一周期（A 与 C 不能在同一列），那么，科学家就可以用这三种元素通过核聚变合成第四种元素 D 的样品，D 与 B 在同一周期，与 C 在同一列。  \n简而言之，如果有在元素周期表中位置为 $(r_1, c_1),\\ (r_1, c_2),\\ (r_2, c_1)$ （其中 $r_1 \\neq r_2, c_1 \\neq c_2$）的三种元素的样品，就可以生成位置为 $(r_2, c_2)$ 的样品。如图所示：\n\n![](http://codeforces.com/predownloaded/95/22/95223620a323ec59470718b34958c7f295698ff1.png)\n\n**注意：在核聚变中被使用的样品并不会消失，它们可以参与之后的反应；反应得到的样品也可以参与反应。**\n\n他们已经获得了 $q$ 种元素的样品。为了集齐所有元素的样品，他们会购买一些样品，然后利用核聚变制造出剩下元素的样品。  \n请求出他们至少需要购买的元素样品的数量。", "inputFormat": "第一行， $3$ 个整数 $n, m, q \\ (1 \\le n, m \\le 2 \\times 10^5, 0 \\le q \\le \\min \\{n \\times m, 2 \\times 10^5\\})$ 。  \n之后的 $q$ 行，每行 $2$ 个整数 $r_i, c_i \\ (1 \\le r_i \\le n, 1 \\le c_i \\le m)$ 。保证给定的元素互不相同。", "outputFormat": "输出一个整数，表示至少需要购买的元素样品的数量。", "hint": "### 样例解释\n\n#### 说明\n每个样例解释中有两个矩阵。  \n第一个表示初始状况（其中，**打叉的是原本就有样品的元素**）。  \n第二个表示最终集齐样品时的状况（其中，**蓝圈代表核聚变得到的样品，蓝圈中的数字表示得到样品的顺序，红圈表示购买的样品**）。\n\n#### 样例解释 1\n\n通过给定的三种元素，可以得到第四种元素的样品。\n\n![](http://codeforces.com/predownloaded/ee/44/ee44494c3f7ff02138d16c3ee2119a4a528c893a.png)\n\n#### 样例解释 2\n\n由于给定的元素只有一行，无法使用核聚变，只能购买剩余的两种元素的样品。\n\n![](http://codeforces.com/predownloaded/db/b4/dbb4c8c683b0e23a35c204b500695c0efb59e587.png)\n\n#### 样例解释 3\n\n集齐所有元素的方法不唯一，以下是一种方法。其中，元素 $(4, 2)$ 只有在购买元素 $(4, 1)$ 的样品，和反应得到元素 $(1, 1)$的样品后才能得到。\n\n![](http://codeforces.com/predownloaded/0c/d8/0cd813ff41b05914fceb0e1f25c2907bcb020959.png)\n\n---\n\n### 子任务 \n\n**注意：当且仅当你通过了一个子任务下的所有测试点，你将获得此子任务的分数。**  \n\n\n|子任务编号|分数|$n$|$m$|$q$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$n=2$|$m=2$|$0 \\le q \\le 4$|\n|$2$|$17$|$1 \\le n \\le 2$|$1 \\le m \\le 20$|$0 \\le q \\le 20$|\n|$3$|$8$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$q=0$|\n|$4$|$20$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$0 \\le q \\le 400$|\n|$5$|$30$|$1 \\le n \\le 1 \\times 10^4$|$1 \\le m \\le 1 \\times 10^4$|$1 \\le q \\le 1 \\times 10^5$|\n|$6$|$15$|$1 \\le n \\le 2 \\times 10^5$|$1 \\le m \\le 2 \\times 10^5$|$1 \\le q \\le 2 \\times 10^5$|", "locale": "zh-CN", "translations": {"en": {"title": "[eJOI 2018] Periodic Table of Elements", "background": "**This problem is translated from [eJOI2018](http://ejoi2018.org/) Problem D “Chemical table”.**", "description": "Professors at Innopolis University are working hard on studying the periodic table of elements. They know that there are $n \\times m$ elements, forming a matrix with $n$ rows and $m$ columns.\n\nResearch shows that if there is an element $A$ in the periodic table, element $B$ is in the same column as it (but $A$ and $B$ cannot be in the same row), and element $C$ is in the same row as it (but $A$ and $C$ cannot be in the same column), then scientists can use these three elements to produce a sample of a fourth element $D$ by nuclear fusion. Element $D$ is in the same row as $B$ and in the same column as $C$.  \nIn short, if there are samples of three elements located at $(r_1, c_1),\\ (r_1, c_2),\\ (r_2, c_1)$ in the periodic table (where $r_1 \\neq r_2, c_1 \\neq c_2$), then a sample at $(r_2, c_2)$ can be produced, as shown in the figure:\n\n![](http://codeforces.com/predownloaded/95/22/95223620a323ec59470718b34958c7f295698ff1.png)\n\n**Note: The samples used in nuclear fusion do not disappear; they can take part in later reactions. Samples obtained from reactions can also take part in reactions.**\n\nThey have already obtained samples of $q$ elements. To collect samples of all elements, they will buy some samples and then use nuclear fusion to produce the remaining ones.  \nPlease find the minimum number of element samples they need to buy.", "inputFormat": "The first line contains $3$ integers $n, m, q \\ (1 \\le n, m \\le 2 \\times 10^5, 0 \\le q \\le \\min \\{n \\times m, 2 \\times 10^5\\})$.  \nThe next $q$ lines each contain $2$ integers $r_i, c_i \\ (1 \\le r_i \\le n, 1 \\le c_i \\le m)$. It is guaranteed that all given elements are distinct.", "outputFormat": "Output one integer, the minimum number of element samples that need to be bought.", "hint": "### Sample Explanation\n\n#### Notes\nIn each sample explanation, there are two matrices.  \nThe first shows the initial state (where **crosses mark the elements that already have samples**).  \nThe second shows the final state when all samples have been collected (where **blue circles represent samples obtained by nuclear fusion, the number inside a blue circle is the order in which it was obtained, and red circles represent purchased samples**).\n\n#### Sample Explanation 1\n\nWith the three given elements, a sample of the fourth element can be obtained.\n\n![](http://codeforces.com/predownloaded/ee/44/ee44494c3f7ff02138d16c3ee2119a4a528c893a.png)\n\n#### Sample Explanation 2\n\nSince the given elements are only in one row, nuclear fusion cannot be used, so the remaining two element samples can only be purchased.\n\n![](http://codeforces.com/predownloaded/db/b4/dbb4c8c683b0e23a35c204b500695c0efb59e587.png)\n\n#### Sample Explanation 3\n\nThe method for collecting all elements is not unique; the following is one possible method. In this method, element $(4, 2)$ can only be obtained after purchasing a sample of element $(4, 1)$ and obtaining a sample of element $(1, 1)$ from reactions.\n\n![](http://codeforces.com/predownloaded/0c/d8/0cd813ff41b05914fceb0e1f25c2907bcb020959.png)\n\n---\n\n### Subtasks\n\n**Note: You will receive the score for a subtask if and only if you pass all test points in that subtask.**\n\n|Subtask ID|Score|$n$|$m$|$q$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$n=2$|$m=2$|$0 \\le q \\le 4$|\n|$2$|$17$|$1 \\le n \\le 2$|$1 \\le m \\le 20$|$0 \\le q \\le 20$|\n|$3$|$8$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$q=0$|\n|$4$|$20$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$0 \\le q \\le 400$|\n|$5$|$30$|$1 \\le n \\le 1 \\times 10^4$|$1 \\le m \\le 1 \\times 10^4$|$1 \\le q \\le 1 \\times 10^5$|\n|$6$|$15$|$1 \\le n \\le 2 \\times 10^5$|$1 \\le m \\le 2 \\times 10^5$|$1 \\le q \\le 2 \\times 10^5$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[eJOI 2018] 元素周期表", "background": "**本题译自 [eJOI2018](http://ejoi2018.org/) Problem D「Chemical table」**\n\n", "description": "Innopolis 大学的教授正努力研究元素周期表。他们知道，有 $n \\times m$ 种元素，形成了一个 $n$ 行 $m$ 列的矩阵。\n\n研究表明，如果元素周期表上有一个元素 A，且元素 B 与它在同一列（A 与 B 不能在同一周期），元素 C 在同一周期（A 与 C 不能在同一列），那么，科学家就可以用这三种元素通过核聚变合成第四种元素 D 的样品，D 与 B 在同一周期，与 C 在同一列。  \n简而言之，如果有在元素周期表中位置为 $(r_1, c_1),\\ (r_1, c_2),\\ (r_2, c_1)$ （其中 $r_1 \\neq r_2, c_1 \\neq c_2$）的三种元素的样品，就可以生成位置为 $(r_2, c_2)$ 的样品。如图所示：\n\n![](http://codeforces.com/predownloaded/95/22/95223620a323ec59470718b34958c7f295698ff1.png)\n\n**注意：在核聚变中被使用的样品并不会消失，它们可以参与之后的反应；反应得到的样品也可以参与反应。**\n\n他们已经获得了 $q$ 种元素的样品。为了集齐所有元素的样品，他们会购买一些样品，然后利用核聚变制造出剩下元素的样品。  \n请求出他们至少需要购买的元素样品的数量。", "inputFormat": "第一行， $3$ 个整数 $n, m, q \\ (1 \\le n, m \\le 2 \\times 10^5, 0 \\le q \\le \\min \\{n \\times m, 2 \\times 10^5\\})$ 。  \n之后的 $q$ 行，每行 $2$ 个整数 $r_i, c_i \\ (1 \\le r_i \\le n, 1 \\le c_i \\le m)$ 。保证给定的元素互不相同。", "outputFormat": "输出一个整数，表示至少需要购买的元素样品的数量。", "hint": "### 样例解释\n\n#### 说明\n每个样例解释中有两个矩阵。  \n第一个表示初始状况（其中，**打叉的是原本就有样品的元素**）。  \n第二个表示最终集齐样品时的状况（其中，**蓝圈代表核聚变得到的样品，蓝圈中的数字表示得到样品的顺序，红圈表示购买的样品**）。\n\n#### 样例解释 1\n\n通过给定的三种元素，可以得到第四种元素的样品。\n\n![](http://codeforces.com/predownloaded/ee/44/ee44494c3f7ff02138d16c3ee2119a4a528c893a.png)\n\n#### 样例解释 2\n\n由于给定的元素只有一行，无法使用核聚变，只能购买剩余的两种元素的样品。\n\n![](http://codeforces.com/predownloaded/db/b4/dbb4c8c683b0e23a35c204b500695c0efb59e587.png)\n\n#### 样例解释 3\n\n集齐所有元素的方法不唯一，以下是一种方法。其中，元素 $(4, 2)$ 只有在购买元素 $(4, 1)$ 的样品，和反应得到元素 $(1, 1)$的样品后才能得到。\n\n![](http://codeforces.com/predownloaded/0c/d8/0cd813ff41b05914fceb0e1f25c2907bcb020959.png)\n\n---\n\n### 子任务 \n\n**注意：当且仅当你通过了一个子任务下的所有测试点，你将获得此子任务的分数。**  \n\n\n|子任务编号|分数|$n$|$m$|$q$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$n=2$|$m=2$|$0 \\le q \\le 4$|\n|$2$|$17$|$1 \\le n \\le 2$|$1 \\le m \\le 20$|$0 \\le q \\le 20$|\n|$3$|$8$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$q=0$|\n|$4$|$20$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$0 \\le q \\le 400$|\n|$5$|$30$|$1 \\le n \\le 1 \\times 10^4$|$1 \\le m \\le 1 \\times 10^4$|$1 \\le q \\le 1 \\times 10^5$|\n|$6$|$15$|$1 \\le n \\le 2 \\times 10^5$|$1 \\le m \\le 2 \\times 10^5$|$1 \\le q \\le 2 \\times 10^5$|", "locale": "zh-CN"}}}
{"pid": "P5090", "type": "P", "difficulty": 7, "samples": [["2\n6\n1 3\n3 5\n3 6\n6 4\n6 2\n6\n1 2\n1 3\n1 4\n1 5\n1 6", "2 5 3 1 4 6\n5 1 2 3 4 6\n\n4 5 1 3 6 2 \n5 4 6 1 3 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "提交答案", "Special Judge", "eJOI（欧洲）"], "title": "[eJOI 2018] 互素树", "background": "**本题译自 [eJOI2018](http://ejoi2018.org/) Problem E「Prime Tree」**\n\n", "description": "本题为提交答案，输入文件在附件中。\n\n设有一棵有 $n$ 个结点的树，其结点编号为 $1$ 到 $n$ 。  \n对于其中的任意一条边 $(u, v)$ ，如果存在一个正整数 $d>1$ 满足 $ d \\mid u, d\\mid v$ ，我们称它为一条**坏的边**。  \n下图中的树有三条坏的边—— $(6, 4)$（都被 $2$ 整除）， $(2, 6)$（都被 $2$ 整除）， $(3, 6)$（都被 $3$ 整除）。\n\n![](https://i.loli.net/2018/08/17/5b7633a4ceb38.png)\n\n你的任务是将结点重新编号，使得图中坏的边的数量尽量少。  \n对于上图中的树，按照下图中的方式将结点重新编号，会只剩一条坏的边 $(3, 6)$ 。\n\n![](https://i.loli.net/2018/08/17/5b7633a4cfebf.png)\n\n重新编号后，坏的边越少，你的得分越高。\n\n**这是一道提交答案题。你应当下载输出文件，然后在本地运行你的程序，将输出结果上传**。当然，在洛谷上你可以直接提交你的程序。", "inputFormat": "每个测试点中有多组测试数据。  \n第一行，一个整数 $T$，表示测试数据组数。  \n每组测试数据共 $n$ 行，其中 $n$ 表示树的结点个数。  \n第一行，一个整数 $n$；  \n接下来 $n-1$ 行，每行两个整数 $u$ 和 $v\\ ( 1 \\le u, v \\le n)$，表示一条边 $(u,v)$ 。\n\n**每个输入文件中，每棵树的结点个数相同。**", "outputFormat": "对于每组测试数据，输出一行 $n$ 个整数，表示原先编号为 $1$ 到 $n$ 的结点的新编号。   \n**每个结点的编号必须不同，也就是说同一组测试数据中输出的 $n$ 个整数必须互不相同。**", "hint": "### 计分方式\n对于每个测试点，设所有树的总边数为 $M=T \\times (n-1)$，你的输出中坏的边数为 $X$，记 $R=\\dfrac{X}{M}$ ，你的得分与 $R$ 的关系如下：\n\n|$R$|得分|$R$|得分|\n|:-:|:-:|:-:|:-:|\n|$0.33 < R \\le 0.4$|$1$|$0.01 < R \\le 0.05$|$6$|\n|$0.26 < R \\le 0.33$|$2$|$0.005 < R \\le 0.01$|$7$|\n|$0.19 < R \\le 0.26$|$3$|$0.001 < R \\le 0.005$|$8$|\n|$0.12 < R \\le 0.19$|$4$|$0  < R \\le 0.001$|$9$|\n|$0.05 < R \\le 0.12$|$5$|$R=0$|$10$|\n\n当 $R > 0.4$ 时，不能得分。\n\n**对于所有的测试点，保证存在 $X=0$ 的输出。**\n\n---\n\n### 样例解释\n注意样例中给出了两种合法的输出，为了方便，下称输出 1 和 输出 2。\n\n第一组测试数据已经在题目描述中讨论过。输出 1 中有一条坏的边 $(3, 6)$，输出 2 中没有坏的边。  \n第二组测试数据中，输出 1 和输出 2 都没有出现坏的边。\n\n样例中，$M=2 \\times 5=10$。  \n\n对于输出 1，$X=1, R=\\dfrac{1}{10}=0.1$，该输出将得到 $5$ 分。\n\n对于输出 2，$X=0, R=\\dfrac{0}{10}=0$，该输出将得到 $10$ 分。\n\n---\n\n### 数据范围和限制\n\n#### 数据限制\n- 对于测试点 1 （输入 `01`），$T=3, n=7$，三棵树分别如下所示：\n\n![](https://i.loli.net/2018/08/17/5b765edf30647.png)\n\n- 对于测试点 4 至 8 （输入 `04` 至 `08`），输入数据有特殊性质（如叶子结点较多，是二叉树等），且这些具有特殊性质的树在各个测试点中输入数据均匀分布。\n\n- 对于其他测试点，数据为随机生成。  \n\n#### 数据范围\n\n|测试点编号|1|2|3|4|5|6|7|8|9|10|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|文件名|`01`|`02`|`03`|`04`|`05`|`06`|`07`|`08`|`09`|`10`|\n|$T$|$3$|$100$|$100$|$500$|$200$|$50$|$10$|$5$|$2$|$1$|\n|$n$|$7$|$10$|$30$|$100$|$500$|$2000$|$10000$|$20000$|$50000$|$100000$|", "locale": "zh-CN", "translations": {"en": {"title": "[eJOI 2018] Coprime Tree", "background": "**This problem is translated from [eJOI2018](http://ejoi2018.org/) Problem E \"Prime Tree\".**", "description": "This is an output-only problem. The input files are provided in the attachments.\n\nThere is a tree with $n$ nodes, numbered from $1$ to $n$.  \nFor any edge $(u, v)$, if there exists a positive integer $d > 1$ such that $d \\mid u$ and $d \\mid v$, then we call it a **bad edge**.  \nIn the tree shown below, there are three bad edges: $(6, 4)$ (both divisible by $2$), $(2, 6)$ (both divisible by $2$), and $(3, 6)$ (both divisible by $3$).\n\n![](https://i.loli.net/2018/08/17/5b7633a4ceb38.png)\n\nYour task is to renumber the nodes so that the number of bad edges is as small as possible.  \nFor the tree above, if you renumber the nodes as in the figure below, there will be only one bad edge left, $(3, 6)$.\n\n![](https://i.loli.net/2018/08/17/5b7633a4cfebf.png)\n\nAfter renumbering, the fewer bad edges you have, the higher your score will be.\n\n**This is an output-only problem. You should download the output file, then run your program locally and upload the output result.** Of course, on Luogu you may also submit your program directly.", "inputFormat": "Each test point contains multiple groups of testdata.  \nThe first line contains an integer $T$, the number of testdata groups.  \nEach group of testdata has $n$ lines in total, where $n$ is the number of nodes in the tree.  \nThe first line contains an integer $n$.  \nThe next $n - 1$ lines each contain two integers $u$ and $v \\ (1 \\le u, v \\le n)$, representing an edge $(u, v)$.\n\n**In each input file, all trees have the same number of nodes.**", "outputFormat": "For each group of testdata, output one line with $n$ integers, representing the new labels of the nodes originally labeled from $1$ to $n$.  \n**All node labels must be different. That is, the $n$ integers you output for the same group of testdata must be pairwise distinct.**", "hint": "### Scoring\n\nFor each test point, let the total number of edges in all trees be $M = T \\times (n - 1)$. Let the number of bad edges in your output be $X$, and define $R = \\dfrac{X}{M}$. Your score as a function of $R$ is as follows:\n\n|$R$|Score|$R$|Score|\n|:-:|:-:|:-:|:-:|\n|$0.33 < R \\le 0.4$|$1$|$0.01 < R \\le 0.05$|$6$|\n|$0.26 < R \\le 0.33$|$2$|$0.005 < R \\le 0.01$|$7$|\n|$0.19 < R \\le 0.26$|$3$|$0.001 < R \\le 0.005$|$8$|\n|$0.12 < R \\le 0.19$|$4$|$0  < R \\le 0.001$|$9$|\n|$0.05 < R \\le 0.12$|$5$|$R = 0$|$10$|\n\nWhen $R > 0.4$, you get no score.\n\n**For all test points, it is guaranteed that an output with $X = 0$ exists.**\n\n---\n\n### Sample Explanation\n\nNote that the sample provides two valid outputs. For convenience, call them Output 1 and Output 2.\n\nThe first group of testdata has already been discussed in the statement. In Output 1 there is one bad edge $(3, 6)$, while in Output 2 there are no bad edges.  \nIn the second group of testdata, neither Output 1 nor Output 2 contains any bad edges.\n\nIn the sample, $M = 2 \\times 5 = 10$.\n\nFor Output 1, $X = 1, R = \\dfrac{1}{10} = 0.1$, so this output gets $5$ points.\n\nFor Output 2, $X = 0, R = \\dfrac{0}{10} = 0$, so this output gets $10$ points.\n\n---\n\n### Constraints and Limits\n\n#### Limits\n- For test point 1 (input `01`), $T = 3, n = 7$. The three trees are as follows:\n\n![](https://i.loli.net/2018/08/17/5b765edf30647.png)\n\n- For test points 4 to 8 (inputs `04` to `08`), the input has special properties (for example, many leaf nodes, being a binary tree, etc.), and trees with these special properties are evenly distributed within each test point.\n\n- For the other test points, the data is randomly generated.\n\n#### Constraints\n\n|Test Point|1|2|3|4|5|6|7|8|9|10|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|Filename|`01`|`02`|`03`|`04`|`05`|`06`|`07`|`08`|`09`|`10`|\n|$T$|$3$|$100$|$100$|$500$|$200$|$50$|$10$|$5$|$2$|$1$|\n|$n$|$7$|$10$|$30$|$100$|$500$|$2000$|$10000$|$20000$|$50000$|$100000$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[eJOI 2018] 互素树", "background": "**本题译自 [eJOI2018](http://ejoi2018.org/) Problem E「Prime Tree」**\n\n", "description": "本题为提交答案，输入文件在附件中。\n\n设有一棵有 $n$ 个结点的树，其结点编号为 $1$ 到 $n$ 。  \n对于其中的任意一条边 $(u, v)$ ，如果存在一个正整数 $d>1$ 满足 $ d \\mid u, d\\mid v$ ，我们称它为一条**坏的边**。  \n下图中的树有三条坏的边—— $(6, 4)$（都被 $2$ 整除）， $(2, 6)$（都被 $2$ 整除）， $(3, 6)$（都被 $3$ 整除）。\n\n![](https://i.loli.net/2018/08/17/5b7633a4ceb38.png)\n\n你的任务是将结点重新编号，使得图中坏的边的数量尽量少。  \n对于上图中的树，按照下图中的方式将结点重新编号，会只剩一条坏的边 $(3, 6)$ 。\n\n![](https://i.loli.net/2018/08/17/5b7633a4cfebf.png)\n\n重新编号后，坏的边越少，你的得分越高。\n\n**这是一道提交答案题。你应当下载输出文件，然后在本地运行你的程序，将输出结果上传**。当然，在洛谷上你可以直接提交你的程序。", "inputFormat": "每个测试点中有多组测试数据。  \n第一行，一个整数 $T$，表示测试数据组数。  \n每组测试数据共 $n$ 行，其中 $n$ 表示树的结点个数。  \n第一行，一个整数 $n$；  \n接下来 $n-1$ 行，每行两个整数 $u$ 和 $v\\ ( 1 \\le u, v \\le n)$，表示一条边 $(u,v)$ 。\n\n**每个输入文件中，每棵树的结点个数相同。**", "outputFormat": "对于每组测试数据，输出一行 $n$ 个整数，表示原先编号为 $1$ 到 $n$ 的结点的新编号。   \n**每个结点的编号必须不同，也就是说同一组测试数据中输出的 $n$ 个整数必须互不相同。**", "hint": "### 计分方式\n对于每个测试点，设所有树的总边数为 $M=T \\times (n-1)$，你的输出中坏的边数为 $X$，记 $R=\\dfrac{X}{M}$ ，你的得分与 $R$ 的关系如下：\n\n|$R$|得分|$R$|得分|\n|:-:|:-:|:-:|:-:|\n|$0.33 < R \\le 0.4$|$1$|$0.01 < R \\le 0.05$|$6$|\n|$0.26 < R \\le 0.33$|$2$|$0.005 < R \\le 0.01$|$7$|\n|$0.19 < R \\le 0.26$|$3$|$0.001 < R \\le 0.005$|$8$|\n|$0.12 < R \\le 0.19$|$4$|$0  < R \\le 0.001$|$9$|\n|$0.05 < R \\le 0.12$|$5$|$R=0$|$10$|\n\n当 $R > 0.4$ 时，不能得分。\n\n**对于所有的测试点，保证存在 $X=0$ 的输出。**\n\n---\n\n### 样例解释\n注意样例中给出了两种合法的输出，为了方便，下称输出 1 和 输出 2。\n\n第一组测试数据已经在题目描述中讨论过。输出 1 中有一条坏的边 $(3, 6)$，输出 2 中没有坏的边。  \n第二组测试数据中，输出 1 和输出 2 都没有出现坏的边。\n\n样例中，$M=2 \\times 5=10$。  \n\n对于输出 1，$X=1, R=\\dfrac{1}{10}=0.1$，该输出将得到 $5$ 分。\n\n对于输出 2，$X=0, R=\\dfrac{0}{10}=0$，该输出将得到 $10$ 分。\n\n---\n\n### 数据范围和限制\n\n#### 数据限制\n- 对于测试点 1 （输入 `01`），$T=3, n=7$，三棵树分别如下所示：\n\n![](https://i.loli.net/2018/08/17/5b765edf30647.png)\n\n- 对于测试点 4 至 8 （输入 `04` 至 `08`），输入数据有特殊性质（如叶子结点较多，是二叉树等），且这些具有特殊性质的树在各个测试点中输入数据均匀分布。\n\n- 对于其他测试点，数据为随机生成。  \n\n#### 数据范围\n\n|测试点编号|1|2|3|4|5|6|7|8|9|10|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|文件名|`01`|`02`|`03`|`04`|`05`|`06`|`07`|`08`|`09`|`10`|\n|$T$|$3$|$100$|$100$|$500$|$200$|$50$|$10$|$5$|$2$|$1$|\n|$n$|$7$|$10$|$30$|$100$|$500$|$2000$|$10000$|$20000$|$50000$|$100000$|", "locale": "zh-CN"}}}
{"pid": "P5091", "type": "P", "difficulty": 5, "samples": [["2 7 4", "2"], ["998244353 12345 98765472103312450233333333333", "5333"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "模板题"], "title": "【模板】扩展欧拉定理", "background": "出题人也想写有趣的题面，可惜并没有能力。", "description": "给你三个正整数，$a,m,b$，你需要求：$a^b \\bmod m$   \n", "inputFormat": "一行三个整数，$a,m,b$", "outputFormat": "一个整数表示答案", "hint": "注意输入格式，$a,m,b$ 依次代表的是底数、模数和次数   \n\n【样例 $1$ 解释】   \n$2^4 \\bmod 7 = 2$     \n     \n【数据范围】  \n对于 $100\\%$ 的数据，$1\\le a \\le 10^9$，$1\\le b \\le 10^{20000000}，1\\le m \\le 10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Extended Euler Theorem", "background": "The problem setter also wants to write an interesting statement, but unfortunately does not have the ability.", "description": "You are given three positive integers $a$, $m$, and $b$. You need to compute: $a^b \\bmod m$.", "inputFormat": "One line with three integers, $a,m,b$.", "outputFormat": "Output one integer representing the answer.", "hint": "Pay attention to the input format: $a,m,b$ represent the base, the modulus, and the exponent, in this order.\n\n[Sample $1$ Explanation]  \n$2^4 \\bmod 7 = 2$.\n\n[Constraints]  \nFor $100\\%$ of the testdata, $1\\le a \\le 10^9$, $1\\le b \\le 10^{20000000}$, $1\\le m \\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】扩展欧拉定理", "background": "出题人也想写有趣的题面，可惜并没有能力。", "description": "给你三个正整数，$a,m,b$，你需要求：$a^b \\bmod m$   \n", "inputFormat": "一行三个整数，$a,m,b$", "outputFormat": "一个整数表示答案", "hint": "注意输入格式，$a,m,b$ 依次代表的是底数、模数和次数   \n\n【样例 $1$ 解释】   \n$2^4 \\bmod 7 = 2$     \n     \n【数据范围】  \n对于 $100\\%$ 的数据，$1\\le a \\le 10^9$，$1\\le b \\le 10^{20000000}，1\\le m \\le 10^8$。", "locale": "zh-CN"}}}
{"pid": "P5092", "type": "P", "difficulty": 4, "samples": [["6\nM 1 6\nC 1\nM 2 4\nM 2 6\nC 3\nC 4", "1\n0\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO", "并查集"], "title": "[USACO04OPEN] Cube Stacking", "background": null, "description": "约翰和贝茜在玩一个方块游戏。编号为 $ 1\\ldots n $ 的 $ n $（$ 1 \\leq n \\leq 30000 $）个方块正放在地上，每个构成一个立方柱。\n\n游戏开始后，约翰会给贝茜发出 $ P $（$ 1 \\leq P \\leq 100000 $）个指令。指令有两种：\n\n1. 移动（```M```）：将包含 ```X``` 的立方柱移动到包含 ```Y``` 的立方柱上。\n2. 统计（```C```）：统计含 ```X``` 的立方柱中，在 ```X``` 下方的方块数目。\n\n写个程序帮贝茜完成游戏。", "inputFormat": "第 $1$ 行输入 $ P $ ，之后 $ P $ 行每行输入一条指令，形式为 `M X Y` 或者 `C X`。\n\n输入保证不会有将立方柱放在自己头上的指令。", "outputFormat": "对于每个统计指令，输出一行一个整数，代表其结果。", "hint": "部分数据范围见输入格式。\n\n$1 \\le X, Y \\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cube Stacking", "background": "", "description": "John and Bessie are playing a cube game. There are $n$ cubes numbered $1\\ldots n$ ($1 \\leq n \\leq 30000$) placed on the ground at the start, each forming a single-cube pile.\n\nAfter the game starts, John will give Bessie $P$ commands ($1 \\leq P \\leq 100000$). There are two types of commands:\n\n1. Move (`M`): Move the pile containing `X` onto the top of the pile containing `Y`.\n2. Count (`C`): Count how many cubes are below cube `X` in the pile containing `X`.\n\nWrite a program to help Bessie complete the game.", "inputFormat": "The first line contains $P$. The next $P$ lines each contain one command, in the form `M X Y` or `C X`.\n\nThe input guarantees that there will be no command that moves a pile onto itself.", "outputFormat": "For each count command, output one line with one integer, which is the result.", "hint": "Some Constraints are shown in the Input Format.\n\n$1 \\le X, Y \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cube Stacking", "background": null, "description": "约翰和贝茜在玩一个方块游戏。编号为 $ 1\\ldots n $ 的 $ n $（$ 1 \\leq n \\leq 30000 $）个方块正放在地上，每个构成一个立方柱。\n\n游戏开始后，约翰会给贝茜发出 $ P $（$ 1 \\leq P \\leq 100000 $）个指令。指令有两种：\n\n1. 移动（```M```）：将包含 ```X``` 的立方柱移动到包含 ```Y``` 的立方柱上。\n2. 统计（```C```）：统计含 ```X``` 的立方柱中，在 ```X``` 下方的方块数目。\n\n写个程序帮贝茜完成游戏。", "inputFormat": "第 $1$ 行输入 $ P $ ，之后 $ P $ 行每行输入一条指令，形式为 `M X Y` 或者 `C X`。\n\n输入保证不会有将立方柱放在自己头上的指令。", "outputFormat": "对于每个统计指令，输出一行一个整数，代表其结果。", "hint": "部分数据范围见输入格式。\n\n$1 \\le X, Y \\le n$。", "locale": "zh-CN"}}}
{"pid": "P5093", "type": "P", "difficulty": 5, "samples": [["14 5\n1\n5\n3\n2\n5\n1\n3\n4\n4\n2\n5\n1\n2\n3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] The Cow Lineup", "background": "", "description": "约翰的 $ N $（$ 1 \\leq N \\leq 100000 $）只奶牛站成了一列。每只奶牛都写有一个号牌，表示她的品种，号牌上的号码在 $ 1 \\ldots K $（$ 1 \\leq K \\leq 10000 $ ）范围内。\n\n比如有这样一个队列：1,5,3,2,5,3,4,4,2,5,1,2,3\n\n根据约翰敏锐的数学神经，他发现一些子序列在这个队列里出现，比如\"3,4,1,3\"，而另一些没有。子序列的各项之间穿插有其他数，也可认为这个子序列存在。现在，他想用 $1 \\sim K$ 之间的整数构造一个最短的子序列，使之不在奶牛序列里出现。达个子序列的长度是多少呢？", "inputFormat": "第1行输入两个整数 $ N $ 和 $ K $ ，接下来 $ N $ 行输入奶牛序列.", "outputFormat": "输出一行，最短的不出现子序列的长度。", "hint": "样例解释：\n\n所有长度为 $1$ 和 $2$ 的可能的子序列都出现了，但长度为 $3$ 的子序列\"2,2,4\"却没有出现。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] The Cow Lineup", "background": "", "description": "John’s $N$ cows ($1 \\leq N \\leq 100000$) are standing in a line. Each cow has a tag number that shows her breed, and the tag number is in the range $1 \\ldots K$ ($1 \\leq K \\leq 10000$).\n\nFor example, there is a lineup like this: 1,5,3,2,5,3,4,4,2,5,1,2,3.\n\nWith his sharp math sense, John finds that some subsequences appear in this lineup, such as \"3,4,1,3\", while others do not. Other numbers may appear between the elements of the subsequence; if so, the subsequence is still considered to exist. Now he wants to use integers from $1 \\sim K$ to construct the shortest subsequence that does not appear in the cow sequence. What is the length of such a subsequence?", "inputFormat": "The first line contains two integers $N$ and $K$. The next $N$ lines contain the cow sequence.", "outputFormat": "Output one line: the length of the shortest subsequence that does not appear.", "hint": "Explanation of the sample:\n\nAll possible subsequences of length $1$ and $2$ appear, but the subsequence of length $3$, \"2,2,4\", does not appear.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] The Cow Lineup", "background": "", "description": "约翰的 $ N $（$ 1 \\leq N \\leq 100000 $）只奶牛站成了一列。每只奶牛都写有一个号牌，表示她的品种，号牌上的号码在 $ 1 \\ldots K $（$ 1 \\leq K \\leq 10000 $ ）范围内。\n\n比如有这样一个队列：1,5,3,2,5,3,4,4,2,5,1,2,3\n\n根据约翰敏锐的数学神经，他发现一些子序列在这个队列里出现，比如\"3,4,1,3\"，而另一些没有。子序列的各项之间穿插有其他数，也可认为这个子序列存在。现在，他想用 $1 \\sim K$ 之间的整数构造一个最短的子序列，使之不在奶牛序列里出现。达个子序列的长度是多少呢？", "inputFormat": "第1行输入两个整数 $ N $ 和 $ K $ ，接下来 $ N $ 行输入奶牛序列.", "outputFormat": "输出一行，最短的不出现子序列的长度。", "hint": "样例解释：\n\n所有长度为 $1$ 和 $2$ 的可能的子序列都出现了，但长度为 $3$ 的子序列\"2,2,4\"却没有出现。", "locale": "zh-CN"}}}
{"pid": "P5094", "type": "P", "difficulty": 4, "samples": [["4\n3 1\n2 5\n2 6\n4 3", "57"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO", "树状数组", "cdq 分治", "分治"], "title": "[USACO04OPEN] MooFest G 加强版", "background": null, "description": "每一年，约翰的 $ N $ 只奶牛参加奶牛狂欢节。这是一个全世界奶牛都参加的大联欢。狂欢节包括很多有趣的活动，比如干草堆叠大赛、跳牛栏大赛，奶牛之间有时还相互扎屁股取乐。当然，她们会排成一列嚎叫，来欢庆她们的节日。奶牛们的叫声实在刺耳，以致于每只奶牛的听力都受到不同程度的损伤。现在告诉你奶牛 $ i $ 的听力为 $ v_i $ ，这表示如果奶牛 $ j $ 想说点什么让她听到，必须用高于 $ v_i \\times dis(i,j) $ 的音量。因此，如果奶牛 $ i $ 和 $ j $ 想相互交谈，她们的音量必须不小于 $ \\max (v_i,v_j) \\times dis(i,j) $。其中 $ dis(i,j) $ 表示她们间的距离。\n\n现在 $ N $ 只奶牛都站在一条直线上了，每只奶牛还有一个坐标 $ x_i $。如果每对奶牛都在交谈，并且使用最小音量，那所有 $ N(N-1)/2 $ 对奶牛间谈话的音量之和为多少？", "inputFormat": "第 $1$ 行输入一个整数 $ N $ 。\n\n接下来 $ N $ 行，每行输入两个数 $ v_i $ 和 $ x_i $ ，分别代表第 $ i $ 头奶牛的听力和坐标。", "outputFormat": "输出一个数，代表这 $ N(N-1)/2 $ 对奶牛谈话时的音量之和。", "hint": "### 数据范围\n\n因为原数据下 $O(N^2)$ 算法可以通过，所以新添加了一些增强数据。\n\n原数据作为子任务 $1$，新添加的数据作为子任务 $2$。\n\n- 子任务 $1$（$1$ 分）：$1 \\leq N,V_i,x_i \\leq 2 \\times 10^4$。\n- 子任务 $2$（$99$ 分）：$1 \\leq N,V_i,x_i \\leq 5 \\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] MooFest G Enhanced Version", "background": "", "description": "Every year, John’s $N$ cows take part in the MooFest, a big festival for cows all over the world. The festival has many fun activities, such as haystack piling contests and cow-pen jumping contests. Sometimes the cows also poke each other for fun. Of course, they will line up and moo loudly to celebrate their holiday.\n\nThe cows’ moos are so noisy that each cow’s hearing is damaged to a different degree. Now you are given cow $i$’s hearing level $v_i$. This means that if cow $j$ wants to say something that cow $i$ can hear, cow $j$ must use a volume greater than $v_i \\times dis(i,j)$. Therefore, if cows $i$ and $j$ want to talk to each other, their volume must be at least $\\max(v_i, v_j) \\times dis(i,j)$, where $dis(i,j)$ is the distance between them.\n\nNow the $N$ cows are standing on a straight line, and each cow has a coordinate $x_i$. If every pair of cows is talking, and each pair uses the minimum required volume, what is the sum of the volumes over all $N(N-1)/2$ pairs?", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines each contain two numbers $v_i$ and $x_i$, representing the $i$-th cow’s hearing level and coordinate, respectively.", "outputFormat": "Output one number, which is the sum of the volumes when these $N(N-1)/2$ pairs of cows talk.", "hint": "### Constraints\n\nSince an $O(N^2)$ algorithm can pass under the original data, some additional enhanced testdata has been added.\n\nThe original data is Subtask $1$, and the newly added data is Subtask $2$.\n\n- Subtask $1$ ($1$ point): $1 \\leq N, V_i, x_i \\leq 2 \\times 10^4$.\n- Subtask $2$ ($99$ points): $1 \\leq N, V_i, x_i \\leq 5 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] MooFest G 加强版", "background": null, "description": "每一年，约翰的 $ N $ 只奶牛参加奶牛狂欢节。这是一个全世界奶牛都参加的大联欢。狂欢节包括很多有趣的活动，比如干草堆叠大赛、跳牛栏大赛，奶牛之间有时还相互扎屁股取乐。当然，她们会排成一列嚎叫，来欢庆她们的节日。奶牛们的叫声实在刺耳，以致于每只奶牛的听力都受到不同程度的损伤。现在告诉你奶牛 $ i $ 的听力为 $ v_i $ ，这表示如果奶牛 $ j $ 想说点什么让她听到，必须用高于 $ v_i \\times dis(i,j) $ 的音量。因此，如果奶牛 $ i $ 和 $ j $ 想相互交谈，她们的音量必须不小于 $ \\max (v_i,v_j) \\times dis(i,j) $。其中 $ dis(i,j) $ 表示她们间的距离。\n\n现在 $ N $ 只奶牛都站在一条直线上了，每只奶牛还有一个坐标 $ x_i $。如果每对奶牛都在交谈，并且使用最小音量，那所有 $ N(N-1)/2 $ 对奶牛间谈话的音量之和为多少？", "inputFormat": "第 $1$ 行输入一个整数 $ N $ 。\n\n接下来 $ N $ 行，每行输入两个数 $ v_i $ 和 $ x_i $ ，分别代表第 $ i $ 头奶牛的听力和坐标。", "outputFormat": "输出一个数，代表这 $ N(N-1)/2 $ 对奶牛谈话时的音量之和。", "hint": "### 数据范围\n\n因为原数据下 $O(N^2)$ 算法可以通过，所以新添加了一些增强数据。\n\n原数据作为子任务 $1$，新添加的数据作为子任务 $2$。\n\n- 子任务 $1$（$1$ 分）：$1 \\leq N,V_i,x_i \\leq 2 \\times 10^4$。\n- 子任务 $2$（$99$ 分）：$1 \\leq N,V_i,x_i \\leq 5 \\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5095", "type": "P", "difficulty": 4, "samples": [["5 10\n5 7\n9 2\n8 5\n13 2\n3 8", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12OPEN] Bookshelf S", "background": "", "description": "Farmer John 闲来无事的时候总喜欢坐下来看书。这些年来，他一共收集了 $N$ 本书（$1 \\leq N \\leq 2000$），他打算搭一个新的书架来装这些书。\n\n每本书都有个宽度 $w_i$ 和高度 $h_i$，书必须按顺序来摆放（即同一层书架摆的书必须是连续的一个区间）。每层书架的总宽度不能超过 $L$（$1 \\leq L \\leq 10^9$），每层书架的高度等于这一层最高的书的高度，整个书架的高度等于每层书架的高度之和。\n\n现在请你帮 FJ 求出书架高度的最小值。", "inputFormat": "第一行两个整数 $N,L$。\n\n接下来 $N$ 行，每行两个整数 $h_i,w_i$（$1 \\leq h_i \\leq 10^6$，$1 \\leq w_i \\leq L$）。", "outputFormat": "输出一个整数，书架高度最小值。", "hint": "第一层放第一本书，第二层放第二，三，四本书，第三层放第五本书，总高度为 $5+13+3=21$，可以证明不存在更优的方案。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12OPEN] Bookshelf S", "background": "", "description": "Farmer John likes to sit down and read when he has nothing to do. Over the years, he has collected a total of $N$ books ($1 \\leq N \\leq 2000$), and he plans to build a new bookshelf to hold these books.\n\nEach book has a width $w_i$ and a height $h_i$. The books must be placed in order (that is, the books placed on the same shelf layer must form a consecutive interval). The total width of each shelf layer cannot exceed $L$ ($1 \\leq L \\leq 10^9$). The height of a shelf layer equals the height of the tallest book on that layer, and the total height of the bookshelf equals the sum of the heights of all layers.\n\nNow please help FJ find the minimum possible total height of the bookshelf.", "inputFormat": "The first line contains two integers $N, L$.\n\nThe next $N$ lines each contain two integers $h_i, w_i$ ($1 \\leq h_i \\leq 10^6$, $1 \\leq w_i \\leq L$).", "outputFormat": "Output one integer, the minimum possible height of the bookshelf.", "hint": "Put the first book on the first layer, the second, third, and fourth books on the second layer, and the fifth book on the third layer. The total height is $5+13+3=21$. It can be proven that there is no better arrangement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12OPEN] Bookshelf S", "background": "", "description": "Farmer John 闲来无事的时候总喜欢坐下来看书。这些年来，他一共收集了 $N$ 本书（$1 \\leq N \\leq 2000$），他打算搭一个新的书架来装这些书。\n\n每本书都有个宽度 $w_i$ 和高度 $h_i$，书必须按顺序来摆放（即同一层书架摆的书必须是连续的一个区间）。每层书架的总宽度不能超过 $L$（$1 \\leq L \\leq 10^9$），每层书架的高度等于这一层最高的书的高度，整个书架的高度等于每层书架的高度之和。\n\n现在请你帮 FJ 求出书架高度的最小值。", "inputFormat": "第一行两个整数 $N,L$。\n\n接下来 $N$ 行，每行两个整数 $h_i,w_i$（$1 \\leq h_i \\leq 10^6$，$1 \\leq w_i \\leq L$）。", "outputFormat": "输出一个整数，书架高度最小值。", "hint": "第一层放第一本书，第二层放第二，三，四本书，第三层放第五本书，总高度为 $5+13+3=21$，可以证明不存在更优的方案。", "locale": "zh-CN"}}}
{"pid": "P5096", "type": "P", "difficulty": 4, "samples": [["6 7 5\n1\n2\n3\n4\n5\n1 2 3\n3 6 2\n6 2 10\n2 4 1\n5 1 1\n4 5 1\n1 6 1", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] Cave Cows 1", "background": "", "description": "很少人知道其实奶牛非常喜欢到洞穴里面去探险。\n\n洞窟里有 $ N $ ( $ 1 \\leq N \\leq 100 $ )个洞室，由 $ M $ ( $ 1 \\leq M \\leq 1000 $ )条双向通道连接着它们。每对洞室间至多只有一条双向通道，有 $ K $ ( $ 1 \\leq K \\leq 14 $ )个洞室，里面放有1捆干草．牛吃1捆干草，体重指数就会增加1。\n\n贪吃的贝茜要到洞窟里面探险，她希望能吃尽量多的干草，但每条通道有一个宽度阈值，如果体重指数超过相应的阈值，贝茜就会被卡住。\n\n她从洞窟1出发，体重指数为0。在洞里溜达一圈后，她要返回洞窟1。\n\n那她最多能吃多少捆干草呢？注意，贝茜经过一个洞室，不一定非要吃掉里面的干草。", "inputFormat": "第1行输入 $ N,M,K $ 。\n\n之后 $ K $ 行每行一个整数，表示在这个洞室放有一捆干草；接下来 $ M $ 行每行三个整数，表示一条双向通道的起点终点和宽度阈值。", "outputFormat": "最多能吃掉的干草数。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cave Cows 1", "background": "", "description": "Few people know that cows actually really like exploring caves.\n\nThere are $N$ ( $1 \\leq N \\leq 100$ ) chambers in the cave, connected by $M$ ( $1 \\leq M \\leq 1000$ ) bidirectional passages. Between any pair of chambers, there is at most one bidirectional passage. There are $K$ ( $1 \\leq K \\leq 14$ ) chambers, each containing one bale of hay. Every time a cow eats one bale of hay, her weight index increases by $1$.\n\nThe greedy Bessie wants to explore the cave and hopes to eat as much hay as possible, but each passage has a width threshold: if her weight index exceeds the corresponding threshold, Bessie will get stuck.\n\nShe starts from chamber $1$ with weight index $0$. After wandering around in the cave, she must return to chamber $1$.\n\nWhat is the maximum number of hay bales she can eat? Note that when Bessie passes through a chamber, she does not have to eat the hay in it.", "inputFormat": "The first line contains $N, M, K$.\n\nThe next $K$ lines each contain one integer, indicating a chamber that contains one bale of hay. Then the next $M$ lines each contain three integers, indicating the two endpoints of a bidirectional passage and its width threshold.", "outputFormat": "The maximum number of hay bales that can be eaten.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cave Cows 1", "background": "", "description": "很少人知道其实奶牛非常喜欢到洞穴里面去探险。\n\n洞窟里有 $ N $ ( $ 1 \\leq N \\leq 100 $ )个洞室，由 $ M $ ( $ 1 \\leq M \\leq 1000 $ )条双向通道连接着它们。每对洞室间至多只有一条双向通道，有 $ K $ ( $ 1 \\leq K \\leq 14 $ )个洞室，里面放有1捆干草．牛吃1捆干草，体重指数就会增加1。\n\n贪吃的贝茜要到洞窟里面探险，她希望能吃尽量多的干草，但每条通道有一个宽度阈值，如果体重指数超过相应的阈值，贝茜就会被卡住。\n\n她从洞窟1出发，体重指数为0。在洞里溜达一圈后，她要返回洞窟1。\n\n那她最多能吃多少捆干草呢？注意，贝茜经过一个洞室，不一定非要吃掉里面的干草。", "inputFormat": "第1行输入 $ N,M,K $ 。\n\n之后 $ K $ 行每行一个整数，表示在这个洞室放有一捆干草；接下来 $ M $ 行每行三个整数，表示一条双向通道的起点终点和宽度阈值。", "outputFormat": "最多能吃掉的干草数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5097", "type": "P", "difficulty": 3, "samples": [["10 4\n75\n30\n100\n38\n50\n51\n52\n20\n81\n5\n1 10\n3 5\n6 9\n8 10", "5\n38\n20\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] Cave Cows 2", "background": "", "description": "洞窟里有一道长长的通道．它由 $ N $ ( $ 1 \\leq N \\leq 25000 $ )段道尾相连构成，编号分别为 $ 1 \\ldots N $ 。\n\n每个通道有一个阈值，其范围在 $ [1,10^9] $ 。依次通过 $ i \\ldots j $ 的通道，那奶牛的体重指数就不能超过 $ i \\ldots j $ 通道中阈值的最小值。贝茜有 \n$ Q $ ( $ 1 \\leq Q \\leq 25000 $ )个问题，想请教你由 $ i $ 到 $ j $ 的通道的阈值的最小值。", "inputFormat": "第1行输入 $ N $ 和 $ Q $ 。\n\n接下来 $ N $ 行输入每个通道的阈值，之后 $ Q $ 行每行两个整数，对应问题中的 $ i $ 和 $ j $（ $ i<j $ ）。", "outputFormat": "对于每个问题，输出其结果。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cave Cows 2", "background": "", "description": "There is a long passage in a cave. It is made up of $N$ segments ($1 \\leq N \\leq 25000$) connected end to end, numbered $1 \\ldots N$.\n\nEach segment has a threshold value in the range $[1,10^9]$. If a cow passes through segments $i \\ldots j$ in order, then the cow’s weight index must not exceed the minimum threshold among segments $i \\ldots j$. Bessie has $Q$ questions ($1 \\leq Q \\leq 25000$) and wants to ask you for the minimum threshold value from segment $i$ to segment $j$.", "inputFormat": "The first line contains $N$ and $Q$.\n\nThe next $N$ lines contain the threshold value of each segment. After that, the next $Q$ lines each contain two integers, corresponding to $i$ and $j$ in the questions ($i < j$).", "outputFormat": "For each query, output the answer.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cave Cows 2", "background": "", "description": "洞窟里有一道长长的通道．它由 $ N $ ( $ 1 \\leq N \\leq 25000 $ )段道尾相连构成，编号分别为 $ 1 \\ldots N $ 。\n\n每个通道有一个阈值，其范围在 $ [1,10^9] $ 。依次通过 $ i \\ldots j $ 的通道，那奶牛的体重指数就不能超过 $ i \\ldots j $ 通道中阈值的最小值。贝茜有 \n$ Q $ ( $ 1 \\leq Q \\leq 25000 $ )个问题，想请教你由 $ i $ 到 $ j $ 的通道的阈值的最小值。", "inputFormat": "第1行输入 $ N $ 和 $ Q $ 。\n\n接下来 $ N $ 行输入每个通道的阈值，之后 $ Q $ 行每行两个整数，对应问题中的 $ i $ 和 $ j $（ $ i<j $ ）。", "outputFormat": "对于每个问题，输出其结果。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5098", "type": "P", "difficulty": 3, "samples": [["5\n1 1\n3 5\n2 7\n8 1\n4 4", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] Cave Cows 3", "background": null, "description": "约翰的 $ N $（$ 1 \\leq N \\leq 50000 $）只牛在一个黑魃魃的洞里探险，他们只能通过叫声交流。\n\n两只牛之间的曼哈顿距离决定了声音传播的时间。即牛一与牛二交流，需要的时间为 $ |x_1-x_2|+|y_1-y_2| $。其中 $ -10^6 \\leq x_1,x_2,y_1,y_2 \\leq 10^6 $。\n\n那任意一对牛之间交流时间的最大值为多少？", "inputFormat": "第 $1$ 行输入 $N$，接下来每行输入一只牛的坐标。", "outputFormat": "交流时间最大值（即最大曼哈顿距离）。", "hint": "样例解释：\n\n$ (2,7) $ 和 $ (8,1) $ 两点间的距离最大，为 $12$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cave Cows 3", "background": "", "description": "John’s $N$ ($1 \\leq N \\leq 50000$) cows are exploring in a pitch-black cave, and they can only communicate by calling.\n\nThe time for sound to travel is determined by the Manhattan distance between two cows. That is, for cow 1 and cow 2 to communicate, the required time is $|x_1-x_2|+|y_1-y_2|$. Here, $-10^6 \\leq x_1,x_2,y_1,y_2 \\leq 10^6$.\n\nWhat is the maximum communication time among all pairs of cows?", "inputFormat": "The first line contains $N$. Each of the following lines contains the coordinates of one cow.", "outputFormat": "The maximum communication time (i.e., the maximum Manhattan distance).", "hint": "Explanation of the sample:\n\nThe distance between $(2,7)$ and $(8,1)$ is the largest, which is $12$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cave Cows 3", "background": null, "description": "约翰的 $ N $（$ 1 \\leq N \\leq 50000 $）只牛在一个黑魃魃的洞里探险，他们只能通过叫声交流。\n\n两只牛之间的曼哈顿距离决定了声音传播的时间。即牛一与牛二交流，需要的时间为 $ |x_1-x_2|+|y_1-y_2| $。其中 $ -10^6 \\leq x_1,x_2,y_1,y_2 \\leq 10^6 $。\n\n那任意一对牛之间交流时间的最大值为多少？", "inputFormat": "第 $1$ 行输入 $N$，接下来每行输入一只牛的坐标。", "outputFormat": "交流时间最大值（即最大曼哈顿距离）。", "hint": "样例解释：\n\n$ (2,7) $ 和 $ (8,1) $ 两点间的距离最大，为 $12$。", "locale": "zh-CN"}}}
{"pid": "P5099", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2\n6 3\n4 1\n3 2\n0 2", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] Cave Cows 4", "background": "", "description": "一道竖直的石墙横在贝茜前面，她必须越过去。\n\n石墙可以看成一个xz平面，贝茜开始的时候在(0，0)，只要她到达 $ z=T $ \n ( $ 1 \\leq T \\leq 200000 $ )的位置，就算翻越成功。\n\n墙上有 $ N $ ( $ 1 \\leq N \\leq 50000 $ )块石头突出，成为贝茜的落蹄石。如果两个落蹄石之间x方向和z方向的距离均不超过2，那贝茜就可以攀上另一块落蹄石。\n\n帮助贝茜计算她是否能够翻越石墙，如果可以，最少需要踩多少块落蹄石。", "inputFormat": "第1行输入 $ N $ 和 $ T $ 。\n\n接下来 $ N $ 行，每行输入坐标 $ (x,z) $ ，表示一个石头的位置．其中 $ x \\leq 10^6 $ ， $ z \\leq T $ ，保证 $ (0,0) $ 不会出现。", "outputFormat": "如果可以翻越则输出最少需要的落蹄石数（起点不计入），否则输出 $ -1 $ 。", "hint": "一种可行的方案是：(0,0) -> (1,2) -> (3,2) -> (4,1) -> (6,3) 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cave Cows 4", "background": "", "description": "A vertical stone wall stands in front of Bessie, and she must climb over it.\n\nThe wall can be seen as the $ xz $ plane. Bessie starts at $ (0,0) $. As long as she reaches the position with $ z = T $ ( $ 1 \\leq T \\leq 200000 $ ), the climb is considered successful.\n\nThere are $ N $ ( $ 1 \\leq N \\leq 50000 $ ) stones protruding from the wall, which can be used as footholds. If the distances between two footholds in both the $ x $ direction and the $ z $ direction are no more than $ 2 $, then Bessie can climb from one foothold to the other.\n\nHelp Bessie determine whether she can climb over the wall. If she can, find the minimum number of footholds she needs to step on.", "inputFormat": "The first line contains $ N $ and $ T $.\n\nThe next $ N $ lines each contain the coordinates $ (x,z) $, representing the position of a stone. Here $ x \\leq 10^6 $ and $ z \\leq T $. It is guaranteed that $ (0,0) $ does not appear.", "outputFormat": "If Bessie can climb over the wall, output the minimum number of footholds needed (the starting point is not counted). Otherwise, output $ -1 $.", "hint": "One possible route is: (0,0) -> (1,2) -> (3,2) -> (4,1) -> (6,3).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cave Cows 4", "background": "", "description": "一道竖直的石墙横在贝茜前面，她必须越过去。\n\n石墙可以看成一个xz平面，贝茜开始的时候在(0，0)，只要她到达 $ z=T $ \n ( $ 1 \\leq T \\leq 200000 $ )的位置，就算翻越成功。\n\n墙上有 $ N $ ( $ 1 \\leq N \\leq 50000 $ )块石头突出，成为贝茜的落蹄石。如果两个落蹄石之间x方向和z方向的距离均不超过2，那贝茜就可以攀上另一块落蹄石。\n\n帮助贝茜计算她是否能够翻越石墙，如果可以，最少需要踩多少块落蹄石。", "inputFormat": "第1行输入 $ N $ 和 $ T $ 。\n\n接下来 $ N $ 行，每行输入坐标 $ (x,z) $ ，表示一个石头的位置．其中 $ x \\leq 10^6 $ ， $ z \\leq T $ ，保证 $ (0,0) $ 不会出现。", "outputFormat": "如果可以翻越则输出最少需要的落蹄石数（起点不计入），否则输出 $ -1 $ 。", "hint": "一种可行的方案是：(0,0) -> (1,2) -> (3,2) -> (4,1) -> (6,3) 。", "locale": "zh-CN"}}}
{"pid": "P5100", "type": "P", "difficulty": 6, "samples": [["6 5\n1 3 6\n3\n1 1\n0 4\n6 5", "26"], ["3 3\n0 50 10\n2\n0 0\n3 3", "60"], ["4 3\n0 15 10\n2\n0 0\n4 3", "45"], ["4 6\n0 5 1000\n6\n3 1\n4 6\n3 0\n3 0\n4 0\n0 4", "2020"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "2017", "最短路", "JOI（日本）"], "title": "[JOI 2017 Final] 足球 / Soccer", "background": "", "description": "**题目译自 [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T4「[サッカー](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Soccer](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」**\n\n> 「假定球滚动时可以穿过其他球员」这句是在未修改数据的前提下，为了严谨我补上的，原题没有提这一点。如果撞到其他球员就停下的话似乎做法不同？\n\n你是 JOI 联赛中一所声名卓著的足球俱乐部的经理。\n\n俱乐部有 $N$ 名球员，编号为 $1\\ldots N$。球员们每天都刻苦地进行训练，剑指联赛冠军。足球场可视为一个底为 $W$ 米，高 $H$ 米的长方形，底平行于东西方向，高平行于南北方向。如果某个点向北走 $i$ 米，再向西走 $j$ 米恰好到达球场的西北角，这个点可用坐标 $(i, j)$ 来表示。\n\n练习结束后，你要回收练习用的足球。开始回收时，所有球员都在足球场上，球员 $i (1\\leqslant i\\leqslant N)$ 位于 $(S_i, T_i)$，球在球员 $1$ 脚下。你正和球员 $N$ 一起站在 $(S_N, T_N)$，并准备回收球。球员们把球传到 $(S_N, T_N)$ 时，你才会回收球。\n\n你可以指挥球员，但某些操作会提升球员的**疲劳度**。一个球员不能同时进行多项操作。  \n你可以指挥控球的球员进行如下操作：\n* **踢球**。在东西南北四个方向中任选一个，并指定一个正整数 $p$，该球员将球朝指定方向踢出恰好 $p$ 米。**假定球滚动时可以穿过其他球员**。该球员不会移动，且自动停止控球，疲劳度上升 $A\\times p+B$。\n* **运球**。在东西南北四个方向中任选一个，该球员带球，朝指定方向移动 $1$ 米。该球员仍然控球，疲劳度上升 $C$。\n* **停止控球**。该球员的疲劳度不改变。\n\n你可以指挥没有控球的球员进行如下操作：\n* **移动**。在东西南北四个方向中任选一个，该球员朝指定方向移动 $1$ 米，疲劳度上升 $C$。\n* **控球**。如果该球员所在的位置恰好有球，且没有其他球员控球，该球员才能控球。该球员的疲劳度不改变。\n\n球员和球有可能跑出场外，一个位置上可能有多个球员。  \n一天的训练结束后，球员们非常疲惫。你想知道在回收球的过程中，所有球员上升的疲劳度之和的最小值。", "inputFormat": "第一行有两个整数 $H, W$，用空格分隔。  \n第二行有三个整数 $A, B, C$，用空格分隔。  \n第三行有一个整数 $N$。  \n在接下来的 $N$ 行中，第 $i$ 行 $(1\\leqslant i\\leqslant N)$有两个整数 $S_i, T_i$，用空格分隔。  \n输入的所有数的含义见题目描述。", "outputFormat": "一行，一个整数，表示在回收球的过程中，所有球员上升的疲劳度之和的最小值。", "hint": "#### 样例解释 1\n在这组样例中，球场、球员、球处于如图所示的状态。图中，黑框空心圆圈表示球员，实心圆表示球，你在 $(6,5)$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7t23chgu.png)\n\n最优解如下：\n1. 球员 $1$ 把球向东踢出 $3$ 米。疲劳度上升了 $1\\times 3+3=6$，球移动到 $(1,4)$。\n2. 球员 $2$ 向南移动 $1$ 米。疲劳度又上升了 $6$。\n3. 球员 $2$ 开始控球。\n4. 球员 $2$ 向东运球 $1$ 米。疲劳度又上升了 $6$。\n5. 球员 $2$ 把球向南踢出 $5$ 米，疲劳度上升了 $1\\times 5+3=8$，球移动到 $(6,5)$。\n\n此时，疲劳度之和为 $6+6+6+8=26$。没有更好的方案。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0a9bunu.png)\n\n#### 样例解释 2\n在最优解中，不需要踢球。\n\n#### 样例解释 4\n注意这组样例中有多个球员在同一位置的情况。\n\n#### 数据范围与提示\n对于 $5\\%$ 的数据，$N=2$。  \n对于另外 $30\\%$ 的数据，$N\\leqslant 1000, A=0$。  \n对于所有数据，$1\\leqslant H,W\\leqslant 500, 0\\leqslant A, B, C\\leqslant 10^9, 2\\leqslant N\\leqslant 10^5, 0\\leqslant S_i\\leqslant H, 0\\leqslant T_i\\leqslant W(1\\leqslant i\\leqslant N), (S_1, T_1)\\neq(S_N, T_N)$。", "locale": "zh-CN", "translations": {"en": {"title": "[JOI 2017 Final] Soccer / Soccer", "background": "", "description": "**This problem is translated from [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T4「[サッカー](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Soccer](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」.**\n\n> The sentence “Assume that while the ball is rolling it can pass through other players” was added by me for strictness without changing the original testdata. The original statement did not mention this. If the ball stops when it hits other players, the solution seems to be different.\n\nYou are the manager of a famous soccer club in the JOI league.\n\nThe club has $N$ players, numbered $1 \\ldots N$. The players train hard every day, aiming for the league championship. The soccer field can be seen as a rectangle with width $W$ meters and height $H$ meters. The width is parallel to the east-west direction, and the height is parallel to the north-south direction. If from a point you go north $i$ meters and then go west $j$ meters and arrive exactly at the northwest corner of the field, then this point can be represented by coordinates $(i, j)$.\n\nAfter training, you need to collect the practice soccer ball. When you start collecting, all players are on the field. Player $i \\ (1 \\leqslant i \\leqslant N)$ is at $(S_i, T_i)$, and the ball is at the feet of player $1$. You are standing together with player $N$ at $(S_N, T_N)$, ready to collect the ball. You will collect the ball only when the players pass the ball to $(S_N, T_N)$.\n\nYou can give instructions to the players, but some operations will increase a player’s **fatigue**. A player cannot perform multiple operations at the same time.\n\nYou can instruct the player who currently controls the ball to perform the following operations:\n- **Kick**: Choose one of the four directions (east, west, south, north), and specify a positive integer $p$. The player kicks the ball exactly $p$ meters in the chosen direction. **Assume that while the ball is rolling it can pass through other players**. The player does not move, and automatically stops controlling the ball. The player’s fatigue increases by $A \\times p + B$.\n- **Dribble**: Choose one of the four directions (east, west, south, north). The player moves with the ball by $1$ meter in the chosen direction. The player still controls the ball. The player’s fatigue increases by $C$.\n- **Stop controlling the ball**: The player’s fatigue does not change.\n\nYou can instruct a player who does not control the ball to perform the following operations:\n- **Move**: Choose one of the four directions (east, west, south, north). The player moves by $1$ meter in the chosen direction. The player’s fatigue increases by $C$.\n- **Take control of the ball**: The player can take control only if the ball is exactly at the player’s position, and no other player is controlling the ball. The player’s fatigue does not change.\n\nPlayers and the ball may move outside the field, and there may be multiple players at the same position.\n\nAfter a day of training, the players are very tired. You want to know the minimum possible value of the sum of fatigue increases of all players during the process of collecting the ball.", "inputFormat": "The first line contains two integers $H, W$, separated by spaces.  \nThe second line contains three integers $A, B, C$, separated by spaces.  \nThe third line contains one integer $N$.  \nIn the next $N$ lines, line $i \\ (1 \\leqslant i \\leqslant N)$ contains two integers $S_i, T_i$, separated by spaces.  \nThe meanings of all input values are described in the statement.", "outputFormat": "One line with one integer, representing the minimum sum of fatigue increases of all players during the process of collecting the ball.", "hint": "#### Sample Explanation 1\nIn this sample, the field, the players, and the ball are in the state shown in the figure. In the figure, the hollow circles with black outlines represent players, the solid circle represents the ball, and you are at $(6,5)$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7t23chgu.png)\n\nAn optimal solution is as follows:\n1. Player $1$ kicks the ball $3$ meters to the east. The fatigue increases by $1 \\times 3 + 3 = 6$, and the ball moves to $(1,4)$.\n2. Player $2$ moves $1$ meter to the south. The fatigue increases by another $6$.\n3. Player $2$ starts controlling the ball.\n4. Player $2$ dribbles $1$ meter to the east. The fatigue increases by another $6$.\n5. Player $2$ kicks the ball $5$ meters to the south. The fatigue increases by $1 \\times 5 + 3 = 8$, and the ball moves to $(6,5)$.\n\nAt this point, the total fatigue increase is $6 + 6 + 6 + 8 = 26$. There is no better plan.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0a9bunu.png)\n\n#### Sample Explanation 2\nIn the optimal solution, kicking is not necessary.\n\n#### Sample Explanation 4\nNote that in this sample there are multiple players at the same position.\n\n#### Constraints and Hints\nFor $5\\%$ of the data, $N = 2$.  \nFor another $30\\%$ of the data, $N \\leqslant 1000$ and $A = 0$.  \nFor all data, $1 \\leqslant H, W \\leqslant 500$, $0 \\leqslant A, B, C \\leqslant 10^9$, $2 \\leqslant N \\leqslant 10^5$, $0 \\leqslant S_i \\leqslant H$, $0 \\leqslant T_i \\leqslant W \\ (1 \\leqslant i \\leqslant N)$, $(S_1, T_1) \\neq (S_N, T_N)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JOI 2017 Final] 足球 / Soccer", "background": "", "description": "**题目译自 [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T4「[サッカー](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Soccer](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」**\n\n> 「假定球滚动时可以穿过其他球员」这句是在未修改数据的前提下，为了严谨我补上的，原题没有提这一点。如果撞到其他球员就停下的话似乎做法不同？\n\n你是 JOI 联赛中一所声名卓著的足球俱乐部的经理。\n\n俱乐部有 $N$ 名球员，编号为 $1\\ldots N$。球员们每天都刻苦地进行训练，剑指联赛冠军。足球场可视为一个底为 $W$ 米，高 $H$ 米的长方形，底平行于东西方向，高平行于南北方向。如果某个点向北走 $i$ 米，再向西走 $j$ 米恰好到达球场的西北角，这个点可用坐标 $(i, j)$ 来表示。\n\n练习结束后，你要回收练习用的足球。开始回收时，所有球员都在足球场上，球员 $i (1\\leqslant i\\leqslant N)$ 位于 $(S_i, T_i)$，球在球员 $1$ 脚下。你正和球员 $N$ 一起站在 $(S_N, T_N)$，并准备回收球。球员们把球传到 $(S_N, T_N)$ 时，你才会回收球。\n\n你可以指挥球员，但某些操作会提升球员的**疲劳度**。一个球员不能同时进行多项操作。  \n你可以指挥控球的球员进行如下操作：\n* **踢球**。在东西南北四个方向中任选一个，并指定一个正整数 $p$，该球员将球朝指定方向踢出恰好 $p$ 米。**假定球滚动时可以穿过其他球员**。该球员不会移动，且自动停止控球，疲劳度上升 $A\\times p+B$。\n* **运球**。在东西南北四个方向中任选一个，该球员带球，朝指定方向移动 $1$ 米。该球员仍然控球，疲劳度上升 $C$。\n* **停止控球**。该球员的疲劳度不改变。\n\n你可以指挥没有控球的球员进行如下操作：\n* **移动**。在东西南北四个方向中任选一个，该球员朝指定方向移动 $1$ 米，疲劳度上升 $C$。\n* **控球**。如果该球员所在的位置恰好有球，且没有其他球员控球，该球员才能控球。该球员的疲劳度不改变。\n\n球员和球有可能跑出场外，一个位置上可能有多个球员。  \n一天的训练结束后，球员们非常疲惫。你想知道在回收球的过程中，所有球员上升的疲劳度之和的最小值。", "inputFormat": "第一行有两个整数 $H, W$，用空格分隔。  \n第二行有三个整数 $A, B, C$，用空格分隔。  \n第三行有一个整数 $N$。  \n在接下来的 $N$ 行中，第 $i$ 行 $(1\\leqslant i\\leqslant N)$有两个整数 $S_i, T_i$，用空格分隔。  \n输入的所有数的含义见题目描述。", "outputFormat": "一行，一个整数，表示在回收球的过程中，所有球员上升的疲劳度之和的最小值。", "hint": "#### 样例解释 1\n在这组样例中，球场、球员、球处于如图所示的状态。图中，黑框空心圆圈表示球员，实心圆表示球，你在 $(6,5)$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7t23chgu.png)\n\n最优解如下：\n1. 球员 $1$ 把球向东踢出 $3$ 米。疲劳度上升了 $1\\times 3+3=6$，球移动到 $(1,4)$。\n2. 球员 $2$ 向南移动 $1$ 米。疲劳度又上升了 $6$。\n3. 球员 $2$ 开始控球。\n4. 球员 $2$ 向东运球 $1$ 米。疲劳度又上升了 $6$。\n5. 球员 $2$ 把球向南踢出 $5$ 米，疲劳度上升了 $1\\times 5+3=8$，球移动到 $(6,5)$。\n\n此时，疲劳度之和为 $6+6+6+8=26$。没有更好的方案。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0a9bunu.png)\n\n#### 样例解释 2\n在最优解中，不需要踢球。\n\n#### 样例解释 4\n注意这组样例中有多个球员在同一位置的情况。\n\n#### 数据范围与提示\n对于 $5\\%$ 的数据，$N=2$。  \n对于另外 $30\\%$ 的数据，$N\\leqslant 1000, A=0$。  \n对于所有数据，$1\\leqslant H,W\\leqslant 500, 0\\leqslant A, B, C\\leqslant 10^9, 2\\leqslant N\\leqslant 10^5, 0\\leqslant S_i\\leqslant H, 0\\leqslant T_i\\leqslant W(1\\leqslant i\\leqslant N), (S_1, T_1)\\neq(S_N, T_N)$。", "locale": "zh-CN"}}}
{"pid": "P5101", "type": "P", "difficulty": 7, "samples": [["5 3\n1 2 3 3 2", "2\n1\n1"], ["7 3\n1 2 2 1 3 3 3", "2\n2\n2"], ["10 3\n2 2 1 1 3 3 2 1 1 2", "3\n3\n4"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2017", "JOI（日本）", "Ad-hoc"], "title": "[JOI 2017 Final] 绳 / Rope", "background": "", "description": "**题目译自 [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T5「[縄](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Rope](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」**\n\n JOI 小宝宝正拿着一根绳子玩。绳子可视为一条长度为 $N$ 的左右延伸的线段。绳子由 $N$ 根线连接而成，每根线的长度为 $1$，厚度为 $1$。绳子上的线共有 $M$ 种颜色，左数第 $i$ 根线 $(1\\leqslant i\\leqslant N)$ 的颜色为 $C_i(1\\leqslant C_i\\leqslant M)$。**绳子的左端点**意为左数第 $1$ 根线的左端点，**绳子的右端点**意为右数第 $1$ 根线的右端点。显然左数第 $i$ 根线 $(1\\leqslant i\\leqslant N)$ 的右端点 到 绳子的左端点 的距离为 $i$。\n\nJOI 把绳子的长度缩短了。具体来说，JOI 反复地进行以下过程，直到绳长缩短至 $2$。\n\n* 假设此时绳子的长度为 $L$。指定一个整数 $j(1\\leqslant j<L)$，使绳子左数第 $j$ 根线成为绳子的左端点（最左的线），并折叠绳子。也就是说，\n  - 如果 $j\\leqslant \\Large\\frac{L}{2}$，则将左数第 $i$ 根线 $(1\\leqslant i\\leqslant j)$ 与左数第 $(2j-i+1)$ 根线拧成一股。此时，绳子原本的右端点仍是右端点，绳长变为 $L-j$。\n  - 如果 $j> \\Large\\frac{L}{2}$，则将左数第 $i$ 根线 $(2j-L+1\\leqslant i\\leqslant j)$ 与左数第 $(2j-i+1)$ 根线拧成一股。此时，绳子原本的左端点变为右端点，绳长变为 $j$。\n* 两条线的颜色相同才能拧成一股。在将两条线拧成一股前，可以任意改变线的颜色。将线染成其他颜色所需的费用 等于 线的厚度。颜色匹配后，两条线将被拧成一股，新的一股线的厚度 将为 两条线的厚度之和。\n\n我们把绳长缩短至 $2$ 的绳子称为最终的绳子。JOI 希望使得将绳长缩短至 $2$ 所需的费用尽可能小。对于每种颜色，JOI 都想知道，在最终的绳子中包含这种颜色的情况下，将绳长缩短至 $2$ 所需的最小费用。\n\n你的任务是帮 JOI 解决这个问题。", "inputFormat": "第一行有两个整数 $N, M$，用空格分隔。  \n第二行有 $N$ 个用空格分隔的整数 $C_1, C_2, \\ldots, C_N$。  \n输入的所有数的含义见题目描述。", "outputFormat": "共 $M$ 行，第 $c$ 行 $(1\\leqslant c\\leqslant M)$ 有一个整数，表示在最终的绳子中包含颜色 $c$ 的情况下，将绳长缩短至 $2$ 所需的最小费用。", "hint": "#### 样例解释 1\n通过下述步骤，只需花费 $2$，就可以使得最终的绳子中包含颜色 $1$。\n* 把左数第 $2$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $1,$ $ 3,$ $ 3,$ $ 2$，厚度依次是 $2,$ $ 1,$ $ 1,$ $ 1$。\n* 把左数第 $4$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $3, 1$，厚度依次是 $2, 3$。\n\n通过下述步骤，只需花费 $1$，就可以使得最终的绳子中包含颜色 $2$ 和 $3$。\n* 折叠绳子使得 原本到左端点的距离为 $3$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $3,$ $ 2,$ $ 1$，厚度依次是 $2,$ $ 2,$ $ 1$。\n* 把左数第 $3$ 根线染成颜色 $2$。折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $2, 3$，厚度依次是 $3, 2$。\n\n#### 样例解释 2\n通过下述步骤，只需花费 $2$，就可以使得最终的绳子中包含颜色 $1$。\n* 折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。\n* 把左数第 $1$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。注意这次染色的费用为 $2$，因为此时左数第 $1$ 根线的厚度为 $2$。\n* 折叠绳子使得 原本到左端点的距离为 $3$ 的端点 变为 新的左端点。\n* 折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。\n\n#### 数据范围与提示\n对于 $15\\%$ 的数据，$N\\leqslant 15, M\\leqslant 10$。  \n对于另外 $30\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 10$。  \n对于另外 $10\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 500$。  \n对于另外 $20\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 5000$。  \n对于所有数据，$2\\leqslant N\\leqslant 10^6, 1\\leqslant M\\leqslant N, 1\\leqslant C_i\\leqslant M(1\\leqslant i\\leqslant N)$，在初始状态的绳子上，颜色 $1, 2, \\ldots, M$ 都至少出现了一次。", "locale": "zh-CN", "translations": {"en": {"title": "[JOI 2017 Final] Rope / Rope", "background": "", "description": "**This problem is translated from [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T5 「[縄](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Rope](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」.**\n\nJOI is playing with a rope. The rope can be regarded as a line segment extending left and right with length $N$. The rope is made by connecting $N$ pieces of string. Each piece has length $1$ and thickness $1$. There are $M$ colors on the rope. The color of the $i$-th piece from the left $(1\\leqslant i\\leqslant N)$ is $C_i(1\\leqslant C_i\\leqslant M)$. The **left endpoint of the rope** means the left endpoint of the $1$-st piece from the left, and the **right endpoint of the rope** means the right endpoint of the $1$-st piece from the right. Clearly, the distance from the right endpoint of the $i$-th piece from the left $(1\\leqslant i\\leqslant N)$ to the left endpoint of the rope is $i$.\n\nJOI shortened the rope. More precisely, JOI repeatedly performs the following process until the rope length becomes $2$.\n\n- Suppose the current rope length is $L$. Choose an integer $j(1\\leqslant j<L)$, make the $j$-th piece from the left become the left endpoint of the rope (the leftmost piece), and fold the rope. That is,\n  - If $j\\leqslant \\Large\\frac{L}{2}$, then twist the $i$-th piece from the left $(1\\leqslant i\\leqslant j)$ together with the $(2j-i+1)$-th piece from the left. In this case, the original right endpoint of the rope remains the right endpoint, and the rope length becomes $L-j$.\n  - If $j> \\Large\\frac{L}{2}$, then twist the $i$-th piece from the left $(2j-L+1\\leqslant i\\leqslant j)$ together with the $(2j-i+1)$-th piece from the left. In this case, the original left endpoint of the rope becomes the right endpoint, and the rope length becomes $j$.\n- Two pieces can be twisted together only if they have the same color. Before twisting two pieces together, you may change their colors arbitrarily. The cost to dye a piece into another color is equal to the thickness of that piece. After the colors match, the two pieces are twisted into one, and the thickness of the new piece becomes the sum of the thicknesses of the two pieces.\n\nWe call the rope of length $2$ obtained after shortening the **final rope**. JOI wants to minimize the total cost required to shorten the rope to length $2$. For each color, JOI wants to know the minimum cost required to shorten the rope to length $2$ under the condition that the final rope contains this color.\n\nYour task is to help JOI solve this problem.", "inputFormat": "The first line contains two integers $N, M$, separated by spaces.  \nThe second line contains $N$ integers $C_1, C_2, \\ldots, C_N$, separated by spaces.  \nThe meanings of all numbers are given in the statement.", "outputFormat": "Output $M$ lines. The $c$-th line $(1\\leqslant c\\leqslant M)$ contains one integer, representing the minimum cost required to shorten the rope to length $2$ under the condition that the final rope contains color $c$.", "hint": "#### Sample Explanation 1\n\nWith the following steps, you can make the final rope contain color $1$ with total cost $2$.\n\n- Dye the $2$-nd piece from the left into color $1$. Fold the rope so that the endpoint that was originally at distance $1$ from the left endpoint becomes the new left endpoint. Now, from left to right, the colors are $1,$ $3,$ $3,$ $2$, and the thicknesses are $2,$ $1,$ $1,$ $1$.\n- Dye the $4$-th piece from the left into color $1$. Fold the rope so that the endpoint that was originally at distance $2$ from the left endpoint becomes the new left endpoint. Now, from left to right, the colors are $3, 1$, and the thicknesses are $2, 3$.\n\nWith the following steps, you can make the final rope contain colors $2$ and $3$ with total cost $1$.\n\n- Fold the rope so that the endpoint that was originally at distance $3$ from the left endpoint becomes the new left endpoint. Now, from left to right, the colors are $3,$ $2,$ $1$, and the thicknesses are $2,$ $2,$ $1$.\n- Dye the $3$-rd piece from the left into color $2$. Fold the rope so that the endpoint that was originally at distance $2$ from the left endpoint becomes the new left endpoint. Now, from left to right, the colors are $2, 3$, and the thicknesses are $3, 2$.\n\n#### Sample Explanation 2\n\nWith the following steps, you can make the final rope contain color $1$ with total cost $2$.\n\n- Fold the rope so that the endpoint that was originally at distance $2$ from the left endpoint becomes the new left endpoint.\n- Dye the $1$-st piece from the left into color $1$. Fold the rope so that the endpoint that was originally at distance $1$ from the left endpoint becomes the new left endpoint. Note that the cost of this dyeing is $2$, because at this time the thickness of the $1$-st piece from the left is $2$.\n- Fold the rope so that the endpoint that was originally at distance $3$ from the left endpoint becomes the new left endpoint.\n- Fold the rope so that the endpoint that was originally at distance $1$ from the left endpoint becomes the new left endpoint.\n\n#### Constraints and Hints\n\nFor $15\\%$ of the testdata, $N\\leqslant 15, M\\leqslant 10$.  \nFor another $30\\%$ of the testdata, $N\\leqslant 10^5, M\\leqslant 10$.  \nFor another $10\\%$ of the testdata, $N\\leqslant 10^5, M\\leqslant 500$.  \nFor another $20\\%$ of the testdata, $N\\leqslant 10^5, M\\leqslant 5000$.  \nFor all testdata, $2\\leqslant N\\leqslant 10^6, 1\\leqslant M\\leqslant N, 1\\leqslant C_i\\leqslant M(1\\leqslant i\\leqslant N)$, and in the initial rope, each color $1, 2, \\ldots, M$ appears at least once.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JOI 2017 Final] 绳 / Rope", "background": "", "description": "**题目译自 [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T5「[縄](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Rope](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」**\n\n JOI 小宝宝正拿着一根绳子玩。绳子可视为一条长度为 $N$ 的左右延伸的线段。绳子由 $N$ 根线连接而成，每根线的长度为 $1$，厚度为 $1$。绳子上的线共有 $M$ 种颜色，左数第 $i$ 根线 $(1\\leqslant i\\leqslant N)$ 的颜色为 $C_i(1\\leqslant C_i\\leqslant M)$。**绳子的左端点**意为左数第 $1$ 根线的左端点，**绳子的右端点**意为右数第 $1$ 根线的右端点。显然左数第 $i$ 根线 $(1\\leqslant i\\leqslant N)$ 的右端点 到 绳子的左端点 的距离为 $i$。\n\nJOI 把绳子的长度缩短了。具体来说，JOI 反复地进行以下过程，直到绳长缩短至 $2$。\n\n* 假设此时绳子的长度为 $L$。指定一个整数 $j(1\\leqslant j<L)$，使绳子左数第 $j$ 根线成为绳子的左端点（最左的线），并折叠绳子。也就是说，\n  - 如果 $j\\leqslant \\Large\\frac{L}{2}$，则将左数第 $i$ 根线 $(1\\leqslant i\\leqslant j)$ 与左数第 $(2j-i+1)$ 根线拧成一股。此时，绳子原本的右端点仍是右端点，绳长变为 $L-j$。\n  - 如果 $j> \\Large\\frac{L}{2}$，则将左数第 $i$ 根线 $(2j-L+1\\leqslant i\\leqslant j)$ 与左数第 $(2j-i+1)$ 根线拧成一股。此时，绳子原本的左端点变为右端点，绳长变为 $j$。\n* 两条线的颜色相同才能拧成一股。在将两条线拧成一股前，可以任意改变线的颜色。将线染成其他颜色所需的费用 等于 线的厚度。颜色匹配后，两条线将被拧成一股，新的一股线的厚度 将为 两条线的厚度之和。\n\n我们把绳长缩短至 $2$ 的绳子称为最终的绳子。JOI 希望使得将绳长缩短至 $2$ 所需的费用尽可能小。对于每种颜色，JOI 都想知道，在最终的绳子中包含这种颜色的情况下，将绳长缩短至 $2$ 所需的最小费用。\n\n你的任务是帮 JOI 解决这个问题。", "inputFormat": "第一行有两个整数 $N, M$，用空格分隔。  \n第二行有 $N$ 个用空格分隔的整数 $C_1, C_2, \\ldots, C_N$。  \n输入的所有数的含义见题目描述。", "outputFormat": "共 $M$ 行，第 $c$ 行 $(1\\leqslant c\\leqslant M)$ 有一个整数，表示在最终的绳子中包含颜色 $c$ 的情况下，将绳长缩短至 $2$ 所需的最小费用。", "hint": "#### 样例解释 1\n通过下述步骤，只需花费 $2$，就可以使得最终的绳子中包含颜色 $1$。\n* 把左数第 $2$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $1,$ $ 3,$ $ 3,$ $ 2$，厚度依次是 $2,$ $ 1,$ $ 1,$ $ 1$。\n* 把左数第 $4$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $3, 1$，厚度依次是 $2, 3$。\n\n通过下述步骤，只需花费 $1$，就可以使得最终的绳子中包含颜色 $2$ 和 $3$。\n* 折叠绳子使得 原本到左端点的距离为 $3$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $3,$ $ 2,$ $ 1$，厚度依次是 $2,$ $ 2,$ $ 1$。\n* 把左数第 $3$ 根线染成颜色 $2$。折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $2, 3$，厚度依次是 $3, 2$。\n\n#### 样例解释 2\n通过下述步骤，只需花费 $2$，就可以使得最终的绳子中包含颜色 $1$。\n* 折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。\n* 把左数第 $1$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。注意这次染色的费用为 $2$，因为此时左数第 $1$ 根线的厚度为 $2$。\n* 折叠绳子使得 原本到左端点的距离为 $3$ 的端点 变为 新的左端点。\n* 折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。\n\n#### 数据范围与提示\n对于 $15\\%$ 的数据，$N\\leqslant 15, M\\leqslant 10$。  \n对于另外 $30\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 10$。  \n对于另外 $10\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 500$。  \n对于另外 $20\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 5000$。  \n对于所有数据，$2\\leqslant N\\leqslant 10^6, 1\\leqslant M\\leqslant N, 1\\leqslant C_i\\leqslant M(1\\leqslant i\\leqslant N)$，在初始状态的绳子上，颜色 $1, 2, \\ldots, M$ 都至少出现了一次。", "locale": "zh-CN"}}}
{"pid": "P5102", "type": "P", "difficulty": 7, "samples": [["12 1\nEENWSEEESWWS", "3"], ["12 2\nEENWSEEESWWS", "7"], ["7 1\nENNWNNE", "0"], ["16 5\nWSESSSWWWEEENNNW", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "JOI（日本）"], "title": "[JOI 2016 Final] 领地 / Territory", "background": "", "description": "**本题译自 [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T4「[縄張り](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)」**\n\n有一个平面直角坐标系。JOI 君位于 $(0, 0)$ 。  \nJOI 君**每天**都按照一个固定的程序移动一轮。该程序有 $N$ 个步骤，用一个长度为 $N$ 的字符串 $S$ 描述。这个字符串仅由大写字母 $\\texttt{E, N, W, S}$ 构成。  \n左数第 $i$ 个字符 $C_i (1\\leqslant i\\leqslant N)$ 表示 JOI 君会移动到哪里。如果在执行步骤 $i$ 前，JOI 君位于 $(x, y)$：\n* $C_i=\\texttt{E}$：JOI 君将移动到 $(x+1,y)$；\n* $C_i=\\texttt{N}$：JOI 君将移动到 $(x,y+1)$；\n* $C_i=\\texttt{W}$：JOI 君将移动到 $(x-1,y)$；\n* $C_i=\\texttt{S}$：JOI 君将移动到 $(x,y-1)$。\n\n次日 JOI 君会从他前一天停止的位置开始执行程序。  \nJOI 君会把 $(0, 0)$ 以及每个步骤结束后到达的点作标记。开始时 JOI 君没有标记任何点。$K$ 天后，对于任意整数 $a, b$，如果 $(a,b),$ $(a+1,b),$ $(a,b+1),$ $(a+1,b+1)$ 这四个点都被标记了一次或以上，以这四个点为顶点的 $1\\times 1$ 的正方形就属于 JOI 君的领地。  \n请问 $K$ 天后，JOI 君有多少个领地。", "inputFormat": "第一行有两个整数 $N, K$，用空格分隔。  \n第二行有一个字符串 $S$，表示 JOI 君移动的程序。", "outputFormat": "一个整数，表示 JOI 君有多少个领地。", "hint": "#### 样例解释 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5h9x63g9.png)\n\n> 图中的字是之前完整题面的，懒得改了。「市政厅」表示 $(0, 0)$，「散步路径」表示移动路线。  \n> 图我没有仔细 PS 过，可能对不齐、不对称，强迫症的同学们麻烦忍一忍\n\n#### 样例解释 2\n样例 2 与样例 1 的不同在于在样例 2 中 JOI 君走了两天。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/26nj2fc2.png)\n\n#### 数据范围与提示\n对于所有数据，$1\\leqslant N\\leqslant 10^5, 1\\leqslant K\\leqslant 10^9$。\n\n|Subtask #|特殊限制|分值|\n|-|-|-|\n|1|$N\\leqslant 50, K = 1$|5|\n|2|$K = 1$|10|\n|3|$N\\leqslant 50$|23|\n|4|无|62|", "locale": "zh-CN", "translations": {"en": {"title": "[JOI 2016 Final] Territory / Territory", "background": "", "description": "**This problem is translated from [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T4 “[縄張り](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)”.**\n\nThere is a Cartesian coordinate plane. JOI is at $(0, 0)$.  \nEvery day, JOI follows a fixed procedure and makes one round of moves. The procedure has $N$ steps and is described by a string $S$ of length $N$. This string consists only of the uppercase letters $\\texttt{E, N, W, S}$.  \nThe $i$-th character from the left, $C_i\\ (1\\leqslant i\\leqslant N)$, indicates where JOI will move. If before executing step $i$, JOI is at $(x, y)$:\n\n* If $C_i=\\texttt{E}$, JOI moves to $(x+1,y)$.\n* If $C_i=\\texttt{N}$, JOI moves to $(x,y+1)$.\n* If $C_i=\\texttt{W}$, JOI moves to $(x-1,y)$.\n* If $C_i=\\texttt{S}$, JOI moves to $(x,y-1)$.\n\nOn the next day, JOI starts executing the procedure from where he stopped the previous day.  \nJOI marks $(0, 0)$ and every point he reaches after finishing each step. At the beginning, JOI has not marked any points. After $K$ days, for any integers $a, b$, if the four points $(a,b)$, $(a+1,b)$, $(a,b+1)$, $(a+1,b+1)$ have each been marked at least once, then the $1\\times 1$ square with these four points as vertices belongs to JOI’s territory.  \nFind how many territories JOI has after $K$ days.", "inputFormat": "The first line contains two integers $N, K$, separated by spaces.  \nThe second line contains a string $S$, representing JOI’s movement procedure.", "outputFormat": "Output one integer, the number of territories JOI has.", "hint": "#### Sample Explanation 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5h9x63g9.png)\n\n> The text in the figure is from the previous full statement, and I was too lazy to modify it. “市政厅” means $(0, 0)$, and “散步路径” means the movement path.  \n> I did not carefully edit the image, so it may be misaligned or not symmetric. Please bear with it.\n\n#### Sample Explanation 2\n\nThe difference between Sample 2 and Sample 1 is that in Sample 2, JOI walked for two days.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/26nj2fc2.png)\n\n#### Constraints and Hints\n\nFor all testdata, $1\\leqslant N\\leqslant 10^5$, $1\\leqslant K\\leqslant 10^9$.\n\n|Subtask #|Special Constraints|Points|\n|-|-|-|\n|1|$N\\leqslant 50, K = 1$|5|\n|2|$K = 1$|10|\n|3|$N\\leqslant 50$|23|\n|4|None|62|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JOI 2016 Final] 领地 / Territory", "background": "", "description": "**本题译自 [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T4「[縄張り](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)」**\n\n有一个平面直角坐标系。JOI 君位于 $(0, 0)$ 。  \nJOI 君**每天**都按照一个固定的程序移动一轮。该程序有 $N$ 个步骤，用一个长度为 $N$ 的字符串 $S$ 描述。这个字符串仅由大写字母 $\\texttt{E, N, W, S}$ 构成。  \n左数第 $i$ 个字符 $C_i (1\\leqslant i\\leqslant N)$ 表示 JOI 君会移动到哪里。如果在执行步骤 $i$ 前，JOI 君位于 $(x, y)$：\n* $C_i=\\texttt{E}$：JOI 君将移动到 $(x+1,y)$；\n* $C_i=\\texttt{N}$：JOI 君将移动到 $(x,y+1)$；\n* $C_i=\\texttt{W}$：JOI 君将移动到 $(x-1,y)$；\n* $C_i=\\texttt{S}$：JOI 君将移动到 $(x,y-1)$。\n\n次日 JOI 君会从他前一天停止的位置开始执行程序。  \nJOI 君会把 $(0, 0)$ 以及每个步骤结束后到达的点作标记。开始时 JOI 君没有标记任何点。$K$ 天后，对于任意整数 $a, b$，如果 $(a,b),$ $(a+1,b),$ $(a,b+1),$ $(a+1,b+1)$ 这四个点都被标记了一次或以上，以这四个点为顶点的 $1\\times 1$ 的正方形就属于 JOI 君的领地。  \n请问 $K$ 天后，JOI 君有多少个领地。", "inputFormat": "第一行有两个整数 $N, K$，用空格分隔。  \n第二行有一个字符串 $S$，表示 JOI 君移动的程序。", "outputFormat": "一个整数，表示 JOI 君有多少个领地。", "hint": "#### 样例解释 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5h9x63g9.png)\n\n> 图中的字是之前完整题面的，懒得改了。「市政厅」表示 $(0, 0)$，「散步路径」表示移动路线。  \n> 图我没有仔细 PS 过，可能对不齐、不对称，强迫症的同学们麻烦忍一忍\n\n#### 样例解释 2\n样例 2 与样例 1 的不同在于在样例 2 中 JOI 君走了两天。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/26nj2fc2.png)\n\n#### 数据范围与提示\n对于所有数据，$1\\leqslant N\\leqslant 10^5, 1\\leqslant K\\leqslant 10^9$。\n\n|Subtask #|特殊限制|分值|\n|-|-|-|\n|1|$N\\leqslant 50, K = 1$|5|\n|2|$K = 1$|10|\n|3|$N\\leqslant 50$|23|\n|4|无|62|", "locale": "zh-CN"}}}
{"pid": "P5103", "type": "P", "difficulty": 7, "samples": [["10 2\n12 1 3\n2 2 2", "3\n3\n5\n5\n5\n5\n5\n5\n2\n2"], ["10 6\n14 1 1\n17 1 1\n-6 2 1\n3 2 1\n4 1 1\n0 2 1", "5\n5\n4\n5\n5\n5\n5\n5\n4\n4"], ["15 10\n28 1 7\n-24 2 1\n1 1 1\n8 1 1\n6 2 1\n20 1 3\n12 2 2\n-10 1 3\n7 2 1\n5 1 2", "15\n14\n14\n14\n14\n12\n12\n12\n12\n12\n12\n12\n15\n15\n12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "JOI（日本）"], "title": "[JOI 2016 Final] 断层 / Geologic Fault", "background": "", "description": "**译者水平有限，跪求各位大佬提供更好的译文**\n\n**本题译自 [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T5「[断層](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)」**\n\n很久很久以前，一个叫做 IOI 的先进文明蓬勃发展。时过境迁，现代考古学家 JOI 博士决定挖掘 IOI 文明遗址。\n\nIOI 文明沿着笔直的河流发展。方便起见，IOI 文明遗址可以看作平面直角坐标系的 $x$ 轴，而 $y$ 轴表示海拔。IOI 文明地面平坦，也就是说，直线 $y=0$ 代表地面，而 $y>0$ 代表地面上空，$y<0$ 代表地下。另外，由于流水堆积，IOI 文明的地面一直在缓慢升高。IOI 文明灭亡前 $a$ 年 $(a\\geqslant 0)$ 时，直线 $y=-a$ 才是地平面。  \nIOI 文明灭亡后，它脚下的地层发生了 $Q$ 次运动。第 $i$ 次运动 $(1\\leqslant i\\leqslant Q)$ 可用位置 $X_i$，方向 $D_i$ 和变化量 $L_i$ 描述。$D_i = 1$ 或 $2$。具体来说，\n\n* $D_i=1$：断层视为一条过 $(X_i, 0)$，斜率为 $1$ 的直线。断层上方的地层斜向上移动，横坐标增加 $L_i$，纵坐标增加 $L_i$。也就是说，直线上方的所有点 $(x,y)$ 移动到 $(x+L_i, y+L_i)$。\n* $D_i=2$：断层视为一条过 $(X_i, 0)$，斜率为 $-1$ 的直线。断层上方的地层斜向上移动，横坐标减少 $L_i$，纵坐标增加 $L_i$。也就是说，直线上方的所有点 $(x,y)$ 移动到 $(x-L_i, y+L_i)$。\n\n每次地壳运动后，$y>0$ 的地层都会因风化作用而消失。\n\n试求：对于每一个 $i(1\\leqslant i\\leqslant N)$，**点 $(i-1,0)$ 和 点$(i,0)$ 之间的地层**是在 IOI 文明灭亡前哪一年的地层。 \n\n> 在 $y$ 轴上，断层都是经过整点的，$y$ 轴上的相邻整点间没有断层。这样讲能明白吧……\n", "inputFormat": "第一行有两个整数 $N,Q$，用空格分隔。  \n在接下来的 $Q$ 行中，第 $i$ 行 $(1\\leqslant i\\leqslant N)$ 有三个整数 $X_i, D_i, L_i$，用空格分隔。  \n输入的所有数的含义见题目描述。", "outputFormat": "输出共 $N$ 行，第 $i$ 行 $(1\\leqslant i\\leqslant N)$ 有一个整数，表示点 $(i-1,0)$ 和 点$(i,0)$ 之间的地层是在 IOI 文明灭亡前哪一年的地层。 ", "hint": "#### 样例解释 1\n![](https://cdn.luogu.com.cn/upload/image_hosting/uxq94hp7.png)\n\n#### 数据范围与提示\n对于所有数据，$1\\leqslant N, Q\\leqslant 2\\times 10^5, -10^9\\leqslant X_i\\leqslant 10^9, D_i=1$ 或 $2, 1\\leqslant L_i\\leqslant 10^9(1\\leqslant i\\leqslant Q)$。\n\n|Subtask #|$N,Q$|其他限制|分值|\n|-|-|-|-|\n|1|$N,Q\\leqslant 100$|$-100\\leqslant X_i\\leqslant 100, L_i=1(1\\leqslant i\\leqslant Q)$|18|\n|2|$N,Q\\leqslant 3000$|无|16|\n|3|$N,Q\\leqslant 2\\times10^5$|无|66|", "locale": "zh-CN", "translations": {"en": {"title": "[JOI 2016 Final] Fault / Geologic Fault", "background": "", "description": "**The translator’s ability is limited; I sincerely ask everyone to provide a better translation.**\n\n**This problem is translated from [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T5 “[断層](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)”.**\n\nA very long time ago, an advanced civilization called IOI flourished. As time passed, the modern archaeologist Dr. JOI decided to excavate the ruins of the IOI civilization.\n\nThe IOI civilization developed along a straight river. For convenience, the ruins of the IOI civilization can be regarded as the $x$ axis of the Cartesian coordinate plane, and the $y$ axis represents altitude. The ground surface of the IOI civilization is flat; that is, the line $y=0$ represents the ground, $y>0$ is above the ground, and $y<0$ is underground. In addition, due to sediment deposition, the ground of the IOI civilization kept rising slowly. At $a$ years before the fall of the IOI civilization $(a\\geqslant 0)$, the line $y=-a$ was the ground surface.\n\nAfter the IOI civilization fell, the strata beneath it moved $Q$ times. The $i$-th movement $(1\\leqslant i\\leqslant Q)$ is described by position $X_i$, direction $D_i$, and amount $L_i$. $D_i$ is $1$ or $2$. Specifically,\n\n* $D_i=1$: The fault is considered to be a line passing through $(X_i, 0)$ with slope $1$. The strata above the fault move diagonally upward: the $x$ coordinate increases by $L_i$, and the $y$ coordinate increases by $L_i$. That is, every point $(x,y)$ above the line moves to $(x+L_i, y+L_i)$.\n* $D_i=2$: The fault is considered to be a line passing through $(X_i, 0)$ with slope $-1$. The strata above the fault move diagonally upward: the $x$ coordinate decreases by $L_i$, and the $y$ coordinate increases by $L_i$. That is, every point $(x,y)$ above the line moves to $(x-L_i, y+L_i)$.\n\nAfter each crustal movement, all strata with $y>0$ disappear due to weathering.\n\nYou are asked: for each $i$ $(1\\leqslant i\\leqslant N)$, determine **which year before the fall of the IOI civilization the stratum between point $(i-1,0)$ and point $(i,0)$ comes from**.\n\n> On the $y$ axis, every fault passes through an integer point, and there is no fault between two adjacent integer points on the $y$ axis. This should be clear, right……", "inputFormat": "The first line contains two integers $N, Q$, separated by spaces.  \nIn the next $Q$ lines, the $i$-th line $(1\\leqslant i\\leqslant Q)$ contains three integers $X_i, D_i, L_i$, separated by spaces.  \nThe meanings of all input values are given in the statement.", "outputFormat": "Output $N$ lines in total.  \nThe $i$-th line $(1\\leqslant i\\leqslant N)$ contains one integer, indicating which year before the fall of the IOI civilization the stratum between point $(i-1,0)$ and point $(i,0)$ comes from.", "hint": "#### Sample Explanation 1\n![](https://cdn.luogu.com.cn/upload/image_hosting/uxq94hp7.png)\n\n#### Constraints and Notes\nFor all testdata, $1\\leqslant N, Q\\leqslant 2\\times 10^5$, $-10^9\\leqslant X_i\\leqslant 10^9$, $D_i=1$ or $2$, $1\\leqslant L_i\\leqslant 10^9$ $(1\\leqslant i\\leqslant Q)$.\n\n|Subtask #|$N,Q$|Other Constraints|Score|\n|-|-|-|-|\n|1|$N,Q\\leqslant 100$|$-100\\leqslant X_i\\leqslant 100$, $L_i=1$ $(1\\leqslant i\\leqslant Q)$|18|\n|2|$N,Q\\leqslant 3000$|None.|16|\n|3|$N,Q\\leqslant 2\\times10^5$|None.|66|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JOI 2016 Final] 断层 / Geologic Fault", "background": "", "description": "**译者水平有限，跪求各位大佬提供更好的译文**\n\n**本题译自 [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T5「[断層](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)」**\n\n很久很久以前，一个叫做 IOI 的先进文明蓬勃发展。时过境迁，现代考古学家 JOI 博士决定挖掘 IOI 文明遗址。\n\nIOI 文明沿着笔直的河流发展。方便起见，IOI 文明遗址可以看作平面直角坐标系的 $x$ 轴，而 $y$ 轴表示海拔。IOI 文明地面平坦，也就是说，直线 $y=0$ 代表地面，而 $y>0$ 代表地面上空，$y<0$ 代表地下。另外，由于流水堆积，IOI 文明的地面一直在缓慢升高。IOI 文明灭亡前 $a$ 年 $(a\\geqslant 0)$ 时，直线 $y=-a$ 才是地平面。  \nIOI 文明灭亡后，它脚下的地层发生了 $Q$ 次运动。第 $i$ 次运动 $(1\\leqslant i\\leqslant Q)$ 可用位置 $X_i$，方向 $D_i$ 和变化量 $L_i$ 描述。$D_i = 1$ 或 $2$。具体来说，\n\n* $D_i=1$：断层视为一条过 $(X_i, 0)$，斜率为 $1$ 的直线。断层上方的地层斜向上移动，横坐标增加 $L_i$，纵坐标增加 $L_i$。也就是说，直线上方的所有点 $(x,y)$ 移动到 $(x+L_i, y+L_i)$。\n* $D_i=2$：断层视为一条过 $(X_i, 0)$，斜率为 $-1$ 的直线。断层上方的地层斜向上移动，横坐标减少 $L_i$，纵坐标增加 $L_i$。也就是说，直线上方的所有点 $(x,y)$ 移动到 $(x-L_i, y+L_i)$。\n\n每次地壳运动后，$y>0$ 的地层都会因风化作用而消失。\n\n试求：对于每一个 $i(1\\leqslant i\\leqslant N)$，**点 $(i-1,0)$ 和 点$(i,0)$ 之间的地层**是在 IOI 文明灭亡前哪一年的地层。 \n\n> 在 $y$ 轴上，断层都是经过整点的，$y$ 轴上的相邻整点间没有断层。这样讲能明白吧……\n", "inputFormat": "第一行有两个整数 $N,Q$，用空格分隔。  \n在接下来的 $Q$ 行中，第 $i$ 行 $(1\\leqslant i\\leqslant N)$ 有三个整数 $X_i, D_i, L_i$，用空格分隔。  \n输入的所有数的含义见题目描述。", "outputFormat": "输出共 $N$ 行，第 $i$ 行 $(1\\leqslant i\\leqslant N)$ 有一个整数，表示点 $(i-1,0)$ 和 点$(i,0)$ 之间的地层是在 IOI 文明灭亡前哪一年的地层。 ", "hint": "#### 样例解释 1\n![](https://cdn.luogu.com.cn/upload/image_hosting/uxq94hp7.png)\n\n#### 数据范围与提示\n对于所有数据，$1\\leqslant N, Q\\leqslant 2\\times 10^5, -10^9\\leqslant X_i\\leqslant 10^9, D_i=1$ 或 $2, 1\\leqslant L_i\\leqslant 10^9(1\\leqslant i\\leqslant Q)$。\n\n|Subtask #|$N,Q$|其他限制|分值|\n|-|-|-|-|\n|1|$N,Q\\leqslant 100$|$-100\\leqslant X_i\\leqslant 100, L_i=1(1\\leqslant i\\leqslant Q)$|18|\n|2|$N,Q\\leqslant 3000$|无|16|\n|3|$N,Q\\leqslant 2\\times10^5$|无|66|", "locale": "zh-CN"}}}
{"pid": "P5104", "type": "P", "difficulty": 4, "samples": [["2 1 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["概率论", "期望", "逆元"], "title": "红包发红包", "background": "红包（redbag）发明了一个抢红包的系统。", "description": "这个抢红包系统是这样的：假如现在有 $w$ 元，那么你抢红包能抢到的钱就是 $[0,w]$ 等概率均匀随机出的一个实数 $x$。\n\n现在红包发了一个 $w$ 元的红包，有 $n$ 个人来抢。那么请问第 $k$ 个人期望抢到多少钱？\n\n输出答案对 $10^9+7$ 取模后的结果。\n", "inputFormat": "一行三个整数，$w,n,k$。", "outputFormat": "第 $k$ 个人期望抢到的钱数对 $10^9+7$ 取模后的结果。\n\n补充：期望可能是分数，关于分数取模，可以问度娘。\n", "hint": "注意红包发明的抢红包系统和微信的抢红包系统不一样，红包发明的抢红包系统中的钱不一定是整数分。\n\n- 对于 $30\\%$ 的数据，$k=1$\n- 另有 $30\\%$ 的数据，期望值取模前为整数，$k\\le 10$。\n\n对于全部数据，$0< w< (10^9+7)$，$n\\le 10^{18},k\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "Redbag Gives Redbags", "background": "Redbag invented a redbag-grabbing system.", "description": "This redbag-grabbing system works like this: suppose there are currently $w$ yuan. Then the amount of money you can get from grabbing a redbag is a real number $x$ chosen uniformly at random from $[0,w]$ with equal probability.\n\nNow Redbag releases a redbag worth $w$ yuan, and there are $n$ people grabbing it. What is the expected amount of money that the $k$-th person will get?\n\nOutput the result modulo $10^9+7$.", "inputFormat": "One line with three integers, $w,n,k$.", "outputFormat": "Output the expected amount of money the $k$-th person gets, taken modulo $10^9+7$.\n\nNote: The expectation may be a fraction. For how to take a fraction modulo, you can search online (Du Niang).", "hint": "Note that Redbag’s redbag-grabbing system is different from WeChat’s redbag system. In Redbag’s system, the money is not necessarily an integer number of cents.\n\n- For $30\\%$ of the testdata, $k=1$.\n- For another $30\\%$ of the testdata, the expectation is an integer before taking modulo, and $k\\le 10$.\n\nFor all testdata, $0< w< (10^9+7)$, $n\\le 10^{18},k\\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "红包发红包", "background": "红包（redbag）发明了一个抢红包的系统。", "description": "这个抢红包系统是这样的：假如现在有 $w$ 元，那么你抢红包能抢到的钱就是 $[0,w]$ 等概率均匀随机出的一个实数 $x$。\n\n现在红包发了一个 $w$ 元的红包，有 $n$ 个人来抢。那么请问第 $k$ 个人期望抢到多少钱？\n\n输出答案对 $10^9+7$ 取模后的结果。\n", "inputFormat": "一行三个整数，$w,n,k$。", "outputFormat": "第 $k$ 个人期望抢到的钱数对 $10^9+7$ 取模后的结果。\n\n补充：期望可能是分数，关于分数取模，可以问度娘。\n", "hint": "注意红包发明的抢红包系统和微信的抢红包系统不一样，红包发明的抢红包系统中的钱不一定是整数分。\n\n- 对于 $30\\%$ 的数据，$k=1$\n- 另有 $30\\%$ 的数据，期望值取模前为整数，$k\\le 10$。\n\n对于全部数据，$0< w< (10^9+7)$，$n\\le 10^{18},k\\le n$。", "locale": "zh-CN"}}}
{"pid": "P5105", "type": "P", "difficulty": 6, "samples": [["2\n1 1 1\n2\n", "0\n"], ["10\n1 22 27\n1 50 55\n1 82 87\n1 2 7\n2\n1 47 52\n1 62 67\n1 61 66\n1 41 46\n2", "2515\n2141\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "O2优化", "差分"], "title": "不强制在线的动态快速排序", "background": "曦月最近学会了快速排序，但是她很快地想到了，如果要动态地排序，那要怎么办呢？\n", "description": "为了研究这个问题，曦月提出了一个十分简单的问题\n\n曦月希望维护一个允许重复的集合$S$，支持：\n\n* 插入$[L, R]$，也就是插入$L, L + 1 ... , R$，这$R - L + 1$个数\n\n* 询问$Sort(S)$\n\n---\n\n$Sort(S)$的定义为：\n\n我们将集合$S$中的元素**从小到大按照快速排序**排好序，记为$a_1, a_2 ... a_n$\n\n那么，$Sort(S) = \\bigoplus \\limits_{i = 2}^n (a_i^2 - a_{i - 1}^2)$，其中$\\bigoplus$表示异或和\n\n关于异或的定义，请咨询度娘", "inputFormat": "第一行，一个数$q$\n\n后$q$行，或者是$1\\;l\\;r$，表示插入$[l, r]$，或者是$2$，表示一次询问", "outputFormat": "对于每个询问，一行一个答案", "hint": "对于样例一的解释：\n\n$S$中只有一个数，因此返回$0$\n\n---\n\n对于$30$分的数据，$q \\leqslant 100$\n\n对于$50$分的数据，$q \\leqslant 5 * 10^4$\n\n对于另外的$20$分的数据，满足$L = R$\n\n对于$100$分的数据，$q \\leqslant 3 * 10^5$，$1 \\leqslant L \\leqslant R \\leqslant 10^9$\n\n保证数据有梯度，可能略微地有卡常，请把自己的常数优化到极致", "locale": "zh-CN", "translations": {"en": {"title": "Dynamic Quicksort Not Forced to Be Online", "background": "Xiyue recently learned quicksort, but she soon thought: if we need to sort dynamically, what should we do?", "description": "To study this problem, Xiyue proposed a very simple question.\n\nXiyue wants to maintain a multiset $S$ that allows duplicates, supporting:\n\n* Insert $[L, R]$, i.e., insert $L, L + 1 ... , R$, these $R - L + 1$ numbers.\n\n* Query $Sort(S)$.\n\n---\n\nThe definition of $Sort(S)$ is:\n\nWe sort the elements in $S$ from small to large **using quicksort**, denoted as $a_1, a_2 ... a_n$.\n\nThen, $Sort(S) = \\bigoplus \\limits_{i = 2}^n (a_i^2 - a_{i - 1}^2)$, where $\\bigoplus$ denotes XOR.\n\nFor the definition of XOR, please consult Baidu.", "inputFormat": "The first line contains an integer $q$.\n\nThe next $q$ lines are either $1\\;l\\;r$, meaning insert $[l, r]$, or $2$, meaning one query.", "outputFormat": "For each query, output one line with one answer.", "hint": "Explanation for Sample 1:\n\n$S$ contains only one number, so return $0$.\n\n---\n\nConstraints:\n\nFor the $30$ points testdata, $q \\leqslant 100$.\n\nFor the $50$ points testdata, $q \\leqslant 5 * 10^4$.\n\nFor the other $20$ points testdata, $L = R$.\n\nFor the $100$ points testdata, $q \\leqslant 3 * 10^5$, $1 \\leqslant L \\leqslant R \\leqslant 10^9$.\n\nThe testdata is guaranteed to have gradients. It may be slightly sensitive to constants, so please optimize your constants as much as possible.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "不强制在线的动态快速排序", "background": "曦月最近学会了快速排序，但是她很快地想到了，如果要动态地排序，那要怎么办呢？\n", "description": "为了研究这个问题，曦月提出了一个十分简单的问题\n\n曦月希望维护一个允许重复的集合$S$，支持：\n\n* 插入$[L, R]$，也就是插入$L, L + 1 ... , R$，这$R - L + 1$个数\n\n* 询问$Sort(S)$\n\n---\n\n$Sort(S)$的定义为：\n\n我们将集合$S$中的元素**从小到大按照快速排序**排好序，记为$a_1, a_2 ... a_n$\n\n那么，$Sort(S) = \\bigoplus \\limits_{i = 2}^n (a_i^2 - a_{i - 1}^2)$，其中$\\bigoplus$表示异或和\n\n关于异或的定义，请咨询度娘", "inputFormat": "第一行，一个数$q$\n\n后$q$行，或者是$1\\;l\\;r$，表示插入$[l, r]$，或者是$2$，表示一次询问", "outputFormat": "对于每个询问，一行一个答案", "hint": "对于样例一的解释：\n\n$S$中只有一个数，因此返回$0$\n\n---\n\n对于$30$分的数据，$q \\leqslant 100$\n\n对于$50$分的数据，$q \\leqslant 5 * 10^4$\n\n对于另外的$20$分的数据，满足$L = R$\n\n对于$100$分的数据，$q \\leqslant 3 * 10^5$，$1 \\leqslant L \\leqslant R \\leqslant 10^9$\n\n保证数据有梯度，可能略微地有卡常，请把自己的常数优化到极致", "locale": "zh-CN"}}}
{"pid": "P5106", "type": "P", "difficulty": 6, "samples": [["2 2", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "dkw的lcm", "background": "", "description": "**特别地，一个数的lcm是自身**\n\n善良的dkw决定直接告诉你题面：\n$$\\prod_{i_1=1}^n\\prod_{i_2=1}^n …\\prod_{i_k=1}^n \\varphi\\big(lcm(i_1,i_2,…,i_k)\\big)$$\n请你求上述式子，答案对 $10^9+7$ 取模。\n\n其中 $lcm(i_1,i_2,...,i_k)$ 代表这 $k$ 个数的最小公倍数。\n\n其中 $\\varphi$ 代表欧拉函数，不知道的可以问度娘。\n\n其中 $\\prod$ 代表连乘符号，简单来说就是 $\\sum$ 的乘法版。", "inputFormat": "两个正整数，$n,k$", "outputFormat": "一个非负整数，代表式子的值对 $10^9+7$ 取模的结果。", "hint": "对于 50% 的数据，$1\\le n,k\\le 8$\n\n对于 100% 的数据，$1\\le n,k\\le 10^6$", "locale": "zh-CN", "translations": {"en": {"title": "dkw's LCM.", "background": "", "description": "In particular, the LCM of a single number is the number itself.\n\nKind dkw decides to tell you the statement directly:\n$$\\prod_{i_1=1}^n\\prod_{i_2=1}^n …\\prod_{i_k=1}^n \\varphi\\big(lcm(i_1,i_2,…,i_k)\\big)$$\nPlease compute the expression above, and output the answer modulo $10^9+7$.\n\nHere, $lcm(i_1,i_2,...,i_k)$ denotes the least common multiple of these $k$ numbers.\n\nHere, $\\varphi$ denotes Euler's totient function.\n\nHere, $\\prod$ denotes the product symbol, which is the multiplicative version of $\\sum$.", "inputFormat": "Two positive integers, $n,k$.", "outputFormat": "One non-negative integer, representing the value of the expression modulo $10^9+7$.", "hint": "For 50% of the testdata, $1\\le n,k\\le 8$.\n\nFor 100% of the testdata, $1\\le n,k\\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "dkw的lcm", "background": "", "description": "**特别地，一个数的lcm是自身**\n\n善良的dkw决定直接告诉你题面：\n$$\\prod_{i_1=1}^n\\prod_{i_2=1}^n …\\prod_{i_k=1}^n \\varphi\\big(lcm(i_1,i_2,…,i_k)\\big)$$\n请你求上述式子，答案对 $10^9+7$ 取模。\n\n其中 $lcm(i_1,i_2,...,i_k)$ 代表这 $k$ 个数的最小公倍数。\n\n其中 $\\varphi$ 代表欧拉函数，不知道的可以问度娘。\n\n其中 $\\prod$ 代表连乘符号，简单来说就是 $\\sum$ 的乘法版。", "inputFormat": "两个正整数，$n,k$", "outputFormat": "一个非负整数，代表式子的值对 $10^9+7$ 取模的结果。", "hint": "对于 50% 的数据，$1\\le n,k\\le 8$\n\n对于 100% 的数据，$1\\le n,k\\le 10^6$", "locale": "zh-CN"}}}
{"pid": "P5107", "type": "P", "difficulty": 5, "samples": [["5 10 3\n4 5 3 2 7 \n4 1\n1 4\n2 1\n3 2\n1 2\n5 1\n2 4\n2 1\n2 4\n1 4\n1\n2\n3\n", "15\n548614965\n80769513\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "能量采集", "background": "", "description": "**题面已修改，请大家注意。**\n\n请你求下列式子：$\\sum_{i=1}^N\\sum_{j=1}^Ngcd(i,j)$ ，答案对大质数取模。\n\n不好意思读错剧本了。\n\n给定一个 $n$ 个点 $m$ 条边的有向图，每个点有初始能量 $a_i$ 。\n\n每过一秒，每个点的能量便会等量地流向所有出边，另外，会有一份流向自己（你可以当做有一个自环）。\n\n现在 $dkw$ 有 $q$ 次询问，每次询问会给你一个时间 $t$ ，$dkw$想知道 $t$ 秒时每个点的能量。\n\n不保证图中没有重边和自环，答案对$998244353$取模。", "inputFormat": "第一行包含三个整数，$n,m,q$ 。\n\n第二行包含$n$个整数，从$a_1$到$a_n$ ，代表初始能量。\n\n接下来 $m$ 行，每行包含两个正整数 $x_i,y_i$ ，代表一条有向边，从 $x_i$ 指向 $y_i$ ，我们约定点编号从 $1$ 到 $n$ 。\n\n接下来 $q$ 行，每行包含一个正整数 $t$ ，代表一次询问。", "outputFormat": "为了防止输出过大，对于每个询问你只需要输出一行一个非负整数，代表 $n$ 个点的能量（取模）的异或和对$998244353$取模的结果。 ", "hint": "对于 30% 的数据，$1\\le t \\le 50$\n\n对于 60% 的数据，$1\\le q\\le 50$\n\n对于 80% 的数据，$1\\le q\\le 1000$\n\n对于 100% 的数据，$1\\le n\\le 50,1\\le m\\le n\\times (n-1),1\\le q\\le 5\\times 10^4,0< a_i< 998244353,1\\le t\\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "Energy Harvesting", "background": "", "description": "**The statement has been modified. Please pay attention.**\n\nPlease compute the following expression: $\\sum_{i=1}^N\\sum_{j=1}^Ngcd(i,j)$, and take the answer modulo a large prime number.\n\nSorry, I read the wrong script.\n\nYou are given a directed graph with $n$ nodes and $m$ edges. Each node has an initial energy value $a_i$.\n\nEvery second, the energy at each node flows equally to all of its outgoing edges. In addition, one share flows to itself (you may treat this as having a self-loop).\n\nNow $dkw$ has $q$ queries. Each query gives a time $t$, and $dkw$ wants to know the energy at each node after $t$ seconds.\n\nThe graph is not guaranteed to be free of multiple edges or self-loops. All answers are taken modulo $998244353$.", "inputFormat": "The first line contains three integers, $n,m,q$.\n\nThe second line contains $n$ integers, from $a_1$ to $a_n$, representing the initial energy.\n\nThe next $m$ lines each contain two positive integers $x_i,y_i$, representing a directed edge from $x_i$ to $y_i$. We assume the nodes are numbered from $1$ to $n$.\n\nThe next $q$ lines each contain one positive integer $t$, representing a query.", "outputFormat": "To avoid overly large output, for each query you only need to output one line with one non-negative integer, which is the XOR sum of the energies (modulo) of the $n$ nodes, and then taken modulo $998244353$.", "hint": "For $30\\%$ of the testdata, $1\\le t \\le 50$.\n\nFor $60\\%$ of the testdata, $1\\le q\\le 50$.\n\nFor $80\\%$ of the testdata, $1\\le q\\le 1000$.\n\nFor $100\\%$ of the testdata, $1\\le n\\le 50,1\\le m\\le n\\times (n-1),1\\le q\\le 5\\times 10^4,0< a_i< 998244353,1\\le t\\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "能量采集", "background": "", "description": "**题面已修改，请大家注意。**\n\n请你求下列式子：$\\sum_{i=1}^N\\sum_{j=1}^Ngcd(i,j)$ ，答案对大质数取模。\n\n不好意思读错剧本了。\n\n给定一个 $n$ 个点 $m$ 条边的有向图，每个点有初始能量 $a_i$ 。\n\n每过一秒，每个点的能量便会等量地流向所有出边，另外，会有一份流向自己（你可以当做有一个自环）。\n\n现在 $dkw$ 有 $q$ 次询问，每次询问会给你一个时间 $t$ ，$dkw$想知道 $t$ 秒时每个点的能量。\n\n不保证图中没有重边和自环，答案对$998244353$取模。", "inputFormat": "第一行包含三个整数，$n,m,q$ 。\n\n第二行包含$n$个整数，从$a_1$到$a_n$ ，代表初始能量。\n\n接下来 $m$ 行，每行包含两个正整数 $x_i,y_i$ ，代表一条有向边，从 $x_i$ 指向 $y_i$ ，我们约定点编号从 $1$ 到 $n$ 。\n\n接下来 $q$ 行，每行包含一个正整数 $t$ ，代表一次询问。", "outputFormat": "为了防止输出过大，对于每个询问你只需要输出一行一个非负整数，代表 $n$ 个点的能量（取模）的异或和对$998244353$取模的结果。 ", "hint": "对于 30% 的数据，$1\\le t \\le 50$\n\n对于 60% 的数据，$1\\le q\\le 50$\n\n对于 80% 的数据，$1\\le q\\le 1000$\n\n对于 100% 的数据，$1\\le n\\le 50,1\\le m\\le n\\times (n-1),1\\le q\\le 5\\times 10^4,0< a_i< 998244353,1\\le t\\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P5108", "type": "P", "difficulty": 6, "samples": [["26 11\nremoonqaqac", "8 10 8 8 2 2 2 2 2 2 1"], ["26 11\ntxdydkwqaqa\n", "9 9 9 5 5 5 5 3 3 1 1"], ["10000000 17\n9 9 8 2 4 4 3 5 3 1 9 2 6 0 8 1 7", "14 14 14 14 10 10 10 10 4 4 4 4 4 4 3 2 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "仰望半月的夜空", "background": "“你不久也会遇到喜欢的女生吧。听好了，你可得好好守护她喔。”\n\n这是父亲给予戎崎裕一的教诲\n\n父亲称不上是一个合格的父亲\n\n但是，却正是这样的父亲，连接了戎崎裕一和秋庭里香\n\n![](https://www.cnblogs.com/images/cnblogs_com/reverymoon/1200086/o_0.png)\n\n秋庭里香，明明是那样的傲娇，却不得不去守护的女生\n\n但同时，又是一个为了回忆，为了懵懂的爱情而坚强着的女生\n\n你是不是在她身上看到了小夜子的身影呢？夏目吾郎医生\n\n你是不是在他身上看到了过去的自己呢？夏目吾郎医生\n\n也许疾病切断了人与人之间的联系，但是曾经存在的痕迹，定将会化作美好的回忆，流传下去\n\n愿你们幸福\n\n", "description": "半月的夜空中，寄托了多少人与人之间的思念啊\n\n曦月知道，这些思念会汇集成一个字符串 $S$（$n = |S|$）。\n\n由于思念汇集的过于复杂，因此曦月希望提炼出所有的思念。\n\n我们定义 $Y_S(i)$ 表示对于字符串 $S$ 而言，长度为 $i$ 的子串中，字典序最小的，左端点最小的左端点的值\n\n比如对于串 $S = \\texttt{\"baa\"}$，$Y_S(1) = 2$、$Y_S(2) = 2$、$Y_S(3) = 1$。\n\n曦月会告知你 $S$ 串，你只需要告诉曦月 $Y_S(i)$（$1 \\le i \\le n$）即可。", "inputFormat": "第一行，两个参数，分别是 $\\sigma \\in \\{10, 26, 10^7\\}$ 和 $n$。\n\n如果 $\\sigma = 26$，那么第二行将是一个长为 $n$ 的小写字母字符串 $S$。\n\n其他情况下，第二行将输入 $n$ 个位于 $[0, \\sigma]$ 内的整数。", "outputFormat": "输出一行，第 $i$ 个数表示 $Y_S(i)$ 的值。", "hint": "数据范围的图不见了 QAQ\n\n最大范围是 $1 \\le n \\le 3 \\times {10}^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Half-Moon Night Sky", "background": "“You will soon meet a girl you like. Listen carefully, you must protect her well.”\n\nThis was the advice that Father gave to Yuichi Ronzaki.\n\nFather could hardly be called a qualified father.\n\nBut it was exactly such a father who connected Yuichi Ronzaki and Rika Akiba.\n\n![](https://www.cnblogs.com/images/cnblogs_com/reverymoon/1200086/o_0.png)\n\nRika Akiba is a girl who is clearly a tsundere, yet someone you cannot help but protect.\n\nAt the same time, she is also a girl who stays strong for memories, and for innocent love.\n\nDo you see Sayoko’s shadow in her, Doctor Goro Natsume?\n\nDo you see your past self in him, Doctor Goro Natsume?\n\nMaybe illness cuts off the connection between people, but the traces that once existed will surely turn into beautiful memories and be passed on.\n\nMay you be happy.", "description": "In the half-moon night sky, how many people’s feelings for each other are carried.\n\nXiyue knows that these feelings will gather into a string $S$ ($n = |S|$).\n\nBecause the feelings are gathered in a way that is too complex, Xiyue hopes to refine all of them.\n\nWe define $Y_S(i)$ as follows: for the string $S$, among all substrings of length $i$, take the lexicographically smallest one; if there are multiple, take the one with the smallest left endpoint. Then $Y_S(i)$ is the value of that left endpoint.\n\nFor example, for $S = \\texttt{\"baa\"}$, $Y_S(1) = 2$, $Y_S(2) = 2$, $Y_S(3) = 1$.\n\nXiyue will tell you the string $S$. You only need to tell Xiyue $Y_S(i)$ ($1 \\le i \\le n$).", "inputFormat": "The first line contains two parameters: $\\sigma \\in \\{10, 26, 10^7\\}$ and $n$.\n\nIf $\\sigma = 26$, then the second line is a lowercase letter string $S$ of length $n$.\n\nOtherwise, the second line contains $n$ integers in $[0, \\sigma]$.", "outputFormat": "Output one line. The $i$-th number表示 the value of $Y_S(i)$.", "hint": "The Constraints chart is missing QAQ.\n\nThe maximum range is $1 \\le n \\le 3 \\times {10}^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "仰望半月的夜空", "background": "“你不久也会遇到喜欢的女生吧。听好了，你可得好好守护她喔。”\n\n这是父亲给予戎崎裕一的教诲\n\n父亲称不上是一个合格的父亲\n\n但是，却正是这样的父亲，连接了戎崎裕一和秋庭里香\n\n![](https://www.cnblogs.com/images/cnblogs_com/reverymoon/1200086/o_0.png)\n\n秋庭里香，明明是那样的傲娇，却不得不去守护的女生\n\n但同时，又是一个为了回忆，为了懵懂的爱情而坚强着的女生\n\n你是不是在她身上看到了小夜子的身影呢？夏目吾郎医生\n\n你是不是在他身上看到了过去的自己呢？夏目吾郎医生\n\n也许疾病切断了人与人之间的联系，但是曾经存在的痕迹，定将会化作美好的回忆，流传下去\n\n愿你们幸福\n\n", "description": "半月的夜空中，寄托了多少人与人之间的思念啊\n\n曦月知道，这些思念会汇集成一个字符串 $S$（$n = |S|$）。\n\n由于思念汇集的过于复杂，因此曦月希望提炼出所有的思念。\n\n我们定义 $Y_S(i)$ 表示对于字符串 $S$ 而言，长度为 $i$ 的子串中，字典序最小的，左端点最小的左端点的值\n\n比如对于串 $S = \\texttt{\"baa\"}$，$Y_S(1) = 2$、$Y_S(2) = 2$、$Y_S(3) = 1$。\n\n曦月会告知你 $S$ 串，你只需要告诉曦月 $Y_S(i)$（$1 \\le i \\le n$）即可。", "inputFormat": "第一行，两个参数，分别是 $\\sigma \\in \\{10, 26, 10^7\\}$ 和 $n$。\n\n如果 $\\sigma = 26$，那么第二行将是一个长为 $n$ 的小写字母字符串 $S$。\n\n其他情况下，第二行将输入 $n$ 个位于 $[0, \\sigma]$ 内的整数。", "outputFormat": "输出一行，第 $i$ 个数表示 $Y_S(i)$ 的值。", "hint": "数据范围的图不见了 QAQ\n\n最大范围是 $1 \\le n \\le 3 \\times {10}^5$。", "locale": "zh-CN"}}}
{"pid": "P5109", "type": "P", "difficulty": 7, "samples": [["5 5 2 3\n0 0 \n1 2 \n3 3 \n2 1 \n3 2 \n1 3 0 \n2 1 2 \n3 0 1 \n4 1 2 \n2 0 1 \n", "0\n3\n14\n34\n2\n"], ["5 5 2 3\n2 2 \n2 0 \n2 3 \n0 3 \n2 1 \n2 0 1 \n3 1 1 \n1 0 2 \n2 3 0 \n5 0 2 \n", "4\n0\n0\n0\n465\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "归程", "background": "", "description": "dkw在玩一款叫做《ION8102》的游戏，这个游戏分为序章，第一章，第二章。\n\n她已经满血通过了序章，来到了第一章的第一关。\n\n这关的名字叫归程，她需要到达指定地点，这一路上要经过 $m$ 扇机关门。\n\n每扇机关门上有一个钥匙孔，只有特制钥匙可以放进去，里面有 $k$ 把转轮锁，每个转轮锁都要恰好转到目标位置 $a_i$ 才能开门，每个转轮锁的最大刻度都是 $v$ ，刻度标号从 $0$ 到 $v$ ，每个转轮锁初始位置都是 $0$ 。\n\ndkw身上有 $n$ 把钥匙，每把钥匙都有 $k$ 个转动量 $b_i$ ，分别代表这把钥匙转一圈，可以让机关门中的这个转轮锁走多少个位置。\n\n每扇机关门还有一个圈数限制 $c$ ，也就是你总共只能用钥匙转最多 $c$ 圈，并且每把钥匙只能正着转，只能转整数圈。\n\n任务要求顺次打开这 $m$ 扇门，这么简单的问题dkw当然秒了，但是dkw好奇的是：对于每一扇门，有多少种方案能顺利打开呢？\n\n两种方案不同，当且仅当两种方案中总圈数不同或某一圈所用钥匙不同。\n\n如果你解答了dkw的好奇心，那么你将会收到她的一份大~礼物——100分！", "inputFormat": "第一行包含四个正整数 $n,m,k,v$ ，含义详见题目描述。\n\n接下来 $n$ 行，每行包含 $k$ 个非负整数，依次代表这把钥匙的转动量 $b_i$ 。\n\n接下来 $m$ 行，首先是一个非负整数 $c$ 代表圈数限制，接着是 $k$ 个非负整数，依次代表这扇门的目标位置 $a_i$ 。", "outputFormat": "对于每个询问，输出一行一个非负整数代表这次询问的答案，对 $2333$ 取模。", "hint": "本题采用子任务测试。\n\n- 子任务1 (9pts)：$1\\le n,m,k,c,v\\le 5$\n- 子任务2 (16pts)：$1\\le n\\le 10^5,1\\le m,c\\le 100,v=1,k\\le 12$\n- 子任务3 (17pts)：$1\\le n\\le 10^5,1\\le m,c\\le 100,v=2,k\\le 8$\n- 子任务4 (19pts)：$1\\le n\\le 10^5,1\\le m,c\\le 100,v=3,k\\le 6$\n- 子任务5 (16pts)：$1\\le n\\le 10^5,1\\le m,c\\le 100$\n- 子任务6 (23pts)：$1\\le n\\le 10^5,1\\le m\\le 5,1\\le c\\le 10^9$\n\n每个测试点的 $v$ 和 $k$ 会从下表的对应关系中选取。\n\n其中 $maxk$ 代表 $k$ 不会超过该值。\n\n| 编号 | v    | maxk |\n| ---- | ---- | ---- |\n| 1    | 1    | 12   |\n| 2    | 2    | 8    |\n| 3    | 3    | 6    |\n| 4    | 4    | 5    |\n| 5    | 5    | 4    |\n| 6    | 6    | 4    |\n| 7    | 7    | 3    |\n| 8    | 8    | 3    |\n| 9    | 9    | 3    |", "locale": "zh-CN", "translations": {"en": {"title": "Return Journey", "background": "", "description": "dkw is playing a game called *ION8102*. The game is divided into the prologue, Chapter 1, and Chapter 2.\n\nShe has cleared the prologue with full health and has arrived at the first level of Chapter 1.\n\nThis level is called Return Journey. She needs to reach a specified location, and along the way she must pass through $m$ mechanical doors.\n\nEach mechanical door has a keyhole, and only a special key can be inserted. Inside there are $k$ dial locks. Each dial lock must be turned to the target position $a_i$ exactly in order to open the door. The maximum scale of each dial is $v$, with labels from $0$ to $v$. The initial position of every dial lock is $0$.\n\ndkw has $n$ keys. Each key has $k$ rotation amounts $b_i$, meaning that if this key is turned by one full circle, it will move the corresponding dial lock in the door by that many positions.\n\nEach mechanical door also has a turn limit $c$, which means that in total you can use keys to turn at most $c$ circles. Also, each key can only be turned forward, and only an integer number of circles can be turned.\n\nThe task requires opening these $m$ doors in order. Such an easy problem is of course solved instantly by dkw, but she is curious: for each door, how many different plans can open it successfully?\n\nTwo plans are different if and only if either the total number of circles is different, or the key used in some circle is different.\n\nIf you satisfy dkw’s curiosity, you will receive a big gift from her—100 points.", "inputFormat": "The first line contains four positive integers $n,m,k,v$, with meanings as described above.\n\nThe next $n$ lines each contain $k$ non-negative integers, representing the rotation amounts $b_i$ of this key in order.\n\nThe next $m$ lines: first a non-negative integer $c$ representing the turn limit, followed by $k$ non-negative integers representing the target positions $a_i$ of this door in order.", "outputFormat": "For each query, output one line with one non-negative integer representing the answer to this query, modulo $2333$.", "hint": "This problem uses subtasks.\n\n- Subtask 1 (9pts): $1\\le n,m,k,c,v\\le 5$.\n- Subtask 2 (16pts): $1\\le n\\le 10^5,1\\le m,c\\le 100,v=1,k\\le 12$.\n- Subtask 3 (17pts): $1\\le n\\le 10^5,1\\le m,c\\le 100,v=2,k\\le 8$.\n- Subtask 4 (19pts): $1\\le n\\le 10^5,1\\le m,c\\le 100,v=3,k\\le 6$.\n- Subtask 5 (16pts): $1\\le n\\le 10^5,1\\le m,c\\le 100$.\n- Subtask 6 (23pts): $1\\le n\\le 10^5,1\\le m\\le 5,1\\le c\\le 10^9$.\n\nFor each test point, $v$ and $k$ are chosen from the corresponding relation in the table below.\n\nHere, $maxk$ means that $k$ will not exceed this value.\n\n| Index | v    | maxk |\n| ---- | ---- | ---- |\n| 1    | 1    | 12   |\n| 2    | 2    | 8    |\n| 3    | 3    | 6    |\n| 4    | 4    | 5    |\n| 5    | 5    | 4    |\n| 6    | 6    | 4    |\n| 7    | 7    | 3    |\n| 8    | 8    | 3    |\n| 9    | 9    | 3    |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "归程", "background": "", "description": "dkw在玩一款叫做《ION8102》的游戏，这个游戏分为序章，第一章，第二章。\n\n她已经满血通过了序章，来到了第一章的第一关。\n\n这关的名字叫归程，她需要到达指定地点，这一路上要经过 $m$ 扇机关门。\n\n每扇机关门上有一个钥匙孔，只有特制钥匙可以放进去，里面有 $k$ 把转轮锁，每个转轮锁都要恰好转到目标位置 $a_i$ 才能开门，每个转轮锁的最大刻度都是 $v$ ，刻度标号从 $0$ 到 $v$ ，每个转轮锁初始位置都是 $0$ 。\n\ndkw身上有 $n$ 把钥匙，每把钥匙都有 $k$ 个转动量 $b_i$ ，分别代表这把钥匙转一圈，可以让机关门中的这个转轮锁走多少个位置。\n\n每扇机关门还有一个圈数限制 $c$ ，也就是你总共只能用钥匙转最多 $c$ 圈，并且每把钥匙只能正着转，只能转整数圈。\n\n任务要求顺次打开这 $m$ 扇门，这么简单的问题dkw当然秒了，但是dkw好奇的是：对于每一扇门，有多少种方案能顺利打开呢？\n\n两种方案不同，当且仅当两种方案中总圈数不同或某一圈所用钥匙不同。\n\n如果你解答了dkw的好奇心，那么你将会收到她的一份大~礼物——100分！", "inputFormat": "第一行包含四个正整数 $n,m,k,v$ ，含义详见题目描述。\n\n接下来 $n$ 行，每行包含 $k$ 个非负整数，依次代表这把钥匙的转动量 $b_i$ 。\n\n接下来 $m$ 行，首先是一个非负整数 $c$ 代表圈数限制，接着是 $k$ 个非负整数，依次代表这扇门的目标位置 $a_i$ 。", "outputFormat": "对于每个询问，输出一行一个非负整数代表这次询问的答案，对 $2333$ 取模。", "hint": "本题采用子任务测试。\n\n- 子任务1 (9pts)：$1\\le n,m,k,c,v\\le 5$\n- 子任务2 (16pts)：$1\\le n\\le 10^5,1\\le m,c\\le 100,v=1,k\\le 12$\n- 子任务3 (17pts)：$1\\le n\\le 10^5,1\\le m,c\\le 100,v=2,k\\le 8$\n- 子任务4 (19pts)：$1\\le n\\le 10^5,1\\le m,c\\le 100,v=3,k\\le 6$\n- 子任务5 (16pts)：$1\\le n\\le 10^5,1\\le m,c\\le 100$\n- 子任务6 (23pts)：$1\\le n\\le 10^5,1\\le m\\le 5,1\\le c\\le 10^9$\n\n每个测试点的 $v$ 和 $k$ 会从下表的对应关系中选取。\n\n其中 $maxk$ 代表 $k$ 不会超过该值。\n\n| 编号 | v    | maxk |\n| ---- | ---- | ---- |\n| 1    | 1    | 12   |\n| 2    | 2    | 8    |\n| 3    | 3    | 6    |\n| 4    | 4    | 5    |\n| 5    | 5    | 4    |\n| 6    | 6    | 4    |\n| 7    | 7    | 3    |\n| 8    | 8    | 3    |\n| 9    | 9    | 3    |", "locale": "zh-CN"}}}
{"pid": "P5110", "type": "P", "difficulty": 6, "samples": [["4779 17790102303135 73152356900611 22086182463002", "391030355"], ["49999561 116754637679537 79587668206509 80161279644028", "705437004"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": ["O2优化"], "title": "块速递推", "background": "shadowice1984 发现了一道题：求斐波那契数列第 $n$ 项模 $10^9+7$ 的值，$n \\leq 10^9$。\n\nshadowice1984 想了一个星期可他还是不会做。\n\n当然，这是 shadowice1984 刚学 OI 时候的事情了，今天他学习了矩阵快速幂并且花了一整天解决了上面的问题。\n\n他决定出一道题来测试你的矩阵快速幂水平如何，为了检查他花了一个星期写出的 std 到底有没有错，他决定让你来帮他验题。", "description": "给定一个数列 $a$ 满足递推式\n\n$$a_{n}=233a_{n-1}+666a_{n-2},a_{0}=0,a_{1}=1$$\n\n求这个数列第 $n$ 项模 $10^9+7$ 的值，一共有 $T$ 组询问。\n\n为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问：\n\n```C\nnamespace Mker\n{\n\tunsigned long long SA,SB,SC;\n\tvoid init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\n\tunsigned long long rand()\n\t{\n\t    SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n\t    unsigned long long t=SA;\n\t\tSA=SB,SB=SC,SC^=t^SA;return SC;\n\t}\n}\n```\n在调用 `Mker::init()` 函数之后这个随机数生成器便可以正常工作了，当你第 $i$ 次调用 `Mker::rand()` 函数时返回的便是第 $i$ 次询问的 $n$ 值。\n\n为了减少你的输出量，你只需要输出所有询问答案的异或和。", "inputFormat": "仅一行四个整数，表示 $T,SA,SB,SC$ 的值，你可以在读入 $T$ 之后直接调用 `Mker::init()` 来完成输入工作。", "outputFormat": "仅一行一个整数，表示所有答案的异或和。", "hint": "$SA,SB,SC$ 均在 `unsigned long long` 数据类型的范围之内，由此可以发现返回的 $n$ 值也是 `unsigned long long` 数据类型的范围之内。\n\n前 6 个测试点每个测试点 $1$ 分。\n\n对于 1,2 测试点 $T \\leq 5000$。\n\n对于 3,4,5,6 测试点 $T \\leq 500000$。\n\n对于所有测试点 $1 \\leq T \\leq 5×10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "Block Fast Recurrence", "background": "shadowice1984 found a problem: compute the $n$-th term of the Fibonacci sequence modulo $10^9+7$, where $n \\leq 10^9$.\n\nshadowice1984 thought about it for a whole week but still could not solve it.\n\nOf course, that was when shadowice1984 had just started learning OI. Today, he learned fast matrix exponentiation and spent an entire day solving the problem above.\n\nHe decided to make a problem to test your fast matrix exponentiation skills. To check whether the std he spent a week writing has any mistakes, he decided to ask you to help verify the problem.", "description": "Given a sequence $a$ that satisfies the recurrence\n\n$$a_{n}=233a_{n-1}+666a_{n-2},a_{0}=0,a_{1}=1$$\n\nCompute the value of the $n$-th term of this sequence modulo $10^9+7$. There are $T$ queries in total.\n\nTo reduce your input and output workload to some extent, we generate the queries using the following code:\n\n```C\nnamespace Mker\n{\n\tunsigned long long SA,SB,SC;\n\tvoid init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\n\tunsigned long long rand()\n\t{\n\t    SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n\t    unsigned long long t=SA;\n\t\tSA=SB,SB=SC,SC^=t^SA;return SC;\n\t}\n}\n```\n\nAfter calling `Mker::init()`, this random number generator will work normally. When you call `Mker::rand()` for the $i$-th time, the returned value is the $n$ for the $i$-th query.\n\nTo reduce your output, you only need to output the bitwise XOR of the answers to all queries.", "inputFormat": "A single line with four integers, representing $T,SA,SB,SC$. After reading $T$, you can directly call `Mker::init()` to finish the input.", "outputFormat": "A single line with one integer, representing the bitwise XOR of all answers.", "hint": "$SA,SB,SC$ are all within the range of the `unsigned long long` data type, so the returned $n$ is also within the range of the `unsigned long long` data type.\n\nThe first 6 test points are worth $1$ point each.\n\nFor test points 1 and 2, $T \\leq 5000$.\n\nFor test points 3, 4, 5, and 6, $T \\leq 500000$.\n\nFor all test points, $1 \\leq T \\leq 5×10^7$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "块速递推", "background": "shadowice1984 发现了一道题：求斐波那契数列第 $n$ 项模 $10^9+7$ 的值，$n \\leq 10^9$。\n\nshadowice1984 想了一个星期可他还是不会做。\n\n当然，这是 shadowice1984 刚学 OI 时候的事情了，今天他学习了矩阵快速幂并且花了一整天解决了上面的问题。\n\n他决定出一道题来测试你的矩阵快速幂水平如何，为了检查他花了一个星期写出的 std 到底有没有错，他决定让你来帮他验题。", "description": "给定一个数列 $a$ 满足递推式\n\n$$a_{n}=233a_{n-1}+666a_{n-2},a_{0}=0,a_{1}=1$$\n\n求这个数列第 $n$ 项模 $10^9+7$ 的值，一共有 $T$ 组询问。\n\n为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问：\n\n```C\nnamespace Mker\n{\n\tunsigned long long SA,SB,SC;\n\tvoid init(){scanf(\"%llu%llu%llu\",&SA,&SB,&SC);}\n\tunsigned long long rand()\n\t{\n\t    SA^=SA<<32,SA^=SA>>13,SA^=SA<<1;\n\t    unsigned long long t=SA;\n\t\tSA=SB,SB=SC,SC^=t^SA;return SC;\n\t}\n}\n```\n在调用 `Mker::init()` 函数之后这个随机数生成器便可以正常工作了，当你第 $i$ 次调用 `Mker::rand()` 函数时返回的便是第 $i$ 次询问的 $n$ 值。\n\n为了减少你的输出量，你只需要输出所有询问答案的异或和。", "inputFormat": "仅一行四个整数，表示 $T,SA,SB,SC$ 的值，你可以在读入 $T$ 之后直接调用 `Mker::init()` 来完成输入工作。", "outputFormat": "仅一行一个整数，表示所有答案的异或和。", "hint": "$SA,SB,SC$ 均在 `unsigned long long` 数据类型的范围之内，由此可以发现返回的 $n$ 值也是 `unsigned long long` 数据类型的范围之内。\n\n前 6 个测试点每个测试点 $1$ 分。\n\n对于 1,2 测试点 $T \\leq 5000$。\n\n对于 3,4,5,6 测试点 $T \\leq 500000$。\n\n对于所有测试点 $1 \\leq T \\leq 5×10^7$。", "locale": "zh-CN"}}}
{"pid": "P5111", "type": "P", "difficulty": 7, "samples": [["20 5\n11 12\n14 20\n6 12\n8 13\n10 19\n", "67"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "zhtobu3232 的线段树", "background": "zhtobu3232 发现了一道线段树题，在 30s 后 zhtobu3232 敲出了一份线段树并且 AC 了这题。\n\n当然，这是 zhtobu3232 刚刚学 OI 时候的事情了，现在的他只需 1s 就可以敲出一份完美的线段树板子。\n\n现在 ztb 想要重温一下他之前切过的水题，不过他的笔记本电脑年代有些久远，导致内存条损坏了很多，从而线段树也开始损坏了，现在他不关心当年敲了什么水题而只关心这个线段树可以表示出多少合法的区间，请你计算出这个数字并对 $998244353$ 取模。\n\n顺便说一句 ztb 认为这个问题比线段树简单多了，因为线段树的节点少了，所以维护的信息也少了，他已经用 1ms 敲好了 std，接下来就等着你帮他验题了。", "description": "我们定义一颗长度为 $n$ 的线段树是这样的算法流程执行 `build(0,n)` 后建出的二叉树。\n\n注意这里的线段树应该和大家平常写的没什么区别（除了区间是左开右闭表示的以外），会线段树的可以忽略。\n\n```C\nnode build (l,r)\n{\n\tnode p=newnode();p.l=l+1;p.r=r;\n    if(r-l==1)return p;\n    mid=(l+r)/2;\n    node.leftson=build(l,mid);\n\tnode.rightson=build(mid,r);\n    return p;\n}\n```\n\n而我们定义一个区间 $(l,r)$ 在线段树上的**拆分**是将这个区间表示为线段树上若干个节点的集合，满足这些节点对应的区间不相交，不嵌套，这些区间的并集恰好是 $(l,r)$，并且没有两个节点是兄弟关系。\n\n拆分的伪代码如下：\n\n```C\nvoid solve(l,r,dl,dr)\n{\n\tif(dl==l&&dr==r){S.push(node(l+1,r));return;}\n\t mid=(l+r)/2;\n    if(dl<mid)solve(l,mid,dl,min(dr,mid));\n    if(mid<dr)solve(mid,r,max(dl,mid),dr);\n}\n\n```\n\n当我们执行完 `solve(0,n,l-1,r)` 之后得到的 $S$ 集合就是区间 $(l,r)$ 在 $(1,n)$ 这颗线段树上的**拆分**了。换句话说就是你平时写线段树时将一个区间拆成 $O(\\log n)$ 个区间的操作。\n\n现在我们给出了 $m$ 个区间 $(l,r)$，这些区间在线段树 $(1,n)$ 上拆分出来的节点都是非法节点，换句话说这些节点都不可以使用了。\n\n现在请你计算有多少个区间 $(l,r)$ 是合法的，满足以下两个限制条件：\n\n1. $1 \\leq l \\leq r \\leq n$；\n2. 这个区间在线段树 $(1,n)$ 上的拆分不含有非法的节点。\n\n答案对 $998244353$ 取模。", "inputFormat": "**为了避免您被题意杀，请务必按照题目中给出的左开右闭法建线段树，采用其他的建树方式可能导致线段树的形态和 std 中的线段树不符导致 WA。**\n\n第一行两个整数 $n,m$，表示线段树的长度和区间个数。\n\n接下来 $m$ 行每行两个整数 $l,r$，表示 $(l,r)$ 这个区间在线段树上拆分出的节点全部为非法节点。", "outputFormat": "仅一行一个整数，表示所有合法的区间个数对 $998244353$ 取模之后的值。", "hint": "$1,2,3,4,5,6,7$ 测试点的分数全部为 $1$ 分。\n\n对于测试点 $1,2$，$n \\leq 1000,m\\leq 100$。\n\n对于测试点 $3,4$，$n \\leq 100000,m \\leq 5000$。\n\n对于测试点 $5,6,7$，$n \\leq 10^7,m \\leq 10^5$。\n\n对于所有数据，$1 \\leq n \\leq 10^{14}$，$1 \\leq m \\leq 10^5$，$1 \\leq l \\leq r \\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "zhtobu3232’s Segment Tree", "background": "zhtobu3232 found a segment tree problem. After 30 seconds, zhtobu3232 typed out a segment tree and got AC on it.\n\nOf course, that was when zhtobu3232 had just started learning OI. Now he only needs 1 second to type out a perfect segment tree template.\n\nNow ztb wants to relive those easy problems he solved before. But his laptop is quite old, and many memory sticks have been damaged, so the segment tree has also started to break. Now he does not care what easy problem he coded back then; he only cares about how many valid intervals this segment tree can represent. Please compute this number and take it modulo $998244353$.\n\nBy the way, ztb thinks this problem is much simpler than a segment tree, because the segment tree has fewer nodes, so there is less information to maintain. He has already typed the std in 1 ms, and now he is waiting for you to help validate the problem.", "description": "We define a segment tree of length $n$ as the binary tree built by executing `build(0,n)` in the following algorithm.\n\nNote that this segment tree should be almost the same as the one everyone usually writes (except that intervals are represented as left-open right-closed). If you know segment trees, you may ignore this note.\n\n```C\nnode build (l,r)\n{\n\tnode p=newnode();p.l=l+1;p.r=r;\n    if(r-l==1)return p;\n    mid=(l+r)/2;\n    node.leftson=build(l,mid);\n\tnode.rightson=build(mid,r);\n    return p;\n}\n```\n\nWe define the **decomposition** of an interval $(l,r)$ on the segment tree as representing this interval as a set of several nodes on the segment tree, such that the intervals corresponding to these nodes are non-overlapping, not nested, their union is exactly $(l,r)$, and no two nodes are siblings.\n\nThe pseudo-code for decomposition is:\n\n```C\nvoid solve(l,r,dl,dr)\n{\n\tif(dl==l&&dr==r){S.push(node(l+1,r));return;}\n\t mid=(l+r)/2;\n    if(dl<mid)solve(l,mid,dl,min(dr,mid));\n    if(mid<dr)solve(mid,r,max(dl,mid),dr);\n}\n\n```\n\nAfter executing `solve(0,n,l-1,r)`, the set $S$ obtained is exactly the **decomposition** of interval $(l,r)$ on the segment tree $(1,n)$. In other words, it is the operation you usually do in a segment tree where you split an interval into $O(\\log n)$ intervals.\n\nNow we are given $m$ intervals $(l,r)$. All nodes produced by decomposing these intervals on the segment tree $(1,n)$ are illegal nodes. In other words, these nodes cannot be used.\n\nNow please compute how many intervals $(l,r)$ are valid, satisfying the following two constraints:\n\n1. $1 \\leq l \\leq r \\leq n$.\n2. The decomposition of this interval on the segment tree $(1,n)$ does not contain any illegal nodes.\n\nOutput the answer modulo $998244353$.", "inputFormat": "**To avoid being misled by the statement, you must build the segment tree using the left-open right-closed convention described in the problem. Using other building methods may cause the segment tree shape to differ from the one in std, leading to WA.**\n\nThe first line contains two integers $n,m$, representing the length of the segment tree and the number of intervals.\n\nThe next $m$ lines each contain two integers $l,r$, meaning that all nodes produced by decomposing the interval $(l,r)$ on the segment tree are illegal nodes.", "outputFormat": "Output one integer in a single line: the number of all valid intervals modulo $998244353$.", "hint": "The scores of test points $1,2,3,4,5,6,7$ are all $1$ point.\n\nFor test points $1,2$, $n \\leq 1000,m \\leq 100$.\n\nFor test points $3,4$, $n \\leq 100000,m \\leq 5000$.\n\nFor test points $5,6,7$, $n \\leq 10^7,m \\leq 10^5$.\n\nFor all testdata, $1 \\leq n \\leq 10^{14}$, $1 \\leq m \\leq 10^5$, $1 \\leq l \\leq r \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "zhtobu3232 的线段树", "background": "zhtobu3232 发现了一道线段树题，在 30s 后 zhtobu3232 敲出了一份线段树并且 AC 了这题。\n\n当然，这是 zhtobu3232 刚刚学 OI 时候的事情了，现在的他只需 1s 就可以敲出一份完美的线段树板子。\n\n现在 ztb 想要重温一下他之前切过的水题，不过他的笔记本电脑年代有些久远，导致内存条损坏了很多，从而线段树也开始损坏了，现在他不关心当年敲了什么水题而只关心这个线段树可以表示出多少合法的区间，请你计算出这个数字并对 $998244353$ 取模。\n\n顺便说一句 ztb 认为这个问题比线段树简单多了，因为线段树的节点少了，所以维护的信息也少了，他已经用 1ms 敲好了 std，接下来就等着你帮他验题了。", "description": "我们定义一颗长度为 $n$ 的线段树是这样的算法流程执行 `build(0,n)` 后建出的二叉树。\n\n注意这里的线段树应该和大家平常写的没什么区别（除了区间是左开右闭表示的以外），会线段树的可以忽略。\n\n```C\nnode build (l,r)\n{\n\tnode p=newnode();p.l=l+1;p.r=r;\n    if(r-l==1)return p;\n    mid=(l+r)/2;\n    node.leftson=build(l,mid);\n\tnode.rightson=build(mid,r);\n    return p;\n}\n```\n\n而我们定义一个区间 $(l,r)$ 在线段树上的**拆分**是将这个区间表示为线段树上若干个节点的集合，满足这些节点对应的区间不相交，不嵌套，这些区间的并集恰好是 $(l,r)$，并且没有两个节点是兄弟关系。\n\n拆分的伪代码如下：\n\n```C\nvoid solve(l,r,dl,dr)\n{\n\tif(dl==l&&dr==r){S.push(node(l+1,r));return;}\n\t mid=(l+r)/2;\n    if(dl<mid)solve(l,mid,dl,min(dr,mid));\n    if(mid<dr)solve(mid,r,max(dl,mid),dr);\n}\n\n```\n\n当我们执行完 `solve(0,n,l-1,r)` 之后得到的 $S$ 集合就是区间 $(l,r)$ 在 $(1,n)$ 这颗线段树上的**拆分**了。换句话说就是你平时写线段树时将一个区间拆成 $O(\\log n)$ 个区间的操作。\n\n现在我们给出了 $m$ 个区间 $(l,r)$，这些区间在线段树 $(1,n)$ 上拆分出来的节点都是非法节点，换句话说这些节点都不可以使用了。\n\n现在请你计算有多少个区间 $(l,r)$ 是合法的，满足以下两个限制条件：\n\n1. $1 \\leq l \\leq r \\leq n$；\n2. 这个区间在线段树 $(1,n)$ 上的拆分不含有非法的节点。\n\n答案对 $998244353$ 取模。", "inputFormat": "**为了避免您被题意杀，请务必按照题目中给出的左开右闭法建线段树，采用其他的建树方式可能导致线段树的形态和 std 中的线段树不符导致 WA。**\n\n第一行两个整数 $n,m$，表示线段树的长度和区间个数。\n\n接下来 $m$ 行每行两个整数 $l,r$，表示 $(l,r)$ 这个区间在线段树上拆分出的节点全部为非法节点。", "outputFormat": "仅一行一个整数，表示所有合法的区间个数对 $998244353$ 取模之后的值。", "hint": "$1,2,3,4,5,6,7$ 测试点的分数全部为 $1$ 分。\n\n对于测试点 $1,2$，$n \\leq 1000,m\\leq 100$。\n\n对于测试点 $3,4$，$n \\leq 100000,m \\leq 5000$。\n\n对于测试点 $5,6,7$，$n \\leq 10^7,m \\leq 10^5$。\n\n对于所有数据，$1 \\leq n \\leq 10^{14}$，$1 \\leq m \\leq 10^5$，$1 \\leq l \\leq r \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5112", "type": "P", "difficulty": 6, "samples": [["20 15 3\noouuoouuoouuoouuoouu\n10 16\n2 15\n4 13\n6 7\n4 12\n12 14\n12 13\n7 19\n1 5\n6 13\n1 15\n9 15\n11 15\n1 19\n15 18", "3\n18\n8\n0\n6\n0\n0\n12\n1\n4\n21\n3\n1\n32\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "O2优化"], "title": "FZOUTSY", "background": "", "description": "### 原始题意\n\ncdm1020 是一名废宅，他平时最喜欢的事情就是水（复）群（读）。\n\n他截取了他最近水的群的聊天记录，并且通过某种奥妙重重的压缩算法将这些聊天记录压缩成了一个长度为 $n$ 的字符串，因为他是一个中二社厨，所以这个字符串当中仅仅含有 $\\mathtt{f,z,o,u,t,s,y}$ 这 $7$ 种字符，出于对后缀数据结构的狂热，他只对这个字符串的后缀感兴趣，他定义一个后缀的编号为 $i$，当且仅当它代表的字符串的区间为 $[i,n]$。\n\ncdm1020 定义一对后缀 $(i,j)$ 是\"$k$级复读的\"当且仅当 $i$ 和 $j$ 的最长公共前缀的长度大于等于 $k$，换句话说一对$k$级复读的后缀也是 $k-1,k-2,k-3,\\cdots,1,0$ 级复读的。\n\n现在他想问你对于编号在 $(l,r)$ 中的后缀，有多少对后缀是 $k$ 级复读的。\n\n### 一句话题意\n\n给定一个长度为 $n$ 并且字符集为 $\\mathtt{f,z,o,u,t,s,y}$ 的字符串和一个询问参数 $k$，多组询问 $(l,r)$ 求编号在 $(l,r)$ 间的后缀中，有多少对后缀的 LCP（最长公共前缀）长度大于等于 $k$。\n\n定义一个后缀的编号为 $i$ 当且仅当这个后缀代表的是 $(i,n)$ 这段区间的字符。", "inputFormat": "第一行三个正整数 $n,m,k$ 分别代表字符串的长度 $n$，询问次数 $m$ 和询问的参数 $k$。\n\n第二行一个长度为 $n$ 的字符串表示你需要处理的字符串。\n\n接下来 $m$ 行，每行两个正整数 $l,r$ 表示询问的区间 $l,r$。", "outputFormat": "输出 $m$ 行正整数，表示询问区间中 LCP 长度大于等于 $k$ 的后缀对数量。", "hint": "### 数据范围及约定\n\n对于全部数据，$1\\leq l\\leq r\\leq n \\leq 3×10^6$，$1\\leq k \\leq n \\leq 3×10^6$，$1\\leq m \\leq 10^5$，$1 \\leq n^2m \\leq 10^{15}$。\n\n保证输入的字符串中仅含 $\\mathtt{f,z,o,u,t,s,y}$ 这 $7$ 种小写字母。", "locale": "zh-CN", "translations": {"en": {"title": "FZOUTSY", "background": "", "description": "### Original Meaning\n\ncdm1020 is a shut-in. His favorite thing in daily life is chatting (and copying) in group chats.\n\nHe took the chat logs from a group he recently chatted in, and used some mysterious compression algorithm to compress these chat logs into a string of length $n$. Because he is a chuunibyou-style fan, this string contains only $7$ kinds of characters: $\\mathtt{f,z,o,u,t,s,y}$. Because of his obsession with suffix data structures, he is only interested in the suffixes of this string. He defines the index of a suffix to be $i$ if and only if the interval of the string it represents is $[i,n]$.\n\ncdm1020 defines a pair of suffixes $(i,j)$ to be “$k$-level copying” if and only if the length of the longest common prefix of suffix $i$ and suffix $j$ is at least $k$. In other words, a pair of $k$-level copying suffixes is also $k-1,k-2,k-3,\\cdots,1,0$-level copying.\n\nNow he wants to ask: among the suffixes with indices in $(l,r)$, how many pairs of suffixes are $k$-level copying.\n\n### One-Sentence Meaning\n\nGiven a string of length $n$ over the alphabet $\\mathtt{f,z,o,u,t,s,y}$ and a query parameter $k$, for multiple queries $(l,r)$, find among the suffixes with indices in $(l,r)$ how many pairs of suffixes have LCP (longest common prefix) length at least $k$.\n\nA suffix has index $i$ if and only if it represents the characters in the interval $(i,n)$.", "inputFormat": "The first line contains three positive integers $n,m,k$, representing the string length $n$, the number of queries $m$, and the query parameter $k$.\n\nThe second line contains a string of length $n$, which is the string you need to process.\n\nThe next $m$ lines each contain two positive integers $l,r$, representing the query interval $l,r$.", "outputFormat": "Output $m$ lines, each containing a positive integer, representing the number of suffix pairs in the query interval whose LCP length is at least $k$.", "hint": "### Constraints and Notes\n\nFor all testdata, $1\\leq l\\leq r\\leq n \\leq 3×10^6$, $1\\leq k \\leq n \\leq 3×10^6$, $1\\leq m \\leq 10^5$, $1 \\leq n^2m \\leq 10^{15}$.\n\nIt is guaranteed that the input string contains only the $7$ lowercase letters $\\mathtt{f,z,o,u,t,s,y}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "FZOUTSY", "background": "", "description": "### 原始题意\n\ncdm1020 是一名废宅，他平时最喜欢的事情就是水（复）群（读）。\n\n他截取了他最近水的群的聊天记录，并且通过某种奥妙重重的压缩算法将这些聊天记录压缩成了一个长度为 $n$ 的字符串，因为他是一个中二社厨，所以这个字符串当中仅仅含有 $\\mathtt{f,z,o,u,t,s,y}$ 这 $7$ 种字符，出于对后缀数据结构的狂热，他只对这个字符串的后缀感兴趣，他定义一个后缀的编号为 $i$，当且仅当它代表的字符串的区间为 $[i,n]$。\n\ncdm1020 定义一对后缀 $(i,j)$ 是\"$k$级复读的\"当且仅当 $i$ 和 $j$ 的最长公共前缀的长度大于等于 $k$，换句话说一对$k$级复读的后缀也是 $k-1,k-2,k-3,\\cdots,1,0$ 级复读的。\n\n现在他想问你对于编号在 $(l,r)$ 中的后缀，有多少对后缀是 $k$ 级复读的。\n\n### 一句话题意\n\n给定一个长度为 $n$ 并且字符集为 $\\mathtt{f,z,o,u,t,s,y}$ 的字符串和一个询问参数 $k$，多组询问 $(l,r)$ 求编号在 $(l,r)$ 间的后缀中，有多少对后缀的 LCP（最长公共前缀）长度大于等于 $k$。\n\n定义一个后缀的编号为 $i$ 当且仅当这个后缀代表的是 $(i,n)$ 这段区间的字符。", "inputFormat": "第一行三个正整数 $n,m,k$ 分别代表字符串的长度 $n$，询问次数 $m$ 和询问的参数 $k$。\n\n第二行一个长度为 $n$ 的字符串表示你需要处理的字符串。\n\n接下来 $m$ 行，每行两个正整数 $l,r$ 表示询问的区间 $l,r$。", "outputFormat": "输出 $m$ 行正整数，表示询问区间中 LCP 长度大于等于 $k$ 的后缀对数量。", "hint": "### 数据范围及约定\n\n对于全部数据，$1\\leq l\\leq r\\leq n \\leq 3×10^6$，$1\\leq k \\leq n \\leq 3×10^6$，$1\\leq m \\leq 10^5$，$1 \\leq n^2m \\leq 10^{15}$。\n\n保证输入的字符串中仅含 $\\mathtt{f,z,o,u,t,s,y}$ 这 $7$ 种小写字母。", "locale": "zh-CN"}}}
{"pid": "P5113", "type": "P", "difficulty": 7, "samples": [["20 20\n8 6 4 9 9 8 5 5 7 9 8 8 5 8 2 2 2 1 9 4 \n1 17 19 4\n1 3 8 5\n3 2\n2 4 10\n1 14 19 8\n2 10 16\n2 9 9\n1 1 18 1\n1 1 7 10\n2 4 6\n2 9 10\n1 5 17 2\n1 10 19 6\n1 2 5 2\n1 6 8 2\n1 14 19 1\n1 4 7 6\n1 17 19 10\n2 8 12\n1 10 10 2\n", "52\n54\n7\n30\n2\n22\n"], ["20 20\n8 6 4 9 9 8 5 5 7 9 8 8 5 8 2 2 2 1 9 4 \n1 17 19 4\n1 3 8 5\n3 2\n2 4 10\n1 58 39 8\n2 62 36\n2 63 63\n1 6 21 1\n1 6 0 10\n2 3 1\n2 23 20\n1 7 19 2\n1 8 17 6\n1 0 7 2\n1 4 10 2\n1 12 17 1\n1 6 5 6\n1 19 17 10\n2 10 14\n1 28 28 2\n", "52\n54\n7\n30\n2\n22\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "Sabbat of the witch", "background": "您正在在游玩《魔女的夜宴》,突然开始思考一个哲学问题:这作的restart线到底算不算ntr？\n\n![](http://0d077ef9e74d8.cdn.sohucs.com/rcLQDT4_png)\n\n![](http://0d077ef9e74d8.cdn.sohucs.com/rcLQJyV_png)\n\n![](http://0d077ef9e74d8.cdn.sohucs.com/rcLQMrk_png)\n~~您在思索了很长时间之后,突然注意到这是个涉及到时间线和人格同一性的哲学问题~~\n\n此时您突然发现galgame和数(毒)据(瘤)结(分)构(块)有一些奥妙重重的关系，为了更好的思考这个问题，您决定去写一道数(毒)据(瘤)结(分)构(块)题", "description": "维护一个序列,支持以下三种操作\n\n1.区间赋值\n\n2.区间求和\n\n3.撤回之前的一个区间赋值操作\n\n**强制在线**\n\n注意：这里的撤回操作既不会影响之前的操作也不会影响之后的操作，换句话讲撤回一个操作之后序列将会变成历史上从来没有过被撤回操作的状态\n\n煮个栗子，假设我们对序列按顺序执行了1,2,3,4,5号操作\n\n当我们撤回操作4的时候，整个序列应该和按顺序执行了1,2,3,5操作之后的序列一样\n\n当我们接着撤回操作2的时候，整个序列应该和按顺序执行了1,3,5操作之后的序列一样\n\n\n\n\n\n", "inputFormat": "第一行两个整数$n,m$表示序列长度和操作个数\n\n第二行$n$个整数$a_{1}...a_{n}$其中$a_{i}$表示序列的第$i$项\n\n接下来$m$行\n\n如果这一行是$1,l,r,v$的话代表将$(l,r)$这段区间赋值成$v$,假如这个操作是第$k$次赋值操作，那么这个操作的编号就是$k$\n\n如果这一行是$2,l,r$的话代表询问$(l,r)$这段区间中数字的和\n\n如果这一行是$3,x$的话代表撤回编号为$x$的操作\n\n**数据保证被撤回的操作一定存在并且每个操作只会被撤回一次**\n\n为了体现题目的在线性，我们设lastans表示读入当前操作时最后一次询问的答案，(lastans的初始值为0)\n\n那么对于操作1,你需要操作的真实区间是$(l \\oplus lastans,r \\oplus lastans)$\n\n对于操作2,你需要询问的真实区间是$(l \\oplus lastans,r \\oplus lastans)$\n\n对于操作3,你需要撤回的操作编号是$x \\oplus lastans$\n\n其中$\\oplus$运算符表示异或运算\n\n", "outputFormat": "对于每一个操作2输出一行一个整数，表示询问区间中的元素之和\n\n为了方便你理解题意和调试，我们了准备两个样例，一个是强制在线的而另一个是非强制在线的(尽管本题没有非强制在线的部分分)", "hint": "对于第9,10个测试点,满足$n,m \\leq 10^4$，这两个测试点的分数都为1\n\n对于剩余的测试点$n,m \\leq 10^5$并且操作1的个数不超过$65000$\n\n保证输入的数字全部小于$10^9$", "locale": "zh-CN", "translations": {"en": {"title": "Sabbat of the witch", "background": "You are playing *Sabbat of the Witch* and suddenly start thinking about a philosophical question: does the restart route in this game count as NTR?\n\n~~After thinking for a long time, you suddenly realize this is a philosophical problem involving timelines and personal identity.~~\n\nThen you suddenly discover that galgames and data structures have some deeply mysterious connections. To think about this problem better, you decide to write a data structure problem.", "description": "Maintain a sequence and support the following three operations.\n\n1. Range assignment.\n2. Range sum query.\n3. Undo a previous range assignment operation.\n\n**Online only.**\n\nNote: this undo operation does not affect any operations before it, and also does not affect any operations after it. In other words, after undoing an operation, the sequence becomes the state as if the undone operation had never existed in history.\n\nFor example, suppose we apply operations $1,2,3,4,5$ in order.\n\n- When we undo operation $4$, the whole sequence should be the same as the sequence after applying operations $1,2,3,5$ in order.\n- When we then undo operation $2$, the whole sequence should be the same as the sequence after applying operations $1,3,5$ in order.", "inputFormat": "The first line contains two integers $n,m$, representing the length of the sequence and the number of operations.\n\nThe second line contains $n$ integers $a_{1}...a_{n}$, where $a_{i}$ is the $i$-th element of the sequence.\n\nNext $m$ lines:\n\n- If a line is $1,l,r,v$, it means assigning the interval $(l,r)$ to value $v$. If this operation is the $k$-th assignment operation, then its ID is $k$.\n- If a line is $2,l,r$, it means querying the sum of numbers in the interval $(l,r)$.\n- If a line is $3,x$, it means undoing the operation whose ID is $x$.\n\n**It is guaranteed that the undone operation always exists, and each operation will be undone at most once.**\n\nTo enforce the online requirement, let `lastans` be the answer of the most recent query at the time the current operation is read (`lastans` is initially $0$).\n\n- For operation 1, the real interval you need to modify is $(l \\oplus lastans,r \\oplus lastans)$.\n- For operation 2, the real interval you need to query is $(l \\oplus lastans,r \\oplus lastans)$.\n- For operation 3, the real operation ID you need to undo is $x \\oplus lastans$.\n\nHere $\\oplus$ denotes the XOR operation.", "outputFormat": "For each operation 2, output one integer per line, representing the sum of elements in the queried interval.\n\nTo help you understand the statement and debug, we prepared two samples: one is online-only and the other is not online-only (although this problem has no partial score for the non-online-only part).", "hint": "For test points 9 and 10, $n,m \\leq 10^4$. Each of these test points is worth 1 point.\n\nFor the remaining test points, $n,m \\leq 10^5$, and the number of operation 1 does not exceed $65000$.\n\nAll input numbers are guaranteed to be less than $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Sabbat of the witch", "background": "您正在在游玩《魔女的夜宴》,突然开始思考一个哲学问题:这作的restart线到底算不算ntr？\n\n![](http://0d077ef9e74d8.cdn.sohucs.com/rcLQDT4_png)\n\n![](http://0d077ef9e74d8.cdn.sohucs.com/rcLQJyV_png)\n\n![](http://0d077ef9e74d8.cdn.sohucs.com/rcLQMrk_png)\n~~您在思索了很长时间之后,突然注意到这是个涉及到时间线和人格同一性的哲学问题~~\n\n此时您突然发现galgame和数(毒)据(瘤)结(分)构(块)有一些奥妙重重的关系，为了更好的思考这个问题，您决定去写一道数(毒)据(瘤)结(分)构(块)题", "description": "维护一个序列,支持以下三种操作\n\n1.区间赋值\n\n2.区间求和\n\n3.撤回之前的一个区间赋值操作\n\n**强制在线**\n\n注意：这里的撤回操作既不会影响之前的操作也不会影响之后的操作，换句话讲撤回一个操作之后序列将会变成历史上从来没有过被撤回操作的状态\n\n煮个栗子，假设我们对序列按顺序执行了1,2,3,4,5号操作\n\n当我们撤回操作4的时候，整个序列应该和按顺序执行了1,2,3,5操作之后的序列一样\n\n当我们接着撤回操作2的时候，整个序列应该和按顺序执行了1,3,5操作之后的序列一样\n\n\n\n\n\n", "inputFormat": "第一行两个整数$n,m$表示序列长度和操作个数\n\n第二行$n$个整数$a_{1}...a_{n}$其中$a_{i}$表示序列的第$i$项\n\n接下来$m$行\n\n如果这一行是$1,l,r,v$的话代表将$(l,r)$这段区间赋值成$v$,假如这个操作是第$k$次赋值操作，那么这个操作的编号就是$k$\n\n如果这一行是$2,l,r$的话代表询问$(l,r)$这段区间中数字的和\n\n如果这一行是$3,x$的话代表撤回编号为$x$的操作\n\n**数据保证被撤回的操作一定存在并且每个操作只会被撤回一次**\n\n为了体现题目的在线性，我们设lastans表示读入当前操作时最后一次询问的答案，(lastans的初始值为0)\n\n那么对于操作1,你需要操作的真实区间是$(l \\oplus lastans,r \\oplus lastans)$\n\n对于操作2,你需要询问的真实区间是$(l \\oplus lastans,r \\oplus lastans)$\n\n对于操作3,你需要撤回的操作编号是$x \\oplus lastans$\n\n其中$\\oplus$运算符表示异或运算\n\n", "outputFormat": "对于每一个操作2输出一行一个整数，表示询问区间中的元素之和\n\n为了方便你理解题意和调试，我们了准备两个样例，一个是强制在线的而另一个是非强制在线的(尽管本题没有非强制在线的部分分)", "hint": "对于第9,10个测试点,满足$n,m \\leq 10^4$，这两个测试点的分数都为1\n\n对于剩余的测试点$n,m \\leq 10^5$并且操作1的个数不超过$65000$\n\n保证输入的数字全部小于$10^9$", "locale": "zh-CN"}}}
{"pid": "P5114", "type": "P", "difficulty": 7, "samples": [["15 15\n29 -23 -14 -50 -13 -23 5 33 50 32 27 27 -9 -42 -11\n-37 39 21 50 10 -42 -2 25 1 28 40 -45 -24 -29 47\n0 0 1 0 0 1 1 0 0 1 0 1 0 0 0\n2 1\n3 1\n4 3\n5 2\n6 2\n7 2\n8 4\n9 1\n10 2\n11 5\n12 3\n13 5\n14 3\n15 9\n-8\n36\n44\n29\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n5\n", "679\n3252\n3988\n2608\n436\n355\n274\n199\n135\n126\n155\n232\n309\n386\n471\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["点分治", "凸包"], "title": "八月脸", "background": "Cdm1020 十分喜欢 August-soft 出品的游戏，在游玩 august 社历届作品的时候他突然发现了一些神奇的事实。\n\n**那就是所有的人物立绘的脸都是一样的!**\n\n\n![](https://i.loli.net/2018/09/17/5b9fb47a8b3e0.gif)\n\n不过尽管如此，作为一名资深的八月厨，他依然可以敏锐的分辨出各张立绘之间的细微差异 ~~（并不，就是同一张脸有什么好分辨的）~~，为了进一步研究八月社的立绘水平，Cdm1020 将八月社的所有立绘都放到了一颗树上 ~~（什么鬼啊）~~\n\n（如果你不知道什么是树的话，你可以将树理解为一个无环的无向连通图）\n\n具体来讲树上的每个节点仅保存了一张八月社的立绘，Cdm1020 通过和他的八月厨朋友们交流发现，狂热程度不同的八月厨对于同一张立绘的喜爱程度是不一样的，具体来讲每张立绘有两个属性 $a$ 和 $b$，对于一个狂热指数为 $k$ 的八月厨来讲，他对一张属性为 $(a,b)$ 的立绘的喜爱程度为 $ka+b$。\n\n现在 Cdm1020 想要带领他的 $m$ 个狂热指数不同的朋友参观八月社的立绘（们），他希望你对于他的每一个朋友，帮他规划出一条喜爱程度之和最大的游览路线。\n\n当然这个问题很简单，他是不会拿来烦你的。现在他真正头疼的事情是八月社新来了一个画师夏野。他的朋友们现在闹腾着想要看八月社的新立绘 ~~（反正还是一张脸有什么好看的）~~，所以他规定你的路线必须从一张属于 b 叔的立绘开始，到一张属于夏野的立绘结束，你能帮帮他吗？", "description": "**请忽略上面的鬼话，就当什么也没看见**\n\n一句话题意，给定一颗 $n$ 个点的树，树上每个点不是黑色就是白色，每个点有两个属性 $a$ 和 $b$。\n\n现在多组询问，每次询问仅给出一个参数 $k$，要求你从树上找出一条路径 $(u,v)$ 使得 $u$ 和 $v$ 的颜色不同并且\n\n$$k\\times \\sum_{p \\in path (u-v)}p.a+\\sum_{p\\in path(u-v)}p.b$$\n\n最大，对于每个询问你仅需要输出这个最大值即可（式子里面的两个和式的意思分别是路径上的点 $a$ 属性之和和路径上点的 $b$ 属性之和）。\n\n**tips: $a,b,k$ 均可正可负，并且我们不允许你不选路径，也就是说我们求出的的最大值可以是一个负数，这会发生在所有合法路径的权值都是负数的时候**。", "inputFormat": "第一行两个正整数 $n,m$ 表示树的节点个数和询问次数。\n\n接下来一行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个点的 $a$ 属性的值。\n\n接下来一行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个点的 $b$ 属性的值。\n\n接下来一行 $n$ 个整数，每个数要么为 $0$ 要么为 $1$，第 $i$ 个数为 $0$ 表示第 $i$ 个点是一个白色点，为 $1$ 表示第 $i$ 个点是一个黑色点。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示存在一条从点 $u$ 到点 $v$ 的边。\n\n接下来 $m$ 行，每行一个整数 $k$ 表示询问的参数。", "outputFormat": "输出 $m$ 行，对于每一个询问，输出题目中给出式子的最大值。", "hint": "$2 \\leq n\\leq 10^5$，$1 \\leq m \\leq 10^5$，$-10^8 \\leq k \\leq 10^8 $\n\n保证不会存在所有点都是黑色或者都是白色的数据，保证对于树上的任意路径，路径上点的 $a$ 属性之和的绝对值不超过$1.5×10^9$，路径上点的 $b$ 属性之和的绝对值不超过 $1.5×10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "August Faces.", "background": "Cdm1020 really likes games made by August-soft. While playing August’s past works, he suddenly discovered some amazing facts.\n\n**That is, all character portraits have the same face!**\n\n![](https://i.loli.net/2018/09/17/5b9fb47a8b3e0.gif)\n\nEven so, as an experienced “August fan”, he can still sharply tell the tiny differences between portraits ~~(no, it’s the same face, what is there to tell)~~. To further study August’s portrait quality, Cdm1020 put all of August’s portraits onto a tree ~~(what on earth)~~.\n\n(If you do not know what a tree is, you can think of it as an undirected connected graph with no cycles.)\n\nMore specifically, each node on the tree stores exactly one portrait from August. After talking with his fellow fans, Cdm1020 found that fans with different “enthusiasm levels” like the same portrait differently. Each portrait has two attributes $a$ and $b$. For a fan whose enthusiasm index is $k$, their liking for a portrait with attributes $(a,b)$ is $ka+b$.\n\nNow Cdm1020 wants to lead his $m$ friends (with different enthusiasm indices) to visit the portraits. For each friend, he wants you to plan a visiting route with the maximum total liking.\n\nOf course, this problem is too easy, so he would not bother you with it. What really troubles him is that August has a new artist, Xiano (Xià Yě). His friends are now making noise and want to see August’s new portraits ~~(it is still the same face anyway, what is there to see)~~, so he requires that your route must start from a portrait by Uncle B and end at a portrait by Xiano. Can you help him?", "description": "**Please ignore the nonsense above and pretend you did not see anything.**\n\nIn one sentence: you are given a tree with $n$ nodes. Each node is either black or white, and each node has two attributes $a$ and $b$.\n\nNow there are multiple queries. Each query gives only one parameter $k$. You need to find a path $(u,v)$ in the tree such that $u$ and $v$ have different colors, and\n\n$$k\\times \\sum_{p \\in path (u-v)}p.a+\\sum_{p\\in path(u-v)}p.b$$\n\nis maximized. For each query, you only need to output this maximum value (the two summations mean the sum of attribute $a$ on the path and the sum of attribute $b$ on the path, respectively).\n\n**Tips: $a$, $b$, and $k$ can all be positive or negative, and you are not allowed to choose no path. That is, the maximum value we find may be negative. This happens when the weights of all valid paths are negative.**", "inputFormat": "The first line contains two positive integers $n,m$, representing the number of nodes in the tree and the number of queries.\n\nThe next line contains $n$ integers. The $i$-th integer is the value of attribute $a$ of node $i$.\n\nThe next line contains $n$ integers. The $i$-th integer is the value of attribute $b$ of node $i$.\n\nThe next line contains $n$ integers, each being either $0$ or $1$. If the $i$-th number is $0$, then node $i$ is a white node; if it is $1$, then node $i$ is a black node.\n\nThe next $n-1$ lines each contain two positive integers $u,v$, indicating that there is an edge between node $u$ and node $v$.\n\nThe next $m$ lines each contain one integer $k$, the parameter of the query.", "outputFormat": "Output $m$ lines. For each query, output the maximum value of the expression given in the statement.", "hint": "Constraints: $2 \\leq n\\leq 10^5$, $1 \\leq m \\leq 10^5$, $-10^8 \\leq k \\leq 10^8$.\n\nIt is guaranteed that there will not be testdata where all nodes are black or all nodes are white. It is guaranteed that for any path in the tree, the absolute value of the sum of attribute $a$ on the path does not exceed $1.5×10^9$, and the absolute value of the sum of attribute $b$ on the path does not exceed $1.5×10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "八月脸", "background": "Cdm1020 十分喜欢 August-soft 出品的游戏，在游玩 august 社历届作品的时候他突然发现了一些神奇的事实。\n\n**那就是所有的人物立绘的脸都是一样的!**\n\n\n![](https://i.loli.net/2018/09/17/5b9fb47a8b3e0.gif)\n\n不过尽管如此，作为一名资深的八月厨，他依然可以敏锐的分辨出各张立绘之间的细微差异 ~~（并不，就是同一张脸有什么好分辨的）~~，为了进一步研究八月社的立绘水平，Cdm1020 将八月社的所有立绘都放到了一颗树上 ~~（什么鬼啊）~~\n\n（如果你不知道什么是树的话，你可以将树理解为一个无环的无向连通图）\n\n具体来讲树上的每个节点仅保存了一张八月社的立绘，Cdm1020 通过和他的八月厨朋友们交流发现，狂热程度不同的八月厨对于同一张立绘的喜爱程度是不一样的，具体来讲每张立绘有两个属性 $a$ 和 $b$，对于一个狂热指数为 $k$ 的八月厨来讲，他对一张属性为 $(a,b)$ 的立绘的喜爱程度为 $ka+b$。\n\n现在 Cdm1020 想要带领他的 $m$ 个狂热指数不同的朋友参观八月社的立绘（们），他希望你对于他的每一个朋友，帮他规划出一条喜爱程度之和最大的游览路线。\n\n当然这个问题很简单，他是不会拿来烦你的。现在他真正头疼的事情是八月社新来了一个画师夏野。他的朋友们现在闹腾着想要看八月社的新立绘 ~~（反正还是一张脸有什么好看的）~~，所以他规定你的路线必须从一张属于 b 叔的立绘开始，到一张属于夏野的立绘结束，你能帮帮他吗？", "description": "**请忽略上面的鬼话，就当什么也没看见**\n\n一句话题意，给定一颗 $n$ 个点的树，树上每个点不是黑色就是白色，每个点有两个属性 $a$ 和 $b$。\n\n现在多组询问，每次询问仅给出一个参数 $k$，要求你从树上找出一条路径 $(u,v)$ 使得 $u$ 和 $v$ 的颜色不同并且\n\n$$k\\times \\sum_{p \\in path (u-v)}p.a+\\sum_{p\\in path(u-v)}p.b$$\n\n最大，对于每个询问你仅需要输出这个最大值即可（式子里面的两个和式的意思分别是路径上的点 $a$ 属性之和和路径上点的 $b$ 属性之和）。\n\n**tips: $a,b,k$ 均可正可负，并且我们不允许你不选路径，也就是说我们求出的的最大值可以是一个负数，这会发生在所有合法路径的权值都是负数的时候**。", "inputFormat": "第一行两个正整数 $n,m$ 表示树的节点个数和询问次数。\n\n接下来一行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个点的 $a$ 属性的值。\n\n接下来一行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个点的 $b$ 属性的值。\n\n接下来一行 $n$ 个整数，每个数要么为 $0$ 要么为 $1$，第 $i$ 个数为 $0$ 表示第 $i$ 个点是一个白色点，为 $1$ 表示第 $i$ 个点是一个黑色点。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示存在一条从点 $u$ 到点 $v$ 的边。\n\n接下来 $m$ 行，每行一个整数 $k$ 表示询问的参数。", "outputFormat": "输出 $m$ 行，对于每一个询问，输出题目中给出式子的最大值。", "hint": "$2 \\leq n\\leq 10^5$，$1 \\leq m \\leq 10^5$，$-10^8 \\leq k \\leq 10^8 $\n\n保证不会存在所有点都是黑色或者都是白色的数据，保证对于树上的任意路径，路径上点的 $a$ 属性之和的绝对值不超过$1.5×10^9$，路径上点的 $b$ 属性之和的绝对值不超过 $1.5×10^9$。", "locale": "zh-CN"}}}
{"pid": "P5115", "type": "P", "difficulty": 7, "samples": [["aabccbbbcbbcbccacbcb\n8 20", "140"], ["checkcheckcheckonetwo\n7 11", "216"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "O2优化"], "title": "Check,Check,Check one two!", "background": "您正在听くらげP的チェチェ・チェック・ワンツー!，突然教导主任推门进来了，于是您只好假装自己在写字符串题\n\n~~(结果教导主任一眼秒了这水题，您因没事刷水题被批判了一番)~~", "description": "给定一个字符串\n\n我们定义$lcp(i,j)$表示从字符串第$i$个位置开始的后缀和从第$j$个位置开始的后缀的最长公共前缀长度\n\n我们定义$lcs(i,j)$表示在字符串第$i$个位置结束的前缀和在第$j$个位置结束的前缀的最长公共后缀长度\n\n现在给定一个长度为$n$的字符串，希望您求出\n\n$$\\sum_{1\\leq i < j \\leq n}lcp(i,j)lcs(i,j)[lcp(i,j)\\leq k1][lcs(i,j) \\leq k2]$$\n\n模$2^{64}$的值(也就是unsigned long long自然溢出即可)\n\n$[lcs(i,j) \\leq k]$表示如果$lcs(i,j) \\leq k$这个命题为真那么这个式子的值是1否则是0,另外一个方括号也是同理\n\n", "inputFormat": "第一行一个字符串$S$,保证仅含有小写的英文字母\n\n第二行两个正整数$k1,k2$表示题目中的限制条件", "outputFormat": "仅一行一个正整数，表示题目中所给式子模$2^{64}$的值", "hint": "设n表示字符串的长度\n\n测试点10的分值为1,这个测试点的$n \\leq 1000$\n\n对于所有的测试点\n\n$$1 \\leq n \\leq 10^5,1\\leq k1 , k2 \\leq n$$", "locale": "zh-CN", "translations": {"en": {"title": "Check, Check, Check one two!", "background": "You are listening to くらげP’s チェチェ・チェック・ワンツー!, and suddenly the head teacher pushes the door open. So you have to pretend that you are working on a string problem.\n\n~~(But the head teacher sees through this easy problem at a glance, and you get criticized for doing easy problems when you had nothing to do.)~~", "description": "You are given a string.\n\nWe define $lcp(i,j)$ as the length of the longest common prefix of the suffix starting at position $i$ of the string and the suffix starting at position $j$.\n\nWe define $lcs(i,j)$ as the length of the longest common suffix of the prefix ending at position $i$ of the string and the prefix ending at position $j$.\n\nNow you are given a string of length $n$, and you need to compute\n\n$$\\sum_{1\\leq i < j \\leq n}lcp(i,j)lcs(i,j)[lcp(i,j)\\leq k1][lcs(i,j) \\leq k2]$$\n\nmodulo $2^{64}$ (that is, natural overflow of unsigned long long is sufficient).\n\n$[lcs(i,j) \\leq k]$ means that if the proposition $lcs(i,j) \\leq k$ is true, then this term equals 1; otherwise it equals 0. The other bracket is defined similarly.", "inputFormat": "The first line contains a string $S$, guaranteed to consist only of lowercase English letters.\n\nThe second line contains two positive integers $k1,k2$, representing the constraints in the statement.", "outputFormat": "Output a single positive integer, which is the value of the given expression modulo $2^{64}$.", "hint": "Let $n$ denote the length of the string.\n\nTest point 10 is worth 1 point, and for this test point, $n \\leq 1000$.\n\nFor all test points,\n\n$$1 \\leq n \\leq 10^5,1\\leq k1 , k2 \\leq n$$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Check,Check,Check one two!", "background": "您正在听くらげP的チェチェ・チェック・ワンツー!，突然教导主任推门进来了，于是您只好假装自己在写字符串题\n\n~~(结果教导主任一眼秒了这水题，您因没事刷水题被批判了一番)~~", "description": "给定一个字符串\n\n我们定义$lcp(i,j)$表示从字符串第$i$个位置开始的后缀和从第$j$个位置开始的后缀的最长公共前缀长度\n\n我们定义$lcs(i,j)$表示在字符串第$i$个位置结束的前缀和在第$j$个位置结束的前缀的最长公共后缀长度\n\n现在给定一个长度为$n$的字符串，希望您求出\n\n$$\\sum_{1\\leq i < j \\leq n}lcp(i,j)lcs(i,j)[lcp(i,j)\\leq k1][lcs(i,j) \\leq k2]$$\n\n模$2^{64}$的值(也就是unsigned long long自然溢出即可)\n\n$[lcs(i,j) \\leq k]$表示如果$lcs(i,j) \\leq k$这个命题为真那么这个式子的值是1否则是0,另外一个方括号也是同理\n\n", "inputFormat": "第一行一个字符串$S$,保证仅含有小写的英文字母\n\n第二行两个正整数$k1,k2$表示题目中的限制条件", "outputFormat": "仅一行一个正整数，表示题目中所给式子模$2^{64}$的值", "hint": "设n表示字符串的长度\n\n测试点10的分值为1,这个测试点的$n \\leq 1000$\n\n对于所有的测试点\n\n$$1 \\leq n \\leq 10^5,1\\leq k1 , k2 \\leq n$$", "locale": "zh-CN"}}}
{"pid": "P5116", "type": "P", "difficulty": 2, "samples": [["10 3\n11 4\n12 5", "0\n10\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2018", "USACO"], "title": "[USACO18DEC] Mixing Milk B", "background": "", "description": "农业，尤其是生产牛奶，是一个竞争激烈的行业。Farmer John 发现如果他不在牛奶生产工艺上有所创新，他的乳制品生意可能就会受到重创！\n\n幸运的是，Farmer John 想出了一个好主意。他的三头获奖的乳牛，Bessie、Elsie 和 Mildred，各自产奶的口味有些许不同，他打算混合这三种牛奶调制出完美的口味。\n\n为了混合这三种不同的牛奶，他拿来三个桶，其中分别装有三头奶牛所产的奶。这些桶可能有不同的容积，也可能并没有完全装满。然后他将桶 $1$ 的牛奶倒入桶 $2$，然后将桶 $2$ 中的牛奶倒入桶 $3$，然后将桶 $3$ 中的牛奶倒入桶 $1$，然后再将桶 $1$ 的牛奶倒入桶 $2$，如此周期性地操作，共计进行 $100$ 次（所以第 $100$ 次操作会是桶 $1$ 倒入桶 $2$）。当 Farmer John 将桶 $a$ 中的牛奶倒入桶 $b$ 时，他会倒出尽可能多的牛奶，直到桶 $a$ 被倒空或是桶 $b$ 被倒满。\n\n请告诉 Farmer John 当他倒了 $100$ 次之后每个桶里将会有多少牛奶。\n\n", "inputFormat": "输入文件的第一行包含两个空格分隔的整数：第一个桶的容积 $c_1$，以及第一个桶里的牛奶量 $m_1$。$c_1$ 和 $m_1$ 均为正，并且不超过 $10^9$。第二和第三行类似地包含第二和第三个桶地容积和牛奶量。", "outputFormat": "输出三行，给出倒了 $100$ 次之后每个桶里的牛奶量。", "hint": "在这个例子中，每倒一次之后每个桶里的牛奶量如下：\n\n0. 初始状态：3  4  5\n1. 桶 1->2：0  7  5\n2. 桶 2->3：0  0  12\n3. 桶 3->1：10 0  2\n4. 桶 1->2：0  10 2\n5. 桶 2->3：0  0  12\n\n（之后最后三个状态循环出现……）", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Mixing Milk B", "background": "", "description": "Farming, especially milk production, is a highly competitive industry. Farmer John realizes that if he does not innovate in the milk production process, his dairy business could suffer a major blow.\n\nFortunately, Farmer John has come up with a great idea. His three award-winning cows, Bessie, Elsie, and Mildred, produce milk with slightly different flavors, and he plans to mix these three kinds of milk to create the perfect taste.\n\nTo mix these three different kinds of milk, he uses three buckets, each containing the milk produced by one of the cows. These buckets may have different capacities, and they may not be completely full. Then he pours the milk from bucket $1$ into bucket $2$, then pours the milk from bucket $2$ into bucket $3$, then pours the milk from bucket $3$ into bucket $1$, then pours the milk from bucket $1$ into bucket $2$, and so on in a cycle, for a total of $100$ pours (so the $100$-th operation will be bucket $1$ poured into bucket $2$). When Farmer John pours milk from bucket $a$ into bucket $b$, he pours as much as possible until bucket $a$ is empty or bucket $b$ is full.\n\nPlease tell Farmer John how much milk will be in each bucket after he has poured $100$ times.", "inputFormat": "The first line of the input file contains two space-separated integers: the capacity of the first bucket $c_1$, and the amount of milk in the first bucket $m_1$. Both $c_1$ and $m_1$ are positive and do not exceed $10^9$. The second and third lines similarly contain the capacities and milk amounts for the second and third buckets.", "outputFormat": "Output three lines, giving the amount of milk in each bucket after $100$ pours.", "hint": "In this example, after each pour, the amounts of milk in the buckets are as follows.\n\n0. Initial state: 3  4  5  \n1. Bucket 1->2: 0  7  5  \n2. Bucket 2->3: 0  0  12  \n3. Bucket 3->1: 10 0  2  \n4. Bucket 1->2: 0  10 2  \n5. Bucket 2->3: 0  0  12  \n\n(The last three states then repeat in a cycle.)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Mixing Milk B", "background": "", "description": "农业，尤其是生产牛奶，是一个竞争激烈的行业。Farmer John 发现如果他不在牛奶生产工艺上有所创新，他的乳制品生意可能就会受到重创！\n\n幸运的是，Farmer John 想出了一个好主意。他的三头获奖的乳牛，Bessie、Elsie 和 Mildred，各自产奶的口味有些许不同，他打算混合这三种牛奶调制出完美的口味。\n\n为了混合这三种不同的牛奶，他拿来三个桶，其中分别装有三头奶牛所产的奶。这些桶可能有不同的容积，也可能并没有完全装满。然后他将桶 $1$ 的牛奶倒入桶 $2$，然后将桶 $2$ 中的牛奶倒入桶 $3$，然后将桶 $3$ 中的牛奶倒入桶 $1$，然后再将桶 $1$ 的牛奶倒入桶 $2$，如此周期性地操作，共计进行 $100$ 次（所以第 $100$ 次操作会是桶 $1$ 倒入桶 $2$）。当 Farmer John 将桶 $a$ 中的牛奶倒入桶 $b$ 时，他会倒出尽可能多的牛奶，直到桶 $a$ 被倒空或是桶 $b$ 被倒满。\n\n请告诉 Farmer John 当他倒了 $100$ 次之后每个桶里将会有多少牛奶。\n\n", "inputFormat": "输入文件的第一行包含两个空格分隔的整数：第一个桶的容积 $c_1$，以及第一个桶里的牛奶量 $m_1$。$c_1$ 和 $m_1$ 均为正，并且不超过 $10^9$。第二和第三行类似地包含第二和第三个桶地容积和牛奶量。", "outputFormat": "输出三行，给出倒了 $100$ 次之后每个桶里的牛奶量。", "hint": "在这个例子中，每倒一次之后每个桶里的牛奶量如下：\n\n0. 初始状态：3  4  5\n1. 桶 1->2：0  7  5\n2. 桶 2->3：0  0  12\n3. 桶 3->1：10 0  2\n4. 桶 1->2：0  10 2\n5. 桶 2->3：0  0  12\n\n（之后最后三个状态循环出现……）", "locale": "zh-CN"}}}
{"pid": "P5117", "type": "P", "difficulty": 2, "samples": [["3\n4 10 1\n8 13 3\n2 6 2", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2018", "USACO", "差分"], "title": "[USACO18DEC] The Bucket List B", "background": "", "description": "Farmer John 正在考虑改变他给奶牛挤奶的时候分配牛奶桶的方式。他认为这最终能使得他使用数量更少的桶，然而他不清楚具体是多少。请帮助他！\n\nFarmer John 有 $N$ 头奶牛（$1\\le N\\le 100$），方便起见编号为 $1\\dots N$。 第 $i$ 头奶牛需要从时间 $s_i$ 到时间 $t_i$ 之间挤奶，并且挤奶过程中需要用到 $b_i$ 个桶。于是多头奶牛可能在同一时刻都在挤奶；如果这样，他们不能使用相同的桶。也就是说，一个在第 $i$ 头奶牛挤奶时用的桶不可以被任何在时间 $s_i$ 到时间 $t_i$ 之间挤奶的其他奶牛使用。当然，这个桶在这段时间之外可以被其他奶牛所使用。为了简化他的工作，FJ 保证在任一时刻，至多只有一头奶牛开始或是结束挤奶（也就是说，所有的 $s_i$ 和 $t_i$ 各不相同）。\n\nFJ 有一个储藏室，里面有依次编号为 $1$、$2$、$3$、……的桶。在他的挤奶策略中，当某一头奶牛（比如说，奶牛 $i$）开始挤奶（在时间 $s_i$），FJ 就跑到储藏室取出编号最小的 $b_i$ 个桶分配给第i头奶牛用来挤奶。\n\n请求出 FJ 需要在储藏室中存放多少个桶才能使得他能够顺利地给所有奶牛挤奶。\n", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行，每行描述了一头奶牛，包含三个空格分隔的数 $s_i$，$t_i$，和 $b_i$。 其中 $s_i$ 和 $t_i$ 均为 $1\\dots 1000$ 之间的整数，$b_i$ 为 $1\\dots 10$ 之间的整数。", "outputFormat": "输出一个整数，为 FJ 需要的桶的数量。", "hint": "在这个例子中，FJ 需要 $4$ 个桶：他用桶 $1$ 和桶 $2$ 来给奶牛 $3$ 挤奶（从时间 $2$ 开始）。他用桶 $3$ 给奶牛 $1$ 挤奶（从时间 $4$ 开始）。当奶牛 $2$ 在时间 $8$ 开始挤奶时，桶 $1$ 和桶 $2$ 可以再次利用，然而桶 $3$ 不可以，所以他会使用桶 $1$、桶 $2$ 和桶 $4$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] The Bucket List B", "background": "", "description": "Farmer John is considering changing the way he assigns milk buckets when milking his cows. He believes this might let him use fewer buckets overall, but he does not know how many. Please help him.\n\nFarmer John has $N$ cows ($1\\le N\\le 100$), numbered $1\\dots N$ for convenience. Cow $i$ needs to be milked from time $s_i$ to time $t_i$, and during milking it requires $b_i$ buckets. Therefore, multiple cows may be milking at the same time; if so, they cannot share the same buckets. In other words, a bucket used for cow $i$ cannot be used by any other cow that is being milked during the time interval from $s_i$ to $t_i$. Of course, that bucket can be used by other cows outside this time period. To simplify his work, FJ guarantees that at any moment, at most one cow starts or ends milking (that is, all $s_i$ and $t_i$ are pairwise distinct).\n\nFJ has a storage room with buckets numbered $1$, $2$, $3$, $\\dots$ in order. Under his milking strategy, when a cow (say, cow $i$) starts milking (at time $s_i$), FJ goes to the storage room and takes the smallest-numbered $b_i$ buckets to assign to cow $i$ for milking.\n\nCompute how many buckets FJ needs to store so that he can successfully milk all cows.", "inputFormat": "The first line contains $N$. The next $N$ lines each describe one cow, containing three space-separated numbers $s_i$, $t_i$, and $b_i$. Here $s_i$ and $t_i$ are integers between $1\\dots 1000$, and $b_i$ is an integer between $1\\dots 10$.", "outputFormat": "Output one integer: the number of buckets FJ needs.", "hint": "In this example, FJ needs $4$ buckets. He uses buckets $1$ and $2$ to milk cow $3$ (starting at time $2$). He uses bucket $3$ to milk cow $1$ (starting at time $4$). When cow $2$ starts milking at time $8$, buckets $1$ and $2$ can be reused, but bucket $3$ cannot, so he will use buckets $1$, $2$, and $4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] The Bucket List B", "background": "", "description": "Farmer John 正在考虑改变他给奶牛挤奶的时候分配牛奶桶的方式。他认为这最终能使得他使用数量更少的桶，然而他不清楚具体是多少。请帮助他！\n\nFarmer John 有 $N$ 头奶牛（$1\\le N\\le 100$），方便起见编号为 $1\\dots N$。 第 $i$ 头奶牛需要从时间 $s_i$ 到时间 $t_i$ 之间挤奶，并且挤奶过程中需要用到 $b_i$ 个桶。于是多头奶牛可能在同一时刻都在挤奶；如果这样，他们不能使用相同的桶。也就是说，一个在第 $i$ 头奶牛挤奶时用的桶不可以被任何在时间 $s_i$ 到时间 $t_i$ 之间挤奶的其他奶牛使用。当然，这个桶在这段时间之外可以被其他奶牛所使用。为了简化他的工作，FJ 保证在任一时刻，至多只有一头奶牛开始或是结束挤奶（也就是说，所有的 $s_i$ 和 $t_i$ 各不相同）。\n\nFJ 有一个储藏室，里面有依次编号为 $1$、$2$、$3$、……的桶。在他的挤奶策略中，当某一头奶牛（比如说，奶牛 $i$）开始挤奶（在时间 $s_i$），FJ 就跑到储藏室取出编号最小的 $b_i$ 个桶分配给第i头奶牛用来挤奶。\n\n请求出 FJ 需要在储藏室中存放多少个桶才能使得他能够顺利地给所有奶牛挤奶。\n", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行，每行描述了一头奶牛，包含三个空格分隔的数 $s_i$，$t_i$，和 $b_i$。 其中 $s_i$ 和 $t_i$ 均为 $1\\dots 1000$ 之间的整数，$b_i$ 为 $1\\dots 10$ 之间的整数。", "outputFormat": "输出一个整数，为 FJ 需要的桶的数量。", "hint": "在这个例子中，FJ 需要 $4$ 个桶：他用桶 $1$ 和桶 $2$ 来给奶牛 $3$ 挤奶（从时间 $2$ 开始）。他用桶 $3$ 给奶牛 $1$ 挤奶（从时间 $4$ 开始）。当奶牛 $2$ 在时间 $8$ 开始挤奶时，桶 $1$ 和桶 $2$ 可以再次利用，然而桶 $3$ 不可以，所以他会使用桶 $1$、桶 $2$ 和桶 $4$。", "locale": "zh-CN"}}}
{"pid": "P5118", "type": "P", "difficulty": 3, "samples": [["1 1 1 1 1 1 1 1 1 2\n5 5 5 5 5 5 5 5 5 5", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "搜索", "2018", "USACO", "枚举"], "title": "[USACO18DEC] Back and Forth B", "background": "", "description": "Farmer John 有两个挤奶棚，每个挤奶棚里各有一个奶罐和一个装有 $10$ 个各种尺寸的桶的储物柜。他喜欢将在两个挤奶棚之间来回运送牛奶作为一种锻炼方式。\n\n周一，Farmer John 量了恰好 $1000$ 加仑的牛奶放在第一个挤奶棚的奶罐里，又量了恰好 $1000$ 加仑的牛奶放在第二个挤奶棚的奶罐里。\n\n周二，他从第一个挤奶棚里取出一个桶，并装满牛奶，然后将牛奶运到第二个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第二个挤奶棚。\n\n周三，他从第二个挤奶棚里取出一个桶（可能是周二留在这里的），并装满牛奶，然后将牛奶运到第一个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第一个挤奶棚。\n\n周四，他从第一个挤奶棚里取出一个桶（可能是周三留在这里的），并装满牛奶，然后将牛奶运到第二个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第二个挤奶棚。\n\n周五，他从第二个挤奶棚里取出一个桶（可能是周二或周四留在这里的），并装满牛奶，然后将牛奶运到第一个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第一个挤奶棚。\n\n此时 Farmer John 测量了第一个挤奶棚的奶罐里的牛奶。他总共可能得到多少种不同的读数？\n", "inputFormat": "输入的第一行包含 $10$ 个整数，为第一个挤奶棚里初始的桶的容积。输入的第二行也包含 $10$ 个整数，为第二个挤奶棚里初始的桶的容积。 所有桶的容积均在 $1\\dots 100$ 的范围内。", "outputFormat": "输出 Farmer John 在周五之后测量第一个挤奶棚里的奶罐的牛奶时可能得到的读数的数量。", "hint": "在这个例子中，最后第一个挤奶棚的奶罐中的牛奶量总共有 $5$ 种可能的结果：\n\n$1000$：FJ 可以在每次往返的时候都携带同一个桶，从而不会改变第一个挤奶棚的奶罐的牛奶量。\n\n$1003$：FJ 可以在周二运送 $2$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $1$ 个单位。\n\n$1004$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $1$ 个单位。\n\n$1007$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $2$ 个单位，周五 $5$ 个单位。\n\n$1008$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $5$ 个单位。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Back and Forth B", "background": "", "description": "Farmer John has two milking barns. In each barn, there is a milk tank and a storage cabinet holding $10$ buckets of various sizes. He likes to carry milk back and forth between the two barns as a form of exercise.\n\nOn Monday, Farmer John measured exactly $1000$ gallons of milk into the tank in the first barn, and also measured exactly $1000$ gallons of milk into the tank in the second barn.\n\nOn Tuesday, he takes one bucket from the first barn, fills it with milk, then carries the milk to the second barn and pours it into the tank. He leaves this bucket in the second barn.\n\nOn Wednesday, he takes one bucket from the second barn (possibly the one left there on Tuesday), fills it with milk, then carries the milk to the first barn and pours it into the tank. He leaves this bucket in the first barn.\n\nOn Thursday, he takes one bucket from the first barn (possibly the one left there on Wednesday), fills it with milk, then carries the milk to the second barn and pours it into the tank. He leaves this bucket in the second barn.\n\nOn Friday, he takes one bucket from the second barn (possibly the one left there on Tuesday or Thursday), fills it with milk, then carries the milk to the first barn and pours it into the tank. He leaves this bucket in the first barn.\n\nAt this point, Farmer John measures the milk in the tank in the first barn. How many different readings could he possibly get in total?", "inputFormat": "The first line contains $10$ integers, the capacities of the buckets initially in the first barn. The second line also contains $10$ integers, the capacities of the buckets initially in the second barn. All bucket capacities are in the range $1\\dots 100$.", "outputFormat": "Output the number of possible readings Farmer John could get when measuring the milk in the tank in the first barn after Friday.", "hint": "In this example, there are $5$ possible final amounts of milk in the first barn's tank:\n\n$1000$: FJ can carry the same bucket on every trip, so the amount of milk in the first barn's tank does not change.\n\n$1003$: FJ can move $2$ units on Tuesday, $5$ units on Wednesday, $1$ unit on Thursday, and $1$ unit on Friday.\n\n$1004$: FJ can move $1$ unit on Tuesday, $5$ units on Wednesday, $1$ unit on Thursday, and $1$ unit on Friday.\n\n$1007$: FJ can move $1$ unit on Tuesday, $5$ units on Wednesday, $2$ units on Thursday, and $5$ units on Friday.\n\n$1008$: FJ can move $1$ unit on Tuesday, $5$ units on Wednesday, $1$ unit on Thursday, and $5$ units on Friday.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Back and Forth B", "background": "", "description": "Farmer John 有两个挤奶棚，每个挤奶棚里各有一个奶罐和一个装有 $10$ 个各种尺寸的桶的储物柜。他喜欢将在两个挤奶棚之间来回运送牛奶作为一种锻炼方式。\n\n周一，Farmer John 量了恰好 $1000$ 加仑的牛奶放在第一个挤奶棚的奶罐里，又量了恰好 $1000$ 加仑的牛奶放在第二个挤奶棚的奶罐里。\n\n周二，他从第一个挤奶棚里取出一个桶，并装满牛奶，然后将牛奶运到第二个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第二个挤奶棚。\n\n周三，他从第二个挤奶棚里取出一个桶（可能是周二留在这里的），并装满牛奶，然后将牛奶运到第一个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第一个挤奶棚。\n\n周四，他从第一个挤奶棚里取出一个桶（可能是周三留在这里的），并装满牛奶，然后将牛奶运到第二个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第二个挤奶棚。\n\n周五，他从第二个挤奶棚里取出一个桶（可能是周二或周四留在这里的），并装满牛奶，然后将牛奶运到第一个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第一个挤奶棚。\n\n此时 Farmer John 测量了第一个挤奶棚的奶罐里的牛奶。他总共可能得到多少种不同的读数？\n", "inputFormat": "输入的第一行包含 $10$ 个整数，为第一个挤奶棚里初始的桶的容积。输入的第二行也包含 $10$ 个整数，为第二个挤奶棚里初始的桶的容积。 所有桶的容积均在 $1\\dots 100$ 的范围内。", "outputFormat": "输出 Farmer John 在周五之后测量第一个挤奶棚里的奶罐的牛奶时可能得到的读数的数量。", "hint": "在这个例子中，最后第一个挤奶棚的奶罐中的牛奶量总共有 $5$ 种可能的结果：\n\n$1000$：FJ 可以在每次往返的时候都携带同一个桶，从而不会改变第一个挤奶棚的奶罐的牛奶量。\n\n$1003$：FJ 可以在周二运送 $2$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $1$ 个单位。\n\n$1004$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $1$ 个单位。\n\n$1007$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $2$ 个单位，周五 $5$ 个单位。\n\n$1008$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $5$ 个单位。", "locale": "zh-CN"}}}
{"pid": "P5119", "type": "P", "difficulty": 3, "samples": [["6 3 2\n1 1 10 14 4 3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "二分", "USACO"], "title": "[USACO18DEC] Convention S", "background": "", "description": "一场别开生面的牛吃草大会就要在 Farmer John 的农场举办了！\n\n世界各地的奶牛将会到达当地的机场，前来参会并且吃草。具体地说，有 $N$ 头奶牛到达了机场（$1\\le N\\le 10^5$），其中奶牛 $i$ 在时间 $t_i$（$0\\le t_i\\le 10^9$）到达。Farmer John 安排了 $M$（$1\\le M\\le 10^5$）辆大巴来机场接这些奶牛。每辆大巴可以乘坐 $C$ 头奶牛（$1\\le C\\le N$）。Farmer John 正在机场等待奶牛们到来，并且准备安排到达的奶牛们乘坐大巴。当最后一头乘坐某辆大巴的奶牛到达的时候，这辆大巴就可以发车了。Farmer John 想要做一个优秀的主办者，所以并不想让奶牛们在机场等待过长的时间。如果 Farmer John 合理地协调这些大巴，等待时间最长的奶牛等待的时间的最小值是多少？一头奶牛的等待时间等于她的到达时间与她乘坐的大巴的发车时间之差。\n\n输入保证 $MC\\ge N$。", "inputFormat": "输入的第一行包含三个空格分隔的整数 $N$，$M$，和 $C$。第二行包含 $N$ 个空格分隔的整数，表示每头奶牛到达的时间。", "outputFormat": "输出一行，包含所有到达的奶牛中的最大等待时间的最小值。", "hint": "如果两头时间 $1$ 到达的奶牛乘坐一辆巴士，时间 $3$ 和时间 $4$ 到达的奶牛乘坐乘坐第二辆，时间 $10$ 和时间 $14$ 到达的奶牛乘坐第三辆，那么等待时间最长的奶牛等待了 $4$ 个单位时间（时间 $10$ 到达的奶牛从时间 $10$ 等到了时间 $14$）。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Convention S", "background": "", "description": "A unique cow grass-eating convention is about to be held at Farmer John’s farm.\n\nCows from all over the world will arrive at the local airport to attend the convention and eat grass. Specifically, there are $N$ cows arriving at the airport ($1\\le N\\le 10^5$), and cow $i$ arrives at time $t_i$ ($0\\le t_i\\le 10^9$). Farmer John has arranged $M$ buses ($1\\le M\\le 10^5$) to pick up these cows at the airport. Each bus can carry $C$ cows ($1\\le C\\le N$). Farmer John is waiting at the airport and plans to assign arriving cows to buses. When the last cow assigned to a bus arrives, that bus can depart. Farmer John wants to be a good host, so he does not want the cows to wait at the airport for too long. If Farmer John schedules the buses optimally, what is the minimum possible value of the maximum waiting time among all cows? A cow’s waiting time is the difference between her arrival time and the departure time of the bus she takes.\n\nThe input guarantees that $MC\\ge N$.", "inputFormat": "The first line contains three space-separated integers $N$, $M$, and $C$. The second line contains $N$ space-separated integers, representing the arrival time of each cow.", "outputFormat": "Output one line containing the minimum possible value of the maximum waiting time among all arriving cows.", "hint": "If two cows arriving at time $1$ take the first bus, the cows arriving at times $3$ and $4$ take the second bus, and the cows arriving at times $10$ and $14$ take the third bus, then the cow with the longest waiting time waits for $4$ units of time (the cow arriving at time $10$ waits from time $10$ until time $14$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Convention S", "background": "", "description": "一场别开生面的牛吃草大会就要在 Farmer John 的农场举办了！\n\n世界各地的奶牛将会到达当地的机场，前来参会并且吃草。具体地说，有 $N$ 头奶牛到达了机场（$1\\le N\\le 10^5$），其中奶牛 $i$ 在时间 $t_i$（$0\\le t_i\\le 10^9$）到达。Farmer John 安排了 $M$（$1\\le M\\le 10^5$）辆大巴来机场接这些奶牛。每辆大巴可以乘坐 $C$ 头奶牛（$1\\le C\\le N$）。Farmer John 正在机场等待奶牛们到来，并且准备安排到达的奶牛们乘坐大巴。当最后一头乘坐某辆大巴的奶牛到达的时候，这辆大巴就可以发车了。Farmer John 想要做一个优秀的主办者，所以并不想让奶牛们在机场等待过长的时间。如果 Farmer John 合理地协调这些大巴，等待时间最长的奶牛等待的时间的最小值是多少？一头奶牛的等待时间等于她的到达时间与她乘坐的大巴的发车时间之差。\n\n输入保证 $MC\\ge N$。", "inputFormat": "输入的第一行包含三个空格分隔的整数 $N$，$M$，和 $C$。第二行包含 $N$ 个空格分隔的整数，表示每头奶牛到达的时间。", "outputFormat": "输出一行，包含所有到达的奶牛中的最大等待时间的最小值。", "hint": "如果两头时间 $1$ 到达的奶牛乘坐一辆巴士，时间 $3$ 和时间 $4$ 到达的奶牛乘坐乘坐第二辆，时间 $10$ 和时间 $14$ 到达的奶牛乘坐第三辆，那么等待时间最长的奶牛等待了 $4$ 个单位时间（时间 $10$ 到达的奶牛从时间 $10$ 等到了时间 $14$）。", "locale": "zh-CN"}}}
{"pid": "P5120", "type": "P", "difficulty": 3, "samples": [["5\n25 3\n105 30\n20 50\n10 17\n100 10", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2018", "USACO", "堆"], "title": "[USACO18DEC] Convention II S", "background": null, "description": "虽然在接机上耽误了挺长时间，Farmer John 为吃草爱好牛们举行的大会至今为止都非常顺利。大会吸引了世界各地的奶牛。\n\n然而大会的重头戏看起来却给 Farmer John 带来了一些新的安排上的困扰。他的农场上的一块非常小的牧草地出产一种据某些识货的奶牛说是世界上最美味的品种的草。因此，所有参会的 $N$ 头奶牛（$1\\le N\\le 10^5$）都想要品尝一下这种草。由于这块牧草地小到仅能容纳一头奶牛，这很有可能会导致排起长龙。\n\nFarmer John 知道每头奶牛 $i$ 计划到达这块特殊的牧草地的时间 $a_i$，以及当轮到她时，她计划品尝这种草花费的时间 $t_i$。当奶牛 $i$ 开始吃草时，她会在离开前花费全部 $t_i$ 的时间，此时其他到达的奶牛需要排队等候。如果这块牧草地空出来的时候多头奶牛同时在等候，那么资历最深的奶牛将会是下一头品尝鲜草的奶牛。在这里，恰好在另一头奶牛吃完草离开时到达的奶牛被认为是“在等待的”。类似地，如果当没有奶牛在吃草的时候有多头奶牛同时到达，那么资历最深的奶牛是下一头吃草的奶牛。\n\n请帮助 FJ 计算所有奶牛中在队伍里等待的时间（$a_i$ 到这头奶牛开始吃草之间的时间）的最大值。", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行按资历顺序给出了 $N$ 头奶牛的信息（资历最深的奶牛排在最前面）。每行包含一头奶牛的 $a_i$ 和 $t_i$。所有的 $t_i$ 为不超过 $10^4$ 的正整数，所有 $a_i$ 为不超过 $10^9$ 的正整数。", "outputFormat": "输出所有奶牛中的最长等待时间。", "hint": "在这个例子中，我们有 $5$ 头奶牛（按输入中的顺序编号为 $1\\dots 5$）。奶牛 $4$ 最先到达（时间 $10$），在她吃完之前（时间 $27$）奶牛 $1$ 和奶牛 $3$ 都到达了。由于奶牛 $1$ 拥有较深的资历，所以她先吃，从她到达开始共计等待了 $2$ 个单位时间。她在时间 $30$ 结束吃草，随后奶牛 $3$ 开始吃草，从她到达开始共计等待了 $10$ 单位时间。在一段没有奶牛吃草的时间过后，奶牛 $5$ 到达，在她正在吃草的时间里奶牛 $2$ 也到达了，在 $5$ 个单位时间之后能够吃到草。相比到达时间等待最久的奶牛是奶牛 $3$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Convention II S", "background": "", "description": "Although Farmer John was delayed for quite a long time picking up arrivals at the airport, the convention he is holding for his grass-loving cows has been going very smoothly so far. The convention has attracted cows from all over the world.\n\nHowever, the highlight of the convention now seems to have caused Farmer John some new scheduling trouble. A very small pasture on his farm produces a type of grass that, according to some knowledgeable cows, is the most delicious in the world. Therefore, all $N$ cows ($1\\le N\\le 10^5$) attending the convention want to taste this grass. Since the pasture is so small that it can only hold one cow, this may cause a long line.\n\nFarmer John knows the time $a_i$ when each cow $i$ plans to arrive at this special pasture, and the amount of time $t_i$ she plans to spend tasting the grass when it is her turn. When cow $i$ starts eating, she will spend the full $t_i$ time before leaving, and any other cows that have arrived must wait in line. If multiple cows are waiting when the pasture becomes free, then the most senior cow will be the next to taste the fresh grass. Here, a cow that arrives exactly when another cow finishes eating and leaves is considered to be \"waiting.\" Similarly, if multiple cows arrive at the same time when no cow is eating, then the most senior cow is the next one to eat.\n\nPlease help FJ compute the maximum waiting time among all cows (the time from $a_i$ until that cow starts eating).", "inputFormat": "The first line of input contains $N$. The next $N$ lines give the information of the $N$ cows in order of seniority (the most senior cow is listed first). Each line contains $a_i$ and $t_i$ for one cow. All $t_i$ are positive integers not exceeding $10^4$, and all $a_i$ are positive integers not exceeding $10^9$.", "outputFormat": "Output the longest waiting time among all cows.", "hint": "In this example, we have $5$ cows (numbered $1\\dots 5$ in the order of the input). Cow $4$ arrives first (at time $10$). Before she finishes eating (at time $27$), cows $1$ and $3$ both arrive. Since cow $1$ is more senior, she eats first, and she waits a total of $2$ time units from her arrival. She finishes eating at time $30$, then cow $3$ starts eating, and she waits a total of $10$ time units from her arrival. After a period when no cow is eating, cow $5$ arrives. While she is eating, cow $2$ also arrives, and can eat after $5$ time units. The cow that waits the longest is cow $3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Convention II S", "background": null, "description": "虽然在接机上耽误了挺长时间，Farmer John 为吃草爱好牛们举行的大会至今为止都非常顺利。大会吸引了世界各地的奶牛。\n\n然而大会的重头戏看起来却给 Farmer John 带来了一些新的安排上的困扰。他的农场上的一块非常小的牧草地出产一种据某些识货的奶牛说是世界上最美味的品种的草。因此，所有参会的 $N$ 头奶牛（$1\\le N\\le 10^5$）都想要品尝一下这种草。由于这块牧草地小到仅能容纳一头奶牛，这很有可能会导致排起长龙。\n\nFarmer John 知道每头奶牛 $i$ 计划到达这块特殊的牧草地的时间 $a_i$，以及当轮到她时，她计划品尝这种草花费的时间 $t_i$。当奶牛 $i$ 开始吃草时，她会在离开前花费全部 $t_i$ 的时间，此时其他到达的奶牛需要排队等候。如果这块牧草地空出来的时候多头奶牛同时在等候，那么资历最深的奶牛将会是下一头品尝鲜草的奶牛。在这里，恰好在另一头奶牛吃完草离开时到达的奶牛被认为是“在等待的”。类似地，如果当没有奶牛在吃草的时候有多头奶牛同时到达，那么资历最深的奶牛是下一头吃草的奶牛。\n\n请帮助 FJ 计算所有奶牛中在队伍里等待的时间（$a_i$ 到这头奶牛开始吃草之间的时间）的最大值。", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行按资历顺序给出了 $N$ 头奶牛的信息（资历最深的奶牛排在最前面）。每行包含一头奶牛的 $a_i$ 和 $t_i$。所有的 $t_i$ 为不超过 $10^4$ 的正整数，所有 $a_i$ 为不超过 $10^9$ 的正整数。", "outputFormat": "输出所有奶牛中的最长等待时间。", "hint": "在这个例子中，我们有 $5$ 头奶牛（按输入中的顺序编号为 $1\\dots 5$）。奶牛 $4$ 最先到达（时间 $10$），在她吃完之前（时间 $27$）奶牛 $1$ 和奶牛 $3$ 都到达了。由于奶牛 $1$ 拥有较深的资历，所以她先吃，从她到达开始共计等待了 $2$ 个单位时间。她在时间 $30$ 结束吃草，随后奶牛 $3$ 开始吃草，从她到达开始共计等待了 $10$ 单位时间。在一段没有奶牛吃草的时间过后，奶牛 $5$ 到达，在她正在吃草的时间里奶牛 $2$ 也到达了，在 $5$ 个单位时间之后能够吃到草。相比到达时间等待最久的奶牛是奶牛 $3$。", "locale": "zh-CN"}}}
{"pid": "P5121", "type": "P", "difficulty": 4, "samples": [["6 3\n0000000000\n0000000300\n0054000300\n1054502230\n2211122220\n1111111223", "0000000000\n0000000000\n0000000000\n0000000000\n1054000000\n2254500000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "搜索", "2018", "USACO"], "title": "[USACO18DEC] Mooyo Mooyo S", "background": "", "description": "由于手上（更确实的，蹄子上）有大把的空余时间，Farmer John 的农场里的奶牛经常玩电子游戏消磨时光。她们最爱的游戏之一是基于一款流行的电子游戏 Puyo Puyo 的奶牛版；名称当然叫做 Mooyo Mooyo。\n\nMooyo Mooyo 是在一块又高又窄的棋盘上进行的游戏，高 $N$（$1\\le N\\le 100$）格，宽 $10$ 格。 这是一个 $N=6$ 的棋盘的例子：\n\n```\n0000000000\n0000000300\n0054000300\n1054502230\n2211122220\n1111111223\n```\n\n每个格子或者是空的（用 $0$ 表示），或者是九种颜色之一的干草捆（用字符 $1\\dots 9$ 表示）。重力会使得干草捆下落，所以没有干草捆的下方是 $0$。\n\n如果两个格子水平或垂直方向直接相邻，并且为同一种非 $0$ 颜色，那么这两个格子就属于同一个连通区域。任意时刻出现至少 $K$ 个格子构成的连通区域，其中的干草捆就会全部消失，变为 $0$。如果同时出现多个这样的连通区域，它们同时消失。随后，重力可能会导致干草捆向下落入某个变为 $0$ 的格子。由此形成的新的布局中，又可能出现至少 $K$ 个格子构成的连通区域。若如此，它们同样也会消失（如果又有多个这样的区域，则同时消失），然后重力又会使得剩下的方块下落，这一过程持续进行，直到不存在大小至少为 $K$ 的连通区域为止。\n\n给定一块 Mooyo Mooyo 棋盘的状态，输出这些过程发生之后最终的棋盘的图案。\n\n", "inputFormat": "输入的第一行包含 $N$ 和 $K$（$1\\le K\\le 10N$）。以下 $N$ 行给出了棋盘的初始状态。", "outputFormat": "输出 $N$ 行，描述最终的棋盘状态。", "hint": "在上面的例子中，如果 $K=3$，那么存在一个大小至少为 $K$ 的颜色 $1$ 的连通区域，同样有一个颜色 $2$ 的连通区域。当它们同时被移除之后，棋盘暂时成为了这样：\n\n```\n0000000000\n0000000300\n0054000300\n1054500030\n2200000000\n0000000003\n```\n\n然后，由于重力效果，干草捆下落形成这样的布局：\n\n```\n0000000000\n0000000000\n0000000000\n0000000000\n1054000300\n2254500333\n```\n\n再一次地，出现了一个大小至少为 $K$ 地连通区域（颜色 $3$）。移除这个区域就得到了最终的棋盘布局：\n\n```\n0000000000\n0000000000\n0000000000\n0000000000\n1054000000\n2254500000\n```", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Mooyo Mooyo S", "background": "", "description": "Because they have lots of free time on their hands (or more accurately, on their hooves), the cows on Farmer John’s farm often play video games to pass the time. One of their favorite games is a cow-themed version of the popular game Puyo Puyo, naturally called Mooyo Mooyo.\n\nMooyo Mooyo is played on a tall, narrow board with height $N$ ($1\\le N\\le 100$) and width $10$. Here is an example board with $N=6$:\n\n```\n0000000000\n0000000300\n0054000300\n1054502230\n2211122220\n1111111223\n```\n\nEach cell is either empty (represented by $0$) or a hay bale of one of nine colors (represented by characters $1\\dots 9$). Gravity causes hay bales to fall, so there will be no hay bale with a $0$ directly below it.\n\nIf two cells are directly adjacent horizontally or vertically and have the same non-$0$ color, then they belong to the same connected component. Whenever a connected component of size at least $K$ appears, all hay bales in that component disappear and become $0$. If multiple such components exist at the same time, they disappear simultaneously. Then gravity may cause hay bales to fall downward into cells that became $0$. In the new layout, there may again be connected components of size at least $K$. If so, they also disappear (simultaneously if there are multiple), and gravity makes the remaining blocks fall again. This process continues until there is no connected component of size at least $K$.\n\nGiven a Mooyo Mooyo board state, output the final board pattern after all these processes occur.", "inputFormat": "The first line of input contains $N$ and $K$ ($1\\le K\\le 10N$). The next $N$ lines give the initial state of the board.", "outputFormat": "Output $N$ lines describing the final state of the board.", "hint": "In the example above, if $K=3$, then there is a connected component of color $1$ with size at least $K$, and also a connected component of color $2$. After they are removed simultaneously, the board temporarily becomes:\n\n```\n0000000000\n0000000300\n0054000300\n1054500030\n2200000000\n0000000003\n```\n\nThen, due to gravity, the hay bales fall and form this layout:\n\n```\n0000000000\n0000000000\n0000000000\n0000000000\n1054000300\n2254500333\n```\n\nOnce again, a connected component of size at least $K$ appears (color $3$). Removing this component gives the final board layout:\n\n```\n0000000000\n0000000000\n0000000000\n0000000000\n1054000000\n2254500000\n```\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Mooyo Mooyo S", "background": "", "description": "由于手上（更确实的，蹄子上）有大把的空余时间，Farmer John 的农场里的奶牛经常玩电子游戏消磨时光。她们最爱的游戏之一是基于一款流行的电子游戏 Puyo Puyo 的奶牛版；名称当然叫做 Mooyo Mooyo。\n\nMooyo Mooyo 是在一块又高又窄的棋盘上进行的游戏，高 $N$（$1\\le N\\le 100$）格，宽 $10$ 格。 这是一个 $N=6$ 的棋盘的例子：\n\n```\n0000000000\n0000000300\n0054000300\n1054502230\n2211122220\n1111111223\n```\n\n每个格子或者是空的（用 $0$ 表示），或者是九种颜色之一的干草捆（用字符 $1\\dots 9$ 表示）。重力会使得干草捆下落，所以没有干草捆的下方是 $0$。\n\n如果两个格子水平或垂直方向直接相邻，并且为同一种非 $0$ 颜色，那么这两个格子就属于同一个连通区域。任意时刻出现至少 $K$ 个格子构成的连通区域，其中的干草捆就会全部消失，变为 $0$。如果同时出现多个这样的连通区域，它们同时消失。随后，重力可能会导致干草捆向下落入某个变为 $0$ 的格子。由此形成的新的布局中，又可能出现至少 $K$ 个格子构成的连通区域。若如此，它们同样也会消失（如果又有多个这样的区域，则同时消失），然后重力又会使得剩下的方块下落，这一过程持续进行，直到不存在大小至少为 $K$ 的连通区域为止。\n\n给定一块 Mooyo Mooyo 棋盘的状态，输出这些过程发生之后最终的棋盘的图案。\n\n", "inputFormat": "输入的第一行包含 $N$ 和 $K$（$1\\le K\\le 10N$）。以下 $N$ 行给出了棋盘的初始状态。", "outputFormat": "输出 $N$ 行，描述最终的棋盘状态。", "hint": "在上面的例子中，如果 $K=3$，那么存在一个大小至少为 $K$ 的颜色 $1$ 的连通区域，同样有一个颜色 $2$ 的连通区域。当它们同时被移除之后，棋盘暂时成为了这样：\n\n```\n0000000000\n0000000300\n0054000300\n1054500030\n2200000000\n0000000003\n```\n\n然后，由于重力效果，干草捆下落形成这样的布局：\n\n```\n0000000000\n0000000000\n0000000000\n0000000000\n1054000300\n2254500333\n```\n\n再一次地，出现了一个大小至少为 $K$ 地连通区域（颜色 $3$）。移除这个区域就得到了最终的棋盘布局：\n\n```\n0000000000\n0000000000\n0000000000\n0000000000\n1054000000\n2254500000\n```", "locale": "zh-CN"}}}
{"pid": "P5122", "type": "P", "difficulty": 5, "samples": [["4 5 1\n1 4 10\n2 1 20\n4 2 3\n2 3 5\n4 3 2\n2 7", "1\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "USACO", "最短路"], "title": "[USACO18DEC] Fine Dining G", "background": null, "description": "漫长的一天结束了，饥困交加的奶牛们准备返回牛棚。\n\n农场由 $N$ 片牧场组成（$2\\le N\\le 5\\times 10^4$），方便起见编号为 $1\\dots N$。所有奶牛都要前往位于牧场 $N$ 的牛棚。其他 $N-1$ 片牧场中每片有一头奶牛。奶牛们可以通过 $M$ 条无向的小路在牧场之间移动（$1\\le M\\le 10^5$）。第i条小路连接牧场 $a_i$ 和 $b_i$，通过需要时间 $t_i$。每头奶牛都可以经过一些小路回到牛棚。\n\n由于饥饿，奶牛们很乐于在他们回家的路上停留一段时间觅食。农场里有 $K$ 个有美味的干草捆（$1 \\le K \\le N$），第 $i$ 个干草捆的美味值为 $y_i$。每头奶牛都想要在她回牛棚的路上在某一个干草捆处停留，但是她这样做仅当经过这个干草捆使她回牛棚的时间增加不超过这个干草捆的美味值。注意一头奶牛仅仅“正式地”在一个干草捆处因进食而停留，即使她的路径上经过其他放有干草捆的牧场；她会简单地无视其他的干草捆。", "inputFormat": "输入的第一行包含三个空格分隔的整数 $N$，$M$ 和 $K$。以下 $M$ 行每行包含三个整数 $a_i$，$b_i$ 和 $t_i$，表示牧场 $a_i$ 和 $b_i$ 之间有一条需要 $t_i$ 时间通过的小路（$a_i$ 不等于 $b_i$，$t_i$ 为不超过 $10^4$ 的正整数）。\n\n以下 $K$ 行，每行以两个整数描述了一个干草捆：该干草捆所在牧场的编号，以及它的美味值（一个不超过 $10^9$ 的正整数）。同一片牧场中可能会有多个干草捆。", "outputFormat": "输出包含 $N-1$ 行。如果牧场 $i$ 里的奶牛可以在回牛棚的路上前往某一个干草捆并且在此进食，则第 $i$ 行为一个整数 $1$，否则为一个整数 $0$。", "hint": "在这个例子中，牧场 $3$ 里的奶牛可以停留进食，因为她回去的时间仅会增加 $6$（从 $2$ 增加到 $8$），而这个增加量并没有超过干草捆的美味值 $7$。牧场 $2$ 里的奶牛显然可以吃掉牧场 $2$ 里的干草，因为这并不会导致她的最佳路径发生变化。对于牧场 $1$ 里的奶牛是一个有趣的情况，因为看起来她的最佳路径（$10$）可能会因为前去进食而有过大的增加量。然而，确实存在一条路径使得她可以前去干草捆处停留：先到牧场 $4$，然后去牧场 $2$（吃草），然后回到牧场 $4$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Fine Dining G", "background": "", "description": "After a long day, the hungry and tired cows are ready to return to the barn.\n\nThe farm has $N$ pastures ($2\\le N\\le 5\\times 10^4$), numbered $1\\dots N$ for convenience. All cows want to go to the barn located at pasture $N$. Each of the other $N-1$ pastures has one cow. The cows can move between pastures using $M$ undirected paths ($1\\le M\\le 10^5$). The $i$-th path connects pastures $a_i$ and $b_i$, and it takes time $t_i$ to travel along it. Each cow can take some sequence of paths to get back to the barn.\n\nBecause they are hungry, the cows are happy to stop and eat along the way home. There are $K$ pastures with tasty hay bales ($1 \\le K \\le N$). The $i$-th hay bale has tastiness value $y_i$. Each cow wants to stop at exactly one hay bale on her way to the barn, but she will do so only if going through that hay bale increases her travel time to the barn by no more than the hay bale’s tastiness value. Note that a cow only “officially” stops to eat at one hay bale, even if her path passes through other pastures that also have hay bales; she will simply ignore the other hay bales.", "inputFormat": "The first line contains three space-separated integers $N$, $M$, and $K$. The next $M$ lines each contain three integers $a_i$, $b_i$, and $t_i$, describing a path between pastures $a_i$ and $b_i$ that takes time $t_i$ to traverse ($a_i$ is not equal to $b_i$, and $t_i$ is a positive integer not exceeding $10^4$).\n\nThe next $K$ lines each describe a hay bale with two integers: the index of the pasture where the hay bale is located, and its tastiness value (a positive integer not exceeding $10^9$). There may be multiple hay bales in the same pasture.", "outputFormat": "Output $N-1$ lines. If the cow in pasture $i$ can visit some hay bale and eat there on her way back to the barn, output an integer $1$ on line $i$; otherwise output an integer $0$.", "hint": "In this example, the cow in pasture $3$ can stop to eat, because her time to get back increases by only $6$ (from $2$ to $8$), and this increase does not exceed the hay bale’s tastiness value $7$. The cow in pasture $2$ can clearly eat the hay in pasture $2$, since this does not cause her best path to change. The cow in pasture $1$ is an interesting case, because it looks like her best path ($10$) might increase too much if she goes to eat. However, there is indeed a path that lets her stop at a hay bale: first go to pasture $4$, then go to pasture $2$ (eat hay), and then return to pasture $4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Fine Dining G", "background": null, "description": "漫长的一天结束了，饥困交加的奶牛们准备返回牛棚。\n\n农场由 $N$ 片牧场组成（$2\\le N\\le 5\\times 10^4$），方便起见编号为 $1\\dots N$。所有奶牛都要前往位于牧场 $N$ 的牛棚。其他 $N-1$ 片牧场中每片有一头奶牛。奶牛们可以通过 $M$ 条无向的小路在牧场之间移动（$1\\le M\\le 10^5$）。第i条小路连接牧场 $a_i$ 和 $b_i$，通过需要时间 $t_i$。每头奶牛都可以经过一些小路回到牛棚。\n\n由于饥饿，奶牛们很乐于在他们回家的路上停留一段时间觅食。农场里有 $K$ 个有美味的干草捆（$1 \\le K \\le N$），第 $i$ 个干草捆的美味值为 $y_i$。每头奶牛都想要在她回牛棚的路上在某一个干草捆处停留，但是她这样做仅当经过这个干草捆使她回牛棚的时间增加不超过这个干草捆的美味值。注意一头奶牛仅仅“正式地”在一个干草捆处因进食而停留，即使她的路径上经过其他放有干草捆的牧场；她会简单地无视其他的干草捆。", "inputFormat": "输入的第一行包含三个空格分隔的整数 $N$，$M$ 和 $K$。以下 $M$ 行每行包含三个整数 $a_i$，$b_i$ 和 $t_i$，表示牧场 $a_i$ 和 $b_i$ 之间有一条需要 $t_i$ 时间通过的小路（$a_i$ 不等于 $b_i$，$t_i$ 为不超过 $10^4$ 的正整数）。\n\n以下 $K$ 行，每行以两个整数描述了一个干草捆：该干草捆所在牧场的编号，以及它的美味值（一个不超过 $10^9$ 的正整数）。同一片牧场中可能会有多个干草捆。", "outputFormat": "输出包含 $N-1$ 行。如果牧场 $i$ 里的奶牛可以在回牛棚的路上前往某一个干草捆并且在此进食，则第 $i$ 行为一个整数 $1$，否则为一个整数 $0$。", "hint": "在这个例子中，牧场 $3$ 里的奶牛可以停留进食，因为她回去的时间仅会增加 $6$（从 $2$ 增加到 $8$），而这个增加量并没有超过干草捆的美味值 $7$。牧场 $2$ 里的奶牛显然可以吃掉牧场 $2$ 里的干草，因为这并不会导致她的最佳路径发生变化。对于牧场 $1$ 里的奶牛是一个有趣的情况，因为看起来她的最佳路径（$10$）可能会因为前去进食而有过大的增加量。然而，确实存在一条路径使得她可以前去干草捆处停留：先到牧场 $4$，然后去牧场 $2$（吃草），然后回到牧场 $4$。", "locale": "zh-CN"}}}
{"pid": "P5123", "type": "P", "difficulty": 4, "samples": [["4\n1 2 3 4 5\n1 2 3 10 8\n10 9 8 7 6\n50 60 70 80 90", "4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2018", "USACO", "容斥原理"], "title": "[USACO18DEC] Cowpatibility G", "background": "2025/4/9 加入两组 hack 数据（@Starrykiller）。", "description": "研究证明，有一个因素在两头奶牛能否作为朋友和谐共处这方面比其他任何因素都来得重要——她们是不是喜欢同一种口味的冰激凌！\n\nFarmer John 的 $N$ 头奶牛（$2\\le N\\le 5\\times 10^4$）各自列举了她们最喜欢的五种冰激凌口味的清单。为使这个清单更加精炼，每种可能的口味用一个不超过 $10^6$ 的正整数 $\\texttt{ID}$ 表示。如果两头奶牛的清单上有至少一种共同的冰激凌口味，那么她们可以和谐共处。\n\n请求出不能和谐共处的奶牛的对数。", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行每行包含 $5$ 个整数（各不相同），表示一头奶牛最喜欢的冰激凌口味。", "outputFormat": "输出不能和谐共处的奶牛的对数。", "hint": "在这里，奶牛 $4$ 不能和奶牛 $1$、$2$、$3$ 中的任一头和谐共处，奶牛 $1$ 和奶牛 $3$ 也不能和谐共处。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Cowpatibility G", "background": "On 2025/4/9, two groups of hack testdata were added (@Starrykiller).", "description": "Research shows that one factor matters more than anything else in whether two cows can get along as friends—whether they like the same ice cream flavor.\n\nFarmer John has $N$ cows ($2 \\le N \\le 5 \\times 10^4$). Each cow lists her five favorite ice cream flavors. To make the list more concise, each possible flavor is represented by a positive integer $\\texttt{ID}$ not exceeding $10^6$. If two cows' lists share at least one common ice cream flavor, then they can get along.\n\nPlease compute the number of pairs of cows that cannot get along.", "inputFormat": "The first line contains $N$. The next $N$ lines each contain $5$ integers (all distinct), representing one cow’s favorite ice cream flavors.", "outputFormat": "Output the number of pairs of cows that cannot get along.", "hint": "Here, cow $4$ cannot get along with any of cows $1$, $2$, or $3$, and cow $1$ and cow $3$ also cannot get along.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Cowpatibility G", "background": "2025/4/9 加入两组 hack 数据（@Starrykiller）。", "description": "研究证明，有一个因素在两头奶牛能否作为朋友和谐共处这方面比其他任何因素都来得重要——她们是不是喜欢同一种口味的冰激凌！\n\nFarmer John 的 $N$ 头奶牛（$2\\le N\\le 5\\times 10^4$）各自列举了她们最喜欢的五种冰激凌口味的清单。为使这个清单更加精炼，每种可能的口味用一个不超过 $10^6$ 的正整数 $\\texttt{ID}$ 表示。如果两头奶牛的清单上有至少一种共同的冰激凌口味，那么她们可以和谐共处。\n\n请求出不能和谐共处的奶牛的对数。", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行每行包含 $5$ 个整数（各不相同），表示一头奶牛最喜欢的冰激凌口味。", "outputFormat": "输出不能和谐共处的奶牛的对数。", "hint": "在这里，奶牛 $4$ 不能和奶牛 $1$、$2$、$3$ 中的任一头和谐共处，奶牛 $1$ 和奶牛 $3$ 也不能和谐共处。", "locale": "zh-CN"}}}
{"pid": "P5124", "type": "P", "difficulty": 4, "samples": [["7 3\n1\n15\n7\n9\n2\n5\n10", "84"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2018", "USACO", "线性 DP"], "title": "[USACO18DEC] Teamwork G", "background": "", "description": "在 Farmer John 最喜欢的节日里，他想要给他的朋友们赠送一些礼物。由于他并不擅长包装礼物，他想要获得他的奶牛们的帮助。你可能能够想到，奶牛们本身也不是很擅长包装礼物，而 Farmer John 即将得到这一教训。\n\nFarmer John 的 $N$ 头奶牛（$1\\le N\\le 10^4$）排成一行，方便起见依次编号为 $1\\dots N$。奶牛 $i$ 的包装礼物的技能水平为 $s_i$。她们的技能水平可能参差不齐，所以 FJ 决定把她的奶牛们分成小组。每一组可以包含任意不超过 $K$ 头的连续的奶牛（$1\\le K\\le 10^3$），并且一头奶牛不能属于多于一个小组。由于奶牛们会互相学习，这一组中每一头奶牛的技能水平会变成这一组中水平最高的奶牛的技能水平。\n\n请帮助 FJ 求出，在他合理地安排分组的情况下，可以达到的技能水平之和的最大值。", "inputFormat": "输入的第一行包含 $N$ 和 $K$。以下 $N$ 行按照 $N$ 头奶牛的排列顺序依次给出她们的技能水平。技能水平是一个不超过 $10^5$ 的正整数。", "outputFormat": "输出 FJ 通过将连续的奶牛进行分组可以达到的最大技能水平和。", "hint": "在这个例子中，最优的方案是将前三头奶牛和后三头奶牛分别分为一组，中间的奶牛单独成为一组（注意一组的奶牛数量可以小于 $K$）。这样能够有效地将 $7$ 头奶牛的技能水平提高至 $15$、$15$、$15$、$9$、$10$、$10$、$10$，和为 $84$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Teamwork G", "background": "", "description": "On Farmer John’s favorite holiday, he wants to give some gifts to his friends. Since he is not very good at wrapping gifts, he wants help from his cows. As you might guess, cows are also not very good at wrapping gifts, and Farmer John is about to learn this lesson.\n\nFarmer John has $N$ cows ($1\\le N\\le 10^4$) standing in a line, numbered $1\\dots N$ for convenience. Cow $i$ has a gift-wrapping skill level of $s_i$. Their skill levels may vary a lot, so FJ decides to divide his cows into groups. Each group can contain any number of consecutive cows, as long as it has at most $K$ cows ($1\\le K\\le 10^3$), and no cow can belong to more than one group. Since the cows learn from each other, every cow in a group will have her skill level changed to the highest skill level within that group.\n\nHelp FJ find the maximum possible total sum of skill levels, if he groups the cows in the best way.", "inputFormat": "The first line contains $N$ and $K$. The next $N$ lines give the cows’ skill levels in order. Each skill level is a positive integer not exceeding $10^5$.", "outputFormat": "Output the maximum total sum of skill levels that FJ can achieve by grouping consecutive cows.", "hint": "In this example, the best plan is to put the first three cows into one group and the last three cows into another group, with the middle cow alone as a group (note that a group can have fewer than $K$ cows). This effectively increases the 7 cows’ skill levels to $15$, $15$, $15$, $9$, $10$, $10$, $10$, for a total of $84$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Teamwork G", "background": "", "description": "在 Farmer John 最喜欢的节日里，他想要给他的朋友们赠送一些礼物。由于他并不擅长包装礼物，他想要获得他的奶牛们的帮助。你可能能够想到，奶牛们本身也不是很擅长包装礼物，而 Farmer John 即将得到这一教训。\n\nFarmer John 的 $N$ 头奶牛（$1\\le N\\le 10^4$）排成一行，方便起见依次编号为 $1\\dots N$。奶牛 $i$ 的包装礼物的技能水平为 $s_i$。她们的技能水平可能参差不齐，所以 FJ 决定把她的奶牛们分成小组。每一组可以包含任意不超过 $K$ 头的连续的奶牛（$1\\le K\\le 10^3$），并且一头奶牛不能属于多于一个小组。由于奶牛们会互相学习，这一组中每一头奶牛的技能水平会变成这一组中水平最高的奶牛的技能水平。\n\n请帮助 FJ 求出，在他合理地安排分组的情况下，可以达到的技能水平之和的最大值。", "inputFormat": "输入的第一行包含 $N$ 和 $K$。以下 $N$ 行按照 $N$ 头奶牛的排列顺序依次给出她们的技能水平。技能水平是一个不超过 $10^5$ 的正整数。", "outputFormat": "输出 FJ 通过将连续的奶牛进行分组可以达到的最大技能水平和。", "hint": "在这个例子中，最优的方案是将前三头奶牛和后三头奶牛分别分为一组，中间的奶牛单独成为一组（注意一组的奶牛数量可以小于 $K$）。这样能够有效地将 $7$ 头奶牛的技能水平提高至 $15$、$15$、$15$、$9$、$10$、$10$、$10$，和为 $84$。", "locale": "zh-CN"}}}
{"pid": "P5125", "type": "P", "difficulty": 5, "samples": [["5 6\n3 3\n2 3\n2 5\n3 5\n0 4\n6 4", "0\n1\n1\n1\n7\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "不认识", "background": "又是一年军训时，今年的军训有点不一样。小 L 和小 K 所在的班的同学来自五湖四海（才怪），原来互相都不认识。", "description": "小 K 和小 L 的教官将同学们按随机顺序排成一列。教官发现所有同学互相之间竟然都不认识（小 L 和小 K 失忆了），于是教官决定让同学们互相认识一下。每次教官会令编号在闭区间 $[l,r]$ 的所有同学两两互相认识。如果其中的一对同学在之前的操作中已经认识，那么他们不会再次认识。请问，在每次教官的操作（命令）之前，在教官指定的这个区间内有多少对同学是不认识的？\n\n每对同学可以表示为 $(u,v)[u<v]$。两对同学 $(u_1,v_1)$ 和 $(u_2,v_2)$ 不同当且仅当 $u_1\\neq u_2~or~v_1\\neq v_2$。", "inputFormat": "输入第一行为一个整数 $n$ 和 $q$，$n$ 表示小 L 和小 K 所在的班的学生数，$q$ 表示教官的操作数；\n\n之后的 $q$ 行，每行两个整数 $l'$ 和 $r'$，表示这次操作使得闭区间 $[l',r']$ 的所有同学两两互相认识。\n\n本题输入加密。输入的第三行至最后一行，输入的数字都按位异或（$\\oplus$）了 $lastans$，也就是上一个询问的输出。对于输入的第二行，你可以认为 $lastans=0$。对于每个操作，你需要将 $l',r'$ 通过某种方式解密得到真正的，即未加密过的 $l,r$。", "outputFormat": "输出共 $q$ 行。每行对应输入中的一次操作，输出这次操作的答案。", "hint": "样例解释：  \n这是解密后的输入：\n```\n5 6\n3 3\n2 3\n3 4\n2 4\n1 5\n1 3\n```\n\n$Subtask\\#1:~20pts~,~1\\le n,q \\le 100$；\n\n$Subtask\\#2:~30pts~,~1\\le n,q\\le 5000$；\n\n$Subtask\\#3:~50pts~,~1\\le n,q \\le 10^6,1\\le l,r \\le n$\n\n保证解密后的每对 $l,r$ 均满足 $l\\le r$。", "locale": "zh-CN", "translations": {"en": {"title": "Unfamiliar.", "background": "It is military training season again this year, and this year’s training is a bit different. The classmates in the class of Xiao L and Xiao K come from all over the country (not really), and it turns out that none of them knew each other before.", "description": "The instructor of Xiao K and Xiao L arranges the students into a line in a random order. The instructor finds that all students do not know each other (Xiao L and Xiao K lost their memories), so the instructor decides to let the students get to know each other.\n\nEach time, the instructor will make all students whose indices are in the closed interval $[l,r]$ know each other pairwise. If a pair of students already knew each other from previous operations, they will not get to know each other again.\n\nFor each instructor operation (command), before performing this operation, how many pairs of students in the specified interval do not know each other?\n\nEach pair of students can be represented as $(u,v)[u<v]$. Two pairs $(u_1,v_1)$ and $(u_2,v_2)$ are different if and only if $u_1\\neq u_2~or~v_1\\neq v_2$.", "inputFormat": "The first line contains two integers $n$ and $q$. $n$ is the number of students in the class of Xiao L and Xiao K, and $q$ is the number of instructor operations.\n\nIn the following $q$ lines, each line contains two integers $l'$ and $r'$, meaning that this operation makes all students in the closed interval $[l',r']$ know each other pairwise.\n\nThe input of this problem is encrypted. From the third line to the last line, all input numbers are XORed bitwise ($\\oplus$) with $lastans$, i.e., the output of the previous query. For the second line of input, you may assume $lastans=0$. For each operation, you need to decrypt $l',r'$ in some way to obtain the real (unencrypted) $l,r$.", "outputFormat": "Output $q$ lines in total. Each line corresponds to an operation in the input, and you should output the answer for that operation.", "hint": "Sample explanation:  \nThis is the decrypted input:\n```\n5 6\n3 3\n2 3\n3 4\n2 4\n1 5\n1 3\n```\n\n$Subtask\\#1:~20pts~,~1\\le n,q \\le 100$.\n\n$Subtask\\#2:~30pts~,~1\\le n,q\\le 5000$.\n\n$Subtask\\#3:~50pts~,~1\\le n,q \\le 10^6,1\\le l,r \\le n$.\n\nIt is guaranteed that after decryption, every pair $l,r$ satisfies $l\\le r$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "不认识", "background": "又是一年军训时，今年的军训有点不一样。小 L 和小 K 所在的班的同学来自五湖四海（才怪），原来互相都不认识。", "description": "小 K 和小 L 的教官将同学们按随机顺序排成一列。教官发现所有同学互相之间竟然都不认识（小 L 和小 K 失忆了），于是教官决定让同学们互相认识一下。每次教官会令编号在闭区间 $[l,r]$ 的所有同学两两互相认识。如果其中的一对同学在之前的操作中已经认识，那么他们不会再次认识。请问，在每次教官的操作（命令）之前，在教官指定的这个区间内有多少对同学是不认识的？\n\n每对同学可以表示为 $(u,v)[u<v]$。两对同学 $(u_1,v_1)$ 和 $(u_2,v_2)$ 不同当且仅当 $u_1\\neq u_2~or~v_1\\neq v_2$。", "inputFormat": "输入第一行为一个整数 $n$ 和 $q$，$n$ 表示小 L 和小 K 所在的班的学生数，$q$ 表示教官的操作数；\n\n之后的 $q$ 行，每行两个整数 $l'$ 和 $r'$，表示这次操作使得闭区间 $[l',r']$ 的所有同学两两互相认识。\n\n本题输入加密。输入的第三行至最后一行，输入的数字都按位异或（$\\oplus$）了 $lastans$，也就是上一个询问的输出。对于输入的第二行，你可以认为 $lastans=0$。对于每个操作，你需要将 $l',r'$ 通过某种方式解密得到真正的，即未加密过的 $l,r$。", "outputFormat": "输出共 $q$ 行。每行对应输入中的一次操作，输出这次操作的答案。", "hint": "样例解释：  \n这是解密后的输入：\n```\n5 6\n3 3\n2 3\n3 4\n2 4\n1 5\n1 3\n```\n\n$Subtask\\#1:~20pts~,~1\\le n,q \\le 100$；\n\n$Subtask\\#2:~30pts~,~1\\le n,q\\le 5000$；\n\n$Subtask\\#3:~50pts~,~1\\le n,q \\le 10^6,1\\le l,r \\le n$\n\n保证解密后的每对 $l,r$ 均满足 $l\\le r$。", "locale": "zh-CN"}}}
{"pid": "P5126", "type": "P", "difficulty": 7, "samples": [["4 1 3", "276"], ["3 2 3", "36"]], "limits": {"time": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "洛谷原创"], "title": "鬼故事", "background": "### _给大家讲个鬼故事_\n有一天晚上，下着大暴雨。小 K 正在他那小小的书房里做着老师给他布置的、数也数不完的信息题目。关着门，关着窗难免有些闷热。小 K 起身，将书桌前的窗子打开一个小小的细缝，小到没有雨点能透过缝隙飘进来。\n\n今天正是农历七月十五日，中元节，俗称鬼节。小 K 从来都没有在这种日子这么晚睡过，因为小 K 迷信，害怕午夜之后，便有鬼怪出没。然而今天，小 K 无可奈何。\n\n小 K 看了看时间：$23:54$。看到 $4$，小 K 皱了皱眉眉头。$4$，谐音是“死”，特别不吉利。在这种日子看到这样的字眼，往往都是不祥之兆。\n\n小 K 的眼皮在打架。他从来都不会做毒瘤题。他索性趴到了书桌上面，两只眼睛渐渐朦胧了起来。\n\n“那儿有一个本子。”他想着。不知道何时，他的书桌靠窗的一角上，静静地躺着一个湿漉漉的本子，好像是刚刚淋过雨。“它是怎么进来的？”小 K 喃喃道。他下意识地翻开那本本子，看到里面有写了一些字。不知道为什么，那些字在发黄的纸页上看起来也那么红。\n\n左边的那一页写着：\n\n $$4^{4-4}\\le M\\le N\\le 4^{4^{(4+4-\\frac{4}{4})}},\\sqrt{4}\\le K\\le 4^{\\sqrt{4}}\\times(4-\\frac{4}{4})+\\sqrt{4}$$\n\n右边的那一页写着的似乎比左边的要长：\n\n $$a_{\\frac{4}{4}}=a_{\\sqrt{4}}=\\frac{4}{4},a_n=\\frac{\\sqrt{4}}{\\sqrt{4}}\\times a_{n-\\frac{4}{4}}+4^{4-4}\\times a_{n-\\sqrt{4}}(n\\ge \\sqrt{4}+\\frac{4}{4})$$  \n  \n$$b_n=\\prod^{n+K-\\frac{4}{4}}_{i=n}a_i$$   \n\n求 $\\sum\\limits_{i=m}^n b_i$\n\n角落里还有一行小字：**_ 不要翻到最后一页，不然会有可怕的事情发生 _**。但是在这个时候，小 K 早已经闭上了双眼，鼾声和远处的雷声混成一片。\n\n一阵微风吹来，轻轻地，谁也没有意识到。本子的一角被风扬起，滑过一个优美的弧线，落在了本子的另一边。风一阵一阵的吹来，拂过本子发黄的书页。渐渐地，右边的书页少了，左边的书页多了。风停了，本子的倒数第二页停在半空中。在一刹那，似乎一切都静止了。然后，它轻轻地落在了其它书页的最上面。\n\n最后一页上，赫然用鲜红色的歪歪扭扭的大字写着：\n\n# 这道题你已经拖了一个月了！限明天之前做完！\n\n这时候，你夜观天象，预测到了小 K 的这场劫难。时间已是 $23:59:59:400$，如果在这 $1000-400=600$ 毫秒内没有做完，小 K 的检讨将在劫难逃。身为小 K 的好朋友，你能帮他解决这个问题吗？\n", "description": "给定 $k,m,n$，求：  \n\n$$\\sum_{i=m}^n \\prod_{j=i}^{i+k-1} a_j$$\n\n答案对 $10^9 + 7$ 取模。   \n其中 $\\{ a\\}$ 为 fibonacci 数列。", "inputFormat": "三个正整数，分别表示 $k,m,n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "$a_1=1,a_2=1,a_3=2,a_4=3,a_5=5,a_6=8$。\n\n对于样例1：\n\n$$K=4$$\n$$b_1=1\\times1\\times2\\times3=6,b_2=1\\times2\\times3\\times5=30,b_3=2\\times3\\times5\\times8=240$$\n$$\\sum_{i=1}^{3}b_i=276$$\n\n对于样例2：\n\n$$K=3$$\n$$b_2=1\\times2\\times3=6,b_3=2\\times3\\times5=30$$\n$$\\sum_{i=2}^{3}b_i=36$$\n\n本题共有 $20$ 个数据点，每个数据点的分数均为 $5$ 分，总分为 $100$ 分。每个数据点的性质如下：\n\n(**出题人不想再用 $4$ 表示任何数了！**~~真香~~)\n\n| 编号 | $K,M,N$范围 | 特殊性质 |\n| :-----------: | :-----------: | :-----------: |\n|  $1$ |$1\\le m\\le n\\le 10^6,k=4$|无 |\n|  $2$ |$1\\le m\\le n\\le 10^{18},k=4$  | $n-m\\le 10^6$ |\n|  $3\\sim 4$ | $1\\le m\\le n\\le 10^{18},k=4$  |无|\n| $5\\sim 6$  |  $1\\le m\\le n\\le 4^{4^4},k=4$  | $n-m\\le 10^6$ |\n|  $7\\sim 10$ | $1\\le m\\le n\\le 4^{4^7},k=4$ | 无 |\n|  $11\\sim 12$ | $1\\le m\\le n\\le 4^{6000},2\\le k\\le 10$| 无 |\n|  $13\\sim 14$ | $1\\le m\\le n\\le 10^{41},2\\le k\\le 10$| 无 |\n| $15\\sim 20$  |$1\\le m\\le n\\le 10^{41},2\\le k\\le 50$| 无 |\n\n**（注意，题面中的数据范围只是大致描述，请以以上具体范围为准）**\n\n$a^{b^c}=a^{(b^c)}$", "locale": "zh-CN", "translations": {"en": {"title": "Ghost Story", "background": "### _Let me tell you a ghost story_\nOne night, a heavy rainstorm was pouring down. Little K was doing the endless informatics problems assigned by his teacher in his tiny study. With the door and windows closed, it inevitably felt a bit hot and stuffy. Little K stood up and opened the window beside his desk by a tiny crack, so small that no raindrops could drift in through it.\n\nToday happened to be the 15th day of the 7th lunar month, the Zhongyuan Festival, also known as the Ghost Festival. Little K had never stayed up so late on such a day, because Little K was superstitious and afraid that after midnight, ghosts and monsters would appear. However, today, Little K had no choice.\n\nLittle K looked at the time: $23:54$. Seeing the $4$, Little K frowned. $4$ sounds like “death” in Chinese, which is especially unlucky. Seeing such a number on a day like this is often a bad omen.\n\nLittle K’s eyelids were fighting. He never did “toxic” problems. He simply lay down on the desk, and his eyes gradually became blurry.\n\n“There is a notebook over there,” he thought. At some point, on the corner of his desk near the window, a soaked notebook lay quietly, as if it had just been rained on. “How did it get in?” Little K murmured. Subconsciously, he flipped it open and saw that some words were written inside. For some reason, those words looked so red on the yellowing paper.\n\nThe page on the left said:\n\n $$4^{4-4}\\le M\\le N\\le 4^{4^{(4+4-\\frac{4}{4})}},\\sqrt{4}\\le K\\le 4^{\\sqrt{4}}\\times(4-\\frac{4}{4})+\\sqrt{4}$$\n\nThe page on the right seemed longer than the left:\n\n $$a_{\\frac{4}{4}}=a_{\\sqrt{4}}=\\frac{4}{4},a_n=\\frac{\\sqrt{4}}{\\sqrt{4}}\\times a_{n-\\frac{4}{4}}+4^{4-4}\\times a_{n-\\sqrt{4}}(n\\ge \\sqrt{4}+\\frac{4}{4})$$  \n  \n$$b_n=\\prod^{n+K-\\frac{4}{4}}_{i=n}a_i$$   \n\nFind $\\sum\\limits_{i=m}^n b_i$.\n\nIn the corner there was also a line of small text: **_Do not flip to the last page, or something terrifying will happen_**. But at this moment, Little K had already closed his eyes, and his snoring blended together with the distant thunder.\n\nA breeze came, softly, and no one noticed. One corner of the notebook was lifted by the wind, slid through a graceful arc, and fell onto the other side of the notebook. The wind blew in gusts, brushing over the notebook’s yellowed pages. Gradually, there were fewer pages on the right and more pages on the left. The wind stopped, and the second-to-last page hung in midair. In an instant, it seemed that everything froze. Then, it gently fell on top of the other pages.\n\nOn the last page, in bright red crooked large letters, it read:\n\n# You have been procrastinating on this problem for a whole month! Finish it before tomorrow!\n\nAt this time, by observing the sky, you predicted Little K’s coming disaster. The time was already $23:59:59:400$. If it was not finished within these $1000-400=600$ milliseconds, Little K’s self-criticism (jiǎntǎo) would be unavoidable. As Little K’s good friend, can you help him solve this problem?", "description": "Given $k,m,n$, find:\n\n$$\\sum_{i=m}^n \\prod_{j=i}^{i+k-1} a_j$$\n\nTake the answer modulo $10^9 + 7$.  \nHere $\\{ a\\}$ is the Fibonacci sequence.", "inputFormat": "Three positive integers, representing $k,m,n$ respectively.", "outputFormat": "Output one line with one integer, representing the answer.", "hint": "$a_1=1,a_2=1,a_3=2,a_4=3,a_5=5,a_6=8$.\n\nFor Sample 1:\n\n$$K=4$$\n$$b_1=1\\times1\\times2\\times3=6,b_2=1\\times2\\times3\\times5=30,b_3=2\\times3\\times5\\times8=240$$\n$$\\sum_{i=1}^{3}b_i=276$$\n\nFor Sample 2:\n\n$$K=3$$\n$$b_2=1\\times2\\times3=6,b_3=2\\times3\\times5=30$$\n$$\\sum_{i=2}^{3}b_i=36$$\n\nThis problem has $20$ test points. Each test point is worth $5$ points, for a total of $100$ points. The properties of each test point are as follows:\n\n(**The problem setter does not want to use $4$ to represent any number anymore!** ~~so true~~)\n\n| ID | Constraints on $K,M,N$ | Special Property |\n| :-----------: | :-----------: | :-----------: |\n|  $1$ |$1\\le m\\le n\\le 10^6,k=4$| None |\n|  $2$ |$1\\le m\\le n\\le 10^{18},k=4$  | $n-m\\le 10^6$ |\n|  $3\\sim 4$ | $1\\le m\\le n\\le 10^{18},k=4$  | None |\n| $5\\sim 6$  |  $1\\le m\\le n\\le 4^{4^4},k=4$  | $n-m\\le 10^6$ |\n|  $7\\sim 10$ | $1\\le m\\le n\\le 4^{4^7},k=4$ | None |\n|  $11\\sim 12$ | $1\\le m\\le n\\le 4^{6000},2\\le k\\le 10$| None |\n|  $13\\sim 14$ | $1\\le m\\le n\\le 10^{41},2\\le k\\le 10$| None |\n| $15\\sim 20$  |$1\\le m\\le n\\le 10^{41},2\\le k\\le 50$| None |\n\n**(Note: the Constraints described in the statement are only approximate. Please refer to the specific ranges above.)**\n\n$a^{b^c}=a^{(b^c)}$\n\n# Input Format\n\nThree positive integers, representing $k,m,n$ respectively.\n\n# Output Format\n\nOutput one line with one integer, representing the answer.\n\n# Hint\n\n$a_1=1,a_2=1,a_3=2,a_4=3,a_5=5,a_6=8$。\n\nFor Sample 1:\n\n$$K=4$$\n$$b_1=1\\times1\\times2\\times3=6,b_2=1\\times2\\times3\\times5=30,b_3=2\\times3\\times5\\times8=240$$\n$$\\sum_{i=1}^{3}b_i=276$$\n\nFor Sample 2:\n\n$$K=3$$\n$$b_2=1\\times2\\times3=6,b_3=2\\times3\\times5=30$$\n$$\\sum_{i=2}^{3}b_i=36$$\n\nThis problem has $20$ test points. Each test point is worth $5$ points, for a total of $100$ points. The properties of each test point are as follows:\n\n(**The problem setter does not want to use $4$ to represent any number anymore!** ~~so true~~)\n\n| ID | Constraints on $K,M,N$ | Special Property |\n| :-----------: | :-----------: | :-----------: |\n|  $1$ |$1\\le m\\le n\\le 10^6,k=4$| None |\n|  $2$ |$1\\le m\\le n\\le 10^{18},k=4$  | $n-m\\le 10^6$ |\n|  $3\\sim 4$ | $1\\le m\\le n\\le 10^{18},k=4$  | None |\n| $5\\sim 6$  |  $1\\le m\\le n\\le 4^{4^4},k=4$  | $n-m\\le 10^6$ |\n|  $7\\sim 10$ | $1\\le m\\le n\\le 4^{4^7},k=4$ | None |\n|  $11\\sim 12$ | $1\\le m\\le n\\le 4^{6000},2\\le k\\le 10$| None |\n|  $13\\sim 14$ | $1\\le m\\le n\\le 10^{41},2\\le k\\le 10$| None |\n| $15\\sim 20$  |$1\\le m\\le n\\le 10^{41},2\\le k\\le 50$| None |\n\n**(Note: the Constraints described in the statement are only approximate. Please refer to the specific ranges above.)**\n\n$a^{b^c}=a^{(b^c)}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "鬼故事", "background": "### _给大家讲个鬼故事_\n有一天晚上，下着大暴雨。小 K 正在他那小小的书房里做着老师给他布置的、数也数不完的信息题目。关着门，关着窗难免有些闷热。小 K 起身，将书桌前的窗子打开一个小小的细缝，小到没有雨点能透过缝隙飘进来。\n\n今天正是农历七月十五日，中元节，俗称鬼节。小 K 从来都没有在这种日子这么晚睡过，因为小 K 迷信，害怕午夜之后，便有鬼怪出没。然而今天，小 K 无可奈何。\n\n小 K 看了看时间：$23:54$。看到 $4$，小 K 皱了皱眉眉头。$4$，谐音是“死”，特别不吉利。在这种日子看到这样的字眼，往往都是不祥之兆。\n\n小 K 的眼皮在打架。他从来都不会做毒瘤题。他索性趴到了书桌上面，两只眼睛渐渐朦胧了起来。\n\n“那儿有一个本子。”他想着。不知道何时，他的书桌靠窗的一角上，静静地躺着一个湿漉漉的本子，好像是刚刚淋过雨。“它是怎么进来的？”小 K 喃喃道。他下意识地翻开那本本子，看到里面有写了一些字。不知道为什么，那些字在发黄的纸页上看起来也那么红。\n\n左边的那一页写着：\n\n $$4^{4-4}\\le M\\le N\\le 4^{4^{(4+4-\\frac{4}{4})}},\\sqrt{4}\\le K\\le 4^{\\sqrt{4}}\\times(4-\\frac{4}{4})+\\sqrt{4}$$\n\n右边的那一页写着的似乎比左边的要长：\n\n $$a_{\\frac{4}{4}}=a_{\\sqrt{4}}=\\frac{4}{4},a_n=\\frac{\\sqrt{4}}{\\sqrt{4}}\\times a_{n-\\frac{4}{4}}+4^{4-4}\\times a_{n-\\sqrt{4}}(n\\ge \\sqrt{4}+\\frac{4}{4})$$  \n  \n$$b_n=\\prod^{n+K-\\frac{4}{4}}_{i=n}a_i$$   \n\n求 $\\sum\\limits_{i=m}^n b_i$\n\n角落里还有一行小字：**_ 不要翻到最后一页，不然会有可怕的事情发生 _**。但是在这个时候，小 K 早已经闭上了双眼，鼾声和远处的雷声混成一片。\n\n一阵微风吹来，轻轻地，谁也没有意识到。本子的一角被风扬起，滑过一个优美的弧线，落在了本子的另一边。风一阵一阵的吹来，拂过本子发黄的书页。渐渐地，右边的书页少了，左边的书页多了。风停了，本子的倒数第二页停在半空中。在一刹那，似乎一切都静止了。然后，它轻轻地落在了其它书页的最上面。\n\n最后一页上，赫然用鲜红色的歪歪扭扭的大字写着：\n\n# 这道题你已经拖了一个月了！限明天之前做完！\n\n这时候，你夜观天象，预测到了小 K 的这场劫难。时间已是 $23:59:59:400$，如果在这 $1000-400=600$ 毫秒内没有做完，小 K 的检讨将在劫难逃。身为小 K 的好朋友，你能帮他解决这个问题吗？\n", "description": "给定 $k,m,n$，求：  \n\n$$\\sum_{i=m}^n \\prod_{j=i}^{i+k-1} a_j$$\n\n答案对 $10^9 + 7$ 取模。   \n其中 $\\{ a\\}$ 为 fibonacci 数列。", "inputFormat": "三个正整数，分别表示 $k,m,n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "$a_1=1,a_2=1,a_3=2,a_4=3,a_5=5,a_6=8$。\n\n对于样例1：\n\n$$K=4$$\n$$b_1=1\\times1\\times2\\times3=6,b_2=1\\times2\\times3\\times5=30,b_3=2\\times3\\times5\\times8=240$$\n$$\\sum_{i=1}^{3}b_i=276$$\n\n对于样例2：\n\n$$K=3$$\n$$b_2=1\\times2\\times3=6,b_3=2\\times3\\times5=30$$\n$$\\sum_{i=2}^{3}b_i=36$$\n\n本题共有 $20$ 个数据点，每个数据点的分数均为 $5$ 分，总分为 $100$ 分。每个数据点的性质如下：\n\n(**出题人不想再用 $4$ 表示任何数了！**~~真香~~)\n\n| 编号 | $K,M,N$范围 | 特殊性质 |\n| :-----------: | :-----------: | :-----------: |\n|  $1$ |$1\\le m\\le n\\le 10^6,k=4$|无 |\n|  $2$ |$1\\le m\\le n\\le 10^{18},k=4$  | $n-m\\le 10^6$ |\n|  $3\\sim 4$ | $1\\le m\\le n\\le 10^{18},k=4$  |无|\n| $5\\sim 6$  |  $1\\le m\\le n\\le 4^{4^4},k=4$  | $n-m\\le 10^6$ |\n|  $7\\sim 10$ | $1\\le m\\le n\\le 4^{4^7},k=4$ | 无 |\n|  $11\\sim 12$ | $1\\le m\\le n\\le 4^{6000},2\\le k\\le 10$| 无 |\n|  $13\\sim 14$ | $1\\le m\\le n\\le 10^{41},2\\le k\\le 10$| 无 |\n| $15\\sim 20$  |$1\\le m\\le n\\le 10^{41},2\\le k\\le 50$| 无 |\n\n**（注意，题面中的数据范围只是大致描述，请以以上具体范围为准）**\n\n$a^{b^c}=a^{(b^c)}$", "locale": "zh-CN"}}}
{"pid": "P5127", "type": "P", "difficulty": 6, "samples": [["3 4\n1 2\n1 3\n1 1 1\n1 1 1\n2 1 3 1\n2 3 3 1\n1 1 3", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "子异和", "background": "", "description": "小L和小K正在激烈地讨论着。\n\n（你不用知道谁说的哪句话……）\n\n“你知道非空子集吗？”\n\n“当然知道啊！比如说集合$\\{1,2,3\\}$，它的所有非空子集就是$\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{2,3\\},\\{1,3\\},\\{1,2,3\\}$。”\n\n“那你知道每个非空子集里的数的亦或和是多少吗？”\n\n“也知道啊，不就是$1,2,3,1⊕2=3,2⊕3=1,1⊕3=2,1⊕2⊕3=0$吗。”\n\n“那你知道它们的和是多少吗？我们把它叫做子异和。”\n\n“子异和……这个名字好奇怪啊，不过我知道，是$1+2+3+3+1+2+0=12$。”\n\n“那我问你，$\\{a_1,a_2,...,a_n\\}$的子异和是多少？”\n\n“慢慢暴力算呗！”\n\n“如果$n\\le 200000$呢？”\n\n“……”\n\n“如果把问题放在一颗树上呢？”\n\n“……那你会不会做啊？”\n\n“当然……不会做……”\n\n现在，只有你能帮助小L和小K了，请你帮忙解决这个问题。\n\n**为了更清晰的表达题意，我们再做一次解释。**\n\n有一个$n$个节点的树，总共有$m$次操作。这些操作按照操作顺序输入。每次操作可能是询问或修改。\n\n每次询问操作会给出两个节点编号$a,b$。根据常识，$a,b$在树上有唯一路径。我们设这条路径经过的所有点的点权集合为$S$。你要输出$S$的子异和。答案$mod\\space(10^9+7)$。\n\n每次修改操作会给出两个节点编号$a,b$与一个整数值$c$。你要将节点$a$到节点$b$的唯一路径上的所有点的点权分别异或$c$。\n\n**这里的集合指可重集合**", "inputFormat": "第一行三个正整数$n,m$。\n\n接下来$n-1$行，每行两个正整数$a,b$，表示节点$a$和$b$之间有一条边。不会出现重边与自环。\n\n接下来一行$n$个非负整数，第$i$个非负整数表示$i$节点的初始点权。\n\n接下来$m$行，每行若干个整数，表示$m$个操作的信息。每行第一个整数只可能是$1$或$2$。如果是$1$，则此操作为询问，接下来两个数为$a,b$；如果是$2$，则此操作为修改，接下来三个数为$a,b,c$。", "outputFormat": "对于每一个询问，输出一行表示答案。", "hint": "样例解释：\n\n第一次询问，$1$到$1$的路径经过$1$号节点，点权组成的集合为$\\{1\\}$，子异和为$1$。\n\n两次修改后，$1$号点点权为$0$，$3$号点点权为$1$。\n\n第二次询问，$1$到$3$的路径经过的点权集合为$\\{0,1\\}$，子异和为$0+1+1=2$。\n\n本题共有$10$个测试点，每个测试点$10$分，总分为$100$分。\n\n| 测试点编号 | $n$的范围 | $m$的范围 | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1-2$ | $1\\le n\\le 1000$ | $1\\le m\\le 1000$ | 无 |\n| $3-5$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | 每条边连接的两个节点编号均相邻 |\n| $6-10$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | 无 |\n\n对于$100\\%$的数据：\n\n输入的数均为不大于$10^9+7$的非负整数，$1\\le a,b\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "Subset XOR Sum.", "background": "", "description": "Xiao L and Xiao K are having a heated discussion.\n\n(You do not need to know who said which line...)\n\n“Do you know non-empty subsets?”\n\n“Of course! For example, for the set $\\{1,2,3\\}$, all of its non-empty subsets are $\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{2,3\\},\\{1,3\\},\\{1,2,3\\}$.”\n\n“Then do you know the XOR sum of the numbers in each non-empty subset?”\n\n“I do! It is just $1,2,3,1⊕2=3,2⊕3=1,1⊕3=2,1⊕2⊕3=0$.”\n\n“Then do you know what their total sum is? We call it the subset XOR sum.”\n\n“Subset XOR sum... what a strange name, but I know it is $1+2+3+3+1+2+0=12$.”\n\n“Then let me ask you, what is the subset XOR sum of $\\{a_1,a_2,...,a_n\\}$?”\n\n“Just brute force it slowly!”\n\n“What if $n\\le 200000$?”\n\n“...”\n\n“What if we put the problem on a tree?”\n\n“... Can you solve it then?”\n\n“Of course... I cannot...”\n\nNow only you can help Xiao L and Xiao K. Please solve this problem.\n\n**To express the statement more clearly, we explain it again.**\n\nThere is a tree with $n$ nodes, and there are $m$ operations in total. These operations are given in order. Each operation is either a query or a modification.\n\nEach query operation gives two node indices $a,b$. As is well known, there is a unique path between $a$ and $b$ on the tree. Let the multiset of node weights of all nodes on this path be $S$. You need to output the subset XOR sum of $S$. The answer is taken $mod\\space(10^9+7)$.\n\nEach modification operation gives two node indices $a,b$ and an integer value $c$. You need to XOR the weight of every node on the unique path from node $a$ to node $b$ by $c$.\n\n**Here, “set” means multiset.**", "inputFormat": "The first line contains three positive integers $n,m$.\n\nThe next $n-1$ lines each contain two positive integers $a,b$, meaning there is an edge between node $a$ and node $b$. There will be no multiple edges or self-loops.\n\nThe next line contains $n$ non-negative integers. The $i$-th non-negative integer is the initial weight of node $i$.\n\nThe next $m$ lines each contain several integers describing an operation. The first integer of each line is either $1$ or $2$. If it is $1$, then this operation is a query, and the next two numbers are $a,b$; if it is $2$, then this operation is a modification, and the next three numbers are $a,b,c$.", "outputFormat": "For each query, output one line containing the answer.", "hint": "Sample explanation:\n\nFor the first query, the path from $1$ to $1$ passes through node $1$, the multiset of node weights is $\\{1\\}$, and the subset XOR sum is $1$.\n\nAfter two modifications, the weight of node $1$ is $0$, and the weight of node $3$ is $1$.\n\nFor the second query, the multiset of node weights on the path from $1$ to $3$ is $\\{0,1\\}$, and the subset XOR sum is $0+1+1=2$.\n\nThis problem has $10$ test points. Each test point is worth $10$ points, for a total of $100$ points.\n\n| Test point ID | Range of $n$ | Range of $m$ | Special property |\n| :----------: | :----------: | :----------: | :----------: |\n| $1-2$ | $1\\le n\\le 1000$ | $1\\le m\\le 1000$ | None |\n| $3-5$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | The indices of the two nodes connected by each edge are adjacent |\n| $6-10$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | None |\n\nConstraints:\n\nFor $100\\%$ of the data, all input numbers are non-negative integers not greater than $10^9+7$, and $1\\le a,b\\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "子异和", "background": "", "description": "小L和小K正在激烈地讨论着。\n\n（你不用知道谁说的哪句话……）\n\n“你知道非空子集吗？”\n\n“当然知道啊！比如说集合$\\{1,2,3\\}$，它的所有非空子集就是$\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{2,3\\},\\{1,3\\},\\{1,2,3\\}$。”\n\n“那你知道每个非空子集里的数的亦或和是多少吗？”\n\n“也知道啊，不就是$1,2,3,1⊕2=3,2⊕3=1,1⊕3=2,1⊕2⊕3=0$吗。”\n\n“那你知道它们的和是多少吗？我们把它叫做子异和。”\n\n“子异和……这个名字好奇怪啊，不过我知道，是$1+2+3+3+1+2+0=12$。”\n\n“那我问你，$\\{a_1,a_2,...,a_n\\}$的子异和是多少？”\n\n“慢慢暴力算呗！”\n\n“如果$n\\le 200000$呢？”\n\n“……”\n\n“如果把问题放在一颗树上呢？”\n\n“……那你会不会做啊？”\n\n“当然……不会做……”\n\n现在，只有你能帮助小L和小K了，请你帮忙解决这个问题。\n\n**为了更清晰的表达题意，我们再做一次解释。**\n\n有一个$n$个节点的树，总共有$m$次操作。这些操作按照操作顺序输入。每次操作可能是询问或修改。\n\n每次询问操作会给出两个节点编号$a,b$。根据常识，$a,b$在树上有唯一路径。我们设这条路径经过的所有点的点权集合为$S$。你要输出$S$的子异和。答案$mod\\space(10^9+7)$。\n\n每次修改操作会给出两个节点编号$a,b$与一个整数值$c$。你要将节点$a$到节点$b$的唯一路径上的所有点的点权分别异或$c$。\n\n**这里的集合指可重集合**", "inputFormat": "第一行三个正整数$n,m$。\n\n接下来$n-1$行，每行两个正整数$a,b$，表示节点$a$和$b$之间有一条边。不会出现重边与自环。\n\n接下来一行$n$个非负整数，第$i$个非负整数表示$i$节点的初始点权。\n\n接下来$m$行，每行若干个整数，表示$m$个操作的信息。每行第一个整数只可能是$1$或$2$。如果是$1$，则此操作为询问，接下来两个数为$a,b$；如果是$2$，则此操作为修改，接下来三个数为$a,b,c$。", "outputFormat": "对于每一个询问，输出一行表示答案。", "hint": "样例解释：\n\n第一次询问，$1$到$1$的路径经过$1$号节点，点权组成的集合为$\\{1\\}$，子异和为$1$。\n\n两次修改后，$1$号点点权为$0$，$3$号点点权为$1$。\n\n第二次询问，$1$到$3$的路径经过的点权集合为$\\{0,1\\}$，子异和为$0+1+1=2$。\n\n本题共有$10$个测试点，每个测试点$10$分，总分为$100$分。\n\n| 测试点编号 | $n$的范围 | $m$的范围 | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1-2$ | $1\\le n\\le 1000$ | $1\\le m\\le 1000$ | 无 |\n| $3-5$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | 每条边连接的两个节点编号均相邻 |\n| $6-10$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | 无 |\n\n对于$100\\%$的数据：\n\n输入的数均为不大于$10^9+7$的非负整数，$1\\le a,b\\le n$。", "locale": "zh-CN"}}}
{"pid": "P5128", "type": "P", "difficulty": 5, "samples": [["5 3", "8"], ["99 10", "189"], ["377377377377 60", "139733"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "好时光", "background": "# 如果您不想在读题上消耗太多时间，请直接滑到页面最底部查看简述版题面。\n\n光阴似箭，日月如梭。时光如流水般，一刻不停地冲刷着一切。转眼间，初三已经到来了。巨量的作业，紧张的考试，无不使小L和小K准备NOIP的时间越来越少……", "description": "逃不掉的一天还是来了，小L一个人坐在教室里，看着窗外发呆。\n\n操场还没修完，天上空空荡荡的，夕阳的余晖刚刚在灰色的高楼旁涂上一抹血红，瞬间便消失了，不留下一点痕迹。飒飒的秋风从窗外吹进来，教室里响起了哗啦啦的书页被翻动的声音，书被翻到了画上了小L和小K共同的涂鸦的那一页。被揉成一团的成绩条在桌上滚来滚去，像难解的心结。天上没有一颗星星——大概是因为心头吹不散的乌云吧。\n\n小L的文化课月考考炸了，NOIP初赛也极度不理想，很可能是进不了复赛了。\n\n至于心头吹不散的乌云，就让它在那里吧，反正自己也没有机会去改变什么了。\n\n如果不是初三的紧张的节奏，大家大概不会这么轻易地分道扬镳吧？ 只见一个又一个昔日的队友离开了机房。\n\n唉，自己也大概要离开机房了吧。小L想到。\n\n这时，他想起了与小K相处的每一个好时光。\n\n从初一的军训中一个个挺拔的身影，到讲台前两个激烈讨论着的声音,省赛时颓废的场景，以及一起在机房奋斗过的日日夜夜……\n\n忆起这些好时光，他的心里暖暖的。他觉得和小K在一起的每一秒都是值得珍惜的好时光。\n\n这时，小K来到了小L的身边，知道了小L的愿望。小L想对他与小K相处的每一秒计算一个值得珍惜的价值，如果把这些价值都加起来，小L就会将这些好时光都记在心里，心情也会好起来了。\n\n小L是这样计算一个时间的价值的：他先将每一秒从 $1$ 开始顺序编号，再将时间（这个秒数）转换为时-分-秒形式。由于某种原因，小L的一分钟只有 $k$ 秒（此处应有滑稽），所以小L认为一小时也只有 $k$ 分钟。你可以认为小L将秒数转成了$k$ 进制。由于小L没有那么毒瘤，所以这里的 $k$ 都是整数。然后他观察这个 $k$ 进制数，找到其中最长的连续等差数列的长度（只考虑单个数码组成的连续的区间的情况，也就是说如 $10$ 进制下的 $123456789101112$ 不能称为等差数列） ，将其记为这一秒的价值。\n\n小K非常想帮他算出这些秒（从 $1$ 秒到 $n$ 秒）的总价值，以安慰伤心的小L。但是这个总秒数 $n$ 实在是太长太长了，以至于小K要超过一秒的时间才能算出一秒的价值，这样小L和小K在一起的时间就可以**无限延长**了。小L非常希望能这样，但是显然他们并没有这么多这么多的时间。\n\n小K找到了精通 $OI$ 的你。为了避免计算过程中秒数还在增加，你需要在 $1$ 秒钟内计算出答案。由于答案可能会很大，小L愿意接受这个数取模 $19260821$ 后的结果。", "inputFormat": "输入共一行，两个整数 $n$ 和 $k$。输入的$n$为十进制表示形式。", "outputFormat": "输出共一行，一个整数，为价值之和取模 $19260821$ 后的值。", "hint": "样例 $\\#1$ 解释：\n\n$1$到$5$转成$3$进制分别是$1,2,10,11,12$，每个数的价值恰好是它的长度，所以总价值为$1+1+2+2+2=8$。\n\n对于 $10\\%$ 的数据， $1\\le n\\le 10^6,k=60$；\n\n对于另外 $10\\%$ 的数据， $k=10$；\n\n对于 $40\\%$ 的数据， $2\\le k\\le 20,1\\le n\\le k^{10}$； \n\n对于 $100\\%$  的数据， $2\\le k\\le 60,1\\le n\\le k^{18}$ 。\n\n** 数据没有梯度！！！ **\n\n# 小L教你学数学\n\n**等差数列**：等差数列是指从第二项起，每一项与它的前一项的差等于同一个常数的一种数列，这个常数叫做等差数列的公差。 ** 公差可以为任意实数。 ** 也就是说，这个数列可以是递增的，递减的，或者恒为定值的（公差为$0$）。\n\n## 简述版题面：\n\n给出 $n,k$ ， 求 $\\sum_{i=1}^n f(i,k)$ 的值， $f(i,k)$ 定义为将十进制整数 $i$ 表示为 $k$ 进制时写成一个数列的形式中的最长连续子串为等差数列的长度。答案取模 $19260821$ 。\n\n## 一些闲话\n\n由于小L被赶去学文化课了，所以本题题面的扩写就咕咕咕啦！", "locale": "zh-CN", "translations": {"en": {"title": "Good Times.", "background": "# If you do not want to spend too much time reading the statement, please scroll to the bottom of the page to see the simplified version.\n\nTime flies. Time is like running water, constantly washing over everything. In the blink of an eye, the third year of junior high has arrived. A huge amount of homework and tense exams leave Xiao L and Xiao K less and less time to prepare for NOIP.", "description": "The unavoidable day finally came. Xiao L sat alone in the classroom, staring out the window in a daze.\n\nThe playground was not finished yet, the sky was empty, and the afterglow of the sunset had just painted a trace of blood-red beside the gray high-rises, then vanished in an instant without leaving any mark. The rustling autumn wind blew in through the window, and the classroom filled with the sound of pages turning. The book was flipped to a page with the doodles that Xiao L and Xiao K had drawn together. A crumpled score slip rolled back and forth on the desk like a hard-to-untie knot. There was not a single star in the sky—perhaps because of the dark clouds in his heart that could not be blown away.\n\nXiao L did terribly on the monthly exam for general subjects, and the NOIP preliminary round also went extremely poorly. It was very likely that he would not make it to the next round.\n\nAs for those dark clouds that could not be blown away, let them stay there. Anyway, there was no chance to change anything.\n\nIf it were not for the stressful pace of the third year, perhaps everyone would not have gone their separate ways so easily. One former teammate after another left the computer room.\n\nSigh, I will probably have to leave the computer room too, Xiao L thought.\n\nAt that moment, he remembered every good time he had spent with Xiao K.\n\nFrom the upright figures during the military training in the first year, to the two voices arguing fiercely in front of the podium, to the depressing scenes at the provincial contest, and to the days and nights they struggled together in the computer room...\n\nThinking of those good times made his heart feel warm. He felt that every second with Xiao K was worth cherishing.\n\nThen Xiao K came to Xiao L, learned about Xiao L’s wish, and Xiao L wanted to assign a “value worth cherishing” to every second he spent with Xiao K. If he added up all these values, Xiao L would keep all those good times in his heart, and his mood would get better.\n\nXiao L computes the value of a time moment like this: he first numbers each second sequentially starting from $1$, then converts the time (this second number) into the hour-minute-second form. For some reason, one minute for Xiao L has only $k$ seconds (a joke should be here), so Xiao L thinks that one hour also has only $k$ minutes. You may regard this as converting the second number into base $k$. Since Xiao L is not that evil, $k$ is always an integer here. Then he looks at this base-$k$ number and finds the length of the longest consecutive arithmetic progression inside it (only considering the case of a consecutive interval made up of single digits; that is, something like $123456789101112$ in base $10$ cannot be considered an arithmetic progression), and he records this length as the value of that second.\n\nXiao K really wants to help compute the total value of these seconds (from second $1$ to second $n$) to comfort the sad Xiao L. But the total number of seconds $n$ is far, far too large, so large that Xiao K would need more than one second to compute the value of a single second, and then the time Xiao L and Xiao K spend together could be **extended infinitely**. Xiao L very much hopes for that, but clearly they do not have that much time.\n\nXiao K found you, who are proficient in $OI$. To avoid the second number increasing during computation, you need to compute the answer within $1$ second. Since the answer may be very large, Xiao L accepts the result modulo $19260821$.\n\n## Simplified statement:\n\nGiven $n,k$, compute $\\sum_{i=1}^n f(i,k)$, where $f(i,k)$ is defined as follows: write the decimal integer $i$ in base $k$ as a sequence of digits, and take the length of the longest contiguous substring that forms an arithmetic progression. Output the answer modulo $19260821$.\n\n## Some extra words\n\nBecause Xiao L was driven to study general subjects, the expanded story part of this statement is “to be continued”!", "inputFormat": "One line with two integers $n$ and $k$. The input $n$ is given in decimal.", "outputFormat": "One line with one integer: the sum of values modulo $19260821$.", "hint": "Explanation for sample $\\#1$:\n\n$1$ to $5$ in base $3$ are $1,2,10,11,12$. The value of each number is exactly its length, so the total value is $1+1+2+2+2=8$.\n\nFor $10\\%$ of the testdata, $1\\le n\\le 10^6,k=60$.\n\nFor another $10\\%$ of the testdata, $k=10$.\n\nFor $40\\%$ of the testdata, $2\\le k\\le 20,1\\le n\\le k^{10}$.\n\nFor $100\\%$ of the testdata, $2\\le k\\le 60,1\\le n\\le k^{18}$.\n\n**There are no subtasks (no gradient in the data)!!!**\n\n# Xiao L teaches you math\n\n**Arithmetic progression**: An arithmetic progression is a sequence in which, starting from the second term, the difference between each term and the previous term is the same constant. This constant is called the common difference of the arithmetic progression. **The common difference can be any real number.** That is, the sequence may be increasing, decreasing, or constant (common difference $0$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "好时光", "background": "# 如果您不想在读题上消耗太多时间，请直接滑到页面最底部查看简述版题面。\n\n光阴似箭，日月如梭。时光如流水般，一刻不停地冲刷着一切。转眼间，初三已经到来了。巨量的作业，紧张的考试，无不使小L和小K准备NOIP的时间越来越少……", "description": "逃不掉的一天还是来了，小L一个人坐在教室里，看着窗外发呆。\n\n操场还没修完，天上空空荡荡的，夕阳的余晖刚刚在灰色的高楼旁涂上一抹血红，瞬间便消失了，不留下一点痕迹。飒飒的秋风从窗外吹进来，教室里响起了哗啦啦的书页被翻动的声音，书被翻到了画上了小L和小K共同的涂鸦的那一页。被揉成一团的成绩条在桌上滚来滚去，像难解的心结。天上没有一颗星星——大概是因为心头吹不散的乌云吧。\n\n小L的文化课月考考炸了，NOIP初赛也极度不理想，很可能是进不了复赛了。\n\n至于心头吹不散的乌云，就让它在那里吧，反正自己也没有机会去改变什么了。\n\n如果不是初三的紧张的节奏，大家大概不会这么轻易地分道扬镳吧？ 只见一个又一个昔日的队友离开了机房。\n\n唉，自己也大概要离开机房了吧。小L想到。\n\n这时，他想起了与小K相处的每一个好时光。\n\n从初一的军训中一个个挺拔的身影，到讲台前两个激烈讨论着的声音,省赛时颓废的场景，以及一起在机房奋斗过的日日夜夜……\n\n忆起这些好时光，他的心里暖暖的。他觉得和小K在一起的每一秒都是值得珍惜的好时光。\n\n这时，小K来到了小L的身边，知道了小L的愿望。小L想对他与小K相处的每一秒计算一个值得珍惜的价值，如果把这些价值都加起来，小L就会将这些好时光都记在心里，心情也会好起来了。\n\n小L是这样计算一个时间的价值的：他先将每一秒从 $1$ 开始顺序编号，再将时间（这个秒数）转换为时-分-秒形式。由于某种原因，小L的一分钟只有 $k$ 秒（此处应有滑稽），所以小L认为一小时也只有 $k$ 分钟。你可以认为小L将秒数转成了$k$ 进制。由于小L没有那么毒瘤，所以这里的 $k$ 都是整数。然后他观察这个 $k$ 进制数，找到其中最长的连续等差数列的长度（只考虑单个数码组成的连续的区间的情况，也就是说如 $10$ 进制下的 $123456789101112$ 不能称为等差数列） ，将其记为这一秒的价值。\n\n小K非常想帮他算出这些秒（从 $1$ 秒到 $n$ 秒）的总价值，以安慰伤心的小L。但是这个总秒数 $n$ 实在是太长太长了，以至于小K要超过一秒的时间才能算出一秒的价值，这样小L和小K在一起的时间就可以**无限延长**了。小L非常希望能这样，但是显然他们并没有这么多这么多的时间。\n\n小K找到了精通 $OI$ 的你。为了避免计算过程中秒数还在增加，你需要在 $1$ 秒钟内计算出答案。由于答案可能会很大，小L愿意接受这个数取模 $19260821$ 后的结果。", "inputFormat": "输入共一行，两个整数 $n$ 和 $k$。输入的$n$为十进制表示形式。", "outputFormat": "输出共一行，一个整数，为价值之和取模 $19260821$ 后的值。", "hint": "样例 $\\#1$ 解释：\n\n$1$到$5$转成$3$进制分别是$1,2,10,11,12$，每个数的价值恰好是它的长度，所以总价值为$1+1+2+2+2=8$。\n\n对于 $10\\%$ 的数据， $1\\le n\\le 10^6,k=60$；\n\n对于另外 $10\\%$ 的数据， $k=10$；\n\n对于 $40\\%$ 的数据， $2\\le k\\le 20,1\\le n\\le k^{10}$； \n\n对于 $100\\%$  的数据， $2\\le k\\le 60,1\\le n\\le k^{18}$ 。\n\n** 数据没有梯度！！！ **\n\n# 小L教你学数学\n\n**等差数列**：等差数列是指从第二项起，每一项与它的前一项的差等于同一个常数的一种数列，这个常数叫做等差数列的公差。 ** 公差可以为任意实数。 ** 也就是说，这个数列可以是递增的，递减的，或者恒为定值的（公差为$0$）。\n\n## 简述版题面：\n\n给出 $n,k$ ， 求 $\\sum_{i=1}^n f(i,k)$ 的值， $f(i,k)$ 定义为将十进制整数 $i$ 表示为 $k$ 进制时写成一个数列的形式中的最长连续子串为等差数列的长度。答案取模 $19260821$ 。\n\n## 一些闲话\n\n由于小L被赶去学文化课了，所以本题题面的扩写就咕咕咕啦！", "locale": "zh-CN"}}}
{"pid": "P5129", "type": "P", "difficulty": 5, "samples": [["4\n1 4 2\n4 2 2 \n3 4 2\n2 3 2", "8426611"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "不可思议的迷宫", "background": "融合了强力的装备,当然要去探索迷宫了  ", "description": "然而，在你用一套神装愉快的切瓜切菜时，慧音大小姐对你发动了忘却技能，于是，没有融合\"记\"印记的你忘记了迷宫的构造。  \n\n由于在忘却前你对这个迷宫的构造已经了如指掌，所以你知道这个迷宫的 $ n $ 个房间都是互相连通的，并且有 $ n $ 条道路连接这些房间(当然，道路从两个方向都可以经过)    \n\n即使在不可思议的幻想乡，基本的常识也是存在的，也就是说不会有连接两个相同房间的道路，也不会有两端是同一个房间的道路。  \n\n忘记了迷宫的构造后，你无从得知你在哪里，以及前往下一层的通道在哪里.幸运的是，你保存了一份这个迷宫大致的地图，知道了这 $ n $ 条道路分别连接哪两个房间以及每条道路的长度。  \n\n为了通关，你会从你所在的位置(某个随机的位置)不重复经过道路地走向前往下一层的通道(某个随机的位置)，显然，这种路径可能不止 $1$ 条，那么这时你会随机选取其中一条。  \n\n现在，你想知道自己走过的路径的期望长度，为了避免精度误差，只要对 $19260817$ 取模就好了。      \n", "inputFormat": "第一行一个整数 $n$，表示房间以及道路的个数。  \n \n下面 $n$ 行每行三个整数 $u,v,w$，表示从房间 $u$ 到房间 $v$ 有一条长度为 $w$ 的道路。     \n", "outputFormat": "一行一个整数，表示期望路径长度。", "hint": "#### 样例解释:  \n\n迷宫的结构如下:  \n![](https://cdn.luogu.com.cn/upload/pic/42707.png)  \n起始点和结束点都是随机的，用二元组$(x,y)$表示  \n\n以几个有代表性的二元组为例:  \n\n$(1,1)$，只有一条长度为$0$的路径  \n\n$(1,2)$，有两条路径$1-4-2,1-4-3-2$，期望路径长度为 $\\frac{4+6}{2}=5$   \n$(3,3)$，有两条路径$3-2-4,3$，期望路径长度为 $\\frac{6+0}{2}=3$   \n\n不难算出，将所有可能的二元组的期望路径长度加在一起为$57$，所以答案为 $\\frac{57}{16}$ ,在模意义下等于 $8426611$。\n\n#### 数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/42697.png)", "locale": "zh-CN", "translations": {"en": {"title": "Incredible Maze.", "background": "After merging powerful equipment, of course you have to explore the maze.", "description": "However, when you were happily crushing enemies with a set of divine gear, Lady Keine cast a forgetting skill on you. As a result, without merging the \"Ki\" mark, you forgot the structure of the maze.\n\nSince before forgetting you already knew this maze inside out, you do know that the $n$ rooms in this maze are all connected to each other, and there are $n$ roads connecting these rooms (of course, each road can be traveled in both directions).\n\nEven in the incredible Gensokyo, basic common sense still exists. That is, there will not be a road connecting two identical rooms, and there will not be a road whose two ends are the same room.\n\nAfter forgetting the maze structure, you have no way to know where you are, nor where the passage to the next floor is. Fortunately, you kept a rough map of this maze, so you know which two rooms each of these $n$ roads connects, as well as the length of each road.\n\nTo clear the level, you will go from your current position (a random location) to the passage to the next floor (also a random location) without traversing any road more than once. Obviously, there may be more than $1$ such path, and in that case you will randomly choose one of them.\n\nNow you want to know the expected length of the path you walk. To avoid precision errors, you only need to take the result modulo $19260817$.", "inputFormat": "The first line contains an integer $n$, indicating the number of rooms and the number of roads.\n\nThe next $n$ lines each contain three integers $u, v, w$, indicating that there is a road of length $w$ between room $u$ and room $v$.", "outputFormat": "Output one integer on one line, representing the expected path length.", "hint": "#### Sample Explanation:\n\nThe structure of the maze is as follows:\n![](https://cdn.luogu.com.cn/upload/pic/42707.png)\nBoth the start point and the end point are random, represented by an ordered pair $(x, y)$.\n\nTake a few representative ordered pairs as examples:\n\n$(1,1)$: there is only one path of length $0$.\n\n$(1,2)$: there are two paths $1-4-2$ and $1-4-3-2$, and the expected path length is $\\frac{4+6}{2}=5$.\n\n$(3,3)$: there are two paths $3-2-4$ and $3$, and the expected path length is $\\frac{6+0}{2}=3$.\n\nIt is not hard to calculate that the sum of the expected path lengths over all possible ordered pairs is $57$, so the answer is $\\frac{57}{16}$, which equals $8426611$ under modulo arithmetic.\n\n#### Constraints:\n\n![](https://cdn.luogu.com.cn/upload/pic/42697.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "不可思议的迷宫", "background": "融合了强力的装备,当然要去探索迷宫了  ", "description": "然而，在你用一套神装愉快的切瓜切菜时，慧音大小姐对你发动了忘却技能，于是，没有融合\"记\"印记的你忘记了迷宫的构造。  \n\n由于在忘却前你对这个迷宫的构造已经了如指掌，所以你知道这个迷宫的 $ n $ 个房间都是互相连通的，并且有 $ n $ 条道路连接这些房间(当然，道路从两个方向都可以经过)    \n\n即使在不可思议的幻想乡，基本的常识也是存在的，也就是说不会有连接两个相同房间的道路，也不会有两端是同一个房间的道路。  \n\n忘记了迷宫的构造后，你无从得知你在哪里，以及前往下一层的通道在哪里.幸运的是，你保存了一份这个迷宫大致的地图，知道了这 $ n $ 条道路分别连接哪两个房间以及每条道路的长度。  \n\n为了通关，你会从你所在的位置(某个随机的位置)不重复经过道路地走向前往下一层的通道(某个随机的位置)，显然，这种路径可能不止 $1$ 条，那么这时你会随机选取其中一条。  \n\n现在，你想知道自己走过的路径的期望长度，为了避免精度误差，只要对 $19260817$ 取模就好了。      \n", "inputFormat": "第一行一个整数 $n$，表示房间以及道路的个数。  \n \n下面 $n$ 行每行三个整数 $u,v,w$，表示从房间 $u$ 到房间 $v$ 有一条长度为 $w$ 的道路。     \n", "outputFormat": "一行一个整数，表示期望路径长度。", "hint": "#### 样例解释:  \n\n迷宫的结构如下:  \n![](https://cdn.luogu.com.cn/upload/pic/42707.png)  \n起始点和结束点都是随机的，用二元组$(x,y)$表示  \n\n以几个有代表性的二元组为例:  \n\n$(1,1)$，只有一条长度为$0$的路径  \n\n$(1,2)$，有两条路径$1-4-2,1-4-3-2$，期望路径长度为 $\\frac{4+6}{2}=5$   \n$(3,3)$，有两条路径$3-2-4,3$，期望路径长度为 $\\frac{6+0}{2}=3$   \n\n不难算出，将所有可能的二元组的期望路径长度加在一起为$57$，所以答案为 $\\frac{57}{16}$ ,在模意义下等于 $8426611$。\n\n#### 数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/42697.png)", "locale": "zh-CN"}}}
{"pid": "P5130", "type": "P", "difficulty": 6, "samples": [["1 1 2 1 1", "3"], ["1 1 2 1 5", "9630476"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "纯粹的弹幕地狱", "background": "除了丰富的迷宫系统之外,TODR的弹幕系统也富有趣味,不仅有多种华丽的特效,还有如咲夜的连发小刀,` The World `等特殊的攻击.  \n\n不仅自机如此,敌人也有自己独特的攻击方式,比如下图就是绵月丰姬的\"净化之风\"攻击模式    \n\n![](https://cdn.luogu.com.cn/upload/pic/42759.png)  \n", "description": "通过了不可思议的迷宫后,你一路顺利地过关斩将来到了最后一层,却遭遇了前所未有的强敌——纯狐  \n\n所幸的是,纯狐的弹幕不像绀珠转的强度一样大,房间的地形也比较特殊,可以为你所用.     \n\n形式化的来说,每一回合你和纯狐的行动模式如下:  \n\n1. 你可以将房间当成一张正方形网格图,左下角坐标为$(0,0)$,右上角的坐标为$(n,n)$,房间的有效位置为这$(n+1)*(n+1)$个格点,在一回合开始的时候,你会被随机传送到房间的任意一个有效位置  \n\n2. 之后,纯狐会随机出现在房间中的某个有效位置,当然,她不会和你出现在同一位置  \n\n3. 纯狐会发射纯粹的自机狙,也就是向你的方向发射一片弹幕,如果这片弹幕在飞行过程中经过了某个不是纯狐和自机所在的格点,则格点上的弹幕结界会被触发,将其传送到亚空间,如果这片弹幕顺利到达你所在的格点,那么你会受到一些伤害  \n\n4. 由于时间狂暴,纯狐在第$t$回合的弹幕伤害可以计算为$at^{2}+bt+c$  \n\n5. 回合结束,开始下一回合   \n\n经过粗略估计,你认为和纯狐的弹幕战会持续$k$回合,那么,为了稳妥起见,你想要算出自机受到的总期望伤害  \n\n答案可能很大也可能丢精度,所以对$19260817$取模就可以了", "inputFormat": "一行五个整数$n,a,b,c,k$,意义与题目描述保持一致", "outputFormat": "一行一个整数,表示期望受到总伤害的值", "hint": "样例$1$解释:  \n\n手画一个网格图,不难发现纯狐能打到你的情况有$12$种(先放自机再放纯狐即可得到)  \n\n所以第一发弹幕的伤害为$1*1*1+2*1+1=4$,期望伤害为$4*\\frac{12}{16}=3$  \n\n只有一回合,所以答案为$3$       \n\n数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/42785.png)  \n\n", "locale": "zh-CN", "translations": {"en": {"title": "Pure Bullet Hell", "background": "Besides the rich maze system, TODR’s bullet system is also very interesting. It not only has many gorgeous special effects, but also special attacks such as Sakuya’s rapid-fire knives and ` The World `.\n\nNot only the player character, but enemies also have their own unique attack patterns. For example, the picture below shows Toyohime Watatsuki’s \"Purifying Wind\" attack pattern.\n\n![](https://cdn.luogu.com.cn/upload/pic/42759.png)", "description": "After clearing the incredible maze, you fight your way smoothly to the final floor, but encounter an unprecedentedly strong enemy—Junko.\n\nFortunately, Junko’s bullet patterns are not as intense as in LoLK, and the room’s terrain is also quite special and can be used to your advantage.\n\nFormally, in each turn, the action process of you and Junko is as follows.\n\n1. You can treat the room as a square grid. The bottom-left corner has coordinates $(0,0)$, and the top-right corner has coordinates $(n,n)$. The valid positions in the room are these $(n+1)*(n+1)$ grid points. At the beginning of a turn, you will be randomly teleported to any valid position in the room.\n\n2. After that, Junko will randomly appear at some valid position in the room. Of course, she will not appear at the same position as you.\n\n3. Junko will fire a pure \"player-targeting shot\", i.e., she fires a wave of bullets toward your direction. If during the flight this wave of bullets passes through any grid point that is neither Junko’s position nor your position, then the bullet barrier on that grid point will be triggered and teleport the bullets into subspace. If this wave of bullets successfully reaches the grid point where you are, then you will take some damage.\n\n4. Due to time rampage, the bullet damage dealt by Junko in turn $t$ can be computed as $at^{2}+bt+c$.\n\n5. The turn ends, and the next turn begins.\n\nAfter a rough estimate, you think this bullet fight with Junko will last for $k$ turns. Then, to be safe, you want to compute the total expected damage taken by the player character.\n\nThe answer may be very large or may lose precision, so you only need to take it modulo $19260817$.", "inputFormat": "A single line contains five integers $n,a,b,c,k$, with meanings consistent with the problem statement.", "outputFormat": "Output one integer in a single line, representing the expected total damage taken.", "hint": "Explanation for Sample $1$:\n\nDraw a grid by hand. It is not hard to find that there are $12$ cases where Junko can hit you (place the player character first, then place Junko).\n\nSo the damage of the first wave of bullets is $1*1*1+2*1+1=4$, and the expected damage is $4*\\frac{12}{16}=3$.\n\nThere is only one turn, so the answer is $3$.\n\nConstraints:\n\n![](https://cdn.luogu.com.cn/upload/pic/42785.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "纯粹的弹幕地狱", "background": "除了丰富的迷宫系统之外,TODR的弹幕系统也富有趣味,不仅有多种华丽的特效,还有如咲夜的连发小刀,` The World `等特殊的攻击.  \n\n不仅自机如此,敌人也有自己独特的攻击方式,比如下图就是绵月丰姬的\"净化之风\"攻击模式    \n\n![](https://cdn.luogu.com.cn/upload/pic/42759.png)  \n", "description": "通过了不可思议的迷宫后,你一路顺利地过关斩将来到了最后一层,却遭遇了前所未有的强敌——纯狐  \n\n所幸的是,纯狐的弹幕不像绀珠转的强度一样大,房间的地形也比较特殊,可以为你所用.     \n\n形式化的来说,每一回合你和纯狐的行动模式如下:  \n\n1. 你可以将房间当成一张正方形网格图,左下角坐标为$(0,0)$,右上角的坐标为$(n,n)$,房间的有效位置为这$(n+1)*(n+1)$个格点,在一回合开始的时候,你会被随机传送到房间的任意一个有效位置  \n\n2. 之后,纯狐会随机出现在房间中的某个有效位置,当然,她不会和你出现在同一位置  \n\n3. 纯狐会发射纯粹的自机狙,也就是向你的方向发射一片弹幕,如果这片弹幕在飞行过程中经过了某个不是纯狐和自机所在的格点,则格点上的弹幕结界会被触发,将其传送到亚空间,如果这片弹幕顺利到达你所在的格点,那么你会受到一些伤害  \n\n4. 由于时间狂暴,纯狐在第$t$回合的弹幕伤害可以计算为$at^{2}+bt+c$  \n\n5. 回合结束,开始下一回合   \n\n经过粗略估计,你认为和纯狐的弹幕战会持续$k$回合,那么,为了稳妥起见,你想要算出自机受到的总期望伤害  \n\n答案可能很大也可能丢精度,所以对$19260817$取模就可以了", "inputFormat": "一行五个整数$n,a,b,c,k$,意义与题目描述保持一致", "outputFormat": "一行一个整数,表示期望受到总伤害的值", "hint": "样例$1$解释:  \n\n手画一个网格图,不难发现纯狐能打到你的情况有$12$种(先放自机再放纯狐即可得到)  \n\n所以第一发弹幕的伤害为$1*1*1+2*1+1=4$,期望伤害为$4*\\frac{12}{16}=3$  \n\n只有一回合,所以答案为$3$       \n\n数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/42785.png)  \n\n", "locale": "zh-CN"}}}
{"pid": "P5131", "type": "P", "difficulty": 4, "samples": [["3 2\n3 1 2", "16050685"], ["6 3\n1 1 4 5 1 4", "16509294"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "期望"], "title": "荷取融合", "background": "作为一款Rougelike类游戏，TODR具有丰富的装备系统。每一款装备独特的外观和华丽的特效，上百种各有效果的印记，复杂的炼成调和分解融合系统都塑造了这款游戏极高的游戏性。    \n\n现在你的装备刷到了满级，需要和其他装备融合来继续成长，当然，你需要让河城荷取将你原装备中的印记抽取出来以便和新装备合成。 ", "description": "已知原装备有 $n$ 个印记槽，每个印记槽中有无限多的一种印记，第 $i$ 个印记槽中的这种印记价值为 $a_{i}$。     \n\n河城荷取会用机械臂抽取印记槽内的印记，每一次抽取时，机械臂会向下抓取，从正下方的印记槽中抽取出一个印记，之后机械臂会向右移动或停留在原地(如果移动，那么可以移动任意格)，开始时机械臂的位置任意，但是任意时刻机械臂都必须在某个印记槽上。  \n\n河城荷取会进行 $k$ 次抓取，抓取结束后，你获得的总收益等于抓上来的 $k$ 个印记价值的乘积。\n\n假设河城荷取进行的一切操作都是随机的，那么你能获得的收益的平均值是多少呢?  \n\n由于答案可能不是整数，你只需输出答案对 $\\text{19260817}$ 取模后的结果。  ", "inputFormat": "第一行两个整数 $n,k$ ，表示印记槽的个数和抓取的次数。 \n  \n第二行 $n$ 个正整数 $a_{i}$ ，表示每个印记槽内印记的价值 。 ", "outputFormat": "一个整数，表示 $k$ 次抓取结束后的收益的平均值。", "hint": "#### 样例 $1$ 解释:  \n\n机械臂开始可以停在三个槽上方。  \n\n先后抓取的印记槽的位置可以是 $(1,1),(1,2),(1,3),(2,2),(2,3),(3,3)$ 六种,每一种抓取方案的收益分别是 $9,3,6,1,2,4$ ，平均值为 $\\frac{25}{6}$，在 $ \\text{mod 19260817}$ 的意义下等于 $16050685$   \n\n\n#### 数据范围:  \n\n$a_{i}<19260817$  \n\n![](https://cdn.luogu.com.cn/upload/pic/42182.png)   ", "locale": "zh-CN", "translations": {"en": {"title": "Nitori Fusion", "background": "As a Roguelike game, TODR has a rich equipment system. Each piece of equipment has a unique appearance and fancy special effects. Hundreds of different “marks” with different effects, plus a complex crafting / mixing / dismantling / fusion system, make this game highly replayable.\n\nNow your equipment has been leveled to the maximum. To keep growing, you need to fuse it with other equipment. Of course, you need Kawashiro Nitori to extract the marks from your original equipment so that they can be combined with the new equipment.", "description": "It is known that the original equipment has $n$ mark slots. In each mark slot, there are infinitely many copies of one kind of mark. The value of the mark in the $i$-th slot is $a_i$.\n\nKawashiro Nitori uses a mechanical arm to extract marks from the slots. Each time it extracts, the arm grabs downward and takes one mark from the slot directly below it. After that, the arm either moves to the right or stays in place (if it moves, it can move any number of slots). At the beginning, the arm can start at any position, but at any moment it must be above some mark slot.\n\nKawashiro Nitori will perform $k$ grabs. After all grabs, your total reward equals the product of the values of the $k$ extracted marks.\n\nAssuming all of Kawashiro Nitori’s operations are random, what is the expected value of the reward you can obtain?\n\nSince the answer may not be an integer, you only need to output the result modulo $\\text{19260817}$.", "inputFormat": "The first line contains two integers $n, k$, representing the number of mark slots and the number of grabs.\n\nThe second line contains $n$ positive integers $a_i$, representing the value of the mark in each slot.", "outputFormat": "Output one integer, representing the expected reward after $k$ grabs.", "hint": "#### Sample $1$ Explanation:\n\nAt the start, the mechanical arm can stay above any of the three slots.\n\nThe sequence of slots from which marks are grabbed can be one of the following six types: $(1,1), (1,2), (1,3), (2,2), (2,3), (3,3)$. The rewards for each plan are $9, 3, 6, 1, 2, 4$, respectively. The average is $\\frac{25}{6}$, which equals $16050685$ under $\\text{mod 19260817}$.\n\n#### Constraints:\n\n$a_i < 19260817$\n\n![](https://cdn.luogu.com.cn/upload/pic/42182.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "荷取融合", "background": "作为一款Rougelike类游戏，TODR具有丰富的装备系统。每一款装备独特的外观和华丽的特效，上百种各有效果的印记，复杂的炼成调和分解融合系统都塑造了这款游戏极高的游戏性。    \n\n现在你的装备刷到了满级，需要和其他装备融合来继续成长，当然，你需要让河城荷取将你原装备中的印记抽取出来以便和新装备合成。 ", "description": "已知原装备有 $n$ 个印记槽，每个印记槽中有无限多的一种印记，第 $i$ 个印记槽中的这种印记价值为 $a_{i}$。     \n\n河城荷取会用机械臂抽取印记槽内的印记，每一次抽取时，机械臂会向下抓取，从正下方的印记槽中抽取出一个印记，之后机械臂会向右移动或停留在原地(如果移动，那么可以移动任意格)，开始时机械臂的位置任意，但是任意时刻机械臂都必须在某个印记槽上。  \n\n河城荷取会进行 $k$ 次抓取，抓取结束后，你获得的总收益等于抓上来的 $k$ 个印记价值的乘积。\n\n假设河城荷取进行的一切操作都是随机的，那么你能获得的收益的平均值是多少呢?  \n\n由于答案可能不是整数，你只需输出答案对 $\\text{19260817}$ 取模后的结果。  ", "inputFormat": "第一行两个整数 $n,k$ ，表示印记槽的个数和抓取的次数。 \n  \n第二行 $n$ 个正整数 $a_{i}$ ，表示每个印记槽内印记的价值 。 ", "outputFormat": "一个整数，表示 $k$ 次抓取结束后的收益的平均值。", "hint": "#### 样例 $1$ 解释:  \n\n机械臂开始可以停在三个槽上方。  \n\n先后抓取的印记槽的位置可以是 $(1,1),(1,2),(1,3),(2,2),(2,3),(3,3)$ 六种,每一种抓取方案的收益分别是 $9,3,6,1,2,4$ ，平均值为 $\\frac{25}{6}$，在 $ \\text{mod 19260817}$ 的意义下等于 $16050685$   \n\n\n#### 数据范围:  \n\n$a_{i}<19260817$  \n\n![](https://cdn.luogu.com.cn/upload/pic/42182.png)   ", "locale": "zh-CN"}}}
{"pid": "P5132", "type": "P", "difficulty": 2, "samples": [["4\n2 5 1 7\n0 343 154 12\n343 0 214 132\n154 214 0 441\n12 132 441 0", "2179"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创"], "title": "Cozy Glow之拯救小马国", "background": "本题难度普及-，请noip两个组别的选手都把它AC（~~不然你noip省三都保不住了~~）\n\nps：三年OI一场空，day1T1见祖宗。。。", "description": "Cozy Glow偷偷摸摸的造了一个魔法阵，这个魔法阵在吸取小马国的魔力，所以你得赶紧把它毁掉。\n\n这个魔法阵由若干个神器组成，每个神器都有一个法力值，每两个神器之间也都有一个关联值。你要依次把这些神器拿走，但是，每拿走一个神器，你就会受到一定量的反噬，反噬的量为这个神器与其他还在神器的关联值乘以这个神器的法力值，为了减少反噬，tb148需要拿走每个神器，但由于他贪生怕死，他想让他受到的反噬值之和最小，现在tb148想知道，怎样拿走神器，才能让反噬值的和最小。", "inputFormat": "第一行，神器的个数\n\n第二行，每一个神器的法力值\n\n接下来，将以邻接矩阵的形式输入神器之间的关联值", "outputFormat": "最好的拿取方式所产生反噬值的和", "hint": "神器个数<=1000\n\n所有其他的值<=2000000\n\n正对角线上的数保证都是零。。。", "locale": "zh-CN", "translations": {"en": {"title": "Cozy Glow Saves Equestria.", "background": "This problem is at Junior- difficulty. Players from both NOIP groups, please all get it accepted (~~otherwise you might not even keep your NOIP provincial third prize~~).\n\nPS: Three years of OI end up as nothing, and on Day 1 T1 you meet your ancestors...", "description": "Cozy Glow secretly built a magic array. This magic array is absorbing the magic of Equestria, so you must destroy it as soon as possible.\n\nThis magic array consists of several artifacts. Each artifact has a magic power value, and every pair of artifacts also has an association value. You need to remove these artifacts one by one. However, every time you remove an artifact, you will suffer a certain amount of backlash. The amount of backlash equals the sum of the association values between this artifact and all other artifacts that are still present, multiplied by this artifact’s magic power value. In order to reduce the backlash, tb148 needs to take away every artifact. But because he is afraid of dying, he wants the total sum of backlash values to be as small as possible. Now tb148 wants to know: in what order should the artifacts be removed to make the total backlash minimum?", "inputFormat": "The first line contains the number of artifacts.\n\nThe second line contains the magic power value of each artifact.\n\nNext, the association values between artifacts are given in the form of an adjacency matrix.", "outputFormat": "Output the total backlash value produced by the best removal order.", "hint": "Constraints:\n\nNumber of artifacts $\\le 1000$.\n\nAll other values $\\le 2000000$.\n\nThe numbers on the main diagonal are guaranteed to be $0$...\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Cozy Glow之拯救小马国", "background": "本题难度普及-，请noip两个组别的选手都把它AC（~~不然你noip省三都保不住了~~）\n\nps：三年OI一场空，day1T1见祖宗。。。", "description": "Cozy Glow偷偷摸摸的造了一个魔法阵，这个魔法阵在吸取小马国的魔力，所以你得赶紧把它毁掉。\n\n这个魔法阵由若干个神器组成，每个神器都有一个法力值，每两个神器之间也都有一个关联值。你要依次把这些神器拿走，但是，每拿走一个神器，你就会受到一定量的反噬，反噬的量为这个神器与其他还在神器的关联值乘以这个神器的法力值，为了减少反噬，tb148需要拿走每个神器，但由于他贪生怕死，他想让他受到的反噬值之和最小，现在tb148想知道，怎样拿走神器，才能让反噬值的和最小。", "inputFormat": "第一行，神器的个数\n\n第二行，每一个神器的法力值\n\n接下来，将以邻接矩阵的形式输入神器之间的关联值", "outputFormat": "最好的拿取方式所产生反噬值的和", "hint": "神器个数<=1000\n\n所有其他的值<=2000000\n\n正对角线上的数保证都是零。。。", "locale": "zh-CN"}}}
{"pid": "P5133", "type": "P", "difficulty": 4, "samples": [["4\n1 4 2 3", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 512000]}, "tags": [], "title": "tb148 的客人", "background": "tb148 使用优惠券买来了许多食材后，请来了很多客人来吃饭。", "description": "tb148 和他的 $n$ 个客人，他们每人有一个编号（从 $1$ 开始的连续正整数）。目前，大家不按编号，乱序围坐在一张圆桌上。每次操作我们可以同时让任意多的客人沿顺时针或逆时针移动一个位置，我们称作一次操作。这个过程中一个位置可以没有客人或有多个客人。请问最少需要多少秒，使得每个位置仍恰好只有一个数，且客人的编号沿顺时针或逆时针依次为 $1 \\sim n$？", "inputFormat": "输入包含两行。\n\n第一行为一个正整数 $n$。\n\n第二行为 $n$ 个由空格隔开的正整数，为一个 $1 \\sim n$ 的排列，表示最开始时按顺时针顺序的客人编号。", "outputFormat": "输出一个整数表示答案。", "hint": "对于 $40 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^3$。\n\n对于 $80 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^5$。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Guests of tb148", "background": "After tb148 bought a lot of ingredients using coupons, he invited many guests to have a meal.", "description": "tb148 and his $n$ guests each have an ID number (consecutive positive integers starting from $1$). Currently, they are sitting around a round table in a random order, not by their IDs. In one operation, we may simultaneously let any number of guests move one position clockwise or counterclockwise; we call this one operation. During this process, a position may have no guest or multiple guests. Find the minimum number of seconds needed so that each position still has exactly one person, and the guests' IDs in clockwise order (or in counterclockwise order) are exactly $1 \\sim n$.", "inputFormat": "The input contains two lines.\n\nThe first line is a positive integer $n$.\n\nThe second line contains $n$ space-separated positive integers, a permutation of $1 \\sim n$, representing the guests' IDs in clockwise order at the beginning.", "outputFormat": "Output one integer, the answer.", "hint": "For $40\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^3$.\n\nFor $80\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "tb148 的客人", "background": "tb148 使用优惠券买来了许多食材后，请来了很多客人来吃饭。", "description": "tb148 和他的 $n$ 个客人，他们每人有一个编号（从 $1$ 开始的连续正整数）。目前，大家不按编号，乱序围坐在一张圆桌上。每次操作我们可以同时让任意多的客人沿顺时针或逆时针移动一个位置，我们称作一次操作。这个过程中一个位置可以没有客人或有多个客人。请问最少需要多少秒，使得每个位置仍恰好只有一个数，且客人的编号沿顺时针或逆时针依次为 $1 \\sim n$？", "inputFormat": "输入包含两行。\n\n第一行为一个正整数 $n$。\n\n第二行为 $n$ 个由空格隔开的正整数，为一个 $1 \\sim n$ 的排列，表示最开始时按顺时针顺序的客人编号。", "outputFormat": "输出一个整数表示答案。", "hint": "对于 $40 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^3$。\n\n对于 $80 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^5$。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5134", "type": "P", "difficulty": 6, "samples": [["10 10", "999989991"], ["6 2", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "好编号", "background": "", "description": "给定参数 $ N $、$ K $。一个编号 $ A $ 被称为好编号，当且仅当对于任意的 $ i \\in \\{ 1, 2, \\cdots, N-1 \\} $，均满足：$ \\dfrac{A}{K^i} - \\left\\lfloor \\dfrac{A}{K^i} \\right\\rfloor > \\dfrac{A}{K^N} $。\n\n求好编号的个数模 $ 10^9+7 $ 的值。", "inputFormat": "一行两个正整数 $N,K$。", "outputFormat": "一行，好编号个数模 $10 ^ 9 + 7$ 的值。", "hint": "- 对于 $20\\%$ 的数据，$K^N\\leq 5\\times 10 ^ 4$。\n- 对于 $60\\%$ 的数据， $N, K\\leq 10 ^ 6$。\n- 对于 $100\\%$ 的数据，$1\\leq N, K\\leq 10 ^ 9$。", "locale": "zh-CN", "translations": {"en": {"title": "Good Numbers", "background": "", "description": "Given parameters $N$ and $K$. A number $A$ is called a good number if and only if for every $i \\in \\{1, 2, \\cdots, N-1\\}$, the following holds: $\\dfrac{A}{K^i} - \\left\\lfloor \\dfrac{A}{K^i} \\right\\rfloor > \\dfrac{A}{K^N}$.\n\nFind the number of good numbers modulo $10^9+7$.", "inputFormat": "One line with two positive integers $N, K$.", "outputFormat": "One line, the number of good numbers modulo $10 ^ 9 + 7$.", "hint": "- For $20\\%$ of the testdata, $K^N \\leq 5\\times 10 ^ 4$.\n- For $60\\%$ of the testdata, $N, K \\leq 10 ^ 6$.\n- For $100\\%$ of the testdata, $1 \\leq N, K \\leq 10 ^ 9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "好编号", "background": "", "description": "给定参数 $ N $、$ K $。一个编号 $ A $ 被称为好编号，当且仅当对于任意的 $ i \\in \\{ 1, 2, \\cdots, N-1 \\} $，均满足：$ \\dfrac{A}{K^i} - \\left\\lfloor \\dfrac{A}{K^i} \\right\\rfloor > \\dfrac{A}{K^N} $。\n\n求好编号的个数模 $ 10^9+7 $ 的值。", "inputFormat": "一行两个正整数 $N,K$。", "outputFormat": "一行，好编号个数模 $10 ^ 9 + 7$ 的值。", "hint": "- 对于 $20\\%$ 的数据，$K^N\\leq 5\\times 10 ^ 4$。\n- 对于 $60\\%$ 的数据， $N, K\\leq 10 ^ 6$。\n- 对于 $100\\%$ 的数据，$1\\leq N, K\\leq 10 ^ 9$。", "locale": "zh-CN"}}}
{"pid": "P5135", "type": "P", "difficulty": 5, "samples": [["5\n5 2 1\n5 3 0\n3 4 0\n8 4 1\n6 2 1", "10\n35\n15\n70\n15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["组合数学", "逆元"], "title": "painting", "background": "Wolfycz很喜欢画画（雾", "description": "Wolfycz喜欢网格图，他希望在网格图上画上一些黑格子，使得每一列都恰好有一个黑格子。但是黑格子太乱了不好看，所以Wolfycz希望黑格子按列号依次连线是下降的，具体来讲，每列黑格子所在行号不得小于前一列黑格子所在行号（我们令左上角为第一行第一列）\n\nWolfycz觉得这样画出来的图非常漂亮，但是Wolfycz有时候觉得连线要严格下降才好看（即每列黑格子所在行号必须大于前一列黑格子所在行号），有时候觉得连线只要不上升就好看（即每列黑格子所在行号不得小于前一列黑格子所在行号）。现在Wolfycz想知道，对于一个$N×M$的网格图，他能画出多少个好看的图？两个图不相同，当且仅当存在某一列的黑格子，它在两个图中对应的行号不同\n\nUPD：$N$行$M$列", "inputFormat": "第一行读入$T$，表示有$T$组数据\n\n接下来每一行读入三个整数$N,M,opt$，表示$N×M$的矩阵，如果$opt$为1，则Wolfycz认为连线要严格下降才好看；如果$opt$为0，则Wolfycz认为连线只要不上升就好看", "outputFormat": "输出共$T$行，每行一个整数，表示Wolfycz能画出不同的图的个数，答案对$10^9+7$取模", "hint": "对于$20\\%$的数据，$T\\leqslant 5,N\\leqslant 8,M\\leqslant 8$\n\n对于另外$20\\%$的数据，$N=1$或$M=1$\n\n对于另外$20\\%$的数据，$N\\leqslant 10^6,M\\leqslant 10^6$\n\n对于$100\\%$的数据，$T\\leqslant 50,N\\leqslant 10^{18},M\\leqslant 10^6$", "locale": "zh-CN", "translations": {"en": {"title": "painting", "background": "Wolfycz really likes painting (sort of).", "description": "Wolfycz likes grid diagrams. He wants to paint some black cells on a grid so that each column has exactly one black cell. However, black cells look messy, so Wolfycz wants the polyline formed by connecting the black cells from left to right (in increasing column order) to be descending. More specifically, the row index of the black cell in each column must be no smaller than the row index of the black cell in the previous column (we define the top-left corner as row $1$, column $1$).\n\nWolfycz thinks such diagrams look very nice, but sometimes he feels that the polyline must be strictly descending to look good (i.e., the row index of the black cell in each column must be greater than that in the previous column). Sometimes he feels it is enough that the polyline does not go up (i.e., the row index of the black cell in each column must be no smaller than that in the previous column). Now Wolfycz wants to know: for an $N \\times M$ grid, how many nice diagrams can he draw? Two diagrams are different if and only if there exists a column whose black cell is in different rows in the two diagrams.\n\nUPD: $N$ rows and $M$ columns.", "inputFormat": "The first line contains $T$, meaning there are $T$ test cases.\n\nEach of the next $T$ lines contains three integers $N, M, opt$, describing an $N \\times M$ matrix. If $opt$ is $1$, then Wolfycz thinks the polyline must be strictly descending to look good. If $opt$ is $0$, then Wolfycz thinks it is enough that the polyline does not go up.", "outputFormat": "Output $T$ lines in total. Each line contains one integer, the number of different diagrams Wolfycz can draw, modulo $10^9 + 7$.", "hint": "For $20\\%$ of the testdata, $T \\leqslant 5, N \\leqslant 8, M \\leqslant 8$.\n\nFor another $20\\%$ of the testdata, $N = 1$ or $M = 1$.\n\nFor another $20\\%$ of the testdata, $N \\leqslant 10^6, M \\leqslant 10^6$.\n\nFor $100\\%$ of the testdata, $T \\leqslant 50, N \\leqslant 10^{18}, M \\leqslant 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "painting", "background": "Wolfycz很喜欢画画（雾", "description": "Wolfycz喜欢网格图，他希望在网格图上画上一些黑格子，使得每一列都恰好有一个黑格子。但是黑格子太乱了不好看，所以Wolfycz希望黑格子按列号依次连线是下降的，具体来讲，每列黑格子所在行号不得小于前一列黑格子所在行号（我们令左上角为第一行第一列）\n\nWolfycz觉得这样画出来的图非常漂亮，但是Wolfycz有时候觉得连线要严格下降才好看（即每列黑格子所在行号必须大于前一列黑格子所在行号），有时候觉得连线只要不上升就好看（即每列黑格子所在行号不得小于前一列黑格子所在行号）。现在Wolfycz想知道，对于一个$N×M$的网格图，他能画出多少个好看的图？两个图不相同，当且仅当存在某一列的黑格子，它在两个图中对应的行号不同\n\nUPD：$N$行$M$列", "inputFormat": "第一行读入$T$，表示有$T$组数据\n\n接下来每一行读入三个整数$N,M,opt$，表示$N×M$的矩阵，如果$opt$为1，则Wolfycz认为连线要严格下降才好看；如果$opt$为0，则Wolfycz认为连线只要不上升就好看", "outputFormat": "输出共$T$行，每行一个整数，表示Wolfycz能画出不同的图的个数，答案对$10^9+7$取模", "hint": "对于$20\\%$的数据，$T\\leqslant 5,N\\leqslant 8,M\\leqslant 8$\n\n对于另外$20\\%$的数据，$N=1$或$M=1$\n\n对于另外$20\\%$的数据，$N\\leqslant 10^6,M\\leqslant 10^6$\n\n对于$100\\%$的数据，$T\\leqslant 50,N\\leqslant 10^{18},M\\leqslant 10^6$", "locale": "zh-CN"}}}
{"pid": "P5136", "type": "P", "difficulty": 6, "samples": [["5\n1\n9\n20\n50\n100", "2\n77\n15127\n192911239\n996781931"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "sequence", "background": "Wolfycz很喜欢数列（雾", "description": "Wolfycz非常喜欢研究数列，同时他也喜欢研究黄金分割率，有一天Wolfycz写下了一个数列，他令$A_i=\\lceil(\\dfrac{\\sqrt{5}+1}{2})^i\\rceil$，但是Wolfycz并不知道$A_n$的值，所以希望你来帮帮他\n\n注：请注意常数因子对程序运行效率的影响", "inputFormat": "第一行读入$T$，表示有$T$组数据\n\n之后每一行一个整数$n$", "outputFormat": "输出共$T$行，每行一个整数，表示$\\lceil(\\dfrac{\\sqrt{5}+1}{2})^n\\rceil$的值，答案对998244353取模", "hint": "对于$5\\%$的数据，$n\\leqslant 20$\n\n对于$40\\%$的数据，$T\\leqslant 5×10^4$\n\n对于$100\\%$的数据，$T\\leqslant 10^5,n\\leqslant 10^{18}$", "locale": "zh-CN", "translations": {"en": {"title": "sequence", "background": "Wolfycz really likes sequences (just kidding).", "description": "Wolfycz really enjoys studying sequences, and he also likes the golden ratio. One day, Wolfycz wrote down a sequence and defined $A_i=\\lceil(\\dfrac{\\sqrt{5}+1}{2})^i\\rceil$. However, Wolfycz does not know the value of $A_n$, so he hopes you can help him.\n\nNote: Please pay attention to the impact of constant factors on the running time of your program.", "inputFormat": "The first line contains $T$, meaning there are $T$ test cases.\n\nThen each following line contains one integer $n$.", "outputFormat": "Output $T$ lines in total. Each line contains one integer, representing the value of $\\lceil(\\dfrac{\\sqrt{5}+1}{2})^n\\rceil$. Output the answer modulo 998244353.", "hint": "For $5\\%$ of the testdata, $n\\leqslant 20$.\n\nFor $40\\%$ of the testdata, $T\\leqslant 5×10^4$.\n\nFor $100\\%$ of the testdata, $T\\leqslant 10^5,n\\leqslant 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "sequence", "background": "Wolfycz很喜欢数列（雾", "description": "Wolfycz非常喜欢研究数列，同时他也喜欢研究黄金分割率，有一天Wolfycz写下了一个数列，他令$A_i=\\lceil(\\dfrac{\\sqrt{5}+1}{2})^i\\rceil$，但是Wolfycz并不知道$A_n$的值，所以希望你来帮帮他\n\n注：请注意常数因子对程序运行效率的影响", "inputFormat": "第一行读入$T$，表示有$T$组数据\n\n之后每一行一个整数$n$", "outputFormat": "输出共$T$行，每行一个整数，表示$\\lceil(\\dfrac{\\sqrt{5}+1}{2})^n\\rceil$的值，答案对998244353取模", "hint": "对于$5\\%$的数据，$n\\leqslant 20$\n\n对于$40\\%$的数据，$T\\leqslant 5×10^4$\n\n对于$100\\%$的数据，$T\\leqslant 10^5,n\\leqslant 10^{18}$", "locale": "zh-CN"}}}
{"pid": "P5137", "type": "P", "difficulty": 6, "samples": [["5\n12 78 35 317\n35 57 19 193\n94 31 75 571\n64 80 14 857\n74 16 42 751\n", "254\n24\n283\n796\n407"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "polynomial", "background": "Wolfycz 很喜欢多项式（雾", "description": "Wolfycz 喜欢研究多项式，尤其喜欢研究 $(a+b)^n$ 这样简单的问题，我们知道 $(a+b)^n=\\sum\\limits_{i=0}^n\\binom{n}{i}a^ib^{n-i}$，但是 Wolfycz 对这样的式子并不满足，于是他把所有的系数全部改成了 $1$，即 $\\sum\\limits_{i=0}^na^ib^{n-i}$，但是 Wolfycz 发现自己太菜了，不会求答案，于是希望你来帮帮他。\n\nUPD：请注意常数因子对程序运行效率的影响。", "inputFormat": "第一行读入 $T$，表示有 $T$ 组数据。\n\n接下来每一行读入四个整数 $n,a,b,p$。", "outputFormat": "共 $T$ 行，每行一个整数，表示 $(\\sum\\limits_{i=0}^na^ib^{n-i})\\bmod p$ 后的值。", "hint": "对于$30\\%$的数据，$T\\leqslant 100,n,a,b,p\\leqslant 10^5$\n\n对于$100\\%$的数据，$T\\leqslant 10^5,n,a,b,p\\leqslant 10^{18}$\n\nUPD：不保证$p$为质数！！！", "locale": "zh-CN", "translations": {"en": {"title": "polynomial", "background": "Wolfycz really likes polynomials (just kidding).", "description": "Wolfycz likes studying polynomials, and especially likes simple problems like $(a+b)^n$. We know that $(a+b)^n=\\sum\\limits_{i=0}^n\\binom{n}{i}a^ib^{n-i}$, but Wolfycz is not satisfied with such an expression, so he changes all coefficients to $1$, i.e. $\\sum\\limits_{i=0}^na^ib^{n-i}$. However, Wolfycz finds that he is not skilled enough and cannot compute the answer, so he hopes you can help him.\n\nUPD: Please pay attention to the impact of constant factors on runtime efficiency.", "inputFormat": "The first line contains $T$, meaning there are $T$ test cases.\n\nEach of the next lines contains four integers $n,a,b,p$.", "outputFormat": "Output $T$ lines. Each line contains one integer, representing the value of $(\\sum\\limits_{i=0}^na^ib^{n-i})\\bmod p$.", "hint": "For $30\\%$ of the testdata, $T\\leqslant 100,n,a,b,p\\leqslant 10^5$.\n\nFor $100\\%$ of the testdata, $T\\leqslant 10^5,n,a,b,p\\leqslant 10^{18}$.\n\nUPD: $p$ is not guaranteed to be prime.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "polynomial", "background": "Wolfycz 很喜欢多项式（雾", "description": "Wolfycz 喜欢研究多项式，尤其喜欢研究 $(a+b)^n$ 这样简单的问题，我们知道 $(a+b)^n=\\sum\\limits_{i=0}^n\\binom{n}{i}a^ib^{n-i}$，但是 Wolfycz 对这样的式子并不满足，于是他把所有的系数全部改成了 $1$，即 $\\sum\\limits_{i=0}^na^ib^{n-i}$，但是 Wolfycz 发现自己太菜了，不会求答案，于是希望你来帮帮他。\n\nUPD：请注意常数因子对程序运行效率的影响。", "inputFormat": "第一行读入 $T$，表示有 $T$ 组数据。\n\n接下来每一行读入四个整数 $n,a,b,p$。", "outputFormat": "共 $T$ 行，每行一个整数，表示 $(\\sum\\limits_{i=0}^na^ib^{n-i})\\bmod p$ 后的值。", "hint": "对于$30\\%$的数据，$T\\leqslant 100,n,a,b,p\\leqslant 10^5$\n\n对于$100\\%$的数据，$T\\leqslant 10^5,n,a,b,p\\leqslant 10^{18}$\n\nUPD：不保证$p$为质数！！！", "locale": "zh-CN"}}}
{"pid": "P5138", "type": "P", "difficulty": 7, "samples": [["5 10\n2 1\n1 3\n2 4\n5 2\nQ 1 5\nU 1 1\nQ 1 1\nQ 1 2\nQ 1 3\nQ 1 4\nQ 1 5\nU 2 2\nQ 2 3\nQ 4 5", "0\n1\n2\n2\n4\n4\n4\n10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "fibonacci", "background": "Wolfycz 很喜欢 Fibonacci 数列（雾", "description": "Wolfycz 热衷于研究 Fibonacci 数列，他定义 $Fib_i$ 为Fibonacci 数列的第 $i$ 项，同时定义 $Fib_0=0,Fib_1=1$，并且对于任意的$i$，满足 $Fib_i=Fib_{i-1}+Fib_{i-2}$。\n\nWolfycz 也喜欢植树，有一天他植了一颗滑稽树（就是 OI 中所说的树，$n$ 个点，$n-1$ 条边，以 $1$ 为根），初始时树上的节点都没有滑稽果，于是 Wolfycz 不惜花重金购入了金坷垃，每次他给滑稽树上的节点 $x$ 施肥 $k$ 克，会使 $x$ 以及它的子树都长出一堆滑稽果，具体来讲，如果 $x$ 子树中的某个节点距离 $x$ 的距离为 $D$，那么这个节点就会长出 $Fib_{D+k}$ 个滑稽果\n\nWolfycz 觉得滑稽树上滑稽果已经够多了，因此他想 Van 游戏，所以他会时不时询问你两个节点路径上有多少个滑稽果。", "inputFormat": "第一行给出两个整数 $N,M$，表示树的节点个数和操作个数\n\n第 $2\\sim N$ 行，第 $i$ 行两个数 $x,y$，表示节点 $x,y$ 之间有一条边\n\n接下来 $M$ 行，每行一个形如 `U x k` 或 `Q x y` 的形式\n\n- `U x k`：$x$ 的子树内的节点，若其到 $x$ 的距离为 $D$，则该点长出 $Fib_{D+k}$ 个滑稽果，$x$ 也要长滑稽果\n- `Q x y`：询问路径 $x,y$ 上所有节点的滑稽果个数和（包括 $x,y$），答案对 $10^9+7$ 取模", "outputFormat": "对于每个 `Q x y` 询问，输出其答案。", "hint": "对于$30\\%$的数据，$N,M,k\\leqslant 10^3$\n\n对于$100\\%$的数据，$N,M\\leqslant 10^5$，$1\\leqslant x,y\\leqslant N$，$1\\leqslant k\\leqslant 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "fibonacci", "background": "Wolfycz really likes the Fibonacci sequence (just kidding).", "description": "Wolfycz is keen on studying the Fibonacci sequence. He defines $Fib_i$ as the $i$-th term of the Fibonacci sequence, and defines $Fib_0=0,Fib_1=1$. For any $i$, it satisfies $Fib_i=Fib_{i-1}+Fib_{i-2}$.\n\nWolfycz also likes planting trees. One day he planted a “funny tree” (that is, the tree in OI: $n$ nodes, $n-1$ edges, rooted at $1$). Initially, none of the nodes on the tree had any funny fruits. Then Wolfycz spent a lot of money to buy fertilizer. Each time he fertilizes a node $x$ on the tree with $k$ grams, node $x$ and its entire subtree will grow a bunch of funny fruits. Specifically, if a node in the subtree of $x$ has distance $D$ to $x$, then this node will grow $Fib_{D+k}$ funny fruits.\n\nWolfycz thinks there are already enough funny fruits on the tree, so he wants to play a game, and he will occasionally ask you how many funny fruits there are on the path between two nodes.", "inputFormat": "The first line contains two integers $N,M$, representing the number of nodes in the tree and the number of operations.\n\nLines $2$ to $N$ each contain two integers $x,y$, indicating that there is an edge between nodes $x$ and $y$.\n\nNext come $M$ lines, each in the form `U x k` or `Q x y`.\n\n- `U x k`: For each node in the subtree of $x$, if its distance to $x$ is $D$, then it grows $Fib_{D+k}$ funny fruits. Node $x$ also grows fruits.\n- `Q x y`: Query the sum of funny fruits on all nodes along the path from $x$ to $y$ (including $x$ and $y$). Output the answer modulo $10^9+7$.", "outputFormat": "For each `Q x y` query, output the answer.", "hint": "For $30\\%$ of the testdata, $N,M,k\\leqslant 10^3$.\n\nFor $100\\%$ of the testdata, $N,M\\leqslant 10^5$, $1\\leqslant x,y\\leqslant N$, $1\\leqslant k\\leqslant 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "fibonacci", "background": "Wolfycz 很喜欢 Fibonacci 数列（雾", "description": "Wolfycz 热衷于研究 Fibonacci 数列，他定义 $Fib_i$ 为Fibonacci 数列的第 $i$ 项，同时定义 $Fib_0=0,Fib_1=1$，并且对于任意的$i$，满足 $Fib_i=Fib_{i-1}+Fib_{i-2}$。\n\nWolfycz 也喜欢植树，有一天他植了一颗滑稽树（就是 OI 中所说的树，$n$ 个点，$n-1$ 条边，以 $1$ 为根），初始时树上的节点都没有滑稽果，于是 Wolfycz 不惜花重金购入了金坷垃，每次他给滑稽树上的节点 $x$ 施肥 $k$ 克，会使 $x$ 以及它的子树都长出一堆滑稽果，具体来讲，如果 $x$ 子树中的某个节点距离 $x$ 的距离为 $D$，那么这个节点就会长出 $Fib_{D+k}$ 个滑稽果\n\nWolfycz 觉得滑稽树上滑稽果已经够多了，因此他想 Van 游戏，所以他会时不时询问你两个节点路径上有多少个滑稽果。", "inputFormat": "第一行给出两个整数 $N,M$，表示树的节点个数和操作个数\n\n第 $2\\sim N$ 行，第 $i$ 行两个数 $x,y$，表示节点 $x,y$ 之间有一条边\n\n接下来 $M$ 行，每行一个形如 `U x k` 或 `Q x y` 的形式\n\n- `U x k`：$x$ 的子树内的节点，若其到 $x$ 的距离为 $D$，则该点长出 $Fib_{D+k}$ 个滑稽果，$x$ 也要长滑稽果\n- `Q x y`：询问路径 $x,y$ 上所有节点的滑稽果个数和（包括 $x,y$），答案对 $10^9+7$ 取模", "outputFormat": "对于每个 `Q x y` 询问，输出其答案。", "hint": "对于$30\\%$的数据，$N,M,k\\leqslant 10^3$\n\n对于$100\\%$的数据，$N,M\\leqslant 10^5$，$1\\leqslant x,y\\leqslant N$，$1\\leqslant k\\leqslant 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5139", "type": "P", "difficulty": 3, "samples": [["1\n1 0 0\n4\n1 3\n1 -4\n4 1 2\n5 -1 0 -3\n", "0.00 3.00\n0\n-1.00\n"], ["1\n-4 10 100\n15\n4 0 78\n5 -4 -95 -97\n1 -79\n4 12 54\n4 -60 11\n1 83\n4 68 80\n2 -63\n1 71\n1 80\n3 12 67\n1 60\n1 41\n3 35 -13\n4 6 26\n", "-23456.00 106.25\n2\n-11103.00 -435.00\n-14979.00 27.25\n-24696.00 -17712.00\n-6972.00 -1892.00\n0.25\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "数学"], "title": "z小f的函数", "background": "z 小 f 热爱数学。\n\n由于 z 小 f 要复习 NOIp，而且他认为觉得数学作业太简单了，于是把数学作业交给了你。", "description": "给定二次函数 $y=ax^{2}+bx+c(a\\ne0)$，并给函数进行如下操作：\n\n- 操作 1：给定系数 $k$，将函数向上平移 $k$ 位（$k<0$ 则向下平移 $-k$ 位）；\n- 操作 2：给定系数 $k$，将函数向右平移 $k$ 位（$k<0$ 则向左平移 $-k$ 位）；\n- 操作 3：给定系数 $k_1,k_2$，将函数关于点 $(k_1,k_2)$ 进行对称变换；\n- 操作 4：给定系数 $k_1,k_2$，求函数在闭区间 $[k_1,k_2]$ 上的最小值和最大值；\n- 操作 5：给定系数 $u,v,w$，求出二次函数 $y$ 与二次函数 $y_2=ux^{2}+vx+w$ 是否有交点。\n\n此外，你还要输出最终的二次函数 $y$ 此时的最大（小）值。", "inputFormat": "第一行一个正整数 $T$，表示数学作业的题目数（即数据组数）。\n\n接下来 $T$ 组数据，对于每一组数据：\n\n> 第一行三个数 $a,b,c$，表示二次函数的系数 $a,b,c$；\n> \n> 第二行一个正整数 $n$，表示操作的数量。\n> \n> 接下来 $n$ 行，每一行都有一个整数 $p$，表示操作的编号，接下来的数即操作的内容（见题目描述）。\n\n数据保证合法。", "outputFormat": "对于每一个操作 4，输出两个小数，分别表示区间的最小值与最大值（保留两位小数）；\n\n对于每一个操作 5，输出一个整数，其中 $0$ 表示没有交点，$2$ 表示有交点；\n\n每组数据操作完成后，输出最终的二次函数 $y$ 此时的最大（小）值（保留两位小数）。", "hint": "对于 $30\\%$ 的数据，$n\\le100$，且没有操作 3。\n\n对于 $60\\%$ 的数据，$n\\le1000$。\n\n对于 $100\\%$ 的数据，$T\\le10$，$n\\le10000$。\n\n数据保证 $a\\ne0,u\\ne0,a\\ne u,1\\le p\\le5,-100\\le a,b,c,k1,k2,k,u,v,w\\le100$。", "locale": "zh-CN", "translations": {"en": {"title": "z Xiao f's Function", "background": "z Xiao f loves mathematics.\n\nBecause z Xiao f needs to review for NOIp, and he thinks the math homework is too easy, he handed the math homework to you.", "description": "Given a quadratic function $y=ax^{2}+bx+c(a\\ne0)$, perform the following operations on the function:\n\n- Operation 1: Given a coefficient $k$, shift the function upward by $k$ units (if $k<0$, shift downward by $-k$ units).\n- Operation 2: Given a coefficient $k$, shift the function rightward by $k$ units (if $k<0$, shift leftward by $-k$ units).\n- Operation 3: Given coefficients $k_1,k_2$, perform a symmetry transformation of the function with respect to the point $(k_1,k_2)$.\n- Operation 4: Given coefficients $k_1,k_2$, find the minimum and maximum values of the function on the closed interval $[k_1,k_2]$.\n- Operation 5: Given coefficients $u,v,w$, determine whether the quadratic function $y$ intersects with the quadratic function $y_2=ux^{2}+vx+w$.\n\nIn addition, you must output the maximum (or minimum) value of the final quadratic function $y$ at that time.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of math homework problems (i.e., the number of test cases).\n\nThen follow $T$ test cases. For each test case:\n\n> The first line contains three numbers $a,b,c$, representing the coefficients $a,b,c$ of the quadratic function.\n>\n> The second line contains a positive integer $n$, representing the number of operations.\n>\n> The next $n$ lines: each line starts with an integer $p$, indicating the operation number, and the following numbers are the parameters of the operation (see the Description).\n\nThe testdata is guaranteed to be valid.", "outputFormat": "For each Operation 4, output two decimal numbers, representing the minimum and maximum values on the interval (keep two decimal places).\n\nFor each Operation 5, output one integer, where $0$ means there is no intersection point, and $2$ means there is an intersection point.\n\nAfter completing all operations of each test case, output the maximum (or minimum) value of the final quadratic function $y$ at that time (keep two decimal places).", "hint": "For $30\\%$ of the testdata, $n\\le100$, and there is no Operation 3.\n\nFor $60\\%$ of the testdata, $n\\le1000$.\n\nFor $100\\%$ of the testdata, $T\\le10$, $n\\le10000$.\n\nThe testdata guarantees $a\\ne0,u\\ne0,a\\ne u,1\\le p\\le5,-100\\le a,b,c,k1,k2,k,u,v,w\\le100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "z小f的函数", "background": "z 小 f 热爱数学。\n\n由于 z 小 f 要复习 NOIp，而且他认为觉得数学作业太简单了，于是把数学作业交给了你。", "description": "给定二次函数 $y=ax^{2}+bx+c(a\\ne0)$，并给函数进行如下操作：\n\n- 操作 1：给定系数 $k$，将函数向上平移 $k$ 位（$k<0$ 则向下平移 $-k$ 位）；\n- 操作 2：给定系数 $k$，将函数向右平移 $k$ 位（$k<0$ 则向左平移 $-k$ 位）；\n- 操作 3：给定系数 $k_1,k_2$，将函数关于点 $(k_1,k_2)$ 进行对称变换；\n- 操作 4：给定系数 $k_1,k_2$，求函数在闭区间 $[k_1,k_2]$ 上的最小值和最大值；\n- 操作 5：给定系数 $u,v,w$，求出二次函数 $y$ 与二次函数 $y_2=ux^{2}+vx+w$ 是否有交点。\n\n此外，你还要输出最终的二次函数 $y$ 此时的最大（小）值。", "inputFormat": "第一行一个正整数 $T$，表示数学作业的题目数（即数据组数）。\n\n接下来 $T$ 组数据，对于每一组数据：\n\n> 第一行三个数 $a,b,c$，表示二次函数的系数 $a,b,c$；\n> \n> 第二行一个正整数 $n$，表示操作的数量。\n> \n> 接下来 $n$ 行，每一行都有一个整数 $p$，表示操作的编号，接下来的数即操作的内容（见题目描述）。\n\n数据保证合法。", "outputFormat": "对于每一个操作 4，输出两个小数，分别表示区间的最小值与最大值（保留两位小数）；\n\n对于每一个操作 5，输出一个整数，其中 $0$ 表示没有交点，$2$ 表示有交点；\n\n每组数据操作完成后，输出最终的二次函数 $y$ 此时的最大（小）值（保留两位小数）。", "hint": "对于 $30\\%$ 的数据，$n\\le100$，且没有操作 3。\n\n对于 $60\\%$ 的数据，$n\\le1000$。\n\n对于 $100\\%$ 的数据，$T\\le10$，$n\\le10000$。\n\n数据保证 $a\\ne0,u\\ne0,a\\ne u,1\\le p\\le5,-100\\le a,b,c,k1,k2,k,u,v,w\\le100$。", "locale": "zh-CN"}}}
{"pid": "P5140", "type": "P", "difficulty": 5, "samples": [["4 2 1\n2 1 4\n4 1 2\n3 1 2\n1 2\n2 6\n3 3\n4 3", "40"], ["5 1 1\n1 2 2\n3 2 2\n4 1 2\n5 4 2\n1 1\n3 1\n5 1\n", "16"], ["20 10 18\n1 17 86406\n17 16 94583\n19 10 28177\n16 18 31981\n10 14 36241\n1 7 28919\n2 1 94673\n5 6 2801\n7 11 81927\n11 13 7779\n17 5 71948\n19 7 20264\n1 8 17736\n13 20 97181\n17 9 16807\n11 15 93705\n17 3 29601\n1 12 43829\n13 4 27537\n1 6\n20 23585\n9 8376\n12 3128\n15 5417\n8 4011\n3 1156\n6 1497\n", "1289613990"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "高精度", "树形数据结构"], "title": "树枝修剪", "background": "$Daleva$ $Geoge$是一个热爱生活的园艺工。", "description": "$Daleva$ $Geoge$的花园里有一颗常年没有修剪的树，这一天，$Daleva$ $Geoge$家里来了客人，为了给客人一个好印象，他需要整理这个花园，但是那一颗树显得太碍眼了，他必须要给他好好地修剪一下。\n\n这是一颗以$root$为根的有根树，有$n$个节点。$Daleva$ $Geoge$在根节点，$Daleva$ $Geoge$对某些叶子的形态感到不满，需要剪去多余的枝条。\n\n有$S$个需要修剪的叶子节点,这些叶子节点有一些多余的枝条，这些叶子节点有着自己的权值$a_{i}$,表示这个节点上有多少个$Daleva$ $Geoge$不需要的枝条。同时，因为花园里没法容下这些枝条（否则就变得不和谐了），$Daleva$ $Geoge$需要把这些枝条安装到某些节点上。\n\n$Daleva$ $Geoge$有一个神奇的胶水和一把神奇的剪刀，因此你不需考虑每个树枝的固定形态，根据$Daleva$ $Geoge$的推测，一共有$T$个叶子节点需要安装这些枝条，这些节点有各自的权值$b_{i}$，表示需要$b_{i}$个枝条才能把这棵树变得很好看。\n\n为了修剪好这棵树，$Daleva$ $Geoge$不得不在树上跑边，把每个叶子节点中多余的枝条剪下，并用胶水粘在其他的有需要的叶子节点上。每条边都有不同的长度，现在，由于树太过庞大，$Daleva$ $Geoge$需要知道，他最少需要跑多远的路才能使这棵树被修剪好，$Daleva$ $Geoge$也要回到树根上下来。\n\n虽然$Daleva$ $Geoge$有这些神奇的工具，但他的口袋是有限的，容量为$G$,$Daleva$ $Geoge$不能一次带太多枝条，即不能超过$G$,这更使他懒于考虑这些繁琐的问题。$Daleva$ $Geoge$当然会算啦，他那么巨，但他为了养足精力去剪枝条，这一艰巨的任务就落在你身上了。\n\n$Daleva$ $Geoge$已经把心中树的形状告诉你了，他要躺在椅子上看你怎么算这些问题。", "inputFormat": "输入的第一行$3$个整数：$n,G,root$.\n\n接下来$n-1$行描述每个树边，每行$3$个整数：$u,v,w$表示$u$与$v$有一条长度为$w$的边。\n\n接下来一行$2$个整数：$S,T$;\n\n接下来$S$行，每行两个整数：$x,a_{i}$,表示在第$x$个节点有$a_{i}$个多余枝条，数据保证$x$为叶子节点。\n\n接下来$T$行，每行两个整数：$x,b_{i}$,表示在第$x$个节点需要$b_{i}$个枝条，数据保证$x$为叶子节点。\n\n数据保证$\\sum_{i=1}^{S}a_{i}=\\sum_{i=1}^{T}b_{i}$", "outputFormat": "一行，一个整数，表示$Daleva$ $Geoge$最少需要跑多长的路才能把树修剪好并回到树根爬下树。", "hint": "样例1解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/37354.png)\n\n蓝色数字表示有多少多余枝条，黄色数字表示需要的枝条数。\n\n则最优方案为：$1→2→1→3→1→2→1→3→1→4→1→2→1→4→1$，答案为$40$;\n\n对于$5\\%$的数据，为样例1。\n\n对于$40\\%$的数据，$n\\leq 10,G\\leq 10;w \\leq 1000$\n\n对于$100\\%$的数据，$n\\leq 40,0000,G\\leq 1000;S+T\\leq n;a_{i},b_{i}\\leq 10^{9};w\\leq 10^{9}$\n\n数据保证不会有任意一个叶子节点既需要枝条又有多余枝条。", "locale": "zh-CN", "translations": {"en": {"title": "Branch Pruning.", "background": "$Daleva$ $Geoge$ is a gardener who loves life.", "description": "In $Daleva$ $Geoge$'s garden, there is a tree that has not been pruned for many years. One day, guests come to $Daleva$ $Geoge$'s home. To leave a good impression, he needs to tidy up the garden, but the tree looks too unpleasant, so he must prune it carefully.\n\nThis is a rooted tree with $root$ as the root, and it has $n$ nodes. $Daleva$ $Geoge$ is at the root node. He is not satisfied with the shape of some leaves and needs to cut off the extra branches.\n\nThere are $S$ leaf nodes that need to be pruned. These leaf nodes have some extra branches. Each such leaf node has a weight $a_{i}$, which means how many branches on that node are not needed by $Daleva$ $Geoge$. At the same time, because the garden cannot hold these branches (otherwise it would look disharmonious), $Daleva$ $Geoge$ needs to attach these branches onto some nodes.\n\n$Daleva$ $Geoge$ has magical glue and magical scissors, so you do not need to consider the exact shape of each branch. According to $Daleva$ $Geoge$'s estimate, there are $T$ leaf nodes that need to receive these branches. These nodes have weights $b_{i}$, meaning that $b_{i}$ branches are needed to make the tree look nice.\n\nTo prune the tree well, $Daleva$ $Geoge$ has to move around on the tree, cut the extra branches from those leaf nodes, and use glue to stick them onto other leaf nodes that need them. Each edge has a different length. Now, since the tree is very large, $Daleva$ $Geoge$ wants to know the minimum total distance he needs to travel to finish pruning the tree, and he also has to return to the root to climb down.\n\nAlthough $Daleva$ $Geoge$ has these magical tools, his pocket is limited, with capacity $G$. He cannot carry too many branches at once, i.e., no more than $G$. This makes him even less willing to think about these annoying details. Of course, $Daleva$ $Geoge$ can calculate it, but to save his energy for pruning, this hard task is left to you.\n\n$Daleva$ $Geoge$ has already told you the shape of the tree in his mind, and he will lie on a chair and watch you compute the answer.", "inputFormat": "The first line contains $3$ integers: $n,G,root$.\n\nThe next $n-1$ lines describe the edges of the tree. Each line contains $3$ integers: $u,v,w$, meaning there is an edge of length $w$ between $u$ and $v$.\n\nThe next line contains $2$ integers: $S,T$.\n\nThe next $S$ lines each contain two integers: $x,a_{i}$, meaning node $x$ has $a_{i}$ extra branches. The testdata guarantees that $x$ is a leaf node.\n\nThe next $T$ lines each contain two integers: $x,b_{i}$, meaning node $x$ needs $b_{i}$ branches. The testdata guarantees that $x$ is a leaf node.\n\nThe testdata guarantees that $\\sum_{i=1}^{S}a_{i}=\\sum_{i=1}^{T}b_{i}$.", "outputFormat": "One line with one integer, representing the minimum total distance $Daleva$ $Geoge$ needs to travel to prune the tree and return to the root to climb down.", "hint": "Explanation for Sample 1:\n\n![](https://cdn.luogu.com.cn/upload/pic/37354.png)\n\nThe blue numbers indicate how many extra branches there are, and the yellow numbers indicate how many branches are needed.\n\nThen the best plan is: $1→2→1→3→1→2→1→3→1→4→1→2→1→4→1$, and the answer is $40$.\n\nFor $5\\%$ of the testdata, it is Sample 1.\n\nFor $40\\%$ of the testdata, $n\\leq 10,G\\leq 10;w \\leq 1000$.\n\nFor $100\\%$ of the testdata, $n\\leq 40,0000,G\\leq 1000;S+T\\leq n;a_{i},b_{i}\\leq 10^{9};w\\leq 10^{9}$.\n\nThe testdata guarantees that no leaf node both needs branches and has extra branches.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "树枝修剪", "background": "$Daleva$ $Geoge$是一个热爱生活的园艺工。", "description": "$Daleva$ $Geoge$的花园里有一颗常年没有修剪的树，这一天，$Daleva$ $Geoge$家里来了客人，为了给客人一个好印象，他需要整理这个花园，但是那一颗树显得太碍眼了，他必须要给他好好地修剪一下。\n\n这是一颗以$root$为根的有根树，有$n$个节点。$Daleva$ $Geoge$在根节点，$Daleva$ $Geoge$对某些叶子的形态感到不满，需要剪去多余的枝条。\n\n有$S$个需要修剪的叶子节点,这些叶子节点有一些多余的枝条，这些叶子节点有着自己的权值$a_{i}$,表示这个节点上有多少个$Daleva$ $Geoge$不需要的枝条。同时，因为花园里没法容下这些枝条（否则就变得不和谐了），$Daleva$ $Geoge$需要把这些枝条安装到某些节点上。\n\n$Daleva$ $Geoge$有一个神奇的胶水和一把神奇的剪刀，因此你不需考虑每个树枝的固定形态，根据$Daleva$ $Geoge$的推测，一共有$T$个叶子节点需要安装这些枝条，这些节点有各自的权值$b_{i}$，表示需要$b_{i}$个枝条才能把这棵树变得很好看。\n\n为了修剪好这棵树，$Daleva$ $Geoge$不得不在树上跑边，把每个叶子节点中多余的枝条剪下，并用胶水粘在其他的有需要的叶子节点上。每条边都有不同的长度，现在，由于树太过庞大，$Daleva$ $Geoge$需要知道，他最少需要跑多远的路才能使这棵树被修剪好，$Daleva$ $Geoge$也要回到树根上下来。\n\n虽然$Daleva$ $Geoge$有这些神奇的工具，但他的口袋是有限的，容量为$G$,$Daleva$ $Geoge$不能一次带太多枝条，即不能超过$G$,这更使他懒于考虑这些繁琐的问题。$Daleva$ $Geoge$当然会算啦，他那么巨，但他为了养足精力去剪枝条，这一艰巨的任务就落在你身上了。\n\n$Daleva$ $Geoge$已经把心中树的形状告诉你了，他要躺在椅子上看你怎么算这些问题。", "inputFormat": "输入的第一行$3$个整数：$n,G,root$.\n\n接下来$n-1$行描述每个树边，每行$3$个整数：$u,v,w$表示$u$与$v$有一条长度为$w$的边。\n\n接下来一行$2$个整数：$S,T$;\n\n接下来$S$行，每行两个整数：$x,a_{i}$,表示在第$x$个节点有$a_{i}$个多余枝条，数据保证$x$为叶子节点。\n\n接下来$T$行，每行两个整数：$x,b_{i}$,表示在第$x$个节点需要$b_{i}$个枝条，数据保证$x$为叶子节点。\n\n数据保证$\\sum_{i=1}^{S}a_{i}=\\sum_{i=1}^{T}b_{i}$", "outputFormat": "一行，一个整数，表示$Daleva$ $Geoge$最少需要跑多长的路才能把树修剪好并回到树根爬下树。", "hint": "样例1解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/37354.png)\n\n蓝色数字表示有多少多余枝条，黄色数字表示需要的枝条数。\n\n则最优方案为：$1→2→1→3→1→2→1→3→1→4→1→2→1→4→1$，答案为$40$;\n\n对于$5\\%$的数据，为样例1。\n\n对于$40\\%$的数据，$n\\leq 10,G\\leq 10;w \\leq 1000$\n\n对于$100\\%$的数据，$n\\leq 40,0000,G\\leq 1000;S+T\\leq n;a_{i},b_{i}\\leq 10^{9};w\\leq 10^{9}$\n\n数据保证不会有任意一个叶子节点既需要枝条又有多余枝条。", "locale": "zh-CN"}}}
{"pid": "P5141", "type": "P", "difficulty": 6, "samples": [["5 5\n0 1 0 1 0 \n0 4 5\n0 3 4\n0 0 1\n0 1 2\n4 4 1\n", "POOR AFO!\nPOOR AFO!\n0\n0\n4\n"], ["10 5\n1 1 0 1 1 0 0 1 0 0 \n0 56 7\n30 126 7\n62 116 5\n20 100 1\n8 108 1\n", "POOR AFO!\nPOOR AFO!\nPOOR AFO!\n100\n100\n"], ["5 1\n0 0 0 0 1\n0 999 1", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "进制"], "title": "列队", "background": "本题是数据加强版，弱化版请参考$NOIP2017$   $DAY2$   $T3$\n\n~~好了吓吓你们~~", "description": "前段时间，$k$小$l$参加了$CTYZ$高一的的军训。众所周知，军训的时候需要站方阵。\n\n$k$小$l$ 所在的队伍中有原本有蒟蒻（巨佬）$2*N$个，然而现在的只剩$k$小$l$等少数巨佬和一些蒟蒻了。\n\n巨佬 $dwq$ ：教官我还有今年$IOI$的最后一题没调完，我先回去把题切了。\n\n教官：行，准假，过十分钟调完了就先回去休息吧。\n\n蒟蒻 $yz$ ：教官我今天任务计划里的红题还没做完，我要回去做。\n\n教官：你现在回去也调不出来，乖乖站♂好，不要老是想偷懒。\n\n$k$小$l$是一个热爱学习的男♀孩子，现在他发现，操场上只剩两列队了，原本两列的长度都为$N$，并且这两列队还残缺不全，蒟蒻在第一列，巨佬在第二列，并且如果一行中有巨佬，其气场会导致旁边不敢站蒟蒻。\n\n#### 就算是这样，仅存巨佬们的战斗力还是比蒟蒻们的战斗力大（废话）\n\n在$CTYZ$里面，一列队战斗力值是这样定义的\n\n $Fight=\\sum_{i=0}^{n-1} p_{i}*2^{i}$ \n\n其中$i$为行标号，从$0$开始，$p_{i}=1/0$表示这一行是否有人，\n\n现在$k$小$l$已经知道目前巨佬队伍的站队情况，现在他想问你，蒟蒻们有多少种可能的站队方式。\n\n然而$k$小$l$觉得这样的太简单了，$k$小$l$现在有$M$个询问，每次会给你一个蒟蒻战斗力值范围$[a,b]$和一个$k$，表示他希望知道蒟蒻们的战斗力值在$[a,b]$之间，战斗力值第$k$大的蒟蒻站队方式的战斗力值，如果站队方式总数小于$k$，那么输出$POOR$ $AFO!$。\n\n\n\n\n\n", "inputFormat": "第一行两个个整数$N,M$表示队列有$N$行，$k$小$l$的询问有$M$次。\n\n第二行为一串$01$串，表示巨佬们的站队方式。\n\n接下来$M$行，每行三个数$a_{i},b_{i},k_{i}$，表示$k$小$l$的询问。", "outputFormat": "输出$M$行表示答案，$k$小$l$特别良心，允许你对于这个战斗力取模$20031102$输出。", "hint": "对于$50$%的数据，$N<=20,M<=50$\n\n对于$100$%的数据，$N<=62,M<=500000$\n\n时限很松，请放心食用。", "locale": "zh-CN", "translations": {"en": {"title": "Queue Formation", "background": "This problem is the strengthened version. For the weakened version, please refer to $NOIP2017$ $DAY2$ $T3$.\n\n~~Okay, just to scare you a bit.~~", "description": "Some time ago, $k$-xiao-$l$ joined the military training for Grade 10 at $CTYZ$. As everyone knows, during military training you need to stand in a square formation.\n\nIn the team where $k$-xiao-$l$ is, there were originally $2*N$ people (weak ones and top ones), but now only a few top ones including $k$-xiao-$l$ and some weak ones are left.\n\nTop one $dwq$: Instructor, I still haven't finished debugging the last problem of this year's $IOI$. I'll go back first and solve it.\n\nInstructor: OK, leave approved. If you finish debugging in ten minutes, go back and rest first.\n\nWeak one $yz$: Instructor, I haven't finished the hard problems in today's task plan. I want to go back and do them.\n\nInstructor: Even if you go back now you still can't debug it. Stand properly. Stop trying to slack off.\n\n$k$-xiao-$l$ is a boy who loves learning. Now he finds that there are only two columns left on the playground. Originally, both columns had length $N$, but now they are incomplete. The weak ones stand in the first column, and the top ones stand in the second column. Also, if there is a top one in a row, their presence will make the weak ones in the adjacent position not dare to stand there.\n\n#### Even so, the remaining top ones are still stronger than the weak ones (obviously).\n\nIn $CTYZ$, the fighting value of one column is defined as\n\n$$Fight=\\sum_{i=0}^{n-1} p_{i}*2^{i}$$\n\nwhere $i$ is the row index starting from $0$, and $p_{i}=1/0$ indicates whether there is a person in this row.\n\nNow $k$-xiao-$l$ already knows the current standing situation of the top-one column. He wants to ask you: how many possible standing ways can the weak ones have?\n\nHowever, $k$-xiao-$l$ thinks this is too easy. He now has $M$ queries. Each query gives you a weak-ones fighting value range $[a,b]$ and a $k$, meaning he wants to know: among the weak-ones standing ways whose fighting value is within $[a,b]$, what is the fighting value of the $k$-th largest one. If the total number of standing ways is less than $k$, then output $POOR$ $AFO!$.", "inputFormat": "The first line contains two integers $N,M$, meaning the queue has $N$ rows, and $k$-xiao-$l$ has $M$ queries.\n\nThe second line is a $01$ string, representing the standing way of the top ones.\n\nThe next $M$ lines each contain three numbers $a_{i},b_{i},k_{i}$, representing the queries of $k$-xiao-$l$.", "outputFormat": "Output $M$ lines, each being the answer. $k$-xiao-$l$ is very kind and allows you to output the fighting value modulo $20031102$.", "hint": "For $50\\%$ of the data, $N<=20,M<=50$.\n\nFor $100\\%$ of the data, $N<=62,M<=500000$.\n\nThe time limit is very loose, so feel free to enjoy it.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "列队", "background": "本题是数据加强版，弱化版请参考$NOIP2017$   $DAY2$   $T3$\n\n~~好了吓吓你们~~", "description": "前段时间，$k$小$l$参加了$CTYZ$高一的的军训。众所周知，军训的时候需要站方阵。\n\n$k$小$l$ 所在的队伍中有原本有蒟蒻（巨佬）$2*N$个，然而现在的只剩$k$小$l$等少数巨佬和一些蒟蒻了。\n\n巨佬 $dwq$ ：教官我还有今年$IOI$的最后一题没调完，我先回去把题切了。\n\n教官：行，准假，过十分钟调完了就先回去休息吧。\n\n蒟蒻 $yz$ ：教官我今天任务计划里的红题还没做完，我要回去做。\n\n教官：你现在回去也调不出来，乖乖站♂好，不要老是想偷懒。\n\n$k$小$l$是一个热爱学习的男♀孩子，现在他发现，操场上只剩两列队了，原本两列的长度都为$N$，并且这两列队还残缺不全，蒟蒻在第一列，巨佬在第二列，并且如果一行中有巨佬，其气场会导致旁边不敢站蒟蒻。\n\n#### 就算是这样，仅存巨佬们的战斗力还是比蒟蒻们的战斗力大（废话）\n\n在$CTYZ$里面，一列队战斗力值是这样定义的\n\n $Fight=\\sum_{i=0}^{n-1} p_{i}*2^{i}$ \n\n其中$i$为行标号，从$0$开始，$p_{i}=1/0$表示这一行是否有人，\n\n现在$k$小$l$已经知道目前巨佬队伍的站队情况，现在他想问你，蒟蒻们有多少种可能的站队方式。\n\n然而$k$小$l$觉得这样的太简单了，$k$小$l$现在有$M$个询问，每次会给你一个蒟蒻战斗力值范围$[a,b]$和一个$k$，表示他希望知道蒟蒻们的战斗力值在$[a,b]$之间，战斗力值第$k$大的蒟蒻站队方式的战斗力值，如果站队方式总数小于$k$，那么输出$POOR$ $AFO!$。\n\n\n\n\n\n", "inputFormat": "第一行两个个整数$N,M$表示队列有$N$行，$k$小$l$的询问有$M$次。\n\n第二行为一串$01$串，表示巨佬们的站队方式。\n\n接下来$M$行，每行三个数$a_{i},b_{i},k_{i}$，表示$k$小$l$的询问。", "outputFormat": "输出$M$行表示答案，$k$小$l$特别良心，允许你对于这个战斗力取模$20031102$输出。", "hint": "对于$50$%的数据，$N<=20,M<=50$\n\n对于$100$%的数据，$N<=62,M<=500000$\n\n时限很松，请放心食用。", "locale": "zh-CN"}}}
{"pid": "P5142", "type": "P", "difficulty": 5, "samples": [["4 8\n0 0 0 0\n1 1 1\n1 2 2\n1 3 3\n1 4 4\n2 1 1\n2 1 2\n2 1 3\n2 1 4", "0\n250000002\n666666672\n250000003"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "线段树", "树状数组", "洛谷原创", "洛谷比赛"], "title": "区间方差", "background": "出题人并没有能力写有趣的题面……\n", "description": "对于一个长度为 $n$ 的序列 $a_1,a_2,a_3\\cdots a_n$，我们定义它的平均数 $a$ 为:\n\n$$a=\\frac{1}{n}\\sum_{i=1}^{n}a_i$$\n\n并定义它的方差 $d$ 为:\n\n$$d=\\frac{1}{n}\\sum_{i=1}^{n}(a_i-a)^2$$\n\n现在给定一个长度为 $n$ 的序列 $b_1,b_2\\cdots b_n$。你需要支持两种操作。每种操作的格式为 `c x y`。\n\n若 $c=1$，为修改操作，代表将 $b_x$ 赋值为 $y$。\n\n若 $c=2$，为查询操作，代表查询 $b_x$ 到 $b_y$ 的方差。\n\n为了避免浮点数误差，请以分数取模形式输出结果（对 $1000000007$（$10^9+7$）取模）。", "inputFormat": "第一行两个整数 $n,m$，代表序列 $b$ 的长度为 $n$，有 $m$ 个操作。\n\n第二行 $n$ 个整数 $b_i$，表示序列 $b$ 的初始值。\n\n下面有 $m$ 行整数，每行格式为 `c x y`，含义如上文所示。保证所有操作合法。", "outputFormat": "对于每个操作 2，输出一行。\n", "hint": "#### 样例 1 解释\n四次修改后，序列 $b$ 为：$\\{1,2,3,4\\}$。\n\n区间 $[1,1]$ 的方差为 $0$。\n\n区间 $[1,2]$ 的方差为 $\\frac{1}{4}$ 。$4$ 的逆元为 $250000002$。\n\n区间 $[1,3]$ 的方差为 $\\frac{2}{3}$。$3$ 的逆元为 $333333336$，$2\\times333333336\\bmod M=666666672$。\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，$n\\leq 1000$，$m\\leq 1000$。\n- 对于 $100\\%$ 的数据，$1\\leq n,m\\leq 1\\times 10^5$，$0\\leq b_i\\leq 1\\times 10^9$，$1\\leq x\\leq n$。对于操作 1，$0\\leq y\\leq 1\\times 10^9$。对于操作2，$x\\leq y\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "Interval Variance", "background": "The problem setter is not able to write an interesting statement...", "description": "For a sequence of length $n$, $a_1,a_2,a_3\\cdots a_n$, we define its mean $a$ as:\n$$a=\\frac{1}{n}\\sum_{i=1}^{n}a_i$$\nand define its variance $d$ as:\n$$d=\\frac{1}{n}\\sum_{i=1}^{n}(a_i-a)^2$$\n\nNow you are given a sequence $b_1,b_2\\cdots b_n$ of length $n$. You need to support two operations. Each operation has the format `c x y`.\n\nIf $c=1$, it is an update: set $b_x$ to $y$.\n\nIf $c=2$, it is a query: compute the variance of $b_x$ through $b_y$ (inclusive).\n\nTo avoid floating-point errors, output the result as a fraction modulo (mod $1000000007$ ($10^9+7$)).", "inputFormat": "The first line contains two integers $n,m$, meaning the sequence $b$ has length $n$ and there are $m$ operations.\n\nThe second line contains $n$ integers $b_i$, representing the initial values of sequence $b$.\n\nThen there are $m$ lines, each in the format `c x y`, with meanings as described above. All operations are guaranteed to be valid.", "outputFormat": "For each operation $2$, output one line.", "hint": "#### Explanation for Sample 1\nAfter four updates, the sequence $b$ is: $\\{1,2,3,4\\}$.\n\nThe variance of interval $[1,1]$ is $0$.\n\nThe variance of interval $[1,2]$ is $\\frac{1}{4}$. The modular inverse of $4$ is $250000002$.\n\nThe variance of interval $[1,3]$ is $\\frac{2}{3}$. The modular inverse of $3$ is $333333336$, and $2\\times333333336\\bmod M=666666672$.\n\n#### Constraints\n\n- For $50\\%$ of the testdata, $n\\leq 1000$, $m\\leq 1000$.\n- For $100\\%$ of the testdata, $1\\leq n,m\\leq 1\\times 10^5$, $1\\leq b_i\\leq 1\\times 10^9$, $1\\leq x\\leq n$. For operation $1$, $1\\leq y\\leq 1\\times 10^9$. For operation $2$, $x\\leq y\\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "区间方差", "background": "出题人并没有能力写有趣的题面……\n", "description": "对于一个长度为 $n$ 的序列 $a_1,a_2,a_3\\cdots a_n$，我们定义它的平均数 $a$ 为:\n\n$$a=\\frac{1}{n}\\sum_{i=1}^{n}a_i$$\n\n并定义它的方差 $d$ 为:\n\n$$d=\\frac{1}{n}\\sum_{i=1}^{n}(a_i-a)^2$$\n\n现在给定一个长度为 $n$ 的序列 $b_1,b_2\\cdots b_n$。你需要支持两种操作。每种操作的格式为 `c x y`。\n\n若 $c=1$，为修改操作，代表将 $b_x$ 赋值为 $y$。\n\n若 $c=2$，为查询操作，代表查询 $b_x$ 到 $b_y$ 的方差。\n\n为了避免浮点数误差，请以分数取模形式输出结果（对 $1000000007$（$10^9+7$）取模）。", "inputFormat": "第一行两个整数 $n,m$，代表序列 $b$ 的长度为 $n$，有 $m$ 个操作。\n\n第二行 $n$ 个整数 $b_i$，表示序列 $b$ 的初始值。\n\n下面有 $m$ 行整数，每行格式为 `c x y`，含义如上文所示。保证所有操作合法。", "outputFormat": "对于每个操作 2，输出一行。\n", "hint": "#### 样例 1 解释\n四次修改后，序列 $b$ 为：$\\{1,2,3,4\\}$。\n\n区间 $[1,1]$ 的方差为 $0$。\n\n区间 $[1,2]$ 的方差为 $\\frac{1}{4}$ 。$4$ 的逆元为 $250000002$。\n\n区间 $[1,3]$ 的方差为 $\\frac{2}{3}$。$3$ 的逆元为 $333333336$，$2\\times333333336\\bmod M=666666672$。\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，$n\\leq 1000$，$m\\leq 1000$。\n- 对于 $100\\%$ 的数据，$1\\leq n,m\\leq 1\\times 10^5$，$0\\leq b_i\\leq 1\\times 10^9$，$1\\leq x\\leq n$。对于操作 1，$0\\leq y\\leq 1\\times 10^9$。对于操作2，$x\\leq y\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5143", "type": "P", "difficulty": 2, "samples": [["5\n2 2 2\n1 1 1\n4 4 4\n3 3 3\n5 5 5\n", "6.928"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "排序", "洛谷比赛"], "title": "攀爬者", "background": "HKE 考完 GDOI 之后跟他的神犇小伙伴们一起去爬山。", "description": "HKE 在地形图上标记了 $N$ 个点，每个点 $P_i$ 都有一个坐标 $(x_i,y_i,z_i)$，且在所有点对中，高度值 $z$ 不会相等。HKE 准备从最低的点爬到最高的点，他的攀爬满足以下条件：\n\n1. 经过他标记的每一个点；\n2. 从第二个点开始，他经过的每一个点高度 $z$ 都比上一个点高；\n3. HKE 会飞，他从一个点 $P_i$ 爬到 $P_j$ 的距离为两个点的欧几里得距离，即 $\\sqrt{(X_i-X_j)^2+(Y_i-Y_j)^2+(Z_i-Z_j)^2}$。\n\n现在，HKE 希望你能求出他攀爬的总距离。", "inputFormat": "第一行，一个整数 $N$ 表示地图上的点数。\n\n接下来 $N$ 行，每行三个整数 $x_i,y_i,z_i$，表示第 $i$ 个点的坐标。", "outputFormat": "一个实数，表示 HKE 需要攀爬的总距离（保留三位小数）。", "hint": "对于 $100\\%$ 的数据，$1\\leq N\\leq 50000$，答案在 `double` 类型的表示范围内。", "locale": "zh-CN", "translations": {"en": {"title": "Climber", "background": "After finishing GDOI, HKE went to climb a mountain with his \"shenben\" friends.", "description": "He marked $N$ points on a topographic map, where each point $P_i$ has coordinates $(x_i, y_i, z_i)$. Among all points, the height values $z$ are pairwise distinct. HKE plans to climb from the lowest point to the highest point, and his climbing satisfies the following conditions:\n\n(1) He visits every point he marked.\n\n(2) Starting from the second point, the height $z$ of each visited point is higher than that of the previous point.\n\n(3) HKE can fly. The distance he travels from a point $P_i$ to $P_j$ is the Euclidean distance between the two points, i.e., $\\sqrt{(X_i-X_j)^2+(Y_i-Y_j)^2+(Z_i-Z_j)^2}$.\n\nNow, HKE wants you to compute the total distance of his climb.", "inputFormat": "The first line contains an integer $N$ indicating the number of points on the map.\n\nEach of the next $N$ lines contains three integers $x_i, y_i, z_i$, representing the coordinates of the $i$-th point.", "outputFormat": "Output a real number representing the total distance HKE needs to climb (rounded to three decimal places).", "hint": "For 100% of the testdata, $1\\leq N\\leq 50000$, and the answer is within the range of a double.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "攀爬者", "background": "HKE 考完 GDOI 之后跟他的神犇小伙伴们一起去爬山。", "description": "HKE 在地形图上标记了 $N$ 个点，每个点 $P_i$ 都有一个坐标 $(x_i,y_i,z_i)$，且在所有点对中，高度值 $z$ 不会相等。HKE 准备从最低的点爬到最高的点，他的攀爬满足以下条件：\n\n1. 经过他标记的每一个点；\n2. 从第二个点开始，他经过的每一个点高度 $z$ 都比上一个点高；\n3. HKE 会飞，他从一个点 $P_i$ 爬到 $P_j$ 的距离为两个点的欧几里得距离，即 $\\sqrt{(X_i-X_j)^2+(Y_i-Y_j)^2+(Z_i-Z_j)^2}$。\n\n现在，HKE 希望你能求出他攀爬的总距离。", "inputFormat": "第一行，一个整数 $N$ 表示地图上的点数。\n\n接下来 $N$ 行，每行三个整数 $x_i,y_i,z_i$，表示第 $i$ 个点的坐标。", "outputFormat": "一个实数，表示 HKE 需要攀爬的总距离（保留三位小数）。", "hint": "对于 $100\\%$ 的数据，$1\\leq N\\leq 50000$，答案在 `double` 类型的表示范围内。", "locale": "zh-CN"}}}
{"pid": "P5144", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2 3 4 5\n", "15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "洛谷原创", "洛谷比赛"], "title": "蜈蚣", "background": "一群人在山上遇见了一条蜈蚣。", "description": "在一条山路的转角处，WYH 发现了一条有中指一样粗的有 $N$ 节的蜈蚣。这只蜈蚣马上就吸引了 HKE 的眼球，HKE 深深地爱上了这条魔性的蜈蚣。它的很多对足在前进的时候像波浪一样，颇是有毒。\n\n但是，热爱解剖动物的 MZL 却准备把蜈蚣切了。HKE 很失落，于是 MZL 承诺不会完全肢解它，只把它的 $N$ 节切成 $M$ 段，每一段包含原蜈蚣完整的一节或多节。\n\nHKE 看到他心爱的蜈蚣会切掉是会觉得恶心的。蜈蚣的每一节都有一个权值 $W_i$，切下来的一段 $(W_i, W_{i + 1}, \\ldots, W_j)$ 带给 HKE 的恶心值是 $W_i \\mathbin{\\mathrm{xor}} W_{i + 1} \\mathbin{\\mathrm{xor}} \\cdots \\mathbin{\\mathrm{xor}} W_j$，这里的 $\\mathbin{\\mathrm{xor}}$ 代表按位异或操作。邪恶的 LJC 希望 HKE 受到的总恶心值 —— 也就是每一段子蜈蚣带给 HKE 的恶心值的和最大，请你求出 HKE 的最大恶心值。\n\n（注：按位异或，其运算符号在 Pascal 中为 `xor`，在 C++ 中为 `^` 或 `xor`；请注意加法与异或运算的优先级先后顺序）", "inputFormat": "第一行，两个整数 $N, M$，表示蜈蚣长 $N$ 节，切成 $M$ 段。\n\n第二行 $N$ 个整数用空格分开，表示蜈蚣每一节的权值 $W_1, W_2, \\ldots, W_n$。", "outputFormat": "一个整数表示最大恶心值。", "hint": "**【样例解释 \\#1】**\n\n第一段的恶心值为 $1 \\mathbin{\\mathrm{xor}} 2 = 3$。\n\n第二段的恶心值为 $3 \\mathbin{\\mathrm{xor}} 4 = 7$\n\n第三段的恶心值为 $5$\n\n总恶心值为 $3 + 7 + 5 = 15$。此时为最优解。\n\n**【数据范围】**\n\n对于 $30 \\%$ 的数据，$1 \\le N \\le 100$，$1 \\le M \\le 10$；\n\n对于 $100 \\%$ 的数据，$1 \\le N \\le 1000$，$1 \\le M \\le 100$，保证结果在 $2^{30} - 1$ 内；\n", "locale": "zh-CN", "translations": {"en": {"title": "Centipede", "background": "A group of people encountered a centipede on a mountain.", "description": "At a turn on a mountain path, WYH found a centipede as thick as a middle finger with $N$ segments. This centipede immediately caught HKE's eye, and HKE fell deeply in love with this uncanny centipede. Many pairs of its legs move like waves when it crawls.\n\nHowever, MZL, who loves dissecting animals, planned to cut the centipede. HKE felt upset, so MZL promised not to dismember it completely, but to cut its $N$ segments into $M$ parts, each part containing one or more consecutive original segments.\n\nHKE feels sick when he sees his beloved centipede being cut. Each segment has a weight $W_i$. The nausea value of a cut part $(W_i, W_{i + 1}, \\ldots, W_j)$ is $W_i \\mathbin{\\mathrm{xor}} W_{i + 1} \\mathbin{\\mathrm{xor}} \\cdots \\mathbin{\\mathrm{xor}} W_j$, where $\\mathbin{\\mathrm{xor}}$ denotes the bitwise XOR operation. The evil LJC wants the total nausea value — that is, the sum of the nausea values of all parts — to be as large as possible. Please compute the maximum total nausea value that HKE can suffer.\n\n(Note: For bitwise XOR, the operator is `xor` in Pascal, and `^` or `xor` in C++. Please pay attention to the precedence between addition and XOR operations.).", "inputFormat": "The first line contains two integers $N, M$, meaning the centipede has $N$ segments and will be cut into $M$ parts.\n\nThe second line contains $N$ integers separated by spaces, representing the weights $W_1, W_2, \\ldots, W_N$ of the segments.", "outputFormat": "Output a single integer, the maximum total nausea value.", "hint": "[Sample Explanation #1]\n\nThe nausea value of the first part is $1 \\mathbin{\\mathrm{xor}} 2 = 3$.\n\nThe nausea value of the second part is $3 \\mathbin{\\mathrm{xor}} 4 = 7$.\n\nThe nausea value of the third part is $5$.\n\nThe total nausea value is $3 + 7 + 5 = 15$. This is optimal.\n\n[Constraints]\n\nFor $30\\%$ of the testdata, $1 \\le N \\le 100$, $1 \\le M \\le 10$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 1000$, $1 \\le M \\le 100$, and the result is guaranteed to be within $2^{30} - 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "蜈蚣", "background": "一群人在山上遇见了一条蜈蚣。", "description": "在一条山路的转角处，WYH 发现了一条有中指一样粗的有 $N$ 节的蜈蚣。这只蜈蚣马上就吸引了 HKE 的眼球，HKE 深深地爱上了这条魔性的蜈蚣。它的很多对足在前进的时候像波浪一样，颇是有毒。\n\n但是，热爱解剖动物的 MZL 却准备把蜈蚣切了。HKE 很失落，于是 MZL 承诺不会完全肢解它，只把它的 $N$ 节切成 $M$ 段，每一段包含原蜈蚣完整的一节或多节。\n\nHKE 看到他心爱的蜈蚣会切掉是会觉得恶心的。蜈蚣的每一节都有一个权值 $W_i$，切下来的一段 $(W_i, W_{i + 1}, \\ldots, W_j)$ 带给 HKE 的恶心值是 $W_i \\mathbin{\\mathrm{xor}} W_{i + 1} \\mathbin{\\mathrm{xor}} \\cdots \\mathbin{\\mathrm{xor}} W_j$，这里的 $\\mathbin{\\mathrm{xor}}$ 代表按位异或操作。邪恶的 LJC 希望 HKE 受到的总恶心值 —— 也就是每一段子蜈蚣带给 HKE 的恶心值的和最大，请你求出 HKE 的最大恶心值。\n\n（注：按位异或，其运算符号在 Pascal 中为 `xor`，在 C++ 中为 `^` 或 `xor`；请注意加法与异或运算的优先级先后顺序）", "inputFormat": "第一行，两个整数 $N, M$，表示蜈蚣长 $N$ 节，切成 $M$ 段。\n\n第二行 $N$ 个整数用空格分开，表示蜈蚣每一节的权值 $W_1, W_2, \\ldots, W_n$。", "outputFormat": "一个整数表示最大恶心值。", "hint": "**【样例解释 \\#1】**\n\n第一段的恶心值为 $1 \\mathbin{\\mathrm{xor}} 2 = 3$。\n\n第二段的恶心值为 $3 \\mathbin{\\mathrm{xor}} 4 = 7$\n\n第三段的恶心值为 $5$\n\n总恶心值为 $3 + 7 + 5 = 15$。此时为最优解。\n\n**【数据范围】**\n\n对于 $30 \\%$ 的数据，$1 \\le N \\le 100$，$1 \\le M \\le 10$；\n\n对于 $100 \\%$ 的数据，$1 \\le N \\le 1000$，$1 \\le M \\le 100$，保证结果在 $2^{30} - 1$ 内；\n", "locale": "zh-CN"}}}
{"pid": "P5145", "type": "P", "difficulty": 3, "samples": [["6\n2 1\n3 2\n1 3\n5 2\n6 2\n4 2\n", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索"], "title": "漂浮的鸭子", "background": null, "description": "下雨时地上会有一个个水坑，但一个水坑只会流向另一个特定的水坑，而且水不会回流。可能会有多个水坑同时流向一个水坑。这天又下起了雨夹鸭，每个水坑里都漂浮着一只鸭子。WYH 在每个水坑旁派遣了一个特派员，特派员会在鸭子上做记号。在某一时刻，全部鸭子开始顺水漂浮，同时特派员开始计时。当某个特派员发现他做的那个记号的鸭子漂浮回来的时候，他就会停止计时，把时间上报给 WYH。现在 WYH 探勘了地形后把每段水流的关系与时间告诉了你，他想知道他所获得的所有数据中最大的那个是？", "inputFormat": "第一行一个正整数 $n$，代表有 $n$ 个水坑（从 $1$ 到 $n$ 编号）。\n\n第 $2 \\sim n+1 $ 行每行两个正整数，其中第 $i+1$ 行的两个整数为 $D_i$ 与 $T_i$，代表第 $i$ 号水坑的水会流向 $D_i$ 号坑，流动所需时间为 $T_i$。保证 $D_i \\neq i$。", "outputFormat": "一个整数，代表 WYH 手上获得的特派员数据中最大的那个数。", "hint": "$30\\%$ 的数据保证 $n \\leq 100$；\n\n$100\\%$ 的数据保证 $n \\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Floating Ducks", "background": "", "description": "When it rains, puddles form on the ground. Each puddle flows to exactly one specific other puddle, and the flow is one-way (no backflow). Multiple puddles may flow into the same puddle. On this day, it started to rain \"mixed with ducks\", and there is a duck floating in every puddle. WYH dispatches an agent beside every puddle, and each agent marks the duck in his puddle. At a certain moment, all ducks start drifting along with the water simultaneously, and all agents start timing. When an agent sees the duck he marked drift back, he stops timing and reports the time to WYH. After surveying the terrain, WYH tells you the flow relation and travel time for every segment, and he wants to know the maximum among all the numbers he obtained.", "inputFormat": "The first line contains a positive integer $n$, meaning there are $n$ puddles (numbered from $1$ to $n$).\n\nLines $2 \\sim n+1$ each contain two positive integers. On line $i+1$, the two integers are $D_i$ and $T_i$, meaning the water of puddle $i$ flows to puddle $D_i$, and the flow takes time $T_i$. It is guaranteed that $D_i \\neq i$.", "outputFormat": "Output a single integer, the maximum among the agent-reported times that WYH has.", "hint": "For $30\\%$ of the testdata, $n \\leq 100$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "漂浮的鸭子", "background": null, "description": "下雨时地上会有一个个水坑，但一个水坑只会流向另一个特定的水坑，而且水不会回流。可能会有多个水坑同时流向一个水坑。这天又下起了雨夹鸭，每个水坑里都漂浮着一只鸭子。WYH 在每个水坑旁派遣了一个特派员，特派员会在鸭子上做记号。在某一时刻，全部鸭子开始顺水漂浮，同时特派员开始计时。当某个特派员发现他做的那个记号的鸭子漂浮回来的时候，他就会停止计时，把时间上报给 WYH。现在 WYH 探勘了地形后把每段水流的关系与时间告诉了你，他想知道他所获得的所有数据中最大的那个是？", "inputFormat": "第一行一个正整数 $n$，代表有 $n$ 个水坑（从 $1$ 到 $n$ 编号）。\n\n第 $2 \\sim n+1 $ 行每行两个正整数，其中第 $i+1$ 行的两个整数为 $D_i$ 与 $T_i$，代表第 $i$ 号水坑的水会流向 $D_i$ 号坑，流动所需时间为 $T_i$。保证 $D_i \\neq i$。", "outputFormat": "一个整数，代表 WYH 手上获得的特派员数据中最大的那个数。", "hint": "$30\\%$ 的数据保证 $n \\leq 100$；\n\n$100\\%$ 的数据保证 $n \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5146", "type": "P", "difficulty": 2, "samples": [["10\n1\n3\n4\n6\n7\n9\n10\n1\n2\n9", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["枚举"], "title": "最大差值", "background": "", "description": "HKE 最近热衷于研究序列，有一次他发现了一个有趣的问题：\n\n对于一个序列 $A_1,A_2,\\cdots,A_n$，找出两个数 $i,j$（$1\\le i<j\\le n$），使得 $A_j-A_i$ 最大。\n\n现在给出这个序列，请找出 $A_j-A_i$ 的最大值。", "inputFormat": "第一行为一个正整数 $n$。  \n\n接下来 $n$ 行，每行一个整数，第 $(i + 1)$ 行的整数为 $A_i$。", "outputFormat": "一行，为 $A_j-A_i$ 的最大值。\n", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，$n\\le1000$；\n- 对于 $70\\%$ 的数据，$n\\le10^5$；\n- 对于 $100\\%$ 的数据：$2\\le n\\le 10^6$，$A_i$ 在 int 范围内。", "locale": "zh-CN", "translations": {"en": {"title": "Maximum Difference", "background": "", "description": "HKE has recently been keen on studying sequences, and once he discovered an interesting problem:\n\nFor a sequence $A_1,A_2,\\cdots,A_n$, find two indices $i, j$ ($1\\le i<j\\le n$) such that $A_j-A_i$ is maximized.\n\nGiven this sequence, please find the maximum value of $A_j-A_i$.", "inputFormat": "The first line contains a positive integer $n$.\nThe next $n$ lines each contain one integer. The integer on the $(i + 1)$-th line is $A_i$.", "outputFormat": "One line, the maximum value of $A_j-A_i$.", "hint": "#### Constraints\n\n- For $30\\%$ of the testdata, $n\\le1000$.\n- For $70\\%$ of the testdata, $n\\le10^5$.\n- For $100\\%$ of the testdata: $2\\le n\\le 10^6$, and $A_i$ is within the int range.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最大差值", "background": "", "description": "HKE 最近热衷于研究序列，有一次他发现了一个有趣的问题：\n\n对于一个序列 $A_1,A_2,\\cdots,A_n$，找出两个数 $i,j$（$1\\le i<j\\le n$），使得 $A_j-A_i$ 最大。\n\n现在给出这个序列，请找出 $A_j-A_i$ 的最大值。", "inputFormat": "第一行为一个正整数 $n$。  \n\n接下来 $n$ 行，每行一个整数，第 $(i + 1)$ 行的整数为 $A_i$。", "outputFormat": "一行，为 $A_j-A_i$ 的最大值。\n", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，$n\\le1000$；\n- 对于 $70\\%$ 的数据，$n\\le10^5$；\n- 对于 $100\\%$ 的数据：$2\\le n\\le 10^6$，$A_i$ 在 int 范围内。", "locale": "zh-CN"}}}
{"pid": "P5147", "type": "P", "difficulty": 5, "samples": [["2", "2.00000"], ["3", "2.50000"], ["100000", "13.09014"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递推"], "title": "随机数生成器", "background": "", "description": "HKE最近编写了一个函数 $\\text{rand}(l,r)$，其中 $l,r$ 为正整数且 $l \\le r$。这个函数会等概率返回区间 $[l,r]$ 中任意一个正整数。然后，他又编写了一个函数：\n\n```cpp\nint work(int x){\n    if(x==1) return 0;\n    else return work(rand(1,x))+1;\n}\n```\n这段代码用pascal写起来就是：\n```pascal\nfunction work(x:integer):integer;\nbegin\n    if x=1 then exit(0);\n    else exit(work(rand(1,x))+1);\nend;\n```\n现在给定一个正整数 $n$，请问 $\\text{work}(n)$ 的返回值的期望值是多少？\n\n期望的定义：假设 $\\text{work}(n)$ 返回的所有可能的值为 $x_1,x_2,\\dots ,x_k$，它们出现的概率分别为 $p_1,p_2,\\dots,p_k$，则期望为：\n\n$$\\mathbb{E}=\\sum_{i=1}^{k}x_i p_i$$\n", "inputFormat": "一个正整数 $n$\n", "outputFormat": "一个实数，表示 $\\text{work}(n)$ 的期望值。保留 $5$ 位小数。\n", "hint": "【样例 $1$ 解释】  \n$\\text{work}(2)$ 有 $1/2$ 的概率返回 $1$，有 $1/4$ 的概率返回 $2$，有 $1/8$ 的概率返回 $3$ ……  \n则期望为 $1/2+2/4+3/8+ \\dots =2$\n\n【数据范围】  \n对于 $30\\%$ 的数据，$n \\le 9$；  \n对于 $50\\%$ 的数据，$n \\le 1000$；  \n对于 $70\\%$ 的数据，$n \\le 1000000$；  \n对于 $100\\%$ 的数据，$1\\le n < 2^{31}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Random Number Generator", "background": "", "description": "HKE recently wrote a function $\\text{rand}(l,r)$, where $l,r$ are positive integers and $l \\le r$. This function returns, with equal probability, any positive integer in the interval $[l, r]$. Then he wrote another function:\n\n```cpp\nint work(int x){\n    if(x==1) return 0;\n    else return work(rand(1,x))+1;\n}\n```\nIn Pascal, this code is:\n```pascal\nfunction work(x:integer):integer;\nbegin\n    if x=1 then exit(0);\n    else exit(work(rand(1,x))+1);\nend;\n```\nGiven a positive integer $n$, what is the expected value of the return value of $\\text{work}(n)$?\n\nDefinition of expectation: Suppose all possible return values of $\\text{work}(n)$ are $x_1, x_2, \\dots , x_k$ with probabilities $p_1, p_2, \\dots, p_k$, then the expectation is:\n$$\\mathbb{E}=\\sum_{i=1}^{k}x_i p_i.$$", "inputFormat": "A positive integer $n$.", "outputFormat": "A real number representing the expected value of $\\text{work}(n)$. Keep $5$ decimal places.", "hint": "[Sample 1 Explanation]  \n$\\text{work}(2)$ returns $1$ with probability $1/2$, returns $2$ with probability $1/4$, returns $3$ with probability $1/8$, and so on.  \nTherefore, the expectation is $1/2+2/4+3/8+\\dots=2$.\n\nConstraints  \nFor $30\\%$ of the testdata, $n \\le 9$;  \nFor $50\\%$ of the testdata, $n \\le 1000$;  \nFor $70\\%$ of the testdata, $n \\le 1000000$;  \nFor $100\\%$ of the testdata, $1 \\le n < 2^{31}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "随机数生成器", "background": "", "description": "HKE最近编写了一个函数 $\\text{rand}(l,r)$，其中 $l,r$ 为正整数且 $l \\le r$。这个函数会等概率返回区间 $[l,r]$ 中任意一个正整数。然后，他又编写了一个函数：\n\n```cpp\nint work(int x){\n    if(x==1) return 0;\n    else return work(rand(1,x))+1;\n}\n```\n这段代码用pascal写起来就是：\n```pascal\nfunction work(x:integer):integer;\nbegin\n    if x=1 then exit(0);\n    else exit(work(rand(1,x))+1);\nend;\n```\n现在给定一个正整数 $n$，请问 $\\text{work}(n)$ 的返回值的期望值是多少？\n\n期望的定义：假设 $\\text{work}(n)$ 返回的所有可能的值为 $x_1,x_2,\\dots ,x_k$，它们出现的概率分别为 $p_1,p_2,\\dots,p_k$，则期望为：\n\n$$\\mathbb{E}=\\sum_{i=1}^{k}x_i p_i$$\n", "inputFormat": "一个正整数 $n$\n", "outputFormat": "一个实数，表示 $\\text{work}(n)$ 的期望值。保留 $5$ 位小数。\n", "hint": "【样例 $1$ 解释】  \n$\\text{work}(2)$ 有 $1/2$ 的概率返回 $1$，有 $1/4$ 的概率返回 $2$，有 $1/8$ 的概率返回 $3$ ……  \n则期望为 $1/2+2/4+3/8+ \\dots =2$\n\n【数据范围】  \n对于 $30\\%$ 的数据，$n \\le 9$；  \n对于 $50\\%$ 的数据，$n \\le 1000$；  \n对于 $70\\%$ 的数据，$n \\le 1000000$；  \n对于 $100\\%$ 的数据，$1\\le n < 2^{31}$。\n", "locale": "zh-CN"}}}
{"pid": "P5148", "type": "P", "difficulty": 4, "samples": [["10 3 3 2\n1 3 3 1", "3240"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "组合数学", "逆元"], "title": "大循环", "background": "", "description": "hke 有一天学会了循环语句，感到很神奇。回到家，他用 C++ 写下这段代码：\n\n```cpp\nvoid work()\n{\n  ans=0;\n    for(a[1]=1;a[1]<=n;++a[1])\n      for(a[2]=1;a[2]<a[1];++a[2])\n        for(a[3]=1;a[3]<a[2];++a[3])\n          //......\n            for(a[k]=1;a[k]<a[k-1];++a[k])\n              ans+=f(q);\n  cout<<ans;\n}\n```\n其中，$q$ 是给定的常数，$f(x)$ 是一个关于 $x$ 的 $m$ 次多项式，它的表达式为：\n\n$$f(x) = a _ m x ^ m + a _ {m - 1} x ^ {m - 1} + \\cdots + a _ 1 x + a _ 0$$\n\nhke 迫不及待地开始运行这个程序，但程序运行得实在太慢了。于是他找到了你，想知道这段程序输出的结果是？答案可能很大，你只需输出其对 $10^9+7$ 取模的结果即可。假设运算过程中不存在溢出。\n", "inputFormat": "第一行 $4$ 个正整数，分别为 $n,m,k,q$；\n\n第二行 $m+1$ 个正整数，分别为 $a_0,a_1,a_2\\cdots a_m$；\n", "outputFormat": "一个数，表示程序运行结果对 $10^9+7$ 取模的结果。\n", "hint": "对于 $10\\%$ 的数据有 $n \\le 10$；\n\n对于 $30\\%$ 的数据有 $n \\le 1000,m \\le 1000$；\n\n对于 $100\\%$ 的数据保证 $n \\le 500000, m \\le 500000, 1≤k≤n,q≤10^{18},1≤a _ i≤10000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Big Loop", "background": "", "description": "hke learned loop statements one day and found them amazing. Back home, he wrote the following code in C++:\n\n```cpp\nvoid work()\n{\n  ans=0;\n    for(a[1]=1;a[1]<=n;++a[1])\n      for(a[2]=1;a[2]<a[1];++a[2])\n        for(a[3]=1;a[3]<a[2];++a[3])\n          //......\n            for(a[k]=1;a[k]<a[k-1];++a[k])\n              ans+=f(q);\n  cout<<ans;\n}\n```\nHere, $q$ is a given constant, and $f(x)$ is a degree $m$ polynomial in $x$, whose expression is:\n\n$$f(x) = a _ m x ^ m + a _ {m - 1} x ^ {m - 1} + \\cdots + a _ 1 x + a _ 0$$\n\nhke could not wait to run this program, but it was far too slow. So he came to you and wanted to know what the program outputs. The answer can be very large; you only need to output it modulo $10^9+7$. Assume there is no overflow during the computation.", "inputFormat": "The first line contains 4 positive integers $n, m, k, q$.\n\nThe second line contains $m + 1$ positive integers, namely $a_0, a_1, a_2 \\cdots a_m$.", "outputFormat": "A single integer, representing the program’s result modulo $10^9+7$.", "hint": "- For $10\\%$ of the testdata, $n \\le 10$.\n- For $30\\%$ of the testdata, $n \\le 1000, m \\le 1000$.\n- For $100\\%$ of the testdata, it is guaranteed that $n \\le 500000, m \\le 500000, 1 \\le k \\le n, q \\le 10^{18}, 1 \\le a_i \\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "大循环", "background": "", "description": "hke 有一天学会了循环语句，感到很神奇。回到家，他用 C++ 写下这段代码：\n\n```cpp\nvoid work()\n{\n  ans=0;\n    for(a[1]=1;a[1]<=n;++a[1])\n      for(a[2]=1;a[2]<a[1];++a[2])\n        for(a[3]=1;a[3]<a[2];++a[3])\n          //......\n            for(a[k]=1;a[k]<a[k-1];++a[k])\n              ans+=f(q);\n  cout<<ans;\n}\n```\n其中，$q$ 是给定的常数，$f(x)$ 是一个关于 $x$ 的 $m$ 次多项式，它的表达式为：\n\n$$f(x) = a _ m x ^ m + a _ {m - 1} x ^ {m - 1} + \\cdots + a _ 1 x + a _ 0$$\n\nhke 迫不及待地开始运行这个程序，但程序运行得实在太慢了。于是他找到了你，想知道这段程序输出的结果是？答案可能很大，你只需输出其对 $10^9+7$ 取模的结果即可。假设运算过程中不存在溢出。\n", "inputFormat": "第一行 $4$ 个正整数，分别为 $n,m,k,q$；\n\n第二行 $m+1$ 个正整数，分别为 $a_0,a_1,a_2\\cdots a_m$；\n", "outputFormat": "一个数，表示程序运行结果对 $10^9+7$ 取模的结果。\n", "hint": "对于 $10\\%$ 的数据有 $n \\le 10$；\n\n对于 $30\\%$ 的数据有 $n \\le 1000,m \\le 1000$；\n\n对于 $100\\%$ 的数据保证 $n \\le 500000, m \\le 500000, 1≤k≤n,q≤10^{18},1≤a _ i≤10000$。\n", "locale": "zh-CN"}}}
{"pid": "P5149", "type": "P", "difficulty": 3, "samples": [["3\nStan Kyle Kenny\nKyle Stan Kenny", "1"], ["5\nA B C D E\nB A D E C", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["树状数组", "排序", "哈希 hashing", "字典树 Trie"], "title": "会议座位", "background": "话说校长最近很喜欢召开全校教职工大会，让老师们强行听他装逼\n", "description": "现在校长在校园网上公布了一份座位表，$n$ 位老师从左到右依次排成一行。老师们都对这个座位很满意。\n\n然而到了开会时，校长不小心把座位表打乱了，老师们很不满。老师们并不在意自己的位置变了多少，但如果有一对老师 $a$ 和 $b$，他们原来的座位是 $a$ 在 $b$ 左边，现在变成了 $a$ 在 $b$ 右边，那么这一对老师便会贡献一单位不满值。\n\n校长想知道这些老师的总不满值是多少。", "inputFormat": "第一行一个正整数 $n$，为 $n$ 位老师。\n\n第二行有 $n$ 个字符串，每个字符串代表老师的名字（大小写敏感）。这一行代表原来的座位表。\n\n第三行有 $n$ 个字符串，代表打乱后的座位表。", "outputFormat": "一行，一个正整数，表示老师们的总不满值。", "hint": "对于 $30\\%$ 的数据，$1\\le n \\le 10^3$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，每位老师名字长度不超过 $5$，只有大小写字母并且互不相同。注意名字对大小写敏感。", "locale": "zh-CN", "translations": {"en": {"title": "Meeting Seats", "background": "It is said that the principal has recently been fond of holding all-staff meetings, asking the teachers to attend and listen to his speeches.", "description": "The principal posted a seating chart on the campus network: $n$ teachers are arranged in a single row from left to right. The teachers were satisfied with this seating.\n\nHowever, when the meeting started, the principal accidentally shuffled the seating chart, and the teachers became unhappy. The teachers do not care how much their own positions changed, but if there is a pair of teachers $a$ and $b$ such that in the original seating $a$ was to the left of $b$, and now $a$ is to the right of $b$, then this pair contributes one unit of dissatisfaction.\n\nThe principal wants to know the total dissatisfaction value of these teachers.", "inputFormat": "The first line contains a positive integer $n$, the number of teachers.\n\nThe second line contains $n$ strings, each being a teacher’s name (case-sensitive). This line represents the original seating chart.\n\nThe third line contains $n$ strings, representing the shuffled seating chart.", "outputFormat": "One line containing a non-negative integer, the total dissatisfaction value.", "hint": "- For $30\\%$ of the testdata, $1 \\le n \\le 10^3$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 10^5$, each teacher’s name has length at most $5$, consists only of uppercase and lowercase letters, and all names are distinct. Names are case-sensitive.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "会议座位", "background": "话说校长最近很喜欢召开全校教职工大会，让老师们强行听他装逼\n", "description": "现在校长在校园网上公布了一份座位表，$n$ 位老师从左到右依次排成一行。老师们都对这个座位很满意。\n\n然而到了开会时，校长不小心把座位表打乱了，老师们很不满。老师们并不在意自己的位置变了多少，但如果有一对老师 $a$ 和 $b$，他们原来的座位是 $a$ 在 $b$ 左边，现在变成了 $a$ 在 $b$ 右边，那么这一对老师便会贡献一单位不满值。\n\n校长想知道这些老师的总不满值是多少。", "inputFormat": "第一行一个正整数 $n$，为 $n$ 位老师。\n\n第二行有 $n$ 个字符串，每个字符串代表老师的名字（大小写敏感）。这一行代表原来的座位表。\n\n第三行有 $n$ 个字符串，代表打乱后的座位表。", "outputFormat": "一行，一个正整数，表示老师们的总不满值。", "hint": "对于 $30\\%$ 的数据，$1\\le n \\le 10^3$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，每位老师名字长度不超过 $5$，只有大小写字母并且互不相同。注意名字对大小写敏感。", "locale": "zh-CN"}}}
{"pid": "P5150", "type": "P", "difficulty": 3, "samples": [["6", "9\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学"], "title": "生日礼物", "background": "wyh 快过生日了，hke 和 ljc 打算送他生日礼物。\n", "description": "wyh 有一个幸运数字 $n$。现在 hke 打算送他用心度为 $a$ 的礼物，ljc 打算送他用心度为 $b$ 的礼物。两个人的礼物合在一起，用心度为 $\\operatorname{lcm}(a,b)$，其中 $\\operatorname{lcm}$ 代表最小公倍数。wyh 收到的是这份合在一起的礼物。\n\n如果 wyh 收到礼物的用心度恰好为 $n$，他就会很高兴。现在请问有多少种送礼物的方案使得 wyh 高兴？\n", "inputFormat": "一个正整数 $n$。\n", "outputFormat": "一个整数表示答案。\n", "hint": "### 样例解释\n\n这 $9$ 种方案为：$(1,6),(2,6),(3,6),(6,6),(2,3),(3,2),(6,1),(6,2),(6,3)$。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$n \\leq 1000$；\n\n对于 $100\\%$ 的数据，$n \\leq 10^{16}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Birthday Gift", "background": "wyh is about to have a birthday, and hke and ljc plan to give him a birthday present.", "description": "wyh has a lucky number $n$. Now hke plans to give him a gift with thoughtfulness value $a$, and ljc plans to give him a gift with thoughtfulness value $b$. Together, their gifts have thoughtfulness value $\\operatorname{lcm}(a,b)$, where $\\operatorname{lcm}$ denotes the least common multiple. wyh receives this combined gift.\n\nIf the thoughtfulness value of the gift wyh receives is exactly $n$, he will be happy. How many ways are there to give gifts that make wyh happy?", "inputFormat": "A positive integer $n$.", "outputFormat": "An integer representing the answer.", "hint": "### Sample Explanation\n\nThese $9$ ways are: $(1,6),(2,6),(3,6),(6,6),(2,3),(3,2),(6,1),(6,2),(6,3)$.\n\n### Constraints\n\nFor $30\\%$ of the testdata, $n \\leq 1000$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^{16}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "生日礼物", "background": "wyh 快过生日了，hke 和 ljc 打算送他生日礼物。\n", "description": "wyh 有一个幸运数字 $n$。现在 hke 打算送他用心度为 $a$ 的礼物，ljc 打算送他用心度为 $b$ 的礼物。两个人的礼物合在一起，用心度为 $\\operatorname{lcm}(a,b)$，其中 $\\operatorname{lcm}$ 代表最小公倍数。wyh 收到的是这份合在一起的礼物。\n\n如果 wyh 收到礼物的用心度恰好为 $n$，他就会很高兴。现在请问有多少种送礼物的方案使得 wyh 高兴？\n", "inputFormat": "一个正整数 $n$。\n", "outputFormat": "一个整数表示答案。\n", "hint": "### 样例解释\n\n这 $9$ 种方案为：$(1,6),(2,6),(3,6),(6,6),(2,3),(3,2),(6,1),(6,2),(6,3)$。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$n \\leq 1000$；\n\n对于 $100\\%$ 的数据，$n \\leq 10^{16}$。\n", "locale": "zh-CN"}}}
{"pid": "P5151", "type": "P", "difficulty": 3, "samples": [["5 5\n2 3 1 5 4", "2 3 1 5 4"], ["5 4\n2 3 1 5 4", "3 1 2 4 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "HKE与他的小朋友", "background": "HKE 带着 $n$ 个小朋友做游戏。\n", "description": "现在有 $n$ 个座位编号为 $1$ 至 $n$，这些小朋友也编号 $1$ 至 $n$。一开始所有小朋友都坐在相应的座位上。HKE 的游戏可用一个 $n$ 的排列 $A(A_1,A_2, \\cdots, A_n)$ 表示。一轮游戏时，对于所有的 $1\\leq i\\leq n$，坐在位置 $i$ 上的小朋友坐到位置 $A_i$ 上。\n\n现在游戏进行了 $k$ 轮，HKE 想知道游戏结束后，位置 $1,2,\\cdots, n$ 分别坐了几号小朋友？\n", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行一个排列 $A_1,A_2, \\cdots, A_n$。\n", "outputFormat": "一行 $n$ 个数表示位置 $1,2, \\cdots, n$ 上的小朋友的编号。\n", "hint": "- 对于 $30\\%$ 的数据，$n\\leq1000$，$k\\leq1000$；\n- 对于 $100\\%$ 的数据，$n\\leq100000$，$k\\leq2^{31}-1$。\n", "locale": "zh-CN", "translations": {"en": {"title": "HKE and His Little Friends", "background": "HKE is playing a game with $n$ children.", "description": "There are $n$ seats numbered $1$ to $n$, and the children are also numbered $1$ to $n$. Initially, every child sits in the seat with the same number. The game of HKE can be described by an $n$-permutation $A(A_1, A_2, \\cdots, A_n)$. In one round, for every $1\\leq i\\leq n$, the child sitting at position $i$ moves to position $A_i$.\n\nAfter $k$ rounds, HKE wants to know which child ends up at positions $1, 2, \\cdots, n$.", "inputFormat": "The first line contains two integers $n, k$.\nThe second line contains a permutation $A_1, A_2, \\cdots, A_n$.", "outputFormat": "Output one line with $n$ numbers denoting the child at positions $1, 2, \\cdots, n$.", "hint": "- For $30\\%$ of the testdata, $n\\leq1000$, $k\\leq1000$.\n- For $100\\%$ of the testdata, $n\\leq100000$, $k\\leq2^{31}-1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "HKE与他的小朋友", "background": "HKE 带着 $n$ 个小朋友做游戏。\n", "description": "现在有 $n$ 个座位编号为 $1$ 至 $n$，这些小朋友也编号 $1$ 至 $n$。一开始所有小朋友都坐在相应的座位上。HKE 的游戏可用一个 $n$ 的排列 $A(A_1,A_2, \\cdots, A_n)$ 表示。一轮游戏时，对于所有的 $1\\leq i\\leq n$，坐在位置 $i$ 上的小朋友坐到位置 $A_i$ 上。\n\n现在游戏进行了 $k$ 轮，HKE 想知道游戏结束后，位置 $1,2,\\cdots, n$ 分别坐了几号小朋友？\n", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行一个排列 $A_1,A_2, \\cdots, A_n$。\n", "outputFormat": "一行 $n$ 个数表示位置 $1,2, \\cdots, n$ 上的小朋友的编号。\n", "hint": "- 对于 $30\\%$ 的数据，$n\\leq1000$，$k\\leq1000$；\n- 对于 $100\\%$ 的数据，$n\\leq100000$，$k\\leq2^{31}-1$。\n", "locale": "zh-CN"}}}
{"pid": "P5152", "type": "P", "difficulty": 5, "samples": [["5 5\nP 1 1 5 5 3 1 1 2 1 3 1\nQ 1 1 5 5\nQ 1 1 4 3\nP 1 1 5 5 3 1 2 2 1 3 2\nQ 1 2 3 4", "222111111111111111111111111111\n111111111111111111111111111111\n212111111111111111111111111111"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["树状数组"], "title": "宝藏", "background": "此题为改编题，特别鸣谢倪星宇同学。\n\n一群海盗抢到了许多宝藏，准备埋在自己的山洞里。", "description": "海盗的山洞是一个 $n \\times n$ 的方格，每个方格都可以储存很多宝藏。所有方格初始时是空的。\n\n海盗头头决定把这些宝藏藏在某些矩形区域里，同时了解某些矩阵区域里宝藏数量的奇偶性。但是宝藏实在太多了，他整理得眼花缭乱，所以他找到了你来帮忙。", "inputFormat": "第一行两个正整数 $n, m$，表示方格的大小与操作的数量。\n\n下面 $m$ 行有两种操作：\n\n1. P 操作，依次输入 $x_1,y_1,x_2,y_2,k,a_1,b_1,a_2,b_2 \\dots a_k,b_k$：表示在以 $(x_1, y_1)$ 为左上角，$(x_2, y_2)$ 为右下角的矩形区域中，加入 $b_1$ 种 $a_1$ 物品，$b_2$ 种 $a_2$ 物品 $\\dots$ $b_k$ 种 $a_k$ 物品。\n2. Q 操作，依次输入 $x_1,y_1,x_2,y_2$：表示询问以 $(x_1, y_1)$ 为左上角，$(x_2, y_2)$ 为右下角的矩形区域中所有物品数量的奇偶性。", "outputFormat": "对于每次 Q 操作，输出一行字符串。\n\n该字符串长度为 $30$，由 `1` 与 `2` 组成。若第 $k$ 种物品数量为**偶数**，则该字符串从左到右第 $k$ 位为 `1`，否则为 `2`。字符之间没有空格。（注意是**偶 1 奇 2**）", "hint": "对于 $30\\%$ 的数据，保证 $n\\le 300,m \\le 300$；\n\n对于 $100\\%$ 的数据，保证 $n\\le 2500，m\\le 50000，1\\le x_1\\le x_2\\le n，1\\le y_1\\le y_2\\le n，1\\le a_k\\le 30，1≤b_k≤100$。", "locale": "zh-CN", "translations": {"en": {"title": "Treasure", "background": "This is an adapted problem. Special thanks to classmate Ni Xingyu.\n\nA group of pirates seized a lot of treasure and plan to bury it in their cave.", "description": "The pirates’ cave is an $n \\times n$ grid, and each cell can store a lot of treasure. All cells are initially empty. The pirate leader decides to hide these treasures in some rectangular regions, and also to learn the parity of the number of treasures in some rectangular regions. However, there is so much treasure that he gets dizzy organizing it, so he asks you for help.", "inputFormat": "The first line contains two positive integers n and m, representing the grid size and the number of operations.\n\nEach of the following m lines is one of two operations:\n\n1) P x1 y1 x2 y2 k a1 b1 a2 b2 … ak bk: add b1 items of type a1, b2 items of type a2, …, bk items of type ak to every cell in the rectangular region from (x1, y1) to (x2, y2) inclusive. Here, k is the number of (ai, bi) pairs listed.\n\n2) Q x1 y1 x2 y2: query the parity of the total number of items of each type within the rectangular region from (x1, y1) to (x2, y2) inclusive.", "outputFormat": "For each Q operation, output one line containing a string of length 30 composed of ‘1’ and ‘2’. If the count of the k-th item type is even, then the k-th character from left to right is ‘1’; otherwise it is ‘2’. There are no spaces between characters.\n\n(Note: even -> 1, odd -> 2.)", "hint": "- 30% of the testdata: $n \\le 300$, $m \\le 300$.\n- Constraints for 100% of the testdata: $n \\le 2500$, $m \\le 50000$, $1 \\le x1 \\le x2 \\le n$, $1 \\le y1 \\le y2 \\le n$, $1 \\le a_i \\le 30$, $1 \\le b_i \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "宝藏", "background": "此题为改编题，特别鸣谢倪星宇同学。\n\n一群海盗抢到了许多宝藏，准备埋在自己的山洞里。", "description": "海盗的山洞是一个 $n \\times n$ 的方格，每个方格都可以储存很多宝藏。所有方格初始时是空的。\n\n海盗头头决定把这些宝藏藏在某些矩形区域里，同时了解某些矩阵区域里宝藏数量的奇偶性。但是宝藏实在太多了，他整理得眼花缭乱，所以他找到了你来帮忙。", "inputFormat": "第一行两个正整数 $n, m$，表示方格的大小与操作的数量。\n\n下面 $m$ 行有两种操作：\n\n1. P 操作，依次输入 $x_1,y_1,x_2,y_2,k,a_1,b_1,a_2,b_2 \\dots a_k,b_k$：表示在以 $(x_1, y_1)$ 为左上角，$(x_2, y_2)$ 为右下角的矩形区域中，加入 $b_1$ 种 $a_1$ 物品，$b_2$ 种 $a_2$ 物品 $\\dots$ $b_k$ 种 $a_k$ 物品。\n2. Q 操作，依次输入 $x_1,y_1,x_2,y_2$：表示询问以 $(x_1, y_1)$ 为左上角，$(x_2, y_2)$ 为右下角的矩形区域中所有物品数量的奇偶性。", "outputFormat": "对于每次 Q 操作，输出一行字符串。\n\n该字符串长度为 $30$，由 `1` 与 `2` 组成。若第 $k$ 种物品数量为**偶数**，则该字符串从左到右第 $k$ 位为 `1`，否则为 `2`。字符之间没有空格。（注意是**偶 1 奇 2**）", "hint": "对于 $30\\%$ 的数据，保证 $n\\le 300,m \\le 300$；\n\n对于 $100\\%$ 的数据，保证 $n\\le 2500，m\\le 50000，1\\le x_1\\le x_2\\le n，1\\le y_1\\le y_2\\le n，1\\le a_k\\le 30，1≤b_k≤100$。", "locale": "zh-CN"}}}
{"pid": "P5153", "type": "P", "difficulty": 4, "samples": [["4", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学"], "title": "简单的函数", "background": "此题为改编题，特别鸣谢吴作凡同学。\n", "description": "HKE 有一次发现了一个很有趣的函数。\n\n定义 $f(2)=1$。对于 $n\\geq3$，设 $t$ 为最小的使得 $n$ 不能被 $t$ 整除的正整数，则 $f(n)=f(t)+1$。\n\n举个栗子。比如 $n=6$，此时 $t=4$，$f(6)=f(4)+1=f(3)+2=f(2)+3=4$。\n\n现在，HKE 想知道 $f(2)\\times f(3)\\times\\cdots\\times f(n)$ 是多少？答案可能很大，请对 $10^9+7$ 取模。\n", "inputFormat": "一行一个正整数 $n$。\n", "outputFormat": "一行为所求的结果。\n", "hint": "对于 $30\\%$ 的数据，$n\\leq1000$；\n\n对于 $50\\%$ 的数据，$n\\leq1000000$；\n\n对于 $100\\%$ 的数据，$n\\leq10^{18}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "A Simple Function", "background": "This problem is an adaptation; special thanks to classmate Wu Zuofan.", "description": "HKE once discovered a very interesting function.\n\nDefine $f(2) = 1$. For $n \\geq 3$, let $t$ be the smallest positive integer such that $n$ is not divisible by $t$, then $f(n) = f(t) + 1$.\n\nFor example, when $n = 6$, we have $t = 4$, and $f(6) = f(4) + 1 = f(3) + 2 = f(2) + 3 = 4$.\n\nNow, HKE wants to know the value of $f(2) \\times f(3) \\times \\cdots \\times f(n)$. The answer can be large; please take it modulo $10^9 + 7$.", "inputFormat": "A single line containing a positive integer $n$.", "outputFormat": "A single line with the required result.", "hint": "- For $30\\%$ of the testdata, $n \\leq 1000$.\n- For $50\\%$ of the testdata, $n \\leq 1{,}000{,}000$.\n- For $100\\%$ of the testdata, $n \\leq 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "简单的函数", "background": "此题为改编题，特别鸣谢吴作凡同学。\n", "description": "HKE 有一次发现了一个很有趣的函数。\n\n定义 $f(2)=1$。对于 $n\\geq3$，设 $t$ 为最小的使得 $n$ 不能被 $t$ 整除的正整数，则 $f(n)=f(t)+1$。\n\n举个栗子。比如 $n=6$，此时 $t=4$，$f(6)=f(4)+1=f(3)+2=f(2)+3=4$。\n\n现在，HKE 想知道 $f(2)\\times f(3)\\times\\cdots\\times f(n)$ 是多少？答案可能很大，请对 $10^9+7$ 取模。\n", "inputFormat": "一行一个正整数 $n$。\n", "outputFormat": "一行为所求的结果。\n", "hint": "对于 $30\\%$ 的数据，$n\\leq1000$；\n\n对于 $50\\%$ 的数据，$n\\leq1000000$；\n\n对于 $100\\%$ 的数据，$n\\leq10^{18}$。\n", "locale": "zh-CN"}}}
{"pid": "P5154", "type": "P", "difficulty": 5, "samples": [["6\n9 8 6 5 6 3\n11 19 12 17 18 15", "64\n//解释：擦去A[2],A[3]与A[5],A[6]，得分为64"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP"], "title": "数列游戏", "background": "本题改编自真实事件，特别鸣谢倪星宇同学提供创意支持。\n\n有一次，HKE 和 LJC 在玩一个有趣的数列游戏。\n", "description": "游戏规则如下：\n\nLJC 写下两个长度均为 $N$ 的正整数数列 $A$ 和 $B$。两个数列一一对应，即对于每个 $i$ 都有一对 $(A_i, B_i)$。\n\nHKE 每次可以选择一对 **相邻的**数 $A[i]$ 和 $A[i+1]$，**如果它们不互质（即 $\\gcd(A[i], A[i+1]) > 1$**，他可以将这一对消除，并获得 $B[i] + B[i+1]$ 分数。\n\n被消除的一对数从两个数列中同时移除，并使两个数列重新紧密排列（即剩余元素自动左移）。\n\n当数列中**所有相邻的数对都互质时**，游戏结束。HKE 想知道他最多可以获得多少分数。\n", "inputFormat": "* 第 1 行：一个整数 $N$（表示数列的长度）\n* 第 2 行：$N$ 个整数，表示数列 $A_1, A_2, \\ldots, A_N$\n* 第 3 行：$N$ 个整数，表示数列 $B_1, B_2, \\ldots, B_N$", "outputFormat": "* 输出一个整数，表示 HKE 可以获得的最大总得分。\n", "hint": "### 样例解释\n\n一种最优的策略如下：\n\n* 第一次消去 $A[2]=8$ 和 $A[3]=6$，获得 $B[2]+B[3]=19+12=31$ 分；\n* 更新数列后为：$9, 5, 6, 3$，$11, 17, 18, 15$；\n* 第二次消去 $A[3]=6$ 和 $A[4]=3$，获得 $B[3]+B[4]=18+15=33$ 分；\n* 总得分为 $31+33=64$。\n\n### 数据范围与限制\n\n* 对于 30% 的数据，$N \\leq 20$；\n* 对于 60% 的数据，$N \\leq 100$；\n* 对于 80% 的数据，$N \\leq 500$；\n* 对于 100% 的数据，$N \\leq 800$；\n* 保证 $1 \\leq A_i, B_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "{{Sequence Game}}", "background": "{{This problem is adapted from a real event. Special thanks to classmate Ni Xingyu (Ni Xingyu) for creative support. One time, HKE and LJC were playing an interesting sequence game.}}", "description": "{{The rules are as follows:\n\nLJC writes down two sequences of positive integers $A$ and $B$, both of length $N$. The two sequences are paired one-to-one, that is, for each $i$ there is a pair $(A_i, B_i)$.\n\nEach time, HKE may choose an adjacent pair $A[i]$ and $A[i+1]$. If they are not coprime (i.e., $\\gcd(A[i], A[i+1]) > 1$), he may remove this pair and gain $B[i] + B[i+1]$ points.\n\nThe removed pair is simultaneously deleted from both sequences, and the sequences are compacted (the remaining elements shift left).\n\nWhen all adjacent pairs in the sequence are coprime, the game ends. HKE wants to know the maximum total score he can obtain.}}", "inputFormat": "{{- Line 1: an integer $N$ (the length of the sequences).\n- Line 2: $N$ integers, representing $A_1, $ $A_2, \\ldots, A_N$.\n- Line 3: $N$ integers, representing $B_1, $ $B_2, \\ldots, B_N$.}}", "outputFormat": "{{- Output one integer, the maximum total score HKE can obtain.}}", "hint": "{{Sample Explanation:\n\n- First remove $A[2]=8$ and $A[3]=6$, gaining $B[2]+B[3]=19+12=31$ points.\n- After the update, they become $9, 5, 6, 3$ and $11, 17, 18, 15$.\n- Then remove $A[3]=6$ and $A[4]=3$, gaining $B[3]+B[4]=18+15=33$ points.\n- The total score is $31+33=64$.\n\nConstraints:\n\n- For 30% of the testdata, $N \\leq 20$.\n- For 60% of the testdata, $N \\leq 100$.\n- For 80% of the testdata, $N \\leq 500$.\n- For 100% of the testdata, $N \\leq 800$.\n- It is guaranteed that $1 \\leq A_i, B_i \\leq 10^9$.}}\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "数列游戏", "background": "本题改编自真实事件，特别鸣谢倪星宇同学提供创意支持。\n\n有一次，HKE 和 LJC 在玩一个有趣的数列游戏。\n", "description": "游戏规则如下：\n\nLJC 写下两个长度均为 $N$ 的正整数数列 $A$ 和 $B$。两个数列一一对应，即对于每个 $i$ 都有一对 $(A_i, B_i)$。\n\nHKE 每次可以选择一对 **相邻的**数 $A[i]$ 和 $A[i+1]$，**如果它们不互质（即 $\\gcd(A[i], A[i+1]) > 1$**，他可以将这一对消除，并获得 $B[i] + B[i+1]$ 分数。\n\n被消除的一对数从两个数列中同时移除，并使两个数列重新紧密排列（即剩余元素自动左移）。\n\n当数列中**所有相邻的数对都互质时**，游戏结束。HKE 想知道他最多可以获得多少分数。\n", "inputFormat": "* 第 1 行：一个整数 $N$（表示数列的长度）\n* 第 2 行：$N$ 个整数，表示数列 $A_1, A_2, \\ldots, A_N$\n* 第 3 行：$N$ 个整数，表示数列 $B_1, B_2, \\ldots, B_N$", "outputFormat": "* 输出一个整数，表示 HKE 可以获得的最大总得分。\n", "hint": "### 样例解释\n\n一种最优的策略如下：\n\n* 第一次消去 $A[2]=8$ 和 $A[3]=6$，获得 $B[2]+B[3]=19+12=31$ 分；\n* 更新数列后为：$9, 5, 6, 3$，$11, 17, 18, 15$；\n* 第二次消去 $A[3]=6$ 和 $A[4]=3$，获得 $B[3]+B[4]=18+15=33$ 分；\n* 总得分为 $31+33=64$。\n\n### 数据范围与限制\n\n* 对于 30% 的数据，$N \\leq 20$；\n* 对于 60% 的数据，$N \\leq 100$；\n* 对于 80% 的数据，$N \\leq 500$；\n* 对于 100% 的数据，$N \\leq 800$；\n* 保证 $1 \\leq A_i, B_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5155", "type": "P", "difficulty": 6, "samples": [["2\n1\n3", "150000\n300000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2018", "USACO", "期望", "凸包"], "title": "[USACO18DEC] Balance Beam P", "background": "", "description": "Bessie为了存钱给她的牛棚新建一间隔间，开始在当地的马戏团里表演，通过在平衡木上小心地来回走动来展示她卓越的平衡能力。\n\nBessie能够通过表演赚到的钱取决于她最终成功跳下平衡木的位置。平衡木上从左向右的位置记为 $ 0,1,\\ldots,N+1 $ 。如果Bessie到达了位置 $ 0 $ 或是 $ N+1 $ ，她就会从平衡木的一端掉下去，遗憾地得不到报酬。\n\n如果Bessie处在一个给定的位置 $ k $ ，她可以进行下面两项中的任意一项：\n\n1. 投掷一枚硬币。如果背面朝上，她前往位置 $ k-1 $ ，如果正面朝上，她前往位置 $ k+1 $ （也就是说，每种可能性 $ 1/2 $ 的概率）。\n\n2. 跳下平衡木，获得 $ f(k) $ 的报酬（ $ 0 \\leq f(k) \\leq 10^9 $ ）。\n\nBessie意识到她并不能保证结果能够得到某一特定数量的报酬，这是由于她的移动是由随机的掷硬币结果控制。然而，基于她的起始位置，她想要求出当她进行一系列最优的决定之后，她能够得到的期望报酬（“最优”指的是这些决定能够带来最高可能的期望报酬）。\n\n例如，如果她的策略能够使她以 $ 1/2 $ 的概率获得 $ 10 $ 的报酬，$ 1/4 $ 的概率获得 $ 8 $ 的报酬，$ 1/4 $ 的概率获得 $ 0 $ 的报酬，那么她的期望报酬为加权平均值 $ 10 \\times (1/2)+8 \\times (1/4)+0 \\times (1/4)=7 $ 。", "inputFormat": "输入的第一行包含 $ N $ （ $ 2 \\leq N \\leq 10^5 $ ）。以下 $ N $ 行包含 $ f(1) \\ldots f(N) $ 。", "outputFormat": "输出 $ N $ 行。第 $ i $ 行输出 $ 10^5 $ 乘以Bessie从位置 $ i $ 开始使用最优策略能够获得的报酬的期望值，向下取整。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Balance Beam P", "background": "", "description": "To save money to build a new stall in her barn, Bessie starts performing at a local circus, showing off her excellent balance by carefully walking back and forth on a balance beam.\n\nHow much money Bessie can earn depends on the position where she finally jumps off the beam successfully. Positions on the beam from left to right are labeled $0,1,\\ldots,N+1$. If Bessie reaches position $0$ or $N+1$, she will fall off the end of the beam and unfortunately receive no reward.\n\nIf Bessie is at a given position $k$, she may do either of the following:\n\n1. Toss a coin. If it lands tails up, she moves to position $k-1$; if it lands heads up, she moves to position $k+1$ (that is, each happens with probability $1/2$).\n\n2. Jump off the beam and receive a reward of $f(k)$ ($0 \\leq f(k) \\leq 10^9$).\n\nBessie realizes she cannot guarantee getting any particular reward, since her movement is controlled by the random coin tosses. However, based on her starting position, she wants to compute the expected reward she can obtain after making a sequence of optimal decisions (where “optimal” means the decisions that yield the highest possible expected reward).\n\nFor example, if her strategy gives her a reward of $10$ with probability $1/2$, a reward of $8$ with probability $1/4$, and a reward of $0$ with probability $1/4$, then her expected reward is the weighted average $10 \\times (1/2)+8 \\times (1/4)+0 \\times (1/4)=7$.", "inputFormat": "The first line of input contains $N$ ($2 \\leq N \\leq 10^5$). The next $N$ lines contain $f(1) \\ldots f(N)$.", "outputFormat": "Output $N$ lines. On the $i$-th line, output $10^5$ times the expected reward Bessie can obtain when starting from position $i$ and using an optimal strategy, rounded down.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Balance Beam P", "background": "", "description": "Bessie为了存钱给她的牛棚新建一间隔间，开始在当地的马戏团里表演，通过在平衡木上小心地来回走动来展示她卓越的平衡能力。\n\nBessie能够通过表演赚到的钱取决于她最终成功跳下平衡木的位置。平衡木上从左向右的位置记为 $ 0,1,\\ldots,N+1 $ 。如果Bessie到达了位置 $ 0 $ 或是 $ N+1 $ ，她就会从平衡木的一端掉下去，遗憾地得不到报酬。\n\n如果Bessie处在一个给定的位置 $ k $ ，她可以进行下面两项中的任意一项：\n\n1. 投掷一枚硬币。如果背面朝上，她前往位置 $ k-1 $ ，如果正面朝上，她前往位置 $ k+1 $ （也就是说，每种可能性 $ 1/2 $ 的概率）。\n\n2. 跳下平衡木，获得 $ f(k) $ 的报酬（ $ 0 \\leq f(k) \\leq 10^9 $ ）。\n\nBessie意识到她并不能保证结果能够得到某一特定数量的报酬，这是由于她的移动是由随机的掷硬币结果控制。然而，基于她的起始位置，她想要求出当她进行一系列最优的决定之后，她能够得到的期望报酬（“最优”指的是这些决定能够带来最高可能的期望报酬）。\n\n例如，如果她的策略能够使她以 $ 1/2 $ 的概率获得 $ 10 $ 的报酬，$ 1/4 $ 的概率获得 $ 8 $ 的报酬，$ 1/4 $ 的概率获得 $ 0 $ 的报酬，那么她的期望报酬为加权平均值 $ 10 \\times (1/2)+8 \\times (1/4)+0 \\times (1/4)=7 $ 。", "inputFormat": "输入的第一行包含 $ N $ （ $ 2 \\leq N \\leq 10^5 $ ）。以下 $ N $ 行包含 $ f(1) \\ldots f(N) $ 。", "outputFormat": "输出 $ N $ 行。第 $ i $ 行输出 $ 10^5 $ 乘以Bessie从位置 $ i $ 开始使用最优策略能够获得的报酬的期望值，向下取整。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5156", "type": "P", "difficulty": 6, "samples": [["4 1\n4 2 1 3\n", "2\n1\n4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "USACO", "树状数组"], "title": "[USACO18DEC] Sort It Out P", "background": "", "description": "FJ 有 $N$（$1 \\leq N \\leq 10^5$）头奶牛（分别用 $1 \\ldots N$ 编号）排成一行。FJ 喜欢他的奶牛以升序排列，不幸的是现在她们的顺序被打乱了。在过去，FJ 曾经使用一些诸如“冒泡排序”的开创性算法来使他的奶牛排好序，但今天他想偷个懒。取而代之，他会每次对着一头奶牛叫道“按顺序排好”。当一头奶牛被叫到的时候，她会确保自己在队伍中的顺序是正确的（从她的角度看来）。当有一头紧接在她右边的奶牛的编号比她小，她们就交换位置。然后，当有一头紧接在她左边的奶牛的编号比她大，她们就交换位置。这样这头奶牛就完成了“按顺序排好”，在这头奶牛看来左边的奶牛编号比她小，右边的奶牛编号比她大。\n\nFJ 想要选出这些奶牛的一个子集，然后遍历这个子集，依次对着每一头奶牛发号施令（按编号递增的顺序），重复这样直到所有 $N$ 头奶牛排好顺序。例如，如果他选出了编号为 $\\{2,4,5\\}$ 的奶牛的子集，那么他会喊叫奶牛 $2$，然后是奶牛 $4$，然后是奶牛 $5$。如果 $N$ 头奶牛此时仍未排好顺序，他会再次对着这几头奶牛喊叫，如果有必要的话继续重复。\n\n由于 FJ 不确定哪些奶牛比较专心，他想要使得这个子集最小。此外，他认为 $K$ 是个幸运数字。请帮他求出满足重复喊叫可以使得所有奶牛排好顺序的最小子集之中字典序第 $K$ 小的子集。\n\n我们称 $\\{1, \\ldots ,N\\}$ 的一个子集 $S$ 在字典序下小于子集 $T$，当 $S$ 的所有元素组成的序列（按升序排列）在字典序下小于 $T$ 的所有元素组成的序列（按升序排列）。例如，$\\{1,3,6\\}$ 在字典序下小于 $\\{1,4,5\\}$。", "inputFormat": "输入的第一行包含一个整数 $ N $ 。第二行包含一个整数 $ K $ （ $ 1 \\leq K \\leq 10^{18} $ ）。第三行包含 $ N $ 个空格分隔的整数，表示从左到右奶牛的编号。\n\n保证存在至少 $ K $ 个符合要求的子集。", "outputFormat": "第一行输出最小子集的大小。接下来输出字典序第 $ K $ 小的最小子集中奶牛的编号，每行一个数，升序排列。", "hint": "开始的时候序列为 $ \\mathtt{\\:4\\:\\; 2\\:\\; 1\\:\\; 3\\:} $ 。在FJ喊叫编号为 $ 1 $ 的奶牛之后，序列变为 $ \\mathtt{\\:1\\:\\; 4\\:\\; 2\\:\\; 3\\:} $ 。在FJ喊叫编号为 $ 4 $ 的奶牛之后，序列变为 $ \\mathtt{\\:1\\:\\; 2\\:\\; 3\\:\\; 4\\:} $ 。在这个时候，序列已经完成了排序。\n\n## 子任务\n\n对于占总分 $ 3/16 $ 的测试数据， $ N \\leq 6 $ ，并且 $ K=1 $ 。\n\n对于另外的占总分 $ 5/16 $ 的测试数据， $ K=1 $ 。\n\n对于另外的占总分 $ 8/16 $ 的测试数据，没有其他限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] Sort It Out P", "background": "", "description": "FJ has $N$ cows ($1 \\leq N \\leq 10^5$), labeled $1 \\ldots N$, standing in a line. FJ likes his cows to be in increasing order, but unfortunately their order is currently scrambled. In the past, FJ used some groundbreaking algorithms such as \"bubble sort\" to sort his cows, but today he wants to be lazy. Instead, each time he will shout at one cow, \"Get in order.\" When a cow is shouted at, she will make sure her position in the line is correct (from her point of view). If the cow immediately to her right has a smaller label than hers, they swap positions. Then, if the cow immediately to her left has a larger label than hers, they swap positions. In this way, the cow finishes \"getting in order\": from her point of view, cows to her left have smaller labels than hers, and cows to her right have larger labels than hers.\n\nFJ wants to choose a subset of the cows, then repeatedly go through this subset and shout at each selected cow in increasing order of label, repeating until all $N$ cows are sorted. For example, if he chooses the subset of cows with labels $\\{2,4,5\\}$, then he will shout at cow $2$, then cow $4$, then cow $5$. If the $N$ cows are still not sorted at that point, he will shout at these cows again, and continue repeating if necessary.\n\nSince FJ is not sure which cows are attentive, he wants this subset to be as small as possible. Also, he believes $K$ is a lucky number. Please help him find, among all minimum-size subsets that can sort all cows by repeated shouting, the $K$-th smallest subset in lexicographic order.\n\nWe say that a subset $S$ of $\\{1, \\ldots, N\\}$ is smaller than a subset $T$ in lexicographic order if the sequence of elements of $S$ (sorted in increasing order) is lexicographically smaller than the sequence of elements of $T$ (sorted in increasing order). For example, $\\{1,3,6\\}$ is lexicographically smaller than $\\{1,4,5\\}$.", "inputFormat": "The first line contains an integer $N$.  \nThe second line contains an integer $K$ ($1 \\leq K \\leq 10^{18}$).  \nThe third line contains $N$ space-separated integers, giving the cow labels from left to right.\n\nIt is guaranteed that there are at least $K$ valid subsets.", "outputFormat": "Print the size of a minimum subset on the first line.  \nThen output the cow labels in the $K$-th lexicographically smallest minimum subset, one per line, in increasing order.", "hint": "At the beginning, the sequence is $ \\mathtt{\\:4\\:\\; 2\\:\\; 1\\:\\; 3\\:} $. After FJ shouts at cow $1$, the sequence becomes $ \\mathtt{\\:1\\:\\; 4\\:\\; 2\\:\\; 3\\:} $. After FJ shouts at cow $4$, the sequence becomes $ \\mathtt{\\:1\\:\\; 2\\:\\; 3\\:\\; 4\\:} $. At this time, the sequence is fully sorted.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] Sort It Out P", "background": "", "description": "FJ 有 $N$（$1 \\leq N \\leq 10^5$）头奶牛（分别用 $1 \\ldots N$ 编号）排成一行。FJ 喜欢他的奶牛以升序排列，不幸的是现在她们的顺序被打乱了。在过去，FJ 曾经使用一些诸如“冒泡排序”的开创性算法来使他的奶牛排好序，但今天他想偷个懒。取而代之，他会每次对着一头奶牛叫道“按顺序排好”。当一头奶牛被叫到的时候，她会确保自己在队伍中的顺序是正确的（从她的角度看来）。当有一头紧接在她右边的奶牛的编号比她小，她们就交换位置。然后，当有一头紧接在她左边的奶牛的编号比她大，她们就交换位置。这样这头奶牛就完成了“按顺序排好”，在这头奶牛看来左边的奶牛编号比她小，右边的奶牛编号比她大。\n\nFJ 想要选出这些奶牛的一个子集，然后遍历这个子集，依次对着每一头奶牛发号施令（按编号递增的顺序），重复这样直到所有 $N$ 头奶牛排好顺序。例如，如果他选出了编号为 $\\{2,4,5\\}$ 的奶牛的子集，那么他会喊叫奶牛 $2$，然后是奶牛 $4$，然后是奶牛 $5$。如果 $N$ 头奶牛此时仍未排好顺序，他会再次对着这几头奶牛喊叫，如果有必要的话继续重复。\n\n由于 FJ 不确定哪些奶牛比较专心，他想要使得这个子集最小。此外，他认为 $K$ 是个幸运数字。请帮他求出满足重复喊叫可以使得所有奶牛排好顺序的最小子集之中字典序第 $K$ 小的子集。\n\n我们称 $\\{1, \\ldots ,N\\}$ 的一个子集 $S$ 在字典序下小于子集 $T$，当 $S$ 的所有元素组成的序列（按升序排列）在字典序下小于 $T$ 的所有元素组成的序列（按升序排列）。例如，$\\{1,3,6\\}$ 在字典序下小于 $\\{1,4,5\\}$。", "inputFormat": "输入的第一行包含一个整数 $ N $ 。第二行包含一个整数 $ K $ （ $ 1 \\leq K \\leq 10^{18} $ ）。第三行包含 $ N $ 个空格分隔的整数，表示从左到右奶牛的编号。\n\n保证存在至少 $ K $ 个符合要求的子集。", "outputFormat": "第一行输出最小子集的大小。接下来输出字典序第 $ K $ 小的最小子集中奶牛的编号，每行一个数，升序排列。", "hint": "开始的时候序列为 $ \\mathtt{\\:4\\:\\; 2\\:\\; 1\\:\\; 3\\:} $ 。在FJ喊叫编号为 $ 1 $ 的奶牛之后，序列变为 $ \\mathtt{\\:1\\:\\; 4\\:\\; 2\\:\\; 3\\:} $ 。在FJ喊叫编号为 $ 4 $ 的奶牛之后，序列变为 $ \\mathtt{\\:1\\:\\; 2\\:\\; 3\\:\\; 4\\:} $ 。在这个时候，序列已经完成了排序。\n\n## 子任务\n\n对于占总分 $ 3/16 $ 的测试数据， $ N \\leq 6 $ ，并且 $ K=1 $ 。\n\n对于另外的占总分 $ 5/16 $ 的测试数据， $ K=1 $ 。\n\n对于另外的占总分 $ 8/16 $ 的测试数据，没有其他限制。", "locale": "zh-CN"}}}
{"pid": "P5157", "type": "P", "difficulty": 6, "samples": [["5 1\n1 2\n2 3\n3 4\n4 5\n2 4\n", "0\n0\n1\n1\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "2018", "USACO", "图论建模", "拓扑排序"], "title": "[USACO18DEC] The Cow Gathering P", "background": "", "description": "奶牛们从世界各地聚集起来参加一场大型聚会。总共有 $ N $ 头奶牛， $ N-1 $ 对奶牛互为朋友。每头奶牛都可以通过一些朋友关系认识其他每头奶牛。\n\n她们玩得很开心，但是现在到了她们应当离开的时间了，她们会一个接一个地离开。她们想要以某种顺序离开，使得只要至少还有两头奶牛尚未离开，所有尚未离开的奶牛都还有没有离开的朋友。此外，由于行李寄存的因素，有 $ M $ 对奶牛 $ (a_i,b_i) $ 必须满足奶牛 $ a_i $ 要比奶牛 $ b_i $ 先离开。注意奶牛 $ a_i $ 和奶牛 $ b_i $ 可能是朋友，也可能不是朋友。\n\n帮助奶牛们求出，对于每一头奶牛，她是否可以成为最后一头离开的奶牛。可能会发生不存在满足上述要求的奶牛离开顺序的情况。", "inputFormat": "输入的第 $ 1 $ 行包含两个空格分隔的整数 $ N $ 和 $ M $ 。\n\n输入的第 $ 2 \\leq i \\leq N $ 行，每行包含两个整数 $ x_i $ 和 $ y_i $ ，满足 $ 1 \\leq x_i $ ， $ y_i \\leq N,xi \\neq yi $ ，表示奶牛 $ x_i $ 和奶牛 $ y_i $ 是朋友关系。\n\n输入的第 $ N+1 \\leq i \\leq N+M $ 行，每行包含两个整数 $ a_i $ 和 $ b_i $ ，满足 $ 1 \\leq a_i,b_i \\leq N $ ， $ a_i \\neq b_i $ ，表示奶牛 $ a_i $ 必须比奶牛 $ b_i $ 先离开聚会。\n\n输入保证 $ 1 \\leq N,M \\leq 10^5 $ 。对于占总分 $ 20\\% $ 的测试数据，保证 $ N,M \\leq 3000 $ 。", "outputFormat": "输出 $ N $ 行，每行包含一个整数 $ d_i $ ，如果奶牛 $ i $ 可以成为最后一头离开的奶牛，则 $ d_i=1 $ ，否则 $ d_i=0 $ 。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18DEC] The Cow Gathering P", "background": "", "description": "Cows from all over the world have gathered for a big party. There are a total of $N$ cows, and $N-1$ pairs of cows are friends. Each cow can get to know every other cow through some chain of friendships.\n\nThey have had a great time, but now it is time for them to leave, one by one. They want to leave in some order such that, as long as at least two cows have not left yet, every remaining cow still has at least one friend who has not left. In addition, due to baggage storage constraints, there are $M$ pairs of cows $(a_i,b_i)$ that must satisfy that cow $a_i$ leaves before cow $b_i$. Note that cows $a_i$ and $b_i$ may or may not be friends.\n\nHelp the cows determine, for each cow, whether she can be the last cow to leave. It is possible that there is no leaving order that satisfies the above requirements.", "inputFormat": "The first line of input contains two space-separated integers $N$ and $M$.\n\nThe following $N-1$ lines (for $2 \\leq i \\leq N$) each contain two integers $x_i$ and $y_i$, satisfying $1 \\leq x_i$, $y_i \\leq N, xi \\neq yi$, indicating that cows $x_i$ and $y_i$ are friends.\n\nThe following $M$ lines (for $N+1 \\leq i \\leq N+M$) each contain two integers $a_i$ and $b_i$, satisfying $1 \\leq a_i,b_i \\leq N$ and $a_i \\neq b_i$, indicating that cow $a_i$ must leave the party before cow $b_i$.\n\nThe input guarantees $1 \\leq N,M \\leq 10^5$. For the testdata worth $20\\%$ of the total score, it is guaranteed that $N,M \\leq 3000$.", "outputFormat": "Output $N$ lines. Each line contains an integer $d_i$. If cow $i$ can be the last cow to leave, then $d_i=1$; otherwise, $d_i=0$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18DEC] The Cow Gathering P", "background": "", "description": "奶牛们从世界各地聚集起来参加一场大型聚会。总共有 $ N $ 头奶牛， $ N-1 $ 对奶牛互为朋友。每头奶牛都可以通过一些朋友关系认识其他每头奶牛。\n\n她们玩得很开心，但是现在到了她们应当离开的时间了，她们会一个接一个地离开。她们想要以某种顺序离开，使得只要至少还有两头奶牛尚未离开，所有尚未离开的奶牛都还有没有离开的朋友。此外，由于行李寄存的因素，有 $ M $ 对奶牛 $ (a_i,b_i) $ 必须满足奶牛 $ a_i $ 要比奶牛 $ b_i $ 先离开。注意奶牛 $ a_i $ 和奶牛 $ b_i $ 可能是朋友，也可能不是朋友。\n\n帮助奶牛们求出，对于每一头奶牛，她是否可以成为最后一头离开的奶牛。可能会发生不存在满足上述要求的奶牛离开顺序的情况。", "inputFormat": "输入的第 $ 1 $ 行包含两个空格分隔的整数 $ N $ 和 $ M $ 。\n\n输入的第 $ 2 \\leq i \\leq N $ 行，每行包含两个整数 $ x_i $ 和 $ y_i $ ，满足 $ 1 \\leq x_i $ ， $ y_i \\leq N,xi \\neq yi $ ，表示奶牛 $ x_i $ 和奶牛 $ y_i $ 是朋友关系。\n\n输入的第 $ N+1 \\leq i \\leq N+M $ 行，每行包含两个整数 $ a_i $ 和 $ b_i $ ，满足 $ 1 \\leq a_i,b_i \\leq N $ ， $ a_i \\neq b_i $ ，表示奶牛 $ a_i $ 必须比奶牛 $ b_i $ 先离开聚会。\n\n输入保证 $ 1 \\leq N,M \\leq 10^5 $ 。对于占总分 $ 20\\% $ 的测试数据，保证 $ N,M \\leq 3000 $ 。", "outputFormat": "输出 $ N $ 行，每行包含一个整数 $ d_i $ ，如果奶牛 $ i $ 可以成为最后一头离开的奶牛，则 $ d_i=1 $ ，否则 $ d_i=0 $ 。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5158", "type": "P", "difficulty": 7, "samples": [["4\n1 1\n2 4\n3 9\n4 16", "0 0 1 0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式快速插值", "background": "模板题，无背景", "description": "给出 $n$ 个点 $(x_i, y_i)$\n\n求一个 $n-1$ 次的多项式 $f(x)$，使得 $f(x_i)\\equiv y_i\\pmod{998244353}$", "inputFormat": "第一行输入一个正整数 $n$\n\n接下来 $n$ 行每行两个整数 $x_i, y_i$", "outputFormat": "共一行，从低到高输出 $f(x)$ 每一项的系数\n\n若次数不够 $n-1$ 次，用 $0$ 补足", "hint": "$1 \\leqslant n \\leqslant 100000$\n\n$0 \\leqslant x_i, y_i \\lt 998244353$\n\n保证 $x_i$ 互不相同\n\n对于 $30\\%$ 的数据，$n \\leqslant 5000$\n\n注意，你输出的数必须是 $[0, 998244353)$ 范围内的整数\n\n数据使用 CYaRon 在五分钟之内生成。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Fast Polynomial Interpolation", "background": "This is a template problem, with no background.", "description": "You are given $n$ points $(x_i, y_i)$.\n\nFind a polynomial $f(x)$ of degree $n - 1$ such that $f(x_i)\\equiv y_i\\pmod{998244353}$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next $n$ lines each contain two integers $x_i, y_i$.", "outputFormat": "Output one line: the coefficients of $f(x)$ from low degree to high degree.\n\nIf the degree is less than $n - 1$, pad with $0$ until there are $n$ coefficients.", "hint": "Constraints:\n\n$1 \\leqslant n \\leqslant 100000$.\n\n$0 \\leqslant x_i, y_i \\lt 998244353$.\n\nIt is guaranteed that all $x_i$ are pairwise distinct.\n\nFor $30\\%$ of the testdata, $n \\leqslant 5000$.\n\nNote that the numbers you output must be integers in the range $[0, 998244353)$.\n\nThe testdata was generated using CYaRon within five minutes.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式快速插值", "background": "模板题，无背景", "description": "给出 $n$ 个点 $(x_i, y_i)$\n\n求一个 $n-1$ 次的多项式 $f(x)$，使得 $f(x_i)\\equiv y_i\\pmod{998244353}$", "inputFormat": "第一行输入一个正整数 $n$\n\n接下来 $n$ 行每行两个整数 $x_i, y_i$", "outputFormat": "共一行，从低到高输出 $f(x)$ 每一项的系数\n\n若次数不够 $n-1$ 次，用 $0$ 补足", "hint": "$1 \\leqslant n \\leqslant 100000$\n\n$0 \\leqslant x_i, y_i \\lt 998244353$\n\n保证 $x_i$ 互不相同\n\n对于 $30\\%$ 的数据，$n \\leqslant 5000$\n\n注意，你输出的数必须是 $[0, 998244353)$ 范围内的整数\n\n数据使用 CYaRon 在五分钟之内生成。", "locale": "zh-CN"}}}
{"pid": "P5159", "type": "P", "difficulty": 3, "samples": [["2\n2 2\n2 2018", "2\n851481696"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "WD与矩阵", "background": "WD整日沉浸在矩阵中，无法自拔……", "description": "WD 特别喜欢矩阵，尤其是 01 矩阵。\n\n一天，CX 给了 WD 一个巨大的 $n$ 行 $m$ 列的 01 矩阵，WD 发现这个矩阵每行、每列的异或值都是 0。\n\nCX 随后就问道：“WD，你知道有多少 01 矩阵每行每列异或值都是 0 吗！？”WD 当然不会这个问题，于是他来请教你。\n\n由于答案可能很大，输出结果模 $998\\,244\\,353$ 的值即可。", "inputFormat": "第一行一个数 $T$，表示数据组数。\n\n接下来 $T$ 行每行两个数 $n,m$，分别表示询问的行数和列数。", "outputFormat": "共 $T$ 行，每行一个数，表示答案对 $998\\,244\\,353$ 取模的结果。", "hint": "- subtask1（11pts）：$1\\le T\\le 10,~1\\le n,m\\le 4$\n- subtask2（43pts）：$1\\le T\\le 5,~1\\le n\\le 5,~1\\le m\\le 1,000$\n- subtask3（46pts）：$1\\le T\\le 10^5,~1\\le n,m\\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "WD and Matrices", "background": "WD spends all day immersed in matrices and cannot get out of it.", "description": "WD likes matrices very much, especially 01 matrices.\n\nOne day, CX gave WD a huge $n$-row, $m$-column 01 matrix. WD found that the XOR value of every row and every column of this matrix is $0$.\n\nCX then asked, “WD, do you know how many 01 matrices have XOR value $0$ in every row and every column!?” WD of course does not know this, so he came to ask you.\n\nSince the answer may be very large, you only need to output the result modulo $998\\,244\\,353$.", "inputFormat": "The first line contains an integer $T$, which represents the number of test cases.\n\nIn the next $T$ lines, each line contains two integers $n, m$, representing the number of rows and columns in the query.", "outputFormat": "Output $T$ lines. Each line contains one integer, the answer modulo $998\\,244\\,353$.", "hint": "- Subtask 1 (11 pts): $1\\le T\\le 10,~1\\le n,m\\le 4$.\n- Subtask 2 (43 pts): $1\\le T\\le 5,~1\\le n\\le 5,~1\\le m\\le 1,000$.\n- Subtask 3 (46 pts): $1\\le T\\le 10^5,~1\\le n,m\\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "WD与矩阵", "background": "WD整日沉浸在矩阵中，无法自拔……", "description": "WD 特别喜欢矩阵，尤其是 01 矩阵。\n\n一天，CX 给了 WD 一个巨大的 $n$ 行 $m$ 列的 01 矩阵，WD 发现这个矩阵每行、每列的异或值都是 0。\n\nCX 随后就问道：“WD，你知道有多少 01 矩阵每行每列异或值都是 0 吗！？”WD 当然不会这个问题，于是他来请教你。\n\n由于答案可能很大，输出结果模 $998\\,244\\,353$ 的值即可。", "inputFormat": "第一行一个数 $T$，表示数据组数。\n\n接下来 $T$ 行每行两个数 $n,m$，分别表示询问的行数和列数。", "outputFormat": "共 $T$ 行，每行一个数，表示答案对 $998\\,244\\,353$ 取模的结果。", "hint": "- subtask1（11pts）：$1\\le T\\le 10,~1\\le n,m\\le 4$\n- subtask2（43pts）：$1\\le T\\le 5,~1\\le n\\le 5,~1\\le m\\le 1,000$\n- subtask3（46pts）：$1\\le T\\le 10^5,~1\\le n,m\\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P5160", "type": "P", "difficulty": 5, "samples": [["2\n2 9\n10 14", "55\n1961256"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "Lucas 定理"], "title": "WD与循环", "background": "WD 整日沉浸在循环中，无法自拔……", "description": "这天，WD 蒟蒻为了解决一个小问题写了个很长很长的 for 循环：\n```cpp\nint cnt = 0;\nfor (int a_1 = 0; a_1 <= m; a_1++) {\n    for (int a_2 = 0; a_1 + a_2 <= m; a_2++) {\n    ...\n        for (int a_n = 0; a_1 + a_2 + ... + a_n <= m; a_n++) {\n            cnt = (cnt + 1) % 19491001;\n        }\n    }\n}\nprintf(\"%d\\n\", cnt);\n```\nCX 过来看了一眼，说：**WD 你个笨蛋，这道题不是 SB 题吗？** WD 一脸懵逼，只好请你来教教他啦……", "inputFormat": "第一行一个数 $T$，表示数据组数。接下来每行两个数 $n,m$，分别表示循环重数和每层循环的上界。", "outputFormat": "共 $T$ 行，每行一个数表示答案。", "hint": "$\\text{subtask1}(23pts):~n,m\\le 1,000,~1\\le T\\le 10,000$\n\n$\\text{subtask2}(35pts):~n,m\\le 10^7,~1\\le T\\le 5$\n\n$\\text{subtask3}(42pts):~n,m\\le 10^{18},~1\\le T\\le 100,000$\n\n对于样例 1，写个代码就知道答案是 55 了（大雾）。", "locale": "zh-CN", "translations": {"en": {"title": "WD and Loops", "background": "WD is immersed in loops all day long and cannot break free.", "description": "One day, WD (a “juruo”, i.e., a newbie) wrote a very, very long `for` loop to solve a small problem:\n```cpp\nint cnt = 0;\nfor (int a_1 = 0; a_1 <= m; a_1++) {\n    for (int a_2 = 0; a_1 + a_2 <= m; a_2++) {\n    ...\n        for (int a_n = 0; a_1 + a_2 + ... + a_n <= m; a_n++) {\n            cnt = (cnt + 1) % 19491001;\n        }\n    }\n}\nprintf(\"%d\\n\", cnt);\n```\nCX took a look and said: **WD, you idiot, isn’t this an easy problem?** WD was completely confused, so he had to ask you to teach him.", "inputFormat": "The first line contains an integer $T$, the number of test cases. Each of the following lines contains two integers $n, m$, representing the number of nested loops and the upper bound of each loop level, respectively.", "outputFormat": "Output $T$ lines. Each line contains one integer, the answer.", "hint": "$\\text{subtask1}(23pts):~n,m\\le 1,000,~1\\le T\\le 10,000$\n\n$\\text{subtask2}(35pts):~n,m\\le 10^7,~1\\le T\\le 5$\n\n$\\text{subtask3}(42pts):~n,m\\le 10^{18},~1\\le T\\le 100,000$\n\nFor Sample 1, you can just write some code and you will know the answer is 55 (just kidding).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "WD与循环", "background": "WD 整日沉浸在循环中，无法自拔……", "description": "这天，WD 蒟蒻为了解决一个小问题写了个很长很长的 for 循环：\n```cpp\nint cnt = 0;\nfor (int a_1 = 0; a_1 <= m; a_1++) {\n    for (int a_2 = 0; a_1 + a_2 <= m; a_2++) {\n    ...\n        for (int a_n = 0; a_1 + a_2 + ... + a_n <= m; a_n++) {\n            cnt = (cnt + 1) % 19491001;\n        }\n    }\n}\nprintf(\"%d\\n\", cnt);\n```\nCX 过来看了一眼，说：**WD 你个笨蛋，这道题不是 SB 题吗？** WD 一脸懵逼，只好请你来教教他啦……", "inputFormat": "第一行一个数 $T$，表示数据组数。接下来每行两个数 $n,m$，分别表示循环重数和每层循环的上界。", "outputFormat": "共 $T$ 行，每行一个数表示答案。", "hint": "$\\text{subtask1}(23pts):~n,m\\le 1,000,~1\\le T\\le 10,000$\n\n$\\text{subtask2}(35pts):~n,m\\le 10^7,~1\\le T\\le 5$\n\n$\\text{subtask3}(42pts):~n,m\\le 10^{18},~1\\le T\\le 100,000$\n\n对于样例 1，写个代码就知道答案是 55 了（大雾）。", "locale": "zh-CN"}}}
{"pid": "P5161", "type": "P", "difficulty": 7, "samples": [["5\n1 2 3 4 5", "13"], ["10\n1 0 -1 -1 -2 -2 -3 -3 -4 -5", "65"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "WD与数列", "background": "WD整日沉浸在数列中，无法自拔……", "description": "WD很喜欢数列。他认为两个序列$A,B$是匹配的，当且仅当$|A|=|B|$且对于$1\\le i,j\\le |A|,A_i-B_i=A_j-B_j$.即长度相同且一个数列同时加上一个数可以和另一个数列完全一样。\n\n现在CX给了他一个长度为$n$的大数列，WD希望知道，数列中有多少对不相交的子串使得他们是匹配的。", "inputFormat": "第一行一个数$n$，表示数列长度。第二行$n$个数，表示序列中的数字。", "outputFormat": "共一行一个数，为匹配的子串个数。", "hint": "对于样例，任意两个不相交且长度相等的子串都是匹配的，长度为1时有10种，长度为2时有3种，因此总共有13种。\n\n$subtask1(11pts):~1\\le n\\le 100$\n\n$subtask2(34pts):~1\\le n\\le 1,000$\n\n$subtask3(55pts):~1\\le n\\le 300,000$\n\n对于所有数据，数列中数字的**绝对值**$\\le 10^9$。$subtask3$的时限为3s，其它为1s.", "locale": "zh-CN", "translations": {"en": {"title": "WD and Sequences", "background": "WD spends all day immersed in sequences and cannot stop.", "description": "WD really likes sequences. He thinks two sequences $A, B$ match if and only if $|A| = |B|$ and for $1 \\le i, j \\le |A|$, $A_i - B_i = A_j - B_j$. That is, they have the same length, and by adding the same number to every element of one sequence, it can become exactly the other sequence.\n\nNow CX gives him a large sequence of length $n$. WD wants to know how many pairs of non-overlapping subarrays in the sequence are matching.", "inputFormat": "The first line contains an integer $n$, representing the length of the sequence. The second line contains $n$ integers, representing the numbers in the sequence.", "outputFormat": "Output one integer in a single line, the number of matching subarrays.", "hint": "For the sample, any two non-overlapping subarrays with the same length are matching. For length $1$ there are $10$ pairs, and for length $2$ there are $3$ pairs, so there are $13$ pairs in total.\n\n$subtask1(11pts):~1\\le n\\le 100$\n\n$subtask2(34pts):~1\\le n\\le 1,000$\n\n$subtask3(55pts):~1\\le n\\le 300,000$\n\nFor all data, the **absolute value** of each number in the sequence is $\\le 10^9$. The time limit for $subtask3$ is $3\\text{s}$, and for the others it is $1\\text{s}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "WD与数列", "background": "WD整日沉浸在数列中，无法自拔……", "description": "WD很喜欢数列。他认为两个序列$A,B$是匹配的，当且仅当$|A|=|B|$且对于$1\\le i,j\\le |A|,A_i-B_i=A_j-B_j$.即长度相同且一个数列同时加上一个数可以和另一个数列完全一样。\n\n现在CX给了他一个长度为$n$的大数列，WD希望知道，数列中有多少对不相交的子串使得他们是匹配的。", "inputFormat": "第一行一个数$n$，表示数列长度。第二行$n$个数，表示序列中的数字。", "outputFormat": "共一行一个数，为匹配的子串个数。", "hint": "对于样例，任意两个不相交且长度相等的子串都是匹配的，长度为1时有10种，长度为2时有3种，因此总共有13种。\n\n$subtask1(11pts):~1\\le n\\le 100$\n\n$subtask2(34pts):~1\\le n\\le 1,000$\n\n$subtask3(55pts):~1\\le n\\le 300,000$\n\n对于所有数据，数列中数字的**绝对值**$\\le 10^9$。$subtask3$的时限为3s，其它为1s.", "locale": "zh-CN"}}}
{"pid": "P5162", "type": "P", "difficulty": 7, "samples": [["4\n1\n2\n3\n4", "1\n665496237\n307152111\n186338949"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "O2优化", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "WD与积木", "background": "WD整日沉浸在积木中，无法自拔……", "description": "WD想买 $n$ 块积木，商场中每块积木的高度都是 $1$，俯视图为正方形（边长不一定相同）。由于一些特殊原因，商家会给每个积木随机一个大小并标号，发给 WD。\n\n接下来 WD 会把相同大小的积木放在一层，并把所有层从大到小堆起来。WD 希望知道所有不同的堆法中层数的期望。**两种堆法不同当且仅当某个积木在两种堆法中处于不同的层中，由于WD只关心积木的相对大小，因此所有堆法等概率出现，而不是随机的大小等概率（可以看样例理解）。**   \n输出结果 $\\bmod \\space 998244353$ 即可。\n\n（如果还是不能够理解题意，请看样例）", "inputFormat": "第一行一个数$T$，表示询问个数。\n\n接下来 $T$ 行每行一个数 $n$，表示 WD 希望使用 $n$ 块积木。", "outputFormat": "共 $T$ 行，每行一个数表示答案 $\\bmod \\space 998244353$。", "hint": "接下来用大括号表示分在一层。\n\n对于$n=1$，合法的分法只有$\\{1\\}$；\n\n对于$n=2$，合法的序列有$\\{1,2\\}$，$\\{1\\}\\{2\\}$，$\\{2\\}\\{1\\}$，期望层数为$\\frac{1+2+2}{3}=665496237(mod~998244353)$；\n\n对于$n=3$，合法的序列有$\\{1\\}\\{2\\}\\{3\\}$，$\\{1\\}\\{3\\}\\{2\\}$，$\\{2\\}\\{1\\}\\{3\\}$，$\\{2\\}\\{3\\}\\{1\\}$，$\\{3\\}\\{1\\}\\{2\\}$，$\\{3\\}\\{2\\}\\{1\\}$\n\n$\\{1,2\\}\\{3\\}$，$\\{1,3\\}\\{2\\}$，$\\{2,3\\}\\{1\\}$，$\\{1\\}\\{2,3\\}$，$\\{2\\}\\{1,3\\}$，$\\{3\\}\\{1,2\\}$，$\\{1,2,3\\}$共13种。因此期望就是$\\frac{6\\times3+6\\times2+1}{13}=307152111(mod~998244353)$\n\n~~对于$n=4$，我想到了一个绝妙的解释，可惜这里写不下。~~\n\n$subtask1(21pts):~1\\le T\\le 1,000,~1\\le n\\le 1,000$\n\n$subtask2(37pts):~1\\le T\\le 10,~1\\le n\\le 100,000$\n\n$subtask3(42pts):~1\\le T\\le 100,000,~1\\le n\\le 100,000$", "locale": "zh-CN", "translations": {"en": {"title": "WD and Building Blocks", "background": "WD is immersed in building blocks all day and cannot stop...", "description": "WD wants to buy $n$ building blocks. In the store, each block has height $1$, and its top view is a square (the side length is not necessarily the same). For some special reasons, the seller will randomly assign each block a size and a label, and give them to WD.\n\nNext, WD will put blocks of the same size into one layer, and stack all layers from large to small. WD wants to know the expected number of layers among all different stacking methods. **Two stacking methods are different if and only if some block is in a different layer in the two methods. Since WD only cares about the relative sizes of the blocks, all stacking methods are equally likely, rather than all random size assignments being equally likely (you can understand this from the samples).**  \nOutput the result $\\bmod \\space 998244353$.\n\n(If you still cannot understand the statement, please look at the samples.)", "inputFormat": "The first line contains an integer $T$, the number of queries.\n\nThen follow $T$ lines, each containing an integer $n$, meaning WD wants to use $n$ building blocks.", "outputFormat": "Output $T$ lines. Each line contains one integer, the answer $\\bmod \\space 998244353$.", "hint": "In the following, curly braces denote blocks placed in the same layer.\n\nFor $n=1$, the only valid arrangement is $\\{1\\}$.\n\nFor $n=2$, the valid sequences are $\\{1,2\\}$, $\\{1\\}\\{2\\}$, $\\{2\\}\\{1\\}$. The expected number of layers is $\\frac{1+2+2}{3}=665496237(mod~998244353)$.\n\nFor $n=3$, the valid sequences are $\\{1\\}\\{2\\}\\{3\\}$, $\\{1\\}\\{3\\}\\{2\\}$, $\\{2\\}\\{1\\}\\{3\\}$, $\\{2\\}\\{3\\}\\{1\\}$, $\\{3\\}\\{1\\}\\{2\\}$, $\\{3\\}\\{2\\}\\{1\\}$,\n\n$\\{1,2\\}\\{3\\}$, $\\{1,3\\}\\{2\\}$, $\\{2,3\\}\\{1\\}$, $\\{1\\}\\{2,3\\}$, $\\{2\\}\\{1,3\\}$, $\\{3\\}\\{1,2\\}$, $\\{1,2,3\\}$, for a total of 13 types. Therefore, the expectation is $\\frac{6\\times3+6\\times2+1}{13}=307152111(mod~998244353)$.\n\n~~For $n=4$, I have a wonderful explanation, but unfortunately there is not enough space to write it here.~~\n\n$subtask1(21pts):~1\\le T\\le 1,000,~1\\le n\\le 1,000$\n\n$subtask2(37pts):~1\\le T\\le 10,~1\\le n\\le 100,000$\n\n$subtask3(42pts):~1\\le T\\le 100,000,~1\\le n\\le 100,000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "WD与积木", "background": "WD整日沉浸在积木中，无法自拔……", "description": "WD想买 $n$ 块积木，商场中每块积木的高度都是 $1$，俯视图为正方形（边长不一定相同）。由于一些特殊原因，商家会给每个积木随机一个大小并标号，发给 WD。\n\n接下来 WD 会把相同大小的积木放在一层，并把所有层从大到小堆起来。WD 希望知道所有不同的堆法中层数的期望。**两种堆法不同当且仅当某个积木在两种堆法中处于不同的层中，由于WD只关心积木的相对大小，因此所有堆法等概率出现，而不是随机的大小等概率（可以看样例理解）。**   \n输出结果 $\\bmod \\space 998244353$ 即可。\n\n（如果还是不能够理解题意，请看样例）", "inputFormat": "第一行一个数$T$，表示询问个数。\n\n接下来 $T$ 行每行一个数 $n$，表示 WD 希望使用 $n$ 块积木。", "outputFormat": "共 $T$ 行，每行一个数表示答案 $\\bmod \\space 998244353$。", "hint": "接下来用大括号表示分在一层。\n\n对于$n=1$，合法的分法只有$\\{1\\}$；\n\n对于$n=2$，合法的序列有$\\{1,2\\}$，$\\{1\\}\\{2\\}$，$\\{2\\}\\{1\\}$，期望层数为$\\frac{1+2+2}{3}=665496237(mod~998244353)$；\n\n对于$n=3$，合法的序列有$\\{1\\}\\{2\\}\\{3\\}$，$\\{1\\}\\{3\\}\\{2\\}$，$\\{2\\}\\{1\\}\\{3\\}$，$\\{2\\}\\{3\\}\\{1\\}$，$\\{3\\}\\{1\\}\\{2\\}$，$\\{3\\}\\{2\\}\\{1\\}$\n\n$\\{1,2\\}\\{3\\}$，$\\{1,3\\}\\{2\\}$，$\\{2,3\\}\\{1\\}$，$\\{1\\}\\{2,3\\}$，$\\{2\\}\\{1,3\\}$，$\\{3\\}\\{1,2\\}$，$\\{1,2,3\\}$共13种。因此期望就是$\\frac{6\\times3+6\\times2+1}{13}=307152111(mod~998244353)$\n\n~~对于$n=4$，我想到了一个绝妙的解释，可惜这里写不下。~~\n\n$subtask1(21pts):~1\\le T\\le 1,000,~1\\le n\\le 1,000$\n\n$subtask2(37pts):~1\\le T\\le 10,~1\\le n\\le 100,000$\n\n$subtask3(42pts):~1\\le T\\le 100,000,~1\\le n\\le 100,000$", "locale": "zh-CN"}}}
{"pid": "P5163", "type": "P", "difficulty": 7, "samples": [["5 8 8\n4 2 1 1 3\n2 5\n4 2\n5 3\n1 3\n4 5\n5 1\n1 5\n1 4\n3 3 1\n1 4 5\n3 3 3\n3 4 1\n3 1 5\n3 2 4\n1 5 3\n2 3 4", "1\n1\n4\n10\n10"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "O2优化", "强连通分量", "Tarjan", "整体二分", "线段树合并"], "title": "WD与地图", "background": "WD 整日沉浸在地图中，无法自拔……", "description": "CX 让 WD 研究的地图可以看做是 $n$ 个点，$m$ 条边的有向图，由于政府正在尝试优化人民生活，他们会废弃一些无用的道路来把省下的钱用于经济建设。\n\n城市都有各自的发达程度 $s_i$。为了方便管理，政府将整个地图划分为一些地区，两个点 $u,v$ 在一个地区当且仅当 $u,v$ 可以互相到达。政府希望知道一些时刻某个地区的前 $k$ 发达城市的发达程度总和，以此推断建设的情况。\n\n也就是说，共有三个操作：\n\n`1 a b` 表示政府废弃了从 $a$ 连向 $b$ 的边，保证这条边存在。\n\n`2 a b` 表示政府把钱用于建设城市 $a$，使其发达程度增加 $b$。\n\n`3 a b` 表示政府希望知道 $a$ 城市所在地区发达程度前 $b$ 大城市的发达程度之和。如果地区中的城市不足 $b$ 个输出该地区所有城市的发达程度总和。", "inputFormat": "第一行两个数 $n,m,q$，表示共 $n$ 个点，$m$ 条边，$q$ 次询问。\n\n第二行 $n$ 个正整数，表示 $s_i$，即每个城市的发达程度。\n\n接下来 $m$ 行每行两个数 $u,v$，表示初始时有一条从 $u$ 连向 $v$ 的边。\n\n接下来 $q$ 行，表示 $q$ 组询问，格式如题目描述。", "outputFormat": "对于每个询问操作，输出一个数，表示发达程度之和。", "hint": "$subtask1(19pts):~n\\le 100,000,~m\\le 200,000,~q\\le 200,000$，删除操作个数$\\times m\\le 1,000,000$\n\n$subtask2(39pts):~n\\le 5,000,~m\\le 8,000,~q\\le 200,000$\n\n$subtask3(42pts):~n\\le 100,000,~m\\le 200,000,~q\\le 200,000$\n\n保证任何时刻发达程度$\\le 10^9$，无重边（反向边不算重边）无自环。", "locale": "zh-CN", "translations": {"en": {"title": "WD and the Map.", "background": "WD spends all day immersed in maps and cannot pull himself out.", "description": "The map that CX asks WD to study can be seen as a directed graph with $n$ nodes and $m$ edges. Since the government is trying to improve people's lives, they will remove some useless roads and use the saved money for economic development.\n\nEach city has its own development level $s_i$. For easier management, the government divides the whole map into some regions. Two nodes $u, v$ are in the same region if and only if $u, v$ can reach each other. The government wants to know, at certain times, the sum of the development levels of the top $k$ most developed cities in a region, in order to judge the construction situation.\n\nThat is, there are three operations in total:\n\n`1 a b` means the government removes the edge from $a$ to $b$, and it is guaranteed that this edge exists.\n\n`2 a b` means the government invests money to build city $a$, increasing its development level by $b$.\n\n`3 a b` means the government wants to know the sum of the development levels of the top $b$ cities (by development level) in the region where city $a$ is located. If there are fewer than $b$ cities in the region, output the sum of the development levels of all cities in that region.", "inputFormat": "The first line contains three integers $n, m, q$, meaning there are $n$ nodes, $m$ edges, and $q$ queries.\n\nThe second line contains $n$ positive integers, representing $s_i$, i.e., the development level of each city.\n\nThe next $m$ lines each contain two integers $u, v$, indicating that initially there is an edge from $u$ to $v$.\n\nThe next $q$ lines describe the $q$ queries, in the format given in the description.", "outputFormat": "For each query operation, output one integer, representing the sum of development levels.", "hint": "$subtask1(19pts):~n\\le 100,000,~m\\le 200,000,~q\\le 200,000$, number of delete operations $\\times m\\le 1,000,000$.\n\n$subtask2(39pts):~n\\le 5,000,~m\\le 8,000,~q\\le 200,000$.\n\n$subtask3(42pts):~n\\le 100,000,~m\\le 200,000,~q\\le 200,000$.\n\nIt is guaranteed that at any time the development level $\\le 10^9$. There are no multiple edges (reverse edges are not considered multiple edges) and no self-loops.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "WD与地图", "background": "WD 整日沉浸在地图中，无法自拔……", "description": "CX 让 WD 研究的地图可以看做是 $n$ 个点，$m$ 条边的有向图，由于政府正在尝试优化人民生活，他们会废弃一些无用的道路来把省下的钱用于经济建设。\n\n城市都有各自的发达程度 $s_i$。为了方便管理，政府将整个地图划分为一些地区，两个点 $u,v$ 在一个地区当且仅当 $u,v$ 可以互相到达。政府希望知道一些时刻某个地区的前 $k$ 发达城市的发达程度总和，以此推断建设的情况。\n\n也就是说，共有三个操作：\n\n`1 a b` 表示政府废弃了从 $a$ 连向 $b$ 的边，保证这条边存在。\n\n`2 a b` 表示政府把钱用于建设城市 $a$，使其发达程度增加 $b$。\n\n`3 a b` 表示政府希望知道 $a$ 城市所在地区发达程度前 $b$ 大城市的发达程度之和。如果地区中的城市不足 $b$ 个输出该地区所有城市的发达程度总和。", "inputFormat": "第一行两个数 $n,m,q$，表示共 $n$ 个点，$m$ 条边，$q$ 次询问。\n\n第二行 $n$ 个正整数，表示 $s_i$，即每个城市的发达程度。\n\n接下来 $m$ 行每行两个数 $u,v$，表示初始时有一条从 $u$ 连向 $v$ 的边。\n\n接下来 $q$ 行，表示 $q$ 组询问，格式如题目描述。", "outputFormat": "对于每个询问操作，输出一个数，表示发达程度之和。", "hint": "$subtask1(19pts):~n\\le 100,000,~m\\le 200,000,~q\\le 200,000$，删除操作个数$\\times m\\le 1,000,000$\n\n$subtask2(39pts):~n\\le 5,000,~m\\le 8,000,~q\\le 200,000$\n\n$subtask3(42pts):~n\\le 100,000,~m\\le 200,000,~q\\le 200,000$\n\n保证任何时刻发达程度$\\le 10^9$，无重边（反向边不算重边）无自环。", "locale": "zh-CN"}}}
{"pid": "P5164", "type": "P", "difficulty": 5, "samples": [["3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "xtq的定向越野", "background": "xtq在定向越野方面有异于常人的天赋，小学一年级时就获得了“题刷杯”的第一名和“蝈蝈杯”的“蝈蝈”。有一天，他正在研究一个问题。", "description": "xtq希望设计一个圆形地图，这可以视作一个圆，圆周上有任意多个互不重叠的打卡点，打卡点上有一些任务。\n\n设所有可能的任务为一个$k$元集合，则这个集合有$2^k$个互不相同子集，设为$A_1,A_2......A_{2^k}$，那么每一个打卡点上都有且仅有$A_1,A_2......A_{2^k}$中的一个任务子集。注意：不同的点可以有相同的任务子集。\n\nxtq想要满足以下条件：\n\n$1$:对于满足$||Ai|-|Aj||=1$的任意子集$Ai$，$Aj$，都有且仅有一对相邻打卡点的任务子集为$Ai$、$Aj$\n\n$2$:对于任意相邻的点上的子集$Ai$，$Aj$，均满足$||Ai|-|Aj||=1$\n\n现在xtq给了你一个$n$，希望让你求出所有可能的$2\\le k\\le n$，使得至少存在一种放置打卡点和任务的方案。\n\n在以上的描述中，$|Ai|$表示$|Ai|$的元素个数，$|a+b|$表示$a+b$的绝对值", "inputFormat": "一个正整数$n$。", "outputFormat": "若干行，每行一个正整数，表示一个可能的$k$，按大小升序排列。", "hint": "[样例解释]\n\n当$k=2$时，设所有可能的任务是$\\{1,2\\}$，则任务的4个子集是$\\emptyset$,$\\{1\\}$,$\\{2\\}$,$\\{1,2\\}$。下图是一种符合条件的方案：\n\n![](https://cdn.luogu.com.cn/upload/pic/45633.png)\n\n图中$\\{\\emptyset\\}$应当为$\\emptyset$(typo)\n\n[数据范围]\n\n对于$50\\%$的数据，$n\\le 5000$。\n\n对于$100\\%$的数据，属于$long long$范围内，并且$2\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "xtq's Orienteering", "background": "xtq has an unusual talent for orienteering. In first grade, he won first place in the \"Problem-Solving Cup\" and also won the \"Cricket Cup\" \"cricket\". One day, he was studying a problem.", "description": "xtq wants to design a circular map, which can be seen as a circle. On the circumference, there are any number of non-overlapping checkpoints, and each checkpoint has some tasks.\n\nLet all possible tasks form a $k$-element set. Then this set has $2^k$ distinct subsets, denoted as $A_1,A_2......A_{2^k}$. Each checkpoint has exactly one task subset among $A_1,A_2......A_{2^k}$. Note that different checkpoints may have the same task subset.\n\nxtq wants to satisfy the following conditions:\n\n$1$: For any subsets $Ai$, $Aj$ satisfying $||Ai|-|Aj||=1$, there exists exactly one pair of adjacent checkpoints whose task subsets are $Ai$ and $Aj$.\n\n$2$: For any adjacent checkpoints with subsets $Ai$, $Aj$, it always holds that $||Ai|-|Aj||=1$.\n\nNow xtq gives you an $n$, and he wants you to find all possible $2\\le k\\le n$ such that there exists at least one way to place checkpoints and assign tasks.\n\nIn the above description, $|Ai|$ denotes the number of elements in $|Ai|$, and $|a+b|$ denotes the absolute value of $a+b$.", "inputFormat": "One positive integer $n$.", "outputFormat": "Output several lines. Each line contains one positive integer, representing a possible $k$, in increasing order.", "hint": "[Sample Explanation]\n\nWhen $k=2$, suppose all possible tasks are $\\{1,2\\}$. Then the 4 subsets of tasks are $\\emptyset$, $\\{1\\}$, $\\{2\\}$, $\\{1,2\\}$. The following figure shows one valid arrangement:\n\n![](https://cdn.luogu.com.cn/upload/pic/45633.png)\n\nIn the figure, $\\{\\emptyset\\}$ should be $\\emptyset$ (typo).\n\n[Constraints]\n\nFor $50\\%$ of the testdata, $n\\le 5000$.\n\nFor $100\\%$ of the testdata, $n$ fits in the range of $long long$, and $2\\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq的定向越野", "background": "xtq在定向越野方面有异于常人的天赋，小学一年级时就获得了“题刷杯”的第一名和“蝈蝈杯”的“蝈蝈”。有一天，他正在研究一个问题。", "description": "xtq希望设计一个圆形地图，这可以视作一个圆，圆周上有任意多个互不重叠的打卡点，打卡点上有一些任务。\n\n设所有可能的任务为一个$k$元集合，则这个集合有$2^k$个互不相同子集，设为$A_1,A_2......A_{2^k}$，那么每一个打卡点上都有且仅有$A_1,A_2......A_{2^k}$中的一个任务子集。注意：不同的点可以有相同的任务子集。\n\nxtq想要满足以下条件：\n\n$1$:对于满足$||Ai|-|Aj||=1$的任意子集$Ai$，$Aj$，都有且仅有一对相邻打卡点的任务子集为$Ai$、$Aj$\n\n$2$:对于任意相邻的点上的子集$Ai$，$Aj$，均满足$||Ai|-|Aj||=1$\n\n现在xtq给了你一个$n$，希望让你求出所有可能的$2\\le k\\le n$，使得至少存在一种放置打卡点和任务的方案。\n\n在以上的描述中，$|Ai|$表示$|Ai|$的元素个数，$|a+b|$表示$a+b$的绝对值", "inputFormat": "一个正整数$n$。", "outputFormat": "若干行，每行一个正整数，表示一个可能的$k$，按大小升序排列。", "hint": "[样例解释]\n\n当$k=2$时，设所有可能的任务是$\\{1,2\\}$，则任务的4个子集是$\\emptyset$,$\\{1\\}$,$\\{2\\}$,$\\{1,2\\}$。下图是一种符合条件的方案：\n\n![](https://cdn.luogu.com.cn/upload/pic/45633.png)\n\n图中$\\{\\emptyset\\}$应当为$\\emptyset$(typo)\n\n[数据范围]\n\n对于$50\\%$的数据，$n\\le 5000$。\n\n对于$100\\%$的数据，属于$long long$范围内，并且$2\\le n$。", "locale": "zh-CN"}}}
{"pid": "P5165", "type": "P", "difficulty": 6, "samples": [["3 1 1 3", "13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "矩阵加速"], "title": "xtq的棋盘", "background": "自从二年级起，xtq就热爱棋类游戏。", "description": "xtq有一个$1$行，$n+1$列的棋盘，从左到右编号为$0$到$n$。初始时刻，在$m$位置有一颗棋子。\n\nxtq会在接下来的时间里随机操作。具体地说，如果某一秒棋子不位于$n$，那么他将有$prb$的概率将棋子向左移动一格，$1-prb$的概率向右移动一格；否则，他必然将棋子向左移动一格。\n\n现在xtq想问你，期望多少秒之后棋子能够到达$0$。由于答案可能很大，并且为了避免不必要的精度误差，你只需要给出答案对于$10^9+7$取模的结果即可（可以证明，答案必然是一个有理数）。", "inputFormat": "一行四个正整数$n,m,p,q$。\n\n其中，$p,q$表示$prb = \\frac{p}{q}$。", "outputFormat": "一行，一个正整数，表示期望移动次数对$10^9+7$取模的结果。", "hint": "对于$20\\%$的数据，$n\\le 4, 1\\le p\\le q\\le 4$而且保证答案在取模前是一个整数。\n\n对于$40\\%$的数据，$n\\le 300$。\n\n对于$70\\%$的数据，$n\\le 1000000$。\n\n对于$100\\%$的数据，$1\\le m\\le n\\le 10^9, 1\\le p\\le q\\le 10^9$并且$p,q$互质。\n\n此外，在全部的数据点中，有$30\\%$的数据是满足$prb = \\frac{1}{2}$的。\n\n有理数对质数$p$取模定义如下：\n\n设$\\frac{a}{b}$对$p$取模的结果为$x$，那么需要满足$0\\le x<p$且$a \\equiv bx (mod p)$。\n\n保证对于$100\\%$的数据，一定存在满足要求的$x$。", "locale": "zh-CN", "translations": {"en": {"title": "xtq's Chessboard", "background": "Since second grade, xtq has loved board games.", "description": "xtq has a chessboard with $1$ row and $n+1$ columns, numbered from $0$ to $n$ from left to right. At the initial moment, there is a piece at position $m$.\n\nxtq will perform random operations over time. Specifically, if in a given second the piece is not at $n$, then with probability $prb$ he moves the piece one cell to the left, and with probability $1-prb$ he moves it one cell to the right; otherwise (when the piece is at $n$), he will definitely move the piece one cell to the left.\n\nNow xtq wants to ask you: what is the expected number of seconds until the piece can reach $0$? Since the answer may be very large, and to avoid unnecessary precision errors, you only need to output the answer modulo $10^9+7$ (it can be proven that the answer must be a rational number).", "inputFormat": "One line with four positive integers $n, m, p, q$.\n\nHere, $p, q$ mean $prb = \\frac{p}{q}$.", "outputFormat": "One line with one positive integer, representing the expected number of moves modulo $10^9+7$.", "hint": "For $20\\%$ of the testdata, $n\\le 4$, $1\\le p\\le q\\le 4$, and it is guaranteed that the answer is an integer before taking modulo.\n\nFor $40\\%$ of the testdata, $n\\le 300$.\n\nFor $70\\%$ of the testdata, $n\\le 1000000$.\n\nFor $100\\%$ of the testdata, $1\\le m\\le n\\le 10^9$, $1\\le p\\le q\\le 10^9$, and $p, q$ are coprime.\n\nIn addition, among all testdata points, $30\\%$ of the testdata satisfies $prb = \\frac{1}{2}$.\n\nThe modulo of a rational number with respect to a prime $p$ is defined as follows:\n\nLet the result of $\\frac{a}{b}$ modulo $p$ be $x$. Then it must satisfy $0\\le x<p$ and $a \\equiv bx (mod p)$.\n\nIt is guaranteed that for $100\\%$ of the testdata, such an $x$ satisfying the requirements always exists.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq的棋盘", "background": "自从二年级起，xtq就热爱棋类游戏。", "description": "xtq有一个$1$行，$n+1$列的棋盘，从左到右编号为$0$到$n$。初始时刻，在$m$位置有一颗棋子。\n\nxtq会在接下来的时间里随机操作。具体地说，如果某一秒棋子不位于$n$，那么他将有$prb$的概率将棋子向左移动一格，$1-prb$的概率向右移动一格；否则，他必然将棋子向左移动一格。\n\n现在xtq想问你，期望多少秒之后棋子能够到达$0$。由于答案可能很大，并且为了避免不必要的精度误差，你只需要给出答案对于$10^9+7$取模的结果即可（可以证明，答案必然是一个有理数）。", "inputFormat": "一行四个正整数$n,m,p,q$。\n\n其中，$p,q$表示$prb = \\frac{p}{q}$。", "outputFormat": "一行，一个正整数，表示期望移动次数对$10^9+7$取模的结果。", "hint": "对于$20\\%$的数据，$n\\le 4, 1\\le p\\le q\\le 4$而且保证答案在取模前是一个整数。\n\n对于$40\\%$的数据，$n\\le 300$。\n\n对于$70\\%$的数据，$n\\le 1000000$。\n\n对于$100\\%$的数据，$1\\le m\\le n\\le 10^9, 1\\le p\\le q\\le 10^9$并且$p,q$互质。\n\n此外，在全部的数据点中，有$30\\%$的数据是满足$prb = \\frac{1}{2}$的。\n\n有理数对质数$p$取模定义如下：\n\n设$\\frac{a}{b}$对$p$取模的结果为$x$，那么需要满足$0\\le x<p$且$a \\equiv bx (mod p)$。\n\n保证对于$100\\%$的数据，一定存在满足要求的$x$。", "locale": "zh-CN"}}}
{"pid": "P5166", "type": "P", "difficulty": 4, "samples": [["4 4\n1 3\n1 3\n1 4\n0\n1 2 3\n1 1 1\n2 2 3 1\n1 1 1", "1\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树"], "title": "xtq的口令", "background": "三年级时，xtq 就展现出高超的身体素质，以至于体育老师允许他不用参加同学们的体育锻炼，而是可以自由活动。\n\nxtq 现在正在观察同学们跑步。", "description": "$n$ 个同学在排队跑步。\n\n体育老师发了一条指令，要求这 $n$ 名同学加快跑步速度。然而，由于风太大，只有部分同学听到并执行了老师的指令。同时，没有听到指令的同学如果观察到其他的同学执行了老师的指令，他们也会执行老师的指令。\n\n现在我们一般化这个情况。我们将位于队首的同学编号为 $1$，将接下来的同学以此类推，最后位于队尾的同学编号为 $n$。\n\n经过观察，xtq 给出了每位同学的若干位观察对象，这意味着当这位同学看到他的任何一个观察对象加快跑步速度（执行指令）时，他也会加快跑步速度（执行指令）。保证对于任何一位同学，他的所有观察对象的编号都小于自己（一个同学只会观察排在自己前面同学中的一部分）。\n\n现在有 $q$ 条询问或修改，\n\n询问：格式为 ```1 L R```。\n\n回答如果编号在 $\\left[L,R \\right]$ 范围内的同学听到了指令，至少还需要多少个同学听到指令才能使所有人执行指令。\n\n修改：格式为 ```2 L R x```。\n\n给在 $\\left[L,R \\right]$ 的同学添加第 $x$ 位同学作为自己的观察对象。保证 $x < L$。如果区间内有人原来的观察对象有第 $x$ 位同学，忽略即可。", "inputFormat": "第一行两个整数 $n,q$。\n\n接下来 $n$ 行，每行第一个整数 $a_i$，代表第 $i$ 位同学被共计 $a_i$ 位同学观察。接下来 $a_i$ 个整数，代表观察第 $i$ 位同学的编号。若 $a_i=0$，代表没有同学观察这位同学。由于一个同学只会被自己后面的同学观察，所以输入的编号一定大于这位同学自己的编号。\n\n#### 注意输入的编号是观察第 $i$ 位同学的同学编号，而不是被第 $i$ 位同学观察的同学编号。\n\n接下来 $q$ 行，每行一个询问或修改，格式见题目描述。", "outputFormat": "对于每个询问操作，输出至少还需要几位同学知道指令，才能使最终每位同学都接执行了老师的指令。", "hint": "【样例解释】\n\n样例中，$1$ 号同学被 $3$ 号同学观察，$2$ 号同学被 $3$ 号同学观察，$3$ 号同学被 $4$ 号同学观察。\n\n对于第一个询问 ```1 2 3```：这意味着 $2,3$ 号两位同学听到了老师的指令。因为 $3$ 号同学被 $4$ 号同学观察，所以当 $3$ 号同学加快跑步速度后，$4$ 号同学也会加快跑步速度。所以需要告诉 $1$ 号同学指令是什么，才能使所有同学收到指令。\n\n【数据范围】\n|编号|n|特殊性质|\n| ------ | ------ | ------ |\n|1|$10$|有|\n|2|$10$|无|\n|3|$500$|有|\n|4|$5000$|无|\n|5|$5000$|无|\n|6|$50000$|有|\n|7|$50000$|无|\n|8|$3 \\times 10^5$|有|\n|9|$3 \\times 10^5$|无|\n|10|$3 \\times 10^5$|无|\n\n特殊性质：修改操作不超过 $100$ 次。\n\n对于 $100\\%$ 的数据，$n,q\\le 3 \\times 10^5$，$\\sum a_i\\le 10^7$。\n\n由于本题输入输出量大，请不要使用 cin/cout。", "locale": "zh-CN", "translations": {"en": {"title": "xtq's Password", "background": "In third grade, xtq already showed excellent physical fitness, so the PE teacher allowed him to skip the class exercises and move freely.\n\nxtq is now observing his classmates running.", "description": "There are $n$ students lined up for running.\n\nThe PE teacher gave an order, asking these $n$ students to speed up. However, because the wind was too strong, only some students heard and carried out the order. At the same time, if a student who did not hear the order observes other students carrying out the order, he will also carry out the order.\n\nNow we generalize this situation. We number the student at the front of the line as $1$, the next as $2$, and so on, with the student at the end numbered $n$.\n\nAfter observation, xtq provides for each student several observed targets. This means that when this student sees any one of his observed targets speed up (carry out the order), he will also speed up (carry out the order). It is guaranteed that for any student, all of his observed targets have indices smaller than his own (a student only observes some of the students in front of him).\n\nNow there are $q$ queries or modifications:\n\nQuery: in the form of ```1 L R```.\n\nAnswer: if the students with indices in $\\left[L,R \\right]$ have heard the order, at least how many more students need to hear the order to make everyone carry out the order.\n\nModification: in the form of ```2 L R x```.\n\nFor each student in $\\left[L,R \\right]$, add student $x$ as one of his observed targets. It is guaranteed that $x < L$. If someone in the interval already has student $x$ as an observed target, ignore it.", "inputFormat": "The first line contains two integers $n,q$.\n\nIn the next $n$ lines, the first integer of each line is $a_i$, meaning student $i$ is observed by a total of $a_i$ students. Then follow $a_i$ integers, which are the indices of the students who observe student $i$. If $a_i=0$, it means no one observes this student. Since a student can only be observed by students behind him, the input indices are guaranteed to be greater than this student's own index.\n\n#### Note that the input indices are the indices of students who observe student $i$, not the indices of students observed by student $i$.\n\nThen follow $q$ lines, each being a query or a modification, in the formats described above.", "outputFormat": "For each query operation, output the minimum number of additional students who need to know the order so that eventually every student carries out the teacher's order.", "hint": "【Sample Explanation】\n\nIn the sample, student $1$ is observed by student $3$, student $2$ is observed by student $3$, and student $3$ is observed by student $4$.\n\nFor the first query ```1 2 3```: this means students $2$ and $3$ heard the teacher's order. Since student $3$ is observed by student $4$, after student $3$ speeds up, student $4$ will also speed up. Therefore, we need to tell student $1$ what the order is, so that all students receive the order.\n\n【Constraints】\n|ID|n|Special Property|\n| ------ | ------ | ------ |\n|1|$10$|Yes|\n|2|$10$|No|\n|3|$500$|Yes|\n|4|$5000$|No|\n|5|$5000$|No|\n|6|$50000$|Yes|\n|7|$50000$|No|\n|8|$3 \\times 10^5$|Yes|\n|9|$3 \\times 10^5$|No|\n|10|$3 \\times 10^5$|No|\n\nSpecial Property: the number of modification operations does not exceed $100$.\n\nFor $100\\%$ of the testdata, $n,q\\le 3 \\times 10^5$, $\\sum a_i\\le 10^7$.\n\nBecause the input and output size of this problem is large, please do not use cin/cout.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq的口令", "background": "三年级时，xtq 就展现出高超的身体素质，以至于体育老师允许他不用参加同学们的体育锻炼，而是可以自由活动。\n\nxtq 现在正在观察同学们跑步。", "description": "$n$ 个同学在排队跑步。\n\n体育老师发了一条指令，要求这 $n$ 名同学加快跑步速度。然而，由于风太大，只有部分同学听到并执行了老师的指令。同时，没有听到指令的同学如果观察到其他的同学执行了老师的指令，他们也会执行老师的指令。\n\n现在我们一般化这个情况。我们将位于队首的同学编号为 $1$，将接下来的同学以此类推，最后位于队尾的同学编号为 $n$。\n\n经过观察，xtq 给出了每位同学的若干位观察对象，这意味着当这位同学看到他的任何一个观察对象加快跑步速度（执行指令）时，他也会加快跑步速度（执行指令）。保证对于任何一位同学，他的所有观察对象的编号都小于自己（一个同学只会观察排在自己前面同学中的一部分）。\n\n现在有 $q$ 条询问或修改，\n\n询问：格式为 ```1 L R```。\n\n回答如果编号在 $\\left[L,R \\right]$ 范围内的同学听到了指令，至少还需要多少个同学听到指令才能使所有人执行指令。\n\n修改：格式为 ```2 L R x```。\n\n给在 $\\left[L,R \\right]$ 的同学添加第 $x$ 位同学作为自己的观察对象。保证 $x < L$。如果区间内有人原来的观察对象有第 $x$ 位同学，忽略即可。", "inputFormat": "第一行两个整数 $n,q$。\n\n接下来 $n$ 行，每行第一个整数 $a_i$，代表第 $i$ 位同学被共计 $a_i$ 位同学观察。接下来 $a_i$ 个整数，代表观察第 $i$ 位同学的编号。若 $a_i=0$，代表没有同学观察这位同学。由于一个同学只会被自己后面的同学观察，所以输入的编号一定大于这位同学自己的编号。\n\n#### 注意输入的编号是观察第 $i$ 位同学的同学编号，而不是被第 $i$ 位同学观察的同学编号。\n\n接下来 $q$ 行，每行一个询问或修改，格式见题目描述。", "outputFormat": "对于每个询问操作，输出至少还需要几位同学知道指令，才能使最终每位同学都接执行了老师的指令。", "hint": "【样例解释】\n\n样例中，$1$ 号同学被 $3$ 号同学观察，$2$ 号同学被 $3$ 号同学观察，$3$ 号同学被 $4$ 号同学观察。\n\n对于第一个询问 ```1 2 3```：这意味着 $2,3$ 号两位同学听到了老师的指令。因为 $3$ 号同学被 $4$ 号同学观察，所以当 $3$ 号同学加快跑步速度后，$4$ 号同学也会加快跑步速度。所以需要告诉 $1$ 号同学指令是什么，才能使所有同学收到指令。\n\n【数据范围】\n|编号|n|特殊性质|\n| ------ | ------ | ------ |\n|1|$10$|有|\n|2|$10$|无|\n|3|$500$|有|\n|4|$5000$|无|\n|5|$5000$|无|\n|6|$50000$|有|\n|7|$50000$|无|\n|8|$3 \\times 10^5$|有|\n|9|$3 \\times 10^5$|无|\n|10|$3 \\times 10^5$|无|\n\n特殊性质：修改操作不超过 $100$ 次。\n\n对于 $100\\%$ 的数据，$n,q\\le 3 \\times 10^5$，$\\sum a_i\\le 10^7$。\n\n由于本题输入输出量大，请不要使用 cin/cout。", "locale": "zh-CN"}}}
{"pid": "P5167", "type": "P", "difficulty": 6, "samples": [["1\n6 2\n3 1 4 5 6 2\n6 -2\n", "31\n"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "xtq 的神笔", "background": "xtq 在小学四年级的时候得到了一套神奇的画笔。为了测试神笔的威力（以及展现自己过人的艺术天赋），他决定先为美术老师临摹几幅画。", "description": "每幅画的形态可以抽象为排成一列的 $n$ 个格子，其中第 $i$ 个格子具有一个权值 $a_i$。\n\nxtq 有足够多不同颜色的画笔，每当他使用一根笔，他可以在格子上画下至少长度为 $k$ 的连续一段，然后再换另一根笔从下一个格子继续画，其中 $k<n$。\n\n美术老师为了考验 xtq 的绘画功力，为他设置了一些挑战。\n\n他可以从 $1$ 到 $k$ 的任意一个格子开始画到编号为 $n$ 的格子，其中从第 $i$ 个格子开始会获得 $b_i$ 的得分。\n\n假设 xtq 使用同一根画笔，从编号为 $i$ 的格子连续地画到编号为 $j$ 的格子，他就会获得（$a_i \\mathbin{\\mathrm{or}} a_{i+1} \\mathbin{\\mathrm{or}} a_{i+2} \\mathbin{\\mathrm{or}} \\cdots \\mathbin{\\mathrm{or}} a_j) + (a_i \\mathbin{\\mathrm{and}} a_{i+1} \\mathbin{\\mathrm{and}} a_{i+2} \\mathbin{\\mathrm{and}} \\cdots \\mathbin{\\mathrm{and}} a_j) + \\gcd(a_i, a_{i+1}, a_{i+2}, \\ldots, a_j)$ 的分数，其中 $\\gcd$ 代表最大公约数。\n\n现在，xtq 希望找到一种安排画笔使用的方案，使得对于每一幅需要临摹的画，他总共获得的分数尽量多。", "inputFormat": "第一行，一个正整数 $T$，表示画的数量。\n\n对于每一幅画：\n\n第一行，两个正整数 $n, k$。\n\n第二行，$n$ 个正整数 $a_1, a_2, a_3, \\ldots , a_n$。\n\n第三行，$k$ 个整数 $b_1, b_2, b_3, \\ldots , b_k$。", "outputFormat": "对于每一幅画，输出一个整数，代表 xtq 完成这幅画最多能获得的分数。", "hint": "样例解释：\n\nxtq 可以从 $1$ 开始，获得 $6$ 分初始得分；第一段画 $[1,2]$，获得 $5$ 分；第二段画 $[3,4]$，获得 $10$ 分；第三段画 $[5,6]$，获得 $10$ 分。共 $31$ 分。\n\n对于 $20\\%$ 的数据，$n\\le 10$。  \n对于 $40\\%$ 的数据，$n\\le 3000$。  \n对于 $70\\%$ 的数据，$n\\le 30000$。  \n对于 $100\\%$ 的数据，$1\\le k<n\\le 3 \\times {10}^5$，$T\\le 10$，$1\\le a_i\\le 2^{30}$，$-2^{30}\\le b_i\\le 2^{30}$。\n\n数据有梯度，应该不太卡常。", "locale": "zh-CN", "translations": {"en": {"title": "xtq’s Magic Brush", "background": "When xtq was in fourth grade, he got a set of magical paintbrushes. To test how powerful the brushes were (and to show off his strong artistic talent), he decided to copy several paintings for his art teacher.", "description": "The shape of each painting can be abstracted as $n$ cells in a row, where the $i$-th cell has a weight $a_i$.\n\nxtq has enough paintbrushes of different colors. Each time he uses one brush, he can paint a continuous segment on the cells with length at least $k$, and then switch to another brush and continue painting starting from the next cell, where $k<n$.\n\nTo test xtq’s painting skills, the art teacher sets some challenges.\n\nHe may start painting from any cell between $1$ and $k$ (inclusive) and paint all the way to cell $n$. If he starts from cell $i$, he gains an initial score of $b_i$.\n\nSuppose xtq uses the same brush to paint continuously from cell $i$ to cell $j$. Then he gains a score of $(a_i \\mathbin{\\mathrm{or}} a_{i+1} \\mathbin{\\mathrm{or}} a_{i+2} \\mathbin{\\mathrm{or}} \\cdots \\mathbin{\\mathrm{or}} a_j) + (a_i \\mathbin{\\mathrm{and}} a_{i+1} \\mathbin{\\mathrm{and}} a_{i+2} \\mathbin{\\mathrm{and}} \\cdots \\mathbin{\\mathrm{and}} a_j) + \\gcd(a_i, a_{i+1}, a_{i+2}, \\ldots, a_j)$, where $\\gcd$ denotes the greatest common divisor.\n\nNow, xtq wants to find a plan for using the brushes so that for each painting he needs to copy, his total score is as large as possible.", "inputFormat": "The first line contains a positive integer $T$, representing the number of paintings.\n\nFor each painting:\n\nThe first line contains two positive integers $n, k$.\n\nThe second line contains $n$ positive integers $a_1, a_2, a_3, \\ldots , a_n$.\n\nThe third line contains $k$ integers $b_1, b_2, b_3, \\ldots , b_k$.", "outputFormat": "For each painting, output one integer, representing the maximum score xtq can obtain after completing this painting.", "hint": "Sample explanation:\n\nxtq can start from $1$ and gain an initial score of $6$ points. The first segment is $[1,2]$, gaining $5$ points; the second segment is $[3,4]$, gaining $10$ points; the third segment is $[5,6]$, gaining $10$ points. In total, $31$ points.\n\nConstraints:\n\nFor $20\\%$ of the testdata, $n\\le 10$.  \nFor $40\\%$ of the testdata, $n\\le 3000$.  \nFor $70\\%$ of the testdata, $n\\le 30000$.  \nFor $100\\%$ of the testdata, $1\\le k<n\\le 3 \\times {10}^5$, $T\\le 10$, $1\\le a_i\\le 2^{30}$, $-2^{30}\\le b_i\\le 2^{30}$.\n\nThe testdata has multiple levels, so it should not be too strict on constant factors.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq 的神笔", "background": "xtq 在小学四年级的时候得到了一套神奇的画笔。为了测试神笔的威力（以及展现自己过人的艺术天赋），他决定先为美术老师临摹几幅画。", "description": "每幅画的形态可以抽象为排成一列的 $n$ 个格子，其中第 $i$ 个格子具有一个权值 $a_i$。\n\nxtq 有足够多不同颜色的画笔，每当他使用一根笔，他可以在格子上画下至少长度为 $k$ 的连续一段，然后再换另一根笔从下一个格子继续画，其中 $k<n$。\n\n美术老师为了考验 xtq 的绘画功力，为他设置了一些挑战。\n\n他可以从 $1$ 到 $k$ 的任意一个格子开始画到编号为 $n$ 的格子，其中从第 $i$ 个格子开始会获得 $b_i$ 的得分。\n\n假设 xtq 使用同一根画笔，从编号为 $i$ 的格子连续地画到编号为 $j$ 的格子，他就会获得（$a_i \\mathbin{\\mathrm{or}} a_{i+1} \\mathbin{\\mathrm{or}} a_{i+2} \\mathbin{\\mathrm{or}} \\cdots \\mathbin{\\mathrm{or}} a_j) + (a_i \\mathbin{\\mathrm{and}} a_{i+1} \\mathbin{\\mathrm{and}} a_{i+2} \\mathbin{\\mathrm{and}} \\cdots \\mathbin{\\mathrm{and}} a_j) + \\gcd(a_i, a_{i+1}, a_{i+2}, \\ldots, a_j)$ 的分数，其中 $\\gcd$ 代表最大公约数。\n\n现在，xtq 希望找到一种安排画笔使用的方案，使得对于每一幅需要临摹的画，他总共获得的分数尽量多。", "inputFormat": "第一行，一个正整数 $T$，表示画的数量。\n\n对于每一幅画：\n\n第一行，两个正整数 $n, k$。\n\n第二行，$n$ 个正整数 $a_1, a_2, a_3, \\ldots , a_n$。\n\n第三行，$k$ 个整数 $b_1, b_2, b_3, \\ldots , b_k$。", "outputFormat": "对于每一幅画，输出一个整数，代表 xtq 完成这幅画最多能获得的分数。", "hint": "样例解释：\n\nxtq 可以从 $1$ 开始，获得 $6$ 分初始得分；第一段画 $[1,2]$，获得 $5$ 分；第二段画 $[3,4]$，获得 $10$ 分；第三段画 $[5,6]$，获得 $10$ 分。共 $31$ 分。\n\n对于 $20\\%$ 的数据，$n\\le 10$。  \n对于 $40\\%$ 的数据，$n\\le 3000$。  \n对于 $70\\%$ 的数据，$n\\le 30000$。  \n对于 $100\\%$ 的数据，$1\\le k<n\\le 3 \\times {10}^5$，$T\\le 10$，$1\\le a_i\\le 2^{30}$，$-2^{30}\\le b_i\\le 2^{30}$。\n\n数据有梯度，应该不太卡常。", "locale": "zh-CN"}}}
{"pid": "P5168", "type": "P", "difficulty": 7, "samples": [["4 4 4\n4 6 4 2\n1 2 8\n3 2 3\n2 4 2\n4 1 7\n3 4 3\n1 4 4\n3 1 7\n2 4 3", "3\n2\n3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "xtq玩魔塔", "background": "**已添加样例解释**\n\n在小学五年级的时候，$xtq$迷上了各种奇奇怪怪的魔塔。\n关于魔塔游戏的背景：https://baike.baidu.com/item/%E9%AD%94%E5%A1%94/861619?fr=aladdin\n\n对于题意理解可能并没有任何微小的作用", "description": "xtq 现在正在玩一个魔塔。这个魔塔十分特殊，不是由正方形格子构成的，而是一个 $n$ 个点，$m$ 条边的无向图，而且每条边上都会有一个怪物。xtq 经过了重重阻拦，现在到达了一个奖励层。\n\n在这层内，所有怪物都不会让 xtq 掉血，但是对于每一个怪物如果 xtq 不到一定血量他就无法攻击这个怪物。每一个点上还有一个宝石，宝石的种类有很多，但是如果 xtq 到了一个点但是他已经拥有了这种宝石，他是不能捡起的。他现在想要知道从这个魔塔的一个点到另一个点所需要的最小血量是多少，还要知道如果他从一个点到达这个魔塔，以某个血量能够捡到的宝石数量是多少。还有一件事令 xtq 十分头疼：这个魔塔由于一些神秘的力量，可能宝石的种类会发生变化。保证如果 xtq 的血量无穷大，他就可以走到这一层的任何地方。", "inputFormat": "第一行三个数 $n,m,q$ 代表点数，边数和操作数量\n\n第二行 $n$ 个数，代表每个点上宝石的种类\n\n下面 $m$ 行每行三个数 $u,v,t$，代表 $u$ 和 $v$ 之间有一条路，路上有一个需要 $t$ 点血量才能击杀的怪物\n\n然后 $q$ 行每行三个数 $opt,x,y$\n\n$opt=1$ 时将 $x$ 点的宝石改成第 $y$ 种\n\n$opt=2$ 代表查询从 $x$ 点要到达 $y$ 点所需的最小血量\n\n$opt=3$ 代表查询从 $x$ 点到达魔塔，血量为 $y$ 能捡到多少宝石", "outputFormat": "对于每一个 $2$ 操作和 $3$ 操作，输出一行答案", "hint": "样例解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/47598.png)\n\n第一次操作为3号操作，从4开始，有3点血量，可以到达 $\\{2,3,4\\}$，可以获得的宝石种类为 $\\{2,4,6\\}$\n\n第二次将 $1$ 的宝石种类修改为 $4$，即下图：\n\n![](https://cdn.luogu.com.cn/upload/pic/47599.png)\n\n第三次为 $3$ 操作，从 $1$ 开始，可以到达的点为 $\\{1,2,3,4\\}$，可以获得的宝石种类为 $\\{4,6\\}$。\n\n第四次为 $2$ 操作，从 $4$ 走到 $3$，至少需要 $3$ 点血量。\n\n\n\n 测试点 | $n$ | $m$ | $q$ | 有无修改操作 \n------ | ------ | ---|--- | ------ \n $1$ | $10$ | $20$ | $10$ | 有 \n $2 \\sim 3$ | $1000$ | $5000$ | $5000$ | ^ \n $4 \\sim 5$ | $8000$ | $30000$ | $20000$ | ^ \n $6$ | $20000$ | $100000$ | $100000$ | 无 \n $7$ | ^ | ^ | ^ | 有 \n $8$ | $50000$ | $200000$ | $200000$ | 无 \n $9$ | ^ | ^ | ^ | 有 \n $10$ | $100000$ | $300000$ | ^ | ^ \n\n\n对于 $100\\%$ 的数据，$n \\le 100000,m \\le 300000,q \\le 200000$\n\n剩余所有数字 $\\le \\text{intmax}$\n\n**保证查询的区间是随机生成的（其实是出题人懒得再写 generator 了）**", "locale": "zh-CN", "translations": {"en": {"title": "xtq Plays Magic Tower", "background": "**Sample explanation has been added.**\n\nWhen $xtq$ was in fifth grade of primary school, he became obsessed with all kinds of strange Magic Tower games.  \nBackground of the Magic Tower game: https://baike.baidu.com/item/%E9%AD%94%E5%A1%94/861619?fr=aladdin\n\nThis may not be of any help for understanding the problem.", "description": "xtq is now playing a Magic Tower. This Magic Tower is very special: it is not made of square grids, but an undirected graph with $n$ vertices and $m$ edges, and there is a monster on every edge. After many obstacles, xtq has now reached a reward floor.\n\nOn this floor, no monster will make xtq lose HP. However, for each monster, if xtq does not have at least a certain amount of HP, he cannot attack that monster. Each vertex also has a gem. There are many types of gems, but if xtq arrives at a vertex and he already has that type of gem, then he cannot pick it up. He now wants to know the minimum HP required to go from one vertex of the Magic Tower to another. He also wants to know, if he starts from some vertex with a certain amount of HP, how many gems he can pick up. One more thing troubles xtq a lot: due to some mysterious power, the gem types may change. It is guaranteed that if xtq has infinite HP, he can reach anywhere on this floor.", "inputFormat": "The first line contains three integers $n, m, q$, representing the number of vertices, the number of edges, and the number of operations.\n\nThe second line contains $n$ integers, representing the gem type on each vertex.\n\nThe next $m$ lines each contain three integers $u, v, t$, meaning there is a road between $u$ and $v$, and there is a monster on the road that requires $t$ HP to defeat.\n\nThen follow $q$ lines, each containing three integers $opt, x, y$.\n\nWhen $opt = 1$, change the gem at vertex $x$ to type $y$.\n\nWhen $opt = 2$, query the minimum HP required to go from vertex $x$ to vertex $y$.\n\nWhen $opt = 3$, query how many gems can be picked up if starting from vertex $x$ with HP $y$.", "outputFormat": "For each operation of type $2$ and type $3$, output one line containing the answer.", "hint": "Sample explanation:\n\n![](https://cdn.luogu.com.cn/upload/pic/47598.png)\n\nThe first operation is type $3$. Starting from $4$ with $3$ HP, you can reach $\\{2,3,4\\}$, and the gem types you can obtain are $\\{2,4,6\\}$.\n\nThe second operation changes the gem type of $1$ to $4$, as shown below:\n\n![](https://cdn.luogu.com.cn/upload/pic/47599.png)\n\nThe third operation is type $3$. Starting from $1$, the reachable vertices are $\\{1,2,3,4\\}$, and the gem types you can obtain are $\\{4,6\\}$.\n\nThe fourth operation is type $2$. To walk from $4$ to $3$, you need at least $3$ HP.\n\nConstraints:\n\nTest Point | $n$ | $m$ | $q$ | Has modification operations\n------ | ------ | --- | --- | ------\n$1$ | $10$ | $20$ | $10$ | Yes\n$2 \\sim 3$ | $1000$ | $5000$ | $5000$ | ^\n$4 \\sim 5$ | $8000$ | $30000$ | $20000$ | ^\n$6$ | $20000$ | $100000$ | $100000$ | No\n$7$ | ^ | ^ | ^ | Yes\n$8$ | $50000$ | $200000$ | $200000$ | No\n$9$ | ^ | ^ | ^ | Yes\n$10$ | $100000$ | $300000$ | ^ | ^\n\nFor $100\\%$ of the data, $n \\le 100000$, $m \\le 300000$, $q \\le 200000$.\n\nAll remaining numbers are $\\le \\text{intmax}$.\n\n**It is guaranteed that the query ranges are randomly generated (actually, the problem setter was too lazy to write a generator again).**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq玩魔塔", "background": "**已添加样例解释**\n\n在小学五年级的时候，$xtq$迷上了各种奇奇怪怪的魔塔。\n关于魔塔游戏的背景：https://baike.baidu.com/item/%E9%AD%94%E5%A1%94/861619?fr=aladdin\n\n对于题意理解可能并没有任何微小的作用", "description": "xtq 现在正在玩一个魔塔。这个魔塔十分特殊，不是由正方形格子构成的，而是一个 $n$ 个点，$m$ 条边的无向图，而且每条边上都会有一个怪物。xtq 经过了重重阻拦，现在到达了一个奖励层。\n\n在这层内，所有怪物都不会让 xtq 掉血，但是对于每一个怪物如果 xtq 不到一定血量他就无法攻击这个怪物。每一个点上还有一个宝石，宝石的种类有很多，但是如果 xtq 到了一个点但是他已经拥有了这种宝石，他是不能捡起的。他现在想要知道从这个魔塔的一个点到另一个点所需要的最小血量是多少，还要知道如果他从一个点到达这个魔塔，以某个血量能够捡到的宝石数量是多少。还有一件事令 xtq 十分头疼：这个魔塔由于一些神秘的力量，可能宝石的种类会发生变化。保证如果 xtq 的血量无穷大，他就可以走到这一层的任何地方。", "inputFormat": "第一行三个数 $n,m,q$ 代表点数，边数和操作数量\n\n第二行 $n$ 个数，代表每个点上宝石的种类\n\n下面 $m$ 行每行三个数 $u,v,t$，代表 $u$ 和 $v$ 之间有一条路，路上有一个需要 $t$ 点血量才能击杀的怪物\n\n然后 $q$ 行每行三个数 $opt,x,y$\n\n$opt=1$ 时将 $x$ 点的宝石改成第 $y$ 种\n\n$opt=2$ 代表查询从 $x$ 点要到达 $y$ 点所需的最小血量\n\n$opt=3$ 代表查询从 $x$ 点到达魔塔，血量为 $y$ 能捡到多少宝石", "outputFormat": "对于每一个 $2$ 操作和 $3$ 操作，输出一行答案", "hint": "样例解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/47598.png)\n\n第一次操作为3号操作，从4开始，有3点血量，可以到达 $\\{2,3,4\\}$，可以获得的宝石种类为 $\\{2,4,6\\}$\n\n第二次将 $1$ 的宝石种类修改为 $4$，即下图：\n\n![](https://cdn.luogu.com.cn/upload/pic/47599.png)\n\n第三次为 $3$ 操作，从 $1$ 开始，可以到达的点为 $\\{1,2,3,4\\}$，可以获得的宝石种类为 $\\{4,6\\}$。\n\n第四次为 $2$ 操作，从 $4$ 走到 $3$，至少需要 $3$ 点血量。\n\n\n\n 测试点 | $n$ | $m$ | $q$ | 有无修改操作 \n------ | ------ | ---|--- | ------ \n $1$ | $10$ | $20$ | $10$ | 有 \n $2 \\sim 3$ | $1000$ | $5000$ | $5000$ | ^ \n $4 \\sim 5$ | $8000$ | $30000$ | $20000$ | ^ \n $6$ | $20000$ | $100000$ | $100000$ | 无 \n $7$ | ^ | ^ | ^ | 有 \n $8$ | $50000$ | $200000$ | $200000$ | 无 \n $9$ | ^ | ^ | ^ | 有 \n $10$ | $100000$ | $300000$ | ^ | ^ \n\n\n对于 $100\\%$ 的数据，$n \\le 100000,m \\le 300000,q \\le 200000$\n\n剩余所有数字 $\\le \\text{intmax}$\n\n**保证查询的区间是随机生成的（其实是出题人懒得再写 generator 了）**", "locale": "zh-CN"}}}
{"pid": "P5169", "type": "P", "difficulty": 6, "samples": [["3 3 3\n1 2 0\n2 3 1\n3 1 2\n0\n1\n2", "5\n4\n4"], ["4 3 2\n1 2 1\n2 3 6\n2 4 7\n6\n7", "4\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "xtq 的异或和", "background": "xtq在六年级的时候开始大量研究离散数学。这一天，他正在对着一张密密麻麻的图思索。", "description": "xtq 有一张 $n$ 个点，$m$ 条边的无向连通图。第 $i$ 条边连接 $s_i,t_i$，权值为 $w_i$。不保证无重边或自环。\n\nxtq 认为，如果存在一条从 $u$ 出发，到 $v$ 结束的路径，使得所有**被这条路径恰经过奇数次的边**的权值的异或和为 $x$，那么点对 $(u,v)$ 关于 $x$ 是巧妙的。\n\n现在，xtq 问了你 $q$ 个问题，每次询问有多少个不同的点对 $(u,v)$ 关于 $x$ 是巧妙的。注意 $u$ 可以等于 $v$，且如果 $u \\neq v$ 那么 $(u,v)$ 与 $(v,u)$ 是不同的。", "inputFormat": "第一行，三个正整数 $n,m,q$\n\n接下来 $m$ 行，每行三个整数 $s_i,t_i,w_i$\n\n接下来 $q$ 行，每行一个整数 $x$，表示一次询问。", "outputFormat": "$q$ 行，每行回答一次询问，输出对 $998244353$ 取模后的结果。", "hint": "### 样例解释1\n\n关于 $0$ 巧妙的点对：\n\n$(1,1): 1 \\Rightarrow 2 \\Rightarrow 1$，$(2,2),(3,3)$ 类似；$(1,2): 1 \\Rightarrow 2$，$(2,1)$ 类似\n\n关于 $1$ 巧妙的点对：\n\n$(2,3):2 \\Rightarrow 3$，$(3,2)$ 类似；$(1,3):1 \\Rightarrow 2 \\Rightarrow 3$，$(3,1)$ 类似\n\n关于 $2$ 巧妙的点对：与 $1$ 类似\n\n### 数据范围\n\n|  测试点编号|$n$  |$m$  |      $\\, w_i,x,q-1$  |       特殊限制  |\n| ----------- | ----------- | ----------- | --------------- | ----------- |\n|$1$  |$\\le 5$  |$\\le 10$  |$< 4$  | 无  |\n|$2$  |$\\le 10$  |$\\le 50$  |$< 8$  | ^  |\n|$3$  |$\\le 100$  |$= n-1$  |$< 128$  | 是一棵树  |\n|$4$  |^  |$\\le 500$  |^ | 无  |\n|$5$  |$\\le 1000$  |$= n-1$  |$< 1024$  | 是一棵树  |\n|$6$  |^  |$\\le 5000$  |^ | 无  |\n|$7$  |$\\le 1 \\times 10^5 $  |$\\le 3\\times 10^5$  |^ | ^  |\n|$8$  |^|^  |^| ^  |\n|$9$  |^|$= n-1$  |$< 262144$  | 是一棵树  |\n|$10$  |^|^ |^| ^ |\n|$11$  |^|^ |^ | ^ |\n|$12$  |^|^|^ | ^ |\n|$13$  |^|$\\le n+11$  |^| 无  |\n|$14$  |^|^ |^ | ^  |\n|$15$ |^|$\\le 3\\times 10^5$  |^ | ^ |\n|$16$ |^|^ |^ | ^ |\n|$17$  |^|^ |^| ^ |\n|$18$ |^|^|^| ^ |\n|$19$  |^|^|^| ^ |\n|$20$  |^|^ |^ | ^  |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5,n-1\\le m\\le 3*10^5,0\\le w_i,x< 262144,0\\le q\\le 262144$", "locale": "zh-CN", "translations": {"en": {"title": "xtq’s XOR Sum", "background": "xtq started studying discrete mathematics a lot when he was in sixth grade. One day, he was thinking while looking at a very dense graph.", "description": "xtq has an undirected connected graph with $n$ vertices and $m$ edges. The $i$-th edge connects $s_i$ and $t_i$ and has weight $w_i$. Multiple edges and self-loops are not guaranteed to be absent.\n\nxtq thinks that if there exists a path starting from $u$ and ending at $v$ such that the XOR sum of the weights of all **edges that are traversed an odd number of times by this path** equals $x$, then the ordered pair $(u,v)$ is “clever” with respect to $x$.\n\nNow, xtq asks you $q$ queries. For each query, ask how many distinct ordered pairs $(u,v)$ are clever with respect to $x$. Note that $u$ may equal $v$, and if $u \\neq v$, then $(u,v)$ and $(v,u)$ are considered different.", "inputFormat": "The first line contains three positive integers $n,m,q$.\n\nThe next $m$ lines each contain three integers $s_i,t_i,w_i$.\n\nThe next $q$ lines each contain one integer $x$, representing a query.", "outputFormat": "Output $q$ lines. Each line answers one query, and you should print the result modulo $998244353$.", "hint": "### Sample Explanation 1\n\nOrdered pairs that are clever with respect to $0$:\n\n$(1,1): 1 \\Rightarrow 2 \\Rightarrow 1$, and $(2,2),(3,3)$ are similar; $(1,2): 1 \\Rightarrow 2$, and $(2,1)$ is similar.\n\nOrdered pairs that are clever with respect to $1$:\n\n$(2,3):2 \\Rightarrow 3$, and $(3,2)$ is similar; $(1,3):1 \\Rightarrow 2 \\Rightarrow 3$, and $(3,1)$ is similar.\n\nOrdered pairs that are clever with respect to $2$: similar to $1$.\n\n### Constraints\n\n|  Test Point ID |$n$  |$m$  |      $\\, w_i,x,q-1$  |       Special Restriction  |\n| ----------- | ----------- | ----------- | --------------- | ----------- |\n|$1$  |$\\le 5$  |$\\le 10$  |$< 4$  | None  |\n|$2$  |$\\le 10$  |$\\le 50$  |$< 8$  | ^  |\n|$3$  |$\\le 100$  |$= n-1$  |$< 128$  | A tree  |\n|$4$  |^  |$\\le 500$  |^ | None  |\n|$5$  |$\\le 1000$  |$= n-1$  |$< 1024$  | A tree  |\n|$6$  |^  |$\\le 5000$  |^ | None  |\n|$7$  |$\\le 1 \\times 10^5 $  |$\\le 3\\times 10^5$  |^ | ^  |\n|$8$  |^|^  |^| ^  |\n|$9$  |^|$= n-1$  |$< 262144$  | A tree  |\n|$10$  |^|^ |^| ^ |\n|$11$  |^|^ |^ | ^ |\n|$12$  |^|^|^ | ^ |\n|$13$  |^|$\\le n+11$  |^| None  |\n|$14$  |^|^ |^ | ^  |\n|$15$ |^|$\\le 3\\times 10^5$  |^ | ^ |\n|$16$ |^|^ |^ | ^ |\n|$17$  |^|^ |^| ^ |\n|$18$ |^|^|^| ^ |\n|$19$  |^|^|^| ^ |\n|$20$  |^|^ |^ | ^  |\n\nFor $100\\%$ of the testdata, $1\\le n\\le 10^5,n-1\\le m\\le 3*10^5,0\\le w_i,x< 262144,0\\le q\\le 262144$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq 的异或和", "background": "xtq在六年级的时候开始大量研究离散数学。这一天，他正在对着一张密密麻麻的图思索。", "description": "xtq 有一张 $n$ 个点，$m$ 条边的无向连通图。第 $i$ 条边连接 $s_i,t_i$，权值为 $w_i$。不保证无重边或自环。\n\nxtq 认为，如果存在一条从 $u$ 出发，到 $v$ 结束的路径，使得所有**被这条路径恰经过奇数次的边**的权值的异或和为 $x$，那么点对 $(u,v)$ 关于 $x$ 是巧妙的。\n\n现在，xtq 问了你 $q$ 个问题，每次询问有多少个不同的点对 $(u,v)$ 关于 $x$ 是巧妙的。注意 $u$ 可以等于 $v$，且如果 $u \\neq v$ 那么 $(u,v)$ 与 $(v,u)$ 是不同的。", "inputFormat": "第一行，三个正整数 $n,m,q$\n\n接下来 $m$ 行，每行三个整数 $s_i,t_i,w_i$\n\n接下来 $q$ 行，每行一个整数 $x$，表示一次询问。", "outputFormat": "$q$ 行，每行回答一次询问，输出对 $998244353$ 取模后的结果。", "hint": "### 样例解释1\n\n关于 $0$ 巧妙的点对：\n\n$(1,1): 1 \\Rightarrow 2 \\Rightarrow 1$，$(2,2),(3,3)$ 类似；$(1,2): 1 \\Rightarrow 2$，$(2,1)$ 类似\n\n关于 $1$ 巧妙的点对：\n\n$(2,3):2 \\Rightarrow 3$，$(3,2)$ 类似；$(1,3):1 \\Rightarrow 2 \\Rightarrow 3$，$(3,1)$ 类似\n\n关于 $2$ 巧妙的点对：与 $1$ 类似\n\n### 数据范围\n\n|  测试点编号|$n$  |$m$  |      $\\, w_i,x,q-1$  |       特殊限制  |\n| ----------- | ----------- | ----------- | --------------- | ----------- |\n|$1$  |$\\le 5$  |$\\le 10$  |$< 4$  | 无  |\n|$2$  |$\\le 10$  |$\\le 50$  |$< 8$  | ^  |\n|$3$  |$\\le 100$  |$= n-1$  |$< 128$  | 是一棵树  |\n|$4$  |^  |$\\le 500$  |^ | 无  |\n|$5$  |$\\le 1000$  |$= n-1$  |$< 1024$  | 是一棵树  |\n|$6$  |^  |$\\le 5000$  |^ | 无  |\n|$7$  |$\\le 1 \\times 10^5 $  |$\\le 3\\times 10^5$  |^ | ^  |\n|$8$  |^|^  |^| ^  |\n|$9$  |^|$= n-1$  |$< 262144$  | 是一棵树  |\n|$10$  |^|^ |^| ^ |\n|$11$  |^|^ |^ | ^ |\n|$12$  |^|^|^ | ^ |\n|$13$  |^|$\\le n+11$  |^| 无  |\n|$14$  |^|^ |^ | ^  |\n|$15$ |^|$\\le 3\\times 10^5$  |^ | ^ |\n|$16$ |^|^ |^ | ^ |\n|$17$  |^|^ |^| ^ |\n|$18$ |^|^|^| ^ |\n|$19$  |^|^|^| ^ |\n|$20$  |^|^ |^ | ^  |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5,n-1\\le m\\le 3*10^5,0\\le w_i,x< 262144,0\\le q\\le 262144$", "locale": "zh-CN"}}}
{"pid": "P5170", "type": "P", "difficulty": 6, "samples": [["2\n2 1 0 2\n4 3 9 6", "1 1 2\n11 27 27"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Special Judge", "类欧几里得算法", "模板题"], "title": "【模板】类欧几里德算法", "background": null, "description": "给定 $n,\\,a,\\,b,\\,c$ ，分别求 $\\sum\\limits_{i=0}^{n}\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor\\,,\\  \\sum\\limits_{i=0}^{n}{\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor}^2\\,,\\  \\sum\\limits_{i=0}^{n}i\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor$ ，答案对 $998244353$ 取模。多组数据。", "inputFormat": "第一行给出数据组数 $t$ 。\n\n接下来 $t$ 行，每行有四个整数，分别为每组数据的 $n,\\ a,\\ b,\\ c$ 。", "outputFormat": "对于每组数据，输出一行三个整数，为三个答案对 $998244353$ 取模的结果。", "hint": "本题采用 $\\mathrm{Special}\\ \\mathrm{Judge}$。\n\n答对所有第一问可以获得测试点 $40\\%$ 的分数，答对所有第二问、第三问可以分别获得另外 $30\\%$ 的分数。\n\n|测试点编号|特殊性质|\n|:-:|:-:|\n|$1$|$n,\\,a,\\,b,\\,c\\leqslant10$|\n|$2 \\sim 3$|$n,\\,a,\\,b,\\,c\\leqslant1000$|\n|$4$|$n,\\,a,\\,b,\\,c\\leqslant10^6$|\n|$5$|$t=1$|\n|$6 \\sim 10$|无|\n\n对于所有测试点，有 $1 \\leqslant t \\leqslant 10^5,\\ 0 \\leqslant n,\\,a,\\,b,\\,c \\leqslant 10^9,\\ c \\neq 0$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Euclidean-like Algorithm", "background": "", "description": "Given $n,\\,a,\\,b,\\,c$, compute respectively $\\sum\\limits_{i=0}^{n}\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor$, $\\sum\\limits_{i=0}^{n}{\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor}^2$, and $\\sum\\limits_{i=0}^{n} i \\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor$. Output each answer modulo $998244353$. There are multiple test cases.", "inputFormat": "The first line contains the number of test cases $t$.\n\nThe next $t$ lines each contain four integers, which are $n,\\ a,\\ b,\\ c$ for that test case.", "outputFormat": "For each test case, output one line with three integers, which are the three answers modulo $998244353$.", "hint": "This problem uses $\\mathrm{Special}\\ \\mathrm{Judge}$.\n\nIf you answer all cases for the first query correctly, you can get $40\\%$ of the total score. If you answer all cases for the second and third queries correctly, you can get an additional $30\\%$ for each.\n\n|Test Point ID|Special Property|\n|:-:|:-:|\n|$1$|$n,\\,a,\\,b,\\,c\\leqslant10$|\n|$2 \\sim 3$|$n,\\,a,\\,b,\\,c\\leqslant1000$|\n|$4$|$n,\\,a,\\,b,\\,c\\leqslant10^6$|\n|$5$|$t=1$|\n|$6 \\sim 10$|None|\n\nFor all test points, $1 \\leqslant t \\leqslant 10^5,\\ 0 \\leqslant n,\\,a,\\,b,\\,c \\leqslant 10^9,\\ c \\neq 0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】类欧几里德算法", "background": null, "description": "给定 $n,\\,a,\\,b,\\,c$ ，分别求 $\\sum\\limits_{i=0}^{n}\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor\\,,\\  \\sum\\limits_{i=0}^{n}{\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor}^2\\,,\\  \\sum\\limits_{i=0}^{n}i\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor$ ，答案对 $998244353$ 取模。多组数据。", "inputFormat": "第一行给出数据组数 $t$ 。\n\n接下来 $t$ 行，每行有四个整数，分别为每组数据的 $n,\\ a,\\ b,\\ c$ 。", "outputFormat": "对于每组数据，输出一行三个整数，为三个答案对 $998244353$ 取模的结果。", "hint": "本题采用 $\\mathrm{Special}\\ \\mathrm{Judge}$。\n\n答对所有第一问可以获得测试点 $40\\%$ 的分数，答对所有第二问、第三问可以分别获得另外 $30\\%$ 的分数。\n\n|测试点编号|特殊性质|\n|:-:|:-:|\n|$1$|$n,\\,a,\\,b,\\,c\\leqslant10$|\n|$2 \\sim 3$|$n,\\,a,\\,b,\\,c\\leqslant1000$|\n|$4$|$n,\\,a,\\,b,\\,c\\leqslant10^6$|\n|$5$|$t=1$|\n|$6 \\sim 10$|无|\n\n对于所有测试点，有 $1 \\leqslant t \\leqslant 10^5,\\ 0 \\leqslant n,\\,a,\\,b,\\,c \\leqslant 10^9,\\ c \\neq 0$ 。", "locale": "zh-CN"}}}
{"pid": "P5171", "type": "P", "difficulty": 6, "samples": [["3 4 13", "12"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "Earthquake", "background": "", "description": "给定 $a,\\,b,\\,c$ ，求满足方程 $ax+by \\leqslant c$ 的非负整数解个数。", "inputFormat": "输入三个整数 $a,\\,b,\\,c$ 。", "outputFormat": "输出一个整数表示答案。", "hint": "**样例解释：**\n\n若以 $(x,\\,y)$ 表示一组合法解，样例的 $12$ 组合法解如下：\n\n$(0,\\,0)$，$(0,\\,1)$，$(0,\\,2)$，$(0,\\,3)$，$(1,\\,0)$，$(1,\\,1)$，$(1,\\,2)$，$(2,\\,0)$，$(2,\\,1)$，$(3,\\,0)$，$(3,\\,1)$，$(4,\\,0)$ 。\n\n**数据规模：**\n\n||||\n|:-:|:-:|:-:|\n|测试点编号|$a,\\,b$|$c$|\n|$1 \\sim 5$|$\\leqslant 10$|$\\leqslant 10$|\n|$6 \\sim 10$|$\\leqslant 10^5$|$\\leqslant 10^9$|\n|$11 \\sim 25$|$\\leqslant 10^9$|$\\leqslant 10^{18}$|\n\n对于所有数据，$1 \\leqslant a,\\,b \\leqslant 10^9,\\ 0 \\leqslant c \\leqslant \\min(a,\\,b) \\times 10^9$ 。", "locale": "zh-CN", "translations": {"en": {"title": "Earthquake", "background": "", "description": "Given $a,\\,b,\\,c$, find the number of non-negative integer solutions that satisfy the inequality $ax+by \\leqslant c$.", "inputFormat": "Input three integers $a,\\,b,\\,c$.", "outputFormat": "Output one integer representing the answer.", "hint": "**Sample Explanation:**\n\nLet $(x,\\,y)$ represent a valid solution. The sample has the following $12$ valid solutions:\n\n$(0,\\,0)$, $(0,\\,1)$, $(0,\\,2)$, $(0,\\,3)$, $(1,\\,0)$, $(1,\\,1)$, $(1,\\,2)$, $(2,\\,0)$, $(2,\\,1)$, $(3,\\,0)$, $(3,\\,1)$, $(4,\\,0)$.\n\n**Constraints:**\n\n||||\n|:-:|:-:|:-:|\n|Test point ID|$a,\\,b$|$c$|\n|$1 \\sim 5$|$\\leqslant 10$|$\\leqslant 10$|\n|$6 \\sim 10$|$\\leqslant 10^5$|$\\leqslant 10^9$|\n|$11 \\sim 25$|$\\leqslant 10^9$|$\\leqslant 10^{18}$|\n\nFor all testdata, $1 \\leqslant a,\\,b \\leqslant 10^9,\\ 0 \\leqslant c \\leqslant \\min(a,\\,b) \\times 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Earthquake", "background": "", "description": "给定 $a,\\,b,\\,c$ ，求满足方程 $ax+by \\leqslant c$ 的非负整数解个数。", "inputFormat": "输入三个整数 $a,\\,b,\\,c$ 。", "outputFormat": "输出一个整数表示答案。", "hint": "**样例解释：**\n\n若以 $(x,\\,y)$ 表示一组合法解，样例的 $12$ 组合法解如下：\n\n$(0,\\,0)$，$(0,\\,1)$，$(0,\\,2)$，$(0,\\,3)$，$(1,\\,0)$，$(1,\\,1)$，$(1,\\,2)$，$(2,\\,0)$，$(2,\\,1)$，$(3,\\,0)$，$(3,\\,1)$，$(4,\\,0)$ 。\n\n**数据规模：**\n\n||||\n|:-:|:-:|:-:|\n|测试点编号|$a,\\,b$|$c$|\n|$1 \\sim 5$|$\\leqslant 10$|$\\leqslant 10$|\n|$6 \\sim 10$|$\\leqslant 10^5$|$\\leqslant 10^9$|\n|$11 \\sim 25$|$\\leqslant 10^9$|$\\leqslant 10^{18}$|\n\n对于所有数据，$1 \\leqslant a,\\,b \\leqslant 10^9,\\ 0 \\leqslant c \\leqslant \\min(a,\\,b) \\times 10^9$ 。", "locale": "zh-CN"}}}
{"pid": "P5172", "type": "P", "difficulty": 7, "samples": [["3\n3 5\n3 6\n3 7", "3\n1\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "CTT（清华集训/北大集训）", "类欧几里得算法"], "title": "[清华集训 2014] Sum", "background": "", "description": "给定正整数 $n,\\,r$ ，求：\n\n$$\\sum_{d=1}^{n}(-1)^{\\lfloor d\\sqrt{r} \\rfloor}$$", "inputFormat": "第一行一个数 $t$，表示有 $t$ 组测试数据。\n\n接下来 $t$ 行，每行两个正整数 $n,\\,r$ 。", "outputFormat": "输出 $t$ 行，每行一个整数表示答案。", "hint": "|测试点编号|$t$|$n$|$r$| \n|:-:|:-:|:-:|:-:|    \n|$1 \\sim 3$|$\\leqslant 10$|$\\leqslant 10^5$|$\\leqslant 100$|   \n|$4 \\sim 6$|$\\leqslant 100$|$\\leqslant 10^7$|$\\leqslant 1000$|  \n|$7 \\sim 10$|$\\leqslant 10^4$|$\\leqslant 10^9$|$\\leqslant 10^4$|", "locale": "zh-CN", "translations": {"en": {"title": "[Tsinghua Training 2014] Sum", "background": "", "description": "Given positive integers $n$ and $r$, compute:\n\n$$\\sum_{d=1}^{n}(-1)^{\\lfloor d\\sqrt{r} \\rfloor}$$", "inputFormat": "The first line contains an integer $t$, indicating that there are $t$ testdata cases.\n\nThe next $t$ lines each contain two positive integers $n$ and $r$.", "outputFormat": "Output $t$ lines, each containing one integer representing the answer.", "hint": "## Constraints\n\n|Test Point ID|$t$|$n$|$r$|\n|:-:|:-:|:-:|:-:|\n|$1 \\sim 3$|$\\leqslant 10$|$\\leqslant 10^5$|$\\leqslant 100$|\n|$4 \\sim 6$|$\\leqslant 100$|$\\leqslant 10^7$|$\\leqslant 1000$|\n|$7 \\sim 10$|$\\leqslant 10^4$|$\\leqslant 10^9$|$\\leqslant 10^4$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[清华集训 2014] Sum", "background": "", "description": "给定正整数 $n,\\,r$ ，求：\n\n$$\\sum_{d=1}^{n}(-1)^{\\lfloor d\\sqrt{r} \\rfloor}$$", "inputFormat": "第一行一个数 $t$，表示有 $t$ 组测试数据。\n\n接下来 $t$ 行，每行两个正整数 $n,\\,r$ 。", "outputFormat": "输出 $t$ 行，每行一个整数表示答案。", "hint": "|测试点编号|$t$|$n$|$r$| \n|:-:|:-:|:-:|:-:|    \n|$1 \\sim 3$|$\\leqslant 10$|$\\leqslant 10^5$|$\\leqslant 100$|   \n|$4 \\sim 6$|$\\leqslant 100$|$\\leqslant 10^7$|$\\leqslant 1000$|  \n|$7 \\sim 10$|$\\leqslant 10^4$|$\\leqslant 10^9$|$\\leqslant 10^4$|", "locale": "zh-CN"}}}
{"pid": "P5173", "type": "P", "difficulty": 6, "samples": [["3 3", "2"], ["30 30\n", "155117522"], ["1234 12345678\n", "424074635"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": [], "title": "传球", "background": "临近中考，pG的班主任决定上一节体育课，放松一下。\n", "description": "老师带着 pG 的同学们一起做传球游戏。\n\n游戏规则是这样的： $n$ 个同学站成一个圆圈，其中的一个同学手里拿着一个球，当老师吹哨子时开始传球，每个同学可以把球传给自己左右的两个同学中的一个（左右任意），当老师再次吹哨子时，传球停止，此时，拿着球没有传出去的那个同学就是败者，要给大家表演一个节目。\n\npG 提出一个有趣的问题：有多少种不同的传球方法可以使得从 pG 手里开始传的球，传了 $m$ 次以后，又回到 pG 手里。两种传球方法被视作不同的方法，当且仅当这两种方法中，接到球的同学按接球顺序组成的序列是不同的。比如有三个同学 $1$ 号、 $2$ 号、 $3$ 号，并假设 pG 为 $1$ 号，球传了 $3$ 次回到pG手里的方式有 $1 \\to 2 \\to 3 \\to 1$ 和 $1 \\to 3 \\to 2 \\to 1$ ，共$ 2$ 种。", "inputFormat": "一行，有两个用空格隔开的整数 $n,m$", "outputFormat": "$1$ 个整数，表示符合题意的方法数。\n\n由于答案可能过大，对 $10^9+7$ 取模。", "hint": "对于8%的数据，$n \\le 100,m \\le 10^4$.\n\n对于100%的数据，$n \\le 3500,m \\le 10^9$.\n\n**数据有一定梯度。**\n", "locale": "zh-CN", "translations": {"en": {"title": "Passing the Ball", "background": "As the middle school entrance exam is approaching, pG’s head teacher decides to hold a PE class to help everyone relax.\n", "description": "The teacher leads pG’s classmates to play a ball-passing game.\n\nThe rules are as follows: $n$ students stand in a circle. One of them holds a ball at the beginning. When the teacher blows the whistle, they start passing the ball. Each student can pass the ball to either of their two neighbors (left or right, either is allowed). When the teacher blows the whistle again, passing stops. At that moment, the student who is holding the ball and did not pass it out is the loser, and must perform a show for everyone.\n\npG asks an interesting question: how many different passing methods make it so that the ball, starting from pG, returns to pG after being passed $m$ times? Two passing methods are considered different if and only if the sequence of students who receive the ball (in the order of receiving) is different. For example, if there are three students numbered $1$, $2$, $3$, and pG is student $1$, then the ways for the ball to return to pG after $3$ passes are $1 \\to 2 \\to 3 \\to 1$ and $1 \\to 3 \\to 2 \\to 1$, for a total of $2$ ways.", "inputFormat": "One line containing two integers $n, m$ separated by a space.", "outputFormat": "Output $1$ integer, the number of methods that satisfy the requirement.\n\nSince the answer may be very large, output it modulo $10^9+7$.", "hint": "For $8\\%$ of the testdata, $n \\le 100, m \\le 10^4$.\n\nFor $100\\%$ of the testdata, $n \\le 3500, m \\le 10^9$.\n\n**The testdata has a certain gradient.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "传球", "background": "临近中考，pG的班主任决定上一节体育课，放松一下。\n", "description": "老师带着 pG 的同学们一起做传球游戏。\n\n游戏规则是这样的： $n$ 个同学站成一个圆圈，其中的一个同学手里拿着一个球，当老师吹哨子时开始传球，每个同学可以把球传给自己左右的两个同学中的一个（左右任意），当老师再次吹哨子时，传球停止，此时，拿着球没有传出去的那个同学就是败者，要给大家表演一个节目。\n\npG 提出一个有趣的问题：有多少种不同的传球方法可以使得从 pG 手里开始传的球，传了 $m$ 次以后，又回到 pG 手里。两种传球方法被视作不同的方法，当且仅当这两种方法中，接到球的同学按接球顺序组成的序列是不同的。比如有三个同学 $1$ 号、 $2$ 号、 $3$ 号，并假设 pG 为 $1$ 号，球传了 $3$ 次回到pG手里的方式有 $1 \\to 2 \\to 3 \\to 1$ 和 $1 \\to 3 \\to 2 \\to 1$ ，共$ 2$ 种。", "inputFormat": "一行，有两个用空格隔开的整数 $n,m$", "outputFormat": "$1$ 个整数，表示符合题意的方法数。\n\n由于答案可能过大，对 $10^9+7$ 取模。", "hint": "对于8%的数据，$n \\le 100,m \\le 10^4$.\n\n对于100%的数据，$n \\le 3500,m \\le 10^9$.\n\n**数据有一定梯度。**\n", "locale": "zh-CN"}}}
{"pid": "P5174", "type": "P", "difficulty": 4, "samples": [["3", "12"], ["100\n", "16012"], ["1234567\n", "205275050"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": [], "title": "圆点", "background": "中考了，Pg看着数学卷子的压轴题，陷入了沉思……\n\n题解：https://blog.csdn.net/kkkksc03/article/details/85008125", "description": "众所周知，平面中的每一个整点都**有且仅有**一个圆心在原点的圆穿过，我们定义这个整点的权值为穿过它的圆的**半径的平方**。\n\n现在有一个圆心在原点的圆，半径为$\\sqrt{R}$。你要求出这个圆所包含的所有整点的权值**和**。\n\n由于答案可能过大，对$10^9+7$取模。\n", "inputFormat": "一个数字$R$。", "outputFormat": "一行，仅有一个数字。", "hint": "样例1 解释：\n\n共包含了$9$个整点。分别为$(0,0),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1),(-1,0),(-1,1)$。\n\n权值分别为$\\ 0,1,2,1,2,1,2,1,2$，总和为12。\n\n--------\n   \n对于50%的数据，$R \\le 10^{6}.$\n\n对于100%的数据，$R \\le 10^{14}.$\n", "locale": "zh-CN", "translations": {"en": {"title": "Dot Circles", "background": "The senior high school entrance exam is here. Pg stared at the last (hardest) problem on the math paper and fell into deep thought……\n\nSolution: https://blog.csdn.net/kkkksc03/article/details/85008125", "description": "As everyone knows, every lattice point (integer-coordinate point) on the plane is passed through by **exactly one** circle centered at the origin. We define the weight of this lattice point as the **square of the radius** of the circle that passes through it.\n\nNow there is a circle centered at the origin with radius $\\sqrt{R}$. You need to find the **sum** of the weights of all lattice points contained in this circle.\n\nSince the answer may be very large, output it modulo $10^9+7$.", "inputFormat": "One number $R$.", "outputFormat": "One line with only one number.", "hint": "Explanation for Sample 1:\n\nThere are $9$ lattice points in total: $(0,0),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1),(-1,0),(-1,1)$.\n\nTheir weights are $\\ 0,1,2,1,2,1,2,1,2$, and the total sum is 12.\n\n--------\n\nConstraints:\n\nFor $50\\%$ of the testdata, $R \\le 10^{6}.$\n\nFor $100\\%$ of the testdata, $R \\le 10^{14}.$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "圆点", "background": "中考了，Pg看着数学卷子的压轴题，陷入了沉思……\n\n题解：https://blog.csdn.net/kkkksc03/article/details/85008125", "description": "众所周知，平面中的每一个整点都**有且仅有**一个圆心在原点的圆穿过，我们定义这个整点的权值为穿过它的圆的**半径的平方**。\n\n现在有一个圆心在原点的圆，半径为$\\sqrt{R}$。你要求出这个圆所包含的所有整点的权值**和**。\n\n由于答案可能过大，对$10^9+7$取模。\n", "inputFormat": "一个数字$R$。", "outputFormat": "一行，仅有一个数字。", "hint": "样例1 解释：\n\n共包含了$9$个整点。分别为$(0,0),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1),(-1,0),(-1,1)$。\n\n权值分别为$\\ 0,1,2,1,2,1,2,1,2$，总和为12。\n\n--------\n   \n对于50%的数据，$R \\le 10^{6}.$\n\n对于100%的数据，$R \\le 10^{14}.$\n", "locale": "zh-CN"}}}
{"pid": "P5175", "type": "P", "difficulty": 5, "samples": [["3\n5 1 1 1 1\n4 3 4 3 2\n461564597527246 987489553 321654648 164165256 315648984", "40\n4193\n480929868"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": ["数学", "矩阵乘法"], "title": "数列", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/85008130", "description": "一个数列 $a_n $，已知 $a_1$ 及 $a_2$ 两项。\n\n数列 $a_n$ 满足递推式 $a_n=x \\times a_{n-1}+ y \\times a_{n-2}(n≥3).$\n\n求 $\\sum_{i=1}^na_i^2$\n\n由于答案可能过大，对 $10^9+7$ 取模。", "inputFormat": "第一行一个整数 $T$，即数据组数。\n\n下面 $T$ 行，每行 $5$ 个整数，$n,a_1,a_2,x,y$，含义如上。", "outputFormat": "共 $T$ 行，每行一个整数，即为每组数据的答案。", "hint": "样例解释：\n\n对于第一组样例，可知数列为 $1,1,2,3,5$，则答案是 $1^2+1^2+2^2+3^2+5^2=40$。\n\n对于第二组样例，可知数列为 $3,4,18,62$，则答案是 $3^2+4^2+18^2+62^2=4193$。\n\n~~第三组样例不予解释。~~\n\n对于前 $20\\%$ 的数据，保证 $x=y=1$。\n\n对于 $100\\%$ 的数据，$T=30000,1\\le n \\le 10^{18},1\\le a_1,a_2 ,x,y \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Sequence", "background": "Solution: https://blog.csdn.net/kkkksc03/article/details/85008130", "description": "Given a sequence $a_n$, where $a_1$ and $a_2$ are known.\n\nThe sequence $a_n$ satisfies the recurrence $a_n = x \\times a_{n-1} + y \\times a_{n-2} \\ (n \\ge 3).$\n\nCompute $\\sum_{i=1}^n a_i^2$.\n\nSince the answer may be very large, output it modulo $10^9+7$.", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nThe next $T$ lines each contain $5$ integers $n, a_1, a_2, x, y$, with the meanings as described above.", "outputFormat": "Output $T$ lines, each containing one integer, the answer for each test case.", "hint": "Sample explanation:\n\nFor the first sample, the sequence is $1, 1, 2, 3, 5$, so the answer is $1^2 + 1^2 + 2^2 + 3^2 + 5^2 = 40$.\n\nFor the second sample, the sequence is $3, 4, 18, 62$, so the answer is $3^2 + 4^2 + 18^2 + 62^2 = 4193$.\n\n~~The third sample will not be explained.~~\n\nFor the first $20\\%$ of the testdata, it is guaranteed that $x = y = 1$.\n\nFor $100\\%$ of the testdata, $T = 30000$, $1 \\le n \\le 10^{18}$, $1 \\le a_1, a_2, x, y \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "数列", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/85008130", "description": "一个数列 $a_n $，已知 $a_1$ 及 $a_2$ 两项。\n\n数列 $a_n$ 满足递推式 $a_n=x \\times a_{n-1}+ y \\times a_{n-2}(n≥3).$\n\n求 $\\sum_{i=1}^na_i^2$\n\n由于答案可能过大，对 $10^9+7$ 取模。", "inputFormat": "第一行一个整数 $T$，即数据组数。\n\n下面 $T$ 行，每行 $5$ 个整数，$n,a_1,a_2,x,y$，含义如上。", "outputFormat": "共 $T$ 行，每行一个整数，即为每组数据的答案。", "hint": "样例解释：\n\n对于第一组样例，可知数列为 $1,1,2,3,5$，则答案是 $1^2+1^2+2^2+3^2+5^2=40$。\n\n对于第二组样例，可知数列为 $3,4,18,62$，则答案是 $3^2+4^2+18^2+62^2=4193$。\n\n~~第三组样例不予解释。~~\n\n对于前 $20\\%$ 的数据，保证 $x=y=1$。\n\n对于 $100\\%$ 的数据，$T=30000,1\\le n \\le 10^{18},1\\le a_1,a_2 ,x,y \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5176", "type": "P", "difficulty": 7, "samples": [["2\n10 12 11\n30 20 25", "25302\n573830"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["最大公约数 gcd", "莫比乌斯反演", "整除分块"], "title": "公约数", "background": "在收卷最后五分钟，pg 发现了卷子反面还有一道大题。", "description": "求\n\n[![](https://cdn.luogu.com.cn/upload/pic/33775.png)](https://www.luogu.org/paste/zltm8ddt)\n\n由于答案可能过大，输出答案对 $10^9+7$ 取模的值。", "inputFormat": "第一行一个正整数 $T$，为数据组数。\n\n下面 $T$ 行，每行 $3$ 个整数，为 $n,m,p$。", "outputFormat": "共 $T$ 行，每行一个整数，为答案。", "hint": "对于前 $10\\%$ 的数据，$T=5~,~40 \\le n,m,p \\le 100$。\n\n对于另外 $20\\%$ 的数据，$T=50~,~100 \\le n,m,p \\le 5\\times 10^4$。\n\n对于另外 $20\\%$ 的数据，$T= 20~,~4\\times 10^6 \\le n,m,p \\le 5\\times 10^6$。\n\n对于另外 $50\\%$ 的数据，$T=10^3~,~10^7 \\le n,m,p \\le 2\\times 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "Greatest Common Divisor.", "background": "In the last five minutes before collecting the papers, pg found that there was still a major problem on the back side of the paper.", "description": "Compute\n\n[![](https://cdn.luogu.com.cn/upload/pic/33775.png)](https://www.luogu.org/paste/zltm8ddt)\n\nSince the answer may be too large, output the value of the answer modulo $10^9+7$.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain $3$ integers: $n, m, p$.", "outputFormat": "Output $T$ lines. Each line contains one integer, the answer.", "hint": "For the first $10\\%$ of the testdata, $T = 5$, and $40 \\le n, m, p \\le 100$.\n\nFor another $20\\%$ of the testdata, $T = 50$, and $100 \\le n, m, p \\le 5 \\times 10^4$.\n\nFor another $20\\%$ of the testdata, $T = 20$, and $4 \\times 10^6 \\le n, m, p \\le 5 \\times 10^6$.\n\nFor the remaining $50\\%$ of the testdata, $T = 10^3$, and $10^7 \\le n, m, p \\le 2 \\times 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "公约数", "background": "在收卷最后五分钟，pg 发现了卷子反面还有一道大题。", "description": "求\n\n[![](https://cdn.luogu.com.cn/upload/pic/33775.png)](https://www.luogu.org/paste/zltm8ddt)\n\n由于答案可能过大，输出答案对 $10^9+7$ 取模的值。", "inputFormat": "第一行一个正整数 $T$，为数据组数。\n\n下面 $T$ 行，每行 $3$ 个整数，为 $n,m,p$。", "outputFormat": "共 $T$ 行，每行一个整数，为答案。", "hint": "对于前 $10\\%$ 的数据，$T=5~,~40 \\le n,m,p \\le 100$。\n\n对于另外 $20\\%$ 的数据，$T=50~,~100 \\le n,m,p \\le 5\\times 10^4$。\n\n对于另外 $20\\%$ 的数据，$T= 20~,~4\\times 10^6 \\le n,m,p \\le 5\\times 10^6$。\n\n对于另外 $50\\%$ 的数据，$T=10^3~,~10^7 \\le n,m,p \\le 2\\times 10^7$。", "locale": "zh-CN"}}}
{"pid": "P5177", "type": "P", "difficulty": 5, "samples": [["3\n10\n100\n1000", "20\n2634\n325502"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": [], "title": "签到", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/85008142", "description": "求$\\sum_{i=1}^n \\sum_{j=1}^n i \\  xor \\ j \\in [\\min(i,j),\\max(i,j)]$\n\n由于答案可能过大，输出答案对$10^9+7$取模的值。", "inputFormat": "第一行，一个整数$T$，为数据组数。\n\n下面$T$行，每行一个整数$n$。", "outputFormat": "对于每行数据，输出答案。", "hint": "第一组样例解释：\n\n符合题意的$(i,j)$有$20$对。\n```\ni=1  j=3  i^j=2\ni=1  j=5  i^j=4\ni=1  j=7  i^j=6\ni=1  j=9  i^j=8\ni=2  j=6  i^j=4\ni=2  j=7  i^j=5\ni=2  j=10  i^j=8\ni=3  j=1  i^j=2\ni=3  j=6  i^j=5\ni=3  j=7  i^j=4\ni=3  j=10  i^j=9\ni=5  j=1  i^j=4\ni=6  j=2  i^j=4\ni=6  j=3  i^j=5\ni=7  j=1  i^j=6\ni=7  j=2  i^j=5\ni=7  j=3  i^j=4\ni=9  j=1  i^j=8\ni=10  j=2  i^j=8\ni=10  j=3  i^j=9\n```\n\n对于27%的数据，$T\\le 5, n \\le 1000$。\n\n对于54%的数据，$T\\le 20, n \\le 5 \\times 10^5$。\n\n对于90%的数据，$T\\le 10^5, n \\le 10^{18}$。\n\n最后一个点，$T=3\\times 10^6 \\ ,\\  n\\le 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "Check-in.", "background": "Solution: https://blog.csdn.net/kkkksc03/article/details/85008142", "description": "Compute $\\sum_{i=1}^n \\sum_{j=1}^n i \\  xor \\ j \\in [\\min(i,j),\\max(i,j)]$.\n\nSince the answer may be very large, output the value modulo $10^9+7$.", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nThe next $T$ lines each contain one integer $n$.", "outputFormat": "For each test case, output the answer.", "hint": "Explanation for the first sample:\n\nThere are $20$ pairs $(i,j)$ that satisfy the condition.\n```\ni=1  j=3  i^j=2\ni=1  j=5  i^j=4\ni=1  j=7  i^j=6\ni=1  j=9  i^j=8\ni=2  j=6  i^j=4\ni=2  j=7  i^j=5\ni=2  j=10  i^j=8\ni=3  j=1  i^j=2\ni=3  j=6  i^j=5\ni=3  j=7  i^j=4\ni=3  j=10  i^j=9\ni=5  j=1  i^j=4\ni=6  j=2  i^j=4\ni=6  j=3  i^j=5\ni=7  j=1  i^j=6\ni=7  j=2  i^j=5\ni=7  j=3  i^j=4\ni=9  j=1  i^j=8\ni=10  j=2  i^j=8\ni=10  j=3  i^j=9\n```\n\nConstraints:\n\nFor $27\\%$ of the testdata, $T\\le 5$, $n \\le 1000$.\n\nFor $54\\%$ of the testdata, $T\\le 20$, $n \\le 5 \\times 10^5$.\n\nFor $90\\%$ of the testdata, $T\\le 10^5$, $n \\le 10^{18}$.\n\nFor the last test point, $T=3\\times 10^6 \\ ,\\  n\\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "签到", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/85008142", "description": "求$\\sum_{i=1}^n \\sum_{j=1}^n i \\  xor \\ j \\in [\\min(i,j),\\max(i,j)]$\n\n由于答案可能过大，输出答案对$10^9+7$取模的值。", "inputFormat": "第一行，一个整数$T$，为数据组数。\n\n下面$T$行，每行一个整数$n$。", "outputFormat": "对于每行数据，输出答案。", "hint": "第一组样例解释：\n\n符合题意的$(i,j)$有$20$对。\n```\ni=1  j=3  i^j=2\ni=1  j=5  i^j=4\ni=1  j=7  i^j=6\ni=1  j=9  i^j=8\ni=2  j=6  i^j=4\ni=2  j=7  i^j=5\ni=2  j=10  i^j=8\ni=3  j=1  i^j=2\ni=3  j=6  i^j=5\ni=3  j=7  i^j=4\ni=3  j=10  i^j=9\ni=5  j=1  i^j=4\ni=6  j=2  i^j=4\ni=6  j=3  i^j=5\ni=7  j=1  i^j=6\ni=7  j=2  i^j=5\ni=7  j=3  i^j=4\ni=9  j=1  i^j=8\ni=10  j=2  i^j=8\ni=10  j=3  i^j=9\n```\n\n对于27%的数据，$T\\le 5, n \\le 1000$。\n\n对于54%的数据，$T\\le 20, n \\le 5 \\times 10^5$。\n\n对于90%的数据，$T\\le 10^5, n \\le 10^{18}$。\n\n最后一个点，$T=3\\times 10^6 \\ ,\\  n\\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5178", "type": "P", "difficulty": 6, "samples": [["2 2\n1 2 3\n1 2 3\n0 1 3", "22\n46\n64"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["数学", "2019", "前缀和"], "title": "求和", "background": "QAQ", "description": "给定数列$a_1...a_n$及$x_0$。\n\n满足\n\n$$f[i][j]=\\begin{cases} a_i & j=0,i<=n \\\\ x_0 & j=0,i=n+1 \\\\ f[i][j-1]+f[i-1][j-1] & 0<i,j<=n+1,j<i \\\\ 0 & i<=j \\\\ \\end{cases}$$\n\n求\n\n$$\\sum_{i=0}^{n+1}\\sum_{j=0}^{n+1}f[i][j]$$\n\n~~但这样太水了~~\n\n于是给出$m$个操作，每次将$a[l]...a[r] \\  (0\\le l,r \\le n)$加$p$，对于每个操作，输出答案。\n\n特别地，若$0$在$l...r$范围内，我们认为$x_0$也加$p$。\n\n另外，在读入$m$个操作前，你也应该输出答案。\n\n由于答案可能过大，输出答案对$1234567891$取模的结果。", "inputFormat": "第一行，两个整数$n,m$。\n\n下面一行$n+1$个整数，为$a_1...a_n$及$x_0$，且最后一个是$x_0$。\n\n下面$m$行，每行$3$个整数$l,r,p$。", "outputFormat": "共$m+1$行，每行一个整数，为答案。", "hint": "共20个数据点。\n\n对于第$i$个数据点\n\n$$n,m=\\lfloor ln^{12}i+\\pi^5\\rfloor,|a,x,p|\\le \\lfloor ln^{19}i+i^{\\pi}\\rfloor$$\n\n保证$0 \\le l\\le r \\le n$\n\n~~想不到吧！~~", "locale": "zh-CN", "translations": {"en": {"title": "Sum", "background": "QAQ", "description": "Given a sequence $a_1 \\ldots a_n$ and $x_0$.\n\nIt satisfies:\n\n$$f[i][j]=\\begin{cases} a_i & j=0,i<=n \\\\ x_0 & j=0,i=n+1 \\\\ f[i][j-1]+f[i-1][j-1] & 0<i,j<=n+1,j<i \\\\ 0 & i<=j \\\\ \\end{cases}$$\n\nFind:\n\n$$\\sum_{i=0}^{n+1}\\sum_{j=0}^{n+1}f[i][j]$$\n\n~~But this is too easy.~~\n\nSo $m$ operations are given. Each time, add $p$ to $a[l] \\ldots a[r]$ $(0\\le l,r \\le n)$. For each operation, output the answer.\n\nIn particular, if $0$ is within the range $l \\ldots r$, we consider that $x_0$ is also increased by $p$.\n\nAlso, before reading the $m$ operations, you should output the answer once.\n\nSince the answer may be too large, output the result modulo $1234567891$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next line contains $n+1$ integers, which are $a_1 \\ldots a_n$ and $x_0$, and the last one is $x_0$.\n\nThe next $m$ lines each contain $3$ integers $l, r, p$.", "outputFormat": "There are $m+1$ lines in total. Each line contains one integer, the answer.", "hint": "There are $20$ test points.\n\nFor the $i$-th test point:\n\n$$n,m=\\lfloor ln^{12}i+\\pi^5\\rfloor,|a,x,p|\\le \\lfloor ln^{19}i+i^{\\pi}\\rfloor$$\n\nIt is guaranteed that $0 \\le l\\le r \\le n$.\n\n~~Didn’t expect that, right!~~\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "求和", "background": "QAQ", "description": "给定数列$a_1...a_n$及$x_0$。\n\n满足\n\n$$f[i][j]=\\begin{cases} a_i & j=0,i<=n \\\\ x_0 & j=0,i=n+1 \\\\ f[i][j-1]+f[i-1][j-1] & 0<i,j<=n+1,j<i \\\\ 0 & i<=j \\\\ \\end{cases}$$\n\n求\n\n$$\\sum_{i=0}^{n+1}\\sum_{j=0}^{n+1}f[i][j]$$\n\n~~但这样太水了~~\n\n于是给出$m$个操作，每次将$a[l]...a[r] \\  (0\\le l,r \\le n)$加$p$，对于每个操作，输出答案。\n\n特别地，若$0$在$l...r$范围内，我们认为$x_0$也加$p$。\n\n另外，在读入$m$个操作前，你也应该输出答案。\n\n由于答案可能过大，输出答案对$1234567891$取模的结果。", "inputFormat": "第一行，两个整数$n,m$。\n\n下面一行$n+1$个整数，为$a_1...a_n$及$x_0$，且最后一个是$x_0$。\n\n下面$m$行，每行$3$个整数$l,r,p$。", "outputFormat": "共$m+1$行，每行一个整数，为答案。", "hint": "共20个数据点。\n\n对于第$i$个数据点\n\n$$n,m=\\lfloor ln^{12}i+\\pi^5\\rfloor,|a,x,p|\\le \\lfloor ln^{19}i+i^{\\pi}\\rfloor$$\n\n保证$0 \\le l\\le r \\le n$\n\n~~想不到吧！~~", "locale": "zh-CN"}}}
{"pid": "P5179", "type": "P", "difficulty": 6, "samples": [["1 3 1 2\n2 1 3 1\n2 1 4 1\n1000 1001 1001 1002\n", "2/5\n5/2\n3/1\n2001/2003"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["类欧几里得算法", "Stern-Brocot 树"], "title": "Fraction", "background": null, "description": "给你四个正整数 $a,\\,b,\\,c,\\,d$ ，求一个最简分数 $\\frac{p}{q}$ 满足 $\\frac{a}{b} < \\frac{p}{q} < \\frac{c}{d}$。\n\n若有多组解，输出 $q$ 最小的一组，若仍有多组解，输出 $p$ 最小的一组。", "inputFormat": "本题有多组数据，有若干行，每行四个正整数，为每组数据的 $a,b,c,d$。", "outputFormat": "每组数据各输出一行，如果答案是 $\\frac{p}{q}$，则以 `p/q` 的格式输出。", "hint": "|测试点编号|数据组数|$a,b,c,d$|\n|:-:|:-:|:-:|\n|$1 \\sim 3$|$\\leqslant 100$|$\\leqslant 100$|\n|$4 \\sim 10$|$\\leqslant 500$|$\\leqslant 10^9$|\n\n数据保证至少存在一个最简分数符合条件。", "locale": "zh-CN", "translations": {"en": {"title": "Fraction", "background": "", "description": "You are given four positive integers $a,\\,b,\\,c,\\,d$. Find a fraction $\\frac{p}{q}$ in lowest terms such that $\\frac{a}{b} < \\frac{p}{q} < \\frac{c}{d}$.\n\nIf there are multiple solutions, output the one with the smallest $q$. If there are still multiple solutions, output the one with the smallest $p$.", "inputFormat": "This problem contains multiple test cases. There are several lines, and each line contains four positive integers, which are $a,b,c,d$ for one test case.", "outputFormat": "For each test case, output one line. If the answer is $\\frac{p}{q}$, print it in the format `p/q`.", "hint": "|Test Point ID|Number of Test Cases|Constraints on $a,b,c,d$|\n|:-:|:-:|:-:|\n|$1 \\sim 3$|$\\leqslant 100$|$\\leqslant 100$|\n|$4 \\sim 10$|$\\leqslant 500$|$\\leqslant 10^9$|\n\nThe testdata guarantees that there exists at least one fraction in lowest terms that satisfies the condition.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Fraction", "background": null, "description": "给你四个正整数 $a,\\,b,\\,c,\\,d$ ，求一个最简分数 $\\frac{p}{q}$ 满足 $\\frac{a}{b} < \\frac{p}{q} < \\frac{c}{d}$。\n\n若有多组解，输出 $q$ 最小的一组，若仍有多组解，输出 $p$ 最小的一组。", "inputFormat": "本题有多组数据，有若干行，每行四个正整数，为每组数据的 $a,b,c,d$。", "outputFormat": "每组数据各输出一行，如果答案是 $\\frac{p}{q}$，则以 `p/q` 的格式输出。", "hint": "|测试点编号|数据组数|$a,b,c,d$|\n|:-:|:-:|:-:|\n|$1 \\sim 3$|$\\leqslant 100$|$\\leqslant 100$|\n|$4 \\sim 10$|$\\leqslant 500$|$\\leqslant 10^9$|\n\n数据保证至少存在一个最简分数符合条件。", "locale": "zh-CN"}}}
{"pid": "P5180", "type": "P", "difficulty": 7, "samples": [["10 15\n1 2\n2 3\n3 4\n3 5\n3 6\n4 7\n7 8\n7 9\n7 10\n5 6\n6 8\n7 8\n4 1\n3 6\n5 3", "10 9 8 4 1 1 3 1 1 1 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["图论", "Tarjan", "模板题"], "title": "【模板】支配树", "background": "模板题，无背景。", "description": "给定一张有向图，求从 $1$ 号点出发，每个点能支配的点的个数（包括自己）。", "inputFormat": "第一行两个正整数 $n,m$，表示点数和边数。\n\n接下来 $m$ 行，每行输入两个整数 $u,v$，表示一条 $u$ 到 $v$ 的有向边。", "outputFormat": "一行 $n$ 个整数，表示每个点能支配的点的个数。", "hint": "$n\\le2\\times 10^5$，$m\\le3\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Dominator Tree", "background": "This is a template problem, with no background.", "description": "Given a directed graph, starting from node $1$, find for each node the number of nodes it can dominate (including itself).", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of nodes and the number of edges.\n\nIn the next $m$ lines, each line contains two integers $u, v$, representing a directed edge from $u$ to $v$.", "outputFormat": "Output one line with $n$ integers, representing the number of nodes each node can dominate.", "hint": "Constraints: $n \\le 2 \\times 10^5$, $m \\le 3 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】支配树", "background": "模板题，无背景。", "description": "给定一张有向图，求从 $1$ 号点出发，每个点能支配的点的个数（包括自己）。", "inputFormat": "第一行两个正整数 $n,m$，表示点数和边数。\n\n接下来 $m$ 行，每行输入两个整数 $u,v$，表示一条 $u$ 到 $v$ 的有向边。", "outputFormat": "一行 $n$ 个整数，表示每个点能支配的点的个数。", "hint": "$n\\le2\\times 10^5$，$m\\le3\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5181", "type": "P", "difficulty": 4, "samples": [["4 1 5 0 1\n1 3 4 2", "2"], ["7 3 8 1 2\n2 3 1 6 4 7 5", "0"], ["6 2 11 3 0\n6 3 5 4 2 1", "1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #1] GENIJALAC", "background": "", "description": " **译自 [COCI 2009.10](http://hsin.hr/coci/archive/2009_2010/) T5「[GENIJALAC](http://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf)」**\n\nMirko 发明了一台打乱机。机器接受一个 $N$ 列、无限行的纸带作为输入和输出。这 $N$ 列依次编号为 $1\\ldots N$。\n\n开始时，只有纸带的第一行写了数，其下方的每一行都是空白的。  \n在纸带的第一行中，每列有一个整数，第 $i$ 列上写了整数 $i$。  \n另外，Mirko 给出了一个打乱排列，这是一个长度为 $N$ 的排列 $s_1,$ $s_2,$ $\\ldots,$ $s_N$。\n\n有一个行指针，开始时指向首行。  \n每次运行该机器时，机器会将当前行（行指针所指向的行）位于第 $i$ 列的数放到下一行的第 $s_i$ 列上，$N$ 个数都放好后，指针将下移一行。\n\nMirko 运行了该机器无限次。现在 Mirko 将纸带的前 $C$ 列和后 $D$ 列剪掉了，我们称之为新的纸带。\n\n试问：在新纸带的第 $A\\sim B$ 行中，有多少行与新纸带的首行相同。", "inputFormat": "第一行五个整数 $N, A, B, C, D$。  \n第二行 $N$ 个整数 $s_1,$ $s_2,$ $\\ldots,$ $s_N$。", "outputFormat": "一行，一个整数，表示在新纸带的第 $A\\sim B$ 行中，有多少行与新纸带的首行相同。", "hint": "#### 样例说明 1\n```plain\n+-----+\n|1 2 3|4 <--\n|1 3 4|2\n|1 4 2|3\n|1 2 3|4 <--\n|1 3 4|2\n+-----+\n 1 4 2 3\n 1 2 3 4\n```\n\n#### 样例说明 2\n```plain\n1 2 3 4 5 6 7\n2 3 1 6 4 7 5\n +-------+\n3|1 2 7 6|5 4\n1|2 3 5 7|4 6\n2|3 1 4 5|6 7\n3|1 2 6 4|7 5\n1|2 3 7 6|5 4\n2|3 1 5 7|4 6\n +-------+\n3 1 2 4 5 6 7\n1 2 3 6 4 7 5\n```\n\n#### 样例说明 3\n```plain\n1 2 3 4 5 6\n     +-----+\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n6 5 2|4 3 1|\n1 2 3|4 5 6| <--\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n     +-----+\n```\n\n#### 数据范围与提示\n对于 $40\\%$ 的数据，$A,$ $B,$ $C,$ $D,$ $N\\le 2000$。  \n对于所有数据，$1\\le N\\le 5\\times 10^5,$ $1\\le A, B\\le 10^{12},$ $0\\le C,$ $D\\le N,$ $C+D\\le N$。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #1] GENIJALAC", "background": "", "description": "**Translated from [COCI 2009.10](http://hsin.hr/coci/archive/2009_2010/) T5 “[GENIJALAC](http://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf)”.**\n\nMirko invented a shuffling machine. The machine takes a paper tape with $N$ columns and infinitely many rows as both input and output. These $N$ columns are numbered $1 \\ldots N$ in order.\n\nAt the beginning, only the first row of the tape contains numbers, and every row below it is blank.  \nIn the first row, each column contains an integer: column $i$ contains the integer $i$.  \nIn addition, Mirko is given a shuffle permutation, which is a permutation of length $N$: $s_1,$ $s_2,$ $\\ldots,$ $s_N$.\n\nThere is a row pointer, which initially points to the first row.  \nEach time the machine runs, for every $i$, it moves the number in column $i$ of the current row (the row pointed to by the pointer) to column $s_i$ of the next row. After all $N$ numbers are placed, the pointer moves down by one row.\n\nMirko runs the machine infinitely many times. Now Mirko cuts off the first $C$ columns and the last $D$ columns of the tape; we call the result the new tape.\n\nQuestion: among rows $A \\sim B$ of the new tape, how many rows are identical to the first row of the new tape?", "inputFormat": "The first line contains five integers $N, A, B, C, D$.  \nThe second line contains $N$ integers $s_1,$ $s_2,$ $\\ldots,$ $s_N$.", "outputFormat": "One line with one integer: the number of rows among rows $A \\sim B$ of the new tape that are identical to the first row of the new tape.", "hint": "#### Sample Explanation 1\n```plain\n+-----+\n|1 2 3|4 <--\n|1 3 4|2\n|1 4 2|3\n|1 2 3|4 <--\n|1 3 4|2\n+-----+\n 1 4 2 3\n 1 2 3 4\n```\n\n#### Sample Explanation 2\n```plain\n1 2 3 4 5 6 7\n2 3 1 6 4 7 5\n +-------+\n3|1 2 7 6|5 4\n1|2 3 5 7|4 6\n2|3 1 4 5|6 7\n3|1 2 6 4|7 5\n1|2 3 7 6|5 4\n2|3 1 5 7|4 6\n +-------+\n3 1 2 4 5 6 7\n1 2 3 6 4 7 5\n```\n\n#### Sample Explanation 3\n```plain\n1 2 3 4 5 6\n     +-----+\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n6 5 2|4 3 1|\n1 2 3|4 5 6| <--\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n     +-----+\n```\n\n#### Constraints and Hints\n\nFor $40\\%$ of the testdata, $A,$ $B,$ $C,$ $D,$ $N \\le 2000$.  \nFor all testdata, $1 \\le N \\le 5 \\times 10^5,$ $1 \\le A, B \\le 10^{12},$ $0 \\le C,$ $D \\le N,$ and $C + D \\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #1] GENIJALAC", "background": "", "description": " **译自 [COCI 2009.10](http://hsin.hr/coci/archive/2009_2010/) T5「[GENIJALAC](http://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf)」**\n\nMirko 发明了一台打乱机。机器接受一个 $N$ 列、无限行的纸带作为输入和输出。这 $N$ 列依次编号为 $1\\ldots N$。\n\n开始时，只有纸带的第一行写了数，其下方的每一行都是空白的。  \n在纸带的第一行中，每列有一个整数，第 $i$ 列上写了整数 $i$。  \n另外，Mirko 给出了一个打乱排列，这是一个长度为 $N$ 的排列 $s_1,$ $s_2,$ $\\ldots,$ $s_N$。\n\n有一个行指针，开始时指向首行。  \n每次运行该机器时，机器会将当前行（行指针所指向的行）位于第 $i$ 列的数放到下一行的第 $s_i$ 列上，$N$ 个数都放好后，指针将下移一行。\n\nMirko 运行了该机器无限次。现在 Mirko 将纸带的前 $C$ 列和后 $D$ 列剪掉了，我们称之为新的纸带。\n\n试问：在新纸带的第 $A\\sim B$ 行中，有多少行与新纸带的首行相同。", "inputFormat": "第一行五个整数 $N, A, B, C, D$。  \n第二行 $N$ 个整数 $s_1,$ $s_2,$ $\\ldots,$ $s_N$。", "outputFormat": "一行，一个整数，表示在新纸带的第 $A\\sim B$ 行中，有多少行与新纸带的首行相同。", "hint": "#### 样例说明 1\n```plain\n+-----+\n|1 2 3|4 <--\n|1 3 4|2\n|1 4 2|3\n|1 2 3|4 <--\n|1 3 4|2\n+-----+\n 1 4 2 3\n 1 2 3 4\n```\n\n#### 样例说明 2\n```plain\n1 2 3 4 5 6 7\n2 3 1 6 4 7 5\n +-------+\n3|1 2 7 6|5 4\n1|2 3 5 7|4 6\n2|3 1 4 5|6 7\n3|1 2 6 4|7 5\n1|2 3 7 6|5 4\n2|3 1 5 7|4 6\n +-------+\n3 1 2 4 5 6 7\n1 2 3 6 4 7 5\n```\n\n#### 样例说明 3\n```plain\n1 2 3 4 5 6\n     +-----+\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n6 5 2|4 3 1|\n1 2 3|4 5 6| <--\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n     +-----+\n```\n\n#### 数据范围与提示\n对于 $40\\%$ 的数据，$A,$ $B,$ $C,$ $D,$ $N\\le 2000$。  \n对于所有数据，$1\\le N\\le 5\\times 10^5,$ $1\\le A, B\\le 10^{12},$ $0\\le C,$ $D\\le N,$ $C+D\\le N$。", "locale": "zh-CN"}}}
{"pid": "P5182", "type": "P", "difficulty": 4, "samples": [["8 0", "32"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["二分图"], "title": "棋盘覆盖", "background": "", "description": "给定一个 $N$ 行 $N$ 列的棋盘，已知某些格子禁止放置。\n\n求最多能往棋盘上放多少块的长度为 $2$、宽度为 $1$ 的骨牌，骨牌的边界与格线重合（骨牌占用两个格子），并且任意两张骨牌都不重叠。", "inputFormat": "第一行包含两个整数 $N$ 和 $t$，其中 $t$ 为禁止放置的格子的数量。\n\n接下来 $t$ 行每行包含两个整数 $x$ 和 $y$，表示位于第 $x$ 行第 $y$ 列的格子禁止放置，行列数从 $1$ 开始。", "outputFormat": "输出一个整数，表示结果。", "hint": "$1 \\le N \\le 100$，$0 \\le t \\le 100$", "locale": "zh-CN", "translations": {"en": {"title": "Board Tiling", "background": "", "description": "Given an $N$ by $N$ chessboard, it is known that some cells are forbidden to place on.\n\nFind the maximum number of dominoes of length $2$ and width $1$ that can be placed on the board. The boundary of each domino must align with the grid lines (each domino occupies two cells), and no two dominoes may overlap.", "inputFormat": "The first line contains two integers $N$ and $t$, where $t$ is the number of forbidden cells.\n\nThe next $t$ lines each contain two integers $x$ and $y$, indicating that the cell at row $x$ and column $y$ is forbidden. Row and column indices start from $1$.", "outputFormat": "Output one integer, the result.", "hint": "$1 \\le N \\le 100$，$0 \\le t \\le 100$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "棋盘覆盖", "background": "", "description": "给定一个 $N$ 行 $N$ 列的棋盘，已知某些格子禁止放置。\n\n求最多能往棋盘上放多少块的长度为 $2$、宽度为 $1$ 的骨牌，骨牌的边界与格线重合（骨牌占用两个格子），并且任意两张骨牌都不重叠。", "inputFormat": "第一行包含两个整数 $N$ 和 $t$，其中 $t$ 为禁止放置的格子的数量。\n\n接下来 $t$ 行每行包含两个整数 $x$ 和 $y$，表示位于第 $x$ 行第 $y$ 列的格子禁止放置，行列数从 $1$ 开始。", "outputFormat": "输出一个整数，表示结果。", "hint": "$1 \\le N \\le 100$，$0 \\le t \\le 100$", "locale": "zh-CN"}}}
{"pid": "P5183", "type": "P", "difficulty": 5, "samples": [["2 1\n2 1\n1 2", "1\n1"], ["3 2\n2 1 3\n1 3\n2 3", "3\n2\n1\n2"], ["5 5\n1 2 3 4 5\n1 5\n2 5\n1 4\n1 1\n3 5", "0"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2009", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #2] POSLOZI", "background": null, "description": "**译自 [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T5「[POSLOZI](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)」**\n\n给一个长度为 $N$ 的排列 $(1\\le N\\le 12)$。有 $M$ 种允许的修改方式 $(1\\le M\\le \\frac{N\\times (N-1)}{2})$，保证修改方式不重复，每种方式用 $L,$ $R$ 来表示，意为你可以将下标为 $L$ 的数与下标为 $R$ 的数交换。你可以修改该排列若干次，请给出一种修改方案，使原排列变为 $1,$ $2,$ $3,$ $\\ldots,$ $N$。如果有多种方案，输出修改次数最少的方案。如果还有多种方案，输出任意一组即可。", "inputFormat": "第一行两个整数 $N,$ $M$。  \n第二行 $N$ 个整数，表示排列。  \n接下来 $M$ 行，第 $i$ 行有两个整数，表示第 $i$ 种修改方式。", "outputFormat": "首行一个整数 $\\mathit{ope\\_cnt}$，表示最少的修改次数。  \n接下来 $\\mathit{ope\\_cnt}$ 行，每行一个整数，表示进行第 $i$ 种修改。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #2] POSLOZI", "background": "", "description": "**Translated from [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T5 “[POSLOZI](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)”.**\n\nYou are given a permutation of length $N$ $(1 \\le N \\le 12)$. There are $M$ allowed types of operations $(1 \\le M \\le \\frac{N \\times (N - 1)}{2})$. It is guaranteed that no operation type is repeated. Each operation is described by $L$, $R$, meaning you may swap the number at index $L$ with the number at index $R$. You may apply operations to the permutation any number of times. Please output one sequence of operations that turns the original permutation into $1$, $2$, $3$, $\\ldots$, $N$. If there are multiple solutions, output one with the minimum number of operations. If there are still multiple, output any one of them.", "inputFormat": "The first line contains two integers $N$, $M$.  \nThe second line contains $N$ integers, describing the permutation.  \nThe next $M$ lines each contain two integers; the $i$-th line describes the $i$-th allowed operation.", "outputFormat": "The first line contains an integer $\\mathit{ope\\_cnt}$, the minimum number of operations.  \nThe next $\\mathit{ope\\_cnt}$ lines each contain one integer, indicating that you perform the $i$-th allowed operation.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #2] POSLOZI", "background": null, "description": "**译自 [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T5「[POSLOZI](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)」**\n\n给一个长度为 $N$ 的排列 $(1\\le N\\le 12)$。有 $M$ 种允许的修改方式 $(1\\le M\\le \\frac{N\\times (N-1)}{2})$，保证修改方式不重复，每种方式用 $L,$ $R$ 来表示，意为你可以将下标为 $L$ 的数与下标为 $R$ 的数交换。你可以修改该排列若干次，请给出一种修改方案，使原排列变为 $1,$ $2,$ $3,$ $\\ldots,$ $N$。如果有多种方案，输出修改次数最少的方案。如果还有多种方案，输出任意一组即可。", "inputFormat": "第一行两个整数 $N,$ $M$。  \n第二行 $N$ 个整数，表示排列。  \n接下来 $M$ 行，第 $i$ 行有两个整数，表示第 $i$ 种修改方式。", "outputFormat": "首行一个整数 $\\mathit{ope\\_cnt}$，表示最少的修改次数。  \n接下来 $\\mathit{ope\\_cnt}$ 行，每行一个整数，表示进行第 $i$ 种修改。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5184", "type": "P", "difficulty": 5, "samples": [["3\n1 2\n1 100\n1 1", "1 2 100\n"], ["2\n5 10 20 30 40 50\n2 28 27", "10 20 28 27 30 40 50"], ["2\n3 5 1 2\n3 5 1 1", "5 1 1 5 1 2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "O2优化", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #2] PASIJANS", "background": "原题时限 5s，这里根据洛谷评测机速度更改了时限。", "description": "**译自 [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T6「[PASIJANS](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)」**\n\n给出 $N$ 个已经塞了数进去的栈（每个栈中元素的数量可能不同），有一个空的「答案队列」，你每次可以「将一个栈的栈顶元素弹出，插入答案队列的末尾」，直至所有栈都清空。试求「字典序最小」的答案队列。\n\n如果两个答案队列 $a, b$ （从队首往队尾数）前 $i-1$ 个数都相同，而 $a_i<b_i$，则我们称 $a$ 的字典序比 $b$ 的字典序小。", "inputFormat": "第一行一个整数 $N$。  \n接下来 $N$ 行，每行第一个整数为 $L$，表示栈中元素的数量。接下来按照从栈顶到栈底的顺序依次给出 $L$ 个整数。", "outputFormat": "$\\sum L$ 个整数，表示字典序最小的答案队列。", "hint": "$1\\le N\\le 1000,$ $1\\le L\\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #2] PASIJANS", "background": "The original time limit was 5 s. The time limit here has been adjusted according to the speed of Luogu's judge machines.", "description": "**Translated from [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T6 “[PASIJANS](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)”**\n\nYou are given $N$ stacks that already contain numbers (the number of elements in each stack may be different), and an empty “answer queue”. Each time, you may “pop the top element of one stack and append it to the end of the answer queue”, until all stacks become empty. Find the lexicographically smallest possible answer queue.\n\nIf two answer queues $a, b$ (from front to back) have the same first $i-1$ numbers, and $a_i<b_i$, then we say the lexicographical order of $a$ is smaller than that of $b$.", "inputFormat": "The first line contains an integer $N$.  \nIn the next $N$ lines, the first integer is $L$, the number of elements in the stack. Then $L$ integers are given in order from the top of the stack to the bottom.", "outputFormat": "Output $\\sum L$ integers, representing the lexicographically smallest answer queue.", "hint": "$1\\le N\\le 1000,$ $1\\le L\\le 1000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #2] PASIJANS", "background": "原题时限 5s，这里根据洛谷评测机速度更改了时限。", "description": "**译自 [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T6「[PASIJANS](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)」**\n\n给出 $N$ 个已经塞了数进去的栈（每个栈中元素的数量可能不同），有一个空的「答案队列」，你每次可以「将一个栈的栈顶元素弹出，插入答案队列的末尾」，直至所有栈都清空。试求「字典序最小」的答案队列。\n\n如果两个答案队列 $a, b$ （从队首往队尾数）前 $i-1$ 个数都相同，而 $a_i<b_i$，则我们称 $a$ 的字典序比 $b$ 的字典序小。", "inputFormat": "第一行一个整数 $N$。  \n接下来 $N$ 行，每行第一个整数为 $L$，表示栈中元素的数量。接下来按照从栈顶到栈底的顺序依次给出 $L$ 个整数。", "outputFormat": "$\\sum L$ 个整数，表示字典序最小的答案队列。", "hint": "$1\\le N\\le 1000,$ $1\\le L\\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P5185", "type": "P", "difficulty": 5, "samples": [["1 1\n26 02 03 03 1", "5"], ["1 1\n26 02 03 03 2", "185"], ["3 3\n22 03 01 10 9 10 10\n05 05 16 12 1 7 10\n20 06 15 01 4 9 10", "102\n204\n125"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #3] PLANETE", "background": null, "description": "**译自 [COCI 2009.12](http://hsin.hr/coci/archive/2009_2010/) T6「[PLANETE](http://hsin.hr/coci/archive/2009_2010/contest3_tasks.pdf)」**\n\n已知 $N$ 组记录，第 $i$ 组记录包含两个**无年份**的日期 $A_i,B_i$（换言之，只有月和日）以及一个长度为 $M$ 的数组 $a_{i,1},a_{i,2},\\dots,a_{i,M}$。请给出关于 $x_1,x_2,\\dots,x_M\\ (1\\le x_j\\le 365)$ 的方程组\n\n$\\begin{cases}A_1+\\displaystyle\\sum_{j=1}^M a_{1,j}x_j\\equiv B_1\\pmod{365} \\\\ A_2+\\displaystyle\\sum_{j=1}^M a_{2,j}x_j\\equiv B_2\\pmod{365} \\\\ \\vdots \\\\ A_N+\\displaystyle\\sum_{j=1}^M a_{N,j}x_j\\equiv B_N\\pmod{365}\\end{cases}$\n\n的任意一组解，若无解则仅输出 `-1`。", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $N$ 行，第 $i$ 行开头有四个整数，分别表示 $A_i$ 的日，$A_i$ 的月，$B_i$ 的日，$B_i$ 的月。接下来有 $M$ 个整数，表示 $a_{i,1},a_{i,2},\\dots,a_{i,M}$。", "outputFormat": "若有解，输出共 $M$ 行，第 $i$ 行一个整数，表示 $x_i$。\n\n若无解则仅输出 `-1`。", "hint": "$1\\le N,M\\le 200$，$0\\le a_{i,j}\\le 200$，保证输入的月、日合法。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #3] PLANETE", "background": "", "description": "**Translated from [COCI 2009.12](http://hsin.hr/coci/archive/2009_2010/) T6 “[PLANETE](http://hsin.hr/coci/archive/2009_2010/contest3_tasks.pdf)”.**\n\nYou are given $N$ records. The $i$-th record contains two dates $A_i, B_i$ **without a year** (in other words, only month and day), and an array $a_{i,1}, a_{i,2}, \\dots, a_{i,M}$ of length $M$. Find any solution to the system of equations in $x_1, x_2, \\dots, x_M\\ (1 \\le x_j \\le 365)$:\n\n$\\begin{cases}A_1+\\displaystyle\\sum_{j=1}^M a_{1,j}x_j\\equiv B_1\\pmod{365} \\\\ A_2+\\displaystyle\\sum_{j=1}^M a_{2,j}x_j\\equiv B_2\\pmod{365} \\\\ \\vdots \\\\ A_N+\\displaystyle\\sum_{j=1}^M a_{N,j}x_j\\equiv B_N\\pmod{365}\\end{cases}$\n\nIf there is no solution, output `-1` only.", "inputFormat": "The first line contains two integers $N, M$.\n\nIn the next $N$ lines, the $i$-th line starts with four integers, representing: the day of $A_i$, the month of $A_i$, the day of $B_i$, and the month of $B_i$. Then follow $M$ integers representing $a_{i,1}, a_{i,2}, \\dots, a_{i,M}$.", "outputFormat": "If there is a solution, output $M$ lines in total. The $i$-th line contains one integer, representing $x_i$.\n\nIf there is no solution, output `-1` only.", "hint": "Constraints: $1 \\le N, M \\le 200$, $0 \\le a_{i,j} \\le 200$. The input months and days are guaranteed to be valid.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #3] PLANETE", "background": null, "description": "**译自 [COCI 2009.12](http://hsin.hr/coci/archive/2009_2010/) T6「[PLANETE](http://hsin.hr/coci/archive/2009_2010/contest3_tasks.pdf)」**\n\n已知 $N$ 组记录，第 $i$ 组记录包含两个**无年份**的日期 $A_i,B_i$（换言之，只有月和日）以及一个长度为 $M$ 的数组 $a_{i,1},a_{i,2},\\dots,a_{i,M}$。请给出关于 $x_1,x_2,\\dots,x_M\\ (1\\le x_j\\le 365)$ 的方程组\n\n$\\begin{cases}A_1+\\displaystyle\\sum_{j=1}^M a_{1,j}x_j\\equiv B_1\\pmod{365} \\\\ A_2+\\displaystyle\\sum_{j=1}^M a_{2,j}x_j\\equiv B_2\\pmod{365} \\\\ \\vdots \\\\ A_N+\\displaystyle\\sum_{j=1}^M a_{N,j}x_j\\equiv B_N\\pmod{365}\\end{cases}$\n\n的任意一组解，若无解则仅输出 `-1`。", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $N$ 行，第 $i$ 行开头有四个整数，分别表示 $A_i$ 的日，$A_i$ 的月，$B_i$ 的日，$B_i$ 的月。接下来有 $M$ 个整数，表示 $a_{i,1},a_{i,2},\\dots,a_{i,M}$。", "outputFormat": "若有解，输出共 $M$ 行，第 $i$ 行一个整数，表示 $x_i$。\n\n若无解则仅输出 `-1`。", "hint": "$1\\le N,M\\le 200$，$0\\le a_{i,j}\\le 200$，保证输入的月、日合法。", "locale": "zh-CN"}}}
{"pid": "P5186", "type": "P", "difficulty": 4, "samples": [["5 3\n5 3 4 4 5", "3\n2"], ["10 3\n3 3 3 3 3 3 3 3 3 3", "0\n4"], ["7 4\n1 2 3 4 3 2 1", "4\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #4] OGRADA", "background": "", "description": " **译自 [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) T4「[OGRADA](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)」**\n\nMatija 的栅栏由 $N$ 条木板组成，从左到右依次编号为 $1\\ldots N$。$i$ 号木板的高度为 $h_i$，每条木板的宽度是 $1\\ \\rm{cm}$。\n\nMatija 想用一个宽度为 $X\\ \\rm{cm}$ 的滚筒刷来刷木板。使用滚筒刷时，要保证刷子**完全**接触栅栏（不能一部分接触一部分不接触）；另外，还要保证滚筒平行于地面。因此，每次涂色时，Matija 会在栅栏上选择连续的 $x$ 条木板，然后从下往上「刷」，一直刷到这 $x$ 条木板中最矮者的高度。\n\n根据上述规则，有可能有一些木板没法用滚筒刷来刷，Matija 不得不用牙刷来「涂」剩下的部分。因此，请帮他求出他最少只需用牙刷「涂」多少平方厘米。他还想知道，在满足「涂」的面积最少的情况下，他最少要用滚筒刷「刷」多少次。", "inputFormat": "第一行：$N,X$。  \n第二行：$h_1\\ldots h_N$。", "outputFormat": "两行。  \n第一行有一个整数，表示 Matija 最少需用牙刷涂多少平方厘米。  \n第二行有一个整数，表示最少要用滚筒刷「刷」多少次。", "hint": "#### 样例说明 1\n![pp.png](https://i.loli.net/2018/12/30/5c289875b3356.png)\n\n#### 数据范围与提示\n$1\\le N\\le 10^6,$ $1\\le X\\le 10^5,$ $1\\le h_i\\le 10^6$.", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #4] OGRADA", "background": "", "description": "**Translated from [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) Problem T4 “[OGRADA](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)”.**\n\nMatija’s fence consists of $N$ wooden boards, numbered from left to right as $1 \\ldots N$. The height of board $i$ is $h_i$, and each board has width $1\\ \\rm{cm}$.\n\nMatija wants to paint the boards using a roller brush of width $X\\ \\rm{cm}$. When using the roller, the brush must **fully** touch the fence (it cannot be partly touching and partly not), and the roller must be parallel to the ground. Therefore, each time he paints, Matija chooses $x$ consecutive boards on the fence, then “rolls” from bottom to top, until reaching the height of the shortest board among these $x$ boards.\n\nUnder these rules, it is possible that some parts of the boards cannot be painted with the roller. Matija then has to “paint” the remaining parts with a toothbrush. Therefore, please help him find the minimum number of square centimeters he must paint using the toothbrush. He also wants to know, under the condition that the toothbrush-painted area is minimized, what is the minimum number of roller “rolls” needed.", "inputFormat": "The first line: $N, X$.  \nThe second line: $h_1 \\ldots h_N$.", "outputFormat": "Two lines.  \nThe first line contains one integer, meaning the minimum number of square centimeters Matija must paint with the toothbrush.  \nThe second line contains one integer, meaning the minimum number of times he needs to “roll” with the roller.", "hint": "#### Sample Explanation 1\n\n![pp.png](https://i.loli.net/2018/12/30/5c289875b3356.png)\n\n#### Constraints\n\n$1\\le N\\le 10^6,$ $1\\le X\\le 10^5,$ $1\\le h_i\\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #4] OGRADA", "background": "", "description": " **译自 [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) T4「[OGRADA](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)」**\n\nMatija 的栅栏由 $N$ 条木板组成，从左到右依次编号为 $1\\ldots N$。$i$ 号木板的高度为 $h_i$，每条木板的宽度是 $1\\ \\rm{cm}$。\n\nMatija 想用一个宽度为 $X\\ \\rm{cm}$ 的滚筒刷来刷木板。使用滚筒刷时，要保证刷子**完全**接触栅栏（不能一部分接触一部分不接触）；另外，还要保证滚筒平行于地面。因此，每次涂色时，Matija 会在栅栏上选择连续的 $x$ 条木板，然后从下往上「刷」，一直刷到这 $x$ 条木板中最矮者的高度。\n\n根据上述规则，有可能有一些木板没法用滚筒刷来刷，Matija 不得不用牙刷来「涂」剩下的部分。因此，请帮他求出他最少只需用牙刷「涂」多少平方厘米。他还想知道，在满足「涂」的面积最少的情况下，他最少要用滚筒刷「刷」多少次。", "inputFormat": "第一行：$N,X$。  \n第二行：$h_1\\ldots h_N$。", "outputFormat": "两行。  \n第一行有一个整数，表示 Matija 最少需用牙刷涂多少平方厘米。  \n第二行有一个整数，表示最少要用滚筒刷「刷」多少次。", "hint": "#### 样例说明 1\n![pp.png](https://i.loli.net/2018/12/30/5c289875b3356.png)\n\n#### 数据范围与提示\n$1\\le N\\le 10^6,$ $1\\le X\\le 10^5,$ $1\\le h_i\\le 10^6$.", "locale": "zh-CN"}}}
{"pid": "P5187", "type": "P", "difficulty": 3, "samples": [["4 1 1", "6"], ["5 2 2", "1"], ["6 1 2", "7"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #4] KABOOM", "background": "", "description": " **译自 [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) T5「[KABOOM](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)」**\n \n**注意本题的时间限制。**\n\nLuka 在实验室里发现了一条奇怪的胶带。胶带分为 $N$ 段，从左到右依次编号为 $1\\ldots N$。胶带厚度忽略不计。\n\n胶带只能在两段的交点处弯折，且只能折叠 180°。\n\n显然胶带有两面。胶带的一面涂满了粘性超大的胶，另一面则只有前 $A$ 段和后 $B$ 段涂了粘性超大的胶。\n\n请问 Luka 有多少种折叠方式使他能还原现场（Luka 的手不会粘住胶带，但如果两个胶面粘一起了 Luka 就撕不开了）。答案对 $10301$ 取模。\n", "inputFormat": "第一行，三个整数 $N,A,B$。  \n", "outputFormat": "一行一个整数，表示答案。", "hint": "#### 样例说明 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sbnvf1fm.png)\n\n#### 数据范围与提示\n\n$1\\le A+B\\le N\\le 1000,$ $A>0,$ $B>0$.", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #4] KABOOM", "background": "", "description": "**Translated from [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) T5 “[KABOOM](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)”.**\n\n**Pay attention to the time limit of this problem.**\n\nLuka found a strange tape in the laboratory. The tape is divided into $N$ segments, numbered from left to right as $1\\ldots N$. The thickness of the tape can be ignored.\n\nThe tape can only be bent at the junction between two segments, and it can only be folded by 180°.\n\nObviously, the tape has two sides. One side of the tape is fully coated with extremely sticky glue, while on the other side, only the first $A$ segments and the last $B$ segments are coated with extremely sticky glue.\n\nHow many ways can Luka fold the tape so that he can restore the scene (Luka’s hands will not stick to the tape, but if two glued sides stick together, Luka cannot pull them apart)? Output the answer modulo $10301$.", "inputFormat": "The first line contains three integers $N, A, B$.", "outputFormat": "Output one integer, the answer.", "hint": "#### Sample Explanation 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sbnvf1fm.png)\n\n#### Constraints and Notes\n\n$1\\le A+B\\le N\\le 1000,$ $A>0,$ $B>0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #4] KABOOM", "background": "", "description": " **译自 [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) T5「[KABOOM](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)」**\n \n**注意本题的时间限制。**\n\nLuka 在实验室里发现了一条奇怪的胶带。胶带分为 $N$ 段，从左到右依次编号为 $1\\ldots N$。胶带厚度忽略不计。\n\n胶带只能在两段的交点处弯折，且只能折叠 180°。\n\n显然胶带有两面。胶带的一面涂满了粘性超大的胶，另一面则只有前 $A$ 段和后 $B$ 段涂了粘性超大的胶。\n\n请问 Luka 有多少种折叠方式使他能还原现场（Luka 的手不会粘住胶带，但如果两个胶面粘一起了 Luka 就撕不开了）。答案对 $10301$ 取模。\n", "inputFormat": "第一行，三个整数 $N,A,B$。  \n", "outputFormat": "一行一个整数，表示答案。", "hint": "#### 样例说明 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sbnvf1fm.png)\n\n#### 数据范围与提示\n\n$1\\le A+B\\le N\\le 1000,$ $A>0,$ $B>0$.", "locale": "zh-CN"}}}
{"pid": "P5188", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 BMJ\n2 3 MJP\n3 1 JPB\n5", "3"], ["3 4\n1 2 B\n2 1 P\n1 3 J\n3 1 M\n8", "2"], ["5 7\n1 2 B\n2 4 M\n1 3 J\n3 4 MB\n4 1 JP\n4 5 J\n5 1 P\n7", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2009", "矩阵加速", "容斥原理", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #4] PALACINKE", "background": "", "description": " **译自 [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) T6「[PALACINKE](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)」**\n\n安娜有几个同学过来吃可丽饼，然而安娜忘了这事。当安娜发现时，留给她烤可丽饼的时间只剩下 $T$ 分钟了。她马上跑出去采购四样原材料：面粉 `B`，鸡蛋 `J`，牛奶 `M` 和果酱 `P`。\n\n安娜周边有 $N$ 个路口，编号为 $1\\ldots N$，还有 $M$ 条单向道路连接它们。已知每条路上的商店会卖哪些材料，保证每条路上的商店至少会卖（上述四种材料中）的一种。\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dy9d4iw5.png)\n\n安娜穿过一条道路时，如果她进入了这条路上的商店买东西，则她通过这条路耗时  $2$ 分钟，否则耗时  $1$ 分钟。即使她买完了所有原材料仍可以进店买东西。\n\n安娜需要从 $1$ 开始，最终回到 $1$。\n\n安娜需要在 $T$ 分钟内采购到四种原材料。请问她有多少种「采购方式」，答案对 $5557$ 取模。采购方式包含了她经过的结点的次序，以及她在每条路上买不买材料，但不计她在哪个商店买了什么。例如，当 $T=7$ 时，在上图中有 $5$ 种采购方式：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ug3bvehg.png)", "inputFormat": "第一行：$N,M$。  \n接下来 $M$ 行，每行两个整数 $u,v$ 和一个仅可能包含 `BJMP` 四种字符的字符串 $s$，$u,v$ 表示一条单向道路，$s$ 表示这条道路上的商店会卖哪些材料。保证没有两条单向道路相同（但可能有两条连接的结点相同，而方向相反的道路）。  \n第 $N+2$ 行：$T$。", "outputFormat": "一行，一个答案，表示安娜有多少种采购方式。", "hint": "$1\\le N\\le 25,$ $1\\le M\\le 500,$ $1\\le T\\le 10^9$.  \n保证没有两条单向道路相同（但可能有两条连接的结点相同，而方向相反的道路）。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #4] PALACINKE", "background": "", "description": "**Translated from [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) Task 6 “[PALACINKE](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)”.**\n\nAnna has some classmates coming over to eat crêpes, but she forgot about it. When she realizes it, she only has $T$ minutes left to make crêpes. She immediately runs out to buy four ingredients: flour `B`, eggs `J`, milk `M`, and jam `P`.\n\nAround Anna there are $N$ intersections, numbered $1\\ldots N$, and $M$ directed roads connecting them. For each road, we know which ingredients are sold in the shop on that road. It is guaranteed that the shop on every road sells at least one of the four ingredients above.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dy9d4iw5.png)\n\nWhen Anna travels along a road, if she enters the shop on that road to buy something, then it takes her $2$ minutes to pass that road; otherwise, it takes $1$ minute. Even after she has already bought all ingredients, she may still enter shops to buy things.\n\nAnna must start from node $1$ and finally return to node $1$.\n\nAnna needs to obtain all four ingredients within $T$ minutes. Compute how many “shopping plans” she has, modulo $5557$. A shopping plan includes the order of nodes she visits, and for each road whether she buys ingredients or not, but it does not consider what exactly she buys in which shop. For example, when $T=7$, in the figure above there are $5$ shopping plans:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ug3bvehg.png)", "inputFormat": "The first line: $N, M$.  \nThe next $M$ lines: each line contains two integers $u, v$ and a string $s$ consisting only of characters `BJMP`. Here, $u, v$ describe a directed road, and $s$ indicates which ingredients are sold in the shop on that road. It is guaranteed that no two directed roads are identical (but there may be two roads connecting the same pair of nodes with opposite directions).  \nLine $N+2$: $T$.", "outputFormat": "One line with one integer, the number of shopping plans Anna has.", "hint": "Constraints: $1\\le N\\le 25$, $1\\le M\\le 500$, $1\\le T\\le 10^9$.  \nIt is guaranteed that no two directed roads are identical (but there may be two roads connecting the same pair of nodes with opposite directions).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #4] PALACINKE", "background": "", "description": " **译自 [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) T6「[PALACINKE](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)」**\n\n安娜有几个同学过来吃可丽饼，然而安娜忘了这事。当安娜发现时，留给她烤可丽饼的时间只剩下 $T$ 分钟了。她马上跑出去采购四样原材料：面粉 `B`，鸡蛋 `J`，牛奶 `M` 和果酱 `P`。\n\n安娜周边有 $N$ 个路口，编号为 $1\\ldots N$，还有 $M$ 条单向道路连接它们。已知每条路上的商店会卖哪些材料，保证每条路上的商店至少会卖（上述四种材料中）的一种。\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dy9d4iw5.png)\n\n安娜穿过一条道路时，如果她进入了这条路上的商店买东西，则她通过这条路耗时  $2$ 分钟，否则耗时  $1$ 分钟。即使她买完了所有原材料仍可以进店买东西。\n\n安娜需要从 $1$ 开始，最终回到 $1$。\n\n安娜需要在 $T$ 分钟内采购到四种原材料。请问她有多少种「采购方式」，答案对 $5557$ 取模。采购方式包含了她经过的结点的次序，以及她在每条路上买不买材料，但不计她在哪个商店买了什么。例如，当 $T=7$ 时，在上图中有 $5$ 种采购方式：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ug3bvehg.png)", "inputFormat": "第一行：$N,M$。  \n接下来 $M$ 行，每行两个整数 $u,v$ 和一个仅可能包含 `BJMP` 四种字符的字符串 $s$，$u,v$ 表示一条单向道路，$s$ 表示这条道路上的商店会卖哪些材料。保证没有两条单向道路相同（但可能有两条连接的结点相同，而方向相反的道路）。  \n第 $N+2$ 行：$T$。", "outputFormat": "一行，一个答案，表示安娜有多少种采购方式。", "hint": "$1\\le N\\le 25,$ $1\\le M\\le 500,$ $1\\le T\\le 10^9$.  \n保证没有两条单向道路相同（但可能有两条连接的结点相同，而方向相反的道路）。", "locale": "zh-CN"}}}
{"pid": "P5189", "type": "P", "difficulty": 5, "samples": [["2 5\n1 1", "3"], ["5 3\n2 2 3 2 2", "2"], ["10 4\n3 3 3 3 2 3 1 1 1 3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2009", "区间 DP", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #5] ZUMA", "background": "", "description": " **译自 [COCI 2010.03.06](http://hsin.hr/coci/archive/2009_2010/) T4「[ZUMA](http://hsin.hr/coci/archive/2009_2010/contest5_tasks.pdf)」**\n\nMirko 将 $N$ 颗弹子排成一排，依次编号为 $1\\ldots N$。$i$ 号弹子的颜色为 $c_i$。他发现，如果他触摸 $\\ge K$ 颗连续的弹子，且这些弹子的颜色相同，魔法会使这些弹子消失；此后，这 $K$ 颗弹子前面的弹子便与这 $K$ 颗弹子后面的弹子相邻。\n\nMirko 家里有很多弹子，他想在这 $N$ 颗弹子之间（也可以在开头的弹子前面或末尾的弹子后面）插入尽可能少的弹子，使得这 $N$ 颗弹子+插入的所有弹子消失。", "inputFormat": "第一行：$N,K$。  \n第二行：$c_1\\ldots c_N$。", "outputFormat": "一行，一个整数，表示他至少要插入几颗弹子。", "hint": "$1\\le N\\le 100,$ $2\\le K\\le 5,$ $1\\le c_i\\le 100$.", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #5] ZUMA", "background": "", "description": "**Translated from [COCI 2010.03.06](http://hsin.hr/coci/archive/2009_2010/) Task 4 “[ZUMA](http://hsin.hr/coci/archive/2009_2010/contest5_tasks.pdf)”.**\n\nMirko lines up $N$ marbles in a row, numbered $1 \\ldots N$ in order. The color of marble $i$ is $c_i$. He discovered that if he touches $\\ge K$ consecutive marbles and all of them have the same color, magic will make these marbles disappear; after that, the marbles before these $K$ marbles become adjacent to the marbles after these $K$ marbles.\n\nMirko has many marbles at home. He wants to insert as few marbles as possible among these $N$ marbles (he may also insert marbles before the first marble or after the last marble) so that all of the original $N$ marbles plus all inserted marbles disappear.", "inputFormat": "The first line contains $N, K$.  \nThe second line contains $c_1 \\ldots c_N$.", "outputFormat": "One line with one integer, the minimum number of marbles he needs to insert.", "hint": "Constraints: $1 \\le N \\le 100$, $2 \\le K \\le 5$, $1 \\le c_i \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #5] ZUMA", "background": "", "description": " **译自 [COCI 2010.03.06](http://hsin.hr/coci/archive/2009_2010/) T4「[ZUMA](http://hsin.hr/coci/archive/2009_2010/contest5_tasks.pdf)」**\n\nMirko 将 $N$ 颗弹子排成一排，依次编号为 $1\\ldots N$。$i$ 号弹子的颜色为 $c_i$。他发现，如果他触摸 $\\ge K$ 颗连续的弹子，且这些弹子的颜色相同，魔法会使这些弹子消失；此后，这 $K$ 颗弹子前面的弹子便与这 $K$ 颗弹子后面的弹子相邻。\n\nMirko 家里有很多弹子，他想在这 $N$ 颗弹子之间（也可以在开头的弹子前面或末尾的弹子后面）插入尽可能少的弹子，使得这 $N$ 颗弹子+插入的所有弹子消失。", "inputFormat": "第一行：$N,K$。  \n第二行：$c_1\\ldots c_N$。", "outputFormat": "一行，一个整数，表示他至少要插入几颗弹子。", "hint": "$1\\le N\\le 100,$ $2\\le K\\le 5,$ $1\\le c_i\\le 100$.", "locale": "zh-CN"}}}
{"pid": "P5190", "type": "P", "difficulty": 3, "samples": [["10 4\n1 1 2 1\n3\n0 9\n2 6\n7 7", "35\n18\n3"], ["11 3\n3 7 10\n3\n0 10\n2 6\n7 7", "8\n2\n1"], ["1000000 6\n12 3 21 436 2 19\n2\n12 16124\n692 29021", "16422\n28874"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #5] PROGRAM", "background": "", "description": " **译自 [COCI 2010.03.06](http://hsin.hr/coci/archive/2009_2010/) T5「[PROGRAM](http://hsin.hr/coci/archive/2009_2010/contest5_tasks.pdf)」**\n\n开始时，$\\mathit{seq}$ 数组已清零。请注意 $\\mathit{seq}$ 数组的第一个元素的下标是 0 而非 1。\n\n```cpp\nvoid something (int jump) {\n  for (int i = 0; i < N; i += jump)\n    ++seq[i];\n}\n```\n\nMirko 调用了 $\\tt something$ 函数 $K$ 次，第 $i$ 次调用时 $\\tt jump= \\it X_i$。\n\n接下来有 $Q$ 次查询，每次查询包含两个整数 $L_i,$ $R_i$，对于每组查询请输出 $\\displaystyle\\sum_{i=L_i}^{R_i}\\mathit{seq}_i$。", "inputFormat": "第一行：$N,K$。  \n接下来一行 $K$ 个整数，第 $i$ 个为 $X_i$。  \n第 $N+2$ 行：$Q$。  \n接下来 $Q$ 行：每行两个整数 $L_i,$ $R_i$。", "outputFormat": "共 $Q$ 行，第 $i$ 行包含第 $i$ 组查询的答案。", "hint": "#### 样例说明 1\n$seq=\\{4, 3, 4, 3, 4, 3, 4, 3, 4, 3\\}$\n\n#### 样例说明 2\n$seq=\\{3, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1\\}$\n\n#### 数据范围与提示\n$1≤N,K,Q≤10^6,$ $1≤X_i<N,$ $0≤L_i≤R_i<N$.", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #5] PROGRAM", "background": "", "description": "**Translated from [COCI 2010.03.06](http://hsin.hr/coci/archive/2009_2010/) T5 “[PROGRAM](http://hsin.hr/coci/archive/2009_2010/contest5_tasks.pdf)”.**\n\nAt the beginning, the array $\\mathit{seq}$ is all zeros. Note that the first element of $\\mathit{seq}$ has index 0, not 1.\n\n```cpp\nvoid something (int jump) {\n  for (int i = 0; i < N; i += jump)\n    ++seq[i];\n}\n```\n\nMirko called the function $\\tt something$ exactly $K$ times. In the $i$-th call, $\\tt jump = \\it X_i$.\n\nThen there are $Q$ queries. Each query contains two integers $L_i,$ $R_i$. For each query, output $\\displaystyle\\sum_{i=L_i}^{R_i}\\mathit{seq}_i$.", "inputFormat": "The first line contains $N, K$.  \nThe next line contains $K$ integers, where the $i$-th one is $X_i$.  \nLine $N + 2$ contains $Q$.  \nThe next $Q$ lines each contain two integers $L_i,$ $R_i$.", "outputFormat": "Output $Q$ lines. The $i$-th line contains the answer to the $i$-th query.", "hint": "#### Sample Explanation 1\n\n$seq=\\{4, 3, 4, 3, 4, 3, 4, 3, 4, 3\\}$\n\n#### Sample Explanation 2\n\n$seq=\\{3, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1\\}$\n\n#### Constraints\n\n$1 \\le N, K, Q \\le 10^6,$ $1 \\le X_i < N,$ $0 \\le L_i \\le R_i < N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #5] PROGRAM", "background": "", "description": " **译自 [COCI 2010.03.06](http://hsin.hr/coci/archive/2009_2010/) T5「[PROGRAM](http://hsin.hr/coci/archive/2009_2010/contest5_tasks.pdf)」**\n\n开始时，$\\mathit{seq}$ 数组已清零。请注意 $\\mathit{seq}$ 数组的第一个元素的下标是 0 而非 1。\n\n```cpp\nvoid something (int jump) {\n  for (int i = 0; i < N; i += jump)\n    ++seq[i];\n}\n```\n\nMirko 调用了 $\\tt something$ 函数 $K$ 次，第 $i$ 次调用时 $\\tt jump= \\it X_i$。\n\n接下来有 $Q$ 次查询，每次查询包含两个整数 $L_i,$ $R_i$，对于每组查询请输出 $\\displaystyle\\sum_{i=L_i}^{R_i}\\mathit{seq}_i$。", "inputFormat": "第一行：$N,K$。  \n接下来一行 $K$ 个整数，第 $i$ 个为 $X_i$。  \n第 $N+2$ 行：$Q$。  \n接下来 $Q$ 行：每行两个整数 $L_i,$ $R_i$。", "outputFormat": "共 $Q$ 行，第 $i$ 行包含第 $i$ 组查询的答案。", "hint": "#### 样例说明 1\n$seq=\\{4, 3, 4, 3, 4, 3, 4, 3, 4, 3\\}$\n\n#### 样例说明 2\n$seq=\\{3, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1\\}$\n\n#### 数据范围与提示\n$1≤N,K,Q≤10^6,$ $1≤X_i<N,$ $0≤L_i≤R_i<N$.", "locale": "zh-CN"}}}
{"pid": "P5191", "type": "P", "difficulty": 5, "samples": [["3 2 1\n1 2\n2 3\n2", "1 2 3"], ["3 2 1\n1 3\n2 3\n3", "3"], ["4 4 1\n1 2\n1 3\n2 4\n3 4\n4", "1 2 3 4\n"], ["4 4 1\n1 3\n2 3\n1 4\n2 4\n3", "3 4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["图论", "2009", "拓扑排序", "COCI（克罗地亚）", "bitset"], "title": "[COCI 2009/2010 #6] HOLMES", "background": "", "description": " **译自 [COCI 2010.03.20](http://hsin.hr/coci/archive/2009_2010/) T5「[HOLMES](http://hsin.hr/coci/archive/2009_2010/contest6_tasks.pdf)」**\n\n有 $D$ 个事件，编号分别为 $1\\ldots D$。\n\n福尔摩斯有 $M$ 组形如 $A\\rightarrow B$ 的推论，表示「如果事件 $A$ 发生，那么事件 $B$ 一定会发生」。请注意，这不代表「如果 $A$ 不发生，$B$ 就一定不会发生」。\n\n福尔摩斯的这 $M$ 组推论可以形成链式结构，例如 $A\\rightarrow B\\rightarrow C$，但一定不会形成环，如 $A\\rightarrow B\\rightarrow C\\rightarrow \\dots \\rightarrow A$。\n\n已知事件 $S_1\\ldots S_N$ 会发生，试求哪些事件一定会发生。\n\n> Update: 原题题意不清（或者是我语文太差），补充一句，这样才能解释样例 1。对于一个事件 $X$，如果存在推论 $Y_1\\rightarrow X,$ $Y_2\\rightarrow X$，那么「事件 $X$ 一定会发生」当且仅当『「事件 $Y_1$ 一定会发生」或「事件 $Y_2$ 一定会发生」……』", "inputFormat": "第一行：$D,M,N$。  \n接下来 $M$ 行：每行两个整数，表示一组推论 $A_i, B_i$。  \n接下来 $N$ 行：第 $i$ 行有一个整数 $S_i$。", "outputFormat": "一行，若干个整数，表示一定会发生的事件。\n\n~~以任意顺序输出均可~~ 请按照编号递增的顺序输出，传题人懒得写 SPJ", "hint": "#### 样例说明 2\n只知事件 3 发生，无法推出是事件 1 导致事件 3 发生还是事件 2 导致事件 3 发生。\n\n#### 样例说明 3\n事件 4 发生，则事件 2 和事件 3 至少有一者发生；  \n无论是何者发生，其条件都是事件 1 一定发生；  \n因为事件 1 一定发生，因此事件 2, 3 都一定发生。\n\n#### 样例说明 4\n事件 3 发生，则事件 1 和 2 一定有一者发生；  \n若事件 1 和 2 中有任意一者发生，则事件 4 一定会发生。\n\n#### 数据范围与提示\n$1\\le D\\le 1000,$ $1\\le M\\le 10^5,$ $1\\le N,$ $X_i,$ $A_i,$ $B_i\\le D$.", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #6] HOLMES", "background": "", "description": "**Translated from [COCI 2010.03.20](http://hsin.hr/coci/archive/2009_2010/) T5 “[HOLMES](http://hsin.hr/coci/archive/2009_2010/contest6_tasks.pdf)”.**\n\nThere are $D$ events, numbered $1\\ldots D$.\n\nHolmes has $M$ inferences of the form $A\\rightarrow B$, meaning “if event $A$ happens, then event $B$ will definitely happen”. Note that this does not mean “if $A$ does not happen, then $B$ will definitely not happen”.\n\nThese $M$ inferences can form chain structures, such as $A\\rightarrow B\\rightarrow C$, but they will never form a cycle, such as $A\\rightarrow B\\rightarrow C\\rightarrow \\dots \\rightarrow A$.\n\nIt is known that events $S_1\\ldots S_N$ will happen. Find which events will definitely happen.\n\n> Update: The original statement is unclear (or maybe my reading is poor), so here is one extra sentence to explain sample 1. For an event $X$, if there exist inferences $Y_1\\rightarrow X,$ $Y_2\\rightarrow X$, then “event $X$ will definitely happen” if and only if “event $Y_1$ will definitely happen” or “event $Y_2$ will definitely happen” ……", "inputFormat": "The first line: $D, M, N$.  \nThe next $M$ lines: each line contains two integers, representing one inference $A_i, B_i$.  \nThe next $N$ lines: the $i$-th line contains one integer $S_i$.", "outputFormat": "One line with several integers, representing the events that will definitely happen.\n\n~~Output in any order is acceptable~~ Please output them in increasing order of event number, because the uploader was too lazy to write an SPJ.", "hint": "#### Explanation for Sample 2\n\nIf we only know that event 3 happens, we cannot deduce whether event 1 caused event 3 or event 2 caused event 3.\n\n#### Explanation for Sample 3\n\nIf event 4 happens, then at least one of events 2 and 3 happens;  \nno matter which one happens, its condition is that event 1 definitely happens;  \nsince event 1 definitely happens, events 2 and 3 both definitely happen.\n\n#### Explanation for Sample 4\n\nIf event 3 happens, then at least one of events 1 and 2 definitely happens;  \nif either event 1 or event 2 happens, then event 4 will definitely happen.\n\n#### Constraints and Hints\n\n$1\\le D\\le 1000,$ $1\\le M\\le 10^5,$ $1\\le N,$ $X_i,$ $A_i,$ $B_i\\le D$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #6] HOLMES", "background": "", "description": " **译自 [COCI 2010.03.20](http://hsin.hr/coci/archive/2009_2010/) T5「[HOLMES](http://hsin.hr/coci/archive/2009_2010/contest6_tasks.pdf)」**\n\n有 $D$ 个事件，编号分别为 $1\\ldots D$。\n\n福尔摩斯有 $M$ 组形如 $A\\rightarrow B$ 的推论，表示「如果事件 $A$ 发生，那么事件 $B$ 一定会发生」。请注意，这不代表「如果 $A$ 不发生，$B$ 就一定不会发生」。\n\n福尔摩斯的这 $M$ 组推论可以形成链式结构，例如 $A\\rightarrow B\\rightarrow C$，但一定不会形成环，如 $A\\rightarrow B\\rightarrow C\\rightarrow \\dots \\rightarrow A$。\n\n已知事件 $S_1\\ldots S_N$ 会发生，试求哪些事件一定会发生。\n\n> Update: 原题题意不清（或者是我语文太差），补充一句，这样才能解释样例 1。对于一个事件 $X$，如果存在推论 $Y_1\\rightarrow X,$ $Y_2\\rightarrow X$，那么「事件 $X$ 一定会发生」当且仅当『「事件 $Y_1$ 一定会发生」或「事件 $Y_2$ 一定会发生」……』", "inputFormat": "第一行：$D,M,N$。  \n接下来 $M$ 行：每行两个整数，表示一组推论 $A_i, B_i$。  \n接下来 $N$ 行：第 $i$ 行有一个整数 $S_i$。", "outputFormat": "一行，若干个整数，表示一定会发生的事件。\n\n~~以任意顺序输出均可~~ 请按照编号递增的顺序输出，传题人懒得写 SPJ", "hint": "#### 样例说明 2\n只知事件 3 发生，无法推出是事件 1 导致事件 3 发生还是事件 2 导致事件 3 发生。\n\n#### 样例说明 3\n事件 4 发生，则事件 2 和事件 3 至少有一者发生；  \n无论是何者发生，其条件都是事件 1 一定发生；  \n因为事件 1 一定发生，因此事件 2, 3 都一定发生。\n\n#### 样例说明 4\n事件 3 发生，则事件 1 和 2 一定有一者发生；  \n若事件 1 和 2 中有任意一者发生，则事件 4 一定会发生。\n\n#### 数据范围与提示\n$1\\le D\\le 1000,$ $1\\le M\\le 10^5,$ $1\\le N,$ $X_i,$ $A_i,$ $B_i\\le D$.", "locale": "zh-CN"}}}
{"pid": "P5192", "type": "P", "difficulty": 6, "samples": [["2 3\n12 12 12\n3 18\n0 3 9\n1 3 9\n2 3 9\n3 18\n0 3 9\n1 3 9\n2 3 9", "36"], ["2 3\n12 12 12\n3 18\n0 3 9\n1 3 9\n2 3 9\n3 18\n0 3 9\n1 3 9\n2 3 9\n2 3\n12 12 12\n3 18\n0 3 9\n1 3 9\n2 3 9\n3 18\n0 3 9\n1 3 9\n2 3 9", "36\n\n36"]], "limits": {"time": [1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000]}, "tags": ["上下界网络流"], "title": "Shoot the Bullet | 东方文花帖", "background": "Translated by @chen_zhe\n\n幻想乡是一个被博丽大结界和虚幻与现实的境界所包围起来的一个美妙的地方。这里人和其他生物，例如妖怪、妖精等核平共处。\n\n射命丸文（Syameimaru Aya）是一只鸦天狗，拥有操纵风的能力，已经活了千岁以上，是《文文。新闻》的主编，拥有着一本叫做《文花帖》的手账，记录幻想乡各地的大新闻。她不仅是天狗中速度最快的鸦天狗，思考能力非常强，以别人的几倍的思考速度思考，也拥有幻想乡最高等级的力量。\n\n（译者内心 O.S.：远古的东方众都那么硬核科普的吗）\n\n![](https://i.loli.net/2019/01/12/5c3970b446151.png)", "description": "![](https://i.loli.net/2019/01/12/5c3971b885128.jpg)\n\n（附注：文花帖8-8 西行寺幽幽子 「死蝶浮月」）\n\n在接下来的 $n$ 天中，射命丸文将要拍摄幻想乡的少女的照片。并且要为第 $x$ 个少女拍摄至少 $G_x$ 张照片刊登在《文文。新闻》上。在第 $k$ 天的时候文文有 $C_k$ 位少女可以拍，且在这一天中对某个少女拍的照片数量 **必须** 在某个闭区间 $[L, R]$ 中。如果过少，文文就搞不出大新文；如果过多，就会有少女很安格瑞。\n\n除此之外，因为拍照设备的原因，对于第 $i$ 天，每天的拍照数量不能超过 $D_i$ 张。在满足这些限定的条件下，文文希望拍到的照片尽可能地多。\n\n由于文文需要去取材，因此她把这个任务交给了你，让你帮她去解决。", "inputFormat": "本题有不定组数据，保证数据组数不超过 $10$。\n\n第一行输入两个非负整数 $n$ 和 $m$，分别表示有 $n$ 天，有 $m$ 位少女。其中 $n \\leq 365$，$m \\leq 1000$。\n\n接下来一行，有 $m$ 个整数 $G_0, G_1, \\cdots, G_{m - 1}$。保证对于每一个 $G_x$，都满足 $G_x \\in [0,10^5]$。\n\n再接下来有 $n$ 段，第 $i$ 段的第一行有两个整数 $C _ i, D _ i\\ (1 \\leq C _ i \\leq 300,\\ 0 \\leq D _ i \\leq 30000)$。\n\n接下来有 $C _ i$ 行，每一行有三个非负整数 $T,L,R\\ (0 \\leq T < m,\\ 0 \\leq L \\leq R \\leq 100)$，其中 $T$ 指的是少女的编号。**同一天中输入的少女编号可能有重复，此时每个限制分别对应一次独立的拍摄，应当分别满足，互不影响。**", "outputFormat": "如果无法满足文文的需求，那么请输出 `-1`。\n\n否则请输出在满足需求的情况下，文文最多能拍多少张照片。\n\n注意每输出完一组数据之后，中间要空一行。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Shoot the Bullet | Touhou Bunkachou", "background": "Translated by @chen_zhe.\n\nGensokyo is a wonderful place surrounded by the Great Hakurei Barrier and the boundary between illusion and reality. Humans and other creatures, such as youkai and fairies, live together peacefully.\n\nSyameimaru Aya is a crow tengu who can control wind. She has lived for more than a thousand years. She is the editor-in-chief of *Bunbunmaru Newspaper* and owns a notebook called *Bunkachou*, which records major news from all around Gensokyo. She is not only the fastest crow tengu among the tengu, but also very good at thinking: she can think several times faster than others. She also possesses one of the highest levels of power in Gensokyo.\n\n(Translator's inner O.S.: Were the ancient Touhou fans doing such hardcore science popularization?)\n\n![](https://i.loli.net/2019/01/12/5c3970b446151.png)", "description": "![](https://i.loli.net/2019/01/12/5c3971b885128.jpg)\n\n(Note: Bunkachou 8-8, Saigyouji Yuyuko, \"Dead Butterfly Floating Moon\".)\n\nIn the next $n$ days, Syameimaru Aya is going to take photos of the girls in Gensokyo. She needs to take at least $G_x$ photos of the $x$-th girl to publish in *Bunbunmaru Newspaper*. On day $k$, there are $C_k$ girls available for her to photograph, and on that day, the number of photos taken of a certain girl **must** be within some closed interval $[L, R]$. If it is too few, Aya cannot make big news; if it is too many, some girls will get very angry.\n\nIn addition, due to the limitations of the camera equipment, on day $i$, the total number of photos taken that day cannot exceed $D_i$. Under all these constraints, Aya wants to take as many photos as possible.\n\nSince Aya needs to go gather materials, she hands this task to you and asks you to solve it for her.", "inputFormat": "This problem contains multiple test cases. It is guaranteed that the number of test cases does not exceed $10$.\n\nThe first line contains two non-negative integers $n$ and $m$, meaning there are $n$ days and $m$ girls. Here $n \\leq 365$ and $m \\leq 1000$.\n\nThe next line contains $m$ integers $G_0, G_1, \\cdots, G_{m - 1}$. It is guaranteed that for each $G_x$, we have $G_x \\in [0,10^5]$.\n\nThen follow $n$ blocks. In the $i$-th block, the first line contains two integers $C _ i, D _ i\\ (1 \\leq C _ i \\leq 300,\\ 0 \\leq D _ i \\leq 30000)$.\n\nThen there are $C _ i$ lines. Each line contains three non-negative integers $T,L,R\\ (0 \\leq T < m,\\ 0 \\leq L \\leq R \\leq 100)$, where $T$ is the index of the girl. **The girl indices given on the same day may repeat. In this case, each constraint corresponds to an independent photo shoot, and each must be satisfied separately without affecting the others.**", "outputFormat": "If Aya's requirements cannot be satisfied, output `-1`.\n\nOtherwise, output the maximum number of photos Aya can take while satisfying all requirements.\n\nNote that after outputting each test case, you must print a blank line.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Shoot the Bullet | 东方文花帖", "background": "Translated by @chen_zhe\n\n幻想乡是一个被博丽大结界和虚幻与现实的境界所包围起来的一个美妙的地方。这里人和其他生物，例如妖怪、妖精等核平共处。\n\n射命丸文（Syameimaru Aya）是一只鸦天狗，拥有操纵风的能力，已经活了千岁以上，是《文文。新闻》的主编，拥有着一本叫做《文花帖》的手账，记录幻想乡各地的大新闻。她不仅是天狗中速度最快的鸦天狗，思考能力非常强，以别人的几倍的思考速度思考，也拥有幻想乡最高等级的力量。\n\n（译者内心 O.S.：远古的东方众都那么硬核科普的吗）\n\n![](https://i.loli.net/2019/01/12/5c3970b446151.png)", "description": "![](https://i.loli.net/2019/01/12/5c3971b885128.jpg)\n\n（附注：文花帖8-8 西行寺幽幽子 「死蝶浮月」）\n\n在接下来的 $n$ 天中，射命丸文将要拍摄幻想乡的少女的照片。并且要为第 $x$ 个少女拍摄至少 $G_x$ 张照片刊登在《文文。新闻》上。在第 $k$ 天的时候文文有 $C_k$ 位少女可以拍，且在这一天中对某个少女拍的照片数量 **必须** 在某个闭区间 $[L, R]$ 中。如果过少，文文就搞不出大新文；如果过多，就会有少女很安格瑞。\n\n除此之外，因为拍照设备的原因，对于第 $i$ 天，每天的拍照数量不能超过 $D_i$ 张。在满足这些限定的条件下，文文希望拍到的照片尽可能地多。\n\n由于文文需要去取材，因此她把这个任务交给了你，让你帮她去解决。", "inputFormat": "本题有不定组数据，保证数据组数不超过 $10$。\n\n第一行输入两个非负整数 $n$ 和 $m$，分别表示有 $n$ 天，有 $m$ 位少女。其中 $n \\leq 365$，$m \\leq 1000$。\n\n接下来一行，有 $m$ 个整数 $G_0, G_1, \\cdots, G_{m - 1}$。保证对于每一个 $G_x$，都满足 $G_x \\in [0,10^5]$。\n\n再接下来有 $n$ 段，第 $i$ 段的第一行有两个整数 $C _ i, D _ i\\ (1 \\leq C _ i \\leq 300,\\ 0 \\leq D _ i \\leq 30000)$。\n\n接下来有 $C _ i$ 行，每一行有三个非负整数 $T,L,R\\ (0 \\leq T < m,\\ 0 \\leq L \\leq R \\leq 100)$，其中 $T$ 指的是少女的编号。**同一天中输入的少女编号可能有重复，此时每个限制分别对应一次独立的拍摄，应当分别满足，互不影响。**", "outputFormat": "如果无法满足文文的需求，那么请输出 `-1`。\n\n否则请输出在满足需求的情况下，文文最多能拍多少张照片。\n\n注意每输出完一组数据之后，中间要空一行。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5193", "type": "P", "difficulty": 6, "samples": [["3 2\n0 0\n0 2\n3 2", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "各省省选", "天津"], "title": "[TJOI2012] 炸弹", "background": "", "description": "在平面上有 $n$ 个炸弹 $[1 \\ldots n]$，每个炸弹的爆炸范围是 $|x-x_i|+|y-y_i| \\leqslant R$，如果某个炸弹爆炸了，那么它将引燃它范围内的所有炸弹。\n\n求出至少引燃多少炸弹才能使得所有炸弹都爆炸。\n\n", "inputFormat": "第一行两个整数 $n,r$。\n\n接下来 $n$ 行，每行两个整数 $x_i,y_i$，炸弹的坐标。\n", "outputFormat": "输出一行一个整数 $k$，表示最少引燃的炸弹数。\n\n", "hint": "$30\\%$ 的数据，$1 \\leqslant n \\leqslant 1000$；\n\n$100\\%$ 的数据，$1 \\leqslant n \\leqslant 100000 \\,,\\, 0 \\leqslant r \\leqslant 10^9 \\,,\\, 0 \\leqslant x_i,y_i \\leqslant 10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2012] Bombs", "background": "", "description": "There are $n$ bombs $[1 \\ldots n]$ on a plane. The explosion range of each bomb is $|x-x_i|+|y-y_i| \\leqslant R$. If a bomb explodes, it will ignite all bombs within its range.\n\nFind the minimum number of bombs that must be ignited at the beginning so that all bombs will eventually explode.", "inputFormat": "The first line contains two integers $n,r$.\n\nThe next $n$ lines each contain two integers $x_i,y_i$, the coordinates of a bomb.", "outputFormat": "Output one line with an integer $k$, the minimum number of bombs to ignite.", "hint": "For $30\\%$ of the testdata, $1 \\leqslant n \\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leqslant n \\leqslant 100000 \\,,\\, 0 \\leqslant r \\leqslant 10^9 \\,,\\, 0 \\leqslant x_i,y_i \\leqslant 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2012] 炸弹", "background": "", "description": "在平面上有 $n$ 个炸弹 $[1 \\ldots n]$，每个炸弹的爆炸范围是 $|x-x_i|+|y-y_i| \\leqslant R$，如果某个炸弹爆炸了，那么它将引燃它范围内的所有炸弹。\n\n求出至少引燃多少炸弹才能使得所有炸弹都爆炸。\n\n", "inputFormat": "第一行两个整数 $n,r$。\n\n接下来 $n$ 行，每行两个整数 $x_i,y_i$，炸弹的坐标。\n", "outputFormat": "输出一行一个整数 $k$，表示最少引燃的炸弹数。\n\n", "hint": "$30\\%$ 的数据，$1 \\leqslant n \\leqslant 1000$；\n\n$100\\%$ 的数据，$1 \\leqslant n \\leqslant 100000 \\,,\\, 0 \\leqslant r \\leqslant 10^9 \\,,\\, 0 \\leqslant x_i,y_i \\leqslant 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P5194", "type": "P", "difficulty": 3, "samples": [["3 15\n1\n10\n20\n", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2005", "USACO", "剪枝"], "title": "[USACO05DEC] Scales S", "background": "", "description": "约翰有一架用来称牛的体重的天平。与之配套的是 $ N \\ ( 1 \\leq N \\leq 1000 ) $ 个已知质量的砝码（所有砝码质量的数值都在 $32$ 位带符号整数范围内）。\n\n每次称牛时，他都把某头奶牛安置在天平的某一边，然后往天平另一边加砝码，直到天平平衡，于是此时砝码的总质量就是牛的质量（约翰不能把砝码放到奶牛的那边，因为奶牛不喜欢称体重，每当约翰把砝码放到她的蹄子底下，她就会尝试把砝码踢到约翰脸上）。\n\n天平能承受的物体的质量不是无限的，当天平某一边物体的质量大于 $ C \\ ( 1 \\leq C \\leq 2^{30} ) $ 时，天平就会被损坏。砝码按照它们质量的大小被排成一行。并且，这一行中从第 $3$ 个砝码开始，每个砝码的质量至少等于前面两个砝码（也就是质量比它小的砝码中质量最大的两个）的质量的和。\n\n约翰想知道，用他所拥有的这些砝码以及这架天平，能称出的质量最大是多少。由于天平的最大承重能力为 $C$，他不能把所有砝码都放到天平上。\n\n现在约翰告诉你每个砝码的质量，以及天平能承受的最大质量，你的任务是选出一些砝码，使它们的质量和在不压坏天平的前提下是所有组合中最大的。", "inputFormat": "第 $1$ 行输入两个用空格隔开的正整数 $ N $ 和 $ C $。\n\n第 $2$ 到 $ N+1 $ 行：每一行仅包含一个正整数，即某个砝码的质量。保证这些砝码的质量是一个不下降序列。", "outputFormat": "输出一个正整数，表示用所给的砝码能称出的不压坏天平的最大质量。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO05DEC] Scales S", "background": "", "description": "John has a scale for weighing cows. Along with it, he has $N \\ ( 1 \\leq N \\leq 1000 )$ weights with known masses (all weight values are within the range of 32-bit signed integers).\n\nEach time he weighs a cow, he puts the cow on one side of the scale, then adds weights to the other side until the scale balances. At that moment, the total mass of the weights is the cow’s mass (John cannot put weights on the cow’s side, because cows do not like being weighed. Whenever John puts a weight under her hooves, she will try to kick it into John’s face).\n\nThe scale cannot hold an unlimited mass. If the mass on either side of the scale exceeds $C \\ ( 1 \\leq C \\leq 2^{30} )$, the scale will be damaged. The weights are arranged in a line in non-decreasing order of mass. Also, starting from the 3rd weight, each weight’s mass is at least the sum of the masses of the two largest weights before it (that is, the two heaviest weights with smaller mass).\n\nJohn wants to know the maximum mass that can be weighed using the weights he has and this scale. Since the maximum load of the scale is $C$, he cannot put all weights on the scale.\n\nNow John tells you the mass of each weight and the maximum mass the scale can support. Your task is to choose some weights so that their total mass is as large as possible among all choices, without breaking the scale.", "inputFormat": "The 1st line contains two positive integers $N$ and $C$, separated by spaces.\n\nLines $2$ to $N+1$: each line contains one positive integer, the mass of a weight. It is guaranteed that these masses form a non-decreasing sequence.", "outputFormat": "Output one positive integer, the maximum mass that can be weighed without breaking the scale using the given weights.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO05DEC] Scales S", "background": "", "description": "约翰有一架用来称牛的体重的天平。与之配套的是 $ N \\ ( 1 \\leq N \\leq 1000 ) $ 个已知质量的砝码（所有砝码质量的数值都在 $32$ 位带符号整数范围内）。\n\n每次称牛时，他都把某头奶牛安置在天平的某一边，然后往天平另一边加砝码，直到天平平衡，于是此时砝码的总质量就是牛的质量（约翰不能把砝码放到奶牛的那边，因为奶牛不喜欢称体重，每当约翰把砝码放到她的蹄子底下，她就会尝试把砝码踢到约翰脸上）。\n\n天平能承受的物体的质量不是无限的，当天平某一边物体的质量大于 $ C \\ ( 1 \\leq C \\leq 2^{30} ) $ 时，天平就会被损坏。砝码按照它们质量的大小被排成一行。并且，这一行中从第 $3$ 个砝码开始，每个砝码的质量至少等于前面两个砝码（也就是质量比它小的砝码中质量最大的两个）的质量的和。\n\n约翰想知道，用他所拥有的这些砝码以及这架天平，能称出的质量最大是多少。由于天平的最大承重能力为 $C$，他不能把所有砝码都放到天平上。\n\n现在约翰告诉你每个砝码的质量，以及天平能承受的最大质量，你的任务是选出一些砝码，使它们的质量和在不压坏天平的前提下是所有组合中最大的。", "inputFormat": "第 $1$ 行输入两个用空格隔开的正整数 $ N $ 和 $ C $。\n\n第 $2$ 到 $ N+1 $ 行：每一行仅包含一个正整数，即某个砝码的质量。保证这些砝码的质量是一个不下降序列。", "outputFormat": "输出一个正整数，表示用所给的砝码能称出的不压坏天平的最大质量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5195", "type": "P", "difficulty": 4, "samples": [["8 4\n4 1 0 0 0 0 1 0\n0 0 0 1 0 1 0 0\n0 2 1 1 3 0 4 0\n0 0 0 4 1 1 1 0\n", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO", "枚举", "广度优先搜索 BFS", "折半搜索 meet in the middle"], "title": "[USACO05DEC] Knights of Ni S", "background": "", "description": "贝茜遇到了一件很麻烦的事：她无意中闯入了森林里的一座城堡，如果她想回家，就必须穿过这片由骑士们守护着的森林。为了能安全地离开，贝茜不得不按照骑士们的要求，在森林寻找一种特殊的灌木并带一棵给他们。\n\n当然，贝茜想早点离开这可怕的森林，于是她必须尽快完成骑士们给的任务，贝茜随身带着这片森林的地图，地图上的森林被放入了直角坐标系，并按 $x,y $ 轴上的单位长度划分成了 $ W \\times H\\  ( 1 \\leq W,H \\leq 1000 )$ 块，贝茜在地图上查出了她自己以及骑士们所在的位置，当然地图上也标注了她所需要的灌木生长的区域。某些区域是不能通过的（比如说沼泽地，悬崖，以及食人兔的聚居地）。在没有找到灌木之前，贝茜不能通过骑士们所在的那个区域，为了确保她自己不会迷路，贝茜只向正北、正东、正南、正西四个方向移动（注意，她不会走对角线）。她要走整整一天，才能从某块区域走到与它相邻的那块区域。\n\n贝茜希望你能帮她计算一下，她最少需要多少天才可脱离这可怕的地方？输入数据保证贝茜一定能完成骑士的任务。", "inputFormat": "第一行输入 $2$ 个用空格隔开的整数，即题目中提到的 $ W,H $。\n\n接下来输入贝茜持有的地图，每一行用若干个数字代表地图上对应行的地形。第一行描述了地图最北的那一排土地；最后一行描述的则是最南面的。相邻的数字所对应的区域是相邻的。如果地图的宽小于或等于 $40$，那每一行数字恰好对应了地图上的一排土地。如果地图的宽大于 $40$，那每行只会给出 $40$ 个数字，并且保证除了最后一行的每一行都包含恰好 $40$ 个数字。没有哪一行描述的区域分布在两个不同的行里。\n\n地图上的数字所对应的地形：\n\n- $0$：贝茜可以通过的空地；\n- $1$：由于各种原因而不可通行的区域；\n- $2$：贝茜现在所在的位置； \n- $3$：骑士们的位置；\n- $4$：长着贝茜需要的灌木的土地。", "outputFormat": "输出一个正整数，即贝茜最少要花多少天才能完成骑士们给的任务。", "hint": "这片森林的长为 $8$，宽为 $4$．贝茜的起始位置在第 $3$ 行，离骑士们不远。\n\n贝茜可以按这样的路线完成骑士的任务：北，西，北，南，东，东，北，东，东，南，南。她在森林的西北角得到一株她需要的灌木，然后绕过障碍把它交给在东南方的骑士。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO05DEC] Knights of Ni S", "background": "", "description": "Bessie has run into a big problem: she accidentally entered a castle in the forest. If she wants to go home, she must pass through this forest guarded by knights. To leave safely, Bessie has to follow the knights’ request: find a special kind of bush in the forest and bring one back to them.\n\nOf course, Bessie wants to leave this scary forest as soon as possible, so she must finish the task as quickly as she can. Bessie carries a map of the forest. The forest on the map is placed in a Cartesian coordinate system and is divided by unit lengths on the $x, y$ axes into $W \\times H$ blocks $(1 \\leq W, H \\leq 1000)$. She has found on the map the positions of herself and the knights, and the map also marks the area where the needed bush grows. Some areas cannot be passed (for example, swamps, cliffs, and places where man-eating rabbits live). Before finding the bush, Bessie cannot pass through the block where the knights are located. To make sure she does not get lost, Bessie only moves in the four directions: due north, due east, due south, and due west (note that she does not move diagonally). It takes her exactly one day to move from one block to an adjacent block.\n\nBessie wants you to help her compute the minimum number of days she needs to escape from this terrible place. The input guarantees that Bessie can complete the knights’ task.", "inputFormat": "The first line contains $2$ integers separated by spaces, i.e., $W, H$ mentioned in the statement.\n\nNext comes the map Bessie holds. Each line uses several digits to represent the terrain of the corresponding row on the map. The first line describes the northernmost row of land; the last line describes the southernmost row. Areas corresponding to adjacent digits are adjacent blocks. If the width of the map is less than or equal to $40$, then each line of digits corresponds to exactly one row of the map. If the width is greater than $40$, then each line provides only $40$ digits, and it is guaranteed that every line except the last contains exactly $40$ digits. No row of the map is split across two different input lines.\n\nThe terrain represented by the digits on the map:\n\n- $0$: empty land that Bessie can pass through.\n- $1$: impassable area for various reasons.\n- $2$: Bessie’s current position.\n- $3$: the knights’ position.\n- $4$: land where the needed bush grows.", "outputFormat": "Output one positive integer, the minimum number of days Bessie must spend to complete the knights’ task.", "hint": "The forest has length $8$ and width $4$. Bessie’s starting position is on row $3$, not far from the knights.\n\nBessie can complete the task along this route: north, west, north, south, east, east, north, east, east, south, south. She gets the bush she needs in the northwest corner of the forest, then goes around obstacles and hands it to the knights in the southeast.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO05DEC] Knights of Ni S", "background": "", "description": "贝茜遇到了一件很麻烦的事：她无意中闯入了森林里的一座城堡，如果她想回家，就必须穿过这片由骑士们守护着的森林。为了能安全地离开，贝茜不得不按照骑士们的要求，在森林寻找一种特殊的灌木并带一棵给他们。\n\n当然，贝茜想早点离开这可怕的森林，于是她必须尽快完成骑士们给的任务，贝茜随身带着这片森林的地图，地图上的森林被放入了直角坐标系，并按 $x,y $ 轴上的单位长度划分成了 $ W \\times H\\  ( 1 \\leq W,H \\leq 1000 )$ 块，贝茜在地图上查出了她自己以及骑士们所在的位置，当然地图上也标注了她所需要的灌木生长的区域。某些区域是不能通过的（比如说沼泽地，悬崖，以及食人兔的聚居地）。在没有找到灌木之前，贝茜不能通过骑士们所在的那个区域，为了确保她自己不会迷路，贝茜只向正北、正东、正南、正西四个方向移动（注意，她不会走对角线）。她要走整整一天，才能从某块区域走到与它相邻的那块区域。\n\n贝茜希望你能帮她计算一下，她最少需要多少天才可脱离这可怕的地方？输入数据保证贝茜一定能完成骑士的任务。", "inputFormat": "第一行输入 $2$ 个用空格隔开的整数，即题目中提到的 $ W,H $。\n\n接下来输入贝茜持有的地图，每一行用若干个数字代表地图上对应行的地形。第一行描述了地图最北的那一排土地；最后一行描述的则是最南面的。相邻的数字所对应的区域是相邻的。如果地图的宽小于或等于 $40$，那每一行数字恰好对应了地图上的一排土地。如果地图的宽大于 $40$，那每行只会给出 $40$ 个数字，并且保证除了最后一行的每一行都包含恰好 $40$ 个数字。没有哪一行描述的区域分布在两个不同的行里。\n\n地图上的数字所对应的地形：\n\n- $0$：贝茜可以通过的空地；\n- $1$：由于各种原因而不可通行的区域；\n- $2$：贝茜现在所在的位置； \n- $3$：骑士们的位置；\n- $4$：长着贝茜需要的灌木的土地。", "outputFormat": "输出一个正整数，即贝茜最少要花多少天才能完成骑士们给的任务。", "hint": "这片森林的长为 $8$，宽为 $4$．贝茜的起始位置在第 $3$ 行，离骑士们不远。\n\n贝茜可以按这样的路线完成骑士的任务：北，西，北，南，东，东，北，东，东，南，南。她在森林的西北角得到一株她需要的灌木，然后绕过障碍把它交给在东南方的骑士。", "locale": "zh-CN"}}}
{"pid": "P5196", "type": "P", "difficulty": 4, "samples": [["3 3 10\n3 1\n4 1\n3 2\nA\nB\nA", "960"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "2019", "USACO"], "title": "[USACO19JAN] Cow Poetry G", "background": "USACO19 年一月金组第一题", "description": "不为 Farmer John 所知的是，Bessie 还热衷于资助艺术创作！最近，她开始研究许多伟大的诗人们，而现在，她想要尝试创作一些属于自己的诗歌了。\nBessie 认识 $N$（$1 \\leq N \\leq 5000$）个单词，她想要将它们写进她的诗。Bessie 已经计算了她认识的每个单词的长度，以音节为单位，并且她将这些单词划分成了不同的“韵部”。每个单词仅与属于同一韵部的其他单词押韵。\n\nBessie 的每首诗由 $M$ 行组成（$1 \\leq M \\leq 10^5$），每一行必须由 $K$（$1 \\leq K \\leq 5000$）个音节构成。此外，Bessie 的诗必须遵循某个指定的押韵模式。\n\nBessie 想要知道她可以写出多少首符合限制条件的不同的诗。", "inputFormat": "输入的第一行包含 $N$、$M$ 和 $K$。\n\n以下 $N$ 行，每行包含两个整数 $s_i$（$1 \\leq s_i \\leq K$）和 $c_i$（$1 \\leq c_i \\leq N$）。这表示 Bessie 认识一个长度（以音节为单位）为 $s_i$、属于韵部 $c_i$ 的单词。\n\n最后 $M$ 行描述了 Bessie 想要的押韵模式，每行包含一个大写字母 $e_i$。所有押韵模式等于 $e_i$ 的行必须以同一韵部的单词结尾。不同 $e_i$ 值的行并非必须以不同的韵部的单词结尾。", "outputFormat": "输出 Bessie 可以写出的满足这些限制的不同的诗的数量。由于这个数字可能非常大，请计算这个数对 $1,000,000,007$ 取余的结果。", "hint": "在这个例子中，Bessie 认识三个单词。前两个单词押韵，长度分别为三个音节和四个音节，最后一个单词长度为三个音节，不与其他单词押韵。她想要写一首三行的诗，每行包含十个音节，并且第一行和最后一行押韵。共有 $960$ 首这样的诗。以下是一首满足要求的诗（其中 $1,2,3$ 分别代表第一个、第二个、第三个单词）：$\\text{121 123 321}$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Cow Poetry G", "background": "USACO January 2019 Gold, Problem 1.", "description": "Unknown to Farmer John, Bessie is also enthusiastic about sponsoring artistic creation. Recently, she started studying many great poets, and now she wants to try writing some poems of her own.\n\nBessie knows $N$ words ($1 \\leq N \\leq 5000$) and wants to use them in her poems. She has computed the length of each word she knows in syllables, and she has also divided these words into different \"rhyme classes\". Each word rhymes only with other words in the same rhyme class.\n\nEach poem Bessie writes has $M$ lines ($1 \\leq M \\leq 10^5$). Each line must consist of exactly $K$ syllables ($1 \\leq K \\leq 5000$). In addition, Bessie's poem must follow a specified rhyme scheme.\n\nBessie wants to know how many different poems she can write that satisfy these constraints.", "inputFormat": "The first line contains $N$, $M$, and $K$.\n\nThe next $N$ lines each contain two integers $s_i$ ($1 \\leq s_i \\leq K$) and $c_i$ ($1 \\leq c_i \\leq N$). This indicates a word that Bessie knows with length $s_i$ (in syllables) and rhyme class $c_i$.\n\nThe last $M$ lines describe the rhyme scheme Bessie wants, each containing an uppercase letter $e_i$. All lines whose rhyme scheme letter equals $e_i$ must end with a word from the same rhyme class. Lines with different $e_i$ values are not required to end with words from different rhyme classes.", "outputFormat": "Output the number of different poems Bessie can write that satisfy these constraints. Since this number may be very large, output it modulo $1,000,000,007$.", "hint": "In this example, Bessie knows three words. The first two words rhyme and have lengths of three and four syllables, respectively. The last word has length three syllables and does not rhyme with any other word. She wants to write a three-line poem, where each line has ten syllables, and the first and last lines rhyme. There are $960$ such poems. One valid poem is (where $1,2,3$ represent the first, second, and third words): $\\text{121 123 321}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Cow Poetry G", "background": "USACO19 年一月金组第一题", "description": "不为 Farmer John 所知的是，Bessie 还热衷于资助艺术创作！最近，她开始研究许多伟大的诗人们，而现在，她想要尝试创作一些属于自己的诗歌了。\nBessie 认识 $N$（$1 \\leq N \\leq 5000$）个单词，她想要将它们写进她的诗。Bessie 已经计算了她认识的每个单词的长度，以音节为单位，并且她将这些单词划分成了不同的“韵部”。每个单词仅与属于同一韵部的其他单词押韵。\n\nBessie 的每首诗由 $M$ 行组成（$1 \\leq M \\leq 10^5$），每一行必须由 $K$（$1 \\leq K \\leq 5000$）个音节构成。此外，Bessie 的诗必须遵循某个指定的押韵模式。\n\nBessie 想要知道她可以写出多少首符合限制条件的不同的诗。", "inputFormat": "输入的第一行包含 $N$、$M$ 和 $K$。\n\n以下 $N$ 行，每行包含两个整数 $s_i$（$1 \\leq s_i \\leq K$）和 $c_i$（$1 \\leq c_i \\leq N$）。这表示 Bessie 认识一个长度（以音节为单位）为 $s_i$、属于韵部 $c_i$ 的单词。\n\n最后 $M$ 行描述了 Bessie 想要的押韵模式，每行包含一个大写字母 $e_i$。所有押韵模式等于 $e_i$ 的行必须以同一韵部的单词结尾。不同 $e_i$ 值的行并非必须以不同的韵部的单词结尾。", "outputFormat": "输出 Bessie 可以写出的满足这些限制的不同的诗的数量。由于这个数字可能非常大，请计算这个数对 $1,000,000,007$ 取余的结果。", "hint": "在这个例子中，Bessie 认识三个单词。前两个单词押韵，长度分别为三个音节和四个音节，最后一个单词长度为三个音节，不与其他单词押韵。她想要写一首三行的诗，每行包含十个音节，并且第一行和最后一行押韵。共有 $960$ 首这样的诗。以下是一首满足要求的诗（其中 $1,2,3$ 分别代表第一个、第二个、第三个单词）：$\\text{121 123 321}$。", "locale": "zh-CN"}}}
{"pid": "P5197", "type": "P", "difficulty": 3, "samples": [["4\n1 2\n4 3\n2 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "2019", "USACO"], "title": "[USACO19JAN] Grass Planting S", "background": "USACO 一月月赛银组第一题", "description": "到了一年中 Farmer John 在他的草地里种草的时间了。整个农场由 $N$ 块草地组成（$1 \\leq N \\leq 10^5$），方便起见编号为 $1 \\ldots N$，由 $N-1$ 条双向的小路连接，每块草地都可以经过一些小路到达其他所有的草地。\nFarmer John 当然可以在每块草地里种不同种类的草，但是他想要使得使用的草的种类数最小，因为他用的草的种类数越多，他就需要负担更高的花费。\n\n不幸的是，他的奶牛们对选择农场上的草表现得十分苛刻。如果两块相邻（由一条小路直接相连）的草地种了同一种草，或者即使是两块接近相邻（均可由一条小路直接连向同一块草地）的草地，那么奶牛们就会抱怨她们进餐的选择不够多样。Farmer John 能做的只能是抱怨这些奶牛，因为他知道她们不能被满足的时候会制造多大的麻烦。\n\n请帮助 Farmer John 求出他的整个农场所需要的最少的草的种类数。", "inputFormat": "输入的第一行包含 $N$。以下 $N-1$ 行每行描述了一条小路连接的两块草地。", "outputFormat": "输出 Farmer John 需要使用的最少的草的种类数。", "hint": "在这个简单的例子中，4 块草地以一条直线的形式相连。最少需要三种草。例如，Farmer John 可以用草 $A,B,C$ 将草地按 $A - B - C - A$ 的方式播种。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Grass Planting S", "background": "USACO January Contest Silver Problem 1.", "description": "It is the time of year when Farmer John plants grass in his fields. The entire farm consists of $N$ fields ($1 \\leq N \\leq 10^5$), conveniently labeled $1 \\ldots N$, connected by $N-1$ bidirectional paths. From any field, it is possible to reach every other field by traveling along some paths.\n\nFarmer John could of course plant different types of grass in each field, but he wants to minimize the number of grass types used, because the more types he uses, the higher the cost he must pay.\n\nUnfortunately, his cows are very picky about the grass choices on the farm. If two adjacent fields (directly connected by a path) are planted with the same type of grass, or even if two nearly adjacent fields (both directly connected by a path to the same field) are planted with the same type of grass, then the cows will complain that their dining choices are not diverse enough. Farmer John can only complain about these cows, because he knows how much trouble they can cause when they are not satisfied.\n\nPlease help Farmer John find the minimum number of grass types needed for the entire farm.", "inputFormat": "The first line contains $N$. The following $N-1$ lines each describe a path connecting two fields.", "outputFormat": "Output the minimum number of grass types Farmer John needs to use.", "hint": "In this simple example, 4 fields are connected in a straight line. The minimum number of grass types needed is 3. For example, Farmer John can use grass $A,B,C$ to plant the fields as $A - B - C - A$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Grass Planting S", "background": "USACO 一月月赛银组第一题", "description": "到了一年中 Farmer John 在他的草地里种草的时间了。整个农场由 $N$ 块草地组成（$1 \\leq N \\leq 10^5$），方便起见编号为 $1 \\ldots N$，由 $N-1$ 条双向的小路连接，每块草地都可以经过一些小路到达其他所有的草地。\nFarmer John 当然可以在每块草地里种不同种类的草，但是他想要使得使用的草的种类数最小，因为他用的草的种类数越多，他就需要负担更高的花费。\n\n不幸的是，他的奶牛们对选择农场上的草表现得十分苛刻。如果两块相邻（由一条小路直接相连）的草地种了同一种草，或者即使是两块接近相邻（均可由一条小路直接连向同一块草地）的草地，那么奶牛们就会抱怨她们进餐的选择不够多样。Farmer John 能做的只能是抱怨这些奶牛，因为他知道她们不能被满足的时候会制造多大的麻烦。\n\n请帮助 Farmer John 求出他的整个农场所需要的最少的草的种类数。", "inputFormat": "输入的第一行包含 $N$。以下 $N-1$ 行每行描述了一条小路连接的两块草地。", "outputFormat": "输出 Farmer John 需要使用的最少的草的种类数。", "hint": "在这个简单的例子中，4 块草地以一条直线的形式相连。最少需要三种草。例如，Farmer John 可以用草 $A,B,C$ 将草地按 $A - B - C - A$ 的方式播种。", "locale": "zh-CN"}}}
{"pid": "P5198", "type": "P", "difficulty": 3, "samples": [["6\n##....\n....#.\n.#..#.\n.#####\n...###\n....##", "13 22"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2019", "USACO", "深度优先搜索 DFS"], "title": "[USACO19JAN] Icy Perimeter S", "background": "USACO 一月月赛银组第二题", "description": "Farmer John 要开始他的冰激凌生意了！他制造了一台可以生产冰激凌球的机器，然而不幸的是形状不太规则，所以他现在希望优化一下这台机器，使其产出的冰激凌球的形状更加合理。\n机器生产出的冰激凌的形状可以用一个 $N \\times N$（$1 \\leq N \\leq 1000$）的矩形图案表示，例如：\n\n```\n##....\n....#.\n.#..#.\n.#####\n...###\n....##\n```\n\n每个 `.` 字符表示空的区域，每个 `#` 字符表示一块 $1 \\times 1$ 的正方形格子大小的冰激凌。\n\n不幸的是，机器当前工作得并不是很正常，可能会生产出多个互不相连的冰激凌球（上图中有两个）。一个冰激凌球是连通的，如果其中每个冰激凌的正方形格子都可以从这个冰激凌球中其他所有的冰激凌格子出发重复地前往东、南、西、北四个方向上相邻的冰激凌格子所到达。\n\nFarmer John 想要求出他的面积最大的冰激凌球的面积和周长。冰激凌球的面积就是这个冰激凌球中 `#` 的数量。如果有多个冰激凌球并列面积最大，他想要知道其中周长最小的冰激凌球的周长。在上图中，小的冰激凌球的面积为 $2$，周长为 $6$，大的冰激凌球的面积为 $13$，周长为 $22$。\n\n注意一个冰激凌球可能在中间有“洞”（由冰激凌包围着的空的区域）。如果这样，洞的边界同样计入冰激凌球的周长。冰激凌球也可能出现在被其他冰激凌球包围的区域内，在这种情况下它们计为不同的冰激凌球。例如，以下这种情况包括一个面积为 $1$ 的冰激凌球，被包围在一个面积为 $16$ 的冰激凌球内：\n\n```\n#####\n#...#\n#.#.#\n#...#\n#####\n```\n\n同时求得冰激凌球的面积和周长十分重要，因为 Farmer John 最终想要最小化周长与面积的比值，他称这是他的冰激凌的“冰周率”。当这个比率较小的时候，冰激凌化得比较慢，因为此时冰激凌单位质量的表面积较小。\n", "inputFormat": "输入的第一行包含 $N$，以下 $N$ 行描述了机器的生产结果。其中至少出现一个 `#` 字符。", "outputFormat": "输出一行，包含两个空格分隔的整数，第一个数为最大的冰激凌球的面积，第二个数为它的周长。如果多个冰激凌球并列面积最大，输出其中周长最小的那一个的信息。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Icy Perimeter S", "background": "The second Silver problem of the USACO January contest.", "description": "Farmer John is going to start his ice cream business. He built a machine that produces scoops of ice cream, but unfortunately their shapes are not very regular. He now wants to improve the machine so that the ice cream scoops it produces have more reasonable shapes.\n\nThe shape of the ice cream produced by the machine can be represented by an $N \\times N$ ($1 \\leq N \\leq 1000$) grid pattern, for example:\n\n```\n##....\n....#.\n.#..#.\n.#####\n...###\n....##\n```\n\nEach `.` character represents an empty area, and each `#` character represents a $1 \\times 1$ square cell of ice cream.\n\nUnfortunately, the machine may produce several ice cream scoops that are not connected to each other (there are two in the picture above). An ice cream scoop is connected if every ice cream square cell in it can be reached from any other ice cream cell in the same scoop by repeatedly moving to an adjacent ice cream cell to the east, south, west, or north.\n\nFarmer John wants to find the area and perimeter of the ice cream scoop with the largest area. The area of a scoop is the number of `#` cells in it. If multiple scoops are tied for the largest area, he wants the perimeter of the one with the smallest perimeter among them. In the picture above, the smaller scoop has area $2$ and perimeter $6$, and the larger scoop has area $13$ and perimeter $22$.\n\nNote that a scoop may have “holes” in the middle (empty regions surrounded by ice cream). In that case, the boundary of the holes is also counted in the scoop’s perimeter. A scoop may also appear inside a region surrounded by another scoop; in this case, they are considered different scoops. For example, the following case contains a scoop of area $1$, surrounded by a scoop of area $16$:\n\n```\n#####\n#...#\n#.#.#\n#...#\n#####\n```\n\nIt is important to compute both the area and the perimeter of a scoop, because Farmer John ultimately wants to minimize the ratio of perimeter to area, which he calls the “ice peri rate”. When this ratio is smaller, the ice cream melts more slowly, because the surface area per unit mass is smaller.", "inputFormat": "The first line contains $N$. The next $N$ lines describe the machine’s output. There is at least one `#` character.", "outputFormat": "Output one line containing two integers separated by a space: the first is the maximum scoop area, and the second is its perimeter. If multiple scoops are tied for the maximum area, output the one with the smallest perimeter.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Icy Perimeter S", "background": "USACO 一月月赛银组第二题", "description": "Farmer John 要开始他的冰激凌生意了！他制造了一台可以生产冰激凌球的机器，然而不幸的是形状不太规则，所以他现在希望优化一下这台机器，使其产出的冰激凌球的形状更加合理。\n机器生产出的冰激凌的形状可以用一个 $N \\times N$（$1 \\leq N \\leq 1000$）的矩形图案表示，例如：\n\n```\n##....\n....#.\n.#..#.\n.#####\n...###\n....##\n```\n\n每个 `.` 字符表示空的区域，每个 `#` 字符表示一块 $1 \\times 1$ 的正方形格子大小的冰激凌。\n\n不幸的是，机器当前工作得并不是很正常，可能会生产出多个互不相连的冰激凌球（上图中有两个）。一个冰激凌球是连通的，如果其中每个冰激凌的正方形格子都可以从这个冰激凌球中其他所有的冰激凌格子出发重复地前往东、南、西、北四个方向上相邻的冰激凌格子所到达。\n\nFarmer John 想要求出他的面积最大的冰激凌球的面积和周长。冰激凌球的面积就是这个冰激凌球中 `#` 的数量。如果有多个冰激凌球并列面积最大，他想要知道其中周长最小的冰激凌球的周长。在上图中，小的冰激凌球的面积为 $2$，周长为 $6$，大的冰激凌球的面积为 $13$，周长为 $22$。\n\n注意一个冰激凌球可能在中间有“洞”（由冰激凌包围着的空的区域）。如果这样，洞的边界同样计入冰激凌球的周长。冰激凌球也可能出现在被其他冰激凌球包围的区域内，在这种情况下它们计为不同的冰激凌球。例如，以下这种情况包括一个面积为 $1$ 的冰激凌球，被包围在一个面积为 $16$ 的冰激凌球内：\n\n```\n#####\n#...#\n#.#.#\n#...#\n#####\n```\n\n同时求得冰激凌球的面积和周长十分重要，因为 Farmer John 最终想要最小化周长与面积的比值，他称这是他的冰激凌的“冰周率”。当这个比率较小的时候，冰激凌化得比较慢，因为此时冰激凌单位质量的表面积较小。\n", "inputFormat": "输入的第一行包含 $N$，以下 $N$ 行描述了机器的生产结果。其中至少出现一个 `#` 字符。", "outputFormat": "输出一行，包含两个空格分隔的整数，第一个数为最大的冰激凌球的面积，第二个数为它的周长。如果多个冰激凌球并列面积最大，输出其中周长最小的那一个的信息。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5199", "type": "P", "difficulty": 3, "samples": [["3\n4 6\n7 2\n2 5", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2019", "USACO", "排序"], "title": "[USACO19JAN] Mountain View S", "background": "USACO 2019 年一月月赛银组第三题", "description": "从农场里奶牛 Bessie 的牧草地向远端眺望，可以看到巍峨壮丽的山脉绵延在地平线上。山脉里由 $N$ 座山峰（$1≤N≤10^5$）。如果我们把 Bessie 的视野想象成 $xy$ 平面，那么每座山峰都是一个底边在 $x$ 轴上的三角形。山峰的两腰均与底边成 $45$ 度角，所以山峰的峰顶是一个直角。于是山峰 $i$ 可以由它的峰顶坐标 $(x_i,y_i)$ 精确描述。没有两座山峰有完全相同的峰顶坐标。\n\nBessie 尝试数清所有的山峰，然而由于它们几乎是相同的颜色，所以如果一座山峰的峰顶在另一座山峰的三角形区域的边界上或是内部，她就无法看清。\n\n请求出 Bessie 能够看见的不同的山峰的峰顶的数量，也就是山峰的数量。", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行每行包含 $x_i$（$0\\le x_i\\le 10^9$）和$y_i$（$1\\le y_i\\le 10^9$），描述一座山峰的峰顶的坐标。", "outputFormat": "输出 Bessie 能够分辨出的山峰的数量。", "hint": "在这个例子中，Bessie 能够看见第一座和最后一座山峰。第二座山峰被第一座山峰掩盖了。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Mountain View S", "background": "USACO January 2019 Contest, Silver Problem 3.", "description": "Looking into the distance from the pasture of the cow Bessie, she can see a magnificent mountain range stretching along the horizon. The range contains $N$ mountain peaks ($1 \\le N \\le 10^5$). If we imagine Bessie’s view as the $xy$-plane, then each mountain is a triangle whose base lies on the $x$-axis. Both sides of the triangle make a $45$ degree angle with the base, so the вершина (pinnacle, \"fengding\") is a right angle. Therefore, mountain $i$ can be described exactly by the coordinates of its peak $(x_i, y_i)$. No two mountains have exactly the same peak coordinates.\n\nBessie tries to count all the mountains. However, because they are almost the same color, if the peak of one mountain lies on the boundary or inside the triangular region of another mountain, she cannot distinguish it.\n\nFind the number of distinct mountain peaks that Bessie can see, i.e. the number of visible mountains.", "inputFormat": "The first line contains $N$. The next $N$ lines each contain $x_i$ ($0 \\le x_i \\le 10^9$) and $y_i$ ($1 \\le y_i \\le 10^9$), describing the coordinates of a mountain’s peak.", "outputFormat": "Output the number of mountains that Bessie can distinguish.", "hint": "In this example, Bessie can see the first and the last mountains. The second mountain is covered by the first mountain.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Mountain View S", "background": "USACO 2019 年一月月赛银组第三题", "description": "从农场里奶牛 Bessie 的牧草地向远端眺望，可以看到巍峨壮丽的山脉绵延在地平线上。山脉里由 $N$ 座山峰（$1≤N≤10^5$）。如果我们把 Bessie 的视野想象成 $xy$ 平面，那么每座山峰都是一个底边在 $x$ 轴上的三角形。山峰的两腰均与底边成 $45$ 度角，所以山峰的峰顶是一个直角。于是山峰 $i$ 可以由它的峰顶坐标 $(x_i,y_i)$ 精确描述。没有两座山峰有完全相同的峰顶坐标。\n\nBessie 尝试数清所有的山峰，然而由于它们几乎是相同的颜色，所以如果一座山峰的峰顶在另一座山峰的三角形区域的边界上或是内部，她就无法看清。\n\n请求出 Bessie 能够看见的不同的山峰的峰顶的数量，也就是山峰的数量。", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行每行包含 $x_i$（$0\\le x_i\\le 10^9$）和$y_i$（$1\\le y_i\\le 10^9$），描述一座山峰的峰顶的坐标。", "outputFormat": "输出 Bessie 能够分辨出的山峰的数量。", "hint": "在这个例子中，Bessie 能够看见第一座和最后一座山峰。第二座山峰被第一座山峰掩盖了。", "locale": "zh-CN"}}}
{"pid": "P5200", "type": "P", "difficulty": 4, "samples": [["4\n1 2 4 3", "3\n2 2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "USACO", "树状数组"], "title": "[USACO19JAN] Sleepy Cow Sorting G", "background": "USACO 19年一月月赛金组第二题", "description": "Farmer John正在尝试将他的 $N$ 头奶牛（$1\\le N\\le 10^5$），方便起见编号为 $1\\ldots N$，在她们前往牧草地吃早餐之前排好顺序。\n\n当前，这些奶牛以 $p_1,p_2,p_3,\\ldots,p_N$ 的顺序排成一行，Farmer John站在奶牛 $p_1$ 前面。他想要重新排列这些奶牛，使得她们的顺序变为 $1,2,3,\\ldots,N$，奶牛 $1$ 在 Farmer John 旁边。\n\n今天奶牛们有些困倦，所以任何时刻都只有直接面向 Farmer John 的奶牛会注意听 Farmer John 的指令。每一次他可以命令这头奶牛沿着队伍向后移动 $k$ 步，$k$ 可以是 $1$ 到 $N−1$ 之间的任意数。她经过的 $k$ 头奶牛会向前移动，腾出空间使得她能够插入到队伍中这些奶牛之后的位置。\n\n例如，假设 $N=4$，奶牛们开始时是这样的顺序：\n\n```plain\n FJ: 4 3 2 1\n```\n\n唯一注意 FJ 指令的奶牛是奶牛 $4$。当他命令她向队伍后移动 $2$ 步之后，队伍的顺序会变成：\n\n```plain\n FJ: 3 2 4 1 \n```\n\n现在唯一注意 FJ 指令的奶牛是奶牛 $3$，所以第二次他可以给奶牛 $3$ 下命令，如此进行直到奶牛们排好了顺序。\n\nFarmer John 急欲完成排序，这样他就可以回到他的农舍里享用他自己的早餐了。请帮助他求出一个操作序列，使得能够用最少的操作次数将奶牛们排好顺序。", "inputFormat": "输入的第一行包含 $N$。第二行包含 $N$ 个空格分隔的整数：$p_1,p_2,p_3,\\ldots,p_N$，表示奶牛们的起始顺序。", "outputFormat": "输出的第一行包含一个整数 $K$，为将奶牛们排好顺序所需的最小操作次数。\n\n第二行包含 $K$ 个空格分隔的整数，$c_1,c_2,\\ldots,c_K$，每个数均在 $1\\ldots N−1$ 之间。如果第 $i$ 次操作 FJ 命令面向他的奶牛向队伍后移动 $c_i$ 步，那么 $K$ 次操作过后奶牛们应该排好了顺序。\n\n如果存在多种最优的操作序列，你的程序可以输出其中任何一种（不过实际上是唯一解）。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Sleepy Cow Sorting G", "background": "USACO January 2019 contest, Gold Group, Problem 2.", "description": "Farmer John is trying to line up his $N$ cows ($1\\le N\\le 10^5$), numbered $1\\ldots N$ for convenience, before they head to the pasture for breakfast.\n\nCurrently, the cows are standing in a line in the order $p_1,p_2,p_3,\\ldots,p_N$, and Farmer John is standing in front of cow $p_1$. He wants to rearrange the cows so that their order becomes $1,2,3,\\ldots,N$, with cow $1$ next to Farmer John.\n\nToday the cows are a bit sleepy, so at any time, only the cow directly facing Farmer John will pay attention to his commands. In one operation, he can command this cow to move back along the line by $k$ steps, where $k$ can be any number from $1$ to $N-1$. The $k$ cows she passes will move forward to make space, allowing her to be inserted right behind those $k$ cows in the line.\n\nFor example, suppose $N=4$, and the cows start in the following order:\n\n```plain\n FJ: 4 3 2 1\n```\n\nThe only cow paying attention to FJ is cow $4$. After he commands her to move back $2$ steps, the line becomes:\n\n```plain\n FJ: 3 2 4 1 \n```\n\nNow the only cow paying attention to FJ is cow $3$, so in the second operation he can give a command to cow $3$, and so on, until the cows are sorted.\n\nFarmer John is eager to finish sorting so he can go back to his farmhouse and enjoy his own breakfast. Please help him find a sequence of operations that sorts the cows using the minimum number of operations.", "inputFormat": "The first line contains $N$.  \nThe second line contains $N$ space-separated integers: $p_1,p_2,p_3,\\ldots,p_N$, describing the cows' initial order.", "outputFormat": "The first line contains an integer $K$, the minimum number of operations needed to sort the cows.\n\nThe second line contains $K$ space-separated integers $c_1,c_2,\\ldots,c_K$, each in the range $1\\ldots N-1$. If in the $i$-th operation, FJ commands the cow facing him to move back $c_i$ steps, then after $K$ operations the cows should be sorted.\n\nIf there are multiple optimal sequences of operations, your program may output any one of them (though in practice, the solution is unique).", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Sleepy Cow Sorting G", "background": "USACO 19年一月月赛金组第二题", "description": "Farmer John正在尝试将他的 $N$ 头奶牛（$1\\le N\\le 10^5$），方便起见编号为 $1\\ldots N$，在她们前往牧草地吃早餐之前排好顺序。\n\n当前，这些奶牛以 $p_1,p_2,p_3,\\ldots,p_N$ 的顺序排成一行，Farmer John站在奶牛 $p_1$ 前面。他想要重新排列这些奶牛，使得她们的顺序变为 $1,2,3,\\ldots,N$，奶牛 $1$ 在 Farmer John 旁边。\n\n今天奶牛们有些困倦，所以任何时刻都只有直接面向 Farmer John 的奶牛会注意听 Farmer John 的指令。每一次他可以命令这头奶牛沿着队伍向后移动 $k$ 步，$k$ 可以是 $1$ 到 $N−1$ 之间的任意数。她经过的 $k$ 头奶牛会向前移动，腾出空间使得她能够插入到队伍中这些奶牛之后的位置。\n\n例如，假设 $N=4$，奶牛们开始时是这样的顺序：\n\n```plain\n FJ: 4 3 2 1\n```\n\n唯一注意 FJ 指令的奶牛是奶牛 $4$。当他命令她向队伍后移动 $2$ 步之后，队伍的顺序会变成：\n\n```plain\n FJ: 3 2 4 1 \n```\n\n现在唯一注意 FJ 指令的奶牛是奶牛 $3$，所以第二次他可以给奶牛 $3$ 下命令，如此进行直到奶牛们排好了顺序。\n\nFarmer John 急欲完成排序，这样他就可以回到他的农舍里享用他自己的早餐了。请帮助他求出一个操作序列，使得能够用最少的操作次数将奶牛们排好顺序。", "inputFormat": "输入的第一行包含 $N$。第二行包含 $N$ 个空格分隔的整数：$p_1,p_2,p_3,\\ldots,p_N$，表示奶牛们的起始顺序。", "outputFormat": "输出的第一行包含一个整数 $K$，为将奶牛们排好顺序所需的最小操作次数。\n\n第二行包含 $K$ 个空格分隔的整数，$c_1,c_2,\\ldots,c_K$，每个数均在 $1\\ldots N−1$ 之间。如果第 $i$ 次操作 FJ 命令面向他的奶牛向队伍后移动 $c_i$ 步，那么 $K$ 次操作过后奶牛们应该排好了顺序。\n\n如果存在多种最优的操作序列，你的程序可以输出其中任何一种（不过实际上是唯一解）。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5201", "type": "P", "difficulty": 4, "samples": [["5 6 2\n1 2 3 4 5\n1 2 5\n1 3 3\n2 4 3\n3 4 5\n4 5 2\n3 5 7", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "USACO", "最短路"], "title": "[USACO19JAN] Shortcut G", "background": "USACO 19 年一月月赛金组第三题", "description": "每天晚上，Farmer John 都会敲响一个巨大的铃铛，召唤他的奶牛们前来牛棚享用晚餐。奶牛们都急切地想要前往牛棚，所以她们都会沿着最短的路径行走。\n农场可以描述为 $N$ 块草地（$1 \\leq N \\leq 10,000$），方便起见编号为 $1 \\ldots N$，牛棚位于草地 $1$。草地之间由 $M$ 条双向的小路连接（$N-1 \\leq M \\leq 50,000$）。每条小路有其通过时间，从每块草地出发都存在一条由一些小路组成的路径可以到达牛棚。\n\n草地 $i$ 中有 $c_i$ 头奶牛。当她们听到晚餐铃时，这些奶牛都沿着一条消耗最少时间的路径前往牛棚。如果有多条路径并列消耗时间最少，奶牛们会选择其中“字典序”最小的路径（也就是说，她们通过在两条路径第一次出现分支的位置优先选择经过编号较小的草地的方式来打破并列关系，所以经过草地 $7$、$3$、$6$、$1$ 的路径会优先于经过 $7$、$5$、$1$ 的路径，如果它们所消耗的时间相同）。\n\nFarmer John 担心牛棚距离某些草地太远。他计算了每头奶牛路上的时间，将所有奶牛消耗的时间相加，称这个和为总移动时间。他想要通过额外添加一条从牛棚（草地 $1$）连接到某块他选择的其他草地的、通过时间为 $T$（$1 \\leq T \\leq 10,000$）的“近道”来尽可能地减少总移动时间。当一头奶牛在她平时前往牛棚的路上偶然看见这条近道时，如果这条近道能够使她更快地到达牛棚，她就会走这条路。否则，一头奶牛会仍然沿着原来的路径行走，即使使用这条近道可能会减少她的移动时间。\n\n请帮助 Farmer John 求出通过添加一条近道能够达到的总移动时间减少量的最大值。\n", "inputFormat": "输入的第一行包含 $N$、$M$ 和 $T$。以下 $N$ 行包含 $c_1 \\ldots c_N$，均为 $0 \\ldots 10,000$ 范围内的整数。以下 $M$ 行，每行由三个整数 $a$、$b$ 和 $t$ 描述了一条小路，这条小路连接了草地 $a$ 和 $b$，通过时间为 $t$。所有的通过时间在 $1 \\ldots 25,000$ 范围内。", "outputFormat": "输出 Farmer John 可以达到的总移动时间的最大减少量。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Shortcut G", "background": "The third Gold problem of the USACO January 2019 contest.", "description": "Every evening, Farmer John rings a huge bell to call his cows to the barn for dinner. The cows are eager to get to the barn, so they all travel along the shortest path.\n\nThe farm can be described as $N$ fields ($1 \\leq N \\leq 10,000$), numbered $1 \\ldots N$ for convenience, and the barn is located at field $1$. The fields are connected by $M$ bidirectional paths ($N-1 \\leq M \\leq 50,000$). Each path has a travel time, and from every field there exists a route (made of some paths) that can reach the barn.\n\nField $i$ has $c_i$ cows. When they hear the dinner bell, these cows all head to the barn along a path with the minimum total travel time. If multiple paths tie for the minimum total time, the cows choose the lexicographically smallest path (that is, they break ties by, at the first point where the two paths diverge, preferring the one that goes through the smaller-numbered field. So the path through fields $7$, $3$, $6$, $1$ is preferred over the path through $7$, $5$, $1$ if they take the same amount of time).\n\nFarmer John worries that the barn is too far from some fields. He computes the travel time for each cow and sums them up, calling this sum the total travel time. He wants to reduce the total travel time as much as possible by adding one extra “shortcut”: a path from the barn (field $1$) to some other field of his choice, with travel time $T$ ($1 \\leq T \\leq 10,000$). When a cow happens to see this shortcut while traveling to the barn along her usual route, if taking the shortcut would allow her to reach the barn faster, she will take it. Otherwise, she will still follow the original route, even if using the shortcut might reduce her travel time.\n\nHelp Farmer John find the maximum possible reduction in total travel time that can be achieved by adding one shortcut.", "inputFormat": "The first line contains $N$, $M$, and $T$. The next $N$ lines contain $c_1 \\ldots c_N$, each an integer in the range $0 \\ldots 10,000$. The next $M$ lines each contain three integers $a$, $b$, and $t$, describing a path connecting fields $a$ and $b with travel time $t$. All travel times are in the range $1 \\ldots 25,000$.", "outputFormat": "Output the maximum reduction in total travel time that Farmer John can achieve.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Shortcut G", "background": "USACO 19 年一月月赛金组第三题", "description": "每天晚上，Farmer John 都会敲响一个巨大的铃铛，召唤他的奶牛们前来牛棚享用晚餐。奶牛们都急切地想要前往牛棚，所以她们都会沿着最短的路径行走。\n农场可以描述为 $N$ 块草地（$1 \\leq N \\leq 10,000$），方便起见编号为 $1 \\ldots N$，牛棚位于草地 $1$。草地之间由 $M$ 条双向的小路连接（$N-1 \\leq M \\leq 50,000$）。每条小路有其通过时间，从每块草地出发都存在一条由一些小路组成的路径可以到达牛棚。\n\n草地 $i$ 中有 $c_i$ 头奶牛。当她们听到晚餐铃时，这些奶牛都沿着一条消耗最少时间的路径前往牛棚。如果有多条路径并列消耗时间最少，奶牛们会选择其中“字典序”最小的路径（也就是说，她们通过在两条路径第一次出现分支的位置优先选择经过编号较小的草地的方式来打破并列关系，所以经过草地 $7$、$3$、$6$、$1$ 的路径会优先于经过 $7$、$5$、$1$ 的路径，如果它们所消耗的时间相同）。\n\nFarmer John 担心牛棚距离某些草地太远。他计算了每头奶牛路上的时间，将所有奶牛消耗的时间相加，称这个和为总移动时间。他想要通过额外添加一条从牛棚（草地 $1$）连接到某块他选择的其他草地的、通过时间为 $T$（$1 \\leq T \\leq 10,000$）的“近道”来尽可能地减少总移动时间。当一头奶牛在她平时前往牛棚的路上偶然看见这条近道时，如果这条近道能够使她更快地到达牛棚，她就会走这条路。否则，一头奶牛会仍然沿着原来的路径行走，即使使用这条近道可能会减少她的移动时间。\n\n请帮助 Farmer John 求出通过添加一条近道能够达到的总移动时间减少量的最大值。\n", "inputFormat": "输入的第一行包含 $N$、$M$ 和 $T$。以下 $N$ 行包含 $c_1 \\ldots c_N$，均为 $0 \\ldots 10,000$ 范围内的整数。以下 $M$ 行，每行由三个整数 $a$、$b$ 和 $t$ 描述了一条小路，这条小路连接了草地 $a$ 和 $b$，通过时间为 $t$。所有的通过时间在 $1 \\ldots 25,000$ 范围内。", "outputFormat": "输出 Farmer John 可以达到的总移动时间的最大减少量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5202", "type": "P", "difficulty": 4, "samples": [["7 2\nHGHGGHG", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "USACO", "优先队列"], "title": "[USACO19JAN] Redistricting P", "background": "USACO 19 年一月月赛铂金组第一题。", "description": "奶牛们的特大城市，牛都，要进行重新分区了！——这总是一个在居住在这里的两大主要种族（荷斯坦牛和更赛牛）之间富有争议的政治事件，因为两大种族都想要在牛都政府中保持足够的影响力。\n\n牛都的大都市圈由一列 $n$ 块牧草地组成，每块里有一头奶牛，均为荷斯坦牛 (Holstein) 和更赛牛 (Guernsey) 之一。\n\n牛都政府想要将大都市圈划分为若干个连续的区，使得每个区至少包含一块牧草地且至多包含 $k$ 块牧草地，并且每块牧草地恰好属于一个区。由于政府当前由荷斯坦牛控制，她们想要找到一种分区方式能够最小化更赛牛较多或者均势的区的数量（如果更赛牛的数量与荷斯坦牛的数量相等那么这个区就是均势的）。\n\n有一个关心政治的更赛牛团体想要知道政府的分区计划可能会对她们造成多少损害。帮助她们求出最坏情况，也就是更赛牛较多或是均势的区的最小可能的数量。", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表牧草地的个数 $n$ 和每个区包含草地的上限 $k$。\n\n输入的第二行是一个长度为 $n$ 的字符串 $s$，$s$ 中只含字符 `H` 和 `G`。若 $s$ 的第 $i$ 个字符是 `H`，则代表第 $i$ 块草地上的奶牛是荷斯坦牛，否则是更赛牛。", "outputFormat": "输出一行一个整数，代表更赛牛较多或者优势区的最小可能数量。", "hint": "### 样例解释\n\n一种可能的划分方式是 $[1],~[2, 3],~[4, 5],~[6, 7]$。第二、四个区是均势的区，第三个区是更赛牛优势的区。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，保证 $1 \\leq k \\leq n \\leq 3 \\times 10^5$，$s$ 的长度为 $n$，且只含字符 `H` 和 `G`。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Redistricting P", "background": "The first Platinum problem of the USACO January 2019 contest.", "description": "The cows’ megacity, Cowopolis, is going to be redistricted! This is always a controversial political event between the two main groups living here (Holsteins and Guernseys), because both groups want to keep enough influence in the Cowopolis government.\n\nThe Cowopolis metropolitan area consists of a line of $n$ pasture blocks, each containing one cow, which is either a Holstein or a Guernsey.\n\nThe Cowopolis government wants to divide the metropolitan area into several contiguous districts, such that each district contains at least one pasture block and at most $k$ pasture blocks, and each pasture block belongs to exactly one district. Since the government is currently controlled by Holsteins, they want to find a redistricting plan that minimizes the number of districts where Guernseys are in the majority or the district is tied (a district is tied if the number of Guernseys equals the number of Holsteins).\n\nA politically concerned Guernsey group wants to know how much damage the government’s redistricting plan could do to them. Help them find the worst case, i.e., the minimum possible number of districts where Guernseys have a majority or the district is tied.", "inputFormat": "The first line contains two integers separated by spaces, representing the number of pasture blocks $n$ and the maximum number of pasture blocks in each district $k$.\n\nThe second line contains a string $s$ of length $n$, consisting only of the characters `H` and `G`. If the $i$-th character of $s$ is `H`, then the cow on the $i$-th pasture block is a Holstein; otherwise, it is a Guernsey.", "outputFormat": "Output one integer on one line, representing the minimum possible number of districts where Guernseys are in the majority or the district is tied.", "hint": "### Sample Explanation\n\nOne possible partition is $[1],~[2, 3],~[4, 5],~[6, 7]$. The second and fourth districts are tied, and the third district has a Guernsey majority.\n\n### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\leq k \\leq n \\leq 3 \\times 10^5$, the length of $s$ is $n$, and $s$ contains only the characters `H` and `G`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Redistricting P", "background": "USACO 19 年一月月赛铂金组第一题。", "description": "奶牛们的特大城市，牛都，要进行重新分区了！——这总是一个在居住在这里的两大主要种族（荷斯坦牛和更赛牛）之间富有争议的政治事件，因为两大种族都想要在牛都政府中保持足够的影响力。\n\n牛都的大都市圈由一列 $n$ 块牧草地组成，每块里有一头奶牛，均为荷斯坦牛 (Holstein) 和更赛牛 (Guernsey) 之一。\n\n牛都政府想要将大都市圈划分为若干个连续的区，使得每个区至少包含一块牧草地且至多包含 $k$ 块牧草地，并且每块牧草地恰好属于一个区。由于政府当前由荷斯坦牛控制，她们想要找到一种分区方式能够最小化更赛牛较多或者均势的区的数量（如果更赛牛的数量与荷斯坦牛的数量相等那么这个区就是均势的）。\n\n有一个关心政治的更赛牛团体想要知道政府的分区计划可能会对她们造成多少损害。帮助她们求出最坏情况，也就是更赛牛较多或是均势的区的最小可能的数量。", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表牧草地的个数 $n$ 和每个区包含草地的上限 $k$。\n\n输入的第二行是一个长度为 $n$ 的字符串 $s$，$s$ 中只含字符 `H` 和 `G`。若 $s$ 的第 $i$ 个字符是 `H`，则代表第 $i$ 块草地上的奶牛是荷斯坦牛，否则是更赛牛。", "outputFormat": "输出一行一个整数，代表更赛牛较多或者优势区的最小可能数量。", "hint": "### 样例解释\n\n一种可能的划分方式是 $[1],~[2, 3],~[4, 5],~[6, 7]$。第二、四个区是均势的区，第三个区是更赛牛优势的区。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，保证 $1 \\leq k \\leq n \\leq 3 \\times 10^5$，$s$ 的长度为 $n$，且只含字符 `H` 和 `G`。", "locale": "zh-CN"}}}
{"pid": "P5203", "type": "P", "difficulty": 6, "samples": [["5 8\n1 2\n1 3\n1 4\n1 5\n2 3\n3 4\n4 5\n5 2", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "USACO", "最近公共祖先 LCA", "容斥原理"], "title": "[USACO19JAN] Exercise Route P", "background": "USACO 19 年一月月赛铂金组第二题。", "description": "奶牛 Bessie 意识到为了保持好的体形她需要更多地进行锻炼。她需要你帮助她选择在农场里每天用来晨跑的路线。 农场由 $n$ 块草地组成，方便起见编号为 $1\\sim n$，由 $m$ 条双向的小路连接。作为一种遵循规律的生物，奶牛们倾向于使用其中特定的 $n−1$ 条小路作为她们日常在草地之间移动的路线——她们管这些叫“常规的”小路。从每块草地出发都可以仅通过常规的小路到达所有其他草地。\n\n为了使她的晨跑更加有趣，Bessie 觉得她应该选择一条包含一些非常规的小路的路线。然而，使用常规的小路能够使她感到舒适，所以她不是很想在她的路线中使用过多非常规的小路。经过一些思考，她认为一条好的路线应当形成一个简单环（能够不经过任何草地超过一次的情况下回到起点），其中包含恰好两条非常规的小路。\n\n请帮助 Bessie 计算她可以使用的好的路线的数量。两条路线被认为是相同的，如果它们包含的小路的集合相等。", "inputFormat": "输入的第一行包含 $n$ 和 $m$。以下 $m$ 行每行包含两个整数 $a_i$ 和 $b_i$，描述了一条小路的两端。其中前 $(n−1)$ 条是常规的小路。", "outputFormat": "输出一行一个整数表示 Bessie 可以选择的路线的总数。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq n \\leq 2 \\times 10^5$，$1 \\leq m \\leq 2 \\times 10^5$，$m \\geq n - 1$，$1 \\leq a_i, b_i \\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Exercise Route P", "background": "USACO January 2019 Contest, Platinum Problem 2.", "description": "The cow Bessie realizes that in order to stay in good shape, she needs to exercise more. She needs your help choosing a route on the farm for her morning run each day. The farm consists of $n$ pastures, numbered $1 \\sim n$ for convenience, connected by $m$ undirected paths. As creatures of habit, the cows tend to use a specific set of $n - 1$ paths as their daily routes for moving between pastures—these are called the “regular” paths. From any pasture, it is possible to reach every other pasture using only regular paths.\n\nTo make her morning run more interesting, Bessie thinks she should choose a route that includes some non-regular paths. However, using regular paths makes her feel comfortable, so she does not want to use too many non-regular paths in her route. After some thought, she decides that a good route should form a simple cycle (returning to the starting point without visiting any pasture more than once), and it must contain exactly two non-regular paths.\n\nPlease help Bessie compute the number of good routes she can take. Two routes are considered the same if they contain the same set of paths.", "inputFormat": "The first line contains $n$ and $m$. The next $m$ lines each contain two integers $a_i$ and $b_i$, describing the endpoints of a path. The first $(n - 1)$ paths are regular paths.", "outputFormat": "Output one line with an integer representing the total number of routes Bessie can choose.", "hint": "#### Constraints\n\nFor all test cases, it is guaranteed that $1 \\leq n \\leq 2 \\times 10^5$, $1 \\leq m \\leq 2 \\times 10^5$, $m \\geq n - 1$, and $1 \\leq a_i, b_i \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Exercise Route P", "background": "USACO 19 年一月月赛铂金组第二题。", "description": "奶牛 Bessie 意识到为了保持好的体形她需要更多地进行锻炼。她需要你帮助她选择在农场里每天用来晨跑的路线。 农场由 $n$ 块草地组成，方便起见编号为 $1\\sim n$，由 $m$ 条双向的小路连接。作为一种遵循规律的生物，奶牛们倾向于使用其中特定的 $n−1$ 条小路作为她们日常在草地之间移动的路线——她们管这些叫“常规的”小路。从每块草地出发都可以仅通过常规的小路到达所有其他草地。\n\n为了使她的晨跑更加有趣，Bessie 觉得她应该选择一条包含一些非常规的小路的路线。然而，使用常规的小路能够使她感到舒适，所以她不是很想在她的路线中使用过多非常规的小路。经过一些思考，她认为一条好的路线应当形成一个简单环（能够不经过任何草地超过一次的情况下回到起点），其中包含恰好两条非常规的小路。\n\n请帮助 Bessie 计算她可以使用的好的路线的数量。两条路线被认为是相同的，如果它们包含的小路的集合相等。", "inputFormat": "输入的第一行包含 $n$ 和 $m$。以下 $m$ 行每行包含两个整数 $a_i$ 和 $b_i$，描述了一条小路的两端。其中前 $(n−1)$ 条是常规的小路。", "outputFormat": "输出一行一个整数表示 Bessie 可以选择的路线的总数。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq n \\leq 2 \\times 10^5$，$1 \\leq m \\leq 2 \\times 10^5$，$m \\geq n - 1$，$1 \\leq a_i, b_i \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5204", "type": "P", "difficulty": 6, "samples": [["4 2\n999999998\n999999999\n999999998", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "USACO"], "title": "[USACO19JAN] Train Tracking 2 P", "background": "USACO 2019 一月月赛铂金组第三题", "description": "每天特快列车都会经过农场。列车有 $N$ 节车厢（$1 \\le N \\le 10^5$），每节车厢上有一个 $1$ 到 $10^9$ 之间的正整数编号；不同的车厢可能会有相同的编号。\n平时，Bessie 会观察驶过的列车，记录车厢的编号。但是今天雾实在太浓了，Bessie 一个编号也看不见！幸运的是，她从城市里某个可靠的信息源获知了列车编号序列的所有滑动窗口中的最小值。具体地说，她得到了一个正整数 $K$ ，以及 $N-K+1$ 个正整数 $c_1,…,c_{N+1-K}$ ，其中 $c_i$ 是车厢 $i,i+1,…,i+K-1$ 之中编号的最小值。\n\n帮助 Bessie 求出满足所有滑动窗口最小值的对每节车厢进行编号的方法数量。由于这个数字可能非常大，只要你求出这个数字对 $10^9+7$ 取余的结果 Bessie 就满意了。\n\nBessie 的消息是完全可靠的；也就是说，保证存在至少一种符合要求的编号方式。\n", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $K$ 。余下的行包含所有的滑动窗口最小值 $c_1,…,c_{N+1-K}$ ，每行一个数。\n", "outputFormat": "输出一个整数：对每节车厢给予一个不超过 $10^9$ 的正整数编号的方法数量对 $10^9+7$ 取余的结果，满足车厢 $i,i+1,…,i+K-1$ 之中编号的最小值等于 $c_i$，对于 $1 \\le i \\le N - K+1$ 均成立。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19JAN] Train Tracking 2 P", "background": "USACO January 2019 Contest, Platinum Problem 3.", "description": "Every day, an express train passes by the farm. The train has $N$ cars ($1 \\le N \\le 10^5$). Each car has a positive integer label between $1$ and $10^9$; different cars may have the same label.\n\nNormally, Bessie watches the passing train and records the labels on the cars. But today the fog is so thick that Bessie cannot see a single label. Luckily, she learned from a reliable source in the city the minimum values of all sliding windows of the label sequence. Specifically, she is given a positive integer $K$, and $N-K+1$ positive integers $c_1,\\ldots,c_{N+1-K}$, where $c_i$ is the minimum label among cars $i,i+1,\\ldots,i+K-1$.\n\nHelp Bessie find the number of ways to assign labels to all cars such that all the sliding-window minimum values match. Since this number may be very large, output it modulo $10^9+7$.\n\nBessie's information is completely reliable; in other words, it is guaranteed that there exists at least one valid labeling.", "inputFormat": "The first line contains two space-separated integers $N$ and $K$. The remaining lines contain all sliding-window minimum values $c_1,\\ldots,c_{N+1-K}$, one number per line.", "outputFormat": "Output one integer: the number of ways to assign each car a positive integer label not exceeding $10^9$, modulo $10^9+7$, such that the minimum label among cars $i,i+1,\\ldots,i+K-1$ equals $c_i$, for all $1 \\le i \\le N-K+1$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19JAN] Train Tracking 2 P", "background": "USACO 2019 一月月赛铂金组第三题", "description": "每天特快列车都会经过农场。列车有 $N$ 节车厢（$1 \\le N \\le 10^5$），每节车厢上有一个 $1$ 到 $10^9$ 之间的正整数编号；不同的车厢可能会有相同的编号。\n平时，Bessie 会观察驶过的列车，记录车厢的编号。但是今天雾实在太浓了，Bessie 一个编号也看不见！幸运的是，她从城市里某个可靠的信息源获知了列车编号序列的所有滑动窗口中的最小值。具体地说，她得到了一个正整数 $K$ ，以及 $N-K+1$ 个正整数 $c_1,…,c_{N+1-K}$ ，其中 $c_i$ 是车厢 $i,i+1,…,i+K-1$ 之中编号的最小值。\n\n帮助 Bessie 求出满足所有滑动窗口最小值的对每节车厢进行编号的方法数量。由于这个数字可能非常大，只要你求出这个数字对 $10^9+7$ 取余的结果 Bessie 就满意了。\n\nBessie 的消息是完全可靠的；也就是说，保证存在至少一种符合要求的编号方式。\n", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $K$ 。余下的行包含所有的滑动窗口最小值 $c_1,…,c_{N+1-K}$ ，每行一个数。\n", "outputFormat": "输出一个整数：对每节车厢给予一个不超过 $10^9$ 的正整数编号的方法数量对 $10^9+7$ 取余的结果，满足车厢 $i,i+1,…,i+K-1$ 之中编号的最小值等于 $c_i$，对于 $1 \\le i \\le N - K+1$ 均成立。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5205", "type": "P", "difficulty": 6, "samples": [["3\n1 2 1\n", "1 1 0\n"], ["7\n1 8596489 489489 4894 1564 489 35789489  \n", "1 503420421 924499237 13354513 217017417 707895465 411020414\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式开根", "background": "模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 ${} \\bmod x^n$ 意义下的多项式 $B(x)$，使得 $B^2(x) \\equiv A(x) \\pmod{x^n}$。若有多解，请取零次项系数较小的作为答案。\n\n多项式的系数在 ${}\\bmod 998244353$ 的意义下进行运算。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 个整数，依次表示多项式的系数 $a_0, a_1, \\dots, a_{n-1}$。\n\n保证 $a_0 = 1$。", "outputFormat": "输出 $n$ 个整数，表示答案多项式的系数 $b_0, b_1, \\dots, b_{n-1}$。", "hint": "对于 $100 \\%$ 的数据：$1 \\le n \\leq 10^5$，$0 \\le a_i < 998244353$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Polynomial Square Root.", "background": "This is a template problem, with no background.", "description": "Given a polynomial $A(x)$ of degree $n - 1$, find a polynomial $B(x)$ modulo $x^n$ such that $B^2(x) \\equiv A(x) \\pmod{x^n}$. If there are multiple solutions, output the one with the smaller constant-term coefficient.\n\nAll polynomial coefficients are computed modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next line contains $n$ integers, representing the coefficients $a_0, a_1, \\dots, a_{n-1}$ of the polynomial in order.\n\nIt is guaranteed that $a_0 = 1$.", "outputFormat": "Output $n$ integers, representing the coefficients $b_0, b_1, \\dots, b_{n-1}$ of the answer polynomial.", "hint": "For $100\\%$ of the testdata: $1 \\le n \\le 10^5$, $0 \\le a_i < 998244353$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式开根", "background": "模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 ${} \\bmod x^n$ 意义下的多项式 $B(x)$，使得 $B^2(x) \\equiv A(x) \\pmod{x^n}$。若有多解，请取零次项系数较小的作为答案。\n\n多项式的系数在 ${}\\bmod 998244353$ 的意义下进行运算。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 个整数，依次表示多项式的系数 $a_0, a_1, \\dots, a_{n-1}$。\n\n保证 $a_0 = 1$。", "outputFormat": "输出 $n$ 个整数，表示答案多项式的系数 $b_0, b_1, \\dots, b_{n-1}$。", "hint": "对于 $100 \\%$ 的数据：$1 \\le n \\leq 10^5$，$0 \\le a_i < 998244353$。", "locale": "zh-CN"}}}
{"pid": "P5206", "type": "P", "difficulty": 7, "samples": [["3 2 0\n1 2\n2 3\n1 2\n2 3", "2\n"], ["3 2 1\n1 2\n2 3", "10"], ["3 2 2\n", "30\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "树形 DP", "组合数学", "生成函数", "拉格朗日反演", "WC"], "title": "[WC2019] 数树", "background": "白兔喜欢树。\n\n白云喜欢数数。\n\n有 $n$ 只鼠，白兔用 $n - 1$ 根蓝色绳子把它们连成了一棵树，每根蓝色绳子连着两只鼠，白云用 $n - 1$ 根红色绳子把它们连成了一棵树，每根红色绳子连接着两只鼠。\n\n白云要给予每只鼠一个数。这个数可以是 $[1, y]$ 中的任意一个整数。\n\n白兔给了白云一个要求：对于两只鼠 $p, q$，若存在一条连接这两只鼠的路径同时属于这两棵树，则 $p$ 和 $q$ 必须被给予相同的整数。存在一条路径同时属于这两棵树指的是：存在一个序列 $(a_1 = p, a_2, \\cdots , a_m = q)$，使得：对于所有 $i \\in [1, m - 1]$，都有 $a_i$ 和 $a_{i+1}$ 既有一根红色绳子直接相连也有一根蓝色绳子直接相连。\n\n白云想知道，她有多少种给予数的方案呢？\n\n鼠在不停地挣扎，想要摆脱绳子的束缚。白云还没有思考出来，鼠便把红色绳子都咬断了。\n\n白兔有些气恼，但是他还是想要知道答案。他便问白云：对于所有红色绳子的连接方案，答案的总和（即求所有红色绳子连接方案的给予数方案之和）是多少？\n\n鼠在不停地挣扎，想要摆脱绳子的束缚。白云还没有思考出来，鼠便把蓝色绳子也咬断了。\n\n白兔有些气恼，但是他还是想要知道答案。他便问白云：对于所有红色和蓝色绳子的连接方案，答案的总和（即求所有红色和蓝色绳子连接方案的给予数方案之和）是多少？两个方案不同当且仅当存在至少一对鼠，在两种方案中，这两只鼠之间直接连接的绳子不同（两只鼠之间连接绳子的可能性有 4 种：没有绳子直接连接，只有红色绳子直接连接，只有蓝色绳子直接连接，两种颜色的绳子均直接连接）。\n\n白云哭了。", "description": "本题包含三个问题：\n- 问题 0：已知两棵 $n$ 个节点的树的形态（两棵树的节点标号均为 $1$ 至 $n$），其中第一棵树是红树，第二棵树是蓝树。要给予每个节点一个 $[1, y]$ 中的整数，使得对于任意两个节点 $p, q$，如果存在一条路径 $(a_1 = p, a_2, \\cdots , a_m = q)$ 同时属于这两棵树，则 $p, q$ 必须被给予相同的数。求给予数的方案数。\n  - 存在一条路径同时属于这两棵树的定义见「题目背景」。\n- 问题 1：已知蓝树，对于红树的所有 $n^{n-2}$ 种选择方案，求问题 0 的答案之和。\n- 问题 2：对于蓝树的所有 $n^{n-2}$ 种选择方案，求问题 1 的答案之和。\n\n提示：$n$ 个节点的树一共有 $n^{n-2}$ 种。\n\n在不同的测试点中，你将可能需要回答不同的问题。我们将用 $\\text{op}$ 来指代你需要回答的问题编号（对应上述 0、 1、 2）。\n\n由于答案可能很大，因此你只需要输出答案对 $998, 244, 353$ 取模的结果即可。", "inputFormat": "第一行三个用空格隔开的整数 $n, y, \\text{op}$。\n如果 $\\text{op} = 0$，则接下来 $2 \\times (n - 1)$ 行，前 $(n - 1)$ 行每描述一条蓝色绳子，接下来 $(n - 1)$ 行每行描述一条红色绳子。  \n如果 $\\text{op} = 1$，则接下来 $(n - 1)$ 行，每行描述一条蓝色绳子。  \n如果 $\\text{op} = 2$，则接下来没有输入。  \n描述绳子的各行将包含两个用空格隔开的整数，分别表示被这条绳子连接的两只鼠的编号。鼠的编号是从 $1$ 开始的。", "outputFormat": "输出一个整数，表示答案对 $998, 244, 353$ 取模的结果。", "hint": "#### 样例说明 1\n两棵树相同，所以任意两个点都必须被给予相同的数，方案数为 $2$。\n\n#### 样例说明 2\n红树共有三种可能的情况：\n1. 包含绳子 $(1, 2)$（表示连接 $1, 2$ 号鼠的绳子，下同）、$(2, 3)$：此时任意两只鼠都必须被给予相同的数，问题 0 的答案为 $2$。\n2. 包含绳子 $(1, 2)$、$(1, 3)$：此时 $1$ 号鼠和 $2$ 号鼠必须被给予相同的数，问题 0 的答案为 $2 \\times 2 = 4$。\n3. 包含绳子 $(2, 3)$、$(1, 3)$：此时 $2$ 号点和 $3$ 号点必须被给予相同的数，问题 0 的答案为 $2 \\times 2 = 4$。\n\n综上，问题 1 的答案为 $2 + 4 + 4 = 10$。\n\n#### 样例说明 3\n蓝树一共有三种可能的情况。不难发现，对于蓝树的每一种情况，求得的问题 1 的答案都是 $10$。所以答案为 $10 \\times 3 = 30$。\n\n::cute-table{tuack}\n\n| 问题类型 $(\\mathrm{op})$ | 测试点编号 | $n$ | $y$ | 集训队每点分值 | 非集训队每点分值 |\n|:---:|:---:|:---:|:---:|:---:|:---:|\n| **0** | 1 | $\\le 10$ | 无特殊限制 | 2 | 18 |\n| ^ | 2 | $\\le 10^{5}$ | ^ | ^ | 5 |\n| ^ | 3 | ^ | ^ | ^ | ^ |\n| **1** | 4 | $=3$ | ^ | 1 |4 |\n| ^ | 5 | $=5$ | ^ | ^ |^ |\n| ^ | 6 | $\\le 500$ | ^ | 6 | ^ |\n| ^ | 7 | ^ | ^ | ^ | ^ |\n| ^ | 8 | $\\le 5000$ | ^ | ^ |^ |\n| ^ | 9 | ^ | ^ | ^ |^ |\n| ^ | 10 | $\\le 10^{5}$ | $=1$ | 1 |^ |\n| ^ | 11 | ^ | 无特殊限制 | 5 | 2 |\n| ^ | 12 | ^ | ^ | ^ | ^ |\n| ^ | 13 | ^ | ^ | ^ | ^ |\n| ^ | 14 | ^ | ^ | ^ | ^ |\n| **2** | 15 | $=3$ | ^ | 1 | 4 |\n| ^ | 16 | $=10$ | ^ | ^ | ^ |\n| ^ | 17 | $\\le 500$ | ^ | 6 | ^ |\n| ^ | 18 | ^ | ^ | ^ | ^ |\n| ^ | 19 | $\\le 5000$ | ^ | ^ | ^ |\n| ^ | 20 | ^ | ^ | ^ | ^ |\n| ^ | 21 | $\\le 10^{5}$ | $=1$ | 1 | ^ |\n| ^ | 22 | ^ | 无特殊限制 | 5 | 2 |\n| ^ | 23 | ^ | ^ | ^ | ^ |\n| ^ | 24 | ^ | ^ | ^ | ^ |\n| ^ | 25 | ^ | ^ | ^ | ^ |\n\n为了优化你的阅读体验，我们把**测试点编号**放在了表格的中间，请注意这一点。\n\n所有测试点均满足  $3 \\leq n \\leq 10^{5}, 1 \\leq y<998244353, o p \\in\\{0,1,2\\} $ 。\n\n## 洛谷按照集训队分值赋分", "locale": "zh-CN", "translations": {"en": {"title": "[WC2019] Counting Trees", "background": "The white rabbit likes trees.\n\nThe white cloud likes counting.\n\nThere are $n$ mice. The white rabbit uses $n - 1$ blue ropes to connect them into a tree; each blue rope connects two mice. The white cloud uses $n - 1$ red ropes to connect them into a tree; each red rope connects two mice.\n\nThe white cloud wants to assign a number to each mouse. This number can be any integer in $[1, y]$.\n\nThe white rabbit gives the white cloud a requirement: for two mice $p, q$, if there exists a path connecting these two mice that belongs to both trees, then $p$ and $q$ must be assigned the same integer.  \n“Having a path that belongs to both trees” means: there exists a sequence $(a_1 = p, a_2, \\cdots , a_m = q)$ such that for all $i \\in [1, m - 1]$, $a_i$ and $a_{i+1}$ are directly connected by both a red rope and a blue rope.\n\nThe white cloud wants to know: how many different assignment schemes are there?\n\nThe mice keep struggling, trying to break free from the ropes. Before the white cloud can figure it out, the mice bite off all the red ropes.\n\nThe white rabbit is somewhat annoyed, but still wants to know the answer. So he asks the white cloud: over all possible connection schemes of the red ropes, what is the total sum of the answers (that is, sum the number of assignment schemes over all red-rope connection schemes)?\n\nThe mice keep struggling, trying to break free from the ropes. Before the white cloud can figure it out, the mice bite off the blue ropes as well.\n\nThe white rabbit is somewhat annoyed, but still wants to know the answer. So he asks the white cloud: over all possible connection schemes of both the red ropes and the blue ropes, what is the total sum of the answers (that is, sum the number of assignment schemes over all red-rope and blue-rope connection schemes)? Two schemes are different if and only if there exists at least one pair of mice such that the ropes directly connecting these two mice are different in the two schemes (there are 4 possibilities for ropes between two mice: no rope directly connects them, only a red rope directly connects them, only a blue rope directly connects them, and both colors of ropes directly connect them).\n\nThe white cloud cries.", "description": "This problem contains three questions:\n- Question 0: The shapes of two trees with $n$ nodes are given (both trees have nodes labeled from $1$ to $n$). The first tree is the red tree, and the second tree is the blue tree. You need to assign each node an integer in $[1, y]$ such that for any two nodes $p, q$, if there exists a path $(a_1 = p, a_2, \\cdots , a_m = q)$ that belongs to both trees, then $p, q$ must be assigned the same number. Find the number of assignment schemes.\n  - The definition of “there exists a path that belongs to both trees” is the same as in the “Background”.\n- Question 1: The blue tree is given. For all $n^{n-2}$ choices of the red tree, compute the sum of the answers to Question 0.\n- Question 2: For all $n^{n-2}$ choices of the blue tree, compute the sum of the answers to Question 1.\n\nHint: There are $n^{n-2}$ different trees on $n$ nodes.\n\nIn different test points, you may need to answer different questions. We use $\\text{op}$ to denote the index of the question you need to answer (corresponding to 0, 1, 2 above).\n\nSince the answer may be very large, you only need to output it modulo $998, 244, 353$.", "inputFormat": "The first line contains three integers $n, y, \\text{op}$ separated by spaces.  \nIf $\\text{op} = 0$, then the next $2 \\times (n - 1)$ lines follow: the first $(n - 1)$ lines each describe a blue rope, and the next $(n - 1)$ lines each describe a red rope.  \nIf $\\text{op} = 1$, then the next $(n - 1)$ lines follow, each describing a blue rope.  \nIf $\\text{op} = 2$, then there is no further input.  \nEach rope description line contains two integers separated by a space, representing the indices of the two mice connected by this rope. The mice are numbered starting from $1$.", "outputFormat": "Output one integer, representing the answer modulo $998, 244, 353$.", "hint": "#### Sample Explanation 1\nThe two trees are the same, so any two nodes must be assigned the same number. The number of schemes is $2$.\n\n#### Sample Explanation 2\nThere are three possible red trees:\n1. Contains ropes $(1, 2)$ (meaning the rope connecting mice $1$ and $2$, similarly below), $(2, 3)$. Then any two mice must be assigned the same number, so the answer to Question 0 is $2$.\n2. Contains ropes $(1, 2)$, $(1, 3)$. Then mice $1$ and $2$ must be assigned the same number, so the answer to Question 0 is $2 \\times 2 = 4$.\n3. Contains ropes $(2, 3)$, $(1, 3)$. Then node $2$ and node $3$ must be assigned the same number, so the answer to Question 0 is $2 \\times 2 = 4$.\n\nTherefore, the answer to Question 1 is $2 + 4 + 4 = 10$.\n\n#### Sample Explanation 3\nThere are three possible blue trees. It is not hard to see that for each blue tree, the computed answer to Question 1 is $10$. So the answer is $10 \\times 3 = 30$.\n\n::cute-table{tuack}\n\n| Question Type $(\\mathrm{op})$ | Test Point ID | $n$ | $y$ | Points per Test (CTT) | Points per Test (Non-CTT) |\n|:---:|:---:|:---:|:---:|:---:|:---:|\n| **0** | 1 | $\\le 10$ | No special restriction | 2 | 18 |\n| ^ | 2 | $\\le 10^{5}$ | ^ | ^ | 5 |\n| ^ | 3 | ^ | ^ | ^ | ^ |\n| **1** | 4 | $=3$ | ^ | 1 | 4 |\n| ^ | 5 | $=5$ | ^ | ^ | ^ |\n| ^ | 6 | $\\le 500$ | ^ | 6 | ^ |\n| ^ | 7 | ^ | ^ | ^ | ^ |\n| ^ | 8 | $\\le 5000$ | ^ | ^ | ^ |\n| ^ | 9 | ^ | ^ | ^ | ^ |\n| ^ | 10 | $\\le 10^{5}$ | $=1$ | 1 | ^ |\n| ^ | 11 | ^ | No special restriction | 5 | 2 |\n| ^ | 12 | ^ | ^ | ^ | ^ |\n| ^ | 13 | ^ | ^ | ^ | ^ |\n| ^ | 14 | ^ | ^ | ^ | ^ |\n| **2** | 15 | $=3$ | ^ | 1 | 4 |\n| ^ | 16 | $=10$ | ^ | ^ | ^ |\n| ^ | 17 | $\\le 500$ | ^ | 6 | ^ |\n| ^ | 18 | ^ | ^ | ^ | ^ |\n| ^ | 19 | $\\le 5000$ | ^ | ^ | ^ |\n| ^ | 20 | ^ | ^ | ^ | ^ |\n| ^ | 21 | $\\le 10^{5}$ | $=1$ | 1 | ^ |\n| ^ | 22 | ^ | No special restriction | 5 | 2 |\n| ^ | 23 | ^ | ^ | ^ | ^ |\n| ^ | 24 | ^ | ^ | ^ | ^ |\n| ^ | 25 | ^ | ^ | ^ | ^ |\n\nTo optimize your reading experience, we placed the **Test Point ID** in the middle of the table; please pay attention to this.\n\nAll test points satisfy $3 \\leq n \\leq 10^{5}, 1 \\leq y<998244353, o p \\in\\{0,1,2\\} $.\n\n## Luogu scores according to CTT points\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2019] 数树", "background": "白兔喜欢树。\n\n白云喜欢数数。\n\n有 $n$ 只鼠，白兔用 $n - 1$ 根蓝色绳子把它们连成了一棵树，每根蓝色绳子连着两只鼠，白云用 $n - 1$ 根红色绳子把它们连成了一棵树，每根红色绳子连接着两只鼠。\n\n白云要给予每只鼠一个数。这个数可以是 $[1, y]$ 中的任意一个整数。\n\n白兔给了白云一个要求：对于两只鼠 $p, q$，若存在一条连接这两只鼠的路径同时属于这两棵树，则 $p$ 和 $q$ 必须被给予相同的整数。存在一条路径同时属于这两棵树指的是：存在一个序列 $(a_1 = p, a_2, \\cdots , a_m = q)$，使得：对于所有 $i \\in [1, m - 1]$，都有 $a_i$ 和 $a_{i+1}$ 既有一根红色绳子直接相连也有一根蓝色绳子直接相连。\n\n白云想知道，她有多少种给予数的方案呢？\n\n鼠在不停地挣扎，想要摆脱绳子的束缚。白云还没有思考出来，鼠便把红色绳子都咬断了。\n\n白兔有些气恼，但是他还是想要知道答案。他便问白云：对于所有红色绳子的连接方案，答案的总和（即求所有红色绳子连接方案的给予数方案之和）是多少？\n\n鼠在不停地挣扎，想要摆脱绳子的束缚。白云还没有思考出来，鼠便把蓝色绳子也咬断了。\n\n白兔有些气恼，但是他还是想要知道答案。他便问白云：对于所有红色和蓝色绳子的连接方案，答案的总和（即求所有红色和蓝色绳子连接方案的给予数方案之和）是多少？两个方案不同当且仅当存在至少一对鼠，在两种方案中，这两只鼠之间直接连接的绳子不同（两只鼠之间连接绳子的可能性有 4 种：没有绳子直接连接，只有红色绳子直接连接，只有蓝色绳子直接连接，两种颜色的绳子均直接连接）。\n\n白云哭了。", "description": "本题包含三个问题：\n- 问题 0：已知两棵 $n$ 个节点的树的形态（两棵树的节点标号均为 $1$ 至 $n$），其中第一棵树是红树，第二棵树是蓝树。要给予每个节点一个 $[1, y]$ 中的整数，使得对于任意两个节点 $p, q$，如果存在一条路径 $(a_1 = p, a_2, \\cdots , a_m = q)$ 同时属于这两棵树，则 $p, q$ 必须被给予相同的数。求给予数的方案数。\n  - 存在一条路径同时属于这两棵树的定义见「题目背景」。\n- 问题 1：已知蓝树，对于红树的所有 $n^{n-2}$ 种选择方案，求问题 0 的答案之和。\n- 问题 2：对于蓝树的所有 $n^{n-2}$ 种选择方案，求问题 1 的答案之和。\n\n提示：$n$ 个节点的树一共有 $n^{n-2}$ 种。\n\n在不同的测试点中，你将可能需要回答不同的问题。我们将用 $\\text{op}$ 来指代你需要回答的问题编号（对应上述 0、 1、 2）。\n\n由于答案可能很大，因此你只需要输出答案对 $998, 244, 353$ 取模的结果即可。", "inputFormat": "第一行三个用空格隔开的整数 $n, y, \\text{op}$。\n如果 $\\text{op} = 0$，则接下来 $2 \\times (n - 1)$ 行，前 $(n - 1)$ 行每描述一条蓝色绳子，接下来 $(n - 1)$ 行每行描述一条红色绳子。  \n如果 $\\text{op} = 1$，则接下来 $(n - 1)$ 行，每行描述一条蓝色绳子。  \n如果 $\\text{op} = 2$，则接下来没有输入。  \n描述绳子的各行将包含两个用空格隔开的整数，分别表示被这条绳子连接的两只鼠的编号。鼠的编号是从 $1$ 开始的。", "outputFormat": "输出一个整数，表示答案对 $998, 244, 353$ 取模的结果。", "hint": "#### 样例说明 1\n两棵树相同，所以任意两个点都必须被给予相同的数，方案数为 $2$。\n\n#### 样例说明 2\n红树共有三种可能的情况：\n1. 包含绳子 $(1, 2)$（表示连接 $1, 2$ 号鼠的绳子，下同）、$(2, 3)$：此时任意两只鼠都必须被给予相同的数，问题 0 的答案为 $2$。\n2. 包含绳子 $(1, 2)$、$(1, 3)$：此时 $1$ 号鼠和 $2$ 号鼠必须被给予相同的数，问题 0 的答案为 $2 \\times 2 = 4$。\n3. 包含绳子 $(2, 3)$、$(1, 3)$：此时 $2$ 号点和 $3$ 号点必须被给予相同的数，问题 0 的答案为 $2 \\times 2 = 4$。\n\n综上，问题 1 的答案为 $2 + 4 + 4 = 10$。\n\n#### 样例说明 3\n蓝树一共有三种可能的情况。不难发现，对于蓝树的每一种情况，求得的问题 1 的答案都是 $10$。所以答案为 $10 \\times 3 = 30$。\n\n::cute-table{tuack}\n\n| 问题类型 $(\\mathrm{op})$ | 测试点编号 | $n$ | $y$ | 集训队每点分值 | 非集训队每点分值 |\n|:---:|:---:|:---:|:---:|:---:|:---:|\n| **0** | 1 | $\\le 10$ | 无特殊限制 | 2 | 18 |\n| ^ | 2 | $\\le 10^{5}$ | ^ | ^ | 5 |\n| ^ | 3 | ^ | ^ | ^ | ^ |\n| **1** | 4 | $=3$ | ^ | 1 |4 |\n| ^ | 5 | $=5$ | ^ | ^ |^ |\n| ^ | 6 | $\\le 500$ | ^ | 6 | ^ |\n| ^ | 7 | ^ | ^ | ^ | ^ |\n| ^ | 8 | $\\le 5000$ | ^ | ^ |^ |\n| ^ | 9 | ^ | ^ | ^ |^ |\n| ^ | 10 | $\\le 10^{5}$ | $=1$ | 1 |^ |\n| ^ | 11 | ^ | 无特殊限制 | 5 | 2 |\n| ^ | 12 | ^ | ^ | ^ | ^ |\n| ^ | 13 | ^ | ^ | ^ | ^ |\n| ^ | 14 | ^ | ^ | ^ | ^ |\n| **2** | 15 | $=3$ | ^ | 1 | 4 |\n| ^ | 16 | $=10$ | ^ | ^ | ^ |\n| ^ | 17 | $\\le 500$ | ^ | 6 | ^ |\n| ^ | 18 | ^ | ^ | ^ | ^ |\n| ^ | 19 | $\\le 5000$ | ^ | ^ | ^ |\n| ^ | 20 | ^ | ^ | ^ | ^ |\n| ^ | 21 | $\\le 10^{5}$ | $=1$ | 1 | ^ |\n| ^ | 22 | ^ | 无特殊限制 | 5 | 2 |\n| ^ | 23 | ^ | ^ | ^ | ^ |\n| ^ | 24 | ^ | ^ | ^ | ^ |\n| ^ | 25 | ^ | ^ | ^ | ^ |\n\n为了优化你的阅读体验，我们把**测试点编号**放在了表格的中间，请注意这一点。\n\n所有测试点均满足  $3 \\leq n \\leq 10^{5}, 1 \\leq y<998244353, o p \\in\\{0,1,2\\} $ 。\n\n## 洛谷按照集训队分值赋分", "locale": "zh-CN"}}}
{"pid": "P5207", "type": "P", "difficulty": 6, "samples": [], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["2019", "提交答案", "Special Judge", "WC"], "title": "[WC2019] 远古计算机", "background": "企鹅大陆是一片神奇的土地，在厚厚的冰层下埋藏着一个巨大的宝藏。探险家企鹅豆豆挖穿冰层到达了宝库，但他发现了一个令人发愁的问题。一共有五座宝库，每个宝库是由某些远古计算机控制的。由于年代久远，这些计算机里的程序已经消失不见了，只有给这些计算机重新填写代码并且顺利运行，输出了正确结果才能触发开门的机关。", "description": "每一个宝库大门由一个计算机集群控制，计算机之间用数据线相连以便传输数据。但是有很多数据线已经损坏了，所以只留下了一部分连线。一开始数据线上没有数据，当一台计算机向数据线上写入时，数据线上就有了一个整数。每条数据线上最多可以同时传输一个整数，当整数被读取后便会消失，数据线就又回到没有数据的状态。\n\n每台远古计算机有两个储存单元，分别名为 $a$ 和 $b$，每个储存单元能够储存一个 $-2147483648$ 到 $2147483647$ 之间的整数。\n\n每个时刻，每台远古计算机可以执行一条指令，一共有以下几种指令：\n- `mov reg val`：将储存单元 `reg` 的值赋值为 `val` 的值；\n- `add reg val`：给储存单元 `reg` 加上 `val` 的值；\n- `dec reg val`：给储存单元 `reg` 减去 `val` 的值；\n- `mul reg val`：给储存单元 `reg` 乘以 `val` 的值；\n- `div reg val`：给储存单元 `reg` 除以 `val` 的值，这里的除法是向零取整的除法，如 $\\frac{-5}{2} = -2$；\n- `and reg val`：给储存单元 `reg` 二进制与上 `val` 的值；\n- `or reg val`：给储存单元 `reg` 二进制或上 `val` 的值；\n- `xor reg val`：给储存单元 `reg` 二进制异或上 `val` 的值；\n- `jmp val` 跳转到整个程序第 `val` 条语句，语句从程序开头开始，用从 $1$ 开始的正整数计数；\n- `jz reg val`：如果 `reg` 的值为 $0$，那么跳转到第 `val` 行；\n- `jnz reg val`：如果 `reg` 的值不为 $0$，那么跳转到第 `val` 行；\n- `jgz reg val`：如果 `reg` 的值严格大于 $0$，那么跳转到第 `val` 行；\n- `jsz reg val`：如果 `reg` 的值严格小于 $0$，那么跳转到第 `val` 行；\n- `read x reg`：从远古计算机 $x$ 读取一个数到储存单元 `reg` 当中，如果数据线上缓存了一个数字，将读取这个数字并返回，否则等待下个周期再次尝试读取。$x = 0$ 时视为从标准输入数据读取一个数；\n- `write val x`：将 `val` 的数值向远古计算机 $x$ 方向所在数据线写入，当且仅当数据线上没有存有数据才会成功写入，否则等待下个周期再次尝试写入。$x = 0$ 时视为向标准输出数据写出一个数。\n\n`reg` 表示一个储存单元，只能为 $a$ 或者 $b$ 之一。\n\n`val` 表示一个储存单元或者一个数字的值，比如填入 $a$ 表示 $a$ 中储存的值或者填入 $233$ 表示 $233$ 这个数字。\n\n一台远古计算机读写指令中 $x$ 只有与当前远古计算机直接有数据线相连，或者 $x=0$ 才被视为合法指令。\n\n每台远古计算机的标准输入输出独立，远古计算机之间互不影响，即每台远古计算机都有独立的一个标准输入端和一个标准输出端。\n\n每个周期计算时，所有需要执行 `write` 指令的远古计算机先计算，然后需要执行 `read` 指令的远古计算机再计算，需要执行其余指令的远古计算机最后计算。\n\n在读取时，如果标准输入数据没有任何可以继续读取的数据，该远古计算机将进入永远等待状态。\n\n一台远古计算机如果执行完了最后一条指令，将会重新从第一条指令开始执行。\n\n如果一台远古计算机没有任何指令，该计算机将永远处于等待状态。\n\n指令计数是从 $1$ 开始的正整数。\n\n一条数据线上最多只能暂存一个数据，两台计算机之间只有一条数据线，即可能读取自己上一轮写入的数据，如果两端的远古计算机同时读取或写入同一条数据线上的\n数据，结果将不可预知。\n\n不存在写入标准输入的方法或是从标准输出当中读取数据的方法。\n\n比如如下样例是从 $1$ 号计算机的标准输入读入两个数，并从 $2$ 号计算机的标准输出输出两个数之和。\n\n```plain\nnode 1\nread 0 a\nread 0 b\nwrite a 2\nwrite b 2\nnode 2\nread 1 a\nread 1 b\nadd a b\nwrite a 0\n```\n\n而以下写法是错误的\n\n```plain\nnode 1\nread 0 a\nread 0 b\nadd a b\nwrite a 0\nnode 2\nmov a a\n```\n\n因为正确答案中，一号远古计算机的标准输出为空，而二号远古计算机的标准输出才是两个数之和。\n\n#### 子任务\n\n##### 子任务 1\n$1$ 号远古计算机的标准输入将会有不超过 $100$ 个非负整数，按照原顺序输出到 $1$ 号远古计算机的输出当中。\n\n##### 子任务 2\n$1$ 号远古计算机一个非负整数 $k$，按照原输入顺序将斐波那契数列第 $k$ 项输出到 $1$ 号点的标准输出当中，输入数据保证第 $k$ 项不超过 $10^9$。斐波那契数列通项公式为 $F_0 = 0, F_1 = 1, F_n = F_{n-1} + F_{n-2}(2 \\le n)$。\n\n##### 子任务 3\n$1$ 号远古计算机的标准输入将会有不超过 $100$ 个非负整数，按照原顺序输出到 $n$ 号远古计算机的输出当中。\n\n##### 子任务 4\n第 $1$ 到 $50$ 号远古计算机分别输入 $1$ 个数，将这 $50$ 个数从 $51$ 到 $100$ 号远古计算机输出，输出顺序任意，每个远古计算机输出数字个数任意。\n\n##### 子任务 5\n第 $1$ 到 $10$ 号远古计算机各输入 $1$ 个数，将这些数对应从 $100$ 到 $91$ 号远古计算机输出，即 $i$ 号点输入的数需要从 $101 - i$ 号点输出。", "inputFormat": "这是一道提交答案题，共有 $5$ 组输入数据，这些数据命名为 `oldcomputer1.in` ~ `oldcomputer5.in`。\n\n这些文件描述了远古计算机之间的连线状态。\n\n文件的第一行是三个非负整数 $x,n$ 和 $m$，表示测试点编号、远古计算机的个数与他们之间的连线条数，远古计算机是从 $1$ 到 $n$ 标号的。\n\n接下来 $m$ 行，每行两个正整数 $x, y$，表示计算机 $x$ 和计算机 $y$ 之间通过数据线直接相连。", "outputFormat": "对于每组输入数据，你需要提交相应的输出文件 `oldcomputer1.out` ~ `oldcomputer5.out`。\n\n这些文件描述了每台远古计算机的代码内容。\n\n文件由多个代码块组成，每个代码块的具体格式如下：\n\n第一行为一个字符串 `node` 与一个 $1$ 到 $n$ 之间的整数 $a$，由一个空格隔开，表示接下来是计算机 $a$ 的指令。\n\n接下来多行为该计算机的具体指令内容。\n\n每台计算机的指令应当最多出现一次，否则将会出现未知错误。\n\n所有计算机的指令总条数应当不超过 $10^6$ 行。", "hint": "#### 评分方式\n对于每个测试点，有三个参数 $a_1, a_2, a_3$。\n\n如果选手提交的代码在 $a_1$ 个周期内正确输出了答案，将会得到该测试点 $100\\%$ 的分。  \n如果选手提交的代码在 $a_2$ 个周期内正确输出了答案，将会得到该测试点 $60\\%$ 的分。  \n如果选手提交的代码在 $a_3$ 个周期内正确输出了答案，将会得到该测试点 $30\\%$ 的分。\n\n即在每个周期结束时，会分别进行一次答案正确性判断，以最早正确的一次为准。\n\n#### 子任务分值\n|  子任务编号  | $1$  | $2$  | $3$  | $4$  | $5$  |\n| :----------: | :--: | :--: | :--: | :--: | :--: |\n|  集训队分值  | $10$ | $15$ | $15$ | $30$ | $30$ |\n| 非集训队分值 | $20$ | $20$ | $20$ | $20$ | $20$ |\n\n#### 提示\n\n感谢 @tiger2005 提供 spj。关于 spj 的使用方法，请参考这两个讨论贴：\n- [Tester finished.\n](https://www.luogu.com.cn/discuss/show/245001)\n- [Checker finished.](https://www.luogu.com.cn/discuss/show/245044)", "locale": "zh-CN", "translations": {"en": {"title": "[WC2019] Ancient Computer", "background": "Penguin Continent is a magical land. Beneath the thick ice lies a huge treasure. The explorer penguin Doudou dug through the ice and reached the treasury, but then he found a troubling problem. There are five vaults in total, and each vault is controlled by some ancient computers. Because they are so old, the programs inside these computers have already disappeared. Only by rewriting code for these computers, running it successfully, and producing the correct output can the door-opening mechanism be triggered.", "description": "Each vault gate is controlled by a computer cluster. The computers are connected by data cables to transmit data. However, many cables are broken, so only some connections remain. At the beginning, there is no data on any cable. When a computer writes to a cable, there will be an integer on that cable. Each cable can transmit at most one integer at the same time. After the integer is read, it disappears and the cable returns to the no-data state.\n\nEach ancient computer has two storage cells, named $a$ and $b$. Each cell can store an integer from $-2147483648$ to $2147483647$.\n\nAt each moment, each ancient computer can execute one instruction. The instruction types are as follows:\n\n- `mov reg val`: set the value of storage cell `reg` to the value of `val`;\n- `add reg val`: add the value of `val` to storage cell `reg`;\n- `dec reg val`: subtract the value of `val` from storage cell `reg`;\n- `mul reg val`: multiply storage cell `reg` by the value of `val`;\n- `div reg val`: divide storage cell `reg` by the value of `val`; this division is truncation toward zero, e.g. $\\frac{-5}{2} = -2$;\n- `and reg val`: bitwise AND storage cell `reg` with the value of `val`;\n- `or reg val`: bitwise OR storage cell `reg` with the value of `val`;\n- `xor reg val`: bitwise XOR storage cell `reg` with the value of `val`;\n- `jmp val`: jump to the `val`-th statement of the whole program. Statements are counted from the beginning of the program starting at $1$;\n- `jz reg val`: if the value of `reg` is $0$, jump to line `val`;\n- `jnz reg val`: if the value of `reg` is not $0$, jump to line `val`;\n- `jgz reg val`: if the value of `reg` is strictly greater than $0$, jump to line `val`;\n- `jsz reg val`: if the value of `reg` is strictly less than $0$, jump to line `val`;\n- `read x reg`: read a number from ancient computer $x$ into storage cell `reg`. If there is a cached number on the cable, read it and return; otherwise, wait and try again in the next cycle. When $x = 0$, it is considered reading one number from standard input;\n- `write val x`: write the value of `val` onto the cable in the direction of ancient computer $x$. This succeeds if and only if there is no data currently stored on the cable; otherwise, wait and try again in the next cycle. When $x = 0$, it is considered writing one number to standard output.\n\n`reg` denotes a storage cell, and can only be $a$ or $b$.\n\n`val` denotes the value of a storage cell or a number. For example, writing $a$ means the value stored in $a$, and writing $233$ means the number $233$.\n\nIn the read/write instructions of an ancient computer, $x$ is considered a valid instruction only if $x$ is directly connected to the current ancient computer by a data cable, or $x = 0$.\n\nEach ancient computer has independent standard input and standard output. Different ancient computers do not affect each other. That is, each ancient computer has its own independent standard input port and standard output port.\n\nIn each cycle, all ancient computers that need to execute `write` instructions are processed first, then those that need to execute `read` instructions, and finally those that need to execute other instructions.\n\nWhen reading, if there is no more data available from standard input, the ancient computer will enter an eternal waiting state.\n\nIf an ancient computer finishes executing the last instruction, it will restart from the first instruction.\n\nIf an ancient computer has no instructions at all, it will stay in an eternal waiting state.\n\nInstruction indices are positive integers starting from $1$.\n\nEach data cable can buffer at most one piece of data. Between two computers there is only one data cable, so it is possible to read the data written by itself in the previous round. If the two endpoint ancient computers read from or write to the same cable at the same time, the result will be unpredictable.\n\nThere is no way to write to standard input, and there is no way to read from standard output.\n\nFor example, the following sample reads two numbers from the standard input of computer $1$, and outputs the sum of the two numbers to the standard output of computer $2$.\n\n```plain\nnode 1\nread 0 a\nread 0 b\nwrite a 2\nwrite b 2\nnode 2\nread 1 a\nread 1 b\nadd a b\nwrite a 0\n```\n\nThe following is incorrect:\n\n```plain\nnode 1\nread 0 a\nread 0 b\nadd a b\nwrite a 0\nnode 2\nmov a a\n```\n\nBecause in the correct answer, the standard output of ancient computer $1$ is empty, while the standard output of ancient computer $2$ is the sum of the two numbers.\n\n#### Subtasks\n\n##### Subtask 1\n\nThe standard input of ancient computer $1$ will contain no more than $100$ non-negative integers. Output them in the original order to the output of ancient computer $1$.\n\n##### Subtask 2\n\nAncient computer $1$ will receive one non-negative integer $k$. Output the $k$-th term of the Fibonacci sequence to the standard output of node $1$ in the original input order. The input guarantees that the $k$-th term is at most $10^9$. The Fibonacci sequence is defined as $F_0 = 0, F_1 = 1, F_n = F_{n-1} + F_{n-2}(2 \\le n)$.\n\n##### Subtask 3\n\nThe standard input of ancient computer $1$ will contain no more than $100$ non-negative integers. Output them in the original order to the output of ancient computer $n$.\n\n##### Subtask 4\n\nAncient computers $1$ to $50$ each input one number. Output these $50$ numbers from ancient computers $51$ to $100$. The output order is arbitrary, and each ancient computer may output any number of values.\n\n##### Subtask 5\n\nAncient computers $1$ to $10$ each input one number. Output these numbers correspondingly from ancient computers $100$ to $91$. That is, the number input at node $i$ must be output from node $101 - i$.", "inputFormat": "This is an output-only problem. There are $5$ groups of input data, named `oldcomputer1.in` to `oldcomputer5.in`.\n\nThese files describe the connection status between the ancient computers.\n\nThe first line of the file contains three non-negative integers $x, n$ and $m$, representing the test point ID, the number of ancient computers, and the number of cables between them. The ancient computers are numbered from $1$ to $n$.\n\nThe next $m$ lines each contain two positive integers $x, y$, indicating that computer $x$ and computer $y$ are directly connected by a data cable.", "outputFormat": "For each group of input data, you need to submit the corresponding output file `oldcomputer1.out` to `oldcomputer5.out`.\n\nThese files describe the code content for each ancient computer.\n\nA file consists of multiple code blocks. The format of each code block is as follows:\n\nThe first line contains a string `node` and an integer $a$ between $1$ and $n$, separated by a space, indicating that the following instructions belong to computer $a$.\n\nThe following lines are the specific instructions of that computer.\n\nEach computer's instruction block should appear at most once; otherwise, unknown errors may occur.\n\nThe total number of instruction lines for all computers must not exceed $10^6$.", "hint": "#### Scoring\n\nFor each test point, there are three parameters $a_1, a_2, a_3$.\n\nIf the submitted code outputs the correct answer within $a_1$ cycles, you will get $100\\%$ of the score for that test point.  \nIf the submitted code outputs the correct answer within $a_2$ cycles, you will get $60\\%$ of the score for that test point.  \nIf the submitted code outputs the correct answer within $a_3$ cycles, you will get $30\\%$ of the score for that test point.\n\nThat is, at the end of each cycle, the answer will be checked once, and the earliest correct check result will be used.\n\n#### Subtask Scores\n\n| Subtask ID | $1$  | $2$  | $3$  | $4$  | $5$  |\n| :--------: | :--: | :--: | :--: | :--: | :--: |\n| CTT score  | $10$ | $15$ | $15$ | $30$ | $30$ |\n| Non-CTT score | $20$ | $20$ | $20$ | $20$ | $20$ |\n\n#### Notes\n\nThanks to @tiger2005 for providing the spj. For how to use the spj, please refer to these two discussion posts:\n- [Tester finished.\n](https://www.luogu.com.cn/discuss/show/245001)\n- [Checker finished.](https://www.luogu.com.cn/discuss/show/245044).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2019] 远古计算机", "background": "企鹅大陆是一片神奇的土地，在厚厚的冰层下埋藏着一个巨大的宝藏。探险家企鹅豆豆挖穿冰层到达了宝库，但他发现了一个令人发愁的问题。一共有五座宝库，每个宝库是由某些远古计算机控制的。由于年代久远，这些计算机里的程序已经消失不见了，只有给这些计算机重新填写代码并且顺利运行，输出了正确结果才能触发开门的机关。", "description": "每一个宝库大门由一个计算机集群控制，计算机之间用数据线相连以便传输数据。但是有很多数据线已经损坏了，所以只留下了一部分连线。一开始数据线上没有数据，当一台计算机向数据线上写入时，数据线上就有了一个整数。每条数据线上最多可以同时传输一个整数，当整数被读取后便会消失，数据线就又回到没有数据的状态。\n\n每台远古计算机有两个储存单元，分别名为 $a$ 和 $b$，每个储存单元能够储存一个 $-2147483648$ 到 $2147483647$ 之间的整数。\n\n每个时刻，每台远古计算机可以执行一条指令，一共有以下几种指令：\n- `mov reg val`：将储存单元 `reg` 的值赋值为 `val` 的值；\n- `add reg val`：给储存单元 `reg` 加上 `val` 的值；\n- `dec reg val`：给储存单元 `reg` 减去 `val` 的值；\n- `mul reg val`：给储存单元 `reg` 乘以 `val` 的值；\n- `div reg val`：给储存单元 `reg` 除以 `val` 的值，这里的除法是向零取整的除法，如 $\\frac{-5}{2} = -2$；\n- `and reg val`：给储存单元 `reg` 二进制与上 `val` 的值；\n- `or reg val`：给储存单元 `reg` 二进制或上 `val` 的值；\n- `xor reg val`：给储存单元 `reg` 二进制异或上 `val` 的值；\n- `jmp val` 跳转到整个程序第 `val` 条语句，语句从程序开头开始，用从 $1$ 开始的正整数计数；\n- `jz reg val`：如果 `reg` 的值为 $0$，那么跳转到第 `val` 行；\n- `jnz reg val`：如果 `reg` 的值不为 $0$，那么跳转到第 `val` 行；\n- `jgz reg val`：如果 `reg` 的值严格大于 $0$，那么跳转到第 `val` 行；\n- `jsz reg val`：如果 `reg` 的值严格小于 $0$，那么跳转到第 `val` 行；\n- `read x reg`：从远古计算机 $x$ 读取一个数到储存单元 `reg` 当中，如果数据线上缓存了一个数字，将读取这个数字并返回，否则等待下个周期再次尝试读取。$x = 0$ 时视为从标准输入数据读取一个数；\n- `write val x`：将 `val` 的数值向远古计算机 $x$ 方向所在数据线写入，当且仅当数据线上没有存有数据才会成功写入，否则等待下个周期再次尝试写入。$x = 0$ 时视为向标准输出数据写出一个数。\n\n`reg` 表示一个储存单元，只能为 $a$ 或者 $b$ 之一。\n\n`val` 表示一个储存单元或者一个数字的值，比如填入 $a$ 表示 $a$ 中储存的值或者填入 $233$ 表示 $233$ 这个数字。\n\n一台远古计算机读写指令中 $x$ 只有与当前远古计算机直接有数据线相连，或者 $x=0$ 才被视为合法指令。\n\n每台远古计算机的标准输入输出独立，远古计算机之间互不影响，即每台远古计算机都有独立的一个标准输入端和一个标准输出端。\n\n每个周期计算时，所有需要执行 `write` 指令的远古计算机先计算，然后需要执行 `read` 指令的远古计算机再计算，需要执行其余指令的远古计算机最后计算。\n\n在读取时，如果标准输入数据没有任何可以继续读取的数据，该远古计算机将进入永远等待状态。\n\n一台远古计算机如果执行完了最后一条指令，将会重新从第一条指令开始执行。\n\n如果一台远古计算机没有任何指令，该计算机将永远处于等待状态。\n\n指令计数是从 $1$ 开始的正整数。\n\n一条数据线上最多只能暂存一个数据，两台计算机之间只有一条数据线，即可能读取自己上一轮写入的数据，如果两端的远古计算机同时读取或写入同一条数据线上的\n数据，结果将不可预知。\n\n不存在写入标准输入的方法或是从标准输出当中读取数据的方法。\n\n比如如下样例是从 $1$ 号计算机的标准输入读入两个数，并从 $2$ 号计算机的标准输出输出两个数之和。\n\n```plain\nnode 1\nread 0 a\nread 0 b\nwrite a 2\nwrite b 2\nnode 2\nread 1 a\nread 1 b\nadd a b\nwrite a 0\n```\n\n而以下写法是错误的\n\n```plain\nnode 1\nread 0 a\nread 0 b\nadd a b\nwrite a 0\nnode 2\nmov a a\n```\n\n因为正确答案中，一号远古计算机的标准输出为空，而二号远古计算机的标准输出才是两个数之和。\n\n#### 子任务\n\n##### 子任务 1\n$1$ 号远古计算机的标准输入将会有不超过 $100$ 个非负整数，按照原顺序输出到 $1$ 号远古计算机的输出当中。\n\n##### 子任务 2\n$1$ 号远古计算机一个非负整数 $k$，按照原输入顺序将斐波那契数列第 $k$ 项输出到 $1$ 号点的标准输出当中，输入数据保证第 $k$ 项不超过 $10^9$。斐波那契数列通项公式为 $F_0 = 0, F_1 = 1, F_n = F_{n-1} + F_{n-2}(2 \\le n)$。\n\n##### 子任务 3\n$1$ 号远古计算机的标准输入将会有不超过 $100$ 个非负整数，按照原顺序输出到 $n$ 号远古计算机的输出当中。\n\n##### 子任务 4\n第 $1$ 到 $50$ 号远古计算机分别输入 $1$ 个数，将这 $50$ 个数从 $51$ 到 $100$ 号远古计算机输出，输出顺序任意，每个远古计算机输出数字个数任意。\n\n##### 子任务 5\n第 $1$ 到 $10$ 号远古计算机各输入 $1$ 个数，将这些数对应从 $100$ 到 $91$ 号远古计算机输出，即 $i$ 号点输入的数需要从 $101 - i$ 号点输出。", "inputFormat": "这是一道提交答案题，共有 $5$ 组输入数据，这些数据命名为 `oldcomputer1.in` ~ `oldcomputer5.in`。\n\n这些文件描述了远古计算机之间的连线状态。\n\n文件的第一行是三个非负整数 $x,n$ 和 $m$，表示测试点编号、远古计算机的个数与他们之间的连线条数，远古计算机是从 $1$ 到 $n$ 标号的。\n\n接下来 $m$ 行，每行两个正整数 $x, y$，表示计算机 $x$ 和计算机 $y$ 之间通过数据线直接相连。", "outputFormat": "对于每组输入数据，你需要提交相应的输出文件 `oldcomputer1.out` ~ `oldcomputer5.out`。\n\n这些文件描述了每台远古计算机的代码内容。\n\n文件由多个代码块组成，每个代码块的具体格式如下：\n\n第一行为一个字符串 `node` 与一个 $1$ 到 $n$ 之间的整数 $a$，由一个空格隔开，表示接下来是计算机 $a$ 的指令。\n\n接下来多行为该计算机的具体指令内容。\n\n每台计算机的指令应当最多出现一次，否则将会出现未知错误。\n\n所有计算机的指令总条数应当不超过 $10^6$ 行。", "hint": "#### 评分方式\n对于每个测试点，有三个参数 $a_1, a_2, a_3$。\n\n如果选手提交的代码在 $a_1$ 个周期内正确输出了答案，将会得到该测试点 $100\\%$ 的分。  \n如果选手提交的代码在 $a_2$ 个周期内正确输出了答案，将会得到该测试点 $60\\%$ 的分。  \n如果选手提交的代码在 $a_3$ 个周期内正确输出了答案，将会得到该测试点 $30\\%$ 的分。\n\n即在每个周期结束时，会分别进行一次答案正确性判断，以最早正确的一次为准。\n\n#### 子任务分值\n|  子任务编号  | $1$  | $2$  | $3$  | $4$  | $5$  |\n| :----------: | :--: | :--: | :--: | :--: | :--: |\n|  集训队分值  | $10$ | $15$ | $15$ | $30$ | $30$ |\n| 非集训队分值 | $20$ | $20$ | $20$ | $20$ | $20$ |\n\n#### 提示\n\n感谢 @tiger2005 提供 spj。关于 spj 的使用方法，请参考这两个讨论贴：\n- [Tester finished.\n](https://www.luogu.com.cn/discuss/show/245001)\n- [Checker finished.](https://www.luogu.com.cn/discuss/show/245044)", "locale": "zh-CN"}}}
{"pid": "P5208", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "交互题", "Special Judge", "O2优化", "WC"], "title": "[WC2019] I 君的商店", "background": "### 特别提示\n\n**在洛谷提交本题时的一些注意事项（与原题面不同之处请以此处为准）：**\n\n1. 与原题不同的是，你不需要，也不应该在程序开头包含 `shop.h` 头文件。\n2. 提交时，请在程序中加入以下函数声明语句：\n\n```cpp\nint query(int *S, int nS, int *T, int nT);\n```\n\n3. 仅支持 `C++`（含 `C++`，`C++11`，`C++14`，`C++17`）提交。", "description": "V 君、I 君和 Y 君是好朋友。\n\nI 君最近开了一家商店，商店里准备了 $N$ 种物品（编号为 $0 \\sim N - 1$ 中的整数），每种物品均有无限个可供出售，每种物品的单价是 $0$ 或者 $1$。\n\nV 君想知道每个物品的价格，他已经通过某种超自然力量知道，这 $N$ 个物品里，价格是 $1$ 的物品恰好有奇数/偶数个，且**至少存在一个物品的价格是 $1$**。\n\n然而， V 君并不想自己去问 I 君，他选择了这样一种方法：他准备了 $+\\infty$ 的钱给 Y 君。然后让 Y 君帮他跑腿：每一次，他会给 Y 君指定两个非空物品**集合** $S, T$（同一个集合内的物品必须两两不同，即每种物品在每个集合类最多包含一个），Y 君会跑到商店，分别买下这两个集合的物品，把他们送回来，并告诉 V 君哪个集合的物品价格之和更高。但是，当**两集合价格之和相等**的时候，Y 君会按照 I 君的指示来回答 V 君。\n\n带着很多物品跑腿是一个很累的事情，因此，我们定义一次跑腿的体力消耗是 $\\texttt{S} + \\texttt{T}$。其中，$\\texttt{S}$ 表示集合 $S$ 包含的物品个数。\n\n你的任务是：写一个程序，帮助 V 君决定如何合理地让 Y 君跑腿，从而推算出每种物品的价值。Y 君的体力有限，你当然不能让他过于劳 累，也即，你不能让他的总体力消耗超过某个预设的阈值 $M$。\n\n#### 实现细节\n你不需要，也不应该实现主函数，你只需要实现下列函数：\n- `find_price(task_id, N, K, ans)`\n- 其中 `task_id` 表示子任务编号（见限制与约定）。$N$ 表示物品个数，$K$ 的意义为：\n  - 若 $K = 0$，表示有偶数个物品价值为 $1$；\n  - 若 $K = 1$，表示有奇数个物品价值为 $1$。\n- 你需要将计算出的物品价格放在数组 $\\text{ans}[]$ 中，其中 $\\text{ans[i]}$ 表示编号为 $i$ 的物品的价格。\n\n你可以通过调用如下函数来向交互库发出询问：\n- `query(S, nS, T, nT)`\n- 这里 $\\text{nS} = \\texttt{S}, \\text{nT} = \\texttt{T}$, 数组 $\\text{S [0\\ldots (nS - 1)]}$ 和数组 $\\text{T[0\\ldots (nT - 1)]}$ 分别描述两个集合，你需要保证：\n  - $\\text{nS, nT} > 0$；\n  - $\\forall 0 \\le i < \\text{nS} , 0 \\le \\text{S[i]} < N$；\n  - $\\forall 0 \\le i < \\text{nT} , 0 \\le \\text{T[i]} < N$；  \n$\\forall$ 的意思是：「对于任意的」。例如：$\\forall 0 \\le i < \\text{nS} , 0 \\le \\text{S[i]} < N$ 的意思是：「对于任意的在 $[0, \\text{nS})$ 内的 $i$，$\\text{S[i]}$ 在 $[0, N)$ 内」。\n- 调用此函数一次的时间复杂度为 $\\Theta(\\text{nS + nT})$。它的返回值为 $0$ 或 $1$，返回值的意义为：\n  - 若集合 $S$ 的物品价格和更大，返回 $0$；\n  - 若集合 $T$ 的物品价格和更大，返回 $1$；\n  - 否则，按照某种未知规则返回 $0$ 或 $1$。\n- 如题面所述，我们定义这样一次调用的代价为 $\\text{nS + nT}$。\n\n评测时，交互库可能会调用 `find_price` 多次（不超过 $10$ 次），每次调用代表一次新的猜价格游戏，所有的物品的价格都会被重新设定。", "inputFormat": "可执行文件将从标准输入读入以下格式的数据：\n\n第一行一个整数 $T ( T \\le 100 )$，表示数据组数。对每组数据：\n- 第一行包含两个整数 $\\texttt{task\\_id}, N$；\n- 接下来一行一个长度为 $N$ 的 $01$ 串 $s$，其中 $s_i$ 表示物品 $i$ 的价格。你需要保证至少有一个物品价格为 $1$。\n\n读入完成之后，交互库将调用 $T$ 次 `find_price` 函数。\n\n接下来交互库会判断你的函数每次计算是否正确，若全部正确则会输出 `Correct`，否则会输出相应的错误信息。", "outputFormat": "", "hint": "#### 评分标准\n\n题目首先会受到和非交互式程序题相同的限制。例如编译错误会导致整道题目得 $0$ 分，运行时错误、超过时间限制、超过空间限制等会导致相应测试点得 $0$ 分等。你只能访问自己定义的和交互库给出的变量及其对应的内存空间，尝试访问其他空间将可能导致编译错误或运行错误。\n\n在上述条件基础上，在一个测试点中，你得到满分，当且仅当**每一次** `find_price` 的调用中：\n- 你的每一个 `query` 的调用符合规则，且调用代价之和不超过 $M$；\n- 你的函数正确计算了 $\\text{ans[]}$ 数组。\n\n在一个测试点中，如果你没有获得满分，那么你获得 $0$ 分。\n\n#### 子任务\n我们令代价之和的上界为 $M$，记答案数组为 $\\text{ans[]}$：\n- 子任务 1：$N \\le 5, M = 100$；\n- 子任务 2：$N \\le 10^3, M = 10^6$；\n- 子任务 3：$N \\le 10^5, M = 100$，保证 $\\forall i < j < k$，若 $\\text{ans[i]} = \\text{ans[k]}$ 则必有 $\\text{ans[j]} = \\text{ans[i]}$。\n- 子任务 4：$N \\le 10^4, M = 2 \\times 10^5$；\n- 子任务 5：$N \\le 5 \\times 10^4, M = 350100$；\n- 子任务 6：$N \\le 10^5, M = 500100$。\n\n#### 提示\n**I 君可能并不愿意让 V 君知道每件物品的价格，在物品价格相等时，他会按照他自己的某种方式来回答问题。**\n\n#### 子任务分值\n在本场比赛中，测试点（或子任务）的分值分布与你是否为集训队选手有关。本题的分值设置如下：\n\n| 子任务编号   | 1    | 2    | 3    | 4    | 5    | 6    |\n| :------------: | :----: | :----: | :----: | :----: | :----: | :----: |\n| 集训队分值   | $20$ | $11$ | $9$  | $12$ | $17$ | $31$ |\n| 非集训队分值 | $31$ | $21$ | $13$ | $9$  | $11$ | $15$ |\n\n**洛谷评测时采用集训队分值计算分数**。", "locale": "zh-CN", "translations": {"en": {"title": "[WC2019] Mr. I’s Shop.", "background": "### Special Notice.\n\n**Some notes when submitting this problem on Luogu (if it differs from the original statement, please follow what is written here):**\n\n1. Different from the original problem, you do not need, and should not, include the `shop.h` header file at the beginning of your program.\n2. When submitting, please add the following function declaration in your program:\n\n```cpp\nint query(int *S, int nS, int *T, int nT);\n```\n\n3. Only `C++` (including `C++`, `C++11`, `C++14`, `C++17`) submissions are supported.", "description": "Mr. V, Mr. I, and Mr. Y are good friends.\n\nMr. I recently opened a shop. The shop has $N$ kinds of items (with IDs being integers from $0 \\sim N - 1$). Each kind of item has an unlimited supply. The unit price of each item is either $0$ or $1$.\n\nMr. V wants to know the price of every item. Through some supernatural power, he already knows that among these $N$ items, the number of items priced at $1$ is exactly odd/even, and **there is at least one item whose price is $1$**.\n\nHowever, Mr. V does not want to ask Mr. I himself. He chooses the following method: he prepares $+\\infty$ money for Mr. Y, and lets Mr. Y run errands for him. Each time, he specifies two non-empty item **sets** $S, T$ to Mr. Y (items within the same set must be pairwise distinct, i.e. each kind of item can appear at most once in each set). Mr. Y will go to the shop, buy the items in the two sets respectively, bring them back, and tell Mr. V which set has a larger total price. However, when **the sums of the two sets are equal**, Mr. Y will answer Mr. V according to Mr. I’s instructions.\n\nCarrying many items is tiring, so we define the physical cost of one errand as $\\texttt{S} + \\texttt{T}$, where $\\texttt{S}$ denotes the number of items in set $S$.\n\nYour task is to write a program to help Mr. V decide how to make Mr. Y run errands in a reasonable way, so as to deduce the value of every kind of item. Mr. Y’s stamina is limited, so you cannot make him too tired, i.e. you cannot let his total physical cost exceed a preset threshold $M$.\n\n#### Implementation Details\nYou do not need, and should not, implement the main function. You only need to implement the following function:\n- `find_price(task_id, N, K, ans)`\n- Here `task_id` denotes the subtask ID (see Constraints and Rules). $N$ denotes the number of items, and the meaning of $K$ is:\n  - If $K = 0$, it means there are an even number of items with value $1$.\n  - If $K = 1$, it means there are an odd number of items with value $1$.\n- You need to store the computed item prices in the array $\\text{ans}[]$, where $\\text{ans[i]}$ is the price of the item with ID $i$.\n\nYou can make queries to the interactive library by calling the following function:\n- `query(S, nS, T, nT)`\n- Here $\\text{nS} = \\texttt{S}, \\text{nT} = \\texttt{T}$. Arrays $\\text{S [0\\ldots (nS - 1)]}$ and $\\text{T[0\\ldots (nT - 1)]}$ describe the two sets respectively. You must ensure:\n  - $\\text{nS, nT} > 0$.\n  - $\\forall 0 \\le i < \\text{nS} , 0 \\le \\text{S[i]} < N$.\n  - $\\forall 0 \\le i < \\text{nT} , 0 \\le \\text{T[i]} < N$.  \n$\\forall$ means “for any”. For example, $\\forall 0 \\le i < \\text{nS} , 0 \\le \\text{S[i]} < N$ means: “for any $i$ in $[0, \\text{nS})$, $\\text{S[i]}$ is in $[0, N)$”.\n- The time complexity of calling this function once is $\\Theta(\\text{nS + nT})$. It returns $0$ or $1$, and the meaning is:\n  - If the sum of prices of items in set $S$ is larger, return $0$.\n  - If the sum of prices of items in set $T$ is larger, return $1$.\n  - Otherwise, return $0$ or $1$ according to some unknown rule.\n- As stated, we define the cost of one call as $\\text{nS + nT}$.\n\nDuring evaluation, the interactive library may call `find_price` multiple times (no more than $10$ times). Each call represents a new price-guessing game, and all item prices will be reset.", "inputFormat": "The executable will read input from standard input in the following format:\n\nThe first line contains an integer $T ( T \\le 100 )$, the number of test groups. For each group:\n- The first line contains two integers $\\texttt{task\\_id}, N$.\n- The next line contains a binary string $s$ of length $N$, where $s_i$ denotes the price of item $i$. You need to ensure that at least one item has price $1$.\n\nAfter reading is finished, the interactive library will call the `find_price` function $T$ times.\n\nThen the interactive library will check whether your function is correct each time. If all are correct, it will output `Correct`; otherwise, it will output the corresponding error message.", "outputFormat": "", "hint": "#### Scoring Rules\n\nThis problem is first subject to the same limits as non-interactive programming problems. For example, a compilation error will cause the entire problem to score $0$ points; runtime error, exceeding the time limit, exceeding the memory limit, etc. will cause the corresponding test points to score $0$ points. You may only access variables you define yourself and the variables provided by the interactive library and their corresponding memory space. Attempting to access other memory may cause a compilation error or runtime error.\n\nUnder the above conditions, in a test point, you get full score if and only if, in **every** call to `find_price`:\n- Every call to `query` follows the rules, and the sum of call costs does not exceed $M$.\n- Your function correctly computes the array $\\text{ans[]}$.\n\nIn a test point, if you do not get full score, then you get $0$ points.\n\n#### Subtasks\nLet the upper bound of the total cost be $M$, and denote the answer array as $\\text{ans[]}$:\n- Subtask 1: $N \\le 5, M = 100$.\n- Subtask 2: $N \\le 10^3, M = 10^6$.\n- Subtask 3: $N \\le 10^5, M = 100$. It is guaranteed that $\\forall i < j < k$, if $\\text{ans[i]} = \\text{ans[k]}$ then $\\text{ans[j]} = \\text{ans[i]}$.\n- Subtask 4: $N \\le 10^4, M = 2 \\times 10^5$.\n- Subtask 5: $N \\le 5 \\times 10^4, M = 350100$.\n- Subtask 6: $N \\le 10^5, M = 500100$.\n\n#### Note\n**Mr. I may not be willing to let Mr. V know the price of every item. When the sums are equal, he will answer in his own way.**\n\n#### Subtask Scores\nIn this contest, the score distribution of test points (or subtasks) depends on whether you are a CTT contestant. The score settings for this problem are as follows:\n\n| Subtask ID   | 1    | 2    | 3    | 4    | 5    | 6    |\n| :------------: | :----: | :----: | :----: | :----: | :----: | :----: |\n| CTT Score   | $20$ | $11$ | $9$  | $12$ | $17$ | $31$ |\n| Non-CTT Score | $31$ | $21$ | $13$ | $9$  | $11$ | $15$ |\n\n**Luogu uses the CTT scoring scheme when judging.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2019] I 君的商店", "background": "### 特别提示\n\n**在洛谷提交本题时的一些注意事项（与原题面不同之处请以此处为准）：**\n\n1. 与原题不同的是，你不需要，也不应该在程序开头包含 `shop.h` 头文件。\n2. 提交时，请在程序中加入以下函数声明语句：\n\n```cpp\nint query(int *S, int nS, int *T, int nT);\n```\n\n3. 仅支持 `C++`（含 `C++`，`C++11`，`C++14`，`C++17`）提交。", "description": "V 君、I 君和 Y 君是好朋友。\n\nI 君最近开了一家商店，商店里准备了 $N$ 种物品（编号为 $0 \\sim N - 1$ 中的整数），每种物品均有无限个可供出售，每种物品的单价是 $0$ 或者 $1$。\n\nV 君想知道每个物品的价格，他已经通过某种超自然力量知道，这 $N$ 个物品里，价格是 $1$ 的物品恰好有奇数/偶数个，且**至少存在一个物品的价格是 $1$**。\n\n然而， V 君并不想自己去问 I 君，他选择了这样一种方法：他准备了 $+\\infty$ 的钱给 Y 君。然后让 Y 君帮他跑腿：每一次，他会给 Y 君指定两个非空物品**集合** $S, T$（同一个集合内的物品必须两两不同，即每种物品在每个集合类最多包含一个），Y 君会跑到商店，分别买下这两个集合的物品，把他们送回来，并告诉 V 君哪个集合的物品价格之和更高。但是，当**两集合价格之和相等**的时候，Y 君会按照 I 君的指示来回答 V 君。\n\n带着很多物品跑腿是一个很累的事情，因此，我们定义一次跑腿的体力消耗是 $\\texttt{S} + \\texttt{T}$。其中，$\\texttt{S}$ 表示集合 $S$ 包含的物品个数。\n\n你的任务是：写一个程序，帮助 V 君决定如何合理地让 Y 君跑腿，从而推算出每种物品的价值。Y 君的体力有限，你当然不能让他过于劳 累，也即，你不能让他的总体力消耗超过某个预设的阈值 $M$。\n\n#### 实现细节\n你不需要，也不应该实现主函数，你只需要实现下列函数：\n- `find_price(task_id, N, K, ans)`\n- 其中 `task_id` 表示子任务编号（见限制与约定）。$N$ 表示物品个数，$K$ 的意义为：\n  - 若 $K = 0$，表示有偶数个物品价值为 $1$；\n  - 若 $K = 1$，表示有奇数个物品价值为 $1$。\n- 你需要将计算出的物品价格放在数组 $\\text{ans}[]$ 中，其中 $\\text{ans[i]}$ 表示编号为 $i$ 的物品的价格。\n\n你可以通过调用如下函数来向交互库发出询问：\n- `query(S, nS, T, nT)`\n- 这里 $\\text{nS} = \\texttt{S}, \\text{nT} = \\texttt{T}$, 数组 $\\text{S [0\\ldots (nS - 1)]}$ 和数组 $\\text{T[0\\ldots (nT - 1)]}$ 分别描述两个集合，你需要保证：\n  - $\\text{nS, nT} > 0$；\n  - $\\forall 0 \\le i < \\text{nS} , 0 \\le \\text{S[i]} < N$；\n  - $\\forall 0 \\le i < \\text{nT} , 0 \\le \\text{T[i]} < N$；  \n$\\forall$ 的意思是：「对于任意的」。例如：$\\forall 0 \\le i < \\text{nS} , 0 \\le \\text{S[i]} < N$ 的意思是：「对于任意的在 $[0, \\text{nS})$ 内的 $i$，$\\text{S[i]}$ 在 $[0, N)$ 内」。\n- 调用此函数一次的时间复杂度为 $\\Theta(\\text{nS + nT})$。它的返回值为 $0$ 或 $1$，返回值的意义为：\n  - 若集合 $S$ 的物品价格和更大，返回 $0$；\n  - 若集合 $T$ 的物品价格和更大，返回 $1$；\n  - 否则，按照某种未知规则返回 $0$ 或 $1$。\n- 如题面所述，我们定义这样一次调用的代价为 $\\text{nS + nT}$。\n\n评测时，交互库可能会调用 `find_price` 多次（不超过 $10$ 次），每次调用代表一次新的猜价格游戏，所有的物品的价格都会被重新设定。", "inputFormat": "可执行文件将从标准输入读入以下格式的数据：\n\n第一行一个整数 $T ( T \\le 100 )$，表示数据组数。对每组数据：\n- 第一行包含两个整数 $\\texttt{task\\_id}, N$；\n- 接下来一行一个长度为 $N$ 的 $01$ 串 $s$，其中 $s_i$ 表示物品 $i$ 的价格。你需要保证至少有一个物品价格为 $1$。\n\n读入完成之后，交互库将调用 $T$ 次 `find_price` 函数。\n\n接下来交互库会判断你的函数每次计算是否正确，若全部正确则会输出 `Correct`，否则会输出相应的错误信息。", "outputFormat": "", "hint": "#### 评分标准\n\n题目首先会受到和非交互式程序题相同的限制。例如编译错误会导致整道题目得 $0$ 分，运行时错误、超过时间限制、超过空间限制等会导致相应测试点得 $0$ 分等。你只能访问自己定义的和交互库给出的变量及其对应的内存空间，尝试访问其他空间将可能导致编译错误或运行错误。\n\n在上述条件基础上，在一个测试点中，你得到满分，当且仅当**每一次** `find_price` 的调用中：\n- 你的每一个 `query` 的调用符合规则，且调用代价之和不超过 $M$；\n- 你的函数正确计算了 $\\text{ans[]}$ 数组。\n\n在一个测试点中，如果你没有获得满分，那么你获得 $0$ 分。\n\n#### 子任务\n我们令代价之和的上界为 $M$，记答案数组为 $\\text{ans[]}$：\n- 子任务 1：$N \\le 5, M = 100$；\n- 子任务 2：$N \\le 10^3, M = 10^6$；\n- 子任务 3：$N \\le 10^5, M = 100$，保证 $\\forall i < j < k$，若 $\\text{ans[i]} = \\text{ans[k]}$ 则必有 $\\text{ans[j]} = \\text{ans[i]}$。\n- 子任务 4：$N \\le 10^4, M = 2 \\times 10^5$；\n- 子任务 5：$N \\le 5 \\times 10^4, M = 350100$；\n- 子任务 6：$N \\le 10^5, M = 500100$。\n\n#### 提示\n**I 君可能并不愿意让 V 君知道每件物品的价格，在物品价格相等时，他会按照他自己的某种方式来回答问题。**\n\n#### 子任务分值\n在本场比赛中，测试点（或子任务）的分值分布与你是否为集训队选手有关。本题的分值设置如下：\n\n| 子任务编号   | 1    | 2    | 3    | 4    | 5    | 6    |\n| :------------: | :----: | :----: | :----: | :----: | :----: | :----: |\n| 集训队分值   | $20$ | $11$ | $9$  | $12$ | $17$ | $31$ |\n| 非集训队分值 | $31$ | $21$ | $13$ | $9$  | $11$ | $15$ |\n\n**洛谷评测时采用集训队分值计算分数**。", "locale": "zh-CN"}}}
{"pid": "P5209", "type": "P", "difficulty": 7, "samples": [["3\n3 1\n1\n1\n1\n1 2\n2 1\n4 2\n2 1\n1 2\n1 2\n2 1\n", "7\n2\n31"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "浙江"], "title": "[ZJOI2017] 汉诺塔", "background": "虽然九条可怜经常出题，但是她发现要一个人出一场比赛是在是太难了，于是她丢下了手头的出题工作开始玩小游戏。", "description": "有一个游戏是汉诺塔的改版。在这个游戏中，盘子的大小可以相同，但是保证了相同大小的盘子恰好有 K 个。\n\n初始状态下，所有盘子自底向上从大到小地放置在第一根柱子上，对于相同大小的盘子，我们自底向上给它们从 1 到 K 标号。目标是把所有盘子都移动到第三根柱子上。\n\n因为相同大小的盘子的上下顺序没有要求，不难发现合法的终止状态有很多，因此游戏里指定了一种终止状态。\n\n游戏的任务是最小化移动的步数。\n\n可怜想了想觉得这个问题好像挺难的，于是她就把这个出到比赛里来给你做啦。\n\n下面给出汉诺塔的具体规则：\n\n• 有三根柱子和若干块圆盘，初始状态下所有圆盘都在第一根柱子上。\n\n• 每一时刻你可以把某一根柱子顶端的圆盘移动到另一根柱子的顶端，目标是把\n所有盘子都\n\n移动到第三根柱子上。\n\n• 移动的过程中必须要保证较大的圆盘不会压在较小的圆盘上。（相同大小的圆盘没有顺序限制）。\n", "inputFormat": "第一行输入一个整数表示数据组数。\n\n每组数据第一行是两个整数 n 和 K。\n\n接下来 n 行按照盘子从大到小的顺序给出终止状态下同一大小的盘子的相对顺序（从左到右依次表示自底向上），\n\n例如 K = 2 时，2 1 表示原来在上方的盘子到了下面，原来在下方的盘子到了上面。", "outputFormat": "对于每组数据输出一个整数表示最少步数。", "hint": "\n| 测试点编号 | K | 测试点编号 | K |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| 1 | =1 | 6 | =3 |\n| 2 | =2 | 7 | =3 |\n| 3 | =2 | 8 | =4 |\n| 4 | =2 | 9 | =4 |\n| 5 | =3 | 10 | =4 |\n\n对于 100% 的数据，保证 T ≤ $10^4$\n, 1 ≤ n ≤ 50, 1 ≤ xi ≤ K。\n\n**在实际的测试点中，T 组数据的 K 都是相同的**\n\n$\\textcolor{white}{SookeAKIOI}$", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2017] Tower of Hanoi", "background": "Although Jiutiao often sets problems, she found that setting an entire contest by herself was really too hard, so she dropped the work at hand and started playing some mini-games.", "description": "There is a modified version of the Tower of Hanoi. In this game, disks are allowed to have the same size, but it is guaranteed that for each size there are exactly $K$ disks of that size.\n\nIn the initial state, all disks are stacked on the first peg from bottom to top in non-increasing order of size (larger below, smaller above). For disks of the same size, we label them from $1$ to $K$ from bottom to top. The goal is to move all disks to the third peg.\n\nSince there is no requirement on the relative order of disks of the same size, it is easy to see that there are many legal terminal states. Therefore, the game specifies one particular terminal state.\n\nThe task is to minimize the number of moves.\n\nJiutiao thought this problem seemed quite difficult, so she put it into the contest for you to solve.\n\nThe specific rules are as follows:\n\n- There are three pegs and several circular disks. In the initial state, all disks are on the first peg.\n- At any moment, you may move the top disk of one peg to the top of another peg, with the goal of moving all disks to the third peg.\n- During the process, you must ensure that a larger disk is never placed on top of a smaller disk. (There is no order restriction among disks of the same size.)", "inputFormat": "The first line contains an integer indicating the number of test cases.\n\nFor each test case, the first line contains two integers $n$ and $K$.\n\nThe next $n$ lines, in order from larger sizes to smaller sizes, give the relative order of the $K$ disks of that same size in the terminal state (from left to right represents bottom to top).\n\nFor example, when $K = 2$, `2 1` means the disk that was originally on top goes to the bottom, and the disk that was originally on the bottom goes to the top.", "outputFormat": "For each test case, output one integer indicating the minimum number of moves.", "hint": "| Test Point ID | K | Test Point ID | K |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| 1 | =1 | 6 | =3 |\n| 2 | =2 | 7 | =3 |\n| 3 | =2 | 8 | =4 |\n| 4 | =2 | 9 | =4 |\n| 5 | =3 | 10 | =4 |\n\nFor $100\\%$ of the data, it is guaranteed that $T \\le 10^4$, $1 \\le n \\le 50$, $1 \\le x_i \\le K$.\n\n**In the actual test points, the values of $K$ are the same for all $T$ test cases.**\n\n$\\textcolor{white}{SookeAKIOI}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2017] 汉诺塔", "background": "虽然九条可怜经常出题，但是她发现要一个人出一场比赛是在是太难了，于是她丢下了手头的出题工作开始玩小游戏。", "description": "有一个游戏是汉诺塔的改版。在这个游戏中，盘子的大小可以相同，但是保证了相同大小的盘子恰好有 K 个。\n\n初始状态下，所有盘子自底向上从大到小地放置在第一根柱子上，对于相同大小的盘子，我们自底向上给它们从 1 到 K 标号。目标是把所有盘子都移动到第三根柱子上。\n\n因为相同大小的盘子的上下顺序没有要求，不难发现合法的终止状态有很多，因此游戏里指定了一种终止状态。\n\n游戏的任务是最小化移动的步数。\n\n可怜想了想觉得这个问题好像挺难的，于是她就把这个出到比赛里来给你做啦。\n\n下面给出汉诺塔的具体规则：\n\n• 有三根柱子和若干块圆盘，初始状态下所有圆盘都在第一根柱子上。\n\n• 每一时刻你可以把某一根柱子顶端的圆盘移动到另一根柱子的顶端，目标是把\n所有盘子都\n\n移动到第三根柱子上。\n\n• 移动的过程中必须要保证较大的圆盘不会压在较小的圆盘上。（相同大小的圆盘没有顺序限制）。\n", "inputFormat": "第一行输入一个整数表示数据组数。\n\n每组数据第一行是两个整数 n 和 K。\n\n接下来 n 行按照盘子从大到小的顺序给出终止状态下同一大小的盘子的相对顺序（从左到右依次表示自底向上），\n\n例如 K = 2 时，2 1 表示原来在上方的盘子到了下面，原来在下方的盘子到了上面。", "outputFormat": "对于每组数据输出一个整数表示最少步数。", "hint": "\n| 测试点编号 | K | 测试点编号 | K |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| 1 | =1 | 6 | =3 |\n| 2 | =2 | 7 | =3 |\n| 3 | =2 | 8 | =4 |\n| 4 | =2 | 9 | =4 |\n| 5 | =3 | 10 | =4 |\n\n对于 100% 的数据，保证 T ≤ $10^4$\n, 1 ≤ n ≤ 50, 1 ≤ xi ≤ K。\n\n**在实际的测试点中，T 组数据的 K 都是相同的**\n\n$\\textcolor{white}{SookeAKIOI}$", "locale": "zh-CN"}}}
{"pid": "P5210", "type": "P", "difficulty": 7, "samples": [["10\n3 1 2 9 6 4 5 7 8\n3\n7 6 7\n18 4 5\n14 5 6\n", "7\n11\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "浙江"], "title": "[ZJOI2017] 线段树", "background": "线段树是九条可怜很喜欢的一个数据结构，它拥有着简单的结构、优秀的复杂度与强大的功能，因此可怜曾经花了很长时间研究线段树的一些性质。\n", "description": "线段树是九条可怜很喜欢的一个数据结构，它拥有着简单的结构、优秀的复杂度与强大的功能，因此可怜曾经花了很长时间研究线段树的一些性质。\n\n最近可怜又开始研究起线段树来了，有所不同的是，她把目光放在了更广义的线段树上：在正常的线段树中，对于区间 $[l, r]$，我们会取 $m = \\lfloor \\frac{l+r}{2} \\rfloor$，然后将这个区间分成 $[l, m]$ 和 $[m + 1, r]$ 两个子区间。在广义的线段树中，$m$ 不要求恰好等于区间的中点，但是 $m$ 还是必须满足 $l \\le m < r$ 的。不难发现在广义的线段树中，树的深度可以达到 $O(n)$ 级别。\n\n例如下面这棵树，就是一棵广义的线段树：\n\n![Segment tree](https://cdn.luogu.com.cn/upload/pic/50896.png)\n\n为了方便，我们按照先序遍历给线段树上所有的节点标号，例如在上图中，$[2, 3]$ 的标号是 $5$，$[4, 4]$ 的标号是 $9$，不难发现在 $[1, n]$ 上建立的广义线段树，它共有着 $2n − 1$ 个节点。\n\n考虑把线段树上的定位区间操作 $($就是打懒标记的时候干的事情$)$ 移植到广义线段树上，可以发现在广义的线段树上还是可以用传统的线段树上的方法定位区间的，例如在上图中，蓝色节点和蓝色边就是在定位区间 $[2, 4]$ 时经过的点和边，最终定位到的点是 $[2, 3]$ 和 $[4, 4]$。\n\n如果你对线段树不熟悉，这儿给出定位区间操作形式化的定义：给出区间 $[l, r]$，找出尽可能少的**区间互不相交**的线段树节点，使得它们区间的并集**恰好**是 $[l, r]$。\n\n定义 $S_{[l,r]}$ 为定位区间 $[l, r]$ 得到的点集，例如在上图中，$S_{[2,4]} = \\{5, 9\\}$。定义线段树上两个点 $u, v$ 的距离 $d(u, v)$ 为线段树上 $u$ 到 $v$ 最短路径上的边数，例如在上图中 $d(5, 9) = 3$。\n\n现在可怜给了你一棵 $[1, n]$ 上的广义的线段树并给了 $m$ 组询问，每组询问给出三个数 $u, l, r\\ (l \\le r)$，可怜想要知道 $\\sum_{v \\in S_{[l, r]}} d(u, v)$。", "inputFormat": "第一行输入一个整数 $n$。\n\n接下来一行包含 $n - 1$ 个空格隔开的整数：按照标号递增的顺序，给出广义线段树上所有**非叶子**节点的划分位置 $m$。不难发现通过这些信息就能唯一确定一棵 $[1, n]$ 上的广义线段树。\n\n接下来一行输入一个整数 $m$。\n\n之后 $m$ 行每行输入三个整数 $u, l, r\\ (1 \\le u \\le 2n − 1, 1 \\le l \\le r \\le n)$，表示一组询问。", "outputFormat": "对于每组询问，输出一个整数表示答案。\n", "hint": "|  测试点编号   |         $n$         |         $m$         | 其他约定  |   \n| :------: | :-----------------: | :-----------------: | :---: |   \n|    $1$     |      $\\le 100$      |      $\\le 100$      |   无   |    \n|    $2$     | $\\le 2 \\times 10^5$ |      $\\le 20$       |   无   |    \n|   $3,4$    | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | $r=n$ |    \n|   $5,6$    | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | $u=1$ |    \n| $7,8,9,10$ | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ |   无   |    \n\n对于 $100\\%$ 的数据，保证 $n \\ge 2, m \\ge 1$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2017] Segment Tree", "background": "A segment tree is a data structure that Jiu Tiao Ke Lian likes very much. It has a simple structure, good complexity, and powerful functions, so Ke Lian once spent a long time studying some properties of segment trees.", "description": "A segment tree is a data structure that Jiu Tiao Ke Lian likes very much. It has a simple structure, good complexity, and powerful functions, so Ke Lian once spent a long time studying some properties of segment trees.\n\nRecently, Ke Lian started studying segment trees again. The difference is that she focused on a more general segment tree. In a normal segment tree, for an interval $[l, r]$, we take $m = \\lfloor \\frac{l+r}{2} \\rfloor$, and then split this interval into two sub-intervals $[l, m]$ and $[m + 1, r]$. In a generalized segment tree, $m$ is not required to be exactly the midpoint of the interval, but it still must satisfy $l \\le m < r$. It is not hard to see that in a generalized segment tree, the depth of the tree can reach $O(n)$.\n\nFor example, the following tree is a generalized segment tree:\n\n![Segment tree](https://cdn.luogu.com.cn/upload/pic/50896.png)\n\nFor convenience, we number all nodes of the segment tree by preorder traversal. For example, in the figure above, the number of $[2, 3]$ is $5$, and the number of $[4, 4]$ is $9$. It is not hard to see that a generalized segment tree built on $[1, n]$ has a total of $2n - 1$ nodes.\n\nConsider transplanting the interval-location operation on a segment tree (this is what is done when applying lazy tags) to a generalized segment tree. You can find that on a generalized segment tree, you can still locate an interval using the traditional segment tree method. For example, in the figure above, the blue nodes and blue edges are the nodes and edges passed when locating interval $[2, 4]$, and the final located nodes are $[2, 3]$ and $[4, 4]$.\n\nIf you are not familiar with segment trees, here is a formal definition of the interval-location operation. Given an interval $[l, r]$, find as few segment tree nodes as possible whose intervals are **pairwise disjoint**, such that the union of their intervals is **exactly** $[l, r]$.\n\nDefine $S_{[l,r]}$ as the set of nodes obtained by locating interval $[l, r]$. For example, in the figure above, $S_{[2,4]} = \\{5, 9\\}$. Define the distance $d(u, v)$ between two nodes $u, v$ on the segment tree as the number of edges on the shortest path from $u$ to $v$ on the segment tree. For example, in the figure above, $d(5, 9) = 3$.\n\nNow, Ke Lian gives you a generalized segment tree on $[1, n]$ and $m$ queries. Each query gives three integers $u, l, r\\ (l \\le r)$. Ke Lian wants to know $\\sum_{v \\in S_{[l, r]}} d(u, v)$.", "inputFormat": "The first line contains an integer $n$.\n\nThe next line contains $n - 1$ space-separated integers. In increasing order of node number, they give the split position $m$ of every **non-leaf** node in the generalized segment tree. It is not hard to see that this information uniquely determines a generalized segment tree on $[1, n]$.\n\nThe next line contains an integer $m$.\n\nThen follow $m$ lines. Each line contains three integers $u, l, r\\ (1 \\le u \\le 2n - 1, 1 \\le l \\le r \\le n)$, representing a query.", "outputFormat": "For each query, output one integer as the answer.", "hint": "| Test Point ID | $n$ | $m$ | Other Constraints |\n| :------: | :-----------------: | :-----------------: | :---: |\n| $1$ | $\\le 100$ | $\\le 100$ | None |\n| $2$ | $\\le 2 \\times 10^5$ | $\\le 20$ | None |\n| $3,4$ | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | $r = n$ |\n| $5,6$ | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | $u = 1$ |\n| $7,8,9,10$ | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | None |\n\nFor $100\\%$ of the testdata, it is guaranteed that $n \\ge 2, m \\ge 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2017] 线段树", "background": "线段树是九条可怜很喜欢的一个数据结构，它拥有着简单的结构、优秀的复杂度与强大的功能，因此可怜曾经花了很长时间研究线段树的一些性质。\n", "description": "线段树是九条可怜很喜欢的一个数据结构，它拥有着简单的结构、优秀的复杂度与强大的功能，因此可怜曾经花了很长时间研究线段树的一些性质。\n\n最近可怜又开始研究起线段树来了，有所不同的是，她把目光放在了更广义的线段树上：在正常的线段树中，对于区间 $[l, r]$，我们会取 $m = \\lfloor \\frac{l+r}{2} \\rfloor$，然后将这个区间分成 $[l, m]$ 和 $[m + 1, r]$ 两个子区间。在广义的线段树中，$m$ 不要求恰好等于区间的中点，但是 $m$ 还是必须满足 $l \\le m < r$ 的。不难发现在广义的线段树中，树的深度可以达到 $O(n)$ 级别。\n\n例如下面这棵树，就是一棵广义的线段树：\n\n![Segment tree](https://cdn.luogu.com.cn/upload/pic/50896.png)\n\n为了方便，我们按照先序遍历给线段树上所有的节点标号，例如在上图中，$[2, 3]$ 的标号是 $5$，$[4, 4]$ 的标号是 $9$，不难发现在 $[1, n]$ 上建立的广义线段树，它共有着 $2n − 1$ 个节点。\n\n考虑把线段树上的定位区间操作 $($就是打懒标记的时候干的事情$)$ 移植到广义线段树上，可以发现在广义的线段树上还是可以用传统的线段树上的方法定位区间的，例如在上图中，蓝色节点和蓝色边就是在定位区间 $[2, 4]$ 时经过的点和边，最终定位到的点是 $[2, 3]$ 和 $[4, 4]$。\n\n如果你对线段树不熟悉，这儿给出定位区间操作形式化的定义：给出区间 $[l, r]$，找出尽可能少的**区间互不相交**的线段树节点，使得它们区间的并集**恰好**是 $[l, r]$。\n\n定义 $S_{[l,r]}$ 为定位区间 $[l, r]$ 得到的点集，例如在上图中，$S_{[2,4]} = \\{5, 9\\}$。定义线段树上两个点 $u, v$ 的距离 $d(u, v)$ 为线段树上 $u$ 到 $v$ 最短路径上的边数，例如在上图中 $d(5, 9) = 3$。\n\n现在可怜给了你一棵 $[1, n]$ 上的广义的线段树并给了 $m$ 组询问，每组询问给出三个数 $u, l, r\\ (l \\le r)$，可怜想要知道 $\\sum_{v \\in S_{[l, r]}} d(u, v)$。", "inputFormat": "第一行输入一个整数 $n$。\n\n接下来一行包含 $n - 1$ 个空格隔开的整数：按照标号递增的顺序，给出广义线段树上所有**非叶子**节点的划分位置 $m$。不难发现通过这些信息就能唯一确定一棵 $[1, n]$ 上的广义线段树。\n\n接下来一行输入一个整数 $m$。\n\n之后 $m$ 行每行输入三个整数 $u, l, r\\ (1 \\le u \\le 2n − 1, 1 \\le l \\le r \\le n)$，表示一组询问。", "outputFormat": "对于每组询问，输出一个整数表示答案。\n", "hint": "|  测试点编号   |         $n$         |         $m$         | 其他约定  |   \n| :------: | :-----------------: | :-----------------: | :---: |   \n|    $1$     |      $\\le 100$      |      $\\le 100$      |   无   |    \n|    $2$     | $\\le 2 \\times 10^5$ |      $\\le 20$       |   无   |    \n|   $3,4$    | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | $r=n$ |    \n|   $5,6$    | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | $u=1$ |    \n| $7,8,9,10$ | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ |   无   |    \n\n对于 $100\\%$ 的数据，保证 $n \\ge 2, m \\ge 1$。", "locale": "zh-CN"}}}
{"pid": "P5211", "type": "P", "difficulty": 7, "samples": [["5 5\n3 2 1 4 3\n2 1 5\n1 2 4 2\n2 1 5\n1 2 5 1\n2 1 5\n", "3\n5\n1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "线段树", "各省省选", "浙江"], "title": "[ZJOI2017] 字符串", "background": "猪小侠最近学习了字符串相关理论，现在他遇到了这样一个题：", "description": "维护一个动态字符串 $s_{1..n}$，字符串的字符集是所有 $|x| \\leq 10 ^ 9$ 的整数。要求支持两个操作：\n\n1. 输入 $l, r, d$，对于所有 $l \\leq i \\leq r$，将 $s_i$ 修改为 $s_i + d$，注意 $d$ 可能是负数。\n\n2. 输入 $l, r$，输出子串 $s_{l..r}$ 的字典序最小的后缀的起点位置。即，如果最小后缀是 $s_{p..r}$（$l\\leq p\\leq r$），请输出 $p$。", "inputFormat": "第一行两个非负整数 $n, q$。\n\n接下来一行包含 $n$ 个正整数，表示初始时的字符串。\n\n接下来 $q$ 行，每行为 $1\\ l\\ r\\ d$ 或 $2\\ l\\ r$，分别表示两种操作。\n", "outputFormat": "对于所有的查询操作按顺序输出答案。", "hint": "| 测试点编号 | $n$ | $m$ | 其他约定 |\n| ------ | ------ | ------ | ------ |\n| $1$ | $\\leq 300$ | $\\leq 300$ | 无 |\n| $2$ | $\\leq 2 \\times 10^4$ | $\\leq 2 \\times 10^4$ | 无 |\n| $3$ | $\\leq 2 \\times 10^4$ | $\\leq 2 \\times 10^5$ | 无 |\n| $4$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |只有第二类操作 |\n| $5$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |只有第二类操作 |\n| $6$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |数据随机生成 |\n| $7$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |数据随机生成 |\n| $8$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |无 |\n| $9$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |无 |\n| $10$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |无 |\n\n对于 $100\\%$ 的数据，$1\\leq l\\leq r\\leq n$，$|d|\\leq 10 ^ 3$，$|s_i|\\leq 10 ^ 8$。\n\n注意，$6$ 和 $7$ 两个测试数据在随机生成时，$s_i$ 在 $\\{0, 1\\}$ 中随机，$d$ 在 $\\{-1, 1\\}$ 中随机。操作种类和操作区间都是等概率随机的。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2017] String", "background": "Pig Xiaoxia has recently been studying string-related theory, and now he has encountered the following problem.", "description": "Maintain a dynamic string $s_{1..n}$, whose alphabet is all integers with $|x| \\leq 10 ^ 9$. You need to support two operations:\n\n1. Input $l, r, d$. For all $l \\leq i \\leq r$, modify $s_i$ to $s_i + d$. Note that $d$ may be negative.\n\n2. Input $l, r$. Output the starting position of the lexicographically smallest suffix of the substring $s_{l..r}$. That is, if the smallest suffix is $s_{p..r}$ ($l \\leq p \\leq r$), output $p$.", "inputFormat": "The first line contains two non-negative integers $n, q$.\n\nThe next line contains $n$ positive integers, representing the initial string.\n\nThe next $q$ lines each describe an operation in the form $1\\ l\\ r\\ d$ or $2\\ l\\ r$, corresponding to the two operations above.", "outputFormat": "For each query operation, output the answer in order.", "hint": "| Test Point ID | $n$ | $m$ | Other Constraints |\n| ------ | ------ | ------ | ------ |\n| $1$ | $\\leq 300$ | $\\leq 300$ | None |\n| $2$ | $\\leq 2 \\times 10^4$ | $\\leq 2 \\times 10^4$ | None |\n| $3$ | $\\leq 2 \\times 10^4$ | $\\leq 2 \\times 10^5$ | None |\n| $4$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ | Only the second type of operation |\n| $5$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ | Only the second type of operation |\n| $6$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ | testdata generated randomly |\n| $7$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ | testdata generated randomly |\n| $8$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ | None |\n| $9$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ | None |\n| $10$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ | None |\n\nConstraints: For $100\\%$ of the data, $1 \\leq l \\leq r \\leq n$, $|d| \\leq 10 ^ 3$, and $|s_i| \\leq 10 ^ 8$.\n\nNote: In test points $6$ and $7$, during random generation, $s_i$ is chosen randomly from $\\{0, 1\\}$, and $d$ is chosen randomly from $\\{-1, 1\\}$. The operation type and the operation interval are both selected uniformly at random.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2017] 字符串", "background": "猪小侠最近学习了字符串相关理论，现在他遇到了这样一个题：", "description": "维护一个动态字符串 $s_{1..n}$，字符串的字符集是所有 $|x| \\leq 10 ^ 9$ 的整数。要求支持两个操作：\n\n1. 输入 $l, r, d$，对于所有 $l \\leq i \\leq r$，将 $s_i$ 修改为 $s_i + d$，注意 $d$ 可能是负数。\n\n2. 输入 $l, r$，输出子串 $s_{l..r}$ 的字典序最小的后缀的起点位置。即，如果最小后缀是 $s_{p..r}$（$l\\leq p\\leq r$），请输出 $p$。", "inputFormat": "第一行两个非负整数 $n, q$。\n\n接下来一行包含 $n$ 个正整数，表示初始时的字符串。\n\n接下来 $q$ 行，每行为 $1\\ l\\ r\\ d$ 或 $2\\ l\\ r$，分别表示两种操作。\n", "outputFormat": "对于所有的查询操作按顺序输出答案。", "hint": "| 测试点编号 | $n$ | $m$ | 其他约定 |\n| ------ | ------ | ------ | ------ |\n| $1$ | $\\leq 300$ | $\\leq 300$ | 无 |\n| $2$ | $\\leq 2 \\times 10^4$ | $\\leq 2 \\times 10^4$ | 无 |\n| $3$ | $\\leq 2 \\times 10^4$ | $\\leq 2 \\times 10^5$ | 无 |\n| $4$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |只有第二类操作 |\n| $5$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |只有第二类操作 |\n| $6$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |数据随机生成 |\n| $7$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |数据随机生成 |\n| $8$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |无 |\n| $9$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |无 |\n| $10$ | $\\leq 2 \\times 10^5$ | $\\leq 3 \\times 10^4$ |无 |\n\n对于 $100\\%$ 的数据，$1\\leq l\\leq r\\leq n$，$|d|\\leq 10 ^ 3$，$|s_i|\\leq 10 ^ 8$。\n\n注意，$6$ 和 $7$ 两个测试数据在随机生成时，$s_i$ 在 $\\{0, 1\\}$ 中随机，$d$ 在 $\\{-1, 1\\}$ 中随机。操作种类和操作区间都是等概率随机的。", "locale": "zh-CN"}}}
{"pid": "P5212", "type": "P", "difficulty": 6, "samples": [["2\nA\nQUERY B\nADD BBABBBBAAB", "0"]], "limits": {"time": [1000, 3000, 3000, 1000, 3000, 3000, 1000, 3000, 1000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["平衡树", "后缀自动机 SAM", "O2优化", "动态树 LCT"], "title": "SubString", "background": "", "description": "给定一个字符串 `init`，要求支持两个操作：\n\n- 在当前字符串的后面插入一个字符串。\n\n- 询问字符串 $s$ 在当前字符串中出现了几次。(作为连续子串)\n\n强制在线。", "inputFormat": "第一行一个整数 $Q$ 表示操作个数。\n\n第二行一个字符串表示初始字符串 `init`。\n\n接下来 $Q$ 行，每行 $2$ 个字符串 `Type`,`Str`。\n\n- `Type` 是 `ADD`，表示在后面插入字符串。\n\n- `Type` 是 `QUERY`，表示询问某字符串在当前字符串中出现了几次。\n\n为了体现在线操作，你需要维护一个变量 `mask`，初始值为 $0$。\n\n```cpp\nString decodeWithMask(String s, int mask) {\n\tchar[] chars = s.toCharArray();\n\tfor (int j = 0; j < chars.length; j++) {\n\t\tmask = (mask * 131 + j) % chars.length;\n\t\t\n\t\tchar t = chars[j];\n\t\tchars[j] = chars[mask];\n\t\tchars[mask] = t;\n\t}\n\t\n\treturn new String(chars);\n}\n```\n\n读入串 `Str` 之后，使用这个过程将之解码成真正询问的串 `TrueStr`。\n\n询问的时候，对 `TrueStr` 询问后输出一行答案 `Result`。\n\n然后 $mask=mask \\bigoplus Result$。\n\n插入的时候，将`TrueStr`插到当前字符串后面即可。\n\n**注意：`ADD` 和 `QUERY` 操作的字符串都需要解压。**\n\n", "outputFormat": "对于每一个 `QUERY` 操作，输出询问的字符串在当前字符串中出现了几次。", "hint": "$|\\mathrm{init}| \\leq 6 \\times 10^5$，$Q \\leq 6\\times 10^5$，询问总长度 $\\leq 3 \\times 10^6$。\n\n保证字符串中只会出现 `A` 和 `B`。\n\n为防止评测过慢，对于测试点 $2,3,5,6,8,11$ 时限为 3s，其余为 1s。\n\n原题：BZOJ 2555", "locale": "zh-CN", "translations": {"en": {"title": "SubString", "background": "", "description": "Given a string `init`, you need to support two operations:\n\n- Append a string to the end of the current string.\n\n- Query how many times a string $s$ appears in the current string (as a contiguous substring).\n\nThe operations are strictly online.", "inputFormat": "The first line contains an integer $Q$, the number of operations.\n\nThe second line contains a string, the initial string `init`.\n\nNext come $Q$ lines. Each line contains two strings, `Type` and `Str`.\n\n- `Type` is `ADD`, meaning to append a string to the end.\n\n- `Type` is `QUERY`, meaning to ask how many times a string appears in the current string.\n\nTo enforce online processing, you need to maintain a variable `mask`, initially $0$.\n\n```cpp\nString decodeWithMask(String s, int mask) {\n\tchar[] chars = s.toCharArray();\n\tfor (int j = 0; j < chars.length; j++) {\n\t\tmask = (mask * 131 + j) % chars.length;\n\t\t\n\t\tchar t = chars[j];\n\t\tchars[j] = chars[mask];\n\t\tchars[mask] = t;\n\t}\n\t\n\treturn new String(chars);\n}\n```\n\nAfter reading `Str`, use this process to decode it into the real string `TrueStr`.\n\nFor a query, query `TrueStr` and output one line with the answer `Result`.\n\nThen update $mask = mask \\bigoplus Result$.\n\nFor an insertion, append `TrueStr` to the end of the current string.\n\n**Note: the strings in both `ADD` and `QUERY` operations must be decoded.**", "outputFormat": "For each `QUERY` operation, output how many times the queried string appears in the current string.", "hint": "$|\\mathrm{init}| \\leq 6 \\times 10^5$, $Q \\leq 6 \\times 10^5$, and the total length of all queried strings is at most $3 \\times 10^6$.\n\nIt is guaranteed that the strings contain only `A` and `B`.\n\nTo avoid slow judging, for test points $2,3,5,6,8,11$ the time limit is 3 s, and for the others it is 1 s.\n\nOriginal problem: BZOJ 2555.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "SubString", "background": "", "description": "给定一个字符串 `init`，要求支持两个操作：\n\n- 在当前字符串的后面插入一个字符串。\n\n- 询问字符串 $s$ 在当前字符串中出现了几次。(作为连续子串)\n\n强制在线。", "inputFormat": "第一行一个整数 $Q$ 表示操作个数。\n\n第二行一个字符串表示初始字符串 `init`。\n\n接下来 $Q$ 行，每行 $2$ 个字符串 `Type`,`Str`。\n\n- `Type` 是 `ADD`，表示在后面插入字符串。\n\n- `Type` 是 `QUERY`，表示询问某字符串在当前字符串中出现了几次。\n\n为了体现在线操作，你需要维护一个变量 `mask`，初始值为 $0$。\n\n```cpp\nString decodeWithMask(String s, int mask) {\n\tchar[] chars = s.toCharArray();\n\tfor (int j = 0; j < chars.length; j++) {\n\t\tmask = (mask * 131 + j) % chars.length;\n\t\t\n\t\tchar t = chars[j];\n\t\tchars[j] = chars[mask];\n\t\tchars[mask] = t;\n\t}\n\t\n\treturn new String(chars);\n}\n```\n\n读入串 `Str` 之后，使用这个过程将之解码成真正询问的串 `TrueStr`。\n\n询问的时候，对 `TrueStr` 询问后输出一行答案 `Result`。\n\n然后 $mask=mask \\bigoplus Result$。\n\n插入的时候，将`TrueStr`插到当前字符串后面即可。\n\n**注意：`ADD` 和 `QUERY` 操作的字符串都需要解压。**\n\n", "outputFormat": "对于每一个 `QUERY` 操作，输出询问的字符串在当前字符串中出现了几次。", "hint": "$|\\mathrm{init}| \\leq 6 \\times 10^5$，$Q \\leq 6\\times 10^5$，询问总长度 $\\leq 3 \\times 10^6$。\n\n保证字符串中只会出现 `A` 和 `B`。\n\n为防止评测过慢，对于测试点 $2,3,5,6,8,11$ 时限为 3s，其余为 1s。\n\n原题：BZOJ 2555", "locale": "zh-CN"}}}
{"pid": "P5213", "type": "P", "difficulty": 6, "samples": [["2 3 2 2", "1"], ["5 5 2 0", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2014", "各省省选", "上海", "分类讨论"], "title": "[SHOI2014] 超能粒子炮", "background": "shoi2014 day1t3", "description": "邪恶的巨型宇宙怪物 CCM (Crazy Code Monster) 即将对美丽的地球发动攻击！\n\n在这千钧一发的时刻,地球联合军决定使用地球最先进的能量武器——由发明家 SHTSC 设计的超能粒子炮彻底摧毁 CCM。\n\n超能粒子炮由垂直方向从上到下共 $n$ 个超能粒子发射管构成,编号 $1 \\sim n$。所有的发射管都会在开火的一瞬间同时发射出强大的超能粒子流。  \n为了彻底摧毁再生能力极强的邪恶宇宙怪物 CCM，地球联合军将 CCM 从上到下分为 $m$ 个区域，编号 $1 \\sim m$，分别进行打击。其中超能粒子炮的第 $i$ 号发射管将会对准 $f(i)$ 号区域发射。$f(i)$ 的公式如下：\n$$f(i) = (ai + b) \\bmod m + 1$$\n其中 $a, b$ 都是给定的常数。\n\n然而，出于某种不可告人的目的，N 财团不希望 CCM 被超能粒子炮彻底消灭。于是 N 财团以远程精神控制了超能粒子炮的操作员——你来阻止地球军消灭 CCM。\n\n你发现，超能粒子炮的开火模式会使得不同的粒子流的运动轨迹发生交叉，而在所有这些交叉点处部署一种名为折跃棱镜的能量反射装置就能使得超能粒子炮因过载而自爆。这样，你就可以阻止地球联合军使用超能粒子炮摧毁 CCM 而成为下一代 N 财团金牌的获得者。\n\n为了实现这个计划,你需要知道有多少对粒子流 $i, j$，满足 $i<j$ 且 $f(i) > f(j)$。", "inputFormat": "第一行四个整数 $n, m, a, b$。分别为超能粒子炮的发射管数目、CCM 被分成的区域数、以及题目描述中的 $f$ 公式中的常数。", "outputFormat": "输出一行一个整数，为运动轨迹交叉的粒子流的对数。", "hint": "对于 10%的数据，$n\\leq 5 \\times 10^3$。\n\n对于 20%的数据，$n\\leq m\\leq 10^6$。\n\n对于额外 20%的数据，$b=0$。\n\n对于 80%的数据，$1\\leq a\\leq 1000$。\n\n对于 $100\\%$ 的数据，$n \\leq m \\leq 10^9$，存在 $a'$ 满足 $a\\times a' =1 \\pmod m$，且 $\\min \\{a,a'\\} \\leq 1000, a,b<m$，$m$ 是质数。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2014] Super Particle Cannon.", "background": "shoi2014 day1t3", "description": "The evil giant space monster CCM (Crazy Code Monster) is about to attack the beautiful Earth.\n\nAt this critical moment, the Earth Allied Forces decide to use the most advanced energy weapon on Earth—the Super Particle Cannon designed by the inventor SHTSC—to completely destroy CCM.\n\nThe Super Particle Cannon consists of $n$ Super Particle launch tubes arranged vertically from top to bottom, numbered $1 \\sim n$. All tubes will fire powerful Super Particle streams at the same instant.  \nTo completely destroy the evil space monster CCM, which has extremely strong regeneration ability, the Earth Allied Forces divide CCM from top to bottom into $m$ regions, numbered $1 \\sim m$, and attack them separately. The $i$-th launch tube of the Super Particle Cannon will aim at region $f(i)$. The formula of $f(i)$ is:\n$$f(i) = (ai + b) \\bmod m + 1$$\nwhere $a$ and $b$ are given constants.\n\nHowever, for some unspeakable purpose, the N Consortium does not want CCM to be completely eliminated by the Super Particle Cannon. So the N Consortium remotely mind-controls the operator of the Super Particle Cannon—you—to stop the Earth forces from destroying CCM.\n\nYou discover that the firing pattern of the Super Particle Cannon will cause the trajectories of different particle streams to cross. If energy reflection devices called Warp Prisms are deployed at all these intersection points, the Super Particle Cannon will overload and self-destruct. In this way, you can stop the Earth Allied Forces from using the Super Particle Cannon to destroy CCM, and become the next-generation gold medal winner of the N Consortium.\n\nTo carry out this plan, you need to know how many pairs of particle streams $i, j$ satisfy $i<j$ and $f(i) > f(j)$.", "inputFormat": "The first line contains four integers $n, m, a, b$, representing the number of launch tubes of the Super Particle Cannon, the number of regions CCM is divided into, and the constants in the formula $f$ described above.", "outputFormat": "Output one integer in a single line, the number of pairs of particle streams whose trajectories intersect.", "hint": "For $10\\%$ of the data, $n\\leq 5 \\times 10^3$.\n\nFor $20\\%$ of the data, $n\\leq m\\leq 10^6$.\n\nFor an additional $20\\%$ of the data, $b=0$.\n\nFor $80\\%$ of the data, $1\\leq a\\leq 1000$.\n\nFor $100\\%$ of the data, $n \\leq m \\leq 10^9$, there exists $a'$ such that $a\\times a' =1 \\pmod m$, and $\\min \\{a,a'\\} \\leq 1000, a,b<m$, and $m$ is prime.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2014] 超能粒子炮", "background": "shoi2014 day1t3", "description": "邪恶的巨型宇宙怪物 CCM (Crazy Code Monster) 即将对美丽的地球发动攻击！\n\n在这千钧一发的时刻,地球联合军决定使用地球最先进的能量武器——由发明家 SHTSC 设计的超能粒子炮彻底摧毁 CCM。\n\n超能粒子炮由垂直方向从上到下共 $n$ 个超能粒子发射管构成,编号 $1 \\sim n$。所有的发射管都会在开火的一瞬间同时发射出强大的超能粒子流。  \n为了彻底摧毁再生能力极强的邪恶宇宙怪物 CCM，地球联合军将 CCM 从上到下分为 $m$ 个区域，编号 $1 \\sim m$，分别进行打击。其中超能粒子炮的第 $i$ 号发射管将会对准 $f(i)$ 号区域发射。$f(i)$ 的公式如下：\n$$f(i) = (ai + b) \\bmod m + 1$$\n其中 $a, b$ 都是给定的常数。\n\n然而，出于某种不可告人的目的，N 财团不希望 CCM 被超能粒子炮彻底消灭。于是 N 财团以远程精神控制了超能粒子炮的操作员——你来阻止地球军消灭 CCM。\n\n你发现，超能粒子炮的开火模式会使得不同的粒子流的运动轨迹发生交叉，而在所有这些交叉点处部署一种名为折跃棱镜的能量反射装置就能使得超能粒子炮因过载而自爆。这样，你就可以阻止地球联合军使用超能粒子炮摧毁 CCM 而成为下一代 N 财团金牌的获得者。\n\n为了实现这个计划,你需要知道有多少对粒子流 $i, j$，满足 $i<j$ 且 $f(i) > f(j)$。", "inputFormat": "第一行四个整数 $n, m, a, b$。分别为超能粒子炮的发射管数目、CCM 被分成的区域数、以及题目描述中的 $f$ 公式中的常数。", "outputFormat": "输出一行一个整数，为运动轨迹交叉的粒子流的对数。", "hint": "对于 10%的数据，$n\\leq 5 \\times 10^3$。\n\n对于 20%的数据，$n\\leq m\\leq 10^6$。\n\n对于额外 20%的数据，$b=0$。\n\n对于 80%的数据，$1\\leq a\\leq 1000$。\n\n对于 $100\\%$ 的数据，$n \\leq m \\leq 10^9$，存在 $a'$ 满足 $a\\times a' =1 \\pmod m$，且 $\\min \\{a,a'\\} \\leq 1000, a,b<m$，$m$ 是质数。", "locale": "zh-CN"}}}
{"pid": "P5214", "type": "P", "difficulty": 5, "samples": [["7 10\n1 2\n2 3\n3 4\n4 1\n1 3\n2 4\n5 6\n6 7\n7 5\n2 5\n10\nQ\nD 2 5\nQ\nD 5 6\nD 5 7\nQ\nA 2 5\nQ\nA 5 6\nQ", "1\n2\n3\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "各省省选", "上海"], "title": "[SHOI2014] 神奇化合物", "background": "SHOI2014 day2t1", "description": "科学家最近发现了一种高分子有机化合物 SHTSC。这种物质的分子由单个或多个原子组成，原子之间通过化学键相互连接。SHTSC 十分不稳定，其原子之间的化学键经常会伴随着炫酷的声音特效和光影效果发生断裂或者重新连接。\n\n然而，令科学家们大为惊异的是，SHTSC 在变化过程中始终保持着一种特殊的性质：即不存在这样的原子序列 $a_1,a_2,\\ldots,a_n \\ (n>3)$ 满足 $a_1$ 与 $a_2$、$a_2$ 与 $a_3$、……、$a_{n-1}$ 与 $a_n$ 以及 $a_n$ 与 $a_1$ 都通过化学键相连,但它们之间却没有其他化学键相连的情况。\n\n现在科学家将 SHTSC 的原子由 $1$ 到 $n$ 标号，并告诉你 SHTSC 的初始形态以及原子之间的化学键变化情况，他们想知道在实验过程中的某些时刻 SHTSC 分裂成了多少个分子？", "inputFormat": "第一行两个整数 $n, m$。表示 SHTSC 的总原子个数以及初始的化学键数。  \n从第二行开始的 $m$ 行，每行两个整数 $a, b \\ (1 \\leq a,b \\leq n)$。表示编号为 $a, b$ 的两个原子在初始状态中有化学键相连。数据保证每对 $a, b$ 只出现一次。  \n第 $m+2$ 行有一个整数 $q$。表示实验的总操作数。  \n之后 $q$ 行中的每一行为以下三种操作当中的一种：\n1. ``A i j`` 表示 $i$ 号原子与 $j$ 号原子之间形成了一条新的化学键;\n2. ``D i j`` 表示 $i$ 号原子与 $j$ 号原子之间原有的化学键断裂了;\n3. ``Q`` 询问当前 SHTSC 分裂成了多少个不同的分子。\n数据保证所有的实验操作都是合法的。", "outputFormat": "对于每个 $Q$ 操作，输出一行一个整数，为相应时刻的分子个数。", "hint": "对于 30%的数据，$n, q\\leq 1000$。\n\n对于 100%的数据，$n\\leq 5000,m\\leq 200000,q\\leq 10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2014] Magical Compound", "background": "SHOI2014 day2t1", "description": "Scientists have recently discovered a polymer organic compound called SHTSC. The molecules of this substance consist of one or more atoms, and atoms are connected to each other by chemical bonds. SHTSC is very unstable: the chemical bonds between its atoms often break or reconnect, accompanied by cool sound effects and visual effects.\n\nHowever, what greatly surprised the scientists is that during these changes, SHTSC always maintains a special property: there does not exist an atom sequence $a_1,a_2,\\ldots,a_n \\ (n>3)$ such that $a_1$ is bonded to $a_2$, $a_2$ is bonded to $a_3$, $\\ldots$, $a_{n-1}$ is bonded to $a_n$, and $a_n$ is bonded to $a_1$, but there are no other chemical bonds among them.\n\nNow the scientists label the atoms of SHTSC from $1$ to $n$, and tell you the initial form of SHTSC and the changes of chemical bonds between atoms. They want to know, at certain moments during the experiment, into how many molecules SHTSC is split.", "inputFormat": "The first line contains two integers $n, m$, representing the total number of atoms in SHTSC and the number of initial chemical bonds.  \nStarting from the second line, the next $m$ lines each contain two integers $a, b \\ (1 \\leq a,b \\leq n)$, indicating that atoms $a$ and $b$ are connected by a chemical bond in the initial state. The data guarantees that each pair $a, b$ appears only once.  \nLine $m+2$ contains an integer $q$, representing the total number of operations in the experiment.  \nThe following $q$ lines each describe one of the three types of operations below:  \n1. ``A i j`` means a new chemical bond is formed between atom $i$ and atom $j$.  \n2. ``D i j`` means the existing chemical bond between atom $i$ and atom $j$ is broken.  \n3. ``Q`` asks how many different molecules SHTSC is currently split into.  \nThe data guarantees that all operations are valid.", "outputFormat": "For each `Q` operation, output one line with one integer, the number of molecules at that moment.", "hint": "For $30\\%$ of the testdata, $n, q \\leq 1000$.\n\nFor $100\\%$ of the testdata, $n \\leq 5000, m \\leq 200000, q \\leq 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2014] 神奇化合物", "background": "SHOI2014 day2t1", "description": "科学家最近发现了一种高分子有机化合物 SHTSC。这种物质的分子由单个或多个原子组成，原子之间通过化学键相互连接。SHTSC 十分不稳定，其原子之间的化学键经常会伴随着炫酷的声音特效和光影效果发生断裂或者重新连接。\n\n然而，令科学家们大为惊异的是，SHTSC 在变化过程中始终保持着一种特殊的性质：即不存在这样的原子序列 $a_1,a_2,\\ldots,a_n \\ (n>3)$ 满足 $a_1$ 与 $a_2$、$a_2$ 与 $a_3$、……、$a_{n-1}$ 与 $a_n$ 以及 $a_n$ 与 $a_1$ 都通过化学键相连,但它们之间却没有其他化学键相连的情况。\n\n现在科学家将 SHTSC 的原子由 $1$ 到 $n$ 标号，并告诉你 SHTSC 的初始形态以及原子之间的化学键变化情况，他们想知道在实验过程中的某些时刻 SHTSC 分裂成了多少个分子？", "inputFormat": "第一行两个整数 $n, m$。表示 SHTSC 的总原子个数以及初始的化学键数。  \n从第二行开始的 $m$ 行，每行两个整数 $a, b \\ (1 \\leq a,b \\leq n)$。表示编号为 $a, b$ 的两个原子在初始状态中有化学键相连。数据保证每对 $a, b$ 只出现一次。  \n第 $m+2$ 行有一个整数 $q$。表示实验的总操作数。  \n之后 $q$ 行中的每一行为以下三种操作当中的一种：\n1. ``A i j`` 表示 $i$ 号原子与 $j$ 号原子之间形成了一条新的化学键;\n2. ``D i j`` 表示 $i$ 号原子与 $j$ 号原子之间原有的化学键断裂了;\n3. ``Q`` 询问当前 SHTSC 分裂成了多少个不同的分子。\n数据保证所有的实验操作都是合法的。", "outputFormat": "对于每个 $Q$ 操作，输出一行一个整数，为相应时刻的分子个数。", "hint": "对于 30%的数据，$n, q\\leq 1000$。\n\n对于 100%的数据，$n\\leq 5000,m\\leq 200000,q\\leq 10000$。", "locale": "zh-CN"}}}
{"pid": "P5215", "type": "P", "difficulty": 6, "samples": [["36 3\n6\n4\n2", "1"], ["44 2\n6\n4\n", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2014", "各省省选", "上海"], "title": "[SHOI2014] 神秘金字塔", "background": "SHOI2014 day2t3", "description": "对神经组织的进化生物学研究将历史追溯到了人类社会形成之初、一个叫做 CCM 的神秘部落。\n\n考古学证据表明，CCM 一度具有高度繁华的文明。然而 CCM 的历史却似乎在一夜之间神秘地消失了。考古学家近日在大西洋底发掘出了一处 CCM 文明遗迹,有希望能够揭开 CCM 古文明失落之谜。\n\nCCM 遗迹的中央是一座巨大的石质建筑,被考古学家称之为金字塔。金字塔有这样四条性质:\n1. CCM 金字塔由完全相同的 $1 \\times 1 \\times 1$ 单位的立方体石块构成；\n2. CCM 金字塔由若干层组成，每一层的石块从正上方看都在平面上形成一个联通块。高层的石块都有低层的石块在下方作为支撑，不会有石块悬空；\n3. CCM 金字塔的每一层严格都满足左右对称和上下对称，并且所有层的对称轴是重合的，从左右/上下对称轴向两端长度/宽度非严格递减；\n4. CCM 金字塔的每一层的最大长度和最大宽度都相等，并且都是偶数（因为 CCM 人认为偶数代表了好运而奇数则会带来不幸）。\n\n然而，不幸的是，遗迹中的金字塔由于年代过于久远，已经残缺不全，难以辨认全貌。为了尽可能地还原 CCM 金字塔的实际情况，考古学家们通过其他证据估计出了 CCM 金字塔所使用的石块个数、金字塔的高度以及每一层的宽度，他们想请你帮忙计算符合上述性质的可能的金字塔个数。", "inputFormat": "第一行两个整数 $n,h$，表示 CCM 金字塔的总石块数和 CCM 金字塔的高度。  \n从第二行开始的 $h$ 行，每行一个整数 $l$，表示从最底层开始的每一层的最大长度(宽度)，保证非严格递减。", "outputFormat": "输出一行一个整数，表示可能的金字塔个数。由于方案数可能数量很大，输出答案为模 $10^9+7$ 之后的结果。", "hint": "对于 10%的数据，$h=1$。\n\n对于 30%的数据，$n\\leq 200,l\\leq 10, h\\leq 5$。\n\n对于 70%的数据，$n\\leq 800,l\\leq 20, h\\leq8$。\n\n对于 100%的数据，$n\\leq 1000, 2\\leq l\\leq 20, 1\\leq h\\leq 10$。\n\n![](https://cdn.luogu.com.cn/upload/pic/51009.png)", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2014] Mysterious Pyramid", "background": "SHOI2014 day2t3.", "description": "Evolutionary biology research on neural tissue traces history back to the very beginning of human society, to a mysterious tribe called CCM.\n\nArchaeological evidence shows that CCM once had a highly prosperous civilization. However, CCM’s history seems to have mysteriously vanished overnight. Recently, archaeologists discovered a site of CCM civilization on the Atlantic seabed, and it is hoped that this can uncover the mystery of the lost ancient CCM civilization.\n\nAt the center of the CCM site is a huge stone building, called a pyramid by archaeologists. The pyramid has the following four properties:\n1. The CCM pyramid is made of identical $1 \\times 1 \\times 1$ unit cubic stone blocks.\n2. The CCM pyramid consists of several layers. When viewed from directly above, the blocks in each layer form a connected component on the plane. Every block in an upper layer has blocks in a lower layer directly beneath it for support, so no block is floating.\n3. Each layer of the CCM pyramid strictly satisfies left-right symmetry and up-down symmetry, and the symmetry axes of all layers coincide. Along the left-right / up-down symmetry axes toward both ends, the length / width is non-increasing.\n4. In each layer, the maximum length and the maximum width are equal, and both are even (because CCM people believed even numbers represent good luck, while odd numbers bring misfortune).\n\nUnfortunately, the pyramid in the ruins is too old and has been badly damaged, making it hard to recognize its full shape. In order to reconstruct the real CCM pyramid as much as possible, archaeologists estimated, from other evidence, the number of stone blocks used, the height of the pyramid, and the width of each layer. They want you to help compute how many possible pyramids satisfy the properties above.", "inputFormat": "The first line contains two integers $n, h$, representing the total number of stone blocks in the CCM pyramid and the height of the CCM pyramid.  \nStarting from the second line, there are $h$ lines. Each line contains one integer $l$, representing the maximum length (width) of each layer from the bottom upward. It is guaranteed to be non-increasing.", "outputFormat": "Output one integer on a single line, representing the number of possible pyramids. Since the number of solutions may be very large, output the result modulo $10^9+7$.", "hint": "For $10\\%$ of the testdata, $h = 1$.\n\nFor $30\\%$ of the testdata, $n \\leq 200, l \\leq 10, h \\leq 5$.\n\nFor $70\\%$ of the testdata, $n \\leq 800, l \\leq 20, h \\leq 8$.\n\nFor $100\\%$ of the testdata, $n \\leq 1000, 2 \\leq l \\leq 20, 1 \\leq h \\leq 10$.\n\n![](https://cdn.luogu.com.cn/upload/pic/51009.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2014] 神秘金字塔", "background": "SHOI2014 day2t3", "description": "对神经组织的进化生物学研究将历史追溯到了人类社会形成之初、一个叫做 CCM 的神秘部落。\n\n考古学证据表明，CCM 一度具有高度繁华的文明。然而 CCM 的历史却似乎在一夜之间神秘地消失了。考古学家近日在大西洋底发掘出了一处 CCM 文明遗迹,有希望能够揭开 CCM 古文明失落之谜。\n\nCCM 遗迹的中央是一座巨大的石质建筑,被考古学家称之为金字塔。金字塔有这样四条性质:\n1. CCM 金字塔由完全相同的 $1 \\times 1 \\times 1$ 单位的立方体石块构成；\n2. CCM 金字塔由若干层组成，每一层的石块从正上方看都在平面上形成一个联通块。高层的石块都有低层的石块在下方作为支撑，不会有石块悬空；\n3. CCM 金字塔的每一层严格都满足左右对称和上下对称，并且所有层的对称轴是重合的，从左右/上下对称轴向两端长度/宽度非严格递减；\n4. CCM 金字塔的每一层的最大长度和最大宽度都相等，并且都是偶数（因为 CCM 人认为偶数代表了好运而奇数则会带来不幸）。\n\n然而，不幸的是，遗迹中的金字塔由于年代过于久远，已经残缺不全，难以辨认全貌。为了尽可能地还原 CCM 金字塔的实际情况，考古学家们通过其他证据估计出了 CCM 金字塔所使用的石块个数、金字塔的高度以及每一层的宽度，他们想请你帮忙计算符合上述性质的可能的金字塔个数。", "inputFormat": "第一行两个整数 $n,h$，表示 CCM 金字塔的总石块数和 CCM 金字塔的高度。  \n从第二行开始的 $h$ 行，每行一个整数 $l$，表示从最底层开始的每一层的最大长度(宽度)，保证非严格递减。", "outputFormat": "输出一行一个整数，表示可能的金字塔个数。由于方案数可能数量很大，输出答案为模 $10^9+7$ 之后的结果。", "hint": "对于 10%的数据，$h=1$。\n\n对于 30%的数据，$n\\leq 200,l\\leq 10, h\\leq 5$。\n\n对于 70%的数据，$n\\leq 800,l\\leq 20, h\\leq8$。\n\n对于 100%的数据，$n\\leq 1000, 2\\leq l\\leq 20, 1\\leq h\\leq 10$。\n\n![](https://cdn.luogu.com.cn/upload/pic/51009.png)", "locale": "zh-CN"}}}
{"pid": "P5216", "type": "P", "difficulty": 4, "samples": [["4\n2 3 6 3\n", "156"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "DLS 采花", "background": "超水的签到题", "description": "DLS 有 $N$ 个花田，每个花田里有 $a_i$ 朵花。\n\nDLS 喜欢稀奇古怪的花田，他希望重新排列花田，然后去采花。  \n但 DLS 采花又有一个癖好：他会从左往右采花。  \n若当前采到第 $i$ 个花田，在之前有一个花田的花的数量，是第 $i$ 个花田的花的数量的因子的话，那么 DLS 不会采这个花田的花。\n\n现在，DLS 想知道对于所有排列花田的方案，他能够采到的花的数量的和是多少。  \n由于答案会比较大，请对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $N$。  \n第二行是一个长度为 $N$ 的序列 $a$。\n", "outputFormat": "共一行，表示所有方案中采花的数量和对 $998244353$ 取模的结果。", "hint": "|数据百分比|限制|\n|-|-|\n|$50\\%$|$N \\le 9$|\n|$80\\%$|$N \\le 1000$|\n|$100\\%$|$N \\le 10^5,a_i \\le 10^5$|", "locale": "zh-CN", "translations": {"en": {"title": "DLS Picking Flowers.", "background": "A very easy check-in problem.", "description": "DLS has $N$ flower fields, and the $i$-th field has $a_i$ flowers.\n\nDLS likes strange and unusual flower fields. He wants to rearrange the fields and then pick flowers.  \nHowever, DLS has another habit when picking flowers: he picks from left to right.  \nWhen he reaches the $i$-th field, if among the fields before it there is a field whose number of flowers is a divisor of the number of flowers in the $i$-th field, then DLS will not pick any flowers from this field.\n\nNow, DLS wants to know, over all permutations of the fields, what the total sum of the number of flowers he can pick is.  \nSince the answer can be large, output it modulo $998244353$.", "inputFormat": "The first line contains a positive integer $N$.  \nThe second line contains a sequence $a$ of length $N$.", "outputFormat": "Output one line: the sum of the number of flowers picked over all permutations, modulo $998244353$.", "hint": "|Data Percentage|Constraints|\n|-|-|\n|$50\\%$|$N \\le 9$|\n|$80\\%$|$N \\le 1000$|\n|$100\\%$|$N \\le 10^5, a_i \\le 10^5$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "DLS 采花", "background": "超水的签到题", "description": "DLS 有 $N$ 个花田，每个花田里有 $a_i$ 朵花。\n\nDLS 喜欢稀奇古怪的花田，他希望重新排列花田，然后去采花。  \n但 DLS 采花又有一个癖好：他会从左往右采花。  \n若当前采到第 $i$ 个花田，在之前有一个花田的花的数量，是第 $i$ 个花田的花的数量的因子的话，那么 DLS 不会采这个花田的花。\n\n现在，DLS 想知道对于所有排列花田的方案，他能够采到的花的数量的和是多少。  \n由于答案会比较大，请对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $N$。  \n第二行是一个长度为 $N$ 的序列 $a$。\n", "outputFormat": "共一行，表示所有方案中采花的数量和对 $998244353$ 取模的结果。", "hint": "|数据百分比|限制|\n|-|-|\n|$50\\%$|$N \\le 9$|\n|$80\\%$|$N \\le 1000$|\n|$100\\%$|$N \\le 10^5,a_i \\le 10^5$|", "locale": "zh-CN"}}}
{"pid": "P5217", "type": "P", "difficulty": 6, "samples": [["12 6\nkimiwakawaii\nR 2 4\nP 4\nD 1\nI 0 w\nT 3\nQ 3 10", "2\nm\n5\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["平衡树", "状压 DP"], "title": "贫穷", "background": "LHF 最大的特点就是贫穷。  \nLHF 最大的爱好就是看购物节目。\n\n这天他又在看购物节目了。  \n他在节目里看到一款新型文本编辑器，~~除了价钱以外~~非常适合他这样的穷人使用。\n\n因为……它能够计算打印成本！  \n（这里的打印成本是与出现过的字母的种类数相关的）\n\n他十分心动，要求你实现这个功能。", "description": "这个文本编辑器支持以下操作：\n - $\\texttt{I x c}$，在第 $x$ 个字母后面插入一个 $c$。\n - $\\texttt{D x}$，删除第 $x$ 个字母。\n - $\\texttt{R x y}$，反转当前文本中的区间 $[x,y]$。\n - $\\texttt{P x}$，输出初始文本中第 $x$ 个字母在当前文本中的位置。特别地，若不存在，输出 $0$。\n - $\\texttt{T x}$，输出当前文本中第 $x$ 个字母。\n - $\\texttt{Q x y}$，输出当前文本中区间 $[x,y]$ 内出现过的字母的种类数。", "inputFormat": "第一行，两个整数 $n,m$，分别表示初始文本长度和操作个数。  \n第二行，一个长度为 $n$ 的字符串，表示初始文本。  \n以下 $m$ 行，每行表示一个操作。", "outputFormat": "对于所有需要输出的操作，输出结果。", "hint": "**数据范围：**\n\n对于 $20\\%$ 的数据，$n \\le 100$。  \n对于 $50\\%$ 的数据，$n \\le 10000$。  \n对于 $100\\%$ 的数据，$1 \\le n,m \\le 10^5$，文本涉及的字母仅包含小写字母。\n\n**样例解释：**\n\n 1. 文本不变，但初始文本中第 $2$ 个字母与第 $4$ 个字母的位置交换。\n 2. 当前第 $2$ 个字母是初始文本的第 $4$ 个字母。\n 3. 文本变为 $\\texttt{imiwakawaii}$。\n 4. 文本变为 $\\texttt{wimiwakawaii}$。\n 5. 这个字母为 $\\texttt{m}$。 \n 6. 这段文本为 $\\texttt{miwakawa}$，包含的字符种类的集合为 $\\{\\texttt{a},\\texttt{i},\\texttt{k},\\texttt{m},\\texttt{w}\\}$，元素个数为 $5$。", "locale": "zh-CN", "translations": {"en": {"title": "Poverty", "background": "LHF’s biggest trait is being poor.  \nLHF’s biggest hobby is watching shopping TV shows.\n\nToday, he was watching a shopping show again.  \nOn the show, he saw a new type of text editor. It was very suitable for a poor person like him ~~except for the price~~.\n\nBecause… it can calculate printing costs.  \n(The printing cost here depends on the number of different kinds of letters that have appeared.)\n\nHe was very interested and asks you to implement this feature.", "description": "This text editor supports the following operations:\n\n- $\\texttt{I x c}$: Insert a $c$ after the $x$-th letter.\n- $\\texttt{D x}$: Delete the $x$-th letter.\n- $\\texttt{R x y}$: Reverse the interval $[x,y]$ in the current text.\n- $\\texttt{P x}$: Output the position of the $x$-th letter in the initial text within the current text. In particular, if it does not exist, output $0$.\n- $\\texttt{T x}$: Output the $x$-th letter in the current text.\n- $\\texttt{Q x y}$: Output the number of different kinds of letters that have appeared in interval $[x,y]$ of the current text.", "inputFormat": "The first line contains two integers $n,m$, representing the length of the initial text and the number of operations.  \nThe second line contains a string of length $n$, representing the initial text.  \nThe next $m$ lines each describe one operation.", "outputFormat": "For every operation that requires output, print the result.", "hint": "**Constraints:**\n\nFor $20\\%$ of the testdata, $n \\le 100$.  \nFor $50\\%$ of the testdata, $n \\le 10000$.  \nFor $100\\%$ of the testdata, $1 \\le n,m \\le 10^5$, and the text contains only lowercase letters.\n\n**Sample Explanation:**\n\n1. The text does not change, but the positions of the $2$-nd and $4$-th letters in the initial text are swapped.\n2. The current $2$-nd letter is the $4$-th letter of the initial text.\n3. The text becomes $\\texttt{imiwakawaii}$.\n4. The text becomes $\\texttt{wimiwakawaii}$.\n5. This letter is $\\texttt{m}$.\n6. This segment is $\\texttt{miwakawa}$, and the set of character kinds it contains is $\\{\\texttt{a},\\texttt{i},\\texttt{k},\\texttt{m},\\texttt{w}\\}$, so the number of elements is $5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "贫穷", "background": "LHF 最大的特点就是贫穷。  \nLHF 最大的爱好就是看购物节目。\n\n这天他又在看购物节目了。  \n他在节目里看到一款新型文本编辑器，~~除了价钱以外~~非常适合他这样的穷人使用。\n\n因为……它能够计算打印成本！  \n（这里的打印成本是与出现过的字母的种类数相关的）\n\n他十分心动，要求你实现这个功能。", "description": "这个文本编辑器支持以下操作：\n - $\\texttt{I x c}$，在第 $x$ 个字母后面插入一个 $c$。\n - $\\texttt{D x}$，删除第 $x$ 个字母。\n - $\\texttt{R x y}$，反转当前文本中的区间 $[x,y]$。\n - $\\texttt{P x}$，输出初始文本中第 $x$ 个字母在当前文本中的位置。特别地，若不存在，输出 $0$。\n - $\\texttt{T x}$，输出当前文本中第 $x$ 个字母。\n - $\\texttt{Q x y}$，输出当前文本中区间 $[x,y]$ 内出现过的字母的种类数。", "inputFormat": "第一行，两个整数 $n,m$，分别表示初始文本长度和操作个数。  \n第二行，一个长度为 $n$ 的字符串，表示初始文本。  \n以下 $m$ 行，每行表示一个操作。", "outputFormat": "对于所有需要输出的操作，输出结果。", "hint": "**数据范围：**\n\n对于 $20\\%$ 的数据，$n \\le 100$。  \n对于 $50\\%$ 的数据，$n \\le 10000$。  \n对于 $100\\%$ 的数据，$1 \\le n,m \\le 10^5$，文本涉及的字母仅包含小写字母。\n\n**样例解释：**\n\n 1. 文本不变，但初始文本中第 $2$ 个字母与第 $4$ 个字母的位置交换。\n 2. 当前第 $2$ 个字母是初始文本的第 $4$ 个字母。\n 3. 文本变为 $\\texttt{imiwakawaii}$。\n 4. 文本变为 $\\texttt{wimiwakawaii}$。\n 5. 这个字母为 $\\texttt{m}$。 \n 6. 这段文本为 $\\texttt{miwakawa}$，包含的字符种类的集合为 $\\{\\texttt{a},\\texttt{i},\\texttt{k},\\texttt{m},\\texttt{w}\\}$，元素个数为 $5$。", "locale": "zh-CN"}}}
{"pid": "P5218", "type": "P", "difficulty": 6, "samples": [["5", "26"], ["16", "65243"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "无聊的水题 II", "background": "出题人过菜，只会出这种题。", "description": "DLS 是一个喜欢玩游戏的男生。\n\n今天他从朋友那里看到了 $N$ 件武器，其中第 $i$ 件武器的威力值为$i$。\n\n他观察了这 $N$ 件武器许久，打算买下其中若干件武器，但他想用买下的武器的威力值组合出任意威力值，其中每一件武器已经的威力值可以叠加，甚至可以减去。  \n例如一个威力值为 $3$ 的武器，可以组合成的威力值为 $\\dots,-6,-3,0,3,6,\\dots$。\n\n他想找出所有满足以上条件的买下装备的方案，但方案数量实在太多了。你能帮他计算一下吗？    \n答案对 $10^9+7$ 取模。", "inputFormat": "一行一个整数 $N$。", "outputFormat": "一行一个整数表示答案", "hint": "|数据百分比|限制|\n|-|-|\n|$10\\%$|$N \\le 20$|\n|$30\\%$|$N \\le 2000$|\n|$60\\%$|$N \\le 10^7$|\n|$100\\%$|$N \\le 10^{11}$|", "locale": "zh-CN", "translations": {"en": {"title": "Boring Easy Problem II", "background": "The problem setter is not skilled, and can only make this kind of problem.", "description": "DLS is a boy who likes playing games.\n\nToday, he saw $N$ weapons from his friend, where the power value of the $i$-th weapon is $i$.\n\nHe observed these $N$ weapons for a long time and plans to buy some of them, but he wants to use the power values of the weapons he buys to form any power value. The power values of each weapon can be added together, and can even be subtracted.  \nFor example, with a weapon whose power value is $3$, the power values that can be formed are $\\dots,-6,-3,0,3,6,\\dots$.\n\nHe wants to find all purchase plans that satisfy the above condition, but there are too many plans. Can you help him compute it?  \nOutput the answer modulo $10^9+7$.", "inputFormat": "One line with one integer $N$.", "outputFormat": "One line with one integer, representing the answer.", "hint": "|Percentage of testdata|Constraints|\n|-|-|\n|$10\\%$|$N \\le 20$|\n|$30\\%$|$N \\le 2000$|\n|$60\\%$|$N \\le 10^7$|\n|$100\\%$|$N \\le 10^{11}$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "无聊的水题 II", "background": "出题人过菜，只会出这种题。", "description": "DLS 是一个喜欢玩游戏的男生。\n\n今天他从朋友那里看到了 $N$ 件武器，其中第 $i$ 件武器的威力值为$i$。\n\n他观察了这 $N$ 件武器许久，打算买下其中若干件武器，但他想用买下的武器的威力值组合出任意威力值，其中每一件武器已经的威力值可以叠加，甚至可以减去。  \n例如一个威力值为 $3$ 的武器，可以组合成的威力值为 $\\dots,-6,-3,0,3,6,\\dots$。\n\n他想找出所有满足以上条件的买下装备的方案，但方案数量实在太多了。你能帮他计算一下吗？    \n答案对 $10^9+7$ 取模。", "inputFormat": "一行一个整数 $N$。", "outputFormat": "一行一个整数表示答案", "hint": "|数据百分比|限制|\n|-|-|\n|$10\\%$|$N \\le 20$|\n|$30\\%$|$N \\le 2000$|\n|$60\\%$|$N \\le 10^7$|\n|$100\\%$|$N \\le 10^{11}$|", "locale": "zh-CN"}}}
{"pid": "P5219", "type": "P", "difficulty": 6, "samples": [["3 2", "3"], ["7 4", "2520"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "无聊的水题 I", "background": "出题人过菜，只会出这种题，稍微有点卡常。", "description": "DLS 喜欢上树。  \n但是他并不想把一道数据结构题出到树上，他喜欢计 Tree。\n\n这一天，他想自己造一棵树，他手头有 $N$ 个树的节点，标号为 $1 \\sim N$，他会在它们之间连边，我们定义两颗树不同，当且仅当一对节点在一棵树中有连边，另一棵树中没有连边。  \n但他不喜欢一棵太多分叉的树，于是他想让这棵树的节点中最大的度数为 $M$。\n\nDLS 由于不太擅长理科，所以希望你帮他计算有多少棵这样的树。 \n答案对 $998244353$ 取模。", "inputFormat": "一行两个整数 $N, M$。", "outputFormat": "一行一个整数表示答案。", "hint": "|数据百分比|限制|\n|-|-|\n|$10\\%$|$N,M \\le 8$|\n|$30\\%$|$N,M \\le 100$|\n|$50\\%$|$N,M \\le 500$|\n|$70\\%$|$N,M \\le 2000$|\n|$100\\%$|$2 \\le N,M \\le 5 \\times 10^4$|", "locale": "zh-CN", "translations": {"en": {"title": "Boring Easy Problem I.", "background": "The problem setter is too weak and can only make this kind of problem. It is slightly time-limit tight.", "description": "DLS likes climbing trees.  \nHowever, he does not want to put a data structure problem onto a tree; he likes counting Tree.\n\nOne day, he wants to build a tree by himself. He has $N$ nodes, labeled from $1$ to $N$, and he will connect edges between them. We define two trees to be different if and only if there exists a pair of nodes such that they are connected by an edge in one tree, but not connected by an edge in the other tree.  \nBut he does not like a tree with too many branches, so he wants the maximum degree among all nodes in this tree to be $M$.\n\nSince DLS is not very good at math and science, he hopes you can help him compute how many such trees there are.  \nOutput the answer modulo $998244353$.", "inputFormat": "A single line with two integers $N, M$.", "outputFormat": "A single line with one integer, representing the answer.", "hint": "|Percentage of testdata|Constraints|\n|-|-|\n|$10\\%$|$N, M \\le 8$|\n|$30\\%$|$N, M \\le 100$|\n|$50\\%$|$N, M \\le 500$|\n|$70\\%$|$N, M \\le 2000$|\n|$100\\%$|$2 \\le N, M \\le 5 \\times 10^4$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "无聊的水题 I", "background": "出题人过菜，只会出这种题，稍微有点卡常。", "description": "DLS 喜欢上树。  \n但是他并不想把一道数据结构题出到树上，他喜欢计 Tree。\n\n这一天，他想自己造一棵树，他手头有 $N$ 个树的节点，标号为 $1 \\sim N$，他会在它们之间连边，我们定义两颗树不同，当且仅当一对节点在一棵树中有连边，另一棵树中没有连边。  \n但他不喜欢一棵太多分叉的树，于是他想让这棵树的节点中最大的度数为 $M$。\n\nDLS 由于不太擅长理科，所以希望你帮他计算有多少棵这样的树。 \n答案对 $998244353$ 取模。", "inputFormat": "一行两个整数 $N, M$。", "outputFormat": "一行一个整数表示答案。", "hint": "|数据百分比|限制|\n|-|-|\n|$10\\%$|$N,M \\le 8$|\n|$30\\%$|$N,M \\le 100$|\n|$50\\%$|$N,M \\le 500$|\n|$70\\%$|$N,M \\le 2000$|\n|$100\\%$|$2 \\le N,M \\le 5 \\times 10^4$|", "locale": "zh-CN"}}}
{"pid": "P5220", "type": "P", "difficulty": 6, "samples": [["5 3\n1 2 3 4 5\n1 2\n2 3\n3 4\n4 5\nQ 1 5\nC 1 2\nQ 1 5", "325\n565"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": [], "title": "特工的信息流", "background": "$\\text{TYM}$ 是一名特工。  \n$\\text{TYM}$ 所在的国家正受到侵犯，他被赋予一个任务：于城市之间传递信息。", "description": "$\\text{TYM}$ 所在的国家有 $n$ 个城市，编号为 $1,\\dots,n$，由 $n - 1$ 条双向道路连接。保证任意两个城市间都有唯一的简单路径。  \n以及，每个城市都有一个信息流的流量 $a_i$。\n\n$\\text{TYM}$ 一共要执行 $m_0$ 个任务，每个任务给定两个城市 $s,t$，其执行过程如下：  \n第一个时刻，他从城市 $s$ 出发，以每个时刻移动到下一个城市的速度，走 $s,t$ 之间的简单路径到 $t$。  \n每到达一个城市，他都会把这个城市的信息流 $a_i$ 发送到经过的每个城市。  \n我们约定，他到达一个城市的同一时刻也会把这个城市的信息流发送给这个城市。我们定义一个城市的价值为这个城市所接受到的信息流的乘积。\n\n请你求出每个任务中，$s$ 到 $t$ 的简单路径上经过的城市的价值的总和对 $20924$ 取模的结果。\n\n此外，不幸地，由于侵略者同时也在行动，所以在他执行多个任务之间，可能会有某个 $a_i$ 发生改变。\n\n他的任务总数与改变某个 $a_i$ 的次数之和为 $m$。", "inputFormat": "第一行，两个整数 $n,m$。  \n第二行，$n$ 个整数，第 $i$ 个表示第 $i$ 个城市的信息流流量 $a_i$。  \n以下 $n - 1$ 行，每行两个整数 $u,v$，表示 $u,v$ 之间有一条双向道路。  \n以下 $m$ 行，每行描述一个任务或是一次修改事件：\n  - 形如 `Q s t`，表示 $\\text{TYM}$ 从 $s$ 到 $t$ 执行了一次任务。\n  - 形如 `C x k`，表示侵略者的行动令 $a_x \\rightarrow a_x + k$。", "outputFormat": "对于每次任务，输出经过的城市收到的信息流总流量。", "hint": "**数据范围：**\n\n对于 $20\\%$ 的数据，$1 \\leq n,m \\leq 2000$；  \n对于额外的 $20\\%$ 的数据，满足 $a_i=2$，且没有修改操作；  \n对于额外的 $20\\%$ 的数据，满足道路从 $i$ 连向 $i+1$；  \n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 10^5,1 \\leq a_i \\leq 20923$。\n\n**样例解释：**\n\n第一个询问，$1 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 + 2 \\cdot 3 \\cdot 4 \\cdot 5 + 3 \\cdot 4 \\cdot 5 + 4 \\cdot 5 + 5 = 325$；  \n修改，$a_1 = 1 + 2 = 3$；  \n第二个询问，$3 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 + 2 \\cdot 3 \\cdot 4 \\cdot 5 + 3 \\cdot 4 \\cdot 5 + 4 \\cdot 5 + 5 = 565$；", "locale": "zh-CN", "translations": {"en": {"title": "Agent’s Information Flow", "background": "$\\text{TYM}$ is an agent.  \nThe country where $\\text{TYM}$ lives is being invaded, and he is given a mission: to deliver information between cities.", "description": "The country where $\\text{TYM}$ lives has $n$ cities, numbered $1,\\dots,n$, connected by $n - 1$ bidirectional roads. It is guaranteed that there is a unique simple path between any two cities.  \nAlso, each city has an information flow rate $a_i$.\n\n$\\text{TYM}$ needs to perform a total of $m_0$ missions. Each mission gives two cities $s,t$, and is carried out as follows:  \nAt the first moment, he starts from city $s$ and moves along the simple path between $s$ and $t$ to reach $t$, moving to the next city in each time unit.  \nEvery time he arrives at a city, he sends that city’s information flow $a_i$ to every city on the route he passes through.  \nWe agree that at the same moment he arrives at a city, he also sends that city’s information flow to itself. We define the value of a city as the product of all information flows received by that city.\n\nFor each mission, compute the sum of the values of the cities on the simple path from $s$ to $t$, modulo $20924$.\n\nIn addition, unfortunately, because the invaders are also acting at the same time, between his missions, some $a_i$ may change.\n\nThe total number of missions plus the number of times an $a_i$ is changed is $m$.", "inputFormat": "The first line contains two integers $n,m$.  \nThe second line contains $n$ integers; the $i$-th integer represents the information flow rate $a_i$ of city $i$.  \nThe next $n - 1$ lines each contain two integers $u,v$, indicating that there is a bidirectional road between $u$ and $v$.  \nThe next $m$ lines each describe a mission or an update event:\n- In the form `Q s t`, meaning $\\text{TYM}$ performs a mission from $s$ to $t$.\n- In the form `C x k`, meaning the invaders’ action makes $a_x \\rightarrow a_x + k$.", "outputFormat": "For each mission, output the total sum of information flow received by the cities on the route.", "hint": "**Constraints:**\n\nFor $20\\%$ of the testdata, $1 \\leq n,m \\leq 2000$.  \nFor an additional $20\\%$ of the testdata, $a_i=2$, and there are no update operations.  \nFor an additional $20\\%$ of the testdata, the roads connect $i$ to $i+1$.  \nFor $100\\%$ of the testdata, $1 \\leq n,m \\leq 10^5, 1 \\leq a_i \\leq 20923$.\n\n**Sample Explanation:**\n\nFor the first query, $1 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 + 2 \\cdot 3 \\cdot 4 \\cdot 5 + 3 \\cdot 4 \\cdot 5 + 4 \\cdot 5 + 5 = 325$.  \nUpdate: $a_1 = 1 + 2 = 3$.  \nFor the second query, $3 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 + 2 \\cdot 3 \\cdot 4 \\cdot 5 + 3 \\cdot 4 \\cdot 5 + 4 \\cdot 5 + 5 = 565$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "特工的信息流", "background": "$\\text{TYM}$ 是一名特工。  \n$\\text{TYM}$ 所在的国家正受到侵犯，他被赋予一个任务：于城市之间传递信息。", "description": "$\\text{TYM}$ 所在的国家有 $n$ 个城市，编号为 $1,\\dots,n$，由 $n - 1$ 条双向道路连接。保证任意两个城市间都有唯一的简单路径。  \n以及，每个城市都有一个信息流的流量 $a_i$。\n\n$\\text{TYM}$ 一共要执行 $m_0$ 个任务，每个任务给定两个城市 $s,t$，其执行过程如下：  \n第一个时刻，他从城市 $s$ 出发，以每个时刻移动到下一个城市的速度，走 $s,t$ 之间的简单路径到 $t$。  \n每到达一个城市，他都会把这个城市的信息流 $a_i$ 发送到经过的每个城市。  \n我们约定，他到达一个城市的同一时刻也会把这个城市的信息流发送给这个城市。我们定义一个城市的价值为这个城市所接受到的信息流的乘积。\n\n请你求出每个任务中，$s$ 到 $t$ 的简单路径上经过的城市的价值的总和对 $20924$ 取模的结果。\n\n此外，不幸地，由于侵略者同时也在行动，所以在他执行多个任务之间，可能会有某个 $a_i$ 发生改变。\n\n他的任务总数与改变某个 $a_i$ 的次数之和为 $m$。", "inputFormat": "第一行，两个整数 $n,m$。  \n第二行，$n$ 个整数，第 $i$ 个表示第 $i$ 个城市的信息流流量 $a_i$。  \n以下 $n - 1$ 行，每行两个整数 $u,v$，表示 $u,v$ 之间有一条双向道路。  \n以下 $m$ 行，每行描述一个任务或是一次修改事件：\n  - 形如 `Q s t`，表示 $\\text{TYM}$ 从 $s$ 到 $t$ 执行了一次任务。\n  - 形如 `C x k`，表示侵略者的行动令 $a_x \\rightarrow a_x + k$。", "outputFormat": "对于每次任务，输出经过的城市收到的信息流总流量。", "hint": "**数据范围：**\n\n对于 $20\\%$ 的数据，$1 \\leq n,m \\leq 2000$；  \n对于额外的 $20\\%$ 的数据，满足 $a_i=2$，且没有修改操作；  \n对于额外的 $20\\%$ 的数据，满足道路从 $i$ 连向 $i+1$；  \n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 10^5,1 \\leq a_i \\leq 20923$。\n\n**样例解释：**\n\n第一个询问，$1 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 + 2 \\cdot 3 \\cdot 4 \\cdot 5 + 3 \\cdot 4 \\cdot 5 + 4 \\cdot 5 + 5 = 325$；  \n修改，$a_1 = 1 + 2 = 3$；  \n第二个询问，$3 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 + 2 \\cdot 3 \\cdot 4 \\cdot 5 + 3 \\cdot 4 \\cdot 5 + 4 \\cdot 5 + 5 = 565$；", "locale": "zh-CN"}}}
{"pid": "P5221", "type": "P", "difficulty": 6, "samples": [["5\n", "585494\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["数学", "O2优化", "莫比乌斯反演"], "title": "Product", "background": "${\\rm CYJian}$：“听说 $\\gcd$ 和 $\\sum$ 套起来比较好玩？？那我就……”", "description": "${\\rm CYJian}$ 最近闲的玩起了 $\\gcd$。他想到了一个非常简单而有意思的式子：\n\n$$\\prod_{i=1}^N\\prod_{j=1}^N\\frac{\\operatorname{lcm}(i,j)}{\\gcd(i,j)}\\pmod{104857601}$$\n\n${\\rm CYJian}$ 已经算出来这个式子的值了。现在请你帮他验算一下吧。${\\rm CYJian}$ 只给你 $0.2\\textrm{s}$ 的时间哦。\n\n2024.5.11 **upd**: 放宽时空限制。", "inputFormat": "一行一个正整数 $N$。", "outputFormat": "一行一个正整数，表示答案模 $104857601$ 的值。", "hint": "样例解释：\n\n|$\\frac{\\operatorname{lcm}}{\\gcd}$|1|2|3|4|5|\n|:--:|:--:|:--:|:--:|:--:|:--:|\n|**1**|1|2|3|4|5|\n|**2**|2|1|6|2|10|\n|**3**|3|6|1|12|15|\n|**4**|4|2|12|1|20|\n|**5**|5|10|15|20|1|\n\n对于 $30\\%$ 的数据：$1 \\leq N \\leq 5000$。\n\n对于 $100\\%$ 的数据：$1 \\leq N \\leq 1000000$。", "locale": "zh-CN", "translations": {"en": {"title": "Product", "background": "${\\rm CYJian}$: “I heard that combining $\\gcd$ and $\\sum$ is pretty fun?? Then I will...”", "description": "${\\rm CYJian}$ has been bored recently and started playing with $\\gcd$. He came up with a very simple and interesting expression:\n\n$$\\prod_{i=1}^N\\prod_{j=1}^N\\frac{\\operatorname{lcm}(i,j)}{\\gcd(i,j)}\\pmod{104857601}$$\n\n${\\rm CYJian}$ has already computed the value of this expression. Now please help him verify it. ${\\rm CYJian}$ only gives you $0.2\\textrm{s}$ of time.\n\n2024.5.11 **upd**: The time and memory limits have been relaxed.", "inputFormat": "One line with a positive integer $N$.", "outputFormat": "One line with a positive integer, the value of the answer modulo $104857601$.", "hint": "Sample explanation:\n\n|$\\frac{\\operatorname{lcm}}{\\gcd}$|1|2|3|4|5|\n|:--:|:--:|:--:|:--:|:--:|:--:|\n|**1**|1|2|3|4|5|\n|**2**|2|1|6|2|10|\n|**3**|3|6|1|12|15|\n|**4**|4|2|12|1|20|\n|**5**|5|10|15|20|1|\n\nFor $30\\%$ of the testdata: $1 \\leq N \\leq 5000$.\n\nFor $100\\%$ of the testdata: $1 \\leq N \\leq 1000000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Product", "background": "${\\rm CYJian}$：“听说 $\\gcd$ 和 $\\sum$ 套起来比较好玩？？那我就……”", "description": "${\\rm CYJian}$ 最近闲的玩起了 $\\gcd$。他想到了一个非常简单而有意思的式子：\n\n$$\\prod_{i=1}^N\\prod_{j=1}^N\\frac{\\operatorname{lcm}(i,j)}{\\gcd(i,j)}\\pmod{104857601}$$\n\n${\\rm CYJian}$ 已经算出来这个式子的值了。现在请你帮他验算一下吧。${\\rm CYJian}$ 只给你 $0.2\\textrm{s}$ 的时间哦。\n\n2024.5.11 **upd**: 放宽时空限制。", "inputFormat": "一行一个正整数 $N$。", "outputFormat": "一行一个正整数，表示答案模 $104857601$ 的值。", "hint": "样例解释：\n\n|$\\frac{\\operatorname{lcm}}{\\gcd}$|1|2|3|4|5|\n|:--:|:--:|:--:|:--:|:--:|:--:|\n|**1**|1|2|3|4|5|\n|**2**|2|1|6|2|10|\n|**3**|3|6|1|12|15|\n|**4**|4|2|12|1|20|\n|**5**|5|10|15|20|1|\n\n对于 $30\\%$ 的数据：$1 \\leq N \\leq 5000$。\n\n对于 $100\\%$ 的数据：$1 \\leq N \\leq 1000000$。", "locale": "zh-CN"}}}
{"pid": "P5222", "type": "P", "difficulty": 6, "samples": [["3 5 2 3\n1 2\n2 4\n0\n1\n2\n", "1\n2\n2\n"], ["5 1000 5 10\n1 2\n2 3\n3 4\n4 5\n5 6\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n", "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "Game", "background": "Justin摆弄着他的棋盘和棋...突然，他想到了一个非常好玩的游戏。", "description": "棋盘可以看做是一个$N \\times M$的网格，~~由于Justin太健壮了，~~所以他把$T$个格子弄坏了。也就是说，上面没法放棋子。\n\nJustin想到的游戏是这样的：一开始，你可以选择棋盘的第一列的一些没有坏的格子，在上面各放上一枚棋子。然后，你可以执行依次以下操作若干次：\n\n1. 选择一枚棋子，将其向上或者向下移动到**相邻**的一个好的且**没有其他棋子**的格子上。\n\n2. 将所有棋子移动到下一列。若移动到下一列后有**任意一个**棋子落在坏的格子上，则不能执行此操作。\n\nJustin现在给了你$Q$个问题，每一次给你一个$k_i$，询问你最多能在第一列上放多少枚棋子使得经过若干次操作后你能将所有棋子移动到最后一列，且**所有棋子加起来**最多执行$k_i$次1操作。\n\n(感谢巨佬ywwywwyww 发现题目问题，现已修复。)\n\n\n", "inputFormat": "第一行四个正整数:$N$,$M$,$T$,$Q$\n\n接下来$T$行每行两个正整数$x_i$,$y_i$表示一个坏了的格子。\n\n接下来$Q$行每行一个正整数$k_i$表示第$i$次Justin的询问。", "outputFormat": "输出$Q$行，每行一个非负整数表示每一次询问的答案。", "hint": "第一组样例：限制为0时，可以在(3,1)放置一枚棋子，然后一直执行二操作。\n\n限制为1时，可以在(3,1)放置一枚棋子，在(2,1)放置一枚棋子，然后执行两次二操作之后对(2,3)上的棋子执行一次一操作到(1,3)，然后一直执行二操作就好了。\n\n限制为2时，和上面一样。因为如果放置三枚棋子的话是没办法执行操作二的。\n\n第二组样例：发现完全堵死了，所以根本不可能移动到最后一列。\n\n数据范围：\n\n|测试点编号|$N\\le$|$M\\le$|$T\\le$|$Q\\le$|\n|:-------:|:-------:|:-------:|:-------:|:-------:|\n|$1$|$1$|$10^6$|$1$|$10^5$|\n|$2-6$|$10$|$100$|$10$|$100$|\n|$7-10$|$20$|$100$|$50$|$10^3$|\n|$11-14$|$30$|$10^4$|$100$|$10^4$|\n|$15-20$|$50$|$10^6$|$10^3$|$10^5$|\n\n$$1 \\le x_i \\le N \\qquad 1\\le y_i \\le M \\qquad 0 \\le k_i \\le 2^{31}-1$$\n\n此题测试点$11$~$20$的数据随机生成。", "locale": "zh-CN", "translations": {"en": {"title": "Game", "background": "Justin was playing with his board and pieces... Suddenly, he came up with a very interesting game.", "description": "The board can be seen as an $N \\times M$ grid. ~~Because Justin is too strong,~~ he broke $T$ cells, meaning no piece can be placed on those cells.\n\nThe game Justin came up with works like this: At the beginning, you may choose some unbroken cells in the first column and place one piece on each of them. Then, you may perform the following operations in order any number of times:\n\n1. Choose one piece and move it up or down to an **adjacent** cell that is unbroken and **does not contain any other piece**.\n\n2. Move all pieces to the next column. If, after moving to the next column, **any** piece lands on a broken cell, then this operation cannot be performed.\n\nJustin now gives you $Q$ queries. Each time you are given a $k_i$, asking: what is the maximum number of pieces you can place in the first column such that, after some operations, you can move all pieces to the last column, and the total number of operation 1 performed by **all pieces combined** is at most $k_i$.\n\n(Thanks to ywwywwyww for finding an issue in the statement. It has now been fixed.)", "inputFormat": "The first line contains four positive integers: $N$, $M$, $T$, $Q$.\n\nThe next $T$ lines each contain two positive integers $x_i$, $y_i$, indicating a broken cell.\n\nThe next $Q$ lines each contain one positive integer $k_i$, representing Justin's $i$-th query.", "outputFormat": "Output $Q$ lines, each containing a non-negative integer indicating the answer to each query.", "hint": "In the first sample:\n\nWhen the limit is $0$, you can place one piece at $(3,1)$, then keep performing operation 2.\n\nWhen the limit is $1$, you can place one piece at $(3,1)$ and another at $(2,1)$. After performing operation 2 twice, perform operation 1 once on the piece at $(2,3)$ to move it to $(1,3)$, then keep performing operation 2.\n\nWhen the limit is $2$, it is the same as above. Because if you place three pieces, you cannot perform operation 2.\n\nIn the second sample:\n\nYou can see it is completely blocked, so it is impossible to move to the last column.\n\nConstraints:\n\n|Test Point ID|$N\\le$|$M\\le$|$T\\le$|$Q\\le$|\n|:-------:|:-------:|:-------:|:-------:|:-------:|\n|$1$|$1$|$10^6$|$1$|$10^5$|\n|$2-6$|$10$|$100$|$10$|$100$|\n|$7-10$|$20$|$100$|$50$|$10^3$|\n|$11-14$|$30$|$10^4$|$100$|$10^4$|\n|$15-20$|$50$|$10^6$|$10^3$|$10^5$|\n\n$$1 \\le x_i \\le N \\qquad 1\\le y_i \\le M \\qquad 0 \\le k_i \\le 2^{31}-1$$\n\nThe testdata for test points $11$~$20$ is randomly generated.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Game", "background": "Justin摆弄着他的棋盘和棋...突然，他想到了一个非常好玩的游戏。", "description": "棋盘可以看做是一个$N \\times M$的网格，~~由于Justin太健壮了，~~所以他把$T$个格子弄坏了。也就是说，上面没法放棋子。\n\nJustin想到的游戏是这样的：一开始，你可以选择棋盘的第一列的一些没有坏的格子，在上面各放上一枚棋子。然后，你可以执行依次以下操作若干次：\n\n1. 选择一枚棋子，将其向上或者向下移动到**相邻**的一个好的且**没有其他棋子**的格子上。\n\n2. 将所有棋子移动到下一列。若移动到下一列后有**任意一个**棋子落在坏的格子上，则不能执行此操作。\n\nJustin现在给了你$Q$个问题，每一次给你一个$k_i$，询问你最多能在第一列上放多少枚棋子使得经过若干次操作后你能将所有棋子移动到最后一列，且**所有棋子加起来**最多执行$k_i$次1操作。\n\n(感谢巨佬ywwywwyww 发现题目问题，现已修复。)\n\n\n", "inputFormat": "第一行四个正整数:$N$,$M$,$T$,$Q$\n\n接下来$T$行每行两个正整数$x_i$,$y_i$表示一个坏了的格子。\n\n接下来$Q$行每行一个正整数$k_i$表示第$i$次Justin的询问。", "outputFormat": "输出$Q$行，每行一个非负整数表示每一次询问的答案。", "hint": "第一组样例：限制为0时，可以在(3,1)放置一枚棋子，然后一直执行二操作。\n\n限制为1时，可以在(3,1)放置一枚棋子，在(2,1)放置一枚棋子，然后执行两次二操作之后对(2,3)上的棋子执行一次一操作到(1,3)，然后一直执行二操作就好了。\n\n限制为2时，和上面一样。因为如果放置三枚棋子的话是没办法执行操作二的。\n\n第二组样例：发现完全堵死了，所以根本不可能移动到最后一列。\n\n数据范围：\n\n|测试点编号|$N\\le$|$M\\le$|$T\\le$|$Q\\le$|\n|:-------:|:-------:|:-------:|:-------:|:-------:|\n|$1$|$1$|$10^6$|$1$|$10^5$|\n|$2-6$|$10$|$100$|$10$|$100$|\n|$7-10$|$20$|$100$|$50$|$10^3$|\n|$11-14$|$30$|$10^4$|$100$|$10^4$|\n|$15-20$|$50$|$10^6$|$10^3$|$10^5$|\n\n$$1 \\le x_i \\le N \\qquad 1\\le y_i \\le M \\qquad 0 \\le k_i \\le 2^{31}-1$$\n\n此题测试点$11$~$20$的数据随机生成。", "locale": "zh-CN"}}}
{"pid": "P5223", "type": "P", "difficulty": 6, "samples": [["1 1", "1\n"], ["2 2\n", "3\n"], ["3 3\n", "11\n"], ["4 3\n", "23\n"]], "limits": {"time": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "Function", "background": "${\\rm CYJian}$最近想起了[水の三角](https://www.luogu.org/problemnew/show/P5014)，他觉得太水了，于是想了一个更加有意思的版本。", "description": "给你$N$和$K$，请你求出：\n\n$$\\sum_{i=1}^{K}f[N][i] \\ (\\bmod\\ 998244353)$$\n\n其中：\n\n$$f[i][j]=f[i-1][j]+f[i][j-1]+f[i-1][j-1](i>1,j \\leq i)$$\n\n$$f[1][1] = 1 \\qquad f[i][0] = 0 \\qquad f[i][j]=0(j>i)$$", "inputFormat": "第一行两个正整数表示$N$，$K$。", "outputFormat": "一行，输出上面式子的值。", "hint": "对于$10\\%$的数据：$1 \\leq N \\leq 10^3 \\qquad 1 \\leq K \\leq 10^2$\n\n对于$30\\%$的数据：$1 \\leq N \\leq 10^6 \\qquad 1 \\leq K \\leq 10^2$\n\n对于$50\\%$的数据：$1 \\leq N \\leq 10^{18} \\qquad 1 \\leq K \\leq 10^2$\n\n对于另$20\\%$的数据：$1 \\leq N \\leq 10^6 \\qquad 1 \\leq K \\leq 10^3$\n\n对于$100\\%$的数据：$1 \\leq N \\leq 10^{18} \\qquad 1 \\leq K \\leq 10^3$\n\n保证$K \\leq N$\n\nUpd：时限改为了：第$1$~$35$的测试点时限为$600ms$，第$36$~$50$的测试点时限为$400ms$。", "locale": "zh-CN", "translations": {"en": {"title": "Function", "background": "${\\rm CYJian}$ recently thought of [Water Triangle](https://www.luogu.org/problemnew/show/P5014) and felt it was too easy, so he came up with a more interesting version.", "description": "Given $N$ and $K$, compute:\n\n$$\\sum_{i=1}^{K} f[N][i] \\ (\\bmod\\ 998244353)$$\n\nwhere:\n\n$$f[i][j] = f[i-1][j] + f[i][j-1] + f[i-1][j-1] \\ (i>1, j \\leq i)$$\n\n$$f[1][1] = 1 \\qquad f[i][0] = 0 \\qquad f[i][j] = 0 \\ (j>i)$$", "inputFormat": "The first line contains two positive integers $N$ and $K$.", "outputFormat": "Output one line containing the value of the expression above.", "hint": "Constraints:\n\nFor $10\\%$ of the testdata: $1 \\leq N \\leq 10^3 \\qquad 1 \\leq K \\leq 10^2$.\n\nFor $30\\%$ of the testdata: $1 \\leq N \\leq 10^6 \\qquad 1 \\leq K \\leq 10^2$.\n\nFor $50\\%$ of the testdata: $1 \\leq N \\leq 10^{18} \\qquad 1 \\leq K \\leq 10^2$.\n\nFor another $20\\%$ of the testdata: $1 \\leq N \\leq 10^6 \\qquad 1 \\leq K \\leq 10^3$.\n\nFor $100\\%$ of the testdata: $1 \\leq N \\leq 10^{18} \\qquad 1 \\leq K \\leq 10^3$.\n\nIt is guaranteed that $K \\leq N$.\n\nUpdate: The time limit has been changed as follows: for test points $1$~$35$, the time limit is $600 \\text{ ms}$; for test points $36$~$50$, the time limit is $400 \\text{ ms}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Function", "background": "${\\rm CYJian}$最近想起了[水の三角](https://www.luogu.org/problemnew/show/P5014)，他觉得太水了，于是想了一个更加有意思的版本。", "description": "给你$N$和$K$，请你求出：\n\n$$\\sum_{i=1}^{K}f[N][i] \\ (\\bmod\\ 998244353)$$\n\n其中：\n\n$$f[i][j]=f[i-1][j]+f[i][j-1]+f[i-1][j-1](i>1,j \\leq i)$$\n\n$$f[1][1] = 1 \\qquad f[i][0] = 0 \\qquad f[i][j]=0(j>i)$$", "inputFormat": "第一行两个正整数表示$N$，$K$。", "outputFormat": "一行，输出上面式子的值。", "hint": "对于$10\\%$的数据：$1 \\leq N \\leq 10^3 \\qquad 1 \\leq K \\leq 10^2$\n\n对于$30\\%$的数据：$1 \\leq N \\leq 10^6 \\qquad 1 \\leq K \\leq 10^2$\n\n对于$50\\%$的数据：$1 \\leq N \\leq 10^{18} \\qquad 1 \\leq K \\leq 10^2$\n\n对于另$20\\%$的数据：$1 \\leq N \\leq 10^6 \\qquad 1 \\leq K \\leq 10^3$\n\n对于$100\\%$的数据：$1 \\leq N \\leq 10^{18} \\qquad 1 \\leq K \\leq 10^3$\n\n保证$K \\leq N$\n\nUpd：时限改为了：第$1$~$35$的测试点时限为$600ms$，第$36$~$50$的测试点时限为$400ms$。", "locale": "zh-CN"}}}
{"pid": "P5224", "type": "P", "difficulty": 6, "samples": [["10 2 3\n", "342\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "Candies", "background": "JerryC 有一大袋糖果，他正以 $1\\ \\textrm{t/ms}$ 的速度食用着这一袋糖果......", "description": "JerryC 的糖果有 $N$ 箱（两两之间不同）。他一开始想挑 $M$ 箱出来，但是觉得吃起来不过瘾，所以又想要多拿一些出来。由于他比较喜欢数字 $K$，所以只要拿出来的糖的量 $x$（$x \\ge M$）满足：$x \\equiv M\\pmod{K}$，JerryC 就会得到满足感。\n\n求有多少种方案使得 JerryC 得到满足感。请输出方案数 $\\bmod\\ 1004535809$ 的结果。", "inputFormat": "一行三个非负整数 $N,M,K$。", "outputFormat": "一行一个非负整数，表示方案数 $\\bmod\\ 1004535809$ 的结果。", "hint": "样例解释：\n\n可以拿出来：$2$ 箱 $5$ 箱 $8$ 箱，组合数算一下就是了：\n\n$$\\binom{10}{2}+\\binom{10}{5}+\\binom{10}{8}=342$$\n\n数据范围：\n\n|测试点编号|$N\\le$|$K\\le$|\n|:-------:|:-------:|:-------:|\n|$1$|$1$|$1$|\n|$2-3$|$10^6$|$10$|\n|$4-8$|$10^{12}$|$100$|\n|$9-12$|$10^{15}$|$10^3$|\n|$12-20$|$10^{18}$|$10^4$|\n\n$0 \\leq M < K$。", "locale": "zh-CN", "translations": {"en": {"title": "Candies", "background": "JerryC has a big bag of candies, and he is eating this bag at a speed of $1\\ \\textrm{t/ms}$.", "description": "JerryC has $N$ boxes of candies (all different from each other). At first, he wanted to pick $M$ boxes, but he felt it was not enough, so he wants to take some more. Since he likes the number $K$, as long as the number of boxes he takes out $x$ ($x \\ge M$) satisfies $x \\equiv M\\pmod{K}$, JerryC will feel satisfied.\n\nFind how many ways can make JerryC feel satisfied. Output the number of ways $\\bmod\\ 1004535809$.", "inputFormat": "One line with three non-negative integers $N, M, K$.", "outputFormat": "One line with one non-negative integer, the number of ways $\\bmod\\ 1004535809$.", "hint": "Sample explanation:\n\nHe can take out $2$ boxes, $5$ boxes, or $8$ boxes. Just compute the combinations:\n\n$$\\binom{10}{2}+\\binom{10}{5}+\\binom{10}{8}=342$$\n\nConstraints:\n\n|Test Point ID|$N\\le$|$K\\le$|\n|:-------:|:-------:|:-------:|\n|$1$|$1$|$1$|\n|$2-3$|$10^6$|$10$|\n|$4-8$|$10^{12}$|$100$|\n|$9-12$|$10^{15}$|$10^3$|\n|$12-20$|$10^{18}$|$10^4$|\n\n$0 \\leq M < K$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Candies", "background": "JerryC 有一大袋糖果，他正以 $1\\ \\textrm{t/ms}$ 的速度食用着这一袋糖果......", "description": "JerryC 的糖果有 $N$ 箱（两两之间不同）。他一开始想挑 $M$ 箱出来，但是觉得吃起来不过瘾，所以又想要多拿一些出来。由于他比较喜欢数字 $K$，所以只要拿出来的糖的量 $x$（$x \\ge M$）满足：$x \\equiv M\\pmod{K}$，JerryC 就会得到满足感。\n\n求有多少种方案使得 JerryC 得到满足感。请输出方案数 $\\bmod\\ 1004535809$ 的结果。", "inputFormat": "一行三个非负整数 $N,M,K$。", "outputFormat": "一行一个非负整数，表示方案数 $\\bmod\\ 1004535809$ 的结果。", "hint": "样例解释：\n\n可以拿出来：$2$ 箱 $5$ 箱 $8$ 箱，组合数算一下就是了：\n\n$$\\binom{10}{2}+\\binom{10}{5}+\\binom{10}{8}=342$$\n\n数据范围：\n\n|测试点编号|$N\\le$|$K\\le$|\n|:-------:|:-------:|:-------:|\n|$1$|$1$|$1$|\n|$2-3$|$10^6$|$10$|\n|$4-8$|$10^{12}$|$100$|\n|$9-12$|$10^{15}$|$10^3$|\n|$12-20$|$10^{18}$|$10^4$|\n\n$0 \\leq M < K$。", "locale": "zh-CN"}}}
{"pid": "P5225", "type": "P", "difficulty": 7, "samples": [["3 3 3 1\n1 2\n2 3\n1 3\n1 2 3\n2 3 1\n3 1 2\n0 2 1\n2 0 3\n1 3 0\n", "1 3 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "提交答案", "Special Judge", "CTSC/CTS"], "title": "[CTSC2018] 组合数问题", "background": "", "description": "众所周知，小葱同学擅长计算，尤其擅长计算组合数，但这题不仅和组合数没什么关系，甚至和小葱也没有关系。\n\n这次我们的主人公是小何同学。众所周知，小何同学非常有钱，他买了 $K$ 台 TPU 来解决 A+B 问题。现在小何同学有 $N$ 个 A+B 问题，第 $i$ 个 A+B 问题在第 $j$ 台 TPU 上计算需要 $t_{i j}$ 的时间。与传统的 A+B 问题不一样的是，这 $N$ 个 A+B 问题之间有 $M$ 个依赖关系，如果问题 $i$ 依赖于问题 $j$，那么问题 $i$ 必须等待问题 $j$ 计算完毕，并将计算的结果传输到问题 $i$ 所在的 TPU 之后，问题 $i$ 才能开始进行计算。如果问题 $i$ 在第 $p$ 台 TPU 上进行计算，问题 $j$ 在第 $q$ 台机器上进行计算，那么问题 $i$ 的结果传输到问题 $j$ 所需要的时间为 $r_{p q}$。数据之间的传输是并行的，即同时有多台机器向一台机器传输数据，或一台机器向多台机器发送数据，都并不会影响到数据传输的速度；但我们规定数据的传输是不能转发的，即如果要从第 $i$ 台机器向第 $j$ 台机器传输某个数据，不能先传输到第 $k$ 台机器再传输到第 $j$ 台机器。\n\n虽然小何同学特别有钱，但是小何同学没有多少的时间毕竟他还要去陪妹子，所以现在小何同学希望你来帮他决定每个 A+B 问题分配到哪台机器上计算，使得所有 TPU 的计算时间总和最小或者所有任务完成的时间最小。所谓 TPU 的计算时间，其定义为 TPU 用来计算问题的时间加上所有数据传输的时间之和。所有任务完成时间定义为从第一个计算开始到最后一个计算结束的时间。\n\n虽然小何同学特别有钱，并且小何同学知道你也没有多少时间来做这个题，所以小何同学为了简化问题，对上述任务作出了如下规定：\n\n1. 问题的依赖关系之间没有环。\n\n2. 任何一个时刻，一台 TPU 只能计算一个问题，且一旦开始这个问题的计算，就不会被打断，会一直计算到这个问题计算完成。\n\n3. 如果一台 TPU 此时没有计算任何一个问题，并且存在一个或多个问题已经准备好数据可以计算，那么 TPU 会选择其中编号最小的问题开始计算。\n\n4. 一台 TPU 同时进行多个数据传输，且彼此之间互相不会影响速度，计算问题的同时也可以进行数据传输，且彼此之间的速度都不会受到影响。\n\n5. 数据不能进行转发，只能直接在相应的机器之间传输。\n\n6. 保证 $r_{ii} = 0$。\n\n7. 如果一个任务不依赖于其他任务，则该任务所需要的数据已经直接在对应机器上准备好了不需要传输。\n\n在上面的这些条件下，小何同学认为这个问题已经足够简单了，于是他愉快地去找妹子玩耍，并把这个问题交给了你。", "inputFormat": "这是一道提交答案题，共有 $10$ 组输入数据，这些数据命名为 `placement1.in` ~ `placement10.in`。\n\n第一行四个整数 $N, M, K, op$。如果 $op = 1$，则代表你要最小化 TPU 的计算时间总和，否则你需要最小化最后一个完成的任务的完成时间。\n\n接下来 $M$ 行每行两个数 $i, j$，代表问题 $j$ 依赖于问题 $i$。\n\n接下来 $N$ 行每行 $K$ 个数，代表 $t_{i j}$。\n\n接下来 $K$ 行每行 $K$ 个数，代表 $r_{i j}$。", "outputFormat": "对于每组输入数据，你需要提交相应的输出文件 `placement1.out` ~ `placement10.out`。\n\n一行 $N$ 个整数，代表每个任务被分配给哪台机器。", "hint": "本题的每个测试点有十个评分标准，如果你的答案小于等于其中 $k$ 个评分标准，那么该测试点你会得到 $k$ 分。\n\n这些标准保存在选手目录的 `placement*.ans` 中。\n\n### 提示\n为了方便你测试自己的答案，小何同学把妹子甩了然后给你写了一个模拟器。你可以在你的目录下找到一个可执行文件 `simulator`。它的用法为在终端中执行 `./simulator <input_file> <output_file>`。其中 `<input_file>` 为输入文件，`<output_file>` 为你的答案。它会告诉你你的分配方案的总计算时间和所有任务的完成时间。\n\n注意：由于陪妹子玩耍降低了小何同学的编程技巧，小何同学不能保证这个模拟器能对不是他提供的输入文件给出正确的结果。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2018] Binomial Coefficient Problem", "background": "", "description": "As everyone knows, student Xiao Cong is good at calculations, especially at computing binomial coefficients. But this problem is not only almost unrelated to binomial coefficients, it is not even related to Xiao Cong.\n\nThis time, our main character is student Xiao He. As everyone knows, Xiao He is very rich. He bought $K$ TPUs to solve A+B problems. Now Xiao He has $N$ A+B problems. The $i$-th A+B problem needs time $t_{i j}$ to be computed on the $j$-th TPU. Different from traditional A+B problems, there are $M$ dependency relations among these $N$ A+B problems. If problem $i$ depends on problem $j$, then problem $i$ must wait until problem $j$ finishes computing, and after the result is transmitted to the TPU where problem $i$ is located, problem $i$ can start computing. If problem $i$ is computed on the $p$-th TPU and problem $j$ is computed on the $q$-th machine, then the time needed to transmit the result is $r_{p q}$. Data transmission is parallel: multiple machines transmitting to one machine at the same time, or one machine sending data to multiple machines at the same time, will not affect the transmission speed. However, we规定 that data transmission cannot be forwarded: if some data needs to be transmitted from machine $i$ to machine $j$, it cannot be sent to machine $k$ first and then to machine $j$.\n\nAlthough Xiao He is very rich, he does not have much time (after all, he still needs to spend time with girls). So now Xiao He wants you to help him decide which machine each A+B problem should be assigned to, so as to minimize either the total computation time of all TPUs, or the time when all tasks are finished. The “TPU computation time” is defined as the time the TPU spends computing problems plus the sum of all data transmission time. The “all tasks finish time” is defined as the time from the start of the first computation to the end of the last computation.\n\nAlthough Xiao He is very rich, and he knows you do not have much time to do this problem either, to simplify the problem, he makes the following rules for the tasks above:\n\n1. The dependency relations form an acyclic graph.\n\n2. At any moment, one TPU can compute only one problem. Once it starts computing a problem, it will not be interrupted and will keep computing until the problem is finished.\n\n3. If a TPU is currently not computing any problem, and there exists one or more problems whose data is ready for computation, then the TPU will choose the problem with the smallest index among them to start computing.\n\n4. A TPU can perform multiple data transmissions at the same time, and they do not affect each other’s speed. It can also transmit data while computing problems, and the speeds will not affect each other.\n\n5. Data cannot be forwarded; it can only be transmitted directly between the corresponding machines.\n\n6. It is guaranteed that $r_{ii} = 0$.\n\n7. If a task does not depend on other tasks, then the data it needs is already prepared directly on the corresponding machine and does not need transmission.\n\nUnder the conditions above, Xiao He thinks this problem is simple enough. So he happily goes to have fun with girls and leaves this problem to you.", "inputFormat": "This is an output-only problem. There are $10$ groups of input data, named `placement1.in` ~ `placement10.in`.\n\nThe first line contains four integers $N, M, K, op$. If $op = 1$, it means you need to minimize the sum of TPU computation time; otherwise, you need to minimize the completion time of the last finished task.\n\nNext $M$ lines each contain two numbers $i, j$, meaning problem $j$ depends on problem $i$.\n\nNext $N$ lines each contain $K$ numbers, representing $t_{i j}$.\n\nNext $K$ lines each contain $K$ numbers, representing $r_{i j}$.", "outputFormat": "For each group of input data, you need to submit the corresponding output file `placement1.out` ~ `placement10.out`.\n\nOne line with $N$ integers, indicating which machine each task is assigned to.", "hint": "Each test point of this problem has ten scoring criteria. If your answer is less than or equal to the $k$-th criterion among them, then you will get $k$ points for that test point.\n\nThese criteria are stored in `placement*.ans` in the contestant directory.\n\n### Hint\n\nTo make it easier for you to test your own answer, Xiao He dumped the girl and then wrote a simulator for you. You can find an executable file `simulator` in your directory. Its usage is to run `./simulator <input_file> <output_file>` in the terminal, where `<input_file>` is the input file and `<output_file>` is your answer. It will tell you the total computation time of your assignment scheme and the completion time of all tasks.\n\nNote: Since spending time with girls reduced Xiao He’s programming skills, Xiao He cannot guarantee that this simulator will produce correct results for input files not provided by him.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2018] 组合数问题", "background": "", "description": "众所周知，小葱同学擅长计算，尤其擅长计算组合数，但这题不仅和组合数没什么关系，甚至和小葱也没有关系。\n\n这次我们的主人公是小何同学。众所周知，小何同学非常有钱，他买了 $K$ 台 TPU 来解决 A+B 问题。现在小何同学有 $N$ 个 A+B 问题，第 $i$ 个 A+B 问题在第 $j$ 台 TPU 上计算需要 $t_{i j}$ 的时间。与传统的 A+B 问题不一样的是，这 $N$ 个 A+B 问题之间有 $M$ 个依赖关系，如果问题 $i$ 依赖于问题 $j$，那么问题 $i$ 必须等待问题 $j$ 计算完毕，并将计算的结果传输到问题 $i$ 所在的 TPU 之后，问题 $i$ 才能开始进行计算。如果问题 $i$ 在第 $p$ 台 TPU 上进行计算，问题 $j$ 在第 $q$ 台机器上进行计算，那么问题 $i$ 的结果传输到问题 $j$ 所需要的时间为 $r_{p q}$。数据之间的传输是并行的，即同时有多台机器向一台机器传输数据，或一台机器向多台机器发送数据，都并不会影响到数据传输的速度；但我们规定数据的传输是不能转发的，即如果要从第 $i$ 台机器向第 $j$ 台机器传输某个数据，不能先传输到第 $k$ 台机器再传输到第 $j$ 台机器。\n\n虽然小何同学特别有钱，但是小何同学没有多少的时间毕竟他还要去陪妹子，所以现在小何同学希望你来帮他决定每个 A+B 问题分配到哪台机器上计算，使得所有 TPU 的计算时间总和最小或者所有任务完成的时间最小。所谓 TPU 的计算时间，其定义为 TPU 用来计算问题的时间加上所有数据传输的时间之和。所有任务完成时间定义为从第一个计算开始到最后一个计算结束的时间。\n\n虽然小何同学特别有钱，并且小何同学知道你也没有多少时间来做这个题，所以小何同学为了简化问题，对上述任务作出了如下规定：\n\n1. 问题的依赖关系之间没有环。\n\n2. 任何一个时刻，一台 TPU 只能计算一个问题，且一旦开始这个问题的计算，就不会被打断，会一直计算到这个问题计算完成。\n\n3. 如果一台 TPU 此时没有计算任何一个问题，并且存在一个或多个问题已经准备好数据可以计算，那么 TPU 会选择其中编号最小的问题开始计算。\n\n4. 一台 TPU 同时进行多个数据传输，且彼此之间互相不会影响速度，计算问题的同时也可以进行数据传输，且彼此之间的速度都不会受到影响。\n\n5. 数据不能进行转发，只能直接在相应的机器之间传输。\n\n6. 保证 $r_{ii} = 0$。\n\n7. 如果一个任务不依赖于其他任务，则该任务所需要的数据已经直接在对应机器上准备好了不需要传输。\n\n在上面的这些条件下，小何同学认为这个问题已经足够简单了，于是他愉快地去找妹子玩耍，并把这个问题交给了你。", "inputFormat": "这是一道提交答案题，共有 $10$ 组输入数据，这些数据命名为 `placement1.in` ~ `placement10.in`。\n\n第一行四个整数 $N, M, K, op$。如果 $op = 1$，则代表你要最小化 TPU 的计算时间总和，否则你需要最小化最后一个完成的任务的完成时间。\n\n接下来 $M$ 行每行两个数 $i, j$，代表问题 $j$ 依赖于问题 $i$。\n\n接下来 $N$ 行每行 $K$ 个数，代表 $t_{i j}$。\n\n接下来 $K$ 行每行 $K$ 个数，代表 $r_{i j}$。", "outputFormat": "对于每组输入数据，你需要提交相应的输出文件 `placement1.out` ~ `placement10.out`。\n\n一行 $N$ 个整数，代表每个任务被分配给哪台机器。", "hint": "本题的每个测试点有十个评分标准，如果你的答案小于等于其中 $k$ 个评分标准，那么该测试点你会得到 $k$ 分。\n\n这些标准保存在选手目录的 `placement*.ans` 中。\n\n### 提示\n为了方便你测试自己的答案，小何同学把妹子甩了然后给你写了一个模拟器。你可以在你的目录下找到一个可执行文件 `simulator`。它的用法为在终端中执行 `./simulator <input_file> <output_file>`。其中 `<input_file>` 为输入文件，`<output_file>` 为你的答案。它会告诉你你的分配方案的总计算时间和所有任务的完成时间。\n\n注意：由于陪妹子玩耍降低了小何同学的编程技巧，小何同学不能保证这个模拟器能对不是他提供的输入文件给出正确的结果。", "locale": "zh-CN"}}}
{"pid": "P5226", "type": "P", "difficulty": 6, "samples": [["5 8\n0 *\n0 *\n0 *\n0 *\n0 *\n2 0\n1 0 1 +\n1 2 1 +\n2 3\n1 1 1 +\n1 3 1 +\n1 4 1 +\n2 4\n", "0\n2\n-1\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2015", "四川", "线段树", "各省省选"], "title": "[SCOI2015] 小凸解密码", "background": "", "description": "小凸得到了一个密码盘，密码盘被等分成 $n$ 个扇形，每个扇形上有一个数字 $(0 \\sim 9)$，和一个符号 $($ `+` 或 `*` $)$。密码盘解密的方法如下：\n\n首先，选择一个位置开始，顺时针地将数字和符号分别记在数组 $A$ 和数组 $C$ 中。解密的方法如下：\n\n- $B_0 = A_0$\n- 当 $x > 0$ 时：\n  - 若 $C_x$ 为 `+`，$B_x = (A_x + A_{x - 1}) \\% 10$\n  - 若 $C_x$ 为 `*`，$B_x = (A_x \\times A_{x - 1}) \\% 10$\n\n操作完成后，可以得到一个长度为 $n$ 的数组 $B$，然后以 $B_0$ 为起点将 $B$ 数组顺时针写成一个环，解密就完成了，称得到的环为答案环。\n\n现在小凸得到了一份指令表，指令表上有 2 种操作。一种指令是修改操作，即改变原来密码盘上一个位置的数字和符号。另一种指令是询问操作，具体如下：\n\n- 首先从指令给出的位置开始完成解密，得到答案环。\n- 答案环上会有一些 $0$ 连在一起，将这些连在一起的 $0$ 称为零区间，找出其中距离 $B_0$ 最远的那个零区间，输出这个距离（零区间和 $B_0$ 的距离定义为：零区间内所有 $0$ 到 $B_0$ 距离中的最小值）。", "inputFormat": "第一行包含两个整数 $n, m$，代表密码盘大小和指令个数。\n\n接下来 $n$ 行，每行包含一个整数和一个字符，按顺时针顺序给出了密码盘上的数组和符号。\n\n接下来 $m$ 行，依次给出指令。每行第一个整数代表指令类型：\n\n- 若第一个整数为 `1`，代表本行对应指令为修改操作，之后依次有两个整数 $pos, num$ 和一个字符 $\\rm opt$，分别代表修改的位置，以及修改后该位置的数字和字符。\n- 若第一个整数为 `2`，代表本行对应指令位询问操作，之后有一个整数 $pos$，代表本次操作中解密的开始位置。\n\n密码盘上的位置标号为 $0$ 到 $n - 1$。\n\n数据保证合法，即数据中 $0 \\leq pos < n, 0 \\leq num \\leq 9$，$\\rm opt$ 为 `+` 或 `*`。", "outputFormat": "对于每个询问操作 $1$ 行，输出答案，若答案环上没有 $0$，输出 `−1`。", "hint": "**样例解释：**\n\n对于第 $1$ 个询问，答案环为 $\\{0, 0, 0, 0, 0\\}$，仅有 $1$ 个零区间，且 $B_0$ 在其中，所以距离是 $0$。  \n对于第 $2$ 个询问，答案环为 $\\{0, 0, 1, 0, 1\\}$，有 $2$ 个零区间，$[0, 1]$ 和 $B_0$ 距离是 $0$，$[3, 3]$ 和 $B_0$ 距离是 $2$，故答案为 $2$。  \n对于第 $3$ 个询问，答案环为 $\\{1, 2, 2, 2, 2\\}$，没有零区间，答案是 `−1`。\n\n**数据范围：**\n\n对于 $20 \\%$ 数据，$5 \\leq n \\leq 10^5, 5 \\leq m \\leq 1000$；  \n对于 $60 \\%$ 数据，$5 \\leq n \\leq 10^5, 5 \\leq m \\leq 10^4$；  \n对于 $100 \\%$ 数据，$5 \\leq n, m \\leq 10^5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2015] Xiao Tu Solves the Password", "background": "", "description": "Xiao Tu obtained a password dial. The dial is evenly divided into $n$ sectors. Each sector contains a digit $(0 \\sim 9)$ and a symbol ($+$ or $*$). The decryption method is as follows.\n\nFirst, choose a starting position, and record the digits and symbols clockwise into arrays $A$ and $C$, respectively. The decryption is done as follows:\n\n- $B_0 = A_0$.\n- When $x > 0$:\n  - If $C_x$ is `+`, then $B_x = (A_x + A_{x - 1}) \\% 10$.\n  - If $C_x$ is `*`, then $B_x = (A_x \\times A_{x - 1}) \\% 10$.\n\nAfter finishing the operations, you obtain an array $B$ of length $n$. Then, starting from $B_0$, write the array $B$ clockwise into a ring. The decryption is complete. The resulting ring is called the answer ring.\n\nNow Xiao Tu has an instruction list with 2 types of operations. One type is an update operation, which changes the digit and symbol at a position on the original dial. The other type is a query operation, described as follows:\n\n- First, start from the position given in the instruction and complete the decryption to obtain the answer ring.\n- On the answer ring, there may be some consecutive $0$’s. Such consecutive $0$’s are called a zero interval. Find the zero interval that is farthest from $B_0$, and output this distance (the distance between a zero interval and $B_0$ is defined as the minimum, among all $0$’s in the interval, of the distance from that $0$ to $B_0$).", "inputFormat": "The first line contains two integers $n, m$, representing the size of the password dial and the number of instructions.\n\nThe next $n$ lines each contain an integer and a character, giving the digit array and symbol array on the dial in clockwise order.\n\nThe next $m$ lines give the instructions in order. The first integer on each line indicates the instruction type:\n\n- If the first integer is `1`, this instruction is an update operation. It is followed by two integers $pos, num$ and a character $\\rm opt$, representing the position to modify, and the digit and character at that position after modification.\n- If the first integer is `2`, this instruction is a query operation. It is followed by an integer $pos$, representing the starting position for decryption in this operation.\n\nThe positions on the dial are numbered from $0$ to $n - 1$.\n\nThe testdata is guaranteed to be valid, i.e., $0 \\leq pos < n$, $0 \\leq num \\leq 9$, and $\\rm opt$ is `+` or `*`.", "outputFormat": "For each query operation, output one line with the answer. If there is no $0$ on the answer ring, output `−1`.", "hint": "**Sample Explanation:**\n\nFor the $1$st query, the answer ring is $\\{0, 0, 0, 0, 0\\}$. There is only $1$ zero interval, and $B_0$ is inside it, so the distance is $0$.  \nFor the $2$nd query, the answer ring is $\\{0, 0, 1, 0, 1\\}$. There are $2$ zero intervals. The distance between $[0, 1]$ and $B_0$ is $0$, and the distance between $[3, 3]$ and $B_0$ is $2$, so the answer is $2$.  \nFor the $3$rd query, the answer ring is $\\{1, 2, 2, 2, 2\\}$. There is no zero interval, so the answer is `−1`.\n\n**Constraints:**\n\nFor $20\\%$ of the testdata, $5 \\leq n \\leq 10^5$, $5 \\leq m \\leq 1000$.  \nFor $60\\%$ of the testdata, $5 \\leq n \\leq 10^5$, $5 \\leq m \\leq 10^4$.  \nFor $100\\%$ of the testdata, $5 \\leq n, m \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2015] 小凸解密码", "background": "", "description": "小凸得到了一个密码盘，密码盘被等分成 $n$ 个扇形，每个扇形上有一个数字 $(0 \\sim 9)$，和一个符号 $($ `+` 或 `*` $)$。密码盘解密的方法如下：\n\n首先，选择一个位置开始，顺时针地将数字和符号分别记在数组 $A$ 和数组 $C$ 中。解密的方法如下：\n\n- $B_0 = A_0$\n- 当 $x > 0$ 时：\n  - 若 $C_x$ 为 `+`，$B_x = (A_x + A_{x - 1}) \\% 10$\n  - 若 $C_x$ 为 `*`，$B_x = (A_x \\times A_{x - 1}) \\% 10$\n\n操作完成后，可以得到一个长度为 $n$ 的数组 $B$，然后以 $B_0$ 为起点将 $B$ 数组顺时针写成一个环，解密就完成了，称得到的环为答案环。\n\n现在小凸得到了一份指令表，指令表上有 2 种操作。一种指令是修改操作，即改变原来密码盘上一个位置的数字和符号。另一种指令是询问操作，具体如下：\n\n- 首先从指令给出的位置开始完成解密，得到答案环。\n- 答案环上会有一些 $0$ 连在一起，将这些连在一起的 $0$ 称为零区间，找出其中距离 $B_0$ 最远的那个零区间，输出这个距离（零区间和 $B_0$ 的距离定义为：零区间内所有 $0$ 到 $B_0$ 距离中的最小值）。", "inputFormat": "第一行包含两个整数 $n, m$，代表密码盘大小和指令个数。\n\n接下来 $n$ 行，每行包含一个整数和一个字符，按顺时针顺序给出了密码盘上的数组和符号。\n\n接下来 $m$ 行，依次给出指令。每行第一个整数代表指令类型：\n\n- 若第一个整数为 `1`，代表本行对应指令为修改操作，之后依次有两个整数 $pos, num$ 和一个字符 $\\rm opt$，分别代表修改的位置，以及修改后该位置的数字和字符。\n- 若第一个整数为 `2`，代表本行对应指令位询问操作，之后有一个整数 $pos$，代表本次操作中解密的开始位置。\n\n密码盘上的位置标号为 $0$ 到 $n - 1$。\n\n数据保证合法，即数据中 $0 \\leq pos < n, 0 \\leq num \\leq 9$，$\\rm opt$ 为 `+` 或 `*`。", "outputFormat": "对于每个询问操作 $1$ 行，输出答案，若答案环上没有 $0$，输出 `−1`。", "hint": "**样例解释：**\n\n对于第 $1$ 个询问，答案环为 $\\{0, 0, 0, 0, 0\\}$，仅有 $1$ 个零区间，且 $B_0$ 在其中，所以距离是 $0$。  \n对于第 $2$ 个询问，答案环为 $\\{0, 0, 1, 0, 1\\}$，有 $2$ 个零区间，$[0, 1]$ 和 $B_0$ 距离是 $0$，$[3, 3]$ 和 $B_0$ 距离是 $2$，故答案为 $2$。  \n对于第 $3$ 个询问，答案环为 $\\{1, 2, 2, 2, 2\\}$，没有零区间，答案是 `−1`。\n\n**数据范围：**\n\n对于 $20 \\%$ 数据，$5 \\leq n \\leq 10^5, 5 \\leq m \\leq 1000$；  \n对于 $60 \\%$ 数据，$5 \\leq n \\leq 10^5, 5 \\leq m \\leq 10^4$；  \n对于 $100 \\%$ 数据，$5 \\leq n, m \\leq 10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P5227", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2\n2 3\n3 4\n4 1\n2 4\n3\n1 5\n2 2 3\n2 1 2", "Connected\nDisconnected\nConnected"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2013", "并查集", "各省省选", "安徽", "O2优化", "动态树 LCT", "线段树分治"], "title": "[AHOI2013] 连通图", "background": null, "description": "给定一个无向连通图和若干个小集合，每个小集合包含一些边，对于每个集合，你需要确定将集合中的边删掉后改图是否保持联通。集合间的询问相互独立。\n\n定义一个图为联通的当且仅当对于任意的两个顶点，都存在一条路径连接它们。", "inputFormat": "第一行为两个整数 $n,m$，代表无向图的点数和边数。\n\n下面 $m$ 行，包含两个整数 $u,v$，代表该边连接点 $u,v$。第 $i + 1$ 行的边的编号为 $i$。保证不存在重边和自环。\n\n下面一行包含一个整数 $k$，表示集合个数。\n\n下面 $k$ 行每行描述一个集合，每行的第一个数为集合中边的个数 $c$，后面 $c$ 个数代表集合内的边。", "outputFormat": "对于每个集合，输出一行代表去掉该集合中的边后图是否联通，如果联通输出 ``Connected``，否则输出 ``Disconnected``。", "hint": "$1~\\leq~n,k~\\leq~10^5$，$1~\\leq~m~\\leq~2~\\times~10^5$，$1~\\leq~c~\\leq~4$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] Connected Graph", "background": "", "description": "Given an undirected connected graph and several small sets, each set contains some edges. For each set, you need to determine whether the graph remains connected after deleting the edges in this set. Queries for different sets are independent of each other.\n\nA graph is defined to be connected if and only if for any two vertices, there exists a path connecting them.", "inputFormat": "The first line contains two integers $n,m$, representing the number of vertices and edges in the undirected graph.\n\nThe next $m$ lines each contain two integers $u,v$, meaning this edge connects vertices $u,v$. The edge number of the line $i+1$ is $i$. It is guaranteed that there are no multiple edges or self-loops.\n\nThe next line contains an integer $k$, denoting the number of sets.\n\nThe next $k$ lines each describe a set. The first number in each line is $c$, the number of edges in the set, followed by $c$ numbers representing the edges in the set.", "outputFormat": "For each set, output one line indicating whether the graph is connected after removing the edges in the set. If it is connected, output ``Connected``; otherwise, output ``Disconnected``.", "hint": "$1~\\leq~n,k~\\leq~10^5$，$1~\\leq~m~\\leq~2~\\times~10^5$，$1~\\leq~c~\\leq~4$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 连通图", "background": null, "description": "给定一个无向连通图和若干个小集合，每个小集合包含一些边，对于每个集合，你需要确定将集合中的边删掉后改图是否保持联通。集合间的询问相互独立。\n\n定义一个图为联通的当且仅当对于任意的两个顶点，都存在一条路径连接它们。", "inputFormat": "第一行为两个整数 $n,m$，代表无向图的点数和边数。\n\n下面 $m$ 行，包含两个整数 $u,v$，代表该边连接点 $u,v$。第 $i + 1$ 行的边的编号为 $i$。保证不存在重边和自环。\n\n下面一行包含一个整数 $k$，表示集合个数。\n\n下面 $k$ 行每行描述一个集合，每行的第一个数为集合中边的个数 $c$，后面 $c$ 个数代表集合内的边。", "outputFormat": "对于每个集合，输出一行代表去掉该集合中的边后图是否联通，如果联通输出 ``Connected``，否则输出 ``Disconnected``。", "hint": "$1~\\leq~n,k~\\leq~10^5$，$1~\\leq~m~\\leq~2~\\times~10^5$，$1~\\leq~c~\\leq~4$。", "locale": "zh-CN"}}}
{"pid": "P5228", "type": "P", "difficulty": 5, "samples": [["2\n25 102", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "贪心", "2013", "各省省选", "安徽", "O2优化"], "title": "[AHOI2013] 找硬币", "background": null, "description": "小蛇是金融部部长。最近她决定制造一系列新的货币。假设她要制造的货币的面值为 $x_1,x_2,x_3\\dots$，那么 $x_1$ 必须为 $1$，$x_b$ 必须为 $x_a$ 的正整数倍（$b>a$）。例如 $1,5,125,250$ 就是一组合法的硬币序列，而 $1,5,100,125$ 就不是。不知从哪一天开始，可爱的蛇爱上了一种萌物——兔纸！从此，小蛇便走上了遇上兔纸娃娃就买的不归路。某天，小蛇看到了 $N$ 只可爱的兔纸，假设这 $N$ 只兔纸的价钱分别是 $a_1,a_2\\dots a_N$。现在小蛇想知道，在哪一组合法的硬币序列下，买这 $N$ 只兔纸所需要的硬币数最少。买兔纸时不能找零。", "inputFormat": "第一行，一个整数 $N$，表示兔纸的个数\n第二行，$N$ 个用空格隔开的整数，分别为 $N$ 只兔纸的价钱", "outputFormat": "一行，一个整数，表示最少付的钱币数。", "hint": "$1\\leq N\\leq50$\n\n$1\\leq a_i\\leq10^5$", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] Finding Coins", "background": "", "description": "Little Snake is the minister of the finance department. Recently, she decided to create a series of new currencies. Suppose the denominations she will create are $x_1, x_2, x_3 \\dots$. Then $x_1$ must be $1$, and $x_b$ must be a positive integer multiple of $x_a$ ($b > a$). For example, $1, 5, 125, 250$ is a valid coin sequence, while $1, 5, 100, 125$ is not.\n\nStarting from some day, the lovely Snake fell in love with a cute thing—“rabbit dolls” (tu zi)! From then on, she took the one-way path of buying any rabbit doll she encountered. One day, she saw $N$ cute rabbit dolls. Suppose the prices of these $N$ rabbit dolls are $a_1, a_2 \\dots a_N$. Now she wants to know: under which valid coin sequence, the total number of coins needed to buy these $N$ rabbit dolls is the smallest. No change can be given when buying rabbit dolls.", "inputFormat": "The first line contains an integer $N$, representing the number of rabbit dolls.  \nThe second line contains $N$ integers separated by spaces, representing the prices of the $N$ rabbit dolls.", "outputFormat": "One line containing an integer, representing the minimum number of coins paid.", "hint": "$1 \\leq N \\leq 50$.\n\n$1 \\leq a_i \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 找硬币", "background": null, "description": "小蛇是金融部部长。最近她决定制造一系列新的货币。假设她要制造的货币的面值为 $x_1,x_2,x_3\\dots$，那么 $x_1$ 必须为 $1$，$x_b$ 必须为 $x_a$ 的正整数倍（$b>a$）。例如 $1,5,125,250$ 就是一组合法的硬币序列，而 $1,5,100,125$ 就不是。不知从哪一天开始，可爱的蛇爱上了一种萌物——兔纸！从此，小蛇便走上了遇上兔纸娃娃就买的不归路。某天，小蛇看到了 $N$ 只可爱的兔纸，假设这 $N$ 只兔纸的价钱分别是 $a_1,a_2\\dots a_N$。现在小蛇想知道，在哪一组合法的硬币序列下，买这 $N$ 只兔纸所需要的硬币数最少。买兔纸时不能找零。", "inputFormat": "第一行，一个整数 $N$，表示兔纸的个数\n第二行，$N$ 个用空格隔开的整数，分别为 $N$ 只兔纸的价钱", "outputFormat": "一行，一个整数，表示最少付的钱币数。", "hint": "$1\\leq N\\leq50$\n\n$1\\leq a_i\\leq10^5$", "locale": "zh-CN"}}}
{"pid": "P5229", "type": "P", "difficulty": 6, "samples": [["1\n0 0 0 1 1 1", "6"], ["2 \n0 1 0 3 2 1\n1 0 0 2 3 1", "22"]], "limits": {"time": [700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "安徽", "O2优化"], "title": "[AHOI2013] 立方体", "background": "", "description": "在一个三维空间中有 $N$个立方体，第 $i$ 个立方体占据 $x_{i_1},y_{i_1},z_{i_1}$ —— $x_{i_2}, y_{i_2}, z_{i_2}$的位置。这 $N$ 个立方体可能有相交，也可能重叠。他们构成了一个大的几何图形。现在求这个几何图形的外表面积", "inputFormat": "第一行，一个整数 $N$，表示立方体的个数。\n\n第二行至第 $N+1$ 行，每行 $6$ 个用空格隔开的整数，分别表示$x_1$,$y_1$,$z_1$,$x_2$,$y_2$,$z_2$. ", "outputFormat": "一行，一个整数，表示外表面积的大小。", "hint": "所有数据 $\\in~[0,200]$。\n\n$x_1~\\leq~x_2$\n\n$y_1~\\leq~y_2$\n\n$z_1~\\leq~z_2$\n", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] Cube", "background": "", "description": "In a three-dimensional space, there are $N$ cubes. The $i$-th cube occupies the region from $(x_{i_1}, y_{i_1}, z_{i_1})$ to $(x_{i_2}, y_{i_2}, z_{i_2})$. These $N$ cubes may intersect or overlap. Together, they form a large geometric shape. Now, find the outer surface area of this shape.", "inputFormat": "The first line contains an integer $N$, representing the number of cubes.\n\nLines $2$ to $N+1$ each contain $6$ integers separated by spaces, representing $x_1$, $y_1$, $z_1$, $x_2$, $y_2$, $z_2$.", "outputFormat": "Output one line containing an integer, representing the outer surface area.", "hint": "All testdata satisfy $\\in~[0,200]$.\n\n$x_1~\\leq~x_2$.\n\n$y_1~\\leq~y_2$.\n\n$z_1~\\leq~z_2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 立方体", "background": "", "description": "在一个三维空间中有 $N$个立方体，第 $i$ 个立方体占据 $x_{i_1},y_{i_1},z_{i_1}$ —— $x_{i_2}, y_{i_2}, z_{i_2}$的位置。这 $N$ 个立方体可能有相交，也可能重叠。他们构成了一个大的几何图形。现在求这个几何图形的外表面积", "inputFormat": "第一行，一个整数 $N$，表示立方体的个数。\n\n第二行至第 $N+1$ 行，每行 $6$ 个用空格隔开的整数，分别表示$x_1$,$y_1$,$z_1$,$x_2$,$y_2$,$z_2$. ", "outputFormat": "一行，一个整数，表示外表面积的大小。", "hint": "所有数据 $\\in~[0,200]$。\n\n$x_1~\\leq~x_2$\n\n$y_1~\\leq~y_2$\n\n$z_1~\\leq~z_2$\n", "locale": "zh-CN"}}}
{"pid": "P5230", "type": "P", "difficulty": 6, "samples": [["3 \nBBW\nBBW \nBWW ", "5"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "各省省选", "安徽", "O2优化"], "title": "[AHOI2013] 好方的蛇", "background": "", "description": "有一天，可爱的蛇心花怒放，把自己变成了一个正方形！但是她改变的时候\n被induce了导致改变出了些问题.... \n \n按照预设，她应该变成一个 $N*N$ 的全黑正方形，但是这个正方形出现了一些白的格子...现在她的身体不幸出了些小反应，定义一个subsnake是一个至少有两格的全黑矩形。 \n\n![qwq](http://images.cnblogs.com/cnblogs_com/yifusuyi/1229574/o_1(1).jpg)\n\n现在蛇想让你帮忙求一下一共有多少对不相交的subsnake，答案模10007。", "inputFormat": "第一行一个整数 $N$,   接下来 $N$ 行，每行一个长度为 $N$ 的字符串，如果是 $B$，那么是黑的，如果是 $W$ 那么是白的。 ", "outputFormat": "一行一个整数，表示答案", "hint": "$1~\\leq~N~\\leq~1000$", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] The Very Square Snake", "background": "", "description": "One day, the cute snake was so happy that she turned herself into a square. But while transforming, she was induced, which caused some problems.\n\nAs planned, she should have become a completely black $N*N$ square, but some white cells appeared in this square. Now her body unfortunately had some small reactions: define a subsnake as an all-black rectangle with at least two cells.\n\n![qwq](http://images.cnblogs.com/cnblogs_com/yifusuyi/1229574/o_1(1).jpg)\n\nNow the snake wants you to help compute how many pairs of disjoint subsnakes there are. Output the answer modulo 10007.", "inputFormat": "The first line contains an integer $N$. Then follow $N$ lines, each a string of length $N$. If a character is $B$, the cell is black; if it is $W$, the cell is white.", "outputFormat": "Output one integer, the answer.", "hint": "$1~\\leq~N~\\leq~1000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 好方的蛇", "background": "", "description": "有一天，可爱的蛇心花怒放，把自己变成了一个正方形！但是她改变的时候\n被induce了导致改变出了些问题.... \n \n按照预设，她应该变成一个 $N*N$ 的全黑正方形，但是这个正方形出现了一些白的格子...现在她的身体不幸出了些小反应，定义一个subsnake是一个至少有两格的全黑矩形。 \n\n![qwq](http://images.cnblogs.com/cnblogs_com/yifusuyi/1229574/o_1(1).jpg)\n\n现在蛇想让你帮忙求一下一共有多少对不相交的subsnake，答案模10007。", "inputFormat": "第一行一个整数 $N$,   接下来 $N$ 行，每行一个长度为 $N$ 的字符串，如果是 $B$，那么是黑的，如果是 $W$ 那么是白的。 ", "outputFormat": "一行一个整数，表示答案", "hint": "$1~\\leq~N~\\leq~1000$", "locale": "zh-CN"}}}
{"pid": "P5231", "type": "P", "difficulty": 6, "samples": [["7 3\nSNNSSNS\nNNSS\nNNN\nWSEE\n", "4\n2\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "2012", "各省省选", "江苏", "后缀自动机 SAM", "O2优化", "AC 自动机", "后缀数组 SA"], "title": "[JSOI2012] 玄武密码", "background": "在美丽的玄武湖畔，鸡鸣寺边，鸡笼山前，有一块富饶而秀美的土地，人们唤作进香河。相传一日，一缕紫气从天而至，只一瞬间便消失在了进香河中。老人们说，这是玄武神灵将天书藏匿在此。 \n\n很多年后，人们终于在进香河地区发现了带有玄武密码的文字。更加神奇的是，这份带有玄武密码的文字，与玄武湖南岸台城的结构有微妙的关联。于是，漫长的破译工作开始了。", "description": " 经过分析，我们可以用东南西北四个方向来描述台城城砖的摆放，不妨用一个长度为 $n$ 的序列 $s$ 来描述，序列中的元素分别是 `E`，`S`，`W`，`N`，代表了东南西北四向，我们称之为母串。而神秘的玄武密码是由四象的图案描述而成的 $m$ 段文字。这里的四象，分别是东之青龙，西之白虎，南之朱雀，北之玄武，对东南西北四向相对应。 \n\n现在，考古工作者遇到了一个难题。对于每一段文字 $t$，求出其最长的前缀 $p$，满足 $p$ 是 $s$ 的子串。", "inputFormat": "第一行有两个整数，分别表示母串的长度 $n$ 和文字段的个数 $m$。\n\n第二行有一个长度为 $n$ 的字符串，表示母串 $s$。\n\n接下来 $m$ 行，每行一个字符串，表示一段带有玄武密码的文字 $t$。", "outputFormat": "对于每段文字，输出一行一个整数，表示最长的 $p$ 的长度。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n \\leq 100$，$m \\leq 50$。\n- 对于 $40\\%$ 的数据，保证 $n \\leq 2 \\times 10^4$，$m \\leq 2 \\times 10^3$。\n- 对于 $70\\%$ 的数据，保证 $n \\leq 10^6$，$m \\leq 2 \\times 10^4$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^7$，$1 \\leq m \\leq 10^5$，$1 \\leq |t| \\leq 100$，$s, t$ 中均只含字母 `E` `S` `W` `N`。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] Xuanwu Cipher", "background": "By the beautiful Xuanwu Lake, beside Jiming Temple and in front of Jilong Mountain, there is a rich and beautiful land called Jinxiang River. It is said that one day, a trace of purple aura came down from the sky, and in an instant it disappeared into the Jinxiang River. The elders said that this was the Xuanwu spirit hiding the heavenly book here.\n\nMany years later, people finally found writings with the Xuanwu cipher in the Jinxiang River area. Even more amazingly, these writings with the Xuanwu cipher have a subtle connection with the structure of Taicheng on the south bank of Xuanwu Lake. Thus, the long work of deciphering began.", "description": "After analysis, we can use the four directions east, south, west, and north to describe how the Taicheng bricks are arranged. Let a sequence $s$ of length $n$ describe it, where the elements are `E`, `S`, `W`, `N`, representing the four directions east, south, west, and north. We call this the main string.\n\nThe mysterious Xuanwu cipher is $m$ segments of text described by the patterns of the Four Symbols. The Four Symbols are the Azure Dragon of the east, the White Tiger of the west, the Vermilion Bird of the south, and the Xuanwu of the north, corresponding to the four directions east, south, west, and north.\n\nNow the archaeologists have met a difficult problem. For each text segment $t$, find its longest prefix $p$ such that $p$ is a substring of $s$.", "inputFormat": "The first line contains two integers, representing the length $n$ of the main string and the number $m$ of text segments.\n\nThe second line contains a string of length $n$, representing the main string $s$.\n\nThe next $m$ lines each contain a string, representing a text segment $t$ with the Xuanwu cipher.", "outputFormat": "For each text segment, output one integer per line, representing the length of the longest $p$.", "hint": "#### Constraints\n\n- For $20\\%$ of the data, $n \\leq 100$, $m \\leq 50$.\n- For $40\\%$ of the data, $n \\leq 2 \\times 10^4$, $m \\leq 2 \\times 10^3$.\n- For $70\\%$ of the data, $n \\leq 10^6$, $m \\leq 2 \\times 10^4$.\n- For $100\\%$ of the data, $1 \\leq n \\leq 10^7$, $1 \\leq m \\leq 10^5$, $1 \\leq |t| \\leq 100$, and both $s$ and $t$ contain only the letters `E` `S` `W` `N`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 玄武密码", "background": "在美丽的玄武湖畔，鸡鸣寺边，鸡笼山前，有一块富饶而秀美的土地，人们唤作进香河。相传一日，一缕紫气从天而至，只一瞬间便消失在了进香河中。老人们说，这是玄武神灵将天书藏匿在此。 \n\n很多年后，人们终于在进香河地区发现了带有玄武密码的文字。更加神奇的是，这份带有玄武密码的文字，与玄武湖南岸台城的结构有微妙的关联。于是，漫长的破译工作开始了。", "description": " 经过分析，我们可以用东南西北四个方向来描述台城城砖的摆放，不妨用一个长度为 $n$ 的序列 $s$ 来描述，序列中的元素分别是 `E`，`S`，`W`，`N`，代表了东南西北四向，我们称之为母串。而神秘的玄武密码是由四象的图案描述而成的 $m$ 段文字。这里的四象，分别是东之青龙，西之白虎，南之朱雀，北之玄武，对东南西北四向相对应。 \n\n现在，考古工作者遇到了一个难题。对于每一段文字 $t$，求出其最长的前缀 $p$，满足 $p$ 是 $s$ 的子串。", "inputFormat": "第一行有两个整数，分别表示母串的长度 $n$ 和文字段的个数 $m$。\n\n第二行有一个长度为 $n$ 的字符串，表示母串 $s$。\n\n接下来 $m$ 行，每行一个字符串，表示一段带有玄武密码的文字 $t$。", "outputFormat": "对于每段文字，输出一行一个整数，表示最长的 $p$ 的长度。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n \\leq 100$，$m \\leq 50$。\n- 对于 $40\\%$ 的数据，保证 $n \\leq 2 \\times 10^4$，$m \\leq 2 \\times 10^3$。\n- 对于 $70\\%$ 的数据，保证 $n \\leq 10^6$，$m \\leq 2 \\times 10^4$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^7$，$1 \\leq m \\leq 10^5$，$1 \\leq |t| \\leq 100$，$s, t$ 中均只含字母 `E` `S` `W` `N`。", "locale": "zh-CN"}}}
{"pid": "P5232", "type": "P", "difficulty": 6, "samples": [["2 3 \n0 0 1 \n1 1 0 \n7 4 \n1 1 7 \n0 2 3 \n0 3 4\t\n1 1 7", "0\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "各省省选", "江苏", "O2优化"], "title": "[JSOI2012] 智者的考验", "background": "", "description": "公元$1371$年，太祖下令在北极阁上大建庙宇，短短几年，鸡笼山上便建成了帝王庙、关公庙、真武庙、功臣庙、蒋王庙、都城隍庙、卞壶庙、忠烈庙、刘越王庙、曹武惠王庙共十座庙宇，统称为“十庙”。 \n\n后来，为了方便人们来鸡笼山进香礼佛，太祖下令疏通了鸡笼山下已淤塞多年的潮沟。于是，便有了“进香河”。 \n\n然而并不是所有人都可以来鸡笼山的，太祖在进香河上修建了一座石桥，中间悬挂了一块高$Rx$宽$Ry$的机关格图（如下图所示）。所有格子都是活动可翻转的，一面是白色，一面是黑色，这里我们用$0$表示白色，用$1$表示黑色。初始情况下，所有格子都是白色面朝前的。有$Rx+Ry$个机关按钮，对应$Rx$行和$Ry$列。一个按钮一旦触发，就会引发对应的一行或一列的格子同时翻转。\n \n![](https://cdn.luogu.com.cn/upload/pic/52643.png)\n\n同时，善于识天象的谋臣刘基给出了一种黑白状态，称之为“厄运星”。每一位过往前去鸡笼山的人都需要触发且只触发一个按钮，触发后，如果来访者呈“厄运星”形状，则不允许通过。 \n\n每一天要来鸡笼山的人数$N$是事先就知道的，同时天朝神威浩荡，每一位来者一开始总是有很大概率触发编号为$1$的按钮，我们不妨用数列$A_1$,$A_2$,$\\dots$,$A_N$来表示，问题保证了初始时候的$A$数列全为$1$。同时在整个问题中，$A_i$满足$1 \\leq A_i \\leq Rx+Ry$。太祖很关心那些不允许去鸡笼山的人数。于是他时不时就会询问关于“某一段时间内会有多少人不能通过“厄运星”的考验”。然而那些前来鸡笼山的文人墨客并不愿意如此单一的操作。来访者有可能会突然决定修改自己的触发按钮。更麻烦的情况，结伴而来的连续若干人会突然决定修改触发按钮并且都去触发同一个按钮。 \n\n现在这麻烦的问题交给了你。 ", "inputFormat": "输入文件第一行有$2$个数字$Rx$和$Ry$表示机关格图的高和宽（如图所示）。之后$Rx$行每一行$Ry$个数字，描述了“厄运星”形状，每一个数字都满足非$0$即$1$。 \n\n之后一行有两个数字，分别为$N$和$M$，表示人数和询问修改的次数。 \n\n之后$M$行，对应$M$次询问或修改。每一行先有一个数字$t$： \n\n若$t$为$0$：之后有$2$个数字$d$和$x$，表明将$A_d$修改为$x$。\n \n若$t$为$1$：之后有$2$个数字$l$和$r$，表明询问第$l$个人到第$r$个人中有多少人触发按钮后会出现“厄运星”形状，从而无法通过。\n\n若$t$为$2$：之后有$3$个数字$l$,$r$和$x$，表明将$A_l$,$A_{l+1}$,$\\dots$,$A_{r-1}$,$A_r$都修改为$x$。 ", "outputFormat": "对于每一次询问(即$t$为$1$的情况)，输出单独一行，一个整数描述了在区间$[l,r]$中满足要求的人数。", "hint": "对于$40\\%$的数据，$N \\leq 5000$,$M \\leq 10000$。\n\n存在$70\\%$的数据，$N \\leq 130000$,$M \\leq 30000$。\n\n对于$100\\%$的数据，$N \\leq 1000000$，$M \\leq 120000$，$Rx \\leq 2$，$Ry \\leq 3$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] The Wise One’s Trial", "background": "", "description": "In the year $1371$ AD, the Founding Emperor ordered the construction of large temples on Beijige. In just a few years, ten temples were built on Jilong Mountain: the Imperial Temple, Guan Gong Temple, Zhenwu Temple, Merit Officials Temple, Jiang Wang Temple, Capital City God Temple, Bian Hu Temple, Martyrs Temple, King Liu Yue Temple, and King Cao Wuhui Temple. Together, they were called the “Ten Temples”.\n\nLater, to make it easier for people to come to Jilong Mountain to burn incense and worship, the emperor ordered the clearing of the long-silted tidal ditch at the foot of Jilong Mountain. Thus, the “Incense River” came into being.\n\nHowever, not everyone was allowed to go to Jilong Mountain. The emperor built a stone bridge over the Incense River, and in the middle hung a mechanism grid of height $Rx$ and width $Ry$ (as shown in the figure below). All cells can be flipped; one side is white and the other side is black. Here we use $0$ to represent white and $1$ to represent black. Initially, all cells show the white side. There are $Rx+Ry$ mechanism buttons corresponding to the $Rx$ rows and the $Ry$ columns. Once a button is triggered, the cells in the corresponding row or column are flipped simultaneously.\n\n![](https://cdn.luogu.com.cn/upload/pic/52643.png)\n\nMeanwhile, the strategist Liu Ji, who was good at observing celestial phenomena, provided a black-and-white pattern called the “Misfortune Star”. Each person passing by and heading to Jilong Mountain must trigger exactly one button. After triggering, if the resulting pattern matches the “Misfortune Star”, the visitor is not allowed to pass.\n\nThe number of people coming to Jilong Mountain each day is known in advance and is $N$. Also, since the empire’s power is overwhelming, each visitor at the beginning always has a high probability of triggering button number $1$. We use a sequence $A_1, A_2, \\dots, A_N$ to represent this, and it is guaranteed that initially all elements of $A$ are $1$. Throughout the problem, $A_i$ satisfies $1 \\leq A_i \\leq Rx+Ry$. The emperor cares a lot about how many people are not allowed to go to Jilong Mountain. So from time to time, he asks: “During a certain period of time, how many people cannot pass the ‘Misfortune Star’ trial?”. However, the scholars and poets coming to Jilong Mountain do not want such a single kind of operation. A visitor may suddenly decide to change the button they will trigger. In an even more troublesome case, several consecutive people traveling together may suddenly decide to change their buttons and all trigger the same button.\n\nNow this troublesome problem is handed over to you.", "inputFormat": "The first line contains two integers $Rx$ and $Ry$, representing the height and width of the mechanism grid (as shown in the figure). Then follow $Rx$ lines, each containing $Ry$ digits, describing the “Misfortune Star” pattern. Each digit is either $0$ or $1$.\n\nThe next line contains two integers $N$ and $M$, representing the number of people and the number of queries/modifications.\n\nThen follow $M$ lines, each corresponding to one query or modification. Each line starts with an integer $t$:\n\nIf $t$ is $0$: then two integers $d$ and $x$ follow, meaning set $A_d$ to $x$.\n\nIf $t$ is $1$: then two integers $l$ and $r$ follow, meaning query how many people from the $l$-th to the $r$-th person will produce the “Misfortune Star” pattern after triggering their button, and thus cannot pass.\n\nIf $t$ is $2$: then three integers $l$, $r$, and $x$ follow, meaning set $A_l, A_{l+1}, \\dots, A_{r-1}, A_r$ all to $x$.", "outputFormat": "For each query (i.e., the case $t$ is $1$), output a single line containing one integer, describing the number of people in the interval $[l, r]$ that meet the requirement.", "hint": "For $40\\%$ of the testdata, $N \\leq 5000$, $M \\leq 10000$.\n\nFor $70\\%$ of the testdata, $N \\leq 130000$, $M \\leq 30000$.\n\nFor $100\\%$ of the testdata, $N \\leq 1000000$, $M \\leq 120000$, $Rx \\leq 2$, $Ry \\leq 3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 智者的考验", "background": "", "description": "公元$1371$年，太祖下令在北极阁上大建庙宇，短短几年，鸡笼山上便建成了帝王庙、关公庙、真武庙、功臣庙、蒋王庙、都城隍庙、卞壶庙、忠烈庙、刘越王庙、曹武惠王庙共十座庙宇，统称为“十庙”。 \n\n后来，为了方便人们来鸡笼山进香礼佛，太祖下令疏通了鸡笼山下已淤塞多年的潮沟。于是，便有了“进香河”。 \n\n然而并不是所有人都可以来鸡笼山的，太祖在进香河上修建了一座石桥，中间悬挂了一块高$Rx$宽$Ry$的机关格图（如下图所示）。所有格子都是活动可翻转的，一面是白色，一面是黑色，这里我们用$0$表示白色，用$1$表示黑色。初始情况下，所有格子都是白色面朝前的。有$Rx+Ry$个机关按钮，对应$Rx$行和$Ry$列。一个按钮一旦触发，就会引发对应的一行或一列的格子同时翻转。\n \n![](https://cdn.luogu.com.cn/upload/pic/52643.png)\n\n同时，善于识天象的谋臣刘基给出了一种黑白状态，称之为“厄运星”。每一位过往前去鸡笼山的人都需要触发且只触发一个按钮，触发后，如果来访者呈“厄运星”形状，则不允许通过。 \n\n每一天要来鸡笼山的人数$N$是事先就知道的，同时天朝神威浩荡，每一位来者一开始总是有很大概率触发编号为$1$的按钮，我们不妨用数列$A_1$,$A_2$,$\\dots$,$A_N$来表示，问题保证了初始时候的$A$数列全为$1$。同时在整个问题中，$A_i$满足$1 \\leq A_i \\leq Rx+Ry$。太祖很关心那些不允许去鸡笼山的人数。于是他时不时就会询问关于“某一段时间内会有多少人不能通过“厄运星”的考验”。然而那些前来鸡笼山的文人墨客并不愿意如此单一的操作。来访者有可能会突然决定修改自己的触发按钮。更麻烦的情况，结伴而来的连续若干人会突然决定修改触发按钮并且都去触发同一个按钮。 \n\n现在这麻烦的问题交给了你。 ", "inputFormat": "输入文件第一行有$2$个数字$Rx$和$Ry$表示机关格图的高和宽（如图所示）。之后$Rx$行每一行$Ry$个数字，描述了“厄运星”形状，每一个数字都满足非$0$即$1$。 \n\n之后一行有两个数字，分别为$N$和$M$，表示人数和询问修改的次数。 \n\n之后$M$行，对应$M$次询问或修改。每一行先有一个数字$t$： \n\n若$t$为$0$：之后有$2$个数字$d$和$x$，表明将$A_d$修改为$x$。\n \n若$t$为$1$：之后有$2$个数字$l$和$r$，表明询问第$l$个人到第$r$个人中有多少人触发按钮后会出现“厄运星”形状，从而无法通过。\n\n若$t$为$2$：之后有$3$个数字$l$,$r$和$x$，表明将$A_l$,$A_{l+1}$,$\\dots$,$A_{r-1}$,$A_r$都修改为$x$。 ", "outputFormat": "对于每一次询问(即$t$为$1$的情况)，输出单独一行，一个整数描述了在区间$[l,r]$中满足要求的人数。", "hint": "对于$40\\%$的数据，$N \\leq 5000$,$M \\leq 10000$。\n\n存在$70\\%$的数据，$N \\leq 130000$,$M \\leq 30000$。\n\n对于$100\\%$的数据，$N \\leq 1000000$，$M \\leq 120000$，$Rx \\leq 2$，$Ry \\leq 3$。", "locale": "zh-CN"}}}
{"pid": "P5233", "type": "P", "difficulty": 6, "samples": [["10 5 4", "1398595"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2012", "各省省选", "数论", "江苏", "O2优化", "群论", "置换", "Pólya 定理"], "title": "[JSOI2012] 爱之项链", "background": null, "description": "在进香河，流传着这样一段美丽的故事。zyg 与 kzn 是两个生活在进香河的孩子，一天，他们两人闹矛盾了，于是 zyg 送给了 kzn 一条精美的爱之项链。从此他们幸福生活在一起。\n\n这则故事的真实性到今天已经没有意义了，然而我们关注的是那一条精美的爱之项链。这是一条由 $N$ 个精致的戒指与一块特殊纪念品相连而成的环形，如下图中的爱心符号正是一种特殊纪念品（据说是 2012 年情人节时 zyg 特意托人订制的）。上面的每一枚戒指又是由 $M$ 个带磁性的特殊彩色球状物组成的环形。也许你会认为，这所谓的戒指，更像是一条条小项链。\n\n下图给出了一种可行的方案，其中左边描述的是单一的一枚戒指，右图描述的是项链。\n\n![](https://cdn.luogu.com.cn/upload/pic/52648.png) \n\n这里，所有带磁性的特殊彩色球状物的颜色只有 $R$ 种，这里我们用 $1$ 到 $R$ 来表示。如果一枚戒指可以通过顺时针或逆时针的旋转后与另外一枚戒指相同，则认为这是两枚相同的戒指。 \n\n对于一条爱之项链，要求满足任何相邻两枚戒指必须是不相同的。同时，特殊纪念品左右两枚戒指也必须是不同的。 \n\n现在给定 $N$，$M$ 和 $R$，问究竟有多少种不同的爱之项链。 \n\n注意： \n\n1. 特殊纪念品的插入位置不同，也许会得到不同的爱之项链。\n 2. 这里我们只考虑旋转后是否相同，不考虑翻转操作，这一点不论是对于每一枚戒指，还是对于整条项链，都是这样的。", "inputFormat": "一行，三个正整数，分别是 $N$，$M$ 和 $R$。", "outputFormat": "一行，表示有多少种不同的爱之项链。你只需要将答案模 $3214567$。", "hint": "对于 $30\\%$ 的数据，$2\\leq N \\leq 10^3$，$M \\leq 3 \\times 10^2$，$R \\leq 10^2$。\n\n对于 $60\\%$ 的数据，$2\\leq N \\leq 3 \\times 10^4$，$M \\leq 2 \\times 10^3$，$R \\leq 10^5$。\n\n对于 $80\\%$ 的数据，$2\\leq N \\leq 10^7$，$M \\leq 10^6$，$R \\leq 10^6$。\n\n对于 $100\\%$ 的数据，$2\\leq N \\leq 10^{15}$，$M \\leq 10^9$，$R \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] Necklace of Love", "background": "", "description": "In Jingxiang River, there is a beautiful story. zyg and kzn are two children who live in Jingxiang River. One day, they had a quarrel, so zyg gave kzn an exquisite Necklace of Love. From then on, they lived happily together.\n\nWhether this story is true no longer matters today. What we care about is that exquisite Necklace of Love. It is a ring formed by connecting $N$ delicate rings and one special souvenir, as shown below. The heart symbol in the picture is one kind of special souvenir (it is said that zyg specially asked someone to customize it for Valentine’s Day in 2012). Each ring above is itself a ring made of $M$ magnetic special colored spherical objects. You may think that these so-called rings look more like small necklaces.\n\nThe picture below shows one feasible design. The left picture describes a single ring, and the right picture describes the whole necklace.\n\n![](https://cdn.luogu.com.cn/upload/pic/52648.png)\n\nHere, the magnetic special colored spherical objects have only $R$ possible colors, denoted by $1$ to $R$. If one ring can become identical to another ring by rotating it clockwise or counterclockwise, then these two rings are considered the same.\n\nFor a Necklace of Love, any two adjacent rings must be different. Also, the two rings on the left and right of the special souvenir must be different.\n\nNow given $N$, $M$, and $R$, determine how many different Necklaces of Love there are.\n\nNote:\n\n1. Different insertion positions of the special souvenir may produce different Necklaces of Love.\n2. Here we only consider whether they are the same under rotation, and we do not consider flipping. This applies both to each ring and to the whole necklace.", "inputFormat": "One line with three positive integers: $N$, $M$, and $R$.", "outputFormat": "One line, the number of different Necklaces of Love. You only need to output the answer modulo $3214567$.", "hint": "For $30\\%$ of the testdata, $2\\leq N \\leq 10^3$, $M \\leq 3 \\times 10^2$, $R \\leq 10^2$.\n\nFor $60\\%$ of the testdata, $2\\leq N \\leq 3 \\times 10^4$, $M \\leq 2 \\times 10^3$, $R \\leq 10^5$.\n\nFor $80\\%$ of the testdata, $2\\leq N \\leq 10^7$, $M \\leq 10^6$, $R \\leq 10^6$.\n\nFor $100\\%$ of the testdata, $2\\leq N \\leq 10^{15}$, $M \\leq 10^9$, $R \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 爱之项链", "background": null, "description": "在进香河，流传着这样一段美丽的故事。zyg 与 kzn 是两个生活在进香河的孩子，一天，他们两人闹矛盾了，于是 zyg 送给了 kzn 一条精美的爱之项链。从此他们幸福生活在一起。\n\n这则故事的真实性到今天已经没有意义了，然而我们关注的是那一条精美的爱之项链。这是一条由 $N$ 个精致的戒指与一块特殊纪念品相连而成的环形，如下图中的爱心符号正是一种特殊纪念品（据说是 2012 年情人节时 zyg 特意托人订制的）。上面的每一枚戒指又是由 $M$ 个带磁性的特殊彩色球状物组成的环形。也许你会认为，这所谓的戒指，更像是一条条小项链。\n\n下图给出了一种可行的方案，其中左边描述的是单一的一枚戒指，右图描述的是项链。\n\n![](https://cdn.luogu.com.cn/upload/pic/52648.png) \n\n这里，所有带磁性的特殊彩色球状物的颜色只有 $R$ 种，这里我们用 $1$ 到 $R$ 来表示。如果一枚戒指可以通过顺时针或逆时针的旋转后与另外一枚戒指相同，则认为这是两枚相同的戒指。 \n\n对于一条爱之项链，要求满足任何相邻两枚戒指必须是不相同的。同时，特殊纪念品左右两枚戒指也必须是不同的。 \n\n现在给定 $N$，$M$ 和 $R$，问究竟有多少种不同的爱之项链。 \n\n注意： \n\n1. 特殊纪念品的插入位置不同，也许会得到不同的爱之项链。\n 2. 这里我们只考虑旋转后是否相同，不考虑翻转操作，这一点不论是对于每一枚戒指，还是对于整条项链，都是这样的。", "inputFormat": "一行，三个正整数，分别是 $N$，$M$ 和 $R$。", "outputFormat": "一行，表示有多少种不同的爱之项链。你只需要将答案模 $3214567$。", "hint": "对于 $30\\%$ 的数据，$2\\leq N \\leq 10^3$，$M \\leq 3 \\times 10^2$，$R \\leq 10^2$。\n\n对于 $60\\%$ 的数据，$2\\leq N \\leq 3 \\times 10^4$，$M \\leq 2 \\times 10^3$，$R \\leq 10^5$。\n\n对于 $80\\%$ 的数据，$2\\leq N \\leq 10^7$，$M \\leq 10^6$，$R \\leq 10^6$。\n\n对于 $100\\%$ 的数据，$2\\leq N \\leq 10^{15}$，$M \\leq 10^9$，$R \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5234", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2 1\n2 3 2", "-1"], ["4 3\n1 2 1\n1 3 2\n1 4 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2012", "各省省选", "江苏", "O2优化"], "title": "[JSOI2012] 越狱老虎桥", "background": "这里，是美丽的南京；这里，是秀美的进香河；这里是安逸的老虎桥。 \n\n如果说进香河的美，美在其秀美的风光，倒不如说是美在了那惬意的南京古典小巷式生活。如果说进香河的迷人，在其淳朴的民风，倒不如说是那被历史掩埋了的秘密吸引着人们好奇的心。 \n\n也许很多人都还记得，老虎桥监狱，北洋时期江南最大的监狱，在近一个世纪中，面对满清、北洋、民国、新中国几朝兴衰，名称屡次更替，沧桑尽显其中。 \n\n现在的人们，恐怕很难相信，到底有多少惊心动魄的事情曾经就在这里上演。 ", "description": "那是$1948$年的冬天，南京地下组织的一支小分队决定偷袭老虎桥监狱，救出被困的数百名人员。那时的老虎桥监狱，被$N$层电网围了起来，由内而外，依次编号为$1$,$2$,$\\dots$,$N$。第$1$层电网接有高压电。有$M$条高压线，连接了所有电网，其中第$i$条高压线连接了第$a_i$和$b_i$层电网，如果要破坏第$i$条高压线，需要至少动用$T_i$位特工。面对这么多层电网，偷袭小分队犯愁了。至少需要破坏一层电网，否则是无法偷袭成功的。\n \n然而，狡猾的间谍却知道了这件事情，为了破坏偷袭计划，敌人秘密地又增加了一条高压线，不让偷袭小分队的成员发现。 \n\n为了能够偷袭成功，不论新增的这一条秘密高压线是连接哪两层电网的，小分队都必须要破坏且仅破坏一条高压线，使得至少有一层电网不通电。注意，对于新增的高压线，我们并不知道需要多少位特工才能成功破坏。现在的问题是，偷袭小分队至少需要多少名特工呢？\n \n决战就在今夜！", "inputFormat": "第一行有$2$个整数，$N$和$M$，分别表示电网层数和高压线个数。 \n之后$M$行，每行$3$个整数，分别是$a_i$,$b_i$和$T_i$。", "outputFormat": "输出只有一行，包含一个整数，表示最少需要动用的特工人数。 \n如果计划必然失败，则输出$-1$。", "hint": "对于$30\\%$的数据，$N \\leq 200$，$M \\leq 250$。\n\n对于$70\\%$的数据，$N \\leq 50000$，$M \\leq 100000$。\n\n对于$100\\%$的数据，$N \\leq 500000$，$M \\leq 1000000$，$T \\leq 100000$。\n\n对于第二组样例，新增的高压线只有可能出现在$2$和$3$，$2$和$4$或$3$和$4$之间。\n\n如果出现在了$2$和$3$之间，则只能破坏$1$和$4$之间的高压线；如果出现在$2$和$4$之间，则只能破坏$1$和$3$之间的高压线；如果出现在$3$和$4$之间，则只能破坏$1$和$2$之间的高压线。\n\n所以，至少需要出动$3$位特工，才能应付所有可能情况。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] Prison Break: Laohuqiao", "background": "This is beautiful Nanjing. This is the graceful Jinxiang River. This is the cozy Laohuqiao.\n\nIf we say the beauty of the Jinxiang River lies in its pleasant scenery, it is better to say it lies in the relaxed, old-classical-alley style of life in Nanjing. If we say the Jinxiang River is charming because of its simple folk customs, it is better to say it is the secrets buried by history that attract people’s curiosity.\n\nPerhaps many people still remember Laohuqiao Prison, the largest prison in Jiangnan during the Beiyang period. Over nearly a century, through the rise and fall of several eras such as the Late Qing, Beiyang, the Republic of China, and New China, its name changed again and again, showing all its vicissitudes.\n\nPeople today may find it hard to believe how many thrilling events once took place right here.", "description": "It was the winter of $1948$. A small team from an underground organization in Nanjing decided to raid Laohuqiao Prison to rescue several hundred trapped people. At that time, Laohuqiao Prison was surrounded by $N$ layers of power grids, numbered from inside to outside as $1, 2, \\dots, N$. The $1$st layer of the power grid was connected to high-voltage electricity. There were $M$ high-voltage wires connecting all the grids. The $i$-th wire connected the $a_i$-th and $b_i$-th layers, and to destroy the $i$-th wire, at least $T_i$ agents were needed. Facing so many layers of grids, the raiding team was troubled. They must destroy at least one layer of the power grid, otherwise the raid cannot succeed.\n\nHowever, a cunning spy learned about this. To sabotage the raid plan, the enemy secretly added one more high-voltage wire without letting the team members discover it.\n\nTo ensure success, no matter which two layers this newly added secret high-voltage wire connects, the team must destroy exactly one high-voltage wire so that at least one layer of the power grid becomes unpowered. Note that for the newly added wire, we do not know how many agents are needed to destroy it successfully. The question is: what is the minimum number of agents the team must have?\n\nThe decisive battle is tonight!", "inputFormat": "The first line contains $2$ integers, $N$ and $M$, representing the number of grid layers and the number of high-voltage wires.\n\nThe next $M$ lines each contain $3$ integers: $a_i$, $b_i$, and $T_i$.", "outputFormat": "Output only one line containing one integer, which is the minimum number of agents needed.\n\nIf the plan is bound to fail, output $-1$.", "hint": "For $30\\%$ of the testdata, $N \\leq 200$, $M \\leq 250$.\n\nFor $70\\%$ of the testdata, $N \\leq 50000$, $M \\leq 100000$.\n\nFor $100\\%$ of the testdata, $N \\leq 500000$, $M \\leq 1000000$, $T \\leq 100000$.\n\nFor the second sample, the newly added high-voltage wire can only appear between $2$ and $3$, between $2$ and $4$, or between $3$ and $4$.\n\nIf it appears between $2$ and $3$, then the only wire that can be destroyed is the one between $1$ and $4$. If it appears between $2$ and $4$, then the only wire that can be destroyed is the one between $1$ and $3$. If it appears between $3$ and $4$, then the only wire that can be destroyed is the one between $1$ and $2$.\n\nTherefore, at least $3$ agents are needed to handle all possible cases.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 越狱老虎桥", "background": "这里，是美丽的南京；这里，是秀美的进香河；这里是安逸的老虎桥。 \n\n如果说进香河的美，美在其秀美的风光，倒不如说是美在了那惬意的南京古典小巷式生活。如果说进香河的迷人，在其淳朴的民风，倒不如说是那被历史掩埋了的秘密吸引着人们好奇的心。 \n\n也许很多人都还记得，老虎桥监狱，北洋时期江南最大的监狱，在近一个世纪中，面对满清、北洋、民国、新中国几朝兴衰，名称屡次更替，沧桑尽显其中。 \n\n现在的人们，恐怕很难相信，到底有多少惊心动魄的事情曾经就在这里上演。 ", "description": "那是$1948$年的冬天，南京地下组织的一支小分队决定偷袭老虎桥监狱，救出被困的数百名人员。那时的老虎桥监狱，被$N$层电网围了起来，由内而外，依次编号为$1$,$2$,$\\dots$,$N$。第$1$层电网接有高压电。有$M$条高压线，连接了所有电网，其中第$i$条高压线连接了第$a_i$和$b_i$层电网，如果要破坏第$i$条高压线，需要至少动用$T_i$位特工。面对这么多层电网，偷袭小分队犯愁了。至少需要破坏一层电网，否则是无法偷袭成功的。\n \n然而，狡猾的间谍却知道了这件事情，为了破坏偷袭计划，敌人秘密地又增加了一条高压线，不让偷袭小分队的成员发现。 \n\n为了能够偷袭成功，不论新增的这一条秘密高压线是连接哪两层电网的，小分队都必须要破坏且仅破坏一条高压线，使得至少有一层电网不通电。注意，对于新增的高压线，我们并不知道需要多少位特工才能成功破坏。现在的问题是，偷袭小分队至少需要多少名特工呢？\n \n决战就在今夜！", "inputFormat": "第一行有$2$个整数，$N$和$M$，分别表示电网层数和高压线个数。 \n之后$M$行，每行$3$个整数，分别是$a_i$,$b_i$和$T_i$。", "outputFormat": "输出只有一行，包含一个整数，表示最少需要动用的特工人数。 \n如果计划必然失败，则输出$-1$。", "hint": "对于$30\\%$的数据，$N \\leq 200$，$M \\leq 250$。\n\n对于$70\\%$的数据，$N \\leq 50000$，$M \\leq 100000$。\n\n对于$100\\%$的数据，$N \\leq 500000$，$M \\leq 1000000$，$T \\leq 100000$。\n\n对于第二组样例，新增的高压线只有可能出现在$2$和$3$，$2$和$4$或$3$和$4$之间。\n\n如果出现在了$2$和$3$之间，则只能破坏$1$和$4$之间的高压线；如果出现在$2$和$4$之间，则只能破坏$1$和$3$之间的高压线；如果出现在$3$和$4$之间，则只能破坏$1$和$2$之间的高压线。\n\n所以，至少需要出动$3$位特工，才能应付所有可能情况。", "locale": "zh-CN"}}}
{"pid": "P5235", "type": "P", "difficulty": 7, "samples": [["5 6 3\n2 1\n4 5\n3 5\n3 4\n2 3\n1 3\n1 2 3 4 0\n0 1 2 3 4\n2 1 0 4 3\n4 3 0 1 2", "Yes\nYes\nNo"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2017", "WC"], "title": "[WC2017] 棋盘", "background": "", "description": "小 Z 在一块棋盘上玩游戏。这块棋盘是一个由 $n$ 个顶点和 $m$ 条边组成的无向连通图，图上的顶点编号为 $[1,n]$ 中的正整数。游戏开始时，每个顶点上都放有一个棋子，每个棋子上有一个 $[0,n-1]$ 中的整数，表示棋子的编号。不同棋子的编号互不相同。\n\n每次操作时，小 Z 需要先选择棋盘上的一条边，这条边的一个端点此时放有 $0$ 号棋子。然后，小 Z 将这条边两个端点上的棋子交换。\n\n现在你已经知道棋盘的模样，以及初始状态下每个顶点上的棋子编号。小 Z 想请你回答 $q$ 个询问。每个询问指定了棋盘的目标状态，你需要回答能否通过若干次操作，将棋盘由初始状态变为这个目标状态。", "inputFormat": "第一行输入三个正整数 $n,m,q$，分别表示图中的顶点数、边数，以及询问的个数。\n\n接下来 $m$ 行，每行两个整数 $u,v(1\\leq u,v\\leq n)$，表示图中有一条连接 $u,v$ 两顶点的无向边。保证 $u\\neq v$，即图中不存在自环。保证给出的图是连通图，即任意两个顶点都可以经过若干条边而相互到达。\n\n接下来一行有$n$ 个空格隔开的整数，其中第$i$ 个整数表示初始状态下 $i$ 号顶点上的棋子的编号，保证编号都为 $[0,n-1]$ 中的整数，且两两不同。\n\n接下来 $q$ 行，每行有 $n$ 个空格隔开的整数，表示一个询问，其中第 $i$ 个整数表示目标状态中第 ii 号顶点上的棋子的编号，保证编号都为 $[0,n-1]$ 中的整数，且两两不同。", "outputFormat": "输出 $q$ 行，每行一个字符串 ```Yes``` 或者 ```No``` 作为回答。```Yes``` 表示从棋子的初始状态可以经过若干次操作而达到询问中所指定的目标状态，```No``` 表示不存在这样的操作步骤。注意：```Yes``` 和 ```No``` 的首字母都是大写的。", "hint": "样例如图所示:\n\n![](http://img.uoj.ac/problem/287/sample.jpg)\n\n对于第一组询问，只要将 $0$ 号点沿着 $5-4-3-2-1$ 的路径移动。对于第二组询问，将 $0$ 号点沿着 $5-3-1-2-3$ 移动。对于第三组询问是无解的。\n\n所有数据均满足：$1 \\leq n \\leq 50$，$1 \\leq m \\leq 100$，$1 \\leq q \\leq 1000$。\n\n| 测试点编号 | $n$       | $m$         | 数据特性 |\n| :-----: | :---------: | :-----------: | :----: |\n| 1     | $\\leq 8$ | $\\leq 15$  | 无    |\n| 2     | $\\leq 8$  | $ = n-1 $   | 无    |\n| 3     | $\\leq 50$ | $ = n-1 $   | 无    |\n| 4     | $\\leq 50$ | $ =n $      | 无    |\n| 5     | $\\leq 50$ | $ =n $      | 特性 1  |\n| 6     | $\\leq 50$ | $ =n $      | 特性 1  |\n| 7     | $\\leq 50$ | $ =n $      | 无    |\n| 8     | $\\leq 50$ | $ =n $      | 无    |\n| 9     | $\\leq 50$ | $ \\leq 100$ | 特性 2  |\n| 10    | $\\leq 50$ | $ \\leq 100$ | 特性 2  |\n| 11    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 12    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 13    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 14    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 15    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 16    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 17    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 18    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 19    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 20    | $\\leq 50$ | $ \\leq 100$ | 无    |\n\n- 特性 1：所有顶点的度数均为 $2$。\n- 特性 2：这个棋盘可以绘制在一个 $k \\times k$ 的矩形网格图上。其中 $k \\times k=n$ 且 $2k \\times (k-1)=m$。\n- 特性 3：每条边至多属于一个简单环。", "locale": "zh-CN", "translations": {"en": {"title": "[WC2017] Chessboard.", "background": "", "description": "Xiao Z is playing a game on a chessboard. This chessboard is an undirected connected graph with $n$ vertices and $m$ edges. The vertices are labeled with positive integers in $[1,n]$. At the beginning of the game, each vertex has one piece placed on it. Each piece has an integer in $[0,n-1]$, representing the piece’s label. All piece labels are distinct.\n\nIn each operation, Xiao Z must first choose an edge of the graph such that one endpoint of this edge currently has the piece labeled $0$. Then, Xiao Z swaps the pieces on the two endpoints of this edge.\n\nNow you are given the graph (the chessboard) and the initial label of the piece on each vertex. Xiao Z asks you to answer $q$ queries. Each query specifies a target state of the chessboard. You need to determine whether it is possible, using some number of operations, to transform the chessboard from the initial state into the target state.", "inputFormat": "The first line contains three positive integers $n,m,q$, representing the number of vertices, the number of edges, and the number of queries.\n\nThe next $m$ lines each contain two integers $u,v(1\\leq u,v\\leq n)$, indicating an undirected edge connecting vertices $u$ and $v$. It is guaranteed that $u\\neq v$, so there are no self-loops. It is guaranteed that the given graph is connected, i.e., any two vertices can reach each other through some edges.\n\nThe next line contains $n$ space-separated integers. The $i$-th integer denotes the label of the piece on vertex $i$ in the initial state. It is guaranteed that all labels are integers in $[0,n-1]$ and are pairwise distinct.\n\nThe next $q$ lines each contain $n$ space-separated integers describing one query. The $i$-th integer denotes the label of the piece on vertex $i$ in the target state. It is guaranteed that all labels are integers in $[0,n-1]$ and are pairwise distinct.", "outputFormat": "Output $q$ lines. Each line contains a string ```Yes``` or ```No```. ```Yes``` means the target state in the query can be reached from the initial state using some number of operations, and ```No``` means it is impossible. Note that the first letter of both ```Yes``` and ```No``` is uppercase.", "hint": "The samples are shown in the figure:\n\n![](http://img.uoj.ac/problem/287/sample.jpg)\n\nFor the first query, it is enough to move the piece labeled $0$ along the path $5-4-3-2-1$. For the second query, move the piece labeled $0$ along $5-3-1-2-3$. The third query has no solution.\n\nAll testdata satisfy: $1 \\leq n \\leq 50$, $1 \\leq m \\leq 100$, $1 \\leq q \\leq 1000$.\n\n| Test Point ID | $n$       | $m$         | Data Property |\n| :-----: | :---------: | :-----------: | :----: |\n| 1     | $\\leq 8$ | $\\leq 15$  | None    |\n| 2     | $\\leq 8$  | $ = n-1 $   | None    |\n| 3     | $\\leq 50$ | $ = n-1 $   | None    |\n| 4     | $\\leq 50$ | $ =n $      | None    |\n| 5     | $\\leq 50$ | $ =n $      | Property 1  |\n| 6     | $\\leq 50$ | $ =n $      | Property 1  |\n| 7     | $\\leq 50$ | $ =n $      | None    |\n| 8     | $\\leq 50$ | $ =n $      | None    |\n| 9     | $\\leq 50$ | $ \\leq 100$ | Property 2  |\n| 10    | $\\leq 50$ | $ \\leq 100$ | Property 2  |\n| 11    | $\\leq 50$ | $ \\leq 100$ | Property 3  |\n| 12    | $\\leq 50$ | $ \\leq 100$ | Property 3  |\n| 13    | $\\leq 50$ | $ \\leq 100$ | Property 3  |\n| 14    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 15    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 16    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 17    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 18    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 19    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 20    | $\\leq 50$ | $ \\leq 100$ | None    |\n\n- Property 1: The degree of every vertex is $2$.\n- Property 2: This chessboard can be drawn on a $k \\times k$ rectangular grid graph, where $k \\times k=n$ and $2k \\times (k-1)=m$.\n- Property 3: Each edge belongs to at most one simple cycle.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2017] 棋盘", "background": "", "description": "小 Z 在一块棋盘上玩游戏。这块棋盘是一个由 $n$ 个顶点和 $m$ 条边组成的无向连通图，图上的顶点编号为 $[1,n]$ 中的正整数。游戏开始时，每个顶点上都放有一个棋子，每个棋子上有一个 $[0,n-1]$ 中的整数，表示棋子的编号。不同棋子的编号互不相同。\n\n每次操作时，小 Z 需要先选择棋盘上的一条边，这条边的一个端点此时放有 $0$ 号棋子。然后，小 Z 将这条边两个端点上的棋子交换。\n\n现在你已经知道棋盘的模样，以及初始状态下每个顶点上的棋子编号。小 Z 想请你回答 $q$ 个询问。每个询问指定了棋盘的目标状态，你需要回答能否通过若干次操作，将棋盘由初始状态变为这个目标状态。", "inputFormat": "第一行输入三个正整数 $n,m,q$，分别表示图中的顶点数、边数，以及询问的个数。\n\n接下来 $m$ 行，每行两个整数 $u,v(1\\leq u,v\\leq n)$，表示图中有一条连接 $u,v$ 两顶点的无向边。保证 $u\\neq v$，即图中不存在自环。保证给出的图是连通图，即任意两个顶点都可以经过若干条边而相互到达。\n\n接下来一行有$n$ 个空格隔开的整数，其中第$i$ 个整数表示初始状态下 $i$ 号顶点上的棋子的编号，保证编号都为 $[0,n-1]$ 中的整数，且两两不同。\n\n接下来 $q$ 行，每行有 $n$ 个空格隔开的整数，表示一个询问，其中第 $i$ 个整数表示目标状态中第 ii 号顶点上的棋子的编号，保证编号都为 $[0,n-1]$ 中的整数，且两两不同。", "outputFormat": "输出 $q$ 行，每行一个字符串 ```Yes``` 或者 ```No``` 作为回答。```Yes``` 表示从棋子的初始状态可以经过若干次操作而达到询问中所指定的目标状态，```No``` 表示不存在这样的操作步骤。注意：```Yes``` 和 ```No``` 的首字母都是大写的。", "hint": "样例如图所示:\n\n![](http://img.uoj.ac/problem/287/sample.jpg)\n\n对于第一组询问，只要将 $0$ 号点沿着 $5-4-3-2-1$ 的路径移动。对于第二组询问，将 $0$ 号点沿着 $5-3-1-2-3$ 移动。对于第三组询问是无解的。\n\n所有数据均满足：$1 \\leq n \\leq 50$，$1 \\leq m \\leq 100$，$1 \\leq q \\leq 1000$。\n\n| 测试点编号 | $n$       | $m$         | 数据特性 |\n| :-----: | :---------: | :-----------: | :----: |\n| 1     | $\\leq 8$ | $\\leq 15$  | 无    |\n| 2     | $\\leq 8$  | $ = n-1 $   | 无    |\n| 3     | $\\leq 50$ | $ = n-1 $   | 无    |\n| 4     | $\\leq 50$ | $ =n $      | 无    |\n| 5     | $\\leq 50$ | $ =n $      | 特性 1  |\n| 6     | $\\leq 50$ | $ =n $      | 特性 1  |\n| 7     | $\\leq 50$ | $ =n $      | 无    |\n| 8     | $\\leq 50$ | $ =n $      | 无    |\n| 9     | $\\leq 50$ | $ \\leq 100$ | 特性 2  |\n| 10    | $\\leq 50$ | $ \\leq 100$ | 特性 2  |\n| 11    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 12    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 13    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 14    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 15    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 16    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 17    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 18    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 19    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 20    | $\\leq 50$ | $ \\leq 100$ | 无    |\n\n- 特性 1：所有顶点的度数均为 $2$。\n- 特性 2：这个棋盘可以绘制在一个 $k \\times k$ 的矩形网格图上。其中 $k \\times k=n$ 且 $2k \\times (k-1)=m$。\n- 特性 3：每条边至多属于一个简单环。", "locale": "zh-CN"}}}
{"pid": "P5236", "type": "P", "difficulty": 6, "samples": [["9 10 2\n1 2 1\n1 4 1\n3 4 1\n2 3 1\n3 7 1\n7 8 2\n7 9 2\n1 5 3\n1 6 4\n5 6 1\n1 9\n5 7", "5\n6"], ["9 10 3\n1 2 1\n2 3 1\n2 4 4\n3 4 2\n4 5 1\n5 6 1\n6 7 2\n7 8 2\n8 9 4\n5 9 2\n1 9\n5 8\n3 4", "7\n5\n2"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "强连通分量", "仙人掌", "树链剖分", "模板题"], "title": "【模板】静态仙人掌", "background": "这是一道静态仙人掌(Block Forest Data Structure)的模板题。   \n如果您不知道什么是仙人掌，那么此处给出无向仙人掌图的定义：  \n>任意一条边至多只出现在一条简单回路的无向连通图称为仙人掌。", "description": "给你一个有 $n$ 个点和 $m$ 条边的仙人掌图，和 $q$ 组询问  \n每次询问两个点 $u,v$，求两点之间的最短路。\n\n保证输入数据没有重边。", "inputFormat": "第一行三个正整数 $n,m,q$，意义如题目描述。  \n接下来 $m$ 行，每行三个正整数 $u,v,w$，表示 $u,v$ 之间有一条权值为 $w$ 的无向边。   \n然后 $q$ 行，每行两个正整数 $u,v$，询问 $u$ 到 $v$ 的最短路。", "outputFormat": "$q$ 行，每行一个正整数，对应一次询问的结果。", "hint": "**样例1解释：**  \n样例1中的仙人掌是这个样子的：  \n![](https://cdn.luogu.com.cn/upload/pic/52854.png)   \n询问有两个，分别是询问 $1\\rightarrow 9$ 和 $5\\rightarrow 7$ 的最短路  \n显然答案分别为 $5$ 和 $6$。\n\n**数据范围：**   \n$1\\le n,q \\le 10000$      \n$1\\le m \\le 20000$   \n$1\\le w \\le 10^5$     \n\n保证输入数据没有重边。\n\n请注意时限为 $300\\text{ms}$      \n", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Static Cactus", "background": "This is a template problem for the Static Cactus (Block Forest Data Structure).  \nIf you do not know what a cactus is, here is the definition of an undirected cactus graph:  \n> An undirected connected graph in which any edge appears in at most one simple cycle is called a cactus.", "description": "You are given a cactus graph with $n$ vertices and $m$ edges, and $q$ queries.  \nEach query gives two vertices $u, v$. Find the shortest path distance between them.\n\nThe input is guaranteed to have no multiple edges.", "inputFormat": "The first line contains three positive integers $n, m, q$, with the meanings as described above.  \nThe next $m$ lines each contain three positive integers $u, v, w$, indicating an undirected edge between $u$ and $v$ with weight $w$.  \nThen follow $q$ lines, each containing two positive integers $u, v$, asking for the shortest path from $u$ to $v$.", "outputFormat": "Output $q$ lines, each with one positive integer, the answer for the corresponding query.", "hint": "**Explanation for Sample 1:**  \nThe cactus in Sample 1 looks like this:  \n![](https://cdn.luogu.com.cn/upload/pic/52854.png)  \nThere are two queries: the shortest path for $1\\rightarrow 9$ and for $5\\rightarrow 7$.  \nObviously, the answers are $5$ and $6$.\n\n**Constraints:**  \n$1\\le n, q \\le 10000$  \n$1\\le m \\le 20000$  \n$1\\le w \\le 10^5$  \n\nThe input is guaranteed to have no multiple edges.\n\nNote that the time limit is $300\\text{ms}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】静态仙人掌", "background": "这是一道静态仙人掌(Block Forest Data Structure)的模板题。   \n如果您不知道什么是仙人掌，那么此处给出无向仙人掌图的定义：  \n>任意一条边至多只出现在一条简单回路的无向连通图称为仙人掌。", "description": "给你一个有 $n$ 个点和 $m$ 条边的仙人掌图，和 $q$ 组询问  \n每次询问两个点 $u,v$，求两点之间的最短路。\n\n保证输入数据没有重边。", "inputFormat": "第一行三个正整数 $n,m,q$，意义如题目描述。  \n接下来 $m$ 行，每行三个正整数 $u,v,w$，表示 $u,v$ 之间有一条权值为 $w$ 的无向边。   \n然后 $q$ 行，每行两个正整数 $u,v$，询问 $u$ 到 $v$ 的最短路。", "outputFormat": "$q$ 行，每行一个正整数，对应一次询问的结果。", "hint": "**样例1解释：**  \n样例1中的仙人掌是这个样子的：  \n![](https://cdn.luogu.com.cn/upload/pic/52854.png)   \n询问有两个，分别是询问 $1\\rightarrow 9$ 和 $5\\rightarrow 7$ 的最短路  \n显然答案分别为 $5$ 和 $6$。\n\n**数据范围：**   \n$1\\le n,q \\le 10000$      \n$1\\le m \\le 20000$   \n$1\\le w \\le 10^5$     \n\n保证输入数据没有重边。\n\n请注意时限为 $300\\text{ms}$      \n", "locale": "zh-CN"}}}
{"pid": "P5237", "type": "P", "difficulty": 7, "samples": [["11 23\n10 5 11 7 8 14 30 3 16 20 19\n1 1 2 5\n1 2 3 3\n1 3 4 7\n1 4 5 8\n1 2 6 10\n1 6 7 15\n1 4 7 3\n1 6 8 9\n1 6 8 6\n1 7 9 12\n1 9 11 10\n1 7 10 4\n1 9 10 8\n5 5 11\n5 2 10\n6 8 7\n3 8 5 100\n5 1 7\n6 8 7\n4 11 7 1000\n5 8 3\n4 3 2 2333\n5 1 5", "-2 -2\n5 73\n16 85\n5 263\n16 185\n1005 4233\n1011 9907\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "动态仙人掌 IV", "background": "模板题。", "description": "有 $n$ 个点，从 $1 \\sim n$ 编号，第 $i$ 个点有一个权值 $w_i$，初始没有边。\n\n有 $m$ 个操作，如果操作后，这个无向图的每个连通块都是个仙人掌，且不存在自环，那这个操作合法，否则不合法。不合法的操作忽略。一共有六种操作：\n\n1. 在结点 $v,u$ 间连一条权值为 $w$ 的边；\n\n2. 在结点 $v,u$ 间删掉一条权值为 $w$ 的边；\n\n3. 把结点 $v$ 到结点 $u$ 的最短路上的每一个结点的权值都加上 $d$；\n\n4. 把以结点 $v$ 为根，子仙人掌 $u$ 的每一个结点的权值都加上 $d$；\n\n5. 查询结点 $v$ 到结点 $u$ 的最短路信息。\n\n    输出两个用空格隔开的整数 $min,\\sigma$，分别代表最短路上点权的最小值、和。\n\n      如果没有路可到达则 $min=-1,\\sigma =-1$。\n    \n      如果最短路不唯一则 $min=-2,\\sigma =-2$。\n\n6. 查询以结点 $v$ 为根，子仙人掌$u$的信息。\n\n    输出两个用空格隔开的整数 $min,\\sigma$，分别代表子仙人掌 $u$ 中点权的最小值、和。\n\n    如果 $v,u$ 不连通则 $min=-1,\\sigma =-1$。\n\n以结点 $v$ 为根，子仙人掌 $u$ 的定义是，删掉 $v$ 到 $u$ 之间的所有简单路径上的边之后，$u$ 所在的连通块。", "inputFormat": "第一行两个用空格隔开的正整数 $n,m$ 表示一共有 $n$ 个结点，$m$ 个操作。\n\n接下来一行 $n$ 个正整数，第 $i$ 个正整数为 $w_i$。\n\n接下来 $m$ 行，每行代表一个操作，每行前三个整数：$opt_i,v_i,u_i$\n\n若 $opt_i \\in \\{ 1,2,3,4 \\}$ 则接下来再输入一个整数，否则此行结束。", "outputFormat": "对于操作 $5$、$6$，输出相应的结果。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$1 \\leq n \\leq 50000, 1 \\leq m \\leq 250000$   \n\n保证操作 $1$、$2$ 中的 $w$ 满足 $1 \\leq w \\leq 10000$，所以关于边权的计算不会超出 $32$ 位有符号整数范围。\n\n保证初始的 $w_i$ 不超过 $10^9$，保证所有操作 $3$、$4$ 中的 $d$ 之和不超过 $10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Dynamic Cactus IV", "background": "Template problem.", "description": "There are $n$ vertices, numbered from $1 \\sim n$. Vertex $i$ has a weight $w_i$. Initially, there are no edges.\n\nThere are $m$ operations. An operation is considered valid if, after applying it, every connected component of this undirected graph is a cactus, and there are no self-loops. Otherwise, the operation is invalid. Invalid operations are ignored. There are six types of operations:\n\n1. Add an edge of weight $w$ between vertices $v$ and $u$.\n\n2. Delete an edge of weight $w$ between vertices $v$ and $u$.\n\n3. Add $d$ to the weight of every vertex on the shortest path from vertex $v$ to vertex $u$.\n\n4. Add $d$ to the weight of every vertex in the sub-cactus $u$, rooted at vertex $v$.\n\n5. Query information about the shortest path from vertex $v$ to vertex $u$.\n\n   Output two integers $min,\\sigma$ separated by a space, representing the minimum vertex weight and the sum of vertex weights on the shortest path.\n\n   If there is no path reachable, then $min=-1,\\sigma =-1$.\n\n   If the shortest path is not unique, then $min=-2,\\sigma =-2$.\n\n6. Query information about the sub-cactus $u$, rooted at vertex $v$.\n\n   Output two integers $min,\\sigma$ separated by a space, representing the minimum vertex weight and the sum of vertex weights in sub-cactus $u$.\n\n   If $v$ and $u$ are not connected, then $min=-1,\\sigma =-1$.\n\nThe definition of the sub-cactus $u$ rooted at vertex $v$ is: after deleting the edges on all simple paths between $v$ and $u$, the connected component containing $u$.", "inputFormat": "The first line contains two positive integers $n,m$ separated by spaces, meaning there are $n$ vertices and $m$ operations in total.\n\nThe next line contains $n$ positive integers. The $i$-th positive integer is $w_i$.\n\nThe next $m$ lines each describe one operation. Each line starts with three integers: $opt_i,v_i,u_i$.\n\nIf $opt_i \\in \\{ 1,2,3,4 \\}$, then one more integer follows; otherwise, the line ends.", "outputFormat": "For operations $5$ and $6$, output the corresponding results.", "hint": "Constraints  \nFor $100\\%$ of the testdata, $1 \\leq n \\leq 50000, 1 \\leq m \\leq 250000$.\n\nIt is guaranteed that in operations $1$ and $2$, $w$ satisfies $1 \\leq w \\leq 10000$, so computations involving edge weights will not exceed the range of a 32-bit signed integer.\n\nIt is guaranteed that the initial $w_i$ does not exceed $10^9$, and that the sum of all $d$ in operations $3$ and $4$ does not exceed $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "动态仙人掌 IV", "background": "模板题。", "description": "有 $n$ 个点，从 $1 \\sim n$ 编号，第 $i$ 个点有一个权值 $w_i$，初始没有边。\n\n有 $m$ 个操作，如果操作后，这个无向图的每个连通块都是个仙人掌，且不存在自环，那这个操作合法，否则不合法。不合法的操作忽略。一共有六种操作：\n\n1. 在结点 $v,u$ 间连一条权值为 $w$ 的边；\n\n2. 在结点 $v,u$ 间删掉一条权值为 $w$ 的边；\n\n3. 把结点 $v$ 到结点 $u$ 的最短路上的每一个结点的权值都加上 $d$；\n\n4. 把以结点 $v$ 为根，子仙人掌 $u$ 的每一个结点的权值都加上 $d$；\n\n5. 查询结点 $v$ 到结点 $u$ 的最短路信息。\n\n    输出两个用空格隔开的整数 $min,\\sigma$，分别代表最短路上点权的最小值、和。\n\n      如果没有路可到达则 $min=-1,\\sigma =-1$。\n    \n      如果最短路不唯一则 $min=-2,\\sigma =-2$。\n\n6. 查询以结点 $v$ 为根，子仙人掌$u$的信息。\n\n    输出两个用空格隔开的整数 $min,\\sigma$，分别代表子仙人掌 $u$ 中点权的最小值、和。\n\n    如果 $v,u$ 不连通则 $min=-1,\\sigma =-1$。\n\n以结点 $v$ 为根，子仙人掌 $u$ 的定义是，删掉 $v$ 到 $u$ 之间的所有简单路径上的边之后，$u$ 所在的连通块。", "inputFormat": "第一行两个用空格隔开的正整数 $n,m$ 表示一共有 $n$ 个结点，$m$ 个操作。\n\n接下来一行 $n$ 个正整数，第 $i$ 个正整数为 $w_i$。\n\n接下来 $m$ 行，每行代表一个操作，每行前三个整数：$opt_i,v_i,u_i$\n\n若 $opt_i \\in \\{ 1,2,3,4 \\}$ 则接下来再输入一个整数，否则此行结束。", "outputFormat": "对于操作 $5$、$6$，输出相应的结果。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$1 \\leq n \\leq 50000, 1 \\leq m \\leq 250000$   \n\n保证操作 $1$、$2$ 中的 $w$ 满足 $1 \\leq w \\leq 10000$，所以关于边权的计算不会超出 $32$ 位有符号整数范围。\n\n保证初始的 $w_i$ 不超过 $10^9$，保证所有操作 $3$、$4$ 中的 $d$ 之和不超过 $10^9$。", "locale": "zh-CN"}}}
{"pid": "P5238", "type": "P", "difficulty": 3, "samples": [["-3 3 4\n0\n00\n-0\n100000000000000000000", "0\n1\n1\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "洛谷月赛"], "title": "整数校验器", "background": "", "description": "有些时候需要解决这样一类问题：判断一个数 $x$ 是否合法。\n\n$x$ 合法当且仅当其满足如下条件：\n\n- $x$ 格式合法，一个格式合法的整数要么是 $0$，要么由一个可加可不加的负号，一个 $1$ 到 $9$ 之间的数字，和若干个 $0$ 到 $9$ 之间的数字依次连接而成。\n- $x$ 在区间 $[l,r]$ 范围内（即 $l \\le x \\le r$）。\n\n你需要实现这样一个校验器，对于给定的 $l, r$，多次判断 $x$ 是否合法。", "inputFormat": "第一行三个整数 $l,r,T$，表示校验器的校验区间为 $[l,r]$，以及需要校验的 $x$ 的个数。\n\n接下来 $T$ 行，每行一个 $x$，表示要校验的数，保证 $x$ 长度至少为 $1$ 且仅由 '0'~'9' 及 '-' 构成，且 '-' 只会出现在第一个字符。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示每个 $x$ 的校验结果。\n\n校验结果规定如下：$0$ 表示 $x$ 合法；$1$ 表示 $x$ 格式不合法；$2$ 表示 $x$ 格式合法且不在 $[l,r]$ 区间内。", "hint": "对于 $100\\%$ 的数据，$0 \\le T \\le 512$，$l,r$ 在 $64$ 位有符号整型范围内（即 $-2^{63}\\le l \\le r \\le 2^{63}-1$）。\n\n保证输入文件大小不超过 $\\text{128KB}$。数据在 linux 下生成，没有 '\\r' 字符。\n\n以下为部分特殊限制（互不包含）：\n\n- 有 $5\\%$ 的数据，$T=0$。\n- 有 $25\\%$ 的数据，保证 $x$ 格式一定合法。\n- 有 $30\\%$ 的数据，保证如果 $x$ 格式合法，那么 $x$ 一定在 $64$ 位有符号整形范围内。\n\n其中有一个不计分的hack测试点，用于考察long long边界数字的判断，如果是100分UnAC的话，那么可能是你没有考虑这一种情况。", "locale": "zh-CN", "translations": {"en": {"title": "Integer Validator", "background": "", "description": "Sometimes you need to solve this kind of problem: determine whether a number $x$ is valid.\n\n$x$ is valid if and only if it satisfies the following conditions:\n\n- The format of $x$ is valid. A valid integer is either $0$, or is formed by concatenating, in order, an optional minus sign, a digit from $1$ to $9$, and then some digits from $0$ to $9$.\n- $x$ is within the interval $[l, r]$ (i.e., $l \\le x \\le r$).\n\nYou need to implement such a validator. Given $l$ and $r$, you will check multiple times whether each $x$ is valid.", "inputFormat": "The first line contains three integers $l, r, T$, indicating that the validator checks the interval $[l, r]$, and there are $T$ values of $x$ to be checked.\n\nThe next $T$ lines each contain one $x$, the number to be checked. It is guaranteed that the length of $x$ is at least $1$ and it consists only of '0'~'9' and '-', and '-' appears only as the first character.", "outputFormat": "Output $T$ lines in total, each containing one integer representing the validation result for each $x$.\n\nThe results are defined as follows: $0$ means $x$ is valid; $1$ means the format of $x$ is invalid; $2$ means the format of $x$ is valid but $x$ is not within the interval $[l, r]$.", "hint": "For $100\\%$ of the testdata, $0 \\le T \\le 512$, and $l, r$ are within the range of 64-bit signed integers (i.e., $-2^{63} \\le l \\le r \\le 2^{63} - 1$).\n\nThe input file size is guaranteed to be no more than $\\text{128KB}$. The testdata is generated under Linux, and there is no '\\r' character.\n\nBelow are some special constraints (they do not include each other):\n\n- For $5\\%$ of the testdata, $T = 0$.\n- For $25\\%$ of the testdata, it is guaranteed that the format of $x$ is always valid.\n- For $30\\%$ of the testdata, it is guaranteed that if the format of $x$ is valid, then $x$ is within the range of 64-bit signed integers.\n\nThere is an unscored hack test point, intended to test the handling of long long boundary values. If you get UnAC with 100 points, it may be because you did not consider this case.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "整数校验器", "background": "", "description": "有些时候需要解决这样一类问题：判断一个数 $x$ 是否合法。\n\n$x$ 合法当且仅当其满足如下条件：\n\n- $x$ 格式合法，一个格式合法的整数要么是 $0$，要么由一个可加可不加的负号，一个 $1$ 到 $9$ 之间的数字，和若干个 $0$ 到 $9$ 之间的数字依次连接而成。\n- $x$ 在区间 $[l,r]$ 范围内（即 $l \\le x \\le r$）。\n\n你需要实现这样一个校验器，对于给定的 $l, r$，多次判断 $x$ 是否合法。", "inputFormat": "第一行三个整数 $l,r,T$，表示校验器的校验区间为 $[l,r]$，以及需要校验的 $x$ 的个数。\n\n接下来 $T$ 行，每行一个 $x$，表示要校验的数，保证 $x$ 长度至少为 $1$ 且仅由 '0'~'9' 及 '-' 构成，且 '-' 只会出现在第一个字符。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示每个 $x$ 的校验结果。\n\n校验结果规定如下：$0$ 表示 $x$ 合法；$1$ 表示 $x$ 格式不合法；$2$ 表示 $x$ 格式合法且不在 $[l,r]$ 区间内。", "hint": "对于 $100\\%$ 的数据，$0 \\le T \\le 512$，$l,r$ 在 $64$ 位有符号整型范围内（即 $-2^{63}\\le l \\le r \\le 2^{63}-1$）。\n\n保证输入文件大小不超过 $\\text{128KB}$。数据在 linux 下生成，没有 '\\r' 字符。\n\n以下为部分特殊限制（互不包含）：\n\n- 有 $5\\%$ 的数据，$T=0$。\n- 有 $25\\%$ 的数据，保证 $x$ 格式一定合法。\n- 有 $30\\%$ 的数据，保证如果 $x$ 格式合法，那么 $x$ 一定在 $64$ 位有符号整形范围内。\n\n其中有一个不计分的hack测试点，用于考察long long边界数字的判断，如果是100分UnAC的话，那么可能是你没有考虑这一种情况。", "locale": "zh-CN"}}}
{"pid": "P5239", "type": "P", "difficulty": 3, "samples": [["5\n2 3\n1 4\n4 3\n2 5\n3 5", "10\n10\n11\n35\n50"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["排列组合", "前缀和", "洛谷月赛"], "title": "回忆京都", "background": "第十五届东方人气投票音乐部门 106 名\n\n第四次国内不知道东方的人对东方原曲的投票调查 51 名\n\n回忆京都副歌我 tm 吹爆，东方文花帖我 tm 吹爆！", "description": "射命丸文在取材中发现了一个好玩的东西，叫做组合数。\n\n组合数的定义如下：从 $n$ 个不同元素中，任取 $m(m \\leq n)$ 个元素并成一组，叫做从 $n$ 个不同元素中取出 $m$ 个元素的一个组合。所有组合的数量，就是组合数。\n\n组合数的计算公式如下：$\\mathrm C^m_n=\\dfrac{n!}{m! \\times (n-m)!}$，其中保证 $m \\leq n$，表示在 $n$ 个元素中选出 $m$ 个元素的组合数。\n\n为了方便理解，举一个例子：在 th16.5 秘封噩梦日记的第三周目中，每一天的战斗都有 $4$ 个角色两两组合出场，那么很显然就有 $\\mathrm C^2_4=6$ 种组合方式。\n\n关于这方面的更详细解释，请看样例说明。\n\n由于她对新事物都存在着好奇，因此她想要知道 $\\mathrm C^m_n$ 是多少。这对她来说是个很简单的事情，因此她看了一眼就秒了，因此她决定求出下列式子：\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\mathrm C^i_j$$\n\n其中当 $i>j$ 的时候，钦定 $\\mathrm C^i_j$ 为 $0$。\n\n她也很快就算出来了，不过对自己的答案不是很充满信心，因此你决定帮助她。然而没事找事的她一下子算了 $q$ 次对于不同的 $n,m$ 的结果，因此这只能劳烦你了。由于你不打算真正地帮助她，你无需把答案对 $998244353$ 取模，也无需对 $64123$ 取模，只要告诉她对 $19260817$ 取模之后的答案即可。", "inputFormat": "第一行输入一个非负整数 $q$，表示有 $q$ 次询问。\n\n第二行开始，一共 $q$ 行，每行两个非负整数 $n,m$，意思如题所示。", "outputFormat": "一共 $q$ 行，对于每一个询问，都输出一个答案。", "hint": "| 测试点编号 | $q$ | $n$ | $m$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | $=0$ | 不存在 | 不存在 |\n| $2\\sim 3$ | $\\le 10$ | $\\le 10$ | $\\le 10$ |\n| $4\\sim 6$ | $\\le 10$ | $\\le 10^3$ | $\\le 10^3$ |\n| $7\\sim 10$ | $\\le 10^4$ | $\\le 10^3$ | $\\le 10^3$ |\n\n关于组合数的样例说明。\n\n例如有蕾米莉亚、芙兰朵露、圣白莲、丰聪耳神子在这一天组合出场，会有六种情况：\n\n1. 蕾米莉亚 x 芙兰朵露 $\\text{\\color{white}背德组}$\n\n2. 丰聪耳神子 x 圣白莲 $\\text{\\color{white}宗教组}$\n\n3. 蕾米莉亚 x 丰聪耳神子\n\n4. 芙兰朵露 x 丰聪耳神子\n\n5. 蕾米莉亚 x 圣白莲\n\n6. 芙兰朵露 x 圣白莲", "locale": "zh-CN", "translations": {"en": {"title": "Recalling Kyoto.", "background": "106th place in the Music section of the 15th Touhou Popularity Poll.\n\n51st place in the 4th domestic poll survey of people who do not know Touhou voting on Touhou original tracks.\n\nThe chorus of Recalling Kyoto is so good, and Touhou Bunkachou is also so good.", "description": "While collecting materials, Shameimaru Aya discovered something interesting, called the binomial coefficient.\n\nThe definition of a binomial coefficient is as follows: from $n$ distinct elements, choose any $m$ elements $(m \\leq n)$ to form a group. This is called a combination of choosing $m$ elements from $n$ distinct elements. The number of all such combinations is the binomial coefficient.\n\nThe formula for computing the binomial coefficient is: $\\mathrm C^m_n=\\dfrac{n!}{m! \\times (n-m)!}$. It is guaranteed that $m \\leq n$, and it represents the number of ways to choose $m$ elements from $n$ elements.\n\nTo make it easier to understand, here is an example: in the third playthrough (week) of th16.5 Violet Detector, each day’s battle has $4$ characters appearing in pairs. Then clearly there are $\\mathrm C^2_4=6$ ways to form pairs.\n\nFor a more detailed explanation, please see the sample explanation.\n\nSince she is curious about new things, she wants to know what $\\mathrm C^m_n$ is. This is very easy for her, so she solved it instantly at a glance. Therefore, she decided to compute the following expression:\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\mathrm C^i_j$$\n\nWhen $i>j$, $\\mathrm C^i_j$ is defined to be $0$.\n\nShe quickly computed it, but she is not very confident in her answer, so you decide to help her. However, she, being idle and looking for something to do, computed the result $q$ times for different $n,m$. So this can only be left to you. Since you do not plan to truly help her, you do not need to take the answer modulo $998244353$, nor modulo $64123$. You only need to tell her the answer modulo $19260817$.", "inputFormat": "The first line contains a non-negative integer $q$, indicating that there are $q$ queries.\n\nStarting from the second line, there are $q$ lines in total. Each line contains two non-negative integers $n,m$, with the meaning as described in the statement.", "outputFormat": "Output $q$ lines in total. For each query, output one answer.", "hint": "| Test Point ID | $q$ | $n$ | $m$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | $=0$ | Does not exist | Does not exist |\n| $2\\sim 3$ | $\\le 10$ | $\\le 10$ | $\\le 10$ |\n| $4\\sim 6$ | $\\le 10$ | $\\le 10^3$ | $\\le 10^3$ |\n| $7\\sim 10$ | $\\le 10^4$ | $\\le 10^3$ | $\\le 10^3$ |\n\nSample explanation about binomial coefficients.\n\nFor example, if Remilia, Flandre, Hijiri Byakuren, and Toyosatomimi no Miko appear in combinations on that day, there will be six cases:\n\n1. Remilia x Flandre $\\text{\\color{white}背德组}$\n\n2. Toyosatomimi no Miko x Hijiri Byakuren $\\text{\\color{white}宗教组}$\n\n3. Remilia x Toyosatomimi no Miko.\n\n4. Flandre x Toyosatomimi no Miko.\n\n5. Remilia x Hijiri Byakuren.\n\n6. Flandre x Hijiri Byakuren.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "回忆京都", "background": "第十五届东方人气投票音乐部门 106 名\n\n第四次国内不知道东方的人对东方原曲的投票调查 51 名\n\n回忆京都副歌我 tm 吹爆，东方文花帖我 tm 吹爆！", "description": "射命丸文在取材中发现了一个好玩的东西，叫做组合数。\n\n组合数的定义如下：从 $n$ 个不同元素中，任取 $m(m \\leq n)$ 个元素并成一组，叫做从 $n$ 个不同元素中取出 $m$ 个元素的一个组合。所有组合的数量，就是组合数。\n\n组合数的计算公式如下：$\\mathrm C^m_n=\\dfrac{n!}{m! \\times (n-m)!}$，其中保证 $m \\leq n$，表示在 $n$ 个元素中选出 $m$ 个元素的组合数。\n\n为了方便理解，举一个例子：在 th16.5 秘封噩梦日记的第三周目中，每一天的战斗都有 $4$ 个角色两两组合出场，那么很显然就有 $\\mathrm C^2_4=6$ 种组合方式。\n\n关于这方面的更详细解释，请看样例说明。\n\n由于她对新事物都存在着好奇，因此她想要知道 $\\mathrm C^m_n$ 是多少。这对她来说是个很简单的事情，因此她看了一眼就秒了，因此她决定求出下列式子：\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\mathrm C^i_j$$\n\n其中当 $i>j$ 的时候，钦定 $\\mathrm C^i_j$ 为 $0$。\n\n她也很快就算出来了，不过对自己的答案不是很充满信心，因此你决定帮助她。然而没事找事的她一下子算了 $q$ 次对于不同的 $n,m$ 的结果，因此这只能劳烦你了。由于你不打算真正地帮助她，你无需把答案对 $998244353$ 取模，也无需对 $64123$ 取模，只要告诉她对 $19260817$ 取模之后的答案即可。", "inputFormat": "第一行输入一个非负整数 $q$，表示有 $q$ 次询问。\n\n第二行开始，一共 $q$ 行，每行两个非负整数 $n,m$，意思如题所示。", "outputFormat": "一共 $q$ 行，对于每一个询问，都输出一个答案。", "hint": "| 测试点编号 | $q$ | $n$ | $m$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | $=0$ | 不存在 | 不存在 |\n| $2\\sim 3$ | $\\le 10$ | $\\le 10$ | $\\le 10$ |\n| $4\\sim 6$ | $\\le 10$ | $\\le 10^3$ | $\\le 10^3$ |\n| $7\\sim 10$ | $\\le 10^4$ | $\\le 10^3$ | $\\le 10^3$ |\n\n关于组合数的样例说明。\n\n例如有蕾米莉亚、芙兰朵露、圣白莲、丰聪耳神子在这一天组合出场，会有六种情况：\n\n1. 蕾米莉亚 x 芙兰朵露 $\\text{\\color{white}背德组}$\n\n2. 丰聪耳神子 x 圣白莲 $\\text{\\color{white}宗教组}$\n\n3. 蕾米莉亚 x 丰聪耳神子\n\n4. 芙兰朵露 x 丰聪耳神子\n\n5. 蕾米莉亚 x 圣白莲\n\n6. 芙兰朵露 x 圣白莲", "locale": "zh-CN"}}}
{"pid": "P5240", "type": "P", "difficulty": 6, "samples": [["4\nx\n0 1\n9\n0 1\nx*(x^(1*8))\n0 1\n(3*(x^3))+((2*(x^2))+(12*x))\n0 1\n", "1 1\n0 0\n0 9\n12 25\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "树形 DP", "栈", "洛谷月赛", "欧拉降幂"], "title": "Derivation", "background": "", "description": "小 R 学会微积分中求导这一概念后，他的数学老师要求他开始做一部分导数的练习题加深自己的理解。\n\n但颖悟绝伦的小 R 对繁复的练习题并不感兴趣。他希望你帮他设计一个程序，计算一个给定函数 $f(x)$ 的导数。\n\n如果你对导数这一概念并不熟悉，请参阅【说明】中的内容。", "inputFormat": "第一行一个正整数 $T$，表示小 R 要完成的练习题数量，亦即测试数据的组数。\n\n每组测试数据的第一行是一个非空字符串，描述了输入的函数 $f(x)$。设 $p=998244353$。\n\n字符串中可能包含的元素有：\n\n1. 系数为 $1$ 的单项式，包括 $x^1,x^2,x^0$ 等，我们保证指数为非负整数（为 $1$ 时不省略）且不超过 $p-1$。所有幂号用 `^` 代替。\n2. 常数，如 $0,19260817$ 等；我们保证一切常数是非负整数且不超过 $p-1$。\n3. 复合函数。将以上两种函数组合的方式可以为加乘幂，括号等。数学中会省略乘号和括号，但我们保证任意情况下都不省略（也不会无意义冗余，即不存在 `((x)),(3)+(4)`）；保证任何指数都是常数，即不存在 $x^{g(x)}$ 的情况。\n\n经过以上规定，我们发现 $f(x)$ 求导后一定是一个多项式函数。如果你对数据的输入形式仍有不确定，可以观察附加样例文件。\n\n由于输出这样的函数存在技术困难，为确认你的输出是正确的，测试数据的第二行为两个整数，值在 $[0,p)$ 之间。你需要输出两个整数，表示这些整数代入导函数后的值模 $p$ 的结果。\n\n注意：本题中认为 $0^0=1$。", "outputFormat": "输出 $T$ 行，每行两个整数，已在【输入格式】中说明它们的意义。", "hint": "规定字符串长度不超过 $10^4$，字符串总长不超过 $5 \\times 10^5$。\n\n| 子任务编号 | 特殊性质                                                  | 分值 |\n| :----------: | :---------------------------------------------------------: | :----: |\n| 1          | $T \\le 10^4$，字符串长度不超过 $20$，出现的常数不超过 $9$ | 20   |\n| 2          | $T \\le 100$，输入是一个化简后的多项式                     | 15   |\n| 3          | $T \\le 100$，出现的常数不超过 $9$                         | 15   |\n| 4          | $T \\le 100$，不存在多项式求幂                             | 20   |\n| 5          | $T \\le 100$                                               | 30   |\n\n我们提供了 5 个附加样例文件，分别满足 5 个子任务的限制。\n\n链接: https://pan.baidu.com/s/1dVSy8tU3pqGoq1-7CFYtBw 提取码: ya2u\n\n**我们只保证以下定义在本题中适用。**\n\n$f(x)$ 的导数是一个函数 $f'(x)$，满足：\n\n$$ \\displaystyle \\lim_{h \\to 0} f'(x)=\\dfrac{f(x+h)-f(x)}{h} $$\n\n我们称 $\\displaystyle \\lim_{x \\to a}g(x)=L$ 当且仅当对于任何实数 $\\epsilon > 0$ 我们都可以找到一个实数 $\\delta > 0$ 使得 $\\lvert g(x)-L\\rvert < \\epsilon$ 若 $0 < \\lvert x - a \\rvert < \\delta$。\n\n你可能用到以下的求导公式：\n\n1. $f(x)=C,f'(x)=0$，其中 $C$ 是一常数。\n2. $f(x)=x^n,f'(x)=nx^{n-1}$，其中 $n$ 为非 $0$ 常数。\n3. $(f(x)+g(x))'=f'(x)+g'(x)$\n4. $(f(x)g(x))'=f'(x)g(x)+f(x)g'(x)$\n5. $(f(g(x)))'=f'(g(x))g'(x)$", "locale": "zh-CN", "translations": {"en": {"title": "Derivation", "background": "", "description": "After learning the concept of differentiation in calculus, Little R’s math teacher asked him to do some derivative exercises to deepen his understanding.\n\nHowever, the exceptionally smart Little R is not interested in complicated exercises. He wants you to help him design a program to compute the derivative of a given function $f(x)$.\n\nIf you are not familiar with the concept of derivatives, please refer to the content in the “Explanation”.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of exercises Little R needs to finish, i.e., the number of testdata groups.\n\nFor each testdata group, the first line is a non-empty string describing the input function $f(x)$. Let $p=998244353$.\n\nThe string may contain the following elements:\n\n1. Monomials with coefficient $1$, including $x^1,x^2,x^0$, etc. We guarantee that the exponent is a non-negative integer (it is not omitted when it is $1$) and does not exceed $p-1$. All exponent symbols are written as `^`.\n2. Constants, such as $0,19260817$, etc. We guarantee that all constants are non-negative integers and do not exceed $p-1$.\n3. Composite functions. The above two kinds of functions can be combined by addition, multiplication, exponentiation, parentheses, etc. In mathematics, multiplication signs and parentheses may be omitted, but we guarantee that they are never omitted in any case (and there is no meaningless redundancy, i.e., there will be no `((x)),(3)+(4)`). We guarantee that any exponent is a constant, i.e., there is no case like $x^{g(x)}$.\n\nUnder the above rules, we find that after differentiating, $f(x)$ must be a polynomial function. If you are still uncertain about the input format, you can check the additional sample files.\n\nBecause outputting such a function directly is technically difficult, to verify whether your output is correct, the second line of each testdata group contains two integers in $[0,p)$. You need to output two integers: the values of the derivative function after substituting these integers, taken modulo $p$.\n\nNote: In this problem, we treat $0^0=1$.", "outputFormat": "Output $T$ lines. Each line contains two integers, whose meaning has been explained in the “Input Format”.", "hint": "It is guaranteed that the string length does not exceed $10^4$, and the total length of all strings does not exceed $5 \\times 10^5$.\n\n| Subtask ID | Special Properties                                             | Score |\n| :--------: | :------------------------------------------------------------: | :---: |\n| 1          | $T \\le 10^4$, string length does not exceed $20$, constants do not exceed $9$ | 20    |\n| 2          | $T \\le 100$, the input is a simplified polynomial              | 15    |\n| 3          | $T \\le 100$, constants do not exceed $9$                       | 15    |\n| 4          | $T \\le 100$, no polynomial exponentiation exists               | 20    |\n| 5          | $T \\le 100$                                                    | 30    |\n\nWe provide 5 additional sample files, each satisfying the restrictions of the 5 subtasks.\n\nLink: https://pan.baidu.com/s/1dVSy8tU3pqGoq1-7CFYtBw Extraction code: ya2u\n\n**We only guarantee that the following definitions apply in this problem.**\n\nThe derivative of $f(x)$ is a function $f'(x)$ such that:\n\n$$ \\displaystyle \\lim_{h \\to 0} f'(x)=\\dfrac{f(x+h)-f(x)}{h} $$\n\nWe say $\\displaystyle \\lim_{x \\to a}g(x)=L$ if and only if for any real number $\\epsilon > 0$ we can find a real number $\\delta > 0$ such that $\\lvert g(x)-L\\rvert < \\epsilon$ when $0 < \\lvert x - a \\rvert < \\delta$.\n\nYou may need the following differentiation formulas:\n\n1. $f(x)=C,f'(x)=0$, where $C$ is a constant.\n2. $f(x)=x^n,f'(x)=nx^{n-1}$, where $n$ is a non-zero constant.\n3. $(f(x)+g(x))'=f'(x)+g'(x)$.\n4. $(f(x)g(x))'=f'(x)g(x)+f(x)g'(x)$.\n5. $(f(g(x)))'=f'(g(x))g'(x)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Derivation", "background": "", "description": "小 R 学会微积分中求导这一概念后，他的数学老师要求他开始做一部分导数的练习题加深自己的理解。\n\n但颖悟绝伦的小 R 对繁复的练习题并不感兴趣。他希望你帮他设计一个程序，计算一个给定函数 $f(x)$ 的导数。\n\n如果你对导数这一概念并不熟悉，请参阅【说明】中的内容。", "inputFormat": "第一行一个正整数 $T$，表示小 R 要完成的练习题数量，亦即测试数据的组数。\n\n每组测试数据的第一行是一个非空字符串，描述了输入的函数 $f(x)$。设 $p=998244353$。\n\n字符串中可能包含的元素有：\n\n1. 系数为 $1$ 的单项式，包括 $x^1,x^2,x^0$ 等，我们保证指数为非负整数（为 $1$ 时不省略）且不超过 $p-1$。所有幂号用 `^` 代替。\n2. 常数，如 $0,19260817$ 等；我们保证一切常数是非负整数且不超过 $p-1$。\n3. 复合函数。将以上两种函数组合的方式可以为加乘幂，括号等。数学中会省略乘号和括号，但我们保证任意情况下都不省略（也不会无意义冗余，即不存在 `((x)),(3)+(4)`）；保证任何指数都是常数，即不存在 $x^{g(x)}$ 的情况。\n\n经过以上规定，我们发现 $f(x)$ 求导后一定是一个多项式函数。如果你对数据的输入形式仍有不确定，可以观察附加样例文件。\n\n由于输出这样的函数存在技术困难，为确认你的输出是正确的，测试数据的第二行为两个整数，值在 $[0,p)$ 之间。你需要输出两个整数，表示这些整数代入导函数后的值模 $p$ 的结果。\n\n注意：本题中认为 $0^0=1$。", "outputFormat": "输出 $T$ 行，每行两个整数，已在【输入格式】中说明它们的意义。", "hint": "规定字符串长度不超过 $10^4$，字符串总长不超过 $5 \\times 10^5$。\n\n| 子任务编号 | 特殊性质                                                  | 分值 |\n| :----------: | :---------------------------------------------------------: | :----: |\n| 1          | $T \\le 10^4$，字符串长度不超过 $20$，出现的常数不超过 $9$ | 20   |\n| 2          | $T \\le 100$，输入是一个化简后的多项式                     | 15   |\n| 3          | $T \\le 100$，出现的常数不超过 $9$                         | 15   |\n| 4          | $T \\le 100$，不存在多项式求幂                             | 20   |\n| 5          | $T \\le 100$                                               | 30   |\n\n我们提供了 5 个附加样例文件，分别满足 5 个子任务的限制。\n\n链接: https://pan.baidu.com/s/1dVSy8tU3pqGoq1-7CFYtBw 提取码: ya2u\n\n**我们只保证以下定义在本题中适用。**\n\n$f(x)$ 的导数是一个函数 $f'(x)$，满足：\n\n$$ \\displaystyle \\lim_{h \\to 0} f'(x)=\\dfrac{f(x+h)-f(x)}{h} $$\n\n我们称 $\\displaystyle \\lim_{x \\to a}g(x)=L$ 当且仅当对于任何实数 $\\epsilon > 0$ 我们都可以找到一个实数 $\\delta > 0$ 使得 $\\lvert g(x)-L\\rvert < \\epsilon$ 若 $0 < \\lvert x - a \\rvert < \\delta$。\n\n你可能用到以下的求导公式：\n\n1. $f(x)=C,f'(x)=0$，其中 $C$ 是一常数。\n2. $f(x)=x^n,f'(x)=nx^{n-1}$，其中 $n$ 为非 $0$ 常数。\n3. $(f(x)+g(x))'=f'(x)+g'(x)$\n4. $(f(x)g(x))'=f'(x)g(x)+f(x)g'(x)$\n5. $(f(g(x)))'=f'(g(x))g'(x)$", "locale": "zh-CN"}}}
{"pid": "P5241", "type": "P", "difficulty": 6, "samples": [["3\n", "1 2 4 7 7 7\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3500, 3500, 3500, 3500, 3500], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["动态规划 DP", "贪心", "强连通分量", "洛谷月赛"], "title": "序列", "background": null, "description": "构建一个 $N$ 个点的有向图 $G$，初始没有任何边。\n\n接下来构建一个长度为 $E$ 的边的序列 $A$，序列中每条边都是满足 $1\\le s,t\\le N$ 且 $s\\neq t$ 的有向边 $(s,t)$，且序列中的边互不相同。\n\n按照顺序把这些边加入到 $G$ 中，每次加入后计算当前图的强连通分量个数并记录下来，得到一个新的长度为 $E$ 的正整数序列 $B$。\n\n- 如果两个边的序列得到的 $B$ 相同则称它们 **本质相同**。\n\n请问有多少种本质不同的边的序列，你只要求出答案对 $10^9+7$ 取模后的结果。", "inputFormat": "输入一行，一个正整数 $N$ 表示有向图 $G$ 的点数。", "outputFormat": "输出一行 $N\\times(N-1)$ 个由空格隔开的整数，第 $i$ 个数表示当 $E=i$ 时的答案。", "hint": "Subtask 1 (5pts)：$N\\le 5$。\n\nSubtask 2 (10pts)：$N\\le 10$。\n\nSubtask 3 (15pts)：$N\\le 20$。\n\nSubtask 4 (15pts)：$N\\le 30$。\n\nSubtask 5 (15pts)：$N\\le 50$。\n\nSubtask 6 (20pts)：$N\\le 100$。\n\nSubtask 7 (20pts)：无特殊限制。\n\n对于全部数据：$N\\le 400$。\n\n前 $6$ 个子任务限时 $1\\text s$，第 $7$ 个 $3.5\\text s$。\n\n## 代码长度限制：10kb 超过这个限制赛后将会被标记为无效。", "locale": "zh-CN", "translations": {"en": {"title": "Sequence", "background": "", "description": "Build a directed graph $G$ with $N$ vertices, with no edges at the beginning.\n\nNext, build an edge sequence $A$ of length $E$. Each edge in the sequence is a directed edge $(s,t)$ satisfying $1 \\le s,t \\le N$ and $s \\ne t$, and all edges in the sequence are distinct.\n\nAdd these edges to $G$ in order. After each addition, compute and record the current number of strongly connected components in the graph, obtaining a new positive integer sequence $B$ of length $E$.\n\n- If two edge sequences produce the same $B$, then they are called **essentially the same**.\n\nHow many essentially different edge sequences are there? You only need to output the answer modulo $10^9+7$.", "inputFormat": "Input one line containing a positive integer $N$, which denotes the number of vertices in the directed graph $G$.", "outputFormat": "Output one line containing $N \\times (N-1)$ integers separated by spaces. The $i$-th number represents the answer when $E=i$.", "hint": "Subtask 1 (5pts): $N \\le 5$.\n\nSubtask 2 (10pts): $N \\le 10$.\n\nSubtask 3 (15pts): $N \\le 20$.\n\nSubtask 4 (15pts): $N \\le 30$.\n\nSubtask 5 (15pts): $N \\le 50$.\n\nSubtask 6 (20pts): $N \\le 100$.\n\nSubtask 7 (20pts): No special constraints.\n\nConstraints: For all data, $N \\le 400$.\n\nFor the first $6$ subtasks, the time limit is $1\\text s$, and for the $7$-th it is $3.5\\text s$.\n\nCode length limit: 10kb. If it exceeds this limit, it will be marked as invalid after the contest.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "序列", "background": null, "description": "构建一个 $N$ 个点的有向图 $G$，初始没有任何边。\n\n接下来构建一个长度为 $E$ 的边的序列 $A$，序列中每条边都是满足 $1\\le s,t\\le N$ 且 $s\\neq t$ 的有向边 $(s,t)$，且序列中的边互不相同。\n\n按照顺序把这些边加入到 $G$ 中，每次加入后计算当前图的强连通分量个数并记录下来，得到一个新的长度为 $E$ 的正整数序列 $B$。\n\n- 如果两个边的序列得到的 $B$ 相同则称它们 **本质相同**。\n\n请问有多少种本质不同的边的序列，你只要求出答案对 $10^9+7$ 取模后的结果。", "inputFormat": "输入一行，一个正整数 $N$ 表示有向图 $G$ 的点数。", "outputFormat": "输出一行 $N\\times(N-1)$ 个由空格隔开的整数，第 $i$ 个数表示当 $E=i$ 时的答案。", "hint": "Subtask 1 (5pts)：$N\\le 5$。\n\nSubtask 2 (10pts)：$N\\le 10$。\n\nSubtask 3 (15pts)：$N\\le 20$。\n\nSubtask 4 (15pts)：$N\\le 30$。\n\nSubtask 5 (15pts)：$N\\le 50$。\n\nSubtask 6 (20pts)：$N\\le 100$。\n\nSubtask 7 (20pts)：无特殊限制。\n\n对于全部数据：$N\\le 400$。\n\n前 $6$ 个子任务限时 $1\\text s$，第 $7$ 个 $3.5\\text s$。\n\n## 代码长度限制：10kb 超过这个限制赛后将会被标记为无效。", "locale": "zh-CN"}}}
{"pid": "P5242", "type": "P", "difficulty": 6, "samples": [["3\n300000\n400000\n350000\n", "470000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "USACO", "三分", "斜率优化"], "title": "[USACO19FEB] Cow Dating P", "background": "", "description": "由于目前可供奶牛们使用的约会网站并没有给 Farmer John 留下深刻印象，他决定推出一个基于新匹配算法的奶牛交友网站，该算法可基于公牛和母牛间的共同兴趣对公牛和母牛进行匹配。\n\nBessie 在寻找情人节 Barn Dance 的合作伙伴时，决定试用这个网站。在注册账户之后，FJ 的算法为他给出了一个长度为 $ N $（$1 \\leq N \\leq 10^6$） 的匹配列表，列表上每头公牛接受她舞蹈邀请的概率为 $ p $（$0 < p < 1$）。\n\nBessie 决定向列表中的一个连续区间内的奶牛发送邀请，但Bessie希望**恰好只有一个奶牛**接受邀请。请帮助 Bessie 求出**恰好只有一个奶牛**接受邀请的最大概率是多少。", "inputFormat": "第一行输入一个整数 $ N $ 。\n\n接下来 $ N $ 行，每行包含一个整数，它的含义是 $ p_i $ 乘以 $ 10^6 $ 后的结果。", "outputFormat": "请输出**恰好只有一个奶牛**接受邀请的最大概率乘以 $ 10^6 $ 后向下取整后的结果。", "hint": "样例的最优方案是向第二和第三只奶牛发送邀请。\n\n子任务：对于 $ 25\\% $ 的数据， $ N \\leq 4000 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Cow Dating P", "background": "", "description": "Since the current dating websites available to the cows did not impress Farmer John, he decided to launch a cow dating website based on a new matching algorithm. This algorithm matches bulls and cows based on their shared interests.\n\nWhen Bessie was looking for a partner for the Valentine’s Day Barn Dance, she decided to try this website. After registering an account, FJ’s algorithm produced a matching list of length $N$ ($1 \\leq N \\leq 10^6$). For each bull on the list, the probability that he will accept her dance invitation is $p$ ($0 < p < 1$).\n\nBessie decides to send invitations to the cows in one continuous interval of the list, but she wants **exactly one cow** to accept the invitation. Please help Bessie find the maximum probability that **exactly one cow** accepts the invitation.", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines each contain an integer, meaning the value of $p_i$ multiplied by $10^6$.", "outputFormat": "Output the result of taking the maximum probability that **exactly one cow** accepts the invitation, multiplying it by $10^6$, and then rounding down to an integer.", "hint": "In the sample, the optimal plan is to send invitations to the second and third cows.\n\nSubtasks: For $25\\%$ of the testdata, $N \\leq 4000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Cow Dating P", "background": "", "description": "由于目前可供奶牛们使用的约会网站并没有给 Farmer John 留下深刻印象，他决定推出一个基于新匹配算法的奶牛交友网站，该算法可基于公牛和母牛间的共同兴趣对公牛和母牛进行匹配。\n\nBessie 在寻找情人节 Barn Dance 的合作伙伴时，决定试用这个网站。在注册账户之后，FJ 的算法为他给出了一个长度为 $ N $（$1 \\leq N \\leq 10^6$） 的匹配列表，列表上每头公牛接受她舞蹈邀请的概率为 $ p $（$0 < p < 1$）。\n\nBessie 决定向列表中的一个连续区间内的奶牛发送邀请，但Bessie希望**恰好只有一个奶牛**接受邀请。请帮助 Bessie 求出**恰好只有一个奶牛**接受邀请的最大概率是多少。", "inputFormat": "第一行输入一个整数 $ N $ 。\n\n接下来 $ N $ 行，每行包含一个整数，它的含义是 $ p_i $ 乘以 $ 10^6 $ 后的结果。", "outputFormat": "请输出**恰好只有一个奶牛**接受邀请的最大概率乘以 $ 10^6 $ 后向下取整后的结果。", "hint": "样例的最优方案是向第二和第三只奶牛发送邀请。\n\n子任务：对于 $ 25\\% $ 的数据， $ N \\leq 4000 $ 。", "locale": "zh-CN"}}}
{"pid": "P5243", "type": "P", "difficulty": 6, "samples": [["5 3 1 12\n1 2 3\n2 3 4\n4 5 6\n", "54"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "USACO"], "title": "[USACO19FEB] Moorio Kart P", "background": "", "description": "Bessie 和 Farmer John 喜欢山羊卡丁车比赛。这个比赛非常类似于其他人喜欢的卡丁车比赛，除了卡丁车是由山羊拉动，以及赛道是由农田组成。农田由 $ N $ 个草地和 $ M $ 条道路组成，每条道路都连接着两个草地。\n\n定义农场是两个或更多草地的一个集合，同一农场中的每个草地都可以沿着一系列**唯一**的道路到达农场中其他任意一个草地。\n\n整个农田可能由多个农场组成，假设图中有 $ K $ 个农场。Bessie 希望通过添加长度为 $ X $ 的 $ K $ 条道路，连接所有 $ K $ 个农场来制作山羊卡丁车赛道。每个农场只应访问一次，并且每个农场内必须至少穿过一条道路。\n\n为了让选手们对赛道更有兴趣，赛道的长度至少应该为 $ Y $ 。Bessie 希望知道所有这些有趣赛道的赛道长度总和。如果一个赛道中有两个农场直接相连，但另外一个赛道中这两个农场没有直接相连的话，这两个赛道就是不同的。\n\n---\n\n形式化题意：\n\n给定 $K$ 个连通块的森林，边有边权。你需要加入 $K$ 条长为 $X$ 的边使得整张图变成一棵基环树。原来的每个连通块在环上至少有一条边，所有新加入的边都应该在环上。\n\n求所有环长 $\\ge Y$ 的合法方案的环长之和。", "inputFormat": "第一行包括四个整数 $ N,M,X,Y $（$1 \\leq N \\leq 1500,1 \\leq M \\leq N-1,0 \\leq X, Y \\leq 2500$）。\n\n接下来 $ M $ 行，每行包含三个整数： $ A_i,B_i,D_i $（$1 \\leq A_i, B_i \\leq N,0 \\leq D_i \\leq 2500$），代表 $ A_i $ 号草地和 $ B_i $ 号草地间有一条长度为 $ D_i $ 的道路。保证两个草地间最多只有一条道路直接相连，且不存在自环。", "outputFormat": "输出有趣赛道的赛道长度总和 $\\pmod {10^9+7}$ 后的结果。", "hint": "有 6 个合法的赛道方案：\n\n- 1 --> 2 --> 4 --> 5 --> 1 (长度 11)\n- 1 --> 2 --> 5 --> 4 --> 1 (长度 11)\n- 2 --> 3 --> 4 --> 5 --> 2 (长度 12)\n- 2 --> 3 --> 5 --> 4 --> 2 (长度 12)\n- 1 --> 2 --> 3 --> 4 --> 5 --> 1 (长度 15)\n- 1 --> 2 --> 3 --> 5 --> 4 --> 1 (长度 15)\n\n其中后 4 条赛道满足了赛道总长不低于 12 的条件，这几条赛道的长度总和为 54。\n\n子任务：对于 $ 70\\% $ 的数据， $ N,Y \\leq 1000 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Moorio Kart P", "background": "", "description": "Bessie and Farmer John enjoy goat go-kart racing. This competition is very similar to the go-kart racing that other people like, except that the karts are pulled by goats, and the track consists of farmland. The farmland consists of $N$ pastures and $M$ roads, and each road connects two pastures.\n\nDefine a farm as a set of two or more pastures such that within the same farm, every pasture can reach any other pasture in the farm along a sequence of **unique** roads.\n\nThe entire farmland may consist of multiple farms. Suppose there are $K$ farms in the graph. Bessie wants to create a goat go-kart track by adding $K$ roads of length $X$ to connect all $K$ farms. Each farm should be visited only once, and within each farm, at least one road must be traversed.\n\nTo make the track more interesting for the contestants, the length of the track should be at least $Y$. Bessie wants to know the sum of track lengths of all such interesting tracks. If two farms are directly connected in one track, but those two farms are not directly connected in another track, then these two tracks are considered different.\n\n---\n\nFormal statement:\n\nYou are given a forest with $K$ connected components, with weighted edges. You need to add $K$ edges of length $X$ so that the entire graph becomes a unicyclic graph (a tree with exactly one cycle). Each original connected component must have at least one edge on the cycle, and all newly added edges must be on the cycle.\n\nFind the sum of the cycle lengths over all valid constructions whose cycle length is $\\ge Y$.", "inputFormat": "The first line contains four integers $N, M, X, Y$ ($1 \\leq N \\leq 1500, 1 \\leq M \\leq N-1, 0 \\leq X, Y \\leq 2500$).\n\nThe next $M$ lines each contain three integers: $A_i, B_i, D_i$ ($1 \\leq A_i, B_i \\leq N, 0 \\leq D_i \\leq 2500$), indicating that there is a road of length $D_i$ between pastures $A_i$ and $B_i$. It is guaranteed that there is at most one road directly connecting any two pastures, and there are no self-loops.", "outputFormat": "Output the sum of lengths of all interesting tracks modulo $10^9+7$.", "hint": "There are 6 valid track constructions:\n\n- 1 --> 2 --> 4 --> 5 --> 1 (length 11).\n- 1 --> 2 --> 5 --> 4 --> 1 (length 11).\n- 2 --> 3 --> 4 --> 5 --> 2 (length 12).\n- 2 --> 3 --> 5 --> 4 --> 2 (length 12).\n- 1 --> 2 --> 3 --> 4 --> 5 --> 1 (length 15).\n- 1 --> 2 --> 3 --> 5 --> 4 --> 1 (length 15).\n\nAmong them, the last 4 tracks satisfy the requirement that the total track length is at least 12, and the sum of their lengths is 54.\n\nSubtasks: For $70\\%$ of the testdata, $N, Y \\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Moorio Kart P", "background": "", "description": "Bessie 和 Farmer John 喜欢山羊卡丁车比赛。这个比赛非常类似于其他人喜欢的卡丁车比赛，除了卡丁车是由山羊拉动，以及赛道是由农田组成。农田由 $ N $ 个草地和 $ M $ 条道路组成，每条道路都连接着两个草地。\n\n定义农场是两个或更多草地的一个集合，同一农场中的每个草地都可以沿着一系列**唯一**的道路到达农场中其他任意一个草地。\n\n整个农田可能由多个农场组成，假设图中有 $ K $ 个农场。Bessie 希望通过添加长度为 $ X $ 的 $ K $ 条道路，连接所有 $ K $ 个农场来制作山羊卡丁车赛道。每个农场只应访问一次，并且每个农场内必须至少穿过一条道路。\n\n为了让选手们对赛道更有兴趣，赛道的长度至少应该为 $ Y $ 。Bessie 希望知道所有这些有趣赛道的赛道长度总和。如果一个赛道中有两个农场直接相连，但另外一个赛道中这两个农场没有直接相连的话，这两个赛道就是不同的。\n\n---\n\n形式化题意：\n\n给定 $K$ 个连通块的森林，边有边权。你需要加入 $K$ 条长为 $X$ 的边使得整张图变成一棵基环树。原来的每个连通块在环上至少有一条边，所有新加入的边都应该在环上。\n\n求所有环长 $\\ge Y$ 的合法方案的环长之和。", "inputFormat": "第一行包括四个整数 $ N,M,X,Y $（$1 \\leq N \\leq 1500,1 \\leq M \\leq N-1,0 \\leq X, Y \\leq 2500$）。\n\n接下来 $ M $ 行，每行包含三个整数： $ A_i,B_i,D_i $（$1 \\leq A_i, B_i \\leq N,0 \\leq D_i \\leq 2500$），代表 $ A_i $ 号草地和 $ B_i $ 号草地间有一条长度为 $ D_i $ 的道路。保证两个草地间最多只有一条道路直接相连，且不存在自环。", "outputFormat": "输出有趣赛道的赛道长度总和 $\\pmod {10^9+7}$ 后的结果。", "hint": "有 6 个合法的赛道方案：\n\n- 1 --> 2 --> 4 --> 5 --> 1 (长度 11)\n- 1 --> 2 --> 5 --> 4 --> 1 (长度 11)\n- 2 --> 3 --> 4 --> 5 --> 2 (长度 12)\n- 2 --> 3 --> 5 --> 4 --> 2 (长度 12)\n- 1 --> 2 --> 3 --> 4 --> 5 --> 1 (长度 15)\n- 1 --> 2 --> 3 --> 5 --> 4 --> 1 (长度 15)\n\n其中后 4 条赛道满足了赛道总长不低于 12 的条件，这几条赛道的长度总和为 54。\n\n子任务：对于 $ 70\\% $ 的数据， $ N,Y \\leq 1000 $ 。", "locale": "zh-CN"}}}
{"pid": "P5244", "type": "P", "difficulty": 7, "samples": [["5 20\n19 1\n2 6\n9 15\n10 3\n13 11", "117"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "线段树", "USACO", "动态规划优化", "决策单调性"], "title": "[USACO19FEB] Mowing Mischief P", "background": null, "description": "Bessie 的表妹 Ella 和 Bella 正在参观农场。不幸的是，自从他们到达以来，他们一直在恶作剧。\n\n在他们的最新计划中，他们决定尽可能多地割草。农场的草地是 $ T \\times T $ 的正方形。左下角是 $ (0,0) $ ，右上角是 $ (T,T) $ 。因此，正方形包含 $ (T+1)^2 $ 个格点（具有整数坐标的点）。\n\nElla 和 Bella 计划从 $ (0,0) $ 开始并以每秒一个单位长度的速度运行到 $ (T,T) $ ，同时每只奶牛都握住非常锋利且非常有弹性的线的一端。任何被这根电线扫过的区域的草都会被切断。Ella 和 Bella 可能采取不同的路径，但她们只会向上或者向右移动，从一个格点移动到另一个格点。\n\nBessie 非常担心会切割太多的草，所以她发明了一个聪明的计划来限制 Ella 和 Bella 的路径。在整个草原上散布着 $ N $ 种花（ $ 1 \\leq N \\leq 2 \\times 10^5 $ ），每种花都在一个特定的格点上。 Bessie 将从这些花中挑选一个子集 $ S $ ， $ S $ 集合中的花 Ella 和 Bella 都需要经过（Ella 和 Bella 的路径都必须经过 $ S $ 中的所有花朵）。\n\nElla 和 Bella 将会切割面积尽可能大的草，请帮助Bessie确定集合 $ S $ 使得在 $ S $ 集合尽可能大的情况下被切割的草的**面积**最小。", "inputFormat": "输入第一行包括两个数 $ N,T $（$1 \\leq T \\leq 10^6$）。\n\n接下来 $ N $ 行每行包含两个数 $ x_i,y_i $ ，代表一种花的位置。\n\n保证 $ 1 \\leq x_i,y_i \\leq T-1 $，且不存在两朵花在同一条水平或竖直线上。", "outputFormat": "输出一个整数，即被切割的草的**面积**的最小值。", "hint": "选择 $ (10,3) $ 和 $ (13,11) $ 这两个位置上的花，可以使得被切割的草的面积最小。\n\n子任务：对于 $ 20\\% $ 的数据， $ N \\leq 3200 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Mowing Mischief P", "background": "", "description": "Bessie’s cousins, Ella and Bella, are visiting the farm. Unfortunately, ever since they arrived, they have been causing trouble.\n\nIn their latest scheme, they decide to mow as much grass as possible. The farm’s grassland is a $T \\times T$ square. The lower-left corner is $(0,0)$, and the upper-right corner is $(T,T)$. Therefore, the square contains $(T+1)^2$ lattice points (points with integer coordinates).\n\nElla and Bella plan to start from $(0,0)$ and run to $(T,T)$ at a speed of one unit length per second. At the same time, each cow holds one end of a very sharp and very elastic wire. Any area swept by this wire will have its grass cut. Ella and Bella may take different paths, but they will only move up or right, traveling from one lattice point to another.\n\nBessie is very worried that too much grass will be cut, so she comes up with a clever plan to restrict Ella and Bella’s paths. There are $N$ flowers scattered across the grassland ($1 \\leq N \\leq 2 \\times 10^5$), and each flower is located at a specific lattice point. Bessie will choose a subset $S$ of these flowers. Both Ella and Bella must pass through all flowers in $S$ (that is, both of their paths must go through every flower in $S$).\n\nElla and Bella will cut an area of grass as large as possible. Please help Bessie determine the set $S$ so that, while $S$ is as large as possible, the **area** of grass that gets cut is minimized.", "inputFormat": "The first line contains two integers $N, T$ ($1 \\leq T \\leq 10^6$).\n\nThe next $N$ lines each contain two integers $x_i, y_i$, representing the position of a flower.\n\nIt is guaranteed that $1 \\leq x_i, y_i \\leq T-1$, and no two flowers lie on the same horizontal or vertical line.", "outputFormat": "Output one integer: the minimum possible **area** of grass that gets cut.", "hint": "Choosing the flowers at positions $(10,3)$ and $(13,11)$ can minimize the area of grass that gets cut.\n\nSubtasks: For $20\\%$ of the testdata, $N \\leq 3200$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Mowing Mischief P", "background": null, "description": "Bessie 的表妹 Ella 和 Bella 正在参观农场。不幸的是，自从他们到达以来，他们一直在恶作剧。\n\n在他们的最新计划中，他们决定尽可能多地割草。农场的草地是 $ T \\times T $ 的正方形。左下角是 $ (0,0) $ ，右上角是 $ (T,T) $ 。因此，正方形包含 $ (T+1)^2 $ 个格点（具有整数坐标的点）。\n\nElla 和 Bella 计划从 $ (0,0) $ 开始并以每秒一个单位长度的速度运行到 $ (T,T) $ ，同时每只奶牛都握住非常锋利且非常有弹性的线的一端。任何被这根电线扫过的区域的草都会被切断。Ella 和 Bella 可能采取不同的路径，但她们只会向上或者向右移动，从一个格点移动到另一个格点。\n\nBessie 非常担心会切割太多的草，所以她发明了一个聪明的计划来限制 Ella 和 Bella 的路径。在整个草原上散布着 $ N $ 种花（ $ 1 \\leq N \\leq 2 \\times 10^5 $ ），每种花都在一个特定的格点上。 Bessie 将从这些花中挑选一个子集 $ S $ ， $ S $ 集合中的花 Ella 和 Bella 都需要经过（Ella 和 Bella 的路径都必须经过 $ S $ 中的所有花朵）。\n\nElla 和 Bella 将会切割面积尽可能大的草，请帮助Bessie确定集合 $ S $ 使得在 $ S $ 集合尽可能大的情况下被切割的草的**面积**最小。", "inputFormat": "输入第一行包括两个数 $ N,T $（$1 \\leq T \\leq 10^6$）。\n\n接下来 $ N $ 行每行包含两个数 $ x_i,y_i $ ，代表一种花的位置。\n\n保证 $ 1 \\leq x_i,y_i \\leq T-1 $，且不存在两朵花在同一条水平或竖直线上。", "outputFormat": "输出一个整数，即被切割的草的**面积**的最小值。", "hint": "选择 $ (10,3) $ 和 $ (13,11) $ 这两个位置上的花，可以使得被切割的草的面积最小。\n\n子任务：对于 $ 20\\% $ 的数据， $ N \\leq 3200 $ 。", "locale": "zh-CN"}}}
{"pid": "P5245", "type": "P", "difficulty": 6, "samples": [["9 18948465\n1 2 3 4 5 6 7 8 9", "1 37896930 597086012 720637306 161940419 360472177 560327751 446560856 524295016"], ["4 1\n1 1 0 0\n", "1 1 0 0"], ["4 2\n1 1 0 0\n", "1 2 1 0\n"], ["4 3\n1 1 0 0", "1 3 3 1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "模板题"], "title": "【模板】多项式快速幂", "background": "[加强版传送门](https://www.luogu.com.cn/problem/P5273)\n\n模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 $\\bmod\\ x^n$ 意义下的多项式 $B(x)$，使得 $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 个整数，依次表示 $A(x)$ 的系数 $a_0, a_1,...,a_{n-1}$。", "outputFormat": "输出 $n$ 个整数，依次表示 $B(x)$ 的前 $n$ 项系数 $b_0, b_1,...,b_{n-1}$ 在模 $998244353$ 意义下的最小自然数值。", "hint": "对于 $100\\%$ 的数据，$1 < n \\leq 10^5$，$0 < k \\leq 10^{10^5}$，$a_i \\in [0,998244352]$，$a_0=1$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Fast Polynomial Exponentiation", "background": "[Enhanced version link](https://www.luogu.com.cn/problem/P5273)\n\nThis is a template problem, with no background.", "description": "Given a polynomial $A(x)$ of degree $n-1$, find a polynomial $B(x)$ modulo $x^n$ such that $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$.\n\nThe coefficients of the polynomials are computed modulo $998244353$.", "inputFormat": "The first line contains two integers $n, k$.\n\nThe next line contains $n$ integers, representing the coefficients of $A(x)$ in order: $a_0, a_1, ..., a_{n-1}$.", "outputFormat": "Output $n$ integers, representing the first $n$ coefficients of $B(x)$ in order: $b_0, b_1, ..., b_{n-1}$. Each coefficient should be the smallest non-negative integer modulo $998244353$.", "hint": "For $100\\%$ of the testdata, $1 < n \\leq 10^5$, $0 < k \\leq 10^{10^5}$, $a_i \\in [0,998244352]$, and $a_0 = 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式快速幂", "background": "[加强版传送门](https://www.luogu.com.cn/problem/P5273)\n\n模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 $\\bmod\\ x^n$ 意义下的多项式 $B(x)$，使得 $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 个整数，依次表示 $A(x)$ 的系数 $a_0, a_1,...,a_{n-1}$。", "outputFormat": "输出 $n$ 个整数，依次表示 $B(x)$ 的前 $n$ 项系数 $b_0, b_1,...,b_{n-1}$ 在模 $998244353$ 意义下的最小自然数值。", "hint": "对于 $100\\%$ 的数据，$1 < n \\leq 10^5$，$0 < k \\leq 10^{10^5}$，$a_i \\in [0,998244352]$，$a_0=1$。", "locale": "zh-CN"}}}
{"pid": "P5246", "type": "P", "difficulty": 7, "samples": [["0\n2\n2 3\n4 7", "5\n11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "集训队互测", "提交答案"], "title": "[集训队互测 2016] 消失的源代码", "background": "翻开古老的试题，发现题面已模糊不清。   \n选手们的源代码也已经消失。   \n只剩下编译后的可执行程序。  \n你找到了输入文件，希望重新生成输出文件。", "description": "给出可执行程序 $\\texttt{lost}$，和输入文件 $\\texttt{input*.txt}$，对于每一个输入文件，求出它对应的输出文件。    \n$\\texttt{lost}$ 的输入和输出是标准输入输出。可以在命令行中对输入输出进行重定向。  \n还下发了一个可执行程序 $\\texttt{lost2}$，它从 $\\texttt{input.txt}$ 中读入，输出到 $\\texttt{output.txt}$。除此以外 $\\texttt{lost2}$ 和 $\\texttt{lost}$ 完全相同。可以根据习惯选用 $\\texttt{lost}$ 或 $\\texttt{lost2}$。   \n$\\text{lost}$ 并不完美，当数据规模较大时，它或许不能成功运行，此时会直接输出 `invalid input.`", "inputFormat": "第一行一个整数，表示数据类型。$\\texttt{lost}$ 会根据数据类型，完成相应的计算。例如数据类型为 $0$ 时，$\\texttt{lost}$会计算 $\\texttt{A+B Problem}$ ( $\\texttt{input0.txt}$、$\\texttt{output0.txt}$ )。  \n第二行一个整数，表示数据组数。    \n接下来是每一组数据。输入格式由数据类型确定。   \n当数据规模不超过第一组数据时，保证 $\\texttt{lost}$ 能够正常运行。   \n只有数据组数不超过一组时，保证 $\\texttt{lost}$ 的输出正确。", "outputFormat": "对于每组数据，输出一行。", "hint": "[输入数据下载](http://uoj.ac/download.php?type=problem&id=190)", "locale": "zh-CN", "translations": {"en": {"title": "[Training Team Mutual Test 2016] The Disappeared Source Code", "background": "Opening an old set of problems, you find the statement has become blurry and unclear.  \nThe contestants’ source code has also disappeared.  \nOnly the compiled executable program remains.  \nYou found the input files and hope to regenerate the output files.", "description": "Given the executable program $\\texttt{lost}$ and the input files $\\texttt{input*.txt}$, for each input file, compute its corresponding output file.  \n$\\texttt{lost}$ uses standard input and output. You can redirect input and output in the command line.  \nAn executable program $\\texttt{lost2}$ is also provided. It reads from $\\texttt{input.txt}$ and writes to $\\texttt{output.txt}$. Other than that, $\\texttt{lost2}$ is exactly the same as $\\texttt{lost}$. You may choose $\\texttt{lost}$ or $\\texttt{lost2}$ according to your habit.  \n$\\text{lost}$ is not perfect. When the data size is large, it may fail to run successfully, and in this case it will directly output `invalid input!`.", "inputFormat": "The first line contains an integer representing the data type. $\\texttt{lost}$ will perform the corresponding computation based on the data type. For example, when the data type is $0$, $\\texttt{lost}$ will compute the $\\texttt{A+B Problem}$ ( $\\texttt{input0.txt}$, $\\texttt{output0.txt}$ ).  \nThe second line contains an integer representing the number of test cases.  \nThen follows each test case. The input format is determined by the data type.  \nWhen the data size does not exceed the first test case, it is guaranteed that $\\texttt{lost}$ can run normally.  \nOnly when the number of test cases does not exceed one, it is guaranteed that the output of $\\texttt{lost}$ is correct.", "outputFormat": "For each test case, output one line.", "hint": "[Download input data](http://uoj.ac/download.php?type=problem&id=190)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[集训队互测 2016] 消失的源代码", "background": "翻开古老的试题，发现题面已模糊不清。   \n选手们的源代码也已经消失。   \n只剩下编译后的可执行程序。  \n你找到了输入文件，希望重新生成输出文件。", "description": "给出可执行程序 $\\texttt{lost}$，和输入文件 $\\texttt{input*.txt}$，对于每一个输入文件，求出它对应的输出文件。    \n$\\texttt{lost}$ 的输入和输出是标准输入输出。可以在命令行中对输入输出进行重定向。  \n还下发了一个可执行程序 $\\texttt{lost2}$，它从 $\\texttt{input.txt}$ 中读入，输出到 $\\texttt{output.txt}$。除此以外 $\\texttt{lost2}$ 和 $\\texttt{lost}$ 完全相同。可以根据习惯选用 $\\texttt{lost}$ 或 $\\texttt{lost2}$。   \n$\\text{lost}$ 并不完美，当数据规模较大时，它或许不能成功运行，此时会直接输出 `invalid input.`", "inputFormat": "第一行一个整数，表示数据类型。$\\texttt{lost}$ 会根据数据类型，完成相应的计算。例如数据类型为 $0$ 时，$\\texttt{lost}$会计算 $\\texttt{A+B Problem}$ ( $\\texttt{input0.txt}$、$\\texttt{output0.txt}$ )。  \n第二行一个整数，表示数据组数。    \n接下来是每一组数据。输入格式由数据类型确定。   \n当数据规模不超过第一组数据时，保证 $\\texttt{lost}$ 能够正常运行。   \n只有数据组数不超过一组时，保证 $\\texttt{lost}$ 的输出正确。", "outputFormat": "对于每组数据，输出一行。", "hint": "[输入数据下载](http://uoj.ac/download.php?type=problem&id=190)", "locale": "zh-CN"}}}
{"pid": "P5247", "type": "P", "difficulty": 7, "samples": [["200 5\n2 123 127\n0 4 0\n2 4 0\n1 4 0\n2 0 4", "N\nY\nN"], ["4 10\n0 1 2\n0 2 3\n0 3 1\n2 1 4\n0 0 7\n2 5 0\n1 3 2\n2 0 5\n1 0 2\n2 0 5", "N\nY\nY\nN"]], "limits": {"time": [1000, 1000, 2000, 2000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["图论", "动态树 LCT", "模板题"], "title": "【模板】动态图连通性", "background": "这是 [LOJ #122](https://loj.ac/problem/122) 的一个非官方、**不维护**的镜像，原始出题人是 EtaoinWu ，在本站的原始上传者未知。这个镜像题的数据不保证是最新的，因此推荐到 LOJ 进行练习。", "description": "这是一道模板题。\n\n你要维护一张无向简单图（即没有自环，没有重边的无向图）。你被要求加入删除一条边及查询两个点是否连通。\n\n$0.$：加入一条边。保证它不存在。   \n$1.$：删除一条边。保证它存在。   \n$2.$：查询两个点是否联通。   \n\n为了保证做法的在线性，本题采用了特殊方式的读入。\n\n假设你维护了一个变量 $\\text{last}$，初始值为 $0$ 。\n\n对于每个读入的节点 $x$，实际上询问、修改的节点编号是 $x \\text{ xor } \\text{last}$，其中 $\\text{xor}$ 是二进制异或操作。\n\n对于每次解码之后查询 $u,v$，如果它们联通，那么 $\\text{last}$ 会被更新为 $u$；否则会被更新为 $v$。", "inputFormat": "输入的第一行是两个数 $n,m$。\n\n接下来 $m$ 行，每一行三个数 $\\text{op},x,y$。$\\text{op}$ 表示操作编号。", "outputFormat": "对于每一个$op=2$ 的询问，输出一行 `Y` 或 `N` ，表示两个节点是否连通。", "hint": "由于hack数据的加入，数据分布并非如下文所述。下面的仅供参考。\n\n对于数据点 $1$，$n \\leq 200,m \\leq 200$\n\n对于数据点 $2$，$n=5,m \\leq 30$\n\n对于数据点 $3$，$n=10,m \\leq 1000$，其中查询的次数 $\\geq 900$ 次。\n\n对于数据点 $4$，$n=300,m \\leq 50000$\n\n对于数据点 $5$，$n=5000,m \\leq 200000$，没有操作 $1$，其中约 $70 \\%$ 是操作 $2$。\n\n对于数据点 $6$，$n=5000,m \\leq 200000$，没有操作 $1$，其中约 $70 \\%$ 是操作 $0$。\n\n对于数据点 $7$、$8$，$n=100,m \\leq 500000$\n\n对于数据点 $9$，$n=5000,m \\leq 500000$，图是一棵树，其直径 $\\leq 30$ 。\n\n对于数据点 $10$， $n=5000,m \\leq 500000$，图是一棵树，其每个点度数 $\\leq 10$。\n\n还有一些保证 $n \\leq 5000,m \\leq 500000$ 的附加数据。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Dynamic Graph Connectivity", "background": "This is an unofficial, **unmaintained** mirror of [LOJ #122](https://loj.ac/problem/122). The original problem setter is EtaoinWu, and the original uploader on this site is unknown. The testdata of this mirror is not guaranteed to be the latest, so it is recommended to practice on LOJ.", "description": "This is a template problem.\n\nYou need to maintain an undirected simple graph (that is, an undirected graph with no self-loops and no multiple edges). You are required to add an edge, delete an edge, and query whether two vertices are connected.\n\n$0.$: Add an edge. It is guaranteed that it does not exist.  \n$1.$: Delete an edge. It is guaranteed that it exists.  \n$2.$: Query whether two vertices are connected.  \n\nTo keep the solution online, this problem uses a special input method.\n\nAssume you maintain a variable $\\text{last}$, with initial value $0$.\n\nFor each input vertex $x$, the actual vertex index used in the query or modification is $x \\text{ xor } \\text{last}$, where $\\text{xor}$ is the bitwise XOR operation.\n\nAfter decoding each query $u,v$, if they are connected, then $\\text{last}$ will be updated to $u$; otherwise it will be updated to $v$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe next $m$ lines each contain three integers $\\text{op},x,y$. $\\text{op}$ denotes the operation number.", "outputFormat": "For each query with $op=2$, output one line `Y` or `N`, indicating whether the two vertices are connected.", "hint": "Due to the addition of hack testdata, the data distribution is not as described below. The following is for reference only.\n\nFor test point $1$, $n \\leq 200,m \\leq 200$.\n\nFor test point $2$, $n=5,m \\leq 30$.\n\nFor test point $3$, $n=10,m \\leq 1000$, and the number of queries is $\\geq 900$.\n\nFor test point $4$, $n=300,m \\leq 50000$.\n\nFor test point $5$, $n=5000,m \\leq 200000$, there is no operation $1$, and about $70 \\%$ are operation $2$.\n\nFor test point $6$, $n=5000,m \\leq 200000$, there is no operation $1$, and about $70 \\%$ are operation $0$.\n\nFor test point $7$ and $8$, $n=100,m \\leq 500000$.\n\nFor test point $9$, $n=5000,m \\leq 500000$, the graph is a tree, and its diameter is $\\leq 30$.\n\nFor test point $10$, $n=5000,m \\leq 500000$, the graph is a tree, and the degree of each vertex is $\\leq 10$.\n\nThere is also some additional testdata with guarantees $n \\leq 5000,m \\leq 500000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】动态图连通性", "background": "这是 [LOJ #122](https://loj.ac/problem/122) 的一个非官方、**不维护**的镜像，原始出题人是 EtaoinWu ，在本站的原始上传者未知。这个镜像题的数据不保证是最新的，因此推荐到 LOJ 进行练习。", "description": "这是一道模板题。\n\n你要维护一张无向简单图（即没有自环，没有重边的无向图）。你被要求加入删除一条边及查询两个点是否连通。\n\n$0.$：加入一条边。保证它不存在。   \n$1.$：删除一条边。保证它存在。   \n$2.$：查询两个点是否联通。   \n\n为了保证做法的在线性，本题采用了特殊方式的读入。\n\n假设你维护了一个变量 $\\text{last}$，初始值为 $0$ 。\n\n对于每个读入的节点 $x$，实际上询问、修改的节点编号是 $x \\text{ xor } \\text{last}$，其中 $\\text{xor}$ 是二进制异或操作。\n\n对于每次解码之后查询 $u,v$，如果它们联通，那么 $\\text{last}$ 会被更新为 $u$；否则会被更新为 $v$。", "inputFormat": "输入的第一行是两个数 $n,m$。\n\n接下来 $m$ 行，每一行三个数 $\\text{op},x,y$。$\\text{op}$ 表示操作编号。", "outputFormat": "对于每一个$op=2$ 的询问，输出一行 `Y` 或 `N` ，表示两个节点是否连通。", "hint": "由于hack数据的加入，数据分布并非如下文所述。下面的仅供参考。\n\n对于数据点 $1$，$n \\leq 200,m \\leq 200$\n\n对于数据点 $2$，$n=5,m \\leq 30$\n\n对于数据点 $3$，$n=10,m \\leq 1000$，其中查询的次数 $\\geq 900$ 次。\n\n对于数据点 $4$，$n=300,m \\leq 50000$\n\n对于数据点 $5$，$n=5000,m \\leq 200000$，没有操作 $1$，其中约 $70 \\%$ 是操作 $2$。\n\n对于数据点 $6$，$n=5000,m \\leq 200000$，没有操作 $1$，其中约 $70 \\%$ 是操作 $0$。\n\n对于数据点 $7$、$8$，$n=100,m \\leq 500000$\n\n对于数据点 $9$，$n=5000,m \\leq 500000$，图是一棵树，其直径 $\\leq 30$ 。\n\n对于数据点 $10$， $n=5000,m \\leq 500000$，图是一棵树，其每个点度数 $\\leq 10$。\n\n还有一些保证 $n \\leq 5000,m \\leq 500000$ 的附加数据。", "locale": "zh-CN"}}}
{"pid": "P5248", "type": "P", "difficulty": 2, "samples": [["10 10", "2\n0 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["Special Judge", "O2优化", "进制"], "title": "[LnOI2019SP] 快速多项式变换(FPT)", "background": "![avartar](https://cdn.luogu.com.cn/upload/pic/52800.png)", "description": "这是一道构造题。\n\n诗乃在心中想了一个$n+1$项的多项式$f(x)$。第$i$项次数为$i$，系数为$a_i$：\n\n$$f(x)=a_0+a_1x+a_2x^2+a_3x^3+ \\cdots +a_nx^n$$\n\n给定$m$以及$f(m)$的值（即当$x=m$时此多项式的值），请构造多项式，满足任意$0 \\leq a_i < m$且$a_i$为非负整数。\n\n设你构造的多项式项数为$n$，则必须满足$1 ≤ n ≤ 100$且最高项系数不为零。", "inputFormat": "两个整数，$m$、$f(m)$。", "outputFormat": "第一行输出正整数$n$，表示多项式的项数。\n\n第二行依次输出$n$个非负整数（$a_0$至$a_{n-1}$），每个非负整数之间用**一个**空格隔开。", "hint": "对于20%的数据， $ 2 ≤ m ≤ 5. $\n\n对于100%的数据，\n $ 2 ≤ m,f(m) ≤ 10^{18}.$\n\n所有数据的时间限制为 $1000ms$，空间限制为 $256MB$，可开启O2优化。", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019SP] Fast Polynomial Transform (FPT).", "background": "![avartar](https://cdn.luogu.com.cn/upload/pic/52800.png)", "description": "This is a constructive problem.\n\nShino thinks of a polynomial $f(x)$ with $n+1$ terms. The degree of the $i$-th term is $i$, and its coefficient is $a_i$:\n\n$$f(x)=a_0+a_1x+a_2x^2+a_3x^3+ \\cdots +a_nx^n$$\n\nGiven $m$ and the value of $f(m)$ (that is, the value of this polynomial when $x=m$), please construct a polynomial such that for any $0 \\leq a_i < m$, $a_i$ is a non-negative integer.\n\nLet the number of terms of the polynomial you construct be $n$. Then it must satisfy $1 \\le n \\le 100$, and the leading coefficient must be non-zero.", "inputFormat": "Two integers, $m$ and $f(m)$.", "outputFormat": "The first line outputs a positive integer $n$, which represents the number of terms of the polynomial.\n\nThe second line outputs $n$ non-negative integers ($a_0$ to $a_{n-1}$) in order, with **exactly one** space between each pair of adjacent integers.", "hint": "For $20\\%$ of the testdata, $2 \\le m \\le 5$.\n\nFor $100\\%$ of the testdata, $2 \\le m,f(m) \\le 10^{18}$.\n\nFor all testdata, the time limit is $1000\\text{ms}$ and the memory limit is $256\\text{MB}$. You may enable O2 optimization.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019SP] 快速多项式变换(FPT)", "background": "![avartar](https://cdn.luogu.com.cn/upload/pic/52800.png)", "description": "这是一道构造题。\n\n诗乃在心中想了一个$n+1$项的多项式$f(x)$。第$i$项次数为$i$，系数为$a_i$：\n\n$$f(x)=a_0+a_1x+a_2x^2+a_3x^3+ \\cdots +a_nx^n$$\n\n给定$m$以及$f(m)$的值（即当$x=m$时此多项式的值），请构造多项式，满足任意$0 \\leq a_i < m$且$a_i$为非负整数。\n\n设你构造的多项式项数为$n$，则必须满足$1 ≤ n ≤ 100$且最高项系数不为零。", "inputFormat": "两个整数，$m$、$f(m)$。", "outputFormat": "第一行输出正整数$n$，表示多项式的项数。\n\n第二行依次输出$n$个非负整数（$a_0$至$a_{n-1}$），每个非负整数之间用**一个**空格隔开。", "hint": "对于20%的数据， $ 2 ≤ m ≤ 5. $\n\n对于100%的数据，\n $ 2 ≤ m,f(m) ≤ 10^{18}.$\n\n所有数据的时间限制为 $1000ms$，空间限制为 $256MB$，可开启O2优化。", "locale": "zh-CN"}}}
{"pid": "P5249", "type": "P", "difficulty": 5, "samples": [["0.5 2 1", "0.33333333"], ["0.5 2 2", "0.66666667"], ["0.5 3 1", "0.23809524"], ["0.5 3 2", "0.28571429"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["递推", "Special Judge", "O2优化", "概率论"], "title": "[LnOI2019] 加特林轮盘赌", "background": "加特林轮盘赌是一个养生游戏。", "description": "与俄罗斯轮盘赌等手枪的赌博不同的是，加特林轮盘赌的赌具是加特林。\n\n加特林轮盘赌的规则很简单：在加特林的部分弹夹中填充子弹。游戏的参加者**坐在一个圆桌上**，轮流把加特林对着自己的头，扣动扳机一秒钟。中枪的自动退出，坚持到最后的就是胜利者。\n\n我们使用的是 2019 年最新技术的加特林，他的特点是**无需预热、子弹无限**，每一个人，在每一回合，中枪的概率是完全相同的 $P_0$。\n\n每局游戏共有 $n$ 只长脖子鹿，从 1 长脖子鹿开始，按照编号顺序从小到大进行游戏，绕着圆桌不断循环。\n\n游戏可能会循环进行多轮，直到场上仅剩下最后一只长脖子鹿时，游戏结束。\n\n给出 $P_0$ 和 $n$，询问 $k$ 号长脖子鹿最终成为**唯一幸存者**的概率 $P_k$。\n\n**如果 $P_0=0$，我们认为胜者为 $1$ 号。**", "inputFormat": "仅一行三个数，$P_0,n,k$。", "outputFormat": "一个浮点数 $P_{k}$，误差应该小于 $10^{-8}$。（请保留更多位数的小数）", "hint": "- 对于 $10\\%$ 的数据，$n \\le 100$。\n- 对于 $30\\%$ 的数据，$n \\le 500$。\n- 对于另外 $20\\%$ 的数据，$k = n$。\n- 对于 $100\\%$ 的数据，$1 \\le k \\le n \\le 10^{4}, 0 \\le P_0 \\le 1$。\n\n所有数据的时间限制为 1000ms，空间限制为256MB，可开启 O2 优化。", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019] Gatling Roulette", "background": "Gatling roulette is a wellness game.", "description": "Unlike gambling games with pistols such as Russian roulette, the game tool in Gatling roulette is a Gatling gun.\n\nThe rules of Gatling roulette are simple: bullets are loaded into some parts of the Gatling’s magazine. The players **sit at a round table**, and take turns aiming the Gatling at their own head and pulling the trigger for one second. Anyone who gets shot is eliminated immediately. The one who lasts to the end is the winner.\n\nWe use a Gatling gun with the latest 2019 technology. Its features are **no warm-up needed and unlimited bullets**. For each person, in each round, the probability of getting shot is exactly the same, $P_0$.\n\nThere are $n$ long-necked deer in each game. Starting from long-necked deer $1$, they play in increasing order by number, going around the round table in a loop.\n\nThe game may go through multiple cycles, and ends when only the last long-necked deer remains.\n\nGiven $P_0$ and $n$, find the probability $P_k$ that long-necked deer $k$ will eventually become the **only survivor**.\n\n**If $P_0=0$, we consider deer $1$ to be the winner.**", "inputFormat": "Only one line with three numbers, $P_0,n,k$.", "outputFormat": "Output a floating-point number $P_{k}$. The error should be less than $10^{-8}$. (Please keep more digits after the decimal point.)", "hint": "- For $10\\%$ of the testdata, $n \\le 100$.\n- For $30\\%$ of the testdata, $n \\le 500$.\n- For another $20\\%$ of the testdata, $k = n$.\n- For $100\\%$ of the testdata, $1 \\le k \\le n \\le 10^{4}, 0 \\le P_0 \\le 1$.\n\nFor all testdata, the time limit is 1000 ms and the memory limit is 256 MB. $O2$ optimization is allowed.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019] 加特林轮盘赌", "background": "加特林轮盘赌是一个养生游戏。", "description": "与俄罗斯轮盘赌等手枪的赌博不同的是，加特林轮盘赌的赌具是加特林。\n\n加特林轮盘赌的规则很简单：在加特林的部分弹夹中填充子弹。游戏的参加者**坐在一个圆桌上**，轮流把加特林对着自己的头，扣动扳机一秒钟。中枪的自动退出，坚持到最后的就是胜利者。\n\n我们使用的是 2019 年最新技术的加特林，他的特点是**无需预热、子弹无限**，每一个人，在每一回合，中枪的概率是完全相同的 $P_0$。\n\n每局游戏共有 $n$ 只长脖子鹿，从 1 长脖子鹿开始，按照编号顺序从小到大进行游戏，绕着圆桌不断循环。\n\n游戏可能会循环进行多轮，直到场上仅剩下最后一只长脖子鹿时，游戏结束。\n\n给出 $P_0$ 和 $n$，询问 $k$ 号长脖子鹿最终成为**唯一幸存者**的概率 $P_k$。\n\n**如果 $P_0=0$，我们认为胜者为 $1$ 号。**", "inputFormat": "仅一行三个数，$P_0,n,k$。", "outputFormat": "一个浮点数 $P_{k}$，误差应该小于 $10^{-8}$。（请保留更多位数的小数）", "hint": "- 对于 $10\\%$ 的数据，$n \\le 100$。\n- 对于 $30\\%$ 的数据，$n \\le 500$。\n- 对于另外 $20\\%$ 的数据，$k = n$。\n- 对于 $100\\%$ 的数据，$1 \\le k \\le n \\le 10^{4}, 0 \\le P_0 \\le 1$。\n\n所有数据的时间限制为 1000ms，空间限制为256MB，可开启 O2 优化。", "locale": "zh-CN"}}}
{"pid": "P5250", "type": "P", "difficulty": 3, "samples": [["7\n1 1\n1 5\n1 3\n2 3\n2 3\n2 3\n2 3", "3\n1\n5\nEmpty\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["二分", "STL"], "title": "【深基17.例5】木材仓库", "background": null, "description": "博艾市有一个木材仓库，里面可以存储各种长度的木材，但是保证没有两个木材的长度是相同的。作为仓库负责人，你有时候会进货，有时候会出货，因此需要维护这个库存。有不超过 $10^5$ 条的操作：\n\n- 进货，格式 `1 Length`：在仓库中放入一根长度为 $Length$（不超过 $10^9$）的木材。如果已经有相同长度的木材那么输出 `Already Exist`。\n- 出货，格式 `2 Length`：从仓库中取出长度为 $Length$ 的木材。如果没有刚好长度的木材，取出仓库中存在的和要求长度最接近的木材。如果有多根木材符合要求，取出比较短的一根。输出取出的木材长度。如果仓库是空的，输出 `Empty`。", "inputFormat": "第一行一个数 $m$ 代表操作次数。\n\n接下来 $m$ 行，每行一次操作，格式如题目描述所示。", "outputFormat": "对于每次操作，按照题目描述要求输出答案。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basic 17. Example 5] Timber Warehouse", "background": "", "description": "In Boai City, there is a timber warehouse that can store timber of various lengths, and it is guaranteed that no two pieces of timber have the same length. As the warehouse manager, you sometimes purchase stock and sometimes ship stock, so you need to maintain the inventory. There are no more than $10^5$ operations:\n\n- Stock in, format `1 Length`: Put a piece of timber of length $Length$ (no more than $10^9$) into the warehouse. If a piece of timber with the same length already exists, output `Already Exist`.\n- Stock out, format `2 Length`: Take out the piece of timber with length $Length$ from the warehouse. If there is no piece with exactly that length, take out the piece in the warehouse whose length is closest to the requested length. If multiple pieces satisfy this, take out the shorter one. Output the length of the timber taken out. If the warehouse is empty, output `Empty`.", "inputFormat": "The first line contains an integer $m$, representing the number of operations.\n\nThe next $m$ lines each contain one operation, in the format described in the statement.", "outputFormat": "For each operation, output the answer as required in the statement.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基17.例5】木材仓库", "background": null, "description": "博艾市有一个木材仓库，里面可以存储各种长度的木材，但是保证没有两个木材的长度是相同的。作为仓库负责人，你有时候会进货，有时候会出货，因此需要维护这个库存。有不超过 $10^5$ 条的操作：\n\n- 进货，格式 `1 Length`：在仓库中放入一根长度为 $Length$（不超过 $10^9$）的木材。如果已经有相同长度的木材那么输出 `Already Exist`。\n- 出货，格式 `2 Length`：从仓库中取出长度为 $Length$ 的木材。如果没有刚好长度的木材，取出仓库中存在的和要求长度最接近的木材。如果有多根木材符合要求，取出比较短的一根。输出取出的木材长度。如果仓库是空的，输出 `Empty`。", "inputFormat": "第一行一个数 $m$ 代表操作次数。\n\n接下来 $m$ 行，每行一次操作，格式如题目描述所示。", "outputFormat": "对于每次操作，按照题目描述要求输出答案。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5251", "type": "P", "difficulty": 6, "samples": [["9 8 4\n17 5 8 1 6 4 12 3 4\n1 1 1 1 1 1 1 3 4\n2 3 6 2\n3 1 9\n4 1 9\n4 6 9\n4 1 3\n2 4 5 4\n3 1 1\n3 1 9", "23\n23\n23\n17\n-1\n23"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "颜色段均摊（珂朵莉树 ODT）", "双指针 two-pointer"], "title": "[LnOI2019] 第二代图灵机", "background": "1989年，Abbi提出了一种抽象的计算模型 —— 第二代图灵机 (The 2nd Generation Turing Machine）。\n\n所谓的第二代图灵机就是指一个抽象的机器，它有一条长度为$n$的纸带，纸带分成了$n$个小方格，每个方格有不同的**颜色**和不同的**数字**。\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/52955.png)", "description": "第二代图灵的基本思想是用机器来模拟鹿们用纸笔进行数学运算的过程，他把这样的过程看作下列两种简单的动作：\n\n1. 在纸带上的一格写数字。\n2. 在纸带上的一段区间着色。\n\n为了测试第二代图灵机的性能，Abbi提出了一种用于判定机器是否具有智能的试验方法，即图灵试验。\n\n1. 求 $[l,r]$ 中包含所有(一共 $c$ 种)颜色，数字和最小的子区间的数字和。\n2. 求 $[l,r]$ 中没有重复颜色，数字和最大的子区间的数字和。\n\n你需要为第二代图灵机编写算法，使他能通过所有的图灵试验。为保证试验的正确性，所有数据都是随机生成的。", "inputFormat": "第一行输入两个正整数 $n,m,c$，分别表示纸带长度，操作次数和颜色总数。\n\n第二行 $n$ 个非负整数，表示每个格子上的初始数字 $a_i$。\n\n第三行 $n$ 个非负整数，表示每个格子上的颜色编号 $b_i$。\n\n接下来 $m$ 行，对应每一次操作。\n\n操作一格式：$1\\quad x\\quad y$，表示将第 $x$ 位的数字改为 $y$，保证 $1≤y≤10000$。\n\n操作二格式：$2\\quad l\\quad r\\quad y$，表示将区间 $[l,r]$ 的颜色全部改为 $y$ ，保证 $1≤y≤c$。\n\n操作三格式：$3\\quad l\\quad r$，表示询问区间$[l,r]$中包含所有(一共$c$种)颜色，数字和最小的子区间的数字和。\n\n操作四格式：$4\\quad l\\quad r$，表示询问区间$[l,r]$中没有重复颜色，数字和最大的子区间的数字和。", "outputFormat": "对于操作三和操作四，输出一个整数，表示最小或最大的数字和。\n\n对于操作三，若不存在满足条件的子区间，请输出 $-1$。", "hint": "![avatar](https://cdn.luogu.com.cn/upload/pic/53113.png)\n\n**由于数据规模较大，建议用以下方法读入一个正整数。**\n\n```cpp\nvoid read(int &x){\n\tchar ch;\n\twhile(ch = getchar(), ch < '!'); x = ch - 48;\n\twhile(ch = getchar(), ch > '!') x = (x << 3) + (x << 1) + ch - 48;\n}\n```", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019] The 2nd Generation Turing Machine", "background": "In 1989, Abbi proposed an abstract computation model — the 2nd Generation Turing Machine (The 2nd Generation Turing Machine).\n\nThe so-called 2nd Generation Turing Machine refers to an abstract machine that has a tape of length $n$. The tape is divided into $n$ small cells. Each cell has a different **color** and a different **number**.\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/52955.png)", "description": "The basic idea of the 2nd Generation Turing Machine is to use a machine to simulate the process of deer doing mathematical calculations with pen and paper. He regarded such a process as the following two simple actions:\n\n1. Write a number in one cell on the tape.\n2. Color a segment of the tape.\n\nTo test the performance of the 2nd Generation Turing Machine, Abbi proposed a method to determine whether the machine is intelligent, namely the Turing test.\n\n1. For $[l,r]$, query the sum of numbers of the subsegment with the minimum sum that contains all (a total of $c$ types of) colors.\n2. For $[l,r]$, query the sum of numbers of the subsegment with the maximum sum that has no repeated colors.\n\nYou need to write an algorithm for the 2nd Generation Turing Machine so that it can pass all Turing tests. To ensure the correctness of the tests, all testdata are randomly generated.", "inputFormat": "The first line contains three positive integers $n,m,c$, representing the tape length, the number of operations, and the total number of colors.\n\nThe second line contains $n$ non-negative integers, representing the initial number $a_i$ in each cell.\n\nThe third line contains $n$ non-negative integers, representing the color ID $b_i$ of each cell.\n\nThe next $m$ lines describe the operations.\n\nOperation 1: $1\\quad x\\quad y$, meaning to change the number at position $x$ to $y$, with $1≤y≤10000$ guaranteed.\n\nOperation 2: $2\\quad l\\quad r\\quad y$, meaning to change the colors of all cells in the interval $[l,r]$ to $y$, with $1≤y≤c$ guaranteed.\n\nOperation 3: $3\\quad l\\quad r$, meaning to query, within $[l,r]$, the sum of numbers of the subsegment with the minimum sum that contains all (a total of $c$ types of) colors.\n\nOperation 4: $4\\quad l\\quad r$, meaning to query, within $[l,r]$, the sum of numbers of the subsegment with the maximum sum that has no repeated colors.", "outputFormat": "For Operation 3 and Operation 4, output one integer, representing the minimum or maximum sum of numbers.\n\nFor Operation 3, if there is no subsegment that satisfies the condition, output $-1$.", "hint": "![avatar](https://cdn.luogu.com.cn/upload/pic/53113.png)\n\n**Since the data size is large, it is recommended to read a positive integer using the following method.**\n\n```cpp\nvoid read(int &x){\n\tchar ch;\n\twhile(ch = getchar(), ch < '!'); x = ch - 48;\n\twhile(ch = getchar(), ch > '!') x = (x << 3) + (x << 1) + ch - 48;\n}\n```\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019] 第二代图灵机", "background": "1989年，Abbi提出了一种抽象的计算模型 —— 第二代图灵机 (The 2nd Generation Turing Machine）。\n\n所谓的第二代图灵机就是指一个抽象的机器，它有一条长度为$n$的纸带，纸带分成了$n$个小方格，每个方格有不同的**颜色**和不同的**数字**。\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/52955.png)", "description": "第二代图灵的基本思想是用机器来模拟鹿们用纸笔进行数学运算的过程，他把这样的过程看作下列两种简单的动作：\n\n1. 在纸带上的一格写数字。\n2. 在纸带上的一段区间着色。\n\n为了测试第二代图灵机的性能，Abbi提出了一种用于判定机器是否具有智能的试验方法，即图灵试验。\n\n1. 求 $[l,r]$ 中包含所有(一共 $c$ 种)颜色，数字和最小的子区间的数字和。\n2. 求 $[l,r]$ 中没有重复颜色，数字和最大的子区间的数字和。\n\n你需要为第二代图灵机编写算法，使他能通过所有的图灵试验。为保证试验的正确性，所有数据都是随机生成的。", "inputFormat": "第一行输入两个正整数 $n,m,c$，分别表示纸带长度，操作次数和颜色总数。\n\n第二行 $n$ 个非负整数，表示每个格子上的初始数字 $a_i$。\n\n第三行 $n$ 个非负整数，表示每个格子上的颜色编号 $b_i$。\n\n接下来 $m$ 行，对应每一次操作。\n\n操作一格式：$1\\quad x\\quad y$，表示将第 $x$ 位的数字改为 $y$，保证 $1≤y≤10000$。\n\n操作二格式：$2\\quad l\\quad r\\quad y$，表示将区间 $[l,r]$ 的颜色全部改为 $y$ ，保证 $1≤y≤c$。\n\n操作三格式：$3\\quad l\\quad r$，表示询问区间$[l,r]$中包含所有(一共$c$种)颜色，数字和最小的子区间的数字和。\n\n操作四格式：$4\\quad l\\quad r$，表示询问区间$[l,r]$中没有重复颜色，数字和最大的子区间的数字和。", "outputFormat": "对于操作三和操作四，输出一个整数，表示最小或最大的数字和。\n\n对于操作三，若不存在满足条件的子区间，请输出 $-1$。", "hint": "![avatar](https://cdn.luogu.com.cn/upload/pic/53113.png)\n\n**由于数据规模较大，建议用以下方法读入一个正整数。**\n\n```cpp\nvoid read(int &x){\n\tchar ch;\n\twhile(ch = getchar(), ch < '!'); x = ch - 48;\n\twhile(ch = getchar(), ch > '!') x = (x << 3) + (x << 1) + ch - 48;\n}\n```", "locale": "zh-CN"}}}
{"pid": "P5252", "type": "P", "difficulty": 7, "samples": [["3\n1.0 1.0 1.0\n1.0 4.0 1.0\n5.0 1.0 1.0", "3.00 2.50 3.50"], ["3\n4.0 1.0 1.0\n4.0 7.0 1.0\n5.0 5.0 3.0", "4.63 4.00 4.07"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge"], "title": "[LnOI2019] 东京夏日相会", "background": "![avartar](https://cdn.luogu.com.cn/upload/pic/52827.png)\n\n「听说有烟火大会在下周举办呢」\n\n「诶？ 那种人多的地方我不太喜欢呢」\n\n「啊， 那我还是问问别人好了╭(╯^╰)╮」\n\n「唔， 好像还是很有趣呢。我说不定会去吧(⊙﹏⊙)b」\n", "description": "当然上面发生的事情和Abbi没有任何一点关系。作为一只长(zhang)了脖子的单身鹿，Abbi只能在家拿着“望远镜”孤独地在远处欣赏烟火大会。\n\n![avartar](https://cdn.luogu.com.cn/upload/pic/52828.png)\n\n~~啥？什么狙击枪？这是望远镜啊！（认真）~~\n\n为了看到夜空中所有的烟花，Abbi需要调整“望远镜”的放大倍数与位置。夜空可近似地看成一个平面，其中第$i$朵烟花可以近似地看作一个圆心为$(x_i,y_i)$，半径为$r_i$的圆。\n\nAbbi的望远镜视野可以近似地看作一个圆。因为调整放大倍数很累，因此Abbi希望在满足所有烟花都**完整**地出现在视野中的同时，视野的半径尽可能小。请你求出视野的圆心坐标与半径。", "inputFormat": "第一行一个整数$n$，表示有$n$朵烟花。\n\n第二行~第$n+1$行，每行三个实数$x_i$、$y_i$和$r_i$，表示每朵烟花的圆心坐标与半径。\n", "outputFormat": "第一行三个实数，$X$、$Y$、$R$，分别表示望远镜视野的圆心坐标与半径。你的答案中半径与标准答案的误差不得超过$0.01$，圆心坐标与标准答案的误差不得超过$0.04$。", "hint": "![avartar](https://cdn.luogu.com.cn/upload/pic/52900.png)\n\n**请开启O2优化。建议使用读入优化或scanf读入数据。**", "locale": "zh-CN", "translations": {"en": {"title": "[LnOI2019] Tokyo Summer Meetup", "background": "![avartar](https://cdn.luogu.com.cn/upload/pic/52827.png)\n\n“I heard there will be a fireworks festival next week.”\n\n“Huh? I don’t really like places with lots of people.”\n\n“Ah, then I’ll just ask someone else. ╭(╯^╰)╮”\n\n“Hmm, it still sounds fun. I might go. (⊙﹏⊙)b”", "description": "Of course, what happened above has absolutely nothing to do with Abbi. As a single deer with a long (zhang) neck, Abbi can only stay at home, holding a “telescope” and lonely watching the fireworks festival from afar.\n\n![avartar](https://cdn.luogu.com.cn/upload/pic/52828.png)\n\n~~What? A sniper rifle? This is a telescope! (seriously)~~\n\nTo see all the fireworks in the night sky, Abbi needs to adjust the magnification and position of the “telescope”. The night sky can be approximately considered as a plane. The $i$-th firework can be approximately considered as a circle with center $(x_i, y_i)$ and radius $r_i$.\n\nThe telescope’s field of view can be approximately considered as a circle. Because adjusting the magnification is tiring, Abbi wants the radius of the field of view to be as small as possible while ensuring that all fireworks appear **completely** inside the field of view. Please find the center coordinates and the radius of the field-of-view circle.", "inputFormat": "The first line contains an integer $n$, meaning there are $n$ fireworks.\n\nLines $2$ to $n + 1$ each contain three real numbers $x_i$, $y_i$, and $r_i$, representing the center coordinates and radius of each firework.", "outputFormat": "Output three real numbers $X$, $Y$, and $R$ on the first line, representing the center coordinates and radius of the telescope’s field of view. The error of the radius compared with the standard answer must not exceed $0.01$, and the error of the center coordinates compared with the standard answer must not exceed $0.04$.", "hint": "![avartar](https://cdn.luogu.com.cn/upload/pic/52900.png)\n\n**Please enable O2 optimization. It is recommended to use fast input or scanf to read the testdata.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[LnOI2019] 东京夏日相会", "background": "![avartar](https://cdn.luogu.com.cn/upload/pic/52827.png)\n\n「听说有烟火大会在下周举办呢」\n\n「诶？ 那种人多的地方我不太喜欢呢」\n\n「啊， 那我还是问问别人好了╭(╯^╰)╮」\n\n「唔， 好像还是很有趣呢。我说不定会去吧(⊙﹏⊙)b」\n", "description": "当然上面发生的事情和Abbi没有任何一点关系。作为一只长(zhang)了脖子的单身鹿，Abbi只能在家拿着“望远镜”孤独地在远处欣赏烟火大会。\n\n![avartar](https://cdn.luogu.com.cn/upload/pic/52828.png)\n\n~~啥？什么狙击枪？这是望远镜啊！（认真）~~\n\n为了看到夜空中所有的烟花，Abbi需要调整“望远镜”的放大倍数与位置。夜空可近似地看成一个平面，其中第$i$朵烟花可以近似地看作一个圆心为$(x_i,y_i)$，半径为$r_i$的圆。\n\nAbbi的望远镜视野可以近似地看作一个圆。因为调整放大倍数很累，因此Abbi希望在满足所有烟花都**完整**地出现在视野中的同时，视野的半径尽可能小。请你求出视野的圆心坐标与半径。", "inputFormat": "第一行一个整数$n$，表示有$n$朵烟花。\n\n第二行~第$n+1$行，每行三个实数$x_i$、$y_i$和$r_i$，表示每朵烟花的圆心坐标与半径。\n", "outputFormat": "第一行三个实数，$X$、$Y$、$R$，分别表示望远镜视野的圆心坐标与半径。你的答案中半径与标准答案的误差不得超过$0.01$，圆心坐标与标准答案的误差不得超过$0.04$。", "hint": "![avartar](https://cdn.luogu.com.cn/upload/pic/52900.png)\n\n**请开启O2优化。建议使用读入优化或scanf读入数据。**", "locale": "zh-CN"}}}
{"pid": "P5253", "type": "P", "difficulty": 4, "samples": [["4", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2013", "各省省选", "江苏", "O2优化"], "title": "[JSOI2013] 丢番图", "background": "丢番图是亚历山大时期埃及著名的数学家。他是最早研究整数系数不定方程的数学家之一。\n\n为了纪念他，这些方程一般被称作丢番图方程。最著名的丢番图方程之一是\n\n$$x^n+y^n=z^n$$\n\n费马提出，对于 $n>2$, $x,y,z$ 没有正整数解。这被称为“费马大定理”，它的证明直到最近才被安德鲁·怀尔斯（AndrewWiles）证明。", "description": "考虑如下的丢番图方程：\n\n$$\\frac{1}{x}~+~\\frac{1}{y}~=~\\frac{1}{n}~,(x,y,n~\\in~\\mathbb{N}^+)$$\n\n小 G 对下面这个问题十分感兴趣：对于一个给定的正整数 $n$，有多少种本质不同的解满足上面的方程？例如 $n=4$，有三种本质不同 $(x~\\leq~y)$ 的解：\n\n> $\\frac{1}{5}+\\frac{1}{20}~=~\\frac{1}{4}$\n>\n> $\\frac{1}{6}+\\frac{1}{12}~=~\\frac{1}{4}$\n>\n> $\\frac{1}{8}+\\frac{1}{8}~=~\\frac{1}{4}$\n\n显然，对于更大的 $n$，没有意义去列举所有本质不同的解。你能否帮助小 G 快速地求出对于给定 $n$，满足上面方程的本质不同的解的个数？", "inputFormat": "一行，仅一个整数 $n$。", "outputFormat": "一行一个整数代表答案。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证 $1\\leq n \\leq 10^{14}$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Diophantus", "background": "Diophantus was a famous mathematician in Egypt during the Alexandrian period. He was one of the earliest mathematicians to study indeterminate equations with integer coefficients.\n\nTo honor him, such equations are generally called Diophantine equations. One of the most famous Diophantine equations is\n\n$$x^n+y^n=z^n$$\n\nFermat proposed that for $n>2$, $x,y,z$ have no positive integer solutions. This is called “Fermat's Last Theorem”, and its proof was not completed until recently by Andrew Wiles (AndrewWiles).", "description": "Consider the following Diophantine equation:\n\n$$\\frac{1}{x}~+~\\frac{1}{y}~=~\\frac{1}{n}~,(x,y,n~\\in~\\mathbb{N}^+)$$\n\nXiao G is very interested in the following question: for a given positive integer $n$, how many essentially different solutions satisfy the equation above? For example, when $n=4$, there are three essentially different solutions $(x~\\leq~y)$:\n\n> $\\frac{1}{5}+\\frac{1}{20}~=~\\frac{1}{4}$\n>\n> $\\frac{1}{6}+\\frac{1}{12}~=~\\frac{1}{4}$\n>\n> $\\frac{1}{8}+\\frac{1}{8}~=~\\frac{1}{4}$\n\nObviously, for larger $n$, it is meaningless to list all essentially different solutions. Can you help Xiao G quickly find, for a given $n$, the number of essentially different solutions to the equation above?", "inputFormat": "One line with only one integer $n$.", "outputFormat": "Output one line with one integer, representing the answer.", "hint": "#### Constraints\n\nFor all testdata, it is guaranteed that $1 \\leq n \\leq 10^{14}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 丢番图", "background": "丢番图是亚历山大时期埃及著名的数学家。他是最早研究整数系数不定方程的数学家之一。\n\n为了纪念他，这些方程一般被称作丢番图方程。最著名的丢番图方程之一是\n\n$$x^n+y^n=z^n$$\n\n费马提出，对于 $n>2$, $x,y,z$ 没有正整数解。这被称为“费马大定理”，它的证明直到最近才被安德鲁·怀尔斯（AndrewWiles）证明。", "description": "考虑如下的丢番图方程：\n\n$$\\frac{1}{x}~+~\\frac{1}{y}~=~\\frac{1}{n}~,(x,y,n~\\in~\\mathbb{N}^+)$$\n\n小 G 对下面这个问题十分感兴趣：对于一个给定的正整数 $n$，有多少种本质不同的解满足上面的方程？例如 $n=4$，有三种本质不同 $(x~\\leq~y)$ 的解：\n\n> $\\frac{1}{5}+\\frac{1}{20}~=~\\frac{1}{4}$\n>\n> $\\frac{1}{6}+\\frac{1}{12}~=~\\frac{1}{4}$\n>\n> $\\frac{1}{8}+\\frac{1}{8}~=~\\frac{1}{4}$\n\n显然，对于更大的 $n$，没有意义去列举所有本质不同的解。你能否帮助小 G 快速地求出对于给定 $n$，满足上面方程的本质不同的解的个数？", "inputFormat": "一行，仅一个整数 $n$。", "outputFormat": "一行一个整数代表答案。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证 $1\\leq n \\leq 10^{14}$。", "locale": "zh-CN"}}}
{"pid": "P5254", "type": "P", "difficulty": 5, "samples": [["3 4\ntiet\noink\nezin\nzenit", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["字符串", "2013", "各省省选", "江苏", "O2优化", "哈希 hashing", "bitset"], "title": "[JSOI2013] 广告计划", "background": "如今，在建筑的墙面上或者篱笆桩的表面上涂上一些广告，是一种新的吸引眼球的方法。", "description": "现在，小G 运营的一家小公司，决定也试着这样做做广告。小G在他的篱笆桩上腾出了一些地方供广告使用。每一个篱笆桩都是一个水平的1\\*1\\*L的 4 棱柱，其中有一个 1\\*L的面是可以做广告的。1\\*L的面上划出了 L 个1\\*1 的小正方形（更具体地说是连续L个水平排列的正方形），每个正方形内写上一个字母。 时间久了，广告做多了难免会出现一些比较麻烦的情况，比如计划改变或者制作出错，因此小 G 的仓库里面积累了好多没有用的，上面已经写上 L 个字母的篱笆桩。（所有的篱笆桩的大小都是一样的，他们唯一的区别仅仅在于上面写了什么字母）。 小G 决定对于这些篱笆桩进行重新利用，并且有了一些新的想法。\n\n如果将这些篱笆桩竖直的叠放起来，并且依次从左往右，对于每一个篱笆桩顺次从上到下读出上面的字母，那么我们可以得到一些新的比较长的单词，如下图：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54049.png)\n\n\n这些新的单词能满足小G的一些新的需要。当然，基于美学考虑，小G 是不允许你删改篱笆桩上已经写上的字母的。 我们更具体地描述这个过程。我们将 K个长度为 L的篱笆桩叠在一起，可以得到一个写有 K行L列共K*L个字母的面，每一个字母都在对应的唯一的格子里。\n\n我们从左上角开始依次向下读出每一个字母可以得到一个字母的序列，比如上图中的这个例子，那么我们读出的结果就是“TOEIIZENITKN”。如果，这个串中有我们所需要的单词，那么显然我们只需要将一些格子刷白，就可以得到我们所需要的了。举个例子，比如小G想要给圣彼得堡的足球队泽尼特队做个广告，那么很显然只要按照上图中的做法就可以达到小G想要的效果了。\n\n现在小G已经想好了要做怎样的广告，同时也提供给你了小G仓库中的篱笆桩的类型的描述，你可以认为每一种类型的篱笆桩都是有无数个的。现在小G 想知道至少需要多少个篱笆桩叠起来才可以做出小G想要的广告。", "inputFormat": "第一行两个自然数，N和L。\n \n接下来N 行，每行包含 L个小写字母，描述一种篱笆桩上写着的字母。保证不同类型的篱笆桩上的字母序列都是不一样的，每一种类型的篱笆桩都是有无数个。\n\n最后一行是一个字符串s，表示小G 想好的广告词。", "outputFormat": "第一行一个整数K，表示所需要的最少数量的篱笆桩（注意是数量，并不是种类数）。", "hint": "$1~\\leq~N,~L~\\leq~100$\n\n$1~\\leq~|s|~\\leq~200$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Advertising Plan", "background": "Nowadays, painting some advertisements on the walls of buildings or on the surface of fence posts is a new way to attract attention.", "description": "Now, a small company run by Little G decided to try this kind of advertising as well. Little G freed up some space on his fence posts for advertisements. Each fence post is a horizontal $1*1*L$ quadrangular prism, and one $1*L$ face can be used for advertising. The $1*L$ face is divided into $L$ $1*1$ small squares (more specifically, $L$ consecutive squares arranged horizontally), and each square contains one letter.\n\nOver time, with more and more ads, troublesome situations may occur, such as plan changes or production mistakes. As a result, Little G’s warehouse has accumulated many useless fence posts that already have $L$ letters written on them. (All fence posts have the same size; the only difference is what letters are written on them.) Little G decided to reuse these fence posts and came up with some new ideas.\n\nIf we stack these fence posts vertically, and then from left to right, for each fence post read the letters on it from top to bottom, we can obtain some new longer words, as shown in the picture:\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54049.png)\n\nThese new words can meet some new needs of Little G. Of course, for aesthetic reasons, Little G does not allow you to delete or modify the letters that are already written on the fence posts. We describe this process more precisely.\n\nWe stack $K$ fence posts of length $L$ together, obtaining a face with $K$ rows and $L$ columns, containing a total of $K*L$ letters, where each letter lies in its own unique cell.\n\nStarting from the top-left corner and reading each letter downward in order, we get a sequence of letters. For example, in the figure above, the result is “TOEIIZENITKN”. If this string contains the word we need, then obviously we only need to paint some cells white to obtain the desired word. For instance, if Little G wants to make an ad for Zenit, the football team of Saint Petersburg, then clearly the method in the picture can achieve what Little G wants.\n\nNow Little G has decided what advertisement to make, and he also provides you with the descriptions of the types of fence posts in his warehouse. You may assume that there are infinitely many fence posts of each type. Little G now wants to know the minimum number of fence posts that must be stacked to produce the advertisement Little G wants.", "inputFormat": "The first line contains two natural numbers, $N$ and $L$.\n\nThe next $N$ lines each contain $L$ lowercase letters, describing the letters written on one type of fence post. It is guaranteed that the letter sequences on different types of fence posts are all different, and there are infinitely many fence posts of each type.\n\nThe last line is a string $s$, representing the advertising slogan Little G has decided on.", "outputFormat": "The first line contains an integer $K$, indicating the minimum number of fence posts needed (note that this is the quantity, not the number of types).", "hint": "$1~\\leq~N,~L~\\leq~100$\n\n$1~\\leq~|s|~\\leq~200$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 广告计划", "background": "如今，在建筑的墙面上或者篱笆桩的表面上涂上一些广告，是一种新的吸引眼球的方法。", "description": "现在，小G 运营的一家小公司，决定也试着这样做做广告。小G在他的篱笆桩上腾出了一些地方供广告使用。每一个篱笆桩都是一个水平的1\\*1\\*L的 4 棱柱，其中有一个 1\\*L的面是可以做广告的。1\\*L的面上划出了 L 个1\\*1 的小正方形（更具体地说是连续L个水平排列的正方形），每个正方形内写上一个字母。 时间久了，广告做多了难免会出现一些比较麻烦的情况，比如计划改变或者制作出错，因此小 G 的仓库里面积累了好多没有用的，上面已经写上 L 个字母的篱笆桩。（所有的篱笆桩的大小都是一样的，他们唯一的区别仅仅在于上面写了什么字母）。 小G 决定对于这些篱笆桩进行重新利用，并且有了一些新的想法。\n\n如果将这些篱笆桩竖直的叠放起来，并且依次从左往右，对于每一个篱笆桩顺次从上到下读出上面的字母，那么我们可以得到一些新的比较长的单词，如下图：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54049.png)\n\n\n这些新的单词能满足小G的一些新的需要。当然，基于美学考虑，小G 是不允许你删改篱笆桩上已经写上的字母的。 我们更具体地描述这个过程。我们将 K个长度为 L的篱笆桩叠在一起，可以得到一个写有 K行L列共K*L个字母的面，每一个字母都在对应的唯一的格子里。\n\n我们从左上角开始依次向下读出每一个字母可以得到一个字母的序列，比如上图中的这个例子，那么我们读出的结果就是“TOEIIZENITKN”。如果，这个串中有我们所需要的单词，那么显然我们只需要将一些格子刷白，就可以得到我们所需要的了。举个例子，比如小G想要给圣彼得堡的足球队泽尼特队做个广告，那么很显然只要按照上图中的做法就可以达到小G想要的效果了。\n\n现在小G已经想好了要做怎样的广告，同时也提供给你了小G仓库中的篱笆桩的类型的描述，你可以认为每一种类型的篱笆桩都是有无数个的。现在小G 想知道至少需要多少个篱笆桩叠起来才可以做出小G想要的广告。", "inputFormat": "第一行两个自然数，N和L。\n \n接下来N 行，每行包含 L个小写字母，描述一种篱笆桩上写着的字母。保证不同类型的篱笆桩上的字母序列都是不一样的，每一种类型的篱笆桩都是有无数个。\n\n最后一行是一个字符串s，表示小G 想好的广告词。", "outputFormat": "第一行一个整数K，表示所需要的最少数量的篱笆桩（注意是数量，并不是种类数）。", "hint": "$1~\\leq~N,~L~\\leq~100$\n\n$1~\\leq~|s|~\\leq~200$", "locale": "zh-CN"}}}
{"pid": "P5255", "type": "P", "difficulty": 5, "samples": [["2 2 5", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2013", "各省省选", "江苏", "O2优化"], "title": "[JSOI2013] 美丽家园", "background": "", "description": "现在富裕的家庭都有了自己的别墅，别墅的院子往往大家选择铺上黑白两色的地砖。如何铺地砖是很有学问的，因为这涉及到美学方面的问题。怎样铺是美的呢？先看下面两组：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54050.png)\n \nFigure 1 中的就被人们认定为比较美丽的，而 Figure 2 中的铺法则是不美丽的了。因为人们认为，如果出现一块 2*2 的区域里，只有一种颜色，那这就是不美丽的，反之则是美丽的。\n\n现在，小 G 的公司拿到了一个任务，一块 N*M 的院子必须铺上地砖。爱美之心人皆有之，主人家自然希望这块院子地砖的铺法是美丽的，所以他首先想让小 G 的公司拿出设计方案的总数来。\n\n而且这户主人家似乎对 P这个数特别迷信，所以他希望得到的总方案数对P取模后的结果。", "inputFormat": "仅有一行包含三个用空格隔开的正整数 $N,~M,~P$, 分别与题目描述中的数据对应。", "outputFormat": "输出总方案数对 $P$ 取模后的结果。", "hint": "$1~\\leq~N~\\leq~10^{100}$\n\n$1~\\leq~M~\\leq~5$\n\n$1~\\leq~P~\\leq~10000$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Beautiful Home", "background": "", "description": "Nowadays, wealthy families often have their own villas, and the courtyard of a villa is usually paved with black and white tiles. How to pave the tiles is quite a sophisticated matter, because it involves aesthetics. What kind of paving is considered beautiful? Look at the following two examples:\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54050.png)\n\nThe one in Figure 1 is considered relatively beautiful, while the paving in Figure 2 is not beautiful. This is because people believe that if there exists a $2*2$ area where there is only one color, then it is not beautiful; otherwise, it is beautiful.\n\nNow, Xiao G's company has received a task: a courtyard of size $N*M$ must be paved with tiles. Everyone loves beauty, so the owner naturally hopes the tiling of this courtyard is beautiful. Therefore, he first wants Xiao G's company to provide the total number of design plans.\n\nMoreover, the owner seems to be especially superstitious about the number $P$, so he wants the result to be the total number of plans modulo $P$.", "inputFormat": "There is only one line containing three positive integers $N,~M,~P$ separated by spaces, corresponding to the values described in the statement.", "outputFormat": "Output the total number of plans modulo $P$.", "hint": "$1~\\leq~N~\\leq~10^{100}$\n\n$1~\\leq~M~\\leq~5$\n\n$1~\\leq~P~\\leq~10000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 美丽家园", "background": "", "description": "现在富裕的家庭都有了自己的别墅，别墅的院子往往大家选择铺上黑白两色的地砖。如何铺地砖是很有学问的，因为这涉及到美学方面的问题。怎样铺是美的呢？先看下面两组：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54050.png)\n \nFigure 1 中的就被人们认定为比较美丽的，而 Figure 2 中的铺法则是不美丽的了。因为人们认为，如果出现一块 2*2 的区域里，只有一种颜色，那这就是不美丽的，反之则是美丽的。\n\n现在，小 G 的公司拿到了一个任务，一块 N*M 的院子必须铺上地砖。爱美之心人皆有之，主人家自然希望这块院子地砖的铺法是美丽的，所以他首先想让小 G 的公司拿出设计方案的总数来。\n\n而且这户主人家似乎对 P这个数特别迷信，所以他希望得到的总方案数对P取模后的结果。", "inputFormat": "仅有一行包含三个用空格隔开的正整数 $N,~M,~P$, 分别与题目描述中的数据对应。", "outputFormat": "输出总方案数对 $P$ 取模后的结果。", "hint": "$1~\\leq~N~\\leq~10^{100}$\n\n$1~\\leq~M~\\leq~5$\n\n$1~\\leq~P~\\leq~10000$", "locale": "zh-CN"}}}
{"pid": "P5256", "type": "P", "difficulty": 5, "samples": [["3\nAiBjCiDECjDiFGC\nAaBiCaDECiDaFGC\ncDEcDEbDE\naDEbDE\nccddef\naab", "1\n1\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2013", "各省省选", "江苏", "O2优化", "哈希 hashing", "KMP 算法"], "title": "[JSOI2013] 编程作业", "background": null, "description": "考虑到如下的两段代码，很容易发现他们其实是一样的。\n\n#### 代码1\n\n```cpp\nint i, j;\ni = 3;\nj = i + 1;\n```\n\n#### 代码2\n\n```cpp\nint a, i;\na = 3;\ni = a + 1;\n```\n\n这是因为这两段代码之间唯一的差异，只是他们更换了一下变量名，比如第一段代码中的 `i` 变成了第二段的 `a`，第一段的 `j` 变成了第二段的 `i` 。而其他的常量，例如 `3`，`1` 或者其他的关键字和运算符，比如 `int`，`+` 和 `;`。都是没有发生变化的。 \n\n不过注意到如下的代码片段，我们并不能简单认为这是一样的，因为这不是一个简单的替换，而是可以导致不同运算结果的。\n#### 代码3\n\n```cpp\na = 3;\nb = 3;\n```\n\n#### 代码4\n```cpp\nc = 3;\nc = 3; \n```\n\n为了简化问题，我们用大写字母来表示所有的关键字、常量等非变量符号。\n\n假如我们采用如下的替换表：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54051.png)\n\n那么最开始给出的两段雷同代码就可以分别写成 `AiBjCiDECjDiFGC` 以及 `AaBiCaDECiDaFGC`。\n\n或者简单的说，我们认为这两段代码是一样的。\n\n现在请写一个程序，处理若干这样的代码雷同检测问题：给一个完整代码以及一个较短的代码片段，请求出，这个代码片段在完整代码中一共出现了多少次（代码片段出现的位置可以重叠）。\n\n为了简单起见，我们认为程序中只会至多出现 $\\text a\\sim \\text z$ 这 $26$ 个变量，同时也至\n多只有 $\\text A\\sim \\text Z$ 这 $26$ 个非变量符号。", "inputFormat": "第一行包含一个整数 $Q$ 表示此数据中一共包含 $Q$ 个询问。\n\n接下来 $2Q$ 行，每两行为一个询问。\n\n每个询问中的第一行包含一个字符串 $S$，表示完整代码，第二行包含一个字符串 $T$，表示需要检测出现次数的代码片段。", "outputFormat": "一共输出 $Q$ 行，每行一个整数，表示对应代码片段的出现次数。", "hint": "#### 样例说明\n前两个样例均为题目中所举例的代码段。第三个样例中，在完整代码 $S$ 中与代码片段 $T$ 一样的片段为：`ccd` 和 `dde`\n\n#### 数据范围\n$Q<=3,|T|<=10^5,|S|<=10^6$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Programming Assignment", "background": "", "description": "Consider the following two pieces of code. It is easy to see that they are actually the same.\n\n#### Code 1\n\n```cpp\nint i, j;\ni = 3;\nj = i + 1;\n```\n\n#### Code 2\n\n```cpp\nint a, i;\na = 3;\ni = a + 1;\n```\n\nThis is because the only difference between these two pieces of code is that they rename the variables. For example, `i` in the first code becomes `a` in the second code, and `j` in the first code becomes `i` in the second code. All other constants, such as `3` and `1`, and other keywords and operators, such as `int`, `+`, and `;`, do not change.\n\nHowever, for the following code fragments, we cannot simply treat them as the same, because this is not a simple replacement and it can lead to different computation results.\n\n#### Code 3\n\n```cpp\na = 3;\nb = 3;\n```\n\n#### Code 4\n\n```cpp\nc = 3;\nc = 3; \n```\n\nTo simplify the problem, we use uppercase letters to represent all non-variable symbols, such as keywords and constants.\n\nSuppose we use the following substitution table:\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54051.png)\n\nThen the two similar code pieces given at the beginning can be written as `AiBjCiDECjDiFGC` and `AaBiCaDECiDaFGC`, respectively.\n\nIn other words, we consider these two pieces of code to be the same.\n\nNow please write a program to handle several such code similarity detection queries: given a full code string and a shorter code fragment, find how many times this fragment appears in the full code (the occurrence positions may overlap).\n\nFor simplicity, we assume that at most the $26$ variables $\\text a\\sim \\text z$ may appear in the program, and at most the $26$ non-variable symbols $\\text A\\sim \\text Z$ may appear.", "inputFormat": "The first line contains an integer $Q$, indicating that this testdata contains $Q$ queries in total.\n\nThe next $2Q$ lines describe the queries, with every two lines forming one query.\n\nIn each query, the first line contains a string $S$, representing the full code, and the second line contains a string $T$, representing the code fragment whose number of occurrences needs to be checked.", "outputFormat": "Output $Q$ lines in total. Each line contains an integer, representing the number of occurrences of the corresponding code fragment.", "hint": "#### Sample Explanation\n\nIn the first two samples, the code fragments are the examples given in the statement. In the third sample, the fragments in the full code $S$ that are the same as the code fragment $T$ are: `ccd` and `dde`.\n\n#### Constraints\n\n$Q<=3,|T|<=10^5,|S|<=10^6$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 编程作业", "background": null, "description": "考虑到如下的两段代码，很容易发现他们其实是一样的。\n\n#### 代码1\n\n```cpp\nint i, j;\ni = 3;\nj = i + 1;\n```\n\n#### 代码2\n\n```cpp\nint a, i;\na = 3;\ni = a + 1;\n```\n\n这是因为这两段代码之间唯一的差异，只是他们更换了一下变量名，比如第一段代码中的 `i` 变成了第二段的 `a`，第一段的 `j` 变成了第二段的 `i` 。而其他的常量，例如 `3`，`1` 或者其他的关键字和运算符，比如 `int`，`+` 和 `;`。都是没有发生变化的。 \n\n不过注意到如下的代码片段，我们并不能简单认为这是一样的，因为这不是一个简单的替换，而是可以导致不同运算结果的。\n#### 代码3\n\n```cpp\na = 3;\nb = 3;\n```\n\n#### 代码4\n```cpp\nc = 3;\nc = 3; \n```\n\n为了简化问题，我们用大写字母来表示所有的关键字、常量等非变量符号。\n\n假如我们采用如下的替换表：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54051.png)\n\n那么最开始给出的两段雷同代码就可以分别写成 `AiBjCiDECjDiFGC` 以及 `AaBiCaDECiDaFGC`。\n\n或者简单的说，我们认为这两段代码是一样的。\n\n现在请写一个程序，处理若干这样的代码雷同检测问题：给一个完整代码以及一个较短的代码片段，请求出，这个代码片段在完整代码中一共出现了多少次（代码片段出现的位置可以重叠）。\n\n为了简单起见，我们认为程序中只会至多出现 $\\text a\\sim \\text z$ 这 $26$ 个变量，同时也至\n多只有 $\\text A\\sim \\text Z$ 这 $26$ 个非变量符号。", "inputFormat": "第一行包含一个整数 $Q$ 表示此数据中一共包含 $Q$ 个询问。\n\n接下来 $2Q$ 行，每两行为一个询问。\n\n每个询问中的第一行包含一个字符串 $S$，表示完整代码，第二行包含一个字符串 $T$，表示需要检测出现次数的代码片段。", "outputFormat": "一共输出 $Q$ 行，每行一个整数，表示对应代码片段的出现次数。", "hint": "#### 样例说明\n前两个样例均为题目中所举例的代码段。第三个样例中，在完整代码 $S$ 中与代码片段 $T$ 一样的片段为：`ccd` 和 `dde`\n\n#### 数据范围\n$Q<=3,|T|<=10^5,|S|<=10^6$", "locale": "zh-CN"}}}
{"pid": "P5257", "type": "P", "difficulty": 6, "samples": [["2", "35"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2013", "各省省选", "矩阵运算", "江苏", "O2优化"], "title": "[JSOI2013] 密码", "background": "Will 有一个神秘盒，传说只要有人能解开神秘盒上的密码，就可以预知未来（比如知道这道题的标程是怎样的），你愿意来尝试一下么？", "description": "对于一个 $m$ 位的十进制整数 $N~=~(\\overline{n_1 n_2 n_3 \\dots n_m})_{10}$，定义 $g(N)~=~\\sum_{i = 1}^{m} n_i$。\n\n定义集合 $S_N~=~\\{x~|~x~>~0,~g(x)~\\leq~N,x~\\text{的十进制表示中任意位不为} 0\\}$。\n\n给定 $n$，求\n\n$$f(n)~=~\\sum_{x \\in S_n} \\sum_{y \\in S_n \\land x < y} x~\\times~y$$\n\n答案对 $10^6+3$ 取模。", "inputFormat": "一行一个正整数 $n$。", "outputFormat": "一行一个整数代表答案对 $10^6 + 3$ 取模的结果。", "hint": "#### 样例输入输出 1 解释\n\n$S_n={1, 2, 11}$，故 $f(N)~=~1 \\times 2+1 \\times 11+2 \\times 11~=~35$。\n\n---\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $3~\\leq~n~\\leq~10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Password", "background": "Will has a mysterious box. It is said that if someone can crack the password on the box, they can foresee the future (for example, know what the official solution of this problem looks like). Would you like to give it a try?", "description": "For an $m$-digit decimal integer $N~=~(\\overline{n_1 n_2 n_3 \\dots n_m})_{10}$, define $g(N)~=~\\sum_{i = 1}^{m} n_i$.\n\nDefine the set $S_N~=~\\{x~|~x~>~0,~g(x)~\\leq~N,x~\\text{ has no digit equal to } 0 \\text{ in its decimal representation}\\}$.\n\nGiven $n$, compute\n\n$$f(n)~=~\\sum_{x \\in S_n} \\sum_{y \\in S_n \\land x < y} x~\\times~y$$\n\nOutput the answer modulo $10^6+3$.", "inputFormat": "One line with a positive integer $n$.", "outputFormat": "One line with one integer, representing the result of the answer modulo $10^6 + 3$.", "hint": "#### Explanation for Sample Input/Output 1\n\n$S_n={1, 2, 11}$, so $f(N)~=~1 \\times 2+1 \\times 11+2 \\times 11~=~35$.\n\n---\n\n#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that $3~\\leq~n~\\leq~10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 密码", "background": "Will 有一个神秘盒，传说只要有人能解开神秘盒上的密码，就可以预知未来（比如知道这道题的标程是怎样的），你愿意来尝试一下么？", "description": "对于一个 $m$ 位的十进制整数 $N~=~(\\overline{n_1 n_2 n_3 \\dots n_m})_{10}$，定义 $g(N)~=~\\sum_{i = 1}^{m} n_i$。\n\n定义集合 $S_N~=~\\{x~|~x~>~0,~g(x)~\\leq~N,x~\\text{的十进制表示中任意位不为} 0\\}$。\n\n给定 $n$，求\n\n$$f(n)~=~\\sum_{x \\in S_n} \\sum_{y \\in S_n \\land x < y} x~\\times~y$$\n\n答案对 $10^6+3$ 取模。", "inputFormat": "一行一个正整数 $n$。", "outputFormat": "一行一个整数代表答案对 $10^6 + 3$ 取模的结果。", "hint": "#### 样例输入输出 1 解释\n\n$S_n={1, 2, 11}$，故 $f(N)~=~1 \\times 2+1 \\times 11+2 \\times 11~=~35$。\n\n---\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $3~\\leq~n~\\leq~10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5258", "type": "P", "difficulty": 5, "samples": [["4\n0 1\n1 2\n1 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2013", "各省省选", "江苏", "O2优化", "上下界网络流"], "title": "[JSOI2013] 旅行时的困惑", "background": "", "description": "Waldives 有 $N$ 个小岛。目前的交通系统中包含 $N-1$ 条快艇专线，每条快艇专线连接两个岛。这 $N-1$ 条快艇专线恰好形成了一棵树。\n\n由于特殊的原因，所有 $N-1$ 条快艇专线都是单向的。这导致了很多岛屿之间\n不能相互到达。因此，Waldives 政府希望新建一些公交线路，使得建设完毕后，任意两个小岛都可以互相到达。为了节约开支，政府希望建设最少的公交线路。 \n\n同时，出于规划考虑，每一条公交线路都有如下的要求：\n> 1、每一条交通线路包含若干条连续的快艇专线，你可以认为一条公交线路\n对应树上的一条路径，而其所包含的若干快艇专线则对应树上被这条路\n径所覆盖的树边（也就是之前已经存在的某个快艇专线）；\n>\n> 2、显然一条交通线路只能覆盖树上任意一条边至多一次；\n>\n> 3、公交线路中所包含的每一个快艇专线都是有方向的，并且与其所覆盖的\n树边的方向相反；\n>\n>4、不同的公交线路可以覆盖树上相同的点或者相同的边。\n\nWaldives 的 $N$ 个岛屿分别从 $0$ 到 $N-1$ 编号。现在给出 Waldives 已有的快艇专线信息，请计算最少所需要新建的交通线路的数量。", "inputFormat": "第一行包含一个整数 $N$。\n\n接下来 $N-1$行，每行包含两个整数 $x,~y$。表示存在一条从岛屿 $x$ 开往岛屿 $y$ 的快艇专线。", "outputFormat": "输出一行一个整数，表示需要建设的最少的交通线路数量。", "hint": "$1~\\leq~N~\\leq~10^5$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Confusion During Travel", "background": "", "description": "Waldives has $N$ small islands. The current transportation system contains $N-1$ express boat routes, and each express boat route connects two islands. These $N-1$ express boat routes form a tree.\n\nFor special reasons, all $N-1$ express boat routes are one-way. This makes many pairs of islands unable to reach each other. Therefore, the Waldives government wants to build some new bus routes so that after construction, any two islands can reach each other. To save money, the government wants to build as few bus routes as possible.\n\nAt the same time, for planning reasons, each bus route must satisfy the following requirements:\n> 1. Each transportation route contains several consecutive express boat routes. You may treat one bus route as a path on the tree, and the express boat routes it contains correspond to the tree edges covered by this path (that is, some express boat routes that already exist).\n>\n> 2. Obviously, a transportation route can cover any edge on the tree at most once.\n>\n> 3. Each express boat route included in a bus route has a direction, and this direction is opposite to the direction of the tree edge it covers.\n>\n> 4. Different bus routes may cover the same vertices or the same edges on the tree.\n\nThe $N$ islands of Waldives are numbered from $0$ to $N-1$. Now the existing express boat route information of Waldives is given. Please compute the minimum number of new transportation routes that need to be built.", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N-1$ lines each contain two integers $x,~y$, meaning that there is an express boat route from island $x$ to island $y$.", "outputFormat": "Output one line with one integer, representing the minimum number of transportation routes that need to be built.", "hint": "$1~\\leq~N~\\leq~10^5$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 旅行时的困惑", "background": "", "description": "Waldives 有 $N$ 个小岛。目前的交通系统中包含 $N-1$ 条快艇专线，每条快艇专线连接两个岛。这 $N-1$ 条快艇专线恰好形成了一棵树。\n\n由于特殊的原因，所有 $N-1$ 条快艇专线都是单向的。这导致了很多岛屿之间\n不能相互到达。因此，Waldives 政府希望新建一些公交线路，使得建设完毕后，任意两个小岛都可以互相到达。为了节约开支，政府希望建设最少的公交线路。 \n\n同时，出于规划考虑，每一条公交线路都有如下的要求：\n> 1、每一条交通线路包含若干条连续的快艇专线，你可以认为一条公交线路\n对应树上的一条路径，而其所包含的若干快艇专线则对应树上被这条路\n径所覆盖的树边（也就是之前已经存在的某个快艇专线）；\n>\n> 2、显然一条交通线路只能覆盖树上任意一条边至多一次；\n>\n> 3、公交线路中所包含的每一个快艇专线都是有方向的，并且与其所覆盖的\n树边的方向相反；\n>\n>4、不同的公交线路可以覆盖树上相同的点或者相同的边。\n\nWaldives 的 $N$ 个岛屿分别从 $0$ 到 $N-1$ 编号。现在给出 Waldives 已有的快艇专线信息，请计算最少所需要新建的交通线路的数量。", "inputFormat": "第一行包含一个整数 $N$。\n\n接下来 $N-1$行，每行包含两个整数 $x,~y$。表示存在一条从岛屿 $x$ 开往岛屿 $y$ 的快艇专线。", "outputFormat": "输出一行一个整数，表示需要建设的最少的交通线路数量。", "hint": "$1~\\leq~N~\\leq~10^5$", "locale": "zh-CN"}}}
{"pid": "P5259", "type": "P", "difficulty": 4, "samples": [["3 1 1000000009 ", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2013", "各省省选", "江苏", "O2优化"], "title": "[JSOI2013] 游戏中的学问", "background": "", "description": "大家应该都见过很多人手拉手围着篝火跳舞的场景吧？一般情况下，大家手拉手跳舞总是会围成一个大圈，每个人的左手拉着旁边朋友的右手，右手拉着另\n一侧朋友的左手。\n\n不过，如果每一个人都随机的拉住两个不同人的手，然后再慢慢散开，事情\n就变得有趣多了——此时大家依旧会形成圈，不过却可能会形成多个独立的圈。\n当然这里我们依然要求一个人的右手只能拉另一个人的左手，反之亦然。\n\n班里一共有 $N$ 个同学，由 $1$ 到 $N$ 编号。Will想知道，究竟有多少种本质不\n同的拉手方案，使得最终大家散开后恰好形成 $k$ 个圈呢？\n\n给定两种方案，若存在一个人和他的一只手，满足在这两种方案中，拉着这\n只手的人的编号不同，则这两种方案本质不同。", "inputFormat": "输入一行包含三个正整数$N,~k,~P$", "outputFormat": "输出文件的包含一行一个整数，表示本质不同的方案数对p的余数。保证p\n一定是一个质数。", "hint": "$3~\\leq~3k~\\leq~N~\\leq~3000$\n\n$10^4~\\leq~p~\\leq~2~\\times~10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Knowledge in Games", "background": "", "description": "You have probably seen the scene where many people hold hands and dance around a bonfire. In general, when everyone dances hand in hand, they form one big circle: each person's left hand holds the right hand of the friend next to them, and their right hand holds the left hand of the friend on the other side.\n\nHowever, if everyone randomly holds the hands of two different people and then slowly spreads out, things become much more interesting. At this time, everyone will still form circles, but they may form several independent circles. Of course, we still require that a person's right hand can only hold another person's left hand, and vice versa.\n\nThere are $N$ students in the class, numbered from $1$ to $N$. Will wants to know how many essentially different hand-holding arrangements will make them form exactly $k$ circles after they spread out.\n\nGiven two arrangements, if there exists a person and one of their hands such that, in these two arrangements, the number of the person holding that hand is different, then these two arrangements are essentially different.", "inputFormat": "One line containing three positive integers $N,~k,~P$.", "outputFormat": "Output one integer in one line, representing the remainder of the number of essentially different arrangements modulo $p$. It is guaranteed that $p$ is a prime number.", "hint": "Constraints:\n\n$3~\\leq~3k~\\leq~N~\\leq~3000$.\n\n$10^4~\\leq~p~\\leq~2~\\times~10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 游戏中的学问", "background": "", "description": "大家应该都见过很多人手拉手围着篝火跳舞的场景吧？一般情况下，大家手拉手跳舞总是会围成一个大圈，每个人的左手拉着旁边朋友的右手，右手拉着另\n一侧朋友的左手。\n\n不过，如果每一个人都随机的拉住两个不同人的手，然后再慢慢散开，事情\n就变得有趣多了——此时大家依旧会形成圈，不过却可能会形成多个独立的圈。\n当然这里我们依然要求一个人的右手只能拉另一个人的左手，反之亦然。\n\n班里一共有 $N$ 个同学，由 $1$ 到 $N$ 编号。Will想知道，究竟有多少种本质不\n同的拉手方案，使得最终大家散开后恰好形成 $k$ 个圈呢？\n\n给定两种方案，若存在一个人和他的一只手，满足在这两种方案中，拉着这\n只手的人的编号不同，则这两种方案本质不同。", "inputFormat": "输入一行包含三个正整数$N,~k,~P$", "outputFormat": "输出文件的包含一行一个整数，表示本质不同的方案数对p的余数。保证p\n一定是一个质数。", "hint": "$3~\\leq~3k~\\leq~N~\\leq~3000$\n\n$10^4~\\leq~p~\\leq~2~\\times~10^9$", "locale": "zh-CN"}}}
{"pid": "P5260", "type": "P", "difficulty": 5, "samples": [["3\n2 2\n0 1\n1 0\n4 4\n0 1\n1 2\n2 0\n0 3\n8 12\n2 3\n2 6\n7 6\n1 7\n4 1\n3 4\n0 2\n7 3\n5 6\n5 1\n5 0\n4 0", "-1\n-1\n0 6 1 5 4 2 3 7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2013", "各省省选", "江苏", "Special Judge", "广度优先搜索 BFS", "位运算", "状压 DP"], "title": "[JSOI2013] 超立方体", "background": "超立方体是立方体在高维空间内的拓展（其在 2 维情况下退化为正方形，1 维情况下退化成线段）。在理论计算机科学领域里，超立方体往往可以和 2 进制编码联系到一起。对理论计算机科学颇有研究的 Will 自然也会对超立方体有着\n自己的思考。\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54052.png)\n\n上图就是在 0～4 维空间内超立方体所对应的图形。显然我们可以把超立方体的每个顶点看成一个点，每一条棱看成一条边，这样就会得到一个无向图，我们称之为超立方图。", "description": "D 维空间内的超立方图有 $2^D$ 个点，我们把这些点从 $0$ 到 $2^D-1$ 依次编号。\n\n有一个有趣而重要的充要结论是：一定存在一种编号的方式，使得图中任意两个有边相连的顶点的编号的 2 进制码中，恰好有一位不同。\n\n在2维和3维空间内这个结论可以这样形象的理解：对于 2 维空间，我们只要把这个正方形放到第一象限内，使得 4 个顶点的坐标按逆时针顺序依次为 $(0,0),(1,0),(1,1),(0,1)$，然后再把坐标看成 2 位 2 进制数，依次将这 4 个点编号为  0,1,3,2即可。\n\n对于 3 维空间，同样我们可以将立方体的一个顶点与原点重合，并使得所有棱均平行于坐标轴，然后分别确定这 8 个点的坐标，最后把 3 维空间内的坐标看成一个 3 位 2 进制数即可。对于 D 维空间，以此类推。\n\n现在对于一个 $N$ 个点 $M$ 条边的无向图（每个点从 $0$ 到 $N-1$ 编号），Will 希望知道这个图是否同构于一个超立方图。", "inputFormat": "第一行包含一个整数 $Q$ 表示此数据中一共包含 $Q$ 个询问。\n\n接下来 $Q$ 组询问，每一组询问的输入格式如下：\n\n第一行包含两个整数 $N$ 和 $M$，接下来 $M$ 行，每行 2 个不同的整数 $x,y$，表示图中存在一条无向边连接编\n号为 $x$ 和 $y$ 的点（$0 \\le x,y < N$）\n\n\n", "outputFormat": "1、如果询问中给定的图不同构于任何一个超立方图，输出 $-1$；\n\n2、如果同构于某一个超立方图，那么请给图中这 $N$ 个点重新编号，并在这一行输出 $N$ 个用空格隔开的整数，表示原图中每个点新的编号，使得重新编号后，满足题目中所述的结论。\n\n注意：输出文件的每一行，要么仅包含一个整数 $-1$，要么则应包含一个由 $0$ 到 $N-1$ 这 $N$ 个数组成的排列。如果有多组解输出任意一个均可。", "hint": "$Q~\\leq~3,~N~\\leq~32768,~M~\\leq~1000000$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Hypercube.", "background": "A hypercube is an extension of a cube into higher-dimensional space (it becomes a square in 2D and a line segment in 1D). In theoretical computer science, a hypercube is often related to binary encoding. Will, who has done quite a bit of research in theoretical computer science, naturally has his own thoughts about hypercubes.\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54052.png)\n\nThe figure above shows the shapes corresponding to hypercubes in $0$ to $4$ dimensions. Clearly, we can view each vertex of a hypercube as a point, and each edge as a graph edge. In this way, we get an undirected graph, which we call a hypercube graph.", "description": "A $D$-dimensional hypercube graph has $2^D$ vertices. We label these vertices from $0$ to $2^D - 1$.\n\nThere is an interesting and important necessary and sufficient conclusion: there must exist a way of labeling such that, for any two adjacent vertices in the graph, their labels’ binary codes differ in exactly one bit.\n\nIn 2D and 3D, this can be understood intuitively as follows.\n\nFor 2D, we can place the square in the first quadrant so that its four vertices, in counterclockwise order, are $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$. Then treat each coordinate as a 2-bit binary number, and label these four points as $0, 1, 3, 2$.\n\nFor 3D, similarly, we can make one vertex of the cube coincide with the origin, and make all edges parallel to the coordinate axes. Then determine the coordinates of the 8 points, and finally treat each 3D coordinate as a 3-bit binary number. For $D$ dimensions, do the same, and so on.\n\nNow, given an undirected graph with $N$ vertices and $M$ edges (vertices are labeled from $0$ to $N - 1$), Will wants to know whether this graph is isomorphic to a hypercube graph.", "inputFormat": "The first line contains an integer $Q$, meaning there are $Q$ queries in this input.\n\nThen follow $Q$ queries. For each query, the input format is:\n\nThe first line contains two integers $N$ and $M$. The next $M$ lines each contain two different integers $x, y$, indicating that there is an undirected edge between vertex $x$ and vertex $y$ in the graph ($0 \\le x, y < N$).", "outputFormat": "1. If the graph given in a query is not isomorphic to any hypercube graph, output $-1$.\n\n2. If it is isomorphic to some hypercube graph, please relabel these $N$ vertices, and output on this line $N$ integers separated by spaces. The $i$-th integer denotes the new label of vertex $i$ in the original graph, such that after relabeling, the conclusion described in the statement is satisfied.\n\nNote: Each line of the output file must either contain only one integer $-1$, or contain a permutation of $N$ numbers from $0$ to $N - 1$. If there are multiple solutions, output any one.", "hint": "$Q \\leq 3, N \\leq 32768, M \\leq 1000000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 超立方体", "background": "超立方体是立方体在高维空间内的拓展（其在 2 维情况下退化为正方形，1 维情况下退化成线段）。在理论计算机科学领域里，超立方体往往可以和 2 进制编码联系到一起。对理论计算机科学颇有研究的 Will 自然也会对超立方体有着\n自己的思考。\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/54052.png)\n\n上图就是在 0～4 维空间内超立方体所对应的图形。显然我们可以把超立方体的每个顶点看成一个点，每一条棱看成一条边，这样就会得到一个无向图，我们称之为超立方图。", "description": "D 维空间内的超立方图有 $2^D$ 个点，我们把这些点从 $0$ 到 $2^D-1$ 依次编号。\n\n有一个有趣而重要的充要结论是：一定存在一种编号的方式，使得图中任意两个有边相连的顶点的编号的 2 进制码中，恰好有一位不同。\n\n在2维和3维空间内这个结论可以这样形象的理解：对于 2 维空间，我们只要把这个正方形放到第一象限内，使得 4 个顶点的坐标按逆时针顺序依次为 $(0,0),(1,0),(1,1),(0,1)$，然后再把坐标看成 2 位 2 进制数，依次将这 4 个点编号为  0,1,3,2即可。\n\n对于 3 维空间，同样我们可以将立方体的一个顶点与原点重合，并使得所有棱均平行于坐标轴，然后分别确定这 8 个点的坐标，最后把 3 维空间内的坐标看成一个 3 位 2 进制数即可。对于 D 维空间，以此类推。\n\n现在对于一个 $N$ 个点 $M$ 条边的无向图（每个点从 $0$ 到 $N-1$ 编号），Will 希望知道这个图是否同构于一个超立方图。", "inputFormat": "第一行包含一个整数 $Q$ 表示此数据中一共包含 $Q$ 个询问。\n\n接下来 $Q$ 组询问，每一组询问的输入格式如下：\n\n第一行包含两个整数 $N$ 和 $M$，接下来 $M$ 行，每行 2 个不同的整数 $x,y$，表示图中存在一条无向边连接编\n号为 $x$ 和 $y$ 的点（$0 \\le x,y < N$）\n\n\n", "outputFormat": "1、如果询问中给定的图不同构于任何一个超立方图，输出 $-1$；\n\n2、如果同构于某一个超立方图，那么请给图中这 $N$ 个点重新编号，并在这一行输出 $N$ 个用空格隔开的整数，表示原图中每个点新的编号，使得重新编号后，满足题目中所述的结论。\n\n注意：输出文件的每一行，要么仅包含一个整数 $-1$，要么则应包含一个由 $0$ 到 $N-1$ 这 $N$ 个数组成的排列。如果有多组解输出任意一个均可。", "hint": "$Q~\\leq~3,~N~\\leq~32768,~M~\\leq~1000000$", "locale": "zh-CN"}}}
{"pid": "P5261", "type": "P", "difficulty": 6, "samples": [["2 9 9 5", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2013", "各省省选", "江苏", "O2优化"], "title": "[JSOI2013] 数字理论", "background": "", "description": "给定 $4$ 个正整数 $K,~S,~P,~D$，要求在十进制数中，寻找一个最小的 $K$ 位自然数 $x$，满足 $x$ 的各个数位之和为 $S$，并且 $x$ 乘以 $D$ 之后各个数位之和为 $P$。", "inputFormat": "输入数据中包含一行四个整数，分别为 $K,~S,~P,~D$。\n", "outputFormat": "输出一行一个整数，表示满足条件的最小自然数 $x$。如果不存在则输出$-1$。", "hint": "$1~\\leq~K~\\leq~100,~1~\\leq~S,~P~\\leq~1000,~1~\\leq~D~\\leq~9$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Number Theory", "background": "", "description": "Given four positive integers $K,~S,~P,~D$, in decimal, find the smallest $K$-digit natural number $x$ such that the sum of digits of $x$ is $S$, and the sum of digits of $x \\times D$ is $P$.", "inputFormat": "The input contains one line with four integers: $K,~S,~P,~D$.", "outputFormat": "Output one integer in one line, representing the smallest natural number $x$ that satisfies the conditions. If it does not exist, output $-1$.", "hint": "Constraints: $1~\\leq~K~\\leq~100,~1~\\leq~S,~P~\\leq~1000,~1~\\leq~D~\\leq~9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 数字理论", "background": "", "description": "给定 $4$ 个正整数 $K,~S,~P,~D$，要求在十进制数中，寻找一个最小的 $K$ 位自然数 $x$，满足 $x$ 的各个数位之和为 $S$，并且 $x$ 乘以 $D$ 之后各个数位之和为 $P$。", "inputFormat": "输入数据中包含一行四个整数，分别为 $K,~S,~P,~D$。\n", "outputFormat": "输出一行一个整数，表示满足条件的最小自然数 $x$。如果不存在则输出$-1$。", "hint": "$1~\\leq~K~\\leq~100,~1~\\leq~S,~P~\\leq~1000,~1~\\leq~D~\\leq~9$", "locale": "zh-CN"}}}
{"pid": "P5262", "type": "P", "difficulty": 0, "samples": [["10 7 7\n8 3 5 4 5 7 4 2 1 3", "3\n----+++++"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2007", "2013", "各省省选", "江苏", "O2优化", "ROI（俄罗斯）"], "title": "[ROI2007 / JSOI2013] 体育课", "background": null, "description": "体育课里一共有 $N$ 个同学，学号从 $1$ 到 $N$。JYY 的体育老师 KFC 有一个特殊排队方法：\n- KFC 先让班里的 $N$ 个同学按照学号从小到大的顺序，从左到右站成一排，然后从到队列的最左边（也就是第一个学生面前）开始，一直向右走动到第 $N-1$ 个学生面前；\n- 接着 KFC 再回到第一个学生面前，继续开始向右走，就这样一共走动 $N-1$ 次。\n- 每次当 KFC 走到第 $i$ 个学生面前时，KFC 会比较一下队列里第 $i$ 个学生和第 $i+1$ 个学生的身高，如果左边（第 $i$ 个）的学生比右边（第 $i+1$ 个）的学生高，那么 KFC 就会交换这两个学生在队列里的位置。\n\n最终，在 $N-1$ 次走动全部结束之后，KFC 会选出队列最右边的一些学生去搬桌子。自然地，JYY 希望能够站在尽量靠左的位置来增加自己踢足球的机会。\n\n此外，JYY 还有一个绝招，那就是在 KFC 老师快走到自己面前的时候，开始蹲下来系鞋带！如果 JYY 蹲下来系鞋带了，那么在这一次走动中，好说话的 KFC 老师就不会让 JYY 和相邻的同学比较身高了，自然也就不会让 JYY 和相邻的同学交换位置（只有 JYY 最聪明会蹲下来系鞋带，其他同学都只会老老实实的让 KFC 老师比较身高）。\n\n蹲下来系鞋带是很耗费体力的。为了留着体力踢足球，JYY 最多只能蹲下 $K$ 次。\n\nJYY 想知道，按照怎样的下蹲策略可以使自己在队列里站的尽量靠左。用一个长度为 $N-1$ 的字符串来表示一个策略：如果字符串的第 $i$ 个字符是 `+`，则表示在第 $i$ 次走动时 JYY 蹲下来系鞋带；如果第 $i$ 个字符是 `-`，则表示 JYY 会老老实实地比较身高。", "inputFormat": "第一行包含三个整数 $N,P,K$，分别表示同学的数量、JYY 的学号、JYY 最多能蹲下的次数。\n\n第二行包含 $N$ 个整数，其中第 $i$ 个整数表示 $h_i$，表示学号为 $i$ 的同学的身高。", "outputFormat": "第一行包含一个正整数，表示按照最佳策略时 JYY 可以排在的最靠左的位置。\n\n第二行包含一个长度为 $N-1$ 的字符串，表示最佳策略。如果有多个最佳策略，JYY 希望知道字典序最大的策略。", "hint": "数据范围：$1\\le P\\le N\\le 10^5$，$0\\le K\\le N-1$，$1\\le h_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[ROI2007 / JSOI2013] PE Class", "background": "", "description": "There are $N$ students in the PE class, with student IDs from $1$ to $N$. JYY’s PE teacher KFC has a special way to arrange the line:\n- KFC first makes the $N$ students stand in a row from left to right in increasing order of student ID. Then, starting from the far left of the line (in front of the first student), KFC walks to the right until reaching the $(N-1)$-th student.\n- Next, KFC returns to the first student and starts walking to the right again. In total, KFC walks $N-1$ times.\n- Each time when KFC reaches the $i$-th student, KFC compares the heights of the $i$-th and $(i+1)$-th students. If the student on the left (the $i$-th) is taller than the student on the right (the $(i+1)$-th), KFC swaps their positions in the line.\n\nAfter all $N-1$ walks are finished, KFC will choose some students on the far right of the line to move desks. Naturally, JYY wants to stand as far to the left as possible to increase his chances to play soccer.\n\nIn addition, JYY has a special trick: when KFC is about to walk up to him, JYY can squat down to tie his shoelaces. If JYY squats down to tie his shoelaces, then during that walk, the easygoing teacher KFC will not make JYY compare heights with adjacent students, and of course will not make JYY swap positions with adjacent students (only JYY is smart enough to squat down; all other students will honestly let KFC compare heights).\n\nSquatting down to tie shoelaces costs a lot of energy. To save energy for playing soccer, JYY can squat at most $K$ times.\n\nJYY wants to know what squatting strategy can make him stand as far to the left as possible in the line. Use a string of length $N-1$ to represent a strategy: if the $i$-th character of the string is `+`, it means JYY squats down to tie his shoelaces during the $i$-th walk; if it is `-`, it means JYY will honestly compare heights.", "inputFormat": "The first line contains three integers $N, P, K$, representing the number of students, JYY’s student ID, and the maximum number of times JYY can squat.\n\nThe second line contains $N$ integers, where the $i$-th integer is $h_i$, the height of the student with ID $i$.", "outputFormat": "The first line contains one positive integer, the leftmost position JYY can reach under the best strategy.\n\nThe second line contains a string of length $N-1$, representing the best strategy. If there are multiple best strategies, JYY wants the lexicographically largest one.", "hint": "Constraints: $1\\le P\\le N\\le 10^5$, $0\\le K\\le N-1$, $1\\le h_i\\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ROI2007 / JSOI2013] 体育课", "background": null, "description": "体育课里一共有 $N$ 个同学，学号从 $1$ 到 $N$。JYY 的体育老师 KFC 有一个特殊排队方法：\n- KFC 先让班里的 $N$ 个同学按照学号从小到大的顺序，从左到右站成一排，然后从到队列的最左边（也就是第一个学生面前）开始，一直向右走动到第 $N-1$ 个学生面前；\n- 接着 KFC 再回到第一个学生面前，继续开始向右走，就这样一共走动 $N-1$ 次。\n- 每次当 KFC 走到第 $i$ 个学生面前时，KFC 会比较一下队列里第 $i$ 个学生和第 $i+1$ 个学生的身高，如果左边（第 $i$ 个）的学生比右边（第 $i+1$ 个）的学生高，那么 KFC 就会交换这两个学生在队列里的位置。\n\n最终，在 $N-1$ 次走动全部结束之后，KFC 会选出队列最右边的一些学生去搬桌子。自然地，JYY 希望能够站在尽量靠左的位置来增加自己踢足球的机会。\n\n此外，JYY 还有一个绝招，那就是在 KFC 老师快走到自己面前的时候，开始蹲下来系鞋带！如果 JYY 蹲下来系鞋带了，那么在这一次走动中，好说话的 KFC 老师就不会让 JYY 和相邻的同学比较身高了，自然也就不会让 JYY 和相邻的同学交换位置（只有 JYY 最聪明会蹲下来系鞋带，其他同学都只会老老实实的让 KFC 老师比较身高）。\n\n蹲下来系鞋带是很耗费体力的。为了留着体力踢足球，JYY 最多只能蹲下 $K$ 次。\n\nJYY 想知道，按照怎样的下蹲策略可以使自己在队列里站的尽量靠左。用一个长度为 $N-1$ 的字符串来表示一个策略：如果字符串的第 $i$ 个字符是 `+`，则表示在第 $i$ 次走动时 JYY 蹲下来系鞋带；如果第 $i$ 个字符是 `-`，则表示 JYY 会老老实实地比较身高。", "inputFormat": "第一行包含三个整数 $N,P,K$，分别表示同学的数量、JYY 的学号、JYY 最多能蹲下的次数。\n\n第二行包含 $N$ 个整数，其中第 $i$ 个整数表示 $h_i$，表示学号为 $i$ 的同学的身高。", "outputFormat": "第一行包含一个正整数，表示按照最佳策略时 JYY 可以排在的最靠左的位置。\n\n第二行包含一个长度为 $N-1$ 的字符串，表示最佳策略。如果有多个最佳策略，JYY 希望知道字典序最大的策略。", "hint": "数据范围：$1\\le P\\le N\\le 10^5$，$0\\le K\\le N-1$，$1\\le h_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5263", "type": "P", "difficulty": 6, "samples": [["3 10 150 250\n100 20 123\n201 10 67\n202 10 45", "190"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "各省省选", "网络流", "江苏", "O2优化"], "title": "[JSOI2013] 打地鼠", "background": "JYY 特别喜欢到游戏厅玩打地鼠游戏——拿起两个锤子用力敲打不断冒出\n来的地鼠。\n\n打到不同的地鼠有不同的得分，JYY想知道怎样才能得到最高的分\n数。", "description": "游戏里一共会冒出来 $N$ 个地鼠，这些地鼠冒出来的位置都分布在一条直线\n上。第 $i$ 个地鼠会在 $T_i$ 时刻在 $X_i$ 位置冒出来，打到第 $i$ 个地鼠的得分是 $P_i$。\n\n当游戏开始时（也就是 0 时刻），JYY 左手的位置为 XLEFT，右手的位置为\nXRIGHT。JYY的手的最大移动速度是 $V$（每单位时刻最多移动的距离为 V） 。\n\n地鼠会在瞬间冒出来然后消失。如果在对应的时刻 JYY 的一只手恰好也在地鼠冒出来的位置，那么 JYY 就可以在瞬间完成击打动作并得到对应的分数,否则，JYY就只能错过这只地鼠了。\n\nJYY两只手都拿着锤子，所以两只手是可以同时打地鼠的。\n\n然而， 如果在游戏过程中 JYY的两只手交叉的话， JYY会感到很不舒服 （这\n个动作确实很别扭，而且两只手可能会互相阻碍而影响移动速度） ，所以 JYY希\n望在整个游戏过程中左手的位置 XLEFT永远严格小于右手的位置XRIGHT。JYY想知道，他最多能得多少分呢？", "inputFormat": "第一行包含四个整数$N,~V,~XLEFT,~XRIGHT$；\n接下来 $N$ 行，分别描述 $N$ 个可能出现的地鼠；\n其中第 $i$ 行包含三个整数 $X_i$，$T_i$，$P_i$。\n数据保证在同一个时刻不会有两个地鼠出现在同样的位置。", "outputFormat": "输出一行一个整数，表示JYY最多能够得到的分数。", "hint": "$1~\\leq~N~\\leq~3000,~1~\\leq~XLEFT~<~XRIGHT~\\leq~10^5,~1~\\leq~T_i~\\leq~10^5$\n\n$1~\\leq~P_i~\\leq~10^5,~1~\\leq~X_i~\\leq~10^5,~1~\\leq~V~\\leq~10^4$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Whac-a-Mole.", "background": "JYY really likes going to the arcade to play Whac-a-Mole—picking up two hammers and hitting the moles that keep popping out.\n\nHitting different moles gives different scores, and JYY wants to know how to get the highest score.", "description": "In the game, a total of $N$ moles will appear, and their positions are all on a straight line. The $i$-th mole appears at position $X_i$ at time $T_i$, and the score for hitting the $i$-th mole is $P_i$.\n\nWhen the game starts (that is, at time $0$), JYY’s left hand is at position XLEFT, and the right hand is at position XRIGHT. The maximum moving speed of JYY’s hands is $V$ (the maximum distance moved per unit time is $V$).\n\nEach mole appears and disappears instantly. If at the corresponding time, one of JYY’s hands is exactly at the position where the mole appears, then JYY can complete the hit instantly and get the corresponding score. Otherwise, JYY can only miss this mole.\n\nSince JYY holds hammers in both hands, the two hands can hit moles at the same time.\n\nHowever, if JYY’s two hands cross during the game, JYY will feel very uncomfortable (the movement is indeed awkward, and the two hands may block each other and affect the moving speed). Therefore, JYY hopes that throughout the whole game, the left hand position XLEFT is always strictly less than the right hand position XRIGHT. JYY wants to know the maximum total score he can get.", "inputFormat": "The first line contains four integers $N,~V,~XLEFT,~XRIGHT$.\nThe next $N$ lines describe the $N$ possible moles.\nThe $i$-th line contains three integers $X_i$, $T_i$, $P_i$.\nThe testdata guarantees that at the same time, there will not be two moles appearing at the same position.", "outputFormat": "Output one line with one integer, meaning the maximum score JYY can get.", "hint": "Constraints.\n\n$1~\\leq~N~\\leq~3000,~1~\\leq~XLEFT~<~XRIGHT~\\leq~10^5,~1~\\leq~T_i~\\leq~10^5$\n\n$1~\\leq~P_i~\\leq~10^5,~1~\\leq~X_i~\\leq~10^5,~1~\\leq~V~\\leq~10^4$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 打地鼠", "background": "JYY 特别喜欢到游戏厅玩打地鼠游戏——拿起两个锤子用力敲打不断冒出\n来的地鼠。\n\n打到不同的地鼠有不同的得分，JYY想知道怎样才能得到最高的分\n数。", "description": "游戏里一共会冒出来 $N$ 个地鼠，这些地鼠冒出来的位置都分布在一条直线\n上。第 $i$ 个地鼠会在 $T_i$ 时刻在 $X_i$ 位置冒出来，打到第 $i$ 个地鼠的得分是 $P_i$。\n\n当游戏开始时（也就是 0 时刻），JYY 左手的位置为 XLEFT，右手的位置为\nXRIGHT。JYY的手的最大移动速度是 $V$（每单位时刻最多移动的距离为 V） 。\n\n地鼠会在瞬间冒出来然后消失。如果在对应的时刻 JYY 的一只手恰好也在地鼠冒出来的位置，那么 JYY 就可以在瞬间完成击打动作并得到对应的分数,否则，JYY就只能错过这只地鼠了。\n\nJYY两只手都拿着锤子，所以两只手是可以同时打地鼠的。\n\n然而， 如果在游戏过程中 JYY的两只手交叉的话， JYY会感到很不舒服 （这\n个动作确实很别扭，而且两只手可能会互相阻碍而影响移动速度） ，所以 JYY希\n望在整个游戏过程中左手的位置 XLEFT永远严格小于右手的位置XRIGHT。JYY想知道，他最多能得多少分呢？", "inputFormat": "第一行包含四个整数$N,~V,~XLEFT,~XRIGHT$；\n接下来 $N$ 行，分别描述 $N$ 个可能出现的地鼠；\n其中第 $i$ 行包含三个整数 $X_i$，$T_i$，$P_i$。\n数据保证在同一个时刻不会有两个地鼠出现在同样的位置。", "outputFormat": "输出一行一个整数，表示JYY最多能够得到的分数。", "hint": "$1~\\leq~N~\\leq~3000,~1~\\leq~XLEFT~<~XRIGHT~\\leq~10^5,~1~\\leq~T_i~\\leq~10^5$\n\n$1~\\leq~P_i~\\leq~10^5,~1~\\leq~X_i~\\leq~10^5,~1~\\leq~V~\\leq~10^4$", "locale": "zh-CN"}}}
{"pid": "P5264", "type": "P", "difficulty": 6, "samples": [["8 0\n0 4 2 6 1 5 3 7", "0 4 2 332748113 998244338 931694687 998244320 72887640"], ["8 1\n0 4 2 6 1 5 3 7", "1 0 998244345 998244345 665496220 332748123 44366450 133099314"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["倍增", "O2优化", "构造", "快速数论变换 NTT"], "title": "多项式三角函数", "background": "", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个 $\\bmod{\\:x^n}$ 下的多项式 $F(x)$，满足 $F(x)\\equiv\\sin{A(x)}$ 或 $F(x)\\equiv\\cos{A(x)}$。\n\n所有运算在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行 **两个** 整数 $n,type$，若 $type=0$ 代表求 $\\sin$，若 $type=1$ 代表求 $\\cos$；\n\n第二行 $n$ 个整数，依次表示多项式的系数 $a_0,a_1,\\cdots,a_{n-1}$。\n\n保证 $a_0=0$。", "outputFormat": "输出一行 $n$ 个整数，表示答案多项式中的系数 $f_0,f_1,\\cdots,f_{n-1}$。", "hint": "对于 $100\\%$ 的数据：$n\\leq10^5$，$a_i\\in[0,998244352]\\cap\\mathbb{Z}$。\n\n前 $5$ 个点 $type=0$，后 $5$ 个点 $type=1$。", "locale": "zh-CN", "translations": {"en": {"title": "Polynomial Trigonometric Functions", "background": "", "description": "Given a polynomial $A(x)$ of degree $n-1$, find a polynomial $F(x)$ modulo $x^n$ such that $F(x)\\equiv\\sin{A(x)}$ or $F(x)\\equiv\\cos{A(x)}$.\n\nAll operations are performed modulo $998244353$.", "inputFormat": "The first line contains **two** integers $n,type$. If $type=0$, compute $\\sin$; if $type=1$, compute $\\cos$.\n\nThe second line contains $n$ integers, which are the coefficients $a_0,a_1,\\cdots,a_{n-1}$ of the polynomial.\n\nIt is guaranteed that $a_0=0$.", "outputFormat": "Output one line with $n$ integers, representing the coefficients $f_0,f_1,\\cdots,f_{n-1}$ of the resulting polynomial.", "hint": "Constraints for $100\\%$ of the testdata: $n\\leq10^5$, $a_i\\in[0,998244352]\\cap\\mathbb{Z}$.\n\nFor the first $5$ test points, $type=0$; for the last $5$ test points, $type=1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "多项式三角函数", "background": "", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个 $\\bmod{\\:x^n}$ 下的多项式 $F(x)$，满足 $F(x)\\equiv\\sin{A(x)}$ 或 $F(x)\\equiv\\cos{A(x)}$。\n\n所有运算在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行 **两个** 整数 $n,type$，若 $type=0$ 代表求 $\\sin$，若 $type=1$ 代表求 $\\cos$；\n\n第二行 $n$ 个整数，依次表示多项式的系数 $a_0,a_1,\\cdots,a_{n-1}$。\n\n保证 $a_0=0$。", "outputFormat": "输出一行 $n$ 个整数，表示答案多项式中的系数 $f_0,f_1,\\cdots,f_{n-1}$。", "hint": "对于 $100\\%$ 的数据：$n\\leq10^5$，$a_i\\in[0,998244352]\\cap\\mathbb{Z}$。\n\n前 $5$ 个点 $type=0$，后 $5$ 个点 $type=1$。", "locale": "zh-CN"}}}
{"pid": "P5265", "type": "P", "difficulty": 7, "samples": [["8 0\n0 4 2 6 1 5 3 7", "0 4 2 665496252 17 399297879 332748370 570426983"], ["8 1\n0 4 2 6 1 5 3 7", "0 4 2 665496220 998244322 399297839 332748518 570424795"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["倍增", "O2优化", "构造", "快速数论变换 NTT"], "title": "多项式反三角函数", "background": "", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个 $\\bmod{\\:x^n}$ 下的多项式 $F(x)$，满足 $F(x)\\equiv\\text{asin}\\:A(x)$ 或 $F(x)\\equiv\\text{atan}\\:A(x)$。\n\n所有运算在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行 **两个** 整数 $n,type$，若 $type=0$ 代表求 $\\text{asin}$，若 $type=1$ 代表求 $\\text{atan}$；\n\n第二行 $n$ 个整数，依次表示多项式的系数 $a_0,a_1,\\cdots,a_{n-1}$。\n\n保证 $a_0=0$。", "outputFormat": "输出一行 $n$ 个整数，表示答案多项式中的系数 $f_0,f_1,\\cdots,f_{n-1}$。", "hint": "对于 $100\\%$ 的数据：$n\\leq10^5$，$a_i\\in[0,998244352]\\cap\\mathbb{Z}$。\n\n前 $5$ 个点 $type=0$，后 $5$ 个点 $type=1$。", "locale": "zh-CN", "translations": {"en": {"title": "Polynomial Inverse Trigonometric Functions", "background": "", "description": "Given an $(n - 1)$-degree polynomial $A(x)$, find a polynomial $F(x)$ modulo $x^n$ such that $F(x)\\equiv\\text{asin}\\:A(x)$ or $F(x)\\equiv\\text{atan}\\:A(x)$.\n\nAll operations are performed modulo $998244353$.", "inputFormat": "The first line contains **two** integers $n,type$. If $type=0$, compute $\\text{asin}$; if $type=1$, compute $\\text{atan}$.\n\nThe second line contains $n$ integers, representing the coefficients $a_0,a_1,\\cdots,a_{n-1}$ of the polynomial in order.\n\nIt is guaranteed that $a_0=0$.", "outputFormat": "Output one line with $n$ integers, representing the coefficients $f_0,f_1,\\cdots,f_{n-1}$ of the answer polynomial.", "hint": "For $100\\%$ of the testdata: $n\\leq10^5$, $a_i\\in[0,998244352]\\cap\\mathbb{Z}$.\n\nFor the first $5$ points, $type=0$; for the last $5$ points, $type=1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "多项式反三角函数", "background": "", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个 $\\bmod{\\:x^n}$ 下的多项式 $F(x)$，满足 $F(x)\\equiv\\text{asin}\\:A(x)$ 或 $F(x)\\equiv\\text{atan}\\:A(x)$。\n\n所有运算在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行 **两个** 整数 $n,type$，若 $type=0$ 代表求 $\\text{asin}$，若 $type=1$ 代表求 $\\text{atan}$；\n\n第二行 $n$ 个整数，依次表示多项式的系数 $a_0,a_1,\\cdots,a_{n-1}$。\n\n保证 $a_0=0$。", "outputFormat": "输出一行 $n$ 个整数，表示答案多项式中的系数 $f_0,f_1,\\cdots,f_{n-1}$。", "hint": "对于 $100\\%$ 的数据：$n\\leq10^5$，$a_i\\in[0,998244352]\\cap\\mathbb{Z}$。\n\n前 $5$ 个点 $type=0$，后 $5$ 个点 $type=1$。", "locale": "zh-CN"}}}
{"pid": "P5266", "type": "P", "difficulty": 3, "samples": [["5\n1 lxl 10\n2 lxl\n3 lxl\n2 lxl\n4", "OK\n10\nDeleted successfully\nNot found\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["字典树 Trie", "哈希表", "STL"], "title": "【深基17.例6】学籍管理", "background": null, "description": "您要设计一个学籍管理系统，最开始学籍数据是空的，然后该系统能够支持下面的操作（不超过 $10^5$ 条）：\n\n- 插入与修改，格式 `1 NAME SCORE`：在系统中插入姓名为 $\\texttt{NAME}$(由字母和数字组成不超过 $20$ 个字符的字符串，区分大小写)，分数为 $\\texttt{SCORE}$（$0<\\texttt{SCORE}<2^{31}$） 的学生。如果已经有同名的学生则更新这名学生的成绩为 $\\texttt{SCORE}$。如果成功插入或者修改则输出 `OK`。\n- 查询，格式 `2 NAME`：在系统中查询姓名为 $\\texttt{NAME}$ 的学生的成绩。如果没能找到这名学生则输出 `Not found`，否则输出该生成绩。\n- 删除，格式 `3 NAME`：在系统中删除姓名为 $\\texttt{NAME}$ 的学生信息。如果没能找到这名学生则输出 `Not found`，否则输出 `Deleted successfully`。\n- 汇总，格式 `4`：输出系统中学生数量。", "inputFormat": "第一行，输入一个正整数 $Q$（$1 \\le Q \\le 10^5$），表示操作数量。\n\n接下来 $Q$ 行，每行先输入一个正整数 $op$（$op \\in [1,4]$），表示操作种类。接着：\n- 如果 $op = 1$，则再输入一个字符串 $\\texttt{NAME}$ 以及一个正整数 $\\texttt{SCORE}$，含义见题目描述。\n- 如果 $op = 2$，则再输入一个字符串 $\\texttt{NAME}$，含义见题目描述。\n- 如果 $op = 3$，则再输入一个字符串 $\\texttt{NAME}$，含义见题目描述。\n- 如果 $op = 4$，则无需再输入其他内容。", "outputFormat": "共输出 $Q$ 行，每行输出一个字符串或正整数，为对应操作的处理结果，具体含义见题目描述。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics 17.Example 6] Student Record Management", "background": "", "description": "You need to design a student record management system. At the beginning, the student record data is empty. Then the system must support the following operations (no more than $10^5$ operations in total):\n\n- Insert and update, format `1 NAME SCORE`: Insert a student whose name is $\\texttt{NAME}$ (a case-sensitive string consisting of letters and digits, with at most $20$ characters) and whose score is $\\texttt{SCORE}$ ($0<\\texttt{SCORE}<2^{31}$). If a student with the same name already exists, update this student's score to $\\texttt{SCORE}$. If the insertion or update succeeds, output `OK`.\n- Query, format `2 NAME`: Query the score of the student whose name is $\\texttt{NAME}$. If the student cannot be found, output `Not found`; otherwise, output the student's score.\n- Delete, format `3 NAME`: Delete the information of the student whose name is $\\texttt{NAME}$. If the student cannot be found, output `Not found`; otherwise, output `Deleted successfully`.\n- Summary, format `4`: Output the number of students in the system.", "inputFormat": "The first line contains a positive integer $Q$ ($1 \\le Q \\le 10^5$), which indicates the number of operations.\n\nIn the next $Q$ lines, each line first contains a positive integer $op$ ($op \\in [1,4]$), which indicates the type of operation. Then:\n- If $op = 1$, input an additional string $\\texttt{NAME}$ and a positive integer $\\texttt{SCORE}$, with meanings as described above.\n- If $op = 2$, input an additional string $\\texttt{NAME}$, with meaning as described above.\n- If $op = 3$, input an additional string $\\texttt{NAME}$, with meaning as described above.\n- If $op = 4$, no additional input is needed.", "outputFormat": "Output a total of $Q$ lines. Each line outputs a string or a positive integer, which is the processing result of the corresponding operation. The exact meaning is as described above.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基17.例6】学籍管理", "background": null, "description": "您要设计一个学籍管理系统，最开始学籍数据是空的，然后该系统能够支持下面的操作（不超过 $10^5$ 条）：\n\n- 插入与修改，格式 `1 NAME SCORE`：在系统中插入姓名为 $\\texttt{NAME}$(由字母和数字组成不超过 $20$ 个字符的字符串，区分大小写)，分数为 $\\texttt{SCORE}$（$0<\\texttt{SCORE}<2^{31}$） 的学生。如果已经有同名的学生则更新这名学生的成绩为 $\\texttt{SCORE}$。如果成功插入或者修改则输出 `OK`。\n- 查询，格式 `2 NAME`：在系统中查询姓名为 $\\texttt{NAME}$ 的学生的成绩。如果没能找到这名学生则输出 `Not found`，否则输出该生成绩。\n- 删除，格式 `3 NAME`：在系统中删除姓名为 $\\texttt{NAME}$ 的学生信息。如果没能找到这名学生则输出 `Not found`，否则输出 `Deleted successfully`。\n- 汇总，格式 `4`：输出系统中学生数量。", "inputFormat": "第一行，输入一个正整数 $Q$（$1 \\le Q \\le 10^5$），表示操作数量。\n\n接下来 $Q$ 行，每行先输入一个正整数 $op$（$op \\in [1,4]$），表示操作种类。接着：\n- 如果 $op = 1$，则再输入一个字符串 $\\texttt{NAME}$ 以及一个正整数 $\\texttt{SCORE}$，含义见题目描述。\n- 如果 $op = 2$，则再输入一个字符串 $\\texttt{NAME}$，含义见题目描述。\n- 如果 $op = 3$，则再输入一个字符串 $\\texttt{NAME}$，含义见题目描述。\n- 如果 $op = 4$，则无需再输入其他内容。", "outputFormat": "共输出 $Q$ 行，每行输出一个字符串或正整数，为对应操作的处理结果，具体含义见题目描述。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5267", "type": "P", "difficulty": 7, "samples": [["3 3 100 2 3 1 1 0\n2 1 1\n2 3 3\n4 7 1", "4\n2 2 2 3 2\n2 3 1 3 2\n2 2 1 3 1\n3 1 3 2 3 3 3"], ["1 3 100 2 3 1 1 1\n2 1 1", "1\n2 1 2 1 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "NOI", "提交答案", "Special Judge"], "title": "[NOI2014] 消除游戏", "background": "", "description": "最近，小 Z 迷上了一款新型消除游戏。这款游戏在一个 $n\\times m$ 的方格中进行。初始时方格中均为 $0 \\sim 9$ 的整数。进行消除后方格中会出现空白，用 $-1$ 表示。为了方便，我们将第 $i$ 行，第 $j$ 列的数记为 $A_{i,j}$，并将其坐标记为 $(i,j)$。\n\n给定三个参数 $l_{\\min},l_{\\max}$ 以及 $K$，玩家可以进行不超过 $K$ 次操作。对于每次操作，玩家需要在方格中找到一条长度为 $l$ 的路径。形式化地，该路径用两个长度为 $l$ 的序列 $x_1,x_2,\\ldots,x_l$ 和 $y_1,y_2,\\ldots,y_l$ 表示，需要满足如下条件：\n1. $1\\le x_i\\le n,1\\le y_i\\le m$，其中 $1\\le i\\le l$，即 $(x_i,y_i)$ 对应于方格中的一个合法位置；\n2. $\\left|x_i-x_{i+1} \\right|+ \\left|y_i-y_{i+1} \\right|=1$，其中 $1 \\le i \\lt l$，即 $(x_i,y_i)$ 与 $(x_{i+1},y_{i+1})$ 是方格中相邻的两个位置；\n3. $x_i \\neq x_j$ 或 $y_i \\neq y_j$，其中 $1\\le i \\lt j\\le l$，即路径不能经过重复的格子；\n4. $A_{x_i,y_i} \\neq -1$，其中 $1\\le i\\le l$，即路径不能经过空白的格子；\n5. $A_{x_1,y_1} \\neq 0$，即路径不能以数字 $0$ 为起点；\n6. $l_{\\min}\\le l\\le l_{\\max}$，即路径的长度需要在给定的范围内。\n\n将路径上的数字串成一个整数 $N$，形式化地\n$$\nN=\\sum\\limits_{i=1}^l A_{x_i,y_i}\\times 10^{l-i}\n$$\n\n游戏会给出两个参数 $c_1,c_2$ 用于计算玩家本次操作的得分：\n1. 如果数 $N$ 是质数，那么将获得**质数得分** $l^{c_1}$，否则获得**质数得分** $1$；\n2. 如果数 $N$ 是回文数（即，将数 $N$ 的十进制表达看成一个字符串，这个字符串的逆序串和它本身完全相同），那么将获得**回文数得分** $l^{c_2}$，否则获得**回文数得分** $1$；\n3. 如果**质数得分**和**回文数得分**均为 $1$，那么**本次操作的得分**为 $0$；否则**本次操作的得分**为**质数得分与回文数得分**之和。\n\n每次操作过后，若**该次操作的得分**等于 $0$，那么你浪费了一次操作机会，而局面不会有任何改变。若**该次操作的得分**大于 $0$，则将路径上的数替换为空白，并使空白上方的数字垂直下落。形式化地，执行以下操作：\n1. 执行 $A_{x_i,y_i}\\leftarrow -1$，其中 $1\\le i\\le l$；\n2. 枚举所有格子。如果存在某个格子 $(i ,j)$，满足 $i \\neq n, A_{i,j} \\neq -1, A_{i+1,j} = -1$，执行 $A_{i+1,j} \\leftarrow A_{i,j}, A_{i,j}\\leftarrow -1$。反复执行这个操作直到方格中不再存在这样的格子。\n\n我们还会给你一个参数 $F$ ，在所有操作完成后，玩家的**最终得分** $S$ 的计算方式由 $F$ 决定：如果 $F$ 取值为 $0$，那么玩家的最终得分为所有操作的分数总和 $m$；如果 $F$ 取值为 $1$，那么玩家的最终得分为所有操作的分数总和 $m$ 除 $2^d$ 后向下取整，即\n\n$$\nS =\n\\begin{cases}\nm, & F=0\\\\\\\\\n\\left \\lfloor \\frac{m}{2^d} \\right \\rfloor, & F=1\n\\end{cases}\n$$\n\n其中 $d$ 为最终方格中非空白格子的数目。\n\n小 Z 沉迷于这个有趣的游戏中不能自拔。她想请你帮助, 针对给定的输入参数，给出游戏局面的操作方案。当然，最终得分越大越好。", "inputFormat": "**本题是一道提交答案题。**\n\n对于每个输入文件，输入的第 $1$ 行包含 $8$ 个用空格分隔的整数 $n, m, K, l_{\\min}, l_{\\max}, c_1, c_2, F$，含义同题面描述。 \n\n随后 $n$ 行，每行 $m$ 个整数，表示方格 A。数之间用一个空格分隔。\n\n输入文件中不会包含多余的空行，行末不会存在多余的空格。", "outputFormat": "针对给定的 $10$ 个输入文件 `game1.in ~ game10.in`，你需要分别提交你的输出文件 `game1.out ~ game10.out`。\n\n输出文件第 $1$ 行为一个整数 $M (0 \\leq M \\leq K)$，为你的操作次数。\n\n随后, 输出文件还应包含 $M$ 行，每行描述一次操作。对于每一行，最开始的整数$l$表示这次操作中选定路径的长度。接下来有 $2l$ 个数字，分别为 $x_1, y_1, x_2, y_2, \\dots, x_l, y_l$。\n\n输出文件中不应包含多余的空格和空行。一行的多个整数之间使用一个空格分隔。", "hint": "#### 样例解释 1\n\n$4$ 次消除得到的数与相应的分数分别是：$37$，得分为 $2+1=3$；$41$，得分为 $2+1=3$；$22$，得分为 $1+2=3$；$131$，得分为 $3+3=6$。总共得分为 $15$。可能存在更优的方案。\n\n#### 样例解释 2\n\n本方案仅一次消除操作。消除的数为 $11$，本次操作得分为 $2+2=4$。由于 $F=1$，最终得分为每次操作得分之和 $4$ 除以 $2^1 = 2$ 后下取整，为 $2$。若选择消除路径 $211$，则会得到本局面最佳分数 $4$。\n\n#### 评分标准\n\n对于每组数据，我们设置了 $9$ 个评分参数 $a_{10},a_9, \\dots ,a_2$。如果选手的输出不合法，则得零分。否则，在你的方案中，若游戏得分为 $w_{user}$，你的分数将会由下表给出：\n\n::cute-table{tuack=2}\n\n| 得分 |            条件             | 得分 |           条件           |\n| :--: | :-------------------------: | :--: | :----------------------: |\n| $10$ |    $w_{user}\\ge a_{10}$     | $5$  | $a_5\\le w_{user}\\lt a_6$ |\n| $9$  | $a_9\\le w_{user}\\lt a_{10}$ | $4$  | $a_4\\le w_{user}\\lt a_5$ |\n| $8$  |  $a_8\\le w_{user}\\lt a_9$   | $3$  | $a_3\\le w_{user}\\lt a_4$ |\n| $7$  |  $a_7\\le w_{user}\\lt a_8$   | $2$  | $a_2\\le w_{user}\\lt a_3$ |\n| $6$  |  $a_6\\le w_{user}\\lt a_7$   | $1$  |  $0\\lt w_{user}\\lt a_2$  |\n\n#### 附加文件\n\nchecker 需要自行编译后使用。\n\n请前往 [Github](https://github.com/MikeMirzayanov/testlib) 下载 testlib.h 的最新源代码。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2014] Elimination Game", "background": "", "description": "Recently, Little Z became addicted to a new elimination game. The game is played on an $n \\times m$ grid. Initially, each cell contains an integer from $0 \\sim 9$. After eliminations, blank cells may appear in the grid, denoted by $-1$. For convenience, denote the number in row $i$, column $j$ as $A_{i,j}$, and its coordinate as $(i,j)$.\n\nGiven three parameters $l_{\\min}, l_{\\max}$, and $K$, the player can perform at most $K$ operations. In each operation, the player needs to find a path of length $l$ in the grid. Formally, the path is represented by two sequences of length $l$, $x_1, x_2, \\ldots, x_l$ and $y_1, y_2, \\ldots, y_l$, satisfying:\n\n1. $1 \\le x_i \\le n, 1 \\le y_i \\le m$ for $1 \\le i \\le l$, i.e., $(x_i,y_i)$ is a valid position in the grid.\n2. $\\left|x_i-x_{i+1} \\right|+ \\left|y_i-y_{i+1} \\right|=1$ for $1 \\le i \\lt l$, i.e., $(x_i,y_i)$ and $(x_{i+1},y_{i+1})$ are adjacent cells in the grid.\n3. $x_i \\neq x_j$ or $y_i \\neq y_j$ for $1 \\le i \\lt j \\le l$, i.e., the path cannot pass through any cell more than once.\n4. $A_{x_i,y_i} \\neq -1$ for $1 \\le i \\le l$, i.e., the path cannot pass through blank cells.\n5. $A_{x_1,y_1} \\neq 0$, i.e., the path cannot start with the digit $0$.\n6. $l_{\\min} \\le l \\le l_{\\max}$, i.e., the path length must be within the given range.\n\nConcatenate the digits along the path into an integer $N$, formally:\n$$\nN=\\sum\\limits_{i=1}^l A_{x_i,y_i}\\times 10^{l-i}\n$$\n\nThe game provides two parameters $c_1, c_2$ to compute the score for this operation:\n\n1. If $N$ is a prime number, you get the **prime score** $l^{c_1}$; otherwise, the **prime score** is $1$.\n2. If $N$ is a palindrome (i.e., viewing the decimal representation of $N$ as a string, its reverse is exactly the same as itself), you get the **palindrome score** $l^{c_2}$; otherwise, the **palindrome score** is $1$.\n3. If both the **prime score** and the **palindrome score** are $1$, then the **score of this operation** is $0$. Otherwise, the **score of this operation** is the sum of the **prime score** and the **palindrome score**.\n\nAfter each operation, if the **score of this operation** equals $0$, then you waste one operation and the grid does not change. If the **score of this operation** is greater than $0$, then the numbers on the path are replaced with blanks, and the numbers above blanks fall vertically. Formally, perform the following steps:\n\n1. Set $A_{x_i,y_i}\\leftarrow -1$ for $1\\le i\\le l$.\n2. Enumerate all cells. If there exists a cell $(i, j)$ such that $i \\neq n$, $A_{i,j} \\neq -1$, and $A_{i+1,j} = -1$, then perform $A_{i+1,j} \\leftarrow A_{i,j}, A_{i,j}\\leftarrow -1$. Repeat this operation until no such cell exists in the grid.\n\nWe also provide a parameter $F$. After all operations are completed, the player’s **final score** $S$ is determined by $F$: if $F=0$, then the final score is the sum of the scores of all operations $m$; if $F=1$, then the final score is the sum of the scores of all operations $m$ divided by $2^d$ and floored, i.e.,\n$$\nS =\n\\begin{cases}\nm, & F=0\\\\\\\\\n\\left \\lfloor \\frac{m}{2^d} \\right \\rfloor, & F=1\n\\end{cases}\n$$\nwhere $d$ is the number of non-blank cells in the final grid.\n\nLittle Z is so obsessed with this interesting game that she cannot stop. She wants to ask you for help: for the given input parameters, provide an operation plan for the game state. Of course, the higher the final score, the better.", "inputFormat": "**This is an output-only problem.**\n\nFor each input file, line $1$ contains $8$ space-separated integers $n, m, K, l_{\\min}, l_{\\max}, c_1, c_2, F$, with the same meanings as in the statement.\n\nThen follow $n$ lines, each containing $m$ integers, describing the grid $A$. Numbers are separated by one space.\n\nThe input file will not contain extra blank lines, and there will be no extra spaces at the end of lines.", "outputFormat": "For the given $10$ input files `game1.in ~ game10.in`, you need to submit your output files `game1.out ~ game10.out` respectively.\n\nThe first line of the output file is an integer $M \\ (0 \\leq M \\leq K)$, the number of operations you perform.\n\nThen the output file should contain $M$ lines, each describing one operation. For each line, the first integer $l$ indicates the length of the chosen path for this operation. Then follow $2l$ numbers: $x_1, y_1, x_2, y_2, \\dots, x_l, y_l$.\n\nThe output file should not contain extra spaces or blank lines. Multiple integers on the same line should be separated by one space.", "hint": "#### Sample Explanation 1\n\nThe numbers eliminated in the $4$ eliminations and their corresponding scores are: $37$, score $2+1=3$; $41$, score $2+1=3$; $22$, score $1+2=3$; $131$, score $3+3=6$. The total score is $15$. There may be a better plan.\n\n#### Sample Explanation 2\n\nThis plan contains only one elimination operation. The eliminated number is $11$, and the score for this operation is $2+2=4$. Since $F=1$, the final score is the sum of operation scores $4$ divided by $2^1 = 2$ and floored, which is $2$. If you choose the elimination path $211$, you will get the best possible score for this game state, which is $4$.\n\n#### Scoring\n\nFor each test, we set $9$ scoring parameters $a_{10},a_9, \\dots ,a_2$. If your output is invalid, you get $0$ points. Otherwise, if the game score in your solution is $w_{user}$, your score will be given by the table below:\n\n::cute-table{tuack=2}\n\n| Score |            Condition             | Score |           Condition           |\n| :--: | :------------------------------: | :--: | :--------------------------: |\n| $10$ |    $w_{user}\\ge a_{10}$     | $5$  | $a_5\\le w_{user}\\lt a_6$ |\n| $9$  | $a_9\\le w_{user}\\lt a_{10}$ | $4$  | $a_4\\le w_{user}\\lt a_5$ |\n| $8$  |  $a_8\\le w_{user}\\lt a_9$   | $3$  | $a_3\\le w_{user}\\lt a_4$ |\n| $7$  |  $a_7\\le w_{user}\\lt a_8$   | $2$  | $a_2\\le w_{user}\\lt a_3$ |\n| $6$  |  $a_6\\le w_{user}\\lt a_7$   | $1$  |  $0\\lt w_{user}\\lt a_2$  |\n\n#### Additional Files\n\nThe checker must be compiled and used by yourself.\n\nPlease go to [Github](https://github.com/MikeMirzayanov/testlib) to download the latest source code of testlib.h.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2014] 消除游戏", "background": "", "description": "最近，小 Z 迷上了一款新型消除游戏。这款游戏在一个 $n\\times m$ 的方格中进行。初始时方格中均为 $0 \\sim 9$ 的整数。进行消除后方格中会出现空白，用 $-1$ 表示。为了方便，我们将第 $i$ 行，第 $j$ 列的数记为 $A_{i,j}$，并将其坐标记为 $(i,j)$。\n\n给定三个参数 $l_{\\min},l_{\\max}$ 以及 $K$，玩家可以进行不超过 $K$ 次操作。对于每次操作，玩家需要在方格中找到一条长度为 $l$ 的路径。形式化地，该路径用两个长度为 $l$ 的序列 $x_1,x_2,\\ldots,x_l$ 和 $y_1,y_2,\\ldots,y_l$ 表示，需要满足如下条件：\n1. $1\\le x_i\\le n,1\\le y_i\\le m$，其中 $1\\le i\\le l$，即 $(x_i,y_i)$ 对应于方格中的一个合法位置；\n2. $\\left|x_i-x_{i+1} \\right|+ \\left|y_i-y_{i+1} \\right|=1$，其中 $1 \\le i \\lt l$，即 $(x_i,y_i)$ 与 $(x_{i+1},y_{i+1})$ 是方格中相邻的两个位置；\n3. $x_i \\neq x_j$ 或 $y_i \\neq y_j$，其中 $1\\le i \\lt j\\le l$，即路径不能经过重复的格子；\n4. $A_{x_i,y_i} \\neq -1$，其中 $1\\le i\\le l$，即路径不能经过空白的格子；\n5. $A_{x_1,y_1} \\neq 0$，即路径不能以数字 $0$ 为起点；\n6. $l_{\\min}\\le l\\le l_{\\max}$，即路径的长度需要在给定的范围内。\n\n将路径上的数字串成一个整数 $N$，形式化地\n$$\nN=\\sum\\limits_{i=1}^l A_{x_i,y_i}\\times 10^{l-i}\n$$\n\n游戏会给出两个参数 $c_1,c_2$ 用于计算玩家本次操作的得分：\n1. 如果数 $N$ 是质数，那么将获得**质数得分** $l^{c_1}$，否则获得**质数得分** $1$；\n2. 如果数 $N$ 是回文数（即，将数 $N$ 的十进制表达看成一个字符串，这个字符串的逆序串和它本身完全相同），那么将获得**回文数得分** $l^{c_2}$，否则获得**回文数得分** $1$；\n3. 如果**质数得分**和**回文数得分**均为 $1$，那么**本次操作的得分**为 $0$；否则**本次操作的得分**为**质数得分与回文数得分**之和。\n\n每次操作过后，若**该次操作的得分**等于 $0$，那么你浪费了一次操作机会，而局面不会有任何改变。若**该次操作的得分**大于 $0$，则将路径上的数替换为空白，并使空白上方的数字垂直下落。形式化地，执行以下操作：\n1. 执行 $A_{x_i,y_i}\\leftarrow -1$，其中 $1\\le i\\le l$；\n2. 枚举所有格子。如果存在某个格子 $(i ,j)$，满足 $i \\neq n, A_{i,j} \\neq -1, A_{i+1,j} = -1$，执行 $A_{i+1,j} \\leftarrow A_{i,j}, A_{i,j}\\leftarrow -1$。反复执行这个操作直到方格中不再存在这样的格子。\n\n我们还会给你一个参数 $F$ ，在所有操作完成后，玩家的**最终得分** $S$ 的计算方式由 $F$ 决定：如果 $F$ 取值为 $0$，那么玩家的最终得分为所有操作的分数总和 $m$；如果 $F$ 取值为 $1$，那么玩家的最终得分为所有操作的分数总和 $m$ 除 $2^d$ 后向下取整，即\n\n$$\nS =\n\\begin{cases}\nm, & F=0\\\\\\\\\n\\left \\lfloor \\frac{m}{2^d} \\right \\rfloor, & F=1\n\\end{cases}\n$$\n\n其中 $d$ 为最终方格中非空白格子的数目。\n\n小 Z 沉迷于这个有趣的游戏中不能自拔。她想请你帮助, 针对给定的输入参数，给出游戏局面的操作方案。当然，最终得分越大越好。", "inputFormat": "**本题是一道提交答案题。**\n\n对于每个输入文件，输入的第 $1$ 行包含 $8$ 个用空格分隔的整数 $n, m, K, l_{\\min}, l_{\\max}, c_1, c_2, F$，含义同题面描述。 \n\n随后 $n$ 行，每行 $m$ 个整数，表示方格 A。数之间用一个空格分隔。\n\n输入文件中不会包含多余的空行，行末不会存在多余的空格。", "outputFormat": "针对给定的 $10$ 个输入文件 `game1.in ~ game10.in`，你需要分别提交你的输出文件 `game1.out ~ game10.out`。\n\n输出文件第 $1$ 行为一个整数 $M (0 \\leq M \\leq K)$，为你的操作次数。\n\n随后, 输出文件还应包含 $M$ 行，每行描述一次操作。对于每一行，最开始的整数$l$表示这次操作中选定路径的长度。接下来有 $2l$ 个数字，分别为 $x_1, y_1, x_2, y_2, \\dots, x_l, y_l$。\n\n输出文件中不应包含多余的空格和空行。一行的多个整数之间使用一个空格分隔。", "hint": "#### 样例解释 1\n\n$4$ 次消除得到的数与相应的分数分别是：$37$，得分为 $2+1=3$；$41$，得分为 $2+1=3$；$22$，得分为 $1+2=3$；$131$，得分为 $3+3=6$。总共得分为 $15$。可能存在更优的方案。\n\n#### 样例解释 2\n\n本方案仅一次消除操作。消除的数为 $11$，本次操作得分为 $2+2=4$。由于 $F=1$，最终得分为每次操作得分之和 $4$ 除以 $2^1 = 2$ 后下取整，为 $2$。若选择消除路径 $211$，则会得到本局面最佳分数 $4$。\n\n#### 评分标准\n\n对于每组数据，我们设置了 $9$ 个评分参数 $a_{10},a_9, \\dots ,a_2$。如果选手的输出不合法，则得零分。否则，在你的方案中，若游戏得分为 $w_{user}$，你的分数将会由下表给出：\n\n::cute-table{tuack=2}\n\n| 得分 |            条件             | 得分 |           条件           |\n| :--: | :-------------------------: | :--: | :----------------------: |\n| $10$ |    $w_{user}\\ge a_{10}$     | $5$  | $a_5\\le w_{user}\\lt a_6$ |\n| $9$  | $a_9\\le w_{user}\\lt a_{10}$ | $4$  | $a_4\\le w_{user}\\lt a_5$ |\n| $8$  |  $a_8\\le w_{user}\\lt a_9$   | $3$  | $a_3\\le w_{user}\\lt a_4$ |\n| $7$  |  $a_7\\le w_{user}\\lt a_8$   | $2$  | $a_2\\le w_{user}\\lt a_3$ |\n| $6$  |  $a_6\\le w_{user}\\lt a_7$   | $1$  |  $0\\lt w_{user}\\lt a_2$  |\n\n#### 附加文件\n\nchecker 需要自行编译后使用。\n\n请前往 [Github](https://github.com/MikeMirzayanov/testlib) 下载 testlib.h 的最新源代码。", "locale": "zh-CN"}}}
{"pid": "P5268", "type": "P", "difficulty": 5, "samples": [["5\n1 1 1 1 1\n2\n1 2 3 4\n1 1 4 4", "4\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "莫队", "各省省选", "陕西", "容斥原理", "差分"], "title": "[SNOI2017] 一个简单的询问", "background": "", "description": "给你一个长度为 $N$ 的序列 $a_i$，$1\\leq i\\leq N$，和 $q$ 组询问，每组询问读入 $l_1,r_1,l_2,r_2$，需输出\n\n$$\n\\sum\\limits_{x=0}^\\infty \\text{get}(l_1,r_1,x)\\times \\text{get}(l_2,r_2,x)\n$$\n\n$ \\text{get}(l,r,x)$ 表示计算区间 $[l,r]$ 中，数字 $x$ 出现了多少次。", "inputFormat": "第一行，一个数字 $N$，表示序列长度。  \n第二行，$N$ 个数字，表示 $a_1\\sim a_N$。  \n第三行，一个数字 $Q$，表示询问个数。  \n第 $4\\sim Q+3$ 行，每行四个数字 $l_1,r_1,l_2,r_2$，表示询问。", "outputFormat": "对于每组询问，输出一行一个数字，表示答案。", "hint": "对于 $20\\%$ 的数据，$1\\leq N,Q\\leq 1000$；  \n对于另外 $30\\%$ 的数据，$1\\leq a_i\\leq 50$；  \n对于 $100\\%$ 的数据，$N,Q\\leq 50000$，$1\\leq a_i\\leq N$，$1\\leq l_1\\leq r_1\\leq N$，$1\\leq l_2\\leq r_2\\leq N$。\n\n数据范围与原题相同，但测试数据由 LibreOJ 自制，并非原数据。  \n\n**注意：** 答案有可能超过 `int` 的最大值。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] A Simple Query", "background": "", "description": "You are given a sequence $a_i$ of length $N$, where $1\\leq i\\leq N$, and $q$ queries. For each query, you are given $l_1,r_1,l_2,r_2$, and you need to output\n\n$$\n\\sum\\limits_{x=0}^\\infty \\text{get}(l_1,r_1,x)\\times \\text{get}(l_2,r_2,x)\n$$\n\nHere, $\\text{get}(l,r,x)$ means the number of times the value $x$ appears in the interval $[l,r]$.", "inputFormat": "The first line contains an integer $N$, the length of the sequence.  \nThe second line contains $N$ integers, representing $a_1\\sim a_N$.  \nThe third line contains an integer $Q$, the number of queries.  \nLines $4$ to $Q+3$ each contain four integers $l_1,r_1,l_2,r_2$, representing a query.", "outputFormat": "For each query, output one integer per line, representing the answer.", "hint": "For $20\\%$ of the testdata, $1\\leq N,Q\\leq 1000$.  \nFor another $30\\%$ of the testdata, $1\\leq a_i\\leq 50$.  \nFor $100\\%$ of the testdata, $N,Q\\leq 50000$, $1\\leq a_i\\leq N$, $1\\leq l_1\\leq r_1\\leq N$, $1\\leq l_2\\leq r_2\\leq N$.\n\nThe Constraints are the same as the original problem, but the testdata is made by LibreOJ and is not the original testdata.\n\n**Note:** The answer may exceed the maximum value of `int`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 一个简单的询问", "background": "", "description": "给你一个长度为 $N$ 的序列 $a_i$，$1\\leq i\\leq N$，和 $q$ 组询问，每组询问读入 $l_1,r_1,l_2,r_2$，需输出\n\n$$\n\\sum\\limits_{x=0}^\\infty \\text{get}(l_1,r_1,x)\\times \\text{get}(l_2,r_2,x)\n$$\n\n$ \\text{get}(l,r,x)$ 表示计算区间 $[l,r]$ 中，数字 $x$ 出现了多少次。", "inputFormat": "第一行，一个数字 $N$，表示序列长度。  \n第二行，$N$ 个数字，表示 $a_1\\sim a_N$。  \n第三行，一个数字 $Q$，表示询问个数。  \n第 $4\\sim Q+3$ 行，每行四个数字 $l_1,r_1,l_2,r_2$，表示询问。", "outputFormat": "对于每组询问，输出一行一个数字，表示答案。", "hint": "对于 $20\\%$ 的数据，$1\\leq N,Q\\leq 1000$；  \n对于另外 $30\\%$ 的数据，$1\\leq a_i\\leq 50$；  \n对于 $100\\%$ 的数据，$N,Q\\leq 50000$，$1\\leq a_i\\leq N$，$1\\leq l_1\\leq r_1\\leq N$，$1\\leq l_2\\leq r_2\\leq N$。\n\n数据范围与原题相同，但测试数据由 LibreOJ 自制，并非原数据。  \n\n**注意：** 答案有可能超过 `int` 的最大值。", "locale": "zh-CN"}}}
{"pid": "P5269", "type": "P", "difficulty": 2, "samples": [["5 3 1 10 5 100\n0 1\n0 0\n2 1\n2 1\n1 1", "83"], ["3 1 1 1 1 2\n2 0\n2 1\n2 0", "2"], ["1 2 3 4 5 6\n1 0", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "洛谷月赛"], "title": "欧稳欧再次学车", "background": "请自行脑补一张欧稳欧学车的图", "description": "欧稳欧学车时经常用一辆橡树车练习。这辆橡树车共有 $N$ 个挡位，欧稳欧每秒可以把挡位增加或减少 $1$，初始时（$0$ 时刻）挡位为 $1$。\n\n这辆车的转速范围是 $[L,R]$，初始时转速为 $L$。每次升挡时，转速会变成 $L$；降挡时，会变成 $R$。欧稳欧在每秒也可以踩油门，让转速增加 $X$，再对 $R$ 取 $\\text{min}$。如果转速连续 $K$ 秒都 $=R$，那么这辆车的发动机会停止工作，在这 $K$ 秒结束的一瞬间停下（即使 $K$ 秒中经历了降档操作，仍然算这种情况）。\n\n这些操作我们认为都是在每秒开头的一瞬间进行的，其中换挡操作比踩油门操作先进行。而这一秒内这辆车前进的距离是 转速$\\times$挡位。\n\n现在给出欧稳欧练习时的操作序列，你需要求出他一共前进的距离是多少。", "inputFormat": "第一行六个整数 $T,N,L,R,X,K$，$T$ 表示总时间。\n\n接下来 $T$ 行，每行两个整数 $x,y$，表示这一秒的操作。\n\n其中 $x=0$ 表示升挡，$x=1$ 表示降挡，$x=2$ 表示挡位不变；$y=0$ 表示不踩油门，$y=1$ 表示踩油门。（不要问为什么没有刹车）", "outputFormat": "一行一个整数，表示给定操作序列的前进距离。\n\n如果欧稳欧在挡位为 $N$ 时升挡，或在挡位为 $1$ 时降挡，那么给定序列不合法，输出 $-1$。", "hint": "对于样例一：\n\n第一秒挡位为 $2$，转速为 $6$；  \n第二秒挡位为 $3$，转速为 $1$；  \n第三秒挡位为 $3$，转速为 $6$；  \n第四秒挡位为 $3$，转速为 $10$；  \n第五秒挡位为 $2$，转速为 $10$。\n\n对于样例二，前进两秒之后发动机就停止了工作。\n\n对于 $30\\%$ 的数据，没有挡位操作（即保证 $x=2$）；\n\n对于另外 $30\\%$ 的数据，没有踩油门操作（即保证 $y=0$）；\n\n对于全部数据，保证 $1\\le T,N,L,R,X,K\\le 10^6,L\\le R$。", "locale": "zh-CN", "translations": {"en": {"title": "Owen-O Learns to Drive Again", "background": "Please imagine a picture of Owen-O learning to drive.", "description": "When Owen-O practices driving, he often uses an “oak car” for training. This oak car has a total of $N$ gears. Each second, Owen-O can increase or decrease the gear by $1$. Initially (at time $0$), the gear is $1$.\n\nThe car’s RPM range is $[L,R]$, and initially the RPM is $L$. Each time he upshifts, the RPM becomes $L$; each time he downshifts, the RPM becomes $R$. Each second, Owen-O can also step on the accelerator to increase the RPM by $X$, then take $\\text{min}$ with $R$. If the RPM stays continuously at $=R$ for $K$ seconds, then the engine will stop working and the car will stop at the instant those $K$ seconds end (even if downshifts happen during those $K$ seconds, it is still counted as this situation).\n\nWe consider all operations to happen instantly at the beginning of each second, and the gear-change operation happens before the acceleration operation. The distance the car travels during that second is RPM $\\times$ gear.\n\nNow you are given Owen-O’s sequence of operations during practice. You need to compute the total distance traveled.", "inputFormat": "The first line contains six integers $T,N,L,R,X,K$, where $T$ is the total time.\n\nThe next $T$ lines each contain two integers $x,y$, describing the operation in this second.\n\nHere, $x=0$ means upshift, $x=1$ means downshift, $x=2$ means the gear stays the same; $y=0$ means do not step on the accelerator, $y=1$ means step on the accelerator. (Do not ask why there is no brake.)", "outputFormat": "Output one integer in one line, the total distance traveled under the given operation sequence.\n\nIf Owen-O upshifts while the gear is $N$, or downshifts while the gear is $1$, then the given sequence is invalid; output $-1$.", "hint": "For Sample 1:\n\nIn the first second, the gear is $2$ and the RPM is $6$;  \nin the second second, the gear is $3$ and the RPM is $1$;  \nin the third second, the gear is $3$ and the RPM is $6$;  \nin the fourth second, the gear is $3$ and the RPM is $10$;  \nin the fifth second, the gear is $2$ and the RPM is $10$.\n\nFor Sample 2, the engine stops working after moving for two seconds.\n\nFor $30\\%$ of the testdata, there are no gear operations (i.e. guaranteed $x=2$);\n\nfor another $30\\%$ of the testdata, there are no acceleration operations (i.e. guaranteed $y=0$);\n\nfor all testdata, it is guaranteed that $1\\le T,N,L,R,X,K\\le 10^6$ and $L\\le R$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "欧稳欧再次学车", "background": "请自行脑补一张欧稳欧学车的图", "description": "欧稳欧学车时经常用一辆橡树车练习。这辆橡树车共有 $N$ 个挡位，欧稳欧每秒可以把挡位增加或减少 $1$，初始时（$0$ 时刻）挡位为 $1$。\n\n这辆车的转速范围是 $[L,R]$，初始时转速为 $L$。每次升挡时，转速会变成 $L$；降挡时，会变成 $R$。欧稳欧在每秒也可以踩油门，让转速增加 $X$，再对 $R$ 取 $\\text{min}$。如果转速连续 $K$ 秒都 $=R$，那么这辆车的发动机会停止工作，在这 $K$ 秒结束的一瞬间停下（即使 $K$ 秒中经历了降档操作，仍然算这种情况）。\n\n这些操作我们认为都是在每秒开头的一瞬间进行的，其中换挡操作比踩油门操作先进行。而这一秒内这辆车前进的距离是 转速$\\times$挡位。\n\n现在给出欧稳欧练习时的操作序列，你需要求出他一共前进的距离是多少。", "inputFormat": "第一行六个整数 $T,N,L,R,X,K$，$T$ 表示总时间。\n\n接下来 $T$ 行，每行两个整数 $x,y$，表示这一秒的操作。\n\n其中 $x=0$ 表示升挡，$x=1$ 表示降挡，$x=2$ 表示挡位不变；$y=0$ 表示不踩油门，$y=1$ 表示踩油门。（不要问为什么没有刹车）", "outputFormat": "一行一个整数，表示给定操作序列的前进距离。\n\n如果欧稳欧在挡位为 $N$ 时升挡，或在挡位为 $1$ 时降挡，那么给定序列不合法，输出 $-1$。", "hint": "对于样例一：\n\n第一秒挡位为 $2$，转速为 $6$；  \n第二秒挡位为 $3$，转速为 $1$；  \n第三秒挡位为 $3$，转速为 $6$；  \n第四秒挡位为 $3$，转速为 $10$；  \n第五秒挡位为 $2$，转速为 $10$。\n\n对于样例二，前进两秒之后发动机就停止了工作。\n\n对于 $30\\%$ 的数据，没有挡位操作（即保证 $x=2$）；\n\n对于另外 $30\\%$ 的数据，没有踩油门操作（即保证 $y=0$）；\n\n对于全部数据，保证 $1\\le T,N,L,R,X,K\\le 10^6,L\\le R$。", "locale": "zh-CN"}}}
{"pid": "P5270", "type": "P", "difficulty": 6, "samples": [["5 5 20\n2 2 0 2 0\n2 2 0\n2 0 2\n3 0 2 0\n3 0 2 0\n2 2 2\n10\n2 1 5 5 2 2 4 2 5 3", "6"], ["10 10 10000\n0 1 1 1 0 1 1 0 0 0 \n6 0 0 1 1 1 0 \n6 0 0 0 0 0 0 \n5 0 0 0 0 0 \n4 1 0 0 0 \n5 1 1 1 0 1 \n2 1 1 \n6 0 0 0 0 0 1 \n1 0 \n4 0 0 1 1 \n1 1 \n30\n10 4 3 9 10 9 4 8 5 10 9 8 6 10 10 4 9 2 2 9 6 4 1 10 10 1 9 10 3 5 ", "3001"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["哈希 hashing", "洛谷月赛"], "title": "无论怎样神树大人都会删库跑路", "background": "众所周知，神 J（Joker）每隔几天就会去成都法中假装上课，实际上是去玩指针。神J可以趁别人不注意掏出指针把自己指到任何位置（生物标本柜里大变活人？），或者把两个人的指针交换一下（成都法中版《你的名字》？），或者对着 OJ 念系统命令使得 OJ 随机变慢（mcfx：怎么这 CPU 睿频后反而变慢了）。\n\n神树大人很不满意，因为树必须站在原地，而且神树大人也不会指针。但是神树大人是神，于是他打算把这个宇宙的数据库删了跑路，这样无所事事的神 J 就只能和神树大人玩牌了。", "description": "现在有个长为 $T$ 的字符串 $S$ 和 $n$ 个小字符串 $a_i$。\n\n给定一个长为 $m$ 的数组 $R$，数组下标从 1 开始，初始有一个空字符串 $X$，神树大人打算进行 $Q$ 次操作，第 $i$ 次操作会把小字符串 $a_{R_{(i-1)\\bmod m+1}}$ 丢到这个 $X$ 的末尾。\n\n每次操作后，神树大人会检查这个字符串 $X$ 是否存在一个后缀使得任意排列后可以变成 $S$。\n\n问有多少次这个字符串 $X$ 存在一个后缀使得**任意排列**后可以变成 $S$（即所有字符出现次数相同）。\n\n\n可惜的是，这个字符串字符大小高达 $10^5$，所以你必须读入一个整数数组", "inputFormat": "输入 $n,T,Q$。\n\n接下来输入 $T$ 个数表示字符串 $S$。\n\n接下来输入 $n$ 行，每行第一个数 $len$ 表示长度，接下来输入 $len$ 个数表示这个小字符串，输入的每个数都在 $[0,10^5]$ 范围内。\n\n接下来输入 $m$。\n\n输入一行 $m$ 个数，表示 $R$。", "outputFormat": "输出答案。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/pic/54698.png)\n\n\n### 数据范围\n\n对于所有数据，$n,T,m\\leq 10^5,1\\leq R_i\\leq n,Q\\leq 10^9$，所有小字符串的总长不超过 $10^5$，所有字符 $\\in[0,10^5]$。\n\n| 子任务 | $n$ | $T$ | $Q$ | $m$ | 特殊性质 |\n| :-: | :-: | :-: | :-: | :-: | :- |\n| 1(20分) | $n \\le 10$ | $T \\le 10$ | $Q \\le 100$ | $m \\le 10$| 字符集为 $[0,5]$，小字符串总长不超过 $100$ |\n| 2(30分) | $n \\le 10^3$ | $T \\le 100$ | $Q \\le 10^9$ | $m \\le 10^3$| 字符集为 $[0,5]$，$R_i=i,n=m$，小字符串总长不超过 $100000$ |\n| 3(10分) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$| 字符集为 $[0,5]$，$R_i=i,n=m$ |\n| 4(40分) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$||", "locale": "zh-CN", "translations": {"en": {"title": "No Matter What, Lord Divine Tree Will Drop the Database and Run Away.", "background": "As everyone knows, Divine J (Joker) goes to Chengdu FZ every few days pretending to attend classes, but is actually playing with pointers. Divine J can, when nobody is paying attention, pull out a pointer and point himself to any position (a living person suddenly appearing in a specimen cabinet?), or swap the pointers of two people (the Chengdu FZ version of *Your Name*?), or chant system commands at the OJ to make it randomly slow down (mcfx: why did the CPU get slower after boosting?).\n\nLord Divine Tree is very unhappy, because a tree must stay in place, and Lord Divine Tree also does not know pointers. But Lord Divine Tree is a god, so he plans to delete the database of this universe and run away, so that the idle Divine J can only play cards with Lord Divine Tree.", "description": "There is a string $S$ of length $T$ and $n$ small strings $a_i$.\n\nYou are given an array $R$ of length $m$, indexed starting from 1. Initially, there is an empty string $X$. Lord Divine Tree will perform $Q$ operations. In the $i$-th operation, he appends the small string $a_{R_{(i-1)\\bmod m+1}}$ to the end of $X$.\n\nAfter each operation, Lord Divine Tree checks whether the string $X$ has a suffix such that, after an arbitrary permutation, it can become $S$.\n\nAsk how many times the string $X$ has a suffix that can become $S$ after **an arbitrary permutation** (that is, the counts of all characters are the same).\n\nUnfortunately, the character set size of this string is as large as $10^5$, so you must read the strings as integer arrays.", "inputFormat": "Input $n, T, Q$.\n\nThen input $T$ numbers representing the string $S$.\n\nThen input $n$ lines. In each line, the first number $len$ is the length, followed by $len$ numbers representing this small string. Each input number is in the range $[0,10^5]$.\n\nThen input $m$.\n\nInput one line with $m$ numbers representing $R$.", "outputFormat": "Output the answer.", "hint": "### Explanation for Sample 1\n\n![](https://cdn.luogu.com.cn/upload/pic/54698.png)\n\n### Constraints\n\nFor all testdata, $n, T, m \\leq 10^5$, $1 \\leq R_i \\leq n$, $Q \\leq 10^9$. The total length of all small strings does not exceed $10^5$. All characters are in $[0,10^5]$.\n\n| Subtask | $n$ | $T$ | $Q$ | $m$ | Special Properties |\n| :-: | :-: | :-: | :-: | :-: | :- |\n| 1 (20 points) | $n \\le 10$ | $T \\le 10$ | $Q \\le 100$ | $m \\le 10$ | The alphabet is $[0,5]$, and the total length of all small strings does not exceed $100$. |\n| 2 (30 points) | $n \\le 10^3$ | $T \\le 100$ | $Q \\le 10^9$ | $m \\le 10^3$ | The alphabet is $[0,5]$, $R_i = i$, $n = m$, and the total length of all small strings does not exceed $100000$. |\n| 3 (10 points) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$ | The alphabet is $[0,5]$, $R_i = i$, $n = m$. |\n| 4 (40 points) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$ |  |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "无论怎样神树大人都会删库跑路", "background": "众所周知，神 J（Joker）每隔几天就会去成都法中假装上课，实际上是去玩指针。神J可以趁别人不注意掏出指针把自己指到任何位置（生物标本柜里大变活人？），或者把两个人的指针交换一下（成都法中版《你的名字》？），或者对着 OJ 念系统命令使得 OJ 随机变慢（mcfx：怎么这 CPU 睿频后反而变慢了）。\n\n神树大人很不满意，因为树必须站在原地，而且神树大人也不会指针。但是神树大人是神，于是他打算把这个宇宙的数据库删了跑路，这样无所事事的神 J 就只能和神树大人玩牌了。", "description": "现在有个长为 $T$ 的字符串 $S$ 和 $n$ 个小字符串 $a_i$。\n\n给定一个长为 $m$ 的数组 $R$，数组下标从 1 开始，初始有一个空字符串 $X$，神树大人打算进行 $Q$ 次操作，第 $i$ 次操作会把小字符串 $a_{R_{(i-1)\\bmod m+1}}$ 丢到这个 $X$ 的末尾。\n\n每次操作后，神树大人会检查这个字符串 $X$ 是否存在一个后缀使得任意排列后可以变成 $S$。\n\n问有多少次这个字符串 $X$ 存在一个后缀使得**任意排列**后可以变成 $S$（即所有字符出现次数相同）。\n\n\n可惜的是，这个字符串字符大小高达 $10^5$，所以你必须读入一个整数数组", "inputFormat": "输入 $n,T,Q$。\n\n接下来输入 $T$ 个数表示字符串 $S$。\n\n接下来输入 $n$ 行，每行第一个数 $len$ 表示长度，接下来输入 $len$ 个数表示这个小字符串，输入的每个数都在 $[0,10^5]$ 范围内。\n\n接下来输入 $m$。\n\n输入一行 $m$ 个数，表示 $R$。", "outputFormat": "输出答案。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/pic/54698.png)\n\n\n### 数据范围\n\n对于所有数据，$n,T,m\\leq 10^5,1\\leq R_i\\leq n,Q\\leq 10^9$，所有小字符串的总长不超过 $10^5$，所有字符 $\\in[0,10^5]$。\n\n| 子任务 | $n$ | $T$ | $Q$ | $m$ | 特殊性质 |\n| :-: | :-: | :-: | :-: | :-: | :- |\n| 1(20分) | $n \\le 10$ | $T \\le 10$ | $Q \\le 100$ | $m \\le 10$| 字符集为 $[0,5]$，小字符串总长不超过 $100$ |\n| 2(30分) | $n \\le 10^3$ | $T \\le 100$ | $Q \\le 10^9$ | $m \\le 10^3$| 字符集为 $[0,5]$，$R_i=i,n=m$，小字符串总长不超过 $100000$ |\n| 3(10分) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$| 字符集为 $[0,5]$，$R_i=i,n=m$ |\n| 4(40分) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$||", "locale": "zh-CN"}}}
{"pid": "P5271", "type": "P", "difficulty": 6, "samples": [["2 2", "YES\n0 1\n2 0\n3 0\n1 2\n1 3\n3 2"], ["3 1", "YES\n0 1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "数论", "Special Judge", "分治", "构造", "洛谷月赛"], "title": "OwenOwl 不学车也不删库", "background": "神 mcfx 和神 ComeIntoPower 没事就瞎编题目背景。OwenOwl 去问基佬 zcysky 他们这么做的原因，基佬 zcysky 却这样答复：\n\n![](https://cdn.luogu.com.cn/upload/pic/54751.png)\n\nOwenOwl 非常郁闷，于是他有一天找到了神 J，让神 J 造了 20010910 个指针把他们三个指到阿塞拜疆去陪 sunset 阿克了。\n\n他们三个游览阿塞拜疆的时候，OwenOwl 就把车砸了，库恢复了。\n\n但是因为神 mcfx 和神 ComeIntoPower 之前以 OwenOwl 这个 ID 出了太多毒瘤题，OwenOwl 早就风评被害了。为了证明毒瘤的是他俩，不是自己，OwenOwl 就出了道签到题。", "description": "设 $p$ 是一个质数。\n\n你有一个 $p^k$ 个点的无向完全图（任意两个点之间有一条无向边），点的标号是 $0$ 到 $p^k-1$。\n\n现在你需要从中找出一些 $p$ 个点的完全图，使得原图中每条边属于且恰好属于其中一个完全图。\n\n很显然你需要找出的完全图的个数是 $\\frac{p^k(p^k-1)/2}{p(p-1)/2} $，可以发现这个式子一定是整数", "inputFormat": "一行两个正整数 $p,k$。", "outputFormat": "如果无解，输出一行 `NO`。\n\n否则输出一行 `YES`，接下来输出 $\\frac{p^k(p^k-1)/2}{p(p-1)/2} $ 行，每行 $p$ 个数表示你找出的这个完全图的点的编号。\n\n按任意顺序输出任意一种方案即可。", "hint": "对于 $10\\%$ 的数据，$k \\le 1$；\n\n对于 $50\\%$ 的数据，$k \\le 2$；\n\n另有 $20\\%$ 的数据，$p = 2$；\n\n对于 $100\\%$ 的数据，$k$ 是正整数，$p$ 是质数，$2 \\le p^k \\le 2000$。\n\n另外，保证输出总量不超过 2MB，但仍请注意控制输出所花费的时间。", "locale": "zh-CN", "translations": {"en": {"title": "OwenOwl Does Not Learn Driving and Does Not Delete Repos", "background": "mcfx and ComeIntoPower like to make up problem backgrounds when they are bored. OwenOwl asked “buddy” zcysky why they did this, and “buddy” zcysky replied like this:\n\n![](https://cdn.luogu.com.cn/upload/pic/54751.png)\n\nOwenOwl felt very upset, so one day he found J, and asked J to create 20010910 pointers to point the three of them to Azerbaijan to keep sunset company there.\n\nWhile the three of them were touring Azerbaijan, OwenOwl smashed the car, and the repository was restored.\n\nHowever, since mcfx and ComeIntoPower had previously posted too many nasty problems using the ID OwenOwl, OwenOwl’s reputation had already been damaged. To prove that the nasty ones were those two and not himself, OwenOwl made an easy “sign-in” problem.", "description": "Let $p$ be a prime number.\n\nYou are given an undirected complete graph with $p^k$ vertices (there is an undirected edge between any two vertices). The vertices are labeled from $0$ to $p^k-1$.\n\nNow you need to find some complete subgraphs on $p$ vertices such that every edge in the original graph belongs to one and only one of these complete subgraphs.\n\nObviously, the number of complete subgraphs you need to find is $\\frac{p^k(p^k-1)/2}{p(p-1)/2}$. You can see that this expression is always an integer.", "inputFormat": "One line containing two positive integers $p, k$.", "outputFormat": "If there is no solution, output one line `NO`.\n\nOtherwise, output one line `YES`, then output $\\frac{p^k(p^k-1)/2}{p(p-1)/2}$ lines. Each line contains $p$ numbers, representing the vertex labels of one complete subgraph you found.\n\nYou may output any valid solution in any order.", "hint": "For $10\\%$ of the testdata, $k \\le 1$.\n\nFor $50\\%$ of the testdata, $k \\le 2$.\n\nAnother $20\\%$ of the testdata has $p = 2$.\n\nFor $100\\%$ of the testdata, $k$ is a positive integer, $p$ is prime, and $2 \\le p^k \\le 2000$.\n\nIn addition, the total output size is guaranteed not to exceed 2MB, but you should still pay attention to the time spent on output.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "OwenOwl 不学车也不删库", "background": "神 mcfx 和神 ComeIntoPower 没事就瞎编题目背景。OwenOwl 去问基佬 zcysky 他们这么做的原因，基佬 zcysky 却这样答复：\n\n![](https://cdn.luogu.com.cn/upload/pic/54751.png)\n\nOwenOwl 非常郁闷，于是他有一天找到了神 J，让神 J 造了 20010910 个指针把他们三个指到阿塞拜疆去陪 sunset 阿克了。\n\n他们三个游览阿塞拜疆的时候，OwenOwl 就把车砸了，库恢复了。\n\n但是因为神 mcfx 和神 ComeIntoPower 之前以 OwenOwl 这个 ID 出了太多毒瘤题，OwenOwl 早就风评被害了。为了证明毒瘤的是他俩，不是自己，OwenOwl 就出了道签到题。", "description": "设 $p$ 是一个质数。\n\n你有一个 $p^k$ 个点的无向完全图（任意两个点之间有一条无向边），点的标号是 $0$ 到 $p^k-1$。\n\n现在你需要从中找出一些 $p$ 个点的完全图，使得原图中每条边属于且恰好属于其中一个完全图。\n\n很显然你需要找出的完全图的个数是 $\\frac{p^k(p^k-1)/2}{p(p-1)/2} $，可以发现这个式子一定是整数", "inputFormat": "一行两个正整数 $p,k$。", "outputFormat": "如果无解，输出一行 `NO`。\n\n否则输出一行 `YES`，接下来输出 $\\frac{p^k(p^k-1)/2}{p(p-1)/2} $ 行，每行 $p$ 个数表示你找出的这个完全图的点的编号。\n\n按任意顺序输出任意一种方案即可。", "hint": "对于 $10\\%$ 的数据，$k \\le 1$；\n\n对于 $50\\%$ 的数据，$k \\le 2$；\n\n另有 $20\\%$ 的数据，$p = 2$；\n\n对于 $100\\%$ 的数据，$k$ 是正整数，$p$ 是质数，$2 \\le p^k \\le 2000$。\n\n另外，保证输出总量不超过 2MB，但仍请注意控制输出所花费的时间。", "locale": "zh-CN"}}}
{"pid": "P5272", "type": "P", "difficulty": 7, "samples": [["5\n54 63 5 59 5 27 2\n33 42 1 29 9 23 2\n54 55 56 57 2 1 3\n40 64 17 40 19 9 1\n54 65 35 50 3 10 3", "626436786\n71428572\n250000002\n1\n154489797"], ["3\n1 2 1 2 1 1 2\n3 100 39 100 1 1 2\n48395 309846 34098 234095 1 1 2", "500000004\n779746001\n262016540\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "位运算", "洛谷月赛"], "title": "总而言之神J要去练习篮球", "background": "神J和神树大人正在开发一个睡眠程序，运行之后人们就能在梦里随机看到宇宙中的一角。当然大部分时候这一角都是黑的，所以人们总是觉得自己没有做梦。\n\n神J留了个后门，只需要操控指针，就能钦定一个人的梦。于是神J天天操控神树大人梦里写代码。\n\n神树大人很不满意，因为树必须天天睡觉。神树大人是神，早就知道神J在背后操控，所以他也留了个后门，只需要输入特殊命令，就能强迫神J睡觉，并在梦里做任何事情。\n\n这天，神J突然发现自己身处一个大篮球场里，周围有许多学员在练习三人篮球赛。“你傻站在那干啥呢？”神树大人吹着哨子走了过来，“快去练习，都要举行肯德基三人篮球全国总决赛了，快去投进114514个球，再运球过1919810个人。zcy快过来监督他。”一个篮球突然出现在神J手里。于是神J就在zcy的监督下练习了一个下午的篮球。", "description": "为了防止神J用篮球造出一个指针把自己指出去，神树大人钦定神J用篮球造一个矩阵。\n\n这个矩阵无限大，行列从0开始标号，且$a[i][j]=i\\ xor\\ j$\n\n![](https://cdn.luogu.com.cn/upload/pic/54403.png)\n\n现在，对于一个左上角为$(lx,ly)$，右下角为$(rx,ry)$的子矩阵，$K(K\\leq 10^9)$次随机从里面取$W\\times H$的矩阵，问取出的矩阵完全一样的概率，对$10^9+7$取模。\n", "inputFormat": "第一行一个数$Q$表示$Q$组询问\n\n之后$Q$行每行7个数$lx,rx,ly,ry,W,H,K$", "outputFormat": "输出答案对$10^9+7$取模。保证答案存在。", "hint": "对于`1 2 1 2 1 1 2`这组询问\n\n![](https://cdn.luogu.com.cn/upload/pic/54402.png)\n\n可以取的矩阵有：0,3，各出现两次。\n\n有如下情况：\n\n第一次取到 3，第二次取到 0，一共4种方法\n\n第一次取到 3，第二次取到 3，一共4种方法\n\n第一次取到 0，第二次取到 0，一共4种方法\n\n第一次取到 0，第二次取到 3，一共4种方法\n\n一共16种方法，符合条件的有4+4=8种\n\n所以答案为 8/16=500000004(mod 10^9+7)\n\n\n##数据范围\n\n对于所有的数据，$0\\leq lx\\leq rx\\leq 10^9,0\\leq ly\\leq ry\\leq 10^9,W\\leq rx-lx+1,H\\leq ry-ly+1,1\\leq K\\leq 10^9,Q\\leq 10^3$\n\n![](https://cdn.luogu.com.cn/upload/pic/54632.png)\n\n空格为无特殊限制", "locale": "zh-CN", "translations": {"en": {"title": "Anyway, God J Is Going to Practice Basketball.", "background": "God J and Lord God Tree are developing a sleep program. After running it, people can randomly see a corner of the universe in their dreams. Of course, most of the time that corner is dark, so people always feel that they did not dream at all.\n\nGod J left a backdoor: as long as he controls a pointer, he can “assign” someone’s dream. So God J controls Lord God Tree’s dreams every day to write code.\n\nLord God Tree is very unhappy, because a tree has to sleep every day. Lord God Tree is a god, and he already knew that God J was controlling things behind the scenes, so he also left a backdoor: as long as you enter a special command, you can force God J to sleep and do anything in the dream.\n\nOne day, God J suddenly found himself in a huge basketball court, with many trainees practicing a 3-on-3 basketball game. “Why are you standing there like an idiot?” Lord God Tree walked over blowing a whistle. “Go practice. The KFC 3-on-3 National Finals are coming. Go score 114514 shots, then dribble past 1919810 people. zcy, come over and watch him.” A basketball suddenly appeared in God J’s hand. So God J practiced basketball for an entire afternoon under zcy’s supervision.", "description": "To prevent God J from using a basketball to create a pointer and point himself out, Lord God Tree forces God J to use basketballs to build a matrix.\n\nThis matrix is infinite. Rows and columns are indexed starting from 0, and $a[i][j]=i\\ xor\\ j$.\n\n![](https://cdn.luogu.com.cn/upload/pic/54403.png)\n\nNow, for a submatrix with top-left corner $(lx,ly)$ and bottom-right corner $(rx,ry)$, we randomly select a $W\\times H$ matrix from it $K$ times $(K\\leq 10^9)$. Ask for the probability that all selected matrices are exactly the same, modulo $10^9+7$.", "inputFormat": "The first line contains an integer $Q$, meaning there are $Q$ queries.\n\nThen $Q$ lines follow, each containing 7 integers $lx,rx,ly,ry,W,H,K$.", "outputFormat": "Output the answer modulo $10^9+7$. It is guaranteed that the answer exists.", "hint": "For the query `1 2 1 2 1 1 2`:\n\n![](https://cdn.luogu.com.cn/upload/pic/54402.png)\n\nThe matrices that can be selected are: 0 and 3, each appearing twice.\n\nThere are the following cases:\n\nFirst pick 3, second pick 0, a total of 4 ways.\n\nFirst pick 3, second pick 3, a total of 4 ways.\n\nFirst pick 0, second pick 0, a total of 4 ways.\n\nFirst pick 0, second pick 3, a total of 4 ways.\n\nThere are 16 ways in total, and the valid ones are $4+4=8$ ways.\n\nSo the answer is $8/16=500000004(mod\\ 10^9+7)$.\n\n## Constraints\n\nFor all testdata, $0\\leq lx\\leq rx\\leq 10^9,0\\leq ly\\leq ry\\leq 10^9,W\\leq rx-lx+1,H\\leq ry-ly+1,1\\leq K\\leq 10^9,Q\\leq 10^3$.\n\n![](https://cdn.luogu.com.cn/upload/pic/54632.png)\n\nBlank means there are no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "总而言之神J要去练习篮球", "background": "神J和神树大人正在开发一个睡眠程序，运行之后人们就能在梦里随机看到宇宙中的一角。当然大部分时候这一角都是黑的，所以人们总是觉得自己没有做梦。\n\n神J留了个后门，只需要操控指针，就能钦定一个人的梦。于是神J天天操控神树大人梦里写代码。\n\n神树大人很不满意，因为树必须天天睡觉。神树大人是神，早就知道神J在背后操控，所以他也留了个后门，只需要输入特殊命令，就能强迫神J睡觉，并在梦里做任何事情。\n\n这天，神J突然发现自己身处一个大篮球场里，周围有许多学员在练习三人篮球赛。“你傻站在那干啥呢？”神树大人吹着哨子走了过来，“快去练习，都要举行肯德基三人篮球全国总决赛了，快去投进114514个球，再运球过1919810个人。zcy快过来监督他。”一个篮球突然出现在神J手里。于是神J就在zcy的监督下练习了一个下午的篮球。", "description": "为了防止神J用篮球造出一个指针把自己指出去，神树大人钦定神J用篮球造一个矩阵。\n\n这个矩阵无限大，行列从0开始标号，且$a[i][j]=i\\ xor\\ j$\n\n![](https://cdn.luogu.com.cn/upload/pic/54403.png)\n\n现在，对于一个左上角为$(lx,ly)$，右下角为$(rx,ry)$的子矩阵，$K(K\\leq 10^9)$次随机从里面取$W\\times H$的矩阵，问取出的矩阵完全一样的概率，对$10^9+7$取模。\n", "inputFormat": "第一行一个数$Q$表示$Q$组询问\n\n之后$Q$行每行7个数$lx,rx,ly,ry,W,H,K$", "outputFormat": "输出答案对$10^9+7$取模。保证答案存在。", "hint": "对于`1 2 1 2 1 1 2`这组询问\n\n![](https://cdn.luogu.com.cn/upload/pic/54402.png)\n\n可以取的矩阵有：0,3，各出现两次。\n\n有如下情况：\n\n第一次取到 3，第二次取到 0，一共4种方法\n\n第一次取到 3，第二次取到 3，一共4种方法\n\n第一次取到 0，第二次取到 0，一共4种方法\n\n第一次取到 0，第二次取到 3，一共4种方法\n\n一共16种方法，符合条件的有4+4=8种\n\n所以答案为 8/16=500000004(mod 10^9+7)\n\n\n##数据范围\n\n对于所有的数据，$0\\leq lx\\leq rx\\leq 10^9,0\\leq ly\\leq ry\\leq 10^9,W\\leq rx-lx+1,H\\leq ry-ly+1,1\\leq K\\leq 10^9,Q\\leq 10^3$\n\n![](https://cdn.luogu.com.cn/upload/pic/54632.png)\n\n空格为无特殊限制", "locale": "zh-CN"}}}
{"pid": "P5273", "type": "P", "difficulty": 6, "samples": [["2 2\n1 1", "1 2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2019", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式幂函数（加强版）", "background": "[普通版传送门](https://www.luogu.com.cn/problem/P5245)\n\n模板题，无背景。", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 $\\bmod\\ x^n$ 意义下的多项式 $B(x)$，使得 $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 个整数，依次表示 $A(x)$ 的系数 $a_0, a_1,...,a_{n-1}$。", "outputFormat": "输出 $n$ 个整数，依次表示 $B(x)$ 的前 $n$ 项系数 $b_0, b_1,...,b_{n-1}$ 在模 $998244353$ 意义下的最小自然数值。", "hint": "对于 $100\\%$ 的数据，$1< n \\leq 10^5$，$0 \\leq k \\leq 10^{10^5}$，$a_i \\in [0,998244352]$。\n\n[数据更新时间](https://www.luogu.com.cn/paste/897zk1ia)", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Polynomial Power Function (Enhanced Version).", "background": "[Link to the normal version](https://www.luogu.com.cn/problem/P5245).\n\nThis is a template problem with no background.", "description": "Given a degree $n-1$ polynomial $A(x)$, find a polynomial $B(x)$ under $\\bmod\\ x^n$ such that $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$.\n\nAll polynomial coefficients are computed under $\\bmod\\ 998244353$.", "inputFormat": "The first line contains two integers $n, k$.\n\nThe next line contains $n$ integers, which are the coefficients of $A(x)$ in order: $a_0, a_1, ..., a_{n-1}$.", "outputFormat": "Output $n$ integers, which are the first $n$ coefficients of $B(x)$ in order: $b_0, b_1, ..., b_{n-1}$, each being the smallest non-negative integer modulo $998244353$.", "hint": "For $100\\%$ of the testdata, $1 < n \\leq 10^5$, $0 \\leq k \\leq 10^{10^5}$, $a_i \\in [0, 998244352]$.\n\n[Data update time](https://www.luogu.com.cn/paste/897zk1ia).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式幂函数（加强版）", "background": "[普通版传送门](https://www.luogu.com.cn/problem/P5245)\n\n模板题，无背景。", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 $\\bmod\\ x^n$ 意义下的多项式 $B(x)$，使得 $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 个整数，依次表示 $A(x)$ 的系数 $a_0, a_1,...,a_{n-1}$。", "outputFormat": "输出 $n$ 个整数，依次表示 $B(x)$ 的前 $n$ 项系数 $b_0, b_1,...,b_{n-1}$ 在模 $998244353$ 意义下的最小自然数值。", "hint": "对于 $100\\%$ 的数据，$1< n \\leq 10^5$，$0 \\leq k \\leq 10^{10^5}$，$a_i \\in [0,998244352]$。\n\n[数据更新时间](https://www.luogu.com.cn/paste/897zk1ia)", "locale": "zh-CN"}}}
{"pid": "P5277", "type": "P", "difficulty": 6, "samples": [["3\n1 2 1\n", "1 1 0"], ["7\n1 8596489 489489 4894 1564 489 35789489  \n", "1 503420421 924499237 13354513 217017417 707895465 411020414\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式开根（加强版）", "background": "模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$ ，求一个在 $\\bmod\\ {x^n}$ 意义下的多项式 $B(x)$ ，使得 $B^2(x)\\equiv A(x)\\pmod {x^n}$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 个整数，依次表示多项式的系数 $a_0,a_1,\\ldots ,a_{n-1}$。\n\n**不保证 $a_0=1$，但保证 $a_0$ 是 $\\bmod\\ 998244353$ 下的二次剩余。**", "outputFormat": "输出 $n$ 个非负整数，表示答案多项式的系数 $b_0,b_1,\\ldots ,b_{n-1}$。如有多解，输出**系数序列**（而非字符序列）字典序最小的。", "hint": "对于 $25\\%$ 的数据，有 $n \\leq 1000$。\n\n对于 $50\\%$ 的数据，有 $n \\leq 10^4$。\n\n对于 $75\\%$ 的数据，有 $n \\leq 5\\times 10^4$。\n\n对于 $100\\%$ 的数据，有 $n \\leq 10^5,a_i \\in [0,998244352] \\cap \\mathbb{Z}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Polynomial Square Root (Enhanced Version)", "background": "This is a template problem, with no background.", "description": "Given an $(n - 1)$-degree polynomial $A(x)$, find a polynomial $B(x)$ modulo $x^n$ such that $B^2(x)\\equiv A(x)\\pmod {x^n}$.\n\nAll polynomial coefficients are computed modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next line contains $n$ integers, representing the coefficients $a_0,a_1,\\ldots ,a_{n-1}$ in order.\n\n**It is not guaranteed that $a_0=1$, but it is guaranteed that $a_0$ is a quadratic residue modulo $998244353$.**", "outputFormat": "Output $n$ non-negative integers, representing the coefficients $b_0,b_1,\\ldots ,b_{n-1}$ of the answer polynomial. If there are multiple solutions, output the one with the smallest lexicographical order of the **coefficient sequence** (not the character sequence).", "hint": "For $25\\%$ of the testdata, $n \\leq 1000$.\n\nFor $50\\%$ of the testdata, $n \\leq 10^4$.\n\nFor $75\\%$ of the testdata, $n \\leq 5\\times 10^4$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^5$, and $a_i \\in [0,998244352] \\cap \\mathbb{Z}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式开根（加强版）", "background": "模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$ ，求一个在 $\\bmod\\ {x^n}$ 意义下的多项式 $B(x)$ ，使得 $B^2(x)\\equiv A(x)\\pmod {x^n}$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 个整数，依次表示多项式的系数 $a_0,a_1,\\ldots ,a_{n-1}$。\n\n**不保证 $a_0=1$，但保证 $a_0$ 是 $\\bmod\\ 998244353$ 下的二次剩余。**", "outputFormat": "输出 $n$ 个非负整数，表示答案多项式的系数 $b_0,b_1,\\ldots ,b_{n-1}$。如有多解，输出**系数序列**（而非字符序列）字典序最小的。", "hint": "对于 $25\\%$ 的数据，有 $n \\leq 1000$。\n\n对于 $50\\%$ 的数据，有 $n \\leq 10^4$。\n\n对于 $75\\%$ 的数据，有 $n \\leq 5\\times 10^4$。\n\n对于 $100\\%$ 的数据，有 $n \\leq 10^5,a_i \\in [0,998244352] \\cap \\mathbb{Z}$。", "locale": "zh-CN"}}}
{"pid": "P5278", "type": "P", "difficulty": 6, "samples": [["5 3\n1 3 2 5 6\n2 1 5 1\n1 5 4\n2 1 5 1", "No\nYes"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树"], "title": "算术天才⑨与等差数列", "background": null, "description": "算术天才⑨非常喜欢和等差数列玩耍。   \n有一天，他给了你一个长度为 $n$ 的序列，其中第 $i$ 个数为 $a_i$。  \n他想考考你，每次他会给出询问 $l,r,k$，问区间 $[l,r]$ 内的数从小到大排序后能否形成公差为 $k$ 的等差数列。  \n当然，他还会不断修改其中的某一项。  \n为了不被他鄙视，你必须要快速并正确地回答完所有问题。  \n注意：只有一个数的数列也是等差数列。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示序列的长度和操作的次数。   \n第二行包含 $n$ 个整数，依次表示序列中的每个数 $a_i$。   \n接下来 $m$ 行，每行一开始为一个数 $\\text{op}$，   \n若 $\\text{op}=1$，则接下来两个整数 $x,y$，表示把 $a_x$ 修改为 $y$，  \n若 $\\text{op}=2$，则接下来三个整数 $l,r,k$，表示一个询问。  \n**在本题中，$x,y,l,r,k$ 都是经过加密的，都需要异或你之前输出的 `Yes` 的个数来进行解密。**", "outputFormat": "输出若干行，对于每个询问，如果可以形成等差数列，那么输出 `Yes`，否则输出 `No`。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据， $1\\le n,m \\le 3\\times 10^5$，$0\\le a_i,y,k \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Arithmetic Genius ⑨ and Arithmetic Progressions", "background": "", "description": "Arithmetic Genius ⑨ really likes playing with arithmetic progressions.  \nOne day, he gave you a sequence of length $n$, where the $i$-th number is $a_i$.  \nHe wants to test you. Each time, he will give a query $l, r, k$ and ask whether the numbers in the interval $[l, r]$, after being sorted in increasing order, can form an arithmetic progression with common difference $k$.  \nOf course, he will also keep modifying some element.  \nTo avoid being looked down on by him, you must answer all queries quickly and correctly.  \nNote: A sequence with only one number is also an arithmetic progression.", "inputFormat": "The first line contains two positive integers $n, m$, representing the length of the sequence and the number of operations.  \nThe second line contains $n$ integers, in order, representing each number in the sequence $a_i$.  \nThe next $m$ lines each start with a number $\\text{op}$.  \nIf $\\text{op} = 1$, then two integers $x, y$ follow, meaning to modify $a_x$ to $y$.  \nIf $\\text{op} = 2$, then three integers $l, r, k$ follow, meaning a query.  \n**In this problem, $x, y, l, r, k$ are all encrypted, and you need to decrypt them by XORing with the number of `Yes` you have output before.**", "outputFormat": "Output several lines. For each query, if it can form an arithmetic progression, output `Yes`; otherwise output `No`.", "hint": "Constraints  \nFor $100\\%$ of the testdata, $1 \\le n, m \\le 3 \\times 10^5$, and $0 \\le a_i, y, k \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "算术天才⑨与等差数列", "background": null, "description": "算术天才⑨非常喜欢和等差数列玩耍。   \n有一天，他给了你一个长度为 $n$ 的序列，其中第 $i$ 个数为 $a_i$。  \n他想考考你，每次他会给出询问 $l,r,k$，问区间 $[l,r]$ 内的数从小到大排序后能否形成公差为 $k$ 的等差数列。  \n当然，他还会不断修改其中的某一项。  \n为了不被他鄙视，你必须要快速并正确地回答完所有问题。  \n注意：只有一个数的数列也是等差数列。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示序列的长度和操作的次数。   \n第二行包含 $n$ 个整数，依次表示序列中的每个数 $a_i$。   \n接下来 $m$ 行，每行一开始为一个数 $\\text{op}$，   \n若 $\\text{op}=1$，则接下来两个整数 $x,y$，表示把 $a_x$ 修改为 $y$，  \n若 $\\text{op}=2$，则接下来三个整数 $l,r,k$，表示一个询问。  \n**在本题中，$x,y,l,r,k$ 都是经过加密的，都需要异或你之前输出的 `Yes` 的个数来进行解密。**", "outputFormat": "输出若干行，对于每个询问，如果可以形成等差数列，那么输出 `Yes`，否则输出 `No`。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据， $1\\le n,m \\le 3\\times 10^5$，$0\\le a_i,y,k \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5279", "type": "P", "difficulty": 7, "samples": [["9\n1 1\n1 2\n1 3\n2 1\n3 1\n4 1\n5 1\n6 1\n7 1\n8 1\n9 1\n9 2\n9 3", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化", "DP 套 DP"], "title": "[ZJOI2019] 麻将", "background": null, "description": "九条可怜是一个热爱打麻将的女孩子。因此她出了一道和麻将相关的题目，希望这题不会让你对麻将的热爱消失殆尽。\n\n![](https://cdn.luogu.com.cn/upload/pic/55642.png)\n\n今天，可怜想要打麻将，但是她的朋友们都去下自走棋了，因此可怜只能自己一个人打。可怜找了一套特殊的麻将，它有 $n(n\\ge 5)$ 种不同的牌，大小分别为 $1$ 到 $n$，每种牌都有 $4$ 张。\n\n定义面子为三张大小相同或者大小相邻的麻将牌，即大小形如 $i,i,i(1 \\le i \\le n)$ 或者 $i,i+1,i+2(1\\le i\\le n-2)$。定义对子为两张大小相同的麻将牌，即大小形如 $i,i(1 \\le i \\le n)$。\n\n定义一个麻将牌集合 $S$ 是胡的当且仅当它的大小为 $14$ 且满足下面两个条件中的至少一个：\n\n-  $S$ 可以被划分成五个集合 $S_1$ 至 $S_5$。其中 $S_1$ 为对子，$S_2$ 至 $S_5$ 为面子。\n-  $S$ 可以被划分成七个集合 $S_1$ 至 $S_7$，它们都是对子，且对应的大小**两两不同**。\n\n举例来说，下列集合都是胡的（这儿只标记了大小）：\n\n-  $\\{1,1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n-  $\\{1,1,2,2,4,4,5,5,6,6,7,7,8,8\\}$\n-  $\\{1,1,2,2,3,3,4,4,5,5,6,6,7,7\\}$\n\n而下列集合都不是胡的：\n\n-  $\\{1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n-  $\\{1,1,1,1,4,4,5,5,6,6,7,7,8,8\\}$\n-  $\\{1,1,1,2,3,4,5,6,7,8,9,9,9,11\\}$\n\n可怜先摸出了 $13$ 张牌，并把剩下的 $4n-13$ 张牌随机打乱。打乱是等概率随机的，即所有 $(4n-13)!$ 种排列都等概率出现。\n\n对于一个排列 $P$，可怜定义 $S_i$ 为可怜事先摸出的 $13$ 张牌加上 $P$ 中的前 $i$ 张牌构成的集合，定义 $P$ 的权值为**最小的 $i$ 满足 $S_i$ 存在一个子集是胡的**。如果你对麻将比较熟悉，不难发现 $P$ 的权值就是理论上的最早胡牌巡目数。注意到 $n\\ge 5$ 的时候，$S_{4n-13}$ 总是存在胡的子集的，因此 $P$ 的权值是良定义的。\n\n现在可怜想要训练自己的牌效，因此她希望你能先计算出 $P$ 的权值的期望是多少。", "inputFormat": "第一行输入一个整数 $n$，表示这副特殊的麻将牌中的大小种类数。\n\n接下来输入 $13$ 行每行两个整数 $w,t(1 \\le w \\le n,1 \\le t \\le 4)$，表示可怜最开始摸出的第 $i$ 张牌是大小为 $w$ 的第 $t$ 张牌，保证 $(w,t)$ 二元组两两不同。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为 $\\frac{x}{y}(x \\ge 0,y \\ge 1,gcd(x,y) = 1)$，你需要输出 $x\\times y^{-1}\\ \\mathrm{mod}\\: 998244353$。", "hint": "上述牌型叫做纯正九莲宝灯，不难发现不管再加一张什么牌它都是胡的。所以对于所有排列 $P$，权值都是 $1$，因此权值的期望就是 $1$。\n\n对于 $20\\%$ 的数据，$n = 5$。\n\n对于 $50\\%$ 的数据，$n\\le 13$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,w_i = i,t_i = 1$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,w_i = \\lceil \\frac{i}{4} \\rceil ,t_i= i\\ \\mathrm{mod}\\ 4 + 1$。\n\n对于 $100\\%$ 的数据，$5 \\le n \\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Mahjong", "background": "", "description": "Jiutiao Kelian is a girl who loves playing Mahjong. So she made a Mahjong-related problem, hoping this problem will not make your love for Mahjong disappear completely.\n\n![](https://cdn.luogu.com.cn/upload/pic/55642.png)\n\nToday, Kelian wants to play Mahjong, but all her friends went to play Auto Chess, so Kelian can only play alone. Kelian found a special Mahjong set. It has $n(n\\ge 5)$ different tile values, with values from $1$ to $n$. For each value, there are $4$ tiles.\n\nA meld is defined as three tiles that are either all the same value or consecutive values, i.e., with values of the form $i,i,i(1 \\le i \\le n)$ or $i,i+1,i+2(1\\le i\\le n-2)$. A pair is defined as two tiles of the same value, i.e., with values of the form $i,i(1 \\le i \\le n)$.\n\nA multiset of Mahjong tiles $S$ is said to be winning if and only if its size is $14$ and it satisfies at least one of the following two conditions:\n\n- $S$ can be partitioned into five multisets $S_1$ to $S_5$, where $S_1$ is a pair, and $S_2$ to $S_5$ are melds.\n- $S$ can be partitioned into seven multisets $S_1$ to $S_7$, all of which are pairs, and their corresponding values are **pairwise distinct**.\n\nFor example, the following multisets are all winning (only the values are shown here):\n\n- $\\{1,1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n- $\\{1,1,2,2,4,4,5,5,6,6,7,7,8,8\\}$\n- $\\{1,1,2,2,3,3,4,4,5,5,6,6,7,7\\}$\n\nAnd the following multisets are all not winning:\n\n- $\\{1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n- $\\{1,1,1,1,4,4,5,5,6,6,7,7,8,8\\}$\n- $\\{1,1,1,2,3,4,5,6,7,8,9,9,9,11\\}$\n\nKelian first draws $13$ tiles, and then randomly shuffles the remaining $4n-13$ tiles. The shuffling is uniformly random, i.e., all $(4n-13)!$ permutations occur with equal probability.\n\nFor a permutation $P$, Kelian defines $S_i$ as the multiset formed by the $13$ tiles she drew in advance plus the first $i$ tiles in $P$. The weight of $P$ is defined as the **minimum $i$ such that $S_i$ has a subset that is winning**. If you are familiar with Mahjong, it is not hard to see that the weight of $P$ is the earliest theoretical turn to win. Note that when $n\\ge 5$, $S_{4n-13}$ always has a winning subset, so the weight of $P$ is well-defined.\n\nNow Kelian wants to train her tile efficiency, so she hopes you can first compute the expected value of the weight of $P$.", "inputFormat": "The first line contains an integer $n$, indicating the number of different tile values in this special Mahjong set.\n\nThen follow $13$ lines, each containing two integers $w,t(1 \\le w \\le n,1 \\le t \\le 4)$, indicating that the $i$-th tile Kelian initially drew is the $t$-th tile of value $w$. It is guaranteed that the pairs $(w,t)$ are pairwise distinct.", "outputFormat": "Output one line containing one integer, indicating the answer modulo $998244353$. That is, if the answer in lowest terms is $\\frac{x}{y}(x \\ge 0,y \\ge 1,gcd(x,y) = 1)$, you need to output $x\\times y^{-1}\\ \\mathrm{mod}\\: 998244353$.", "hint": "The above hand type is called Pure Nine Gates. It is not hard to see that no matter what tile you add, it is winning. Therefore, for all permutations $P$, the weight is $1$, so the expected weight is $1$.\n\nFor $20\\%$ of the testdata, $n = 5$.\n\nFor $50\\%$ of the testdata, $n\\le 13$.\n\nFor another $20\\%$ of the testdata, $n \\le 100,w_i = i,t_i = 1$.\n\nFor another $20\\%$ of the testdata, $n \\le 100,w_i = \\lceil \\frac{i}{4} \\rceil ,t_i= i\\ \\mathrm{mod}\\ 4 + 1$.\n\nFor $100\\%$ of the testdata, $5 \\le n \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 麻将", "background": null, "description": "九条可怜是一个热爱打麻将的女孩子。因此她出了一道和麻将相关的题目，希望这题不会让你对麻将的热爱消失殆尽。\n\n![](https://cdn.luogu.com.cn/upload/pic/55642.png)\n\n今天，可怜想要打麻将，但是她的朋友们都去下自走棋了，因此可怜只能自己一个人打。可怜找了一套特殊的麻将，它有 $n(n\\ge 5)$ 种不同的牌，大小分别为 $1$ 到 $n$，每种牌都有 $4$ 张。\n\n定义面子为三张大小相同或者大小相邻的麻将牌，即大小形如 $i,i,i(1 \\le i \\le n)$ 或者 $i,i+1,i+2(1\\le i\\le n-2)$。定义对子为两张大小相同的麻将牌，即大小形如 $i,i(1 \\le i \\le n)$。\n\n定义一个麻将牌集合 $S$ 是胡的当且仅当它的大小为 $14$ 且满足下面两个条件中的至少一个：\n\n-  $S$ 可以被划分成五个集合 $S_1$ 至 $S_5$。其中 $S_1$ 为对子，$S_2$ 至 $S_5$ 为面子。\n-  $S$ 可以被划分成七个集合 $S_1$ 至 $S_7$，它们都是对子，且对应的大小**两两不同**。\n\n举例来说，下列集合都是胡的（这儿只标记了大小）：\n\n-  $\\{1,1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n-  $\\{1,1,2,2,4,4,5,5,6,6,7,7,8,8\\}$\n-  $\\{1,1,2,2,3,3,4,4,5,5,6,6,7,7\\}$\n\n而下列集合都不是胡的：\n\n-  $\\{1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n-  $\\{1,1,1,1,4,4,5,5,6,6,7,7,8,8\\}$\n-  $\\{1,1,1,2,3,4,5,6,7,8,9,9,9,11\\}$\n\n可怜先摸出了 $13$ 张牌，并把剩下的 $4n-13$ 张牌随机打乱。打乱是等概率随机的，即所有 $(4n-13)!$ 种排列都等概率出现。\n\n对于一个排列 $P$，可怜定义 $S_i$ 为可怜事先摸出的 $13$ 张牌加上 $P$ 中的前 $i$ 张牌构成的集合，定义 $P$ 的权值为**最小的 $i$ 满足 $S_i$ 存在一个子集是胡的**。如果你对麻将比较熟悉，不难发现 $P$ 的权值就是理论上的最早胡牌巡目数。注意到 $n\\ge 5$ 的时候，$S_{4n-13}$ 总是存在胡的子集的，因此 $P$ 的权值是良定义的。\n\n现在可怜想要训练自己的牌效，因此她希望你能先计算出 $P$ 的权值的期望是多少。", "inputFormat": "第一行输入一个整数 $n$，表示这副特殊的麻将牌中的大小种类数。\n\n接下来输入 $13$ 行每行两个整数 $w,t(1 \\le w \\le n,1 \\le t \\le 4)$，表示可怜最开始摸出的第 $i$ 张牌是大小为 $w$ 的第 $t$ 张牌，保证 $(w,t)$ 二元组两两不同。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为 $\\frac{x}{y}(x \\ge 0,y \\ge 1,gcd(x,y) = 1)$，你需要输出 $x\\times y^{-1}\\ \\mathrm{mod}\\: 998244353$。", "hint": "上述牌型叫做纯正九莲宝灯，不难发现不管再加一张什么牌它都是胡的。所以对于所有排列 $P$，权值都是 $1$，因此权值的期望就是 $1$。\n\n对于 $20\\%$ 的数据，$n = 5$。\n\n对于 $50\\%$ 的数据，$n\\le 13$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,w_i = i,t_i = 1$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,w_i = \\lceil \\frac{i}{4} \\rceil ,t_i= i\\ \\mathrm{mod}\\ 4 + 1$。\n\n对于 $100\\%$ 的数据，$5 \\le n \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5280", "type": "P", "difficulty": 6, "samples": [["5 5\n2\n1 1 3\n2\n1 3 5\n2", "0\n1\n6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] 线段树", "background": null, "description": "九条可怜是一个喜欢数据结构的女孩子，在常见的数据结构中，可怜最喜欢的就是线段树。\n\n线段树的核心是懒标记，下面是一个带懒标记的线段树的伪代码，其中 $tag$ 数组为懒标记：\n\n![](https://cdn.luogu.com.cn/upload/pic/55648.png)\n\n其中函数 $\\operatorname{Lson}(Node)$ 表示 $Node$ 的左儿子，$\\operatorname{Rson}(Node)$ 表示 $Node$ 的右儿子。\n\n现在可怜手上有一棵 $[1,n]$ 上的线段树，编号为 $1$。这棵线段树上的所有节点的 $tag$ 均为 $0$。接下来可怜进行了 $m$ 次操作，操作有两种：\n\n- $1\\ l\\ r$，假设可怜当前手上有 $t$ 棵线段树，可怜会把每棵线段树复制两份（$tag$ 数组也一起复制），原先编号为 $i$ 的线段树复制得到的两棵编号为 $2i-1$ 与 $2i$，在复制结束后，可怜手上一共有 $2t$ 棵线段树。接着，可怜会对所有编号为奇数的线段树进行一次 $\\operatorname{Modify}(root,1,n,l,r)$。\n\n- $2$，可怜定义一棵线段树的权值为它上面有多少个节点 $tag$ 为 $1$。可怜想要知道她手上所有线段树的权值和是多少。", "inputFormat": "第一行输入两个整数 $n,m$ 表示初始区间长度和操作个数。\n\n接下来 $m$ 行每行描述一个操作，输入保证 $1 \\le l \\le r \\le n$。", "outputFormat": "对于每次询问，输出一行一个整数表示答案，答案可能很大，对 $998244353$ 取模后输出即可。", "hint": "[1,5] 上的线段树如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/pic/55649.png)\n\n在第一次询问时，可怜手上有一棵线段树，它所有点上都没有标记，因此答案为 $0$。\n\n在第二次询问时，可怜手上有两棵线段树，按照编号，它们的标记情况为：\n\n1. 点 $[1,3]$ 上有标记，权值为 $1$。\n2. 没有点有标记，权值为 $0$。\n\n因此答案为 $1$。\n\n在第三次询问时，可怜手上有四棵线段树，按照编号，它们的标记情况为：\n\n1. 点 $[1,2],[3,3],[4,5]$ 上有标记，权值为 $3$。\n2. 点 $[1,3]$ 上有标记，权值为 $1$。\n3. 点 $[3,3],[4,5]$ 上有标记，权值为 $2$。\n4. 没有点有标记，权值为 $0$。\n\n因此答案为 $6$。\n\n|测试点|$n$|$m$|其他约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1000$|$\\le 10$|无|\n|$2$|^|^|^|\n|$3$|^|$\\le 1000$|^|\n|$4$|^|^|^|\n|$5$|$\\le 10^5$|$\\le 10^5$|询问只有一个|\n|$6$|^|^|^|\n|$7$|^|^|^|\n|$8$|^|^|无|\n|$9$|^|^|^|\n|$10$|^|^|^|\n\n对于 $100\\%$ 的数据，$1\\le l\\le r\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Segment Tree", "background": "", "description": "Jiutiao Kelian is a girl who likes data structures. Among common data structures, her favorite is the segment tree.\n\nThe core of a segment tree is lazy propagation. Below is pseudocode for a segment tree with lazy tags, where the array $tag$ is the lazy tag:\n\n![](https://cdn.luogu.com.cn/upload/pic/55648.png)\n\nHere, the function $\\operatorname{Lson}(Node)$ denotes the left child of $Node$, and $\\operatorname{Rson}(Node)$ denotes the right child of $Node$.\n\nNow Kelian has a segment tree over $[1,n]$, with index $1$. All nodes in this segment tree have $tag = 0$. Then Kelian performs $m$ operations. There are two types of operations:\n\n- $1\\ l\\ r$: Suppose Kelian currently has $t$ segment trees. She will copy each segment tree into two copies (the $tag$ array is copied as well). The segment tree originally indexed $i$ becomes two copied trees indexed $2i-1$ and $2i$. After copying, she has $2t$ segment trees in total. Then, she performs $\\operatorname{Modify}(root,1,n,l,r)$ once on every segment tree whose index is odd.\n\n- $2$: Kelian defines the weight of a segment tree as the number of nodes in it whose $tag$ equals $1$. She wants to know the sum of weights of all segment trees she currently has.", "inputFormat": "The first line contains two integers $n,m$, denoting the initial interval length and the number of operations.\n\nEach of the next $m$ lines describes one operation. The input guarantees $1 \\le l \\le r \\le n$.", "outputFormat": "For each query, output one integer per line representing the answer. The answer can be very large, so output it modulo $998244353$.", "hint": "The segment tree over $[1,5]$ is shown below:\n\n![](https://cdn.luogu.com.cn/upload/pic/55649.png)\n\nAt the first query, Kelian has one segment tree, and there are no marks on any node, so the answer is $0$.\n\nAt the second query, Kelian has two segment trees. By their indices, their marked nodes are:\n\n1. Node $[1,3]$ is marked, so the weight is $1$.\n2. No node is marked, so the weight is $0$.\n\nSo the answer is $1$.\n\nAt the third query, Kelian has four segment trees. By their indices, their marked nodes are:\n\n1. Nodes $[1,2],[3,3],[4,5]$ are marked, so the weight is $3$.\n2. Node $[1,3]$ is marked, so the weight is $1$.\n3. Nodes $[3,3],[4,5]$ are marked, so the weight is $2$.\n4. No node is marked, so the weight is $0$.\n\nSo the answer is $6$.\n\n|Test Point|$n$|$m$|Other Constraints|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1000$|$\\le 10$|None|\n|$2$|^|^|^|\n|$3$|^|$\\le 1000$|^|\n|$4$|^|^|^|\n|$5$|$\\le 10^5$|$\\le 10^5$|There is only one query|\n|$6$|^|^|^|\n|$7$|^|^|^|\n|$8$|^|^|None|\n|$9$|^|^|^|\n|$10$|^|^|^|\n\nFor $100\\%$ of the data, $1 \\le l \\le r \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 线段树", "background": null, "description": "九条可怜是一个喜欢数据结构的女孩子，在常见的数据结构中，可怜最喜欢的就是线段树。\n\n线段树的核心是懒标记，下面是一个带懒标记的线段树的伪代码，其中 $tag$ 数组为懒标记：\n\n![](https://cdn.luogu.com.cn/upload/pic/55648.png)\n\n其中函数 $\\operatorname{Lson}(Node)$ 表示 $Node$ 的左儿子，$\\operatorname{Rson}(Node)$ 表示 $Node$ 的右儿子。\n\n现在可怜手上有一棵 $[1,n]$ 上的线段树，编号为 $1$。这棵线段树上的所有节点的 $tag$ 均为 $0$。接下来可怜进行了 $m$ 次操作，操作有两种：\n\n- $1\\ l\\ r$，假设可怜当前手上有 $t$ 棵线段树，可怜会把每棵线段树复制两份（$tag$ 数组也一起复制），原先编号为 $i$ 的线段树复制得到的两棵编号为 $2i-1$ 与 $2i$，在复制结束后，可怜手上一共有 $2t$ 棵线段树。接着，可怜会对所有编号为奇数的线段树进行一次 $\\operatorname{Modify}(root,1,n,l,r)$。\n\n- $2$，可怜定义一棵线段树的权值为它上面有多少个节点 $tag$ 为 $1$。可怜想要知道她手上所有线段树的权值和是多少。", "inputFormat": "第一行输入两个整数 $n,m$ 表示初始区间长度和操作个数。\n\n接下来 $m$ 行每行描述一个操作，输入保证 $1 \\le l \\le r \\le n$。", "outputFormat": "对于每次询问，输出一行一个整数表示答案，答案可能很大，对 $998244353$ 取模后输出即可。", "hint": "[1,5] 上的线段树如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/pic/55649.png)\n\n在第一次询问时，可怜手上有一棵线段树，它所有点上都没有标记，因此答案为 $0$。\n\n在第二次询问时，可怜手上有两棵线段树，按照编号，它们的标记情况为：\n\n1. 点 $[1,3]$ 上有标记，权值为 $1$。\n2. 没有点有标记，权值为 $0$。\n\n因此答案为 $1$。\n\n在第三次询问时，可怜手上有四棵线段树，按照编号，它们的标记情况为：\n\n1. 点 $[1,2],[3,3],[4,5]$ 上有标记，权值为 $3$。\n2. 点 $[1,3]$ 上有标记，权值为 $1$。\n3. 点 $[3,3],[4,5]$ 上有标记，权值为 $2$。\n4. 没有点有标记，权值为 $0$。\n\n因此答案为 $6$。\n\n|测试点|$n$|$m$|其他约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1000$|$\\le 10$|无|\n|$2$|^|^|^|\n|$3$|^|$\\le 1000$|^|\n|$4$|^|^|^|\n|$5$|$\\le 10^5$|$\\le 10^5$|询问只有一个|\n|$6$|^|^|^|\n|$7$|^|^|^|\n|$8$|^|^|无|\n|$9$|^|^|^|\n|$10$|^|^|^|\n\n对于 $100\\%$ 的数据，$1\\le l\\le r\\le n$。", "locale": "zh-CN"}}}
{"pid": "P5281", "type": "P", "difficulty": 7, "samples": [["5 1 5\n1 5\n1 4\n5 3\n5 2", "4 0 1 0 2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] Minimax搜索", "background": "", "description": "九条可怜是一个喜欢玩游戏的女孩子。为了增强自己的游戏水平，她想要用理论的武器武装自己。这道题和著名的 Minimax 搜索有关。\n\n可怜有一棵有根树，根节点编号为 $1$。定义根节点的深度为 $1$，其他节点的深度为它的父亲的深度加一。同时在叶子节点权值给定的情况下，可怜用如下方式定义了每一个非节点的权值：\n- 对于深度为奇数的非叶子节点，它的权值是它所有子节点的权值最大值。\n- 对于深度为偶数的非叶子节点，它的权值是它所有子节点的权值最小值。\n\n最开始，可怜令编号为 $i$ 的叶子节点权值为 i，并计算得到了根节点的权值为 $W$。\n\n现在，邪恶的 Cedyks 想要通过修改某些叶子节点的权值，来让根节点的权值发生改变。Cedyks 设计了一个量子攻击器，在攻击器发动后，Cedyks 会随机获得一个非空的叶子节点集合 $S$ 的控制权，并可以花费一定的能量来修改 $S$ 中的叶子节点的权值。\n\n然而，修改叶子节点的权值也要消耗能量，对于 $S$ 中的叶子节点 $i$，它的初始权值为 $i$，假设 Cedyks 把它的权值修改成了 $w_i$（$w_i$ **可以是任意整数，包括负数**），则 Cedyks 在这次攻击中，需要花费的能量为 $\\max_{i\\in S} |i − w_i|$。\n\nCedyks 想要尽可能节约能量，于是他总是会**以最少的能量来完成攻击**，即在花费的能量最小的情况下，让根节点的权值发生改变。令 $w(S)$ 为 Cedyks 在获得了集合 $S$ 的控制权后，会花费的能量。特殊地，对于某些集合 $S$，可能无论如何改变 $S$ 中叶子节点的权值，根节点的权值都不会发生改变，这时，$w(S)$ 的值被定义为 $n$。为了方便，我们称 $w(S)$ 为 $S$ 的稳定度。\n\n当有 $m$ 个叶子节点的时候，一共有 $2^m − 1$ 种不同的叶子节点的非空集合。在发动攻击前，Cedyks 想要先预估一下自己需要花费的能量。于是他给出了一个区间 $[L, R]$，他想要知道对于每一个 $k \\in [L, R]$，有多少个集合 $S$ 满足 $w(S) = k$。", "inputFormat": "第一行输入三个整数 $n,L,R(n ≥ 2,1 \\leq L \\leq R \\leq n)$。\n\n接下来 $n - 1$ 行每行两个整数 $u,v$，表示树上的一条边。", "outputFormat": "输出一行 $R-L+1$ 个整数，第 $i$ 个整数表示 $w(S)$ 为 $L+i-1$ 的集合 $S$ 有多少个。答案可能会很大，请对 $998244353$ 取模后输出。", "hint": "#### 样例 1 解释\n\n最开始，在可怜的设定下（$i$ 号叶子节点的权值为 $i$），根节点的权值为 $4$。\n\n树上一共有 $3$ 个叶子节点 $\\{2,3,4\\}$，一共有 $7$ 个非空的叶子节点权值，其中：\n\n- $\\{4\\}, \\{2,4\\}, \\{3,4\\}, \\{2,3,4\\}$ 的稳定度为 $1$，只要稍微修改 $4$ 号叶子节点的权值，根节点的权值就会发生改变。\n- $\\{2\\},\\{3\\}$ 的稳定度为 $5$，因为 $5$ 号的权值是 $2,3$ 的较小值，在只修改 $2$ 号或者 $3$ 号的情况下，$5$ 号点的权值始终小于等于 $3$，所以根节点的权值始终为 $4$。\n- $\\{2,3\\}$ 的稳定度为 $3$，要让根节点的权值发生改变，必须让 $5$ 的权值大于 $4$，因此 $w_2 ,w_3$都必须要大于 $4$，所以稳定度为 $3$，一个可行的方案是把 $w_2 ,w_3$ 都设为 $5$。\n\n#### 数据规模与约定\n\n| 测试点 | $n$ | 其他约定 | 测试点 | $n$ | 其他约定 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10$ | $L=R=n$ | $6$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $2$ | $\\le50$ | $L=R=n$ | $7$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $3$ | $\\le50$ | $L=R=n$ | $8$ | $\\le2\\times 10^5$ | 无 |\n| $4$ | $\\le5\\times 10^3$ | $L=R=n$ | $9$ | $\\le2\\times 10^5$ | 无 |\n| $5$ | $\\le5\\times 10^3$ | $L=R=n$ | $10$ | $\\le2\\times 10^5$ | 无 |\n\n对于 $100\\%$ 的数据，保证 $n\\ge2$，$1\\le L \\le R \\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Minimax Search.", "background": "", "description": "Jiutiao Keliansi is a girl who likes playing games. To improve her gaming skills, she wants to arm herself with theory. This problem is related to the famous Minimax search.\n\nKeliansi has a rooted tree with the root numbered $1$. Define the depth of the root as $1$, and the depth of any other node as its parent’s depth plus $1$. Given the values on the leaf nodes, Keliansi defines the value of each non-leaf node as follows:\n- For a non-leaf node at odd depth, its value is the maximum among the values of all its children.\n- For a non-leaf node at even depth, its value is the minimum among the values of all its children.\n\nAt the beginning, Keliansi sets the value of the leaf node numbered $i$ to be $i$, and computes the root’s value as $W$.\n\nNow, the evil Cedyks wants to change the root’s value by modifying the values of some leaf nodes. Cedyks has designed a quantum attacker. After it is activated, Cedyks will randomly gain control of a non-empty set of leaf nodes $S$, and can spend some energy to modify the values of the leaf nodes in $S$.\n\nHowever, modifying leaf node values costs energy. For a leaf node $i \\in S$, its initial value is $i$. Suppose Cedyks changes its value to $w_i$ ($w_i$ **can be any integer, including negative numbers**). Then the energy needed for this attack is $\\max_{i\\in S} |i − w_i|$.\n\nCedyks wants to save as much energy as possible, so he will always **complete the attack with the minimum energy**, i.e. under the minimum energy cost, make the root’s value change. Let $w(S)$ be the energy Cedyks will spend after gaining control of set $S$. In particular, for some sets $S$, no matter how the values of the leaf nodes in $S$ are changed, the root’s value will not change. In this case, $w(S)$ is defined as $n$. For convenience, we call $w(S)$ the stability of $S$.\n\nWhen there are $m$ leaf nodes, there are $2^m − 1$ different non-empty sets of leaf nodes. Before launching the attack, Cedyks wants to estimate the energy he may need. So he gives an interval $[L, R]$, and wants to know, for each $k \\in [L, R]$, how many sets $S$ satisfy $w(S) = k$.", "inputFormat": "The first line contains three integers $n, L, R(n ≥ 2,1 \\leq L \\leq R \\leq n)$.\n\nThe next $n - 1$ lines each contain two integers $u, v$, indicating an edge in the tree.", "outputFormat": "Output one line with $R-L+1$ integers. The $i$-th integer indicates how many sets $S$ have $w(S) = L+i-1$. The answer may be very large; output it modulo $998244353$.", "hint": "#### Explanation of Sample 1\n\nAt the beginning, under Keliansi’s setting (the value of leaf node $i$ is $i$), the root’s value is $4$.\n\nThere are $3$ leaf nodes $\\{2,3,4\\}$ in the tree, and there are $7$ non-empty sets of leaf nodes, among which:\n\n- $\\{4\\}, \\{2,4\\}, \\{3,4\\}, \\{2,3,4\\}$ have stability $1$. As long as you slightly modify the value of leaf node $4$, the root’s value will change.\n- $\\{2\\}, \\{3\\}$ have stability $5$, because the value at node $5$ is the smaller one between $2$ and $3$. If you only modify node $2$ or only modify node $3$, the value at node $5$ is always less than or equal to $3$, so the root’s value is always $4$.\n- $\\{2,3\\}$ has stability $3$. To make the root’s value change, the value at node $5$ must be greater than $4$, so both $w_2$ and $w_3$ must be greater than $4$. Therefore the stability is $3$. One feasible plan is to set both $w_2$ and $w_3$ to $5$.\n\n#### Constraints\n\n| Test Point | $n$ | Other Constraints | Test Point | $n$ | Other Constraints |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10$ | $L=R=n$ | $6$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $2$ | $\\le50$ | $L=R=n$ | $7$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $3$ | $\\le50$ | $L=R=n$ | $8$ | $\\le2\\times 10^5$ | None |\n| $4$ | $\\le5\\times 10^3$ | $L=R=n$ | $9$ | $\\le2\\times 10^5$ | None |\n| $5$ | $\\le5\\times 10^3$ | $L=R=n$ | $10$ | $\\le2\\times 10^5$ | None |\n\nFor all testdata, it is guaranteed that $n\\ge2$, $1\\le L \\le R \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] Minimax搜索", "background": "", "description": "九条可怜是一个喜欢玩游戏的女孩子。为了增强自己的游戏水平，她想要用理论的武器武装自己。这道题和著名的 Minimax 搜索有关。\n\n可怜有一棵有根树，根节点编号为 $1$。定义根节点的深度为 $1$，其他节点的深度为它的父亲的深度加一。同时在叶子节点权值给定的情况下，可怜用如下方式定义了每一个非节点的权值：\n- 对于深度为奇数的非叶子节点，它的权值是它所有子节点的权值最大值。\n- 对于深度为偶数的非叶子节点，它的权值是它所有子节点的权值最小值。\n\n最开始，可怜令编号为 $i$ 的叶子节点权值为 i，并计算得到了根节点的权值为 $W$。\n\n现在，邪恶的 Cedyks 想要通过修改某些叶子节点的权值，来让根节点的权值发生改变。Cedyks 设计了一个量子攻击器，在攻击器发动后，Cedyks 会随机获得一个非空的叶子节点集合 $S$ 的控制权，并可以花费一定的能量来修改 $S$ 中的叶子节点的权值。\n\n然而，修改叶子节点的权值也要消耗能量，对于 $S$ 中的叶子节点 $i$，它的初始权值为 $i$，假设 Cedyks 把它的权值修改成了 $w_i$（$w_i$ **可以是任意整数，包括负数**），则 Cedyks 在这次攻击中，需要花费的能量为 $\\max_{i\\in S} |i − w_i|$。\n\nCedyks 想要尽可能节约能量，于是他总是会**以最少的能量来完成攻击**，即在花费的能量最小的情况下，让根节点的权值发生改变。令 $w(S)$ 为 Cedyks 在获得了集合 $S$ 的控制权后，会花费的能量。特殊地，对于某些集合 $S$，可能无论如何改变 $S$ 中叶子节点的权值，根节点的权值都不会发生改变，这时，$w(S)$ 的值被定义为 $n$。为了方便，我们称 $w(S)$ 为 $S$ 的稳定度。\n\n当有 $m$ 个叶子节点的时候，一共有 $2^m − 1$ 种不同的叶子节点的非空集合。在发动攻击前，Cedyks 想要先预估一下自己需要花费的能量。于是他给出了一个区间 $[L, R]$，他想要知道对于每一个 $k \\in [L, R]$，有多少个集合 $S$ 满足 $w(S) = k$。", "inputFormat": "第一行输入三个整数 $n,L,R(n ≥ 2,1 \\leq L \\leq R \\leq n)$。\n\n接下来 $n - 1$ 行每行两个整数 $u,v$，表示树上的一条边。", "outputFormat": "输出一行 $R-L+1$ 个整数，第 $i$ 个整数表示 $w(S)$ 为 $L+i-1$ 的集合 $S$ 有多少个。答案可能会很大，请对 $998244353$ 取模后输出。", "hint": "#### 样例 1 解释\n\n最开始，在可怜的设定下（$i$ 号叶子节点的权值为 $i$），根节点的权值为 $4$。\n\n树上一共有 $3$ 个叶子节点 $\\{2,3,4\\}$，一共有 $7$ 个非空的叶子节点权值，其中：\n\n- $\\{4\\}, \\{2,4\\}, \\{3,4\\}, \\{2,3,4\\}$ 的稳定度为 $1$，只要稍微修改 $4$ 号叶子节点的权值，根节点的权值就会发生改变。\n- $\\{2\\},\\{3\\}$ 的稳定度为 $5$，因为 $5$ 号的权值是 $2,3$ 的较小值，在只修改 $2$ 号或者 $3$ 号的情况下，$5$ 号点的权值始终小于等于 $3$，所以根节点的权值始终为 $4$。\n- $\\{2,3\\}$ 的稳定度为 $3$，要让根节点的权值发生改变，必须让 $5$ 的权值大于 $4$，因此 $w_2 ,w_3$都必须要大于 $4$，所以稳定度为 $3$，一个可行的方案是把 $w_2 ,w_3$ 都设为 $5$。\n\n#### 数据规模与约定\n\n| 测试点 | $n$ | 其他约定 | 测试点 | $n$ | 其他约定 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10$ | $L=R=n$ | $6$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $2$ | $\\le50$ | $L=R=n$ | $7$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $3$ | $\\le50$ | $L=R=n$ | $8$ | $\\le2\\times 10^5$ | 无 |\n| $4$ | $\\le5\\times 10^3$ | $L=R=n$ | $9$ | $\\le2\\times 10^5$ | 无 |\n| $5$ | $\\le5\\times 10^3$ | $L=R=n$ | $10$ | $\\le2\\times 10^5$ | 无 |\n\n对于 $100\\%$ 的数据，保证 $n\\ge2$，$1\\le L \\le R \\le n$。", "locale": "zh-CN"}}}
{"pid": "P5282", "type": "P", "difficulty": 7, "samples": [["4\n16777216 998244353\n72267859 998244353\n2333333 19260817\n1919810 2147481811", "789885751\n569626621\n16351109\n1416439247"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "倍增", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】快速阶乘算法", "background": "有一天，NaCly_Fish 无意间看到一种高效求阶乘模大质数的算法，但是她太菜，并不会写。  \n于是她就暴力造了数据，请您帮忙写出 std 吧。  \n\n什么，您问为什么不保证模数可以 NTT？  \n那样的话就可能被打表水过，或者答案就爆 int 了。\n\n反正您是神仙，肯定能秒掉这题。", "description": "给你正整数 $n$，和一个质数 $p$，你需要求出：  \n$$ n! \\text{ mod } p$$  \n有 $T$ 组数据。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$  行，每行两个正整数 $n,p$，意义如题目描述。", "outputFormat": "输出 $T$ 行，表示每组数据的答案。", "hint": "### 数据范围：  \n\n对于 $10\\%$ 的数据：$p = 998244353$   \n对于另外 $10\\%$ 的数据：$p = 1004535809$   \n对于 $100\\%$ 的数据：$1\\le n < p \\le 2^{31}-1$，$1 \\le T \\le 5$    \n保证 $p$ 为质数。\n\n【提示】   \n请确保你的算法时间复杂度不高于 $\\Theta(\\sqrt n \\log n)$，时限为 std 的十倍以上。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Fast Factorial Algorithm.", "background": "One day, NaCly_Fish happened to see an efficient algorithm for computing factorial modulo a large prime, but she was too inexperienced to code it.  \nSo she generated testdata by brute force, and asks you to help write the std.\n\nWhat, you ask why it is not guaranteed that the modulus can be used for NTT?  \nIf it were, people might pass by precomputing a table, or the answer might overflow int.\n\nAnyway, you are a genius, so you can surely solve this problem instantly.", "description": "You are given a positive integer $n$ and a prime $p$. You need to compute:  \n$$ n! \\text{ mod } p$$  \nThere are $T$ test cases.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.  \nThe next $T$ lines each contain two positive integers $n, p$, with the meaning described above.", "outputFormat": "Output $T$ lines, each being the answer for one test case.", "hint": "### Constraints:\n\nFor $10\\%$ of the testdata: $p = 998244353$.  \nFor another $10\\%$ of the testdata: $p = 1004535809$.  \nFor $100\\%$ of the testdata: $1 \\le n < p \\le 2^{31}-1$, $1 \\le T \\le 5$.  \nIt is guaranteed that $p$ is prime.\n\n[Hint]  \nPlease make sure your algorithm runs in no more than $\\Theta(\\sqrt n \\log n)$ time complexity. The time limit is more than ten times that of the std.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】快速阶乘算法", "background": "有一天，NaCly_Fish 无意间看到一种高效求阶乘模大质数的算法，但是她太菜，并不会写。  \n于是她就暴力造了数据，请您帮忙写出 std 吧。  \n\n什么，您问为什么不保证模数可以 NTT？  \n那样的话就可能被打表水过，或者答案就爆 int 了。\n\n反正您是神仙，肯定能秒掉这题。", "description": "给你正整数 $n$，和一个质数 $p$，你需要求出：  \n$$ n! \\text{ mod } p$$  \n有 $T$ 组数据。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$  行，每行两个正整数 $n,p$，意义如题目描述。", "outputFormat": "输出 $T$ 行，表示每组数据的答案。", "hint": "### 数据范围：  \n\n对于 $10\\%$ 的数据：$p = 998244353$   \n对于另外 $10\\%$ 的数据：$p = 1004535809$   \n对于 $100\\%$ 的数据：$1\\le n < p \\le 2^{31}-1$，$1 \\le T \\le 5$    \n保证 $p$ 为质数。\n\n【提示】   \n请确保你的算法时间复杂度不高于 $\\Theta(\\sqrt n \\log n)$，时限为 std 的十倍以上。", "locale": "zh-CN"}}}
{"pid": "P5283", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2 3", "6"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2019", "各省省选", "堆", "可持久化", "前缀和", "字典树 Trie"], "title": "[十二省联考 2019] 异或粽子", "background": null, "description": "小粽是一个喜欢吃粽子的好孩子。今天她在家里自己做起了粽子。\n\n小粽面前有 $n$ 种互不相同的粽子馅儿，小粽将它们摆放为了一排，并从左至右编号为 $1$ 到 $n$。第 $i$ 种馅儿具有一个非负整数的属性值 $a_i$。每种馅儿的数量都足够多，即小粽不会因为缺少原料而做不出想要的粽子。小粽准备用这些馅儿来做出 $k$ 个粽子。\n\n小粽的做法是：选两个整数数 $l$,  $r$，满足 $1 \\leqslant l \\leqslant r \\leqslant n$，将编号在 $[l, r]$ 范围内的所有馅儿混合做成一个粽子，所得的粽子的美味度为这些粽子馅儿的属性值的**异或和**。（异或就是我们常说的 xor 运算，即 C/C++ 中的 `ˆ` 运算符或 Pascal 中的 `xor` 运算符）\n\n小粽想品尝不同口味的粽子，因此她不希望用同样的馅儿的集合做出一个以上的粽子。\n\n小粽希望她做出的所有粽子的美味度之和最大。请你帮她求出这个值吧！", "inputFormat": "第一行两个正整数 $n$, $k$，表示馅儿的数量，以及小粽打算做出的粽子的数量。\n\n接下来一行为 $n$ 个非负整数，第 $i$ 个数为 $a_i$，表示第 $i$ 个粽子的属性值。\n对于所有的输入数据都满足：$1 \\leqslant n \\leqslant 5 \\times 10^5$,  $1 \\leqslant k \\leqslant \\min\\left\\{\\frac{n(n-1)}{2},2 \\times 10^{5}\\right\\}$,  $0 \\leqslant a_i \\leqslant 4 294 967 295$。", "outputFormat": "输出一行一个整数，表示小粽可以做出的粽子的美味度之和的最大值。", "hint": "| 测试点 | $n$ | $k$ |\n| :---------- | :---------- | :---------- |\n| $1$, $2$, $3$, $4$, $5$, $6$, $7$, $8$ | $\\leqslant 10^3$ | $\\leqslant 10^3$ |\n| $9$, $10$, $11$, $12$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 10^3$ |\n| $13$, $14$, $15$, $16$ | $\\leqslant 10^3$ | $\\leqslant 2 \\times 10^5$ |\n| $17$, $18$, $19$, $20$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 2 \\times 10^5$ |", "locale": "zh-CN", "translations": {"en": {"title": "[12 Provinces Joint Contest 2019] XOR Zongzi.", "background": "", "description": "Xiao Zong is a good kid who likes eating zongzi. Today, she started making zongzi at home by herself.\n\nThere are $n$ different kinds of zongzi fillings in front of her. She places them in a row and numbers them from left to right as $1$ to $n$. The $i$-th kind of filling has a non-negative integer attribute value $a_i$. Each kind of filling is available in unlimited quantity, so Xiao Zong will not be unable to make zongzi due to lack of ingredients. She plans to use these fillings to make $k$ zongzi.\n\nHer method is: choose two integers $l$ and $r$ such that $1 \\leqslant l \\leqslant r \\leqslant n$, mix all fillings with indices in the range $[l, r]$ to make one zongzi. The tastiness of the resulting zongzi is the **xor sum** of the attribute values of these fillings. (Xor is the operation we usually call xor, i.e. the `ˆ` operator in C/C++ or the `xor` operator in Pascal.)\n\nXiao Zong wants to taste different flavors, so she does not want to make more than one zongzi using the same set of fillings.\n\nShe wants the sum of tastiness of all the zongzi she makes to be as large as possible. Please help her compute this value.", "inputFormat": "The first line contains two positive integers $n$ and $k$, representing the number of fillings and the number of zongzi Xiao Zong plans to make.\n\nThe next line contains $n$ non-negative integers. The $i$-th number is $a_i$, representing the attribute value of the $i$-th filling.\n\nFor all input data: $1 \\leqslant n \\leqslant 5 \\times 10^5$, $1 \\leqslant k \\leqslant \\min\\left\\{\\frac{n(n-1)}{2},2 \\times 10^{5}\\right\\}$, $0 \\leqslant a_i \\leqslant 4 294 967 295$.", "outputFormat": "Output one integer on a single line, representing the maximum possible sum of tastiness of the zongzi Xiao Zong can make.", "hint": "| Test Point | $n$ | $k$ |\n| :---------- | :---------- | :---------- |\n| $1$, $2$, $3$, $4$, $5$, $6$, $7$, $8$ | $\\leqslant 10^3$ | $\\leqslant 10^3$ |\n| $9$, $10$, $11$, $12$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 10^3$ |\n| $13$, $14$, $15$, $16$ | $\\leqslant 10^3$ | $\\leqslant 2 \\times 10^5$ |\n| $17$, $18$, $19$, $20$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 2 \\times 10^5$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 异或粽子", "background": null, "description": "小粽是一个喜欢吃粽子的好孩子。今天她在家里自己做起了粽子。\n\n小粽面前有 $n$ 种互不相同的粽子馅儿，小粽将它们摆放为了一排，并从左至右编号为 $1$ 到 $n$。第 $i$ 种馅儿具有一个非负整数的属性值 $a_i$。每种馅儿的数量都足够多，即小粽不会因为缺少原料而做不出想要的粽子。小粽准备用这些馅儿来做出 $k$ 个粽子。\n\n小粽的做法是：选两个整数数 $l$,  $r$，满足 $1 \\leqslant l \\leqslant r \\leqslant n$，将编号在 $[l, r]$ 范围内的所有馅儿混合做成一个粽子，所得的粽子的美味度为这些粽子馅儿的属性值的**异或和**。（异或就是我们常说的 xor 运算，即 C/C++ 中的 `ˆ` 运算符或 Pascal 中的 `xor` 运算符）\n\n小粽想品尝不同口味的粽子，因此她不希望用同样的馅儿的集合做出一个以上的粽子。\n\n小粽希望她做出的所有粽子的美味度之和最大。请你帮她求出这个值吧！", "inputFormat": "第一行两个正整数 $n$, $k$，表示馅儿的数量，以及小粽打算做出的粽子的数量。\n\n接下来一行为 $n$ 个非负整数，第 $i$ 个数为 $a_i$，表示第 $i$ 个粽子的属性值。\n对于所有的输入数据都满足：$1 \\leqslant n \\leqslant 5 \\times 10^5$,  $1 \\leqslant k \\leqslant \\min\\left\\{\\frac{n(n-1)}{2},2 \\times 10^{5}\\right\\}$,  $0 \\leqslant a_i \\leqslant 4 294 967 295$。", "outputFormat": "输出一行一个整数，表示小粽可以做出的粽子的美味度之和的最大值。", "hint": "| 测试点 | $n$ | $k$ |\n| :---------- | :---------- | :---------- |\n| $1$, $2$, $3$, $4$, $5$, $6$, $7$, $8$ | $\\leqslant 10^3$ | $\\leqslant 10^3$ |\n| $9$, $10$, $11$, $12$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 10^3$ |\n| $13$, $14$, $15$, $16$ | $\\leqslant 10^3$ | $\\leqslant 2 \\times 10^5$ |\n| $17$, $18$, $19$, $20$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 2 \\times 10^5$ |", "locale": "zh-CN"}}}
{"pid": "P5284", "type": "P", "difficulty": 7, "samples": [["3\nabaaaba\n2\n4 7\n1 3\n1\n3 4\n1\n2 1\nabaaaba\n2\n4 7\n1 3\n1\n7 7\n1\n2 1\nabbaabbaab\n4\n1 5\n4 7\n6 9\n8 10\n3\n1 6\n10 10\n4 6\n5\n1 2\n1 3\n2 1\n3 3\n4 1", "7\n-1\n13"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2019", "各省省选", "O2优化"], "title": "[十二省联考 2019] 字符串问题", "background": "Yazid 和 Tiffany 喜欢字符串问题。在这里，我们将给你介绍一些关于字符串的基本概念。\n\n对于一个字符串 $S$ ，我们定义 $|S|$ 表示 $S$ 的长度。\n\n接着，我们定义该串的子串 $S(L, R)$ 表示由 $S$ 中从左往右数，第 $L$ 个字符到第 $R$ 个字符依次连接形成的字符串，特别地，如果 $L < 1$ 或 $R > |S|$ 或 $L > R$，则 $S(L, R)$ 表示空串。\n\n我们说两个字符串相等，当且仅当它们的长度相等，且从左至右各位上的字符依次\n相同。\n\n我们说一个字符串 $T$ 是 $S$ 的前缀，当且仅当 $S(1, |T|) = T$。\n\n两个字符串 $S$, $T$ 相加 $S + T$ 表示的是在 $S$ 后紧挨着写下 $T$ 得到的长度为 $|S| + |T|$ 的字符串。", "description": "现有一个字符串 $S$。\n\nTiffany 将从中划出 $n_a$ 个子串作为 $A$ 类串，第 $i$ 个（$1 \\leqslant i \\leqslant n_a$）为 $A_i = S(la_i, ra_i)$。\n\n类似地，Yazid 将划出 $n_b$ 个子串作为 $B$ 类串，第 $i$ 个（$1 \\leqslant i \\leqslant n_b$）为 $B_i = S(lb_i, rb_i)$。\n\n现额外给定 $m$ 组支配关系，每组支配关系 $(x, y)$ 描述了第 $x$ 个 $A$ 类串**支配** 第 $y$ 个 $B$ 类串。\n\n求一个**长度最大**的目标串 $T$，使得存在一个串 $T$ 的分割 $T = t_1+t_2+· · ·+t_k$（$k \\geqslant 0$）满足：\n- 分割中的每个串 $t_i$ 均为 $A$ 类串：即存在一个与其相等的 $A$ 类串，不妨假设其为 $t_i = A_{id_i}$。\n- 对于分割中所有相邻的串 $t_i, t_{i+1}$（$1 \\leqslant i < k$），都有存在一个$A_{id_i}$ 支配的 $B$ 类串，使得该 $B$ 类串为 $t_{i+1}$ 的前缀。\n\n方便起见，你只需要输出这个最大的长度即可。\n\n特别地，如果存在无限长的目标串（即对于任意一个正整数 $n$，都存在一个满足限制的长度超过 $n$ 的串），请输出 $-1$。", "inputFormat": "单个测试点中包含多组数据，输入的第一行包含一个非负整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n- 第 $1$ 行一个只包含小写字母的字符串 $S$。\n- 第 $2$ 行一个非负整数 $n_a$，表示 $A$ 类串的数目。接下来 $n_a$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中第 $i$ 行的两个数分别为 $la_i$, $ra_i$，描述第 $i$ 个 $A$ 类串。\n  - 保证 $1 \\leqslant la_i \\leqslant ra_i \\leqslant |S|$。\n- 接下来一行一个非负整数 $n_b$，表示 $B$ 类串的数目。接下来 $n_b$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中第 $i$ 行的两个数分别为 $lb_i$, $rb_i$，描述第 $i$ 个 $B$ 类串。\n  - 保证 $1 \\leqslant lb_i \\leqslant rb_i \\leqslant |S|$。\n- 接下来一行一个非负整数 $m$，表示支配关系的组数。接下来 $m$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中每行的两个整数 $x$,  $y$，描述一对 $(x, y)$ 的支配关系，具体意义见\n【题目描述】。\n  - 保证 $1 \\leqslant x \\leqslant n_a$，$1 \\leqslant y \\leqslant n_b$。保证所有支配关系两两不同，即不存在两组支配关系的 $x, $y **均**相同。", "outputFormat": "依次输出每组数据的答案，对于每组数据：\n- 一行一个整数表示最大串长。特别地，如果满足限制的串可以是无限长的，则请\n输出 $-1$。", "hint": "#### 样例一解释\n对于第 $1$ 组数据，$A$ 类串有 $\\texttt{aaba}$ 与 $\\texttt{aba}$，$B$ 类串有 $\\texttt{aa}$，且 $A_2$ 支配 $B_1$。我们可以找到串 $\\texttt{abaaaba}$，它可以拆分成 $A_2 + A_1$，且 $A_1$ 包含由 $A_2$ 所支配的 $B_1$ 作为前缀。可以证明不存在长度更大的满足限制的串。\n\n对于第 $2$ 组数据，与第 $1$ 组数据唯一不同的是，唯一的 $B$ 类串为 $\\texttt{a}$。容易证明存在无限长的满足限制的串。\n\n对于第 $3$ 组数据，容易证明 $\\texttt{abbaabbaaaabb}$ 是最长的满足限制的串。\n\n#### 子任务\n|$n_a$|$n_b$|$\\lvert S\\rvert$|测试点|$m$|$\\lvert A_i\\rvert \\geq \\lvert B_j\\rvert$|其他限制|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$\\leq 100$|$\\leq 100$|$\\leq 10^4$|$1$|$\\leq 10^4$|保证|保证所有 $\\lvert A_i\\rvert,\\lvert B_j\\rvert\\leq 100$|\n|$\\leq 1000$|$\\leq 1000$|$\\leq 2\\times 10^5$|$2\\sim 3$|$\\leq 2\\times 10^5$|保证|无|\n|$=1$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$4$|$=n_b$|保证|无|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$5\\sim 6$|$\\leq 2\\times 10^5$|保证|保证所有 $ra_i +1=la_{i+1}$|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$7\\sim 8$|$\\leq 2\\times 10^5$|保证|无|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$9\\sim 10$|$\\leq 2\\times 10^5$|不保证|无|\n\n为了方便你的阅读，我们把**测试点编号**放在了表格的中间，请你注意这一点。\n\n表格中的 $|A_i| > |B_j|$ 指的是**任意** $B$ 类串的长度不超过**任意** $A$ 类串的长度。\n\n对于所有测试点，保证：$T \\leqslant 100$，且对于测试点内所有数据，$|S|$, $n_a$, $n_b$, $m$ 的**总和**分别不会超过**该测试点中对应**的**单组数据的限制**的 $10$ 倍。比如，对于第 $1$ 组测试点，就有 $\\sum n_a \\leqslant 10 \\times 100 = 1000$ 等。特别地，我们规定对于测试点 $4$，有 $T \\leqslant 10$。\n\n对于所有测试点中的每一组数据，保证：$1 \\leqslant |S| \\leqslant 2 \\times 10^5$，$n_a$, $n_b \\leqslant 2 \\times 10^5$，$m \\leqslant 2 \\times 10^5$\n\n#### 提示\n十二省联考命题组温馨提醒您：\n\n**数据千万条，清空第一条。**\n\n**多测不清空，爆零两行泪。**", "locale": "zh-CN", "translations": {"en": {"title": "[12 Provinces Joint Exam 2019] String Problem", "background": "Yazid and Tiffany like string problems. Here, we will introduce some basic concepts about strings.\n\nFor a string $S$, we define $|S|$ as the length of $S$.\n\nNext, we define the substring $S(L, R)$ as the string formed by concatenating, in order from left to right, the $L$-th character through the $R$-th character of $S$. In particular, if $L < 1$ or $R > |S|$ or $L > R$, then $S(L, R)$ denotes the empty string.\n\nWe say two strings are equal if and only if they have the same length, and their characters are identical at every position from left to right.\n\nWe say a string $T$ is a prefix of $S$ if and only if $S(1, |T|) = T$.\n\nFor two strings $S$ and $T$, their concatenation $S + T$ means writing $T$ immediately after $S$, producing a string of length $|S| + |T|$.", "description": "You are given a string $S$.\n\nTiffany will select $n_a$ substrings as type $A$ strings. The $i$-th one ($1 \\leqslant i \\leqslant n_a$) is $A_i = S(la_i, ra_i)$.\n\nSimilarly, Yazid will select $n_b$ substrings as type $B$ strings. The $i$-th one ($1 \\leqslant i \\leqslant n_b$) is $B_i = S(lb_i, rb_i)$.\n\nAdditionally, you are given $m$ dominance relations. Each relation $(x, y)$ states that the $x$-th type $A$ string **dominates** the $y$-th type $B$ string.\n\nFind a target string $T$ with the **maximum possible length**, such that there exists a partition of $T$ as $T = t_1+t_2+· · ·+t_k$ ($k \\geqslant 0$) satisfying:\n- Every string $t_i$ in the partition is a type $A$ string: that is, there exists a type $A$ string equal to it. WLOG, assume $t_i = A_{id_i}$.\n- For every pair of adjacent strings $t_i, t_{i+1}$ ($1 \\leqslant i < k$), there exists a type $B$ string dominated by $A_{id_i}$, such that this type $B$ string is a prefix of $t_{i+1}$.\n\nFor convenience, you only need to output this maximum length.\n\nIn particular, if there exists an infinitely long target string (that is, for any positive integer $n$, there exists a string satisfying the constraints whose length is greater than $n$), output $-1$.", "inputFormat": "Each test file contains multiple datasets. The first line contains a non-negative integer $T$ indicating the number of datasets. Then each dataset is described as follows:\n- Line $1$: a string $S$ consisting only of lowercase letters.\n- Line $2$: a non-negative integer $n_a$, the number of type $A$ strings. The next $n_a$ lines each contain two integers separated by a space.\n  - In this part, the two integers on line $i$ are $la_i$, $ra_i$, describing the $i$-th type $A$ string.\n  - It is guaranteed that $1 \\leqslant la_i \\leqslant ra_i \\leqslant |S|$.\n- Next line: a non-negative integer $n_b$, the number of type $B$ strings. The next $n_b$ lines each contain two integers separated by a space.\n  - In this part, the two integers on line $i$ are $lb_i$, $rb_i$, describing the $i$-th type $B$ string.\n  - It is guaranteed that $1 \\leqslant lb_i \\leqslant rb_i \\leqslant |S|$.\n- Next line: a non-negative integer $m$, the number of dominance relations. The next $m$ lines each contain two integers separated by a space.\n  - The two integers $x$, $y$ on each line describe a dominance relation $(x, y)$; see 【Description】 for details.\n  - It is guaranteed that $1 \\leqslant x \\leqslant n_a$, $1 \\leqslant y \\leqslant n_b$. All dominance relations are pairwise distinct, i.e., there do not exist two relations with both the same $x$ and the same $y$.", "outputFormat": "Output the answer for each dataset in order. For each dataset:\n- Output one integer per line, the maximum length of such a string. In particular, if a string satisfying the constraints can be infinitely long, output $-1$.", "hint": "#### Explanation of Sample 1\nFor dataset $1$, the type $A$ strings are $\\texttt{aaba}$ and $\\texttt{aba}$, the type $B$ string is $\\texttt{aa}$, and $A_2$ dominates $B_1$. We can find the string $\\texttt{abaaaba}$, which can be split into $A_2 + A_1$, and $A_1$ has $B_1$ (dominated by $A_2$) as a prefix. It can be proven that no longer string satisfying the constraints exists.\n\nFor dataset $2$, the only difference from dataset $1$ is that the only type $B$ string is $\\texttt{a}$. It is easy to prove that an infinitely long string satisfying the constraints exists.\n\nFor dataset $3$, it is easy to prove that $\\texttt{abbaabbaaaabb}$ is the longest string satisfying the constraints.\n\n#### Subtasks\n|$n_a$|$n_b$|$\\lvert S\\rvert$|Test Point|$m$|$\\lvert A_i\\rvert \\geq \\lvert B_j\\rvert$|Other Constraints|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$\\leq 100$|$\\leq 100$|$\\leq 10^4$|$1$|$\\leq 10^4$|Guaranteed|Guaranteed that all $\\lvert A_i\\rvert,\\lvert B_j\\rvert\\leq 100$|\n|$\\leq 1000$|$\\leq 1000$|$\\leq 2\\times 10^5$|$2\\sim 3$|$\\leq 2\\times 10^5$|Guaranteed|None|\n|$=1$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$4$|$=n_b$|Guaranteed|None|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$5\\sim 6$|$\\leq 2\\times 10^5$|Guaranteed|Guaranteed that all $ra_i +1=la_{i+1}$|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$7\\sim 8$|$\\leq 2\\times 10^5$|Guaranteed|None|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$9\\sim 10$|$\\leq 2\\times 10^5$|Not guaranteed|None|\n\nFor easier reading, the **test point numbers** are placed in the middle of the table. Please pay attention to this.\n\nIn the table, $|A_i| > |B_j|$ means that the length of **any** type $B$ string does not exceed the length of **any** type $A$ string.\n\nFor all test points, it is guaranteed that $T \\leqslant 100$, and within each test point, across all datasets, the **totals** of $|S|$, $n_a$, $n_b$, and $m$ will each not exceed $10$ times the per-dataset limit for that test point. For example, for test point $1$, we have $\\sum n_a \\leqslant 10 \\times 100 = 1000$, etc. In particular, for test point $4$, we require $T \\leqslant 10$.\n\nFor every dataset in all test points, it is guaranteed that: $1 \\leqslant |S| \\leqslant 2 \\times 10^5$, $n_a, n_b \\leqslant 2 \\times 10^5$, $m \\leqslant 2 \\times 10^5$.\n\n#### Hint\nA friendly reminder from the 12 Provinces Joint Exam problem setters:\n\n**There are thousands of testdata, clear the first one.**\n\n**If you do not clear between multiple tests, you will get zero points and shed two lines of tears.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 字符串问题", "background": "Yazid 和 Tiffany 喜欢字符串问题。在这里，我们将给你介绍一些关于字符串的基本概念。\n\n对于一个字符串 $S$ ，我们定义 $|S|$ 表示 $S$ 的长度。\n\n接着，我们定义该串的子串 $S(L, R)$ 表示由 $S$ 中从左往右数，第 $L$ 个字符到第 $R$ 个字符依次连接形成的字符串，特别地，如果 $L < 1$ 或 $R > |S|$ 或 $L > R$，则 $S(L, R)$ 表示空串。\n\n我们说两个字符串相等，当且仅当它们的长度相等，且从左至右各位上的字符依次\n相同。\n\n我们说一个字符串 $T$ 是 $S$ 的前缀，当且仅当 $S(1, |T|) = T$。\n\n两个字符串 $S$, $T$ 相加 $S + T$ 表示的是在 $S$ 后紧挨着写下 $T$ 得到的长度为 $|S| + |T|$ 的字符串。", "description": "现有一个字符串 $S$。\n\nTiffany 将从中划出 $n_a$ 个子串作为 $A$ 类串，第 $i$ 个（$1 \\leqslant i \\leqslant n_a$）为 $A_i = S(la_i, ra_i)$。\n\n类似地，Yazid 将划出 $n_b$ 个子串作为 $B$ 类串，第 $i$ 个（$1 \\leqslant i \\leqslant n_b$）为 $B_i = S(lb_i, rb_i)$。\n\n现额外给定 $m$ 组支配关系，每组支配关系 $(x, y)$ 描述了第 $x$ 个 $A$ 类串**支配** 第 $y$ 个 $B$ 类串。\n\n求一个**长度最大**的目标串 $T$，使得存在一个串 $T$ 的分割 $T = t_1+t_2+· · ·+t_k$（$k \\geqslant 0$）满足：\n- 分割中的每个串 $t_i$ 均为 $A$ 类串：即存在一个与其相等的 $A$ 类串，不妨假设其为 $t_i = A_{id_i}$。\n- 对于分割中所有相邻的串 $t_i, t_{i+1}$（$1 \\leqslant i < k$），都有存在一个$A_{id_i}$ 支配的 $B$ 类串，使得该 $B$ 类串为 $t_{i+1}$ 的前缀。\n\n方便起见，你只需要输出这个最大的长度即可。\n\n特别地，如果存在无限长的目标串（即对于任意一个正整数 $n$，都存在一个满足限制的长度超过 $n$ 的串），请输出 $-1$。", "inputFormat": "单个测试点中包含多组数据，输入的第一行包含一个非负整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n- 第 $1$ 行一个只包含小写字母的字符串 $S$。\n- 第 $2$ 行一个非负整数 $n_a$，表示 $A$ 类串的数目。接下来 $n_a$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中第 $i$ 行的两个数分别为 $la_i$, $ra_i$，描述第 $i$ 个 $A$ 类串。\n  - 保证 $1 \\leqslant la_i \\leqslant ra_i \\leqslant |S|$。\n- 接下来一行一个非负整数 $n_b$，表示 $B$ 类串的数目。接下来 $n_b$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中第 $i$ 行的两个数分别为 $lb_i$, $rb_i$，描述第 $i$ 个 $B$ 类串。\n  - 保证 $1 \\leqslant lb_i \\leqslant rb_i \\leqslant |S|$。\n- 接下来一行一个非负整数 $m$，表示支配关系的组数。接下来 $m$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中每行的两个整数 $x$,  $y$，描述一对 $(x, y)$ 的支配关系，具体意义见\n【题目描述】。\n  - 保证 $1 \\leqslant x \\leqslant n_a$，$1 \\leqslant y \\leqslant n_b$。保证所有支配关系两两不同，即不存在两组支配关系的 $x, $y **均**相同。", "outputFormat": "依次输出每组数据的答案，对于每组数据：\n- 一行一个整数表示最大串长。特别地，如果满足限制的串可以是无限长的，则请\n输出 $-1$。", "hint": "#### 样例一解释\n对于第 $1$ 组数据，$A$ 类串有 $\\texttt{aaba}$ 与 $\\texttt{aba}$，$B$ 类串有 $\\texttt{aa}$，且 $A_2$ 支配 $B_1$。我们可以找到串 $\\texttt{abaaaba}$，它可以拆分成 $A_2 + A_1$，且 $A_1$ 包含由 $A_2$ 所支配的 $B_1$ 作为前缀。可以证明不存在长度更大的满足限制的串。\n\n对于第 $2$ 组数据，与第 $1$ 组数据唯一不同的是，唯一的 $B$ 类串为 $\\texttt{a}$。容易证明存在无限长的满足限制的串。\n\n对于第 $3$ 组数据，容易证明 $\\texttt{abbaabbaaaabb}$ 是最长的满足限制的串。\n\n#### 子任务\n|$n_a$|$n_b$|$\\lvert S\\rvert$|测试点|$m$|$\\lvert A_i\\rvert \\geq \\lvert B_j\\rvert$|其他限制|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$\\leq 100$|$\\leq 100$|$\\leq 10^4$|$1$|$\\leq 10^4$|保证|保证所有 $\\lvert A_i\\rvert,\\lvert B_j\\rvert\\leq 100$|\n|$\\leq 1000$|$\\leq 1000$|$\\leq 2\\times 10^5$|$2\\sim 3$|$\\leq 2\\times 10^5$|保证|无|\n|$=1$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$4$|$=n_b$|保证|无|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$5\\sim 6$|$\\leq 2\\times 10^5$|保证|保证所有 $ra_i +1=la_{i+1}$|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$7\\sim 8$|$\\leq 2\\times 10^5$|保证|无|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$9\\sim 10$|$\\leq 2\\times 10^5$|不保证|无|\n\n为了方便你的阅读，我们把**测试点编号**放在了表格的中间，请你注意这一点。\n\n表格中的 $|A_i| > |B_j|$ 指的是**任意** $B$ 类串的长度不超过**任意** $A$ 类串的长度。\n\n对于所有测试点，保证：$T \\leqslant 100$，且对于测试点内所有数据，$|S|$, $n_a$, $n_b$, $m$ 的**总和**分别不会超过**该测试点中对应**的**单组数据的限制**的 $10$ 倍。比如，对于第 $1$ 组测试点，就有 $\\sum n_a \\leqslant 10 \\times 100 = 1000$ 等。特别地，我们规定对于测试点 $4$，有 $T \\leqslant 10$。\n\n对于所有测试点中的每一组数据，保证：$1 \\leqslant |S| \\leqslant 2 \\times 10^5$，$n_a$, $n_b \\leqslant 2 \\times 10^5$，$m \\leqslant 2 \\times 10^5$\n\n#### 提示\n十二省联考命题组温馨提醒您：\n\n**数据千万条，清空第一条。**\n\n**多测不清空，爆零两行泪。**", "locale": "zh-CN"}}}
{"pid": "P5285", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2019", "各省省选", "原根", "数论", "素数判断,质数,筛法"], "title": "[十二省联考 2019] 骗分过样例", "background": "这是一道**传统题**。\n\n“我的程序需要完成什么功能呀？. . . . . . ”\n\n“我也不知道. . . . . . ”\n\n“啊？那我怎么写呀. . . . . . ”\n\n“已经有人给你写好测试了，只要你通过这些测试就可以了. . . . . . ”\n\n“啊？. . . . . . ”\n\n“所有的测试数据都在题目目录下，请做好备份，避免误删！”\n\n“这. . . . . . ”\n\n“哦，我还可以把输入格式告诉你. . . . . . 不过都有完整的数据了，知道输入格式可能也没太大用处吧. . . . . . ”", "description": "题目数据详见附加文件", "inputFormat": "第一行输入一个字符串，表示需要运行的软件功能编号。两个编号越相似，说明对\n应的两个功能的算法越接近。\n\n接下来根据功能的不同，可能有任意长度的输入，详见每个功能的文档。", "outputFormat": "详见每个功能的文档。", "hint": "#### 子任务\n“‘每个功能的文档’在哪里呀？”\n\n“我也没有，就像我没有题目描述一样. . . . . . ”\n\n“好吧. . . . . . 那我是不是打表就可以了呀. . . . . . ”\n\n“**代码长度限制是 $\\bold{102400}$ 字节** （$100$KB），直接打肯定是不行的！不过，需要的话倒是可以稍微打一些小的表. . . . . . ”\n\n“唔. . . . . . ”\n\n“另外，我们会给你的程序对于每个测试点分别评分，求和后得到总分。按照传统\n的规矩，每个测试点正确得满分，错误得 $0$ 分。**每个测试点的分值不全相同，测试点的分值、顺序与难度没有必然联系** 。”\n\n| 测试点 | 功能编号 | 分值 |\n| :-------: | :-------: | :-------: |\n| $1$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $2$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $3$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $4$ | $\\texttt{1?}$ | $7$ |\n| $5$ | $\\texttt{1?+}$ | $9$ |\n| $6$ | $\\texttt{1wa\\_998244353}$ | $6$ |\n| $7$ | $\\texttt{1wa\\_998244353}$ | $7$ |\n| $8$ | $\\texttt{2p}$ | $4$ |\n| $9$ | $\\texttt{2p}$ | $6$ |\n| $10$ | $\\texttt{2p}$ | $8$ |\n| $11$ | $\\texttt{2u}$ | $5$ |\n| $12$ | $\\texttt{2u}$ | $6$ |\n| $13$ | $\\texttt{2u}$ | $9$ |\n| $14$ | $\\texttt{2g}$ | $5$ |\n| $15$ | $\\texttt{2g}$ | $7$ |\n| $16$ | $\\texttt{2g?}$ | $9$ |\n\n\n#### 提示\n在你使用 C/C++ 的 `int` 类型时，如果发生了溢出，比较可能的情况是按照模 $2^{32}$ 同余的前提下，在 `int` 范围内取一个合理的值。例如在计算 $2147483647 + 2$ 时，较有可能会得到 $-2147483647$。\n\n然而，C/C++ 标准将这种情况归类为“未定义行为”。当你的程序试图计算会溢\n出的 `int` 运算时，除了上述结果外，编译器还可能会让你的程序在此时计算出错误结果、死循环、运行错误等，这也是符合 C/C++ 标准的。\n\n如果你的程序希望利用 `int` 的自然溢出的特性，请转换为 `unsigned` 类型运算。例如将 `a + b` 改写为 `(int) ((unsigned) a + (unsigned) b)`，以避免出现不预期的错误。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Twelve Provinces Joint Exam 2019] Cheating to Pass the Samples", "background": "This is a **traditional problem**.\n\n“What function does my program need to implement?...”\n\n“I don’t know either...”\n\n“Huh? Then how am I supposed to write it?...”\n\n“Someone has already written the tests for you. As long as you pass these tests, you will be fine...”\n\n“Huh?...”\n\n“All the testdata are in the problem directory. Please make backups to avoid accidental deletion!”\n\n“This...”\n\n“Oh, I can also tell you the input format... but since the data are complete anyway, knowing the input format may not be very useful...”", "description": "The problem data are provided in the attached files.", "inputFormat": "The first line contains a string, indicating the function ID of the software feature that needs to be run. The more similar two IDs are, the closer the algorithms for the corresponding two functions are.\n\nThen, depending on the function, there may be input of any length. See the documentation for each function for details.", "outputFormat": "See the documentation for each function for details.", "hint": "#### Subtasks\n\n“Where is the ‘documentation for each function’?”\n\n“I don’t have it either, just like I don’t have a problem statement...”\n\n“Alright... then can I just hardcode a table?...”\n\n“**The code length limit is $\\bold{102400}$ bytes** ($100$KB). You definitely can’t hardcode everything! However, if needed, you may hardcode some small tables...”\n\n“Um...”\n\n“Also, we will score your program separately for each test point, and sum them up to get the total score. By tradition, each test point gives full marks if correct, and $0$ points if wrong. **The points of each test point are not all the same, and the points, order, and difficulty of test points have no necessary relationship**.”\n\n| Test Point | Function ID | Points |\n| :-------: | :-------: | :-------: |\n| $1$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $2$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $3$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $4$ | $\\texttt{1?}$ | $7$ |\n| $5$ | $\\texttt{1?+}$ | $9$ |\n| $6$ | $\\texttt{1wa\\_998244353}$ | $6$ |\n| $7$ | $\\texttt{1wa\\_998244353}$ | $7$ |\n| $8$ | $\\texttt{2p}$ | $4$ |\n| $9$ | $\\texttt{2p}$ | $6$ |\n| $10$ | $\\texttt{2p}$ | $8$ |\n| $11$ | $\\texttt{2u}$ | $5$ |\n| $12$ | $\\texttt{2u}$ | $6$ |\n| $13$ | $\\texttt{2u}$ | $9$ |\n| $14$ | $\\texttt{2g}$ | $5$ |\n| $15$ | $\\texttt{2g}$ | $7$ |\n| $16$ | $\\texttt{2g?}$ | $9$ |\n\n#### Hint\n\nWhen you use the `int` type in C/C++, if an overflow occurs, a likely situation is that under the assumption of congruence modulo $2^{32}$, a reasonable value within the `int` range is taken. For example, when computing $2147483647 + 2$, it is quite likely to get $-2147483647$.\n\nHowever, the C/C++ standard classifies this situation as “undefined behavior”. When your program tries to evaluate an `int` operation that would overflow, besides the result above, the compiler may also make your program produce an incorrect result, enter an infinite loop, crash at runtime, etc. All of these are compliant with the C/C++ standard.\n\nIf your program wants to make use of the natural overflow behavior of `int`, please switch to `unsigned` operations. For example, rewrite `a + b` as `(int) ((unsigned) a + (unsigned) b)`, to avoid unexpected errors.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 骗分过样例", "background": "这是一道**传统题**。\n\n“我的程序需要完成什么功能呀？. . . . . . ”\n\n“我也不知道. . . . . . ”\n\n“啊？那我怎么写呀. . . . . . ”\n\n“已经有人给你写好测试了，只要你通过这些测试就可以了. . . . . . ”\n\n“啊？. . . . . . ”\n\n“所有的测试数据都在题目目录下，请做好备份，避免误删！”\n\n“这. . . . . . ”\n\n“哦，我还可以把输入格式告诉你. . . . . . 不过都有完整的数据了，知道输入格式可能也没太大用处吧. . . . . . ”", "description": "题目数据详见附加文件", "inputFormat": "第一行输入一个字符串，表示需要运行的软件功能编号。两个编号越相似，说明对\n应的两个功能的算法越接近。\n\n接下来根据功能的不同，可能有任意长度的输入，详见每个功能的文档。", "outputFormat": "详见每个功能的文档。", "hint": "#### 子任务\n“‘每个功能的文档’在哪里呀？”\n\n“我也没有，就像我没有题目描述一样. . . . . . ”\n\n“好吧. . . . . . 那我是不是打表就可以了呀. . . . . . ”\n\n“**代码长度限制是 $\\bold{102400}$ 字节** （$100$KB），直接打肯定是不行的！不过，需要的话倒是可以稍微打一些小的表. . . . . . ”\n\n“唔. . . . . . ”\n\n“另外，我们会给你的程序对于每个测试点分别评分，求和后得到总分。按照传统\n的规矩，每个测试点正确得满分，错误得 $0$ 分。**每个测试点的分值不全相同，测试点的分值、顺序与难度没有必然联系** 。”\n\n| 测试点 | 功能编号 | 分值 |\n| :-------: | :-------: | :-------: |\n| $1$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $2$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $3$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $4$ | $\\texttt{1?}$ | $7$ |\n| $5$ | $\\texttt{1?+}$ | $9$ |\n| $6$ | $\\texttt{1wa\\_998244353}$ | $6$ |\n| $7$ | $\\texttt{1wa\\_998244353}$ | $7$ |\n| $8$ | $\\texttt{2p}$ | $4$ |\n| $9$ | $\\texttt{2p}$ | $6$ |\n| $10$ | $\\texttt{2p}$ | $8$ |\n| $11$ | $\\texttt{2u}$ | $5$ |\n| $12$ | $\\texttt{2u}$ | $6$ |\n| $13$ | $\\texttt{2u}$ | $9$ |\n| $14$ | $\\texttt{2g}$ | $5$ |\n| $15$ | $\\texttt{2g}$ | $7$ |\n| $16$ | $\\texttt{2g?}$ | $9$ |\n\n\n#### 提示\n在你使用 C/C++ 的 `int` 类型时，如果发生了溢出，比较可能的情况是按照模 $2^{32}$ 同余的前提下，在 `int` 范围内取一个合理的值。例如在计算 $2147483647 + 2$ 时，较有可能会得到 $-2147483647$。\n\n然而，C/C++ 标准将这种情况归类为“未定义行为”。当你的程序试图计算会溢\n出的 `int` 运算时，除了上述结果外，编译器还可能会让你的程序在此时计算出错误结果、死循环、运行错误等，这也是符合 C/C++ 标准的。\n\n如果你的程序希望利用 `int` 的自然溢出的特性，请转换为 `unsigned` 类型运算。例如将 `a + b` 改写为 `(int) ((unsigned) a + (unsigned) b)`，以避免出现不预期的错误。\n", "locale": "zh-CN"}}}
{"pid": "P5286", "type": "P", "difficulty": 7, "samples": [["8\n-2 0\n-1 0\n0 1\n0 -1\n1 0\n2 0\n3 1\n3 -1", "16"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] 鱼", "background": "$\\text{\\color{white}本题数据听说没问题？}$", "description": "在平面坐标系上给定$n$个不同的整点（也即横坐标与纵坐标皆为整数的点）。我们称从这$n$个点中选择6个不同的点所组成的有序六元组$(A,B,C,D,E,F)$是一条“鱼”，当且仅当：$AB=AC,BD=CD,DE=DF$（身形要对称），并且$\\angle BAD,\\angle BDA$ 与$\\angle CAD,\\angle CDA$都是锐角（脑袋和屁股显然不能是凹的），$\\angle ADE,\\angle ADF$ 大于$90^\\circ$（也即为钝角或平角，为了使尾巴不至于翘那么别扭）。\n\n下图就是一个合法的鱼的例子：\n\n![](https://cdn.luogu.com.cn/upload/pic/56001.png)\n\n其中点的组成相同，但顺序不同的鱼视为不同的鱼，即$(A,B,C,D,E,F)$和$(A,C,B,D,E,F)$视为不同的两条鱼（毕竟鱼也有背和肚子的两面），同理$(A,B,C,D,E,F)$和$(A,B,C,D,F,E)$也可以视为不同的两条鱼（假设鱼尾巴可以打结）。\n\n问给定的$n$个点可以构成多少条鱼。特别的，数据保证$n$个点互不重复。\n", "inputFormat": "第一行一个正整数$n$，代表平面上点的个数。\n\n接下来$n$行每行两个整数$x,y$，代表点的横纵坐标。", "outputFormat": "输出一行一个非负整数，代表鱼的个数。", "hint": "对于前 20%的数据，保证$n \\leq 10,|x|,|y| \\leq 5$\n\n对于前 40%的数据，保证$n \\leq 300$，$0 \\leq |x|,|y| \\leq 10^5$。\n\n对于另外 20%的数据，保证$|x|,|y| \\leq 20$。\n\n对于所有数据，保证$6 \\leq n \\leq 1000$，$0 \\leq |x|, |y| \\leq 10^9$，$n$个点互不重复。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] Fish", "background": "$\\text{\\color{white}It is said that the testdata for this problem has no issues?}$", "description": "On the plane coordinate system, you are given $n$ distinct lattice points (that is, points whose $x$- and $y$-coordinates are both integers). We call an ordered 6-tuple $(A,B,C,D,E,F)$ formed by choosing 6 different points among these $n$ points a “fish” if and only if: $AB=AC$, $BD=CD$, and $DE=DF$ (the body must be symmetric), and both $\\angle BAD,\\angle BDA$ and $\\angle CAD,\\angle CDA$ are acute angles (the head and the tail obviously cannot be concave), and $\\angle ADE,\\angle ADF$ are greater than $90^\\circ$ (that is, obtuse angles or straight angles, so that the tail will not stick up awkwardly).\n\nThe figure below shows an example of a valid fish:\n\n![](https://cdn.luogu.com.cn/upload/pic/56001.png)\n\nFish that consist of the same set of points but in different orders are considered different fish. For example, $(A,B,C,D,E,F)$ and $(A,C,B,D,E,F)$ are considered two different fish (after all, a fish has a back and a belly). Similarly, $(A,B,C,D,E,F)$ and $(A,B,C,D,F,E)$ are also considered two different fish (suppose the fish tail can be tied into a knot).\n\nGiven the $n$ points, find how many fish can be formed. In particular, the input guarantees that all $n$ points are pairwise distinct.", "inputFormat": "The first line contains a positive integer $n$, representing the number of points on the plane.\n\nThe next $n$ lines each contain two integers $x,y$, representing the coordinates of a point.", "outputFormat": "Output one line with a non-negative integer, representing the number of fish.", "hint": "For the first 20% of the data, it is guaranteed that $n \\leq 10,|x|,|y| \\leq 5$.\n\nFor the first 40% of the data, it is guaranteed that $n \\leq 300$, $0 \\leq |x|,|y| \\leq 10^5$.\n\nFor another 20% of the data, it is guaranteed that $|x|,|y| \\leq 20$.\n\nFor all data, it is guaranteed that $6 \\leq n \\leq 1000$, $0 \\leq |x|, |y| \\leq 10^9$, and the $n$ points are pairwise distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 鱼", "background": "$\\text{\\color{white}本题数据听说没问题？}$", "description": "在平面坐标系上给定$n$个不同的整点（也即横坐标与纵坐标皆为整数的点）。我们称从这$n$个点中选择6个不同的点所组成的有序六元组$(A,B,C,D,E,F)$是一条“鱼”，当且仅当：$AB=AC,BD=CD,DE=DF$（身形要对称），并且$\\angle BAD,\\angle BDA$ 与$\\angle CAD,\\angle CDA$都是锐角（脑袋和屁股显然不能是凹的），$\\angle ADE,\\angle ADF$ 大于$90^\\circ$（也即为钝角或平角，为了使尾巴不至于翘那么别扭）。\n\n下图就是一个合法的鱼的例子：\n\n![](https://cdn.luogu.com.cn/upload/pic/56001.png)\n\n其中点的组成相同，但顺序不同的鱼视为不同的鱼，即$(A,B,C,D,E,F)$和$(A,C,B,D,E,F)$视为不同的两条鱼（毕竟鱼也有背和肚子的两面），同理$(A,B,C,D,E,F)$和$(A,B,C,D,F,E)$也可以视为不同的两条鱼（假设鱼尾巴可以打结）。\n\n问给定的$n$个点可以构成多少条鱼。特别的，数据保证$n$个点互不重复。\n", "inputFormat": "第一行一个正整数$n$，代表平面上点的个数。\n\n接下来$n$行每行两个整数$x,y$，代表点的横纵坐标。", "outputFormat": "输出一行一个非负整数，代表鱼的个数。", "hint": "对于前 20%的数据，保证$n \\leq 10,|x|,|y| \\leq 5$\n\n对于前 40%的数据，保证$n \\leq 300$，$0 \\leq |x|,|y| \\leq 10^5$。\n\n对于另外 20%的数据，保证$|x|,|y| \\leq 20$。\n\n对于所有数据，保证$6 \\leq n \\leq 1000$，$0 \\leq |x|, |y| \\leq 10^9$，$n$个点互不重复。\n", "locale": "zh-CN"}}}
{"pid": "P5287", "type": "P", "difficulty": 7, "samples": [["11\n1 2 a\n1 3 b\n1 2 a\n1 1 b\n2 2\n1 3 a\n1 2 b\n2 6\n2 5\n1 7 a\n1 5 c\n", "1\n1\n4\n7\n1\n6\n13\n6\n1\n14\n14\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] JOJO", "background": "JOJO 的奇幻冒险是一部非常火的漫画。漫画中的男主角经常喜欢连续喊很多的 “欧拉” 或者 “木大”。", "description": "为了防止字太多挡住漫画内容，现在打算在新的漫画中用 $x$ 欧拉或者 $x$ 木大表示有 $x$ 个欧拉或者木大。\n\n为了简化内容我们现在用字母表示喊出的话。\n\n我们用数字和字母来表示一个串，例如 `2 a 3 b` 表示的串就是 $aabbb$。\n\n一开始漫画中什么话都没有，接下来你需要依次实现 $n$ 个操作，总共只有 $2$ 种操作：\n\n- 第一种：`1 x c` 在当前漫画中加入 $x$ 个 $c$，表示在当前串末尾加入 $x$ 个 $c$ 字符。保证当前串是空串或者串尾字符不是 $c$。\n- 第二种：`2 x` 觉得漫画没画好将漫画还原到第 $x$ 次操作以后的样子，表示将串复原到第 $x$ 次操作后的样子，如果 $x=0$ 则是将串变成空串。\n\n如果当前串是 $bbaabbb$，第 $4$ 次操作后串是 $bb$，则 `2 4` 会使 $bbaabbb$ 变成 $bb$，保证 $x$ 小于当前操作数。\n\n众所周知空条承太郎十分聪明，现在迪奥已经被打败了，他开始考虑自己的漫画中的一些问题：\n\n对于一个串的每个前缀 $A$，都有一个最长的比它短的前缀 $B$ 与前缀 $A$ 的一个后缀匹配，设这个最长的前缀 $B$ 的长度为 $L$。$L$ 为 $0$ 时意味着 $B$ 是一个空串。\n\n每一次操作后，你都需要将当前的串的所有前缀的 $L$ 求和并对 $998244353$ 取模输出告诉空条承太郎，好和他的白金之星算出的答案对比。\n\n比如 $bbaaabba$ 的 $L$ 分别是 $0, 1, 0, 0, 0, 1, 2, 3$，所以对于这个串的答案就是 $7$。\n", "inputFormat": "第一行包括一个正整数 $n$，表示操作数量。\n\n接下来 $n$ 行每行包含一个操作，操作格式如题面所示，例如\n\n- `1 x c`\n- `2 x`\n\n保证数据合法。", "outputFormat": "输出文件仅包含 $n$ 行，第 $i$ 行一个整数，表示 $i$ 个操作之后串的答案。", "hint": "#### 样例解释\n\n| 操作 | 此时的串 | 答案 |\n| :----------: | :----------: | :----------: |\n| $1$ | `aa` | $0+1=1$ |\n| $2$ | `aabbb` | $0+1+0+0+0=1$ |\n| $3$ | `aabbbaa` | $0+1+0+0+0+1+2=4$ |\n| $4$ | `aabbbaab` | $0+1+0+0+0+1+2+3=7$ |\n| $5$ | `aabbb` | $0+1+0+0+0=1$ |\n| $6$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $7$ | `aabbbaaabb` | $0+1+0+0+0+1+2+2+3+4=13$ |\n| $8$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $9$ | `aabbb` | $0+1+0+0+0=1$ |\n| $10$ | `aabbbaaaaaaa` | $0+1+0+0+0+1+2+2+2+2+2+2=14$ |\n| $11$ | `aabbbaaaaaaaccccc` | $0+1+0+0+0+1+2+2+2+2+2+2+0+0+0+0+0=14$ |\n\n#### 数据范围\n\n$20\\%$ 的数据满足 $n\\leq 300$ 且每个 $1$ 操作中的 $x\\leq 300$；\n\n另有 $30\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且每个 $1$ 操作中的 $x=1$；\n\n另有 $30\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且不含 $2$ 操作；\n\n$100\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且每个 $1$ 操作中的 $x\\leq 10 ^ 4$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] JOJO", "background": "JoJo's Bizarre Adventure is a very popular manga. The main character in the manga often likes to shout many consecutive “Ora” or “Muda”.", "description": "To prevent too many words from blocking the manga content, the new manga plans to use $x$ Ora or $x$ Muda to represent that there are $x$ occurrences of Ora or Muda.\n\nTo simplify the content, we now use letters to represent the shouted words.\n\nWe use numbers and letters to represent a string. For example, `2 a 3 b` represents the string $aabbb$.\n\nAt the beginning, there is no text in the manga. Next, you need to perform $n$ operations in order. There are only $2$ types of operations in total:\n\n- The first type: `1 x c` adds $x$ copies of $c$ to the current manga, meaning appending $x$ characters $c$ to the end of the current string. It is guaranteed that the current string is empty, or the last character of the string is not $c$.\n- The second type: `2 x` thinks the manga was not drawn well and restores it to the state after the $x$-th operation, meaning restoring the string to the state after the $x$-th operation. If $x=0$, the string becomes the empty string.\n\nIf the current string is $bbaabbb$, and after the $4$-th operation the string is $bb$, then `2 4` will change $bbaabbb$ into $bb$. It is guaranteed that $x$ is less than the current operation index.\n\nAs everyone knows, Jotaro Kujo is very smart. Now that Dio has been defeated, he starts thinking about some problems in his manga:\n\nFor each prefix $A$ of a string, there is a longest prefix $B$ that is shorter than it and matches a suffix of prefix $A$. Let the length of this longest prefix $B$ be $L$. When $L$ is $0$, it means $B$ is an empty string.\n\nAfter each operation, you need to compute the sum of $L$ over all prefixes of the current string, take it modulo $998244353$, and output it to tell Jotaro Kujo, so that he can compare it with the answer computed by his Star Platinum.\n\nFor example, for $bbaaabba$, the values of $L$ are $0, 1, 0, 0, 0, 1, 2, 3$, so the answer for this string is $7$.", "inputFormat": "The first line contains a positive integer $n$, representing the number of operations.\n\nThe next $n$ lines each contain one operation. The operation formats are as described in the statement, for example:\n\n- `1 x c`\n- `2 x`\n\nIt is guaranteed that the input is valid.", "outputFormat": "The output contains exactly $n$ lines. The $i$-th line contains one integer, representing the answer after the first $i$ operations.", "hint": "#### Sample Explanation\n\n| Operation | Current string | Answer |\n| :----------: | :----------: | :----------: |\n| $1$ | `aa` | $0+1=1$ |\n| $2$ | `aabbb` | $0+1+0+0+0=1$ |\n| $3$ | `aabbbaa` | $0+1+0+0+0+1+2=4$ |\n| $4$ | `aabbbaab` | $0+1+0+0+0+1+2+3=7$ |\n| $5$ | `aabbb` | $0+1+0+0+0=1$ |\n| $6$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $7$ | `aabbbaaabb` | $0+1+0+0+0+1+2+2+3+4=13$ |\n| $8$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $9$ | `aabbb` | $0+1+0+0+0=1$ |\n| $10$ | `aabbbaaaaaaa` | $0+1+0+0+0+1+2+2+2+2+2+2=14$ |\n| $11$ | `aabbbaaaaaaaccccc` | $0+1+0+0+0+1+2+2+2+2+2+2+0+0+0+0+0=14$ |\n\n#### Constraints\n\n$20\\%$ of the testdata satisfies $n\\leq 300$ and for each operation of type $1$, $x\\leq 300$.\n\nAnother $30\\%$ of the testdata satisfies $n\\leq 10 ^ 5$ and for each operation of type $1$, $x=1$.\n\nAnother $30\\%$ of the testdata satisfies $n\\leq 10 ^ 5$ and contains no operation of type $2$.\n\n$100\\%$ of the testdata satisfies $n\\leq 10 ^ 5$ and for each operation of type $1$, $x\\leq 10 ^ 4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] JOJO", "background": "JOJO 的奇幻冒险是一部非常火的漫画。漫画中的男主角经常喜欢连续喊很多的 “欧拉” 或者 “木大”。", "description": "为了防止字太多挡住漫画内容，现在打算在新的漫画中用 $x$ 欧拉或者 $x$ 木大表示有 $x$ 个欧拉或者木大。\n\n为了简化内容我们现在用字母表示喊出的话。\n\n我们用数字和字母来表示一个串，例如 `2 a 3 b` 表示的串就是 $aabbb$。\n\n一开始漫画中什么话都没有，接下来你需要依次实现 $n$ 个操作，总共只有 $2$ 种操作：\n\n- 第一种：`1 x c` 在当前漫画中加入 $x$ 个 $c$，表示在当前串末尾加入 $x$ 个 $c$ 字符。保证当前串是空串或者串尾字符不是 $c$。\n- 第二种：`2 x` 觉得漫画没画好将漫画还原到第 $x$ 次操作以后的样子，表示将串复原到第 $x$ 次操作后的样子，如果 $x=0$ 则是将串变成空串。\n\n如果当前串是 $bbaabbb$，第 $4$ 次操作后串是 $bb$，则 `2 4` 会使 $bbaabbb$ 变成 $bb$，保证 $x$ 小于当前操作数。\n\n众所周知空条承太郎十分聪明，现在迪奥已经被打败了，他开始考虑自己的漫画中的一些问题：\n\n对于一个串的每个前缀 $A$，都有一个最长的比它短的前缀 $B$ 与前缀 $A$ 的一个后缀匹配，设这个最长的前缀 $B$ 的长度为 $L$。$L$ 为 $0$ 时意味着 $B$ 是一个空串。\n\n每一次操作后，你都需要将当前的串的所有前缀的 $L$ 求和并对 $998244353$ 取模输出告诉空条承太郎，好和他的白金之星算出的答案对比。\n\n比如 $bbaaabba$ 的 $L$ 分别是 $0, 1, 0, 0, 0, 1, 2, 3$，所以对于这个串的答案就是 $7$。\n", "inputFormat": "第一行包括一个正整数 $n$，表示操作数量。\n\n接下来 $n$ 行每行包含一个操作，操作格式如题面所示，例如\n\n- `1 x c`\n- `2 x`\n\n保证数据合法。", "outputFormat": "输出文件仅包含 $n$ 行，第 $i$ 行一个整数，表示 $i$ 个操作之后串的答案。", "hint": "#### 样例解释\n\n| 操作 | 此时的串 | 答案 |\n| :----------: | :----------: | :----------: |\n| $1$ | `aa` | $0+1=1$ |\n| $2$ | `aabbb` | $0+1+0+0+0=1$ |\n| $3$ | `aabbbaa` | $0+1+0+0+0+1+2=4$ |\n| $4$ | `aabbbaab` | $0+1+0+0+0+1+2+3=7$ |\n| $5$ | `aabbb` | $0+1+0+0+0=1$ |\n| $6$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $7$ | `aabbbaaabb` | $0+1+0+0+0+1+2+2+3+4=13$ |\n| $8$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $9$ | `aabbb` | $0+1+0+0+0=1$ |\n| $10$ | `aabbbaaaaaaa` | $0+1+0+0+0+1+2+2+2+2+2+2=14$ |\n| $11$ | `aabbbaaaaaaaccccc` | $0+1+0+0+0+1+2+2+2+2+2+2+0+0+0+0+0=14$ |\n\n#### 数据范围\n\n$20\\%$ 的数据满足 $n\\leq 300$ 且每个 $1$ 操作中的 $x\\leq 300$；\n\n另有 $30\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且每个 $1$ 操作中的 $x=1$；\n\n另有 $30\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且不含 $2$ 操作；\n\n$100\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且每个 $1$ 操作中的 $x\\leq 10 ^ 4$。", "locale": "zh-CN"}}}
{"pid": "P5288", "type": "P", "difficulty": 7, "samples": [["1\n6\n1 3\n1 5\n3 5\n1\n1 3", "3 2\n3 1\n"], ["1\n12\n1 10\n1 6\n1 3\n3 6\n3 5\n6 10\n6 8\n8 10\n10 12\n4\n1 10\n1 3\n6 8\n1 6", "8 210\n7 210\n8 70\n8 105\n8 140"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] 多边形", "background": null, "description": "小 R 与小 W 在玩游戏。\n\n他们有一个边数为 $n$ 的凸多边形，其顶点沿逆时针方向标号依次为 $1,2,3,\\cdots , n$。最开始凸多边形中有 $n$ 条线段，即多边形的 $n$ 条边。这里我们用一个有序数对 $(a, b)$（其中 $a < b$）来表示一条端点分别为顶点 $a,b$ 的线段。\n\n在游戏开始之前，小 W 会进行一些操作。每次操作时，他会选中多边形的两个互异顶点，给它们之间连一条线段，并且所连的线段不会与已存的线段重合、相交（只拥有一个公共端点不算作相交）。\n\n他会不断重复这个过程，直到无法继续连线，这样得到了状态 $s_0$。$s_0$ 包含的线段为凸多边形的边与小 W 连上的线段，容易发现这些线段将多边形划分为一个个三角形区域。对于其中任意一个三角形，其三个顶点为 $i,j,k(i < j < k)$，我们可以给这个三角形一个标号 $j$，这样一来每个三角形都被标上了 $2,3, \\cdots , n - 1$ 中的一个，且没有标号相同的两个三角形。\n\n小 W 定义了一种“旋转”操作：对于当前状态，选定 $4$ 个顶点 $a,b,c,d$，使其满足 $1 \\leq a < b < c <d \\leq n$ 且它们两两之间共有 $5$ 条线段——$(a,b), (b,c), (c,d), (a,d), (a,c)$，然后删去线段 $(a,c)$，并连上线段 $(b,d)$。那么用有序数对 $(a,c)$ 即可唯一表示该次“旋转”。我们称这次旋转为 $(a,c)$ “旋转”。显然每次进行完“旋转”操作后多边形中依然不存在相交的线段。\n\n当小 W 将一个状态作为游戏初始状态展示给小 R 后，游戏开始。游戏过程中，小 R 每次可以对当前的状态进行“旋转”。在进行有限次“旋转”之后，小 R 一定会得到一个状态，此时无法继续进行“旋转”操作，游戏结束。那么将每一次“旋转”所对应的有序数对按操作顺序写下，得到的序列即为该轮游戏的操作方案。\n\n为了加大难度，小 W 以 $s_0$ 为基础，产生了 $m$ 个新状态。其中第 $i$ 个状态 $s_i$ 为对 $s_0$ 进行一次“旋转”操作后得到的状态。你需要帮助小 R 求出分别以 $s_0,s_1\\cdots s_n$ 作为游戏初始状态时，小 R 完成游戏所用的最少“旋转”次数，并根据小 W 的心情，有时还需求出“旋转”次数最少的不同操作方案数。由于方案数可能很大，输出时请对 $10 ^ 9+7$ 取模。", "inputFormat": "第一行一个整数 $W$，表示小 W 的心情。若 $W$ 为 $0$ 则只需求出最少的“旋转”次数，若 $W$ 为 $1$ 则还需求出“旋转”次数最少时的不同操作方案数。\n\n第二行一个正整数 $n$，表示凸多边形的边数。\n\n接下来 $n-3$ 行，每行两个正整数 $x,y$，表示小 W 在 $s_0$ 中连的一条线段，端点分别为 $x,y$。保证该线段不与已存的线段重合或相交。\n\n接下来一行一个整数 $m$，表示小 W 以 $s_0$ 为基础产生的新状态个数。\n\n接下来 $m$ 行，每行两个整数。假设其中第 $i$ 行为 $a,b$，表示对 $s_0$ 进行 $(a,b)$“旋转”后得到 $s_i$。", "outputFormat": "输出共 $m+1$ 行。\n\n若 $W$ 为 $0$ 则每一行输出一个整数，第 $i(i = 1,2, \\cdots , m, m + 1)$ 行输出的整数表示 $S_{i-1}$ 作为初始局面的最少“旋转”次数。\n\n若 $W$ 为 $1$ 则每一行输出两个整数，第 $i(i = 1,2, \\cdots , m, m + 1)$ 行输出的两个整数依次表示 $S_{i-1}$ 作为初始局面的最少“旋转”次数、“旋转”次数最少的不同操作方案数对 $10 ^ 9+7$ 取模的结果。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/56004.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/56005.png)", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] Polygon", "background": "", "description": "Xiao R and Xiao W are playing a game.\n\nThey have a convex polygon with $n$ sides, whose vertices are labeled $1,2,3,\\cdots , n$ in counterclockwise order. Initially, there are $n$ line segments inside the convex polygon, namely the $n$ sides of the polygon. Here we use an ordered pair $(a, b)$ (where $a < b$) to represent a line segment whose endpoints are vertices $a,b$.\n\nBefore the game starts, Xiao W performs some operations. In each operation, he chooses two distinct vertices of the polygon, draws a line segment between them, and the drawn segment will not overlap or intersect with any existing segment (having only one common endpoint is not considered an intersection).\n\nHe repeats this process until no more segments can be added, obtaining a state $s_0$. The segments in $s_0$ include the polygon sides and the segments added by Xiao W. It is easy to see that these segments partition the polygon into triangular regions. For any such triangle with vertices $i,j,k(i < j < k)$, we can assign this triangle the label $j$. In this way, each triangle is labeled with a distinct number from $2,3, \\cdots , n - 1$.\n\nXiao W defines a kind of “rotation” operation: for the current state, choose $4$ vertices $a,b,c,d$ such that $1 \\leq a < b < c <d \\leq n$, and there are exactly $5$ segments among them—$(a,b), (b,c), (c,d), (a,d), (a,c)$. Then delete segment $(a,c)$ and add segment $(b,d)$. Thus, the ordered pair $(a,c)$ uniquely represents this “rotation”. We call this rotation the $(a,c)$ “rotation”. Clearly, after each “rotation” operation, there are still no intersecting segments in the polygon.\n\nAfter Xiao W presents a state as the initial state of the game to Xiao R, the game begins. During the game, each time Xiao R may perform a “rotation” on the current state. After finitely many “rotations”, Xiao R will surely reach a state where no more “rotation” operations can be performed, and the game ends. Write down the ordered pairs corresponding to each “rotation” in the order performed; the resulting sequence is the operation plan for that round of the game.\n\nTo make it harder, based on $s_0$, Xiao W generates $m$ new states. The $i$-th state $s_i$ is the state obtained by applying one “rotation” operation to $s_0$. You need to help Xiao R compute, when using $s_0,s_1\\cdots s_n$ as the initial state of the game respectively, the minimum number of “rotations” Xiao R needs to finish the game; and depending on Xiao W’s mood, sometimes you also need to compute the number of different operation plans that achieve this minimum. Since the number of plans may be large, output it modulo $10 ^ 9+7$.", "inputFormat": "The first line contains an integer $W$, indicating Xiao W’s mood. If $W$ is $0$, you only need to output the minimum number of “rotations”. If $W$ is $1$, you also need to output the number of different operation plans when the number of “rotations” is minimal.\n\nThe second line contains a positive integer $n$, the number of sides of the convex polygon.\n\nThe next $n-3$ lines each contain two positive integers $x,y$, representing a segment drawn by Xiao W in $s_0$, with endpoints $x,y$. It is guaranteed that this segment does not overlap or intersect with existing segments.\n\nThe next line contains an integer $m$, the number of new states generated by Xiao W based on $s_0$.\n\nThe next $m$ lines each contain two integers. Suppose the $i$-th of these lines is $a,b$, meaning that $s_i$ is obtained by performing the $(a,b)$ “rotation” on $s_0$.", "outputFormat": "Output a total of $m+1$ lines.\n\nIf $W$ is $0$, output one integer per line. On line $i(i = 1,2, \\cdots , m, m + 1)$, the integer denotes the minimum number of “rotations” when $S_{i-1}$ is the initial state.\n\nIf $W$ is $1$, output two integers per line. On line $i(i = 1,2, \\cdots , m, m + 1)$, the two integers denote, respectively, the minimum number of “rotations” when $S_{i-1}$ is the initial state, and the number of different operation plans that achieve this minimum, modulo $10 ^ 9+7$.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/56004.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/56005.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 多边形", "background": null, "description": "小 R 与小 W 在玩游戏。\n\n他们有一个边数为 $n$ 的凸多边形，其顶点沿逆时针方向标号依次为 $1,2,3,\\cdots , n$。最开始凸多边形中有 $n$ 条线段，即多边形的 $n$ 条边。这里我们用一个有序数对 $(a, b)$（其中 $a < b$）来表示一条端点分别为顶点 $a,b$ 的线段。\n\n在游戏开始之前，小 W 会进行一些操作。每次操作时，他会选中多边形的两个互异顶点，给它们之间连一条线段，并且所连的线段不会与已存的线段重合、相交（只拥有一个公共端点不算作相交）。\n\n他会不断重复这个过程，直到无法继续连线，这样得到了状态 $s_0$。$s_0$ 包含的线段为凸多边形的边与小 W 连上的线段，容易发现这些线段将多边形划分为一个个三角形区域。对于其中任意一个三角形，其三个顶点为 $i,j,k(i < j < k)$，我们可以给这个三角形一个标号 $j$，这样一来每个三角形都被标上了 $2,3, \\cdots , n - 1$ 中的一个，且没有标号相同的两个三角形。\n\n小 W 定义了一种“旋转”操作：对于当前状态，选定 $4$ 个顶点 $a,b,c,d$，使其满足 $1 \\leq a < b < c <d \\leq n$ 且它们两两之间共有 $5$ 条线段——$(a,b), (b,c), (c,d), (a,d), (a,c)$，然后删去线段 $(a,c)$，并连上线段 $(b,d)$。那么用有序数对 $(a,c)$ 即可唯一表示该次“旋转”。我们称这次旋转为 $(a,c)$ “旋转”。显然每次进行完“旋转”操作后多边形中依然不存在相交的线段。\n\n当小 W 将一个状态作为游戏初始状态展示给小 R 后，游戏开始。游戏过程中，小 R 每次可以对当前的状态进行“旋转”。在进行有限次“旋转”之后，小 R 一定会得到一个状态，此时无法继续进行“旋转”操作，游戏结束。那么将每一次“旋转”所对应的有序数对按操作顺序写下，得到的序列即为该轮游戏的操作方案。\n\n为了加大难度，小 W 以 $s_0$ 为基础，产生了 $m$ 个新状态。其中第 $i$ 个状态 $s_i$ 为对 $s_0$ 进行一次“旋转”操作后得到的状态。你需要帮助小 R 求出分别以 $s_0,s_1\\cdots s_n$ 作为游戏初始状态时，小 R 完成游戏所用的最少“旋转”次数，并根据小 W 的心情，有时还需求出“旋转”次数最少的不同操作方案数。由于方案数可能很大，输出时请对 $10 ^ 9+7$ 取模。", "inputFormat": "第一行一个整数 $W$，表示小 W 的心情。若 $W$ 为 $0$ 则只需求出最少的“旋转”次数，若 $W$ 为 $1$ 则还需求出“旋转”次数最少时的不同操作方案数。\n\n第二行一个正整数 $n$，表示凸多边形的边数。\n\n接下来 $n-3$ 行，每行两个正整数 $x,y$，表示小 W 在 $s_0$ 中连的一条线段，端点分别为 $x,y$。保证该线段不与已存的线段重合或相交。\n\n接下来一行一个整数 $m$，表示小 W 以 $s_0$ 为基础产生的新状态个数。\n\n接下来 $m$ 行，每行两个整数。假设其中第 $i$ 行为 $a,b$，表示对 $s_0$ 进行 $(a,b)$“旋转”后得到 $s_i$。", "outputFormat": "输出共 $m+1$ 行。\n\n若 $W$ 为 $0$ 则每一行输出一个整数，第 $i(i = 1,2, \\cdots , m, m + 1)$ 行输出的整数表示 $S_{i-1}$ 作为初始局面的最少“旋转”次数。\n\n若 $W$ 为 $1$ 则每一行输出两个整数，第 $i(i = 1,2, \\cdots , m, m + 1)$ 行输出的两个整数依次表示 $S_{i-1}$ 作为初始局面的最少“旋转”次数、“旋转”次数最少的不同操作方案数对 $10 ^ 9+7$ 取模的结果。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/56004.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/56005.png)", "locale": "zh-CN"}}}
{"pid": "P5289", "type": "P", "difficulty": 7, "samples": [["2\n2 1\n3 2 2 2\n1 1\n1 2\n1\n1 0\n4 2\n10 30 20 30\n1 6\n2 4\n1 7\n2 4\n2\n2 3\n3 1", "1\n22"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "O2优化"], "title": "[十二省联考 2019] 皮配", "background": "一年一度的综艺节目《中国好码农》又开始了。本季度，好码农由 Yazid、Zayid、小 R、大 R 四位梦想导师坐镇，他们都将组建自己的梦想战队，并率领队员向梦想发起冲击。  \n\n四位导师的**派系**不尽相同，节目组为了营造看点，又将导师分成了不同的**阵营**，与此同时对不同阵营、不同派系都作出了战队总人数限制：\n- 四位导师分成两个**阵营**：\n  - Yazid、小 R 两位导师组成**蓝阵营**，他们两位的战队人数**总和**不得超过 $C_0$。\n  - Zayid、大 R 两位导师组成**红阵营**，他们两位的战队人数**总和**不得超过 $C_1$。\n- 四位导师分成两个**派系**：\n  - Yazid、Zayid 两位导师属于**鸭派系**，他们两位的战队人数**总和**不得超过 $D_0$。\n  - 小 R、大 R 两位导师属于 **R 派系**，他们两位的战队人数**总和**不得超过 $D_1$。", "description": "本季好码农邀请到了全国各路学生精英参赛。他们来自全国 $c$ 个城市的 $n$ 所不同学校（城市的编号从 $1$ 至 $c$，学校的编号从 $1$ 至 $n$）。其中，第 $i$ 所学校所属的城市编号为 $b_i$，且共有 $s_i$ 名选手参赛。  \n\n在【题目背景】中提到的各总人数限制之外，本季度《中国好码农》的导师选择阶段有额外规则如下：\n- 来自同**城市**的所有选手必须加入相同的**阵营**。\n- 来自同**学校**的所有选手必须选择相同的**导师**。\n\n对于导师，大部分学校的学生对导师没有**偏好**。但是有 $k$ 所学校，其中每所学校的学生有且仅有一位他们不喜欢的导师。同一所学校的学生不喜欢的导师相同，他们**不会加入他们不喜欢的导师的战队**。  \n\n面对琳琅满目的规则和选手的偏好，作为好码农忠实观众的你想计算出，在所有选手都进行了战队选择后，战队组成共有多少种可能的局面？\n- 两种战队组成的局面被认为是不同的，当且仅当在存在一所学校，使得在这两种局面中这所学校的选手加入了不同导师的战队。\n- 由于答案可能很大，你只需输出可能局面数对 $998244353$ 取模的结果即可。", "inputFormat": "单个测试点中包含多组数据，输入的第一行包含一个非负整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n- 第 $1$ 行 $2$ 个正整数 $n$, $c$，分别表示学校数目、城市数目。\n- 第 $2$ 行 $4$ 个正整数 $C_0$, $C_1$, $D_0$, $D_1$，分别表示题目中所描述的四个限制。\n- 接下来 $n$ 行每行 $2$ 个正整数：\n  - 这部分中第 $i$ 行的两个数依次为 $b_i$, $s_i$，分别表示第 $i$ 所学校的所属城市以及选手数目。\n  - 保证 $b_i \\leqslant c$，$s_i \\leqslant\\min\\left\\{M, 10\\right\\}$。其中 $M = \\max \\left\\{C_0, C_1, D_0, D_1\\right\\}$。\n- 接下来 $1$ 行一个非负整数 $k$，表示选手有偏好的学校数目。\n- 接下来 $k$ 行，每行 $2$ 个整数 $i$, $p$，描述编号为 $i$ 的学校选手有偏好：\n  - 其中，$p$ 为一个 $0$ 至 $3$ 之间的整数，描述该校选手不喜欢的导师：$0$ 代表 Yazid，$1$ 代表小 R，$2$ 代表 Zayid，$3$ 代表大 R。\n  - 保证 $1 \\leqslant i \\leqslant n$，且各行的 $i$ 互不相同。\n\n对于输入的每一行，如果其包含多个数，则用单个空格将它们隔开。", "outputFormat": "依次输出每组数据的答案，对于每组数据：\n- 一行一个整数，表示可能局面数对 $998244353$ 取模的结果。", "hint": "### 样例 1 解释\n对于第 $1$ 组数据：\n- 唯一的城市 $1$ 包含共 $3$ 名选手，但红阵营的总人数限制为 $2$，无法容纳这些选手，因此他们被迫只能选择蓝阵营。\n- 在此基础上，由于 $1$ 号学校的选手不喜欢 Yazid 老师，因此他们就必须加入 R 派系的小 R 老师麾下。\n- 由于 R 派系总人数限制为 $2$，因此小 R 老师战队无法容纳 $2$ 号学校的选手，所以他们只能被迫加入Yazid 老师战队。\n- 综上所述，可能的局面仅有这一种。\n\n对于第 $2$ 组数据：\n- 一个显然的事实是，$1$ 号城市的所有选手都无法加入蓝阵营，这是因为 $1$ 号城市的选手总人数超过了蓝阵营的总人数限制，因此他们被迫全部加入红阵营。\n- 对于 $2$ 号城市选手加入蓝阵营的情况，稍加计算可得出共有 $15$ 种可能的局面。\n- 对于 $2$ 号城市选手加入红阵营的情况，稍加计算可得出共有 $7$ 种可能的局面。\n- 综上所述，可能的局面数为 $15 + 7 = 22$ 种。\n\n### 数据规模与约定\n::cute-table{tuack}\n\n| 测试点 | $n$ | $c$ | $k$ | $m$ |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $=1$ | $=n$ | $\\le1$ | $=1$ |\n| $2$ | $=10$ | ^ | $\\le10$ | $\\le100$ |\n| $3$ | $=20$ | ^ | $=0$ | ^ |\n| $4$ | $=30$ | ^ | ^ | ^ |\n| $5$ | ^ | ^ | $\\le30$ | $\\le500$ |\n| $6$ | $=500$ | ^ | $=0$ | $\\le1000$ |\n| $7$ | ^ | $=30$ | $=30$ | ^ |\n| $8$ | ^ | $=n$ | ^ | ^ |\n| $9$ | $=1000$ | ^ | $=0$ | $\\le2500$ |\n| $10$ | ^ | ^ | $= 30$ | ^ |\n\n其中，$M = \\max\\left\\{C_0, C_1, D_0, D_1\\right\\}$。\n\n对于所有测试点，保证 $T \\leqslant5$。\n\n对于所有测试点中的每一组数据， 保证 $c \\leqslant n \\leqslant 1000$，$k \\leqslant 30$，$M \\leqslant 2500$，$1 \\leqslant s_i \\leqslant \\min\\left\\{M, 10\\right\\}$。\n\n**另外，请你注意，数据并不保证所有的 $c$ 个城市都有参赛学校。**\n\n### 提示\n另外还有两组附加样例文件，请在附件中下载。\n\n\n十二省联考命题组温馨提醒您：\n\n**数据千万条，清空第一条。**  \n**多测不清空，爆零两行泪。**", "locale": "zh-CN", "translations": {"en": {"title": "[Twelve Provinces Joint Exam 2019] Pipei", "background": "The annual variety show “China’s Best Coder” has started again. This season, the show is led by four “dream mentors”: Yazid, Zayid, Little R, and Big R. Each mentor will form their own team and lead contestants to chase their dreams.\n\nThe four mentors belong to different **factions**. To make the show more interesting, the organizers also divide the mentors into different **camps**, and at the same time impose total team size limits for different camps and different factions:\n- The four mentors are divided into two **camps**:\n  - Yazid and Little R form the **Blue camp**, and the **sum** of their team sizes must not exceed $C_0$.\n  - Zayid and Big R form the **Red camp**, and the **sum** of their team sizes must not exceed $C_1$.\n- The four mentors are divided into two **factions**:\n  - Yazid and Zayid belong to the **Duck faction**, and the **sum** of their team sizes must not exceed $D_0$.\n  - Little R and Big R belong to the **R faction**, and the **sum** of their team sizes must not exceed $D_1$.", "description": "This season, “China’s Best Coder” invites student elites from all over the country to compete. They come from $n$ different schools in $c$ cities nationwide (cities are numbered from $1$ to $c$, and schools are numbered from $1$ to $n$). The city index of school $i$ is $b_i$, and there are $s_i$ contestants from this school.\n\nBesides the total size limits mentioned in **Background**, the mentor selection stage this season has additional rules:\n- All contestants from the same **city** must join the same **camp**.\n- All contestants from the same **school** must choose the same **mentor**.\n\nFor mentors, students from most schools have no **preference**. However, there are $k$ schools where, for each such school, the students have exactly one mentor they dislike. Students in the same school dislike the same mentor, and they **will not join the team of the mentor they dislike**.\n\nWith so many rules and preferences, as a loyal viewer you want to compute: after all contestants have chosen teams, how many different final outcomes are possible?\n- Two outcomes are considered different if and only if there exists a school such that, in the two outcomes, contestants from this school join teams led by different mentors.\n- Since the answer may be large, output it modulo $998244353$.", "inputFormat": "Each test file contains multiple test cases. The first line contains a non-negative integer $T$ indicating the number of test cases. Then each test case is described as follows:\n- Line $1$: two positive integers $n$, $c$, representing the number of schools and the number of cities.\n- Line $2$: four positive integers $C_0$, $C_1$, $D_0$, $D_1$, representing the four limits described in the statement.\n- Next $n$ lines, each with two positive integers:\n  - On line $i$ of this part, the two numbers are $b_i$, $s_i$, representing the city of school $i$ and its number of contestants.\n  - It is guaranteed that $b_i \\leqslant c$, $s_i \\leqslant\\min\\left\\{M, 10\\right\\}$. Here $M = \\max \\left\\{C_0, C_1, D_0, D_1\\right\\}$.\n- Next line: a non-negative integer $k$, the number of schools with preferences.\n- Next $k$ lines, each with two integers $i$, $p$, describing that contestants from school $i$ have a preference:\n  - Here $p$ is an integer from $0$ to $3$, describing the mentor disliked by this school: $0$ means Yazid, $1$ means Little R, $2$ means Zayid, $3$ means Big R.\n  - It is guaranteed that $1 \\leqslant i \\leqslant n$, and all $i$ are distinct.\n\nFor each input line, if it contains multiple numbers, they are separated by a single space.", "outputFormat": "Output the answer for each test case in order:\n- For each test case, output one line with one integer, the number of possible outcomes modulo $998244353$.", "hint": "### Sample 1 Explanation\nFor the $1$st test case:\n- The only city $1$ contains a total of $3$ contestants, but the total size limit of the Red camp is $2$, so it cannot hold these contestants. Therefore, they are forced to choose the Blue camp.\n- Based on this, since contestants from school $1$ dislike mentor Yazid, they must join mentor Little R in the R faction.\n- Because the total size limit of the R faction is $2$, mentor Little R’s team cannot hold the contestants from school $2$, so they are forced to join mentor Yazid’s team.\n- Therefore, there is only one possible outcome.\n\nFor the $2$nd test case:\n- An obvious fact is that all contestants in city $1$ cannot join the Blue camp, because the total number of contestants in city $1$ exceeds the total size limit of the Blue camp, so they are forced to all join the Red camp.\n- If contestants from city $2$ join the Blue camp, a small calculation shows there are $15$ possible outcomes.\n- If contestants from city $2$ join the Red camp, a small calculation shows there are $7$ possible outcomes.\n- Therefore, the number of possible outcomes is $15 + 7 = 22$.\n\n### Constraints and Notes\n::cute-table{tuack}\n\n| Test point | $n$ | $c$ | $k$ | $m$ |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $=1$ | $=n$ | $\\le1$ | $=1$ |\n| $2$ | $=10$ | ^ | $\\le10$ | $\\le100$ |\n| $3$ | $=20$ | ^ | $=0$ | ^ |\n| $4$ | $=30$ | ^ | ^ | ^ |\n| $5$ | ^ | ^ | $\\le30$ | $\\le500$ |\n| $6$ | $=500$ | ^ | $=0$ | $\\le1000$ |\n| $7$ | ^ | $=30$ | $=30$ | ^ |\n| $8$ | ^ | $=n$ | ^ | ^ |\n| $9$ | $=1000$ | ^ | $=0$ | $\\le2500$ |\n| $10$ | ^ | ^ | $= 30$ | ^ |\n\nHere, $M = \\max\\left\\{C_0, C_1, D_0, D_1\\right\\}$.\n\nFor all test points, it is guaranteed that $T \\leqslant5$.\n\nFor each test case in all test points, it is guaranteed that $c \\leqslant n \\leqslant 1000$, $k \\leqslant 30$, $M \\leqslant 2500$, $1 \\leqslant s_i \\leqslant \\min\\left\\{M, 10\\right\\}$.\n\n**Also, note that the testdata does not guarantee that all $c$ cities have participating schools.**\n\n### Additional Hint\nThere are also two additional sample files. Please download them from the attachments.\n\nA warm reminder from the Twelve Provinces Joint Exam problem committee:\n\n**There are thousands of testdata, clearing arrays is the first rule.**  \n**If you forget to clear in multiple tests, you will cry with a zero score.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 皮配", "background": "一年一度的综艺节目《中国好码农》又开始了。本季度，好码农由 Yazid、Zayid、小 R、大 R 四位梦想导师坐镇，他们都将组建自己的梦想战队，并率领队员向梦想发起冲击。  \n\n四位导师的**派系**不尽相同，节目组为了营造看点，又将导师分成了不同的**阵营**，与此同时对不同阵营、不同派系都作出了战队总人数限制：\n- 四位导师分成两个**阵营**：\n  - Yazid、小 R 两位导师组成**蓝阵营**，他们两位的战队人数**总和**不得超过 $C_0$。\n  - Zayid、大 R 两位导师组成**红阵营**，他们两位的战队人数**总和**不得超过 $C_1$。\n- 四位导师分成两个**派系**：\n  - Yazid、Zayid 两位导师属于**鸭派系**，他们两位的战队人数**总和**不得超过 $D_0$。\n  - 小 R、大 R 两位导师属于 **R 派系**，他们两位的战队人数**总和**不得超过 $D_1$。", "description": "本季好码农邀请到了全国各路学生精英参赛。他们来自全国 $c$ 个城市的 $n$ 所不同学校（城市的编号从 $1$ 至 $c$，学校的编号从 $1$ 至 $n$）。其中，第 $i$ 所学校所属的城市编号为 $b_i$，且共有 $s_i$ 名选手参赛。  \n\n在【题目背景】中提到的各总人数限制之外，本季度《中国好码农》的导师选择阶段有额外规则如下：\n- 来自同**城市**的所有选手必须加入相同的**阵营**。\n- 来自同**学校**的所有选手必须选择相同的**导师**。\n\n对于导师，大部分学校的学生对导师没有**偏好**。但是有 $k$ 所学校，其中每所学校的学生有且仅有一位他们不喜欢的导师。同一所学校的学生不喜欢的导师相同，他们**不会加入他们不喜欢的导师的战队**。  \n\n面对琳琅满目的规则和选手的偏好，作为好码农忠实观众的你想计算出，在所有选手都进行了战队选择后，战队组成共有多少种可能的局面？\n- 两种战队组成的局面被认为是不同的，当且仅当在存在一所学校，使得在这两种局面中这所学校的选手加入了不同导师的战队。\n- 由于答案可能很大，你只需输出可能局面数对 $998244353$ 取模的结果即可。", "inputFormat": "单个测试点中包含多组数据，输入的第一行包含一个非负整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n- 第 $1$ 行 $2$ 个正整数 $n$, $c$，分别表示学校数目、城市数目。\n- 第 $2$ 行 $4$ 个正整数 $C_0$, $C_1$, $D_0$, $D_1$，分别表示题目中所描述的四个限制。\n- 接下来 $n$ 行每行 $2$ 个正整数：\n  - 这部分中第 $i$ 行的两个数依次为 $b_i$, $s_i$，分别表示第 $i$ 所学校的所属城市以及选手数目。\n  - 保证 $b_i \\leqslant c$，$s_i \\leqslant\\min\\left\\{M, 10\\right\\}$。其中 $M = \\max \\left\\{C_0, C_1, D_0, D_1\\right\\}$。\n- 接下来 $1$ 行一个非负整数 $k$，表示选手有偏好的学校数目。\n- 接下来 $k$ 行，每行 $2$ 个整数 $i$, $p$，描述编号为 $i$ 的学校选手有偏好：\n  - 其中，$p$ 为一个 $0$ 至 $3$ 之间的整数，描述该校选手不喜欢的导师：$0$ 代表 Yazid，$1$ 代表小 R，$2$ 代表 Zayid，$3$ 代表大 R。\n  - 保证 $1 \\leqslant i \\leqslant n$，且各行的 $i$ 互不相同。\n\n对于输入的每一行，如果其包含多个数，则用单个空格将它们隔开。", "outputFormat": "依次输出每组数据的答案，对于每组数据：\n- 一行一个整数，表示可能局面数对 $998244353$ 取模的结果。", "hint": "### 样例 1 解释\n对于第 $1$ 组数据：\n- 唯一的城市 $1$ 包含共 $3$ 名选手，但红阵营的总人数限制为 $2$，无法容纳这些选手，因此他们被迫只能选择蓝阵营。\n- 在此基础上，由于 $1$ 号学校的选手不喜欢 Yazid 老师，因此他们就必须加入 R 派系的小 R 老师麾下。\n- 由于 R 派系总人数限制为 $2$，因此小 R 老师战队无法容纳 $2$ 号学校的选手，所以他们只能被迫加入Yazid 老师战队。\n- 综上所述，可能的局面仅有这一种。\n\n对于第 $2$ 组数据：\n- 一个显然的事实是，$1$ 号城市的所有选手都无法加入蓝阵营，这是因为 $1$ 号城市的选手总人数超过了蓝阵营的总人数限制，因此他们被迫全部加入红阵营。\n- 对于 $2$ 号城市选手加入蓝阵营的情况，稍加计算可得出共有 $15$ 种可能的局面。\n- 对于 $2$ 号城市选手加入红阵营的情况，稍加计算可得出共有 $7$ 种可能的局面。\n- 综上所述，可能的局面数为 $15 + 7 = 22$ 种。\n\n### 数据规模与约定\n::cute-table{tuack}\n\n| 测试点 | $n$ | $c$ | $k$ | $m$ |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $=1$ | $=n$ | $\\le1$ | $=1$ |\n| $2$ | $=10$ | ^ | $\\le10$ | $\\le100$ |\n| $3$ | $=20$ | ^ | $=0$ | ^ |\n| $4$ | $=30$ | ^ | ^ | ^ |\n| $5$ | ^ | ^ | $\\le30$ | $\\le500$ |\n| $6$ | $=500$ | ^ | $=0$ | $\\le1000$ |\n| $7$ | ^ | $=30$ | $=30$ | ^ |\n| $8$ | ^ | $=n$ | ^ | ^ |\n| $9$ | $=1000$ | ^ | $=0$ | $\\le2500$ |\n| $10$ | ^ | ^ | $= 30$ | ^ |\n\n其中，$M = \\max\\left\\{C_0, C_1, D_0, D_1\\right\\}$。\n\n对于所有测试点，保证 $T \\leqslant5$。\n\n对于所有测试点中的每一组数据， 保证 $c \\leqslant n \\leqslant 1000$，$k \\leqslant 30$，$M \\leqslant 2500$，$1 \\leqslant s_i \\leqslant \\min\\left\\{M, 10\\right\\}$。\n\n**另外，请你注意，数据并不保证所有的 $c$ 个城市都有参赛学校。**\n\n### 提示\n另外还有两组附加样例文件，请在附件中下载。\n\n\n十二省联考命题组温馨提醒您：\n\n**数据千万条，清空第一条。**  \n**多测不清空，爆零两行泪。**", "locale": "zh-CN"}}}
{"pid": "P5290", "type": "P", "difficulty": 6, "samples": [["5\n10 20 20 30 30\n1 1 2 2", "60"], ["10\n2 1 1 1 1 2 1 1 1 2\n1 1 1 4 5 3 3 4 3", "6"], ["15\n10 1 10 10 2 6 9 6 8 6 3 4 4 5 5\n1 2 2 1 5 4 4 1 2 10 1 9 6 1", "31"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2019", "线段树", "各省省选", "树上启发式合并", "O2优化", "启发式合并"], "title": "[十二省联考 2019] 春节十二响", "background": "“清明时节雨纷纷，路上行人欲断魂。”\n\n$2075$ 年的清明没有春雨。在漫天飞雪的笼罩下，穿行在冰原间的，只有载着人类微薄希望的雪地车。\n\n遥遥 $4.22$ 光年的征途，对于地球这孤独的旅人而言，恐怕也是无比寂寞吧。", "description": "距离苏拉威西只有一百公里了，车内的空气比窗外更加冰冷。四双眼睛紧盯着艾莉\n芬面前的屏幕，那是控制行星发动机的关键程序：春节十二响。他需要将其部署到电力控制系统的一个芯片中。\n\n“春节十二响”由 $n$ 个子程序构成，第 $i$ 个子程序所需的内存空间是 $M_i$。这 $n$ 个子程序之间的调用关系构成了一棵以第 $1$ 个子程序为根的树，其中第 $i$ 个子程序在调用树上的父亲是第 $f_i$ 个子程序。\n\n由于内存紧张，电力控制芯片上提供了一种内存分段机制。你可以将内存分为若干\n个段 $S_1$, $S_2$, ..., $S_k$，并将每个程序预先分配到一个固定的段。如果两个子程序没有直接或间接的调用关系，则他们可以被分配到同一个段中，反之则不能。换言之，当且仅当 $a$ 和 $b$ 在调用树上**不是祖先—后代关系**，$a$ 和 $b$ 可以被分配到同一个段中。\n\n一个段的大小应当是所有分配到这个段的子程序所需内存大小的最大值，所有段\n大小的和不能超过系统的内存大小。\n\n现在艾莉芬想要知道，电力控制芯片至少要有多少内存，才能保证春节十二响的正\n确运行。即：最少需要多大的内存，才能通过先**将内存分成若干个段**，再**把每个子程序分配到一个段中，使得每个段中分配的所有子程序之间不存在祖先—后代关系**。", "inputFormat": "第一行包含一个正整数 $n$ 表示子程序的个数，其中 $n \\leqslant 2 \\times 10^5$。\n\n第二行有 $n$ 个用空格隔开的正整数 $M_1$, $M_2$, ..., $M_n$，$M_i$ 表示第 $i$ 个子程序所需的内存空间。\n\n第三行有 $n - 1$ 个用空格隔开的正整数 $f_2$, $f_3$, ..., $f_n$，满足 $f_i < i$，表示第 $i$ 个子程序在调用树上的父亲是第 $f_i$ 个子程序。", "outputFormat": "仅一个整数，表示最小的内存需求。", "hint": "#### 样例 $1$ 解释\n在最优方案中，内存被划分为大小为 $10$，$20$，$30$ 的三个段，其中第 $1$ 个子程序被分配在第 $1$ 个段中，第 $2$、$3$ 个子程序被分配在第 $2$ 个段中，第 $4$、$5$ 个子程序被分配在第 $3$ 个段中。可以证明，不存在更优的方案。\n\n#### 子任务\n![img](https://s2.ax1x.com/2019/04/07/AhSGzd.png)\n\n注意：在第 $10$、$11$、$12$ 号测试点中，$1$ 号子程序**不一定**是链的一个端点。\n\n其中 $M$ 是所有子内存需求的最大值，即 $\\max\\left\\{M_i\\right\\}$。\n\n对于全部数据，$1 \\leqslant n \\leqslant2 \\times 10^5$，$1 \\leqslant M \\leqslant 10^9$。\n\n艾莉芬经过仔细阅读题面、认真分析数据范围后，开始编写程序求解这个问题。\n\n$\\texttt{\\$$$ login Elephant}$\n\n$\\texttt{password: ********}$\n\n艾莉芬，高级程序员。豫阳市第三工程组提醒您：\n\n- 做题千万条，读题第一条；\n\n- 编程不规范，爆零两行泪。\n\n$\\texttt{\\$$$ cd spring}$\n\n$\\texttt{\\$$$ ac spring}$\n\n$\\texttt{Spring Accepted. Score: 100/100.}$", "locale": "zh-CN", "translations": {"en": {"title": "[12-Province Joint Exam 2019] Twelve Firecrackers for the Spring Festival", "background": "“During Qingming, the rain falls in torrents; on the road, travelers are heartbroken.”\n\nIn the year $2075$, there was no spring rain during Qingming. Under the cover of snow filling the sky, the only thing moving through the icy wasteland was a snow vehicle carrying humanity’s faint hope.\n\nA journey of $4.22$ light-years ahead, for Earth, this lonely traveler, is probably extremely lonely too.", "description": "Only one hundred kilometers remain to Sulawesi, and the air inside the vehicle is even colder than outside the window. Four pairs of eyes stare at the screen in front of Elephant, which shows the key program that controls the planetary engine: Twelve Firecrackers for the Spring Festival. He needs to deploy it onto a chip in the power control system.\n\n“Twelve Firecrackers for the Spring Festival” consists of $n$ subprograms. The memory required by the $i$-th subprogram is $M_i$. The call relationships among these $n$ subprograms form a tree rooted at subprogram $1$, where the parent of subprogram $i$ in the call tree is subprogram $f_i$.\n\nBecause memory is tight, the power-control chip provides a memory segmentation mechanism. You can divide memory into several segments $S_1$, $S_2$, ..., $S_k$, and pre-assign each program to a fixed segment. If two subprograms have neither a direct nor an indirect call relationship, then they can be assigned to the same segment; otherwise, they cannot. In other words, if and only if $a$ and $b$ are **not in an ancestor–descendant relationship** in the call tree, $a$ and $b$ may be assigned to the same segment.\n\nThe size of a segment should be the maximum memory requirement among all subprograms assigned to that segment. The sum of the sizes of all segments must not exceed the total memory size of the system.\n\nNow Elephant wants to know the minimum memory the power-control chip must have to guarantee the correct running of Twelve Firecrackers for the Spring Festival. That is: what is the minimum memory needed such that, by first **dividing memory into several segments**, and then **assigning each subprogram to one segment so that no two subprograms within the same segment have an ancestor–descendant relationship**, the program can run correctly.", "inputFormat": "The first line contains a positive integer $n$ representing the number of subprograms, where $n \\leqslant 2 \\times 10^5$.\n\nThe second line contains $n$ positive integers $M_1$, $M_2$, ..., $M_n$ separated by spaces, where $M_i$ denotes the memory required by the $i$-th subprogram.\n\nThe third line contains $n - 1$ positive integers $f_2$, $f_3$, ..., $f_n$ separated by spaces, satisfying $f_i < i$, meaning that the parent of the $i$-th subprogram in the call tree is subprogram $f_i$.", "outputFormat": "Only one integer, representing the minimum required memory.", "hint": "#### Explanation of Sample $1$.\nIn the optimal plan, the memory is divided into three segments of sizes $10$, $20$, and $30$. Subprogram $1$ is assigned to the first segment, subprograms $2$ and $3$ are assigned to the second segment, and subprograms $4$ and $5$ are assigned to the third segment. It can be proven that no better plan exists.\n\n#### Subtasks\n![img](https://s2.ax1x.com/2019/04/07/AhSGzd.png)\n\nNote: In test points $10$, $11$, and $12$, subprogram $1$ is **not necessarily** an endpoint of the chain.\n\nHere, $M$ is the maximum memory requirement among all subprograms, i.e., $\\max\\left\\{M_i\\right\\}$.\n\nFor all data, $1 \\leqslant n \\leqslant2 \\times 10^5$, $1 \\leqslant M \\leqslant 10^9$.\n\nAfter carefully reading the statement and analyzing the Constraints, Elephant begins to write a program to solve this problem.\n\n$\\texttt{\\$$$ login Elephant}$\n\n$\\texttt{password: ********}$\n\nElephant, senior programmer. The third engineering team of Yushi City reminds you:\n\n- There are a thousand rules for solving problems, but reading the statement is the first rule;\n\n- Non-standard coding leads to zero points and tears.\n\n$\\texttt{\\$$$ cd spring}$\n\n$\\texttt{\\$$$ ac spring}$\n\n$\\texttt{Spring Accepted. Score: 100/100.}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 春节十二响", "background": "“清明时节雨纷纷，路上行人欲断魂。”\n\n$2075$ 年的清明没有春雨。在漫天飞雪的笼罩下，穿行在冰原间的，只有载着人类微薄希望的雪地车。\n\n遥遥 $4.22$ 光年的征途，对于地球这孤独的旅人而言，恐怕也是无比寂寞吧。", "description": "距离苏拉威西只有一百公里了，车内的空气比窗外更加冰冷。四双眼睛紧盯着艾莉\n芬面前的屏幕，那是控制行星发动机的关键程序：春节十二响。他需要将其部署到电力控制系统的一个芯片中。\n\n“春节十二响”由 $n$ 个子程序构成，第 $i$ 个子程序所需的内存空间是 $M_i$。这 $n$ 个子程序之间的调用关系构成了一棵以第 $1$ 个子程序为根的树，其中第 $i$ 个子程序在调用树上的父亲是第 $f_i$ 个子程序。\n\n由于内存紧张，电力控制芯片上提供了一种内存分段机制。你可以将内存分为若干\n个段 $S_1$, $S_2$, ..., $S_k$，并将每个程序预先分配到一个固定的段。如果两个子程序没有直接或间接的调用关系，则他们可以被分配到同一个段中，反之则不能。换言之，当且仅当 $a$ 和 $b$ 在调用树上**不是祖先—后代关系**，$a$ 和 $b$ 可以被分配到同一个段中。\n\n一个段的大小应当是所有分配到这个段的子程序所需内存大小的最大值，所有段\n大小的和不能超过系统的内存大小。\n\n现在艾莉芬想要知道，电力控制芯片至少要有多少内存，才能保证春节十二响的正\n确运行。即：最少需要多大的内存，才能通过先**将内存分成若干个段**，再**把每个子程序分配到一个段中，使得每个段中分配的所有子程序之间不存在祖先—后代关系**。", "inputFormat": "第一行包含一个正整数 $n$ 表示子程序的个数，其中 $n \\leqslant 2 \\times 10^5$。\n\n第二行有 $n$ 个用空格隔开的正整数 $M_1$, $M_2$, ..., $M_n$，$M_i$ 表示第 $i$ 个子程序所需的内存空间。\n\n第三行有 $n - 1$ 个用空格隔开的正整数 $f_2$, $f_3$, ..., $f_n$，满足 $f_i < i$，表示第 $i$ 个子程序在调用树上的父亲是第 $f_i$ 个子程序。", "outputFormat": "仅一个整数，表示最小的内存需求。", "hint": "#### 样例 $1$ 解释\n在最优方案中，内存被划分为大小为 $10$，$20$，$30$ 的三个段，其中第 $1$ 个子程序被分配在第 $1$ 个段中，第 $2$、$3$ 个子程序被分配在第 $2$ 个段中，第 $4$、$5$ 个子程序被分配在第 $3$ 个段中。可以证明，不存在更优的方案。\n\n#### 子任务\n![img](https://s2.ax1x.com/2019/04/07/AhSGzd.png)\n\n注意：在第 $10$、$11$、$12$ 号测试点中，$1$ 号子程序**不一定**是链的一个端点。\n\n其中 $M$ 是所有子内存需求的最大值，即 $\\max\\left\\{M_i\\right\\}$。\n\n对于全部数据，$1 \\leqslant n \\leqslant2 \\times 10^5$，$1 \\leqslant M \\leqslant 10^9$。\n\n艾莉芬经过仔细阅读题面、认真分析数据范围后，开始编写程序求解这个问题。\n\n$\\texttt{\\$$$ login Elephant}$\n\n$\\texttt{password: ********}$\n\n艾莉芬，高级程序员。豫阳市第三工程组提醒您：\n\n- 做题千万条，读题第一条；\n\n- 编程不规范，爆零两行泪。\n\n$\\texttt{\\$$$ cd spring}$\n\n$\\texttt{\\$$$ ac spring}$\n\n$\\texttt{Spring Accepted. Score: 100/100.}$", "locale": "zh-CN"}}}
{"pid": "P5291", "type": "P", "difficulty": 7, "samples": [["2 1 2\n1 2", "7"], ["4 1 1\n1 2\n2 3\n3 4", "9"], ["5 1 1\n1 2\n1 3\n2 4\n2 5", "14"], ["12 2 10\n1 2\n2 3\n3 5\n4 5\n5 7\n6 7\n7 8\n8 9\n9 10\n9 11\n11 12\n", "953325149\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864]}, "tags": ["2019", "各省省选", "树形 DP", "树链剖分", "容斥原理"], "title": "[十二省联考 2019] 希望", "background": "我们所可以自慰的，想来想去，也还是所谓对于将来的希望。\n\n希望是附丽于存在的，有存在，便有希望，有希望，便是光明。", "description": "苏拉威西。距离地球进入木星洛希极限还有 $L$ 单位时间。\n\n蔡德仁收到了来自艾莉芬的“点燃木星计划”。计划要求他将附近所有救援队召集到同一台转向发动机处，清除障碍，并用“春节十二响”程序操纵发动机点燃木星。\n\n转向发动机共有 $n$ 个，它们由 $n - 1$ 条道路相连。任意两个转向发动机都可以通过道路互相到达，二者的距离为其间最短路径的**边数**。\n\n附近一共部署有 $k$ 支救援队 $s_1$, $s_2$, ..., $s_k$，每一支救援队有一个救援范围。救援范围是转向发动机集合的一个连通子集，其中任意两个发动机之间道路上的所有发动机都在救援范围中。\n\n我们称一个发动机 $u$ 可被救援范围为 $S$ 的救援队**到达**，当且仅当 $u$ 在 $S$ 中，且 $S$ 中任意一个发动机 $v$ 到 $u$ 的距离都**不大于** $L$。这样，无论救援队身在岗位的何处，他们都能在时间耗尽前抵达发动机 $u$。\n\n蔡德仁要指挥 $k$ 支救援队集中到同一台发动机处。但由于通讯中断，蔡德仁不知\n道每支救援队的救援范围。他想计算出可行的调度方案数，于是将问题输入电脑。\n\n在这台电脑的另一面——你，需要帮他统计出，在多少种可能的部署方案中存在一\n台能被所有救援队到达的发动机。一个**方案**指一组救援范围 $\\left\\{S_1, S_2, ..., S_k\\right\\}$；两个方案不同，当且仅当某个救援队 $s_i$ 在二者中的救援范围 $S_i$ 不同。在这次联合政府规划的饱和式救援中，两支队伍的救援范围可能**相交**甚至**相同**。\n\n你知道，答案非常大。雪地车在成千上万个地标间穿梭，可能的救援范围浩如烟海，集合所有队伍的方案却寥若晨星。但你没时间绝望，甚至没时间算出那个数字。\n\n你只能算出答案对 $998244353$ 取模的结果。\n\n那就是希望。\n\n即便需要取模，也是光明。", "inputFormat": "第一行包含三个数 $n$，$L$，$k$，依次表示转向发动机的个数，拯救地球剩余的时间，和救援队的个数。\n\n接下来 $n - 1$ 行，每行两个整数 $u$，$v$，表示第 $u$ 个和第 $v$ 个转向发动机之间有一条道路相连。", "outputFormat": "仅一个整数，表示方案数对 $998244353$ 取模的结果。", "hint": "#### 样例 $1$ 解释\n一共有以下几个可行的方案：\n\n| 1 号救援队 | 2 号救援队 |\n| :---------- | :---------- |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n\n#### 样例 $2$ 解释\n只有一个救援队，除了这个救援队的救援范围是全集 $\\texttt{\\{1,2,3,4\\}}$ 之外的所有方案都可行。\n\n#### 样例 $4$ 解释\n\n这个测试点的图如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yownegrq.png)\n\n#### 子任务\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h64qjcoa.png)\n\n对于所有数据，有 $1 \\leqslant n \\leqslant 10^6$，$0 \\leqslant L \\leqslant n$，$1 \\leqslant k \\leqslant 10$。\n\n~~**请确认程序使用了文件输入输出、没有输出多余调试信息。**~~\n\n蔡德仁抬起头。那是他从未见过的景象——木星占据了大半个天空，绚丽的色彩透过稀薄的大气，变得格外刺眼。\n\n无边的海洋里漂流的小船，不知何时就会被狂风所倾覆；而小船上平凡的我们，也只能怀着渺茫的希望，跟随着舵手指引的航向前行吧。\n\n他走上前按下了 $\\texttt{Enter}$。\n\n\\$ sudo ./spring12biubiu\n\n指令已经发出。\n", "locale": "zh-CN", "translations": {"en": {"title": "[12-Province Joint Exam 2019] Hope", "background": "What we can use to comfort ourselves, after thinking it over again and again, is still the so-called hope for the future.\n\nHope is attached to existence. If there is existence, then there is hope. If there is hope, then there is light.", "description": "Sulawesi. There are still $L$ units of time before Earth enters Jupiter's Roche limit.\n\nCai Deren received from Alifen the \"Ignite Jupiter Plan\". The plan requires him to gather all nearby rescue teams at the same steering engine, clear obstacles, and use the \"Spring Festival Twelve Bangs\" program to control the engine to ignite Jupiter.\n\nThere are $n$ steering engines in total, connected by $n - 1$ roads. Any two steering engines can reach each other through the roads, and the distance between them is the number of edges on the shortest path between them.\n\nThere are $k$ rescue teams deployed nearby: $s_1$, $s_2$, ..., $s_k$. Each rescue team has a rescue range. A rescue range is a connected subset of the set of steering engines, where for any two engines in it, all engines on the road path between them are also within the rescue range.\n\nWe say an engine $u$ can be **reached** by a rescue team whose rescue range is $S$ if and only if $u$ is in $S$, and for every engine $v$ in $S$, the distance from $v$ to $u$ is **no greater than** $L$. In this way, no matter where the rescue team is within its post, they can reach engine $u$ before time runs out.\n\nCai Deren wants to command the $k$ rescue teams to gather at the same engine. But due to communication interruption, Cai Deren does not know each rescue team's rescue range. He wants to compute the number of feasible scheduling plans, so he inputs the problem into a computer.\n\nOn the other side of this computer—you need to help him count, among how many possible deployment plans there exists an engine that can be reached by all rescue teams. A **plan** refers to a set of rescue ranges $\\left\\{S_1, S_2, ..., S_k\\right\\}$. Two plans are different if and only if for some rescue team $s_i$, its rescue range $S_i$ is different in the two plans. In this saturating rescue jointly planned by the government, the rescue ranges of two teams may **intersect** or even be **the same**.\n\nYou know the answer is extremely large. Snow vehicles shuttle among tens of thousands of landmarks; the possible rescue ranges are vast, yet the set of all teams' plans is like a morning star. But you have no time to despair, not even time to compute that number.\n\nYou can only compute the answer modulo $998244353$.\n\nThat is hope.\n\nEven if it needs to be taken modulo, it is still light.", "inputFormat": "The first line contains three numbers $n$, $L$, $k$, representing the number of steering engines, the remaining time to save Earth, and the number of rescue teams.\n\nThe next $n - 1$ lines each contain two integers $u$, $v$, indicating that there is a road connecting the $u$-th and the $v$-th steering engines.", "outputFormat": "Only one integer, representing the number of plans modulo $998244353$.", "hint": "#### Sample $1$ Explanation\nThere are the following feasible plans:\n\n| Rescue Team $1$ | Rescue Team $2$ |\n| :---------- | :---------- |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n\n#### Sample $2$ Explanation\nThere is only one rescue team. All plans are feasible except the one where this rescue team's rescue range is the full set $\\texttt{\\{1,2,3,4\\}}$.\n\n#### Sample $4$ Explanation\n\nThe graph for this test point is shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yownegrq.png)\n\n#### Subtasks\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h64qjcoa.png)\n\nFor all data, $1 \\leqslant n \\leqslant 10^6$, $0 \\leqslant L \\leqslant n$, $1 \\leqslant k \\leqslant 10$.\n\n~~**Please confirm that your program uses file input/output and does not print extra debugging information.**~~\n\nCai Deren looked up. It was a scene he had never seen before—Jupiter took up most of the sky, and its brilliant colors, shining through the thin atmosphere, became especially dazzling.\n\nA small boat drifting in a boundless ocean may be overturned by a violent storm at any time; and ordinary people on the boat can only hold on to faint hope, following the heading guided by the helmsman.\n\nHe stepped forward and pressed $\\texttt{Enter}$.\n\n\\$ sudo ./spring12biubiu\n\nThe command has been issued.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 希望", "background": "我们所可以自慰的，想来想去，也还是所谓对于将来的希望。\n\n希望是附丽于存在的，有存在，便有希望，有希望，便是光明。", "description": "苏拉威西。距离地球进入木星洛希极限还有 $L$ 单位时间。\n\n蔡德仁收到了来自艾莉芬的“点燃木星计划”。计划要求他将附近所有救援队召集到同一台转向发动机处，清除障碍，并用“春节十二响”程序操纵发动机点燃木星。\n\n转向发动机共有 $n$ 个，它们由 $n - 1$ 条道路相连。任意两个转向发动机都可以通过道路互相到达，二者的距离为其间最短路径的**边数**。\n\n附近一共部署有 $k$ 支救援队 $s_1$, $s_2$, ..., $s_k$，每一支救援队有一个救援范围。救援范围是转向发动机集合的一个连通子集，其中任意两个发动机之间道路上的所有发动机都在救援范围中。\n\n我们称一个发动机 $u$ 可被救援范围为 $S$ 的救援队**到达**，当且仅当 $u$ 在 $S$ 中，且 $S$ 中任意一个发动机 $v$ 到 $u$ 的距离都**不大于** $L$。这样，无论救援队身在岗位的何处，他们都能在时间耗尽前抵达发动机 $u$。\n\n蔡德仁要指挥 $k$ 支救援队集中到同一台发动机处。但由于通讯中断，蔡德仁不知\n道每支救援队的救援范围。他想计算出可行的调度方案数，于是将问题输入电脑。\n\n在这台电脑的另一面——你，需要帮他统计出，在多少种可能的部署方案中存在一\n台能被所有救援队到达的发动机。一个**方案**指一组救援范围 $\\left\\{S_1, S_2, ..., S_k\\right\\}$；两个方案不同，当且仅当某个救援队 $s_i$ 在二者中的救援范围 $S_i$ 不同。在这次联合政府规划的饱和式救援中，两支队伍的救援范围可能**相交**甚至**相同**。\n\n你知道，答案非常大。雪地车在成千上万个地标间穿梭，可能的救援范围浩如烟海，集合所有队伍的方案却寥若晨星。但你没时间绝望，甚至没时间算出那个数字。\n\n你只能算出答案对 $998244353$ 取模的结果。\n\n那就是希望。\n\n即便需要取模，也是光明。", "inputFormat": "第一行包含三个数 $n$，$L$，$k$，依次表示转向发动机的个数，拯救地球剩余的时间，和救援队的个数。\n\n接下来 $n - 1$ 行，每行两个整数 $u$，$v$，表示第 $u$ 个和第 $v$ 个转向发动机之间有一条道路相连。", "outputFormat": "仅一个整数，表示方案数对 $998244353$ 取模的结果。", "hint": "#### 样例 $1$ 解释\n一共有以下几个可行的方案：\n\n| 1 号救援队 | 2 号救援队 |\n| :---------- | :---------- |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n\n#### 样例 $2$ 解释\n只有一个救援队，除了这个救援队的救援范围是全集 $\\texttt{\\{1,2,3,4\\}}$ 之外的所有方案都可行。\n\n#### 样例 $4$ 解释\n\n这个测试点的图如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yownegrq.png)\n\n#### 子任务\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h64qjcoa.png)\n\n对于所有数据，有 $1 \\leqslant n \\leqslant 10^6$，$0 \\leqslant L \\leqslant n$，$1 \\leqslant k \\leqslant 10$。\n\n~~**请确认程序使用了文件输入输出、没有输出多余调试信息。**~~\n\n蔡德仁抬起头。那是他从未见过的景象——木星占据了大半个天空，绚丽的色彩透过稀薄的大气，变得格外刺眼。\n\n无边的海洋里漂流的小船，不知何时就会被狂风所倾覆；而小船上平凡的我们，也只能怀着渺茫的希望，跟随着舵手指引的航向前行吧。\n\n他走上前按下了 $\\texttt{Enter}$。\n\n\\$ sudo ./spring12biubiu\n\n指令已经发出。\n", "locale": "zh-CN"}}}
{"pid": "P5292", "type": "P", "difficulty": 7, "samples": [["5 4 2\n00010\n4 5\n1 3\n4 2\n2 5\n3 5\n1 3\n", "NO\nYES"], ["10 11 10\n0011011111\n4 6\n10 6\n5 9\n4 7\n10 7\n5 8\n1 9\n5 7\n1 10\n5 1\n5 6\n10 3\n7 4\n8 10\n9 4\n8 9\n6 6\n2 2\n9 9\n10 9\n3 4", "NO\nYES\nYES\nNO\nYES\nYES\nYES\nYES\nYES\nNO"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] 校园旅行", "background": "HNOI2019 Day2T1", "description": "某学校的每个建筑都有一个独特的编号。一天你在校园里无聊，决定在校园内随意地漫步。\n\n你已经在校园里呆过一段时间，对校园内每个建筑的编号非常熟悉，于是你情不自禁的把周围每个建筑的编号都记了下来——但其实你没有真的记下来，而是把每个建筑的编号除以 2 取余数得到 0 或 1，作为该建筑的标记，多个建筑物的标记连在一起形成一个 01 串。\n\n你对这个串很感兴趣，尤其是对于这个串是回文串的情况，于是你决定研究这个问题。\n\n学校可以看成一张图，建筑是图中的顶点，而某些顶点之间存在无向边。对于每个顶点我们有一个标记（0 或者 1）。每次你会选择图中两个顶点，你想知道这两个顶点之间是否存在一条路径使得路上经过的点的标记形成一个回文串。\n\n一个回文串是一个字符串使得它逆序之后形成的字符串和它自己相同，比如 “010”，“1001” 都是回文串，而 “01”，“110” 不是。注意长度为 1 的串总是回文串，因此如果询问的两个顶点相同，这样的路径总是存在。此外注意，经过的路径不一定为简单路径，也就是说每条边每个顶点都可以经过任意多次。\n", "inputFormat": "输入文件名为 tour.in。\n\n第一行三个整数 $n, m, q$，表示图中的顶点数和边数，以及询问数。\n\n第二行为一个长度为 $n$ 的 01 串，其中第 $i$ 个字符表示第 $i$ 个顶点（即顶点 $i$）的标记，点从 1 开始编号。\n\n接下来 $m$ 行，每一行是两个整数 $u_i, v_i$，表示顶点 $u_i$ 和顶点 $v_i$ 之间有一条无向边，不存在自环或者重边。\n\n接下来 $q$ 行，每一行存在两个整数 $x_i, y_i$，表示询问顶点 $x_i$ 和顶点 $y_i$ 的点之间是否有一条满足条件的路径。\n", "outputFormat": "输出文件名为 tour.out。\n\n输出 $q$ 行，每行一个字符串 “YES”，或者 “NO”（引号不输出）。输出 “YES” 表示满足条件的路径存在，输出 “NO” 表示不存在。", "hint": "【样例解释 1】\n\n对于第一个询问，3 号点和 2 号点不连通，因此答案为 “NO”。\n\n对于第二个询问，一条合法的路径是 1→3，路径上的标号形成的字符串为 “00”。注意合法路径不唯一。 \n\n【数据范围】\n\n对于 $30\\%$ 的数据，$1 \\leq m \\leq 10 ^ 4$；\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 3000$，$1 \\leq m \\leq 5\\times 10 ^ 4$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5000$，$1 \\leq m \\leq 5\\times 10 ^ 5$，$1 \\leq q \\leq 10 ^ 5$。\n\n【编译命令】\n\n对于 c++ 语言：g++ -o tour tour.cpp –lm -O2\n\n对于 c 语言：gcc -o tour tour.c –lm -O2\n\n对于 pascal 语言：fpc tour.pas -O2", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] Campus Tour", "background": "HNOI2019 Day2T1", "description": "Each building in a school has a unique ID. One day, you feel bored and decide to wander around the campus.\n\nYou have stayed on campus for a while and are very familiar with the IDs of all buildings, so you cannot help writing down the IDs of every nearby building. However, you do not really write down the IDs; instead, you take each building’s ID modulo $2$, getting $0$ or $1$ as the label of that building. Concatenating the labels of multiple buildings forms a 01 string.\n\nYou are very interested in this string, especially when it is a palindrome, so you decide to study this problem.\n\nThe school can be considered as a graph: buildings are vertices, and there are undirected edges between some pairs of vertices. Each vertex has a label ($0$ or $1$). Each time, you choose two vertices in the graph, and you want to know whether there exists a path between these two vertices such that the labels of the vertices visited along the path form a palindrome string.\n\nA palindrome string is a string that is the same after being reversed. For example, “010” and “1001” are palindromes, while “01” and “110” are not. Note that a string of length $1$ is always a palindrome, so if the two queried vertices are the same, such a path always exists. Also note that the path does not have to be a simple path, meaning each edge and each vertex may be visited any number of times.", "inputFormat": "The input file name is tour.in.\n\nThe first line contains three integers $n, m, q$, representing the number of vertices, the number of edges, and the number of queries.\n\nThe second line is a 01 string of length $n$, where the $i$-th character represents the label of the $i$-th vertex (i.e., vertex $i$). Vertices are numbered starting from $1$.\n\nThe next $m$ lines each contain two integers $u_i, v_i$, indicating that there is an undirected edge between vertex $u_i$ and vertex $v_i$. There are no self-loops or multiple edges.\n\nThe next $q$ lines each contain two integers $x_i, y_i$, asking whether there exists a valid path between vertex $x_i$ and vertex $y_i$.", "outputFormat": "The output file name is tour.out.\n\nOutput $q$ lines. Each line contains the string “YES” or “NO” (without quotes). Output “YES” if such a path exists, and “NO” otherwise.", "hint": "[Sample Explanation 1]\n\nFor the first query, vertex $3$ and vertex $2$ are not connected, so the answer is “NO”.\n\nFor the second query, one valid path is $1\\to 3$, and the string formed by the labels on the path is “00”. Note that the valid path is not unique.\n\n[Constraints]\n\nFor $30\\%$ of the testdata, $1 \\leq m \\leq 10 ^ 4$.\n\nFor $70\\%$ of the testdata, $1 \\leq n \\leq 3000$, $1 \\leq m \\leq 5\\times 10 ^ 4$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 5000$, $1 \\leq m \\leq 5\\times 10 ^ 5$, $1 \\leq q \\leq 10 ^ 5$.\n\n[Compile Commands]\n\nFor C++: g++ -o tour tour.cpp –lm -O2\n\nFor C: gcc -o tour tour.c –lm -O2\n\nFor Pascal: fpc tour.pas -O2\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 校园旅行", "background": "HNOI2019 Day2T1", "description": "某学校的每个建筑都有一个独特的编号。一天你在校园里无聊，决定在校园内随意地漫步。\n\n你已经在校园里呆过一段时间，对校园内每个建筑的编号非常熟悉，于是你情不自禁的把周围每个建筑的编号都记了下来——但其实你没有真的记下来，而是把每个建筑的编号除以 2 取余数得到 0 或 1，作为该建筑的标记，多个建筑物的标记连在一起形成一个 01 串。\n\n你对这个串很感兴趣，尤其是对于这个串是回文串的情况，于是你决定研究这个问题。\n\n学校可以看成一张图，建筑是图中的顶点，而某些顶点之间存在无向边。对于每个顶点我们有一个标记（0 或者 1）。每次你会选择图中两个顶点，你想知道这两个顶点之间是否存在一条路径使得路上经过的点的标记形成一个回文串。\n\n一个回文串是一个字符串使得它逆序之后形成的字符串和它自己相同，比如 “010”，“1001” 都是回文串，而 “01”，“110” 不是。注意长度为 1 的串总是回文串，因此如果询问的两个顶点相同，这样的路径总是存在。此外注意，经过的路径不一定为简单路径，也就是说每条边每个顶点都可以经过任意多次。\n", "inputFormat": "输入文件名为 tour.in。\n\n第一行三个整数 $n, m, q$，表示图中的顶点数和边数，以及询问数。\n\n第二行为一个长度为 $n$ 的 01 串，其中第 $i$ 个字符表示第 $i$ 个顶点（即顶点 $i$）的标记，点从 1 开始编号。\n\n接下来 $m$ 行，每一行是两个整数 $u_i, v_i$，表示顶点 $u_i$ 和顶点 $v_i$ 之间有一条无向边，不存在自环或者重边。\n\n接下来 $q$ 行，每一行存在两个整数 $x_i, y_i$，表示询问顶点 $x_i$ 和顶点 $y_i$ 的点之间是否有一条满足条件的路径。\n", "outputFormat": "输出文件名为 tour.out。\n\n输出 $q$ 行，每行一个字符串 “YES”，或者 “NO”（引号不输出）。输出 “YES” 表示满足条件的路径存在，输出 “NO” 表示不存在。", "hint": "【样例解释 1】\n\n对于第一个询问，3 号点和 2 号点不连通，因此答案为 “NO”。\n\n对于第二个询问，一条合法的路径是 1→3，路径上的标号形成的字符串为 “00”。注意合法路径不唯一。 \n\n【数据范围】\n\n对于 $30\\%$ 的数据，$1 \\leq m \\leq 10 ^ 4$；\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 3000$，$1 \\leq m \\leq 5\\times 10 ^ 4$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5000$，$1 \\leq m \\leq 5\\times 10 ^ 5$，$1 \\leq q \\leq 10 ^ 5$。\n\n【编译命令】\n\n对于 c++ 语言：g++ -o tour tour.cpp –lm -O2\n\n对于 c 语言：gcc -o tour tour.c –lm -O2\n\n对于 pascal 语言：fpc tour.pas -O2", "locale": "zh-CN"}}}
{"pid": "P5293", "type": "P", "difficulty": 7, "samples": [["2 2 3 1 1 998244353\n2 1\n1 0", "16\n18"], ["3 4 100 1 3 998244353\n1 1 1\n1 1 1\n1 1 1", "506551216\n528858062\n469849094\n818871911\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2019", "各省省选", "湖南", "容斥原理", "快速傅里叶变换 FFT"], "title": "[HNOI2019] 白兔之舞", "background": "HNOI2019 day2t2", "description": "有一张顶点数为 $(L+1)\\times n$ 的有向图。这张图的每个顶点由一个二元组$(u,v)$表示$(0\\le u\\le L,1\\le v\\le n)$。\n这张图不是简单图，对于任意两个顶点 $(u_1,v_1)(u_2,v_2)$，如果 $u_1<u_2$，则从 $(u_1,v_1)$ 到 $(u_2,v_2)$ 一共有 $w[v_1][v_2]$ 条不同的边，如果 $u_1\\ge u_2$ 则没有边。\n\n白兔将在这张图上上演一支舞曲。白兔初始时位于该有向图的顶点 $(0,x)$。\n\n白兔将会跳若干步。每一步，白兔会从当前顶点沿任意一条出边跳到下一个顶点。白兔可以在任意时候停止跳舞（也可以没有跳就直接结束）。当到达第一维为 $L$ 的顶点就不得不停止，因为该顶点没有出边。\n\n假设白兔停止时，跳了 $m$ 步，白兔会把这只舞曲给记录下来成为一个序列。序列的第 $i$ 个元素为它第 $i$ 步经过的边。\n\n问题来了：给定正整数 $k$ 和 $y$（$1\\le y\\le n$），对于每个 $t$（$0\\le t<k$），求有多少种舞曲（假设其长度为 $m$）满足 $m \\bmod k=t$，且白兔最后停在了坐标第二维为 $y$ 的顶点？\n\n两支舞曲不同定义为它们的长度（$m$）不同或者存在某一步它们所走的边不同。\n\n输出的结果对 $p$ 取模。\n", "inputFormat": "输入文件名为 dance.in。\n\n第一行五个用空格隔开的整数 $n,k,L,x,y,p$。\n\n接下来 $n$ 行，每行有 $n$ 个用空格隔开的整数，第 $i$ 行的第 $j$ 个数表示 $w[i][j]$。\n", "outputFormat": "输出文件名为 dance.out。\n\n依次输出 $k$ 行，每行一个数表示答案对 $p$ 取模的结果。\n", "hint": "### 样例解释 1\n$t=0$：\n1. 路径长度为 $0$，方案数为 $1$。\n2. 路径长度为 $2$，一共有六类路径：\n    - $(0,1)\\to (1,1)\\to (2,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (1,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (1,2)\\to (2,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n    - $(0,1)\\to (1,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n    - $(0,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n\n答案就为 $1+4+4+4+1+1+1=16$。\n\n$t=1$：\n1. 路径长度为 $1$，一共有三类路径：\n    - $(0,1)\\to (1,1)$ 该路径有 $w(1,1)=2$ 条；\n    - $(0,1)\\to (2,1)$ 该路径有 $w(1,1)=2$ 条；\n    - $(0,1)\\to (3,1)$ 该路径有 $w(1,1)=2$ 条；\n2. 路径长度为 $3$，一共有三类路径：\n    - $(0,1)\\to (1,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)\\times w(1,1)=8$ 条；\n    - $(0,1)\\to (1,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,2)\\times w(2,1)=2$ 条；\n    - $(0,1)\\to (1,2)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)\\times w(1,1)=2$ 条；\n\n答案就为 $2+2+2+8+2+2=18$。\n\n### 数据范围\n\n对于全部数据，$p$ 为一个质数，$10^8<p<2^{30}$，$1\\le n\\le 3$，$1\\le x\\le n$，$1\\le y\\le n$，$0\\le w(i,j)<p$，$1\\le k\\le 65536$，$k$ 为 $p-1$ 的约数，$1\\le L\\le 10^8$。\n\n对于每组测试点，特殊限制如下：\n- 测试点 $1,2$：$L\\le 10^5$；\n- 测试点 $3$：$n=1,w(1,1)=1$，$k$ 的最大质因子为 $2$；\n- 测试点 $4$：$n=1$，$k$ 的最大质因子为 $2$；\n- 测试点 $5$：$n=1,w(1,1)=1$；\n- 测试点 $6$：$n=1$；\n- 测试点 $7,8$：$k$ 的最大质因子为 $2$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] White Rabbit’s Dance", "background": "HNOI2019 day2t2", "description": "There is a directed graph with $(L+1)\\times n$ vertices. Each vertex is represented by an ordered pair $(u,v)$, where $(0\\le u\\le L,1\\le v\\le n)$.\n\nThis graph is not a simple graph. For any two vertices $(u_1,v_1)(u_2,v_2)$, if $u_1<u_2$, then there are exactly $w[v_1][v_2]$ different edges from $(u_1,v_1)$ to $(u_2,v_2)$. If $u_1\\ge u_2$, then there is no edge.\n\nThe white rabbit will perform a dance on this graph. Initially, it is at vertex $(0,x)$.\n\nThe white rabbit will make several jumps. In each jump, it moves from the current vertex to the next vertex along any outgoing edge. It can stop at any time (it may also stop immediately without making any jump). When it reaches a vertex whose first coordinate is $L$, it must stop, because that vertex has no outgoing edges.\n\nSuppose the rabbit stops after making $m$ jumps. It will record this dance as a sequence, whose $i$-th element is the edge it took in its $i$-th jump.\n\nNow, given positive integers $k$ and $y$ ($1\\le y\\le n$), for each $t$ ($0\\le t<k$), find how many dances (with length $m$) satisfy $m \\bmod k=t$, and the rabbit finally stops at a vertex whose second coordinate is $y$.\n\nTwo dances are considered different if their lengths ($m$) are different, or there exists some step at which the edges they take are different.\n\nOutput the results modulo $p$.", "inputFormat": "The input file name is dance.in.\n\nThe first line contains five integers $n,k,L,x,y,p$ separated by spaces.\n\nThen follow $n$ lines, each containing $n$ integers separated by spaces. The $j$-th number in the $i$-th line denotes $w[i][j]$.", "outputFormat": "The output file name is dance.out.\n\nOutput $k$ lines in order, each containing one number: the answer modulo $p$.", "hint": "### Sample Explanation 1\n\n$t=0$:\n1. Path length is $0$, and the number of ways is $1$.\n2. Path length is $2$. There are six types of paths:\n    - $(0,1)\\to (1,1)\\to (2,1)$: this path has $w(1,1)\\times w(1,1)=4$ ways;\n    - $(0,1)\\to (1,1)\\to (3,1)$: this path has $w(1,1)\\times w(1,1)=4$ ways;\n    - $(0,1)\\to (2,1)\\to (3,1)$: this path has $w(1,1)\\times w(1,1)=4$ ways;\n    - $(0,1)\\to (1,2)\\to (2,1)$: this path has $w(1,2)\\times w(2,1)=1$ way;\n    - $(0,1)\\to (1,2)\\to (3,1)$: this path has $w(1,2)\\times w(2,1)=1$ way;\n    - $(0,1)\\to (2,2)\\to (3,1)$: this path has $w(1,2)\\times w(2,1)=1$ way;\n\nSo the answer is $1+4+4+4+1+1+1=16$.\n\n$t=1$:\n1. Path length is $1$. There are three types of paths:\n    - $(0,1)\\to (1,1)$: this path has $w(1,1)=2$ ways;\n    - $(0,1)\\to (2,1)$: this path has $w(1,1)=2$ ways;\n    - $(0,1)\\to (3,1)$: this path has $w(1,1)=2$ ways;\n2. Path length is $3$. There are three types of paths:\n    - $(0,1)\\to (1,1)\\to (2,1)\\to (3,1)$: this path has $w(1,1)\\times w(1,1)\\times w(1,1)=8$ ways;\n    - $(0,1)\\to (1,1)\\to (2,2)\\to (3,1)$: this path has $w(1,1)\\times w(1,2)\\times w(2,1)=2$ ways;\n    - $(0,1)\\to (1,2)\\to (2,1)\\to (3,1)$: this path has $w(1,2)\\times w(2,1)\\times w(1,1)=2$ ways;\n\nSo the answer is $2+2+2+8+2+2=18$.\n\n### Constraints\n\nFor all testdata, $p$ is a prime number, $10^8<p<2^{30}$, $1\\le n\\le 3$, $1\\le x\\le n$, $1\\le y\\le n$, $0\\le w(i,j)<p$, $1\\le k\\le 65536$, $k$ is a divisor of $p-1$, and $1\\le L\\le 10^8$.\n\nFor each test point, the special constraints are as follows:\n- Test points $1,2$: $L\\le 10^5$;\n- Test point $3$: $n=1,w(1,1)=1$, and the largest prime factor of $k$ is $2$;\n- Test point $4$: $n=1$, and the largest prime factor of $k$ is $2$;\n- Test point $5$: $n=1,w(1,1)=1$;\n- Test point $6$: $n=1$;\n- Test points $7,8$: the largest prime factor of $k$ is $2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 白兔之舞", "background": "HNOI2019 day2t2", "description": "有一张顶点数为 $(L+1)\\times n$ 的有向图。这张图的每个顶点由一个二元组$(u,v)$表示$(0\\le u\\le L,1\\le v\\le n)$。\n这张图不是简单图，对于任意两个顶点 $(u_1,v_1)(u_2,v_2)$，如果 $u_1<u_2$，则从 $(u_1,v_1)$ 到 $(u_2,v_2)$ 一共有 $w[v_1][v_2]$ 条不同的边，如果 $u_1\\ge u_2$ 则没有边。\n\n白兔将在这张图上上演一支舞曲。白兔初始时位于该有向图的顶点 $(0,x)$。\n\n白兔将会跳若干步。每一步，白兔会从当前顶点沿任意一条出边跳到下一个顶点。白兔可以在任意时候停止跳舞（也可以没有跳就直接结束）。当到达第一维为 $L$ 的顶点就不得不停止，因为该顶点没有出边。\n\n假设白兔停止时，跳了 $m$ 步，白兔会把这只舞曲给记录下来成为一个序列。序列的第 $i$ 个元素为它第 $i$ 步经过的边。\n\n问题来了：给定正整数 $k$ 和 $y$（$1\\le y\\le n$），对于每个 $t$（$0\\le t<k$），求有多少种舞曲（假设其长度为 $m$）满足 $m \\bmod k=t$，且白兔最后停在了坐标第二维为 $y$ 的顶点？\n\n两支舞曲不同定义为它们的长度（$m$）不同或者存在某一步它们所走的边不同。\n\n输出的结果对 $p$ 取模。\n", "inputFormat": "输入文件名为 dance.in。\n\n第一行五个用空格隔开的整数 $n,k,L,x,y,p$。\n\n接下来 $n$ 行，每行有 $n$ 个用空格隔开的整数，第 $i$ 行的第 $j$ 个数表示 $w[i][j]$。\n", "outputFormat": "输出文件名为 dance.out。\n\n依次输出 $k$ 行，每行一个数表示答案对 $p$ 取模的结果。\n", "hint": "### 样例解释 1\n$t=0$：\n1. 路径长度为 $0$，方案数为 $1$。\n2. 路径长度为 $2$，一共有六类路径：\n    - $(0,1)\\to (1,1)\\to (2,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (1,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (1,2)\\to (2,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n    - $(0,1)\\to (1,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n    - $(0,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n\n答案就为 $1+4+4+4+1+1+1=16$。\n\n$t=1$：\n1. 路径长度为 $1$，一共有三类路径：\n    - $(0,1)\\to (1,1)$ 该路径有 $w(1,1)=2$ 条；\n    - $(0,1)\\to (2,1)$ 该路径有 $w(1,1)=2$ 条；\n    - $(0,1)\\to (3,1)$ 该路径有 $w(1,1)=2$ 条；\n2. 路径长度为 $3$，一共有三类路径：\n    - $(0,1)\\to (1,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)\\times w(1,1)=8$ 条；\n    - $(0,1)\\to (1,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,2)\\times w(2,1)=2$ 条；\n    - $(0,1)\\to (1,2)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)\\times w(1,1)=2$ 条；\n\n答案就为 $2+2+2+8+2+2=18$。\n\n### 数据范围\n\n对于全部数据，$p$ 为一个质数，$10^8<p<2^{30}$，$1\\le n\\le 3$，$1\\le x\\le n$，$1\\le y\\le n$，$0\\le w(i,j)<p$，$1\\le k\\le 65536$，$k$ 为 $p-1$ 的约数，$1\\le L\\le 10^8$。\n\n对于每组测试点，特殊限制如下：\n- 测试点 $1,2$：$L\\le 10^5$；\n- 测试点 $3$：$n=1,w(1,1)=1$，$k$ 的最大质因子为 $2$；\n- 测试点 $4$：$n=1$，$k$ 的最大质因子为 $2$；\n- 测试点 $5$：$n=1,w(1,1)=1$；\n- 测试点 $6$：$n=1$；\n- 测试点 $7,8$：$k$ 的最大质因子为 $2$。", "locale": "zh-CN"}}}
{"pid": "P5294", "type": "P", "difficulty": 7, "samples": [["5 3\n9 2 4 6 4\n1 1\n1 4\n5 6", "28\n2\n4\n26"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] 序列", "background": "HNOI2019 day2t3", "description": "给定一个长度为 $n$ 的序列 $A_1,A_2,\\dots, A_n$，以及 $m$ 个操作，每个操作将一个 $A_i$ 修改为 $k$。第一次修改之前及每次修改之后，都要求你找到一个同样长度为 $n$ 的**单调不降**序列 $B_1,B_2,\\dots ,B_n$，使得 $\\sum\\limits_{i=1}^n(A_i-B_i)^2$ 最小，并输出最小值。\n\n需要注意的是每次操作的影响都是独立的，也即每次操作只会对当前询问造成影响。\n\n为了避免精度问题，我们保证这个最小值是个分数，也即能表示为两个非负整数相除的形式：$\\dfrac{x}{y}$。那么你将要输出 $(x\\times y^{P-2}\\bmod P)$ 的值，表示模意义下 $\\dfrac{x}{y}$ 的值。其中 $P=998244353$ 是一个大质数。", "inputFormat": "第一行两个非负整数 $n,m$，代表序列长度和操作数。\n\n第二行有 $n$ 个由空格隔开的正整数，代表序列 $A_1\\sim A_n$。\n\n接下来 $m$ 行每行两个正整数 $i,k$，代表将 $A_i$ 修改为 $k$。", "outputFormat": "输出 $m+1$ 行每行一个整数，第 $i$ 行输出第 $i-1$ 次修改后的答案。特别的，第 $1$ 行应为初始局面的答案。", "hint": "### 【样例解释】\n\n第一个询问的最优 $B$ 序列为：$\\{5, 5, 5, 5, 5\\}$。\n\n第二个询问的最优 $B$ 序列为：$\\{1, 2, 4, 5, 5\\}$。\n\n第三个询问的最优 $B$ 序列为：$\\{3, 3, 4, 5, 5\\}$。\n\n第四个询问的最优 $B$ 序列为：$\\{5, 5, 5, 6, 6\\}$。\n\n样例是存在最优方案使 $B_i$ 皆为整数的特殊情况。\n\n### 【数据范围与约定】\n\n对于前 $10\\%$ 的数据，保证 $n,m\\le 10$，$k,A_i\\le 10^3$，且存在一种最优方案，使得 $B_i$ 皆为整数。\n\n对于前 $30\\%$ 的数据，保证 $n,m\\le 100$。\n\n对于另外 $20\\%$ 的数据，保证 $m = 0$。\n\n对于另外 $20\\%$ 的数据，保证 $n,m \\le 3 \\times  10^4$。\n\n对于所有数据，保证 $3 \\le n \\le 10^5,0 \\le m \\le 10^5,1 \\le k, A_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] Sequence", "background": "HNOI2019 day2t3", "description": "Given a sequence $A_1,A_2,\\dots,A_n$ of length $n$, and $m$ operations. Each operation changes some $A_i$ to $k$. Before the first change and after each change, you need to find a **non-decreasing** sequence $B_1,B_2,\\dots,B_n$ of the same length $n$, such that $\\sum\\limits_{i=1}^n (A_i-B_i)^2$ is minimized, and output this minimum value.\n\nNote that the effect of each operation is independent, i.e. each operation only affects the current query.\n\nTo avoid precision issues, we guarantee that this minimum value is a fraction, i.e. it can be written as $\\dfrac{x}{y}$ where $x$ and $y$ are non-negative integers. Then you should output $(x \\times y^{P-2} \\bmod P)$, which represents $\\dfrac{x}{y}$ under modulo arithmetic. Here $P=998244353$ is a large prime.", "inputFormat": "The first line contains two non-negative integers $n,m$, representing the sequence length and the number of operations.\n\nThe second line contains $n$ positive integers separated by spaces, representing $A_1\\sim A_n$.\n\nThe next $m$ lines each contain two positive integers $i,k$, meaning to change $A_i$ to $k$.", "outputFormat": "Output $m+1$ lines, each containing one integer. The $i$-th line should output the answer after the $(i-1)$-th change. In particular, the first line should be the answer for the initial state.", "hint": "### Sample Explanation\n\nFor the first query, an optimal sequence $B$ is $\\{5, 5, 5, 5, 5\\}$.\n\nFor the second query, an optimal sequence $B$ is $\\{1, 2, 4, 5, 5\\}$.\n\nFor the third query, an optimal sequence $B$ is $\\{3, 3, 4, 5, 5\\}$.\n\nFor the fourth query, an optimal sequence $B$ is $\\{5, 5, 5, 6, 6\\}$.\n\nThe sample is a special case where there exists an optimal solution with all $B_i$ being integers.\n\n### Constraints and Notes\n\nFor the first $10\\%$ of the testdata, it is guaranteed that $n,m\\le 10$, $k,A_i\\le 10^3$, and there exists an optimal solution with all $B_i$ being integers.\n\nFor the first $30\\%$ of the testdata, it is guaranteed that $n,m\\le 100$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $m = 0$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $n,m \\le 3 \\times 10^4$.\n\nFor all testdata, it is guaranteed that $3 \\le n \\le 10^5$, $0 \\le m \\le 10^5$, $1 \\le k, A_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 序列", "background": "HNOI2019 day2t3", "description": "给定一个长度为 $n$ 的序列 $A_1,A_2,\\dots, A_n$，以及 $m$ 个操作，每个操作将一个 $A_i$ 修改为 $k$。第一次修改之前及每次修改之后，都要求你找到一个同样长度为 $n$ 的**单调不降**序列 $B_1,B_2,\\dots ,B_n$，使得 $\\sum\\limits_{i=1}^n(A_i-B_i)^2$ 最小，并输出最小值。\n\n需要注意的是每次操作的影响都是独立的，也即每次操作只会对当前询问造成影响。\n\n为了避免精度问题，我们保证这个最小值是个分数，也即能表示为两个非负整数相除的形式：$\\dfrac{x}{y}$。那么你将要输出 $(x\\times y^{P-2}\\bmod P)$ 的值，表示模意义下 $\\dfrac{x}{y}$ 的值。其中 $P=998244353$ 是一个大质数。", "inputFormat": "第一行两个非负整数 $n,m$，代表序列长度和操作数。\n\n第二行有 $n$ 个由空格隔开的正整数，代表序列 $A_1\\sim A_n$。\n\n接下来 $m$ 行每行两个正整数 $i,k$，代表将 $A_i$ 修改为 $k$。", "outputFormat": "输出 $m+1$ 行每行一个整数，第 $i$ 行输出第 $i-1$ 次修改后的答案。特别的，第 $1$ 行应为初始局面的答案。", "hint": "### 【样例解释】\n\n第一个询问的最优 $B$ 序列为：$\\{5, 5, 5, 5, 5\\}$。\n\n第二个询问的最优 $B$ 序列为：$\\{1, 2, 4, 5, 5\\}$。\n\n第三个询问的最优 $B$ 序列为：$\\{3, 3, 4, 5, 5\\}$。\n\n第四个询问的最优 $B$ 序列为：$\\{5, 5, 5, 6, 6\\}$。\n\n样例是存在最优方案使 $B_i$ 皆为整数的特殊情况。\n\n### 【数据范围与约定】\n\n对于前 $10\\%$ 的数据，保证 $n,m\\le 10$，$k,A_i\\le 10^3$，且存在一种最优方案，使得 $B_i$ 皆为整数。\n\n对于前 $30\\%$ 的数据，保证 $n,m\\le 100$。\n\n对于另外 $20\\%$ 的数据，保证 $m = 0$。\n\n对于另外 $20\\%$ 的数据，保证 $n,m \\le 3 \\times  10^4$。\n\n对于所有数据，保证 $3 \\le n \\le 10^5,0 \\le m \\le 10^5,1 \\le k, A_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5295", "type": "P", "difficulty": 7, "samples": [["3\n3 3\n1 2\n1 3\n2 3\n2 3\n1 2\n1 2\n1 2\n4 6\n1 2\n1 3\n2 4\n1 3\n2 3\n3 4", "Yes\nNo\nYes"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "2019", "网络流", "北京", "O2优化"], "title": "[北京省选集训2019] 图的难题", "background": "标题是假的。", "description": "小 D 在图论习题书上遇到了一个问题：\n\n书上画出了一张无向图，要求把边染成黑白两色，要求所有白色边构成的子图没有环，且所有黑色边构成的子图没有环。\n\n小 D 无论怎样尝试都觉得书上的问题没有解，她想请你帮她确认一下。\n\n由于这道题有很多小问，小 D 每次会给你图的点数 $n$、边数 $m$ 与所有边集，你只需要告诉小 D 有没有解即可。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，第一行两个正整数 $n,m$，意义如题目描述。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条 $u$ 到 $v$ 的无向边。", "outputFormat": "输出 $T$ 行，对于每组数据，若有解输出 `Yes`，否则输出 `No`。", "hint": "### 数据范围：  \n\n对于 $20\\%$ 的数据：$1\\le m \\le 10$。\n\n对于 $40\\%$ 的数据：$1\\le n \\le 15$。\n\n对于 $70\\%$ 的数据：$1\\le n \\le 50$。\n\n对于 $100\\%$ 的数据：$1\\le n \\le 501$，$1\\le m \\le 2n$，$1\\le T \\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[Beijing NOI Qualifier Training 2019] A Hard Problem on Graphs", "background": "The title is fake.", "description": "Xiao D encountered a problem in a graph theory exercise book:\n\nThe book shows an undirected graph and asks you to color each edge either black or white, such that the subgraph formed by all white edges has no cycles, and the subgraph formed by all black edges also has no cycles.\n\nNo matter how she tries, Xiao D feels that the problem in the book has no solution. She wants you to help confirm this.\n\nSince this problem has many subtasks, each time Xiao D will give you the number of vertices $n$, the number of edges $m$, and the full edge set. You only need to tell Xiao D whether a solution exists.", "inputFormat": "The first line contains a positive integer $T$, denoting the number of test cases.\n\nFor each test case, the first line contains two positive integers $n,m$, with the meaning as described in the statement.\n\nThen follow $m$ lines. Each line contains two positive integers $u,v$, denoting an undirected edge from $u$ to $v$.", "outputFormat": "Output $T$ lines. For each test case, output `Yes` if a solution exists, otherwise output `No`.", "hint": "### Constraints\n\nFor $20\\%$ of the testdata: $1\\le m \\le 10$.\n\nFor $40\\%$ of the testdata: $1\\le n \\le 15$.\n\nFor $70\\%$ of the testdata: $1\\le n \\le 50$.\n\nFor $100\\%$ of the testdata: $1\\le n \\le 501$, $1\\le m \\le 2n$, $1\\le T \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[北京省选集训2019] 图的难题", "background": "标题是假的。", "description": "小 D 在图论习题书上遇到了一个问题：\n\n书上画出了一张无向图，要求把边染成黑白两色，要求所有白色边构成的子图没有环，且所有黑色边构成的子图没有环。\n\n小 D 无论怎样尝试都觉得书上的问题没有解，她想请你帮她确认一下。\n\n由于这道题有很多小问，小 D 每次会给你图的点数 $n$、边数 $m$ 与所有边集，你只需要告诉小 D 有没有解即可。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，第一行两个正整数 $n,m$，意义如题目描述。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条 $u$ 到 $v$ 的无向边。", "outputFormat": "输出 $T$ 行，对于每组数据，若有解输出 `Yes`，否则输出 `No`。", "hint": "### 数据范围：  \n\n对于 $20\\%$ 的数据：$1\\le m \\le 10$。\n\n对于 $40\\%$ 的数据：$1\\le n \\le 15$。\n\n对于 $70\\%$ 的数据：$1\\le n \\le 50$。\n\n对于 $100\\%$ 的数据：$1\\le n \\le 501$，$1\\le m \\le 2n$，$1\\le T \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P5296", "type": "P", "difficulty": 7, "samples": [["3 1\n0 0 1\n0 0 1\n1 1 0", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2019", "矩阵树定理", "多项式", "北京", "O2优化", "二项式定理", "生成函数", "高斯消元", "行列式"], "title": "[北京省选集训2019] 生成树计数", "background": "", "description": "小S 刚刚学习了生成树的知识，聪明的他想出了一个问题：  \n给定一个 $n$ 个点的带权无向完全图，求其所有生成树权值的 $k$ 次方之和。  \n定义一个树的权值，为其所有边权值和。    \n\n因为他不会，所以你要来做这题。  \n由于答案可能很大，请输出答案对 $998244353$ 取模的结果。", "inputFormat": "第一行两个非负整数 $n,k$，意义如题目描述。   \n接下来 $n$ 行，每行 $n$ 个整数，为这个带权无向完全图的邻接矩阵表示。  \n设 $w_{i,j}$ 表示矩阵的第 $i$ 行第 $j$ 列，保证：  \n$w_{i,i}=0$，且 $w_{i,j}=w_{j,i}$", "outputFormat": "输出一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据范围：  \n对于 $20\\%$的数据：  $1\\le n\\le 5$   \n对于另外 $10\\%$ 的数据：  $k = 0$   \n对于另外 $10\\%$ 的数据：  $k = 1$    \n对于 $60\\%$ 的数据：  $1\\le n \\le 15$    \n对于另外 $15\\%$ 的数据： $1\\le k \\le 15$  \n对于 $100\\%$ 的数据：$1\\le n \\le 30$，$0 \\le k \\le 30$，$0\\le w_{i,j} \\le 998244352$  \n\n注意 $0^0 = 1$", "locale": "zh-CN", "translations": {"en": {"title": "[Beijing NOI Qualifier Training 2019] Spanning Tree Counting", "background": "", "description": "Little S has just learned about spanning trees. Being clever, he came up with a question:  \nGiven a weighted undirected complete graph with $n$ vertices, find the sum of the $k$-th powers of the weights of all spanning trees.  \nThe weight of a tree is defined as the sum of the weights of all its edges.\n\nSince he cannot solve it, you have to do it.  \nBecause the answer may be very large, output the result modulo $998244353$.", "inputFormat": "The first line contains two non-negative integers $n, k$, as described above.  \nThe next $n$ lines each contain $n$ integers, representing the adjacency matrix of this weighted undirected complete graph.  \nLet $w_{i,j}$ denote the entry in row $i$ and column $j$ of the matrix, and it is guaranteed that:  \n$w_{i,i} = 0$, and $w_{i,j} = w_{j,i}$.", "outputFormat": "Output one line containing one integer, representing the answer modulo $998244353$.", "hint": "### Constraints:  \nFor $20\\%$ of the testdata: $1 \\le n \\le 5$.  \nFor another $10\\%$ of the testdata: $k = 0$.  \nFor another $10\\%$ of the testdata: $k = 1$.  \nFor $60\\%$ of the testdata: $1 \\le n \\le 15$.  \nFor another $15\\%$ of the testdata: $1 \\le k \\le 15$.  \nFor $100\\%$ of the testdata: $1 \\le n \\le 30$, $0 \\le k \\le 30$, $0 \\le w_{i,j} \\le 998244352$.\n\nNote that $0^0 = 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[北京省选集训2019] 生成树计数", "background": "", "description": "小S 刚刚学习了生成树的知识，聪明的他想出了一个问题：  \n给定一个 $n$ 个点的带权无向完全图，求其所有生成树权值的 $k$ 次方之和。  \n定义一个树的权值，为其所有边权值和。    \n\n因为他不会，所以你要来做这题。  \n由于答案可能很大，请输出答案对 $998244353$ 取模的结果。", "inputFormat": "第一行两个非负整数 $n,k$，意义如题目描述。   \n接下来 $n$ 行，每行 $n$ 个整数，为这个带权无向完全图的邻接矩阵表示。  \n设 $w_{i,j}$ 表示矩阵的第 $i$ 行第 $j$ 列，保证：  \n$w_{i,i}=0$，且 $w_{i,j}=w_{j,i}$", "outputFormat": "输出一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据范围：  \n对于 $20\\%$的数据：  $1\\le n\\le 5$   \n对于另外 $10\\%$ 的数据：  $k = 0$   \n对于另外 $10\\%$ 的数据：  $k = 1$    \n对于 $60\\%$ 的数据：  $1\\le n \\le 15$    \n对于另外 $15\\%$ 的数据： $1\\le k \\le 15$  \n对于 $100\\%$ 的数据：$1\\le n \\le 30$，$0 \\le k \\le 30$，$0\\le w_{i,j} \\le 998244352$  \n\n注意 $0^0 = 1$", "locale": "zh-CN"}}}
{"pid": "P5297", "type": "P", "difficulty": 7, "samples": [["3\n1 3\n-.-\n3 4\n#.##\n#--#\n####\n4 3\n.|.\n-//\n.-.\n#\\/", "IMPOSSIBLE\nPOSSIBLE\n#.##\n#||#\n####\nPOSSIBLE\n.-.\n|//\n.-.\n#\\/\n"]], "limits": {"time": [1000, 1000], "memory": [131072, 131072]}, "tags": ["2019", "北京", "Special Judge", "O2优化", "2-SAT"], "title": "[北京省选集训2019] 完美塔防", "background": "小N最近喜欢玩一款塔防游戏。", "description": "这款游戏的棋盘是一个 $n \\times m$ 的网格，每个格子上会有以下类型物件：  \n\n1. A 型炮台：会向上下两个方向同时发射激光，符号为 `|`; \n2. B 型炮台：会向左右两个方向同时发射激光，符号为 `-`; \n3. 空地：激光穿过该物件会保持方向前进，符号为 `.`;\n4. 障碍：激光到达该物件会消失，符号为 `#`;\n5. 正反射镜：激光到达该物件后，会依物理定律改变方向，但仍继续前进，符号为 `\\`;\n6. 副反射镜：激光到达该物件后，会依物理定律改变方向，但仍继续前进，符号为 `/`;\n\n注意激光之间可以互相穿过，但如果激光射出网格边界，也会消失。    \n小 N 是一个强迫症玩家，他想让每一处空地都会被至少一束激光打到，但不能让激光攻击到自己的炮台以致损坏。   \n小 N 可以将任意多的 A 型炮台改造成 B 型炮台，也可以把任意多的 B 型炮台改造成 A 型炮台。   \n你可以告诉他能否通过这些改造实现他的目标吗?", "inputFormat": "第一行一个正整数 $T$，表示数据组数。   \n每组数据第一行有两个正整数 $n,m$。   \n接下来 $n $ 行，每行一个长度为 $m$ 的字符串，表示棋盘。", "outputFormat": "对于每组数据，若无解则输出一行 `IMPOSSIBLE`，否则输出一行 `POSSIBLE`，再输出改造后的棋盘。  \n如果有多组解，输出任意一个即可。", "hint": "### 数据范围：\n\n对于$100\\%$的数据：\n\n- $1\\le T \\le 200$；\n- $1\\le n,m \\le 50$。\n\nSpecial Judge provided by @tiger2005.", "locale": "zh-CN", "translations": {"en": {"title": "[Beijing NOI Qualifier Training 2019] Perfect Tower Defense.", "background": "Xiao N has recently started to like playing a tower defense game.", "description": "The game board is an $n \\times m$ grid. Each cell may contain one of the following objects:\n\n1. Type A turret: shoots lasers in both up and down directions at the same time, represented by `|`.\n2. Type B turret: shoots lasers in both left and right directions at the same time, represented by `-`.\n3. Empty cell: a laser passes through and keeps moving in the same direction, represented by `.`.\n4. Obstacle: when a laser reaches it, the laser disappears, represented by `#`.\n5. Main mirror: when a laser reaches it, it changes direction according to the laws of physics and continues moving, represented by `\\`.\n6. Secondary mirror: when a laser reaches it, it changes direction according to the laws of physics and continues moving, represented by `/`.\n\nNote that lasers can pass through each other, but if a laser goes out of the grid boundary, it also disappears.  \nXiao N is a perfectionist player. He wants every empty cell to be hit by at least one laser, but he must not let any laser hit his own turrets and damage them.  \nXiao N can change any number of Type A turrets into Type B turrets, and can also change any number of Type B turrets into Type A turrets.  \nCan you tell whether he can achieve his goal through these modifications?", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.  \nFor each test case, the first line contains two positive integers $n, m$.  \nThe next $n$ lines each contain a string of length $m$, describing the board.", "outputFormat": "For each test case, if there is no solution, output one line `IMPOSSIBLE`. Otherwise, output one line `POSSIBLE`, then output the modified board.  \nIf there are multiple solutions, output any one.", "hint": "### Constraints\n\nFor $100\\%$ of the testdata:\n\n- $1\\le T \\le 200$.\n- $1\\le n,m \\le 50$.\n\nSpecial Judge provided by @tiger2005.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[北京省选集训2019] 完美塔防", "background": "小N最近喜欢玩一款塔防游戏。", "description": "这款游戏的棋盘是一个 $n \\times m$ 的网格，每个格子上会有以下类型物件：  \n\n1. A 型炮台：会向上下两个方向同时发射激光，符号为 `|`; \n2. B 型炮台：会向左右两个方向同时发射激光，符号为 `-`; \n3. 空地：激光穿过该物件会保持方向前进，符号为 `.`;\n4. 障碍：激光到达该物件会消失，符号为 `#`;\n5. 正反射镜：激光到达该物件后，会依物理定律改变方向，但仍继续前进，符号为 `\\`;\n6. 副反射镜：激光到达该物件后，会依物理定律改变方向，但仍继续前进，符号为 `/`;\n\n注意激光之间可以互相穿过，但如果激光射出网格边界，也会消失。    \n小 N 是一个强迫症玩家，他想让每一处空地都会被至少一束激光打到，但不能让激光攻击到自己的炮台以致损坏。   \n小 N 可以将任意多的 A 型炮台改造成 B 型炮台，也可以把任意多的 B 型炮台改造成 A 型炮台。   \n你可以告诉他能否通过这些改造实现他的目标吗?", "inputFormat": "第一行一个正整数 $T$，表示数据组数。   \n每组数据第一行有两个正整数 $n,m$。   \n接下来 $n $ 行，每行一个长度为 $m$ 的字符串，表示棋盘。", "outputFormat": "对于每组数据，若无解则输出一行 `IMPOSSIBLE`，否则输出一行 `POSSIBLE`，再输出改造后的棋盘。  \n如果有多组解，输出任意一个即可。", "hint": "### 数据范围：\n\n对于$100\\%$的数据：\n\n- $1\\le T \\le 200$；\n- $1\\le n,m \\le 50$。\n\nSpecial Judge provided by @tiger2005.", "locale": "zh-CN"}}}
{"pid": "P5298", "type": "P", "difficulty": 7, "samples": [["3\n0 1 1\n5000 1 2", "748683266"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "线段树", "树形 DP", "概率论", "线段树合并"], "title": "[PKUWC2018] Minimax", "background": "", "description": "小 $C$ 有一棵 $n$ 个结点的有根树，根是 $1$ 号结点，且每个结点最多有两个子结点。\n\n定义结点 $x$ 的权值为：\n\n1.若 $x$ 没有子结点，那么它的权值会在输入里给出，**保证这类点中每个结点的权值互不相同**。\n\n2.若 $x$ 有子结点，那么它的权值有 $p_x$ 的概率是它的子结点的权值的最大值，有 $1-p_x$ 的概率是它的子结点的权值的最小值。\n\n现在小 $C$ 想知道，假设 $1$ 号结点的权值有 $m$ 种可能性，**权值第 $i$ 小**的可能性的权值是 $V_i$，它的概率为 $D_i(D_i>0)$，求：\n\n$$\\sum_{i=1}^{m}i\\cdot V_i\\cdot D_i^2$$\n\n你需要输出答案对 $998244353$ 取模的值。\n", "inputFormat": "第一行一个正整数 $n$；\n\n第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个结点的父亲的编号，其中第 $1$ 个结点的父亲为 $0$；\n\n第三行 $n$ 个整数，若第 $i$ 个结点没有子结点，则第 $i$ 个数为它的权值，否则第 $i$ 个数为 $p_i\\cdot 10000$，保证 $p_i\\cdot 10000$ 是个正整数。", "outputFormat": "输出答案。\n", "hint": "\n#### 样例解释\n1号结点的权值有 $\\frac{1}{2}$ 的概率是 $1$，有 $\\frac{1}{2}$ 的概率是 $2$，所以答案是 $\\frac{5}{4}$。\n\n#### 数据范围\n\n- 对于 $10\\%$ 的数据，有 $1\\leq n\\leq 20$；  \n- 对于 $20\\%$ 的数据，有 $1\\leq n\\leq 400$；  \n- 对于 $40\\%$ 的数据，有 $1\\leq n\\leq 5000$；  \n- 对于 $60\\%$ 的数据，有 $1\\leq n\\leq 10^5$；  \n- 另有 $10\\%$ 的数据保证树的形态随机；  \n- 对于 $100\\%$ 的数据，有 $1\\leq n\\leq 3\\times 10^5$，$1\\leq w_i\\leq 10^9$。\n\n对于所有数据，满足 $0 < p_i \\cdot 10000 < 10000$，所以易证明所有叶子的权值都有概率被根取到。\n", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Minimax", "background": "", "description": "Little C has a rooted tree with $n$ nodes. The root is node $1$, and each node has at most two children.\n\nDefine the value of a node $x$ as follows:\n\n1. If $x$ has no children, then its value is given in the input. It is **guaranteed that all such nodes have pairwise distinct values**.\n\n2. If $x$ has children, then its value equals the maximum of its children’s values with probability $p_x$, and equals the minimum of its children’s values with probability $1-p_x$.\n\nNow Little C wants to know the following. Suppose the value of node $1$ has $m$ possible outcomes. Let the value of the $i$-th smallest outcome be $V_i$, and its probability be $D_i$ $(D_i>0)$. Compute:\n\n$$\\sum_{i=1}^{m}i\\cdot V_i\\cdot D_i^2$$\n\nYou need to output the answer modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ integers. The $i$-th integer is the index of the parent of node $i$. The parent of node $1$ is $0$.\n\nThe third line contains $n$ integers. If node $i$ has no children, then the $i$-th number is its value; otherwise, the $i$-th number is $p_i\\cdot 10000$. It is guaranteed that $p_i\\cdot 10000$ is a positive integer.", "outputFormat": "Output the answer.", "hint": "#### Sample Explanation\n\nThe value of node $1$ is $1$ with probability $\\frac{1}{2}$, and $2$ with probability $\\frac{1}{2}$, so the answer is $\\frac{5}{4}$.\n\n#### Constraints\n\n- For $10\\%$ of the testdata, $1\\leq n\\leq 20$.  \n- For $20\\%$ of the testdata, $1\\leq n\\leq 400$.  \n- For $40\\%$ of the testdata, $1\\leq n\\leq 5000$.  \n- For $60\\%$ of the testdata, $1\\leq n\\leq 10^5$.  \n- Another $10\\%$ of the testdata guarantees that the shape of the tree is random.  \n- For $100\\%$ of the testdata, $1\\leq n\\leq 3\\times 10^5$, $1\\leq w_i\\leq 10^9$.\n\nFor all testdata, $0 < p_i \\cdot 10000 < 10000$, so it is easy to prove that every leaf value has a positive probability of being chosen by the root.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] Minimax", "background": "", "description": "小 $C$ 有一棵 $n$ 个结点的有根树，根是 $1$ 号结点，且每个结点最多有两个子结点。\n\n定义结点 $x$ 的权值为：\n\n1.若 $x$ 没有子结点，那么它的权值会在输入里给出，**保证这类点中每个结点的权值互不相同**。\n\n2.若 $x$ 有子结点，那么它的权值有 $p_x$ 的概率是它的子结点的权值的最大值，有 $1-p_x$ 的概率是它的子结点的权值的最小值。\n\n现在小 $C$ 想知道，假设 $1$ 号结点的权值有 $m$ 种可能性，**权值第 $i$ 小**的可能性的权值是 $V_i$，它的概率为 $D_i(D_i>0)$，求：\n\n$$\\sum_{i=1}^{m}i\\cdot V_i\\cdot D_i^2$$\n\n你需要输出答案对 $998244353$ 取模的值。\n", "inputFormat": "第一行一个正整数 $n$；\n\n第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个结点的父亲的编号，其中第 $1$ 个结点的父亲为 $0$；\n\n第三行 $n$ 个整数，若第 $i$ 个结点没有子结点，则第 $i$ 个数为它的权值，否则第 $i$ 个数为 $p_i\\cdot 10000$，保证 $p_i\\cdot 10000$ 是个正整数。", "outputFormat": "输出答案。\n", "hint": "\n#### 样例解释\n1号结点的权值有 $\\frac{1}{2}$ 的概率是 $1$，有 $\\frac{1}{2}$ 的概率是 $2$，所以答案是 $\\frac{5}{4}$。\n\n#### 数据范围\n\n- 对于 $10\\%$ 的数据，有 $1\\leq n\\leq 20$；  \n- 对于 $20\\%$ 的数据，有 $1\\leq n\\leq 400$；  \n- 对于 $40\\%$ 的数据，有 $1\\leq n\\leq 5000$；  \n- 对于 $60\\%$ 的数据，有 $1\\leq n\\leq 10^5$；  \n- 另有 $10\\%$ 的数据保证树的形态随机；  \n- 对于 $100\\%$ 的数据，有 $1\\leq n\\leq 3\\times 10^5$，$1\\leq w_i\\leq 10^9$。\n\n对于所有数据，满足 $0 < p_i \\cdot 10000 < 10000$，所以易证明所有叶子的权值都有概率被根取到。\n", "locale": "zh-CN"}}}
