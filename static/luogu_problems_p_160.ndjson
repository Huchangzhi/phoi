{"pid": "P4239", "type": "P", "difficulty": 6, "samples": [["5\n1 6 3 4 9", "1 1000000001 33 999999823 1020"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "快速傅里叶变换 FFT", "模板题"], "title": "【模板】任意模数多项式乘法逆", "background": null, "description": "给定一个多项式 $F(x)$ ，请求出一个多项式 $G(x)$ ， 满足 $F(x) * G(x) \\equiv 1 ( \\mathrm{mod\\:} x^n )$\n 。系数对 $10^9+7$ 取模。", "inputFormat": "首先输入一个整数 $n$， 表示输入 $F(x)$ 为 $n-1$ 次。   \n接着输入 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表 $F(x)$ 次数为 $i-1$ 项的系数。", "outputFormat": "输出 $n$ 个数字，第 $i$ 个整数 $b_i$ 代表 $G(x)$ 次数为 $i-1$ 的项的系数。", "hint": "$1 \\leq n \\leq 10^5$，$0 \\leq a_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "【Template】Polynomial Multiplicative Inverse for Arbitrary Modulus", "background": "", "description": "Given a polynomial $F(x)$, find a polynomial $G(x)$ such that $F(x) * G(x) \\equiv 1 ( \\mathrm{mod\\:} x^n )$. Coefficients are taken modulo $10^9+7$.", "inputFormat": "First input an integer $n$, indicating that $F(x)$ has degree $n-1$. Then input $n$ integers; the $i$-th integer $a_i$ denotes the coefficient of the term of $F(x)$ with degree $i-1$.", "outputFormat": "Output $n$ integers; the $i$-th integer $b_i$ denotes the coefficient of the term of $G(x)$ with degree $i-1$.", "hint": "$1 \\leq n \\leq 10^5$, $0 \\leq a_i \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】任意模数多项式乘法逆", "background": null, "description": "给定一个多项式 $F(x)$ ，请求出一个多项式 $G(x)$ ， 满足 $F(x) * G(x) \\equiv 1 ( \\mathrm{mod\\:} x^n )$\n 。系数对 $10^9+7$ 取模。", "inputFormat": "首先输入一个整数 $n$， 表示输入 $F(x)$ 为 $n-1$ 次。   \n接着输入 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表 $F(x)$ 次数为 $i-1$ 项的系数。", "outputFormat": "输出 $n$ 个数字，第 $i$ 个整数 $b_i$ 代表 $G(x)$ 次数为 $i-1$ 的项的系数。", "hint": "$1 \\leq n \\leq 10^5$，$0 \\leq a_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4240", "type": "P", "difficulty": 7, "samples": [["3\n1 1\n2 2\n3 3", "1\n5\n19"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "莫队", "数论", "莫比乌斯反演", "前缀和", "根号分治", "整除分块", "欧拉函数"], "title": "毒瘤之神的考验", "background": "Salamander 的家门口是一条长长的公路。\n\n\n又是一年春天将至，Salamander 发现路边长出了一排毒瘤！\n\nSalamander 想带一些毒瘤回家，但是，这时毒瘤当中钻出来了一个毒瘤之神！\n\n毒瘤之神：你想要带毒瘤走吗？想要带走毒瘤，就必须回答我的问题！如果答不出来的话，你还是乖乖回家吧！", "description": "毒瘤之神会问 $T$ 次，每次给定 $n, m$，Salamander 需要回答出 $\\left( \\sum_{i=1}^n \\sum_{j=1}^m \\varphi(ij) \\right)\\! \\bmod 998244353$。\n\nSalamander 这么辣鸡当然不会做啦，于是把问题丢给了你。", "inputFormat": "第一行包含一个正整数 $T$。\n\n接下来 $T$ 行，每行包含两个正整数，用空格隔开，表示这次询问的 $n, m$。", "outputFormat": "包含 $T$ 行，每行一个整数表示答案。", "hint": "对于 $40\\%$ 的数据，$T=1$，$n, m \\le {10}^5$。  \n对于 $50\\%$ 的数据，$T \\le {10}^3$，$n, m \\le {10}^5$。  \n对于另外 $10\\%$ 的数据，$T \\le {10}^4$，$n = m \\le {10}^5$。  \n对于 $100\\%$ 的数据，$1 \\le T \\le {10}^4$，$1 \\le n, m \\le {10}^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Trial of the God of \"Duliu\"", "background": "At Salamander's doorstep lies a long road.\n\nAs spring approaches again, Salamander discovers a row of \"duliu\" growing by the roadside!\n\nSalamander wants to take some \"duliu\" home, but then a God of \"Duliu\" pops out from among them!\n\nGod of \"Duliu\": Do you want to take the \"duliu\"? If you want to take them, you must answer my question! If you can't answer it, you'd better go home!", "description": "The God of \"Duliu\" will ask $T$ times. Each time, given $n, m$, Salamander must answer $\\left( \\sum_{i=1}^n \\sum_{j=1}^m \\varphi(ij) \\right)\\! \\bmod 998244353$.\n\nSalamander cannot solve it, so he passes the problem to you.", "inputFormat": "The first line contains a positive integer $T$.\n\nThen follow $T$ lines; each line contains two positive integers separated by a space, representing this query's $n, m$.", "outputFormat": "Output $T$ lines, each containing one integer representing the answer.", "hint": "For $40\\%$ of the testdata, $T = 1$, $n, m \\le 10^5$.  \nFor $50\\%$ of the testdata, $T \\le 10^3$, $n, m \\le 10^5$.  \nFor another $10\\%$ of the testdata, $T \\le 10^4$, $n = m \\le 10^5$.  \nFor $100\\%$ of the testdata, $1 \\le T \\le 10^4$, $1 \\le n, m \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神的考验", "background": "Salamander 的家门口是一条长长的公路。\n\n\n又是一年春天将至，Salamander 发现路边长出了一排毒瘤！\n\nSalamander 想带一些毒瘤回家，但是，这时毒瘤当中钻出来了一个毒瘤之神！\n\n毒瘤之神：你想要带毒瘤走吗？想要带走毒瘤，就必须回答我的问题！如果答不出来的话，你还是乖乖回家吧！", "description": "毒瘤之神会问 $T$ 次，每次给定 $n, m$，Salamander 需要回答出 $\\left( \\sum_{i=1}^n \\sum_{j=1}^m \\varphi(ij) \\right)\\! \\bmod 998244353$。\n\nSalamander 这么辣鸡当然不会做啦，于是把问题丢给了你。", "inputFormat": "第一行包含一个正整数 $T$。\n\n接下来 $T$ 行，每行包含两个正整数，用空格隔开，表示这次询问的 $n, m$。", "outputFormat": "包含 $T$ 行，每行一个整数表示答案。", "hint": "对于 $40\\%$ 的数据，$T=1$，$n, m \\le {10}^5$。  \n对于 $50\\%$ 的数据，$T \\le {10}^3$，$n, m \\le {10}^5$。  \n对于另外 $10\\%$ 的数据，$T \\le {10}^4$，$n = m \\le {10}^5$。  \n对于 $100\\%$ 的数据，$1 \\le T \\le {10}^4$，$1 \\le n, m \\le {10}^5$。", "locale": "zh-CN"}}}
{"pid": "P4241", "type": "P", "difficulty": 6, "samples": [["2 5\n2 3\n3 1", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["枚举", "背包 DP"], "title": "采摘毒瘤", "background": "Salamander见到路边有如此多的毒瘤，于是见猎心喜，从家里拿来了一个大袋子，准备将一些毒瘤带回家。\n", "description": "路边共有$n$种不同的毒瘤，第$i$种毒瘤有$k_i$个，每个需要占据$d_i$的空间。Salamander的袋子能装下的最大体积为$m$。\n\n\nSalamander是一个很贪心的人，不过他也**不要求**带尽可能多或是总体积尽可能大的毒瘤回家，他只要求袋子里**再也装不下剩余的任何一种毒瘤**。\n\n\nSalamander想知道有多少种不同的装毒瘤的方案。两种方案不同当且仅当取的毒瘤种类不同或者至少有一种毒瘤取的数量不同。由于方案数可能太多，请输出答案对$19260817$取模后的结果。\n", "inputFormat": "第一行包括两个正整数$n$、$m$，表示毒瘤的种类数和袋子的大小。\n\n接下来的$n$行，每行两个正整数$k_i$、$d_i$，表示一种毒瘤。\n", "outputFormat": "一行，表示不同的方案数对$19260817$取模后的结果。\n", "hint": "###样例解释：\n\n两种方案如下：\n\n1.取1个第一种毒瘤和2个第二种毒瘤。\n\n2.取3个第二种毒瘤。\n\n\n$~$\n$~$\n\n对于10%的数据，$1\\leq n,k_i,d_i\\leq 10$，$1\\leq m\\leq 100$；\n\n对于30%的数据，$1\\leq n,k_i,d_i\\leq 50$，$1\\leq m\\leq 5000$；\n\n对于另外20%的数据，$k_i=1$；\n\n对于100%的数据，$1\\leq n,k_i,d_i\\leq 500$，$1\\leq m\\leq 10^5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Picking Tumors", "background": "Salamander saw so many tumors by the roadside that he got excited. He brought a big bag from home, planning to take some tumors back.", "description": "There are $n$ different types of tumors by the roadside. For type $i$, there are $k_i$ items available, and each item occupies $d_i$ units of space. Salamander’s bag has a maximum total volume capacity of $m$.\n\nSalamander is very greedy, but he does not require taking as many items as possible or achieving the largest possible total volume. He only requires that the bag can no longer fit any tumor of any remaining type.\n\nFormally, choose integers $x_i$ with $0 \\le x_i \\le k_i$ for each $i$, such that $\\sum_i x_i d_i \\le m$, and if $x_i < k_i$ then the remaining capacity $m - \\sum_i x_i d_i < d_i$ for every such $i$.\n\nSalamander wants to know how many different packing schemes there are. Two schemes are different if and only if the set of types taken is different, or there exists at least one type for which the taken quantity is different. Since the number of schemes can be large, output the answer modulo $19260817$.", "inputFormat": "The first line contains two positive integers $n$ and $m$, the number of tumor types and the bag’s capacity.\n\nEach of the next $n$ lines contains two positive integers $k_i$ and $d_i$, describing one type of tumor.", "outputFormat": "Output a single line with the number of different schemes, modulo $19260817$.", "hint": "Sample explanation:\n\nThe two schemes are as follows:\n1. Take 1 item of type 1 and 2 items of type 2.\n2. Take 3 items of type 2.\n\n$~$\n$~$\n\nConstraints\n\n- For 10% of the testdata, $1 \\le n, k_i, d_i \\le 10$, $1 \\le m \\le 100$;\n- For 30% of the testdata, $1 \\le n, k_i, d_i \\le 50$, $1 \\le m \\le 5000$;\n- For another 20% of the testdata, $k_i = 1$;\n- For 100% of the testdata, $1 \\le n, k_i, d_i \\le 500$, $1 \\le m \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "采摘毒瘤", "background": "Salamander见到路边有如此多的毒瘤，于是见猎心喜，从家里拿来了一个大袋子，准备将一些毒瘤带回家。\n", "description": "路边共有$n$种不同的毒瘤，第$i$种毒瘤有$k_i$个，每个需要占据$d_i$的空间。Salamander的袋子能装下的最大体积为$m$。\n\n\nSalamander是一个很贪心的人，不过他也**不要求**带尽可能多或是总体积尽可能大的毒瘤回家，他只要求袋子里**再也装不下剩余的任何一种毒瘤**。\n\n\nSalamander想知道有多少种不同的装毒瘤的方案。两种方案不同当且仅当取的毒瘤种类不同或者至少有一种毒瘤取的数量不同。由于方案数可能太多，请输出答案对$19260817$取模后的结果。\n", "inputFormat": "第一行包括两个正整数$n$、$m$，表示毒瘤的种类数和袋子的大小。\n\n接下来的$n$行，每行两个正整数$k_i$、$d_i$，表示一种毒瘤。\n", "outputFormat": "一行，表示不同的方案数对$19260817$取模后的结果。\n", "hint": "###样例解释：\n\n两种方案如下：\n\n1.取1个第一种毒瘤和2个第二种毒瘤。\n\n2.取3个第二种毒瘤。\n\n\n$~$\n$~$\n\n对于10%的数据，$1\\leq n,k_i,d_i\\leq 10$，$1\\leq m\\leq 100$；\n\n对于30%的数据，$1\\leq n,k_i,d_i\\leq 50$，$1\\leq m\\leq 5000$；\n\n对于另外20%的数据，$k_i=1$；\n\n对于100%的数据，$1\\leq n,k_i,d_i\\leq 500$，$1\\leq m\\leq 10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P4242", "type": "P", "difficulty": 7, "samples": [["10 10\n708916891 100649777 100649777 544409200 100649777 47435517 47435517 708916891 644811607 544409200 \n3 2\n7 1\n8 1\n1 10\n3 4\n1 5\n9 2\n1 2\n3 6\n2 1\n6 \n2 6\n8 10 9 3 2 4 \n2 2\n7 8 \n2 1\n5 \n2 2\n6 10 \n2 3\n6 1 4 \n2 1\n7 \n1 9 8 100649777\n1 7 9 544409200\n2 4\n10 9 1 2 ", "1 \n13 17 15 11 11 15 \n3 3 \n1 \n5 5 \n7 7 7 \n1 \n4 4 4 4 "]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["分治", "虚树"], "title": "树上的毒瘤", "background": "Salamander 开心地把一大袋毒瘤带回了家，把他们染上了不同的颜色，并把他们挂在了院子里的树上。", "description": "这棵树上有 $n$ 个节点，由 $n-1$ 条树枝相连。初始时树上都挂了一个毒瘤，颜色为 $c_i$。接下来 Salamander 将会进行 $q$ 个操作。\n\nSalamander 有时会修改树上某个点到另外一个点的简单路径上所有毒瘤的颜色。\n\n对于给定的树上**某个点集 $\\bm{S}$**，Salamander 还定义了某个点的权值：\n\n$$W_i=\\sum_{j\\in S}T(i,j)$$\n\n其中 $T(i,j)$ 表示 $i$ 到 $j$ 的路径上毒瘤颜色的**段数**，比如 $i$ 到 $j$ 的路径上毒瘤颜色为 $1223312$ 时，颜色段数为 $5$。\n\nSalamander 对树上的毒瘤们的状态很感兴趣，所以有时会指定树上 $m$ 个节点作为点集，询问这 $m$ 个节点的权值。", "inputFormat": "第一行包括两个正整数 $n$、$q$，表示树上的节点数和操作个数。\n\n第二行包括用空格隔开的 $n$ 个正整数 $c_i$，表示树上每个节点初始的毒瘤颜色。\n\n接下来 $n-1$ 行，每行两个正整数 $u$、$v$，表示树上有一条连接 $u$ 和 $v$ 的边。\n\n接下来描述 $q$ 个操作：\n\n1. 若给出的第一个整数等于 $1$，那么接下来将会有三个正整数 $u$、$v$、$y$，表示将树上编号为 $u$ 的点到编号为 $v$ 的点的简单路径上的毒瘤颜色全都改为 $y$。\n\n2. 若给出的第一个整数等于 $2$，那么接下来将会有一个正整数 $m$，表示指定的树上节点个数。下一行将会有 $m$ 个用空格隔开的互不相同的正整数，表示当前询问给定的 $m$ 个节点。", "outputFormat": "若干行，对于每个 $2$ 操作输出对应的答案。", "hint": "保证输入数据合法。\n\n对于 $30\\%$ 的数据，有 $1\\leq n,q\\leq 1000$，$\\sum m\\leq 5000$。\n\n对于 $60\\%$ 的数据，有 $1\\leq n,q\\leq 20000$，$\\sum m\\leq 100000$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n,q\\leq 100000$，$c_i,y\\leq 10^9$，$\\sum m\\leq 200000$，$m\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "Tumors on the Tree", "background": "Salamander happily brought home a big bag of “tumors”, dyed them in different colors, and hung them on the tree in the yard.", "description": "The tree has $n$ nodes connected by $n-1$ edges. Initially, there is one “tumor” hanging on each node, with color $c_i$. Then Salamander will perform $q$ operations.\n\nSometimes Salamander will change the colors of all “tumors” on the simple path from one node to another.\n\nFor a given set of nodes on the tree, namely the point set $\\bm{S}$, Salamander defines the weight of a node:\n$$W_i=\\sum_{j\\in S}T(i,j)$$\nwhere $T(i,j)$ denotes the number of color segments along the path from $i$ to $j$. For example, if the colors along the path from $i$ to $j$ are $1223312$, the number of segments is $5$.\n\nSalamander is very interested in the state of the “tumors” on the tree, so sometimes he will specify $m$ nodes as the set and ask for the weights of these $m$ nodes.", "inputFormat": "The first line contains two positive integers $n$, $q$, the number of nodes in the tree and the number of operations.\n\nThe second line contains $n$ space-separated positive integers $c_i$, the initial color of the “tumor” on each node.\n\nThe next $n-1$ lines each contain two positive integers $u$, $v$, indicating there is an edge connecting $u$ and $v$.\n\nThen follow $q$ operations:\n\n1. If the first integer is $1$, then there will be three positive integers $u$, $v$, $y$, meaning that all “tumor” colors on the simple path from node $u$ to node $v$ are changed to $y$.\n2. If the first integer is $2$, then there will be one positive integer $m$, the number of specified nodes on the tree. The next line contains $m$ distinct positive integers separated by spaces, representing the $m$ nodes in the current query.", "outputFormat": "Output several lines. For each operation of type $2$, output the corresponding answer.", "hint": "The input is guaranteed to be valid.\n\nFor $30\\%$ of the testdata, $1 \\leq n, q \\leq 1000$, $\\sum m \\leq 5000$.\n\nFor $60\\%$ of the testdata, $1 \\leq n, q \\leq 20000$, $\\sum m \\leq 100000$.\n\nFor $100\\%$ of the testdata, $1 \\leq n, q \\leq 100000$, $c_i, y \\leq 10^9$, $\\sum m \\leq 200000$, $m \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "树上的毒瘤", "background": "Salamander 开心地把一大袋毒瘤带回了家，把他们染上了不同的颜色，并把他们挂在了院子里的树上。", "description": "这棵树上有 $n$ 个节点，由 $n-1$ 条树枝相连。初始时树上都挂了一个毒瘤，颜色为 $c_i$。接下来 Salamander 将会进行 $q$ 个操作。\n\nSalamander 有时会修改树上某个点到另外一个点的简单路径上所有毒瘤的颜色。\n\n对于给定的树上**某个点集 $\\bm{S}$**，Salamander 还定义了某个点的权值：\n\n$$W_i=\\sum_{j\\in S}T(i,j)$$\n\n其中 $T(i,j)$ 表示 $i$ 到 $j$ 的路径上毒瘤颜色的**段数**，比如 $i$ 到 $j$ 的路径上毒瘤颜色为 $1223312$ 时，颜色段数为 $5$。\n\nSalamander 对树上的毒瘤们的状态很感兴趣，所以有时会指定树上 $m$ 个节点作为点集，询问这 $m$ 个节点的权值。", "inputFormat": "第一行包括两个正整数 $n$、$q$，表示树上的节点数和操作个数。\n\n第二行包括用空格隔开的 $n$ 个正整数 $c_i$，表示树上每个节点初始的毒瘤颜色。\n\n接下来 $n-1$ 行，每行两个正整数 $u$、$v$，表示树上有一条连接 $u$ 和 $v$ 的边。\n\n接下来描述 $q$ 个操作：\n\n1. 若给出的第一个整数等于 $1$，那么接下来将会有三个正整数 $u$、$v$、$y$，表示将树上编号为 $u$ 的点到编号为 $v$ 的点的简单路径上的毒瘤颜色全都改为 $y$。\n\n2. 若给出的第一个整数等于 $2$，那么接下来将会有一个正整数 $m$，表示指定的树上节点个数。下一行将会有 $m$ 个用空格隔开的互不相同的正整数，表示当前询问给定的 $m$ 个节点。", "outputFormat": "若干行，对于每个 $2$ 操作输出对应的答案。", "hint": "保证输入数据合法。\n\n对于 $30\\%$ 的数据，有 $1\\leq n,q\\leq 1000$，$\\sum m\\leq 5000$。\n\n对于 $60\\%$ 的数据，有 $1\\leq n,q\\leq 20000$，$\\sum m\\leq 100000$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n,q\\leq 100000$，$c_i,y\\leq 10^9$，$\\sum m\\leq 200000$，$m\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P4243", "type": "P", "difficulty": 6, "samples": [["5\n1\n3\n-1\n-4\n7\n2\nA 2 4 -1 5\nB 1 5", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2009", "线段树", "各省省选", "江苏", "差分"], "title": "[JSOI2009] 等差数列", "background": "“一个长度为$l$的数列$a_i$，若相邻两数间的差$a_i - a_{i-1} \\ (2 \\leq i \\leq l)$全部相同，则这个数列为等差数列。”火星特级数学老师jyy，正在给他的火星学生们上数学课。", "description": "为了检验学生的掌握情况，jyy布置了一道习题：给定一个长度为$N$（$1 \\leq N \\leq 100,000$）的数列，初始时第$i$个数为$v_i$（$v_i$是整数，$-100,000 \\leq v_i \\leq 100,000$），学生们要按照jyy的给出的操作步骤来改变数列中的某些项的值。操作步骤的具体形式为：`A s t a b` （$s, t, a, b$均为整数，$1 \\leq s \\leq t \\leq N$，$-100,000 \\leq a, b \\leq 100,000$），它表示，在序列的$[s, t]$区间上加上初值为$a$，步长为$b$的等差数列。即$v_i$变为$v_i + a + b \\times (i - s)$（对于$s \\leq i \\leq t$）。\n\n在焦头烂额地计算之余，可怜的火星学生们还得随时回答jyy提出的问题。问题形式为：`B s t`（$s, t$均为整数，$1 \\leq s \\leq t \\leq N$），表示jyy询问当前序列的$[s, t]$区间最少能划分成几段，使得每一段都是等差数列。比如说`1 2 3 5 7`最少能划分成$2$段，一段是`1 2 3`，另一段是`5 7`。询问是需要同学们计算出答案后，作为作业交上来的。\n\n虽然操作数加问题数总共只有$Q$（$1 \\leq Q \\leq 100,000$）个，jyy还是觉得这个题很无聊很麻烦。于是他想让你帮他算一份标准答案。", "inputFormat": "第$1$行：$1$个整数$N$，第$2 \\cdots N + 1$行：每行一个整数。第$i + 1$行表示$v_i$。\n\n第$N + 2$行：$1$个整数$Q$，第$N + 3 \\cdots N + Q + 2$行：每行描述了一个操作或问题，格式如题中所述，不含引号。", "outputFormat": "若干行，每行一个整数，表示对一个问题的回答。请按照输入中的顺序依次给出回答。", "hint": "**样例说明：**\n\n原数列`1 3 -1 -4 7`。经过操作之后，数列变为`1 2 3 5 7`。如题中所述，最少能划分成$2$段。\n\n**数据规模：**\n\n对$30\\%$的数据，$N, Q \\leq 5000$。\n\n对$100\\%$的数据，$1 \\leq N, Q \\leq 100,000$。\n\n其他数据范围见题面。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2009] Arithmetic Progression", "background": "\"Given a sequence $a_i$ of length $l$, if the differences between adjacent numbers $a_i - a_{i-1}$ ($2 \\leq i \\leq l$) are all the same, then the sequence is an arithmetic progression.\" jyy, a top-level Martian math teacher, is teaching his Martian students.", "description": "To check how well the students have learned, jyy assigns an exercise: given a sequence of length $N$ ($1 \\leq N \\leq 100,000$), where initially the $i$-th number is $v_i$ ($v_i$ is an integer, $-100,000 \\leq v_i \\leq 100,000$), the students must modify some elements according to jyy’s operations. An operation has the form: `A s t a b` ($s, t, a, b$ are all integers, $1 \\leq s \\leq t \\leq N$, $-100,000 \\leq a, b \\leq 100,000$). It means: over the interval $[s, t]$, add an arithmetic progression with initial term $a$ and common difference $b$. That is, $v_i$ becomes $v_i + a + b \\times (i - s)$ (for $s \\leq i \\leq t$).\n\nAmid their hectic calculations, the poor Martian students must also answer jyy’s questions at any time. A query has the form: `B s t` ($s, t$ are integers, $1 \\leq s \\leq t \\leq N$), which asks for the minimum number of segments into which the current interval $[s, t]$ can be partitioned so that each segment is an arithmetic progression. For example, `1 2 3 5 7` can be partitioned into $2$ segments: `1 2 3` and `5 7`. The answers to the queries must be computed and handed in as homework.\n\nAlthough the total number of operations plus queries is only $Q$ ($1 \\leq Q \\leq 100,000$), jyy still finds this problem boring and troublesome. So he wants you to compute a standard answer for him.", "inputFormat": "Line $1$: one integer $N$. Lines $2 \\cdots N + 1$: each line contains one integer. Line $i + 1$ gives $v_i$.\n\nLine $N + 2$: one integer $Q$. Lines $N + 3 \\cdots N + Q + 2$: each line describes an operation or a query, in the format described above, without quotes.", "outputFormat": "Several lines, each containing one integer, representing the answer to a query. Output the answers in the same order as the queries appear in the input.", "hint": "Sample explanation:\n\nThe original sequence is `1 3 -1 -4 7`. After the operation, the sequence becomes `1 2 3 5 7`. As described above, the minimum number of segments is $2$.\n\nConstraints:\n\n- For $30\\%$ of the testdata, $N, Q \\leq 5000$.\n- For $100\\%$ of the testdata, $1 \\leq N, Q \\leq 100,000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2009] 等差数列", "background": "“一个长度为$l$的数列$a_i$，若相邻两数间的差$a_i - a_{i-1} \\ (2 \\leq i \\leq l)$全部相同，则这个数列为等差数列。”火星特级数学老师jyy，正在给他的火星学生们上数学课。", "description": "为了检验学生的掌握情况，jyy布置了一道习题：给定一个长度为$N$（$1 \\leq N \\leq 100,000$）的数列，初始时第$i$个数为$v_i$（$v_i$是整数，$-100,000 \\leq v_i \\leq 100,000$），学生们要按照jyy的给出的操作步骤来改变数列中的某些项的值。操作步骤的具体形式为：`A s t a b` （$s, t, a, b$均为整数，$1 \\leq s \\leq t \\leq N$，$-100,000 \\leq a, b \\leq 100,000$），它表示，在序列的$[s, t]$区间上加上初值为$a$，步长为$b$的等差数列。即$v_i$变为$v_i + a + b \\times (i - s)$（对于$s \\leq i \\leq t$）。\n\n在焦头烂额地计算之余，可怜的火星学生们还得随时回答jyy提出的问题。问题形式为：`B s t`（$s, t$均为整数，$1 \\leq s \\leq t \\leq N$），表示jyy询问当前序列的$[s, t]$区间最少能划分成几段，使得每一段都是等差数列。比如说`1 2 3 5 7`最少能划分成$2$段，一段是`1 2 3`，另一段是`5 7`。询问是需要同学们计算出答案后，作为作业交上来的。\n\n虽然操作数加问题数总共只有$Q$（$1 \\leq Q \\leq 100,000$）个，jyy还是觉得这个题很无聊很麻烦。于是他想让你帮他算一份标准答案。", "inputFormat": "第$1$行：$1$个整数$N$，第$2 \\cdots N + 1$行：每行一个整数。第$i + 1$行表示$v_i$。\n\n第$N + 2$行：$1$个整数$Q$，第$N + 3 \\cdots N + Q + 2$行：每行描述了一个操作或问题，格式如题中所述，不含引号。", "outputFormat": "若干行，每行一个整数，表示对一个问题的回答。请按照输入中的顺序依次给出回答。", "hint": "**样例说明：**\n\n原数列`1 3 -1 -4 7`。经过操作之后，数列变为`1 2 3 5 7`。如题中所述，最少能划分成$2$段。\n\n**数据规模：**\n\n对$30\\%$的数据，$N, Q \\leq 5000$。\n\n对$100\\%$的数据，$1 \\leq N, Q \\leq 100,000$。\n\n其他数据范围见题面。", "locale": "zh-CN"}}}
{"pid": "P4244", "type": "P", "difficulty": 6, "samples": [["15 3\n9 1 2 3 4 5 6 7 8 3\n7 2 9 10 11 12 13 10\n5 2 14 9 15 10", "8"], ["10 1\n10 1 2 3 4 5 6 7 8 9 10", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "各省省选", "单调队列", "上海", "深度优先搜索 DFS", "仙人掌"], "title": "[SHOI2008] 仙人掌图 II", "background": "题目这个II是和[SHOI2006的仙人掌图](https://www.luogu.org/problemnew/show/P4129)区分的，bzoj没有。\n**但是实际上还是和bzoj1023是一个题目的**。", "description": "如果某个无向连通图的任意一条边至多只出现在一条简单回路（simple cycle）里，我们就称这张图为仙人掌图（cactus）。所谓简单回路就是指在图上不重复经过任何一个顶点的回路。\n\n![](https://cdn.luogu.com.cn/upload/pic/13241.png)\n\n举例来说，上面的第一个例子是一张仙人图，而第二个不是——注意到它有三条简单回路：（4，3，2，1，6，5，4）、（7，8，9，10，2，3，7）以及（4，3，7，8，9，10，2，1，6，5，4），而（2，3）同时出现在前两个的简单回路里。另外，第三张图也不是仙人图，因为它并不是连通图。显然，仙人图上的每条边，或者是这张仙人图的桥（bridge），或者在且仅在一个简单回路里，两者必居其一。定义在图上两点之间的距离为这两点之间最短路径的距离。定义一个图的直径为这张图相距最远的两个点的距离。**现在我们假定仙人图的每条边的权值都是1，你的任务是求出给定的仙人图的直径**。", "inputFormat": "输入的第一行包括两个整数n和m（1≤n≤50000以及0≤m≤10000）。其中n代表顶点个数，我们约定图中的顶点将从1到n编号。接下来一共有m行。代表m条路径。每行的开始有一个整数k（2≤k≤1000），代表在这条路径上的顶点个数。接下来是k个1到n之间的整数，分别对应了一个顶点，相邻的顶点表示存在一条连接这两个顶点的边。一条路径上可能通过一个顶点好几次，比如对于第一个样例，第一条路径从3经过8，又从8返回到了3，但是我们保证所有的边都会出现在某条路径上，而且不会重复出现在两条路径上，或者在一条路径上出现两次。", "outputFormat": "只需输出一个数，这个数表示仙人图的直径长度。", "hint": "\n对第一个样例的说明：6号点和12号点的最短路径长度为8，所以这张图的直径为8。\n\n【注意】使用Pascal语言的选手请注意：你的程序在处理大数据的时候可能会出现栈溢出。\n如果需要调整栈空间的大小，可以在程序的开头填加一句：{\\$M 5000000}，其中5000000即指代栈空间的大小，请根据自己的程序选择适当的数值。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2008] Cactus Graph II", "background": "The “II” in the title distinguishes this problem from [SHOI2006 Cactus Graph](https://www.luogu.org/problemnew/show/P4129), which is not on BZOJ. \nHowever, it is actually the same problem as bzoj1023.", "description": "If, in an undirected connected graph, every edge appears in at most one simple cycle, we call the graph a cactus graph (cactus). A simple cycle is a cycle that does not visit any vertex more than once.\n\n![](https://cdn.luogu.com.cn/upload/pic/13241.png)\n\nFor example, the first figure above is a cactus graph, while the second is not—note that it has three simple cycles: (4, 3, 2, 1, 6, 5, 4), (7, 8, 9, 10, 2, 3, 7), and (4, 3, 7, 8, 9, 10, 2, 1, 6, 5, 4), and the edge (2, 3) appears in the first two simple cycles at the same time. In addition, the third figure is not a cactus graph either because it is not connected. Clearly, every edge in a cactus graph is either a bridge or lies in exactly one simple cycle; exactly one of these holds.\n\nDefine the distance between two vertices in the graph as the length of the shortest path between them. Define the diameter of a graph as the distance between the two vertices that are farthest apart. We assume every edge in the cactus graph has weight 1. Your task is to compute the diameter of the given cactus graph.", "inputFormat": "The first line contains two integers $n$ and $m$ ($1 \\le n \\le 50000$, $0 \\le m \\le 10000$). Here $n$ is the number of vertices, labeled from 1 to $n$.\n\nThe next $m$ lines each describe one path. Each such line starts with an integer $k$ ($2 \\le k \\le 1000$), the number of vertices on this path, followed by $k$ integers between 1 and $n$, each denoting a vertex. Adjacent vertices on the line indicate an edge between them. A path may pass through a vertex multiple times; for example, in the first sample, the first path goes from 3 to 8, then returns from 8 to 3. We guarantee that every edge appears in some path, and no edge appears in two different paths or appears twice within the same path.", "outputFormat": "Output a single integer: the diameter of the cactus graph.", "hint": "Explanation for the first sample: the shortest path length between vertex 6 and vertex 12 is 8, so the diameter is 8.\n\nNote for Pascal users: your program may encounter stack overflow on large testdata. If you need to adjust the stack size, you can add the following at the beginning of your program: {\\$M 5000000}, where 5000000 specifies the stack size. Please choose an appropriate value for your program.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2008] 仙人掌图 II", "background": "题目这个II是和[SHOI2006的仙人掌图](https://www.luogu.org/problemnew/show/P4129)区分的，bzoj没有。\n**但是实际上还是和bzoj1023是一个题目的**。", "description": "如果某个无向连通图的任意一条边至多只出现在一条简单回路（simple cycle）里，我们就称这张图为仙人掌图（cactus）。所谓简单回路就是指在图上不重复经过任何一个顶点的回路。\n\n![](https://cdn.luogu.com.cn/upload/pic/13241.png)\n\n举例来说，上面的第一个例子是一张仙人图，而第二个不是——注意到它有三条简单回路：（4，3，2，1，6，5，4）、（7，8，9，10，2，3，7）以及（4，3，7，8，9，10，2，1，6，5，4），而（2，3）同时出现在前两个的简单回路里。另外，第三张图也不是仙人图，因为它并不是连通图。显然，仙人图上的每条边，或者是这张仙人图的桥（bridge），或者在且仅在一个简单回路里，两者必居其一。定义在图上两点之间的距离为这两点之间最短路径的距离。定义一个图的直径为这张图相距最远的两个点的距离。**现在我们假定仙人图的每条边的权值都是1，你的任务是求出给定的仙人图的直径**。", "inputFormat": "输入的第一行包括两个整数n和m（1≤n≤50000以及0≤m≤10000）。其中n代表顶点个数，我们约定图中的顶点将从1到n编号。接下来一共有m行。代表m条路径。每行的开始有一个整数k（2≤k≤1000），代表在这条路径上的顶点个数。接下来是k个1到n之间的整数，分别对应了一个顶点，相邻的顶点表示存在一条连接这两个顶点的边。一条路径上可能通过一个顶点好几次，比如对于第一个样例，第一条路径从3经过8，又从8返回到了3，但是我们保证所有的边都会出现在某条路径上，而且不会重复出现在两条路径上，或者在一条路径上出现两次。", "outputFormat": "只需输出一个数，这个数表示仙人图的直径长度。", "hint": "\n对第一个样例的说明：6号点和12号点的最短路径长度为8，所以这张图的直径为8。\n\n【注意】使用Pascal语言的选手请注意：你的程序在处理大数据的时候可能会出现栈溢出。\n如果需要调整栈空间的大小，可以在程序的开头填加一句：{\\$M 5000000}，其中5000000即指代栈空间的大小，请根据自己的程序选择适当的数值。", "locale": "zh-CN"}}}
{"pid": "P4245", "type": "P", "difficulty": 6, "samples": [["5 8 28\n19 32 0 182 99 95\n77 54 15 3 98 66 21 20 38", "7 18 25 19 5 13 12 2 9 22 5 27 6 26"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "O2优化", "素数判断,质数,筛法", "中国剩余定理 CRT", "快速傅里叶变换 FFT", "模板题"], "title": "【模板】任意模数多项式乘法", "background": "模板题，无背景", "description": "给定 $2$ 个多项式 $F(x), G(x)$ ，请求出 $F(x) * G(x)$。    \n\n**系数对 $p$ 取模**，且**不保证** $p$ 可以分解成 $p = a \\cdot 2^k + 1$ 之形式。", "inputFormat": "输入共 $3$ 行。   \n第一行 $3$ 个整数 $n, m, p$，分别表示 $F(x), G(x)$ 的次数以及模数 $p$ 。   \n第二行为 $n+1$ 个整数，第 $i$ 个整数 $a_i$ 表示 $F(x)$ 的 $i-1$ 次项的系数。   \n第三行为 $m+1$ 个整数，第 $i$ 个整数 $b_i$ 表示 $G(x)$ 的 $i-1$ 次项的系数。\n", "outputFormat": "输出 $n+m+1$ 个整数， 第 $i$ 个整数 $c_i$ 表示 $F(x) * G(x)$ 的 $i-1$ 次项的系数。", "hint": "对于 $100 \\%$ 的数据，$1 \\leq n, m \\leq 10^5$，$0 \\leq a_i, b_i \\leq 10^9$，$2 \\leq p \\leq 10^9 + 9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Polynomial Multiplication with Arbitrary Modulus", "background": "Template problem, no background.", "description": "Given $2$ polynomials $F(x), G(x)$, compute $F(x) * G(x)$. The coefficients are taken modulo $p$, and it is not guaranteed that $p$ can be written in the form $p = a \\cdot 2^k + 1$.", "inputFormat": "The input consists of $3$ lines.  \nThe first line contains $3$ integers $n, m, p$, representing the degrees of $F(x)$ and $G(x)$, and the modulus $p$.  \nThe second line contains $n+1$ integers; the $i$-th integer $a_i$ denotes the coefficient of the $(i-1)$-th term of $F(x)$.  \nThe third line contains $m+1$ integers; the $i$-th integer $b_i$ denotes the coefficient of the $(i-1)$-th term of $G(x)$.", "outputFormat": "Output $n+m+1$ integers. The $i$-th integer $c_i$ denotes the coefficient of the $(i-1)$-th term of $F(x) * G(x)$.", "hint": "For $100\\%$ of the testdata, $1 \\leq n, m \\leq 10^5$, $0 \\leq a_i, b_i \\leq 10^9$, $2 \\leq p \\leq 10^9 + 9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】任意模数多项式乘法", "background": "模板题，无背景", "description": "给定 $2$ 个多项式 $F(x), G(x)$ ，请求出 $F(x) * G(x)$。    \n\n**系数对 $p$ 取模**，且**不保证** $p$ 可以分解成 $p = a \\cdot 2^k + 1$ 之形式。", "inputFormat": "输入共 $3$ 行。   \n第一行 $3$ 个整数 $n, m, p$，分别表示 $F(x), G(x)$ 的次数以及模数 $p$ 。   \n第二行为 $n+1$ 个整数，第 $i$ 个整数 $a_i$ 表示 $F(x)$ 的 $i-1$ 次项的系数。   \n第三行为 $m+1$ 个整数，第 $i$ 个整数 $b_i$ 表示 $G(x)$ 的 $i-1$ 次项的系数。\n", "outputFormat": "输出 $n+m+1$ 个整数， 第 $i$ 个整数 $c_i$ 表示 $F(x) * G(x)$ 的 $i-1$ 次项的系数。", "hint": "对于 $100 \\%$ 的数据，$1 \\leq n, m \\leq 10^5$，$0 \\leq a_i, b_i \\leq 10^9$，$2 \\leq p \\leq 10^9 + 9$。", "locale": "zh-CN"}}}
{"pid": "P4246", "type": "P", "difficulty": 6, "samples": [["2\nOpen 1 1 1 2\nOpen 1 2 2 2\nAsk 1 1 2 2\nAsk 2 1 2 2\nExit", "Y\nN"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2008", "线段树", "各省省选", "递归", "上海"], "title": "[SHOI2008] 堵塞的交通", "background": "", "description": "有一天，由于某种穿越现象作用，你来到了传说中的小人国。小人国的布局非常奇特，整个国家的交通系统可以被看成是一个 $2$ 行 $C$ 列的矩形网格，网格上的每个点代表一个城市，相邻的城市之间有一条道路，所以总共有 $2C$ 个城市和 $3C-2 $条道路。 \n\n小人国的交通状况非常槽糕。有的时候由于交通堵塞，两座城市之间的道路会变得不连通，直到拥堵解决，道路才会恢复畅通。初来咋到的你决心毛遂自荐到交通部某份差事，部长听说你来自一个科技高度发达的世界，喜出望外地要求你编写一个查询应答系统，以挽救已经病入膏肓的小人国交通系统。 小人国的交通部将提供一些交通信息给你，你的任务是根据当前的交通情况回答查询的问题。交通信息可以分为以下几种格式：\n\n- `Close r1 c1 r2 c2`：相邻的两座城市 $(r_1, c_1)$ 和 $(r_2, c_2)$ 之间的道路被堵塞了；\n- `Open r1 c1 r2 c2`：相邻的两座城市 $(r_1, c_1)$ 和 $(r_2, c_2)$ 之间的道路被疏通了；\n- `Ask r1 c1 r2 c2`：询问城市 $(r_1, c_1)$ 和 $(r_2, c_2)$ 是否连通。如果存在一条路径使得这两条城市连通，则返回 `Y`，否则返回 `N`。\n\n*注：$r_i$ 表示行数，$c_i$ 表示列数，$1 \\leq r_i \\leq 2, 1 \\leq c_i \\leq C$。*", "inputFormat": "第一行只有一个整数 $C$，表示网格的列数。接下来若干行，每行为一条交通信息，以单独的一行 `Exit` 作为结束。我们假设在一开始所有的道路都是堵塞的。我们保证 $C$ 小于等于 $100000$，信息条数小于等于 $100000$。", "outputFormat": "对于每个查询，输出一个 `Y` 或 `N`。", "hint": "**数据范围：**\n\n对于 $100\\%$ 的数据，$1 \\leq C \\leq 100000$，$1 \\leq$ 信息条数 $\\leq 100000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2008] Blocked Traffic", "background": "", "description": "One day, due to some kind of time-travel phenomenon, you arrived in the legendary land of tiny people. Its layout is quite peculiar: the entire country's transportation network can be seen as a rectangular grid with $2$ rows and $C$ columns. Each point on the grid represents a city, and there is a road between adjacent cities. Thus there are $2C$ cities and $3C - 2$ roads in total.\n\nThe traffic situation is terrible. Sometimes, due to congestion, the road between two cities becomes disconnected; it will not be passable again until the congestion clears. As a newcomer, you volunteer to help at the Ministry of Transport. Hearing that you come from a highly advanced world, the minister gladly asks you to write a query response system to save the ailing transportation network. The ministry will provide some traffic information, and your task is to answer queries based on the current traffic situation. The information comes in the following formats:\n\n- `Close r1 c1 r2 c2`: the road between the two adjacent cities $(r_1, c_1)$ and $(r_2, c_2)$ is blocked.\n- `Open r1 c1 r2 c2`: the road between the two adjacent cities $(r_1, c_1)$ and $(r_2, c_2)$ is unblocked.\n- `Ask r1 c1 r2 c2`: ask whether cities $(r_1, c_1)$ and $(r_2, c_2)$ are connected. If there exists a path that connects the two cities, return `Y`; otherwise return `N`.\n\nNote: $r_i$ denotes the row index and $c_i$ denotes the column index, with $1 \\leq r_i \\leq 2$ and $1 \\leq c_i \\leq C$.", "inputFormat": "The first line contains a single integer $C$, the number of columns in the grid. The following lines each contain one traffic instruction, and a single line `Exit` marks the end of input. Initially, all roads are assumed to be blocked. It is guaranteed that $C \\leq 100000$ and the number of instructions $\\leq 100000$.", "outputFormat": "For each query, output a single `Y` or `N`.", "hint": "Constraints:\n\nFor $100\\%$ of the testdata, $1 \\leq C \\leq 100000$, and $1 \\leq$ number of instructions $\\leq 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2008] 堵塞的交通", "background": "", "description": "有一天，由于某种穿越现象作用，你来到了传说中的小人国。小人国的布局非常奇特，整个国家的交通系统可以被看成是一个 $2$ 行 $C$ 列的矩形网格，网格上的每个点代表一个城市，相邻的城市之间有一条道路，所以总共有 $2C$ 个城市和 $3C-2 $条道路。 \n\n小人国的交通状况非常槽糕。有的时候由于交通堵塞，两座城市之间的道路会变得不连通，直到拥堵解决，道路才会恢复畅通。初来咋到的你决心毛遂自荐到交通部某份差事，部长听说你来自一个科技高度发达的世界，喜出望外地要求你编写一个查询应答系统，以挽救已经病入膏肓的小人国交通系统。 小人国的交通部将提供一些交通信息给你，你的任务是根据当前的交通情况回答查询的问题。交通信息可以分为以下几种格式：\n\n- `Close r1 c1 r2 c2`：相邻的两座城市 $(r_1, c_1)$ 和 $(r_2, c_2)$ 之间的道路被堵塞了；\n- `Open r1 c1 r2 c2`：相邻的两座城市 $(r_1, c_1)$ 和 $(r_2, c_2)$ 之间的道路被疏通了；\n- `Ask r1 c1 r2 c2`：询问城市 $(r_1, c_1)$ 和 $(r_2, c_2)$ 是否连通。如果存在一条路径使得这两条城市连通，则返回 `Y`，否则返回 `N`。\n\n*注：$r_i$ 表示行数，$c_i$ 表示列数，$1 \\leq r_i \\leq 2, 1 \\leq c_i \\leq C$。*", "inputFormat": "第一行只有一个整数 $C$，表示网格的列数。接下来若干行，每行为一条交通信息，以单独的一行 `Exit` 作为结束。我们假设在一开始所有的道路都是堵塞的。我们保证 $C$ 小于等于 $100000$，信息条数小于等于 $100000$。", "outputFormat": "对于每个查询，输出一个 `Y` 或 `N`。", "hint": "**数据范围：**\n\n对于 $100\\%$ 的数据，$1 \\leq C \\leq 100000$，$1 \\leq$ 信息条数 $\\leq 100000$。", "locale": "zh-CN"}}}
{"pid": "P4247", "type": "P", "difficulty": 6, "samples": [["5 5\n1 2 3 4 5\nI 2 3 1\nQ 2 4 2\nR 1 5\nI 1 3 -1\nQ 1 5 1", "40\n19940397"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "线段树", "O2优化", "枚举", "CTT（清华集训/北大集训）"], "title": "[清华集训 2012] 序列操作", "background": "", "description": "有一个长度为 $n$ 的序列，有三个操作：\n\n1. `I a b c` 表示将 $[a,b]$ 这一段区间的元素集体增加 $c$；\n2. `R a b`表示将 $[a,b]$ 区间内所有元素变成相反数；\n3. `Q a b c` 表示询问 $[a,b]$ 这一段区间中选择 $c$ 个数相乘的所有方案的和 $\\mod 19940417$ 的值。", "inputFormat": "第一行两个数 $n, q$ 表示序列长度和操作个数。\n\n第二行 $n$ 个整数，表示序列。\n\n接下来 $q$ 行每行输入一个操作 `I a b c` 或者 `R a b` 或者 `Q a b c`，意义如题目描述。", "outputFormat": "对于每个询问，输出选出 $c$ 个数相乘的所有方案的和 $\\mod 19940417$ 的值。", "hint": "**样例说明：**\n\n做完第一个操作序列变为 `1 3 4 4 5`。\n\n第一次询问结果为 $3 \\times 4+3 \\times 4+4 \\times 4=40$。\n\n做完 `R` 操作变成 `-1 -3 -4 -4 -5`。\n\n做完 `I` 操作变为 `-2 -4 -5 -4 -5`。\n\n第二次询问结果为 $-2-4-5-4-5=-20$。\n\n**数据范围：**\n\n对于 $100\\%$ 的数据，$n \\leq 50000, q \\leq 50000$。初始序列的元素的绝对值 $\\leq 10^9$，保证 $[a,b]$ 是一个合法区间，`I` 操作中 $|c| \\leq 10^9$，`Q` 操作中 $1 \\leq c \\leq \\min(b-a+1,20)$。", "locale": "zh-CN", "translations": {"en": {"title": "[Tsinghua Training 2012] Sequence Operations", "background": "", "description": "There is a sequence of length $n$ with three operations:\n\n1. `I a b c` means adding $c$ to all elements in the interval $[a,b]$.\n2. `R a b` means turning all elements in the interval $[a,b]$ into their opposites (negating them).\n3. `Q a b c` means querying the value of the sum of products over all ways to choose $c$ numbers from the interval $[a,b]$, taken $\\mod 19940417$.", "inputFormat": "The first line contains two integers $n, q$, denoting the sequence length and the number of operations.\n\nThe second line contains $n$ integers, representing the sequence.\n\nEach of the next $q$ lines contains one operation, either `I a b c`, `R a b`, or `Q a b c`, with meanings as described above.", "outputFormat": "For each query, output the value of the sum of products over all ways to choose $c$ numbers from the specified interval, taken $\\mod 19940417$.", "hint": "Sample explanation:\n\nAfter the first operation, the sequence becomes `1 3 4 4 5`.\n\nThe result of the first query is $3 \\times 4 + 3 \\times 4 + 4 \\times 4 = 40$.\n\nAfter the `R` operation, it becomes `-1 -3 -4 -4 -5`.\n\nAfter the `I` operation, it becomes `-2 -4 -5 -4 -5`.\n\nThe result of the second query is $(-2)+(-4)+(-5)+(-4)+(-5)=-20$.\n\nConstraints:\n\nFor $100\\%$ of the testdata, $n \\leq 50000, q \\leq 50000$. The absolute value of each element in the initial sequence is $\\leq 10^9$. It is guaranteed that $[a,b]$ is a valid interval. In operation `I`, $|c| \\leq 10^9$. In operation `Q`, $1 \\leq c \\leq \\min(b-a+1,20)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[清华集训 2012] 序列操作", "background": "", "description": "有一个长度为 $n$ 的序列，有三个操作：\n\n1. `I a b c` 表示将 $[a,b]$ 这一段区间的元素集体增加 $c$；\n2. `R a b`表示将 $[a,b]$ 区间内所有元素变成相反数；\n3. `Q a b c` 表示询问 $[a,b]$ 这一段区间中选择 $c$ 个数相乘的所有方案的和 $\\mod 19940417$ 的值。", "inputFormat": "第一行两个数 $n, q$ 表示序列长度和操作个数。\n\n第二行 $n$ 个整数，表示序列。\n\n接下来 $q$ 行每行输入一个操作 `I a b c` 或者 `R a b` 或者 `Q a b c`，意义如题目描述。", "outputFormat": "对于每个询问，输出选出 $c$ 个数相乘的所有方案的和 $\\mod 19940417$ 的值。", "hint": "**样例说明：**\n\n做完第一个操作序列变为 `1 3 4 4 5`。\n\n第一次询问结果为 $3 \\times 4+3 \\times 4+4 \\times 4=40$。\n\n做完 `R` 操作变成 `-1 -3 -4 -4 -5`。\n\n做完 `I` 操作变为 `-2 -4 -5 -4 -5`。\n\n第二次询问结果为 $-2-4-5-4-5=-20$。\n\n**数据范围：**\n\n对于 $100\\%$ 的数据，$n \\leq 50000, q \\leq 50000$。初始序列的元素的绝对值 $\\leq 10^9$，保证 $[a,b]$ 是一个合法区间，`I` 操作中 $|c| \\leq 10^9$，`Q` 操作中 $1 \\leq c \\leq \\min(b-a+1,20)$。", "locale": "zh-CN"}}}
{"pid": "P4248", "type": "P", "difficulty": 6, "samples": [["cacao", "54"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "各省省选", "安徽", "后缀自动机 SAM", "后缀数组 SA", "后缀树", "单调栈"], "title": "[AHOI2013] 差异", "background": "", "description": "给定一个长度为 $n$ 的字符串 $S$，令 $T_i$ 表示它从第 $i$ 个字符开始的后缀。求\n\n$$\\displaystyle \\sum_{1\\leqslant i<j\\leqslant n}\\operatorname{len}(T_i)+\\operatorname{len}(T_j)-2\\times\\operatorname{lcp}(T_i,T_j)$$\n\n其中，$\\text{len}(a)$ 表示字符串 $a$ 的长度，$\\text{lcp}(a,b)$ 表示字符串 $a$ 和字符串 $b$ 的最长公共前缀。", "inputFormat": "一行，一个字符串 $S$。", "outputFormat": "一行，一个整数，表示所求值。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $2\\le n\\le 500000$，且 $S$ 中均为小写字母。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] Difference", "background": "", "description": "Given a string $S$ of length $n$, let $T_i$ denote the suffix starting from its $i$-th character. Compute\n\n$$\\displaystyle \\sum_{1\\leqslant i<j\\leqslant n}\\operatorname{len}(T_i)+\\operatorname{len}(T_j)-2\\times\\operatorname{lcp}(T_i,T_j)$$\n\nwhere $\\text{len}(a)$ denotes the length of string $a$, and $\\text{lcp}(a,b)$ denotes the longest common prefix of strings $a$ and $b$.", "inputFormat": "One line, a string $S$.", "outputFormat": "One line, an integer representing the required value.", "hint": "#### Constraints\n\n- For $100\\%$ of the testdata, it is guaranteed that $2\\le n\\le 500000$, and all characters in $S$ are lowercase letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 差异", "background": "", "description": "给定一个长度为 $n$ 的字符串 $S$，令 $T_i$ 表示它从第 $i$ 个字符开始的后缀。求\n\n$$\\displaystyle \\sum_{1\\leqslant i<j\\leqslant n}\\operatorname{len}(T_i)+\\operatorname{len}(T_j)-2\\times\\operatorname{lcp}(T_i,T_j)$$\n\n其中，$\\text{len}(a)$ 表示字符串 $a$ 的长度，$\\text{lcp}(a,b)$ 表示字符串 $a$ 和字符串 $b$ 的最长公共前缀。", "inputFormat": "一行，一个字符串 $S$。", "outputFormat": "一行，一个整数，表示所求值。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $2\\le n\\le 500000$，且 $S$ 中均为小写字母。", "locale": "zh-CN"}}}
{"pid": "P4249", "type": "P", "difficulty": 7, "samples": [["3\n0 1 2\n0 0 2\n2 2 0\n", "1\n0 1 0\n0 0 1\n1 0 0\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["图论", "2007", "Special Judge", "O2优化", "图论建模", "费用流", "差分", "WC"], "title": "[WC2007] 剪刀石头布", "background": "", "description": "在一些一对一游戏的比赛（如下棋、乒乓球和羽毛球的单打）中，我们经常会遇到 $A$ 胜过 $B$，$B$ 胜过 $C$ 而 $C$ 又胜过 $A$ 的有趣情况，不妨形象的称之为剪刀石头布情况。有的时候，无聊的人们会津津乐道于统计有多少这样的剪刀石头布情况发生，即有多少对无序三元组 $(A,B,C)$，满足其中的一个人在比赛中赢了另一个人，另一个人赢了第三个人而第三个人又胜过了第一个人。注意这里无序的意思是说三元组中元素的顺序并不重要，将 $(A, B, C)$、$(A, C, B)$、$(B, A, C)$、$(B, C, A)$、$(C, A, B)$ 和 $(C, B, A)$ 视为相同的情况。\n\n有 $N$ 个人参加一场这样的游戏的比赛，赛程规定任意两个人之间都要进行一场比赛：这样总共有 $\\frac{N*(N-1)}{2}$ 场比赛。比赛已经进行了一部分，我们想知道在极端情况下，比赛结束后最多会发生多少剪刀石头布情况。即给出已经发生的比赛结果，而你可以任意安排剩下的比赛的结果，以得到尽量多的剪刀石头布情况。\n", "inputFormat": "输入文件的第 $1$ 行是一个整数 $N$，表示参加比赛的人数。\n\n之后是一个 $N$ 行 $N$ 列的数字矩阵：一共 $N$ 行，每行 $N$ 列，数字间用空格隔开。\n\n在第 $(i+1)$ 行的第 $j$ 列的数字如果是 $1$，则表示 $i$ 在已经发生的比赛中赢了 $j$；该数字若是 $0$，则表示在已经发生的比赛中 $i$ 败于 $j$；该数字是\n $2$，表示 $i$ 和 $j$ 之间的比赛尚未发生。数字矩阵对角线上的数字，即第 $(i+1)$ 行第 $i$ 列的数字都是 $0$，它们仅仅是占位符号，没有任何意义。\n\n输入文件保证合法，不会发生矛盾，当 $i \\neq j$ 时，第 $(i+1)$ 行第 $j$ 列和第 $(j+1)$ 行第 $i$ 列的两个数字要么都是 $2$，要么一个是 $0$ 一个是 $1$。\n", "outputFormat": "输出文件的第 $1$ 行是一个整数，表示在你安排的比赛结果中，出现了多少剪刀石头布情况。\n\n输出文件的第 $2$  行开始有一个和输入文件中格式相同的 $N$ 行 $N$ 列的数字矩阵。第 $(i+1)$ 行第 $j$ 个数字描述了 $i$ 和 $j$ 之间的比赛结果，$1$ 表示 $i$ 赢了 $j$，$0$ 表示 $i$ 负于 $j$，与输入矩阵不同的是，在这个矩阵中没有表示比赛尚未进行的数字 $2$；对角线上的数字都是 $0$。输出矩阵要保证合法，不能发生矛盾。\n", "hint": "### 【评分标准】\n对于每个测试点，仅当你的程序的输出第一行的数字和标准答案一致，且给出了一个与之一致的合法方案，你才能得到该测试点的满分，否则该测试点得 $0$ 分。\n### 【数据范围】\n$30\\%$ 的数据中，$N \\leq 6$；\n\n$100\\%$ 的数据中，$N \\leq 100$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[WC2007] Rock-Paper-Scissors", "background": "", "description": "In some one-on-one game competitions (such as chess, table tennis, and badminton singles), we often encounter the interesting situation where $A$ beats $B$, $B$ beats $C$, and $C$ beats $A$. Let us vividly call this the rock-paper-scissors situation. Sometimes, people will enthusiastically count how many such rock-paper-scissors situations occur, that is, how many unordered triples $(A, B, C)$ satisfy that one person beats another, the second beats the third, and the third beats the first. Note that unordered means the order of elements in the triple does not matter, and $(A, B, C)$, $(A, C, B)$, $(B, A, C)$, $(B, C, A)$, $(C, A, B)$, and $(C, B, A)$ are regarded as the same situation.\n\nThere are $N$ people participating in such a competition. The schedule requires that every pair of people plays exactly one match, so there are a total of $\\frac{N*(N-1)}{2}$ matches. Some matches have already been played. We want to know, in the extreme case, what is the maximum possible number of rock-paper-scissors situations after all matches are completed. That is, given the results of the matches that have already taken place, you may assign the outcomes of the remaining matches arbitrarily to obtain as many rock-paper-scissors situations as possible.", "inputFormat": "The first line contains an integer $N$, the number of participants.\n\nThen follows an $N$-by-$N$ numeric matrix: $N$ rows, each with $N$ columns, and numbers separated by spaces.\n\nIn row $(i+1)$ and column $j$, if the number is $1$, it means $i$ has already beaten $j$; if the number is $0$, it means $i$ has already lost to $j$; if the number is $2$, it means the match between $i$ and $j$ has not yet taken place. The numbers on the diagonal, i.e., the number in row $(i+1)$ and column $i$, are all $0$. They are merely placeholders and have no meaning.\n\nThe input is guaranteed to be valid and without contradictions. When $i \\neq j$, the two numbers at row $(i+1)$, column $j$ and row $(j+1)$, column $i$ are either both $2$, or one is $0$ and the other is $1$.", "outputFormat": "The first line contains an integer, indicating how many rock-paper-scissors situations occur in your arranged set of match results.\n\nStarting from line $2$, output an $N$-by-$N$ numeric matrix in the same format as the input. The number in row $(i+1)$ and column $j$ describes the result of the match between $i$ and $j$: $1$ means $i$ beats $j$, and $0$ means $i$ loses to $j$. Unlike the input matrix, there is no number $2$ indicating an unplayed match; the diagonal numbers are all $0$. The output matrix must be valid and free of contradictions.", "hint": "- Scoring criteria:\n  For each test point, you will receive full credit only if the first line of your output matches the standard answer and you provide a valid arrangement consistent with it. Otherwise, you will receive $0$ points for that test point.\n- Constraints:\n  For $30\\%$ of the testdata, $N \\leq 6$.\n  For $100\\%$ of the testdata, $N \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2007] 剪刀石头布", "background": "", "description": "在一些一对一游戏的比赛（如下棋、乒乓球和羽毛球的单打）中，我们经常会遇到 $A$ 胜过 $B$，$B$ 胜过 $C$ 而 $C$ 又胜过 $A$ 的有趣情况，不妨形象的称之为剪刀石头布情况。有的时候，无聊的人们会津津乐道于统计有多少这样的剪刀石头布情况发生，即有多少对无序三元组 $(A,B,C)$，满足其中的一个人在比赛中赢了另一个人，另一个人赢了第三个人而第三个人又胜过了第一个人。注意这里无序的意思是说三元组中元素的顺序并不重要，将 $(A, B, C)$、$(A, C, B)$、$(B, A, C)$、$(B, C, A)$、$(C, A, B)$ 和 $(C, B, A)$ 视为相同的情况。\n\n有 $N$ 个人参加一场这样的游戏的比赛，赛程规定任意两个人之间都要进行一场比赛：这样总共有 $\\frac{N*(N-1)}{2}$ 场比赛。比赛已经进行了一部分，我们想知道在极端情况下，比赛结束后最多会发生多少剪刀石头布情况。即给出已经发生的比赛结果，而你可以任意安排剩下的比赛的结果，以得到尽量多的剪刀石头布情况。\n", "inputFormat": "输入文件的第 $1$ 行是一个整数 $N$，表示参加比赛的人数。\n\n之后是一个 $N$ 行 $N$ 列的数字矩阵：一共 $N$ 行，每行 $N$ 列，数字间用空格隔开。\n\n在第 $(i+1)$ 行的第 $j$ 列的数字如果是 $1$，则表示 $i$ 在已经发生的比赛中赢了 $j$；该数字若是 $0$，则表示在已经发生的比赛中 $i$ 败于 $j$；该数字是\n $2$，表示 $i$ 和 $j$ 之间的比赛尚未发生。数字矩阵对角线上的数字，即第 $(i+1)$ 行第 $i$ 列的数字都是 $0$，它们仅仅是占位符号，没有任何意义。\n\n输入文件保证合法，不会发生矛盾，当 $i \\neq j$ 时，第 $(i+1)$ 行第 $j$ 列和第 $(j+1)$ 行第 $i$ 列的两个数字要么都是 $2$，要么一个是 $0$ 一个是 $1$。\n", "outputFormat": "输出文件的第 $1$ 行是一个整数，表示在你安排的比赛结果中，出现了多少剪刀石头布情况。\n\n输出文件的第 $2$  行开始有一个和输入文件中格式相同的 $N$ 行 $N$ 列的数字矩阵。第 $(i+1)$ 行第 $j$ 个数字描述了 $i$ 和 $j$ 之间的比赛结果，$1$ 表示 $i$ 赢了 $j$，$0$ 表示 $i$ 负于 $j$，与输入矩阵不同的是，在这个矩阵中没有表示比赛尚未进行的数字 $2$；对角线上的数字都是 $0$。输出矩阵要保证合法，不能发生矛盾。\n", "hint": "### 【评分标准】\n对于每个测试点，仅当你的程序的输出第一行的数字和标准答案一致，且给出了一个与之一致的合法方案，你才能得到该测试点的满分，否则该测试点得 $0$ 分。\n### 【数据范围】\n$30\\%$ 的数据中，$N \\leq 6$；\n\n$100\\%$ 的数据中，$N \\leq 100$。\n", "locale": "zh-CN"}}}
{"pid": "P4250", "type": "P", "difficulty": 7, "samples": [["5\n1 8\n0 7\n0 0\n8 0\n8 8\n", "0.6316"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2015", "四川", "各省省选", "半平面交"], "title": "[SCOI2015] 小凸想跑步", "background": "", "description": "小凸晚上喜欢到操场跑步，今天他跑完两圈之后，他玩起了这样一个游戏。\n\n操场是个凸 $n$ 边形， $n$ 个顶点按照逆时针从 $0$ ∼ $n - 1$ 编号。现在小凸随机站在操场中的某个位置，标记为 $p$ 点。将 $p$ 点与 $n$ 个顶点各连一条边，形成 $n$ 个三角形。如果这时 $p$ 点， $0$ 号点， $1$ 号点形成的三角形的面\n积是 $n$ 个三角形中最小的一个，小凸则认为这是一次正确站位。\n\n现在小凸想知道他一次站位正确的概率是多少。", "inputFormat": "第 $1$ 行包含 $1$ 个整数 $n$, 表示操场的顶点数和游戏的次数。\n\n接下来有 $n$ 行，每行包含 $2$ 个整数 $x_i, y_i$，表示顶点的坐标。\n\n输入保证按逆时针顺序输入点，所有点保证构成一个凸多边形。所有点保证不存在三点共线。", "outputFormat": "输出 $1$ 个数，正确站位的概率，保留 $4$ 位小数。", "hint": "对于 $30$% 的数据， $3 \\leq n \\leq 4, 0 \\leq x, y \\leq 10$\n\n对于 $100$% 的数据， $3 \\leq n \\leq 10^5, -10^9 \\leq x, y \\leq 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2015] Xiao Tu Wants to Run", "background": "", "description": "Xiao Tu (pinyin: Xiao Tu) likes running on the track at night. After finishing two laps today, he started the following game.\n\nThe track is a convex $n$-gon whose $n$ vertices are numbered in counterclockwise order from $0$ to $n - 1$. Now Xiao Tu stands uniformly at random at some point inside the track, denoted as point $p$. Connect point $p$ to all $n$ vertices to form $n$ triangles (i.e., triangles $(p, i, i + 1)$ for all $i$, with indices modulo $n$). If the triangle formed by $p$, vertex $0$, and vertex $1$ has the smallest area among these $n$ triangles, Xiao Tu considers this a correct placement.\n\nNow Xiao Tu wants to know the probability that a single placement is correct.", "inputFormat": "The first line contains an integer $n$, the number of vertices of the track.\n\nThe next $n$ lines each contain two integers $x_i, y_i$, the coordinates of the vertices.\n\nThe input guarantees that the vertices are given in counterclockwise order, they form a convex polygon, and no three points are collinear.", "outputFormat": "Output a single number: the probability of a correct placement, rounded to $4$ decimal places.", "hint": "For $30\\%$ of the testdata, $3 \\le n \\le 4$, $0 \\le x, y \\le 10$.\n\nFor $100\\%$ of the testdata, $3 \\le n \\le 10^5$, $-10^9 \\le x, y \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2015] 小凸想跑步", "background": "", "description": "小凸晚上喜欢到操场跑步，今天他跑完两圈之后，他玩起了这样一个游戏。\n\n操场是个凸 $n$ 边形， $n$ 个顶点按照逆时针从 $0$ ∼ $n - 1$ 编号。现在小凸随机站在操场中的某个位置，标记为 $p$ 点。将 $p$ 点与 $n$ 个顶点各连一条边，形成 $n$ 个三角形。如果这时 $p$ 点， $0$ 号点， $1$ 号点形成的三角形的面\n积是 $n$ 个三角形中最小的一个，小凸则认为这是一次正确站位。\n\n现在小凸想知道他一次站位正确的概率是多少。", "inputFormat": "第 $1$ 行包含 $1$ 个整数 $n$, 表示操场的顶点数和游戏的次数。\n\n接下来有 $n$ 行，每行包含 $2$ 个整数 $x_i, y_i$，表示顶点的坐标。\n\n输入保证按逆时针顺序输入点，所有点保证构成一个凸多边形。所有点保证不存在三点共线。", "outputFormat": "输出 $1$ 个数，正确站位的概率，保留 $4$ 位小数。", "hint": "对于 $30$% 的数据， $3 \\leq n \\leq 4, 0 \\leq x, y \\leq 10$\n\n对于 $100$% 的数据， $3 \\leq n \\leq 10^5, -10^9 \\leq x, y \\leq 10^9$", "locale": "zh-CN"}}}
{"pid": "P4251", "type": "P", "difficulty": 6, "samples": [["2 3 1\n1 2 4\n2 4 1", "1"], ["3 4 2\n1 5 6 6\n8 3 4 3\n6 8 6 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "四川", "二分", "各省省选", "网络流", "二分图"], "title": "[SCOI2015] 小凸玩矩阵", "background": "", "description": "小凸和小方是好朋友，小方给了小凸一个 $n$ × $m$ $(n \\leq m)$ 的矩阵 $A$，并且要求小凸从矩阵中选出 $n$ 个数，其中任意两个数都不能在同一行或者同一列。现在小凸想知道，选出的 $n$ 个数中第 $k$ 大的数的最小值是多少。", "inputFormat": "第 $1$ 行读入 $3$ 个整数 $n, m, k$。\n\n接下来 $n$ 行，每一行有 $m$ 个数字，第 $i$ 行第 $j$ 个数字代表矩阵中第 $i$ 行第 $j$ 列的元素 $A_{i,j}$。", "outputFormat": "输出包含一行，为选出的 $n$ 个数中第 $k$ 大数的最小值。", "hint": "对于 $20$% 的数据， $1 \\leq n \\leq m \\leq 9$\n\n对于 $40$% 的数据， $1 \\leq n \\leq m \\leq 22, 1 \\leq n \\leq 12$\n\n对于 $100$% 的数据， $1 \\leq k \\leq n \\leq m \\leq 250, 1 \\leq A_{i,j} \\leq 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2015] Xiao Tu Plays with Matrices", "background": "", "description": "Xiao Tu and Xiao Fang are good friends. Xiao Fang gave Xiao Tu an $n \\times m$ ($n \\leq m$) matrix $A$, and asks Xiao Tu to choose $n$ numbers from the matrix such that no two chosen numbers are in the same row or the same column. Now Xiao Tu wants to know the minimum possible value of the $k$-th largest number among the $n$ chosen numbers.", "inputFormat": "The first line contains 3 integers $n$, $m$, $k$.\n\nThen follow $n$ lines, each containing $m$ numbers. In the $i$-th line, the $j$-th number denotes the element $A_{i,j}$ at row $i$ and column $j$ of the matrix.", "outputFormat": "Output one line: the minimum possible value of the $k$-th largest number among the $n$ chosen numbers.", "hint": "For $20$% of the testdata, $1 \\leq n \\leq m \\leq 9$.\n\nFor $40$% of the testdata, $1 \\leq n \\leq m \\leq 22$, $1 \\leq n \\leq 12$.\n\nFor $100$% of the testdata, $1 \\leq k \\leq n \\leq m \\leq 250$, $1 \\leq A_{i,j} \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2015] 小凸玩矩阵", "background": "", "description": "小凸和小方是好朋友，小方给了小凸一个 $n$ × $m$ $(n \\leq m)$ 的矩阵 $A$，并且要求小凸从矩阵中选出 $n$ 个数，其中任意两个数都不能在同一行或者同一列。现在小凸想知道，选出的 $n$ 个数中第 $k$ 大的数的最小值是多少。", "inputFormat": "第 $1$ 行读入 $3$ 个整数 $n, m, k$。\n\n接下来 $n$ 行，每一行有 $m$ 个数字，第 $i$ 行第 $j$ 个数字代表矩阵中第 $i$ 行第 $j$ 列的元素 $A_{i,j}$。", "outputFormat": "输出包含一行，为选出的 $n$ 个数中第 $k$ 大数的最小值。", "hint": "对于 $20$% 的数据， $1 \\leq n \\leq m \\leq 9$\n\n对于 $40$% 的数据， $1 \\leq n \\leq m \\leq 22, 1 \\leq n \\leq 12$\n\n对于 $100$% 的数据， $1 \\leq k \\leq n \\leq m \\leq 250, 1 \\leq A_{i,j} \\leq 10^9$", "locale": "zh-CN"}}}
{"pid": "P4252", "type": "P", "difficulty": 7, "samples": [["5 5\n1 2\n3 2\n2 4\n2 5\n4 5\n", "4\n1\n2\n4\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2006", "NOI", "提交答案", "Special Judge", "O2优化"], "title": "[NOI2006] 聪明的导游", "background": "输入数据下载地址：\n\nhttps://pan.baidu.com/s/1jJX0E3c\n\n数据由1584432137提供。\n\nUpd on 2022.8.7：输入文件在附件。", "description": "小佳最近迷上了导游这个工作，一天到晚想着带游客参观各处的景点。正好 M 市在举行 NOI，来参观的人特别的多。不少朋友给小佳介绍了需要导游的人。\n\nM 市有$n$个著名的景点，小佳将这些景点从$1$至$n$编号。有一些景点之间存在双向的路。小佳可以让游客们在任何一个景点集合，然后带着他们参观，最后也可以在任何一个景点结束参观。不过，来参观的游客们都不愿去已经参观过的地方。所以，小佳不能带游客们经过同一个景点两次或两次以上。\n\n小佳希望你帮助他设计一个方案, 走可行的路线, 带游客们参观尽可能多的地方。", "inputFormat": "输入文件为 guide1.in~guide10.in，第一行为两个整数$n,m$，分别表示景点数和路的条数。接下来$m$行，每行两个整数$a,b$，表示景点$a$和景点$b$之间有一条双向路。", "outputFormat": "你需要将答案输出到 guide1.out~guide10.out 中，guide?.out 为对应 guide?.in\n\n的答案。输出的第一行为$p$，表示你能找到的路径所经过的景点个数。接下来$p$ 行，每行一个整数，按顺序表示你所找到的路径上的每一个景点。", "hint": "【说明】\n\n这是一道提交答案式的题目，你不需要提供任何源代码，只需要将自己的输出文件放在与*.in 同一个目录即可。\n\n【样例说明】\t\t\t\t\n题目可能有多解，该样例有 4 个解，你只需输出其中任何一个解。\n\n::cute-table{tuack}\n\n|解 $1$|解 $2$|解 $3$|解 $4$|\n| :----------: | :----------: | :----------: | :----------: |\n|4  |4  |4  |4  |\n|1  |1  |3  |3  |\n|2  |2  |2  |2  |\n|4  |5  |4  |5  |\n|5  |4  |5  |4  |\n\n【评分方法】\n\n你的评分将由你的答案与标准答案之间的差异来给定。设你的答案正确且参观的景点数为 $x$，我们所给出的结果为 $\\mathit{ans}$，则按下表计算你的得分：\n\n::cute-table{tuack}\n\n|得分|条件|得分|条件|\n| :-----------: | :-----------: | :-----------: | :-----------: |\n|$12$  |$x>ans$  |$5$  |$x \\leq ans \\times 0.93$  |\n|$10$  |$x=ans$  |$4$  |$x \\leq ans \\times 0.9$  |\n|$9$  |$x \\leq ans-1$  |$3$  |$x \\leq ans \\times 0.8$  |\n|$8$  |$x \\leq ans-2$  |$2$  |$x \\leq ans \\times 0.7$  |\n|$7$  |$x \\leq ans-3$  |$1$  |$x \\leq ans \\times 0.5$  |\n|$6$  |$x \\leq ans \\times 0.95$  |$0$  |$x \\leq ans < 0.5$  |\n\n如果有多项满足，则取满足条件中的最高得分。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2006] Smart Tour Guide", "background": "Input testdata download link:\nhttps://pan.baidu.com/s/1jJX0E3c\n\nTestdata provided by 1584432137.\n\nUpdated on 2022-08-07: The input files are in the attachments.", "description": "Xiao Jia recently became obsessed with being a tour guide and keeps thinking about taking tourists to visit various scenic spots. It so happens that NOI is being held in M City, and there are many visitors. Many friends introduced people who need a tour guide to Xiao Jia.\n\nThere are $n$ famous scenic spots in M City, numbered from $1$ to $n$. Some pairs of scenic spots are connected by bidirectional roads. Xiao Jia can gather the tourists at any scenic spot to start the tour and can also end the tour at any scenic spot. However, the tourists do not want to visit a place they have already visited. Therefore, Xiao Jia cannot pass through the same scenic spot more than once.\n\nXiao Jia hopes you can help design a plan: choose a feasible route that visits as many scenic spots as possible.", "inputFormat": "The input files are guide1.in ~ guide10.in. The first line contains two integers $n, m$, the number of scenic spots and the number of roads. The next $m$ lines each contain two integers $a, b$, indicating there is a bidirectional road between scenic spot $a$ and scenic spot $b$.", "outputFormat": "You need to write the answers to guide1.out ~ guide10.out, where guide?.out is the answer corresponding to guide?.in. The first line outputs $p$, the number of scenic spots on your path. Then output $p$ lines, each containing one integer, in order, representing each scenic spot on your path.", "hint": "[Explanation]\nThis is an output-only problem. You do not need to submit any source code; just place your output files in the same directory as the corresponding *.in files.\n\n[Sample Explanation]\nThe problem may have multiple correct answers. This sample has 4 solutions. You only need to output any one of them.\n\n::cute-table{tuack}\n\n|Solution $1$|Solution $2$|Solution $3$|Solution $4$|\n| :----------: | :----------: | :----------: | :----------: |\n|4  |4  |4  |4  |\n|1  |1  |3  |3  |\n|2  |2  |2  |2  |\n|4  |5  |4  |5  |\n|5  |4  |5  |4  |\n\n[Scoring Method]\nYour score is determined by the difference between your answer and the official answer. Suppose your answer is correct and the number of scenic spots visited is $x$, and our result is $\\mathit{ans}$. Then your score is computed as follows:\n\n::cute-table{tuack}\n\n|Score|Condition|Score|Condition|\n| :-----------: | :-----------: | :-----------: | :-----------: |\n|$12$  |$x > ans$  |$5$  |$x \\leq ans \\times 0.93$  |\n|$10$  |$x = ans$  |$4$  |$x \\leq ans \\times 0.9$  |\n|$9$  |$x \\leq ans - 1$  |$3$  |$x \\leq ans \\times 0.8$  |\n|$8$  |$x \\leq ans - 2$  |$2$  |$x \\leq ans \\times 0.7$  |\n|$7$  |$x \\leq ans - 3$  |$1$  |$x \\leq ans \\times 0.5$  |\n|$6$  |$x \\leq ans \\times 0.95$  |$0$  |$x \\leq ans \\times 0.5$  |\n\nIf multiple conditions are satisfied, take the highest score.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2006] 聪明的导游", "background": "输入数据下载地址：\n\nhttps://pan.baidu.com/s/1jJX0E3c\n\n数据由1584432137提供。\n\nUpd on 2022.8.7：输入文件在附件。", "description": "小佳最近迷上了导游这个工作，一天到晚想着带游客参观各处的景点。正好 M 市在举行 NOI，来参观的人特别的多。不少朋友给小佳介绍了需要导游的人。\n\nM 市有$n$个著名的景点，小佳将这些景点从$1$至$n$编号。有一些景点之间存在双向的路。小佳可以让游客们在任何一个景点集合，然后带着他们参观，最后也可以在任何一个景点结束参观。不过，来参观的游客们都不愿去已经参观过的地方。所以，小佳不能带游客们经过同一个景点两次或两次以上。\n\n小佳希望你帮助他设计一个方案, 走可行的路线, 带游客们参观尽可能多的地方。", "inputFormat": "输入文件为 guide1.in~guide10.in，第一行为两个整数$n,m$，分别表示景点数和路的条数。接下来$m$行，每行两个整数$a,b$，表示景点$a$和景点$b$之间有一条双向路。", "outputFormat": "你需要将答案输出到 guide1.out~guide10.out 中，guide?.out 为对应 guide?.in\n\n的答案。输出的第一行为$p$，表示你能找到的路径所经过的景点个数。接下来$p$ 行，每行一个整数，按顺序表示你所找到的路径上的每一个景点。", "hint": "【说明】\n\n这是一道提交答案式的题目，你不需要提供任何源代码，只需要将自己的输出文件放在与*.in 同一个目录即可。\n\n【样例说明】\t\t\t\t\n题目可能有多解，该样例有 4 个解，你只需输出其中任何一个解。\n\n::cute-table{tuack}\n\n|解 $1$|解 $2$|解 $3$|解 $4$|\n| :----------: | :----------: | :----------: | :----------: |\n|4  |4  |4  |4  |\n|1  |1  |3  |3  |\n|2  |2  |2  |2  |\n|4  |5  |4  |5  |\n|5  |4  |5  |4  |\n\n【评分方法】\n\n你的评分将由你的答案与标准答案之间的差异来给定。设你的答案正确且参观的景点数为 $x$，我们所给出的结果为 $\\mathit{ans}$，则按下表计算你的得分：\n\n::cute-table{tuack}\n\n|得分|条件|得分|条件|\n| :-----------: | :-----------: | :-----------: | :-----------: |\n|$12$  |$x>ans$  |$5$  |$x \\leq ans \\times 0.93$  |\n|$10$  |$x=ans$  |$4$  |$x \\leq ans \\times 0.9$  |\n|$9$  |$x \\leq ans-1$  |$3$  |$x \\leq ans \\times 0.8$  |\n|$8$  |$x \\leq ans-2$  |$2$  |$x \\leq ans \\times 0.7$  |\n|$7$  |$x \\leq ans-3$  |$1$  |$x \\leq ans \\times 0.5$  |\n|$6$  |$x \\leq ans \\times 0.95$  |$0$  |$x \\leq ans < 0.5$  |\n\n如果有多项满足，则取满足条件中的最高得分。", "locale": "zh-CN"}}}
{"pid": "P4253", "type": "P", "difficulty": 6, "samples": [["3\n5 1 2\n2 1\n", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2015", "四川", "各省省选", "树形 DP"], "title": "[SCOI2015] 小凸玩密室", "background": "", "description": "小凸和小方相约玩密室逃脱，这个密室是一棵有 $n$ 个节点的完全二叉树，每个节点有一个灯泡。点亮所有灯泡即可逃出密室。每个灯泡有个权值 $a_i$，每条边也有个权值 $b_i$。点亮第一个灯泡不需要花费，之后每点亮一个新的灯泡 $v$ 的花费，等于上一个被点亮的灯泡 $u$ 到这个点 $v$ 的距离 $D_{u,v}$，乘以这个点的权值 $a_v$。在点灯的过程中，要保证任意时刻所有被点亮的灯泡必须连通，在点亮一个灯泡后必须先点亮其子树所有灯泡才能点亮其他灯泡。请告诉他们，逃出密室的最少花费是多少。", "inputFormat": "第 $1$ 行包含 $1$ 个数 $n$，代表节点的个数\n\n第 $2$ 行包含 $n$ 个数，代表每个节点的权值 $a_i$。 $(i = 1, 2,$……$, n)$\n\n第 $3$ 行包含 $n - 1$ 个数，代表每条边的权值 $b_i$，第 $i$ 号边是由第 $(i+1)/2$ 号点连向第 $i + 1$ 号点的边。$(i = 1, 2,$……$, n - 1)$", "outputFormat": "输出包含 $1$ 个数，代表最少的花费。", "hint": "对于 $10$% 的数据， $1 \\leq n \\leq 10$\n\n对于 $20$% 的数据， $1 \\leq n \\leq 20$\n\n对于 $30$% 的数据， $1 \\leq n \\leq 2000$\n\n对于 $100$% 的数据， $1 \\leq n \\leq 2 \\times 10^5, 1 \\leq a_i, b_i \\leq 10^5$", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2015] Xiao Tu Plays the Escape Room", "background": "", "description": "Xiao Tu and Xiao Fang decide to play an escape room. The escape room is a complete binary tree with $n$ nodes, and each node has a light bulb. You can escape by lighting all bulbs. Each bulb has a weight $a_i$, and each edge has a weight $b_i$. Lighting the first bulb costs nothing. After that, lighting a new bulb $v$ costs $D_{u,v} \\times a_v$, where $u$ is the bulb lit immediately before and $D_{u,v}$ is the distance from $u$ to $v$ in the tree (the sum of edge weights along the path). During the process, at any time the lit bulbs must be connected. Moreover, once you light a bulb, you must finish lighting all bulbs in its subtree before you may light any bulb outside that subtree. Please tell them the minimum total cost to escape.", "inputFormat": "The first line contains one integer $n$, the number of nodes.\n\nThe second line contains $n$ integers, the weight $a_i$ of each node ($i = 1, 2, \\ldots, n$).\n\nThe third line contains $n - 1$ integers, the weight $b_i$ of each edge. The $i$-th edge connects node $\\left\\lfloor \\dfrac{i+1}{2} \\right\\rfloor$ to node $i + 1$ ($i = 1, 2, \\ldots, n - 1$).", "outputFormat": "Output one integer, the minimum total cost.", "hint": "For 10% of the testdata, $1 \\leq n \\leq 10$.\n\nFor 20% of the testdata, $1 \\leq n \\leq 20$.\n\nFor 30% of the testdata, $1 \\leq n \\leq 2000$.\n\nFor 100% of the testdata, $1 \\leq n \\leq 2 \\times 10^5$, $1 \\leq a_i, b_i \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2015] 小凸玩密室", "background": "", "description": "小凸和小方相约玩密室逃脱，这个密室是一棵有 $n$ 个节点的完全二叉树，每个节点有一个灯泡。点亮所有灯泡即可逃出密室。每个灯泡有个权值 $a_i$，每条边也有个权值 $b_i$。点亮第一个灯泡不需要花费，之后每点亮一个新的灯泡 $v$ 的花费，等于上一个被点亮的灯泡 $u$ 到这个点 $v$ 的距离 $D_{u,v}$，乘以这个点的权值 $a_v$。在点灯的过程中，要保证任意时刻所有被点亮的灯泡必须连通，在点亮一个灯泡后必须先点亮其子树所有灯泡才能点亮其他灯泡。请告诉他们，逃出密室的最少花费是多少。", "inputFormat": "第 $1$ 行包含 $1$ 个数 $n$，代表节点的个数\n\n第 $2$ 行包含 $n$ 个数，代表每个节点的权值 $a_i$。 $(i = 1, 2,$……$, n)$\n\n第 $3$ 行包含 $n - 1$ 个数，代表每条边的权值 $b_i$，第 $i$ 号边是由第 $(i+1)/2$ 号点连向第 $i + 1$ 号点的边。$(i = 1, 2,$……$, n - 1)$", "outputFormat": "输出包含 $1$ 个数，代表最少的花费。", "hint": "对于 $10$% 的数据， $1 \\leq n \\leq 10$\n\n对于 $20$% 的数据， $1 \\leq n \\leq 20$\n\n对于 $30$% 的数据， $1 \\leq n \\leq 2000$\n\n对于 $100$% 的数据， $1 \\leq n \\leq 2 \\times 10^5, 1 \\leq a_i, b_i \\leq 10^5$", "locale": "zh-CN"}}}
{"pid": "P4254", "type": "P", "difficulty": 6, "samples": [["10\nProject 5.10200 0.65000\nProject 2.76200 1.43000\nQuery 4\nQuery 2\nProject 3.80200 1.17000\nQuery 2\nQuery 3\nQuery 1\nProject 4.58200 0.91000\nProject 5.36200 0.39000", "0\n0\n0\n0\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "递归", "江苏", "李超线段树"], "title": "[JSOI2008] Blue Mary 开公司", "background": "Blue Mary 最近在筹备开一家自己的网络公司。由于他缺乏经济头脑，所以先后聘请了若干个金融顾问为他设计经营方案。", "description": "万事开头难，经营公司更是如此。开始的收益往往是很低的，不过随着时间的增长会慢慢变好。也就是说，**对于一个金融顾问 $i$，他设计的经营方案中，每天的收益都比前一天高，并且均增长一个相同的量 $P_i$。**\n\n由于金融顾问的工作效率不高，**所以在特定的时间，Blue Mary 只能根据他已经得到的经营方案来估算某一时间的最大收益**。由于 Blue Mary 是很没有经济头脑的，所以他在估算每天的最佳获益时完全不会考虑之前的情况，而是直接从所有金融顾问的方案中选择一个在当天获益最大的方案的当天的获益值，例如：\n\n有如下两个金融顾问分别对前四天的收益方案做了设计：\n\n|   | 第一天 | 第二天 | 第三天 | 第四天 | $P_i$ |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| 顾问 1 | $1$ | $5 $| $9$ | $13$ | $4$ |\n| 顾问 2 | $2$ | $5$ | $8$ | $11$ | $3$ |\n\n在第一天，Blue Mary 认为最大收益是 $2$（使用顾问 2 的方案），而在第三天和第四天，他认为最大收益分别是 $9$ 和 $13$（使用顾问 1 的方案）。而他认为前四天的最大收益是：$2 + 5 + 9 + 13 = 29$。\n\n现在你作为 Blue Mary 公司的副总经理，会不时收到金融顾问的设计方案，也需要随时回答 Blue Mary 对某天的“最大收益”的询问（这里的“最大收益”是按照 Blue Mary 的计算方法）。**一开始没有收到任何方案时，你可以认为每天的最大收益值是 0**。下面是一组收到方案和回答询问的例子：\n\n\n- 询问 $2$，回答 $0$。\n- 收到方案：$0\\ 1\\ 2\\ 3\\ 4\\ 5\\ \\cdots$\n- 询问 $2$，回答 $1$。\n- 收到方案：$2\\ 2.1\\ 2.2\\ 2.3\\ 2.4\\ \\cdots$\n- 询问 $2$，回答 $2.1$。", "inputFormat": "第一行 ：一个整数 $N$，表示方案和询问的总数。 \n\n接下来 $N$ 行，每行开头一个单词 `Query` 或 `Project`。 \n\n若单词为 `Query`，则后接一个整数 $T$，表示 Blue Mary 询问第 $T$ 天的最大收益。 \n\n若单词为 `Project`，则后接两个实数 $S, P$，表示该种设计方案第一天的收益 $S$，以及以后每天比上一天多出的收益 $P$。", "outputFormat": "对于每一个 `Query`，输出一个整数，表示询问的答案，并精确到整百元（以百元为单位，例如：该天最大收益为 $210$ 或 $290$ 时，均应该输出 $2$）。没有方案时回答询问要输出 $0$。", "hint": "**数据范围**\n\n$1 \\leq N \\leq 10 ^ 5$，$1 \\leq T \\leq 5\\times 10 ^ 4$，$0 < P < 100$，$|S| \\leq 10 ^ 5$。\n\n**提示**\n\n本题读写数据量可能相当巨大，请选手注意选择高效的文件读写方式。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2008] Blue Mary Starts a Company", "background": "Blue Mary is preparing to start her own Internet company. Since she lacks financial sense, she has successively hired several financial consultants to design business plans for her.", "description": "Starting is hard, and running a company is even harder. Initial profits are usually low, but they gradually improve over time. That is, for a financial consultant $i$, in the plan they design, each day's profit is higher than the previous day by the same amount $P_i$.\n\nBecause the consultants are not very efficient, at any particular time Blue Mary can only estimate the maximum profit for some day based on the plans she has already received. Since Blue Mary has little financial sense, when estimating the best profit for each day she does not consider the past at all, and simply chooses, among all consultants' plans, the profit of the plan that gives the largest profit on that day. For example:\n\nTwo consultants have designed profit plans for the first four days as follows:\n\n|   | Day 1 | Day 2 | Day 3 | Day 4 | $P_i$ |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| Consultant 1 | $1$ | $5$ | $9$ | $13$ | $4$ |\n| Consultant 2 | $2$ | $5$ | $8$ | $11$ | $3$ |\n\nOn Day 1, Blue Mary believes the maximum profit is $2$ (using Consultant 2's plan), and on Days 3 and 4 she believes the maximum profits are $9$ and $13$, respectively (using Consultant 1's plan). She believes the total maximum profit for the first four days is $2 + 5 + 9 + 13 = 29$.\n\nNow, as the deputy general manager of Blue Mary's company, you will occasionally receive consultants' plans and must also answer Blue Mary's queries for the \"maximum profit\" on some day (the \"maximum profit\" is computed according to Blue Mary's method). Initially, when no plan has been received, you may assume the maximum profit for every day is $0$. Here is an example of received plans and answered queries:\n\n- Query $2$, answer $0$.\n- Receive plan: $0\\ 1\\ 2\\ 3\\ 4\\ 5\\ \\cdots$.\n- Query $2$, answer $1$.\n- Receive plan: $2\\ 2.1\\ 2.2\\ 2.3\\ 2.4\\ \\cdots$.\n- Query $2$, answer $2.1$.", "inputFormat": "The first line contains an integer $N$, the total number of plans and queries.\n\nThe next $N$ lines each begin with a word `Query` or `Project`.\n\nIf the word is `Query`, it is followed by an integer $T$, meaning Blue Mary asks for the maximum profit on Day $T$.\n\nIf the word is `Project`, it is followed by two real numbers $S, P$, meaning that in this plan the profit on Day 1 is $S$, and afterwards each day's profit is greater than the previous day's by $P$.", "outputFormat": "For each `Query`, output one integer, reported in hundreds of yuan (i.e., in units of 100 yuan; for example, if the maximum profit on that day is $210$ or $290$, you should output $2$). When there is no plan, output $0$ for the query.", "hint": "Constraints\n\n$1 \\leq N \\leq 10^5$, $1 \\leq T \\leq 5 \\times 10^4$, $0 < P < 100$, $|S| \\leq 10^5$.\n\nHint\n\nThe amount of input and output may be quite large. Please use fast I/O methods.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2008] Blue Mary 开公司", "background": "Blue Mary 最近在筹备开一家自己的网络公司。由于他缺乏经济头脑，所以先后聘请了若干个金融顾问为他设计经营方案。", "description": "万事开头难，经营公司更是如此。开始的收益往往是很低的，不过随着时间的增长会慢慢变好。也就是说，**对于一个金融顾问 $i$，他设计的经营方案中，每天的收益都比前一天高，并且均增长一个相同的量 $P_i$。**\n\n由于金融顾问的工作效率不高，**所以在特定的时间，Blue Mary 只能根据他已经得到的经营方案来估算某一时间的最大收益**。由于 Blue Mary 是很没有经济头脑的，所以他在估算每天的最佳获益时完全不会考虑之前的情况，而是直接从所有金融顾问的方案中选择一个在当天获益最大的方案的当天的获益值，例如：\n\n有如下两个金融顾问分别对前四天的收益方案做了设计：\n\n|   | 第一天 | 第二天 | 第三天 | 第四天 | $P_i$ |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| 顾问 1 | $1$ | $5 $| $9$ | $13$ | $4$ |\n| 顾问 2 | $2$ | $5$ | $8$ | $11$ | $3$ |\n\n在第一天，Blue Mary 认为最大收益是 $2$（使用顾问 2 的方案），而在第三天和第四天，他认为最大收益分别是 $9$ 和 $13$（使用顾问 1 的方案）。而他认为前四天的最大收益是：$2 + 5 + 9 + 13 = 29$。\n\n现在你作为 Blue Mary 公司的副总经理，会不时收到金融顾问的设计方案，也需要随时回答 Blue Mary 对某天的“最大收益”的询问（这里的“最大收益”是按照 Blue Mary 的计算方法）。**一开始没有收到任何方案时，你可以认为每天的最大收益值是 0**。下面是一组收到方案和回答询问的例子：\n\n\n- 询问 $2$，回答 $0$。\n- 收到方案：$0\\ 1\\ 2\\ 3\\ 4\\ 5\\ \\cdots$\n- 询问 $2$，回答 $1$。\n- 收到方案：$2\\ 2.1\\ 2.2\\ 2.3\\ 2.4\\ \\cdots$\n- 询问 $2$，回答 $2.1$。", "inputFormat": "第一行 ：一个整数 $N$，表示方案和询问的总数。 \n\n接下来 $N$ 行，每行开头一个单词 `Query` 或 `Project`。 \n\n若单词为 `Query`，则后接一个整数 $T$，表示 Blue Mary 询问第 $T$ 天的最大收益。 \n\n若单词为 `Project`，则后接两个实数 $S, P$，表示该种设计方案第一天的收益 $S$，以及以后每天比上一天多出的收益 $P$。", "outputFormat": "对于每一个 `Query`，输出一个整数，表示询问的答案，并精确到整百元（以百元为单位，例如：该天最大收益为 $210$ 或 $290$ 时，均应该输出 $2$）。没有方案时回答询问要输出 $0$。", "hint": "**数据范围**\n\n$1 \\leq N \\leq 10 ^ 5$，$1 \\leq T \\leq 5\\times 10 ^ 4$，$0 < P < 100$，$|S| \\leq 10 ^ 5$。\n\n**提示**\n\n本题读写数据量可能相当巨大，请选手注意选择高效的文件读写方式。", "locale": "zh-CN"}}}
{"pid": "P4255", "type": "P", "difficulty": 5, "samples": [["5 5 5\n5 1\n9 2\n8 1\n8 1\n6 2\n5 2\n1 2\n2 2\n1 1\n5 3\n1 1 3 2\n2 1\n3 3 4 1\n3 2 3 1\n3 1 2 1\n", "9293681\n15578602\n849742\n"]], "limits": {"time": [1300, 1300, 1300, 1300, 1300, 1300, 1300, 1300, 1300, 1300], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["并查集", "O2优化", "素数判断,质数,筛法", "逆元"], "title": "公主の#18文明游戏", "background": "公主发现了一个游戏，998，于是我就花钱给她买下来了（捂脸）", "description": "这个游戏叫做《文♂明》（滑稽），但是跟平常意义上的不一样。\n\n这个游戏里有 $n$ 个城市，标号 $1 \\sim n$ ，有 $m$ 条双向道路相连，编号 $1 \\sim m$。\n\n游戏里会系统会添加 $N_i$ 个人到一个城市 $X_i$，并给定这些人的信仰 $C_i$。\n\n系统还会切断一条道路，并给定道路编号 $X_i$。\n\n系统还会给定一个城市 $X_i$，询问从 $X_i$ 出发可以到达的所有城市中选择 $N_i$ 个人，使得他们信仰都为 $C_i$ 的概率为多少，对 $19260817$ 取模。\n\n输入数据不保证没有重边和自环。\n\n输入数据不保证同一条边不会被切断两次以上。\n\n因为是公主的游戏，所以本题输入量较大，请注意输入的优化。", "inputFormat": "第一行三个正整数 $n$, $m$, $q$。\n\n接下来 $n$ 行，每行两个正整数 $N_i$, $C_i$，分别代表第 $i$ 个城市初始人数和信仰。\n\n接下来 $m$ 行，每行两个正整数 $X_i$， $Y_i$，分别代表这条道路的起点和终点。\n\n接下来 $q$ 行，每行第一个正整数 $opt$ $(1 \\leq opt \\leq 3)$。\n\n当 $opt=1$ 时，表示系统添加人类，输入三个整数 $X_i$, $N_i$, $C_i$。\n\n当 $opt=2$ 时，表示系统切断道路，输入一个整数 $X_i$。\n\n当 $opt=3$ 时，表示系统询问概率，输入三个整数 $X_i$, $N_i$, $C_i$。", "outputFormat": "对于每一个 $opt=3$ 的操作，输出一行一个整数。", "hint": "吐槽某人居然没告诉我 我没放样例\n\n补发样例（其实我本来有样例来着）\n\n在这里跟大家道歉\n\n对于30%的数据，$1 \\leq n,m,q \\leq 100$\n\n对于60%的数据，$1 \\leq n,m,q \\leq 50000$\n\n对于100%的数据，$1 \\leq n,m,q \\leq400000$\n\n对于100%的数据，保证所有信仰在 C++ 的 int，Pascal 的 long int 范围内\n\n对于 $100\\%$ 的数据，保证每次添加的人数和初始人数都不超过 $10$\n\n对于 $100\\%$ 的数据，保证数据随机生成\n\n题目 @玫葵之蝶", "locale": "zh-CN", "translations": {"en": {"title": "Princess’s #18 Civilization Game", "background": "The princess found a game priced at 998, so I paid to buy it for her (facepalm).", "description": "This game is called “Civil♂ization” (just for laughs), but it’s not the same as the usual meaning.\n\nThere are $n$ cities in the game, numbered $1 \\sim n$, connected by $m$ undirected roads, numbered $1 \\sim m$.\n\nThe system may add $N_i$ people to a city $X_i$, and assign these people the belief $C_i$.\n\nThe system may also cut a road, given by its road ID $X_i$.\n\nThe system may also give a city $X_i$ and ask: among all cities reachable from $X_i$, if we select $N_i$ people, what is the probability that all of them have belief $C_i$, modulo $19260817$.\n\nThe input data are not guaranteed to be free of multiple edges and self-loops.\n\nThe input data are not guaranteed that the same edge will not be cut more than twice.\n\nBecause it is the princess’s game, the input size is large. Please optimize input/output.", "inputFormat": "The first line contains three positive integers $n, m, q$.\n\nThe next $n$ lines each contain two positive integers $N_i, C_i$, representing the initial population and belief of city $i$.\n\nThe next $m$ lines each contain two positive integers $X_i, Y_i$, representing the endpoints of a road.\n\nThe next $q$ lines each begin with a positive integer $opt$ $(1 \\leq opt \\leq 3)$.\n\n- If $opt = 1$, the system adds people: input three integers $X_i, N_i, C_i$.\n- If $opt = 2$, the system cuts a road: input one integer $X_i$.\n- If $opt = 3$, the system asks for a probability: input three integers $X_i, N_i, C_i$.", "outputFormat": "For each operation with $opt = 3$, output one line with one integer.", "hint": "Complaining that someone didn’t tell me I forgot to include a sample.\n\nSupplementing a sample (I actually had one).\n\nApologies to everyone.\n\nConstraints:\n- For $30\\%$ of the testdata, $1 \\leq n, m, q \\leq 100$.\n- For $60\\%$ of the testdata, $1 \\leq n, m, q \\leq 50000$.\n- For $100\\%$ of the testdata, $1 \\leq n, m, q \\leq 400000$.\n- For $100\\%$ of the testdata, all beliefs fit within C++ int and Pascal long int.\n- For $100\\%$ of the testdata, each addition size and each initial population do not exceed $10$.\n- For $100\\%$ of the testdata, the testdata are randomly generated.\n\nProblem by @玫葵之蝶.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "公主の#18文明游戏", "background": "公主发现了一个游戏，998，于是我就花钱给她买下来了（捂脸）", "description": "这个游戏叫做《文♂明》（滑稽），但是跟平常意义上的不一样。\n\n这个游戏里有 $n$ 个城市，标号 $1 \\sim n$ ，有 $m$ 条双向道路相连，编号 $1 \\sim m$。\n\n游戏里会系统会添加 $N_i$ 个人到一个城市 $X_i$，并给定这些人的信仰 $C_i$。\n\n系统还会切断一条道路，并给定道路编号 $X_i$。\n\n系统还会给定一个城市 $X_i$，询问从 $X_i$ 出发可以到达的所有城市中选择 $N_i$ 个人，使得他们信仰都为 $C_i$ 的概率为多少，对 $19260817$ 取模。\n\n输入数据不保证没有重边和自环。\n\n输入数据不保证同一条边不会被切断两次以上。\n\n因为是公主的游戏，所以本题输入量较大，请注意输入的优化。", "inputFormat": "第一行三个正整数 $n$, $m$, $q$。\n\n接下来 $n$ 行，每行两个正整数 $N_i$, $C_i$，分别代表第 $i$ 个城市初始人数和信仰。\n\n接下来 $m$ 行，每行两个正整数 $X_i$， $Y_i$，分别代表这条道路的起点和终点。\n\n接下来 $q$ 行，每行第一个正整数 $opt$ $(1 \\leq opt \\leq 3)$。\n\n当 $opt=1$ 时，表示系统添加人类，输入三个整数 $X_i$, $N_i$, $C_i$。\n\n当 $opt=2$ 时，表示系统切断道路，输入一个整数 $X_i$。\n\n当 $opt=3$ 时，表示系统询问概率，输入三个整数 $X_i$, $N_i$, $C_i$。", "outputFormat": "对于每一个 $opt=3$ 的操作，输出一行一个整数。", "hint": "吐槽某人居然没告诉我 我没放样例\n\n补发样例（其实我本来有样例来着）\n\n在这里跟大家道歉\n\n对于30%的数据，$1 \\leq n,m,q \\leq 100$\n\n对于60%的数据，$1 \\leq n,m,q \\leq 50000$\n\n对于100%的数据，$1 \\leq n,m,q \\leq400000$\n\n对于100%的数据，保证所有信仰在 C++ 的 int，Pascal 的 long int 范围内\n\n对于 $100\\%$ 的数据，保证每次添加的人数和初始人数都不超过 $10$\n\n对于 $100\\%$ 的数据，保证数据随机生成\n\n题目 @玫葵之蝶", "locale": "zh-CN"}}}
{"pid": "P4256", "type": "P", "difficulty": 6, "samples": [["10 10\n42 68 35 1 70 25 79 59 63 65 \nL 2 6 28\nL 2 6 43\nG 2 7 5\nG 3 4 83\nL 7 9 96\nG 2 7 39\nS 3 8 100\nL 4 5 12\nG 4 4 65\nL 2 4 69", "0\n32\n1\n1\n75\n1\n1\n10\n1\n34"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "线段树", "O2优化", "素数判断,质数,筛法", "进制"], "title": "公主の#19准备月考", "background": "公主在玩完游戏后，也要月考了。（就算是公主也要月考啊QWQ）", "description": "公主的文综太差了，全校排名 $1100$+（全校就 $1100$ 多人），她分析了好久，发现她如果把所有时间放在选择题上，得分会比较好一点。\n\n文综题目共有 $n$ 个，编号从 $1$ 到 $n$。\n\n公主给每个题目算出来了一个预估值 $A_i$，她认为，一段连续题目的答案会在它们的预估值的 $\\gcd$ 和 $\\operatorname{lcm}$ 之间；有时候她的想法不同了，一些题目的预估值会改变；有时候，会出现多选题，多选题的答案数量就是一段连续题目答案的预估值的公约数的个数。\n\n具体来说，对于一个数列，有四种操作：\n\n- `L x y p`：表示公主询问区间 $[x,y]$ 的数字的 $\\operatorname{lcm}$ 对 $p$ 取模之后的值。\n\n- `G x y p`：表示公主询问区间 $[x,y]$ 的数字的 $\\gcd$ 对 $p$ 取模之后的值。\n\n- `C x y c`：表示公主改变区间 $[x,y]$ 的数字的值，统一改为 $c$。\n\n- `S x y p`：表示公主询问区间 $[x,y]$ 的数字的公因数个数对 $p$ 取模之后的值。\n\n公主月考不能挂科，不然她就不能学习 OI 了（假的），所以请你帮帮她吧！", "inputFormat": "第一行，两个正整数 $n$ 和 $q$，其中 $n$ 表示题目个数，$q$ 表示操作次数。\n\n第二行，$n$ 个正整数，表示公主对题目的预估值。\n\n接下来 $q$ 行，每行输入一个操作，格式详见题目描述。", "outputFormat": "对于每个询问，输出它的答案。", "hint": "对于 $30\\%$ 的数据，$1\\le n,q\\le 1000$。\n\n对于另外 $20\\%$ 的数据，$1\\le n\\le 1000，1\\le q\\le 10^5$。\n\n对于另外 $20\\%$ 的数据，$1\\le n\\le 10^5，1\\le q\\le 10^5$，保证没有修改操作。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 3\\times 10^5，1\\le q\\le 3\\times 10^5$。\n\n保证任何时刻每个题目的预估值都在 $[1,100]$ 之间，答案取模之后不超过 `int`。", "locale": "zh-CN", "translations": {"en": {"title": "Princess #19 Prepares for the Monthly Exam", "background": "After finishing her games, the princess still has to take the monthly exam. (Even a princess has monthly exams, QWQ.)", "description": "The princess is very weak in liberal arts comprehensive, ranking $1100+$ in the whole school (and the whole school has just over $1100$ students). After thinking for a long time, she found that if she puts all her time into multiple-choice questions, she can score a bit better.\n\nThere are $n$ questions in liberal arts, numbered from $1$ to $n$.\n\nThe princess computed an estimated value $A_i$ for each question. She believes that the answer for a contiguous block of questions will lie between the $\\gcd$ and $\\operatorname{lcm}$ of their estimated values. Sometimes her thoughts change, and some questions’ estimated values will change. Sometimes multiple-answer questions appear; the number of correct answers for such questions equals the number of common divisors of the estimated values over a contiguous block.\n\nSpecifically, for a sequence, there are four operations:\n\n- `L x y p`: Ask for the value of $\\operatorname{lcm}$ of numbers in the range $[x,y]$ modulo $p$.\n- `G x y p`: Ask for the value of $\\gcd$ of numbers in the range $[x,y]$ modulo $p$.\n- `C x y c`: Change all numbers in the range $[x,y]$ to $c$.\n- `S x y p`: Ask for the number of common divisors of the numbers in the range $[x,y]$, then take it modulo $p$.\n\nThe princess must not fail the monthly exam, or she won't be able to study OI (just kidding), so please help her!", "inputFormat": "The first line contains two positive integers $n$ and $q$, where $n$ is the number of questions and $q$ is the number of operations.\n\nThe second line contains $n$ positive integers, representing the princess’s estimated values for the questions.\n\nThe next $q$ lines each contain one operation; see the Description for the format.", "outputFormat": "For each query, output its answer.", "hint": "Constraints\n\n- For $30\\%$ of the testdata, $1 \\le n, q \\le 1000$.\n- For another $20\\%$ of the testdata, $1 \\le n \\le 1000$, $1 \\le q \\le 10^5$.\n- For another $20\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le q \\le 10^5$, and there are no update operations.\n- For $100\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^5$, $1 \\le q \\le 3 \\times 10^5$.\n\nAt any time, each question’s estimated value is in $[1, 100]$, and each answer after taking modulo fits in `int`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "公主の#19准备月考", "background": "公主在玩完游戏后，也要月考了。（就算是公主也要月考啊QWQ）", "description": "公主的文综太差了，全校排名 $1100$+（全校就 $1100$ 多人），她分析了好久，发现她如果把所有时间放在选择题上，得分会比较好一点。\n\n文综题目共有 $n$ 个，编号从 $1$ 到 $n$。\n\n公主给每个题目算出来了一个预估值 $A_i$，她认为，一段连续题目的答案会在它们的预估值的 $\\gcd$ 和 $\\operatorname{lcm}$ 之间；有时候她的想法不同了，一些题目的预估值会改变；有时候，会出现多选题，多选题的答案数量就是一段连续题目答案的预估值的公约数的个数。\n\n具体来说，对于一个数列，有四种操作：\n\n- `L x y p`：表示公主询问区间 $[x,y]$ 的数字的 $\\operatorname{lcm}$ 对 $p$ 取模之后的值。\n\n- `G x y p`：表示公主询问区间 $[x,y]$ 的数字的 $\\gcd$ 对 $p$ 取模之后的值。\n\n- `C x y c`：表示公主改变区间 $[x,y]$ 的数字的值，统一改为 $c$。\n\n- `S x y p`：表示公主询问区间 $[x,y]$ 的数字的公因数个数对 $p$ 取模之后的值。\n\n公主月考不能挂科，不然她就不能学习 OI 了（假的），所以请你帮帮她吧！", "inputFormat": "第一行，两个正整数 $n$ 和 $q$，其中 $n$ 表示题目个数，$q$ 表示操作次数。\n\n第二行，$n$ 个正整数，表示公主对题目的预估值。\n\n接下来 $q$ 行，每行输入一个操作，格式详见题目描述。", "outputFormat": "对于每个询问，输出它的答案。", "hint": "对于 $30\\%$ 的数据，$1\\le n,q\\le 1000$。\n\n对于另外 $20\\%$ 的数据，$1\\le n\\le 1000，1\\le q\\le 10^5$。\n\n对于另外 $20\\%$ 的数据，$1\\le n\\le 10^5，1\\le q\\le 10^5$，保证没有修改操作。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 3\\times 10^5，1\\le q\\le 3\\times 10^5$。\n\n保证任何时刻每个题目的预估值都在 $[1,100]$ 之间，答案取模之后不超过 `int`。", "locale": "zh-CN"}}}
{"pid": "P4257", "type": "P", "difficulty": 6, "samples": [["4 1\n1 2 3 4\n", "333333359"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 10000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "快速莫比乌斯变换 FMT"], "title": "可爱の#10数字划分", "background": "可可可可可可爱的付公主 qwq 有 $n$ 个数，$1\\sim n$，每个数都有价值 $V_i$，你要将它们划分成若干个集合，每个数属于一个集合。", "description": "我们这里规定:\n\n1. 质数只能和质数分在同一个集合。  \n2. 合数只能和合数分在同一个集合（$1$ 也算在合数内）。   \n3. 我们假设目前所有质数集合的并集为 $U$（也就是之前所有质数集合以及 $S$ 的并集），每个质数集合 $S$ 的价值定义如下：  \n$$V_S=\\frac {(\\sum_{i\\in S}V_i)^p} {\\prod_{i\\in U}V_i}$$\n\n4. 我们定义每个合数集合 $S$ 的价值如下:\n\n令 $k=|S|$，我们用这 $k$ 个数分别作为 $k$ 条边的权值，连接 $k+1$ 个点，构成一棵树。对于一个排列 $P(1\\sim k+1)$，价值为：\n\n$$V_P=\\sum_{i=1}^{n-1} f(P_i,P_{i+1})$$\n\n其中 $f(u,v)$ 为路径 $(u,v)$ 上最大的边权。\n\n集合 $S$ 的价值为：\n\n$$V_S=E(\\min\\{V_P\\})\\times|S|$$\n\n其中 $E(X)$ 代表 $X$ 的数学期望，期望是针对所有可能的有标号无根树，$\\min$ 是针对所有可能的 $P$。这时集合内所有元素都不同，也就是所有边不同。\n\n5. 一个划分方案的价值定义为所有集合的价值的乘积。\n6. 两个划分方案相同当且仅当它们中所有集合对应相同，且质数集合的相对顺序相同。\n\n现在给定 $n,p$ 和 $V_i$，请你求出所有合法的不同划分方案的价值之和。\n\n结果对 $10^9+7$ 取模，除法请使用乘法逆元。", "inputFormat": "第一行输入两个正整数 $n,p$。\n\n第二行输入 $n$ 个正整数 $V_i$。", "outputFormat": "共一行一个非负整数，代表答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n有以下 $6$ 种划分方案:\n\n1. $(2,3)$ 和 $(1,4)$。$(2,3)$ 的价值为 ${\\dfrac 5 6}$，$(1,4)$ 的价值为 $10$，总价值为 ${\\dfrac {25} 3}$。\n2. $(2),(3)$ 和 $(1,4)$。$(2)$ 的价值为 $1$，$(3)$ 的价值为 ${\\dfrac 1 2}$，$(1,4)$ 的价值为 $10$，总价值为 $5$。\n3. $(3),(2)$ 和 $(1,4)$。$(3)$ 的价值为 $1$，$(2)$ 的价值为 ${\\dfrac 1 3}$，$(1,4)$ 的价值为 $10$，总价值为 ${\\dfrac {10} 3}$。\n4. $(2,3)$ 和 $(1),(4)$。$(2,3)$ 的价值为 ${\\dfrac 5 6}$，$(1)$ 的价值为 $1$，$(4)$ 的价值为 $4$，总价值为 ${\\dfrac {10} 3}$。\n5. $(2),(3)$ 和 $(1),(4)$。$(2)$ 的价值为 $1$，$(3)$ 的价值为 ${\\dfrac 1 2}$，$(1)$ 的价值为 $1$，$(4)$ 的价值为 $4$，总价值为 $2$。\n6. $(3),(2)$ 和 $(1),(4)$。$(3)$ 的价值为 $1$，$(2)$ 的价值为 ${\\dfrac 1 3}$，$(1)$ 的价值为 $1$，$(4)$ 的价值为 $4$，总价值为 ${\\dfrac 4 3}$。\n\n因此所有划分方案的价值和为${\\dfrac {70} 3}$。对 $10^9+7$ 取模后结果为 $333333359$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 70$，$1\\le V_i\\le 10^{12}$。\n\n下表中给出了每个测试点具体的数据范围，都表示小于等于。为了防止卡 OJ，所以本题数据组数进行压缩，分值改变，具体参照表格。\n\n| 数据编号 |  n   |  p   |  Vi   | 测试点分值 | 时限 |\n| :------: | :--: | :--: | :---: | :--------: | :--: |\n|    1     |  10  |  1   |  100  |     10     |  1s  |\n|    2     |  20  |  1   | 1000  |     10     |  1s  |\n|    3     |  30  |  1   | 10000 |     10     |  1s  |\n|    4     |  40  | 1e9  | 1e12  |     10     |  1s  |\n|    5     |  50  |  1   | 1e12  |     5      |  1s  |\n|    6     |  50  | 1e9  | 1e12  |     5      |  1s  |\n|    7     |  60  |  1   | 1e12  |     5      |  2s  |\n|    8     |  60  | 1e9  | 1e12  |     5      |  2s  |\n|    9     |  70  | 1e9  | 1e12  |     20     |  10s  |\n|    10    |  70  | 1e9  | 1e12  |     20     |  5s  |\n\n提示：大家不要太过相信自己的常数，尽量做好常数优化。", "locale": "zh-CN", "translations": {"en": {"title": "Cute #10 Number Partition", "background": "Princess Fu, who is super cute qwq, has $n$ numbers, $1 \\sim n$. Each number has a value $V_i$, and you need to partition them into several sets so that each number belongs to exactly one set.", "description": "We stipulate:\n\n1. A prime number can only be placed in the same set with prime numbers.\n2. A composite number can only be placed in the same set with composite numbers ($1$ is considered composite).\n3. Let the union of all prime-number sets be $U$ (i.e., the union of all prime-number sets including $S$). For each prime-number set $S$, define its value as:\n$$V_S=\\frac {(\\sum_{i\\in S}V_i)^p} {\\prod_{i\\in U}V_i}.$$\n\n4. For each composite-number set $S$, define its value as follows:\n\nLet $k=|S|$. Use these $k$ numbers as the weights of $k$ edges to connect $k+1$ vertices, forming a tree. For a permutation $P(1 \\sim k+1)$, the value is:\n$$V_P=\\sum_{i=1}^{k} f(P_i,P_{i+1}),$$\nwhere $f(u,v)$ is the maximum edge weight on the path $(u,v)$.\n\nThe value of the set $S$ is:\n$$V_S=E(\\min\\{V_P\\})\\times|S|,$$\nwhere $E(X)$ denotes the mathematical expectation of $X$ over all possible labeled unrooted trees, and the $\\min$ is taken over all possible $P$. Here, all elements in the set are distinct, i.e., all edges are distinct.\n\n5. The value of a partition scheme is defined as the product of the values of all sets.\n6. Two partition schemes are the same if and only if their sets correspond exactly and the relative order of the prime-number sets is the same.\n\nNow, given $n, p$ and $V_i$, please compute the sum of values over all valid and distinct partition schemes.\n\nTake the result modulo $10^9+7$. For division, please use multiplicative inverses.", "inputFormat": "The first line contains two positive integers $n, p$.\n\nThe second line contains $n$ positive integers $V_i$.", "outputFormat": "Output a single non-negative integer: the answer modulo $10^9+7$.", "hint": "Sample Explanation\n\nThere are the following $6$ partition schemes:\n\n1. $(2,3)$ and $(1,4)$. The value of $(2,3)$ is ${\\dfrac 5 6}$, the value of $(1,4)$ is $10$, and the total value is ${\\dfrac {25} 3}$.\n2. $(2),(3)$ and $(1,4)$. The value of $(2)$ is $1$, the value of $(3)$ is ${\\dfrac 1 2}$, the value of $(1,4)$ is $10$, and the total value is $5$.\n3. $(3),(2)$ and $(1,4)$. The value of $(3)$ is $1$, the value of $(2)$ is ${\\dfrac 1 3}$, the value of $(1,4)$ is $10$, and the total value is ${\\dfrac {10} 3}$.\n4. $(2,3)$ and $(1),(4)$. The value of $(2,3)$ is ${\\dfrac 5 6}$, the value of $(1)$ is $1$, the value of $(4)$ is $4$, and the total value is ${\\dfrac {10} 3}$.\n5. $(2),(3)$ and $(1),(4)$. The value of $(2)$ is $1$, the value of $(3)$ is ${\\dfrac 1 2}$, the value of $(1)$ is $1$, the value of $(4)$ is $4$, and the total value is $2$.\n6. $(3),(2)$ and $(1),(4)$. The value of $(3)$ is $1$, the value of $(2)$ is ${\\dfrac 1 3}$, the value of $(1)$ is $1$, the value of $(4)$ is $4$, and the total value is ${\\dfrac 4 3}$.\n\nTherefore, the sum of values over all partition schemes is ${\\dfrac {70} 3}$. After taking modulo $10^9+7$, the result is $333333359$.\n\nConstraints\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 70$, $1 \\le V_i \\le 10^{12}$.\n\nThe table below gives the specific constraints for each test point (all are upper bounds). To prevent stressing the OJ, the testdata is compressed and the scores are adjusted; see the table for details.\n\n| Data ID |  n   |  p   |  V_i  | Score per test point | Time limit |\n| :-----: | :--: | :--: | :---: | :-------------------: | :--------: |\n|    1    |  10  |  1   |  100  |          10           |    1 s     |\n|    2    |  20  |  1   | 1000  |          10           |    1 s     |\n|    3    |  30  |  1   | 10000 |          10           |    1 s     |\n|    4    |  40  | 1e9  | 1e12  |          10           |    1 s     |\n|    5    |  50  |  1   | 1e12  |           5           |    1 s     |\n|    6    |  50  | 1e9  | 1e12  |           5           |    1 s     |\n|    7    |  60  |  1   | 1e12  |           5           |    2 s     |\n|    8    |  60  | 1e9  | 1e12  |           5           |    2 s     |\n|    9    |  70  | 1e9  | 1e12  |          20           |   10 s     |\n|   10    |  70  | 1e9  | 1e12  |          20           |    5 s     |\n\nTip: Do not be overly optimistic about constant factors; try to optimize them.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "可爱の#10数字划分", "background": "可可可可可可爱的付公主 qwq 有 $n$ 个数，$1\\sim n$，每个数都有价值 $V_i$，你要将它们划分成若干个集合，每个数属于一个集合。", "description": "我们这里规定:\n\n1. 质数只能和质数分在同一个集合。  \n2. 合数只能和合数分在同一个集合（$1$ 也算在合数内）。   \n3. 我们假设目前所有质数集合的并集为 $U$（也就是之前所有质数集合以及 $S$ 的并集），每个质数集合 $S$ 的价值定义如下：  \n$$V_S=\\frac {(\\sum_{i\\in S}V_i)^p} {\\prod_{i\\in U}V_i}$$\n\n4. 我们定义每个合数集合 $S$ 的价值如下:\n\n令 $k=|S|$，我们用这 $k$ 个数分别作为 $k$ 条边的权值，连接 $k+1$ 个点，构成一棵树。对于一个排列 $P(1\\sim k+1)$，价值为：\n\n$$V_P=\\sum_{i=1}^{n-1} f(P_i,P_{i+1})$$\n\n其中 $f(u,v)$ 为路径 $(u,v)$ 上最大的边权。\n\n集合 $S$ 的价值为：\n\n$$V_S=E(\\min\\{V_P\\})\\times|S|$$\n\n其中 $E(X)$ 代表 $X$ 的数学期望，期望是针对所有可能的有标号无根树，$\\min$ 是针对所有可能的 $P$。这时集合内所有元素都不同，也就是所有边不同。\n\n5. 一个划分方案的价值定义为所有集合的价值的乘积。\n6. 两个划分方案相同当且仅当它们中所有集合对应相同，且质数集合的相对顺序相同。\n\n现在给定 $n,p$ 和 $V_i$，请你求出所有合法的不同划分方案的价值之和。\n\n结果对 $10^9+7$ 取模，除法请使用乘法逆元。", "inputFormat": "第一行输入两个正整数 $n,p$。\n\n第二行输入 $n$ 个正整数 $V_i$。", "outputFormat": "共一行一个非负整数，代表答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n有以下 $6$ 种划分方案:\n\n1. $(2,3)$ 和 $(1,4)$。$(2,3)$ 的价值为 ${\\dfrac 5 6}$，$(1,4)$ 的价值为 $10$，总价值为 ${\\dfrac {25} 3}$。\n2. $(2),(3)$ 和 $(1,4)$。$(2)$ 的价值为 $1$，$(3)$ 的价值为 ${\\dfrac 1 2}$，$(1,4)$ 的价值为 $10$，总价值为 $5$。\n3. $(3),(2)$ 和 $(1,4)$。$(3)$ 的价值为 $1$，$(2)$ 的价值为 ${\\dfrac 1 3}$，$(1,4)$ 的价值为 $10$，总价值为 ${\\dfrac {10} 3}$。\n4. $(2,3)$ 和 $(1),(4)$。$(2,3)$ 的价值为 ${\\dfrac 5 6}$，$(1)$ 的价值为 $1$，$(4)$ 的价值为 $4$，总价值为 ${\\dfrac {10} 3}$。\n5. $(2),(3)$ 和 $(1),(4)$。$(2)$ 的价值为 $1$，$(3)$ 的价值为 ${\\dfrac 1 2}$，$(1)$ 的价值为 $1$，$(4)$ 的价值为 $4$，总价值为 $2$。\n6. $(3),(2)$ 和 $(1),(4)$。$(3)$ 的价值为 $1$，$(2)$ 的价值为 ${\\dfrac 1 3}$，$(1)$ 的价值为 $1$，$(4)$ 的价值为 $4$，总价值为 ${\\dfrac 4 3}$。\n\n因此所有划分方案的价值和为${\\dfrac {70} 3}$。对 $10^9+7$ 取模后结果为 $333333359$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 70$，$1\\le V_i\\le 10^{12}$。\n\n下表中给出了每个测试点具体的数据范围，都表示小于等于。为了防止卡 OJ，所以本题数据组数进行压缩，分值改变，具体参照表格。\n\n| 数据编号 |  n   |  p   |  Vi   | 测试点分值 | 时限 |\n| :------: | :--: | :--: | :---: | :--------: | :--: |\n|    1     |  10  |  1   |  100  |     10     |  1s  |\n|    2     |  20  |  1   | 1000  |     10     |  1s  |\n|    3     |  30  |  1   | 10000 |     10     |  1s  |\n|    4     |  40  | 1e9  | 1e12  |     10     |  1s  |\n|    5     |  50  |  1   | 1e12  |     5      |  1s  |\n|    6     |  50  | 1e9  | 1e12  |     5      |  1s  |\n|    7     |  60  |  1   | 1e12  |     5      |  2s  |\n|    8     |  60  | 1e9  | 1e12  |     5      |  2s  |\n|    9     |  70  | 1e9  | 1e12  |     20     |  10s  |\n|    10    |  70  | 1e9  | 1e12  |     20     |  5s  |\n\n提示：大家不要太过相信自己的常数，尽量做好常数优化。", "locale": "zh-CN"}}}
{"pid": "P4258", "type": "P", "difficulty": 6, "samples": [["1\n4 3 6\n1 1\n2 1\n2 2\n3 2\n3 3\n4 3", "2\n1 2 3 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "Special Judge", "图论建模", "一般图的最大匹配", "WC"], "title": "[WC2016] 挑战NPC", "background": "", "description": "小 N 最近在研究 NP 完全问题，小 O 看小 N 研究得热火朝天，便给他出了一道这样的题目：\n\n有 $n$ 个球，用整数 $1$ 到 $n$ 编号。还有 $m$ 个筐子，用整数 $1$ 到 $m$ 编号。每个筐子最多能装 $3$ 个球。\n\n每个球只能放进特定的筐子中。 具体有 $e$ 个条件，第 $i$ 个条件用两个整数\n$v_i$ 和 $u_i$ 描述，表示编号为 $v_i$ 的球可以放进编号为 $u_i$ 的筐子中。\n\n每个球都必须放进一个筐子中。如果一个筐子内有不超过 $1$ 个球，那么我们称这样的筐子为半空的。\n\n求半空的筐子最多有多少个，以及在最优方案中， 每个球分别放在哪个筐子中。\n\n小 N 看到题目后瞬间没了思路，站在旁边看热闹的小 I 嘿嘿一笑：“水题！”\n然后三言两语道出了一个多项式算法。\n\n小 N 瞬间就惊呆了，三秒钟后他回过神来一拍桌子：“不对！这个问题显然是 NP 完全问题，你算法肯定有错！”\n\n小 I 浅笑：“所以，等我领图灵奖吧！”\n\n小 O 只会出题不会做题，所以找到了你——请你对这个问题进行探究，并写一个程序解决此题。", "inputFormat": "输入文件 $\\tt{npc.in}$ 第一行包含 $1$ 个正整数 $T$， 表示有 $T$ 组数据。\n\n对于每组数据，第一行包含 $3$ 个正整数 $n, m, e$， 表示球的个数，筐子的个数和条件的个数。\n\n接下来 $e$ 行，每行包含 $2$ 个整数 $v_i, u_i$， 表示编号为 $v_i$ 的球可以放进编号为 $u_i$ 的筐子。", "outputFormat": "输出文件为 $\\tt{npc.out}$。\n\n对于每组数据，先输出一行，包含一个整数，表示半空的筐子最多有多少个。\n\n然后再输出一行，包含 $n$ 个整数 $p_1, p_2, ... , p_n$，相邻整数之间用空格隔开，表示一种最优解。其中 $p_i$ 表示编号为 $i$ 的球放进了编号为 $p_i$ 的筐子。 如果有多种最优解，可以输出其中任何一种。", "hint": "对于所有数据， $T \\leq 5, 1 \\leq n \\leq 3m$。 保证 $1 \\leq v_i \\leq n, 1 \\leq u_i \\leq m$，且不会出现重复的条件。\n\n保证至少有一种合法方案，使得每个球都放进了筐子，且每个筐子内球的个\n数不超过 $3$。\n\n各测试点满足以下约定：\n\n::cute-table{tuack}\n\n|测试点|$ m $     |约定        |\n|:-:|:--------:|:--------:|\n|1  |$\\leq 10$ |$n \\leq 20, e \\leq 25$|\n|2  |^         |^         |\n|3  |$\\leq 100$|$e=nm$    |\n|4  |^         |存在方案使得有 $m$ 个半空的筐子|\n|5  |^         |不存在有半空的筐子的方案|\n|6  |^         |^         |\n|7  |^         |无        |\n|8  |^         |^         |\n|9  |^         |^         |\n|10 |^         |^         |", "locale": "zh-CN", "translations": {"en": {"title": "[WC2016] Challenge NPC", "background": "", "description": "Little N has recently been studying NP-complete problems. Seeing him so absorbed, Little O gave him such a problem:\n\nThere are $n$ balls, numbered from $1$ to $n$. There are also $m$ baskets, numbered from $1$ to $m$. Each basket can hold at most $3$ balls.\n\nEach ball can only be placed into specific baskets. Specifically, there are $e$ constraints. The $i$-th constraint is described by two integers $v_i$ and $u_i$, meaning that ball $v_i$ can be placed into basket $u_i$.\n\nEvery ball must be placed into some basket. If a basket contains at most $1$ ball, we call such a basket half-empty.\n\nFind the maximum possible number of half-empty baskets, and in an optimal arrangement, determine which basket each ball is placed into.\n\nLittle N was stunned and lost his train of thought. Little I, watching from the side, chuckled, “Easy problem!” Then, with a few words, he described a polynomial-time algorithm.\n\nLittle N was shocked. Three seconds later, he slapped the table: “No way! This problem is clearly NP-complete. Your algorithm must be wrong!”\n\nLittle I smiled slightly: “Then I’ll wait for my Turing Award!”\n\nLittle O can make problems but not solve them, so he turned to you—please investigate this problem and write a program to solve it.", "inputFormat": "In the input file $\\tt{npc.in}$, the first line contains a single positive integer $T$, indicating there are $T$ test cases.\n\nFor each test case, the first line contains three positive integers $n$, $m$, $e$, representing the number of balls, the number of baskets, and the number of constraints.\n\nThe next $e$ lines each contain two integers $v_i$, $u_i$, indicating that ball $v_i$ can be placed into basket $u_i$.", "outputFormat": "The output file is $\\tt{npc.out}$.\n\nFor each test case, first output one line containing a single integer, the maximum possible number of half-empty baskets.\n\nThen output one more line containing $n$ integers $p_1, p_2, ... , p_n$, separated by spaces, describing one optimal arrangement. Here $p_i$ indicates that ball $i$ is placed into basket $p_i$. If there are multiple optimal solutions, any one of them may be printed.", "hint": "For all testdata, $T \\leq 5$, $1 \\leq n \\leq 3 m$. It is guaranteed that $1 \\leq v_i \\leq n$, $1 \\leq u_i \\leq m$, and there are no duplicate constraints.\n\nIt is guaranteed that there exists at least one feasible solution in which every ball is placed into a basket and the number of balls in each basket does not exceed $3$.\n\nEach test point satisfies the following conventions:\n::cute-table{tuack}\n|Test point|$ m $     |Notes        |\n|:-:|:--------:|:--------:|\n|1  |$\\leq 10$ |$n \\leq 20, e \\leq 25$|\n|2  |^         |^         |\n|3  |$\\leq 100$|$e = n m$ |\n|4  |^         |There exists a solution with $m$ half-empty baskets.|\n|5  |^         |No solution has any half-empty basket.|\n|6  |^         |^         |\n|7  |^         |None      |\n|8  |^         |^         |\n|9  |^         |^         |\n|10 |^         |^         |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2016] 挑战NPC", "background": "", "description": "小 N 最近在研究 NP 完全问题，小 O 看小 N 研究得热火朝天，便给他出了一道这样的题目：\n\n有 $n$ 个球，用整数 $1$ 到 $n$ 编号。还有 $m$ 个筐子，用整数 $1$ 到 $m$ 编号。每个筐子最多能装 $3$ 个球。\n\n每个球只能放进特定的筐子中。 具体有 $e$ 个条件，第 $i$ 个条件用两个整数\n$v_i$ 和 $u_i$ 描述，表示编号为 $v_i$ 的球可以放进编号为 $u_i$ 的筐子中。\n\n每个球都必须放进一个筐子中。如果一个筐子内有不超过 $1$ 个球，那么我们称这样的筐子为半空的。\n\n求半空的筐子最多有多少个，以及在最优方案中， 每个球分别放在哪个筐子中。\n\n小 N 看到题目后瞬间没了思路，站在旁边看热闹的小 I 嘿嘿一笑：“水题！”\n然后三言两语道出了一个多项式算法。\n\n小 N 瞬间就惊呆了，三秒钟后他回过神来一拍桌子：“不对！这个问题显然是 NP 完全问题，你算法肯定有错！”\n\n小 I 浅笑：“所以，等我领图灵奖吧！”\n\n小 O 只会出题不会做题，所以找到了你——请你对这个问题进行探究，并写一个程序解决此题。", "inputFormat": "输入文件 $\\tt{npc.in}$ 第一行包含 $1$ 个正整数 $T$， 表示有 $T$ 组数据。\n\n对于每组数据，第一行包含 $3$ 个正整数 $n, m, e$， 表示球的个数，筐子的个数和条件的个数。\n\n接下来 $e$ 行，每行包含 $2$ 个整数 $v_i, u_i$， 表示编号为 $v_i$ 的球可以放进编号为 $u_i$ 的筐子。", "outputFormat": "输出文件为 $\\tt{npc.out}$。\n\n对于每组数据，先输出一行，包含一个整数，表示半空的筐子最多有多少个。\n\n然后再输出一行，包含 $n$ 个整数 $p_1, p_2, ... , p_n$，相邻整数之间用空格隔开，表示一种最优解。其中 $p_i$ 表示编号为 $i$ 的球放进了编号为 $p_i$ 的筐子。 如果有多种最优解，可以输出其中任何一种。", "hint": "对于所有数据， $T \\leq 5, 1 \\leq n \\leq 3m$。 保证 $1 \\leq v_i \\leq n, 1 \\leq u_i \\leq m$，且不会出现重复的条件。\n\n保证至少有一种合法方案，使得每个球都放进了筐子，且每个筐子内球的个\n数不超过 $3$。\n\n各测试点满足以下约定：\n\n::cute-table{tuack}\n\n|测试点|$ m $     |约定        |\n|:-:|:--------:|:--------:|\n|1  |$\\leq 10$ |$n \\leq 20, e \\leq 25$|\n|2  |^         |^         |\n|3  |$\\leq 100$|$e=nm$    |\n|4  |^         |存在方案使得有 $m$ 个半空的筐子|\n|5  |^         |不存在有半空的筐子的方案|\n|6  |^         |^         |\n|7  |^         |无        |\n|8  |^         |^         |\n|9  |^         |^         |\n|10 |^         |^         |", "locale": "zh-CN"}}}
