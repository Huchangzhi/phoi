{"pid": "P4791", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["搜索", "2018", "递归", "交互题", "Special Judge", "O2优化", "随机化", "BalticOI（波罗的海）"], "title": "[BalticOI 2018] 蠕虫之忧", "background": "", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day1「[Worm Worries](https://boi18-day1-open.kattis.com/problems/boi18.worm)」**\n\n**本题是一道交互题。**\n\n在一个三维空间（我们限制大小为 $N\\times M\\times K$）内，每个点都有一个正整数参数，记这个参数为 $H[x,\\, y,\\, z]$（保证 $1$ $\\leqslant$ $x$ $\\leqslant$ $N$ $,$ $1$ $\\leqslant$ $y$ $\\leqslant$ $M$ $,$ $1$ $\\leqslant$ $z$ $\\leqslant$ $K$ 且每个参数都不超过 $10^9$）。你最多可以询问 $Q$ 次，找到一个点，使得这个点的参数大于它周围与它有公共边的所有点的参数，即：$H[x,\\,y,\\,z]\\geqslant\\max(H[x+1,\\,y,\\,z],$ $H[x-1,\\,y,\\,z],$ $H[x,\\,y-1,\\,z],$ $H[x,\\,y-1,\\,z],$ $H[x,\\,y,\\,z+1],$ $H[x,\\,y,\\,z-1]).$\n\n特别地，当一个点不在空间直角坐标系的第一卦限内时，它的参数为 $0$。", "inputFormat": "**请使用标准输入输出流**与交互库进行交互。你可以向交互库询问最多 $Q$ 次，每次可以询问一个点的参数。\n\n输入的第一行包含四个整数 $N,\\,M,\\,K,\\,Q$ （请忽略这一行的其他参数）。在此之后，你可以向交互器提出至多 $Q$ 行形如 ``? x y z`` 的询问，表示“询问坐标为 $(x,\\,y,\\,z)$ 的点的参数是多少”。对于每一组询问，交互器会输出一行一个整数表示坐标为 $(x,\\,y,\\,z)$ 的点的参数。\n\n当你找到一组解时，输出一行 ``! x y z`` 表示你找到的答案是 $(x,\\,y,\\,z)$，并终止程序。此时交互器不会有任何输出。\n\n所有坐标必须满足 $1\\leqslant x\\leqslant N,\\, 1\\leqslant y\\leqslant M,\\, 1\\leqslant z\\leqslant K$。如果不满足坐标的限制、询问不符合格式或询问超过了 $Q$ 行，交互器会输出 ``-1`` 并退出，此时你的程序也应该退出。否则你可能会得到 ``Runtime Error`` 或 ``Time Limit Exceeded`` 的判定结果。\n\n请注意，你必须在每一次询问之后手动刷新缓存，否则你的程序将会超时，对于各语言，刷新缓存的方法如下：\n\n - Java: 调用 ``System.out.println()`` 会自动刷新缓存；\n - Python: 调用 ``print()`` 会自动刷新缓存；\n - C++: ``cout << endl`` 可以输出一个换行并刷新缓存。如果使用 ``printf``，请使用 ``fflush(stdout)``；\n - Pascal: 调用 ``Flush(Output)``。\n\n为了帮助你更好地完成交互，我们提供了可以复制到你的程序里的可选代码。可选代码使用了较快的输入输出，可能会提高 IO 较慢的 Python 和 Java 语言的程序效率（只与最后两个子任务有关）。\n\n交互器没有使用随机函数，这意味着，每组测试数据都是固定的，与你的程序的询问无关。", "outputFormat": "为了使你更好地完成交互，下面给出一组交互的示例。在这个示例中，$N=3,\\,M=3,\\,K=1,\\,Q=3$，这三个格子的参数为 $\\{10,\\,14,\\,13\\}$。以 ``JUDGE`` 开头的行表示交互库输出的内容（你的程序的标准输入的内容），以 ``YOU`` 开头的行表示你的程序的输出。\n\n```\nJUDGE:      3 1 1 3 123123 fixed 10 14 13\nYOU  :      ? 3 1 1\nJUDGE:      13\nYOU  :      ? 2 1 1\nJUDGE:      14\nYOU  :      ? 1 1 1\nJUDGE:      10\nYOU  :      ! 2 1 1\n```", "hint": "| 子任务 | 分值 | 限制 |\n|:------:|:----:|:----:|\n| $1$    | $10$ | $M=K=1,\\,N=1\\,000\\,000,\\,Q=10\\,000$ |\n| $2$    | $22$ | $M=K=1,\\,N=1\\,000\\,000,\\,Q=35$ |\n| $3$    | $12$ | $K=1,\\,N=M=200,\\,Q=4\\,000$ |\n| $4$    | $19$ | $K=1,\\,N=M=1\\,000,\\,Q=3\\,500$ |\n| $5$    | $14$ | $N=M=K=100,\\,Q=100\\,000$ |\n| $6$    | $23$ | $N=M=K=500,\\,Q=150\\,000$ |\n\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2018] Worm Worries", "background": "", "description": "**This problem is translated from [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day 1 “[Worm Worries](https://boi18-day1-open.kattis.com/problems/boi18.worm)”.**\n\n**This is an interactive problem.**\n\nIn a three-dimensional space (we limit the size to $N \\times M \\times K$), each point has a positive integer value, denoted by $H[x,\\, y,\\, z]$ (it is guaranteed that $1 \\leqslant x \\leqslant N$, $1 \\leqslant y \\leqslant M$, $1 \\leqslant z \\leqslant K$, and each value does not exceed $10^9$). You may ask at most $Q$ queries to find a point whose value is greater than or equal to the values of all points that share an edge with it, i.e.,\n$H[x,\\,y,\\,z]\\geqslant\\max(H[x+1,\\,y,\\,z],\\, H[x-1,\\,y,\\,z],\\, H[x,\\,y+1,\\,z],\\, H[x,\\,y-1,\\,z],\\, H[x,\\,y,\\,z+1],\\, H[x,\\,y,\\,z-1]).$\n\nIn particular, when a point is not in the first octant of the Cartesian coordinate system, its value is $0$.", "inputFormat": "**Please use standard input/output streams** to interact with the interactor. You can query the interactor at most $Q$ times, and each time you may ask for the value at one point.\n\nThe first line of input contains four integers $N,\\, M,\\, K,\\, Q$ (please ignore the other parameters on this line). After that, you may send to the interactor at most $Q$ lines of queries of the form ``? x y z``, meaning “ask what the value at coordinate $(x,\\,y,\\,z)$ is”. For each query, the interactor outputs one line with one integer, which is the value at coordinate $(x,\\,y,\\,z)$.\n\nWhen you find a valid answer, output one line ``! x y z`` to indicate that your answer is $(x,\\,y,\\,z)$, and terminate your program. In this case, the interactor will output nothing.\n\nAll coordinates must satisfy $1 \\leqslant x \\leqslant N$, $1 \\leqslant y \\leqslant M$, $1 \\leqslant z \\leqslant K$. If the coordinates do not satisfy the constraints, the query format is invalid, or the number of queries exceeds $Q$, the interactor will output ``-1`` and exit; in this case your program should also exit. Otherwise, you may receive a verdict such as ``Runtime Error`` or ``Time Limit Exceeded``.\n\nNote that you must manually flush the output buffer after each query, otherwise your program will time out. For different languages, the flushing methods are as follows:\n\n- Java: calling ``System.out.println()`` flushes automatically;\n- Python: calling ``print()`` flushes automatically;\n- C++: ``cout << endl`` prints a newline and flushes. If you use ``printf``, use ``fflush(stdout)``;\n- Pascal: call ``Flush(Output)``.\n\nTo help you implement the interaction more easily, we provide optional code that you can copy into your program. The optional code uses faster input/output, which may improve the efficiency of Python and Java programs with slower IO (only related to the last two subtasks).\n\nThe interactor does not use random functions. This means that each testdata is fixed and does not depend on your queries.", "outputFormat": "To help you implement the interaction, here is an example interaction. In this example, $N=3,\\, M=3,\\, K=1,\\, Q=3$, and the values of the three cells are $\\{10,\\,14,\\,13\\}$. Lines starting with ``JUDGE`` are the interactor’s output (your program’s standard input), and lines starting with ``YOU`` are your program’s output.\n\n```\nJUDGE:      3 1 1 3 123123 fixed 10 14 13\nYOU  :      ? 3 1 1\nJUDGE:      13\nYOU  :      ? 2 1 1\nJUDGE:      14\nYOU  :      ? 1 1 1\nJUDGE:      10\nYOU  :      ! 2 1 1\n```", "hint": "| Subtask | Score | Constraints |\n|:------:|:----:|:----:|\n| $1$    | $10$ | $M = K = 1,\\, N = 1\\,000\\,000,\\, Q = 10\\,000$ |\n| $2$    | $22$ | $M = K = 1,\\, N = 1\\,000\\,000,\\, Q = 35$ |\n| $3$    | $12$ | $K = 1,\\, N = M = 200,\\, Q = 4\\,000$ |\n| $4$    | $19$ | $K = 1,\\, N = M = 1\\,000,\\, Q = 3\\,500$ |\n| $5$    | $14$ | $N = M = K = 100,\\, Q = 100\\,000$ |\n| $6$    | $23$ | $N = M = K = 500,\\, Q = 150\\,000$ |\n\nThanks to Hatsune_Miku for providing the translation.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2018] 蠕虫之忧", "background": "", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day1「[Worm Worries](https://boi18-day1-open.kattis.com/problems/boi18.worm)」**\n\n**本题是一道交互题。**\n\n在一个三维空间（我们限制大小为 $N\\times M\\times K$）内，每个点都有一个正整数参数，记这个参数为 $H[x,\\, y,\\, z]$（保证 $1$ $\\leqslant$ $x$ $\\leqslant$ $N$ $,$ $1$ $\\leqslant$ $y$ $\\leqslant$ $M$ $,$ $1$ $\\leqslant$ $z$ $\\leqslant$ $K$ 且每个参数都不超过 $10^9$）。你最多可以询问 $Q$ 次，找到一个点，使得这个点的参数大于它周围与它有公共边的所有点的参数，即：$H[x,\\,y,\\,z]\\geqslant\\max(H[x+1,\\,y,\\,z],$ $H[x-1,\\,y,\\,z],$ $H[x,\\,y-1,\\,z],$ $H[x,\\,y-1,\\,z],$ $H[x,\\,y,\\,z+1],$ $H[x,\\,y,\\,z-1]).$\n\n特别地，当一个点不在空间直角坐标系的第一卦限内时，它的参数为 $0$。", "inputFormat": "**请使用标准输入输出流**与交互库进行交互。你可以向交互库询问最多 $Q$ 次，每次可以询问一个点的参数。\n\n输入的第一行包含四个整数 $N,\\,M,\\,K,\\,Q$ （请忽略这一行的其他参数）。在此之后，你可以向交互器提出至多 $Q$ 行形如 ``? x y z`` 的询问，表示“询问坐标为 $(x,\\,y,\\,z)$ 的点的参数是多少”。对于每一组询问，交互器会输出一行一个整数表示坐标为 $(x,\\,y,\\,z)$ 的点的参数。\n\n当你找到一组解时，输出一行 ``! x y z`` 表示你找到的答案是 $(x,\\,y,\\,z)$，并终止程序。此时交互器不会有任何输出。\n\n所有坐标必须满足 $1\\leqslant x\\leqslant N,\\, 1\\leqslant y\\leqslant M,\\, 1\\leqslant z\\leqslant K$。如果不满足坐标的限制、询问不符合格式或询问超过了 $Q$ 行，交互器会输出 ``-1`` 并退出，此时你的程序也应该退出。否则你可能会得到 ``Runtime Error`` 或 ``Time Limit Exceeded`` 的判定结果。\n\n请注意，你必须在每一次询问之后手动刷新缓存，否则你的程序将会超时，对于各语言，刷新缓存的方法如下：\n\n - Java: 调用 ``System.out.println()`` 会自动刷新缓存；\n - Python: 调用 ``print()`` 会自动刷新缓存；\n - C++: ``cout << endl`` 可以输出一个换行并刷新缓存。如果使用 ``printf``，请使用 ``fflush(stdout)``；\n - Pascal: 调用 ``Flush(Output)``。\n\n为了帮助你更好地完成交互，我们提供了可以复制到你的程序里的可选代码。可选代码使用了较快的输入输出，可能会提高 IO 较慢的 Python 和 Java 语言的程序效率（只与最后两个子任务有关）。\n\n交互器没有使用随机函数，这意味着，每组测试数据都是固定的，与你的程序的询问无关。", "outputFormat": "为了使你更好地完成交互，下面给出一组交互的示例。在这个示例中，$N=3,\\,M=3,\\,K=1,\\,Q=3$，这三个格子的参数为 $\\{10,\\,14,\\,13\\}$。以 ``JUDGE`` 开头的行表示交互库输出的内容（你的程序的标准输入的内容），以 ``YOU`` 开头的行表示你的程序的输出。\n\n```\nJUDGE:      3 1 1 3 123123 fixed 10 14 13\nYOU  :      ? 3 1 1\nJUDGE:      13\nYOU  :      ? 2 1 1\nJUDGE:      14\nYOU  :      ? 1 1 1\nJUDGE:      10\nYOU  :      ! 2 1 1\n```", "hint": "| 子任务 | 分值 | 限制 |\n|:------:|:----:|:----:|\n| $1$    | $10$ | $M=K=1,\\,N=1\\,000\\,000,\\,Q=10\\,000$ |\n| $2$    | $22$ | $M=K=1,\\,N=1\\,000\\,000,\\,Q=35$ |\n| $3$    | $12$ | $K=1,\\,N=M=200,\\,Q=4\\,000$ |\n| $4$    | $19$ | $K=1,\\,N=M=1\\,000,\\,Q=3\\,500$ |\n| $5$    | $14$ | $N=M=K=100,\\,Q=100\\,000$ |\n| $6$    | $23$ | $N=M=K=500,\\,Q=150\\,000$ |\n\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN"}}}
{"pid": "P4792", "type": "P", "difficulty": 3, "samples": [["5 2 2\n0 1 1 0 1\n0 1\n1 1", "2\n"], ["13 4 3\n1 1 3 2 0 1 2 0 0 0 0 3 1\n0 2\n2 1\n1 2", "7\n"], ["5 3 1\n1 2 0 1 2\n0 2", "impossible\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000]}, "tags": ["字符串", "2018", "枚举", "前缀和", "BalticOI（波罗的海）"], "title": "[BalticOI 2018] 火星人的 DNA", "background": "", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day1「[Martian DNA](https://boi18-day1-open.kattis.com/problems/boi18.dna)」**\n\n给定一个字符集大小 $|\\Sigma| = K$ 的长度为 $N$ 的字符串和 $R$ 个要求，每个要求为使子串中的字符 $B$ 至少出现 $Q$ 次。求出满足所有要求的最短子串长度。", "inputFormat": "第一行包括三个整数 $N,\\, K,\\, R$，分别表示字符串的长度、字符集的大小和要求个数，保证 $1\\leqslant R\\leqslant K\\leqslant N$。  \n第二行包含 $N$ 个用空格隔开的整数，表示这个字符串。字符从 $0$ 开始编号，每个字符集中的字符至少出现一次。  \n接下来的 $R$ 行，每行两个整数 $B$ 和 $Q$，表示一组要求，满足 $0\\leqslant B < K,\\, 1\\leqslant Q\\leqslant N$，同一个字符不会被重复要求两次。", "outputFormat": "输出一个整数，满足所有要求的最短子串长度。特别地，如果不存在这样的子串，输出 \"``impossible``\"。", "hint": "#### 样例 1 解释\n\n有三个长度为 $2$ 的子串含有字符 $0$ 和 $1$ 各一个，分别为 ``0 1``、``1 0`` 和 ``0 1``，但是不存在长度为 $1$ 的子串满足要求，因此满足要求的最短子串的长度为 $2$。\n\n#### 样例 2 解释\n\n最短的满足要求的子串为 ``1 3 2 0 1 2 0``。\n\n#### 样例 3 解释\n\n在这个字符串中，``0`` 的数量不足。\n\n| 子任务 | 分值 | 限制 |\n|:--------:|:------:|:------:|\n|$1$     |$16$  |$1\\leqslant N\\leqslant 100,\\, R\\leqslant 10$|\n|$2$     |$24$  |$1\\leqslant N\\leqslant 4\\, 000,\\, R\\leqslant 10$|\n|$3$     |$28$  |$1\\leqslant N\\leqslant 200\\, 000,\\, R\\leqslant 10$|\n|$4$     |$32$  |$1\\leqslant N\\leqslant 200\\, 000$|\n\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2018] Martian DNA", "background": "", "description": "**This problem is translated from [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day 1 “[Martian DNA](https://boi18-day1-open.kattis.com/problems/boi18.dna)”.**\n\nYou are given a string of length $N$ over an alphabet of size $|\\Sigma| = K$, and $R$ requirements. Each requirement is: in the substring, character $B$ must appear at least $Q$ times. Find the length of the shortest substring that satisfies all requirements.", "inputFormat": "The first line contains three integers $N,\\, K,\\, R$, representing the length of the string, the size of the alphabet, and the number of requirements. It is guaranteed that $1\\leqslant R\\leqslant K\\leqslant N$.  \nThe second line contains $N$ space-separated integers describing the string. Characters are numbered starting from $0$, and every character in the alphabet appears at least once.  \nThe next $R$ lines each contain two integers $B$ and $Q$, describing one requirement. It is guaranteed that $0\\leqslant B < K,\\, 1\\leqslant Q\\leqslant N$, and no character will be required more than once.", "outputFormat": "Output one integer: the length of the shortest substring that satisfies all requirements. In particular, if no such substring exists, output \"``impossible``\".", "hint": "#### Explanation for Sample 1\n\nThere are three substrings of length $2$ that contain one occurrence each of characters $0$ and $1$: ``0 1``, ``1 0``, and ``0 1``. However, there is no substring of length $1$ that satisfies the requirements, so the shortest valid substring has length $2$.\n\n#### Explanation for Sample 2\n\nThe shortest substring that satisfies the requirements is ``1 3 2 0 1 2 0``.\n\n#### Explanation for Sample 3\n\nIn this string, the number of ``0`` is not enough.\n\n| Subtask | Score | Constraints |\n|:--------:|:------:|:------:|\n|$1$     |$16$  |$1\\leqslant N\\leqslant 100,\\, R\\leqslant 10$|\n|$2$     |$24$  |$1\\leqslant N\\leqslant 4\\, 000,\\, R\\leqslant 10$|\n|$3$     |$28$  |$1\\leqslant N\\leqslant 200\\, 000,\\, R\\leqslant 10$|\n|$4$     |$32$  |$1\\leqslant N\\leqslant 200\\, 000$|\n\nThanks to Hatsune_Miku for providing the translation.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2018] 火星人的 DNA", "background": "", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day1「[Martian DNA](https://boi18-day1-open.kattis.com/problems/boi18.dna)」**\n\n给定一个字符集大小 $|\\Sigma| = K$ 的长度为 $N$ 的字符串和 $R$ 个要求，每个要求为使子串中的字符 $B$ 至少出现 $Q$ 次。求出满足所有要求的最短子串长度。", "inputFormat": "第一行包括三个整数 $N,\\, K,\\, R$，分别表示字符串的长度、字符集的大小和要求个数，保证 $1\\leqslant R\\leqslant K\\leqslant N$。  \n第二行包含 $N$ 个用空格隔开的整数，表示这个字符串。字符从 $0$ 开始编号，每个字符集中的字符至少出现一次。  \n接下来的 $R$ 行，每行两个整数 $B$ 和 $Q$，表示一组要求，满足 $0\\leqslant B < K,\\, 1\\leqslant Q\\leqslant N$，同一个字符不会被重复要求两次。", "outputFormat": "输出一个整数，满足所有要求的最短子串长度。特别地，如果不存在这样的子串，输出 \"``impossible``\"。", "hint": "#### 样例 1 解释\n\n有三个长度为 $2$ 的子串含有字符 $0$ 和 $1$ 各一个，分别为 ``0 1``、``1 0`` 和 ``0 1``，但是不存在长度为 $1$ 的子串满足要求，因此满足要求的最短子串的长度为 $2$。\n\n#### 样例 2 解释\n\n最短的满足要求的子串为 ``1 3 2 0 1 2 0``。\n\n#### 样例 3 解释\n\n在这个字符串中，``0`` 的数量不足。\n\n| 子任务 | 分值 | 限制 |\n|:--------:|:------:|:------:|\n|$1$     |$16$  |$1\\leqslant N\\leqslant 100,\\, R\\leqslant 10$|\n|$2$     |$24$  |$1\\leqslant N\\leqslant 4\\, 000,\\, R\\leqslant 10$|\n|$3$     |$28$  |$1\\leqslant N\\leqslant 200\\, 000,\\, R\\leqslant 10$|\n|$4$     |$32$  |$1\\leqslant N\\leqslant 200\\, 000$|\n\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN"}}}
{"pid": "P4793", "type": "P", "difficulty": 6, "samples": [["3\n0 0 5 5\n1 2 3 4\n2 1 4 3\n", "2\n"]], "limits": {"time": [1000, 3000, 3000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "安徽"], "title": "[AHOI2008] 矩形藏宝地", "background": null, "description": "欢乐岛上最著名的游戏是一个寻宝游戏，小可可来到宝藏的埋藏地，这是一块开阔地，宝藏被分散的埋藏在这块地下，现在要做的是一件件的把宝藏挖出来。为了提示宝藏的埋藏点，游戏的主办方把这块开阔地当作第一象限（包括原点和正半坐标轴），将所有可能埋藏宝藏的地方划成一个个矩形的土地，并把这些矩形土地的坐标都告诉了参赛者。挖宝的提示很简单，只要某一个矩阵土地至少被另外一个矩阵土地所包含，那么这个矩阵土地里肯定埋有宝藏。其实这些宝藏都是一些精美的纪念品，如果谁挖出来了纪念品就归谁了，小可可很想为这次旅程画上完美的句号，有你的帮助他信心十足，你只要告诉他：有多少个矩形土地里肯定埋有宝藏就行了。胜利就在眼前，加油吧！", "inputFormat": "第一行包含一个整数 $N\\leq 200000$，表示矩形的个数。\n接下来 $N$ 行，每行用 $4$ 个整数 $x_1,\\,y_1,\\,x_2,\\,y_2$，描述了一个矩形。其中 $(x_1,\\,y_1)$ 表示这个矩形左下角的坐标，$(x_2,\\,y_2)$ 表示右上角的坐标，一个 $x$ 值或 $y$ 值最多出现一次。", "outputFormat": "只包含一个整数，表示肯定埋有宝藏的矩形土地的个数。", "hint": "$30\\%$ 的数据中，$N\\leq 5000$。\n\n$70\\%$ 的数据中，$N\\leq 50000$。\n\n$100\\%$ 的数据中，$N\\leq 200000$。\n\n所有数据中，一个 $x$ 值或 $y$ 值最多出现一次。坐标范围 $2\\times 10 ^ 6$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2008] Rectangular Treasure Land", "background": "", "description": "The most famous game on Happy Island is a treasure-hunting game. Xiaokeke arrives at the treasure burial area, which is an open field. The treasures are buried scattered underground in this field, and the task now is to dig them out one by one.\n\nTo indicate possible treasure locations, the organizers treat this open field as the first quadrant (including the origin and the positive coordinate axes). They divide all possible treasure locations into rectangular plots, and provide the coordinates of these rectangular plots to the contestants.\n\nThe hint for digging is very simple: if a certain rectangular plot is contained in at least one other rectangular plot, then there must be a treasure buried inside that rectangular plot.\n\nIn fact, these treasures are exquisite souvenirs. Whoever digs up a souvenir gets to keep it. Xiaokeke wants to end this journey perfectly, and with your help he is full of confidence. You only need to tell him: how many rectangular plots are guaranteed to contain a treasure.\n\nVictory is just ahead. Keep it up.", "inputFormat": "The first line contains an integer $N\\leq 200000$, indicating the number of rectangles.  \nThe next $N$ lines each contain $4$ integers $x_1,\\,y_1,\\,x_2,\\,y_2$, describing a rectangle. Here, $(x_1,\\,y_1)$ is the coordinate of the lower-left corner, and $(x_2,\\,y_2)$ is the coordinate of the upper-right corner. Each $x$ value or $y$ value appears at most once.", "outputFormat": "Contains only one integer, the number of rectangular plots that are guaranteed to contain a treasure.", "hint": "In $30\\%$ of the testdata, $N\\leq 5000$.  \n\nIn $70\\%$ of the testdata, $N\\leq 50000$.  \n\nIn $100\\%$ of the testdata, $N\\leq 200000$.  \n\nIn all testdata, each $x$ value or $y$ value appears at most once. The coordinate range is $2\\times 10 ^ 6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2008] 矩形藏宝地", "background": null, "description": "欢乐岛上最著名的游戏是一个寻宝游戏，小可可来到宝藏的埋藏地，这是一块开阔地，宝藏被分散的埋藏在这块地下，现在要做的是一件件的把宝藏挖出来。为了提示宝藏的埋藏点，游戏的主办方把这块开阔地当作第一象限（包括原点和正半坐标轴），将所有可能埋藏宝藏的地方划成一个个矩形的土地，并把这些矩形土地的坐标都告诉了参赛者。挖宝的提示很简单，只要某一个矩阵土地至少被另外一个矩阵土地所包含，那么这个矩阵土地里肯定埋有宝藏。其实这些宝藏都是一些精美的纪念品，如果谁挖出来了纪念品就归谁了，小可可很想为这次旅程画上完美的句号，有你的帮助他信心十足，你只要告诉他：有多少个矩形土地里肯定埋有宝藏就行了。胜利就在眼前，加油吧！", "inputFormat": "第一行包含一个整数 $N\\leq 200000$，表示矩形的个数。\n接下来 $N$ 行，每行用 $4$ 个整数 $x_1,\\,y_1,\\,x_2,\\,y_2$，描述了一个矩形。其中 $(x_1,\\,y_1)$ 表示这个矩形左下角的坐标，$(x_2,\\,y_2)$ 表示右上角的坐标，一个 $x$ 值或 $y$ 值最多出现一次。", "outputFormat": "只包含一个整数，表示肯定埋有宝藏的矩形土地的个数。", "hint": "$30\\%$ 的数据中，$N\\leq 5000$。\n\n$70\\%$ 的数据中，$N\\leq 50000$。\n\n$100\\%$ 的数据中，$N\\leq 200000$。\n\n所有数据中，一个 $x$ 值或 $y$ 值最多出现一次。坐标范围 $2\\times 10 ^ 6$。", "locale": "zh-CN"}}}
{"pid": "P4794", "type": "P", "difficulty": 6, "samples": [["10 5\n1 5\n6 7\n5 1\n7 2\n2 4", "00101\n\n"], ["10 5\n1 4\n2 5\n4 7\n6 10\n8 1", "impossible"], ["5 2\n1 5\n3 3", "impossible"], ["5 3\n3 3\n2 1\n4 2", "101\n\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["贪心", "2018", "Special Judge", "枚举", "排序", "BalticOI（波罗的海）"], "title": "[BalticOI 2018] 交流电", "background": "### 滥用本题评测将封禁帐号", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day2「[Alternating Current](https://boi18-day2-open.kattis.com/problems/boi18.alternating)」**\n\n给一个环，这个环可以被分为等长的 $N$ 段，分别标号为 $1\\ldots N$。同时你可以通过 $M$ 个控制点将环的某一段染成红色或蓝色，这 $M$ 个控制点分别编号为 $1\\ldots M$。\n\n如何安排这 $M$ 个点控制的线段的颜色，使得轨道上每个点都被至少一条红色线段和至少一条蓝色线段覆盖。\n\n保证这个环中不存在不能被染色的部分。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$，分别表示轨道段数和控制点个数。\n\n接下来 $M$ 行，每行两个整数 $a$ 和 $b$，分别表示每一个控制点可以控制颜色的左右端点。特别地，若 $a=b$ 则这个控制点只控制 $a$ 这一条长度为 $1$ 的线段；若 $b < a$ 则说明这个控制点能控制编号在区间 $[a,\\, N]\\cup[1,\\,b]$ 内的所有线段。", "outputFormat": "输出一行 $M$ 个字符，每个字符是 ``0`` 或 ``1``，分别表示设置在第 $i$ 个控制点控制的线段上，染成红色还是蓝色。\n\n如果有多组解请输出任意一组，如果无解请输出 ``impossible``。", "hint": "#### 样例 1 解释\n![](https://gitee.com/mingqihuang/pics/raw/master/alternatingfig.pdf.svg)\n\n上图为样例 1 的一组解。注意可以将所有的箭头反向得到另一组合法解 ``11010``。\n\n## 限制与提示\n\n|子任务|分值|数据范围|附加限制|\n|:----:|:--:|:------:|:------:|\n|$1$   |$13$|$2\\leqslant N,\\,M\\leqslant15$|.|\n|$2$   |$20$|$2\\leqslant N,\\,M\\leqslant100$|.|\n|$3$   |$22$|$2\\leqslant N,\\,M\\leqslant1000$|.|\n|$4$   |$19$|$2\\leqslant N,\\,M\\leqslant100\\,000$|保证 $b\\geqslant a$|\n|$5$   |$26$|$2\\leqslant N,\\,M\\leqslant100\\,000$|　|\n\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2018] Alternating Current", "background": "### Abusing the judge for this problem will result in your account being banned.", "description": "**This problem is translated from [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day 2 “[Alternating Current](https://boi18-day2-open.kattis.com/problems/boi18.alternating)”.**\n\nYou are given a circular track, which can be divided into $N$ equal-length segments, numbered $1 \\ldots N$. At the same time, you have $M$ control points that can color certain segments of the track either red or blue. These $M$ control points are numbered $1 \\ldots M$.\n\nYour task is to choose the colors of the segments controlled by these $M$ points so that every point on the track is covered by at least one red segment and at least one blue segment.\n\nIt is guaranteed that there is no part of the circle that cannot be colored.", "inputFormat": "The first line contains two integers $N$ and $M$, representing the number of track segments and the number of control points.\n\nThe next $M$ lines each contain two integers $a$ and $b$, representing the left and right endpoints of the range that the control point can color. In particular, if $a=b$, then this control point only controls the single segment $a$ with length $1$; if $b < a$, then this control point can control all segments with indices in the interval $[a,\\, N]\\cup[1,\\,b]$.", "outputFormat": "Output one line containing $M$ characters. Each character is either ``0`` or ``1``, indicating whether the segment controlled by the $i$-th control point is colored red or blue.\n\nIf there are multiple solutions, output any one of them. If there is no solution, output ``impossible``.", "hint": "#### Explanation for Sample 1\n\n![](https://gitee.com/mingqihuang/pics/raw/master/alternatingfig.pdf.svg)\n\nThe figure above shows one solution for Sample 1. Note that you can reverse all arrows to obtain another valid solution ``11010``.\n\n## Constraints\n\n| Subtask | Score | Constraints | Additional Constraints |\n|:------:|:-----:|:-----------:|:----------------------:|\n| $1$ | $13$ | $2\\leqslant N,\\,M\\leqslant15$ | . |\n| $2$ | $20$ | $2\\leqslant N,\\,M\\leqslant100$ | . |\n| $3$ | $22$ | $2\\leqslant N,\\,M\\leqslant1000$ | . |\n| $4$ | $19$ | $2\\leqslant N,\\,M\\leqslant100\\,000$ | It is guaranteed that $b\\geqslant a$. |\n| $5$ | $26$ | $2\\leqslant N,\\,M\\leqslant100\\,000$ | 　|\n\nThanks to Hatsune_Miku for providing the translation.\n\n# Input Format\n\n\n\n# Output Format\n\n\n\n# Hint\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2018] 交流电", "background": "### 滥用本题评测将封禁帐号", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day2「[Alternating Current](https://boi18-day2-open.kattis.com/problems/boi18.alternating)」**\n\n给一个环，这个环可以被分为等长的 $N$ 段，分别标号为 $1\\ldots N$。同时你可以通过 $M$ 个控制点将环的某一段染成红色或蓝色，这 $M$ 个控制点分别编号为 $1\\ldots M$。\n\n如何安排这 $M$ 个点控制的线段的颜色，使得轨道上每个点都被至少一条红色线段和至少一条蓝色线段覆盖。\n\n保证这个环中不存在不能被染色的部分。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$，分别表示轨道段数和控制点个数。\n\n接下来 $M$ 行，每行两个整数 $a$ 和 $b$，分别表示每一个控制点可以控制颜色的左右端点。特别地，若 $a=b$ 则这个控制点只控制 $a$ 这一条长度为 $1$ 的线段；若 $b < a$ 则说明这个控制点能控制编号在区间 $[a,\\, N]\\cup[1,\\,b]$ 内的所有线段。", "outputFormat": "输出一行 $M$ 个字符，每个字符是 ``0`` 或 ``1``，分别表示设置在第 $i$ 个控制点控制的线段上，染成红色还是蓝色。\n\n如果有多组解请输出任意一组，如果无解请输出 ``impossible``。", "hint": "#### 样例 1 解释\n![](https://gitee.com/mingqihuang/pics/raw/master/alternatingfig.pdf.svg)\n\n上图为样例 1 的一组解。注意可以将所有的箭头反向得到另一组合法解 ``11010``。\n\n## 限制与提示\n\n|子任务|分值|数据范围|附加限制|\n|:----:|:--:|:------:|:------:|\n|$1$   |$13$|$2\\leqslant N,\\,M\\leqslant15$|.|\n|$2$   |$20$|$2\\leqslant N,\\,M\\leqslant100$|.|\n|$3$   |$22$|$2\\leqslant N,\\,M\\leqslant1000$|.|\n|$4$   |$19$|$2\\leqslant N,\\,M\\leqslant100\\,000$|保证 $b\\geqslant a$|\n|$5$   |$26$|$2\\leqslant N,\\,M\\leqslant100\\,000$|　|\n\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN"}}}
{"pid": "P4795", "type": "P", "difficulty": 6, "samples": [["4 3 1\nACC\nCCA\nACA\nAAA", "3"], ["4 4 3\nCATT\nCAAA\nATGA\nTCTA", "4\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000]}, "tags": ["数学", "2018", "进制", "构造", "BalticOI（波罗的海）"], "title": "[BalticOI 2018] 基因工程", "background": "", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day2「[Genetics](https://boi18-day2-open.kattis.com/problems/boi18.genetics)」**\n\n给定 $N$ 个长度为 $M$ 的只由 ``A``、``T``、``G`` 和 ``C`` 组成的字符串，分别编号为 $1\\ldots N$，其中一个是模式串，其它 $N-1$ 个字符串与模式串都恰好有 $K$ 个字符不同，找到这个模式串。", "inputFormat": "第一行包含三个整数 $N$, $M$ 和 $K$，满足 $1\\leqslant K\\leqslant M$。\n\n接下来 $N$ 行，每行一个长度为 $M$ 的字符串。\n\n数据保证模式串一定存在。\n\n**警告：本题 IO 量较大，对于 Java 或 Python 语言，请使用较为快速的 IO 操作。**", "outputFormat": "输出一个整数表示模式串的编号。", "hint": "## 限制与提示\n\n|子任务|分值|数据范围|特殊约定|\n|:----:|:--:|:------:|:------:|\n|$1$   |$27$|$3\\leqslant N,\\,M\\leqslant 100$|无|\n|$2$   |$19$|$3\\leqslant N,\\,M\\leqslant 1800$|所有字符串中只包含 ``A`` 和 ``C``|\n|$3$   |$28$|$3\\leqslant N,\\,M\\leqslant 4100$|所有字符串中只包含 ``A`` 和 ``C``|\n|$4$   |$26$|$3\\leqslant N,\\,M\\leqslant 4100$|无|\n\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2018] Genetic Engineering", "background": "", "description": "**This problem is translated from [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day 2 “[Genetics](https://boi18-day2-open.kattis.com/problems/boi18.genetics)”.**\n\nYou are given $N$ strings of length $M$, consisting only of `A`, `T`, `G`, and `C`, numbered $1 \\ldots N$. One of them is the pattern string. Each of the other $N - 1$ strings differs from the pattern string in exactly $K$ characters. Find this pattern string.", "inputFormat": "The first line contains three integers $N$, $M$, and $K$, satisfying $1\\leqslant K\\leqslant M$.\n\nThe next $N$ lines each contain a string of length $M$.\n\nIt is guaranteed that the pattern string exists.\n\n**Warning: The I/O size of this problem is large. For Java or Python, please use faster I/O methods.**", "outputFormat": "Output one integer, the index of the pattern string.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2018] 基因工程", "background": "", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day2「[Genetics](https://boi18-day2-open.kattis.com/problems/boi18.genetics)」**\n\n给定 $N$ 个长度为 $M$ 的只由 ``A``、``T``、``G`` 和 ``C`` 组成的字符串，分别编号为 $1\\ldots N$，其中一个是模式串，其它 $N-1$ 个字符串与模式串都恰好有 $K$ 个字符不同，找到这个模式串。", "inputFormat": "第一行包含三个整数 $N$, $M$ 和 $K$，满足 $1\\leqslant K\\leqslant M$。\n\n接下来 $N$ 行，每行一个长度为 $M$ 的字符串。\n\n数据保证模式串一定存在。\n\n**警告：本题 IO 量较大，对于 Java 或 Python 语言，请使用较为快速的 IO 操作。**", "outputFormat": "输出一个整数表示模式串的编号。", "hint": "## 限制与提示\n\n|子任务|分值|数据范围|特殊约定|\n|:----:|:--:|:------:|:------:|\n|$1$   |$27$|$3\\leqslant N,\\,M\\leqslant 100$|无|\n|$2$   |$19$|$3\\leqslant N,\\,M\\leqslant 1800$|所有字符串中只包含 ``A`` 和 ``C``|\n|$3$   |$28$|$3\\leqslant N,\\,M\\leqslant 4100$|所有字符串中只包含 ``A`` 和 ``C``|\n|$4$   |$26$|$3\\leqslant N,\\,M\\leqslant 4100$|无|\n\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN"}}}
{"pid": "P4796", "type": "P", "difficulty": 5, "samples": [["4 3 3\n1 2 1 3\n1 2\n2 3\n4 2", "10\n\n"], ["9 11 4\n1 2 3 4 1 2 1 2 2\n1 2\n1 3\n2 3\n2 4\n3 6\n6 2\n6 5\n4 3\n4 5\n7 8\n9 8", "70"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000, 768000]}, "tags": ["搜索", "2018", "枚举", "记忆化搜索", "BalticOI（波罗的海）", "状压 DP"], "title": "[BalticOI 2018] 路径", "background": "", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day2「[Paths](https://boi18-day2-open.kattis.com/problems/boi18.paths)」**\n\n给定一张 $N$ 个点 $M$ 条边的无向图，每个点有一个颜色，所有点的颜色共有 $K$ 种，编号为 $1\\ldots K$。求图上有多少条长度至少为 $2$ 的简单路径，满足路径上的每一个点的颜色互不相同。\n\n路径上的点的连接顺序不同看作不同的两条路径。", "inputFormat": "第一行包含三个整数 $N$, $M$ 和 $K$。\n\n第二行包含 $N$ 个在 $1$ 到 $K$ 之间的整数，表示每个点的颜色。\n\n接下来的 $M$ 行每行两个整数 $a$ 和 $b$，表示图的一条边。\n\n数据保证图无自环无重边。", "outputFormat": "输出一个整数表示每一个点颜色都不同的路径条数。保证答案不会超过 $10^{18}$。", "hint": "#### 样例 1 解释\n![](https://cdn.vjudge.net.cn/864bb05c1889b6f8dfd6a1432020613e)\n\n样例 1 中表达的图如上图所示。每个点的底色分别为白色（颜色 $1$）、灰色（颜色 $2$）或黑色（颜色 $3$）。共有 $10$ 条路径满足路径上的所有点的颜色都不同。它们是：``1-2``, ``2-1``, ``2-3``, ``3-2``, ``2-4``, ``4-2``, ``1-2-4``, ``4-2-1``, ``3-2-4`` 和 ``4-2-3``。\n\n注意 ``1`` 不能看作是一条路径，因为一条路径至少连接两个点。``1-2-3`` 也不满足条件，因为有两个点都是 $1$ 号颜色。\n\n|子任务|分值|数据范围|\n|:--:|:--:|:--:|\n|$1$|$23$|$1 \\leqslant N,M \\leqslant 100, 1 \\leqslant K \\leqslant 4$|\n|$2$|$20$|$1 \\leqslant N,M \\leqslant 300\\,000, 1 \\leqslant K \\leqslant 3$|\n|$3$|$27$|$1 \\leqslant N,M \\leqslant 300\\,000, 1 \\leqslant K \\leqslant 4$|\n|$4$|$30$|$1 \\leqslant N,M \\leqslant 100\\,000, 1 \\leqslant K \\leqslant 5$|\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2018] Paths", "background": "", "description": "**This problem is translated from [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day 2 “[Paths](https://boi18-day2-open.kattis.com/problems/boi18.paths)”.**\n\nGiven an undirected graph with $N$ vertices and $M$ edges. Each vertex has a color. There are $K$ different colors in total, numbered $1 \\ldots K$. Find how many simple paths in the graph of length at least $2$ satisfy that all vertices on the path have pairwise distinct colors.\n\nPaths with different visiting orders of vertices are considered different paths.", "inputFormat": "The first line contains three integers $N$, $M$, and $K$.\n\nThe second line contains $N$ integers between $1$ and $K$, representing the color of each vertex.\n\nEach of the next $M$ lines contains two integers $a$ and $b$, denoting an edge of the graph.\n\nIt is guaranteed that the graph has no self-loops and no multiple edges.", "outputFormat": "Output one integer: the number of paths in which all vertices have distinct colors. It is guaranteed that the answer will not exceed $10^{18}$.", "hint": "#### Explanation for Sample 1\n\n![](https://cdn.vjudge.net.cn/864bb05c1889b6f8dfd6a1432020613e)\n\nThe graph in Sample 1 is shown in the figure above. The background color of each vertex is white (color $1$), gray (color $2$), or black (color $3$). There are $10$ paths whose vertices all have distinct colors. They are: ``1-2``, ``2-1``, ``2-3``, ``3-2``, ``2-4``, ``4-2``, ``1-2-4``, ``4-2-1``, ``3-2-4``, and ``4-2-3``.\n\nNote that ``1`` cannot be considered a path, because a path must connect at least two vertices. Also, ``1-2-3`` does not satisfy the condition, because two vertices have color $1$.\n\n|Subtask|Score|Constraints|\n|:--:|:--:|:--:|\n|$1$|$23$|$1 \\leqslant N,M \\leqslant 100, 1 \\leqslant K \\leqslant 4$|\n|$2$|$20$|$1 \\leqslant N,M \\leqslant 300\\,000, 1 \\leqslant K \\leqslant 3$|\n|$3$|$27$|$1 \\leqslant N,M \\leqslant 300\\,000, 1 \\leqslant K \\leqslant 4$|\n|$4$|$30$|$1 \\leqslant N,M \\leqslant 100\\,000, 1 \\leqslant K \\leqslant 5$|\n\nThanks to Hatsune_Miku for providing the translation.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2018] 路径", "background": "", "description": "**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day2「[Paths](https://boi18-day2-open.kattis.com/problems/boi18.paths)」**\n\n给定一张 $N$ 个点 $M$ 条边的无向图，每个点有一个颜色，所有点的颜色共有 $K$ 种，编号为 $1\\ldots K$。求图上有多少条长度至少为 $2$ 的简单路径，满足路径上的每一个点的颜色互不相同。\n\n路径上的点的连接顺序不同看作不同的两条路径。", "inputFormat": "第一行包含三个整数 $N$, $M$ 和 $K$。\n\n第二行包含 $N$ 个在 $1$ 到 $K$ 之间的整数，表示每个点的颜色。\n\n接下来的 $M$ 行每行两个整数 $a$ 和 $b$，表示图的一条边。\n\n数据保证图无自环无重边。", "outputFormat": "输出一个整数表示每一个点颜色都不同的路径条数。保证答案不会超过 $10^{18}$。", "hint": "#### 样例 1 解释\n![](https://cdn.vjudge.net.cn/864bb05c1889b6f8dfd6a1432020613e)\n\n样例 1 中表达的图如上图所示。每个点的底色分别为白色（颜色 $1$）、灰色（颜色 $2$）或黑色（颜色 $3$）。共有 $10$ 条路径满足路径上的所有点的颜色都不同。它们是：``1-2``, ``2-1``, ``2-3``, ``3-2``, ``2-4``, ``4-2``, ``1-2-4``, ``4-2-1``, ``3-2-4`` 和 ``4-2-3``。\n\n注意 ``1`` 不能看作是一条路径，因为一条路径至少连接两个点。``1-2-3`` 也不满足条件，因为有两个点都是 $1$ 号颜色。\n\n|子任务|分值|数据范围|\n|:--:|:--:|:--:|\n|$1$|$23$|$1 \\leqslant N,M \\leqslant 100, 1 \\leqslant K \\leqslant 4$|\n|$2$|$20$|$1 \\leqslant N,M \\leqslant 300\\,000, 1 \\leqslant K \\leqslant 3$|\n|$3$|$27$|$1 \\leqslant N,M \\leqslant 300\\,000, 1 \\leqslant K \\leqslant 4$|\n|$4$|$30$|$1 \\leqslant N,M \\leqslant 100\\,000, 1 \\leqslant K \\leqslant 5$|\n\n感谢 Hatsune_Miku 提供的翻译", "locale": "zh-CN"}}}
{"pid": "P4797", "type": "P", "difficulty": 6, "samples": [["5 6\n1 2\n1 3\n2 3\n4 3\n5 2\n4 5", "2 3 4 5"], ["4 5\n1 2\n2 3\n3 4\n4 1\n1 3", "no"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "Special Judge", "CEOI（中欧）"], "title": "[CEOI 2015] 波将金的路径 (Day1)", "background": null, "description": "**译自 [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day1 T1「[Potemkin cycle](https://ceoi2015.fi.muni.cz/day1/eng/day1task1-eng.pdf)」**\n\n**简要题意** $\\,$ 给一张无向图，$|V|=N,$ $|E|=R$。请找一条简单环，设该环的点集为 $V'$，要求：$|V'| \\ge 4$，且 $V'$ 的导出子图只含该环本身。\n\n---\n\n波将金公爵的领土可以视作一张无向图，他要求你找到一条路线，经过的结点以序列 $s_1,\\dots,s_m$表示，且满足以下要求：\n\n - $m \\geq 4$\n\n- 经过的每个结点互不相同（即对于所有$i \\neq j$满足$s_i \\neq s_j$）\n\n- 对于 $i = 1,\\dots,m - 1$，满足 $s_i$ 与 $s_{i + 1}$ 直接连接，且 $s_m$ 与 $s_1$ 直接连接。\n\n- 序列中的结点没有其他的边（即对于所有 $i < j$，使得 $j \\neq i + 1$ 且 $i \\neq 1$ 或者是 $j \\neq m$，结点 $s_i$ 和 $s_j$ 之间没有边）。", "inputFormat": "第一行，两个非负整数 $N$ 和 $R(0 \\leq N \\leq 1\\ 000,0 \\leq R \\leq 100\\ 000)$，分别表示结点的个数和道路的个数。\n\n接下来 $R$ 行，其中第 $i$ 行包括两个不同的正整数 $a_i$ 和 $b_i(1 \\leq a_i,b_i \\leq N)$，表示结点 $a_i$ 与 $b_i$ 之间有一条边。\n\n保证每两个结点最多有一条边连接。", "outputFormat": "输出序列 $s_1,\\dots,s_m$，表示问题描述的序列（如果有多解任意输出一个）。如果无解，输出`no`。", "hint": "$N$ 与 $R$ 的上限如下表所示：\n\n|数据点|$1-3$|$4-5$|$6-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|$N$ 的上限|$10$|$100$|$300$|$1\\ 000$|\n|$R$ 的上限|$45$|$1\\ 000$|$20\\ 000$|$100\\ 000$|", "locale": "zh-CN", "translations": {"en": {"title": "[CEOI 2015] Potemkin Cycle (Day1)", "background": "", "description": "**Translated from [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day1 T1 “[Potemkin cycle](https://ceoi2015.fi.muni.cz/day1/eng/day1task1-eng.pdf)”.**\n\n**Brief statement** Given an undirected graph with $|V|=N$ and $|E|=R$. Find a simple cycle. Let the vertex set of this cycle be $V'$. It must satisfy: $|V'| \\ge 4$, and the subgraph induced by $V'$ contains only this cycle itself.\n\n---\n\nDuke Potemkin’s territory can be viewed as an undirected graph. He asks you to find a route whose visited vertices are represented by a sequence $s_1,\\dots,s_m$, and it must satisfy the following:\n\n- $m \\geq 4$.\n\n- All visited vertices are pairwise distinct (i.e., for all $i \\neq j$, $s_i \\neq s_j$).\n\n- For $i = 1,\\dots,m - 1$, $s_i$ is directly connected to $s_{i + 1}$, and $s_m$ is directly connected to $s_1$.\n\n- There are no other edges among the vertices in the sequence (i.e., for all $i < j$ such that $j \\neq i + 1$ and either $i \\neq 1$ or $j \\neq m$, there is no edge between $s_i$ and $s_j$).", "inputFormat": "The first line contains two non-negative integers $N$ and $R$ $(0 \\leq N \\leq 1\\ 000, 0 \\leq R \\leq 100\\ 000)$, representing the number of vertices and the number of roads (edges), respectively.\n\nThe next $R$ lines each contain two distinct positive integers $a_i$ and $b_i$ $(1 \\leq a_i,b_i \\leq N)$, indicating that there is an edge between vertices $a_i$ and $b_i$.\n\nIt is guaranteed that there is at most one edge between any pair of vertices.", "outputFormat": "Output the sequence $s_1,\\dots,s_m$ that satisfies the requirements in the description (if there are multiple solutions, output any one). If there is no solution, output `no`.", "hint": "The upper limits of $N$ and $R$ are shown in the table below:\n\n|Test case group|$1-3$|$4-5$|$6-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|Upper limit of $N$|$10$|$100$|$300$|$1\\ 000$|\n|Upper limit of $R$|$45$|$1\\ 000$|$20\\ 000$|$100\\ 000$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CEOI 2015] 波将金的路径 (Day1)", "background": null, "description": "**译自 [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day1 T1「[Potemkin cycle](https://ceoi2015.fi.muni.cz/day1/eng/day1task1-eng.pdf)」**\n\n**简要题意** $\\,$ 给一张无向图，$|V|=N,$ $|E|=R$。请找一条简单环，设该环的点集为 $V'$，要求：$|V'| \\ge 4$，且 $V'$ 的导出子图只含该环本身。\n\n---\n\n波将金公爵的领土可以视作一张无向图，他要求你找到一条路线，经过的结点以序列 $s_1,\\dots,s_m$表示，且满足以下要求：\n\n - $m \\geq 4$\n\n- 经过的每个结点互不相同（即对于所有$i \\neq j$满足$s_i \\neq s_j$）\n\n- 对于 $i = 1,\\dots,m - 1$，满足 $s_i$ 与 $s_{i + 1}$ 直接连接，且 $s_m$ 与 $s_1$ 直接连接。\n\n- 序列中的结点没有其他的边（即对于所有 $i < j$，使得 $j \\neq i + 1$ 且 $i \\neq 1$ 或者是 $j \\neq m$，结点 $s_i$ 和 $s_j$ 之间没有边）。", "inputFormat": "第一行，两个非负整数 $N$ 和 $R(0 \\leq N \\leq 1\\ 000,0 \\leq R \\leq 100\\ 000)$，分别表示结点的个数和道路的个数。\n\n接下来 $R$ 行，其中第 $i$ 行包括两个不同的正整数 $a_i$ 和 $b_i(1 \\leq a_i,b_i \\leq N)$，表示结点 $a_i$ 与 $b_i$ 之间有一条边。\n\n保证每两个结点最多有一条边连接。", "outputFormat": "输出序列 $s_1,\\dots,s_m$，表示问题描述的序列（如果有多解任意输出一个）。如果无解，输出`no`。", "hint": "$N$ 与 $R$ 的上限如下表所示：\n\n|数据点|$1-3$|$4-5$|$6-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|$N$ 的上限|$10$|$100$|$300$|$1\\ 000$|\n|$R$ 的上限|$45$|$1\\ 000$|$20\\ 000$|$100\\ 000$|", "locale": "zh-CN"}}}
{"pid": "P4798", "type": "P", "difficulty": 4, "samples": [["3\n1 2 2", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["动态规划 DP", "2015", "CEOI（中欧）", "数位 DP"], "title": "[CEOI 2015] 卡尔文球锦标赛 (Day1)", "background": null, "description": "**译自 [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day1 T2「[Calvinball championship](https://ceoi2015.fi.muni.cz/day1/eng/day1task2-eng.pdf)」**\n\n一场卡尔文球比赛会有 $n$ 名选手参与，他们的编号分别为 $1\\dots n$，分为若干个非空的球队。我们规定球队之间按照每个球队编号最小的选手的编号排序，并且以从 1 开始的连续整数编号。\n\n举个栗子，譬如 1 号选手自己成一队，2, 3 和 5 号选手成一队，4 和 6 号选手成一队。\n\n>\\> $\\ \\texttt{1}$  \n>\\> $\\ \\texttt{2 3 5}$  \n>\\> $\\ \\texttt{4 6}$\n\n那么 1 号选手的球队就是 1 号球队，2 号选手的球队就是 2 号球队，4 号选手的球队就是 3 号球队。\n\n>\\> $\\ \\texttt{1|1}$  \n>\\> $\\ \\texttt{2|2 3 5}$  \n>\\> $\\ \\texttt{3|4 6}$\n\n每个人每天会选择不同的球队，我们可以在记录时省略选手的编号，仅记录每个位置对应选手所属球队编号的序列（上述例子为 `1 2 2 3 2 3`），因为每天的选手是一样的。当可能的选择方案全部被使用过后，锦标赛就结束了。\n\n由于选择方案十分多，选择困难症患者纷纷表示力不从心。今年，我们决定根据记录的序列的字典序来选择方案。因此，第一天，所有人都在一个队 `1 1 1 1 1 1`；第二天，所有人都与 6 号针锋相对 `1 1 1 1 1 2`……在最后一天，所有人互相打响战争 `1 2 3 4 5 6`。\n\n对于给定的球队记录，请你算出将会在未来的哪一天使用该记录。输出这个数字对 $1\\ 000\\ 007$ 取余的结果。", "inputFormat": "第一行，一个正整数 $n(1 \\leq n \\leq 10\\ 000)$。\n\n第二行，$n$ 个以空格分隔的正整数，表示任务所给的球队记录。", "outputFormat": "输出一个正整数，表示任务所给的球队记录将会被使用的天数对 $1\\ 000\\ 007$ 取余的结果。第一天的天数为 1。", "hint": "请注意，三人比赛中可能的选择有 `1 1 1` `1 1 2` `1 2 1` `1 2 2` 和 `1 2 3`。\n\n### 数据范围与提示\n\n|数据点|$1-3$|$4-5$|$6-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|$n\\le$|$14$|$100$|$1\\ 000$|$10\\ 000$|", "locale": "zh-CN", "translations": {"en": {"title": "[CEOI 2015] Calvinball Championship (Day1)", "background": "", "description": "**Translated from [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day1 T2 “[Calvinball championship](https://ceoi2015.fi.muni.cz/day1/eng/day1task2-eng.pdf)”.**\n\nA Calvinball match has $n$ players participating, numbered $1 \\dots n$, and they are divided into several non-empty teams. We define the order of teams by sorting them according to the smallest player number in each team, and then numbering the teams with consecutive integers starting from $1$.\n\nFor example, suppose player $1$ forms a team alone; players $2, 3,$ and $5$ form a team; and players $4$ and $6$ form a team.\n\n>\\> $\\ \\texttt{1}$  \n>\\> $\\ \\texttt{2 3 5}$  \n>\\> $\\ \\texttt{4 6}$\n\nThen player $1$’s team is team $1$, player $2$’s team is team $2$, and player $4$’s team is team $3$.\n\n>\\> $\\ \\texttt{1|1}$  \n>\\> $\\ \\texttt{2|2 3 5}$  \n>\\> $\\ \\texttt{3|4 6}$\n\nEach day, everyone will choose a different team partition. When recording, we can omit the player numbers and only record the sequence of team numbers that each position belongs to (in the above example, `1 2 2 3 2 3`), because the players are the same every day. The championship ends when all possible choices have been used.\n\nSince there are too many choices, indecisive people find it hard to handle. This year, we decide to choose the partitions according to the lexicographical order of the recorded sequences. Therefore, on the first day, everyone is in one team: `1 1 1 1 1 1`; on the second day, everyone opposes player $6$: `1 1 1 1 1 2`; … on the last day, everyone is in their own team: `1 2 3 4 5 6`.\n\nGiven a recorded team sequence, compute on which future day this record will be used. Output this number modulo $1\\ 000\\ 007$.", "inputFormat": "The first line contains a positive integer $n(1 \\leq n \\leq 10\\ 000)$.\n\nThe second line contains $n$ positive integers separated by spaces, representing the team record given in the task.", "outputFormat": "Output a positive integer: the day on which the given team record will be used, modulo $1\\ 000\\ 007$. The first day is numbered $1$.", "hint": "Please note that for a three-player match, the possible choices are `1 1 1`, `1 1 2`, `1 2 1`, `1 2 2`, and `1 2 3`.\n\n### Constraints and Hints\n\n|Test case|$1-3$|$4-5$|$6-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|$n \\le$|$14$|$100$|$1\\ 000$|$10\\ 000$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CEOI 2015] 卡尔文球锦标赛 (Day1)", "background": null, "description": "**译自 [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day1 T2「[Calvinball championship](https://ceoi2015.fi.muni.cz/day1/eng/day1task2-eng.pdf)」**\n\n一场卡尔文球比赛会有 $n$ 名选手参与，他们的编号分别为 $1\\dots n$，分为若干个非空的球队。我们规定球队之间按照每个球队编号最小的选手的编号排序，并且以从 1 开始的连续整数编号。\n\n举个栗子，譬如 1 号选手自己成一队，2, 3 和 5 号选手成一队，4 和 6 号选手成一队。\n\n>\\> $\\ \\texttt{1}$  \n>\\> $\\ \\texttt{2 3 5}$  \n>\\> $\\ \\texttt{4 6}$\n\n那么 1 号选手的球队就是 1 号球队，2 号选手的球队就是 2 号球队，4 号选手的球队就是 3 号球队。\n\n>\\> $\\ \\texttt{1|1}$  \n>\\> $\\ \\texttt{2|2 3 5}$  \n>\\> $\\ \\texttt{3|4 6}$\n\n每个人每天会选择不同的球队，我们可以在记录时省略选手的编号，仅记录每个位置对应选手所属球队编号的序列（上述例子为 `1 2 2 3 2 3`），因为每天的选手是一样的。当可能的选择方案全部被使用过后，锦标赛就结束了。\n\n由于选择方案十分多，选择困难症患者纷纷表示力不从心。今年，我们决定根据记录的序列的字典序来选择方案。因此，第一天，所有人都在一个队 `1 1 1 1 1 1`；第二天，所有人都与 6 号针锋相对 `1 1 1 1 1 2`……在最后一天，所有人互相打响战争 `1 2 3 4 5 6`。\n\n对于给定的球队记录，请你算出将会在未来的哪一天使用该记录。输出这个数字对 $1\\ 000\\ 007$ 取余的结果。", "inputFormat": "第一行，一个正整数 $n(1 \\leq n \\leq 10\\ 000)$。\n\n第二行，$n$ 个以空格分隔的正整数，表示任务所给的球队记录。", "outputFormat": "输出一个正整数，表示任务所给的球队记录将会被使用的天数对 $1\\ 000\\ 007$ 取余的结果。第一天的天数为 1。", "hint": "请注意，三人比赛中可能的选择有 `1 1 1` `1 1 2` `1 2 1` `1 2 2` 和 `1 2 3`。\n\n### 数据范围与提示\n\n|数据点|$1-3$|$4-5$|$6-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|$n\\le$|$14$|$100$|$1\\ 000$|$10\\ 000$|", "locale": "zh-CN"}}}
{"pid": "P4799", "type": "P", "difficulty": 4, "samples": [["5 1000\n100 1500 500 500 1000", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["搜索", "2015", "CEOI（中欧）", "折半搜索 meet in the middle"], "title": "[CEOI 2015] 世界冰球锦标赛 (Day2)", "background": "", "description": " **译自 [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day2 T1「[Ice Hockey World Championship](https://ceoi2015.fi.muni.cz/day2/eng/day2task1-eng.pdf)」**\n\n> 今年的世界冰球锦标赛在捷克举行。Bobek 已经抵达布拉格，他不是任何团队的粉丝，也没有时间观念。他只是单纯的想去看几场比赛。如果他有足够的钱，他会去看所有的比赛。不幸的是，他的财产十分有限，他决定把所有财产都用来买门票。\n\n给出 Bobek 的预算和每场比赛的票价，试求：如果总票价不超过预算，他有多少种观赛方案。如果存在以其中一种方案观看某场比赛而另一种方案不观看，则认为这两种方案不同。", "inputFormat": "第一行，两个正整数 $N$ 和 $M(1 \\leq N \\leq 40,1 \\leq M \\leq 10^{18})$，表示比赛的个数和 Bobek 那家徒四壁的财产。  \n\n第二行，$N$ 个以空格分隔的正整数，均不超过 $10^{16}$，代表每场比赛门票的价格。", "outputFormat": "输出一行，表示方案的个数。由于 $N$ 十分大，注意：答案 $\\le 2^{40}$。\n", "hint": "#### 样例解释\n八种方案分别是：\n\n - 一场都不看，溜了溜了  \n - 价格 $100$ 的比赛  \n - 第一场价格 $500$ 的比赛  \n - 第二场价格 $500$ 的比赛  \n - 价格 $100$ 的比赛和第一场价格 $500$ 的比赛  \n - 价格 $100$ 的比赛和第二场价格 $500$ 的比赛  \n - 两场价格 $500$ 的比赛  \n - 价格 $1000$ 的比赛\n\n有十组数据，每通过一组数据你可以获得 10 分。各组数据的数据范围如下表所示：\n\n|数据组号|$1-2$|$3-4$|$5-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|$N \\leq$|$10$|$20$|$40$|$40$|\n|$M \\leq$|$10^6$|$10^{18}$|$10^6$|$10^{18}$|", "locale": "zh-CN", "translations": {"en": {"title": "[CEOI 2015] Ice Hockey World Championship (Day2)", "background": "", "description": "**Translated from [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day2 T1 “[Ice Hockey World Championship](https://ceoi2015.fi.muni.cz/day2/eng/day2task1-eng.pdf)”.**\n\n> This year’s Ice Hockey World Championship is held in the Czech Republic. Bobek has arrived in Prague. He is not a fan of any team, and he has no sense of time. He simply wants to watch some matches. If he had enough money, he would watch all the matches. Unfortunately, his money is very limited, so he decides to spend all his money on tickets.\n\nGiven Bobek’s budget and the ticket price of each match, find: how many different ways he can choose matches to watch such that the total ticket cost does not exceed the budget. If there exists a match that is watched in one plan but not watched in another plan, then the two plans are considered different.", "inputFormat": "The first line contains two positive integers $N$ and $M(1 \\leq N \\leq 40,1 \\leq M \\leq 10^{18})$, denoting the number of matches and Bobek’s extremely limited budget.\n\nThe second line contains $N$ positive integers separated by spaces, each not exceeding $10^{16}$, representing the ticket price of each match.", "outputFormat": "Output one line containing the number of plans. Since $N$ is very large, note that the answer $\\le 2^{40}$.", "hint": "#### Sample Explanation\n\nThe eight plans are:\n\n- Watch no matches and leave.  \n- The match with price $100$.  \n- The first match with price $500$.  \n- The second match with price $500$.  \n- The match with price $100$ and the first match with price $500$.  \n- The match with price $100$ and the second match with price $500$.  \n- Both matches with price $500$.  \n- The match with price $1000$.\n\nThere are 10 test groups. For each group you pass, you get 10 points. The Constraints for each group are shown in the table below:\n\n|Test group|$1-2$|$3-4$|$5-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|$N \\leq$|$10$|$20$|$40$|$40$|\n|$M \\leq$|$10^6$|$10^{18}$|$10^6$|$10^{18}$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CEOI 2015] 世界冰球锦标赛 (Day2)", "background": "", "description": " **译自 [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day2 T1「[Ice Hockey World Championship](https://ceoi2015.fi.muni.cz/day2/eng/day2task1-eng.pdf)」**\n\n> 今年的世界冰球锦标赛在捷克举行。Bobek 已经抵达布拉格，他不是任何团队的粉丝，也没有时间观念。他只是单纯的想去看几场比赛。如果他有足够的钱，他会去看所有的比赛。不幸的是，他的财产十分有限，他决定把所有财产都用来买门票。\n\n给出 Bobek 的预算和每场比赛的票价，试求：如果总票价不超过预算，他有多少种观赛方案。如果存在以其中一种方案观看某场比赛而另一种方案不观看，则认为这两种方案不同。", "inputFormat": "第一行，两个正整数 $N$ 和 $M(1 \\leq N \\leq 40,1 \\leq M \\leq 10^{18})$，表示比赛的个数和 Bobek 那家徒四壁的财产。  \n\n第二行，$N$ 个以空格分隔的正整数，均不超过 $10^{16}$，代表每场比赛门票的价格。", "outputFormat": "输出一行，表示方案的个数。由于 $N$ 十分大，注意：答案 $\\le 2^{40}$。\n", "hint": "#### 样例解释\n八种方案分别是：\n\n - 一场都不看，溜了溜了  \n - 价格 $100$ 的比赛  \n - 第一场价格 $500$ 的比赛  \n - 第二场价格 $500$ 的比赛  \n - 价格 $100$ 的比赛和第一场价格 $500$ 的比赛  \n - 价格 $100$ 的比赛和第二场价格 $500$ 的比赛  \n - 两场价格 $500$ 的比赛  \n - 价格 $1000$ 的比赛\n\n有十组数据，每通过一组数据你可以获得 10 分。各组数据的数据范围如下表所示：\n\n|数据组号|$1-2$|$3-4$|$5-7$|$8-10$|\n|-|:-:|:-:|:-:|:-:|\n|$N \\leq$|$10$|$20$|$40$|$40$|\n|$M \\leq$|$10^6$|$10^{18}$|$10^6$|$10^{18}$|", "locale": "zh-CN"}}}
{"pid": "P4800", "type": "P", "difficulty": 6, "samples": [["4 3\n2\n1 1 7 3\n3 2 4 2\n4\n1 2 2 3\n1 1 4 3\n4 2 4 2\n1 3 4 3", "4\n4\n2\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2015", "CEOI（中欧）", "差分"], "title": "[CEOI 2015] 核能国度 (Day2)", "background": "", "description": "核能国可以看作一个由 $W \\times H$ 的方格组成的矩形。核能国有 $N$ 个核电站，每个核电站占用一个方格。不幸的是，核能国遭遇了百年一遇的特大地震，导致所有的核电站都发生了核泄漏。\n\n每个核电站的核泄漏程度可以用两个整数 $a, b$ 来表示。如果位于 $P=[x_P,y_P]$ 的核电站爆炸，方格 $C=[x_C,y_C]$ 会增加 $\\mathrm{max}(0,$ $a-b\\times d(P,C))$ 贝克的辐射（贝克是单位），其中 $d(P,C)$ 是两个方格的切比雪夫距离，即 $d(P,C) =$ $\\mathrm{max}(|x_P - x_C|,$ $|y_P - y_C|)$。  \n\n一个方格可能会受到多处核泄漏的影响。  \n\n例如，如果一个 $a = 7,$ $b = 3$ 的核电站爆炸了，所在的方格 $X$ 会受到 $7$ 贝克辐射（贝克是单位），满足 $d(X,Y) = 1$ 的 $8$ 个方格 $Y$ 会受到 $4$ 贝克辐射，满足 $d(X,Z) = 2$ 的 $16$ 个方格 $Z$ 会受到 $1$ 贝克辐射。\n\n环保部门给了你 $Q$ 组询问，每组询问会划定核能国领土中的一个矩形，请回答：矩形区域内（每个方格）所受的平均辐射量为多少。", "inputFormat": "第一行，两个正整数 $W$ 和 $H(W × H \\leq 2.5×10^6)$，分别表示核能国的宽度与高度。  \n\n第二行，一个正整数 $N$，表示核电站的个数 $(1 \\leq N \\leq 2×10^5)$。\n\n在接下来的 $N$ 行中，每行四个正整数 $x_i,y_i,a_i,b_i(1 \\leq x_i \\leq W,1 \\leq y_i \\leq H,1 \\leq a_i,b_i \\leq 10^9)$，表示有一个核电站位于方格 $[x_i,y_i]$，它的参数为 $a_i$ 与 $b_I$。每个格子最多有一个核电站。\n\n第 $N+3$ 行，一个正整数 $Q$，表示询问的次数 $(1 \\leq Q \\leq 2×10^5)$。\n\n在接下来的 $Q$ 行中，每行四个 正整数 $x_{1j},y_{1j},x_{2j},y_{2j}(1 \\leq x_{1j} \\leq x_{2j} \\leq W,1 \\leq y_{1j} \\leq y_{2j} \\leq H)$，表示该询问给出的矩形区域的左上角在 $[x_{1j},y_{1j}]$ 且它的右下角在 $[x_{2j},y_{2j}]$。\n\n你可以假设核能国内的总辐射量少于 $2^{63}$。", "outputFormat": "对于每个询问，输出一行表示给定矩形区域内所有方格的平均辐射量，四舍五入至整数。", "hint": "以下为两次爆炸后对每个方格产生的辐射量：\n```plain\n7 6 3 2\n4 6 5 2\n1 3 3 2\n```\n\n - $2^2$ 方形区域内的总辐射为 $14$，所以平均值为 $14\\div 4=3.5$，四舍五入至 $4$。\n\n - 整个核能国的总辐射为 $44$，所以平均值为 $44\\div 12 \\approx 3.67$，四舍五入至 $4$。\n\n - 单个格子的平均辐射量就是它所受到的辐射量。\n\n - 最后一行的平均辐射量为 $9\\div 4=2.25$，四舍五入至 $2$。\n\n有 14 组测试数据。奇数的测试组只包含 $a$ 是 $b$ 的倍数的核电站。对每个子任务的进一步限制如下：\n\n|测试组|进一步限制|分数|\n|:-:|:-:|:-:|\n|$1$|$H=1,N\\cdot W \\leq 10^8,Q \\cdot W \\leq 10^8$|$3$|\n|$2$|$H=1,N\\cdot W \\leq 10^8,Q \\cdot W \\leq 10^8$|$2$|\n|$3$|$N\\cdot W \\cdot H \\leq 10^8,Q \\cdot W \\cdot H \\leq 10^8$|$3$|\n|$4$|$N\\cdot W \\cdot H \\leq 10^8,Q \\cdot W \\cdot H \\leq 10^8$|$2$|\n|$5$|$H=1,N\\cdot W \\leq 10^8$|$6$|\n|$6$|$H=1,N\\cdot W \\leq 10^8$|$4$|\n|$7$|$N\\cdot W \\cdot H \\leq 10^8$|$6$|\n|$8$|$N\\cdot W \\cdot H \\leq 10^8$|$4$|\n|$9$|$H=1$|$15$|\n|$10$|$H=1$|$10$|\n|$11$|没有符合**界限**定义的爆炸事件|$15$|\n|$12$|没有符合**界限**定义的爆炸事件|$10$|\n|$13$|无|$12$|\n|$14$|无|$8$|\n\n如果核电站位于核能国的边境或是在离边境稍近的位置，那么爆炸可能也会影响到核能国之外的方格。影响到核能国外方格的爆炸被称作**界限**。", "locale": "zh-CN", "translations": {"en": {"title": "[CEOI 2015] Nuclear Country (Day2)", "background": "", "description": "Nuclear Country can be seen as a rectangle made of a $W \\times H$ grid of cells. There are $N$ nuclear power plants in Nuclear Country, and each plant occupies one cell. Unfortunately, Nuclear Country has suffered a once-in-a-century major earthquake, causing all nuclear power plants to leak radiation.\n\nThe leakage level of each nuclear power plant can be described by two integers $a, b$. If the plant at $P=[x_P,y_P]$ explodes, then a cell $C=[x_C,y_C]$ will receive an additional $\\mathrm{max}(0,$ $a-b\\times d(P,C))$ becquerels of radiation (becquerel is a unit), where $d(P,C)$ is the Chebyshev distance between the two cells, i.e. $d(P,C) =$ $\\mathrm{max}(|x_P - x_C|,$ $|y_P - y_C|)$.\n\nA cell may be affected by radiation leaks from multiple plants.\n\nFor example, if a plant with $a = 7,$ $b = 3$ explodes, the cell $X$ where it is located will receive $7$ becquerels of radiation. The $8$ cells $Y$ with $d(X,Y) = 1$ will receive $4$ becquerels, and the $16$ cells $Z$ with $d(X,Z) = 2$ will receive $1$ becquerel.\n\nThe environmental agency gives you $Q$ queries. Each query specifies a rectangle within Nuclear Country. You need to answer: what is the average radiation received (per cell) within that rectangular area.", "inputFormat": "The first line contains two positive integers $W$ and $H$ $(W \\times H \\leq 2.5\\times 10^6)$, representing the width and height of Nuclear Country.\n\nThe second line contains one positive integer $N$, the number of nuclear power plants $(1 \\leq N \\leq 2\\times 10^5)$.\n\nIn the next $N$ lines, each line contains four positive integers $x_i,y_i,a_i,b_i$ $(1 \\leq x_i \\leq W, 1 \\leq y_i \\leq H, 1 \\leq a_i,b_i \\leq 10^9)$, meaning there is a plant at cell $[x_i,y_i]$ with parameters $a_i$ and $b_i$. Each cell contains at most one plant.\n\nLine $N+3$ contains one positive integer $Q$, the number of queries $(1 \\leq Q \\leq 2\\times 10^5)$.\n\nIn the next $Q$ lines, each line contains four positive integers $x_{1j},y_{1j},x_{2j},y_{2j}$ $(1 \\leq x_{1j} \\leq x_{2j} \\leq W, 1 \\leq y_{1j} \\leq y_{2j} \\leq H)$, describing a query rectangle whose top-left corner is $[x_{1j},y_{1j}]$ and whose bottom-right corner is $[x_{2j},y_{2j}]$.\n\nYou may assume that the total radiation within Nuclear Country is less than $2^{63}$.", "outputFormat": "For each query, output one line with the average radiation over all cells in the given rectangle, rounded to the nearest integer.", "hint": "The following shows the radiation in each cell after two explosions:\n```plain\n7 6 3 2\n4 6 5 2\n1 3 3 2\n```\n\n- The total radiation in a $2^2$ square area is $14$, so the average is $14\\div 4=3.5$, which rounds to $4$.\n\n- The total radiation in the whole Nuclear Country is $44$, so the average is $44\\div 12 \\approx 3.67$, which rounds to $4$.\n\n- For a single cell, the average radiation is exactly the radiation it receives.\n\n- For the last row, the average is $9\\div 4=2.25$, which rounds to $2$.\n\nThere are 14 test cases. The odd-numbered test cases contain only plants where $a$ is a multiple of $b$. Further limits for each subtask are as follows:\n\n|Test case|Additional constraints|Score|\n|:-:|:-:|:-:|\n|$1$|$H=1,N\\cdot W \\leq 10^8,Q \\cdot W \\leq 10^8$|$3$|\n|$2$|$H=1,N\\cdot W \\leq 10^8,Q \\cdot W \\leq 10^8$|$2$|\n|$3$|$N\\cdot W \\cdot H \\leq 10^8,Q \\cdot W \\cdot H \\leq 10^8$|$3$|\n|$4$|$N\\cdot W \\cdot H \\leq 10^8,Q \\cdot W \\cdot H \\leq 10^8$|$2$|\n|$5$|$H=1,N\\cdot W \\leq 10^8$|$6$|\n|$6$|$H=1,N\\cdot W \\leq 10^8$|$4$|\n|$7$|$N\\cdot W \\cdot H \\leq 10^8$|$6$|\n|$8$|$N\\cdot W \\cdot H \\leq 10^8$|$4$|\n|$9$|$H=1$|$15$|\n|$10$|$H=1$|$10$|\n|$11$|There are no explosion events that satisfy the definition of **boundary**|$15$|\n|$12$|There are no explosion events that satisfy the definition of **boundary**|$10$|\n|$13$|None|$12$|\n|$14$|None|$8$|\n\nIf a nuclear power plant is on the border of Nuclear Country, or close to the border, its explosion may also affect cells outside Nuclear Country. An explosion that affects cells outside Nuclear Country is called a **boundary**.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CEOI 2015] 核能国度 (Day2)", "background": "", "description": "核能国可以看作一个由 $W \\times H$ 的方格组成的矩形。核能国有 $N$ 个核电站，每个核电站占用一个方格。不幸的是，核能国遭遇了百年一遇的特大地震，导致所有的核电站都发生了核泄漏。\n\n每个核电站的核泄漏程度可以用两个整数 $a, b$ 来表示。如果位于 $P=[x_P,y_P]$ 的核电站爆炸，方格 $C=[x_C,y_C]$ 会增加 $\\mathrm{max}(0,$ $a-b\\times d(P,C))$ 贝克的辐射（贝克是单位），其中 $d(P,C)$ 是两个方格的切比雪夫距离，即 $d(P,C) =$ $\\mathrm{max}(|x_P - x_C|,$ $|y_P - y_C|)$。  \n\n一个方格可能会受到多处核泄漏的影响。  \n\n例如，如果一个 $a = 7,$ $b = 3$ 的核电站爆炸了，所在的方格 $X$ 会受到 $7$ 贝克辐射（贝克是单位），满足 $d(X,Y) = 1$ 的 $8$ 个方格 $Y$ 会受到 $4$ 贝克辐射，满足 $d(X,Z) = 2$ 的 $16$ 个方格 $Z$ 会受到 $1$ 贝克辐射。\n\n环保部门给了你 $Q$ 组询问，每组询问会划定核能国领土中的一个矩形，请回答：矩形区域内（每个方格）所受的平均辐射量为多少。", "inputFormat": "第一行，两个正整数 $W$ 和 $H(W × H \\leq 2.5×10^6)$，分别表示核能国的宽度与高度。  \n\n第二行，一个正整数 $N$，表示核电站的个数 $(1 \\leq N \\leq 2×10^5)$。\n\n在接下来的 $N$ 行中，每行四个正整数 $x_i,y_i,a_i,b_i(1 \\leq x_i \\leq W,1 \\leq y_i \\leq H,1 \\leq a_i,b_i \\leq 10^9)$，表示有一个核电站位于方格 $[x_i,y_i]$，它的参数为 $a_i$ 与 $b_I$。每个格子最多有一个核电站。\n\n第 $N+3$ 行，一个正整数 $Q$，表示询问的次数 $(1 \\leq Q \\leq 2×10^5)$。\n\n在接下来的 $Q$ 行中，每行四个 正整数 $x_{1j},y_{1j},x_{2j},y_{2j}(1 \\leq x_{1j} \\leq x_{2j} \\leq W,1 \\leq y_{1j} \\leq y_{2j} \\leq H)$，表示该询问给出的矩形区域的左上角在 $[x_{1j},y_{1j}]$ 且它的右下角在 $[x_{2j},y_{2j}]$。\n\n你可以假设核能国内的总辐射量少于 $2^{63}$。", "outputFormat": "对于每个询问，输出一行表示给定矩形区域内所有方格的平均辐射量，四舍五入至整数。", "hint": "以下为两次爆炸后对每个方格产生的辐射量：\n```plain\n7 6 3 2\n4 6 5 2\n1 3 3 2\n```\n\n - $2^2$ 方形区域内的总辐射为 $14$，所以平均值为 $14\\div 4=3.5$，四舍五入至 $4$。\n\n - 整个核能国的总辐射为 $44$，所以平均值为 $44\\div 12 \\approx 3.67$，四舍五入至 $4$。\n\n - 单个格子的平均辐射量就是它所受到的辐射量。\n\n - 最后一行的平均辐射量为 $9\\div 4=2.25$，四舍五入至 $2$。\n\n有 14 组测试数据。奇数的测试组只包含 $a$ 是 $b$ 的倍数的核电站。对每个子任务的进一步限制如下：\n\n|测试组|进一步限制|分数|\n|:-:|:-:|:-:|\n|$1$|$H=1,N\\cdot W \\leq 10^8,Q \\cdot W \\leq 10^8$|$3$|\n|$2$|$H=1,N\\cdot W \\leq 10^8,Q \\cdot W \\leq 10^8$|$2$|\n|$3$|$N\\cdot W \\cdot H \\leq 10^8,Q \\cdot W \\cdot H \\leq 10^8$|$3$|\n|$4$|$N\\cdot W \\cdot H \\leq 10^8,Q \\cdot W \\cdot H \\leq 10^8$|$2$|\n|$5$|$H=1,N\\cdot W \\leq 10^8$|$6$|\n|$6$|$H=1,N\\cdot W \\leq 10^8$|$4$|\n|$7$|$N\\cdot W \\cdot H \\leq 10^8$|$6$|\n|$8$|$N\\cdot W \\cdot H \\leq 10^8$|$4$|\n|$9$|$H=1$|$15$|\n|$10$|$H=1$|$10$|\n|$11$|没有符合**界限**定义的爆炸事件|$15$|\n|$12$|没有符合**界限**定义的爆炸事件|$10$|\n|$13$|无|$12$|\n|$14$|无|$8$|\n\n如果核电站位于核能国的边境或是在离边境稍近的位置，那么爆炸可能也会影响到核能国之外的方格。影响到核能国外方格的爆炸被称作**界限**。", "locale": "zh-CN"}}}
{"pid": "P4801", "type": "P", "difficulty": 5, "samples": [["3 20\n18\n25\n18", "7 16"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2015", "枚举", "排序", "CCO（加拿大）"], "title": "[CCO 2015] 饥饿的狐狸", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/index.html) Day1 T1「[Hungry Fox](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/stage%202/day1.pdf)」**\n\n到你的宠物狐狸的晚餐时间啦！他的晚餐包含 $N$ 块饼干，第 $i$ 块饼干的温度是 $T_i$ 摄氏度。同时，在晚餐中还包含了一大盘 $W$ 摄氏度的水。\n\n在喝了一口水之后，你的狐狸开始吃饭了。每当他吃一块饼干时，这块饼干的美味度为当前饼干与吃/喝的前一样食物（包括饼干和水）的温度的差的绝对值。它可以在任意时间喝水（保证水喝不完），或按任意顺序吃饼干。\n\n最后狐狸获得的美味值为它吃下的每块饼干的美味度之和。请求出狐狸获得的最小和最大的美味值。", "inputFormat": "第一行两个整数 $N,W$，表示饼干总数和水的温度。  \n\n接下来 $N$ 行，每行一个整数 $T_i(1\\le i\\le N)$ 表示第 $i$ 块饼干的温度。", "outputFormat": "输出两个整数，分别为狐狸获得的最小和最大的美味值。", "hint": "要得到最小美味值，一种可行的方案是，狐狸先喝水，然后吃第一块饼干，再吃第三块饼干，接着喝水，最后吃下第二块饼干，这样做，它所感受到的温度分别为 $20,18,18,20,25$ 摄氏度，总的美味度为 $2+0+5=7$。\n\n要得到最大美味值，一种可行的方案是，狐狸先喝水，然后按顺序吃饼干，它所感受到的温度分别为 $20,18,25,18$ 摄氏度，总的美味度为 $2+7+7=16$。\n\n对于 $30\\%$ 及以上的数据， $W=0$；  \n\n对于 $100\\%$ 的数据， $1\\le N \\le 100000, 0\\le W \\le 10^9, 0 \\le T _ i \\le 10 ^ 9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Hungry Fox", "background": "", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/index.html) Day 1 T1 “[Hungry Fox](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/stage%202/day1.pdf)”.**\n\nIt is dinner time for your pet fox. His dinner contains $N$ cookies, and the temperature of the $i$-th cookie is $T_i$ degrees Celsius. Also, there is a large bowl of water at $W$ degrees Celsius.\n\nAfter taking a sip of water, your fox starts eating. Each time he eats a cookie, the tastiness of this cookie is the absolute value of the difference between the current cookie’s temperature and the temperature of the previous item he ate or drank (including both cookies and water). He may drink water at any time (the water never runs out), and he may eat the cookies in any order.\n\nThe fox’s final tastiness value is the sum of the tastiness of every cookie he eats. Please find the minimum and maximum possible tastiness values the fox can obtain.", "inputFormat": "The first line contains two integers $N, W$, representing the number of cookies and the temperature of the water.\n\nThe next $N$ lines each contain one integer $T_i \\ (1 \\le i \\le N)$, representing the temperature of the $i$-th cookie.", "outputFormat": "Output two integers: the minimum and the maximum tastiness values the fox can obtain.", "hint": "To achieve the minimum tastiness value, one possible plan is: the fox drinks water first, then eats the first cookie, then the third cookie, then drinks water, and finally eats the second cookie. In this way, the temperatures he experiences are $20, 18, 18, 20, 25$ degrees Celsius, and the total tastiness is $2 + 0 + 5 = 7$.\n\nTo achieve the maximum tastiness value, one possible plan is: the fox drinks water first, then eats the cookies in order. The temperatures he experiences are $20, 18, 25, 18$ degrees Celsius, and the total tastiness is $2 + 7 + 7 = 16$.\n\nFor at least $30\\%$ of the testdata, $W = 0$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 100000$, $0 \\le W \\le 10^9$, $0 \\le T_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 饥饿的狐狸", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/index.html) Day1 T1「[Hungry Fox](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/stage%202/day1.pdf)」**\n\n到你的宠物狐狸的晚餐时间啦！他的晚餐包含 $N$ 块饼干，第 $i$ 块饼干的温度是 $T_i$ 摄氏度。同时，在晚餐中还包含了一大盘 $W$ 摄氏度的水。\n\n在喝了一口水之后，你的狐狸开始吃饭了。每当他吃一块饼干时，这块饼干的美味度为当前饼干与吃/喝的前一样食物（包括饼干和水）的温度的差的绝对值。它可以在任意时间喝水（保证水喝不完），或按任意顺序吃饼干。\n\n最后狐狸获得的美味值为它吃下的每块饼干的美味度之和。请求出狐狸获得的最小和最大的美味值。", "inputFormat": "第一行两个整数 $N,W$，表示饼干总数和水的温度。  \n\n接下来 $N$ 行，每行一个整数 $T_i(1\\le i\\le N)$ 表示第 $i$ 块饼干的温度。", "outputFormat": "输出两个整数，分别为狐狸获得的最小和最大的美味值。", "hint": "要得到最小美味值，一种可行的方案是，狐狸先喝水，然后吃第一块饼干，再吃第三块饼干，接着喝水，最后吃下第二块饼干，这样做，它所感受到的温度分别为 $20,18,18,20,25$ 摄氏度，总的美味度为 $2+0+5=7$。\n\n要得到最大美味值，一种可行的方案是，狐狸先喝水，然后按顺序吃饼干，它所感受到的温度分别为 $20,18,25,18$ 摄氏度，总的美味度为 $2+7+7=16$。\n\n对于 $30\\%$ 及以上的数据， $W=0$；  \n\n对于 $100\\%$ 的数据， $1\\le N \\le 100000, 0\\le W \\le 10^9, 0 \\le T _ i \\le 10 ^ 9$。", "locale": "zh-CN"}}}
{"pid": "P4802", "type": "P", "difficulty": 4, "samples": [["3 3\n0 2 5\n0 1 4\n1 2 3", "7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["搜索", "2015", "CCO（加拿大）", "状压 DP"], "title": "[CCO 2015] 路短最", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day1 T2「[Artskjid](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)」**\n\n你可以通过许多的算法找到从一个地方到另外一个地方的最短路径。人们在他们的车上安装 GPS 设备然后他们的手机告诉他们最快的到达目的地的方式。然而，当在假期时，Troy 喜欢慢慢旅游。他想找最长的到目的地的路径以便他可以在路途中看许多新的以及有趣的地方。\n\n因此，一个有效的路径包含一个不同城市的序列 $c_1,c_2,...,c_k$，并且对于每个 $1\\le i<k$，有道路从 $c_i$ 通往 $c_{i+1}$。\n\n他不想重复访问任何城市，请帮他找出最长路径。", "inputFormat": "第一行输入包括两个整数 $n,m$，分别表示城市总数和连接城市间的道路数，两城市间至多有一条道路。城市编号从 $0$ 到 $n-1$，Troy 一开始在城市 $0$，城市 $n-1$ 是他的目的地。\n\n接下来 $m$ 行每行三个整数 $s,d,l$，每个三元组表示这里有一条长为 $l$ 的从城市 $s$ 到城市 $d$ 的路。每条路都是有向的，只能从 $s$ 到 $d$，不能反向。保证有一条从城市 $0$ 到 $n-1$ 的路径。", "outputFormat": "输出一个整数表示以城市 $0$ 为起点，以 $n-1$ 为终点的最长路径长度，并且其中不重复访问城市，路径长度是所经过的道路长度之和。", "hint": "最短路为直接走城市 $0$ 至城市 $2$ 的道路，长度为 $5$ km。最长路为 $0$ 至 $1$ 至 $2$， 长度 $4+3=7$ km。\n\n对于至少 $30\\%$ 的数据，$n\\le 8$；  \n\n对于 $100\\%$ 的数据，有 $2\\le n \\le 18,$ $1\\le m \\le n^2-n,$ $0\\le s,d \\le n-1,$ $s\\neq d,$ $1\\le l\\le 10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Shortest-Longest Path", "background": "", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day 1 T2 “[Artskjid](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)”**.\n\nYou can use many algorithms to find the shortest path from one place to another. People install GPS devices in their cars, and then their phones tell them the fastest way to reach the destination. However, when on vacation, Troy likes to travel slowly. He wants to find the longest path to the destination so that he can see many new and interesting places along the way.\n\nTherefore, a valid path consists of a sequence of distinct cities $c_1,c_2,\\ldots,c_k$, and for each $1\\le i<k$, there is a road from $c_i$ to $c_{i+1}$.\n\nHe does not want to visit any city more than once. Please help him find the longest path.", "inputFormat": "The first line contains two integers $n,m$, representing the number of cities and the number of roads between cities. There is at most one road between any pair of cities. Cities are numbered from $0$ to $n-1$. Troy starts at city $0$, and city $n-1$ is his destination.\n\nThe next $m$ lines each contain three integers $s,d,l$. Each triple indicates that there is a directed road of length $l$ from city $s$ to city $d$. Each road is one-way: you can only travel from $s$ to $d$, not in the reverse direction. It is guaranteed that there is a path from city $0$ to city $n-1$.", "outputFormat": "Output one integer: the length of the longest path that starts at city $0$ and ends at city $n-1$, without visiting any city more than once. The path length is the sum of the lengths of the roads used.", "hint": "The shortest path is to take the road directly from city $0$ to city $2$, with length $5$ km. The longest path is $0 \\to 1 \\to 2$, with length $4+3=7$ km.\n\nFor at least $30\\%$ of the testdata, $n\\le 8$.\n\nFor $100\\%$ of the testdata, $2\\le n \\le 18$, $1\\le m \\le n^2-n$, $0\\le s,d \\le n-1$, $s\\neq d$, $1\\le l\\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 路短最", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day1 T2「[Artskjid](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)」**\n\n你可以通过许多的算法找到从一个地方到另外一个地方的最短路径。人们在他们的车上安装 GPS 设备然后他们的手机告诉他们最快的到达目的地的方式。然而，当在假期时，Troy 喜欢慢慢旅游。他想找最长的到目的地的路径以便他可以在路途中看许多新的以及有趣的地方。\n\n因此，一个有效的路径包含一个不同城市的序列 $c_1,c_2,...,c_k$，并且对于每个 $1\\le i<k$，有道路从 $c_i$ 通往 $c_{i+1}$。\n\n他不想重复访问任何城市，请帮他找出最长路径。", "inputFormat": "第一行输入包括两个整数 $n,m$，分别表示城市总数和连接城市间的道路数，两城市间至多有一条道路。城市编号从 $0$ 到 $n-1$，Troy 一开始在城市 $0$，城市 $n-1$ 是他的目的地。\n\n接下来 $m$ 行每行三个整数 $s,d,l$，每个三元组表示这里有一条长为 $l$ 的从城市 $s$ 到城市 $d$ 的路。每条路都是有向的，只能从 $s$ 到 $d$，不能反向。保证有一条从城市 $0$ 到 $n-1$ 的路径。", "outputFormat": "输出一个整数表示以城市 $0$ 为起点，以 $n-1$ 为终点的最长路径长度，并且其中不重复访问城市，路径长度是所经过的道路长度之和。", "hint": "最短路为直接走城市 $0$ 至城市 $2$ 的道路，长度为 $5$ km。最长路为 $0$ 至 $1$ 至 $2$， 长度 $4+3=7$ km。\n\n对于至少 $30\\%$ 的数据，$n\\le 8$；  \n\n对于 $100\\%$ 的数据，有 $2\\le n \\le 18,$ $1\\le m \\le n^2-n,$ $0\\le s,d \\le n-1,$ $s\\neq d,$ $1\\le l\\le 10000$。", "locale": "zh-CN"}}}
{"pid": "P4803", "type": "P", "difficulty": 5, "samples": [["12 4 3 3\n1 4 5\n2 2 3\n6 3 6\n2 1\n1 8\n3 0", "11\n6\n0"]], "limits": {"time": [15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "二分", "CCO（加拿大）", "前缀和"], "title": "[CCO 2015] 太阳能飞行", "background": "**警告：滥用本题评测将被封号**", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day1 T3「[Solar Flight](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)」**\n\n航空的新纪元正在来临——第一个太阳能驱动的巨型喷气式飞机即将商用！然而，公众对前沿技术有一些在安全方面的焦虑，因为驱动飞机的阳光的光线可能会被其他在空中的物体挡住。因此，必须先进行一些统计和计算来规划第一次航行。\n\n我们考虑一个包含 $N$ 个从一个城市到另外一个城市的航路组成的图。一架飞机可以被考虑成一个点。它穿过的天空可以被模型化为一个笛卡尔坐标系，其中 $X$ 轴表示从任意一个点向东出发的距离，$Y$ 轴表示高度。我们只考虑 $x$ 值的范围在 $[0,X]$，所有航路均为直线的部分。第 $i$ 架飞机从 $(0,A_i)$ 飞到 $(X,B_i)$。所有$A$值互不相同，对于$B$也如此。飞机以未知的，可能是非恒定的速度沿着航路行驶，所以任意时间点，飞机可能在航路的任意位置上。然而，已知的是飞机从不与其他飞机相撞，所以如果两个航道交错，两个飞机不会同时到达交点。\n\n每个飞机 $i$ 同时也有一个干扰因素值 $C_i$，表示一个飞机影响它下面飞机太阳吸收能力的强弱。\n\n各个飞机上的太阳能板非常奇怪，那些太阳能板只能收集飞机正上方的能量。这就意味着一个飞机能吸收的阳光可能会被其他与其的 $x$ 值相同，但是 $y$ 值比他大的飞机挡住。具体来说，太阳能板吸收的太阳光减少的值为挡住它的飞机的干扰因素值之和。\n\n根据这些信息，以及一个距离常数 $K$，你要回答 $Q$ 个关于可能对太阳能板影响的询问。第 $i$ 个询问询问你在一个时刻飞机 $P_i$ 的太阳能板吸收的太阳光减少的值。在任意时刻飞机的 $x$ 值均在 $[S_i,S_i+K]$之间。", "inputFormat": "第一行四个整数 $X,K,N,Q$，分别表示最大考虑的 $x$ 值，距离常数，航路总数，询问总数。\n\n接下来 $N$ 行每行三个整数 $A_i,B_i,C_i(1\\le i \\le N)$，表示飞机 $i$ 初始 $y$ 值，终止 $y$值，干扰因素值。\n\n接下来 $Q$ 行每行两个整数，$P_i, S_i(1\\le i \\le Q)$，表示根据 $P_i$ 和 $S_i$ 回答题目中的问题。", "outputFormat": "输出 $Q$ 行，每行一个整数表示对于询问 $i(1\\le i \\le Q)$ 的回答。", "hint": "飞机的航路示意图如下图所示。\n\n![CCO2015D1T3Pic1](https://cdn.luogu.com.cn/upload/image_hosting/dur1tb8u.png)\n\n询问 $1$ 是对于 $2$ 号飞机在 $[1,5]$ 范围内所提出的询问，当飞机在 $x\\le 4$ 时可能会被飞机 $3$ 挡住，但是绝不是飞机 $1$。然而，但是当它的 $x>4$ 时可能会被其他所有飞机挡住，因此，该询问的答案即其他所有飞机的影响因素值之和，为 $5+6=11$。\n\n对于询问 $2$，当 $x<10$ 时飞机 $1$ 可能会被飞机 $3$ 挡住，并且当 $x\\geq10$ 时不会被任何飞机盖住，因此只可能被飞机 $3$ 影响，即结果等于飞机 $3$ 的影响因素值 $6$。\n\n对于询问 $3$，飞机 $1,2$ 都不能在飞机 $3$ 的正上方除非 $x$ 达到 $10$。所以该询问的答案为0。\n\n对于 $40\\%$ 的数据，$Q\\le 1000$。  \n\n对于 $100\\%$ 的数据，$1\\le N\\le 2000,$ $1\\le K\\le X,$ $1\\le X,A_i,B_i,C_i\\le 10^9,$ $0\\le S_i\\le X-K,$ $1\\le Q \\le 800000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Solar Flight", "background": "**Warning: abusing the judging system for this problem will result in your account being banned.**", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day 1 T3 “[Solar Flight](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)”.**\n\nA new era of aviation is coming—the first solar-powered giant jet airliner is about to enter commercial service. However, the public has some safety concerns about cutting-edge technology, because the sunlight that powers the plane may be blocked by other objects in the sky. Therefore, some statistics and calculations must be done first to plan the first flight.\n\nWe consider a graph consisting of $N$ air routes from one city to another. An airplane can be regarded as a point. The sky it travels through can be modeled as a Cartesian coordinate system, where the $X$ axis represents the distance eastward from any point, and the $Y$ axis represents altitude. We only consider $x$ values in the range $[0,X]$, and all routes are straight line segments. Plane $i$ flies from $(0,A_i)$ to $(X,B_i)$. All $A$ values are distinct, and all $B$ values are also distinct. Planes move along their routes at an unknown, possibly non-constant speed, so at any time, a plane may be at any position on its route. However, it is known that planes never collide with each other, so if two routes intersect, the two planes will never reach the intersection point at the same time.\n\nEach plane $i$ also has an interference value $C_i$, which represents how strongly a plane affects the solar energy absorption of planes below it.\n\nThe solar panels on each plane are very strange: they can only collect energy directly above the plane. This means that the sunlight a plane can absorb may be blocked by other planes that have the same $x$ value but a larger $y$ value. Specifically, the amount by which the absorbed sunlight is reduced equals the sum of the interference values of the planes blocking it.\n\nGiven this information and a distance constant $K$, you need to answer $Q$ queries about possible effects on the solar panels. Query $i$ asks for the reduction in absorbed sunlight for plane $P_i$ at some moment, where at that moment the plane’s $x$ value lies within $[S_i,S_i+K]$.", "inputFormat": "The first line contains four integers $X,K,N,Q$, representing the maximum $x$ value considered, the distance constant, the total number of routes, and the number of queries.\n\nThe next $N$ lines each contain three integers $A_i,B_i,C_i(1\\le i \\le N)$, representing plane $i$’s starting $y$ value, ending $y$ value, and interference value.\n\nThe next $Q$ lines each contain two integers $P_i, S_i(1\\le i \\le Q)$, meaning you should answer the question described above based on $P_i$ and $S_i$.", "outputFormat": "Output $Q$ lines. Each line contains one integer: the answer to query $i(1\\le i \\le Q)$.", "hint": "A diagram of the flight routes is shown below.\n\n![CCO2015D1T3Pic1](https://cdn.luogu.com.cn/upload/image_hosting/dur1tb8u.png)\n\nQuery $1$ asks about plane $2$ within the range $[1,5]$. When the plane is at $x\\le 4$, it may be blocked by plane $3$, but never by plane $1$. However, when $x>4$, it may be blocked by all other planes. Therefore, the answer to this query is the sum of the interference values of all other planes, which is $5+6=11$.\n\nFor query $2$, when $x<10$, plane $1$ may be blocked by plane $3$, and when $x\\geq10$, it will not be blocked by any plane. Therefore, it can only be affected by plane $3$, so the result equals plane $3$’s interference value $6$.\n\nFor query $3$, planes $1$ and $2$ cannot be directly above plane $3$ unless $x$ reaches $10$. Therefore, the answer to this query is $0$.\n\nFor $40\\%$ of the testdata, $Q\\le 1000$.\n\nFor $100\\%$ of the testdata, $1\\le N\\le 2000,$ $1\\le K\\le X,$ $1\\le X,A_i,B_i,C_i\\le 10^9,$ $0\\le S_i\\le X-K,$ $1\\le Q \\le 800000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 太阳能飞行", "background": "**警告：滥用本题评测将被封号**", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day1 T3「[Solar Flight](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)」**\n\n航空的新纪元正在来临——第一个太阳能驱动的巨型喷气式飞机即将商用！然而，公众对前沿技术有一些在安全方面的焦虑，因为驱动飞机的阳光的光线可能会被其他在空中的物体挡住。因此，必须先进行一些统计和计算来规划第一次航行。\n\n我们考虑一个包含 $N$ 个从一个城市到另外一个城市的航路组成的图。一架飞机可以被考虑成一个点。它穿过的天空可以被模型化为一个笛卡尔坐标系，其中 $X$ 轴表示从任意一个点向东出发的距离，$Y$ 轴表示高度。我们只考虑 $x$ 值的范围在 $[0,X]$，所有航路均为直线的部分。第 $i$ 架飞机从 $(0,A_i)$ 飞到 $(X,B_i)$。所有$A$值互不相同，对于$B$也如此。飞机以未知的，可能是非恒定的速度沿着航路行驶，所以任意时间点，飞机可能在航路的任意位置上。然而，已知的是飞机从不与其他飞机相撞，所以如果两个航道交错，两个飞机不会同时到达交点。\n\n每个飞机 $i$ 同时也有一个干扰因素值 $C_i$，表示一个飞机影响它下面飞机太阳吸收能力的强弱。\n\n各个飞机上的太阳能板非常奇怪，那些太阳能板只能收集飞机正上方的能量。这就意味着一个飞机能吸收的阳光可能会被其他与其的 $x$ 值相同，但是 $y$ 值比他大的飞机挡住。具体来说，太阳能板吸收的太阳光减少的值为挡住它的飞机的干扰因素值之和。\n\n根据这些信息，以及一个距离常数 $K$，你要回答 $Q$ 个关于可能对太阳能板影响的询问。第 $i$ 个询问询问你在一个时刻飞机 $P_i$ 的太阳能板吸收的太阳光减少的值。在任意时刻飞机的 $x$ 值均在 $[S_i,S_i+K]$之间。", "inputFormat": "第一行四个整数 $X,K,N,Q$，分别表示最大考虑的 $x$ 值，距离常数，航路总数，询问总数。\n\n接下来 $N$ 行每行三个整数 $A_i,B_i,C_i(1\\le i \\le N)$，表示飞机 $i$ 初始 $y$ 值，终止 $y$值，干扰因素值。\n\n接下来 $Q$ 行每行两个整数，$P_i, S_i(1\\le i \\le Q)$，表示根据 $P_i$ 和 $S_i$ 回答题目中的问题。", "outputFormat": "输出 $Q$ 行，每行一个整数表示对于询问 $i(1\\le i \\le Q)$ 的回答。", "hint": "飞机的航路示意图如下图所示。\n\n![CCO2015D1T3Pic1](https://cdn.luogu.com.cn/upload/image_hosting/dur1tb8u.png)\n\n询问 $1$ 是对于 $2$ 号飞机在 $[1,5]$ 范围内所提出的询问，当飞机在 $x\\le 4$ 时可能会被飞机 $3$ 挡住，但是绝不是飞机 $1$。然而，但是当它的 $x>4$ 时可能会被其他所有飞机挡住，因此，该询问的答案即其他所有飞机的影响因素值之和，为 $5+6=11$。\n\n对于询问 $2$，当 $x<10$ 时飞机 $1$ 可能会被飞机 $3$ 挡住，并且当 $x\\geq10$ 时不会被任何飞机盖住，因此只可能被飞机 $3$ 影响，即结果等于飞机 $3$ 的影响因素值 $6$。\n\n对于询问 $3$，飞机 $1,2$ 都不能在飞机 $3$ 的正上方除非 $x$ 达到 $10$。所以该询问的答案为0。\n\n对于 $40\\%$ 的数据，$Q\\le 1000$。  \n\n对于 $100\\%$ 的数据，$1\\le N\\le 2000,$ $1\\le K\\le X,$ $1\\le X,A_i,B_i,C_i\\le 10^9,$ $0\\le S_i\\le X-K,$ $1\\le Q \\le 800000$。", "locale": "zh-CN"}}}
{"pid": "P4804", "type": "P", "difficulty": 6, "samples": [["7 1\n0000001", "1000010"], ["5 3\n01011", "10100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "CCC（加拿大）"], "title": "[CCC 2016] 生命中的圆", "background": "", "description": "**译自 [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T5「[Circle of Life](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)」**\n\n> 也许你听说过康威生命游戏（Conway's Game of Life）。康威生命游戏适用于方格组成的矩阵。但它可以产生十分复杂的结构。在这道题目中，我们将使用简化版的生命游戏来虐你。\n\n这个游戏是 0 人游戏，换句话说，只要给定初始条件，这个游戏就能自己进行下去。\n\n将一个圆环分为 $N$ 段，将这 $N$ 段顺时针依次编为 $1,\\dots,N$ 号。每一段要么是活的（以 `1` 表示），要么是死的（以 `0` 表示）。\n\n游戏会进行 $T$ 轮「变化」。如果一个方格**恰好**有一个相邻的方格在这次变化中存活，那么该方格会在下次变化中存活。否则，该方格会死亡。\n\n给定圆环的初始状态，求经过 $T$ 次变化之后的状态。", "inputFormat": "第一行，两个整数 $N$ 和 $T(3 \\le N \\le 100\\ 000;1 \\le T \\le 10^{15})$。\n\n第二行，一个长度为 $N$ 的字符串，表示 $N$ 个方格的初始状态。保证每个字符只有 `0` 或 `1` 两种可能。第 $i$ 位表示编号为 $i$ 的方格的初始状态。", "outputFormat": "输出一个长度为 $N$ 的字符串，表示最终的状态。格式同输入。", "hint": "#### 样例解释 1\n方格 $1$ 和 $N - 1$ 和 $N$ 相邻，因此在一次变化后仍存活。\n\n#### 样例解释 2\n一次变化后，状态为 ` 00011`。\n\n两次变化后，状态为 ` 10111`。\n\n对于 $\\frac{1}{15}$ 的数据，$N \\le 15,T \\le 15$。\n\n对于另外的 $\\frac{6}{15}$ 的数据，$N \\le 15$。\n\n对于另外的 $\\frac{4}{15}$ 的数据，$N \\le 4000,T \\le 10\\ 000\\ 000$。\n\n注意对于所有的数据，你需要使用 64 位整数。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2016] Circle of Life", "background": "", "description": "**Translated from [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T5 “[Circle of Life](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)”**\n\n> You may have heard of Conway's Game of Life. Conway's Game of Life runs on a grid matrix. However, it can produce very complex structures. In this problem, we will use a simplified version of the Game of Life.\n\nThis is a zero-player game. In other words, once the initial condition is given, the game runs by itself.\n\nDivide a ring into $N$ segments, and label these $N$ segments clockwise as $1,\\dots,N$. Each segment is either alive (represented by `1`) or dead (represented by `0`).\n\nThe game will go through $T$ rounds of “changes”. If a cell has **exactly** one adjacent cell that is alive during this change, then the cell will be alive in the next change. Otherwise, the cell will be dead.\n\nGiven the initial state of the ring, find the state after $T$ changes.", "inputFormat": "The first line contains two integers $N$ and $T(3 \\le N \\le 100\\ 000;1 \\le T \\le 10^{15})$.\n\nThe second line contains a string of length $N$, describing the initial states of the $N$ cells. Each character is guaranteed to be either `0` or `1`. The $i$-th character represents the initial state of cell $i$.", "outputFormat": "Output a string of length $N$, representing the final state. The format is the same as the input.", "hint": "#### Sample Explanation 1\n\nCells $1$, $N - 1$, and $N$ are adjacent, so they remain alive after one change.\n\n#### Sample Explanation 2\n\nAfter one change, the state is `00011`.\n\nAfter two changes, the state is `10111`.\n\nFor $\\frac{1}{15}$ of the testdata, $N \\le 15,T \\le 15$.\n\nFor another $\\frac{6}{15}$ of the testdata, $N \\le 15$.\n\nFor another $\\frac{4}{15}$ of the testdata, $N \\le 4000,T \\le 10\\ 000\\ 000$.\n\nNote that for all testdata, you need to use 64-bit integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2016] 生命中的圆", "background": "", "description": "**译自 [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T5「[Circle of Life](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)」**\n\n> 也许你听说过康威生命游戏（Conway's Game of Life）。康威生命游戏适用于方格组成的矩阵。但它可以产生十分复杂的结构。在这道题目中，我们将使用简化版的生命游戏来虐你。\n\n这个游戏是 0 人游戏，换句话说，只要给定初始条件，这个游戏就能自己进行下去。\n\n将一个圆环分为 $N$ 段，将这 $N$ 段顺时针依次编为 $1,\\dots,N$ 号。每一段要么是活的（以 `1` 表示），要么是死的（以 `0` 表示）。\n\n游戏会进行 $T$ 轮「变化」。如果一个方格**恰好**有一个相邻的方格在这次变化中存活，那么该方格会在下次变化中存活。否则，该方格会死亡。\n\n给定圆环的初始状态，求经过 $T$ 次变化之后的状态。", "inputFormat": "第一行，两个整数 $N$ 和 $T(3 \\le N \\le 100\\ 000;1 \\le T \\le 10^{15})$。\n\n第二行，一个长度为 $N$ 的字符串，表示 $N$ 个方格的初始状态。保证每个字符只有 `0` 或 `1` 两种可能。第 $i$ 位表示编号为 $i$ 的方格的初始状态。", "outputFormat": "输出一个长度为 $N$ 的字符串，表示最终的状态。格式同输入。", "hint": "#### 样例解释 1\n方格 $1$ 和 $N - 1$ 和 $N$ 相邻，因此在一次变化后仍存活。\n\n#### 样例解释 2\n一次变化后，状态为 ` 00011`。\n\n两次变化后，状态为 ` 10111`。\n\n对于 $\\frac{1}{15}$ 的数据，$N \\le 15,T \\le 15$。\n\n对于另外的 $\\frac{6}{15}$ 的数据，$N \\le 15$。\n\n对于另外的 $\\frac{4}{15}$ 的数据，$N \\le 4000,T \\le 10\\ 000\\ 000$。\n\n注意对于所有的数据，你需要使用 64 位整数。", "locale": "zh-CN"}}}
{"pid": "P4805", "type": "P", "difficulty": 4, "samples": [["7\n47 12 12 3 9 9 3", "48"], ["4\n1 2 3 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2016", "CCC（加拿大）", "区间 DP", "双指针 two-pointer"], "title": "[CCC 2016] 合并饭团", "background": "", "description": "**译自 [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T4「[Combining Riceballs](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)」**\n\nAlphonse 有 $N$ 个美味的饭团，它们大小不一，摆放成一行。他想把最大的饭团让给自己的基友。他可以执行以下操作：\n\n - 如果两个**相邻的**饭团大小相同，Alphonse 可以把它们合并成一个新的饭团。新饭团的大小是两个原饭团大小之和。它将占据两个原饭团先前占据的位置。\n\n - 如果两个饭团大小相同，且它们之间只有一个饭团，Alphonse 也可以把它们合并成一个新的饭团。（中间的饭团大小没有规定。）新饭团的大小是三个原饭团大小之和，并占据三个原饭团先前的位置。\n\nAlphonse 可以按照他的意愿执行任意次操作。\n\n在执行 0 或更多次操作后，确定他应该把哪个饭团让给基友。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 400)$。\n\n第二行，$N$ 个以空格分隔的整数，表示每个饭团的大小，按照从左到右的顺序给出。每个整数的上界为 $1\\ 000\\ 000$。", "outputFormat": "输出 Alphonse 可以得到的最大的饭团大小。", "hint": "#### 样例解释 1\n有一种可能的合并方案为：合并大小同为 $12$ 的两个饭团，得到一个大小为 $24$ 的饭团。然后合并大小同为 $9$ 的两个饭团，得到一个大小为 $18$。接着合并大小为 $3,18$ 和 $3$ 的三个饭团，得到一个大小为 $24$ 的饭团。最后合并大小同为 $24$ 的两个饭团，得到一个大小为 $48$ 的饭团。\n\n#### 样例解释 2\n我们无法进行操作，所以答案为 $3$。\n\n对于 $\\frac1{15}$ 的数据，$N = 4$。\n\n对于另外 $\\frac2{15}$ 的数据，$N \\le 10$。\n\n对于另外 $\\frac5{15}$ 的数据，$N \\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2016] Combining Riceballs", "background": "", "description": "**Translated from [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T4 “[Combining Riceballs](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)”**\n\nAlphonse has $N$ delicious riceballs of different sizes, arranged in a line. He wants to give the largest riceball to his best friend. He can perform the following operations:\n\n- If two **adjacent** riceballs have the same size, Alphonse can combine them into one new riceball. The new riceball’s size is the sum of the two original riceballs’ sizes. It will occupy the positions previously occupied by the two original riceballs.\n\n- If two riceballs have the same size, and there is exactly one riceball between them, Alphonse can also combine them into one new riceball. (There is no restriction on the middle riceball’s size.) The new riceball’s size is the sum of the three original riceballs’ sizes, and it occupies the positions previously occupied by the three original riceballs.\n\nAlphonse may perform the operations any number of times, in any order.\n\nAfter performing $0$ or more operations, determine which riceball he should give to his friend.", "inputFormat": "The first line contains an integer $N$ $(1 \\le N \\le 400)$.\n\nThe second line contains $N$ space-separated integers, giving the sizes of the riceballs from left to right. Each integer is at most $1\\ 000\\ 000$.", "outputFormat": "Output the maximum riceball size that Alphonse can obtain.", "hint": "#### Sample Explanation 1.\nOne possible sequence of merges is: combine the two riceballs of size $12$ to get a riceball of size $24$. Then combine the two riceballs of size $9$ to get a riceball of size $18$. Next, combine the three riceballs of size $3, 18,$ and $3$ to get a riceball of size $24$. Finally, combine the two riceballs of size $24$ to get a riceball of size $48$.\n\n#### Sample Explanation 2.\nWe cannot perform any operation, so the answer is $3$.\n\nFor $\\frac1{15}$ of the testdata, $N = 4$.\n\nFor another $\\frac2{15}$ of the testdata, $N \\le 10$.\n\nFor another $\\frac5{15}$ of the testdata, $N \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2016] 合并饭团", "background": "", "description": "**译自 [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T4「[Combining Riceballs](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)」**\n\nAlphonse 有 $N$ 个美味的饭团，它们大小不一，摆放成一行。他想把最大的饭团让给自己的基友。他可以执行以下操作：\n\n - 如果两个**相邻的**饭团大小相同，Alphonse 可以把它们合并成一个新的饭团。新饭团的大小是两个原饭团大小之和。它将占据两个原饭团先前占据的位置。\n\n - 如果两个饭团大小相同，且它们之间只有一个饭团，Alphonse 也可以把它们合并成一个新的饭团。（中间的饭团大小没有规定。）新饭团的大小是三个原饭团大小之和，并占据三个原饭团先前的位置。\n\nAlphonse 可以按照他的意愿执行任意次操作。\n\n在执行 0 或更多次操作后，确定他应该把哪个饭团让给基友。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 400)$。\n\n第二行，$N$ 个以空格分隔的整数，表示每个饭团的大小，按照从左到右的顺序给出。每个整数的上界为 $1\\ 000\\ 000$。", "outputFormat": "输出 Alphonse 可以得到的最大的饭团大小。", "hint": "#### 样例解释 1\n有一种可能的合并方案为：合并大小同为 $12$ 的两个饭团，得到一个大小为 $24$ 的饭团。然后合并大小同为 $9$ 的两个饭团，得到一个大小为 $18$。接着合并大小为 $3,18$ 和 $3$ 的三个饭团，得到一个大小为 $24$ 的饭团。最后合并大小同为 $24$ 的两个饭团，得到一个大小为 $48$ 的饭团。\n\n#### 样例解释 2\n我们无法进行操作，所以答案为 $3$。\n\n对于 $\\frac1{15}$ 的数据，$N = 4$。\n\n对于另外 $\\frac2{15}$ 的数据，$N \\le 10$。\n\n对于另外 $\\frac5{15}$ 的数据，$N \\le 50$。", "locale": "zh-CN"}}}
{"pid": "P4806", "type": "P", "difficulty": 6, "samples": [["4 4 0\n1 2 1\n2 3 2\n3 4 1\n4 1 1", "1"], ["5 6 2\n1 2 5\n2 3 5\n1 4 5\n4 5 5\n1 3 1\n1 5 1", "2"], ["4 4 0\n1 2 715827882\n2 3 715827882\n3 4 715827882\n4 1 715827884", "0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "CCC（加拿大）", "生成树", "最近公共祖先 LCA"], "title": "[CCC 2017] 最小费用流", "background": "", "description": " **译自 [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T4「[Minimum Cost Flow](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)」**\n\nWatermoo 中有编号为 $1,2,\\dots,N$ 的建筑物。其中还有 $M$ 条管道将建筑物两两连接。由于城市规划的疏漏，$1$ 号建筑是全市唯一的污水处理厂。每条管道可能是*活动的*或是*非活动的*。如果建筑 $1$ 通过活动管道直接或是间接地与其他每个建筑连通，则称活动管道集是一个有效的方案。（每条管道将两个建筑直接连接。如果建筑 $X$ 直接或间接连接建筑 $Y$，且建筑 $Y$ 直接或间接连接建筑 $Z$，那么我们说 $X$ 和 $Z$ 间接连接。）\n\nWatermoo 的市政府正在使用一个 $N-1$ 条管道组成的显然有效的方案，但是这使得政府已经透支很多经费了！每条管道都有各自的月维修费，这是在其活动时必须支付的，一个有效方案的总成本为所有有效管道的维修费的总和。（非活动的管道不花费一分钱。）\n\n此外，一个好消息是：Watermoo 大学的研究人员开发出了一种不完善的管道推进器，你可以在一条管道上使用它。它将从 $C$ 到 $\\mathrm{max}(0,C-D)$ 降低该管道的维修成本，$D$ 为该推进器的强度。\n\n市政府希望将成本降到最低，同时也希望你能尽快完成这个任务。每天，城市会允许你激活一条管道并关闭另一条管道。问：你需要多少天才能使一组活动管道形成一个有效方案并使其在所有有效方案和推进方案中费用最小？\n\n请注意，在你规划的过程中方案可能会无效，但是到最后，他应该是一个有效的方案。", "inputFormat": "第一行，三个整数 $N,M$ 和 $D(1 \\le N \\le 100\\ 000,N - 1 \\le M \\le 200\\ 000,0 \\le D \\le 10^9)$。\n\n接下来 $M$ 行，每行三个整数 $A_i,B_i$ 和 $C_i$，表示有一条月维修成本为 $C_i$ 的管道从建筑 $A_i$ 连接到建筑 $B_i(1 \\le A_i,B_i \\le N,1 \\le C_i \\le 10^9)$。\n\n前 $N-1$ 行表示 Watermoo 正在使用的有效方案。\n\n保证数据没有重边和自环。", "outputFormat": "输出一行，一个整数，表示完成任务的最小天数。如果初始方案即最优方案，输出`0`。", "hint": "#### 样例解释 1\n因为 $D=0$，所以管道推进器一无是处。\n\n第一天，你应当关闭建筑 $2$ 到 $3$ 的管道并激活建筑 $4$ 到 $1$ 的管道。\n\n#### 样例解释 2\n一个可行的解为：首先在连接建筑 $1,2$ 的管道上安装推进器，使成本降低到 $3$。第一天，以连接 $1,3$ 的管道替换连接 $2,3$ 的管道。第二天，以连接 $1,5$ 的管道替换连接 $1,4$ 的管道。\n\n此外，在连接 $1,3$ 或连接 $1,5$ 的管道上安装推进器毫无意义。这样做将会使得该管道的维修成本为 $0$，最优的费用为 $11$ （如你所见，我们已经找到了费用为 $10$ 的方案）。\n\n#### 样例解释 3\n初始的方案即最优方案。请注意整数上溢。\n\n对于 $\\frac3{15}$ 的数据，$N \\le 8,M \\le 28,D=0$。\n\n对于另外 $\\frac5{15}$ 的数据，$N \\le 1\\ 000,M \\le 5\\ 000,D=0$。\n\n对于另外 $\\frac3{15}$ 的数据，$D=0$。\n\n对于另外 $\\frac2{15}$ 的数据，$N \\le 1\\ 000,M \\le 5\\ 000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2017] Minimum Cost Flow", "background": "", "description": "**Translated from [CCC 2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T4 “[Minimum Cost Flow](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)”.**\n\nIn Watermoo, there are buildings numbered $1,2,\\dots,N$. There are also $M$ pipes, each connecting a pair of buildings. Due to an oversight in city planning, Building $1$ is the only sewage treatment plant in the city. Each pipe can be *active* or *inactive*. If Building $1$ is directly or indirectly connected to every other building using only active pipes, then the set of active pipes is called a valid plan. (Each pipe directly connects two buildings. If building $X$ is directly or indirectly connected to building $Y$, and building $Y$ is directly or indirectly connected to building $Z$, then we say $X$ and $Z$ are indirectly connected.)\n\nThe city government of Watermoo is currently using an obviously valid plan consisting of exactly $N-1$ pipes, but this has already pushed the budget too far. Each pipe has its own monthly maintenance cost, which must be paid if the pipe is active. The total cost of a valid plan is the sum of the maintenance costs of all active pipes. (Inactive pipes cost nothing.)\n\nThere is also good news: researchers at Watermoo University have developed an imperfect pipe booster, which you may use on exactly one pipe. It reduces that pipe’s maintenance cost from $C$ to $\\mathrm{max}(0,C-D)$, where $D$ is the strength of the booster.\n\nThe government wants to minimize the cost, and also wants you to finish as quickly as possible. Each day, the city allows you to activate one pipe and deactivate one other pipe. How many days do you need so that the set of active pipes forms a valid plan and has the minimum possible cost among all valid plans and all choices of where to use the booster?\n\nNote that during your process, the plan may be invalid, but in the end it must be a valid plan.", "inputFormat": "The first line contains three integers $N, M$ and $D(1 \\le N \\le 100\\ 000, N - 1 \\le M \\le 200\\ 000, 0 \\le D \\le 10^9)$.\n\nThe next $M$ lines each contain three integers $A_i, B_i$ and $C_i$, meaning there is a pipe with monthly maintenance cost $C_i$ connecting building $A_i$ and building $B_i$ $(1 \\le A_i, B_i \\le N, 1 \\le C_i \\le 10^9)$.\n\nThe first $N-1$ of these $M$ lines describe the valid plan Watermoo is currently using.\n\nIt is guaranteed that there are no multiple edges and no self-loops in the testdata.", "outputFormat": "Output one line containing an integer, the minimum number of days needed to finish the task. If the initial plan is already optimal, output `0`.", "hint": "#### Sample Explanation 1\n\nSince $D=0$, the pipe booster is useless.\n\nOn the first day, you should deactivate the pipe between buildings $2$ and $3$ and activate the pipe between buildings $4$ and $1$.\n\n#### Sample Explanation 2\n\nOne feasible solution is: first install the booster on the pipe connecting buildings $1$ and $2$, reducing its cost to $3$. On the first day, replace the pipe connecting $2$ and $3$ with the pipe connecting $1$ and $3$. On the second day, replace the pipe connecting $1$ and $4$ with the pipe connecting $1$ and $5$.\n\nIn addition, installing the booster on the pipe connecting $1$ and $3$ or the pipe connecting $1$ and $5$ is meaningless. Doing so would make that pipe’s maintenance cost $0$, and the optimal total cost would be $11$ (as you can see, we have already found a plan with total cost $10$).\n\n#### Sample Explanation 3\n\nThe initial plan is already optimal. Please note integer overflow.\n\nFor $\\frac3{15}$ of the testdata, $N \\le 8, M \\le 28, D=0$.\n\nFor another $\\frac5{15}$ of the testdata, $N \\le 1\\ 000, M \\le 5\\ 000, D=0$.\n\nFor another $\\frac3{15}$ of the testdata, $D=0$.\n\nFor another $\\frac2{15}$ of the testdata, $N \\le 1\\ 000, M \\le 5\\ 000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2017] 最小费用流", "background": "", "description": " **译自 [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T4「[Minimum Cost Flow](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)」**\n\nWatermoo 中有编号为 $1,2,\\dots,N$ 的建筑物。其中还有 $M$ 条管道将建筑物两两连接。由于城市规划的疏漏，$1$ 号建筑是全市唯一的污水处理厂。每条管道可能是*活动的*或是*非活动的*。如果建筑 $1$ 通过活动管道直接或是间接地与其他每个建筑连通，则称活动管道集是一个有效的方案。（每条管道将两个建筑直接连接。如果建筑 $X$ 直接或间接连接建筑 $Y$，且建筑 $Y$ 直接或间接连接建筑 $Z$，那么我们说 $X$ 和 $Z$ 间接连接。）\n\nWatermoo 的市政府正在使用一个 $N-1$ 条管道组成的显然有效的方案，但是这使得政府已经透支很多经费了！每条管道都有各自的月维修费，这是在其活动时必须支付的，一个有效方案的总成本为所有有效管道的维修费的总和。（非活动的管道不花费一分钱。）\n\n此外，一个好消息是：Watermoo 大学的研究人员开发出了一种不完善的管道推进器，你可以在一条管道上使用它。它将从 $C$ 到 $\\mathrm{max}(0,C-D)$ 降低该管道的维修成本，$D$ 为该推进器的强度。\n\n市政府希望将成本降到最低，同时也希望你能尽快完成这个任务。每天，城市会允许你激活一条管道并关闭另一条管道。问：你需要多少天才能使一组活动管道形成一个有效方案并使其在所有有效方案和推进方案中费用最小？\n\n请注意，在你规划的过程中方案可能会无效，但是到最后，他应该是一个有效的方案。", "inputFormat": "第一行，三个整数 $N,M$ 和 $D(1 \\le N \\le 100\\ 000,N - 1 \\le M \\le 200\\ 000,0 \\le D \\le 10^9)$。\n\n接下来 $M$ 行，每行三个整数 $A_i,B_i$ 和 $C_i$，表示有一条月维修成本为 $C_i$ 的管道从建筑 $A_i$ 连接到建筑 $B_i(1 \\le A_i,B_i \\le N,1 \\le C_i \\le 10^9)$。\n\n前 $N-1$ 行表示 Watermoo 正在使用的有效方案。\n\n保证数据没有重边和自环。", "outputFormat": "输出一行，一个整数，表示完成任务的最小天数。如果初始方案即最优方案，输出`0`。", "hint": "#### 样例解释 1\n因为 $D=0$，所以管道推进器一无是处。\n\n第一天，你应当关闭建筑 $2$ 到 $3$ 的管道并激活建筑 $4$ 到 $1$ 的管道。\n\n#### 样例解释 2\n一个可行的解为：首先在连接建筑 $1,2$ 的管道上安装推进器，使成本降低到 $3$。第一天，以连接 $1,3$ 的管道替换连接 $2,3$ 的管道。第二天，以连接 $1,5$ 的管道替换连接 $1,4$ 的管道。\n\n此外，在连接 $1,3$ 或连接 $1,5$ 的管道上安装推进器毫无意义。这样做将会使得该管道的维修成本为 $0$，最优的费用为 $11$ （如你所见，我们已经找到了费用为 $10$ 的方案）。\n\n#### 样例解释 3\n初始的方案即最优方案。请注意整数上溢。\n\n对于 $\\frac3{15}$ 的数据，$N \\le 8,M \\le 28,D=0$。\n\n对于另外 $\\frac5{15}$ 的数据，$N \\le 1\\ 000,M \\le 5\\ 000,D=0$。\n\n对于另外 $\\frac3{15}$ 的数据，$D=0$。\n\n对于另外 $\\frac2{15}$ 的数据，$N \\le 1\\ 000,M \\le 5\\ 000$。", "locale": "zh-CN"}}}
{"pid": "P4807", "type": "P", "difficulty": 6, "samples": [["5 2 5\n1 2 1 2 2\n1 2 3 4 5\n1 1 5\n2 1\n1 3 5\n2 2\n1 1 3", "15\n10\n9"], ["3 1 7\n1 1 1\n114 101 109\n1 1 1\n2 1\n1 1 1\n2 1\n1 1 1\n2 1\n1 1 1", "114\n109\n101\n114"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2017", "CCC（加拿大）"], "title": "[CCC 2017] 地铁交通", "background": "**滥用本题评测将被封号**", "description": " **译自 [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T5「[RMT](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)」**\n\nRMT 地铁交通运行着一个不寻常的地铁系统。有 $N$ 个地铁站，从 $1$ 到 $N$ 编号。有 $M$ 条地铁线路，从 $1$ 到 $M$ 编号，每个地铁站只属于一条线路且每条线路至少经过一个地铁站。整个地铁网络呈圆形。也就是说，如果有一个编号为 $S$ 的地铁站，那么与它同一线路的下一个地铁站是下一个编号比它大的地铁站。除非 $S$ 是同线路中编号最大的地铁站，在这种情况下，它的下一个地铁站是同一线路中编号最小的地铁站。\n\nRMT 正在以志愿者对他们的系统进行负载测试。测试从每一站以一列地铁列车开始，且对于每一个 $i$，会有 $A_i$ 个志愿者在第 $i$ 站的测试列车上。在整个测试期间，志愿者不会离开对应的列车。\n\n测试过程中，RMT 会进行 $Q$ 个操作，每个操作只有两种可能：一种是询问第 $l$ 站到第 $r$ 站地铁上的志愿者人数；或是在线路 $x$ 运行所有的地铁。当有一列地铁在 $x$ 线路运行，它会前往线路中的下一站。\n\n你是 RMT 的铁杆骨灰级粉丝，所以你自愿协助他们进行操作并告诉他们操作的结果。", "inputFormat": "第一行，三个整数，$N,M$ 和 $Q(1 \\le M \\le N \\le 150\\ 000;1 \\le Q \\le 150\\ 000)$。\n\n第二行，$N$ 个整数 $L_1,L_2,\\dots,L_N$，表示每个地铁站所属线路的编号。\n\n第三行，$N$ 个整数 $A_1,A_2,\\dots,A_N$，表示每个地铁站起始时刻的志愿者人数。\n\n以下 $Q$ 行，每行只有以下其中一种形态：\n\n - `1 l r`，表示一个询问 $(1 \\le l \\le r \\le N)$。\n\n -  `2 x`，表示 RMT 会在 $x$ 线路运行 $(1 \\le x \\le M)$。", "outputFormat": "对于每个询问，输出一行，表示询问的答案。", "hint": "### 样例解释 1\n地铁系统如下图所示，地铁站编号为 $1$ 到 $5$，由编号为 $1$ 或 $2$ 的线路连接：\n\n![](https://i.loli.net/2018/08/16/5b74e41916341.png)\n\n开始时，每个地铁站的志愿者人数为 $\\{1,2,3,4,5\\}$。\n\n第一个询问的答案为 $1+2+3+4+5=15$。\n\n线路 $1$ 被运行之后，每个地铁站的志愿者人数为 $\\{3,2,1,4,5\\}$。\n\n第二个询问的答案为 $1+4+5=10$。\n\n线路 $2$ 被运行之后，每个地铁站的志愿者人数为 $\\{3,5,1,2,4\\}$。\n\n第三个询问的答案为 $3+5+1=9$。\n\n#### 样例解释 2\n地铁系统如下图所示，地铁站编号为 $1$ 到 $3$，只有线路 $1$ 连接：\n\n![](https://i.loli.net/2018/08/16/5b74e56617ad0.png)\n\n第一次询问之前，每个地铁站的志愿者人数为 $\\{114,101,109\\}$。\n\n第二次询问之前，每个地铁站的志愿者人数为 $\\{109,114,101\\}$。\n\n第三次询问之前，每个地铁站的志愿者人数为 $\\{101,109,114\\}$。\n\n第四次询问之前，每个地铁站的志愿者人数为 $\\{114,101,109\\}$。\n\n对于 $\\frac2{15}$ 的数据，$N \\le 1\\ 000,Q \\le 1\\ 000$。\n\n对于另外 $\\frac2{15}$ 的数据，$L_i \\le L{i+1}(1 \\le i < N)$。\n\n对于另外 $\\frac3{15}$ 的数据，$M \\le 200$。\n\n对于另外 $\\frac3{15}$ 的数据，每条线路的地铁数量都不超过 $200$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2017] Subway Transit", "background": "**Abusing the judging system for this problem will result in your account being banned.**", "description": "**Translated from [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T5 “[RMT](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)”.**\n\nRMT Subway Transit operates an unusual subway system. There are $N$ stations, numbered from $1$ to $N$. There are $M$ subway lines, numbered from $1$ to $M$. Each station belongs to exactly one line, and each line contains at least one station. The entire subway network is circular. That is, if there is a station numbered $S$, then the next station on the same line is the station on that line with the smallest number that is greater than $S$. Unless $S$ is the station with the largest number on that line, in which case its next station is the station with the smallest number on that line.\n\nRMT is using volunteers to load-test their system. The test starts with one subway train at each station, and for each $i$, there are $A_i$ volunteers on the test train at station $i$. Throughout the test, volunteers will not leave their corresponding trains.\n\nDuring the test, RMT will perform $Q$ operations. Each operation is one of two types: either query the number of volunteers on the trains from station $l$ to station $r$, or run all trains on line $x$. When a train runs on line $x$, it moves to the next station on that line.\n\nYou are a die-hard fan of RMT, so you volunteer to help them perform the operations and report the results.", "inputFormat": "The first line contains three integers $N, M$ and $Q(1 \\le M \\le N \\le 150\\ 000;1 \\le Q \\le 150\\ 000)$.\n\nThe second line contains $N$ integers $L_1, L_2, \\dots, L_N$, indicating the line number that each station belongs to.\n\nThe third line contains $N$ integers $A_1, A_2, \\dots, A_N$, indicating the initial number of volunteers at each station.\n\nThe next $Q$ lines are each in one of the following forms:\n\n- `1 l r`, indicating a query $(1 \\le l \\le r \\le N)$.\n\n- `2 x`, indicating that RMT runs line $x$ $(1 \\le x \\le M)$.", "outputFormat": "For each query, output one line containing the answer.", "hint": "### Sample Explanation 1\n\nThe subway system is shown in the figure below. Stations are numbered from $1$ to $5$, and are connected by line $1$ or $2$:\n\n![](https://i.loli.net/2018/08/16/5b74e41916341.png)\n\nAt the start, the number of volunteers at each station is $\\{1,2,3,4,5\\}$.\n\nThe answer to the first query is $1+2+3+4+5=15$.\n\nAfter line $1$ is run, the number of volunteers at each station becomes $\\{3,2,1,4,5\\}$.\n\nThe answer to the second query is $1+4+5=10$.\n\nAfter line $2$ is run, the number of volunteers at each station becomes $\\{3,5,1,2,4\\}$.\n\nThe answer to the third query is $3+5+1=9$.\n\n#### Sample Explanation 2\n\nThe subway system is shown in the figure below. Stations are numbered from $1$ to $3$, and only line $1$ connects them:\n\n![](https://i.loli.net/2018/08/16/5b74e56617ad0.png)\n\nBefore the first query, the number of volunteers at each station is $\\{114,101,109\\}$.\n\nBefore the second query, the number of volunteers at each station is $\\{109,114,101\\}$.\n\nBefore the third query, the number of volunteers at each station is $\\{101,109,114\\}$.\n\nBefore the fourth query, the number of volunteers at each station is $\\{114,101,109\\}$.\n\nFor $\\frac2{15}$ of the testdata, $N \\le 1\\ 000, Q \\le 1\\ 000$.\n\nFor another $\\frac2{15}$ of the testdata, $L_i \\le L{i+1}(1 \\le i < N)$.\n\nFor another $\\frac3{15}$ of the testdata, $M \\le 200$.\n\nFor another $\\frac3{15}$ of the testdata, each line has at most $200$ trains.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2017] 地铁交通", "background": "**滥用本题评测将被封号**", "description": " **译自 [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T5「[RMT](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)」**\n\nRMT 地铁交通运行着一个不寻常的地铁系统。有 $N$ 个地铁站，从 $1$ 到 $N$ 编号。有 $M$ 条地铁线路，从 $1$ 到 $M$ 编号，每个地铁站只属于一条线路且每条线路至少经过一个地铁站。整个地铁网络呈圆形。也就是说，如果有一个编号为 $S$ 的地铁站，那么与它同一线路的下一个地铁站是下一个编号比它大的地铁站。除非 $S$ 是同线路中编号最大的地铁站，在这种情况下，它的下一个地铁站是同一线路中编号最小的地铁站。\n\nRMT 正在以志愿者对他们的系统进行负载测试。测试从每一站以一列地铁列车开始，且对于每一个 $i$，会有 $A_i$ 个志愿者在第 $i$ 站的测试列车上。在整个测试期间，志愿者不会离开对应的列车。\n\n测试过程中，RMT 会进行 $Q$ 个操作，每个操作只有两种可能：一种是询问第 $l$ 站到第 $r$ 站地铁上的志愿者人数；或是在线路 $x$ 运行所有的地铁。当有一列地铁在 $x$ 线路运行，它会前往线路中的下一站。\n\n你是 RMT 的铁杆骨灰级粉丝，所以你自愿协助他们进行操作并告诉他们操作的结果。", "inputFormat": "第一行，三个整数，$N,M$ 和 $Q(1 \\le M \\le N \\le 150\\ 000;1 \\le Q \\le 150\\ 000)$。\n\n第二行，$N$ 个整数 $L_1,L_2,\\dots,L_N$，表示每个地铁站所属线路的编号。\n\n第三行，$N$ 个整数 $A_1,A_2,\\dots,A_N$，表示每个地铁站起始时刻的志愿者人数。\n\n以下 $Q$ 行，每行只有以下其中一种形态：\n\n - `1 l r`，表示一个询问 $(1 \\le l \\le r \\le N)$。\n\n -  `2 x`，表示 RMT 会在 $x$ 线路运行 $(1 \\le x \\le M)$。", "outputFormat": "对于每个询问，输出一行，表示询问的答案。", "hint": "### 样例解释 1\n地铁系统如下图所示，地铁站编号为 $1$ 到 $5$，由编号为 $1$ 或 $2$ 的线路连接：\n\n![](https://i.loli.net/2018/08/16/5b74e41916341.png)\n\n开始时，每个地铁站的志愿者人数为 $\\{1,2,3,4,5\\}$。\n\n第一个询问的答案为 $1+2+3+4+5=15$。\n\n线路 $1$ 被运行之后，每个地铁站的志愿者人数为 $\\{3,2,1,4,5\\}$。\n\n第二个询问的答案为 $1+4+5=10$。\n\n线路 $2$ 被运行之后，每个地铁站的志愿者人数为 $\\{3,5,1,2,4\\}$。\n\n第三个询问的答案为 $3+5+1=9$。\n\n#### 样例解释 2\n地铁系统如下图所示，地铁站编号为 $1$ 到 $3$，只有线路 $1$ 连接：\n\n![](https://i.loli.net/2018/08/16/5b74e56617ad0.png)\n\n第一次询问之前，每个地铁站的志愿者人数为 $\\{114,101,109\\}$。\n\n第二次询问之前，每个地铁站的志愿者人数为 $\\{109,114,101\\}$。\n\n第三次询问之前，每个地铁站的志愿者人数为 $\\{101,109,114\\}$。\n\n第四次询问之前，每个地铁站的志愿者人数为 $\\{114,101,109\\}$。\n\n对于 $\\frac2{15}$ 的数据，$N \\le 1\\ 000,Q \\le 1\\ 000$。\n\n对于另外 $\\frac2{15}$ 的数据，$L_i \\le L{i+1}(1 \\le i < N)$。\n\n对于另外 $\\frac3{15}$ 的数据，$M \\le 200$。\n\n对于另外 $\\frac3{15}$ 的数据，每条线路的地铁数量都不超过 $200$。", "locale": "zh-CN"}}}
{"pid": "P4808", "type": "P", "difficulty": 6, "samples": [["4", "3"], ["10", "13"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "CCC（加拿大）"], "title": "[CCC 2018] 平衡树", "background": "", "description": "**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S4「[Balanced Trees](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**\n\n我们定义「完美平衡树」如下：\n\n每棵完美平衡树都有一个正整数权值。权值为 $1$  的完美平衡树为只含有 $1$  个节点的树。否则，这棵树的权值为 $w(w\\ge2)$，则这棵树为一棵含有 $k(2\\le k\\le w)$ 棵子树的有根树。所有的 $k$ 棵子树都必须是相同的，且它的所有 $k$ 棵子树必须完全相同，且自身是完美平衡的。\n\n特别地，所有 $k$ 棵子树权值必须相同。它们的权值必须为 $\\left\\lfloor\\frac{w}{k}\\right\\rfloor$ 。例如，如果一棵权值为 $8$ 的完美平衡树有 $3$ 棵子树，那么每棵子树的权值为 $2$，因为 $2+2+2=6\\le8$。\n\n给定 $N$，求出权值为 $N$ 的完美平衡树的数量。\n", "inputFormat": "输入包含一行一个整数 $N$。", "outputFormat": "输出一个整数表示权值为 $N$ 的完美平衡树的数量。", "hint": "#### 样例解释 1\n\n合法的树如下：\n\n - 一棵以有 $4$ 棵权值为 $1$ 的子树为根的完美平衡树；\n - 一棵以有 $2$ 棵权值为 $2$ 的子树为根的完美平衡树；\n - 一棵以有 $3$ 棵权值为 $1$ 的子树为根的完美平衡树。\n\n对于 $33\\%$ 的数据，$N\\le1000$；  \n对于另外 $13\\%$ 的数据，$N\\le5\\times 10^4$；  \n对于另外 $13\\%$ 的数据，$N\\le10^6$；  \n对于全部的数据，$1\\le N\\le10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2018] Balanced Trees", "background": "", "description": "**This problem is translated from [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S4 “[Balanced Trees](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)”.**\n\nWe define a “perfectly balanced tree” as follows:\n\nEach perfectly balanced tree has a positive integer weight. A perfectly balanced tree with weight $1$ is a tree with only $1$ node. Otherwise, if the tree has weight $w(w\\ge2)$, then it is a rooted tree with $k(2\\le k\\le w)$ subtrees. All $k$ subtrees must be the same, and all of its $k$ subtrees must be exactly identical, and each subtree itself must be perfectly balanced.\n\nIn particular, the weights of all $k$ subtrees must be the same. Their weight must be $\\left\\lfloor\\frac{w}{k}\\right\\rfloor$. For example, if a perfectly balanced tree of weight $8$ has $3$ subtrees, then each subtree has weight $2$, because $2+2+2=6\\le8$.\n\nGiven $N$, find the number of perfectly balanced trees with weight $N$.", "inputFormat": "The input contains one line with one integer $N$.", "outputFormat": "Output one integer, the number of perfectly balanced trees with weight $N$.", "hint": "#### Sample Explanation 1\n\nThe valid trees are:\n\n- A perfectly balanced tree whose root has $4$ subtrees of weight $1$.\n- A perfectly balanced tree whose root has $2$ subtrees of weight $2$.\n- A perfectly balanced tree whose root has $3$ subtrees of weight $1$.\n\nConstraints:\n\nFor $33\\%$ of the testdata, $N\\le1000$.  \nFor another $13\\%$ of the testdata, $N\\le5\\times 10^4$.  \nFor another $13\\%$ of the testdata, $N\\le10^6$.  \nFor all testdata, $1\\le N\\le10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2018] 平衡树", "background": "", "description": "**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S4「[Balanced Trees](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**\n\n我们定义「完美平衡树」如下：\n\n每棵完美平衡树都有一个正整数权值。权值为 $1$  的完美平衡树为只含有 $1$  个节点的树。否则，这棵树的权值为 $w(w\\ge2)$，则这棵树为一棵含有 $k(2\\le k\\le w)$ 棵子树的有根树。所有的 $k$ 棵子树都必须是相同的，且它的所有 $k$ 棵子树必须完全相同，且自身是完美平衡的。\n\n特别地，所有 $k$ 棵子树权值必须相同。它们的权值必须为 $\\left\\lfloor\\frac{w}{k}\\right\\rfloor$ 。例如，如果一棵权值为 $8$ 的完美平衡树有 $3$ 棵子树，那么每棵子树的权值为 $2$，因为 $2+2+2=6\\le8$。\n\n给定 $N$，求出权值为 $N$ 的完美平衡树的数量。\n", "inputFormat": "输入包含一行一个整数 $N$。", "outputFormat": "输出一个整数表示权值为 $N$ 的完美平衡树的数量。", "hint": "#### 样例解释 1\n\n合法的树如下：\n\n - 一棵以有 $4$ 棵权值为 $1$ 的子树为根的完美平衡树；\n - 一棵以有 $2$ 棵权值为 $2$ 的子树为根的完美平衡树；\n - 一棵以有 $3$ 棵权值为 $1$ 的子树为根的完美平衡树。\n\n对于 $33\\%$ 的数据，$N\\le1000$；  \n对于另外 $13\\%$ 的数据，$N\\le5\\times 10^4$；  \n对于另外 $13\\%$ 的数据，$N\\le10^6$；  \n对于全部的数据，$1\\le N\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P4809", "type": "P", "difficulty": 5, "samples": [["2 2 1 2\n1 2 1\n2 1 1\n2 1 1", "3"], ["2 3 4 1\n2 3 5\n3 2 7\n1 2 6\n1 1 8\n2 1 5", "41"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "CCC（加拿大）"], "title": "[CCC 2018] 最大战略储备", "background": "", "description": "**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S5「[Maximum Strategic Savings](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**\n\n有 $N$ 个星球，编号为 $1\\ldots N$。每个星球有 $M$ 座城市，编号为 $1\\ldots M$。我们将 $e$ 星球上的城市 $f$ 记作 $(e,\\,f)$。\n\n有 $N\\times P$ 条双向航线，对于每个星球 $e(1\\le e\\le N)$，有 $P$ 条航线，编号为 $1$ 到 $P$。第 $i$ 条航线连接城市 $(e,\\,a_i)$ 和 $(e,\\,b_i)$，且每天需要花费 $c_i$ 的代价维护。\n\n有 $M\\times Q$ 个双向港口。对于所有编号为 $f(1\\le f\\le M)$ 的城市，有 $Q$ 个港口，编号为 $1$ 到 $Q$。第 $j$ 个港口可以连接城市 $(x_j,\\,f)$ 和 $(y_j,\\,f)$，且每天需要花费 $z_j$ 的代价维护。\n\n现在需要拆除一些港口和（或）取消一些航线，使得城市之间仍能保持联通，且节省的代价之和最大。", "inputFormat": "第一行四个整数，分别为 $N,\\,M,\\,P,\\,Q\\ (0\\le N,\\,M,\\,P,\\,Q\\le10^5)$。\n\n接下来 $P$ 行，每行三个整数 $a_i,\\,b_i,\\,c_i(1\\le a_i,\\,b_i\\le M,\\,1\\le c_i\\le10^8)$。\n\n再接下来 $Q$ 行，每行三个整数 $x_j,\\,y_j,\\,z_j(1\\le x_j,\\,y_j\\le N,\\,1\\le z_j\\le 10^8)$。\n\n数据保证城市之间两两联通，可能有重边或自环。", "outputFormat": "输出一行一个整数表示每天最多能节省的代价之和。", "hint": "#### 样例 2 解释\n一种可行的最优解是关闭城市 $(1,\\,1)$ 与 $(1,1)$、$(2,\\,1)$ 与 $(2,\\,1)$、$(1,\\,1)$ 与 $(1,\\,2)$、$(1,\\,3)$ 与 $(1,\\,2)$、$(2,\\,3)$ 与 $(2,\\,2)$ 之间的航线；并关闭城市 $(2,\\,3)$ 与 $(1,\\,3)$ 间的港口。最终可以节省 $8 + 8 + 6 + 7 + 7 + 5 = 41$ 的代价。\n\n对于 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le100$，且对于所有的 $1\\le i\\le P$，都有 $c_i=1$；对于所有的 $1\\le j\\le Q$，都有 $z_j=1$；\n\n对于另外 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le 200$；\n\n对于另外 $\\frac{5}{15}$ 的数据，$N,\\,M\\le 200$；\n\n对于全部的数据，$1\\le N,\\,M,\\,P,\\,Q\\le10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2018] Maximum Strategic Savings", "background": "", "description": "**This problem is translated from [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S5 “[Maximum Strategic Savings](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)”.**\n\nThere are $N$ planets, numbered $1\\ldots N$. Each planet has $M$ cities, numbered $1\\ldots M$. We denote city $f$ on planet $e$ as $(e,\\,f)$.\n\nThere are $N\\times P$ undirected flight routes. For each planet $e(1\\le e\\le N)$, there are $P$ routes, numbered from $1$ to $P$. Route $i$ connects cities $(e,\\,a_i)$ and $(e,\\,b_i)$, and it costs $c_i$ per day to maintain.\n\nThere are $M\\times Q$ undirected ports. For every city index $f(1\\le f\\le M)$, there are $Q$ ports, numbered from $1$ to $Q$. Port $j$ can connect cities $(x_j,\\,f)$ and $(y_j,\\,f)$, and it costs $z_j$ per day to maintain.\n\nNow you need to remove some ports and/or cancel some flight routes such that all cities are still connected, and the total saved cost is maximized.", "inputFormat": "The first line contains four integers $N,\\,M,\\,P,\\,Q\\ (0\\le N,\\,M,\\,P,\\,Q\\le10^5)$.\n\nThe next $P$ lines each contain three integers $a_i,\\,b_i,\\,c_i(1\\le a_i,\\,b_i\\le M,\\,1\\le c_i\\le10^8)$.\n\nThe next $Q$ lines each contain three integers $x_j,\\,y_j,\\,z_j(1\\le x_j,\\,y_j\\le N,\\,1\\le z_j\\le 10^8)$.\n\nThe testdata guarantees that all cities are connected to each other. There may be multiple edges or self-loops.", "outputFormat": "Output one integer on a single line, representing the maximum total cost that can be saved per day.", "hint": "#### Explanation for Sample 2\n\nOne possible optimal solution is to close the flight routes between cities $(1,\\,1)$ and $(1,1)$, $(2,\\,1)$ and $(2,\\,1)$, $(1,\\,1)$ and $(1,\\,2)$, $(1,\\,3)$ and $(1,\\,2)$, and $(2,\\,3)$ and $(2,\\,2)$; and close the port between cities $(2,\\,3)$ and $(1,\\,3)$. In the end, you can save a cost of $8 + 8 + 6 + 7 + 7 + 5 = 41$.\n\nFor $\\frac{2}{15}$ of the testdata, $P,\\,Q\\le100$, and for all $1\\le i\\le P$, $c_i=1$; for all $1\\le j\\le Q$, $z_j=1$.\n\nFor another $\\frac{2}{15}$ of the testdata, $P,\\,Q\\le 200$.\n\nFor another $\\frac{5}{15}$ of the testdata, $N,\\,M\\le 200$.\n\nFor all testdata, $1\\le N,\\,M,\\,P,\\,Q\\le10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2018] 最大战略储备", "background": "", "description": "**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S5「[Maximum Strategic Savings](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**\n\n有 $N$ 个星球，编号为 $1\\ldots N$。每个星球有 $M$ 座城市，编号为 $1\\ldots M$。我们将 $e$ 星球上的城市 $f$ 记作 $(e,\\,f)$。\n\n有 $N\\times P$ 条双向航线，对于每个星球 $e(1\\le e\\le N)$，有 $P$ 条航线，编号为 $1$ 到 $P$。第 $i$ 条航线连接城市 $(e,\\,a_i)$ 和 $(e,\\,b_i)$，且每天需要花费 $c_i$ 的代价维护。\n\n有 $M\\times Q$ 个双向港口。对于所有编号为 $f(1\\le f\\le M)$ 的城市，有 $Q$ 个港口，编号为 $1$ 到 $Q$。第 $j$ 个港口可以连接城市 $(x_j,\\,f)$ 和 $(y_j,\\,f)$，且每天需要花费 $z_j$ 的代价维护。\n\n现在需要拆除一些港口和（或）取消一些航线，使得城市之间仍能保持联通，且节省的代价之和最大。", "inputFormat": "第一行四个整数，分别为 $N,\\,M,\\,P,\\,Q\\ (0\\le N,\\,M,\\,P,\\,Q\\le10^5)$。\n\n接下来 $P$ 行，每行三个整数 $a_i,\\,b_i,\\,c_i(1\\le a_i,\\,b_i\\le M,\\,1\\le c_i\\le10^8)$。\n\n再接下来 $Q$ 行，每行三个整数 $x_j,\\,y_j,\\,z_j(1\\le x_j,\\,y_j\\le N,\\,1\\le z_j\\le 10^8)$。\n\n数据保证城市之间两两联通，可能有重边或自环。", "outputFormat": "输出一行一个整数表示每天最多能节省的代价之和。", "hint": "#### 样例 2 解释\n一种可行的最优解是关闭城市 $(1,\\,1)$ 与 $(1,1)$、$(2,\\,1)$ 与 $(2,\\,1)$、$(1,\\,1)$ 与 $(1,\\,2)$、$(1,\\,3)$ 与 $(1,\\,2)$、$(2,\\,3)$ 与 $(2,\\,2)$ 之间的航线；并关闭城市 $(2,\\,3)$ 与 $(1,\\,3)$ 间的港口。最终可以节省 $8 + 8 + 6 + 7 + 7 + 5 = 41$ 的代价。\n\n对于 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le100$，且对于所有的 $1\\le i\\le P$，都有 $c_i=1$；对于所有的 $1\\le j\\le Q$，都有 $z_j=1$；\n\n对于另外 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le 200$；\n\n对于另外 $\\frac{5}{15}$ 的数据，$N,\\,M\\le 200$；\n\n对于全部的数据，$1\\le N,\\,M,\\,P,\\,Q\\le10^5$。", "locale": "zh-CN"}}}
{"pid": "P4810", "type": "P", "difficulty": 5, "samples": [["5\na 0\na 1\nb 2\nc 2 3\nb 4", "2\n1\n2"], ["11\na 0\na 1\na 2\na 3\na 2\nc 4 5\na 5\na 6\nc 8 7\nb 8\nb 8", "2\n2\n8\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] STOGOVI", "background": "", "description": " **译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T5「STOGOVI」**\n\nMirko 正在玩栈。游戏开始时，他有一个编号为 $0$ 的空栈。在游戏中的第 $i$ 步，他会选择一个存在的编号为 $v$ 的栈，将它复制一份并进行以下其中一种操作：\n\n 1. 将数字 $i$ 加入新栈的顶部。\n\n 2. 将新栈顶部的数字删除。\n\n 3. 选择另外一个编号为 $w$ 的栈，并统计有多少个不同的数同时存在于新栈与栈 $w$ 中。\n\n新创建的栈编号为 $i$。\n\nMirko 不喜欢自己用栈模拟这个过程，所以他想要你替他写一个程序来执行这个过程。对于每个删除操作输出删除的数，且对于每个统计操作，输出统计的结果。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 300\\ 000)$，表示这局游戏的步数。\n\n游戏的步骤以时间顺序按前 $N$ 个整数编号。\n\n以下 $N$ 行，第 $i$ 行表示游戏的第 $i$ 步，为以下三种格式之一：\n\n - `a v`，表示加入操作。\n\n - `b v`，表示删除操作。\n\n - `c v w`，表示统计操作。\n\n操作所涉及的编号一定在 $[0,i-1]$ 中。\n\n保证删除操作不会操作空栈。", "outputFormat": "对于每个删除或统计操作，输出一行，表示请求的数字。按照输入文件给出的操作顺序排列。", "hint": "#### 样例解释 1\n\n开始时，我们有栈 $S_0 = \\{\\}$。\n\n第一步，我们复制 $S_0$ 并将数字 $1$ 加入到顶部，$S_1 = \\{1\\}$。\n\n第二步，我们复制 $S_1$ 并将数字 $2$ 加入到顶部，$S_2 = \\{1,2\\}$。\n\n第三步，我们复制 $S_2$ 并删除数字，$2$，$S_3 = \\{1\\}$。\n\n第四步，我们复制 $S_2$ 并编号为 $S_4$，统计有多少个不同的数同时存在于 $S_4$ 与 $S_3$ 中。唯一同时存在于两个栈中的数是 $1$，所以答案为 $1$。\n\n第五步，我们复制 $S_4$ 并删除数字，$2$，$S_5 = \\{1\\}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2014/2015 #3] STOGOVI", "background": "", "description": "**Translated from [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T5 “STOGOVI”.**\n\nMirko is playing with stacks. At the start of the game, he has an empty stack numbered $0$. In step $i$ of the game, he chooses an existing stack numbered $v$, makes a copy of it, and then performs one of the following operations:\n\n1. Push the number $i$ onto the top of the new stack.\n\n2. Pop (delete) the number on the top of the new stack.\n\n3. Choose another stack numbered $w$, and count how many distinct numbers appear in both the new stack and stack $w$.\n\nThe newly created stack is numbered $i$.\n\nMirko does not like simulating this process with stacks by himself, so he wants you to write a program to carry it out. For each pop operation, output the deleted number, and for each counting operation, output the result.", "inputFormat": "The first line contains an integer $N$ $(1 \\le N \\le 300\\ 000)$, the number of steps in the game.\n\nThe steps of the game are numbered by the first $N$ integers in chronological order.\n\nEach of the next $N$ lines describes step $i$ in one of the following three formats:\n\n- `a v`, meaning a push operation.\n\n- `b v`, meaning a pop operation.\n\n- `c v w`, meaning a counting operation.\n\nAll indices involved in an operation are guaranteed to be in $[0, i - 1]$.\n\nIt is guaranteed that no pop operation will be applied to an empty stack.", "outputFormat": "For each pop or counting operation, output one line containing the requested number, in the order of operations given in the input file.", "hint": "#### Sample Explanation 1\n\nAt the start, we have the stack $S_0 = \\{\\}$.\n\nIn the first step, we copy $S_0$ and push the number $1$ onto the top, so $S_1 = \\{1\\}$.\n\nIn the second step, we copy $S_1$ and push the number $2$ onto the top, so $S_2 = \\{1,2\\}$.\n\nIn the third step, we copy $S_2$ and pop the number $2$, so $S_3 = \\{1\\}$.\n\nIn the fourth step, we copy $S_2$ as $S_4$, and count how many distinct numbers appear in both $S_4$ and $S_3$. The only number that appears in both stacks is $1$, so the answer is $1$.\n\nIn the fifth step, we copy $S_4$ and pop the number $2$, so $S_5 = \\{1\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2014/2015 #3] STOGOVI", "background": "", "description": " **译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T5「STOGOVI」**\n\nMirko 正在玩栈。游戏开始时，他有一个编号为 $0$ 的空栈。在游戏中的第 $i$ 步，他会选择一个存在的编号为 $v$ 的栈，将它复制一份并进行以下其中一种操作：\n\n 1. 将数字 $i$ 加入新栈的顶部。\n\n 2. 将新栈顶部的数字删除。\n\n 3. 选择另外一个编号为 $w$ 的栈，并统计有多少个不同的数同时存在于新栈与栈 $w$ 中。\n\n新创建的栈编号为 $i$。\n\nMirko 不喜欢自己用栈模拟这个过程，所以他想要你替他写一个程序来执行这个过程。对于每个删除操作输出删除的数，且对于每个统计操作，输出统计的结果。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 300\\ 000)$，表示这局游戏的步数。\n\n游戏的步骤以时间顺序按前 $N$ 个整数编号。\n\n以下 $N$ 行，第 $i$ 行表示游戏的第 $i$ 步，为以下三种格式之一：\n\n - `a v`，表示加入操作。\n\n - `b v`，表示删除操作。\n\n - `c v w`，表示统计操作。\n\n操作所涉及的编号一定在 $[0,i-1]$ 中。\n\n保证删除操作不会操作空栈。", "outputFormat": "对于每个删除或统计操作，输出一行，表示请求的数字。按照输入文件给出的操作顺序排列。", "hint": "#### 样例解释 1\n\n开始时，我们有栈 $S_0 = \\{\\}$。\n\n第一步，我们复制 $S_0$ 并将数字 $1$ 加入到顶部，$S_1 = \\{1\\}$。\n\n第二步，我们复制 $S_1$ 并将数字 $2$ 加入到顶部，$S_2 = \\{1,2\\}$。\n\n第三步，我们复制 $S_2$ 并删除数字，$2$，$S_3 = \\{1\\}$。\n\n第四步，我们复制 $S_2$ 并编号为 $S_4$，统计有多少个不同的数同时存在于 $S_4$ 与 $S_3$ 中。唯一同时存在于两个栈中的数是 $1$，所以答案为 $1$。\n\n第五步，我们复制 $S_4$ 并删除数字，$2$，$S_5 = \\{1\\}$。\n", "locale": "zh-CN"}}}
{"pid": "P4811", "type": "P", "difficulty": 7, "samples": [["3 3\n3 1 3 1\n2 2 1\n3 3 1 3\n1 2\n2 3\n3 1", "1\n0\n2"], ["2 1\n4 1 6 3 6\n7 3 4 2 6 5 6 1\n1 2", "3"], ["3 4\n3 1 4 2\n4 3 4 2 4\n3 4 1 3\n1 2\n2 3\n3 1\n1 3", "2\n1\n2\n2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] KAMIONI", "background": null, "description": "**译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T6「KAMIONI」**\n\n有一条马路，我们将其视为一条数轴。马路上有 $N$ 辆卡车，开始时，卡车都在整点上。所有卡车一起开始移动，并且都以**同样的速率**移动。**没有卡车保持静止**。每辆卡车花 $1$ 分钟可以移动 $1$ 个单位距离。\n\n给出每辆卡车的「路线」。路线用一个含有 $k$ 个元素的数组 $A_1,A_2,\\dots,A_k$ 表示。该卡车首先 $A_1$ 开往 $A_2$，然后立即掉头开往 $A_3$，以此类推。忽略掉头的耗时。考虑到卡车会掉头，我们保证：\n\n$$A_1 < A_2 > A_3 < A_4 > \\dots\\ \\mathrm{or}\\ A_1 > A_2 < A_3 > A_4 < \\dots$$\n\n一条可能的路线为 $2→5→1→7$（给出的点要么是起点，要么是终点，要么就是掉头的位置）。开始时卡车位于 $2$，出发 $3$ 分钟后到达位置 $5$，接着掉头。卡车继续行驶到位置 $1$ ，此时距出发已过去了 $7$ 分钟。卡车再次掉头，并行驶到位置 $7$，此时距出发已经经过了 $13$ 分钟。\n\n当卡车到达路线终点后，会有神秘的 ~~Planet6174~~ 外星人出现并把它带回飞船。\n\n给出这 $N$ 辆卡车的路线。现在有 $M$ 组询问，每组询问包含两辆卡车。对于每组询问，请回答这对卡车出现在同一位置的次数。位置不一定是整数，比如它们可以在位置 $2.5$ 相遇。\n\n请注意，保证每一对**询问的**（而不是随便一对）卡车：\n\n - 其中一个被 ~~Planet6174~~ 外星人带走的时候，它们不会在同一位置。\n - 它们不会在初始时刻或是其中一个转弯的时候在同一位置。\n\n> Planet6174：翻译这道题目的人已经被解决掉了（滑稽", "inputFormat": "第一行，两个整数 $N$ 和 $M(1 \\le N \\le 10^5,1 \\le M \\le 10^5)$，表示卡车的数量和询问的卡车的对数。\n\n以下 $N$ 行，其中第 $i$ 行表示第 $i$ 辆卡车的路线。  \n每行第一个整数 $K_i(1 \\le K_i \\le 3 \\cdot 10^5)$ 表示路线的长度。紧接着是 $K_i$ 个整数 $A_j(1 \\le A_j \\le 10^9)$，表示卡车 $i$ 路线上的点。给出的点要么是起点，要么是终点，要么就是掉头的位置。  \n所有卡车移动的路线长度之和不会超过 $3 \\cdot 10 ^5$。\n\n以下 $M$ 行，其中第 $i$ 行包含两个整数 $(a_i,b_i)$，表示第 $i$ 个询问的两辆卡车。", "outputFormat": "输出 $M$ 行，第 $i$ 行包含我们询问的第 $i$ 对卡车相遇的次数。", "hint": "对于 $50\\%$ 的数据，保证 $N \\le 10^2,K_i \\le 10^3,M \\le 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2014/2015 #3] KAMIONI", "background": "", "description": "**Translated from [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T6 \"KAMIONI\".**\n\nThere is a road, and we view it as a number line. There are $N$ trucks on the road. Initially, all trucks are at integer points. All trucks start moving at the same time, and they all move at the **same speed**. **No truck stays still.** Each truck can move $1$ unit of distance in $1$ minute.\n\nFor each truck, its \"route\" is given. A route is represented by an array $A_1,A_2,\\dots,A_k$ with $k$ elements. The truck first drives from $A_1$ to $A_2$, then immediately turns around and drives to $A_3$, and so on. Ignore the time spent on turning around. Since the truck turns around, we guarantee:\n\n$$A_1 < A_2 > A_3 < A_4 > \\dots\\ \\mathrm{or}\\ A_1 > A_2 < A_3 > A_4 < \\dots$$\n\nOne possible route is $2→5→1→7$ (the given points are either the start, the end, or turning points). At the beginning the truck is at $2$. After $3$ minutes it reaches position $5$, and then turns around. The truck continues to position $1$; at this time $7$ minutes have passed since it started. The truck turns around again and drives to position $7$; at this time $13$ minutes have passed since it started.\n\nWhen a truck reaches the end of its route, mysterious ~~Planet6174~~ aliens appear and take it back to their spaceship.\n\nThe routes of these $N$ trucks are given. Now there are $M$ queries, and each query contains two trucks. For each query, output how many times this pair of trucks appears at the same position. The position does not have to be an integer; for example, they can meet at position $2.5$.\n\nNote that for every pair of trucks **that is queried** (not an arbitrary pair), it is guaranteed that:\n\n- When one of them is taken away by the ~~Planet6174~~ aliens, they are not at the same position.\n- They are not at the same position at the initial time, nor at the moment when one of them turns around.\n\n> Planet6174: The person who translated this problem has already been dealt with (joking).", "inputFormat": "The first line contains two integers $N$ and $M(1 \\le N \\le 10^5,1 \\le M \\le 10^5)$, representing the number of trucks and the number of queried pairs.\n\nThe next $N$ lines describe the routes.  \nThe $i$-th line describes the route of the $i$-th truck. The first integer on the line is $K_i(1 \\le K_i \\le 3 \\cdot 10^5)$, the length of the route. This is followed by $K_i$ integers $A_j(1 \\le A_j \\le 10^9)$, representing the points on truck $i$'s route. The given points are either the start, the end, or turning points.  \nThe total sum of route lengths of all trucks does not exceed $3 \\cdot 10 ^ 5$.\n\nThe next $M$ lines each contain two integers $(a_i,b_i)$, representing the two trucks in the $i$-th query.", "outputFormat": "Output $M$ lines. The $i$-th line should contain the number of meetings for the $i$-th queried pair of trucks.", "hint": "For $50\\%$ of the testdata, it is guaranteed that $N \\le 10^2,K_i \\le 10^3,M \\le 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2014/2015 #3] KAMIONI", "background": null, "description": "**译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T6「KAMIONI」**\n\n有一条马路，我们将其视为一条数轴。马路上有 $N$ 辆卡车，开始时，卡车都在整点上。所有卡车一起开始移动，并且都以**同样的速率**移动。**没有卡车保持静止**。每辆卡车花 $1$ 分钟可以移动 $1$ 个单位距离。\n\n给出每辆卡车的「路线」。路线用一个含有 $k$ 个元素的数组 $A_1,A_2,\\dots,A_k$ 表示。该卡车首先 $A_1$ 开往 $A_2$，然后立即掉头开往 $A_3$，以此类推。忽略掉头的耗时。考虑到卡车会掉头，我们保证：\n\n$$A_1 < A_2 > A_3 < A_4 > \\dots\\ \\mathrm{or}\\ A_1 > A_2 < A_3 > A_4 < \\dots$$\n\n一条可能的路线为 $2→5→1→7$（给出的点要么是起点，要么是终点，要么就是掉头的位置）。开始时卡车位于 $2$，出发 $3$ 分钟后到达位置 $5$，接着掉头。卡车继续行驶到位置 $1$ ，此时距出发已过去了 $7$ 分钟。卡车再次掉头，并行驶到位置 $7$，此时距出发已经经过了 $13$ 分钟。\n\n当卡车到达路线终点后，会有神秘的 ~~Planet6174~~ 外星人出现并把它带回飞船。\n\n给出这 $N$ 辆卡车的路线。现在有 $M$ 组询问，每组询问包含两辆卡车。对于每组询问，请回答这对卡车出现在同一位置的次数。位置不一定是整数，比如它们可以在位置 $2.5$ 相遇。\n\n请注意，保证每一对**询问的**（而不是随便一对）卡车：\n\n - 其中一个被 ~~Planet6174~~ 外星人带走的时候，它们不会在同一位置。\n - 它们不会在初始时刻或是其中一个转弯的时候在同一位置。\n\n> Planet6174：翻译这道题目的人已经被解决掉了（滑稽", "inputFormat": "第一行，两个整数 $N$ 和 $M(1 \\le N \\le 10^5,1 \\le M \\le 10^5)$，表示卡车的数量和询问的卡车的对数。\n\n以下 $N$ 行，其中第 $i$ 行表示第 $i$ 辆卡车的路线。  \n每行第一个整数 $K_i(1 \\le K_i \\le 3 \\cdot 10^5)$ 表示路线的长度。紧接着是 $K_i$ 个整数 $A_j(1 \\le A_j \\le 10^9)$，表示卡车 $i$ 路线上的点。给出的点要么是起点，要么是终点，要么就是掉头的位置。  \n所有卡车移动的路线长度之和不会超过 $3 \\cdot 10 ^5$。\n\n以下 $M$ 行，其中第 $i$ 行包含两个整数 $(a_i,b_i)$，表示第 $i$ 个询问的两辆卡车。", "outputFormat": "输出 $M$ 行，第 $i$ 行包含我们询问的第 $i$ 对卡车相遇的次数。", "hint": "对于 $50\\%$ 的数据，保证 $N \\le 10^2,K_i \\le 10^3,M \\le 10^3$。", "locale": "zh-CN"}}}
{"pid": "P4812", "type": "P", "difficulty": 4, "samples": [["5\n250 180\n250 132\n220 123\n132 194\n220 105", "1 3\n1 3\n3 5\n1 5\n3 5"], ["10\n650 550\n550 554\n560 512\n610 460\n610 456\n650 392\n580 436\n650 366\n520 456\n490 456", "1 4\n1 8\n2 8\n2 7\n2 9\n1 10\n4 10\n1 10\n5 10\n5 10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "树状数组", "前缀和", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] COCI", "background": "", "description": " **译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T4「COCI」**\n\n第三轮 COCI 来了！为了估分，我们猜测：如果选手 $\\mathrm{A}$ 在前两轮比赛中分数都高于选手 $\\mathrm{B}$，那么选手 $\\mathrm{A}$ 第三轮的分数与选手 $\\mathrm{B}$ 的分数**至少相等**。\n\n在每轮比赛中（包括这一场）选手至少会为 $0$ 分，至多会得到 $650$ 分。在**总排行榜**中，选手们将会按照**三轮比赛的总得分**降序排列。如果有两名选手分数相同则排名相同，下一名分数更小的选手排名后移。\n比如有 $5$ 名选手，总得分分别为 $1000,1000,900,900$ 和 $800$，那么对应的排名为 $\\text{No.}\\ 1,$ $\\text{No.}\\ 1,$ $\\text{No.}\\ 3,$ $\\text{No.}\\ 3$ 和 $\\text{No.}\\ 5$。\n\n对于 $N$ 名选手中的每一名选手，我们知道他们的第一轮和第二轮得分。基于上述假设，请确定每名选手在经过三轮 COCI 之后可以获得的最高名次和最低名次。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 5\\times 10^5)$，表示选手的个数。\n\n以下 $N$ 行，每行两个整数，在 $[0,650]$ 范围内，表示每个选手第一场和第二场比赛的得分。", "outputFormat": "对于每个选手，输出一行，两个整数，分别为他可能得到的最高名次和最低名次。", "hint": "$1 \\le N \\le 5\\times 10^5$，所有的选手分数均在 $[0,650]$ 范围内。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2014/2015 #3] COCI", "background": "", "description": "**Translated from T4 \"COCI\" of [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/).**\n\nThe third round of COCI is coming! For the purpose of estimating scores, we make the following guess: if contestant $\\mathrm{A}$ scored higher than contestant $\\mathrm{B}$ in both of the first two rounds, then in the third round contestant $\\mathrm{A}$'s score is **at least equal to** contestant $\\mathrm{B}$'s score.\n\nIn each round (including this one), a contestant can score at least $0$ points and at most $650$ points. In the **overall leaderboard**, contestants are ranked in descending order by their **total score over the three rounds**. If two contestants have the same total score, they share the same rank, and the next contestant with a smaller score is ranked lower accordingly.\nFor example, if there are $5$ contestants with total scores $1000, 1000, 900, 900,$ and $800$, then their ranks are $\\text{No.}\\ 1,$ $\\text{No.}\\ 1,$ $\\text{No.}\\ 3,$ $\\text{No.}\\ 3,$ and $\\text{No.}\\ 5$.\n\nFor each of the $N$ contestants, we know their scores in the first and second rounds. Based on the assumption above, determine the best possible rank and the worst possible rank each contestant can obtain after three rounds of COCI.", "inputFormat": "The first line contains an integer $N \\ (1 \\le N \\le 5\\times 10^5)$, the number of contestants.\n\nThe next $N$ lines each contain two integers in the range $[0,650]$, representing the scores of each contestant in the first and second rounds.", "outputFormat": "For each contestant, output one line with two integers: their best possible rank and their worst possible rank.", "hint": "$1 \\le N \\le 5\\times 10^5$. All contestants' scores are in the range $[0,650]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2014/2015 #3] COCI", "background": "", "description": " **译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T4「COCI」**\n\n第三轮 COCI 来了！为了估分，我们猜测：如果选手 $\\mathrm{A}$ 在前两轮比赛中分数都高于选手 $\\mathrm{B}$，那么选手 $\\mathrm{A}$ 第三轮的分数与选手 $\\mathrm{B}$ 的分数**至少相等**。\n\n在每轮比赛中（包括这一场）选手至少会为 $0$ 分，至多会得到 $650$ 分。在**总排行榜**中，选手们将会按照**三轮比赛的总得分**降序排列。如果有两名选手分数相同则排名相同，下一名分数更小的选手排名后移。\n比如有 $5$ 名选手，总得分分别为 $1000,1000,900,900$ 和 $800$，那么对应的排名为 $\\text{No.}\\ 1,$ $\\text{No.}\\ 1,$ $\\text{No.}\\ 3,$ $\\text{No.}\\ 3$ 和 $\\text{No.}\\ 5$。\n\n对于 $N$ 名选手中的每一名选手，我们知道他们的第一轮和第二轮得分。基于上述假设，请确定每名选手在经过三轮 COCI 之后可以获得的最高名次和最低名次。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 5\\times 10^5)$，表示选手的个数。\n\n以下 $N$ 行，每行两个整数，在 $[0,650]$ 范围内，表示每个选手第一场和第二场比赛的得分。", "outputFormat": "对于每个选手，输出一行，两个整数，分别为他可能得到的最高名次和最低名次。", "hint": "$1 \\le N \\le 5\\times 10^5$，所有的选手分数均在 $[0,650]$ 范围内。", "locale": "zh-CN"}}}
{"pid": "P4813", "type": "P", "difficulty": 4, "samples": [["5\n.....\n.###.\n.###.\n#####\n.....", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2014", "CCO（加拿大）"], "title": "[CCO 2014] Troy 与三角形", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T1「[Troyangles](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\nTroy 喜欢三角形，所以他也特别喜欢数三角形。他有一个由 `.` 和 `#` 组成的 $N\\times N$ 的网格。帮他数数在网格中仅由 `#` 组成的三角的个数。三角形表示为如下形式：\n```plain\n          #\n    #    ###\n#, ###, #####, ...\n```\n更加形式化地说，一个高度为 $h$，有 $h$ 列的三角形，其中 $h$ 为正整数，第 $i$ 行有 $2i-1(1\\le i \\le h)$ 个 `#`，行在彼此上方居中，所以它们是关于它们的垂直中线对称的。", "inputFormat": "第一行一个数 $N$ 表示网格大小，接下来 $N$ 行每行 $N$ 个字符表示这个网格。", "outputFormat": "输出网格中的三角形个数。", "hint": "对于 $20\\%$ 的数据，$1\\le N\\le 50$；\n\n对于 $100\\%$ 的数据，$1\\le N \\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2014] Troy and Triangles", "background": "", "description": "**This problem is translated from [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day 1 T1 “[Troyangles](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)”.**\n\nTroy likes triangles, so he especially likes counting triangles. He has an $N \\times N$ grid consisting of `.` and `#`. Help him count how many triangles made only of `#` appear in the grid. A triangle looks like this:\n```plain\n          #\n    #    ###\n#, ###, #####, ...\n```\nMore formally, a triangle of height $h$ has $h$ rows, where $h$ is a positive integer. Row $i$ has $2i-1$ `#` characters $(1 \\le i \\le h)$. The rows are centered above each other, so the triangle is symmetric about its vertical center line.", "inputFormat": "The first line contains an integer $N$, the size of the grid. The next $N$ lines each contain $N$ characters describing the grid.", "outputFormat": "Output the number of triangles in the grid.", "hint": "For $20\\%$ of the testdata, $1 \\le N \\le 50$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2014] Troy 与三角形", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T1「[Troyangles](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\nTroy 喜欢三角形，所以他也特别喜欢数三角形。他有一个由 `.` 和 `#` 组成的 $N\\times N$ 的网格。帮他数数在网格中仅由 `#` 组成的三角的个数。三角形表示为如下形式：\n```plain\n          #\n    #    ###\n#, ###, #####, ...\n```\n更加形式化地说，一个高度为 $h$，有 $h$ 列的三角形，其中 $h$ 为正整数，第 $i$ 行有 $2i-1(1\\le i \\le h)$ 个 `#`，行在彼此上方居中，所以它们是关于它们的垂直中线对称的。", "inputFormat": "第一行一个数 $N$ 表示网格大小，接下来 $N$ 行每行 $N$ 个字符表示这个网格。", "outputFormat": "输出网格中的三角形个数。", "hint": "对于 $20\\%$ 的数据，$1\\le N\\le 50$；\n\n对于 $100\\%$ 的数据，$1\\le N \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P4814", "type": "P", "difficulty": 4, "samples": [["4 5 1 3\n1 2 5 1\n1 2 8 50\n2 3 2 15\n3 1 80 1000\n3 4 1 1\n4\n8\n6\n90\n94", "16\n0\n66\n1066"], ["4 3 1 2\n2 1 1 1\n3 4 10000 10000\n4 3 10000 10000\n1\n1000000000", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "CCO（加拿大）"], "title": "[CCO 2014] 国王格鲁夫", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T2「[King Gruff](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\n狼国王格鲁夫统治着一个居住着可爱的狐狸的繁荣、快乐的领地。对狐狸们来说，不幸的是，他根本不是一个好国王，而且还想让他们的生活过得很惨。\n\n他的国家有 $N$ 个城市，由 $M$ 条路连接，第 $i$ 条路可以让你从城市 $X_i$ 走到另一个城市 $Y_i$，并且只能往这个方向走，这条路的长度为 $L_i$，关闭费为 $C_i$，可能会有多条道路以相同的方向连接着两个相同的城市。\n\n国王格鲁夫尤其不喜欢住在两个不同城市 $A$ 和 $B$ 里的狐狸并且想让他们从城市 $A$ \n 到城市 $B$ 很麻烦甚至根本行不通。具体来说，他将选择一个距离 $D$，并且同时关闭某些他王国里的路。关闭的条件是，如果这条路是城市 $A$ 到城市 $B$ 路径上的一部分且该路径总长不超过 $D$。对于每条这样的路，他将用皇家金库里的钱取支付它的关闭费。一个路径包含一个路的序列，除了第一条路外，每条路起点在前一条路的终点，并且可能多次访问同一个城市或走同一条路。\n\n格鲁夫正在纠结选哪个 $D$，不管怎样，大一些的 $D$ 值可以使得他的狐狸子民更加不方便，但是可能花费他更多的钱！因此，他想了 $Q$ 个不同的值 $D_1,D_2,...,D_Q$，对于每一个值，他想知道需要花费多少来满足他的要求。因为你也不喜欢狐狸，你同意帮他写个程序计算最小花费。", "inputFormat": "第一行包括四个由空格分隔的整数 $N,M,A,B$，城市数，道路数，开始城市，结束城市。\n\n接下来 $M$ 行四个空格分隔的整数 $X_i,Y_i,L_i,C_i$，表示一条从 $X_i$ 到 $Y_i$ 的长为 $L_i$ 的路，它的关闭费为 $C_i$。\n\n接下来一行一个数 $Q$，表示询问个数。\n\n接下来 $Q$ 行包含一个数 $D_i$ 表示题中所述距离参数。", "outputFormat": "输出包括 $Q$ 行，表示根据距离参数 $D_i(1\\le i\\le Q)$ 求出的关闭所有必要的路的总花费。", "hint": "王国如下图所示，每条路只标注了长度。\n\n![CCO2014D1T2Pic1](https://upload.acmicpc.net/e0b8a0c8-3404-462a-9f08-c756f00f5234/-/preview/)\n\n如果 $D=8$，第一、三条路需要被关闭，他们都是从城市 $1$ 到 城市 $3$ 的长为 $7$ 的路径的一部分，总花费 $1+15=16$。\n\n如果 $D=6$，不需要关闭任何路，因为没有从城市 $1$ 到城市 $3$ 的路长度小于或等于 $6$。\n\n如果 $D=90$，前三条路都要被关闭。\n\n如果 $D=94$，第四条路也要被关闭，因为它在城市 $1$ 到城市 $3$ 的路径上，该路径长度刚好为 $94$，路径为依次走第一、三、四、一、三条路。\n\n王国如下图所示\n\n![CCOD2T2Pic2](https://upload.acmicpc.net/f0b3c521-616d-4259-8805-40e641a6f90b/-/preview/)\n\n就像你所看到的一样，狐狸已经有麻烦了，因为这里根本没有从城市 $1$ 到城市 $2$ 的路径，因此对于任何 $D$ 格鲁夫国王都不需要关闭任何道路。\n\n对于至多 $20\\%$ 的数据，$1\\le N\\le 500$；\n\n对于至多 $20\\%$ 的数据，$Q=1$；\n\n对于至多 $80\\%$ 的数据，$1\\le Q\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le X_i,Y_i,A,B\\le N \\le 10^5,$ $0\\le M\\le 10^5,$ $1\\le L_i,C_i\\le 10^4,$ $1\\le Q\\le 10^5,$ $1\\le D\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2014] King Gruff", "background": "", "description": "**This problem is translated from [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day 1 T2 “[King Gruff](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)”.**\n\nWolf King Gruff rules a prosperous and happy land inhabited by adorable foxes. Unfortunately for the foxes, he is not a good king at all, and he wants to make their lives miserable.\n\nHis country has $N$ cities connected by $M$ roads. Road $i$ allows you to travel from city $X_i$ to another city $Y_i$, and you may only travel in this direction. This road has length $L_i$ and closing cost $C_i$. There may be multiple roads in the same direction connecting the same pair of cities.\n\nKing Gruff especially dislikes foxes living in two different cities $A$ and $B$, and he wants traveling from city $A$ to city $B$ to be difficult or even impossible. Specifically, he will choose a distance $D$ and close some roads in his kingdom at the same time. A road must be closed if it is part of some path from city $A$ to city $B$ whose total length is at most $D$. For each such road, he will pay its closing cost from the royal treasury. A path consists of a sequence of roads where, except for the first road, the start city of each road is the end city of the previous road. The same city or the same road may be visited multiple times.\n\nGruff cannot decide which $D$ to choose. In general, a larger $D$ can make life more inconvenient for his fox subjects, but it may cost him more money. Therefore, he has come up with $Q$ different values $D_1, D_2, ..., D_Q$. For each value, he wants to know how much it would cost to meet his requirement. Since you also dislike foxes, you agree to help him write a program to compute the minimum total cost.", "inputFormat": "The first line contains four integers $N, M, A, B$ separated by spaces: the number of cities, the number of roads, the starting city, and the ending city.\n\nThe next $M$ lines each contain four integers $X_i, Y_i, L_i, C_i$ separated by spaces, describing a road from $X_i$ to $Y_i$ with length $L_i$ and closing cost $C_i$.\n\nThe next line contains an integer $Q$, the number of queries.\n\nThe next $Q$ lines each contain one integer $D_i$, the distance parameter described above.", "outputFormat": "Output $Q$ lines. Each line should be the total cost to close all required roads for the corresponding distance parameter $D_i$ ($1 \\le i \\le Q$).", "hint": "The kingdom is shown in the figure below, where each road is labeled only with its length.\n\n![CCO2014D1T2Pic1](https://upload.acmicpc.net/e0b8a0c8-3404-462a-9f08-c756f00f5234/-/preview/)\n\nIf $D = 8$, the first and third roads must be closed. They are both part of a path from city $1$ to city $3$ of length $7$, so the total cost is $1 + 15 = 16$.\n\nIf $D = 6$, no roads need to be closed, because there is no path from city $1$ to city $3$ with length less than or equal to $6$.\n\nIf $D = 90$, the first three roads must all be closed.\n\nIf $D = 94$, the fourth road must also be closed, because it lies on a path from city $1$ to city $3$ whose length is exactly $94$. The path takes, in order, the first, third, fourth, first, and third roads.\n\nThe kingdom is shown in the figure below.\n\n![CCOD2T2Pic2](https://upload.acmicpc.net/f0b3c521-616d-4259-8805-40e641a6f90b/-/preview/)\n\nAs you can see, the foxes are already in trouble, because there is no path from city $1$ to city $2$ at all. Therefore, for any $D$, King Gruff does not need to close any roads.\n\nConstraints:\n\nFor at most $20\\%$ of the testdata, $1 \\le N \\le 500$.\n\nFor at most $20\\%$ of the testdata, $Q = 1$.\n\nFor at most $80\\%$ of the testdata, $1 \\le Q \\le 20$.\n\nFor $100\\%$ of the testdata, $1 \\le X_i, Y_i, A, B \\le N \\le 10^5$, $0 \\le M \\le 10^5$, $1 \\le L_i, C_i \\le 10^4$, $1 \\le Q \\le 10^5$, $1 \\le D \\le 10^9$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2014] 国王格鲁夫", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T2「[King Gruff](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\n狼国王格鲁夫统治着一个居住着可爱的狐狸的繁荣、快乐的领地。对狐狸们来说，不幸的是，他根本不是一个好国王，而且还想让他们的生活过得很惨。\n\n他的国家有 $N$ 个城市，由 $M$ 条路连接，第 $i$ 条路可以让你从城市 $X_i$ 走到另一个城市 $Y_i$，并且只能往这个方向走，这条路的长度为 $L_i$，关闭费为 $C_i$，可能会有多条道路以相同的方向连接着两个相同的城市。\n\n国王格鲁夫尤其不喜欢住在两个不同城市 $A$ 和 $B$ 里的狐狸并且想让他们从城市 $A$ \n 到城市 $B$ 很麻烦甚至根本行不通。具体来说，他将选择一个距离 $D$，并且同时关闭某些他王国里的路。关闭的条件是，如果这条路是城市 $A$ 到城市 $B$ 路径上的一部分且该路径总长不超过 $D$。对于每条这样的路，他将用皇家金库里的钱取支付它的关闭费。一个路径包含一个路的序列，除了第一条路外，每条路起点在前一条路的终点，并且可能多次访问同一个城市或走同一条路。\n\n格鲁夫正在纠结选哪个 $D$，不管怎样，大一些的 $D$ 值可以使得他的狐狸子民更加不方便，但是可能花费他更多的钱！因此，他想了 $Q$ 个不同的值 $D_1,D_2,...,D_Q$，对于每一个值，他想知道需要花费多少来满足他的要求。因为你也不喜欢狐狸，你同意帮他写个程序计算最小花费。", "inputFormat": "第一行包括四个由空格分隔的整数 $N,M,A,B$，城市数，道路数，开始城市，结束城市。\n\n接下来 $M$ 行四个空格分隔的整数 $X_i,Y_i,L_i,C_i$，表示一条从 $X_i$ 到 $Y_i$ 的长为 $L_i$ 的路，它的关闭费为 $C_i$。\n\n接下来一行一个数 $Q$，表示询问个数。\n\n接下来 $Q$ 行包含一个数 $D_i$ 表示题中所述距离参数。", "outputFormat": "输出包括 $Q$ 行，表示根据距离参数 $D_i(1\\le i\\le Q)$ 求出的关闭所有必要的路的总花费。", "hint": "王国如下图所示，每条路只标注了长度。\n\n![CCO2014D1T2Pic1](https://upload.acmicpc.net/e0b8a0c8-3404-462a-9f08-c756f00f5234/-/preview/)\n\n如果 $D=8$，第一、三条路需要被关闭，他们都是从城市 $1$ 到 城市 $3$ 的长为 $7$ 的路径的一部分，总花费 $1+15=16$。\n\n如果 $D=6$，不需要关闭任何路，因为没有从城市 $1$ 到城市 $3$ 的路长度小于或等于 $6$。\n\n如果 $D=90$，前三条路都要被关闭。\n\n如果 $D=94$，第四条路也要被关闭，因为它在城市 $1$ 到城市 $3$ 的路径上，该路径长度刚好为 $94$，路径为依次走第一、三、四、一、三条路。\n\n王国如下图所示\n\n![CCOD2T2Pic2](https://upload.acmicpc.net/f0b3c521-616d-4259-8805-40e641a6f90b/-/preview/)\n\n就像你所看到的一样，狐狸已经有麻烦了，因为这里根本没有从城市 $1$ 到城市 $2$ 的路径，因此对于任何 $D$ 格鲁夫国王都不需要关闭任何道路。\n\n对于至多 $20\\%$ 的数据，$1\\le N\\le 500$；\n\n对于至多 $20\\%$ 的数据，$Q=1$；\n\n对于至多 $80\\%$ 的数据，$1\\le Q\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le X_i,Y_i,A,B\\le N \\le 10^5,$ $0\\le M\\le 10^5,$ $1\\le L_i,C_i\\le 10^4,$ $1\\le Q\\le 10^5,$ $1\\le D\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4815", "type": "P", "difficulty": 5, "samples": [["2 1 1\nD 1 2", "1"], ["2 1 0", "2"], ["3 2 2\nA 1 2\nD 1 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2014", "CCO（加拿大）"], "title": "[CCO 2014] 狼人游戏", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T3「[Werewolf](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\n和往常一样，$N$ 个机器人在玩狼人游戏，机器人从 $1$ 到 $N$ 编号。$W$ 个机器人扮演狼人，剩下的扮演市民。虽然狼人游戏包括不同的角度，但我们将只着眼于其中一个角度。\n\n机器人指控其他人是狼人并且防止其他机器人无辜地指控它。\n\n狼人知道其他人的角色以及：\n\n- 一个狼人从不指控其他狼人；\n\n- 任何狼人机器人保护的都是其他狼人机器人。\n\n市民可能会指控或保护任何类型的机器人。\n\n其他的一些限制使得题目更简单：\n\n- 没有机器人又被指控又被保护；\n\n- 没有机器人被指控或保护一次以上；\n\n- 如果有一个编号为 $A$ 机器人指控或保护编号为 $B$ 的机器人，那么我们保证$A<B$。\n\n你将知道 $N$ 个机器人间的所有指控和保护关系，并且知道狼人数为 $W$。每个机器人所扮演的角色要么是狼人要么是市民。你的目标是计算出符合上述限制的角色安排方案数。", "inputFormat": "第一行三个数 $N,W,M$，分别表示机器人数、狼人数、指控和保护关系数。\n\n接下来 $M$ 行每行描述一个关系，接下来每行都是以下两个形式之一：\n- `A a b`，表示机器人 $a$ 指控机器人 $b$ 是狼人。\n- `D a b`，表示机器人 $a$ 保护机器人 $b$。\n", "outputFormat": "输出满足以上条件的角色安排方案数量。可想而知，结果可能非常大，所以需要对 $10^9+7$ 取模。", "hint": "#### 样例解释 1\n如果机器人 $1$ 是狼人，机器人 $2$ 也必须是，那么狼人就太多了！唯一的可能是机器人 $2$ 是唯一的狼人。\n\n#### 样例输出 2\n没有额外的保护或指控信息的话，机器人 $1$ 和机器人 $2$ 都可能是狼人。\n\n#### 样例解释 3\n如果机器人 $1$ 是狼人，机器人 $2$ 将是市民，机器人 $3$ 也是狼人；或者机器人 $1$ 是市民，那么机器人 $2$ 和 $3$ 将是狼人。\n\n对于 $20\\%$ 的数据，$1\\le N\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 200,$ $0\\le W\\le N,$ $0\\le M<N$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2014] Werewolf Game", "background": "", "description": "**This problem is translated from [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day 1 T3「[Werewolf](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」.**\n\nAs usual, $N$ robots are playing a game of werewolf. The robots are numbered from $1$ to $N$. Exactly $W$ robots are werewolves, and the rest are villagers. Although the game of werewolf can be studied from different angles, we will focus on just one aspect.\n\nRobots may accuse others of being werewolves, and they may also protect other robots from being falsely accused.\n\nWerewolves know everyone’s roles, and:\n\n- A werewolf never accuses another werewolf.\n- Any robot protected by a werewolf is also a werewolf.\n\nVillagers may accuse or protect robots of any type.\n\nSome additional restrictions make the problem easier:\n\n- No robot is both accused and protected.\n- No robot is accused or protected more than once.\n- If a robot with number $A$ accuses or protects a robot with number $B$, then we guarantee that $A < B$.\n\nYou are given all accusation and protection relationships among the $N$ robots, as well as the number of werewolves $W$. Each robot’s role is either werewolf or villager. Your task is to count the number of role assignments that satisfy all the above restrictions.", "inputFormat": "The first line contains three integers $N, W, M$, representing the number of robots, the number of werewolves, and the number of accusation/protection relationships.\n\nThe next $M$ lines each describe one relationship. Each line is in one of the following two forms:\n- `A a b`, meaning robot $a$ accuses robot $b$ of being a werewolf.\n- `D a b`, meaning robot $a$ protects robot $b$.", "outputFormat": "Output the number of role assignments that satisfy the conditions above. Since the result can be very large, output it modulo $10^9 + 7$.", "hint": "#### Sample Explanation 1\n\nIf robot $1$ is a werewolf, then robot $2$ must also be a werewolf, which would give too many werewolves. The only possibility is that robot $2$ is the only werewolf.\n\n#### Sample Output 2\n\nIf there is no additional protection or accusation information, then both robot $1$ and robot $2$ could be the werewolf.\n\n#### Sample Explanation 3\n\nIf robot $1$ is a werewolf, then robot $2$ will be a villager and robot $3$ will also be a werewolf; or if robot $1$ is a villager, then robots $2$ and $3$ will be werewolves.\n\nFor $20\\%$ of the testdata, $1 \\le N \\le 20$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 200$, $0 \\le W \\le N$, $0 \\le M < N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2014] 狼人游戏", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T3「[Werewolf](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\n和往常一样，$N$ 个机器人在玩狼人游戏，机器人从 $1$ 到 $N$ 编号。$W$ 个机器人扮演狼人，剩下的扮演市民。虽然狼人游戏包括不同的角度，但我们将只着眼于其中一个角度。\n\n机器人指控其他人是狼人并且防止其他机器人无辜地指控它。\n\n狼人知道其他人的角色以及：\n\n- 一个狼人从不指控其他狼人；\n\n- 任何狼人机器人保护的都是其他狼人机器人。\n\n市民可能会指控或保护任何类型的机器人。\n\n其他的一些限制使得题目更简单：\n\n- 没有机器人又被指控又被保护；\n\n- 没有机器人被指控或保护一次以上；\n\n- 如果有一个编号为 $A$ 机器人指控或保护编号为 $B$ 的机器人，那么我们保证$A<B$。\n\n你将知道 $N$ 个机器人间的所有指控和保护关系，并且知道狼人数为 $W$。每个机器人所扮演的角色要么是狼人要么是市民。你的目标是计算出符合上述限制的角色安排方案数。", "inputFormat": "第一行三个数 $N,W,M$，分别表示机器人数、狼人数、指控和保护关系数。\n\n接下来 $M$ 行每行描述一个关系，接下来每行都是以下两个形式之一：\n- `A a b`，表示机器人 $a$ 指控机器人 $b$ 是狼人。\n- `D a b`，表示机器人 $a$ 保护机器人 $b$。\n", "outputFormat": "输出满足以上条件的角色安排方案数量。可想而知，结果可能非常大，所以需要对 $10^9+7$ 取模。", "hint": "#### 样例解释 1\n如果机器人 $1$ 是狼人，机器人 $2$ 也必须是，那么狼人就太多了！唯一的可能是机器人 $2$ 是唯一的狼人。\n\n#### 样例输出 2\n没有额外的保护或指控信息的话，机器人 $1$ 和机器人 $2$ 都可能是狼人。\n\n#### 样例解释 3\n如果机器人 $1$ 是狼人，机器人 $2$ 将是市民，机器人 $3$ 也是狼人；或者机器人 $1$ 是市民，那么机器人 $2$ 和 $3$ 将是狼人。\n\n对于 $20\\%$ 的数据，$1\\le N\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 200,$ $0\\le W\\le N,$ $0\\le M<N$。", "locale": "zh-CN"}}}
{"pid": "P4816", "type": "P", "difficulty": 4, "samples": [["4\n1\n8\n4\n3\n", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2015", "USACO", "枚举", "排序"], "title": "[USACO15DEC] High Card Low Card G", "background": "", "description": "Bessie the cow is a huge fan of card games, which is quite surprising, given her lack of opposable thumbs. Unfortunately, none of the other cows in the herd are good opponents. They are so bad, in fact, that they always play in a completely predictable fashion! Nonetheless, it can still be a challenge for Bessie to figure out how to win.\n\nBessie and her friend Elsie are currently playing a simple card game where they take a deck of $2N$ cards, conveniently numbered $1…2N$, and divide them into $N$ cards for Bessie and $N$ cards for Elsie. The two then play $N$ rounds, where in each round Bessie and Elsie both play a single card. In the first $N/2$ rounds, the player with the highest card earns a point, and in the last $N/2$ rounds, the rules switch and the player who plays the lowest card wins a point.\n\nGiven that Bessie can predict the order in which Elsie will play her cards, please determine the maximum number of points Bessie can win. ", "inputFormat": "The first line of input contains the value of $N$ ($2 ≤ N ≤ 50,000$; N will be even).\n\nThe next $N$ lines contain the cards that Elsie will play in each of the successive rounds of the game. Note that it is easy to determine Bessie's cards from this information. ", "outputFormat": " Output a single line giving the maximum number of points Bessie can score. ", "hint": "Here, Bessie must have cards 2, 5, and 6, and 7 in her hand, and she can use these to win at most 2 points, by saving her '2' card until one of the hands in the second half of the game.\n\nProblem credits: Brian Dean ", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] High Card Low Card G", "background": "", "description": "Bessie the cow is a huge fan of card games, which is quite surprising, given her lack of opposable thumbs. Unfortunately, none of the other cows in the herd are good opponents. They are so bad, in fact, that they always play in a completely predictable fashion! Nonetheless, it can still be a challenge for Bessie to figure out how to win.\n\nBessie and her friend Elsie are currently playing a simple card game where they take a deck of $2N$ cards, conveniently numbered $1…2N$, and divide them into $N$ cards for Bessie and $N$ cards for Elsie. The two then play $N$ rounds, where in each round Bessie and Elsie both play a single card. In the first $N/2$ rounds, the player with the highest card earns a point, and in the last $N/2$ rounds, the rules switch and the player who plays the lowest card wins a point.\n\nGiven that Bessie can predict the order in which Elsie will play her cards, please determine the maximum number of points Bessie can win. ", "inputFormat": "The first line of input contains the value of $N$ ($2 ≤ N ≤ 50,000$; N will be even).\n\nThe next $N$ lines contain the cards that Elsie will play in each of the successive rounds of the game. Note that it is easy to determine Bessie's cards from this information. ", "outputFormat": " Output a single line giving the maximum number of points Bessie can score. ", "hint": "Here, Bessie must have cards 2, 5, and 6, and 7 in her hand, and she can use these to win at most 2 points, by saving her '2' card until one of the hands in the second half of the game.\n\nProblem credits: Brian Dean ", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] High Card Low Card G", "background": "", "description": "奶牛 Bessie 是卡牌游戏的狂热爱好者，尽管她没有对生拇指，但这并不影响她的热情。遗憾的是，她的同伴们在卡牌游戏方面水平堪忧，甚至出牌顺序都完全可预测！尽管如此，Bessie 仍需精心策划才能获胜。\n\nBessie 和她的朋友 Elsie 正在玩一个简单的卡牌游戏。她们使用一副包含 $2N$ 张卡牌的牌组（编号为 $1 \\ldots 2N$），并将牌分成各 $N$ 张。随后进行 $N$ 轮比赛：每轮双方各打出一张牌。在前 $N/2$ 轮中，打出较大数字的玩家得 1 分；在后 $N/2$ 轮中，规则反转，打出较小数字的玩家得 1 分。\n\n已知 Bessie 可以预知 Elsie 每轮出牌的顺序，请计算 Bessie 能够获得的最大分数。", "inputFormat": "第一行输入包含整数 $N$（$2 \\leq N \\leq 50,000$，且 $N$ 为偶数）。\n\n接下来 $N$ 行按顺序给出 Elsie 在每轮比赛中将打出的卡牌。注意根据这些信息可以推断出 Bessie 手中的卡牌。", "outputFormat": "输出一行，包含 Bessie 能够获得的最大分数。", "hint": "在此样例中，Bessie 手中的卡牌为 $2$、$5$、$6$ 和 $7$。她可以通过在比赛后半段保留 $2$ 这张牌，从而最多获得 2 分。\n\n题目提供者：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P4817", "type": "P", "difficulty": 3, "samples": [["8 5 6", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "枚举"], "title": "[USACO15DEC] Fruit Feast G", "background": "", "description": "Bessie has broken into Farmer John's house again! She has discovered a pile of lemons and a pile of oranges in the kitchen (effectively an unlimited number of each), and she is determined to eat as much as possible.\n\nBessie has a maximum fullness of $T$ $(1 ≤ T ≤ 5,000,000)$. Eating an orange increases her fullness by $A$, and eating a lemon increases her fullness by $B$ ($1 ≤ A,B ≤ T$). Additionally, if she wants, Bessie can drink water at most one time, which will instantly decrease her fullness by half (and will round down).\n\nHelp Bessie determine the maximum fullness she can achieve! ", "inputFormat": "The first (and only) line has three integers $T$, $A$, and $B$. ", "outputFormat": " A single integer, representing the maximum fullness Bessie can achieve. ", "hint": "Problem credits: Nathan Pinsker ", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] Fruit Feast G", "background": "", "description": "Bessie has broken into Farmer John's house again! She has discovered a pile of lemons and a pile of oranges in the kitchen (effectively an unlimited number of each), and she is determined to eat as much as possible.\n\nBessie has a maximum fullness of $T$ $(1 ≤ T ≤ 5,000,000)$. Eating an orange increases her fullness by $A$, and eating a lemon increases her fullness by $B$ ($1 ≤ A,B ≤ T$). Additionally, if she wants, Bessie can drink water at most one time, which will instantly decrease her fullness by half (and will round down).\n\nHelp Bessie determine the maximum fullness she can achieve! ", "inputFormat": "The first (and only) line has three integers $T$, $A$, and $B$. ", "outputFormat": " A single integer, representing the maximum fullness Bessie can achieve. ", "hint": "Problem credits: Nathan Pinsker ", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] Fruit Feast G", "background": "", "description": "Bessie 再次闯入了 Farmer John 的房屋！她在厨房发现了一堆柠檬和一堆橙子（每种水果的数量都可以视为无限），并决定尽可能多吃。\n\nBessie 的最大饱腹度为 $T$（$1 \\leq T \\leq 5,000,000$）。每吃一个橙子会使饱腹度增加 $A$，每吃一个柠檬会使饱腹度增加 $B$（$1 \\leq A,B \\leq T$）。此外，Bessie 最多可以喝一次水，这将使饱腹度立即减半（向下取整）。\n\n请帮助 Bessie 计算她能达到的最大饱腹度！", "inputFormat": "唯一一行包含三个整数 $T$、$A$ 和 $B$。", "outputFormat": "输出一个整数，表示 Bessie 能达到的最大饱腹度。", "hint": "题目提供者：Nathan Pinsker", "locale": "zh-CN"}}}
{"pid": "P4818", "type": "P", "difficulty": 5, "samples": [["4 4\n1 0 2 1\n1 1 4 1\n1 0 4 0\n1 3 1 1", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "搜索", "2015", "USACO"], "title": "[USACO15DEC] Bessie's Dream G", "background": "", "description": "After eating too much fruit in Farmer John's kitchen, Bessie the cow is getting some very strange dreams! In her most recent dream, she is trapped in a maze in the shape of an $N×M$ grid of tiles $(1≤N,M≤1,000)$. She starts on the top-left tile and wants to get to the bottom-right tile. When she is standing on a tile, she can potentially move to the adjacent tiles in any of the four cardinal directions.\n\nBut wait! Each tile has a color, and each color has a different property! Bessie's head hurts just thinking about it:\n\n- If a tile is **red**, then it is impassable.\n\n- If a tile is **pink**, then it can be walked on normally.\n\n- If a tile is **orange**, then it can be walked on normally, but will make Bessie smell like oranges.\n\n- If a tile is **blue**, then it contains piranhas that will only let Bessie pass if she smells like oranges.\n\n- If a tile is **purple**, then Bessie will slide to the next tile in that direction (unless she is unable to cross it). If this tile is also a purple tile, then Bessie will continue to slide until she lands on a non-purple tile or hits an impassable tile. Sliding through a tile counts as a move. **Purple tiles will also remove Bessie's smell.**\n\n(If you're confused about purple tiles, the example will illustrate their use.)\n\nPlease help Bessie get from the top-left to the bottom-right in as few moves as possible. ", "inputFormat": " The first line has two integers $N$ and $M$, representing the number of rows and columns of the maze.\n\nThe next $N$ lines have $M$ integers each, representing the maze:\n\n- The integer '0' is a red tile\n\n- The integer '1' is a pink tile\n\n- The integer '2' is an orange tile\n\n- The integer '3' is a blue tile\n\n- The integer '4' is a purple tile \n\nThe top-left and bottom-right integers will always be '1'. ", "outputFormat": "A single integer, representing the minimum number of moves Bessie must use to cross the maze, or -1 if it is impossible to do so. ", "hint": "In this example, Bessie walks one square down and two squares to the right (and then slides one more square to the right). She walks one square up, one square left, and one square down (sliding two more squares down) and finishes by walking one more square right. This is a total of 10 moves (DRRRULDDDR).\n\nProblem credits: Nathan Pinsker, inspired by the game \"Undertale\". ", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] Bessie's Dream G", "background": "", "description": "After eating too much fruit in Farmer John's kitchen, Bessie the cow is getting some very strange dreams! In her most recent dream, she is trapped in a maze in the shape of an $N×M$ grid of tiles $(1≤N,M≤1,000)$. She starts on the top-left tile and wants to get to the bottom-right tile. When she is standing on a tile, she can potentially move to the adjacent tiles in any of the four cardinal directions.\n\nBut wait! Each tile has a color, and each color has a different property! Bessie's head hurts just thinking about it:\n\n- If a tile is **red**, then it is impassable.\n\n- If a tile is **pink**, then it can be walked on normally.\n\n- If a tile is **orange**, then it can be walked on normally, but will make Bessie smell like oranges.\n\n- If a tile is **blue**, then it contains piranhas that will only let Bessie pass if she smells like oranges.\n\n- If a tile is **purple**, then Bessie will slide to the next tile in that direction (unless she is unable to cross it). If this tile is also a purple tile, then Bessie will continue to slide until she lands on a non-purple tile or hits an impassable tile. Sliding through a tile counts as a move. **Purple tiles will also remove Bessie's smell.**\n\n(If you're confused about purple tiles, the example will illustrate their use.)\n\nPlease help Bessie get from the top-left to the bottom-right in as few moves as possible. ", "inputFormat": " The first line has two integers $N$ and $M$, representing the number of rows and columns of the maze.\n\nThe next $N$ lines have $M$ integers each, representing the maze:\n\n- The integer '0' is a red tile\n\n- The integer '1' is a pink tile\n\n- The integer '2' is an orange tile\n\n- The integer '3' is a blue tile\n\n- The integer '4' is a purple tile \n\nThe top-left and bottom-right integers will always be '1'. ", "outputFormat": "A single integer, representing the minimum number of moves Bessie must use to cross the maze, or -1 if it is impossible to do so. ", "hint": "In this example, Bessie walks one square down and two squares to the right (and then slides one more square to the right). She walks one square up, one square left, and one square down (sliding two more squares down) and finishes by walking one more square right. This is a total of 10 moves (DRRRULDDDR).\n\nProblem credits: Nathan Pinsker, inspired by the game \"Undertale\". ", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] Bessie's Dream G", "background": "", "description": "Bessie 在 Farmer John 的厨房暴食水果后，开始做奇怪的梦！在最近的梦境中，她被困在一个 $N \\times M$ 的网格迷宫（$1 \\leq N,M \\leq 1,000$）中。她需要从左上角的格子移动到右下角的格子。当站在某个格子时，她可以向四个基本方向移动至相邻格子。\n\n但请注意！每个格子有不同的颜色和特殊属性：\n\n- **红色（0）**：不可通行  \n- **粉色（1）**：可正常通行  \n- **橙色（2）**：可正常通行，且会使 Bessie 带有橙子气味  \n- **蓝色（3）**：仅当 Bessie 带有橙子气味时方可通行  \n- **紫色（4）**：Bessie 将沿该方向滑动到下一个格子（除非无法通过）。若下一个格子仍是紫色，则继续滑动直至遇到非紫色格子或不可通行格子。**每次滑动均计为一步移动**，且**紫色格子会消除 Bessie 的气味**\n\n（若对紫色格子机制有疑问，样例将帮助理解）\n\n请帮助 Bessie 找到从左上角到右下角的最短路径步数。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$，表示迷宫的行数和列数。  \n接下来 $N$ 行每行包含 $M$ 个整数描述迷宫：  \n- 0 表示红色  \n- 1 表示粉色  \n- 2 表示橙色  \n- 3 表示蓝色  \n- 4 表示紫色  \n\n保证左上角和右下角的格子始终为 1。", "outputFormat": "输出一个整数，表示 Bessie 穿越迷宫所需的最少步数，若无法到达则输出 -1。", "hint": "样例中，Bessie 的移动路径为：向下 1 步，向右 2 步（滑动再向右 1 步），向上 1 步，向左 1 步，向下 1 步（滑动再向下 2 步），最后向右 1 步。总计 10 步（路径表示为 DRRRULDDDR）。\n\n题目提供者：Nathan Pinsker，灵感来自游戏《Undertale》", "locale": "zh-CN"}}}
{"pid": "P4819", "type": "P", "difficulty": 6, "samples": [["5 4 \n1 2 \n1 3 \n1 4 \n1 5 ", "0.800000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["图论建模", "强连通分量"], "title": "[中山市选] 杀人游戏", "background": null, "description": "一位冷血的杀手潜入 Na-wiat，并假装成平民。警察希望能在 $N$ 个人里面，查出谁是杀手。警察能够对每一个人进行查证，假如查证的对象是平民，他会告诉警察，他认识的人，谁是杀手，谁是平民。假如查证的对象是杀手，杀手将会把警察干掉。现在警察掌握了每一个人认识谁。每一个人都有可能是杀手，可看作他们是杀手的概率是相同的。\n\n问：根据最优的情况，保证警察自身安全并知道谁是杀手的概率最大是多少？", "inputFormat": "第一行有两个整数 $N,M$。\n\n接下来有 $M$ 行，每行两个整数 $x,y$，表示 $x$ 认识 $y$（$y$ 不一定认识 $x$，例如 President 同志）。", "outputFormat": "仅包含一行一个实数，保留小数点后面 $6$ 位，表示最大概率。", "hint": "警察只需要查证 $1$。假如 $1$ 是杀手，警察就会被杀。假如 $1$ 不是杀手，他会告诉警察 $2,3,4,5$ 谁是杀手。而 $1$ 是杀手的概率是 $0.2$，所以能知道谁是杀手但没被杀的概率是 $0.8$。\n\n对于 $100\\%$ 的数据有 $1\\le N\\le 1\\times 10^5,0\\le M\\le 3\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Zhongshan City Selection] Murder Game", "background": "", "description": "A cold-blooded killer sneaks into Na-wiat and pretends to be a civilian. The police want to find out who the killer is among $N$ people. The police can verify people one by one. If the verified person is a civilian, they will tell the police, among the people they know, who is the killer and who is a civilian. If the verified person is the killer, the killer will kill the police.\n\nNow the police know, for every person, whom they know. Everyone could be the killer, and the probability that each person is the killer is the same.\n\nQuestion: Under an optimal strategy, what is the maximum possible probability that the police can both guarantee their own safety and know who the killer is?", "inputFormat": "The first line contains two integers $N, M$.\n\nThe next $M$ lines each contain two integers $x, y$, meaning that $x$ knows $y$ ($y$ does not necessarily know $x$, for example, Comrade President).", "outputFormat": "Output only one real number in a single line, rounded to $6$ digits after the decimal point, representing the maximum probability.", "hint": "The police only need to verify person $1$. If $1$ is the killer, the police will be killed. If $1$ is not the killer, they will tell the police, among $2, 3, 4, 5$, who is the killer. Since the probability that $1$ is the killer is $0.2$, the probability that the police can know who the killer is without being killed is $0.8$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 1 \\times 10^5$, $0 \\le M \\le 3 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[中山市选] 杀人游戏", "background": null, "description": "一位冷血的杀手潜入 Na-wiat，并假装成平民。警察希望能在 $N$ 个人里面，查出谁是杀手。警察能够对每一个人进行查证，假如查证的对象是平民，他会告诉警察，他认识的人，谁是杀手，谁是平民。假如查证的对象是杀手，杀手将会把警察干掉。现在警察掌握了每一个人认识谁。每一个人都有可能是杀手，可看作他们是杀手的概率是相同的。\n\n问：根据最优的情况，保证警察自身安全并知道谁是杀手的概率最大是多少？", "inputFormat": "第一行有两个整数 $N,M$。\n\n接下来有 $M$ 行，每行两个整数 $x,y$，表示 $x$ 认识 $y$（$y$ 不一定认识 $x$，例如 President 同志）。", "outputFormat": "仅包含一行一个实数，保留小数点后面 $6$ 位，表示最大概率。", "hint": "警察只需要查证 $1$。假如 $1$ 是杀手，警察就会被杀。假如 $1$ 不是杀手，他会告诉警察 $2,3,4,5$ 谁是杀手。而 $1$ 是杀手的概率是 $0.2$，所以能知道谁是杀手但没被杀的概率是 $0.8$。\n\n对于 $100\\%$ 的数据有 $1\\le N\\le 1\\times 10^5,0\\le M\\le 3\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4820", "type": "P", "difficulty": 6, "samples": [["1 100", "49"], ["2 100", "74"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000]}, "tags": ["集训队互测"], "title": "[国家集训队] 书堆", "background": null, "description": "蚂蚁是勤劳的动物，他们喜欢挑战极限?现在他们迎来了一个难题！蚂蚁居住在图书馆里，图书馆里有大量的书籍。书是形状大小质量都一样的矩形。蚂蚁要把这些书摆在水平桌子的边缘。蚂蚁喜欢整洁的布置，所以蚂蚁规定书本必须水平摆放，宽必须平行于桌缘（如图），而且不允许同一高度摆多本书。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6wnkei7t.png)\n\n蚂蚁想要让书本伸出桌子边缘尽量远，同时不让书因为重力垮下来。它们己经用不知道什么方法测出了书的长度 $ M $\n (如图)。如果总共有 $ N $ 本书，请你帮忙计算如何摆放使得最多水平伸出桌缘多远。你不用考虑蚂蚁用什么方法搭建这堆书。\n\n如果某本书以上的所有书的重心的竖直射影不在这本书上，或者正好落在在这本书的边界上，那么这堆书是不稳定的，会因为重力而垮下来。\n\n考虑以下的假设：\n\n- 不考虑地球自转，重力系数也不因高度改变；\n- 书是质量均匀，质地坚硬的理想二维物体；\n- 在不会垮的前提下，每本书的位置坐标可以是任意实数。", "inputFormat": "第一行正整数 $ N $, $ M $", "outputFormat": "输出一个整数 $ L $ 表示水平延伸最远的整数距离 （不大于答案的最大整数）。", "hint": "$ N \\le 10^{18} $，数据保证答案 $< 10^{6}$", "locale": "zh-CN", "translations": {"en": {"title": "[CTT] Book Stack", "background": "", "description": "Ants are hardworking animals, and they like to challenge limits. Now they have run into a difficult problem. The ants live in a library with a large number of books. Each book is a rectangle with the same shape, size, and mass. The ants want to place these books at the edge of a horizontal table. The ants like a neat arrangement, so they require that the books must be placed horizontally, with their width parallel to the table edge (as shown in the figure), and it is not allowed to place more than one book at the same height.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6wnkei7t.png)\n\nThe ants want the books to extend out of the table edge as far as possible, while not letting the stack collapse due to gravity. They have already measured the book length $M$ (as shown in the figure) using some unknown method. If there are a total of $N$ books, please help compute how to place them so that the maximum horizontal overhang beyond the table edge is as large as possible. You do not need to consider how the ants build this stack of books.\n\nIf the vertical projection of the center of mass of all books above a certain book is not on that book, or falls exactly on the boundary of that book, then the stack is unstable and will collapse due to gravity.\n\nConsider the following assumptions:\n\n- Ignore the Earth's rotation, and the gravitational coefficient does not change with height.\n- The books are ideal 2D objects with uniform mass and rigid material.\n- Under the condition that the stack does not collapse, each book's position coordinates can be any real number.\n\n## Constraints\n\n- $N \\le 10^{18}$, and the testdata guarantees that the answer is $< 10^{6}$.", "inputFormat": "The first line contains positive integers $N$ and $M$.", "outputFormat": "Output an integer $L$, representing the farthest integer distance of horizontal extension (the greatest integer not exceeding the answer).", "hint": "$N \\le 10^{18}$, and the testdata guarantees that the answer is $< 10^{6}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[国家集训队] 书堆", "background": null, "description": "蚂蚁是勤劳的动物，他们喜欢挑战极限?现在他们迎来了一个难题！蚂蚁居住在图书馆里，图书馆里有大量的书籍。书是形状大小质量都一样的矩形。蚂蚁要把这些书摆在水平桌子的边缘。蚂蚁喜欢整洁的布置，所以蚂蚁规定书本必须水平摆放，宽必须平行于桌缘（如图），而且不允许同一高度摆多本书。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6wnkei7t.png)\n\n蚂蚁想要让书本伸出桌子边缘尽量远，同时不让书因为重力垮下来。它们己经用不知道什么方法测出了书的长度 $ M $\n (如图)。如果总共有 $ N $ 本书，请你帮忙计算如何摆放使得最多水平伸出桌缘多远。你不用考虑蚂蚁用什么方法搭建这堆书。\n\n如果某本书以上的所有书的重心的竖直射影不在这本书上，或者正好落在在这本书的边界上，那么这堆书是不稳定的，会因为重力而垮下来。\n\n考虑以下的假设：\n\n- 不考虑地球自转，重力系数也不因高度改变；\n- 书是质量均匀，质地坚硬的理想二维物体；\n- 在不会垮的前提下，每本书的位置坐标可以是任意实数。", "inputFormat": "第一行正整数 $ N $, $ M $", "outputFormat": "输出一个整数 $ L $ 表示水平延伸最远的整数距离 （不大于答案的最大整数）。", "hint": "$ N \\le 10^{18} $，数据保证答案 $< 10^{6}$", "locale": "zh-CN"}}}
{"pid": "P4821", "type": "P", "difficulty": 4, "samples": [["1\n2", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["枚举", "图论建模"], "title": "[中山市选] 生成树", "background": null, "description": "有一种图形叫做五角形圈。一个五角形圈的中心有 $1$ 个由 $n$ 个顶点和 $n$ 条边组成的圈。在中心的这个 $n$ 边圈的每一条边同时也是某一个五角形的一条边，一共有 $n$ 个不同的五角形。这些五角形只在五角形圈的中心的圈上有公共的顶点。如图 0 所示是一个 $4$ -五角形圈。\n\n![https://cdn.luogu.com.cn/upload/pic/22665.png](https://cdn.luogu.com.cn/upload/pic/22665.png)\n\n现在给定一个 $n$ 五角形圈，你的任务就是求出 $n$ 五角形圈的不同生成树的数目。还记得什么是图的生成树吗？一个图的生成树是保留原图的所有顶点以及顶点的数目减去一这么多条边,从而生成的一棵树。\n注意：在给定的 $n$ 五角形圈中所有顶点均视为不同的顶点。", "inputFormat": "输入包含多组测试数据。第一行包含一个正整数 $T$，表示测试数据数目。每组测试数据包含一个整数 $n$，代表你需要求解的五角形圈中心的边数。", "outputFormat": "对每一组测试数据，输出一行包含一个整数 $n$，表示 $n$ 五角形圈的生成树数目模 $2007$ 之后的结果。", "hint": "$2\\leq n \\leq 100$", "locale": "zh-CN", "translations": {"en": {"title": "[Zhongshan City Selection] Spanning Tree", "background": "", "description": "There is a kind of graph called a pentagon ring. The center of a pentagon ring has one cycle consisting of $n$ vertices and $n$ edges. Each edge of this central $n$-cycle is also an edge of some pentagon, and there are exactly $n$ different pentagons in total. These pentagons share vertices only on the central cycle of the pentagon ring. Figure 0 shows a $4$-pentagon ring.\n\n![https://cdn.luogu.com.cn/upload/pic/22665.png](https://cdn.luogu.com.cn/upload/pic/22665.png)\n\nNow given an $n$-pentagon ring, your task is to find the number of different spanning trees of the $n$-pentagon ring. Do you still remember what a spanning tree is? A spanning tree of a graph is a tree formed by keeping all vertices of the original graph and keeping exactly one less edge than the number of vertices.\nNote: In the given $n$-pentagon ring, all vertices are considered distinct.", "inputFormat": "The input contains multiple test cases. The first line contains a positive integer $T$, which is the number of test cases. Each test case contains an integer $n$, which represents the number of edges of the central cycle in the $n$-pentagon ring you need to solve.", "outputFormat": "For each test case, output one line containing an integer, which is the number of spanning trees of the $n$-pentagon ring modulo $2007$.", "hint": "$2\\leq n \\leq 100$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[中山市选] 生成树", "background": null, "description": "有一种图形叫做五角形圈。一个五角形圈的中心有 $1$ 个由 $n$ 个顶点和 $n$ 条边组成的圈。在中心的这个 $n$ 边圈的每一条边同时也是某一个五角形的一条边，一共有 $n$ 个不同的五角形。这些五角形只在五角形圈的中心的圈上有公共的顶点。如图 0 所示是一个 $4$ -五角形圈。\n\n![https://cdn.luogu.com.cn/upload/pic/22665.png](https://cdn.luogu.com.cn/upload/pic/22665.png)\n\n现在给定一个 $n$ 五角形圈，你的任务就是求出 $n$ 五角形圈的不同生成树的数目。还记得什么是图的生成树吗？一个图的生成树是保留原图的所有顶点以及顶点的数目减去一这么多条边,从而生成的一棵树。\n注意：在给定的 $n$ 五角形圈中所有顶点均视为不同的顶点。", "inputFormat": "输入包含多组测试数据。第一行包含一个正整数 $T$，表示测试数据数目。每组测试数据包含一个整数 $n$，代表你需要求解的五角形圈中心的边数。", "outputFormat": "对每一组测试数据，输出一行包含一个整数 $n$，表示 $n$ 五角形圈的生成树数目模 $2007$ 之后的结果。", "hint": "$2\\leq n \\leq 100$", "locale": "zh-CN"}}}
{"pid": "P4822", "type": "P", "difficulty": 4, "samples": [["4 4 1 \n1 2 4 \n4 2 6 \n1 3 8 \n3 4 8 \n", "7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "北京", "图论建模", "最短路"], "title": "[BJWC2012] 冻结", "background": "“我要成为魔法少女！”\n\n“那么，以灵魂为代价，你希望得到什么？”\n\n“我要将有关魔法和奇迹的一切，封印于卡片之中„„”\n\n在这个愿望被实现以后的世界里，人们享受着魔法卡片（SpellCard，又名符卡）带来的便捷。\n\n现在，不需要立下契约也可以使用魔法了！你还不来试一试？\n\n比如，我们在魔法百科全书（Encyclopedia of Spells）里用“freeze”作为关键字来查询，会有很多有趣的结果。\n\n例如，我们熟知的 Cirno，她的冰冻魔法当然会有对应的 SpellCard 了。当然，更加令人惊讶的是，居然有冻结时间的魔法，Cirno 的冻青蛙比起这些来真是小巫见大巫了。\n\n这说明之前的世界中有很多魔法少女曾许下控制时间的愿望，比如 Akemi Homura、Sakuya Izayoi、……\n\n当然，在本题中我们并不是要来研究历史的，而是研究魔法的应用。", "description": "我们考虑最简单的旅行问题吧： 现在这个大陆上有 $N$ 个城市，$M$ 条双向的道路。城市编号为 $1$ ~ $N$，我们在 $1$ 号城市，需要到 $N$ 号城市，怎样才能最快地到达呢？\n\n这不就是最短路问题吗？我们都知道可以用 Dijkstra、Bellman-Ford、Floyd-Warshall等算法来解决。\n\n现在，我们一共有 $K$ 张可以使时间变慢 $50\\%$ 的 SpellCard，也就是说，在通过某条路径时，我们可以选择使用一张卡片，这样，我们通过这一条道路的时间 就可以减少到原先的一半。需要注意的是：\n\n1. 在一条道路上最多只能使用一张 SpellCard。\n2. 使用一张SpellCard 只在一条道路上起作用。\n3. 你不必使用完所有的 SpellCard。\n\n给定以上的信息，你的任务是：求出在可以使用这不超过 $K$ 张时间减速的 SpellCard 之情形下，从城市 $1$ 到城市 $N$ 最少需要多长时间。", "inputFormat": "第一行包含三个整数：$N$、$M$、$K$。\n\n接下来 $M$ 行，每行包含三个整数：$A_i$、$B_i$、$Time_i$，表示存在一条  $A_i$ 与 $B_i$ 之间的双向道路，在不使用 SpellCard 之前提下，通过它需要 $Time_i$ 的时间。", "outputFormat": "输出一个整数，表示从 $1$ 号城市到 $N$ 号城市的最小用时。", "hint": "#### 样例 1 解释\n\n在不使用 SpellCard 时，最短路为 $1 \\to 2 \\to 4$，总时间为 $10$。现在我们可以使用 $1$ 次 SpellCard，那么我们将通过 $2 \\to 4$ 这条道路的时间减半，此时总时间为 $7$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证：\n\n- $1 \\leq K \\leq N \\leq 50$，$M \\leq 10^3$。\n- $1 \\leq A_i,B_i \\leq N$，$2 \\leq Time_i \\leq 2 \\times 10^3$。\n- 为保证答案为整数，保证所有的 $Time_i$ 均为偶数。\n- 所有数据中的无向图保证无自环、重边，且是连通的。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2012] Freeze", "background": "“I want to become a magical girl.”\n\n“Then, in exchange for your soul, what do you wish to obtain?”\n\n“I want to seal everything about magic and miracles into cards...”\n\nIn the world after this wish comes true, people enjoy the convenience brought by magic cards (SpellCard, also known as “符卡”).\n\nNow, you can use magic without making a contract! Why not give it a try?\n\nFor example, if we search the Encyclopedia of Spells with the keyword “freeze”, we will get many interesting results.\n\nFor instance, the well-known Cirno surely has a corresponding SpellCard for her freezing magic. Even more surprising, there is actually magic that can freeze time. Compared with these, Cirno’s frozen frogs are nothing.\n\nThis shows that in the previous world, many magical girls once made wishes to control time, such as Akemi Homura, Sakuya Izayoi, ...\n\nOf course, in this problem we are not studying history, but the application of magic.", "description": "Let us consider the simplest travel problem: there are $N$ cities and $M$ bidirectional roads on this continent. The cities are numbered from $1$ to $N$. We start at city $1$ and need to reach city $N$. How can we arrive as fast as possible?\n\nIs this not just the shortest path problem? We all know it can be solved using algorithms such as Dijkstra, Bellman-Ford, and Floyd-Warshall.\n\nNow, we have $K$ SpellCards that can slow down time by $50\\%$. That is, when traveling along an edge, we may choose to use one card, so the time to pass that road becomes half of the original. Note that:\n\n1. On each road, at most one SpellCard can be used.\n2. Using one SpellCard only takes effect on one road.\n3. You do not have to use all SpellCards.\n\nGiven the above information, your task is to find the minimum time needed to travel from city $1$ to city $N$ when you may use at most $K$ time-slowing SpellCards.", "inputFormat": "The first line contains three integers: $N$, $M$, $K$.\n\nThe next $M$ lines each contain three integers: $A_i$, $B_i$, $Time_i$, meaning there is a bidirectional road between $A_i$ and $B_i$. Without using a SpellCard, passing through it takes $Time_i$ time.", "outputFormat": "Output one integer, the minimum time needed to travel from city $1$ to city $N$.", "hint": "#### Sample 1 Explanation\n\nWithout using any SpellCard, the shortest path is $1 \\to 2 \\to 4$, with total time $10$. Now we can use $1$ SpellCard, so we halve the time on the road $2 \\to 4$, and the total time becomes $7$.\n\n#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that:\n\n- $1 \\leq K \\leq N \\leq 50$, $M \\leq 10^3$.\n- $1 \\leq A_i,B_i \\leq N$, $2 \\leq Time_i \\leq 2 \\times 10^3$.\n- To ensure the answer is an integer, all $Time_i$ are even.\n- The undirected graph in all data has no self-loops or multiple edges, and is connected.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2012] 冻结", "background": "“我要成为魔法少女！”\n\n“那么，以灵魂为代价，你希望得到什么？”\n\n“我要将有关魔法和奇迹的一切，封印于卡片之中„„”\n\n在这个愿望被实现以后的世界里，人们享受着魔法卡片（SpellCard，又名符卡）带来的便捷。\n\n现在，不需要立下契约也可以使用魔法了！你还不来试一试？\n\n比如，我们在魔法百科全书（Encyclopedia of Spells）里用“freeze”作为关键字来查询，会有很多有趣的结果。\n\n例如，我们熟知的 Cirno，她的冰冻魔法当然会有对应的 SpellCard 了。当然，更加令人惊讶的是，居然有冻结时间的魔法，Cirno 的冻青蛙比起这些来真是小巫见大巫了。\n\n这说明之前的世界中有很多魔法少女曾许下控制时间的愿望，比如 Akemi Homura、Sakuya Izayoi、……\n\n当然，在本题中我们并不是要来研究历史的，而是研究魔法的应用。", "description": "我们考虑最简单的旅行问题吧： 现在这个大陆上有 $N$ 个城市，$M$ 条双向的道路。城市编号为 $1$ ~ $N$，我们在 $1$ 号城市，需要到 $N$ 号城市，怎样才能最快地到达呢？\n\n这不就是最短路问题吗？我们都知道可以用 Dijkstra、Bellman-Ford、Floyd-Warshall等算法来解决。\n\n现在，我们一共有 $K$ 张可以使时间变慢 $50\\%$ 的 SpellCard，也就是说，在通过某条路径时，我们可以选择使用一张卡片，这样，我们通过这一条道路的时间 就可以减少到原先的一半。需要注意的是：\n\n1. 在一条道路上最多只能使用一张 SpellCard。\n2. 使用一张SpellCard 只在一条道路上起作用。\n3. 你不必使用完所有的 SpellCard。\n\n给定以上的信息，你的任务是：求出在可以使用这不超过 $K$ 张时间减速的 SpellCard 之情形下，从城市 $1$ 到城市 $N$ 最少需要多长时间。", "inputFormat": "第一行包含三个整数：$N$、$M$、$K$。\n\n接下来 $M$ 行，每行包含三个整数：$A_i$、$B_i$、$Time_i$，表示存在一条  $A_i$ 与 $B_i$ 之间的双向道路，在不使用 SpellCard 之前提下，通过它需要 $Time_i$ 的时间。", "outputFormat": "输出一个整数，表示从 $1$ 号城市到 $N$ 号城市的最小用时。", "hint": "#### 样例 1 解释\n\n在不使用 SpellCard 时，最短路为 $1 \\to 2 \\to 4$，总时间为 $10$。现在我们可以使用 $1$ 次 SpellCard，那么我们将通过 $2 \\to 4$ 这条道路的时间减半，此时总时间为 $7$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证：\n\n- $1 \\leq K \\leq N \\leq 50$，$M \\leq 10^3$。\n- $1 \\leq A_i,B_i \\leq N$，$2 \\leq Time_i \\leq 2 \\times 10^3$。\n- 为保证答案为整数，保证所有的 $Time_i$ 均为偶数。\n- 所有数据中的无向图保证无自环、重边，且是连通的。", "locale": "zh-CN"}}}
{"pid": "P4823", "type": "P", "difficulty": 5, "samples": [["2\n20 10\n5 5\n30", "2"], ["2\n20 10\n5 5\n35", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2013", "各省省选", "排序", "背包 DP", "天津"], "title": "[TJOI2013] 拯救小矮人", "background": "", "description": "一群小矮人掉进了一个很深的陷阱里，由于太矮爬不上来，于是他们决定搭一个人梯。即：一个小矮人站在另一小矮人的 肩膀上，直到最顶端的小矮人伸直胳膊可以碰到陷阱口。\n\n对于每一个小矮人，我们知道他从脚到肩膀的高度 $A_i$，并且他的胳膊长度为 $B_i$。陷阱深度为 $H$。\n\n如果我们利用矮人 $1$，矮人 $2$，矮人 $3$，……，矮人 $k$ 搭一个梯子，满足 $A_1+A_2+A_3+\\dots+A_k+B_k \\geq H$，那么矮人 $k$ 就可以离开陷阱逃跑了，一旦一个矮人逃跑了，他就不能再搭人梯了。  \n\n我们希望尽可能多的小矮人逃跑，问最多可以使多少个小矮人逃跑。", "inputFormat": "第一行一个整数 $N$，表示矮人的个数，接下来 $N$ 行每一行两个整数 $A_i$ 和 $B_i$，最后一行是 $H$。", "outputFormat": "一个整数表示最多可以逃跑多少小矮人。", "hint": "对于 $30\\%$ 的数据，$N\\leq 200$；  \n\n对于 $100\\%$ 的数据，$1 \\leq N\\leq 2000$，$1 \\leq A_i,B_i,H\\leq10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2013] Saving the Dwarfs", "background": "", "description": "A group of dwarfs fell into a very deep pit. Because they are too short to climb out, they decide to build a human ladder. That is, one dwarf stands on another dwarf’s shoulders, until the dwarf at the top can touch the edge of the pit with his arms fully stretched.\n\nFor each dwarf, we know his height from feet to shoulders $A_i$, and his arm length $B_i$. The pit depth is $H$.\n\nIf we use dwarf $1$, dwarf $2$, dwarf $3$, $\\dots$, dwarf $k$ to build a ladder that satisfies $A_1+A_2+A_3+\\dots+A_k+B_k \\geq H$, then dwarf $k$ can leave the pit and escape. Once a dwarf escapes, he cannot be used to build the human ladder anymore.\n\nWe want as many dwarfs as possible to escape. Find the maximum number of dwarfs that can escape.", "inputFormat": "The first line contains an integer $N$, the number of dwarfs. The next $N$ lines each contain two integers $A_i$ and $B_i$. The last line contains $H$.", "outputFormat": "Output one integer, the maximum number of dwarfs that can escape.", "hint": "For $30\\%$ of the testdata, $N\\leq 200$.\n\nFor $100\\%$ of the testdata, $1 \\leq N\\leq 2000$, $1 \\leq A_i,B_i,H\\leq10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2013] 拯救小矮人", "background": "", "description": "一群小矮人掉进了一个很深的陷阱里，由于太矮爬不上来，于是他们决定搭一个人梯。即：一个小矮人站在另一小矮人的 肩膀上，直到最顶端的小矮人伸直胳膊可以碰到陷阱口。\n\n对于每一个小矮人，我们知道他从脚到肩膀的高度 $A_i$，并且他的胳膊长度为 $B_i$。陷阱深度为 $H$。\n\n如果我们利用矮人 $1$，矮人 $2$，矮人 $3$，……，矮人 $k$ 搭一个梯子，满足 $A_1+A_2+A_3+\\dots+A_k+B_k \\geq H$，那么矮人 $k$ 就可以离开陷阱逃跑了，一旦一个矮人逃跑了，他就不能再搭人梯了。  \n\n我们希望尽可能多的小矮人逃跑，问最多可以使多少个小矮人逃跑。", "inputFormat": "第一行一个整数 $N$，表示矮人的个数，接下来 $N$ 行每一行两个整数 $A_i$ 和 $B_i$，最后一行是 $H$。", "outputFormat": "一个整数表示最多可以逃跑多少小矮人。", "hint": "对于 $30\\%$ 的数据，$N\\leq 200$；  \n\n对于 $100\\%$ 的数据，$1 \\leq N\\leq 2000$，$1 \\leq A_i,B_i,H\\leq10^5$。", "locale": "zh-CN"}}}
{"pid": "P4824", "type": "P", "difficulty": 5, "samples": [["whatthemomooofun\nmoo", "whatthefun"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2015", "线段树", "USACO", "哈希 hashing", "栈", "AC 自动机", "KMP 算法"], "title": "[USACO15FEB] Censoring S", "background": "", "description": "Farmer John has purchased a subscription to Good Hooveskeeping magazine for his cows, so they have plenty of material to read while waiting around in the barn during milking sessions. Unfortunately, the latest issue contains a rather inappropriate article on how to cook the perfect steak, which FJ would rather his cows not see (clearly, the magazine is in need of better editorial oversight).\n\nFJ has taken all of the text from the magazine to create the string $S$ of length at most 10^6 characters. From this, he would like to remove occurrences of a substring $T$ to censor the inappropriate content. To do this, Farmer John finds the **_first_** occurrence of $T$ in $S$ and deletes it. He then repeats the process again, deleting the first occurrence of $T$ again, continuing until there are no more occurrences of $T$ in $S$. Note that the deletion of one occurrence might create a new occurrence of $T$ that didn't exist before.\n\nPlease help FJ determine the final contents of $S$ after censoring is complete.", "inputFormat": "The first line will contain $S$. The second line will contain $T$. The length of $T$ will be at most that of $S$, and all characters of $S$ and $T$ will be lower-case alphabet characters (in the range a..z). ", "outputFormat": "The string $S$ after all deletions are complete. It is guaranteed that $S$ will not become empty during the deletion process. ", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15FEB] Censoring S", "background": "", "description": "Farmer John has purchased a subscription to Good Hooveskeeping magazine for his cows, so they have plenty of material to read while waiting around in the barn during milking sessions. Unfortunately, the latest issue contains a rather inappropriate article on how to cook the perfect steak, which FJ would rather his cows not see (clearly, the magazine is in need of better editorial oversight).\n\nFJ has taken all of the text from the magazine to create the string $S$ of length at most 10^6 characters. From this, he would like to remove occurrences of a substring $T$ to censor the inappropriate content. To do this, Farmer John finds the **_first_** occurrence of $T$ in $S$ and deletes it. He then repeats the process again, deleting the first occurrence of $T$ again, continuing until there are no more occurrences of $T$ in $S$. Note that the deletion of one occurrence might create a new occurrence of $T$ that didn't exist before.\n\nPlease help FJ determine the final contents of $S$ after censoring is complete.", "inputFormat": "The first line will contain $S$. The second line will contain $T$. The length of $T$ will be at most that of $S$, and all characters of $S$ and $T$ will be lower-case alphabet characters (in the range a..z). ", "outputFormat": "The string $S$ after all deletions are complete. It is guaranteed that $S$ will not become empty during the deletion process. ", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Censoring S", "background": "", "description": "Farmer John 为他的奶牛订阅了《Good Hooveskeeping》杂志，但最新一期包含了一篇不恰当的牛排烹饪文章。为此，FJ 需要将杂志文字组成的字符串 $S$（长度不超过 $10^6$）中所有出现的子串 $T$ 进行删除处理。\n\n删除规则如下：反复找到当前 $S$ 中第一个出现的子串 $T$ 并删除，直到 $S$ 中不再包含 $T$。注意，删除操作可能产生新的 $T$ 子串。\n\n请输出最终处理完成的字符串 $S$。", "inputFormat": "第一行输入字符串 $S$。  \n第二行输入字符串 $T$。  \n保证 $T$ 的长度不超过 $S$，且 $S$ 和 $T$ 均由小写字母组成。删除过程中保证 $S$ 不会变为空。", "outputFormat": "输出处理完成后的字符串 $S$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4825", "type": "P", "difficulty": 3, "samples": [["4 4 4\n1 1 1 1\n1 3 2 1\n1 2 4 1\n1 1 1 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "枚举", "前缀和"], "title": "[USACO15FEB] Cow Hopscotch S", "background": "", "description": "Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play. Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.\n\nThe game is played on an $R$ by $C$ grid $(2 <= R <= 100,$ $2 <= C <= 100)$, where each square is labeled with an integer in the range $1...K (1 <= K <= R * C)$. Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if:\n\n1. You are jumping to a square labeled with a different integer than your current square,\n\n2. The square that you are jumping to is at least one row below the current square that you are on, and\n\n3. The square that you are jumping to is at least one column to the right of the current square that you are on.\n\nPlease help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.", "inputFormat": "The first line contains the integers $R, C,$ and $K$. The next $R$ lines will each contain $C$ integers, each in the range $1..K$.", "outputFormat": "Output the number of different ways one can jump from the top-left square to the bottom-right square, mod $1000000007$. ", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15FEB] Cow Hopscotch S", "background": "", "description": "Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play. Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.\n\nThe game is played on an $R$ by $C$ grid $(2 <= R <= 100,$ $2 <= C <= 100)$, where each square is labeled with an integer in the range $1...K (1 <= K <= R * C)$. Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if:\n\n1. You are jumping to a square labeled with a different integer than your current square,\n\n2. The square that you are jumping to is at least one row below the current square that you are on, and\n\n3. The square that you are jumping to is at least one column to the right of the current square that you are on.\n\nPlease help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.", "inputFormat": "The first line contains the integers $R, C,$ and $K$. The next $R$ lines will each contain $C$ integers, each in the range $1..K$.", "outputFormat": "Output the number of different ways one can jump from the top-left square to the bottom-right square, mod $1000000007$. ", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Cow Hopscotch S", "background": "", "description": "与人类喜欢玩跳格子游戏类似，Farmer John 的奶牛们也发明了自己的版本。游戏在一个 $R \\times C$ 的网格上进行（$2 \\leq R,C \\leq 100$），每个格子标有 $1 \\ldots K$ 的整数（$1 \\leq K \\leq R \\times C$）。奶牛从左上角出发，通过一系列有效跳跃到达右下角。跳跃被定义为有效当且仅当满足以下条件：\n\n1. 目标格子与当前格子的数字不同  \n2. 目标格子位于当前格子下方至少一行  \n3. 目标格子位于当前格子右侧至少一列  \n\n请计算从左上角到右下角的不同有效跳跃路径总数。", "inputFormat": "第一行包含三个整数 $R$, $C$, $K$。  \n接下来 $R$ 行每行包含 $C$ 个整数，每个数在 $1 \\ldots K$ 范围内。", "outputFormat": "输出从左上角到右下角的不同路径数量，结果对 $1000000007$ 取模。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4826", "type": "P", "difficulty": 3, "samples": [["4\n3\n6\n9\n10", "37"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "图论建模", "生成树"], "title": "[USACO15FEB] Superbull S", "background": "", "description": "Bessie and her friends are playing hoofball in the annual Superbull championship, and Farmer John is in charge of making the tournament as exciting as possible. A total of $N$ $(1 <= N <= 2000)$ teams are playing in the Superbull. Each team is assigned a distinct integer team ID in the range 1...2^30-1 to distinguish it from the other teams. The Superbull is an elimination tournament -- after every game, Farmer John chooses which team to eliminate from the Superbull, and the eliminated team can no longer play in any more games. The Superbull ends when only one team remains.\n\nFarmer John notices a very unusual property about the scores in matches! In any game, the combined score of the two teams always ends up being the bitwise exclusive OR (XOR) of the two team IDs. For example, if teams 12 and 20 were to play, then 24 points would be scored in that game, since 01100 XOR 10100 = 11000.\n\nFarmer John believes that the more points are scored in a game, the more exciting the game is. Because of this, he wants to choose a series of games to be played such that the total number of points scored in the Superbull is maximized. Please help Farmer John organize the matches.", "inputFormat": "The first line contains the single integer $N$. The following $N$ lines contain the N team IDs.", "outputFormat": "Output the maximum possible number of points that can be scored in the Superbull.", "hint": "OUTPUT DETAILS: One way to achieve 37 is as follows: FJ matches teams 3 and 9, and decides that 9 wins, so teams 6, 9, and 10 are left in the tournament. He then matches teams 6 and 9, and lets team 6 win. Teams 6 and 10 are then left in the tournament. Finally, teams 6 and 10 face off, and team 10 wins. The total number of points scored is (3 XOR 9) + (6 XOR 9) + (6 XOR 10) = 10 + 15 + 12 = 37.\n\nNOTE: The bitwise exclusive OR operation, commonly denoted by the ^ symbol, is a bitwise operation that performs the logical exclusive OR operation on each position in two binary integers. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but is 0 if both bits are 0 or both are 1. For example: 10100 (decimal 20) XOR 01100 (decimal 12) = 11000 (decimal 24)\n\n[Problem credits: Alex Yang, 2015] ", "locale": "en", "translations": {"en": {"title": "[USACO15FEB] Superbull S", "background": "", "description": "Bessie and her friends are playing hoofball in the annual Superbull championship, and Farmer John is in charge of making the tournament as exciting as possible. A total of $N$ $(1 <= N <= 2000)$ teams are playing in the Superbull. Each team is assigned a distinct integer team ID in the range 1...2^30-1 to distinguish it from the other teams. The Superbull is an elimination tournament -- after every game, Farmer John chooses which team to eliminate from the Superbull, and the eliminated team can no longer play in any more games. The Superbull ends when only one team remains.\n\nFarmer John notices a very unusual property about the scores in matches! In any game, the combined score of the two teams always ends up being the bitwise exclusive OR (XOR) of the two team IDs. For example, if teams 12 and 20 were to play, then 24 points would be scored in that game, since 01100 XOR 10100 = 11000.\n\nFarmer John believes that the more points are scored in a game, the more exciting the game is. Because of this, he wants to choose a series of games to be played such that the total number of points scored in the Superbull is maximized. Please help Farmer John organize the matches.", "inputFormat": "The first line contains the single integer $N$. The following $N$ lines contain the N team IDs.", "outputFormat": "Output the maximum possible number of points that can be scored in the Superbull.", "hint": "OUTPUT DETAILS: One way to achieve 37 is as follows: FJ matches teams 3 and 9, and decides that 9 wins, so teams 6, 9, and 10 are left in the tournament. He then matches teams 6 and 9, and lets team 6 win. Teams 6 and 10 are then left in the tournament. Finally, teams 6 and 10 face off, and team 10 wins. The total number of points scored is (3 XOR 9) + (6 XOR 9) + (6 XOR 10) = 10 + 15 + 12 = 37.\n\nNOTE: The bitwise exclusive OR operation, commonly denoted by the ^ symbol, is a bitwise operation that performs the logical exclusive OR operation on each position in two binary integers. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but is 0 if both bits are 0 or both are 1. For example: 10100 (decimal 20) XOR 01100 (decimal 12) = 11000 (decimal 24)\n\n[Problem credits: Alex Yang, 2015] ", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Superbull S", "background": null, "description": "Bessie 和她的朋友们正在一年一度的 Superbull 锦标赛中比赛，Farmer John 负责让比赛尽可能精彩。总共有 $N$ $(1 \\leq N \\leq 2000)$ 支队伍参加 Superbull。每支队伍都被分配了一个唯一的整数队伍 ID，范围在 $1 \\ldots 2^{30}-1$ 之间，用于区分不同队伍。Superbull 是淘汰制比赛——每场比赛后，Farmer John 会选择淘汰其中一支队伍，被淘汰的队伍将不再参与后续比赛。当只剩一支队伍时，Superbull 结束。\n\nFarmer John 发现比赛得分有一个特殊性质：任意一场比赛中，两支队伍的得分总和总是等于两队 ID 的按位异或（XOR）。例如，若队伍 12 和 20 比赛，则该场比赛总得分为 $24$，因为 $01100 \\oplus 10100 = 11000$（即 $12 \\oplus 20 = 24$）。\n\nFarmer John 认为比赛总得分越高越精彩。因此，他希望安排一系列比赛，使得 Superbull 所有比赛的总得分最大化。请帮助他设计比赛方案。", "inputFormat": "第一行包含整数 $N$。接下来的 $N$ 行每行包含一个队伍 ID。", "outputFormat": "输出 Superbull 所有比赛可能获得的最大总得分。", "hint": "**输出样例解释**：  \n一种获得 37 分的方案如下：  \n1. Farmer John 让队伍 3 和 9 比赛，选择淘汰 3，此时剩余队伍为 6、9、10  \n2. 让队伍 6 和 9 比赛，选择淘汰 9，此时剩余队伍为 6 和 10  \n3. 最后让队伍 6 和 10 比赛  \n总得分为 $(3 \\oplus 9) + (6 \\oplus 9) + (6 \\oplus 10) = 10 + 15 + 12 = 37$。\n\n**关于按位异或**：  \n按位异或运算（记作 $\\oplus$）对两个二进制数的每一位进行逻辑异或操作。当且仅当某一位上两个数不同时，结果的该位为 1。例如：  \n$10100$（十进制 20）$\\oplus$ $01100$（十进制 12）$= 11000$（十进制 24）", "locale": "zh-CN"}}}
{"pid": "P4827", "type": "P", "difficulty": 7, "samples": [["5 2\n1 2\n1 3\n2 4\n2 5\n", "10\n7\n23\n18\n18\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "2011", "集训队互测", "组合数学", "二项式定理", "容斥原理", "Stirling 数"], "title": "[集训队互测 2011] Crash 的文明世界", "background": "", "description": "Crash 小朋友最近迷上了一款游戏——文明5 (Civilization V)。在这个游戏中，玩家可以建立和发展自己的国家，通过外交和别的国家交流，或是通过战争征服别的国家。\n\n现在 Crash 已经拥有了一个 $n$ 个城市的国家，这些城市之间通过道路相连。由于建设道路是有花费的，因此 Crash 只修建了 $n-1$ 条道路连接这些城市，不过可以保证任意两个城市都有路径相通。\n\n在游戏中，Crash 需要选择一个城市作为他的国家的首都，选择首都需要考虑很多指标，有一个指标是这样的：\n\n$$S(i) = \\sum_{j = 1}^{n}{\\rm dist}(i, j) ^ k$$\n\n其中 $S(i)$ 表示第 $i$ 个城市的指标值，${\\rm dist}(i, j)$ 表示第 $i$ 个城市到第 $j$ 个城市需要经过的道路条数的最小值，$k$ 为一个常数且为正整数。\n\n因此 Crash 交给你一个简单的任务：给出城市之间的道路，对于每个城市，输出这个城市的指标值，由于指标值可能会很大，所以你只需要输出这个数 $\\bmod\\ 10007$ 的值。", "inputFormat": "输入的第一行包括两个正整数 $n$ 和 $k$。\n\n接下来有 $n-1$ 行，每行两个正整数 $u, v$（$1\\le u, v\\le n$），表示第 $u$ 个城市和第 $v$ 个城市之间有道路相连。这些道路保证能符合题目的要求。", "outputFormat": "输出共 $n$ 行，每行一个正整数，第 $i$ 行的正整数表示第 $i$ 个城市的指标值 $\\bmod\\ 10007$ 的值。", "hint": "对于 $20 \\%$ 的数据，$n\\le 5000$，$k\\le 30$。\n\n对于 $50 \\%$ 的数据，$n\\le 5\\times 10^4$，$k\\le 30$。\n\n对于 $100 \\%$ 的数据，$1\\le n\\le 5\\times 10^4$，$1\\le k\\le 150$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTT Mutual Test 2011] Crash’s Civilization World", "background": "", "description": "Crash has recently become obsessed with a game called Civilization V. In this game, players can build and develop their own countries, communicate with other countries through diplomacy, or conquer them through war.\n\nNow Crash already owns a country with $n$ cities. These cities are connected by roads. Since building roads costs money, Crash only built $n-1$ roads to connect these cities, but it is guaranteed that there is a path between any two cities.\n\nIn the game, Crash needs to choose one city as the capital of his country. Choosing the capital requires considering many indicators, and one of them is:\n\n$$S(i) = \\sum_{j = 1}^{n}{\\rm dist}(i, j) ^ k$$\n\nHere, $S(i)$ denotes the indicator value of the $i$-th city, ${\\rm dist}(i, j)$ is the minimum number of roads that must be traveled from city $i$ to city $j$, and $k$ is a constant positive integer.\n\nSo Crash gives you a simple task: given the roads between the cities, for each city output its indicator value. Since the value may be very large, you only need to output it $\\bmod\\ 10007$.", "inputFormat": "The first line contains two positive integers $n$ and $k$.\n\nThen there are $n-1$ lines. Each line contains two positive integers $u, v$ ($1\\le u, v\\le n$), indicating that there is a road connecting city $u$ and city $v$. These roads are guaranteed to satisfy the requirements of the problem.", "outputFormat": "Output $n$ lines in total, each with one positive integer. The integer on the $i$-th line represents the indicator value of the $i$-th city $\\bmod\\ 10007$.", "hint": "For $20\\%$ of the testdata, $n\\le 5000$, $k\\le 30$.\n\nFor $50\\%$ of the testdata, $n\\le 5\\times 10^4$, $k\\le 30$.\n\nFor $100\\%$ of the testdata, $1\\le n\\le 5\\times 10^4$, $1\\le k\\le 150$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[集训队互测 2011] Crash 的文明世界", "background": "", "description": "Crash 小朋友最近迷上了一款游戏——文明5 (Civilization V)。在这个游戏中，玩家可以建立和发展自己的国家，通过外交和别的国家交流，或是通过战争征服别的国家。\n\n现在 Crash 已经拥有了一个 $n$ 个城市的国家，这些城市之间通过道路相连。由于建设道路是有花费的，因此 Crash 只修建了 $n-1$ 条道路连接这些城市，不过可以保证任意两个城市都有路径相通。\n\n在游戏中，Crash 需要选择一个城市作为他的国家的首都，选择首都需要考虑很多指标，有一个指标是这样的：\n\n$$S(i) = \\sum_{j = 1}^{n}{\\rm dist}(i, j) ^ k$$\n\n其中 $S(i)$ 表示第 $i$ 个城市的指标值，${\\rm dist}(i, j)$ 表示第 $i$ 个城市到第 $j$ 个城市需要经过的道路条数的最小值，$k$ 为一个常数且为正整数。\n\n因此 Crash 交给你一个简单的任务：给出城市之间的道路，对于每个城市，输出这个城市的指标值，由于指标值可能会很大，所以你只需要输出这个数 $\\bmod\\ 10007$ 的值。", "inputFormat": "输入的第一行包括两个正整数 $n$ 和 $k$。\n\n接下来有 $n-1$ 行，每行两个正整数 $u, v$（$1\\le u, v\\le n$），表示第 $u$ 个城市和第 $v$ 个城市之间有道路相连。这些道路保证能符合题目的要求。", "outputFormat": "输出共 $n$ 行，每行一个正整数，第 $i$ 行的正整数表示第 $i$ 个城市的指标值 $\\bmod\\ 10007$ 的值。", "hint": "对于 $20 \\%$ 的数据，$n\\le 5000$，$k\\le 30$。\n\n对于 $50 \\%$ 的数据，$n\\le 5\\times 10^4$，$k\\le 30$。\n\n对于 $100 \\%$ 的数据，$1\\le n\\le 5\\times 10^4$，$1\\le k\\le 150$。", "locale": "zh-CN"}}}
{"pid": "P4828", "type": "P", "difficulty": 5, "samples": [["5\n1 2 3 4 5\n2\n1 2\n2 2", "5\n12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "数学", "洛谷月赛"], "title": "Nagisa loves Tomoya", "background": "", "description": "可爱的古河渚得到了一个序列。她定义一次操作为 将所有的 $a_i$ 变为 $a_i+a_{(i\\ mod \\ n+1)}$ \n然后她会向你进行 $Q$ 次询问，每次问你 $x,y$ ,意义为在第 $x$ 次操作后位置 $y $ 的元素是多少。\n\n这个问题太简单了，我们的 Nagisa 轻易地就解决了这个问题。请问您能解决这个问题吗？\n", "inputFormat": "一个整数 $n$，表示序列的长度。\n\n接下来一行 $n$ 个整数，表示这个序列。\n\n\n接下来一行一个整数 $Q$，表示询问次数\n\n接下来 $Q$ 行，每行两个整数 $x,y$，意义如题所示。", "outputFormat": "共 $Q$ 行，每行一个整数表示询问的答案，请注意对 $998244353$ 取模。", "hint": "对于$30 \\%$的数据，满足：\n$1 \\leq n \\leq 100$\n\n$1 \\leq x \\leq 100$\n\n$1 \\leq Q \\leq 100$\n\n对于 $50\\%$ 的数据：\n\n$1\\leq n \\leq 100000$\n\n$1 \\leq x \\leq 500$\n\n$1 \\leq Q \\leq 100$\n\n对于 $100 \\%$ 的数据，满足\n\n$1 \\leq n \\leq 10^6$\n\n$1 \\leq a_i \\leq 10^9$\n\n$1 \\leq x \\leq 2000$\n\n$1 \\leq Q \\leq 10^4$", "locale": "zh-CN", "translations": {"en": {"title": "Nagisa loves Tomoya", "background": "", "description": "Cute Furukawa Nagisa gets a sequence. She defines one operation as changing all $a_i$ to $a_i + a_{(i\\ mod\\ n + 1)}$. Then she will ask you $Q$ queries. Each query gives $x, y$, meaning: after the $x$-th operation, what is the value of the element at position $y$.\n\nThis problem is too easy, and our Nagisa solved it effortlessly. Can you solve it too?", "inputFormat": "An integer $n$, representing the length of the sequence.\n\nThe next line contains $n$ integers, representing this sequence.\n\nThe next line contains an integer $Q$, representing the number of queries.\n\nThe next $Q$ lines each contain two integers $x, y$, with the meaning as described in the statement.", "outputFormat": "Output $Q$ lines. Each line contains one integer, the answer to the query. Please output the result modulo $998244353$.", "hint": "For $30\\%$ of the testdata, it holds that:\n\n$1 \\leq n \\leq 100$\n\n$1 \\leq x \\leq 100$\n\n$1 \\leq Q \\leq 100$\n\nFor $50\\%$ of the testdata:\n\n$1 \\leq n \\leq 100000$\n\n$1 \\leq x \\leq 500$\n\n$1 \\leq Q \\leq 100$\n\nFor $100\\%$ of the testdata, it holds that:\n\n$1 \\leq n \\leq 10^6$\n\n$1 \\leq a_i \\leq 10^9$\n\n$1 \\leq x \\leq 2000$\n\n$1 \\leq Q \\leq 10^4$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Nagisa loves Tomoya", "background": "", "description": "可爱的古河渚得到了一个序列。她定义一次操作为 将所有的 $a_i$ 变为 $a_i+a_{(i\\ mod \\ n+1)}$ \n然后她会向你进行 $Q$ 次询问，每次问你 $x,y$ ,意义为在第 $x$ 次操作后位置 $y $ 的元素是多少。\n\n这个问题太简单了，我们的 Nagisa 轻易地就解决了这个问题。请问您能解决这个问题吗？\n", "inputFormat": "一个整数 $n$，表示序列的长度。\n\n接下来一行 $n$ 个整数，表示这个序列。\n\n\n接下来一行一个整数 $Q$，表示询问次数\n\n接下来 $Q$ 行，每行两个整数 $x,y$，意义如题所示。", "outputFormat": "共 $Q$ 行，每行一个整数表示询问的答案，请注意对 $998244353$ 取模。", "hint": "对于$30 \\%$的数据，满足：\n$1 \\leq n \\leq 100$\n\n$1 \\leq x \\leq 100$\n\n$1 \\leq Q \\leq 100$\n\n对于 $50\\%$ 的数据：\n\n$1\\leq n \\leq 100000$\n\n$1 \\leq x \\leq 500$\n\n$1 \\leq Q \\leq 100$\n\n对于 $100 \\%$ 的数据，满足\n\n$1 \\leq n \\leq 10^6$\n\n$1 \\leq a_i \\leq 10^9$\n\n$1 \\leq x \\leq 2000$\n\n$1 \\leq Q \\leq 10^4$", "locale": "zh-CN"}}}
{"pid": "P4829", "type": "P", "difficulty": 5, "samples": [["5 10 233", "24"], ["5 50 3", "48"], ["1000 1000 666", "374784"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["排序", "队列", "洛谷月赛"], "title": "kry loves 2048", "background": "kls是一个人赢。", "description": "kls最近在玩一款类似2048的游戏，规则是这样的：\n\n一开始，有$n$个方块，每个方块上有一个$1$到$m$的整数。\n\nkls可以进行两种操作：\n\n1. 选择两个数字相同的方块（不一定要相邻），将它们合并成一个数字为原来的两倍的方块；\n\n2. 减小一个方块上的数字。\n\n操作的次数没有限制，最终的得分为所有方块上的最大的数字。\n\n因为kls要去陪妹子了，没有时间继续玩，他想让你帮忙计算一下，最多能得到多少分。", "inputFormat": "因为数据可能很大，读入容易超时，所以kls给你们提供了一个c++的随机数生成器。\n\n```cpp\nvoid generate_array(int a[], int n, int m, int seed) {\n    unsigned x = seed;\n    for (int i = 0; i < n; ++i) {\n        x ^= x << 13;\n        x ^= x >> 17;\n        x ^= x << 5;\n        a[i] = x % m + 1;\n    }\n}\n```\n\n把这个函数复制到你的程序里。用一个足够大的数组，以及输入数据给出的$n$，$m$和$seed$作为参数，调用这个函数。然后这个数组里就是一开始的方块上的数字（下标从0开始）。\n\n输入一行三个数$n,m,seed$，含义如上。", "outputFormat": "一行一个数，表示最大得分。", "hint": "### 样例解释\n\n样例1生成出来的数是 6 10 7 5 4。\n\n样例2生成出来的数是 8 12 48 4 4。\n\n### 数据范围\n\n对于30%的数据，$n, m \\le 10$；\n\n对于60%的数据，$n, m \\le 10^5$；\n\n对于100%的数据，$n, m \\le 10^7$，$1 \\le seed \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "kry loves 2048", "background": "kls is a person who always wins.", "description": "kls has recently been playing a game similar to 2048. The rules are as follows.\n\nAt the beginning, there are $n$ blocks, and each block has an integer from $1$ to $m$ written on it.\n\nkls can perform two kinds of operations.\n\n1. Choose two blocks with the same number (they do not have to be adjacent) and merge them into one block whose number is twice the original.\n2. Decrease the number on a block.\n\nThere is no limit on the number of operations. The final score is the maximum number among all blocks.\n\nSince kls is going to spend time with a girl and has no time to keep playing, he wants you to help him compute the maximum score he can get.", "inputFormat": "Because the testdata may be large and direct input may easily time out, kls provides you with a C++ random number generator.\n\n```cpp\nvoid generate_array(int a[], int n, int m, int seed) {\n    unsigned x = seed;\n    for (int i = 0; i < n; ++i) {\n        x ^= x << 13;\n        x ^= x >> 17;\n        x ^= x << 5;\n        a[i] = x % m + 1;\n    }\n}\n```\n\nCopy this function into your program. Use a sufficiently large array, and call this function with $n$, $m$, and $seed$ given in the input as parameters. Then the numbers in this array are the initial numbers on the blocks (the index starts from 0).\n\nInput one line with three numbers $n, m, seed$, with meanings as above.", "outputFormat": "Output one line with one number, representing the maximum score.", "hint": "### Sample Explanation\n\nThe numbers generated in sample 1 are 6 10 7 5 4.\n\nThe numbers generated in sample 2 are 8 12 48 4 4.\n\n### Constraints\n\nFor 30% of the testdata, $n, m \\le 10$.\n\nFor 60% of the testdata, $n, m \\le 10^5$.\n\nFor 100% of the testdata, $n, m \\le 10^7$, $1 \\le seed \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "kry loves 2048", "background": "kls是一个人赢。", "description": "kls最近在玩一款类似2048的游戏，规则是这样的：\n\n一开始，有$n$个方块，每个方块上有一个$1$到$m$的整数。\n\nkls可以进行两种操作：\n\n1. 选择两个数字相同的方块（不一定要相邻），将它们合并成一个数字为原来的两倍的方块；\n\n2. 减小一个方块上的数字。\n\n操作的次数没有限制，最终的得分为所有方块上的最大的数字。\n\n因为kls要去陪妹子了，没有时间继续玩，他想让你帮忙计算一下，最多能得到多少分。", "inputFormat": "因为数据可能很大，读入容易超时，所以kls给你们提供了一个c++的随机数生成器。\n\n```cpp\nvoid generate_array(int a[], int n, int m, int seed) {\n    unsigned x = seed;\n    for (int i = 0; i < n; ++i) {\n        x ^= x << 13;\n        x ^= x >> 17;\n        x ^= x << 5;\n        a[i] = x % m + 1;\n    }\n}\n```\n\n把这个函数复制到你的程序里。用一个足够大的数组，以及输入数据给出的$n$，$m$和$seed$作为参数，调用这个函数。然后这个数组里就是一开始的方块上的数字（下标从0开始）。\n\n输入一行三个数$n,m,seed$，含义如上。", "outputFormat": "一行一个数，表示最大得分。", "hint": "### 样例解释\n\n样例1生成出来的数是 6 10 7 5 4。\n\n样例2生成出来的数是 8 12 48 4 4。\n\n### 数据范围\n\n对于30%的数据，$n, m \\le 10$；\n\n对于60%的数据，$n, m \\le 10^5$；\n\n对于100%的数据，$n, m \\le 10^7$，$1 \\le seed \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4830", "type": "P", "difficulty": 5, "samples": [["3 1", "666666672"], ["3 0", "333333336"], ["4 1", "750000006"], ["4 2", "625000005"], ["100000 99998", "439903656"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "贪心", "洛谷月赛"], "title": "选择题", "background": "", "description": "docriz 正在考试，他遇到了一个奇怪的选择题：这个选择题共有 $n$ 个选项，其中只有一个选项是正确的。他完全不会做这题，所以只能靠蒙。\n\n蒙这道题分为 $n - 2$ 轮，在第 $1$ 轮开始之前，docriz 会在这 $n$ 个选项中随机蒙一项，之后的每轮流程如下：首先，nocriz 会过来帮他排除一个选项，由于 nocriz 事先知道答案，所以他会在现有的除正确的那一项和 docirz 正在选的那一项外的选项里，随机删去一个。之后，docriz 可以选择是否更换自己蒙的选项，如果更换，则随机更换到除正在选的那一项之外的任意一项。\n\ndocriz 在这 $n - 2$ 轮中，由于和 nocriz 达成的神秘协定，需要恰好更换 $k$ 次选项。他想知道，如何更换，使得自己蒙对的概率最大，输出这个概率。为了方便，你需要输出这个概率的分数形式在模 $10^9 + 7$ 意义下的结果。", "inputFormat": "一行两个整数 $n, k$，意义如上所述。", "outputFormat": "一行一个数，表示答案。", "hint": "样例 $1$ 到 $4$ 分别为 $\\frac{2}{3}, \\frac{1}{3}, \\frac{3}{4}, \\frac{5}{8}$。\n\n对于 $30\\%$ 的数据，保证 $5 \\leq n \\leq 10$。\n\n对于另外 $5\\%$ 的数据，保证 $k = 0$。\n\n对于另外 $10\\%$ 的数据，保证 $k = 1$。\n\n对于另外 $10\\%$ 的数据，保证 $k = n - 2$。\n\n对于另外 $5\\%$ 的数据，保证 $n \\leq 10^2$。\n\n对于另外 $10\\%$ 的数据，保证 $n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，保证 $5 \\leq n \\leq 10^5, 0 \\leq k \\leq n - 2$。", "locale": "zh-CN", "translations": {"en": {"title": "Multiple-choice Question.", "background": "", "description": "docriz is taking an exam, and he encounters a strange multiple-choice question: there are $n$ options in total, and only one option is correct. He cannot solve it at all, so he can only guess.\n\nGuessing this question consists of $n - 2$ rounds. Before round $1$ starts, docriz randomly guesses one of the $n$ options. Then, in each following round, the process is as follows: first, nocriz comes to help him eliminate one option. Since nocriz knows the answer in advance, he will randomly delete one option among the current options, excluding the correct option and the option that docriz is currently choosing. After that, docriz may choose whether to switch his guessed option. If he switches, he randomly switches to any option other than the one he is currently choosing.\n\nDuring these $n - 2$ rounds, due to a mysterious agreement with nocriz, docriz must switch options exactly $k$ times. He wants to know how to switch so that the probability of guessing correctly is maximized, and you should output this probability. For convenience, you need to output the result of this probability in fractional form modulo $10^9 + 7$.", "inputFormat": "One line with two integers $n, k$, with the meanings as described above.", "outputFormat": "One line with one number, representing the answer.", "hint": "Samples $1$ to $4$ are $\\frac{2}{3}, \\frac{1}{3}, \\frac{3}{4}, \\frac{5}{8}$, respectively.\n\nFor $30\\%$ of the testdata, it is guaranteed that $5 \\leq n \\leq 10$.\n\nFor another $5\\%$ of the testdata, it is guaranteed that $k = 0$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that $k = 1$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that $k = n - 2$.\n\nFor another $5\\%$ of the testdata, it is guaranteed that $n \\leq 10^2$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that $n \\leq 10^3$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $5 \\leq n \\leq 10^5, 0 \\leq k \\leq n - 2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "选择题", "background": "", "description": "docriz 正在考试，他遇到了一个奇怪的选择题：这个选择题共有 $n$ 个选项，其中只有一个选项是正确的。他完全不会做这题，所以只能靠蒙。\n\n蒙这道题分为 $n - 2$ 轮，在第 $1$ 轮开始之前，docriz 会在这 $n$ 个选项中随机蒙一项，之后的每轮流程如下：首先，nocriz 会过来帮他排除一个选项，由于 nocriz 事先知道答案，所以他会在现有的除正确的那一项和 docirz 正在选的那一项外的选项里，随机删去一个。之后，docriz 可以选择是否更换自己蒙的选项，如果更换，则随机更换到除正在选的那一项之外的任意一项。\n\ndocriz 在这 $n - 2$ 轮中，由于和 nocriz 达成的神秘协定，需要恰好更换 $k$ 次选项。他想知道，如何更换，使得自己蒙对的概率最大，输出这个概率。为了方便，你需要输出这个概率的分数形式在模 $10^9 + 7$ 意义下的结果。", "inputFormat": "一行两个整数 $n, k$，意义如上所述。", "outputFormat": "一行一个数，表示答案。", "hint": "样例 $1$ 到 $4$ 分别为 $\\frac{2}{3}, \\frac{1}{3}, \\frac{3}{4}, \\frac{5}{8}$。\n\n对于 $30\\%$ 的数据，保证 $5 \\leq n \\leq 10$。\n\n对于另外 $5\\%$ 的数据，保证 $k = 0$。\n\n对于另外 $10\\%$ 的数据，保证 $k = 1$。\n\n对于另外 $10\\%$ 的数据，保证 $k = n - 2$。\n\n对于另外 $5\\%$ 的数据，保证 $n \\leq 10^2$。\n\n对于另外 $10\\%$ 的数据，保证 $n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，保证 $5 \\leq n \\leq 10^5, 0 \\leq k \\leq n - 2$。", "locale": "zh-CN"}}}
{"pid": "P4831", "type": "P", "difficulty": 6, "samples": [["4 4", "90"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["多项式", "组合数学", "容斥原理", "生成函数", "洛谷月赛"], "title": "Scarlet loves WenHuaKe", "background": "Scarlet上大学了，在此之前，她加强了一道高考模拟题QAQ", "description": "Scarlet尝试在 $n$ 行 $m$ 列的中国象棋棋盘上放置 $2\\times n$ 个炮，使得它们互不攻击。\n\n大家都知道 Scarlet 沉迷搞事，她想问你有多少个方案。", "inputFormat": "一行两个整数，分别表示 $n$ 和 $m$。", "outputFormat": "一个整数，表示方案数对 $998244353$ 取模后的值。", "hint": "对于 $20\\%$ 的数据，$n,m\\leq5$；\n\n对于另 $25\\%$ 的数据，$n,m\\leq2000$；\n\n对于另 $20\\%$ 的数据，$n=m$；\n\n对于剩下的 $35\\%$ 的数据，$m-n\\leq10$；\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq m\\leq100000$。", "locale": "zh-CN", "translations": {"en": {"title": "Scarlet Loves WenHuaKe", "background": "Scarlet has started college. Before that, she worked hard on a Gaokao mock exam problem QAQ.", "description": "Scarlet tries to place $2\\times n$ cannons on an $n$-row $m$-column Chinese chessboard such that none of them can attack each other.\n\nAs everyone knows, Scarlet loves making trouble. She wants to ask how many valid configurations there are.", "inputFormat": "One line with two integers, representing $n$ and $m$.", "outputFormat": "One integer, the number of configurations modulo $998244353$.", "hint": "For $20\\%$ of the testdata, $n,m\\leq5$.\n\nFor another $25\\%$ of the testdata, $n,m\\leq2000$.\n\nFor another $20\\%$ of the testdata, $n=m$.\n\nFor the remaining $35\\%$ of the testdata, $m-n\\leq10$.\n\nFor $100\\%$ of the testdata, $1\\leq n\\leq m\\leq100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Scarlet loves WenHuaKe", "background": "Scarlet上大学了，在此之前，她加强了一道高考模拟题QAQ", "description": "Scarlet尝试在 $n$ 行 $m$ 列的中国象棋棋盘上放置 $2\\times n$ 个炮，使得它们互不攻击。\n\n大家都知道 Scarlet 沉迷搞事，她想问你有多少个方案。", "inputFormat": "一行两个整数，分别表示 $n$ 和 $m$。", "outputFormat": "一个整数，表示方案数对 $998244353$ 取模后的值。", "hint": "对于 $20\\%$ 的数据，$n,m\\leq5$；\n\n对于另 $25\\%$ 的数据，$n,m\\leq2000$；\n\n对于另 $20\\%$ 的数据，$n=m$；\n\n对于剩下的 $35\\%$ 的数据，$m-n\\leq10$；\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq m\\leq100000$。", "locale": "zh-CN"}}}
{"pid": "P4832", "type": "P", "difficulty": 4, "samples": [["3\ns+c\ns+c+s\nc\n", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "背包 DP"], "title": "珈百璃堕落的开始", "background": "\n“恭喜你，珈百璃，你以学年首席的优秀成绩毕业。”\n\n珈百璃，一位优秀的天使，今天她以学年首席的成绩毕业，从今往后，她将前往人间进行进一步修炼。\n\n“我会努力给人类带来幸福的！”珈百璃憧憬着人间生活。\n\n开学第一天，珈百璃就凭借着她极其可爱的外表，受到了班级成员的追捧，不仅长得可爱，成绩还很优秀，简直就是女神啊！\n\n因为她的成绩优秀，所以她的作业也是很快就快要完成了，但是就在她快完成数学作业时，她的电脑传来了呼救的声音。\n\n“救命啊！”\n\n顺着这个呼救声，珈百璃望向了电脑。\n\n“原来是游戏啊。”珈百璃看着屏幕里一位倒在地上的残血战士，注册了账号，选择了牧师职业，对这位战士进行了救治。在珈百璃开心的同时，越来越多的呼救声传来，珈百璃一个一个进行救治，但她的 level 才 1，mp 肯定不足，当她想要继续进行救治的时候，系统提示 mp 不足，并给出了氪金的提示：“屠龙宝刀，点击就送。”\n\n“生活费天界学院倒是有给，但是……”珈百璃看着自己的存折，再看看屏幕，她纠结不已。\n\n“救命啊！”“救……救命啊……”“救命啊！”珈百璃看着这些人一个个喊出救命，自己却无能为力，终于，她控制不住自己，点下了“氪金”按钮。\n\n从此，珈百璃的堕落就开始了，她的作业，也停在了这道数学题上……\n\n“薇奈特，帮我写一下作业嘛。”珈百璃央求着薇奈特。\n\n“真是的，你好歹也是天使呢，也该自己做一点作业吧。”\n\n“不要，我还要打游戏呢。”\n\n“这怎么行，你是天使啊。”\n\n“我已经决定做一位成天打游戏不学习的堕天使了。”\n\n“真是服了你啊，那你好好打游戏吧，我帮你写。”\n", "description": "这道题是这样的：给定一些 $\\sin^2x$，$\\cos^2x\\ \\left(x=\\dfrac{\\pi}{7}\\right)$ 组成的式子，请你帮忙求出选择一些式子相加后得到的**最大整数答案**。", "inputFormat": "第一行一个整数 $n$，表示 $n$ 个式子\n\n接下来 $n$ 行每行一个字符串，由 $f(i)=\\sin^2x,\\cos^2x$ 和加号组成，$x=\\dfrac{\\pi}{7}$。\n\n为了简化输入，我们以 `s` 代表 $\\sin^2x$，以 `c` 代表 $\\cos^2x$，并省略 `f(i)=`。", "outputFormat": "一个数表示**最大整数答案**，计算全部为加法。\n", "hint": "### 样例解释\n\n三个式子都选，则加起来等于 $3$。\n\n### 数据范围\n\n设 `s` 和 `c` 的个数总和为 $m$。\n\n$10\\%$ 的数据 $n=1$。\n\n另外 $20\\%$ 的数据每行一个单项式。\n\n另有 $20\\%$ 的数据 $n\\le20$。\n\n$100\\%$ 的数据 $n\\times m\\le5\\times10^7,m\\le10^6$。\n\n### 提示\n\n - $\\forall x, \\sin^2x+\\cos^2x=1$。", "locale": "zh-CN", "translations": {"en": {"title": "The Beginning of Gabriel's Fall", "background": "\"Congratulations, Gabriel. You graduated as the top student of the year.\"\n\nGabriel, an excellent angel, graduated today as the valedictorian. From now on, she will go to the human world for further training.\n\n\"I will work hard to bring happiness to humans!\" Gabriel looked forward to life in the human world.\n\nOn the first day of school, thanks to her extremely cute appearance, Gabriel was adored by her classmates. Not only was she cute, but she also had excellent grades. She was practically a goddess!\n\nBecause of her excellent grades, she was about to finish her homework quickly. However, just as she was about to finish her math homework, a cry for help came from her computer.\n\n\"Help!\"\n\nFollowing the cry, Gabriel looked at the computer.\n\n\"So it was a game.\" Gabriel saw a critically wounded warrior lying on the ground on the screen. She registered an account, chose the priest class, and healed the warrior. While Gabriel felt happy, more and more cries for help came. Gabriel healed them one by one, but her level was only 1, and her MP was certainly insufficient. When she tried to continue healing, the system prompted that MP was insufficient and displayed a pay-to-win hint: \"Dragon-slaying blade, just click to get it.\"\n\n\"The Celestial Academy does give living expenses, but...\" Gabriel looked at her bankbook, then at the screen, torn.\n\n\"Help!\" \"He... help...\" \"Help!\" Gabriel watched as people cried for help one after another, yet she could do nothing. Finally, she could not hold herself back and clicked the \"pay\" button.\n\nFrom then on, Gabriel’s fall began, and her homework got stuck on this math problem...\n\n\"Vignette, help me with my homework, please,\" Gabriel pleaded.\n\n\"Honestly, you’re an angel at least. You should do some of your homework yourself.\"\n\n\"No, I still want to play games.\"\n\n\"That won’t do. You’re an angel.\"\n\n\"I’ve decided to become a fallen angel who plays games all day and doesn’t study.\"\n\n\"I give up. Fine, play your game. I’ll help you write it.\"", "description": "The problem is as follows: given some expressions composed of $\\sin^2 x$ and $\\cos^2 x$ with $x=\\dfrac{\\pi}{7}$, please find the maximum integer value you can obtain by selecting some of the expressions and summing them.", "inputFormat": "The first line contains an integer $n$, indicating $n$ expressions.\n\nEach of the next $n$ lines contains a string formed by $f(i)=\\sin^2 x$, $\\cos^2 x$ and plus signs, with $x=\\dfrac{\\pi}{7}$.\n\nTo simplify the input, we use `s` to represent $\\sin^2 x$, `c` to represent $\\cos^2 x$, and omit `f(i)=`.", "outputFormat": "Output a single number representing the maximum integer answer. All operations are addition.", "hint": "Sample Explanation:\n- If you pick all three expressions, their sum equals $3$.\n\nConstraints:\n- Let the total count of `s` and `c` be $m$.\n- For $10\\%$ of the testdata, $n=1$.\n- For another $20\\%$ of the testdata, each line is a single-term expression.\n- For another $20\\%$ of the testdata, $n \\le 20$.\n- For $100\\%$ of the testdata, $n \\times m \\le 5 \\times 10^7$, $m \\le 10^6$.\n\nTips:\n- $\\forall x,\\ \\sin^2 x + \\cos^2 x = 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "珈百璃堕落的开始", "background": "\n“恭喜你，珈百璃，你以学年首席的优秀成绩毕业。”\n\n珈百璃，一位优秀的天使，今天她以学年首席的成绩毕业，从今往后，她将前往人间进行进一步修炼。\n\n“我会努力给人类带来幸福的！”珈百璃憧憬着人间生活。\n\n开学第一天，珈百璃就凭借着她极其可爱的外表，受到了班级成员的追捧，不仅长得可爱，成绩还很优秀，简直就是女神啊！\n\n因为她的成绩优秀，所以她的作业也是很快就快要完成了，但是就在她快完成数学作业时，她的电脑传来了呼救的声音。\n\n“救命啊！”\n\n顺着这个呼救声，珈百璃望向了电脑。\n\n“原来是游戏啊。”珈百璃看着屏幕里一位倒在地上的残血战士，注册了账号，选择了牧师职业，对这位战士进行了救治。在珈百璃开心的同时，越来越多的呼救声传来，珈百璃一个一个进行救治，但她的 level 才 1，mp 肯定不足，当她想要继续进行救治的时候，系统提示 mp 不足，并给出了氪金的提示：“屠龙宝刀，点击就送。”\n\n“生活费天界学院倒是有给，但是……”珈百璃看着自己的存折，再看看屏幕，她纠结不已。\n\n“救命啊！”“救……救命啊……”“救命啊！”珈百璃看着这些人一个个喊出救命，自己却无能为力，终于，她控制不住自己，点下了“氪金”按钮。\n\n从此，珈百璃的堕落就开始了，她的作业，也停在了这道数学题上……\n\n“薇奈特，帮我写一下作业嘛。”珈百璃央求着薇奈特。\n\n“真是的，你好歹也是天使呢，也该自己做一点作业吧。”\n\n“不要，我还要打游戏呢。”\n\n“这怎么行，你是天使啊。”\n\n“我已经决定做一位成天打游戏不学习的堕天使了。”\n\n“真是服了你啊，那你好好打游戏吧，我帮你写。”\n", "description": "这道题是这样的：给定一些 $\\sin^2x$，$\\cos^2x\\ \\left(x=\\dfrac{\\pi}{7}\\right)$ 组成的式子，请你帮忙求出选择一些式子相加后得到的**最大整数答案**。", "inputFormat": "第一行一个整数 $n$，表示 $n$ 个式子\n\n接下来 $n$ 行每行一个字符串，由 $f(i)=\\sin^2x,\\cos^2x$ 和加号组成，$x=\\dfrac{\\pi}{7}$。\n\n为了简化输入，我们以 `s` 代表 $\\sin^2x$，以 `c` 代表 $\\cos^2x$，并省略 `f(i)=`。", "outputFormat": "一个数表示**最大整数答案**，计算全部为加法。\n", "hint": "### 样例解释\n\n三个式子都选，则加起来等于 $3$。\n\n### 数据范围\n\n设 `s` 和 `c` 的个数总和为 $m$。\n\n$10\\%$ 的数据 $n=1$。\n\n另外 $20\\%$ 的数据每行一个单项式。\n\n另有 $20\\%$ 的数据 $n\\le20$。\n\n$100\\%$ 的数据 $n\\times m\\le5\\times10^7,m\\le10^6$。\n\n### 提示\n\n - $\\forall x, \\sin^2x+\\cos^2x=1$。", "locale": "zh-CN"}}}
{"pid": "P4833", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2\n2 3\n", "2\n1 2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "枚举", "队列"], "title": "萨塔尼亚的一生之敌", "background": "“Trick or treat！”\n\n万圣节到了，薇奈特、萨塔尼亚和菈菲尔敲开了珈百璃的门，但果然不出所料，珈百璃在打网游，真是颓废啊。\n\n“干嘛，烦死了”珈百璃一脸嫌弃地看着她们\n\n“珈百璃，好歹也出来玩玩嘛，天天待在家里打游戏，会烂掉的”薇奈特抢先说道\n\n“哈？我每天都出去玩啊，去买泡面的时候顺路在家楼下逛了一圈啊”\n\n“这只能算是去小卖部吧，根本不算是出去玩吧”\n\n“对啊，而且万圣节到了，我们一起出去要糖果吃呀”\n\n“哈？你几岁了？还玩这么无聊的游戏”\n\n“不会啊，我觉得很有趣啊”三人异口同声\n\n“真是的，好吧好吧，就陪你们玩玩”\n\n于是珈百璃随着他们三个出去要糖果吃了\n\n“那么，先去谁家呢？”\n\n“我有提议！！”萨塔尼亚激动地抢着说\n\n于是，她们一行人来到了某人家。\n\n“咚咚咚”过了一会，门开了，走出来的，是一个光头吴克\n\n“Trick or treat！”萨塔尼亚开心地叫倒。面前站的，就是她们的班主任。但是，除了萨塔尼亚在开心的要糖果，其他三个人早已经吓得瑟瑟发抖了\n\n“呃。。班。。班主任。。。？老。。老师，这是有误会的。。。”薇奈特颤抖地说道\n\n“哪有什么误会啊？班主任，Trick or treat！哦~再不给糖，就把你画成鬼~”萨塔尼亚依旧天不怕地不怕\n\n“喂。。。”薇奈特微微后退了一步\n\n但令人惊讶的是，老师居然进房间，拿了一袋礼品出来，其中包括萨塔尼亚最喜欢的限量版菠萝包\n\n“啊！！！是限量版的！！！太好了！！！”当萨塔尼亚刚要伸手去拿菠萝包时，天使的走狗杀了出来，一把抢走了菠萝包。\n\n“喂！！那是我的！！你给我回来”萨塔尼亚生气地望着天使的走狗，宣誓自己一定要抢回来\n\n萨塔尼亚势力和天使的走狗势力占领着不同的区域，每个天使的走狗占领的区域都会有一个菠萝包，萨塔尼亚想抢回这些菠萝包，你能帮助她吗？\n", "description": "详情是这样的，在萨塔尼亚强大的立场下，这个世界被分成了若干区域，有一些区域有连边。为了能够抢回菠萝包，萨亚尼亚将这些区域再分成了若干领域，使得每个领域由一些区域组成，萨塔尼亚占领了一些领域，并以这些领域为基础向走狗发起进攻。为了成功夺回所有菠萝包，萨塔尼亚决定让这些自己占领的领域满足以下性质\n\n1、    为了能够及时支援友军，在自己占领的领域中，每两个存在于不同领域的两个点都要有连边\n\n2、    为了能够灵活的进攻，自己的任意一个领域中的任意一个点和走狗占领的任意一个领域中的任意一个点都要有连边\n\n当然走狗也不是吃干饭的，它为了羞辱萨塔尼亚，也选择了一些领域，这些领域满足的性质和萨塔尼亚选择的领域满足的性质一样，且走狗的领域和萨塔尼亚的领域互补\n\n萨塔尼亚觉得，只要将领域分的越分散，胜利的几率就越大，于是想分尽可能多的领域，请问最多能分多少领域？每个领域有多少个区域组成？\n\n\\*特殊的，一个人可能占领不到任何一个领域，即占领的领域数量为0。如果你能告诉萨塔尼亚答案，萨塔尼亚就会占领最大的领域向走狗发起进攻，并最终失败。\n", "inputFormat": "第一行两个整数n和m，表示n个区域m条边\n\n接下来m行每行两个数a，b表示a和b之间有连边，保证没有自环和重边\n", "outputFormat": "第一行输出一个整数s表示最多能分成领几个领域\n\n第二行s个数从小到大输出每个领域由几个区域组成\n", "hint": "样例解释：最多分成两个领域，区域1、3为一个领域，区域2为一个领域\n\n请结合样例仔细读题！\n\n对于40%的数据，n≤10^3，m≤5\\*10^5\n\n对于100%的数据，n≤10^5，m≤2\\*10^6\n", "locale": "zh-CN", "translations": {"en": {"title": "Satania's Archnemesis", "background": "\"Trick or treat!\"\n\nIt’s Halloween. Vignette, Satania, and Raphiel knock on Gabriel’s door—but as expected, Gabriel is playing online games. Truly decadent.\n\n\"What is it? So annoying.\" Gabriel looks at them with obvious disgust.\n\n\"Gabriel, at least come out and have some fun. Staying home gaming every day will rot your brain,\" Vignette says first.\n\n\"Huh? I go out every day. When I go to buy instant noodles, I take a stroll around the building downstairs.\"\n\n\"That only counts as going to the convenience store. It doesn’t count as going out to have fun.\"\n\n\"Yeah, and it’s Halloween. Let’s go get some candy together.\"\n\n\"Huh? How old are you? Still playing such a boring game.\"\n\n\"Not at all, I think it’s fun,\" the three say in unison.\n\n\"Good grief. Fine, fine, I’ll play along.\"\n\nSo Gabriel goes out with the three of them to ask for candy.\n\n\"So, whose place first?\"\n\n\"I have a suggestion!!\" Satania says excitedly, cutting in.\n\nThey arrive at someone’s home.\n\n\"Knock, knock.\" After a moment, the door opens, and out comes a bald man.\n\n\"Trick or treat!\" Satania calls out happily. Standing before them is their homeroom teacher. But while Satania is cheerfully asking for candy, the other three are already trembling in fear.\n\n\"Uh... ho- homeroom teacher...? T- teacher, there’s been a misunderstanding...\" Vignette says, shaking.\n\n\"What misunderstanding? Homeroom teacher, trick or treat! Oh~ if you don’t give us candy, we’ll draw you into a ghost~\" Satania remains fearless.\n\n\"Hey...\" Vignette takes a small step back.\n\nSurprisingly, the teacher goes back inside and takes out a bag of treats, including Satania’s favorite limited-edition pineapple bun.\n\n\"Ah!!! It’s the limited edition!!! Awesome!!!\" Just as Satania reaches for the bun, the angel’s lackey rushes out and snatches it away.\n\n\"Hey!! That’s mine!! Give it back!\" Satania glares at the angel’s lackey, vowing to take it back.\n\nSatania’s forces and the angel’s lackey’s forces occupy different areas. Each area occupied by the angel’s lackey contains one pineapple bun. Satania wants to take these pineapple buns back. Can you help her?", "description": "Here are the details. Under Satania’s overwhelming influence, the world is divided into several regions, with some pairs of regions connected by edges. To take back the pineapple buns, Satania further partitions these regions into several domains, each domain consisting of some regions. Satania occupies some of these domains and uses them as bases to attack the lackey. To successfully reclaim all pineapple buns, Satania decides that the domains she occupies must satisfy the following properties:\n\n1. To ensure timely support among allies, for any two vertices that lie in different domains among the domains she occupies, there must be an edge between them.\n\n2. To attack flexibly, for any vertex in any of her domains and any vertex in any domain occupied by the lackey, there must be an edge between them.\n\nOf course, the lackey is not idle either. To humiliate Satania, the lackey also chooses some domains. These domains satisfy the same property as Satania’s choices: for any two vertices that lie in different domains among the lackey’s domains, there must be an edge between them. Moreover, the lackey’s domains are the complement of Satania’s domains (together they cover all domains, and they are disjoint). A person may occupy zero domains.\n\nSatania believes that the more scattered the domains, the higher her chance of victory. She wants to split the regions into as many domains as possible. What is the maximum number of domains, and how many regions does each domain contain?\n\nIf you tell Satania the answer, she will gather the largest domain to attack the lackey and ultimately fail.", "inputFormat": "- The first line contains two integers $n$ and $m$, the number of regions and the number of edges.\n- Each of the next $m$ lines contains two integers $a$, $b$, indicating that there is an edge between $a$ and $b$.\n- There are no self-loops and no multiple edges.", "outputFormat": "- On the first line, output an integer $s$, the maximum possible number of domains.\n- On the second line, output $s$ integers in nondecreasing order, where each number is the size (number of regions) of one domain.", "hint": "Sample explanation: The maximum is two domains. Regions $1$ and $3$ form one domain, and region $2$ forms one domain. Please read the statement carefully together with the sample.\n\nConstraints:\n- For $40\\%$ of the testdata, $n \\le 10^3$, $m \\le 5 \\times 10^5$.\n- For $100\\%$ of the testdata, $n \\le 10^5$, $m \\le 2 \\times 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "萨塔尼亚的一生之敌", "background": "“Trick or treat！”\n\n万圣节到了，薇奈特、萨塔尼亚和菈菲尔敲开了珈百璃的门，但果然不出所料，珈百璃在打网游，真是颓废啊。\n\n“干嘛，烦死了”珈百璃一脸嫌弃地看着她们\n\n“珈百璃，好歹也出来玩玩嘛，天天待在家里打游戏，会烂掉的”薇奈特抢先说道\n\n“哈？我每天都出去玩啊，去买泡面的时候顺路在家楼下逛了一圈啊”\n\n“这只能算是去小卖部吧，根本不算是出去玩吧”\n\n“对啊，而且万圣节到了，我们一起出去要糖果吃呀”\n\n“哈？你几岁了？还玩这么无聊的游戏”\n\n“不会啊，我觉得很有趣啊”三人异口同声\n\n“真是的，好吧好吧，就陪你们玩玩”\n\n于是珈百璃随着他们三个出去要糖果吃了\n\n“那么，先去谁家呢？”\n\n“我有提议！！”萨塔尼亚激动地抢着说\n\n于是，她们一行人来到了某人家。\n\n“咚咚咚”过了一会，门开了，走出来的，是一个光头吴克\n\n“Trick or treat！”萨塔尼亚开心地叫倒。面前站的，就是她们的班主任。但是，除了萨塔尼亚在开心的要糖果，其他三个人早已经吓得瑟瑟发抖了\n\n“呃。。班。。班主任。。。？老。。老师，这是有误会的。。。”薇奈特颤抖地说道\n\n“哪有什么误会啊？班主任，Trick or treat！哦~再不给糖，就把你画成鬼~”萨塔尼亚依旧天不怕地不怕\n\n“喂。。。”薇奈特微微后退了一步\n\n但令人惊讶的是，老师居然进房间，拿了一袋礼品出来，其中包括萨塔尼亚最喜欢的限量版菠萝包\n\n“啊！！！是限量版的！！！太好了！！！”当萨塔尼亚刚要伸手去拿菠萝包时，天使的走狗杀了出来，一把抢走了菠萝包。\n\n“喂！！那是我的！！你给我回来”萨塔尼亚生气地望着天使的走狗，宣誓自己一定要抢回来\n\n萨塔尼亚势力和天使的走狗势力占领着不同的区域，每个天使的走狗占领的区域都会有一个菠萝包，萨塔尼亚想抢回这些菠萝包，你能帮助她吗？\n", "description": "详情是这样的，在萨塔尼亚强大的立场下，这个世界被分成了若干区域，有一些区域有连边。为了能够抢回菠萝包，萨亚尼亚将这些区域再分成了若干领域，使得每个领域由一些区域组成，萨塔尼亚占领了一些领域，并以这些领域为基础向走狗发起进攻。为了成功夺回所有菠萝包，萨塔尼亚决定让这些自己占领的领域满足以下性质\n\n1、    为了能够及时支援友军，在自己占领的领域中，每两个存在于不同领域的两个点都要有连边\n\n2、    为了能够灵活的进攻，自己的任意一个领域中的任意一个点和走狗占领的任意一个领域中的任意一个点都要有连边\n\n当然走狗也不是吃干饭的，它为了羞辱萨塔尼亚，也选择了一些领域，这些领域满足的性质和萨塔尼亚选择的领域满足的性质一样，且走狗的领域和萨塔尼亚的领域互补\n\n萨塔尼亚觉得，只要将领域分的越分散，胜利的几率就越大，于是想分尽可能多的领域，请问最多能分多少领域？每个领域有多少个区域组成？\n\n\\*特殊的，一个人可能占领不到任何一个领域，即占领的领域数量为0。如果你能告诉萨塔尼亚答案，萨塔尼亚就会占领最大的领域向走狗发起进攻，并最终失败。\n", "inputFormat": "第一行两个整数n和m，表示n个区域m条边\n\n接下来m行每行两个数a，b表示a和b之间有连边，保证没有自环和重边\n", "outputFormat": "第一行输出一个整数s表示最多能分成领几个领域\n\n第二行s个数从小到大输出每个领域由几个区域组成\n", "hint": "样例解释：最多分成两个领域，区域1、3为一个领域，区域2为一个领域\n\n请结合样例仔细读题！\n\n对于40%的数据，n≤10^3，m≤5\\*10^5\n\n对于100%的数据，n≤10^5，m≤2\\*10^6\n", "locale": "zh-CN"}}}
{"pid": "P4834", "type": "P", "difficulty": 6, "samples": [["1\n2\n", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["数学", "矩阵加速", "Fibonacci 数列", "逆元"], "title": "萨塔尼亚的期末考试", "background": "“呐，珈百璃，我说，暑假我们去哪里玩呢？”薇奈特拍拍珈百璃的肩膀\n\n“哈？暑假当然是在家里打游戏啦”珈百璃无精打采地回答道\n\n“怎么能这样呢？你好歹也是天使啊，给我拿出天使的样子来啊”\n\n“真麻烦”\n\n“所以，暑假我们去海边玩吧？”\n\n“赞成赞成！去海边玩的话，就可以好好调戏珈百璃了”菈菲尔不知道什么时候凑进来\n\n“麻烦死了。”\n\n这边一群人正讨论着暑假去哪玩，然而萨塔尼亚在旁边听得很纠结，因为没有人邀请她。。\n\n“哼哼哼哼，吾乃神魔萨塔尼亚，怎么可能主动去加入呢，我必须等她们邀请我”萨塔尼亚心理打着小算盘\n\n“呐，我说，萨塔尼亚貌似有点小不开心呀”\n\n“已经不是貌似了吧，她这表情完全没有掩盖的意思啊。。”\n\n“呐，我说，要不要邀请她去啊？”\n\n拉菲尓说着，走向了萨塔尼亚。“萨塔尼亚桑，暑假我们要去海边玩哟~”\n\n“哼哼哼，终于来邀请我了吗”萨塔尼亚心里有点小开心，小声嘀咕到\n\n“萨塔尼亚桑就好好待在这里哟~”\n\n“额。。。”萨塔尼亚受到了成吨的暴击，“喂，我说，哪有你这样的啊”\n\n“恩？因为，萨塔尼亚桑，暑假如果要出去玩的话，就要通过期末考试哟，不然会被留下来补课的”\n\n“补。。。补课。。。。”萨塔尼亚貌似意会到了什么，脸色大变，“补课。。。呐，拉菲尓。。你。。你能帮我。。补习吗？”\n\n“恩？可以呀~但是期末考试如何就得看你自己了”\n\n“谢谢，那帮我看看这些哪里错了吧？我完全不懂诶”\n\n“我看看。。。” 拉菲尓丢下珈百璃和薇奈特独自给萨塔尼亚开始了补习。\n\n终于，期末考来了，萨塔尼亚努力的这么久，就看这次考试了！经过长期的努力，期末考一切顺利，除了还没考的数学其他学科都及格啦！\n\n终于到了最后一场考试——物理考试。很不错的是，萨塔尼亚已经答完了59分而且全对，但是她遇到了一道绝世难题，而且她很惊奇的发现，总分100分，这题41分，如果不写出来，就会挂科。“期末考如果有某人有挂科，那么那个人的暑假要参加补课以及补考！”班主任的话萦绕在她的耳旁，这可怎么办啊。。。\n", "description": "这道题是这样的：\n\n有一个由 $n$ 个点电荷形成的电场。假定每个点电荷放出的电场都是匀强电场而不是点电荷电场，第 $i$ 个点电荷的电场强度 $E_i=i$。\n\n现放一个带负电的试探电荷到这个电场中，这个试探电荷只要触碰到任何一个点电荷就会和这个点电荷发生聚变放出巨大能量。\n\n因为点电荷放出的电场强度不同，所以试探电荷被吸引到每个点电荷的概率也不同，点电荷给试探电荷的吸引力越大被吸到这个点电荷的概率就越大，且成正比。\n\n我们假设最小的点电荷给试探电荷的吸引力为 $F$，那么对于其他点电荷给试探电荷和吸引力就是 $iF$，那么假设触碰最小的点电荷的概率为 $P$，则每个点的概率就是 $iP$，触碰到点电荷后发出的能量为 $\\mathrm{Fib}(E_i)$。\n\n求期望放出的能量。\n\n好消息是，只要这道题拿到分，萨塔尼亚就能及格啦！\n", "inputFormat": "第一行一个整数 $T$，表示共有 $T$ 组测试数据。\n\n接下来 $T$ 行每行一个整数 $n$，表示有 $n$ 个点电荷。\n", "outputFormat": "对于每次询问输出一行一个整数表示期望能量。为了避免精度问题，请输出答案对 $998{,}244{,}353$ 取模后的结果。", "hint": "### 样例解释\n\n$\\dfrac{1}{3}\\times \\mathrm{Fib}(1)+\\dfrac{2}{3}\\times \\mathrm{Fib}(2)=1$。\n\n请结合样例仔细再仔细的读题！\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据 $T=1$，$n=2$；\n- 对于 $30\\%$ 的数据 $T≤10$，$1\\le n\\le 10^6$；\n- 对于 $60\\%$ 的数据 $T≤10^6$，$1\\le n\\le 10^6$；\n- 对于 $100\\%$ 的数据 $T≤10^6$，$1\\le n\\le 10^9$，保证 $n \\ne 998244352$ 且 $n \\ne 998244353$。\n\n$\\mathrm{Fib}(i)$ 为斐波那契数列。\n\n$$\\mathrm{Fib}(i)=\\begin{cases}\n1 & i\\le 2 \\cr\n\\mathrm{Fib}(i-1)+\\mathrm{Fib}(i-2) & i > 2\n\\end{cases}$$\n", "locale": "zh-CN", "translations": {"en": {"title": "Satania's Final Exam", "background": "\"Hey, Gabriel, where should we go to have fun during summer vacation?\" Vignette patted Gabriel on the shoulder.\n\n\"Huh? Of course I'll stay home and play games during summer vacation,\" Gabriel replied listlessly.\n\n\"You can't do that. You're an angel at least—act like one.\"\n\n\"What a pain.\"\n\n\"So, how about we go to the beach during summer vacation?\"\n\n\"Agreed, agreed! If we go to the beach, I can tease Gabriel to my heart's content,\" Raphiel slipped in before anyone noticed.\n\n\"Such a pain.\"\n\nWhile everyone was discussing where to go for summer vacation, Satania listened on the side feeling conflicted, because no one had invited her.\n\n\"Heh heh heh, I am the great demon Satania. How could I possibly join them on my own? I must wait for them to invite me,\" Satania schemed to herself.\n\n\"Hey, I think Satania looks a little unhappy.\"\n\n\"It's more than 'looks like'—she's not even trying to hide that expression.\"\n\n\"Hey, should we invite her?\"\n\nRaphiel said this as she walked over to Satania. \"Satania-san, we're going to the beach during summer vacation~\"\n\n\"Heh heh heh, finally here to invite me?\" Satania muttered softly, a little pleased.\n\n\"Satania-san, please stay right here obediently~\"\n\n\"Uh...\" Satania took massive psychological damage. \"Hey, what do you think you're doing?\"\n\n\"Hm? Because, Satania-san, if you want to go out and play during summer vacation, you have to pass the final exams, or else you'll be kept for remedial classes.\"\n\n\"Re... remedial...\" Satania seemed to realize something, her face changed dramatically. \"Remedial... hey, Raphiel... c-can you tutor me?\"\n\n\"Hm? Sure~ But how you do on the finals depends on you.\"\n\n\"Thanks. Then could you check where I got these wrong? I don't understand at all.\"\n\n\"Let me see...\" Raphiel left Gabriel and Vignette and started tutoring Satania alone.\n\nFinally, the finals arrived. Satania had worked hard for so long; it all came down to this exam! After sustained effort, everything on the finals went smoothly—apart from the math exam that hadn’t happened yet, she passed all the other subjects!\n\nAt last came the final test—the physics exam. The good news was that Satania had already answered 59 points worth of questions, all correct. But then she ran into a fiendishly difficult problem, and to her amazement, with a total of 100 points, this problem alone was worth 41. If she left it blank, she would fail. \"If anyone fails any subject in the finals, that person must attend remedial classes and make-up exams during summer vacation!\" The homeroom teacher’s words echoed in her ears. What should she do...", "description": "This problem is as follows:\n\nThere is an electric field formed by $n$ point charges. Assume each point charge produces a uniform electric field rather than a point-charge field, and the $i$-th point charge has field strength $E_i=i$.\n\nNow place a negatively charged test charge in this field. As soon as the test charge touches any point charge, it will \"fuse\" with that point charge and release a huge amount of energy.\n\nBecause the field strengths produced by the point charges differ, the test charge is attracted to each point charge with different force; the stronger the attraction a point charge exerts on the test charge, the greater the probability of being drawn to that point charge, and the probability is proportional to the attraction.\n\nAssume the smallest point charge exerts attraction $F$ on the test charge. Then another point charge exerts $iF$. Suppose the probability of touching the smallest point charge is $P$. Then the probability for each point is $iP$. After touching a point charge, the released energy is $\\mathrm{Fib}(E_i)$.\n\nFind the expected released energy.\n\nThe good news is that as long as she gets points on this problem, Satania will pass!", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nEach of the next $T$ lines contains an integer $n$, the number of point charges.", "outputFormat": "For each query, output one integer representing the expected energy. To avoid precision issues, please output the answer modulo $998{,}244{,}353$.", "hint": "- Sample Explanation\n\n$\\dfrac{1}{3}\\times \\mathrm{Fib}(1)+\\dfrac{2}{3}\\times \\mathrm{Fib}(2)=1$.\n\nPlease read the problem carefully along with the sample.\n\n- Constraints\n\n- For $10\\%$ of the testdata, $T=1$, $n=2$.\n- For $30\\%$ of the testdata, $T \\le 10$, $1 \\le n \\le 10^6$.\n- For $60\\%$ of the testdata, $T \\le 10^6$, $1 \\le n \\le 10^6$.\n- For $100\\%$ of the testdata, $T \\le 10^6$, $1 \\le n \\le 10^9$, and it is guaranteed that $n \\ne 998244352$ and $n \\ne 998244353$.\n\n$\\mathrm{Fib}(i)$ is the Fibonacci sequence.\n\n$$\\mathrm{Fib}(i)=\\begin{cases}\n1 & i\\le 2 \\cr\n\\mathrm{Fib}(i-1)+\\mathrm{Fib}(i-2) & i > 2\n\\end{cases}$$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "萨塔尼亚的期末考试", "background": "“呐，珈百璃，我说，暑假我们去哪里玩呢？”薇奈特拍拍珈百璃的肩膀\n\n“哈？暑假当然是在家里打游戏啦”珈百璃无精打采地回答道\n\n“怎么能这样呢？你好歹也是天使啊，给我拿出天使的样子来啊”\n\n“真麻烦”\n\n“所以，暑假我们去海边玩吧？”\n\n“赞成赞成！去海边玩的话，就可以好好调戏珈百璃了”菈菲尔不知道什么时候凑进来\n\n“麻烦死了。”\n\n这边一群人正讨论着暑假去哪玩，然而萨塔尼亚在旁边听得很纠结，因为没有人邀请她。。\n\n“哼哼哼哼，吾乃神魔萨塔尼亚，怎么可能主动去加入呢，我必须等她们邀请我”萨塔尼亚心理打着小算盘\n\n“呐，我说，萨塔尼亚貌似有点小不开心呀”\n\n“已经不是貌似了吧，她这表情完全没有掩盖的意思啊。。”\n\n“呐，我说，要不要邀请她去啊？”\n\n拉菲尓说着，走向了萨塔尼亚。“萨塔尼亚桑，暑假我们要去海边玩哟~”\n\n“哼哼哼，终于来邀请我了吗”萨塔尼亚心里有点小开心，小声嘀咕到\n\n“萨塔尼亚桑就好好待在这里哟~”\n\n“额。。。”萨塔尼亚受到了成吨的暴击，“喂，我说，哪有你这样的啊”\n\n“恩？因为，萨塔尼亚桑，暑假如果要出去玩的话，就要通过期末考试哟，不然会被留下来补课的”\n\n“补。。。补课。。。。”萨塔尼亚貌似意会到了什么，脸色大变，“补课。。。呐，拉菲尓。。你。。你能帮我。。补习吗？”\n\n“恩？可以呀~但是期末考试如何就得看你自己了”\n\n“谢谢，那帮我看看这些哪里错了吧？我完全不懂诶”\n\n“我看看。。。” 拉菲尓丢下珈百璃和薇奈特独自给萨塔尼亚开始了补习。\n\n终于，期末考来了，萨塔尼亚努力的这么久，就看这次考试了！经过长期的努力，期末考一切顺利，除了还没考的数学其他学科都及格啦！\n\n终于到了最后一场考试——物理考试。很不错的是，萨塔尼亚已经答完了59分而且全对，但是她遇到了一道绝世难题，而且她很惊奇的发现，总分100分，这题41分，如果不写出来，就会挂科。“期末考如果有某人有挂科，那么那个人的暑假要参加补课以及补考！”班主任的话萦绕在她的耳旁，这可怎么办啊。。。\n", "description": "这道题是这样的：\n\n有一个由 $n$ 个点电荷形成的电场。假定每个点电荷放出的电场都是匀强电场而不是点电荷电场，第 $i$ 个点电荷的电场强度 $E_i=i$。\n\n现放一个带负电的试探电荷到这个电场中，这个试探电荷只要触碰到任何一个点电荷就会和这个点电荷发生聚变放出巨大能量。\n\n因为点电荷放出的电场强度不同，所以试探电荷被吸引到每个点电荷的概率也不同，点电荷给试探电荷的吸引力越大被吸到这个点电荷的概率就越大，且成正比。\n\n我们假设最小的点电荷给试探电荷的吸引力为 $F$，那么对于其他点电荷给试探电荷和吸引力就是 $iF$，那么假设触碰最小的点电荷的概率为 $P$，则每个点的概率就是 $iP$，触碰到点电荷后发出的能量为 $\\mathrm{Fib}(E_i)$。\n\n求期望放出的能量。\n\n好消息是，只要这道题拿到分，萨塔尼亚就能及格啦！\n", "inputFormat": "第一行一个整数 $T$，表示共有 $T$ 组测试数据。\n\n接下来 $T$ 行每行一个整数 $n$，表示有 $n$ 个点电荷。\n", "outputFormat": "对于每次询问输出一行一个整数表示期望能量。为了避免精度问题，请输出答案对 $998{,}244{,}353$ 取模后的结果。", "hint": "### 样例解释\n\n$\\dfrac{1}{3}\\times \\mathrm{Fib}(1)+\\dfrac{2}{3}\\times \\mathrm{Fib}(2)=1$。\n\n请结合样例仔细再仔细的读题！\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据 $T=1$，$n=2$；\n- 对于 $30\\%$ 的数据 $T≤10$，$1\\le n\\le 10^6$；\n- 对于 $60\\%$ 的数据 $T≤10^6$，$1\\le n\\le 10^6$；\n- 对于 $100\\%$ 的数据 $T≤10^6$，$1\\le n\\le 10^9$，保证 $n \\ne 998244352$ 且 $n \\ne 998244353$。\n\n$\\mathrm{Fib}(i)$ 为斐波那契数列。\n\n$$\\mathrm{Fib}(i)=\\begin{cases}\n1 & i\\le 2 \\cr\n\\mathrm{Fib}(i-1)+\\mathrm{Fib}(i-2) & i > 2\n\\end{cases}$$\n", "locale": "zh-CN"}}}
{"pid": "P4835", "type": "P", "difficulty": 6, "samples": [["6\n0 2 3 4 5 6\n0 1 3 4 5 6\n1 6 5 4 2 1\n2 6 5 3 2 1\n1 1 2 3 4 6\n2 1 2 3 4 5", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2014", "二分", "各省省选", "江苏", "2-SAT", "强连通分量"], "title": "[JSOI2014] 学生选课", "background": "", "description": "进入大学以后，学生们将面临选课，有 $n$ 个学生需要选课，学校里有三个老师 JYY，YJY，YYJ。\n\n第一年里，每个学生们都选择了其中一位老师。经过了一年的学习，学生之间相互都有一定的印象，每个同学会根据自己的印象给另外 $n-1$ 个学生从好到坏排序。第二年的选课开始了，每个学生需要选择老师，可能是因为被坑多了，每一位同学都想换一个老师。这时需要你来调度同学们选课，使得上同一堂课的学生之间印象最坏的最好。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行 $n$ 个正整数，其中第 $i+1$ 行提供第 $i$ 个同学的信息。其中第一个整数 $A_i$，值为 $0,1,2$ 中的一个，表示第一年第 $i$ 个同学选的老师。\n接下来 $n-1$ 个数字，是 $1,2,\\cdots,i-1,i+1,\\cdots,n$ 的一个排列，表示第 $i$ 个同学对其他同学印象从好到坏的排序。", "outputFormat": "一行一个整数，为最小的非负整数 $T$，满足：\n\n- 所有同学选择了和第一年不同的老师。\n\n- 所有选择同一个老师的学生间彼此印象都是前 $T$ 好的。", "hint": "### 样例解释 1\n\n六名同学分别选择老师 $1,2,0,0,2,0$。\n\n此时老师 $0$ 的课中同学 $6$ 对同学 $4$ 的印象为第 $4$ 好，所以答案 $T$ 为 $4$，并且找不到更小的 $T$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$n\\leq 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2014] 学生选课", "background": "", "description": "进入大学以后，学生们将面临选课，有 $n$ 个学生需要选课，学校里有三个老师 JYY，YJY，YYJ。\n\n第一年里，每个学生们都选择了其中一位老师。经过了一年的学习，学生之间相互都有一定的印象，每个同学会根据自己的印象给另外 $n-1$ 个学生从好到坏排序。第二年的选课开始了，每个学生需要选择老师，可能是因为被坑多了，每一位同学都想换一个老师。这时需要你来调度同学们选课，使得上同一堂课的学生之间印象最坏的最好。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行 $n$ 个正整数，其中第 $i+1$ 行提供第 $i$ 个同学的信息。其中第一个整数 $A_i$，值为 $0,1,2$ 中的一个，表示第一年第 $i$ 个同学选的老师。\n接下来 $n-1$ 个数字，是 $1,2,\\cdots,i-1,i+1,\\cdots,n$ 的一个排列，表示第 $i$ 个同学对其他同学印象从好到坏的排序。", "outputFormat": "一行一个整数，为最小的非负整数 $T$，满足：\n\n- 所有同学选择了和第一年不同的老师。\n\n- 所有选择同一个老师的学生间彼此印象都是前 $T$ 好的。", "hint": "### 样例解释 1\n\n六名同学分别选择老师 $1,2,0,0,2,0$。\n\n此时老师 $0$ 的课中同学 $6$ 对同学 $4$ 的印象为第 $4$ 好，所以答案 $T$ 为 $4$，并且找不到更小的 $T$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$n\\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P4838", "type": "P", "difficulty": 4, "samples": [["3\n1\n3\n6\n", "2\n7\n44\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["递推", "O2优化", "矩阵乘法"], "title": "P哥破解密码", "background": "P 哥是一个经常丢密码条的男孩子。\n\n在 ION8102 赛场上，P 哥又弄丢了密码条，笔试满分的他当然知道这可是要扣 $5$ 分作为惩罚的，于是他开始破解 IONXunil 系统的密码。", "description": "定义一个串合法，当且仅当串只由 $\\verb!A!$ 和 $\\verb!B!$ 构成，且没有连续的 $3$ 个 $\\verb!A!$。P 哥知道，密码就是长度为 $N$ 的合法字符串数量对 $19260817$ 取模的结果。但是 P 哥不会算，所以他只能把 $N$ 告诉你，让你来算。\n\n至于为什么要对这个数取模，好像是因为纪念某个人，但到底是谁，P 哥也不记得了。\n\n然而他忘记字符串长度 $N$ 应该是多少了，于是他准备试 $M$ 组数据。", "inputFormat": "第一行给出一个整数 $M$ 表示询问次数。\n\n接下来 $M$ 行每行给出一个正整数 $N$，表示该组询问中字符串的长度。", "outputFormat": "对于每一次询问输出一行一个整数表示答案。", "hint": "### 样例部分解释 :。\n\n长度为 $1$ 时只有 $\\verb!A!$ 和 $\\verb!B!$ 两种排列，都是合法的。\n\n长度为 $3$ 时除了 $\\verb!AAA!$ 是不合法的其他都是可以的，故有 $2^3-1$ 种。\n\n### 数据范围。\n\n- 对于 $20\\%$ 数据，全部 $N\\leq20$，$M\\leq2$；\n- 对于 $70\\%$ 数据，全部 $N\\leq10^7$；\n- 对于 $100\\%$ 数据，全部 $N\\leq10^9$，$M\\leq10$。", "locale": "zh-CN", "translations": {"en": {"title": "Brother P Cracks the Password", "background": "Brother P is a boy who often loses his password slips.\n\nAt the ION8102 contest site, Brother P lost his password slip again. As someone who can get full marks on the written test, he of course knows that this will cost him $5$ points as a penalty, so he started cracking the password of the IONXunil system.", "description": "Define a string as valid if and only if it is made up only of $\\verb!A!$ and $\\verb!B!$, and it does not contain $3$ consecutive $\\verb!A!$ characters. Brother P knows that the password is the number of valid strings of length $N$, taken modulo $19260817$. But Brother P cannot compute it, so he can only tell you $N$ and ask you to compute it.\n\nAs for why the result is taken modulo this number, it seems to be in memory of someone, but who exactly that is, Brother P does not remember either.\n\nHowever, he forgot what the string length $N$ should be, so he plans to try $M$ sets of testdata.", "inputFormat": "The first line gives an integer $M$, which represents the number of queries.\n\nThen follow $M$ lines, each giving a positive integer $N$, meaning the length of the string in that query.", "outputFormat": "For each query, output one integer per line, representing the answer.", "hint": "### Explanation of the samples.\n\nWhen the length is $1$, there are only two arrangements: $\\verb!A!$ and $\\verb!B!$, and both are valid.\n\nWhen the length is $3$, all strings are valid except $\\verb!AAA!$, so there are $2^3-1$ strings.\n\n### Constraints.\n\n- For $20\\%$ of the testdata, all $N\\leq20$, $M\\leq2$.\n- For $70\\%$ of the testdata, all $N\\leq10^7$.\n- For $100\\%$ of the testdata, all $N\\leq10^9$, $M\\leq10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "P哥破解密码", "background": "P 哥是一个经常丢密码条的男孩子。\n\n在 ION8102 赛场上，P 哥又弄丢了密码条，笔试满分的他当然知道这可是要扣 $5$ 分作为惩罚的，于是他开始破解 IONXunil 系统的密码。", "description": "定义一个串合法，当且仅当串只由 $\\verb!A!$ 和 $\\verb!B!$ 构成，且没有连续的 $3$ 个 $\\verb!A!$。P 哥知道，密码就是长度为 $N$ 的合法字符串数量对 $19260817$ 取模的结果。但是 P 哥不会算，所以他只能把 $N$ 告诉你，让你来算。\n\n至于为什么要对这个数取模，好像是因为纪念某个人，但到底是谁，P 哥也不记得了。\n\n然而他忘记字符串长度 $N$ 应该是多少了，于是他准备试 $M$ 组数据。", "inputFormat": "第一行给出一个整数 $M$ 表示询问次数。\n\n接下来 $M$ 行每行给出一个正整数 $N$，表示该组询问中字符串的长度。", "outputFormat": "对于每一次询问输出一行一个整数表示答案。", "hint": "### 样例部分解释 :。\n\n长度为 $1$ 时只有 $\\verb!A!$ 和 $\\verb!B!$ 两种排列，都是合法的。\n\n长度为 $3$ 时除了 $\\verb!AAA!$ 是不合法的其他都是可以的，故有 $2^3-1$ 种。\n\n### 数据范围。\n\n- 对于 $20\\%$ 数据，全部 $N\\leq20$，$M\\leq2$；\n- 对于 $70\\%$ 数据，全部 $N\\leq10^7$；\n- 对于 $100\\%$ 数据，全部 $N\\leq10^9$，$M\\leq10$。", "locale": "zh-CN"}}}
{"pid": "P4839", "type": "P", "difficulty": 6, "samples": [["5 3\n1 1 2\n1 2 3\n1 3 4\n2 1 2\n2 1 3", "3\n7"], ["11 10\n2 6 9\n1 9 1523456696\n1 1 1818963290\n2 6 7\n1 1 102229226\n2 1 9\n2 3 7\n1 5 34895532\n1 1 1652480680\n1 1 1477666032\n2 1 10", "0\n0\n1818963290\n0\n1857442578\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "线性基"], "title": "P 哥的桶", "background": "", "description": "P 哥现在有 $n$ 个桶，它们排成了一排，这些桶可以装下任意多个球。每个球有一个固定的价值。\n\nP 哥时不时地会找新球，并把新找的球丢进某个桶里面。我们用 $1\\;k\\;x$ 来表示 P 哥找了一个价值为 $x$ 的球，并且丢进了 $k$ 号桶里面。\n\nP 哥每次会在特定的桶里面拿出一些球。我们用 $2\\;l\\;r$ 来表示 P 哥在 $l$ 号桶到 $r$ 号桶之间拿球。P 哥希望拿出来的球的价值异或和尽可能大。\n\n**注意：P 哥拿出这些球后会把它们物归原位。**", "inputFormat": "第一行两个整数 $n, m$，依次表示 P 哥的操作次数、这组数据会涉及到的最大编号。\n\n接下来 $n$ 行，每行三个整数，表示操作。操作格式如题。", "outputFormat": "对于每个 2 操作，输出 P 哥拿出的球的最大价值异或和。", "hint": "对于 $20 \\%$ 的数据，满足 $n,m\\leq 100$。\n\n对于 $40 \\%$ 的数据，满足 $n,m\\leq 1000$。\n\n另有 $20 \\%$ 的数据，所有询问满足 $l=1$，$r=m$。\n\n对于 $100 \\%$ 的数据，满足 $1 \\le n, m \\leq 5 \\times 10^4$，$1 \\le l\\leq r\\leq m$，$1 \\le k \\leq m$，$0 \\le x \\leq 2^{31}-1$。", "locale": "zh-CN", "translations": {"en": {"title": "P Bro’s Buckets", "background": "", "description": "P Bro now has $n$ buckets arranged in a row. These buckets can hold any number of balls. Each ball has a fixed value.\n\nFrom time to time, P Bro finds a new ball and throws it into a bucket. We use $1\\;k\\;x$ to mean that P Bro found a ball with value $x$ and threw it into bucket $k$.\n\nEach time, P Bro will take out some balls from a specific range of buckets. We use $2\\;l\\;r$ to mean that P Bro takes balls from buckets $l$ to $r$. P Bro wants the XOR sum of the values of the balls he takes out to be as large as possible.\n\n**Note: After taking out these balls, P Bro will put them back to their original places.**", "inputFormat": "The first line contains two integers $n, m$, which represent the number of operations P Bro performs, and the maximum index involved in this testdata, respectively.\n\nThe next $n$ lines each contain three integers describing an operation. The operation format is as described in the statement.", "outputFormat": "For each operation of type 2, output the maximum possible XOR sum of the values of the balls P Bro takes out.", "hint": "For $20\\%$ of the data, $n, m \\leq 100$.\n\nFor $40\\%$ of the data, $n, m \\leq 1000$.\n\nFor another $20\\%$ of the data, all queries satisfy $l = 1$ and $r = m$.\n\nFor $100\\%$ of the data, $1 \\le n, m \\leq 5 \\times 10^4$, $1 \\le l \\leq r \\leq m$, $1 \\le k \\leq m$, and $0 \\le x \\leq 2^{31}-1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "P 哥的桶", "background": "", "description": "P 哥现在有 $n$ 个桶，它们排成了一排，这些桶可以装下任意多个球。每个球有一个固定的价值。\n\nP 哥时不时地会找新球，并把新找的球丢进某个桶里面。我们用 $1\\;k\\;x$ 来表示 P 哥找了一个价值为 $x$ 的球，并且丢进了 $k$ 号桶里面。\n\nP 哥每次会在特定的桶里面拿出一些球。我们用 $2\\;l\\;r$ 来表示 P 哥在 $l$ 号桶到 $r$ 号桶之间拿球。P 哥希望拿出来的球的价值异或和尽可能大。\n\n**注意：P 哥拿出这些球后会把它们物归原位。**", "inputFormat": "第一行两个整数 $n, m$，依次表示 P 哥的操作次数、这组数据会涉及到的最大编号。\n\n接下来 $n$ 行，每行三个整数，表示操作。操作格式如题。", "outputFormat": "对于每个 2 操作，输出 P 哥拿出的球的最大价值异或和。", "hint": "对于 $20 \\%$ 的数据，满足 $n,m\\leq 100$。\n\n对于 $40 \\%$ 的数据，满足 $n,m\\leq 1000$。\n\n另有 $20 \\%$ 的数据，所有询问满足 $l=1$，$r=m$。\n\n对于 $100 \\%$ 的数据，满足 $1 \\le n, m \\leq 5 \\times 10^4$，$1 \\le l\\leq r\\leq m$，$1 \\le k \\leq m$，$0 \\le x \\leq 2^{31}-1$。", "locale": "zh-CN"}}}
{"pid": "P4840", "type": "P", "difficulty": 6, "samples": [["ioimoio\n", "7\n"], ["fcfcfcfcfczxqprvvlpstpasxvpyyhaejxehdlhckmwmibsjwqbmfzlwpjqjghmlxunefabkpryqxbkqridpqrzemvfcfcfcfcfc", "47"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "P哥旋转", "background": "P 哥开始学字符串了！", "description": "P 哥学会了字符串处理的新方法——旋转。\n\n“旋转”是这样一种操作：将原字符串最后面的字符抹去，然后把它加到最前面，得到一个新串。\n\nP 哥可以进行无数次“旋转”操作，**让得到的新串中本质不同的回文子串尽可能多**。\n\n两个回文串本质不同，当且仅当它们长度不同，或至少有一个相同位置的字符不同。\n\n现在 P 哥得到了一个串 $S$，请你通过“旋转”操作帮 P 哥达成他的目标（即上面的加粗字体部分），并输出新串中不同的回文子串的个数。", "inputFormat": "输入共一行，代表串 $S$，保证只有小写英文字母。", "outputFormat": "输出一个整数表示答案。", "hint": "设 $n$ 为串 $S$ 的长度。\n\n- 对于前 $20\\%$ 的数据，$n \\le 100$。\n- 对于前 $40\\%$ 的数据，$n \\le 2000$。\n- 对于另 $10\\%$ 的数据，保证得出正确答案不用进行旋转。\n- 对于 $100\\%$ 的数据，$n \\le 1.5\\times 10^6$。\n\n此外，对于后 $50\\%$ 的数据，保证串 $S$ 的非随机部分长度不超过 $5000$。\n\n**注意**：本题采用 subtask 方式计分。前 $50\\%$ 的数据是 subtask#1，该 subtask 采用加和的方式计分（你可以认为是传统计分方式）。后 $50\\%$ 的数据是 subtask#2，该 subtask 采用取 $\\min$ 的方式计分（即只要错一个点，后 $50$ 分全部没有）。", "locale": "zh-CN", "translations": {"en": {"title": "P-bro Rotation", "background": "P-bro has started learning strings.", "description": "P-bro has learned a new method for string processing: rotation.\n\nA “rotation” is an operation like this: remove the last character of the original string, then add it to the very front, obtaining a new string.\n\nP-bro can perform the “rotation” operation infinitely many times, in order to make the number of essentially different palindromic substrings in the resulting new string as large as possible.\n\nTwo palindromic strings are essentially different if and only if their lengths are different, or there exists at least one position where the characters are different.\n\nNow P-bro has obtained a string $S$. Please help P-bro achieve his goal through “rotation” operations (i.e., the bolded part above), and output the number of different palindromic substrings in the new string.", "inputFormat": "The input consists of one line, which is the string $S$, guaranteed to contain only lowercase English letters.", "outputFormat": "Output one integer, representing the answer.", "hint": "Let $n$ be the length of string $S$.\n\n- For the first $20\\%$ of the testdata, $n \\le 100$.\n- For the first $40\\%$ of the testdata, $n \\le 2000$.\n- For another $10\\%$ of the testdata, it is guaranteed that you can obtain the correct answer without performing any rotation.\n- For $100\\%$ of the testdata, $n \\le 1.5\\times 10^6$.\n\nIn addition, for the last $50\\%$ of the testdata, it is guaranteed that the length of the non-random part of string $S$ does not exceed $5000$.\n\n**Note**: This problem uses subtask scoring. The first $50\\%$ of the testdata is subtask#1, and this subtask uses additive scoring (you may consider it as traditional scoring). The last $50\\%$ of the testdata is subtask#2, and this subtask uses $\\min$ scoring (that is, if you get even one test wrong, you get $0$ points for the last $50$ points).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "P哥旋转", "background": "P 哥开始学字符串了！", "description": "P 哥学会了字符串处理的新方法——旋转。\n\n“旋转”是这样一种操作：将原字符串最后面的字符抹去，然后把它加到最前面，得到一个新串。\n\nP 哥可以进行无数次“旋转”操作，**让得到的新串中本质不同的回文子串尽可能多**。\n\n两个回文串本质不同，当且仅当它们长度不同，或至少有一个相同位置的字符不同。\n\n现在 P 哥得到了一个串 $S$，请你通过“旋转”操作帮 P 哥达成他的目标（即上面的加粗字体部分），并输出新串中不同的回文子串的个数。", "inputFormat": "输入共一行，代表串 $S$，保证只有小写英文字母。", "outputFormat": "输出一个整数表示答案。", "hint": "设 $n$ 为串 $S$ 的长度。\n\n- 对于前 $20\\%$ 的数据，$n \\le 100$。\n- 对于前 $40\\%$ 的数据，$n \\le 2000$。\n- 对于另 $10\\%$ 的数据，保证得出正确答案不用进行旋转。\n- 对于 $100\\%$ 的数据，$n \\le 1.5\\times 10^6$。\n\n此外，对于后 $50\\%$ 的数据，保证串 $S$ 的非随机部分长度不超过 $5000$。\n\n**注意**：本题采用 subtask 方式计分。前 $50\\%$ 的数据是 subtask#1，该 subtask 采用加和的方式计分（你可以认为是传统计分方式）。后 $50\\%$ 的数据是 subtask#2，该 subtask 采用取 $\\min$ 的方式计分（即只要错一个点，后 $50$ 分全部没有）。", "locale": "zh-CN"}}}
{"pid": "P4841", "type": "P", "difficulty": 6, "samples": [["3", "4"], ["4", "38"], ["100000", "829847355\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2013", "集训队互测", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "[集训队作业2013] 城市规划", "background": "", "description": "刚刚解决完电力网络的问题，阿狸又被领导的任务给难住了。\n\n刚才说过，阿狸的国家有 $n$ 个城市，现在国家需要在某些城市对之间建立一些贸易路线，使得整个国家的任意两个城市都直接或间接的连通。\n\n为了省钱, 每两个城市之间最多只能有一条直接的贸易路径。对于两个建立路线的方案，如果存在一个城市对，在两个方案中是否建立路线不一样，那么这两个方案就是不同的，否则就是相同的。现在你需要求出一共有多少不同的方案。\n\n好了，这就是困扰阿狸的问题。换句话说，你需要求出 $n$ 个点的简单 (无重边无自环) 有标号无向连通图数目。\n\n由于这个数字可能非常大, 你只需要输出方案数对 $1004535809$ ( $479 \\times 2 ^{21} + 1$ ) 取模即可。", "inputFormat": "仅一行一个整数 $n$", "outputFormat": "仅一行一个整数，为方案数 $\\bmod \\space 1004535809$。", "hint": "【数据范围】   \n对于 $20\\%$ 的数据，$n \\le 10$    \n对于 $40\\%$ 的数据，$n \\le 1000$     \n对于 $60\\%$ 的数据，$n \\le 30000$    \n对于 $80\\%$ 的数据，$n \\le 60000$     \n对于 $100\\%$ 的数据，$n \\le 130000$   \n\n试题来源：$2013$ 中国国家集训队第二次作业", "locale": "zh-CN", "translations": {"en": {"title": "[CTT Homework 2013] City Planning", "background": "", "description": "After just solving the problem of the power network, Ali is stuck again by a task from his leader.\n\nAs mentioned before, Ali’s country has $n$ cities. Now the country needs to build some trade routes between certain pairs of cities, so that any two cities in the whole country are connected directly or indirectly.\n\nTo save money, there can be at most one direct trade route between every pair of cities. For two route-building plans, if there exists a pair of cities such that whether a route is built between them is different in the two plans, then the two plans are different; otherwise, they are the same. Now you need to find how many different plans there are in total.\n\nThat is the problem troubling Ali. In other words, you need to count the number of simple (no multiple edges and no self-loops) labeled undirected connected graphs on $n$ vertices.\n\nSince this number may be very large, you only need to output the number of plans modulo $1004535809$ ( $479 \\times 2 ^{21} + 1$ ).", "inputFormat": "Only one line containing one integer $n$.", "outputFormat": "Only one line containing one integer, the number of plans $\\bmod \\space 1004535809$.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $n \\le 10$.  \nFor $40\\%$ of the testdata, $n \\le 1000$.  \nFor $60\\%$ of the testdata, $n \\le 30000$.  \nFor $80\\%$ of the testdata, $n \\le 60000$.  \nFor $100\\%$ of the testdata, $n \\le 130000$.\n\nSource: the second homework of China CTT in $2013$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[集训队作业2013] 城市规划", "background": "", "description": "刚刚解决完电力网络的问题，阿狸又被领导的任务给难住了。\n\n刚才说过，阿狸的国家有 $n$ 个城市，现在国家需要在某些城市对之间建立一些贸易路线，使得整个国家的任意两个城市都直接或间接的连通。\n\n为了省钱, 每两个城市之间最多只能有一条直接的贸易路径。对于两个建立路线的方案，如果存在一个城市对，在两个方案中是否建立路线不一样，那么这两个方案就是不同的，否则就是相同的。现在你需要求出一共有多少不同的方案。\n\n好了，这就是困扰阿狸的问题。换句话说，你需要求出 $n$ 个点的简单 (无重边无自环) 有标号无向连通图数目。\n\n由于这个数字可能非常大, 你只需要输出方案数对 $1004535809$ ( $479 \\times 2 ^{21} + 1$ ) 取模即可。", "inputFormat": "仅一行一个整数 $n$", "outputFormat": "仅一行一个整数，为方案数 $\\bmod \\space 1004535809$。", "hint": "【数据范围】   \n对于 $20\\%$ 的数据，$n \\le 10$    \n对于 $40\\%$ 的数据，$n \\le 1000$     \n对于 $60\\%$ 的数据，$n \\le 30000$    \n对于 $80\\%$ 的数据，$n \\le 60000$     \n对于 $100\\%$ 的数据，$n \\le 130000$   \n\n试题来源：$2013$ 中国国家集训队第二次作业", "locale": "zh-CN"}}}
{"pid": "P4842", "type": "P", "difficulty": 6, "samples": [["4 5\n1 3 2 5\n1 2\n1 3\n2 4\n4 2 4\n1 2 4\n2 3 4\n3 1 4 1\n4 1 4", "16/3\n6/1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "城市旅行", "background": "", "description": "\nW 国地大物博，由 $n$ 座城市组成，共 $n-1$ 条双向道路连接其中的两座城市，且任意两座城市都可相互到达。\n\n风景秀美的 W 国吸引了无数慕名而来的游客，根据游客对每座城市的打分，我们定义第 $i$ 座城市的美丽度为 $a_i$。一次从城市 $x$ 到城市 $y$ 的旅行，所获得的的愉悦指数为从城市 $x$ 到城市 $y$ 所有城市的美丽度之和（包括 $x$ 和 $y$）。我们定义这个值为 $H(x,y)$。\n\n现在小 A 在城市 $X$，Sharon 在城市 $Y$，他们想知道如果在城市 $X$ 到城市 $Y$ 之间的所有城市中任选两座城市 $x$ 和 $y$（$x$ 可以等于 $y$），那么 $H(x,y)$ 的期望值是多少，我们记这个期望值为 $E(x,y)$。\n\n当然，城市之间的交通状况飘忽不定，因此我们不能排除某些时刻某些道路将无法通行。某些时刻会突然添加新的道路。以及游客们审美观的改变，某些城市的美丽度也会发生变化。作为 W 国负责旅游行业的 T 君，他要求你来写一个程序来模拟上面的所有过程。", "inputFormat": "第一行两个整数，$n,m$ 表示城市个数和操作个数。\n\n接下来一行 $n$ 个整数，第 $i$ 个表示 $a_i$。  \n接下来 $n-1$ 行，每行两个整数 $u,v$，表示 $u$ 和 $v$ 之间有一条路。  \n接下来 $m$ 行，是进行下面的操作：\n\n- `1 u v` 如果城市 $u$ 和城市 $v$ 已经无直接连接的道路，则忽略这个操作，否则删除 $u,v$ 之间的道路。\n- `2 u v` 如果城市 $u$ 和城市 $v$ 联通那么忽略。否则在 $u,v$ 之间添加一条道路。\n- `3 u v d` 如果城市 $u$ 和城市 $v$ 不连通，那么忽略。否则将城市 $u$ 到城市 $v$ 的路径中所有城市（包括 $u$ 和 $v$）的美丽度都增加 $d$。\n- `4 u v` 询问 $E(u,v)$ 的值。", "outputFormat": "对于操作 4，输出答案，一个经过化简的分数 $\\frac{p}{q}$。如果 $u$ 和 $v$ 不连通输出 `-1`。", "hint": "对于所有数据满足 $1\\le N\\le 50000,1\\le M\\le 50000,1\\le a_i\\le 10^6,1\\le D\\le 100,1\\le u,v\\le N$。", "locale": "zh-CN", "translations": {"en": {"title": "City Travel.", "background": "", "description": "Country W is vast and rich. It consists of $n$ cities, connected by $n-1$ bidirectional roads, each road connecting two cities. Any two cities can reach each other.\n\nThe beautiful scenery of Country W attracts many tourists. Based on the tourists' ratings for each city, we define the beauty of city $i$ as $a_i$. For a trip from city $x$ to city $y$, the happiness index gained is the sum of the beauties of all cities on the path from city $x$ to city $y$ (including $x$ and $y$). We define this value as $H(x,y)$.\n\nNow, Xiao A is in city $X$ and Sharon is in city $Y$. They want to know: if we choose any two cities $x$ and $y$ (where $x$ may equal $y$) among all cities on the path from city $X$ to city $Y$, what is the expected value of $H(x,y)$? We denote this expected value as $E(x,y)$.\n\nOf course, the traffic conditions between cities are unpredictable, so we cannot rule out that at some moments some roads become impassable. At some moments, new roads may be added. Also, as tourists' tastes change, the beauty of some cities may change as well. As Mr. T, who is responsible for the tourism industry in Country W, requires you to write a program to simulate all the processes above.", "inputFormat": "The first line contains two integers $n,m$, representing the number of cities and the number of operations.\n\nThe next line contains $n$ integers, where the $i$-th integer represents $a_i$.  \nThe next $n-1$ lines each contain two integers $u,v$, indicating there is a road between $u$ and $v$.  \nThe next $m$ lines describe the following operations:\n\n- `1 u v` If there is no road directly connecting cities $u$ and $v$, ignore this operation; otherwise, delete the road between $u$ and $v$.\n- `2 u v` If cities $u$ and $v$ are connected, ignore this operation; otherwise, add a road between $u$ and $v$.\n- `3 u v d` If cities $u$ and $v$ are not connected, ignore this operation; otherwise, increase the beauty of all cities on the path from city $u$ to city $v$ (including $u$ and $v$) by $d$.\n- `4 u v` Query the value of $E(u,v)$.", "outputFormat": "For operation 4, output the answer as a reduced fraction $\\frac{p}{q}$. If $u$ and $v$ are not connected, output `-1`.", "hint": "For all testdata, $1\\le N\\le 50000,1\\le M\\le 50000,1\\le a_i\\le 10^6,1\\le D\\le 100,1\\le u,v\\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "城市旅行", "background": "", "description": "\nW 国地大物博，由 $n$ 座城市组成，共 $n-1$ 条双向道路连接其中的两座城市，且任意两座城市都可相互到达。\n\n风景秀美的 W 国吸引了无数慕名而来的游客，根据游客对每座城市的打分，我们定义第 $i$ 座城市的美丽度为 $a_i$。一次从城市 $x$ 到城市 $y$ 的旅行，所获得的的愉悦指数为从城市 $x$ 到城市 $y$ 所有城市的美丽度之和（包括 $x$ 和 $y$）。我们定义这个值为 $H(x,y)$。\n\n现在小 A 在城市 $X$，Sharon 在城市 $Y$，他们想知道如果在城市 $X$ 到城市 $Y$ 之间的所有城市中任选两座城市 $x$ 和 $y$（$x$ 可以等于 $y$），那么 $H(x,y)$ 的期望值是多少，我们记这个期望值为 $E(x,y)$。\n\n当然，城市之间的交通状况飘忽不定，因此我们不能排除某些时刻某些道路将无法通行。某些时刻会突然添加新的道路。以及游客们审美观的改变，某些城市的美丽度也会发生变化。作为 W 国负责旅游行业的 T 君，他要求你来写一个程序来模拟上面的所有过程。", "inputFormat": "第一行两个整数，$n,m$ 表示城市个数和操作个数。\n\n接下来一行 $n$ 个整数，第 $i$ 个表示 $a_i$。  \n接下来 $n-1$ 行，每行两个整数 $u,v$，表示 $u$ 和 $v$ 之间有一条路。  \n接下来 $m$ 行，是进行下面的操作：\n\n- `1 u v` 如果城市 $u$ 和城市 $v$ 已经无直接连接的道路，则忽略这个操作，否则删除 $u,v$ 之间的道路。\n- `2 u v` 如果城市 $u$ 和城市 $v$ 联通那么忽略。否则在 $u,v$ 之间添加一条道路。\n- `3 u v d` 如果城市 $u$ 和城市 $v$ 不连通，那么忽略。否则将城市 $u$ 到城市 $v$ 的路径中所有城市（包括 $u$ 和 $v$）的美丽度都增加 $d$。\n- `4 u v` 询问 $E(u,v)$ 的值。", "outputFormat": "对于操作 4，输出答案，一个经过化简的分数 $\\frac{p}{q}$。如果 $u$ 和 $v$ 不连通输出 `-1`。", "hint": "对于所有数据满足 $1\\le N\\le 50000,1\\le M\\le 50000,1\\le a_i\\le 10^6,1\\le D\\le 100,1\\le u,v\\le N$。", "locale": "zh-CN"}}}
{"pid": "P4843", "type": "P", "difficulty": 6, "samples": [["8\n1 3\n1 7\n2 4 5\n1 8\n1 8\n0\n2 6 5\n0", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["网络流", "上下界网络流", "费用流"], "title": "清理雪道", "background": null, "description": "滑雪场坐落在 FJ 省西北部的若干座山上。\n\n从空中鸟瞰，滑雪场可以看作一个有向无环图，每条弧代表一个斜坡（即雪道），弧的方向代表斜坡下降的方向。\n\n你的团队负责每周定时清理雪道。你们拥有一架直升飞机，每次飞行可以从总部带一个人降落到滑雪场的某个地点，然后再飞回总部。从降落的地点出发，这个人可以顺着斜坡向下滑行，并清理他所经过的雪道。\n\n由于每次飞行的耗费是固定的，为了最小化耗费，你想知道如何用最少的飞行次数才能完成清理雪道的任务。", "inputFormat": "第一行一个整数 $n$ 代表滑雪场的地点的数量。\n\n接下来的 $n$ 行，描述 $1$ 到 $n$ 号地点出发的斜坡。第 $i$ 行的第一个数为 $m_i$，后面共有 $m_i$ 个整数，由空格隔开，每个整数 $a_{i,j}$ 互不相同，代表从地点 $i$ 下降到地点 $a_{i,j}$ 的斜坡。", "outputFormat": "一行一个整数，表示直升飞机的最少飞行次数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2 \\le  n \\le 100$，$0\\le m_i < n$，且每个地点至少有一个斜坡与之相连。", "locale": "zh-CN", "translations": {"en": {"title": "Clearing Ski Runs", "background": "", "description": "A ski resort is located on several mountains in the northwest of FJ Province.\n\nFrom an aerial view, the ski resort can be seen as a directed acyclic graph. Each arc represents a slope (i.e., a ski run), and the direction of the arc represents the downhill direction of the slope.\n\nYour team is responsible for regularly clearing the ski runs every week. You have a helicopter. In each flight, it can carry one person from the headquarters to land at some location in the ski resort, and then fly back to the headquarters. Starting from the landing location, this person can ski downhill along the slopes and clear the ski runs he passes through.\n\nSince the cost of each flight is fixed, to minimize the cost, you want to know the minimum number of flights needed to complete the task of clearing all ski runs.", "inputFormat": "The first line contains an integer $n$, representing the number of locations in the ski resort.\n\nThe next $n$ lines describe the slopes starting from locations $1$ to $n$. In the $i$-th line, the first number is $m_i$, followed by $m_i$ integers separated by spaces. Each integer $a_{i,j}$ is distinct, representing a slope from location $i$ down to location $a_{i,j}$.", "outputFormat": "Output one integer in a single line, representing the minimum number of helicopter flights.", "hint": "#### Constraints\n\nFor $100\\%$ of the testdata, $2 \\le n \\le 100$, $0 \\le m_i < n$, and each location is connected to at least one slope.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "清理雪道", "background": null, "description": "滑雪场坐落在 FJ 省西北部的若干座山上。\n\n从空中鸟瞰，滑雪场可以看作一个有向无环图，每条弧代表一个斜坡（即雪道），弧的方向代表斜坡下降的方向。\n\n你的团队负责每周定时清理雪道。你们拥有一架直升飞机，每次飞行可以从总部带一个人降落到滑雪场的某个地点，然后再飞回总部。从降落的地点出发，这个人可以顺着斜坡向下滑行，并清理他所经过的雪道。\n\n由于每次飞行的耗费是固定的，为了最小化耗费，你想知道如何用最少的飞行次数才能完成清理雪道的任务。", "inputFormat": "第一行一个整数 $n$ 代表滑雪场的地点的数量。\n\n接下来的 $n$ 行，描述 $1$ 到 $n$ 号地点出发的斜坡。第 $i$ 行的第一个数为 $m_i$，后面共有 $m_i$ 个整数，由空格隔开，每个整数 $a_{i,j}$ 互不相同，代表从地点 $i$ 下降到地点 $a_{i,j}$ 的斜坡。", "outputFormat": "一行一个整数，表示直升飞机的最少飞行次数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2 \\le  n \\le 100$，$0\\le m_i < n$，且每个地点至少有一个斜坡与之相连。", "locale": "zh-CN"}}}
{"pid": "P4844", "type": "P", "difficulty": 6, "samples": [["10", "3"], ["100", "43"], ["100000", "42139\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "枚举", "莫比乌斯反演"], "title": "LJJ爱数数", "background": "题解请查看 <https://www.cnblogs.com/Blog-of-Eden/p/9367521.html>。", "description": "PJY 某次翻阅杂志时，看到一道题：\n\n求出所有的 **正整数** 三元组 $(a,b,c)$，满足 $a,b,c \\leq n$，**$\\bold{a,b,c}$ 三个数的最大公约数为 $\\bold{1}$**，且 **$\\bold{\\frac{1}{a}+\\frac{1}{b}=\\frac{1}{c}}$**。\n\nPJY 嫌这道题太水，于是把它甩给了爱数数的 LJJ，并加上了数据范围 $\\bold{n \\leq 10^{12}}$，让 LJJ 数出 **有多少组满足条件的三元组 $\\bold{(a,b,c)}$**\n（注意当 $a \\not= b$ 时，$(a,b,c)$ 和 $(b,a,c)$ 是不同的三元组，要算两次）\n\nLJJ 数到一半，发现这个数量太大了，于是他把问题抛给了你。请你输出这个数量。", "inputFormat": "输入仅一行：一个正整数 $n(n\\leq 10^{12})$。", "outputFormat": "输出仅一行：一个整数，表示满足条件的三元组 $(a,b,c)$ 的数量。", "hint": "对于 $20\\%$ 的数据，$n \\leq 2 \\times 10^{3}$。\n\n对于 $40\\%$ 的数据，$n \\leq 10^{5}$。\n\n对于 $60\\%$ 的数据，$n \\leq 10^{7}$。\n\n对于 $80\\%$ 的数据，$n \\leq 10^{9}$。\n\n对于 $100\\%$ 的数据，$n \\leq 10^{12}$。", "locale": "zh-CN", "translations": {"en": {"title": "LJJ Loves Counting.", "background": "For the solution, please see <https://www.cnblogs.com/Blog-of-Eden/p/9367521.html>。", "description": "Once when reading a magazine, PJY saw a problem:\n\nFind all **positive integer** triples $(a,b,c)$ such that $a,b,c \\leq n$, the **greatest common divisor of the three numbers $\\bold{a,b,c}$ is $\\bold{1}$**, and **$\\bold{\\frac{1}{a}+\\frac{1}{b}=\\frac{1}{c}}$**.\n\nPJY thought this problem was too easy, so he threw it to LJJ, who loves counting, and added the Constraints $\\bold{n \\leq 10^{12}}$, asking LJJ to count **how many triples $\\bold{(a,b,c)}$** satisfy the conditions  \n(note that when $a \\not= b$, $(a,b,c)$ and $(b,a,c)$ are different triples and should be counted twice).\n\nHalfway through counting, LJJ found that the number was too large, so he passed the problem to you. Please output this number.", "inputFormat": "Only one line: a positive integer $n(n\\leq 10^{12})$。", "outputFormat": "Only one line: an integer, representing the number of triples $(a,b,c)$ that satisfy the conditions.", "hint": "For $20\\%$ of the testdata, $n \\leq 2 \\times 10^{3}$。\n\nFor $40\\%$ of the testdata, $n \\leq 10^{5}$。\n\nFor $60\\%$ of the testdata, $n \\leq 10^{7}$。\n\nFor $80\\%$ of the testdata, $n \\leq 10^{9}$。\n\nFor $100\\%$ of the testdata, $n \\leq 10^{12}$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "LJJ爱数数", "background": "题解请查看 <https://www.cnblogs.com/Blog-of-Eden/p/9367521.html>。", "description": "PJY 某次翻阅杂志时，看到一道题：\n\n求出所有的 **正整数** 三元组 $(a,b,c)$，满足 $a,b,c \\leq n$，**$\\bold{a,b,c}$ 三个数的最大公约数为 $\\bold{1}$**，且 **$\\bold{\\frac{1}{a}+\\frac{1}{b}=\\frac{1}{c}}$**。\n\nPJY 嫌这道题太水，于是把它甩给了爱数数的 LJJ，并加上了数据范围 $\\bold{n \\leq 10^{12}}$，让 LJJ 数出 **有多少组满足条件的三元组 $\\bold{(a,b,c)}$**\n（注意当 $a \\not= b$ 时，$(a,b,c)$ 和 $(b,a,c)$ 是不同的三元组，要算两次）\n\nLJJ 数到一半，发现这个数量太大了，于是他把问题抛给了你。请你输出这个数量。", "inputFormat": "输入仅一行：一个正整数 $n(n\\leq 10^{12})$。", "outputFormat": "输出仅一行：一个整数，表示满足条件的三元组 $(a,b,c)$ 的数量。", "hint": "对于 $20\\%$ 的数据，$n \\leq 2 \\times 10^{3}$。\n\n对于 $40\\%$ 的数据，$n \\leq 10^{5}$。\n\n对于 $60\\%$ 的数据，$n \\leq 10^{7}$。\n\n对于 $80\\%$ 的数据，$n \\leq 10^{9}$。\n\n对于 $100\\%$ 的数据，$n \\leq 10^{12}$。", "locale": "zh-CN"}}}
{"pid": "P4845", "type": "P", "difficulty": 7, "samples": [["2\n9 1 1\n2 2 2 2 2 3 4 3 4\n1 2\n1 3\n1 4\n1 5\n2 6\n6 7\n3 8\n8 9\n9 2 1\n2 2 2 2 2 3 4 3 4\n1 2\n1 3\n1 4\n1 5\n2 6\n6 7\n3 8\n8 9", "10\n18"], ["3\n10 1 1\n2 8 9 6 1 9 9 2 8 9 \n1 2\n2 3\n2 4\n4 5\n3 6\n2 7\n7 8\n4 9\n7 10\n10 2 1\n2 8 9 6 1 9 9 2 8 9 \n1 2\n2 3\n2 4\n4 5\n3 6\n2 7\n7 8\n4 9\n7 10\n10 3 1\n2 8 9 6 1 9 9 2 8 9 \n1 2\n2 3\n2 4\n4 5\n3 6\n2 7\n7 8\n4 9\n7 10", "34\n46\n61"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP"], "title": "LJJ 爱数树", "background": "", "description": "Eden 偶然间拿到了一张藏宝图，值得一提的是，这是张无向联通图，有 $n$ 个节点，$n-1$ 条长度为 $1$ 的边，即一颗树。每个节点上都标有该地点的宝藏数量 $w_i$。\n\n然而宝藏太多，不能一次性搬完，Eden 花费其所有积蓄买来 $k$ 个摄像头，每个摄像头能观测的距离范围是 $r$（我们规定树上任意两点距离为其最短路径的长度）。为了确保宝藏尽可能不被他人拿走，Eden 将要在这棵树上的至多 $k$ 个节点处布置摄像头（于是与该节点距离 $\\le r$ 的节点都能被观测到）。\n\nEden 想要使能被观测到的节点的宝藏数量（即 $w_i$）之和最大化，于是他把这个问题交给了爱数树的 LJJ。让 LJJ 枚举所有可能放置摄像头的情况，来筛选出最优的方案。\n\nLJJ 数到一半，发现这个方案数量太多了，于是他把问题抛给了你，\n请你输出能被观测到的节点的 $w_i$ 之和的最大值。", "inputFormat": "**本题有多组数据。**\n\n第 $1$ 行：一个正整数 $T$，表示有 $T$ 组数据。\n\n接下来每组数据：\\\n第 $1$ 行：$3$ 个用空格分隔开的正整数 $n, k, r$。\\\n第 $2$ 行：$n$ 个用空格分隔开的正整数，第 $i$ 个数表示 $w_i$。\\\n第 $3$ 至 $n+1$ 行：每行两个整数 $x,y$，表示 $x$ 到 $y$ 之间有一条边。", "outputFormat": "对于每组数据，一行输出一个整数，表示能被观测到的节点的 $w_i$ 之和的最大值。", "hint": "对于 $10\\%$ 的数据，保证 $n\\le20$，$r\\le 20$，$w_i\\le20$；\n\n对于 $40\\%$ 的数据，保证 $n\\le50$，$r\\le 50$，$w_i\\le50$；\n\n对于另外 $20\\%$ 的数据，保证 $k\\le2$；\n\n对于另外 $10\\%$ 的数据，保证给出的树是一条链。\n\n对于 $100\\%$ 的数据，保证 $1\\le k \\le n\\le10^3$，$1\\le r\\le 10^3$，$1\\le w_i\\le10^6$，$1\\le T\\le 5$，$1\\le x,y\\le n$。\n\n官方题解请查看 [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html)。", "locale": "zh-CN", "translations": {"en": {"title": "LJJ Loves Counting Trees", "background": "", "description": "Eden accidentally obtained a treasure map. Notably, it is an undirected connected graph with $n$ nodes and $n-1$ edges of length $1$, i.e., a tree. Each node is labeled with the amount of treasure at that location, $w_i$.\n\nHowever, there is too much treasure to move all at once. Eden spent all his savings to buy $k$ cameras. Each camera has an observation range of $r$ (we define the distance between any two points on the tree as the length of their shortest path). To ensure that the treasure is not taken by others as much as possible, Eden will place cameras at at most $k$ nodes on the tree (so all nodes whose distance to that node is $\\le r$ can be observed).\n\nEden wants to maximize the sum of treasure amounts (i.e., $w_i$) of the nodes that can be observed, so he gave this problem to LJJ, who loves counting trees. He asked LJJ to enumerate all possible camera placements to find the best plan.\n\nHalfway through counting, LJJ realized there were far too many plans, so he threw the problem to you. Please output the maximum possible sum of $w_i$ over the nodes that can be observed.", "inputFormat": "**This problem contains multiple test cases.**\n\nLine $1$: a positive integer $T$, indicating there are $T$ test cases.\n\nFor each test case:\\\nLine $1$: three positive integers $n, k, r$ separated by spaces.\\\nLine $2$: $n$ positive integers separated by spaces; the $i$-th number denotes $w_i$.\\\nLines $3$ to $n+1$: each line contains two integers $x, y$, indicating there is an edge between $x$ and $y$.", "outputFormat": "For each test case, output one integer per line, indicating the maximum possible sum of $w_i$ of the nodes that can be observed.", "hint": "For $10\\%$ of the testdata, it is guaranteed that $n\\le20$, $r\\le 20$, $w_i\\le20$.\n\nFor $40\\%$ of the testdata, it is guaranteed that $n\\le50$, $r\\le 50$, $w_i\\le50$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $k\\le2$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that the given tree is a chain.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le k \\le n\\le10^3$, $1\\le r\\le 10^3$, $1\\le w_i\\le10^6$, $1\\le T\\le 5$, $1\\le x,y\\le n$.\n\nFor the official editorial, please see [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "LJJ 爱数树", "background": "", "description": "Eden 偶然间拿到了一张藏宝图，值得一提的是，这是张无向联通图，有 $n$ 个节点，$n-1$ 条长度为 $1$ 的边，即一颗树。每个节点上都标有该地点的宝藏数量 $w_i$。\n\n然而宝藏太多，不能一次性搬完，Eden 花费其所有积蓄买来 $k$ 个摄像头，每个摄像头能观测的距离范围是 $r$（我们规定树上任意两点距离为其最短路径的长度）。为了确保宝藏尽可能不被他人拿走，Eden 将要在这棵树上的至多 $k$ 个节点处布置摄像头（于是与该节点距离 $\\le r$ 的节点都能被观测到）。\n\nEden 想要使能被观测到的节点的宝藏数量（即 $w_i$）之和最大化，于是他把这个问题交给了爱数树的 LJJ。让 LJJ 枚举所有可能放置摄像头的情况，来筛选出最优的方案。\n\nLJJ 数到一半，发现这个方案数量太多了，于是他把问题抛给了你，\n请你输出能被观测到的节点的 $w_i$ 之和的最大值。", "inputFormat": "**本题有多组数据。**\n\n第 $1$ 行：一个正整数 $T$，表示有 $T$ 组数据。\n\n接下来每组数据：\\\n第 $1$ 行：$3$ 个用空格分隔开的正整数 $n, k, r$。\\\n第 $2$ 行：$n$ 个用空格分隔开的正整数，第 $i$ 个数表示 $w_i$。\\\n第 $3$ 至 $n+1$ 行：每行两个整数 $x,y$，表示 $x$ 到 $y$ 之间有一条边。", "outputFormat": "对于每组数据，一行输出一个整数，表示能被观测到的节点的 $w_i$ 之和的最大值。", "hint": "对于 $10\\%$ 的数据，保证 $n\\le20$，$r\\le 20$，$w_i\\le20$；\n\n对于 $40\\%$ 的数据，保证 $n\\le50$，$r\\le 50$，$w_i\\le50$；\n\n对于另外 $20\\%$ 的数据，保证 $k\\le2$；\n\n对于另外 $10\\%$ 的数据，保证给出的树是一条链。\n\n对于 $100\\%$ 的数据，保证 $1\\le k \\le n\\le10^3$，$1\\le r\\le 10^3$，$1\\le w_i\\le10^6$，$1\\le T\\le 5$，$1\\le x,y\\le n$。\n\n官方题解请查看 [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html)。", "locale": "zh-CN"}}}
{"pid": "P4846", "type": "P", "difficulty": 6, "samples": [["7 2\n8 8 8 0 8 8 8\n1 7 9\n3 5 17", "2\n16"], ["4 1\n5 3 8 2\n1 4 9", "8"], ["10 10\n7 7 6 5 5 2 8 5 0 3 \n1 8 11\n3 10 11\n4 7 12\n9 10 12\n3 5 10\n2 7 10\n7 9 10\n2 7 11\n1 4 11\n4 7 10\n", "12\n15\n9\n3\n5\n8\n5\n9\n6\n7\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 5000, 5000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "二分"], "title": "LJJ爱数书", "background": "题解请查看 [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html)。", "description": "LJJ 的家里有一本“数书”，也就是说里面全都是数字的书，LJJ 十分喜爱它。\n\n数书里有一个序列 $A$，每次操作可以使一段连续的区间加 $1$ 或减 $1$ 并对 $k$ 取模，我们定义和谐函数 $f (A,k)$ 表示最少的操作次数，使得序列的所有元素都变为 $0$。\n\n例如 $A=\\{3,3,2,3\\}$，$k= 4$ 时，通过把 $a$ 变成 $\\{0,0,3,0\\}$，再把 $a$ 变成 $\\{0,0,0,0\\}$ 就能达到要求，所以 $f(A,k)=2$。\n\n现在，输入长度为 $n$ 的序列 $A$，设 $A_{l,r}$ 表示序列 $A$ 第 $l$ 个位置到第 $r$ 个位置的连续子序列。\n有 $m$ 次询问，每次询问输入 $l,r,k$，求 $f (A_{l,r},k)$ 的值。", "inputFormat": "第 $1$ 行：两个整数 $n,m$，表示序列长度为 $n$，有 $m$ 次询问。\n\n第 $2$ 行：$n$ 个整数，第i个整数表示 $A[i]$\n第 $3$ 至 $m+2$ 行：每行三个整数 $l,r,k$。", "outputFormat": "共 $m$ 行：每行一个整数，表示每组询问的答案 $f(A_{l,r},k)$。", "hint": "数据保证每组询问的 $k>\\max_{i = 1}^{n}A_i$。\n\n对于 $100%$ 的数据：$n \\le 200000$，$m \\le 100000$，$k \\le 2^{30}$。", "locale": "zh-CN", "translations": {"en": {"title": "LJJ Loves a Number Book", "background": "Please refer to the solution article at [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html).", "description": "LJJ has a “number book” at home, which means the book contains only numbers. LJJ loves it very much.\n\nIn the number book there is a sequence $A$. In each operation, you may add $1$ or subtract $1$ to a continuous interval, and then take modulo $k$. We define the harmony function $f(A,k)$ as the minimum number of operations needed to make all elements of the sequence become $0$.\n\nFor example, when $A=\\{3,3,2,3\\}$ and $k=4$, by changing $A$ into $\\{0,0,3,0\\}$, and then changing $A$ into $\\{0,0,0,0\\}$, the goal can be achieved, so $f(A,k)=2$.\n\nNow, given a sequence $A$ of length $n$, let $A_{l,r}$ denote the continuous subsequence of $A$ from position $l$ to position $r$.\nThere are $m$ queries. Each query gives $l,r,k$. You need to compute the value of $f(A_{l,r},k)$.", "inputFormat": "Line $1$: Two integers $n,m$, meaning the sequence length is $n$, and there are $m$ queries.\n\nLine $2$: $n$ integers, where the $i$-th integer represents $A[i]$.\n\nLines $3$ to $m+2$: Each line contains three integers $l,r,k$.", "outputFormat": "Output $m$ lines: each line contains one integer, representing the answer $f(A_{l,r},k)$ for each query.", "hint": "It is guaranteed that for each query, $k>\\max_{i = 1}^{n}A_i$.\n\nFor $100\\%$ of the testdata: $n \\le 200000$, $m \\le 100000$, $k \\le 2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "LJJ爱数书", "background": "题解请查看 [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html)。", "description": "LJJ 的家里有一本“数书”，也就是说里面全都是数字的书，LJJ 十分喜爱它。\n\n数书里有一个序列 $A$，每次操作可以使一段连续的区间加 $1$ 或减 $1$ 并对 $k$ 取模，我们定义和谐函数 $f (A,k)$ 表示最少的操作次数，使得序列的所有元素都变为 $0$。\n\n例如 $A=\\{3,3,2,3\\}$，$k= 4$ 时，通过把 $a$ 变成 $\\{0,0,3,0\\}$，再把 $a$ 变成 $\\{0,0,0,0\\}$ 就能达到要求，所以 $f(A,k)=2$。\n\n现在，输入长度为 $n$ 的序列 $A$，设 $A_{l,r}$ 表示序列 $A$ 第 $l$ 个位置到第 $r$ 个位置的连续子序列。\n有 $m$ 次询问，每次询问输入 $l,r,k$，求 $f (A_{l,r},k)$ 的值。", "inputFormat": "第 $1$ 行：两个整数 $n,m$，表示序列长度为 $n$，有 $m$ 次询问。\n\n第 $2$ 行：$n$ 个整数，第i个整数表示 $A[i]$\n第 $3$ 至 $m+2$ 行：每行三个整数 $l,r,k$。", "outputFormat": "共 $m$ 行：每行一个整数，表示每组询问的答案 $f(A_{l,r},k)$。", "hint": "数据保证每组询问的 $k>\\max_{i = 1}^{n}A_i$。\n\n对于 $100%$ 的数据：$n \\le 200000$，$m \\le 100000$，$k \\le 2^{30}$。", "locale": "zh-CN"}}}
{"pid": "P4847", "type": "P", "difficulty": 6, "samples": [["5 10\n57770 55352 18768 21847 79100 \nM 1 4\nM 3 2\nQ 5 2\nM 3 4\nM 3 5\nM 4 4\nM 3 1\nD 1\nQ 2 2\nQ 2 1\n", "-1\n55352\n113122\n"], ["30 100\n2193 75245 24438 95450 96514 84854 15292 9488 37488 940 52991 15190 64052 17398 80379 77861 88717 34751 16783 88345 27612 21748 79776 43058 35590 49064 45012 37206 70870 30643 \nM 18 26\nM 28 27\nM 25 4\nM 12 22\nM 26 15\nM 3 1\nM 20 20\nM 7 21\nM 18 29\nM 21 26\nM 29 10\nM 27 23\nM 30 28\nM 22 10\nM 13 21\nM 1 23\nM 25 9\nM 29 27\nM 23 25\nM 11 12\nM 1 4\nM 26 14\nM 26 9\nD 4\nM 16 8\nM 16 20\nM 4 27\nM 9 20\nM 11 1\nM 19 8\nQ 12 7\nM 5 10\nD 20\nQ 29 2\nQ 9 15\nM 29 21\nD 5\nM 23 8\nM 6 6\nD 23\nD 6\nQ 4 8\nD 21\nQ 29 23\nQ 19 4\nM 21 21\nM 20 25\nM 27 29\nD 2\nQ 7 2\nM 7 15\nQ 11 18\nD 26\nQ 21 18\nM 22 11\nM 12 12\nM 20 15\nM 22 4\nD 20\nM 4 5\nM 12 2\nQ 27 20\nM 30 2\nM 28 9\nM 20 11\nM 10 21\nM 12 24\nQ 14 14\nM 6 29\nQ 13 18\nQ 10 3\nQ 23 3\nD 4\nM 27 13\nM 6 23\nM 7 14\nQ 12 17\nM 18 25\nQ 2 19\nD 3\nD 9\nQ 2 16\nQ 3 8\nQ 4 10\nD 24\nM 21 4\nQ 17 15\nQ 19 7\nQ 1 24\nQ 9 18\nD 12\nM 4 16\nM 27 21\nD 26\nM 5 14\nM 15 19\nM 21 26\nM 18 27\nQ 21 8\nQ 18 13\n", "52230\n-1\n-1\n254468\n291078\n112233\n-1\n231636\n62363\n-1\n17398\n178645\n25378\n219268\n-1\n419122\n347453\n-1\n-1\n-1\n274542\n-1\n269126\n-1\n178645\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["平衡树", "动态树 LCT"], "title": "银河英雄传说V2", "background": "小 H 昨天看到了 [luogu P1196](https://www.luogu.com.cn/problem/P1196) 这一题，触发了他内心中对英雄的感慨/雾。可是无奈他不会这一题，只好去请教小 W。在讲完那一题之后，小 W 灵机一动——不如改一下这道题吧。\n\n于是，一个很水的签到题出现了。", "description": "某 dalao：把题目说简单一点，方便让我一分钟 A 掉！\n\n于是小 W 只好把题意简化一下：\n\n给定 $n$ 个长度为 $1$ 的序列，第 $i$ 个序列中有一个元素，值为 $a_i$，接下来有三种操作：\n\n1. `M x y`，表示把 $x$ 所在的序列放到 $y$ 所在的序列之后。如果 $x,y$　已经在同一个序列，则不进行操作。\n2. `D x`，表示把 $x$ 所在的序列中从 $x$ 处断开，也就是把 $x$ 及 $x$ 之后的元素单独取出来作为一个序列。\n3. `Q x y`，表示查询 $x$ 到 $y$ 之间（包括x和y）所有元素的值之和。如果 $x$ 和 $y$ 不在同一个序列之中，输出 `-1`.", "inputFormat": "第一行为两个数 $n,m$，分别代表元素个数和操作次数。第二行有 $n$ 个数，为 $a_i$。\n接下来m行，每行包括三种情况：`M x y`，`D x` 或 `Q x y`，与题目描述对应。", "outputFormat": "对于每一个 `Q x y`，输出一个数，表示所有元素的值之和。", "hint": "（出题人非常良心地给了一个大一点的样例！）\n\n**【样例 $1$ 解释】**\n\n首先有 $5$ 个序列（一个横排为一个序列），排列如下：\n```\n1\n2\n3\n4\n5\n```\n\n第一个操作将 $1$ 放到 $4$ 的后面，变成\n```\n2\n3\n4,1\n5\n```\n\n第二个操作将 $3$ 放到 $2$ 后面，变成\n```\n2,3\n4,1\n5\n````\n\n然后查询第 $5$ 个元素到第 $2$ 个元素之间的和，由于不存在，输出 `-1`；\n\n将 $3$ 所在的序列加到 $4$ 所在的序列后面，变成\n```\n4,1,2,3\n5\n```\n\n接下来变成了 $5,4,1,2,3$，也就是所有元素都在 $1$ 个序列了，因此接下来的两个合并操作没有用了，然后把 $1$ 之后的数字删除，变成：\n\n```\n1,2,3\n5,4\n```\n\n查询 $2$ 到 $2$，输出 $a_2$，也就是 $55352$；\n\n查询 $2$ 到 $1$，输出 $a_2+a_1$，也就是 $113122$.\n\n**【数据范围】**\n\n![](https://cdn.luogu.com.cn/upload/pic/30577.png)\n\n~~为了避免某些乱搞（可能避免不了）~~，**前 $5$ 个点按照传统方式计分，每个测试点 $10$ 分；后五个点为 subtask 捆绑测试，必须全部通过才能得 $50$ 分，否则不得分。**\n\n对于所有数据，$1 \\le x,y \\le n，1 \\le a_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Galaxy Heroes Legend V2", "background": "Yesterday, Little H saw the problem [luogu P1196](https://www.luogu.com.cn/problem/P1196), which triggered his feelings about heroes (fog). However, he could not solve it, so he went to ask Little W for help. After explaining that problem, Little W had a sudden idea—why not modify this problem a bit?\n\nSo, a very easy “check-in” problem appeared.", "description": "Some dalao said: Make the statement simpler so I can get an AC in one minute!\n\nSo Little W had to simplify the meaning:\n\nGiven $n$ sequences of length $1$, the $i$-th sequence contains one element with value $a_i$. Then there are three types of operations:\n\n1. `M x y`: move the sequence containing $x$ to after the sequence containing $y$. If $x$ and $y$ are already in the same sequence, do nothing.\n2. `D x`: cut the sequence containing $x$ at position $x$. That is, take $x$ and all elements after $x$ out as a new sequence.\n3. `Q x y`: query the sum of values of all elements between $x$ and $y$ (including $x$ and $y$). If $x$ and $y$ are not in the same sequence, output `-1`.", "inputFormat": "The first line contains two integers $n,m$, representing the number of elements and the number of operations. The second line contains $n$ integers, which are $a_i$.\n\nThe next $m$ lines each describe one operation, in one of the following forms: `M x y`, `D x`, or `Q x y`, corresponding to the description.", "outputFormat": "For each `Q x y`, output one integer, the sum of the values of all elements in the queried range.", "hint": "(The problem setter kindly provided a larger sample!)\n\n**[Sample $1$ Explanation]**\n\nAt the beginning there are $5$ sequences (each row is one sequence), arranged as:\n```\n1\n2\n3\n4\n5\n```\n\nThe first operation puts $1$ after $4$, becoming:\n```\n2\n3\n4,1\n5\n```\n\nThe second operation puts $3$ after $2$, becoming:\n```\n2,3\n4,1\n5\n```\n\nThen query the sum between the $5$-th element and the $2$-nd element. Since it does not exist, output `-1`.\n\nAppend the sequence containing $3$ after the sequence containing $4$, becoming:\n```\n4,1,2,3\n5\n```\n\nNext it becomes $5,4,1,2,3$, i.e. all elements are in $1$ sequence, so the next two merge operations are useless. Then delete the numbers after $1$, becoming:\n```\n1,2,3\n5,4\n```\n\nQuery $2$ to $2$, output $a_2$, which is $55352$.\n\nQuery $2$ to $1$, output $a_2+a_1$, which is $113122$.\n\n**[Constraints]**\n\n![](https://cdn.luogu.com.cn/upload/pic/30577.png)\n\n~~To avoid some messy tricks (maybe it cannot be avoided anyway)~~, **the first $5$ points are scored in the traditional way, $10$ points per test point; the last five points are bundled as a subtask: you must pass all of them to get $50$ points, otherwise you get $0$ points.**\n\nFor all testdata, $1 \\le x,y \\le n$, $1 \\le a_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "银河英雄传说V2", "background": "小 H 昨天看到了 [luogu P1196](https://www.luogu.com.cn/problem/P1196) 这一题，触发了他内心中对英雄的感慨/雾。可是无奈他不会这一题，只好去请教小 W。在讲完那一题之后，小 W 灵机一动——不如改一下这道题吧。\n\n于是，一个很水的签到题出现了。", "description": "某 dalao：把题目说简单一点，方便让我一分钟 A 掉！\n\n于是小 W 只好把题意简化一下：\n\n给定 $n$ 个长度为 $1$ 的序列，第 $i$ 个序列中有一个元素，值为 $a_i$，接下来有三种操作：\n\n1. `M x y`，表示把 $x$ 所在的序列放到 $y$ 所在的序列之后。如果 $x,y$　已经在同一个序列，则不进行操作。\n2. `D x`，表示把 $x$ 所在的序列中从 $x$ 处断开，也就是把 $x$ 及 $x$ 之后的元素单独取出来作为一个序列。\n3. `Q x y`，表示查询 $x$ 到 $y$ 之间（包括x和y）所有元素的值之和。如果 $x$ 和 $y$ 不在同一个序列之中，输出 `-1`.", "inputFormat": "第一行为两个数 $n,m$，分别代表元素个数和操作次数。第二行有 $n$ 个数，为 $a_i$。\n接下来m行，每行包括三种情况：`M x y`，`D x` 或 `Q x y`，与题目描述对应。", "outputFormat": "对于每一个 `Q x y`，输出一个数，表示所有元素的值之和。", "hint": "（出题人非常良心地给了一个大一点的样例！）\n\n**【样例 $1$ 解释】**\n\n首先有 $5$ 个序列（一个横排为一个序列），排列如下：\n```\n1\n2\n3\n4\n5\n```\n\n第一个操作将 $1$ 放到 $4$ 的后面，变成\n```\n2\n3\n4,1\n5\n```\n\n第二个操作将 $3$ 放到 $2$ 后面，变成\n```\n2,3\n4,1\n5\n````\n\n然后查询第 $5$ 个元素到第 $2$ 个元素之间的和，由于不存在，输出 `-1`；\n\n将 $3$ 所在的序列加到 $4$ 所在的序列后面，变成\n```\n4,1,2,3\n5\n```\n\n接下来变成了 $5,4,1,2,3$，也就是所有元素都在 $1$ 个序列了，因此接下来的两个合并操作没有用了，然后把 $1$ 之后的数字删除，变成：\n\n```\n1,2,3\n5,4\n```\n\n查询 $2$ 到 $2$，输出 $a_2$，也就是 $55352$；\n\n查询 $2$ 到 $1$，输出 $a_2+a_1$，也就是 $113122$.\n\n**【数据范围】**\n\n![](https://cdn.luogu.com.cn/upload/pic/30577.png)\n\n~~为了避免某些乱搞（可能避免不了）~~，**前 $5$ 个点按照传统方式计分，每个测试点 $10$ 分；后五个点为 subtask 捆绑测试，必须全部通过才能得 $50$ 分，否则不得分。**\n\n对于所有数据，$1 \\le x,y \\le n，1 \\le a_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4848", "type": "P", "difficulty": 7, "samples": [["10 7\n1 1 1 1\n1 2 2 3\n1 4 1 2\n1 3 4 4\n2 1 1 4 1 3\n2 2 2 3 5 4\n2 2 1 4 4 2", "NAIVE!ORZzyz.\nNAIVE!ORZzyz.\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": [], "title": "崂山白花蛇草水", "background": null, "description": "神犇 Aleph 在 SDOI Round2 前立了一个 flag：如果进了省队，就现场直播喝崂山白花蛇草水。凭借着神犇 Aleph 的实力，他轻松地进了山东省省队，现在便是他履行诺言的时候了。蒟蒻 Bob 特地为他准备了 999,999,999,999,999,999 瓶崂山白花蛇草水，想要灌神犇 Aleph。神犇 Aleph 求（跪着的）蒟蒻 Bob 不要灌他，由于神犇 Aleph 是神犇，蒟蒻 Bob 最终答应了他的请求，但蒟蒻 Bob 决定将计就计，也让神犇 Aleph 回答一些问题。\n\n具体说来，蒟蒻 Bob 会在一个宽敞的广场上放置一些崂山白花蛇草水（可视为二维平面上的一些整点），然后询问神犇 Aleph 在矩形区域 $x_1\\le x\\le x_2,y_1\\le y\\le y_2$ 中，崂山白花蛇草水瓶数第 $k$ 多的是多少。为了避免麻烦，蒟蒻 Bob 不会在同一个位置放置两次或两次以上的崂山白花蛇草水，但蒟蒻 Bob 想为难一下神犇 Aleph，希望他能在每次询问时立刻回\n答出答案。\n\n神犇 Aleph 不屑于做这种问题，所以把这个问题交给了你。", "inputFormat": "输入的第一行为两个正整数 $n$，$q$，表示横纵坐标的范围和蒟蒻 Bob 的操作次数（包括放置次数和询问次数）。\n\n接下来 $q$ 行，每行代表蒟蒻 Bob 的一个操作，操作格式如下：  \n首先第一个数字 $\\mathrm{type}$，表示操作种类。$\\mathrm{type}=1$ 表示放置，$\\mathrm{type}=2$ 表示询问。  \n若 $\\mathrm{type}=1$，接下来会有三个正整数 $x, y, v$，表示在坐标整点 $(x, y)$ 放置 $v$ 瓶崂山白花蛇草水。  \n若 $\\mathrm{type}=2$，接下来会有五个正整数 $x_1, y_1, x_2, y_2, k$，表示询问矩形区域 $x_1\\le x\\le x_2,y_1\\le y\\le y_2$ 中，崂山白花蛇草水瓶数第 $k$ 多的是多少。\n\n为了体现程序的在线性，你需要将每次读入的数据（除了 $\\mathrm{type}$ 值）都异或 $\\mathrm{lastans}$，其中 $\\mathrm{lastans}$ 表示上次询问的答\n案。如果上次询问的答案为 `NAIVE!ORZzyz.`（见样例输出），则将 $\\mathrm{lastans}$ 置为 $0$。初始时的 $\\mathrm{lastans}$ 为 $0$。\n初始时平面上不存在崂山白花蛇草水。", "outputFormat": "对于每个 $\\mathrm{type}=2$ 的操作，一行输出崂山白花蛇草水瓶数第 $k$ 多的是多少。若不存在第 $k$ 多的瓶数，\n请输出 `NAIVE!ORZzyz.`。", "hint": "对于所有数据，$n\\le500000$，$q\\le100000$，$1\\le x, y\\le n$，$1\\le v\\le 10^9$，$1\\le x_1\\le x_2\\le n$，$1\\le y_1\\le y_2\\le n$，$1\\le k\\le q$。", "locale": "zh-CN", "translations": {"en": {"title": "Laoshan Baihua Shecao Water", "background": "", "description": "Ace (shenben, “神犇”) Aleph set a flag before SDOI Round 2: if he got into the provincial team, he would livestream himself drinking Laoshan Baihua Shecao Water. With his strength, Aleph easily made it into the Shandong provincial team, and now it is time for him to keep his promise. Rookie (juruo, “蒟蒻”) Bob specially prepared 999,999,999,999,999,999 bottles of Laoshan Baihua Shecao Water, hoping to force Ace Aleph to drink them. Ace Aleph begged (on his knees) rookie Bob not to do that. Since Ace Aleph is an ace, rookie Bob finally agreed, but Bob decided to play along and make Aleph answer some questions.\n\nMore specifically, rookie Bob will place some Laoshan Baihua Shecao Water on a spacious square (which can be seen as some integer grid points on a 2D plane), and then ask Ace Aleph: within the rectangular region $x_1\\le x\\le x_2,y_1\\le y\\le y_2$, what is the $k$-th largest bottle count. To avoid trouble, rookie Bob will not place Laoshan Baihua Shecao Water at the same position twice or more, but he still wants to make things difficult for Ace Aleph, hoping that Aleph can answer immediately for every query.\n\nAce Aleph does not care to solve such a problem, so he hands it to you.", "inputFormat": "The first line contains two positive integers $n$ and $q$, indicating the coordinate range on both axes and the number of operations by rookie Bob (including both placements and queries).\n\nThe next $q$ lines each describe one operation by rookie Bob, in the following format:  \nThe first number is $\\mathrm{type}$, indicating the operation type. $\\mathrm{type}=1$ means a placement, and $\\mathrm{type}=2$ means a query.  \nIf $\\mathrm{type}=1$, it is followed by three positive integers $x, y, v$, meaning that $v$ bottles of Laoshan Baihua Shecao Water are placed at the integer point $(x, y)$.  \nIf $\\mathrm{type}=2$, it is followed by five positive integers $x_1, y_1, x_2, y_2, k$, meaning a query in the rectangular region $x_1\\le x\\le x_2,y_1\\le y\\le y_2$: what is the $k$-th largest bottle count.\n\nTo reflect the online nature of the program, you must XOR every value you read (except the $\\mathrm{type}$ value) with $\\mathrm{lastans}$, where $\\mathrm{lastans}$ is the answer to the previous query. If the previous query answer is `NAIVE!ORZzyz.` (see the sample output), then set $\\mathrm{lastans}$ to $0$. Initially, $\\mathrm{lastans}$ is $0$. Initially, there is no Laoshan Baihua Shecao Water on the plane.", "outputFormat": "For each operation with $\\mathrm{type}=2$, output one line: the $k$-th largest bottle count. If the $k$-th largest bottle count does not exist, output `NAIVE!ORZzyz.`.", "hint": "Constraints: For all testdata, $n\\le500000$, $q\\le100000$, $1\\le x, y\\le n$, $1\\le v\\le 10^9$, $1\\le x_1\\le x_2\\le n$, $1\\le y_1\\le y_2\\le n$, $1\\le k\\le q$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "崂山白花蛇草水", "background": null, "description": "神犇 Aleph 在 SDOI Round2 前立了一个 flag：如果进了省队，就现场直播喝崂山白花蛇草水。凭借着神犇 Aleph 的实力，他轻松地进了山东省省队，现在便是他履行诺言的时候了。蒟蒻 Bob 特地为他准备了 999,999,999,999,999,999 瓶崂山白花蛇草水，想要灌神犇 Aleph。神犇 Aleph 求（跪着的）蒟蒻 Bob 不要灌他，由于神犇 Aleph 是神犇，蒟蒻 Bob 最终答应了他的请求，但蒟蒻 Bob 决定将计就计，也让神犇 Aleph 回答一些问题。\n\n具体说来，蒟蒻 Bob 会在一个宽敞的广场上放置一些崂山白花蛇草水（可视为二维平面上的一些整点），然后询问神犇 Aleph 在矩形区域 $x_1\\le x\\le x_2,y_1\\le y\\le y_2$ 中，崂山白花蛇草水瓶数第 $k$ 多的是多少。为了避免麻烦，蒟蒻 Bob 不会在同一个位置放置两次或两次以上的崂山白花蛇草水，但蒟蒻 Bob 想为难一下神犇 Aleph，希望他能在每次询问时立刻回\n答出答案。\n\n神犇 Aleph 不屑于做这种问题，所以把这个问题交给了你。", "inputFormat": "输入的第一行为两个正整数 $n$，$q$，表示横纵坐标的范围和蒟蒻 Bob 的操作次数（包括放置次数和询问次数）。\n\n接下来 $q$ 行，每行代表蒟蒻 Bob 的一个操作，操作格式如下：  \n首先第一个数字 $\\mathrm{type}$，表示操作种类。$\\mathrm{type}=1$ 表示放置，$\\mathrm{type}=2$ 表示询问。  \n若 $\\mathrm{type}=1$，接下来会有三个正整数 $x, y, v$，表示在坐标整点 $(x, y)$ 放置 $v$ 瓶崂山白花蛇草水。  \n若 $\\mathrm{type}=2$，接下来会有五个正整数 $x_1, y_1, x_2, y_2, k$，表示询问矩形区域 $x_1\\le x\\le x_2,y_1\\le y\\le y_2$ 中，崂山白花蛇草水瓶数第 $k$ 多的是多少。\n\n为了体现程序的在线性，你需要将每次读入的数据（除了 $\\mathrm{type}$ 值）都异或 $\\mathrm{lastans}$，其中 $\\mathrm{lastans}$ 表示上次询问的答\n案。如果上次询问的答案为 `NAIVE!ORZzyz.`（见样例输出），则将 $\\mathrm{lastans}$ 置为 $0$。初始时的 $\\mathrm{lastans}$ 为 $0$。\n初始时平面上不存在崂山白花蛇草水。", "outputFormat": "对于每个 $\\mathrm{type}=2$ 的操作，一行输出崂山白花蛇草水瓶数第 $k$ 多的是多少。若不存在第 $k$ 多的瓶数，\n请输出 `NAIVE!ORZzyz.`。", "hint": "对于所有数据，$n\\le500000$，$q\\le100000$，$1\\le x, y\\le n$，$1\\le v\\le 10^9$，$1\\le x_1\\le x_2\\le n$，$1\\le y_1\\le y_2\\le n$，$1\\le k\\le q$。", "locale": "zh-CN"}}}
{"pid": "P4849", "type": "P", "difficulty": 6, "samples": [["5 5\n1 1 1 1 5\n2 2 2 2 4\n1 1 2 2 3\n3 1 3 1 10\n5 5 5 5 1", "16\n1"], ["20 1000000000\n20204201 39958379 15138434 34289618 398078390\n85600475 39563639 66410111 36702766 611878653\n36702694 1628762 125746709 79172847 611878653\n103077330 79188107 6711555 56295346 611878653\n212677316 202221253 26717633 234187985 158044893\n297040787 198938585 43827694 296390944 158044893\n109256220 180224853 267561686 65767679 472347047\n167183048 72650618 4390517 30073538 471045792\n214834767 93996707 94416376 34549122 359059039\n89445418 135311221 266840392 213735818 398078390\n343357648 61588748 188180842 396968607 144378900\n285457193 157755350 336368020 572049737 472347047\n171728638 398663231 323772972 359470762 611878653\n234684711 226541116 270561472 376433946 229386389\n293174669 58119648 352134416 262971247 144378900\n182250938 623413311 303663331 506122949 611878653\n817319765 321076346 200801449 745136845 698518241\n26356940 295529493 725103952 845588002 533478406\n510252473 498314898 168621119 519205227 472347047\n947274653 288133984 692904616 340022215 611878653\n", "1696104353\n6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["cdq 分治", "K-D Tree"], "title": "寻找宝藏", "background": "如果时光回到从前，或许，一切只是虚无……\n\n小 W 坐着时光穿梭机到达了一个四维时空，在这里，开始了他的寻宝之旅。", "description": "整个四维时空可以看做是一个四维的网格图，小 W 在 $(1,1,1,1)$ 这个位置，出口在 $(m,m,m,m)$。但由于小 W 毕竟是外来时空的人，他的行动在这里受到了一些限制。每次他只能使四个坐标中的一个加上 $1$。也就是说，他每次只能向右，向上，向前和向*（蒟蒻的出题人想不出来怎么形容了）走一步。\n\n这个时空中有 $n$ 个宝藏，第 $i$ 个宝藏的坐标是 $(a_i,b_i,c_i,d_i)$，价值为 $v_i$。\n\n小 W 想知道，他能够拿走宝藏的最大价值和是多少。由于小 W 也是一个喜欢未雨绸缪的人，他也希望能够找到多种不同的方案使它们都可以达到最大价值和的要求。不过这个数有可能很大，输出它对 $998244353$ 取模的结果即可。\n\n注意！两个方案不同当且仅当两个方案中至少有一个宝藏选择的不同（一个位置有多个宝藏只算一种方案），如果仅仅路线不同而最终都选择了相同的宝藏不算不同的方案。\n\n（小心两个宝藏待在相同的位置哦……）", "inputFormat": "第一行两个数 $n,m$，分别代表宝藏个数和网格坐标的最大值。\n\n接下来 $n$ 行，每行 $5$ 个数，分别是 $a_i,b_i,c_i,d_i,v_i$。", "outputFormat": "输出两行，第一行是最大价值和，第二行是满足条件的方案个数对 $998244353$ 取模的结果。", "hint": "对于样例 1，最好的办法是 $(1,1,1,1)$ 慢慢走到 $(3,1,3,1)$，再慢慢走到 $(5,5,5,5)$，获得 $16$ 的价值。最好的路径只有这 $1$ 条。\n\n![Luogu](https://cdn.luogu.com.cn/upload/pic/26057.png)\n\n对于所有数据，$1\\le a_i,b_i,c_i,d_i\\le m$，$1\\le v_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Treasure Hunt.", "background": "If time could go back to the past, perhaps everything would be nothing...\n\nLittle W takes a time machine to a four-dimensional spacetime, and begins his treasure-hunting journey there.", "description": "The entire four-dimensional spacetime can be seen as a four-dimensional grid graph. Little W starts at $(1,1,1,1)$, and the exit is at $(m,m,m,m)$. However, since Little W is a visitor to this spacetime, his movement is restricted in some ways. Each time, he can only increase one of the four coordinates by $1$. That is, each step he can only move one step to the right, upward, forward, or * (the weak/problemsetter could not think of how to describe it).\n\nThere are $n$ treasures in this spacetime. The coordinates of the $i$-th treasure are $(a_i,b_i,c_i,d_i)$, and its value is $v_i$.\n\nLittle W wants to know the maximum total value of treasures he can take. Since Little W also likes to plan ahead, he also hopes to find multiple different plans that can all achieve the maximum total value. This number may be very large, so output it modulo $998244353$.\n\nNote: Two plans are different if and only if there is at least one treasure choice that is different between them (multiple treasures at the same position count as only one plan). If only the route is different but the final chosen treasures are the same, then they are not considered different plans.\n\n(Be careful: two treasures may be at the same position.)", "inputFormat": "The first line contains two integers $n,m$, representing the number of treasures and the maximum grid coordinate value.\n\nThe next $n$ lines each contain $5$ integers, which are $a_i,b_i,c_i,d_i,v_i$.", "outputFormat": "Output two lines. The first line is the maximum total value. The second line is the number of plans that satisfy the requirement, modulo $998244353$.", "hint": "For Sample 1, the best way is to move from $(1,1,1,1)$ slowly to $(3,1,3,1)$, and then slowly to $(5,5,5,5)$, obtaining a value of $16$. There is only $1$ best path.\n\n![Luogu](https://cdn.luogu.com.cn/upload/pic/26057.png)\n\nFor all testdata, $1\\le a_i,b_i,c_i,d_i\\le m$, $1\\le v_i\\le 10^9$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "寻找宝藏", "background": "如果时光回到从前，或许，一切只是虚无……\n\n小 W 坐着时光穿梭机到达了一个四维时空，在这里，开始了他的寻宝之旅。", "description": "整个四维时空可以看做是一个四维的网格图，小 W 在 $(1,1,1,1)$ 这个位置，出口在 $(m,m,m,m)$。但由于小 W 毕竟是外来时空的人，他的行动在这里受到了一些限制。每次他只能使四个坐标中的一个加上 $1$。也就是说，他每次只能向右，向上，向前和向*（蒟蒻的出题人想不出来怎么形容了）走一步。\n\n这个时空中有 $n$ 个宝藏，第 $i$ 个宝藏的坐标是 $(a_i,b_i,c_i,d_i)$，价值为 $v_i$。\n\n小 W 想知道，他能够拿走宝藏的最大价值和是多少。由于小 W 也是一个喜欢未雨绸缪的人，他也希望能够找到多种不同的方案使它们都可以达到最大价值和的要求。不过这个数有可能很大，输出它对 $998244353$ 取模的结果即可。\n\n注意！两个方案不同当且仅当两个方案中至少有一个宝藏选择的不同（一个位置有多个宝藏只算一种方案），如果仅仅路线不同而最终都选择了相同的宝藏不算不同的方案。\n\n（小心两个宝藏待在相同的位置哦……）", "inputFormat": "第一行两个数 $n,m$，分别代表宝藏个数和网格坐标的最大值。\n\n接下来 $n$ 行，每行 $5$ 个数，分别是 $a_i,b_i,c_i,d_i,v_i$。", "outputFormat": "输出两行，第一行是最大价值和，第二行是满足条件的方案个数对 $998244353$ 取模的结果。", "hint": "对于样例 1，最好的办法是 $(1,1,1,1)$ 慢慢走到 $(3,1,3,1)$，再慢慢走到 $(5,5,5,5)$，获得 $16$ 的价值。最好的路径只有这 $1$ 条。\n\n![Luogu](https://cdn.luogu.com.cn/upload/pic/26057.png)\n\n对于所有数据，$1\\le a_i,b_i,c_i,d_i\\le m$，$1\\le v_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4850", "type": "P", "difficulty": 5, "samples": [["2 3\n2 7 5\n1 9 5\n", "77\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2009", "IOI", "O2优化", "记忆化搜索", "前缀和"], "title": "[IOI 2009] Raisins", "background": "IOI2009 D1T4", "description": "普罗夫迪夫的著名巧克力大师 Bonny 需要切开一板带有葡萄干的巧克力。巧克力是一个包含许多相同的方形小块的矩形。小块沿着巧克力的边排列成 $N$ 行 $M$ 列，共有 $N\\times M$ 块。每个小块上有 $1$ 个或多个葡萄干，没有葡萄干在小块的边上或者跨过两个小块。\n\n最开始，巧克力是一整块。Bonny 需要把它切成上述的 $N\\times M$ 个独立的小块。因为 Bonny 很忙，她需要她的助手 Sly Peter 帮她切。\nPeter 只能从一端到另一端切直线，并且他要为他的每一刀得到报酬。Bonny 手头没有钱，但是她有足够的葡萄干，所以她提出用葡萄干付给 Peter。Sly Peter 同意接受葡萄干，但是有下面的条件：每次他把给定的一块巧克力切成两小块，他都要得到和那块给定的巧克力上葡萄干数目相同的葡萄干。\n\nBonny 想要付给 Peter 尽可能少的葡萄干。她知道这 $n\\times m$ 个小块中每一个小块上葡萄干的数目。她可以选择递给 Peter 的巧克力的顺序，也可以告诉 Peter 如何切（横切还是竖切）以及从哪里切。请告诉 Bonny 如何把巧克力切成一个个独立的小块，使她能够付给 Sly Peter 尽可能少的葡萄干。\n\n**任务**：编写一个程序，给定每个小块上葡萄干的数目，计算出 Bonny 要付给 Sly Peter 的最少的葡萄干的数目。", "inputFormat": "第一行两个由空格隔开的整数 $N, M$，分别表示巧克力的行数和列数。\n\n接下来 $N$ 行描述了每个小块上葡萄干的数目。其中第 $k$ 行描述了第 $k$ 行小块的巧克力。每行包含 $m$ 个整数，分别以一个空格隔开。这些整数描述了该行从左到右的小块。第 $k$ 行的第 $p$ 个整数表示位于第 $k$ 行第 $p$ 列的小块上的葡萄干数目 $R_{k, p}$。", "outputFormat": "一行一个整数，表示 Bonny 要付给 Sly Peter 的最少的葡萄干的数目。", "hint": "### 样例解释\n\n一种可能的代价为 $77$ 的切割方案如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zg74ypip.png)\n\n第一次切割将第三列和剩下来的巧克力分开了。Bonny 需要付给 Peter $29$ 个葡萄干。\n\n接下来 Bonny 把较小的那一块巧克力（有两小块，每一块都有 $5$ 个葡萄干）给 Peter，要求 Peter 切成两半并支付 $10$ 个葡萄干。\n\n在此之后，Bonny 给 Peter 剩下来的最大块（分别有 $2,  7, 1, 9$ 个葡萄干在它的四个小块上）。Bonny 要求 Peter 水平切割这一块，将第一行和第二行分开并付给他 $19$ 个葡萄干。\n\n此后 Bonny 给 Peter 左上角的块，支付 $9$ 个葡萄干。最后 Bonny 要求 Peter 将左下角的块分开，支付 $10$ 个葡萄干。\n\nBonny 的总代价是 $29 + 10 + 19 + 9 + 10 = 77$ 个葡萄干。没有其它安排切割的方案有更小的代价。\n\n### 数据范围与约定\n\n- 对于 $25\\%$ 的数据，$n,m\\leq 7$。\n- 对于 $100\\%$ 的数据，$1\\leq n,m\\leq 50$，$1\\leq R_{k, p}\\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2009] Raisins", "background": "IOI 2009 D1T4.", "description": "The famous chocolatier Bonny from Plovdiv needs to cut a chocolate bar with raisins. The chocolate is a rectangle made of many identical small square pieces. These pieces are arranged along the sides of the chocolate into $N$ rows and $M$ columns, for a total of $N\\times M$ pieces. Each small piece contains $1$ or more raisins, and no raisin lies on the border of a piece or crosses between two pieces.\n\nAt the beginning, the chocolate is one whole bar. Bonny needs to cut it into the $N\\times M$ individual pieces described above. Since Bonny is very busy, she asks her assistant Sly Peter to help with the cutting.\n\nPeter can only make straight cuts from one side to the other, and he must be paid for each cut. Bonny has no money, but she has enough raisins, so she offers to pay Peter with raisins. Sly Peter agrees to accept raisins, but with the following condition: each time he cuts a given piece of chocolate into two smaller pieces, he must receive a number of raisins equal to the total number of raisins in that given piece of chocolate.\n\nBonny wants to pay Peter as few raisins as possible. She knows the number of raisins on each of the $N\\times M$ small pieces. She can choose the order in which she gives pieces of chocolate to Peter, and she can tell Peter how to cut (horizontally or vertically) and where to cut. You must help Bonny cut the chocolate into individual pieces so that she pays Sly Peter as few raisins as possible.\n\n**Task**: Write a program that, given the number of raisins on each small piece, computes the minimum number of raisins Bonny must pay Sly Peter.", "inputFormat": "The first line contains two integers $N, M$ separated by spaces, representing the number of rows and columns of the chocolate.\n\nThe next $N$ lines describe the number of raisins on each small piece. The $k$-th line describes the $k$-th row of pieces. Each line contains $M$ integers separated by single spaces. These integers describe the pieces in that row from left to right. The $p$-th integer on the $k$-th line is the number of raisins $R_{k, p}$ on the piece in row $k$ and column $p$.", "outputFormat": "Output one integer on a single line, the minimum number of raisins Bonny must pay Sly Peter.", "hint": "### Sample Explanation\n\nOne possible cutting plan with a cost of $77$ is shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zg74ypip.png)\n\nThe first cut separates the third column from the rest of the chocolate. Bonny needs to pay Peter $29$ raisins.\n\nNext, Bonny gives Peter the smaller piece of chocolate (which has two small pieces, each with $5$ raisins), asks Peter to cut it into two halves, and pays $10$ raisins.\n\nAfter that, Bonny gives Peter the remaining largest piece (its four small pieces contain $2, 7, 1, 9$ raisins). Bonny asks Peter to cut this piece horizontally, separating the first row from the second row, and pays him $19$ raisins.\n\nThen Bonny gives Peter the top-left piece and pays $9$ raisins. Finally, Bonny asks Peter to split the bottom-left piece and pays $10$ raisins.\n\nBonny’s total cost is $29 + 10 + 19 + 9 + 10 = 77$ raisins. No other cutting plan has a smaller total cost.\n\n### Constraints\n\n- For $25\\%$ of the testdata, $n,m\\leq 7$.\n- For $100\\%$ of the testdata, $1\\leq n,m\\leq 50$, $1\\leq R_{k, p}\\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2009] Raisins", "background": "IOI2009 D1T4", "description": "普罗夫迪夫的著名巧克力大师 Bonny 需要切开一板带有葡萄干的巧克力。巧克力是一个包含许多相同的方形小块的矩形。小块沿着巧克力的边排列成 $N$ 行 $M$ 列，共有 $N\\times M$ 块。每个小块上有 $1$ 个或多个葡萄干，没有葡萄干在小块的边上或者跨过两个小块。\n\n最开始，巧克力是一整块。Bonny 需要把它切成上述的 $N\\times M$ 个独立的小块。因为 Bonny 很忙，她需要她的助手 Sly Peter 帮她切。\nPeter 只能从一端到另一端切直线，并且他要为他的每一刀得到报酬。Bonny 手头没有钱，但是她有足够的葡萄干，所以她提出用葡萄干付给 Peter。Sly Peter 同意接受葡萄干，但是有下面的条件：每次他把给定的一块巧克力切成两小块，他都要得到和那块给定的巧克力上葡萄干数目相同的葡萄干。\n\nBonny 想要付给 Peter 尽可能少的葡萄干。她知道这 $n\\times m$ 个小块中每一个小块上葡萄干的数目。她可以选择递给 Peter 的巧克力的顺序，也可以告诉 Peter 如何切（横切还是竖切）以及从哪里切。请告诉 Bonny 如何把巧克力切成一个个独立的小块，使她能够付给 Sly Peter 尽可能少的葡萄干。\n\n**任务**：编写一个程序，给定每个小块上葡萄干的数目，计算出 Bonny 要付给 Sly Peter 的最少的葡萄干的数目。", "inputFormat": "第一行两个由空格隔开的整数 $N, M$，分别表示巧克力的行数和列数。\n\n接下来 $N$ 行描述了每个小块上葡萄干的数目。其中第 $k$ 行描述了第 $k$ 行小块的巧克力。每行包含 $m$ 个整数，分别以一个空格隔开。这些整数描述了该行从左到右的小块。第 $k$ 行的第 $p$ 个整数表示位于第 $k$ 行第 $p$ 列的小块上的葡萄干数目 $R_{k, p}$。", "outputFormat": "一行一个整数，表示 Bonny 要付给 Sly Peter 的最少的葡萄干的数目。", "hint": "### 样例解释\n\n一种可能的代价为 $77$ 的切割方案如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zg74ypip.png)\n\n第一次切割将第三列和剩下来的巧克力分开了。Bonny 需要付给 Peter $29$ 个葡萄干。\n\n接下来 Bonny 把较小的那一块巧克力（有两小块，每一块都有 $5$ 个葡萄干）给 Peter，要求 Peter 切成两半并支付 $10$ 个葡萄干。\n\n在此之后，Bonny 给 Peter 剩下来的最大块（分别有 $2,  7, 1, 9$ 个葡萄干在它的四个小块上）。Bonny 要求 Peter 水平切割这一块，将第一行和第二行分开并付给他 $19$ 个葡萄干。\n\n此后 Bonny 给 Peter 左上角的块，支付 $9$ 个葡萄干。最后 Bonny 要求 Peter 将左下角的块分开，支付 $10$ 个葡萄干。\n\nBonny 的总代价是 $29 + 10 + 19 + 9 + 10 = 77$ 个葡萄干。没有其它安排切割的方案有更小的代价。\n\n### 数据范围与约定\n\n- 对于 $25\\%$ 的数据，$n,m\\leq 7$。\n- 对于 $100\\%$ 的数据，$1\\leq n,m\\leq 50$，$1\\leq R_{k, p}\\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P4851", "type": "P", "difficulty": 2, "samples": [["9 7 46 6 114 50 17 6 18 11 9118", "7"]], "limits": {"time": [233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "2018", "洛谷原创"], "title": "yyf hates ganhuodong", "background": "非酋yyf知道自己太非了，于是他开始爆肝活动。yyf终于成为了一名肝帝，但他还是想尽量节省 $\\mathrm{loveca}$ 的花费，不然的话如果花了太多 $\\mathrm{loveca}$，yyf会心疼的。", "description": "给你如下 $11$ 个正整数：\n\n$a$：完成一首歌曲所能获得的活动$\\mathrm{pt}$\n\n$b$：完成一首歌曲所需的 $\\mathrm{LP}$\n\n$c$：你开始肝活动时的 $\\mathrm{LP}$ 上限\n\n$d$：你开始肝活动时的 $\\mathrm{LP}$\n\n$e$：你开始肝活动时的经验值上限\n\n$f$：你开始肝活动时的经验值\n\n$g$：打一首歌能获得的经验值\n\n$h$：升一级增加的 $\\mathrm{LP}$ 上限\n\n$k$：升一级增加的经验值上限\n\n$x$：离活动结束的剩余时间（小时）\n\n$y$：你的目标活动$\\mathrm{pt}$\n\n假设yyf打歌不需要花费时间，每打一首歌需要花费一定的 $\\mathrm{LP}$ 来获取一定的活动$\\mathrm{pt}$ 以及一定的经验值。yyf的初始活动$\\mathrm{pt}$ 为 $0$\n\n$\\mathrm{LP}$ 每小时自动恢复 $1$ 点，$\\mathrm{LP}$ 达到上限后不会自动恢复（本题不需考虑这种情况），但可以通过后文所述方式超过上限。\n\n经验值达到上限后会升级，升级时会增加 $\\mathrm{LP}$上限并恢复“新的 $\\mathrm{LP}$上限”（增加后的）点 $\\mathrm{LP}$，恢复后的 $\\mathrm{LP}$ 可以超过 $\\mathrm{LP}$ 上限，且溢出的经验值会计入下一次升级，下一次升级所需要的经验值（经验值上限）会增加。\n\n可以随时耗费一个 $\\mathrm{loveca}$ 来获得当前 $\\mathrm{LP}$上限点 $\\mathrm{LP}$（可以超过上限）。\n\n你的目标是获得大于等于 $y$ 的活动$\\mathrm{pt}$，请求出最少需要耗费多少个 $\\mathrm{loveca}$。\n\n形式化地说，你初始的 $\\mathrm{LP}$ 可以视作 $d+x$，你有两种操作：\n\n1. 设你操作前的经验值为 $\\mathrm{exp}$，$\\mathrm{LP}$上限为 $\\mathrm{LPmax}$，$\\mathrm{LP}$ 值为 $l$（当且仅当 $l \\ge b$ 时能进行操作 $1$ ），经验值上限为 $\\mathrm{EXPmax}$，则在你操作后活动$\\mathrm{pt}$ 加上 $a$ 。\n- 若 $\\mathrm{exp+g \\ge EXPmax}$，则你的剩余 $\\mathrm{LP}$值为 $l-b+\\mathrm{LPmax}+h$，经验值为 \n $\\mathrm{(exp+g)\\bmod EXPmax}$，$\\mathrm{LP}$上限加上 $h$，经验值上限加上 $k$\n- 否则你的剩余 $\\mathrm{LP}$值为 $l-b$，经验值为 $\\mathrm{exp+g}$\n\n2. 设你操作前的 $\\mathrm{LP}$上限为 $\\mathrm{LPmax}$，$\\mathrm{LP}$值为 $l$ ，则你操作后的剩余 $\\mathrm{LP}$值为 $\\mathrm{LPmax}+l$\n\n你的目标为使你的活动$\\mathrm{pt}$ 大于等于 $y$ ，请求出最少需要的操作 $2$ 数量\n\n## 由于打歌不计时间可以在活动结束的瞬间打任意次歌，即进行任意次操作1，也就是初始LP可以视作d+x", "inputFormat": "共一行，为上述所有共 $11$ 个正整数，含义如上所述", "outputFormat": "一个正整数，代表最少需要耗费的 $\\mathrm{loveca}$ 数量", "hint": "$a∈[1,10]$\n\n$b∈[5,20]$\n\n$c∈[30,50]$\n\n$d∈[5,10]$\n\n$e∈[100,200]$\n\n$f∈[1,50]$\n\n$g∈[10,20]$\n\n$h∈[5,10]$\n\n$k∈[10,20]$\n\n$x∈[10,15]$\n\n$y∈[5000,10000]$", "locale": "zh-CN", "translations": {"en": {"title": "yyf hates ganhuodong", "background": "The unlucky guy (feiqiu) yyf knows he is too unlucky, so he starts grinding the event. yyf finally becomes a hardcore grinder (gandi), but he still wants to save as much $\\mathrm{loveca}$ as possible. Otherwise, if he spends too much $\\mathrm{loveca}$, yyf will feel very bad about it.", "description": "You are given the following $11$ positive integers:\n\n$a$: the event $\\mathrm{pt}$ gained by completing one song.\n\n$b$: the $\\mathrm{LP}$ required to complete one song.\n\n$c$: the initial $\\mathrm{LP}$ cap when you start grinding the event.\n\n$d$: the initial $\\mathrm{LP}$ when you start grinding the event.\n\n$e$: the initial experience cap when you start grinding the event.\n\n$f$: the initial experience when you start grinding the event.\n\n$g$: the experience gained from playing one song.\n\n$h$: the increase in the $\\mathrm{LP}$ cap when leveling up by one level.\n\n$k$: the increase in the experience cap when leveling up by one level.\n\n$x$: the remaining time until the event ends (in hours).\n\n$y$: your target event $\\mathrm{pt}$.\n\nAssume yyf can play songs without spending time. Each time you play a song, you need to spend some $\\mathrm{LP}$ to gain some event $\\mathrm{pt}$ and some experience. yyf starts with event $\\mathrm{pt}$ equal to $0$.\n\n$\\mathrm{LP}$ automatically recovers $1$ point per hour. When $\\mathrm{LP}$ reaches the cap, it will not recover automatically (you do not need to consider this situation in this problem), but it can exceed the cap using the method described later.\n\nWhen experience reaches the cap, you level up. When leveling up, your $\\mathrm{LP}$ cap increases and you recover “the new $\\mathrm{LP}$ cap” (after the increase) points of $\\mathrm{LP}$. The recovered $\\mathrm{LP}$ can exceed the $\\mathrm{LP}$ cap. Any overflow experience is carried over to the next level-up, and the required experience for the next level-up (the experience cap) will increase.\n\nYou can spend one $\\mathrm{loveca}$ at any time to gain $\\mathrm{LP}$ equal to your current $\\mathrm{LP}$ cap (this can exceed the cap).\n\nYour goal is to obtain event $\\mathrm{pt}$ greater than or equal to $y$. Find the minimum number of $\\mathrm{loveca}$ you need to spend.\n\nFormally, your initial $\\mathrm{LP}$ can be considered as $d+x$. You have two operations:\n\n1. Let the experience before the operation be $\\mathrm{exp}$, the $\\mathrm{LP}$ cap be $\\mathrm{LPmax}$, the current $\\mathrm{LP}$ be $l$ (you can perform operation $1$ if and only if $l \\ge b$), and the experience cap be $\\mathrm{EXPmax}$. After this operation, event $\\mathrm{pt}$ increases by $a$.\n- If $\\mathrm{exp+g \\ge EXPmax}$, then the remaining $\\mathrm{LP}$ becomes $l-b+\\mathrm{LPmax}+h$, the experience becomes $\\mathrm{(exp+g)\\bmod EXPmax}$, the $\\mathrm{LP}$ cap increases by $h$, and the experience cap increases by $k$.\n- Otherwise, the remaining $\\mathrm{LP}$ becomes $l-b$, and the experience becomes $\\mathrm{exp+g}$.\n\n2. Let the $\\mathrm{LP}$ cap before the operation be $\\mathrm{LPmax}$ and the current $\\mathrm{LP}$ be $l$. After this operation, the remaining $\\mathrm{LP}$ becomes $\\mathrm{LPmax}+l$.\n\nYour goal is to make your event $\\mathrm{pt}$ greater than or equal to $y$. Find the minimum number of times you need to perform operation $2$.\n\nSince playing songs does not take time, you can play any number of songs at the exact moment the event ends, i.e. you can perform operation $1$ any number of times. Therefore, the initial $\\mathrm{LP}$ can be considered as $d+x$.", "inputFormat": "A single line containing the above $11$ positive integers, with meanings as described above.", "outputFormat": "A single positive integer, representing the minimum number of $\\mathrm{loveca}$ that must be spent.", "hint": "$a∈[1,10]$\n\n$b∈[5,20]$\n\n$c∈[30,50]$\n\n$d∈[5,10]$\n\n$e∈[100,200]$\n\n$f∈[1,50]$\n\n$g∈[10,20]$\n\n$h∈[5,10]$\n\n$k∈[10,20]$\n\n$x∈[10,15]$\n\n$y∈[5000,10000]$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "yyf hates ganhuodong", "background": "非酋yyf知道自己太非了，于是他开始爆肝活动。yyf终于成为了一名肝帝，但他还是想尽量节省 $\\mathrm{loveca}$ 的花费，不然的话如果花了太多 $\\mathrm{loveca}$，yyf会心疼的。", "description": "给你如下 $11$ 个正整数：\n\n$a$：完成一首歌曲所能获得的活动$\\mathrm{pt}$\n\n$b$：完成一首歌曲所需的 $\\mathrm{LP}$\n\n$c$：你开始肝活动时的 $\\mathrm{LP}$ 上限\n\n$d$：你开始肝活动时的 $\\mathrm{LP}$\n\n$e$：你开始肝活动时的经验值上限\n\n$f$：你开始肝活动时的经验值\n\n$g$：打一首歌能获得的经验值\n\n$h$：升一级增加的 $\\mathrm{LP}$ 上限\n\n$k$：升一级增加的经验值上限\n\n$x$：离活动结束的剩余时间（小时）\n\n$y$：你的目标活动$\\mathrm{pt}$\n\n假设yyf打歌不需要花费时间，每打一首歌需要花费一定的 $\\mathrm{LP}$ 来获取一定的活动$\\mathrm{pt}$ 以及一定的经验值。yyf的初始活动$\\mathrm{pt}$ 为 $0$\n\n$\\mathrm{LP}$ 每小时自动恢复 $1$ 点，$\\mathrm{LP}$ 达到上限后不会自动恢复（本题不需考虑这种情况），但可以通过后文所述方式超过上限。\n\n经验值达到上限后会升级，升级时会增加 $\\mathrm{LP}$上限并恢复“新的 $\\mathrm{LP}$上限”（增加后的）点 $\\mathrm{LP}$，恢复后的 $\\mathrm{LP}$ 可以超过 $\\mathrm{LP}$ 上限，且溢出的经验值会计入下一次升级，下一次升级所需要的经验值（经验值上限）会增加。\n\n可以随时耗费一个 $\\mathrm{loveca}$ 来获得当前 $\\mathrm{LP}$上限点 $\\mathrm{LP}$（可以超过上限）。\n\n你的目标是获得大于等于 $y$ 的活动$\\mathrm{pt}$，请求出最少需要耗费多少个 $\\mathrm{loveca}$。\n\n形式化地说，你初始的 $\\mathrm{LP}$ 可以视作 $d+x$，你有两种操作：\n\n1. 设你操作前的经验值为 $\\mathrm{exp}$，$\\mathrm{LP}$上限为 $\\mathrm{LPmax}$，$\\mathrm{LP}$ 值为 $l$（当且仅当 $l \\ge b$ 时能进行操作 $1$ ），经验值上限为 $\\mathrm{EXPmax}$，则在你操作后活动$\\mathrm{pt}$ 加上 $a$ 。\n- 若 $\\mathrm{exp+g \\ge EXPmax}$，则你的剩余 $\\mathrm{LP}$值为 $l-b+\\mathrm{LPmax}+h$，经验值为 \n $\\mathrm{(exp+g)\\bmod EXPmax}$，$\\mathrm{LP}$上限加上 $h$，经验值上限加上 $k$\n- 否则你的剩余 $\\mathrm{LP}$值为 $l-b$，经验值为 $\\mathrm{exp+g}$\n\n2. 设你操作前的 $\\mathrm{LP}$上限为 $\\mathrm{LPmax}$，$\\mathrm{LP}$值为 $l$ ，则你操作后的剩余 $\\mathrm{LP}$值为 $\\mathrm{LPmax}+l$\n\n你的目标为使你的活动$\\mathrm{pt}$ 大于等于 $y$ ，请求出最少需要的操作 $2$ 数量\n\n## 由于打歌不计时间可以在活动结束的瞬间打任意次歌，即进行任意次操作1，也就是初始LP可以视作d+x", "inputFormat": "共一行，为上述所有共 $11$ 个正整数，含义如上所述", "outputFormat": "一个正整数，代表最少需要耗费的 $\\mathrm{loveca}$ 数量", "hint": "$a∈[1,10]$\n\n$b∈[5,20]$\n\n$c∈[30,50]$\n\n$d∈[5,10]$\n\n$e∈[100,200]$\n\n$f∈[1,50]$\n\n$g∈[10,20]$\n\n$h∈[5,10]$\n\n$k∈[10,20]$\n\n$x∈[10,15]$\n\n$y∈[5000,10000]$", "locale": "zh-CN"}}}
{"pid": "P4852", "type": "P", "difficulty": 6, "samples": [["3 3 3 3\n2 7 1 4 5 3 6 8 5 1 2 9", "36\n2 5 9"], ["2 5 2 2\n7 3 3 7 7 5 1 10 2", "41\n2 6 "]], "limits": {"time": [912, 912, 912, 912, 912, 912, 912, 912, 912, 912, 912], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2018", "单调队列", "洛谷原创", "Special Judge", "凸完全单调性（wqs 二分）", "前缀和", "队列"], "title": "yyf hates choukapai", "background": "非酋 yyf 总是抽不到自己想要的卡，因此还十分讨厌抽卡。但玩 sif 不可能不抽卡，于是他去请教了一下欧皇 dew。dew 告诉了他关于抽卡的秘密，然而 yyf 还是不知道如何让自己欧气尽量地大，于是他找到了你。", "description": "dew 告诉 yyf，人在抽每张卡时欧气值都是固定的，第 $i$ 张卡的欧气值为 $a_i$，而在连抽时，欧气值等于第一张卡的欧气值。\n\n“每次抽卡的欧气之和”指每次单抽的欧气之和加上每次连抽的欧气之和，一次连抽的欧气不加权，只计算一次。\n\nyyf 想 $c$ 连抽（连续抽 $c$ 张卡）$n$ 次，单抽 $m$ 次，因为一直单抽太累，**yyf 不想连续单抽超过 $d$ 次（可以连续单抽恰好 $d$ 次）**。共有 $c\\times n+m$ 张卡，抽卡的顺序不能改变，每张卡都必须且只能抽一次，只能改变哪几张卡连抽、哪几张卡单抽。那么 yyf 每次抽卡的欧气之和最多能达到多少，又如何实现呢？", "inputFormat": "第 $1$ 行 $4$ 个正整数 $n,m,c,d$。\n\n第 $2$ 行 $c\\times n+m$ 个正整数，其中第 $i$ 个正整数 $a_i$ 代表第 $i$ 张卡的欧气值。", "outputFormat": "第 $1$ 行一个正整数代表 yyf 每次抽卡的欧气之和的最大值。\n\n第 $2$ 行 $n$ 个正整数代表每次连抽的第一张卡的编号，如果有多种方案满足要求任意输出一种（如果不会输出方案也请在第二行随意输出 $n$ 个整数，否则可能 $0$ 分）。\n\n方案请升序输出。", "hint": "$20\\%$ 的数据有 $1 \\le n \\le 5$，$1 \\le m \\le 5$，$2 \\le c \\le 5$。\n\n$50\\%$ 的数据有 $1 \\le n \\le 40$，$1 \\le m \\le 200$，$2 \\le c \\le 20$。\n\n另有 $20\\%$ 的数据有 $d=m$。\n\n$100\\%$ 的数据有 $1 \\le n \\le 40$，$1 \\le m \\le 80000$，$2 \\le c \\le 3000$，$1 \\le a_i \\le 10000$，$1 \\le d \\le m$，$d\\times (n+1) \\ge m$。\n\n共 $10$ 个测试点，每个测试点答案错误 $0$ 分，答案正确方案错误 $6$ 分，答案正确方案正确 $10$ 分。\n\n样例解释：输出的方案就是样例解释了 QAQ。\n\n样例一：单抽 $1$，连抽 $2\\sim 4$，连抽 $5\\sim 7$，单抽 $8$，连抽 $9\\sim 11$，单抽 $12$，欧气值总和为 $2+7+5+8+5+9=36$。\n\n样例二：单抽 $1$，连抽 $2\\sim 3$，单抽 $4$，单抽 $5$，连抽 $6\\sim 7$，单抽 $8$，单抽 $9$，欧气值总和为 $7+3+7+7+5+10+2=41$。\n\n可以证明在满足条件的情况下上述两种方案是欧气值总和最大的。", "locale": "zh-CN", "translations": {"en": {"title": "yyf hates choukapai", "background": "Unlucky yyf can never draw the cards he wants, so he also really hates drawing cards. But when playing sif, it is impossible to avoid drawing cards, so he went to consult the lucky dew. dew told him the secret of drawing cards, but yyf still did not know how to make his luck as high as possible, so he came to you.", "description": "dew tells yyf that when a person draws each card, the luck value is fixed. The luck value of the $i$-th card is $a_i$. When doing a consecutive draw, the luck value equals the luck value of the first card in that consecutive draw.\n\n“The sum of luck for each draw operation” means: the sum of luck from every single draw plus the sum of luck from every consecutive draw. For one consecutive draw, its luck is not weighted; it is counted only once.\n\nyyf wants to do $c$-card consecutive draws (draw $c$ consecutive cards) for $n$ times, and single draws for $m$ times. Because doing single draws all the time is too tiring, **yyf does not want to do more than $d$ consecutive single draws (doing exactly $d$ consecutive single draws is allowed)**. There are $c \\times n + m$ cards in total. The drawing order cannot be changed. Each card must be drawn exactly once. You may only change which cards are drawn as consecutive draws and which are drawn as single draws. Then, what is the maximum possible sum of luck for all draw operations, and how can it be achieved?", "inputFormat": "Line $1$ contains $4$ positive integers $n, m, c, d$.\n\nLine $2$ contains $c \\times n + m$ positive integers, where the $i$-th integer $a_i$ represents the luck value of the $i$-th card.", "outputFormat": "Line $1$ outputs one positive integer representing the maximum possible sum of luck for yyf’s draw operations.\n\nLine $2$ outputs $n$ positive integers representing the indices of the first card of each consecutive draw. If there are multiple valid solutions, output any one. (If you cannot output a solution, please still output any $n$ integers on the second line, otherwise you may get $0$ points.)\n\nOutput the indices in increasing order.", "hint": "For $20\\%$ of the testdata, $1 \\le n \\le 5$, $1 \\le m \\le 5$, $2 \\le c \\le 5$.\n\nFor $50\\%$ of the testdata, $1 \\le n \\le 40$, $1 \\le m \\le 200$, $2 \\le c \\le 20$.\n\nAnother $20\\%$ of the testdata has $d = m$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 40$, $1 \\le m \\le 80000$, $2 \\le c \\le 3000$, $1 \\le a_i \\le 10000$, $1 \\le d \\le m$, $d \\times (n + 1) \\ge m$.\n\nThere are $10$ test points in total. For each test point: if the answer is wrong, you get $0$ points; if the answer is correct but the plan is wrong, you get $6$ points; if both the answer and the plan are correct, you get $10$ points.\n\nSample explanation: the output plan is exactly the sample explanation QAQ.\n\nSample 1: single draw $1$, consecutive draw $2 \\sim 4$, consecutive draw $5 \\sim 7$, single draw $8$, consecutive draw $9 \\sim 11$, single draw $12$. The total luck sum is $2 + 7 + 5 + 8 + 5 + 9 = 36$.\n\nSample 2: single draw $1$, consecutive draw $2 \\sim 3$, single draw $4$, single draw $5$, consecutive draw $6 \\sim 7$, single draw $8$, single draw $9$. The total luck sum is $7 + 3 + 7 + 7 + 5 + 10 + 2 = 41$.\n\nIt can be proven that, under the constraints, the above two plans achieve the maximum possible total luck sum.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "yyf hates choukapai", "background": "非酋 yyf 总是抽不到自己想要的卡，因此还十分讨厌抽卡。但玩 sif 不可能不抽卡，于是他去请教了一下欧皇 dew。dew 告诉了他关于抽卡的秘密，然而 yyf 还是不知道如何让自己欧气尽量地大，于是他找到了你。", "description": "dew 告诉 yyf，人在抽每张卡时欧气值都是固定的，第 $i$ 张卡的欧气值为 $a_i$，而在连抽时，欧气值等于第一张卡的欧气值。\n\n“每次抽卡的欧气之和”指每次单抽的欧气之和加上每次连抽的欧气之和，一次连抽的欧气不加权，只计算一次。\n\nyyf 想 $c$ 连抽（连续抽 $c$ 张卡）$n$ 次，单抽 $m$ 次，因为一直单抽太累，**yyf 不想连续单抽超过 $d$ 次（可以连续单抽恰好 $d$ 次）**。共有 $c\\times n+m$ 张卡，抽卡的顺序不能改变，每张卡都必须且只能抽一次，只能改变哪几张卡连抽、哪几张卡单抽。那么 yyf 每次抽卡的欧气之和最多能达到多少，又如何实现呢？", "inputFormat": "第 $1$ 行 $4$ 个正整数 $n,m,c,d$。\n\n第 $2$ 行 $c\\times n+m$ 个正整数，其中第 $i$ 个正整数 $a_i$ 代表第 $i$ 张卡的欧气值。", "outputFormat": "第 $1$ 行一个正整数代表 yyf 每次抽卡的欧气之和的最大值。\n\n第 $2$ 行 $n$ 个正整数代表每次连抽的第一张卡的编号，如果有多种方案满足要求任意输出一种（如果不会输出方案也请在第二行随意输出 $n$ 个整数，否则可能 $0$ 分）。\n\n方案请升序输出。", "hint": "$20\\%$ 的数据有 $1 \\le n \\le 5$，$1 \\le m \\le 5$，$2 \\le c \\le 5$。\n\n$50\\%$ 的数据有 $1 \\le n \\le 40$，$1 \\le m \\le 200$，$2 \\le c \\le 20$。\n\n另有 $20\\%$ 的数据有 $d=m$。\n\n$100\\%$ 的数据有 $1 \\le n \\le 40$，$1 \\le m \\le 80000$，$2 \\le c \\le 3000$，$1 \\le a_i \\le 10000$，$1 \\le d \\le m$，$d\\times (n+1) \\ge m$。\n\n共 $10$ 个测试点，每个测试点答案错误 $0$ 分，答案正确方案错误 $6$ 分，答案正确方案正确 $10$ 分。\n\n样例解释：输出的方案就是样例解释了 QAQ。\n\n样例一：单抽 $1$，连抽 $2\\sim 4$，连抽 $5\\sim 7$，单抽 $8$，连抽 $9\\sim 11$，单抽 $12$，欧气值总和为 $2+7+5+8+5+9=36$。\n\n样例二：单抽 $1$，连抽 $2\\sim 3$，单抽 $4$，单抽 $5$，连抽 $6\\sim 7$，单抽 $8$，单抽 $9$，欧气值总和为 $7+3+7+7+5+10+2=41$。\n\n可以证明在满足条件的情况下上述两种方案是欧气值总和最大的。", "locale": "zh-CN"}}}
{"pid": "P4853", "type": "P", "difficulty": 6, "samples": [["4 1 1\n3 70 3\n2 20 1\n2 2 1 1", "13.82"], ["5 0 2\n2 60 1\n2 10 2\n2 2 1 1 1", "19.084"], ["5 0 0\n2 1 0 2 2", "15"]], "limits": {"time": [666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "递推", "2018", "洛谷原创", "Special Judge", "期望"], "title": "yyf hates dagequ", "background": "非酋yyf在dew的指点下抽到了不错的卡，但他还是太非了，对于随机触发的技能，他总是无法触发。yyf想知道自己究竟有多非，所以他请你来计算他的期望得分，与自己的得分来比较。\n\n## 此题已放宽精度限制并显示错误答案和正确答案，请不要以此面向数据", "description": "给你一些卡牌的技能，技能分为$2$种类型：\n1. 加分，每连击$c$次有$p\\%$的概率加$s$分\n2. 改判，每连击$c$次有$p\\%$的概率触发强判定效果，持续$t$个节奏图标（设连击数为$c$的倍数时为第$i$个节奏图标，则强判定效果在第$[i+1,i+t]$个节奏图标被触发）\n\n这些技能在连击数为$c$的倍数且连击数不为$0$时有概率触发，多个技能可以同时触发\n\n其中，加分技能有 $\\mathrm{score}$ 个，改判技能有 $\\mathrm{judge}$ 个\n\n再给你$n$个节奏图标（yyf是按给出的顺序击打的）yyf击打的原始（相对于“强判定效果”修正后）结果，分为$2$，$1$，$0$三种\n\n在“强判定效果”的持续期间内所有的击打结果$1$会视作击打结果$2$，击打结果$0$仍视作击打结果$0$，击打结果$2$仍视作击打结果$2$ 。下文中的“击打结果”若无说明均指修正后的击打结果。\n\n“连击数”的定义为到目前为止连续的击打结果为$2$的次数（若这次的击打结果为$2$则这次击打也算入当前的连击数，否则当前的连击数为$0$）\n\n多个“强判定效果”可以重叠，但持续时间不会叠加（设当前“强判定效果”剩余时间为 $t_1$，此时同时触发两个“强判定效果”，持续时间分别为 $t_2$ 和 $t_3$ ，则下一次击打时的“强判定效果”剩余时间为 $\\max(t_1-1,t_2,t_3)$）。\n\n一次击打的得分为这次的击打结果乘以当前的连击数加一。即：设当前的击打结果为 $x$ ，当前的连击数为 $\\mathrm{combo}$ ，则这次击打的得分为 $\\mathrm{x*(combo+1)}$\n\n最终得分为每次（共$n$次）击打的得分之和加上加分技能的加分之和\n\n请求出yyf这次打歌的期望得分", "inputFormat": "第一行三个非负整数 $\\mathrm{n\\ score\\ judge}$\n\n下面的 $\\mathrm{score}$ 行，每行三个正整数 $c\\ p\\ s$，代表一个加分技能\n\n下面的 $\\mathrm{judge}$ 行，每行三个正整数 $c\\ p\\ t$，代表一个改判技能\n\n最后一行 $n$ 个整数，每个整数都∈$[0,2]$，第 $i$ 个整数代表第 $i$ 次击打的原始结果", "outputFormat": "共一行一个实数代表yyf的期望得分，与答案的相对误差在 $10^{-5}$ 内算对", "hint": "### 数据范围\n\n对于全部的测试点，有：$5 \\le n \\le 1000$，$0 \\le \\mathrm{score} \\le 1000$，$0 \\le \\mathrm{judge} \\le 1000$，$1 \\le c \\le 5$，$1 \\le p \\le 99$，$1 \\le s \\le 10$，$1 \\le t \\le 5$。\n\n| 测试点编号 | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | 特殊限制 | 测试点编号 | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | 特殊限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,0\\ \\,$ | 所有 $a_i$ 均为 $2$ | $11$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,9\\ \\,$ | 无 |\n| $2$ | $1000$ | $0$ | $0$ | 无 | $12$ | $1000$ | $2$ | $2$ | 无 |\n| $3$ | $1000$ | $1$ | $0$ | 无 | $13$ | $1000$ | $3$ | $3$ | 无 |\n| $4$ | $1000$ | $9$ | $0$ | 无 | $14$ | $1000$ | $3$ | $6$ | 无 |\n| $5$ | $1000$ | $1000$ | $0$ | 无 | $15$ | $1000$ | $1$ | $8$ | 所有 $c$ 均为 $1$ |\n| $6$ | $50$ | $1$ | $1$ | 无 | $16$ | $1000$ | $0$ | $9$ | 所有 $c$ 均为 $1$ |\n| $7$ | $50$ | $2$ | $2$ | 无 | $17$ | $1000$ | $1000$ | $1000$ | 所有 $c$ 均为 $1$ |\n| $8$ | $50$ | $4$ | $4$ | 无 | $18$ | $1000$ | $1000$ | $1000$ | 所有 $c$ 均为 $1$ |\n| $9$ | $50$ | $0$ | $9$ | 无 | $19$ | $1000$ | $1000$ | $1000$ | 无 |\n| $10$ | $50$ | $4$ | $5$ | 无 | $20$ | $1000$ | $1000$ | $1000$ | 无 |\n\n### 样例1解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lc16fxxt.png)\n\n### 样例2解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rd4khzu1.png)\n\n### 样例3解释\n\n第一次4分，第二次1分，第三次0分，第四次4分，第五次6分", "locale": "zh-CN", "translations": {"en": {"title": "yyf hates dagequ", "background": "The unlucky player yyf, guided by dew, drew some pretty good cards, but he is still too unlucky. For randomly triggered skills, he always fails to trigger them. yyf wants to know how unlucky he really is, so he asks you to compute his expected score and compare it with his actual score.\n\n## The precision limit for this problem has been relaxed, and both Wrong Answer and Correct Answer are shown. Please do not design solutions based on this.", "description": "You are given some card skills. There are $2$ types of skills:\n\n1. Bonus score: every time you reach a combo of $c$, there is a $p\\%$ chance to gain $s$ points.\n2. Judgment change: every time you reach a combo of $c$, there is a $p\\%$ chance to trigger a “strong judgment effect”, lasting for $t$ rhythm icons (suppose that when the combo count is a multiple of $c$, it corresponds to the $i$-th rhythm icon; then the strong judgment effect is applied on the $[i+1,i+t]$ rhythm icons).\n\nThese skills have a chance to trigger when the combo count is a multiple of $c$ and the combo count is not $0$. Multiple skills may trigger at the same time.\n\nAmong them, there are $\\mathrm{score}$ bonus-score skills and $\\mathrm{judge}$ judgment-change skills.\n\nYou are also given $n$ rhythm icons (yyf hits them in the given order). yyf’s original (relative to the result after applying the “strong judgment effect”) hit result for each icon is one of $2$, $1$, or $0$.\n\nDuring the duration of a “strong judgment effect”, all hit results $1$ are treated as hit results $2$. Hit result $0$ is still treated as $0$, and hit result $2$ is still treated as $2$. Unless otherwise stated, “hit result” below refers to the corrected hit result.\n\nThe definition of “combo count” is the number of consecutive hit results equal to $2$ so far (if the current hit result is $2$, then this hit is also counted into the current combo; otherwise, the current combo becomes $0$).\n\nMultiple “strong judgment effects” can overlap, but their durations do not stack. (Let the remaining time of the current “strong judgment effect” be $t_1$. If two “strong judgment effects” are triggered simultaneously now, with durations $t_2$ and $t_3$, then at the next hit, the remaining time becomes $\\max(t_1-1,t_2,t_3)$.)\n\nThe score of one hit equals the hit result multiplied by the current combo plus one. That is, let the current hit result be $x$ and the current combo be $\\mathrm{combo}$, then the score of this hit is $\\mathrm{x*(combo+1)}$.\n\nThe final score is the sum of the scores of all hits (a total of $n$ hits) plus the total bonus points gained from bonus-score skills.\n\nPlease compute the expected final score for yyf in this song.", "inputFormat": "The first line contains three non-negative integers $\\mathrm{n\\ score\\ judge}$.\n\nThe next $\\mathrm{score}$ lines each contain three positive integers $c\\ p\\ s$, describing a bonus-score skill.\n\nThe next $\\mathrm{judge}$ lines each contain three positive integers $c\\ p\\ t$, describing a judgment-change skill.\n\nThe last line contains $n$ integers, each in $[0,2]$. The $i$-th integer represents the original result of the $i$-th hit.", "outputFormat": "Output one real number in a single line, representing yyf’s expected score. Your answer is accepted if the relative error is within $10^{-5}$.", "hint": "### Constraints\n\nFor all test points: $5 \\le n \\le 1000$, $0 \\le \\mathrm{score} \\le 1000$, $0 \\le \\mathrm{judge} \\le 1000$, $1 \\le c \\le 5$, $1 \\le p \\le 99$, $1 \\le s \\le 10$, $1 \\le t \\le 5$.\n\n| Test Point ID | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | Special Constraint | Test Point ID | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | Special Constraint |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,0\\ \\,$ | All $a_i$ are $2$ | $11$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,9\\ \\,$ | None |\n| $2$ | $1000$ | $0$ | $0$ | None | $12$ | $1000$ | $2$ | $2$ | None |\n| $3$ | $1000$ | $1$ | $0$ | None | $13$ | $1000$ | $3$ | $3$ | None |\n| $4$ | $1000$ | $9$ | $0$ | None | $14$ | $1000$ | $3$ | $6$ | None |\n| $5$ | $1000$ | $1000$ | $0$ | None | $15$ | $1000$ | $1$ | $8$ | All $c$ are $1$ |\n| $6$ | $50$ | $1$ | $1$ | None | $16$ | $1000$ | $0$ | $9$ | All $c$ are $1$ |\n| $7$ | $50$ | $2$ | $2$ | None | $17$ | $1000$ | $1000$ | $1000$ | All $c$ are $1$ |\n| $8$ | $50$ | $4$ | $4$ | None | $18$ | $1000$ | $1000$ | $1000$ | All $c$ are $1$ |\n| $9$ | $50$ | $0$ | $9$ | None | $19$ | $1000$ | $1000$ | $1000$ | None |\n| $10$ | $50$ | $4$ | $5$ | None | $20$ | $1000$ | $1000$ | $1000$ | None |\n\n### Sample 1 Explanation\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lc16fxxt.png)\n\n### Sample 2 Explanation\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rd4khzu1.png)\n\n### Sample 3 Explanation\n\nThe first hit scores $4$ points, the second hit scores $1$ point, the third hit scores $0$ points, the fourth hit scores $4$ points, and the fifth hit scores $6$ points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "yyf hates dagequ", "background": "非酋yyf在dew的指点下抽到了不错的卡，但他还是太非了，对于随机触发的技能，他总是无法触发。yyf想知道自己究竟有多非，所以他请你来计算他的期望得分，与自己的得分来比较。\n\n## 此题已放宽精度限制并显示错误答案和正确答案，请不要以此面向数据", "description": "给你一些卡牌的技能，技能分为$2$种类型：\n1. 加分，每连击$c$次有$p\\%$的概率加$s$分\n2. 改判，每连击$c$次有$p\\%$的概率触发强判定效果，持续$t$个节奏图标（设连击数为$c$的倍数时为第$i$个节奏图标，则强判定效果在第$[i+1,i+t]$个节奏图标被触发）\n\n这些技能在连击数为$c$的倍数且连击数不为$0$时有概率触发，多个技能可以同时触发\n\n其中，加分技能有 $\\mathrm{score}$ 个，改判技能有 $\\mathrm{judge}$ 个\n\n再给你$n$个节奏图标（yyf是按给出的顺序击打的）yyf击打的原始（相对于“强判定效果”修正后）结果，分为$2$，$1$，$0$三种\n\n在“强判定效果”的持续期间内所有的击打结果$1$会视作击打结果$2$，击打结果$0$仍视作击打结果$0$，击打结果$2$仍视作击打结果$2$ 。下文中的“击打结果”若无说明均指修正后的击打结果。\n\n“连击数”的定义为到目前为止连续的击打结果为$2$的次数（若这次的击打结果为$2$则这次击打也算入当前的连击数，否则当前的连击数为$0$）\n\n多个“强判定效果”可以重叠，但持续时间不会叠加（设当前“强判定效果”剩余时间为 $t_1$，此时同时触发两个“强判定效果”，持续时间分别为 $t_2$ 和 $t_3$ ，则下一次击打时的“强判定效果”剩余时间为 $\\max(t_1-1,t_2,t_3)$）。\n\n一次击打的得分为这次的击打结果乘以当前的连击数加一。即：设当前的击打结果为 $x$ ，当前的连击数为 $\\mathrm{combo}$ ，则这次击打的得分为 $\\mathrm{x*(combo+1)}$\n\n最终得分为每次（共$n$次）击打的得分之和加上加分技能的加分之和\n\n请求出yyf这次打歌的期望得分", "inputFormat": "第一行三个非负整数 $\\mathrm{n\\ score\\ judge}$\n\n下面的 $\\mathrm{score}$ 行，每行三个正整数 $c\\ p\\ s$，代表一个加分技能\n\n下面的 $\\mathrm{judge}$ 行，每行三个正整数 $c\\ p\\ t$，代表一个改判技能\n\n最后一行 $n$ 个整数，每个整数都∈$[0,2]$，第 $i$ 个整数代表第 $i$ 次击打的原始结果", "outputFormat": "共一行一个实数代表yyf的期望得分，与答案的相对误差在 $10^{-5}$ 内算对", "hint": "### 数据范围\n\n对于全部的测试点，有：$5 \\le n \\le 1000$，$0 \\le \\mathrm{score} \\le 1000$，$0 \\le \\mathrm{judge} \\le 1000$，$1 \\le c \\le 5$，$1 \\le p \\le 99$，$1 \\le s \\le 10$，$1 \\le t \\le 5$。\n\n| 测试点编号 | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | 特殊限制 | 测试点编号 | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | 特殊限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,0\\ \\,$ | 所有 $a_i$ 均为 $2$ | $11$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,9\\ \\,$ | 无 |\n| $2$ | $1000$ | $0$ | $0$ | 无 | $12$ | $1000$ | $2$ | $2$ | 无 |\n| $3$ | $1000$ | $1$ | $0$ | 无 | $13$ | $1000$ | $3$ | $3$ | 无 |\n| $4$ | $1000$ | $9$ | $0$ | 无 | $14$ | $1000$ | $3$ | $6$ | 无 |\n| $5$ | $1000$ | $1000$ | $0$ | 无 | $15$ | $1000$ | $1$ | $8$ | 所有 $c$ 均为 $1$ |\n| $6$ | $50$ | $1$ | $1$ | 无 | $16$ | $1000$ | $0$ | $9$ | 所有 $c$ 均为 $1$ |\n| $7$ | $50$ | $2$ | $2$ | 无 | $17$ | $1000$ | $1000$ | $1000$ | 所有 $c$ 均为 $1$ |\n| $8$ | $50$ | $4$ | $4$ | 无 | $18$ | $1000$ | $1000$ | $1000$ | 所有 $c$ 均为 $1$ |\n| $9$ | $50$ | $0$ | $9$ | 无 | $19$ | $1000$ | $1000$ | $1000$ | 无 |\n| $10$ | $50$ | $4$ | $5$ | 无 | $20$ | $1000$ | $1000$ | $1000$ | 无 |\n\n### 样例1解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lc16fxxt.png)\n\n### 样例2解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rd4khzu1.png)\n\n### 样例3解释\n\n第一次4分，第二次1分，第三次0分，第四次4分，第五次6分", "locale": "zh-CN"}}}
{"pid": "P4854", "type": "P", "difficulty": 5, "samples": [["2 7\n1 2 1 14\n2 1 2 11\n2 2 1 18\n2 1 2 16\n2 1 2 12\n2 1 2 16\n2 1 3 13", "11"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "MloVtry的咸鱼树", "background": "签到~\n", "description": "俗话说种瓜得瓜，种豆得豆，MloVtry 把自己砍掉一半埋进了土里，于是它得到了一颗 $n$ 个点的咸鱼树。\n\n但是问题是由于 MloVtry 只舍得埋下一半的自己，所以这个咸鱼树是不完整的---甚至它碎裂成了 $m$ 条边。\n\n作为一条能够致癌的咸鱼，MloVtry 当然想要一颗咸鱼树来标榜自己的身份。\n\nMloVtry 大概估计出了连接两个点之间的代价，它想知道，最少需要多少代价才能拼出咸鱼树？\n\n值得注意的是，咸鱼树上的咸鱼边们对于 MloVtry 是很有意见的，所以每条边都会制定一个点集 $S$，只有 MloVtry 将 $S$ 这个特殊点集里的所有点都接入某个集合 $T$ 之后，这条边才可以被加入 $T$ 这个集合。\n\nMloVtry 把脑子埋进了地里，所以这个问题只能由你来解决了。\n", "inputFormat": "第一行 $2$ 个整数 $n,m$。\n\n接下来 $m$ 行，每行 $4$ 个整数 $u,v,S,l$，表示一条连接 $u$ 到 $v$ 的长为 $l$ 的双向边，要在已经选择了点集 $S$（这个集合用二进制数来表示，$1$ 号点对应第 $1$ 位，其余点同理）之后才能选择。\n", "outputFormat": "一行 $1$ 个整数，表示最小代价。当然，可能存在无解的情况，此时请输出 $-1$。\n", "hint": "$1\\le n\\le 15$，$1\\le m\\le n\\times (n+10)$。\n\n数据保证所有数值在 int 范围内。\n", "locale": "zh-CN", "translations": {"en": {"title": "MloVtry’s Salted Fish Tree", "background": "Sign-in~.", "description": "As the saying goes, you reap what you sow. MloVtry cut off half of itself and buried it in the ground, and thus obtained a “Salted Fish Tree” with $n$ vertices.\n\nHowever, because MloVtry only buried half of itself, this Salted Fish Tree is incomplete — it has even broken into $m$ edges.\n\nAs a salted fish that could cause cancer, MloVtry certainly wants a Salted Fish Tree to show its identity.\n\nMloVtry has roughly estimated the cost of connecting two vertices and wants to know the minimum total cost needed to assemble a Salted Fish Tree.\n\nNote that the edges on the Salted Fish Tree have strong opinions about MloVtry. Each edge specifies a vertex set $S$. Only after MloVtry has connected all vertices in this special set $S$ into some set $T$ can this edge be added to that set $T$.\n\nMloVtry buried its brain in the ground, so you have to solve this problem.", "inputFormat": "The first line contains $2$ integers $n, m$.\n\nThe next $m$ lines each contain $4$ integers $u, v, S, l$, denoting an undirected edge of length $l$ between $u$ and $v$, which can only be chosen after the vertex set $S$ has already been selected (this set is represented by a binary number; vertex $1$ corresponds to the first bit, and so on).", "outputFormat": "Output a single integer, the minimum total cost. If there is no solution, output $-1$.", "hint": "Constraints: $1 \\le n \\le 15$, $1 \\le m \\le n \\times (n+10)$.\n\nThe testdata guarantees that all values are within the range of a 32-bit int.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "MloVtry的咸鱼树", "background": "签到~\n", "description": "俗话说种瓜得瓜，种豆得豆，MloVtry 把自己砍掉一半埋进了土里，于是它得到了一颗 $n$ 个点的咸鱼树。\n\n但是问题是由于 MloVtry 只舍得埋下一半的自己，所以这个咸鱼树是不完整的---甚至它碎裂成了 $m$ 条边。\n\n作为一条能够致癌的咸鱼，MloVtry 当然想要一颗咸鱼树来标榜自己的身份。\n\nMloVtry 大概估计出了连接两个点之间的代价，它想知道，最少需要多少代价才能拼出咸鱼树？\n\n值得注意的是，咸鱼树上的咸鱼边们对于 MloVtry 是很有意见的，所以每条边都会制定一个点集 $S$，只有 MloVtry 将 $S$ 这个特殊点集里的所有点都接入某个集合 $T$ 之后，这条边才可以被加入 $T$ 这个集合。\n\nMloVtry 把脑子埋进了地里，所以这个问题只能由你来解决了。\n", "inputFormat": "第一行 $2$ 个整数 $n,m$。\n\n接下来 $m$ 行，每行 $4$ 个整数 $u,v,S,l$，表示一条连接 $u$ 到 $v$ 的长为 $l$ 的双向边，要在已经选择了点集 $S$（这个集合用二进制数来表示，$1$ 号点对应第 $1$ 位，其余点同理）之后才能选择。\n", "outputFormat": "一行 $1$ 个整数，表示最小代价。当然，可能存在无解的情况，此时请输出 $-1$。\n", "hint": "$1\\le n\\le 15$，$1\\le m\\le n\\times (n+10)$。\n\n数据保证所有数值在 int 范围内。\n", "locale": "zh-CN"}}}
{"pid": "P4855", "type": "P", "difficulty": 6, "samples": [["13 12 56\n10100 12208 11766 11872 11336 10815 10710 11872 11536 11988 10100 10908 10815 \n11 13\n1 3\n3 10\n1 7\n8 4\n7 11\n11 4\n5 2\n13 11\n13 6\n3 11\n11 10", "10044\n11932\n10918\n11280\n10044\n10759\n10827\n11874\n12152\n10759\n10044\n10713"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "MloVtry的idea", "background": "点击～\n", "description": "MloVtry是一个脑洞很大的人，它总会想出一些奇奇怪怪的idea。\n\n可问题是，MloVtry作为一个蒟蒻，很多时候都没办法解决自己提出的问题，所以MloVtry想出一套题的梦想一直被搁置。\n\n不过好在MloVtry有一些神犇朋友，他们强的没边，所以MloVtry一有机会就会向这些dalao们请教。\n\n现在MloVtry有n个idea，这n个idea在MloVtry二维的大脑里排成一列，每一个idea都有一个难度值，用a[i]表示，当然难度值越大越困难。\n\nMloVtry准备与q个神犇进行交♂易，但是MloVtry不想问一些过于简单的idea来降自己的B格，又不好意思用太难的、无法解决的idea来伤害自己与神犇之间的感情，所以它每次都会挑idea序列中的第k简单的idea来向神犇询问（也就是难度值第k小的那个idea）。\n\nMloVtry的脑子有坑，但是没关系，这个坑会反而会帮助MloVtry思考，不过这样数列的a[i]就会更新，具体的，设坑在第j个idea上，那么a[i]=a[i]-zz(i<=j);a[i]=i+a[i]-j(i>j)。\n\n如果仅仅如此MloVtry也不会感到迷茫，但关键的是这个坑还会不定时的跳跃，这就让MloVtry手足无措了---它不知道这个时候要问哪个问题了。\n\n现在MloVtry会给出你---它最好的朋友一些询问---一些二元组（at，k），表示脑洞位于at，且它想询问第k简单的idea，请你告诉MloVtry这个idea难度是多少。\n", "inputFormat": "第一行三个整数n,q,zz，含义见题面\n\n第二行n个整数a[1],a[2].....a[n]\n\n随后q行，每行两个整数表示at与k\n\n特别的，MloVtry是一个三维生物，所以它无法想象有人可以在时间轴上翻滚，所以at与k与上一个询问的答案的绝对值的异或值并对n取膜后再+1的值为本次的at和k。\n\n（也就是设lastans为上次询问答案，每一次at=(at^abs(lastans))%n+1,k=(k^abs(lastans))%n+1,并将lastans更新，初始lastans=0）\n", "outputFormat": "q行q个整数，表示对每个询问的回答\n", "hint": "各个值保证在int范围内。\n\n对于100%的数据，n,q<=6w。\n\n对于40%的数据，n,q<=1000。\n\nPS.可能有重复，例如\n\n1 1 1 1 1 0\n\n此时第1大、第2大....第5大的值都是1，第6大的值是0\n", "locale": "zh-CN", "translations": {"en": {"title": "MloVtry's Idea", "background": "Click ~.", "description": "MloVtry is very imaginative and often comes up with all kinds of strange ideas. However, as a \"jun ruo\" (noob), MloVtry often cannot solve the problems he proposes, so his dream of preparing a full problem set has been on hold.\n\nFortunately, MloVtry has some very strong friends (\"dalao\"), so he always asks them for help whenever he can.\n\nNow MloVtry has $n$ ideas arranged in a line in his 2D brain. Each idea has a difficulty value $a[i]$; larger values mean harder problems.\n\nMloVtry plans to consult $q$ experts, but he does not want to lower his standards by asking about ideas that are too easy, nor does he want to strain his relationships by asking about ideas that are too hard. Therefore, each time he will ask about the $k$-th easiest idea in the sequence (i.e., the idea with the $k$-th smallest difficulty).\n\nMloVtry has a “pit” in his brain. Oddly enough, this pit helps him think, but it causes the sequence $a[i]$ to be updated. Specifically, suppose the pit is at the $j$-th idea; then define a transformed array $b[i]$ by\n- if $i \\le j$, then $b[i] = a[i] - zz$;\n- if $i > j$, then $b[i] = i + a[i] - j$.\n\nIf that were all, MloVtry would not be confused. The problem is that the pit jumps unpredictably, so he does not know which idea to ask about at any given time.\n\nNow MloVtry gives you several queries—each is a pair $(at, k)$, meaning the pit is at position $at$, and he wants to ask about the $k$-th easiest idea. Please tell MloVtry what that idea’s difficulty is, i.e., the $k$-th smallest value in the transformed array $b$ defined by the current pit position.\n\nTo prevent “time-axis rolling,” the input $(at, k)$ for each query is obfuscated using the last answer. Let $lastans$ be the answer to the previous query (with $lastans = 0$ initially). For each query, before using $at$ and $k$, update them as follows:\n$at = ((at \\oplus |lastans|) \\bmod n) + 1$, \n$k = ((k \\oplus |lastans|) \\bmod n) + 1$,\nthen compute the answer and set $lastans$ to this answer.\n\nAll arrays are 1-indexed.", "inputFormat": "- The first line contains three integers $n$, $q$, $zz$.\n- The second line contains $n$ integers $a[1], a[2], \\dots, a[n]$.\n- The next $q$ lines each contain two integers $at$ and $k$. For each query, first transform the given $at$ and $k$ using $lastans$ as:\n  $at = ((at \\oplus |lastans|) \\bmod n) + 1$, \n  $k = ((k \\oplus |lastans|) \\bmod n) + 1$,\n  where $lastans$ is the previous query’s answer (with $lastans = 0$ initially).", "outputFormat": "Output $q$ lines, each containing one integer: the answer to each query.", "hint": "- All values fit in the 32-bit signed integer range.\n- For 100% of the testdata, $n, q \\le 60000$.\n- For 40% of the testdata, $n, q \\le 1000$.\n- There may be duplicate values. For example, for the array\n  1 1 1 1 1 0\n  the 1st smallest value is $0$, and the 2nd through 6th smallest values are all $1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "MloVtry的idea", "background": "点击～\n", "description": "MloVtry是一个脑洞很大的人，它总会想出一些奇奇怪怪的idea。\n\n可问题是，MloVtry作为一个蒟蒻，很多时候都没办法解决自己提出的问题，所以MloVtry想出一套题的梦想一直被搁置。\n\n不过好在MloVtry有一些神犇朋友，他们强的没边，所以MloVtry一有机会就会向这些dalao们请教。\n\n现在MloVtry有n个idea，这n个idea在MloVtry二维的大脑里排成一列，每一个idea都有一个难度值，用a[i]表示，当然难度值越大越困难。\n\nMloVtry准备与q个神犇进行交♂易，但是MloVtry不想问一些过于简单的idea来降自己的B格，又不好意思用太难的、无法解决的idea来伤害自己与神犇之间的感情，所以它每次都会挑idea序列中的第k简单的idea来向神犇询问（也就是难度值第k小的那个idea）。\n\nMloVtry的脑子有坑，但是没关系，这个坑会反而会帮助MloVtry思考，不过这样数列的a[i]就会更新，具体的，设坑在第j个idea上，那么a[i]=a[i]-zz(i<=j);a[i]=i+a[i]-j(i>j)。\n\n如果仅仅如此MloVtry也不会感到迷茫，但关键的是这个坑还会不定时的跳跃，这就让MloVtry手足无措了---它不知道这个时候要问哪个问题了。\n\n现在MloVtry会给出你---它最好的朋友一些询问---一些二元组（at，k），表示脑洞位于at，且它想询问第k简单的idea，请你告诉MloVtry这个idea难度是多少。\n", "inputFormat": "第一行三个整数n,q,zz，含义见题面\n\n第二行n个整数a[1],a[2].....a[n]\n\n随后q行，每行两个整数表示at与k\n\n特别的，MloVtry是一个三维生物，所以它无法想象有人可以在时间轴上翻滚，所以at与k与上一个询问的答案的绝对值的异或值并对n取膜后再+1的值为本次的at和k。\n\n（也就是设lastans为上次询问答案，每一次at=(at^abs(lastans))%n+1,k=(k^abs(lastans))%n+1,并将lastans更新，初始lastans=0）\n", "outputFormat": "q行q个整数，表示对每个询问的回答\n", "hint": "各个值保证在int范围内。\n\n对于100%的数据，n,q<=6w。\n\n对于40%的数据，n,q<=1000。\n\nPS.可能有重复，例如\n\n1 1 1 1 1 0\n\n此时第1大、第2大....第5大的值都是1，第6大的值是0\n", "locale": "zh-CN"}}}
{"pid": "P4856", "type": "P", "difficulty": 0, "samples": [["10 3\n1 1 1 1 1 1 1 1 1 1\n1 2\n1 8\n1 3\n3 6\n3 7\n6 10\n2 4\n2 5\n4 9\n0 1\n1 1 2\n0 1", "16/5\n5/2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000]}, "tags": [], "title": "MloVtry与jump ", "background": "浏览～\n", "description": "众所周知，MloVtry有很多纸片人老婆（我永远喜欢IA.jpg），不过很可惜，并不是所有人都是死宅，所以很多人无法理解MloVtry 的兴趣。\n\nVittorio就是一个坏文明，他十分喜欢刁难MloVtry。\n\n现在Vittorio构建了一个n个点的地图，MloVtry必须穿过这张图才能prpr到它的纸片人老婆。但是穿过地图听起来就太费力气了，于是MloVtry就咬住1号点狠狠一抖，把这张图甩成了一颗有根树。\n\nMloVtry是个好文明，它有一个高科技的设备---弹力装置---来帮助自己。具体的，如果MloVtry在i号点，这个装置会把它从当前点向下弹出a[i]（这个值被称为弹力值）个距离---我们认为1号点是在上方的，并且每条边的距离是1。不过问题是MloVtry并不能准确控制自己的落点，换言之降落在哪个位置是不确定的，但是MloVtry可以肯定的是降落的点一定可以让它不拐弯的走回出发的点（也就是只能落在子树内）---它一向认为自己是头耿直的生物。当然，由于a[i]是个正整数，所以它一定可以跳到它老婆的身旁。\n\n现在MloVtry有几个问题，它想知道假设它从x号点出发，赶到老婆身边的期望步数是多少，不过由于化图为树这个操作太耗费能量了，所以这个问题就只能交给它最好的好朋友---您这头神犇了。\n\n但是之前说过，Vittorio是个坏文明，他对弹力装置做了些手脚，每个弹力装置只有在没有树内的落点时才会跳出。并且他可能会偷偷更换掉一些节点上的弹力装置，这可能会带来一点难度，不过您一定没问题。\n", "inputFormat": "第1行两个整数n,q，表示这个图有n个节点，并且接下来有q个操作。\n\n第2行是一行整数，表示a[i]数组的初始值。\n\n接下来n-1行，每行两个整数u，v，表示有一条连接u，v的无向边。\n\n接下来q行，每行有3~2个整数，具体的：\n\n1  x  y   表示Vittorio将x号节点上的弹力装置换成了一个弹力值为y的弹力装置。\n\n0  x      表示MloVtry想知道从x号节点出发的期望步数是多少。\n", "outputFormat": "请对每个询问输出一个分数\n\n特别的，如果分母为1也请把它输出出来\n\n（如：2/1）\n", "hint": "样例解释\n\n第一个询问\n\n1-2-4-5-out\n\n1-2-5-out\n\n1-8-out\n\n1-3-6-10-out\n\n1-3-7-out\n\n总路径数为:5\n\n总跳跃次数为:16\n\n1-4-9-out\n\n1-5-out\n\n1-6-10-out\n\n1-7-out\n\n（由于存在树内的落点，所以1-out无法行走）\n\n\n总路径数为:4\n\n总跳跃次数为:10\n\n\nn<=100000 ,q<=200000\n\n不对a[i]的值做出保证\n\n对于30%的数据，有n<=1000\n\n对于50%的数据，有n<=10000\n\n\n特殊的\n\n对于20%的数据，有a[i]=1\n\n保证最后答案在2147483647的范围之内。\n\n数据保证在window环境下随机生成。\n", "locale": "zh-CN", "translations": {"en": {"title": "MloVtry and jump", "background": "Browsing~.", "description": "As we all know, MloVtry has many 2D waifus (I will always love IA.jpg). Unfortunately, not everyone is an otaku, so many people cannot understand MloVtry’s interests.\n\nVittorio is a “bad civilization” who loves to make things hard for MloVtry.\n\nNow Vittorio has built a map with $n$ nodes. MloVtry must traverse this map to prpr his 2D waifu. But traversing the map sounds too tiring, so MloVtry bites node $1$ and shakes hard, turning the map into a rooted tree with node $1$ at the top.\n\nMloVtry is a “good civilization” and has a high-tech device — a bounce device — to help. Specifically, if MloVtry is at node $i$, the device will bounce him downward by distance $a[i]$ (this value is called the bounce value). We consider node $1$ to be the root (on top), and each edge has length $1$. However, MloVtry cannot accurately control the landing point; in other words, where he lands is uncertain. What he can be sure of is that the landing node must allow him to walk straight back to the starting node without turning (that is, he can only land within the subtree of $i$). Since $a[i]$ is a positive integer, he will definitely be able to jump to his waifu’s side.\n\nMloVtry has a few questions: he wants to know, if he starts from node $x$, what is the expected number of steps to reach his waifu. Each jump counts as one step, and when there is more than one valid landing node inside the subtree of the current node at exact distance $a[i]$, the device chooses one uniformly at random. If there is no such node inside the tree, the jump goes “out”, and the process ends. Since transforming the graph into a tree consumes too much energy, this task can only be handed to his best friend — you.\n\nBut as mentioned earlier, Vittorio is a “bad civilization”. He has tampered with the bounce devices: a bounce device only jumps “out” when there is no landing node inside the tree. He may also secretly replace the bounce device at some nodes, which may add a bit of difficulty, but you will be fine.", "inputFormat": "- The first line contains two integers $n, q$, meaning the graph has $n$ nodes and there are $q$ operations.\n- The second line contains $n$ integers, the initial values of the array $a[i]$.\n- The next $n - 1$ lines each contain two integers $u, v$, indicating an undirected edge between $u$ and $v$.\n- The next $q$ lines each describe one operation, in one of the following formats:\n  - 1 x y: Vittorio replaces the bounce device at node $x$ with a new one whose bounce value is $y$, i.e., set $a[x] = y$.\n  - 0 x: MloVtry asks for the expected number of steps starting from node $x$.", "outputFormat": "For each query, output a fraction.\n\nIn particular, even if the denominator is $1$, you should still output it. For example: 2/1.", "hint": "Sample explanation.\n\nFirst query.\n\n1-2-4-5-out.\n\n1-2-5-out.\n\n1-8-out.\n\n1-3-6-10-out.\n\n1-3-7-out.\n\nTotal number of paths: 5.\n\nTotal number of jumps: 16.\n\nSecond query.\n\n1-4-9-out.\n\n1-5-out.\n\n1-6-10-out.\n\n1-7-out.\n\n(Since there exist landing nodes inside the tree, 1-out cannot occur.)\n\nTotal number of paths: 4.\n\nTotal number of jumps: 10.\n\nConstraints\n\n- $n \\le 100000$, $q \\le 200000$.\n- No bounds are guaranteed for $a[i]$.\n- For 30% of the testdata, $n \\le 1000$.\n- For 50% of the testdata, $n \\le 10000$.\n- Special: For 20% of the testdata, $a[i] = 1$.\n- It is guaranteed that the final answer is within the range of $2147483647$.\n- The testdata is randomly generated under the Windows environment.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "MloVtry与jump ", "background": "浏览～\n", "description": "众所周知，MloVtry有很多纸片人老婆（我永远喜欢IA.jpg），不过很可惜，并不是所有人都是死宅，所以很多人无法理解MloVtry 的兴趣。\n\nVittorio就是一个坏文明，他十分喜欢刁难MloVtry。\n\n现在Vittorio构建了一个n个点的地图，MloVtry必须穿过这张图才能prpr到它的纸片人老婆。但是穿过地图听起来就太费力气了，于是MloVtry就咬住1号点狠狠一抖，把这张图甩成了一颗有根树。\n\nMloVtry是个好文明，它有一个高科技的设备---弹力装置---来帮助自己。具体的，如果MloVtry在i号点，这个装置会把它从当前点向下弹出a[i]（这个值被称为弹力值）个距离---我们认为1号点是在上方的，并且每条边的距离是1。不过问题是MloVtry并不能准确控制自己的落点，换言之降落在哪个位置是不确定的，但是MloVtry可以肯定的是降落的点一定可以让它不拐弯的走回出发的点（也就是只能落在子树内）---它一向认为自己是头耿直的生物。当然，由于a[i]是个正整数，所以它一定可以跳到它老婆的身旁。\n\n现在MloVtry有几个问题，它想知道假设它从x号点出发，赶到老婆身边的期望步数是多少，不过由于化图为树这个操作太耗费能量了，所以这个问题就只能交给它最好的好朋友---您这头神犇了。\n\n但是之前说过，Vittorio是个坏文明，他对弹力装置做了些手脚，每个弹力装置只有在没有树内的落点时才会跳出。并且他可能会偷偷更换掉一些节点上的弹力装置，这可能会带来一点难度，不过您一定没问题。\n", "inputFormat": "第1行两个整数n,q，表示这个图有n个节点，并且接下来有q个操作。\n\n第2行是一行整数，表示a[i]数组的初始值。\n\n接下来n-1行，每行两个整数u，v，表示有一条连接u，v的无向边。\n\n接下来q行，每行有3~2个整数，具体的：\n\n1  x  y   表示Vittorio将x号节点上的弹力装置换成了一个弹力值为y的弹力装置。\n\n0  x      表示MloVtry想知道从x号节点出发的期望步数是多少。\n", "outputFormat": "请对每个询问输出一个分数\n\n特别的，如果分母为1也请把它输出出来\n\n（如：2/1）\n", "hint": "样例解释\n\n第一个询问\n\n1-2-4-5-out\n\n1-2-5-out\n\n1-8-out\n\n1-3-6-10-out\n\n1-3-7-out\n\n总路径数为:5\n\n总跳跃次数为:16\n\n1-4-9-out\n\n1-5-out\n\n1-6-10-out\n\n1-7-out\n\n（由于存在树内的落点，所以1-out无法行走）\n\n\n总路径数为:4\n\n总跳跃次数为:10\n\n\nn<=100000 ,q<=200000\n\n不对a[i]的值做出保证\n\n对于30%的数据，有n<=1000\n\n对于50%的数据，有n<=10000\n\n\n特殊的\n\n对于20%的数据，有a[i]=1\n\n保证最后答案在2147483647的范围之内。\n\n数据保证在window环境下随机生成。\n", "locale": "zh-CN"}}}
{"pid": "P4857", "type": "P", "difficulty": 4, "samples": [["10 3\n3 5 6\n", "10 9 7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "二分", "堆", "PA（波兰）"], "title": "[PA 2013] Konduktorzy", "background": "", "description": "一辆无限长的列车，有 $k$ 个检票员。每个检票员一次检验 $a_i$ 个车厢，初始时所有检票员在 $0$ 号车厢。\n\n列车长每次命令最靠左的编号最小的检票员向右走 $a_i$ 步，一共发出 $n$ 个命令，输出每个售票员走的最后一步是列车长的第几次命令。", "inputFormat": "第一行两个数 $n,k$。\n\n第二行 $k$ 个数，表示每个检票员一次检验的长度 $a_i$。", "outputFormat": "一行 $k$ 个整数，每个整数表示这个售票员走到最后一步是列车长的第几次命令。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^{13}$，$1\\le k\\le 10^5$，$k\\le n$，$1\\le a_i\\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2013] Konduktorzy", "background": "", "description": "一辆无限长的列车，有 $k$ 个检票员。每个检票员一次检验 $a_i$ 个车厢，初始时所有检票员在 $0$ 号车厢。\n\n列车长每次命令最靠左的编号最小的检票员向右走 $a_i$ 步，一共发出 $n$ 个命令，输出每个售票员走的最后一步是列车长的第几次命令。", "inputFormat": "第一行两个数 $n,k$。\n\n第二行 $k$ 个数，表示每个检票员一次检验的长度 $a_i$。", "outputFormat": "一行 $k$ 个整数，每个整数表示这个售票员走到最后一步是列车长的第几次命令。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^{13}$，$1\\le k\\le 10^5$，$k\\le n$，$1\\le a_i\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4858", "type": "P", "difficulty": 7, "samples": [["4 5\n_XXX_\nXXXX_\nXXXXX\n_XXXX", "2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2013", "PA（波兰）"], "title": "[PA 2013] Karty", "background": "", "description": "给定 $n\\times m$ 的矩形，每个点仅可能为 `_` 或 `X`， 选出一个最大的 $r\\times c$ 的矩形，使得多个 $r\\times c$ 的矩形能够(可以重叠的)覆盖全部 `X` 部分，不覆盖 `_` 部分。", "inputFormat": "第一行 $n,m$ 如题意所述。\n\n接下来 $n$ 行，每行一个长为 $m$ 的字符串描述这个矩阵。", "outputFormat": "输出一行，两个数 $r,c$，用空格隔开。\n\n同时有多个面积最大的要输出 $r$ 最小的那个。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 2.5\\times 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2013] Karty", "background": "", "description": "给定 $n\\times m$ 的矩形，每个点仅可能为 `_` 或 `X`， 选出一个最大的 $r\\times c$ 的矩形，使得多个 $r\\times c$ 的矩形能够(可以重叠的)覆盖全部 `X` 部分，不覆盖 `_` 部分。", "inputFormat": "第一行 $n,m$ 如题意所述。\n\n接下来 $n$ 行，每行一个长为 $m$ 的字符串描述这个矩阵。", "outputFormat": "输出一行，两个数 $r,c$，用空格隔开。\n\n同时有多个面积最大的要输出 $r$ 最小的那个。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 2.5\\times 10^3$。", "locale": "zh-CN"}}}
{"pid": "P4859", "type": "P", "difficulty": 6, "samples": [["4 2\n5 35 15 45\n40 20 10 30\n", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "数学", "组合数学", "排列组合", "二项式定理"], "title": "已经没有什么好害怕的了", "background": "", "description": "已经使 Madoka 有签订契约，和自己一起战斗的想法后，Mami 忽然感到自己不再是孤单一人了呢。\n\n于是，之前的谨慎的战斗作风也消失了，在对 Charlotte 的傀儡使用终曲——Tiro Finale 后，Mami 面临着即将被 Charlotte 的本体吃掉的局面。\n\n这时，已经多次面对过 Charlotte 的 Homura 告诉了学 OI 的你这样一个性质：Charlotte 的结界中有两种具有能量的元素，一种是“糖果”，另一种是“药片”，各有 $n$ 个。在 Charlotte 发动进攻前，“糖果”和“药片”会两两配对，若恰好糖果比药片能量大的组数比“药片”比“糖果”能量大的组数多 $k$ 组，则在这种局面下，Charlotte 的攻击会丟失，从而 Mami 仍有消灭 Charlotte 的可能。\n\n你必须根据 Homura 告诉你的“糖果”和“药片”的能量的信息迅速告诉 Homura 这种情况的个数.", "inputFormat": "第一行两个整数 $n,k$，含义如题目所描述。\n\n接下来一行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个糖果的能量 $a_i$。\n\n接下来 $n$ 个整数，第 $j$ 个数表示第 $j$ 个药片的能量 $b_j$。\n\n保证上面两行不会有重复的数字。", "outputFormat": "一个答案，表示消灭 Charlotte 的情况个数，需要对 $10^9+9$ 取模。", "hint": "【样例解释】\n\n正确的组合为：\n\n(5-40,35-20,15-10,45-30)，    \n(5-40,45-20,15-10,35-30)，   \n(45-40,5-20,15-10,35-30)，   \n(45-40,35-20,15-10,5-30).   \n\n【数据范围】\n对于 $100\\%$ 的数据，$1 \\le n \\le 2000$，$0 \\le k \\le n$，$1\\le a_i,b_j\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "There Is Nothing to Be Afraid of Anymore.", "background": "", "description": "After making Madoka want to sign a contract and fight together, Mami suddenly felt that she was no longer alone.\n\nSo her previously cautious fighting style disappeared. After using the finale—Tiro Finale—on Charlotte’s puppet, Mami ended up in a situation where she was about to be eaten by Charlotte’s true body.\n\nAt this moment, Homura, who has faced Charlotte many times, told you, who study OI, the following property: In Charlotte’s barrier, there are two kinds of energy-bearing elements: “candies” and “pills”, $n$ of each. Before Charlotte launches an attack, the “candies” and “pills” will be paired up one-to-one. If the number of pairs where the candy’s energy is greater than the pill’s energy is exactly $k$ more than the number of pairs where the pill’s energy is greater than the candy’s energy, then in this situation, Charlotte’s attack will miss, and Mami will still have a chance to destroy Charlotte.\n\nYou must, based on the energy information of the “candies” and “pills” that Homura tells you, quickly tell Homura how many such situations there are.", "inputFormat": "The first line contains two integers $n,k$, with meanings as described in the statement.\n\nThe next line contains $n$ integers. The $i$-th number represents the energy of the $i$-th candy.\n\nThe next line contains $n$ integers. The $j$-th number represents the energy of the $j$-th pill.\n\nIt is guaranteed that there are no duplicate numbers within each of the above two lines.", "outputFormat": "Output one integer, the number of situations in which Charlotte can be destroyed, modulo $10^9+9$.", "hint": "[Sample Explanation]\n\nThe correct matchings are:\n\n(5-40,35-20,15-10,45-30),  \n(5-40,45-20,15-10,35-30),  \n(45-40,5-20,15-10,35-30),  \n(45-40,35-20,15-10,5-30).\n\n[Constraints]  \nFor $100\\%$ of the testdata, $1 \\le n \\le 2000$, $0 \\le k \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "已经没有什么好害怕的了", "background": "", "description": "已经使 Madoka 有签订契约，和自己一起战斗的想法后，Mami 忽然感到自己不再是孤单一人了呢。\n\n于是，之前的谨慎的战斗作风也消失了，在对 Charlotte 的傀儡使用终曲——Tiro Finale 后，Mami 面临着即将被 Charlotte 的本体吃掉的局面。\n\n这时，已经多次面对过 Charlotte 的 Homura 告诉了学 OI 的你这样一个性质：Charlotte 的结界中有两种具有能量的元素，一种是“糖果”，另一种是“药片”，各有 $n$ 个。在 Charlotte 发动进攻前，“糖果”和“药片”会两两配对，若恰好糖果比药片能量大的组数比“药片”比“糖果”能量大的组数多 $k$ 组，则在这种局面下，Charlotte 的攻击会丟失，从而 Mami 仍有消灭 Charlotte 的可能。\n\n你必须根据 Homura 告诉你的“糖果”和“药片”的能量的信息迅速告诉 Homura 这种情况的个数.", "inputFormat": "第一行两个整数 $n,k$，含义如题目所描述。\n\n接下来一行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个糖果的能量 $a_i$。\n\n接下来 $n$ 个整数，第 $j$ 个数表示第 $j$ 个药片的能量 $b_j$。\n\n保证上面两行不会有重复的数字。", "outputFormat": "一个答案，表示消灭 Charlotte 的情况个数，需要对 $10^9+9$ 取模。", "hint": "【样例解释】\n\n正确的组合为：\n\n(5-40,35-20,15-10,45-30)，    \n(5-40,45-20,15-10,35-30)，   \n(45-40,5-20,15-10,35-30)，   \n(45-40,35-20,15-10,5-30).   \n\n【数据范围】\n对于 $100\\%$ 的数据，$1 \\le n \\le 2000$，$0 \\le k \\le n$，$1\\le a_i,b_j\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4860", "type": "P", "difficulty": 3, "samples": [["3\n5\n7\n14", "October wins!\nOctober wins!\nOctober wins!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["博弈论"], "title": "Roy&October之取石子II", "background": "Roy 和 October 两人在玩另一个取石子的游戏。（第一季请看 P4018）", "description": "游戏规则是这样的：共有 $n$ 个石子，两人每次都只能取 $p^k$ 个（$p$ 为质数，$k=0$ 或 $1$，且 $p^k$ 小于等于当前剩余石子数），谁取走最后一个石子，谁就赢了。\n\n现在 October 先取，问她有没有必胜策略。\n\n若她有必胜策略，输出一行 `October wins!` ；否则输出一行 `Roy wins!`。", "inputFormat": "第一行一个正整数 $T$，表示测试点组数。\n\n第 $2$ 行到第 $T+1$ 行，一行一个正整数 $n$，表示石子个数。", "outputFormat": "$T$ 行，每行分别为 `October wins!` 或 `Roy wins!`。\n", "hint": "对于 $30\\%$ 的数据，$1 \\le n \\le 30$；\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 10^6$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^7，1 \\le T \\le 10^5$。\n\n花絮：由于出题人懒得造数据，就把 P4018 的输入直接拿来了 ovo", "locale": "zh-CN", "translations": {"en": {"title": "Roy & October’s Stone Taking II", "background": "Roy and October are playing another stone-taking game. (For Season 1, see P4018.)", "description": "The rules are as follows: there are $n$ stones in total. Each turn, a player can only take $p^k$ stones, where $p$ is a prime number, $k = 0$ or $1$, and $p^k$ is less than or equal to the number of stones currently remaining. Whoever takes the last stone wins.\n\nNow October moves first. Determine whether she has a winning strategy.\n\nIf she has a winning strategy, output one line `October wins!`; otherwise output one line `Roy wins!`.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nLines $2$ to $T+1$ each contain a positive integer $n$, the number of stones.", "outputFormat": "Output $T$ lines. Each line should be `October wins!` or `Roy wins!`.", "hint": "For $30\\%$ of the testdata, $1 \\le n \\le 30$.\n\nFor $60\\%$ of the testdata, $1 \\le n \\le 10^6$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 5 \\times 10^7$, $1 \\le T \\le 10^5$.\n\nExtra: Since the problem setter was too lazy to generate testdata, they directly reused the input from P4018, ovo.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Roy&October之取石子II", "background": "Roy 和 October 两人在玩另一个取石子的游戏。（第一季请看 P4018）", "description": "游戏规则是这样的：共有 $n$ 个石子，两人每次都只能取 $p^k$ 个（$p$ 为质数，$k=0$ 或 $1$，且 $p^k$ 小于等于当前剩余石子数），谁取走最后一个石子，谁就赢了。\n\n现在 October 先取，问她有没有必胜策略。\n\n若她有必胜策略，输出一行 `October wins!` ；否则输出一行 `Roy wins!`。", "inputFormat": "第一行一个正整数 $T$，表示测试点组数。\n\n第 $2$ 行到第 $T+1$ 行，一行一个正整数 $n$，表示石子个数。", "outputFormat": "$T$ 行，每行分别为 `October wins!` 或 `Roy wins!`。\n", "hint": "对于 $30\\%$ 的数据，$1 \\le n \\le 30$；\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 10^6$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^7，1 \\le T \\le 10^5$。\n\n花絮：由于出题人懒得造数据，就把 P4018 的输入直接拿来了 ovo", "locale": "zh-CN"}}}
{"pid": "P4861", "type": "P", "difficulty": 5, "samples": [["11 2", "10"], ["6 26", "Let's go Blue Jays!"]], "limits": {"time": [280, 280, 280, 280, 280, 280, 280, 280, 280, 280], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "枚举", "中国剩余定理 CRT"], "title": "按钮", "background": "Ada被关在了一个房间里。", "description": "房间的铁门上有一个按钮，还有一个显示屏显示着“1”。    \n旁边还有一行小字：“这是一个高精度M进制计算器，每按一次按钮，屏幕上的数便会乘以K。当个位数再次变为1时，门就开了。”    \n由于Ada急于出去，所以你要在1s之内求出她的最小按键次数。", "inputFormat": "一行，两个整数M和K。", "outputFormat": "一行一个数字，表示最小按键次数。   \n如果无论Ada按多少次都无法让门打开，输出\"Let's go Blue Jays!\"（不含引号）。", "hint": "对于30%的数据，$2\\leq M,K\\leq10^4$。    \n对于100%的数据，$2\\leq M,K\\leq2\\times 10^{9}$。  \nupdate：我们不认为个位为11,21,...为问题的解（例如，11在16进制下记为B）    ", "locale": "zh-CN", "translations": {"en": {"title": "Button", "background": "Ada has been locked in a room.", "description": "On the room’s iron door, there is a button and a display showing “1”.  \nNext to it, there is a line of small text: “This is a high-precision base-$M$ calculator. Each time you press the button, the number on the screen will be multiplied by $K$. When the last digit becomes 1 again, the door will open.”  \nSince Ada is eager to get out, you need to find the minimum number of button presses within 1 second.", "inputFormat": "One line with two integers $M$ and $K$.", "outputFormat": "Output one number on one line, the minimum number of button presses.  \nIf no matter how many times Ada presses the button the door cannot be opened, output \"Let's go Blue Jays!\" (without quotes).", "hint": "For 30% of the testdata, $2\\leq M,K\\leq10^4$.  \nFor 100% of the testdata, $2\\leq M,K\\leq2\\times 10^{9}$.  \nUpdate: we do not consider numbers whose last digit is 11, 21, ... as valid solutions (for example, 11 is written as B in base 16).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "按钮", "background": "Ada被关在了一个房间里。", "description": "房间的铁门上有一个按钮，还有一个显示屏显示着“1”。    \n旁边还有一行小字：“这是一个高精度M进制计算器，每按一次按钮，屏幕上的数便会乘以K。当个位数再次变为1时，门就开了。”    \n由于Ada急于出去，所以你要在1s之内求出她的最小按键次数。", "inputFormat": "一行，两个整数M和K。", "outputFormat": "一行一个数字，表示最小按键次数。   \n如果无论Ada按多少次都无法让门打开，输出\"Let's go Blue Jays!\"（不含引号）。", "hint": "对于30%的数据，$2\\leq M,K\\leq10^4$。    \n对于100%的数据，$2\\leq M,K\\leq2\\times 10^{9}$。  \nupdate：我们不认为个位为11,21,...为问题的解（例如，11在16进制下记为B）    ", "locale": "zh-CN"}}}
{"pid": "P4862", "type": "P", "difficulty": 5, "samples": [["2 1 2\n3\n6", "3\n5"], ["5 3 1\n3", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "Fibonacci 数列", "线性递推"], "title": "猜数", "background": "Iris 和 Beryl 两人在玩一个猜数的游戏。", "description": "游戏是这样进行的：给定一个正整数 $n$，Iris 在 $S=\\{1,2,...,n\\}$ 中选择一个数 $m$。  \n\n然后，Iris 要如实回答 Beryl 的若干个问题，这些问题的形式是：“$m$ 是集合 $A$ 中的元素吗？”其中 $A\\subseteq S$。   \n如果Iris回答“是”，则 Beryl 要给 Iris $a$ 元钱；否则，Beryl 要给 Iris $b$ 元钱。（数据保证 $a>b$）\n\n那么，Beryl 至少准备多少钱，就一定能确定 Iris 心中的数字呢？", "inputFormat": "第一行：两个正整数 $a$ 和 $b$ 以及数据组数 $t$。   \n接下来 $t$ 行，每行一个给定的正整数 $n$，意义如上所述。", "outputFormat": "$t$ 行，表示对于每一组数据，Beryl 需要准备的最小钱数。", "hint": "【样例1的第1组数据解释】 \n\nBeryl先对集合 $\\{1\\}$ 进行询问，若得到的答案是“是”，则已经确定 Iris 选的数为 $1$，需要 $2$ 元。若得到的答案是“否”，则再对集合 $\\{2\\}$ 进行询问，显然运气最差要再花 $2$ 元，共 $3$ 元，故答案为 $3$ 元。   \n\n----   \n\n【数据范围】  \n\n| 测试点编号 | $n$ |$t$| $a$,$b$ |\n| :----------- | :----------- | :----------- | :----------- |\n| 1 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 2 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 3 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 4 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 5 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 6 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n|7  | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 8 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 9 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 10 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n\n", "locale": "zh-CN", "translations": {"en": {"title": "Number Guessing.", "background": "Iris and Beryl are playing a number guessing game.", "description": "The game works as follows: given a positive integer $n$, Iris chooses a number $m$ from $S=\\{1,2,...,n\\}$.\n\nThen, Iris must answer Beryl’s questions truthfully. Each question is of the form: “Is $m$ an element of set $A$?” where $A\\subseteq S$.  \nIf Iris answers “Yes”, then Beryl must give Iris $a$ yuan; otherwise, Beryl must give Iris $b$ yuan. (The testdata guarantees $a>b$.)\n\nHow much money does Beryl need to prepare at least, to be sure that she can determine the number in Iris’s mind?", "inputFormat": "The first line contains two positive integers $a$ and $b$, and the number of test cases $t$.  \nThe next $t$ lines each contain a given positive integer $n$, with the meaning as described above.", "outputFormat": "Output $t$ lines. For each test case, output the minimum amount of money Beryl needs to prepare.", "hint": "[Explanation for the 1st test case of Sample 1]\n\nBeryl first asks about the set $\\{1\\}$. If the answer is “Yes”, then Iris’s number is confirmed to be $1$, and Beryl needs $2$ yuan. If the answer is “No”, then Beryl asks about the set $\\{2\\}$. Clearly, in the worst case she needs to spend another $2$ yuan, for a total of $3$ yuan, so the answer is $3$ yuan.\n\n----\n\n[Constraints]\n\n| Test Point ID | $n$ | $t$ | $a$,$b$ |\n| :----------- | :----------- | :----------- | :----------- |\n| 1 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 2 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 3 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 4 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 5 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 6 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 7 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 8 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 9 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 10 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "猜数", "background": "Iris 和 Beryl 两人在玩一个猜数的游戏。", "description": "游戏是这样进行的：给定一个正整数 $n$，Iris 在 $S=\\{1,2,...,n\\}$ 中选择一个数 $m$。  \n\n然后，Iris 要如实回答 Beryl 的若干个问题，这些问题的形式是：“$m$ 是集合 $A$ 中的元素吗？”其中 $A\\subseteq S$。   \n如果Iris回答“是”，则 Beryl 要给 Iris $a$ 元钱；否则，Beryl 要给 Iris $b$ 元钱。（数据保证 $a>b$）\n\n那么，Beryl 至少准备多少钱，就一定能确定 Iris 心中的数字呢？", "inputFormat": "第一行：两个正整数 $a$ 和 $b$ 以及数据组数 $t$。   \n接下来 $t$ 行，每行一个给定的正整数 $n$，意义如上所述。", "outputFormat": "$t$ 行，表示对于每一组数据，Beryl 需要准备的最小钱数。", "hint": "【样例1的第1组数据解释】 \n\nBeryl先对集合 $\\{1\\}$ 进行询问，若得到的答案是“是”，则已经确定 Iris 选的数为 $1$，需要 $2$ 元。若得到的答案是“否”，则再对集合 $\\{2\\}$ 进行询问，显然运气最差要再花 $2$ 元，共 $3$ 元，故答案为 $3$ 元。   \n\n----   \n\n【数据范围】  \n\n| 测试点编号 | $n$ |$t$| $a$,$b$ |\n| :----------- | :----------- | :----------- | :----------- |\n| 1 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 2 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 3 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 4 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 5 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 6 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n|7  | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 8 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 9 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 10 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n\n", "locale": "zh-CN"}}}
{"pid": "P4863", "type": "P", "difficulty": 5, "samples": [["1 1", "-1"], ["2 2", "-1"], ["3 3", "-3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "枚举", "分块"], "title": "JerryC Loves Driving", "background": "JerryC 最近迷上了狂野飙车！！！", "description": "众所周知，JerryC 是一位疯狂的 Female。他最近买了一台跑车（~~但是却没有驾驶证~~），所以他就只能到一个偏僻的地方练习开车。\n\n当然，JerryC 是不可能正常开车的。她首先决定要开 $(B-A+1)$ 段路程的车，第 $i$ 段路程的速度都是从 $1$ 开始加速的。每一秒会加上 $1$ 的单位速度。当速度加到 $(i+A-1)$ 的时候，JerryC 就会把速度降为 $1$，然后开始下一段路程。\n\n对于第 $i$ 段路程的第 $j$ 秒，JerryC 获得的愉悦值为$\\left\\lfloor \\frac{i+A-1}{j} \\right\\rfloor \\times (-1)^j$。（反正 JerryC 就是不喜欢奇数。）\n\n现在请你求出 JerryC 最后的总愉悦值。\n\nP.s. ：\n\n如果上面的东西没有看懂，那么简单版就是这个意思：\n\n给出 $A, B$，求出下面式子的值。\n\n$$\\sum_{i=A}^B \\sum_{j=1}^{i}\\left\\lfloor \\frac{i}{j} \\right\\rfloor \\times (-1)^j$$", "inputFormat": "一行，两个正整数 $A, B$。", "outputFormat": "一行，一个整数表示最终的愉悦值。", "hint": "对于 $50\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 5\\times10^3$；  \n对于 $70\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 5\\times10^4$；  \n对于 $100\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 2\\times10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "JerryC Loves Driving", "background": "JerryC has recently become obsessed with Asphalt Racing.", "description": "As everyone knows, JerryC is a crazy Female. He recently bought a sports car (~~but he does not have a driver’s license~~), so he can only practice driving in a remote place.\n\nOf course, JerryC is not going to drive normally. She first decides to drive $(B-A+1)$ segments of road. In the $i$-th segment, the speed starts accelerating from $1$. Each second, it increases by $1$ unit of speed. When the speed reaches $(i+A-1)$, JerryC will reduce the speed back to $1$, and then start the next segment.\n\nFor the $j$-th second of the $i$-th segment, the pleasure value JerryC gets is $\\left\\lfloor \\frac{i+A-1}{j} \\right\\rfloor \\times (-1)^j$. (Anyway, JerryC just does not like odd numbers.)\n\nNow please compute JerryC’s final total pleasure value.\n\nP.s.:\n\nIf you did not understand the above, then the simplified version is:\n\nGiven $A, B$, compute the value of the following expression.\n\n$$\\sum_{i=A}^B \\sum_{j=1}^{i}\\left\\lfloor \\frac{i}{j} \\right\\rfloor \\times (-1)^j$$", "inputFormat": "One line with two positive integers $A, B$.", "outputFormat": "One line with one integer, representing the final pleasure value.", "hint": "For $50\\%$ of the testdata, $1 \\leqslant A \\leqslant B \\leqslant 5\\times10^3$.  \nFor $70\\%$ of the testdata, $1 \\leqslant A \\leqslant B \\leqslant 5\\times10^4$.  \nFor $100\\%$ of the testdata, $1 \\leqslant A \\leqslant B \\leqslant 2\\times10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "JerryC Loves Driving", "background": "JerryC 最近迷上了狂野飙车！！！", "description": "众所周知，JerryC 是一位疯狂的 Female。他最近买了一台跑车（~~但是却没有驾驶证~~），所以他就只能到一个偏僻的地方练习开车。\n\n当然，JerryC 是不可能正常开车的。她首先决定要开 $(B-A+1)$ 段路程的车，第 $i$ 段路程的速度都是从 $1$ 开始加速的。每一秒会加上 $1$ 的单位速度。当速度加到 $(i+A-1)$ 的时候，JerryC 就会把速度降为 $1$，然后开始下一段路程。\n\n对于第 $i$ 段路程的第 $j$ 秒，JerryC 获得的愉悦值为$\\left\\lfloor \\frac{i+A-1}{j} \\right\\rfloor \\times (-1)^j$。（反正 JerryC 就是不喜欢奇数。）\n\n现在请你求出 JerryC 最后的总愉悦值。\n\nP.s. ：\n\n如果上面的东西没有看懂，那么简单版就是这个意思：\n\n给出 $A, B$，求出下面式子的值。\n\n$$\\sum_{i=A}^B \\sum_{j=1}^{i}\\left\\lfloor \\frac{i}{j} \\right\\rfloor \\times (-1)^j$$", "inputFormat": "一行，两个正整数 $A, B$。", "outputFormat": "一行，一个整数表示最终的愉悦值。", "hint": "对于 $50\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 5\\times10^3$；  \n对于 $70\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 5\\times10^4$；  \n对于 $100\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 2\\times10^7$。", "locale": "zh-CN"}}}
{"pid": "P4864", "type": "P", "difficulty": 6, "samples": [["2 3 1\n1 2\n2 1\n0\n1\n2\n", "1\n3\n4"]], "limits": {"time": [1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "Jerry Loves Lines", "background": "Jerry 很喜欢在纸上面画直线呢。", "description": "Jerry 在纸上面画上了 $N$ 条直线，每一条直线都可以用 $y=k_ix+b_i$ 来表示。现在 Jerry 想知道对于 $M$ 条可以表示为 $X=A_j$ 的直线，从下往上数排名第 $K$ 的交点的 $y$ 坐标是多少。\n\n如有 $x$ 条直线与一条 $X=A_j$ 的直线交于同一点，算 $x$ 个点。", "inputFormat": "第一行三个正整数 $N,M,K$。\n\n接下来 $N$ 行，每一行两个非零整数 $k_i$ 和 $b_i$ 描述了一条直线。\n\n接下来 $M$ 行，每行一个整数 $A_j$ 表示一个询问。", "outputFormat": "$M$ 行，每一行一个整数表示答案。", "hint": "对于 $30\\%$ 的数据，$1 \\leqslant N,M \\leqslant 2000$；  \n对于 $100\\%$ 的数据，$1 \\leqslant N \\leqslant 2000$，$1 \\leqslant M \\leqslant 5\\times10^5$。\n\n其他所有读入的数全在 `int` 范围内，且保证 $1 \\leqslant K \\leqslant N$。\n\n温馨提示：如果对自己的做法的常数感到不放心，请吸入氧气（食用 O2 优化）如果有着充足自信，尽管放手浪。\n\n$\\color{white}{\\text{int*int会爆int!!!}}$", "locale": "zh-CN", "translations": {"en": {"title": "Jerry Loves Lines", "background": "Jerry really likes drawing straight lines on paper.", "description": "Jerry has drawn $N$ lines on paper. Each line can be written as $y = k_i x + b_i$. Now Jerry wants to know, for each of the $M$ lines that can be written as $X = A_j$, what the $y$-coordinate is of the intersection point that ranks $K$-th when counted from bottom to top.\n\nIf $x$ lines intersect a line $X = A_j$ at the same point, it is counted as $x$ points.", "inputFormat": "The first line contains three positive integers $N, M, K$.\n\nThe next $N$ lines each contain two non-zero integers $k_i$ and $b_i$, describing one line.\n\nThe next $M$ lines each contain one integer $A_j$, representing a query.", "outputFormat": "Output $M$ lines. Each line contains one integer, representing the answer.", "hint": "For $30\\%$ of the testdata, $1 \\leqslant N, M \\leqslant 2000$.  \nFor $100\\%$ of the testdata, $1 \\leqslant N \\leqslant 2000$, $1 \\leqslant M \\leqslant 5 \\times 10^5$.\n\nAll other input numbers are within the `int` range, and it is guaranteed that $1 \\leqslant K \\leqslant N$.\n\nFriendly reminder: if you are not confident about the constant factor of your solution, please inhale oxygen (use O2 optimization). If you are fully confident, go ahead and do whatever you want.\n\n$\\color{white}{\\text{int*int会爆int!!!}}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Jerry Loves Lines", "background": "Jerry 很喜欢在纸上面画直线呢。", "description": "Jerry 在纸上面画上了 $N$ 条直线，每一条直线都可以用 $y=k_ix+b_i$ 来表示。现在 Jerry 想知道对于 $M$ 条可以表示为 $X=A_j$ 的直线，从下往上数排名第 $K$ 的交点的 $y$ 坐标是多少。\n\n如有 $x$ 条直线与一条 $X=A_j$ 的直线交于同一点，算 $x$ 个点。", "inputFormat": "第一行三个正整数 $N,M,K$。\n\n接下来 $N$ 行，每一行两个非零整数 $k_i$ 和 $b_i$ 描述了一条直线。\n\n接下来 $M$ 行，每行一个整数 $A_j$ 表示一个询问。", "outputFormat": "$M$ 行，每一行一个整数表示答案。", "hint": "对于 $30\\%$ 的数据，$1 \\leqslant N,M \\leqslant 2000$；  \n对于 $100\\%$ 的数据，$1 \\leqslant N \\leqslant 2000$，$1 \\leqslant M \\leqslant 5\\times10^5$。\n\n其他所有读入的数全在 `int` 范围内，且保证 $1 \\leqslant K \\leqslant N$。\n\n温馨提示：如果对自己的做法的常数感到不放心，请吸入氧气（食用 O2 优化）如果有着充足自信，尽管放手浪。\n\n$\\color{white}{\\text{int*int会爆int!!!}}$", "locale": "zh-CN"}}}
{"pid": "P4865", "type": "P", "difficulty": 6, "samples": [["3 5\n1 2 1\n1 3 2\n3 4 1\n3 5 3\n1 1\n2 2\n3 3\n", "0\n4\n6\n"]], "limits": {"time": [500, 500, 800, 800, 800, 800, 800, 800, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["并查集", "枚举"], "title": "Samcompu Loves Water", "background": "Samcompu 拥有大量的“水”资源！！", "description": "Samcompu 需要制定一个“水”计划。这个计划的主要目的就是为了避开老师监视的时间来水。\n\n老师在中途会离开机房 $T$ 次，第 $i$ 次将会离开 $tim_i$ 秒。Samcompu 划水的时候可不是随便乱水的。他可是拥有“水”资源的。在他的库存中有 $N$ 个可以水的网站。Samcompu 拥有一种黑科技，他可以几乎不耗任何时间在网站与网站之间跳转并且把跳转的网页的信息秒存。也就是说，Samcompu 并不需要在每一次跳转的时候花费时间去浏览网页。当然，这只局限于 $N$ 个网站之间的 $N-1$ 个跳转方式（保证每一个网站都可以跳转到另外的所有网站）。对于第 $i$ 种跳转方式，第 $u_i$ 个网站到第 $v_i$ 个网站的跳转存在一个危险程度 $w_i$，这个危险值可能会造成电脑卡死，如果 Samcompu 不能及时处理，那么就会完美地被老师发现。\n\n值得一提的是，在被查水表很多次后，Samcompu 总结出了一个规律：\n\n老师走得越久，能够保证在被老师发现之前处理好电脑卡死的危险程度的上限就越高。简单来说，两者就是成正比的关系，比例系数为 $1$。\n\n可惜的是，Samcompu 的黑科技并不稳定，在老师第 $i$ 次离开的时候，第 $K_i$ 个跳转方式就不可用了。\n\n当然，每一次水都可以从任意一个网站开始，也可以从任意一个网站结束。\n\n现在 Samcompu 想知道，对于第 $i$ 次老师离开机房时，他能够有多少种不同的安全的水的方案。两种水的方案不同当且仅当这两种水的方案的第一个网站或者最后一个网站不同。\n\n（补充说明: 一个安全的水的方案当且仅当当前是老师第 $j$ 次离开教室时跳转的路径中不存在一个跳转方式 $i$ 使得 $tim_j \\leqslant w_i$，每一次水完后不可用的跳转方式就会恢复。）", "inputFormat": "第一行两个正整数 $T, N$。\n\n接下来 $N-1$ 行，每一行三个正整数 $u_i, v_i, w_i$。\n\n接下来 $T$ 行，每一行两个正整数 $tim_i, K_i$。", "outputFormat": "$T$ 行，每行一个正整数表示有多少中安全的水的方案。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25960.png)\n\n第一次连接 $1$ 和 $2$ 的边不可用，当前能经过的边的危险程度需要 $<1$，并没有合法的方案。\n\n第二次连接 $1$ 和 $3$ 的边不可用，当前能经过的边的危险程度需要 $<2$，合法的方案有 $(1,2)$，$(2,1)$，$(3,4)$，$(4,3)$ 共四种。\n\n第三次连接 $3$ 和 $4$ 的边不可用，当前能经过的边的危险程度需要 $<3$，合法的方案有 $(1,2)$，$(1,3)$，$(2,1)$，$(2,3)$，$(3,1)$，$(3,2)$ 共六种。\n\n提醒：本题计算答案按照点对的方式计算。也就是说，如果起点和终点一样，则只看做同一种方案。特别的，$(x,y)$ 和 $(y,x)\\ (x \\neq y)$ 算作两种不同的方案.\n\n### 数据范围\n\n- Subtask 1（30 pts）：$T=1$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^3$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$；\n- Subtask 2（50 pts）：$1 \\leqslant T \\leqslant 5\\times10^3$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^4$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$；\n- Subtask 3（20 pts）：$1 \\leqslant T \\leqslant 10^4$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^4$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$。\n\n数据保证不同的 $K_i$ 最多只有 $10^3$ 个。\n\n温馨提醒：由于出题人数据比较毒瘤，所以请尽量卡常。", "locale": "zh-CN", "translations": {"en": {"title": "Samcompu Loves Water", "background": "Samcompu has a huge amount of “water” resources.", "description": "Samcompu needs to make a “water” plan. The main goal of this plan is to “water” while avoiding the time when the teacher is watching.\n\nThe teacher will leave the computer room $T$ times. During the $i$-th time, the teacher will be away for $tim_i$ seconds. When Samcompu “waters,” he does not do it randomly. He has “water” resources: in his inventory there are $N$ websites he can “water” on. Samcompu has a kind of black tech that lets him switch between websites almost instantly and instantly save the information of the page he switches to. That is, Samcompu does not need to spend time browsing the webpage each time he switches. Of course, this is limited to the $N-1$ switching methods among the $N$ websites (it is guaranteed that every website can be switched to every other website). For the $i$-th switching method, switching from website $u_i$ to website $v_i$ has a danger level $w_i$. This danger value may cause the computer to freeze. If Samcompu cannot handle it in time, he will be perfectly caught by the teacher.\n\nNotably, after being checked many times, Samcompu found a rule:\n\nThe longer the teacher is away, the higher the upper limit of danger level that can be handled before the teacher notices. In simple terms, they are directly proportional, with proportionality coefficient $1$.\n\nUnfortunately, Samcompu’s black tech is not stable. When the teacher leaves for the $i$-th time, the $K_i$-th switching method becomes unavailable.\n\nAlso, each “watering” session may start at any website and may end at any website.\n\nNow Samcompu wants to know, for the $i$-th time the teacher leaves the computer room, how many different safe “watering” plans he can have. Two “watering” plans are different if and only if the first website or the last website is different.\n\n(Supplement: A safe “watering” plan holds if and only if, when the teacher leaves for the $j$-th time, there does not exist a switching method $i$ on the chosen path such that $tim_j \\leqslant w_i$. After each “watering” session ends, the switching method that was unavailable will be restored.)", "inputFormat": "The first line contains two positive integers $T, N$.\n\nThe next $N-1$ lines each contain three positive integers $u_i, v_i, w_i$.\n\nThe next $T$ lines each contain two positive integers $tim_i, K_i$.", "outputFormat": "Output $T$ lines. Each line contains one positive integer, indicating how many safe “watering” plans there are.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25960.png)\n\nIn the first query, the edge connecting $1$ and $2$ is unavailable. The danger level of edges that can be used must satisfy $< 1$, so there is no valid plan.\n\nIn the second query, the edge connecting $1$ and $3$ is unavailable. The danger level of edges that can be used must satisfy $< 2$. The valid plans are $(1,2)$, $(2,1)$, $(3,4)$, $(4,3)$, a total of four.\n\nIn the third query, the edge connecting $3$ and $4$ is unavailable. The danger level of edges that can be used must satisfy $< 3$. The valid plans are $(1,2)$, $(1,3)$, $(2,1)$, $(2,3)$, $(3,1)$, $(3,2)$, a total of six.\n\nReminder: In this problem, the answer is counted by ordered pairs of nodes. That is, if the start and end are the same, it is counted as only one plan. In particular, $(x,y)$ and $(y,x)\\ (x \\neq y)$ are considered two different plans.\n\n### Constraints\n\n- Subtask 1 (30 pts): $T=1$, $1 \\leqslant K_i \\leqslant N \\leqslant 10^3$, $1 \\leqslant tim_i, w_i \\leqslant 10^3$.\n- Subtask 2 (50 pts): $1 \\leqslant T \\leqslant 5\\times10^3$, $1 \\leqslant K_i \\leqslant N \\leqslant 10^4$, $1 \\leqslant tim_i, w_i \\leqslant 10^3$.\n- Subtask 3 (20 pts): $1 \\leqslant T \\leqslant 10^4$, $1 \\leqslant K_i \\leqslant N \\leqslant 10^4$, $1 \\leqslant tim_i, w_i \\leqslant 10^3$.\n\nThe testdata guarantees that there are at most $10^3$ distinct values among $K_i$.\n\nWarm reminder: Because the setter’s testdata is quite harsh, please optimize for constant factors as much as possible.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Samcompu Loves Water", "background": "Samcompu 拥有大量的“水”资源！！", "description": "Samcompu 需要制定一个“水”计划。这个计划的主要目的就是为了避开老师监视的时间来水。\n\n老师在中途会离开机房 $T$ 次，第 $i$ 次将会离开 $tim_i$ 秒。Samcompu 划水的时候可不是随便乱水的。他可是拥有“水”资源的。在他的库存中有 $N$ 个可以水的网站。Samcompu 拥有一种黑科技，他可以几乎不耗任何时间在网站与网站之间跳转并且把跳转的网页的信息秒存。也就是说，Samcompu 并不需要在每一次跳转的时候花费时间去浏览网页。当然，这只局限于 $N$ 个网站之间的 $N-1$ 个跳转方式（保证每一个网站都可以跳转到另外的所有网站）。对于第 $i$ 种跳转方式，第 $u_i$ 个网站到第 $v_i$ 个网站的跳转存在一个危险程度 $w_i$，这个危险值可能会造成电脑卡死，如果 Samcompu 不能及时处理，那么就会完美地被老师发现。\n\n值得一提的是，在被查水表很多次后，Samcompu 总结出了一个规律：\n\n老师走得越久，能够保证在被老师发现之前处理好电脑卡死的危险程度的上限就越高。简单来说，两者就是成正比的关系，比例系数为 $1$。\n\n可惜的是，Samcompu 的黑科技并不稳定，在老师第 $i$ 次离开的时候，第 $K_i$ 个跳转方式就不可用了。\n\n当然，每一次水都可以从任意一个网站开始，也可以从任意一个网站结束。\n\n现在 Samcompu 想知道，对于第 $i$ 次老师离开机房时，他能够有多少种不同的安全的水的方案。两种水的方案不同当且仅当这两种水的方案的第一个网站或者最后一个网站不同。\n\n（补充说明: 一个安全的水的方案当且仅当当前是老师第 $j$ 次离开教室时跳转的路径中不存在一个跳转方式 $i$ 使得 $tim_j \\leqslant w_i$，每一次水完后不可用的跳转方式就会恢复。）", "inputFormat": "第一行两个正整数 $T, N$。\n\n接下来 $N-1$ 行，每一行三个正整数 $u_i, v_i, w_i$。\n\n接下来 $T$ 行，每一行两个正整数 $tim_i, K_i$。", "outputFormat": "$T$ 行，每行一个正整数表示有多少中安全的水的方案。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25960.png)\n\n第一次连接 $1$ 和 $2$ 的边不可用，当前能经过的边的危险程度需要 $<1$，并没有合法的方案。\n\n第二次连接 $1$ 和 $3$ 的边不可用，当前能经过的边的危险程度需要 $<2$，合法的方案有 $(1,2)$，$(2,1)$，$(3,4)$，$(4,3)$ 共四种。\n\n第三次连接 $3$ 和 $4$ 的边不可用，当前能经过的边的危险程度需要 $<3$，合法的方案有 $(1,2)$，$(1,3)$，$(2,1)$，$(2,3)$，$(3,1)$，$(3,2)$ 共六种。\n\n提醒：本题计算答案按照点对的方式计算。也就是说，如果起点和终点一样，则只看做同一种方案。特别的，$(x,y)$ 和 $(y,x)\\ (x \\neq y)$ 算作两种不同的方案.\n\n### 数据范围\n\n- Subtask 1（30 pts）：$T=1$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^3$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$；\n- Subtask 2（50 pts）：$1 \\leqslant T \\leqslant 5\\times10^3$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^4$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$；\n- Subtask 3（20 pts）：$1 \\leqslant T \\leqslant 10^4$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^4$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$。\n\n数据保证不同的 $K_i$ 最多只有 $10^3$ 个。\n\n温馨提醒：由于出题人数据比较毒瘤，所以请尽量卡常。", "locale": "zh-CN"}}}
{"pid": "P4866", "type": "P", "difficulty": 6, "samples": [["7 3 3\n1 2 2\n1 3 1\n2 4 1\n2 5 10\n3 6 1\n6 7 2\n4 5\n5 50\n7 7\n1\n10\n100\n", "0\n7\n62"]], "limits": {"time": [1000, 1000, 1500, 1500, 1500, 1500, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 256000, 256000, 256000, 256000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "枚举", "背包 DP"], "title": "Zrz_orz Loves Secondary Element", "background": "zrz_orz 赘喜欢二次元辣！！", "description": "众所周知的是，zrz_orz 是全机房最强的死宅。~~他甚至使用嘴遁使得 Samcompu 不得不在自己的网站上挂上时崎狂三~~。（话说 Samcompu 好像醒悟了又把狂三给去掉了。）作为新一代死宅的一员，从电脑壁纸到输入法皮肤，到处都是二次元的痕迹。所以，他经常在梦里梦见一些二次元的角色。\n\nzrz_orz 的梦，是由 $n$ 个点和 $n-1$ 条边构成的连通图。其中有 $m$ 个节点上有一个二次元的角色。对于 zrz_orz 来说，每一个二次元的角色都有一个对应的 $pos_i$ 和 $val_i$ 表示这个角色在图上的哪一个节点以及与之聊天对 zrz_orz 来说会增加多少愉悦值。（由于某种原因，聊天的过程可以不用计入时间。）可惜的是，zrz_orz 每一次做梦都只会做 $tim_i$ 个单位时间。现在请你告诉他，他每一次做梦最多能获得多少愉悦值。\n\n注：\n\n1. zrz_orz 每一次做梦都只会从 $1$ 号节点开始走！\n2. 每一次做梦后 zrz_orz 梦境中的图都不会改变！\n3. **每一次做完梦之后 zrz_orz 就必须要回到 $\\bm1$ 号节点，否则他就会迷失在梦境里！**", "inputFormat": "第1行三个正整数 $N,M,T$ 表示图的节点数、二次元角色的数量、做梦的天数。\n\n接下来 $N-1$ 行每行三个正整数 $u_i,v_i,w_i$ 表示第 $i$ 条边连接的两个节点以及 zrz_orz 走过这条边所花费的时间。\n\n接下来 $M$ 行每行两个正整数 $pos_j$ 和 $val_j$ 表示第 $j$ 个二次元角色在节点上的位置以及能给 zrz_orz 带来的愉悦值。\n\n接下来 $T$ 行每行一个正整数 $tim_k$ 表示第 $k$ 天 zrz_orz 做梦的时间。", "outputFormat": "一共 $T$ 行。每一行包括一个正整数表示 zrz_orz 每天最多能获得的最大愉悦值。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25600.png)\n\n第一天哪里都去不了。\n\n第二天 $1\\to3\\to6\\to7\\to6\\to3\\to1$ 获得最大愉悦值为 $7$。\n\n第三天所有的地方都可以走一遍。\n\n- Subtask 1（20 pts）：$1 \\leqslant T \\leqslant 10$，$1 \\leqslant N \\leqslant 1000$，$1 \\leqslant M \\leqslant 20$，$1 \\leqslant  tim_k \\leqslant 1000$；\n- Subtask 2（40 pts）：$1 \\leqslant T \\leqslant 10^5$，$1 \\leqslant N \\leqslant 10^5$，$1 \\leqslant M \\leqslant 20$，$1 \\leqslant  tim_k \\leqslant 10^5$；\n- Subtask 3（40 pts）：$1 \\leqslant T \\leqslant 5\\times10^4$，$1 \\leqslant N \\leqslant 5000$，$1 \\leqslant M \\leqslant 100$，$1 \\leqslant  tim_k \\leqslant 100$，$1 \\leqslant w_i \\leqslant 5$。\n\nFor all test points：$1 \\leqslant pos_j,u_i,v_i \\leqslant N$，$1 \\leqslant \\sum val_j \\leqslant 2\\times10^9$，$1 \\leqslant w_i \\leqslant 20$，$1 \\leqslant tim_k \\leqslant 10^5$。\n\n注意：标记的分数就是这个 Subtask 的分数，每一个 Subtask 必须全对才能得分。Subtask 2 的时限为 1.5s。\n\n$$ \\color{white} \\text{NOIP 2合1} $$", "locale": "zh-CN", "translations": {"en": {"title": "Zrz_orz Loves Secondary Element", "background": "zrz_orz really loves anime (èr cì yuán)!!", "description": "As everyone knows, zrz_orz is the strongest hardcore otaku in the whole computer room. ~~He even used “talk-no-jutsu” to make Samcompu put Kurumi Tokisaki on his website~~. (But it seems Samcompu realized something and removed Kurumi again.) As a member of the new generation of otaku, from desktop wallpapers to input method skins, everything is filled with anime traces. So, he often dreams of some anime characters.\n\nzrz_orz’s dream is a connected graph with $n$ nodes and $n-1$ edges. There are $m$ nodes that have an anime character on them. For zrz_orz, each anime character has a corresponding $pos_i$ and $val_i$, meaning which node this character is on, and how much happiness value zrz_orz gains by chatting with them. (For some reason, the chatting process does not need to be counted in time.) Unfortunately, each time zrz_orz dreams, he only has $tim_i$ units of time. Now please tell him: in each dream, what is the maximum happiness value he can obtain?\n\nNotes:\n\n1. Each time zrz_orz dreams, he will always start from node $1$.\n2. After each dream, the graph in zrz_orz’s dream will not change.\n3. **After each dream, zrz_orz must return to node $\\bm1$, otherwise he will get lost in the dream!**", "inputFormat": "The first line contains three positive integers $N, M, T$, representing the number of nodes in the graph, the number of anime characters, and the number of days of dreaming.\n\nThe next $N-1$ lines each contain three positive integers $u_i, v_i, w_i$, representing that the $i$-th edge connects two nodes, and the time cost for zrz_orz to traverse this edge.\n\nThe next $M$ lines each contain two positive integers $pos_j$ and $val_j$, representing the position of the $j$-th anime character and the happiness value it can bring to zrz_orz.\n\nThe next $T$ lines each contain one positive integer $tim_k$, representing the dreaming time on the $k$-th day.", "outputFormat": "Output a total of $T$ lines. Each line contains one positive integer, representing the maximum happiness value zrz_orz can obtain on that day.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25600.png)\n\nOn the first day, he cannot go anywhere.\n\nOn the second day, taking the route $1\\to3\\to6\\to7\\to6\\to3\\to1$, the maximum happiness value is $7$.\n\nOn the third day, he can traverse all places once.\n\n- Subtask 1 (20 pts): $1 \\leqslant T \\leqslant 10$, $1 \\leqslant N \\leqslant 1000$, $1 \\leqslant M \\leqslant 20$, $1 \\leqslant tim_k \\leqslant 1000$.\n- Subtask 2 (40 pts): $1 \\leqslant T \\leqslant 10^5$, $1 \\leqslant N \\leqslant 10^5$, $1 \\leqslant M \\leqslant 20$, $1 \\leqslant tim_k \\leqslant 10^5$.\n- Subtask 3 (40 pts): $1 \\leqslant T \\leqslant 5\\times10^4$, $1 \\leqslant N \\leqslant 5000$, $1 \\leqslant M \\leqslant 100$, $1 \\leqslant tim_k \\leqslant 100$, $1 \\leqslant w_i \\leqslant 5$.\n\nFor all test points: $1 \\leqslant pos_j, u_i, v_i \\leqslant N$, $1 \\leqslant \\sum val_j \\leqslant 2\\times10^9$, $1 \\leqslant w_i \\leqslant 20$, $1 \\leqslant tim_k \\leqslant 10^5$.\n\nNote: The marked score is the score of this Subtask. Each Subtask must be completely correct to get the score. The time limit for Subtask 2 is 1.5 s.\n\n$$ \\color{white} \\text{NOIP 2合1} $$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Zrz_orz Loves Secondary Element", "background": "zrz_orz 赘喜欢二次元辣！！", "description": "众所周知的是，zrz_orz 是全机房最强的死宅。~~他甚至使用嘴遁使得 Samcompu 不得不在自己的网站上挂上时崎狂三~~。（话说 Samcompu 好像醒悟了又把狂三给去掉了。）作为新一代死宅的一员，从电脑壁纸到输入法皮肤，到处都是二次元的痕迹。所以，他经常在梦里梦见一些二次元的角色。\n\nzrz_orz 的梦，是由 $n$ 个点和 $n-1$ 条边构成的连通图。其中有 $m$ 个节点上有一个二次元的角色。对于 zrz_orz 来说，每一个二次元的角色都有一个对应的 $pos_i$ 和 $val_i$ 表示这个角色在图上的哪一个节点以及与之聊天对 zrz_orz 来说会增加多少愉悦值。（由于某种原因，聊天的过程可以不用计入时间。）可惜的是，zrz_orz 每一次做梦都只会做 $tim_i$ 个单位时间。现在请你告诉他，他每一次做梦最多能获得多少愉悦值。\n\n注：\n\n1. zrz_orz 每一次做梦都只会从 $1$ 号节点开始走！\n2. 每一次做梦后 zrz_orz 梦境中的图都不会改变！\n3. **每一次做完梦之后 zrz_orz 就必须要回到 $\\bm1$ 号节点，否则他就会迷失在梦境里！**", "inputFormat": "第1行三个正整数 $N,M,T$ 表示图的节点数、二次元角色的数量、做梦的天数。\n\n接下来 $N-1$ 行每行三个正整数 $u_i,v_i,w_i$ 表示第 $i$ 条边连接的两个节点以及 zrz_orz 走过这条边所花费的时间。\n\n接下来 $M$ 行每行两个正整数 $pos_j$ 和 $val_j$ 表示第 $j$ 个二次元角色在节点上的位置以及能给 zrz_orz 带来的愉悦值。\n\n接下来 $T$ 行每行一个正整数 $tim_k$ 表示第 $k$ 天 zrz_orz 做梦的时间。", "outputFormat": "一共 $T$ 行。每一行包括一个正整数表示 zrz_orz 每天最多能获得的最大愉悦值。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25600.png)\n\n第一天哪里都去不了。\n\n第二天 $1\\to3\\to6\\to7\\to6\\to3\\to1$ 获得最大愉悦值为 $7$。\n\n第三天所有的地方都可以走一遍。\n\n- Subtask 1（20 pts）：$1 \\leqslant T \\leqslant 10$，$1 \\leqslant N \\leqslant 1000$，$1 \\leqslant M \\leqslant 20$，$1 \\leqslant  tim_k \\leqslant 1000$；\n- Subtask 2（40 pts）：$1 \\leqslant T \\leqslant 10^5$，$1 \\leqslant N \\leqslant 10^5$，$1 \\leqslant M \\leqslant 20$，$1 \\leqslant  tim_k \\leqslant 10^5$；\n- Subtask 3（40 pts）：$1 \\leqslant T \\leqslant 5\\times10^4$，$1 \\leqslant N \\leqslant 5000$，$1 \\leqslant M \\leqslant 100$，$1 \\leqslant  tim_k \\leqslant 100$，$1 \\leqslant w_i \\leqslant 5$。\n\nFor all test points：$1 \\leqslant pos_j,u_i,v_i \\leqslant N$，$1 \\leqslant \\sum val_j \\leqslant 2\\times10^9$，$1 \\leqslant w_i \\leqslant 20$，$1 \\leqslant tim_k \\leqslant 10^5$。\n\n注意：标记的分数就是这个 Subtask 的分数，每一个 Subtask 必须全对才能得分。Subtask 2 的时限为 1.5s。\n\n$$ \\color{white} \\text{NOIP 2合1} $$", "locale": "zh-CN"}}}
{"pid": "P4867", "type": "P", "difficulty": 6, "samples": [["10 10\n4 4 5 1 4 1 5 1 2 1\n5 9 1 2\n3 4 7 9\n4 4 2 5\n2 3 4 7\n5 10 4 4\n3 9 1 1\n1 4 5 9\n8 9 3 3\n2 2 1 6\n8 9 1 4", "2\n0\n0\n2\n1\n1\n1\n0\n1\n2"]], "limits": {"time": [5000, 5000, 5000, 5000], "memory": [32768, 32768, 32768, 32768]}, "tags": ["莫队", "分块"], "title": "Gty的妹子序列", "background": "", "description": "Autumn 和 Bakser 又在研究 Gty 的妹子序列了！但他们遇到了一个难题。\n\n对于一段妹子们，他们想让你帮忙求出这之内美丽度 $\\in[a,b]$ 的妹子的美丽度的种类数。\n\n为了方便，我们规定妹子们的美丽度全都在 $[1,n]$ 中。\n\n给定一个长度为 $n(1\\le n\\leq 10^5)$ 的正整数序列 $s(1\\le s_i\\le n)$，对于 $m(1\\le m\\le 10^6)$ 次询问 $l,r,a,b$，每次输出 $s_l\\cdots s_r$ 中，权值 $\\in[a,b]$ 的权值的种类数。", "inputFormat": "第一行包括两个整数 $n,m(1 \\le n \\le 100000,1 \\le m \\le 1000000)$，表示数列 $s$ 中的元素数和询问数。  \n\n第二行包括 $n$ 个整数 $s_1\\cdots s_n(1 \\le s_i\\le n)$。  \n\n接下来 $m$ 行,每行包括 $4$ 个整数 $l,r,a,b(1 \\le l \\le r \\le n,1 \\le a \\le b \\le n)$，意义见题目描述。  \n\n保证涉及的所有数在 C++ 的 int 内。保证输入合法。  ", "outputFormat": "对每个询问，单独输出一行，表示 $s_l \\cdots s_r$ 中权值 $\\in [a,b]$ 的权值的种类数。", "hint": "【样例的部分解释】\n \n`5 9 1 2 `\n子序列为`4 1 5 1 2`  \n在[1,2]里的权值有1,1,2，有2种，因此答案为2。  \n\n`3 4 7 9`  \n子序列为`5 1 ` \n在[7,9]里的权值有5，有1种，因此答案为1。  \n\n`4 4 2 5`  \n子序列为`1`  \n没有权值在[2,5]中的，因此答案为0。  \n\n`2 3 4 7`  \n子序列为`4 5`  \n权值在[4,7]中的有4,5，因此答案为2。  \n\n建议使用输入/输出优化。  ", "locale": "zh-CN", "translations": {"en": {"title": "Gty's Girl Sequence", "background": "", "description": "Autumn and Bakser are studying Gty's girl sequence again, but they have run into a difficult problem.\n\nGiven a segment of girls, they want you to help compute the number of distinct beauty values whose beauty is in $\\in [a,b]$ within this segment.\n\nFor convenience, we assume all beauty values are within $[1,n]$.\n\nGiven a positive integer sequence $s$ of length $n(1 \\le n \\le 10^5)$ with $s_i(1 \\le s_i \\le n)$, and $m(1 \\le m \\le 10^6)$ queries $l,r,a,b$, for each query output, in $s_l \\cdots s_r$, the number of distinct values that are $\\in [a,b]$.", "inputFormat": "The first line contains two integers $n,m(1 \\le n \\le 100000,1 \\le m \\le 1000000)$, representing the number of elements in sequence $s$ and the number of queries.\n\nThe second line contains $n$ integers $s_1 \\cdots s_n(1 \\le s_i \\le n)$.\n\nThe next $m$ lines each contain $4$ integers $l,r,a,b(1 \\le l \\le r \\le n,1 \\le a \\le b \\le n)$, with the meaning as described in the statement.\n\nIt is guaranteed that all numbers involved fit in C++ int. The input is guaranteed to be valid.", "outputFormat": "For each query, output a single line representing, in $s_l \\cdots s_r$, the number of distinct values that are $\\in [a,b]$.", "hint": "【Partial explanation of the sample】\n\n`5 9 1 2`  \nThe subsequence is `4 1 5 1 2`.  \nThe values within $[1,2]$ are 1, 1, 2. There are 2 distinct values, so the answer is 2.\n\n`3 4 7 9`  \nThe subsequence is `5 1`.  \nThe values within $[7,9]$ are 5. There is 1 distinct value, so the answer is 1.\n\n`4 4 2 5`  \nThe subsequence is `1`.  \nThere are no values within $[2,5]$, so the answer is 0.\n\n`2 3 4 7`  \nThe subsequence is `4 5`.  \nThe values within $[4,7]$ are 4, 5. There are 2 distinct values, so the answer is 2.\n\nIt is recommended to use input/output optimization.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Gty的妹子序列", "background": "", "description": "Autumn 和 Bakser 又在研究 Gty 的妹子序列了！但他们遇到了一个难题。\n\n对于一段妹子们，他们想让你帮忙求出这之内美丽度 $\\in[a,b]$ 的妹子的美丽度的种类数。\n\n为了方便，我们规定妹子们的美丽度全都在 $[1,n]$ 中。\n\n给定一个长度为 $n(1\\le n\\leq 10^5)$ 的正整数序列 $s(1\\le s_i\\le n)$，对于 $m(1\\le m\\le 10^6)$ 次询问 $l,r,a,b$，每次输出 $s_l\\cdots s_r$ 中，权值 $\\in[a,b]$ 的权值的种类数。", "inputFormat": "第一行包括两个整数 $n,m(1 \\le n \\le 100000,1 \\le m \\le 1000000)$，表示数列 $s$ 中的元素数和询问数。  \n\n第二行包括 $n$ 个整数 $s_1\\cdots s_n(1 \\le s_i\\le n)$。  \n\n接下来 $m$ 行,每行包括 $4$ 个整数 $l,r,a,b(1 \\le l \\le r \\le n,1 \\le a \\le b \\le n)$，意义见题目描述。  \n\n保证涉及的所有数在 C++ 的 int 内。保证输入合法。  ", "outputFormat": "对每个询问，单独输出一行，表示 $s_l \\cdots s_r$ 中权值 $\\in [a,b]$ 的权值的种类数。", "hint": "【样例的部分解释】\n \n`5 9 1 2 `\n子序列为`4 1 5 1 2`  \n在[1,2]里的权值有1,1,2，有2种，因此答案为2。  \n\n`3 4 7 9`  \n子序列为`5 1 ` \n在[7,9]里的权值有5，有1种，因此答案为1。  \n\n`4 4 2 5`  \n子序列为`1`  \n没有权值在[2,5]中的，因此答案为0。  \n\n`2 3 4 7`  \n子序列为`4 5`  \n权值在[4,7]中的有4,5，因此答案为2。  \n\n建议使用输入/输出优化。  ", "locale": "zh-CN"}}}
{"pid": "P4868", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2 3 4 5\nQuery 5\nModify 3 2\nQuery 5", "35\n32"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "树状数组", "前缀和", "差分"], "title": "Preprefix sum", "background": "", "description": "前缀和（prefix sum）$S_i=\\sum_{k=1}^i a_k$。\n\n前前缀和（preprefix sum）则把 $S_i$ 作为原序列再进行前缀和。记再次求得前缀和第 $i$ 个是 $SS_i$。\n\n给一个长度 $n$ 的序列 $a_1, a_2, \\cdots, a_n$，有两种操作：\n\n1. `Modify i x`：把 $a_i$ 改成 $x$。\n2. `Query i`：查询 $SS_i$。\n", "inputFormat": "第一行给出两个整数 $N,M$。分别表示序列长度和操作个数。  \n接下来一行有 $N$ 个数，即给定的序列 $a_1,a_2,\\cdots,a_n$。  \n接下来 $M$ 行，每行对应一个操作，格式见题目描述。  ", "outputFormat": "对于每个询问操作，输出一行，表示所询问的 $SS_i$ 的值。", "hint": "$1\\le N,M\\le 10^5$，且在任意时刻 $0\\le A_i\\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Preprefix sum", "background": "", "description": "The prefix sum is defined as $S_i=\\sum_{k=1}^i a_k$.\n\nThe preprefix sum (preprefix sum) takes $S_i$ as the original sequence and computes the prefix sum again. Let the $i$-th value of this second prefix sum be $SS_i$.\n\nGiven a sequence $a_1, a_2, \\cdots, a_n$ of length $n$, there are two types of operations:\n\n1. `Modify i x`: Change $a_i$ to $x$.\n2. `Query i`: Query $SS_i$.", "inputFormat": "The first line contains two integers $N, M$, representing the length of the sequence and the number of operations.  \nThe next line contains $N$ numbers, the given sequence $a_1, a_2, \\cdots, a_n$.  \nThe next $M$ lines each contain one operation, with the format described above.", "outputFormat": "For each query operation, output one line containing the value of $SS_i$ being queried.", "hint": "Constraints: $1\\le N,M\\le 10^5$, and at any time $0\\le A_i\\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Preprefix sum", "background": "", "description": "前缀和（prefix sum）$S_i=\\sum_{k=1}^i a_k$。\n\n前前缀和（preprefix sum）则把 $S_i$ 作为原序列再进行前缀和。记再次求得前缀和第 $i$ 个是 $SS_i$。\n\n给一个长度 $n$ 的序列 $a_1, a_2, \\cdots, a_n$，有两种操作：\n\n1. `Modify i x`：把 $a_i$ 改成 $x$。\n2. `Query i`：查询 $SS_i$。\n", "inputFormat": "第一行给出两个整数 $N,M$。分别表示序列长度和操作个数。  \n接下来一行有 $N$ 个数，即给定的序列 $a_1,a_2,\\cdots,a_n$。  \n接下来 $M$ 行，每行对应一个操作，格式见题目描述。  ", "outputFormat": "对于每个询问操作，输出一行，表示所询问的 $SS_i$ 的值。", "hint": "$1\\le N,M\\le 10^5$，且在任意时刻 $0\\le A_i\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4869", "type": "P", "difficulty": 6, "samples": [["3\n1 2 3\n1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线性基"], "title": "albus就是要第一个出场", "background": "", "description": "已知一个长度为 $n$ 的正整数序列 $A$（下标从 $1$ 开始），令 $S = \\{ x | 1 \\le x \\le n \\}$，$S$ 的幂集 $2^S$ 定义为 $S$ 所有子集构成的集合。定义映射 $f : 2^S \\to Z,f(\\emptyset) = 0,f(T) = \\mathrm{XOR}\\{A_t\\}, (t \\in T)$。\n\n现在 albus 把 $2^S$ 中每个集合的 $f$ 值计算出来，从小到大排成一行，记为序列 $B$（下标从 $1$ 开始）。 \n\n给定一个数，那么这个数在序列 $B$ 中第 $1$ 次出现时的下标是多少呢？", "inputFormat": "第一行一个数 $n$, 为序列 $A$ 的长度。接下来一行 $n$ 个数，为序列 $A$，用空格隔开。最后一个数 $Q$，为给定的数.", "outputFormat": "共一行，一个整数，为 $Q$ 在序列 $B$ 中第一次出现时的下标模 $10086$ 的值.", "hint": "\n【样例解释】  \n\n$N = 3,A = [1,2,3]$  \n$S = \\{1,2,3\\}$  \n$2^S = \\{\\emptyset,\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{1,3\\},\\{2,3\\},\\{1,2,3\\}\\}$  \n$f(\\emptyset) = 0$  \n$f({1}) = 1$  \n$f({2}) = 2$  \n$f({3}) = 3$  \n$f({1, 2}) = 1 \\operatorname{xor} 2 = 3$  \n$f({1, 3}) = 1 \\operatorname{xor} 3 = 2$  \n$f({2, 3}) = 2 \\operatorname{xor} 3 = 1$  \n$f({1, 2, 3}) = 0$  \n所以  \n$B = [0,0,1,1,2,2,3,3]$\n\n【数据范围】\n\n$1 \\leq N \\leq 10,0000$  \n其他所有输入均不超过 $10^9$", "locale": "zh-CN", "translations": {"en": {"title": "Albus Wants to Be the First to Appear", "background": "", "description": "Given a positive integer sequence $A$ of length $n$ (indices start from $1$), let $S = \\{ x | 1 \\le x \\le n \\}$. The power set $2^S$ is defined as the set consisting of all subsets of $S$. Define a mapping $f : 2^S \\to Z$, where $f(\\emptyset) = 0$, and for a non-empty set $T$, $f(T) = \\mathrm{XOR}\\{A_t\\}, (t \\in T)$.\n\nNow Albus computes the value $f$ for every set in $2^S$, sorts these values in non-decreasing order into a sequence, and denotes it as sequence $B$ (indices start from $1$).\n\nGiven a number, what is the index of its first occurrence in sequence $B$?", "inputFormat": "The first line contains an integer $n$, the length of sequence $A$. The next line contains $n$ integers representing $A$, separated by spaces. The last number is $Q$, the given number.", "outputFormat": "Output one line with one integer: the value of the index of the first occurrence of $Q$ in sequence $B$ modulo $10086$.", "hint": "[Sample Explanation]\n\n$N = 3,A = [1,2,3]$  \n$S = \\{1,2,3\\}$  \n$2^S = \\{\\emptyset,\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{1,3\\},\\{2,3\\},\\{1,2,3\\}\\}$  \n$f(\\emptyset) = 0$  \n$f({1}) = 1$  \n$f({2}) = 2$  \n$f({3}) = 3$  \n$f({1, 2}) = 1 \\operatorname{xor} 2 = 3$  \n$f({1, 3}) = 1 \\operatorname{xor} 3 = 2$  \n$f({2, 3}) = 2 \\operatorname{xor} 3 = 1$  \n$f({1, 2, 3}) = 0$  \nTherefore,  \n$B = [0,0,1,1,2,2,3,3]$\n\n[Constraints]\n\n$1 \\leq N \\leq 10,0000$  \nAll other inputs do not exceed $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "albus就是要第一个出场", "background": "", "description": "已知一个长度为 $n$ 的正整数序列 $A$（下标从 $1$ 开始），令 $S = \\{ x | 1 \\le x \\le n \\}$，$S$ 的幂集 $2^S$ 定义为 $S$ 所有子集构成的集合。定义映射 $f : 2^S \\to Z,f(\\emptyset) = 0,f(T) = \\mathrm{XOR}\\{A_t\\}, (t \\in T)$。\n\n现在 albus 把 $2^S$ 中每个集合的 $f$ 值计算出来，从小到大排成一行，记为序列 $B$（下标从 $1$ 开始）。 \n\n给定一个数，那么这个数在序列 $B$ 中第 $1$ 次出现时的下标是多少呢？", "inputFormat": "第一行一个数 $n$, 为序列 $A$ 的长度。接下来一行 $n$ 个数，为序列 $A$，用空格隔开。最后一个数 $Q$，为给定的数.", "outputFormat": "共一行，一个整数，为 $Q$ 在序列 $B$ 中第一次出现时的下标模 $10086$ 的值.", "hint": "\n【样例解释】  \n\n$N = 3,A = [1,2,3]$  \n$S = \\{1,2,3\\}$  \n$2^S = \\{\\emptyset,\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{1,3\\},\\{2,3\\},\\{1,2,3\\}\\}$  \n$f(\\emptyset) = 0$  \n$f({1}) = 1$  \n$f({2}) = 2$  \n$f({3}) = 3$  \n$f({1, 2}) = 1 \\operatorname{xor} 2 = 3$  \n$f({1, 3}) = 1 \\operatorname{xor} 3 = 2$  \n$f({2, 3}) = 2 \\operatorname{xor} 3 = 1$  \n$f({1, 2, 3}) = 0$  \n所以  \n$B = [0,0,1,1,2,2,3,3]$\n\n【数据范围】\n\n$1 \\leq N \\leq 10,0000$  \n其他所有输入均不超过 $10^9$", "locale": "zh-CN"}}}
{"pid": "P4870", "type": "P", "difficulty": 5, "samples": [["3 15\n6\n-3\n1", "25"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": ["动态规划 DP", "2009", "区间 DP", "BalticOI（波罗的海）"], "title": "[BalticOI 2009] 甲虫 (Day1)", "background": "", "description": "**译自 [BalticOI 2009](http://www.csc.kth.se/contest/boi/tasks.php) Day1 T1「[Beetle](http://www.csc.kth.se/contest/boi/beetle.pdf)」**\n\n有一只甲虫处于一根水平的树枝。因为他沉迷数学无法自拔，所以他觉得很像是在 $x$ 轴上。\n\n在同一根树枝上，还有 $n$ 滴露水。每滴露水占用 $m$ 个单位的水分。相对于甲虫的位置，他们的坐标分别是 $x_1,x_2,\\dots,x_n$。\n\n显然，这一天将会骄阳似火。每过一个时间单位，就会有一个单位的水分从每一滴露水流失。这只甲虫受尽了烈阳的折磨，以至于每当它碰到一滴露水都能瞬间喝完。在每个时间单位中它能移动一个单位的距离。\n\n所以你要写一个程序，根据露水的坐标，计算出甲虫**最多**能喝到的水。", "inputFormat": "第一行，两个整数，$n$ 和 $m$。\n\n以下 $n$ 行，每行一个整数，表示露水的坐标 $x_1,x_2,\\dots,x_n$。", "outputFormat": "输出一行，表示甲虫最多能喝到的水", "hint": "$0 \\le n \\le 300,1 \\le m \\le 1,000,000,-10,000 \\le x_1,x_2,\\dots,x_n \\le 10,000,$ 对于所有 $i \\ne j,x_i \\ne x_j$。", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2009] Beetle (Day1).", "background": "", "description": "**Translated from [BalticOI 2009](http://www.csc.kth.se/contest/boi/tasks.php) Day1 T1 “[Beetle](http://www.csc.kth.se/contest/boi/beetle.pdf)”.**\n\nA beetle is on a horizontal tree branch. Because it is obsessed with math, it feels like it is on the $x$ axis.\n\nOn the same branch, there are $n$ drops of dew. Each drop contains $m$ units of water. Relative to the beetle’s position, their coordinates are $x_1, x_2, \\dots, x_n$.\n\nObviously, the sun will be blazing that day. Every unit of time, each drop of dew loses $1$ unit of water. The beetle suffers so much from the sun that whenever it touches a drop of dew, it can instantly drink it all. In each unit of time, it can move $1$ unit of distance.\n\nSo you need to write a program that, given the coordinates of the dew drops, computes the **maximum** amount of water the beetle can drink.", "inputFormat": "The first line contains two integers, $n$ and $m$.\n\nThe next $n$ lines each contain one integer, giving the coordinates $x_1, x_2, \\dots, x_n$.", "outputFormat": "Output one line containing the maximum amount of water the beetle can drink.", "hint": "Constraints: $0 \\le n \\le 300$, $1 \\le m \\le 1{,}000{,}000$, $-10{,}000 \\le x_1, x_2, \\dots, x_n \\le 10{,}000$, and for all $i \\ne j$, $x_i \\ne x_j$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2009] 甲虫 (Day1)", "background": "", "description": "**译自 [BalticOI 2009](http://www.csc.kth.se/contest/boi/tasks.php) Day1 T1「[Beetle](http://www.csc.kth.se/contest/boi/beetle.pdf)」**\n\n有一只甲虫处于一根水平的树枝。因为他沉迷数学无法自拔，所以他觉得很像是在 $x$ 轴上。\n\n在同一根树枝上，还有 $n$ 滴露水。每滴露水占用 $m$ 个单位的水分。相对于甲虫的位置，他们的坐标分别是 $x_1,x_2,\\dots,x_n$。\n\n显然，这一天将会骄阳似火。每过一个时间单位，就会有一个单位的水分从每一滴露水流失。这只甲虫受尽了烈阳的折磨，以至于每当它碰到一滴露水都能瞬间喝完。在每个时间单位中它能移动一个单位的距离。\n\n所以你要写一个程序，根据露水的坐标，计算出甲虫**最多**能喝到的水。", "inputFormat": "第一行，两个整数，$n$ 和 $m$。\n\n以下 $n$ 行，每行一个整数，表示露水的坐标 $x_1,x_2,\\dots,x_n$。", "outputFormat": "输出一行，表示甲虫最多能喝到的水", "hint": "$0 \\le n \\le 300,1 \\le m \\le 1,000,000,-10,000 \\le x_1,x_2,\\dots,x_n \\le 10,000,$ 对于所有 $i \\ne j,x_i \\ne x_j$。", "locale": "zh-CN"}}}
{"pid": "P4871", "type": "P", "difficulty": 5, "samples": [["3\n1 2 3", "2"], ["5\n1 2 2 4 5", "8"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "状压 DP"], "title": "Oier们的镜子(mirror)", "background": "原创By：[b2019dy](https://www.luogu.org/space/show?uid=78488) 、[disangan233](https://www.luogu.org/space/show?uid=72679)   \n\n$gcd$是一个很臭美的OIer，他有一些神奇的镜子。", "description": "\n\n$gcd$手里一共有$n$个物体，它们的编号为$A_1,A_2,A_3\\cdots A_n$。这些物体中有元素板也有镜子，元素板上带有元素，镜子一开始不带元素。\n\n一个元素板可以与**至多**一面镜子相对应，那样的话那面镜子将会带上元素板上的元素。\n\n一面镜子无法对应其他镜子。\n\n现在告诉你物体总数$n$和每个物体**对应后**所带的元素个数，请问一共有多少种对应情况。\n", "inputFormat": "第一行：整数$n$表示物品总数。  \n第二行：共$n$个整数表示每一个物品最终的元素数。", "outputFormat": "输出方案总数对$1000000007$取模的值。   ", "hint": "\n对于$20\\%$的数据，$n\\leq 5$。  \n\n对于$50\\%$的数据，$n\\leq 10$。 \n\n对于$100\\%$的数据，$n\\leq 15$。 \n\n\n## 样例解释  \n\n因为出题人太懒现将解释中的\"(其余)全是元素板\"缩写为\"suki\"！\"对应\"缩写为$\\to$\n\n### 样例1   \n* suki。\n* $A1,A2\\to A3$。 \n   \n#### 答案为：$2$。\n\n\n### 样例2  \n* suki。\n* $A2,A3\\to A4$，suki。    \n* $A1,A4\\to A5$，suki。  \n* $A1,A2,A3\\to A5$，suki。    \n* $A2\\to A3$，suki。  \n* $A2\\to A3$，$A1,A4$->$A5$。  \n* $A3\\to A2$，suki。  \n* $A3\\to A2$，$A1,A4$->$A5$。  \n\n### 答案为：$8$。", "locale": "zh-CN", "translations": {"en": {"title": "Oiers' Mirror (mirror)", "background": "Original by: [b2019dy](https://www.luogu.org/space/show?uid=78488), [disangan233](https://www.luogu.org/space/show?uid=72679).\n\n$gcd$ is a very vain OIer, and he has some magical mirrors.", "description": "$gcd$ has $n$ objects in total, numbered $A_1, A_2, A_3 \\cdots A_n$. Among these objects, some are element plates and some are mirrors. An element plate contains elements, while a mirror has no elements at the beginning.\n\nAn element plate can correspond to **at most** one mirror. In that case, the mirror will carry the elements on that element plate.\n\nA mirror cannot correspond to other mirrors.\n\nYou are now given the total number of objects $n$ and the number of elements each object has **after correspondence**. Please find how many different correspondence schemes there are.", "inputFormat": "The first line: an integer $n$, the total number of objects.  \nThe second line: $n$ integers, representing the final number of elements of each object.", "outputFormat": "Output the number of schemes modulo $1000000007$.", "hint": "For $20\\%$ of the testdata, $n \\leq 5$.  \n\nFor $50\\%$ of the testdata, $n \\leq 10$.  \n\nFor $100\\%$ of the testdata, $n \\leq 15$.  \n\n## Sample Explanation\n\nBecause the problem setter is too lazy, in the explanation, \"(the rest) are all element plates\" is abbreviated as \"suki\", and \"correspond\" is abbreviated as $\\to$.\n\n### Sample 1\n\n* suki.  \n* $A1, A2 \\to A3$.  \n\n#### The answer is: $2$.\n\n### Sample 2\n\n* suki.  \n* $A2, A3 \\to A4$, suki.  \n* $A1, A4 \\to A5$, suki.  \n* $A1, A2, A3 \\to A5$, suki.  \n* $A2 \\to A3$, suki.  \n* $A2 \\to A3$, $A1, A4$->$A5$.  \n* $A3 \\to A2$, suki.  \n* $A3 \\to A2$, $A1, A4$->$A5$.  \n\n### The answer is: $8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Oier们的镜子(mirror)", "background": "原创By：[b2019dy](https://www.luogu.org/space/show?uid=78488) 、[disangan233](https://www.luogu.org/space/show?uid=72679)   \n\n$gcd$是一个很臭美的OIer，他有一些神奇的镜子。", "description": "\n\n$gcd$手里一共有$n$个物体，它们的编号为$A_1,A_2,A_3\\cdots A_n$。这些物体中有元素板也有镜子，元素板上带有元素，镜子一开始不带元素。\n\n一个元素板可以与**至多**一面镜子相对应，那样的话那面镜子将会带上元素板上的元素。\n\n一面镜子无法对应其他镜子。\n\n现在告诉你物体总数$n$和每个物体**对应后**所带的元素个数，请问一共有多少种对应情况。\n", "inputFormat": "第一行：整数$n$表示物品总数。  \n第二行：共$n$个整数表示每一个物品最终的元素数。", "outputFormat": "输出方案总数对$1000000007$取模的值。   ", "hint": "\n对于$20\\%$的数据，$n\\leq 5$。  \n\n对于$50\\%$的数据，$n\\leq 10$。 \n\n对于$100\\%$的数据，$n\\leq 15$。 \n\n\n## 样例解释  \n\n因为出题人太懒现将解释中的\"(其余)全是元素板\"缩写为\"suki\"！\"对应\"缩写为$\\to$\n\n### 样例1   \n* suki。\n* $A1,A2\\to A3$。 \n   \n#### 答案为：$2$。\n\n\n### 样例2  \n* suki。\n* $A2,A3\\to A4$，suki。    \n* $A1,A4\\to A5$，suki。  \n* $A1,A2,A3\\to A5$，suki。    \n* $A2\\to A3$，suki。  \n* $A2\\to A3$，$A1,A4$->$A5$。  \n* $A3\\to A2$，suki。  \n* $A3\\to A2$，$A1,A4$->$A5$。  \n\n### 答案为：$8$。", "locale": "zh-CN"}}}
{"pid": "P4872", "type": "P", "difficulty": 5, "samples": [["6 10\n5400000S01\n1111101101\n000003X301\n3111111101\nE000300031\n1111X30001", "16"], ["5 10\nS23323323X\n2032332333\n1202202202\n1111111111\n11111111XE", "44"], ["9 10\nSX1X0X1X1X\n2332332333\n5205205200\nXXXXXXXXXX\n2222222222\n3333333333\n3333333333\nXXXXXXXXXX\nXXXXXXXXXE", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "O2优化", "广度优先搜索 BFS", "优先队列", "队列"], "title": "OIer们的东方梦", "background": "**#11,#12 两组 Hack 数据由 uid=20285 提供**\n\nOIer 们做~~魂魄妖~~梦都想去幻想乡玩一下。这一次，他们在睡~~古明地~~觉时在梦中穿越去了幻想乡，幻想乡有很多的少(ju)女(ruo)，但是他们被~~老太婆~~少女的美色~~和蒟蒻的美味~~所吸引，在幻想乡中迷失了方向。\n\n勇敢的~~死肥宅~~少年啊，现在你手里有一份幻想乡人间之里的地图，你知道 OIer 们的位置，你可以远程给OIer们传递信息，请你带领迷路的 OIer 们走进回到现实生活的祭坛吧！", "description": "给你一个 $N\\times M$ 的地图，如图所示：              \n```\n5400000S01     \n1111101101     \n000003X301      \n3111111101     \nE000300031      \n1111X30001     \n```\n\n其中有很多稀奇古怪的东西：  \n     \n* $S$ 表示出发点，$E$ 表示终点。      \n* $0$ 表示空地，你想怎么走就怎么走，走一格需要 $1s$。            \n* $1$ 表示墙，你无法通行（~~除非你受到了**风神少女**的庇护~~）。   \n* $2$ 表示小妖怪，你需要 $3s$ 的时间去消灭小妖怪，才能经过该位置。（PS: 妖怪被消灭后只要离开当前格子立刻复活）  \n* $3$ 表示大妖怪，你需要 $8s$ 的时间去消灭大妖怪，才能经过该位置。   \n* $4$ 表示太阳花田，到达该位置可以获得太阳花，获得太阳花后遇到妖怪时可**直接**通过该妖怪的位置。  \n* $5$ 表示楼观剑（科普君：楼观剑，英文名 $Louguan\\ is\\ very\\ jian$，是妖怪做的剑，楼观剑斩不断的东西几乎没有)，到达该位置可以花费 $5s$ 获得它，获得它后可以砍墙砍妖怪将其变成空地（当然也可以不砍，砍墙砍妖怪不需要时间，楼观剑可以一直使用**不会损坏**，有了楼观剑依然可以使用隙间，但是楼观剑不能砍隙间~~和一点用都没有的麻薯，麻薯妖梦UUZ是一家嘛~~）       \n* $M$ 表示麻薯（是 $mashu$ 不是 $mafu$~~不知道麻薯是什么的一把楼观剑给你砍过来~~)，碰到麻薯后你可以把它吃了(路人甲：那你为什么还要加这个东西? 出题人：有 $S$ 肯定要有 $M$ 啊。路人乙：我就是死外边，从隙间中跳下去，也不会吃麻薯！嗯~真香！）            \n* $X$ 表示紫妈的隙间，碰到隙间后会传送至其他的任意一个隙间(数据**不**保证只有 0 或 2 个隙间，**就是说可以有很多隙间乱传**)，每次传送耗时 $1s$。(经过当前格子时可以不经过隙间)       \n      \n答案输出 OIer 们到达终点所需最短时间。如果无法到达，输出 \"We want to live in the TouHou World forever\"。     \n翻译：此生无悔入东方，来世~~睡遍~~愿生幻想乡。   \n    \n**温馨提示：不排除存在可以往回走等稀奇古怪的最优走法**", "inputFormat": "数据共有 $N+1$行。\n\n第 $1$ 行输入 $N$ 和 $M$。  \n第 $2$ 到 $N+1$ 行输入 $N\\times M$ 的地图。", "outputFormat": "一行，最短时间或者 \"We want to live in the TouHou World forever\"。", "hint": "对于 $30\\%$ 的数据，$1\\leq N,M\\leq 50$。       \n对于 $50\\%$ 的数据，$1\\leq N,M\\leq 100$。       \n对于 $100\\%$ 的数据，$1\\leq N,M\\leq 1000$。\n\n保证有一组数据答案为 \"We want to live in the TouHou World forever\"，数据有梯度。\n\n### 样例解释\n\n**样例 1**：在 $7s$ 时到达楼观剑，在 $12s$ 时获得楼观剑，一路向下砍到达终点。                   \n**样例 2**：在 $10s$ 时到达 $(3,3)$，在 $32s$ 时到达$(3,10)$，向上进入隙间后到达终点。          \n**样例 3**：这个就不用解释了吧(出题人放飞自我)。", "locale": "zh-CN", "translations": {"en": {"title": "OIers' Eastern Dream", "background": "**Hack testdata sets #11 and #12 were provided by uid=20285.**\n\nOIers dream (~~Konpaku Youmu~~) of visiting Gensokyo. This time, while they were sleeping (~~Komeiji~~), they traveled to Gensokyo in a dream. There are many (ju) girls (ruo) in Gensokyo, but they were attracted by the beauty of the (~~old lady~~) girls (~~and the delicious konnyaku~~), and got lost in Gensokyo.\n\nBrave (~~dead otaku~~) boy, now you have a map of the Human Village in Gensokyo in your hand. You know the OIers' position, and you can remotely send information to them. Please guide the lost OIers to the altar that leads them back to real life.", "description": "You are given an $N \\times M$ map, as shown below:\n```\n5400000S01     \n1111101101     \n000003X301      \n3111111101     \nE000300031      \n1111X30001     \n```\n\nThere are many strange things on it:\n\n* $S$ is the starting point, and $E$ is the destination.\n* $0$ is empty ground. You can walk as you like, and moving one cell costs $1s$.\n* $1$ is a wall, which you cannot pass through (~~unless you are blessed by the **Wind God Girl**~~).\n* $2$ is a small youkai. You need $3s$ to defeat it before you can pass through this cell. (PS: After being defeated, the youkai revives immediately once you leave the current cell.)\n* $3$ is a big youkai. You need $8s$ to defeat it before you can pass through this cell.\n* $4$ is the Sunflower Field. When you arrive here, you can obtain a sunflower. After obtaining it, when you meet a youkai, you can pass through the youkai's cell **directly**.\n* $5$ is the Roukanken (Trivia: Roukanken, English name $Louguan\\ is\\ very\\ jian$, is a sword forged by youkai; there is almost nothing it cannot cut). When you arrive here, you may spend $5s$ to obtain it. After obtaining it, you can cut walls and youkai, turning them into empty ground (you may also choose not to cut them). Cutting walls and youkai costs no time. Roukanken can be used indefinitely and **will not break**. With Roukanken, you can still use gaps, but Roukanken cannot cut gaps (~~or the completely useless mochi; mochi Youmu UUZ is one family anyway~~).\n* $M$ is mochi (it is $mashu$, not $mafu$ ~~if you do not know what mochi is, I will cut you with Roukanken~~). After you touch mochi, you can eat it. (Passerby A: Then why did you add this thing? Setter: If there is $S$, there must be $M$. Passerby B: I'd rather die outside, or jump down into a gap, than eat mochi! Hmm, smells good!)\n* $X$ is Yukari's gap. After you touch a gap, you will be teleported to any other gap. (The testdata **does not** guarantee there are only 0 or 2 gaps; **that is, there may be many gaps and you can teleport randomly**.) Each teleport costs $1s$. (When passing through the current cell, you may also choose not to use the gap.)\n\nOutput the minimum time needed for the OIers to reach the destination. If it is impossible, output `\"We want to live in the TouHou World forever\"`.\n\nTranslation: No regrets entering Touhou in this life; in the next life, ~~sleep with everyone~~ I wish to be born in Gensokyo.\n\n**Warm reminder: It is possible that the optimal path has weird moves such as going back.**", "inputFormat": "There are $N + 1$ lines in total.\n\nLine $1$ contains $N$ and $M$.\nLines $2$ to $N + 1$ contain the $N \\times M$ map.", "outputFormat": "One line: the minimum time, or `\"We want to live in the TouHou World forever\"`.", "hint": "For $30\\%$ of the testdata, $1 \\leq N, M \\leq 50$.\nFor $50\\%$ of the testdata, $1 \\leq N, M \\leq 100$.\nFor $100\\%$ of the testdata, $1 \\leq N, M \\leq 1000$.\n\nIt is guaranteed that there is one testdata set whose answer is `\"We want to live in the TouHou World forever\"`. The testdata has graded difficulty.\n\n### Sample Explanation\n\n**Sample 1**: Reach Roukanken at $7s$, obtain Roukanken at $12s$, then cut downward all the way to reach the destination.\n**Sample 2**: Reach $(3,3)$ at $10s$, reach $(3,10)$ at $32s$, go upward into a gap and then reach the destination.\n**Sample 3**: No need to explain this one (the setter totally went wild).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "OIer们的东方梦", "background": "**#11,#12 两组 Hack 数据由 uid=20285 提供**\n\nOIer 们做~~魂魄妖~~梦都想去幻想乡玩一下。这一次，他们在睡~~古明地~~觉时在梦中穿越去了幻想乡，幻想乡有很多的少(ju)女(ruo)，但是他们被~~老太婆~~少女的美色~~和蒟蒻的美味~~所吸引，在幻想乡中迷失了方向。\n\n勇敢的~~死肥宅~~少年啊，现在你手里有一份幻想乡人间之里的地图，你知道 OIer 们的位置，你可以远程给OIer们传递信息，请你带领迷路的 OIer 们走进回到现实生活的祭坛吧！", "description": "给你一个 $N\\times M$ 的地图，如图所示：              \n```\n5400000S01     \n1111101101     \n000003X301      \n3111111101     \nE000300031      \n1111X30001     \n```\n\n其中有很多稀奇古怪的东西：  \n     \n* $S$ 表示出发点，$E$ 表示终点。      \n* $0$ 表示空地，你想怎么走就怎么走，走一格需要 $1s$。            \n* $1$ 表示墙，你无法通行（~~除非你受到了**风神少女**的庇护~~）。   \n* $2$ 表示小妖怪，你需要 $3s$ 的时间去消灭小妖怪，才能经过该位置。（PS: 妖怪被消灭后只要离开当前格子立刻复活）  \n* $3$ 表示大妖怪，你需要 $8s$ 的时间去消灭大妖怪，才能经过该位置。   \n* $4$ 表示太阳花田，到达该位置可以获得太阳花，获得太阳花后遇到妖怪时可**直接**通过该妖怪的位置。  \n* $5$ 表示楼观剑（科普君：楼观剑，英文名 $Louguan\\ is\\ very\\ jian$，是妖怪做的剑，楼观剑斩不断的东西几乎没有)，到达该位置可以花费 $5s$ 获得它，获得它后可以砍墙砍妖怪将其变成空地（当然也可以不砍，砍墙砍妖怪不需要时间，楼观剑可以一直使用**不会损坏**，有了楼观剑依然可以使用隙间，但是楼观剑不能砍隙间~~和一点用都没有的麻薯，麻薯妖梦UUZ是一家嘛~~）       \n* $M$ 表示麻薯（是 $mashu$ 不是 $mafu$~~不知道麻薯是什么的一把楼观剑给你砍过来~~)，碰到麻薯后你可以把它吃了(路人甲：那你为什么还要加这个东西? 出题人：有 $S$ 肯定要有 $M$ 啊。路人乙：我就是死外边，从隙间中跳下去，也不会吃麻薯！嗯~真香！）            \n* $X$ 表示紫妈的隙间，碰到隙间后会传送至其他的任意一个隙间(数据**不**保证只有 0 或 2 个隙间，**就是说可以有很多隙间乱传**)，每次传送耗时 $1s$。(经过当前格子时可以不经过隙间)       \n      \n答案输出 OIer 们到达终点所需最短时间。如果无法到达，输出 \"We want to live in the TouHou World forever\"。     \n翻译：此生无悔入东方，来世~~睡遍~~愿生幻想乡。   \n    \n**温馨提示：不排除存在可以往回走等稀奇古怪的最优走法**", "inputFormat": "数据共有 $N+1$行。\n\n第 $1$ 行输入 $N$ 和 $M$。  \n第 $2$ 到 $N+1$ 行输入 $N\\times M$ 的地图。", "outputFormat": "一行，最短时间或者 \"We want to live in the TouHou World forever\"。", "hint": "对于 $30\\%$ 的数据，$1\\leq N,M\\leq 50$。       \n对于 $50\\%$ 的数据，$1\\leq N,M\\leq 100$。       \n对于 $100\\%$ 的数据，$1\\leq N,M\\leq 1000$。\n\n保证有一组数据答案为 \"We want to live in the TouHou World forever\"，数据有梯度。\n\n### 样例解释\n\n**样例 1**：在 $7s$ 时到达楼观剑，在 $12s$ 时获得楼观剑，一路向下砍到达终点。                   \n**样例 2**：在 $10s$ 时到达 $(3,3)$，在 $32s$ 时到达$(3,10)$，向上进入隙间后到达终点。          \n**样例 3**：这个就不用解释了吧(出题人放飞自我)。", "locale": "zh-CN"}}}
{"pid": "P4873", "type": "P", "difficulty": 5, "samples": [["5 3\n0 1\n1 2\n2 3\n3 2\n6 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2014", "USACO", "树状数组", "离散化", "Dilworth 定理", "STL"], "title": "[USACO14DEC] Cow Jog G", "background": "", "description": "Farmer John's $N$ cows $(1 <= N <= 100,000)$ are out exercising their\nhooves again, jogging along an infinite track.  Each cow starts at a\ndistinct position on the track, and some cows run at different speeds.\n\nThe track is divided into lanes so that cows may move past each other.\nNo two cows in the same lane may ever occupy the same position.\nFarmer John doesn't want any cow to have to change lanes or adjust\nspeed, and he wonders how many lanes he will need to accomplish this\nif the cows are going to run for $T$ minutes $(1 <= T <= 1,000,000,000).$\n", "inputFormat": "The first line of input contains $N$ and $T$.\n\nThe following $N$ lines each contain the initial position and speed of a\nsingle cow.  Position is a nonnegative integer and speed is a positive\ninteger; both numbers are at most 1 billion.  All cows start at\ndistinct positions, and these will be given in increasing order in the\ninput.", "outputFormat": "A single integer indicating the minimum number of lanes necessary so\nthat no two cows in the same lane ever occupy the same location\n(including at time $T$).\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO14DEC] Cow Jog G", "background": "", "description": "Farmer John's $N$ cows $(1 <= N <= 100,000)$ are out exercising their\nhooves again, jogging along an infinite track.  Each cow starts at a\ndistinct position on the track, and some cows run at different speeds.\n\nThe track is divided into lanes so that cows may move past each other.\nNo two cows in the same lane may ever occupy the same position.\nFarmer John doesn't want any cow to have to change lanes or adjust\nspeed, and he wonders how many lanes he will need to accomplish this\nif the cows are going to run for $T$ minutes $(1 <= T <= 1,000,000,000).$\n", "inputFormat": "The first line of input contains $N$ and $T$.\n\nThe following $N$ lines each contain the initial position and speed of a\nsingle cow.  Position is a nonnegative integer and speed is a positive\ninteger; both numbers are at most 1 billion.  All cows start at\ndistinct positions, and these will be given in increasing order in the\ninput.", "outputFormat": "A single integer indicating the minimum number of lanes necessary so\nthat no two cows in the same lane ever occupy the same location\n(including at time $T$).\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Cow Jog G", "background": "", "description": "Farmer John 的 $ N $ 头奶牛 $ ( 1 \\le N \\le 10^5 ) $ 正在一条长度无限的跑道上慢跑，每头奶牛的初始位置都不一样；跑步速度也不全相同。\n\n为了方便奶牛们互相超越，整个跑道被分成了若干条赛道。在同一时刻，不能有在同一条赛道上的两头奶牛占据相同的位置，不然就会发生冲突。\n\n现在奶牛们要跑 $T$ 分钟，在跑步过程中，他们不会改变自己所在的赛道和自己跑步的速度。FJ 想要知道，为了奶牛间不会发生冲突，他至少需要准备多少条赛道。", "inputFormat": "输入的第一行包含两个非负整数 $N$ 和 $T$。\n\n接下来的 $N$ 行每行输入两个数 $x_i,v_i$，分别表示第 $i$ 头奶牛的初始位置以及速度。输入数据保证所有奶牛的初始位置互不相同且输入中会按初始位置递增给出。", "outputFormat": "一行一个整数表示 FJ 最少需要准备的赛道个数。", "hint": "对于样例一的说明：\n\n在这组样例中，FJ 会将第 $1,2,3$ 号奶牛放在第一个赛道。第 $4,5$ 两只奶牛分别各占一个赛道。最终需要 $3$ 个赛道，不难证明这是最优方案。\n\n数据范围：\n\n对于 $100\\%$ 的数据，满足 $1\\le N\\le 10^5$，$1\\le T,v_i\\le 10^9$，$0\\le x_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4875", "type": "P", "difficulty": 5, "samples": [["9 2\n1 1\n5 1\n6 1\n9 1\n100 1\n2 2\n7 2\n3 3\n8 3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 3000, 6000, 5000, 3000, 5000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO"], "title": "[USACO14OPEN] Fair Photography G", "background": "", "description": "FJ's $N$ cows $(1 <= N <= 100,000)$ are standing at various positions along a long one-dimensional fence.  The $ith$ cow is standing at position $x_i$ (an integer in the range 0...1,000,000,000) and has breed $b_i$ (an integer in the range 1..8).  No two cows occupy the same position. \n\nFJ wants to take a photo of a contiguous interval of cows for the county fair, but we wants all of his breeds to be fairly represented in the photo. Therefore, he wants to ensure that, for whatever breeds are present in the photo, there is an equal number of each breed (for example, a photo with $27$ each of breeds $1$ and $3$ is ok, a photo with $27$ of breeds $1, 3,$ and $4$ is ok, but $9$ of breed $1$ and $10$ of breed $3$ is not ok). Farmer John also wants at least $K (K >= 2)$ breeds (out of the 8 total) to be represented in the photo. Help FJ take his fair photo by finding the maximum size of a photo that satisfies FJ's constraints.  The size of a photo is the difference between the maximum and minimum positions of the cows in the photo. \n\nIf there are no photos satisfying FJ's constraints, output $-1$ instead.\n", "inputFormat": "* Line 1: $N$ and $K$ separated by a space\n\n* Lines $2..N+1$: Each line contains a description of a cow as two integers separated by a space; $x(i)$ and its breed id.\n", "outputFormat": "* Line 1: A single integer indicating the maximum size of a fair photo. If no such photo exists, output -1.", "hint": "INPUT DETAILS:\n\nBreed ids: 1 2 3 - 1 1 2 3 1  - ...  -   1\nLocations: 1 2 3 4 5 6 7 8 9 10 ... 99 100\n\n\n\nOUTPUT DETAILS:\n\nThe range from x = 2 to x = 8 has 2 each of breeds 1, 2, and 3. The range from x = 9 to x = 100 has 2 of breed 1, but this is invalid because K = 2 and so we must have at least 2 distinct breeds.", "locale": "en", "translations": {"en": {"title": "[USACO14OPEN] Fair Photography G", "background": "", "description": "FJ's $N$ cows $(1 <= N <= 100,000)$ are standing at various positions along a long one-dimensional fence.  The $ith$ cow is standing at position $x_i$ (an integer in the range 0...1,000,000,000) and has breed $b_i$ (an integer in the range 1..8).  No two cows occupy the same position. \n\nFJ wants to take a photo of a contiguous interval of cows for the county fair, but we wants all of his breeds to be fairly represented in the photo. Therefore, he wants to ensure that, for whatever breeds are present in the photo, there is an equal number of each breed (for example, a photo with $27$ each of breeds $1$ and $3$ is ok, a photo with $27$ of breeds $1, 3,$ and $4$ is ok, but $9$ of breed $1$ and $10$ of breed $3$ is not ok). Farmer John also wants at least $K (K >= 2)$ breeds (out of the 8 total) to be represented in the photo. Help FJ take his fair photo by finding the maximum size of a photo that satisfies FJ's constraints.  The size of a photo is the difference between the maximum and minimum positions of the cows in the photo. \n\nIf there are no photos satisfying FJ's constraints, output $-1$ instead.\n", "inputFormat": "* Line 1: $N$ and $K$ separated by a space\n\n* Lines $2..N+1$: Each line contains a description of a cow as two integers separated by a space; $x(i)$ and its breed id.\n", "outputFormat": "* Line 1: A single integer indicating the maximum size of a fair photo. If no such photo exists, output -1.", "hint": "INPUT DETAILS:\n\nBreed ids: 1 2 3 - 1 1 2 3 1  - ...  -   1\nLocations: 1 2 3 4 5 6 7 8 9 10 ... 99 100\n\n\n\nOUTPUT DETAILS:\n\nThe range from x = 2 to x = 8 has 2 each of breeds 1, 2, and 3. The range from x = 9 to x = 100 has 2 of breed 1, but this is invalid because K = 2 and so we must have at least 2 distinct breeds.", "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Fair Photography G", "background": "", "description": "FJ 的 $N$ 头奶牛（$1 \\leq N \\leq 100,000$）站在一条长长的一维栅栏的不同位置。第 $i$ 头奶牛站在位置 $x_i$（范围为 0 到 1,000,000,000 的整数），其品种为 $b_i$（范围为 1 到 8 的整数）。没有两头奶牛占据相同的位置。\n\nFJ 想为县集市拍摄一张连续区间的奶牛照片，但他希望所有的品种在照片中都能得到公平的代表。因此，他希望确保在照片中出现的任何品种数量都是相等的（例如，包含 27 头品种 1 和品种 3 的照片是可以的，包含 27 头品种 1、3 和 4 的照片也是可以的，但包含 9 头品种 1 和 10 头品种 3 的照片则不可以）。农夫约翰还希望照片中至少有 $K$（$K \\geq 2$）个品种（总共 8 个品种）被代表。帮助 FJ 拍摄他的公平照片，找出满足 FJ 约束条件的最大照片大小。照片的大小是照片中奶牛的最大位置和最小位置之间的差。\n\n如果没有满足 FJ 约束条件的照片，则输出 $-1$。", "inputFormat": "* 第 1 行：两个用空格分隔的整数 $N$ 和 $K$。\n\n* 第 2 行到第 $N+1$ 行：每行包含两个用空格分隔的整数，描述一头奶牛的位置 $x(i)$ 和其品种 id。", "outputFormat": "* 第 1 行：一个整数，表示公平照片的最大大小。如果不存在这样的照片，则输出 -1。", "hint": "输入详情：\n\n品种 id：1 2 3 - 1 1 2 3 1 - ... - 1\n\n位置：1 2 3 4 5 6 7 8 9 10 ... 99 100\n\n输出详情：\n\n从 $x = 2$ 到 $x = 8$ 的范围内有 2 头品种 1、2 和 3。范围从 $x = 9$ 到 $x = 100$ 有 2 头品种 1，但这是无效的，因为 $K = 2$，所以我们必须至少有 2 个不同的品种。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4876", "type": "P", "difficulty": 6, "samples": [["4 3\n7 8 6\n3 0 0\n4 6 0\n1 4 2", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO"], "title": "[USACO14MAR] The Lazy Cow G", "background": "", "description": "It's a hot summer day, and Bessie the cow is feeling quite lazy. She wants to locate herself at a position in her field so that she can reach as much delicious grass as possible within only a short distance.\n\nThere are $N$ patches of grass $(1 <= N <= 100,000)$ in Bessie's field. The $ith$ such patch contains $g_i$ units of grass $(1 <= g_i <= 10,000)$ and is located at a distinct point $(x_i, y_i)$ in the field $(0 <= x_i,$ $y_i <= $ $1,000,000)$.  Bessie would like to choose a point in the field as her initial location (possibly the same point as a patch of grass, and possibly even a point with non-integer coordinates) so that a maximum amount of grass is within a distance of $K$ steps from this location $(1 <= K <= 2,000,000)$.\n\nWhen Bessie takes a step, she moves 1 unit north, south, east, or west of her current position.  For example, to move from $(0,0)$ to $(3,2)$, this requires 5 total steps.  Bessie does not need to take integer-sized steps -- for example, 1 total step could be divided up as half a unit north and half a unit east.\n\nPlease help Bessie determine the maximum amount of grass she can reach, if she chooses the best possible initial location.\n", "inputFormat": "* Line 1: The integers $N$ and $K$.\n\n* Lines 2..1+N: Line $i+1$ describes the $ith$ patch of grass using 3 integers: $g_i, x_i, y_i.$\n", "outputFormat": "* Line 1: The maximum amount of grass Bessie can reach within $K$ steps, if she locates herself at the best possible initial position.", "hint": "INPUT DETAILS:\n\nBessie is willing to take at most 3 steps from her initial position.  There\nare 4 patches of grass.  The first contains 7 units of grass and is located\nat position $(8,6)$, and so on.\n\nOUTPUT DETAILS:\n\nBy locating herself at $(3,0)$, the grass at positions $(0,0)$, $(6,0)$, and\n$(4,2)$ is all within $K$ units of distance.", "locale": "en", "translations": {"en": {"title": "[USACO14MAR] The Lazy Cow G", "background": "", "description": "It's a hot summer day, and Bessie the cow is feeling quite lazy. She wants to locate herself at a position in her field so that she can reach as much delicious grass as possible within only a short distance.\n\nThere are $N$ patches of grass $(1 <= N <= 100,000)$ in Bessie's field. The $ith$ such patch contains $g_i$ units of grass $(1 <= g_i <= 10,000)$ and is located at a distinct point $(x_i, y_i)$ in the field $(0 <= x_i,$ $y_i <= $ $1,000,000)$.  Bessie would like to choose a point in the field as her initial location (possibly the same point as a patch of grass, and possibly even a point with non-integer coordinates) so that a maximum amount of grass is within a distance of $K$ steps from this location $(1 <= K <= 2,000,000)$.\n\nWhen Bessie takes a step, she moves 1 unit north, south, east, or west of her current position.  For example, to move from $(0,0)$ to $(3,2)$, this requires 5 total steps.  Bessie does not need to take integer-sized steps -- for example, 1 total step could be divided up as half a unit north and half a unit east.\n\nPlease help Bessie determine the maximum amount of grass she can reach, if she chooses the best possible initial location.\n", "inputFormat": "* Line 1: The integers $N$ and $K$.\n\n* Lines 2..1+N: Line $i+1$ describes the $ith$ patch of grass using 3 integers: $g_i, x_i, y_i.$\n", "outputFormat": "* Line 1: The maximum amount of grass Bessie can reach within $K$ steps, if she locates herself at the best possible initial position.", "hint": "INPUT DETAILS:\n\nBessie is willing to take at most 3 steps from her initial position.  There\nare 4 patches of grass.  The first contains 7 units of grass and is located\nat position $(8,6)$, and so on.\n\nOUTPUT DETAILS:\n\nBy locating herself at $(3,0)$, the grass at positions $(0,0)$, $(6,0)$, and\n$(4,2)$ is all within $K$ units of distance.", "locale": "en"}, "zh-CN": {"title": "[USACO14MAR] The Lazy Cow G", "background": null, "description": "Bessie 的田里有 $n$（$1\\le n \\le 10^5$）块草地，每块草地的坐标是 $(x_i,y_i)$（$0\\le x_i,y_i\\le 10^6$），上面长着 $gi$（$1\\le g_i\\le 10^4$）个单位的牧草。   \n\nBessie 可以向东南西北方向走，一次走一步（一个单位长度）。如她从 $(0,0)$ 走到 $(3,2)$ 需要 $5$ 步。她最多可以一次走 $k$（$\\le k \\le 2\\times 10^6$）步。  \n\n现在她想找一个位置，使她从该位置出发可以得到最多单位的牧草（她可以走多次，但每次都从该位置出发）。", "inputFormat": "第一行两个整数 $n$ 和 $k$。  \n\n第 $2$ 到 $n+1$ 行，每行三个整数 $g_i,x_i,y_i$。", "outputFormat": "一行一个整数，表示 Bessie 所能获得的最多单位牧草数", "hint": null, "locale": "zh-CN"}}}
{"pid": "P4877", "type": "P", "difficulty": 5, "samples": [["3 1\n2 7 6\n5 1 7\n2 2 4\n4 2 1", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2014", "USACO", "进制", "状压 DP"], "title": "[USACO14FEB] Cow Decathlon G", "background": "", "description": "Farmer John's $N$ cows $(1 <= N <= 20)$, conveniently labeled $1...N$ as always, are preparing for a decathlon that has $N$ different events (so perhaps it would be better called an N-athlon instead of a decathlon, which traditionally has exactly 10 events).\n\nCow i has a skill level of $s_ij$ $(1 <= s_ij <= 1000)$ when competing in event j.  Each cow must compete in one and only one event, and each event must have some cow competing in it.\n\nThe total score for all cows is the sum of their skill levels for the events in which they are competing.  However, the event judges can also give out bonus points if they are particularly impressed.  There are $B$ bonuses $(1 <= B <= 20)$ that the judges can give out. Bonus i has three parts: if the cows obtain at least $P_i$ points $(1 <= P_i <= 40,000)$ for the first $K_i$ events (including other bonuses involving just those events), they will get an additional $A_i$ points $(1 <= A_i <= 1000)$.  \n\nFor example, let us consider $N = 3$ cows with the following skills:\n\n```\n      E V E N T\n     | 1 | 2 | 3\n   --+---+---+--\nC  1 | 5 | 1 | 7\n   --+---+---+--\nO  2 | 2 | 2 | 4\n   --+---+---+--\nW  3 | 4 | 2 | 1\n```\nFor example, cow 1 would earn the team 7 points if she participates in event 3.  \n\nSuppose the judges offer a bonus (B = 1), such that if the if the cows score at least 7 points in the first two events, they will get an  additional 6 points.  Here, the optimal assignment would be to assign cow 1 to event 1, cow 2 to event 3 and cow 3 to event 2.  For the first two events, cow 1 will score 5 points and cow 3 will score 2 points giving them 7 points, which is enough to satisfy bonus 1.  Therefore, the total points that they score will be 5+2+4+6=17.\n\nPlease help decide which events the cows should attempt to maximize their total score.", "inputFormat": "* Line 1: Two space-separated integers: $N, B$\n\n* Lines 2..B+1: Line i+1 will contain the information for bonus i which is three space- separated integers: $K_i, P_i, A_i$.\n\n* Lines B+2..B+N+1: Line B+1+j will contain the information on how cow j will perform at each  of her events. This will be given in $N$ space-separated integers: $s_j1...s_jN.$", "outputFormat": "* Line 1: The maximum amount of points that the cows can receive, including bonuses.\n", "hint": "Cow 1 will perform event 1, cow 3 will perform event 2, and cow 2 will  perform event 3.", "locale": "en", "translations": {"en": {"title": "[USACO14FEB] Cow Decathlon G", "background": "", "description": "Farmer John's $N$ cows $(1 <= N <= 20)$, conveniently labeled $1...N$ as always, are preparing for a decathlon that has $N$ different events (so perhaps it would be better called an N-athlon instead of a decathlon, which traditionally has exactly 10 events).\n\nCow i has a skill level of $s_ij$ $(1 <= s_ij <= 1000)$ when competing in event j.  Each cow must compete in one and only one event, and each event must have some cow competing in it.\n\nThe total score for all cows is the sum of their skill levels for the events in which they are competing.  However, the event judges can also give out bonus points if they are particularly impressed.  There are $B$ bonuses $(1 <= B <= 20)$ that the judges can give out. Bonus i has three parts: if the cows obtain at least $P_i$ points $(1 <= P_i <= 40,000)$ for the first $K_i$ events (including other bonuses involving just those events), they will get an additional $A_i$ points $(1 <= A_i <= 1000)$.  \n\nFor example, let us consider $N = 3$ cows with the following skills:\n\n```\n      E V E N T\n     | 1 | 2 | 3\n   --+---+---+--\nC  1 | 5 | 1 | 7\n   --+---+---+--\nO  2 | 2 | 2 | 4\n   --+---+---+--\nW  3 | 4 | 2 | 1\n```\nFor example, cow 1 would earn the team 7 points if she participates in event 3.  \n\nSuppose the judges offer a bonus (B = 1), such that if the if the cows score at least 7 points in the first two events, they will get an  additional 6 points.  Here, the optimal assignment would be to assign cow 1 to event 1, cow 2 to event 3 and cow 3 to event 2.  For the first two events, cow 1 will score 5 points and cow 3 will score 2 points giving them 7 points, which is enough to satisfy bonus 1.  Therefore, the total points that they score will be 5+2+4+6=17.\n\nPlease help decide which events the cows should attempt to maximize their total score.", "inputFormat": "* Line 1: Two space-separated integers: $N, B$\n\n* Lines 2..B+1: Line i+1 will contain the information for bonus i which is three space- separated integers: $K_i, P_i, A_i$.\n\n* Lines B+2..B+N+1: Line B+1+j will contain the information on how cow j will perform at each  of her events. This will be given in $N$ space-separated integers: $s_j1...s_jN.$", "outputFormat": "* Line 1: The maximum amount of points that the cows can receive, including bonuses.\n", "hint": "Cow 1 will perform event 1, cow 3 will perform event 2, and cow 2 will  perform event 3.", "locale": "en"}, "zh-CN": {"title": "[USACO14FEB] Cow Decathlon G", "background": null, "description": "#### 题目大意\n\n约翰有 $N$ 头奶牛，组成了一支队伍参加全能比赛。\n\n比赛一共有 $N$ 项，按照顺序依次进行。每头奶牛必须参加一项比赛，每项比赛也必须有一头奶牛参加。\n\n每头奶牛都可以胜任每一项比赛，但得分不一样。如果第 $i$ 头奶牛参加第 $j$ 项比赛，在比赛结束的时候，可以为团体总分增加 $S_{i,j}$。\n\n除了上述获得分数的方法之外，还有 $B$ 种奖励分。获得奖励的方法是在前几项比赛里获得足够的分数。\n\n具体来说，第 $i$ 项奖励会在第 $K_i$ 项比赛结束的时候检查，如果当时的总分大于或等于 $P_i$，奶牛们就可以立即获得额外的 $A_i$ 分。\n\n如果有多项奖励在同一时刻检查，奶牛可以自由安排检查和加分的顺序。\n\n请问约翰应该如何安排奶牛参加比赛，才能让它们获得最高的分数？", "inputFormat": "第 $1$ 行：两个整数 $N$ 和 $B$。\n\n第 $2$ 行到第 $B+1$ 行：第 $i+1$ 行有三个整数 $K_i$，$P_i$ 和 $A_i$。\n\n第 $B+2$ 行到第 $B+N+1$ 行：第 $i+B+1$ 行有 $N$ 个整数，代表 $S_{i,1}$ 到 $S_{i,N}$。", "outputFormat": "单个整数，表示奶牛们可以获得的最大得分。", "hint": "#### 样例解释 #1\n\n第一项比赛由第一头奶牛参加，第二项比赛由第三头奶牛参加，第三项比赛由第二头奶牛参加。\n\n#### 数据范围\n\n对于所有数据，$1 \\le N,B \\le 20$，$1 \\le K_i \\le N$ ，$1 \\le P_i \\le 4 \\times 10^4$，$1 \\le A_i \\le 10^3$，$1 \\le S_{i,j} \\le 10^3$。\n\ntranslator：2018_RNG丶妖夢", "locale": "zh-CN"}}}
{"pid": "P4878", "type": "P", "difficulty": 4, "samples": [["4 2 1\n1 3 10\n2 4 20\n2 3 3", "27"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2005", "USACO", "最短路", "差分约束", "差分"], "title": "[USACO05DEC] Layout G", "background": "14组数据，前10组为原数据，后4组为hack数据", "description": "Like everyone else, cows like to stand close to their friends when queuing for feed. FJ has N (2 <= N <= 1,000) cows numbered 1..N standing along a straight line waiting for feed. The cows are standing in the same order as they are numbered, and since they can be rather pushy, it is possible that two or more cows can line up at exactly the same location (that is, if we think of each cow as being located at some coordinate on a number line, then it is possible for two or more cows to share the same coordinate). \n\nSome cows like each other and want to be within a certain distance of each other in line. Some really dislike each other and want to be separated by at least a certain distance. A list of ML (1 <= ML <= 10,000) constraints describes which cows like each other and the maximum distance by which they may be separated; a subsequent list of MD constraints (1 <= MD <= 10,000) tells which cows dislike each other and the minimum distance by which they must be separated. \n\nYour job is to compute, if possible, the maximum possible distance between cow 1 and cow N that satisfies the distance constraints.", "inputFormat": "Line 1: Three space-separated integers: N, ML, and MD. \n\nLines 2..ML+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at most D (1 <= D <= 1,000,000) apart. \n\nLines ML+2..ML+MD+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at least D (1 <= D <= 1,000,000) apart.", "outputFormat": "Line 1: A single integer. If no line-up is possible, output -1. If cows 1 and N can be arbitrarily far apart, output -2. Otherwise output the greatest possible distance between cows 1 and N.\n", "hint": "Explanation of the sample: \n\nThere are 4 cows. Cows #1 and #3 must be no more than 10 units apart, cows #2 and #4 must be no more than 20 units apart, and cows #2 and #3 dislike each other and must be no fewer than 3 units apart. \n\nThe best layout, in terms of coordinates on a number line, is to put cow #1 at 0, cow #2 at 7, cow #3 at 10, and cow #4 at 27.", "locale": "en", "translations": {"en": {"title": "[USACO05DEC] Layout G", "background": "14组数据，前10组为原数据，后4组为hack数据", "description": "Like everyone else, cows like to stand close to their friends when queuing for feed. FJ has N (2 <= N <= 1,000) cows numbered 1..N standing along a straight line waiting for feed. The cows are standing in the same order as they are numbered, and since they can be rather pushy, it is possible that two or more cows can line up at exactly the same location (that is, if we think of each cow as being located at some coordinate on a number line, then it is possible for two or more cows to share the same coordinate). \n\nSome cows like each other and want to be within a certain distance of each other in line. Some really dislike each other and want to be separated by at least a certain distance. A list of ML (1 <= ML <= 10,000) constraints describes which cows like each other and the maximum distance by which they may be separated; a subsequent list of MD constraints (1 <= MD <= 10,000) tells which cows dislike each other and the minimum distance by which they must be separated. \n\nYour job is to compute, if possible, the maximum possible distance between cow 1 and cow N that satisfies the distance constraints.", "inputFormat": "Line 1: Three space-separated integers: N, ML, and MD. \n\nLines 2..ML+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at most D (1 <= D <= 1,000,000) apart. \n\nLines ML+2..ML+MD+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at least D (1 <= D <= 1,000,000) apart.", "outputFormat": "Line 1: A single integer. If no line-up is possible, output -1. If cows 1 and N can be arbitrarily far apart, output -2. Otherwise output the greatest possible distance between cows 1 and N.\n", "hint": "Explanation of the sample: \n\nThere are 4 cows. Cows #1 and #3 must be no more than 10 units apart, cows #2 and #4 must be no more than 20 units apart, and cows #2 and #3 dislike each other and must be no fewer than 3 units apart. \n\nThe best layout, in terms of coordinates on a number line, is to put cow #1 at 0, cow #2 at 7, cow #3 at 10, and cow #4 at 27.", "locale": "en"}, "zh-CN": {"title": "[USACO05DEC] Layout G", "background": null, "description": "正如其他物种一样，奶牛们也喜欢在排队打饭时与它们的朋友挨在一起。FJ 有编号为 $1\\dots N$ 的 $N$ 头奶牛 $(2\\le N\\le 1000)$。奶牛们始终需要按照编号顺序来排队。奶牛们很笨拙，因此可能有多头奶牛在同一位置上。\n\n有些奶牛是好基友，它们希望彼此之间的距离小于等于某个数。有些奶牛是情敌，它们希望彼此之间的距离大于等于某个数。\n\n给出 $M_L$ 对好基友的编号，以及它们希望彼此之间的距离小于等于多少；又给出 $M_D$ 对情敌的编号，以及它们希望彼此之间的距离大于等于多少 $(1\\le M_L,$ $M_D\\le 10^4)$。\n\n请计算：如果满足上述所有条件，$1$ 号奶牛和 $N$ 号奶牛之间的距离最大为多少。", "inputFormat": "第一行：三个整数 $N, M_L, M_D$，用空格分隔。\n\n第 $2\\dots M_L+1$ 行：每行三个整数 $A, B, D$，用空格分隔，表示 $A$ 号奶牛与 $B$ 号奶牛之间的距离须 $\\le D$。保证 $1\\le A<B\\le N,$ $1\\le D\\le 10^6$。\n\n第 $M_L+2\\dots M_L+M_D+1$ 行：每行三个整数 $A, B, D$，用空格分隔，表示 $A$ 号奶牛与 $B$ 号奶牛之间的距离须 $\\ge D$。保证 $1\\le A<B\\le N,$ $1\\le D\\le 10^6$。", "outputFormat": "一行，一个整数。如果没有合法方案，输出 `-1`. 如果有合法方案，但 $1$ 号奶牛可以与 $N$ 号奶牛相距无穷远，输出 `-2`. 否则，输出 $1$ 号奶牛与 $N$ 号奶牛间的最大距离。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P4879", "type": "P", "difficulty": 5, "samples": [["5 10\n1 2 3 4 5\nQ\nC 3 2\nQ\nI 6 6\nQ\nD 4\nQ\nC 5 2\nI 7 9\nQ", "15\n13\n19\n15\n22"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "树状数组", "分块"], "title": "ycz的妹子", "background": "ycz 有很多很多的妹子（ycz：瞎说）", "description": "机房神犇 ycz 有 $n$ 个青梅竹马，她们分别住在 $1\\sim n$ 号城市中。小时候的她们美丽可爱，但是由于女大十八变，有些妹子的颜值发生了变化，但是十分重感情的 ycz 神犇不忍心抛弃她们，于是记录下来了她们颜值变化的值，我们用 $C, x, y$ 表示第 $x$ 个城市的妹子的颜值下降了 $y$。长大之后的 ycz 非常有魅力，有许多妹子被 ycz 迷得神魂颠倒，我们用 $I, x, y$ 表示第 $x$ 个城市有一个妹子喜欢上了 ycz ，她的颜值为 $y$（$y$ 有可能是负数，但是 ycz 来者不拒）。但在中途有一些妹子和 ycz 吵架了，于是就分手了，我们用 $D, x$ 表示**第 $x$ 个妹子**和 ycz 分手了。\n\n最近神犇 ycz 要去全国各地找他的妹子们，为了方便计算，我们珂以把 ycz 的妹子所在的城市当作是一条直线，并且挨在一起。神犇 ycz 由于忙于和他的妹子们联系此时已经很累了，于是交给你一个这样的任务：他想知道他在某个时间去找他的所有妹子们珂以获得多大的愉悦度，这个愉悦度为他找的妹子的颜值数，你要做的就是求出这个愉悦度之和（注意长大后妹子们的颜值可能为负数/滑稽）。\n\n注意：每个城市只允许有一个妹子，也就是说后来喜欢上 ycz 的妹子会赶走之前这个城市喜欢 ycz 的妹子 ~~（一城不容二女）~~。\n\nUPD:\n\n青梅竹马都是喜欢 ycz 的。\n\n分手的第 $x$ 个妹子不是第 $x$ 城市的妹子，是指从前往后数第 $x$ 个有妹子的城市的妹子。\n\n青梅竹马长大后就是妹子。\n\n修改的值 $y$ 不为负数，但是颜值减去之后可能为负数。", "inputFormat": "ycz 有 $5 \\times 10^5$ 座城市，开始时，前 $n$ 座城市各有一个妹子，第 $i$ 座城市妹子初始的颜值为 $a_i$。\n\n有 $m$ 次以下四种操作。\n\n - `C x y` 第 $x$ 座城市的妹子颜值减少 $y$；\n - `I x y` 第 $x$ 座城市出现了一个颜值为 $y$ 的妹子，如果在此之前，第 $x$ 座城市已经有妹子，则之前的妹子被驱赶；\n - `D x` 第 $x$ 个有妹子的城市 中的妹子与 ycz 分手；\n - `Q` ycz 想知道他所有妹子的颜值总和是多少。\n\n本题数据在 Windows 下生成，输入中换行均为 `\\r\\n` 而非 `\\n`。", "outputFormat": "对于每一个 $Q$ 输出一个整数", "hint": "**样例解释：**\n\n妹子颜值变化如下，删除的就没写在下面了。\n\n```\n1 2 1 4 5\n1 2 1 4 5 6\n1 2 1 5 6\n1 2 1 3 6\n1 2 1 3 6 9\n```\n\n对于 $30\\%$ 的数据，$1 \\le n,m \\le 10$\n\n对于 $70\\%$ 的数据，$1 \\le n,m \\le 1000$\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 100000,|a_i|,|y| \\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "ycz’s Girls", "background": "ycz has a lot, a lot of girls (ycz: just kidding).", "description": "The legendary ycz has $n$ childhood sweethearts, and they live in cities numbered $1 \\sim n$. When they were young, they were pretty and cute. But as time went by, some girls’ looks changed. Since ycz is very sentimental and cannot bear to abandon them, he recorded the amount of change in their looks.\n\nWe use $C, x, y$ to mean that the girl in city $x$ has her looks decreased by $y$.\n\nAfter growing up, ycz became very charming, and many girls fell for him. We use $I, x, y$ to mean that in city $x$ a girl appears who likes ycz, and her looks value is $y$ ($y$ may be negative, but ycz accepts everyone). However, some girls quarrel with ycz and then break up. We use $D, x$ to mean that the **$x$-th girl** breaks up with ycz.\n\nRecently, ycz is going to visit his girls all around the country. For easier calculation, we can treat the cities where his girls are as points on a straight line, placed next to each other. ycz is already tired from keeping in touch with his girls, so he gives you this task:\n\nHe wants to know, at some time, how much “happiness” he can get by visiting all of his girls. This happiness is defined as the sum of the girls’ looks values he visits. Your job is to compute this sum (note that after growing up, a girl’s looks value may be negative).\n\nNote: Each city is allowed to have only one girl. That is, a girl who appears later in a city will drive away the previous girl in that city ~~(two girls cannot share one city)~~.\n\nUPD:\n\nChildhood sweethearts all like ycz.\n\nThe $x$-th girl to break up is not the girl in city $x$. It means the girl in the $x$-th city (counting from left to right) that currently has a girl.\n\nChildhood sweethearts become “girls” after growing up.\n\nThe modified value $y$ is not negative, but the looks value may become negative after subtraction.", "inputFormat": "ycz has $5 \\times 10^5$ cities. Initially, each of the first $n$ cities has one girl, and the initial looks value of the girl in city $i$ is $a_i$.\n\nThere are $m$ operations of the following four types.\n\n - `C x y` The looks value of the girl in city $x$ decreases by $y$.\n - `I x y` A girl with looks value $y$ appears in city $x$. If there was already a girl in city $x$ before, the previous girl is driven away.\n - `D x` The girl in the $x$-th city (among the cities that currently have a girl) breaks up with ycz.\n - `Q` ycz wants to know the total sum of looks values of all his girls.", "outputFormat": "For each `Q`, output one integer.", "hint": "**Sample explanation:**\n\nThe looks values change as follows. Deleted ones are not written below.\n\n```\n1 2 1 4 5\n1 2 1 4 5 6\n1 2 1 5 6\n1 2 1 3 6\n1 2 1 3 6 9\n```\n\nFor 30% of the testdata, $1 \\le n,m \\le 10$.\n\nFor 70% of the testdata, $1 \\le n,m \\le 1000$.\n\nFor 100% of the testdata, $1 \\le n,m \\le 100000,|a_i|,|y| \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "ycz的妹子", "background": "ycz 有很多很多的妹子（ycz：瞎说）", "description": "机房神犇 ycz 有 $n$ 个青梅竹马，她们分别住在 $1\\sim n$ 号城市中。小时候的她们美丽可爱，但是由于女大十八变，有些妹子的颜值发生了变化，但是十分重感情的 ycz 神犇不忍心抛弃她们，于是记录下来了她们颜值变化的值，我们用 $C, x, y$ 表示第 $x$ 个城市的妹子的颜值下降了 $y$。长大之后的 ycz 非常有魅力，有许多妹子被 ycz 迷得神魂颠倒，我们用 $I, x, y$ 表示第 $x$ 个城市有一个妹子喜欢上了 ycz ，她的颜值为 $y$（$y$ 有可能是负数，但是 ycz 来者不拒）。但在中途有一些妹子和 ycz 吵架了，于是就分手了，我们用 $D, x$ 表示**第 $x$ 个妹子**和 ycz 分手了。\n\n最近神犇 ycz 要去全国各地找他的妹子们，为了方便计算，我们珂以把 ycz 的妹子所在的城市当作是一条直线，并且挨在一起。神犇 ycz 由于忙于和他的妹子们联系此时已经很累了，于是交给你一个这样的任务：他想知道他在某个时间去找他的所有妹子们珂以获得多大的愉悦度，这个愉悦度为他找的妹子的颜值数，你要做的就是求出这个愉悦度之和（注意长大后妹子们的颜值可能为负数/滑稽）。\n\n注意：每个城市只允许有一个妹子，也就是说后来喜欢上 ycz 的妹子会赶走之前这个城市喜欢 ycz 的妹子 ~~（一城不容二女）~~。\n\nUPD:\n\n青梅竹马都是喜欢 ycz 的。\n\n分手的第 $x$ 个妹子不是第 $x$ 城市的妹子，是指从前往后数第 $x$ 个有妹子的城市的妹子。\n\n青梅竹马长大后就是妹子。\n\n修改的值 $y$ 不为负数，但是颜值减去之后可能为负数。", "inputFormat": "ycz 有 $5 \\times 10^5$ 座城市，开始时，前 $n$ 座城市各有一个妹子，第 $i$ 座城市妹子初始的颜值为 $a_i$。\n\n有 $m$ 次以下四种操作。\n\n - `C x y` 第 $x$ 座城市的妹子颜值减少 $y$；\n - `I x y` 第 $x$ 座城市出现了一个颜值为 $y$ 的妹子，如果在此之前，第 $x$ 座城市已经有妹子，则之前的妹子被驱赶；\n - `D x` 第 $x$ 个有妹子的城市 中的妹子与 ycz 分手；\n - `Q` ycz 想知道他所有妹子的颜值总和是多少。\n\n本题数据在 Windows 下生成，输入中换行均为 `\\r\\n` 而非 `\\n`。", "outputFormat": "对于每一个 $Q$ 输出一个整数", "hint": "**样例解释：**\n\n妹子颜值变化如下，删除的就没写在下面了。\n\n```\n1 2 1 4 5\n1 2 1 4 5 6\n1 2 1 5 6\n1 2 1 3 6\n1 2 1 3 6 9\n```\n\n对于 $30\\%$ 的数据，$1 \\le n,m \\le 10$\n\n对于 $70\\%$ 的数据，$1 \\le n,m \\le 1000$\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 100000,|a_i|,|y| \\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P4880", "type": "P", "difficulty": 4, "samples": [["6 9 1 6\n1 2 1\n1 3 3\n1 4 4\n2 3 2\n3 6 6\n4 5 6\n2 5 9\n3 5 7\n5 6 2\n3\n10 3\n8 5\n9 2", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["排序", "最短路"], "title": "抓住czx", "background": "蒟蒻 lty 出了一道题，但是由于太弱了，所以希望喜欢鸽子的 czx 来帮他写一个 std 。由于 czx 又放鸽子去了，所以没有写 std。蒟蒻 lty 觉得受到了学长的鄙视，所以决定去 czx 放鸽子的地方找他。", "description": "czx 放鸽子的地方是一个公园，公园可以看作是由 $n$ 个点 $m$ 条边组成的无向图（保证无自环），lty 将从公园的入口（$b$ 号节点）进去寻找 czx，czx 刚开始的位置为 $e$，而 czx 会在 $a_i$ 个单位时间时变化位置到第 $x$ 个节点去，在此之前 lty 已经知道了 czx 的具体位置和接下来他位置的变化方案，蒟蒻 lty 现在想知道他至少需要花多少时间找到 czx。\n\nUPD:\n\n保证图连通，czx 最后会待在一个地方不动。", "inputFormat": "第一行四个整数 $n,m,b,e$。$b$ 和 $e$ 的意义如题面所示。\n\n接下来 $m$ 行，每行三个整数 $x,y,z$，表示 $x$ 到 $y$ 之间有一条双向边，lty 走这条边要花费 $z$ 的时间。\n\n第 $m+1$ 行一个整数 $T$，表示 czx 位置变化的次数。\n\n接下来 $T$ 行，每行两个整数 $a_i$ 和 $x$，表示 czx 将在第 $a_i$ 个单位时间时移动到第 $x$ 个点上去。", "outputFormat": "一个整数，表示最短所需时间。", "hint": "**样例解释：**\n\n在开始的时候就直接走到 $2$ 号节点，然后等到 czx过来。总花费时间 $9$ 个单位时间。\n\n对于 30% 的数据，$n\\le 100,m\\le 1000,T\\le 100$\n\n对于另外 30% 的数据，$T=0$\n\n对于 100% 的数据，$n \\le 10^5,m \\le 5\\times10^5,T \\le 10^5$\n\n数据保证所有时间在 int 范围内\n\n注意：在任意一个 czx 开始移动的时间点，都是 czx 先瞬移，然后 lty 再行走，也就是说， lty 不能在 czx 瞬移的时候到他瞬移前的点抓住他，但是 lty 可以在他瞬移到的点等着抓他。", "locale": "zh-CN", "translations": {"en": {"title": "Catch czx", "background": "Beginner lty made a problem, but he was too weak, so he wanted czx, who likes “letting pigeons” (fang ge zi), to help him write a std. However, czx went to “let pigeons” again, so he did not write the std. Beginner lty felt looked down upon by his senior, so he decided to go to the place where czx is “letting pigeons” to find him.", "description": "The place where czx is “letting pigeons” is a park. The park can be seen as an undirected graph with $n$ nodes and $m$ edges (self-loops are guaranteed not to exist). lty will enter from the entrance of the park (node $b$) to look for czx. czx’s initial position is $e$. Then, at time $a_i$, czx will change his position to node $x$. Before that, lty already knows czx’s exact position and his future movement plan. Now beginner lty wants to know the minimum time needed to catch czx.\n\nUPD:\n\nThe graph is guaranteed to be connected, and czx will finally stay at one place and stop moving.", "inputFormat": "The first line contains four integers $n, m, b, e$. The meanings of $b$ and $e$ are as described in the statement.\n\nThe next $m$ lines each contain three integers $x, y, z$, indicating there is a bidirectional edge between $x$ and $y$, and it takes lty $z$ time to traverse this edge.\n\nThe $(m+1)$-th line contains an integer $T$, indicating the number of times czx changes his position.\n\nThe next $T$ lines each contain two integers $a_i$ and $x$, indicating that at time $a_i$, czx will move to node $x$.", "outputFormat": "Output one integer, the minimum required time.", "hint": "**Sample explanation:**\n\nAt the beginning, go directly to node $2$, then wait for czx to come. The total time cost is $9$ units of time.\n\nFor 30% of the testdata, $n \\le 100, m \\le 1000, T \\le 100$.\n\nFor another 30% of the testdata, $T = 0$.\n\nFor 100% of the testdata, $n \\le 10^5, m \\le 5\\times10^5, T \\le 10^5$.\n\nThe testdata guarantees that all times fit in the range of int.\n\nNote: At any time when czx starts moving, czx teleports first, and then lty moves. That is, lty cannot catch czx at the node before he teleports at the teleport moment, but lty can wait at the destination node and catch him there.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "抓住czx", "background": "蒟蒻 lty 出了一道题，但是由于太弱了，所以希望喜欢鸽子的 czx 来帮他写一个 std 。由于 czx 又放鸽子去了，所以没有写 std。蒟蒻 lty 觉得受到了学长的鄙视，所以决定去 czx 放鸽子的地方找他。", "description": "czx 放鸽子的地方是一个公园，公园可以看作是由 $n$ 个点 $m$ 条边组成的无向图（保证无自环），lty 将从公园的入口（$b$ 号节点）进去寻找 czx，czx 刚开始的位置为 $e$，而 czx 会在 $a_i$ 个单位时间时变化位置到第 $x$ 个节点去，在此之前 lty 已经知道了 czx 的具体位置和接下来他位置的变化方案，蒟蒻 lty 现在想知道他至少需要花多少时间找到 czx。\n\nUPD:\n\n保证图连通，czx 最后会待在一个地方不动。", "inputFormat": "第一行四个整数 $n,m,b,e$。$b$ 和 $e$ 的意义如题面所示。\n\n接下来 $m$ 行，每行三个整数 $x,y,z$，表示 $x$ 到 $y$ 之间有一条双向边，lty 走这条边要花费 $z$ 的时间。\n\n第 $m+1$ 行一个整数 $T$，表示 czx 位置变化的次数。\n\n接下来 $T$ 行，每行两个整数 $a_i$ 和 $x$，表示 czx 将在第 $a_i$ 个单位时间时移动到第 $x$ 个点上去。", "outputFormat": "一个整数，表示最短所需时间。", "hint": "**样例解释：**\n\n在开始的时候就直接走到 $2$ 号节点，然后等到 czx过来。总花费时间 $9$ 个单位时间。\n\n对于 30% 的数据，$n\\le 100,m\\le 1000,T\\le 100$\n\n对于另外 30% 的数据，$T=0$\n\n对于 100% 的数据，$n \\le 10^5,m \\le 5\\times10^5,T \\le 10^5$\n\n数据保证所有时间在 int 范围内\n\n注意：在任意一个 czx 开始移动的时间点，都是 czx 先瞬移，然后 lty 再行走，也就是说， lty 不能在 czx 瞬移的时候到他瞬移前的点抓住他，但是 lty 可以在他瞬移到的点等着抓他。", "locale": "zh-CN"}}}
{"pid": "P4881", "type": "P", "difficulty": 5, "samples": [["2\n1\n3", "26\n2054"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "线性递推", "逆元"], "title": "hby与tkw的基情", "background": "> 基情恒久远，一对永流传。\n\nhby 和 tkw 是一对好基友，他们经常在一起做♂游♂戏 (/滑稽)。\n", "description": "他们喜欢玩字符串游戏，尤其喜欢玩回文串。每次 hby 会给出一个数 $n$，那么 tkw 就需要给出 $Ans=\\sum\\limits_{i=1}^ni\\times s[i]\\times[i\\bmod 2]$。其中 $s[i]$ 代表长度为 $i$ 的回文串的个数（只考虑小写字母），最后面是 bool 表达式\n\n不过由于 tkw 最近学 ycz 找妹纸去了，于是他就将这个问题交给了你，如果你不能在 $1\\rm s$ 内答出来，那么 hby 和 tkw 的基情将会破裂！~~（不过那样 tkw 就可以安心地找妹纸了）~~\n\n由于答案会非常大，所以你只需要输出答案 $\\bmod 10^9+7$ 的值即可", "inputFormat": "第一行一个整数 $T$。\n\n接下来 $T$ 行，每行一个数 $n$。", "outputFormat": "共 $T$ 行，每行代表一个答案。", "hint": "对于 $10\\%$的数据，$n\\le 5$。\n\n对于另外 $20\\%$ 的数据，$\\sum n\\le 10^7$。\n\n对于另外 $20\\%$ 的数据，$T=1$。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 5\\times 10^5$，$1\\le n\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "hby and tkw’s Bromance", "background": "> Bromance lasts forever, a pair will be passed down for eternity.\n\nhby and tkw are a pair of close buddies. They often play “games” together (/joking).", "description": "They like playing string games, and they especially like palindromes. Each time, hby gives a number $n$, and then tkw needs to give $Ans=\\sum\\limits_{i=1}^ni\\times s[i]\\times[i\\bmod 2]$. Here, $s[i]$ represents the number of palindromic strings of length $i$ (only lowercase letters are considered). The last part is a bool expression.\n\nHowever, recently tkw has been learning from ycz to go find a girlfriend, so he handed this problem to you. If you cannot answer it within $1\\rm s$, then the bromance between hby and tkw will break! ~~(But then tkw can focus on finding a girlfriend.)~~\n\nSince the answer will be very large, you only need to output the value of the answer $\\bmod 10^9+7$.", "inputFormat": "The first line contains an integer $T$.\n\nIn the next $T$ lines, each line contains one number $n$.", "outputFormat": "There are $T$ lines in total, each line represents one answer.", "hint": "For $10\\%$ of the testdata, $n\\le 5$.\n\nFor another $20\\%$ of the testdata, $\\sum n\\le 10^7$.\n\nFor another $20\\%$ of the testdata, $T=1$.\n\nFor $100\\%$ of the testdata, $1\\le T\\le 5\\times 10^5$, $1\\le n\\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "hby与tkw的基情", "background": "> 基情恒久远，一对永流传。\n\nhby 和 tkw 是一对好基友，他们经常在一起做♂游♂戏 (/滑稽)。\n", "description": "他们喜欢玩字符串游戏，尤其喜欢玩回文串。每次 hby 会给出一个数 $n$，那么 tkw 就需要给出 $Ans=\\sum\\limits_{i=1}^ni\\times s[i]\\times[i\\bmod 2]$。其中 $s[i]$ 代表长度为 $i$ 的回文串的个数（只考虑小写字母），最后面是 bool 表达式\n\n不过由于 tkw 最近学 ycz 找妹纸去了，于是他就将这个问题交给了你，如果你不能在 $1\\rm s$ 内答出来，那么 hby 和 tkw 的基情将会破裂！~~（不过那样 tkw 就可以安心地找妹纸了）~~\n\n由于答案会非常大，所以你只需要输出答案 $\\bmod 10^9+7$ 的值即可", "inputFormat": "第一行一个整数 $T$。\n\n接下来 $T$ 行，每行一个数 $n$。", "outputFormat": "共 $T$ 行，每行代表一个答案。", "hint": "对于 $10\\%$的数据，$n\\le 5$。\n\n对于另外 $20\\%$ 的数据，$\\sum n\\le 10^7$。\n\n对于另外 $20\\%$ 的数据，$T=1$。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 5\\times 10^5$，$1\\le n\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4882", "type": "P", "difficulty": 6, "samples": [["3 1", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": [], "title": "lty loves 96！", "background": "众所周知，$lty$非常喜欢$96$这两个数字（想歪的现在马上面壁去），更甚于复读~~（人本复）~~！", "description": "由于爱屋及乌，因此，$lty$对于那些含有$96$的数也非常喜欢，而这里的含有不是一般的含有，而是具有以下性质的含有（三条都需要满足）：\n* 这个数为一个$N$位数，且没有前置零\n* 这个数中至少要出现$M$次$9$和$6$（例：$986996$中出现了$5$次，$9$出现了$3$次，$6$出现了$2$次，共计$5$次）\n* 这个数存在连续的三位$A$,$B$,$C$，满足下面任意一条\n\t* $A+B+C$为$9$或$6$\n\t* $(A^2+B^2)$%$C$为$9$或$6$，如果$C$为$0$，则该条件视为不满足", "inputFormat": "一行，两个数$N$,$M$", "outputFormat": "一个数，表示这样的数的个数", "hint": "对于10%的数据，$N<=6$\n\n对于40%的数据，$N<=18$\n\n对于100%的数据，$N<=50$，$0<=M<=N$\n", "locale": "zh-CN", "translations": {"en": {"title": "lty Loves 96!", "background": "As everyone knows, $lty$ really likes the two digits $96$ (if your mind went the wrong way, go face the wall right now), even more than repeating a grade ~~(a repeating student)~~!", "description": "Because of “loving what someone loves”, $lty$ also likes numbers that “contain $96$”. Here, “contain” does not mean the usual kind of contain, but must satisfy all of the following properties (all three must be met):\n\n* The number is an $N$-digit number and has no leading zeros.\n* In this number, the digits $9$ and $6$ appear at least $M$ times in total (example: $986996$ has $5$ occurrences in total: $9$ appears $3$ times and $6$ appears $2$ times, for a total of $5$).\n* There exist three consecutive digits $A$, $B$, $C$ that satisfy at least one of the following:\n\t* $A+B+C$ equals $9$ or $6$.\n\t* $(A^2+B^2)$%$C$ equals $9$ or $6$. If $C$ is $0$, then this condition is considered not satisfied.", "inputFormat": "One line with two numbers $N$, $M$.", "outputFormat": "One number, representing the count of such numbers.", "hint": "For $10\\%$ of the testdata, $N \\le 6$.\n\nFor $40\\%$ of the testdata, $N \\le 18$.\n\nFor $100\\%$ of the testdata, $N \\le 50$, $0 \\le M \\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "lty loves 96！", "background": "众所周知，$lty$非常喜欢$96$这两个数字（想歪的现在马上面壁去），更甚于复读~~（人本复）~~！", "description": "由于爱屋及乌，因此，$lty$对于那些含有$96$的数也非常喜欢，而这里的含有不是一般的含有，而是具有以下性质的含有（三条都需要满足）：\n* 这个数为一个$N$位数，且没有前置零\n* 这个数中至少要出现$M$次$9$和$6$（例：$986996$中出现了$5$次，$9$出现了$3$次，$6$出现了$2$次，共计$5$次）\n* 这个数存在连续的三位$A$,$B$,$C$，满足下面任意一条\n\t* $A+B+C$为$9$或$6$\n\t* $(A^2+B^2)$%$C$为$9$或$6$，如果$C$为$0$，则该条件视为不满足", "inputFormat": "一行，两个数$N$,$M$", "outputFormat": "一个数，表示这样的数的个数", "hint": "对于10%的数据，$N<=6$\n\n对于40%的数据，$N<=18$\n\n对于100%的数据，$N<=50$，$0<=M<=N$\n", "locale": "zh-CN"}}}
{"pid": "P4883", "type": "P", "difficulty": 6, "samples": [["8 9\n4 6 2 1 7 9 10 2\n1 1 4\n3 1 6\n2 4 5 2\n3 1 6\n2 1 5 8\n3 1 6\n2 5 7 10\n3 4 7\n3 1 8\n", "29\n29\n69\n24\n59"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["平衡树", "进制"], "title": "mzf的考验", "background": "$mzf$立志要成为一个豪杰，当然，他也是一个$OIer$。\n他希望自己除了会$OI$之外还会各种东西，比如心理学、吉他、把妹等等。\n为了让自己有更大的魅力，他不驼背，不熬夜，整天锻炼，双目炯炯有神，是我们机房最不像$OIer$的人。\n然而，在与我们格格不入若干天并且将《易经》研究透彻之后，承受不住我们对他另类的言论，他爆发了。\n机房在那一刹那仿佛天塌地陷，世界末日。", "description": "八卦有乾、坤、震、巽、坎、离、艮、兑；\n两两组合，一上一下，形成了六十四卦，每卦六爻，一共三百八十四爻。\n爻分阴阳，阳爻性属阳刚，阴爻性属阴柔。天下之大，无奇不有。千奇百怪，皆出此处。\n$mzf$研究透彻了易经之后，画出了$n$个奇怪的图案。他说那是他改进出来的更强大的卜卦体系。\n每一个图案有二十行，每一行要么是阴爻$(0)$，要么是阳爻$(1)$，作为一个$OIer$，我们可以将卦象看成一个个二进制串；\n他将$n$个图案画在了符纸上，然后进行$m$次操作：\n\n操作1：翻转区间$[l,r]$的图案，比如$(3,1,2,5)$变成$(5,2,1,3)$；\n\n操作2：$mzf$画地为卦，将$[l,r]$之间的卦象都异或上新画的那个卦象；\n\n操作3：$mzf$会询问机房里的其他人$[l,r]$之间卦象代表的二进制数权值和。\n\n如果不能正确回答每个操作$3$，那么机房风水格局将会改变，我们都将...！\n\n由于$mzf$疯狂之下将我们都捆♂绑♂了起来，所以只能求求你来帮我们解决这个问题。", "inputFormat": "第一行两个正整数：$n$，$m$（$n$为序列长度，$m$为操作个数）\n\n第二行$n$个正整数：$a[i]$ (用$10$进制数表示每个卦象)$(1<=i<=n)$\n\n接下来$m$行：每行首先一个正整数$opt$表示操作类型\n\n1. $opt=1$：两个正整数：$l,r$。请翻转区间 $[l,r]$；\n2. $opt=2$：三个正整数：$l,r,d$。请将区间$[l,r]$中的所有卦象都异或卦象$d$。（$0\\le d\\lt 2^{20}$）\n3. $opt=3$：两个正整数：$l,r$。请查询区间 $[l,r]$ 的卦象权值和。", "outputFormat": "对于每个 $opt=3$ 的情况，输出一行答案。", "hint": "对于 $20\\%$ 的数据，$n\\le1000$，$m\\le 1000$。\n\n对于另外 $20\\%$ 的数据，不存在操作 $1$。\n\n对于另外 $20\\%$ 的数据，保证 $n$ 为 $2$ 的次幂，且在操作 $1$ 中，保证 $l=i\\times(2^j)+1$，$r=(i+1)\\times(2^j)$，其中 $i,j$ 为任意值。\n\n对于 $100\\%$ 的数据，$n\\le 10^5$，$m\\le 5\\times 10^4$，$1\\le l\\le r\\le n$，$0\\le d<2^{20}$。", "locale": "zh-CN", "translations": {"en": {"title": "mzf's Trial.", "background": "$mzf$ is determined to become a hero. Of course, he is also an $OIer$.\nHe hopes that besides being good at $OI$, he can also do many other things, such as psychology, guitar, flirting, and so on.\nTo be more attractive, he does not hunch his back, does not stay up late, works out all day, and has bright eyes. He is the least like an $OIer$ in our computer room.\nHowever, after being out of place with us for several days and thoroughly studying the I Ching, he could not stand our weird comments about him, and he exploded.\nAt that moment, it felt like the sky was falling and the earth was collapsing. It was like the end of the world.", "description": "The Eight Trigrams are Qian, Kun, Zhen, Xun, Kan, Li, Gen, and Dui.\nCombining them in pairs, one on top and one below, forms the sixty-four hexagrams. Each hexagram has six lines, making a total of 384 lines.\nLines are divided into yin and yang. A yang line is strong, and a yin line is soft. The world is vast, and anything can happen. All kinds of strange things come from here.\nAfter thoroughly studying the I Ching, $mzf$ drew $n$ strange patterns. He said they were a stronger divination system improved by him.\nEach pattern has 20 rows. Each row is either a yin line $(0)$ or a yang line $(1)$. As $OIers$, we can view each hexagram as a binary string.\nHe drew these $n$ patterns on talismans, and then performed $m$ operations:\n\nOperation 1: Reverse the patterns in interval $[l,r]$, for example, $(3,1,2,5)$ becomes $(5,2,1,3)$.\n\nOperation 2: $mzf$ draws a new hexagram, and XORs all hexagrams in $[l,r]$ with this newly drawn hexagram.\n\nOperation 3: $mzf$ asks other people in the computer room for the sum of the weights (values) of the binary numbers represented by the hexagrams in $[l,r]$.\n\nIf we cannot correctly answer every Operation $3$, then the feng shui layout of the computer room will change, and we will all...!\n\nSince $mzf$, in his madness, tied us all up, we can only beg you to help us solve this problem.", "inputFormat": "The first line contains two positive integers: $n$, $m$ ($n$ is the length of the sequence, and $m$ is the number of operations).\n\nThe second line contains $n$ positive integers: $a[i]$ (each hexagram is given in decimal)$(1<=i<=n)$.\n\nNext $m$ lines: each line starts with a positive integer $opt$ indicating the operation type.\n\n1. $opt=1$: two positive integers: $l,r$. Please reverse interval $[l,r]$.\n2. $opt=2$: three positive integers: $l,r,d$. Please XOR every hexagram in $[l,r]$ with hexagram $d$. ($0\\le d\\lt 2^{20}$)\n3. $opt=3$: two positive integers: $l,r$. Please query the sum of hexagram weights in interval $[l,r]$.", "outputFormat": "For each case of $opt=3$, output one line with the answer.", "hint": "For $20\\%$ of the testdata, $n\\le1000$, $m\\le 1000$.\n\nFor another $20\\%$ of the testdata, there is no Operation $1$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $n$ is a power of $2$, and in Operation $1$, it is guaranteed that $l=i\\times(2^j)+1$, $r=(i+1)\\times(2^j)$, where $i,j$ can be any values.\n\nFor $100\\%$ of the testdata, $n\\le 10^5$, $m\\le 5\\times 10^4$, $1\\le l\\le r\\le n$, $0\\le d<2^{20}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "mzf的考验", "background": "$mzf$立志要成为一个豪杰，当然，他也是一个$OIer$。\n他希望自己除了会$OI$之外还会各种东西，比如心理学、吉他、把妹等等。\n为了让自己有更大的魅力，他不驼背，不熬夜，整天锻炼，双目炯炯有神，是我们机房最不像$OIer$的人。\n然而，在与我们格格不入若干天并且将《易经》研究透彻之后，承受不住我们对他另类的言论，他爆发了。\n机房在那一刹那仿佛天塌地陷，世界末日。", "description": "八卦有乾、坤、震、巽、坎、离、艮、兑；\n两两组合，一上一下，形成了六十四卦，每卦六爻，一共三百八十四爻。\n爻分阴阳，阳爻性属阳刚，阴爻性属阴柔。天下之大，无奇不有。千奇百怪，皆出此处。\n$mzf$研究透彻了易经之后，画出了$n$个奇怪的图案。他说那是他改进出来的更强大的卜卦体系。\n每一个图案有二十行，每一行要么是阴爻$(0)$，要么是阳爻$(1)$，作为一个$OIer$，我们可以将卦象看成一个个二进制串；\n他将$n$个图案画在了符纸上，然后进行$m$次操作：\n\n操作1：翻转区间$[l,r]$的图案，比如$(3,1,2,5)$变成$(5,2,1,3)$；\n\n操作2：$mzf$画地为卦，将$[l,r]$之间的卦象都异或上新画的那个卦象；\n\n操作3：$mzf$会询问机房里的其他人$[l,r]$之间卦象代表的二进制数权值和。\n\n如果不能正确回答每个操作$3$，那么机房风水格局将会改变，我们都将...！\n\n由于$mzf$疯狂之下将我们都捆♂绑♂了起来，所以只能求求你来帮我们解决这个问题。", "inputFormat": "第一行两个正整数：$n$，$m$（$n$为序列长度，$m$为操作个数）\n\n第二行$n$个正整数：$a[i]$ (用$10$进制数表示每个卦象)$(1<=i<=n)$\n\n接下来$m$行：每行首先一个正整数$opt$表示操作类型\n\n1. $opt=1$：两个正整数：$l,r$。请翻转区间 $[l,r]$；\n2. $opt=2$：三个正整数：$l,r,d$。请将区间$[l,r]$中的所有卦象都异或卦象$d$。（$0\\le d\\lt 2^{20}$）\n3. $opt=3$：两个正整数：$l,r$。请查询区间 $[l,r]$ 的卦象权值和。", "outputFormat": "对于每个 $opt=3$ 的情况，输出一行答案。", "hint": "对于 $20\\%$ 的数据，$n\\le1000$，$m\\le 1000$。\n\n对于另外 $20\\%$ 的数据，不存在操作 $1$。\n\n对于另外 $20\\%$ 的数据，保证 $n$ 为 $2$ 的次幂，且在操作 $1$ 中，保证 $l=i\\times(2^j)+1$，$r=(i+1)\\times(2^j)$，其中 $i,j$ 为任意值。\n\n对于 $100\\%$ 的数据，$n\\le 10^5$，$m\\le 5\\times 10^4$，$1\\le l\\le r\\le n$，$0\\le d<2^{20}$。", "locale": "zh-CN"}}}
{"pid": "P4884", "type": "P", "difficulty": 6, "samples": [["9 17", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["素数判断,质数,筛法", "进制", "洛谷月赛", "大步小步算法 BSGS"], "title": "多少个 1？", "background": "", "description": "给定整数 $K$ 和质数 $m$，求最小的正整数 $N$，使得 $ 11\\cdots1$（$N$ 个 $1$）$\\equiv K \\pmod m$。\n\n说人话：就是 $111\\cdots 1111 \\bmod m = K$。", "inputFormat": "第一行两个整数，分别表示 $K$ 和 $m$。", "outputFormat": "一个整数，表示符合条件最小的 $N$。", "hint": "$30\\%$ 的数据保证 $m\\leq 10^6$。\n\n$60\\%$ 的数据保证 $m\\leq 5\\times 10^7$。\n\n$100\\%$ 的数据保证 $6\\leq m\\leq 10^{11}$，$0< K< m$，保证 $m$ 是质数。", "locale": "zh-CN", "translations": {"en": {"title": "How Many 1s?", "background": "", "description": "Given an integer $K$ and a prime number $m$, find the smallest positive integer $N$ such that $11\\cdots1$ ($N$ digits of $1$) $\\equiv K \\pmod m$.\n\nIn plain words: $111\\cdots 1111 \\bmod m = K$.", "inputFormat": "The first line contains two integers, representing $K$ and $m$.", "outputFormat": "Output one integer, the smallest $N$ that satisfies the condition.", "hint": "For $30\\%$ of the testdata, $m \\leq 10^6$.\n\nFor $60\\%$ of the testdata, $m \\leq 5 \\times 10^7$.\n\nFor $100\\%$ of the testdata, $6 \\leq m \\leq 10^{11}$, $0 < K < m$, and $m$ is guaranteed to be prime.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "多少个 1？", "background": "", "description": "给定整数 $K$ 和质数 $m$，求最小的正整数 $N$，使得 $ 11\\cdots1$（$N$ 个 $1$）$\\equiv K \\pmod m$。\n\n说人话：就是 $111\\cdots 1111 \\bmod m = K$。", "inputFormat": "第一行两个整数，分别表示 $K$ 和 $m$。", "outputFormat": "一个整数，表示符合条件最小的 $N$。", "hint": "$30\\%$ 的数据保证 $m\\leq 10^6$。\n\n$60\\%$ 的数据保证 $m\\leq 5\\times 10^7$。\n\n$100\\%$ 的数据保证 $6\\leq m\\leq 10^{11}$，$0< K< m$，保证 $m$ 是质数。", "locale": "zh-CN"}}}
{"pid": "P4885", "type": "P", "difficulty": 5, "samples": [["3 4 2 2\n8 9\n2 4\n9\n3", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数论", "洛谷月赛"], "title": "灭顶之灾", "background": "请将题目名称拼音首字母连起来读", "description": "Scarlet 有一张 $n\\times m$ 的神秘表格。现在 Scarlet 向表格中填数字，她会从 **第一行** 中的某个格子起，按照 **从左往右，从上往下** 的顺序依次填写 **从 $1$ 开始的正整数**，直至 **填满最后一行**。\n\n为了让你确定这个表格，Scarlet 会告诉你表格中的 $s$ 组 **同行连续数字。** 之后，Scarlet 会对你发起 $q$ 次询问，你需要依次回答每个数字被填在第几行第几列中。", "inputFormat": "第一行 $4$ 个正整数分别代表 $n,m,s,q$\n\n接下来 $s$ 行，每行两个正整数 $a_i,b_i$，代表整数 $a_i$ 到 $b_i$ 在表格中处于同一行且连续\n\n接下来 $q$ 行，每行一个正整数 $A_i$，表示每个询问的数字", "outputFormat": "如果符合数据的表格不存在，输出一行 `Impossible!`\n\n再如果符合数据的表格不唯一，输出一行 `Uncertain!`\n\n~~ 否则输出 $q$ 行，每行两个正整数，代表每个被询问的数字被填在第几行第几列，如果该数字不在表格内，输出 `0 0`~~\n\nScarlet 为了减小输出文件，以轻易地上传测试数据至服务器，她现在只需要你输出所有行列数据的异或和（包括前文的 `0 0`）。", "hint": "表格：\n\n```plain\n0001\n2345\n6789\n```\n\n$9$ 在第 $3$ 行第 $4$ 列\n\n$3$ 在第 $2$ 行第 $2$ 列\n\n$3 \\oplus 4 \\oplus 2 \\oplus 2=7$（$\\oplus$ 表示 xor 运算）\n## 数据规模\n\n对于 $30\\%$ 的数据，$1\\leq n,m,s,q\\leq50$\n\n对于 $60\\%$ 的数据，$1\\leq m,s\\leq 2000$\n\n对于 $100\\%$ 的数据，$1\\leq n,m,A_i,a_i,b_i\\leq 10^{18}$，$1\\leq s,q\\leq 5*10^5$，$0\\leq b_i-a_i\\leq m-1$", "locale": "zh-CN", "translations": {"en": {"title": "Catastrophic Disaster.", "background": "Please read the initials of the pinyin of the problem name together.", "description": "Scarlet has a mysterious $n \\times m$ table. Now Scarlet fills numbers into the table. She will start from some cell in the **first row**, and then, in the order of **left to right, top to bottom**, she fills **positive integers starting from $1$**, until she **fills the last row completely**.\n\nTo let you determine this table, Scarlet will tell you $s$ groups of **consecutive numbers in the same row**. After that, Scarlet will ask you $q$ queries. You need to answer, for each queried number, which row and which column it is filled in.", "inputFormat": "The first line contains $4$ positive integers $n, m, s, q$.\n\nThe next $s$ lines each contain two positive integers $a_i, b_i$, meaning that the integers from $a_i$ to $b_i$ are in the same row of the table and are consecutive.\n\nThe next $q$ lines each contain one positive integer $A_i$, representing the number in each query.", "outputFormat": "If no table satisfying the constraints exists, output one line `Impossible!`.\n\nOtherwise, if the table satisfying the constraints is not unique, output one line `Uncertain!`.\n\nOtherwise, output the xor sum of all row and column results (including the earlier `0 0` cases), in order to reduce the output file size so that Scarlet can easily upload the testdata to the server.", "hint": "Table:\n\n```plain\n0001\n2345\n6789\n```\n\n$9$ is in row $3$, column $4$.\n\n$3$ is in row $2$, column $2$.\n\n$3 \\oplus 4 \\oplus 2 \\oplus 2 = 7$ ($\\oplus$ means the xor operation).\n\n# Constraints\n\nFor $30\\%$ of the data, $1 \\leq n, m, s, q \\leq 50$.\n\nFor $60\\%$ of the data, $1 \\leq m, s \\leq 2000$.\n\nFor $100\\%$ of the data, $1 \\leq n, m, A_i, a_i, b_i \\leq 10^{18}$, $1 \\leq s, q \\leq 5 * 10^5$, and $0 \\leq b_i - a_i \\leq m - 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "灭顶之灾", "background": "请将题目名称拼音首字母连起来读", "description": "Scarlet 有一张 $n\\times m$ 的神秘表格。现在 Scarlet 向表格中填数字，她会从 **第一行** 中的某个格子起，按照 **从左往右，从上往下** 的顺序依次填写 **从 $1$ 开始的正整数**，直至 **填满最后一行**。\n\n为了让你确定这个表格，Scarlet 会告诉你表格中的 $s$ 组 **同行连续数字。** 之后，Scarlet 会对你发起 $q$ 次询问，你需要依次回答每个数字被填在第几行第几列中。", "inputFormat": "第一行 $4$ 个正整数分别代表 $n,m,s,q$\n\n接下来 $s$ 行，每行两个正整数 $a_i,b_i$，代表整数 $a_i$ 到 $b_i$ 在表格中处于同一行且连续\n\n接下来 $q$ 行，每行一个正整数 $A_i$，表示每个询问的数字", "outputFormat": "如果符合数据的表格不存在，输出一行 `Impossible!`\n\n再如果符合数据的表格不唯一，输出一行 `Uncertain!`\n\n~~ 否则输出 $q$ 行，每行两个正整数，代表每个被询问的数字被填在第几行第几列，如果该数字不在表格内，输出 `0 0`~~\n\nScarlet 为了减小输出文件，以轻易地上传测试数据至服务器，她现在只需要你输出所有行列数据的异或和（包括前文的 `0 0`）。", "hint": "表格：\n\n```plain\n0001\n2345\n6789\n```\n\n$9$ 在第 $3$ 行第 $4$ 列\n\n$3$ 在第 $2$ 行第 $2$ 列\n\n$3 \\oplus 4 \\oplus 2 \\oplus 2=7$（$\\oplus$ 表示 xor 运算）\n## 数据规模\n\n对于 $30\\%$ 的数据，$1\\leq n,m,s,q\\leq50$\n\n对于 $60\\%$ 的数据，$1\\leq m,s\\leq 2000$\n\n对于 $100\\%$ 的数据，$1\\leq n,m,A_i,a_i,b_i\\leq 10^{18}$，$1\\leq s,q\\leq 5*10^5$，$0\\leq b_i-a_i\\leq m-1$", "locale": "zh-CN"}}}
{"pid": "P4886", "type": "P", "difficulty": 6, "samples": [["3 1\n1 2 1\n2 3 1\n1 3\n", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["点分治", "递归", "O2优化", "树链剖分", "洛谷月赛"], "title": "快递员", "background": "", "description": "Bob 的城市里有 $n$ 个邮递站，由于经济考虑，这些邮递站被 $n - 1$ 条带权无向边相连。即：这 $n$ 个邮递站构成了一棵树。\n\nBob 正在应聘一个快递员的工作，他需要送 $m$ 个商品，第 $i$ 个商品需要从 $u$ 送到 $v$。由于 Bob 不能带着商品走太长的路，所以对于一次送货，他需要先从快递中心到 $u$，再从 $u$ 回到快递中心，再从快递中心到 $v$，最后从 $v$ 返回快递中心。换句话说，如果设快递中心是 $c$ 号点，那么他的路径是 $c \\rightarrow u \\rightarrow c \\rightarrow v \\rightarrow c$。\n\n现在 Bob 希望确定一个点作为快递中心，使得他送货所需的最长距离最小。显然，这个最长距离是个偶数，你只需要输出最长距离除以 $2$ 的结果即可。", "inputFormat": "第一行输入两个数 $n, m$，意义如上。\n\n接下来 $n-1$ 行，每行三个数 $u_i, v_i, w_i$，表示一条连接 $u_i, v_i$，长度为 $w_i$ 的边。\n\n接下来 $m$ 行，每行两个整数 $u_i, v_i$，表示商品的起止位置。", "outputFormat": "一行一个整数，表示答案。", "hint": "对于 $25\\%$ 的数据，满足 $1 \\leq n, m \\leq 1000$。\n\n对于 $100\\%$ 的数据，满足 $1 \\leq n, m \\leq 10^5, 1 \\leq w_i \\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "Courier", "background": "", "description": "In Bob’s city, there are $n$ post stations. For economic reasons, these stations are connected by $n - 1$ weighted undirected edges. That is, the $n$ post stations form a tree.\n\nBob is applying for a courier job. He needs to deliver $m$ packages. For the $i$-th package, it needs to be delivered from $u$ to $v$. Since Bob cannot carry a package for too long, for one delivery, he must first go from the courier center to $u$, then return from $u$ to the courier center, then go from the courier center to $v$, and finally return from $v$ to the courier center. In other words, if the courier center is node $c$, then his route is $c \\rightarrow u \\rightarrow c \\rightarrow v \\rightarrow c$.\n\nNow Bob wants to choose a node as the courier center so that the maximum distance he needs for any delivery is minimized. Clearly, this maximum distance is an even number. You only need to output the result of dividing the maximum distance by $2$.", "inputFormat": "The first line contains two integers $n, m$, with the meanings as described above.\n\nThe next $n - 1$ lines each contain three integers $u_i, v_i, w_i$, representing an edge connecting $u_i$ and $v_i$ with length $w_i$.\n\nThe next $m$ lines each contain two integers $u_i, v_i$, representing the start and end locations of a package.", "outputFormat": "Output one integer on a single line, representing the answer.", "hint": "For $25\\%$ of the testdata, $1 \\leq n, m \\leq 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leq n, m \\leq 10^5$, $1 \\leq w_i \\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "快递员", "background": "", "description": "Bob 的城市里有 $n$ 个邮递站，由于经济考虑，这些邮递站被 $n - 1$ 条带权无向边相连。即：这 $n$ 个邮递站构成了一棵树。\n\nBob 正在应聘一个快递员的工作，他需要送 $m$ 个商品，第 $i$ 个商品需要从 $u$ 送到 $v$。由于 Bob 不能带着商品走太长的路，所以对于一次送货，他需要先从快递中心到 $u$，再从 $u$ 回到快递中心，再从快递中心到 $v$，最后从 $v$ 返回快递中心。换句话说，如果设快递中心是 $c$ 号点，那么他的路径是 $c \\rightarrow u \\rightarrow c \\rightarrow v \\rightarrow c$。\n\n现在 Bob 希望确定一个点作为快递中心，使得他送货所需的最长距离最小。显然，这个最长距离是个偶数，你只需要输出最长距离除以 $2$ 的结果即可。", "inputFormat": "第一行输入两个数 $n, m$，意义如上。\n\n接下来 $n-1$ 行，每行三个数 $u_i, v_i, w_i$，表示一条连接 $u_i, v_i$，长度为 $w_i$ 的边。\n\n接下来 $m$ 行，每行两个整数 $u_i, v_i$，表示商品的起止位置。", "outputFormat": "一行一个整数，表示答案。", "hint": "对于 $25\\%$ 的数据，满足 $1 \\leq n, m \\leq 1000$。\n\n对于 $100\\%$ 的数据，满足 $1 \\leq n, m \\leq 10^5, 1 \\leq w_i \\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P4887", "type": "P", "difficulty": 6, "samples": [["5 5 2\n3 4 8 0 2\n4 5\n3 5\n1 4\n2 5\n1 5", "0\n1\n2\n3\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960, 40960]}, "tags": ["递推", "莫队", "O2优化", "前缀和", "洛谷月赛", "模板题"], "title": "【模板】莫队二次离线 / 第十四分块(前体)", "background": null, "description": "珂朵莉给了你一个序列 $a$，每次查询给一个区间 $[l,r]$，查询 $l \\leq i< j \\leq r$，且 $a_i \\oplus a_j$ 的二进制表示下有 $k$ 个 $1$ 的二元组 $(i,j)$ 的个数。$\\oplus$ 是指按位异或。", "inputFormat": "第一行三个数表示 $n,m,k$。\n\n第二行 $n$ 个数表示序列 $a$。\n\n之后 $m$ 行，每行两个数 $l,r$ 表示一次查询。", "outputFormat": "输出 $m$ 行，每行一个数表示查询的结果。", "hint": "对于 $5\\%$ 的数据，为样例。\n\n对于 $30\\%$ 的数据，$1 \\leq n , m \\leq 5000$。\n\n对于 $50\\%$ 的数据，空间限制为 `512 MiB`。\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n, m \\leq 10^5$，$0 \\leq a_i, k < 2^{14}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Mo's Algorithm Second-Order Offline / The 14th Block Decomposition (Prototype).", "background": "", "description": "Ctholly gives you a sequence $a$. In each query, you are given an interval $[l, r]$. You need to count the number of pairs $(i, j)$ such that $l \\le i < j \\le r$, and the binary representation of $a_i \\oplus a_j$ contains exactly $k$ ones. Here, $\\oplus$ means bitwise XOR.", "inputFormat": "The first line contains three integers $n$, $m$, and $k$.\n\nThe second line contains $n$ integers representing the sequence $a$.\n\nThen follow $m$ lines. Each line contains two integers $l$ and $r$, representing one query.", "outputFormat": "Output $m$ lines, each containing one integer, which is the answer to the corresponding query.", "hint": "For $5\\%$ of the testdata, it is the sample.\n\nFor $30\\%$ of the testdata, $1 \\le n, m \\le 5000$.\n\nFor $50\\%$ of the testdata, the memory limit is `512 MiB`.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le n, m \\le 10^5$, and $0 \\le a_i, k < 2^{14}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】莫队二次离线 / 第十四分块(前体)", "background": null, "description": "珂朵莉给了你一个序列 $a$，每次查询给一个区间 $[l,r]$，查询 $l \\leq i< j \\leq r$，且 $a_i \\oplus a_j$ 的二进制表示下有 $k$ 个 $1$ 的二元组 $(i,j)$ 的个数。$\\oplus$ 是指按位异或。", "inputFormat": "第一行三个数表示 $n,m,k$。\n\n第二行 $n$ 个数表示序列 $a$。\n\n之后 $m$ 行，每行两个数 $l,r$ 表示一次查询。", "outputFormat": "输出 $m$ 行，每行一个数表示查询的结果。", "hint": "对于 $5\\%$ 的数据，为样例。\n\n对于 $30\\%$ 的数据，$1 \\leq n , m \\leq 5000$。\n\n对于 $50\\%$ 的数据，空间限制为 `512 MiB`。\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n, m \\leq 10^5$，$0 \\leq a_i, k < 2^{14}$。", "locale": "zh-CN"}}}
{"pid": "P4888", "type": "P", "difficulty": 3, "samples": [["5 5\nabcba\nbcdcb\ncdedc\nbcdcb\nabcba\n1 1\n1 2\n1 3\n2 3\n3 3", "1\n1\n5\n5\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "搜索", "枚举", "洛谷月赛"], "title": "三去矩阵", "background": "无", "description": "现在小Y有个 $l \\times l$ 的正方形字母矩阵，现在他想进行 $q$ 次询问，每次询问最长的以 $(x_i,y_i)$ 为中心的在一条水平或竖直的直线上的回文串的长度。", "inputFormat": "第一行输入两个整数 $l,q$，分别表示矩阵的边长和询问的个数。\n\n接下来的 $l$ 行，每行 $l$ 个字母，表示这个矩阵上的字母。\n\n接下来的 $q$ 行，每行两个整数 $x_i,y_i$，表示第 $i$ 个询问为在询问矩阵中最长的以 $(x_i,y_i)$ 为中心的在一条直线上的回文串的长度。", "outputFormat": "输出 $q$ 行，第 $i$ 行为对于第 $i$ 个询问的回答。", "hint": "对于 $20\\%$ 的数据，$1 \\le l \\le 2$。\n\n另有 $20\\%$ 的数据，$q = 1$。\n\n另有 $20\\%$ 的数据，字母矩阵中心对称，上下对称，左右对称且对角线对称。\n\n对于 $100\\%$ 的数据，$1 \\le l,q \\le 2000$，字母只有小写字母。", "locale": "zh-CN", "translations": {"en": {"title": "Triple-Removal Matrix", "background": "", "description": "Now Little Y has an $l \\times l$ square letter matrix. He wants to make $q$ queries. For each query, find the maximum length of a palindrome string centered at $(x_i, y_i)$ that lies on a single horizontal or vertical line.", "inputFormat": "The first line contains two integers $l, q$, representing the side length of the matrix and the number of queries.\n\nThe next $l$ lines each contain $l$ letters, representing the letters in the matrix.\n\nThe next $q$ lines each contain two integers $x_i, y_i$, representing the $i$-th query: ask for the maximum length of a palindrome centered at $(x_i, y_i)$ that lies on a single straight line in the matrix.", "outputFormat": "Output $q$ lines. The $i$-th line should be the answer to the $i$-th query.", "hint": "For $20\\%$ of the testdata, $1 \\le l \\le 2$.\n\nAnother $20\\%$ of the testdata has $q = 1$.\n\nAnother $20\\%$ of the testdata has a letter matrix that is centrally symmetric, vertically symmetric, horizontally symmetric, and diagonally symmetric.\n\nFor $100\\%$ of the testdata, $1 \\le l, q \\le 2000$, and the letters are lowercase only.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "三去矩阵", "background": "无", "description": "现在小Y有个 $l \\times l$ 的正方形字母矩阵，现在他想进行 $q$ 次询问，每次询问最长的以 $(x_i,y_i)$ 为中心的在一条水平或竖直的直线上的回文串的长度。", "inputFormat": "第一行输入两个整数 $l,q$，分别表示矩阵的边长和询问的个数。\n\n接下来的 $l$ 行，每行 $l$ 个字母，表示这个矩阵上的字母。\n\n接下来的 $q$ 行，每行两个整数 $x_i,y_i$，表示第 $i$ 个询问为在询问矩阵中最长的以 $(x_i,y_i)$ 为中心的在一条直线上的回文串的长度。", "outputFormat": "输出 $q$ 行，第 $i$ 行为对于第 $i$ 个询问的回答。", "hint": "对于 $20\\%$ 的数据，$1 \\le l \\le 2$。\n\n另有 $20\\%$ 的数据，$q = 1$。\n\n另有 $20\\%$ 的数据，字母矩阵中心对称，上下对称，左右对称且对角线对称。\n\n对于 $100\\%$ 的数据，$1 \\le l,q \\le 2000$，字母只有小写字母。", "locale": "zh-CN"}}}
{"pid": "P4889", "type": "P", "difficulty": 3, "samples": [["5 5\n2 3 3 3 2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["枚举", "排序", "洛谷月赛"], "title": "kls与flag", "background": "kls毒奶非常厉害。", "description": "有$n$个OI选手，每个人插了一个flag。有一天因为某种原因，flag都被触发了，所以地上有一排$n$根竹竿，竹竿的间距均为一个单位长度，高度在$1\\sim m$之间。\n\nkls看到这些竹竿，感觉不好看，于是准备把它们全部放倒。\n\n在这之前，kls想到了一个数学问题。每根竹竿可以往左倒或者往右倒。如果两根竹竿在选择方向放倒之后，它们的顶端可以重合，那么称它们是优秀的。现在kls想要知道，有多少对竹竿是优秀的。", "inputFormat": "第一行两个数$n,m$，表示竹竿的个数和最大高度。\n\n第二行$n$个正整数，表示每根竹竿的高度。", "outputFormat": "输出一行，只有一个数，表示有多少对竹竿是优秀的。", "hint": "### 样例解释\n\n![法法](https://cdn.luogu.com.cn/upload/pic/25795.png)\n\n- 1号和2号向左倒可以顶端重合\n- 4号和5号向右倒可以顶端重合\n- 1号向右，5号向左可以顶端重合\n\n### 数据范围\n\n对于30%的数据，满足$n\\le 2000$，$m\\le 5000$；\n\n对于60%的数据，满足$n\\le 200000$，$m\\le 500000$；\n\n对于100%的数据，满足$n \\le 200000$，$m \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "kls and flag", "background": "kls is very good at “poisoning milk” (du nai).", "description": "There are $n$ OI contestants, and each of them set up a flag. One day, for some reason, all the flags were triggered, so there is a row of $n$ bamboo poles on the ground. The distance between adjacent poles is $1$ unit, and their heights are in $1 \\sim m$.\n\nWhen kls saw these bamboo poles, he felt they did not look nice, so he plans to knock all of them down.\n\nBefore doing that, kls thought of a math problem. Each bamboo pole can fall to the left or to the right. If, after choosing their falling directions, the top ends of two bamboo poles can coincide, then we call this pair excellent. Now kls wants to know how many pairs of bamboo poles are excellent.", "inputFormat": "The first line contains two integers $n, m$, representing the number of bamboo poles and the maximum height.\n\nThe second line contains $n$ positive integers, representing the height of each bamboo pole.", "outputFormat": "Output one line with a single integer, representing how many pairs of bamboo poles are excellent.", "hint": "### Sample Explanation\n\n![Fafa](https://cdn.luogu.com.cn/upload/pic/25795.png)\n\n- Poles $1$ and $2$ can have their top ends coincide if they both fall to the left.\n- Poles $4$ and $5$ can have their top ends coincide if they both fall to the right.\n- Pole $1$ falling to the right and pole $5$ falling to the left can have their top ends coincide.\n\n### Constraints\n\nFor $30\\%$ of the testdata, $n \\le 2000$, $m \\le 5000$.\n\nFor $60\\%$ of the testdata, $n \\le 200000$, $m \\le 500000$.\n\nFor $100\\%$ of the testdata, $n \\le 200000$, $m \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "kls与flag", "background": "kls毒奶非常厉害。", "description": "有$n$个OI选手，每个人插了一个flag。有一天因为某种原因，flag都被触发了，所以地上有一排$n$根竹竿，竹竿的间距均为一个单位长度，高度在$1\\sim m$之间。\n\nkls看到这些竹竿，感觉不好看，于是准备把它们全部放倒。\n\n在这之前，kls想到了一个数学问题。每根竹竿可以往左倒或者往右倒。如果两根竹竿在选择方向放倒之后，它们的顶端可以重合，那么称它们是优秀的。现在kls想要知道，有多少对竹竿是优秀的。", "inputFormat": "第一行两个数$n,m$，表示竹竿的个数和最大高度。\n\n第二行$n$个正整数，表示每根竹竿的高度。", "outputFormat": "输出一行，只有一个数，表示有多少对竹竿是优秀的。", "hint": "### 样例解释\n\n![法法](https://cdn.luogu.com.cn/upload/pic/25795.png)\n\n- 1号和2号向左倒可以顶端重合\n- 4号和5号向右倒可以顶端重合\n- 1号向右，5号向左可以顶端重合\n\n### 数据范围\n\n对于30%的数据，满足$n\\le 2000$，$m\\le 5000$；\n\n对于60%的数据，满足$n\\le 200000$，$m\\le 500000$；\n\n对于100%的数据，满足$n \\le 200000$，$m \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4890", "type": "P", "difficulty": 6, "samples": [["5 2\n1 9\n2 10\n3 5\n7 12\n15 17\n", "6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "洛谷月赛"], "title": "Never·island", "background": "您一觉醒来，发现已经到了20000年后的未来。", "description": "为了寻找传说中的Avalon，island派出了 $n$ 个考察队。为了保持island的稳定，island有一个通向外界的大门。\n\n这 $n$ 个考察队都需要出一次门进行考察，其中第 $i$ 支考察队会在 $l_i$ 时刻离开，并且在第 $r_i$ 时刻回来。我们保证这些值都是互不相等的。\n\n每当一支考察队离开时，island的大门会变成开的。但是如果这支考察队得到了钥匙，那么他就可以决定关门或者不关门。同时每一个考察队回来的时候要么门本来就是开的（由于island是已知唯一的生活区，因此island内部人员不会主动为任何人开门），要么他必须拥有一把钥匙把门打开。注意，回来的时候无论有没有钥匙，那么这支考察队都可以选择把门关上。\n\n由于一些奇怪的原因，island的设计者只设计了 $k$ 把钥匙，只能分给 $k$ 支考察队。得到钥匙证明了island上层对考察队的信任，因此考察队不会把钥匙交给任何人。\n\n为了防止island下层居民逃出island，上层希望门处于开的时间越短越好。希望您帮他算出最短门会开多久。", "inputFormat": "第一行是两个正整数 $n,k$\n\n第二行开始共 $n$ 行，每行两个数，描述 $l_i,r_i$\n\n", "outputFormat": "一个正整数，表示答案。", "hint": "【样例解释】\n``` \n④                     ================\n③/⑤       -------                              ------\n②      -------------------------\n①   ========================= \n    1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17\n状态 X  O  O  O  X  X  X  X  O  X  X  X  X  X  O  O \n```\n其中，1、4号考察队会带钥匙。\n\n【数据范围】\n\n对于 $30\\%$ 的测试数据，$n \\leq 20$\n\n对于 $60\\%$的测试数据，$n \\leq 200$\n\n对于全部的测试数据，$n \\leq 2000$\n\n$1 \\leq l_i < r_i\\leq 10^9, k \\le n$", "locale": "zh-CN", "translations": {"en": {"title": "Never·island", "background": "You wake up and find yourself in the future, 20,000 years later.", "description": "In order to find the legendary Avalon, island has sent out $n$ expedition teams. To keep island stable, island has a gate that leads to the outside world.\n\nEach of these $n$ expedition teams needs to go out once for an expedition. The $i$-th expedition team will leave at time $l_i$ and return at time $r_i$. We guarantee that all these values are pairwise distinct.\n\nWhenever an expedition team leaves, island’s gate becomes open. However, if this team has obtained a key, then it can decide to close the gate or keep it open. Also, when each expedition team returns, either the gate is already open (since island is known to be the only living area, people inside island will not主动 open the gate for anyone), or the team must have a key to open the gate. Note that upon returning, regardless of whether it has a key, the team can choose to close the gate.\n\nFor some strange reason, island’s designer made only $k$ keys, which can only be given to $k$ expedition teams. Having a key shows the upper level’s trust in the team, so the team will not give the key to anyone else.\n\nTo prevent lower-level residents from escaping island, the upper level wants the gate to stay open for as short a time as possible. Please help compute the minimum total time the gate will be open.", "inputFormat": "The first line contains two positive integers $n, k$.\n\nStarting from the second line, there are $n$ lines. Each line contains two numbers describing $l_i, r_i$.", "outputFormat": "One positive integer, representing the answer.", "hint": "【Sample Explanation】\n``` \n④                     ================\n③/⑤       -------                              ------\n②      -------------------------\n①   ========================= \n    1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17\nState X  O  O  O  X  X  X  X  O  X  X  X  X  X  O  O \n```\nAmong them, expedition teams No. 1 and No. 4 will carry keys.\n\n【Constraints】\n\nFor $30\\%$ of the testdata, $n \\leq 20$.\n\nFor $60\\%$ of the testdata, $n \\leq 200$.\n\nFor all testdata, $n \\leq 2000$.\n\n$1 \\leq l_i < r_i \\leq 10^9, k \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Never·island", "background": "您一觉醒来，发现已经到了20000年后的未来。", "description": "为了寻找传说中的Avalon，island派出了 $n$ 个考察队。为了保持island的稳定，island有一个通向外界的大门。\n\n这 $n$ 个考察队都需要出一次门进行考察，其中第 $i$ 支考察队会在 $l_i$ 时刻离开，并且在第 $r_i$ 时刻回来。我们保证这些值都是互不相等的。\n\n每当一支考察队离开时，island的大门会变成开的。但是如果这支考察队得到了钥匙，那么他就可以决定关门或者不关门。同时每一个考察队回来的时候要么门本来就是开的（由于island是已知唯一的生活区，因此island内部人员不会主动为任何人开门），要么他必须拥有一把钥匙把门打开。注意，回来的时候无论有没有钥匙，那么这支考察队都可以选择把门关上。\n\n由于一些奇怪的原因，island的设计者只设计了 $k$ 把钥匙，只能分给 $k$ 支考察队。得到钥匙证明了island上层对考察队的信任，因此考察队不会把钥匙交给任何人。\n\n为了防止island下层居民逃出island，上层希望门处于开的时间越短越好。希望您帮他算出最短门会开多久。", "inputFormat": "第一行是两个正整数 $n,k$\n\n第二行开始共 $n$ 行，每行两个数，描述 $l_i,r_i$\n\n", "outputFormat": "一个正整数，表示答案。", "hint": "【样例解释】\n``` \n④                     ================\n③/⑤       -------                              ------\n②      -------------------------\n①   ========================= \n    1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17\n状态 X  O  O  O  X  X  X  X  O  X  X  X  X  X  O  O \n```\n其中，1、4号考察队会带钥匙。\n\n【数据范围】\n\n对于 $30\\%$ 的测试数据，$n \\leq 20$\n\n对于 $60\\%$的测试数据，$n \\leq 200$\n\n对于全部的测试数据，$n \\leq 2000$\n\n$1 \\leq l_i < r_i\\leq 10^9, k \\le n$", "locale": "zh-CN"}}}
{"pid": "P4891", "type": "P", "difficulty": 6, "samples": [["3 1\n2 1 3\n1 2 3\n1 3 5\n", "6"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "枚举", "分块", "洛谷月赛"], "title": "序列", "background": "# 本题数据已更新", "description": "给定两个长度为 $n$ 的序列 $A$ 和 $B$，定义序列 $C_i=\\max\\limits_{j=1}^i A_j$。\n\n定义当前的价值是 $\\prod\\limits_{i=1}^n \\min(B_i,C_i)$。\n\n现在有 $q$ 次操作，每次操作将会修改序列 $A$ 或者 $B$ 中的一个位置，将会把数字变大。现在请求出每次修改之后的价值。", "inputFormat": "第一行两个整数 $n,q$。\n\n第二行 $n$ 个整数表示 $A_i$。\n\n第三行 $n$ 个整数表示 $B_i$。\n\n接下来 $q$ 行，每行三个整数 $opt,x,y$，如果 $opt=0$ 表示对序列 A 操作，如果 $opt=1$ 则是对序列 $B$ 操作，把序列中第 $x$ 个元素变成 $y$，保证 $y$ 不小于原来的元素。", "outputFormat": "输出 $q$ 行，表示每次修改之后的价值。\n\n由于答案很大，请对 $10^9+7$ 取模后输出。", "hint": "对于所有数据，满足 $1 \\le n,q\\le 10^5,0\\le A_i,B_i,y \\le 10^9$。\n\n对于 20% 的数据范围，满足 $1\\le n,q\\le 1000$\n\n对于另外 10% 的数据范围，满足 $opt=1$\n\n对于另外 20% 的数据范围，满足 $opt=0$\n\n对于 80% 的数据范围，满足 $n,q\\le 50000$\n", "locale": "zh-CN", "translations": {"en": {"title": "Sequence", "background": "# The testdata for this problem has been updated.", "description": "Given two sequences $A$ and $B$ of length $n$, define the sequence $C_i=\\max\\limits_{j=1}^i A_j$.\n\nDefine the current value as $\\prod\\limits_{i=1}^n \\min(B_i,C_i)$.\n\nNow there are $q$ operations. Each operation modifies one position in sequence $A$ or $B$, and the number will increase. You need to output the value after each modification.", "inputFormat": "The first line contains two integers $n,q$.\n\nThe second line contains $n$ integers representing $A_i$.\n\nThe third line contains $n$ integers representing $B_i$.\n\nThe next $q$ lines each contain three integers $opt,x,y$. If $opt=0$, it means an operation on sequence $A$; if $opt=1$, it means an operation on sequence $B$. Set the $x$-th element of the corresponding sequence to $y$. It is guaranteed that $y$ is not smaller than the original element.", "outputFormat": "Output $q$ lines, each being the value after the corresponding modification.\n\nSince the answer can be very large, output it modulo $10^9+7$.", "hint": "For all testdata, $1 \\le n,q\\le 10^5,0\\le A_i,B_i,y \\le 10^9$.\n\nFor 20% of the Constraints, $1\\le n,q\\le 1000$.\n\nFor another 10% of the Constraints, $opt=1$.\n\nFor another 20% of the Constraints, $opt=0$.\n\nFor 80% of the Constraints, $n,q\\le 50000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "序列", "background": "# 本题数据已更新", "description": "给定两个长度为 $n$ 的序列 $A$ 和 $B$，定义序列 $C_i=\\max\\limits_{j=1}^i A_j$。\n\n定义当前的价值是 $\\prod\\limits_{i=1}^n \\min(B_i,C_i)$。\n\n现在有 $q$ 次操作，每次操作将会修改序列 $A$ 或者 $B$ 中的一个位置，将会把数字变大。现在请求出每次修改之后的价值。", "inputFormat": "第一行两个整数 $n,q$。\n\n第二行 $n$ 个整数表示 $A_i$。\n\n第三行 $n$ 个整数表示 $B_i$。\n\n接下来 $q$ 行，每行三个整数 $opt,x,y$，如果 $opt=0$ 表示对序列 A 操作，如果 $opt=1$ 则是对序列 $B$ 操作，把序列中第 $x$ 个元素变成 $y$，保证 $y$ 不小于原来的元素。", "outputFormat": "输出 $q$ 行，表示每次修改之后的价值。\n\n由于答案很大，请对 $10^9+7$ 取模后输出。", "hint": "对于所有数据，满足 $1 \\le n,q\\le 10^5,0\\le A_i,B_i,y \\le 10^9$。\n\n对于 20% 的数据范围，满足 $1\\le n,q\\le 1000$\n\n对于另外 10% 的数据范围，满足 $opt=1$\n\n对于另外 20% 的数据范围，满足 $opt=0$\n\n对于 80% 的数据范围，满足 $n,q\\le 50000$\n", "locale": "zh-CN"}}}
{"pid": "P4892", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2\n2 3\n1 3\n1\n", "2"], ["10 30\n6 3\n5 3\n6 7\n10 9\n2 8\n7 2\n10 6\n7 1\n9 4\n3 9\n7 1\n2 2\n10 6\n7 7\n2 4\n6 8\n1 1\n6 4\n3 9\n8 7\n6 2\n7 2\n1 4\n5 4\n8 6\n2 4\n7 1\n4 2\n10 9\n1 6\n0\n", "1094"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["枚举", "位运算", "状压 DP"], "title": "GodFly的寻宝之旅", "background": "“蒹葭苍苍，白露为霜。所谓伊人，在水一方…”\n\n怀着 `a burning desire`，GodFly 开启了他追寻学妹之路。", "description": "我们把校园抽象成一个具有 $n$ 个点的无向连通图，其中的 $n$ 个结点分别编号为 $1,2,3,...,n$。把 GodFly 经过的结点表示为一个路径集合 $A=\\left\\{a_1,a_2,a_3,...,a_m\\right\\}$，表示他依次经过了编号为 $a_1, a_2,\\cdots,a_m$ 的结点，由于集合的元素具有互异性，这意味着 GodFly 无法重复经过同一个结点。\n\nGodFly 现在要从第 $1$ 个结点走到第 $n$ 个结点，然而他的腿疾对他造成了许多不便。定义 GodFly 经过了 $m$ 个结点，当前在点 $a_m$，且路径集合 $A=\\left\\{a_1,a_2,a_3...,a_{m-1}\\right\\}$（加入新结点 $a_m$ 前）时，他的总体力耗费为$w_m=(w_{m-1}+a_m\\times \\mathrm{sum}(A))\\bmod 2$，其中 $w_{m-1}$ 表示上一个路径集合的体力耗费；且对于集合 $A$，$\\mathrm{sum}(A)=\\sum_{a\\in A} a=a_1+a_2+...+a_{m-1}$。\n\n对于 $w=0$ 的情况，我们称 GodFly 处于「滑基态」，否则对于 $w=1$ 的情况，我们称 GodFly 处于「对偶态」。现在 GodFly 想要知道，他走到 $n$ 结点后处于滑基态或对偶态的方案数，由于这个数可能很大，你只需要输出它对 $19260817$ 取膜（模）的结果；注意两个方案是不同的，当且仅当它们有至少一条经过的边不同，而非路径集合不同。", "inputFormat": "第一行，两个数 $n$，$k$，分别表示点数和边数；\n\n接下来 $k$ 行，每行两个数 $u$、$v$，表示结点$u$ 与结点 $v$ 之间有一条边。\n\n输入的最后一行为一个数 $c$，$c=0$ 表示求滑基态方案数，$c=1$ 表示求对偶态方案数。", "outputFormat": "一行，一个数表示方案数，详见题面。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，$n\\le 10$，$k\\le45$，无重边及自环；\n\n对于 $60\\%$ 的数据，$n\\le 15$，$k\\le 300$；\n\n对于 $80\\%$ 的数据，$n\\le 15$，$k\\le 10^5$；\n\n对于 $100\\%$ 的数据，$n\\le 18$，$k\\le 100000$；\n\n**【样例说明】**\n\n![](https://cdn.luogu.com.cn/upload/pic/30986.png)\n\n如图，初始时在 $1$ 结点，路径集合为 $\\left\\{1\\right\\}$，费用为 $0$；\n\n若从 $1$ 走到 $2$ 结点再走到 $3$ 结点，到 $2$ 结点时，费用为$(0+2\\times \\mathrm{sum}(\\left\\{1\\right\\}))\\bmod 2=0$，并把 $2$ 加入路径集合，则此时路径集合为 $\\left\\{1,2\\right\\}$；到 $3$ 结点时，因上一次费用为 $0$，费用为$(0+3\\times \\mathrm{sum}(\\left\\{1,2\\right\\}))\\bmod 2=1$；\n\n若从 $1$ 结点直接走到 $3$ 结点，则费用为$(0+3\\times \\mathrm{sum}(\\left\\{1\\right\\})\\bmod 2=1$。\n\n故最终走到 $3$ 结点时费用为 $1$ 的方案数为$2$。\n", "locale": "zh-CN", "translations": {"en": {"title": "GodFly’s Treasure Hunt Journey.", "background": "“Reeds and rushes grow so lush, the white dew turns to frost. The one I long for is on the other side of the water…”\n\nWith a $burning$ $desire$, $GodFly$ began his journey to chase after a junior girl.", "description": "We abstract the campus as an undirected connected graph with $n$ vertices, numbered $1,2,3,...,n$. Let the vertices that $GodFly$ passes through be represented as a path set $A=\\left\\{a_1,a_2,a_3,...,a_m\\right\\}$, meaning that he passes through vertices numbered $a_1$, $a_2$, …, $a_m$ in order. Since the elements of a set are distinct, this means that $GodFly$ cannot pass through the same vertex repeatedly.\n\nNow $GodFly$ wants to walk from vertex $1$ to vertex $n$, but his leg problem causes him a lot of trouble. Define that $GodFly$ has passed through $m$ vertices, is currently at vertex $a_m$, and the path set is $A=\\left\\{a_1,a_2,a_3...,a_{m-1}\\right\\}$ (before adding the new vertex $a_m$). Then his total stamina cost is $w_m=(w_{m-1}+a_m*sum(A))$%$2$, where $w_{m-1}$ is the stamina cost of the previous path set. For the set $A$, $sum(A)=a_1+a_2+...+a_{m-1}$.\n\nWhen $w=0$, we say $GodFly$ is in the “滑基态” (\"huaji state\"). Otherwise, when $w=1$, we say $GodFly$ is in the “对偶态” (\"dual state\"). Now $GodFly$ wants to know the number of ways such that after he reaches vertex $n$, he is in the huaji state or the dual state. Since this number may be very large, you only need to output the result modulo $19260817$. Note that two ways are considered different if and only if they have at least one edge traversed differently, rather than having different path sets.", "inputFormat": "The first line contains two integers $n$ and $k$, representing the number of vertices and the number of edges.\n\nThe next $k$ lines each contain two integers $u$ and $v$, indicating that there is an edge between vertex $u$ and vertex $v$.\n\nThe last line of the input contains an integer $c$. $c=0$ means you need the number of ways for the huaji state, and $c=1$ means you need the number of ways for the dual state.", "outputFormat": "One line containing one integer, the number of ways, as described in the statement.", "hint": "**Constraints**\n\nFor $30$% of the testdata, $n<=10$, $k<=45$, with no multiple edges or self-loops.\n\nFor $60$% of the testdata, $n<=15$, $k<=300$.\n\nFor $80$% of the testdata, $n<=15$, $k<=100000$.\n\nFor $100$% of the testdata, $n<=18$, $k<=100000$.\n\n**Sample Explanation**\n\n![](https://cdn.luogu.com.cn/upload/pic/30986.png)\n\nAs shown in the figure, initially at vertex $1$, the path set is $\\left\\{1\\right\\}$, and the cost is $0$.\n\nIf you go from vertex $1$ to vertex $2$ and then to vertex $3$: when arriving at vertex $2$, the cost is $(0+2*sum(\\left\\{1\\right\\}))$%$2=2*1$%$2=0$, and then add $2$ into the path set, so the path set becomes $\\left\\{1,2\\right\\}$. When arriving at vertex $3$, since the previous cost is $0$, the cost is $(0+3*sum(\\left\\{1,2\\right\\}))$%$2=3*(1+2)$%$2=1$.\n\nIf you go directly from vertex $1$ to vertex $3$, then the cost is $(0+3*sum(\\left\\{1\\right\\}))$%$2=3*1$%$2=1$.\n\nTherefore, the number of ways that end at vertex $3$ with cost $1$ is $2$.\n\n**Hint**\n\nThe time limit for this problem is $3s$, and you may enable $O_2$ optimization, so you do not need to worry too much about constant factors. However, please make sure your algorithm is efficient enough.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "GodFly的寻宝之旅", "background": "“蒹葭苍苍，白露为霜。所谓伊人，在水一方…”\n\n怀着 `a burning desire`，GodFly 开启了他追寻学妹之路。", "description": "我们把校园抽象成一个具有 $n$ 个点的无向连通图，其中的 $n$ 个结点分别编号为 $1,2,3,...,n$。把 GodFly 经过的结点表示为一个路径集合 $A=\\left\\{a_1,a_2,a_3,...,a_m\\right\\}$，表示他依次经过了编号为 $a_1, a_2,\\cdots,a_m$ 的结点，由于集合的元素具有互异性，这意味着 GodFly 无法重复经过同一个结点。\n\nGodFly 现在要从第 $1$ 个结点走到第 $n$ 个结点，然而他的腿疾对他造成了许多不便。定义 GodFly 经过了 $m$ 个结点，当前在点 $a_m$，且路径集合 $A=\\left\\{a_1,a_2,a_3...,a_{m-1}\\right\\}$（加入新结点 $a_m$ 前）时，他的总体力耗费为$w_m=(w_{m-1}+a_m\\times \\mathrm{sum}(A))\\bmod 2$，其中 $w_{m-1}$ 表示上一个路径集合的体力耗费；且对于集合 $A$，$\\mathrm{sum}(A)=\\sum_{a\\in A} a=a_1+a_2+...+a_{m-1}$。\n\n对于 $w=0$ 的情况，我们称 GodFly 处于「滑基态」，否则对于 $w=1$ 的情况，我们称 GodFly 处于「对偶态」。现在 GodFly 想要知道，他走到 $n$ 结点后处于滑基态或对偶态的方案数，由于这个数可能很大，你只需要输出它对 $19260817$ 取膜（模）的结果；注意两个方案是不同的，当且仅当它们有至少一条经过的边不同，而非路径集合不同。", "inputFormat": "第一行，两个数 $n$，$k$，分别表示点数和边数；\n\n接下来 $k$ 行，每行两个数 $u$、$v$，表示结点$u$ 与结点 $v$ 之间有一条边。\n\n输入的最后一行为一个数 $c$，$c=0$ 表示求滑基态方案数，$c=1$ 表示求对偶态方案数。", "outputFormat": "一行，一个数表示方案数，详见题面。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，$n\\le 10$，$k\\le45$，无重边及自环；\n\n对于 $60\\%$ 的数据，$n\\le 15$，$k\\le 300$；\n\n对于 $80\\%$ 的数据，$n\\le 15$，$k\\le 10^5$；\n\n对于 $100\\%$ 的数据，$n\\le 18$，$k\\le 100000$；\n\n**【样例说明】**\n\n![](https://cdn.luogu.com.cn/upload/pic/30986.png)\n\n如图，初始时在 $1$ 结点，路径集合为 $\\left\\{1\\right\\}$，费用为 $0$；\n\n若从 $1$ 走到 $2$ 结点再走到 $3$ 结点，到 $2$ 结点时，费用为$(0+2\\times \\mathrm{sum}(\\left\\{1\\right\\}))\\bmod 2=0$，并把 $2$ 加入路径集合，则此时路径集合为 $\\left\\{1,2\\right\\}$；到 $3$ 结点时，因上一次费用为 $0$，费用为$(0+3\\times \\mathrm{sum}(\\left\\{1,2\\right\\}))\\bmod 2=1$；\n\n若从 $1$ 结点直接走到 $3$ 结点，则费用为$(0+3\\times \\mathrm{sum}(\\left\\{1\\right\\})\\bmod 2=1$。\n\n故最终走到 $3$ 结点时费用为 $1$ 的方案数为$2$。\n", "locale": "zh-CN"}}}
{"pid": "P4893", "type": "P", "difficulty": 5, "samples": [["3 2\nf(x)=x^3+2x^2+x^1+x^0\n2\n0\n1\n", "4\n10"], ["100 80\nf(x)=70109x^84+31190x^15+45313x^77+52808x^10+40146x^89+41024x^14+89576x^33+96906x^24+5709x^55+92657x^6+60729x^97+87451x^57+88440x^85+25928x^66+48048x^71+92676x^7+15167x^18+63997x^66+58477x^36+34120x^65+27725x^29+31391x^23+30665x^50+84699x^16+64456x^6+26791x^68+66327x^26+36721x^96+72893x^100+22073x^24+38681x^64+9925x^63+92854x^22+27301x^23+39910x^79+24609x^81+47423x^93+6710x^90+96661x^70+22479x^72+17422x^57+78832x^3+1010x^72+7876x^40+3790x^70+84553x^69+60952x^52+58198x^81+48082x^39+45635x^23+71833x^54+11456x^14+31619x^18+94591x^53+32180x^14+61596x^96+11236x^62+39754x^45+789x^39+96093x^91+13491x^17+38611x^18+7604x^34+23457x^9+84129x^48+50188x^59+59588x^87+99259x^52+94768x^57+17553x^65+38948x^66+34133x^76+61695x^54+41424x^14+23408x^23+1575x^65+98294x^21+82817x^4+41010x^11+75176x^88+82645x^70+81244x^48+12859x^71+71380x^8+90927x^10+73190x^23+55452x^34+67654x^57+48173x^22+22848x^53+22784x^16+96989x^75+74537x^9+80471x^13+63024x^85+38481x^62+20400x^61+3207x^9+89666x^11+99966x^44+49383x^11+57688x^20+43007x^85+21701x^55+18068x^71+14981x^52+8041x^42+70259x^33+63961x^82+70824x^18+96439x^1+6041x^43+50481x^5+78427x^29+64408x^32+48512x^37+99528x^36+63451x^55+33530x^41+11368x^3+44932x^84+99688x^33+2055x^49+60575x^52+2193x^49+65449x^19+6642x^84+64745x^55+40036x^81+86351x^4+36277x^48+34019x^91+63859x^81+24462x^8+46233x^8+64099x^78+15057x^38+56049x^92+54612x^9+86998x^7+15958x^54+5173x^48+27728x^96+90161x^99+59838x^71+56099x^55+95160x^2+66444x^89+54566x^96+63691x^24+64234x^46+25147x^86+24456x^29+3514x^68+94213x^96+32045x^89+14389x^23+89551x^20+5364x^92+37504x^73+84939x^11+75135x^90+43003x^58+89139x^69+57492x^19+81034x^84+84477x^85+58295x^2+13732x^54+38998x^27+41044x^8+36315x^35+36717x^63+23252x^35+71286x^21+89111x^23+46468x^33+69056x^74+68451x^20+70403x^92+68230x^10+99686x^89+40862x^15+81643x^4+35732x^4+46296x^52+27400x^12+73264x^68+60140x^32+7691x^88+68718x^56+89783x^94+82820x^17+54487x^25+38403x^38+14902x^20+62503x^30+22691x^19+22765x^53+38058x^89+56132x^8\n10\n68881\n11082\n81085\n62791\n24348\n17842\n4169\n35352\n5970\n62884\n", "16164240066651387562233717301528224969937465373558098015262037027386569033764424458589576758191332209048578992964215681542368338708891051016993923981103415501578871678233991105755103051233486979089239855976079907362208481280000000000000000000\n2182415680199447981440641146519198659607077509954309166209248162324864452442827593289098825979096442606243478952222902205343921078278568113665227454286771491416704568924623072727112114731118574714432341934080000000000000000000\n422062345638238714739738519709990563603589380455050149059126176370564404652221274586130148555137105128697765829042063701137700058889602612021604742696342353192426896358610967606518173419498516745741373670540528424373033369600000000000000000000\n2538134110912799647825063614412363226524317612152769944265617771344449232998633322212149486534945299900387663134035580713149883409969837626763922106020781745065444506920047539106732462229963056457132916655382266009175982080000000000000000000\n14991156446236176472502265880432966422015445276733818020404968064741525302926159825161216310702190973624698482701628021749937122966049505110718061754978132745243635634094880836725969058654388943804568845440390266880000000000000000000\n29884196573248406556002162301876815395302859901002567421986254945117587639735221615275195608354283425713168881991894459281778355276041429272933416204370972475808889065607037634764929408175999307387754704567009280000000000000000000\n7034423875123551962182784353450104496557971298184125552888776318750413078332260250166314564290913379761359968021613709898383403786934866343717269767517868839058663822072847509897027068564795985756160000000000000000000\n25992477245017120878983780820866398302559273825548192272216377072453312969834218142751826473940478236447308492208306657193432677046691735517736829469276821419271533107875650191893196069260108040752114150874519416340480000000000000000000\n9248461232577723346174268301761164329173345863690159750635506426262976168364385773072687017079604052061927750150164792050863501012462262384745784394685777588084492205111843685947224930396082214744883200000000000000000000\n2614386253805989523417576022989825195115049811637606864181649322898595113377432131993964109861291017592215861090255200834838990231767641551915513875471667690003413999293225510105639008531615901769130992569786115253086453760000000000000000000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "GodFly的求导工具", "background": "“求得导中导，方为人上人。”作为一名铁头娃，GodFly 已不满足于简单的求导了。", "description": "GodFly 为了证明自己的头铁，决定挑战一项任务：求一个具有大整数系数的 $n$ 次多项式函数的 $k$ 阶导。现在他希望聪明的你能够…静静地坐在那里看他求导。要知道，他可是能与神威-太湖之光匹敌的男人。\n\n作为 GodFly 的朋友，xhx 希望你能帮他写一个程序，与 GodFly 一同计算导函数及导数。如果你的程序能跑过他的手算，xhx 会敲一下 GodFly 的铁头。\n\n*关于导数的几个运算法则：\n\n若 $f(x)=ax^n$，则 $f'(x)=anx^{n-1}$；\n\n若 $F(x)=f(x)+g(x)$，则 $F'(x)=f'(x)+g'(x)$；\n\n其中 $f'(x),g'(x),F'(x)$ 分别表示 $f(x),g(x),F(x)$ 的导函数。\n\n**不要被导数吓到，本题考点不在此。**\n\n**设 $g(x)=ax^3+bx^2+c$，则 $g(x_0)=ax_0^3+bx_0^2+c$。**\n\n**$k$ 阶导即求 $k$ 次导数。**\n\n**新样例：https://pan.baidu.com/s/1w64WmnnGtKyAluxrX3PkNg； 数据已更新。**", "inputFormat": "第一行，两个整数 $n,k$，含义见题面；\n\n接下来一行，一个字符串表示函数，为“$f(x)=a_{n}x^n+a_{n-1}x^{n-1}+....+a_0x^0$”，其中对于任意 $i$，$a_ix^i$ 的项可能不出现，也可能出现多次，且 $a_i$ 均为正整数，但系数为 $1$ 的项不输入 $a_i$，只输入 $x^i$；\n\n接下来一行一个数 $m$，表示询问个数；\n\n接下来 $m$ 行，每行一个数 **$x_0$**，表示求 $f(x)$ 的 $k$ 阶导在 $x_0$ 处的导数，**换句话说，假设 $g(x)$ 为 $f(x)$ 的 $k$ 阶导函数，求 $g(x_0)$**。\n\n不存在多余空格及空行。", "outputFormat": "$m$ 行，每行一个数表示所求的导数值。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，$n\\le5$，$a_i\\le100,x_0\\le100$，且对于任意 $0\\le i\\le n$，$a_ix^i$ 出现有且仅有一次，且保证数据以 $i$ 为关键字降序排列；\n\n另有 $10\\%$ 的数据，$k=0$；\n\n另有 $10\\%$ 的数据，$k=1$；\n\n另有 $10\\%$ 的数据，$n=k$；\n\n对于 $100\\%$ 的数据，$n\\le100$，$k\\le n$，$m\\le10$，$a_i\\le10^5$，$x_0\\le10^5$；\n\n**【样例说明】**\n\n对 $f(x)$ 求导，则一阶导 $f'(x)=3x^2+4x+1$；求二阶导，即对 $f'(x)$ 再求导，得 $f''(x)=6x+4$；故所求 $f(0)=6*0+4=4,f(1)=6*1+4=10$。\n\n**【提示】**\n\nPS：担心大家抱怨代码量大（出题人懒），较原题简化了许多。\n\n如果你提前 AK 了，不妨看看一段铁头娃之间的对决：\n\n《冯所长三导导死郑拔蚌》\n\n冯所长······扑的只一导，正导在分式上，导得郑蚌头晕眼花，参数歪在半边，却便似开了个初等函数表，平方，根号，对勾一发都导出来。郑铁头算不过来，那把答案也丢在一边，口里只叫：“导得好！”冯所长骂道：“铁头娃！还敢应口！”提起笔来就分子只一导，导得火星四溅，头破血流，也似开了个二项式定理，三次、四次、五次都绽将出来。\n两边看的人惧怕冯所长，谁敢向前来劝。\n\n郑蚌导不出，讨饶。冯所长喝道：“咄！你是个铁头娃！若只和俺分类讨论到底，洒家倒饶了你！你如今对俺讨饶，洒家偏要分离参数！”又只一导，新函数上正着，却似做了一个常用导数表，指数，对数，分子分母一齐响。所长看时，只见郑蚌倒在地上，口里只有出的气，没了入的气，动弹不得。\n\n冯所长假意道：“你这厮诈死，洒家再导！”只见头渐渐的没了。所长寻思道：“俺只指望消费这厮一顿，不想三导真个导死了他。洒家须扣分，又没题做，不如及早撒开。”拔步便走，回头指着试卷道：“这废题，洒家跳过！”一头算，一头大踏步去了。", "locale": "zh-CN", "translations": {"en": {"title": "GodFly’s Differentiation Tool.", "background": "“Only by finding derivatives of derivatives can you become the best.” As a stubborn tough guy, GodFly is no longer satisfied with simple differentiation.", "description": "To prove how stubborn he is, GodFly decided to take on a challenge: compute the $k$-th derivative of an $n$-th degree polynomial function with big integer coefficients. Now he hopes that smart you can… sit there quietly and watch him differentiate. After all, he is a man who can rival Shenwei - TaihuLight.\n\nAs GodFly’s friend, xhx hopes you can help him write a program to compute the derivative function and derivative values together with GodFly. If your program can beat his manual calculation, xhx will knock on GodFly’s iron head.\n\n*Some rules for derivatives:\n\nIf $f(x)=ax^n$, then $f'(x)=anx^{n-1}$.\n\nIf $F(x)=f(x)+g(x)$, then $F'(x)=f'(x)+g'(x)$.\n\nHere, $f'(x)$, $g'(x)$, and $F'(x)$ denote the derivative functions of $f(x)$, $g(x)$, and $F(x)$, respectively.\n\n**Do not be scared by derivatives. This problem is not testing that.**\n\n**Let $g(x)=ax^3+bx^2+c$, then $g(x_0)=ax_0^3+bx_0^2+c$.**\n\n**The $k$-th derivative means differentiating $k$ times.**\n\n**New samples: https://pan.baidu.com/s/1w64WmnnGtKyAluxrX3PkNg; testdata has been updated.**", "inputFormat": "The first line contains two integers $n,k$, with meanings as described in the statement.\n\nThe next line contains a string representing the function, in the form $f(x)=a_{n}x^n+a_{n-1}x^{n-1}+....+a_0x^0$. For any $i$, the term $a_ix^i$ may be absent, or may appear multiple times. All $a_i$ are positive integers, but if a term has coefficient $1$, then $a_i$ is not given; only $x^i$ is written.\n\nThe next line contains a number $m$, the number of queries.\n\nThe next $m$ lines each contain a number **$x_0$**, meaning: compute the value of the $k$-th derivative of $f(x)$ at $x_0$. In other words, suppose $g(x)$ is the $k$-th derivative function of $f(x)$, find $g(x_0)$.\n\nThere are no extra spaces or blank lines.", "outputFormat": "Output $m$ lines, each containing one number, the required derivative value.", "hint": "**Constraints**\n\nFor $30\\%$ of the data: $n\\le5$, $a_i\\le100$, $x_0\\le100$, and for any $0\\le i\\le n$, the term $a_ix^i$ appears exactly once, and the input is guaranteed to be sorted in decreasing order by $i$.\n\nAnother $10\\%$ of the data: $k=0$.\n\nAnother $10\\%$ of the data: $k=1$.\n\nAnother $10\\%$ of the data: $n=k$.\n\nFor $100\\%$ of the data: $n\\le100$, $k\\le n$, $m\\le10$, $a_i\\le10^5$, $x_0\\le10^5$.\n\n**Sample Explanation**\n\nDifferentiate $f(x)$. The first derivative is $f'(x)=3x^2+4x+1$. Differentiate again to get the second derivative: $f''(x)=6x+4$. Therefore, the required values are $f(0)=6*0+4=4$ and $f(1)=6*1+4=10$.\n\n**Notes**\n\nPS: Worried that everyone will complain about too much code (the setter is lazy), this version has been simplified a lot compared to the original problem.\n\nIf you get an early AC, you may want to read a duel between two “iron-head” tough guys:\n\n“Director Feng Differentiates Zheng Babang to Death with Three Derivatives”\n\nDirector Feng······ with just one derivative, differentiated right on the fraction, making Zheng Bang dizzy and confused, parameters skewed to one side. It was as if he had opened a table of elementary functions: squares, roots, everything ticked off and differentiated out. Zheng Iron-Head could not keep up, tossed the answer aside, and only shouted, “Good differentiation!” Director Feng scolded, “Iron-head brat! You still dare to talk back!” He picked up the pen and differentiated the numerator again, sparks flying, heads cracking and bleeding, as if he had opened a binomial theorem: cubic, quartic, quintic terms all burst out.\n\nThe people watching on both sides feared Director Feng. Who would dare step forward to stop him.\n\nZheng Bang could not differentiate it, and begged for mercy. Director Feng shouted, “Ha! You iron-head brat! If you only had the guts to do full case analysis with me, I might spare you! But now you beg me for mercy, and I insist on separating the parameters!” He differentiated once more. On the new function it went straight, like working from a common derivative table: exponentials, logarithms, numerator and denominator ringing together. When the director looked, he saw Zheng Bang collapsed on the ground, only exhaling, not inhaling, unable to move.\n\nDirector Feng pretended, “You bastard, playing dead. I will differentiate again!” Then his head gradually disappeared. The director thought, “I only meant to make him pay for one meal. I did not expect three derivatives would really differentiate him to death. I will get points deducted, and there are no more problems to do. Better to leave early.” He walked away, turned back and pointed at the paper, “This useless problem, I skip it!” While calculating, he strode away in big steps.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "GodFly的求导工具", "background": "“求得导中导，方为人上人。”作为一名铁头娃，GodFly 已不满足于简单的求导了。", "description": "GodFly 为了证明自己的头铁，决定挑战一项任务：求一个具有大整数系数的 $n$ 次多项式函数的 $k$ 阶导。现在他希望聪明的你能够…静静地坐在那里看他求导。要知道，他可是能与神威-太湖之光匹敌的男人。\n\n作为 GodFly 的朋友，xhx 希望你能帮他写一个程序，与 GodFly 一同计算导函数及导数。如果你的程序能跑过他的手算，xhx 会敲一下 GodFly 的铁头。\n\n*关于导数的几个运算法则：\n\n若 $f(x)=ax^n$，则 $f'(x)=anx^{n-1}$；\n\n若 $F(x)=f(x)+g(x)$，则 $F'(x)=f'(x)+g'(x)$；\n\n其中 $f'(x),g'(x),F'(x)$ 分别表示 $f(x),g(x),F(x)$ 的导函数。\n\n**不要被导数吓到，本题考点不在此。**\n\n**设 $g(x)=ax^3+bx^2+c$，则 $g(x_0)=ax_0^3+bx_0^2+c$。**\n\n**$k$ 阶导即求 $k$ 次导数。**\n\n**新样例：https://pan.baidu.com/s/1w64WmnnGtKyAluxrX3PkNg； 数据已更新。**", "inputFormat": "第一行，两个整数 $n,k$，含义见题面；\n\n接下来一行，一个字符串表示函数，为“$f(x)=a_{n}x^n+a_{n-1}x^{n-1}+....+a_0x^0$”，其中对于任意 $i$，$a_ix^i$ 的项可能不出现，也可能出现多次，且 $a_i$ 均为正整数，但系数为 $1$ 的项不输入 $a_i$，只输入 $x^i$；\n\n接下来一行一个数 $m$，表示询问个数；\n\n接下来 $m$ 行，每行一个数 **$x_0$**，表示求 $f(x)$ 的 $k$ 阶导在 $x_0$ 处的导数，**换句话说，假设 $g(x)$ 为 $f(x)$ 的 $k$ 阶导函数，求 $g(x_0)$**。\n\n不存在多余空格及空行。", "outputFormat": "$m$ 行，每行一个数表示所求的导数值。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，$n\\le5$，$a_i\\le100,x_0\\le100$，且对于任意 $0\\le i\\le n$，$a_ix^i$ 出现有且仅有一次，且保证数据以 $i$ 为关键字降序排列；\n\n另有 $10\\%$ 的数据，$k=0$；\n\n另有 $10\\%$ 的数据，$k=1$；\n\n另有 $10\\%$ 的数据，$n=k$；\n\n对于 $100\\%$ 的数据，$n\\le100$，$k\\le n$，$m\\le10$，$a_i\\le10^5$，$x_0\\le10^5$；\n\n**【样例说明】**\n\n对 $f(x)$ 求导，则一阶导 $f'(x)=3x^2+4x+1$；求二阶导，即对 $f'(x)$ 再求导，得 $f''(x)=6x+4$；故所求 $f(0)=6*0+4=4,f(1)=6*1+4=10$。\n\n**【提示】**\n\nPS：担心大家抱怨代码量大（出题人懒），较原题简化了许多。\n\n如果你提前 AK 了，不妨看看一段铁头娃之间的对决：\n\n《冯所长三导导死郑拔蚌》\n\n冯所长······扑的只一导，正导在分式上，导得郑蚌头晕眼花，参数歪在半边，却便似开了个初等函数表，平方，根号，对勾一发都导出来。郑铁头算不过来，那把答案也丢在一边，口里只叫：“导得好！”冯所长骂道：“铁头娃！还敢应口！”提起笔来就分子只一导，导得火星四溅，头破血流，也似开了个二项式定理，三次、四次、五次都绽将出来。\n两边看的人惧怕冯所长，谁敢向前来劝。\n\n郑蚌导不出，讨饶。冯所长喝道：“咄！你是个铁头娃！若只和俺分类讨论到底，洒家倒饶了你！你如今对俺讨饶，洒家偏要分离参数！”又只一导，新函数上正着，却似做了一个常用导数表，指数，对数，分子分母一齐响。所长看时，只见郑蚌倒在地上，口里只有出的气，没了入的气，动弹不得。\n\n冯所长假意道：“你这厮诈死，洒家再导！”只见头渐渐的没了。所长寻思道：“俺只指望消费这厮一顿，不想三导真个导死了他。洒家须扣分，又没题做，不如及早撒开。”拔步便走，回头指着试卷道：“这废题，洒家跳过！”一头算，一头大踏步去了。", "locale": "zh-CN"}}}
{"pid": "P4894", "type": "P", "difficulty": 3, "samples": [["1 2 3 3 2 1", "1 -2 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "计算几何", "Special Judge", "向量"], "title": "GodFly 求解法向量", "background": "“遇到函数无脑求导，遇到几何无脑建系。”是铁头娃的公共特征。\n\n作为喜欢建系的一个铁头娃，GodFly 经常需要计算法向量。", "description": "定义平面 $\\alpha$ 内有两相交向量 $\\vec{a}=(x_1,y_1,z_1), \\vec{b}=(x_2,y_2,z_2)$，若$\\vec{z}=(x,y,z)$ 为平面 $\\alpha$ 的法向量，则：\n\n$$\n\\begin{cases}\nx \\times x _ 1 + y \\times y _ 1 + z \\times z _ 1 = 0 \\\\ \nx \\times x _ 2 + y \\times y _ 2 + z \\times z _ 2 = 0\n\\end{cases}\n$$\n\n现给出 $\\vec{a}$ 及 $\\vec{b}$ 的坐标，求出一个法向量 $\\vec{z}$，并输出其坐标。", "inputFormat": "本题有多组数据；对于每组数据，一行六个数，分别为 $x_1,y_1,z_1,x_2,y_2,z_2$。", "outputFormat": "对于每组数据，三个数，$x,y,z$，之间用空格隔开。\n\n每组数据之间用空行隔开，法向量的坐标不可都为 $0$。", "hint": "### 数据范围\n\n所有坐标（包括答案）均在 $32$ 位整数范围内。\n\n- 对于 $30\\%$ 的数据，只有单组输入；\n- 对于 $100\\%$ 的数据，输入组数 $\\le 5\\times 10^4$，且输入的坐标均为绝对值不超过 $5 \\times 10^4$ 的正整数。\n\n### 提示\n\n本题有 Special Judge，输出任意一组解即可。", "locale": "zh-CN", "translations": {"en": {"title": "GodFly Solves the Normal Vector.", "background": "“Differentiate blindly when you see a function, and set up a coordinate system blindly when you see geometry.” This is a common trait of stubborn learners.\n\nAs a stubborn learner who likes setting up coordinate systems, GodFly often needs to compute normal vectors.", "description": "On plane $\\alpha$, there are two intersecting vectors $\\vec{a}=(x_1,y_1,z_1)$ and $\\vec{b}=(x_2,y_2,z_2)$. If $\\vec{z}=(x,y,z)$ is a normal vector of plane $\\alpha$, then:\n\n$$\n\\begin{cases}\nx \\times x _ 1 + y \\times y _ 1 + z \\times z _ 1 = 0 \\\\ \nx \\times x _ 2 + y \\times y _ 2 + z \\times z _ 2 = 0\n\\end{cases}\n$$\n\nYou are now given the coordinates of $\\vec{a}$ and $\\vec{b}$. Find one normal vector $\\vec{z}$ and output its coordinates.", "inputFormat": "This problem contains multiple test cases. For each test case, one line contains six numbers: $x_1,y_1,z_1,x_2,y_2,z_2$.", "outputFormat": "For each test case, output three numbers $x,y,z$, separated by spaces.\n\nSeparate outputs of different test cases with a blank line. The coordinates of the normal vector cannot all be $0$.", "hint": "### Constraints\n\nAll coordinates (including the answer) are within the $32$-bit integer range.\n\n- For $30\\%$ of the testdata, there is only one test case.\n- For $100\\%$ of the testdata, the number of test cases $\\le 5\\times 10^4$, and all input coordinates are positive integers with absolute values not exceeding $5 \\times 10^4$.\n\n### Hint\n\nThis problem uses Special Judge. You may output any valid solution.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "GodFly 求解法向量", "background": "“遇到函数无脑求导，遇到几何无脑建系。”是铁头娃的公共特征。\n\n作为喜欢建系的一个铁头娃，GodFly 经常需要计算法向量。", "description": "定义平面 $\\alpha$ 内有两相交向量 $\\vec{a}=(x_1,y_1,z_1), \\vec{b}=(x_2,y_2,z_2)$，若$\\vec{z}=(x,y,z)$ 为平面 $\\alpha$ 的法向量，则：\n\n$$\n\\begin{cases}\nx \\times x _ 1 + y \\times y _ 1 + z \\times z _ 1 = 0 \\\\ \nx \\times x _ 2 + y \\times y _ 2 + z \\times z _ 2 = 0\n\\end{cases}\n$$\n\n现给出 $\\vec{a}$ 及 $\\vec{b}$ 的坐标，求出一个法向量 $\\vec{z}$，并输出其坐标。", "inputFormat": "本题有多组数据；对于每组数据，一行六个数，分别为 $x_1,y_1,z_1,x_2,y_2,z_2$。", "outputFormat": "对于每组数据，三个数，$x,y,z$，之间用空格隔开。\n\n每组数据之间用空行隔开，法向量的坐标不可都为 $0$。", "hint": "### 数据范围\n\n所有坐标（包括答案）均在 $32$ 位整数范围内。\n\n- 对于 $30\\%$ 的数据，只有单组输入；\n- 对于 $100\\%$ 的数据，输入组数 $\\le 5\\times 10^4$，且输入的坐标均为绝对值不超过 $5 \\times 10^4$ 的正整数。\n\n### 提示\n\n本题有 Special Judge，输出任意一组解即可。", "locale": "zh-CN"}}}
{"pid": "P4895", "type": "P", "difficulty": 6, "samples": [["1\n", "2"], ["5\n1 2\n1 3\n1 4\n1 5", "6"], ["6\n1 2\n1 3\n1 4\n4 5\n4 6", "9"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2013", "O2优化", "湖北"], "title": "独钓寒江雪", "background": "", "description": "给定一棵无根树，求其中本质不同的独立集的个数。", "inputFormat": "第一行：一个整数$n$，树上的结点数量（$n \\leq 5\\times 10^5$）\n\n第二行到第$n$行：每行两个整数$u$和$v$，表示$u$和$v$连着一条边", "outputFormat": "单个整数：输出方案数模$10^9+7$的余数", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Snow Fishing Alone on a Cold River", "background": "", "description": "Given an unrooted tree, find the number of essentially different independent sets in it.", "inputFormat": "The first line contains an integer $n$, the number of nodes in the tree ($n \\leq 5\\times 10^5$).\n\nLines $2$ to $n$ each contain two integers $u$ and $v$, indicating that there is an edge connecting $u$ and $v$.", "outputFormat": "Output a single integer: the number of valid ways modulo $10^9+7$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "独钓寒江雪", "background": "", "description": "给定一棵无根树，求其中本质不同的独立集的个数。", "inputFormat": "第一行：一个整数$n$，树上的结点数量（$n \\leq 5\\times 10^5$）\n\n第二行到第$n$行：每行两个整数$u$和$v$，表示$u$和$v$连着一条边", "outputFormat": "单个整数：输出方案数模$10^9+7$的余数", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4896", "type": "P", "difficulty": 2, "samples": [["10\nA B C\na b c d e\nA came!\na started playing games!\nb started playing games!\nA left!\nc started playing games!\nd started playing games!\ne started playing games!\nB came!\nPS:zhe_ge_yang_li_hen_zheng_chang!\nB left!", "a b c d e\nHow Bad Oiers Are!"], ["10\nI_Love_You I_Hate_You Why_Not_love_Me\nGay Che_Wan_Dang QwQ WuMaRu PDD\nI_Love_You came!\nGay:Why do you love me?\nI_Love_You died!\nI_Love_You left!\nChe_Wan_Dang prepared to play Dong_Fang!\nBut nobody came!\nQwQ:I am so QwQ,I love myself!\nPDD started playing Gay!\nGay died!And WuMaRu cried!\nWuMaRu:dai su ki!", "How Good Oiers Are!"], ["20\nSans QwQ QAQ\nA B C D E\nA started playing B!\nB started fighting with A!\nA won!\nA get 10000000 Exp!\nQwQ:I and QAQ are looking at you all!\nC died!\nD died!\nE recovered 123456789 HP!\nE started playing games!\nSans came!\nSans:It is really a nice day today!\nSans:The birds are singing!\nSans:The flowers in bloom!\nSans:In a beautiful day like this!\nSans:People like you!\nSans:Should burn in hell!\nE tried to attack Sans!\nSans was killed!\nSans:Papyrus,do you want something?\nE still played his Undertale!", "E"], ["20\na b c\nA B C D E\nA came!\na started playing games!\nb came!\nb came together!\nb came! dan_shi_zhe_ju_hua_bu_dui!\nA came came came!\nb start playing games!\nb left!\nc came!\nc left!\nA left!\nB started playing games!\nA started playing game!\nC started palying games!\nE started playing games!\nlu_ren_jia came!\nlu_ren_jia:What are you doing?\nC&D:We are studying!\nlu_ren_jia:Good boy!\nC:qwq", "How Good Oiers Are!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "字符串", "洛谷原创", "O2优化", "排序"], "title": "OIer们的烦恼", "background": "OIer 们有一个烦恼，他们本来可以随心所欲玩游戏上网的，自从学校机房开启 URL 过滤后，OIer 们就开始在 luogu 上面找游戏玩。\n\n但是他们刚玩 slay.one 几天之后 slay.one 就被封禁了，只有工作日的中午 2 小时可以嗨皮，并且会有帅气的老师来巡视机房，他们该怎么办呢？", "description": "有 3 个帅气的老师 $A$，$B$ 和 $C$。\n\n有 5 个学生 $a$，$b$，$c$，$d$，$e$。当他们当中的某一个人开始玩游戏时，会显示一条消息 `XX started playing games!`。当他们当中的某一个人停止玩游戏时，会显示一条消息 `XX stopped playing games!`。\n\n当某个老师来巡视机房时，会显示一条消息：`XX came!`。如果某个老师走了，会显示一条消息：`XX left!`。\n\n如果老师发现某个学生**正在**玩游戏时，请输出该学生的姓名。", "inputFormat": "有 $N$ 条消息。\n\n第一行输入 $N$，第 $2$ 行输入 $3$ 个老师的名字，第 $3$ 行输入 $5$ 个学生的名字，接下来 $n$ 行输入 $N$ 条消息。", "outputFormat": "输出全部在老师巡视时被发现玩游戏学生的名字，按字典序输出。\n\n如果全部学生都被发现玩游戏，额外输出 `How Bad Oiers Are!`。\n\n如果没有人被发现或者没有人玩游戏，输出 `How Good Oiers Are!`。", "hint": "对于 $20\\%$ 的数据，$1\\leq N\\leq 23.3333333333333$。          \n对于 $30\\%$ 的数据，$1\\leq N\\leq 999.999$，有一个点答案为 `How Good Oiers Are!`。         \n对于 $60\\%$ 的数据，$1\\leq N\\leq 100,000$。    \n对于$99.9999999999999999999\\%$的数据，不保证全部消息都符合题意。           \n对于 $100\\%$ 的数据，$1\\leq N\\leq 233,333$，数据有梯度。\n \n### Tips:\n1.消息中肯定有奇奇怪怪的东西。  \n2.消息必须**完全符合题意**才有效。  \n3.样例很恶心，数据很纯真。   \n4.数据满足不会同时有多个**老师**巡视。     \n5.注意仔细阅读**题目**和**样例**，**该题有坑！**", "locale": "zh-CN", "translations": {"en": {"title": "OIers' Troubles.", "background": "OIers have a trouble. They used to be able to play games and surf the Internet as they liked, but ever since the school computer room enabled URL filtering, OIers started looking for games to play on Luogu.\n\nHowever, after they played slay.one for just a few days, slay.one was blocked. They can only have fun for 2 hours at noon on weekdays, and there will be a handsome teacher patrolling the computer room. What should they do?", "description": "There are 3 handsome teachers $A$, $B$, and $C$.\n\nThere are 5 students $a$, $b$, $c$, $d$, $e$. When any one of them starts playing games, a message `XX started playing games!` will be shown. When any one of them stops playing games, a message `XX stopped playing games!` will be shown.\n\nWhen a teacher comes to patrol the computer room, a message `XX came!` will be shown. If a teacher leaves, a message `XX left!` will be shown.\n\nIf a teacher finds that some student is **playing** games, output that student's name.", "inputFormat": "There are $N$ messages.\n\nThe first line contains $N$. The second line contains the names of the 3 teachers. The third line contains the names of the 5 students. Then the next $N$ lines contain the $N$ messages.", "outputFormat": "Output the names of all students who are found playing games while teachers are patrolling, in lexicographical order.\n\nIf all students are found playing games, additionally output `How Bad Oiers Are!`.\n\nIf no one is found, or no one plays games, output `How Good Oiers Are!`.", "hint": "For $20\\%$ of the testdata, $1\\leq N\\leq 23.3333333333333$.  \nFor $30\\%$ of the testdata, $1\\leq N\\leq 999.999$, and there is one test point whose answer is `How Good Oiers Are!`.  \nFor $60\\%$ of the testdata, $1\\leq N\\leq 100,000$.  \nFor $99.9999999999999999999\\%$ of the testdata, it is not guaranteed that all messages follow the statement.  \nFor $100\\%$ of the testdata, $1\\leq N\\leq 233,333$, and the testdata has gradients.\n\n### Tips:\n1. There will definitely be some weird stuff in the messages.  \n2. A message is valid only if it **fully matches the statement**.  \n3. The sample is disgusting, but the testdata is very innocent.  \n4. The testdata guarantees that there will not be multiple **teachers** patrolling at the same time.  \n5. Read the **problem** and the **sample** carefully. **This problem has traps!**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "OIer们的烦恼", "background": "OIer 们有一个烦恼，他们本来可以随心所欲玩游戏上网的，自从学校机房开启 URL 过滤后，OIer 们就开始在 luogu 上面找游戏玩。\n\n但是他们刚玩 slay.one 几天之后 slay.one 就被封禁了，只有工作日的中午 2 小时可以嗨皮，并且会有帅气的老师来巡视机房，他们该怎么办呢？", "description": "有 3 个帅气的老师 $A$，$B$ 和 $C$。\n\n有 5 个学生 $a$，$b$，$c$，$d$，$e$。当他们当中的某一个人开始玩游戏时，会显示一条消息 `XX started playing games!`。当他们当中的某一个人停止玩游戏时，会显示一条消息 `XX stopped playing games!`。\n\n当某个老师来巡视机房时，会显示一条消息：`XX came!`。如果某个老师走了，会显示一条消息：`XX left!`。\n\n如果老师发现某个学生**正在**玩游戏时，请输出该学生的姓名。", "inputFormat": "有 $N$ 条消息。\n\n第一行输入 $N$，第 $2$ 行输入 $3$ 个老师的名字，第 $3$ 行输入 $5$ 个学生的名字，接下来 $n$ 行输入 $N$ 条消息。", "outputFormat": "输出全部在老师巡视时被发现玩游戏学生的名字，按字典序输出。\n\n如果全部学生都被发现玩游戏，额外输出 `How Bad Oiers Are!`。\n\n如果没有人被发现或者没有人玩游戏，输出 `How Good Oiers Are!`。", "hint": "对于 $20\\%$ 的数据，$1\\leq N\\leq 23.3333333333333$。          \n对于 $30\\%$ 的数据，$1\\leq N\\leq 999.999$，有一个点答案为 `How Good Oiers Are!`。         \n对于 $60\\%$ 的数据，$1\\leq N\\leq 100,000$。    \n对于$99.9999999999999999999\\%$的数据，不保证全部消息都符合题意。           \n对于 $100\\%$ 的数据，$1\\leq N\\leq 233,333$，数据有梯度。\n \n### Tips:\n1.消息中肯定有奇奇怪怪的东西。  \n2.消息必须**完全符合题意**才有效。  \n3.样例很恶心，数据很纯真。   \n4.数据满足不会同时有多个**老师**巡视。     \n5.注意仔细阅读**题目**和**样例**，**该题有坑！**", "locale": "zh-CN"}}}
{"pid": "P4897", "type": "P", "difficulty": 6, "samples": [["3 5\n0 1 2\n1 2 2\n3 1 3\n3 2 1\n0 2 1\n3\n0 3\n1 3\n1 2", "3\n4\n4"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["网络流", "深度优先搜索 DFS", "最小割", "模板题"], "title": "【模板】最小割树（Gomory-Hu Tree）", "background": "模板题。做本题之前请确保你会 Dinic 或 ISAP。如果你乱搞过了我请你抽烟。\n\n根据惯例，网络流题不允许卡 Dinic/ISAP，但可以卡 EK，本题数据严格遵循上述条约。", "description": "给定一个 $n+1$ 个点 $m$ 条边的无向连通图，编号 $0\\sim n$，多次询问两点之间的最小割。\n\n两点间的最小割是这样定义的：原图的每条边有一个割断它的代价，你需要用最小的代价使得这两个点不连通。", "inputFormat": "第一行两个数 $n,m$。\n\n接下来 $m$ 行，每行 $3$ 个数 $u,v,w$，表示有一条连接 $u$ 与 $v$ 的无向边，割断它的代价为 $w$。\n\n接下来这一行有一个整数 $Q$，表示询问次数。\n\n接下来 $Q$ 行，每行两个数 $u,v$，你需要求出 $u$ 与 $v$ 之间的最小割。", "outputFormat": "输出共 $Q$ 行，每行一个整数对应询问的答案。", "hint": "保证 $1\\le n\\leq 500$，$0\\le m\\leq 1500$，$0\\le Q\\leq 10^5$，$0\\leq w\\leq 10^4$，$u\\neq v$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Gomory-Hu Tree (Minimum Cut Tree)", "background": "This is a template problem. Before solving it, please make sure you know Dinic or ISAP. If you brute-force your way through, I will ask you to smoke.\n\nBy convention, network flow problems do not allow testdata that hacks Dinic/ISAP, but they may hack EK. The testdata for this problem strictly follows the rule above.", "description": "Given an undirected connected graph with $n + 1$ vertices and $m$ edges, labeled from $0$ to $n$, answer multiple queries asking for the minimum cut between two vertices.\n\nThe minimum cut between two vertices is defined as follows: each edge in the original graph has a cost to cut it, and you need to make the two vertices disconnected with the minimum total cost.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next $m$ lines each contain three integers $u, v, w$, indicating an undirected edge between $u$ and $v$, with cutting cost $w$.\n\nThe next line contains an integer $Q$, the number of queries.\n\nThe next $Q$ lines each contain two integers $u, v$. You need to compute the minimum cut between $u$ and $v$.", "outputFormat": "Output $Q$ lines. Each line contains one integer, the answer to the corresponding query.", "hint": "Constraints: $1 \\le n \\le 500$, $0 \\le m \\le 1500$, $0 \\le Q \\le 10^5$, $0 \\le w \\le 10^4$, and $u \\neq v$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】最小割树（Gomory-Hu Tree）", "background": "模板题。做本题之前请确保你会 Dinic 或 ISAP。如果你乱搞过了我请你抽烟。\n\n根据惯例，网络流题不允许卡 Dinic/ISAP，但可以卡 EK，本题数据严格遵循上述条约。", "description": "给定一个 $n+1$ 个点 $m$ 条边的无向连通图，编号 $0\\sim n$，多次询问两点之间的最小割。\n\n两点间的最小割是这样定义的：原图的每条边有一个割断它的代价，你需要用最小的代价使得这两个点不连通。", "inputFormat": "第一行两个数 $n,m$。\n\n接下来 $m$ 行，每行 $3$ 个数 $u,v,w$，表示有一条连接 $u$ 与 $v$ 的无向边，割断它的代价为 $w$。\n\n接下来这一行有一个整数 $Q$，表示询问次数。\n\n接下来 $Q$ 行，每行两个数 $u,v$，你需要求出 $u$ 与 $v$ 之间的最小割。", "outputFormat": "输出共 $Q$ 行，每行一个整数对应询问的答案。", "hint": "保证 $1\\le n\\leq 500$，$0\\le m\\leq 1500$，$0\\le Q\\leq 10^5$，$0\\leq w\\leq 10^4$，$u\\neq v$。", "locale": "zh-CN"}}}
{"pid": "P4898", "type": "P", "difficulty": 7, "samples": [["2 3 2\n0 0\n1 0\n1 1\n0 1\n0 2\n1 2\n0 5\n0 5\n", "3\n4\n"], ["1 5 3\n0 0\n0 1\n0 2\n0 3\n0 4\n0 1\n0 3\n4 0\n", "5\n3\n2\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000]}, "tags": ["2018", "线段树", "IOI", "O2优化", "连通块"], "title": "[IOI 2018] seats 排座位", "background": "本题为交互题，但在此请提交**完整程序**。", "description": "你要在一个长方形大厅里举办国际编程比赛，该大厅共有 $HW$ 个座位（$H$ 行 $W$ 列）。行的编号是从 $0$ 到 $H-1$，列的编号是从 $0$ 到 $W-1$。位于 $r$ 行 $c$ 列的座位用 $(r,c)$ 表示。一共邀请了 $HW$ 位参赛者，编号是从 $0$ 到 $HW-1$。你制定好了一个座位表，第 $i(0 \\leq i \\leq HW - 1)$ 个参赛者被安排到座位 $(R_i,C_i)$。座位表中参赛者和座位是一一对应的。\n\n大厅中一个座位集合 $S$ 被称为是**长方形的**，如果存在整数 $r_1, r_2, c_1$ 和 $c_2$ 满足下列条件：\n\n- $0 \\leq r_1 \\leq r_2 \\leq H - 1$。\n- $0 \\leq c_1 \\leq c_2 \\leq W - 1$。\n- $S$ 正好是所有满足 $r_1 \\leq r \\leq r_2$ 和 $c_1 \\leq c \\leq c_2$ 的座位 $(r, c)$ 的集合。\n\n如果一个长方形座位集合包含 $k(1 \\leq k \\leq HW)$ 个座位，并且被分配到这个集合的参赛者的编号恰好是从 $0$ 到 $k-1$，那么该集合是**美妙的**。一个座位表的**美妙度**定义为这个表中美妙的长方形座位集合的个数。\n\n在准备好座位表后，你会收到一些交换两个参赛者座位的请求。具体来说，有 $Q$ 个这样的请求，按时间顺序编号为 $0$ 到 $Q-1$。第 $j(0 \\leq j \\leq Q - 1)$ 个请求希望交换参赛者 $A_j$ 和 $B_j$ 的座位。你立即接受每个请求并更新座位表。每次更新后，你的目标是计算当前座位表的美妙度。", "inputFormat": "输入的第一行包含三个正整数 $H, W, Q$，其意义见题目描述。\n\n接下来 $HW$ 行，每行包含两个非负整数。在这 $HW$ 行中，第 $i$ 行的两个整数分别表示 $R_{i - 1}, C_{i - 1}$，即编号为 $i - 1$ 的参赛者初始座位的行和列。\n\n接下来 $Q$ 行，每行包含两个非负整数。在这 $Q$ 行中，第 $j$ 行的两个整数分别表示 $A_{j - 1}, B_{j - 1}$，即在编号为 $j - 1$ 的请求中希望被交换座位的两位参赛者的编号。", "outputFormat": "输出共 $Q$ 行，每行包含一个整数，第 $i$ 行的整数表示按时间顺序处理完编号为 $i - 1$ 的交换请求之后当前座位表的美妙度。", "hint": "**限制条件**\n\n- $1 \\leq H$\n- $1 \\leq W$\n- $HW \\leq 1, 000, 000$\n- $0 \\leq R_i \\leq H - 1(0 \\leq i \\leq HW - 1)$\n- $0 \\leq C_i \\leq W - 1(0 \\leq i \\leq HW - 1)$\n- $(R_i, C_i) \\neq (R_j, C_j)(0 \\leq i < j \\leq HW - 1)$\n- $1 \\leq Q \\leq 50, 000$\n- $0 \\leq A_j \\leq HW - 1(0 \\leq j \\leq Q - 1)$\n- $0 \\leq B_j \\leq HW - 1(0 \\leq j \\leq Q - 1)$\n- $A_j \\neq B_j(0 \\leq j \\leq Q - 1)$\n\n**子任务**\n\n- 1.（5 分） $HW \\leq 100$，$Q \\leq 5, 000$\n- 2.（6 分） $HW \\leq 10, 000$，$Q \\leq 5, 000$\n- 3.（20 分） $H \\leq 1, 000$，$W \\leq 1, 000$，$Q \\leq 5, 000$\n- 4.（6 分） $Q \\leq 5, 000$，$|A_j - B_j| \\leq 10, 000(0 \\leq j \\leq Q - 1)$\n- 5.（33 分） $H = 1$\n- 6.（30 分） 无附加限制条件", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2018] seats Seating Arrangement.", "background": "This is an interactive problem, but here you should submit a **full program**.", "description": "You are going to hold an international programming contest in a rectangular hall. The hall has $HW$ seats ($H$ rows and $W$ columns). Rows are numbered from $0$ to $H - 1$, and columns are numbered from $0$ to $W - 1$. The seat in row $r$ and column $c$ is denoted by $(r, c)$. There are $HW$ contestants, numbered from $0$ to $HW - 1$. You have prepared a seating plan: contestant $i(0 \\leq i \\leq HW - 1)$ is assigned to seat $(R_i, C_i)$. The seating plan is a one-to-one correspondence between contestants and seats.\n\nA set of seats $S$ in the hall is called **rectangular** if there exist integers $r_1, r_2, c_1$, and $c_2$ such that:\n\n- $0 \\leq r_1 \\leq r_2 \\leq H - 1$.\n- $0 \\leq c_1 \\leq c_2 \\leq W - 1$.\n- $S$ is exactly the set of all seats $(r, c)$ that satisfy $r_1 \\leq r \\leq r_2$ and $c_1 \\leq c \\leq c_2$.\n\nIf a rectangular set of seats contains $k(1 \\leq k \\leq HW)$ seats, and the contestant IDs assigned to these seats are exactly from $0$ to $k - 1$, then this set is **nice**. The **niceness** of a seating plan is defined as the number of nice rectangular seat sets in the plan.\n\nAfter you finish the seating plan, you will receive some requests to swap the seats of two contestants. Specifically, there are $Q$ such requests, numbered from $0$ to $Q - 1$ in time order. Request $j(0 \\leq j \\leq Q - 1)$ wants to swap the seats of contestants $A_j$ and $B_j$. You accept each request immediately and update the seating plan. After each update, your task is to compute the niceness of the current seating plan.", "inputFormat": "The first line contains three positive integers $H, W, Q$, as described above.\n\nThe next $HW$ lines each contain two non-negative integers. In these $HW$ lines, line $i$ contains $R_{i - 1}, C_{i - 1}$, i.e., the row and column of the initial seat of contestant $i - 1$.\n\nThe next $Q$ lines each contain two non-negative integers. In these $Q$ lines, line $j$ contains $A_{j - 1}, B_{j - 1}$, i.e., the IDs of the two contestants whose seats should be swapped in request $j - 1$.", "outputFormat": "Output $Q$ lines. Each line contains one integer. The integer on line $i$ is the niceness of the current seating plan after processing swap request $i - 1$ in time order.", "hint": "**Constraints**\n\n- $1 \\leq H$.\n- $1 \\leq W$.\n- $HW \\leq 1, 000, 000$.\n- $0 \\leq R_i \\leq H - 1(0 \\leq i \\leq HW - 1)$.\n- $0 \\leq C_i \\leq W - 1(0 \\leq i \\leq HW - 1)$.\n- $(R_i, C_i) \\neq (R_j, C_j)(0 \\leq i < j \\leq HW - 1)$.\n- $1 \\leq Q \\leq 50, 000$.\n- $0 \\leq A_j \\leq HW - 1(0 \\leq j \\leq Q - 1)$.\n- $0 \\leq B_j \\leq HW - 1(0 \\leq j \\leq Q - 1)$.\n- $A_j \\neq B_j(0 \\leq j \\leq Q - 1)$.\n\n**Subtasks**\n\n- 1. (5 points) $HW \\leq 100$, $Q \\leq 5, 000$.\n- 2. (6 points) $HW \\leq 10, 000$, $Q \\leq 5, 000$.\n- 3. (20 points) $H \\leq 1, 000$, $W \\leq 1, 000$, $Q \\leq 5, 000$.\n- 4. (6 points) $Q \\leq 5, 000$, $|A_j - B_j| \\leq 10, 000(0 \\leq j \\leq Q - 1)$.\n- 5. (33 points) $H = 1$.\n- 6. (30 points) No additional constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2018] seats 排座位", "background": "本题为交互题，但在此请提交**完整程序**。", "description": "你要在一个长方形大厅里举办国际编程比赛，该大厅共有 $HW$ 个座位（$H$ 行 $W$ 列）。行的编号是从 $0$ 到 $H-1$，列的编号是从 $0$ 到 $W-1$。位于 $r$ 行 $c$ 列的座位用 $(r,c)$ 表示。一共邀请了 $HW$ 位参赛者，编号是从 $0$ 到 $HW-1$。你制定好了一个座位表，第 $i(0 \\leq i \\leq HW - 1)$ 个参赛者被安排到座位 $(R_i,C_i)$。座位表中参赛者和座位是一一对应的。\n\n大厅中一个座位集合 $S$ 被称为是**长方形的**，如果存在整数 $r_1, r_2, c_1$ 和 $c_2$ 满足下列条件：\n\n- $0 \\leq r_1 \\leq r_2 \\leq H - 1$。\n- $0 \\leq c_1 \\leq c_2 \\leq W - 1$。\n- $S$ 正好是所有满足 $r_1 \\leq r \\leq r_2$ 和 $c_1 \\leq c \\leq c_2$ 的座位 $(r, c)$ 的集合。\n\n如果一个长方形座位集合包含 $k(1 \\leq k \\leq HW)$ 个座位，并且被分配到这个集合的参赛者的编号恰好是从 $0$ 到 $k-1$，那么该集合是**美妙的**。一个座位表的**美妙度**定义为这个表中美妙的长方形座位集合的个数。\n\n在准备好座位表后，你会收到一些交换两个参赛者座位的请求。具体来说，有 $Q$ 个这样的请求，按时间顺序编号为 $0$ 到 $Q-1$。第 $j(0 \\leq j \\leq Q - 1)$ 个请求希望交换参赛者 $A_j$ 和 $B_j$ 的座位。你立即接受每个请求并更新座位表。每次更新后，你的目标是计算当前座位表的美妙度。", "inputFormat": "输入的第一行包含三个正整数 $H, W, Q$，其意义见题目描述。\n\n接下来 $HW$ 行，每行包含两个非负整数。在这 $HW$ 行中，第 $i$ 行的两个整数分别表示 $R_{i - 1}, C_{i - 1}$，即编号为 $i - 1$ 的参赛者初始座位的行和列。\n\n接下来 $Q$ 行，每行包含两个非负整数。在这 $Q$ 行中，第 $j$ 行的两个整数分别表示 $A_{j - 1}, B_{j - 1}$，即在编号为 $j - 1$ 的请求中希望被交换座位的两位参赛者的编号。", "outputFormat": "输出共 $Q$ 行，每行包含一个整数，第 $i$ 行的整数表示按时间顺序处理完编号为 $i - 1$ 的交换请求之后当前座位表的美妙度。", "hint": "**限制条件**\n\n- $1 \\leq H$\n- $1 \\leq W$\n- $HW \\leq 1, 000, 000$\n- $0 \\leq R_i \\leq H - 1(0 \\leq i \\leq HW - 1)$\n- $0 \\leq C_i \\leq W - 1(0 \\leq i \\leq HW - 1)$\n- $(R_i, C_i) \\neq (R_j, C_j)(0 \\leq i < j \\leq HW - 1)$\n- $1 \\leq Q \\leq 50, 000$\n- $0 \\leq A_j \\leq HW - 1(0 \\leq j \\leq Q - 1)$\n- $0 \\leq B_j \\leq HW - 1(0 \\leq j \\leq Q - 1)$\n- $A_j \\neq B_j(0 \\leq j \\leq Q - 1)$\n\n**子任务**\n\n- 1.（5 分） $HW \\leq 100$，$Q \\leq 5, 000$\n- 2.（6 分） $HW \\leq 10, 000$，$Q \\leq 5, 000$\n- 3.（20 分） $H \\leq 1, 000$，$W \\leq 1, 000$，$Q \\leq 5, 000$\n- 4.（6 分） $Q \\leq 5, 000$，$|A_j - B_j| \\leq 10, 000(0 \\leq j \\leq Q - 1)$\n- 5.（33 分） $H = 1$\n- 6.（30 分） 无附加限制条件", "locale": "zh-CN"}}}
{"pid": "P4899", "type": "P", "difficulty": 6, "samples": [["6 6 3\n5 1\n1 2\n1 3\n3 4\n3 0\n5 2\n4 2 1 2\n4 2 2 2\n5 4 3 4\n", "1\n0\n0\n"], ["10 9 10\n6 7\n1 5\n8 0\n2 9\n9 4\n2 7\n8 5\n6 0\n3 4\n4 9 0 9\n8 1 8 9\n1 8 1 8\n8 3 5 5\n8 9 3 9\n0 1 0 2\n9 0 6 6\n1 7 1 8\n9 4 5 6\n9 5 0 9\n", "1\n1\n1\n0\n1\n1\n0\n1\n0\n1\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888, 549888]}, "tags": ["2018", "树状数组", "Kruskal 重构树", "IOI", "O2优化", "深度优先搜索 DFS", "可持久化线段树"], "title": "[IOI 2018] werewolf 狼人", "background": "本题为交互题，但在此请提交**完整程序**。", "description": "在日本的茨城县内共有 $N$ 个城市和 $M$ 条道路。这些城市是根据人口数量的升序排列的，依次编号为 $0$ 到 $N - 1$。每条道路连接两个不同的城市，并且可以双向通行。由这些道路，你能从任意一个城市到另外任意一个城市。\n\n你计划了 $Q$ 个行程，这些行程分别编号为 $0$ 至 $Q - 1$。第 $i(0 \\leq i \\leq Q - 1)$ 个行程是从城市 $S_i$ 到城市 $E_i$。\n\n你是一个狼人。你有两种形态：**人形**和**狼形**。在每个行程开始的时候，你是人形。在每个行程结束的时候，你必须是狼形。在行程中，你必须要变身（从人形变成狼形）恰好一次，而且只能在某个城市内（包括可能是在 $S_i$ 或 $E_i$ 内）变身。\n\n狼人的生活并不容易。当你是人形时，你必须避开人少的城市，而当你是狼形时，你必须避开人多的城市。对于每一次行程 $i(0 \\leq i \\leq Q - 1)$，都有两个阈值 $L_i$ 和 $R_i(0 \\leq L_i \\leq R_i \\leq N - 1)$，用以表示哪些城市必须要避开。准确地说，当你是人形时，你必须避开城市 $0, 1, \\ldots , L_i - 1$ ；而当你是狼形时，则必须避开城市 $R_i + 1, R_i + 2, \\ldots , N - 1$。这就是说，在行程 $i$ 中，你必须在城市 $L_i, L_i + 1, \\ldots , R_i$ 中的其中一个城市内变身。\n\n你的任务是，对每一次行程，判定是否有可能在满足上述限制的前提下，由城市 $S_i$ 走到城市 $E_i$。你的路线可以有任意长度。", "inputFormat": "输入的第一行包含三个正整数 $N, M, Q$，其意义见题目描述。\n\n接下来 $M$ 行，每行包含两个非负整数。在这 $M$ 行中，第 $j$ 行的两个非负整数分别表示 $X_{j - 1}, Y_{j - 1}$，即编号为 $j - 1$ 的道路连接的两个城市的编号。\n\n接下来 $Q$ 行，每行包含四个非负整数。在这 $Q$ 行中，第 $i$ 行的四个非负整数分别表示 $S_{i - 1}, E_{i - 1}, L_{i - 1}, R_{i - 1}$，即编号为 $i - 1$ 的行程的起点城市编号、终点城市编号以及两个阈值。", "outputFormat": "输出包含 $Q$ 行，每行包含一个非 $0$ 即 $1$ 的整数。第 $i$ 行的整数表示对于编号为 $i - 1$ 的行程，是否能从城市 $S_{i - 1}$ 走至城市 $E_{i - 1}$，若能够，那么输出整数为 $1$；若不能，那么输出整数为 $0$。", "hint": "**限制条件**\n\n- $2 \\leq N \\leq 200, 000$\n- $N - 1 \\leq M \\leq 400, 000$\n- $1 \\leq Q \\leq 200, 000$\n- 对于每个 $0 \\leq j \\leq M - 1$\n    - $0 \\leq X_j \\leq N - 1$\n    - $0 \\leq Y_j \\leq N - 1$\n    - $X_j \\neq Y_j$\n- 你可以通过道路由任意一个城市去另外任意一个城市。\n- 每一对城市最多只由一条道路直接连起来。换言之，对于所有 $0 \\leq j < k \\leq M - 1$，都有 $(X_j, Y_j) \\neq (X_k, Y_k)$ 和 $(Y_j, X_j) \\neq (X_k, Y_k)$\n- 对于每个 $0 \\leq i \\leq Q - 1$\n    - $0 \\leq L_i \\leq S_i \\leq N - 1$\n    - $0 \\leq E_i \\leq R_i \\leq N - 1$\n    - $S_i \\neq E_i$\n    - $L_i \\leq R_i$\n\n**子任务**\n\n- 1.（7 分）$N \\leq 100$，$M \\leq 200$，$Q \\leq 100$。\n- 2.（8 分）$N \\leq 3, 000$，$M \\leq 6, 000$，$Q \\leq 3, 000$。\n- 3.（34 分）$M = N - 1$ 且每个城市最多与两条路相连（所有城市是以一条直线的形式连起来）。\n- 4.（51 分）没有附加限制。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2018] werewolf Werewolf.", "background": "This problem is an interactive problem, but here you should submit a **full program**.", "description": "In Ibaraki Prefecture, Japan, there are $N$ cities and $M$ roads. The cities are sorted in increasing order of population and are numbered from $0$ to $N - 1$. Each road connects two different cities and can be traveled in both directions. Using these roads, you can travel from any city to any other city.\n\nYou have planned $Q$ trips, numbered from $0$ to $Q - 1$. Trip $i(0 \\leq i \\leq Q - 1)$ goes from city $S_i$ to city $E_i$.\n\nYou are a werewolf. You have two forms: **human form** and **wolf form**. At the start of each trip, you are in human form. At the end of each trip, you must be in wolf form. During the trip, you must transform (from human form to wolf form) exactly once, and you can only transform inside a city (possibly at $S_i$ or $E_i$).\n\nLife as a werewolf is not easy. When you are in human form, you must avoid cities with small populations, and when you are in wolf form, you must avoid cities with large populations. For each trip $i(0 \\leq i \\leq Q - 1)$, there are two thresholds $L_i$ and $R_i(0 \\leq L_i \\leq R_i \\leq N - 1)$ that describe which cities must be avoided. More precisely, when you are in human form, you must avoid cities $0, 1, \\ldots , L_i - 1$; when you are in wolf form, you must avoid cities $R_i + 1, R_i + 2, \\ldots , N - 1$. This means that in trip $i$, you must transform in one of the cities $L_i, L_i + 1, \\ldots , R_i$.\n\nYour task is: for each trip, determine whether it is possible to travel from city $S_i$ to city $E_i$ while satisfying the restrictions above. Your route may have any length.", "inputFormat": "The first line contains three positive integers $N, M, Q$, as described above.\n\nThe next $M$ lines each contain two non-negative integers. In these $M$ lines, the $j$-th line contains $X_{j - 1}, Y_{j - 1}$, meaning that road number $j - 1$ connects those two cities.\n\nThe next $Q$ lines each contain four non-negative integers. In these $Q$ lines, the $i$-th line contains $S_{i - 1}, E_{i - 1}, L_{i - 1}, R_{i - 1}$, meaning that trip number $i - 1$ starts at city $S_{i - 1}$, ends at city $E_{i - 1}$, and has the two thresholds.", "outputFormat": "Output $Q$ lines, each containing an integer that is either $0$ or $1$. The integer on line $i$ indicates whether, for trip number $i - 1$, it is possible to travel from city $S_{i - 1}$ to city $E_{i - 1}$. Output $1$ if it is possible, otherwise output $0$.", "hint": "**Constraints**\n\n- $2 \\leq N \\leq 200, 000$\n- $N - 1 \\leq M \\leq 400, 000$\n- $1 \\leq Q \\leq 200, 000$\n- For each $0 \\leq j \\leq M - 1$\n    - $0 \\leq X_j \\leq N - 1$\n    - $0 \\leq Y_j \\leq N - 1$\n    - $X_j \\neq Y_j$\n- You can travel from any city to any other city using the roads.\n- Each pair of cities is directly connected by at most one road. In other words, for all $0 \\leq j < k \\leq M - 1$, $(X_j, Y_j) \\neq (X_k, Y_k)$ and $(Y_j, X_j) \\neq (X_k, Y_k)$.\n- For each $0 \\leq i \\leq Q - 1$\n    - $0 \\leq L_i \\leq S_i \\leq N - 1$\n    - $0 \\leq E_i \\leq R_i \\leq N - 1$\n    - $S_i \\neq E_i$\n    - $L_i \\leq R_i$\n\n**Subtasks**\n\n- 1. (7 points) $N \\leq 100$, $M \\leq 200$, $Q \\leq 100$.\n- 2. (8 points) $N \\leq 3, 000$, $M \\leq 6, 000$, $Q \\leq 3, 000$.\n- 3. (34 points) $M = N - 1$ and each city is connected to at most two roads (all cities form a single line).\n- 4. (51 points) No additional constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2018] werewolf 狼人", "background": "本题为交互题，但在此请提交**完整程序**。", "description": "在日本的茨城县内共有 $N$ 个城市和 $M$ 条道路。这些城市是根据人口数量的升序排列的，依次编号为 $0$ 到 $N - 1$。每条道路连接两个不同的城市，并且可以双向通行。由这些道路，你能从任意一个城市到另外任意一个城市。\n\n你计划了 $Q$ 个行程，这些行程分别编号为 $0$ 至 $Q - 1$。第 $i(0 \\leq i \\leq Q - 1)$ 个行程是从城市 $S_i$ 到城市 $E_i$。\n\n你是一个狼人。你有两种形态：**人形**和**狼形**。在每个行程开始的时候，你是人形。在每个行程结束的时候，你必须是狼形。在行程中，你必须要变身（从人形变成狼形）恰好一次，而且只能在某个城市内（包括可能是在 $S_i$ 或 $E_i$ 内）变身。\n\n狼人的生活并不容易。当你是人形时，你必须避开人少的城市，而当你是狼形时，你必须避开人多的城市。对于每一次行程 $i(0 \\leq i \\leq Q - 1)$，都有两个阈值 $L_i$ 和 $R_i(0 \\leq L_i \\leq R_i \\leq N - 1)$，用以表示哪些城市必须要避开。准确地说，当你是人形时，你必须避开城市 $0, 1, \\ldots , L_i - 1$ ；而当你是狼形时，则必须避开城市 $R_i + 1, R_i + 2, \\ldots , N - 1$。这就是说，在行程 $i$ 中，你必须在城市 $L_i, L_i + 1, \\ldots , R_i$ 中的其中一个城市内变身。\n\n你的任务是，对每一次行程，判定是否有可能在满足上述限制的前提下，由城市 $S_i$ 走到城市 $E_i$。你的路线可以有任意长度。", "inputFormat": "输入的第一行包含三个正整数 $N, M, Q$，其意义见题目描述。\n\n接下来 $M$ 行，每行包含两个非负整数。在这 $M$ 行中，第 $j$ 行的两个非负整数分别表示 $X_{j - 1}, Y_{j - 1}$，即编号为 $j - 1$ 的道路连接的两个城市的编号。\n\n接下来 $Q$ 行，每行包含四个非负整数。在这 $Q$ 行中，第 $i$ 行的四个非负整数分别表示 $S_{i - 1}, E_{i - 1}, L_{i - 1}, R_{i - 1}$，即编号为 $i - 1$ 的行程的起点城市编号、终点城市编号以及两个阈值。", "outputFormat": "输出包含 $Q$ 行，每行包含一个非 $0$ 即 $1$ 的整数。第 $i$ 行的整数表示对于编号为 $i - 1$ 的行程，是否能从城市 $S_{i - 1}$ 走至城市 $E_{i - 1}$，若能够，那么输出整数为 $1$；若不能，那么输出整数为 $0$。", "hint": "**限制条件**\n\n- $2 \\leq N \\leq 200, 000$\n- $N - 1 \\leq M \\leq 400, 000$\n- $1 \\leq Q \\leq 200, 000$\n- 对于每个 $0 \\leq j \\leq M - 1$\n    - $0 \\leq X_j \\leq N - 1$\n    - $0 \\leq Y_j \\leq N - 1$\n    - $X_j \\neq Y_j$\n- 你可以通过道路由任意一个城市去另外任意一个城市。\n- 每一对城市最多只由一条道路直接连起来。换言之，对于所有 $0 \\leq j < k \\leq M - 1$，都有 $(X_j, Y_j) \\neq (X_k, Y_k)$ 和 $(Y_j, X_j) \\neq (X_k, Y_k)$\n- 对于每个 $0 \\leq i \\leq Q - 1$\n    - $0 \\leq L_i \\leq S_i \\leq N - 1$\n    - $0 \\leq E_i \\leq R_i \\leq N - 1$\n    - $S_i \\neq E_i$\n    - $L_i \\leq R_i$\n\n**子任务**\n\n- 1.（7 分）$N \\leq 100$，$M \\leq 200$，$Q \\leq 100$。\n- 2.（8 分）$N \\leq 3, 000$，$M \\leq 6, 000$，$Q \\leq 3, 000$。\n- 3.（34 分）$M = N - 1$ 且每个城市最多与两条路相连（所有城市是以一条直线的形式连起来）。\n- 4.（51 分）没有附加限制。", "locale": "zh-CN"}}}
{"pid": "P4900", "type": "P", "difficulty": 6, "samples": [["1\n1 3\n", "499122177\n"]], "limits": {"time": [404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404, 404], "memory": [40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404]}, "tags": ["O2优化", "素数判断,质数,筛法", "前缀和", "逆元"], "title": "食堂", "background": "我 CYJian 就是死，死外边，从这跳下去，也不会吃食堂一口饭。\n\n$$\\color{white}\\text{真香。。}$$", "description": "食堂第 $i$ 天有 $i$ 道菜。CYJian 觉得第 $i$ 天的第 $j$ 道菜的美味程度为 $\\left\\{\\dfrac{i}{j}\\right\\}$（$\\{\\}$ 就是取小数部分），当然，CYJian 是一个勇于尝试的人，所以每一道菜都会吃那么一点。\n\n现在 CYJian 有 $T$ 个问题，每一个问题都是从第 $A _ i$ 天到第 $B _ i$ 天得到的美味值的总和。现在请你帮他算一算吧！请输出答案模 $998244353$ 的值。", "inputFormat": "第一行一个数 $T$。\n\n接下来 $T$ 行，每一行一共两个数，表示每一次询问的 $A$ 和 $B$。", "outputFormat": "$T$ 行，每行一个正整数表示美味值之和。\n\n如果答案可以表示成 $\\dfrac{P}{Q}$ 的形式，则需要找到任意一个 $x$ 使得 $Q \\times x \\equiv P \\pmod{998244353}$，并且输出 $x \\bmod 998244353$。", "hint": "### 样例解释\n\n第一天美味值为 $0.00$，第二天美味值为 $0.00+0.00=0.00$，第三天美味值为 $0.00+0.50+0.00=0.50$，$0.00+0.00+0.50=0.50=\\dfrac{1}{2}$，$499122177 \\times 2 \\equiv 1 \\pmod{998244353}$，所以答案为 $499122177$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| 数据点范围 | $T =$ | $A \\le B \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 5$ | $1$ | $5000$ |\n| $6 \\sim 10$ | $1$ | $10^6$ |\n| $10 \\sim 15$ | $10^6$ | $5000$ |\n| $16 \\sim 20$ | $10^6$ | $10^6$ |", "locale": "zh-CN", "translations": {"en": {"title": "Cafeteria.", "background": "Even if I, CYJian, were to die, die outside, or jump off from here, I would still not eat a single bite of cafeteria food.\n\n$$\\color{white}\\text{So tasty..}$$", "description": "On day $i$, the cafeteria has $i$ dishes. CYJian thinks the tastiness of the $j$-th dish on day $i$ is $\\left\\{\\dfrac{i}{j}\\right\\}$ (where $\\{\\}$ means taking the fractional part). Of course, CYJian is someone who likes to try things, so he will eat a little of every dish.\n\nNow CYJian has $T$ queries. Each query asks for the total tastiness gained from day $A _ i$ to day $B _ i$. Please help him compute it. Output the answer modulo $998244353$.", "inputFormat": "The first line contains an integer $T$.\n\nThe next $T$ lines each contain two integers, representing $A$ and $B$ for each query.", "outputFormat": "Output $T$ lines, each containing a positive integer representing the sum of tastiness.\n\nIf the answer can be written as $\\dfrac{P}{Q}$, then you need to find any $x$ such that $Q \\times x \\equiv P \\pmod{998244353}$, and output $x \\bmod 998244353$.", "hint": "### Sample Explanation\n\nOn day 1 the tastiness is $0.00$. On day 2 the tastiness is $0.00+0.00=0.00$. On day 3 the tastiness is $0.00+0.50+0.00=0.50$. Thus $0.00+0.00+0.50=0.50=\\dfrac{1}{2}$. Since $499122177 \\times 2 \\equiv 1 \\pmod{998244353}$, the answer is $499122177$.\n\n### Constraints\n\n**This problem uses bundled testdata.**\n\n| Subtask Range | $T =$ | $A \\le B \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 5$ | $1$ | $5000$ |\n| $6 \\sim 10$ | $1$ | $10^6$ |\n| $10 \\sim 15$ | $10^6$ | $5000$ |\n| $16 \\sim 20$ | $10^6$ | $10^6$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "食堂", "background": "我 CYJian 就是死，死外边，从这跳下去，也不会吃食堂一口饭。\n\n$$\\color{white}\\text{真香。。}$$", "description": "食堂第 $i$ 天有 $i$ 道菜。CYJian 觉得第 $i$ 天的第 $j$ 道菜的美味程度为 $\\left\\{\\dfrac{i}{j}\\right\\}$（$\\{\\}$ 就是取小数部分），当然，CYJian 是一个勇于尝试的人，所以每一道菜都会吃那么一点。\n\n现在 CYJian 有 $T$ 个问题，每一个问题都是从第 $A _ i$ 天到第 $B _ i$ 天得到的美味值的总和。现在请你帮他算一算吧！请输出答案模 $998244353$ 的值。", "inputFormat": "第一行一个数 $T$。\n\n接下来 $T$ 行，每一行一共两个数，表示每一次询问的 $A$ 和 $B$。", "outputFormat": "$T$ 行，每行一个正整数表示美味值之和。\n\n如果答案可以表示成 $\\dfrac{P}{Q}$ 的形式，则需要找到任意一个 $x$ 使得 $Q \\times x \\equiv P \\pmod{998244353}$，并且输出 $x \\bmod 998244353$。", "hint": "### 样例解释\n\n第一天美味值为 $0.00$，第二天美味值为 $0.00+0.00=0.00$，第三天美味值为 $0.00+0.50+0.00=0.50$，$0.00+0.00+0.50=0.50=\\dfrac{1}{2}$，$499122177 \\times 2 \\equiv 1 \\pmod{998244353}$，所以答案为 $499122177$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| 数据点范围 | $T =$ | $A \\le B \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 5$ | $1$ | $5000$ |\n| $6 \\sim 10$ | $1$ | $10^6$ |\n| $10 \\sim 15$ | $10^6$ | $5000$ |\n| $16 \\sim 20$ | $10^6$ | $10^6$ |", "locale": "zh-CN"}}}
{"pid": "P4901", "type": "P", "difficulty": 6, "samples": [["3\n10 2\n12 2\n1 2\n", "7\n7\n-1\n"]], "limits": {"time": [666, 666, 666, 666, 666, 666, 666, 666, 666, 666], "memory": [40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404, 40404]}, "tags": ["树状数组", "O2优化", "前缀和", "Fibonacci 数列"], "title": "排队", "background": "CYJian 班的这个队形……是梯形么？？\n\n$\\color{white}\\text{信息竞赛班的女生能有多少??}$", "description": "教官觉得 CYJian 班上的队形~~不是很美观~~很不美观，所以教官决定要重排一下队形。\n\n教官先让所有同学按照学号排好序站成一列，然后每一次把当前队列第 $1, 2, 3, 5, 8, 13, \\cdots$（差不多就是斐波那契数列了）个人拉出来，直到没有人能拉出来为止，然后这些人组成一行，排到上一行的后面。\n\n举个栗子，如果一共有 $10$ 个人，大概就是这样子的（加粗表示当前选到的人）：\n\n1. $\\bm{\\color{red}1}\\ \\bm{\\color{red}2}\\ \\bm{\\color{red}3}\\ 4 \\ \\bm{\\color{red}5} \\ 6 \\ 7 \\ \\bm{\\color{red}8} \\ 9\\ 10$，取走后：$4\\ 6\\ 7\\ 9\\ 10$；\n2. $\\bm{\\color{red}4}\\ \\bm{\\color{red}6}\\  \\bm{\\color{red}7}\\ 9\\ \\bm{\\color{red}10}$，取走后：$9$；\n3. $\\bm{\\color{red}9}$。\n\n最后的队形长这样:\n\n- 第一行：$1\\ 2\\ 3\\ 5\\ 8$；\n- 第二行：$4\\ 6\\ 7\\ 10$；\n- 第三行：$9$。\n\n（教官排的队形当然得说好看了……）\n\n我们现在定义一行的美观度为这一行所有人学号的乘积能分解的质因子的个数（特别的，$1$ 分解质因子不能得到任何质因子，所以个数为 $0$）。\n\n比如第二行，$4 \\times 6 \\times 7 \\times 10=1680=2 \\times 2 \\times 2 \\times 2 \\times 3 \\times 5 \\times 7$，所以该行美观度为 $7$。\n\n年级一共有 $T$ 个班级，每一个班级都要排一次队形。现在给出第 $i$ 个班级人数 $N_i$ 和一个正整数 $K_i$，需要你求出第 $i$ 个班级排队形后第 $K_i$ 行的队伍的美观度。\n\n特别的，如果排的队形中没有第 $K_i$ 行则输出 $-1$。", "inputFormat": "第一行一个正整数 $T$。\n\n接下来 $T$ 行每行两个正整数 $N_i$ 和 $K_i$。\n\n变量的意义详见题面描述。", "outputFormat": "$T$ 行，每行一个正整数表示所求的美观度。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（30pts）：$K_i = 1$，$1 \\le N_i, T \\le 1000$；\n- Subtask 2（30pts）：$1 \\le K_i \\le 100$，$1 \\le N_i \\le 10000$，$1 \\le T \\le 5000$；\n- Subtask 3（40pts）：$1 \\le K_i \\le 10000$，$1 \\le N_i \\le 5 \\times 10^6$，$1 \\le T \\le 10^6$。\n\n数据不保证存在全是 $-1$ 的测试点。", "locale": "zh-CN", "translations": {"en": {"title": "Queueing", "background": "The formation of Class CYJian... is it a trapezoid??\n\n$\\color{white}\\text{How many girls can there be in an informatics competition class??}$", "description": "The instructor thinks that Class CYJian’s formation is ~~not very good-looking~~ very bad-looking, so the instructor decides to rearrange it.\n\nFirst, the instructor asks all students to line up in increasing order of student ID in a single row. Then, each time, the instructor pulls out the $1, 2, 3, 5, 8, 13, \\cdots$-th people (roughly the Fibonacci sequence) from the current queue, until no one can be pulled out. These selected people form a new row, which is placed behind the previous row.\n\nFor example, if there are $10$ students, it goes like this (bold means the currently selected person):\n\n1. $\\bm{\\color{red}1}\\ \\bm{\\color{red}2}\\ \\bm{\\color{red}3}\\ 4 \\ \\bm{\\color{red}5} \\ 6 \\ 7 \\ \\bm{\\color{red}8} \\ 9\\ 10$, after taking them away: $4\\ 6\\ 7\\ 9\\ 10$;\n2. $\\bm{\\color{red}4}\\ \\bm{\\color{red}6}\\  \\bm{\\color{red}7}\\ 9\\ \\bm{\\color{red}10}$, after taking them away: $9$;\n3. $\\bm{\\color{red}9}$.\n\nThe final formation looks like this:\n\n- Row 1: $1\\ 2\\ 3\\ 5\\ 8$;\n- Row 2: $4\\ 6\\ 7\\ 10$;\n- Row 3: $9$.\n\n(Of course, a formation arranged by the instructor has to be said to look good...)\n\nNow we define the “beauty” of a row as the number of prime factors in the prime factorization of the product of all student IDs in that row. In particular, since $1$ cannot be decomposed into any prime factors, its count is $0$.\n\nFor example, for the second row, $4 \\times 6 \\times 7 \\times 10=1680=2 \\times 2 \\times 2 \\times 2 \\times 3 \\times 5 \\times 7$, so the beauty of this row is $7$.\n\nThere are $T$ classes in the grade, and each class must be arranged once. For the $i$-th class, you are given the number of students $N_i$ and a positive integer $K_i$. You need to find the beauty of the $K_i$-th row after arranging the formation for the $i$-th class.\n\nIn particular, if the formation does not have a $K_i$-th row, output $-1$.", "inputFormat": "The first line contains a positive integer $T$.\n\nThe next $T$ lines each contain two positive integers $N_i$ and $K_i$.\n\nThe meanings of the variables are described in the statement.", "outputFormat": "Output $T$ lines, each containing one positive integer, representing the required beauty.", "hint": "**This problem uses bundled testdata.**\n\n- Subtask 1 (30pts): $K_i = 1$, $1 \\le N_i, T \\le 1000$;\n- Subtask 2 (30pts): $1 \\le K_i \\le 100$, $1 \\le N_i \\le 10000$, $1 \\le T \\le 5000$;\n- Subtask 3 (40pts): $1 \\le K_i \\le 10000$, $1 \\le N_i \\le 5 \\times 10^6$, $1 \\le T \\le 10^6$.\n\nThe testdata does not guarantee the existence of a test point where all outputs are $-1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "排队", "background": "CYJian 班的这个队形……是梯形么？？\n\n$\\color{white}\\text{信息竞赛班的女生能有多少??}$", "description": "教官觉得 CYJian 班上的队形~~不是很美观~~很不美观，所以教官决定要重排一下队形。\n\n教官先让所有同学按照学号排好序站成一列，然后每一次把当前队列第 $1, 2, 3, 5, 8, 13, \\cdots$（差不多就是斐波那契数列了）个人拉出来，直到没有人能拉出来为止，然后这些人组成一行，排到上一行的后面。\n\n举个栗子，如果一共有 $10$ 个人，大概就是这样子的（加粗表示当前选到的人）：\n\n1. $\\bm{\\color{red}1}\\ \\bm{\\color{red}2}\\ \\bm{\\color{red}3}\\ 4 \\ \\bm{\\color{red}5} \\ 6 \\ 7 \\ \\bm{\\color{red}8} \\ 9\\ 10$，取走后：$4\\ 6\\ 7\\ 9\\ 10$；\n2. $\\bm{\\color{red}4}\\ \\bm{\\color{red}6}\\  \\bm{\\color{red}7}\\ 9\\ \\bm{\\color{red}10}$，取走后：$9$；\n3. $\\bm{\\color{red}9}$。\n\n最后的队形长这样:\n\n- 第一行：$1\\ 2\\ 3\\ 5\\ 8$；\n- 第二行：$4\\ 6\\ 7\\ 10$；\n- 第三行：$9$。\n\n（教官排的队形当然得说好看了……）\n\n我们现在定义一行的美观度为这一行所有人学号的乘积能分解的质因子的个数（特别的，$1$ 分解质因子不能得到任何质因子，所以个数为 $0$）。\n\n比如第二行，$4 \\times 6 \\times 7 \\times 10=1680=2 \\times 2 \\times 2 \\times 2 \\times 3 \\times 5 \\times 7$，所以该行美观度为 $7$。\n\n年级一共有 $T$ 个班级，每一个班级都要排一次队形。现在给出第 $i$ 个班级人数 $N_i$ 和一个正整数 $K_i$，需要你求出第 $i$ 个班级排队形后第 $K_i$ 行的队伍的美观度。\n\n特别的，如果排的队形中没有第 $K_i$ 行则输出 $-1$。", "inputFormat": "第一行一个正整数 $T$。\n\n接下来 $T$ 行每行两个正整数 $N_i$ 和 $K_i$。\n\n变量的意义详见题面描述。", "outputFormat": "$T$ 行，每行一个正整数表示所求的美观度。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（30pts）：$K_i = 1$，$1 \\le N_i, T \\le 1000$；\n- Subtask 2（30pts）：$1 \\le K_i \\le 100$，$1 \\le N_i \\le 10000$，$1 \\le T \\le 5000$；\n- Subtask 3（40pts）：$1 \\le K_i \\le 10000$，$1 \\le N_i \\le 5 \\times 10^6$，$1 \\le T \\le 10^6$。\n\n数据不保证存在全是 $-1$ 的测试点。", "locale": "zh-CN"}}}
{"pid": "P4902", "type": "P", "difficulty": 6, "samples": [["1\n1 3\n", "162\n"]], "limits": {"time": [888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888], "memory": [66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666, 66666]}, "tags": ["O2优化", "前缀和", "逆元", "差分"], "title": "乘积", "background": "CYJian 在经过多次加强后的题目。", "description": "给出 $A, B$，求下面的式子的值。\n\n$$\\prod_{i=A}^{B}\\prod_{j=1}^{i}\\left(\\frac{i}{j}\\right)^{\\left\\lfloor \\frac{i}{j} \\right\\rfloor}\\bmod 19260817$$\n\n包含 $T$ 组询问。\n\n------\n\n听说有许多人看不懂公式？\n\n好吧，这里给出伪代码：\n\n```\nfor i = A to B\n  for j = 1 to i\n    res = res * power(i / j, floor(i / j))\nres = solve(res)\n```\n\n最后的 `solve` 表示处理成分数取模的形式。\n\n不保证这样精度不会原地起爆。", "inputFormat": "第一行一个正整数 $T$。\n\n接下来 $T$ 行，每行两个正整数表示这一组询问的 $A, B$。", "outputFormat": "$T$ 行，每行一个正整数表示这一组询问的答案。", "hint": "样例解释: $1 \\times 4 \\times 1 \\times 27 \\times \\frac{3}{2} \\times 1 \\equiv 162 \\pmod{19260817}$。\n\n**本题采用捆绑测试。**\n\n| 数据点范围 | $T =$ | $A \\le B \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 5$ | $1$ | $5000$  |\n| $6 \\sim 10$ | $1$ | $10^6$  |\n| $11 \\sim 15$ | $10^6$ | $5000$  |\n| $16 \\sim 20$ | $10^6$ | $10^6$  |", "locale": "zh-CN", "translations": {"en": {"title": "Product", "background": "A problem by CYJian after multiple rounds of strengthening.", "description": "Given $A, B$, find the value of the following expression:\n\n$$\\prod_{i=A}^{B}\\prod_{j=1}^{i}\\left(\\frac{i}{j}\\right)^{\\left\\lfloor \\frac{i}{j} \\right\\rfloor}\\bmod 19260817$$\n\nThere are $T$ queries.\n\n------\n\nIt is said that many people cannot understand the formula.\n\nAlright, here is the pseudocode:\n\n```\nfor i = A to B\n  for j = 1 to i\n    res = res * power(i / j, floor(i / j))\nres = solve(res)\n```\n\nThe final `solve` means converting it into the form of a fraction modulo.\n\nIt is not guaranteed that the precision will not blow up on the spot.", "inputFormat": "The first line contains a positive integer $T$.\n\nThe next $T$ lines each contain two positive integers, representing $A, B$ for this query.", "outputFormat": "Output $T$ lines. Each line contains one positive integer, the answer for that query.", "hint": "Sample explanation: $1 \\times 4 \\times 1 \\times 27 \\times \\frac{3}{2} \\times 1 \\equiv 162 \\pmod{19260817}$.\n\n**This problem uses bundled tests.**\n\n| Constraints | $T =$ | $A \\le B \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 5$ | $1$ | $5000$  |\n| $6 \\sim 10$ | $1$ | $10^6$  |\n| $11 \\sim 15$ | $10^6$ | $5000$  |\n| $16 \\sim 20$ | $10^6$ | $10^6$  |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "乘积", "background": "CYJian 在经过多次加强后的题目。", "description": "给出 $A, B$，求下面的式子的值。\n\n$$\\prod_{i=A}^{B}\\prod_{j=1}^{i}\\left(\\frac{i}{j}\\right)^{\\left\\lfloor \\frac{i}{j} \\right\\rfloor}\\bmod 19260817$$\n\n包含 $T$ 组询问。\n\n------\n\n听说有许多人看不懂公式？\n\n好吧，这里给出伪代码：\n\n```\nfor i = A to B\n  for j = 1 to i\n    res = res * power(i / j, floor(i / j))\nres = solve(res)\n```\n\n最后的 `solve` 表示处理成分数取模的形式。\n\n不保证这样精度不会原地起爆。", "inputFormat": "第一行一个正整数 $T$。\n\n接下来 $T$ 行，每行两个正整数表示这一组询问的 $A, B$。", "outputFormat": "$T$ 行，每行一个正整数表示这一组询问的答案。", "hint": "样例解释: $1 \\times 4 \\times 1 \\times 27 \\times \\frac{3}{2} \\times 1 \\equiv 162 \\pmod{19260817}$。\n\n**本题采用捆绑测试。**\n\n| 数据点范围 | $T =$ | $A \\le B \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 5$ | $1$ | $5000$  |\n| $6 \\sim 10$ | $1$ | $10^6$  |\n| $11 \\sim 15$ | $10^6$ | $5000$  |\n| $16 \\sim 20$ | $10^6$ | $10^6$  |", "locale": "zh-CN"}}}
{"pid": "P4903", "type": "P", "difficulty": 3, "samples": [["2", "3"], ["3", "5"], ["4", "9"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "心碎", "background": "NOIP2015初赛。CYD大神在他的母校跪掉了。初赛那天，他回到原来的教室参观了一下，发现那张遍布了N个洞的课桌还摆在那里——那是他初中时和XHY同学坐过的桌子。这时，CYD大神的心都碎了。\n", "description": "CYD大神的心可以看做一个环，内外都顺时针均匀分布了N个一一正对应的点。当他看到第i个洞时，就会想起第Ai件往事，这会在CYD大神的心上外侧第i个点和内侧第Ai个点间留下一道伤痕(i<Ai时为顺时针，i>Ai时逆时针，i=Ai时正对应)。\n\nCYD大神觉得，他的心一定不会再碎了，所以，他想让你帮他写一个程序，确定一个Ai的排列，使得他的心碎的块数最多。\n", "inputFormat": "第一行，一个正整数N。\n", "outputFormat": "仅一行，一个正整数表示CYD大神的心最多碎成多少块。\n", "hint": "对于40%数据，前i\\*10%,N<=i\\*5。\n\n对于50%数据，N<=50。\n\n对于70%数据，N<=233。\n\n对于100%数据，N<=2333。\n\n/\\*P.S.样例解释\\*/\n\n样例1:1->2,2->1\n\n样例2:1->2,2->3,3->1,注意：若1->3,2->2,3->1，则三线共点。\n\n样例3:1->3,2->4,3->2,4->1\n", "locale": "zh-CN", "translations": {"en": {"title": "Heartbreak", "background": "NOIP 2015 preliminary round. CYD dashi (大神) failed miserably at his alma mater. On that day, he went back to visit his old classroom and found that the desk riddled with $N$ holes was still there — it was the desk he used to share with classmate XHY in middle school. At that moment, CYD’s heart shattered.", "description": "CYD’s heart can be seen as an annulus. On both the outer and inner circle, there are $N$ points placed evenly in the clockwise direction, and the points are paired one-to-one by their angles. When he sees the $i$-th hole, he recalls the $A_i$-th memory, which leaves a scar between the $i$-th point on the outer circle and the $A_i$-th point on the inner circle. The scar is drawn clockwise if $i < A_i$, counterclockwise if $i > A_i$, and straight through (radially aligned) if $i = A_i$.\n\nCYD believes his heart can no longer be broken, so he asks you to write a program to determine a permutation $A$ of $\\{1, 2, \\dots, N\\}$ that maximizes the number of pieces his heart shatters into.", "inputFormat": "The first line contains a positive integer $N$.", "outputFormat": "Output a single positive integer — the maximum number of pieces CYD’s heart can be shattered into.", "hint": "Constraints:\n- For 50% of the testdata, $N \\le 50$.\n- For 70% of the testdata, $N \\le 233$.\n- For 100% of the testdata, $N \\le 2333$.\n\n/* P.S. Sample explanations */\n\nSample 1: 1->2, 2->1.\n\nSample 2: 1->2, 2->3, 3->1. Note: if 1->3, 2->2, 3->1, then the three lines are concurrent.\n\nSample 3: 1->3, 2->4, 3->2, 4->1.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "心碎", "background": "NOIP2015初赛。CYD大神在他的母校跪掉了。初赛那天，他回到原来的教室参观了一下，发现那张遍布了N个洞的课桌还摆在那里——那是他初中时和XHY同学坐过的桌子。这时，CYD大神的心都碎了。\n", "description": "CYD大神的心可以看做一个环，内外都顺时针均匀分布了N个一一正对应的点。当他看到第i个洞时，就会想起第Ai件往事，这会在CYD大神的心上外侧第i个点和内侧第Ai个点间留下一道伤痕(i<Ai时为顺时针，i>Ai时逆时针，i=Ai时正对应)。\n\nCYD大神觉得，他的心一定不会再碎了，所以，他想让你帮他写一个程序，确定一个Ai的排列，使得他的心碎的块数最多。\n", "inputFormat": "第一行，一个正整数N。\n", "outputFormat": "仅一行，一个正整数表示CYD大神的心最多碎成多少块。\n", "hint": "对于40%数据，前i\\*10%,N<=i\\*5。\n\n对于50%数据，N<=50。\n\n对于70%数据，N<=233。\n\n对于100%数据，N<=2333。\n\n/\\*P.S.样例解释\\*/\n\n样例1:1->2,2->1\n\n样例2:1->2,2->3,3->1,注意：若1->3,2->2,3->1，则三线共点。\n\n样例3:1->3,2->4,3->2,4->1\n", "locale": "zh-CN"}}}
{"pid": "P4904", "type": "P", "difficulty": 2, "samples": [["6", "0"], ["7", "3"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数论"], "title": "排版", "background": "某兄弟学校就是这么良(sang)心(xin)温(bing)暖(kuang)，国庆节作业写了满满一黑板，连信息技术都有作业！更过分的是，作业就是做一个“国庆旅游计划”PPT。（老师，您能再假一点吗）\n", "description": "然而，XHY同学并不会做PPT，于是她找到了CYD大神求助。她想把N张4\\*3的照片不重叠，无缝隙地拼成一个矩形作为背景图片。为了美观，她希望背景图片的长与宽尽可能接近，并且在长宽均相等的情况下，使得旋转的照片张数尽可能少。（4\\*3的不算旋转，3\\*4的算作旋转，且照片只能有这两种尺寸）。\n\n请你帮CYD大神写一个程序，帮XHY同学设计一种满足她要求的照片排列方式，使得旋转的照片张数最少。\n", "inputFormat": "第一行，一个正整数N。\n", "outputFormat": "仅一行，一个非负整数表示最少的旋转照片张数。\n", "hint": "对于20%数据，N<=10。\n\n对于30%数据，N<=20。\n\n对于50%数据，N<=50。\n\n对于70%数据，N<=233。\n\n对于100%数据，N<=900。\n", "locale": "zh-CN", "translations": {"en": {"title": "Layout", "background": "At a certain sister school, the teachers are so “considerate” and “warm‑hearted” that they assigned a whole blackboard of homework over National Day — even Information Technology has homework. Even worse, the assignment is to make a “National Day Travel Plan” PowerPoint. (Teacher, could you be any more fake?)", "description": "However, student XHY does not know how to make a PowerPoint, so she asked the expert CYD for help. She wants to tile $N$ photos of size $4\\times 3$ without overlap and without gaps into a single rectangle to use as a background image. For aesthetics, she wants the rectangle’s width and height to be as close as possible (i.e., minimize their absolute difference). Among all arrangements that achieve this minimum difference, the number of rotated photos should be as small as possible. Photos may only be $4\\times 3$ (not counted as rotated) or $3\\times 4$ (counted as rotated).\n\nPlease help CYD write a program to design such an arrangement for XHY that meets these requirements and uses the fewest rotated photos.", "inputFormat": "The first line contains a positive integer $N$.", "outputFormat": "Output a single non‑negative integer — the minimal number of rotated photos.", "hint": "- For 20% of the testdata, $N \\le 10$.\n- For 30% of the testdata, $N \\le 20$.\n- For 50% of the testdata, $N \\le 50$.\n- For 70% of the testdata, $N \\le 233$.\n- For 100% of the testdata, $N \\le 900$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "排版", "background": "某兄弟学校就是这么良(sang)心(xin)温(bing)暖(kuang)，国庆节作业写了满满一黑板，连信息技术都有作业！更过分的是，作业就是做一个“国庆旅游计划”PPT。（老师，您能再假一点吗）\n", "description": "然而，XHY同学并不会做PPT，于是她找到了CYD大神求助。她想把N张4\\*3的照片不重叠，无缝隙地拼成一个矩形作为背景图片。为了美观，她希望背景图片的长与宽尽可能接近，并且在长宽均相等的情况下，使得旋转的照片张数尽可能少。（4\\*3的不算旋转，3\\*4的算作旋转，且照片只能有这两种尺寸）。\n\n请你帮CYD大神写一个程序，帮XHY同学设计一种满足她要求的照片排列方式，使得旋转的照片张数最少。\n", "inputFormat": "第一行，一个正整数N。\n", "outputFormat": "仅一行，一个非负整数表示最少的旋转照片张数。\n", "hint": "对于20%数据，N<=10。\n\n对于30%数据，N<=20。\n\n对于50%数据，N<=50。\n\n对于70%数据，N<=233。\n\n对于100%数据，N<=900。\n", "locale": "zh-CN"}}}
{"pid": "P4905", "type": "P", "difficulty": 5, "samples": [["4\n", "5\n"], ["5\n", "6\n"], ["6\n", "11\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "报纸", "background": "终于熬过了初中三年，《学英语报》却阴魂不散。当高一的第一张《学英语报》飘到我面前时，CYD 大神心里充满了绝望，然而，他还有一线希望——XHY 同学总是做得比他快。", "description": "作为做 PPT 的回报，XHY 同学决定送点“温暖”给 CYD 大神——一份英语报纸的答案。这份报纸是一个 $N \\times N$ 的方阵，其中某些格子写有答案。答案的分布似乎很有规律：对于格子 $(x,y)$，当且仅当 $x$ 和 $y$ 不互质时，这个格子上有答案。\n\nXHY 同学的手机每次能拍下一个 $1 \\times 2$ 的区域（横竖均可）。请你帮她写一个程序，求出至少要拍多少张照片，才能把所有的答案发给 CYD 大神。", "inputFormat": "仅一行，一个正整数 $N$。", "outputFormat": "仅一行，一个非负整数表示至少要拍的照片张数。", "hint": "对于 $30 \\%$ 数据，$N \\le 10$。  \n对于 $60 \\%$ 数据，$N \\le 50$。  \n对于 $100 \\%$ 数据，$1 \\le N \\le 233$。", "locale": "zh-CN", "translations": {"en": {"title": "Newspaper", "background": "After finally making it through three years of middle school, the “Learn English Newspaper” still lingers. When the first issue of the Grade 10 “Learn English Newspaper” floated onto his desk, CYD dashen felt despair; however, there was still a glimmer of hope—classmate XHY always finishes faster.", "description": "As a return for making the PPT, classmate XHY decides to send some “warmth” to CYD dashen—a set of answers to an English newspaper. This newspaper is an $N \\times N$ grid, where some cells contain answers. The distribution seems regular: for cell $(x, y)$, it contains an answer if and only if $x$ and $y$ are not coprime.\n\nXHY’s phone can capture one $1 \\times 2$ region per photo (either horizontal or vertical). Please write a program to find the minimum number of photos required to capture all the answers and send them to CYD dashen.", "inputFormat": "One line, a positive integer $N$.", "outputFormat": "One line, a non-negative integer representing the minimum number of photos required.", "hint": "Constraints:\n- For 30% of the testdata, $N \\le 10$.\n- For 60% of the testdata, $N \\le 50$.\n- For 100% of the testdata, $1 \\le N \\le 233$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "报纸", "background": "终于熬过了初中三年，《学英语报》却阴魂不散。当高一的第一张《学英语报》飘到我面前时，CYD 大神心里充满了绝望，然而，他还有一线希望——XHY 同学总是做得比他快。", "description": "作为做 PPT 的回报，XHY 同学决定送点“温暖”给 CYD 大神——一份英语报纸的答案。这份报纸是一个 $N \\times N$ 的方阵，其中某些格子写有答案。答案的分布似乎很有规律：对于格子 $(x,y)$，当且仅当 $x$ 和 $y$ 不互质时，这个格子上有答案。\n\nXHY 同学的手机每次能拍下一个 $1 \\times 2$ 的区域（横竖均可）。请你帮她写一个程序，求出至少要拍多少张照片，才能把所有的答案发给 CYD 大神。", "inputFormat": "仅一行，一个正整数 $N$。", "outputFormat": "仅一行，一个非负整数表示至少要拍的照片张数。", "hint": "对于 $30 \\%$ 数据，$N \\le 10$。  \n对于 $60 \\%$ 数据，$N \\le 50$。  \n对于 $100 \\%$ 数据，$1 \\le N \\le 233$。", "locale": "zh-CN"}}}
{"pid": "P4906", "type": "P", "difficulty": 5, "samples": [["5\n4 2 3 4 5\n2 1 3\n2 1 4\n2 1 5\n1 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "进制", "状压 DP"], "title": "小奔关闹钟", "background": "由于今天是星期一，闹钟准时响了，由于小奔太困了，所以他想关停闹钟。", "description": "可是，他的闹钟电路太复杂了，有很多个开关，每个开关都连着其他开关，其他开关又连着更多的开关，当且仅当所有开关都关闭时，闹钟才会停止响铃，（初始时默认每个开关都开着的），他该如何是好呢？\n\n请你帮小奔求出最少开关次数，如果无论如何都不能关闭闹钟，请输出 `Change an alarm clock，please!`", "inputFormat": "共有 $N+1$ 行。\n\n第一行一个数 $N$（$1\\le N\\le 20$），表示有 $N$ 个开关，从第 $2$ 行起的第 $i$ 行表示第 $i$ 个闹钟开关。\n\n以后 $N$ 行，每行第一个数为 $M$（$0\\le M\\le N-1$），表示第 $i$ 个闹钟开关的直接关联开关个数。（由直接关联开关所关联的直接关联开关，自然就是第 $i$ 个闹钟间接关联开关啦，当打开第 $i$ 个开关时，只有直接关联，间接关联以及第 $i$ 个开关才会起作用），之后 $M$ 个数，表示第 $i$ 个闹钟直接关联开关的标号（如果 $M=0$ 则表示没有任何关联）。", "outputFormat": "一个数 $\\text{ans}$，表示最少按开关次数，如果无法关闭，输出 `Change an alarm clock，please!`。", "hint": "样例 $1$ 说明：\n\n\n先关闭 $5$，直接关联会关闭 $1$。$1$ 间接关闭 $2$、$3$、$4$，但会重新打开$5$。\n\n\n此时共关闭开关一次，已关闭 $1$，$2$，$3$，$4$。\n\n\n再打开 $2$，直接关联会打开 $1$ 和 $3$。$1$ 间接关闭 $2$、$3$、$5$，重新打开 $4$。$3$ 间接关闭 $1$、$4$。\n\n此时共关闭开关 $2$ 次，已关闭 $1$，$2$，$3$，$4$，$5$，彻底关闭闹钟。", "locale": "zh-CN", "translations": {"en": {"title": "Turn Off the Alarm Clock", "background": "Because today is Monday, the alarm rang on time. Since Xiao Ben was too sleepy, he wanted to turn off the alarm clock.", "description": "However, the alarm’s circuit is too complicated. There are many switches, and each switch is connected to other switches; those switches are connected to even more switches. Only when all switches are off will the alarm stop ringing (initially, every switch is on). What should he do?\n\nPlease help Xiao Ben find the minimum number of switch presses. If the alarm cannot be turned off no matter what, output `Change an alarm clock，please!`", "inputFormat": "There are $N+1$ lines in total.\n\nThe first line contains an integer $N$ ($1\\le N\\le 20$), meaning there are $N$ switches. From line $2$ onward, line $i$ describes switch $i$.\n\nIn the next $N$ lines, the first number in each line is $M$ ($0\\le M\\le N-1$), meaning the number of switches directly associated with switch $i$. (The switches directly associated with those directly associated switches are naturally the switches indirectly associated with switch $i$. When switch $i$ is pressed, only switch $i$, its directly associated switches, and its indirectly associated switches will take effect.) Then follow $M$ integers, which are the indices of the switches directly associated with switch $i$ (if $M=0$, it means there is no association).", "outputFormat": "Output an integer $\\text{ans}$, the minimum number of switch presses. If it is impossible to turn it off, output `Change an alarm clock，please!`.", "hint": "Explanation of Sample $1$:\n\nFirst press $5$. Its directly associated switch $1$ will be turned off. Switch $1$ indirectly turns off $2$, $3$, and $4$, but turns $5$ back on.\n\nAt this time, there has been $1$ press in total, and switches $1$, $2$, $3$, $4$ are off.\n\nThen press $2$. Its directly associated switches $1$ and $3$ will be turned on. Switch $1$ indirectly turns off $2$, $3$, and $5$, and turns $4$ back on. Switch $3$ indirectly turns off $1$ and $4$.\n\nAt this time, there have been $2$ presses in total, and switches $1$, $2$, $3$, $4$, $5$ are all off, so the alarm is completely turned off.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小奔关闹钟", "background": "由于今天是星期一，闹钟准时响了，由于小奔太困了，所以他想关停闹钟。", "description": "可是，他的闹钟电路太复杂了，有很多个开关，每个开关都连着其他开关，其他开关又连着更多的开关，当且仅当所有开关都关闭时，闹钟才会停止响铃，（初始时默认每个开关都开着的），他该如何是好呢？\n\n请你帮小奔求出最少开关次数，如果无论如何都不能关闭闹钟，请输出 `Change an alarm clock，please!`", "inputFormat": "共有 $N+1$ 行。\n\n第一行一个数 $N$（$1\\le N\\le 20$），表示有 $N$ 个开关，从第 $2$ 行起的第 $i$ 行表示第 $i$ 个闹钟开关。\n\n以后 $N$ 行，每行第一个数为 $M$（$0\\le M\\le N-1$），表示第 $i$ 个闹钟开关的直接关联开关个数。（由直接关联开关所关联的直接关联开关，自然就是第 $i$ 个闹钟间接关联开关啦，当打开第 $i$ 个开关时，只有直接关联，间接关联以及第 $i$ 个开关才会起作用），之后 $M$ 个数，表示第 $i$ 个闹钟直接关联开关的标号（如果 $M=0$ 则表示没有任何关联）。", "outputFormat": "一个数 $\\text{ans}$，表示最少按开关次数，如果无法关闭，输出 `Change an alarm clock，please!`。", "hint": "样例 $1$ 说明：\n\n\n先关闭 $5$，直接关联会关闭 $1$。$1$ 间接关闭 $2$、$3$、$4$，但会重新打开$5$。\n\n\n此时共关闭开关一次，已关闭 $1$，$2$，$3$，$4$。\n\n\n再打开 $2$，直接关联会打开 $1$ 和 $3$。$1$ 间接关闭 $2$、$3$、$5$，重新打开 $4$。$3$ 间接关闭 $1$、$4$。\n\n此时共关闭开关 $2$ 次，已关闭 $1$，$2$，$3$，$4$，$5$，彻底关闭闹钟。", "locale": "zh-CN"}}}
{"pid": "P4907", "type": "P", "difficulty": 3, "samples": [["10\n1 A\n1 2\n1 4\n2 3\n2 5\n2 6\n3 9\n3 10\n3 Q\n4 J", "Yes\n2"], ["10\n1 A\n1 2\n1 4\n2 3\n2 5\n2 6\n3 9\n3 10\n3 Q\n4 K", "Yes\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "剪枝"], "title": "A换B problem", "background": "仙女与小奔约定，想要拿到仙药，必须在牌技上赢了她。", "description": "他们要开始打牌了。但是，拥有强迫症的小奔看着手中的牌，很不愉快。原因是他理牌时按花色理（逗我），又希望一个花色的牌是连着的（$A-2-3-4-5-6-7-8-9-10-J-Q-K$）。\n\n忍无可忍的小奔开始与参与打牌的其他人换牌（作弊？？？），他希望换最少的牌来满足他的需求（假设所有牌都可以换）\n\n换牌规则：只能用点数相同的牌交换。\n\n众人：还能不能好好打牌了？！我们限你1s内换完，要不然就告诉仙女！", "inputFormat": "第一行，一个正整数 $N$，表示小奔有 $N$ 张牌。\n\n接下来的 $N$ 行，每行包含两个正整数，分别表示牌的花色和点数。", "outputFormat": "共有两行：\n\n第一行判断，如能完成，输出 `Yes`，否则输出 `No`；\n\n第二行输出最少换牌次数或最少需要牌数。", "hint": "样例1，可达成，将 $2$ $3$ 换为 $1$ $3$，$4$ $J$ 换为 $3$ $J$。\n\n样例2，可达成，将 $2$ $3$ 换成 $1$ $3$，$3$ $Q$ 换成 $4$ $Q$。\n（以上答案仅供参考，不保证没有多解,但输出必然唯一，~~别问我为什么~~）\n\n\n对于10%的数据：为样例 $2$。\n\n对于100%的数据：$ N \\leq 52 $，即保证数据在一副牌内。", "locale": "zh-CN", "translations": {"en": {"title": "A Swap B problem", "background": "The fairy and Xiao Ben made a deal: to get the magic medicine, he must beat her in a card game.", "description": "They are about to start playing cards. However, Xiao Ben, who has obsessive-compulsive tendencies, feels very unhappy when looking at the cards in his hand. The reason is that he sorts cards by suit (are you kidding me), and he also hopes that the cards of the same suit are consecutive ($A-2-3-4-5-6-7-8-9-10-J-Q-K$).\n\nHaving had enough, Xiao Ben starts swapping cards with the other players (cheating???). He wants to swap as few cards as possible to meet his requirement (assume any card can be swapped).\n\nSwap rule: you can only swap cards with the same rank.\n\nEveryone: Can you just play properly?! We give you 1 second to finish swapping, or we will tell the fairy!", "inputFormat": "The first line contains a positive integer $N$, meaning Xiao Ben has $N$ cards.\n\nThe next $N$ lines each contain two positive integers, representing the suit and the rank of a card.", "outputFormat": "There are two lines in total:\n\nThe first line is a judgment: if it can be completed, output `Yes`, otherwise output `No`.\n\nThe second line outputs the minimum number of swaps, or the minimum number of cards needed.", "hint": "Sample 1: achievable. Swap $2$ $3$ to $1$ $3$, and swap $4$ $J$ to $3$ $J$.\n\nSample 2: achievable. Swap $2$ $3$ to $1$ $3$, and swap $3$ $Q$ to $4$ $Q$.\n(The above answers are for reference only. There may be multiple solutions, but the output is definitely unique. ~~Do not ask me why~~.)\n\nFor $10\\%$ of the testdata: it is sample $2$.\n\nFor $100\\%$ of the testdata: $N \\leq 52$, meaning the data is guaranteed to be within one deck of cards.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "A换B problem", "background": "仙女与小奔约定，想要拿到仙药，必须在牌技上赢了她。", "description": "他们要开始打牌了。但是，拥有强迫症的小奔看着手中的牌，很不愉快。原因是他理牌时按花色理（逗我），又希望一个花色的牌是连着的（$A-2-3-4-5-6-7-8-9-10-J-Q-K$）。\n\n忍无可忍的小奔开始与参与打牌的其他人换牌（作弊？？？），他希望换最少的牌来满足他的需求（假设所有牌都可以换）\n\n换牌规则：只能用点数相同的牌交换。\n\n众人：还能不能好好打牌了？！我们限你1s内换完，要不然就告诉仙女！", "inputFormat": "第一行，一个正整数 $N$，表示小奔有 $N$ 张牌。\n\n接下来的 $N$ 行，每行包含两个正整数，分别表示牌的花色和点数。", "outputFormat": "共有两行：\n\n第一行判断，如能完成，输出 `Yes`，否则输出 `No`；\n\n第二行输出最少换牌次数或最少需要牌数。", "hint": "样例1，可达成，将 $2$ $3$ 换为 $1$ $3$，$4$ $J$ 换为 $3$ $J$。\n\n样例2，可达成，将 $2$ $3$ 换成 $1$ $3$，$3$ $Q$ 换成 $4$ $Q$。\n（以上答案仅供参考，不保证没有多解,但输出必然唯一，~~别问我为什么~~）\n\n\n对于10%的数据：为样例 $2$。\n\n对于100%的数据：$ N \\leq 52 $，即保证数据在一副牌内。", "locale": "zh-CN"}}}
{"pid": "P4908", "type": "P", "difficulty": 6, "samples": [["1*1+9-2*3/1", "-41.50"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "递归", "栈"], "title": "小奔上课", "background": "这一堂课是数学课！", "description": "小奔最喜欢数学了QvQ，但是因为晚上太困睡着了，所以当他反应过来要写题目时，黑板上的算式已经残缺不堪了。\n\n没办法，小奔只好依靠人品猜一下了，只是猜也是有方法的，小奔想请你给出最大可能值和最输出只有一行，为最大可能值和最小可能值的平均值，并保留两位小数小可能值的平均值。", "inputFormat": "只有一行，为残缺的算式（可能有括号），残缺部分用$*$表示~~（与乘号相同）~~，残缺部分可以为数字$0$到$9$，也可以是四则运算符号之一，不存在残缺括号。\n", "outputFormat": "输出只有一行，为最大可能值和最小可能值的平均值，并保留两位小数", "hint": "样例解释:\n\n最大值：$191+9-2+3/1=201$\n\n最小值：$1-1+9-293/1=-284$\n\n$07+1$（0不能打头），$5/0$（0不能做除数）等算式都是非法的\n\n但$8+-6$是合法的，代表$8$加负$6$，同理$8/-6$也可\n\n保证结果在$float$范围内\n\n\n对于$40$%的数据，算式有括号\n\n对于$10$%的数据，算式完全残缺（全是 * ）\n", "locale": "zh-CN", "translations": {"en": {"title": "Xiaoben Attends Class", "background": "This class is a math class!", "description": "Xiaoben likes math the most QvQ, but he was too sleepy at night and fell asleep. So when he finally realized he needed to work on problems, the expression on the blackboard was already badly damaged.\n\nWith no choice, Xiaoben has to rely on luck to guess. But there is a method to guessing: Xiaoben wants you to give the maximum possible value and the minimum possible value, and output only one line: the average of the maximum possible value and the minimum possible value, keeping two decimal places.", "inputFormat": "Only one line: the incomplete expression (parentheses may appear). The missing parts are represented by $*$ ~~(same as the multiplication sign)~~. Each missing part can be a digit from $0$ to $9$, or one of the four arithmetic operators. There will be no missing parentheses.", "outputFormat": "Output only one line: the average of the maximum possible value and the minimum possible value, keeping two decimal places.", "hint": "Sample explanation:\n\nMaximum value: $191+9-2+3/1=201$.\n\nMinimum value: $1-1+9-293/1=-284$.\n\nExpressions like $07+1$ (a number cannot start with $0$), $5/0$ ($0$ cannot be a divisor), etc. are illegal.\n\nBut $8+-6$ is legal, meaning $8$ plus negative $6$. Similarly, $8/-6$ is also allowed.\n\nIt is guaranteed that the result is within the $float$ range.\n\nFor $40$% of the testdata, the expression contains parentheses.\n\nFor $10$% of the testdata, the expression is completely missing (all are $*$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小奔上课", "background": "这一堂课是数学课！", "description": "小奔最喜欢数学了QvQ，但是因为晚上太困睡着了，所以当他反应过来要写题目时，黑板上的算式已经残缺不堪了。\n\n没办法，小奔只好依靠人品猜一下了，只是猜也是有方法的，小奔想请你给出最大可能值和最输出只有一行，为最大可能值和最小可能值的平均值，并保留两位小数小可能值的平均值。", "inputFormat": "只有一行，为残缺的算式（可能有括号），残缺部分用$*$表示~~（与乘号相同）~~，残缺部分可以为数字$0$到$9$，也可以是四则运算符号之一，不存在残缺括号。\n", "outputFormat": "输出只有一行，为最大可能值和最小可能值的平均值，并保留两位小数", "hint": "样例解释:\n\n最大值：$191+9-2+3/1=201$\n\n最小值：$1-1+9-293/1=-284$\n\n$07+1$（0不能打头），$5/0$（0不能做除数）等算式都是非法的\n\n但$8+-6$是合法的，代表$8$加负$6$，同理$8/-6$也可\n\n保证结果在$float$范围内\n\n\n对于$40$%的数据，算式有括号\n\n对于$10$%的数据，算式完全残缺（全是 * ）\n", "locale": "zh-CN"}}}
{"pid": "P4909", "type": "P", "difficulty": 5, "samples": [["13 4\n0\n1\n0\n2\n4\n6\n8\n6\n8\n8\n9\n11\n12", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "数学", "2006", "USACO"], "title": "[USACO06MAR] Ski Lift G", "background": "", "description": "科罗拉多州的山脉是二维平面上的一条折线。这条折线由 $N$ 个端点，$N−1$ 段线段组成，第 $i$ 个端点的横坐标就是 $i$，纵坐标是 $H_i$，纵坐标代表高度，也可以称为海拔。\n\n罗恩打算为奶牛建造一个滑雪场，为此要在山脉上规划一条缆车线路。缆线也是一条折线，由若干段缆绳组成，起点在山脉的第一个端点，终点在最后一个端点。每段缆绳可以贴着山脉的轮廓，也可以悬浮于空中，跳过山脉上几个海拔低的端点。每段缆绳的水平跨度有限制，不能超过给定的整数 $K$。罗恩需要在每段缆绳的端点处修建支柱，用来固定缆绳。\n\n请帮助他规划一下，选择在山脉的哪些端点上修建，才能使得支柱数量最少？注意，根据题意，起点和终点上是一定要修建的。", "inputFormat": "第一行：两个整数 $N$ 和 $K$。\n\n第二行到第 $N + 1$ 行，第 $i+1$ 行有一个整数 $H_i$。", "outputFormat": "一行一个整数表示最少需要修建的支柱数量。", "hint": "解释 最优方案是把支柱设在 $1,5,7,9,13$。$5$ 不能直接连 $9$，因为 $9$ 的海拔较高，$1$ 不能直接连 $7$，因为跨度超过了 $K$。\n\n### 数据范围\n\n$2 \\le N \\le 5000$，$1 \\le K \\le N − 1$，$0\\le H_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO06MAR] Ski Lift G", "background": "", "description": "The mountains of Colorado are represented as a polyline in the 2D plane. This polyline has $N$ endpoints and $N - 1$ segments. The $i$-th endpoint has x-coordinate $i$ and y-coordinate $H_i$. The y-coordinate represents altitude (elevation).\n\nRon plans to build a ski resort for the cows, and needs to plan a ski lift line along the mountains. The cable line is also a polyline, composed of several cable segments, starting at the first mountain endpoint and ending at the last endpoint. Each cable segment can either follow the outline of the mountain or be suspended in the air, skipping several endpoints with lower altitude. The horizontal span of each cable segment is limited and cannot exceed the given integer $K$. Ron must build pillars at the endpoints of each cable segment to fasten the cable.\n\nPlease help him plan which mountain endpoints should have pillars so that the number of pillars is minimized. Note that, by the problem statement, the start and end endpoints must have pillars.\n\nConstraints\n$2 \\le N \\le 5000$, $1 \\le K \\le N - 1$, $0 \\le H_i \\le 10^9$.", "inputFormat": "The first line contains two integers $N$ and $K$.\n\nLines $2$ through $N + 1$: line $i + 1$ contains an integer $H_i$.", "outputFormat": "Output a single integer, the minimum number of pillars required.", "hint": "Explanation: The optimal plan is to place pillars at $1, 5, 7, 9, 13$. $5$ cannot directly connect to $9$ because the altitude at $9$ is higher; $1$ cannot directly connect to $7$ because the span exceeds $K$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO06MAR] Ski Lift G", "background": "", "description": "科罗拉多州的山脉是二维平面上的一条折线。这条折线由 $N$ 个端点，$N−1$ 段线段组成，第 $i$ 个端点的横坐标就是 $i$，纵坐标是 $H_i$，纵坐标代表高度，也可以称为海拔。\n\n罗恩打算为奶牛建造一个滑雪场，为此要在山脉上规划一条缆车线路。缆线也是一条折线，由若干段缆绳组成，起点在山脉的第一个端点，终点在最后一个端点。每段缆绳可以贴着山脉的轮廓，也可以悬浮于空中，跳过山脉上几个海拔低的端点。每段缆绳的水平跨度有限制，不能超过给定的整数 $K$。罗恩需要在每段缆绳的端点处修建支柱，用来固定缆绳。\n\n请帮助他规划一下，选择在山脉的哪些端点上修建，才能使得支柱数量最少？注意，根据题意，起点和终点上是一定要修建的。", "inputFormat": "第一行：两个整数 $N$ 和 $K$。\n\n第二行到第 $N + 1$ 行，第 $i+1$ 行有一个整数 $H_i$。", "outputFormat": "一行一个整数表示最少需要修建的支柱数量。", "hint": "解释 最优方案是把支柱设在 $1,5,7,9,13$。$5$ 不能直接连 $9$，因为 $9$ 的海拔较高，$1$ 不能直接连 $7$，因为跨度超过了 $K$。\n\n### 数据范围\n\n$2 \\le N \\le 5000$，$1 \\le K \\le N − 1$，$0\\le H_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4910", "type": "P", "difficulty": 4, "samples": [["2\n5\n20", "11\n15127"], ["3\n9\n99\n999", "76\n281781445\n445494875"], ["5  \n123\n1234\n12345\n123456\n1234567", "528790589\n200102666\n537707871\n262341000\n534036342\n"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": ["数学", "递推", "矩阵加速", "Fibonacci 数列"], "title": "帕秋莉的手环", "background": "帕秋莉是蕾米莉亚很早结识的朋友，现在住在红魔馆地下的大图书馆里。不仅擅长许多魔法，还每天都会开发出新的魔法。只是身体比较弱，因为哮喘，会在咏唱符卡时遇到麻烦。\n\n她所用的属性魔法，主要是生命和觉醒的“木”，变化和活动的“火”，基础和不动的“土”，果实和丰收的“金”，寂静和净化的“水”，机动和攻击的“日”，被动和防御的“月”七种属性\n\n没有窗户的图书馆或许充满了灰尘，不过她认为在书旁边才是自己，所以她不能从书的旁边离开。这样已经一百年了。", "description": "经过数年魔法的沉淀，帕秋莉将她那浩瀚无边的魔法的一部分浓缩到了一些特质的珠子中。\n\n由于帕秋莉爱好和平，她只把象征生命和觉醒的木属性魔法和果实和丰收的金属性魔法放入了珠子中。\n\n她认为光要这些珠子没有什么用处，于是她想将这些珠子串成魔法手环，这样就好看多了。于是，她拿出来用来串这些珠子的线 - 雾雨灵径。\n\n她将这些珠子串到一起之后发现了一些性质：只要相邻珠子间的两个珠子中有一个是金属性的，那么它们之间的雾雨灵径的颜色就为金色。\n\n帕秋莉想要一个全都是金色的手环，而且她还想知道一共有多少种方案。由于她还要研究新的魔法，她就把这件事交给了你。由于她的魔法浩瀚无边，她有无穷的珠子。\n\n她并不想看着好几十位的数字，于是你需要对 $1000000007$ 进行取模。", "inputFormat": "输入包含多组数据。\n\n第一行一个正整数 $T$ ，表示数据组数。\n\n之后每组数据有一个 $n$ 代表木属性珠子和金属性珠子的总个数。", "outputFormat": "对于每组数据，输出取模后的方案数。", "hint": "这里给出 $n = 5$ 时，样例的解释：\n\n\n使用 $1, 2, 3, 4, 5$ 来代表各个珠子。\n\n可行的方案是（其中的数字代表染成金元素的珠子序号）：\n\n$\\{1, 3, 5\\}, \\{1, 2, 4\\}, \\{1, 3, 4\\}, \\{2, 3, 5\\}, \\{2, 4, 5\\}$\n\n$\\{1, 2, 3, 4\\}, \\{1, 2, 3, 5\\}, \\{1, 2, 4, 5\\}, \\{1, 3, 4, 5\\}, \\{2, 3, 4, 5\\}$\n\n$\\{1, 2, 3, 4, 5\\}$\n\n\n\n对于 $20\\%$ 的数据，有 $1 \\le n \\le 10$ ；\n\n对于 $40\\%$ 的数据，有 $1 \\le n \\le 10^2$ ；\n\n对于 $60\\%$ 的数据，有 $1\\le n \\le 10^6$ ；\n\n对于 $90\\%$ 的数据，有 $1 \\le n \\le 10^9$ ；\n\n对于全部的数据，有 $1\\le T \\le 10,  1\\le n \\le 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "Patchouli’s Bracelet.", "background": "Patchouli is an old friend of Remilia. She now lives in the large library in the basement of the Scarlet Devil Mansion. She is good at many kinds of magic, and she also creates new magic every day. However, her body is weak. Because of asthma, she may run into trouble when chanting spell cards.\n\nThe elemental magic she uses has seven attributes: “Wood” for life and awakening, “Fire” for change and activity, “Earth” for foundation and stillness, “Metal” for fruits and harvest, “Water” for silence and purification, “Sun” for mobility and attack, and “Moon” for passiveness and defense.\n\nThe windowless library may be full of dust, but she believes she belongs by the books, so she cannot leave their side. This has been the case for a hundred years.", "description": "After years of magical practice, Patchouli has condensed part of her vast magic into some special beads.\n\nBecause Patchouli loves peace, she only put Wood-attribute magic (which stands for life and awakening) and Metal-attribute magic (which stands for fruits and harvest) into the beads.\n\nShe thinks that having only these beads is not very useful, so she wants to string them into a magic bracelet, which looks much better. So she took out the thread used to string these beads, called Kirisame Spirit Path (Wuyu Lingjing).\n\nAfter stringing the beads together, she found a property: as long as at least one of two adjacent beads is Metal-attribute, then the Kirisame Spirit Path between them will be colored gold.\n\nPatchouli wants a bracelet whose thread segments are all gold, and she also wants to know how many different ways there are. Since she still needs to research new magic, she leaves this task to you. Because her magic is vast, she has infinitely many beads.\n\nShe does not want to look at a number with dozens of digits, so you need to take the result modulo $1000000007$.", "inputFormat": "The input contains multiple test cases.\n\nThe first line contains a positive integer $T$, the number of test cases.\n\nThen for each test case, a single integer $n$ is given, representing the total number of Wood-attribute beads and Metal-attribute beads.", "outputFormat": "For each test case, output the number of valid ways modulo $1000000007$.", "hint": "Here is the explanation of the sample when $n = 5$:\n\nUse $1, 2, 3, 4, 5$ to represent the beads.\n\nValid ways are (the numbers denote the indices of beads dyed as the Metal element):\n\n$\\{1, 3, 5\\}, \\{1, 2, 4\\}, \\{1, 3, 4\\}, \\{2, 3, 5\\}, \\{2, 4, 5\\}$\n\n$\\{1, 2, 3, 4\\}, \\{1, 2, 3, 5\\}, \\{1, 2, 4, 5\\}, \\{1, 3, 4, 5\\}, \\{2, 3, 4, 5\\}$\n\n$\\{1, 2, 3, 4, 5\\}$\n\nFor $20\\%$ of the testdata, $1 \\le n \\le 10$.\n\nFor $40\\%$ of the testdata, $1 \\le n \\le 10^2$.\n\nFor $60\\%$ of the testdata, $1 \\le n \\le 10^6$.\n\nFor $90\\%$ of the testdata, $1 \\le n \\le 10^9$.\n\nFor all testdata, $1 \\le T \\le 10$, $1 \\le n \\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "帕秋莉的手环", "background": "帕秋莉是蕾米莉亚很早结识的朋友，现在住在红魔馆地下的大图书馆里。不仅擅长许多魔法，还每天都会开发出新的魔法。只是身体比较弱，因为哮喘，会在咏唱符卡时遇到麻烦。\n\n她所用的属性魔法，主要是生命和觉醒的“木”，变化和活动的“火”，基础和不动的“土”，果实和丰收的“金”，寂静和净化的“水”，机动和攻击的“日”，被动和防御的“月”七种属性\n\n没有窗户的图书馆或许充满了灰尘，不过她认为在书旁边才是自己，所以她不能从书的旁边离开。这样已经一百年了。", "description": "经过数年魔法的沉淀，帕秋莉将她那浩瀚无边的魔法的一部分浓缩到了一些特质的珠子中。\n\n由于帕秋莉爱好和平，她只把象征生命和觉醒的木属性魔法和果实和丰收的金属性魔法放入了珠子中。\n\n她认为光要这些珠子没有什么用处，于是她想将这些珠子串成魔法手环，这样就好看多了。于是，她拿出来用来串这些珠子的线 - 雾雨灵径。\n\n她将这些珠子串到一起之后发现了一些性质：只要相邻珠子间的两个珠子中有一个是金属性的，那么它们之间的雾雨灵径的颜色就为金色。\n\n帕秋莉想要一个全都是金色的手环，而且她还想知道一共有多少种方案。由于她还要研究新的魔法，她就把这件事交给了你。由于她的魔法浩瀚无边，她有无穷的珠子。\n\n她并不想看着好几十位的数字，于是你需要对 $1000000007$ 进行取模。", "inputFormat": "输入包含多组数据。\n\n第一行一个正整数 $T$ ，表示数据组数。\n\n之后每组数据有一个 $n$ 代表木属性珠子和金属性珠子的总个数。", "outputFormat": "对于每组数据，输出取模后的方案数。", "hint": "这里给出 $n = 5$ 时，样例的解释：\n\n\n使用 $1, 2, 3, 4, 5$ 来代表各个珠子。\n\n可行的方案是（其中的数字代表染成金元素的珠子序号）：\n\n$\\{1, 3, 5\\}, \\{1, 2, 4\\}, \\{1, 3, 4\\}, \\{2, 3, 5\\}, \\{2, 4, 5\\}$\n\n$\\{1, 2, 3, 4\\}, \\{1, 2, 3, 5\\}, \\{1, 2, 4, 5\\}, \\{1, 3, 4, 5\\}, \\{2, 3, 4, 5\\}$\n\n$\\{1, 2, 3, 4, 5\\}$\n\n\n\n对于 $20\\%$ 的数据，有 $1 \\le n \\le 10$ ；\n\n对于 $40\\%$ 的数据，有 $1 \\le n \\le 10^2$ ；\n\n对于 $60\\%$ 的数据，有 $1\\le n \\le 10^6$ ；\n\n对于 $90\\%$ 的数据，有 $1 \\le n \\le 10^9$ ；\n\n对于全部的数据，有 $1\\le T \\le 10,  1\\le n \\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P4911", "type": "P", "difficulty": 6, "samples": [["5\nrint %r1;\nrint %r2;\nadd %r1 %r2;\nwint;\nhlt;\n5 4", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "字符串", "栈"], "title": "河童重工的计算机", "background": "河童重工业会社的计算机产品在幻想乡中有着极其广泛的应用。\n\n有一天，妖怪之山发大水啦！洪水夹杂着泥沙和滚木汹涌着冲进了河童的城市。\n\n本来河童们的机械设施都是防水的，可是洪水还是对城市造成了不小的破坏。其中，河童们的服务器被砸坏了！\n\n坏掉的电脑在短时间内不能修复，可是幻想乡里的许多事情都离不开河童们的服务器！河童们也很无奈，于是荷取找到了你！你作为一名优秀的信竞选手，决定帮助荷取，减轻服务器故障所带来的压力。", "description": "你从荷取那里得到了一份纸质资料，扫描版在这里：\n\n[Ktx-65式微处理器汇编语言规范文件.pdf](https://www.touhou-oi.tk/uploads/Ktx-65%E5%BC%8F%E5%BE%AE%E5%A4%84%E7%90%86%E5%99%A8%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E8%A7%84%E8%8C%83%E6%96%87%E4%BB%B6.pdf)\n\n（若此网站无法打开，请在附件中下载）\n\n（为什么说是扫描版呢，因为，你应该不能复制里面的文字）\n\n以下这一段是汇编教程附带的示例：\n```asm\n[ progfunc.asm ]\n[ Shows the function functionailties of the KTX-65 ALI ]\n\n[main]\nwint #line;    [output the current physical line number]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\ncallfunc $Function1;\ncallfunc $Function2;\nhlt;           [halt]\n\nfunction $Function1;\nrint %r1;      [read int]\nadd %r2 1 %r2; [loop contents]\nlle %r2 %r1;   [loop conditions]\njif 2;         [end loop conditional jump]\nwint %r2;      [output int]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\nret;           [return]\n\nfunction $Function2;\nrint %r1;      [read int]\nrint %r2;      [read int]\nadd %r1, %r2;  [add]\nwint %val;     [output value]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\nret;           [return]\n```\n你需要用洛谷评测机支持的语言编写一个程序，它读入一个Ktx-65汇编语言程序和一段输入，解释运行这个程序，然后输出这个程序输出的东西。", "inputFormat": "第一行是一个整数 $N$，表示汇编程序的行数。\n\n接下来 $N$ 行是这个汇编程序，保证不会出现空行。\n\n接下来的所有行都是这个汇编程序的输入。", "outputFormat": "一堆东西，表示这个汇编程序的输出。\n\n**~~评测系统将以逐字节比较的方式判断你的输出是否正确~~**。假的，洛谷不支持。", "hint": "**注意**：样例输出中只有 $9$ 这一个字节。\n\n**保证一行中只有一个指令。**\n\n对于 $10\\%$ 的数据：程序中只有输入和输出的指令，且不会出现数字常量，也不会有注释。\n\n对于另外 $10\\%$：程序中只有输入、输出和加法指令，且没有注释。\n\n对于另外 $30\\%$：包括除函数调用和跳转在内的所有指令。\n\n对于剩下 $50\\%$：指令没有限制。\n\n对于全部的数据：命令条数不超过 $50000$ 条，剩余输入不超过 $500$ 千字节，程序需要执行的步数不超过$80000$ 步。\n\n保证汇编程序和数据不出现编译或是运行时错误。\n\n保证程序输入足够满足汇编程序中读入的需要。\n\n不保证这是或不是一道毒瘤题。\n\n不保证考试时会不会有人 AC 这道题。\n\n不保证这次考试会不会有人 AK。\n\n保证出题人为：[洩矢诹访子](https://www.luogu.org/space/show?uid=53151)\n\n考试时打不开河童给的文件可以向我索要，不保证是否会回答。\n\n~~其实这道题数据非常简单，只是量大而已~~", "locale": "zh-CN", "translations": {"en": {"title": "Kappa Heavy Industries’ Computer.", "background": "The computer products of Kappa Heavy Industries are widely used throughout Gensokyo.\n\nOne day, Youkai Mountain was flooded. The flood, mixed with mud and rolling logs, surged into the kappa city.\n\nThe kappa’s mechanical facilities were originally waterproof, but the flood still caused serious damage to the city. Among them, the kappa’s servers were smashed!\n\nThe broken computers cannot be repaired in a short time, but many things in Gensokyo cannot work without the kappa’s servers. The kappa had no choice, so Nitori came to you. As an excellent competitive programming contestant, you decide to help Nitori and reduce the pressure caused by the server failure.", "description": "You received a paper document from Nitori, and the scanned version is here:\n\n[Ktx-65式微处理器汇编语言规范文件.pdf](https://www.touhou-oi.tk/uploads/Ktx-65%E5%BC%8F%E5%BE%AE%E5%A4%84%E7%90%86%E5%99%A8%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E8%A7%84%E8%8C%83%E6%96%87%E4%BB%B6.pdf)\n\n(If this website cannot be opened, please download it from the attachments.)\n\n(Why is it called a scanned version? Because you probably cannot copy the text inside.)\n\nThe following part is an example included with the assembly tutorial:\n```asm\n[ progfunc.asm ]\n[ Shows the function functionailties of the KTX-65 ALI ]\n\n[main]\nwint #line;    [output the current physical line number]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\ncallfunc $Function1;\ncallfunc $Function2;\nhlt;           [halt]\n\nfunction $Function1;\nrint %r1;      [read int]\nadd %r2 1 %r2; [loop contents]\nlle %r2 %r1;   [loop conditions]\njif 2;         [end loop conditional jump]\nwint %r2;      [output int]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\nret;           [return]\n\nfunction $Function2;\nrint %r1;      [read int]\nrint %r2;      [read int]\nadd %r1, %r2;  [add]\nwint %val;     [output value]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\nret;           [return]\n```\n\nYou need to write a program in a language supported by the Luogu judge. It reads a Ktx-65 assembly program and an input stream, interprets and runs the program, and then outputs what the program outputs.", "inputFormat": "The first line is an integer $N$, meaning the number of lines of the assembly program.\n\nThe next $N$ lines are the assembly program, and it is guaranteed that there are no empty lines.\n\nAll remaining lines are the input for this assembly program.", "outputFormat": "A bunch of stuff, representing the output of this assembly program.\n\n**~~The judge will compare your output byte by byte to determine correctness~~**. This is fake; Luogu does not support it.", "hint": "**Note**: In the sample output, there is only the single byte $9$.\n\n**It is guaranteed that each line contains only one instruction.**\n\nFor $10\\%$ of the testdata: the program contains only input and output instructions, and there will be no numeric constants and no comments.\n\nFor another $10\\%$: the program contains only input, output, and addition instructions, and there are no comments.\n\nFor another $30\\%$: all instructions are included except function calls and jumps.\n\nFor the remaining $50\\%$: there are no restrictions on instructions.\n\nFor all testdata: the number of commands does not exceed $50000$, the remaining input does not exceed $500$ kilobytes, and the number of steps the program needs to execute does not exceed $80000$ steps.\n\nIt is guaranteed that the assembly program and the input data will not have compilation or runtime errors.\n\nIt is guaranteed that the program input is sufficient for what the assembly program needs to read.\n\nIt is not guaranteed whether this is or is not a nasty problem.\n\nIt is not guaranteed whether anyone will AC this problem during the contest.\n\nIt is not guaranteed whether anyone will AK in this contest.\n\nIt is guaranteed that the problem setter is: [洩矢诹访子](https://www.luogu.org/space/show?uid=53151)\n\nIf you cannot open the file given by the kappa during the contest, you can ask me for it. It is not guaranteed whether I will respond.\n\n~~Actually, the testdata for this problem is very simple, it is just large in size.~~\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "河童重工的计算机", "background": "河童重工业会社的计算机产品在幻想乡中有着极其广泛的应用。\n\n有一天，妖怪之山发大水啦！洪水夹杂着泥沙和滚木汹涌着冲进了河童的城市。\n\n本来河童们的机械设施都是防水的，可是洪水还是对城市造成了不小的破坏。其中，河童们的服务器被砸坏了！\n\n坏掉的电脑在短时间内不能修复，可是幻想乡里的许多事情都离不开河童们的服务器！河童们也很无奈，于是荷取找到了你！你作为一名优秀的信竞选手，决定帮助荷取，减轻服务器故障所带来的压力。", "description": "你从荷取那里得到了一份纸质资料，扫描版在这里：\n\n[Ktx-65式微处理器汇编语言规范文件.pdf](https://www.touhou-oi.tk/uploads/Ktx-65%E5%BC%8F%E5%BE%AE%E5%A4%84%E7%90%86%E5%99%A8%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E8%A7%84%E8%8C%83%E6%96%87%E4%BB%B6.pdf)\n\n（若此网站无法打开，请在附件中下载）\n\n（为什么说是扫描版呢，因为，你应该不能复制里面的文字）\n\n以下这一段是汇编教程附带的示例：\n```asm\n[ progfunc.asm ]\n[ Shows the function functionailties of the KTX-65 ALI ]\n\n[main]\nwint #line;    [output the current physical line number]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\ncallfunc $Function1;\ncallfunc $Function2;\nhlt;           [halt]\n\nfunction $Function1;\nrint %r1;      [read int]\nadd %r2 1 %r2; [loop contents]\nlle %r2 %r1;   [loop conditions]\njif 2;         [end loop conditional jump]\nwint %r2;      [output int]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\nret;           [return]\n\nfunction $Function2;\nrint %r1;      [read int]\nrint %r2;      [read int]\nadd %r1, %r2;  [add]\nwint %val;     [output value]\nwch 13;        [putchar \\r]\nwch 10;        [putchar \\n]\nret;           [return]\n```\n你需要用洛谷评测机支持的语言编写一个程序，它读入一个Ktx-65汇编语言程序和一段输入，解释运行这个程序，然后输出这个程序输出的东西。", "inputFormat": "第一行是一个整数 $N$，表示汇编程序的行数。\n\n接下来 $N$ 行是这个汇编程序，保证不会出现空行。\n\n接下来的所有行都是这个汇编程序的输入。", "outputFormat": "一堆东西，表示这个汇编程序的输出。\n\n**~~评测系统将以逐字节比较的方式判断你的输出是否正确~~**。假的，洛谷不支持。", "hint": "**注意**：样例输出中只有 $9$ 这一个字节。\n\n**保证一行中只有一个指令。**\n\n对于 $10\\%$ 的数据：程序中只有输入和输出的指令，且不会出现数字常量，也不会有注释。\n\n对于另外 $10\\%$：程序中只有输入、输出和加法指令，且没有注释。\n\n对于另外 $30\\%$：包括除函数调用和跳转在内的所有指令。\n\n对于剩下 $50\\%$：指令没有限制。\n\n对于全部的数据：命令条数不超过 $50000$ 条，剩余输入不超过 $500$ 千字节，程序需要执行的步数不超过$80000$ 步。\n\n保证汇编程序和数据不出现编译或是运行时错误。\n\n保证程序输入足够满足汇编程序中读入的需要。\n\n不保证这是或不是一道毒瘤题。\n\n不保证考试时会不会有人 AC 这道题。\n\n不保证这次考试会不会有人 AK。\n\n保证出题人为：[洩矢诹访子](https://www.luogu.org/space/show?uid=53151)\n\n考试时打不开河童给的文件可以向我索要，不保证是否会回答。\n\n~~其实这道题数据非常简单，只是量大而已~~", "locale": "zh-CN"}}}
{"pid": "P4912", "type": "P", "difficulty": 4, "samples": [["2 5\n3 3\n2 2\n1 2\n3 4", "7"], ["2 6\n3 3\n2 2\n1 2\n3 4", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "帕秋莉的魔法", "background": "帕秋莉是一个有哮喘病的魔法使。", "description": "众所周知，不同的魔法会需要念不同长度咒语 $a_i$ 但也会产生不同的威力 $b_i$。同时，在发动过一个魔法后也会对接下来发动的一个魔法产生影响 $w_{i,j}$，即在用完第 $i$ 种魔法后第 $j$ 种魔法的威力会变为 $b_j + w_{i.j}$，而且只会影响到下一个魔法。\n（当然也可能有魔法会减少咒语长度或者产生治愈的效果的魔法，魔法不可重复使用）\n\n帕秋莉现在知道使用每种魔法后对接下来一种魔法的影响，以及每种魔法需要念的咒语长度和产生的威力。同时，由于编号大的魔法比编号小的魔法高级（编号顺序即给出的顺序），所以一个魔法只有在编号不大于自己的魔法后使用才能保证魔法的连续性。现在她想知道念出长度为 $m$ 的咒语最大能产生多少威力。（以免下次在战斗中又因为哮喘病发作而惨败）", "inputFormat": "第一行：两个正整数 $n,m$，表示一共有 $n$ 种魔法，念出长度为 $m$ 的咒语。\n\n接下来的 $n$ 行：每行两个整数 $a_i,b_i$，表示咒语的长度以及魔法的威力。\n\n接下来的 $n$ 行：每行 $n$ 个整数，第 $i$ 行，第 $j$ 列，表示在第 $i$ 种魔法后使用第 $j$ 种魔法能够产生的附加值 $w_{i,j}$。", "outputFormat": "一个整数，表示最大能产生的威力。如果无论如何都无法组成长度为 $m$ 的咒语，则输出 `-1`。", "hint": "对于 $20\\%$ 的数据，保证 $a_i = 1$。\n\n对于另外 $20\\%$ 的数据，保证所有数字均为正整数。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 50$，$|a_i|,|b_i|, |w_{i,j}|\\le 50$，$|m| \\le 2500$，保证运算过程中的数字大小均在 int 范围内。", "locale": "zh-CN", "translations": {"en": {"title": "Patchouli's Magic.", "background": "Patchouli is a magician who has asthma.", "description": "As everyone knows, different kinds of magic require chanting spells of different lengths $a_i$, and they also produce different power $b_i$. At the same time, after casting one magic spell, it will affect the next spell cast: $w_{i,j}$. That is, after using the $i$-th kind of magic, the power of the $j$-th kind of magic becomes $b_j + w_{i,j}$, and it only affects the very next spell.\n(Of course, some magic may reduce the spell length, or have healing effects. Magic cannot be used repeatedly.)\n\nPatchouli now knows the effect of each magic on the next one, as well as the spell length and base power of each magic. Also, since magic with a larger index is more advanced than magic with a smaller index (the index order is the given order), a magic spell can only be used after a magic whose index is not greater than its own, in order to keep the casting sequence continuous. Now she wants to know: with a total spell length of $m$, what is the maximum power that can be produced? (So that she will not suffer a terrible defeat again in battle due to an asthma attack.)", "inputFormat": "The first line contains two positive integers $n, m$, meaning there are $n$ kinds of magic in total, and the total spell length is $m$.\n\nThe next $n$ lines: each line contains two integers $a_i, b_i$, meaning the spell length and the power of the magic.\n\nThe next $n$ lines: each line contains $n$ integers. The number in row $i$, column $j$ denotes the additional value $w_{i,j}$ produced when using the $j$-th kind of magic after the $i$-th kind of magic.", "outputFormat": "Output one integer, the maximum power that can be produced. If it is impossible to form a total spell length of $m$ no matter what, output `-1`.", "hint": "For $20\\%$ of the testdata, it is guaranteed that $a_i = 1$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that all numbers are positive integers.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 50$, $|a_i|, |b_i|, |w_{i,j}| \\le 50$, $|m| \\le 2500$. It is guaranteed that all numbers during computation fit within the range of `int`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "帕秋莉的魔法", "background": "帕秋莉是一个有哮喘病的魔法使。", "description": "众所周知，不同的魔法会需要念不同长度咒语 $a_i$ 但也会产生不同的威力 $b_i$。同时，在发动过一个魔法后也会对接下来发动的一个魔法产生影响 $w_{i,j}$，即在用完第 $i$ 种魔法后第 $j$ 种魔法的威力会变为 $b_j + w_{i.j}$，而且只会影响到下一个魔法。\n（当然也可能有魔法会减少咒语长度或者产生治愈的效果的魔法，魔法不可重复使用）\n\n帕秋莉现在知道使用每种魔法后对接下来一种魔法的影响，以及每种魔法需要念的咒语长度和产生的威力。同时，由于编号大的魔法比编号小的魔法高级（编号顺序即给出的顺序），所以一个魔法只有在编号不大于自己的魔法后使用才能保证魔法的连续性。现在她想知道念出长度为 $m$ 的咒语最大能产生多少威力。（以免下次在战斗中又因为哮喘病发作而惨败）", "inputFormat": "第一行：两个正整数 $n,m$，表示一共有 $n$ 种魔法，念出长度为 $m$ 的咒语。\n\n接下来的 $n$ 行：每行两个整数 $a_i,b_i$，表示咒语的长度以及魔法的威力。\n\n接下来的 $n$ 行：每行 $n$ 个整数，第 $i$ 行，第 $j$ 列，表示在第 $i$ 种魔法后使用第 $j$ 种魔法能够产生的附加值 $w_{i,j}$。", "outputFormat": "一个整数，表示最大能产生的威力。如果无论如何都无法组成长度为 $m$ 的咒语，则输出 `-1`。", "hint": "对于 $20\\%$ 的数据，保证 $a_i = 1$。\n\n对于另外 $20\\%$ 的数据，保证所有数字均为正整数。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 50$，$|a_i|,|b_i|, |w_{i,j}|\\le 50$，$|m| \\le 2500$，保证运算过程中的数字大小均在 int 范围内。", "locale": "zh-CN"}}}
{"pid": "P4913", "type": "P", "difficulty": 2, "samples": [["7\n2 7\n3 6\n4 5\n0 0\n0 0\n0 0\n0 0", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "广度优先搜索 BFS", "深度优先搜索 DFS"], "title": "【深基16.例3】二叉树深度", "background": "", "description": "有一个 $n(n \\le 10^6)$ 个结点的二叉树。给出每个结点的两个子结点编号（均不超过 $n$），建立一棵二叉树（根节点的编号为 $1$），如果是叶子结点，则输入 `0 0`。\n\n建好这棵二叉树之后，请求出它的深度。二叉树的**深度**是指从根节点到叶子结点时，最多经过了几层。\n", "inputFormat": "第一行一个整数 $n$，表示结点数。\n\n之后 $n$ 行，第 $i$ 行两个整数 $l$、$r$，分别表示结点 $i$ 的左右子结点编号。若 $l=0$ 则表示无左子结点，$r=0$ 同理。", "outputFormat": "一个整数，表示最大结点深度。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basis 16. Example 3] Binary Tree Depth", "background": "", "description": "There is a binary tree with $n(n \\le 10^6)$ nodes. You are given the indices of the two child nodes for each node (both not exceeding $n$). Build a binary tree (the root node has index $1$). If a node is a leaf, the input is `0 0`.\n\nAfter building the binary tree, find its depth. The **depth** of a binary tree means the maximum number of levels passed when going from the root node to a leaf node.", "inputFormat": "The first line contains an integer $n$, which is the number of nodes.\n\nThen follow $n$ lines. In the $i$-th line, two integers $l$ and $r$ are given, representing the indices of the left and right child nodes of node $i$, respectively. If $l=0$, it means there is no left child node; similarly, $r=0$ means there is no right child node.", "outputFormat": "One integer, representing the maximum node depth.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基16.例3】二叉树深度", "background": "", "description": "有一个 $n(n \\le 10^6)$ 个结点的二叉树。给出每个结点的两个子结点编号（均不超过 $n$），建立一棵二叉树（根节点的编号为 $1$），如果是叶子结点，则输入 `0 0`。\n\n建好这棵二叉树之后，请求出它的深度。二叉树的**深度**是指从根节点到叶子结点时，最多经过了几层。\n", "inputFormat": "第一行一个整数 $n$，表示结点数。\n\n之后 $n$ 行，第 $i$ 行两个整数 $l$、$r$，分别表示结点 $i$ 的左右子结点编号。若 $l=0$ 则表示无左子结点，$r=0$ 同理。", "outputFormat": "一个整数，表示最大结点深度。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4914", "type": "P", "difficulty": 3, "samples": [["2\n6.000000 11.000000 10.000000 100.000000 43\n1.000000 10.000000 10.000000 100.000000 11\n ", "yes\nyes"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "数学"], "title": "難題「龍の頸の玉　-五色の弾丸-」", "background": "輝夜が出した難題の一つ。この玉にはそれぞれ星が入っていて、\n七つ集めるとどんな願いでもかなうという。\n\n辉夜所出的难题之一。这些玉石各自都被画上了星星，\n据说收集齐七颗就能够实现任何的愿望。", "description": "五颗龙玉在同一平面上形成一个外切圆半径为 $r$ 的正五边形，其中一颗（$aa$）在外心与辉夜的连线上。五边形的外心（外切圆圆心）绕着辉夜以 $R$ 的半径 $v$ 的速度顺时针旋转（不自转）。五颗龙玉每 $t$ 秒钟发射一圈弹幕，一圈 $k$ 个子弹。$aa$ 发出的子弹中有一个子弹是背对辉夜的方向的，其他的龙玉发出的子弹方向与 $aa$ 相同，我们可以认为子弹是无限快的。作为一个 neet，辉夜不能让子弹打到自己。\n\n永琳对此表示很担心，于是请你写一个程序判断辉夜的安全。\n\n下面是图示：\n\n![](https://cdn.luogu.com.cn/upload/pic/27885.png)\n\n注：红色为龙玉旋转轨迹                 \np.s.感谢几何画板为本题提供技术支持；感谢上海爱丽丝幻乐团提供信仰加成", "inputFormat": "第一行有一个整数 $ T$，表示有 $T$ 组数据。\n\n对于每组数据，共一行四个浮点数和一个整数 $r,R,v,t,k$，含义如题面所示。", "outputFormat": "每组数据一行，安全输出 `yes`，危险输出 `no`。", "hint": "- 对于 $50\\%$ 的数据，保证 $T<5000$。\n- 对于 $100\\%$ 的数据，保证 $T<10^5$，$r,k,R,v,t<10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Hard Problem \"Dragon’s Neck Jewel - Five-Colored Bullets -\"", "background": "One of the hard problems given by Kaguya. Each jewel has a star on it, and it is said that if you collect seven of them, any wish will come true.\n\nOne of the hard problems posed by Kaguya. These jewels each have a star painted on them, and it is said that collecting all seven will allow any wish to come true.", "description": "Five Dragon Jewels lie on the same plane, forming a regular pentagon with circumradius $r$. One of them ($aa$) lies on the line connecting the circumcenter and Kaguya. The circumcenter of the pentagon (the center of the circumcircle) rotates clockwise around Kaguya with radius $R$ and speed $v$ (without self-rotation). Every $t$ seconds, each of the five Dragon Jewels fires one ring of bullets, with $k$ bullets per ring. Among the bullets fired by $aa$, one bullet is shot in the direction directly away from Kaguya; the bullets fired by the other Dragon Jewels have the same directions as those from $aa$. You may assume bullets travel infinitely fast. As a neet, Kaguya must not be hit by any bullet.\n\nEirin is very worried about this, so she asks you to write a program to determine whether Kaguya is safe.\n\nThe following figure illustrates this:\n\n![](https://cdn.luogu.com.cn/upload/pic/27885.png)\n\nNote: The red curve is the rotation trajectory of the Dragon Jewels.  \np.s. Thanks to Geometer’s Sketchpad for providing technical support for this problem; thanks to Team Shanghai Alice for the faith bonus.", "inputFormat": "The first line contains an integer $T$, indicating that there are $T$ test cases.\n\nFor each test case, there is one line containing four floating-point numbers and one integer $r, R, v, t, k$, whose meanings are as described in the statement.", "outputFormat": "For each test case, output one line: print `yes` if it is safe, and `no` if it is dangerous.", "hint": "- For $50\\%$ of the testdata, it is guaranteed that $T < 5000$.\n- For $100\\%$ of the testdata, it is guaranteed that $T < 10^5$, and $r, k, R, v, t < 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "難題「龍の頸の玉　-五色の弾丸-」", "background": "輝夜が出した難題の一つ。この玉にはそれぞれ星が入っていて、\n七つ集めるとどんな願いでもかなうという。\n\n辉夜所出的难题之一。这些玉石各自都被画上了星星，\n据说收集齐七颗就能够实现任何的愿望。", "description": "五颗龙玉在同一平面上形成一个外切圆半径为 $r$ 的正五边形，其中一颗（$aa$）在外心与辉夜的连线上。五边形的外心（外切圆圆心）绕着辉夜以 $R$ 的半径 $v$ 的速度顺时针旋转（不自转）。五颗龙玉每 $t$ 秒钟发射一圈弹幕，一圈 $k$ 个子弹。$aa$ 发出的子弹中有一个子弹是背对辉夜的方向的，其他的龙玉发出的子弹方向与 $aa$ 相同，我们可以认为子弹是无限快的。作为一个 neet，辉夜不能让子弹打到自己。\n\n永琳对此表示很担心，于是请你写一个程序判断辉夜的安全。\n\n下面是图示：\n\n![](https://cdn.luogu.com.cn/upload/pic/27885.png)\n\n注：红色为龙玉旋转轨迹                 \np.s.感谢几何画板为本题提供技术支持；感谢上海爱丽丝幻乐团提供信仰加成", "inputFormat": "第一行有一个整数 $ T$，表示有 $T$ 组数据。\n\n对于每组数据，共一行四个浮点数和一个整数 $r,R,v,t,k$，含义如题面所示。", "outputFormat": "每组数据一行，安全输出 `yes`，危险输出 `no`。", "hint": "- 对于 $50\\%$ 的数据，保证 $T<5000$。\n- 对于 $100\\%$ 的数据，保证 $T<10^5$，$r,k,R,v,t<10^9$。", "locale": "zh-CN"}}}
{"pid": "P4915", "type": "P", "difficulty": 5, "samples": [["5 5\n1 1\n2 1\n3 1\n4 1\n5 1\n1 2 5\n1 1 5\n1 3 5\n2 1 5\n1 1 2", "3.5000\n3.0000\n4.0000\n6.5000\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["线段树", "树状数组", "Special Judge", "前缀和"], "title": "帕秋莉的魔导书", "background": "帕秋莉有一个巨大的图书馆，里面有数以万计的书，其中大部分为魔导书。", "description": "魔导书是一种需要钥匙才能看得懂的书，然而只有和书写者同等或更高熟练度的人才能看得见钥匙。因此，每本魔导书都有它自己的等级 $a_i$，同时它也有自己的知识程度为 $w_i$，现在我们想要知道，一个等级为 $b_i$ 的生物(...)，可以从这些魔导书中得到多少知识。\n\n然而不幸的是，每个生物并不知道自己确切的等级，只有一个等级的大致范围，你需要计算出这个生物获得知识程度的期望值。\n", "inputFormat": "第一行两个正整数 $n,m$ 代表起始书的个数，以及操作的个数。\n\n以下 $n$ 行，每行两个正整数 $a_i$ 和 $w_i$，代表每本书的等级以及知识程度。\n\n接下来的 $m$ 行，每行 $2$ 或 $3$ 个正整数。\n\n操作 1：格式：`1 x y`。含义：求等级为 $[x, y]$ 的生物能获得的期望知识程度。\n\n操作 2：格式：`2 x y`。含义：图书馆又收入了一本等级为 $x$，知识程度为 $y$ 的魔导书。", "outputFormat": "输出包含若干行实数，即为所有操作 1 的结果，答案保留四位小数。", "hint": "对于 $30\\%$ 的数据，保证 $1\\le $ 所有输入的数字 $\\le 10^3$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m\\le 10^5$，对于其他数字，保证在 $32$ 位带符号整数范围内（保证运算中所有的数均在 $-2^{63}\\sim 2^{63}-1$ 内）。", "locale": "zh-CN", "translations": {"en": {"title": "Patchouli's Magic Books", "background": "Patchouli has a huge library with tens of thousands of books, most of which are magic books.", "description": "A magic book is a kind of book that requires a key to understand. However, only someone whose proficiency is equal to or higher than the author can see the key. Therefore, each magic book has its own level $a_i$, and it also has its own knowledge value $w_i$. Now we want to know how much knowledge a creature with level $b_i$ can gain from these magic books.\n\nUnfortunately, each creature does not know its exact level, only an approximate range of levels. You need to compute the expected knowledge value that the creature can obtain.", "inputFormat": "The first line contains two positive integers $n, m$, representing the initial number of books and the number of operations.\n\nThe next $n$ lines each contain two positive integers $a_i$ and $w_i$, representing the level and the knowledge value of each book.\n\nThe next $m$ lines each contain $2$ or $3$ positive integers.\n\nOperation 1: Format: `1 x y`. Meaning: query the expected knowledge value that a creature with level in $[x, y]$ can obtain.\n\nOperation 2: Format: `2 x y`. Meaning: the library acquires a new magic book with level $x$ and knowledge value $y$.", "outputFormat": "Output several lines of real numbers, which are the results of all Operation 1 queries. Print each answer to four decimal places.", "hint": "For $30\\%$ of the testdata, it is guaranteed that $1 \\le$ all input numbers $\\le 10^3$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le n, m \\le 10^5$. For the other numbers, they are guaranteed to be within the range of 32-bit signed integers (and all numbers during computation are guaranteed to be within $-2^{63} \\sim 2^{63} - 1$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "帕秋莉的魔导书", "background": "帕秋莉有一个巨大的图书馆，里面有数以万计的书，其中大部分为魔导书。", "description": "魔导书是一种需要钥匙才能看得懂的书，然而只有和书写者同等或更高熟练度的人才能看得见钥匙。因此，每本魔导书都有它自己的等级 $a_i$，同时它也有自己的知识程度为 $w_i$，现在我们想要知道，一个等级为 $b_i$ 的生物(...)，可以从这些魔导书中得到多少知识。\n\n然而不幸的是，每个生物并不知道自己确切的等级，只有一个等级的大致范围，你需要计算出这个生物获得知识程度的期望值。\n", "inputFormat": "第一行两个正整数 $n,m$ 代表起始书的个数，以及操作的个数。\n\n以下 $n$ 行，每行两个正整数 $a_i$ 和 $w_i$，代表每本书的等级以及知识程度。\n\n接下来的 $m$ 行，每行 $2$ 或 $3$ 个正整数。\n\n操作 1：格式：`1 x y`。含义：求等级为 $[x, y]$ 的生物能获得的期望知识程度。\n\n操作 2：格式：`2 x y`。含义：图书馆又收入了一本等级为 $x$，知识程度为 $y$ 的魔导书。", "outputFormat": "输出包含若干行实数，即为所有操作 1 的结果，答案保留四位小数。", "hint": "对于 $30\\%$ 的数据，保证 $1\\le $ 所有输入的数字 $\\le 10^3$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m\\le 10^5$，对于其他数字，保证在 $32$ 位带符号整数范围内（保证运算中所有的数均在 $-2^{63}\\sim 2^{63}-1$ 内）。", "locale": "zh-CN"}}}
{"pid": "P4916", "type": "P", "difficulty": 7, "samples": [["6 3 2\n", "3\n"], ["17 8 6\n", "1421\n"], ["50000 20000 1\n", "683811528\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "洛谷原创", "O2优化", "枚举", "Pólya 定理", "莫比乌斯反演"], "title": "[MtOI2018] 魔力环", "background": "wkr 是一名来自魔力之都的 OIer，他喜欢收集黑色与白色的魔力珠。", "description": "wkr 希望能够得到一个由 $n$ 个魔力珠串成的环。不过他对普通的环并不感兴趣，因此他提出了如下的要求：\n\n- wkr 希望在这个环上，**恰好**有 $m$ 个黑色的魔力珠与 $n - m$ 个白色的魔力珠。\n- 由于 wkr 认为黑色魔力珠不应过于密集，因此 wkr 希望这个环上**不会**出现一段**连续**的黑色魔力珠，其长度**超过** $k$。\n\n在 wkr 的心目中，满足上述要求的环才是美妙的。\n\n不过这样的环可能并不唯一。 wkr 想要知道共有多少种不同的环满足他所提出的要求。然而 wkr 并不喜欢计算，他希望聪明的你能够告诉他答案。\n\n在这里，我们认为**两个环是不同的，当且仅当其中一个环仅通过旋转无法得到另一个环**。\n\n由于答案可能过大，因此输出答案对 $998, 244, 353$ 取模后的结果。", "inputFormat": "输入共 $1$ 行 $3$ 个非负整数 $n, m, k$，其意义见题目描述，相邻的两个数用单个空格隔开。", "outputFormat": "输出共 $1$ 行 $1$ 个整数，表示满足要求的环的数量。", "hint": "#### 样例 $1$ 解释\n\n由 $6$ 个魔力珠串成，满足其中恰好有 $3$ 个黑色魔力珠与 $3$ 个白色魔力珠，且不存在长度超过 $2$ 的连续的黑色魔力珠的不同的环共有 $3$ 种，如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cqi70gls.png)\n\n下图所示的环不满足 wkr 提出的要求，因为在这个环中，存在一段连续的黑色魔力珠，长度超过了 $2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1a5enl8k.png)\n\n### 子任务\n\n所有测试点均满足 $1 \\leq n, k \\leq 10^5, 0 \\leq m \\leq 10^5$ 且 $m \\leq n$。\n\n本题采用捆绑测试，共有 $7$ 个子任务，各子任务的分值和限制如下：\n\n- 子任务 1（3 分）：$m = 0$。\n- 子任务 2（5 分）：$n \\leq 4$。\n- 子任务 3（8 分）：$n \\leq 18$。\n- 子任务 4（7 分）：$m = 2$。\n- 子任务 5（19 分）：$k = 1$。\n- 子任务 6（27 分）：$\\gcd(n,m) \\leq 2$。\n- 子任务 7（31 分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T6\n\n出题人：Imagine\n\n72679", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] Magic Ring", "background": "wkr is an OIer from the City of Magic, and he likes collecting black and white magic beads.", "description": "wkr wants to obtain a ring made by stringing together $n$ magic beads. However, he is not interested in ordinary rings, so he proposes the following requirements:\n\n- wkr wants the ring to have **exactly** $m$ black magic beads and $n - m$ white magic beads.\n- Since wkr believes black magic beads should not be too dense, he wants that on the ring there **will not** appear a **consecutive** segment of black magic beads whose length **exceeds** $k$.\n\nIn wkr’s mind, only rings that satisfy the above requirements are wonderful.\n\nHowever, such rings may not be unique. wkr wants to know how many different rings satisfy his requirements. But wkr does not like doing calculations, so he hopes the smart you can tell him the answer.\n\nHere, we consider **two rings to be different if and only if one ring cannot be obtained from the other by rotation only**.\n\nSince the answer may be too large, output the result modulo $998, 244, 353$.", "inputFormat": "The input consists of $1$ line with $3$ non-negative integers $n, m, k$, whose meanings are described above. Adjacent numbers are separated by a single space.", "outputFormat": "Output $1$ line with $1$ integer, representing the number of rings that meet the requirements.", "hint": "#### Explanation of Sample $1$\n\nFor rings made of $6$ magic beads, with exactly $3$ black magic beads and $3$ white magic beads, and with no consecutive segment of black magic beads of length greater than $2$, there are $3$ different rings, as shown below.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cqi70gls.png)\n\nThe ring shown below does not meet wkr’s requirements, because in this ring there exists a consecutive segment of black magic beads whose length exceeds $2$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1a5enl8k.png)\n\n### Subtasks\n\nAll testdata satisfy $1 \\leq n, k \\leq 10^5$, $0 \\leq m \\leq 10^5$, and $m \\leq n$.\n\nThis problem uses bundled tests. There are $7$ subtasks, and the score and limits of each subtask are as follows:\n\n- Subtask 1 (3 points): $m = 0$.\n- Subtask 2 (5 points): $n \\leq 4$.\n- Subtask 3 (8 points): $n \\leq 18$.\n- Subtask 4 (7 points): $m = 2$.\n- Subtask 5 (19 points): $k = 1$.\n- Subtask 6 (27 points): $\\gcd(n,m) \\leq 2$.\n- Subtask 7 (31 points): No special restrictions.\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T6\n\nProblem setter: Imagine\n\n72679\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] 魔力环", "background": "wkr 是一名来自魔力之都的 OIer，他喜欢收集黑色与白色的魔力珠。", "description": "wkr 希望能够得到一个由 $n$ 个魔力珠串成的环。不过他对普通的环并不感兴趣，因此他提出了如下的要求：\n\n- wkr 希望在这个环上，**恰好**有 $m$ 个黑色的魔力珠与 $n - m$ 个白色的魔力珠。\n- 由于 wkr 认为黑色魔力珠不应过于密集，因此 wkr 希望这个环上**不会**出现一段**连续**的黑色魔力珠，其长度**超过** $k$。\n\n在 wkr 的心目中，满足上述要求的环才是美妙的。\n\n不过这样的环可能并不唯一。 wkr 想要知道共有多少种不同的环满足他所提出的要求。然而 wkr 并不喜欢计算，他希望聪明的你能够告诉他答案。\n\n在这里，我们认为**两个环是不同的，当且仅当其中一个环仅通过旋转无法得到另一个环**。\n\n由于答案可能过大，因此输出答案对 $998, 244, 353$ 取模后的结果。", "inputFormat": "输入共 $1$ 行 $3$ 个非负整数 $n, m, k$，其意义见题目描述，相邻的两个数用单个空格隔开。", "outputFormat": "输出共 $1$ 行 $1$ 个整数，表示满足要求的环的数量。", "hint": "#### 样例 $1$ 解释\n\n由 $6$ 个魔力珠串成，满足其中恰好有 $3$ 个黑色魔力珠与 $3$ 个白色魔力珠，且不存在长度超过 $2$ 的连续的黑色魔力珠的不同的环共有 $3$ 种，如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cqi70gls.png)\n\n下图所示的环不满足 wkr 提出的要求，因为在这个环中，存在一段连续的黑色魔力珠，长度超过了 $2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1a5enl8k.png)\n\n### 子任务\n\n所有测试点均满足 $1 \\leq n, k \\leq 10^5, 0 \\leq m \\leq 10^5$ 且 $m \\leq n$。\n\n本题采用捆绑测试，共有 $7$ 个子任务，各子任务的分值和限制如下：\n\n- 子任务 1（3 分）：$m = 0$。\n- 子任务 2（5 分）：$n \\leq 4$。\n- 子任务 3（8 分）：$n \\leq 18$。\n- 子任务 4（7 分）：$m = 2$。\n- 子任务 5（19 分）：$k = 1$。\n- 子任务 6（27 分）：$\\gcd(n,m) \\leq 2$。\n- 子任务 7（31 分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T6\n\n出题人：Imagine\n\n72679", "locale": "zh-CN"}}}
{"pid": "P4917", "type": "P", "difficulty": 6, "samples": [["4\n1\n2\n3\n100", "1\n4\n1296\n18996121"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "枚举", "前缀和", "逆元"], "title": "天守阁的地板", "background": "在下克上异变中，博丽灵梦为了找到异变的源头，一路打到了天守阁。  \n\n异变主谋鬼人正邪为了迎击，将天守阁反复颠倒过来，而年久失修的天守阁也因此掉下了很多块地板。    \n\n异变结束后，恢复了正常大小的小碗回到了天守阁，想要修复这里的地板，她需要知道自己要采购的地板数量(一个惊人的数字)，于是，她找到了精通 $\\text{OI}$ 的你来帮忙。   \n", "description": "为了使万宝槌能发挥出全部魔力，小碗会将买来的地板铺满一个**任意**边长的正方形(地板有图案，因此**不允许旋转**，当然，地板也**不允许重叠**)来达到最大共鸣。  \n\n在每一次购买中，小碗只能买到一种规格为 $a*b$ 的地板，为了省钱，她会在满足能摆成正方形的前提下购买尽可能少的地板。  \n  \n现在，她想知道对于每一对 $a,b(1≤a,b≤n)$ ，她最少需要购买的地板数量。当然，由于输出可能很大，你只需要输出所有答案的乘积对 `19260817` 取模后的结果即可。    ", "inputFormat": "第一行一个整数 $\\text{T}$ ，表示数据组数  \n\n下面 $\\text{T}$ 行，每行一个整数 $n$ ", "outputFormat": "共 $\\text{T}$ 行，每行一个整数，表示取模后的答案", "hint": "#### 样例解释:  \n\n对于`n=1`，$(a,b)$ 仅有 $(1,1)$ 一种情况，只需要一块 $1 * 1$ 的地板即可构成边长为1的正方形,答案为 $1$  \n\n对于`n=2`，$(a,b)$ 有 $(1,1),(1,2),(2,1),(2,2)$ 四种情况，分别需要 $1,2,2,1$ 块地板以拼成正方形，答案为 $1*2*2*1=4$  \n\n进一步解释：  \n\n当只能买到 $1*1$ 的地板时，只需要一块(本身就是正方形)  \n\n当只能买到 $1*2$ 的地板时，需要两块(两块拼在一起组成 $2*2$ 的正方形)  \n  \n#### 数据范围：\n\n对于 $30\\%$ 的数据，$1 \\le T \\le 100,1 \\le n \\le 100$  \n\n对于 $60\\%$ 的数据，$1 \\le T \\le 300,1 \\le n \\le 3*10^4$   \n\n对于 $100\\%$ 的数据，$1 \\le T \\le 1000,1 \\le n \\le 10^6$    ", "locale": "zh-CN", "translations": {"en": {"title": "The Floor of Tenshukaku", "background": "During the “Gekokujou Incident”, Hakurei Reimu fought her way up to Tenshukaku to find the source of the incident.\n\nThe mastermind, Kijin Seija, kept flipping Tenshukaku over and over to fight back, and the old, poorly maintained Tenshukaku ended up losing many floor tiles.\n\nAfter the incident, Sukuna returned to Tenshukaku at her normal size. She wants to repair the floor, but she needs to know how many tiles she must buy (a shocking number). So she asks you, an expert in $\\text{OI}$, for help.", "description": "To make the Miracle Mallet unleash its full power, Sukuna will use the tiles she buys to completely cover a square of **any** side length (because the tiles have patterns, **rotation is not allowed**, and of course tiles are **not allowed to overlap**) to achieve maximum resonance.\n\nIn each purchase, Sukuna can only buy tiles of one fixed size $a*b$. To save money, under the condition that they can form a square, she will buy as few tiles as possible.\n\nNow, for every pair $a,b(1 \\le a,b \\le n)$, she wants to know the minimum number of tiles needed. Of course, since the output may be very large, you only need to output the product of all answers modulo `19260817`.", "inputFormat": "The first line contains an integer $\\text{T}$, the number of test cases.\n\nThe next $\\text{T}$ lines each contain one integer $n$.", "outputFormat": "Output $\\text{T}$ lines in total, each containing one integer, the answer modulo `19260817`.", "hint": "#### Sample Explanation\n\nFor `n=1`, there is only one pair $(a,b)$, namely $(1,1)$. Only one $1*1$ tile is needed to form a square of side length 1, so the answer is $1$.\n\nFor `n=2`, the pairs $(a,b)$ are $(1,1),(1,2),(2,1),(2,2)$. They need $1,2,2,1$ tiles respectively to form a square, so the answer is $1*2*2*1=4$.\n\nFurther explanation:\n\nWhen only $1*1$ tiles are available, only one tile is needed (it is already a square).\n\nWhen only $1*2$ tiles are available, two tiles are needed (two tiles put together form a $2*2$ square).\n\n#### Constraints\n\nFor $30\\%$ of the testdata, $1 \\le T \\le 100, 1 \\le n \\le 100$.\n\nFor $60\\%$ of the testdata, $1 \\le T \\le 300, 1 \\le n \\le 3*10^4$.\n\nFor $100\\%$ of the testdata, $1 \\le T \\le 1000, 1 \\le n \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "天守阁的地板", "background": "在下克上异变中，博丽灵梦为了找到异变的源头，一路打到了天守阁。  \n\n异变主谋鬼人正邪为了迎击，将天守阁反复颠倒过来，而年久失修的天守阁也因此掉下了很多块地板。    \n\n异变结束后，恢复了正常大小的小碗回到了天守阁，想要修复这里的地板，她需要知道自己要采购的地板数量(一个惊人的数字)，于是，她找到了精通 $\\text{OI}$ 的你来帮忙。   \n", "description": "为了使万宝槌能发挥出全部魔力，小碗会将买来的地板铺满一个**任意**边长的正方形(地板有图案，因此**不允许旋转**，当然，地板也**不允许重叠**)来达到最大共鸣。  \n\n在每一次购买中，小碗只能买到一种规格为 $a*b$ 的地板，为了省钱，她会在满足能摆成正方形的前提下购买尽可能少的地板。  \n  \n现在，她想知道对于每一对 $a,b(1≤a,b≤n)$ ，她最少需要购买的地板数量。当然，由于输出可能很大，你只需要输出所有答案的乘积对 `19260817` 取模后的结果即可。    ", "inputFormat": "第一行一个整数 $\\text{T}$ ，表示数据组数  \n\n下面 $\\text{T}$ 行，每行一个整数 $n$ ", "outputFormat": "共 $\\text{T}$ 行，每行一个整数，表示取模后的答案", "hint": "#### 样例解释:  \n\n对于`n=1`，$(a,b)$ 仅有 $(1,1)$ 一种情况，只需要一块 $1 * 1$ 的地板即可构成边长为1的正方形,答案为 $1$  \n\n对于`n=2`，$(a,b)$ 有 $(1,1),(1,2),(2,1),(2,2)$ 四种情况，分别需要 $1,2,2,1$ 块地板以拼成正方形，答案为 $1*2*2*1=4$  \n\n进一步解释：  \n\n当只能买到 $1*1$ 的地板时，只需要一块(本身就是正方形)  \n\n当只能买到 $1*2$ 的地板时，需要两块(两块拼在一起组成 $2*2$ 的正方形)  \n  \n#### 数据范围：\n\n对于 $30\\%$ 的数据，$1 \\le T \\le 100,1 \\le n \\le 100$  \n\n对于 $60\\%$ 的数据，$1 \\le T \\le 300,1 \\le n \\le 3*10^4$   \n\n对于 $100\\%$ 的数据，$1 \\le T \\le 1000,1 \\le n \\le 10^6$    ", "locale": "zh-CN"}}}
{"pid": "P4918", "type": "P", "difficulty": 5, "samples": [["3 7 8\n1 2\n3 2\n2 2\n4 3\n6 4\n1 2\n2 4\n4 5\n2 6\n7 6\n6 4\n3 2\n3 4", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "信仰收集", "background": "随着各种势力的迁入，守矢神社丧失了不少信仰  \n\n现在，为了挽回香火日益惨淡的神社，八坂神奈子派遣神社的风祝早苗去人类村落收集信仰", "description": "你可以将村落看成一个 $m$ 个点的**有向无环图**，其中在某些点上有 $n$ 簇待收集的信仰(每一簇都有一定的数量)，图中有 $k$ 条有向边，每条边的长度均为 $1$ 。   \n\n早苗会从图中的 $1$ 号点出发，在图中的任意一个点停止收集，当早苗在一个有信仰的点的时候，她会将这个点所有的信仰全部收集(包括 $1$ 号点)。  \n\n为了方便，早苗从宇佐见堇子那里学会了瞬移，所以她可以一次移动 $a$ 个单位长度(称为小瞬移)，也可以一次移动 $b$ 个单位长度(称为大瞬移)，分别会花费 $w_a,w_b$点灵力，保证 $a≤b$ ，但由于幻想乡不能被常识所束缚，所以 $w_a$ 不一定小于 $w_b$ 。 \n\n现在，早苗希望你能帮她求出她在村落中能获得的(信仰数量-灵力耗费)的最大值。  \n\n    ", "inputFormat": "第一行三个整数 $n,m,k$ ，表示有信仰的点的数量，点的总数，有向边的条数  \n\n第二行两个整数 $a,b$ ，表示两种瞬移的距离   \n\n第三行两个整数$w_a,w_b$，表示两种瞬移的灵力消耗  \n\n之后 $n$ 行，每行两个正整数 $pos,t$ ，表示每簇信仰所在的位置以及这簇信仰的数量，**不保证** $pos$ 互不相同  \n\n之后 $k$ 行，每行两个整数$u,v$，表示从 $u$ 结点指向 $v$ 结点的一条有向边  \n  \n", "outputFormat": "共一行一个整数 $x$ ，表示(信仰数量-灵力耗费)的最大值  ", "hint": "#### 样例解释:  \n\n图如下所示:\n![](https://cdn.luogu.com.cn/upload/pic/34550.png)   \n\n其中 $2$ 号点有 $2$ 信仰， $4$ 号点有 $3$ 信仰， $6$ 号点有 $4$ 信仰。  \n\n早苗可以瞬移 $1$ 或 $2$ 条边的距离，花费分别为 $3,2$   \n\n最优的方案之一是从 $1$ 花费$2$ 瞬移到 $6$ ，收集了 $6$ 号点的 $4$ 点信仰后停止收集，信仰-消耗 $=2$     \n\n#### 数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/34566.png)", "locale": "zh-CN", "translations": {"en": {"title": "Faith Collection.", "background": "As various forces moved in, Moriya Shrine lost quite a lot of faith.\n\nNow, in order to bring back the shrine’s increasingly declining incense offerings, Yasaka Kanako sends the shrine’s wind priestess Sanae to the Human Village to collect faith.", "description": "You can view the village as a **directed acyclic graph (DAG)** with $m$ nodes. On some nodes there are $n$ clusters of faith to be collected (each cluster has a certain amount). The graph has $k$ directed edges, and each edge has length $1$.\n\nSanae will start from node $1$ and may stop collecting at any node in the graph. When Sanae is at a node that has faith, she will collect **all** the faith on that node (including node $1$).\n\nFor convenience, Sanae learned teleportation from Usami Sumireko, so she can move $a$ units of length at a time (called a small teleport), or move $b$ units of length at a time (called a big teleport). These cost $w_a$ and $w_b$ spirit power respectively. It is guaranteed that $a \\le b$, but since Gensokyo is not bound by common sense, $w_a$ is not necessarily less than $w_b$.\n\nNow, Sanae wants you to help her find the maximum possible value of (amount of faith collected $-$ spirit power cost) she can obtain in the village.", "inputFormat": "The first line contains three integers $n,m,k$, representing the number of nodes with faith, the total number of nodes, and the number of directed edges.\n\nThe second line contains two integers $a,b$, representing the distances of the two types of teleport.\n\nThe third line contains two integers $w_a,w_b$, representing the spirit power costs of the two types of teleport.\n\nThen $n$ lines follow, each with two positive integers $pos,t$, representing the position of a faith cluster and the amount of faith in that cluster. It is **not guaranteed** that all $pos$ are distinct.\n\nThen $k$ lines follow, each with two integers $u,v$, representing a directed edge from node $u$ to node $v$.", "outputFormat": "A single line containing one integer $x$, representing the maximum value of (amount of faith collected $-$ spirit power cost).", "hint": "#### Sample Explanation:\n\nThe graph is as shown below:\n![](https://cdn.luogu.com.cn/upload/pic/34550.png)\n\nNode $2$ has $2$ faith, node $4$ has $3$ faith, and node $6$ has $4$ faith.\n\nSanae can teleport a distance of $1$ or $2$ edges, with costs $3$ and $2$ respectively.\n\nOne optimal plan is to teleport from node $1$ to node $6$ at a cost of $2$, collect the $4$ faith at node $6$, and then stop. Faith $-$ cost $= 2$.\n\n#### Constraints:\n\n![](https://cdn.luogu.com.cn/upload/pic/34566.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "信仰收集", "background": "随着各种势力的迁入，守矢神社丧失了不少信仰  \n\n现在，为了挽回香火日益惨淡的神社，八坂神奈子派遣神社的风祝早苗去人类村落收集信仰", "description": "你可以将村落看成一个 $m$ 个点的**有向无环图**，其中在某些点上有 $n$ 簇待收集的信仰(每一簇都有一定的数量)，图中有 $k$ 条有向边，每条边的长度均为 $1$ 。   \n\n早苗会从图中的 $1$ 号点出发，在图中的任意一个点停止收集，当早苗在一个有信仰的点的时候，她会将这个点所有的信仰全部收集(包括 $1$ 号点)。  \n\n为了方便，早苗从宇佐见堇子那里学会了瞬移，所以她可以一次移动 $a$ 个单位长度(称为小瞬移)，也可以一次移动 $b$ 个单位长度(称为大瞬移)，分别会花费 $w_a,w_b$点灵力，保证 $a≤b$ ，但由于幻想乡不能被常识所束缚，所以 $w_a$ 不一定小于 $w_b$ 。 \n\n现在，早苗希望你能帮她求出她在村落中能获得的(信仰数量-灵力耗费)的最大值。  \n\n    ", "inputFormat": "第一行三个整数 $n,m,k$ ，表示有信仰的点的数量，点的总数，有向边的条数  \n\n第二行两个整数 $a,b$ ，表示两种瞬移的距离   \n\n第三行两个整数$w_a,w_b$，表示两种瞬移的灵力消耗  \n\n之后 $n$ 行，每行两个正整数 $pos,t$ ，表示每簇信仰所在的位置以及这簇信仰的数量，**不保证** $pos$ 互不相同  \n\n之后 $k$ 行，每行两个整数$u,v$，表示从 $u$ 结点指向 $v$ 结点的一条有向边  \n  \n", "outputFormat": "共一行一个整数 $x$ ，表示(信仰数量-灵力耗费)的最大值  ", "hint": "#### 样例解释:  \n\n图如下所示:\n![](https://cdn.luogu.com.cn/upload/pic/34550.png)   \n\n其中 $2$ 号点有 $2$ 信仰， $4$ 号点有 $3$ 信仰， $6$ 号点有 $4$ 信仰。  \n\n早苗可以瞬移 $1$ 或 $2$ 条边的距离，花费分别为 $3,2$   \n\n最优的方案之一是从 $1$ 花费$2$ 瞬移到 $6$ ，收集了 $6$ 号点的 $4$ 点信仰后停止收集，信仰-消耗 $=2$     \n\n#### 数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/34566.png)", "locale": "zh-CN"}}}
{"pid": "P4919", "type": "P", "difficulty": 6, "samples": [["6 3 2\n2 3 2 4 1 2\n1 2\n2 4\n1 6", "2\n3\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "Marisa采蘑菇", "background": "$\\text {Marisa}$ 是一个爱魔法的女孩子，而火力高而华丽的八卦炉正是她常用的武器，随着时代的进步，$\\text {Marisa}$ 也想要升级她的八卦炉的火力，所以她决定去魔法森林采蘑菇来获得做实验的材料。", "description": "$\\text {Marisa}$ 来到了森林之中，看到了一排 $n$ 个五颜六色的蘑菇，这些蘑菇的颜色分别为 $a_1,a_2,\\cdots,a_n$ 。由于她很挑剔，所以她只会采那些“魔法蘑菇”。\n\n一个蘑菇被叫做“魔法蘑菇”，当且仅当它**在给定的某段区间内**，并且在这段给定区间内与它颜色相同的蘑菇(包括它本身)的个数，与在这个给定区间外这种颜色的蘑菇的个数之差小于等于给定的常数 $k$。\n\n现在 $\\text {Marisa}$ 会做出 $m$ 个询问，第 $i$ 个询问中，你需要回答 $[l_i,r_i]$ 中有多少种不同颜色的“魔法蘑菇”。", "inputFormat": "第一行三个整数 $n,m,k$。\n\n第二行 $n$ 个正整数，表示蘑菇的颜色 $a_i$。\n\n之后 $m$ 行，每行两个正整数 $l_i,r_i$ ，表示 $\\text{Marisa}$ 询问区间的左端点和右端点，数据保证 $0 < l_i \\le r_i \\le n$。", "outputFormat": "共 $m$ 行，每行一个整数 $x$ ，表示询问区间中**不同颜色**的“魔法蘑菇”的种数。", "hint": "#### 样例解释：\n\n常数 $k=2$ ，对于区间 $[1,2]$：\n\n$a_1=2$，$2$这种颜色的蘑菇在区间 $[1,2]$ 内出现了 $1$ 次，在区间外出现了 $2$ 次，相差为 $|1-2|=1<2$。\n\n$a_2=3$，$3$这种颜色的蘑菇在区间 $[1,2]$ 内出现了 $1$ 次，在区间外出现了 $0$ 次，相差为 $|1-0|=1<2$。\n\n所以 $[1,2]$ 中有两种颜色不同的魔法蘑菇。\n\n#### 数据范围：\n\n对于全部数据，$1\\le a_i \\le 10^6$，$1 \\le l_i \\le r_i \\le n$。\n\n对于 $20\\%$ 的数据，$1 \\le n,m \\le 100$，$0 \\le k \\le 5$。\n\n对于 $50\\%$ 的数据，$1 \\le n,m \\le 10^5$，$0 \\le k \\le 100$。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 10^6$，$0 \\le k \\le 10^4$。\n\nps: 请注意读入效率。", "locale": "zh-CN", "translations": {"en": {"title": "Marisa Picks Mushrooms", "background": "$\\text {Marisa}$ is a girl who loves magic, and the high-firepower and flashy Bagua Furnace is her commonly used weapon. As time goes on, $\\text {Marisa}$ also wants to upgrade the firepower of her Bagua Furnace, so she decides to go to the Magic Forest to pick mushrooms to obtain materials for experiments.", "description": "$\\text {Marisa}$ arrives in the forest and sees a row of $n$ colorful mushrooms. Their colors are $a_1,a_2,\\cdots,a_n$. Since she is very picky, she will only pick those “magic mushrooms”.\n\nA mushroom is called a “magic mushroom” if and only if it is **within a given interval**, and within this given interval, the difference between the number of mushrooms with the same color as it (including itself) and the number of mushrooms of that color outside this given interval is less than or equal to a given constant $k$.\n\nNow $\\text {Marisa}$ will make $m$ queries. In the $i$-th query, you need to answer how many different colors of “magic mushrooms” there are in $[l_i,r_i]$.", "inputFormat": "The first line contains three integers $n,m,k$.\n\nThe second line contains $n$ positive integers, representing the color $a_i$ of each mushroom.\n\nThen follow $m$ lines, each containing two positive integers $l_i,r_i$, representing the left endpoint and right endpoint of the interval queried by $\\text{Marisa}$. The data guarantees that $0 < l_i \\le r_i \\le n$.", "outputFormat": "Output $m$ lines. Each line contains an integer $x$, representing the number of **different colors** of “magic mushrooms” in the query interval.", "hint": "#### Sample Explanation:\n\nLet the constant $k=2$. For the interval $[1,2]$:\n\n$a_1=2$. Mushrooms of color $2$ appear $1$ time inside $[1,2]$, and $2$ times outside the interval. The difference is $|1-2|=1<2$.\n\n$a_2=3$. Mushrooms of color $3$ appear $1$ time inside $[1,2]$, and $0$ times outside the interval. The difference is $|1-0|=1<2$.\n\nSo there are two different colors of magic mushrooms in $[1,2]$.\n\n#### Constraints:\n\nFor all testdata, $1\\le a_i \\le 10^6$, $1 \\le l_i \\le r_i \\le n$.\n\nFor $20\\%$ of the testdata, $1 \\le n,m \\le 100$, $0 \\le k \\le 5$.\n\nFor $50\\%$ of the testdata, $1 \\le n,m \\le 10^5$, $0 \\le k \\le 100$.\n\nFor $100\\%$ of the testdata, $1 \\le n,m \\le 10^6$, $0 \\le k \\le 10^4$.\n\nps: Please pay attention to input efficiency.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Marisa采蘑菇", "background": "$\\text {Marisa}$ 是一个爱魔法的女孩子，而火力高而华丽的八卦炉正是她常用的武器，随着时代的进步，$\\text {Marisa}$ 也想要升级她的八卦炉的火力，所以她决定去魔法森林采蘑菇来获得做实验的材料。", "description": "$\\text {Marisa}$ 来到了森林之中，看到了一排 $n$ 个五颜六色的蘑菇，这些蘑菇的颜色分别为 $a_1,a_2,\\cdots,a_n$ 。由于她很挑剔，所以她只会采那些“魔法蘑菇”。\n\n一个蘑菇被叫做“魔法蘑菇”，当且仅当它**在给定的某段区间内**，并且在这段给定区间内与它颜色相同的蘑菇(包括它本身)的个数，与在这个给定区间外这种颜色的蘑菇的个数之差小于等于给定的常数 $k$。\n\n现在 $\\text {Marisa}$ 会做出 $m$ 个询问，第 $i$ 个询问中，你需要回答 $[l_i,r_i]$ 中有多少种不同颜色的“魔法蘑菇”。", "inputFormat": "第一行三个整数 $n,m,k$。\n\n第二行 $n$ 个正整数，表示蘑菇的颜色 $a_i$。\n\n之后 $m$ 行，每行两个正整数 $l_i,r_i$ ，表示 $\\text{Marisa}$ 询问区间的左端点和右端点，数据保证 $0 < l_i \\le r_i \\le n$。", "outputFormat": "共 $m$ 行，每行一个整数 $x$ ，表示询问区间中**不同颜色**的“魔法蘑菇”的种数。", "hint": "#### 样例解释：\n\n常数 $k=2$ ，对于区间 $[1,2]$：\n\n$a_1=2$，$2$这种颜色的蘑菇在区间 $[1,2]$ 内出现了 $1$ 次，在区间外出现了 $2$ 次，相差为 $|1-2|=1<2$。\n\n$a_2=3$，$3$这种颜色的蘑菇在区间 $[1,2]$ 内出现了 $1$ 次，在区间外出现了 $0$ 次，相差为 $|1-0|=1<2$。\n\n所以 $[1,2]$ 中有两种颜色不同的魔法蘑菇。\n\n#### 数据范围：\n\n对于全部数据，$1\\le a_i \\le 10^6$，$1 \\le l_i \\le r_i \\le n$。\n\n对于 $20\\%$ 的数据，$1 \\le n,m \\le 100$，$0 \\le k \\le 5$。\n\n对于 $50\\%$ 的数据，$1 \\le n,m \\le 10^5$，$0 \\le k \\le 100$。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 10^6$，$0 \\le k \\le 10^4$。\n\nps: 请注意读入效率。", "locale": "zh-CN"}}}
{"pid": "P4920", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "提交答案", "Special Judge", "WC"], "title": "[WC2015] 未来程序", "background": "", "description": "在 2047 年，第 64 届全国青少年信息学奥林匹克冬令营前夕，B君找到了 2015 年，第 32 届冬令营的题目来练习。\n\n他打开了第三题 “未来程序” 这道题目：\n\n```\n本题是一道提交答案题，一共 10 个测试点。\n对于每个测试点，你会得到一段程序的源代码和这段程序的输入。你要运行这个程序，并保存这个程序的输出。\n遗憾的是这些程序都效率极其低下，无法在比赛的 5 个小时内得到输出。\n```\nB君想了一下，决定用 2047 年的计算机来试着运行这个题目，他找到了 2015 年的编译器，并很快得到了结果……\n\n这时B君从梦中惊醒，发现自己居然在第 32 届冬令营赛场上。之前的一切只是南柯一梦，而自己正需要解决“未来程序”这道题目。\n\n然而B君已经记不清梦中的程序运行的结果了，他试图再次运行这些程序。但是他发现计算机性能比梦里的差多了，程序确实都无法在 5 小时内得到结果。\n\n他需要你的帮助，来得到那些梦中的结果。\n\n本题是一道提交答案题，一共有 10 个测试点。\n\n对于每个测试点，你会得到一段程序的源代码和这段程序的输入。你要运行这个程序，并保存这个程序的输出。\n\n遗憾的是这些程序效率都极其低下，无法在比赛的 5 小时内得到输出。\n\n你需要帮助B君得到这些程序的输出。", "inputFormat": "本题一共有 10 个测试点，编号为 1～10。以下用 “``*``” 表示测试点编号。\n\n对于每个测试点有 4 个文件，分别是 program``*``.cpp 文件，program``*``.c 文件，program``*``.pas 文件，program``*``.in 文件。\n\n你需要用自己的方法，得到以 program``*``.in 作为输入，编译运行 program``*``.{cpp, c, pas} 的输出。\n\n你只需要在 3 种语言的代码中选择 1 种来解这道题目。这 3 种语言的代码在语意上是类似的，运行结果是相同的。", "outputFormat": "对于给出的 10 个测试点，你需要将程序的输出分别保存在 program``*``.out 中。\n\n特别地，我们保证每个测试点一定会输出恰好 10 行。", "hint": "请下载输入数据。样例输入见 example.{in,cpp,c,pas}，样例输出见 example.ans。\n\n**为了好写spj，略微修改评分规则**\n\n每个测试点单独评分。\n\n对于每行单独评分，如果该行与标准答案相同，可以得 1 分。\n\n如果你的输出不足 10 行，我们会在你的输出末尾添加空行补齐 10 行。\n\n如果你的输出超过 10 行，我们会取出你的前 10 行作为输出。", "locale": "zh-CN", "translations": {"en": {"title": "[WC2015] Future Program", "background": "", "description": "In 2047, on the eve of the 64th National Olympiad in Informatics Winter Camp for Youth, person B found the problems from 2015, the 32nd Winter Camp, to practice.\n\nHe opened the third problem, “Future Program”:\n\n```\nThis is an output-only problem with a total of 10 test points.\nFor each test point, you will be given the source code of a program and the input for that program. You need to run the program and save its output.\nUnfortunately, these programs are extremely inefficient and cannot produce output within the 5 hours of the contest.\n```\n\nPerson B thought for a moment and decided to try running this problem using a computer from 2047. He found the 2015 compiler and soon got the results...\n\nAt this moment, person B woke up from the dream and found that he was actually at the contest site of the 32nd Winter Camp. Everything before was just a dream, and he now needed to solve the problem “Future Program”.\n\nHowever, person B could no longer remember the results of running the programs in the dream. He tried to run these programs again, but found that the computer’s performance was far worse than in the dream, and indeed the programs could not produce results within 5 hours.\n\nHe needs your help to obtain the results from the dream.\n\nThis is an output-only problem with a total of 10 test points.\n\nFor each test point, you will be given the source code of a program and the input for that program. You need to run the program and save the program’s output.\n\nUnfortunately, these programs are extremely inefficient and cannot produce output within the 5 hours of the contest.\n\nYou need to help person B obtain the output of these programs.", "inputFormat": "This problem has a total of 10 test points, numbered from 1 to 10. Below, “``*``” represents the test point number.\n\nFor each test point, there are 4 files: program``*``.cpp, program``*``.c, program``*``.pas, and program``*``.in.\n\nYou need to use your own method to obtain the output of compiling and running program``*``.{cpp, c, pas} with program``*``.in as the input.\n\nYou only need to choose 1 of the 3 language versions to solve this problem. The code in these 3 languages is similar in meaning, and the running results are the same.", "outputFormat": "For the given 10 test points, you need to save the program output into program``*``.out respectively.\n\nIn particular, we guarantee that each test point will output exactly 10 lines.", "hint": "Please download the input data. The sample input is in example.{in,cpp,c,pas}, and the sample output is in example.ans.\n\n**To make the SPJ easier to write, the scoring rules are slightly modified.**\n\nEach test point is scored independently.\n\nEach line is scored independently. If that line is the same as the standard answer, you can get 1 point.\n\nIf your output has fewer than 10 lines, we will add empty lines at the end of your output to make it 10 lines.\n\nIf your output has more than 10 lines, we will take the first 10 lines as the output.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2015] 未来程序", "background": "", "description": "在 2047 年，第 64 届全国青少年信息学奥林匹克冬令营前夕，B君找到了 2015 年，第 32 届冬令营的题目来练习。\n\n他打开了第三题 “未来程序” 这道题目：\n\n```\n本题是一道提交答案题，一共 10 个测试点。\n对于每个测试点，你会得到一段程序的源代码和这段程序的输入。你要运行这个程序，并保存这个程序的输出。\n遗憾的是这些程序都效率极其低下，无法在比赛的 5 个小时内得到输出。\n```\nB君想了一下，决定用 2047 年的计算机来试着运行这个题目，他找到了 2015 年的编译器，并很快得到了结果……\n\n这时B君从梦中惊醒，发现自己居然在第 32 届冬令营赛场上。之前的一切只是南柯一梦，而自己正需要解决“未来程序”这道题目。\n\n然而B君已经记不清梦中的程序运行的结果了，他试图再次运行这些程序。但是他发现计算机性能比梦里的差多了，程序确实都无法在 5 小时内得到结果。\n\n他需要你的帮助，来得到那些梦中的结果。\n\n本题是一道提交答案题，一共有 10 个测试点。\n\n对于每个测试点，你会得到一段程序的源代码和这段程序的输入。你要运行这个程序，并保存这个程序的输出。\n\n遗憾的是这些程序效率都极其低下，无法在比赛的 5 小时内得到输出。\n\n你需要帮助B君得到这些程序的输出。", "inputFormat": "本题一共有 10 个测试点，编号为 1～10。以下用 “``*``” 表示测试点编号。\n\n对于每个测试点有 4 个文件，分别是 program``*``.cpp 文件，program``*``.c 文件，program``*``.pas 文件，program``*``.in 文件。\n\n你需要用自己的方法，得到以 program``*``.in 作为输入，编译运行 program``*``.{cpp, c, pas} 的输出。\n\n你只需要在 3 种语言的代码中选择 1 种来解这道题目。这 3 种语言的代码在语意上是类似的，运行结果是相同的。", "outputFormat": "对于给出的 10 个测试点，你需要将程序的输出分别保存在 program``*``.out 中。\n\n特别地，我们保证每个测试点一定会输出恰好 10 行。", "hint": "请下载输入数据。样例输入见 example.{in,cpp,c,pas}，样例输出见 example.ans。\n\n**为了好写spj，略微修改评分规则**\n\n每个测试点单独评分。\n\n对于每行单独评分，如果该行与标准答案相同，可以得 1 分。\n\n如果你的输出不足 10 行，我们会在你的输出末尾添加空行补齐 10 行。\n\n如果你的输出超过 10 行，我们会取出你的前 10 行作为输出。", "locale": "zh-CN"}}}
{"pid": "P4921", "type": "P", "difficulty": 6, "samples": [["2\n1\n2\n", "0\n2\n16\n0\n8\n"]], "limits": {"time": [1000], "memory": [512000]}, "tags": ["数学", "2018", "洛谷原创", "O2优化", "组合数学"], "title": "[MtOI2018] 情侣？给我烧了！", "background": "FFF\n\n本题加强版：[P4931](https://www.luogu.com.cn/problem/P4931)", "description": "有 $n$ 对情侣来到电影院观看电影。在电影院，恰好留有 $n$ 排座位，每排包含 $2$ 个座位，共 $2×n$ 个座位。\n\n现在，每个人将会随机坐在某一个位置上，且恰好将这 $2 × n$ 个座位坐满。\n\n如果一对情侣坐在了同一排的座位上，那么我们称这对情侣是和睦的。\n\n你的任务是求出当 $k = 0, 1, ... , n$ 时，共有多少种不同的就坐方案满足**恰好**有 $k$ 对情侣是和睦的。\n\n两种就坐方案不同当且仅当存在一个人在两种方案中坐在了不同的位置。不难发现，一共会有 $(2n)!$ 种不同的就坐方案。\n\n由于结果可能较大，因此输出对 $998244353$ 取模的结果。", "inputFormat": "输入包含多组数据。\n\n输入的第 $1$ 行包含 $1$ 个正整数 $T(1 \\leq T \\leq 1000)$，表示数据的组数。\n\n接下来 $T$ 行，每行包含 $1$ 个正整数 $n(1 \\leq n \\leq 1000)$。", "outputFormat": "对于每组输入数据，输出共 $n + 1$ 行，每行包含 $1$ 个整数，分别表示 $k = 0, 1, ..., n$ 时满足恰好有 $k$ 对情侣是和睦的就坐方案数。\n", "hint": "### 子任务\n\n本题只有一个 $T=1000$ 的数据点。。。暴力还是算了吧！      \n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2\n\n出题人：Imagine\n\n50167", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] Couples? Burn Them for Me!", "background": "FFF.\n\nEnhanced version of this problem: [P4931](https://www.luogu.com.cn/problem/P4931).", "description": "There are $n$ couples who come to a cinema to watch a movie. In the cinema, there are exactly $n$ rows of seats, and each row contains $2$ seats, so there are $2 \\times n$ seats in total.\n\nNow, each person will randomly sit in one seat, and all $2 \\times n$ seats will be occupied.\n\nIf a couple sits in the same row, then we call this couple harmonious.\n\nYour task is to compute, for $k = 0, 1, \\ldots, n$, how many different seating arrangements satisfy that there are **exactly** $k$ harmonious couples.\n\nTwo seating arrangements are different if and only if there exists at least one person who sits in a different seat in the two arrangements. It is easy to see that there are $(2n)!$ different seating arrangements in total.\n\nSince the answer may be large, output the result modulo $998244353$.", "inputFormat": "The input contains multiple test cases.\n\nThe first line contains one positive integer $T(1 \\leq T \\leq 1000)$, indicating the number of test cases.\n\nThe next $T$ lines each contain one positive integer $n(1 \\leq n \\leq 1000)$.", "outputFormat": "For each test case, output a total of $n + 1$ lines. Each line contains one integer, which represents the number of seating arrangements with exactly $k$ harmonious couples for $k = 0, 1, \\ldots, n$.", "hint": "### Subtasks\n\nThis problem has only one test point with $T = 1000$... so forget brute force!\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2.\n\nProblem setter: Imagine.\n\n50167.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] 情侣？给我烧了！", "background": "FFF\n\n本题加强版：[P4931](https://www.luogu.com.cn/problem/P4931)", "description": "有 $n$ 对情侣来到电影院观看电影。在电影院，恰好留有 $n$ 排座位，每排包含 $2$ 个座位，共 $2×n$ 个座位。\n\n现在，每个人将会随机坐在某一个位置上，且恰好将这 $2 × n$ 个座位坐满。\n\n如果一对情侣坐在了同一排的座位上，那么我们称这对情侣是和睦的。\n\n你的任务是求出当 $k = 0, 1, ... , n$ 时，共有多少种不同的就坐方案满足**恰好**有 $k$ 对情侣是和睦的。\n\n两种就坐方案不同当且仅当存在一个人在两种方案中坐在了不同的位置。不难发现，一共会有 $(2n)!$ 种不同的就坐方案。\n\n由于结果可能较大，因此输出对 $998244353$ 取模的结果。", "inputFormat": "输入包含多组数据。\n\n输入的第 $1$ 行包含 $1$ 个正整数 $T(1 \\leq T \\leq 1000)$，表示数据的组数。\n\n接下来 $T$ 行，每行包含 $1$ 个正整数 $n(1 \\leq n \\leq 1000)$。", "outputFormat": "对于每组输入数据，输出共 $n + 1$ 行，每行包含 $1$ 个整数，分别表示 $k = 0, 1, ..., n$ 时满足恰好有 $k$ 对情侣是和睦的就坐方案数。\n", "hint": "### 子任务\n\n本题只有一个 $T=1000$ 的数据点。。。暴力还是算了吧！      \n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2\n\n出题人：Imagine\n\n50167", "locale": "zh-CN"}}}
{"pid": "P4922", "type": "P", "difficulty": 6, "samples": [["1\n1000 100", "120\nMiHoYo Was Destroyed!"], ["10\n1000 0", "0\nMiHoYo Was Destroyed!"], ["10\n198 100", "2\nTech Otakus Save The World!"], ["3\n23333 100", "440\nMiHoYo Was Destroyed!"], ["100\n19260817 2330", "99\nTech Otakus Save The World!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "贪心", "2018", "洛谷原创", "O2优化"], "title": "[MtOI2018] 崩坏3？非酋之战！", "background": "原题面因为太丑，被 disangan233 于 2019/09/26 修改。\n\n在 2018 年暑假的时候，disangan233 肝了一个暑假的崩坏 3，他的帐号终于 $50$ 级啦！他终于把他的逆神巫女肝到 S 啦！\n\n因为庆祝崩坏 3 登上 APP Store Top1，米忽悠给全服玩家发放了 $5$ 张扩充补给卡。\n\n在玄学233聊天室发送了 \"怒 grass 大伟出奇迹！\" 之后就……单抽出律化娜了。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sk8m049a.png)", "description": "在崩坏 3 中有一个叫做天命基地的地方，女武神们将在基地中~~开派对~~与敌人们厮杀。\n\n女武神们的攻击力为 $atk$，她们将进行资源保卫战！\n\n天命基地中有 $1$个 boss，boss 的血量为 $hp$，boss 不会攻击女武神。\n\n现在有一条长度为 $n$ 的道路，道路的一头是 boss，另外一头是女武神需要保卫的资源，最开始 boss 每秒将会向资源移动 1 个单位长度。女武神们需要保护资源，所以她们要攻击 boss。 \n\n我们将整条道路分成 $n$ 个格子，最开始资源在第 $n$ 格，女武神在第 $1$ 格，boss 在第 $0$ 格。\n\n因为女武神的手太短了，所以只有当 boss 到达女武神当前那一格的时候，女武神才会攻击 boss，攻击完之后女武神会后退一格。\n\n女武神有以下 $8$ 种攻击方式（每一格只能使用一种攻击方式）        \n\n* 技能，造成 $80\\% atk$ 的伤害，并使 boss 获得 $1$ 层燃烧 buff，在之后的每秒钟额外受到 $10\\% atk$ 的伤害。(燃烧buff可以叠加)        \n* 闪避，造成 $70\\% atk$ 的伤害，并使 boss 时间暂停 $5s$。（$5s$ 内 boss 无法移动且仍会受到燃烧伤害）      \n* 大招，造成 $120\\% atk$ 的伤害，使 boss 时间暂停 $5s$。       \n* 分支攻击，造成 $70\\% atk$ 的伤害，并使 boss 时空减速，使 boss 经过每一个格子的时间增加 $1s$。    \n* 爱酱的炸弹，使 boss 获得 $1$ 层燃烧 buff，并使 boss 愤怒，移速 $+50\\%$。     \n* 犹大的誓约，造成 $60\\% atk$ 的伤害，如果 boss 有燃烧 buff 则减少 1 层，使 boss 时间暂停 $4s$。       \n* 奥托之光，造成 $10\\% atk$ 的伤害，如果 boss 有燃烧 buff 则清除 buff，使 boss 时间暂停 $10s$。     \n* 律者之力，造成 $80\\% atk$ 的伤害，使 boss 的移动速度 $+100\\%$。\n\n现在给你所有的信息，让你帮助 disangan233 蒟蒻算一下，他的女武神能否在 boss 触碰到资源前战胜 boss。\n\n如果可以，输出 boss 死亡时距离资源最远的格子编号。如果不可以，请输出对 boss 造成的最大伤害。", "inputFormat": "输入共 $2$ 行。   \n\n第 $1$ 行输入 $1$ 个正整数 $n$。    \n\n第 $2$ 行输入 $2$ 个正整数，表示 boss 的血量 $hp$ 和女武神的攻击力 $atk$ 。", "outputFormat": "输出共 $2$ 行。\n\n第 $1$ 行输出 boss 死亡时距离资源最远的格子编号或者最大总伤害值 $\\max Atk$。    \n\n如果 boss 死亡，请在第 $2$ 行输出 `Tech Otakus Save The World!`。   \n\n如果 boss 到达了资源所在格子，请在第 $2$ 行输出 `MiHoYo Was Destroyed!`。 \n\n注：数据保证没有 boss 在资源所在格子死亡的情况。", "hint": "#### 样例解释 $3$\n\n开局 1 个技能，再来 1 个大招。\n\n#### 样例解释 $4$\n\n开局 1 个技能，再来 2 个大招。\n\n### 子任务\n\n对于 $10\\%$ 的数据，保证：\n\n$$\nn\\leq 10 \\qquad  \\max Atk\\leq 10^{7}-1\n$$     \n\n对于 $20\\%$ 的数据，保证：\n\n$$\nn\\leq 300 \\qquad \\max Atk\\leq 2^{32}-1\n$$     \n\n对于 $40\\%$ 的数据，保证：\n\n$$\nn\\leq 1,000 \\qquad \\max Atk\\leq 2^{63}-1\n$$     \n对于 $70\\%$ 的数据，保证：\n\n$$\nn\\leq 5,000 \\qquad \\max Atk\\leq 2^{63}-1\n$$  \n\n对于 $100\\%$ 的数据，保证：\n\n$$\nn\\leq 10,000 \\qquad atk\\equiv 0(\\bmod\\ 10)\\qquad  atk\\leq {10}^6\\qquad \\max Atk\\leq 2^{64}-1\n$$  \n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](/contest/11260) T4\n\n出题人：disangan233\n\n验题人：CYJian\n\n72679", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] Honkai 3rd? The Unlucky Player’s Battle!", "background": "The original statement was too ugly, so it was modified by disangan233 on 2019/09/26.\n\nDuring the summer vacation of 2018, disangan233 grinded Honkai 3rd for the whole summer, and his account finally reached level $50$! He finally grinded his “Gyakushin Miko (逆神巫女)” to S rank!\n\nTo celebrate Honkai 3rd reaching APP Store Top1, miHoYo handed out $5$ Expansion Supply Cards to all players on the server.\n\nAfter sending \"怒 grass 大伟出奇迹！\" in the “Xuánxué233 (玄学233)” chatroom, then… he single-pulled Herrscher Kiana (律化娜).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sk8m049a.png)", "description": "In Honkai 3rd, there is a place called the Schicksal Base, where Valkyries will ~~throw a party~~ fight enemies inside the base.\n\nThe Valkyries’ attack power is $atk$, and they will fight to defend resources.\n\nThere is $1$ boss in the Schicksal Base. The boss has health $hp$, and the boss will not attack the Valkyries.\n\nNow there is a road of length $n$. One end is the boss, and the other end is the resources that the Valkyries must protect. At the beginning, the boss will move toward the resources at a speed of $1$ unit length per second. The Valkyries need to protect the resources, so they must attack the boss.\n\nWe divide the whole road into $n$ cells. Initially, the resources are in cell $n$, the Valkyrie is in cell $1$, and the boss is in cell $0$.\n\nBecause the Valkyrie’s arms are too short, she will attack the boss only when the boss reaches the cell where the Valkyrie currently is. After attacking, the Valkyrie will retreat by one cell.\n\nThe Valkyrie has the following $8$ attack methods (each cell can use only one attack method).\n\n* Skill: deal $80\\% atk$ damage, and give the boss $1$ stack of burning buff. In each subsequent second, the boss additionally takes $10\\% atk$ damage. (Burning buff stacks.)\n* Dodge: deal $70\\% atk$ damage, and time-stop the boss for $5s$. (During these $5s$, the boss cannot move and still takes burning damage.)\n* Ultimate: deal $120\\% atk$ damage, and time-stop the boss for $5s$.\n* Branch attack: deal $70\\% atk$ damage, and apply space-time slow. The time for the boss to pass through each cell increases by $1s$.\n* Ai-chan’s bomb: give the boss $1$ stack of burning buff, and make the boss enraged, movement speed $+50\\%$.\n* Judah’s Oath: deal $60\\% atk$ damage. If the boss has a burning buff, reduce it by $1$ stack. Time-stop the boss for $4s$.\n* Otto’s Light: deal $10\\% atk$ damage. If the boss has a burning buff, clear the buff. Time-stop the boss for $10s$.\n* Herrscher’s Power: deal $80\\% atk$ damage, and increase the boss’s movement speed by $+100\\%$.\n\nNow you are given all the information. Help the newbie disangan233 calculate whether his Valkyrie can defeat the boss before the boss touches the resources.\n\nIf she can, output the cell index that is farthest from the resources when the boss dies. If she cannot, output the maximum damage dealt to the boss.", "inputFormat": "The input has $2$ lines.\n\nLine $1$ contains $1$ positive integer $n$.\n\nLine $2$ contains $2$ positive integers, the boss’s health $hp$ and the Valkyrie’s attack power $atk$.", "outputFormat": "The output has $2$ lines.\n\nLine $1$ outputs the cell index that is farthest from the resources when the boss dies, or the maximum total damage $\\max Atk$.\n\nIf the boss dies, output `Tech Otakus Save The World!` on line $2$.\n\nIf the boss reaches the cell where the resources are, output `MiHoYo Was Destroyed!` on line $2$.\n\nNote: The testdata guarantees that there is no case where the boss dies on the resources cell.", "hint": "#### Sample Explanation $3$\n\nUse $1$ Skill at the start, then use $1$ Ultimate.\n\n#### Sample Explanation $4$\n\nUse $1$ Skill at the start, then use $2$ Ultimates.\n\n### Subtasks\n\nFor $10\\%$ of the data, it is guaranteed that:\n\n$$\nn\\leq 10 \\qquad  \\max Atk\\leq 10^{7}-1\n$$\n\nFor $20\\%$ of the data, it is guaranteed that:\n\n$$\nn\\leq 300 \\qquad \\max Atk\\leq 2^{32}-1\n$$\n\nFor $40\\%$ of the data, it is guaranteed that:\n\n$$\nn\\leq 1,000 \\qquad \\max Atk\\leq 2^{63}-1\n$$\n\nFor $70\\%$ of the data, it is guaranteed that:\n\n$$\nn\\leq 5,000 \\qquad \\max Atk\\leq 2^{63}-1\n$$\n\nFor $100\\%$ of the data, it is guaranteed that:\n\n$$\nn\\leq 10,000 \\qquad atk\\equiv 0(\\bmod\\ 10)\\qquad  atk\\leq {10}^6\\qquad \\max Atk\\leq 2^{64}-1\n$$\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](/contest/11260) T4\n\nProblem setter: disangan233\n\nProblem verifier: CYJian\n\n72679\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] 崩坏3？非酋之战！", "background": "原题面因为太丑，被 disangan233 于 2019/09/26 修改。\n\n在 2018 年暑假的时候，disangan233 肝了一个暑假的崩坏 3，他的帐号终于 $50$ 级啦！他终于把他的逆神巫女肝到 S 啦！\n\n因为庆祝崩坏 3 登上 APP Store Top1，米忽悠给全服玩家发放了 $5$ 张扩充补给卡。\n\n在玄学233聊天室发送了 \"怒 grass 大伟出奇迹！\" 之后就……单抽出律化娜了。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sk8m049a.png)", "description": "在崩坏 3 中有一个叫做天命基地的地方，女武神们将在基地中~~开派对~~与敌人们厮杀。\n\n女武神们的攻击力为 $atk$，她们将进行资源保卫战！\n\n天命基地中有 $1$个 boss，boss 的血量为 $hp$，boss 不会攻击女武神。\n\n现在有一条长度为 $n$ 的道路，道路的一头是 boss，另外一头是女武神需要保卫的资源，最开始 boss 每秒将会向资源移动 1 个单位长度。女武神们需要保护资源，所以她们要攻击 boss。 \n\n我们将整条道路分成 $n$ 个格子，最开始资源在第 $n$ 格，女武神在第 $1$ 格，boss 在第 $0$ 格。\n\n因为女武神的手太短了，所以只有当 boss 到达女武神当前那一格的时候，女武神才会攻击 boss，攻击完之后女武神会后退一格。\n\n女武神有以下 $8$ 种攻击方式（每一格只能使用一种攻击方式）        \n\n* 技能，造成 $80\\% atk$ 的伤害，并使 boss 获得 $1$ 层燃烧 buff，在之后的每秒钟额外受到 $10\\% atk$ 的伤害。(燃烧buff可以叠加)        \n* 闪避，造成 $70\\% atk$ 的伤害，并使 boss 时间暂停 $5s$。（$5s$ 内 boss 无法移动且仍会受到燃烧伤害）      \n* 大招，造成 $120\\% atk$ 的伤害，使 boss 时间暂停 $5s$。       \n* 分支攻击，造成 $70\\% atk$ 的伤害，并使 boss 时空减速，使 boss 经过每一个格子的时间增加 $1s$。    \n* 爱酱的炸弹，使 boss 获得 $1$ 层燃烧 buff，并使 boss 愤怒，移速 $+50\\%$。     \n* 犹大的誓约，造成 $60\\% atk$ 的伤害，如果 boss 有燃烧 buff 则减少 1 层，使 boss 时间暂停 $4s$。       \n* 奥托之光，造成 $10\\% atk$ 的伤害，如果 boss 有燃烧 buff 则清除 buff，使 boss 时间暂停 $10s$。     \n* 律者之力，造成 $80\\% atk$ 的伤害，使 boss 的移动速度 $+100\\%$。\n\n现在给你所有的信息，让你帮助 disangan233 蒟蒻算一下，他的女武神能否在 boss 触碰到资源前战胜 boss。\n\n如果可以，输出 boss 死亡时距离资源最远的格子编号。如果不可以，请输出对 boss 造成的最大伤害。", "inputFormat": "输入共 $2$ 行。   \n\n第 $1$ 行输入 $1$ 个正整数 $n$。    \n\n第 $2$ 行输入 $2$ 个正整数，表示 boss 的血量 $hp$ 和女武神的攻击力 $atk$ 。", "outputFormat": "输出共 $2$ 行。\n\n第 $1$ 行输出 boss 死亡时距离资源最远的格子编号或者最大总伤害值 $\\max Atk$。    \n\n如果 boss 死亡，请在第 $2$ 行输出 `Tech Otakus Save The World!`。   \n\n如果 boss 到达了资源所在格子，请在第 $2$ 行输出 `MiHoYo Was Destroyed!`。 \n\n注：数据保证没有 boss 在资源所在格子死亡的情况。", "hint": "#### 样例解释 $3$\n\n开局 1 个技能，再来 1 个大招。\n\n#### 样例解释 $4$\n\n开局 1 个技能，再来 2 个大招。\n\n### 子任务\n\n对于 $10\\%$ 的数据，保证：\n\n$$\nn\\leq 10 \\qquad  \\max Atk\\leq 10^{7}-1\n$$     \n\n对于 $20\\%$ 的数据，保证：\n\n$$\nn\\leq 300 \\qquad \\max Atk\\leq 2^{32}-1\n$$     \n\n对于 $40\\%$ 的数据，保证：\n\n$$\nn\\leq 1,000 \\qquad \\max Atk\\leq 2^{63}-1\n$$     \n对于 $70\\%$ 的数据，保证：\n\n$$\nn\\leq 5,000 \\qquad \\max Atk\\leq 2^{63}-1\n$$  \n\n对于 $100\\%$ 的数据，保证：\n\n$$\nn\\leq 10,000 \\qquad atk\\equiv 0(\\bmod\\ 10)\\qquad  atk\\leq {10}^6\\qquad \\max Atk\\leq 2^{64}-1\n$$  \n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](/contest/11260) T4\n\n出题人：disangan233\n\n验题人：CYJian\n\n72679", "locale": "zh-CN"}}}
{"pid": "P4923", "type": "P", "difficulty": 6, "samples": [["3 2 0\n1\n1 1\n1\n2 3\n3\n1 2 20\n1 3 20\n3 2 1\n0\n0\n1\n", "20"], ["3 2 0\n1\n1 1\n1\n2 3\n3\n1 2 1\n1 3 20\n3 2 20\n1 2\n0\n1", "40"]], "limits": {"time": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "memory": [20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000]}, "tags": ["2018", "洛谷原创", "O2优化", "枚举", "最短路", "状压 DP"], "title": "[MtOI2018] gcd？人生赢家！", "background": "gcd 是一个热爱游戏的人。", "description": "gcd 最近在玩一个有趣的游戏。\n\n我们把这个游戏抽象成一张图，图上有 $n$ 个点，gcd 需要寻找总计 $m$ 件宝物，它们分布在图上。\n\n对于每件宝物而言，将会有一个前置集合 $S$。只有当取得所有前置宝物时，才能获得该宝物。\n\ngcd 拥有一件神器，这件神器具有传送功能，它可以使用 $k$ 次，可以传送到一个任意节点。\n\n对于游戏而言，肯定会有额外的成就，这些成就会奖励一定的传送次数，成就的达成是满足集合 $S$ 的一瞬间。\n\n现在 gcd 想知道能最快通关的方法，请你求出通关的最少时间。", "inputFormat": "输入共 $s+m+e+6$ 行。\n\n第 $1$ 行输入 $3$ 个正整数 $n,m,k$。\n\n第 $2$ 行输入 $1$ 个正整数 $s$ 表示成就的数量。\n\n以下 $s$ 行每行输入 $1$ 个非负整数 $num$ 表示需求多少个宝物，然后输入 $num$ 个数，为所需宝物编号。\n\n第 $s+3$ 行输入 $s$ 个正整数 $a_1,a_2,\\cdots a_s$ 表示成就的奖励次数。\n\n第 $s+4$ 行输入 $m$ 个正整数 $p_1,p_2,\\cdots p_m$ 表示宝物的位置。\n\n第 $s+5$ 行输入 $1$ 个正整数 $e$ 表示边的总数。\n\n以下 $e$ 行每行输入 $3$ 个正整数 $x,y,z$ 表示 $x$ 与 $y$ 之间有一条边权为 $z$ 的无向边连接。\n\n以下 $m$ 行每行输入 $1$ 个非负整数 $num$ 表示宝物前置要求个数，然后输入 $num$ 个数，为要求的编号。\n\n最后一行输入 $1$ 个正整数 $st$ 表示起点。", "outputFormat": "输出共 $1$ 行 $1$ 个正整数，输出最少时间。", "hint": "### 子任务\n\n对于 $20\\%$ 的数据，$s=0$。\n\n对于 $100\\%$ 的数据，$n\\leq 200$，$m\\leq 12$，$k\\leq 4$，$s\\leq 8$，$e\\leq 20000$ ，奖励次数总和不超过 $8$，保证每两个宝物的位置不相同，可能有重边，保证有解。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T5\n\n出题人：b2019dy\n\n78488", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] gcd? A Winner in Life!", "background": "gcd is a person who loves games.", "description": "gcd has recently been playing an interesting game.\n\nWe abstract this game into a graph with $n$ nodes. gcd needs to find a total of $m$ treasures, which are distributed on the graph.\n\nFor each treasure, there is a prerequisite set $S$. Only after obtaining all prerequisite treasures can this treasure be obtained.\n\ngcd has a divine artifact. This artifact can teleport, and it can be used $k$ times. Each time, it can teleport to any node.\n\nIn this game, there are also extra achievements. These achievements reward a certain number of teleport uses. An achievement is completed at the instant when the set $S$ is satisfied.\n\nNow gcd wants to know the fastest way to clear the game. Please find the minimum time needed to clear it.", "inputFormat": "The input has a total of $s+m+e+6$ lines.\n\nLine $1$ contains $3$ positive integers $n,m,k$.\n\nLine $2$ contains $1$ positive integer $s$, the number of achievements.\n\nIn the next $s$ lines, each line starts with $1$ non-negative integer $num$, meaning how many treasures are required, followed by $num$ integers, which are the IDs of the required treasures.\n\nLine $s+3$ contains $s$ positive integers $a_1,a_2,\\cdots a_s$, meaning the reward counts of the achievements.\n\nLine $s+4$ contains $m$ positive integers $p_1,p_2,\\cdots p_m$, meaning the positions of the treasures.\n\nLine $s+5$ contains $1$ positive integer $e$, the total number of edges.\n\nIn the next $e$ lines, each line contains $3$ positive integers $x,y,z$, meaning there is an undirected edge between $x$ and $y$ with weight $z$.\n\nIn the next $m$ lines, each line starts with $1$ non-negative integer $num$, meaning the number of prerequisites for the treasure, followed by $num$ integers, which are the IDs of the required treasures.\n\nThe last line contains $1$ positive integer $st$, the starting node.", "outputFormat": "Output $1$ line with $1$ positive integer: the minimum time.", "hint": "### Subtasks\n\nFor $20\\%$ of the testdata, $s=0$.\n\nFor $100\\%$ of the testdata, $n\\leq 200$, $m\\leq 12$, $k\\leq 4$, $s\\leq 8$, $e\\leq 20000$. The sum of all reward counts does not exceed $8$. It is guaranteed that the positions of any two treasures are different. There may be multiple edges. It is guaranteed that a solution exists.\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T5\n\nProblem setter: b2019dy\n\n78488\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] gcd？人生赢家！", "background": "gcd 是一个热爱游戏的人。", "description": "gcd 最近在玩一个有趣的游戏。\n\n我们把这个游戏抽象成一张图，图上有 $n$ 个点，gcd 需要寻找总计 $m$ 件宝物，它们分布在图上。\n\n对于每件宝物而言，将会有一个前置集合 $S$。只有当取得所有前置宝物时，才能获得该宝物。\n\ngcd 拥有一件神器，这件神器具有传送功能，它可以使用 $k$ 次，可以传送到一个任意节点。\n\n对于游戏而言，肯定会有额外的成就，这些成就会奖励一定的传送次数，成就的达成是满足集合 $S$ 的一瞬间。\n\n现在 gcd 想知道能最快通关的方法，请你求出通关的最少时间。", "inputFormat": "输入共 $s+m+e+6$ 行。\n\n第 $1$ 行输入 $3$ 个正整数 $n,m,k$。\n\n第 $2$ 行输入 $1$ 个正整数 $s$ 表示成就的数量。\n\n以下 $s$ 行每行输入 $1$ 个非负整数 $num$ 表示需求多少个宝物，然后输入 $num$ 个数，为所需宝物编号。\n\n第 $s+3$ 行输入 $s$ 个正整数 $a_1,a_2,\\cdots a_s$ 表示成就的奖励次数。\n\n第 $s+4$ 行输入 $m$ 个正整数 $p_1,p_2,\\cdots p_m$ 表示宝物的位置。\n\n第 $s+5$ 行输入 $1$ 个正整数 $e$ 表示边的总数。\n\n以下 $e$ 行每行输入 $3$ 个正整数 $x,y,z$ 表示 $x$ 与 $y$ 之间有一条边权为 $z$ 的无向边连接。\n\n以下 $m$ 行每行输入 $1$ 个非负整数 $num$ 表示宝物前置要求个数，然后输入 $num$ 个数，为要求的编号。\n\n最后一行输入 $1$ 个正整数 $st$ 表示起点。", "outputFormat": "输出共 $1$ 行 $1$ 个正整数，输出最少时间。", "hint": "### 子任务\n\n对于 $20\\%$ 的数据，$s=0$。\n\n对于 $100\\%$ 的数据，$n\\leq 200$，$m\\leq 12$，$k\\leq 4$，$s\\leq 8$，$e\\leq 20000$ ，奖励次数总和不超过 $8$，保证每两个宝物的位置不相同，可能有重边，保证有解。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T5\n\n出题人：b2019dy\n\n78488", "locale": "zh-CN"}}}
{"pid": "P4924", "type": "P", "difficulty": 2, "samples": [["5 4\n2 2 1 0\n3 3 1 1\n4 4 1 0\n3 3 2 1", "5 10 3 18 15\n4 19 8 17 20\n1 14 23 24 25\n6 9 2 7 22\n11 12 13 16 21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "递归", "枚举", "洛谷月赛"], "title": "[1007] 魔法少女小Scarlet", "background": null, "description": "Scarlet 最近学会了一个数组魔法，她会在 $n\\times n$ 二维数组上将一个奇数阶方阵按照顺时针或者逆时针旋转 $90^\\circ$。\n\n首先，Scarlet 会把 $1$ 到 $n^2$ 的正整数按照从左往右，从上至下的顺序填入初始的二维数组中，然后她会施放一些简易的魔法。\n\nScarlet 既不会什么分块特技，也不会什么 Splay 套 Splay，她现在提供给你她的魔法执行顺序，想让你来告诉她魔法按次执行完毕后的二维数组。", "inputFormat": "第一行两个整数 $n,m$，表示方阵大小和魔法施放次数。\n\n接下来 $m$ 行，每行 $4$ 个整数 $x,y,r,z$，表示在这次魔法中，Scarlet 会把以第 $x$ 行第 $y$ 列为中心的 $2r+1$ 阶矩阵按照某种时针方向旋转，其中 $z=0$ 表示顺时针，$z=1$ 表示逆时针。", "outputFormat": "输出 $n$ 行，每行 $n$ 个用空格隔开的数，表示最终所得的矩阵。", "hint": "对于 $50\\%$ 的数据，满足 $r=1$；\n\n对于 $100\\%$ 的数据，满足 $1\\leq n,m\\leq500$，$1\\leq x-r\\leq x+r\\leq n$，$1\\leq y-r\\leq y+r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[1007] Magical Girl Scarlet", "background": "", "description": "Scarlet has recently learned an array magic. On an $n \\times n$ 2D array, she can rotate an odd-order square submatrix by $90^\\circ$ clockwise or counterclockwise.\n\nFirst, Scarlet fills the initial 2D array with the positive integers from $1$ to $n^2$ in order from left to right and from top to bottom, and then she casts some simple magic.\n\nScarlet does not know any block decomposition tricks, nor any Splay-on-Splay. She now gives you the order in which she performs her magic, and she wants you to tell her what the 2D array looks like after all the operations are performed in order.", "inputFormat": "The first line contains two integers $n, m$, representing the size of the square matrix and the number of magic operations.\n\nThe next $m$ lines each contain $4$ integers $x, y, r, z$, meaning that in this operation, Scarlet rotates the $(2r+1)$-order matrix centered at row $x$, column $y$ by $90^\\circ$ in a certain direction, where $z=0$ means clockwise and $z=1$ means counterclockwise.", "outputFormat": "Output $n$ lines, each containing $n$ numbers separated by spaces, representing the final matrix.", "hint": "For $50\\%$ of the testdata, $r=1$.\n\nFor $100\\%$ of the testdata, $1 \\leq n, m \\leq 500$, $1 \\leq x-r \\leq x+r \\leq n$, $1 \\leq y-r \\leq y+r \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[1007] 魔法少女小Scarlet", "background": null, "description": "Scarlet 最近学会了一个数组魔法，她会在 $n\\times n$ 二维数组上将一个奇数阶方阵按照顺时针或者逆时针旋转 $90^\\circ$。\n\n首先，Scarlet 会把 $1$ 到 $n^2$ 的正整数按照从左往右，从上至下的顺序填入初始的二维数组中，然后她会施放一些简易的魔法。\n\nScarlet 既不会什么分块特技，也不会什么 Splay 套 Splay，她现在提供给你她的魔法执行顺序，想让你来告诉她魔法按次执行完毕后的二维数组。", "inputFormat": "第一行两个整数 $n,m$，表示方阵大小和魔法施放次数。\n\n接下来 $m$ 行，每行 $4$ 个整数 $x,y,r,z$，表示在这次魔法中，Scarlet 会把以第 $x$ 行第 $y$ 列为中心的 $2r+1$ 阶矩阵按照某种时针方向旋转，其中 $z=0$ 表示顺时针，$z=1$ 表示逆时针。", "outputFormat": "输出 $n$ 行，每行 $n$ 个用空格隔开的数，表示最终所得的矩阵。", "hint": "对于 $50\\%$ 的数据，满足 $r=1$；\n\n对于 $100\\%$ 的数据，满足 $1\\leq n,m\\leq500$，$1\\leq x-r\\leq x+r\\leq n$，$1\\leq y-r\\leq y+r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P4925", "type": "P", "difficulty": 4, "samples": [["3 3 233\n1 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "数学", "洛谷月赛"], "title": "[1007] Scarlet的字符串不可能这么可爱", "background": "", "description": "Scarlet妄图构造字符集为$k$，长度为$L$的字符串，满足没有任何一个长度超过$1$的回文连续子串。\n\n看起来这样的字符串太多了，Scarlet随手加了个限制：她指定了字符串的第$s$位为$w$。\n\n这下Scarlet不会做了，请你来帮她计算究竟有多少满足条件的字符串。按照套路，你只要求出答案对$p$取模后的结果。", "inputFormat": "第一行三个整数$k,L$和$p$，分别表示构造的字符串的的字符集、长度和模数。\n\n第二行两个整数$s,w$，描述Scarlet给的限制。\n\n**注意：$s=0$表示该数据点中Scarlet十分良心地没有添加限制**", "outputFormat": "一行一个整数，表示答案对$p$的取模后的结果。", "hint": "字符集：一个字符串中不同字符的数量。例如，字符集是3的话，你可以认为字符串仅由“A”、“B”、“C”三个字母组成。\n\n样例解释：第一个字符固定A，那么符合要求的字符串是ABC,ACB。而AAB字符串包括AA这个回文子串，ACA本身就是回文串，一次类推。\n\n对于50%的数据，$k\\leq5,L\\leq10$\n\n对于另30%的数据，$s=0$\n\n对于100%的数据$1\\leq k,L\\leq 10^{18},0\\leq s\\leq L,1\\leq w\\leq k,1\\leq p\\leq 10^9$\n", "locale": "zh-CN", "translations": {"en": {"title": "[1007] Scarlet’s Strings Can’t Be This Cute", "background": "", "description": "Scarlet wants to construct a string with an alphabet size of $k$ and length $L$, such that it has no palindromic contiguous substring with length greater than $1$.\n\nIt seems there are too many such strings, so Scarlet casually adds a restriction: she fixes the $s$-th character of the string to be $w$.\n\nNow Scarlet cannot solve it. Please help her compute how many strings satisfy the conditions. As usual, you only need to output the answer modulo $p$.", "inputFormat": "The first line contains three integers $k, L$ and $p$, representing the alphabet size, the string length, and the modulus.\n\nThe second line contains two integers $s, w$, describing the restriction given by Scarlet.\n\n**Note: $s=0$ means that in this test case Scarlet kindly did not add any restriction.**", "outputFormat": "Output one integer in a single line, representing the number of valid strings modulo $p$.", "hint": "Alphabet size: the number of distinct characters in a string. For example, if the alphabet size is $3$, you may assume the string consists only of the three letters “A”, “B”, and “C”.\n\nSample explanation: if the first character is fixed to A, then the valid strings are ABC and ACB. The string AAB contains the palindromic substring AA, and ACA itself is a palindrome, and so on.\n\nConstraints for $50\\%$ of the testdata: $k\\leq5, L\\leq10$.\n\nConstraints for another $30\\%$ of the testdata: $s=0$.\n\nConstraints for $100\\%$ of the testdata: $1\\leq k, L\\leq 10^{18}, 0\\leq s\\leq L, 1\\leq w\\leq k, 1\\leq p\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[1007] Scarlet的字符串不可能这么可爱", "background": "", "description": "Scarlet妄图构造字符集为$k$，长度为$L$的字符串，满足没有任何一个长度超过$1$的回文连续子串。\n\n看起来这样的字符串太多了，Scarlet随手加了个限制：她指定了字符串的第$s$位为$w$。\n\n这下Scarlet不会做了，请你来帮她计算究竟有多少满足条件的字符串。按照套路，你只要求出答案对$p$取模后的结果。", "inputFormat": "第一行三个整数$k,L$和$p$，分别表示构造的字符串的的字符集、长度和模数。\n\n第二行两个整数$s,w$，描述Scarlet给的限制。\n\n**注意：$s=0$表示该数据点中Scarlet十分良心地没有添加限制**", "outputFormat": "一行一个整数，表示答案对$p$的取模后的结果。", "hint": "字符集：一个字符串中不同字符的数量。例如，字符集是3的话，你可以认为字符串仅由“A”、“B”、“C”三个字母组成。\n\n样例解释：第一个字符固定A，那么符合要求的字符串是ABC,ACB。而AAB字符串包括AA这个回文子串，ACA本身就是回文串，一次类推。\n\n对于50%的数据，$k\\leq5,L\\leq10$\n\n对于另30%的数据，$s=0$\n\n对于100%的数据$1\\leq k,L\\leq 10^{18},0\\leq s\\leq L,1\\leq w\\leq k,1\\leq p\\leq 10^9$\n", "locale": "zh-CN"}}}
{"pid": "P4926", "type": "P", "difficulty": 5, "samples": [["3 5 1\n1 2 1 2\n1 3 2 2\n1 3 1 4\n2 1 2 2\n2 1 3 4\n1 1", "-1"], ["3 2 3\n1 2 1 10\n2 2 3 6\n1 1\n2 6\n3 9", "3.9999993984"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["二分", "Special Judge", "最短路", "差分约束", "洛谷月赛"], "title": "[1007] 倍杀测量者", "background": "", "description": "今天 Scarlet 在机房有幸目睹了一场别开生面的 OI 训练。因为一些奇妙的 SPJ，比赛中所有选手的得分都是正实数（甚至没有上限）。\n\n当一位选手 A 的分数不小于选手 B 的分数 $k$（$k>0$）倍时，我们称选手 A **$k$ 倍杀** 了选手 B，选手 B **被** 选手 A **$k$ 倍杀** 了。\n\n更奇妙也更激动人心的是，训练前有不少选手立下了诸如 “我没 $k$ 倍杀选手 X，我就吃顿好的”，“选手 Y 把我 $k$ 倍杀，我就吃顿好的” 的 Flag。\n\n知道真相的良心教练 Patchouli 为了维持机房秩序，避免吃的太好导致身体健康程度下滑，放宽了选手们的 Flag 限制。Patchouli 设定了一个 **正** 常数 $T$，立下 “我没 $k$ 倍杀选手 X 就吃顿好的” 的选手只要成功 $k - T$ 倍杀了选手 X，就不需要吃顿好的。同样的，立下 “选手 Y 把我 $k$ 倍杀我就吃顿好的” 的选手只要没有成功被选手 Y $k+T$ 倍杀，也不需要吃顿好的。\n\n提前知道了某些选手分数和具体 Flag 的 Scarlet 实在不忍心看到这么一次精彩比赛却没人吃顿好的，为了方便和 Patchouli 交易，Scarlet 想要确定最大的实数 $T$ 使得赛后一定有选手收 Flag 吃顿好的。", "inputFormat": "第一行三个整数 $n,s,t$，分别表示机房内选手人数，选手立下的 Flag 总数和 Scarlet 已知的选手分数的数量。$n$ 位选手从 $1$ 开始编号至 $n$，编号为 $k$ 的选手被称为选手 $k$。\n\n接下来 $s$ 行，每行四个整数 $o,A,B,k$。其中 $o=1$ 表示选手 A 立下了 “我没 $k$ 倍杀选手 B 就吃顿好的” 的 Flag，$o=2$ 表示选手 A 立下了 “选手 B 把我 $k$ 倍杀我就吃顿好的” 的 Flag。\n\n接下来 $t$ 行，每行两个整数 $C,x$，表示 Scarlet 已知选手 $C$ 的分数为 $x$。", "outputFormat": "若存在能保证赛后有选手吃顿好的的最大的 $T$，则输出 $T$，只有当输出与答案的绝对误差不超过 $10^{-4}$ 时才被视作正确输出。\n\n若不存在，输出 `-1`。", "hint": "- 对于 $30\\%$ 的数据，$n\\leq5$，$s\\leq 2$；\n- 对于另 $40\\%$ 的数据，保证 $t=n$；\n- 对于 $100\\%$ 的数据，$1\\leq n,s\\leq 1000$，$1\\leq A,B,C,t\\leq n$，$1\\leq k\\leq 10$，$1\\leq x\\leq 10^9$。保证输入中的 $C$ 两两不同。", "locale": "zh-CN", "translations": {"en": {"title": "[1007] Double-Kill Meter", "background": "", "description": "Today, Scarlet was lucky enough to witness a unique OI training session in the computer lab. Because of some strange SPJ, every contestant’s score in the contest was a positive real number (and it even has no upper limit).\n\nWhen contestant A’s score is at least $k$ ($k>0$) times contestant B’s score, we say contestant A **$k$-double-killed** contestant B, and contestant B **was $k$-double-killed** by contestant A.\n\nEven more strangely (and more excitingly), before the training, many contestants made Flags such as “If I don’t $k$-double-kill contestant X, I’ll eat something good,” or “If contestant Y $k$-double-kills me, I’ll eat something good.”\n\nCoach Patchouli, who knows the truth and still has a conscience, in order to keep order in the lab and avoid people eating too well and hurting their health, relaxed the Flag requirements. Patchouli set a **positive** constant $T$. A contestant who made the Flag “If I don’t $k$-double-kill contestant X, I’ll eat something good” will not need to eat something good as long as they successfully $k-T$-double-kill contestant X. Similarly, a contestant who made the Flag “If contestant Y $k$-double-kills me, I’ll eat something good” will not need to eat something good as long as they are not successfully $k+T$-double-killed by contestant Y.\n\nScarlet, who already knows the scores of some contestants and the exact Flags, really cannot bear to see such a wonderful contest end with nobody eating something good. To make it easier to negotiate with Patchouli, Scarlet wants to determine the largest real number $T$ such that, after the contest, there will definitely be at least one contestant who has to fulfill their Flag and eat something good.", "inputFormat": "The first line contains three integers $n,s,t$, representing the number of contestants in the lab, the total number of Flags made by contestants, and the number of contestants’ scores known by Scarlet. The $n$ contestants are numbered from $1$ to $n$. The contestant with number $k$ is called contestant $k$.\n\nThe next $s$ lines each contain four integers $o,A,B,k$. Here, $o=1$ means contestant A made the Flag “If I don’t $k$-double-kill contestant B, I’ll eat something good,” and $o=2$ means contestant A made the Flag “If contestant B $k$-double-kills me, I’ll eat something good.”\n\nThe next $t$ lines each contain two integers $C,x$, meaning Scarlet knows that contestant $C$ has score $x$.", "outputFormat": "If there exists a largest $T$ that can guarantee that, after the contest, there will be a contestant who eats something good, output $T$. Your output is considered correct if the absolute error from the answer does not exceed $10^{-4}$.\n\nIf it does not exist, output `-1`.", "hint": "- For $30\\%$ of the testdata, $n\\leq 5$, $s\\leq 2$.\n- For another $40\\%$ of the testdata, it is guaranteed that $t=n$.\n- For $100\\%$ of the testdata, $1\\leq n,s\\leq 1000$, $1\\leq A,B,C,t\\leq n$, $1\\leq k\\leq 10$, $1\\leq x\\leq 10^9$. It is guaranteed that all input $C$ are pairwise distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[1007] 倍杀测量者", "background": "", "description": "今天 Scarlet 在机房有幸目睹了一场别开生面的 OI 训练。因为一些奇妙的 SPJ，比赛中所有选手的得分都是正实数（甚至没有上限）。\n\n当一位选手 A 的分数不小于选手 B 的分数 $k$（$k>0$）倍时，我们称选手 A **$k$ 倍杀** 了选手 B，选手 B **被** 选手 A **$k$ 倍杀** 了。\n\n更奇妙也更激动人心的是，训练前有不少选手立下了诸如 “我没 $k$ 倍杀选手 X，我就吃顿好的”，“选手 Y 把我 $k$ 倍杀，我就吃顿好的” 的 Flag。\n\n知道真相的良心教练 Patchouli 为了维持机房秩序，避免吃的太好导致身体健康程度下滑，放宽了选手们的 Flag 限制。Patchouli 设定了一个 **正** 常数 $T$，立下 “我没 $k$ 倍杀选手 X 就吃顿好的” 的选手只要成功 $k - T$ 倍杀了选手 X，就不需要吃顿好的。同样的，立下 “选手 Y 把我 $k$ 倍杀我就吃顿好的” 的选手只要没有成功被选手 Y $k+T$ 倍杀，也不需要吃顿好的。\n\n提前知道了某些选手分数和具体 Flag 的 Scarlet 实在不忍心看到这么一次精彩比赛却没人吃顿好的，为了方便和 Patchouli 交易，Scarlet 想要确定最大的实数 $T$ 使得赛后一定有选手收 Flag 吃顿好的。", "inputFormat": "第一行三个整数 $n,s,t$，分别表示机房内选手人数，选手立下的 Flag 总数和 Scarlet 已知的选手分数的数量。$n$ 位选手从 $1$ 开始编号至 $n$，编号为 $k$ 的选手被称为选手 $k$。\n\n接下来 $s$ 行，每行四个整数 $o,A,B,k$。其中 $o=1$ 表示选手 A 立下了 “我没 $k$ 倍杀选手 B 就吃顿好的” 的 Flag，$o=2$ 表示选手 A 立下了 “选手 B 把我 $k$ 倍杀我就吃顿好的” 的 Flag。\n\n接下来 $t$ 行，每行两个整数 $C,x$，表示 Scarlet 已知选手 $C$ 的分数为 $x$。", "outputFormat": "若存在能保证赛后有选手吃顿好的的最大的 $T$，则输出 $T$，只有当输出与答案的绝对误差不超过 $10^{-4}$ 时才被视作正确输出。\n\n若不存在，输出 `-1`。", "hint": "- 对于 $30\\%$ 的数据，$n\\leq5$，$s\\leq 2$；\n- 对于另 $40\\%$ 的数据，保证 $t=n$；\n- 对于 $100\\%$ 的数据，$1\\leq n,s\\leq 1000$，$1\\leq A,B,C,t\\leq n$，$1\\leq k\\leq 10$，$1\\leq x\\leq 10^9$。保证输入中的 $C$ 两两不同。", "locale": "zh-CN"}}}
{"pid": "P4927", "type": "P", "difficulty": 5, "samples": [["4 3\n1 2 3 4\n2\n1 1 3 1\n2", "399297760\n844668322"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "概率论", "期望", "洛谷月赛"], "title": "[1007] 梦美与线段树", "background": "欢迎大家光临星象馆\n\n这里有着无论何时永远不会消失\n\n美丽的无穷光辉\n\n满天的星星等候着大家的到来", "description": "梦美为了研究星象馆的星星，用巨型投影机——耶拿将星星排成了一个序列，接着梦美将这个星星序列建成了一棵线段树。\n\n这是一棵维护区间和的线段树，每个节点的权值是该节点所对应的区间中，所有星星的权值和。有的时候梦美会从这棵线段树的根节点开始在星空游历。当她要进入子节点的时候，假设左右子树对应区间的权值和分别为 $sum_l$  和 $sum_r$，当前节点的权值为 $sum_{cur}$ ，梦美会以 $\\frac{sum_l}{sum_{cur}}$ 的概率进入左子树，否则进入右子树。\n\n游历的时候，梦美会把她经过的节点的权值累加起来，现在她希望您帮她设计一个算法求出这个权值期望下是多少。\n\n当然，如果星星都是不变的梦美会觉得很没有意思，因此她会发出一些指令，每个指令是，对下标在 $[l,r]$ 的星星，权值加上 $v$ 。不过由于馆里的工作人员全都离开了，因此没有人教梦美在线段树上维护懒标记，所以梦美的每次指令都会实时更新所有的线段树节点。\n\n为了解决线段树写法不一的问题，此处给出梦美维护这个问题时的部分代码：\n```cpp\nconst int N = 100010, MOD = 998244353;\nint a[N], sum[N << 2];\n#define lson (o << 1)\n#define rson (o << 1 | 1)\nvoid pushup(int o) {\n\tsum[o] = (sum[lson] + sum[rson]) % MOD;\n}\nvoid build(int o, int l, int r) {\n\tif (l == r) {\n\t\tsum[o] = a[l];\n\t} else {\n\t\tint mid = (l + r) >> 1;\n\t\tbuild(lson, l, mid);\n\t\tbuild(rson, mid + 1, r);\n\t\tpushup(o);\n\t}\n}\nvoid change(int o, int l, int r, int q, int v) {\n\tif (l == r) {\n\t\tsum[o] = (sum[o] + v) % MOD;\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tif (q <= mid) change(lson, l, mid, q, v);\n\telse change(rson, mid + 1, r, q, v);\n\tpushup(o);\n}\nvoid add_to_interval(int l, int r, int v) {\n\tfor (int i = l; i <= r; i ++) {\n\t\tchange(1, 1, n, i, v);\n\t}\n}\n```\n其中 `a` 数组表示每个星星的权值，`sum` 数组表示每个线段树节点的权值，`add_to_interval` 函数表示一次操作。", "inputFormat": "第一行两个整数 $n,m$，表示序列长度和操作次数。\n\n第二行 $n$ 个整数，表示这个序列。\n\n接下来 $m$ 行，每行为\n\n$1 \\ l \\ r \\ v$，表示区间 $[l,r]$ 的节点加上了 $v$；\n\n$2$ ，表示一次询问。", "outputFormat": "对于每一个 $2$ 操作，输出一个答案。令答案化成最简分数为 $\\frac{p}{q}$（保证 $q$ 不是 $998244353$ 的倍数），则输出 $p\\cdot q^{-1}\\mod 998244353$。", "hint": "对于 $30\\%$ 的数据，保证 $1 \\leq n,m\\leq 100$；\n\n对于另外 $20\\%$ 的数据，满足所有操作 1 中 $l=r$；\n\n对于 $100\\%$ 的数据，保证 $1\\leq n,m \\leq 10^5,1 \\leq a_i,v \\leq 10^9,1\\le l\\le r\\le n$。\n\n样例答案实际是 $\\frac{94}{5}$ 和 $\\frac{303}{13}$。", "locale": "zh-CN", "translations": {"en": {"title": "[1007] Mengmei and the Segment Tree", "background": "Welcome to the Planetarium.\n\nHere, there is beautiful infinite radiance that never disappears at any time.\n\nThe sky full of stars is waiting for everyone to come.", "description": "To study the stars in the Planetarium, Mengmei used a giant projector—Yena—to arrange the stars into a sequence, and then built a segment tree on this star sequence.\n\nThis is a segment tree that maintains interval sums. The weight of each node is the sum of the weights of all stars in the interval corresponding to that node. Sometimes Mengmei starts a journey in the starry sky from the root node of this segment tree. When she is about to enter a child node, suppose the sums of weights of the intervals corresponding to the left and right subtrees are $sum_l$ and $sum_r$, and the weight of the current node is $sum_{cur}$. Mengmei will enter the left subtree with probability $\\frac{sum_l}{sum_{cur}}$, otherwise she enters the right subtree.\n\nDuring the journey, Mengmei adds up the weights of the nodes she passes through. Now she wants you to design an algorithm to compute the expected value of this accumulated weight.\n\nOf course, if the stars never change, Mengmei would find it very boring. So she will issue some commands. Each command is: for the stars with indices in $[l,r]$, increase their weights by $v$. However, since all the staff in the museum have left, no one taught Mengmei how to maintain lazy tags on the segment tree, so each of her commands will update all segment tree nodes in real time.\n\nTo avoid differences in segment tree implementations, here is part of the code Mengmei uses to maintain this problem:\n```cpp\nconst int N = 100010, MOD = 998244353;\nint a[N], sum[N << 2];\n#define lson (o << 1)\n#define rson (o << 1 | 1)\nvoid pushup(int o) {\n\tsum[o] = (sum[lson] + sum[rson]) % MOD;\n}\nvoid build(int o, int l, int r) {\n\tif (l == r) {\n\t\tsum[o] = a[l];\n\t} else {\n\t\tint mid = (l + r) >> 1;\n\t\tbuild(lson, l, mid);\n\t\tbuild(rson, mid + 1, r);\n\t\tpushup(o);\n\t}\n}\nvoid change(int o, int l, int r, int q, int v) {\n\tif (l == r) {\n\t\tsum[o] = (sum[o] + v) % MOD;\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tif (q <= mid) change(lson, l, mid, q, v);\n\telse change(rson, mid + 1, r, q, v);\n\tpushup(o);\n}\nvoid add_to_interval(int l, int r, int v) {\n\tfor (int i = l; i <= r; i ++) {\n\t\tchange(1, 1, n, i, v);\n\t}\n}\n```\nHere, the array `a` represents the weight of each star, the array `sum` represents the weight of each segment tree node, and the function `add_to_interval` represents one operation.", "inputFormat": "The first line contains two integers $n,m$, representing the sequence length and the number of operations.\n\nThe second line contains $n$ integers, representing this sequence.\n\nNext, there are $m$ lines, each being one of the following:\n\n$1 \\ l \\ r \\ v$, meaning that all nodes in the interval $[l,r]$ are increased by $v$;\n\n$2$, meaning one query.", "outputFormat": "For each operation $2$, output one answer. Let the answer in lowest terms be $\\frac{p}{q}$ (it is guaranteed that $q$ is not a multiple of $998244353$), then output $p\\cdot q^{-1}\\mod 998244353$.", "hint": "For $30\\%$ of the testdata, it is guaranteed that $1 \\leq n,m\\leq 100$.\n\nFor another $20\\%$ of the testdata, all operations of type 1 satisfy $l=r$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\leq n,m \\leq 10^5,1 \\leq a_i,v \\leq 10^9,1\\le l\\le r\\le n$.\n\nThe sample answers are actually $\\frac{94}{5}$ and $\\frac{303}{13}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[1007] 梦美与线段树", "background": "欢迎大家光临星象馆\n\n这里有着无论何时永远不会消失\n\n美丽的无穷光辉\n\n满天的星星等候着大家的到来", "description": "梦美为了研究星象馆的星星，用巨型投影机——耶拿将星星排成了一个序列，接着梦美将这个星星序列建成了一棵线段树。\n\n这是一棵维护区间和的线段树，每个节点的权值是该节点所对应的区间中，所有星星的权值和。有的时候梦美会从这棵线段树的根节点开始在星空游历。当她要进入子节点的时候，假设左右子树对应区间的权值和分别为 $sum_l$  和 $sum_r$，当前节点的权值为 $sum_{cur}$ ，梦美会以 $\\frac{sum_l}{sum_{cur}}$ 的概率进入左子树，否则进入右子树。\n\n游历的时候，梦美会把她经过的节点的权值累加起来，现在她希望您帮她设计一个算法求出这个权值期望下是多少。\n\n当然，如果星星都是不变的梦美会觉得很没有意思，因此她会发出一些指令，每个指令是，对下标在 $[l,r]$ 的星星，权值加上 $v$ 。不过由于馆里的工作人员全都离开了，因此没有人教梦美在线段树上维护懒标记，所以梦美的每次指令都会实时更新所有的线段树节点。\n\n为了解决线段树写法不一的问题，此处给出梦美维护这个问题时的部分代码：\n```cpp\nconst int N = 100010, MOD = 998244353;\nint a[N], sum[N << 2];\n#define lson (o << 1)\n#define rson (o << 1 | 1)\nvoid pushup(int o) {\n\tsum[o] = (sum[lson] + sum[rson]) % MOD;\n}\nvoid build(int o, int l, int r) {\n\tif (l == r) {\n\t\tsum[o] = a[l];\n\t} else {\n\t\tint mid = (l + r) >> 1;\n\t\tbuild(lson, l, mid);\n\t\tbuild(rson, mid + 1, r);\n\t\tpushup(o);\n\t}\n}\nvoid change(int o, int l, int r, int q, int v) {\n\tif (l == r) {\n\t\tsum[o] = (sum[o] + v) % MOD;\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tif (q <= mid) change(lson, l, mid, q, v);\n\telse change(rson, mid + 1, r, q, v);\n\tpushup(o);\n}\nvoid add_to_interval(int l, int r, int v) {\n\tfor (int i = l; i <= r; i ++) {\n\t\tchange(1, 1, n, i, v);\n\t}\n}\n```\n其中 `a` 数组表示每个星星的权值，`sum` 数组表示每个线段树节点的权值，`add_to_interval` 函数表示一次操作。", "inputFormat": "第一行两个整数 $n,m$，表示序列长度和操作次数。\n\n第二行 $n$ 个整数，表示这个序列。\n\n接下来 $m$ 行，每行为\n\n$1 \\ l \\ r \\ v$，表示区间 $[l,r]$ 的节点加上了 $v$；\n\n$2$ ，表示一次询问。", "outputFormat": "对于每一个 $2$ 操作，输出一个答案。令答案化成最简分数为 $\\frac{p}{q}$（保证 $q$ 不是 $998244353$ 的倍数），则输出 $p\\cdot q^{-1}\\mod 998244353$。", "hint": "对于 $30\\%$ 的数据，保证 $1 \\leq n,m\\leq 100$；\n\n对于另外 $20\\%$ 的数据，满足所有操作 1 中 $l=r$；\n\n对于 $100\\%$ 的数据，保证 $1\\leq n,m \\leq 10^5,1 \\leq a_i,v \\leq 10^9,1\\le l\\le r\\le n$。\n\n样例答案实际是 $\\frac{94}{5}$ 和 $\\frac{303}{13}$。", "locale": "zh-CN"}}}
{"pid": "P4928", "type": "P", "difficulty": 5, "samples": [["2 5\n5 10\n1 1\n2 4 3 5 2", "125"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "洛谷原创", "O2优化", "枚举", "进制", "状压 DP"], "title": "[MtOI2018] 衣服？身外之物！", "background": "gcd 有许多件衣服，每件衣服有不同的颜色。", "description": "gcd 共有 $n$ 件衣服，编号为 $A_1,A_2,\\cdots A_n$。\n\n每一件衣服分别拥有颜色值和清洗时间，他在每一件衣服穿完以后都会将其送去清洗，而这件衣服当天所拥有的舒适感取决于当天的天气与他的衣服颜色值的乘积，天气值存在负数。\n\n现给出共 $m$ 天的天气情况，求最大舒适值。\n\n如果**必定**有一天 gcd 没有衣服穿，输出 \"gcd loves her clothes!\"（不含引号）。      \n", "inputFormat": "输出共 $4$ 行。\n\n第 $1$ 行输入 $n,m$。\n\n第 $2$ 行输入 $x_1,x_2\\cdots x_n$表示衣服的颜色值。     \n   \n第 $3$ 行输入 $y_1,y_2\\cdots y_n$表示衣服的清洗时间。 \n  \n第 $4$ 行输入 $z_1,z_2\\cdots z_m$表示当天的天气值。  ", "outputFormat": "输出共 $1$ 行，输出 $m$ 天穿衣的最大舒适值或输出 \"gcd loves her clothes!\"。", "hint": "#### 样例解释 $1$\n\n$A_1:Day_1,Day_3,Day_5$\n\n$A_2:Day_2,Day_4$\n\n### 子任务\n\n对于 $30\\%$ 的数据，$n=2$，$m=100$。\n\n对于 $50\\%$ 的数据，$n\\leq 3$，$m\\leq 1000$。\n\n对于 $100\\% $的数据，$n\\leq 4$，$n\\neq 1$，$m\\leq 2000$，$y_i\\leq 6$，$Maxy<m$，$|z_i|\\leq 10^8$。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T3\n\n出题人：b2019dy\n\n78488", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] Clothes? Mere External Things!", "background": "gcd has many pieces of clothing, and each piece has a different color.", "description": "gcd has a total of $n$ pieces of clothing, numbered $A_1, A_2, \\cdots A_n$.\n\nEach piece of clothing has a color value and a washing time. After wearing a piece of clothing, he will send it to be washed. The comfort value of that day depends on the product of the day's weather value and the clothing's color value, and the weather value can be negative.\n\nGiven the weather for $m$ days, find the maximum total comfort value.\n\nIf it is **certain** that there exists a day when gcd has no clothes to wear, output \"gcd loves her clothes!\" (without quotes).", "inputFormat": "The input consists of $4$ lines.\n\nLine $1$ contains $n, m$.\n\nLine $2$ contains $x_1, x_2 \\cdots x_n$, representing the color values of the clothes.\n\nLine $3$ contains $y_1, y_2 \\cdots y_n$, representing the washing times of the clothes.\n\nLine $4$ contains $z_1, z_2 \\cdots z_m$, representing the weather value of each day.", "outputFormat": "Output $1$ line: the maximum total comfort value over $m$ days of wearing clothes, or output \"gcd loves her clothes!\".", "hint": "#### Sample Explanation $1$\n\n$A_1:Day_1,Day_3,Day_5$\n\n$A_2:Day_2,Day_4$\n\n### Subtasks\n\nFor $30\\%$ of the testdata, $n = 2$, $m = 100$.\n\nFor $50\\%$ of the testdata, $n \\leq 3$, $m \\leq 1000$.\n\nFor $100\\%$ of the testdata, $n \\leq 4$, $n \\neq 1$, $m \\leq 2000$, $y_i \\leq 6$, $Maxy < m$, $|z_i| \\leq 10^8$.\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T3\n\nProblem setter: b2019dy\n\n78488\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] 衣服？身外之物！", "background": "gcd 有许多件衣服，每件衣服有不同的颜色。", "description": "gcd 共有 $n$ 件衣服，编号为 $A_1,A_2,\\cdots A_n$。\n\n每一件衣服分别拥有颜色值和清洗时间，他在每一件衣服穿完以后都会将其送去清洗，而这件衣服当天所拥有的舒适感取决于当天的天气与他的衣服颜色值的乘积，天气值存在负数。\n\n现给出共 $m$ 天的天气情况，求最大舒适值。\n\n如果**必定**有一天 gcd 没有衣服穿，输出 \"gcd loves her clothes!\"（不含引号）。      \n", "inputFormat": "输出共 $4$ 行。\n\n第 $1$ 行输入 $n,m$。\n\n第 $2$ 行输入 $x_1,x_2\\cdots x_n$表示衣服的颜色值。     \n   \n第 $3$ 行输入 $y_1,y_2\\cdots y_n$表示衣服的清洗时间。 \n  \n第 $4$ 行输入 $z_1,z_2\\cdots z_m$表示当天的天气值。  ", "outputFormat": "输出共 $1$ 行，输出 $m$ 天穿衣的最大舒适值或输出 \"gcd loves her clothes!\"。", "hint": "#### 样例解释 $1$\n\n$A_1:Day_1,Day_3,Day_5$\n\n$A_2:Day_2,Day_4$\n\n### 子任务\n\n对于 $30\\%$ 的数据，$n=2$，$m=100$。\n\n对于 $50\\%$ 的数据，$n\\leq 3$，$m\\leq 1000$。\n\n对于 $100\\% $的数据，$n\\leq 4$，$n\\neq 1$，$m\\leq 2000$，$y_i\\leq 6$，$Maxy<m$，$|z_i|\\leq 10^8$。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T3\n\n出题人：b2019dy\n\n78488", "locale": "zh-CN"}}}
{"pid": "P4929", "type": "P", "difficulty": 6, "samples": [["3 3\n0 0 1\n1 0 0\n0 1 0\n", "2 1 3\n"], ["3 3\n1 0 1\n1 1 0\n0 1 1\n", "No Solution!\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "Special Judge", "剪枝", "Dancing Links", "模板题"], "title": "【模板】舞蹈链（DLX）", "background": "本题是舞蹈链模板——精确覆盖问题", "description": "给定一个 $N$ 行 $M$ 列的矩阵，矩阵中每个元素要么是 $1$，要么是 $0$。\n\n你需要在矩阵中挑选出若干行，使得对于矩阵的每一列 $j$，在你挑选的这些行中，有且仅有一行的第 $j$ 个元素为 $1$。\n", "inputFormat": "第一行两个数 $N,M$。\n\n接下来 $N$ 行，每行 $M$ 个数字 $0$ 或 $1$，表示这个矩阵。\n", "outputFormat": "一行输出若干个数表示答案，两个数之间用空格隔开，输出任一可行方案均可，顺序随意。\n\n若无解，输出 `No Solution!`。\n", "hint": "对于 $100\\%$ 的数据，$N,M\\leq 500$，保证矩阵中 $1$ 的数量不超过 $5000$ 个。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Dancing Links (DLX).", "background": "This problem is a Dancing Links template for the Exact Cover problem.", "description": "Given a matrix with $N$ rows and $M$ columns, each element in the matrix is either $1$ or $0$.\n\nYou need to select some rows from the matrix so that for every column $j$ of the matrix, among the selected rows, there is one and only one row whose $j$-th element is $1$.", "inputFormat": "The first line contains two integers $N, M$.\n\nThe next $N$ lines each contain $M$ digits $0$ or $1$, representing the matrix.", "outputFormat": "Output one line containing several integers representing the answer. Separate numbers with spaces. Any feasible solution is acceptable, and the order can be arbitrary.\n\nIf there is no solution, output `No Solution!`.", "hint": "For $100\\%$ of the testdata, $N, M \\leq 500$, and the number of $1$ in the matrix is guaranteed to be at most $5000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】舞蹈链（DLX）", "background": "本题是舞蹈链模板——精确覆盖问题", "description": "给定一个 $N$ 行 $M$ 列的矩阵，矩阵中每个元素要么是 $1$，要么是 $0$。\n\n你需要在矩阵中挑选出若干行，使得对于矩阵的每一列 $j$，在你挑选的这些行中，有且仅有一行的第 $j$ 个元素为 $1$。\n", "inputFormat": "第一行两个数 $N,M$。\n\n接下来 $N$ 行，每行 $M$ 个数字 $0$ 或 $1$，表示这个矩阵。\n", "outputFormat": "一行输出若干个数表示答案，两个数之间用空格隔开，输出任一可行方案均可，顺序随意。\n\n若无解，输出 `No Solution!`。\n", "hint": "对于 $100\\%$ 的数据，$N,M\\leq 500$，保证矩阵中 $1$ 的数量不超过 $5000$ 个。", "locale": "zh-CN"}}}
{"pid": "P4930", "type": "P", "difficulty": 5, "samples": [["4\n8\n10\n13\n6", "5\n15 16 20 24 30\n2\n11 22\n0\n\n4\n7 9 14 18"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2013", "PA（波兰）"], "title": "[PA 2013] Euler", "background": "", "description": "给定 $n$ 求所有满足 $\\varphi(x)=n$ 的 $x$。", "inputFormat": "第一行一个数 $T$。\n\n接下来 $T$ 行，每行一个数 $n$。", "outputFormat": "输出共 $2\\times T$ 行。\n\n每组一个数 $m$ 表示满足的个数。\n\n接下来一行升序输出 $m$ 个数 $x_i$，若 $m$ 为 $0$ 则输出一个空行。", "hint": "对于 $100\\%$ 的数据，$1\\le T\\le 5$，$1\\le n\\le 10^{10}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2013] Euler", "background": "", "description": "给定 $n$ 求所有满足 $\\varphi(x)=n$ 的 $x$。", "inputFormat": "第一行一个数 $T$。\n\n接下来 $T$ 行，每行一个数 $n$。", "outputFormat": "输出共 $2\\times T$ 行。\n\n每组一个数 $m$ 表示满足的个数。\n\n接下来一行升序输出 $m$ 个数 $x_i$，若 $m$ 为 $0$ 则输出一个空行。", "hint": "对于 $100\\%$ 的数据，$1\\le T\\le 5$，$1\\le n\\le 10^{10}$。", "locale": "zh-CN"}}}
{"pid": "P4931", "type": "P", "difficulty": 7, "samples": [["5\n1 1\n2 0\n2 2\n2333 666\n2333333 1000000\n", "2\n16\n8\n798775522\n300377435\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["递推", "2018", "洛谷原创", "组合数学", "生成函数", "逆元"], "title": "[MtOI2018] 情侣？给我烧了！（加强版）", "background": "FFF\n\n本题原版：[P4921](https://www.luogu.com.cn/problem/P4921)", "description": "有 $n$ 对情侣来到电影院观看电影。在电影院，恰好留有 $n$ 排座位，每排包含 $2$ 个座位，共 $2n$ 个座位。\n\n现在，每个人将会随机坐在某一个位置上，且恰好将这 $2n$ 个座位坐满。\n\n如果一对情侣坐在了同一排的座位上，那么我们称这对情侣是和睦的。\n\n你的任务是求出共有多少种不同的就坐方案满足**恰好**有 *k* 对情侣是和睦的。\n\n两种就坐方案不同当且仅当存在一个人在两种方案中坐在了不同的位置。不难发现，一共会有 $(2n)!$ 种不同的就坐方案。\n\n由于结果可能较大，因此输出对 $998244353$ 取模的结果。", "inputFormat": "输入包含多组数据。\n\n输入的第 $1$ 行包含 $1$ 个正整数 $T$，表示数据的组数。\n\n接下来 $T$ 行，每行包含 $2$ 个正整数 $n,k$。", "outputFormat": "输出共 $T$ 行。\n\n对于每组输入数据，输出共 $1$ 行，包含 $1$ 个整数，表示恰好有 $k$ 对情侣和睦的就坐方案数。", "hint": "### 子任务\n\n对于 $10 \\%$ 的数据，满足 $1 \\leq T \\leq 10, 1 \\leq n \\leq 5$。\n\n对于 $40 \\%$ 的数据，满足 $1 \\leq n \\leq 3 \\times 10^3$。\n\n对于 $100 \\%$ 的数据，满足 $1 \\leq T \\leq 2 \\times 10^5, 1 \\leq n \\leq 5 \\times 10^6, 0 \\leq k \\leq n$。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2 加强版\n\n出题人：Imagine\n\n50167", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] Couples? Burn Them for Me! (Enhanced Version)", "background": "FFF.\n\nOriginal version of this problem: [P4921](https://www.luogu.com.cn/problem/P4921).", "description": "There are $n$ couples who come to a cinema to watch a movie. In the cinema, there are exactly $n$ rows of seats, and each row contains $2$ seats, so there are $2n$ seats in total.\n\nNow, everyone will randomly sit in one seat, and exactly all $2n$ seats will be occupied.\n\nIf a couple sits in the same row, then we call this couple harmonious.\n\nYour task is to find how many different seating arrangements satisfy that **exactly** $k$ couples are harmonious.\n\nTwo seating arrangements are different if and only if there exists at least one person who sits in a different seat in the two arrangements. It is not hard to see that there are $(2n)!$ different seating arrangements in total.\n\nSince the answer may be large, output it modulo $998244353$.", "inputFormat": "The input contains multiple test cases.\n\nThe first line contains one positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain two positive integers $n, k$.", "outputFormat": "Output $T$ lines.\n\nFor each test case, output one line containing one integer, the number of seating arrangements in which exactly $k$ couples are harmonious.", "hint": "### Subtasks\n\nFor $10\\%$ of the testdata, $1 \\leq T \\leq 10$ and $1 \\leq n \\leq 5$.\n\nFor $40\\%$ of the testdata, $1 \\leq n \\leq 3 \\times 10^3$.\n\nFor $100\\%$ of the testdata, $1 \\leq T \\leq 2 \\times 10^5$, $1 \\leq n \\leq 5 \\times 10^6$, and $0 \\leq k \\leq n$.\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2 Enhanced Version.\n\nProblem setter: Imagine.\n\n50167.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] 情侣？给我烧了！（加强版）", "background": "FFF\n\n本题原版：[P4921](https://www.luogu.com.cn/problem/P4921)", "description": "有 $n$ 对情侣来到电影院观看电影。在电影院，恰好留有 $n$ 排座位，每排包含 $2$ 个座位，共 $2n$ 个座位。\n\n现在，每个人将会随机坐在某一个位置上，且恰好将这 $2n$ 个座位坐满。\n\n如果一对情侣坐在了同一排的座位上，那么我们称这对情侣是和睦的。\n\n你的任务是求出共有多少种不同的就坐方案满足**恰好**有 *k* 对情侣是和睦的。\n\n两种就坐方案不同当且仅当存在一个人在两种方案中坐在了不同的位置。不难发现，一共会有 $(2n)!$ 种不同的就坐方案。\n\n由于结果可能较大，因此输出对 $998244353$ 取模的结果。", "inputFormat": "输入包含多组数据。\n\n输入的第 $1$ 行包含 $1$ 个正整数 $T$，表示数据的组数。\n\n接下来 $T$ 行，每行包含 $2$ 个正整数 $n,k$。", "outputFormat": "输出共 $T$ 行。\n\n对于每组输入数据，输出共 $1$ 行，包含 $1$ 个整数，表示恰好有 $k$ 对情侣和睦的就坐方案数。", "hint": "### 子任务\n\n对于 $10 \\%$ 的数据，满足 $1 \\leq T \\leq 10, 1 \\leq n \\leq 5$。\n\n对于 $40 \\%$ 的数据，满足 $1 \\leq n \\leq 3 \\times 10^3$。\n\n对于 $100 \\%$ 的数据，满足 $1 \\leq T \\leq 2 \\times 10^5, 1 \\leq n \\leq 5 \\times 10^6, 0 \\leq k \\leq n$。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2 加强版\n\n出题人：Imagine\n\n50167", "locale": "zh-CN"}}}
{"pid": "P4932", "type": "P", "difficulty": 4, "samples": [["8 98 24 20 100 44\n", "12\n"], ["1000 952537 601907 686180 1000000 673601\n", "249711\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "进制", "位运算", "洛谷月赛"], "title": "浏览器", "background": "\\_\\_stdcall 在用 Edge 玩 slay 的时候，鼠标会经常失灵，这让她十分痛苦，因此她决定也要让你们感受一下 Edge 制造的痛苦。", "description": "\\_\\_stdcall 给了你 $n$ 个点，第 $i$ 个点有权值 $x_i$，对于两个点 $u$ 和 $v$，如果 $x_u \\operatorname{xor}x_v$ 的结果在二进制表示下有奇数个 $1$，那么在 $u$ 和 $v$ 之间连接一个 Edge，现在 \\_\\_stdcall 想让你求出一共有多少个 Edge。\n\n如果你没能成功完成任务，那么 \\_\\_stdcall 会让你痛苦一下，你这个测试点就没分了。", "inputFormat": "一行六个整数，$n$，$a$，$b$，$c$，$d$，$x_0$。\n\n$n$ 是点的个数，每个点的权值需要用如下的方式生成。\n\n你需要使用 $a$，$b$，$c$，$d$ 和 $x_0$ 生成一个数组x，生成方式是这样的。\n\n$$x_i = (ax_{i-1}^2 + bx_{i-1} + c) \\bmod d$$\n\n$x_i$ 就是第 $i$ 个点的权值，点的标号是 $1$ 到 $n$。", "outputFormat": "输出一个整数，表示一共有多少个 Edge。", "hint": "我们用 $v$ 表示权值中的最大值。\n\n对于前 $20\\%$ 的数据，$n \\le 10$。\n\n对于前 $40\\%$ 的数据，$n \\le 100$。\n\n对于前 $60\\%$ 的数据，$n \\le 1000$。\n\n对于前 $80\\%$ 的数据，$n \\le 1 \\times 10^6$。\n\n对于前 $90\\%$ 的数据，$v \\le 1 \\times 10^6$。\n\n对于 $100\\%$ 的数据，$n \\le 1 \\times 10^7，v \\le 1 \\times 10^9$。\n\n保证 $a$，$b$，$c$，$d$，$x_0$ 都是 `int` 内的非负整数。", "locale": "zh-CN", "translations": {"en": {"title": "Browser", "background": "When playing Slay the Spire on Edge, __stdcall often finds that the mouse stops working, which makes her very upset. Therefore, she decided to let you experience the pain caused by Edge as well.", "description": "__stdcall gives you $n$ points. The $i$-th point has weight $x_i$. For two points $u$ and $v$, if the result of $x_u \\operatorname{xor}x_v$ has an odd number of $1$'s in its binary representation, then connect an Edge between $u$ and $v$. Now __stdcall wants you to find how many Edges there are in total.\n\nIf you fail to complete the task, then __stdcall will make you suffer a bit, and you will get no score for this test case.", "inputFormat": "One line with six integers: $n$, $a$, $b$, $c$, $d$, $x_0$.\n\n$n$ is the number of points. The weight of each point needs to be generated in the following way.\n\nYou need to use $a$, $b$, $c$, $d$, and $x_0$ to generate an array x. The generation method is:\n\n$$x_i = (ax_{i-1}^2 + bx_{i-1} + c) \\bmod d$$\n\n$x_i$ is the weight of the $i$-th point. The point indices are from $1$ to $n$.", "outputFormat": "Output one integer, representing the total number of Edges.", "hint": "Let $v$ denote the maximum value among the weights.\n\nFor the first $20\\%$ of the data, $n \\le 10$.\n\nFor the first $40\\%$ of the data, $n \\le 100$.\n\nFor the first $60\\%$ of the data, $n \\le 1000$.\n\nFor the first $80\\%$ of the data, $n \\le 1 \\times 10^6$.\n\nFor the first $90\\%$ of the data, $v \\le 1 \\times 10^6$.\n\nFor $100\\%$ of the data, $n \\le 1 \\times 10^7，v \\le 1 \\times 10^9$.\n\nIt is guaranteed that $a$, $b$, $c$, $d$, and $x_0$ are all non-negative integers within `int`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "浏览器", "background": "\\_\\_stdcall 在用 Edge 玩 slay 的时候，鼠标会经常失灵，这让她十分痛苦，因此她决定也要让你们感受一下 Edge 制造的痛苦。", "description": "\\_\\_stdcall 给了你 $n$ 个点，第 $i$ 个点有权值 $x_i$，对于两个点 $u$ 和 $v$，如果 $x_u \\operatorname{xor}x_v$ 的结果在二进制表示下有奇数个 $1$，那么在 $u$ 和 $v$ 之间连接一个 Edge，现在 \\_\\_stdcall 想让你求出一共有多少个 Edge。\n\n如果你没能成功完成任务，那么 \\_\\_stdcall 会让你痛苦一下，你这个测试点就没分了。", "inputFormat": "一行六个整数，$n$，$a$，$b$，$c$，$d$，$x_0$。\n\n$n$ 是点的个数，每个点的权值需要用如下的方式生成。\n\n你需要使用 $a$，$b$，$c$，$d$ 和 $x_0$ 生成一个数组x，生成方式是这样的。\n\n$$x_i = (ax_{i-1}^2 + bx_{i-1} + c) \\bmod d$$\n\n$x_i$ 就是第 $i$ 个点的权值，点的标号是 $1$ 到 $n$。", "outputFormat": "输出一个整数，表示一共有多少个 Edge。", "hint": "我们用 $v$ 表示权值中的最大值。\n\n对于前 $20\\%$ 的数据，$n \\le 10$。\n\n对于前 $40\\%$ 的数据，$n \\le 100$。\n\n对于前 $60\\%$ 的数据，$n \\le 1000$。\n\n对于前 $80\\%$ 的数据，$n \\le 1 \\times 10^6$。\n\n对于前 $90\\%$ 的数据，$v \\le 1 \\times 10^6$。\n\n对于 $100\\%$ 的数据，$n \\le 1 \\times 10^7，v \\le 1 \\times 10^9$。\n\n保证 $a$，$b$，$c$，$d$，$x_0$ 都是 `int` 内的非负整数。", "locale": "zh-CN"}}}
{"pid": "P4933", "type": "P", "difficulty": 4, "samples": [["8\n13 14 6 20 27 34 34 41 \n", "50\n"], ["100\n90 1004 171 99 1835 108 81 117 141 126 135 144 81 153 193 81 962 162 1493 171 1780 864 297 180 532 1781 189 1059 198 333 1593 824 207 1877 216 270 225 1131 336 1875 362 234 81 288 1550 243 463 1755 252 406 261 270 279 288 1393 261 1263 297 135 333 872 234 881 180 198 81 225 306 180 90 315 81 81 198 252 81 297 1336 1140 1238 81 198 297 661 81 1372 469 1132 81 126 324 333 342 81 351 481 279 1770 1225 549 \n", "11153\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "枚举", "洛谷月赛"], "title": "大师", "background": "建筑大师最近在跟着数学大师 ljt12138 学数学，今天他学了等差数列，ljt12138 决定给他留一道练习题。", "description": "ljt12138 首先建了 $n$ 个特斯拉电磁塔，这些电塔排成一排，从左到右依次标号为 $1$ 到 $n$，第 $i$ 个电塔的高度为 $h[i]$。\n\n建筑大师需要从中选出一些电塔，然后这些电塔就会缩到地下去。这时候，如果留在地上的电塔的高度，从左向右构成了一个等差数列，那么这个选择方案就会被认为是美观的。\n\n建筑大师需要求出，一共有多少种美观的选择方案，答案模 $998244353$。\n\n注意，如果地上只留了一个或者两个电塔，那么这种方案也是美观的。地上没有电塔的方案被认为是不美观的。\n\n同时也要注意，等差数列的公差也可以为负数。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个非负整数，第 $i$ 个整数是第 $i$ 个电塔的高度 $h[i]$。", "outputFormat": "输出一个整数，表示美观的方案数模 $998244353$ 的值。\n", "hint": "设 $v$ 为最高的电塔高度。\n\n对于前 $30\\%$ 的数据，$n \\le 20 $。\n\n对于前 $60\\%$ 的数据，$n \\le 100$，$v \\le 2 \\times 10^3$。\n\n对于另外 $20\\%$ 的数据，所有电塔的高度构成一个等差数列。\n\n对于 $100\\%$ 的数据，$n \\le 10^3$，$v \\leq2 \\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "Master.", "background": "The architecture master has recently been learning math from the math master ljt12138. Today, he learned arithmetic sequences, and ljt12138 decided to leave him an exercise.", "description": "ljt12138 first built $n$ Tesla electromagnetic towers. These towers are arranged in a line and numbered from left to right from $1$ to $n$. The height of the $i$-th tower is $h[i]$.\n\nThe architecture master needs to choose some towers, and the chosen towers will shrink underground. At this time, if the heights of the towers that remain above ground form an arithmetic sequence from left to right, then this selection plan is considered beautiful.\n\nThe architecture master needs to find how many beautiful selection plans there are in total, and output the answer modulo $998244353$.\n\nNote that if only one or two towers remain above ground, this plan is also considered beautiful. A plan where no tower remains above ground is considered not beautiful.\n\nAlso note that the common difference of the arithmetic sequence can be negative.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ non-negative integers. The $i$-th integer is the height $h[i]$ of the $i$-th tower.", "outputFormat": "Output one integer, representing the number of beautiful plans modulo $998244353$.", "hint": "Let $v$ be the maximum tower height.\n\nFor the first $30\\%$ of the testdata, $n \\le 20$.\n\nFor the first $60\\%$ of the testdata, $n \\le 100$, $v \\le 2 \\times 10^3$.\n\nFor the other $20\\%$ of the testdata, the heights of all towers form an arithmetic sequence.\n\nFor $100\\%$ of the testdata, $n \\le 10^3$, $v \\leq 2 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "大师", "background": "建筑大师最近在跟着数学大师 ljt12138 学数学，今天他学了等差数列，ljt12138 决定给他留一道练习题。", "description": "ljt12138 首先建了 $n$ 个特斯拉电磁塔，这些电塔排成一排，从左到右依次标号为 $1$ 到 $n$，第 $i$ 个电塔的高度为 $h[i]$。\n\n建筑大师需要从中选出一些电塔，然后这些电塔就会缩到地下去。这时候，如果留在地上的电塔的高度，从左向右构成了一个等差数列，那么这个选择方案就会被认为是美观的。\n\n建筑大师需要求出，一共有多少种美观的选择方案，答案模 $998244353$。\n\n注意，如果地上只留了一个或者两个电塔，那么这种方案也是美观的。地上没有电塔的方案被认为是不美观的。\n\n同时也要注意，等差数列的公差也可以为负数。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个非负整数，第 $i$ 个整数是第 $i$ 个电塔的高度 $h[i]$。", "outputFormat": "输出一个整数，表示美观的方案数模 $998244353$ 的值。\n", "hint": "设 $v$ 为最高的电塔高度。\n\n对于前 $30\\%$ 的数据，$n \\le 20 $。\n\n对于前 $60\\%$ 的数据，$n \\le 100$，$v \\le 2 \\times 10^3$。\n\n对于另外 $20\\%$ 的数据，所有电塔的高度构成一个等差数列。\n\n对于 $100\\%$ 的数据，$n \\le 10^3$，$v \\leq2 \\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P4934", "type": "P", "difficulty": 6, "samples": [["5 3\n0 4 7 1 6 \n", "1\n4\n1 0\n2 1 4\n1 6\n1 7 "]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge", "O2优化", "枚举", "排序", "拓扑排序", "洛谷月赛"], "title": "礼物", "background": "由于你出色的完成了前面两道题目，善良的 __stdcall 决定给你一个小礼物，给拼搏在 AK 这套题之路上的你，一个有力的援助。", "description": "__stdcall 决定给你 $n$ 个礼物，每个礼物有一个魔力值 $a_i$。\n\n这些礼物的魔力值都是独一无二的，两两互不相同。这些礼物都有着神奇的魔力，如果两个礼物 $i, j$ 的魔力值满足 $a_i \\operatorname{bitand} a_j \\ge \\min(a_i, a_j)$，那么这两个礼物的魔力将会相互抵消，因此它们不能放在一个箱子里。\n\n这里的 $\\operatorname{bitand}$ 表示按位与运算，如果你对这一运算不够了解，请参考：<https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E4%B8%8E/9601818>。\n\n作为发礼物苦力的 ljt12138 的箱子并不多，不过幸运的是，每个箱子都足够大。现在他请求你帮助他合理分配，用**尽可能少**的箱子装下所有礼物。换言之，使得每个礼物都被恰好装入一个箱子中，且同一个箱子中的礼物魔力不会相互抵消。如果有多种合法的方案，你只需要给出**任意一种**。\n\nljt12138 十分善良，如果你只能求出所需要的箱子数，也可以获得该测试点 $60\\%$ 的分数，关于这一点，请参考下面的提示与说明。", "inputFormat": "- 第一行两个数 $n$ 和 $k$，$n$ 为礼物总数，$k$ 为一个参数，方便你进行计算。\n- 第二行 $n$ 个两两不同的数$a_i$，满足 $0\\le a_i < 2^k$，表示礼物的魔力值。", "outputFormat": "- 第一行输出一个数。如果你不希望输出方案，请输出0；如果你希望输出方案，请输出 $1$。**如果你在这一行输出了不符合要求的信息，将被判为 WA**。\n- 第二行一个数 $m$，表示你将礼物装到了 $m$ 个箱子里。\n- 如果你在第一行输出了 $1$，接下来 $m$ 行，每行表示一个箱子：首先一个数 $s_i$，表示当前箱子中礼物的个数；接下来 $s_i$ 个数，表示当前子集。", "hint": "### 附加样例\n\n你可以在  <https://pan.baidu.com/s/1A8_ZA4yXXi5y6771x9JKUw> 下载附加样例。\n\n### 关于输出方案\n\n- 如果你在第一行输出了 $0$，而正确回答了最小所需的箱子数，将获得测试点 $60\\%$ 的分数。\n- 如果你在第一行输出了 $1$，正确回答了最小所需的箱子数，但没有给出正确的方案，也将获得该测试点 $60\\%$ 的分数。\n- 如果你没有正确回答最小所需的箱子数，将不会获得该测试点的分数。\n- 请选手注意，如果你未按照上述格式输出答案，将无法获得任何分数。\n\n数据 $n, k$ 的关系由下面的表格给出：\n\n|数据编号| $n$ | $k$ |\n|:----:|:----:|:----:|\n|$1$|$5$|$3$|\n|$2$|$6$|$3$|\n|$3$|$7$|$10$|\n|$4$|$8$|$10$|\n|$5$|$16$|$7$|\n|$6$|$17$|$8$|\n|$7$|$17$|$9$|\n|$8$|$17$|$20$|\n|$9$|$2\\times 10^3$|$17$|\n|$10$|$2.5\\times 10^3$|$18$|\n|$11$|$3\\times 10^3$|$19$|\n|$12$|$3\\times 10^3$|$20$|\n|$13$|$2.5\\times 10^4$|$15$|\n|$14$|$2.5\\times 10^4$|$15$|\n|$15$|$5\\times 10^4$|$16$|\n|$16$|$5\\times 10^4$|$16$|\n|$17$|$2.5\\times 10^5$|$18$|\n|$18$|$5\\times 10^5$|$19$|\n|$19$|$10^6$|$20$|\n|$20$|$10^6$|$20$|", "locale": "zh-CN", "translations": {"en": {"title": "Gift", "background": "Because you did an excellent job on the previous two problems, the kind __stdcall decided to give you a small gift, providing strong support for you who are striving to AK this problem set.", "description": "__stdcall decided to give you $n$ gifts. Each gift has a magic value $a_i$.\n\nAll magic values are unique, i.e., pairwise distinct. These gifts have magical power: if for two gifts $i, j$, their magic values satisfy $a_i \\operatorname{bitand} a_j \\ge \\min(a_i, a_j)$, then their magic will cancel each other out, so they cannot be put into the same box.\n\nHere $\\operatorname{bitand}$ denotes the bitwise AND operation. If you are not familiar with it, please refer to: <https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E4%B8%8E/9601818>.\n\nAs the gift delivery worker, ljt12138 does not have many boxes, but luckily each box is large enough. Now he asks you to help him distribute the gifts properly, using **as few** boxes as possible. In other words, make sure every gift is placed into exactly one box, and the gifts in the same box will not cancel each other out. If there are multiple valid solutions, you only need to output **any one**.\n\nljt12138 is very kind: if you can only compute the required number of boxes, you can still get $60\\%$ of the score for that test point. For details, see the hints and explanations below.", "inputFormat": "- The first line contains two numbers $n$ and $k$, where $n$ is the total number of gifts, and $k$ is a parameter to help you compute.\n- The second line contains $n$ pairwise distinct numbers $a_i$, satisfying $0 \\le a_i < 2^k$, representing the magic values of the gifts.", "outputFormat": "- Output one number on the first line. If you do not want to output an assignment, output $0$; if you want to output an assignment, output $1$. **If you output invalid information on this line, you will be judged as WA**.\n- Output one number $m$ on the second line, indicating that you packed the gifts into $m$ boxes.\n- If you output $1$ on the first line, then output the next $m$ lines, each describing one box: first a number $s_i$, the number of gifts in the current box; then $s_i$ numbers describing the current subset.", "hint": "### Additional Samples\n\nYou can download additional samples at <https://pan.baidu.com/s/1A8_ZA4yXXi5y6771x9JKUw>.\n\n### About Outputting an Assignment\n\n- If you output $0$ on the first line and correctly answer the minimum number of boxes needed, you will get $60\\%$ of the score for that test point.\n- If you output $1$ on the first line, correctly answer the minimum number of boxes needed, but do not provide a correct assignment, you will also get $60\\%$ of the score for that test point.\n- If you do not correctly answer the minimum number of boxes needed, you will not get the score for that test point.\n- Please note that if you do not output in the format above, you will not receive any score.\n\nThe relationship between $n$ and $k$ is given by the table below:\n\n|Data ID| $n$ | $k$ |\n|:----:|:----:|:----:|\n|$1$|$5$|$3$|\n|$2$|$6$|$3$|\n|$3$|$7$|$10$|\n|$4$|$8$|$10$|\n|$5$|$16$|$7$|\n|$6$|$17$|$8$|\n|$7$|$17$|$9$|\n|$8$|$17$|$20$|\n|$9$|$2\\times 10^3$|$17$|\n|$10$|$2.5\\times 10^3$|$18$|\n|$11$|$3\\times 10^3$|$19$|\n|$12$|$3\\times 10^3$|$20$|\n|$13$|$2.5\\times 10^4$|$15$|\n|$14$|$2.5\\times 10^4$|$15$|\n|$15$|$5\\times 10^4$|$16$|\n|$16$|$5\\times 10^4$|$16$|\n|$17$|$2.5\\times 10^5$|$18$|\n|$18$|$5\\times 10^5$|$19$|\n|$19$|$10^6$|$20$|\n|$20$|$10^6$|$20$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "礼物", "background": "由于你出色的完成了前面两道题目，善良的 __stdcall 决定给你一个小礼物，给拼搏在 AK 这套题之路上的你，一个有力的援助。", "description": "__stdcall 决定给你 $n$ 个礼物，每个礼物有一个魔力值 $a_i$。\n\n这些礼物的魔力值都是独一无二的，两两互不相同。这些礼物都有着神奇的魔力，如果两个礼物 $i, j$ 的魔力值满足 $a_i \\operatorname{bitand} a_j \\ge \\min(a_i, a_j)$，那么这两个礼物的魔力将会相互抵消，因此它们不能放在一个箱子里。\n\n这里的 $\\operatorname{bitand}$ 表示按位与运算，如果你对这一运算不够了解，请参考：<https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E4%B8%8E/9601818>。\n\n作为发礼物苦力的 ljt12138 的箱子并不多，不过幸运的是，每个箱子都足够大。现在他请求你帮助他合理分配，用**尽可能少**的箱子装下所有礼物。换言之，使得每个礼物都被恰好装入一个箱子中，且同一个箱子中的礼物魔力不会相互抵消。如果有多种合法的方案，你只需要给出**任意一种**。\n\nljt12138 十分善良，如果你只能求出所需要的箱子数，也可以获得该测试点 $60\\%$ 的分数，关于这一点，请参考下面的提示与说明。", "inputFormat": "- 第一行两个数 $n$ 和 $k$，$n$ 为礼物总数，$k$ 为一个参数，方便你进行计算。\n- 第二行 $n$ 个两两不同的数$a_i$，满足 $0\\le a_i < 2^k$，表示礼物的魔力值。", "outputFormat": "- 第一行输出一个数。如果你不希望输出方案，请输出0；如果你希望输出方案，请输出 $1$。**如果你在这一行输出了不符合要求的信息，将被判为 WA**。\n- 第二行一个数 $m$，表示你将礼物装到了 $m$ 个箱子里。\n- 如果你在第一行输出了 $1$，接下来 $m$ 行，每行表示一个箱子：首先一个数 $s_i$，表示当前箱子中礼物的个数；接下来 $s_i$ 个数，表示当前子集。", "hint": "### 附加样例\n\n你可以在  <https://pan.baidu.com/s/1A8_ZA4yXXi5y6771x9JKUw> 下载附加样例。\n\n### 关于输出方案\n\n- 如果你在第一行输出了 $0$，而正确回答了最小所需的箱子数，将获得测试点 $60\\%$ 的分数。\n- 如果你在第一行输出了 $1$，正确回答了最小所需的箱子数，但没有给出正确的方案，也将获得该测试点 $60\\%$ 的分数。\n- 如果你没有正确回答最小所需的箱子数，将不会获得该测试点的分数。\n- 请选手注意，如果你未按照上述格式输出答案，将无法获得任何分数。\n\n数据 $n, k$ 的关系由下面的表格给出：\n\n|数据编号| $n$ | $k$ |\n|:----:|:----:|:----:|\n|$1$|$5$|$3$|\n|$2$|$6$|$3$|\n|$3$|$7$|$10$|\n|$4$|$8$|$10$|\n|$5$|$16$|$7$|\n|$6$|$17$|$8$|\n|$7$|$17$|$9$|\n|$8$|$17$|$20$|\n|$9$|$2\\times 10^3$|$17$|\n|$10$|$2.5\\times 10^3$|$18$|\n|$11$|$3\\times 10^3$|$19$|\n|$12$|$3\\times 10^3$|$20$|\n|$13$|$2.5\\times 10^4$|$15$|\n|$14$|$2.5\\times 10^4$|$15$|\n|$15$|$5\\times 10^4$|$16$|\n|$16$|$5\\times 10^4$|$16$|\n|$17$|$2.5\\times 10^5$|$18$|\n|$18$|$5\\times 10^5$|$19$|\n|$19$|$10^6$|$20$|\n|$20$|$10^6$|$20$|", "locale": "zh-CN"}}}
{"pid": "P4935", "type": "P", "difficulty": 7, "samples": [["2 3 3", "15"], ["4 7 5", "2845"], ["70 43 22", "992103136"], ["500 2011 999980895", "767094932"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "素数判断,质数,筛法", "生成函数", "洛谷月赛"], "title": "口袋里的纸飞机", "background": "现在我来到自己的故事难以用语言描绘的中心。文字的匮乏感从现在开始体现出来，因为描绘任何事物都要以交谈者共有的认知为前提，而我所经历的是比任何生活都更上一层的体验。先贤们在向普罗大众描绘世界之外的事物时往往运用宏大的概念。中国的道学家说天有九霄。《吠陀经》提到我们生存的土地只是千万重复制中的一个。爱斯基摩人则认为万物由一枚巨卵孵化而出。一个更恰当的比喻是所谓狄拉克之海，也即是全部空间和时间的上方和外部。虽然用有限的话语不可能描述一个无限的实体，但我记住了它的一部分，或许是最重要的一部分：\n\n\n我看见无限宽阔的海面和无限广袤的天穹，两者在无穷远处的地平线相接。视野的最中央站着一个紫色长发的女孩。我的身份和她不同：我是受她邀请而来的访客，海上的女孩才是这里的居民，或者说囚徒。正如我们不能随意造访世界之上的世界，她也永远不能和我们的生活有任何一点的交集。我明白自己在这里不会待上太久，而她把我招来只能为了一个理由。于是我听见了自己的声音在海面上回响，消散进虚无之中：\n\n\n“我会记住你。”\n\n\n她对我露出笑容。白色的光芒再一次亮起，女孩的身影好似被无形的火焰灼烧一样逐渐消散。我明白自己留不住这一刻，于是我哭了。使我哭泣的并不只是永恒的离别，还有对这个曾经在无尽的时间中陪伴过我们的孩子的怜惜和忏悔。\n我感到无限崇敬，无限悲哀。\n\n\n——西酱《口袋》", "description": "一个大小为$n$的数列$\\{a_i\\}$，每个数都在范围$[1,R]$中\n\n对于每种数列，可以生成一个$n\\times n$的网格，其中格子$(i,j)$中的数为$a_i\\times a_j \\mod P$\n\n比如，如果数列是$\\{1,2,3\\},P=5$，则生成的网格为\n```\n1 2 3\n2 4 1\n3 1 4(因为2*3%5=1,3*3%5=4)\n```\n\n对于一个网格，定义法法值为其中不同的数个数，比如上面那个就是4个数，即$\\{1,2,3,4\\}$。\n\n现在你需要对所有数列的法法值的和对$10^9+7$取模", "inputFormat": "第一行输入正整数$n,P,R$", "outputFormat": "输出答案对$10^9+7$取模", "hint": "样例1解释：\n```\n{ai}={1,1}:\n1 1\n1 1\n(ans=1)\n{ai}={1,2}:\n1 2\n2 1\n(ans=2)\n{ai}={1,3}:\n1 0\n0 0\n(ans=2)\n{ai}={2,1}:\n1 2\n2 1\n(ans=2)\n{ai}={2,2}:\n1 1\n1 1\n(ans=1)\n{ai}={2,3}:\n1 0\n0 0\n(ans=2)\n{ai}={3,1}:\n0 0\n0 1\n(ans=2)\n{ai}={3,2}:\n0 0\n0 1\n(ans=2)\n{ai}={3,3}:\n0 0\n0 0\n(ans=1)\n一共为15\n```\n\n\n保证$P$为大于等于3的质数\n\n|测试点|N|R|P|\n|---|---|---|---|\n|1,2|$N\\leq 5$|$R\\leq 5$|$R\\times R<P\\leq 20$|\n|3,4,5,6|$N\\leq 15$|$R\\leq 10$|$R\\times R<P\\leq 200$|\n|7,8|$N\\leq 30$| |$R\\times R<P\\leq 500$|\n|9,10,11,12|$N\\leq 100$| |$R\\times R<P\\leq 500$|\n|13,14,15,16|$N\\leq 300$|$R\\leq 10^9$|$P\\leq 1000$|\n|17,18,19,20|$N\\leq 500$|$R\\leq 10^9$|$P\\leq 5000$|\n\n对于所有数据，$n\\leq 500,P\\leq 5000,R\\leq 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "Paper Airplane in the Pocket", "background": "Now I have come to the center of my own story, which is hard to describe with words. From this moment on, the lack of language begins to show, because describing anything depends on shared understanding between speakers, and what I experienced was an experience beyond any ordinary life. When the sages described things beyond this world to the public, they often used grand concepts. Chinese Taoist scholars say the heavens have nine layers. The Vedas mention that the land we live on is only one of countless copies. The Eskimos believe that everything hatched from a giant egg. A more suitable metaphor is the so-called Dirac sea, that is, above and outside all space and time. Although it is impossible to describe an infinite entity with limited words, I remembered a part of it, perhaps the most important part:\n\nI saw an infinitely wide sea and an infinitely vast sky, meeting at the horizon infinitely far away. At the very center of my view stood a girl with long purple hair. My identity was different from hers: I was a visitor invited by her, while the girl on the sea was the resident here, or rather, a prisoner. Just as we cannot freely visit a world above our world, she can never have even the slightest intersection with our life. I understood that I would not stay here for long, and she could only have called me here for one reason. Then I heard my own voice echo over the sea, fading into the void:\n\n“I will remember you.”\n\nShe smiled at me. The white light lit up once again, and the girl’s figure gradually dissipated as if scorched by invisible flames. I understood that I could not keep this moment, so I cried. What made me cry was not only the eternal farewell, but also pity and remorse for this child who had once accompanied us through endless time.  \nI felt infinite reverence, infinite sorrow.\n\n— Xi Jiang, “Pocket”.", "description": "Given a sequence of length $n$, $\\{a_i\\}$, where each number is in the range $[1,R]$.\n\nFor each sequence, you can generate an $n\\times n$ grid, where the value in cell $(i,j)$ is $a_i\\times a_j \\bmod P$.\n\nFor example, if the sequence is $\\{1,2,3\\}$ and $P=5$, then the generated grid is\n```\n1 2 3\n2 4 1\n3 1 4(因为2*3%5=1,3*3%5=4)\n```\n\nFor a grid, define its “fafa value” as the number of distinct values appearing in it. For the grid above, it is $4$, i.e. $\\{1,2,3,4\\}$.\n\nNow you need to compute the sum of the fafa values over all sequences, and take it modulo $10^9+7$.", "inputFormat": "The first line contains positive integers $n,P,R$.", "outputFormat": "Output the answer modulo $10^9+7$.", "hint": "Explanation for Sample 1:\n```\n{ai}={1,1}:\n1 1\n1 1\n(ans=1)\n{ai}={1,2}:\n1 2\n2 1\n(ans=2)\n{ai}={1,3}:\n1 0\n0 0\n(ans=2)\n{ai}={2,1}:\n1 2\n2 1\n(ans=2)\n{ai}={2,2}:\n1 1\n1 1\n(ans=1)\n{ai}={2,3}:\n1 0\n0 0\n(ans=2)\n{ai}={3,1}:\n0 0\n0 1\n(ans=2)\n{ai}={3,2}:\n0 0\n0 1\n(ans=2)\n{ai}={3,3}:\n0 0\n0 0\n(ans=1)\nTotal is 15.\n```\n\nIt is guaranteed that $P$ is a prime number with $P\\geq 3$.\n\n## Constraints\n\n|Test Point|$N$|$R$|$P$|\n|---|---|---|---|\n|1,2|$N\\leq 5$|$R\\leq 5$|$R\\times R<P\\leq 20$|\n|3,4,5,6|$N\\leq 15$|$R\\leq 10$|$R\\times R<P\\leq 200$|\n|7,8|$N\\leq 30$| |$R\\times R<P\\leq 500$|\n|9,10,11,12|$N\\leq 100$| |$R\\times R<P\\leq 500$|\n|13,14,15,16|$N\\leq 300$|$R\\leq 10^9$|$P\\leq 1000$|\n|17,18,19,20|$N\\leq 500$|$R\\leq 10^9$|$P\\leq 5000$|\n\nFor all data, $n\\leq 500,P\\leq 5000,R\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "口袋里的纸飞机", "background": "现在我来到自己的故事难以用语言描绘的中心。文字的匮乏感从现在开始体现出来，因为描绘任何事物都要以交谈者共有的认知为前提，而我所经历的是比任何生活都更上一层的体验。先贤们在向普罗大众描绘世界之外的事物时往往运用宏大的概念。中国的道学家说天有九霄。《吠陀经》提到我们生存的土地只是千万重复制中的一个。爱斯基摩人则认为万物由一枚巨卵孵化而出。一个更恰当的比喻是所谓狄拉克之海，也即是全部空间和时间的上方和外部。虽然用有限的话语不可能描述一个无限的实体，但我记住了它的一部分，或许是最重要的一部分：\n\n\n我看见无限宽阔的海面和无限广袤的天穹，两者在无穷远处的地平线相接。视野的最中央站着一个紫色长发的女孩。我的身份和她不同：我是受她邀请而来的访客，海上的女孩才是这里的居民，或者说囚徒。正如我们不能随意造访世界之上的世界，她也永远不能和我们的生活有任何一点的交集。我明白自己在这里不会待上太久，而她把我招来只能为了一个理由。于是我听见了自己的声音在海面上回响，消散进虚无之中：\n\n\n“我会记住你。”\n\n\n她对我露出笑容。白色的光芒再一次亮起，女孩的身影好似被无形的火焰灼烧一样逐渐消散。我明白自己留不住这一刻，于是我哭了。使我哭泣的并不只是永恒的离别，还有对这个曾经在无尽的时间中陪伴过我们的孩子的怜惜和忏悔。\n我感到无限崇敬，无限悲哀。\n\n\n——西酱《口袋》", "description": "一个大小为$n$的数列$\\{a_i\\}$，每个数都在范围$[1,R]$中\n\n对于每种数列，可以生成一个$n\\times n$的网格，其中格子$(i,j)$中的数为$a_i\\times a_j \\mod P$\n\n比如，如果数列是$\\{1,2,3\\},P=5$，则生成的网格为\n```\n1 2 3\n2 4 1\n3 1 4(因为2*3%5=1,3*3%5=4)\n```\n\n对于一个网格，定义法法值为其中不同的数个数，比如上面那个就是4个数，即$\\{1,2,3,4\\}$。\n\n现在你需要对所有数列的法法值的和对$10^9+7$取模", "inputFormat": "第一行输入正整数$n,P,R$", "outputFormat": "输出答案对$10^9+7$取模", "hint": "样例1解释：\n```\n{ai}={1,1}:\n1 1\n1 1\n(ans=1)\n{ai}={1,2}:\n1 2\n2 1\n(ans=2)\n{ai}={1,3}:\n1 0\n0 0\n(ans=2)\n{ai}={2,1}:\n1 2\n2 1\n(ans=2)\n{ai}={2,2}:\n1 1\n1 1\n(ans=1)\n{ai}={2,3}:\n1 0\n0 0\n(ans=2)\n{ai}={3,1}:\n0 0\n0 1\n(ans=2)\n{ai}={3,2}:\n0 0\n0 1\n(ans=2)\n{ai}={3,3}:\n0 0\n0 0\n(ans=1)\n一共为15\n```\n\n\n保证$P$为大于等于3的质数\n\n|测试点|N|R|P|\n|---|---|---|---|\n|1,2|$N\\leq 5$|$R\\leq 5$|$R\\times R<P\\leq 20$|\n|3,4,5,6|$N\\leq 15$|$R\\leq 10$|$R\\times R<P\\leq 200$|\n|7,8|$N\\leq 30$| |$R\\times R<P\\leq 500$|\n|9,10,11,12|$N\\leq 100$| |$R\\times R<P\\leq 500$|\n|13,14,15,16|$N\\leq 300$|$R\\leq 10^9$|$P\\leq 1000$|\n|17,18,19,20|$N\\leq 500$|$R\\leq 10^9$|$P\\leq 5000$|\n\n对于所有数据，$n\\leq 500,P\\leq 5000,R\\leq 10^9$", "locale": "zh-CN"}}}
{"pid": "P4936", "type": "P", "difficulty": 3, "samples": [["3", "5"], ["6", "129"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "Agent1", "background": "2018年11月17日，中国香港将会迎来一场`XM大战`，是世界各地的`ENLIGHTENED`与`RESISTANCE`开战的地点，某地 的`ENLIGHTENED总部`也想派`Agent`去参加这次的`XM大战`，与世界其他地方的`ENLIGHTENED`并肩作战。", "description": "某地的`ENLIGHTENED总部`总部有$N$个`Agent`，每个`Agent`的能力值互不相同，现在`ENLIGHTENED行动指挥`想要派出$A,B$两队`Agent`去参加`XM大战`。但是参加大战的两个队伍要满足两个要求：\n\n1. $A$队中能力最大的`Agent`的能力值要小于$B$队能力最弱的`Agent`的能力值。\n2. $A,B$两队都要有人参战。\n\n并不一定所有的`Agent`都要去参加`XM大战`的，心急的`ENLIGHTENED行动指挥`想知道有多少种安排`Agent`参加大战的方案。由于答案可能很大，所以只需要你求出答案模$(10^9+7)$的值就可以了。", "inputFormat": "输入仅一行，为一个整数$N$。", "outputFormat": "输出答案模$(10^9+7)$的值。", "hint": "对于$20\\%$的数据 $N \\leq 10$\n\n对于$40\\%$的数据 $N \\leq 10^3$\n\n对于$60\\%$的数据 $N \\leq 10^5$\n\n对于$100\\%$的数据 $N \\leq 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "Agent1", "background": "On November 17, 2018, Hong Kong, China will host an `XM war`, where `ENLIGHTENED` and `RESISTANCE` from all over the world will fight. An `ENLIGHTENED headquarters` in some place also wants to send `Agents` to join this `XM war`, fighting side by side with `ENLIGHTENED` from other places.", "description": "An `ENLIGHTENED headquarters` in some place has $N$ `Agents`, and each `Agent` has a different ability value. Now the `ENLIGHTENED operation commander` wants to send two teams of `Agents`, Team $A$ and Team $B$, to take part in the `XM war`. However, the two teams must satisfy two requirements:\n\n1. The ability value of the strongest `Agent` in Team $A$ must be less than the ability value of the weakest `Agent` in Team $B$.\n2. Both Team $A$ and Team $B$ must have at least one person.\n\nNot all `Agents` must go to the `XM war`. The impatient `ENLIGHTENED operation commander` wants to know how many different ways there are to arrange `Agents` to join the war. Since the answer may be very large, you only need to output the value of the answer modulo $(10^9+7)$.", "inputFormat": "The input contains only one line, an integer $N$.", "outputFormat": "Output the answer modulo $(10^9+7)$.", "hint": "For $20\\%$ of the testdata, $N \\leq 10$.\n\nFor $40\\%$ of the testdata, $N \\leq 10^3$.\n\nFor $60\\%$ of the testdata, $N \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $N \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Agent1", "background": "2018年11月17日，中国香港将会迎来一场`XM大战`，是世界各地的`ENLIGHTENED`与`RESISTANCE`开战的地点，某地 的`ENLIGHTENED总部`也想派`Agent`去参加这次的`XM大战`，与世界其他地方的`ENLIGHTENED`并肩作战。", "description": "某地的`ENLIGHTENED总部`总部有$N$个`Agent`，每个`Agent`的能力值互不相同，现在`ENLIGHTENED行动指挥`想要派出$A,B$两队`Agent`去参加`XM大战`。但是参加大战的两个队伍要满足两个要求：\n\n1. $A$队中能力最大的`Agent`的能力值要小于$B$队能力最弱的`Agent`的能力值。\n2. $A,B$两队都要有人参战。\n\n并不一定所有的`Agent`都要去参加`XM大战`的，心急的`ENLIGHTENED行动指挥`想知道有多少种安排`Agent`参加大战的方案。由于答案可能很大，所以只需要你求出答案模$(10^9+7)$的值就可以了。", "inputFormat": "输入仅一行，为一个整数$N$。", "outputFormat": "输出答案模$(10^9+7)$的值。", "hint": "对于$20\\%$的数据 $N \\leq 10$\n\n对于$40\\%$的数据 $N \\leq 10^3$\n\n对于$60\\%$的数据 $N \\leq 10^5$\n\n对于$100\\%$的数据 $N \\leq 10^9$", "locale": "zh-CN"}}}
{"pid": "P4937", "type": "P", "difficulty": 5, "samples": [["3\n5 6 5\n1 8 2\n2 7 3\n", "7\n2\n1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["Special Judge"], "title": "Portal1", "background": "Agent 获取资源有很多种方式，HACK 就是其中的一种，侵入 Portal 可以获得很多有用的资源。\n\nENLIGHTENED 总部因为参加 XM 大战，只剩下一点点可用资源了，所以 ENLIGHTENED 行动指挥想要进行 HACK 活动，尽量增加库存。", "description": "地图上有 $n$ 个可以被 HACK 的 Portal，编号为 $1\\sim n$。HACK 第 $i$ 号 Portal 需要时间 $t_i$ 秒，可以 HACK 出 $c_i$ 库存的资源。可是只有有能量的 Portal 才可以 HACK 出资源。第 $i$ 号 Portal 在第 $d_i$ 秒时，能量就会消失殆尽。ENLIGHTEDED 想知道，最多可以增加多少库存，并且按编号小到大输出需要 HACK 的 Portal 的编号。", "inputFormat": "第一行输入一个整数 $n$。\n\n下接 $n$ 行，每行三个整数 $t_i$，$d_i$，$c_i$。", "outputFormat": "输出第一行为一个整数，最多可以增加多少库存。\n\n第二行为一个整数，代表需要 HACK 多少个 Portal。\n\n第三行按编号小到大输出需要 HACK 的 Portal 的编号，若有多种 HACK 的方案输出其中一种即可。", "hint": "对于 $20\\%$ 的数据，$n\\leq5$，$t_i\\leq 5$，$c_i\\leq 5$，$d_i\\leq10$。\n\n对于 $40\\%$ 的数据，$n\\leq 20$，$t_i\\leq 10$，$c_i\\leq 10$，$d_i\\leq 100$。\n\n对于 $60\\%$ 的数据，$n\\leq50$，$t_i\\leq15$，$c_i\\leq15$，$d_i\\leq1000$。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 100$，$1 \\leq t_i \\leq 20$，$1\\leq c_i \\leq 20$，$1 \\leq d_i \\leq 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "Portal1", "background": "There are many ways for an Agent to obtain resources, and HACK is one of them. By breaking into a Portal, you can get many useful resources.\n\nBecause the ENLIGHTENED headquarters joined the XM war, there are only a small amount of usable resources left. Therefore, the ENLIGHTENED operation commander wants to carry out HACK activities to increase the inventory as much as possible.", "description": "There are $n$ Portals on the map that can be HACKed, numbered from $1$ to $n$. HACKing Portal $i$ takes $t_i$ seconds and can produce $c_i$ resources to add to the inventory. However, only Portals with energy can produce resources when HACKed. For Portal $i$, its energy will be completely depleted at time $d_i$ seconds. ENLIGHTENED wants to know the maximum amount the inventory can be increased, and also output the indices of the Portals that need to be HACKed in increasing order.", "inputFormat": "The first line contains an integer $n$.\n\nThe next $n$ lines each contain three integers $t_i$, $d_i$, $c_i$.", "outputFormat": "The first line outputs an integer: the maximum amount the inventory can be increased.\n\nThe second line outputs an integer: how many Portals need to be HACKed.\n\nThe third line outputs the indices of the Portals to be HACKed in increasing order. If there are multiple valid HACK plans, output any one of them.", "hint": "For $20\\%$ of the data, $n\\leq5$, $t_i\\leq 5$, $c_i\\leq 5$, $d_i\\leq10$.\n\nFor $40\\%$ of the data, $n\\leq 20$, $t_i\\leq 10$, $c_i\\leq 10$, $d_i\\leq 100$.\n\nFor $60\\%$ of the data, $n\\leq50$, $t_i\\leq15$, $c_i\\leq15$, $d_i\\leq1000$.\n\nFor $100\\%$ of the data, $1\\leq n\\leq 100$, $1 \\leq t_i \\leq 20$, $1\\leq c_i \\leq 20$, $1 \\leq d_i \\leq 2000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Portal1", "background": "Agent 获取资源有很多种方式，HACK 就是其中的一种，侵入 Portal 可以获得很多有用的资源。\n\nENLIGHTENED 总部因为参加 XM 大战，只剩下一点点可用资源了，所以 ENLIGHTENED 行动指挥想要进行 HACK 活动，尽量增加库存。", "description": "地图上有 $n$ 个可以被 HACK 的 Portal，编号为 $1\\sim n$。HACK 第 $i$ 号 Portal 需要时间 $t_i$ 秒，可以 HACK 出 $c_i$ 库存的资源。可是只有有能量的 Portal 才可以 HACK 出资源。第 $i$ 号 Portal 在第 $d_i$ 秒时，能量就会消失殆尽。ENLIGHTEDED 想知道，最多可以增加多少库存，并且按编号小到大输出需要 HACK 的 Portal 的编号。", "inputFormat": "第一行输入一个整数 $n$。\n\n下接 $n$ 行，每行三个整数 $t_i$，$d_i$，$c_i$。", "outputFormat": "输出第一行为一个整数，最多可以增加多少库存。\n\n第二行为一个整数，代表需要 HACK 多少个 Portal。\n\n第三行按编号小到大输出需要 HACK 的 Portal 的编号，若有多种 HACK 的方案输出其中一种即可。", "hint": "对于 $20\\%$ 的数据，$n\\leq5$，$t_i\\leq 5$，$c_i\\leq 5$，$d_i\\leq10$。\n\n对于 $40\\%$ 的数据，$n\\leq 20$，$t_i\\leq 10$，$c_i\\leq 10$，$d_i\\leq 100$。\n\n对于 $60\\%$ 的数据，$n\\leq50$，$t_i\\leq15$，$c_i\\leq15$，$d_i\\leq1000$。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 100$，$1 \\leq t_i \\leq 20$，$1\\leq c_i \\leq 20$，$1 \\leq d_i \\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P4938", "type": "P", "difficulty": 6, "samples": [["3 2 \n1 2 3\n0 0 6\n1 3\n2 3\n", "YES\n0 0 1\n0 0 2\n0 0 3 "], ["3 2 \n1 2 3\n0 0 7\n1 3\n2 3", "NO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["网络流", "Special Judge"], "title": "War1", "background": "`XM` 大战来临之际，`ENLIGHTENED` 总部为了抵御 `RESISTANCE` 的进攻，调整了某地 `Portal` 的能量值，使得其可以经受更多的打击。", "description": "`ENLIGHTENED` 总部有 $N$ 个 `Portal`，编号为 $1\\sim N$，编号为 $i$ 的`Portal`初始能量值为 $A_i$，在 `Portal` 之间有 $M$ 条 `LINK`，每条 `LINK` 着连接着两个不同 `Portal`，被连接着的两个 `Portal` 可以相互传输能量，每个 `Portal` 最多总共只能向其连接着的 `Portal` 传输 $A_i$ 点能量，现在 `ENLIGHTENED` 行动指挥想让每第 $i$ 个 `Portal` 的能量值变为至少 $B_i$，但他不知道着可不可行，所以找到了你，如果可行的话，需要你求出一种可行的能量传输方案。\n\n**能量只能直接传输不能间接传输**", "inputFormat": "第一行数两个个整数 $N,M$。\n\n第二行有 $N$ 个整数，第 $i$ 个整数代表 $A_i$。\n\n第三行有 $N$ 个整数，第 $i$ 个整数代表 $B_i$。\n\n下接 $M$ 行，每行输入两个整数 $X,Y$，代表编号为 $X$ 的 `Portal` 到编号为 $Y$ 的 `Portal` 有一条 `LINK`。", "outputFormat": "若有可行方案输出 `YES`，并且下接 $N$ 行，每行 $N$ 个整数，第 $i$ 行第 $j$ 个数代表代表编号为 $i$ 的 `Portal` 向编号为 $j$ 的 `Portal` 传输的能量值。若 $i=j$ 输出第 $i$ 个 `Portal` 传输后留下的能量值。若有多种可行方案输出其中一种即可。\n\n若无可行方案输出 `NO`。", "hint": "对于 $20\\%$ 的数据 $N \\leq 10$。\n\n对于 $40\\%$ 的数据 $N\\leq 25$。\n\n对于 $60\\%$ 的数据 $N\\leq 50$。\n\n对于 $100\\%$ 的数据 $N \\leq 100,M \\leq 2*N,0 \\leq A_i,B_i \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "War1", "background": "As the `XM` war is approaching, the `ENLIGHTENED` headquarters, in order to withstand the attack from `RESISTANCE`, adjusted the energy value of a `Portal` in some place so that it can take more hits.", "description": "`ENLIGHTENED` headquarters has $N$ `Portal`s, numbered from $1$ to $N$. The initial energy value of `Portal` $i$ is $A_i$. There are $M$ `LINK`s between the `Portal`s. Each `LINK` connects two different `Portal`s. The two connected `Portal`s can transfer energy to each other. Each `Portal` can transfer at most a total of $A_i$ energy to the `Portal`s connected to it.\n\nNow, the `ENLIGHTENED` operation commander wants the energy value of each `Portal` $i$ to become at least $B_i$, but he does not know whether this is possible, so he asked you. If it is possible, you need to find one feasible energy transfer plan.\n\n**Energy can only be transferred directly, not indirectly.**", "inputFormat": "The first line contains two integers $N, M$.\n\nThe second line contains $N$ integers, where the $i$-th integer represents $A_i$.\n\nThe third line contains $N$ integers, where the $i$-th integer represents $B_i$.\n\nThen follow $M$ lines. Each line contains two integers $X, Y$, indicating that there is a `LINK` between `Portal` $X$ and `Portal` $Y$.", "outputFormat": "If there is a feasible plan, output `YES`, followed by $N$ lines, each containing $N$ integers. The number in row $i$ and column $j$ represents the amount of energy transferred from `Portal` $i$ to `Portal` $j$. If $i = j$, output the amount of energy remaining in `Portal` $i$ after transfers. If there are multiple feasible plans, output any one of them.\n\nIf there is no feasible plan, output `NO`.", "hint": "For $20\\%$ of the testdata, $N \\leq 10$.\n\nFor $40\\%$ of the testdata, $N \\leq 25$.\n\nFor $60\\%$ of the testdata, $N \\leq 50$.\n\nFor $100\\%$ of the testdata, $N \\leq 100$, $M \\leq 2 * N$, and $0 \\leq A_i, B_i \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "War1", "background": "`XM` 大战来临之际，`ENLIGHTENED` 总部为了抵御 `RESISTANCE` 的进攻，调整了某地 `Portal` 的能量值，使得其可以经受更多的打击。", "description": "`ENLIGHTENED` 总部有 $N$ 个 `Portal`，编号为 $1\\sim N$，编号为 $i$ 的`Portal`初始能量值为 $A_i$，在 `Portal` 之间有 $M$ 条 `LINK`，每条 `LINK` 着连接着两个不同 `Portal`，被连接着的两个 `Portal` 可以相互传输能量，每个 `Portal` 最多总共只能向其连接着的 `Portal` 传输 $A_i$ 点能量，现在 `ENLIGHTENED` 行动指挥想让每第 $i$ 个 `Portal` 的能量值变为至少 $B_i$，但他不知道着可不可行，所以找到了你，如果可行的话，需要你求出一种可行的能量传输方案。\n\n**能量只能直接传输不能间接传输**", "inputFormat": "第一行数两个个整数 $N,M$。\n\n第二行有 $N$ 个整数，第 $i$ 个整数代表 $A_i$。\n\n第三行有 $N$ 个整数，第 $i$ 个整数代表 $B_i$。\n\n下接 $M$ 行，每行输入两个整数 $X,Y$，代表编号为 $X$ 的 `Portal` 到编号为 $Y$ 的 `Portal` 有一条 `LINK`。", "outputFormat": "若有可行方案输出 `YES`，并且下接 $N$ 行，每行 $N$ 个整数，第 $i$ 行第 $j$ 个数代表代表编号为 $i$ 的 `Portal` 向编号为 $j$ 的 `Portal` 传输的能量值。若 $i=j$ 输出第 $i$ 个 `Portal` 传输后留下的能量值。若有多种可行方案输出其中一种即可。\n\n若无可行方案输出 `NO`。", "hint": "对于 $20\\%$ 的数据 $N \\leq 10$。\n\n对于 $40\\%$ 的数据 $N\\leq 25$。\n\n对于 $60\\%$ 的数据 $N\\leq 50$。\n\n对于 $100\\%$ 的数据 $N \\leq 100,M \\leq 2*N,0 \\leq A_i,B_i \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P4939", "type": "P", "difficulty": 4, "samples": [["5 5\n0 1 2\n0 1 5\n1 1\n0 3 5\n1 5", "2\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["树状数组", "O2优化", "差分"], "title": "Agent2", "background": "炎炎夏日还没有过去，Agent 们没有一个想出去外面搞事情的。每当 ENLIGHTENED 总部组织活动时，人人都说有空，结果到了活动日，却一个接着一个咕咕咕了。只有不咕鸟 `Lyn_king` 一个人冒着太阳等了半个多小时，然后居然看到连 ENLIGHTENED 行动参谋都咕咕咕了，果然咕咕咕是人类的本性啊。", "description": "作为一个 ENLIGHTENED 行动指挥，自然不想看到这一点，于是他偷取到了那些经常咕咕咕的 Agent 的在下来 $N$ 天的 `活动安排表`，并且叫上了你来整理。在整理过程中，ENLIGHTENED 行动指挥对你说了 $M$ 条命令，命令操作如下。\n1. 输入 $0,a,b$，这代表在第 $a$ 天到第 $b$ 天，有一名 Agent 要咕咕咕。\n2. 输入 $1$ $a$，这代表 ENLIGHTENED 行动指挥询问你根据目前的信息，在第 $a$ 天有多少名 Agent 会咕咕咕。\n\n作为同是不咕鸟的你，也想要惩戒那些经常咕咕咕的人，所以，请协助完成 ENLIGHTENED 行动指挥完成整理，并且在他每次询问时，输出正确的答案。", "inputFormat": "第一行输入两个整数 $N,M$，接下来 $M$ 行,每行输入一个命令，命令格式见题目描述。", "outputFormat": "对于每一次询问的操作，都要输出询问的答案。答案之间用换行隔开。", "hint": "对于 $20\\%$ 的数据 $N,M \\leq 10$；\n\n对于 $40\\%$ 的数据 $N,M \\leq 10^3$；\n\n对于 $60\\%$ 的数据 $N,M \\leq 10^5$；\n\n对于 $100\\%$ 的数据 $1 \\leq a,b \\leq N \\leq 10^7,M \\leq 4\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Agent2", "background": "The scorching summer has not ended yet, and none of the Agents want to go outside to do anything. Whenever ENLIGHTENED headquarters organizes an event, everyone says they are free, but when the event day arrives, they “gu gu gu” (cancel) one after another. Only the “never-cancel bird” `Lyn_king` waited under the sun for more than half an hour, and then even saw that the ENLIGHTENED operations staff also “gu gu gu”. Sure enough, “gu gu gu” is human nature.", "description": "As an ENLIGHTENED operations commander, he naturally does not want to see this happen. So he secretly obtained the `event schedule` of those Agents who often “gu gu gu”, for the next $N$ days, and asked you to help organize it. During the organizing process, the ENLIGHTENED operations commander gave you $M$ commands. The commands are as follows.\n\n1. Input $0,a,b$, which means that from day $a$ to day $b$, one Agent will “gu gu gu”.\n2. Input $1$ $a$, which means that the ENLIGHTENED operations commander asks you, based on the current information, how many Agents will “gu gu gu” on day $a$.\n\nAs someone who is also a “never-cancel bird”, you also want to punish those who often “gu gu gu”. Therefore, please help the ENLIGHTENED operations commander finish the organizing, and each time he asks, output the correct answer.", "inputFormat": "The first line contains two integers $N, M$. The next $M$ lines each contain one command. The command format is given in the Description.", "outputFormat": "For each query operation, output the answer to the query. Separate answers by newlines.", "hint": "For $20\\%$ of the testdata, $N, M \\leq 10$.\n\nFor $40\\%$ of the testdata, $N, M \\leq 10^3$.\n\nFor $60\\%$ of the testdata, $N, M \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\leq a, b \\leq N \\leq 10^7$, $M \\leq 4 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Agent2", "background": "炎炎夏日还没有过去，Agent 们没有一个想出去外面搞事情的。每当 ENLIGHTENED 总部组织活动时，人人都说有空，结果到了活动日，却一个接着一个咕咕咕了。只有不咕鸟 `Lyn_king` 一个人冒着太阳等了半个多小时，然后居然看到连 ENLIGHTENED 行动参谋都咕咕咕了，果然咕咕咕是人类的本性啊。", "description": "作为一个 ENLIGHTENED 行动指挥，自然不想看到这一点，于是他偷取到了那些经常咕咕咕的 Agent 的在下来 $N$ 天的 `活动安排表`，并且叫上了你来整理。在整理过程中，ENLIGHTENED 行动指挥对你说了 $M$ 条命令，命令操作如下。\n1. 输入 $0,a,b$，这代表在第 $a$ 天到第 $b$ 天，有一名 Agent 要咕咕咕。\n2. 输入 $1$ $a$，这代表 ENLIGHTENED 行动指挥询问你根据目前的信息，在第 $a$ 天有多少名 Agent 会咕咕咕。\n\n作为同是不咕鸟的你，也想要惩戒那些经常咕咕咕的人，所以，请协助完成 ENLIGHTENED 行动指挥完成整理，并且在他每次询问时，输出正确的答案。", "inputFormat": "第一行输入两个整数 $N,M$，接下来 $M$ 行,每行输入一个命令，命令格式见题目描述。", "outputFormat": "对于每一次询问的操作，都要输出询问的答案。答案之间用换行隔开。", "hint": "对于 $20\\%$ 的数据 $N,M \\leq 10$；\n\n对于 $40\\%$ 的数据 $N,M \\leq 10^3$；\n\n对于 $60\\%$ 的数据 $N,M \\leq 10^5$；\n\n对于 $100\\%$ 的数据 $1 \\leq a,b \\leq N \\leq 10^7,M \\leq 4\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4940", "type": "P", "difficulty": 4, "samples": [["PUSH 0 10\nPUSH 0 20\nPUSH 0 30\nPUSH 0 40\nPUSH 1 50\nPUSH 1 60\nADD 0\nADD 0\nADD 0\nEND", "SUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nUNSUCCESS\nSUCCESS\n150 30 20 10\nNONE"], ["PUSH 0 10\nPUSH 0 20\nPUSH 0 30\nPUSH 0 40\nPUSH 1 50\nPUSH 1 60\nMOVE 0 1\nEND", "SUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\n50 60 40 30 20 10\nNONE"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "枚举", "栈", "启发式合并"], "title": "Portal 2", "background": "某地 ENLIGHTENED 的“XM 研究所”正在研究 Portal 的处理法则，想要揭示“XM 能量”的来源以及应用“XM 能量”。ENLIGHTENED 的首席科学家 Jacks 发现其能量的运算法则以及运算方法，但是方法十分复杂，仅靠人手工计算是很难算出答案的，所以它需要你协助他完成计算。", "description": "Portal 计算“XM 能量”是通过个 $2$ 个栈（$0$ 号栈、$1$ 号栈）实现的，它把对“XM 能量”的操作如下：\n\n- `PUSH X NUM`：把 $NUM$ 加入到 $X$ 号栈的栈顶。\n\n- `POP X`：把 $X$ 号栈的栈顶元素**删除**。\n\n- `ADD X`：**取出** $0$ 号栈和 $1$ 号栈的元素各一个，并且把它的和放入 $X$ 号栈。\n\n- `SUB X`：**取出** $0$ 号栈和 $1$ 号栈的元素各一个，并且把它的差的绝对值放入 $X$ 号栈。\n \n- `DEL X`：**清空** $X$ 号栈中所有元素不管栈是否为空。\n\n- `MOVE X Y`：循环操作直到 $Y$ 号栈为空，把 $Y$ 号栈的栈顶元素加入到 $X$ 号栈，删除 $Y$ 号栈的栈顶元素（**数据保证 $X$ 和 $Y$ 不相同**）。\n\n- `SWAP`：将两个栈的所有元素调换。\n\n- `END`：代表命令结束，并且分两行分别输出 $0$ 号栈和 $1$ 号栈由栈顶到栈底的元素的值，若栈内无元素，输出 `NONE`。数据保证指令以 `END` 结束且仅有一个 `END`，并且也需要输出 `SUCCESS`。\n\n- ~~`AKNOI` 等为无效操作，**无效操作后不接数字**。~~**更正不会有类似无效操作**。\n\n对于每一行指令，若当前指令成功执行输出 `SUCCESS`，若**取出**或**删除**元素时栈内为空或者没有对应指令输出 `UNSUCCESS` 并且不执行该行指令。", "inputFormat": "输入若干行指令，以 `END` 指令结束。", "outputFormat": "对于每一次操作，都要对应输出 `SUCCESS` 或者 `UNSUCCESS`，对于 `END` 根据指令描述输出栈内元素。", "hint": "设命令总数为 $n$。\n\n对于 $20\\%$ 的数据，数据保证不会出现 `MOVE,SWAP` 操作，$1\\le n \\leq 100$；\n\n对于 $40\\%$ 的数据，$1\\le n \\leq 1000$；\n\n对于 $60\\%$ 的数据，数据保证 `MOVE,SWAP` 的操作次数不会超过 $10000$ 次，$1\\leq n \\leq 10^5$；\n\n对于 $100\\%$ 的数据，$0 \\leq X,Y \\leq 1,1\\leq n \\leq 10^6$；\n\n**数据保证无论任何情况，栈中元素的值 $X$ 满足 $0 \\leq X \\leq 2^{63}-1$。**\n\n[题目创意来源 OIERBBS](https://www.oierbbs.cn)。", "locale": "zh-CN", "translations": {"en": {"title": "Portal 2", "background": "The “XM Institute” of ENLIGHTENED in a certain place is studying the processing rules of Portals, trying to reveal the source of “XM energy” and how to use it. ENLIGHTENED’s chief scientist Jacks has found the rules and methods for computing this energy, but the method is very complex. It is hard to get the answer by manual calculation, so he needs your help to finish the computation.", "description": "Portal computes “XM energy” using $2$ stacks (stack $0$ and stack $1$). The operations on “XM energy” are as follows:\n\n- `PUSH X NUM`: Push $NUM$ onto the top of stack $X$.\n\n- `POP X`: **Delete** the top element of stack $X$.\n\n- `ADD X`: **Take out** one element from stack $0$ and one element from stack $1$, and push their sum onto stack $X$.\n\n- `SUB X`: **Take out** one element from stack $0$ and one element from stack $1$, and push the absolute value of their difference onto stack $X$.\n\n- `DEL X`: **Clear** all elements in stack $X$, regardless of whether the stack is empty.\n\n- `MOVE X Y`: Repeat until stack $Y$ is empty: push the top element of stack $Y$ onto stack $X$, then delete the top element of stack $Y$ (**the testdata guarantees that $X$ and $Y$ are different**).\n\n- `SWAP`: Swap all elements of the two stacks.\n\n- `END`: Indicates the end of commands. Then output, on two separate lines, the values in stack $0$ and stack $1$ from top to bottom. If a stack has no elements, output `NONE`. The testdata guarantees that the commands end with `END` and there is only one `END`. You also need to output `SUCCESS`.\n\n- ~~`AKNOI` and so on are invalid operations, and **invalid operations are not followed by numbers**.~~ **Correction: there will be no such invalid operations.**\n\nFor each command line: if the current command is executed successfully, output `SUCCESS`. If, when **taking out** or **deleting** elements, the required stack is empty, or if there is no corresponding command, output `UNSUCCESS` and do not execute that command line.", "inputFormat": "Input several lines of commands, ending with the `END` command.", "outputFormat": "For each operation, output `SUCCESS` or `UNSUCCESS` accordingly. For `END`, output the stack elements as described in the command description.", "hint": "Let the total number of commands be $n$.\n\nFor $20\\%$ of the testdata, it is guaranteed that there will be no `MOVE` or `SWAP` operations, and $1\\le n \\leq 100$.\n\nFor $40\\%$ of the testdata, $1\\le n \\leq 1000$.\n\nFor $60\\%$ of the testdata, it is guaranteed that the number of `MOVE` and `SWAP` operations will not exceed $10000$, and $1\\leq n \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $0 \\leq X,Y \\leq 1,1\\leq n \\leq 10^6$.\n\n**The testdata guarantees that in all cases, the value $X$ of any element in the stacks satisfies $0 \\leq X \\leq 2^{63}-1$.**\n\n[Problem idea source: OIERBBS](https://www.oierbbs.cn)。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Portal 2", "background": "某地 ENLIGHTENED 的“XM 研究所”正在研究 Portal 的处理法则，想要揭示“XM 能量”的来源以及应用“XM 能量”。ENLIGHTENED 的首席科学家 Jacks 发现其能量的运算法则以及运算方法，但是方法十分复杂，仅靠人手工计算是很难算出答案的，所以它需要你协助他完成计算。", "description": "Portal 计算“XM 能量”是通过个 $2$ 个栈（$0$ 号栈、$1$ 号栈）实现的，它把对“XM 能量”的操作如下：\n\n- `PUSH X NUM`：把 $NUM$ 加入到 $X$ 号栈的栈顶。\n\n- `POP X`：把 $X$ 号栈的栈顶元素**删除**。\n\n- `ADD X`：**取出** $0$ 号栈和 $1$ 号栈的元素各一个，并且把它的和放入 $X$ 号栈。\n\n- `SUB X`：**取出** $0$ 号栈和 $1$ 号栈的元素各一个，并且把它的差的绝对值放入 $X$ 号栈。\n \n- `DEL X`：**清空** $X$ 号栈中所有元素不管栈是否为空。\n\n- `MOVE X Y`：循环操作直到 $Y$ 号栈为空，把 $Y$ 号栈的栈顶元素加入到 $X$ 号栈，删除 $Y$ 号栈的栈顶元素（**数据保证 $X$ 和 $Y$ 不相同**）。\n\n- `SWAP`：将两个栈的所有元素调换。\n\n- `END`：代表命令结束，并且分两行分别输出 $0$ 号栈和 $1$ 号栈由栈顶到栈底的元素的值，若栈内无元素，输出 `NONE`。数据保证指令以 `END` 结束且仅有一个 `END`，并且也需要输出 `SUCCESS`。\n\n- ~~`AKNOI` 等为无效操作，**无效操作后不接数字**。~~**更正不会有类似无效操作**。\n\n对于每一行指令，若当前指令成功执行输出 `SUCCESS`，若**取出**或**删除**元素时栈内为空或者没有对应指令输出 `UNSUCCESS` 并且不执行该行指令。", "inputFormat": "输入若干行指令，以 `END` 指令结束。", "outputFormat": "对于每一次操作，都要对应输出 `SUCCESS` 或者 `UNSUCCESS`，对于 `END` 根据指令描述输出栈内元素。", "hint": "设命令总数为 $n$。\n\n对于 $20\\%$ 的数据，数据保证不会出现 `MOVE,SWAP` 操作，$1\\le n \\leq 100$；\n\n对于 $40\\%$ 的数据，$1\\le n \\leq 1000$；\n\n对于 $60\\%$ 的数据，数据保证 `MOVE,SWAP` 的操作次数不会超过 $10000$ 次，$1\\leq n \\leq 10^5$；\n\n对于 $100\\%$ 的数据，$0 \\leq X,Y \\leq 1,1\\leq n \\leq 10^6$；\n\n**数据保证无论任何情况，栈中元素的值 $X$ 满足 $0 \\leq X \\leq 2^{63}-1$。**\n\n[题目创意来源 OIERBBS](https://www.oierbbs.cn)。", "locale": "zh-CN"}}}
{"pid": "P4941", "type": "P", "difficulty": 5, "samples": [["3 2 1\n1 1 1\n1 2 3", "5"], ["4 3 2\n1 1 1 1\n4 3 2\n3 2 1", "6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "War2", "background": "`XM大战`如期而至，`Agent`们齐聚一地，展开最后的对决。对战有很多种方式，有些复杂的方式可以获得更高的分数。可惜`ENLIGHTENED`的人并不怎么聪明，只会简单的`hack`，所以`ENLIGHTENED行动指挥`找到了你来做他们的总参谋。", "description": "地图上有$N$个`Portal`，现在某一名`Agent`的任务是占领该地图上的$M$个`Portal`，这名`Agent`占领第$i$个`Portal`可以得到的分数为$A[i]$，除了直接占领，还有其他的$K$种加分方式，对于着$N$个`Portal`，在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分，加分可能会有重复。`Agent`希望他可以为团队争取更多的分数，所以请求作为大战参谋的你来帮助他。", "inputFormat": "第一行是输入三个整数$N,M,K$\n第二行输入是$N$个数，第$i$个数代表$A[i]$的值。\n下面$K$行每行有3个整数$X[i],Y[i],C[i]$，表示在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分", "outputFormat": "输出仅一行一个整数，为该名`Agent`可以获得的最大分数值。", "hint": "对于$20\\%$的数据 $1 \\leq M \\leq N \\leq 4,0 \\leq A[i],B[i] \\leq 10^3$\n\n对于$40\\%$的数据 $1 \\leq M \\leq N \\leq 8,0 \\leq A[i],B[i] \\leq 10^5$\n\n对于$60\\%$的数据 $1 \\leq M \\leq N \\leq 12,0 \\leq A[i],B[i] \\leq 10^7$\n\n对于$100\\%$的数据 $1 \\leq M,X[i],Y[i] \\leq N \\leq 18,0 \\leq K \\leq N^2−N,0 \\leq A[i],B[i] \\leq 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "War2", "background": "The `XM Battle` is arriving as scheduled. The `Agents` gather together for the final showdown. There are many ways to fight, and some complicated methods can earn higher scores. Unfortunately, the people from `ENLIGHTENED` are not very smart and only know simple `hack`, so the `ENLIGHTENED operation commander` asked you to be their chief strategist.", "description": "There are $N$ `Portals` on the map. Now an `Agent`'s task is to capture $M$ `Portals` on this map. The score gained by capturing the $i$-th `Portal` is $A[i]$. Besides capturing directly, there are also $K$ other bonus-scoring methods. For these $N$ `Portals`, after capturing the $X[i]$-th `Portal`, capturing the $Y[i]$-th `Portal` will grant an additional bonus of $B[i]$. Bonus rules may be duplicated. The `Agent` wants to earn more points for the team, so he asks you, the battle strategist, to help him.", "inputFormat": "The first line contains three integers $N, M, K$.\nThe second line contains $N$ numbers, where the $i$-th number represents $A[i]$.\nThe next $K$ lines each contain three integers $X[i], Y[i], C[i]$, indicating that after capturing the $X[i]$-th `Portal`, capturing the $Y[i]$-th `Portal` will grant an additional bonus of $B[i]$.", "outputFormat": "Output only one line with one integer, the maximum score this `Agent` can obtain.", "hint": "For $20\\%$ of the data: $1 \\leq M \\leq N \\leq 4, 0 \\leq A[i], B[i] \\leq 10^3$.\n\nFor $40\\%$ of the data: $1 \\leq M \\leq N \\leq 8, 0 \\leq A[i], B[i] \\leq 10^5$.\n\nFor $60\\%$ of the data: $1 \\leq M \\leq N \\leq 12, 0 \\leq A[i], B[i] \\leq 10^7$.\n\nFor $100\\%$ of the data: $1 \\leq M, X[i], Y[i] \\leq N \\leq 18, 0 \\leq K \\leq N^2-N, 0 \\leq A[i], B[i] \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "War2", "background": "`XM大战`如期而至，`Agent`们齐聚一地，展开最后的对决。对战有很多种方式，有些复杂的方式可以获得更高的分数。可惜`ENLIGHTENED`的人并不怎么聪明，只会简单的`hack`，所以`ENLIGHTENED行动指挥`找到了你来做他们的总参谋。", "description": "地图上有$N$个`Portal`，现在某一名`Agent`的任务是占领该地图上的$M$个`Portal`，这名`Agent`占领第$i$个`Portal`可以得到的分数为$A[i]$，除了直接占领，还有其他的$K$种加分方式，对于着$N$个`Portal`，在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分，加分可能会有重复。`Agent`希望他可以为团队争取更多的分数，所以请求作为大战参谋的你来帮助他。", "inputFormat": "第一行是输入三个整数$N,M,K$\n第二行输入是$N$个数，第$i$个数代表$A[i]$的值。\n下面$K$行每行有3个整数$X[i],Y[i],C[i]$，表示在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分", "outputFormat": "输出仅一行一个整数，为该名`Agent`可以获得的最大分数值。", "hint": "对于$20\\%$的数据 $1 \\leq M \\leq N \\leq 4,0 \\leq A[i],B[i] \\leq 10^3$\n\n对于$40\\%$的数据 $1 \\leq M \\leq N \\leq 8,0 \\leq A[i],B[i] \\leq 10^5$\n\n对于$60\\%$的数据 $1 \\leq M \\leq N \\leq 12,0 \\leq A[i],B[i] \\leq 10^7$\n\n对于$100\\%$的数据 $1 \\leq M,X[i],Y[i] \\leq N \\leq 18,0 \\leq K \\leq N^2−N,0 \\leq A[i],B[i] \\leq 10^9$", "locale": "zh-CN"}}}
{"pid": "P4942", "type": "P", "difficulty": 2, "samples": [["2\n2 5\n8 12", "5\n5"], ["3\n1 999\n123 456\n13579 24680", "0\n6\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "数学", "高精度", "逆元"], "title": "小凯的数字", "background": "NOIP2018 原创模拟题 T1\n\nNOIP DAY1 T1 or DAY2 T1 难度\n\n是否发现与 NOIP2017 DAY1 T1 有异曲同工之妙", "description": "小凯有一天突发奇想，写下了一串数字：$\\overline{l(l+1)(l+2)...(r-1)r}$。\n\n例如：$l=2,r=5$ 时，数字为：$2345$。\n\n$l=8,r=12$ 时数字为：$89101112$。\n\n小凯很喜欢数字 $9$，所以他想问你他写下的数字除以 $9$ 的余数是多少？\n\n例如：$l=2,r=5$ 时，$2345\\bmod9 = 5$。", "inputFormat": "第一行为数字 $Q$,表示小凯有 $Q$ 个问题。\n\n第 $2$ 到 $Q+1$ 行，每行两个数字 $l,r$ 表示数字范围。", "outputFormat": "对于每行的问题输出一行，一个数字，表示小凯问题的回答。", "hint": "样例 1 解释：$2345\\bmod9 = 5$，$89101112\\bmod9 = 5$。\n\n对于 $30\\%$ 数据满足：$Q\\leq10;l,r\\leq100$。\n\n对于 $50\\%$ 数据满足：$Q\\leq100;l,r\\leq10000$。\n\n对于 $70\\%$ 数据满足：$Q\\leq1000;l,r\\leq10^6$。\n\n对于 $100\\%$ 数据满足：$Q\\leq10000;0<l,r\\leq10^{12}$ 且 $l\\leq r$。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Kai’s Number", "background": "NOIP 2018 original mock contest problem T1.\n\nDifficulty: similar to NOIP Day 1 T1 or Day 2 T1.\n\nDid you notice that it is somewhat similar in spirit to NOIP 2017 Day 1 T1.", "description": "One day, Xiao Kai had a sudden idea and wrote down a sequence of numbers:\n$\\overline{l(l+1)(l+2)...(r-1)r}$.\n\nFor example, when $l=2, r=5$, the number is $2345$.\n\nWhen $l=8, r=12$, the number is $89101112$.\n\nXiao Kai really likes the digit $9$, so he wants to ask you: what is the remainder when the number he wrote is divided by $9$?\n\nFor example, when $l=2, r=5$, $2345 \\bmod 9 = 5$.", "inputFormat": "The first line contains an integer $Q$, meaning Xiao Kai has $Q$ queries.\n\nLines $2$ to $Q+1$ each contain two integers $l, r$, representing the range of numbers.", "outputFormat": "For each query, output one line with one integer, which is the answer to Xiao Kai’s query.", "hint": "Explanation of Sample 1: $2345 \\bmod 9 = 5$, and $89101112 \\bmod 9 = 5$.\n\nFor $30\\%$ of the testdata: $Q \\leq 10$, and $l, r \\leq 100$.\n\nFor $50\\%$ of the testdata: $Q \\leq 100$, and $l, r \\leq 10000$.\n\nFor $70\\%$ of the testdata: $Q \\leq 1000$, and $l, r \\leq 10^6$.\n\nFor $100\\%$ of the testdata: $Q \\leq 10000$, $0 < l, r \\leq 10^{12}$, and $l \\leq r$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小凯的数字", "background": "NOIP2018 原创模拟题 T1\n\nNOIP DAY1 T1 or DAY2 T1 难度\n\n是否发现与 NOIP2017 DAY1 T1 有异曲同工之妙", "description": "小凯有一天突发奇想，写下了一串数字：$\\overline{l(l+1)(l+2)...(r-1)r}$。\n\n例如：$l=2,r=5$ 时，数字为：$2345$。\n\n$l=8,r=12$ 时数字为：$89101112$。\n\n小凯很喜欢数字 $9$，所以他想问你他写下的数字除以 $9$ 的余数是多少？\n\n例如：$l=2,r=5$ 时，$2345\\bmod9 = 5$。", "inputFormat": "第一行为数字 $Q$,表示小凯有 $Q$ 个问题。\n\n第 $2$ 到 $Q+1$ 行，每行两个数字 $l,r$ 表示数字范围。", "outputFormat": "对于每行的问题输出一行，一个数字，表示小凯问题的回答。", "hint": "样例 1 解释：$2345\\bmod9 = 5$，$89101112\\bmod9 = 5$。\n\n对于 $30\\%$ 数据满足：$Q\\leq10;l,r\\leq100$。\n\n对于 $50\\%$ 数据满足：$Q\\leq100;l,r\\leq10000$。\n\n对于 $70\\%$ 数据满足：$Q\\leq1000;l,r\\leq10^6$。\n\n对于 $100\\%$ 数据满足：$Q\\leq10000;0<l,r\\leq10^{12}$ 且 $l\\leq r$。", "locale": "zh-CN"}}}
{"pid": "P4943", "type": "P", "difficulty": 4, "samples": [["6 8 1\n5\n1 2 3\n2 3 2\n1 3 4\n3 4 1\n4 6 5\n5 6 2\n1 6 6\n1 5 3\n4 6", "5"], ["10 13 3\n3 4 10\n1 2 1\n2 3 2\n3 4 3\n4 5 4\n5 6 5\n6 7 10\n7 8 5\n8 9 10\n9 10 3\n10 1 2\n1 9 6\n3 8 10\n4 6 3\n6 8", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "最短路"], "title": "密室", "background": "NOIP2018 原创模拟题 T2\n\nNOIP DAY1 T2 or DAY2 T2 难度\n\n题目背景改编自小说《哈利波特与密室》。", "description": "**密室被打开了。**\n\n哈利与罗恩进入了密室，他们发现密室由 $n$ 个小室组成，所有小室编号分别为：$1,2,...,n$。所有小室之间有 $m$ 条通道，对任意两个不同小室最多只有一条通道连接，而每通过一条通道都需要 $C_i$ 的时间。\n\n开始时哈利与罗恩都在编号为 $1$ 的小室里，他们的目标是拯救金妮和寻找日记，但是他们发现金妮和日记可能在两个不同的小室里，为了尽快发现真相，他们决定以最少的时间到达两个目标小室。但是某些小室只有会与蛇对话的人才能进入，也就是只有哈利一个人可以进入。\n\n现在，哈利告诉你密室的结构，请你计算他们到达两个目标小室的最短时间。", "inputFormat": "第一行 $n,m,k$ 表示有 $n$ 个小室 $m$ 条通道，$k$ 间小室只有哈利可以进入。\n\n第二行 $k$ 个数，表示只有哈利可以进入的小室的编号。（若 $k=0$，不包含该行）\n\n接下来 $m$ 行，每行 $3$ 个数：$a,b,c$ 表示 $a$ 小室与 $b$ 小室之间有一条需要花费 $c$ 时间的通道。\n\n最后一行，两个数 $x,y$ 表示哈利与罗恩需要去的小室的编号。", "outputFormat": "一行，输出一个数，表示到达两个密室的最短时间。", "hint": "**样例解释：**\n\n**样例一：**\n\n哈利：$1 \\to 5 \\to 6$ 花费时间为 $5$。\n\n罗恩：$1 \\to 3 \\to 4$ 花费时间为 $5$。\n\n所以最短时间为 $5$。\n\n**样例二：**\n\n![图1](https://cdn.luogu.com.cn/upload/pic/31438.png)\n\n如图，橙色表示目标小室，绿色只有哈利可以通过。\n\n哈利：$1 \\to 2 \\to 3 \\to 4 \\to 6$ 花费时间为 $9$。\n\n罗恩：$1 \\to 9 \\to 8$ 花费时间为 $16$。\n\n所以最短时间为 $16$。\n\n**数据范围：**\n\n$10\\%$ 数据满足：$n\\leq 5$。\n\n$30\\%$ 数据满足：$n\\leq 20$。\n\n$50\\%$ 数据满足：$n\\leq 1000$。\n\n$70\\%$ 数据满足：$n\\leq 10000$。\n\n$100\\%$ 数据满足：$n\\leq 50000$；$a,b,k\\leq n$；$c\\leq 1000$；$m\\leq 100000$，保证罗恩可以在密室 $1$。\n\n**特殊约定：**\n\n$30\\%$ 数据满足：$k=0$。", "locale": "zh-CN", "translations": {"en": {"title": "Chamber of Secrets", "background": "NOIP 2018 original mock problem T2.\n\nDifficulty similar to NOIP Day 1 T2 or Day 2 T2.\n\nThe background is adapted from the novel *Harry Potter and the Chamber of Secrets*.", "description": "**The Chamber of Secrets has been opened.**\n\nHarry and Ron enter the chamber. They find that the chamber consists of $n$ rooms, numbered $1,2,\\ldots,n$. There are $m$ passages between the rooms. For any two different rooms, there is at most one passage connecting them. Passing through the $i$-th passage takes $C_i$ time.\n\nAt the beginning, both Harry and Ron are in room $1$. Their goals are to rescue Ginny and find the diary, but Ginny and the diary may be in two different rooms. To uncover the truth as quickly as possible, they decide to reach the two target rooms in the least time. However, some rooms can only be entered by someone who can talk to snakes, meaning only Harry can enter them.\n\nNow, Harry tells you the structure of the chamber. Please compute the shortest time for them to reach the two target rooms.", "inputFormat": "The first line contains $n,m,k$, meaning there are $n$ rooms, $m$ passages, and $k$ rooms that only Harry can enter.\n\nThe second line contains $k$ numbers, giving the indices of the rooms that only Harry can enter. (If $k=0$, this line is omitted.)\n\nThe next $m$ lines each contain $3$ numbers $a,b,c$, meaning there is a passage between room $a$ and room $b$ with time cost $c$.\n\nThe last line contains two numbers $x,y$, indicating the two rooms that Harry and Ron need to go to.", "outputFormat": "Output one number in a single line, representing the minimum time to reach the two target rooms.", "hint": "**Explanation of the samples:**\n\n**Sample 1:**\n\nHarry: $1 \\to 5 \\to 6$, time cost is $5$.\n\nRon: $1 \\to 3 \\to 4$, time cost is $5$.\n\nSo the minimum time is $5$.\n\n**Sample 2:**\n\n![Figure 1](https://cdn.luogu.com.cn/upload/pic/31438.png)\n\nAs shown, orange marks the target rooms, and green marks rooms that only Harry can pass through.\n\nHarry: $1 \\to 2 \\to 3 \\to 4 \\to 6$, time cost is $9$.\n\nRon: $1 \\to 9 \\to 8$, time cost is $16$.\n\nSo the minimum time is $16$.\n\n**Constraints:**\n\nFor $10\\%$ of the testdata: $n\\leq 5$.\n\nFor $30\\%$ of the testdata: $n\\leq 20$.\n\nFor $50\\%$ of the testdata: $n\\leq 1000$.\n\nFor $70\\%$ of the testdata: $n\\leq 10000$.\n\nFor $100\\%$ of the testdata: $n\\leq 50000$; $a,b,k\\leq n$; $c\\leq 1000$; $m\\leq 100000$. It is guaranteed that Ron can be in room $1$.\n\n**Special note:**\n\nFor $30\\%$ of the testdata: $k=0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "密室", "background": "NOIP2018 原创模拟题 T2\n\nNOIP DAY1 T2 or DAY2 T2 难度\n\n题目背景改编自小说《哈利波特与密室》。", "description": "**密室被打开了。**\n\n哈利与罗恩进入了密室，他们发现密室由 $n$ 个小室组成，所有小室编号分别为：$1,2,...,n$。所有小室之间有 $m$ 条通道，对任意两个不同小室最多只有一条通道连接，而每通过一条通道都需要 $C_i$ 的时间。\n\n开始时哈利与罗恩都在编号为 $1$ 的小室里，他们的目标是拯救金妮和寻找日记，但是他们发现金妮和日记可能在两个不同的小室里，为了尽快发现真相，他们决定以最少的时间到达两个目标小室。但是某些小室只有会与蛇对话的人才能进入，也就是只有哈利一个人可以进入。\n\n现在，哈利告诉你密室的结构，请你计算他们到达两个目标小室的最短时间。", "inputFormat": "第一行 $n,m,k$ 表示有 $n$ 个小室 $m$ 条通道，$k$ 间小室只有哈利可以进入。\n\n第二行 $k$ 个数，表示只有哈利可以进入的小室的编号。（若 $k=0$，不包含该行）\n\n接下来 $m$ 行，每行 $3$ 个数：$a,b,c$ 表示 $a$ 小室与 $b$ 小室之间有一条需要花费 $c$ 时间的通道。\n\n最后一行，两个数 $x,y$ 表示哈利与罗恩需要去的小室的编号。", "outputFormat": "一行，输出一个数，表示到达两个密室的最短时间。", "hint": "**样例解释：**\n\n**样例一：**\n\n哈利：$1 \\to 5 \\to 6$ 花费时间为 $5$。\n\n罗恩：$1 \\to 3 \\to 4$ 花费时间为 $5$。\n\n所以最短时间为 $5$。\n\n**样例二：**\n\n![图1](https://cdn.luogu.com.cn/upload/pic/31438.png)\n\n如图，橙色表示目标小室，绿色只有哈利可以通过。\n\n哈利：$1 \\to 2 \\to 3 \\to 4 \\to 6$ 花费时间为 $9$。\n\n罗恩：$1 \\to 9 \\to 8$ 花费时间为 $16$。\n\n所以最短时间为 $16$。\n\n**数据范围：**\n\n$10\\%$ 数据满足：$n\\leq 5$。\n\n$30\\%$ 数据满足：$n\\leq 20$。\n\n$50\\%$ 数据满足：$n\\leq 1000$。\n\n$70\\%$ 数据满足：$n\\leq 10000$。\n\n$100\\%$ 数据满足：$n\\leq 50000$；$a,b,k\\leq n$；$c\\leq 1000$；$m\\leq 100000$，保证罗恩可以在密室 $1$。\n\n**特殊约定：**\n\n$30\\%$ 数据满足：$k=0$。", "locale": "zh-CN"}}}
{"pid": "P4944", "type": "P", "difficulty": 5, "samples": [["5 7 6\n.&...&.\n..##@..\n.&...&.\n..##@..\n.&...&.\nDWAAAA\nWDDDDD", "5 1\n0 2\n7"], ["9 9 4\n.........\n.#######.\n.......#.\n.@#.&@.#.\n&.#.&&.#.\n&&######.\n.&.......\n..@####..\n.........\nASSD\nASDD\nWASD", "22 1\n4 2\n0 3\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "搜索", "队列"], "title": "PION贪吃蛇", "background": "NOIP2018原创模拟题 T3\n\nNOIP DAY1 T3 or DAY 2 T2 难度\n\n贪吃蛇大家都玩过吧，当然不同版本有不同规则。下面介绍PION贪吃蛇。", "description": "![图A](https://cdn.luogu.com.cn/upload/pic/31298.png)\n\n***表示方法：***\n\n该题中贪吃蛇存在于一个n行m列的矩形中，用 ‘.’ 表示空地，用 '#’ 表示蛇身，用 ‘@’表示蛇头，用‘&’表示食物\n例如：图一表示 $5*6$ 的矩形，有一条蛇，蛇长度为 $7$，有两个食物\n\n***基本规则：***\n\n1.蛇头每一秒就会移动一格，身体自然会跟着移动，用W表示向上，S表示向下，A表示向左，D表示向右\n\n2.蛇每吃一个食物就长度就会加一，而增加的长度体现在食物所在的地方，你可以把吃食物理解成食物变成了蛇头，之前的蛇头变成了蛇身，这一秒不移动\n\n例如：图二的三幅图展示了第一秒，第二秒，和第三秒的情况\n\n3.蛇如果死亡，身体（包括头）一定会全部变成食物\n\n4.PION贪吃蛇的蛇头碰到自己或别的蛇的身体就会死亡\n\n例如：图三的三幅图展示了第二条蛇撞在别人身体上死亡的过程\n\n5.蛇头撞在边界上也会引起死亡，但蛇头刚好现在边界上不会\n\n例如：图四第二幅图虽然蛇头在边界上，但是只是刚好，如果此时进行D操作蛇就会死亡，如果进行W或S就不会\n\n6.如果有操作使蛇头向相反方向运动，之后如果与身体重合蛇也会死亡（比如：图二第一幅图使用A操作,蛇就会死亡，此时在原地成为三个食物，你也可以理解为蛇下一秒不行动而自杀了）\n\n7.两条蛇蛇头相撞，主动撞上的死亡\n\n8.蛇的移动按编号由小到大进行（编号的含义见下文）\n", "inputFormat": "第一行三个数 $n,m,k$ 表示 $n*m$ 的矩形，$k$ 表示操作次数\n\n接下来 $n$ 行每行 $m$ 个字符，表示地图\n\n再接下来 $c$ 行（注意：图中有几条蛇就有几行），每行 $k$ 个字符，表示有 $k$ 个操作（如果执行了某个操作蛇死了，就忽略后面的操作）\n\n我们将蛇编号：按每条蛇蛇头的坐标从小到大编号为 $1，2，...，c$（越靠近上边的坐标越小，如果相同越靠近左边的坐标越小）\n\n例如：图三第一幅图两条蛇的蛇头坐标分别为（$4,3）,（3,7）$所以较长的蛇编号为 $2$，较短的蛇编号为 $1$", "outputFormat": "$c+1$ 行，输出 $k$ 次操作后每一条蛇的长度，编号；每一行第一个为长度，第二个数为编号\n\n最后一行输出剩下食物的总个数\n\n注意：输出按长度由大到小排序（长度相同按编号由小到大排序），死亡的蛇长度为 $0$", "hint": "***样例说明：***\n\n![图B](https://cdn.luogu.com.cn/upload/pic/31357.png)\n\n图五，图六展示了从第 $0$ 秒开始之后每一秒地图的状态，请看图理解（样例二图四有点小错误）\n\n***数据范围：***\n\n$10\\%$ 数据满足 $n,m\\leq 5,c=1,k\\leq3$\n\n$30\\%$ 数据满足 $n,m\\leq 10,c\\leq 2,k\\leq 5$\n\n$50\\%$ 数据满足 $n,m\\leq 50,c\\leq 5,k\\leq 20$\n\n$70\\%$ 数据满足 $n,m\\leq 100,c\\leq 7,k\\leq 50$\n\n$100\\%$ 数据满足 $n,m\\leq 200,c\\leq 20,k\\leq 100$，且图中的蛇不会引起混淆（对于任意蛇头，最多只有一块蛇身于其相连，而蛇身最多为二连块）,且数据保证图中的蛇均可以判断身体与头的对应关系，不会造成蛇身形态多解", "locale": "zh-CN", "translations": {"en": {"title": "PION Snake", "background": "NOIP 2018 original mock problem T3.\n\nDifficulty similar to NOIP Day 1 T3 or Day 2 T2.\n\nEveryone has played Snake, right? Of course, different versions have different rules. Below is an introduction to PION Snake.", "description": "![Figure A](https://cdn.luogu.com.cn/upload/pic/31298.png)\n\n***Notation:***\n\nIn this problem, the snakes live in a rectangle with $n$ rows and $m$ columns. `.` represents empty ground, `#` represents the snake body, `@` represents the snake head, and `&` represents food.  \nFor example, Figure 1 shows a $5*6$ rectangle with one snake. The snake has length $7$, and there are two pieces of food.\n\n***Basic rules:***\n\n1. Each second, a snake head moves by one cell, and the body follows naturally. Use `W` for up, `S` for down, `A` for left, and `D` for right.\n\n2. Each time a snake eats one piece of food, its length increases by $1$. The increased length appears at the cell where the food was. You can understand “eating food” as: the food becomes the new head, the previous head becomes part of the body, and the snake does not move during this second.  \nFor example, the three sub-figures in Figure 2 show the situations at the first second, the second second, and the third second.\n\n3. If a snake dies, its entire body (including the head) will all turn into food.\n\n4. If a snake head touches its own body or another snake’s body, it dies.  \nFor example, the three sub-figures in Figure 3 show the process where the second snake crashes into another snake’s body and dies.\n\n5. If a snake head hits the boundary, it also dies, but merely being exactly on the boundary does not.  \nFor example, in the second sub-figure of Figure 4, although the head is on the boundary, it is only exactly on it. If you perform `D` at this time, the snake will die; if you perform `W` or `S`, it will not.\n\n6. If an operation makes the snake head move in the opposite direction, then later, if it overlaps with its body, the snake will also die (for example: if in the first sub-figure of Figure 2 you use operation `A`, the snake will die and become three pieces of food on the spot. You may also think of it as the snake not moving next second and committing suicide).\n\n7. If two snakes’ heads collide, the one that actively撞上 (runs into the other) dies.\n\n8. Snakes move in increasing order of their indices (the meaning of indices is explained below).", "inputFormat": "The first line contains three integers $n,m,k$, where $n*m$ is the rectangle, and $k$ is the number of operations.\n\nNext $n$ lines each contain $m$ characters, describing the map.\n\nThen follow $c$ lines (note: there are as many lines as there are snakes in the map). Each line contains $k$ characters, representing $k$ operations (if a snake dies after performing some operation, ignore the remaining operations).\n\nWe index the snakes as follows: sort all snakes by the coordinates of their heads from small to large, and assign indices $1,2,\\ldots,c$ (a smaller row coordinate means smaller; if rows are equal, a smaller column coordinate means smaller).\n\nFor example, in the first sub-figure of Figure 3, the head coordinates of the two snakes are $(4,3)$ and $(3,7)$, so the longer snake is indexed as $2$, and the shorter snake is indexed as $1$.", "outputFormat": "Output $c+1$ lines. After $k$ operations, output the length and the index of each snake. In each line, the first number is the length, and the second number is the index.\n\nIn the last line, output the total number of remaining pieces of food.\n\nNote: output should be sorted by length from large to small (if lengths are equal, sort by index from small to large). The length of a dead snake is $0$.", "hint": "***Sample explanation:***\n\n![Figure B](https://cdn.luogu.com.cn/upload/pic/31357.png)\n\nFigures 5 and 6 show the map state at each second starting from second $0$. Please read the figures to understand (there is a small mistake in Figure 4 of Sample 2).\n\n***Constraints:***\n\n$10\\%$ of the testdata satisfies $n,m\\leq 5,c=1,k\\leq3$.\n\n$30\\%$ of the testdata satisfies $n,m\\leq 10,c\\leq 2,k\\leq 5$.\n\n$50\\%$ of the testdata satisfies $n,m\\leq 50,c\\leq 5,k\\leq 20$.\n\n$70\\%$ of the testdata satisfies $n,m\\leq 100,c\\leq 7,k\\leq 50$.\n\n$100\\%$ of the testdata satisfies $n,m\\leq 200,c\\leq 20,k\\leq 100$, and the snakes in the figure will not cause ambiguity (for any snake head, at most one body block is connected to it, and each body block has at most two adjacent body blocks). The testdata also guarantees that the correspondence between each snake’s body and head can be determined, and the snake body shape will not have multiple valid interpretations.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "PION贪吃蛇", "background": "NOIP2018原创模拟题 T3\n\nNOIP DAY1 T3 or DAY 2 T2 难度\n\n贪吃蛇大家都玩过吧，当然不同版本有不同规则。下面介绍PION贪吃蛇。", "description": "![图A](https://cdn.luogu.com.cn/upload/pic/31298.png)\n\n***表示方法：***\n\n该题中贪吃蛇存在于一个n行m列的矩形中，用 ‘.’ 表示空地，用 '#’ 表示蛇身，用 ‘@’表示蛇头，用‘&’表示食物\n例如：图一表示 $5*6$ 的矩形，有一条蛇，蛇长度为 $7$，有两个食物\n\n***基本规则：***\n\n1.蛇头每一秒就会移动一格，身体自然会跟着移动，用W表示向上，S表示向下，A表示向左，D表示向右\n\n2.蛇每吃一个食物就长度就会加一，而增加的长度体现在食物所在的地方，你可以把吃食物理解成食物变成了蛇头，之前的蛇头变成了蛇身，这一秒不移动\n\n例如：图二的三幅图展示了第一秒，第二秒，和第三秒的情况\n\n3.蛇如果死亡，身体（包括头）一定会全部变成食物\n\n4.PION贪吃蛇的蛇头碰到自己或别的蛇的身体就会死亡\n\n例如：图三的三幅图展示了第二条蛇撞在别人身体上死亡的过程\n\n5.蛇头撞在边界上也会引起死亡，但蛇头刚好现在边界上不会\n\n例如：图四第二幅图虽然蛇头在边界上，但是只是刚好，如果此时进行D操作蛇就会死亡，如果进行W或S就不会\n\n6.如果有操作使蛇头向相反方向运动，之后如果与身体重合蛇也会死亡（比如：图二第一幅图使用A操作,蛇就会死亡，此时在原地成为三个食物，你也可以理解为蛇下一秒不行动而自杀了）\n\n7.两条蛇蛇头相撞，主动撞上的死亡\n\n8.蛇的移动按编号由小到大进行（编号的含义见下文）\n", "inputFormat": "第一行三个数 $n,m,k$ 表示 $n*m$ 的矩形，$k$ 表示操作次数\n\n接下来 $n$ 行每行 $m$ 个字符，表示地图\n\n再接下来 $c$ 行（注意：图中有几条蛇就有几行），每行 $k$ 个字符，表示有 $k$ 个操作（如果执行了某个操作蛇死了，就忽略后面的操作）\n\n我们将蛇编号：按每条蛇蛇头的坐标从小到大编号为 $1，2，...，c$（越靠近上边的坐标越小，如果相同越靠近左边的坐标越小）\n\n例如：图三第一幅图两条蛇的蛇头坐标分别为（$4,3）,（3,7）$所以较长的蛇编号为 $2$，较短的蛇编号为 $1$", "outputFormat": "$c+1$ 行，输出 $k$ 次操作后每一条蛇的长度，编号；每一行第一个为长度，第二个数为编号\n\n最后一行输出剩下食物的总个数\n\n注意：输出按长度由大到小排序（长度相同按编号由小到大排序），死亡的蛇长度为 $0$", "hint": "***样例说明：***\n\n![图B](https://cdn.luogu.com.cn/upload/pic/31357.png)\n\n图五，图六展示了从第 $0$ 秒开始之后每一秒地图的状态，请看图理解（样例二图四有点小错误）\n\n***数据范围：***\n\n$10\\%$ 数据满足 $n,m\\leq 5,c=1,k\\leq3$\n\n$30\\%$ 数据满足 $n,m\\leq 10,c\\leq 2,k\\leq 5$\n\n$50\\%$ 数据满足 $n,m\\leq 50,c\\leq 5,k\\leq 20$\n\n$70\\%$ 数据满足 $n,m\\leq 100,c\\leq 7,k\\leq 50$\n\n$100\\%$ 数据满足 $n,m\\leq 200,c\\leq 20,k\\leq 100$，且图中的蛇不会引起混淆（对于任意蛇头，最多只有一块蛇身于其相连，而蛇身最多为二连块）,且数据保证图中的蛇均可以判断身体与头的对应关系，不会造成蛇身形态多解", "locale": "zh-CN"}}}
{"pid": "P4945", "type": "P", "difficulty": 5, "samples": [["4 1\n1 2\n2 3\n1 2\n3 8\n3 2 1 3", "21"], ["8 3\n1 2\n2 5\n3 2\n2 3\n1 4\n1 6\n2 2\n3 3\n1 3 2 1 4 5 2 1", "57"], ["10 3\n9 9\n8 8\n5 7\n6 6\n5 5\n5 5\n3 3\n2 2\n1 1\n9 9\n1 2 3 5 5 5 6 7 8 9", "124"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "贪心", "离散化", "排序"], "title": "最后的战役", "background": "NOIP2018原创模拟题T5\n\nNOIP2018原创模拟赛DAY2 T1\n\nNOIP T1+ or T2-  难度\n\n题目背景改编自小说《哈利波特与死亡圣器》", "description": "**最后的战役打响了。**\n\n哈利被宣告“死亡”，伏地魔带着他的部下准备进攻霍格沃茨。但是霍格沃茨有古老的魔法保护，他们必须先摧毁这些保护。魔法保护一共有$n$层，每一层保护有两个参数：$k,p$。其中k表示魔法的类型，p表示能量的大小。\n\n伏地魔每秒都会穿过一层保护，他在第 $i$ 秒（到达了第 $i$ 层）他有以下选择：  \n\n\n1.收集 $[1,i]$ 层魔法中魔法类型为 $x_i$ 的魔法能量\n\n2.收集 $[1,i]$ 层中魔法能量最大那层的魔法能量\n\n3.使用加倍魔法\n\n对于上面三个选择，他每秒可以可以选择一个，并可能获得能量，对于不同的选择，获得的能量也不同：\n\n对于1.获得$[1,i]$层中**所有魔法类型为$x_i$的**魔法能量（请结合样例1理解）\n\n对于2.获得$[1,i]$中魔法能量最大的那一层的魔法能量\n\n对于3.这一秒总共收集的能量不变（也就是这一秒不收集新的能量），但是下一秒获得的能量翻倍。**但是他不能连续使用加倍魔法**，而且他最多只能使用$m$次，**对于每一层的能量他都可以重复获取**\n\n只有他通过了这$n$层保护，并获得了最大的魔法能量才有可能彻底摧毁霍格沃茨的魔法防御，可是巫师又是不擅长计算的。\n\n于是，伏地魔找到了你，而你，作为精通计算机技术的麻瓜程序员，现在需要做的就是设计一个程序帮助伏地魔计算出他可以获得的最大的魔法能量的值。\n\n最终的决战已经展开，魔法界的历史又翻过了一页……", "inputFormat": "第一行：两个数：$n,m$，意义见题目描述\n\n接下来$n$行，第$i+1$行表示$k_i,p_i$，意义见题目描述\n\n最后一行，共$n$个数，第$i$个数表示$x_i$，意义见题目描述", "outputFormat": "一个数，表示伏地魔可以获得的最大能量值", "hint": "**样例一解释：**\n\n第一秒最多可以获得2经验值，第二秒最多可以获得3经验值，**因为第三秒可以收集魔法类型为1的能量，所以最多可以获得4能量值**，第四秒最多可以获得8经验值，所以选择在第三秒使用加倍魔法，共可以获得：$2+3+0+2*8=21$能量值\n\n**数据范围：**\n\n30%数据满足：$n<=100,m<=10$\n\n50%数据满足：$n<=5,000,m<=20$\n\n70%数据满足：$n,m<=2\\times 10^4,m<=200$\n\n100%数据满足：$n<=5\\times 10^4,m<=500,0<p_i<=10^4,0<k_i<=10^9,0<x_i<=10^9$\n\n**特殊约定：**\n\n30%数据满足$m=0$", "locale": "zh-CN", "translations": {"en": {"title": "The Final Battle", "background": "NOIP 2018 original mock problem T5.\n\nNOIP 2018 original mock contest DAY 2 T1.\n\nNOIP T1+ or T2- difficulty.\n\nThe background is adapted from the novel *Harry Potter and the Deathly Hallows*.", "description": "**The final battle has begun.**\n\nHarry is declared “dead”, and Voldemort, together with his followers, is ready to attack Hogwarts. However, Hogwarts is protected by ancient magic, and they must destroy these protections first. There are a total of $n$ layers of magical protection. Each layer has two parameters: $k, p$. Here, $k$ represents the type of magic, and $p$ represents the amount of energy.\n\nVoldemort passes through one layer of protection per second. In the $i$-th second (when he reaches the $i$-th layer), he has the following choices:\n\n1. Collect the magic energy of type $x_i$ among layers $[1,i]$.\n2. Collect the magic energy of the layer with the maximum energy among layers $[1,i]$.\n3. Use the doubling spell.\n\nAmong the three choices above, he can choose one each second, and may gain energy. Different choices yield different energy:\n\n- For choice 1, he gains the magic energy of **all layers in $[1,i]$ whose magic type is $x_i$** (please refer to Sample 1 for understanding).\n- For choice 2, he gains the magic energy of the layer with the maximum energy in $[1,i]$.\n- For choice 3, the total energy collected in this second does not change (that is, he does not collect new energy in this second), but the energy gained in the next second is doubled. **However, he cannot use the doubling spell consecutively**, and he can use it at most $m$ times. **For the energy of each layer, he may collect it repeatedly.**\n\nOnly if he passes through all $n$ layers of protection and obtains the maximum possible magic energy can he completely destroy Hogwarts’ magical defenses, but wizards are not good at calculations.\n\nSo, Voldemort comes to you. As a Muggle programmer skilled in computer technology, you now need to design a program to help Voldemort compute the maximum magic energy he can obtain.\n\nThe final showdown has begun, and the history of the wizarding world has turned another page.", "inputFormat": "The first line contains two numbers: $n, m$, as described above.\n\nThe next $n$ lines: the $(i+1)$-th line contains $k_i, p_i$, as described above.\n\nThe last line contains $n$ numbers. The $i$-th number is $x_i$, as described above.", "outputFormat": "Output one number, representing the maximum energy value Voldemort can obtain.", "hint": "**Explanation of Sample 1:**\n\nIn the first second, he can obtain at most $2$ experience points. In the second second, he can obtain at most $3$ experience points. **Because in the third second he can collect energy of magic type $1$, he can obtain at most $4$ energy**. In the fourth second, he can obtain at most $8$ experience points. Therefore, choose to use the doubling spell in the third second, and the total energy obtained is $2+3+0+2*8=21$.\n\n**Constraints:**\n\nFor $30\\%$ of the testdata: $n<=100, m<=10$.\n\nFor $50\\%$ of the testdata: $n<=5,000, m<=20$.\n\nFor $70\\%$ of the testdata: $n, m<=2\\times 10^4, m<=200$.\n\nFor $100\\%$ of the testdata: $n<=5\\times 10^4, m<=500, 0<p_i<=10^4, 0<k_i<=10^9, 0<x_i<=10^9$.\n\n**Special Note:**\n\nFor $30\\%$ of the testdata: $m=0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最后的战役", "background": "NOIP2018原创模拟题T5\n\nNOIP2018原创模拟赛DAY2 T1\n\nNOIP T1+ or T2-  难度\n\n题目背景改编自小说《哈利波特与死亡圣器》", "description": "**最后的战役打响了。**\n\n哈利被宣告“死亡”，伏地魔带着他的部下准备进攻霍格沃茨。但是霍格沃茨有古老的魔法保护，他们必须先摧毁这些保护。魔法保护一共有$n$层，每一层保护有两个参数：$k,p$。其中k表示魔法的类型，p表示能量的大小。\n\n伏地魔每秒都会穿过一层保护，他在第 $i$ 秒（到达了第 $i$ 层）他有以下选择：  \n\n\n1.收集 $[1,i]$ 层魔法中魔法类型为 $x_i$ 的魔法能量\n\n2.收集 $[1,i]$ 层中魔法能量最大那层的魔法能量\n\n3.使用加倍魔法\n\n对于上面三个选择，他每秒可以可以选择一个，并可能获得能量，对于不同的选择，获得的能量也不同：\n\n对于1.获得$[1,i]$层中**所有魔法类型为$x_i$的**魔法能量（请结合样例1理解）\n\n对于2.获得$[1,i]$中魔法能量最大的那一层的魔法能量\n\n对于3.这一秒总共收集的能量不变（也就是这一秒不收集新的能量），但是下一秒获得的能量翻倍。**但是他不能连续使用加倍魔法**，而且他最多只能使用$m$次，**对于每一层的能量他都可以重复获取**\n\n只有他通过了这$n$层保护，并获得了最大的魔法能量才有可能彻底摧毁霍格沃茨的魔法防御，可是巫师又是不擅长计算的。\n\n于是，伏地魔找到了你，而你，作为精通计算机技术的麻瓜程序员，现在需要做的就是设计一个程序帮助伏地魔计算出他可以获得的最大的魔法能量的值。\n\n最终的决战已经展开，魔法界的历史又翻过了一页……", "inputFormat": "第一行：两个数：$n,m$，意义见题目描述\n\n接下来$n$行，第$i+1$行表示$k_i,p_i$，意义见题目描述\n\n最后一行，共$n$个数，第$i$个数表示$x_i$，意义见题目描述", "outputFormat": "一个数，表示伏地魔可以获得的最大能量值", "hint": "**样例一解释：**\n\n第一秒最多可以获得2经验值，第二秒最多可以获得3经验值，**因为第三秒可以收集魔法类型为1的能量，所以最多可以获得4能量值**，第四秒最多可以获得8经验值，所以选择在第三秒使用加倍魔法，共可以获得：$2+3+0+2*8=21$能量值\n\n**数据范围：**\n\n30%数据满足：$n<=100,m<=10$\n\n50%数据满足：$n<=5,000,m<=20$\n\n70%数据满足：$n,m<=2\\times 10^4,m<=200$\n\n100%数据满足：$n<=5\\times 10^4,m<=500,0<p_i<=10^4,0<k_i<=10^9,0<x_i<=10^9$\n\n**特殊约定：**\n\n30%数据满足$m=0$", "locale": "zh-CN"}}}
{"pid": "P4946", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2 P 6\n2 3 R 2\n3 4 R 1\n2 4 R 1\n1 3 R 1", "3.00\n1.50"], ["4 6\n1 3 P 6\n1 3 R 1\n1 2 R 1\n2 3 R 1\n1 4 R 1\n4 3 R 2", "11.00\n2.00"], ["16 21\n1 2 R 2\n2 3 R 1\n3 4 R 1\n2 5 R 1\n4 5 R 1\n4 6 R 1\n6 7 R 1\n7 8 R 2\n4 9 R 1\n8 9 R 1\n1 16 P 128\n10 8 R 7\n10 11 R 2\n11 10 R 1\n11 12 R 2\n12 15 R 1\n15 13 R 2\n11 13 R 1\n11 14 R 1\n14 15 R 2\n15 16 R 5", "7.11\n2.37"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["搜索", "数学", "图论"], "title": "流量计算", "background": "NOIP2018原创模拟题T7\n\nNOIP2018原创模拟赛DAY2 T2\n\nNOIP DAY1 T2 or DAY2 T2 难度\n\n相关电学知识请参考“说明”中的“背景知识”。", "description": "你看了复杂的电路图，发现在初高中学的电路元件数都目比较少，因此你希望设计一个程序来分析元件数目更多的电路图，并进行一些计算。\n\n经过苦苦思考，你终于找到了描述电路图的方法：\n\n1.电路图可以用$n$个节点，$m$条无向边的连通图来表示，其中$n$表示导线交汇点，$m$表示元件个数，且电路元件只有电源和电阻\n\n2.图中没有自环，但可能有重边\n\n3.电路图**最复杂的情况是并联中嵌套串联**，**不会出现更复杂的电路**，例如下面的情况都不会出现：\n\n![P1](https://cdn.luogu.com.cn/upload/pic/37113.png)\n\n比如样例一便是一个满足条件的电路图（图片见样例一解释）\n\n因为这是你第一次尝试，所以你决定电路中只包含电源与电阻，而且你决定计算电路中的最大电流与最小电流。\n\n在理清思路后你就决定开始尝试了。", "inputFormat": "共$m+1$行\n\n第一行两个数 $n,m$，表示电路图抽象为$n$个节点，$m$条边的无向图\n\n接下来$m$行，对于每一行：\n\n前两个数为$x,y$，表示$x,y$之间有一个元件\n\n接下来一个字符，如果为 $'P'$ 表示电源，且$x$方向为电源负极，$y$方向为电源正极，如果为 $'R'$ 表示电阻（均不含引号）\n\n再接下来一个数字，如果为电源，表示电压（单位：伏特），否则表示电阻（单位：欧姆）", "outputFormat": "两行\n\n第一行输出最大电流值，保留两位小数\n\n第二行输出最小电流值，保留两位小数", "hint": "**背景知识：**\n\n欧姆定理：$I=\\frac{U}{R}$，其中$I$为电流，$U$为电压，$R$为电阻\n\n串联：串联电路中电流相等，总电阻相当于电阻阻值之和\n\n并联：并联电路中电压相等\n\n串并联：即串联与并联结合\n\n![P3](https://cdn.luogu.com.cn/upload/pic/37135.png)\n\n**样例一解释：**\n\n![P4](https://cdn.luogu.com.cn/upload/pic/37121.png)\n\n如图，所有电阻等效电阻为$2Ω$，故最大电流为$\\frac{6V}{2Ω}=3A$，在支线$2-3$或$2-4-3$中电流为$1.5A$，为最小电流\n\n**样例二/三提示：**\n\n样例二中所有电阻的等效电阻阻值为$\\frac{6}{11}Ω$，且最小电流在支线$1-4-3$上，样例三中所有电阻的等效电阻阻值为$18Ω$\n\n**数据范围：**\n\n对于 30%数据，有：$n,m<=20$\n\n对于 50%数据，有：$n<=10^3,m<=4\\times 10^3$\n\n对于 70%数据，有：$n<=5000,m<=2\\times10^4$\n\n对于100%数据，有：\n\n1.$n<=2\\times10^4,m<=5\\times 10^4$，$0<=$电压$<=10^8$，$1<=$电阻$<=10^3$\n\n2.只有有一个电源，电路不会有不规范的地方\n\n3.最复杂的情况为并联中嵌套串联（如图A，当然支路可能更多，电阻串联数量有可能更多，但**支路不会出现并联**），保证**不会出现并联中再嵌套并联**（如图B的情况就不会出现）\n\n![P5](https://cdn.luogu.com.cn/upload/pic/37253.png)\n\n**特殊约定：**\n\n20%数据保证：电路为纯串联电路\n\n另外20%数据保证：电路为纯并联电路", "locale": "zh-CN", "translations": {"en": {"title": "Current Calculation", "background": "NOIP 2018 original mock problem T7.\n\nNOIP 2018 original mock contest DAY 2 T2.\n\nDifficulty: NOIP DAY 1 T2 or DAY 2 T2.\n\nFor related electrical knowledge, please refer to “Background Knowledge” in the “Hint” section.", "description": "After looking at a complex circuit diagram, you find that the number of circuit components studied in junior and senior high school is relatively small. Therefore, you want to design a program to analyze circuit diagrams with more components and perform some calculations.\n\nAfter long thinking, you finally found a way to describe a circuit diagram:\n\n1. A circuit diagram can be represented by a connected graph with $n$ nodes and $m$ undirected edges, where $n$ represents wire junctions, $m$ represents the number of components, and the circuit components are only power sources and resistors.\n\n2. The graph has no self-loops, but it may have multiple edges.\n\n3. The most complex case of the circuit is **series connections nested inside parallel connections**, and **no more complex circuits** will appear. For example, the following cases will not appear:\n\n![P1](https://cdn.luogu.com.cn/upload/pic/37113.png)\n\nFor example, Sample 1 is a circuit diagram that satisfies the conditions (see the picture in the explanation of Sample 1).\n\nSince this is your first attempt, you decide that the circuit contains only power sources and resistors, and you decide to compute the maximum current and the minimum current in the circuit.\n\nAfter sorting out your ideas, you decide to start trying.", "inputFormat": "There are $m+1$ lines in total.\n\nThe first line contains two numbers $n,m$, meaning the circuit diagram is abstracted as an undirected graph with $n$ nodes and $m$ edges.\n\nIn the next $m$ lines, for each line:\n\nThe first two numbers are $x,y$, meaning there is a component between $x$ and $y$.\n\nThen there is a character: if it is $'P'$ it means a power source, and the direction from $x$ to $y$ is from the negative terminal to the positive terminal; if it is $'R'$ it means a resistor (without quotes).\n\nThen there is a number: if it is a power source, it indicates the voltage (unit: volt); otherwise it indicates the resistance (unit: ohm).", "outputFormat": "Two lines.\n\nThe first line outputs the maximum current value, keeping two decimal places.\n\nThe second line outputs the minimum current value, keeping two decimal places.", "hint": "**Background Knowledge:**\n\nOhm’s law: $I=\\frac{U}{R}$, where $I$ is current, $U$ is voltage, and $R$ is resistance.\n\nSeries connection: in a series circuit, currents are equal, and the total resistance equals the sum of the resistances.\n\nParallel connection: in a parallel circuit, voltages are equal.\n\nSeries-parallel: a combination of series and parallel.\n\n![P3](https://cdn.luogu.com.cn/upload/pic/37135.png)\n\n**Explanation of Sample 1:**\n\n![P4](https://cdn.luogu.com.cn/upload/pic/37121.png)\n\nAs shown, the equivalent resistance of all resistors is $2Ω$, so the maximum current is $\\frac{6V}{2Ω}=3A$. In branch $2-3$ or $2-4-3$, the current is $1.5A$, which is the minimum current.\n\n**Hints for Sample 2/3:**\n\nIn Sample 2, the equivalent resistance of all resistors is $\\frac{6}{11}Ω$, and the minimum current is on branch $1-4-3$. In Sample 3, the equivalent resistance of all resistors is $18Ω$.\n\n**Constraints:**\n\nFor $30\\%$ of the testdata: $n,m<=20$.\n\nFor $50\\%$ of the testdata: $n<=10^3,m<=4\\times 10^3$.\n\nFor $70\\%$ of the testdata: $n<=5000,m<=2\\times10^4$.\n\nFor $100\\%$ of the testdata:\n\n1. $n<=2\\times10^4,m<=5\\times 10^4$, $0<=$ voltage $<=10^8$, $1<=$ resistance $<=10^3$.\n\n2. There is only one power source, and the circuit will not have any irregular parts.\n\n3. The most complex case is series connections nested inside parallel connections (like Figure A. Of course, there may be more branches, and the number of resistors in series may be larger, but **a branch will not contain parallel connections**). It is guaranteed that **there will not be parallel connections nested inside parallel connections** (cases like Figure B will not appear).\n\n![P5](https://cdn.luogu.com.cn/upload/pic/37253.png)\n\n**Special Notes:**\n\nFor $20\\%$ of the testdata, it is guaranteed that the circuit is a purely series circuit.\n\nFor another $20\\%$ of the testdata, it is guaranteed that the circuit is a purely parallel circuit.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "流量计算", "background": "NOIP2018原创模拟题T7\n\nNOIP2018原创模拟赛DAY2 T2\n\nNOIP DAY1 T2 or DAY2 T2 难度\n\n相关电学知识请参考“说明”中的“背景知识”。", "description": "你看了复杂的电路图，发现在初高中学的电路元件数都目比较少，因此你希望设计一个程序来分析元件数目更多的电路图，并进行一些计算。\n\n经过苦苦思考，你终于找到了描述电路图的方法：\n\n1.电路图可以用$n$个节点，$m$条无向边的连通图来表示，其中$n$表示导线交汇点，$m$表示元件个数，且电路元件只有电源和电阻\n\n2.图中没有自环，但可能有重边\n\n3.电路图**最复杂的情况是并联中嵌套串联**，**不会出现更复杂的电路**，例如下面的情况都不会出现：\n\n![P1](https://cdn.luogu.com.cn/upload/pic/37113.png)\n\n比如样例一便是一个满足条件的电路图（图片见样例一解释）\n\n因为这是你第一次尝试，所以你决定电路中只包含电源与电阻，而且你决定计算电路中的最大电流与最小电流。\n\n在理清思路后你就决定开始尝试了。", "inputFormat": "共$m+1$行\n\n第一行两个数 $n,m$，表示电路图抽象为$n$个节点，$m$条边的无向图\n\n接下来$m$行，对于每一行：\n\n前两个数为$x,y$，表示$x,y$之间有一个元件\n\n接下来一个字符，如果为 $'P'$ 表示电源，且$x$方向为电源负极，$y$方向为电源正极，如果为 $'R'$ 表示电阻（均不含引号）\n\n再接下来一个数字，如果为电源，表示电压（单位：伏特），否则表示电阻（单位：欧姆）", "outputFormat": "两行\n\n第一行输出最大电流值，保留两位小数\n\n第二行输出最小电流值，保留两位小数", "hint": "**背景知识：**\n\n欧姆定理：$I=\\frac{U}{R}$，其中$I$为电流，$U$为电压，$R$为电阻\n\n串联：串联电路中电流相等，总电阻相当于电阻阻值之和\n\n并联：并联电路中电压相等\n\n串并联：即串联与并联结合\n\n![P3](https://cdn.luogu.com.cn/upload/pic/37135.png)\n\n**样例一解释：**\n\n![P4](https://cdn.luogu.com.cn/upload/pic/37121.png)\n\n如图，所有电阻等效电阻为$2Ω$，故最大电流为$\\frac{6V}{2Ω}=3A$，在支线$2-3$或$2-4-3$中电流为$1.5A$，为最小电流\n\n**样例二/三提示：**\n\n样例二中所有电阻的等效电阻阻值为$\\frac{6}{11}Ω$，且最小电流在支线$1-4-3$上，样例三中所有电阻的等效电阻阻值为$18Ω$\n\n**数据范围：**\n\n对于 30%数据，有：$n,m<=20$\n\n对于 50%数据，有：$n<=10^3,m<=4\\times 10^3$\n\n对于 70%数据，有：$n<=5000,m<=2\\times10^4$\n\n对于100%数据，有：\n\n1.$n<=2\\times10^4,m<=5\\times 10^4$，$0<=$电压$<=10^8$，$1<=$电阻$<=10^3$\n\n2.只有有一个电源，电路不会有不规范的地方\n\n3.最复杂的情况为并联中嵌套串联（如图A，当然支路可能更多，电阻串联数量有可能更多，但**支路不会出现并联**），保证**不会出现并联中再嵌套并联**（如图B的情况就不会出现）\n\n![P5](https://cdn.luogu.com.cn/upload/pic/37253.png)\n\n**特殊约定：**\n\n20%数据保证：电路为纯串联电路\n\n另外20%数据保证：电路为纯并联电路", "locale": "zh-CN"}}}
{"pid": "P4947", "type": "P", "difficulty": 6, "samples": [["5 5\n1 2\n2 4\n2 5\n1 3\n2 cpp c\n3 pas txt txt\n2 vbs bat\n3 vbs cpp pas\n4 cpp c pas txt\nquery /e 1 5 *.txt\nquery /p 1 4\ndel /e 2 2 *.txt\nquery /e 1 5 *.txt\nquery /e 4 3 *.vbs", "3\n2\n2\n1\n2"], ["12 7\n1 2\n1 3\n1 4\n2 5\n2 6\n3 7\n7 12\n8 4\n8 9\n10 9\n11 9\n0\n2 c c\n3 zz c c\n0\n1 gif\n2 png bmp\n3 avl avl mpshi\n0\n4 cpp c pas js\n5 a b c d e\n0\n3 a b c\nquery /p 11 12\nquery /e 1 2 *.gif\nquery /e 6 10 *.c\ndel /e 2 9 *.c\ndel /e 3 12 *.c\nquery /e 5 6 *.gif\nquery /e 6 1 *.c", "7\n0\n4\n3\n3\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "二分", "树链剖分"], "title": "PION后缀自动机", "background": "NOIP2018原创模拟题T6\n\nNOIP2018原创模拟赛DAY2 T3\n\nNOIP DAY1 T3+ or DAY2 T3 难度\n\n鉴于 NOIP2017 DAY2 T3 的难度，就有了这道题。**然而这道题考察的知识并不是后缀自动机**", "description": "小P是一个技术高超的程序员，他开发了一套自己的操作系统，称为PION系统，该系统与Windows和Linux有很大不同，目前他正在测试该系统。\n\nPION系统与Windows系统最大的不同在于文件的储存与操作，POIN的文件夹没有父子之分。我们知道，在Windows系统中，可以在文件夹里新建子文件夹。但是，PION系统文件夹不分父子关系，**但是部分文件夹之间可以互相直接访问，我们称这种关系为互访关系，而且，对于一个有$n$个文件夹的系统来说，这种互访关系有$n-1$个，且保证所有文件夹均可以通过互访关系而互相访问。也就是说：我们可以把Windows中的文件夹的集合看作一棵有根树，而把PION系统中的文件夹集合看作为无根树。**\n\n在PION系统中，每个文件夹都可以储存文件，和Windows一样，文件名包含后缀名。\n\n现在小P正在构思一种可以对文件夹中文件后缀进行方便操作的交互式程序dmc，他也将其称为**PION后缀自动机**。由于他太忙了，所以他希望你帮他实现**部分功能**。\n\n他希望你帮他实现三个功能：\n\n1.计算两个文件夹之间的距离。我们定义：文件夹之间的距离为其中一个文件夹通过互访达到另一个文件夹最少互访次数。比如：同一个文件夹距离为0，两个有互访关系的文件夹距离为1。\n\n2.计算两个文件夹路径之间（包含这两个文件夹）的文件夹中的文件的后缀名为A的文件数量，**其中A是一个小写字符串。提示：我们可以把PION文件夹之间的路径理解为树中两节点之间的路径。**\n\n3.删除两个文件夹路径之间（包含这两个文件夹）的文件夹中的文件的后缀名为A的文件，并统计被删除文件的数量。\n\n由于dmc是一个交互系统，所以我们用tab语言描述这三个操作：\n\n```\nquery /p u v\n```\n\n表示操作一，其中 u,v 表示两文件夹的编号\n\n```\nquery /e u v *.A\n```\n\n表示操作二，其中 u,v 表示两文件夹的编号，$'*'$ 为通配符，$'.'$用于分隔文件名与后缀，**A是一个小写字符串**。\n\n```\ndel /e u v *.A\n```\n\n表示操作三， $u,v, *.A$ 意义与操作二相同。\n\n**如果没有看懂题目请结合样例及样例解释来理解。**\n\n最后，这个困难的任务就交给你了。", "inputFormat": "第一行两个数，$n,m$，$n$表示文件夹的数量（文件夹编号在$[1,n]$），$m$表示操作的数量\n\n接下来 $n-1$ 行，每行两个数 $u,v$，表示文件夹 $u,v$ 之间有互访关系\n\n接下来 $n$ 行，第$i$行第一个数为 $k$，表示第$i$个文件夹有$k$个文件，接下来为$k$个字符串，表示每个文件的后缀名\n\n再接下来$m$行，每行一串指令，格式见上文", "outputFormat": "对于每个指令，输出一个数，输出数的意义见上文", "hint": "**样例一解释：**\n\n![T6](https://cdn.luogu.com.cn/upload/pic/34166.png)\n\n如图为样例一大致结构，橙色方框为文件夹，灰色文字表示文件后缀名，红色线条表示文件互访关系。\n\n对于第一个操作：文件夹1到5之间txt文件有3个所以输出3  \n对于第二个操作：文件夹1与4距离为2  \n对于第三个操作：删除的为文件夹2的文件，txt文件有两个，所以输出2  \n对于第四个操作：由于文件夹2的txt文件被删除了，所以1到5之间txt文件只有1个  \n对于第五个操作：文件夹3到4之间vbs文件有2个所以输出2\n\n**数据范围：**\n\n30%数据满足：$n,m<=100,k<=3$\n\n50%数据满足：$n,m<=5000,k<=10$\n\n70%数据满足：$n,m<=2 \\times 10^4,k<=50$\n\n90%数据满足：$n,m<=5 \\times 10^4$\n\n100%数据满足：$n,m<=10^5$，文件总数小于$5 \\times 10^5$，文件后缀名为小写字符串且不超过6个字符\n\n其他说明：\n\n1.约50%的数据为完全随机生成\n\n2.数据弱化版：[PION后缀自动机（数据弱化版）](https://www.luogu.org/problemnew/show/U41487)", "locale": "zh-CN", "translations": {"en": {"title": "PION Suffix Automaton", "background": "NOIP2018 original mock problem T6.\n\nNOIP2018 original mock contest DAY2 T3.\n\nDifficulty: NOIP DAY1 T3+ or DAY2 T3.\n\nConsidering the difficulty of NOIP2017 DAY2 T3, this problem was created. **However, the knowledge tested in this problem is not the suffix automaton.**", "description": "Xiao P is a highly skilled programmer. He developed his own operating system called the PION system. This system is very different from Windows and Linux, and he is currently testing it.\n\nThe biggest difference between the PION system and Windows is how files are stored and managed. PION folders do not have a parent-child relationship. We know that in Windows, you can create subfolders inside a folder. However, in the PION system, folders have no parent-child relationship. **But some folders can directly access each other. We call this relationship a mutual-access relationship. For a system with $n$ folders, there are $n-1$ such mutual-access relationships, and it is guaranteed that all folders can reach each other through these relationships. That is, we can view the set of folders in Windows as a rooted tree, while the set of folders in the PION system can be viewed as an unrooted tree.**\n\nIn the PION system, each folder can store files. Like Windows, file names include extensions.\n\nNow Xiao P is designing an interactive program called dmc that can conveniently operate on file extensions inside folders, and he also calls it the **PION Suffix Automaton**. Since he is too busy, he wants you to implement **some of its functions**.\n\nYou need to implement three functions:\n\n1. Compute the distance between two folders. We define: the distance between two folders is the minimum number of mutual-access steps needed to go from one folder to the other. For example, the distance from a folder to itself is 0, and the distance between two folders with a mutual-access relationship is 1.\n\n2. Compute, on the path between two folders (including both folders), how many files in the folders along this path have extension A, **where A is a lowercase string**. Hint: we can understand the path between two PION folders as the path between two nodes in a tree.\n\n3. Delete, on the path between two folders (including both folders), all files in the folders along this path whose extension is A, and count how many files were deleted.\n\nSince dmc is an interactive system, we use the tab language to describe these three operations:\n\n```\nquery /p u v\n```\n\nRepresents operation 1, where $u,v$ are the IDs of the two folders.\n\n```\nquery /e u v *.A\n```\n\nRepresents operation 2, where $u,v$ are the IDs of the two folders, $'*'$ is a wildcard, and $'.'$ is used to separate the file name and the extension. **A is a lowercase string**.\n\n```\ndel /e u v *.A\n```\n\nRepresents operation 3. The meanings of $u,v, *.A$ are the same as in operation 2.\n\n**If you do not understand the statement, please combine the sample and the sample explanation to understand it.**\n\nFinally, this difficult task is left to you.", "inputFormat": "The first line contains two integers $n,m$. $n$ is the number of folders (folder IDs are in $[1,n]$), and $m$ is the number of operations.\n\nThe next $n-1$ lines each contain two integers $u,v$, indicating that folders $u$ and $v$ have a mutual-access relationship.\n\nThe next $n$ lines: on the $i$-th line, the first integer is $k$, meaning folder $i$ has $k$ files, followed by $k$ strings, each being a file extension.\n\nThen the next $m$ lines each contain one command string, whose format is shown above.", "outputFormat": "For each command, output one integer, whose meaning is described above.", "hint": "**Sample 1 explanation:**\n\n![T6](https://cdn.luogu.com.cn/upload/pic/34166.png)\n\nThe figure shows the approximate structure of sample 1. Orange boxes are folders, gray text indicates file extensions, and red lines indicate mutual-access relationships between folders.\n\nFor the first operation: there are 3 txt files between folders 1 and 5, so output 3.  \nFor the second operation: the distance between folders 1 and 4 is 2.  \nFor the third operation: the deleted files are in folder 2, and there are 2 txt files, so output 2.  \nFor the fourth operation: since the txt files in folder 2 were deleted, there is only 1 txt file between folders 1 and 5.  \nFor the fifth operation: there are 2 vbs files between folders 3 and 4, so output 2.\n\n**Constraints:**\n\nFor 30% of the testdata: $n,m<=100,k<=3$.\n\nFor 50% of the testdata: $n,m<=5000,k<=10$.\n\nFor 70% of the testdata: $n,m<=2 \\times 10^4,k<=50$.\n\nFor 90% of the testdata: $n,m<=5 \\times 10^4$.\n\nFor 100% of the testdata: $n,m<=10^5$, the total number of files is less than $5 \\times 10^5$, file extensions are lowercase strings and are no longer than 6 characters.\n\nOther notes:\n\n1. About 50% of the testdata is generated completely at random.\n\n2. Weakened version: [PION Suffix Automaton (Weakened Testdata Version)](https://www.luogu.org/problemnew/show/U41487).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "PION后缀自动机", "background": "NOIP2018原创模拟题T6\n\nNOIP2018原创模拟赛DAY2 T3\n\nNOIP DAY1 T3+ or DAY2 T3 难度\n\n鉴于 NOIP2017 DAY2 T3 的难度，就有了这道题。**然而这道题考察的知识并不是后缀自动机**", "description": "小P是一个技术高超的程序员，他开发了一套自己的操作系统，称为PION系统，该系统与Windows和Linux有很大不同，目前他正在测试该系统。\n\nPION系统与Windows系统最大的不同在于文件的储存与操作，POIN的文件夹没有父子之分。我们知道，在Windows系统中，可以在文件夹里新建子文件夹。但是，PION系统文件夹不分父子关系，**但是部分文件夹之间可以互相直接访问，我们称这种关系为互访关系，而且，对于一个有$n$个文件夹的系统来说，这种互访关系有$n-1$个，且保证所有文件夹均可以通过互访关系而互相访问。也就是说：我们可以把Windows中的文件夹的集合看作一棵有根树，而把PION系统中的文件夹集合看作为无根树。**\n\n在PION系统中，每个文件夹都可以储存文件，和Windows一样，文件名包含后缀名。\n\n现在小P正在构思一种可以对文件夹中文件后缀进行方便操作的交互式程序dmc，他也将其称为**PION后缀自动机**。由于他太忙了，所以他希望你帮他实现**部分功能**。\n\n他希望你帮他实现三个功能：\n\n1.计算两个文件夹之间的距离。我们定义：文件夹之间的距离为其中一个文件夹通过互访达到另一个文件夹最少互访次数。比如：同一个文件夹距离为0，两个有互访关系的文件夹距离为1。\n\n2.计算两个文件夹路径之间（包含这两个文件夹）的文件夹中的文件的后缀名为A的文件数量，**其中A是一个小写字符串。提示：我们可以把PION文件夹之间的路径理解为树中两节点之间的路径。**\n\n3.删除两个文件夹路径之间（包含这两个文件夹）的文件夹中的文件的后缀名为A的文件，并统计被删除文件的数量。\n\n由于dmc是一个交互系统，所以我们用tab语言描述这三个操作：\n\n```\nquery /p u v\n```\n\n表示操作一，其中 u,v 表示两文件夹的编号\n\n```\nquery /e u v *.A\n```\n\n表示操作二，其中 u,v 表示两文件夹的编号，$'*'$ 为通配符，$'.'$用于分隔文件名与后缀，**A是一个小写字符串**。\n\n```\ndel /e u v *.A\n```\n\n表示操作三， $u,v, *.A$ 意义与操作二相同。\n\n**如果没有看懂题目请结合样例及样例解释来理解。**\n\n最后，这个困难的任务就交给你了。", "inputFormat": "第一行两个数，$n,m$，$n$表示文件夹的数量（文件夹编号在$[1,n]$），$m$表示操作的数量\n\n接下来 $n-1$ 行，每行两个数 $u,v$，表示文件夹 $u,v$ 之间有互访关系\n\n接下来 $n$ 行，第$i$行第一个数为 $k$，表示第$i$个文件夹有$k$个文件，接下来为$k$个字符串，表示每个文件的后缀名\n\n再接下来$m$行，每行一串指令，格式见上文", "outputFormat": "对于每个指令，输出一个数，输出数的意义见上文", "hint": "**样例一解释：**\n\n![T6](https://cdn.luogu.com.cn/upload/pic/34166.png)\n\n如图为样例一大致结构，橙色方框为文件夹，灰色文字表示文件后缀名，红色线条表示文件互访关系。\n\n对于第一个操作：文件夹1到5之间txt文件有3个所以输出3  \n对于第二个操作：文件夹1与4距离为2  \n对于第三个操作：删除的为文件夹2的文件，txt文件有两个，所以输出2  \n对于第四个操作：由于文件夹2的txt文件被删除了，所以1到5之间txt文件只有1个  \n对于第五个操作：文件夹3到4之间vbs文件有2个所以输出2\n\n**数据范围：**\n\n30%数据满足：$n,m<=100,k<=3$\n\n50%数据满足：$n,m<=5000,k<=10$\n\n70%数据满足：$n,m<=2 \\times 10^4,k<=50$\n\n90%数据满足：$n,m<=5 \\times 10^4$\n\n100%数据满足：$n,m<=10^5$，文件总数小于$5 \\times 10^5$，文件后缀名为小写字符串且不超过6个字符\n\n其他说明：\n\n1.约50%的数据为完全随机生成\n\n2.数据弱化版：[PION后缀自动机（数据弱化版）](https://www.luogu.org/problemnew/show/U41487)", "locale": "zh-CN"}}}
{"pid": "P4948", "type": "P", "difficulty": 6, "samples": [["3 4 0", "84"], ["3 10 1", "3210"], ["3 9 2", "6894"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学"], "title": "数列求和", "background": "", "description": "给定 $n,a,k$，求：\n\n$$\\sum_{i=1}^n i^k a^i$$\n\n答案对 $10^9 + 7$ 取模。", "inputFormat": "输入一行三个非负整数 $n,a,k$。其中 $n, a \\ge 1$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "| 测试点编号 | $n=$ | $k=$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $10^6$ | $10^3$ |\n| $2$ | $10^6$ | $2\\times 10^3$ |\n| $3$ | $10^{18}$ |  $0$|\n| $4$ | $10^{18}$ |$1$  |\n| $5,6$ |  $10^{18}$| $2$ |\n| $7,8$ |  $10^{18}$|  $10^3$|\n| $9,10$ |$10^{18}$  |  $2\\times 10^3$|\n\n对于 $100\\%$ 的数据，$n\\le10^{18}$，$a\\le10^9$，$k\\le2000$。", "locale": "zh-CN", "translations": {"en": {"title": "Sequence Sum", "background": "", "description": "Given $n, a, k$, compute:\n\n$$\\sum_{i=1}^n i^k a^i$$\n\nOutput the answer modulo $10^9 + 7$.", "inputFormat": "Input one line with three non-negative integers $n, a, k$. Here $n, a \\ge 1$.", "outputFormat": "Output one line with one integer representing the answer.", "hint": "| Test Point ID | $n=$ | $k=$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $10^6$ | $10^3$ |\n| $2$ | $10^6$ | $2\\times 10^3$ |\n| $3$ | $10^{18}$ |  $0$|\n| $4$ | $10^{18}$ |$1$  |\n| $5,6$ |  $10^{18}$| $2$ |\n| $7,8$ |  $10^{18}$|  $10^3$|\n| $9,10$ |$10^{18}$  |  $2\\times 10^3$|\n\nFor $100\\%$ of the testdata, $n \\le 10^{18}$, $a \\le 10^9$, and $k \\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "数列求和", "background": "", "description": "给定 $n,a,k$，求：\n\n$$\\sum_{i=1}^n i^k a^i$$\n\n答案对 $10^9 + 7$ 取模。", "inputFormat": "输入一行三个非负整数 $n,a,k$。其中 $n, a \\ge 1$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "| 测试点编号 | $n=$ | $k=$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $10^6$ | $10^3$ |\n| $2$ | $10^6$ | $2\\times 10^3$ |\n| $3$ | $10^{18}$ |  $0$|\n| $4$ | $10^{18}$ |$1$  |\n| $5,6$ |  $10^{18}$| $2$ |\n| $7,8$ |  $10^{18}$|  $10^3$|\n| $9,10$ |$10^{18}$  |  $2\\times 10^3$|\n\n对于 $100\\%$ 的数据，$n\\le10^{18}$，$a\\le10^9$，$k\\le2000$。", "locale": "zh-CN"}}}
{"pid": "P4949", "type": "P", "difficulty": 5, "samples": [["4 5\n1 2 11\n1 3 12\n2 3 13\n1 4 15\n2 2 3\n1 2 1\n2 2 3\n2 2 4\n2 3 4", "13\n12\n26\n16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["最近公共祖先 LCA", "树链剖分", "基环树"], "title": "最短距离", "background": null, "description": "给出一个 $n$ 个点 $n$ 条边的无向连通图。\n\n你需要支持两种操作：\n\n1. 修改 第 $x$  条边的长度为 $y$ ；\n\n2. 查询 点 $x$ 到点 $y$ 的最短距离。\n\n共有 $m$ 次操作。", "inputFormat": "输入共 $n+m+1$ 行：\n\n第 $1$ 行，包含两个正整数 $n,m$，表示点数即边数，操作次数。\n\n第 $2$ 行到第 $n+1$ 行，每行包含三个正整数 $x,y,z$，表示 $x$ 与 $y$ 间有一条长度为 $z$ 的边。\n\n第 $n+2$ 到 $n+m+1$ 行，每行包含三个正整数 $opt,x,y$，表示操作种类，操作的参数（含义见【题目描述】）。", "outputFormat": "对于每次操作 $2$ 输出查询的结果。", "hint": "![Luogu](https://cdn.luogu.com.cn/upload/pic/37934.png)  \n\n对于 $100\\%$ 的数据，保证 $z\\in [0,5000]$。", "locale": "zh-CN", "translations": {"en": {"title": "Shortest Distance.", "background": "", "description": "You are given an undirected connected graph with $n$ vertices and $n$ edges.\n\nYou need to support two types of operations:\n\n1. Modify the length of the $x$-th edge to $y$.\n2. Query the shortest distance from vertex $x$ to vertex $y$.\n\nThere are $m$ operations in total.", "inputFormat": "The input has a total of $n+m+1$ lines:\n\nLine $1$ contains two positive integers $n,m$, representing the number of vertices (which is also the number of edges) and the number of operations.\n\nLines $2$ to $n+1$ each contain three positive integers $x,y,z$, indicating that there is an edge of length $z$ between $x$ and $y$.\n\nLines $n+2$ to $n+m+1$ each contain three positive integers $opt,x,y$, representing the type of operation and its parameters (see the meaning in the “Description”).", "outputFormat": "For each operation of type $2$, output the query result.", "hint": "![Luogu](https://cdn.luogu.com.cn/upload/pic/37934.png)  \n\nFor $100\\%$ of the testdata, it is guaranteed that $z\\in [0,5000]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最短距离", "background": null, "description": "给出一个 $n$ 个点 $n$ 条边的无向连通图。\n\n你需要支持两种操作：\n\n1. 修改 第 $x$  条边的长度为 $y$ ；\n\n2. 查询 点 $x$ 到点 $y$ 的最短距离。\n\n共有 $m$ 次操作。", "inputFormat": "输入共 $n+m+1$ 行：\n\n第 $1$ 行，包含两个正整数 $n,m$，表示点数即边数，操作次数。\n\n第 $2$ 行到第 $n+1$ 行，每行包含三个正整数 $x,y,z$，表示 $x$ 与 $y$ 间有一条长度为 $z$ 的边。\n\n第 $n+2$ 到 $n+m+1$ 行，每行包含三个正整数 $opt,x,y$，表示操作种类，操作的参数（含义见【题目描述】）。", "outputFormat": "对于每次操作 $2$ 输出查询的结果。", "hint": "![Luogu](https://cdn.luogu.com.cn/upload/pic/37934.png)  \n\n对于 $100\\%$ 的数据，保证 $z\\in [0,5000]$。", "locale": "zh-CN"}}}
{"pid": "P4950", "type": "P", "difficulty": 6, "samples": [["3\n11 40\n1 3\n2 4 7\n2018 20170901\n1 4\n1 7\n19260817 998244353\n3 2 5 6\n4 0 7 8 9\n", "310\n52885750312822\n2039707997741122\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "完美数字", "background": null, "description": "给出两个数字集合 $S$ 和 $T$，其中元素均为 $0$ 到 $9$ 之间的整数。\n\n定义“完美数字”为数位中包含 $S$ 中所有的数且不包含 $T$ 中任意一个数的数字。\n\n例如，$S=\\{1,3,4\\}$，$T=\\{7,8\\}$，则 $1345$、$341166$、$4133129$ 都是完美数字，而 $13$、$8431$、$34171$ 都不是完美数字（因为 $13$ 数位中不包含 $4$，$8431$ 和 $34171$ 中虽然包含了 $1$、$3$、$4$ 这三个数但又包含 $8$ 和 $7$）。\n\n求 $[l,r]$ 中所有完美数字的和。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n下面 $T$ 组数据：\n\n第一行两个正整数 $l,r$；\n\n第二行，先输入一个正整数 $n_S$ 表示 $S$ 中元素的个数；随后输入 $n_S$ 个整数，表示 $S$ 中的元素。\n\n第二行，先输入一个正整数 $n_T$ 表示 $T$ 中元素的个数；随后输入 $n_T$ 个整数，表示 $T$ 中的元素。", "outputFormat": "对于每组数据，输出一个整数，为 $[l,r]$ 中所有完美数字的和。", "hint": "### 样例解释\n\n对于第一组样例数据，完美数字为：\n\n$13$、$23$、$30$、$31$、$32$、$33$、$35$、$36$、$38$、$39$。\n\n所以总和为 $310$。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$1 \\le l \\le r \\le 10^4$。\n\n对于另外 $10\\%$ 的数据，$n_S=n_T=0$。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 2000$，$1 \\le l \\le r \\le 10^9$，$0 \\le n_S,n_T \\le 10$。保证 $S$ 和 $T$ 中的元素均为 $[0,9]$ 中的整数。", "locale": "zh-CN", "translations": {"en": {"title": "Perfect Numbers", "background": "", "description": "You are given two sets of digits $S$ and $T$, where all elements are integers between $0$ and $9$.\n\nA “perfect number” is a number whose digits contain all digits in $S$ and contain none of the digits in $T$.\n\nFor example, if $S=\\{1,3,4\\}$ and $T=\\{7,8\\}$, then $1345$, $341166$, and $4133129$ are perfect numbers, while $13$, $8431$, and $34171$ are not (because $13$ does not contain digit $4$, and although $8431$ and $34171$ contain digits $1$, $3$, and $4$, they also contain $8$ and $7$).\n\nFind the sum of all perfect numbers in $[l,r]$.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of test cases.\n\nThen follow $T$ test cases:\n\nThe first line contains two positive integers $l,r$.\n\nThe second line: first input a positive integer $n_S$ representing the number of elements in $S$, followed by $n_S$ integers representing the elements of $S$.\n\nThe third line: first input a positive integer $n_T$ representing the number of elements in $T$, followed by $n_T$ integers representing the elements of $T$.", "outputFormat": "For each test case, output one integer: the sum of all perfect numbers in $[l,r]$.", "hint": "### Sample Explanation\n\nFor the first sample test case, the perfect numbers are:\n\n$13$, $23$, $30$, $31$, $32$, $33$, $35$, $36$, $38$, $39$.\n\nSo the total sum is $310$.\n\n### Constraints\n\nFor $30\\%$ of the testdata, $1 \\le l \\le r \\le 10^4$.\n\nFor another $10\\%$ of the testdata, $n_S=n_T=0$.\n\nFor $100\\%$ of the testdata, $1 \\le T \\le 2000$, $1 \\le l \\le r \\le 10^9$, $0 \\le n_S,n_T \\le 10$. It is guaranteed that all elements in $S$ and $T$ are integers in $[0,9]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "完美数字", "background": null, "description": "给出两个数字集合 $S$ 和 $T$，其中元素均为 $0$ 到 $9$ 之间的整数。\n\n定义“完美数字”为数位中包含 $S$ 中所有的数且不包含 $T$ 中任意一个数的数字。\n\n例如，$S=\\{1,3,4\\}$，$T=\\{7,8\\}$，则 $1345$、$341166$、$4133129$ 都是完美数字，而 $13$、$8431$、$34171$ 都不是完美数字（因为 $13$ 数位中不包含 $4$，$8431$ 和 $34171$ 中虽然包含了 $1$、$3$、$4$ 这三个数但又包含 $8$ 和 $7$）。\n\n求 $[l,r]$ 中所有完美数字的和。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n下面 $T$ 组数据：\n\n第一行两个正整数 $l,r$；\n\n第二行，先输入一个正整数 $n_S$ 表示 $S$ 中元素的个数；随后输入 $n_S$ 个整数，表示 $S$ 中的元素。\n\n第二行，先输入一个正整数 $n_T$ 表示 $T$ 中元素的个数；随后输入 $n_T$ 个整数，表示 $T$ 中的元素。", "outputFormat": "对于每组数据，输出一个整数，为 $[l,r]$ 中所有完美数字的和。", "hint": "### 样例解释\n\n对于第一组样例数据，完美数字为：\n\n$13$、$23$、$30$、$31$、$32$、$33$、$35$、$36$、$38$、$39$。\n\n所以总和为 $310$。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$1 \\le l \\le r \\le 10^4$。\n\n对于另外 $10\\%$ 的数据，$n_S=n_T=0$。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 2000$，$1 \\le l \\le r \\le 10^9$，$0 \\le n_S,n_T \\le 10$。保证 $S$ 和 $T$ 中的元素均为 $[0,9]$ 中的整数。", "locale": "zh-CN"}}}
{"pid": "P4951", "type": "P", "difficulty": 5, "samples": [["5 5 100\n1 2 20 5\n1 3 20 5\n1 4 20 5\n1 5 20 5\n2 3 23 1", "1.0625"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2001", "二分", "USACO", "生成树", "分数规划"], "title": "[USACO01OPEN] Earthquake", "background": "", "description": "一场地震把约翰家的牧场摧毁了， 坚强的约翰决心重建家园。 约翰已经重建了 $n$ 个牧场，现在他希望能修建一些道路把它们连接起来。研究地形之后，约翰发现可供修建的道路有 $m$ 条。碰巧的是，奶牛们最近也成立一个工程队，专门从事修复道路。而然，奶牛们很有经济头脑，如果无利可图，它们是不会干的。\n\n奶牛们关注的是挣钱速度，即总利润和总施工时间的比值。约翰和奶牛达成了协议，奶牛负责修建道路，将所有牧场连通，而约翰需要支付 $f$ 元。每条道路都有自己的施工时间和建造成本。连接两个相同的牧场的道路可能有多条。保证所有的牧场必定是可连通的，不过也有可能一些道路的建造成本之和会超过 $f$。  \n\n请帮助奶牛们选择修复哪些道路，才能使单位时间的利润最大？\n", "inputFormat": "第一行三个整数 $n,m,f$。\n\n第二行到第 $m+1$ 行，第 $i+1$ 行表示第 $i$ 条道路的信息。每行有四个整数 $u_i,v_i,c_i,t_i$， $u_i$ 和 $v_i$ 表示这条道路连接的牧场编号，$c_i$ 表示修建道路的成本，$t_i$ 表示道路修建所需要的时间。", "outputFormat": "第一行，一个保留四位小数的浮点数，表示奶牛们能挣到的最大单位时间利润，如果奶牛们无钱可赚，则输出`0.0000`。", "hint": "#### 样例输入输出 1 解释\n\n奶牛们可以选择连通最后四条道路，则总时间为 $16$，总成本为 $83$，所以单位利润为 $\\dfrac{17}{16}=1.0625$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证\n- $1 \\leq n \\leq 400$，$1 \\leq m \\leq 10000$，$1 \\leq f \\leq 2 \\times 10^9$。\n- $1 \\leq u_i,v_i \\leq n$，$1 \\leq c_i,t_i \\leq 2 \\times 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO01OPEN] Earthquake", "background": "", "description": "An earthquake destroyed John’s farm. Tough John decides to rebuild his home. John has rebuilt $n$ pastures, and now he wants to build some roads to connect them. After studying the terrain, John found that there are $m$ possible roads that can be built. Coincidentally, the cows have recently formed an engineering team specialized in repairing roads. However, the cows are very business-minded: if there is no profit, they will not do the job.\n\nThe cows care about the speed of making money, that is, the ratio of total profit to total construction time. John and the cows reach an agreement: the cows will build roads to make all pastures connected, and John will pay $f$ dollars. Each road has its own construction time and building cost. There may be multiple roads connecting the same pair of pastures. It is guaranteed that all pastures can be connected, but it is also possible that the sum of building costs of some set of roads exceeds $f$.\n\nPlease help the cows choose which roads to repair so that the profit per unit time is maximized.", "inputFormat": "The first line contains three integers $n,m,f$.\n\nLines $2$ to $m+1$ describe the roads. The $(i+1)$-th line gives the information of the $i$-th road: four integers $u_i,v_i,c_i,t_i$, where $u_i$ and $v_i$ are the indices of the pastures this road connects, $c_i$ is the cost to build the road, and $t_i$ is the time required to build the road.", "outputFormat": "The first line contains a floating-point number rounded to four decimal places, representing the maximum profit per unit time the cows can earn. If the cows cannot make any profit, output `0.0000`.", "hint": "#### Explanation of Sample Input/Output 1\n\nThe cows can choose the last four roads to connect all pastures. Then the total time is $16$ and the total cost is $83$, so the profit per unit time is $\\dfrac{17}{16}=1.0625$.\n\n#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that:\n- $1 \\leq n \\leq 400$, $1 \\leq m \\leq 10000$, $1 \\leq f \\leq 2 \\times 10^9$.\n- $1 \\leq u_i,v_i \\leq n$, $1 \\leq c_i,t_i \\leq 2 \\times 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO01OPEN] Earthquake", "background": "", "description": "一场地震把约翰家的牧场摧毁了， 坚强的约翰决心重建家园。 约翰已经重建了 $n$ 个牧场，现在他希望能修建一些道路把它们连接起来。研究地形之后，约翰发现可供修建的道路有 $m$ 条。碰巧的是，奶牛们最近也成立一个工程队，专门从事修复道路。而然，奶牛们很有经济头脑，如果无利可图，它们是不会干的。\n\n奶牛们关注的是挣钱速度，即总利润和总施工时间的比值。约翰和奶牛达成了协议，奶牛负责修建道路，将所有牧场连通，而约翰需要支付 $f$ 元。每条道路都有自己的施工时间和建造成本。连接两个相同的牧场的道路可能有多条。保证所有的牧场必定是可连通的，不过也有可能一些道路的建造成本之和会超过 $f$。  \n\n请帮助奶牛们选择修复哪些道路，才能使单位时间的利润最大？\n", "inputFormat": "第一行三个整数 $n,m,f$。\n\n第二行到第 $m+1$ 行，第 $i+1$ 行表示第 $i$ 条道路的信息。每行有四个整数 $u_i,v_i,c_i,t_i$， $u_i$ 和 $v_i$ 表示这条道路连接的牧场编号，$c_i$ 表示修建道路的成本，$t_i$ 表示道路修建所需要的时间。", "outputFormat": "第一行，一个保留四位小数的浮点数，表示奶牛们能挣到的最大单位时间利润，如果奶牛们无钱可赚，则输出`0.0000`。", "hint": "#### 样例输入输出 1 解释\n\n奶牛们可以选择连通最后四条道路，则总时间为 $16$，总成本为 $83$，所以单位利润为 $\\dfrac{17}{16}=1.0625$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证\n- $1 \\leq n \\leq 400$，$1 \\leq m \\leq 10000$，$1 \\leq f \\leq 2 \\times 10^9$。\n- $1 \\leq u_i,v_i \\leq n$，$1 \\leq c_i,t_i \\leq 2 \\times 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4952", "type": "P", "difficulty": 5, "samples": [["3 5 70\n30 25\n50 21\n20 20\n5 18\n35 30", "35"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04MAR] Financial Aid", "background": "", "description": "   人类可以选择很多大学，而奶牛们却没学可上。为解决这个问题，贝西和她的伙伴们创立了一所奶牛大学，取名为哞哞大学。\n\n   为了选拔优秀学生，她们发明了一种奶牛学术能力测试（简称 CSAT） ，这种测试的分数异常精确，每头奶牛的成绩可以用$0$到$2×10^9$之间的一个整数表示，而且可以保证每头奶牛的分数都不同。\n\n   哞哞大学的学费很贵，奶牛们表示负担不起，他们都各自申请了奖学金。政府并没有为奶牛准备奖学金，所有的预算都必须要从学校有限的助学基金中扣除（设基金总额为F)。\n\n   哞哞大学有N间宿舍，N是一个奇数，所以贝西只能接受N头奶牛的申请，她发誓不会让入学的奶牛少于N。此外，她希望新生的 CSAT 成绩表现优异，她以中位数来衡量新生的总体水平。所谓中位数，就是排序后处在最中间的分数，比如3,8,9,7,5的中位数是7。\n\n   今年，共有C头奶牛申请入学，给定每头奶牛的 CSAT 成绩和申请的奖学金数目，以及学校可赞助的总额，确定贝西接受哪些奶牛的申请才可以使成绩的中位数达到最大。", "inputFormat": "第一行：三个用空格分开的整数：$N$，$C$和$F$。$1 ≤ N ≤ 19999$，$N ≤ C ≤ 10^5$ ，$0 ≤ F ≤ 2 × 10^9$\n第二行到$C + 1$行：每行有两个用空格分开的整数。第一个数是这头奶牛的 CSAT 成绩，第二个数是这头奶牛需要的奖学金$Q_i$ ，$0 ≤ Q_i ≤ 10^5 $。", "outputFormat": "第一行：一个整数，表示贝西可以得到的最大中位数，如果现有基金不够资助任何N头奶牛，则输出-1。", "hint": "贝西接受 CSAT 分数为 5，35，50 的奶牛的申请，中位数为 35，需支付的奖学金总额为18 + 30 + 21 = 69", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04MAR] Financial Aid", "background": "", "description": "Humans can choose from many colleges, but cows have nowhere to go to school. To solve this problem, Bessie and her friends founded a cow university called Moo Moo University.\n\nIn order to select outstanding students, they invented a Cow Scholastic Ability Test (CSAT). The scores of this test are extremely precise: each cow’s score can be represented by an integer between $0$ and $2×10^9$, and it is guaranteed that no two cows have the same score.\n\nTuition at Moo Moo University is very expensive, and the cows cannot afford it, so they each apply for financial aid. The government does not provide scholarships for cows; all funding must be paid from the school’s limited financial aid fund (let the total fund be $F$).\n\nMoo Moo University has $N$ dorm rooms. Since $N$ is an odd number, Bessie can accept applications from only $N$ cows, and she swears she will not admit fewer than $N$ cows. In addition, she wants the freshmen to have excellent CSAT performance, and she measures the overall level by the median. The median is the score in the exact middle after sorting. For example, the median of 3, 8, 9, 7, 5 is 7.\n\nThis year, a total of $C$ cows apply. Given each cow’s CSAT score and the amount of financial aid requested, as well as the total amount the school can sponsor, determine which cows Bessie should accept so that the median score is as large as possible.", "inputFormat": "Line 1: Three integers separated by spaces: $N$, $C$, and $F$. $1 ≤ N ≤ 19999$, $N ≤ C ≤ 10^5$, $0 ≤ F ≤ 2 × 10^9$.\n\nLines 2 to $C + 1$: Each line contains two integers separated by a space. The first number is the cow’s CSAT score, and the second number is the amount of financial aid this cow requires, $Q_i$. $0 ≤ Q_i ≤ 10^5$.", "outputFormat": "Line 1: One integer, the maximum median Bessie can achieve. If the current fund is not enough to support any $N$ cows, output $-1$.", "hint": "Bessie accepts cows with CSAT scores 5, 35, and 50. The median is 35, and the total financial aid required is $18 + 30 + 21 = 69$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04MAR] Financial Aid", "background": "", "description": "   人类可以选择很多大学，而奶牛们却没学可上。为解决这个问题，贝西和她的伙伴们创立了一所奶牛大学，取名为哞哞大学。\n\n   为了选拔优秀学生，她们发明了一种奶牛学术能力测试（简称 CSAT） ，这种测试的分数异常精确，每头奶牛的成绩可以用$0$到$2×10^9$之间的一个整数表示，而且可以保证每头奶牛的分数都不同。\n\n   哞哞大学的学费很贵，奶牛们表示负担不起，他们都各自申请了奖学金。政府并没有为奶牛准备奖学金，所有的预算都必须要从学校有限的助学基金中扣除（设基金总额为F)。\n\n   哞哞大学有N间宿舍，N是一个奇数，所以贝西只能接受N头奶牛的申请，她发誓不会让入学的奶牛少于N。此外，她希望新生的 CSAT 成绩表现优异，她以中位数来衡量新生的总体水平。所谓中位数，就是排序后处在最中间的分数，比如3,8,9,7,5的中位数是7。\n\n   今年，共有C头奶牛申请入学，给定每头奶牛的 CSAT 成绩和申请的奖学金数目，以及学校可赞助的总额，确定贝西接受哪些奶牛的申请才可以使成绩的中位数达到最大。", "inputFormat": "第一行：三个用空格分开的整数：$N$，$C$和$F$。$1 ≤ N ≤ 19999$，$N ≤ C ≤ 10^5$ ，$0 ≤ F ≤ 2 × 10^9$\n第二行到$C + 1$行：每行有两个用空格分开的整数。第一个数是这头奶牛的 CSAT 成绩，第二个数是这头奶牛需要的奖学金$Q_i$ ，$0 ≤ Q_i ≤ 10^5 $。", "outputFormat": "第一行：一个整数，表示贝西可以得到的最大中位数，如果现有基金不够资助任何N头奶牛，则输出-1。", "hint": "贝西接受 CSAT 分数为 5，35，50 的奶牛的申请，中位数为 35，需支付的奖学金总额为18 + 30 + 21 = 69", "locale": "zh-CN"}}}
{"pid": "P4953", "type": "P", "difficulty": 4, "samples": [["3 30 20", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2002", "USACO"], "title": "[USACO02FEB] Cow Cycling", "background": "", "description": "奶牛自行车队由 $N$ 名队员组成，他们正准备参加一个比赛，这场比赛的路程共有 $D$ 圈。车队在比赛时会排成一条直线，由于存在空气阻力，当骑车速度达到每分钟 $x$ 圈时，领头的奶牛每分钟消耗的体力为 $x^2$，其它奶牛每分钟消耗的体力为 $x$。每头奶牛的初始体力值都是相同的，记作 $E$。如果有些奶牛在比赛过程中的体力不支，就会掉队，掉队的奶牛不能继续参加比赛。每支队伍最后只要有一头奶牛能到终点就可以了。\n\n比赛规定，最小的计时单位是分钟，在每分钟开始的时候，车队要哪头奶牛负责领头，领头奶牛不能在这分钟内掉队，每分钟骑过的圈数也必须是整数。\n\n请帮忙计划一下，采用什么样的策略才能让车队以最快的时间到达终点？", "inputFormat": "第一行：三个正整数：$N, E, D$。$1 \\leq N \\leq 20$，$1 \\leq E \\leq 100$，$1 \\leq D \\leq 100$。", "outputFormat": "第一行：单独一个整数，表示最早达到终点的时间，如果无法到达终点，输出 $0$。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/spwg7uf6.png)", "locale": "zh-CN", "translations": {"en": {"title": "[USACO02FEB] Cow Cycling", "background": "", "description": "A cow cycling team consists of $N$ riders, and they are preparing for a race whose total distance is $D$ laps. During the race, the team rides in a single line. Due to air resistance, when the riding speed is $x$ laps per minute, the leading cow consumes stamina at a rate of $x^2$ per minute, while every other cow consumes stamina at a rate of $x$ per minute. All cows start with the same initial stamina, denoted by $E$. If some cows run out of stamina during the race, they will drop out, and cows that drop out cannot continue the race. For each team, it is enough as long as at least one cow can reach the finish.\n\nThe race rules state that the smallest time unit is one minute. At the beginning of each minute, the team must decide which cow will be the leader. The leading cow cannot drop out during that minute, and the number of laps ridden in each minute must be an integer.\n\nPlease plan a strategy to allow the team to reach the finish in the shortest possible time.", "inputFormat": "The first line contains three positive integers: $N, E, D$. $1 \\leq N \\leq 20$, $1 \\leq E \\leq 100$, $1 \\leq D \\leq 100$.", "outputFormat": "The first line contains a single integer, the earliest time to reach the finish. If it is impossible to reach the finish, output $0$.", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/spwg7uf6.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO02FEB] Cow Cycling", "background": "", "description": "奶牛自行车队由 $N$ 名队员组成，他们正准备参加一个比赛，这场比赛的路程共有 $D$ 圈。车队在比赛时会排成一条直线，由于存在空气阻力，当骑车速度达到每分钟 $x$ 圈时，领头的奶牛每分钟消耗的体力为 $x^2$，其它奶牛每分钟消耗的体力为 $x$。每头奶牛的初始体力值都是相同的，记作 $E$。如果有些奶牛在比赛过程中的体力不支，就会掉队，掉队的奶牛不能继续参加比赛。每支队伍最后只要有一头奶牛能到终点就可以了。\n\n比赛规定，最小的计时单位是分钟，在每分钟开始的时候，车队要哪头奶牛负责领头，领头奶牛不能在这分钟内掉队，每分钟骑过的圈数也必须是整数。\n\n请帮忙计划一下，采用什么样的策略才能让车队以最快的时间到达终点？", "inputFormat": "第一行：三个正整数：$N, E, D$。$1 \\leq N \\leq 20$，$1 \\leq E \\leq 100$，$1 \\leq D \\leq 100$。", "outputFormat": "第一行：单独一个整数，表示最早达到终点的时间，如果无法到达终点，输出 $0$。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/spwg7uf6.png)", "locale": "zh-CN"}}}
{"pid": "P4954", "type": "P", "difficulty": 6, "samples": [["3\n1\n2\n3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "贪心", "2009", "USACO", "单调队列", "动态规划优化", "线性 DP"], "title": "[USACO09OPEN] Tower of Hay G", "background": null, "description": "为了调整电灯亮度，贝西要用干草包堆出一座塔，然后爬到牛棚顶去把灯泡换掉。干草包会从传送带上运来，共会出现 $n$ 包干草，第 $i$ 包干草的宽度是 $W_i$，高度和长度统一为 $1$。干草塔要从底层开始铺建。贝西会选择最先送来的若干包干草，堆在地上作为第一层，然后再把紧接着送来的几包干草包放在第二层， 再铺建第三层……重复这个过程，一直到所有的干草全部用完。每层的干草包必须紧靠在一起，不出现缝隙，而且为了建筑稳定，上层干草的宽度不能超过下层的宽度。 按顺序运来的干草包一定要都用上，不能将其中几个干草包弃置不用。贝西的目标是建一座最高的塔，请你来帮助她完成这个任务吧。", "inputFormat": "第一行：一个整数 $n (1 \\le n \\le 100000)$。\n\n第二行到 $n + 1$ 行：第 $i + 1$ 行有一个整数 $W_i (1 \\le W_i \\le 10000)$。", "outputFormat": "第一行：单个整数，表示可以建立的最高高度。", "hint": "### 样例解释\n\n将 $1$ 和 $2$ 放在第一层，将 $3$ 放在第二层。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OPEN] Tower of Hay G", "background": "", "description": "To adjust the brightness of a lamp, Bessie wants to stack hay bales into a tower, then climb onto the barn roof to replace the light bulb. Hay bales are delivered on a conveyor belt. There will be a total of $n$ bales. The $i$-th bale has width $W_i$, and both its height and length are $1$.\n\nThe hay tower must be built starting from the bottom layer. Bessie will take several of the earliest delivered bales and place them on the ground as the first layer, then place the next several bales as the second layer, then build the third layer, and so on. This process repeats until all hay bales are used up.\n\nIn each layer, the bales must be placed tightly together with no gaps. Also, for stability, the total width of an upper layer cannot exceed the total width of the layer directly below it. All bales delivered in order must be used; she cannot discard any bale.\n\nBessie's goal is to build the tallest possible tower. Please help her complete this task.", "inputFormat": "The first line contains an integer $n (1 \\le n \\le 100000)$.\n\nLines $2$ to $n + 1$: line $i + 1$ contains an integer $W_i (1 \\le W_i \\le 10000)$.", "outputFormat": "The first line contains a single integer, representing the maximum height that can be built.", "hint": "### Sample Explanation\n\nPut $1$ and $2$ on the first layer, and put $3$ on the second layer.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09OPEN] Tower of Hay G", "background": null, "description": "为了调整电灯亮度，贝西要用干草包堆出一座塔，然后爬到牛棚顶去把灯泡换掉。干草包会从传送带上运来，共会出现 $n$ 包干草，第 $i$ 包干草的宽度是 $W_i$，高度和长度统一为 $1$。干草塔要从底层开始铺建。贝西会选择最先送来的若干包干草，堆在地上作为第一层，然后再把紧接着送来的几包干草包放在第二层， 再铺建第三层……重复这个过程，一直到所有的干草全部用完。每层的干草包必须紧靠在一起，不出现缝隙，而且为了建筑稳定，上层干草的宽度不能超过下层的宽度。 按顺序运来的干草包一定要都用上，不能将其中几个干草包弃置不用。贝西的目标是建一座最高的塔，请你来帮助她完成这个任务吧。", "inputFormat": "第一行：一个整数 $n (1 \\le n \\le 100000)$。\n\n第二行到 $n + 1$ 行：第 $i + 1$ 行有一个整数 $W_i (1 \\le W_i \\le 10000)$。", "outputFormat": "第一行：单个整数，表示可以建立的最高高度。", "hint": "### 样例解释\n\n将 $1$ 和 $2$ 放在第一层，将 $3$ 放在第二层。", "locale": "zh-CN"}}}
{"pid": "P4955", "type": "P", "difficulty": 3, "samples": [["3 5\n20 21 18 99 5\n19 22 20 16 26\n18 17 40 60 80\n1 0 0 0 1\n0 0 0 0 0\n0 0 0 0 1", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "二分", "USACO", "广度优先搜索 BFS"], "title": "[USACO14JAN] Cross Country Skiing S", "background": "", "description": "The cross-country skiing course at the winter Moolympics is described by an $M * N$ grid of elevations (1 <= M,N <= 500), each elevation being in the range 0 .. 1,000,000,000.  \n\nSome of the cells in this grid are designated as waypoints for the course.  The organizers of the Moolympics want to assign a difficulty rating $D$ to the entire course so that a cow can reach any waypoint from any other waypoint by repeatedly skiing from a cell to an adjacent cell with absolute elevation difference at most $D$.  Two cells are adjacent if one is directly north, south, east, or west of the other.  The difficulty rating of the course is the minimum value of $D$ such that all waypoints are mutually reachable in this fashion.", "inputFormat": "* Line 1: The integers $M$ and $N$.\n\n* Lines 2..1+M: Each of these $M$ lines contains $N$ integer elevations.\n\n* Lines 2+M..1+2M: Each of these $M$ lines contains $N$ values that are either $0$ or $1$, with $1$ indicating a cell that is a waypoint.", "outputFormat": "The ski course is described by a 3 x 5 grid of elevations.  The upper-left, upper-right, and lower-right cells are designated as waypoints.", "hint": "If D = 21, the three waypoints are reachable from each-other.  If D < 21, then the upper-right waypoint cannot be reached from the other two.", "locale": "en", "translations": {"en": {"title": "[USACO14JAN] Cross Country Skiing S", "background": "", "description": "The cross-country skiing course at the winter Moolympics is described by an $M * N$ grid of elevations (1 <= M,N <= 500), each elevation being in the range 0 .. 1,000,000,000.  \n\nSome of the cells in this grid are designated as waypoints for the course.  The organizers of the Moolympics want to assign a difficulty rating $D$ to the entire course so that a cow can reach any waypoint from any other waypoint by repeatedly skiing from a cell to an adjacent cell with absolute elevation difference at most $D$.  Two cells are adjacent if one is directly north, south, east, or west of the other.  The difficulty rating of the course is the minimum value of $D$ such that all waypoints are mutually reachable in this fashion.", "inputFormat": "* Line 1: The integers $M$ and $N$.\n\n* Lines 2..1+M: Each of these $M$ lines contains $N$ integer elevations.\n\n* Lines 2+M..1+2M: Each of these $M$ lines contains $N$ values that are either $0$ or $1$, with $1$ indicating a cell that is a waypoint.", "outputFormat": "The ski course is described by a 3 x 5 grid of elevations.  The upper-left, upper-right, and lower-right cells are designated as waypoints.", "hint": "If D = 21, the three waypoints are reachable from each-other.  If D < 21, then the upper-right waypoint cannot be reached from the other two.", "locale": "en"}, "zh-CN": {"title": "[USACO14JAN] Cross Country Skiing S", "background": "", "description": "冬季 Moolympics 的越野滑雪赛道由一个 $M \\times N$ 的高程网格描述（$1 \\leq M, N \\leq 500$），每个高程在 $0$ 到 $1,000,000,000$ 之间。网格中的某些单元被指定为赛道的航点。Moolympics 的组织者希望为整个赛道分配一个难度等级 $D$，以便奶牛可以通过从一个单元滑到相邻单元（绝对高程差最多为 $D$）的方式，从任何一个航点到达另一个航点。如果一个单元的正北、正南、正东或正西方向上有另一个单元，则这两个单元是相邻的。赛道的难度等级是 $D$ 的最小值，使得所有航点都可以通过这种方式相互到达。", "inputFormat": "* 第 1 行：整数 $M$ 和 $N$。\n\n* 第 2 行到第 $1+M$ 行：每一行包含 $N$ 个整数高程。\n\n* 第 $2+M$ 行到第 $1+2M$ 行：每一行包含 $N$ 个值，这些值要么是 $0$，要么是 $1$，其中 $1$ 表示该单元是一个航点。", "outputFormat": "滑雪赛道由一个 3 x 5 的高程网格描述。左上角、右上角和右下角的单元被指定为航点。", "hint": "如果 $D = 21$，三个航点可以相互到达。如果 $D < 21$，则右上角的航点无法从其他两个航点到达。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4956", "type": "P", "difficulty": 1, "samples": [["1456", "1\n1"], ["6188", "14\n1"], ["40404", "99\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "不定方程", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #6] Davor", "background": null, "description": "After successfully conquering the South Pole, Davor is preparing for new challenges. Next up is the Arctic expedition to Siberia, Greenland and Norway. He begins his travels on 31 December 2018, and needs to collect $N$ kunas (Croatian currency) by then. In order to do this, he has decided to put away $X$ ($X \\le 100$) kunas every Monday to his travel fund, $X + K$ kunas every Tuesday, $X + 2\\times K$ every Wednesday, and so on until Sunday, when he will put away $X + 6\\times K$ kunas. This way, he will collect money for 52 weeks, starting with 1 January 2018 (Monday) until 30 December 2018 (Sunday).\n\nIf we know the amount of money $N$, output the values $X$ and $K$ so that it is possible to collect the **exact** money amount in the given timespan. The solution will always exist, and if there are multiple, output the one with the greatest $X$ and smallest $K$.", "inputFormat": "The first line of input contains the integer $N$ ($1456\\le N \\le 145600$), the number from the task.", "outputFormat": "The first line of output must contain the value of $X$ ($0 \\le X \\le 100$), and the second the value of $K$ ($K > 0$).", "hint": null, "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #6] Davor", "background": null, "description": "After successfully conquering the South Pole, Davor is preparing for new challenges. Next up is the Arctic expedition to Siberia, Greenland and Norway. He begins his travels on 31 December 2018, and needs to collect $N$ kunas (Croatian currency) by then. In order to do this, he has decided to put away $X$ ($X \\le 100$) kunas every Monday to his travel fund, $X + K$ kunas every Tuesday, $X + 2\\times K$ every Wednesday, and so on until Sunday, when he will put away $X + 6\\times K$ kunas. This way, he will collect money for 52 weeks, starting with 1 January 2018 (Monday) until 30 December 2018 (Sunday).\n\nIf we know the amount of money $N$, output the values $X$ and $K$ so that it is possible to collect the **exact** money amount in the given timespan. The solution will always exist, and if there are multiple, output the one with the greatest $X$ and smallest $K$.", "inputFormat": "The first line of input contains the integer $N$ ($1456\\le N \\le 145600$), the number from the task.", "outputFormat": "The first line of output must contain the value of $X$ ($0 \\le X \\le 100$), and the second the value of $K$ ($K > 0$).", "hint": null, "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #6] Davor", "background": null, "description": "成功征服南极后，Davor 正在为新的挑战做准备。接下来是前往西伯利亚、格陵兰和挪威的北极探险。他将于 2018 年 12 月 31 日开始旅行，并需要在此之前筹集 $N$ 库纳（克罗地亚货币）。为此，他决定每周一存入 $X(X ≤ 100)$ 库纳到他的旅行基金中，每周二存入 $X + K$ 库纳，每周三存入 $X + 2\\times K$ 库纳，依此类推，直到周日，他将存入 $X + 6\\times K$ 库纳。这样，他将在 52 周内筹集资金，从 2018 年 1 月 1 日（星期一）开始，直到 2018 年 12 月 30 日（星期日）为止。\n\n如果我们知道金额 $N$，输出值 $X$ 和 $K$，以便可以在给定的时间范围内收集到**准确**的金额。解决方案总是存在的，如果有多个，输出 $X$ 最大且 $K$ 最小的那个。", "inputFormat": "输入的第一行包含整数 $N(1456 \\le N \\le 145600)$，这是任务中的数字。", "outputFormat": "输出的第一行必须包含 $X$ 的值 $(0 < X \\le 100)$，第二行包含 $K$ 的值 $(K > 0)$。", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4957", "type": "P", "difficulty": 5, "samples": [["4 2\n1 2\n2\n2 1\n1 2\n3\n2 1\n1 3\n4\n", "4\n1 2 3 4"], ["6 3\n1 4 5\n3\n3 2\n2 3 4\n1 6\n1 3\n4\n1 5 6\n1 1\n6\n2\n", "5\n1 2 4 5 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #6] Alkemija", "background": "", "description": "In ancient times, when alchemists were searching for gold, the world was familiar with a total\nof ​N distinct substances, denoted with 1 to ​N​. During many years of hard work, searching for\nthe secret formula, alchemists discovered a series of interesting regularities - ​alchemical\nreactions\n​. In one reaction, it’s possible to transform substance set {\n$X_1$​,$X_2$​, …, $X_L$​} to another\nsubstance set {$Y_1$​, $Y_2$​, …, ​$Y_R$​}. For example, the substance set {1, 4, 5} might react once and\ncreate the new substance set {2, 6}.\n\nJoško is a modern alchemist and has ​M distinct substances denoted with ​$A_1$​, $A_2$​, …, ​$A_M$​. He\nhas an unlimited quantity of each substance from that set. Joško wants to know which\nsubstances he can create using a list of reactions of ancient alchemists, so he’s asking you\nto help him solve this problem.", "inputFormat": "The first line of input contains two integers N and M (1 ≤ M ≤ N ≤ 100 000), the numbers from the task.\n\nThe second line of input contains M integers $A_i$ (1 ≤ $A_i$ ≤ N), labels of the substances Joško has in the beginning.\n\nThe third line of input contains the integer K (1 ≤ K ≤ 100 000), the number of known\nreactions.\n\nThe following 3·K lines contain a list of reactions. Each reaction is described with 3 lines in the following way:\n\n- The first line contains the integers L and R (1 ≤ L, R ≤ N).\n- The second line contains L distinct integers $X_i$ (1 ≤ $X_i$ ≤ N).\n- The third line contains R distinct integers $Y_i$ (1 ≤ $Y_i$ ≤ N).\n- This describes the reaction with which the substance set {$X_1$, $X_2$, …, $X_L$} transforms into substance set {$Y_1$, $Y_2$, …, $Y_R$}.\n\nThe sum of all L values won’t exceed 100 000.\n\nThe sum of all R values won’t exceed 100 000.", "outputFormat": "The first line of output must contain the integer X, the number of obtainable substances.\n\nThe second line of output must contain X distinct integers $B_i$, sorted ascendingly, that represent the labels of the obtainable substances.\n", "hint": "In test cases worth 60% of total points, it will hold:\n\n- N, K ≤ 500.\n- The sum of all L values and the sum of all R values won’t exceed 500.\n\n**Clarification of the first test case:**\n\nThere are 2 reactions.\n\nThe first reaction transforms substance set {1, 2} into substance set {3}.\n\nThe second reaction transforms substance set {1, 3} into substance set {4}.\n\nJoško initially has substances from the set {1, 2}.\n\nUsing the first reaction, Joško can obtain substance 3, after which he has substances from the set {1, 2, 3}.\n\nAfter that, using the second reaction, he can also obtain substance 4.\n\n**Clarification of the second test case:**\n\nJoško initially has substances from the set {1, 4, 5}.\n\nUsing the second reaction, it is possible to obtain substance 6, after which it is possible to apply the third reaction, giving substance 2.\n\nThe first reaction is impossible to apply because Joško doesn’t have substance 3.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #6] Alkemija", "background": "", "description": "In ancient times, when alchemists were searching for gold, the world was familiar with a total\nof ​N distinct substances, denoted with 1 to ​N​. During many years of hard work, searching for\nthe secret formula, alchemists discovered a series of interesting regularities - ​alchemical\nreactions\n​. In one reaction, it’s possible to transform substance set {\n$X_1$​,$X_2$​, …, $X_L$​} to another\nsubstance set {$Y_1$​, $Y_2$​, …, ​$Y_R$​}. For example, the substance set {1, 4, 5} might react once and\ncreate the new substance set {2, 6}.\n\nJoško is a modern alchemist and has ​M distinct substances denoted with ​$A_1$​, $A_2$​, …, ​$A_M$​. He\nhas an unlimited quantity of each substance from that set. Joško wants to know which\nsubstances he can create using a list of reactions of ancient alchemists, so he’s asking you\nto help him solve this problem.", "inputFormat": "The first line of input contains two integers N and M (1 ≤ M ≤ N ≤ 100 000), the numbers from the task.\n\nThe second line of input contains M integers $A_i$ (1 ≤ $A_i$ ≤ N), labels of the substances Joško has in the beginning.\n\nThe third line of input contains the integer K (1 ≤ K ≤ 100 000), the number of known\nreactions.\n\nThe following 3·K lines contain a list of reactions. Each reaction is described with 3 lines in the following way:\n\n- The first line contains the integers L and R (1 ≤ L, R ≤ N).\n- The second line contains L distinct integers $X_i$ (1 ≤ $X_i$ ≤ N).\n- The third line contains R distinct integers $Y_i$ (1 ≤ $Y_i$ ≤ N).\n- This describes the reaction with which the substance set {$X_1$, $X_2$, …, $X_L$} transforms into substance set {$Y_1$, $Y_2$, …, $Y_R$}.\n\nThe sum of all L values won’t exceed 100 000.\n\nThe sum of all R values won’t exceed 100 000.", "outputFormat": "The first line of output must contain the integer X, the number of obtainable substances.\n\nThe second line of output must contain X distinct integers $B_i$, sorted ascendingly, that represent the labels of the obtainable substances.\n", "hint": "In test cases worth 60% of total points, it will hold:\n\n- N, K ≤ 500.\n- The sum of all L values and the sum of all R values won’t exceed 500.\n\n**Clarification of the first test case:**\n\nThere are 2 reactions.\n\nThe first reaction transforms substance set {1, 2} into substance set {3}.\n\nThe second reaction transforms substance set {1, 3} into substance set {4}.\n\nJoško initially has substances from the set {1, 2}.\n\nUsing the first reaction, Joško can obtain substance 3, after which he has substances from the set {1, 2, 3}.\n\nAfter that, using the second reaction, he can also obtain substance 4.\n\n**Clarification of the second test case:**\n\nJoško initially has substances from the set {1, 4, 5}.\n\nUsing the second reaction, it is possible to obtain substance 6, after which it is possible to apply the third reaction, giving substance 2.\n\nThe first reaction is impossible to apply because Joško doesn’t have substance 3.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #6] Alkemija", "background": "", "description": "在古代，当炼金术士们在寻找黄金时，世界上已知共有 N 种不同的物质，用 1 到 N 表示。经过多年的努力，寻找秘密配方，炼金术士们发现了一系列有趣的规律——炼金反应。在一种反应中，可以将物质集合 $\\{X_1, X_2, \\ldots, X_L\\}$ 转化为另一种物质集合 $\\{Y_1, Y_2, \\ldots, Y_R\\}$。例如，物质集合 $\\{1, 4, 5\\}$ 可能反应一次并生成新的物质集合 $\\{2, 6\\}$。\n\nJoško 是一位现代炼金术士，他拥有 M 种不同的物质，用 $A_1, A_2, \\ldots, A_M$ 表示。他拥有这些物质的无限量。Joško 想知道他可以使用古代炼金术士的反应列表创造出哪些物质，所以他请你帮助他解决这个问题。", "inputFormat": "输入的第一行包含两个整数 N 和 M ($1 \\leq M \\leq N \\leq 100\\,000$)，即题目中的数字。\n\n输入的第二行包含 M 个整数 $A_i$ ($1 \\leq A_i \\leq N$)，表示 Joško 起初拥有的物质的标签。\n\n输入的第三行包含整数 K ($1 \\leq K \\leq 100\\,000$)，即已知反应的数量。\n\n接下来的 $3 \\cdot K$ 行包含反应列表。每个反应由以下 3 行描述：\n\n- 第一行包含整数 L 和 R ($1 \\leq L, R \\leq N$)。\n- 第二行包含 L 个不同的整数 $X_i$ ($1 \\leq X_i \\leq N$)。\n- 第三行包含 R 个不同的整数 $Y_i$ ($1 \\leq Y_i \\leq N$)。\n- 这描述了物质集合 $\\{X_1, X_2, \\ldots, X_L\\}$ 转化为物质集合 $\\{Y_1, Y_2, \\ldots, Y_R\\}$ 的反应。\n\n所有 L 值的总和不会超过 100\\,000。\n\n所有 R 值的总和不会超过 100\\,000。", "outputFormat": "输出的第一行必须包含整数 X，即可以获得的物质数量。\n\n输出的第二行必须包含 X 个不同的整数 $B_i$，按升序排列，表示可以获得的物质的标签。", "hint": "在总分值的 60% 的测试用例中，将满足：\n\n- $N, K \\leq 500$。\n- 所有 L 值的总和和所有 R 值的总和不会超过 500。\n\n**第一个测试用例的说明：**\n\n有 2 个反应。\n\n第一个反应将物质集合 $\\{1, 2\\}$ 转化为物质集合 $\\{3\\}$。\n\n第二个反应将物质集合 $\\{1, 3\\}$ 转化为物质集合 $\\{4\\}$。\n\nJoško 起初拥有物质集合 $\\{1, 2\\}$。\n\n使用第一个反应，Joško 可以获得物质 3，之后他拥有物质集合 $\\{1, 2, 3\\}$。\n\n之后，使用第二个反应，他还可以获得物质 4。\n\n**第二个测试用例的说明：**\n\nJoško 起初拥有物质集合 $\\{1, 4, 5\\}$。\n\n使用第二个反应，可以获得物质 6，之后可以应用第三个反应，得到物质 2。\n\n第一个反应无法应用，因为 Joško 没有物质 3。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4958", "type": "P", "difficulty": 4, "samples": [["banana\n3\n2 na\n3 ba\n4 nn", "3\n0\n1"], ["malimateodmameitate\n3\n10 ot\n7 aa\n3 me", "2\n464\n56"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #6] Mate", "background": "", "description": "Little Mate got an array of lowercase letters from the English alphabet as a present from his\nparents. In order to have at least some use of such a clever present, he decided to use it for\nfinding rhymes when writing his next song.\n\nTo find a specific rhyme, Mate wants to select a word of length D that ends with an array of\ncharacters XY, i.e. where the next to last letter is X, and the last Y. Mate’s process of\nselecting a word is by first crossing out some letters in a given sequence, and then merging\nthe letters he didn’t cross out into a single word. He wants to know in how many different\nways he can cross out the letters so that he meets the given conditions.\n\nThe selection of two words is considered distinct if the sets of positions of the crossed-out\nletters are different.\n", "inputFormat": "The first line of input contains an array of lowercase letters of the English alphabet S (2 ≤ |S|\n≤ 2000).\n\nThe second line of input contains the integer Q (1 ≤ Q ≤ 500 000), the number of different\nrhymes for which Mate needs to select words.\n\nEach of the following Q lines contains the integer D (2 ≤ D ≤ |S|) and an array of lowercase\nletters of the English alphabet XY from the task.", "outputFormat": "The $i^{th}$ out of Q lines must contain the required number of ways for the $i^{th}$ rhyme. Since that number can be quite large, output only the value **modulo 1 000 000 007​**.", "hint": "In test cases worth 40% of total points, it will hold |S| ≤ 50.\n\nIn test cases worth an additional 40% of total points, it will hold |S| ≤ 200.\n\n**Clarification of the first test case:**\n\nWord of length 2 that ends with “na” can be obtained in the following ways:\n\n~~b a n a~~$\\ $**n a**​, ~~b a~~$\\ $**n a**$\\ $~~​n a~~, ~~b a~~$\\ $**n**​ ~~a n~~$\\ $**a**", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #6] Mate", "background": "", "description": "Little Mate got an array of lowercase letters from the English alphabet as a present from his\nparents. In order to have at least some use of such a clever present, he decided to use it for\nfinding rhymes when writing his next song.\n\nTo find a specific rhyme, Mate wants to select a word of length D that ends with an array of\ncharacters XY, i.e. where the next to last letter is X, and the last Y. Mate’s process of\nselecting a word is by first crossing out some letters in a given sequence, and then merging\nthe letters he didn’t cross out into a single word. He wants to know in how many different\nways he can cross out the letters so that he meets the given conditions.\n\nThe selection of two words is considered distinct if the sets of positions of the crossed-out\nletters are different.\n", "inputFormat": "The first line of input contains an array of lowercase letters of the English alphabet S (2 ≤ |S|\n≤ 2000).\n\nThe second line of input contains the integer Q (1 ≤ Q ≤ 500 000), the number of different\nrhymes for which Mate needs to select words.\n\nEach of the following Q lines contains the integer D (2 ≤ D ≤ |S|) and an array of lowercase\nletters of the English alphabet XY from the task.", "outputFormat": "The $i^{th}$ out of Q lines must contain the required number of ways for the $i^{th}$ rhyme. Since that number can be quite large, output only the value **modulo 1 000 000 007​**.", "hint": "In test cases worth 40% of total points, it will hold |S| ≤ 50.\n\nIn test cases worth an additional 40% of total points, it will hold |S| ≤ 200.\n\n**Clarification of the first test case:**\n\nWord of length 2 that ends with “na” can be obtained in the following ways:\n\n~~b a n a~~$\\ $**n a**​, ~~b a~~$\\ $**n a**$\\ $~~​n a~~, ~~b a~~$\\ $**n**​ ~~a n~~$\\ $**a**", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #6] Mate", "background": "", "description": "小 Mate 收到了一个由小写英文字母组成的数组，作为他父母送的礼物。为了让这个聪明的礼物有些用处，他决定在写下一首歌时用它来寻找押韵。\n\n为了找到特定的韵脚，Mate 想要选择一个长度为 D 的单词，该单词以字符数组 XY 结尾，即倒数第二个字母是 X，最后一个字母是 Y。Mate 选择单词的过程是首先划掉给定序列中的一些字母，然后将未划掉的字母合并成一个单词。他想知道有多少种不同的方式可以划掉字母，以满足给定的条件。\n\n如果两个单词的划掉字母的位置集合不同，则认为这两个单词是不同的。", "inputFormat": "输入的第一行包含一个由小写英文字母组成的数组 S (2 ≤ |S| ≤ 2000)。\n\n输入的第二行包含整数 Q (1 ≤ Q ≤ 500 000)，表示 Mate 需要选择单词的不同韵脚的数量。\n\n接下来的 Q 行中的每一行包含一个整数 D (2 ≤ D ≤ |S|) 和一个由小写英文字母组成的字符数组 XY。", "outputFormat": "Q 行中的第 $i$ 行必须包含第 $i$ 个韵脚所需的方式数。由于该数字可能非常大，只输出值对 1 000 000 007 取模后的结果。", "hint": "在占总分 40% 的测试用例中，将满足 |S| ≤ 50。\n\n在额外占总分 40% 的测试用例中，将满足 |S| ≤ 200。\n\n**第一个测试用例的说明：**\n\n以“na”结尾的长度为 2 的单词可以通过以下方式获得：\n\n~~b a n a~~ **n a**，~~b a~~ **n a** ~~n a~~，~~b a~~ **n** ~~a n~~ **a**。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4959", "type": "P", "difficulty": 5, "samples": [["2\n1 1\n-1 -1", "4"], ["3\n-7 19\n9 -30\n25 10\n", "2080"], ["6\n1 20\n3 17\n5 15\n8 12\n9 11\n10 10", "760"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #6] Cover", "background": "", "description": "You are given N points in the coordinate system. They need to be covered with one or more\nrectangles, such that the following conditions are met:\n\n- The sides of each rectangle are parallel with the coordinate axes,\n- The center of each rectangle is in the origin, i.e. point (0, 0),\n- Each given point is located either inside of the rectangle or on its boundaries.\n\nOf course, it is possible to cover all the points using only one rectangle, but this rectangle\ncould have a very large surface area. Our goal is to find a selection of required rectangles\nsuch that the sum of their surface areas is minimal.", "inputFormat": "The first line of input contains the integer N (1 ≤ N ≤ 5000), the number of points.\n\nEach of the following N lines contains two integers X and Y (-50 000 000 ≤ X, Y ≤ 50 000\n000, XY ≠ 0), the coordinates of each point.\n", "outputFormat": "You must output the required minimal sum of surface areas of the rectangles.\n", "hint": "In test cases worth 40% of total points, it will hold N ≤ 20.\n\n**Clarification of the first test case:** ​We choose the rectangle whose opposite angles are the given\npoints, since it meets the conditions from the task.\n\n**Clarification of the second test case:** ​We choose two rectangles with their centers in the origin. The\nfirst is of dimensions 50 x 20 and covers point (25, 10). The second is of dimensions 18 x 60 and covers the first two points. If we wanted to cover all the points using one rectangle, it would be of\ndimensions 50 x 60.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #6] Cover", "background": "", "description": "You are given N points in the coordinate system. They need to be covered with one or more\nrectangles, such that the following conditions are met:\n\n- The sides of each rectangle are parallel with the coordinate axes,\n- The center of each rectangle is in the origin, i.e. point (0, 0),\n- Each given point is located either inside of the rectangle or on its boundaries.\n\nOf course, it is possible to cover all the points using only one rectangle, but this rectangle\ncould have a very large surface area. Our goal is to find a selection of required rectangles\nsuch that the sum of their surface areas is minimal.", "inputFormat": "The first line of input contains the integer N (1 ≤ N ≤ 5000), the number of points.\n\nEach of the following N lines contains two integers X and Y (-50 000 000 ≤ X, Y ≤ 50 000\n000, XY ≠ 0), the coordinates of each point.\n", "outputFormat": "You must output the required minimal sum of surface areas of the rectangles.\n", "hint": "In test cases worth 40% of total points, it will hold N ≤ 20.\n\n**Clarification of the first test case:** ​We choose the rectangle whose opposite angles are the given\npoints, since it meets the conditions from the task.\n\n**Clarification of the second test case:** ​We choose two rectangles with their centers in the origin. The\nfirst is of dimensions 50 x 20 and covers point (25, 10). The second is of dimensions 18 x 60 and covers the first two points. If we wanted to cover all the points using one rectangle, it would be of\ndimensions 50 x 60.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #6] Cover", "background": "", "description": "给定坐标系中的 N 个点。需要用一个或多个矩形覆盖这些点，使得满足以下条件：\n\n- 每个矩形的边平行于坐标轴，\n- 每个矩形的中心在原点，即点 (0, 0)，\n- 每个给定点要么在矩形内部，要么在其边界上。\n\n当然，可以用一个矩形覆盖所有的点，但这个矩形可能会有非常大的面积。我们的目标是找到所需矩形的选择，使得它们的面积总和最小。", "inputFormat": "输入的第一行包含整数 N (1 ≤ N ≤ 5000)，表示点的数量。\n\n接下来的 N 行中的每一行包含两个整数 X 和 Y (-50 000 000 ≤ X, Y ≤ 50 000 000, XY ≠ 0)，表示每个点的坐标。", "outputFormat": "你必须输出所需的矩形面积总和的最小值。", "hint": "在占总分 40% 的测试用例中，将满足 N ≤ 20。\n\n**第一个测试用例的说明：** 我们选择以给定点为对角的矩形，因为它满足题目中的条件。\n\n**第二个测试用例的说明：** 我们选择两个中心在原点的矩形。第一个矩形的尺寸为 50 x 20，覆盖点 (25, 10)。第二个矩形的尺寸为 18 x 60，覆盖前两个点。如果我们想用一个矩形覆盖所有点，它的尺寸将是 50 x 60。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4960", "type": "P", "difficulty": 3, "samples": [["7\n1 2 3 5 4 4 4", "3 2\n1 4\n5 3 1 2 4 5\n1 4"], ["3\n20181110 20181111 20181111", "2 1\n1 20181110\n2 20181111 20181111"], ["3\n20181110 20181111 20181111", "2 2\n2 20181110 20181111\n1 20181111"], ["5\n3 2 3 2 3", "2 1\n3 3 3 3\n2 2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["Special Judge", "枚举", "排序"], "title": "血小板与凝血因子", "background": "为了尽快修复伤口，血小板们正在搬运凝血因子。它们（没毛病）正在讨论怎么分配，因为它们太可爱了，所以就让你来解决这个问题。\n\n![](https://i.loli.net/2018/10/05/5bb7372e781b1.jpg)", "description": "血小板们有两种不同的容器，第一种容器每个容器中只能装同一种凝血因子，第二种容器每个容器中每种凝血因子最多出现一次。为了方便，血小板们想用**同一种**容器装下所有的凝血因子。\n\n换句话说，把 $n$ 个正整数 $a_1$ ~ $a_n$ 分成一些不相交的集合 $S_1$ ~ $S_m$，满足以下两个条件**之一**： \n1. $\\forall a_i,\\ a_j\\in S_k,\\ k\\in [1,\\ m]$ 有 $a_i=a_j$\n2. $\\forall a_i,\\ a_j\\in S_k,\\ k\\in [1,\\ m],\\ i\\neq j$ 有 $a_i\\neq a_j$\n\n因为血小板的数量比较少，所以你要把所有的凝血因子装到尽量少的容器里。它们想知道，如何划分能使容器的总数最小。", "inputFormat": "第一行，一个正整数 $n$，表示凝血因子的个数。\n\n第二行，$n$ 个正整数 $a_i$，分别表示凝血因子的种类。", "outputFormat": "第一行，两个正整数，第一个正整数代表容器数的最小值 $m$，第二个正整数代表所用容器的种类（$1$ 或 $2$）。\n\n接下来的 $m$ 行，每行第一个正整数 $c_i$ 代表这个容器装的凝血因子个数，后面的 $c_i$ 个数代表这个容器中装的每个凝血因子的种类。\n\n输出任意一组合法的最优解即可，输出顺序不限。", "hint": "$1\\le n\\le 1000,\\ \\ 1\\le a_i\\le 10^9$。\n\n## 样例解释\n\n### 样例一：\n\n选用第二种容器，分别放入 $\\{4\\}$，$\\{3,1,2,4,5\\}$，$\\{4\\}$，这是一组可行的最优解，更改三个容器的顺序、容器 $2$ 中 $5$ 个凝血因子的顺序可以得到另外的最优解。\n\n### 样例二/三：\n\n这两组样例输入相同，既可以选用第一种容器，也可以选用第二种容器。\n\n两组样例的输出分别为一组可行的最优解，改变顺序可以得到另外的几组最优解。\n\n### 样例四：\n\n选用第一种容器，分别放入 $\\{3,3,3\\}$，$\\{2,2\\}$，这是一组可行的最优解，更改两个容器的顺序可以得到另一组最优解。", "locale": "zh-CN", "translations": {"en": {"title": "Platelets and Coagulation Factors", "background": "To repair the wound as soon as possible, the platelets are carrying coagulation factors. They (nothing wrong) are discussing how to distribute them. Since they are so cute, you are asked to solve this problem.\n\n![](https://i.loli.net/2018/10/05/5bb7372e781b1.jpg)", "description": "The platelets have two different types of containers. In the first type, each container can hold only one kind of coagulation factor. In the second type, in each container, each kind of coagulation factor can appear at most once. For convenience, the platelets want to use **only one** type of container to hold all coagulation factors.\n\nIn other words, partition $n$ positive integers $a_1$ ~ $a_n$ into some disjoint sets $S_1$ ~ $S_m$, satisfying **one** of the following two conditions:\n1. $\\forall a_i,\\ a_j\\in S_k,\\ k\\in [1,\\ m]$, we have $a_i=a_j$.\n2. $\\forall a_i,\\ a_j\\in S_k,\\ k\\in [1,\\ m],\\ i\\neq j$, we have $a_i\\neq a_j$.\n\nSince there are not many platelets, you need to put all coagulation factors into as few containers as possible. They want to know how to partition them so that the total number of containers is minimized.", "inputFormat": "The first line contains a positive integer $n$, the number of coagulation factors.\n\nThe second line contains $n$ positive integers $a_i$, each representing the type of a coagulation factor.", "outputFormat": "The first line contains two positive integers. The first is the minimum number of containers $m$, and the second is the type of container used ($1$ or $2$).\n\nIn the next $m$ lines, in each line, the first positive integer $c_i$ represents the number of coagulation factors in this container, followed by $c_i$ integers representing the type of each coagulation factor in this container.\n\nOutput any valid optimal solution. The output order does not matter.", "hint": "Constraints: $1\\le n\\le 1000,\\ \\ 1\\le a_i\\le 10^9$。\n\n# Input Format\n\n# Output Format\n\n# Hint\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "血小板与凝血因子", "background": "为了尽快修复伤口，血小板们正在搬运凝血因子。它们（没毛病）正在讨论怎么分配，因为它们太可爱了，所以就让你来解决这个问题。\n\n![](https://i.loli.net/2018/10/05/5bb7372e781b1.jpg)", "description": "血小板们有两种不同的容器，第一种容器每个容器中只能装同一种凝血因子，第二种容器每个容器中每种凝血因子最多出现一次。为了方便，血小板们想用**同一种**容器装下所有的凝血因子。\n\n换句话说，把 $n$ 个正整数 $a_1$ ~ $a_n$ 分成一些不相交的集合 $S_1$ ~ $S_m$，满足以下两个条件**之一**： \n1. $\\forall a_i,\\ a_j\\in S_k,\\ k\\in [1,\\ m]$ 有 $a_i=a_j$\n2. $\\forall a_i,\\ a_j\\in S_k,\\ k\\in [1,\\ m],\\ i\\neq j$ 有 $a_i\\neq a_j$\n\n因为血小板的数量比较少，所以你要把所有的凝血因子装到尽量少的容器里。它们想知道，如何划分能使容器的总数最小。", "inputFormat": "第一行，一个正整数 $n$，表示凝血因子的个数。\n\n第二行，$n$ 个正整数 $a_i$，分别表示凝血因子的种类。", "outputFormat": "第一行，两个正整数，第一个正整数代表容器数的最小值 $m$，第二个正整数代表所用容器的种类（$1$ 或 $2$）。\n\n接下来的 $m$ 行，每行第一个正整数 $c_i$ 代表这个容器装的凝血因子个数，后面的 $c_i$ 个数代表这个容器中装的每个凝血因子的种类。\n\n输出任意一组合法的最优解即可，输出顺序不限。", "hint": "$1\\le n\\le 1000,\\ \\ 1\\le a_i\\le 10^9$。\n\n## 样例解释\n\n### 样例一：\n\n选用第二种容器，分别放入 $\\{4\\}$，$\\{3,1,2,4,5\\}$，$\\{4\\}$，这是一组可行的最优解，更改三个容器的顺序、容器 $2$ 中 $5$ 个凝血因子的顺序可以得到另外的最优解。\n\n### 样例二/三：\n\n这两组样例输入相同，既可以选用第一种容器，也可以选用第二种容器。\n\n两组样例的输出分别为一组可行的最优解，改变顺序可以得到另外的几组最优解。\n\n### 样例四：\n\n选用第一种容器，分别放入 $\\{3,3,3\\}$，$\\{2,2\\}$，这是一组可行的最优解，更改两个容器的顺序可以得到另一组最优解。", "locale": "zh-CN"}}}
{"pid": "P4961", "type": "P", "difficulty": 2, "samples": [["8 8\n0 0 0 1 1 0 0 0 \n1 0 0 1 0 0 0 1 \n1 0 0 1 0 0 0 0 \n0 0 0 0 0 0 0 0 \n0 0 0 0 0 1 0 0 \n0 0 0 0 0 0 0 0 \n0 0 0 0 0 0 0 0 \n0 1 0 0 0 0 0 0 ", "13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "深度优先搜索 DFS"], "title": "小埋与扫雷", "background": "小埋总是在家中打游戏，一天，她突然想玩Windows自带的扫雷，在一旁的哥哥看见了，想起了自己小时候信息课在机房玩扫雷的日子，便兴致勃勃地开始教小埋扫雷。然而，小埋还是不明白 $\\mathrm{3bv}$（Bechtel's Board Benchmark Value，每局将所有非雷的方块点开所需最少左键点击数，参见[扫雷网的教程](http://saolei.net/BBS/Title.asp?Id=227) ）怎么算，于是她找到了你。\n\n![](https://i.loli.net/2018/10/04/5bb5bd6aefb70.jpg)", "description": "小埋会告诉你一盘扫雷，用一个 $n\\times m$ 的矩阵表示，$1$ 是雷 ，$0$ 不是雷，请你告诉她这盘扫雷的 $\\mathrm{3bv}$ 。 \n\n周围八格没有“雷”且自身不是“雷”的方格称为“空格”，周围八格有“雷”且自身不是“雷”的方格称为“数字”，由“空格”组成的八连通块称为一个“空”。$\\mathrm{3bv}=\\ $周围八格没有“空格”的“数字”个数$+$“空\"的个数。\n\n如果看不懂上面的计算方式，可以看题目背景中给出的教程，或者看下面的样例解释。\n\n注：[八连通](https://baike.baidu.com/item/%E5%85%AB%E8%BF%9E%E9%80%9A)", "inputFormat": "第一行有两个整数 $n$ 和 $m$，代表这盘扫雷是一个 $n \\times m$ 的矩阵。\n\n后面的 $n$ 行每行有 $m$ 个整数，表示这个矩阵，每个数字为 $0$ 或 $1$，$1$ 代表是雷，$0$ 代表不是雷。", "outputFormat": "一个整数，代表这盘扫雷的 $\\mathrm{3bv}$ 。", "hint": "$1\\le n,\\ m\\le 1000$\n\n## 样例解释\n\n![](https://i.loli.net/2018/10/04/5bb5bc4644183.jpg)", "locale": "zh-CN", "translations": {"en": {"title": "Umaru and Minesweeper", "background": "Umaru is always playing games at home. One day, she suddenly wanted to play the Minesweeper that comes with Windows. Her older brother saw this and remembered the days when he played Minesweeper in the computer lab during IT class when he was young, so he happily started teaching Umaru how to play. However, Umaru still did not understand how to compute $\\mathrm{3bv}$ (Bechtel's Board Benchmark Value, the minimum number of left clicks needed to open all non-mine cells in one game; see the [tutorial on saolei.net](http://saolei.net/BBS/Title.asp?Id=227)), so she came to you.\n\n![](https://i.loli.net/2018/10/04/5bb5bd6aefb70.jpg)", "description": "Umaru will tell you a Minesweeper board, represented by an $n\\times m$ matrix, where $1$ means a mine and $0$ means not a mine. Please tell her the $\\mathrm{3bv}$ of this board.\n\nA cell that is not a mine and has no mines in the eight surrounding cells is called an \"empty cell\". A cell that is not a mine and has at least one mine in the eight surrounding cells is called a \"number cell\". An 8-connected component consisting of \"empty cells\" is called an \"empty area\". $\\mathrm{3bv}=$ (the number of \"number cells\" that have no \"empty cells\" in their eight surrounding cells) $+$ (the number of \"empty areas\").\n\nIf you cannot understand the computation above, you can read the tutorial given in the Background, or see the sample explanation below.\n\nNote: [8-connectivity](https://baike.baidu.com/item/%E5%85%AB%E8%BF%9E%E9%80%9A)", "inputFormat": "The first line contains two integers $n$ and $m$, meaning the Minesweeper board is an $n \\times m$ matrix.\n\nThe next $n$ lines each contain $m$ integers, describing the matrix. Each number is either $0$ or $1$. $1$ means the cell is a mine, and $0$ means it is not a mine.", "outputFormat": "Output one integer, representing the $\\mathrm{3bv}$ of this Minesweeper board.", "hint": "$1\\le n,\\ m\\le 1000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小埋与扫雷", "background": "小埋总是在家中打游戏，一天，她突然想玩Windows自带的扫雷，在一旁的哥哥看见了，想起了自己小时候信息课在机房玩扫雷的日子，便兴致勃勃地开始教小埋扫雷。然而，小埋还是不明白 $\\mathrm{3bv}$（Bechtel's Board Benchmark Value，每局将所有非雷的方块点开所需最少左键点击数，参见[扫雷网的教程](http://saolei.net/BBS/Title.asp?Id=227) ）怎么算，于是她找到了你。\n\n![](https://i.loli.net/2018/10/04/5bb5bd6aefb70.jpg)", "description": "小埋会告诉你一盘扫雷，用一个 $n\\times m$ 的矩阵表示，$1$ 是雷 ，$0$ 不是雷，请你告诉她这盘扫雷的 $\\mathrm{3bv}$ 。 \n\n周围八格没有“雷”且自身不是“雷”的方格称为“空格”，周围八格有“雷”且自身不是“雷”的方格称为“数字”，由“空格”组成的八连通块称为一个“空”。$\\mathrm{3bv}=\\ $周围八格没有“空格”的“数字”个数$+$“空\"的个数。\n\n如果看不懂上面的计算方式，可以看题目背景中给出的教程，或者看下面的样例解释。\n\n注：[八连通](https://baike.baidu.com/item/%E5%85%AB%E8%BF%9E%E9%80%9A)", "inputFormat": "第一行有两个整数 $n$ 和 $m$，代表这盘扫雷是一个 $n \\times m$ 的矩阵。\n\n后面的 $n$ 行每行有 $m$ 个整数，表示这个矩阵，每个数字为 $0$ 或 $1$，$1$ 代表是雷，$0$ 代表不是雷。", "outputFormat": "一个整数，代表这盘扫雷的 $\\mathrm{3bv}$ 。", "hint": "$1\\le n,\\ m\\le 1000$\n\n## 样例解释\n\n![](https://i.loli.net/2018/10/04/5bb5bc4644183.jpg)", "locale": "zh-CN"}}}
{"pid": "P4962", "type": "P", "difficulty": 6, "samples": [["8 19 3\n1 2 0 1 1 1 2 0\n3 1 4\n3 2 2\n1 4 1\n7 4 10\n5 4 7\n4 2 5\n5 6 4\n4 7 3\n8 5 10\n3 6 8\n8 1 10\n5 2 10\n6 7 3\n4 3 9\n6 2 5\n4 8 10\n3 8 3\n1 7 8\n1 3 9", "11"], ["5 6 3\n0 1 1 2 2\n1 2 3\n2 3 2\n1 4 2\n5 2 1\n1 3 4\n5 4 1", "Ushio!"], ["6 13 3\n2 2 2 1 0 2\n1 4 4\n3 4 8\n5 3 2\n4 5 6\n2 3 2\n1 3 3\n1 2 4\n3 1 4\n6 3 6\n3 2 6\n2 1 6\n4 2 9\n5 2 1", "7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["搜索", "剪枝", "记忆化搜索", "状压 DP"], "title": "朋也与光玉", "background": "> 一つ一つの光は小さくでも、たくさん集まればきっととても不思議な大きな力になるはず。 \n\n渚的离世、汐的离去...朋也的人生几乎陷入了一片黑暗。\n\n但是，这会是结束吗？\n\n![](https://i.loli.net/2018/10/04/5bb5f64297c70.jpg)", "description": "光坂小镇是一个由 $n$ 个点（编号为 $1$ ~ $n$），$m$ 条有向边构成的图，每个节点上都有一个光玉，光玉共有 $k$ 种，编号为 $0$ ~ $k-1$。\n\n为了使一切改变，朋也需要找齐全部的 $k$ 种光玉。他可以从任意一个节点出发，在图上任意行走，但不会经过同一个节点两次，每碰到一个光玉便会将其收集，收集到 $k$ 个光玉后，即经过了 $k$ 个节点后，便不会继续收集。请设计一种方案，使得朋也能够收集全部的 $k$ 种光玉，且走过的路径长度最短。\n\n换句话说，每个点一个颜色，找到一条最短的点数为 $k$ 、恰好经过全部 $k$ 种颜色的路径。你需要求出这条路径的长度。", "inputFormat": "第一行，三个正整数 $n,\\ m,\\ k$，分别代表节点个数、边的条数、光玉的种类数。\n\n第二行，共 $n$ 个正整数 $a_1$ ~ $a_n$，其中 $a_i$ 代表 $i$ 号节点的光玉种类编号。\n\n接下来 $m$ 行，每行三个正整数 $u_i,\\ v_i,\\ w_i$，表示 $u_i$ 到 $v_i$ 有一条长度为 $w_i$ 的有向边。", "outputFormat": "输出一行，若有解则输出一个正整数表示满足条件的最短路径的长度，若无解则输出\"Ushio!\"（不含引号）", "hint": "$2\\le n\\le 100$，$1\\le m\\le n(n-1)$，$2\\le k\\le 13$，$1\\le w_i\\le 10^7$\n\n保证图中没有重边、自环。\n\n## 样例解释\n\n样例一，$3\\rightarrow 6\\rightarrow 7$ 为一组最优解。\n\n样例二，无解。\n\n样例三，最优解为 $4\\rightarrow 5\\rightarrow 2$。", "locale": "zh-CN", "translations": {"en": {"title": "Tomoya and the Light Orbs", "background": "> Even if each light is small, if many gather together, it will surely become a very mysterious and great power.\n\nNagisa’s death, Ushio’s departure... Tomoya’s life has almost fallen into complete darkness.\n\nBut is this the end?\n\n![](https://i.loli.net/2018/10/04/5bb5f64297c70.jpg)", "description": "Hikarizaka Town is a directed graph with $n$ nodes (numbered $1$ to $n$) and $m$ directed edges. Each node has a light orb. There are $k$ types of light orbs, numbered $0$ to $k-1$.\n\nTo change everything, Tomoya needs to collect all $k$ types of light orbs. He may start from any node and walk freely in the graph, but he will not pass through the same node twice. Each time he encounters a light orb, he will collect it. After collecting $k$ light orbs, that is, after visiting $k$ nodes, he will stop collecting. Design a plan so that Tomoya can collect all $k$ types of light orbs, and the total path length is as short as possible.\n\nIn other words, each node has one color. Find a shortest path that visits exactly $k$ nodes and covers all $k$ colors exactly once. You need to output the length of this path.", "inputFormat": "The first line contains three positive integers $n,\\ m,\\ k$, representing the number of nodes, the number of edges, and the number of light orb types.\n\nThe second line contains $n$ positive integers $a_1$ to $a_n$, where $a_i$ is the type index of the light orb on node $i$.\n\nThe next $m$ lines each contain three positive integers $u_i,\\ v_i,\\ w_i$, indicating a directed edge from $u_i$ to $v_i$ with length $w_i$.", "outputFormat": "Output one line. If a solution exists, output a positive integer representing the length of the shortest path that satisfies the condition. If no solution exists, output `Ushio!` (without quotes).", "hint": "Constraints: $2\\le n\\le 100$，$1\\le m\\le n(n-1)$，$2\\le k\\le 13$，$1\\le w_i\\le 10^7$.\n\nIt is guaranteed that the graph has no multiple edges or self-loops.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "朋也与光玉", "background": "> 一つ一つの光は小さくでも、たくさん集まればきっととても不思議な大きな力になるはず。 \n\n渚的离世、汐的离去...朋也的人生几乎陷入了一片黑暗。\n\n但是，这会是结束吗？\n\n![](https://i.loli.net/2018/10/04/5bb5f64297c70.jpg)", "description": "光坂小镇是一个由 $n$ 个点（编号为 $1$ ~ $n$），$m$ 条有向边构成的图，每个节点上都有一个光玉，光玉共有 $k$ 种，编号为 $0$ ~ $k-1$。\n\n为了使一切改变，朋也需要找齐全部的 $k$ 种光玉。他可以从任意一个节点出发，在图上任意行走，但不会经过同一个节点两次，每碰到一个光玉便会将其收集，收集到 $k$ 个光玉后，即经过了 $k$ 个节点后，便不会继续收集。请设计一种方案，使得朋也能够收集全部的 $k$ 种光玉，且走过的路径长度最短。\n\n换句话说，每个点一个颜色，找到一条最短的点数为 $k$ 、恰好经过全部 $k$ 种颜色的路径。你需要求出这条路径的长度。", "inputFormat": "第一行，三个正整数 $n,\\ m,\\ k$，分别代表节点个数、边的条数、光玉的种类数。\n\n第二行，共 $n$ 个正整数 $a_1$ ~ $a_n$，其中 $a_i$ 代表 $i$ 号节点的光玉种类编号。\n\n接下来 $m$ 行，每行三个正整数 $u_i,\\ v_i,\\ w_i$，表示 $u_i$ 到 $v_i$ 有一条长度为 $w_i$ 的有向边。", "outputFormat": "输出一行，若有解则输出一个正整数表示满足条件的最短路径的长度，若无解则输出\"Ushio!\"（不含引号）", "hint": "$2\\le n\\le 100$，$1\\le m\\le n(n-1)$，$2\\le k\\le 13$，$1\\le w_i\\le 10^7$\n\n保证图中没有重边、自环。\n\n## 样例解释\n\n样例一，$3\\rightarrow 6\\rightarrow 7$ 为一组最优解。\n\n样例二，无解。\n\n样例三，最优解为 $4\\rightarrow 5\\rightarrow 2$。", "locale": "zh-CN"}}}
{"pid": "P4963", "type": "P", "difficulty": 6, "samples": [["7 4", "11"], ["15 3", "25"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["动态规划 DP", "数学", "枚举"], "title": "美樱的颜料", "background": "在春辉去美国留学之后，美樱时常感到寂寞。为了排解寂寞，她在画画时总是对颜料有着特殊的要求。\n\n![](https://i.loli.net/2018/10/10/5bbd8d3178ee9.jpg)", "description": "美樱共有 $n$ 种不同的颜料，编号依次为 $1$ ~ $n$，每种颜料只能使用一次。开始画一幅画时，美樱可以任意选择一种颜料使用。之后，美樱每次都会选择一种颜料 $i$ 使用，满足使用颜料 $i$ 后已经使用了的颜料的编号的 $gcd$（最大公约数）尽量大，即：\n\n> 设现在已经使用了的颜料编号构成的集合为 $A$，若$\\ \\exists\\ i,\\ j\\notin A,\\ i,\\ j\\in [1,\\ n],\\ gcd(A,\\ i)>gcd(A,\\ j)$，那么就不能选择颜料 $j$。\n\n如果有多种满足条件的颜料，美樱可以任意选择一种使用。每使用完一种颜料，美樱就会获得当前使用了的所有颜料的编号的 $gcd$ 的快乐值。\n\n现在美樱想画一幅使用 $m$ 种颜料的画，她能够获得的最大快乐值之和是多少？", "inputFormat": "共一行，两个正整数 $n,\\ m$，分别代表颜料的种类数和美樱要使用的颜料数。", "outputFormat": "一个正整数，美樱能获得的最大快乐值。", "hint": "$1\\le m\\le n\\le 10^7$\n\n## 样例解释\n\n样例一：`6 3 5 2`为一组最优解，每次获得的快乐值分别为`6 3 1 1`\n\n样例二：`15 10 5`为一组最优解，每次获得的快乐值分别为`15 5 5`", "locale": "zh-CN", "translations": {"en": {"title": "Miying’s Paints", "background": "After Chunhui went to the United States to study abroad, Miying often felt lonely. To ease her loneliness, she always has special requirements for paints when she draws.\n\n![](https://i.loli.net/2018/10/10/5bbd8d3178ee9.jpg)", "description": "Miying has $n$ different kinds of paints, numbered from $1$ to $n$. Each kind of paint can be used at most once. When she starts a painting, she may choose any one paint to use.\n\nAfter that, each time Miying chooses a paint $i$ to use such that, after using paint $i$, the $gcd$ (greatest common divisor) of the indices of all paints used so far is as large as possible, that is:\n\n> Let the set of indices of paints already used be $A$. If $\\ \\exists\\ i,\\ j\\notin A,\\ i,\\ j\\in [1,\\ n],\\ gcd(A,\\ i)>gcd(A,\\ j)$, then paint $j$ cannot be chosen.\n\nIf there are multiple paints that satisfy the condition, Miying may choose any one of them. After each paint is used, Miying gains a happiness value equal to the $gcd$ of the indices of all paints used so far.\n\nNow Miying wants to draw a painting using $m$ kinds of paints. What is the maximum possible sum of happiness values she can obtain?", "inputFormat": "A single line with two positive integers $n,\\ m$, representing the number of kinds of paints and the number of paints Miying will use.", "outputFormat": "Output one positive integer, the maximum happiness value Miying can obtain.", "hint": "$1\\le m\\le n\\le 10^7$.\n\n# Constraints\n\n# Sample Explanation\n\nSample 1: `6 3 5 2` is an optimal solution. The happiness values obtained each time are `6 3 1 1`.\n\nSample 2: `15 10 5` is an optimal solution. The happiness values obtained each time are `15 5 5`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "美樱的颜料", "background": "在春辉去美国留学之后，美樱时常感到寂寞。为了排解寂寞，她在画画时总是对颜料有着特殊的要求。\n\n![](https://i.loli.net/2018/10/10/5bbd8d3178ee9.jpg)", "description": "美樱共有 $n$ 种不同的颜料，编号依次为 $1$ ~ $n$，每种颜料只能使用一次。开始画一幅画时，美樱可以任意选择一种颜料使用。之后，美樱每次都会选择一种颜料 $i$ 使用，满足使用颜料 $i$ 后已经使用了的颜料的编号的 $gcd$（最大公约数）尽量大，即：\n\n> 设现在已经使用了的颜料编号构成的集合为 $A$，若$\\ \\exists\\ i,\\ j\\notin A,\\ i,\\ j\\in [1,\\ n],\\ gcd(A,\\ i)>gcd(A,\\ j)$，那么就不能选择颜料 $j$。\n\n如果有多种满足条件的颜料，美樱可以任意选择一种使用。每使用完一种颜料，美樱就会获得当前使用了的所有颜料的编号的 $gcd$ 的快乐值。\n\n现在美樱想画一幅使用 $m$ 种颜料的画，她能够获得的最大快乐值之和是多少？", "inputFormat": "共一行，两个正整数 $n,\\ m$，分别代表颜料的种类数和美樱要使用的颜料数。", "outputFormat": "一个正整数，美樱能获得的最大快乐值。", "hint": "$1\\le m\\le n\\le 10^7$\n\n## 样例解释\n\n样例一：`6 3 5 2`为一组最优解，每次获得的快乐值分别为`6 3 1 1`\n\n样例二：`15 10 5`为一组最优解，每次获得的快乐值分别为`15 5 5`", "locale": "zh-CN"}}}
{"pid": "P4964", "type": "P", "difficulty": 6, "samples": [["3 3 2\n19720918 0 1 2 0", "700"], ["10 10 8\n2102036 0 1 4 1\n5 2", "760521825"], ["1000 1000 126\n114321251 1 2 2 0", "91977056"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "枚举", "排序", "深度优先搜索 DFS", "栈"], "title": "绫小路的特别考试", "background": ">  这世界上「胜利」便是一切。无关乎过程。\n要付出多少牺牲都无所谓。只要最后我「胜出」那就行了。\n\n![](https://i.loli.net/2018/10/06/5bb879f4ac370.jpg)", "description": "一场新的特别考试来临了，这次的考试内容是（wan e de）文化课，但有所不同的是，考试中允许学生使用对讲机。然而，对讲机的接收范围是有限的（每个对讲机都能发送无限远，但是只能接收到接收范围内的信号），所以不是所有学生都能接收到其他同学的广播。\n\n考试时，共有 $n$ 名学生坐成一排（从左至右依次编号为 $1$ ~ $n$），绫小路自己坐在第 $c$ 号位置。每名学生都有一个能力值 $w_i$。绫小路已经给每名学生安排了一个接收范围为 $d_i$ 的对讲机。\n\n每名学生可以直接做出难度**不超过**自身能力值的**所有**题目，一旦一名学生凭能力做出某道题，他就会把这道题的做法进行广播。一名坐在位置 $i$，有接收范围为 $d_i$ 的对讲机的学生，可以接收到 $[i-d_i,\\ i+d_i]$ 范围内所有学生的广播，若这个范围内有人公布了做法，则他将会做这道题，并也会把这道题的做法进行广播。\n\n绫小路会问你一些问题：当一道题目难度为 $x$ 时，有多少学生会做这道题？由于绫小路想隐藏实力，他可能会修改自己的能力值。这两种操作分别用以下两种方式表示：\n\n- $1\\ x$，表示询问当一道题目难度为 $x$ 时，有多少学生会做这道题。\n\n- $2\\ x$，将绫小路的能力值修改为 $x$，即将 $w_c$ 修改为 $x$。\n\n---\n\n形式化描述（与上文同义）：\n\n> 给你两个长为 $n$ 的数列 $w_{1..n}$ 和 $d_{1..n}$，以及一个 $w_c$ 可修改的位置 $c$。现在有两种操作（共 $m$ 次）：\n- $1\\ x$ 表示一次询问：设 $f_i=\\begin{cases}1\\quad(w_i\\ge x)\\\\1\\quad(\\exists\\ j \\in [i - d_i,\\ i + d_i],\\ f_j=1)\\\\ 0\\quad(otherwise)\\end{cases}$，这里的 $f_i$ 定义中引用了 $f_j$，$\\ \\ \\ \\ $所以 $f_{1..n}$ 是会不断更新的，直到无法继续更新时，计算这次询问的答案为 $\\sum\\limits_{i=1}^nf_i$。\n- $2\\ x$ 表示一次修改：把 $w_c$ 修改为 $x$。", "inputFormat": "由于数据量太大，为了避免读入耗时过长，使用**伪随机数生成器**的方式输入，并**强制在线**。\n\n**建议你忽略输入格式，直接使用下面提供的数据生成器模板，了解具体的生成过程对你来说是不必要的。**\n\n第一行，三个正整数 $n,\\ m,\\ c$，分别代表学生的总人数，操作总数和绫小路所在的位置。\n\n第二行，五个整数 $\\mathrm{seed},\\ \\mathrm{mind},\\ \\mathrm{maxd},\\ \\mathrm{mfq},\\ k$。\n\n> 此处的 $\\mathrm{mind},\\ \\mathrm{maxd}$ 仅用于生成初始的 $d_{1..n}$，下文中调整 $d_p$ 所用的 $t$ 可能不在 $[\\mathrm{mind},\\ \\mathrm{maxd}]$ 范围内。\n\n接下来的 $k$ 行，每行两个整数 $p,\\ t$，表示调整第 $p$ 号同学的对讲机接收范围（即 $d_p$）为 $t$。\n\n> 若一名同学的对讲机接收范围被调整多次，以**最后一次**为准。\n\n---\n\n** 数据生成器模板：**\n\n```cpp\n#include <cstdio>\n\nunsigned long long seed;\nint n, m, c, mfq, mind, maxd, k, w[2000001], d[2000001];\n\ninline int randInt() { seed = 99999989 * seed + 1000000007; return seed >> 33; } \n\nvoid generate()\n{\n\t// 在读入种子后生成初始的 w 数组和 d 数组.\n    for (int i = 1; i <= n; i++) { w[i] = randInt() % n; }\n    for (int i = 1; i <= n; i++) { d[i] = randInt() % (maxd - mind + 1) + mind; }\n}\n\nvoid getOperation(int lastans, int &opt, int &x)\n{\n    // 生成一次操作的参数 opt 和 x, lastans 表示上一次询问的答案, 初始值为 0.\n    if ((0ll + randInt() + lastans) % mfq) { opt = 1; } else { opt = 2; }\n    x = (0ll + randInt() + lastans) % n;\n}\n\nint main()\n{\n    scanf(\"%d %d %d\", &n, &m, &c);\n    scanf(\"%llu %d %d %d %d\", &seed, &mind, &maxd, &mfq, &k);\n    generate();\n    for (int i = 1; i <= k; i++)\n    {\n        int p, t;\n        scanf(\"%d %d\", &p, &t);\n        d[p] = t;\n    }\n    // 从这里开始，你可以使用生成的 w 数组和 d 数组.\n    int lastans = 0, finalans = 0;\n    for (int i = 1; i <= m; i++)\n    {\n        int opt, x;\n        getOperation(lastans, opt, x);\n        if (opt == 1)\n        {\n            // 在这里执行询问操作，并用答案的表达式替代下面的 ___.      \n            finalans = (finalans * 233ll + ___) % 998244353;\n            lastans = ___;\n        }\n        else\n        {\n            // 在这里执行修改操作.\n        }\n    }\n    printf(\"%d\\n\", finalans);\n    return 0;\n}\n```", "outputFormat": "令 $ans_i$ 表示第 $i$ 次询问（操作 $1$）的答案，$T_i=\\begin{cases}(T_{i-1}\\times 233+ans_i)\\mod 998244353\\quad(i\\ge 1)\\\\0\\quad(i=0)\\end{cases}$\n\n设 $q$ 表示询问（操作 $1$）的个数，你只需要输出一个整数 $T_q$。", "hint": "### 你需要用到的变量：\n\n$1\\le c\\le n\\le 2\\times 10^6$，$1\\le m\\le 2\\times 10^6$，$0\\le w_i,\\ d_i,\\ x<n$。\n\n### 其它用于生成数据的变量：\n\n$1\\le \\mathrm{seed},\\ \\mathrm{mfq}\\le 10^9$，$0\\le \\mathrm{mind}\\le \\mathrm{maxd}<n$，$0\\le k\\le 2\\times 10^5$，$1\\le p\\le n$，$0\\le t<n$。\n\n## 样例解释\n\n### 样例一：\n\n生成得到三名同学的能力值 $w_{1..3} = \\{0,\\ 1,\\ 2\\}$，对讲机接收范围 $d_{1..3} = \\{1,\\ 0,\\ 1\\}$。\n\n第一个操作是 `1 1`，询问有多少同学会做难度为 $1$ 的题。\n\n绫小路（第 $2$ 名同学）和第 $3$ 名同学能够独立做出这道题（$w_2 \\ge 1$ ，$w_3 \\ge 1$），第 $1$ 名同学虽然能力不足，但通过对讲机能接收到绫小路广播的做法（$2 \\in [1 - d_1,\\ 1 + d_1]$），所以他也会做。故 $ans_1 = 3$。\n\n第二个操作是 `2 0`，修改绫小路（第 $2$ 名同学）的能力值为 $0$。此时 $w_{1..3} = \\{0,\\ 0,\\ 2\\}$。\n\n第三个操作是 `1 1`，再次询问有多少同学会做难度为 $1$ 的题。\n\n只有第 $3$ 名同学能够独立做出（$w_3 \\ge 1$），然而第 $1$ 名同学和绫小路（第 $2$ 名同学）都无法接收到他广播的做法（$3 \\notin [1 - d_1,\\ 1 + d_1]$，$3 \\notin [2 - d_2,\\ 2 + d_2]$），做不出来。故 $ans_2 = 1$。\n\n综上所述，$T_1 = ans_1 = 3$，$T_2 = 3 \\times T_1+ ans_2 = 3 \\times 233 + 1 = 700$，仅输出 $700$ 即可。\n\n### 样例二：\n\n生成得到 $w_{1..10} = \\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 7,\\ 9,\\ 5\\}$，$d_{1..10} =\\{1,\\ 1,\\ 1,\\ 1,\\ 2,\\ 0,\\ 1,\\ 0,\\ 1,\\ 1\\}$。\n\n十次操作及对应结果如下所示：\n\n`1 6`，查询操作，$ans_1 = 9$，$T_1 = 9$。\n\n`2 2`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$。\n\n`1 7`，查询操作，$ans_2 = 2$，$T_2 = 2099$。\n\n`1 3`，查询操作，$ans_3 = 9$，$T_3 = 489076$。\n\n`2 4`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 4,\\ 9,\\ 5\\}$。\n\n`1 3`，查询操作，$ans_4 = 10$，$T_4 = 113954718$。\n  \n`2 2`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$。\n  \n`1 9`，查询操作，$ans_5 = 2$，$T_5 = 597096118$。  \n\n`1 0`，查询操作，$ans_6 = 10$，$T_6 = 367430437$。    \n\n`1 3`，查询操作，$ans_7 = 9$，$T_7 = 760521825$。\n\n仅输出 $760521825$ 即可。\n\n### 样例三：\n\n~~出题人有足够的良心写出这个样例的解释，可惜版面太小，写不下。~~", "locale": "zh-CN", "translations": {"en": {"title": "Ayanokoji's Special Exam.", "background": "> In this world, “victory” is everything. The process does not matter.  \nNo matter how many sacrifices it takes. As long as I “win” in the end, that is enough.\n\n![](https://i.loli.net/2018/10/06/5bb879f4ac370.jpg)", "description": "A new special exam is coming. This time the exam content is cultural courses (wan e de), but the difference is that students are allowed to use walkie-talkies during the exam. However, the receiving range of a walkie-talkie is limited (each walkie-talkie can transmit infinitely far, but can only receive signals within its receiving range), so not all students can receive broadcasts from other students.\n\nDuring the exam, there are $n$ students sitting in a row (numbered from left to right as $1$ to $n$). Ayanokoji sits at position $c$. Each student has an ability value $w_i$. Ayanokoji has assigned each student a walkie-talkie with receiving range $d_i$.\n\nEach student can directly solve **all** problems whose difficulty is **not greater than** their own ability value. Once a student solves a problem by their own ability, they will broadcast the solution to that problem. A student sitting at position $i$ with a walkie-talkie of receiving range $d_i$ can receive broadcasts from all students in the range $[i-d_i,\\ i+d_i]$. If someone within this range has published the solution, then they will solve the problem too, and will also broadcast the solution.\n\nAyanokoji will ask you some questions: when a problem has difficulty $x$, how many students will solve it? Since Ayanokoji wants to hide his true strength, he may modify his own ability value. These two types of operations are represented as follows:\n\n- $1\\ x$: query how many students will solve a problem with difficulty $x$.\n- $2\\ x$: modify Ayanokoji's ability value to $x$, i.e., set $w_c$ to $x$.\n\n---\n\nFormal description (equivalent to the above):\n\n> You are given two sequences $w_{1..n}$ and $d_{1..n}$ of length $n$, and a position $c$ where $w_c$ can be modified. There are two types of operations (a total of $m$ times):\n- $1\\ x$ indicates a query: let $f_i=\\begin{cases}1\\quad(w_i\\ge x)\\\\1\\quad(\\exists\\ j \\in [i - d_i,\\ i + d_i],\\ f_j=1)\\\\ 0\\quad(otherwise)\\end{cases}$. Here the definition of $f_i$ refers to $f_j$, so $f_{1..n}$ will keep updating until it can no longer be updated. The answer to this query is $\\sum\\limits_{i=1}^nf_i$.\n- $2\\ x$ indicates a modification: set $w_c$ to $x$.", "inputFormat": "Because the data size is too large, to avoid slow input reading, the input is given using a **pseudorandom number generator** and is **forced online**.\n\n**It is recommended that you ignore the input format and directly use the data generator template provided below. Understanding the specific generation process is not necessary for you.**\n\nThe first line contains three positive integers $n,\\ m,\\ c$, representing the total number of students, the total number of operations, and Ayanokoji's position.\n\nThe second line contains five integers $\\mathrm{seed},\\ \\mathrm{mind},\\ \\mathrm{maxd},\\ \\mathrm{mfq},\\ k$.\n\n> Here $\\mathrm{mind},\\ \\mathrm{maxd}$ are only used to generate the initial $d_{1..n}$. The $t$ used later to adjust $d_p$ may not be within the range $[\\mathrm{mind},\\ \\mathrm{maxd}]$.\n\nIn the next $k$ lines, each line contains two integers $p,\\ t$, indicating that the receiving range of student $p$'s walkie-talkie (i.e., $d_p$) is adjusted to $t$.\n\n> If a student's walkie-talkie receiving range is adjusted multiple times, the **last** adjustment takes effect.\n\n---\n\n**Data generator template:**\n\n```cpp\n#include <cstdio>\n\nunsigned long long seed;\nint n, m, c, mfq, mind, maxd, k, w[2000001], d[2000001];\n\ninline int randInt() { seed = 99999989 * seed + 1000000007; return seed >> 33; } \n\nvoid generate()\n{\n\t// 在读入种子后生成初始的 w 数组和 d 数组.\n    for (int i = 1; i <= n; i++) { w[i] = randInt() % n; }\n    for (int i = 1; i <= n; i++) { d[i] = randInt() % (maxd - mind + 1) + mind; }\n}\n\nvoid getOperation(int lastans, int &opt, int &x)\n{\n    // 生成一次操作的参数 opt 和 x, lastans 表示上一次询问的答案, 初始值为 0.\n    if ((0ll + randInt() + lastans) % mfq) { opt = 1; } else { opt = 2; }\n    x = (0ll + randInt() + lastans) % n;\n}\n\nint main()\n{\n    scanf(\"%d %d %d\", &n, &m, &c);\n    scanf(\"%llu %d %d %d %d\", &seed, &mind, &maxd, &mfq, &k);\n    generate();\n    for (int i = 1; i <= k; i++)\n    {\n        int p, t;\n        scanf(\"%d %d\", &p, &t);\n        d[p] = t;\n    }\n    // 从这里开始，你可以使用生成的 w 数组和 d 数组.\n    int lastans = 0, finalans = 0;\n    for (int i = 1; i <= m; i++)\n    {\n        int opt, x;\n        getOperation(lastans, opt, x);\n        if (opt == 1)\n        {\n            // 在这里执行询问操作，并用答案的表达式替代下面的 ___.      \n            finalans = (finalans * 233ll + ___) % 998244353;\n            lastans = ___;\n        }\n        else\n        {\n            // 在这里执行修改操作.\n        }\n    }\n    printf(\"%d\\n\", finalans);\n    return 0;\n}\n```", "outputFormat": "Let $ans_i$ denote the answer to the $i$-th query (operation $1$), and let $T_i=\\begin{cases}(T_{i-1}\\times 233+ans_i)\\mod 998244353\\quad(i\\ge 1)\\\\0\\quad(i=0)\\end{cases}$.\n\nLet $q$ be the number of queries (operation $1$). You only need to output one integer $T_q$.", "hint": "### Variables you will need:\n\n$1\\le c\\le n\\le 2\\times 10^6$, $1\\le m\\le 2\\times 10^6$, $0\\le w_i,\\ d_i,\\ x<n$.\n\n### Other variables used to generate the testdata:\n\n$1\\le \\mathrm{seed},\\ \\mathrm{mfq}\\le 10^9$, $0\\le \\mathrm{mind}\\le \\mathrm{maxd}<n$, $0\\le k\\le 2\\times 10^5$, $1\\le p\\le n$, $0\\le t<n$.\n\n## Sample Explanation\n\n### Sample 1:\n\nGenerated ability values for the three students are $w_{1..3} = \\{0,\\ 1,\\ 2\\}$, and the walkie-talkie receiving ranges are $d_{1..3} = \\{1,\\ 0,\\ 1\\}$.\n\nThe first operation is `1 1`, asking how many students can solve a problem of difficulty $1$.\n\nAyanokoji (student $2$) and student $3$ can solve it independently ($w_2 \\ge 1$, $w_3 \\ge 1$). Although student $1$ does not have enough ability, he can receive the solution broadcast by Ayanokoji through the walkie-talkie ($2 \\in [1 - d_1,\\ 1 + d_1]$), so he can solve it as well. Therefore $ans_1 = 3$.\n\nThe second operation is `2 0`, modifying Ayanokoji's (student $2$) ability value to $0$. Now $w_{1..3} = \\{0,\\ 0,\\ 2\\}$.\n\nThe third operation is `1 1`, asking again how many students can solve a problem of difficulty $1$.\n\nOnly student $3$ can solve it independently ($w_3 \\ge 1$). However, neither student $1$ nor Ayanokoji (student $2$) can receive his broadcast solution ($3 \\notin [1 - d_1,\\ 1 + d_1]$, $3 \\notin [2 - d_2,\\ 2 + d_2]$), so they cannot solve it. Therefore $ans_2 = 1$.\n\nIn summary, $T_1 = ans_1 = 3$, $T_2 = 3 \\times T_1+ ans_2 = 3 \\times 233 + 1 = 700$. You only need to output $700$.\n\n### Sample 2:\n\nGenerated $w_{1..10} = \\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 7,\\ 9,\\ 5\\}$, $d_{1..10} =\\{1,\\ 1,\\ 1,\\ 1,\\ 2,\\ 0,\\ 1,\\ 0,\\ 1,\\ 1\\}$.\n\nThe ten operations and their corresponding results are as follows:\n\n`1 6`, query, $ans_1 = 9$, $T_1 = 9$.\n\n`2 2`, modification, $w_{1..10}$ becomes $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$.\n\n`1 7`, query, $ans_2 = 2$, $T_2 = 2099$.\n\n`1 3`, query, $ans_3 = 9$, $T_3 = 489076$.\n\n`2 4`, modification, $w_{1..10}$ becomes $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 4,\\ 9,\\ 5\\}$.\n\n`1 3`, query, $ans_4 = 10$, $T_4 = 113954718$.\n\n`2 2`, modification, $w_{1..10}$ becomes $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$.\n\n`1 9`, query, $ans_5 = 2$, $T_5 = 597096118$.\n\n`1 0`, query, $ans_6 = 10$, $T_6 = 367430437$.\n\n`1 3`, query, $ans_7 = 9$, $T_7 = 760521825$.\n\nYou only need to output $760521825$.\n\n### Sample 3:\n\n~~The problem setter had enough conscience to write an explanation for this sample, but unfortunately the space is too small, so it cannot be written down.~~\n\n# Input Format\n\n# Output Format\n\n# Hint\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "绫小路的特别考试", "background": ">  这世界上「胜利」便是一切。无关乎过程。\n要付出多少牺牲都无所谓。只要最后我「胜出」那就行了。\n\n![](https://i.loli.net/2018/10/06/5bb879f4ac370.jpg)", "description": "一场新的特别考试来临了，这次的考试内容是（wan e de）文化课，但有所不同的是，考试中允许学生使用对讲机。然而，对讲机的接收范围是有限的（每个对讲机都能发送无限远，但是只能接收到接收范围内的信号），所以不是所有学生都能接收到其他同学的广播。\n\n考试时，共有 $n$ 名学生坐成一排（从左至右依次编号为 $1$ ~ $n$），绫小路自己坐在第 $c$ 号位置。每名学生都有一个能力值 $w_i$。绫小路已经给每名学生安排了一个接收范围为 $d_i$ 的对讲机。\n\n每名学生可以直接做出难度**不超过**自身能力值的**所有**题目，一旦一名学生凭能力做出某道题，他就会把这道题的做法进行广播。一名坐在位置 $i$，有接收范围为 $d_i$ 的对讲机的学生，可以接收到 $[i-d_i,\\ i+d_i]$ 范围内所有学生的广播，若这个范围内有人公布了做法，则他将会做这道题，并也会把这道题的做法进行广播。\n\n绫小路会问你一些问题：当一道题目难度为 $x$ 时，有多少学生会做这道题？由于绫小路想隐藏实力，他可能会修改自己的能力值。这两种操作分别用以下两种方式表示：\n\n- $1\\ x$，表示询问当一道题目难度为 $x$ 时，有多少学生会做这道题。\n\n- $2\\ x$，将绫小路的能力值修改为 $x$，即将 $w_c$ 修改为 $x$。\n\n---\n\n形式化描述（与上文同义）：\n\n> 给你两个长为 $n$ 的数列 $w_{1..n}$ 和 $d_{1..n}$，以及一个 $w_c$ 可修改的位置 $c$。现在有两种操作（共 $m$ 次）：\n- $1\\ x$ 表示一次询问：设 $f_i=\\begin{cases}1\\quad(w_i\\ge x)\\\\1\\quad(\\exists\\ j \\in [i - d_i,\\ i + d_i],\\ f_j=1)\\\\ 0\\quad(otherwise)\\end{cases}$，这里的 $f_i$ 定义中引用了 $f_j$，$\\ \\ \\ \\ $所以 $f_{1..n}$ 是会不断更新的，直到无法继续更新时，计算这次询问的答案为 $\\sum\\limits_{i=1}^nf_i$。\n- $2\\ x$ 表示一次修改：把 $w_c$ 修改为 $x$。", "inputFormat": "由于数据量太大，为了避免读入耗时过长，使用**伪随机数生成器**的方式输入，并**强制在线**。\n\n**建议你忽略输入格式，直接使用下面提供的数据生成器模板，了解具体的生成过程对你来说是不必要的。**\n\n第一行，三个正整数 $n,\\ m,\\ c$，分别代表学生的总人数，操作总数和绫小路所在的位置。\n\n第二行，五个整数 $\\mathrm{seed},\\ \\mathrm{mind},\\ \\mathrm{maxd},\\ \\mathrm{mfq},\\ k$。\n\n> 此处的 $\\mathrm{mind},\\ \\mathrm{maxd}$ 仅用于生成初始的 $d_{1..n}$，下文中调整 $d_p$ 所用的 $t$ 可能不在 $[\\mathrm{mind},\\ \\mathrm{maxd}]$ 范围内。\n\n接下来的 $k$ 行，每行两个整数 $p,\\ t$，表示调整第 $p$ 号同学的对讲机接收范围（即 $d_p$）为 $t$。\n\n> 若一名同学的对讲机接收范围被调整多次，以**最后一次**为准。\n\n---\n\n** 数据生成器模板：**\n\n```cpp\n#include <cstdio>\n\nunsigned long long seed;\nint n, m, c, mfq, mind, maxd, k, w[2000001], d[2000001];\n\ninline int randInt() { seed = 99999989 * seed + 1000000007; return seed >> 33; } \n\nvoid generate()\n{\n\t// 在读入种子后生成初始的 w 数组和 d 数组.\n    for (int i = 1; i <= n; i++) { w[i] = randInt() % n; }\n    for (int i = 1; i <= n; i++) { d[i] = randInt() % (maxd - mind + 1) + mind; }\n}\n\nvoid getOperation(int lastans, int &opt, int &x)\n{\n    // 生成一次操作的参数 opt 和 x, lastans 表示上一次询问的答案, 初始值为 0.\n    if ((0ll + randInt() + lastans) % mfq) { opt = 1; } else { opt = 2; }\n    x = (0ll + randInt() + lastans) % n;\n}\n\nint main()\n{\n    scanf(\"%d %d %d\", &n, &m, &c);\n    scanf(\"%llu %d %d %d %d\", &seed, &mind, &maxd, &mfq, &k);\n    generate();\n    for (int i = 1; i <= k; i++)\n    {\n        int p, t;\n        scanf(\"%d %d\", &p, &t);\n        d[p] = t;\n    }\n    // 从这里开始，你可以使用生成的 w 数组和 d 数组.\n    int lastans = 0, finalans = 0;\n    for (int i = 1; i <= m; i++)\n    {\n        int opt, x;\n        getOperation(lastans, opt, x);\n        if (opt == 1)\n        {\n            // 在这里执行询问操作，并用答案的表达式替代下面的 ___.      \n            finalans = (finalans * 233ll + ___) % 998244353;\n            lastans = ___;\n        }\n        else\n        {\n            // 在这里执行修改操作.\n        }\n    }\n    printf(\"%d\\n\", finalans);\n    return 0;\n}\n```", "outputFormat": "令 $ans_i$ 表示第 $i$ 次询问（操作 $1$）的答案，$T_i=\\begin{cases}(T_{i-1}\\times 233+ans_i)\\mod 998244353\\quad(i\\ge 1)\\\\0\\quad(i=0)\\end{cases}$\n\n设 $q$ 表示询问（操作 $1$）的个数，你只需要输出一个整数 $T_q$。", "hint": "### 你需要用到的变量：\n\n$1\\le c\\le n\\le 2\\times 10^6$，$1\\le m\\le 2\\times 10^6$，$0\\le w_i,\\ d_i,\\ x<n$。\n\n### 其它用于生成数据的变量：\n\n$1\\le \\mathrm{seed},\\ \\mathrm{mfq}\\le 10^9$，$0\\le \\mathrm{mind}\\le \\mathrm{maxd}<n$，$0\\le k\\le 2\\times 10^5$，$1\\le p\\le n$，$0\\le t<n$。\n\n## 样例解释\n\n### 样例一：\n\n生成得到三名同学的能力值 $w_{1..3} = \\{0,\\ 1,\\ 2\\}$，对讲机接收范围 $d_{1..3} = \\{1,\\ 0,\\ 1\\}$。\n\n第一个操作是 `1 1`，询问有多少同学会做难度为 $1$ 的题。\n\n绫小路（第 $2$ 名同学）和第 $3$ 名同学能够独立做出这道题（$w_2 \\ge 1$ ，$w_3 \\ge 1$），第 $1$ 名同学虽然能力不足，但通过对讲机能接收到绫小路广播的做法（$2 \\in [1 - d_1,\\ 1 + d_1]$），所以他也会做。故 $ans_1 = 3$。\n\n第二个操作是 `2 0`，修改绫小路（第 $2$ 名同学）的能力值为 $0$。此时 $w_{1..3} = \\{0,\\ 0,\\ 2\\}$。\n\n第三个操作是 `1 1`，再次询问有多少同学会做难度为 $1$ 的题。\n\n只有第 $3$ 名同学能够独立做出（$w_3 \\ge 1$），然而第 $1$ 名同学和绫小路（第 $2$ 名同学）都无法接收到他广播的做法（$3 \\notin [1 - d_1,\\ 1 + d_1]$，$3 \\notin [2 - d_2,\\ 2 + d_2]$），做不出来。故 $ans_2 = 1$。\n\n综上所述，$T_1 = ans_1 = 3$，$T_2 = 3 \\times T_1+ ans_2 = 3 \\times 233 + 1 = 700$，仅输出 $700$ 即可。\n\n### 样例二：\n\n生成得到 $w_{1..10} = \\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 7,\\ 9,\\ 5\\}$，$d_{1..10} =\\{1,\\ 1,\\ 1,\\ 1,\\ 2,\\ 0,\\ 1,\\ 0,\\ 1,\\ 1\\}$。\n\n十次操作及对应结果如下所示：\n\n`1 6`，查询操作，$ans_1 = 9$，$T_1 = 9$。\n\n`2 2`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$。\n\n`1 7`，查询操作，$ans_2 = 2$，$T_2 = 2099$。\n\n`1 3`，查询操作，$ans_3 = 9$，$T_3 = 489076$。\n\n`2 4`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 4,\\ 9,\\ 5\\}$。\n\n`1 3`，查询操作，$ans_4 = 10$，$T_4 = 113954718$。\n  \n`2 2`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$。\n  \n`1 9`，查询操作，$ans_5 = 2$，$T_5 = 597096118$。  \n\n`1 0`，查询操作，$ans_6 = 10$，$T_6 = 367430437$。    \n\n`1 3`，查询操作，$ans_7 = 9$，$T_7 = 760521825$。\n\n仅输出 $760521825$ 即可。\n\n### 样例三：\n\n~~出题人有足够的良心写出这个样例的解释，可惜版面太小，写不下。~~", "locale": "zh-CN"}}}
{"pid": "P4965", "type": "P", "difficulty": 6, "samples": [["2 4\nAB\nAuAB", "9"], ["10 5\nAABBAACBAC\nABAAC", "20"], ["1 3\nU\nuUu", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "递推"], "title": "薇尔莉特的打字机", "background": "> 只要客人有意向，不论身在何处，都能上门服务。我是自动手记人偶服务——薇尔莉特·伊芙加登。\n\n![](http://wx3.sinaimg.cn/large/dcec95dfgy1fme08p9eopj20xv0hyq5q.jpg)", "description": "薇尔莉特的打字机用了太久，按键已经开始老化了，因此有时候按键会没有反应。而薇尔莉特总是盲打，因此按键没反应她也不会注意到。一天，她用这台打字机继续完成一封还没写完的信。\n\n现在告诉你这封信已经写好的部分以及薇尔莉特想进行的操作，薇尔莉特想进行的操作有两种：\n1. 在信的末尾输入一个大写字母\n2. 进行一次退格\n\n退格用小写字母 $\\mathrm{u}$ 表示，即删除当前信中的最后一个字符，当然，在信为空时退格没有任何作用。\n\n薇尔莉特会按顺序按下她想按的按键，而每次薇尔莉特按下一个键（输入一个大写字母或进行一次退格），都有可能没有反应（即这次操作无效）。请问，最后打出来的信有多少种可能呢？（空信也算信）\n\n当然薇尔莉特只想知道可能数对 `0x125E591`（十六进制） 取模的结果。", "inputFormat": "第一行两个正整数 $n,\\ m$ 分别表示已经写好的信的长度和薇尔莉特想进行的操作数（字符个数+退格个数）。\n\n第二行一个长度为 $n$ 的字符串表示已经写好的信，保证该串中的每个字符都为大写字母。\n\n第三行一个长度为 $m$ 的字符串表示薇尔莉特想进行的操作，保证该串中的每个字符都为大写字母或 $\\mathrm{u}$。", "outputFormat": "一个整数表示答案对 `0x125E591` 取模的结果。", "hint": "$1\\le n,\\ m\\le 5\\times 10^6$\n\n## 样例解释\n\n样例一：可能的 $9$ 种信为：`A`,`AA`,`AB`,`AAB`,`ABA`,`ABB`,`ABAA`,`ABAB`,`ABAAB`。\n\n样例二：~~太多了，略~~。\n\n样例三：可能的 $3$ 种信为：`空`,`U`,`UU`。", "locale": "zh-CN", "translations": {"en": {"title": "Violet Evergarden's Typewriter.", "background": "> As long as the client has the intention, no matter where they are, I can provide door-to-door service. I am the Auto Memory Doll service—Violet Evergarden.\n\n![](http://wx3.sinaimg.cn/large/dcec95dfgy1fme08p9eopj20xv0hyq5q.jpg)", "description": "Violet's typewriter has been used for too long, and the keys have started to wear out, so sometimes a key press does not respond. Violet always touch-types, so she would not notice when a key press fails. One day, she continues using this typewriter to finish a letter that is not yet complete.\n\nYou are given the already written part of the letter and the operations Violet wants to perform. There are two kinds of operations Violet may want to do:\n1. Type an uppercase letter at the end of the letter.\n2. Perform a backspace.\n\nBackspace is represented by the lowercase letter $\\mathrm{u}$, meaning deleting the last character of the current letter. Of course, if the letter is empty, backspace has no effect.\n\nViolet will press the keys in the order she intends, but each time she presses a key (typing an uppercase letter or performing a backspace), it may fail to respond (i.e., this operation becomes invalid). How many different final letters are possible? (The empty letter also counts as a letter.)\n\nYou only need the result modulo `0x125E591` (hexadecimal).", "inputFormat": "The first line contains two positive integers $n, m$, representing the length of the already written part of the letter and the number of operations Violet wants to perform (number of typed characters + number of backspaces).\n\nThe second line contains a string of length $n$ representing the already written part of the letter. It is guaranteed that every character in the string is an uppercase letter.\n\nThe third line contains a string of length $m$ representing the operations Violet wants to perform. It is guaranteed that every character in the string is either an uppercase letter or $\\mathrm{u}$.", "outputFormat": "Output one integer: the answer modulo `0x125E591`.", "hint": "$1\\le n,\\ m\\le 5\\times 10^6$\n\n# Constraints\n\n# Sample Explanation\n\nSample 1: The $9$ possible letters are: `A`, `AA`, `AB`, `AAB`, `ABA`, `ABB`, `ABAA`, `ABAB`, `ABAAB`.\n\nSample 2: ~~There are too many, omitted~~.\n\nSample 3: The $3$ possible letters are: `empty`, `U`, `UU`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "薇尔莉特的打字机", "background": "> 只要客人有意向，不论身在何处，都能上门服务。我是自动手记人偶服务——薇尔莉特·伊芙加登。\n\n![](http://wx3.sinaimg.cn/large/dcec95dfgy1fme08p9eopj20xv0hyq5q.jpg)", "description": "薇尔莉特的打字机用了太久，按键已经开始老化了，因此有时候按键会没有反应。而薇尔莉特总是盲打，因此按键没反应她也不会注意到。一天，她用这台打字机继续完成一封还没写完的信。\n\n现在告诉你这封信已经写好的部分以及薇尔莉特想进行的操作，薇尔莉特想进行的操作有两种：\n1. 在信的末尾输入一个大写字母\n2. 进行一次退格\n\n退格用小写字母 $\\mathrm{u}$ 表示，即删除当前信中的最后一个字符，当然，在信为空时退格没有任何作用。\n\n薇尔莉特会按顺序按下她想按的按键，而每次薇尔莉特按下一个键（输入一个大写字母或进行一次退格），都有可能没有反应（即这次操作无效）。请问，最后打出来的信有多少种可能呢？（空信也算信）\n\n当然薇尔莉特只想知道可能数对 `0x125E591`（十六进制） 取模的结果。", "inputFormat": "第一行两个正整数 $n,\\ m$ 分别表示已经写好的信的长度和薇尔莉特想进行的操作数（字符个数+退格个数）。\n\n第二行一个长度为 $n$ 的字符串表示已经写好的信，保证该串中的每个字符都为大写字母。\n\n第三行一个长度为 $m$ 的字符串表示薇尔莉特想进行的操作，保证该串中的每个字符都为大写字母或 $\\mathrm{u}$。", "outputFormat": "一个整数表示答案对 `0x125E591` 取模的结果。", "hint": "$1\\le n,\\ m\\le 5\\times 10^6$\n\n## 样例解释\n\n样例一：可能的 $9$ 种信为：`A`,`AA`,`AB`,`AAB`,`ABA`,`ABB`,`ABAA`,`ABAB`,`ABAAB`。\n\n样例二：~~太多了，略~~。\n\n样例三：可能的 $3$ 种信为：`空`,`U`,`UU`。", "locale": "zh-CN"}}}
{"pid": "P4966", "type": "P", "difficulty": 6, "samples": [["3 5 2\n1 2 3 4 5\n", "1\n5\n4\n2\n3\n1\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "Special Judge", "O2优化", "模拟退火", "生成树"], "title": "基地建设", "background": "在茫茫宇宙中……", "description": "有一群生物 ccj，他们发现了一个超星系群。其中有 $n$ 个恒星，$m$ 条双向星际航线，每条星际航线都需要消耗 $val_i$ 的燃料值。两个恒星不属于同一个星系当且仅当他们之间没有任何航线，且没有任何路径可以到达。只有每个恒星才可以为飞船补充燃料。每次航行的路线都是一条简单路径。由于燃料系统过于简陋，每个燃料罐只能用于一次航行。他们的首长 ccj 想在其中一个恒星上建立基地。但是 ccj 花了太多钱购买高速飞船，没有太多钱购买燃料罐，所以他对于两个恒星之间的航行一定选择最经济的航行方式，购买最小的燃料罐。他想问你，在基地要备多少的燃料总量，使得在任意一个恒星上建立基地都能从那个基地分别到达那个星系的其他所有恒星。\n\n但是，这个超星系群发生了战争，一些黑洞改变了这里的空间结构。这群生物只知道每条航线花费的燃料值，找不到连接的两个恒星。但是他们的科学家发现了一个性质：每个战争有一个标志值 $q$，航线有不同的排列方式，对于其中一种排列，第 $i$ 条航线连接着 $((q^{i} \\bmod 2^{32}+i \\times val_i) \\bmod n+n) \\bmod n+1$ 和 $((q^{i} \\bmod 2^{32}-i \\times val_i) \\bmod n+n) \\bmod n+1$ 两个恒星。**运算方式为无符号整型运算**。如果连接的两个恒星一样，说明科学家计算有误，忽略这条航线。ccj 的目标改变了。他想知道对于所有星系的构成情况，最少需要准备多少的燃料总量，使得在这种结构中，在任意一个恒星上建立基地都能分别到达该结构下那个恒星所处星系的其他所有恒星。\n\n你需要输出航线排列顺序。\n", "inputFormat": "第一行三个正整数 $n$，$m$ 和 $q$，表示有 $n$ 个恒星，$m$ 条航线，战争标志值 $q$。\n\n第二行 $m$ 个正整数 $val_i$，表示第 $i$ 条航线消耗 $val_i$ 的燃料值。", "outputFormat": "第一行一个正整数 $ans$，表示 ccj 需要你求的数值。\n\n从第二行到第 $m+1$ 行，每行输出一个整数，第 $i$ 行输出这个排列下的 $val_{i-1}$。", "hint": "**样例解释：**\n\n这 $5$ 条航线分别是：\n\n$2$ 与 $2$ 往返，花费燃料 $5$\n\n$1$ 与 $1$ 往返，花费燃料 $4$\n\n$3$ 与 $3$ 往返，花费燃料 $2$\n\n$2$ 与 $2$ 往返，花费燃料 $3$\n\n$1$ 与 $2$ 往返，花费燃料 $1$\n\n前四条航线被忽略，故有四个恒星系，$\\{1,2\\},\\{3\\},\\{4\\},\\{5\\}$\n\n基地建在 $1$ 时，从 $1$ 到 $2$ 需要购买燃料量为 $1$ 的燃料罐，可以发现，没有其他比这个更优的答案。\n\n$2 \\le n \\le 100\\quad 1 \\le m \\le 40\\quad 0 \\le q \\le 10^9\\quad 0 \\le val_i \\le 1000$\n\n你的答案只需要比std优秀或者和std一样且方案正确即可\n\n1~4数据都为最优答案，5~10数据都为次优答案\n\n~~此题会给出第10个数据的输入~~\n[输入数据](https://www.luogu.org/paste/3xkq6bar)\n\n详细范围参见”标程“\n\n数据均为随机构造，请注意常数！", "locale": "zh-CN", "translations": {"en": {"title": "Base Construction", "background": "In the vast universe...", "description": "There is a group of creatures called ccj who discovered a supercluster. There are $n$ stars and $m$ bidirectional interstellar routes, and traveling along the $i$-th route consumes a fuel cost of $val_i$. Two stars are not in the same galaxy if and only if there is no route between them, and there is no path that can reach one from the other. Only stars can refuel spaceships. Each trip uses a simple path. Because the fuel system is too crude, each fuel tank can only be used for one trip. Their leader ccj wants to build a base on one of the stars. However, ccj spent too much money on high-speed ships and does not have much money to buy fuel tanks, so for any trip between two stars he will always choose the most economical way, buying the smallest possible fuel tank. He wants to ask you: how much total fuel should be prepared for the base, so that no matter which star the base is built on, it can reach all other stars in the same galaxy from that base.\n\nHowever, the supercluster has gone to war, and some black holes changed the spatial structure here. The creatures only know the fuel cost of each route, but cannot find which two stars it connects. Their scientists discovered a property: each war has a marker value $q$. The routes can be arranged in different orders, and for one such arrangement, the $i$-th route connects star $((q^{i} \\bmod 2^{32}+i \\times val_i) \\bmod n+n) \\bmod n+1$ and star $((q^{i} \\bmod 2^{32}-i \\times val_i) \\bmod n+n) \\bmod n+1$. **All operations are performed as unsigned integer operations**. If the two connected stars are the same, it means the scientists made a mistake, and this route should be ignored. ccj’s goal changed. He wants to know: over all possible galaxy structures, what is the minimum total fuel that must be prepared, so that in such a structure, no matter which star the base is built on, it can reach all other stars in the same galaxy (the connected component of that star) under that structure.\n\nYou need to output the route arrangement order.", "inputFormat": "The first line contains three positive integers $n$, $m$, and $q$, meaning there are $n$ stars, $m$ routes, and the war marker value $q$.\n\nThe second line contains $m$ positive integers $val_i$, where $val_i$ is the fuel cost of the $i$-th route.", "outputFormat": "The first line contains one positive integer $ans$, which is the value ccj asks you to compute.\n\nFrom the second line to the $(m+1)$-th line, output one integer per line. On the $i$-th line, output $val_{i-1}$ under this arrangement.", "hint": "**Sample Explanation:**\n\nThese $5$ routes are:\n\nRound trip between $2$ and $2$, fuel cost $5$.\n\nRound trip between $1$ and $1$, fuel cost $4$.\n\nRound trip between $3$ and $3$, fuel cost $2$.\n\nRound trip between $2$ and $2$, fuel cost $3$.\n\nRound trip between $1$ and $2$, fuel cost $1$.\n\nThe first four routes are ignored, so there are four galaxies: $\\{1,2\\},\\{3\\},\\{4\\},\\{5\\}$.\n\nWhen the base is built on $1$, traveling from $1$ to $2$ requires buying a fuel tank of size $1$. It can be seen that there is no better answer than this.\n\nConstraints: $2 \\le n \\le 100\\quad 1 \\le m \\le 40\\quad 0 \\le q \\le 10^9\\quad 0 \\le val_i \\le 1000$.\n\nYour answer only needs to be better than the std, or equal to the std and the construction is correct.\n\nFor testdata $1 \\sim 4$, the optimal answer is required; for testdata $5 \\sim 10$, a suboptimal answer is accepted.\n\n~~This problem will provide the input of testdata 10~~  \n[Input Data](https://www.luogu.org/paste/3xkq6bar)\n\nFor detailed ranges, see “standard solution”.\n\nAll testdata are randomly generated. Please pay attention to constants.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基地建设", "background": "在茫茫宇宙中……", "description": "有一群生物 ccj，他们发现了一个超星系群。其中有 $n$ 个恒星，$m$ 条双向星际航线，每条星际航线都需要消耗 $val_i$ 的燃料值。两个恒星不属于同一个星系当且仅当他们之间没有任何航线，且没有任何路径可以到达。只有每个恒星才可以为飞船补充燃料。每次航行的路线都是一条简单路径。由于燃料系统过于简陋，每个燃料罐只能用于一次航行。他们的首长 ccj 想在其中一个恒星上建立基地。但是 ccj 花了太多钱购买高速飞船，没有太多钱购买燃料罐，所以他对于两个恒星之间的航行一定选择最经济的航行方式，购买最小的燃料罐。他想问你，在基地要备多少的燃料总量，使得在任意一个恒星上建立基地都能从那个基地分别到达那个星系的其他所有恒星。\n\n但是，这个超星系群发生了战争，一些黑洞改变了这里的空间结构。这群生物只知道每条航线花费的燃料值，找不到连接的两个恒星。但是他们的科学家发现了一个性质：每个战争有一个标志值 $q$，航线有不同的排列方式，对于其中一种排列，第 $i$ 条航线连接着 $((q^{i} \\bmod 2^{32}+i \\times val_i) \\bmod n+n) \\bmod n+1$ 和 $((q^{i} \\bmod 2^{32}-i \\times val_i) \\bmod n+n) \\bmod n+1$ 两个恒星。**运算方式为无符号整型运算**。如果连接的两个恒星一样，说明科学家计算有误，忽略这条航线。ccj 的目标改变了。他想知道对于所有星系的构成情况，最少需要准备多少的燃料总量，使得在这种结构中，在任意一个恒星上建立基地都能分别到达该结构下那个恒星所处星系的其他所有恒星。\n\n你需要输出航线排列顺序。\n", "inputFormat": "第一行三个正整数 $n$，$m$ 和 $q$，表示有 $n$ 个恒星，$m$ 条航线，战争标志值 $q$。\n\n第二行 $m$ 个正整数 $val_i$，表示第 $i$ 条航线消耗 $val_i$ 的燃料值。", "outputFormat": "第一行一个正整数 $ans$，表示 ccj 需要你求的数值。\n\n从第二行到第 $m+1$ 行，每行输出一个整数，第 $i$ 行输出这个排列下的 $val_{i-1}$。", "hint": "**样例解释：**\n\n这 $5$ 条航线分别是：\n\n$2$ 与 $2$ 往返，花费燃料 $5$\n\n$1$ 与 $1$ 往返，花费燃料 $4$\n\n$3$ 与 $3$ 往返，花费燃料 $2$\n\n$2$ 与 $2$ 往返，花费燃料 $3$\n\n$1$ 与 $2$ 往返，花费燃料 $1$\n\n前四条航线被忽略，故有四个恒星系，$\\{1,2\\},\\{3\\},\\{4\\},\\{5\\}$\n\n基地建在 $1$ 时，从 $1$ 到 $2$ 需要购买燃料量为 $1$ 的燃料罐，可以发现，没有其他比这个更优的答案。\n\n$2 \\le n \\le 100\\quad 1 \\le m \\le 40\\quad 0 \\le q \\le 10^9\\quad 0 \\le val_i \\le 1000$\n\n你的答案只需要比std优秀或者和std一样且方案正确即可\n\n1~4数据都为最优答案，5~10数据都为次优答案\n\n~~此题会给出第10个数据的输入~~\n[输入数据](https://www.luogu.org/paste/3xkq6bar)\n\n详细范围参见”标程“\n\n数据均为随机构造，请注意常数！", "locale": "zh-CN"}}}
{"pid": "P4967", "type": "P", "difficulty": 6, "samples": [["3\n", "26\n"], ["4\n", "100\n"], ["12", "2137408"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "O2优化", "矩阵加速", "线性递推", "构造"], "title": "黑暗打击", "background": "注，此题和 CQOI 的鼹鼠不一样，请仔细看题！本题只是借用背景！\n\n在茫茫宇宙中……", "description": "有一群生物 ccj，他们在上次的星系中，发现了一群低等生物，于是想进行一波黑暗森林打击。这群低等生物即是 $\\mathsf{Hilbert}$ 鼹鼠，生活在 $\\mathsf{Hilbert}$ 星球，住在 $\\mathsf{Hilbert}$ 曲线土壤内。  \n这群生物决定用最傻的办法——灌水，来淹死他们。现在“高等”生物想知道，对于 $n$ 阶的 $\\mathsf{Hilbert}$ 曲线，从上往下灌水，能淹没几个单位面积？\n\n这是 $1 \\sim 4$ 阶的 $\\mathsf{Hilbert}$ 曲线：  \n\n![](https://cdn.luogu.com.cn/upload/pic/28912.png)\n\n$h_1$，如最左图所示，是一个缺上口的正方形，这个正方形的边长为 $1$。 从$h_2$ 开始，按照以下方法构造曲线 $h_i$： 将 $h_{i-1}$ 复制四份，按 $2\\times2$ 摆放。  \n把左上一份逆时针转 $90^{\\circ }$，右上一份顺时针转 $90^{\\circ }$，然后用三条单位线段将四分曲线按照左上-左下-右下-右上的顺序连接起来。如图所示，分别展示的是 $h_2$，$h_3$，$h_4$。加粗的线段是额外用于连接的线段。\n\n灌水方式：\n\n（显然这个是 $h_3$ 的灌水面积）绿色即为无法被灌到的地方，红色为可以灌到的地方，灰色为墙，所以答案是 $26$，即为样例1。\n\n![](https://cdn.luogu.com.cn/upload/pic/40229.png)\n\n一个方格有水当且仅当在它的上，左，右方格中有至少一个方格有水，最上面一层的空格都有水。\n\n注，此题要求对 $9223372036854775783$ 取模", "inputFormat": "一个整数 $n$，表示这个洞穴是 $n$ 阶的 $\\mathsf{Hilbert}$ 曲线。", "outputFormat": "一个整数 $ans$，表示有 $ans$ 个单位面积被淹没。", "hint": "**样例解释：**\n\n自己数一数嘛……\n\n$n \\le 10^{10000}$\n\n详细范围参见“标程”\n\n数据均为手动构造，请注意常数！", "locale": "zh-CN", "translations": {"en": {"title": "Dark Strike", "background": "Note: This problem is not the same as CQOI’s “Mole”. Please read the problem carefully. This problem only borrows the background.\n\nIn the vast universe...", "description": "There is a group of creatures called ccj. In the last galaxy, they discovered a group of low-level creatures, so they want to launch a “Dark Forest strike”. These low-level creatures are $\\mathsf{Hilbert}$ moles. They live on the $\\mathsf{Hilbert}$ planet and stay inside the soil of the $\\mathsf{Hilbert}$ curve.\n\nThese creatures decide to use the dumbest method—flooding—to drown them. Now the “advanced” creatures want to know: for an $n$-order $\\mathsf{Hilbert}$ curve, if water is poured from top to bottom, how many unit areas can be flooded?\n\nThese are the $\\mathsf{Hilbert}$ curves of order $1 \\sim 4$:\n\n![](https://cdn.luogu.com.cn/upload/pic/28912.png)\n\n$h_1$, as shown in the leftmost figure, is a square missing an opening at the top, and the side length of this square is $1$. Starting from $h_2$, construct the curve $h_i$ in the following way: copy $h_{i-1}$ four times and place them in a $2 \\times 2$ layout. Rotate the top-left copy $90^\\circ$ counterclockwise, rotate the top-right copy $90^\\circ$ clockwise, then use three unit segments to connect the four sub-curves in the order top-left → bottom-left → bottom-right → top-right. As shown in the figures, they are $h_2$, $h_3$, and $h_4$ respectively. The bold segments are the extra segments used for connection.\n\nFlooding rules:\n\n(Obviously, this is the flooded area of $h_3$.) Green areas are places that cannot be reached by water, red areas are places that can be reached by water, and gray areas are walls. So the answer is $26$, which is Sample 1.\n\n![](https://cdn.luogu.com.cn/upload/pic/40229.png)\n\nA cell has water if and only if at least one of the cells above it, to its left, or to its right has water. All empty cells in the topmost row have water.\n\nNote: this problem requires taking modulo $9223372036854775783$.", "inputFormat": "An integer $n$, meaning this cave is an $n$-order $\\mathsf{Hilbert}$ curve.", "outputFormat": "An integer $ans$, meaning there are $ans$ unit areas flooded.", "hint": "**Sample explanation:**\n\nCount it yourself...\n\nConstraints: $n \\le 10^{10000}$.\n\nFor detailed constraints, see the “standard solution”.\n\nAll testdata are manually constructed. Please pay attention to constants.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "黑暗打击", "background": "注，此题和 CQOI 的鼹鼠不一样，请仔细看题！本题只是借用背景！\n\n在茫茫宇宙中……", "description": "有一群生物 ccj，他们在上次的星系中，发现了一群低等生物，于是想进行一波黑暗森林打击。这群低等生物即是 $\\mathsf{Hilbert}$ 鼹鼠，生活在 $\\mathsf{Hilbert}$ 星球，住在 $\\mathsf{Hilbert}$ 曲线土壤内。  \n这群生物决定用最傻的办法——灌水，来淹死他们。现在“高等”生物想知道，对于 $n$ 阶的 $\\mathsf{Hilbert}$ 曲线，从上往下灌水，能淹没几个单位面积？\n\n这是 $1 \\sim 4$ 阶的 $\\mathsf{Hilbert}$ 曲线：  \n\n![](https://cdn.luogu.com.cn/upload/pic/28912.png)\n\n$h_1$，如最左图所示，是一个缺上口的正方形，这个正方形的边长为 $1$。 从$h_2$ 开始，按照以下方法构造曲线 $h_i$： 将 $h_{i-1}$ 复制四份，按 $2\\times2$ 摆放。  \n把左上一份逆时针转 $90^{\\circ }$，右上一份顺时针转 $90^{\\circ }$，然后用三条单位线段将四分曲线按照左上-左下-右下-右上的顺序连接起来。如图所示，分别展示的是 $h_2$，$h_3$，$h_4$。加粗的线段是额外用于连接的线段。\n\n灌水方式：\n\n（显然这个是 $h_3$ 的灌水面积）绿色即为无法被灌到的地方，红色为可以灌到的地方，灰色为墙，所以答案是 $26$，即为样例1。\n\n![](https://cdn.luogu.com.cn/upload/pic/40229.png)\n\n一个方格有水当且仅当在它的上，左，右方格中有至少一个方格有水，最上面一层的空格都有水。\n\n注，此题要求对 $9223372036854775783$ 取模", "inputFormat": "一个整数 $n$，表示这个洞穴是 $n$ 阶的 $\\mathsf{Hilbert}$ 曲线。", "outputFormat": "一个整数 $ans$，表示有 $ans$ 个单位面积被淹没。", "hint": "**样例解释：**\n\n自己数一数嘛……\n\n$n \\le 10^{10000}$\n\n详细范围参见“标程”\n\n数据均为手动构造，请注意常数！", "locale": "zh-CN"}}}
{"pid": "P4968", "type": "P", "difficulty": 6, "samples": [["3 1\n5 2 0\n2 30 17 28\n5 1 1\n2 47 56 -60", "422\n"], ["3 1\n1 1 0\n1 1 1\n1 1 0\n1 1 1", "die"], ["10 3\n23 16 1\n3 25 15 -27 47\n43 38 0\n3 19 35 40 -11\n43 37 0\n3 70 22 8 -28\n41 36 0\n3 86 -8 21 -59\n39 33 1\n3 83 37 -26 56\n18 12 0\n3 3 96 -75 43\n50 43 0\n3 85 -2 47 -36\n48 41 1\n3 36 -4 83 -61\n14 8 1\n3 33 13 35 -24\n", "21071866\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "网络流", "O2优化", "费用流"], "title": "逃生之路", "background": "还在茫茫宇宙中……", "description": "还是这群生物 ccj，因为上次的打击太草率了，同时被他人侦测到了。在得知自己即将受到黑暗森林打击之后，选择逃离自己的家园。\n\n他们的旅程计划在一条线上，其中，我们约定，一号点是他们的家园，有无限多个生物。每一个星球，都可以向之后连续的 $p$ 个星球进行转移。但由于每个星球的”体质“不同，每个星球所能接受的生物数量限定在一个范围 $[b,a]$ 之间。而且，由于星球本身资源匮乏，到达每一个星球都需要消耗星球一定的能源，补充飞船能源。并且又因为宇宙空间的复杂，所以这个能源是关于星球所接受生物数量的一个多项式。飞船年久失修，所以遇到任何星球必定前往去补充能源。\n\n可惜这群生物有一个睿智的头领，他希望最终能有生物到达可以生存的星球，而且消耗的总能源要尽量少。那群生物对这个头领很失望，于是把任务丢给你。\n\n请求出有生物到达可生存星球的情况下，最少的能源消耗是多少？\n", "inputFormat": "第一行两个整数$n$和$p$，表示有$n$个星球（包括他们的家园和目的地），每次向后跳$p$个，保证 $p\\le n-1$。\n\n接下来有 $2\\times n-2$ 行，偶数行有三个数字，$a_i$、$b_i$ 和 $f_i$，$i$ 从 $2$ 开始，表示第 $i$ 个星球能承载的生物数范围和这个星球是否能够生存，$f_i$ 为 $1$ 即能生存，$0$ 即为不能生存。\n\n奇数行先有一个数字 $k$，表示这个多项式是  $k$ 次，接下来 $k+1$ 个整数，表示从高到低每一项的系数 $wi$。", "outputFormat": "一个整数 $ans$ 表示花费最少的能源是多少，如果没有一个生物能到达，输出**\"die\"**（不包括引号）。", "hint": "**样例解释**\n\n样例一中从 $1\\to 2$ 两个ccj，$2\\to 3$ 两个 ccj，$2\\times 2\\times 30+2\\times 17+28+2\\times 2\\times 47+2\\times 56-60=422$\n\n样例二由于没有任何一个星球可以生存，故 die。\n\n$2\\le n\\le 100\\quad |w|\\le 100\\quad 1\\le b\\le a\\le 100\\quad 1\\le k\\le 5\\quad 0\\le p\\le 10$。\n\n保证多项式函数二阶导函数在 $x∈[1,100]$ 时恒大于 $0$。", "locale": "zh-CN", "translations": {"en": {"title": "Escape Route", "background": "Still in the vast universe...", "description": "It is still this group of creatures, ccj. Because the last strike was too hasty, they were detected by others. After learning that they are about to be hit by the Dark Forest strike, they choose to leave their homeland.\n\nTheir trip is planned along a straight line. We define planet $1$ as their homeland, which has infinitely many creatures. From each planet, they can move to the next consecutive $p$ planets. However, due to different “constitutions” of planets, each planet can accept only a number of creatures within the range $[b,a]$. Also, because each planet itself lacks resources, arriving at each planet requires consuming a certain amount of the planet’s energy to replenish the ship’s energy. Because space is complex, this energy cost is a polynomial in the number of creatures accepted by the planet. The ship is old and poorly maintained, so whenever they encounter any planet, they must go to it to replenish energy.\n\nUnfortunately, these creatures have a “wise” leader. He hopes that in the end, there will be creatures that reach a planet where they can survive, and the total energy consumed should be as small as possible. The creatures are very disappointed with this leader, so they throw the task to you.\n\nPlease compute: under the condition that some creatures can reach a survivable planet, what is the minimum total energy consumption?", "inputFormat": "The first line contains two integers $n$ and $p$, meaning there are $n$ planets (including their homeland and the destination). Each move can jump forward up to $p$ planets, and it is guaranteed that $p\\le n-1$.\n\nNext there are $2\\times n-2$ lines.\n\nOn even-numbered lines, there are three numbers $a_i$, $b_i$, and $f_i$, with $i$ starting from $2$, meaning the acceptable range of creature counts on planet $i$ and whether this planet is survivable. If $f_i=1$, it is survivable; if $f_i=0$, it is not.\n\nOn odd-numbered lines, there is first a number $k$, meaning this polynomial is of degree $k$. Then there are $k+1$ integers, giving the coefficients $wi$ of each term from highest degree to lowest degree.", "outputFormat": "Output one integer $ans$, the minimum energy cost. If no creature can reach any survivable planet, output **\"die\"** (without quotes).", "hint": "**Sample explanation**\n\nIn sample 1, move $1\\to 2$ with $2$ ccj, and $2\\to 3$ with $2$ ccj. The cost is $2\\times 2\\times 30+2\\times 17+28+2\\times 2\\times 47+2\\times 56-60=422$.\n\nIn sample 2, since no planet is survivable, output die.\n\nConstraints: $2\\le n\\le 100\\quad |w|\\le 100\\quad 1\\le b\\le a\\le 100\\quad 1\\le k\\le 5\\quad 0\\le p\\le 10$。\n\nIt is guaranteed that the second derivative of the polynomial function is always greater than $0$ when $x∈[1,100]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "逃生之路", "background": "还在茫茫宇宙中……", "description": "还是这群生物 ccj，因为上次的打击太草率了，同时被他人侦测到了。在得知自己即将受到黑暗森林打击之后，选择逃离自己的家园。\n\n他们的旅程计划在一条线上，其中，我们约定，一号点是他们的家园，有无限多个生物。每一个星球，都可以向之后连续的 $p$ 个星球进行转移。但由于每个星球的”体质“不同，每个星球所能接受的生物数量限定在一个范围 $[b,a]$ 之间。而且，由于星球本身资源匮乏，到达每一个星球都需要消耗星球一定的能源，补充飞船能源。并且又因为宇宙空间的复杂，所以这个能源是关于星球所接受生物数量的一个多项式。飞船年久失修，所以遇到任何星球必定前往去补充能源。\n\n可惜这群生物有一个睿智的头领，他希望最终能有生物到达可以生存的星球，而且消耗的总能源要尽量少。那群生物对这个头领很失望，于是把任务丢给你。\n\n请求出有生物到达可生存星球的情况下，最少的能源消耗是多少？\n", "inputFormat": "第一行两个整数$n$和$p$，表示有$n$个星球（包括他们的家园和目的地），每次向后跳$p$个，保证 $p\\le n-1$。\n\n接下来有 $2\\times n-2$ 行，偶数行有三个数字，$a_i$、$b_i$ 和 $f_i$，$i$ 从 $2$ 开始，表示第 $i$ 个星球能承载的生物数范围和这个星球是否能够生存，$f_i$ 为 $1$ 即能生存，$0$ 即为不能生存。\n\n奇数行先有一个数字 $k$，表示这个多项式是  $k$ 次，接下来 $k+1$ 个整数，表示从高到低每一项的系数 $wi$。", "outputFormat": "一个整数 $ans$ 表示花费最少的能源是多少，如果没有一个生物能到达，输出**\"die\"**（不包括引号）。", "hint": "**样例解释**\n\n样例一中从 $1\\to 2$ 两个ccj，$2\\to 3$ 两个 ccj，$2\\times 2\\times 30+2\\times 17+28+2\\times 2\\times 47+2\\times 56-60=422$\n\n样例二由于没有任何一个星球可以生存，故 die。\n\n$2\\le n\\le 100\\quad |w|\\le 100\\quad 1\\le b\\le a\\le 100\\quad 1\\le k\\le 5\\quad 0\\le p\\le 10$。\n\n保证多项式函数二阶导函数在 $x∈[1,100]$ 时恒大于 $0$。", "locale": "zh-CN"}}}
{"pid": "P4969", "type": "P", "difficulty": 5, "samples": [["5 5\n2 3 4 5 9\n5 \nBookCity 1 1\nGuy 2 5\nZero 1 5\ntingtime 5 1\nZero 1 5\n", "1800\n2400"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "树状数组"], "title": "神秘的703", "background": "**出题人：各位 Oier 一定要细心啊啊啊！！！注意看说明**\n\n**出题人：Chen_Xi.Naoh**\n\nZero 和 Mike是一对热爱旅行的好朋友，一天在经历了 ZXG 大神的历练后，心力交瘁，于是决定**重阳节**回宾馆刷题，找回自信，于是，我们的故事开始了……", "description": "Zero 所在宾馆的房间号是 $703$ ，而 Mike 所在宾馆的房间好却是 $704$ ，所以当 Zero 和 Mike 想凑在一起刷题的时候，Zero 需要从 $703$ 前往 $704$ 或者 Mike 从 $704$ 前往 $703$ ，当 Zero 和 Mike 凑在一起时，Mike 便会从[ luogu ](https://www.luogu.com.cn/)上随机选择 $n$ 道题，每一道题分值为 $300$ ，由于 Mike 身经百战，所以每当 Mike 看到某道题目的时候，大脑里面就会自动给该到题目定义一个难度值 $hard$ (要相信 Mike 的判断都是正确的)，而 Zero 和 Mike 两个人都有一个共同的天赋值 $Talent$ ,每个人都只能 AC $Talent$ 范围内难度的题目（即满足 $hard\\le Talent$ 的题目），当然 Zero 和 Mike 的天赋值不会很低；\n\n在 Zero 的房间 $703$ 里面有一位热爱学习的小学弟 BookCity ，在 Zero 和 Mike 刷题的同时，BookCity 会在一旁研究两位学长的做题习惯，并给两位学长加油助威，由于 BookCity 的加油，某道题目的难度就会自动下降 $d$（**若 $hard - d \\le 0$，则默认该题的 $hard$ 为** $1$）；然而，在宾馆的 \n $123$ 号房间住着一个拥有魔法但心地邪恶的人 Guy，能够看到 Zero 和 Mike 的动静，并且能够施展魔法（因为是在**重阳节**），在 Zero 和 Mike 做到某一题的时候，直接将该题的难度 $hard$ 暴增至 $s$ 倍！！！！！幸运的是，Zero 和 Mike 的老师 tingtime 会帮助他们两个，在困境的时候为 Zero 和 Mike 指点迷津，将某一题的难度直接调为一个很低的值 $x$。\n\nZero 和 Mike 每刷完一道题能获得对应分值的自信值（Zero 和 Mike 都是追求完美的人，每一道题要么对，要么干脆不写），现在，你就是 Zero ，你想知道如果和 Mike 从第 $a$ 到题刷到第 $b$ 到题能回复多少自信值 $Confidence$（**自信值计算方法：$Confidence=600\\times$ AC 题目个数 $\\Longrightarrow$ 一道题 $300$ 分，$2$ 个人一共恢复 $600$ 自信值**）。", "inputFormat": "第一行输入两个数，分别表示题目个数 $n$ 和天赋值 $Talent$。  \n\n第二行将输入 $n$ 个数，第 $i$ 个数表示第 $i$ 题的 $hard$ 值。  \n\n第三行，输入一个数表示事件个数 $m$。 \n\n接下来的 $m$ 行中，每行一个字符串 $S$ 和 $2$ 个整数 ，表示一个合题意事件：\n- 若 $S=\\texttt{BookCity}$，则表示这是一个 `BookCity` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $\\max(hard_i-d,1)$；\n- 若 $S=\\texttt{Guy}$，则表示这是一个 `Guy` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $hard_i\\times d$；\n- 若 $S=\\texttt{tingtime}$，则表示这是一个 `tingtime` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $d$；\n- 若 $S=\\texttt{Zero}$，则表示这是一个 `Zero` 事件，接下来两个数 $a,b$ 表示查询从第 $a$ 到题刷到第 $b$ 到题能回复自信值的数量 $Confidence$。\n\n严格保证所有事件按顺序发生。", "outputFormat": "对于每个 `Zero` 事件，输出一行一个数表示该事件的答案 $Confidence$。", "hint": "保证所有题目初始的难度值 $hard$ 在 $ [0,2^{31}-1] $ 范围内；\n\n保证 Zero 和 Mike 的天赋值 $Talent$ 在 $  [0,2^{31}-1] $ 范围内；\n\n保证 Zero 事件中 $a,b$ 的范围都在 $ [0,2^{31}-1] $ 范围内，但不保证 $a$ 一定会小于 $b$；\n\n保证 Guy 事件中 $d$ 的范围都在 $ [0,2^{31}-1] $ 范围内；\n\n保证 BookCity 事件中 $d$ 的范围都在 $ [0,2^{31}-1] $ 范围内；\n\n保证所有的输入数据都在 $  [0,2^{31}-1] $ 范围内；\n\nMike 身经百战，所以其判断的 $hard$ 都在 $  [0,2^{31}-1] $ 范围内，且不存在难度为负数或者为 $0$ 的送分题；\n\n保证 $n$ 和$m$ 都在 $  [0,2^{31}-1] $ 范围内；\n\n对于 $30\\%$ 的数据：$0\\leqslant n \\leqslant 5\\times 10^3$,$m \\leqslant 5\\times 10^3$；\n\n对于 $50\\%$ 的数据：$0\\leqslant n \\leqslant 5\\times 10^4$,$m \\leqslant 5\\times 10^4$；\n\n对于 $100\\%$ 的数据：$0\\leqslant n\\leqslant 5\\times 10^5$，$m\\leqslant 5\\times 10^5$。\n\n\n**总之保证所有输入数据在$ [0,2^{31}-1] $范围内，但不保证运算在$ [0,2^{63}-1] $范围内！！**", "locale": "zh-CN", "translations": {"en": {"title": "Mysterious 703", "background": "**Problem Setter: All OIers must be careful!!! Read the notes carefully.**\n\n**Problem Setter: Chen_Xi.Naoh**\n\nZero and Mike are two good friends who love traveling. One day, after going through the training of the great ZXG, they were exhausted, so they decided to go back to the hotel on the Double Ninth Festival to do problems and regain their confidence. Thus, our story begins.", "description": "Zero’s hotel room number is $703$, and Mike’s hotel room number is $704$. So when Zero and Mike want to get together to do problems, Zero needs to go from $703$ to $704$, or Mike goes from $704$ to $703$. When they are together, Mike will randomly choose $n$ problems from [ luogu ](https://www.luogu.com.cn/). Each problem is worth $300$ points. Since Mike is very experienced, whenever he sees a problem, his brain will automatically assign it a difficulty value $hard$ (trust that Mike’s judgment is always correct). Both Zero and Mike share a common talent value $Talent$. Each person can only AC problems whose difficulty is within $Talent$ (that is, problems satisfying $hard \\le Talent$). Of course, Zero and Mike’s talent value will not be very low.\n\nIn Zero’s room $703$, there is a junior student BookCity who loves studying. While Zero and Mike are doing problems, BookCity will study their habits and cheer for them. Because of BookCity’s cheering, the difficulty of a certain problem will automatically decrease by $d$ (**if $hard - d \\le 0$, then the $hard$ of this problem is set to** $1$ by default). However, in room $123$ of the hotel lives a magical but evil person Guy, who can observe Zero and Mike and cast magic (because it is the Double Ninth Festival). When Zero and Mike are solving a certain problem, he can directly increase that problem’s difficulty $hard$ to $s$ times its original value!!!!! Fortunately, Zero and Mike’s teacher tingtime will help them: in difficult situations, he will guide them and directly set the difficulty of a certain problem to a very low value $x$.\n\nFor each problem they finish, Zero and Mike gain confidence corresponding to its score (they both pursue perfection: each problem is either solved correctly, or not written at all). Now you are Zero. You want to know how much confidence $Confidence$ can be recovered if you and Mike solve problems from problem $a$ to problem $b$ (**confidence calculation: $Confidence = 600 \\times$ number of AC problems $\\Longrightarrow$ one problem is $300$ points, and with $2$ people, they recover $600$ confidence in total**).", "inputFormat": "The first line contains two integers, representing the number of problems $n$ and the talent value $Talent$.\n\nThe second line contains $n$ integers. The $i$-th integer denotes the $hard$ value of problem $i$.\n\nThe third line contains one integer, representing the number of events $m$.\n\nIn the next $m$ lines, each line contains a string $S$ and $2$ integers, describing a valid event:\n- If $S=\\texttt{BookCity}$, it is a `BookCity` event. The next two numbers $i,d$ mean setting the difficulty $hard_i$ of problem $i$ to $\\max(hard_i-d,1)$.\n- If $S=\\texttt{Guy}$, it is a `Guy` event. The next two numbers $i,d$ mean setting the difficulty $hard_i$ of problem $i$ to $hard_i \\times d$.\n- If $S=\\texttt{tingtime}$, it is a `tingtime` event. The next two numbers $i,d$ mean setting the difficulty $hard_i$ of problem $i$ to $d$.\n- If $S=\\texttt{Zero}$, it is a `Zero` event. The next two numbers $a,b$ represent a query: the amount of confidence $Confidence$ recovered by solving problems from problem $a$ to problem $b$.\n\nIt is strictly guaranteed that all events happen in order.", "outputFormat": "For each `Zero` event, output one line with one number: the answer $Confidence$ for that event.", "hint": "Constraints:\n\n- All initial difficulty values $hard$ are in the range $[0,2^{31}-1]$.\n- Zero and Mike’s talent value $Talent$ is in the range $[0,2^{31}-1]$.\n- In `Zero` events, $a,b$ are in the range $[0,2^{31}-1]$, but it is not guaranteed that $a<b$.\n- In `Guy` events, $d$ is in the range $[0,2^{31}-1]$.\n- In `BookCity` events, $d$ is in the range $[0,2^{31}-1]$.\n- All input data are in the range $[0,2^{31}-1]$.\n- Since Mike is very experienced, the $hard$ values he assigns are in the range $[0,2^{31}-1]$, and there are no problems with negative difficulty or difficulty $0$ (free points).\n- Both $n$ and $m$ are in the range $[0,2^{31}-1]$.\n\nFor $30\\%$ of the testdata: $0 \\leqslant n \\leqslant 5\\times 10^3$, $m \\leqslant 5\\times 10^3$.\n\nFor $50\\%$ of the testdata: $0 \\leqslant n \\leqslant 5\\times 10^4$, $m \\leqslant 5\\times 10^4$.\n\nFor $100\\%$ of the testdata: $0 \\leqslant n \\leqslant 5\\times 10^5$, $m \\leqslant 5\\times 10^5$.\n\n**In short, all input data are guaranteed to be in the range $[0,2^{31}-1]$, but intermediate computations are not guaranteed to stay within the range $[0,2^{63}-1]$!!**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "神秘的703", "background": "**出题人：各位 Oier 一定要细心啊啊啊！！！注意看说明**\n\n**出题人：Chen_Xi.Naoh**\n\nZero 和 Mike是一对热爱旅行的好朋友，一天在经历了 ZXG 大神的历练后，心力交瘁，于是决定**重阳节**回宾馆刷题，找回自信，于是，我们的故事开始了……", "description": "Zero 所在宾馆的房间号是 $703$ ，而 Mike 所在宾馆的房间好却是 $704$ ，所以当 Zero 和 Mike 想凑在一起刷题的时候，Zero 需要从 $703$ 前往 $704$ 或者 Mike 从 $704$ 前往 $703$ ，当 Zero 和 Mike 凑在一起时，Mike 便会从[ luogu ](https://www.luogu.com.cn/)上随机选择 $n$ 道题，每一道题分值为 $300$ ，由于 Mike 身经百战，所以每当 Mike 看到某道题目的时候，大脑里面就会自动给该到题目定义一个难度值 $hard$ (要相信 Mike 的判断都是正确的)，而 Zero 和 Mike 两个人都有一个共同的天赋值 $Talent$ ,每个人都只能 AC $Talent$ 范围内难度的题目（即满足 $hard\\le Talent$ 的题目），当然 Zero 和 Mike 的天赋值不会很低；\n\n在 Zero 的房间 $703$ 里面有一位热爱学习的小学弟 BookCity ，在 Zero 和 Mike 刷题的同时，BookCity 会在一旁研究两位学长的做题习惯，并给两位学长加油助威，由于 BookCity 的加油，某道题目的难度就会自动下降 $d$（**若 $hard - d \\le 0$，则默认该题的 $hard$ 为** $1$）；然而，在宾馆的 \n $123$ 号房间住着一个拥有魔法但心地邪恶的人 Guy，能够看到 Zero 和 Mike 的动静，并且能够施展魔法（因为是在**重阳节**），在 Zero 和 Mike 做到某一题的时候，直接将该题的难度 $hard$ 暴增至 $s$ 倍！！！！！幸运的是，Zero 和 Mike 的老师 tingtime 会帮助他们两个，在困境的时候为 Zero 和 Mike 指点迷津，将某一题的难度直接调为一个很低的值 $x$。\n\nZero 和 Mike 每刷完一道题能获得对应分值的自信值（Zero 和 Mike 都是追求完美的人，每一道题要么对，要么干脆不写），现在，你就是 Zero ，你想知道如果和 Mike 从第 $a$ 到题刷到第 $b$ 到题能回复多少自信值 $Confidence$（**自信值计算方法：$Confidence=600\\times$ AC 题目个数 $\\Longrightarrow$ 一道题 $300$ 分，$2$ 个人一共恢复 $600$ 自信值**）。", "inputFormat": "第一行输入两个数，分别表示题目个数 $n$ 和天赋值 $Talent$。  \n\n第二行将输入 $n$ 个数，第 $i$ 个数表示第 $i$ 题的 $hard$ 值。  \n\n第三行，输入一个数表示事件个数 $m$。 \n\n接下来的 $m$ 行中，每行一个字符串 $S$ 和 $2$ 个整数 ，表示一个合题意事件：\n- 若 $S=\\texttt{BookCity}$，则表示这是一个 `BookCity` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $\\max(hard_i-d,1)$；\n- 若 $S=\\texttt{Guy}$，则表示这是一个 `Guy` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $hard_i\\times d$；\n- 若 $S=\\texttt{tingtime}$，则表示这是一个 `tingtime` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $d$；\n- 若 $S=\\texttt{Zero}$，则表示这是一个 `Zero` 事件，接下来两个数 $a,b$ 表示查询从第 $a$ 到题刷到第 $b$ 到题能回复自信值的数量 $Confidence$。\n\n严格保证所有事件按顺序发生。", "outputFormat": "对于每个 `Zero` 事件，输出一行一个数表示该事件的答案 $Confidence$。", "hint": "保证所有题目初始的难度值 $hard$ 在 $ [0,2^{31}-1] $ 范围内；\n\n保证 Zero 和 Mike 的天赋值 $Talent$ 在 $  [0,2^{31}-1] $ 范围内；\n\n保证 Zero 事件中 $a,b$ 的范围都在 $ [0,2^{31}-1] $ 范围内，但不保证 $a$ 一定会小于 $b$；\n\n保证 Guy 事件中 $d$ 的范围都在 $ [0,2^{31}-1] $ 范围内；\n\n保证 BookCity 事件中 $d$ 的范围都在 $ [0,2^{31}-1] $ 范围内；\n\n保证所有的输入数据都在 $  [0,2^{31}-1] $ 范围内；\n\nMike 身经百战，所以其判断的 $hard$ 都在 $  [0,2^{31}-1] $ 范围内，且不存在难度为负数或者为 $0$ 的送分题；\n\n保证 $n$ 和$m$ 都在 $  [0,2^{31}-1] $ 范围内；\n\n对于 $30\\%$ 的数据：$0\\leqslant n \\leqslant 5\\times 10^3$,$m \\leqslant 5\\times 10^3$；\n\n对于 $50\\%$ 的数据：$0\\leqslant n \\leqslant 5\\times 10^4$,$m \\leqslant 5\\times 10^4$；\n\n对于 $100\\%$ 的数据：$0\\leqslant n\\leqslant 5\\times 10^5$，$m\\leqslant 5\\times 10^5$。\n\n\n**总之保证所有输入数据在$ [0,2^{31}-1] $范围内，但不保证运算在$ [0,2^{63}-1] $范围内！！**", "locale": "zh-CN"}}}
{"pid": "P4970", "type": "P", "difficulty": 4, "samples": [["10 10\n1 2 3 4 5 6 7 8 9 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n", "10\n9\n8\n7\n6\n5\n4\n3\n2\n1\nQAQ"], ["10 11\n0 0 0 0 0 0 0 0 0 0\n3 1 10 1\n3 2 10 1\n3 3 10 1\n3 4 10 1\n3 5 10 1\n3 6 10 1\n3 7 10 1\n3 8 10 1\n3 9 10 1\n3 10 10 1\n2 1 10\n", "10\nQAQ"], ["10 13\n0 0 0 0 0 0 0 0 0 0\n1 10 10000\n1 9 9000\n1 8 8000\n1 7 7000\n1 6 6000\n1 5 5000\n1 4 4000\n1 3 3000\n1 2 2000\n1 1 1000\n2 10 10\n2 8 8\n2 8 10\n", "10000\n8000\n9000\nSakura"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "线段树"], "title": "全村最好的嘤嘤刀", "background": "**重阳节**到了，我们最好的八重樱拥有全村最好的嘤嘤刀……", "description": "在绯玉丸力量的影响下，八重村成了一条长度为 $n$ 的八重街，并且绯玉丸可以带着八重樱出现在街上的任意地点。而我们的八重樱则会在街上任意穿梭来获取某一地点上的嘤嘤嘤能量，用以升级她的嘤嘤刀。\n\n**出题人：March_H**\n\n在每个时刻，都会发生以下 $3$ 个事件：\n\n$1$ $x$ $val$ 表示在 $x$ 地点出现了携带着 $val$ 点嘤嘤嘤能量的绯狱丸，并且绯狱丸会吞噬该点的嘤嘤嘤能量，使得该点的嘤嘤嘤能量变为 $ val - a_i$ 点，$a_i$ 为出现绯狱丸的前一刻，该点所存在的嘤嘤嘤能量。\n\n$2$ $l$ $r$ 表示绯玉丸会带着八重樱出现在 $[l,r]$ 间的任意一点。八重樱为了尽快升级她的嘤嘤刀，会获取该区间上最大的嘤嘤嘤能量。特殊的，为了保卫八重村，当 $[l,r]$ 之间存在绯狱丸时，八重樱会优先用她的嘤嘤刀对付绯狱丸，并获得绯狱丸所在点此时拥有的 $a_i$ 点嘤嘤嘤能量。\n\n$3$ $l$ $r$ $val$ 绯玉丸会嘤嘤嘤，使得 $[l,r]$ 上的每一个地点的嘤嘤嘤能量增加 $val$ 点(包括绯狱丸所在点)。", "inputFormat": "第一行为 $2$ 个数 $n$,$m$。\n\n第二行为 $n$ 个数，分别表示八重街上每个地点的初始嘤嘤嘤能量。\n\n接下来 $m$ 行，每行会发生 $3$ 个事件中的一个，输入格式为题目描述中的格式。", "outputFormat": "对于每一个事件 $2$，你应当输出八重樱在该事件中获取的嘤嘤嘤能量并换行。\n\n当所有事件结束时，如果嘤嘤刀积累的能量小于 $10^4$ 你应当输出 ```QAQ```。\n\n如果在 $[10^4,10^7)$ 间，你应当输出 ```Sakura```。\n\n如果都不符合，请输出 ```ice```。", "hint": "对于所有的数据：\n\n最终答案都会在 $[0,2^{31}-1]$ 范围内；\n\n$1\\le n,m \\le 10^5$。\n\n值得注意的是，无论八重樱是获取了某一地点的嘤嘤嘤能量还是击败了某一地点的绯狱丸，该地点的嘤嘤嘤值都应当清零而不是保留原来的数值。\n\n对于事件 $2$ ，题目保证每个事件中最多出现 $1$ 只绯狱丸。如果出现多个最大值，在每次比较时，请选择靠右的(std默认的)。", "locale": "zh-CN", "translations": {"en": {"title": "The Best “Yingying Blade” in the Whole Village", "background": "The Double Ninth Festival is coming, and our best Yae Sakura has the best “yingying blade” in the whole village.", "description": "Under the influence of Higokumaru’s power, Yae Village becomes a Yae Street of length $n$, and Higokumaru can bring Yae Sakura to appear at any position on the street. Yae Sakura can move freely on the street to obtain the “yingyingying” energy at some position, in order to upgrade her “yingying blade”.\n\n**Problem setter: March_H**\n\nAt each moment, the following $3$ types of events may happen:\n\n$1$ $x$ $val$ means that a Higokumaru carrying $val$ points of “yingyingying” energy appears at position $x$, and it will devour the “yingyingying” energy at that position, making the energy at that position become $val - a_i$, where $a_i$ is the amount of “yingyingying” energy at that position at the moment right before Higokumaru appears.\n\n$2$ $l$ $r$ means that Higokumaru will bring Yae Sakura to appear at any position within $[l, r]$. In order to upgrade her “yingying blade” as fast as possible, Yae Sakura will obtain the maximum “yingyingying” energy in this interval. Specially, in order to protect Yae Village, when there exists a Higokumaru between $l$ and $r$, Yae Sakura will prioritize using her “yingying blade” to deal with Higokumaru, and obtain $a_i$ points of “yingyingying” energy that the position where Higokumaru is located currently has.\n\n$3$ $l$ $r$ $val$ means that Higokumaru will “yingyingying”, causing the “yingyingying” energy at every position in $[l, r]$ to increase by $val$ points (including the position where Higokumaru is located).", "inputFormat": "The first line contains $2$ integers $n$ and $m$.\n\nThe second line contains $n$ integers, representing the initial “yingyingying” energy at each position on Yae Street.\n\nThe next $m$ lines each describe one of the $3$ events, with the input format as specified in the description.", "outputFormat": "For each event of type $2$, output the amount of “yingyingying” energy obtained by Yae Sakura in that event, followed by a newline.\n\nAfter all events end, if the energy accumulated in the “yingying blade” is less than $10000$, output $QAQ$.\n\nIf it is in $[10000, 10000000)$, output $Sakura$.\n\nIf neither condition is satisfied, output $ice$.", "hint": "For all testdata:\n\nThe final answer will be within $[0, 2^{31}-1]$.\n\n$n$ and $m$ $\\leqslant$ $100000$.\n\nNote that whether Yae Sakura obtains the “yingyingying” energy at a position or defeats the Higokumaru at a position, the “yingyingying” value at that position should be cleared to $0$ instead of keeping the original value.\n\nFor event $2$, the problem guarantees that at most $1$ Higokumaru appears in each event. If there are multiple maximum values, when comparing each time, choose the rightmost one (the default behavior of std).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "全村最好的嘤嘤刀", "background": "**重阳节**到了，我们最好的八重樱拥有全村最好的嘤嘤刀……", "description": "在绯玉丸力量的影响下，八重村成了一条长度为 $n$ 的八重街，并且绯玉丸可以带着八重樱出现在街上的任意地点。而我们的八重樱则会在街上任意穿梭来获取某一地点上的嘤嘤嘤能量，用以升级她的嘤嘤刀。\n\n**出题人：March_H**\n\n在每个时刻，都会发生以下 $3$ 个事件：\n\n$1$ $x$ $val$ 表示在 $x$ 地点出现了携带着 $val$ 点嘤嘤嘤能量的绯狱丸，并且绯狱丸会吞噬该点的嘤嘤嘤能量，使得该点的嘤嘤嘤能量变为 $ val - a_i$ 点，$a_i$ 为出现绯狱丸的前一刻，该点所存在的嘤嘤嘤能量。\n\n$2$ $l$ $r$ 表示绯玉丸会带着八重樱出现在 $[l,r]$ 间的任意一点。八重樱为了尽快升级她的嘤嘤刀，会获取该区间上最大的嘤嘤嘤能量。特殊的，为了保卫八重村，当 $[l,r]$ 之间存在绯狱丸时，八重樱会优先用她的嘤嘤刀对付绯狱丸，并获得绯狱丸所在点此时拥有的 $a_i$ 点嘤嘤嘤能量。\n\n$3$ $l$ $r$ $val$ 绯玉丸会嘤嘤嘤，使得 $[l,r]$ 上的每一个地点的嘤嘤嘤能量增加 $val$ 点(包括绯狱丸所在点)。", "inputFormat": "第一行为 $2$ 个数 $n$,$m$。\n\n第二行为 $n$ 个数，分别表示八重街上每个地点的初始嘤嘤嘤能量。\n\n接下来 $m$ 行，每行会发生 $3$ 个事件中的一个，输入格式为题目描述中的格式。", "outputFormat": "对于每一个事件 $2$，你应当输出八重樱在该事件中获取的嘤嘤嘤能量并换行。\n\n当所有事件结束时，如果嘤嘤刀积累的能量小于 $10^4$ 你应当输出 ```QAQ```。\n\n如果在 $[10^4,10^7)$ 间，你应当输出 ```Sakura```。\n\n如果都不符合，请输出 ```ice```。", "hint": "对于所有的数据：\n\n最终答案都会在 $[0,2^{31}-1]$ 范围内；\n\n$1\\le n,m \\le 10^5$。\n\n值得注意的是，无论八重樱是获取了某一地点的嘤嘤嘤能量还是击败了某一地点的绯狱丸，该地点的嘤嘤嘤值都应当清零而不是保留原来的数值。\n\n对于事件 $2$ ，题目保证每个事件中最多出现 $1$ 只绯狱丸。如果出现多个最大值，在每次比较时，请选择靠右的(std默认的)。", "locale": "zh-CN"}}}
{"pid": "P4971", "type": "P", "difficulty": 6, "samples": [["1 1 10\n5 2\n1 2 3 4 5\n2 3\n4 2 4", "Heaven 10"], ["2 2 8\n5 4\n4 8 7 5 6\n4 2 4\n2 2\n4 2 3\n3 3 2\n3 2\n5 1 2\n2 2\n3 3 2", "Hell 9\nGensokyo 0"], ["2 1 15\n5 4\n1 2 3 4 5\n4 2 3\n3 2 100\n4 1 4\n4 4 1\n5 4\n1 2 3 4 5\n3 2 15\n4 2 3\n4 1 4\n4 3 4", "Heaven 11\nHeaven 9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["并查集", "优先队列", "可并堆"], "title": "断罪者", "background": "**重阳节**的地狱……\n\n四季映姬·亚玛萨那度（以下简称四季大人）是地狱的最高裁判长，她平时负责给死者定罪，判断让死者去地狱还是天界，或者别的什么地方。\n\n四季大人当然可以轻松地给死者断罪，但是死者太多了，四季大人需要你帮她断罪，以便腾出时间让她对别人进行说教。", "description": "人们的罪恶值$E$由人们**生前所做过的事**和他的**死亡方式**来决定。他们做过的**坏事**都会有一个罪恶值，这些坏事有可能会并入同一个集合，一个集合的罪恶值为该集合中罪恶值最大的坏事的罪恶值，而他们一生做过的事会**互相影响**，我们将他们生前做过的事分为4种，而最后的罪恶值$E$由其中**所有集合的罪恶值的和**决定。\n\n1. 做坏事——有罪恶值，单独为一集合。  \n2. 做好事——将一件坏事的罪恶值清零。\n3. 忏悔——将指定集合中，最大罪恶值的事罪恶值减少。\n4. 认清自己——将两个坏事集合合并。\n\n而死亡方式可分为 *自然死亡* 、*事故死亡* 和 *自杀* 。\n\n1. 自然死亡，没什么影响。\n2. 事故死亡，可以免除最大罪恶的坏事集合。\n3. 自杀，最大的坏事集合罪恶值翻倍。\n", "inputFormat": "第一行三个输入 $T,W,K$，代表有 $T$ 个人等待断罪，$W$ 为死亡方式，与描述序号对应，$K$ 含义见输出格式。\n\n接下来的 $T$ 组数据，每组数据第一行两个输入 $n,m$，代表他做过的坏事数量和其他事的数量。\n\n第二行 $n$ 个输入，代表每件坏事的罪恶值。\n\n第 $3$ 到第 $m+2$ 行，每行有三种输入可能。（请联系题目描述进行理解）\n\n- $\\verb!2 A!$：表示做好事，将坏事 $A$ 罪恶值**清零**。\n- $\\verb!3 A B!$：表示忏悔，指定集合为 $A$ 所在的集合，最大罪恶值的事减少 $B$，若最大罪恶值比 $B$ 小，则最大罪恶值的事罪恶值**清零**。**对于罪恶值相等的坏事，认为编号更小的更坏**。\n- $\\verb!4 A B!$： 表示认清自己，将 $B$ 所在集合与 $A$ 所在的集合合并。", "outputFormat": "对于每一个人，一行输出一个字符串和一个整数。\n\n若他的罪恶值为 $0$ 则输出 `Gensokyo`，若他的罪恶值大于 $K$ 则输出 `Hell`，否则输出 `Heaven`。再输出它的罪恶值。\n", "hint": "### 样例 1 解释\n\n一开始有五件坏事，罪恶值分别为 $1.2.3.4.5$，做好事之后，罪恶值分别为 $1.2.0.4.5$，认清自我后，只剩下四个集合，罪恶值分别是 $1.4.0.5$，由于是自然死亡，所以最后的罪恶值 $E=1+4+5=10 \\le K \\&\\& E!=0$，因此输出 $Heaven$\n\n### 样例 2 解释\n\n对于样例2的第一组输入如下图，黑色椭圆代表一个集合，红色为罪恶值，下面为点的编号，由于是事故死亡，可以免去标号5的最大值，故罪恶值为$E=4+5$  \n![](https://cdn.luogu.com.cn/upload/pic/72405.png)\n\n### 说明\n\n所有数据均在长整型范围内，对于所有数据，均有$m\\le n$,$1\\le K$，保证输入不存在负数。  \n由于读入数据可能会很大，建议使用较快的读入。\n\n> 约定 ① 对于合并两个集合的操作，至少有一个集合只有一件坏事；\n> 约定 ② 这群人不会做好事。\n\n| 测试点编号 |    T    |      n       |  时限  | 约定 |\n|:-:|:-:|:-:|:-:|:-:|\n|\t\t  1   | $\\le10$ |   $\\le100$   | $1s$ | ①② |\n|\t\t  2   | $\\le10$ |   $\\le300$   | $1s$ | ①  |\n|\t\t  3   | $\\le10$ |   $\\le500$   | $1s$ |    |\n|\t\t  4   | $\\le20$ |  $\\le1000$   | $1s$ | ①② |\n|\t\t  5   | $\\le20$ |  $\\le3000$   | $1s$ | ①  |\n|\t\t  6   | $\\le20$ |  $\\le7000$   | $1s$ |    |\n|\t\t  7   | $\\le30$ |  $\\le10000$  | $1s$ | ①② |\n|\t\t  8   | $\\le30$ |  $\\le30000$  | $1s$ | ①  |\n|\t\t  9   | $\\le30$ |  $\\le50000$  | $1s$ |    |\n|\t\t 10   | $\\le30$ |  $\\le70000$  | $1s$ | ①② |\n|\t\t 11   | $\\le10$ | $\\le100000$  | $1s$ | ①  |\n|\t\t 12   | $\\le10$ | $\\le150000$  | $1s$ |    |\n|\t\t 13   | $\\le10$ | $\\le200000$  | $1s$ | ①② |\n|\t\t 14   | $\\le10$ | $\\le500000$  | $1s$ | ①  |\n|\t\t 15   | $\\le10$ | $\\le1000000$ | $2s$ |    |\n|\t\t 16   | $\\le10$ | $\\le1000000$ | $2s$ | ①② |\n|\t\t 17   | $\\le10$ | $\\le1000000$ | $2s$ | ①  |\n|\t\t 18   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 19   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 20   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 21   | $1$ | $\\le2000000$ | $2s$ |  路径压缩  |\n\n", "locale": "zh-CN", "translations": {"en": {"title": "Judge of Sin", "background": "Hell on the Double Ninth Festival……\n\nShikieiki Yamaxanadu (hereinafter referred to as Lady Shiki) is the Chief Judge of Hell. She is usually responsible for judging the dead, deciding whether they go to Hell, Heaven, or somewhere else.\n\nOf course, Lady Shiki can easily judge the dead, but there are too many dead people. She needs your help to judge them, so that she can spare time to preach to others.", "description": "A person’s sin value $E$ is determined by **what they did while alive** and their **cause of death**. Every **bad deed** has a sin value. Bad deeds may be merged into the same set. The sin value of a set is the maximum sin value among the bad deeds in that set. The things a person did in their life **affect each other**. We classify what they did while alive into 4 types, and the final sin value $E$ is determined by the **sum of the sin values of all sets**.\n\n1. Do a bad deed: has a sin value, and forms its own set.\n2. Do a good deed: sets the sin value of one bad deed to zero.\n3. Repent: for a specified set, decrease the bad deed with the maximum sin value by some amount.\n4. Know yourself: merge two sets of bad deeds.\n\nThe cause of death can be *natural death*, *accidental death*, or *suicide*.\n\n1. Natural death: no effect.\n2. Accidental death: the set with the maximum sin value can be forgiven (removed).\n3. Suicide: the maximum set’s sin value is doubled.", "inputFormat": "The first line contains three integers $T, W, K$, where there are $T$ people to be judged, $W$ is the cause of death (corresponding to the numbering in the description), and $K$ is defined in the output format.\n\nThe next $T$ groups of data describe each person. In each group, the first line contains two integers $n, m$, representing the number of bad deeds and the number of other actions.\n\nThe second line contains $n$ integers, representing the sin value of each bad deed.\n\nLines $3$ to $m + 2$ each contain one of the following three types of inputs. (Please refer to the description to understand them.)\n\n- $\\verb!2 A!$: do a good deed, setting the sin value of bad deed $A$ to **zero**.\n- $\\verb!3 A B!$: repent. The specified set is the set containing $A$. Decrease the bad deed with the maximum sin value in that set by $B$. If the maximum sin value is smaller than $B$, then set that bad deed’s sin value to **zero**. **If multiple bad deeds have the same sin value, the one with the smaller index is considered worse**.\n- $\\verb!4 A B!$: know yourself, merging the set containing $B$ into the set containing $A$.", "outputFormat": "For each person, output one string and one integer on one line.\n\nIf their sin value is $0$, output `Gensokyo`. If their sin value is greater than $K$, output `Hell`. Otherwise, output `Heaven`. Then output their sin value.", "hint": "### Sample 1 Explanation\n\nAt the beginning there are five bad deeds, with sin values $1.2.3.4.5$. After doing a good deed, the sin values become $1.2.0.4.5$. After knowing oneself, only four sets remain, with sin values $1.4.0.5$. Since it is natural death, the final sin value is $E=1+4+5=10 \\le K \\&\\& E!=0$, so output $Heaven$.\n\n### Sample 2 Explanation\n\nFor the first test case of Sample 2, it is shown in the figure below. Black ovals represent sets, red numbers are sin values, and the numbers below are node indices. Since it is accidental death, the maximum set with index $5$ can be forgiven, so the sin value is $E=4+5$.  \n![](https://cdn.luogu.com.cn/upload/pic/72405.png)\n\n### Notes\n\nAll data fit in 64-bit signed integers. For all testdata, $m\\le n$, $1\\le K$, and the input contains no negative numbers.  \nSince the input may be very large, faster input methods are recommended.\n\n> Convention ①: For the operation of merging two sets, at least one set contains only one bad deed.  \n> Convention ②: These people will not do good deeds.\n\n| Test Point ID |    T    |      n       | Time Limit | Conventions |\n|:-:|:-:|:-:|:-:|:-:|\n| 1 | $\\le10$ | $\\le100$ | $1s$ | ①② |\n| 2 | $\\le10$ | $\\le300$ | $1s$ | ① |\n| 3 | $\\le10$ | $\\le500$ | $1s$ |  |\n| 4 | $\\le20$ | $\\le1000$ | $1s$ | ①② |\n| 5 | $\\le20$ | $\\le3000$ | $1s$ | ① |\n| 6 | $\\le20$ | $\\le7000$ | $1s$ |  |\n| 7 | $\\le30$ | $\\le10000$ | $1s$ | ①② |\n| 8 | $\\le30$ | $\\le30000$ | $1s$ | ① |\n| 9 | $\\le30$ | $\\le50000$ | $1s$ |  |\n| 10 | $\\le30$ | $\\le70000$ | $1s$ | ①② |\n| 11 | $\\le10$ | $\\le100000$ | $1s$ | ① |\n| 12 | $\\le10$ | $\\le150000$ | $1s$ |  |\n| 13 | $\\le10$ | $\\le200000$ | $1s$ | ①② |\n| 14 | $\\le10$ | $\\le500000$ | $1s$ | ① |\n| 15 | $\\le10$ | $\\le1000000$ | $2s$ |  |\n| 16 | $\\le10$ | $\\le1000000$ | $2s$ | ①② |\n| 17 | $\\le10$ | $\\le1000000$ | $2s$ | ① |\n| 18 | $\\le10$ | $\\le2000000$ | $2s$ |  |\n| 19 | $\\le10$ | $\\le2000000$ | $2s$ |  |\n| 20 | $\\le10$ | $\\le2000000$ | $2s$ |  |\n| 21 | $1$ | $\\le2000000$ | $2s$ | Path Compression |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "断罪者", "background": "**重阳节**的地狱……\n\n四季映姬·亚玛萨那度（以下简称四季大人）是地狱的最高裁判长，她平时负责给死者定罪，判断让死者去地狱还是天界，或者别的什么地方。\n\n四季大人当然可以轻松地给死者断罪，但是死者太多了，四季大人需要你帮她断罪，以便腾出时间让她对别人进行说教。", "description": "人们的罪恶值$E$由人们**生前所做过的事**和他的**死亡方式**来决定。他们做过的**坏事**都会有一个罪恶值，这些坏事有可能会并入同一个集合，一个集合的罪恶值为该集合中罪恶值最大的坏事的罪恶值，而他们一生做过的事会**互相影响**，我们将他们生前做过的事分为4种，而最后的罪恶值$E$由其中**所有集合的罪恶值的和**决定。\n\n1. 做坏事——有罪恶值，单独为一集合。  \n2. 做好事——将一件坏事的罪恶值清零。\n3. 忏悔——将指定集合中，最大罪恶值的事罪恶值减少。\n4. 认清自己——将两个坏事集合合并。\n\n而死亡方式可分为 *自然死亡* 、*事故死亡* 和 *自杀* 。\n\n1. 自然死亡，没什么影响。\n2. 事故死亡，可以免除最大罪恶的坏事集合。\n3. 自杀，最大的坏事集合罪恶值翻倍。\n", "inputFormat": "第一行三个输入 $T,W,K$，代表有 $T$ 个人等待断罪，$W$ 为死亡方式，与描述序号对应，$K$ 含义见输出格式。\n\n接下来的 $T$ 组数据，每组数据第一行两个输入 $n,m$，代表他做过的坏事数量和其他事的数量。\n\n第二行 $n$ 个输入，代表每件坏事的罪恶值。\n\n第 $3$ 到第 $m+2$ 行，每行有三种输入可能。（请联系题目描述进行理解）\n\n- $\\verb!2 A!$：表示做好事，将坏事 $A$ 罪恶值**清零**。\n- $\\verb!3 A B!$：表示忏悔，指定集合为 $A$ 所在的集合，最大罪恶值的事减少 $B$，若最大罪恶值比 $B$ 小，则最大罪恶值的事罪恶值**清零**。**对于罪恶值相等的坏事，认为编号更小的更坏**。\n- $\\verb!4 A B!$： 表示认清自己，将 $B$ 所在集合与 $A$ 所在的集合合并。", "outputFormat": "对于每一个人，一行输出一个字符串和一个整数。\n\n若他的罪恶值为 $0$ 则输出 `Gensokyo`，若他的罪恶值大于 $K$ 则输出 `Hell`，否则输出 `Heaven`。再输出它的罪恶值。\n", "hint": "### 样例 1 解释\n\n一开始有五件坏事，罪恶值分别为 $1.2.3.4.5$，做好事之后，罪恶值分别为 $1.2.0.4.5$，认清自我后，只剩下四个集合，罪恶值分别是 $1.4.0.5$，由于是自然死亡，所以最后的罪恶值 $E=1+4+5=10 \\le K \\&\\& E!=0$，因此输出 $Heaven$\n\n### 样例 2 解释\n\n对于样例2的第一组输入如下图，黑色椭圆代表一个集合，红色为罪恶值，下面为点的编号，由于是事故死亡，可以免去标号5的最大值，故罪恶值为$E=4+5$  \n![](https://cdn.luogu.com.cn/upload/pic/72405.png)\n\n### 说明\n\n所有数据均在长整型范围内，对于所有数据，均有$m\\le n$,$1\\le K$，保证输入不存在负数。  \n由于读入数据可能会很大，建议使用较快的读入。\n\n> 约定 ① 对于合并两个集合的操作，至少有一个集合只有一件坏事；\n> 约定 ② 这群人不会做好事。\n\n| 测试点编号 |    T    |      n       |  时限  | 约定 |\n|:-:|:-:|:-:|:-:|:-:|\n|\t\t  1   | $\\le10$ |   $\\le100$   | $1s$ | ①② |\n|\t\t  2   | $\\le10$ |   $\\le300$   | $1s$ | ①  |\n|\t\t  3   | $\\le10$ |   $\\le500$   | $1s$ |    |\n|\t\t  4   | $\\le20$ |  $\\le1000$   | $1s$ | ①② |\n|\t\t  5   | $\\le20$ |  $\\le3000$   | $1s$ | ①  |\n|\t\t  6   | $\\le20$ |  $\\le7000$   | $1s$ |    |\n|\t\t  7   | $\\le30$ |  $\\le10000$  | $1s$ | ①② |\n|\t\t  8   | $\\le30$ |  $\\le30000$  | $1s$ | ①  |\n|\t\t  9   | $\\le30$ |  $\\le50000$  | $1s$ |    |\n|\t\t 10   | $\\le30$ |  $\\le70000$  | $1s$ | ①② |\n|\t\t 11   | $\\le10$ | $\\le100000$  | $1s$ | ①  |\n|\t\t 12   | $\\le10$ | $\\le150000$  | $1s$ |    |\n|\t\t 13   | $\\le10$ | $\\le200000$  | $1s$ | ①② |\n|\t\t 14   | $\\le10$ | $\\le500000$  | $1s$ | ①  |\n|\t\t 15   | $\\le10$ | $\\le1000000$ | $2s$ |    |\n|\t\t 16   | $\\le10$ | $\\le1000000$ | $2s$ | ①② |\n|\t\t 17   | $\\le10$ | $\\le1000000$ | $2s$ | ①  |\n|\t\t 18   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 19   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 20   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 21   | $1$ | $\\le2000000$ | $2s$ |  路径压缩  |\n\n", "locale": "zh-CN"}}}
{"pid": "P4973", "type": "P", "difficulty": 5, "samples": [["1\n1 11", "1"], ["1\n2 a45", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学"], "title": "毒瘤之神奇进制", "background": "hsl2363 正在造计算机。", "description": "hsl2363 发现计算机非常好玩，他打算自己造一台，造好之后 zrz_orz 来了，hsl2363 告诉他：\n\n“我的计算机是‘**$X$-\\* 进制**’的，我很想知道你到底有多菜，所以问问你这几个数换算成十进制之后是多少。”\n\n“**$X$-\\* 进制**”表示的数字可以由 ASCII 可见字符（不包括 ASCII 代码小于等于 $48$ 的字符）组成。令“**$X$-\\* 进制**”$s$ 长度为 $n$，位数从右到左为 $0$ 到 $n - 1$，则它表示这个数第 $i$ 位的 ASCII 代码减去 `0` 的 ASCII 代码（即 $48$），再乘以 $X$ 的 $i$ 次方的总乘积。也就是说，\n\n$$s=\\prod \\limits_{i=0} \\limits^{n-1} (X^i\\cdot (f(s_i)-f('0')))$$\n\n其中 $f('x')$ 表示字符 `x` 的 ASCII 代码值。\n\n下面是一个例子：\n\n若 $X=3$，$s=$`2363`，\n\n则有\n\n$\\begin{aligned}\n\ts&= f('2') \\times 3^3 \\times f('3') \\times 3 ^ 2 \\times f('6') \\times 3 ^ 1 \\times f('3') \\times 3 ^ 0 \\\\\n\t&= 2 \\times 3^3 \\times 3 \\times 3 ^ 2 \\times 6 \\times 3 ^ 1 \\times 3 \\times 3 ^ 0\\\\\n  &= 78732\n\\end{aligned}\n$\n\nzrz_orz 觉得太难了，把问题抛给了你。现在有 $Q$ 个用“$X$-\\* 进制”表示的数字（不同数字的 $X$ 可能不同），你需要求出它们的十进制表示。\n\n因为答案可能很大，请输出答案的长度。", "inputFormat": "第一行一个整数 $Q$。\n\n接下来 $Q$ 行，第 $i$ 行一个整数 $X_i$ 和一个字符串 $s_i$，表示第 $i$ 个数字为“$X_i$-\\* 进制”，在该进制下的表示为 $s_i$。", "outputFormat": "共 $Q$ 行。\n\n第 $i$ 行一个整数，代表第 $i$ 个数字在十进制表示下的长度。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1 \\le Q \\le 100, 1\\le X_i=|s_i|-1 \\le 10^5$。\n\nASCII 可见字符（不包括 ASCII 代码小于等于 $48$ 的字符）包含以下字符（按 ASCII 代码升序排序）：\n\n```text\n123456789:;<=>?\n@ABCDEFGHIJKLMNO\nPQRSTUVWXYZ[\\]^_\n`abcdefghijklmno\npqrstuvwxyz{|}~\n```\n\n**【提示】**\n\n如果想要暴力，没有高精度是不可能的。", "locale": "zh-CN", "translations": {"en": {"title": "Magic Base of the “Poison Tumor”", "background": "hsl2363 is building a computer.", "description": "hsl2363 found computers very fun, so he plans to build one himself. After he finishes it, zrz_orz comes. hsl2363 tells him:\n\n“My computer uses the ‘**$X$-\\* base**’. I really want to know how weak you are, so I’m asking you what these numbers become after converting to decimal.”\n\nA number written in “**$X$-\\* base**” can be made of ASCII visible characters (excluding characters whose ASCII code is $\\le 48$). Let an “**$X$-\\* base**” string $s$ have length $n$, with digit positions numbered from right to left as $0$ to $n - 1$. The value it represents is the product over all positions: take the ASCII code of the character at position $i$, subtract the ASCII code of `0` (i.e., $48$), and multiply by $X^i$, then multiply all these terms together. That is,\n\n$$s=\\prod \\limits_{i=0} \\limits^{n-1} (X^i\\cdot (f(s_i)-f('0')))$$\n\nwhere $f('x')$ denotes the ASCII code value of character `x`.\n\nHere is an example:\n\nIf $X=3$ and $s=$`2363`,\n\nthen\n\n$\\begin{aligned}\n\ts&= f('2') \\times 3^3 \\times f('3') \\times 3 ^ 2 \\times f('6') \\times 3 ^ 1 \\times f('3') \\times 3 ^ 0 \\\\\n\t&= 2 \\times 3^3 \\times 3 \\times 3 ^ 2 \\times 6 \\times 3 ^ 1 \\times 3 \\times 3 ^ 0\\\\\n  &= 78732\n\\end{aligned}\n$\n\nzrz_orz thinks it is too hard, so he throws the problem to you. Now there are $Q$ numbers written in “$X$-\\* base” (different numbers may have different $X$). You need to find their decimal representations.\n\nBecause the answer may be very large, output the length of the answer.", "inputFormat": "The first line contains an integer $Q$.\n\nThe next $Q$ lines: the $i$-th line contains an integer $X_i$ and a string $s_i$, meaning the $i$-th number is in “$X_i$-\\* base”, and its representation in that base is $s_i$.", "outputFormat": "Output $Q$ lines.\n\nThe $i$-th line contains one integer, the length of the $i$-th number’s decimal representation.", "hint": "**【Constraints】**\n\nFor $100\\%$ of the testdata, $1 \\le Q \\le 100, 1\\le X_i=|s_i|-1 \\le 10^5$.\n\nASCII visible characters (excluding characters whose ASCII code is $\\le 48$) include the following characters (sorted in increasing ASCII code):\n\n```text\n123456789:;<=>?\n@ABCDEFGHIJKLMNO\nPQRSTUVWXYZ[\\]^_\n`abcdefghijklmno\npqrstuvwxyz{|}~\n```\n\n**【Hint】**\n\nIf you want to brute force it, it is impossible without big integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神奇进制", "background": "hsl2363 正在造计算机。", "description": "hsl2363 发现计算机非常好玩，他打算自己造一台，造好之后 zrz_orz 来了，hsl2363 告诉他：\n\n“我的计算机是‘**$X$-\\* 进制**’的，我很想知道你到底有多菜，所以问问你这几个数换算成十进制之后是多少。”\n\n“**$X$-\\* 进制**”表示的数字可以由 ASCII 可见字符（不包括 ASCII 代码小于等于 $48$ 的字符）组成。令“**$X$-\\* 进制**”$s$ 长度为 $n$，位数从右到左为 $0$ 到 $n - 1$，则它表示这个数第 $i$ 位的 ASCII 代码减去 `0` 的 ASCII 代码（即 $48$），再乘以 $X$ 的 $i$ 次方的总乘积。也就是说，\n\n$$s=\\prod \\limits_{i=0} \\limits^{n-1} (X^i\\cdot (f(s_i)-f('0')))$$\n\n其中 $f('x')$ 表示字符 `x` 的 ASCII 代码值。\n\n下面是一个例子：\n\n若 $X=3$，$s=$`2363`，\n\n则有\n\n$\\begin{aligned}\n\ts&= f('2') \\times 3^3 \\times f('3') \\times 3 ^ 2 \\times f('6') \\times 3 ^ 1 \\times f('3') \\times 3 ^ 0 \\\\\n\t&= 2 \\times 3^3 \\times 3 \\times 3 ^ 2 \\times 6 \\times 3 ^ 1 \\times 3 \\times 3 ^ 0\\\\\n  &= 78732\n\\end{aligned}\n$\n\nzrz_orz 觉得太难了，把问题抛给了你。现在有 $Q$ 个用“$X$-\\* 进制”表示的数字（不同数字的 $X$ 可能不同），你需要求出它们的十进制表示。\n\n因为答案可能很大，请输出答案的长度。", "inputFormat": "第一行一个整数 $Q$。\n\n接下来 $Q$ 行，第 $i$ 行一个整数 $X_i$ 和一个字符串 $s_i$，表示第 $i$ 个数字为“$X_i$-\\* 进制”，在该进制下的表示为 $s_i$。", "outputFormat": "共 $Q$ 行。\n\n第 $i$ 行一个整数，代表第 $i$ 个数字在十进制表示下的长度。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1 \\le Q \\le 100, 1\\le X_i=|s_i|-1 \\le 10^5$。\n\nASCII 可见字符（不包括 ASCII 代码小于等于 $48$ 的字符）包含以下字符（按 ASCII 代码升序排序）：\n\n```text\n123456789:;<=>?\n@ABCDEFGHIJKLMNO\nPQRSTUVWXYZ[\\]^_\n`abcdefghijklmno\npqrstuvwxyz{|}~\n```\n\n**【提示】**\n\n如果想要暴力，没有高精度是不可能的。", "locale": "zh-CN"}}}
{"pid": "P4974", "type": "P", "difficulty": 4, "samples": [["5 2\n0\n1\n2\n2\n4\n5 10\n3 10\n", "3 50"]], "limits": {"time": [888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "枚举"], "title": "毒瘤之神秘通道", "background": "~~Viston就是一个小蒟蒻 By CYJian（自己YY出来的）~~         \nViston最喜欢冒险了。", "description": "~~（假的算法标签）~~\nViston发现了一个巨大的城堡，他走了进去，城堡里有一个巨大的房间，Viston进去打算参观参观，然后.......他就被困在里面了。   Viston发现了在房间里有很多同样冒险者和一个个通道，冒险者们一个个冲向了不同的**通道**，而Viston一脸懵逼。    \n\nViston动用他莫大的蒟蒻之力摸清了这些**通道**是什么东东~~厉害吧~~，他们是一些单向**通道**，而这些**通道**会把你传送到另一些房间里，一个房间里有一个传送到另一个房间里的传送门。     \n\n已知所有的房间最后都通向一个地方，那就是出口。但传送门把你传送到另一个房间也是需要时间的，这个时间取决于之前有多少人使用过这个传送门，计算公式是\n$$T=M$$,其中$M$表示传送门的使用人数。 ~~（你前面发啥呆啊，其他人早走光了。）~~\n\nViston记得每个通道有多少人进入，也探测出了每个房间里的传送门通向哪里，他想知道他从哪个通道进入初始房间才能最快的到达出口，~~毕竟Viston还想着颓金拱门呢。~~\n\n### 注意:只有使用传送门消耗时间,而通道（即到达初始房间）不消耗时间!!!", "inputFormat": "第一行输入两个整数$M$,$N$,其中$M$表示有多少个房间(编号为$1-M$),$N$表示有多少个初始的通道。    \n接下来的$2-------M+1$行,每行输入一个整数$P$,表示第$i$个房间通过一个传送门通向哪个房间,其中$0$号节点表示出口。数据保证是一棵树。       \n第$M+2-------M+N+1$行,每行输入两个整数$A,B$,表示这个**通道**通向房间$A$,之前有$B$个人进入其中。\n### 不同**通道**可能通向相同房间。", "outputFormat": "输出只有一行，$c,d$其中$c$表示Viston选择通过通道到达**哪个**初始房间所需时间最短,$d$表示需要多少时间。\n\n当然,如果有多个初始房间时间最短,就输出编号最大的**通道**通向的初始房间..", "hint": "## 样例解释\n（用的WindowsXP画图画的不好请见谅）               \n![](https://i.loli.net/2018/10/05/5bb7632fb40f4.jpg)\n \n对于1-5号测试点(10 pts): $1 \\leq N, M \\leq 50$\n\n对于6-10号测试点(20 pts): $1 \\leq N, M \\leq 5000$\n\n对于11-15号测试点(30 pts): $1 \\leq N, M \\leq 100000$\n\n对于16-20号测试点(40 pts): $1 \\leq N, M \\leq 1000000$\n\n对于5，10，15，20号测试点，给定的树为随机生成。\n\n保证答案都在long long范围内..\n\n\n$\\color{white}\\text{这样你才能看出来随机树强度有多低}$   \n\n@[Viston](https://www.luogu.org/space/show?uid=107101)\n\n$\\color{white}\\text{（还想卡树剖的）}$\n", "locale": "zh-CN", "translations": {"en": {"title": "Mystery Passage of the “Poison Tumor”", "background": "~~Viston is just a newbie (xiaojuruo) By CYJian (made up by myself)~~.  \nViston likes adventures the most.", "description": "~~(Fake algorithm tags)~~.  \nViston found a huge castle. He walked in, and there was a huge room inside. Viston went in to look around, and then... he got trapped inside. Viston found that there were many other adventurers in the room and many **passages**. The adventurers rushed into different **passages** one by one, while Viston was totally confused.\n\nUsing his great “newbie power”, Viston figured out what these **passages** are ~~awesome, right~~. They are one-way **passages**, and these **passages** will teleport you to other rooms. In each room, there is exactly one portal that teleports you to another room.\n\nIt is known that all rooms eventually lead to one place: the exit. However, being teleported by a portal also takes time. This time depends on how many people have used this portal before, and the formula is\n$$T=M$$, where $M$ is the number of people who have used the portal. ~~(Why are you spacing out? Everyone else has already left.)~~\n\nViston remembers how many people entered each passage, and he also detected where the portal in each room leads to. He wants to know: entering the initial room through which passage will let him reach the exit the fastest, ~~because Viston still wants to slack off at McDonald’s~~.\n\n### Note: Only using portals costs time. Passages (i.e., reaching the initial room) cost no time!!!", "inputFormat": "The first line contains two integers $M$, $N$, where $M$ is the number of rooms (numbered $1-M$), and $N$ is the number of initial passages.  \nIn lines $2-------M+1$, each line contains an integer $P$, meaning that room $i$ goes through a portal to room $P$, where node $0$ represents the exit. The testdata guarantees it is a tree.  \nIn lines $M+2-------M+N+1$, each line contains two integers $A, B$, meaning this **passage** leads to room $A$, and $B$ people have entered it before.  \n### Different **passages** may lead to the same room.", "outputFormat": "Output only one line, $c, d$, where $c$ is the **which** initial room Viston should choose to reach via a passage so that the required time is minimal, and $d$ is the required time.\n\nOf course, if multiple initial rooms have the same minimal time, output the initial room that is reached by the passage with the largest index.", "hint": "## Sample Explanation\n\n(Drawn in WindowsXP, sorry if it looks bad.)  \n![](https://i.loli.net/2018/10/05/5bb7632fb40f4.jpg)\n\nFor test points 1-5 (10 pts): $1 \\leq N, M \\leq 50$.  \n\nFor test points 6-10 (20 pts): $1 \\leq N, M \\leq 5000$.  \n\nFor test points 11-15 (30 pts): $1 \\leq N, M \\leq 100000$.  \n\nFor test points 16-20 (40 pts): $1 \\leq N, M \\leq 1000000$.  \n\nFor test points 5, 10, 15, 20, the given tree is generated randomly.\n\nIt is guaranteed that the answer fits in the range of long long.\n\n$\\color{white}\\text{This way you can see how weak random trees are}$.\n\n@[Viston](https://www.luogu.org/space/show?uid=107101)\n\n$\\color{white}\\text{(Still trying to hack tree decomposition.)}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神秘通道", "background": "~~Viston就是一个小蒟蒻 By CYJian（自己YY出来的）~~         \nViston最喜欢冒险了。", "description": "~~（假的算法标签）~~\nViston发现了一个巨大的城堡，他走了进去，城堡里有一个巨大的房间，Viston进去打算参观参观，然后.......他就被困在里面了。   Viston发现了在房间里有很多同样冒险者和一个个通道，冒险者们一个个冲向了不同的**通道**，而Viston一脸懵逼。    \n\nViston动用他莫大的蒟蒻之力摸清了这些**通道**是什么东东~~厉害吧~~，他们是一些单向**通道**，而这些**通道**会把你传送到另一些房间里，一个房间里有一个传送到另一个房间里的传送门。     \n\n已知所有的房间最后都通向一个地方，那就是出口。但传送门把你传送到另一个房间也是需要时间的，这个时间取决于之前有多少人使用过这个传送门，计算公式是\n$$T=M$$,其中$M$表示传送门的使用人数。 ~~（你前面发啥呆啊，其他人早走光了。）~~\n\nViston记得每个通道有多少人进入，也探测出了每个房间里的传送门通向哪里，他想知道他从哪个通道进入初始房间才能最快的到达出口，~~毕竟Viston还想着颓金拱门呢。~~\n\n### 注意:只有使用传送门消耗时间,而通道（即到达初始房间）不消耗时间!!!", "inputFormat": "第一行输入两个整数$M$,$N$,其中$M$表示有多少个房间(编号为$1-M$),$N$表示有多少个初始的通道。    \n接下来的$2-------M+1$行,每行输入一个整数$P$,表示第$i$个房间通过一个传送门通向哪个房间,其中$0$号节点表示出口。数据保证是一棵树。       \n第$M+2-------M+N+1$行,每行输入两个整数$A,B$,表示这个**通道**通向房间$A$,之前有$B$个人进入其中。\n### 不同**通道**可能通向相同房间。", "outputFormat": "输出只有一行，$c,d$其中$c$表示Viston选择通过通道到达**哪个**初始房间所需时间最短,$d$表示需要多少时间。\n\n当然,如果有多个初始房间时间最短,就输出编号最大的**通道**通向的初始房间..", "hint": "## 样例解释\n（用的WindowsXP画图画的不好请见谅）               \n![](https://i.loli.net/2018/10/05/5bb7632fb40f4.jpg)\n \n对于1-5号测试点(10 pts): $1 \\leq N, M \\leq 50$\n\n对于6-10号测试点(20 pts): $1 \\leq N, M \\leq 5000$\n\n对于11-15号测试点(30 pts): $1 \\leq N, M \\leq 100000$\n\n对于16-20号测试点(40 pts): $1 \\leq N, M \\leq 1000000$\n\n对于5，10，15，20号测试点，给定的树为随机生成。\n\n保证答案都在long long范围内..\n\n\n$\\color{white}\\text{这样你才能看出来随机树强度有多低}$   \n\n@[Viston](https://www.luogu.org/space/show?uid=107101)\n\n$\\color{white}\\text{（还想卡树剖的）}$\n", "locale": "zh-CN"}}}
{"pid": "P4975", "type": "P", "difficulty": 6, "samples": [["3\n1 1\n5 10\n6 7\n", "0\n7\n9\n"]], "limits": {"time": [666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": [], "title": "毒瘤之神TM菱树-①", "background": "本题图片可能较大请耐心加载\n\n什么?菱树是什么??\n\n好吧这个是蒟蒻自己搞事搞的一个非常简单的不是树但很像树的图..\n\n就像这样..\n\n![菱树](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(好吧图有点大(空旷)..)", "description": "现在给你一棵无限大的菱树(就是下面不止上面的图那么点大..)\n\n然后有$T$组询问,每一组询问都是给出$u$和$v$,求出这两个点的最短路径的长度..", "inputFormat": "第一行一个正整数$T$\n\n接下来$T$行每一行两个正整数表示询问的两个点..", "outputFormat": "$T$行,每行一个整数表示询问的答案.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 100$\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^3$\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^5$\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^{18}$", "locale": "zh-CN", "translations": {"en": {"title": "God of Nasty Problems TM Diamond Tree - ①", "background": "The image for this problem may be large, so please wait patiently for it to load.\n\nWhat? What is a diamond tree?\n\nAlright, this is a very simple graph (not actually a tree, but it looks a lot like one) that a newbie made for fun.\n\nIt looks like this.\n\n![Diamond Tree](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(Alright, the picture is a bit large (and empty).)", "description": "Now you are given an infinitely large diamond tree (it is not only as big as the picture above; it continues downward).\n\nThen there are $T$ queries. Each query gives $u$ and $v$. Find the length of the shortest path between these two nodes.", "inputFormat": "The first line contains a positive integer $T$.\n\nThe next $T$ lines each contain two positive integers, representing the two nodes in the query.", "outputFormat": "Output $T$ lines. Each line contains an integer representing the answer to the corresponding query.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 100$.\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^3$.\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^5$.\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神TM菱树-①", "background": "本题图片可能较大请耐心加载\n\n什么?菱树是什么??\n\n好吧这个是蒟蒻自己搞事搞的一个非常简单的不是树但很像树的图..\n\n就像这样..\n\n![菱树](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(好吧图有点大(空旷)..)", "description": "现在给你一棵无限大的菱树(就是下面不止上面的图那么点大..)\n\n然后有$T$组询问,每一组询问都是给出$u$和$v$,求出这两个点的最短路径的长度..", "inputFormat": "第一行一个正整数$T$\n\n接下来$T$行每一行两个正整数表示询问的两个点..", "outputFormat": "$T$行,每行一个整数表示询问的答案.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 100$\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^3$\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^5$\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^{18}$", "locale": "zh-CN"}}}
{"pid": "P4976", "type": "P", "difficulty": 6, "samples": [["5\n1\n2\n3\n4\n5", "0\n4\n43\n225\n812\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["O2优化"], "title": "毒瘤之神TM菱树-②", "background": "什么?菱树是什么??\n\n好吧这个是蒟蒻自己搞事搞的一个非常简单的不是树但很像树的图..\n\n就像这样..\n\n![菱树](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(好吧图有点大(空旷)..)", "description": "现在给你$T$棵菱树,每一颗菱树的层数为$n_i$,请求出菱树中所有点对的最短路径的和..", "inputFormat": "第一行一个正整数$T$\n\n接下来$T$行每一行一个正整数$n_i$表示菱树的大小..", "outputFormat": "$T$行,每行一个整数表示对于当前这颗菱树的所有点对的最短路径的和模$998244853$的结果.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 10$\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 100$\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 1000$\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 5*10^6$\n\n为了防止打表，所以空间限制缩小至64MB。", "locale": "zh-CN", "translations": {"en": {"title": "God of “Duliu” TM Rhombus Tree - ②", "background": "What? What is a rhombus tree??\n\nAlright, this is a very simple graph made by a newbie (pinyin: juruo) messing around. It is not a tree, but it looks a lot like a tree.\n\nLike this.\n\n![Rhombus Tree](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(Alright, the picture is a bit large (and empty).)", "description": "You are given $T$ rhombus trees. For the $i$-th rhombus tree, the number of levels is $n_i$. Please compute the sum of the shortest path lengths over all pairs of points in the rhombus tree.", "inputFormat": "The first line contains a positive integer $T$.\n\nThe next $T$ lines each contain a positive integer $n_i$, representing the size of the rhombus tree.", "outputFormat": "Output $T$ lines. Each line contains one integer, representing the sum of the shortest path lengths over all pairs of points in the current rhombus tree, modulo $998244853$.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 10$.\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 100$.\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 1000$.\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 5*10^6$.\n\nTo prevent precomputation with a lookup table, the memory limit is reduced to 64 MB.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神TM菱树-②", "background": "什么?菱树是什么??\n\n好吧这个是蒟蒻自己搞事搞的一个非常简单的不是树但很像树的图..\n\n就像这样..\n\n![菱树](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(好吧图有点大(空旷)..)", "description": "现在给你$T$棵菱树,每一颗菱树的层数为$n_i$,请求出菱树中所有点对的最短路径的和..", "inputFormat": "第一行一个正整数$T$\n\n接下来$T$行每一行一个正整数$n_i$表示菱树的大小..", "outputFormat": "$T$行,每行一个整数表示对于当前这颗菱树的所有点对的最短路径的和模$998244853$的结果.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 10$\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 100$\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 1000$\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 5*10^6$\n\n为了防止打表，所以空间限制缩小至64MB。", "locale": "zh-CN"}}}
{"pid": "P4977", "type": "P", "difficulty": 5, "samples": [["5 2 3", "100\n"], ["7 3 1", "28"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "O2优化"], "title": "毒瘤之神异之旅", "background": "题目名称是吸引你点进来的……\n\n我们的出题人 CYJian 由于出了过多毒瘤题被 D 死之后，OIer 们将他埋葬在地狱十八层之下……", "description": "已知地狱有 $K$ 个守护者，每个守护者有一个能力值 $a_i$。但是我们并不知道他们确切的能力值。只知道这些人的能力值的和为 $N$。但是在地狱中守护者的威力会得到加强，具体来说每一个守护者的威力为 $a_i^M$。\n\n现在给出 $N, M, K$，请求出所有可能的方案的威力值之和。", "inputFormat": "一行三个整数 $N, K$ 和 $M$。", "outputFormat": "一行一个整数，表示所有守护者能够发出的可能的威力值之和模 $10 ^ 9+7$。", "hint": "- Subtask 1 (20 pts): $1 \\leq N,M \\leq 10$，$1 \\leq K \\leq N$；\n- Subtask 2 (40 pts): $1 \\leq N,M \\leq 4096$，$1 \\leq K \\leq N$；\n- Subtask 3 (40 pts): $1 \\leq N,M \\leq 10000$，$1 \\leq K \\leq N$。\n\n其中所有的 $a_i$ 均需要是正整数。\n\n不要喷出题人毒瘤卡常，每一档部分分的时间和空间都至少开了标程的两倍。\n\n由于数据只有一组，可能强度较弱，所以需要每 5 个点捆绑测试。", "locale": "zh-CN", "translations": {"en": {"title": "A Strange Journey of the God of “Poison Problems”", "background": "The problem title is meant to lure you into clicking...\n\nAfter the problem setter CYJian created too many “poison problems” and was D-ed to death, the OIers buried him under the 18th layer of hell...", "description": "It is known that there are $K$ guardians in hell. Each guardian has an ability value $a_i$. However, we do not know their exact ability values. We only know that the sum of their ability values is $N$. In hell, a guardian’s power is enhanced. Specifically, the power of each guardian is $a_i^M$.\n\nNow given $N, M, K$, find the sum of the total power over all possible valid assignments.", "inputFormat": "One line with three integers $N, K$ and $M$.", "outputFormat": "One line with one integer, representing the sum of all possible power values that the guardians can produce, modulo $10 ^ 9+7$.", "hint": "- Subtask 1 (20 pts): $1 \\leq N,M \\leq 10$, $1 \\leq K \\leq N$.\n- Subtask 2 (40 pts): $1 \\leq N,M \\leq 4096$, $1 \\leq K \\leq N$.\n- Subtask 3 (40 pts): $1 \\leq N,M \\leq 10000$, $1 \\leq K \\leq N$.\n\nAll $a_i$ must be positive integers.\n\nPlease do not complain that the setter’s “poison problem” is designed to be tight on time limits. For each subtask, the time and memory limits are at least twice those of the official solution.\n\nSince there is only one test case, it may be relatively weak, so the judging will use bundled tests every 5 points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神异之旅", "background": "题目名称是吸引你点进来的……\n\n我们的出题人 CYJian 由于出了过多毒瘤题被 D 死之后，OIer 们将他埋葬在地狱十八层之下……", "description": "已知地狱有 $K$ 个守护者，每个守护者有一个能力值 $a_i$。但是我们并不知道他们确切的能力值。只知道这些人的能力值的和为 $N$。但是在地狱中守护者的威力会得到加强，具体来说每一个守护者的威力为 $a_i^M$。\n\n现在给出 $N, M, K$，请求出所有可能的方案的威力值之和。", "inputFormat": "一行三个整数 $N, K$ 和 $M$。", "outputFormat": "一行一个整数，表示所有守护者能够发出的可能的威力值之和模 $10 ^ 9+7$。", "hint": "- Subtask 1 (20 pts): $1 \\leq N,M \\leq 10$，$1 \\leq K \\leq N$；\n- Subtask 2 (40 pts): $1 \\leq N,M \\leq 4096$，$1 \\leq K \\leq N$；\n- Subtask 3 (40 pts): $1 \\leq N,M \\leq 10000$，$1 \\leq K \\leq N$。\n\n其中所有的 $a_i$ 均需要是正整数。\n\n不要喷出题人毒瘤卡常，每一档部分分的时间和空间都至少开了标程的两倍。\n\n由于数据只有一组，可能强度较弱，所以需要每 5 个点捆绑测试。", "locale": "zh-CN"}}}
{"pid": "P4978", "type": "P", "difficulty": 4, "samples": [["5 5\n1 2 3 4 5\n1 3 5 7 9", "754229067"], ["10 15\n7 8 5 1 2 3 6 5 4 1 \n52 10 5 6 3 2 1 4 5 8 7 4 5 6 3", "181952721"], ["1 1\n5\n5", "0"], ["5 5\n1254125 36521421 25362142 12514221 25362142\n857412252 36322411 2236232 1254112 36224125", "261761853"], ["2 2\n2 4\n2 5", "332748118"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["二分", "枚举", "前缀和", "概率论"], "title": "赌神：决斗", "background": "**赌神 $\\mathcal{CYJian}$，他回来了！**\n", "description": "**$\\mathcal{tomoo}$** 决定与 **$\\mathcal{CYJian}$** 进行决斗！\n\n已知 **$\\mathcal{tomoo}$** 有 $\\mathcal{N}$ 张扑克牌，每张扑克牌有一个$\\mathcal{RP}$值$\\mathcal{A_i}$， **$\\mathcal{CYJian}$** 有$\\mathcal{M}$张扑克牌，每张扑克牌有一个$\\mathcal{RP}$值$\\mathcal{B_i}$。\n\n**$\\mathcal{CYJian}$** 与 **$\\mathcal{tomoo}$** 将会各自从他们的牌里任意取一段**连续区间**的牌决斗，谁的区间内的牌的$\\mathcal{RP}$值的和更大，谁就赢了，请你帮忙求出 **$\\mathcal{tomoo}$** 赢的概率。", "inputFormat": "- 第一行 $2$ 个正整数 $\\mathcal{N,M}$\n- 第二行 $N$ 个正整数 $\\mathcal{A_i}$\n- 第三行 $M$ 个正整数 $\\mathcal{B_i}$", "outputFormat": "一个数表示 **$\\mathcal{tomoo}$** 获胜的概率，如果答案可以表示成 $\\frac{P}{Q}$ 的形式,则输出 $\\frac{P}{Q}\\%998244353$（不懂的左转[P3811](https://www.luogu.org/problemnew/show/P3811)）", "hint": "### 样例解释\n- 样例 $3$：不管怎么抽都是平均，胜率为 $0$\n- 样例 $5$：共有 $9$ 种方案，其中 $3$ 次 **tomoo** 会赢，胜率为 $1/3$\n\n### 数据范围\n- 对于 $20\\%$ 的数据，$0<N,M\\le50$\n- 对于另外 $20\\%$ 的数据，$\\sum_{i=1}^NA_i\\le10^6,\\sum_{j=1}^MB_j\\le10^6$\n- 对于$100\\%$的数据，$0<N,M\\le2000,0<A_i,B_i\\le10^9$", "locale": "zh-CN", "translations": {"en": {"title": "God of Gambling: Duel", "background": "**God of Gambling $\\mathcal{CYJian}$ is back!**", "description": "**$\\mathcal{tomoo}$** decides to duel with **$\\mathcal{CYJian}$**!\n\nIt is known that **$\\mathcal{tomoo}$** has $\\mathcal{N}$ playing cards, and each card has an $\\mathcal{RP}$ value $\\mathcal{A_i}$. **$\\mathcal{CYJian}$** has $\\mathcal{M}$ playing cards, and each card has an $\\mathcal{RP}$ value $\\mathcal{B_i}$.\n\n**$\\mathcal{CYJian}$** and **$\\mathcal{tomoo}$** will each choose an arbitrary **contiguous interval** of cards from their own decks to duel. Whoever has the larger sum of $\\mathcal{RP}$ values within their chosen interval wins. Please help compute the probability that **$\\mathcal{tomoo}$** wins.", "inputFormat": "- The first line contains two positive integers $\\mathcal{N,M}$.\n- The second line contains $N$ positive integers $\\mathcal{A_i}$.\n- The third line contains $M$ positive integers $\\mathcal{B_i}$.", "outputFormat": "Output one number representing the probability that **$\\mathcal{tomoo}$** wins. If the answer can be written in the form $\\frac{P}{Q}$, then output $\\frac{P}{Q}\\%998244353$ (if you do not understand, see [P3811](https://www.luogu.org/problemnew/show/P3811)).", "hint": "### Sample Explanation\n\n- Sample $3$: No matter how you choose, the result is always a tie on average, so the win rate is $0$.\n- Sample $5$: There are $9$ possible ways in total, and **tomoo** wins $3$ times, so the win rate is $1/3$.\n\n### Constraints\n\n- For $20\\%$ of the testdata, $0<N,M\\le50$.\n- For another $20\\%$ of the testdata, $\\sum_{i=1}^NA_i\\le10^6,\\sum_{j=1}^MB_j\\le10^6$.\n- For $100\\%$ of the testdata, $0<N,M\\le2000,0<A_i,B_i\\le10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "赌神：决斗", "background": "**赌神 $\\mathcal{CYJian}$，他回来了！**\n", "description": "**$\\mathcal{tomoo}$** 决定与 **$\\mathcal{CYJian}$** 进行决斗！\n\n已知 **$\\mathcal{tomoo}$** 有 $\\mathcal{N}$ 张扑克牌，每张扑克牌有一个$\\mathcal{RP}$值$\\mathcal{A_i}$， **$\\mathcal{CYJian}$** 有$\\mathcal{M}$张扑克牌，每张扑克牌有一个$\\mathcal{RP}$值$\\mathcal{B_i}$。\n\n**$\\mathcal{CYJian}$** 与 **$\\mathcal{tomoo}$** 将会各自从他们的牌里任意取一段**连续区间**的牌决斗，谁的区间内的牌的$\\mathcal{RP}$值的和更大，谁就赢了，请你帮忙求出 **$\\mathcal{tomoo}$** 赢的概率。", "inputFormat": "- 第一行 $2$ 个正整数 $\\mathcal{N,M}$\n- 第二行 $N$ 个正整数 $\\mathcal{A_i}$\n- 第三行 $M$ 个正整数 $\\mathcal{B_i}$", "outputFormat": "一个数表示 **$\\mathcal{tomoo}$** 获胜的概率，如果答案可以表示成 $\\frac{P}{Q}$ 的形式,则输出 $\\frac{P}{Q}\\%998244353$（不懂的左转[P3811](https://www.luogu.org/problemnew/show/P3811)）", "hint": "### 样例解释\n- 样例 $3$：不管怎么抽都是平均，胜率为 $0$\n- 样例 $5$：共有 $9$ 种方案，其中 $3$ 次 **tomoo** 会赢，胜率为 $1/3$\n\n### 数据范围\n- 对于 $20\\%$ 的数据，$0<N,M\\le50$\n- 对于另外 $20\\%$ 的数据，$\\sum_{i=1}^NA_i\\le10^6,\\sum_{j=1}^MB_j\\le10^6$\n- 对于$100\\%$的数据，$0<N,M\\le2000,0<A_i,B_i\\le10^9$", "locale": "zh-CN"}}}
{"pid": "P4979", "type": "P", "difficulty": 5, "samples": [["15\nAACBBABBBCCCBBB\n3\nB 4 5\nB 5 5\nB 10 12", "Yes\nYes\nNo"], ["5\nABBBB\n2\nB 1 4\nB 2 5", "No\nYes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "颜色段均摊（珂朵莉树 ODT）", "位运算"], "title": "矿洞：坍塌", "background": "- Made By tomoo\n\nCYJian 家里为什么那么有钱？因为他家$&@$%#开了矿！！\n\nCYJian 家虽然有矿，但是有矿也不能任性。这不，CYJian 家的矿塌了......\n\n**change:出题人仁慈地放大了空间限制**", "description": "CYJian 家的矿塌了之后，就没有经济来源了（不要问我怎么没有存款）。\n\n于是，CYJian 迫切地想要修复他家的矿。\n\nCYJian 家的矿共出产 $A,B,C$ 三种矿石，所以我们也只能用 $A,B,C$ 三种材料来修复他们家的矿。我们已知共有 $N$ 吨材料，每吨材料均为 $A,B,C$ 三种材料中的一种，它们连成了一个串，如：\n$$ABCBCABCBACBCBAA$$\nCYJian 家对材料的要求非常严格，他每次会选择一段连续区间的材料作为修复的材料。因为不合要求的材料会使得矿再次塌陷，砸死 CYJian，所以这个连续区间的材料必须满足以下 $2$ 个要求：\n- 这段连续区间必须是同一种材料\n- 这段连续区间的前一个材料与后一个材料必须不相同。\n\n例如，有一段材料为 $AACBBABBBCCCBBB$ ，则 $(4 \\sim 5)$ 区间的 $BB$ 和 $(5 \\sim 5)$ 区间的 $B$ 均符合要求，而 $(10 \\sim 12)$ 区间的 $CCC$ 不符合要求。\n\n材料有灵性，所以材料会有变化。\n\n现在有 $N$ 吨材料，$K$ 个询问。每个询问是以下的 $2$ 种形式之一：\n\n- `A x y op` 表示替换材料，将 $x$ 到 $y (1\\leq x \\leq y \\leq N)$ 区间内的材料替换为 $op$，$op$ 为 $A,B,C$ 三种材料字符中的一个。\n- `B x y` 表示是否询问，即询问 $x$ 到 $y(1\\leq x \\leq y \\leq N)$ 区间内的材料是否合法，合法输出 `Yes`，不合法输出 `No`。\n\n注意:当 $x=1$ 或 $y=N$ 时,你的程序不需要判断前后的情况,而只需要判断区间内的情况。", "inputFormat": "- 第一行一个正整数 $N$。\n- 接下来 $N$ 个字符，表示材料。\n- 接下来 $K$ 个询问，格式为上述的一种。", "outputFormat": "对于每个 `B x y` 的询问，输出一行 `Yes` 或 `No`。", "hint": "- 对于 $30\\%$ 的数据，$N\\le1000,K\\le2000$\n- 对于 $70\\%$ 的数据，$N\\le5000,K\\le5000$\n- 对于 $100\\%$ 的数据，$N\\le5\\cdot10^5,K\\le5\\cdot10^5, 1\\leq x \\leq y \\leq N$", "locale": "zh-CN", "translations": {"en": {"title": "Mine Cave: Collapse", "background": "- Made By tomoo\n\nWhy is CYJian’s family so rich? Because his family$&@$%# runs a mine!!\n\nEven if you have a mine, you cannot be reckless. Well, CYJian’s mine collapsed......\n\n**change: The setter kindly increased the memory limit.**", "description": "After CYJian’s mine collapsed, he no longer has any source of income (do not ask me why he has no savings).\n\nSo CYJian urgently wants to repair his mine.\n\nCYJian’s mine produces three kinds of ores: $A,B,C$. Therefore, we can only use the three kinds of materials $A,B,C$ to repair the mine. We know there are a total of $N$ tons of materials. Each ton is one of $A,B,C$, and they are connected into a string, for example:\n$$ABCBCABCBACBCBAA$$\n\nCYJian has very strict requirements for the materials. Each time, he will choose a continuous interval of materials as the repair materials. Because unqualified materials may cause the mine to collapse again and kill CYJian, this continuous interval must satisfy the following $2$ requirements:\n\n- This continuous interval must consist of only one kind of material.\n- The material immediately before this interval and the material immediately after this interval must be different.\n\nFor example, given a segment $AACBBABBBCCCBBB$, the interval $(4 \\sim 5)$ which is $BB$ and the interval $(5 \\sim 5)$ which is $B$ both satisfy the requirements, but the interval $(10 \\sim 12)$ which is $CCC$ does not.\n\nThe materials are “alive”, so they can change.\n\nNow there are $N$ tons of materials and $K$ queries. Each query is one of the following two types:\n\n- `A x y op` means a replacement operation: replace the materials in the interval from $x$ to $y (1\\leq x \\leq y \\leq N)$ with $op$, where $op$ is one of the characters $A,B,C$.\n- `B x y` means a check query: ask whether the materials in the interval from $x$ to $y(1\\leq x \\leq y \\leq N)$ are valid. Output `Yes` if valid, otherwise output `No`.\n\nNote: When $x=1$ or $y=N$, your program does not need to check the outside neighbors, and only needs to check the interval itself.", "inputFormat": "- The first line contains a positive integer $N$.\n- The next line contains $N$ characters, representing the materials.\n- Then follow $K$ queries, each in one of the formats above.", "outputFormat": "For each query `B x y`, output one line `Yes` or `No`.", "hint": "- For $30\\%$ of the testdata, $N\\le1000,K\\le2000$.\n- For $70\\%$ of the testdata, $N\\le5000,K\\le5000$.\n- For $100\\%$ of the testdata, $N\\le5\\cdot10^5,K\\le5\\cdot10^5, 1\\leq x \\leq y \\leq N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "矿洞：坍塌", "background": "- Made By tomoo\n\nCYJian 家里为什么那么有钱？因为他家$&@$%#开了矿！！\n\nCYJian 家虽然有矿，但是有矿也不能任性。这不，CYJian 家的矿塌了......\n\n**change:出题人仁慈地放大了空间限制**", "description": "CYJian 家的矿塌了之后，就没有经济来源了（不要问我怎么没有存款）。\n\n于是，CYJian 迫切地想要修复他家的矿。\n\nCYJian 家的矿共出产 $A,B,C$ 三种矿石，所以我们也只能用 $A,B,C$ 三种材料来修复他们家的矿。我们已知共有 $N$ 吨材料，每吨材料均为 $A,B,C$ 三种材料中的一种，它们连成了一个串，如：\n$$ABCBCABCBACBCBAA$$\nCYJian 家对材料的要求非常严格，他每次会选择一段连续区间的材料作为修复的材料。因为不合要求的材料会使得矿再次塌陷，砸死 CYJian，所以这个连续区间的材料必须满足以下 $2$ 个要求：\n- 这段连续区间必须是同一种材料\n- 这段连续区间的前一个材料与后一个材料必须不相同。\n\n例如，有一段材料为 $AACBBABBBCCCBBB$ ，则 $(4 \\sim 5)$ 区间的 $BB$ 和 $(5 \\sim 5)$ 区间的 $B$ 均符合要求，而 $(10 \\sim 12)$ 区间的 $CCC$ 不符合要求。\n\n材料有灵性，所以材料会有变化。\n\n现在有 $N$ 吨材料，$K$ 个询问。每个询问是以下的 $2$ 种形式之一：\n\n- `A x y op` 表示替换材料，将 $x$ 到 $y (1\\leq x \\leq y \\leq N)$ 区间内的材料替换为 $op$，$op$ 为 $A,B,C$ 三种材料字符中的一个。\n- `B x y` 表示是否询问，即询问 $x$ 到 $y(1\\leq x \\leq y \\leq N)$ 区间内的材料是否合法，合法输出 `Yes`，不合法输出 `No`。\n\n注意:当 $x=1$ 或 $y=N$ 时,你的程序不需要判断前后的情况,而只需要判断区间内的情况。", "inputFormat": "- 第一行一个正整数 $N$。\n- 接下来 $N$ 个字符，表示材料。\n- 接下来 $K$ 个询问，格式为上述的一种。", "outputFormat": "对于每个 `B x y` 的询问，输出一行 `Yes` 或 `No`。", "hint": "- 对于 $30\\%$ 的数据，$N\\le1000,K\\le2000$\n- 对于 $70\\%$ 的数据，$N\\le5000,K\\le5000$\n- 对于 $100\\%$ 的数据，$N\\le5\\cdot10^5,K\\le5\\cdot10^5, 1\\leq x \\leq y \\leq N$", "locale": "zh-CN"}}}
{"pid": "P4980", "type": "P", "difficulty": 6, "samples": [["5\n1 \n2 \n3 \n4 \n5 ", "1\n3\n11\n70\n629"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "群论", "Pólya 定理", "模板题"], "title": "【模板】Pólya 定理", "background": "", "description": "给定一个 $n$ 个点，$n$ 条边的环，有 $n$ 种颜色，给每个顶点染色，问有多少种**本质不同**的染色方案，答案对 $10^9+7$ 取模。\n\n注意本题的本质不同，定义为：**只需要不能通过旋转与别的染色方案相同**。", "inputFormat": "第一行输入一个 $t$，表示有 $t$ 组数据\n\n第二行开始，一共 $t$ 行，每行一个整数 $n$，意思如题所示。", "outputFormat": "共$t$行，每行一个数字，表示染色方案数对 $10^9+7$ 取模后的结果", "hint": "$$n \\leq 10^9$$\n$$t \\leq 10^3$$", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Pólya Theorem", "background": "", "description": "Given a cycle with $n$ vertices and $n$ edges, there are $n$ colors. Color each vertex, and ask how many **essentially different** coloring schemes there are. Output the answer modulo $10^9+7$.\n\nNote that in this problem, “essentially different” is defined as: it **only needs to be different up to rotation**, i.e., two colorings are considered the same if one can be obtained from the other by rotation.", "inputFormat": "The first line contains an integer $t$, meaning there are $t$ test cases.\n\nStarting from the second line, there are $t$ lines in total. Each line contains an integer $n$, with the meaning as described above.", "outputFormat": "There are $t$ lines in total. Each line contains one number, representing the number of coloring schemes modulo $10^9+7$.", "hint": "$$n \\leq 10^9$$\n$$t \\leq 10^3$$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】Pólya 定理", "background": "", "description": "给定一个 $n$ 个点，$n$ 条边的环，有 $n$ 种颜色，给每个顶点染色，问有多少种**本质不同**的染色方案，答案对 $10^9+7$ 取模。\n\n注意本题的本质不同，定义为：**只需要不能通过旋转与别的染色方案相同**。", "inputFormat": "第一行输入一个 $t$，表示有 $t$ 组数据\n\n第二行开始，一共 $t$ 行，每行一个整数 $n$，意思如题所示。", "outputFormat": "共$t$行，每行一个数字，表示染色方案数对 $10^9+7$ 取模后的结果", "hint": "$$n \\leq 10^9$$\n$$t \\leq 10^3$$", "locale": "zh-CN"}}}
{"pid": "P4981", "type": "P", "difficulty": 3, "samples": [["1\n3\n", "9"], ["1\n323\n", "283888610"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["组合数学", "Prüfer 序列"], "title": "父子", "background": "上演在各大学男生寝室的日常 $:$\n\n$A :$ “我没带纸，快来厕所救我！”\n\n$B :$ “叫爸爸。”\n\n$A :$ “爸爸！”\n\n$............................................$\n\n$A :$ “我没钱了，能借我点吗。”\n\n$B :$ “叫爸爸。”\n\n$A :$ “爸爸！”\n\n一个月后、\n\n$B :$ “能把钱还给我吗。”\n\n$A :$ “叫爸爸。”\n\n$B :$ “爸爸！”", "description": "对于全国各大大学的男生寝室，总是有各种混乱的父子关系。\n\n那么假设现在我们一个男生寝室有不同的 $n$ 个人，每个人都至多有一个“爸爸”，可以有多个“儿子”，且有且只有一个人没有“爸爸”(毕竟是室长，还是要给点面子，当然了，室长人人当嘛)。\n\n那么现在问题来了，对于一个有 $n$ 个人的寝室，最多可能存在多少种父子关系，当然每个人之间都必须要有直接或间接的父子关系。", "inputFormat": "第一行一个非负整数 $t$，表示有 $t$ 组数据。\n\n接下来 $t$ 行，每行一个整数 $n$，表示有 $n$ 个人。", "outputFormat": "共 $t$ 行，每行一个整数，求关系个数。\n\n由于答案可能较大，则我们需要输出答案对 $10^9+9$ 取模的值。", "hint": "- 对于 $10\\%$ 的数据，保证 $t=0$；\n\n- 另有 $30\\%$ 的数据，保证 $n≤5$；\n\n- 对于 $100\\%$ 的数据，$t≤10^4$，$1\\le n\\le10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Father and Son", "background": "A daily scene often seen in male dorms at universities:\n\n$A:$ “I didn’t bring tissues. Hurry and save me in the restroom!”\n\n$B:$ “Call me dad.”\n\n$A:$ “Dad!”\n\n$............................................$\n\n$A:$ “I’m out of money. Can you lend me some?”\n\n$B:$ “Call me dad.”\n\n$A:$ “Dad!”\n\nOne month later,\n\n$B:$ “Can you pay me back?”\n\n$A:$ “Call me dad.”\n\n$B:$ “Dad!”", "description": "In male dorms across the country, there are always all kinds of messy “father-son” relationships.\n\nNow suppose a dorm has $n$ different people. Each person has at most one “dad”, can have multiple “sons”, and there is exactly one person who has no “dad” (after all, they are the dorm leader, so give them some respect; of course, anyone can be the leader).\n\nNow the question is: for a dorm with $n$ people, what is the maximum possible number of different father-son relationships? Also, between any two people, there must be a direct or indirect father-son relationship.", "inputFormat": "The first line contains a non-negative integer $t$, meaning there are $t$ test cases.\n\nThe next $t$ lines each contain an integer $n$, meaning there are $n$ people.", "outputFormat": "Output $t$ lines. Each line contains one integer, the number of possible relationships.\n\nSince the answer may be large, output the result modulo $10^9+9$.", "hint": "- For $10\\%$ of the testdata, it is guaranteed that $t=0$.\n\n- For another $30\\%$ of the testdata, it is guaranteed that $n \\le 5$.\n\n- For $100\\%$ of the testdata, $t \\le 10^4$, $1 \\le n \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "父子", "background": "上演在各大学男生寝室的日常 $:$\n\n$A :$ “我没带纸，快来厕所救我！”\n\n$B :$ “叫爸爸。”\n\n$A :$ “爸爸！”\n\n$............................................$\n\n$A :$ “我没钱了，能借我点吗。”\n\n$B :$ “叫爸爸。”\n\n$A :$ “爸爸！”\n\n一个月后、\n\n$B :$ “能把钱还给我吗。”\n\n$A :$ “叫爸爸。”\n\n$B :$ “爸爸！”", "description": "对于全国各大大学的男生寝室，总是有各种混乱的父子关系。\n\n那么假设现在我们一个男生寝室有不同的 $n$ 个人，每个人都至多有一个“爸爸”，可以有多个“儿子”，且有且只有一个人没有“爸爸”(毕竟是室长，还是要给点面子，当然了，室长人人当嘛)。\n\n那么现在问题来了，对于一个有 $n$ 个人的寝室，最多可能存在多少种父子关系，当然每个人之间都必须要有直接或间接的父子关系。", "inputFormat": "第一行一个非负整数 $t$，表示有 $t$ 组数据。\n\n接下来 $t$ 行，每行一个整数 $n$，表示有 $n$ 个人。", "outputFormat": "共 $t$ 行，每行一个整数，求关系个数。\n\n由于答案可能较大，则我们需要输出答案对 $10^9+9$ 取模的值。", "hint": "- 对于 $10\\%$ 的数据，保证 $t=0$；\n\n- 另有 $30\\%$ 的数据，保证 $n≤5$；\n\n- 对于 $100\\%$ 的数据，$t≤10^4$，$1\\le n\\le10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P4982", "type": "P", "difficulty": 6, "samples": [["3 3 2\n2 1 3\n2 2 3\n", "11"], ["10 7 3\n5 1 2 3 4 5\n3 1 3 7\n4 1 2 6 7\n", "730285459"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000]}, "tags": ["动态规划 DP", "O2优化", "期望", "构造"], "title": "规划", "background": "经过长期的艰苦奋斗，${\\rm TimeTraveller\\ }$终于成功进入了理想的学校。", "description": "作为吃货的${\\rm \\ TimeTraveller}$，入学的第一件事不是去报到，而是去食堂调查菜品。但是由于各种原因，本学期食堂的菜品很少，而且食堂制定了几天的菜谱，那么这个学期里，以后每天提供的菜品都会**按照菜谱轮流循环进行**。听到这件事，${\\rm TimeTraveller\\ }$的内心当然是崩溃的，但是他还是希望每天能吃的不那么重复，于是${\\rm \\  TimeTraveller\\ }$决定只要**和前一天吃的菜不重复**就行了，但是身为吃货的${\\rm \\ TimeTraveller\\ }$当然也不想饿肚子，所以**每天至少都要吃一道菜**。\n\n${\\rm TimeTraveller\\ }$想要知道他有多少种合法的规划方案，但是他发现这实在是太多了，于是他来求助你，希望你能编写一个程序帮他计算。\n", "inputFormat": "第一行三个正整数$n,m,k$，分别表示这个学期有$n$天，总共有$m$种菜品，学校制定了$k$天的菜谱（所有菜品从$1$到$m$编号，保证$n ≥ k$）。\n\n接下来$k$行，每行第一个数$p$表示这一天学校准备了$p$道菜，紧接着有$p$个数，表示这一天的$p$道菜分别是哪几道（保证$p$不会超过$m$，且这$p$个数都是不重复的）。\n", "outputFormat": "输出合法方案的数量，由于答案可能过大，你只需要输出答案对$1e9+7$取模后的值。", "hint": "#### 样例$1$解释：\n\n方案$1$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$2$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$3$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品；\n\n方案$4$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$5$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$6$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品；\n\n方案$7$：第一天吃$1$号菜品，第二天吃$2,3$号菜品，第三天吃$1$号菜品；\n\n方案$8$：第一天吃$1$号菜品，第二天吃$3$号菜品，第三天吃$1$号菜品；\n\n方案$9$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$10$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$11$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品。\n\n#### 数据范围：\n\n- 对于$20\\%$的数据，$n≤ 5,m≤ 7,k≤ 5$；\n\n- 对于$45\\%$的数据，$n≤ 50000,m≤ 7,k≤ 7$；\n\n- 另有$10\\%$的数据，$n≤ 10^7,m≤ 2,k= 1$；\n\n- 对于$70\\%$的数据，$n≤ 10^7,m≤ 7,k≤ 7$；\n\n- 对于$100\\%$的数据，$n≤ 10^7,m≤ 7,k≤ 300$。", "locale": "zh-CN", "translations": {"en": {"title": "Planning", "background": "After a long period of hard work, ${\\rm TimeTraveller\\ }$ finally got into his dream school.", "description": "As a foodie, ${\\rm \\ TimeTraveller}$ did not go to register on his first day after enrollment. Instead, he went to the cafeteria to check the dishes. However, for various reasons, there are very few dishes in the cafeteria this semester, and the cafeteria has made a menu for several days. Therefore, during this semester, the dishes provided each day in the future will **cycle in turn according to the menu**.\n\nAfter hearing this, ${\\rm TimeTraveller\\ }$ was of course devastated, but he still hopes that what he eats every day will not be too repetitive. So ${\\rm \\  TimeTraveller\\ }$ decides that it is enough as long as **the dishes he eats do not overlap with the previous day**. But as a foodie, ${\\rm \\ TimeTraveller\\ }$ also does not want to go hungry, so **he must eat at least one dish every day**.\n\n${\\rm TimeTraveller\\ }$ wants to know how many legal planning schemes he has, but he finds there are simply too many. So he asks you for help and hopes you can write a program to compute it for him.", "inputFormat": "The first line contains three positive integers $n,m,k$, meaning this semester has $n$ days, there are $m$ kinds of dishes in total, and the school has made a $k$-day menu (all dishes are numbered from $1$ to $m$, and it is guaranteed that $n \\ge k$).\n\nThe next $k$ lines describe the menu. In each line, the first number is $p$, meaning the school prepared $p$ dishes on that day, followed by $p$ numbers indicating which dishes they are (it is guaranteed that $p$ does not exceed $m$, and these $p$ numbers are all distinct).", "outputFormat": "Output the number of legal schemes. Since the answer may be too large, you only need to output the value modulo $1e9+7$.", "hint": "#### Sample $1$ Explanation:\n\nScheme $1$: On day $1$, eat dishes $1,3$; on day $2$, eat dish $2$; on day $3$, eat dishes $1,3$.\n\nScheme $2$: On day $1$, eat dishes $1,3$; on day $2$, eat dish $2$; on day $3$, eat dish $3$.\n\nScheme $3$: On day $1$, eat dishes $1,3$; on day $2$, eat dish $2$; on day $3$, eat dish $1$.\n\nScheme $4$: On day $1$, eat dish $3$; on day $2$, eat dish $2$; on day $3$, eat dishes $1,3$.\n\nScheme $5$: On day $1$, eat dish $3$; on day $2$, eat dish $2$; on day $3$, eat dish $3$.\n\nScheme $6$: On day $1$, eat dish $3$; on day $2$, eat dish $2$; on day $3$, eat dish $1$.\n\nScheme $7$: On day $1$, eat dish $1$; on day $2$, eat dishes $2,3$; on day $3$, eat dish $1$.\n\nScheme $8$: On day $1$, eat dish $1$; on day $2$, eat dish $3$; on day $3$, eat dish $1$.\n\nScheme $9$: On day $1$, eat dish $1$; on day $2$, eat dish $2$; on day $3$, eat dishes $1,3$.\n\nScheme $10$: On day $1$, eat dish $1$; on day $2$, eat dish $2$; on day $3$, eat dish $3$.\n\nScheme $11$: On day $1$, eat dish $1$; on day $2$, eat dish $2$; on day $3$, eat dish $1$.\n\n#### Constraints:\n\n- For $20\\%$ of the testdata, $n \\le 5, m \\le 7, k \\le 5$.\n\n- For $45\\%$ of the testdata, $n \\le 50000, m \\le 7, k \\le 7$.\n\n- For another $10\\%$ of the testdata, $n \\le 10^7, m \\le 2, k = 1$.\n\n- For $70\\%$ of the testdata, $n \\le 10^7, m \\le 7, k \\le 7$.\n\n- For $100\\%$ of the testdata, $n \\le 10^7, m \\le 7, k \\le 300$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "规划", "background": "经过长期的艰苦奋斗，${\\rm TimeTraveller\\ }$终于成功进入了理想的学校。", "description": "作为吃货的${\\rm \\ TimeTraveller}$，入学的第一件事不是去报到，而是去食堂调查菜品。但是由于各种原因，本学期食堂的菜品很少，而且食堂制定了几天的菜谱，那么这个学期里，以后每天提供的菜品都会**按照菜谱轮流循环进行**。听到这件事，${\\rm TimeTraveller\\ }$的内心当然是崩溃的，但是他还是希望每天能吃的不那么重复，于是${\\rm \\  TimeTraveller\\ }$决定只要**和前一天吃的菜不重复**就行了，但是身为吃货的${\\rm \\ TimeTraveller\\ }$当然也不想饿肚子，所以**每天至少都要吃一道菜**。\n\n${\\rm TimeTraveller\\ }$想要知道他有多少种合法的规划方案，但是他发现这实在是太多了，于是他来求助你，希望你能编写一个程序帮他计算。\n", "inputFormat": "第一行三个正整数$n,m,k$，分别表示这个学期有$n$天，总共有$m$种菜品，学校制定了$k$天的菜谱（所有菜品从$1$到$m$编号，保证$n ≥ k$）。\n\n接下来$k$行，每行第一个数$p$表示这一天学校准备了$p$道菜，紧接着有$p$个数，表示这一天的$p$道菜分别是哪几道（保证$p$不会超过$m$，且这$p$个数都是不重复的）。\n", "outputFormat": "输出合法方案的数量，由于答案可能过大，你只需要输出答案对$1e9+7$取模后的值。", "hint": "#### 样例$1$解释：\n\n方案$1$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$2$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$3$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品；\n\n方案$4$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$5$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$6$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品；\n\n方案$7$：第一天吃$1$号菜品，第二天吃$2,3$号菜品，第三天吃$1$号菜品；\n\n方案$8$：第一天吃$1$号菜品，第二天吃$3$号菜品，第三天吃$1$号菜品；\n\n方案$9$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$10$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$11$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品。\n\n#### 数据范围：\n\n- 对于$20\\%$的数据，$n≤ 5,m≤ 7,k≤ 5$；\n\n- 对于$45\\%$的数据，$n≤ 50000,m≤ 7,k≤ 7$；\n\n- 另有$10\\%$的数据，$n≤ 10^7,m≤ 2,k= 1$；\n\n- 对于$70\\%$的数据，$n≤ 10^7,m≤ 7,k≤ 7$；\n\n- 对于$100\\%$的数据，$n≤ 10^7,m≤ 7,k≤ 300$。", "locale": "zh-CN"}}}
{"pid": "P4983", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2 3\n", "32"], ["10 3\n1 2 3 4 5 6 7 8 9 10\n", "1140"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["斜率优化", "凸完全单调性（wqs 二分）", "凸包"], "title": "忘情", "background": " “为什么要离开我！”\n\n “因为你没玩儿转！”\n\n “我玩儿转了！”\n\n “那好，你现在就给我维护这么一个式子！”\n\n “为什么要出这么毒瘤的东西。”\n\n “为了恶心你。”\n\n “......”\n\n$…………………………….$\n", "description": "你的 $npy$ 为了恶心你，特地请了四位大神和一个辣鸡！\n\n $\\rm hdxrie$ 说：“我们得求和。”于是有了 $\\sum\\limits_{i=1}^{n}x_i $ 。\n\n $\\rm Imagine$ 说：“我们得有平均数。”于是有了 $\\bar x $ 。\n\n $\\rm TimeTraveller$ 说：“我们得有加减乘除。”于是有了一些恶心的组合。\n\n $\\rm Althen·Way·Satan$ 说：“我们还得有平方。”于是我们将它平方。\n\n最垃圾的 $\\rm ZredXNy$ 说：“那我帮你们整合一下。”\n\n于是，我们得到了这么一个式子 $:$\n\n$$\\frac{\\left((\\sum\\limits_{i=1}^{n}x_i×\\bar x)+\\bar x\\right)^2}{\\bar x^2}$$\n\n\n我们定义一段序列的值为这个，其中  $n$为此序列的元素个数。\n\n我们给定一段长度为 $n$ 的序列,现在要求将它分成 $m$ 段，要求每一段的值的总和最小，求出这个最小值。\n", "inputFormat": "第一行两个正整数，分别为 $n$，$m$，定义见题面。\n\n接下来一行为 $n$ 个正整数，依次给出这个序列的每个元素的值 $x_i$ 。", "outputFormat": "一个整数，求出这个最小值。", "hint": "- 对于 $30 \\%$ 的数据，$m≤n≤500$；\n\n- 另有 $20 \\%$ 的数据，保证 $m=2$；\n\n- 对于 $100 \\%$ 的数据，$m≤n≤100000$，$1≤x_i≤1000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Forgetfulness", "background": "\"Why are you leaving me!\"\n\n\"Because you can't handle it!\"\n\n\"I can handle it!\"\n\n\"Fine, then maintain such a formula for me right now!\"\n\n\"Why would you give such a nasty thing.\"\n\n\"To annoy you.\"\n\n\"......\"\n\n$…………………………….$", "description": "Your $npy$, in order to annoy you, specially invited four gurus and one noob!\n\n$\\rm hdxrie$ said: \"We need a sum.\" So we have $\\sum\\limits_{i=1}^{n} x_i$.\n\n$\\rm Imagine$ said: \"We need an average.\" So we have $\\bar x$.\n\n$\\rm TimeTraveller$ said: \"We need addition, subtraction, multiplication, and division.\" So we have some nasty combinations.\n\n$\\rm Althen·Way·Satan$ said: \"We also need squaring.\" So we square it.\n\nThe worst $\\rm ZredXNy$ said: \"Then I'll help you merge them.\"\n\nSo we get the following expression:\n\n$$\\frac{\\left((\\sum\\limits_{i=1}^{n}x_i×\\bar x)+\\bar x\\right)^2}{\\bar x^2}$$\n\nWe define the value of a sequence as this expression, where $n$ is the number of elements in the sequence.\n\nGiven a sequence of length $n$, you now need to split it into $m$ segments. The sum of the values of all segments should be as small as possible. Output this minimum value.", "inputFormat": "The first line contains two positive integers $n$ and $m$, as defined in the statement.\n\nThe next line contains $n$ positive integers, giving the value of each element $x_i$ in order.", "outputFormat": "Output one integer, the minimum value.", "hint": "- For $30\\%$ of the data, $m \\le n \\le 500$.\n- For another $20\\%$ of the data, it is guaranteed that $m = 2$.\n- For $100\\%$ of the data, $m \\le n \\le 100000$, $1 \\le x_i \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "忘情", "background": " “为什么要离开我！”\n\n “因为你没玩儿转！”\n\n “我玩儿转了！”\n\n “那好，你现在就给我维护这么一个式子！”\n\n “为什么要出这么毒瘤的东西。”\n\n “为了恶心你。”\n\n “......”\n\n$…………………………….$\n", "description": "你的 $npy$ 为了恶心你，特地请了四位大神和一个辣鸡！\n\n $\\rm hdxrie$ 说：“我们得求和。”于是有了 $\\sum\\limits_{i=1}^{n}x_i $ 。\n\n $\\rm Imagine$ 说：“我们得有平均数。”于是有了 $\\bar x $ 。\n\n $\\rm TimeTraveller$ 说：“我们得有加减乘除。”于是有了一些恶心的组合。\n\n $\\rm Althen·Way·Satan$ 说：“我们还得有平方。”于是我们将它平方。\n\n最垃圾的 $\\rm ZredXNy$ 说：“那我帮你们整合一下。”\n\n于是，我们得到了这么一个式子 $:$\n\n$$\\frac{\\left((\\sum\\limits_{i=1}^{n}x_i×\\bar x)+\\bar x\\right)^2}{\\bar x^2}$$\n\n\n我们定义一段序列的值为这个，其中  $n$为此序列的元素个数。\n\n我们给定一段长度为 $n$ 的序列,现在要求将它分成 $m$ 段，要求每一段的值的总和最小，求出这个最小值。\n", "inputFormat": "第一行两个正整数，分别为 $n$，$m$，定义见题面。\n\n接下来一行为 $n$ 个正整数，依次给出这个序列的每个元素的值 $x_i$ 。", "outputFormat": "一个整数，求出这个最小值。", "hint": "- 对于 $30 \\%$ 的数据，$m≤n≤500$；\n\n- 另有 $20 \\%$ 的数据，保证 $m=2$；\n\n- 对于 $100 \\%$ 的数据，$m≤n≤100000$，$1≤x_i≤1000$。\n", "locale": "zh-CN"}}}
{"pid": "P4984", "type": "P", "difficulty": 6, "samples": [["2\n10 2 4 72451\n-3 -4 2 123456\n", "10001101100000011\n10200101101\n101230003\n2021\n122000\n10001001\n-10000111"], ["2\n8 2 2 176336030760401.6\n30 35 36 HQA9MBFD3SEC.<GAR85DJ2LO>\n", "1111110011011110000011000111110000100000001.11\n39SAWRJ5CPP7.<J36CPFVSM9>\n2EMEUXKKZHA0.<JMWQ6>"], ["1\n-26 -6 -6 1PMMK.<L15>\n", "1213400.<511>"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000]}, "tags": ["进制", "期望"], "title": "转换", "background": "$\\rm hdxrie\\ $最近在为新建的宇宙购物中心编写价格系统。", "description": "购物中心汇聚了来自各个星球的商品，但是由于不同的星球采用的进制各不相同，导致商品价格计算起来比较困难，因此价格系统是必不可少的。\n\n由于甲方所给的期限太短，$\\rm hdxrie\\ $便找到你来做他的助手，他只需要你帮忙编写一个进制转换的程序就行，其它的各个系统版块全部由他自己负责，你能在规定期限内写出转换程序吗？", "inputFormat": "第一行一个数$n$，$n$表示有多少个物品的价格需要转换。\n\n接下来$n$行，每行三个数字$a,l,r$和一个价格串$S$。\n\n$a$表示这个价格串为$a$进制数（保证$a$不为$-1,0,1$），你需要把它转化为$l$到$r$的所有进制（请自动跳过输出为$-1,0,1$这些进制的情况）。\n\n由于价格为实数，所以难免会出现小数，并且若一个小数为循环小数，我们会将小数的循环节使用 <,> 括起来。\n\n如果不是循环小数则没有尖括号，如果没有小数部分则没有小数点，保证不会出现尖括号之间没有数字情况。\n\n保证循环节以及循环节前面的小数部分都是最短的，例如$10$进制下的$0.123123\\cdots$，那么所给的读入形式为$0.$<$123$>，保证不会出现类似于$0.1$<$231$>或$0.$<$123123$>这些情况。\n\n对于正进制$a$，保证不会出现循环节为$a-1$的情况，例如$10$进制不会出现$0.$<$9$>这样的输入，但是负进制没有这样的要求。\n\n为了方便转换，当用正进制表示负数的时候，规定在价格前加上负号，但是由于负进制既可表示正数也可表示负数，所以规定负进制前不允许出现负号。\n\n规定任意进制的每一位不能为负，规定大于$9$的值按照大写字母从小到大编写。", "outputFormat": "对于每一个需要转换的价格，在给定范围内按进制从小到大的顺序输出转换为该进制后的价格串（请自动跳过输出为$-1,0,1$这些进制的情况）。\n\n对于输出格式你也应该严格按照上面输入格式的要求输出每一个价格串。", "hint": "- 对于$5\\%$的数据，保证没有小数部分，$1≤n≤20,2≤a≤36,2≤l≤r≤36$；\n\n- 对于$15\\%$的数据，保证没有小数部分，$1≤n≤100,2≤|a|≤36,-36≤l≤r≤36$；\n\n- 另有$15\\%$的数据，保证转换前和转换后都是有限小数，$1≤n≤550,2≤a≤36,2≤l≤r≤36$；\n\n- 另有$20\\%$的数据，$1≤n≤550,2≤a≤36,2≤l≤r≤36$；\n\n- 对于$100\\%$的数据，$1≤n≤550,2≤|a|≤36,-36≤l≤r≤36$；\n\n保证所有数据中，价格的绝对值都不会超过$2^{63}-1$，且转换前和转换后的小数部分的字符串长度均不超过$\\left\\lfloor\\log_{|a|}2^{62}\\right\\rfloor$（$a$表示进制，括号不计入长度）。", "locale": "zh-CN", "translations": {"en": {"title": "Conversion", "background": "$\\rm hdxrie\\ $ has recently been writing a pricing system for a newly built interstellar shopping mall.", "description": "The shopping mall gathers goods from many planets. However, different planets use different numeral bases, which makes price calculation difficult, so a pricing system is necessary.\n\nBecause the deadline given by the client is too tight, $\\rm hdxrie\\ $ asks you to be his assistant. He only needs you to help write a base conversion program; all other system modules will be handled by himself. Can you finish the conversion program within the time limit?", "inputFormat": "The first line contains an integer $n$, where $n$ is the number of item prices that need to be converted.\n\nThe next $n$ lines each contain three integers $a, l, r$ and a price string $S$.\n\n$a$ means the price string is a base-$a$ number (it is guaranteed that $a$ is not $-1, 0, 1$). You need to convert it into all bases from $l$ to $r$ (please automatically skip the cases where the base is $-1, 0, 1$).\n\nSince prices are real numbers, there may be fractional parts. If a fractional part is repeating, we will enclose the repeating cycle in `<,>`.\n\nIf it is not a repeating decimal, there will be no angle brackets. If there is no fractional part, there will be no decimal point. It is guaranteed that there will not be a case where there are no digits between the angle brackets.\n\nIt is guaranteed that both the repeating cycle and the non-repeating part before it are the shortest possible. For example, in base $10$, $0.123123\\cdots$ will be given as $0.$<$123$>. Inputs like $0.1$<$231$> or $0.$<$123123$> will not appear.\n\nFor positive base $a$, it is guaranteed that the repeating cycle will not be $a-1$. For example, in base $10$, an input like $0.$<$9$> will not appear. But for negative bases, there is no such restriction.\n\nTo make conversion easier, when using a positive base to represent a negative number, a minus sign is added before the price. But since a negative base can represent both positive and negative numbers, a minus sign is not allowed for negative bases.\n\nIt is required that every digit in any base is non-negative. Values greater than $9$ are written using uppercase letters in increasing order.", "outputFormat": "For each price that needs to be converted, output the price string converted to each base in the given range, in increasing order of the base (please automatically skip the cases where the base is $-1, 0, 1$).\n\nYou must also strictly follow the requirements described above for the input format when outputting each price string.", "hint": "- For $5\\%$ of the testdata, there is no fractional part, and $1≤n≤20,2≤a≤36,2≤l≤r≤36$.\n\n- For $15\\%$ of the testdata, there is no fractional part, and $1≤n≤100,2≤|a|≤36,-36≤l≤r≤36$.\n\n- For another $15\\%$ of the testdata, both before and after conversion are terminating decimals, and $1≤n≤550,2≤a≤36,2≤l≤r≤36$.\n\n- For another $20\\%$ of the testdata, $1≤n≤550,2≤a≤36,2≤l≤r≤36$.\n\n- For $100\\%$ of the testdata, $1≤n≤550,2≤|a|≤36,-36≤l≤r≤36$.\n\nIt is guaranteed that in all testdata, the absolute value of the price will not exceed $2^{63}-1$, and the length of the fractional-part string (before and after conversion) will not exceed $\\left\\lfloor\\log_{|a|}2^{62}\\right\\rfloor$ ($a$ is the base; the parentheses are not counted in the length).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "转换", "background": "$\\rm hdxrie\\ $最近在为新建的宇宙购物中心编写价格系统。", "description": "购物中心汇聚了来自各个星球的商品，但是由于不同的星球采用的进制各不相同，导致商品价格计算起来比较困难，因此价格系统是必不可少的。\n\n由于甲方所给的期限太短，$\\rm hdxrie\\ $便找到你来做他的助手，他只需要你帮忙编写一个进制转换的程序就行，其它的各个系统版块全部由他自己负责，你能在规定期限内写出转换程序吗？", "inputFormat": "第一行一个数$n$，$n$表示有多少个物品的价格需要转换。\n\n接下来$n$行，每行三个数字$a,l,r$和一个价格串$S$。\n\n$a$表示这个价格串为$a$进制数（保证$a$不为$-1,0,1$），你需要把它转化为$l$到$r$的所有进制（请自动跳过输出为$-1,0,1$这些进制的情况）。\n\n由于价格为实数，所以难免会出现小数，并且若一个小数为循环小数，我们会将小数的循环节使用 <,> 括起来。\n\n如果不是循环小数则没有尖括号，如果没有小数部分则没有小数点，保证不会出现尖括号之间没有数字情况。\n\n保证循环节以及循环节前面的小数部分都是最短的，例如$10$进制下的$0.123123\\cdots$，那么所给的读入形式为$0.$<$123$>，保证不会出现类似于$0.1$<$231$>或$0.$<$123123$>这些情况。\n\n对于正进制$a$，保证不会出现循环节为$a-1$的情况，例如$10$进制不会出现$0.$<$9$>这样的输入，但是负进制没有这样的要求。\n\n为了方便转换，当用正进制表示负数的时候，规定在价格前加上负号，但是由于负进制既可表示正数也可表示负数，所以规定负进制前不允许出现负号。\n\n规定任意进制的每一位不能为负，规定大于$9$的值按照大写字母从小到大编写。", "outputFormat": "对于每一个需要转换的价格，在给定范围内按进制从小到大的顺序输出转换为该进制后的价格串（请自动跳过输出为$-1,0,1$这些进制的情况）。\n\n对于输出格式你也应该严格按照上面输入格式的要求输出每一个价格串。", "hint": "- 对于$5\\%$的数据，保证没有小数部分，$1≤n≤20,2≤a≤36,2≤l≤r≤36$；\n\n- 对于$15\\%$的数据，保证没有小数部分，$1≤n≤100,2≤|a|≤36,-36≤l≤r≤36$；\n\n- 另有$15\\%$的数据，保证转换前和转换后都是有限小数，$1≤n≤550,2≤a≤36,2≤l≤r≤36$；\n\n- 另有$20\\%$的数据，$1≤n≤550,2≤a≤36,2≤l≤r≤36$；\n\n- 对于$100\\%$的数据，$1≤n≤550,2≤|a|≤36,-36≤l≤r≤36$；\n\n保证所有数据中，价格的绝对值都不会超过$2^{63}-1$，且转换前和转换后的小数部分的字符串长度均不超过$\\left\\lfloor\\log_{|a|}2^{62}\\right\\rfloor$（$a$表示进制，括号不计入长度）。", "locale": "zh-CN"}}}
{"pid": "P4985", "type": "P", "difficulty": 0, "samples": [["1 3\n1 2 1 5\n8 1 7\n1 4 5 3 5 5 0\n2 4 5 5 5 5\n1 5 6 6 6 5 1\n", "25"], ["1 11\n0 2 1 10\n17 3 11\n0 1 2 6\n1 3 5 5 4 30 0\n1 4 7 4 6 10 1\n2 4 8 7 6 14\n1 7 10 2 9 10 0\n1 8 11 10 9 14 1\n1 11 13 7 12 10 0\n2 11 13 5 12 14\n1 11 13 1 12 10 0\n2 13 14 8 14 6\n1 13 15 3 14 10 0\n", "242"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["搜索", "O2优化", "图论建模", "期望"], "title": "反射", "background": "最近$\\rm \\ TimeTraveller\\ $玩了一个十分好玩的游戏，通过摆放能量发射器，来攻击敌人的飞船。\n\n但是$\\rm \\ TimeTraveller\\ $十分手残~~以及脑残~~，总是玩不过十分简单的关卡，所以他想请你帮助他。", "description": "这个游戏是这样的，你有$k$个$\\alpha$能量发射器启动器，可以启动任何$k$个在一个初始平台上$\\alpha$发射器，然后$\\alpha$发射器会向北偏东$45^\\circ$方向上发射能量光束，能量值为$\\alpha_i$。在有场地里面有$n$块悬浮的平台，这些平台上有的装有两种能量发射器$\\alpha$发射器和$\\beta$发射器的其中一种，功能如下：\n\n- 对于$\\alpha$发射器，如果它装在平台上方，它会向北偏东$45^\\circ$方向上发射能量光束，能量值为$\\alpha_i$；如果装在下方，它会向南偏东$45^\\circ$方向上发射能量光束，能量值为$\\alpha_i$。\n\n- 对于$\\beta$发射器，不管装在什么地方它会同时向北偏东$45^\\circ$和南偏东$45^\\circ$发射能量光束，能量值为$\\beta_i$。\n\n但是，悬浮平台上的发射器并不会自己启动，必须在有能量光束击中它所在的平台上时才会启动，且这个发射器发射的能量为给定的值（注意一束光击中这些平台，只有在这个能量光束的来的路径上没有该击中平台提供的能量时这些平台的发射器就会启动，每被击中一次就发射一次，如下图，1号发射给2号2号激活，其中一个击回1号，此时1号不会再发射一次（也就是能量不会再次叠加））\n\n![](https://cdn.luogu.com.cn/upload/pic/37869.png)\n\n\n你在最开始只能启动初始平台上的能量发射器中的$k$个（这$k$个是依次启动的，且每个只能发射一次，但是其它地方的发射器可以发射多次）。\n\n将地图抽象为二维平面直角坐标系，其中$x=0$的直线为地面（光束到达地面会消失,但是如果地面有平台则优先击中平台），那么所有的平台包括初始平台均平行于$x$轴，敌人的飞船可以看做为一个平行于$y$轴的，两个端点为$(wx,sy)$和$(wx,ty)$，当一条光束击中飞船它便会受到光束来的这条路径上的所有能量值的和的伤害然后光束就会消失。（光束击中其它平台并不会反弹，而是会被平台吸收作为能量来启动发射器）。\n\n请你求出在启动哪些开始的$\\alpha$发射器，使得让飞船受到的伤害最大，请你求出这个最大值。\n", "inputFormat": "第一行两个正整数$k,n$，表示你能启动$k$个开始的发射器，总共有$n$个平台。\n第二行四个整数$x_1,x_2,y,v$，表示初始平台位置，初始平台上每一个整点有一个$\\alpha$发射器能发射初始能量为$v$的能量光束（如$x_1=1,x_2=3,y=1$时，有$(1,1),(2,1),(3,1)$三个初始位置的$\\alpha$发射器）。\n第三行三个整数$wx,sy,ty$，表示敌人飞船位置。\n下面$n$行，每行描述了一个平台，格式如下：\n\n- $0\\ x_l\\ x_r\\ y$表示一个空的平台\n- $1\\ x_l\\ x_r\\ y\\ x_p\\ w_i\\ 0/1$表示在$(x_p,y)$的位置一个$\\alpha$发射器在$(x_l,y)\\sim (x_r,y)$的平台上，发射能量为$w_i$，最后的$0$或$1$表示在平台的上方还是下方，$0$为上方，$1$为下方。\n- $2\\ x_l\\ x_r\\ y\\ x_p\\ w_i$表示在$(x_p,y)$的位置一个$\\beta$发射器在$(x_l,y)\\sim (x_r,y)$的平台上，发射能量为$w_i$。\n", "outputFormat": "一行一个整数表示最大的伤害值。", "hint": "#### 样例解释：\n\n样例$1$如图：\n\n![](https://cdn.luogu.com.cn/upload/pic/37557.png)\n\n最优为橙色那个$25$，绿色的为$10$。\n\n样例$2$如图：\n\n![](https://cdn.luogu.com.cn/upload/pic/37430.png)\n\n只有橙色那条打出来为$242$，其他两条只有$98$。\n\n#### 数据范围：\n\n- 对于$30\\%$的数据$0\\leq n\\leq 20,1\\leq k\\leq 3$；\n- 对于$40\\%$的数据所有平台（不包括飞船）的长度和不超过$10^6$；\n- 对于$60\\%$的数据$0\\leq n\\leq 200,1\\leq k\\leq 50$；\n- 对于$70\\%$的数据$0\\leq n\\leq 2000,1\\leq k\\leq 2000$；\n- 对于$100\\%$的数据$0\\leq n\\leq 20000,0\\leq k\\leq 20000$，坐标$0 \\leq y\\leq 10^9$的，坐标$0\\leq x\\leq 10^9$，所有的能量值的值均在$0\\sim 10^4$内，且保证每个发射器必定在一个平台上，且平台长度与敌人飞船的长度大于等于$1$。保证最开始的平台长度不超过$10^5$，且所有的平台不会重叠；\n\n- 还有$20\\%$的额外数据同$100\\%$，只是$n\\leq 10^6$；\n\n输入较大，建议使用较快的读入方式。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "Reflection.", "background": "Recently, $\\rm \\ TimeTraveller\\ $ played a very fun game. By placing energy emitters, he attacks the enemies’ spaceship.\n\nBut $\\rm \\ TimeTraveller\\ $ is very clumsy ~~and also kind of silly~~, and he always cannot beat even very easy levels, so he wants you to help him.", "description": "The game works like this. You have $k$ $\\alpha$-emitter activators. They can activate any $k$ $\\alpha$ emitters on an initial platform. Each activated $\\alpha$ emitter will shoot an energy beam toward $45^\\circ$ northeast, with energy value $\\alpha_i$. In the field there are $n$ floating platforms. Some of these platforms have one of two kinds of energy emitters installed: an $\\alpha$ emitter or a $\\beta$ emitter, with the following functions:\n\n- For an $\\alpha$ emitter: if it is installed on the upper side of the platform, it shoots an energy beam toward $45^\\circ$ northeast, with energy value $\\alpha_i$; if it is installed on the lower side, it shoots an energy beam toward $45^\\circ$ southeast, with energy value $\\alpha_i$.\n\n- For a $\\beta$ emitter: no matter where it is installed, it shoots energy beams toward both $45^\\circ$ northeast and $45^\\circ$ southeast at the same time, with energy value $\\beta_i$.\n\nHowever, emitters on floating platforms do not activate by themselves. They will be activated only when an energy beam hits the platform they are on, and the energy they shoot is the given value. (Note: when a beam hits such a platform, the platform’s emitter will activate only if, on the path the beam traveled to reach this platform, there was no energy provided by the emitter on this platform. Each time it is hit, it shoots once. As in the figure below, emitter $1$ shoots to platform $2$, activating emitter $2$; then one of its beams hits back to platform $1$. At this time, emitter $1$ will not shoot again (that is, the energy will not be added again).)\n\n![](https://cdn.luogu.com.cn/upload/pic/37869.png)\n\nAt the beginning, you can only activate $k$ emitters among the $\\alpha$ emitters on the initial platform (these $k$ are activated one by one, and each can shoot only once, but emitters elsewhere can shoot multiple times).\n\nAbstract the map as a 2D Cartesian coordinate system. The line $x=0$ is the ground (a beam disappears when it reaches the ground, but if there is a platform on the ground then it hits the platform first). All platforms, including the initial platform, are parallel to the $x$-axis. The enemy spaceship can be viewed as a segment parallel to the $y$-axis with endpoints $(wx,sy)$ and $(wx,ty)$. When a beam hits the spaceship, it takes damage equal to the sum of all energy values on the path that the beam traveled, and then the beam disappears. (A beam hitting other platforms does not reflect; instead, it is absorbed by the platform as energy to activate the emitter.)\n\nPlease determine which initial $\\alpha$ emitters to activate so that the damage dealt to the spaceship is maximized, and output this maximum value.", "inputFormat": "The first line contains two positive integers $k,n$, meaning you can activate $k$ initial emitters, and there are $n$ platforms in total.  \nThe second line contains four integers $x_1,x_2,y,v$, describing the initial platform. On this platform, at every integer coordinate point, there is an $\\alpha$ emitter that can shoot an energy beam with initial energy $v$ (for example, when $x_1=1,x_2=3,y=1$, there are three initial $\\alpha$ emitters at $(1,1),(2,1),(3,1)$).  \nThe third line contains three integers $wx,sy,ty$, describing the position of the enemy spaceship.  \nThe next $n$ lines each describe one platform in the following formats:\n\n- $0\\ x_l\\ x_r\\ y$ represents an empty platform.\n- $1\\ x_l\\ x_r\\ y\\ x_p\\ w_i\\ 0/1$ represents an $\\alpha$ emitter at position $(x_p,y)$ on the platform $(x_l,y)\\sim (x_r,y)$, with emitted energy $w_i$. The last $0$ or $1$ indicates whether it is on the upper side or the lower side: $0$ means upper side, $1$ means lower side.\n- $2\\ x_l\\ x_r\\ y\\ x_p\\ w_i$ represents a $\\beta$ emitter at position $(x_p,y)$ on the platform $(x_l,y)\\sim (x_r,y)$, with emitted energy $w_i$.", "outputFormat": "One line with one integer, the maximum damage value.", "hint": "#### Sample Explanation:\n\nFor sample $1$, as shown:\n\n![](https://cdn.luogu.com.cn/upload/pic/37557.png)\n\nThe best choice is the orange one with $25$, while the green one is $10$.\n\nFor sample $2$, as shown:\n\n![](https://cdn.luogu.com.cn/upload/pic/37430.png)\n\nOnly the orange beam can deal $242$; the other two only deal $98$.\n\n#### Constraints:\n\n- For $30\\%$ of the data: $0\\leq n\\leq 20,1\\leq k\\leq 3$.\n- For $40\\%$ of the data: the total length of all platforms (excluding the spaceship) does not exceed $10^6$.\n- For $60\\%$ of the data: $0\\leq n\\leq 200,1\\leq k\\leq 50$.\n- For $70\\%$ of the data: $0\\leq n\\leq 2000,1\\leq k\\leq 2000$.\n- For $100\\%$ of the data: $0\\leq n\\leq 20000,0\\leq k\\leq 20000$, coordinates satisfy $0 \\leq y\\leq 10^9$ and $0\\leq x\\leq 10^9$. All energy values are within $0\\sim 10^4$. It is guaranteed that every emitter is on some platform, and the length of each platform and the length of the enemy spaceship are at least $1$. It is guaranteed that the initial platform length does not exceed $10^5$, and no platforms overlap.\n- There is an additional $20\\%$ of testdata with the same constraints as $100\\%$, except $n\\leq 10^6$.\n\nThe input is large, so a fast input method is recommended.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "反射", "background": "最近$\\rm \\ TimeTraveller\\ $玩了一个十分好玩的游戏，通过摆放能量发射器，来攻击敌人的飞船。\n\n但是$\\rm \\ TimeTraveller\\ $十分手残~~以及脑残~~，总是玩不过十分简单的关卡，所以他想请你帮助他。", "description": "这个游戏是这样的，你有$k$个$\\alpha$能量发射器启动器，可以启动任何$k$个在一个初始平台上$\\alpha$发射器，然后$\\alpha$发射器会向北偏东$45^\\circ$方向上发射能量光束，能量值为$\\alpha_i$。在有场地里面有$n$块悬浮的平台，这些平台上有的装有两种能量发射器$\\alpha$发射器和$\\beta$发射器的其中一种，功能如下：\n\n- 对于$\\alpha$发射器，如果它装在平台上方，它会向北偏东$45^\\circ$方向上发射能量光束，能量值为$\\alpha_i$；如果装在下方，它会向南偏东$45^\\circ$方向上发射能量光束，能量值为$\\alpha_i$。\n\n- 对于$\\beta$发射器，不管装在什么地方它会同时向北偏东$45^\\circ$和南偏东$45^\\circ$发射能量光束，能量值为$\\beta_i$。\n\n但是，悬浮平台上的发射器并不会自己启动，必须在有能量光束击中它所在的平台上时才会启动，且这个发射器发射的能量为给定的值（注意一束光击中这些平台，只有在这个能量光束的来的路径上没有该击中平台提供的能量时这些平台的发射器就会启动，每被击中一次就发射一次，如下图，1号发射给2号2号激活，其中一个击回1号，此时1号不会再发射一次（也就是能量不会再次叠加））\n\n![](https://cdn.luogu.com.cn/upload/pic/37869.png)\n\n\n你在最开始只能启动初始平台上的能量发射器中的$k$个（这$k$个是依次启动的，且每个只能发射一次，但是其它地方的发射器可以发射多次）。\n\n将地图抽象为二维平面直角坐标系，其中$x=0$的直线为地面（光束到达地面会消失,但是如果地面有平台则优先击中平台），那么所有的平台包括初始平台均平行于$x$轴，敌人的飞船可以看做为一个平行于$y$轴的，两个端点为$(wx,sy)$和$(wx,ty)$，当一条光束击中飞船它便会受到光束来的这条路径上的所有能量值的和的伤害然后光束就会消失。（光束击中其它平台并不会反弹，而是会被平台吸收作为能量来启动发射器）。\n\n请你求出在启动哪些开始的$\\alpha$发射器，使得让飞船受到的伤害最大，请你求出这个最大值。\n", "inputFormat": "第一行两个正整数$k,n$，表示你能启动$k$个开始的发射器，总共有$n$个平台。\n第二行四个整数$x_1,x_2,y,v$，表示初始平台位置，初始平台上每一个整点有一个$\\alpha$发射器能发射初始能量为$v$的能量光束（如$x_1=1,x_2=3,y=1$时，有$(1,1),(2,1),(3,1)$三个初始位置的$\\alpha$发射器）。\n第三行三个整数$wx,sy,ty$，表示敌人飞船位置。\n下面$n$行，每行描述了一个平台，格式如下：\n\n- $0\\ x_l\\ x_r\\ y$表示一个空的平台\n- $1\\ x_l\\ x_r\\ y\\ x_p\\ w_i\\ 0/1$表示在$(x_p,y)$的位置一个$\\alpha$发射器在$(x_l,y)\\sim (x_r,y)$的平台上，发射能量为$w_i$，最后的$0$或$1$表示在平台的上方还是下方，$0$为上方，$1$为下方。\n- $2\\ x_l\\ x_r\\ y\\ x_p\\ w_i$表示在$(x_p,y)$的位置一个$\\beta$发射器在$(x_l,y)\\sim (x_r,y)$的平台上，发射能量为$w_i$。\n", "outputFormat": "一行一个整数表示最大的伤害值。", "hint": "#### 样例解释：\n\n样例$1$如图：\n\n![](https://cdn.luogu.com.cn/upload/pic/37557.png)\n\n最优为橙色那个$25$，绿色的为$10$。\n\n样例$2$如图：\n\n![](https://cdn.luogu.com.cn/upload/pic/37430.png)\n\n只有橙色那条打出来为$242$，其他两条只有$98$。\n\n#### 数据范围：\n\n- 对于$30\\%$的数据$0\\leq n\\leq 20,1\\leq k\\leq 3$；\n- 对于$40\\%$的数据所有平台（不包括飞船）的长度和不超过$10^6$；\n- 对于$60\\%$的数据$0\\leq n\\leq 200,1\\leq k\\leq 50$；\n- 对于$70\\%$的数据$0\\leq n\\leq 2000,1\\leq k\\leq 2000$；\n- 对于$100\\%$的数据$0\\leq n\\leq 20000,0\\leq k\\leq 20000$，坐标$0 \\leq y\\leq 10^9$的，坐标$0\\leq x\\leq 10^9$，所有的能量值的值均在$0\\sim 10^4$内，且保证每个发射器必定在一个平台上，且平台长度与敌人飞船的长度大于等于$1$。保证最开始的平台长度不超过$10^5$，且所有的平台不会重叠；\n\n- 还有$20\\%$的额外数据同$100\\%$，只是$n\\leq 10^6$；\n\n输入较大，建议使用较快的读入方式。\n\n", "locale": "zh-CN"}}}
{"pid": "P4986", "type": "P", "difficulty": 6, "samples": [["1 1 1 -2.00 0.50 \n1 2 \n1 3 \n4 1 \n", "-1.16666667"], ["1 1 1 -1.00 0.50 \n1 2 \n1 3 \n4 1 \n", "Inconsistent!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["数学", "Special Judge", "O2优化", "导数", "快速傅里叶变换 FFT"], "title": "逃离", "background": "$\\ \\rm Althen\\ $和$\\ \\rm hdxrie\\ $掉入了二维空间。", "description": "其实这个空间并不是无限的，而是半径有限的圆盘。\n\n起初，他们两个都在圆心处，为了找到出口，他们两个决定分开行动，只要找到出口，便会离开。不过，若是其中一个人找到了出口，另一个还在二维空间内，那么这个空间就会因为不平衡而崩塌。所以他们两个只能一起离开。\n\n其中：\n- $\\rm Althen\\ $ 可以拐弯，还会一直拐来拐去，不过只能水平或者竖直移动。\n- $\\rm hdxrie\\ $ 只能沿任意一条直线走，不能拐弯。\n\n$\\rm Althen\\ $ 全程在水平向右的平均速度可以用函数 $A(x)$ 表示，在竖直向上的平均速度可以用函数 $B(x)$ 表示。$\\rm hdxrie\\ $ 全程移动的平均速度可以用函数 $C(x)$ 表示。而参数 $x$的取值范围也有讲究，为 $[L,R]$。\n\n现在，他们两个想问你，他们有可能一起离开这个二维空间吗？如果可以，这个参数 $x$ 的值可以是多少？\n\n", "inputFormat": "输入共四行。\n\n第一行三个整数：$La$，$Lb$，$Lc$，和两个实数：$L$，$R$；\n分别代表三个函数的长度和参数 $x$ 的取值范围。\n\n第二行 $\\ La+1\\ $ 个整数，按升幂表示 $A(x)$ 的系数。  \n第二行 $\\ Lb+1\\ $ 个整数，按升幂表示 $B(x)$ 的系数。  \n第二行 $\\ Lc+1\\ $ 个整数，按升幂表示 $C(x)$ 的系数。\n", "outputFormat": "若有解，输出一行一个实数表示答案；否则输出 `Inconsistent!`。", "hint": "【数据范围】   \n对于$10\\%$的数据，$L=R$；  \n另有$20\\%$的数据，$La=Lb=Lc=1$；  \n另有$30\\%$的数据，$[L,R]$ 内最多只有一个参数 $x$ 合法；  \n对于$100\\%$的数据，$0≤La,Lb,Lc≤10^5$，$0≤a_i,b_i,c_i≤9$，$L≤R$，$|L|,|R|≤3$；  \n\n答案精确度需要保证带入原来的三个函数，合法误差不超过 $10^{-5}$，误差若是大于 $10^{-5}$ 会判断为错误答案，建议输出 **保留八位以上小数**。\n\n###### $\\color{#EEE}{\\tt {Notice\\ that\\ SPEED\\ is\\ VECTOR.(High\\ school\\ physics)}}$", "locale": "zh-CN", "translations": {"en": {"title": "Escape.", "background": "$\\ \\rm Althen\\ $ and $\\ \\rm hdxrie\\ $ fell into a two-dimensional space.", "description": "In fact, this space is not infinite, but a disk with a finite radius.\n\nAt the beginning, both of them are at the center of the circle. To find the exit, they decide to act separately. As long as one of them finds the exit, they will leave. However, if one person finds the exit while the other is still in the two-dimensional space, the space will collapse due to imbalance. So they can only leave together.\n\nSpecifically:\n- $\\rm Althen\\ $ can turn, and will keep turning, but can only move horizontally or vertically.\n- $\\rm hdxrie\\ $ can only walk along any straight line and cannot turn.\n\nFor $\\rm Althen\\ $, the average speed in the horizontal right direction during the whole process is given by the function $A(x)$, and the average speed in the vertical upward direction is given by the function $B(x)$. For $\\rm hdxrie\\ $, the average speed of the whole movement is given by the function $C(x)$. The range of the parameter $x$ is $[L,R]$.\n\nNow they want to ask you: is it possible for them to leave this two-dimensional space together? If yes, what values of the parameter $x$ are possible?", "inputFormat": "The input consists of four lines.\n\nThe first line contains three integers: $La$, $Lb$, $Lc$, and two real numbers: $L$, $R$, representing the degrees of the three functions and the range of the parameter $x$.\n\nThe second line contains $\\ La+1\\ $ integers, representing the coefficients of $A(x)$ in increasing order of power.  \nThe third line contains $\\ Lb+1\\ $ integers, representing the coefficients of $B(x)$ in increasing order of power.  \nThe fourth line contains $\\ Lc+1\\ $ integers, representing the coefficients of $C(x)$ in increasing order of power.", "outputFormat": "If there is a solution, output one real number on a single line as the answer; otherwise output `Inconsistent!`.", "hint": "【Constraints】  \nFor $10\\%$ of the testdata, $L=R$.  \nFor another $20\\%$ of the testdata, $La=Lb=Lc=1$.  \nFor another $30\\%$ of the testdata, there is at most one valid parameter $x$ in $[L,R]$.  \nFor $100\\%$ of the testdata, $0≤La,Lb,Lc≤10^5$, $0≤a_i,b_i,c_i≤9$, $L≤R$, $|L|,|R|≤3$.\n\nThe answer precision must guarantee that, after substituting into the original three functions, the allowed error does not exceed $10^{-5}$. If the error is greater than $10^{-5}$, it will be judged as a wrong answer. It is recommended to output **at least eight digits after the decimal point**.\n\n###### $\\color{#EEE}{\\tt {Notice\\ that\\ SPEED\\ is\\ VECTOR.(High\\ school\\ physics)}}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "逃离", "background": "$\\ \\rm Althen\\ $和$\\ \\rm hdxrie\\ $掉入了二维空间。", "description": "其实这个空间并不是无限的，而是半径有限的圆盘。\n\n起初，他们两个都在圆心处，为了找到出口，他们两个决定分开行动，只要找到出口，便会离开。不过，若是其中一个人找到了出口，另一个还在二维空间内，那么这个空间就会因为不平衡而崩塌。所以他们两个只能一起离开。\n\n其中：\n- $\\rm Althen\\ $ 可以拐弯，还会一直拐来拐去，不过只能水平或者竖直移动。\n- $\\rm hdxrie\\ $ 只能沿任意一条直线走，不能拐弯。\n\n$\\rm Althen\\ $ 全程在水平向右的平均速度可以用函数 $A(x)$ 表示，在竖直向上的平均速度可以用函数 $B(x)$ 表示。$\\rm hdxrie\\ $ 全程移动的平均速度可以用函数 $C(x)$ 表示。而参数 $x$的取值范围也有讲究，为 $[L,R]$。\n\n现在，他们两个想问你，他们有可能一起离开这个二维空间吗？如果可以，这个参数 $x$ 的值可以是多少？\n\n", "inputFormat": "输入共四行。\n\n第一行三个整数：$La$，$Lb$，$Lc$，和两个实数：$L$，$R$；\n分别代表三个函数的长度和参数 $x$ 的取值范围。\n\n第二行 $\\ La+1\\ $ 个整数，按升幂表示 $A(x)$ 的系数。  \n第二行 $\\ Lb+1\\ $ 个整数，按升幂表示 $B(x)$ 的系数。  \n第二行 $\\ Lc+1\\ $ 个整数，按升幂表示 $C(x)$ 的系数。\n", "outputFormat": "若有解，输出一行一个实数表示答案；否则输出 `Inconsistent!`。", "hint": "【数据范围】   \n对于$10\\%$的数据，$L=R$；  \n另有$20\\%$的数据，$La=Lb=Lc=1$；  \n另有$30\\%$的数据，$[L,R]$ 内最多只有一个参数 $x$ 合法；  \n对于$100\\%$的数据，$0≤La,Lb,Lc≤10^5$，$0≤a_i,b_i,c_i≤9$，$L≤R$，$|L|,|R|≤3$；  \n\n答案精确度需要保证带入原来的三个函数，合法误差不超过 $10^{-5}$，误差若是大于 $10^{-5}$ 会判断为错误答案，建议输出 **保留八位以上小数**。\n\n###### $\\color{#EEE}{\\tt {Notice\\ that\\ SPEED\\ is\\ VECTOR.(High\\ school\\ physics)}}$", "locale": "zh-CN"}}}
{"pid": "P4987", "type": "P", "difficulty": 5, "samples": [["16 1\nXIAOMAITAIBANGLE", "16"], ["4 3\nABAB", "4"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创"], "title": "回文项链", "background": "**数据已增强，各位不要再交暴力了。**\n\n国庆节期间，哥哥送了小埋一条项链。（假的，日本人过什么国庆。）\n\n然而小埋不太开心，她更想要买一部新手机玩游戏。", "description": "不过小埋很快发现了项链的神奇之处。\n\n我们把项链看作一个$n$元环，记作$s$，环上每个结点由大写'A'-'Z'中的一个字母组成。小埋惊奇的发现，环上有很多回文串！我们定义回文串为环上一个首尾不重叠的连续子串（即环上每个结点最多被使用一次），且满足**存在一个回文中心**$i$，使得$i$之前的若干个字符分别与其关于$i$中心对称的字符相同。\n\n现在，小埋给出你这个环，并希望知道有多少长度为$l$的本质不同的回文串；我们认为两个回文串本质不同，当且仅当它们回文中心所在结点不同。", "inputFormat": "第一行，两个数表示$n$，$l$；\n\n接下来一行读入连续的$n$个字母，分别表示$s_1$，$s_2$，…，$s_n$；其中$s_i$与$s_i$ $_{mod}$ $_{n+1}$相邻。", "outputFormat": "一行，表示长度为$l$的回文串的个数。", "hint": "**本题每个测试点时限500ms**\n\n对于$30$%的数据，$n<=20$；\n\n对于$50$%的数据，$n<=200$；\n\n对于$80$%的数据，$n<=2000$；\n\n对于$100$%的数据，$n<=10^6$，$0<l<=n$且$l$为奇数。\n\n**仔细读题，本题回文串与传统意义上的回文串不同。**", "locale": "zh-CN", "translations": {"en": {"title": "Palindrome Necklace", "background": "**The testdata has been strengthened. Please do not submit brute force solutions anymore.**\n\nDuring the National Day holiday, Big Brother gave Xiaomai a necklace. (Fake. Why would Japanese people celebrate National Day?)\n\nHowever, Xiaomai was not very happy. She would rather buy a new phone to play games.", "description": "But Xiaomai soon discovered something magical about the necklace.\n\nWe treat the necklace as an $n$-node cycle, denoted by $s$. Each node on the cycle is a letter from uppercase 'A' to 'Z'. Xiaomai was surprised to find that there are many palindromic strings on the cycle! We define a palindrome as a continuous substring on the cycle whose start and end do not overlap (that is, each node on the cycle can be used at most once), and it satisfies **that there exists a palindrome center** $i$ such that the characters before $i$ are respectively equal to the characters symmetric to them with respect to the center $i$.\n\nNow, Xiaomai gives you this cycle and wants to know how many essentially different palindromes of length $l$ there are. We consider two palindromes essentially different if and only if the nodes where their palindrome centers are located are different.", "inputFormat": "The first line contains two integers $n$, $l$.\n\nThe next line contains $n$ consecutive letters, representing $s_1$, $s_2$, …, $s_n$. Here, $s_i$ is adjacent to $s_i$ $_{mod}$ $_{n+1}$.", "outputFormat": "Output one line containing the number of palindromes of length $l$.", "hint": "**The time limit for each test point is 500 ms.**\n\nFor $30$% of the data, $n<=20$.\n\nFor $50$% of the data, $n<=200$.\n\nFor $80$% of the data, $n<=2000$.\n\nFor $100$% of the data, $n<=10^6$, $0<l<=n$, and $l$ is odd.\n\n**Read the problem carefully. The palindrome in this problem is different from the palindrome in the traditional sense.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "回文项链", "background": "**数据已增强，各位不要再交暴力了。**\n\n国庆节期间，哥哥送了小埋一条项链。（假的，日本人过什么国庆。）\n\n然而小埋不太开心，她更想要买一部新手机玩游戏。", "description": "不过小埋很快发现了项链的神奇之处。\n\n我们把项链看作一个$n$元环，记作$s$，环上每个结点由大写'A'-'Z'中的一个字母组成。小埋惊奇的发现，环上有很多回文串！我们定义回文串为环上一个首尾不重叠的连续子串（即环上每个结点最多被使用一次），且满足**存在一个回文中心**$i$，使得$i$之前的若干个字符分别与其关于$i$中心对称的字符相同。\n\n现在，小埋给出你这个环，并希望知道有多少长度为$l$的本质不同的回文串；我们认为两个回文串本质不同，当且仅当它们回文中心所在结点不同。", "inputFormat": "第一行，两个数表示$n$，$l$；\n\n接下来一行读入连续的$n$个字母，分别表示$s_1$，$s_2$，…，$s_n$；其中$s_i$与$s_i$ $_{mod}$ $_{n+1}$相邻。", "outputFormat": "一行，表示长度为$l$的回文串的个数。", "hint": "**本题每个测试点时限500ms**\n\n对于$30$%的数据，$n<=20$；\n\n对于$50$%的数据，$n<=200$；\n\n对于$80$%的数据，$n<=2000$；\n\n对于$100$%的数据，$n<=10^6$，$0<l<=n$且$l$为奇数。\n\n**仔细读题，本题回文串与传统意义上的回文串不同。**", "locale": "zh-CN"}}}
{"pid": "P4988", "type": "P", "difficulty": 6, "samples": [["3 3 2", "1"], ["3 8 2", "INF"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "O2优化"], "title": "重排DL", "background": "Dancing Line 的关卡排序总是很玄学。", "description": "这天小埋给 Dancing Line 中关卡排序制定了一个新的规则：假设某一关为第 $n$ 个发布的关卡，那么它的位置 $a_n$ 满足 $a_{n+1}=(\\sqrt[k]{a_n-n}+2)^k+n+1$，且第一个发布的关卡总是排在第一，即 $a_1=2$。\n\n但是这样显然会出现一个问题：许多位置是空关卡。所以小埋又给出了一个限制条件：调整 $k$，使得第 $n$ 个关卡满足 $a_n \\equiv b\\pmod{m}$。现在小埋给了 $n,m,b$，求最小满足条件的**整数** $k$。", "inputFormat": "第一行，三个数 $n,m,b$。", "outputFormat": "一个数，表示最小的 $k$；如果不存在最小 $k$，则输出 `INF`。", "hint": "对于 $30\\%$ 的数据，$n\\le 100$，$0\\le b<m\\le 10000$；\n\n对于 $50\\%$ 的数据，$n\\le 10^{12}$，$0\\le b<m\\le 10000$；\n\n对于 $100\\%$ 的数据，$n\\le 10^{12}$，$0\\le b<m\\le 10^{12}$。\n\n保证 $n,m,b$ 均为正整数。", "locale": "zh-CN", "translations": {"en": {"title": "Rearranging DL.", "background": "The level order in Dancing Line always feels kind of random.", "description": "On this day, Umaru set a new rule for the level order in Dancing Line: suppose a certain level is the $n$-th released level, then its position $a_n$ satisfies $a_{n+1}=(\\sqrt[k]{a_n-n}+2)^k+n+1$, and the first released level is always placed first, i.e., $a_1=2$.\n\nBut this clearly causes a problem: many positions will be empty levels. So Umaru added another restriction: adjust $k$ so that the $n$-th level satisfies $a_n \\equiv b\\pmod{m}$. Now Umaru gives $n,m,b$, and you need to find the smallest **integer** $k$ that satisfies the condition.", "inputFormat": "The first line contains three numbers $n,m,b$.", "outputFormat": "Output one number, representing the smallest $k$; if the smallest $k$ does not exist, output `INF`.", "hint": "For $30\\%$ of the testdata, $n\\le 100$, $0\\le b<m\\le 10000$.\n\nFor $50\\%$ of the testdata, $n\\le 10^{12}$, $0\\le b<m\\le 10000$.\n\nFor $100\\%$ of the testdata, $n\\le 10^{12}$, $0\\le b<m\\le 10^{12}$.\n\nIt is guaranteed that $n,m,b$ are all positive integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "重排DL", "background": "Dancing Line 的关卡排序总是很玄学。", "description": "这天小埋给 Dancing Line 中关卡排序制定了一个新的规则：假设某一关为第 $n$ 个发布的关卡，那么它的位置 $a_n$ 满足 $a_{n+1}=(\\sqrt[k]{a_n-n}+2)^k+n+1$，且第一个发布的关卡总是排在第一，即 $a_1=2$。\n\n但是这样显然会出现一个问题：许多位置是空关卡。所以小埋又给出了一个限制条件：调整 $k$，使得第 $n$ 个关卡满足 $a_n \\equiv b\\pmod{m}$。现在小埋给了 $n,m,b$，求最小满足条件的**整数** $k$。", "inputFormat": "第一行，三个数 $n,m,b$。", "outputFormat": "一个数，表示最小的 $k$；如果不存在最小 $k$，则输出 `INF`。", "hint": "对于 $30\\%$ 的数据，$n\\le 100$，$0\\le b<m\\le 10000$；\n\n对于 $50\\%$ 的数据，$n\\le 10^{12}$，$0\\le b<m\\le 10000$；\n\n对于 $100\\%$ 的数据，$n\\le 10^{12}$，$0\\le b<m\\le 10^{12}$。\n\n保证 $n,m,b$ 均为正整数。", "locale": "zh-CN"}}}
{"pid": "P4989", "type": "P", "difficulty": 5, "samples": [["2\n10", "0"], ["6\n110100", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["洛谷原创"], "title": "二进制之谜", "background": "虽然过了$Faded$，但是小埋还是没有解出二进制之谜。", "description": "这个时候，她感觉到了$0$与$1$存在的某种可能的特殊对应关系。于是，她定义了“启发系数”：对应的两个数位数（按从高位到低位顺序去数）的差的绝对值；她现在希望将$0$与$1$进行对应使得**在对应关系最多的前提下**，启发系数之和最大。\n\n对应规则如下：\n\n$1$.对应关系必须从$0$开始，以$1$结束；换句话说，每个对应关系必须$0$在前（高位），$1$在后（低位）；\n\n$2$.可以取若干个对应关系，但对应关系之间**不能交叉**；**交叉**的含义是：共用某个区间且不是包含关系；\n\n$e.g.$ 假设一个对应关系为第$2$位数与第$4$位数，另一个对应关系为第$3$位数与第$5$位数，那么它们不可同时取，因为在区间$[3,4]$交叉；但是若对应关系分别为第$1$、$5$位数与第$2$、$4$位数，则不算作交叉，因为它们虽然共用区间$[2,4]$但存在包含关系，可以同时取。\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/38793.png)\n\n这即是说，**交叉不等于交集**。\n\n$3$.每个数最多只能存在于一个对应关系中。", "inputFormat": "第一行，一个整数$n$，为二进制数的位数；\n\n接下来一行，输入一个$n$位二进制数。", "outputFormat": "一行，表示对应关系最多的前提下最大的启发系数之和。", "hint": "对于$30$%的数据，$0<n<=20$；\n\n对于$100$%的数据，$0<n<=300$；\n\n**样例说明**\n\n对于样例一，由于$1$在$0$前面，两者不能对应；\n\n对于样例二，对应方案为$3-4$，故总和为$1$。\n\n\n如果您提前$AK$了，可以做一下[数据增强版](https://www.luogu.org/problemnew/show/T53667)", "locale": "zh-CN", "translations": {"en": {"title": "Binary Mystery", "background": "Although she has already passed $Faded$, Xiaomai still did not solve the binary mystery.", "description": "At this moment, she sensed that there might be some special possible correspondence between $0$ and $1$. So, she defined the “inspiration coefficient” as the absolute value of the difference between the digit positions (counted from high to low) of a corresponding pair. She now wants to match $0$ with $1$ so that, **while maximizing the number of correspondences**, the sum of inspiration coefficients is as large as possible.\n\nThe matching rules are as follows:\n\n$1$. Each correspondence must start with $0$ and end with $1$; in other words, in every correspondence, $0$ must be before (higher bit), and $1$ must be after (lower bit).\n\n$2$. You may choose several correspondences, but correspondences **must not cross**. The meaning of **crossing** is: they share some interval and it is not a containment relationship.\n\n$e.g.$ Suppose one correspondence is between the $2$-nd digit and the $4$-th digit, and another correspondence is between the $3$-rd digit and the $5$-th digit. Then they cannot both be chosen, because they cross on the interval $[3,4]$. However, if the correspondences are between the $1$-st and $5$-th digits, and between the $2$-nd and $4$-th digits, then this is not considered crossing, because although they share the interval $[2,4]$, there is a containment relationship, so they can both be chosen.\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/38793.png)\n\nThat is, **crossing is not the same as intersection**.\n\n$3$. Each digit can appear in at most one correspondence.\n\n#", "inputFormat": "The first line contains an integer $n$, the number of bits in the binary number.\n\nThe next line contains an $n$-bit binary number.", "outputFormat": "One line, representing the maximum possible sum of inspiration coefficients under the condition that the number of correspondences is maximized.", "hint": "For $30$% of the data, $0<n<=20$.\n\nFor $100$% of the data, $0<n<=300$.\n\n**Sample Explanation**\n\nFor sample 1, since $1$ is before $0$, they cannot be matched.\n\nFor sample 2, the matching plan is $3-4$, so the total sum is $1$.\n\nIf you have already $AK$, you can try the [Enhanced Data Version](https://www.luogu.org/problemnew/show/T53667).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "二进制之谜", "background": "虽然过了$Faded$，但是小埋还是没有解出二进制之谜。", "description": "这个时候，她感觉到了$0$与$1$存在的某种可能的特殊对应关系。于是，她定义了“启发系数”：对应的两个数位数（按从高位到低位顺序去数）的差的绝对值；她现在希望将$0$与$1$进行对应使得**在对应关系最多的前提下**，启发系数之和最大。\n\n对应规则如下：\n\n$1$.对应关系必须从$0$开始，以$1$结束；换句话说，每个对应关系必须$0$在前（高位），$1$在后（低位）；\n\n$2$.可以取若干个对应关系，但对应关系之间**不能交叉**；**交叉**的含义是：共用某个区间且不是包含关系；\n\n$e.g.$ 假设一个对应关系为第$2$位数与第$4$位数，另一个对应关系为第$3$位数与第$5$位数，那么它们不可同时取，因为在区间$[3,4]$交叉；但是若对应关系分别为第$1$、$5$位数与第$2$、$4$位数，则不算作交叉，因为它们虽然共用区间$[2,4]$但存在包含关系，可以同时取。\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/38793.png)\n\n这即是说，**交叉不等于交集**。\n\n$3$.每个数最多只能存在于一个对应关系中。", "inputFormat": "第一行，一个整数$n$，为二进制数的位数；\n\n接下来一行，输入一个$n$位二进制数。", "outputFormat": "一行，表示对应关系最多的前提下最大的启发系数之和。", "hint": "对于$30$%的数据，$0<n<=20$；\n\n对于$100$%的数据，$0<n<=300$；\n\n**样例说明**\n\n对于样例一，由于$1$在$0$前面，两者不能对应；\n\n对于样例二，对应方案为$3-4$，故总和为$1$。\n\n\n如果您提前$AK$了，可以做一下[数据增强版](https://www.luogu.org/problemnew/show/T53667)", "locale": "zh-CN"}}}
{"pid": "P4990", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 1\n2 3 1\n1 3 1\n0", "0\n2"], ["3 3\n1 2 1\n2 2 0\n3 1 1\n0", "Continue from the last checkpoint"], ["3 3\n1 2 1\n2 2 0\n3 1 1\n4\n2 0 1 3 1\n1 1 3\n3 1 1\n5 1 1", "2\n1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["洛谷原创", "O2优化"], "title": "小埋与刺客传奇", "background": "**数据已更新。**\n\n经过几天几夜的硬肝，小埋终于玩到了最后一关，也是$Dancing$ $Line$的魔王关——$The$ $Legend$ $of$ $Assassin$\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/34876.png)\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/35145.png)", "description": "如图，魔王关经常出现炸路与突发障碍。\n\n小埋很苦恼，因为她不知道完整的地图。于是她进行了许多尝试，总结了随着时间变化而出现或消失的路与她在这些时刻时的位置，**为了简化问题，我们假定小埋的位置始终不变**。\n\n现在她想知道，她至少从什么时刻开始才可以看到能通向终点的路；由于一些路径上有钻石，这些钻石能带来一定加分，小埋还希望知道她在最早看到能通向终点的路时，按照当前地图走向终点所能获得的最大得分。", "inputFormat": "第一行，两个数$n$，$m$，分别表示地图的结点数与初始边数，结点从$1-n$进行编号；初始时，为第$0$时刻，小埋在$1$号结点，且终点始终为$n$；\n\n接下来$m$行，每行三个数$u_i$，$v_i$，$w_i$，表示一条从$u_i$到$v_i$的得分为$w_i$的边；\n\n接下来一行，一个整数$t$，表示出现新边或旧边消失的时刻数，如无边出现或消失，$t=0$；\n\n接下来$t$行，每行第一个数为$tm_j$，表示出现这一事件的时刻；第二个数为$type$，若$type==0$，表示出现了一条新边，之后会有三个数$u_j$，$v_j$，$w_j$，分别表示一条边信息（含义同上）；若$type==1$，之后会有一个数$k$，表示当前**时刻**未消失的第$k$条路消失了。", "outputFormat": "若任何时刻下都不能到达终点，则输出”$Continue$ $from$ $the$ $last$ $checkpoint$”，否则输出两行：第一行为一个数$tmp$，表示看到通向终点路径时的最小时刻；第二行为一个数$score$，表示在上述时刻时到达终点所能获得的最大分数。", "hint": "本题共$10$个测试点，各测试点详细信息如下：\n\n$1$：$n<=100000$，$m<=200000$，$t<=100000$；输出“$Continue$ $from$ $the$ $last$ $checkpoint$”；分值：$5$；\n\n$2$：$n<=100$，$m<=10000$，$t<=100$；无特殊性质；分值：$10$；\n\n$3$：$n<=100000$，$m<=200000$，$t<=100000$；所有边的分数为$0$；分值：$10$；\n\n$4$：$n<=100000$，$m<=200000$，$t=0$；无新增或消失的边；分值：$5$；\n\n$5$~$6$：$n<=100000$，$m<=200000$，$t<=100000$；无消失的边；分值：$10$；\n\n$7$~$8$：$n<=100000$，$m<=200000$，$t<=100000$；无出现的边；分值：$10$；\n\n$9$~$10$：$n<=100000$，$m<=200000$，$t<=100000$；消失的边不超过$1000$条；分值：$15$。\n\n另外，对于所有数据，$0<u_i,u_j,v_i,v_j<=n$，$0<=w_i,w_j<=10$，$0<tm_j<=10t$，且$tm_j$互不相同；数据保证不出现正环。", "locale": "zh-CN", "translations": {"en": {"title": "Umaru and The Legend of Assassin", "background": "**The testdata has been updated.**\n\nAfter several days and nights of intense grinding, Umaru finally reached the last level, the boss level of $Dancing$ $Line$ — $The$ $Legend$ $of$ $Assassin$.\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/34876.png)\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/35145.png)", "description": "As shown in the figure, the boss level often has broken roads and sudden obstacles.\n\nUmaru is troubled because she does not know the complete map. So she made many attempts and summarized the roads that appear or disappear over time, and her position at those moments. **To simplify the problem, we assume that Umaru's position never changes.**\n\nNow she wants to know: from what earliest moment can she see a path that can lead to the destination. Also, because there are diamonds on some paths and these diamonds can give extra points, Umaru also wants to know the maximum score she can obtain by going to the destination following the current map at the earliest moment when she can first see a path to the destination.", "inputFormat": "The first line contains two integers $n$ and $m$, representing the number of nodes in the map and the number of initial edges. Nodes are numbered from $1-n$. Initially, this is time $0$. Umaru is at node $1$, and the destination is always node $n$.\n\nThe next $m$ lines each contain three integers $u_i$, $v_i$, $w_i$, describing an edge from $u_i$ to $v_i$ with score $w_i$.\n\nThe next line contains one integer $t$, representing the number of moments when a new edge appears or an old edge disappears. If no edge appears or disappears, then $t=0$.\n\nThe next $t$ lines describe events. In each line, the first number is $tm_j$, the time when this event happens. The second number is $type$:\n- If $type==0$, it means a new edge appears. Then three numbers $u_j$, $v_j$, $w_j$ follow, describing the edge (same meaning as above).\n- If $type==1$, then one number $k$ follows, meaning that at the **current time**, the $k$-th road among those that have not disappeared disappears.", "outputFormat": "If at no time it is possible to reach the destination, output \"$Continue$ $from$ $the$ $last$ $checkpoint$\". Otherwise, output two lines:\n- The first line contains one number $tmp$, the minimum time when a path to the destination can be seen.\n- The second line contains one number $score$, the maximum score that can be obtained when reaching the destination at that time.", "hint": "This problem has $10$ test points. The detailed information is as follows.\n\n$1$: $n<=100000$, $m<=200000$, $t<=100000$. Output \"$Continue$ $from$ $the$ $last$ $checkpoint$\". Score: $5$.\n\n$2$: $n<=100$, $m<=10000$, $t<=100$. No special properties. Score: $10$.\n\n$3$: $n<=100000$, $m<=200000$, $t<=100000$. All edges have score $0$. Score: $10$.\n\n$4$: $n<=100000$, $m<=200000$, $t=0$. No edges are added or removed. Score: $5$.\n\n$5$~$6$: $n<=100000$, $m<=200000$, $t<=100000$. No edges disappear. Score: $10$.\n\n$7$~$8$: $n<=100000$, $m<=200000$, $t<=100000$. No edges appear. Score: $10$.\n\n$9$~$10$: $n<=100000$, $m<=200000$, $t<=100000$. No more than $1000$ edges disappear. Score: $15$.\n\nIn addition, for all data, $0<u_i,u_j,v_i,v_j<=n$, $0<=w_i,w_j<=10$, $0<tm_j<=10t$, and all $tm_j$ are distinct. The testdata guarantees that there is no positive cycle.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小埋与刺客传奇", "background": "**数据已更新。**\n\n经过几天几夜的硬肝，小埋终于玩到了最后一关，也是$Dancing$ $Line$的魔王关——$The$ $Legend$ $of$ $Assassin$\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/34876.png)\n\n![avatar](https://cdn.luogu.com.cn/upload/pic/35145.png)", "description": "如图，魔王关经常出现炸路与突发障碍。\n\n小埋很苦恼，因为她不知道完整的地图。于是她进行了许多尝试，总结了随着时间变化而出现或消失的路与她在这些时刻时的位置，**为了简化问题，我们假定小埋的位置始终不变**。\n\n现在她想知道，她至少从什么时刻开始才可以看到能通向终点的路；由于一些路径上有钻石，这些钻石能带来一定加分，小埋还希望知道她在最早看到能通向终点的路时，按照当前地图走向终点所能获得的最大得分。", "inputFormat": "第一行，两个数$n$，$m$，分别表示地图的结点数与初始边数，结点从$1-n$进行编号；初始时，为第$0$时刻，小埋在$1$号结点，且终点始终为$n$；\n\n接下来$m$行，每行三个数$u_i$，$v_i$，$w_i$，表示一条从$u_i$到$v_i$的得分为$w_i$的边；\n\n接下来一行，一个整数$t$，表示出现新边或旧边消失的时刻数，如无边出现或消失，$t=0$；\n\n接下来$t$行，每行第一个数为$tm_j$，表示出现这一事件的时刻；第二个数为$type$，若$type==0$，表示出现了一条新边，之后会有三个数$u_j$，$v_j$，$w_j$，分别表示一条边信息（含义同上）；若$type==1$，之后会有一个数$k$，表示当前**时刻**未消失的第$k$条路消失了。", "outputFormat": "若任何时刻下都不能到达终点，则输出”$Continue$ $from$ $the$ $last$ $checkpoint$”，否则输出两行：第一行为一个数$tmp$，表示看到通向终点路径时的最小时刻；第二行为一个数$score$，表示在上述时刻时到达终点所能获得的最大分数。", "hint": "本题共$10$个测试点，各测试点详细信息如下：\n\n$1$：$n<=100000$，$m<=200000$，$t<=100000$；输出“$Continue$ $from$ $the$ $last$ $checkpoint$”；分值：$5$；\n\n$2$：$n<=100$，$m<=10000$，$t<=100$；无特殊性质；分值：$10$；\n\n$3$：$n<=100000$，$m<=200000$，$t<=100000$；所有边的分数为$0$；分值：$10$；\n\n$4$：$n<=100000$，$m<=200000$，$t=0$；无新增或消失的边；分值：$5$；\n\n$5$~$6$：$n<=100000$，$m<=200000$，$t<=100000$；无消失的边；分值：$10$；\n\n$7$~$8$：$n<=100000$，$m<=200000$，$t<=100000$；无出现的边；分值：$10$；\n\n$9$~$10$：$n<=100000$，$m<=200000$，$t<=100000$；消失的边不超过$1000$条；分值：$15$。\n\n另外，对于所有数据，$0<u_i,u_j,v_i,v_j<=n$，$0<=w_i,w_j<=10$，$0<tm_j<=10t$，且$tm_j$互不相同；数据保证不出现正环。", "locale": "zh-CN"}}}
{"pid": "P4991", "type": "P", "difficulty": 5, "samples": [["5 2\n665667089 948925818 1118302620 288255565 1682529647 \n5 2\n1 3 4\n3 1\n2 3 5\n2 2 4\n3 4\n5 25\n1 3 3\n1 3 4\n3 1\n2 1 5\n2 1 3", "665667089\n288255566\n665667089"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "愤怒的XiaoX", "background": "### 答疑请到 https://www.luogu.org/discuss/show?postid=79498\n\n在几天前的模拟赛上，$XiaoX$又双叒叕$AK$了\n\n他想卡一卡大家，于是他出了下面的一道题：", "description": "给定一个序列，你要维护下列操作：\n\n$1$ $l$ $r$ $k$，表示从$l$到$r$的数字最后$k$位按位取反\n\n$2$ $l$ $r$ $k$，表示从$l$到$r$的数字最后$k$位进行翻转\n\n$3$ $w$ 表示查询$w$这个位置的值\n\n为了降低这道题的难度，我们做出以下规定：\n\n对于序列的操作，我们的$k$在一定范围内是一定的\n\n我们一共会有$t$个$k$\n\n每个$k$后面跟着一些操作\n\n这些操作的$k$（修改的位数）都是相同的\n\n###  按位取反定义：\n\n比如说，一个数的二进制表示是：\n\n```\n10100111\n```\n\n对后5位取反后变成：\n\n```\n10111000\n```\n\n###  翻转定义：\n\n比如说，一个数的二进制表示是：\n\n```\n10100111\n```\n\n对后5位翻转后变成：\n\n```\n10111100\n```", "inputFormat": "第一行，两个整数$n$，$t$,表示序列长度和$k$的数量\n\n第二行，$n$个数，表示原始序列\n\n下面$t$组操作，对于每组操作第一行两个数$q_i$，$k_i$，表示操作数量和在这些操作中$k$的值\n\n下面$q_i$行，表示该组操作", "outputFormat": "对于每个$3$操作，输出一行一个整数，表示答案的大小", "hint": "对于$10$%的数据，没有$1,2$操作\n\n对于另$10$%的数据，没有$1$操作\n\n对于另$10$%的数据，没有$2$操作\n\n对于$50$%的数据，$t<=1$\n\n对于$70$%的数据，$t<=2$\n\n对于$100$%的数据，$t<=5$,$1<=n<=50000,1<=q_i<=20000,k<=25$,初始序列制造方式为$rand()*rand()$(windows下)\n\n感谢@swhsz验题", "locale": "zh-CN", "translations": {"en": {"title": "Angry XiaoX", "background": "### For Q&A, please go to https://www.luogu.org/discuss/show?postid=79498.\n\nA few days ago, in a mock contest, $XiaoX$ got $AK$ again and again.\n\nHe wanted to make things harder for everyone, so he created the following problem.", "description": "Given a sequence, you need to maintain the following operations:\n\n$1$ $l$ $r$ $k$: bitwise NOT the last $k$ bits of the numbers from $l$ to $r$.\n\n$2$ $l$ $r$ $k$: reverse the last $k$ bits of the numbers from $l$ to $r$.\n\n$3$ $w$: query the value at position $w$.\n\nTo reduce the difficulty of this problem, we make the following rules:\n\nFor operations on the sequence, the $k$ values are fixed within a certain range.\n\nThere are a total of $t$ different $k$ values.\n\nAfter each $k$, there are some operations.\n\nIn these operations, the $k$ (the number of modified bits) is the same.\n\n### Definition of bitwise NOT:\n\nFor example, the binary representation of a number is:\n\n```\n10100111\n```\n\nAfter taking bitwise NOT on the last 5 bits, it becomes:\n\n```\n10111000\n```\n\n### Definition of reverse:\n\nFor example, the binary representation of a number is:\n\n```\n10100111\n```\n\nAfter reversing the last 5 bits, it becomes:\n\n```\n10111100\n```", "inputFormat": "The first line contains two integers $n$ and $t$, representing the length of the sequence and the number of $k$ values.\n\nThe second line contains $n$ numbers, representing the initial sequence.\n\nThen follow $t$ groups of operations. For each group, the first line contains two numbers $q_i$ and $k_i$, representing the number of operations and the value of $k$ used in these operations.\n\nThe next $q_i$ lines describe the operations in this group.", "outputFormat": "For each operation of type $3$, output one line with one integer, representing the answer.", "hint": "For $10\\%$ of the data, there are no operations of type $1$ or $2$.\n\nFor another $10\\%$ of the data, there are no operations of type $1$.\n\nFor another $10\\%$ of the data, there are no operations of type $2$.\n\nFor $50\\%$ of the data, $t \\le 1$.\n\nFor $70\\%$ of the data, $t \\le 2$.\n\nFor $100\\%$ of the data, $t \\le 5$, $1 \\le n \\le 50000$, $1 \\le q_i \\le 20000$, $k \\le 25$. The initial sequence is generated by $rand() * rand()$ (on Windows).\n\nThanks to @swhsz for verifying the problem.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "愤怒的XiaoX", "background": "### 答疑请到 https://www.luogu.org/discuss/show?postid=79498\n\n在几天前的模拟赛上，$XiaoX$又双叒叕$AK$了\n\n他想卡一卡大家，于是他出了下面的一道题：", "description": "给定一个序列，你要维护下列操作：\n\n$1$ $l$ $r$ $k$，表示从$l$到$r$的数字最后$k$位按位取反\n\n$2$ $l$ $r$ $k$，表示从$l$到$r$的数字最后$k$位进行翻转\n\n$3$ $w$ 表示查询$w$这个位置的值\n\n为了降低这道题的难度，我们做出以下规定：\n\n对于序列的操作，我们的$k$在一定范围内是一定的\n\n我们一共会有$t$个$k$\n\n每个$k$后面跟着一些操作\n\n这些操作的$k$（修改的位数）都是相同的\n\n###  按位取反定义：\n\n比如说，一个数的二进制表示是：\n\n```\n10100111\n```\n\n对后5位取反后变成：\n\n```\n10111000\n```\n\n###  翻转定义：\n\n比如说，一个数的二进制表示是：\n\n```\n10100111\n```\n\n对后5位翻转后变成：\n\n```\n10111100\n```", "inputFormat": "第一行，两个整数$n$，$t$,表示序列长度和$k$的数量\n\n第二行，$n$个数，表示原始序列\n\n下面$t$组操作，对于每组操作第一行两个数$q_i$，$k_i$，表示操作数量和在这些操作中$k$的值\n\n下面$q_i$行，表示该组操作", "outputFormat": "对于每个$3$操作，输出一行一个整数，表示答案的大小", "hint": "对于$10$%的数据，没有$1,2$操作\n\n对于另$10$%的数据，没有$1$操作\n\n对于另$10$%的数据，没有$2$操作\n\n对于$50$%的数据，$t<=1$\n\n对于$70$%的数据，$t<=2$\n\n对于$100$%的数据，$t<=5$,$1<=n<=50000,1<=q_i<=20000,k<=25$,初始序列制造方式为$rand()*rand()$(windows下)\n\n感谢@swhsz验题", "locale": "zh-CN"}}}
{"pid": "P4992", "type": "P", "difficulty": 5, "samples": [["3 2\n1 2 3\n2 2 3\n1 1\n1 2\n1 3\n0.3 0.1 0.2\n", "1\n0.9940"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "查房", "background": "答疑请到： https://www.luogu.org/discuss/show?postid=79498\n\n$sqn$是个电子游戏爱好者，但很遗憾的是，他的母上大人没收了他的手机。为了过一把游戏瘾，$sqn$到各个$oier$的宿舍借手机玩......", "description": "当然，这是一件风险很大的事，因为van恶的静静和晶晶会定时查房，被抓到可就惨了。当然$oier$们不会束手就擒，他们组织了一个反查房联盟。这个联盟由$n$个宿舍(点)组成，某些宿舍之间有边权为1无向边连接，共有$n-1$条无向边。每个点都有一个概率$k_i$，表示在颓废的几率为$k_i$。如果老师查到某个房间，而这个房间的人在学习，他就会发出警报，距离他1的人收到警报后都会在下一时刻无条件停止颓废，之后恢复原状态，如果查到在颓废的人，则那个人不会发出警报而是GG（可以当作这个人死了，再也不会发出信号）。静静和晶晶一起行动，查一遍房间。$sqn$只会在$ztz11$，$AK$爷，$floatiy$的房间里颓废，他想知道，在哪个房间里颓废被查到几率最小？当然，由于他在颓废，所以自然不可能算几率啦，他将这个问题交给了你，请你帮他来解决这个问题", "inputFormat": "第一行，两个数字$n$，$m$，表示房间总数 和查房次数   \n第二行，3个数字$a,b,c$，分别表示 $ztz11$，$AK$爷和$floatiy$的房间号    \n下面$m$行，每行第一个数字$k$,表示当前时刻老师们要查几间房，后面$k$个数字，表示静静和晶晶要查的房间号  \n下面$n-1$行，每行$2$个数，表示会相互发出警报的两个人   \n最后一行，$n$个数，表示每个人颓废的几率", "outputFormat": "第一行，一个整数，表示$sqn$应该去的最佳的房间，如果几率相同，请按$ztz11>AK>floatiy$的优先级输出\n\n第二行，一个4位小数，表示$sqn$安全颓废的几率\n", "hint": "对于 $30$% 的数据，$n,m<=10$,\n\n对于另 $10$% 的数据，$k=1$\n\n对于 $100$% 的数据，$1<=m,n<=1000000$,确保每个人被且仅被查一次\n\n感谢@XiaoX，@Monster_qi帮助出数据&验题\n", "locale": "zh-CN", "translations": {"en": {"title": "Room Inspection.", "background": "For questions, please go to: https://www.luogu.org/discuss/show?postid=79498.\n\n$sqn$ is a video game fan, but unfortunately his mom took away his phone. To satisfy his desire to play games, $sqn$ borrows phones from different $oier$ dorm rooms to play games......", "description": "Of course, this is very risky, because the evil Jingjing and Jingjing will inspect the rooms regularly, and getting caught would be terrible. Of course, the $oier$s will not just give up, so they organized an anti-inspection alliance.\n\nThis alliance consists of $n$ dorm rooms (nodes). Some dorm rooms are connected by undirected edges with weight $1$, and there are $n-1$ undirected edges in total. Each node has a probability $k_i$, meaning the probability of being slacking off is $k_i$.\n\nIf a teacher inspects a room and the person in that room is studying, they will raise an alarm. After a person at distance $1$ receives the alarm, they will unconditionally stop slacking off at the next moment, and then return to their original state. If the teacher inspects someone who is slacking off, then that person will not raise an alarm and will instead be GG (you can treat it as the person is dead and will never send signals again).\n\nJingjing and Jingjing act together and inspect the rooms once. $sqn$ will only slack off in the rooms of $ztz11$, Grandpa $AK$, and $floatiy$. He wants to know: in which room is the probability of being caught while slacking off the smallest?\n\nOf course, since he is slacking off, he cannot calculate the probability himself. He leaves this problem to you. Please help him solve it.", "inputFormat": "The first line contains two integers $n$, $m$, representing the total number of rooms and the number of inspections.\n\nThe second line contains three integers $a, b, c$, representing the room numbers of $ztz11$, Grandpa $AK$, and $floatiy$.\n\nThe next $m$ lines: the first number is $k$, meaning how many rooms the teachers will inspect at the current moment; the following $k$ numbers are the room numbers that Jingjing and Jingjing will inspect.\n\nThe next $n-1$ lines: each line contains $2$ numbers, indicating two people who can send alarms to each other.\n\nThe last line contains $n$ numbers, representing each person's probability of slacking off.", "outputFormat": "The first line outputs one integer, indicating the best room that $sqn$ should go to. If the probabilities are the same, output according to the priority $ztz11 > AK > floatiy$.\n\nThe second line outputs a number with $4$ digits after the decimal point, representing the probability that $sqn$ can slack off safely.", "hint": "For $30\\%$ of the testdata, $n, m \\le 10$.\n\nFor another $10\\%$ of the testdata, $k = 1$.\n\nFor $100\\%$ of the testdata, $1 \\le m, n \\le 1000000$, and it is guaranteed that everyone is inspected once and only once.\n\nThanks to @XiaoX and @Monster_qi for helping provide data & validate the problem.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "查房", "background": "答疑请到： https://www.luogu.org/discuss/show?postid=79498\n\n$sqn$是个电子游戏爱好者，但很遗憾的是，他的母上大人没收了他的手机。为了过一把游戏瘾，$sqn$到各个$oier$的宿舍借手机玩......", "description": "当然，这是一件风险很大的事，因为van恶的静静和晶晶会定时查房，被抓到可就惨了。当然$oier$们不会束手就擒，他们组织了一个反查房联盟。这个联盟由$n$个宿舍(点)组成，某些宿舍之间有边权为1无向边连接，共有$n-1$条无向边。每个点都有一个概率$k_i$，表示在颓废的几率为$k_i$。如果老师查到某个房间，而这个房间的人在学习，他就会发出警报，距离他1的人收到警报后都会在下一时刻无条件停止颓废，之后恢复原状态，如果查到在颓废的人，则那个人不会发出警报而是GG（可以当作这个人死了，再也不会发出信号）。静静和晶晶一起行动，查一遍房间。$sqn$只会在$ztz11$，$AK$爷，$floatiy$的房间里颓废，他想知道，在哪个房间里颓废被查到几率最小？当然，由于他在颓废，所以自然不可能算几率啦，他将这个问题交给了你，请你帮他来解决这个问题", "inputFormat": "第一行，两个数字$n$，$m$，表示房间总数 和查房次数   \n第二行，3个数字$a,b,c$，分别表示 $ztz11$，$AK$爷和$floatiy$的房间号    \n下面$m$行，每行第一个数字$k$,表示当前时刻老师们要查几间房，后面$k$个数字，表示静静和晶晶要查的房间号  \n下面$n-1$行，每行$2$个数，表示会相互发出警报的两个人   \n最后一行，$n$个数，表示每个人颓废的几率", "outputFormat": "第一行，一个整数，表示$sqn$应该去的最佳的房间，如果几率相同，请按$ztz11>AK>floatiy$的优先级输出\n\n第二行，一个4位小数，表示$sqn$安全颓废的几率\n", "hint": "对于 $30$% 的数据，$n,m<=10$,\n\n对于另 $10$% 的数据，$k=1$\n\n对于 $100$% 的数据，$1<=m,n<=1000000$,确保每个人被且仅被查一次\n\n感谢@XiaoX，@Monster_qi帮助出数据&验题\n", "locale": "zh-CN"}}}
{"pid": "P4993", "type": "P", "difficulty": 6, "samples": [["1\n5 5 9\n1 2 3 4 5\n4 5 6 7 8\n2", "2"], ["5\n20 10 1329\n540 499 490 419 308 261 323 476 476 374 23 13 14 16 19 34 43 19 27 32 \n8 8 8 8 8 7 7 7 7 7 \n50\n20 10 1800\n74 434 97 134 283 118 234 498 328 388 29 48 48 43 23 42 31 16 20 26 \n8 8 7 6 8 8 8 7 7 7 \n50\n20 10 2704\n142 378 330 281 377 64 340 309 466 289 34 37 19 17 20 48 21 28 38 15 \n6 8 6 6 8 7 7 7 7 6 \n50\n20 10 72\n365 356 456 479 459 222 548 377 212 223 38 20 49 18 49 38 31 48 41 17 \n6 8 7 6 8 7 8 8 8 6 \n50\n20 10 1416\n367 191 403 298 445 464 79 467 431 362 10 45 48 37 46 43 11 35 30 39 \n8 6 8 7 7 7 8 8 7 8 \n50", "1023\n1023\n1023\n15\n1023"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "枚举", "素数判断,质数,筛法"], "title": "评分系统", "background": "答疑请到：https://www.luogu.org/discuss/show?postid=79498\n\n由于时限等问题，请大家重交一遍这道题\n\n本题时限开至2s\n\n样例：https://files.cnblogs.com/files/ztz11/yl.rar\n\n---\n\n众所周知，luogu 有题目难度的评分系统，用户在通过题目后可以选择题目难度以及算法标签，来完善 luogu 的题库。\n\n![](https://cdn.luogu.com.cn/upload/pic/40327.png)\n\n（原注：以下内容非真实评分数据，纯属作者编造，仅供娱乐使用。）", "description": "Menteur-Hxy 同学很不老实，为了实现 NOIp 前 AC $100$ 道黑题的目标，他决定雇佣一些水军，最少雇佣 $1$ 个水军。\n\n每个水军都有一个能力值 $x_i$，表示该水军可以解决难度最高为 $x_i$ 的题目。这些水军十分尽职尽责，在通过这道题目后都会给题目评最高难度。当然，luogu 的正常用户也会做题，他们会正常地评分。现在，我们给你所有水军的能力值以及每道题正常用户的评分记录，请你求出有多少种选择水军的方案，可以使这道题的评分变为黑题。因为答案可能过大，最终请输出答案数 $\\bmod p$ 的值。\n\n评分计算公式：去掉一个最高分，去掉一个最低分后求平均分。\n\n**【表一：投票信息】**\n\n| 投票编号 | 对应难度 | 分数贡献 |\n| :------: | :------: | :------: |\n| $1$ | 入门 | $1$ |\n| $2$ | 普及- | $10$ |\n| $3$ | 普及/提高- | $15$ |\n| $4$ | 普及+/提高 | $25$ |\n| $5$ | 提高+/省选- | $40$ |\n| $6$ | 省选/NOI- | $55$ |\n| $7$ | NOI | $75$ |\n| $8$ | NOI+/CTSC | $100$ |\n\n**【表二：难度规则】**\n\n| 难度等级 | 对应颜色 | 对应分数 |\n| :------: | :------: | :------: |\n| 入门 | 红 | $1\\sim 5$ |\n| 普及- | 橙 | $6\\sim 12$ |\n| 普及/提高- | 黄 | $13\\sim 20$ |\n| 普及+/提高 | 绿 | $21\\sim 35$ |\n| 提高+/省选- | 蓝 | $36\\sim 45$ |\n| 省选/NOI- | 紫 | $46\\sim 70$ |\n| NOI+/CTSC | 黑 | $71\\sim 100$ |", "inputFormat": "**本题有多组数据。**\n\n第一行，一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n+ 第一行三个整数 $n, m, p$，分别表示 Menteur-Hxy 找的水军数量，luogu 用户评分数量，和输出时的模数。\n+ 第二行，$n$ 个整数 $s_1 \\dots s_n$ 分别表示水军的能力值。\n+ 第三行，$m$ 个整数 $t_1 \\dots t_n$，表示每个 luogu 用户的投票编号。\n+ 第四行，一个整数 $k$ ，表示题目的难度系数。", "outputFormat": "对于每组数据，输出一行一个整数，表示总选择方案数对 $p$ 取模后的结果，如无解，则输出 $0$。", "hint": "**【样例解释 $1$】**\n\nluogu 用户评分和为 $25+40+55+75+100=295$，弃掉一个最低分后为 $270$，这时 Menteur-Hxy 雇佣两个及以上水军就可以达到目的。\n\n因为可以通过本题的水军共有 $4$ 个，所以选择方案共有：\n\n$$\\{1,2\\}\\{1,2,3\\}\\{1,2,3,4\\}\\{1,2,4\\}\\{1,3\\}\\{1,3,4\\}\\{1,4\\}\\{2,3\\}\\{2,3,4\\}\\{2,4\\}\\{3,4\\}$$\n\n共 $11$ 种，对 $9$ 取余后结果为 $2$。\n\n**【数据规模与约定】**\n\n对于 $30\\%$ 的数据，$n, m \\leq 50$。\n\n对于另外 $20\\%$ 的数据，$p$ 为质数。\n\n对于 $100\\%$ 的数据，$1 \\leq n, m, k,s_i \\leq 10^5, 1 \\leq t \\leq 5, 2 \\leq p \\leq 3 \\times 10^3, 1 \\leq t_i \\leq 8$。\n\n保证合格水军的数量与需要的最少水军数量之差不超过 $5000$。\n\n（原注：本题可能轻微卡常。感谢 @Ghostcai ，@Swhsz 帮忙验题。）", "locale": "zh-CN", "translations": {"en": {"title": "Scoring System", "background": "For Q\\&A, please go to: https://www.luogu.org/discuss/show?postid=79498.\n\nDue to issues such as the time limit, please resubmit this problem once.\n\nThe time limit for this problem is set to 2 s.\n\nSamples: https://files.cnblogs.com/files/ztz11/yl.rar.\n\n---\n\nAs everyone knows, Luogu has a difficulty scoring system for problems. After solving a problem, users can choose the problem difficulty and algorithm tags to help improve Luogu's problemset.\n\n![](https://cdn.luogu.com.cn/upload/pic/40327.png)\n\n(Original note: The following content is not real scoring data. It is made up by the author, for entertainment only.)", "description": "Student Menteur-Hxy is not very honest. In order to achieve the goal of getting AC on $100$ hard (black) problems before NOIp, he decided to hire some \"water army\" (paid voters), hiring at least $1$ of them.\n\nEach paid voter has an ability value $x_i$, meaning this voter can solve problems with difficulty up to $x_i$ at most. These paid voters are very responsible: after solving the problem, they will always rate the problem as the highest difficulty. Of course, normal Luogu users will also solve problems and give normal ratings. Now, given all paid voters' ability values and the rating records from normal users for each problem, please find how many ways to choose paid voters such that the final rating of this problem becomes a black problem. Since the answer may be very large, output the number of ways $\\bmod p$.\n\nScoring formula: remove one highest score and one lowest score, then take the average.\n\n**[Table 1: Voting Information]**\n\n| Vote ID | Corresponding Difficulty | Score Contribution |\n| :------: | :------: | :------: |\n| $1$ | Beginner | $1$ |\n| $2$ | Junior- | $10$ |\n| $3$ | Junior/Senior- | $15$ |\n| $4$ | Junior+/Senior | $25$ |\n| $5$ | Senior+/NOI Qualifier- | $40$ |\n| $6$ | NOI Qualifier/NOI- | $55$ |\n| $7$ | NOI | $75$ |\n| $8$ | NOI+/CTSC | $100$ |\n\n**[Table 2: Difficulty Rules]**\n\n| Difficulty Level | Color | Score Range |\n| :------: | :------: | :------: |\n| Beginner | Red | $1\\sim 5$ |\n| Junior- | Orange | $6\\sim 12$ |\n| Junior/Senior- | Yellow | $13\\sim 20$ |\n| Junior+/Senior | Green | $21\\sim 35$ |\n| Senior+/NOI Qualifier- | Blue | $36\\sim 45$ |\n| NOI Qualifier/NOI- | Purple | $46\\sim 70$ |\n| NOI+/CTSC | Black | $71\\sim 100$ |", "inputFormat": "**This problem has multiple test cases.**\n\nThe first line contains an integer $T$, the number of test cases.\n\nFor each test case:\n\n- The first line contains three integers $n, m, p$, representing the number of paid voters hired by Menteur-Hxy, the number of ratings from Luogu users, and the modulus for output.\n- The second line contains $n$ integers $s_1 \\dots s_n$, where each $s_i$ is a paid voter's ability value.\n- The third line contains $m$ integers $t_1 \\dots t_n$, representing each Luogu user's vote ID.\n- The fourth line contains an integer $k$, representing the difficulty coefficient of the problem.", "outputFormat": "For each test case, output one integer per line: the total number of valid selection plans modulo $p$. If there is no solution, output $0$.", "hint": "**[Sample Explanation $1$]**\n\nThe sum of Luogu users' scores is $25+40+55+75+100=295$. After discarding one lowest score, it becomes $270$. At this time, Menteur-Hxy can achieve the goal by hiring at least two paid voters.\n\nSince there are $4$ paid voters who can solve this problem, the selection plans are:\n\n$$\\{1,2\\}\\{1,2,3\\}\\{1,2,3,4\\}\\{1,2,4\\}\\{1,3\\}\\{1,3,4\\}\\{1,4\\}\\{2,3\\}\\{2,3,4\\}\\{2,4\\}\\{3,4\\}$$\n\nThere are $11$ plans in total, and $11 \\bmod 9 = 2$.\n\n**[Constraints and Notes]**\n\nFor $30\\%$ of the testdata, $n, m \\leq 50$.\n\nFor another $20\\%$ of the testdata, $p$ is a prime.\n\nFor $100\\%$ of the testdata, $1 \\leq n, m, k,s_i \\leq 10^5, 1 \\leq t \\leq 5, 2 \\leq p \\leq 3 \\times 10^3, 1 \\leq t_i \\leq 8$.\n\nIt is guaranteed that the difference between the number of qualified paid voters and the minimum number of paid voters required does not exceed $5000$.\n\n(Original note: This problem may be slightly tight on constant factors. Thanks to @Ghostcai and @Swhsz for helping to validate the problem.)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "评分系统", "background": "答疑请到：https://www.luogu.org/discuss/show?postid=79498\n\n由于时限等问题，请大家重交一遍这道题\n\n本题时限开至2s\n\n样例：https://files.cnblogs.com/files/ztz11/yl.rar\n\n---\n\n众所周知，luogu 有题目难度的评分系统，用户在通过题目后可以选择题目难度以及算法标签，来完善 luogu 的题库。\n\n![](https://cdn.luogu.com.cn/upload/pic/40327.png)\n\n（原注：以下内容非真实评分数据，纯属作者编造，仅供娱乐使用。）", "description": "Menteur-Hxy 同学很不老实，为了实现 NOIp 前 AC $100$ 道黑题的目标，他决定雇佣一些水军，最少雇佣 $1$ 个水军。\n\n每个水军都有一个能力值 $x_i$，表示该水军可以解决难度最高为 $x_i$ 的题目。这些水军十分尽职尽责，在通过这道题目后都会给题目评最高难度。当然，luogu 的正常用户也会做题，他们会正常地评分。现在，我们给你所有水军的能力值以及每道题正常用户的评分记录，请你求出有多少种选择水军的方案，可以使这道题的评分变为黑题。因为答案可能过大，最终请输出答案数 $\\bmod p$ 的值。\n\n评分计算公式：去掉一个最高分，去掉一个最低分后求平均分。\n\n**【表一：投票信息】**\n\n| 投票编号 | 对应难度 | 分数贡献 |\n| :------: | :------: | :------: |\n| $1$ | 入门 | $1$ |\n| $2$ | 普及- | $10$ |\n| $3$ | 普及/提高- | $15$ |\n| $4$ | 普及+/提高 | $25$ |\n| $5$ | 提高+/省选- | $40$ |\n| $6$ | 省选/NOI- | $55$ |\n| $7$ | NOI | $75$ |\n| $8$ | NOI+/CTSC | $100$ |\n\n**【表二：难度规则】**\n\n| 难度等级 | 对应颜色 | 对应分数 |\n| :------: | :------: | :------: |\n| 入门 | 红 | $1\\sim 5$ |\n| 普及- | 橙 | $6\\sim 12$ |\n| 普及/提高- | 黄 | $13\\sim 20$ |\n| 普及+/提高 | 绿 | $21\\sim 35$ |\n| 提高+/省选- | 蓝 | $36\\sim 45$ |\n| 省选/NOI- | 紫 | $46\\sim 70$ |\n| NOI+/CTSC | 黑 | $71\\sim 100$ |", "inputFormat": "**本题有多组数据。**\n\n第一行，一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n+ 第一行三个整数 $n, m, p$，分别表示 Menteur-Hxy 找的水军数量，luogu 用户评分数量，和输出时的模数。\n+ 第二行，$n$ 个整数 $s_1 \\dots s_n$ 分别表示水军的能力值。\n+ 第三行，$m$ 个整数 $t_1 \\dots t_n$，表示每个 luogu 用户的投票编号。\n+ 第四行，一个整数 $k$ ，表示题目的难度系数。", "outputFormat": "对于每组数据，输出一行一个整数，表示总选择方案数对 $p$ 取模后的结果，如无解，则输出 $0$。", "hint": "**【样例解释 $1$】**\n\nluogu 用户评分和为 $25+40+55+75+100=295$，弃掉一个最低分后为 $270$，这时 Menteur-Hxy 雇佣两个及以上水军就可以达到目的。\n\n因为可以通过本题的水军共有 $4$ 个，所以选择方案共有：\n\n$$\\{1,2\\}\\{1,2,3\\}\\{1,2,3,4\\}\\{1,2,4\\}\\{1,3\\}\\{1,3,4\\}\\{1,4\\}\\{2,3\\}\\{2,3,4\\}\\{2,4\\}\\{3,4\\}$$\n\n共 $11$ 种，对 $9$ 取余后结果为 $2$。\n\n**【数据规模与约定】**\n\n对于 $30\\%$ 的数据，$n, m \\leq 50$。\n\n对于另外 $20\\%$ 的数据，$p$ 为质数。\n\n对于 $100\\%$ 的数据，$1 \\leq n, m, k,s_i \\leq 10^5, 1 \\leq t \\leq 5, 2 \\leq p \\leq 3 \\times 10^3, 1 \\leq t_i \\leq 8$。\n\n保证合格水军的数量与需要的最少水军数量之差不超过 $5000$。\n\n（原注：本题可能轻微卡常。感谢 @Ghostcai ，@Swhsz 帮忙验题。）", "locale": "zh-CN"}}}
{"pid": "P4994", "type": "P", "difficulty": 3, "samples": [["2", "3"], ["6", "24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["递推", "枚举", "Fibonacci 数列", "洛谷月赛"], "title": "终于结束的起点", "background": "> 终于结束的起点  \n> 终于写下句点  \n> 终于我们告别  \n> 终于我们又回到原点  \n> ……\n\n一个个 OIer 的竞赛生涯总是从一场 NOIp 开始，大多也在一场 NOIp 中结束，好似一次次轮回在不断上演。  \n如果这次 NOIp 是你的起点，那么祝你的 OI 生涯如同夏花般绚烂。  \n如果这次 NOIp 是你的终点，那么祝你的 OI 回忆宛若繁星般璀璨。  \n也许这是你最后一次在洛谷上打比赛，也许不是。  \n不过，无论如何，祝你在一周后的比赛里，好运。\n\n当然，这道题也和轮回有关系。", "description": "广为人知的斐波拉契数列 $\\mathrm{fib}(n)$ 是这么计算的\n\n$$\n\\mathrm{fib}(n)=\\begin{cases}\n0,& n=0 \\\\\n1,& n=1 \\\\\n\\mathrm{fib}(n-1) + \\mathrm{fib}(n-2),& n>1\n\\end{cases}\n$$\n\n也就是 $0, 1, 1, 2, 3, 5, 8, 13 \\cdots$，每一项都是前两项之和。\n\n小 F 发现，如果把斐波拉契数列的每一项对任意大于 $1$ 的正整数 $M$ 取模的时候，数列都会产生循环。\n\n当然，小 F 很快就明白了，因为 ($\\mathrm{fib}(n - 1) \\bmod M$) 和 ($\\mathrm{fib}(n - 2) \\bmod M)$ 最多只有 $M ^ 2$ 种取值，所以在 $M  ^ 2$ 次计算后一定出现过循环。\n\n甚至更一般地，我们可以证明，无论取什么模数 $M$，最终模 $M$ 下的斐波拉契数列都会是 $0, 1, \\cdots, 0, 1, \\cdots$。\n\n现在，给你一个模数 $M$，请你求出最小的 $n > 0$，使得 $\\mathrm{fib}(n) \\bmod M = 0, \\mathrm{fib}(n + 1) \\bmod M = 1$。", "inputFormat": "输入一行一个正整数 $M$。", "outputFormat": "输出一行一个正整数 $n$。", "hint": "#### 样例 1 解释\n\n斐波拉契数列为 $0, 1, 1, 2, 3, 5, 8, 13, 21, 34, \\cdots$，在对 $2$ 取模后结果为 $0, 1, 1, 0, 1, 1, 0, 1, 1, 0, \\cdots$。\n\n我们可以发现，当 $n = 3$ 时，$f(n) \\bmod 2= 0, f(n + 1) \\bmod 2 = 1$，也就是我们要求的 $n$ 的最小值。\n\n#### 数据范围\n\n对于 $30\\%$ 的数据，$M \\leq 18$；\n\n对于 $70\\%$ 的数据，$M \\leq 2018$；\n\n对于 $100\\%$ 的数据，$2 \\leq M \\leq 706150=\\verb!0xAC666!$。\n\n#### 提示\n\n如果你还不知道什么是取模 $(\\bmod)$，那我也很乐意告诉你，模运算是求整数除法得到的余数，也就是竖式除法最终「除不尽」的部分，也即\n$$a \\bmod M =k \\iff a = bM + k\\ (M > 0, 0 \\leq k < M)$$\n其中 $a, b, k$ 都是非负整数。\n\n如果你使用 `C` / `C++`，你可以使用 `%` 来进行模运算。\n\n如果你使用 `Pascal`，你可以使用 `mod` 来进行模运算。", "locale": "zh-CN", "translations": {"en": {"title": "The Starting Point That Finally Ends.", "background": "> The starting point that finally ends.  \n> Finally writing the period.  \n> Finally we say goodbye.  \n> Finally we return to the starting point again.  \n> ……\n\nAn OIer’s contest journey always starts with a NOIp, and most likely also ends with a NOIp, as if the same cycle keeps playing again and again.  \nIf this NOIp is your starting point, then may your OI journey bloom as brilliantly as summer flowers.  \nIf this NOIp is your ending point, then may your OI memories shine like countless stars.  \nMaybe this is your last time competing on Luogu, maybe not.  \nBut no matter what, good luck in the contest one week later.\n\nOf course, this problem is also related to cycles.", "description": "The well-known Fibonacci sequence $\\mathrm{fib}(n)$ is computed as follows.\n\n$$\n\\mathrm{fib}(n)=\\begin{cases}\n0,& n=0 \\\\\n1,& n=1 \\\\\n\\mathrm{fib}(n-1) + \\mathrm{fib}(n-2),& n>1\n\\end{cases}\n$$\n\nThat is, $0, 1, 1, 2, 3, 5, 8, 13 \\cdots$, where each term is the sum of the previous two terms.\n\nLittle F discovered that if we take every term of the Fibonacci sequence modulo any positive integer $M$ greater than $1$, the sequence will always become periodic.\n\nOf course, Little F soon understood why: ($\\mathrm{fib}(n - 1) \\bmod M$) and ($\\mathrm{fib}(n - 2) \\bmod M$) have at most $M ^ 2$ possible pairs of values, so a cycle must appear within $M ^ 2$ steps.\n\nEven more generally, we can prove that no matter what modulus $M$ we choose, the Fibonacci sequence modulo $M$ will eventually look like $0, 1, \\cdots, 0, 1, \\cdots$.\n\nNow, given a modulus $M$, please find the smallest $n > 0$ such that $\\mathrm{fib}(n) \\bmod M = 0$ and $\\mathrm{fib}(n + 1) \\bmod M = 1$.", "inputFormat": "Input one line containing a positive integer $M$.", "outputFormat": "Output one line containing a positive integer $n$.", "hint": "#### Explanation for Sample 1\n\nThe Fibonacci sequence is $0, 1, 1, 2, 3, 5, 8, 13, 21, 34, \\cdots$. After taking modulo $2$, it becomes $0, 1, 1, 0, 1, 1, 0, 1, 1, 0, \\cdots$.\n\nWe can see that when $n = 3$, $f(n) \\bmod 2 = 0$ and $f(n + 1) \\bmod 2 = 1$, which is exactly what we need, and it is the smallest such $n$.\n\n#### Constraints\n\nFor $30\\%$ of the testdata, $M \\leq 18$.\n\nFor $70\\%$ of the testdata, $M \\leq 2018$.\n\nFor $100\\%$ of the testdata, $2 \\leq M \\leq 706150=\\verb!0xAC666!$.\n\n#### Notes\n\nIf you still do not know what modulo $(\\bmod)$ means, I would be happy to tell you. Modulo means taking the remainder of integer division, that is, the part that “cannot be divided evenly” at the end of long division. In other words,\n$$a \\bmod M =k \\iff a = bM + k\\ (M > 0, 0 \\leq k < M)$$\nwhere $a$, $b$, and $k$ are all non-negative integers.\n\nIf you use `C` / `C++`, you can use `%` for modulo.\n\nIf you use `Pascal`, you can use `mod` for modulo.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "终于结束的起点", "background": "> 终于结束的起点  \n> 终于写下句点  \n> 终于我们告别  \n> 终于我们又回到原点  \n> ……\n\n一个个 OIer 的竞赛生涯总是从一场 NOIp 开始，大多也在一场 NOIp 中结束，好似一次次轮回在不断上演。  \n如果这次 NOIp 是你的起点，那么祝你的 OI 生涯如同夏花般绚烂。  \n如果这次 NOIp 是你的终点，那么祝你的 OI 回忆宛若繁星般璀璨。  \n也许这是你最后一次在洛谷上打比赛，也许不是。  \n不过，无论如何，祝你在一周后的比赛里，好运。\n\n当然，这道题也和轮回有关系。", "description": "广为人知的斐波拉契数列 $\\mathrm{fib}(n)$ 是这么计算的\n\n$$\n\\mathrm{fib}(n)=\\begin{cases}\n0,& n=0 \\\\\n1,& n=1 \\\\\n\\mathrm{fib}(n-1) + \\mathrm{fib}(n-2),& n>1\n\\end{cases}\n$$\n\n也就是 $0, 1, 1, 2, 3, 5, 8, 13 \\cdots$，每一项都是前两项之和。\n\n小 F 发现，如果把斐波拉契数列的每一项对任意大于 $1$ 的正整数 $M$ 取模的时候，数列都会产生循环。\n\n当然，小 F 很快就明白了，因为 ($\\mathrm{fib}(n - 1) \\bmod M$) 和 ($\\mathrm{fib}(n - 2) \\bmod M)$ 最多只有 $M ^ 2$ 种取值，所以在 $M  ^ 2$ 次计算后一定出现过循环。\n\n甚至更一般地，我们可以证明，无论取什么模数 $M$，最终模 $M$ 下的斐波拉契数列都会是 $0, 1, \\cdots, 0, 1, \\cdots$。\n\n现在，给你一个模数 $M$，请你求出最小的 $n > 0$，使得 $\\mathrm{fib}(n) \\bmod M = 0, \\mathrm{fib}(n + 1) \\bmod M = 1$。", "inputFormat": "输入一行一个正整数 $M$。", "outputFormat": "输出一行一个正整数 $n$。", "hint": "#### 样例 1 解释\n\n斐波拉契数列为 $0, 1, 1, 2, 3, 5, 8, 13, 21, 34, \\cdots$，在对 $2$ 取模后结果为 $0, 1, 1, 0, 1, 1, 0, 1, 1, 0, \\cdots$。\n\n我们可以发现，当 $n = 3$ 时，$f(n) \\bmod 2= 0, f(n + 1) \\bmod 2 = 1$，也就是我们要求的 $n$ 的最小值。\n\n#### 数据范围\n\n对于 $30\\%$ 的数据，$M \\leq 18$；\n\n对于 $70\\%$ 的数据，$M \\leq 2018$；\n\n对于 $100\\%$ 的数据，$2 \\leq M \\leq 706150=\\verb!0xAC666!$。\n\n#### 提示\n\n如果你还不知道什么是取模 $(\\bmod)$，那我也很乐意告诉你，模运算是求整数除法得到的余数，也就是竖式除法最终「除不尽」的部分，也即\n$$a \\bmod M =k \\iff a = bM + k\\ (M > 0, 0 \\leq k < M)$$\n其中 $a, b, k$ 都是非负整数。\n\n如果你使用 `C` / `C++`，你可以使用 `%` 来进行模运算。\n\n如果你使用 `Pascal`，你可以使用 `mod` 来进行模运算。", "locale": "zh-CN"}}}
{"pid": "P4995", "type": "P", "difficulty": 2, "samples": [["2\n2 1", "5"], ["3\n6 3 5\n", "49"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "排序", "洛谷月赛"], "title": "跳跳！", "background": "", "description": "你是一只小跳蛙，你特别擅长在各种地方跳来跳去。\n\n这一天，你和朋友小 F 一起出去玩耍的时候，遇到了一堆高矮不同的石头，其中第 $i$ 块的石头高度为 $h_i$，地面的高度是 $h_0 = 0$。你估计着，从第 $i$ 块石头跳到第 $j$ 块石头上耗费的体力值为 $(h_i - h_j) ^ 2$，从地面跳到第 $i$ 块石头耗费的体力值是 $(h_i) ^ 2$。\n\n为了给小 F 展现你超级跳的本领，你决定跳到每个石头上各一次，并最终停在任意一块石头上，并且小跳蛙想耗费**尽可能多**的体力值。\n\n当然，你只是一只小跳蛙，你只会跳，不知道怎么跳才能让本领更充分地展现。\n\n不过你有救啦！小 F 给你递来了一个写着 AK 的电脑，你可以使用计算机程序帮你解决这个问题，万能的计算机会告诉你怎么跳。\n\n那就请你——会写代码的小跳蛙——写下这个程序，为你 NOIp AK 踏出坚实的一步吧！", "inputFormat": "输入一行一个正整数 $n$，表示石头个数。\n\n输入第二行 $n$ 个正整数，表示第 $i$ 块石头的高度 $h_i$。", "outputFormat": "输出一行一个正整数，表示你可以耗费的体力值的最大值。", "hint": "#### 样例解释\n\n两个样例按照输入给定的顺序依次跳上去就可以得到最优方案之一。\n\n#### 数据范围\n对于 $1 \\leq i \\leq n$，有 $0 < h_i \\leq 10 ^ 4$，且保证 $h_i$ 互不相同。\n\n对于 $10\\%$ 的数据，$n \\leq 3$；\n\n对于 $20\\%$ 的数据，$n \\leq 10$；\n\n对于 $50\\%$ 的数据，$n \\leq 20$；\n\n对于 $80\\%$ 的数据，$n \\leq 50$；\n\n对于 $100\\%$ 的数据，$n \\leq 300$。", "locale": "zh-CN", "translations": {"en": {"title": "Jump Jump!", "background": "", "description": "You are a little jumping frog, and you are especially good at jumping around in all kinds of places.\n\nOne day, when you went out to play with your friend Little F, you came across a pile of stones with different heights. The height of the $i$-th stone is $h_i$, and the ground height is $h_0 = 0$. You estimate that the stamina cost to jump from stone $i$ to stone $j$ is $(h_i - h_j) ^ 2$, and the stamina cost to jump from the ground to stone $i$ is $(h_i) ^ 2$.\n\nTo show Little F your amazing jumping skills, you decide to jump onto each stone exactly once, and finally stop on any stone. Also, the little frog wants to spend **as much** stamina as possible.\n\nOf course, you are just a little frog. You can only jump, and you do not know how to jump in a way that shows your skills best.\n\nBut you are saved! Little F hands you a computer with “AK” written on it, and you can use a computer program to solve this problem. The almighty computer will tell you how to jump.\n\nSo please, you little frog who can write code, write this program and take a solid step toward getting NOIp AK!", "inputFormat": "The first line contains a positive integer $n$, the number of stones.\n\nThe second line contains $n$ positive integers, where the $i$-th integer is the height $h_i$ of the $i$-th stone.", "outputFormat": "Output one positive integer in a single line, the maximum stamina cost you can spend.", "hint": "#### Sample Explanation\n\nFor both samples, jumping in the order given in the input is one of the optimal solutions.\n\n#### Constraints\n\nFor $1 \\leq i \\leq n$, $0 < h_i \\leq 10 ^ 4$, and all $h_i$ are distinct.\n\nFor $10\\%$ of the testdata, $n \\leq 3$.\n\nFor $20\\%$ of the testdata, $n \\leq 10$.\n\nFor $50\\%$ of the testdata, $n \\leq 20$.\n\nFor $80\\%$ of the testdata, $n \\leq 50$.\n\nFor $100\\%$ of the testdata, $n \\leq 300$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "跳跳！", "background": "", "description": "你是一只小跳蛙，你特别擅长在各种地方跳来跳去。\n\n这一天，你和朋友小 F 一起出去玩耍的时候，遇到了一堆高矮不同的石头，其中第 $i$ 块的石头高度为 $h_i$，地面的高度是 $h_0 = 0$。你估计着，从第 $i$ 块石头跳到第 $j$ 块石头上耗费的体力值为 $(h_i - h_j) ^ 2$，从地面跳到第 $i$ 块石头耗费的体力值是 $(h_i) ^ 2$。\n\n为了给小 F 展现你超级跳的本领，你决定跳到每个石头上各一次，并最终停在任意一块石头上，并且小跳蛙想耗费**尽可能多**的体力值。\n\n当然，你只是一只小跳蛙，你只会跳，不知道怎么跳才能让本领更充分地展现。\n\n不过你有救啦！小 F 给你递来了一个写着 AK 的电脑，你可以使用计算机程序帮你解决这个问题，万能的计算机会告诉你怎么跳。\n\n那就请你——会写代码的小跳蛙——写下这个程序，为你 NOIp AK 踏出坚实的一步吧！", "inputFormat": "输入一行一个正整数 $n$，表示石头个数。\n\n输入第二行 $n$ 个正整数，表示第 $i$ 块石头的高度 $h_i$。", "outputFormat": "输出一行一个正整数，表示你可以耗费的体力值的最大值。", "hint": "#### 样例解释\n\n两个样例按照输入给定的顺序依次跳上去就可以得到最优方案之一。\n\n#### 数据范围\n对于 $1 \\leq i \\leq n$，有 $0 < h_i \\leq 10 ^ 4$，且保证 $h_i$ 互不相同。\n\n对于 $10\\%$ 的数据，$n \\leq 3$；\n\n对于 $20\\%$ 的数据，$n \\leq 10$；\n\n对于 $50\\%$ 的数据，$n \\leq 20$；\n\n对于 $80\\%$ 的数据，$n \\leq 50$；\n\n对于 $100\\%$ 的数据，$n \\leq 300$。", "locale": "zh-CN"}}}
{"pid": "P4996", "type": "P", "difficulty": 5, "samples": [["2 2\n00 1\n10 1", "4"], ["3 4\n000 16\n001 9\n110 4\n111 1", "260"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "进制", "洛谷月赛", "状压 DP"], "title": "咕咕咕", "background": "", "description": "小 F 是一个能鸽善鹉的同学，他经常把事情拖到最后一天才去做，导致他的某些日子总是非常匆忙。\n\n比如，时间回溯到了 2018 年 11 月 3 日。小 F 望着自己的任务清单：\n\n1. 看 iG 夺冠；\n2. 补月赛题的锅。\n\n小 F 虽然经常咕咕咕，但他完成任务也是很厉害的，他一次性可以完成剩余任务的任一**非空子集**。比如，他现在可以选择以下几种中的一种：\n\n1. 看 iG 夺冠；\n2. 补月赛题的锅；\n3. 一边看 iG 夺冠的直播，一边补锅。\n\n当然，比赛实在是太精彩了，所以小 F 就去看比赛了。\n\n不过，当金雨从天而降、IG 举起奖杯之时，小 F 突然心生愧疚——锅还没补呢！于是，小 F 的内心产生了一点歉意。\n\n这时小 F 注意到，自己总是在某些情况下会产生歉意。每当他要检查自己的任务表来决定下一项任务的时候，如果当前他干了某些事情，但是没干另一些事情，那么他就会产生一定量的歉意——比如，无论他今天看没看比赛，只要没有补完月赛的锅，他都会在选择任务的时候产生 $1$ 点歉意。小 F 完成所有任务后，他这一天的歉意值等于他每次选择任务时的歉意之和。\n\n过高的歉意值让小 F 感到不安。现在，小 F 告诉你他还有 $n$ 项任务，并告诉你在 $m$ 种情况中的一种 $\\mathrm{state}_i$ 的情况下，小 F 会产生 $a_i$ 点歉意。请你帮忙计算一下，小 F 在那一天所有可能的完成所有任务方式的歉意值之和是多少。\n\n由于答案可能很大，你只需要输出答案对 $998244353$ 取模即可。", "inputFormat": "输入一行两个整数 $n, m$，表示有 $n$ 项任务，在 $m$ 种情况中下小 F 会产生歉意值。\n\n输入接下来 $m$ 行，每行有一个长度为 $n$ 的 $0-1$ 串 $\\mathrm{state}_i$ 和一个歉意值 $a_i$，$\\mathrm{state}_{i, j}$ 为 $0/1$  表示第 $j$ 项任务此时没做 / 已经做了。\n\n详情请参考样例和样例解释。", "outputFormat": "输出一行一个整数，表示小 F 在那一天所有可能的完成任务方式的歉意值之和对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释：\n\n$0-1$ 串中第一个数字表示小 F 看没看比赛，第二个数字表示小 F 补没补锅。\n\n我们用 $\\varnothing$ 表示小 F 什么都没干，$A$ 表示小 F 看了比赛，$B$ 表示小 F 补了锅，那么所有会产生愧疚的方式如下：\n\n$\\varnothing: 1$  \n$\\{A\\}:1$\n\n那么所有可能的选择如下：\n\n$\\varnothing\\rightarrow\\{A\\}\\rightarrow\\{A,B\\}:2$  \n$\\varnothing\\rightarrow\\{B\\}\\rightarrow\\{A,B\\}:1$  \n$\\varnothing\\rightarrow\\{A,B\\}:1$\n\n所以答案是 $2 + 1 + 1 = 4$。\n\n#### 数据范围\n\n保证出现的 $\\mathrm{state}_i$ 互不相同。\n\n对于所有数据，有 $1 \\leq n \\leq 20$, $1 \\leq m \\leq \\min(2 ^ n, 10 ^ 5), 1 \\leq a_i \\leq 10 ^ 5$。\n\n| Case | $n$ |\n| :------:|:------: |\n|1|$1$|\n|2|$2$|\n|3|$3$|\n|4|$10$|\n|5|$12$|\n|6|$14$|\n|7|$16$|\n|8|$18$|\n|9|$19$|\n|10|$20$|\n", "locale": "zh-CN", "translations": {"en": {"title": "Gugugu", "background": "", "description": "Xiao F is a student who is good at “pigeoning” (putting things off). He often delays tasks until the last day, which makes some of his days very rushed.\n\nFor example, time goes back to November 3, 2018. Xiao F looks at his to-do list:\n\n1. Watch iG win the championship.\n2. Fix the problems from the monthly contest.\n\nAlthough Xiao F often goes “gugugu”, he is also very efficient when he works: in one step, he can finish any **non-empty subset** of the remaining tasks. For example, right now he can choose one of the following:\n\n1. Watch iG win the championship.\n2. Fix the monthly contest problems.\n3. Watch the iG live stream while fixing the problems.\n\nOf course, the match is so exciting that Xiao F goes to watch it.\n\nHowever, when the golden rain falls and iG lifts the trophy, Xiao F suddenly feels guilty—the problems are not fixed yet. So, Xiao F feels a bit of remorse.\n\nXiao F notices that he always feels remorse in certain situations. Every time he checks his task list to decide the next tasks, if he has done some tasks but has not done some other tasks, then he will feel a certain amount of remorse. For example, no matter whether he watched the match today or not, as long as he has not finished fixing the monthly contest problems, he will feel $1$ point of remorse when choosing tasks. After Xiao F finishes all tasks, the remorse value for that day equals the sum of the remorse values at each time he chooses tasks.\n\nA too-high remorse value makes Xiao F uneasy. Now, Xiao F tells you he still has $n$ tasks, and tells you that in one of $m$ situations $\\mathrm{state}_i$, Xiao F will feel $a_i$ points of remorse. Please help compute the sum of the remorse values over all possible ways for Xiao F to finish all tasks on that day.\n\nSince the answer may be very large, you only need to output the answer modulo $998244353$.", "inputFormat": "The first line contains two integers $n, m$, meaning there are $n$ tasks, and among $m$ situations Xiao F will generate a remorse value.\n\nThe next $m$ lines each contain a $0$-$1$ string $\\mathrm{state}_i$ of length $n$ and an integer remorse value $a_i$. $\\mathrm{state}_{i, j}$ is $0/1$, meaning that the $j$-th task is not done / already done at that time.\n\nPlease refer to the samples and the sample explanation for details.", "outputFormat": "Output one integer in one line, representing the sum of the remorse values over all possible ways to finish all tasks on that day, modulo $998244353$.", "hint": "#### Sample 1 Explanation:\n\nIn the $0$-$1$ string, the first digit indicates whether Xiao F watched the match, and the second digit indicates whether Xiao F fixed the problems.\n\nWe use $\\varnothing$ to denote that Xiao F did nothing, $A$ to denote that Xiao F watched the match, and $B$ to denote that Xiao F fixed the problems. Then the ways that will produce guilt are as follows:\n\n$\\varnothing: 1$  \n$\\{A\\}:1$\n\nThen all possible choices are:\n\n$\\varnothing\\rightarrow\\{A\\}\\rightarrow\\{A,B\\}:2$  \n$\\varnothing\\rightarrow\\{B\\}\\rightarrow\\{A,B\\}:1$  \n$\\varnothing\\rightarrow\\{A,B\\}:1$\n\nSo the answer is $2 + 1 + 1 = 4$.\n\n#### Constraints\n\nIt is guaranteed that all given $\\mathrm{state}_i$ are pairwise distinct.\n\nFor all testdata, $1 \\leq n \\leq 20$, $1 \\leq m \\leq \\min(2 ^ n, 10 ^ 5), 1 \\leq a_i \\leq 10 ^ 5$.\n\n| Case | $n$ |\n| :------:|:------: |\n|1|$1$|\n|2|$2$|\n|3|$3$|\n|4|$10$|\n|5|$12$|\n|6|$14$|\n|7|$16$|\n|8|$18$|\n|9|$19$|\n|10|$20$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "咕咕咕", "background": "", "description": "小 F 是一个能鸽善鹉的同学，他经常把事情拖到最后一天才去做，导致他的某些日子总是非常匆忙。\n\n比如，时间回溯到了 2018 年 11 月 3 日。小 F 望着自己的任务清单：\n\n1. 看 iG 夺冠；\n2. 补月赛题的锅。\n\n小 F 虽然经常咕咕咕，但他完成任务也是很厉害的，他一次性可以完成剩余任务的任一**非空子集**。比如，他现在可以选择以下几种中的一种：\n\n1. 看 iG 夺冠；\n2. 补月赛题的锅；\n3. 一边看 iG 夺冠的直播，一边补锅。\n\n当然，比赛实在是太精彩了，所以小 F 就去看比赛了。\n\n不过，当金雨从天而降、IG 举起奖杯之时，小 F 突然心生愧疚——锅还没补呢！于是，小 F 的内心产生了一点歉意。\n\n这时小 F 注意到，自己总是在某些情况下会产生歉意。每当他要检查自己的任务表来决定下一项任务的时候，如果当前他干了某些事情，但是没干另一些事情，那么他就会产生一定量的歉意——比如，无论他今天看没看比赛，只要没有补完月赛的锅，他都会在选择任务的时候产生 $1$ 点歉意。小 F 完成所有任务后，他这一天的歉意值等于他每次选择任务时的歉意之和。\n\n过高的歉意值让小 F 感到不安。现在，小 F 告诉你他还有 $n$ 项任务，并告诉你在 $m$ 种情况中的一种 $\\mathrm{state}_i$ 的情况下，小 F 会产生 $a_i$ 点歉意。请你帮忙计算一下，小 F 在那一天所有可能的完成所有任务方式的歉意值之和是多少。\n\n由于答案可能很大，你只需要输出答案对 $998244353$ 取模即可。", "inputFormat": "输入一行两个整数 $n, m$，表示有 $n$ 项任务，在 $m$ 种情况中下小 F 会产生歉意值。\n\n输入接下来 $m$ 行，每行有一个长度为 $n$ 的 $0-1$ 串 $\\mathrm{state}_i$ 和一个歉意值 $a_i$，$\\mathrm{state}_{i, j}$ 为 $0/1$  表示第 $j$ 项任务此时没做 / 已经做了。\n\n详情请参考样例和样例解释。", "outputFormat": "输出一行一个整数，表示小 F 在那一天所有可能的完成任务方式的歉意值之和对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释：\n\n$0-1$ 串中第一个数字表示小 F 看没看比赛，第二个数字表示小 F 补没补锅。\n\n我们用 $\\varnothing$ 表示小 F 什么都没干，$A$ 表示小 F 看了比赛，$B$ 表示小 F 补了锅，那么所有会产生愧疚的方式如下：\n\n$\\varnothing: 1$  \n$\\{A\\}:1$\n\n那么所有可能的选择如下：\n\n$\\varnothing\\rightarrow\\{A\\}\\rightarrow\\{A,B\\}:2$  \n$\\varnothing\\rightarrow\\{B\\}\\rightarrow\\{A,B\\}:1$  \n$\\varnothing\\rightarrow\\{A,B\\}:1$\n\n所以答案是 $2 + 1 + 1 = 4$。\n\n#### 数据范围\n\n保证出现的 $\\mathrm{state}_i$ 互不相同。\n\n对于所有数据，有 $1 \\leq n \\leq 20$, $1 \\leq m \\leq \\min(2 ^ n, 10 ^ 5), 1 \\leq a_i \\leq 10 ^ 5$。\n\n| Case | $n$ |\n| :------:|:------: |\n|1|$1$|\n|2|$2$|\n|3|$3$|\n|4|$10$|\n|5|$12$|\n|6|$14$|\n|7|$16$|\n|8|$18$|\n|9|$19$|\n|10|$20$|\n", "locale": "zh-CN"}}}
{"pid": "P4997", "type": "P", "difficulty": 6, "samples": [["3\nXXX\nOOX\nOO.", "-1 -1"], ["3\nXOO\nXO.\nX..", "2 3\n-1 -1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "并查集", "Special Judge", "连通块", "洛谷月赛"], "title": "不围棋", "background": "「不围棋」是一种非常有趣的棋类游戏。\n\n大家都知道，围棋的「气」是指一个棋子所在的联通块相邻的空格。两粒棋如果在棋盘上线段的两端就认为是相邻的，也就是在同一个连通块里。比如在图中，白子为四个独立的连通块，黑子构成一个连通块，绿色点是黑子连通块唯一的「气」：\n\n![](https://cdn.luogu.com.cn/upload/pic/41011.png )\n\n「提子」是指将没有「气」的棋子提出棋盘，在上图中，如果白方走绿点，那么就可以将黑子全部提走。\n\n在围棋中，我们想尽量多地占领地盘、提走对方棋子。然而，不围棋恰恰相反——不围棋是一种非常和平的游戏，双方的走子不能产生任何提子，也就是说，**任何一次走子不能让棋盘上任何一个棋子所在的连通块没有气**。比如，白方在上图中不能走绿点。\n\n在你的某一步棋后，对方无棋可走，那么你就赢了。", "description": "小 F 对不围棋特别感兴趣，不过他经常输，所以他想做出一个 AI 来替他完成这局游戏。\n\n不过造 AI 实在是太困难啦，小 F 千辛万苦写出来的 AI 被同学们的 AI 锤爆啦！\n\n现在，他想请你帮他实现一个 AI 中一部分的功能——随机模拟，因为他相信你写的程序非常优秀，一定能优化他的 AI。\n\n给你一个 $n \\times n$ 的棋盘，上面或许已经有一些棋子了，但此时局面一定是合法的，即**不存在没有气的连通块**；此时轮到黑棋下棋，因此棋盘上**黑白棋子的数量一定是相等的**。\n\n你的任务是，**依次**为黑棋和白棋**随意**指定一个可行的走子位置，直到某一步游戏无法进行，决出胜负为止。\n\n在正式的不围棋比赛还存在一些禁手规则。不过由于小 F 玩的是一种棋盘大小可变的新型不围棋，我们只用考虑上面提到的气的规则就好。", "inputFormat": "输入一行一个整数 $n$，表示棋盘大小。\n输入接下来 $n$ 行，每行有一个长度为 $n$ 的字符串，表示第 $i$ 行的情况。\n\n* `.` 表示空\n* `X` 表示黑棋\n* `O` 表示白棋\n\n详细请参考样例。\n\n输入保证，棋盘初始局面合法，`X` 与 `O` 数量相等。", "outputFormat": "你需要输出至少一行，假设你输出了 $L$ 行，那么对于前 $L - 1$ 行，你应该输出两个用空格分隔的正整数表示下棋坐标 $x_i, y_i$，其中奇数行表示黑棋的行动，偶数行表示白棋的行动。$x$ 坐标为从上到下从 $1$ 到 $n$，$y$ 坐标为从左到右从 $1$ 到 $n$。\n\n请在第 $L$ 行输出 `-1 -1`，表示此时第 $L$ 手执棋人已经无棋可走。\n\n你的输出可能会很大，即使本题时限为 $3s$，也请你不要使用太慢的方法输出大量内容。\n\n#### 评分方式：\n\n本题启用 Special Judge，并且有部分分。我们将通过以下方式进行计分：\n\n* 如果你输出格式错误，那么该测试点不得分。格式错误包括但不限于：输出了非数字内容；一行输出了超过或者少于两个正整数；输出的坐标在棋盘外；最后一行的输出不是 `-1 -1`。\n* 如果你的输出格式正确，但是你的输出的第一行的答案就是不可接受的，那么该测试点不得分。例如：输出的坐标是黑棋不可以下的位置；黑棋有棋可走却输出了 `-1 -1`。\n* 如果你的输出格式正确，并且你的前 $k(1 \\leq k <L)$ 行输出是可以接受的，那么该测试点将至少得到 $s$ 分，其中 $s = \\lfloor \\lg k \\rfloor + 1$，含义是 $k$ 在十进制表示下是一个 $s$ 位数。\n* 如果你的输出完全正确，无论你输出了多少行，你都将得到 $10$ 分。\n\n详情请参考样例解释。", "hint": "#### 样例 1 解释：\n\n注意到将棋盘下满会让棋盘上所有连通块都没有气，所以黑棋是无棋可走的。\n\n#### 样例 2 解释：\n\n样例 2 还有两个正确的输出是这样的：\n```\n3 2\n2 3\n-1 -1\n```\n```\n3 3\n2 3\n-1 -1\n```\n我们将棋盘表示出来：\n\n![](https://cdn.luogu.com.cn/upload/pic/41216.png)\n\n其中，黑棋是三个空格都可以走的。\n\n* 如果黑棋走 $(2, 3)$，如图，此时白棋走任何位置都会提走相邻的黑棋，白棋无棋可走；\n ![](https://cdn.luogu.com.cn/upload/pic/41219.png)\n\n* 如果黑棋走 $(3, 2)$，如图，此时白棋唯一可走的点是 $(2, 3)$，之后黑棋无棋可走；\n ![](https://cdn.luogu.com.cn/upload/pic/41218.png)\n\n* 如果黑棋走 $(3, 3)$，如图，此时白棋唯一可走的点是 $(2, 3)$，之后黑棋无棋可走；\n ![](https://cdn.luogu.com.cn/upload/pic/41217.png)\n\n这三种情况依次对应三个输出，输出任意一种可得到满分。\n\n#### 评分规则解释：\n\n为了解释评分规则，我们以样例 2 为例，对于以下几种输出：\n```\nI AK IOI\n```\n很不幸，因为您太强了，所以为了按住躁动的您，我们会给您 $0$ 分。\n\n```\n-1 -1\n```\n```\n1 1\n-1 -1\n```\n很不幸，你的第一行没有输出正确，得 $0$ 分。\n\n```\n3 3\n-1 -1\n```\n你输出的前 $1$ 行是正确方案的一部分。由于 $1$ 是 $1$ 位数，恭喜你得到了整整 $1$ 分！\n\n#### 数据范围：\n\n![](https://cdn.luogu.com.cn/upload/pic/41855.png)", "locale": "zh-CN", "translations": {"en": {"title": "No-Go (Not Go)", "background": "“No-Go” is a very interesting board game.\n\nAs everyone knows, in Go, a group’s “liberties” are the empty intersections adjacent to the connected component containing a stone. Two stones are considered adjacent if they are at the two ends of a line segment on the board, meaning they are in the same connected component. For example, in the figure, the white stones form four separate connected components, the black stones form one connected component, and the green point is the only “liberty” of the black group:\n\n![](https://cdn.luogu.com.cn/upload/pic/41011.png )\n\n“Capturing” means removing stones that have no liberties from the board. In the figure above, if White plays at the green point, then all black stones can be captured.\n\nIn Go, we want to occupy as much territory as possible and capture the opponent’s stones. However, No-Go is exactly the opposite—No-Go is a very peaceful game, where neither player is allowed to make any move that results in a capture. That is, **any move must not make any connected component of any stone on the board have zero liberties**. For example, in the figure above, White cannot play at the green point.\n\nAfter one of your moves, if the opponent has no legal move, then you win.", "description": "Little F is very interested in No-Go, but he often loses, so he wants to create an AI to play this game for him.\n\nHowever, building an AI is really too hard. After great effort, Little F’s AI still got completely crushed by his classmates’ AIs.\n\nNow he wants you to help him implement one part of an AI—random simulation—because he believes the program you write is very good and can surely optimize his AI.\n\nYou are given an $n \\times n$ board, which may already contain some stones, but the current position is guaranteed to be legal, i.e., **there is no connected component with no liberties**. It is now Black’s turn to move, so **the numbers of black and white stones on the board are guaranteed to be equal**.\n\nYour task is to **in order**, for Black and then White, **freely** choose a legal move position each time, until at some move the game cannot continue and a winner is decided.\n\nIn official No-Go matches there are also some forbidden-move rules. However, since Little F is playing a new kind of No-Go with variable board size, we only need to consider the liberty rule mentioned above.", "inputFormat": "The first line contains an integer $n$, the board size.  \nThe next $n$ lines each contain a string of length $n$, describing the state of row $i$.\n\n* `.` means empty.\n* `X` means a black stone.\n* `O` means a white stone.\n\nPlease refer to the samples for details.\n\nThe input guarantees that the initial position is legal, and the counts of `X` and `O` are equal.", "outputFormat": "You need to output at least one line. Suppose you output $L$ lines. For each of the first $L - 1$ lines, output two positive integers separated by a space to represent the move coordinates $x_i, y_i$. Odd-numbered lines represent Black’s moves, and even-numbered lines represent White’s moves. The $x$ coordinate is from top to bottom, from $1$ to $n$, and the $y$ coordinate is from left to right, from $1$ to $n$.\n\nOn line $L$, output `-1 -1`, meaning that the player to move on the $L$-th turn has no legal move.\n\nYour output may be very large. Even though the time limit is $3\\text{s}$, please do not use an overly slow method to output a large amount of content.\n\n#### Scoring\n\nThis problem uses a Special Judge and has partial scores. We will score as follows:\n\n* If your output format is wrong, you get $0$ points for that test. Format errors include but are not limited to: outputting non-numeric content; outputting more or fewer than two integers on a line; outputting coordinates outside the board; the last line is not `-1 -1`.\n* If your output format is correct, but the first line of your output is already unacceptable, you get $0$ points for that test. For example: the coordinate is not a legal move for Black; Black has a legal move but you output `-1 -1`.\n* If your output format is correct, and your first $k(1 \\leq k < L)$ lines are acceptable, then you will get at least $s$ points for that test, where $s = \\lfloor \\lg k \\rfloor + 1$. This means that $k$ has $s$ digits in decimal.\n* If your output is completely correct, no matter how many lines you output, you will get $10$ points.\n\nPlease refer to the sample explanation for details.", "hint": "#### Sample 1 Explanation\n\nNote that filling the entire board will make all connected components have no liberties, so Black has no legal move.\n\n#### Sample 2 Explanation\n\nFor Sample 2, there are also two other correct outputs:\n```\n3 2\n2 3\n-1 -1\n```\n```\n3 3\n2 3\n-1 -1\n```\nWe draw the board:\n\n![](https://cdn.luogu.com.cn/upload/pic/41216.png)\n\nHere, Black can play on any of the three empty intersections.\n\n* If Black plays $(2, 3)$, as shown, then any move by White would capture adjacent black stones, so White has no legal move.  \n ![](https://cdn.luogu.com.cn/upload/pic/41219.png)\n\n* If Black plays $(3, 2)$, as shown, then White’s only legal move is $(2, 3)$, after which Black has no legal move.  \n ![](https://cdn.luogu.com.cn/upload/pic/41218.png)\n\n* If Black plays $(3, 3)$, as shown, then White’s only legal move is $(2, 3)$, after which Black has no legal move.  \n ![](https://cdn.luogu.com.cn/upload/pic/41217.png)\n\nThese three cases correspond to the three outputs. Outputting any one of them gives full score.\n\n#### Scoring Rules Explanation\n\nTo explain the scoring rules, we use Sample 2. Consider the following outputs:\n```\nI AK IOI\n```\nUnfortunately, because you are too strong, in order to restrain your restless power, we will give you $0$ points.\n\n```\n-1 -1\n```\n```\n1 1\n-1 -1\n```\nUnfortunately, your first line is not correct, so you get $0$ points.\n\n```\n3 3\n-1 -1\n```\nYour first $1$ line is part of a correct solution. Since $1$ has $1$ digit, congratulations, you get exactly $1$ point.\n\n#### Constraints\n\n![](https://cdn.luogu.com.cn/upload/pic/41855.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "不围棋", "background": "「不围棋」是一种非常有趣的棋类游戏。\n\n大家都知道，围棋的「气」是指一个棋子所在的联通块相邻的空格。两粒棋如果在棋盘上线段的两端就认为是相邻的，也就是在同一个连通块里。比如在图中，白子为四个独立的连通块，黑子构成一个连通块，绿色点是黑子连通块唯一的「气」：\n\n![](https://cdn.luogu.com.cn/upload/pic/41011.png )\n\n「提子」是指将没有「气」的棋子提出棋盘，在上图中，如果白方走绿点，那么就可以将黑子全部提走。\n\n在围棋中，我们想尽量多地占领地盘、提走对方棋子。然而，不围棋恰恰相反——不围棋是一种非常和平的游戏，双方的走子不能产生任何提子，也就是说，**任何一次走子不能让棋盘上任何一个棋子所在的连通块没有气**。比如，白方在上图中不能走绿点。\n\n在你的某一步棋后，对方无棋可走，那么你就赢了。", "description": "小 F 对不围棋特别感兴趣，不过他经常输，所以他想做出一个 AI 来替他完成这局游戏。\n\n不过造 AI 实在是太困难啦，小 F 千辛万苦写出来的 AI 被同学们的 AI 锤爆啦！\n\n现在，他想请你帮他实现一个 AI 中一部分的功能——随机模拟，因为他相信你写的程序非常优秀，一定能优化他的 AI。\n\n给你一个 $n \\times n$ 的棋盘，上面或许已经有一些棋子了，但此时局面一定是合法的，即**不存在没有气的连通块**；此时轮到黑棋下棋，因此棋盘上**黑白棋子的数量一定是相等的**。\n\n你的任务是，**依次**为黑棋和白棋**随意**指定一个可行的走子位置，直到某一步游戏无法进行，决出胜负为止。\n\n在正式的不围棋比赛还存在一些禁手规则。不过由于小 F 玩的是一种棋盘大小可变的新型不围棋，我们只用考虑上面提到的气的规则就好。", "inputFormat": "输入一行一个整数 $n$，表示棋盘大小。\n输入接下来 $n$ 行，每行有一个长度为 $n$ 的字符串，表示第 $i$ 行的情况。\n\n* `.` 表示空\n* `X` 表示黑棋\n* `O` 表示白棋\n\n详细请参考样例。\n\n输入保证，棋盘初始局面合法，`X` 与 `O` 数量相等。", "outputFormat": "你需要输出至少一行，假设你输出了 $L$ 行，那么对于前 $L - 1$ 行，你应该输出两个用空格分隔的正整数表示下棋坐标 $x_i, y_i$，其中奇数行表示黑棋的行动，偶数行表示白棋的行动。$x$ 坐标为从上到下从 $1$ 到 $n$，$y$ 坐标为从左到右从 $1$ 到 $n$。\n\n请在第 $L$ 行输出 `-1 -1`，表示此时第 $L$ 手执棋人已经无棋可走。\n\n你的输出可能会很大，即使本题时限为 $3s$，也请你不要使用太慢的方法输出大量内容。\n\n#### 评分方式：\n\n本题启用 Special Judge，并且有部分分。我们将通过以下方式进行计分：\n\n* 如果你输出格式错误，那么该测试点不得分。格式错误包括但不限于：输出了非数字内容；一行输出了超过或者少于两个正整数；输出的坐标在棋盘外；最后一行的输出不是 `-1 -1`。\n* 如果你的输出格式正确，但是你的输出的第一行的答案就是不可接受的，那么该测试点不得分。例如：输出的坐标是黑棋不可以下的位置；黑棋有棋可走却输出了 `-1 -1`。\n* 如果你的输出格式正确，并且你的前 $k(1 \\leq k <L)$ 行输出是可以接受的，那么该测试点将至少得到 $s$ 分，其中 $s = \\lfloor \\lg k \\rfloor + 1$，含义是 $k$ 在十进制表示下是一个 $s$ 位数。\n* 如果你的输出完全正确，无论你输出了多少行，你都将得到 $10$ 分。\n\n详情请参考样例解释。", "hint": "#### 样例 1 解释：\n\n注意到将棋盘下满会让棋盘上所有连通块都没有气，所以黑棋是无棋可走的。\n\n#### 样例 2 解释：\n\n样例 2 还有两个正确的输出是这样的：\n```\n3 2\n2 3\n-1 -1\n```\n```\n3 3\n2 3\n-1 -1\n```\n我们将棋盘表示出来：\n\n![](https://cdn.luogu.com.cn/upload/pic/41216.png)\n\n其中，黑棋是三个空格都可以走的。\n\n* 如果黑棋走 $(2, 3)$，如图，此时白棋走任何位置都会提走相邻的黑棋，白棋无棋可走；\n ![](https://cdn.luogu.com.cn/upload/pic/41219.png)\n\n* 如果黑棋走 $(3, 2)$，如图，此时白棋唯一可走的点是 $(2, 3)$，之后黑棋无棋可走；\n ![](https://cdn.luogu.com.cn/upload/pic/41218.png)\n\n* 如果黑棋走 $(3, 3)$，如图，此时白棋唯一可走的点是 $(2, 3)$，之后黑棋无棋可走；\n ![](https://cdn.luogu.com.cn/upload/pic/41217.png)\n\n这三种情况依次对应三个输出，输出任意一种可得到满分。\n\n#### 评分规则解释：\n\n为了解释评分规则，我们以样例 2 为例，对于以下几种输出：\n```\nI AK IOI\n```\n很不幸，因为您太强了，所以为了按住躁动的您，我们会给您 $0$ 分。\n\n```\n-1 -1\n```\n```\n1 1\n-1 -1\n```\n很不幸，你的第一行没有输出正确，得 $0$ 分。\n\n```\n3 3\n-1 -1\n```\n你输出的前 $1$ 行是正确方案的一部分。由于 $1$ 是 $1$ 位数，恭喜你得到了整整 $1$ 分！\n\n#### 数据范围：\n\n![](https://cdn.luogu.com.cn/upload/pic/41855.png)", "locale": "zh-CN"}}}
{"pid": "P4998", "type": "P", "difficulty": 4, "samples": [["7 2\n1 1 2 2 3 3 4", "13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "排序", "前缀和"], "title": "信号站", "background": "扶贫行动来到了 Q 村，扶贫队准备在 Q 村修筑信号站，让 Q 村不再“远离尘世”，让人们获得丰富的外界信息。", "description": "Q 村非常非常穷，整个村只有一条路。在这条路上，有 $n$ 户人家，因为条件有限，所以一个点上可能有多户人家。因为山区运输条件落后，所以扶贫队只能修筑 $k$ 个信号站，并且他们希望各信号站的不合理值之和最小。信号站的不合理值是指该信号站到每户人家的距离之和。\n\n距离计算方法：若某信号站的坐标为 $x$，某户人家的坐标为 $y$，那么该信号站与该户人家的距离为 $|x-y|$。\n \n扶贫队善于修筑信号站，但是他们不擅长选址 ~~（因为数学不好 QwQ）~~ ，他们希望你这位编程高手来帮助他们选择修筑信号站的最佳地点，使得 $k$ 个信号站的不合理值之和最小。\n\n数据保证人家数大于信号站数。放置信号站的位置坐标必须为整数，并且同一个位置上最多只能放置一个信号站。", "inputFormat": "输入共两行：\n\n第一行两个用空格隔开的整数 $n,k$，分别代表人家数和信号站数；\n\n第二行 $n$ 个用空格隔开的整数 $a_1,a_2,\\dots,a_n$，依次表示每户人家的坐标。", "outputFormat": "输出一行一个整数，表示最小的不合理值之和。", "hint": "#### 样例解释\n\n在坐标为 $2,3$ 的位置各放置一个信号站，总不合理值为 $6+7=13$，可以证明，没有比这个更优的方案。\n\n#### 数据范围\n\n对于 $70\\%$ 的数据，$1\\le k<n\\le10^3$；  \n对于 $100\\%$ 的数据，$1\\le k<n\\le10^6$，$0\\le a_i\\le10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Signal Stations", "background": "A poverty alleviation program has arrived at Village Q. The team plans to build signal stations in Village Q so that it is no longer “isolated from the outside world”, and so that people can get rich information from outside.", "description": "Village Q is extremely poor, and the whole village has only one road. Along this road, there are $n$ households. Due to limited conditions, there may be multiple households at the same point. Because transportation in the mountains is underdeveloped, the team can only build $k$ signal stations, and they want the sum of the “unreasonableness values” of all stations to be as small as possible. The unreasonableness value of a signal station is defined as the sum of its distances to every household.\n\nDistance is calculated as follows: if a signal station is at coordinate $x$ and a household is at coordinate $y$, then the distance between them is $|x-y|$.\n\nThe team is good at building signal stations, but not good at choosing locations ~~(because they are not good at math QwQ)~~. They hope you, a programming expert, can help them choose the best locations for the signal stations, so that the sum of unreasonableness values of the $k$ signal stations is minimized.\n\nThe testdata guarantees that the number of households is greater than the number of signal stations. The coordinates where signal stations are placed must be integers, and at most one signal station can be placed at the same coordinate.", "inputFormat": "There are two lines of input.\n\nThe first line contains two integers $n, k$ separated by spaces, representing the number of households and the number of signal stations.\n\nThe second line contains $n$ integers $a_1, a_2, \\dots, a_n$ separated by spaces, representing the coordinates of each household.", "outputFormat": "Output one line containing one integer, representing the minimum possible sum of unreasonableness values.", "hint": "#### Sample Explanation\n\nPlace one signal station each at coordinates $2$ and $3$. The total unreasonableness value is $6 + 7 = 13$. It can be proven that there is no better solution.\n\n#### Constraints\n\nFor $70\\%$ of the testdata, $1 \\le k < n \\le 10^3$.\n\nFor $100\\%$ of the testdata, $1 \\le k < n \\le 10^6$, $0 \\le a_i \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "信号站", "background": "扶贫行动来到了 Q 村，扶贫队准备在 Q 村修筑信号站，让 Q 村不再“远离尘世”，让人们获得丰富的外界信息。", "description": "Q 村非常非常穷，整个村只有一条路。在这条路上，有 $n$ 户人家，因为条件有限，所以一个点上可能有多户人家。因为山区运输条件落后，所以扶贫队只能修筑 $k$ 个信号站，并且他们希望各信号站的不合理值之和最小。信号站的不合理值是指该信号站到每户人家的距离之和。\n\n距离计算方法：若某信号站的坐标为 $x$，某户人家的坐标为 $y$，那么该信号站与该户人家的距离为 $|x-y|$。\n \n扶贫队善于修筑信号站，但是他们不擅长选址 ~~（因为数学不好 QwQ）~~ ，他们希望你这位编程高手来帮助他们选择修筑信号站的最佳地点，使得 $k$ 个信号站的不合理值之和最小。\n\n数据保证人家数大于信号站数。放置信号站的位置坐标必须为整数，并且同一个位置上最多只能放置一个信号站。", "inputFormat": "输入共两行：\n\n第一行两个用空格隔开的整数 $n,k$，分别代表人家数和信号站数；\n\n第二行 $n$ 个用空格隔开的整数 $a_1,a_2,\\dots,a_n$，依次表示每户人家的坐标。", "outputFormat": "输出一行一个整数，表示最小的不合理值之和。", "hint": "#### 样例解释\n\n在坐标为 $2,3$ 的位置各放置一个信号站，总不合理值为 $6+7=13$，可以证明，没有比这个更优的方案。\n\n#### 数据范围\n\n对于 $70\\%$ 的数据，$1\\le k<n\\le10^3$；  \n对于 $100\\%$ 的数据，$1\\le k<n\\le10^6$，$0\\le a_i\\le10^6$。", "locale": "zh-CN"}}}
{"pid": "P4999", "type": "P", "difficulty": 4, "samples": [["2\n24 69\n70 120", "411\n498"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数位 DP"], "title": "烦人的数学作业", "background": "NOIP2018初赛结束了，但H还是要上学的啊啊。。上学肯定要完成老师布置的作业，H十分头疼。在如山的作业中，Mr.G布置的数学作业最烦人，H总是完不成~~", "description": "Mr.G 最近在看一些关于数字题的书，他每天愁同学们太~~聪明~~了，所有的作业同学们都能~~做到全对~~（拿到答案）。Mr.G ~~蒙在鼓里~~（心知肚明）。为了使同学们进步，Mr.G 总是创造一些~~简单~~（毒瘤）题来作为作业。以下是数学作业的最后一题题干——\n\n给出一个区间 $L\\sim R $，求 $ L $ 到 $ R $ 区间内**每个数的数字和**，如 $123$ 这个数的数字和为 $1+2+3=6$。\n\n（$ 1 \\leq L \\leq R \\leq 10^2 $）\n\n同学们纷纷做出来了，Mr.G 一看这最后一题跟摆设没区别了呀，于是他迅速修改了题目，把范围定得非常非常大，且有$ T $组数据，将最终的答案 $\\bmod 10^9+7 $。\n\n（$ 1 \\leq L \\leq R \\leq 10^{18} $）\n（$ 1 \\leq T \\leq 20  $）\n\n同学们纷纷被难住了。但 H 为了备战 NOIP2018，没有时间完成 Mr.G 的数学作业 ~~（其实是不想做 QwQ）~~，所以 Ta 找到了你，希望你帮助 Ta 和同学完成这烦人的数学作业！", "inputFormat": "输入共 $ T+1 $ 行；\n\n第 $ 1 $ 行读入 $ T $。代表有 $ T $ 组数据；\n\n第 $ 2 \\sim T+1 $行。读 $ L_i $ 和 $ R_i $。", "outputFormat": "输出共 $ T $ 行，\n\n每行输出 $ L_i $ 和 $ R_i $ 的区间数字和 $\\bmod 10^9+7 $。", "hint": "对于 $ 50\\% $ 的数据，$ 1 \\leq L \\leq R \\leq 10^8 $；\n\n对于 $ 100\\% $ 的数据，$ 1 \\leq L \\leq R \\leq 10^{18}  $，$ 1 \\leq T \\leq 20  $。", "locale": "zh-CN", "translations": {"en": {"title": "Annoying Math Homework", "background": "The NOIP2018 preliminary round is over, but H still has to go to school. Going to school means finishing the homework assigned by teachers, and H is really worried. Among the pile of homework, the math homework assigned by Mr. G is the most annoying, and H can never finish it.", "description": "Recently, Mr. G has been reading some books about number problems. Every day, he worries that the students are too “smart”, and they can do all homework “perfectly” (by getting the answers). Mr. G is “kept in the dark” (but actually knows it well). To help students improve, Mr. G always creates some “easy” (but actually nasty) problems as homework. Below is the statement of the last problem in the math homework:\n\nGiven an interval $L \\sim R$, find the **sum of digits of every number** in the range from $L$ to $R$. For example, the sum of digits of $123$ is $1+2+3=6$.\n\n($1 \\leq L \\leq R \\leq 10^2$.)\n\nThe students all solved it. Mr. G thought this last problem was basically useless, so he quickly modified it: he made the range extremely large, and there are $T$ test cases. Output the final answer $\\bmod 10^9+7$.\n\n($1 \\leq L \\leq R \\leq 10^{18}$.)\n($1 \\leq T \\leq 20$.)\n\nThe students were all stuck. But H is preparing for NOIP2018 and has no time to finish Mr. G’s math homework (actually, Ta just does not want to do it), so Ta came to you, hoping you can help Ta and the classmates finish this annoying math homework.", "inputFormat": "There are $T+1$ lines in total.\n\nLine $1$ contains $T$, meaning there are $T$ test cases.\n\nLines $2$ to $T+1$ contain $L_i$ and $R_i$.", "outputFormat": "Output $T$ lines.\n\nFor each line, output the sum of digits over the interval from $L_i$ to $R_i$, taken $\\bmod 10^9+7$.", "hint": "For $50\\%$ of the testdata, $1 \\leq L \\leq R \\leq 10^8$.\n\nFor $100\\%$ of the testdata, $1 \\leq L \\leq R \\leq 10^{18}$, and $1 \\leq T \\leq 20$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "烦人的数学作业", "background": "NOIP2018初赛结束了，但H还是要上学的啊啊。。上学肯定要完成老师布置的作业，H十分头疼。在如山的作业中，Mr.G布置的数学作业最烦人，H总是完不成~~", "description": "Mr.G 最近在看一些关于数字题的书，他每天愁同学们太~~聪明~~了，所有的作业同学们都能~~做到全对~~（拿到答案）。Mr.G ~~蒙在鼓里~~（心知肚明）。为了使同学们进步，Mr.G 总是创造一些~~简单~~（毒瘤）题来作为作业。以下是数学作业的最后一题题干——\n\n给出一个区间 $L\\sim R $，求 $ L $ 到 $ R $ 区间内**每个数的数字和**，如 $123$ 这个数的数字和为 $1+2+3=6$。\n\n（$ 1 \\leq L \\leq R \\leq 10^2 $）\n\n同学们纷纷做出来了，Mr.G 一看这最后一题跟摆设没区别了呀，于是他迅速修改了题目，把范围定得非常非常大，且有$ T $组数据，将最终的答案 $\\bmod 10^9+7 $。\n\n（$ 1 \\leq L \\leq R \\leq 10^{18} $）\n（$ 1 \\leq T \\leq 20  $）\n\n同学们纷纷被难住了。但 H 为了备战 NOIP2018，没有时间完成 Mr.G 的数学作业 ~~（其实是不想做 QwQ）~~，所以 Ta 找到了你，希望你帮助 Ta 和同学完成这烦人的数学作业！", "inputFormat": "输入共 $ T+1 $ 行；\n\n第 $ 1 $ 行读入 $ T $。代表有 $ T $ 组数据；\n\n第 $ 2 \\sim T+1 $行。读 $ L_i $ 和 $ R_i $。", "outputFormat": "输出共 $ T $ 行，\n\n每行输出 $ L_i $ 和 $ R_i $ 的区间数字和 $\\bmod 10^9+7 $。", "hint": "对于 $ 50\\% $ 的数据，$ 1 \\leq L \\leq R \\leq 10^8 $；\n\n对于 $ 100\\% $ 的数据，$ 1 \\leq L \\leq R \\leq 10^{18}  $，$ 1 \\leq T \\leq 20  $。", "locale": "zh-CN"}}}
{"pid": "P5000", "type": "P", "difficulty": 3, "samples": [["2 6\nHELLOWORLD\nLETUSGO", "NKRRUCUXRJ\n10167740864629920000\nRKZAYMU\n20957073637500\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "高精度"], "title": "Hillwer编码", "background": "在 Z 国的高科技研究中心，科研人员使用的都是最“先进”的 Hillwer 编码（毕竟这里可是国家机密库，储存着最重要的机密资料~~QwQ）。", "description": "Z 国的科技十分发达，一直是各国觊觎的目标，Y 国就是其中之一。经过 Y 国黑客夜以继日的奋斗，终于获得了 Z 国 **Hillwer** 编码的转换方式，并且截获了 $n$ 条原码。BUT（总是有那么多但是~），Y 国的黑客们呕心沥血研究 **Hillwer**，都累得趴下了……所以，转换 **Hillwer** 编码的任务他们就无法完成。\n\nY 国元首听说在遥远的东方国度，有一群才华横溢的少年——就是坐在电脑前的你们！元首希望你能够帮助 Y 国转换编码，他将赠予你 **NOIP_AK 荣耀桂冠**！\n\n**Hillwer** 编码的转换规则如下： 对于每一条原码 $ S $，保证仅由 $ 26 $ 个大写字母组成。将每个字母后移 $ R $ 位，得到中转码 $ S1 $（当 $ S $=`XYZ`,$R=2$ 时，$ S1 $=`ZAB`。即变成当前字母后 $ R $ 个字母，超过 `Z` 则从 `A` 开始）。接着，将中转码进行“符转数”操作，将 $ S1 $ 每一位的 ASCII 码相乘，得到数串 $ Q $。转换后的编码即为 $ Q $。\n\n元首为了检查你是不是偷懒，还要求你把中转码 $ S1 $ 也输出。", "inputFormat": "第 $ 1 $ 行，读入 $ n , R $。\n\n第 $2 \\sim n+1$ 行，每行一条编码 $S$。", "outputFormat": "共 $ 2 \\times n $ 行:\n\n- 奇数行，每行一条中转码 $ S1 $；\n\n- 偶数行，每行一条转换后的编码 $ Q $。", "hint": "对于 $ 30\\% $ 的数据，$ 1 \\leq n \\leq 10 ,1 \\leq R \\leq 10 $；\n\n对于 $ 50\\% $ 的数据，$ 1 \\leq n \\leq 500 ,1 \\leq R \\leq 10^3 $；\n\n对于 $ 100\\% $ 的数据，$ 1 \\leq n \\leq 500 ,1 \\leq R \\leq 10^5 $，原码长度小于 $600$。", "locale": "zh-CN", "translations": {"en": {"title": "Hillwer Encoding", "background": "In the high-tech research center of Country Z, researchers use the most “advanced” Hillwer encoding (after all, this is the national secret vault, storing the most important confidential information~~QwQ).", "description": "Country Z is very technologically advanced and has always been a target coveted by other countries, and Country Y is one of them. After Country Y’s hackers worked day and night, they finally obtained the conversion method of Country Z’s **Hillwer** encoding and intercepted $n$ plaintext strings. BUT (there are always so many “buts”~), after studying **Hillwer** with all their effort, the hackers of Country Y were exhausted… so they cannot finish the task of converting **Hillwer** encoding.\n\nThe leader of Country Y heard that in a faraway eastern land, there is a group of talented teenagers—yes, you who are sitting in front of the computer! The leader hopes you can help Country Y convert the encoding, and he will reward you with the **NOIP_AK Glory Laurel Crown**!\n\nThe conversion rules of **Hillwer** encoding are as follows: For each plaintext string $S$, it is guaranteed to consist only of $26$ uppercase letters. Shift each letter backward by $R$ positions to get the intermediate string $S1$ (when $S$=`XYZ`, $R=2$, then $S1$=`ZAB`. That is, change it to the $R$-th letter after the current one; if it goes past `Z`, start again from `A`). Next, perform the “symbol-to-number” operation on the intermediate string: multiply the ASCII codes of each character in $S1$ to obtain the number string $Q$. The converted encoding is $Q$.\n\nTo check whether you are slacking off, the leader also requires you to output the intermediate string $S1$.", "inputFormat": "Line $1$: read in $n, R$.\n\nLines $2$ to $n+1$: each line contains one encoding $S$.", "outputFormat": "There are $2 \\times n$ lines in total:\n\n- Odd-numbered lines: one intermediate string $S1$ per line.\n\n- Even-numbered lines: one converted encoding $Q$ per line.", "hint": "For $30\\%$ of the testdata, $1 \\leq n \\leq 10$, $1 \\leq R \\leq 10$.\n\nFor $50\\%$ of the testdata, $1 \\leq n \\leq 500$, $1 \\leq R \\leq 10^3$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 500$, $1 \\leq R \\leq 10^5$, and the plaintext length is less than $600$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Hillwer编码", "background": "在 Z 国的高科技研究中心，科研人员使用的都是最“先进”的 Hillwer 编码（毕竟这里可是国家机密库，储存着最重要的机密资料~~QwQ）。", "description": "Z 国的科技十分发达，一直是各国觊觎的目标，Y 国就是其中之一。经过 Y 国黑客夜以继日的奋斗，终于获得了 Z 国 **Hillwer** 编码的转换方式，并且截获了 $n$ 条原码。BUT（总是有那么多但是~），Y 国的黑客们呕心沥血研究 **Hillwer**，都累得趴下了……所以，转换 **Hillwer** 编码的任务他们就无法完成。\n\nY 国元首听说在遥远的东方国度，有一群才华横溢的少年——就是坐在电脑前的你们！元首希望你能够帮助 Y 国转换编码，他将赠予你 **NOIP_AK 荣耀桂冠**！\n\n**Hillwer** 编码的转换规则如下： 对于每一条原码 $ S $，保证仅由 $ 26 $ 个大写字母组成。将每个字母后移 $ R $ 位，得到中转码 $ S1 $（当 $ S $=`XYZ`,$R=2$ 时，$ S1 $=`ZAB`。即变成当前字母后 $ R $ 个字母，超过 `Z` 则从 `A` 开始）。接着，将中转码进行“符转数”操作，将 $ S1 $ 每一位的 ASCII 码相乘，得到数串 $ Q $。转换后的编码即为 $ Q $。\n\n元首为了检查你是不是偷懒，还要求你把中转码 $ S1 $ 也输出。", "inputFormat": "第 $ 1 $ 行，读入 $ n , R $。\n\n第 $2 \\sim n+1$ 行，每行一条编码 $S$。", "outputFormat": "共 $ 2 \\times n $ 行:\n\n- 奇数行，每行一条中转码 $ S1 $；\n\n- 偶数行，每行一条转换后的编码 $ Q $。", "hint": "对于 $ 30\\% $ 的数据，$ 1 \\leq n \\leq 10 ,1 \\leq R \\leq 10 $；\n\n对于 $ 50\\% $ 的数据，$ 1 \\leq n \\leq 500 ,1 \\leq R \\leq 10^3 $；\n\n对于 $ 100\\% $ 的数据，$ 1 \\leq n \\leq 500 ,1 \\leq R \\leq 10^5 $，原码长度小于 $600$。", "locale": "zh-CN"}}}
{"pid": "P5002", "type": "P", "difficulty": 3, "samples": [["7 1 3\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n1 2 4", "31\n7\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "枚举", "最近公共祖先 LCA"], "title": "专心OI - 找祖先", "background": "Imakf 是一个小蒟蒻，他最近刚学了 LCA，他在手机 APPstore 里看到一个游戏也叫做 LCA 就下载了下来。", "description": "这个游戏会给出你一棵树，这棵树有 $N$ 个节点，根结点是 $R$，系统会选中 $M$ 个点 $P_1,P_2 \\cdots P_M$，要Imakf 回答有多少组点对 $(u_i,v_i)$ 的最近公共祖先是 $P_i$。Imakf 是个小蒟蒻，他就算学了 LCA 也做不出，于是只好求助您了。\n\n", "inputFormat": "第一行三个整数 $N , R , M$。\n\n此后 $N-1$ 行，每行两个数 $a,b$，表示 $a,b$ 之间有一条边。\n\n此后 $1 $行，共 $M$ 个数，表示$P_i$。\n\n保证给出的边形成一棵树。", "outputFormat": "输出共 $M$ 行，每行一个数，第 $i$ 行的数表示有多少组点对 $(u_i,v_i)$ 的最近公共祖先是 $P_i$。", "hint": "样例 1 的树如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/pic/37971.png)\n\n 对于询问 1 $~(1,1)\n(1,2)\n(1,3)\n(1,4)\n(1,5)\n(1,6)\n(1,7)\n(2,1)\n(2,3)\n(2,6)\n(2,7)\n(3,1)\n(3,2)\n(3,4)\n(3,5)\n(4,1)\n(4,3)$\n\n$\n(4,6)\n(4,7)\n(5,1)\n(5,3)\n(5,6)\n(5,7)\n(6,1)\n(6,2)\n(6,4)\n(6,5)\n(7,1)\n(7,2)\n(7,4)\n(7,5)$ 共 $31$ 组点对。\n\n询问 2 $(2,2)\n(2,4)\n(2,5)\n(4,2)\n(4,5)\n(5,2)\n(5,4)$ 共 $7$ 组点对。\n\n对于询问 3 $(4,4)$ 共 $1$ 组点对。\n\n$1\\le R\\le N\\leq10000$，$0\\le M\\leq50000$。", "locale": "zh-CN", "translations": {"en": {"title": "Focus OI - Finding Ancestors", "background": "Imakf is a beginner. He has recently learned LCA. He saw a game in the mobile App Store that is also called LCA, so he downloaded it.", "description": "This game gives you a tree with $N$ nodes, where the root is $R$. The system will select $M$ nodes $P_1,P_2 \\cdots P_M$, and asks Imakf to answer how many ordered pairs of nodes $(u_i, v_i)$ have their lowest common ancestor equal to $P_i$. Imakf is a beginner. Even though he has learned LCA, he still cannot solve it, so he has to ask you for help.", "inputFormat": "The first line contains three integers $N, R, M$.\n\nThen $N - 1$ lines follow, each containing two numbers $a, b$, indicating that there is an edge between $a$ and $b$.\n\nThen $1$ line follows, containing $M$ numbers, indicating $P_i$.\n\nIt is guaranteed that the given edges form a tree.", "outputFormat": "Output $M$ lines in total. Each line contains one number. The number on line $i$ indicates how many ordered pairs of nodes $(u_i, v_i)$ have their lowest common ancestor equal to $P_i$.", "hint": "The tree of Sample 1 is shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/pic/37971.png)\n\nFor Query 1 $~(1,1)\n(1,2)\n(1,3)\n(1,4)\n(1,5)\n(1,6)\n(1,7)\n(2,1)\n(2,3)\n(2,6)\n(2,7)\n(3,1)\n(3,2)\n(3,4)\n(3,5)\n(4,1)\n(4,3)$\n\n$\n(4,6)\n(4,7)\n(5,1)\n(5,3)\n(5,6)\n(5,7)\n(6,1)\n(6,2)\n(6,4)\n(6,5)\n(7,1)\n(7,2)\n(7,4)\n(7,5)$ there are $31$ ordered pairs in total.\n\nFor Query 2 $(2,2)\n(2,4)\n(2,5)\n(4,2)\n(4,5)\n(5,2)\n(5,4)$ there are $7$ ordered pairs in total.\n\nFor Query 3 $(4,4)$ there is $1$ ordered pair in total.\n\nConstraints: $1 \\le R \\le N \\leq 10000$, $0 \\le M \\leq 50000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "专心OI - 找祖先", "background": "Imakf 是一个小蒟蒻，他最近刚学了 LCA，他在手机 APPstore 里看到一个游戏也叫做 LCA 就下载了下来。", "description": "这个游戏会给出你一棵树，这棵树有 $N$ 个节点，根结点是 $R$，系统会选中 $M$ 个点 $P_1,P_2 \\cdots P_M$，要Imakf 回答有多少组点对 $(u_i,v_i)$ 的最近公共祖先是 $P_i$。Imakf 是个小蒟蒻，他就算学了 LCA 也做不出，于是只好求助您了。\n\n", "inputFormat": "第一行三个整数 $N , R , M$。\n\n此后 $N-1$ 行，每行两个数 $a,b$，表示 $a,b$ 之间有一条边。\n\n此后 $1 $行，共 $M$ 个数，表示$P_i$。\n\n保证给出的边形成一棵树。", "outputFormat": "输出共 $M$ 行，每行一个数，第 $i$ 行的数表示有多少组点对 $(u_i,v_i)$ 的最近公共祖先是 $P_i$。", "hint": "样例 1 的树如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/pic/37971.png)\n\n 对于询问 1 $~(1,1)\n(1,2)\n(1,3)\n(1,4)\n(1,5)\n(1,6)\n(1,7)\n(2,1)\n(2,3)\n(2,6)\n(2,7)\n(3,1)\n(3,2)\n(3,4)\n(3,5)\n(4,1)\n(4,3)$\n\n$\n(4,6)\n(4,7)\n(5,1)\n(5,3)\n(5,6)\n(5,7)\n(6,1)\n(6,2)\n(6,4)\n(6,5)\n(7,1)\n(7,2)\n(7,4)\n(7,5)$ 共 $31$ 组点对。\n\n询问 2 $(2,2)\n(2,4)\n(2,5)\n(4,2)\n(4,5)\n(5,2)\n(5,4)$ 共 $7$ 组点对。\n\n对于询问 3 $(4,4)$ 共 $1$ 组点对。\n\n$1\\le R\\le N\\leq10000$，$0\\le M\\leq50000$。", "locale": "zh-CN"}}}
{"pid": "P5003", "type": "P", "difficulty": 4, "samples": [["5 5\noooo#\nooooo\n#oo#o\no#ooo\noo#oo\n", "7 2\n"], ["5 5\noooo#\nooooo\n#oo##\no#o#o\noo#oo\n", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "剪枝"], "title": "跳舞的线 - 乱拐弯", "background": "**线初始面对方向请自己确定**。\n\n![您可以写 dp。](https://cdn.luogu.com.cn/upload/pic/30733.png)\n\n玩过了 LCA 之后，Imakf 觉得甚是无聊，于是便打开了 DL。\n\nImakf：刺客传奇又死在 $70\\%$！突然有一点弃坑的想法鸭......\n\nImakf 想起自己玩了 $1$ 年的 DL，卡在园林教堂混沌，肝了几个月终于过了的欣喜，却被这个刺客传奇困住，禁不住泪眼朦胧。泪眼中，他突然发现手机变成了一个一个的像素点！Imakf 非常惊喜！这样不就可以写一个程序自动通关了吗？\n\n可是不一会，他又陷入了失望......\n\nImakf：我不会写啊！！", "description": "线现在在一个地图上，它正在 $(1,1)$ 上（左上角），最终要去到 $(M,N)$ 上。它不但只能往下或往右走，还只能在整数格子上移动。\n\nImakf 有的时候想要炫技，又有时想偷懒，所以他会告诉你这张地图的全貌，你要告诉他到达终点的最多和最少拐弯次数。", "inputFormat": "第一行两个正整数 $M$ 和 $N$。\n\n第 $2\\sim M+1$ 行，每行 $N$ 个字符。如果为 `#` 就代表这里有障碍，反之没有。", "outputFormat": "输出两个正整数 $max$ 和 $min$。$max$ 表示最多拐弯次数，$min$ 表示最少拐弯次数。如果到达不了就输出 `-1`。", "hint": "样例 $1$ 说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/12623.png)\n\n红色路线代表拐弯次数最多，蓝色路线代表拐弯次数最少。\n\n--------------\n\n样例 $2$ 说明：\n\n无法到达，故输出 `-1`。\n\n---\n\n数据范围：\n\n| 测试点 | $N$ | $M$ |\n| -----------: | -----------: | -----------: |\n| $1\\sim 5$ | $\\leq100$ | $\\leq100$ |\n| $6\\sim 7$ | $=200$ | 不做约定 |\n| $8\\sim 10$ | 不做约定 |不做约定|\n\n对于 $100\\%$ 的数据，保证 $10\\le M,N\\le 1000$。\n\n感谢 @Iowa\\_BattleShip 指出数据错误。", "locale": "zh-CN", "translations": {"en": {"title": "Dancing Line - Random Turns", "background": "The initial facing direction of the line can be chosen by yourself.\n\n![You can write DP.](https://cdn.luogu.com.cn/upload/pic/30733.png)\n\nAfter playing with LCA, Imakf felt bored and opened DL.\n\nImakf: Assassin Legend died again at $70\\%$! I suddenly feel like quitting...\n\nImakf remembered that after playing DL for $1$ year, getting stuck on \"Garden\", \"Church\", and \"Chaos\", he finally cleared them after months of grinding and was delighted, but now he is trapped by this Assassin Legend again, and tears welled up in his eyes. Through the tears, he suddenly saw the phone turn into pixels! Imakf was thrilled! Then he could write a program to clear it automatically, right?\n\nBut shortly after, disappointment returned...\n\nImakf: I don’t know how to write it!!", "description": "A line is on a grid map. It starts at $(1, 1)$ (top-left corner) and must reach $(M, N)$. It can only move down or right, and only on integer grid points.\n\nSometimes Imakf wants to show off, and sometimes he wants to be lazy, so he will give you the entire map. You need to tell him the maximum and minimum number of turns needed to reach the destination.", "inputFormat": "The first line contains two positive integers $M$ and $N$.\n\nLines $2 \\sim M+1$ each contain $N$ characters. A `#` denotes an obstacle; otherwise, the cell is free.", "outputFormat": "Output two positive integers $max$ and $min$. $max$ is the maximum number of turns, and $min$ is the minimum number of turns. If the destination is unreachable, output `-1`.", "hint": "Explanation for Sample $1$:\n\n![](https://cdn.luogu.com.cn/upload/pic/12623.png)\n\nThe red route has the most turns, and the blue route has the fewest turns.\n\n--------------\n\nExplanation for Sample $2$:\n\nUnreachable, so output `-1`.\n\n---\n\nConstraints:\n\n| Test points | $N$ | $M$ |\n| -----------: | -----------: | -----------: |\n| $1 \\sim 5$ | $\\leq 100$ | $\\leq 100$ |\n| $6 \\sim 7$ | $=200$ | not specified |\n| $8 \\sim 10$ | not specified | not specified |\n\nFor $100\\%$ of the testdata, it is guaranteed that $10 \\le M, N \\le 1000$.\n\nThanks to @Iowa_BattleShip for pointing out the data error.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "跳舞的线 - 乱拐弯", "background": "**线初始面对方向请自己确定**。\n\n![您可以写 dp。](https://cdn.luogu.com.cn/upload/pic/30733.png)\n\n玩过了 LCA 之后，Imakf 觉得甚是无聊，于是便打开了 DL。\n\nImakf：刺客传奇又死在 $70\\%$！突然有一点弃坑的想法鸭......\n\nImakf 想起自己玩了 $1$ 年的 DL，卡在园林教堂混沌，肝了几个月终于过了的欣喜，却被这个刺客传奇困住，禁不住泪眼朦胧。泪眼中，他突然发现手机变成了一个一个的像素点！Imakf 非常惊喜！这样不就可以写一个程序自动通关了吗？\n\n可是不一会，他又陷入了失望......\n\nImakf：我不会写啊！！", "description": "线现在在一个地图上，它正在 $(1,1)$ 上（左上角），最终要去到 $(M,N)$ 上。它不但只能往下或往右走，还只能在整数格子上移动。\n\nImakf 有的时候想要炫技，又有时想偷懒，所以他会告诉你这张地图的全貌，你要告诉他到达终点的最多和最少拐弯次数。", "inputFormat": "第一行两个正整数 $M$ 和 $N$。\n\n第 $2\\sim M+1$ 行，每行 $N$ 个字符。如果为 `#` 就代表这里有障碍，反之没有。", "outputFormat": "输出两个正整数 $max$ 和 $min$。$max$ 表示最多拐弯次数，$min$ 表示最少拐弯次数。如果到达不了就输出 `-1`。", "hint": "样例 $1$ 说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/12623.png)\n\n红色路线代表拐弯次数最多，蓝色路线代表拐弯次数最少。\n\n--------------\n\n样例 $2$ 说明：\n\n无法到达，故输出 `-1`。\n\n---\n\n数据范围：\n\n| 测试点 | $N$ | $M$ |\n| -----------: | -----------: | -----------: |\n| $1\\sim 5$ | $\\leq100$ | $\\leq100$ |\n| $6\\sim 7$ | $=200$ | 不做约定 |\n| $8\\sim 10$ | 不做约定 |不做约定|\n\n对于 $100\\%$ 的数据，保证 $10\\le M,N\\le 1000$。\n\n感谢 @Iowa\\_BattleShip 指出数据错误。", "locale": "zh-CN"}}}
{"pid": "P5004", "type": "P", "difficulty": 5, "samples": [["5 1 \n", "13\n"], ["6 2 \n", "13\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "矩阵加速", "构造"], "title": "专心OI - 跳房子", "background": "Imakf 有一天参加了 PINO2017 PJ 组，他突然看见最后一道题：\n\n![](https://cdn.luogu.com.cn/upload/pic/39659.png )\n\n他十分蒟蒻，写不出来。\n\n而如今他还是一个蒟蒻，他又看见一道题：\n\n![](https://cdn.luogu.com.cn/upload/pic/39660.png)\n\n他还是写不出来，于是便来请教您。", "description": "您有 $N$ 个格子，排成一行，从左往右编号为 $1,2,\\cdots,N$。您站在 $1$ 号格子的左边无限远，开始从左往右跳，跳到 $N$ 号格子右侧为止。由于您是一位成功的 OIer，您自然长得很胖，所以您的腿部力量也非常大！这使得您跳一次，当前格子到目标格子中间必须至少空出来 $M$ 格，但您可以跳无数格远！\n\n您认为这么跳太没意思了，于是便想计算出有多少种方案可以跳完全程。由于方案可能过多，您会输出方案数量模 $(10^9+7)$ 的值\n\n方案不同当且仅当经过的任一一个格子编号不同。", "inputFormat": "第一行两个整数 $N,M$。", "outputFormat": "一个整数，表示跳完全程的方案模 $(10^9+7)$。", "hint": "| 测试数据编号 | $N$ | $M$ |  \n| :-----------: | :-----------: | :-----------: |\n|$1,2$ | $\\leq10$ | $=1$ |    \n| $3,4$ | $\\leq10^7$ | $=1$ |    \n| $5,6$ | $\\leq10^6$ | $=2$ |  \n| $7,8$ | $\\leq10^5$ | $=3$ |  \n| $9,10$ | $\\leq10^4$ | $=5$ |  \n| $11,12$ | $\\leq10^{12}$ | $=1$ |  \n| $13,14$ | $\\leq10^{18}$ |$=10$  |  \n| $15\\sim20$ | $\\leq10^{18}$ |  $=15$|  \n\n对于 $100\\%$ 的数据，满足 $1 \\le N \\le 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "Focus on OI - Hopscotch", "background": "Imakf once participated in the PINO2017 PJ division, and suddenly saw the last problem:\n\n![](https://cdn.luogu.com.cn/upload/pic/39659.png)\n\nHe was very weak and could not solve it.\n\nNow he is still weak, and he saw another problem:\n\n![](https://cdn.luogu.com.cn/upload/pic/39660.png)\n\nHe still could not solve it, so he came to ask you for help.", "description": "You have $N$ cells arranged in a line, numbered from left to right as $1,2,\\cdots,N$. You stand infinitely far to the left of cell $1$, and start jumping from left to right, until you reach the right side of cell $N$. Since you are a successful OIer, you are naturally very heavy, so your legs are very strong. This means that for each jump, there must be at least $M$ empty cells between the current cell and the target cell, but you can jump arbitrarily far.\n\nYou think jumping like this is too boring, so you want to calculate how many different ways there are to complete the whole journey. Since the number of ways may be too large, output the number of ways modulo $(10^9+7)$.\n\nTwo ways are different if and only if there exists at least one visited cell whose index is different.", "inputFormat": "The first line contains two integers $N,M$.", "outputFormat": "Output one integer, the number of ways to complete the whole journey modulo $(10^9+7)$.", "hint": "| Testdata ID | $N$ | $M$ |\n| :-----------: | :-----------: | :-----------: |\n| $1,2$ | $\\leq10$ | $=1$ |\n| $3,4$ | $\\leq10^7$ | $=1$ |\n| $5,6$ | $\\leq10^6$ | $=2$ |\n| $7,8$ | $\\leq10^5$ | $=3$ |\n| $9,10$ | $\\leq10^4$ | $=5$ |\n| $11,12$ | $\\leq10^{12}$ | $=1$ |\n| $13,14$ | $\\leq10^{18}$ | $=10$ |\n| $15\\sim20$ | $\\leq10^{18}$ | $=15$ |\n\nFor $100\\%$ of the data, $1 \\le N \\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "专心OI - 跳房子", "background": "Imakf 有一天参加了 PINO2017 PJ 组，他突然看见最后一道题：\n\n![](https://cdn.luogu.com.cn/upload/pic/39659.png )\n\n他十分蒟蒻，写不出来。\n\n而如今他还是一个蒟蒻，他又看见一道题：\n\n![](https://cdn.luogu.com.cn/upload/pic/39660.png)\n\n他还是写不出来，于是便来请教您。", "description": "您有 $N$ 个格子，排成一行，从左往右编号为 $1,2,\\cdots,N$。您站在 $1$ 号格子的左边无限远，开始从左往右跳，跳到 $N$ 号格子右侧为止。由于您是一位成功的 OIer，您自然长得很胖，所以您的腿部力量也非常大！这使得您跳一次，当前格子到目标格子中间必须至少空出来 $M$ 格，但您可以跳无数格远！\n\n您认为这么跳太没意思了，于是便想计算出有多少种方案可以跳完全程。由于方案可能过多，您会输出方案数量模 $(10^9+7)$ 的值\n\n方案不同当且仅当经过的任一一个格子编号不同。", "inputFormat": "第一行两个整数 $N,M$。", "outputFormat": "一个整数，表示跳完全程的方案模 $(10^9+7)$。", "hint": "| 测试数据编号 | $N$ | $M$ |  \n| :-----------: | :-----------: | :-----------: |\n|$1,2$ | $\\leq10$ | $=1$ |    \n| $3,4$ | $\\leq10^7$ | $=1$ |    \n| $5,6$ | $\\leq10^6$ | $=2$ |  \n| $7,8$ | $\\leq10^5$ | $=3$ |  \n| $9,10$ | $\\leq10^4$ | $=5$ |  \n| $11,12$ | $\\leq10^{12}$ | $=1$ |  \n| $13,14$ | $\\leq10^{18}$ |$=10$  |  \n| $15\\sim20$ | $\\leq10^{18}$ |  $=15$|  \n\n对于 $100\\%$ 的数据，满足 $1 \\le N \\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5005", "type": "P", "difficulty": 5, "samples": [["1 1 \n", "2"], ["3 3 \n", "145"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["枚举", "进制", "状压 DP"], "title": "中国象棋 - 摆上马", "background": "~~相信自己的做法 大喊一声 I won't MLE！您就会过这道题~~\n\nImakf 玩腻了国际象棋，决定玩一玩中国象棋。\n\n他发现中国象棋的马和国际象棋的马有所不同，他意识到这又可以出一道简单的问题，于是他又准备摆一摆马了", "description": "Imakf 有一个 $X$ 行 $Y$ 列的棋盘，还有很多**完全相同**的马（你可以认为有无数个）。现在在棋盘上摆上马（或者不摆），求任何马无法攻击另一匹马的方案总数。\n\n中国象棋的马和国际象棋的马不同。\n\n![](https://cdn.luogu.com.cn/upload/pic/40761.png)\n\n注意：实际问题中是没有兵的。\n\n当然由于方案可能过多，请输出对 $(10^9+7)$ 取模的值\n", "inputFormat": "第一行两个正整数 $X,Y$。", "outputFormat": "方案对 $(10^9+7)$ 取模的值。", "hint": "对于 100% 的数据，有 $1\\le X\\leq100$，$1\\le Y\\leq6$。\n\n对于 20% 的数据，有 $X,Y\\leq6$。\n\n对于另外 20% 的数据，有 $X\\leq20$。\n\n对于样例 1，可以选择不摆或者摆。\n\n对于样例 2，我有一个绝妙的解释可惜我写不下。\n", "locale": "zh-CN", "translations": {"en": {"title": "Chinese Chess - Placing Horses", "background": "~~Believe in your method, shout \"I won't MLE!\", and you will pass this problem.~~\n\nImakf got tired of playing international chess and decided to try Chinese chess.\n\nHe found that the horse in Chinese chess is different from the knight in international chess. He realized this could make another easy problem, so he decided to place horses again.", "description": "Imakf has a board with $X$ rows and $Y$ columns, and many **identical** horses (you may assume there are infinitely many). Now place horses on the board (or place none). Find the total number of ways such that no horse can attack another horse.\n\nThe horse in Chinese chess is different from the knight in international chess.\n\n![](https://cdn.luogu.com.cn/upload/pic/40761.png)\n\nNote: In the actual problem, there are no pawns.\n\nSince the number of ways may be too large, output the value modulo $(10^9+7)$.", "inputFormat": "The first line contains two positive integers $X, Y$.", "outputFormat": "Output the number of ways modulo $(10^9+7)$.", "hint": "For 100% of the data, $1\\le X\\leq100$, $1\\le Y\\leq6$.\n\nFor 20% of the data, $X, Y\\leq6$.\n\nFor another 20% of the data, $X\\leq20$.\n\nFor Sample 1, you may choose to place none or place horses.\n\nFor Sample 2, I have a brilliant explanation, but unfortunately I cannot fit it here.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "中国象棋 - 摆上马", "background": "~~相信自己的做法 大喊一声 I won't MLE！您就会过这道题~~\n\nImakf 玩腻了国际象棋，决定玩一玩中国象棋。\n\n他发现中国象棋的马和国际象棋的马有所不同，他意识到这又可以出一道简单的问题，于是他又准备摆一摆马了", "description": "Imakf 有一个 $X$ 行 $Y$ 列的棋盘，还有很多**完全相同**的马（你可以认为有无数个）。现在在棋盘上摆上马（或者不摆），求任何马无法攻击另一匹马的方案总数。\n\n中国象棋的马和国际象棋的马不同。\n\n![](https://cdn.luogu.com.cn/upload/pic/40761.png)\n\n注意：实际问题中是没有兵的。\n\n当然由于方案可能过多，请输出对 $(10^9+7)$ 取模的值\n", "inputFormat": "第一行两个正整数 $X,Y$。", "outputFormat": "方案对 $(10^9+7)$ 取模的值。", "hint": "对于 100% 的数据，有 $1\\le X\\leq100$，$1\\le Y\\leq6$。\n\n对于 20% 的数据，有 $X,Y\\leq6$。\n\n对于另外 20% 的数据，有 $X\\leq20$。\n\n对于样例 1，可以选择不摆或者摆。\n\n对于样例 2，我有一个绝妙的解释可惜我写不下。\n", "locale": "zh-CN"}}}
{"pid": "P5006", "type": "P", "difficulty": 3, "samples": [["5 5\nMMMMM\nRRRRR\nQQQQQ\nYYYYY\n.....\n5 5 5\n5 1\n10 10\n8\n2 3\n1\n2 3\n2 3\n2 3\n1\n2 2\n1", "0 10 15\n1 15 15\n2 15 15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "2018", "O2优化"], "title": "[yLOI2018] 大美江湖", "background": "> 细雪飘落长街，枫叶红透又一年。  \n> 不只为故友流连，其实我也恋长安。   \n> 听门外足音慢，依稀见旧时容颜。  \n> 故事几经悲欢，结局都与你有关。\n\n——银临《大美江湖》\n\n本题原名《空间复杂度》。", "description": "扶苏听着《大美江湖》，在剑三里控制着他的人物炮姐来到了长安。 \n\n长安城中有一个任务，需要扶苏进入地下的机关道，机关道是的地图一个 $n$ 行 $m$ 列的矩形方格图，每个方格内部都有一些怪物或者药水。扶苏操控着炮姐在机关道中游荡。有些时候他希望问问你他的角色一扶苏一有多少攻击力、防御力以及丢失了多少血量。 \n\n地图中共有三种药水和一种怪物，分别用字符 `R`，`Q`，`Y`，`M` 代表。其中：\n\n- 字符 `R` 代表生命药水，可以减少炮姐丢失的 $10$ 点 血量 $HP$。如果本身损失的 $HP$ 不大于 $10$，则损失的血量会变成 $0$。\n- 字符 `Q` 代表力量药水，可以增加炮姐 $5$ 点攻击力 $ST$。\n- 字符 `Y` 代表防御药水，可以增加炮姐 $5$ 点防御力 $DE$。\n- 字符 `M` 代表怪物，会对炮姐造成伤害。\n\n每只怪物都有三个属性，分别是血量 $HP_0$，攻击力 $ST_0$，防御力 $DE_0$。为了~~降低验题人工作量~~题目难度，所有怪物的属性都是相同的。\n\n一旦走到怪物格，遭遇战将开始。扶苏一定会打死怪物，但是怪物也会对扶苏造成一定的伤害。具体的，怪物对扶苏造成的伤害为\n\n$$\\max(1, \\left\\lceil \\frac{HP_0}{\\max(1, ST - DE_0)}\\right\\rceil \\times \\max(1, ST_0 - DE))$$\n\n其中 $\\max(a, b)$ 代表取 $a$ 和 $b$ 中较大的数，$\\lceil x \\rceil$ 代表**不小于** $x$ 的最小整数。下标为 $0$ 的值代表怪物的参数，不带下标值的为角色的参数。\n\n你会收到 $q$ 次操作，每次操作要么是一次查询，要么是一次移动。 \n\n对于移动，你会再获得一个数字参数，这个参数只可能是 $1/2/3/4$ 其中的一个，代表炮姐向地图的**左/右/上/下**移动。向上移动代表角色所在的行数减一，列数不变，其他方向类似。\n\n对于查询，需要你输出炮姐损失了多少血量，以及当前的攻击力和防御力分别是多少。\n\n请注意，如果多次进入同一个格子，那么格子上的药水会被重复拾取，小怪也会再次出现。即你可以认为离开一个格子以后该格子会恢复原状。\n\n请注意，如果初始位置有怪物，也不会发生战斗，如果初始位置有药水，也不会将之捡拾。", "inputFormat": "每个测试点有且仅有一组测试数据。\n\n输入的第一行是两个用空格隔开的整数，代表地图的行数 $n$ 和列数 $m$。\n\n第 $2$ 到第 $(n + 1)$ 行，每行有一个长度为 $m$ 的字符串，第 $(i + 1)$ 行的第 $j$ 个字符 $C_{i, j}$ 代表第 $i$ 行第 $j$ 列的方格中物品/生物。特别的，若 $C_{i, j}$ 为一个字符 `.`，则意味着该处没有任何东西，但是可以通行。\n\n第 $(n + 2)$ 行有三个用空格隔开的整数，分别代表怪物的血量 $HP_0$，攻击力 $ST_0$ 和防御力 $DE_0$。\n\n第 $(n + 3)$ 行有两个整数，分别代表角色初始所在的行数 $x$ 和列数 $y$。\n\n第 $(n + 4)$ 行有两个用空格隔开的整数，代表角色初始的攻击力 $ST$ 和防御力 $DE$。\n\n第 $(n + 5)$ 行是一个整数，代表操作的次数 $q$。\n\n第 $(n + 6)$ 到第 $(n + q + 5)$ 行，每行首先有一个整数 $op$，代表本次操作的类型。\n\n- 若 $op = 1$，则本次操作是一次查询操作。\n- 若 $op = 2$，则本次操作是一次移动，一个空格后会有一个整数 $d$，作为移动的参数。", "outputFormat": "对于每次查询操作，输出一行三个用单个空格隔开的整数，分别代表角色损失的血量 $HP$，以及当前的攻击力 $ST$ 和防御力 $DE$。", "hint": "#### 数据规模与约定\n\n| 测试点编号 |    $n$     |    $m$     |     $q$     |      特殊性质      |\n| :--------: | :--------: | :--------: | :---------: | :----------------: |\n|    $1$     |    $=1$    |    $=1$    |    $=0$     |         无         |\n|   $2,3$    |    $=1$    | $\\leq 10$  | $\\leq 1000$ |         无         |\n|   $4, 5$   |    $=1$    |    $=1$    | $\\leq 1000$ |   保证 $op = 1$    |\n|  $6,7,8$   | $\\leq 100$ | $\\leq 100$ | $\\leq 10^4$ | 保证地图中没有怪物 |\n|  $9, 10$   | $\\leq 100$ | $\\leq 100$ | $\\leq 10^4$ |         无         |\n\n对于全部的测试点，保证：\n\n- $1 \\leq n, m \\leq 100$，$0 \\leq q \\leq 10^4$。\n- $0 \\leq ST_0, DE_0, HP_0, ST, DE \\leq 100$。\n- $1 \\leq op \\leq 2$，$1 \\leq d \\leq 4$。\n- $C_{i, j}$ 只可能是 `.`，`R`，`Q`，`Y`，`M` 其中之一。\n- 保证人物移动过程中的任何时刻，所在行数都是不大于 $n$ 的正整数，所在列数都是不大于 $m$ 的正整数。", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2018] The Great Jianghu.", "background": "> Light snow falls on the long street, and the maple leaves turn red again each year.  \n> I do not linger only for old friends; in fact, I also love Chang’an.  \n> The footsteps outside the door are slow; I seem to see the familiar face from the past.  \n> The story has gone through joys and sorrows many times, and every ending is related to you.  \n\n— Yin Lin, *The Great Jianghu*.\n\nThis problem was originally named *Space Complexity*.", "description": "While listening to *The Great Jianghu*, Fusu controls his character “Paojie” in JX3 and arrives in Chang’an.\n\nIn Chang’an there is a quest that requires Fusu to enter an underground “mechanism corridor”. The corridor map is a rectangular grid with $n$ rows and $m$ columns. Each cell contains some monsters or potions. Fusu controls Paojie wandering in the corridor. Sometimes he wants to ask you how much attack power, defense, and lost HP his character (Fusu) currently has.\n\nThere are three kinds of potions and one kind of monster on the map, represented by characters `R`, `Q`, `Y`, `M`, respectively. Specifically:\n\n- Character `R` represents an HP potion, which can reduce Paojie’s lost HP $HP$ by $10$. If the currently lost $HP$ is not greater than $10$, then the lost HP becomes $0$.\n- Character `Q` represents a strength potion, which increases Paojie’s attack power $ST$ by $5$.\n- Character `Y` represents a defense potion, which increases Paojie’s defense $DE$ by $5$.\n- Character `M` represents a monster, which will deal damage to Paojie.\n\nEach monster has three attributes: HP $HP_0$, attack power $ST_0$, and defense $DE_0$. To ~~reduce the workload of the validator~~ reduce the difficulty, all monsters have the same attributes.\n\nOnce you step onto a monster cell, a battle starts. Fusu will definitely kill the monster, but the monster will also deal some damage to Fusu. Specifically, the damage dealt to Fusu is\n\n$$\\max(1, \\left\\lceil \\frac{HP_0}{\\max(1, ST - DE_0)}\\right\\rceil \\times \\max(1, ST_0 - DE))$$\n\nwhere $\\max(a, b)$ means the larger of $a$ and $b$, and $\\lceil x \\rceil$ is the smallest integer **not less than** $x$. Values with subscript $0$ are the monster’s parameters, and values without subscripts are the character’s parameters.\n\nYou will receive $q$ operations. Each operation is either a query or a move.\n\nFor a move, you will be given an additional numeric parameter, which can only be one of $1/2/3/4$, meaning that Paojie moves **left/right/up/down** on the map. Moving up means the row number decreases by one and the column stays the same; other directions are analogous.\n\nFor a query, you need to output how much HP Paojie has lost, and the current attack power and defense.\n\nNote that if you enter the same cell multiple times, the potion in that cell will be picked up repeatedly, and the monster will appear again. That is, you may assume that after leaving a cell, it returns to its original state.\n\nAlso note that if there is a monster at the initial position, no battle occurs; if there is a potion at the initial position, it will not be picked up.", "inputFormat": "Each test point contains exactly one set of testdata.\n\nThe first line contains two integers separated by spaces, representing the number of rows $n$ and columns $m$ of the map.\n\nLines $2$ to $(n + 1)$ each contain a string of length $m$. The $j$-th character $C_{i, j}$ in line $(i + 1)$ represents the item/creature in the cell at row $i$ and column $j$. In particular, if $C_{i, j}$ is the character `.`, it means there is nothing there, but the cell is passable.\n\nLine $(n + 2)$ contains three integers separated by spaces, representing the monster’s HP $HP_0$, attack power $ST_0$, and defense $DE_0$.\n\nLine $(n + 3)$ contains two integers, representing the character’s initial row $x$ and initial column $y$.\n\nLine $(n + 4)$ contains two integers separated by spaces, representing the character’s initial attack power $ST$ and defense $DE$.\n\nLine $(n + 5)$ contains an integer, representing the number of operations $q$.\n\nLines $(n + 6)$ to $(n + q + 5)$ each start with an integer $op$, representing the type of this operation.\n\n- If $op = 1$, this operation is a query.\n- If $op = 2$, this operation is a move. After a space there will be an integer $d$ as the movement parameter.", "outputFormat": "For each query operation, output one line with three integers separated by single spaces: the character’s lost HP $HP$, and the current attack power $ST$ and defense $DE$.", "hint": "#### Constraints\n\n| Test Point ID |    $n$     |    $m$     |     $q$     |    Special Property     |\n| :-----------: | :--------: | :--------: | :---------: | :---------------------: |\n|      $1$      |    $=1$    |    $=1$    |    $=0$     |          None           |\n|    $2,3$      |    $=1$    | $\\leq 10$  | $\\leq 1000$ |          None           |\n|    $4,5$      |    $=1$    |    $=1$    | $\\leq 1000$ | Guaranteed $op = 1$     |\n|    $6,7,8$    | $\\leq 100$ | $\\leq 100$ | $\\leq 10^4$ | No monsters on the map  |\n|    $9, 10$    | $\\leq 100$ | $\\leq 100$ | $\\leq 10^4$ |          None           |\n\nFor all test points, it is guaranteed that:\n\n- $1 \\leq n, m \\leq 100$, $0 \\leq q \\leq 10^4$.\n- $0 \\leq ST_0, DE_0, HP_0, ST, DE \\leq 100$.\n- $1 \\leq op \\leq 2$, $1 \\leq d \\leq 4$.\n- $C_{i, j}$ can only be one of `.`, `R`, `Q`, `Y`, `M`.\n- During the entire movement process, the current row is always a positive integer not greater than $n$, and the current column is always a positive integer not greater than $m$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2018] 大美江湖", "background": "> 细雪飘落长街，枫叶红透又一年。  \n> 不只为故友流连，其实我也恋长安。   \n> 听门外足音慢，依稀见旧时容颜。  \n> 故事几经悲欢，结局都与你有关。\n\n——银临《大美江湖》\n\n本题原名《空间复杂度》。", "description": "扶苏听着《大美江湖》，在剑三里控制着他的人物炮姐来到了长安。 \n\n长安城中有一个任务，需要扶苏进入地下的机关道，机关道是的地图一个 $n$ 行 $m$ 列的矩形方格图，每个方格内部都有一些怪物或者药水。扶苏操控着炮姐在机关道中游荡。有些时候他希望问问你他的角色一扶苏一有多少攻击力、防御力以及丢失了多少血量。 \n\n地图中共有三种药水和一种怪物，分别用字符 `R`，`Q`，`Y`，`M` 代表。其中：\n\n- 字符 `R` 代表生命药水，可以减少炮姐丢失的 $10$ 点 血量 $HP$。如果本身损失的 $HP$ 不大于 $10$，则损失的血量会变成 $0$。\n- 字符 `Q` 代表力量药水，可以增加炮姐 $5$ 点攻击力 $ST$。\n- 字符 `Y` 代表防御药水，可以增加炮姐 $5$ 点防御力 $DE$。\n- 字符 `M` 代表怪物，会对炮姐造成伤害。\n\n每只怪物都有三个属性，分别是血量 $HP_0$，攻击力 $ST_0$，防御力 $DE_0$。为了~~降低验题人工作量~~题目难度，所有怪物的属性都是相同的。\n\n一旦走到怪物格，遭遇战将开始。扶苏一定会打死怪物，但是怪物也会对扶苏造成一定的伤害。具体的，怪物对扶苏造成的伤害为\n\n$$\\max(1, \\left\\lceil \\frac{HP_0}{\\max(1, ST - DE_0)}\\right\\rceil \\times \\max(1, ST_0 - DE))$$\n\n其中 $\\max(a, b)$ 代表取 $a$ 和 $b$ 中较大的数，$\\lceil x \\rceil$ 代表**不小于** $x$ 的最小整数。下标为 $0$ 的值代表怪物的参数，不带下标值的为角色的参数。\n\n你会收到 $q$ 次操作，每次操作要么是一次查询，要么是一次移动。 \n\n对于移动，你会再获得一个数字参数，这个参数只可能是 $1/2/3/4$ 其中的一个，代表炮姐向地图的**左/右/上/下**移动。向上移动代表角色所在的行数减一，列数不变，其他方向类似。\n\n对于查询，需要你输出炮姐损失了多少血量，以及当前的攻击力和防御力分别是多少。\n\n请注意，如果多次进入同一个格子，那么格子上的药水会被重复拾取，小怪也会再次出现。即你可以认为离开一个格子以后该格子会恢复原状。\n\n请注意，如果初始位置有怪物，也不会发生战斗，如果初始位置有药水，也不会将之捡拾。", "inputFormat": "每个测试点有且仅有一组测试数据。\n\n输入的第一行是两个用空格隔开的整数，代表地图的行数 $n$ 和列数 $m$。\n\n第 $2$ 到第 $(n + 1)$ 行，每行有一个长度为 $m$ 的字符串，第 $(i + 1)$ 行的第 $j$ 个字符 $C_{i, j}$ 代表第 $i$ 行第 $j$ 列的方格中物品/生物。特别的，若 $C_{i, j}$ 为一个字符 `.`，则意味着该处没有任何东西，但是可以通行。\n\n第 $(n + 2)$ 行有三个用空格隔开的整数，分别代表怪物的血量 $HP_0$，攻击力 $ST_0$ 和防御力 $DE_0$。\n\n第 $(n + 3)$ 行有两个整数，分别代表角色初始所在的行数 $x$ 和列数 $y$。\n\n第 $(n + 4)$ 行有两个用空格隔开的整数，代表角色初始的攻击力 $ST$ 和防御力 $DE$。\n\n第 $(n + 5)$ 行是一个整数，代表操作的次数 $q$。\n\n第 $(n + 6)$ 到第 $(n + q + 5)$ 行，每行首先有一个整数 $op$，代表本次操作的类型。\n\n- 若 $op = 1$，则本次操作是一次查询操作。\n- 若 $op = 2$，则本次操作是一次移动，一个空格后会有一个整数 $d$，作为移动的参数。", "outputFormat": "对于每次查询操作，输出一行三个用单个空格隔开的整数，分别代表角色损失的血量 $HP$，以及当前的攻击力 $ST$ 和防御力 $DE$。", "hint": "#### 数据规模与约定\n\n| 测试点编号 |    $n$     |    $m$     |     $q$     |      特殊性质      |\n| :--------: | :--------: | :--------: | :---------: | :----------------: |\n|    $1$     |    $=1$    |    $=1$    |    $=0$     |         无         |\n|   $2,3$    |    $=1$    | $\\leq 10$  | $\\leq 1000$ |         无         |\n|   $4, 5$   |    $=1$    |    $=1$    | $\\leq 1000$ |   保证 $op = 1$    |\n|  $6,7,8$   | $\\leq 100$ | $\\leq 100$ | $\\leq 10^4$ | 保证地图中没有怪物 |\n|  $9, 10$   | $\\leq 100$ | $\\leq 100$ | $\\leq 10^4$ |         无         |\n\n对于全部的测试点，保证：\n\n- $1 \\leq n, m \\leq 100$，$0 \\leq q \\leq 10^4$。\n- $0 \\leq ST_0, DE_0, HP_0, ST, DE \\leq 100$。\n- $1 \\leq op \\leq 2$，$1 \\leq d \\leq 4$。\n- $C_{i, j}$ 只可能是 `.`，`R`，`Q`，`Y`，`M` 其中之一。\n- 保证人物移动过程中的任何时刻，所在行数都是不大于 $n$ 的正整数，所在列数都是不大于 $m$ 的正整数。", "locale": "zh-CN"}}}
{"pid": "P5007", "type": "P", "difficulty": 4, "samples": [["5 0\n1 2\n2 3\n2 4\n1 5", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "树形 DP", "逆元"], "title": "DDOSvoid 的疑惑", "background": "DDOSvoid 最近一直很痴迷于树形结构，尤其是可持久化喜羊羊灰太狼套红太狼树，可以 $O(\\log)$ 维护你想维护的信息。\n\n但是这只是一个理论数据结构，为了研究其如何实现，DDOSvoid 开始思考树的父亲和儿子之间的关系。\n\n如果这个数据结构得到实现，那么这个世界就再也没有毒瘤题了。\n\n但毕竟这个问题太难，所以我们先考虑下面的这个问题。\n", "description": "给定一棵以 $1$ 为根的有根树，定义树的一个毒瘤集为一个集合，并且集合中任意两个元素之间不存在祖先与后代关系。\n\n定义一个毒瘤集的毒瘤指数为集合内所有元素的价值之和。要求给定树的所有毒瘤集的毒瘤指数之和，答案对 $100{,}000{,}007$ 取模。\n\n但这个问题太难了，所以我们考虑化简。\n\n因为点的编号跟它毒瘤指数密切相关，所以我们将会再给出一个整数 $T$：$T = 1$ 表示 $i$ 号点的毒瘤指数为 $i$；$T = 0$，表示所有点的毒瘤指数都是 $1$。", "inputFormat": "第一行两个整数 $n$、$T$，表示这棵树有 $n$ 个节点。\n\n接下来 $n -1$ 行，每行两个整数 $x$ 和 $y$，表示有一条边，连接 $x$ 和 $y$。", "outputFormat": "输出一个整数，表示答案。", "hint": "#### 样例解释：\n\n$10$ 个集合分别为 $\\{1\\},\\{2\\},\\{3\\},\\{4\\},\\{5\\},\\{2,5\\},\\{3,4\\}, \\{3,5\\},\\{3,4,5\\},\\{4,5\\}$\n\n#### 数据范围与约定\n\n**本题采用多测试点捆绑测试**\n\n- 对于 $30 \\%$ 的部分分，$n \\le 15$；\n- 另外 $20 \\%$ 的部分分，$n \\le 10^6$，$T = 0$；\n- 对于 $100 \\%$ 的数据，$n \\le 10^6$，$ T <= 1$。\n\n#### 为了方便你理解题意，下面给出毒瘤集的数学定义：\n\n设一个毒瘤集为 $A$，则\n\n- $\\forall i\\in A$，不存在一个点 $j$，使得 $j$ 在从 $i$ 到根节点的简单路径上，且 $ j \\in A$。其中 $ i,j \\in V$，$V$ 为树的点集。", "locale": "zh-CN", "translations": {"en": {"title": "DDOSvoid’s Confusion", "background": "DDOSvoid has recently been very obsessed with tree structures, especially the “persistent Pleasant Goat and Big Big Wolf set Red Wolf tree”, which can maintain any information you want in $O(\\log)$ time.\n\nHowever, this is only a theoretical data structure. In order to study how it can be implemented, DDOSvoid began to think about the relationship between a tree’s parent and children.\n\nIf this data structure could be implemented, then there would be no more nasty problems in this world.\n\nBut after all, this problem is too hard, so let us first consider the following problem.", "description": "Given a rooted tree with root $1$, define a “nasty set” of the tree as a set such that for any two elements in the set, there is no ancestor-descendant relationship between them.\n\nDefine the “nasty index” of a nasty set as the sum of the values of all elements in the set. You are asked to compute the sum of the nasty indices of all nasty sets of the given tree, modulo $100{,}000{,}007$.\n\nBut this problem is too hard, so we consider a simplified version.\n\nBecause the node numbering is closely related to its nasty index, we will additionally give an integer $T$: when $T = 1$, the value (nasty index contribution) of node $i$ is $i$; when $T = 0$, the value of every node is $1$.", "inputFormat": "The first line contains two integers $n$ and $T$, meaning the tree has $n$ nodes.\n\nThe next $n - 1$ lines each contain two integers $x$ and $y$, meaning there is an edge connecting $x$ and $y$.", "outputFormat": "Output one integer, the answer.", "hint": "#### Sample Explanation:\n\nThe $10$ sets are $\\{1\\},\\{2\\},\\{3\\},\\{4\\},\\{5\\},\\{2,5\\},\\{3,4\\}, \\{3,5\\},\\{3,4,5\\},\\{4,5\\}$.\n\n#### Constraints and Notes\n\n**This problem uses bundled multiple test points.**\n\n- For $30\\%$ of the points, $n \\le 15$.\n- For another $20\\%$ of the points, $n \\le 10^6$, $T = 0$.\n- For $100\\%$ of the data, $n \\le 10^6$, $T \\le 1$.\n\n#### To help you understand the statement, here is the mathematical definition of a nasty set:\n\nLet a nasty set be $A$. Then:\n\n- $\\forall i\\in A$, there does not exist a node $j$ such that $j$ lies on the simple path from $i$ to the root, and $j \\in A$. Here $i, j \\in V$, and $V$ is the vertex set of the tree.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "DDOSvoid 的疑惑", "background": "DDOSvoid 最近一直很痴迷于树形结构，尤其是可持久化喜羊羊灰太狼套红太狼树，可以 $O(\\log)$ 维护你想维护的信息。\n\n但是这只是一个理论数据结构，为了研究其如何实现，DDOSvoid 开始思考树的父亲和儿子之间的关系。\n\n如果这个数据结构得到实现，那么这个世界就再也没有毒瘤题了。\n\n但毕竟这个问题太难，所以我们先考虑下面的这个问题。\n", "description": "给定一棵以 $1$ 为根的有根树，定义树的一个毒瘤集为一个集合，并且集合中任意两个元素之间不存在祖先与后代关系。\n\n定义一个毒瘤集的毒瘤指数为集合内所有元素的价值之和。要求给定树的所有毒瘤集的毒瘤指数之和，答案对 $100{,}000{,}007$ 取模。\n\n但这个问题太难了，所以我们考虑化简。\n\n因为点的编号跟它毒瘤指数密切相关，所以我们将会再给出一个整数 $T$：$T = 1$ 表示 $i$ 号点的毒瘤指数为 $i$；$T = 0$，表示所有点的毒瘤指数都是 $1$。", "inputFormat": "第一行两个整数 $n$、$T$，表示这棵树有 $n$ 个节点。\n\n接下来 $n -1$ 行，每行两个整数 $x$ 和 $y$，表示有一条边，连接 $x$ 和 $y$。", "outputFormat": "输出一个整数，表示答案。", "hint": "#### 样例解释：\n\n$10$ 个集合分别为 $\\{1\\},\\{2\\},\\{3\\},\\{4\\},\\{5\\},\\{2,5\\},\\{3,4\\}, \\{3,5\\},\\{3,4,5\\},\\{4,5\\}$\n\n#### 数据范围与约定\n\n**本题采用多测试点捆绑测试**\n\n- 对于 $30 \\%$ 的部分分，$n \\le 15$；\n- 另外 $20 \\%$ 的部分分，$n \\le 10^6$，$T = 0$；\n- 对于 $100 \\%$ 的数据，$n \\le 10^6$，$ T <= 1$。\n\n#### 为了方便你理解题意，下面给出毒瘤集的数学定义：\n\n设一个毒瘤集为 $A$，则\n\n- $\\forall i\\in A$，不存在一个点 $j$，使得 $j$ 在从 $i$ 到根节点的简单路径上，且 $ j \\in A$。其中 $ i,j \\in V$，$V$ 为树的点集。", "locale": "zh-CN"}}}
{"pid": "P5008", "type": "P", "difficulty": 5, "samples": [["7 7 3\n10 2 8 4 9 5 7\n1 2\n1 3\n1 4\n2 5\n3 6\n3 7\n4 7", "24"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2018", "O2优化", "强连通分量"], "title": "[yLOI2018] 锦鲤抄", "background": "> 你在尘世中辗转了千百年，  \n> 却只让我看你最后一眼。  \n> 火光描摹容颜燃尽了时间，  \n> 别留我一人，孑然一身，凋零在梦境里面。\n\n—— 银临 & 云の泣《锦鲤抄》\n\n本题原名《逛庭院》。\n\n这首歌的文案如下：（注：不阅读文案不影响下面的阅读）\n\n> 宁武皇仁光九年锦文轩刻本《异闻录》载：扶桑画师浅溪，居泰安，喜绘鲤。院前一方荷塘，锦鲤游曳，溪常与嬉戏。  \n> 其时正武德之乱，藩镇割据，战事频仍，魑魅魍魉，肆逆于道。兵戈逼泰安，街邻皆逃亡，独溪不舍锦鲤，未去。  \n> 是夜，院室倏火。有人入火护溪，言其本鲤中妖，欲取溪命，却生情愫，遂不忍为之。翌日天明，火势渐歇，人已不见。  \n> 溪始觉如梦，奔塘边，但见池水干涸，莲叶皆枯，塘中鲤亦不知所踪。  \n> 自始至终，未辨眉目，只记襟上层迭莲花，其色魅惑，似血着泪。  \n> 后有青岩居士闻之，叹曰：魑祟动情，必作灰飞。犹蛾之投火耳，非愚，乃命数也。", "description": "扶苏被画师和锦鲤的故事深深地打动了。为了能让锦鲤和画师继续生活在一起，他决定回到着火的庭院中灭掉大火。\n\n画师的庭院可以抽象成一个有向图，每个点代表着一个着火的位置。为了量化火势的大小，扶苏给每个点一个火力值，火力值越大，代表这个点的火势越强。\n\n风助火势，火借风力，对于每一个着火点，都有可能因为大风使得火扩散到其他点。有向图的每条边 $<u,v>$ 代表大火是从点 $u$ 扩散到点 $v$ 的。需要注意的是一个点可能会扩散到很多点，也可能是由很多点的大火一起扩散成的。\n\n为了不因为灭掉火源让画师发现有人在帮他灭火，在任意时刻，扶苏不能灭掉任何一个不被任何点所扩散的点的火。一个点的火被灭掉后，所代表该点的火扩散的所有边将消失。需要说明的是，虽然边消失了，但是该点扩散到的所有点属性除入度以外都不会改变，更不会消失。\n\n因为穿越的时间有限，扶苏只能灭掉最多 $k$ 个点的火。他想问问你他最多能扑灭多少火力值。\n\n#### 简化版题意：\n\n给你一张有向图，每个点有一个点权。任意时刻你可以任意选择一个**有入度**的点，获得它的点权并把它和它的出边从图上删去。最多能选择 $k$ 个点，求最多能获得多少点权。", "inputFormat": "输入的第一行是三个用空格隔开的整数，代表图的点数 $n$ 和边数 $m$ 以及点数的限制 $k$。\n\n输入的第二行是 $n$ 个用空格隔开的整数，第 $i$ 个数 $w_i$ 代表点 $i$ 的火力值（点权）。\n\n第 $3$ 到第 $(m + 2)$ 行，每行两个用空格隔开的整数 $u, v$，代表一条 $u$ 指向 $v$ 的有向边。", "outputFormat": "输出一行一个整数，代表最大的火力值。", "hint": "### 样例输入输出 1 解释\n\n选择 $3, 5, 7$ 三个节点。\n\n---\n\n### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 $5$ 个子任务**。\n\n- Subtask 1（30 points）：$n = 10$，$m = 50$。\n- Subtask 2（30 points）：$n = 100001$，$m = 500001$。**保证给出的图是一个有向无环图**。\n- Subtask 3（20 points）：$n = 100002$，$m = 500002$。保证给出的图中，没有入度的点有且仅有一个。\n- Subtask 4（17 points）：$n = 100003$，$m = 500003$。\n- Subtask 5（3 points）：$n = 500004$，$m = 2000004$。\n\n对于全部的测试点，保证 $1 \\leq n \\leq 5 \\times 10^5 + 4$，$1 \\leq m \\leq 2 \\times 10^6 + 4$，$0 \\leq w_i \\leq 10^3$，$0 \\leq k \\leq n$。\n\n**不保证**给出的图没有自环。\n\n---\n\n### 提示\n\n- 请注意数据读入对程序效率造成的影响。\n- $n$ 的末位数字可以帮助你快速的判断测试点所在的子任务。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2018] Jinli Chao", "background": "> You have wandered in the mortal world for thousands of years,  \n> yet you only let me see you one last time.  \n> Firelight traces your face and burns away time,  \n> do not leave me alone, solitary, withering inside a dream.\n\n— Yin Lin & Yun Zhi Qi, *Jinli Chao*\n\nThe original name of this problem was *Strolling in the Courtyard*.\n\nThe copywriting of this song is as follows: (Note: not reading it does not affect understanding the problem below.)\n\n> The *Records of Strange Tales* (a Jinxuan Hall printed edition) from the ninth year of the Ningwu Emperor Renguang records: A Fusang painter named Qianxi lived in Taian and loved painting koi. Before his house was a lotus pond where brocade koi swam; Xi often played with them.  \n> At that time, the Wu De rebellion was raging, warlords fought each other, wars happened again and again, and monsters ran wild on the roads. When the war approached Taian, neighbors all fled; only Xi stayed, unwilling to leave the koi behind.  \n> That night, the house suddenly caught fire. Someone entered the fire to protect Xi, saying they were a demon from among the koi, originally here to take Xi’s life, yet they developed feelings and could not bear to do so. At dawn the next day, the fire gradually died down, and the person was gone.  \n> Xi then felt it was like a dream, and ran to the pond, only to see the water dried up, lotus leaves all withered, and the koi in the pond were nowhere to be found.  \n> From start to finish, Xi never saw the person clearly, only remembering layered lotus flowers on their collar, enchanting in color, like blood stained with tears.  \n> Later, a hermit called Qingyan heard this and sighed: When an evil spirit falls in love, it must turn to ashes and vanish. It is like a moth flying into the fire—not stupidity, but fate.", "description": "Fusu was deeply moved by the story of the painter and the koi. In order to let the koi and the painter continue living together, he decided to return to the burning courtyard and put out the fire.\n\nThe painter’s courtyard can be abstracted as a directed graph. Each node represents a burning location. To measure the size of the fire, Fusu assigns each node a fire value. The larger the fire value, the stronger the fire at that node.\n\nWind helps the fire, and the fire borrows the wind’s force. For each burning node, strong wind may cause the fire to spread to other nodes. Each directed edge $<u,v>$ in the graph represents that the fire spreads from node $u$ to node $v$. Note that one node may spread to many nodes, and it may also be formed by fires spreading together from many nodes.\n\nTo avoid the painter noticing that someone is helping to put out the fire, at any moment, Fusu is not allowed to extinguish the fire at any node that is not being spread to by any node. After a node’s fire is extinguished, all outgoing edges representing the spread from that node will disappear. Note that although the edges disappear, all properties of the nodes that it spreads to, except for their in-degrees, will not change, and they will not disappear.\n\nBecause the time for time travel is limited, Fusu can extinguish the fire of at most $k$ nodes. He wants to ask you what is the maximum total fire value he can extinguish.\n\n#### Simplified statement:\n\nGiven a directed graph where each node has a weight. At any moment, you may choose any node **with in-degree**, gain its weight, and delete it and its outgoing edges from the graph. You may choose at most $k$ nodes. Find the maximum total weight you can obtain.", "inputFormat": "The first line contains three integers separated by spaces, representing the number of nodes $n$, the number of edges $m$, and the limit on the number of chosen nodes $k$.\n\nThe second line contains $n$ integers separated by spaces. The $i$-th integer $w_i$ represents the fire value (node weight) of node $i$.\n\nLines $3$ to $(m + 2)$ each contain two integers $u, v$ separated by spaces, representing a directed edge from $u$ to $v$.", "outputFormat": "Output one line with one integer, representing the maximum total fire value.", "hint": "### Explanation for Sample Input/Output 1\n\nChoose nodes $3, 5, 7$.\n\n---\n\n### Constraints\n\n**This problem uses bundled testdata with a total of $5$ subtasks**.\n\n- Subtask 1 (30 points): $n = 10$, $m = 50$.\n- Subtask 2 (30 points): $n = 100001$, $m = 500001$. **It is guaranteed that the given graph is a directed acyclic graph.**\n- Subtask 3 (20 points): $n = 100002$, $m = 500002$. It is guaranteed that in the given graph, there is one and only one node with in-degree $0$.\n- Subtask 4 (17 points): $n = 100003$, $m = 500003$.\n- Subtask 5 (3 points): $n = 500004$, $m = 2000004$.\n\nFor all testdata, it is guaranteed that $1 \\leq n \\leq 5 \\times 10^5 + 4$, $1 \\leq m \\leq 2 \\times 10^6 + 4$, $0 \\leq w_i \\leq 10^3$, $0 \\leq k \\leq n$.\n\nIt is **not guaranteed** that the given graph has no self-loops.\n\n---\n\n### Notes\n\n- Please pay attention to the impact of input reading on program efficiency.\n- The last digit of $n$ can help you quickly determine which subtask the test point belongs to.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2018] 锦鲤抄", "background": "> 你在尘世中辗转了千百年，  \n> 却只让我看你最后一眼。  \n> 火光描摹容颜燃尽了时间，  \n> 别留我一人，孑然一身，凋零在梦境里面。\n\n—— 银临 & 云の泣《锦鲤抄》\n\n本题原名《逛庭院》。\n\n这首歌的文案如下：（注：不阅读文案不影响下面的阅读）\n\n> 宁武皇仁光九年锦文轩刻本《异闻录》载：扶桑画师浅溪，居泰安，喜绘鲤。院前一方荷塘，锦鲤游曳，溪常与嬉戏。  \n> 其时正武德之乱，藩镇割据，战事频仍，魑魅魍魉，肆逆于道。兵戈逼泰安，街邻皆逃亡，独溪不舍锦鲤，未去。  \n> 是夜，院室倏火。有人入火护溪，言其本鲤中妖，欲取溪命，却生情愫，遂不忍为之。翌日天明，火势渐歇，人已不见。  \n> 溪始觉如梦，奔塘边，但见池水干涸，莲叶皆枯，塘中鲤亦不知所踪。  \n> 自始至终，未辨眉目，只记襟上层迭莲花，其色魅惑，似血着泪。  \n> 后有青岩居士闻之，叹曰：魑祟动情，必作灰飞。犹蛾之投火耳，非愚，乃命数也。", "description": "扶苏被画师和锦鲤的故事深深地打动了。为了能让锦鲤和画师继续生活在一起，他决定回到着火的庭院中灭掉大火。\n\n画师的庭院可以抽象成一个有向图，每个点代表着一个着火的位置。为了量化火势的大小，扶苏给每个点一个火力值，火力值越大，代表这个点的火势越强。\n\n风助火势，火借风力，对于每一个着火点，都有可能因为大风使得火扩散到其他点。有向图的每条边 $<u,v>$ 代表大火是从点 $u$ 扩散到点 $v$ 的。需要注意的是一个点可能会扩散到很多点，也可能是由很多点的大火一起扩散成的。\n\n为了不因为灭掉火源让画师发现有人在帮他灭火，在任意时刻，扶苏不能灭掉任何一个不被任何点所扩散的点的火。一个点的火被灭掉后，所代表该点的火扩散的所有边将消失。需要说明的是，虽然边消失了，但是该点扩散到的所有点属性除入度以外都不会改变，更不会消失。\n\n因为穿越的时间有限，扶苏只能灭掉最多 $k$ 个点的火。他想问问你他最多能扑灭多少火力值。\n\n#### 简化版题意：\n\n给你一张有向图，每个点有一个点权。任意时刻你可以任意选择一个**有入度**的点，获得它的点权并把它和它的出边从图上删去。最多能选择 $k$ 个点，求最多能获得多少点权。", "inputFormat": "输入的第一行是三个用空格隔开的整数，代表图的点数 $n$ 和边数 $m$ 以及点数的限制 $k$。\n\n输入的第二行是 $n$ 个用空格隔开的整数，第 $i$ 个数 $w_i$ 代表点 $i$ 的火力值（点权）。\n\n第 $3$ 到第 $(m + 2)$ 行，每行两个用空格隔开的整数 $u, v$，代表一条 $u$ 指向 $v$ 的有向边。", "outputFormat": "输出一行一个整数，代表最大的火力值。", "hint": "### 样例输入输出 1 解释\n\n选择 $3, 5, 7$ 三个节点。\n\n---\n\n### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 $5$ 个子任务**。\n\n- Subtask 1（30 points）：$n = 10$，$m = 50$。\n- Subtask 2（30 points）：$n = 100001$，$m = 500001$。**保证给出的图是一个有向无环图**。\n- Subtask 3（20 points）：$n = 100002$，$m = 500002$。保证给出的图中，没有入度的点有且仅有一个。\n- Subtask 4（17 points）：$n = 100003$，$m = 500003$。\n- Subtask 5（3 points）：$n = 500004$，$m = 2000004$。\n\n对于全部的测试点，保证 $1 \\leq n \\leq 5 \\times 10^5 + 4$，$1 \\leq m \\leq 2 \\times 10^6 + 4$，$0 \\leq w_i \\leq 10^3$，$0 \\leq k \\leq n$。\n\n**不保证**给出的图没有自环。\n\n---\n\n### 提示\n\n- 请注意数据读入对程序效率造成的影响。\n- $n$ 的末位数字可以帮助你快速的判断测试点所在的子任务。\n\n", "locale": "zh-CN"}}}
{"pid": "P5009", "type": "P", "difficulty": 6, "samples": [["5 5\n1 2 3\n4 5 6\n7 8 9\n10 11 12\n13 14 15\n2 1 1 3 2 \n1 3 2 3\n3 4 1 4 -3\n4 5 1 3 -5\n1 6 1 5", "377\n2708"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "线段树", "O2优化", "分块"], "title": "[yLOI2018] 不老梦", "background": "> 于万人中万幸得以相逢，刹那间澈净明通。  \n> 成为我所向披靡的勇气和惶恐，裂山海，堕苍穹。\n\n——银临《不老梦》。\n\n本题原名《毒瘤分块题》。", "description": "扶苏非常喜欢一边听古风歌一边写毒瘤分块题。所以这个题的题面恶意卡了分块。\n\n给你一个序列，这个序列中的每个数字有三个参数 $v_i,a_i,b_i$。这个序列中的数有一个非常神奇的有关时间的性质：每过一个时刻，序列中第 $i$ 个数字的值 $v_i$ 会增加 $a_i \\times b_i$。\n\n现在扶苏会对你做出一些询问和对序列进行一些修改。每次操作形如：\n\n- 查询第 $t$ 时刻区间 $[l,r]$ 的 $v$ 之和是多少。\n- 在第 $t$ 时刻修改区间 $[l,r]$ 内的 $a$，将之整体加上一个整数 $x$。\n- 在第 $t$ 时刻修改区间 $[l,r]$ 内的 $b$，将之整体加上一个整数 $y$。\n- 在第 $t$ 时刻修改区间 $[l,r]$ 内的 $v$，将之整体加上一个整数 $z$。\n\n规定初始时刻为时刻 $0$。", "inputFormat": "每个测试点有且仅有一组测试数据。\n\n输入的第一行是两个用空格隔开的整数，分别代表序列的长度 $n$ 以及操作的个数 $m$。\n\n下面 $n$ 行，每行 $3$ 个用空格隔开的整数，第 $i$ 行的整数 $v_i,a_i,b_i$ 分别代表第 $i$ 个位置的三个参数。\n\n下面 $m$ 行，每行第一个数是 $opt$，代表操作的种类。\n\n- 对于 $opt = 1$ 的情况，代表对序列进行一次查询。 $opt$ 后有三个用空格隔开的整数 $t, x, y$，代表查询时刻 $t$ 区间 $[x,y]$ 中 $v$ 的和。\n- 对于 $opt = 2$ 的情况，代表对序列的 $a$ 值进行一次修改。$opt$ 后有四个用空格隔开的整数 $t, x, y, z$，代表在第 $t$ 时刻将区间 $[x,y]$ 中 $a$ 的值加上 $z$。\n- 对于 $opt = 3$ 的情况，代表对序列的 $b$ 值进行一次修改。$opt$ 后有四个用空格隔开的整数 $t, x, y, z$，代表在第 $t$ 时刻将区间 $[x,y]$ 中 $b$ 的值加上 $z$。\n- 对于 $opt = 4$ 的情况，代表对序列的 $v$ 值进行一次修改。$opt$ 后有四个用空格隔开的整数 $t, x, y, z$，代表在第 $t$ 时刻将区间 $[x,y]$ 中 $v$ 的值加上 $z$。\n\n数据保证参数 $t$ 是单调递增的，不存在同一时刻有超过一种查询或询问。\n", "outputFormat": "对于每次查询操作，输出一个一行一个整数，代表查询的答案对 $10^8 + 7$ 取模的答案。", "hint": "#### 【样例输入输出 1 解释】\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/38337.png)\n\n\n---\n\n#### 【数据规模与约定】\n\n**本题共有 $17$ 个测试点，各测试点不等分。每个测试点的 $n$ 的规模如下表**。\n\n| 测试点编号 |         $n=$          | 测试点编号 | $n=$|\n| :--------: | :-------------------: | :--------: | :-------------------: |\n|    $1$     |          $6$          |    $10$    |      $10^5 + 2$       |\n|    $2$     |         $10$          |   $11$    | $1.5 \\times 10^5 + 2$ |\n|    $3$     |         $100$         |  $12$    |      $10^5 + 3$       |\n|    $4$     |        $10^3$         |  $13$    | $1.5 \\times 10^5 + 3$ |\n|    $5$     |    $3 \\times 10^3$    | $14$    |  $2 \\times 10^5 + 4$  |\n|    $6$     |    $3 \\times 10^3$    |   $15$    |  $5 \\times 10^4 + 5$  |\n|    $7$     |      $10^4 + 1$       |   $16$    |      $10^5 + 5$       |\n|    $8$     |      $10^5 + 1$       |  $17$    |  $2 \\times 10^5 + 5$  |\n|    $9$     | $1.5 \\times 10^5 + 1$ |\n\n**各测试点分值**：\n\n- 对于第 $1$ 到第 $14$ 个测试点，每个测试点 $5$ 分。\n- 对于第 $15$ 到第 $17$ 个测试点，每个测试点 $10$ 分。\n\n**各测试点 $m$ 的取值**：\n\n- 对于测试点 $1$，$m = 10$。\n- 对于测试点 $2$，$m = 50$。\n- 对于第 $3$ 到第 $17$ 个测试点，$m = n$。\n\n**各测试点特殊性质**：\n\n- 对于所有 $n$ 末位数字为 $6$ 的测试点，满足性质：操作所用到的时刻从 $1$ 开始，每次增加 $1$。\n- 对于所有 $n$ 末位数字为 $1$ 的测试点，满足性质：所有修改操作只涉及对 $a$ 的修改，且修改区间 $x = y$。\n- 对于所有 $n$ 末位数字为 $2$ 的测试点，满足性质：所有修改操作只涉及对 $a$ 的修改。\n- 对于所有 $n$ 末位数字为 $3$ 的测试点，满足性质：所有修改操作不涉及对 $v$ 的修改，且对于 $b$ 的修改满足 $x= y$。\n- 对于所有 $n$ 末位数字为 $4$ 的测试点，满足性质：不存在修改操作。\n\n\n对于全部的测试点，保证 $1 \\leq x \\leq y \\leq n$，$1 \\leq op \\leq 4$，给出的所有数字都在 32 位带符号整形的范围内，$t$ 为正数，且按照严格的升序给出。\n\n---\n\n#### 【提示】\n\n- 请注意数据读入对程序效率造成的影响。\n- 请注意常数因子对程序效率造成的影响。\n- $n$ 的末位数字可以帮助你快速判断测试点的特殊性质。\n- 当你的答案为负时，请将其取模成非负数后再进行输出。\n\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[yLOI2018] Ageless Dream", "background": "> Among tens of thousands, by great luck we meet; in an instant, everything becomes clear and bright.  \n> It becomes my courage and fear that make me unstoppable, splitting mountains and seas, falling into the sky.\n\n— Yin Lin, *Ageless Dream*.\n\nThe original name of this problem was *Poisonous Block Decomposition Problem*.", "description": "Fusu really likes writing tricky block decomposition problems while listening to Chinese-style songs. So this statement is intentionally designed to make block decomposition hard to use.\n\nYou are given a sequence. Each number in the sequence has three parameters $v_i, a_i, b_i$. This sequence has a very magical time-related property: every time moment passes, the value $v_i$ of the $i$-th number increases by $a_i \\times b_i$.\n\nNow Fusu will ask you some queries and perform some modifications on the sequence. Each operation is one of the following:\n\n- Query: at time $t$, what is the sum of $v$ over the interval $[l, r]$.\n- Modify $a$: at time $t$, add an integer $x$ to all $a$ in the interval $[l, r]$.\n- Modify $b$: at time $t$, add an integer $y$ to all $b$ in the interval $[l, r]$.\n- Modify $v$: at time $t$, add an integer $z$ to all $v$ in the interval $[l, r]$.\n\nThe initial time is defined as time $0$.", "inputFormat": "Each test point has exactly one set of testdata.\n\nThe first line contains two integers separated by spaces, representing the length of the sequence $n$ and the number of operations $m$.\n\nThe next $n$ lines each contain $3$ integers separated by spaces. On the $i$-th line, the integers $v_i, a_i, b_i$ represent the three parameters at position $i$.\n\nThe next $m$ lines describe the operations. The first number of each line is $opt$, representing the type of operation.\n\n- For $opt = 1$, it means one query on the sequence. After $opt$ there are three integers $t, x, y$ separated by spaces, meaning: query the sum of $v$ in interval $[x, y]$ at time $t$.\n- For $opt = 2$, it means one modification to the $a$ values. After $opt$ there are four integers $t, x, y, z$ separated by spaces, meaning: at time $t$, add $z$ to all $a$ in interval $[x, y]$.\n- For $opt = 3$, it means one modification to the $b$ values. After $opt$ there are four integers $t, x, y, z$ separated by spaces, meaning: at time $t$, add $z$ to all $b$ in interval $[x, y]$.\n- For $opt = 4$, it means one modification to the $v$ values. After $opt$ there are four integers $t, x, y, z$ separated by spaces, meaning: at time $t$, add $z$ to all $v$ in interval $[x, y]$.\n\nThe data guarantees that the parameter $t$ is strictly increasing, and there will not be more than one query or modification at the same time moment.", "outputFormat": "For each query operation, output one integer per line, representing the answer modulo $10^8 + 7$.", "hint": "#### Sample Input/Output 1 Explanation\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/38337.png)\n\n---\n\n#### Constraints\n\n**This problem has $17$ test points, with unequal weights. For each test point, the value of $n$ is given in the table below**.\n\n| Test Point ID |         $n=$          | Test Point ID | $n=$|\n| :--------: | :-------------------: | :--------: | :-------------------: |\n|    $1$     |          $6$          |    $10$    |      $10^5 + 2$       |\n|    $2$     |         $10$          |   $11$    | $1.5 \\times 10^5 + 2$ |\n|    $3$     |         $100$         |  $12$    |      $10^5 + 3$       |\n|    $4$     |        $10^3$         |  $13$    | $1.5 \\times 10^5 + 3$ |\n|    $5$     |    $3 \\times 10^3$    | $14$    |  $2 \\times 10^5 + 4$  |\n|    $6$     |    $3 \\times 10^3$    |   $15$    |  $5 \\times 10^4 + 5$  |\n|    $7$     |      $10^4 + 1$       |   $16$    |      $10^5 + 5$       |\n|    $8$     |      $10^5 + 1$       |  $17$    |  $2 \\times 10^5 + 5$  |\n|    $9$     | $1.5 \\times 10^5 + 1$ |\n\n**Scores for test points**:\n\n- For test points $1$ to $14$, each test point is worth $5$ points.\n- For test points $15$ to $17$, each test point is worth $10$ points.\n\n**Values of $m$ for test points**:\n\n- For test point $1$, $m = 10$.\n- For test point $2$, $m = 50$.\n- For test points $3$ to $17$, $m = n$.\n\n**Special properties of test points**:\n\n- For all test points where the last digit of $n$ is $6$, the following property holds: the time moments used by operations start from $1$ and increase by $1$ each time.\n- For all test points where the last digit of $n$ is $1$, the following property holds: all modification operations only modify $a$, and the modification interval satisfies $x = y$.\n- For all test points where the last digit of $n$ is $2$, the following property holds: all modification operations only modify $a$.\n- For all test points where the last digit of $n$ is $3$, the following property holds: no modification operation modifies $v$, and for modifications to $b$, it holds that $x = y$.\n- For all test points where the last digit of $n$ is $4$, the following property holds: there are no modification operations.\n\nFor all test points, it is guaranteed that $1 \\leq x \\leq y \\leq n$, $1 \\leq op \\leq 4$, all given numbers are within the range of 32-bit signed integers, $t$ is positive, and is given in strictly increasing order.\n\n---\n\n#### Hint\n\n- Please pay attention to the impact of input reading on program efficiency.\n- Please pay attention to the impact of constant factors on program efficiency.\n- The last digit of $n$ can help you quickly determine the special properties of a test point.\n- If your answer is negative, please take it modulo into a non-negative number before outputting it.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[yLOI2018] 不老梦", "background": "> 于万人中万幸得以相逢，刹那间澈净明通。  \n> 成为我所向披靡的勇气和惶恐，裂山海，堕苍穹。\n\n——银临《不老梦》。\n\n本题原名《毒瘤分块题》。", "description": "扶苏非常喜欢一边听古风歌一边写毒瘤分块题。所以这个题的题面恶意卡了分块。\n\n给你一个序列，这个序列中的每个数字有三个参数 $v_i,a_i,b_i$。这个序列中的数有一个非常神奇的有关时间的性质：每过一个时刻，序列中第 $i$ 个数字的值 $v_i$ 会增加 $a_i \\times b_i$。\n\n现在扶苏会对你做出一些询问和对序列进行一些修改。每次操作形如：\n\n- 查询第 $t$ 时刻区间 $[l,r]$ 的 $v$ 之和是多少。\n- 在第 $t$ 时刻修改区间 $[l,r]$ 内的 $a$，将之整体加上一个整数 $x$。\n- 在第 $t$ 时刻修改区间 $[l,r]$ 内的 $b$，将之整体加上一个整数 $y$。\n- 在第 $t$ 时刻修改区间 $[l,r]$ 内的 $v$，将之整体加上一个整数 $z$。\n\n规定初始时刻为时刻 $0$。", "inputFormat": "每个测试点有且仅有一组测试数据。\n\n输入的第一行是两个用空格隔开的整数，分别代表序列的长度 $n$ 以及操作的个数 $m$。\n\n下面 $n$ 行，每行 $3$ 个用空格隔开的整数，第 $i$ 行的整数 $v_i,a_i,b_i$ 分别代表第 $i$ 个位置的三个参数。\n\n下面 $m$ 行，每行第一个数是 $opt$，代表操作的种类。\n\n- 对于 $opt = 1$ 的情况，代表对序列进行一次查询。 $opt$ 后有三个用空格隔开的整数 $t, x, y$，代表查询时刻 $t$ 区间 $[x,y]$ 中 $v$ 的和。\n- 对于 $opt = 2$ 的情况，代表对序列的 $a$ 值进行一次修改。$opt$ 后有四个用空格隔开的整数 $t, x, y, z$，代表在第 $t$ 时刻将区间 $[x,y]$ 中 $a$ 的值加上 $z$。\n- 对于 $opt = 3$ 的情况，代表对序列的 $b$ 值进行一次修改。$opt$ 后有四个用空格隔开的整数 $t, x, y, z$，代表在第 $t$ 时刻将区间 $[x,y]$ 中 $b$ 的值加上 $z$。\n- 对于 $opt = 4$ 的情况，代表对序列的 $v$ 值进行一次修改。$opt$ 后有四个用空格隔开的整数 $t, x, y, z$，代表在第 $t$ 时刻将区间 $[x,y]$ 中 $v$ 的值加上 $z$。\n\n数据保证参数 $t$ 是单调递增的，不存在同一时刻有超过一种查询或询问。\n", "outputFormat": "对于每次查询操作，输出一个一行一个整数，代表查询的答案对 $10^8 + 7$ 取模的答案。", "hint": "#### 【样例输入输出 1 解释】\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/38337.png)\n\n\n---\n\n#### 【数据规模与约定】\n\n**本题共有 $17$ 个测试点，各测试点不等分。每个测试点的 $n$ 的规模如下表**。\n\n| 测试点编号 |         $n=$          | 测试点编号 | $n=$|\n| :--------: | :-------------------: | :--------: | :-------------------: |\n|    $1$     |          $6$          |    $10$    |      $10^5 + 2$       |\n|    $2$     |         $10$          |   $11$    | $1.5 \\times 10^5 + 2$ |\n|    $3$     |         $100$         |  $12$    |      $10^5 + 3$       |\n|    $4$     |        $10^3$         |  $13$    | $1.5 \\times 10^5 + 3$ |\n|    $5$     |    $3 \\times 10^3$    | $14$    |  $2 \\times 10^5 + 4$  |\n|    $6$     |    $3 \\times 10^3$    |   $15$    |  $5 \\times 10^4 + 5$  |\n|    $7$     |      $10^4 + 1$       |   $16$    |      $10^5 + 5$       |\n|    $8$     |      $10^5 + 1$       |  $17$    |  $2 \\times 10^5 + 5$  |\n|    $9$     | $1.5 \\times 10^5 + 1$ |\n\n**各测试点分值**：\n\n- 对于第 $1$ 到第 $14$ 个测试点，每个测试点 $5$ 分。\n- 对于第 $15$ 到第 $17$ 个测试点，每个测试点 $10$ 分。\n\n**各测试点 $m$ 的取值**：\n\n- 对于测试点 $1$，$m = 10$。\n- 对于测试点 $2$，$m = 50$。\n- 对于第 $3$ 到第 $17$ 个测试点，$m = n$。\n\n**各测试点特殊性质**：\n\n- 对于所有 $n$ 末位数字为 $6$ 的测试点，满足性质：操作所用到的时刻从 $1$ 开始，每次增加 $1$。\n- 对于所有 $n$ 末位数字为 $1$ 的测试点，满足性质：所有修改操作只涉及对 $a$ 的修改，且修改区间 $x = y$。\n- 对于所有 $n$ 末位数字为 $2$ 的测试点，满足性质：所有修改操作只涉及对 $a$ 的修改。\n- 对于所有 $n$ 末位数字为 $3$ 的测试点，满足性质：所有修改操作不涉及对 $v$ 的修改，且对于 $b$ 的修改满足 $x= y$。\n- 对于所有 $n$ 末位数字为 $4$ 的测试点，满足性质：不存在修改操作。\n\n\n对于全部的测试点，保证 $1 \\leq x \\leq y \\leq n$，$1 \\leq op \\leq 4$，给出的所有数字都在 32 位带符号整形的范围内，$t$ 为正数，且按照严格的升序给出。\n\n---\n\n#### 【提示】\n\n- 请注意数据读入对程序效率造成的影响。\n- 请注意常数因子对程序效率造成的影响。\n- $n$ 的末位数字可以帮助你快速判断测试点的特殊性质。\n- 当你的答案为负时，请将其取模成非负数后再进行输出。\n\n\n", "locale": "zh-CN"}}}
{"pid": "P5010", "type": "P", "difficulty": 6, "samples": [["5 3 2 4\n6 8 0 2 7", "1\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "线段树", "O2优化", "排序"], "title": "HMR的LIS Ⅲ", "background": "[HMR的LIS Ⅰ](https://www.luogu.org/problemnew/show/T51390)\n\n[HMR的LIS Ⅱ](https://www.luogu.org/problemnew/show/T51391)\n\n在你帮助HMR切掉AKIOI的神仙LSK的两道题后，LSK很不满，决定好好刁难一下你（而不是HMR）", "description": "LSK又给出了一个长度为n的序列，要求你求出它的IBvl序列\n\nIBvl序列满足以下要求：\n\n1.一个IBvl序列满足$ \\forall ~ i \\in (1,len] , L < a_i - a_{i-1} < R $，其中$len$为IBvl序列的长度\n\n2.IBvl序列中的元素相对顺序应满足在原序列中的相对顺序\n\n3.在所有满足条件的序列中长度最长\n\n我们视位置不同的元素为不同元素，有任一组成元素不同的IBvl序列为不同IBvl序列\n\n现在要求你输出原序列的IBvl序列的长度，并输出字典序第k小（以元素在原序列中的位置为关键字排序）的序列的每个元素在原序列中的位置", "inputFormat": "第一行输入4个整数，n，k，L，R\n\n第二行输入n个整数，表示神仙LSK给出的序列", "outputFormat": "第一行输出IBvl序列的长度\n\n第二行输出IBvl序列的每个元素的位置", "hint": "#### 样例解释：\n\n对于给出的数据，一共有$5$种IBvl序列，分别是:$\\{6\\},\\{8\\},\\{0\\},\\{2\\},\\{7\\}$。\n\n他们在原序列中位置的编号序列分别是$\\{1\\},\\{2\\},\\{3\\},\\{4\\},\\{5\\}$\n\nIBvl序列的长度为1。\n\n要求输出字典序第$3$小的编号序列，于是输出$3$。\n\n#### 数据范围与约定：\n\n对于20%的数据，$ n \\le 18$\n\n对于50%的数据，$ n \\le 1000 , | l | , | r | \\leq 10^9 , r-l>1 , 0 \\le a[i] \\le 10^9 $\n\n对于另外10%的数据，$ l=0 , r=10^9+1 , k=1 $\n\n对于另外20%的数据，$ l=0 , r=10^9+1 , k \\le 3 $\n\n对于100%的数据，$ n \\le 5*10^5 , | l | , | r | \\le 10^9 , r-l>1 , k \\le 10^{13} , 0 \\le a[i] \\le 10^9 $\n\n对于所有数据，保证合法且有解。\n\n对于前50%的数据，时限为1s，后50%的数据，时限为2s（~~凉~~良心不卡常）", "locale": "zh-CN", "translations": {"en": {"title": "HMR's LIS III", "background": "[HMR's LIS I](https://www.luogu.org/problemnew/show/T51390)\n\n[HMR's LIS II](https://www.luogu.org/problemnew/show/T51391)\n\nAfter you helped HMR take down two problems by the genius LSK from AKIOI, LSK was very unhappy and decided to make things difficult for you (not for HMR).", "description": "LSK gives a sequence of length $n$ again, and asks you to find its IBvl sequence.\n\nAn IBvl sequence must satisfy the following:\n\n1. An IBvl sequence satisfies $ \\forall ~ i \\in (1,len] , L < a_i - a_{i-1} < R $, where $len$ is the length of the IBvl sequence.\n\n2. The relative order of elements in the IBvl sequence must follow their relative order in the original sequence.\n\n3. Among all sequences that satisfy the conditions, its length is the maximum.\n\nWe treat elements at different positions as different elements. Any two IBvl sequences are considered different if they differ in any chosen element.\n\nNow you need to output the length of the IBvl sequence of the original sequence, and output the positions (in the original sequence) of each element in the $k$-th smallest sequence in lexicographical order (where the key for ordering is the element's position in the original sequence).", "inputFormat": "The first line contains four integers $n$, $k$, $L$, $R$.\n\nThe second line contains $n$ integers, representing the sequence given by the genius LSK.", "outputFormat": "The first line outputs the length of the IBvl sequence.\n\nThe second line outputs the positions of each element of the IBvl sequence in the original sequence.", "hint": "#### Sample Explanation\n\nFor the given data, there are $5$ IBvl sequences in total: $\\{6\\},\\{8\\},\\{0\\},\\{2\\},\\{7\\}$.\n\nTheir index sequences (positions in the original sequence) are $\\{1\\},\\{2\\},\\{3\\},\\{4\\},\\{5\\}$, respectively.\n\nThe length of the IBvl sequence is $1$.\n\nYou are required to output the index sequence that is the $3$-rd smallest in lexicographical order, so the output is $3$.\n\n#### Constraints and Notes\n\nFor $20\\%$ of the testdata, $ n \\le 18 $.\n\nFor $50\\%$ of the testdata, $ n \\le 1000 , | l | , | r | \\leq 10^9 , r-l>1 , 0 \\le a[i] \\le 10^9 $.\n\nFor another $10\\%$ of the testdata, $ l=0 , r=10^9+1 , k=1 $.\n\nFor another $20\\%$ of the testdata, $ l=0 , r=10^9+1 , k \\le 3 $.\n\nFor $100\\%$ of the testdata, $ n \\le 5*10^5 , | l | , | r | \\le 10^9 , r-l>1 , k \\le 10^{13} , 0 \\le a[i] \\le 10^9 $.\n\nFor all testdata, it is guaranteed to be valid and that a solution exists.\n\nFor the first $50\\%$ of the testdata, the time limit is $1\\text{s}$. For the remaining $50\\%$, the time limit is $2\\text{s}$ (~~kind~~ not too strict about constant factors).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "HMR的LIS Ⅲ", "background": "[HMR的LIS Ⅰ](https://www.luogu.org/problemnew/show/T51390)\n\n[HMR的LIS Ⅱ](https://www.luogu.org/problemnew/show/T51391)\n\n在你帮助HMR切掉AKIOI的神仙LSK的两道题后，LSK很不满，决定好好刁难一下你（而不是HMR）", "description": "LSK又给出了一个长度为n的序列，要求你求出它的IBvl序列\n\nIBvl序列满足以下要求：\n\n1.一个IBvl序列满足$ \\forall ~ i \\in (1,len] , L < a_i - a_{i-1} < R $，其中$len$为IBvl序列的长度\n\n2.IBvl序列中的元素相对顺序应满足在原序列中的相对顺序\n\n3.在所有满足条件的序列中长度最长\n\n我们视位置不同的元素为不同元素，有任一组成元素不同的IBvl序列为不同IBvl序列\n\n现在要求你输出原序列的IBvl序列的长度，并输出字典序第k小（以元素在原序列中的位置为关键字排序）的序列的每个元素在原序列中的位置", "inputFormat": "第一行输入4个整数，n，k，L，R\n\n第二行输入n个整数，表示神仙LSK给出的序列", "outputFormat": "第一行输出IBvl序列的长度\n\n第二行输出IBvl序列的每个元素的位置", "hint": "#### 样例解释：\n\n对于给出的数据，一共有$5$种IBvl序列，分别是:$\\{6\\},\\{8\\},\\{0\\},\\{2\\},\\{7\\}$。\n\n他们在原序列中位置的编号序列分别是$\\{1\\},\\{2\\},\\{3\\},\\{4\\},\\{5\\}$\n\nIBvl序列的长度为1。\n\n要求输出字典序第$3$小的编号序列，于是输出$3$。\n\n#### 数据范围与约定：\n\n对于20%的数据，$ n \\le 18$\n\n对于50%的数据，$ n \\le 1000 , | l | , | r | \\leq 10^9 , r-l>1 , 0 \\le a[i] \\le 10^9 $\n\n对于另外10%的数据，$ l=0 , r=10^9+1 , k=1 $\n\n对于另外20%的数据，$ l=0 , r=10^9+1 , k \\le 3 $\n\n对于100%的数据，$ n \\le 5*10^5 , | l | , | r | \\le 10^9 , r-l>1 , k \\le 10^{13} , 0 \\le a[i] \\le 10^9 $\n\n对于所有数据，保证合法且有解。\n\n对于前50%的数据，时限为1s，后50%的数据，时限为2s（~~凉~~良心不卡常）", "locale": "zh-CN"}}}
{"pid": "P5011", "type": "P", "difficulty": 5, "samples": [["2\n6\n1 2 3 4 5 6\n", "16242509\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["素数判断,质数,筛法", "期望", "逆元"], "title": "水の造题", "background": "第一分钟，CYJian 说：“要有样子。”于是便有了 $k$ 种动作。\n\n第二分钟，CYJian 说：“要有活力。”于是便有了 $k$ 种动作组成的总动作数为 $N$ 的搏击操。\n\n第三分钟，CYJian 说：“要有数学。”于是便有了一套搏击操的威力。\n\n第四分钟，CYJian 说：“数字要小。”于是便有了一个伟大的模数 $19491001$。\n\n第五分钟，CYJian 说：“要有规律。”于是便有了一套搏击操威力的计算方法。\n\n第六分钟，CYJian 说：“要有限制。”于是便有了时空限制以及数据范围。\n\n第七分钟，CYJian 说：“要有答案。”于是便有了这道题让你做掉。\n\n……\n\n第 $*$ 分钟，巨佬 Imagine 说：“数据太水。”于是蒟蒻出题人疯了。（详见数据范围）", "description": "现在有一套由 $k$ 种动作组成的动作总数为 $N$ 的搏击操。\n\n已知第 $1, 2, \\cdots, k$ 个动作的威力为 $a[1\\cdots k]$。\n\n且如果第一个动作后紧接着第二个动作，则威力会额外加上 $a[1]+a[2]$。\n\n如果第二个动作后紧接着第三个动作，则威力会额外加上 $a[2]+a[3]$。\n\n……\n\n如果第 $k$ 个动作后紧接着第一个动作，则威力会额外加上 $a[k]+a[1]$。\n\n请求出最后动作的期望威力。\n\n当然，还是要用伟大的模数 $19491001$ 来膜一膜的。", "inputFormat": "第一行，一个正整数 $N$。\n\n第二行，一个正整数 $k$。\n\n第三行，$k$ 个正整数 $a[1\\cdots k]$。", "outputFormat": "一行，一个正整数表示期望的威力模 $19491001$ 的值。", "hint": "### 样例解释\n\n$x-y$ 表示第一个动作为 $x$，第二个动作为 $y$。\n\n- $1-1$：$1+1=2$；\n- $1-2$：$1+2+(1+2)=6$；\n- $1-3$：$1+3=4$；\n- $1-4$：$1+4=5$；\n- $1-5$：$1+5=6$；\n- $1-6$：$1+6=7$；\n- $2-1$：$2+1=3$；\n- $2-2$：$2+2=4$；\n- $2-3$：$2+3+(2+3)=10$；\n- $2-4$：$2+4=6$；\n- $2-5$：$2+5=7$；\n- $2-6$：$2+6=8$；\n- $3-1$：$3+1=4$；\n- $3-2$：$3+2=5$；\n- $3-3$：$3+3=6$；\n- $3-4$：$3+4+(3+4)=14$；\n- $3-5$：$3+5=8$；\n- $3-6$：$3+6=9$；\n- $4-1$：$4+1=5$；\n- $4-2$：$4+2=6$；\n- $4-3$：$4+3=7$；\n- $4-4$：$4+4=8$；\n- $4-5$：$4+5+(4+5)=18$；\n- $4-6$：$4+6=10$；\n- $5-1$：$5+1=6$；\n- $5-2$：$5+2=7$；\n- $5-3$：$5+3=8$；\n- $5-4$：$5+4=9$；\n- $5-5$：$5+5=10$；\n- $5-6$：$5+6+(5+6)=22$；\n- $6-1$：$6+1+(6+1)=14$；\n- $6-2$：$6+2=8$；\n- $6-3$：$6+3=9$；\n- $6-4$：$6+4=10$；\n- $6-5$：$6+5=11$；\n- $6-6$：$6+6=12$。\n\n$2+6+4+5+6+7+3+4+10+6+7+8+4+5+6+14+8+9+5+6+7+8+18+10+6+7+8+9+10+22+14+8+9+10+11+12=294$。\n\n$294/36=49/6$。\n\n$1/6 \\equiv 16242501 \\pmod{19491001}$。\n\n$ans = 49 \\times 16242501 \\bmod 19491001 = 16242509$。\n\n\nSubtask 1（20 pts）：$1 \\leq N \\leq 10$，$1 \\leq k \\leq 7$；\n- Subtask 2（20 pts）：$1 \\leq N \\leq 10^6$，$1 \\leq k \\leq 7$；\n- Subtask 3（20 pts）：$1 \\leq N \\leq 10^{40000}$，$1 \\leq k \\leq 7$；\n- Subtask 4（20 pts）：$1 \\leq N \\leq 10^{10^6}$，$1 \\leq k \\leq 7$；\n- Subtask 5（20 pts）：$1 \\leq N \\leq 10^{10^6}$，$1 \\leq k \\leq 10^6$。\n\n保证所有的数据：$1 \\leq a[i] \\leq 10^7$。\n\n**注意：本题捆绑测试。**\n\n小提示：\n\n可以用下面的 $\\texttt{inv(}x\\texttt{)}$ 求出 $x$ 的逆元：\n\n```\nlong long mod = 19491001;\n\nlong long quick_pow(long long x, int k) {\n    long long res = 1;\n    while(k) {\n        if(k & 1) res = res * x % mod;\n        x = x * x % mod;\n        k >>= 1;\n    }\n    return res;\n}\n\nlong long inv(long long x) {\n    return quick_pow(x, mod - 2);\n}\n```", "locale": "zh-CN", "translations": {"en": {"title": "Mizu’s Problem Setting.", "background": "In the first minute, CYJian said, “There should be some form.” So there were $k$ kinds of moves.\n\nIn the second minute, CYJian said, “There should be energy.” So there was a combat-aerobics routine with a total of $N$ moves composed of the $k$ kinds of moves.\n\nIn the third minute, CYJian said, “There should be math.” So there was a definition of the power of a routine.\n\nIn the fourth minute, CYJian said, “Numbers should be small.” So there was a great modulus $19491001$.\n\nIn the fifth minute, CYJian said, “There should be a pattern.” So there was a way to compute the power of a routine.\n\nIn the sixth minute, CYJian said, “There should be limits.” So there were time and memory limits and Constraints.\n\nIn the seventh minute, CYJian said, “There should be an answer.” So there was this problem for you to solve.\n\n……\n\nIn the $*$-th minute, the expert Imagine said, “The testdata is too easy.” So the newbie problem setter went crazy. (See Constraints for details.)", "description": "Now there is a combat-aerobics routine consisting of $k$ kinds of moves, with a total of $N$ moves.\n\nIt is known that the power of moves $1, 2, \\cdots, k$ is $a[1\\cdots k]$.\n\nAlso, if the first move is immediately followed by the second move, then the power will additionally increase by $a[1]+a[2]$.\n\nIf the second move is immediately followed by the third move, then the power will additionally increase by $a[2]+a[3]$.\n\n……\n\nIf the $k$-th move is immediately followed by the first move, then the power will additionally increase by $a[k]+a[1]$.\n\nPlease find the expected power of the final routine.\n\nOf course, you still need to take it modulo the great modulus $19491001$.", "inputFormat": "The first line contains a positive integer $N$.\n\nThe second line contains a positive integer $k$.\n\nThe third line contains $k$ positive integers $a[1\\cdots k]$.", "outputFormat": "One line, a positive integer representing the expected power modulo $19491001$.", "hint": "### Sample Explanation\n\n$x-y$ means the first move is $x$ and the second move is $y$.\n\n- $1-1$: $1+1=2$;\n- $1-2$: $1+2+(1+2)=6$;\n- $1-3$: $1+3=4$;\n- $1-4$: $1+4=5$;\n- $1-5$: $1+5=6$;\n- $1-6$: $1+6=7$;\n- $2-1$: $2+1=3$;\n- $2-2$: $2+2=4$;\n- $2-3$: $2+3+(2+3)=10$;\n- $2-4$: $2+4=6$;\n- $2-5$: $2+5=7$;\n- $2-6$: $2+6=8$;\n- $3-1$: $3+1=4$;\n- $3-2$: $3+2=5$;\n- $3-3$: $3+3=6$;\n- $3-4$: $3+4+(3+4)=14$;\n- $3-5$: $3+5=8$;\n- $3-6$: $3+6=9$;\n- $4-1$: $4+1=5$;\n- $4-2$: $4+2=6$;\n- $4-3$: $4+3=7$;\n- $4-4$: $4+4=8$;\n- $4-5$: $4+5+(4+5)=18$;\n- $4-6$: $4+6=10$;\n- $5-1$: $5+1=6$;\n- $5-2$: $5+2=7$;\n- $5-3$: $5+3=8$;\n- $5-4$: $5+4=9$;\n- $5-5$: $5+5=10$;\n- $5-6$: $5+6+(5+6)=22$;\n- $6-1$: $6+1+(6+1)=14$;\n- $6-2$: $6+2=8$;\n- $6-3$: $6+3=9$;\n- $6-4$: $6+4=10$;\n- $6-5$: $6+5=11$;\n- $6-6$: $6+6=12$.\n\n$2+6+4+5+6+7+3+4+10+6+7+8+4+5+6+14+8+9+5+6+7+8+18+10+6+7+8+9+10+22+14+8+9+10+11+12=294$.\n\n$294/36=49/6$.\n\n$1/6 \\equiv 16242501 \\pmod{19491001}$.\n\n$ans = 49 \\times 16242501 \\bmod 19491001 = 16242509$.\n\nSubtask 1 (20 pts): $1 \\leq N \\leq 10$, $1 \\leq k \\leq 7$.\n- Subtask 2 (20 pts): $1 \\leq N \\leq 10^6$, $1 \\leq k \\leq 7$.\n- Subtask 3 (20 pts): $1 \\leq N \\leq 10^{40000}$, $1 \\leq k \\leq 7$.\n- Subtask 4 (20 pts): $1 \\leq N \\leq 10^{10^6}$, $1 \\leq k \\leq 7$.\n- Subtask 5 (20 pts): $1 \\leq N \\leq 10^{10^6}$, $1 \\leq k \\leq 10^6$.\n\nIt is guaranteed for all testdata that $1 \\leq a[i] \\leq 10^7$.\n\n**Note: This problem uses bundled tests.**\n\nA small hint:\n\nYou can use the following $\\texttt{inv(}x\\texttt{)}$ to compute the modular inverse of $x$:\n\n```\nlong long mod = 19491001;\n\nlong long quick_pow(long long x, int k) {\n    long long res = 1;\n    while(k) {\n        if(k & 1) res = res * x % mod;\n        x = x * x % mod;\n        k >>= 1;\n    }\n    return res;\n}\n\nlong long inv(long long x) {\n    return quick_pow(x, mod - 2);\n}\n```\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "水の造题", "background": "第一分钟，CYJian 说：“要有样子。”于是便有了 $k$ 种动作。\n\n第二分钟，CYJian 说：“要有活力。”于是便有了 $k$ 种动作组成的总动作数为 $N$ 的搏击操。\n\n第三分钟，CYJian 说：“要有数学。”于是便有了一套搏击操的威力。\n\n第四分钟，CYJian 说：“数字要小。”于是便有了一个伟大的模数 $19491001$。\n\n第五分钟，CYJian 说：“要有规律。”于是便有了一套搏击操威力的计算方法。\n\n第六分钟，CYJian 说：“要有限制。”于是便有了时空限制以及数据范围。\n\n第七分钟，CYJian 说：“要有答案。”于是便有了这道题让你做掉。\n\n……\n\n第 $*$ 分钟，巨佬 Imagine 说：“数据太水。”于是蒟蒻出题人疯了。（详见数据范围）", "description": "现在有一套由 $k$ 种动作组成的动作总数为 $N$ 的搏击操。\n\n已知第 $1, 2, \\cdots, k$ 个动作的威力为 $a[1\\cdots k]$。\n\n且如果第一个动作后紧接着第二个动作，则威力会额外加上 $a[1]+a[2]$。\n\n如果第二个动作后紧接着第三个动作，则威力会额外加上 $a[2]+a[3]$。\n\n……\n\n如果第 $k$ 个动作后紧接着第一个动作，则威力会额外加上 $a[k]+a[1]$。\n\n请求出最后动作的期望威力。\n\n当然，还是要用伟大的模数 $19491001$ 来膜一膜的。", "inputFormat": "第一行，一个正整数 $N$。\n\n第二行，一个正整数 $k$。\n\n第三行，$k$ 个正整数 $a[1\\cdots k]$。", "outputFormat": "一行，一个正整数表示期望的威力模 $19491001$ 的值。", "hint": "### 样例解释\n\n$x-y$ 表示第一个动作为 $x$，第二个动作为 $y$。\n\n- $1-1$：$1+1=2$；\n- $1-2$：$1+2+(1+2)=6$；\n- $1-3$：$1+3=4$；\n- $1-4$：$1+4=5$；\n- $1-5$：$1+5=6$；\n- $1-6$：$1+6=7$；\n- $2-1$：$2+1=3$；\n- $2-2$：$2+2=4$；\n- $2-3$：$2+3+(2+3)=10$；\n- $2-4$：$2+4=6$；\n- $2-5$：$2+5=7$；\n- $2-6$：$2+6=8$；\n- $3-1$：$3+1=4$；\n- $3-2$：$3+2=5$；\n- $3-3$：$3+3=6$；\n- $3-4$：$3+4+(3+4)=14$；\n- $3-5$：$3+5=8$；\n- $3-6$：$3+6=9$；\n- $4-1$：$4+1=5$；\n- $4-2$：$4+2=6$；\n- $4-3$：$4+3=7$；\n- $4-4$：$4+4=8$；\n- $4-5$：$4+5+(4+5)=18$；\n- $4-6$：$4+6=10$；\n- $5-1$：$5+1=6$；\n- $5-2$：$5+2=7$；\n- $5-3$：$5+3=8$；\n- $5-4$：$5+4=9$；\n- $5-5$：$5+5=10$；\n- $5-6$：$5+6+(5+6)=22$；\n- $6-1$：$6+1+(6+1)=14$；\n- $6-2$：$6+2=8$；\n- $6-3$：$6+3=9$；\n- $6-4$：$6+4=10$；\n- $6-5$：$6+5=11$；\n- $6-6$：$6+6=12$。\n\n$2+6+4+5+6+7+3+4+10+6+7+8+4+5+6+14+8+9+5+6+7+8+18+10+6+7+8+9+10+22+14+8+9+10+11+12=294$。\n\n$294/36=49/6$。\n\n$1/6 \\equiv 16242501 \\pmod{19491001}$。\n\n$ans = 49 \\times 16242501 \\bmod 19491001 = 16242509$。\n\n\nSubtask 1（20 pts）：$1 \\leq N \\leq 10$，$1 \\leq k \\leq 7$；\n- Subtask 2（20 pts）：$1 \\leq N \\leq 10^6$，$1 \\leq k \\leq 7$；\n- Subtask 3（20 pts）：$1 \\leq N \\leq 10^{40000}$，$1 \\leq k \\leq 7$；\n- Subtask 4（20 pts）：$1 \\leq N \\leq 10^{10^6}$，$1 \\leq k \\leq 7$；\n- Subtask 5（20 pts）：$1 \\leq N \\leq 10^{10^6}$，$1 \\leq k \\leq 10^6$。\n\n保证所有的数据：$1 \\leq a[i] \\leq 10^7$。\n\n**注意：本题捆绑测试。**\n\n小提示：\n\n可以用下面的 $\\texttt{inv(}x\\texttt{)}$ 求出 $x$ 的逆元：\n\n```\nlong long mod = 19491001;\n\nlong long quick_pow(long long x, int k) {\n    long long res = 1;\n    while(k) {\n        if(k & 1) res = res * x % mod;\n        x = x * x % mod;\n        k >>= 1;\n    }\n    return res;\n}\n\nlong long inv(long long x) {\n    return quick_pow(x, mod - 2);\n}\n```", "locale": "zh-CN"}}}
{"pid": "P5012", "type": "P", "difficulty": 5, "samples": [["5 3\n3 5 1 2 4\n233 666 1 3\n555 999 2 3\n123 987 233 888", "25 5\n1 3 0\n10 4\n2 3 0\n-1 -1\n3 3 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "并查集", "O2优化", "分块", "ST 表"], "title": "水の数列", "background": "${\\rm CYJian}$想到了一个很好玩的游戏呢...", "description": "${\\rm CYJian}$现在给你一个长度为$N$的数列，你可以选择一个数$x$，然后获得一个得分，得分越大越好。\n\n得分是这样计算的:\n\n首先把小于等于$x$的数标记，然后你的得分就是每一个连续标记的区间的长度的平方和。\n\n${\\rm CYJian}$觉得这样太简单了，~~答案显然就是最大值嘛~~所以他就把得分改成了原来的得分除以你选择的数。\n\n${\\rm CYJian}$还是觉得这样太简单了，所以他需要你选择的数得到的区间的个数在$l$~$r$的范围内。\n\n${\\rm CYJian}$还是觉得这样太简单了，所以他加上了$T$组询问。\n\n${\\rm CYJian}$还是觉得这样太简单了，所以他决定强制在线。", "inputFormat": "第一行两个正整数$n$，$T$。\n\n第二行$n$个正整数$Num_i$表示${\\rm CYJian}$给出的数列。\n\n接下来$T$行，每行四个正整数$a$，$b$，$x$，$y$，你需要这样得到真正的$l$和$r$:\n\n```\nl = (a * lastans + x - 1) % n + 1;\nr = (b * lastans + y - 1) % n + 1;\nif (l > r) swap(l, r);\n```\n\n其中${\\rm lastans}$表示上一次询问的最大分数(原始得分)和得到这个最大的分数的$x$的乘积。特别的，我们令第一次询问时${\\rm lastans}=0$。", "outputFormat": "$T$行，每行两个正整数表示每一次询问能得到的最大的分数(原始的得分)和得到这个最大的分数的$x$。特别的，如果无解输出\"$-1\\ -1$\"（此时 $lastans$ 为 $1$）。如果有多解则输出选择的数最大的一组。\n\n$CYJian$想知道你是不是蒙的，所以你还需要告诉他**这一次询问的**$L$，$R$，$lastans \\bmod n$。\n\n具体参见样例。", "hint": "${\\rm Subtask\\ 1(30\\ pts)}:\\qquad 1 \\leq N,T \\leq 10^2$\n\n${\\rm Subtask\\ 2(30\\ pts)}:\\qquad 1 \\leq N,T \\leq 10^3$\n\n${\\rm Subtask\\ 3(40\\ pts)}:\\qquad 1 \\leq N \\leq 10^6 \\qquad 1 \\leq T \\leq 10^3$\n\n$1 \\leq Num_i \\leq 10^6$\n\n其余输入的数字均在${\\rm int}$范围内。", "locale": "zh-CN", "translations": {"en": {"title": "Water Sequence", "background": "${\\rm CYJian}$ came up with a very fun game...", "description": "${\\rm CYJian}$ now gives you a sequence of length $N$. You may choose a number $x$, and then obtain a score. The larger the score, the better.\n\nThe score is computed as follows:\n\nFirst, mark all numbers that are less than or equal to $x$. Then, your score is the sum of the squares of the lengths of every consecutive marked segment.\n\n${\\rm CYJian}$ thought this was too easy, ~~the answer is obviously just the maximum value~~ so he changed the score to be the original score divided by the number you chose.\n\n${\\rm CYJian}$ still thought this was too easy, so he requires that the number of segments obtained by your chosen number must be within the range $l$ to $r$.\n\n${\\rm CYJian}$ still thought this was too easy, so he added $T$ queries.\n\n${\\rm CYJian}$ still thought this was too easy, so he decided to enforce online queries.", "inputFormat": "The first line contains two positive integers $n$, $T$.\n\nThe second line contains $n$ positive integers $Num_i$, representing the sequence given by ${\\rm CYJian}$.\n\nIn the next $T$ lines, each line contains four positive integers $a$, $b$, $x$, $y$. You need to obtain the actual $l$ and $r$ as follows:\n\n```\nl = (a * lastans + x - 1) % n + 1;\nr = (b * lastans + y - 1) % n + 1;\nif (l > r) swap(l, r);\n```\n\nHere, ${\\rm lastans}$ denotes the product of the maximum score (the original score) from the previous query and the $x$ that achieves this maximum score. In particular, for the first query we define ${\\rm lastans}=0$.", "outputFormat": "Output $T$ lines. Each line contains two positive integers, representing the maximum score (the original score) that can be obtained for this query and the $x$ that achieves this maximum score. In particular, if there is no solution, output \"$-1\\ -1$\" (in this case, $lastans$ is $1$). If there are multiple solutions, output the one with the largest chosen number.\n\n$CYJian$ wants to know whether you are guessing, so you also need to tell him $L$, $R$, and $lastans \\bmod n$ **for this query**.\n\nSee the sample for details.", "hint": "${\\rm Subtask\\ 1(30\\ pts)}:\\qquad 1 \\leq N,T \\leq 10^2$\n\n${\\rm Subtask\\ 2(30\\ pts)}:\\qquad 1 \\leq N,T \\leq 10^3$\n\n${\\rm Subtask\\ 3(40\\ pts)}:\\qquad 1 \\leq N \\leq 10^6 \\qquad 1 \\leq T \\leq 10^3$\n\n$1 \\leq Num_i \\leq 10^6$\n\nAll other input numbers are within the range of ${\\rm int}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "水の数列", "background": "${\\rm CYJian}$想到了一个很好玩的游戏呢...", "description": "${\\rm CYJian}$现在给你一个长度为$N$的数列，你可以选择一个数$x$，然后获得一个得分，得分越大越好。\n\n得分是这样计算的:\n\n首先把小于等于$x$的数标记，然后你的得分就是每一个连续标记的区间的长度的平方和。\n\n${\\rm CYJian}$觉得这样太简单了，~~答案显然就是最大值嘛~~所以他就把得分改成了原来的得分除以你选择的数。\n\n${\\rm CYJian}$还是觉得这样太简单了，所以他需要你选择的数得到的区间的个数在$l$~$r$的范围内。\n\n${\\rm CYJian}$还是觉得这样太简单了，所以他加上了$T$组询问。\n\n${\\rm CYJian}$还是觉得这样太简单了，所以他决定强制在线。", "inputFormat": "第一行两个正整数$n$，$T$。\n\n第二行$n$个正整数$Num_i$表示${\\rm CYJian}$给出的数列。\n\n接下来$T$行，每行四个正整数$a$，$b$，$x$，$y$，你需要这样得到真正的$l$和$r$:\n\n```\nl = (a * lastans + x - 1) % n + 1;\nr = (b * lastans + y - 1) % n + 1;\nif (l > r) swap(l, r);\n```\n\n其中${\\rm lastans}$表示上一次询问的最大分数(原始得分)和得到这个最大的分数的$x$的乘积。特别的，我们令第一次询问时${\\rm lastans}=0$。", "outputFormat": "$T$行，每行两个正整数表示每一次询问能得到的最大的分数(原始的得分)和得到这个最大的分数的$x$。特别的，如果无解输出\"$-1\\ -1$\"（此时 $lastans$ 为 $1$）。如果有多解则输出选择的数最大的一组。\n\n$CYJian$想知道你是不是蒙的，所以你还需要告诉他**这一次询问的**$L$，$R$，$lastans \\bmod n$。\n\n具体参见样例。", "hint": "${\\rm Subtask\\ 1(30\\ pts)}:\\qquad 1 \\leq N,T \\leq 10^2$\n\n${\\rm Subtask\\ 2(30\\ pts)}:\\qquad 1 \\leq N,T \\leq 10^3$\n\n${\\rm Subtask\\ 3(40\\ pts)}:\\qquad 1 \\leq N \\leq 10^6 \\qquad 1 \\leq T \\leq 10^3$\n\n$1 \\leq Num_i \\leq 10^6$\n\n其余输入的数字均在${\\rm int}$范围内。", "locale": "zh-CN"}}}
{"pid": "P5013", "type": "P", "difficulty": 5, "samples": [["0 2 3\nCYJian\nJerryC\nJustin\nCYJian\na10 b10 c10 d10 a9\nJerryC\ncA b2 c3 d4 d5\nJustin\naA bA dA a4 c6\nCYJian\naA b2 c3 d4 a5\nJerryC\nbA c2 d3 a4 b5\nJustin\ncA d2 a3 c4 c5", "CYJian 220\nJerryC -160\nJustin -60"], ["0 3 4\nCYJian\nJerryC\nSamcompu\nHsl2363\nCYJian\na2 b5 c8 d4 aA\nSamcompu\na2 bA c3 a4 c5\nJerryC\naA b2 c7 c4 c6\nHsl2363\naA bA cA dA a10\nSamcompu\na2 b2 c2 d2 b10\nJerryC\na3 b3 c3 d3 c10\nHsl2363\na5 c6 d8 a9 b9\nJerryC\nb6 b2 c9 a7 d2\nCYJian\nb5 d5 c5 a6 d9", "CYJian 120\nJerryC 150\nSamcompu -60\nHsl2363 -210\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "O2优化"], "title": "水の斗牛", "background": "蒟蒻 ${\\rm CYJian}$ 拉着 ${\\rm JerryC}$ 和 ${\\rm Justin}$ 等一众机房巨佬来打斗牛辣！！", "description": "现在一共有 $N$ 个人玩起了斗牛。一共玩了 $T$ 局，每局有三个人参与游戏，每个人的初始分都是 $0$。\n\n本题为了方便，对于斗牛的基本规则做了些许变动，具体规则如下：\n\n### 1.基本规则\n\n每一轮斗牛开始时，每一位玩家都会拿到 $5$ 张牌。\n\n每张牌一定是一个 $2$ 到 $10$ 之间的整数或 `A`（表示 $1$）。\n\n每张牌有一个花色，a 代表黑桃，b 代表红桃，c 代表梅花，d 代表方块。\n\n\n### 2.牌型\n\n五张牌中，除炸弹和无牛牌型以外，都分为两个部分：牛和分。其中牛包括三张点数相同（铁板）或三张点数和为 $10$ 的倍数的牌，分包括剩下的两张牌，一套牌的分即为这两张牌模 $10$ 的余数。\n\n（1）炸弹：四张点数相同的牌。\n\n（2）牛牛：分恰好为 $0$。\n\n（3）牛：分不为 $0$，分和牛数的数值相同。如分是 $5$，则这套牌被称为牛五。\n\n（4）无牛：不存在三张牌，其点数相同或其点数和为 $10$ 的倍数。\n\n### 3.牌型大小关系\n\n炸弹>牛牛>牛九>牛八>……>牛二>牛一>无牛。\n\n双方拥有炸弹时，炸弹点数大的更大；\n\n相同牛数且只有一方有铁板时，有铁板的比没有铁板的大；\n\n相同牛数且双方拥有铁板时，铁板点数大的更大；\n\n相同牛数且双方均没有铁板或双方均无牛时，我们比较双方牌中点数最大的一张牌，点数更大的一方更大；若双方点数最大的一张牌点数相同，则花色更大的一方更大，花色大小为黑桃>红桃>梅花>方块。\n\n### 4.计分\n\n一局牌的底分为 $10$，即每位玩家都会押 $10$ 分。\n\n对于其中的两位玩家，我们在比较完双方的牌型之后，选择牌型更大的一方的牌型来计算得失分数的翻倍。具体如下：\n\n（1）炸弹：底分${}\\times 10$。\n\n（2）牛牛：底分${}\\times 3$。\n\n（3）牛七/牛八/牛九：底分${}\\times 2$。\n\n（4）牛六~牛一：底分。\n\n（5）无牛：底分。\n\n（6）铁板：在计算完牌型得分之后，在牌型得分的基础上${}\\times 2$。注意铁板翻倍不与炸弹同时进行。\n\n我们在计分时，采用两两之间计分的方式，也就是说对于三名玩家 A、B、C，我们先计算 A 和 B 之间的分数得失，再计算 A 和 C 之间的分数得失，最后计算 B 和 C 之间的分数得失。\n\n现在我们假设所有玩家都足够聪明，也就是说，所有玩家都会打出他们手上的牌中最大的牌型。${\\rm CYJian}$ 想知道，在这 $T$ 轮游戏结束之后，每位玩家的得分情况。", "inputFormat": "第一行两个整数 $id,T,N$。其中 $id$ 表示测试点编号，对于部分分可能有一定帮助。其中样例的测试点编号为 $0$。\n\n接下来 $N$ 行，每行一个仅包括大小写字母和数字的长度少于 $11$ 的字符串表示玩家名称。\n\n接下来 $T$ 组，每组数据六行，可分为三个相同的部分：\n\n第一行一个字符串表示玩家名称。\n\n第二行五个字符串表示该玩家手中的手牌。每一个字符串的第一个字符表示花色，其余字符表示牌的大小。", "outputFormat": "共 $N$ 行，每行一个字符串和一个数字，中间用空格隔开。表示一名玩家和他的最终得分。\n\n请按照玩家名称的输入顺序输出。", "hint": "样例一解释：\n\n第一局玩家牌型如下：\n\n${\\rm CYJian}$：炸弹\n\n${\\rm JerryC}$：牛五\n\n${\\rm Justin}$：铁板牛牛\n\n所以 ${\\rm CYJian}$ 加 $200$ 分，${\\rm JerryC}$ 扣 $160$ 分，${\\rm Justin}$ 扣 $40$ 分。\n\n第二局中，所有人都是牛五，但是 ${\\rm CYJian}$ 拥有黑桃五，${\\rm JerryC}$ 拥有红桃五，${\\rm Justin}$ 拥有梅花五，所以 ${\\rm CYJian}$ 加 $20$ 分，${\\rm JerryC}$ 没有变化，${\\rm Justin}$ 扣 $20$ 分。\n\n数据范围：\n\n| 测试点编号 |   $T$    |   $N$   | 特殊性质 |\n| :--------: | :------: | :-----: | :------: |\n|    $1$     |   $0$    |   $3$   |    性质 4    |\n|    $2$     |   $5$   |  $5$   |    性质 4    |\n|  $3$-$4$   |   $5$   |  $5$   |  性质 1   |\n|  $5$-$6$   |   $5$   |  $5$   |  性质 2   |\n|  $7$-$8$   |   $5$   |  $5$   |  性质 3   |\n|  $9$-$10$  |   $5$   |  $5$   |  性质 5   |\n| $11$-$12$  |   $10$    |   $10$   |  性质 5   |\n| $13$-$14$  |   $100$   |  $100$   |  性质 5   |\n| $15$-$16$  |  $1000$   |  $1000$  |  性质 5   |\n| $17$-$18$  |  $10000$  | $10000$  |  性质 5   |\n| $19$-$20$  | $100000$ | $100000$ |  性质 5，1.5s   |\n\n性质 1：保证所有的人拥有炸弹。\n\n性质 2：保证每一手牌花色全部相同。\n\n性质 3：保证每一手牌所有数字不同。\n\n性质 4：保证数据手造。\n\n性质 5：保证数据随机生成。\n\n保证每一局没有重复的牌。\n\n保证每一个人的名字不相同。\n\n保证出题人是 ${\\rm CYJian}$。\n\n保证数据没有锅。\n\n不保证没有人能做出来。\n\n不保证此题代码很长。", "locale": "zh-CN", "translations": {"en": {"title": "Water Bullfight", "background": "Newbie ${\\rm CYJian}$ dragged ${\\rm JerryC}$, ${\\rm Justin}$, and a group of big shots from the computer lab to play Bullfight!!", "description": "There are now $N$ people playing Bullfight. A total of $T$ rounds are played. In each round, three people participate, and everyone starts with a score of $0$.\n\nFor convenience, this problem makes some small changes to the basic rules of Bullfight. The detailed rules are as follows.\n\n### 1. Basic Rules\n\nAt the start of each Bullfight round, each player receives $5$ cards.\n\nEach card is either an integer from $2$ to $10$ or `A` (which represents $1$).\n\nEach card has a suit: `a` for spades, `b` for hearts, `c` for clubs, and `d` for diamonds.\n\n### 2. Hand Types\n\nAmong the five cards, except for Bomb and No Bull, every hand is divided into two parts: Bull and Points.\n\n- The Bull part consists of either three cards with the same rank (Iron Plate), or three cards whose ranks sum to a multiple of $10$.\n- The Points part consists of the remaining two cards. The points of a hand is the remainder of the sum of these two cards modulo $10$.\n\nThe hand types are:\n\n(1) Bomb: four cards with the same rank.\n\n(2) Bull Bull: the points is exactly $0$.\n\n(3) Bull: the points is not $0$, and the value of the points equals the bull number. For example, if the points is $5$, then this hand is called Bull Five.\n\n(4) No Bull: there do not exist three cards whose ranks are all the same, or whose rank sum is a multiple of $10$.\n\n### 3. Hand Ranking Rules\n\nBomb $>$ Bull Bull $>$ Bull Nine $>$ Bull Eight $>$ $\\cdots$ $>$ Bull Two $>$ Bull One $>$ No Bull.\n\nIf both sides have Bomb, the Bomb with the larger rank is larger.\n\nIf the bull number is the same and only one side has an Iron Plate, the one with an Iron Plate is larger.\n\nIf the bull number is the same and both sides have an Iron Plate, the Iron Plate with the larger rank is larger.\n\nIf the bull number is the same and neither side has an Iron Plate, or both sides have No Bull, compare the highest-rank card in each hand. The side with the larger highest card is larger. If the highest card ranks are equal, compare suits: spades $>$ hearts $>$ clubs $>$ diamonds.\n\n### 4. Scoring\n\nThe base score of a hand is $10$, meaning each player bets $10$ points.\n\nFor any two players, after comparing their hand types, we take the larger hand type (between the two) to determine the score multiplier for the gain/loss. The rules are:\n\n(1) Bomb: base score $\\times 10$.\n\n(2) Bull Bull: base score $\\times 3$.\n\n(3) Bull Seven / Bull Eight / Bull Nine: base score $\\times 2$.\n\n(4) Bull Six to Bull One: base score.\n\n(5) No Bull: base score.\n\n(6) Iron Plate: after computing the hand-type score, multiply by $2$ based on that score. Note that the Iron Plate multiplier is not applied together with Bomb.\n\nScoring is done pairwise. That is, for three players A, B, and C, we first compute the score gain/loss between A and B, then between A and C, and finally between B and C.\n\nNow assume all players are smart enough, meaning every player will always play the largest possible hand type from the cards in their hand. ${\\rm CYJian}$ wants to know, after these $T$ rounds, the final score of each player.", "inputFormat": "The first line contains three integers $id, T, N$. Here $id$ is the test point index, which may be helpful for partial scoring. In the samples, the test point index is $0$.\n\nThe next $N$ lines each contain a string of length less than $11$ consisting only of letters (uppercase/lowercase) and digits, representing a player name.\n\nThen follow $T$ groups. Each group has six lines, and can be viewed as three identical parts:\n\n- The first line contains a string: the player name.\n- The second line contains five strings: the player’s five cards. For each string, the first character is the suit, and the remaining characters represent the rank.", "outputFormat": "Output $N$ lines. Each line contains a string and an integer, separated by a space, representing a player and their final score.\n\nPlease output in the same order as the player names are given in the input.", "hint": "Explanation for Sample 1.\n\nIn the first round, the hand types are:\n\n${\\rm CYJian}$: Bomb\n\n${\\rm JerryC}$: Bull Five\n\n${\\rm Justin}$: Iron Plate Bull Bull\n\nSo ${\\rm CYJian}$ gains $200$ points, ${\\rm JerryC}$ loses $160$ points, and ${\\rm Justin}$ loses $40$ points.\n\nIn the second round, everyone has Bull Five, but ${\\rm CYJian}$ has the spade five, ${\\rm JerryC}$ has the heart five, and ${\\rm Justin}$ has the club five. So ${\\rm CYJian}$ gains $20$ points, ${\\rm JerryC}$ does not change, and ${\\rm Justin}$ loses $20$ points.\n\nConstraints:\n\n| Test Point Index |   $T$    |   $N$   | Special Property |\n| :--------------: | :------: | :-----: | :--------------: |\n|      $1$      |   $0$    |   $3$   | Property 4 |\n|      $2$      |   $5$    |   $5$   | Property 4 |\n|    $3$-$4$    |   $5$    |   $5$   | Property 1 |\n|    $5$-$6$    |   $5$    |   $5$   | Property 2 |\n|    $7$-$8$    |   $5$    |   $5$   | Property 3 |\n|   $9$-$10$    |   $5$    |   $5$   | Property 5 |\n|  $11$-$12$    |   $10$   |   $10$  | Property 5 |\n|  $13$-$14$    |  $100$   |  $100$  | Property 5 |\n|  $15$-$16$    |  $1000$  |  $1000$ | Property 5 |\n|  $17$-$18$    | $10000$  | $10000$ | Property 5 |\n|  $19$-$20$    | $100000$ | $100000$ | Property 5, $1.5\\text{s}$ |\n\nProperty 1: It is guaranteed that everyone has a Bomb.\n\nProperty 2: It is guaranteed that all suits in each hand are the same.\n\nProperty 3: It is guaranteed that all ranks in each hand are different.\n\nProperty 4: It is guaranteed that the testdata is handcrafted.\n\nProperty 5: It is guaranteed that the testdata is randomly generated.\n\nIt is guaranteed that there are no repeated cards within any round.\n\nIt is guaranteed that every player has a unique name.\n\nIt is guaranteed that the problem setter is ${\\rm CYJian}$.\n\nIt is guaranteed that the data has no bugs.\n\nIt is not guaranteed that someone can solve it.\n\nIt is not guaranteed that the code for this problem is very long.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "水の斗牛", "background": "蒟蒻 ${\\rm CYJian}$ 拉着 ${\\rm JerryC}$ 和 ${\\rm Justin}$ 等一众机房巨佬来打斗牛辣！！", "description": "现在一共有 $N$ 个人玩起了斗牛。一共玩了 $T$ 局，每局有三个人参与游戏，每个人的初始分都是 $0$。\n\n本题为了方便，对于斗牛的基本规则做了些许变动，具体规则如下：\n\n### 1.基本规则\n\n每一轮斗牛开始时，每一位玩家都会拿到 $5$ 张牌。\n\n每张牌一定是一个 $2$ 到 $10$ 之间的整数或 `A`（表示 $1$）。\n\n每张牌有一个花色，a 代表黑桃，b 代表红桃，c 代表梅花，d 代表方块。\n\n\n### 2.牌型\n\n五张牌中，除炸弹和无牛牌型以外，都分为两个部分：牛和分。其中牛包括三张点数相同（铁板）或三张点数和为 $10$ 的倍数的牌，分包括剩下的两张牌，一套牌的分即为这两张牌模 $10$ 的余数。\n\n（1）炸弹：四张点数相同的牌。\n\n（2）牛牛：分恰好为 $0$。\n\n（3）牛：分不为 $0$，分和牛数的数值相同。如分是 $5$，则这套牌被称为牛五。\n\n（4）无牛：不存在三张牌，其点数相同或其点数和为 $10$ 的倍数。\n\n### 3.牌型大小关系\n\n炸弹>牛牛>牛九>牛八>……>牛二>牛一>无牛。\n\n双方拥有炸弹时，炸弹点数大的更大；\n\n相同牛数且只有一方有铁板时，有铁板的比没有铁板的大；\n\n相同牛数且双方拥有铁板时，铁板点数大的更大；\n\n相同牛数且双方均没有铁板或双方均无牛时，我们比较双方牌中点数最大的一张牌，点数更大的一方更大；若双方点数最大的一张牌点数相同，则花色更大的一方更大，花色大小为黑桃>红桃>梅花>方块。\n\n### 4.计分\n\n一局牌的底分为 $10$，即每位玩家都会押 $10$ 分。\n\n对于其中的两位玩家，我们在比较完双方的牌型之后，选择牌型更大的一方的牌型来计算得失分数的翻倍。具体如下：\n\n（1）炸弹：底分${}\\times 10$。\n\n（2）牛牛：底分${}\\times 3$。\n\n（3）牛七/牛八/牛九：底分${}\\times 2$。\n\n（4）牛六~牛一：底分。\n\n（5）无牛：底分。\n\n（6）铁板：在计算完牌型得分之后，在牌型得分的基础上${}\\times 2$。注意铁板翻倍不与炸弹同时进行。\n\n我们在计分时，采用两两之间计分的方式，也就是说对于三名玩家 A、B、C，我们先计算 A 和 B 之间的分数得失，再计算 A 和 C 之间的分数得失，最后计算 B 和 C 之间的分数得失。\n\n现在我们假设所有玩家都足够聪明，也就是说，所有玩家都会打出他们手上的牌中最大的牌型。${\\rm CYJian}$ 想知道，在这 $T$ 轮游戏结束之后，每位玩家的得分情况。", "inputFormat": "第一行两个整数 $id,T,N$。其中 $id$ 表示测试点编号，对于部分分可能有一定帮助。其中样例的测试点编号为 $0$。\n\n接下来 $N$ 行，每行一个仅包括大小写字母和数字的长度少于 $11$ 的字符串表示玩家名称。\n\n接下来 $T$ 组，每组数据六行，可分为三个相同的部分：\n\n第一行一个字符串表示玩家名称。\n\n第二行五个字符串表示该玩家手中的手牌。每一个字符串的第一个字符表示花色，其余字符表示牌的大小。", "outputFormat": "共 $N$ 行，每行一个字符串和一个数字，中间用空格隔开。表示一名玩家和他的最终得分。\n\n请按照玩家名称的输入顺序输出。", "hint": "样例一解释：\n\n第一局玩家牌型如下：\n\n${\\rm CYJian}$：炸弹\n\n${\\rm JerryC}$：牛五\n\n${\\rm Justin}$：铁板牛牛\n\n所以 ${\\rm CYJian}$ 加 $200$ 分，${\\rm JerryC}$ 扣 $160$ 分，${\\rm Justin}$ 扣 $40$ 分。\n\n第二局中，所有人都是牛五，但是 ${\\rm CYJian}$ 拥有黑桃五，${\\rm JerryC}$ 拥有红桃五，${\\rm Justin}$ 拥有梅花五，所以 ${\\rm CYJian}$ 加 $20$ 分，${\\rm JerryC}$ 没有变化，${\\rm Justin}$ 扣 $20$ 分。\n\n数据范围：\n\n| 测试点编号 |   $T$    |   $N$   | 特殊性质 |\n| :--------: | :------: | :-----: | :------: |\n|    $1$     |   $0$    |   $3$   |    性质 4    |\n|    $2$     |   $5$   |  $5$   |    性质 4    |\n|  $3$-$4$   |   $5$   |  $5$   |  性质 1   |\n|  $5$-$6$   |   $5$   |  $5$   |  性质 2   |\n|  $7$-$8$   |   $5$   |  $5$   |  性质 3   |\n|  $9$-$10$  |   $5$   |  $5$   |  性质 5   |\n| $11$-$12$  |   $10$    |   $10$   |  性质 5   |\n| $13$-$14$  |   $100$   |  $100$   |  性质 5   |\n| $15$-$16$  |  $1000$   |  $1000$  |  性质 5   |\n| $17$-$18$  |  $10000$  | $10000$  |  性质 5   |\n| $19$-$20$  | $100000$ | $100000$ |  性质 5，1.5s   |\n\n性质 1：保证所有的人拥有炸弹。\n\n性质 2：保证每一手牌花色全部相同。\n\n性质 3：保证每一手牌所有数字不同。\n\n性质 4：保证数据手造。\n\n性质 5：保证数据随机生成。\n\n保证每一局没有重复的牌。\n\n保证每一个人的名字不相同。\n\n保证出题人是 ${\\rm CYJian}$。\n\n保证数据没有锅。\n\n不保证没有人能做出来。\n\n不保证此题代码很长。", "locale": "zh-CN"}}}
{"pid": "P5014", "type": "P", "difficulty": 6, "samples": [["3\n1 3 6\n", "1\n2\n6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "组合数学", "Catalan 数"], "title": "水の三角(修改版)", "background": "这个三角图真好看。。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3xer0cul.png)\n\n这个是 ${\\rm 4}$ 阶三角图。。", "description": "现在我们定义一个三角图是像上面一样的图。\n\n请求出一个无限大的三角图从 $1$ 号点走到 $u$ 号点的方案数。\n\n有 $T$ 组询问。", "inputFormat": "第一行一个正整数 $T$。\n\n第二行 $T$ 个正整数 $u_i$。", "outputFormat": "$T$ 行，共 $T$ 个正整数，表示答案模 $998244353$ 的结果。", "hint": "${\\rm Subtask 1(10\\ pts)}$:$1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 55$\n\n${\\rm Subtask 2(20\\ pts)}$:$1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 12502500$\n\n${\\rm Subtask 3(30\\ pts)}$:$1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 500000500000 \\qquad u_i=\\frac{x \\times (x + 1)}{2}$\n\n${\\rm Subtask 4(40\\ pts)}$:$1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 500000500000$", "locale": "zh-CN", "translations": {"en": {"title": "Water Triangle (Modified Version)", "background": "This triangular diagram looks really nice.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3xer0cul.png)\n\nThis is a ${\\rm 4}$-order triangular diagram.", "description": "Now we define a triangular diagram as shown above.\n\nPlease find the number of ways to walk from node $1$ to node $u$ in an infinitely large triangular diagram.\n\nThere are $T$ queries.", "inputFormat": "The first line contains a positive integer $T$.\n\nThe second line contains $T$ positive integers $u_i$.", "outputFormat": "Output $T$ lines, each containing a positive integer, which is the answer modulo $998244353$.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}$: $1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 55$.\n\n${\\rm Subtask\\ 2(20\\ pts)}$: $1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 12502500$.\n\n${\\rm Subtask\\ 3(30\\ pts)}$: $1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 500000500000, \\qquad u_i=\\frac{x \\times (x + 1)}{2}$.\n\n${\\rm Subtask\\ 4(40\\ pts)}$: $1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 500000500000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "水の三角(修改版)", "background": "这个三角图真好看。。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3xer0cul.png)\n\n这个是 ${\\rm 4}$ 阶三角图。。", "description": "现在我们定义一个三角图是像上面一样的图。\n\n请求出一个无限大的三角图从 $1$ 号点走到 $u$ 号点的方案数。\n\n有 $T$ 组询问。", "inputFormat": "第一行一个正整数 $T$。\n\n第二行 $T$ 个正整数 $u_i$。", "outputFormat": "$T$ 行，共 $T$ 个正整数，表示答案模 $998244353$ 的结果。", "hint": "${\\rm Subtask 1(10\\ pts)}$:$1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 55$\n\n${\\rm Subtask 2(20\\ pts)}$:$1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 12502500$\n\n${\\rm Subtask 3(30\\ pts)}$:$1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 500000500000 \\qquad u_i=\\frac{x \\times (x + 1)}{2}$\n\n${\\rm Subtask 4(40\\ pts)}$:$1 \\leq T \\leq 100, \\qquad 1 \\leq u_i \\leq 500000500000$", "locale": "zh-CN"}}}
{"pid": "P5015", "type": "P", "difficulty": 1, "samples": [["234 ", "3"], ["Ca 45 ", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "字符串", "2018", "NOIP 普及组"], "title": "[NOIP 2018 普及组] 标题统计", "background": "NOIP2018 普及组 T1", "description": "凯凯刚写了一篇美妙的作文，请问这篇作文的标题中有多少个字符？ 注意：标题中可能包含大、小写英文字母、数字字符、空格和换行符。统计标题字符数时，空格和换行符不计算在内。 ", "inputFormat": "输入文件只有一行，一个字符串 $s$。 ", "outputFormat": "输出文件只有一行，包含一个整数，即作文标题的字符数（不含空格和换行符）。 ", "hint": "**样例 1 说明**   \n\n标题中共有 3 个字符，这 3 个字符都是数字字符。   \n\n**样例 2 说明**\n\n标题中共有 $ 5$ 个字符，包括 $1$ 个大写英文字母， $1$ 个小写英文字母和 $2$ 个数字字符， 还有 $1$ 个空格。由于空格不计入结果中，故标题的有效字符数为 $4$ 个。 \n\n**数据规模与约定**\n\n规定 $|s|$ 表示字符串 $s$ 的长度（即字符串中的字符和空格数）。    \n对于 $40\\%$ 的数据，$1 ≤ |s| ≤ 5$，保证输入为数字字符及行末换行符。   \n对于 $80\\%$ 的数据，$1 ≤ |s| ≤ 5$，输入只可能包含大、小写英文字母、数字字符及行末换行符。   \n对于 $100\\%$ 的数据，$1 ≤ |s| ≤ 5$，输入可能包含大、小写英文字母、数字字符、空格和行末换行符。 ", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Junior] Title Statistics", "background": "NOIP 2018 Junior T1.", "description": "Kaikai has just written a wonderful essay. How many characters are there in the title of this essay? Note: The title may contain uppercase and lowercase English letters, digit characters, spaces, and newline characters. When counting the number of title characters, spaces and newline characters are not included.", "inputFormat": "The input file contains only one line: a string $s$.", "outputFormat": "The output file contains only one line, containing an integer, which is the number of characters in the essay title (excluding spaces and newline characters).", "hint": "**Sample 1 Explanation**\n\nThere are 3 characters in the title, and all 3 characters are digit characters.\n\n**Sample 2 Explanation**\n\nThere are $ 5$ characters in the title, including $1$ uppercase English letter, $1$ lowercase English letter, and $2$ digit characters, plus $1$ space. Since spaces are not counted in the result, the number of valid characters in the title is $4$.\n\n**Constraints**\n\nLet $|s|$ denote the length of the string $s$ (that is, the total number of characters and spaces in the string).  \nFor $40\\%$ of the testdata, $1 \\le |s| \\le 5$, and the input is guaranteed to be digit characters and the end-of-line newline character.  \nFor $80\\%$ of the testdata, $1 \\le |s| \\le 5$, and the input may only contain uppercase and lowercase English letters, digit characters, and the end-of-line newline character.  \nFor $100\\%$ of the testdata, $1 \\le |s| \\le 5$, and the input may contain uppercase and lowercase English letters, digit characters, spaces, and the end-of-line newline character.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 普及组] 标题统计", "background": "NOIP2018 普及组 T1", "description": "凯凯刚写了一篇美妙的作文，请问这篇作文的标题中有多少个字符？ 注意：标题中可能包含大、小写英文字母、数字字符、空格和换行符。统计标题字符数时，空格和换行符不计算在内。 ", "inputFormat": "输入文件只有一行，一个字符串 $s$。 ", "outputFormat": "输出文件只有一行，包含一个整数，即作文标题的字符数（不含空格和换行符）。 ", "hint": "**样例 1 说明**   \n\n标题中共有 3 个字符，这 3 个字符都是数字字符。   \n\n**样例 2 说明**\n\n标题中共有 $ 5$ 个字符，包括 $1$ 个大写英文字母， $1$ 个小写英文字母和 $2$ 个数字字符， 还有 $1$ 个空格。由于空格不计入结果中，故标题的有效字符数为 $4$ 个。 \n\n**数据规模与约定**\n\n规定 $|s|$ 表示字符串 $s$ 的长度（即字符串中的字符和空格数）。    \n对于 $40\\%$ 的数据，$1 ≤ |s| ≤ 5$，保证输入为数字字符及行末换行符。   \n对于 $80\\%$ 的数据，$1 ≤ |s| ≤ 5$，输入只可能包含大、小写英文字母、数字字符及行末换行符。   \n对于 $100\\%$ 的数据，$1 ≤ |s| ≤ 5$，输入可能包含大、小写英文字母、数字字符、空格和行末换行符。 ", "locale": "zh-CN"}}}
{"pid": "P5016", "type": "P", "difficulty": 2, "samples": [["6 \n2 3 2 3 2 3 \n4 6 5 2 ", "2"], ["6 \n1 1 1 1 1 16 \n5 4 1 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "2018", "NOIP 普及组", "枚举"], "title": "[NOIP 2018 普及组] 龙虎斗", "background": "NOIP2018 普及组 T2", "description": "轩轩和凯凯正在玩一款叫《龙虎斗》的游戏，游戏的棋盘是一条线段，线段上有 $n$ 个兵营（自左至右编号 $1 \\sim n$），相邻编号的兵营之间相隔 $1$ 厘米，即棋盘为长度为 $n-1$ 厘米的线段。$i$ 号兵营里有 $c_i$ 位工兵。下面图 1 为 $n=6$ 的示例： \n\n![](https://cdn.luogu.com.cn/upload/pic/43224.png)    \n\n轩轩在左侧，代表“龙”；凯凯在右侧，代表“虎”。 他们以 $m$ 号兵营作为分界， 靠左的工兵属于龙势力，靠右的工兵属于虎势力，而第 $m$ 号兵营中的工兵很纠结，他们不属于任何一方。    \n\n一个兵营的气势为：该兵营中的工兵数$ \\times $ 该兵营到 $m$ 号兵营的距离；参与游戏 一方的势力定义为：属于这一方所有兵营的气势之和。    \n下面图 2 为 $n = 6,m = 4$ 的示例，其中红色为龙方，黄色为虎方：\n\n![](https://cdn.luogu.com.cn/upload/pic/43225.png)  \n\n游戏过程中，某一刻天降神兵，共有 $s_1$ 位工兵突然出现在了 $p_1$ 号兵营。作为轩轩和凯凯的朋友，你知道如果龙虎双方气势差距太悬殊，轩轩和凯凯就不愿意继续玩下去了。为了让游戏继续，你需要选择一个兵营 $p_2$，并将你手里的 $s_2$ 位工兵全部派往 兵营 $p_2$，使得双方气势差距尽可能小。 \n\n 注意：你手中的工兵落在哪个兵营，就和该兵营中其他工兵有相同的势力归属（如果落在 $m$ 号兵营，则不属于任何势力）。", "inputFormat": "输入文件的第一行包含一个正整数$n$，代表兵营的数量。  \n\n接下来的一行包含 $n$ 个正整数，相邻两数之间以一个空格分隔，第 $i$ 个正整数代 表编号为 $i$ 的兵营中起始时的工兵数量 $c_i$。  \n\n接下来的一行包含四个正整数，相邻两数间以一个空格分隔，分别代表 $m,p_1,s_1,s_2$。", "outputFormat": "输出文件有一行，包含一个正整数，即 $p_2$，表示你选择的兵营编号。如果存在多个编号同时满足最优，取最小的编号。 ", "hint": "**样例 1 说明**   \n\n见问题描述中的图 2。   \n双方以 $m=4$ 号兵营分界，有 $s_1=5$ 位工兵突然出现在 $p_1=6$ 号兵营。 \n龙方的气势为：   \n$$2 \\times (4-1)+3 \\times (4-2)+2 \\times (4-3) = 14$$  \n虎方的气势为：   \n$$2 \\times  (5 - 4) + (3 + 5) \\times (6 - 4) = 18$$  \n当你将手中的 $s_2 = 2$ 位工兵派往 $p_2 = 2$ 号兵营时，龙方的气势变为： \n$$14 + 2 \\times  (4 - 2) = 18$$  \n此时双方气势相等。 \n  \n**样例 2 说明**   \n\n双方以 $m = 5$ 号兵营分界，有 $s_1 = 1$ 位工兵突然出现在 $p_1 = 4$ 号兵营。  \n龙方的气势为：   \n$$1 \\times  (5 - 1) + 1 \\times  (5 - 2) + 1 \\times  (5 - 3) + (1 + 1) \\times  (5 - 4) = 11$$  \n虎方的气势为：   \n$$16 \\times  (6 - 5) = 16$$    \n当你将手中的 $s_2 = 1$ 位工兵派往 $p_2 = 1$ 号兵营时，龙方的气势变为：    \n$$11 + 1 \\times  (5 - 1) = 15$$    \n此时可以使双方气势的差距最小。\n\n**数据规模与约定**    \n\n\n$1 < m < n$，$1 \\le p_1 \\le n$。   \n对于 $20\\%$ 的数据，$n = 3,m = 2, c_i = 1, s_1,s_2 ≤ 100$。    \n另有 $20\\%$ 的数据，$n ≤ 10, p_1 = m, c_i = 1, s_1,s_2 ≤ 100$。  \n对于 $60\\%$ 的数据，$n ≤ 100, c_i = 1, s_1,s_2 ≤ 100$。   \n对于 $80\\%$ 的数据，$n ≤ 100, c_i,s_1,s_2 ≤ 100$。  \n对于 $100\\%$ 的数据，$n≤10^5$,$c_i,s_1,s_2≤10^9$。 ", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Junior] Dragon-Tiger Battle", "background": "NOIP2018 Junior T2.", "description": "Xuanxuan and Kaikai are playing a game called *Dragon-Tiger Battle*. The game board is a line segment with $n$ barracks on it (numbered from left to right as $1 \\sim n$). The distance between two adjacent barracks is $1$ centimeter, so the board is a line segment of length $n-1$ centimeters. Barrack $i$ contains $c_i$ engineers. Figure 1 below shows an example with $n=6$:\n\n![](https://cdn.luogu.com.cn/upload/pic/43224.png)    \n\nXuanxuan is on the left, representing the “Dragon”; Kaikai is on the right, representing the “Tiger”. They take barrack $m$ as the boundary: engineers on the left belong to the Dragon side, engineers on the right belong to the Tiger side, and the engineers in barrack $m$ are undecided and do not belong to either side.\n\nThe momentum of a barrack is defined as: (number of engineers in the barrack) $ \\times $ (distance from the barrack to barrack $m$).  \nThe power of a side is defined as: the sum of the momentum of all barracks belonging to that side.  \nFigure 2 below shows an example with $n = 6, m = 4$, where red is the Dragon side and yellow is the Tiger side:\n\n![](https://cdn.luogu.com.cn/upload/pic/43225.png)  \n\nDuring the game, at some moment, reinforcements arrive from the sky: a total of $s_1$ engineers suddenly appear in barrack $p_1$. As a friend of Xuanxuan and Kaikai, you know that if the difference in power between the Dragon and Tiger becomes too large, they will not want to continue playing. To keep the game going, you need to choose a barrack $p_2$ and send all $s_2$ engineers in your hand to barrack $p_2$, so that the difference in power between the two sides is as small as possible.\n\nNote: The engineers you send will have the same side affiliation as the engineers already in that barrack (if they land in barrack $m$, they do not belong to any side).", "inputFormat": "The first line contains a positive integer $n$, representing the number of barracks.\n\nThe next line contains $n$ positive integers, separated by single spaces. The $i$-th positive integer represents the initial number of engineers $c_i$ in barrack $i$.\n\nThe next line contains four positive integers, separated by single spaces, representing $m, p_1, s_1, s_2$.", "outputFormat": "Output one line containing a positive integer, namely $p_2$, the index of the barrack you choose. If multiple indices achieve the optimal result at the same time, output the smallest index.", "hint": "**Explanation for Sample 1**\n\nSee Figure 2 in the problem description.  \nThe two sides are divided by barrack $m=4$. There are $s_1=5$ engineers that suddenly appear in barrack $p_1=6$.  \nThe Dragon side’s power is:  \n$$2 \\times (4-1)+3 \\times (4-2)+2 \\times (4-3) = 14$$  \nThe Tiger side’s power is:  \n$$2 \\times  (5 - 4) + (3 + 5) \\times (6 - 4) = 18$$  \nWhen you send your $s_2 = 2$ engineers to barrack $p_2 = 2$, the Dragon side’s power becomes:  \n$$14 + 2 \\times  (4 - 2) = 18$$  \nAt this time, the two sides have equal power.\n\n**Explanation for Sample 2**\n\nThe two sides are divided by barrack $m = 5$. There are $s_1 = 1$ engineers that suddenly appear in barrack $p_1 = 4$.  \nThe Dragon side’s power is:  \n$$1 \\times  (5 - 1) + 1 \\times  (5 - 2) + 1 \\times  (5 - 3) + (1 + 1) \\times  (5 - 4) = 11$$  \nThe Tiger side’s power is:  \n$$16 \\times  (6 - 5) = 16$$    \nWhen you send your $s_2 = 1$ engineers to barrack $p_2 = 1$, the Dragon side’s power becomes:  \n$$11 + 1 \\times  (5 - 1) = 15$$    \nAt this time, the difference in power between the two sides can be minimized.\n\n**Constraints**\n\n$1 < m < n$, $1 \\le p_1 \\le n$.  \nFor $20\\%$ of the testdata, $n = 3, m = 2, c_i = 1, s_1, s_2 ≤ 100$.  \nAnother $20\\%$ of the testdata has $n ≤ 10, p_1 = m, c_i = 1, s_1, s_2 ≤ 100$.  \nFor $60\\%$ of the testdata, $n ≤ 100, c_i = 1, s_1, s_2 ≤ 100$.  \nFor $80\\%$ of the testdata, $n ≤ 100, c_i, s_1, s_2 ≤ 100$.  \nFor $100\\%$ of the testdata, $n ≤ 10^5$, $c_i, s_1, s_2 ≤ 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 普及组] 龙虎斗", "background": "NOIP2018 普及组 T2", "description": "轩轩和凯凯正在玩一款叫《龙虎斗》的游戏，游戏的棋盘是一条线段，线段上有 $n$ 个兵营（自左至右编号 $1 \\sim n$），相邻编号的兵营之间相隔 $1$ 厘米，即棋盘为长度为 $n-1$ 厘米的线段。$i$ 号兵营里有 $c_i$ 位工兵。下面图 1 为 $n=6$ 的示例： \n\n![](https://cdn.luogu.com.cn/upload/pic/43224.png)    \n\n轩轩在左侧，代表“龙”；凯凯在右侧，代表“虎”。 他们以 $m$ 号兵营作为分界， 靠左的工兵属于龙势力，靠右的工兵属于虎势力，而第 $m$ 号兵营中的工兵很纠结，他们不属于任何一方。    \n\n一个兵营的气势为：该兵营中的工兵数$ \\times $ 该兵营到 $m$ 号兵营的距离；参与游戏 一方的势力定义为：属于这一方所有兵营的气势之和。    \n下面图 2 为 $n = 6,m = 4$ 的示例，其中红色为龙方，黄色为虎方：\n\n![](https://cdn.luogu.com.cn/upload/pic/43225.png)  \n\n游戏过程中，某一刻天降神兵，共有 $s_1$ 位工兵突然出现在了 $p_1$ 号兵营。作为轩轩和凯凯的朋友，你知道如果龙虎双方气势差距太悬殊，轩轩和凯凯就不愿意继续玩下去了。为了让游戏继续，你需要选择一个兵营 $p_2$，并将你手里的 $s_2$ 位工兵全部派往 兵营 $p_2$，使得双方气势差距尽可能小。 \n\n 注意：你手中的工兵落在哪个兵营，就和该兵营中其他工兵有相同的势力归属（如果落在 $m$ 号兵营，则不属于任何势力）。", "inputFormat": "输入文件的第一行包含一个正整数$n$，代表兵营的数量。  \n\n接下来的一行包含 $n$ 个正整数，相邻两数之间以一个空格分隔，第 $i$ 个正整数代 表编号为 $i$ 的兵营中起始时的工兵数量 $c_i$。  \n\n接下来的一行包含四个正整数，相邻两数间以一个空格分隔，分别代表 $m,p_1,s_1,s_2$。", "outputFormat": "输出文件有一行，包含一个正整数，即 $p_2$，表示你选择的兵营编号。如果存在多个编号同时满足最优，取最小的编号。 ", "hint": "**样例 1 说明**   \n\n见问题描述中的图 2。   \n双方以 $m=4$ 号兵营分界，有 $s_1=5$ 位工兵突然出现在 $p_1=6$ 号兵营。 \n龙方的气势为：   \n$$2 \\times (4-1)+3 \\times (4-2)+2 \\times (4-3) = 14$$  \n虎方的气势为：   \n$$2 \\times  (5 - 4) + (3 + 5) \\times (6 - 4) = 18$$  \n当你将手中的 $s_2 = 2$ 位工兵派往 $p_2 = 2$ 号兵营时，龙方的气势变为： \n$$14 + 2 \\times  (4 - 2) = 18$$  \n此时双方气势相等。 \n  \n**样例 2 说明**   \n\n双方以 $m = 5$ 号兵营分界，有 $s_1 = 1$ 位工兵突然出现在 $p_1 = 4$ 号兵营。  \n龙方的气势为：   \n$$1 \\times  (5 - 1) + 1 \\times  (5 - 2) + 1 \\times  (5 - 3) + (1 + 1) \\times  (5 - 4) = 11$$  \n虎方的气势为：   \n$$16 \\times  (6 - 5) = 16$$    \n当你将手中的 $s_2 = 1$ 位工兵派往 $p_2 = 1$ 号兵营时，龙方的气势变为：    \n$$11 + 1 \\times  (5 - 1) = 15$$    \n此时可以使双方气势的差距最小。\n\n**数据规模与约定**    \n\n\n$1 < m < n$，$1 \\le p_1 \\le n$。   \n对于 $20\\%$ 的数据，$n = 3,m = 2, c_i = 1, s_1,s_2 ≤ 100$。    \n另有 $20\\%$ 的数据，$n ≤ 10, p_1 = m, c_i = 1, s_1,s_2 ≤ 100$。  \n对于 $60\\%$ 的数据，$n ≤ 100, c_i = 1, s_1,s_2 ≤ 100$。   \n对于 $80\\%$ 的数据，$n ≤ 100, c_i,s_1,s_2 ≤ 100$。  \n对于 $100\\%$ 的数据，$n≤10^5$,$c_i,s_1,s_2≤10^9$。 ", "locale": "zh-CN"}}}
{"pid": "P5017", "type": "P", "difficulty": 5, "samples": [["5 1 \n3 4 4 3 5 ", "0"], ["5 5 \n11 13 1 5 5 ", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2018", "NOIP 普及组", "斜率优化", "前缀和"], "title": "[NOIP 2018 普及组] 摆渡车", "background": "NOIP2018 普及组 T3", "description": "有 $n$ 名同学要乘坐摆渡车从人大附中前往人民大学，第 $i$ 位同学在第 $t_i$ 分钟去 等车。只有一辆摆渡车在工作，但摆渡车容量可以视为无限大。摆渡车从人大附中出发、 把车上的同学送到人民大学、再回到人大附中（去接其他同学），这样往返一趟总共花费 $m$ 分钟（同学上下车时间忽略不计）。摆渡车要将所有同学都送到人民大学。  \n\n凯凯很好奇，如果他能任意安排摆渡车出发的时间，那么这些同学的等车时间之和最小为多少呢？    \n\n注意：摆渡车回到人大附中后可以即刻出发。", "inputFormat": "第一行包含两个正整数 $n, m$，以一个空格分开，分别代表等车人数和摆渡车往返一趟的时间。    \n第二行包含 $n$ 个正整数，相邻两数之间以一个空格分隔，第 $i$ 个非负整数 $t_i$ 代表第 $i$ 个同学到达车站的时刻。 ", "outputFormat": "输出一行，一个整数，表示所有同学等车时间之和的最小值（单位：分钟）。 ", "hint": "**样例 1 说明**    \n\n同学 $1$ 和同学 $4$ 在第 $3$ 分钟开始等车，等待 $0$ 分钟，在第 $3$ 分钟乘坐摆渡车出发。摆渡车在第 $4$ 分钟回到人大附中。   \n同学 $2$ 和同学 $3$ 在第 $4$ 分钟开始等车，等待 $0$ 分钟，在第 $4$ 分钟乘坐摆渡车 出发。摆渡车在第 $5$ 分钟回到人大附中。   \n同学 $5$ 在第 $5$ 分钟开始等车，等待 $0$ 分钟，在第 $5$ 分钟乘坐摆渡车出发。自此 所有同学都被送到人民大学。总等待时间为 $0$。\n\n**样例 2 说明**  \n\n同学 $3$ 在第 $1$ 分钟开始等车，等待 $0$ 分钟，在第 $1$ 分钟乘坐摆渡车出发。摆渡 车在第 $6$ 分钟回到人大附中。   \n同学 $4$ 和同学 $5$ 在第 $5$ 分钟开始等车，等待 $1$ 分钟，在第 $6$ 分钟乘坐摆渡车 出发。摆渡车在第 $11$ 分钟回到人大附中。   \n同学 $1$ 在第 $11$ 分钟开始等车，等待 $2$ 分钟；同学 $2$ 在第 $13$ 分钟开始等车， 等待 $0$ 分钟。他/她们在第 $13$ 分钟乘坐摆渡车出发。自此所有同学都被送到人民大学。 总等待时间为 $4$。  \n可以证明，没有总等待时间小于 $4$ 的方案。 \n\n**数据规模与约定**\n\n对于 $10\\%$ 的数据，$n ≤ 10$，$m = 1$，$0 ≤ t_i ≤ 100$。   \n对于 $30\\%$ 的数据，$n ≤ 20$，$m ≤ 2$，$0 ≤ t_i ≤ 100$。  \n对于 $50\\%$ 的数据，$n ≤ 500$，$m ≤ 100$，$0 ≤ t_i ≤ 10^4$。  \n另有 $20\\%$ 的数据，$n ≤ 500$，$m ≤ 10$，$0 ≤ t_i ≤ 4 \\times  10^6$。  \n对于 $100\\%$ 的数据，$n ≤ 500$，$m ≤ 100$，$0 ≤ t_i ≤ 4 \\times 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Junior] Ferry Shuttle", "background": "NOIP 2018 Junior Group T3.", "description": "There are $n$ students who need to take a ferry shuttle from RDFZ (Renmin University Affiliated High School) to Renmin University. The $i$-th student goes to wait for the shuttle at minute $t_i$. Only one shuttle is in service, but its capacity can be considered unlimited. The shuttle departs from RDFZ, takes the students on board to Renmin University, and then returns to RDFZ (to pick up other students). One round trip takes a total of $m$ minutes (ignore the time for getting on and off). The shuttle must deliver all students to Renmin University.\n\nKaikai is curious: if he can arrange the shuttle’s departure times arbitrarily, what is the minimum possible sum of all students’ waiting times?\n\nNote: after the shuttle returns to RDFZ, it can depart again immediately.", "inputFormat": "The first line contains two positive integers $n, m$, separated by a space, representing the number of waiting students and the time for one round trip of the shuttle.\n\nThe second line contains $n$ positive integers, separated by spaces. The $i$-th non-negative integer $t_i$ represents the time when the $i$-th student arrives at the station.", "outputFormat": "Output one line with one integer, representing the minimum possible sum of all students’ waiting times (in minutes).", "hint": "**Explanation of Sample 1**\n\nStudents $1$ and $4$ start waiting at minute $3$, wait $0$ minutes, and depart on the shuttle at minute $3$. The shuttle returns to RDFZ at minute $4$.\n\nStudents $2$ and $3$ start waiting at minute $4$, wait $0$ minutes, and depart on the shuttle at minute $4$. The shuttle returns to RDFZ at minute $5$.\n\nStudent $5$ starts waiting at minute $5$, waits $0$ minutes, and departs on the shuttle at minute $5$. From then on, all students have been delivered to Renmin University. The total waiting time is $0$.\n\n**Explanation of Sample 2**\n\nStudent $3$ starts waiting at minute $1$, waits $0$ minutes, and departs on the shuttle at minute $1$. The shuttle returns to RDFZ at minute $6$.\n\nStudents $4$ and $5$ start waiting at minute $5$, wait $1$ minute, and depart on the shuttle at minute $6$. The shuttle returns to RDFZ at minute $11$.\n\nStudent $1$ starts waiting at minute $11$ and waits $2$ minutes; student $2$ starts waiting at minute $13$ and waits $0$ minutes. They depart on the shuttle at minute $13$. From then on, all students have been delivered to Renmin University. The total waiting time is $4$.\n\nIt can be proven that there is no plan with total waiting time less than $4$.\n\n**Constraints**\n\nFor $10\\%$ of the testdata, $n \\le 10$, $m = 1$, $0 \\le t_i \\le 100$.\n\nFor $30\\%$ of the testdata, $n \\le 20$, $m \\le 2$, $0 \\le t_i \\le 100$.\n\nFor $50\\%$ of the testdata, $n \\le 500$, $m \\le 100$, $0 \\le t_i \\le 10^4$.\n\nFor another $20\\%$ of the testdata, $n \\le 500$, $m \\le 10$, $0 \\le t_i \\le 4 \\times  10^6$.\n\nFor $100\\%$ of the testdata, $n \\le 500$, $m \\le 100$, $0 \\le t_i \\le 4 \\times 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 普及组] 摆渡车", "background": "NOIP2018 普及组 T3", "description": "有 $n$ 名同学要乘坐摆渡车从人大附中前往人民大学，第 $i$ 位同学在第 $t_i$ 分钟去 等车。只有一辆摆渡车在工作，但摆渡车容量可以视为无限大。摆渡车从人大附中出发、 把车上的同学送到人民大学、再回到人大附中（去接其他同学），这样往返一趟总共花费 $m$ 分钟（同学上下车时间忽略不计）。摆渡车要将所有同学都送到人民大学。  \n\n凯凯很好奇，如果他能任意安排摆渡车出发的时间，那么这些同学的等车时间之和最小为多少呢？    \n\n注意：摆渡车回到人大附中后可以即刻出发。", "inputFormat": "第一行包含两个正整数 $n, m$，以一个空格分开，分别代表等车人数和摆渡车往返一趟的时间。    \n第二行包含 $n$ 个正整数，相邻两数之间以一个空格分隔，第 $i$ 个非负整数 $t_i$ 代表第 $i$ 个同学到达车站的时刻。 ", "outputFormat": "输出一行，一个整数，表示所有同学等车时间之和的最小值（单位：分钟）。 ", "hint": "**样例 1 说明**    \n\n同学 $1$ 和同学 $4$ 在第 $3$ 分钟开始等车，等待 $0$ 分钟，在第 $3$ 分钟乘坐摆渡车出发。摆渡车在第 $4$ 分钟回到人大附中。   \n同学 $2$ 和同学 $3$ 在第 $4$ 分钟开始等车，等待 $0$ 分钟，在第 $4$ 分钟乘坐摆渡车 出发。摆渡车在第 $5$ 分钟回到人大附中。   \n同学 $5$ 在第 $5$ 分钟开始等车，等待 $0$ 分钟，在第 $5$ 分钟乘坐摆渡车出发。自此 所有同学都被送到人民大学。总等待时间为 $0$。\n\n**样例 2 说明**  \n\n同学 $3$ 在第 $1$ 分钟开始等车，等待 $0$ 分钟，在第 $1$ 分钟乘坐摆渡车出发。摆渡 车在第 $6$ 分钟回到人大附中。   \n同学 $4$ 和同学 $5$ 在第 $5$ 分钟开始等车，等待 $1$ 分钟，在第 $6$ 分钟乘坐摆渡车 出发。摆渡车在第 $11$ 分钟回到人大附中。   \n同学 $1$ 在第 $11$ 分钟开始等车，等待 $2$ 分钟；同学 $2$ 在第 $13$ 分钟开始等车， 等待 $0$ 分钟。他/她们在第 $13$ 分钟乘坐摆渡车出发。自此所有同学都被送到人民大学。 总等待时间为 $4$。  \n可以证明，没有总等待时间小于 $4$ 的方案。 \n\n**数据规模与约定**\n\n对于 $10\\%$ 的数据，$n ≤ 10$，$m = 1$，$0 ≤ t_i ≤ 100$。   \n对于 $30\\%$ 的数据，$n ≤ 20$，$m ≤ 2$，$0 ≤ t_i ≤ 100$。  \n对于 $50\\%$ 的数据，$n ≤ 500$，$m ≤ 100$，$0 ≤ t_i ≤ 10^4$。  \n另有 $20\\%$ 的数据，$n ≤ 500$，$m ≤ 10$，$0 ≤ t_i ≤ 4 \\times  10^6$。  \n对于 $100\\%$ 的数据，$n ≤ 500$，$m ≤ 100$，$0 ≤ t_i ≤ 4 \\times 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5018", "type": "P", "difficulty": 4, "samples": [["2 \n1 3 \n2 -1 \n-1 -1 \n", "1"], ["10 \n2 2 5 5 5 5 4 4 2 3 \n9 10 \n-1 -1 \n-1 -1 \n-1 -1 \n-1 -1 \n-1 2 \n3 4 \n5 6 \n-1 -1 \n7 8", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["树形数据结构", "2018", "NOIP 普及组", "哈希 hashing"], "title": "[NOIP 2018 普及组] 对称二叉树", "background": "NOIP2018 普及组 T4", "description": "一棵有点权的有根树如果满足以下条件，则被轩轩称为对称二叉树： \n\n1.  二叉树； \n2.  将这棵树所有节点的左右子树交换，新树和原树对应位置的结构相同且点权相等。   \n\n下图中节点内的数字为权值，节点外的 $id$ 表示节点编号。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nkln7z1l.png)\n\n现在给出一棵二叉树，希望你找出它的一棵子树，该子树为对称二叉树，且节点数最多。请输出这棵子树的节点数。   \n\n注意：只有树根的树也是对称二叉树。本题中约定，以节点 $T$ 为子树根的一棵“子 树”指的是：节点$T$ 和它的全部后代节点构成的二叉树。 ", "inputFormat": "第一行一个正整数 $n$，表示给定的树的节点的数目，规定节点编号 $1 \\sim n$，其中节点 $1$ 是树根。 \n\n第二行 $n$ 个正整数，用一个空格分隔，第 $i$ 个正整数 $v_i$ 代表节点 $i$ 的权值。 \n\n接下来 $n$ 行，每行两个正整数 $l_i, r_i$，分别表示节点 $i$ 的左右孩子的编号。如果不存在左 / 右孩子，则以 $-1$ 表示。两个数之间用一个空格隔开。 ", "outputFormat": "输出文件共一行，包含一个整数，表示给定的树的最大对称二叉子树的节点数。 ", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4lfen5aa.png)    \n最大的对称二叉子树为以节点 $2$ 为树根的子树，节点数为 $1$。   \n\n**样例 2 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vhzzc587.png)\n\n最大的对称二叉子树为以节点 $7$ 为树根的子树，节点数为 $3$。 \n\n**数据规模与约定**\n\n共 $25$ 个测试点。    \n\n$v_i ≤ 1000$。 \n\n- 测试点 $1 \\sim 3, n ≤ 10$，保证根结点的左子树的所有节点都没有右孩子，根结点的右 子树的所有节点都没有左孩子。 \n- 测试点 $4 \\sim 8, n ≤ 10$。\n- 测试点 $9 \\sim 12, n ≤ 10^5$，保证输入是一棵“满二叉树” 。 \n- 测试点 $13 \\sim 16, n ≤ 10^5$，保证输入是一棵“完全二叉树”。\n- 测试点 $17 \\sim 20, n ≤ 10^5$，保证输入的树的点权均为 $1$。\n- 测试点 $21 \\sim 25, n ≤ 10^6$。\n\n本题约定： \n\n层次：节点的层次从根开始定义起，根为第一层，根的孩子为第二层。树中任一节 点的层次等于其父亲节点的层次加 $1$。 \n \n 树的深度：树中节点的最大层次称为树的深度。 \n \n 满二叉树：设二叉树的深度为 $h$，且二叉树有 $2^h-1$ 个节点，这就是满二叉树。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8tof1fxx.png)\n\n完全二叉树：设二叉树的深度为 $h$，除第 $h$ 层外，其它各层的结点数都达到最大 个数，第 $h$ 层所有的结点都连续集中在最左边，这就是完全二叉树。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ibo7js1f.png)", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Junior] Symmetric Binary Tree", "background": "NOIP 2018 Junior Group T4.", "description": "A rooted tree with node weights is called a symmetric binary tree by Xuanxuan if it satisfies the following conditions:\n\n1. It is a binary tree.\n2. If we swap the left and right subtrees of every node in the tree, then in the new tree and the original tree, the structures at corresponding positions are the same and the node weights are equal.\n\nIn the figure below, the number inside each node is the weight, and the $id$ outside each node indicates the node index.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nkln7z1l.png)\n\nNow you are given a binary tree. You need to find a subtree that is a symmetric binary tree and has the maximum number of nodes. Output the number of nodes in that subtree.\n\nNote: A tree with only the root is also a symmetric binary tree. In this problem, a “subtree” rooted at node $T$ means the binary tree formed by node $T$ and all of its descendants.", "inputFormat": "The first line contains a positive integer $n$, representing the number of nodes in the given tree. The node indices are $1 \\sim n$, and node $1$ is the root.\n\nThe second line contains $n$ positive integers separated by spaces. The $i$-th positive integer $v_i$ represents the weight of node $i$.\n\nThe next $n$ lines each contain two integers $l_i, r_i$, representing the indices of the left and right children of node $i$, respectively. If the left/right child does not exist, it is represented by $-1$. The two numbers are separated by a space.", "outputFormat": "Output one line containing an integer, representing the maximum number of nodes among all symmetric binary subtrees of the given tree.", "hint": "**Sample 1 Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4lfen5aa.png)  \nThe largest symmetric binary subtree is the subtree rooted at node $2$, and the number of nodes is $1$.\n\n**Sample 2 Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vhzzc587.png)\n\nThe largest symmetric binary subtree is the subtree rooted at node $7$, and the number of nodes is $3$.\n\n**Constraints**\n\nThere are $25$ test points in total.\n\n$v_i \\le 1000$.\n\n- Test points $1 \\sim 3$, $n \\le 10$. It is guaranteed that all nodes in the left subtree of the root have no right child, and all nodes in the right subtree of the root have no left child.\n- Test points $4 \\sim 8$, $n \\le 10$.\n- Test points $9 \\sim 12$, $n \\le 10^5$. It is guaranteed that the input is a “full binary tree”.\n- Test points $13 \\sim 16$, $n \\le 10^5$. It is guaranteed that the input is a “complete binary tree”.\n- Test points $17 \\sim 20$, $n \\le 10^5$. It is guaranteed that all node weights in the input tree are $1$.\n- Test points $21 \\sim 25$, $n \\le 10^6$.\n\nIn this problem, the following definitions apply:\n\nLevel: The level of nodes starts from the root. The root is on level 1, and the children of the root are on level 2. The level of any node in the tree equals the level of its parent node plus $1$.\n\nDepth of a tree: The maximum level of nodes in the tree is called the depth of the tree.\n\nFull binary tree: Suppose the depth of a binary tree is $h$, and the binary tree has $2^h - 1$ nodes. Then it is a full binary tree.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8tof1fxx.png)\n\nComplete binary tree: Suppose the depth of a binary tree is $h$. Except for level $h$, the number of nodes on all other levels reaches the maximum. All nodes on level $h$ are continuously packed to the far left. Then it is a complete binary tree.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ibo7js1f.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 普及组] 对称二叉树", "background": "NOIP2018 普及组 T4", "description": "一棵有点权的有根树如果满足以下条件，则被轩轩称为对称二叉树： \n\n1.  二叉树； \n2.  将这棵树所有节点的左右子树交换，新树和原树对应位置的结构相同且点权相等。   \n\n下图中节点内的数字为权值，节点外的 $id$ 表示节点编号。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nkln7z1l.png)\n\n现在给出一棵二叉树，希望你找出它的一棵子树，该子树为对称二叉树，且节点数最多。请输出这棵子树的节点数。   \n\n注意：只有树根的树也是对称二叉树。本题中约定，以节点 $T$ 为子树根的一棵“子 树”指的是：节点$T$ 和它的全部后代节点构成的二叉树。 ", "inputFormat": "第一行一个正整数 $n$，表示给定的树的节点的数目，规定节点编号 $1 \\sim n$，其中节点 $1$ 是树根。 \n\n第二行 $n$ 个正整数，用一个空格分隔，第 $i$ 个正整数 $v_i$ 代表节点 $i$ 的权值。 \n\n接下来 $n$ 行，每行两个正整数 $l_i, r_i$，分别表示节点 $i$ 的左右孩子的编号。如果不存在左 / 右孩子，则以 $-1$ 表示。两个数之间用一个空格隔开。 ", "outputFormat": "输出文件共一行，包含一个整数，表示给定的树的最大对称二叉子树的节点数。 ", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4lfen5aa.png)    \n最大的对称二叉子树为以节点 $2$ 为树根的子树，节点数为 $1$。   \n\n**样例 2 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vhzzc587.png)\n\n最大的对称二叉子树为以节点 $7$ 为树根的子树，节点数为 $3$。 \n\n**数据规模与约定**\n\n共 $25$ 个测试点。    \n\n$v_i ≤ 1000$。 \n\n- 测试点 $1 \\sim 3, n ≤ 10$，保证根结点的左子树的所有节点都没有右孩子，根结点的右 子树的所有节点都没有左孩子。 \n- 测试点 $4 \\sim 8, n ≤ 10$。\n- 测试点 $9 \\sim 12, n ≤ 10^5$，保证输入是一棵“满二叉树” 。 \n- 测试点 $13 \\sim 16, n ≤ 10^5$，保证输入是一棵“完全二叉树”。\n- 测试点 $17 \\sim 20, n ≤ 10^5$，保证输入的树的点权均为 $1$。\n- 测试点 $21 \\sim 25, n ≤ 10^6$。\n\n本题约定： \n\n层次：节点的层次从根开始定义起，根为第一层，根的孩子为第二层。树中任一节 点的层次等于其父亲节点的层次加 $1$。 \n \n 树的深度：树中节点的最大层次称为树的深度。 \n \n 满二叉树：设二叉树的深度为 $h$，且二叉树有 $2^h-1$ 个节点，这就是满二叉树。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8tof1fxx.png)\n\n完全二叉树：设二叉树的深度为 $h$，除第 $h$ 层外，其它各层的结点数都达到最大 个数，第 $h$ 层所有的结点都连续集中在最左边，这就是完全二叉树。  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ibo7js1f.png)", "locale": "zh-CN"}}}
{"pid": "P5019", "type": "P", "difficulty": 3, "samples": [["6   \n4 3 2 5 3 5 \n", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2018", "NOIP 提高组", "差分"], "title": "[NOIP 2018 提高组] 铺设道路", "background": "NOIP2018 提高组 D1T1", "description": "春春是一名道路工程师，负责铺设一条长度为 $n$ 的道路。 \n\n铺设道路的主要工作是填平下陷的地表。整段道路可以看作是 $n$ 块首尾相连的区域，一开始，第 $i$ 块区域下陷的深度为 $d_i$ 。 \n\n春春每天可以选择一段连续区间 $[L,R]$ ，填充这段区间中的每块区域，让其下陷深度减少 $1$。在选择区间时，需要保证，区间内的每块区域在填充前下陷深度均不为 $0$ 。 \n\n春春希望你能帮他设计一种方案，可以在最短的时间内将整段道路的下陷深度都变为 $0$ 。 ", "inputFormat": "输入文件包含两行，第一行包含一个整数 $n$，表示道路的长度。 第二行包含 $n$ 个整数，相邻两数间用一个空格隔开，第 $i$ 个整数为 $d_i$ 。 ", "outputFormat": "输出文件仅包含一个整数，即最少需要多少天才能完成任务。 ", "hint": "【样例解释】\n\n一种可行的最佳方案是，依次选择： \n$[1,6]$、$[1,6]$、$[1,2]$、$[1,1]$、$[4,6]$、$[4,4]$、$[4,4]$、$[6,6]$、$[6,6]$。   \n\n【数据规模与约定】\n\n对于 $30\\%$ 的数据，$1 ≤ n ≤ 10$ ；    \n对于 $70\\%$ 的数据，$1 ≤ n ≤ 1000$ ；     \n对于 $100\\%$ 的数据，$1 ≤ n ≤ 100000 , 0 ≤ d_i ≤ 10000$ 。   ", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Senior] Road Paving.", "background": "NOIP 2018 Senior D1T1.", "description": "Chunchun is a road engineer responsible for paving a road of length $n$.\n\nThe main task of paving is to fill the sunken ground surface. The whole road can be seen as $n$ consecutive segments connected end to end. Initially, the sinking depth of the $i$-th segment is $d_i$.\n\nEach day, Chunchun can choose a continuous interval $[L,R]$ and fill every segment in this interval, reducing its sinking depth by $1$. When choosing an interval, it must be guaranteed that, before filling, the sinking depth of every segment in the interval is not $0$.\n\nChunchun wants you to help design a plan that turns the sinking depths of the entire road into $0$ in the shortest time.", "inputFormat": "The input file contains two lines. The first line contains an integer $n$, representing the length of the road. The second line contains $n$ integers separated by a single space; the $i$-th integer is $d_i$.", "outputFormat": "The output file contains only one integer, which is the minimum number of days needed to complete the task.", "hint": "【Sample Explanation】\n\nOne possible optimal plan is to choose, in order:\n$[1,6]$, $[1,6]$, $[1,2]$, $[1,1]$, $[4,6]$, $[4,4]$, $[4,4]$, $[6,6]$, $[6,6]$.\n\n【Constraints】\n\nFor $30\\%$ of the testdata, $1 \\le n \\le 10$.\nFor $70\\%$ of the testdata, $1 \\le n \\le 1000$.\nFor $100\\%$ of the testdata, $1 \\le n \\le 100000$, $0 \\le d_i \\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 提高组] 铺设道路", "background": "NOIP2018 提高组 D1T1", "description": "春春是一名道路工程师，负责铺设一条长度为 $n$ 的道路。 \n\n铺设道路的主要工作是填平下陷的地表。整段道路可以看作是 $n$ 块首尾相连的区域，一开始，第 $i$ 块区域下陷的深度为 $d_i$ 。 \n\n春春每天可以选择一段连续区间 $[L,R]$ ，填充这段区间中的每块区域，让其下陷深度减少 $1$。在选择区间时，需要保证，区间内的每块区域在填充前下陷深度均不为 $0$ 。 \n\n春春希望你能帮他设计一种方案，可以在最短的时间内将整段道路的下陷深度都变为 $0$ 。 ", "inputFormat": "输入文件包含两行，第一行包含一个整数 $n$，表示道路的长度。 第二行包含 $n$ 个整数，相邻两数间用一个空格隔开，第 $i$ 个整数为 $d_i$ 。 ", "outputFormat": "输出文件仅包含一个整数，即最少需要多少天才能完成任务。 ", "hint": "【样例解释】\n\n一种可行的最佳方案是，依次选择： \n$[1,6]$、$[1,6]$、$[1,2]$、$[1,1]$、$[4,6]$、$[4,4]$、$[4,4]$、$[6,6]$、$[6,6]$。   \n\n【数据规模与约定】\n\n对于 $30\\%$ 的数据，$1 ≤ n ≤ 10$ ；    \n对于 $70\\%$ 的数据，$1 ≤ n ≤ 1000$ ；     \n对于 $100\\%$ 的数据，$1 ≤ n ≤ 100000 , 0 ≤ d_i ≤ 10000$ 。   ", "locale": "zh-CN"}}}
{"pid": "P5020", "type": "P", "difficulty": 4, "samples": [["2\n4\n3 19 10 6\n5\n11 29 13 19 17", "2\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "贪心", "2018", "NOIP 提高组", "背包 DP"], "title": "[NOIP 2018 提高组] 货币系统", "background": "NOIP2018 提高组 D1T2", "description": "在网友的国度中共有 $n$ 种不同面额的货币，第 $i$ 种货币的面额为 $a[i]$，你可以假设每一种货币都有无穷多张。为了方便，我们把货币种数为 $n$、面额数组为 $a[1..n]$ 的货币系统记作 $(n,a)$。 \n\n在一个完善的货币系统中，每一个非负整数的金额 $x$ 都应该可以被表示出，即对每一个非负整数 $x$，都存在 $n$ 个非负整数 $t[i]$ 满足 $a[i] \\times t[i]$ 的和为 $x$。然而， 在网友的国度中，货币系统可能是不完善的，即可能存在金额 $x$ 不能被该货币系统表示出。例如在货币系统 $n=3$, $a=[2,5,9]$ 中，金额 $1,3$ 就无法被表示出来。 \n\n两个货币系统 $(n,a)$ 和 $(m,b)$ 是等价的，当且仅当对于任意非负整数 $x$，它要么均可以被两个货币系统表出，要么不能被其中任何一个表出。 \n\n现在网友们打算简化一下货币系统。他们希望找到一个货币系统 $(m,b)$，满足 $(m,b)$ 与原来的货币系统 $(n,a)$ 等价，且 $m$ 尽可能的小。他们希望你来协助完成这个艰巨的任务：找到最小的 $m$。 ", "inputFormat": "输入文件的第一行包含一个整数 $T$，表示数据的组数。\n\n接下来按照如下格式分别给出 $T$ 组数据。 每组数据的第一行包含一个正整数 $n$。接下来一行包含 $n$ 个由空格隔开的正整数 $a[i]$。", "outputFormat": "输出文件共有 $T$ 行，对于每组数据，输出一行一个正整数，表示所有与 $(n,a)$ 等价的货币系统 $(m,b)$ 中，最小的 $m$。", "hint": "在第一组数据中，货币系统 $(2, [3,10])$ 和给出的货币系统 $(n, a)$ 等价，并可以验证不存在 $m < 2$ 的等价的货币系统，因此答案为 $2$。 在第二组数据中，可以验证不存在 $m < n$ 的等价的货币系统，因此答案为 $5$。 \n\n【数据范围与约定】\n\n![](https://cdn.luogu.com.cn/upload/pic/43160.png)  \n\n对于 $100\\%$ 的数据，满足 $1 ≤ T ≤ 20, n,a[i] ≥ 1$。 ", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Senior] Currency System", "background": "NOIP 2018 Senior D1T2.", "description": "In the netizens’ kingdom, there are $n$ different denominations of currency. The denomination of the $i$-th currency is $a[i]$. You may assume that there are infinitely many bills of each denomination. For convenience, we denote the currency system with $n$ types of currency and denomination array $a[1..n]$ as $(n,a)$.\n\nIn a perfect currency system, every non-negative integer amount $x$ should be representable. That is, for every non-negative integer $x$, there exist $n$ non-negative integers $t[i]$ such that the sum of $a[i] \\times t[i]$ equals $x$. However, in the netizens’ kingdom, the currency system may be imperfect, meaning there may exist an amount $x$ that cannot be represented by the system. For example, in the currency system $n=3$, $a=[2,5,9]$, the amounts $1,3$ cannot be represented.\n\nTwo currency systems $(n,a)$ and $(m,b)$ are equivalent if and only if, for any non-negative integer $x$, either $x$ can be represented by both systems, or $x$ cannot be represented by either of them.\n\nNow the netizens plan to simplify the currency system. They want to find a currency system $(m,b)$ such that $(m,b)$ is equivalent to the original currency system $(n,a)$, and $m$ is as small as possible. They hope you can help complete this difficult task: find the minimum $m$.", "inputFormat": "The first line of the input file contains an integer $T$, the number of test cases.\n\nThen $T$ test cases are given in the following format. The first line of each test case contains a positive integer $n$. The next line contains $n$ positive integers $a[i]$ separated by spaces.", "outputFormat": "The output file contains $T$ lines. For each test case, output one positive integer per line, representing the minimum $m$ among all currency systems $(m,b)$ that are equivalent to $(n,a)$.", "hint": "In the first test case, the currency system $(2, [3,10])$ is equivalent to the given currency system $(n, a)$. It can be verified that there is no equivalent currency system with $m < 2$, so the answer is $2$. In the second test case, it can be verified that there is no equivalent currency system with $m < n$, so the answer is $5$.\n\n【Constraints】\n\n![](https://cdn.luogu.com.cn/upload/pic/43160.png)\n\nFor $100\\%$ of the testdata, $1 \\le T \\le 20$, and $n,a[i] \\ge 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 提高组] 货币系统", "background": "NOIP2018 提高组 D1T2", "description": "在网友的国度中共有 $n$ 种不同面额的货币，第 $i$ 种货币的面额为 $a[i]$，你可以假设每一种货币都有无穷多张。为了方便，我们把货币种数为 $n$、面额数组为 $a[1..n]$ 的货币系统记作 $(n,a)$。 \n\n在一个完善的货币系统中，每一个非负整数的金额 $x$ 都应该可以被表示出，即对每一个非负整数 $x$，都存在 $n$ 个非负整数 $t[i]$ 满足 $a[i] \\times t[i]$ 的和为 $x$。然而， 在网友的国度中，货币系统可能是不完善的，即可能存在金额 $x$ 不能被该货币系统表示出。例如在货币系统 $n=3$, $a=[2,5,9]$ 中，金额 $1,3$ 就无法被表示出来。 \n\n两个货币系统 $(n,a)$ 和 $(m,b)$ 是等价的，当且仅当对于任意非负整数 $x$，它要么均可以被两个货币系统表出，要么不能被其中任何一个表出。 \n\n现在网友们打算简化一下货币系统。他们希望找到一个货币系统 $(m,b)$，满足 $(m,b)$ 与原来的货币系统 $(n,a)$ 等价，且 $m$ 尽可能的小。他们希望你来协助完成这个艰巨的任务：找到最小的 $m$。 ", "inputFormat": "输入文件的第一行包含一个整数 $T$，表示数据的组数。\n\n接下来按照如下格式分别给出 $T$ 组数据。 每组数据的第一行包含一个正整数 $n$。接下来一行包含 $n$ 个由空格隔开的正整数 $a[i]$。", "outputFormat": "输出文件共有 $T$ 行，对于每组数据，输出一行一个正整数，表示所有与 $(n,a)$ 等价的货币系统 $(m,b)$ 中，最小的 $m$。", "hint": "在第一组数据中，货币系统 $(2, [3,10])$ 和给出的货币系统 $(n, a)$ 等价，并可以验证不存在 $m < 2$ 的等价的货币系统，因此答案为 $2$。 在第二组数据中，可以验证不存在 $m < n$ 的等价的货币系统，因此答案为 $5$。 \n\n【数据范围与约定】\n\n![](https://cdn.luogu.com.cn/upload/pic/43160.png)  \n\n对于 $100\\%$ 的数据，满足 $1 ≤ T ≤ 20, n,a[i] ≥ 1$。 ", "locale": "zh-CN"}}}
{"pid": "P5021", "type": "P", "difficulty": 5, "samples": [["7 1 \n1 2 10 \n1 3 5 \n2 4 9 \n2 5 8 \n3 6 6 \n3 7 7", "31"], ["9 3 \n1 2 6 \n2 3 3 \n3 4 5 \n4 5 10 \n6 2 4 \n7 2 9 \n8 4 7 \n9 4 4", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2018", "二分", "NOIP 提高组", "最近公共祖先 LCA"], "title": "[NOIP 2018 提高组] 赛道修建", "background": "", "description": "C 城将要举办一系列的赛车比赛。在比赛前，需要在城内修建 $m$ 条赛道。 \n\nC 城一共有 $n$ 个路口，这些路口编号为 $1,2,…,n$，有 $n-1$ 条适合于修建赛道的双向通行的道路，每条道路连接着两个路口。其中，第 $i$ 条道路连接的两个路口编号为 $a_i$ 和 $b_i$，该道路的长度为 $l_i$。借助这 $n-1$ 条道路，从任何一个路口出发都能到达其他所有的路口。 \n\n一条赛道是一组互不相同的道路 $e_1,e_2,…,e_k$，满足可以从某个路口出发，依次经过 道路 $e_1,e_2,…,e_k$（每条道路经过一次，不允许调头）到达另一个路口。一条赛道的长度等于经过的各道路的长度之和。为保证安全，要求每条道路至多被一条赛道经过。 \n\n目前赛道修建的方案尚未确定。你的任务是设计一种赛道修建的方案，使得修建的 $m$ 条赛道中长度最小的赛道长度最大（即 $m$ 条赛道中最短赛道的长度尽可能大）", "inputFormat": "输入文件第一行包含两个由空格分隔的正整数 $n,m$，分别表示路口数及需要修建的 赛道数。 \n\n接下来 $n-1$ 行，第 $i$ 行包含三个正整数 $a_i,b_i,l_i$，表示第 $i$ 条适合于修建赛道的道 路连接的两个路口编号及道路长度。保证任意两个路口均可通过这 $n-1$ 条道路相互到达。每行中相邻两数之间均由一个空格分隔。 ", "outputFormat": "输出共一行，包含一个整数，表示长度最小的赛道长度的最大值。 ", "hint": "【输入输出样例 1 说明】 \n\n所有路口及适合于修建赛道的道路如下图所示：      \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bkj3pfqm.png)\n\n道路旁括号内的数字表示道路的编号，非括号内的数字表示道路长度。 需要修建 $1$ 条赛道。可以修建经过第 $3,1,2,6$ 条道路的赛道（从路口 $4$ 到路口 $7$）， 则该赛道的长度为 $9 + 10 + 5 + 7 = 31$，为所有方案中的最大值。\n\n【输入输出样例 2 说明】\n\n 所有路口及适合于修建赛道的道路如下图所示：   \n  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e9lcljwr.png)\n\n需要修建 $3$ 条赛道。可以修建如下 $3$ 条赛道： \n1. 经过第 $1,6 $条道路的赛道（从路口 $1$ 到路口$ 7$），长度为 $6 + 9 = 15$； \n2. 经过第$ 5,2,3,8$ 条道路的赛道（从路口$ 6$ 到路口 $9$），长度为 $4 + 3 + 5 + 4 = 16$；\n3. 经过第 $7,4$ 条道路的赛道（从路口 $8$ 到路口$ 5$），长度为 $7 + 10 = 17$。 长度最小的赛道长度为 $15$，为所有方案中的最大值。 \n\n### 数据规模与约定\n\n所有测试数据的范围和特点如下表所示 :\n\n| 测试点编号 | $n$ | $m$ | $a_i=1$ | $b_i=a_i+1$ | 分支不超过 $3$ |\n|:-:|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $\\le 5$ | $=1$ | 否 | 否 | 是 |\n| $2$ | $\\le 10$ | $\\le n-1$ | 否 | 是 | 是 |\n| $3$ | $\\le 15$ | $\\le n-1$ | 是 | 否 | 否 |\n| $4$ | $\\le 10^3$ | $=1$ | 否 | 否 | 是 |\n| $5$ | $\\le 3\\times 10^4$ | $=1$ | 是 | 否 | 否 |\n| $6$ | $\\le 3\\times 10^4$ | $=1$ | 否 | 否 | 否 |\n| $7$ | $\\le 3\\times 10^4$ | $\\le n-1$ | 是 | 否 | 否 |\n| $8$ | $\\le 5\\times 10^4$ | $\\le n-1$ | 是 | 否 | 否 |\n| $9$ | $\\le 10^3$ | $\\le n-1$ | 否 | 是 | 是 |\n| $10$ | $\\le 3\\times 10^4$ | $\\le n-1$ | 否 | 是 | 是 |\n| $11$ | $\\le 5\\times 10^4$ | $\\le n-1$ | 否 | 是 | 是 |\n| $12$ | $\\le 50$ | $\\le n-1$ | 否 | 否 | 是 |\n| $13$ | $\\le 50$ | $\\le n-1$ | 否 | 否 | 是 |\n| $14$ | $\\le 200$ | $\\le n-1$ | 否 | 否 | 是 |\n| $15$ | $\\le 200$ | $\\le n-1$ | 否 | 否 | 是 |\n| $16$ | $\\le 10^3$ | $\\le n-1$ | 否 | 否 | 是 |\n| $17$ | $\\le 10^3$ | $\\le n-1$ | 否 | 否 | 否 |\n| $18$ | $\\le 3\\times 10^4$ | $\\le n-1$ | 否 | 否 | 否 |\n| $19$ | $\\le 3\\times 10^4$ | $\\le n-1$ | 否 | 否 | 否 |\n| $20$ | $\\le 5\\times 10^4$ | $\\le n-1$ | 否 | 否 | 否 |\n\n其中，「分支不超过 $3$」的含义为：每个路口至多有 $3$ 条道路与其相连。\n\n对于所有的数据，$2 \\le n \\le 5\\times 10^4, \\ 1 \\le m \\le n − 1,\\ 1 \\le a_i,b_i \\le n,\\  1 \\le l_i \\le 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Senior] Track Construction", "background": "", "description": "City C is going to host a series of car races. Before the races, it is necessary to build $m$ race tracks in the city.\n\nCity C has $n$ intersections, numbered $1,2,\\ldots,n$. There are $n-1$ bidirectional roads suitable for building tracks, and each road connects two intersections. The $i$-th road connects intersections $a_i$ and $b_i$, and its length is $l_i$. Using these $n-1$ roads, you can reach every other intersection from any starting intersection.\n\nA track is a sequence of pairwise distinct roads $e_1,e_2,\\ldots,e_k$, such that you can start from some intersection, then pass through roads $e_1,e_2,\\ldots,e_k$ in order (each road is used exactly once, and turning back is not allowed), and finally arrive at another intersection. The length of a track is the sum of the lengths of all roads it passes through. For safety, each road may be used by at most one track.\n\nThe track construction plan has not been decided yet. Your task is to design a construction plan so that, among the $m$ tracks built, the shortest track is as long as possible (that is, maximize the minimum track length among the $m$ tracks).", "inputFormat": "The first line contains two positive integers $n,m$ separated by spaces, representing the number of intersections and the number of tracks to be built.\n\nThe next $n-1$ lines each contain three positive integers $a_i,b_i,l_i$, describing the two intersections connected by the $i$-th road and the road length. It is guaranteed that any two intersections are mutually reachable via these $n-1$ roads. Adjacent numbers in each line are separated by one space.", "outputFormat": "Output one line containing one integer, representing the maximum possible value of the minimum track length.", "hint": "[Explanation for Sample 1]\n\nAll intersections and the roads suitable for building tracks are shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bkj3pfqm.png)\n\nThe number in parentheses beside a road is the road index, and the number not in parentheses is the road length. You need to build $1$ track. You can build a track that goes through roads $3,1,2,6$ (from intersection $4$ to intersection $7$). Then the track length is $9 + 10 + 5 + 7 = 31$, which is the maximum among all plans.\n\n[Explanation for Sample 2]\n\nAll intersections and the roads suitable for building tracks are shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e9lcljwr.png)\n\nYou need to build $3$ tracks. You can build the following $3$ tracks:\n1. A track that goes through roads $1,6$ (from intersection $1$ to intersection $7$), with length $6 + 9 = 15$;\n2. A track that goes through roads $5,2,3,8$ (from intersection $6$ to intersection $9$), with length $4 + 3 + 5 + 4 = 16$;\n3. A track that goes through roads $7,4$ (from intersection $8$ to intersection $5$), with length $7 + 10 = 17$.\nThe minimum track length is $15$, which is the maximum among all plans.\n\n### Constraints\n\nThe ranges and characteristics of all testdata are shown in the table below:\n\n| Test Point ID | $n$ | $m$ | $a_i=1$ | $b_i=a_i+1$ | Branching $\\le 3$ |\n|:-:|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $\\le 5$ | $=1$ | No | No | Yes |\n| $2$ | $\\le 10$ | $\\le n-1$ | No | Yes | Yes |\n| $3$ | $\\le 15$ | $\\le n-1$ | Yes | No | No |\n| $4$ | $\\le 10^3$ | $=1$ | No | No | Yes |\n| $5$ | $\\le 3\\times 10^4$ | $=1$ | Yes | No | No |\n| $6$ | $\\le 3\\times 10^4$ | $=1$ | No | No | No |\n| $7$ | $\\le 3\\times 10^4$ | $\\le n-1$ | Yes | No | No |\n| $8$ | $\\le 5\\times 10^4$ | $\\le n-1$ | Yes | No | No |\n| $9$ | $\\le 10^3$ | $\\le n-1$ | No | Yes | Yes |\n| $10$ | $\\le 3\\times 10^4$ | $\\le n-1$ | No | Yes | Yes |\n| $11$ | $\\le 5\\times 10^4$ | $\\le n-1$ | No | Yes | Yes |\n| $12$ | $\\le 50$ | $\\le n-1$ | No | No | Yes |\n| $13$ | $\\le 50$ | $\\le n-1$ | No | No | Yes |\n| $14$ | $\\le 200$ | $\\le n-1$ | No | No | Yes |\n| $15$ | $\\le 200$ | $\\le n-1$ | No | No | Yes |\n| $16$ | $\\le 10^3$ | $\\le n-1$ | No | No | Yes |\n| $17$ | $\\le 10^3$ | $\\le n-1$ | No | No | No |\n| $18$ | $\\le 3\\times 10^4$ | $\\le n-1$ | No | No | No |\n| $19$ | $\\le 3\\times 10^4$ | $\\le n-1$ | No | No | No |\n| $20$ | $\\le 5\\times 10^4$ | $\\le n-1$ | No | No | No |\n\nHere, “Branching $\\le 3$” means that each intersection is connected to at most $3$ roads.\n\nFor all data, $2 \\le n \\le 5\\times 10^4, \\ 1 \\le m \\le n − 1,\\ 1 \\le a_i,b_i \\le n,\\  1 \\le l_i \\le 10^4$.\n\n# Input Format\n\nThe first line contains two positive integers $n,m$ separated by spaces, representing the number of intersections and the number of tracks to be built.\n\nThe next $n-1$ lines each contain three positive integers $a_i,b_i,l_i$, describing the two intersections connected by the $i$-th road and the road length. It is guaranteed that any two intersections are mutually reachable via these $n-1$ roads. Adjacent numbers in each line are separated by one space.\n\n# Output Format\n\nOutput one line containing one integer, representing the maximum possible value of the minimum track length.\n\n# Hint\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 提高组] 赛道修建", "background": "", "description": "C 城将要举办一系列的赛车比赛。在比赛前，需要在城内修建 $m$ 条赛道。 \n\nC 城一共有 $n$ 个路口，这些路口编号为 $1,2,…,n$，有 $n-1$ 条适合于修建赛道的双向通行的道路，每条道路连接着两个路口。其中，第 $i$ 条道路连接的两个路口编号为 $a_i$ 和 $b_i$，该道路的长度为 $l_i$。借助这 $n-1$ 条道路，从任何一个路口出发都能到达其他所有的路口。 \n\n一条赛道是一组互不相同的道路 $e_1,e_2,…,e_k$，满足可以从某个路口出发，依次经过 道路 $e_1,e_2,…,e_k$（每条道路经过一次，不允许调头）到达另一个路口。一条赛道的长度等于经过的各道路的长度之和。为保证安全，要求每条道路至多被一条赛道经过。 \n\n目前赛道修建的方案尚未确定。你的任务是设计一种赛道修建的方案，使得修建的 $m$ 条赛道中长度最小的赛道长度最大（即 $m$ 条赛道中最短赛道的长度尽可能大）", "inputFormat": "输入文件第一行包含两个由空格分隔的正整数 $n,m$，分别表示路口数及需要修建的 赛道数。 \n\n接下来 $n-1$ 行，第 $i$ 行包含三个正整数 $a_i,b_i,l_i$，表示第 $i$ 条适合于修建赛道的道 路连接的两个路口编号及道路长度。保证任意两个路口均可通过这 $n-1$ 条道路相互到达。每行中相邻两数之间均由一个空格分隔。 ", "outputFormat": "输出共一行，包含一个整数，表示长度最小的赛道长度的最大值。 ", "hint": "【输入输出样例 1 说明】 \n\n所有路口及适合于修建赛道的道路如下图所示：      \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bkj3pfqm.png)\n\n道路旁括号内的数字表示道路的编号，非括号内的数字表示道路长度。 需要修建 $1$ 条赛道。可以修建经过第 $3,1,2,6$ 条道路的赛道（从路口 $4$ 到路口 $7$）， 则该赛道的长度为 $9 + 10 + 5 + 7 = 31$，为所有方案中的最大值。\n\n【输入输出样例 2 说明】\n\n 所有路口及适合于修建赛道的道路如下图所示：   \n  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e9lcljwr.png)\n\n需要修建 $3$ 条赛道。可以修建如下 $3$ 条赛道： \n1. 经过第 $1,6 $条道路的赛道（从路口 $1$ 到路口$ 7$），长度为 $6 + 9 = 15$； \n2. 经过第$ 5,2,3,8$ 条道路的赛道（从路口$ 6$ 到路口 $9$），长度为 $4 + 3 + 5 + 4 = 16$；\n3. 经过第 $7,4$ 条道路的赛道（从路口 $8$ 到路口$ 5$），长度为 $7 + 10 = 17$。 长度最小的赛道长度为 $15$，为所有方案中的最大值。 \n\n### 数据规模与约定\n\n所有测试数据的范围和特点如下表所示 :\n\n| 测试点编号 | $n$ | $m$ | $a_i=1$ | $b_i=a_i+1$ | 分支不超过 $3$ |\n|:-:|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $\\le 5$ | $=1$ | 否 | 否 | 是 |\n| $2$ | $\\le 10$ | $\\le n-1$ | 否 | 是 | 是 |\n| $3$ | $\\le 15$ | $\\le n-1$ | 是 | 否 | 否 |\n| $4$ | $\\le 10^3$ | $=1$ | 否 | 否 | 是 |\n| $5$ | $\\le 3\\times 10^4$ | $=1$ | 是 | 否 | 否 |\n| $6$ | $\\le 3\\times 10^4$ | $=1$ | 否 | 否 | 否 |\n| $7$ | $\\le 3\\times 10^4$ | $\\le n-1$ | 是 | 否 | 否 |\n| $8$ | $\\le 5\\times 10^4$ | $\\le n-1$ | 是 | 否 | 否 |\n| $9$ | $\\le 10^3$ | $\\le n-1$ | 否 | 是 | 是 |\n| $10$ | $\\le 3\\times 10^4$ | $\\le n-1$ | 否 | 是 | 是 |\n| $11$ | $\\le 5\\times 10^4$ | $\\le n-1$ | 否 | 是 | 是 |\n| $12$ | $\\le 50$ | $\\le n-1$ | 否 | 否 | 是 |\n| $13$ | $\\le 50$ | $\\le n-1$ | 否 | 否 | 是 |\n| $14$ | $\\le 200$ | $\\le n-1$ | 否 | 否 | 是 |\n| $15$ | $\\le 200$ | $\\le n-1$ | 否 | 否 | 是 |\n| $16$ | $\\le 10^3$ | $\\le n-1$ | 否 | 否 | 是 |\n| $17$ | $\\le 10^3$ | $\\le n-1$ | 否 | 否 | 否 |\n| $18$ | $\\le 3\\times 10^4$ | $\\le n-1$ | 否 | 否 | 否 |\n| $19$ | $\\le 3\\times 10^4$ | $\\le n-1$ | 否 | 否 | 否 |\n| $20$ | $\\le 5\\times 10^4$ | $\\le n-1$ | 否 | 否 | 否 |\n\n其中，「分支不超过 $3$」的含义为：每个路口至多有 $3$ 条道路与其相连。\n\n对于所有的数据，$2 \\le n \\le 5\\times 10^4, \\ 1 \\le m \\le n − 1,\\ 1 \\le a_i,b_i \\le n,\\  1 \\le l_i \\le 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5022", "type": "P", "difficulty": 4, "samples": [["6 5 \n1 3 \n2 3 \n2 5 \n3 4 \n4 6", "1 3 2 5 4 6"], ["6 6 \n1 3 \n2 3 \n2 5 \n3 4 \n4 5 \n4 6", "1 3 2 4 5 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["搜索", "贪心", "2018", "NOIP 提高组", "深度优先搜索 DFS", "基环树"], "title": "[NOIP 2018 提高组] 旅行", "background": "NOIP2018 提高组 D2T1", "description": "小 Y 是一个爱好旅行的 OIer。她来到 X 国，打算将各个城市都玩一遍。 \n  \n小 Y 了解到，X 国的 $n$ 个城市之间有 $m$ 条双向道路。每条双向道路连接两个城市。不存在两条连接同一对城市的道路，也不存在一条连接一个城市和它本身的道路。并且，从任意一个城市出发，通过这些道路都可以到达任意一个其他城市。小 Y 只能通过这些道路从一个城市前往另一个城市。\n\n小 Y 的旅行方案是这样的：任意选定一个城市作为起点，然后从起点开始，每次可以选择一条与当前城市相连的道路，走向一个没有去过的城市，或者沿着第一次访问该城市时经过的道路后退到上一个城市。当小 Y 回到起点时，她可以选择结束这次旅行或继续旅行。需要注意的是，小 Y 要求在旅行方案中，每个城市都被访问到。\n\n为了让自己的旅行更有意义，小 Y 决定在每到达一个新的城市（包括起点）时，将它的编号记录下来。她知道这样会形成一个长度为 $n$ 的序列。她希望这个序列的字典序 最小，你能帮帮她吗？对于两个长度均为 $n$ 的序列 $A$ 和 $B$，当且仅当存在一个正整数 $x$，满足以下条件时，我们说序列 $A$ 的字典序小于 $B$。\n\n- 对于任意正整数 $1 \\le i < x$，序列 $A$ 的第 $i$ 个元素 $A_i$ 和序列 $B$ 的第 $i$ 个元素 $B_i$ 相同。\n- 序列 $A$ 的第 $x$ 个元素的值小于序列 $B$ 的第 $x$ 个元素的值。", "inputFormat": "输入文件共 $m + 1$ 行。第一行包含两个整数 $n,m(m \\le n)$，中间用一个空格分隔。\n\n接下来 $m$ 行，每行包含两个整数 $u,v (1 \\le u,v \\le n)$ ，表示编号为 $u$ 和 $v$ 的城市之 间有一条道路，两个整数之间用一个空格分隔。", "outputFormat": "输出文件包含一行，$n$ 个整数，表示字典序最小的序列。相邻两个整数之间用一个空格分隔。", "hint": "【数据规模与约定】   \n\n对于 $100\\%$ 的数据和所有样例， $1 \\le n \\le 5000 $ 且 $m = n - 1$ 或 $m = n$ 。\n\n对于不同的测试点，我们约定数据的规模如下：\n\n![](https://cdn.luogu.com.cn/upload/pic/43271.png)", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Senior] Travel", "background": "NOIP 2018 Senior D2T1.", "description": "Xiao Y is an OIer who loves traveling. She comes to Country X and plans to visit every city.\n\nXiao Y learns that there are $m$ undirected roads among the $n$ cities in Country X. Each undirected road connects two cities. There are no two roads connecting the same pair of cities, and there is no road connecting a city to itself. Also, starting from any city, one can reach any other city through these roads. Xiao Y can only travel from one city to another using these roads.\n\nXiao Y’s travel plan is as follows: she chooses any city as the starting point, and then starting from it, each time she can either choose a road connected to the current city and go to a city she has not visited before, or go back to the previous city along the road she used when she first visited the current city. When Xiao Y returns to the starting point, she may choose to end the trip or continue. Note that Xiao Y requires that in her plan, every city must be visited.\n\nTo make her trip more meaningful, every time she arrives at a new city (including the starting point), she records its index. She knows this will form a sequence of length $n$. She wants this sequence to be lexicographically smallest. Can you help her? For two sequences $A$ and $B$ of length $n$, we say $A$ is lexicographically smaller than $B$ if and only if there exists a positive integer $x$ such that:\n\n- For any positive integer $1 \\le i < x$, the $i$-th element $A_i$ of $A$ equals the $i$-th element $B_i$ of $B$.\n- The value of the $x$-th element of $A$ is smaller than that of the $x$-th element of $B$.", "inputFormat": "The input has $m + 1$ lines. The first line contains two integers $n,m(m \\le n)$, separated by a space.\n\nThe next $m$ lines each contain two integers $u,v (1 \\le u,v \\le n)$, indicating that there is a road between the cities numbered $u$ and $v$. The two integers are separated by a space.", "outputFormat": "Output one line with $n$ integers, representing the lexicographically smallest sequence. Adjacent integers are separated by a space.", "hint": "## Constraints\n\nFor $100\\%$ of the data and all samples, $1 \\le n \\le 5000$ and $m = n - 1$ or $m = n$.\n\nFor different test points, the constraints are as follows:\n\n![](https://cdn.luogu.com.cn/upload/pic/43271.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 提高组] 旅行", "background": "NOIP2018 提高组 D2T1", "description": "小 Y 是一个爱好旅行的 OIer。她来到 X 国，打算将各个城市都玩一遍。 \n  \n小 Y 了解到，X 国的 $n$ 个城市之间有 $m$ 条双向道路。每条双向道路连接两个城市。不存在两条连接同一对城市的道路，也不存在一条连接一个城市和它本身的道路。并且，从任意一个城市出发，通过这些道路都可以到达任意一个其他城市。小 Y 只能通过这些道路从一个城市前往另一个城市。\n\n小 Y 的旅行方案是这样的：任意选定一个城市作为起点，然后从起点开始，每次可以选择一条与当前城市相连的道路，走向一个没有去过的城市，或者沿着第一次访问该城市时经过的道路后退到上一个城市。当小 Y 回到起点时，她可以选择结束这次旅行或继续旅行。需要注意的是，小 Y 要求在旅行方案中，每个城市都被访问到。\n\n为了让自己的旅行更有意义，小 Y 决定在每到达一个新的城市（包括起点）时，将它的编号记录下来。她知道这样会形成一个长度为 $n$ 的序列。她希望这个序列的字典序 最小，你能帮帮她吗？对于两个长度均为 $n$ 的序列 $A$ 和 $B$，当且仅当存在一个正整数 $x$，满足以下条件时，我们说序列 $A$ 的字典序小于 $B$。\n\n- 对于任意正整数 $1 \\le i < x$，序列 $A$ 的第 $i$ 个元素 $A_i$ 和序列 $B$ 的第 $i$ 个元素 $B_i$ 相同。\n- 序列 $A$ 的第 $x$ 个元素的值小于序列 $B$ 的第 $x$ 个元素的值。", "inputFormat": "输入文件共 $m + 1$ 行。第一行包含两个整数 $n,m(m \\le n)$，中间用一个空格分隔。\n\n接下来 $m$ 行，每行包含两个整数 $u,v (1 \\le u,v \\le n)$ ，表示编号为 $u$ 和 $v$ 的城市之 间有一条道路，两个整数之间用一个空格分隔。", "outputFormat": "输出文件包含一行，$n$ 个整数，表示字典序最小的序列。相邻两个整数之间用一个空格分隔。", "hint": "【数据规模与约定】   \n\n对于 $100\\%$ 的数据和所有样例， $1 \\le n \\le 5000 $ 且 $m = n - 1$ 或 $m = n$ 。\n\n对于不同的测试点，我们约定数据的规模如下：\n\n![](https://cdn.luogu.com.cn/upload/pic/43271.png)", "locale": "zh-CN"}}}
{"pid": "P5023", "type": "P", "difficulty": 6, "samples": [["2 2", "12"], ["3 3", "112"], ["5 5", "7136"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "2018", "NOIP 提高组"], "title": "[NOIP 2018 提高组] 填数游戏", "background": "NOIP2018 提高组 D2T2", "description": "小 D 特别喜欢玩游戏。这一天，他在玩一款填数游戏。\n  \n这个填数游戏的棋盘是一个 $n \\times m$ 的矩形表格。玩家需要在表格的每个格子中填入一个数字（数字 $0$ 或者数字 $1$），填数时需要满足一些限制。   \n\n下面我们来具体描述这些限制。   \n\n为了方便描述，我们先给出一些定义： \n \n-  我们用每个格子的行列坐标来表示一个格子，即（行坐标，列坐标）。注意：行列坐标均从 $0$ 开始编号。\n- 合法路径 $P$：一条路径是合法的当且仅当：   \n    1. 这条路径从矩形表格的左上角的格子 $(0,0)$ 出发，到矩形的右下角格子 $(n - 1,m - 1)$ 结束；   \n    2. 在这条路径中，每次只能从当前的格子移动到右边与它相邻的格子，或者从当前格子移动到下面与它相邻的格子。\n    \n  例如：在下面这个矩形中，只有两条路径是合法的，它们分别是 $P_1$：$(0,0)\\to (0,1)\\to (1,1)$ 和 $P_2$：$(0,0) \\to (1,0) \\to (1,1)$。\n   \n![](https://cdn.luogu.com.cn/upload/pic/43256.png)  \n\n对于一条合法的路径 $P$，我们可以用一个字符串 $w(P)$ 来表示，该字符串的长度为 $n + m - 2$，其中只包含字符 $\\texttt R$ 或者字符 $\\texttt D$，第 $i$ 个字符记录了路径 $P$ 中第 $i$ 步的移动方法。$\\texttt R$ 表示移动到当前格子右边与它相邻的格子，$\\texttt D$ 表示移动到当前格子下面与它相邻的格子。例如，上图中对于路径 $P_1$，有 $w(P_1) = \\texttt {RD}$；而对于另一条路径 $P_2$，有 $w(P_2) = \\texttt {DR}$。   \n\n同时，将每条合法路径 $P$ 经过的每个格子上填入的数字依次连接后，会得到一个长度为 $n + m - 1$ 的 $01$ 字符串，记为 $s(P)$。例如，如果我们在格子 $(0,0)$ 和 $(1,0)$ 上填入数字 $0$，在格子 $(0,1)$ 和 $(1,1)$ 上填入数字 $1$（见上图红色数字），那么对于路径 $P_1$，我们可以得到 $s(P_1) = 011$，对于路径 $P_2$，有 $s(P_2) = 001$。 \n\n游戏要求小 D 找到一种填数字 $0$、$1$ 的方法，使得对于两条路径 $P_1$，$P_2$，如果 $w(P_1) > w(P_2)$，那么必须 $s(P_1) ≤ s(P_2)$。我们说字符串 $a$ 比字符串 $b$ 小，当且仅当字符串 $a$ 的字典序小于字符串 $b$ 的字典序，字典序的定义详见第一题。但是仅仅是找一种方法无法满足小 D 的好奇心，小 D 更想知道这个游戏有多少种玩法，也就是说，有多少种填数字的方法满足游戏的要求？ \n\n小 D 能力有限，希望你帮助他解决这个问题，即有多少种填 $0$、$1$ 的方法能满足题目要求。由于答案可能很大，你需要输出答案对 $10^9 + 7$ 取模的结果。 ", "inputFormat": "输入文件共一行，包含两个正整数 $n,m$，由一个空格分隔，表示矩形的大小。其中 $n$ 表示矩形表格的行数，$m$ 表示矩形表格的列数。 ", "outputFormat": "输出共一行，包含一个正整数，表示有多少种填 $0$、$1$ 的方法能满足游戏的要求。 注意：输出答案对 $10^9+7$ 取模的结果。 ", "hint": "**样例解释**  \n\n![](https://cdn.luogu.com.cn/upload/pic/43257.png)  \n\n**数据规模与约定** \n\n| 测试点编号 | $n\\le$ | $m\\le$ |\n| :-----------: | :-----------: | :-----------: |\n| $1\\sim 4$ | $3$ | $3$ |\n| $5\\sim 10$ | $2$ | $10^6$ |\n| $11\\sim 13$ | $3$ | $10^6$ |\n| $14\\sim 16$ | $8$ | $8$ |\n| $17\\sim 20$ | $8$ | $10^6$ |\n", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Senior] Number Filling Game", "background": "NOIP 2018 Senior D2T2.", "description": "Xiao D really likes playing games. One day, he was playing a number filling game.\n\nThe board of this game is an $n \\times m$ rectangular grid. The player needs to fill each cell in the grid with a number (either $0$ or $1$), and the filling must satisfy some constraints.\n\nWe describe these constraints in detail below.\n\nFor convenience, we first give some definitions:\n\n- We use the row and column coordinates of each cell to represent a cell, i.e., (row, column). Note: both row and column coordinates start from $0$.\n- A valid path $P$: A path is valid if and only if:\n  1. The path starts from the top-left cell $(0,0)$ of the grid and ends at the bottom-right cell $(n - 1,m - 1)$;\n  2. Along this path, each move can only go from the current cell to the adjacent cell on its right, or from the current cell to the adjacent cell below it.\n\n  For example, in the rectangle below, only two paths are valid: $P_1$: $(0,0)\\to (0,1)\\to (1,1)$ and $P_2$: $(0,0) \\to (1,0) \\to (1,1)$.\n\n![](https://cdn.luogu.com.cn/upload/pic/43256.png)\n\nFor a valid path $P$, we can represent it with a string $w(P)$ of length $n + m - 2$, which contains only the characters $\\texttt R$ or $\\texttt D$. The $i$-th character records how the $i$-th step of path $P$ moves. $\\texttt R$ means moving to the adjacent cell on the right of the current cell, and $\\texttt D$ means moving to the adjacent cell below the current cell. For example, for path $P_1$ in the figure above, $w(P_1) = \\texttt {RD}$; for the other path $P_2$, $w(P_2) = \\texttt {DR}$.\n\nAlso, if we concatenate, in order, the numbers filled in each cell visited by a valid path $P$, we obtain a $01$ string of length $n + m - 1$, denoted by $s(P)$. For example, if we fill $0$ in cells $(0,0)$ and $(1,0)$, and fill $1$ in cells $(0,1)$ and $(1,1)$ (as the red numbers in the figure), then for path $P_1$ we get $s(P_1) = 011$, and for path $P_2$ we get $s(P_2) = 001$.\n\nThe game requires Xiao D to find a way to fill $0$ and $1$ such that for any two paths $P_1$, $P_2$, if $w(P_1) > w(P_2)$, then it must hold that $s(P_1) \\le s(P_2)$. We say that string $a$ is smaller than string $b$ if and only if $a$ is lexicographically smaller than $b$. The definition of lexicographical order is given in detail in Problem 1. However, finding just one method does not satisfy Xiao D’s curiosity. Xiao D wants to know how many different ways the game can be played, that is, how many filling methods satisfy the requirement.\n\nXiao D is not strong enough, so he hopes you can help solve this problem: how many ways of filling $0$ and $1$ can satisfy the requirement? Since the answer may be very large, you need to output the answer modulo $10^9 + 7$.", "inputFormat": "The input consists of one line containing two positive integers $n,m$, separated by a space, representing the size of the rectangle. Here $n$ is the number of rows of the grid, and $m$ is the number of columns of the grid.", "outputFormat": "Output one line containing a positive integer, representing how many ways of filling $0$ and $1$ can satisfy the requirement. Note: output the result modulo $10^9+7$.", "hint": "**Sample Explanation**\n\n![](https://cdn.luogu.com.cn/upload/pic/43257.png)\n\n**Constraints**\n\n| Test Point ID | $n\\le$ | $m\\le$ |\n| :-----------: | :-----------: | :-----------: |\n| $1\\sim 4$ | $3$ | $3$ |\n| $5\\sim 10$ | $2$ | $10^6$ |\n| $11\\sim 13$ | $3$ | $10^6$ |\n| $14\\sim 16$ | $8$ | $8$ |\n| $17\\sim 20$ | $8$ | $10^6$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 提高组] 填数游戏", "background": "NOIP2018 提高组 D2T2", "description": "小 D 特别喜欢玩游戏。这一天，他在玩一款填数游戏。\n  \n这个填数游戏的棋盘是一个 $n \\times m$ 的矩形表格。玩家需要在表格的每个格子中填入一个数字（数字 $0$ 或者数字 $1$），填数时需要满足一些限制。   \n\n下面我们来具体描述这些限制。   \n\n为了方便描述，我们先给出一些定义： \n \n-  我们用每个格子的行列坐标来表示一个格子，即（行坐标，列坐标）。注意：行列坐标均从 $0$ 开始编号。\n- 合法路径 $P$：一条路径是合法的当且仅当：   \n    1. 这条路径从矩形表格的左上角的格子 $(0,0)$ 出发，到矩形的右下角格子 $(n - 1,m - 1)$ 结束；   \n    2. 在这条路径中，每次只能从当前的格子移动到右边与它相邻的格子，或者从当前格子移动到下面与它相邻的格子。\n    \n  例如：在下面这个矩形中，只有两条路径是合法的，它们分别是 $P_1$：$(0,0)\\to (0,1)\\to (1,1)$ 和 $P_2$：$(0,0) \\to (1,0) \\to (1,1)$。\n   \n![](https://cdn.luogu.com.cn/upload/pic/43256.png)  \n\n对于一条合法的路径 $P$，我们可以用一个字符串 $w(P)$ 来表示，该字符串的长度为 $n + m - 2$，其中只包含字符 $\\texttt R$ 或者字符 $\\texttt D$，第 $i$ 个字符记录了路径 $P$ 中第 $i$ 步的移动方法。$\\texttt R$ 表示移动到当前格子右边与它相邻的格子，$\\texttt D$ 表示移动到当前格子下面与它相邻的格子。例如，上图中对于路径 $P_1$，有 $w(P_1) = \\texttt {RD}$；而对于另一条路径 $P_2$，有 $w(P_2) = \\texttt {DR}$。   \n\n同时，将每条合法路径 $P$ 经过的每个格子上填入的数字依次连接后，会得到一个长度为 $n + m - 1$ 的 $01$ 字符串，记为 $s(P)$。例如，如果我们在格子 $(0,0)$ 和 $(1,0)$ 上填入数字 $0$，在格子 $(0,1)$ 和 $(1,1)$ 上填入数字 $1$（见上图红色数字），那么对于路径 $P_1$，我们可以得到 $s(P_1) = 011$，对于路径 $P_2$，有 $s(P_2) = 001$。 \n\n游戏要求小 D 找到一种填数字 $0$、$1$ 的方法，使得对于两条路径 $P_1$，$P_2$，如果 $w(P_1) > w(P_2)$，那么必须 $s(P_1) ≤ s(P_2)$。我们说字符串 $a$ 比字符串 $b$ 小，当且仅当字符串 $a$ 的字典序小于字符串 $b$ 的字典序，字典序的定义详见第一题。但是仅仅是找一种方法无法满足小 D 的好奇心，小 D 更想知道这个游戏有多少种玩法，也就是说，有多少种填数字的方法满足游戏的要求？ \n\n小 D 能力有限，希望你帮助他解决这个问题，即有多少种填 $0$、$1$ 的方法能满足题目要求。由于答案可能很大，你需要输出答案对 $10^9 + 7$ 取模的结果。 ", "inputFormat": "输入文件共一行，包含两个正整数 $n,m$，由一个空格分隔，表示矩形的大小。其中 $n$ 表示矩形表格的行数，$m$ 表示矩形表格的列数。 ", "outputFormat": "输出共一行，包含一个正整数，表示有多少种填 $0$、$1$ 的方法能满足游戏的要求。 注意：输出答案对 $10^9+7$ 取模的结果。 ", "hint": "**样例解释**  \n\n![](https://cdn.luogu.com.cn/upload/pic/43257.png)  \n\n**数据规模与约定** \n\n| 测试点编号 | $n\\le$ | $m\\le$ |\n| :-----------: | :-----------: | :-----------: |\n| $1\\sim 4$ | $3$ | $3$ |\n| $5\\sim 10$ | $2$ | $10^6$ |\n| $11\\sim 13$ | $3$ | $10^6$ |\n| $14\\sim 16$ | $8$ | $8$ |\n| $17\\sim 20$ | $8$ | $10^6$ |\n", "locale": "zh-CN"}}}
{"pid": "P5024", "type": "P", "difficulty": 6, "samples": [["5 3 C3 \n2 4 1 3 9 \n1 5 \n5 2 \n5 3 \n3 4 \n1 0 3 0 \n2 1 3 1 \n1 0 5 0\n", "12 \n7 \n-1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2018", "倍增", "NOIP 提高组", "树链剖分", "动态 DP", "全局平衡二叉树"], "title": "[NOIP 2018 提高组] 保卫王国", "background": "NOIP2018 提高组 D2T3", "description": "Z 国有 $n$ 座城市，$(n - 1)$ 条双向道路，每条双向道路连接两座城市，且任意两座城市都能通过若干条道路相互到达。  \n\nZ 国的国防部长小 Z 要在城市中驻扎军队。驻扎军队需要满足如下几个条件： \n\n- 一座城市可以驻扎一支军队，也可以不驻扎军队。   \n- 由道路直接连接的两座城市中至少要有一座城市驻扎军队。   \n- 在城市里驻扎军队会产生花费，在编号为 $i$ 的城市中驻扎军队的花费是 $p_i$。      \n\n小 Z 很快就规划出了一种驻扎军队的方案，使总花费最小。但是国王又给小 Z 提出了 $m$ 个要求，每个要求规定了其中两座城市是否驻扎军队。小 Z 需要针对每个要求逐一给出回答。具体而言，如果国王提出的第 $j$ 个要求能够满足上述驻扎条件（不需要考虑第 $j$ 个要求之外的其它要求），则需要给出在此要求前提下驻扎军队的最小开销。如果国王提出的第 $j$ 个要求无法满足，则需要输出 $-1$。现在请你来帮助小 Z。 ", "inputFormat": "第一行有两个整数和一个字符串，依次表示城市数 $n$，要求数 $m$ 和数据类型 $type$。$type$ 是一个由大写字母 `A`，`B` 或 `C` 和一个数字 `1`，`2`，`3` 组成的字符串。它可以帮助你获得部分分。你可能不需要用到这个参数。这个参数的含义在【数据规模与约定】中 有具体的描述。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示编号 $i$ 的城市中驻扎军队的花费 $p_i$。\n\n接下来 $(n - 1)$ 行，每行两个整数 $u,v$，表示有一条 $u$ 到 $v$ 的双向道路。 \n\n接下来 $m$ 行，每行四个整数 $a, x, b, y$，表示一个要求是在城市 $a$ 驻扎 $x$ 支军队，在城市 $b$ 驻扎 $y$ 支军队。其中，$x,y$ 的取值只有 $0$ 或 $1$：\n- 若 $x$ 为 $0$，表示城市 $a$ 不得驻扎军队。\n- 若 $x$ 为 $1$，表示城市 $a$ 必须驻扎军队。\n- 若 $y$ 为 $0$，表示城市 $b$ 不得驻扎军队。\n- 若 $y$ 为 $1$，表示城市 $b$ 必须驻扎军队。    \n\n输入文件中每一行相邻的两个数据之间均用一个空格分隔。 ", "outputFormat": "输出共 $m$ 行，每行包含一个个整数，第 $j$ 行表示在满足国王第 $j$ 个要求时的最小开销， 如果无法满足国王的第 $j$ 个要求，则该行输出 $-1$。 ", "hint": "#### 样例 1 解释\n\n- 对于第一个要求，在 $4$ 号和 $5$ 号城市驻扎军队时开销最小。\n- 对于第二个要求，在 $1$ 号、$2$ 号、$3$ 号城市驻扎军队时开销最小。   \n- 第三个要求是无法满足的，因为在 $1$ 号、$5$ 号城市都不驻扎军队就意味着由道路直接连 接的两座城市中都没有驻扎军队。  \n\n#### 数据规模与约定  \n\n| 测试点编号 | $\\text{type}$ | $n = m=$ |\n|:-:|:-:|:-:|\n| $1,2$ | `A3` | $10$ |\n| $3,4$ | `C3` | $10$ |\n| $5,6$ | `A3` | $100$ |\n| $7$ | `C3` | $100$ |\n| $8,9$ | `A3` | $2\\times 10^3$ |\n| $10,11$ | `C3` | $2\\times 10^3$ |\n| $12,13$ | `A1` | $10^5$ |\n| $14, 15, 16$ | `A2` | $10^5$ |\n| $17$ | `A3` | $10^5$ |\n| $18,19$ | `B1` | $10^5$ |\n| $20,21$ | `C1` | $10^5$ |\n| $22$ | `C2` | $10^5$ |\n| $23, 24, 25$ | `C3` | $10^5$ |\n\n数据类型的含义：   \n\n- `A`：城市 $i$ 与城市 $i + 1$ 直接相连。    \n- `B`：任意城市与城市 $1$ 的距离不超过 $100$（距离定义为最短路径上边的数量），即如果这 棵树以 $1$ 号城市为根，深度不超过 $100$。   \n- `C`：在树的形态上无特殊约束。   \n- `1`：询问时保证 $a = 1,x = 1$，即要求在城市 $1$ 驻军。对 $b,y$ 没有限制。   \n- `2`：询问时保证 $a,b$ 是相邻的（由一条道路直接连通）  \n- `3`：在询问上无特殊约束。\n\n对于 $100\\%$的数据，保证 $1 \\leq n,m ≤ 10^5$，$1 ≤ p_i ≤ 10^5$，$1 \\leq u, v, a, b \\leq n$，$a \\neq b$，$x, y \\in \\{0, 1\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2018 Senior] Defend the Kingdom", "background": "NOIP 2018 Senior D2T3.", "description": "Country Z has $n$ cities and $(n - 1)$ two-way roads. Each road connects two cities, and any two cities can reach each other through some roads.\n\nThe Minister of Defense, Little Z, wants to station armies in the cities. The deployment must satisfy the following conditions:\n\n- A city may have an army stationed, or may have no army stationed.\n- For any two cities directly connected by a road, at least one of them must have an army stationed.\n- Stationing an army in a city costs money. The cost of stationing an army in city $i$ is $p_i$.\n\nLittle Z quickly finds a deployment plan with the minimum total cost. However, the king then提出 (tíchū) $m$ requirements. Each requirement specifies whether two particular cities must have armies stationed or must not have armies stationed. Little Z needs to answer each requirement one by one.\n\nSpecifically, if the king’s $j$-th requirement can be satisfied together with the deployment conditions above (without considering any other requirements beyond the $j$-th one), output the minimum total cost under this requirement. If the $j$-th requirement cannot be satisfied, output $-1$. Please help Little Z.", "inputFormat": "The first line contains two integers and a string, in order: the number of cities $n$, the number of requirements $m$, and the data type $type$. $type$ is a string consisting of an uppercase letter `A`, `B`, or `C`, followed by a digit `1`, `2`, or `3`. It can help you get partial scores. You may not need to use this parameter. Its meaning is described in detail in the “Data Scale and Conventions” section.\n\nThe second line contains $n$ integers. The $i$-th integer denotes the cost $p_i$ of stationing an army in city $i$.\n\nThe next $(n - 1)$ lines each contain two integers $u, v$, indicating a two-way road between $u$ and $v$.\n\nThe next $m$ lines each contain four integers $a, x, b, y$, describing one requirement: station $x$ armies in city $a$, and station $y$ armies in city $b$. Here, $x, y$ can only be $0$ or $1$:\n\n- If $x$ is $0$, city $a$ must not have an army stationed.\n- If $x$ is $1$, city $a$ must have an army stationed.\n- If $y$ is $0$, city $b$ must not have an army stationed.\n- If $y$ is $1$, city $b$ must have an army stationed.\n\nIn the input file, any two adjacent data items on the same line are separated by one space.", "outputFormat": "Output $m$ lines. Each line contains one integer. The $j$-th line represents the minimum total cost when satisfying the king’s $j$-th requirement. If the king’s $j$-th requirement cannot be satisfied, output $-1$ on that line.", "hint": "#### Sample 1 Explanation\n\n- For the first requirement, the minimum cost is achieved by stationing armies in cities $4$ and $5$.\n- For the second requirement, the minimum cost is achieved by stationing armies in cities $1$, $2$, and $3$.\n- The third requirement cannot be satisfied, because not stationing armies in both cities $1$ and $5$ means there exists a road whose two directly connected cities both have no armies stationed.\n\n#### Constraints\n\n| Test Point ID | $\\text{type}$ | $n = m=$ |\n|:-:|:-:|:-:|\n| $1,2$ | `A3` | $10$ |\n| $3,4$ | `C3` | $10$ |\n| $5,6$ | `A3` | $100$ |\n| $7$ | `C3` | $100$ |\n| $8,9$ | `A3` | $2\\times 10^3$ |\n| $10,11$ | `C3` | $2\\times 10^3$ |\n| $12,13$ | `A1` | $10^5$ |\n| $14, 15, 16$ | `A2` | $10^5$ |\n| $17$ | `A3` | $10^5$ |\n| $18,19$ | `B1` | $10^5$ |\n| $20,21$ | `C1` | $10^5$ |\n| $22$ | `C2` | $10^5$ |\n| $23, 24, 25$ | `C3` | $10^5$ |\n\nMeaning of the data types:\n\n- `A`: City $i$ is directly connected to city $i + 1$.\n- `B`: The distance from any city to city $1$ is at most $100$ (distance is defined as the number of edges on the shortest path). That is, if the tree is rooted at city $1$, its depth is at most $100$.\n- `C`: There are no special constraints on the shape of the tree.\n- `1`: In each query, it is guaranteed that $a = 1, x = 1$, meaning city $1$ must have an army stationed. There are no restrictions on $b, y$.\n- `2`: In each query, it is guaranteed that $a, b$ are adjacent (directly connected by one road).\n- `3`: There are no special constraints on the queries.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\leq n, m \\leq 10^5$, $1 \\leq p_i \\leq 10^5$, $1 \\leq u, v, a, b \\leq n$, $a \\neq b$, and $x, y \\in \\{0, 1\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2018 提高组] 保卫王国", "background": "NOIP2018 提高组 D2T3", "description": "Z 国有 $n$ 座城市，$(n - 1)$ 条双向道路，每条双向道路连接两座城市，且任意两座城市都能通过若干条道路相互到达。  \n\nZ 国的国防部长小 Z 要在城市中驻扎军队。驻扎军队需要满足如下几个条件： \n\n- 一座城市可以驻扎一支军队，也可以不驻扎军队。   \n- 由道路直接连接的两座城市中至少要有一座城市驻扎军队。   \n- 在城市里驻扎军队会产生花费，在编号为 $i$ 的城市中驻扎军队的花费是 $p_i$。      \n\n小 Z 很快就规划出了一种驻扎军队的方案，使总花费最小。但是国王又给小 Z 提出了 $m$ 个要求，每个要求规定了其中两座城市是否驻扎军队。小 Z 需要针对每个要求逐一给出回答。具体而言，如果国王提出的第 $j$ 个要求能够满足上述驻扎条件（不需要考虑第 $j$ 个要求之外的其它要求），则需要给出在此要求前提下驻扎军队的最小开销。如果国王提出的第 $j$ 个要求无法满足，则需要输出 $-1$。现在请你来帮助小 Z。 ", "inputFormat": "第一行有两个整数和一个字符串，依次表示城市数 $n$，要求数 $m$ 和数据类型 $type$。$type$ 是一个由大写字母 `A`，`B` 或 `C` 和一个数字 `1`，`2`，`3` 组成的字符串。它可以帮助你获得部分分。你可能不需要用到这个参数。这个参数的含义在【数据规模与约定】中 有具体的描述。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示编号 $i$ 的城市中驻扎军队的花费 $p_i$。\n\n接下来 $(n - 1)$ 行，每行两个整数 $u,v$，表示有一条 $u$ 到 $v$ 的双向道路。 \n\n接下来 $m$ 行，每行四个整数 $a, x, b, y$，表示一个要求是在城市 $a$ 驻扎 $x$ 支军队，在城市 $b$ 驻扎 $y$ 支军队。其中，$x,y$ 的取值只有 $0$ 或 $1$：\n- 若 $x$ 为 $0$，表示城市 $a$ 不得驻扎军队。\n- 若 $x$ 为 $1$，表示城市 $a$ 必须驻扎军队。\n- 若 $y$ 为 $0$，表示城市 $b$ 不得驻扎军队。\n- 若 $y$ 为 $1$，表示城市 $b$ 必须驻扎军队。    \n\n输入文件中每一行相邻的两个数据之间均用一个空格分隔。 ", "outputFormat": "输出共 $m$ 行，每行包含一个个整数，第 $j$ 行表示在满足国王第 $j$ 个要求时的最小开销， 如果无法满足国王的第 $j$ 个要求，则该行输出 $-1$。 ", "hint": "#### 样例 1 解释\n\n- 对于第一个要求，在 $4$ 号和 $5$ 号城市驻扎军队时开销最小。\n- 对于第二个要求，在 $1$ 号、$2$ 号、$3$ 号城市驻扎军队时开销最小。   \n- 第三个要求是无法满足的，因为在 $1$ 号、$5$ 号城市都不驻扎军队就意味着由道路直接连 接的两座城市中都没有驻扎军队。  \n\n#### 数据规模与约定  \n\n| 测试点编号 | $\\text{type}$ | $n = m=$ |\n|:-:|:-:|:-:|\n| $1,2$ | `A3` | $10$ |\n| $3,4$ | `C3` | $10$ |\n| $5,6$ | `A3` | $100$ |\n| $7$ | `C3` | $100$ |\n| $8,9$ | `A3` | $2\\times 10^3$ |\n| $10,11$ | `C3` | $2\\times 10^3$ |\n| $12,13$ | `A1` | $10^5$ |\n| $14, 15, 16$ | `A2` | $10^5$ |\n| $17$ | `A3` | $10^5$ |\n| $18,19$ | `B1` | $10^5$ |\n| $20,21$ | `C1` | $10^5$ |\n| $22$ | `C2` | $10^5$ |\n| $23, 24, 25$ | `C3` | $10^5$ |\n\n数据类型的含义：   \n\n- `A`：城市 $i$ 与城市 $i + 1$ 直接相连。    \n- `B`：任意城市与城市 $1$ 的距离不超过 $100$（距离定义为最短路径上边的数量），即如果这 棵树以 $1$ 号城市为根，深度不超过 $100$。   \n- `C`：在树的形态上无特殊约束。   \n- `1`：询问时保证 $a = 1,x = 1$，即要求在城市 $1$ 驻军。对 $b,y$ 没有限制。   \n- `2`：询问时保证 $a,b$ 是相邻的（由一条道路直接连通）  \n- `3`：在询问上无特殊约束。\n\n对于 $100\\%$的数据，保证 $1 \\leq n,m ≤ 10^5$，$1 ≤ p_i ≤ 10^5$，$1 \\leq u, v, a, b \\leq n$，$a \\neq b$，$x, y \\in \\{0, 1\\}$。", "locale": "zh-CN"}}}
{"pid": "P5025", "type": "P", "difficulty": 6, "samples": [["4\n1 1\n5 1\n6 5\n15 15", "32"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "线段树", "各省省选", "陕西", "强连通分量"], "title": "[SNOI2017] 炸弹", "background": "", "description": "在一条直线上有 $n$ 个炸弹，每个炸弹的坐标是 $ x_i $，爆炸半径是 $ r_i $，当一个炸弹爆炸时，如果另一个炸弹所在位置 $ x_j $ 满足： \n$ |x_j-x_i| \\le r_i $ ，那么，该炸弹也会被引爆。    \n现在，请你帮忙计算一下，先把第 $i$ 个炸弹引爆，将引爆多少个炸弹呢？ \n\n答案对 $10^9 + 7$ 取模", "inputFormat": "第一行，一个数字 $n$ ，表示炸弹个数。 \n第 $2 \\sim n+1$ 行，每行两个整数，表示 $x_i$，$r_i$，保证 $x_i$ 严格递增。", "outputFormat": "一个数字，表示 $\\sum \\limits_{i=1}^n i\\times$ 炸弹 $i$ 能引爆的炸弹个数。", "hint": "【数据范围】  \n对于  $20\\%$ 的数据： $n\\leq 100$。\n\n对于  $50\\%$ 的数据： $n\\leq 1000$。\n\n对于  $80\\%$ 的数据： $n\\leq 100000$。\n\n对于  $100\\%$ 的数据： $1\\le n\\leq 500000$，$-10^{18}\\leq x_{i}\\leq 10^{18}$，$0\\leq r_{i}\\leq 2\\times 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] Bombs", "background": "", "description": "There are $n$ bombs on a straight line. The coordinate of each bomb is $x_i$, and its explosion radius is $r_i$. When a bomb explodes, if the position $x_j$ of another bomb satisfies:  \n$|x_j-x_i| \\le r_i$, then that bomb will also be detonated.\n\nNow, please help compute: if we detonate bomb $i$ first, how many bombs will be detonated in total?\n\nThe answer should be taken modulo $10^9 + 7$.", "inputFormat": "The first line contains an integer $n$, representing the number of bombs.  \nLines $2 \\sim n+1$ each contain two integers, representing $x_i$ and $r_i$. It is guaranteed that $x_i$ is strictly increasing.", "outputFormat": "Output one integer, representing $\\sum \\limits_{i=1}^n i\\times$ the number of bombs that bomb $i$ can detonate.", "hint": "Constraints  \nFor $20\\%$ of the testdata: $n\\leq 100$.  \n\nFor $50\\%$ of the testdata: $n\\leq 1000$.  \n\nFor $80\\%$ of the testdata: $n\\leq 100000$.  \n\nFor $100\\%$ of the testdata: $1\\le n\\leq 500000$, $-10^{18}\\leq x_{i}\\leq 10^{18}$, $0\\leq r_{i}\\leq 2\\times 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 炸弹", "background": "", "description": "在一条直线上有 $n$ 个炸弹，每个炸弹的坐标是 $ x_i $，爆炸半径是 $ r_i $，当一个炸弹爆炸时，如果另一个炸弹所在位置 $ x_j $ 满足： \n$ |x_j-x_i| \\le r_i $ ，那么，该炸弹也会被引爆。    \n现在，请你帮忙计算一下，先把第 $i$ 个炸弹引爆，将引爆多少个炸弹呢？ \n\n答案对 $10^9 + 7$ 取模", "inputFormat": "第一行，一个数字 $n$ ，表示炸弹个数。 \n第 $2 \\sim n+1$ 行，每行两个整数，表示 $x_i$，$r_i$，保证 $x_i$ 严格递增。", "outputFormat": "一个数字，表示 $\\sum \\limits_{i=1}^n i\\times$ 炸弹 $i$ 能引爆的炸弹个数。", "hint": "【数据范围】  \n对于  $20\\%$ 的数据： $n\\leq 100$。\n\n对于  $50\\%$ 的数据： $n\\leq 1000$。\n\n对于  $80\\%$ 的数据： $n\\leq 100000$。\n\n对于  $100\\%$ 的数据： $1\\le n\\leq 500000$，$-10^{18}\\leq x_{i}\\leq 10^{18}$，$0\\leq r_{i}\\leq 2\\times 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5026", "type": "P", "difficulty": 4, "samples": [["1 10\n1 5", "0 0 1 0 -1 0 1 0 0 0 "], ["2 10\n2 6\n3 1", "-2 0 0 0 0 0 2 2 2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "差分"], "title": "Lycanthropy", "background": "小正方形亲眼看见了自己昔日的朋友被卷进了黑暗的深渊，然而它无力阻止……\n\n现在它的朋友已经向它发起了攻击，因此小正方形不得不抵抗。", "description": "我们把山顶上的湖泊看作一条长度为 $m$ 的直线，一开始水深都在水平线上，我们视作此时的水深为 '0'\n\n接下来，在一瞬间，小正方形的\"朋友\"们跳起并扎入水中，导致在入水点的水降低而远离入水点的水升高，注意两个 \"朋友\" 可能在同一地点入水。\n\n小正方形的每个朋友有一个体积数值 $v$，当体积为 $v$ 的一个朋友跳入水中，我们设入水点为 $i$，将会导致 $i - v + 1$ 到 $i$ 的水位依次降低 $1,2,\\cdots,v$\n\n同样地，第 $i$ 到 $i + v - 1$ 的水位会依次降低 $v,v - 1,\\cdots,1$.\n\n相对应地，$i - v$ 的水位不变， $i - v - 1$ 到 $i - 2 * v$ 水位依次增加 $1,2,\\cdots,v$， $i - 2 * v$ 到 $i - 3 * v + 1$ 水位依次增加 $v,v - 1,\\cdots,1$\n\n同样，$i + v$ 水位不变，$i + v + 1$ 到 $i + 2 * v$ 水位增加 $1,2,\\cdots,v$，$i + 2 * v$ 到 $i + 3 * v - 1$ 水位依次增加 $v,v - 1,\\cdots,1$\n\n现在小正方形想要穿过这个湖，他想要知道在这 $n$ 个\"朋友\"跳入水中后湖上每个节点的水位，你能帮帮它吗？", "inputFormat": "第一行为两个整数 $n$,$m$，表示\"朋友\"的数目与湖泊的宽度。\n\n接下来 $n$ 行，一行两个整数 $v,x$，表示第 $i + 1$ 个朋友的体积与入水点。", "outputFormat": "一行 $m$ 个整数，第 $i$ 个整数表示 $i$ 号位的水深。", "hint": "对于 $30\\%$ 的数据，$n <= 50,m <= 500$\n\n对于 $70\\%$ 的数据，$n <= 10^5,m <= 10^5$\n\n对于 $100\\%$ 的数据，$n <= 10^6,m <= 10^6,1 <= v <= 10000,1 <= x <= m$", "locale": "zh-CN", "translations": {"en": {"title": "Lycanthropy", "background": "The little square saw with its own eyes that its former friend was swept into a dark abyss, yet it was powerless to stop it……\n\nNow its friend has attacked it, so the little square has no choice but to fight back.", "description": "We treat the lake on the mountaintop as a straight line of length $m$. At the beginning, the water depth everywhere is on the baseline, and we regard the water depth at this time as '0'.\n\nNext, in an instant, the little square’s \"friends\" jump up and dive into the water, causing the water level at the entry point to drop and the water level far away from the entry point to rise. Note that two \"friends\" may enter the water at the same position.\n\nEach friend of the little square has a volume value $v$. When a friend with volume $v$ jumps into the water, let the entry point be $i$. This will cause the water levels from $i - v + 1$ to $i$ to decrease by $1,2,\\cdots,v$ respectively.\n\nSimilarly, the water levels from $i$ to $i + v - 1$ will decrease by $v,v - 1,\\cdots,1$ respectively.\n\nCorrespondingly, the water level at $i - v$ does not change. The water levels from $i - v - 1$ to $i - 2 * v$ increase by $1,2,\\cdots,v$ respectively, and the water levels from $i - 2 * v$ to $i - 3 * v + 1$ increase by $v,v - 1,\\cdots,1$ respectively.\n\nSimilarly, the water level at $i + v$ does not change. The water levels from $i + v + 1$ to $i + 2 * v$ increase by $1,2,\\cdots,v$ respectively, and the water levels from $i + 2 * v$ to $i + 3 * v - 1$ increase by $v,v - 1,\\cdots,1$ respectively.\n\nNow the little square wants to cross this lake. It wants to know the water level at each position of the lake after these $n$ \"friends\" have jumped into the water. Can you help it?", "inputFormat": "The first line contains two integers $n$, $m$, representing the number of \"friends\" and the width of the lake.\n\nThe next $n$ lines each contain two integers $v,x$, representing the volume and the entry point of the $(i + 1)$-th friend.", "outputFormat": "Output one line with $m$ integers. The $i$-th integer represents the water depth at position $i$.", "hint": "For $30\\%$ of the testdata, $n <= 50, m <= 500$.\n\nFor $70\\%$ of the testdata, $n <= 10^5, m <= 10^5$.\n\nFor $100\\%$ of the testdata, $n <= 10^6, m <= 10^6, 1 <= v <= 10000, 1 <= x <= m$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Lycanthropy", "background": "小正方形亲眼看见了自己昔日的朋友被卷进了黑暗的深渊，然而它无力阻止……\n\n现在它的朋友已经向它发起了攻击，因此小正方形不得不抵抗。", "description": "我们把山顶上的湖泊看作一条长度为 $m$ 的直线，一开始水深都在水平线上，我们视作此时的水深为 '0'\n\n接下来，在一瞬间，小正方形的\"朋友\"们跳起并扎入水中，导致在入水点的水降低而远离入水点的水升高，注意两个 \"朋友\" 可能在同一地点入水。\n\n小正方形的每个朋友有一个体积数值 $v$，当体积为 $v$ 的一个朋友跳入水中，我们设入水点为 $i$，将会导致 $i - v + 1$ 到 $i$ 的水位依次降低 $1,2,\\cdots,v$\n\n同样地，第 $i$ 到 $i + v - 1$ 的水位会依次降低 $v,v - 1,\\cdots,1$.\n\n相对应地，$i - v$ 的水位不变， $i - v - 1$ 到 $i - 2 * v$ 水位依次增加 $1,2,\\cdots,v$， $i - 2 * v$ 到 $i - 3 * v + 1$ 水位依次增加 $v,v - 1,\\cdots,1$\n\n同样，$i + v$ 水位不变，$i + v + 1$ 到 $i + 2 * v$ 水位增加 $1,2,\\cdots,v$，$i + 2 * v$ 到 $i + 3 * v - 1$ 水位依次增加 $v,v - 1,\\cdots,1$\n\n现在小正方形想要穿过这个湖，他想要知道在这 $n$ 个\"朋友\"跳入水中后湖上每个节点的水位，你能帮帮它吗？", "inputFormat": "第一行为两个整数 $n$,$m$，表示\"朋友\"的数目与湖泊的宽度。\n\n接下来 $n$ 行，一行两个整数 $v,x$，表示第 $i + 1$ 个朋友的体积与入水点。", "outputFormat": "一行 $m$ 个整数，第 $i$ 个整数表示 $i$ 号位的水深。", "hint": "对于 $30\\%$ 的数据，$n <= 50,m <= 500$\n\n对于 $70\\%$ 的数据，$n <= 10^5,m <= 10^5$\n\n对于 $100\\%$ 的数据，$n <= 10^6,m <= 10^6,1 <= v <= 10000,1 <= x <= m$", "locale": "zh-CN"}}}
{"pid": "P5027", "type": "P", "difficulty": 5, "samples": [["2\n1 1 2\n2 1 2 5\n2 1 2 1", "2"], ["2\n1 1 2\n2 1 2 4\n2 1 2 5", "2"], ["2\n1 1 2\n2 1 2 6\n2 1 2 5", "illegal"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["枚举", "高斯消元"], "title": "Barracuda", "background": "小正方形的冒险旅途，并不顺利。\n\n一路上，小正方形看到了壮美秀丽的小岛被污染，看到了雄伟壮观的火山，还碰到了许许多多的敌人。\n\n眼下，小正方形正在对付一个巨大的三角形。", "description": "大三角形给小正方形讲起自己的过去：过去的它是一个挖宝工，后来被黑暗之主污染才会落到此番境地。\n\n它也希望小正方形去战胜黑暗之主，不过限于黑暗之主的眼线密布，因此必须给小正方形设置障碍才能骗过那些“眼线”。\n\n他给小正方形的问题是：它有 $n$ 个小三角形，每个小三角形有一定的质量，它对这些三角形进行了 $n + 1$ 次称量，然而由于托盘天平(?)的问题，有一次称量的结果是有误的。\n\n现在，大三角形想要知道最重的小三角形的 编号。\n\n一组输入是合法的，当且仅当输入满足以下条件：\n\n不存在一组 $i$,$j$，使得当我们**假定**第 $i$ 条称量数据有误时能求出一种合法方案且我们**假定**第 $j$ 条称量数据有误时也能求出一种合法方案。\n\n合法方案定义如下：\n\n1、最重的三角形只有一个。\n\n2、不存在重量不确定的三角形。\n\n3、所有三角形的重量均为正整数。", "inputFormat": "输入的第一行为一个正整数 $n$，表示小三角形的数目。\n\n接下来 $n + 1$ 行，每行按照以下格式输入：\n\n首先是一个正整数 $m$，表示这次称量抓了几个小三角形。\n\n接下来 $m$ 个整数，表示称量的小三角形的编号。\n\n最后一个整数 $weight$ ，表示这次称量的结果。", "outputFormat": "若合法，输出最重小三角形的编号，否则输出 \"illegal\"(不含引号)。", "hint": "样例一：\n\n若第一次称量结果错误，则无法得出正确解。\n\n若第二次称量结果错误，则第二个小三角形重量为负，显然不对。\n\n若第三次称量结果错误，我们得出 $1$ 号小三角形重量为 $2$，$2$号小三角形重量为 $3$，$2$号小三角形最重。\n\n本题采用捆绑测试，共有三个 $subtask$，描述如下：\n\n$subtask 0 - 30Pts$ 保证小三角形的重量 <= 20且 $n <= 5$，在这个 $subtask$ 中，你每通过一个点可获得 $10$ 分。\n\n$subtask 1 - 30Pts$ 保证小三角形的重量 <= 100 并且 $n <= 100$，数据为随机生成。\n\n$subtask 2 - 40Pts$ 保证小三角形的重量 <= 100 并且 $n <= 100$\n\n在后两个 $subtask$ 中，你必须通过所有数据才能得分。\n\n对于 $100\\%$ 的数据， $1 <= m <= n$", "locale": "zh-CN", "translations": {"en": {"title": "Barracuda", "background": "The small square’s adventure journey has not been smooth.\n\nAlong the way, the small square saw magnificent and beautiful islands being polluted, saw grand volcanoes, and encountered many enemies.\n\nNow, the small square is dealing with a huge triangle.", "description": "The big triangle tells the small square about its past: it used to be a treasure miner, but later it was corrupted by the Lord of Darkness and ended up like this.\n\nIt also hopes that the small square can defeat the Lord of Darkness, but because the Lord of Darkness has spies everywhere, it must set obstacles for the small square to fool those “spies”.\n\nThe problem it gives to the small square is: it has $n$ small triangles, and each small triangle has a certain weight. It performed $n + 1$ weighings on these triangles; however, due to an issue with the pan balance (?), one weighing result is wrong.\n\nNow, the big triangle wants to know the index of the heaviest small triangle.\n\nAn input is considered valid if and only if it satisfies the following condition:\n\nThere do not exist two indices $i$, $j$ such that, when we **assume** the $i$-th weighing data is wrong, we can find a valid solution, and when we **assume** the $j$-th weighing data is wrong, we can also find a valid solution.\n\nA valid solution is defined as follows:\n\n1. There is exactly one heaviest triangle.\n\n2. There is no triangle whose weight is undetermined.\n\n3. The weights of all triangles are positive integers.", "inputFormat": "The first line contains a positive integer $n$, representing the number of small triangles.\n\nThe next $n + 1$ lines are given in the following format:\n\nFirst, an integer $m$, representing how many small triangles are grabbed in this weighing.\n\nThen $m$ integers, representing the indices of the small triangles being weighed.\n\nThe last integer $weight$ represents the result of this weighing.", "outputFormat": "If it is valid, output the index of the heaviest small triangle; otherwise output \"illegal\" (without quotes).", "hint": "Sample 1:\n\nIf the result of the first weighing is wrong, then a correct solution cannot be obtained.\n\nIf the result of the second weighing is wrong, then the weight of the second small triangle is negative, which is obviously not correct.\n\nIf the result of the third weighing is wrong, we obtain that triangle $1$ has weight $2$, triangle $2$ has weight $3$, and triangle $2$ is the heaviest.\n\nThis problem uses bundled testdata and has three $subtask$s, described as follows:\n\n$subtask 0 - 30Pts$: It is guaranteed that the weights of small triangles are <= 20 and $n <= 5$. In this $subtask$, you can get $10$ points for each test you pass.\n\n$subtask 1 - 30Pts$: It is guaranteed that the weights of small triangles are <= 100 and $n <= 100$. The testdata are randomly generated.\n\n$subtask 2 - 40Pts$: It is guaranteed that the weights of small triangles are <= 100 and $n <= 100$.\n\nIn the last two $subtask$s, you must pass all testdata to get any score.\n\nFor $100\\%$ of the testdata, $1 <= m <= n$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Barracuda", "background": "小正方形的冒险旅途，并不顺利。\n\n一路上，小正方形看到了壮美秀丽的小岛被污染，看到了雄伟壮观的火山，还碰到了许许多多的敌人。\n\n眼下，小正方形正在对付一个巨大的三角形。", "description": "大三角形给小正方形讲起自己的过去：过去的它是一个挖宝工，后来被黑暗之主污染才会落到此番境地。\n\n它也希望小正方形去战胜黑暗之主，不过限于黑暗之主的眼线密布，因此必须给小正方形设置障碍才能骗过那些“眼线”。\n\n他给小正方形的问题是：它有 $n$ 个小三角形，每个小三角形有一定的质量，它对这些三角形进行了 $n + 1$ 次称量，然而由于托盘天平(?)的问题，有一次称量的结果是有误的。\n\n现在，大三角形想要知道最重的小三角形的 编号。\n\n一组输入是合法的，当且仅当输入满足以下条件：\n\n不存在一组 $i$,$j$，使得当我们**假定**第 $i$ 条称量数据有误时能求出一种合法方案且我们**假定**第 $j$ 条称量数据有误时也能求出一种合法方案。\n\n合法方案定义如下：\n\n1、最重的三角形只有一个。\n\n2、不存在重量不确定的三角形。\n\n3、所有三角形的重量均为正整数。", "inputFormat": "输入的第一行为一个正整数 $n$，表示小三角形的数目。\n\n接下来 $n + 1$ 行，每行按照以下格式输入：\n\n首先是一个正整数 $m$，表示这次称量抓了几个小三角形。\n\n接下来 $m$ 个整数，表示称量的小三角形的编号。\n\n最后一个整数 $weight$ ，表示这次称量的结果。", "outputFormat": "若合法，输出最重小三角形的编号，否则输出 \"illegal\"(不含引号)。", "hint": "样例一：\n\n若第一次称量结果错误，则无法得出正确解。\n\n若第二次称量结果错误，则第二个小三角形重量为负，显然不对。\n\n若第三次称量结果错误，我们得出 $1$ 号小三角形重量为 $2$，$2$号小三角形重量为 $3$，$2$号小三角形最重。\n\n本题采用捆绑测试，共有三个 $subtask$，描述如下：\n\n$subtask 0 - 30Pts$ 保证小三角形的重量 <= 20且 $n <= 5$，在这个 $subtask$ 中，你每通过一个点可获得 $10$ 分。\n\n$subtask 1 - 30Pts$ 保证小三角形的重量 <= 100 并且 $n <= 100$，数据为随机生成。\n\n$subtask 2 - 40Pts$ 保证小三角形的重量 <= 100 并且 $n <= 100$\n\n在后两个 $subtask$ 中，你必须通过所有数据才能得分。\n\n对于 $100\\%$ 的数据， $1 <= m <= n$", "locale": "zh-CN"}}}
{"pid": "P5028", "type": "P", "difficulty": 6, "samples": [["3\nabb\nbcc\naba", "1 2\n1 1\n2 1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2500, 2000, 2000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["字符串", "后缀数组 SA"], "title": "Annihilate", "background": "前情提要：小正方形与黑暗之主展开了大战，最后小正方形击败了黑暗之主，成功从黑暗之主的手上夺下最后一个三角。\n\n三角旋转着，净化着，正当三角即将净化完成时，黑暗之主突然到来，阻断了三角形的净化，吸收了三角的能量。\n\n可是，因为三角的能量太过巨大，导致黑暗之主发生了变异，现在的黑暗之主一次次复制，最终成为了一条蜈蚣……\n\n现在，小正方形还能阻止黑暗之主毁灭世界吗？", "description": "黑暗之主的蜈蚣几乎可以毁灭一切，因此小正方形陷入了苦战……\n\n小正方形现在需要减弱黑暗之主的攻击。\n\n一个黑暗之主的攻击可以用一个仅有小写字母的字符串表示。\n\n现在黑暗之主向小正方形发动了若干攻击，对于两个攻击，小正方形能选出它们最长的公共**子串**，并把这一段消除。\n\n现在小正方形想要知道，对于**任意两个**黑暗之主的攻击，它们的最长公共子串长度是多少，你能帮帮它吗？", "inputFormat": "第一行为一个整数 $n$，表示字符串数目。\n\n接下来 $n$ 行，一行一个字符串，保证所有字符串长度之和不超过 $10^6$。", "outputFormat": "输出共有 $n$ 行，每行 $n - 1$个正整数。\n\n第一行第一个正整数表示第 $1$ 个串与第 $2$ 个串的最长公共子串。\n\n第二个正整数表示第 $1$ 个串与第 $3$ 个串的最长公共子串。\n\n……\n\n第二行第一个正整数表示第 $2$ 个串与第 $1$ 个串的最长公共子串。\n\n以此类推。", "hint": "对于 $30\\%$ 的数据，$n \\le 5$，每个字符串长度不超过 $500$。\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 50$，字符串长度之和不超过 $10^6$。\n\n**注意：本题内存限制仅为 $64$ MB,请尽量使用内存运用优秀的方法。**\n\n另外，对于占 $60$ pts 的测试点，您每通过一个点即可获得 $10$ pts。\n\n对于剩下的测试点，您只有全部通过才能获得 $40$ pts。\n\n**对于所有数据点，不保证数据为随机生成。**", "locale": "zh-CN", "translations": {"en": {"title": "Annihilate", "background": "Previously: The little square and the Lord of Darkness fought a great battle. In the end, the little square defeated the Lord of Darkness and successfully took the last triangle from him.\n\nThe triangle was spinning and purifying. Just as the purification was about to finish, the Lord of Darkness suddenly arrived, interrupted the triangle’s purification, and absorbed the triangle’s energy.\n\nHowever, because the triangle’s energy was too huge, the Lord of Darkness mutated. The current Lord of Darkness keeps duplicating again and again, and eventually became a centipede...\n\nNow, can the little square still stop the Lord of Darkness from destroying the world?", "description": "The centipede of the Lord of Darkness can destroy almost everything, so the little square is trapped in a hard fight...\n\nNow the little square needs to weaken the attacks of the Lord of Darkness.\n\nOne attack of the Lord of Darkness can be represented by a string consisting only of lowercase letters.\n\nNow the Lord of Darkness launches several attacks at the little square. For any two attacks, the little square can find their longest common **substring** and erase that part.\n\nNow the little square wants to know: for **any two** attacks of the Lord of Darkness, what is the length of their longest common substring? Can you help?", "inputFormat": "The first line contains an integer $n$, representing the number of strings.\n\nThe next $n$ lines each contain one string. It is guaranteed that the total length of all strings does not exceed $10^6$.", "outputFormat": "Output a total of $n$ lines, each containing $n - 1$ positive integers.\n\nThe first positive integer in the first line represents the longest common substring of the $1$st string and the $2$nd string.\n\nThe second positive integer represents the longest common substring of the $1$st string and the $3$rd string.\n\n...\n\nThe first positive integer in the second line represents the longest common substring of the $2$nd string and the $1$st string.\n\nAnd so on.", "hint": "For $30\\%$ of the testdata, $n \\le 5$, and the length of each string does not exceed $500$.\n\nFor $100\\%$ of the testdata, $2 \\le n \\le 50$, and the total length of all strings does not exceed $10^6$.\n\n**Note: the memory limit of this problem is only $64$ MB. Please use a method with good memory usage.**\n\nIn addition, for the test points worth $60$ pts, you will get $10$ pts for each point you pass.\n\nFor the remaining test points, you will get $40$ pts only if you pass all of them.\n\n**For all test points, the data is not guaranteed to be randomly generated.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Annihilate", "background": "前情提要：小正方形与黑暗之主展开了大战，最后小正方形击败了黑暗之主，成功从黑暗之主的手上夺下最后一个三角。\n\n三角旋转着，净化着，正当三角即将净化完成时，黑暗之主突然到来，阻断了三角形的净化，吸收了三角的能量。\n\n可是，因为三角的能量太过巨大，导致黑暗之主发生了变异，现在的黑暗之主一次次复制，最终成为了一条蜈蚣……\n\n现在，小正方形还能阻止黑暗之主毁灭世界吗？", "description": "黑暗之主的蜈蚣几乎可以毁灭一切，因此小正方形陷入了苦战……\n\n小正方形现在需要减弱黑暗之主的攻击。\n\n一个黑暗之主的攻击可以用一个仅有小写字母的字符串表示。\n\n现在黑暗之主向小正方形发动了若干攻击，对于两个攻击，小正方形能选出它们最长的公共**子串**，并把这一段消除。\n\n现在小正方形想要知道，对于**任意两个**黑暗之主的攻击，它们的最长公共子串长度是多少，你能帮帮它吗？", "inputFormat": "第一行为一个整数 $n$，表示字符串数目。\n\n接下来 $n$ 行，一行一个字符串，保证所有字符串长度之和不超过 $10^6$。", "outputFormat": "输出共有 $n$ 行，每行 $n - 1$个正整数。\n\n第一行第一个正整数表示第 $1$ 个串与第 $2$ 个串的最长公共子串。\n\n第二个正整数表示第 $1$ 个串与第 $3$ 个串的最长公共子串。\n\n……\n\n第二行第一个正整数表示第 $2$ 个串与第 $1$ 个串的最长公共子串。\n\n以此类推。", "hint": "对于 $30\\%$ 的数据，$n \\le 5$，每个字符串长度不超过 $500$。\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 50$，字符串长度之和不超过 $10^6$。\n\n**注意：本题内存限制仅为 $64$ MB,请尽量使用内存运用优秀的方法。**\n\n另外，对于占 $60$ pts 的测试点，您每通过一个点即可获得 $10$ pts。\n\n对于剩下的测试点，您只有全部通过才能获得 $40$ pts。\n\n**对于所有数据点，不保证数据为随机生成。**", "locale": "zh-CN"}}}
{"pid": "P5029", "type": "P", "difficulty": 6, "samples": [["5 4 5\n1 3 1 3\n1 3 3 2\n1 3 2 5\n4 1 1 1 4 5", "4"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "网络流", "图论建模"], "title": "T'ill It's Over", "background": "小正方形被黑暗之主碾成了粉末。\n\n一切，就这么结束了吗？\n\n就当大家都以为再无翻盘的希望时，\n\n已经被净化的两个世界之树的部分，微微闪烁……", "description": "小正方形被三角的力量复活了，它即将与黑暗之主展开最后的战斗。\n\n小正方形最后的目标，就是净化黑暗之主。\n\n黑暗之主的蜈蚣长度为 $n$，一开始每一节的光明程度为 $1$。\n\n当一节蜈蚣的光明程度达到一个指定的值 ($k$)，我们就视作这节蜈蚣被净化。\n\n为了净化黑暗之主，小正方形准备了 $m$ 种方案，这些方案按本质上的不同大约可分为四种：\n\n1. 将一节光明程度为 $a$ 的蜈蚣的光明程度 变为 $b$。（注意，$b$ 可能 $\\le a$）\n\n2. 将一节光明程度在 $a1$ 到 $a2$ 区间的蜈蚣的光明程度变为 $b1$。\n\n3. 将一节光明程度为 $a1$ 的蜈蚣的光明程度变为 $b1$ 到 $b2$ 区间的任意值。\n\n4. 将一节光明程度在 $a1$ 到 $a2$ 区间的蜈蚣的光明程度变为 $b1$ 到 $b2$ 区间的任意值。\n\n由于小正方形使用每种方案需要消耗一定程度的属性能量，因此每种方案都有一个独立的使用次数的上限，在一种方案中我们用 $l$ 来表示这个上限。\n\n小正方形想要知道，自己最多能够净化几节黑暗之主的蜈蚣。", "inputFormat": "第一行为三个正整数 $n,m,k$，表示黑暗之主蜈蚣身体的长度，小正方形的方案总数与上文所述的 $k$。\n\n接下来 $m$行，每行开头为两个正整数 $op,l$，表示方案的种类与使用次数的上限，方案的输入方式如下：\n\n若 $op = 1$，则接下来两个整数 $a,b$，意义如上文所述。\n\n若 $op = 2$，则接下来三个整数 $a1,a2,b1$，意义如上文所述。\n\n若 $op = 3$，则接下来三个整数 $a1,b1,b2$，意义如上文所述。\n\n若 $op = 4$，则接下来四个整数 $a1,a2,b1,b2$，意义如上文所述。\n\n数据保证，所有 $1 \\le a,b,a1,b1,a2,b2 \\le k$", "outputFormat": "一行一个整数，表示最多能净化的节数。", "hint": "首先使用方案 1，2，3，将三节光明程度变为 $3$，接着再变为 $2$，再变为 $5$。\n\n然后使用方案 4，将一节的光明程度变为 $5$。\n\n对于 $10\\%$ 的数据，$n = 1,op = 1$。\n\n对于另外 $10\\%$ 的数据，$n = 1,op \\le 3$。\n\n对于另外 $10\\%$ 的数据，$n \\le 10,op = 1$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,m \\le 100,op = 1$。\n\n对于 $70\\%$ 的数据，$n  \\le 1000,m \\le 1000,op \\le 3,k \\le 20000$。\n\n**对于前 $70\\%$ 的数据，时限为 $500$ ms**。\n\n对于 $100\\%$ 的数据，$n \\le 10^7,m \\le 20000,1 \\le k \\le 10^5,1 \\le l \\le 10^5$。\n\n**对于后 $30\\%$ 的数据，时限为 $8000$ ms**。\n\n**数据保证，操作为随机生成**。", "locale": "zh-CN", "translations": {"en": {"title": "T'ill It's Over", "background": "The little square was crushed into dust by the Lord of Darkness.\n\nIs everything really over like this?\n\nJust when everyone thought there was no hope of turning the tables,\n\nparts of the two World Trees that had already been purified began to flicker faintly……", "description": "The little square has been revived by the power of the triangle, and it is about to start the final battle with the Lord of Darkness.\n\nThe little square’s final goal is to purify the Lord of Darkness.\n\nThe Lord of Darkness has a centipede body of length $n$, and at the beginning the brightness level of each segment is $1$.\n\nWhen the brightness level of a segment reaches a specified value ($k$), we consider this segment to be purified.\n\nTo purify the Lord of Darkness, the little square has prepared $m$ types of plans. By their essential differences, these plans can be roughly divided into four types:\n\n1. Change the brightness level of a segment with brightness level $a$ to $b$. (Note that $b$ may be $\\le a$.)\n\n2. Change the brightness level of a segment whose brightness level is in the interval from $a1$ to $a2$ to $b1$.\n\n3. Change the brightness level of a segment with brightness level $a1$ to any value in the interval from $b1$ to $b2$.\n\n4. Change the brightness level of a segment whose brightness level is in the interval from $a1$ to $a2$ to any value in the interval from $b1$ to $b2$.\n\nSince using each plan consumes a certain amount of attribute energy, each plan has its own independent upper limit on the number of uses. In one plan, we use $l$ to denote this upper limit.\n\nThe little square wants to know the maximum number of segments of the Lord of Darkness’s centipede that can be purified.", "inputFormat": "The first line contains three positive integers $n, m, k$, representing the length of the Lord of Darkness’s centipede body, the total number of plans, and the $k$ described above.\n\nThe next $m$ lines each start with two positive integers $op, l$, representing the type of the plan and the upper limit on the number of uses. The input for each plan type is as follows:\n\nIf $op = 1$, then two integers $a, b$ follow, with the meaning described above.\n\nIf $op = 2$, then three integers $a1, a2, b1$ follow, with the meaning described above.\n\nIf $op = 3$, then three integers $a1, b1, b2$ follow, with the meaning described above.\n\nIf $op = 4$, then four integers $a1, a2, b1, b2$ follow, with the meaning described above.\n\nThe data guarantees that all $1 \\le a, b, a1, b1, a2, b2 \\le k$.", "outputFormat": "Output one integer in a single line, representing the maximum number of segments that can be purified.", "hint": "First use plans 1, 2, and 3 to change the brightness levels of three segments to $3$, then change them to $2$, and then to $5$.\n\nThen use plan 4 to change the brightness level of one segment to $5$.\n\nFor $10\\%$ of the testdata, $n = 1, op = 1$.\n\nFor another $10\\%$ of the testdata, $n = 1, op \\le 3$.\n\nFor another $10\\%$ of the testdata, $n \\le 10, op = 1$.\n\nFor another $20\\%$ of the testdata, $n \\le 100, m \\le 100, op = 1$.\n\nFor $70\\%$ of the testdata, $n \\le 1000, m \\le 1000, op \\le 3, k \\le 20000$.\n\n**For the first $70\\%$ of the testdata, the time limit is $500$ ms**.\n\nFor $100\\%$ of the testdata, $n \\le 10^7, m \\le 20000, 1 \\le k \\le 10^5, 1 \\le l \\le 10^5$.\n\n**For the last $30\\%$ of the testdata, the time limit is $8000$ ms**.\n\n**The data guarantees that the operations are randomly generated**.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "T'ill It's Over", "background": "小正方形被黑暗之主碾成了粉末。\n\n一切，就这么结束了吗？\n\n就当大家都以为再无翻盘的希望时，\n\n已经被净化的两个世界之树的部分，微微闪烁……", "description": "小正方形被三角的力量复活了，它即将与黑暗之主展开最后的战斗。\n\n小正方形最后的目标，就是净化黑暗之主。\n\n黑暗之主的蜈蚣长度为 $n$，一开始每一节的光明程度为 $1$。\n\n当一节蜈蚣的光明程度达到一个指定的值 ($k$)，我们就视作这节蜈蚣被净化。\n\n为了净化黑暗之主，小正方形准备了 $m$ 种方案，这些方案按本质上的不同大约可分为四种：\n\n1. 将一节光明程度为 $a$ 的蜈蚣的光明程度 变为 $b$。（注意，$b$ 可能 $\\le a$）\n\n2. 将一节光明程度在 $a1$ 到 $a2$ 区间的蜈蚣的光明程度变为 $b1$。\n\n3. 将一节光明程度为 $a1$ 的蜈蚣的光明程度变为 $b1$ 到 $b2$ 区间的任意值。\n\n4. 将一节光明程度在 $a1$ 到 $a2$ 区间的蜈蚣的光明程度变为 $b1$ 到 $b2$ 区间的任意值。\n\n由于小正方形使用每种方案需要消耗一定程度的属性能量，因此每种方案都有一个独立的使用次数的上限，在一种方案中我们用 $l$ 来表示这个上限。\n\n小正方形想要知道，自己最多能够净化几节黑暗之主的蜈蚣。", "inputFormat": "第一行为三个正整数 $n,m,k$，表示黑暗之主蜈蚣身体的长度，小正方形的方案总数与上文所述的 $k$。\n\n接下来 $m$行，每行开头为两个正整数 $op,l$，表示方案的种类与使用次数的上限，方案的输入方式如下：\n\n若 $op = 1$，则接下来两个整数 $a,b$，意义如上文所述。\n\n若 $op = 2$，则接下来三个整数 $a1,a2,b1$，意义如上文所述。\n\n若 $op = 3$，则接下来三个整数 $a1,b1,b2$，意义如上文所述。\n\n若 $op = 4$，则接下来四个整数 $a1,a2,b1,b2$，意义如上文所述。\n\n数据保证，所有 $1 \\le a,b,a1,b1,a2,b2 \\le k$", "outputFormat": "一行一个整数，表示最多能净化的节数。", "hint": "首先使用方案 1，2，3，将三节光明程度变为 $3$，接着再变为 $2$，再变为 $5$。\n\n然后使用方案 4，将一节的光明程度变为 $5$。\n\n对于 $10\\%$ 的数据，$n = 1,op = 1$。\n\n对于另外 $10\\%$ 的数据，$n = 1,op \\le 3$。\n\n对于另外 $10\\%$ 的数据，$n \\le 10,op = 1$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,m \\le 100,op = 1$。\n\n对于 $70\\%$ 的数据，$n  \\le 1000,m \\le 1000,op \\le 3,k \\le 20000$。\n\n**对于前 $70\\%$ 的数据，时限为 $500$ ms**。\n\n对于 $100\\%$ 的数据，$n \\le 10^7,m \\le 20000,1 \\le k \\le 10^5,1 \\le l \\le 10^5$。\n\n**对于后 $30\\%$ 的数据，时限为 $8000$ ms**。\n\n**数据保证，操作为随机生成**。", "locale": "zh-CN"}}}
{"pid": "P5030", "type": "P", "difficulty": 5, "samples": [["2 2 1\n1 1", "3"], ["8 7 5\n1 1\n5 4\n2 3\n4 7\n8 3", "28"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["网络流", "二分图"], "title": "长脖子鹿放置", "background": "众所周知，在西洋棋中，我们有城堡、骑士、皇后、主教和长脖子鹿。", "description": "如图所示，西洋棋的“长脖子鹿”，类似于中国象棋的马，但按照“目”字攻击，且没有中国象棋“别马腿”的规则。（因为长脖子鹿没有马腿）\n\n![horse](https://cdn.luogu.com.cn/upload/pic/37260.png)\n\n给定一个 $N \\times M$ 的棋盘，有一些格子禁止放棋子。问棋盘上最多能放多少个不能互相攻击的长脖子鹿。", "inputFormat": "输入的第一行为两个正整数 $N,M,K$。其中 $K$ 表示禁止放置长脖子鹿的格子数。\n\n输入的第 $2 \\sim K+1$ 行每一行为两个整数 $X_i, Y_i$，表示禁止放置的格子。\n\n不保证禁止放置的格子互不相同。", "outputFormat": "一行一个正整数，表示最多能放置的长脖子鹿个数。", "hint": "对于 $10\\%$ 的数据，$1 \\le N,M \\le 5$；\n\n对于 $30\\%$ 的数据，$1 \\le N,M \\le 10$；\n\n对于 $60\\%$ 的数据，$1 \\le N,M \\le 50$；\n\n对于 $80\\%$ 的数据，$1 \\le N,M \\le 100$；\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 200$。", "locale": "zh-CN", "translations": {"en": {"title": "Long-necked Giraffe Placement", "background": "As everyone knows, in chess, we have rooks, knights, queens, bishops, and long-necked giraffes.", "description": "As shown in the picture, the chess piece \"long-necked giraffe\" is similar to the knight in Chinese chess, but it attacks in a \"目\" shape, and there is no rule like the Chinese chess \"blocking the horse's leg\" (because the long-necked giraffe has no legs).\n\n![horse](https://cdn.luogu.com.cn/upload/pic/37260.png)\n\nGiven an $N \\times M$ chessboard, some cells are forbidden to place pieces. Find the maximum number of long-necked giraffes that can be placed on the board such that none of them can attack each other.", "inputFormat": "The first line contains two positive integers $N, M, K$. Here, $K$ is the number of cells where placing a long-necked giraffe is forbidden.\n\nLines $2$ to $K + 1$ each contain two integers $X_i, Y_i$, indicating a forbidden cell.\n\nIt is not guaranteed that the forbidden cells are all distinct.", "outputFormat": "Output one positive integer in a single line, representing the maximum number of long-necked giraffes that can be placed.", "hint": "For $10\\%$ of the testdata, $1 \\le N, M \\le 5$.\n\nFor $30\\%$ of the testdata, $1 \\le N, M \\le 10$.\n\nFor $60\\%$ of the testdata, $1 \\le N, M \\le 50$.\n\nFor $80\\%$ of the testdata, $1 \\le N, M \\le 100$.\n\nFor $100\\%$ of the testdata, $1 \\le N, M \\le 200$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "长脖子鹿放置", "background": "众所周知，在西洋棋中，我们有城堡、骑士、皇后、主教和长脖子鹿。", "description": "如图所示，西洋棋的“长脖子鹿”，类似于中国象棋的马，但按照“目”字攻击，且没有中国象棋“别马腿”的规则。（因为长脖子鹿没有马腿）\n\n![horse](https://cdn.luogu.com.cn/upload/pic/37260.png)\n\n给定一个 $N \\times M$ 的棋盘，有一些格子禁止放棋子。问棋盘上最多能放多少个不能互相攻击的长脖子鹿。", "inputFormat": "输入的第一行为两个正整数 $N,M,K$。其中 $K$ 表示禁止放置长脖子鹿的格子数。\n\n输入的第 $2 \\sim K+1$ 行每一行为两个整数 $X_i, Y_i$，表示禁止放置的格子。\n\n不保证禁止放置的格子互不相同。", "outputFormat": "一行一个正整数，表示最多能放置的长脖子鹿个数。", "hint": "对于 $10\\%$ 的数据，$1 \\le N,M \\le 5$；\n\n对于 $30\\%$ 的数据，$1 \\le N,M \\le 10$；\n\n对于 $60\\%$ 的数据，$1 \\le N,M \\le 50$；\n\n对于 $80\\%$ 的数据，$1 \\le N,M \\le 100$；\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 200$。", "locale": "zh-CN"}}}
{"pid": "P5031", "type": "P", "difficulty": 5, "samples": [["2 2", "2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "庞氏骗局", "background": "众所周知，庞氏骗局就是借新债还就债的骗术，隐瞒企业已经大开倒车的真相，保持虚假的增长。", "description": "庞氏骗局源自于一个名叫查尔斯•庞兹的人。1919 年，他故弄玄虚，设计了一份假金融企划向大众兜售。借此，坑骗了成千上万的波士顿的长脖子鹿，套走了近 1500 万美金。\n\n查尔斯•庞兹的骗局计划分为两部分，第一次他向 $K_1$ 名长脖子鹿展示了自己的创业计划，向每一头长脖子鹿要来了 $1$ 万元的投资。第二次他向 $K_2$ 名长脖子鹿展示了自己的创业计划，由于第二次需要填补第一次的亏空，所以向每一头长脖子鹿要来了 $2$ 万元的投资。\n\n现在，查尔斯•庞兹拥有了 $K_1$ 份 $1$ 万元和 $K_2$ 份 $2$ 万元，他希望通过一种特定的方式消费从而躲避美国税务局（IRS）的追查。每一天，他都会选择两份钱，各消费 $1$ 万元。为了进一步减轻自己的嫌疑，他每天选择的两份钱不会与之前重复。他想知道，花光所有的钱，共有多少不同的方案集合，**即方案内没有先后顺序，每一天不分先后**。\n\n例如：第一天选择了从 $(1,2)$ 两只长脖子鹿那里拿钱，第二天不能花 $(1,2)$ 两只长脖子鹿的钱，但可以从 $(2,3)$ 或 $(1,3)$ 这样的长脖子鹿组中拿钱。\n\n方案数对 $10^9+7$ 取模。", "inputFormat": "一行，两个正整数，$K_1,K_2$。", "outputFormat": "一行，一个正整数，方案数。", "hint": "##### 样例解释\n\n我们设 $1,2$ 号长颈鹿给了 $1$ 万元，$3,4$ 号长颈鹿给了 $2$ 万元。\n\n方案一为这样的方案集合${(1,3),(3,4),(2,4)}$。\n\n方案二位这样的方案集合${(1,4),(3,4),(2,3)}$。\n\n![](https://cdn.luogu.com.cn/upload/pic/40820.png)", "locale": "zh-CN", "translations": {"en": {"title": "Ponzi Scheme", "background": "As everyone knows, a Ponzi scheme is a scam that uses new debt to pay off old debt, hiding the truth that the business has already gone downhill, while maintaining fake growth.", "description": "The Ponzi scheme originated from a man named Charles Ponzi. In 1919, he created a mysterious-looking fake financial plan and sold it to the public. In this way, he cheated tens of thousands of long-necked giraffes in Boston, taking nearly 15 million US dollars from them.\n\nCharles Ponzi’s scam plan has two parts. The first time, he showed his startup plan to $K_1$ giraffes, and asked each giraffe for an investment of 10,000 yuan. The second time, he showed his startup plan to $K_2$ giraffes. Since the second time needed to cover the losses from the first time, he asked each giraffe for an investment of 20,000 yuan.\n\nNow, Charles Ponzi has $K_1$ amounts of 10,000 yuan and $K_2$ amounts of 20,000 yuan. He hopes to spend the money in a specific way to avoid being tracked by the IRS. Every day, he will choose two amounts of money, and spend 10,000 yuan from each of them. To further reduce suspicion, the two amounts he chooses each day will not repeat any pair chosen before. He wants to know: after spending all the money, how many different sets of plans are there, **that is, there is no order inside a plan set, and the days are also unordered**.\n\nFor example, if on the first day he chooses money from giraffes $(1,2)$, then on the second day he cannot spend money from giraffes $(1,2)$ again, but he can take money from a giraffe pair such as $(2,3)$ or $(1,3)$.\n\nOutput the number of plans modulo $10^9+7$.", "inputFormat": "One line with two positive integers, $K_1,K_2$.", "outputFormat": "One line with one positive integer, the number of plans.", "hint": "##### Sample Explanation\n\nSuppose giraffes $1,2$ each gave 10,000 yuan, and giraffes $3,4$ each gave 20,000 yuan.\n\nPlan 1 is the plan set ${(1,3),(3,4),(2,4)}$.\n\nPlan 2 is the plan set ${(1,4),(3,4),(2,3)}$.\n\n![](https://cdn.luogu.com.cn/upload/pic/40820.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "庞氏骗局", "background": "众所周知，庞氏骗局就是借新债还就债的骗术，隐瞒企业已经大开倒车的真相，保持虚假的增长。", "description": "庞氏骗局源自于一个名叫查尔斯•庞兹的人。1919 年，他故弄玄虚，设计了一份假金融企划向大众兜售。借此，坑骗了成千上万的波士顿的长脖子鹿，套走了近 1500 万美金。\n\n查尔斯•庞兹的骗局计划分为两部分，第一次他向 $K_1$ 名长脖子鹿展示了自己的创业计划，向每一头长脖子鹿要来了 $1$ 万元的投资。第二次他向 $K_2$ 名长脖子鹿展示了自己的创业计划，由于第二次需要填补第一次的亏空，所以向每一头长脖子鹿要来了 $2$ 万元的投资。\n\n现在，查尔斯•庞兹拥有了 $K_1$ 份 $1$ 万元和 $K_2$ 份 $2$ 万元，他希望通过一种特定的方式消费从而躲避美国税务局（IRS）的追查。每一天，他都会选择两份钱，各消费 $1$ 万元。为了进一步减轻自己的嫌疑，他每天选择的两份钱不会与之前重复。他想知道，花光所有的钱，共有多少不同的方案集合，**即方案内没有先后顺序，每一天不分先后**。\n\n例如：第一天选择了从 $(1,2)$ 两只长脖子鹿那里拿钱，第二天不能花 $(1,2)$ 两只长脖子鹿的钱，但可以从 $(2,3)$ 或 $(1,3)$ 这样的长脖子鹿组中拿钱。\n\n方案数对 $10^9+7$ 取模。", "inputFormat": "一行，两个正整数，$K_1,K_2$。", "outputFormat": "一行，一个正整数，方案数。", "hint": "##### 样例解释\n\n我们设 $1,2$ 号长颈鹿给了 $1$ 万元，$3,4$ 号长颈鹿给了 $2$ 万元。\n\n方案一为这样的方案集合${(1,3),(3,4),(2,4)}$。\n\n方案二位这样的方案集合${(1,4),(3,4),(2,3)}$。\n\n![](https://cdn.luogu.com.cn/upload/pic/40820.png)", "locale": "zh-CN"}}}
{"pid": "P5032", "type": "P", "difficulty": 5, "samples": [["5\n1 1 2 3 4", "-1"], ["4\n1 1 1 1", "7"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递归", "O2优化", "优先队列", "队列"], "title": "经验", "background": "[赛时答疑](https://www.luogu.org/discuss/show/80694)  \n\n**简略版已经更新，时限改为 500ms**。\n\n攒够经验附魔去~~\n\nSteve 在 Minecraft 中总是会遇上难题：\n他想要修理 $n$ 本附魔书，每本附魔书的等级为 $a_i$，他总是不知道铁砧修理和经验值的机制。他便在 wiki 上搜索到了一些资料：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7qa0g8xy.png)\n\n——图为经验值与等级的关系。\n\n他看到这个图，就想：我等级升的越高，我所需要的经验值便越多，那么如果我等级刚好够铁砧修理的话，那我所耗费的经验不就越少了吗？他便继续搜索了下去，并将铁砧机制附在了下面,让你帮他解决问题。", "description": "#### 累积惩罚\n\n无论是重命名、修复、还是合并操作，其经验花费都会因其物品先前在铁砧上的操作而增加，这些额外增加的花费被称作“累积惩罚”。对于一件从未放上铁砧的物品，累积惩罚为 $0$。\n\n一个物品每次在铁砧上操作过后（不包括重命名），其累积惩罚都会先乘 $2$ 再加 $1$。如此一来，一个物品在操作过 $N$ 次后累积惩罚是 $2^N-1$。$6$ 次操作之后，累积惩罚是 $63$ 级，此时生存模式下无法再作进一步的修复和附魔工作。$31$ 次操作后，惩罚等级是 $2147483647$ 级，此时在任何模式下都不能再进行操作。\n\n当合并两个物品时，玩家会同时受到两件物品的累积惩罚。合并后物品的累积惩罚根据先前两个物品中较高者计算。例如，合并两个累积惩罚分别是 $3$ 级和 $15$ 级的物品会额外花费 $18$ 级的惩罚经验，而合并后的物品惩罚是 $31$ 级（$15 \\times 2+1$）。\n\n累积惩罚甚至会作用在不会磨损的物品上，譬如附魔书。因此，合并 $4$ 本时运 I 的附魔书，会得到一本累积惩罚为 $3$ 的时运 III 附魔书。\n\n|累计操作数|惩罚|\n|:--:|:--:|\n|$0$|$0$|\n|$1$|$1$|\n|$2$|$3$|\n|$3$|$7$|\n|$4$|$15$|\n|$5$|$31$|\n\n使用合成方格进行的物品修复操作会移除所有累积惩罚，但也会丢失所有的魔咒。\n\n#### 合并物品\n\n铁砧界面中第一格/左边的物品称为目标物品；第二格/右边的物品称为牺牲物品——合并后会消失。如果牺牲物品附有魔咒，铁砧会同时试图将牺牲物品的附魔合并至目标物品上。无论目标物品上的魔咒是否产生实际变化，铁砧都将根据目标物品与牺牲物品上的魔咒收取玩家的等级耗费。\n\n对于牺牲物品上的每个魔咒来说，如果目标物品也拥有相同的魔咒：\n\n- 当牺牲物品的魔咒等级较高时，目标物品魔咒的等级将上升至牺牲物品上的等级。\n\n- 当牺牲物品的魔咒等级相同时，目标物品上魔咒的等级将提升 $1$ 级，除非其等级已为最高。    \n\n- 当牺牲物品的魔咒等级较低时，目标物品上该魔咒的等级不变。\n    \n合并物品的总花费将是下列费用之和：\n\n1. 目标物品和牺牲物品的累积惩罚之和。\n\n2. 如果同时进行重命名，则额外产生重命名的费用。\n\n3. 如果目标物品耐久度未满，则耗费 $2$ 级用于维修。\n\n4. 如果牺牲物品拥有魔咒，则产生附魔费用。\n\n5. 如果牺牲物品是一本附魔书，则不会产生维修费用，铁砧会尝试将书本上的魔咒合并至目标物品上。亦可同时对目标物品进行重命名。此时的附魔花费一般会少于合并两个类似物品的费用。\n\n——摘自 mcwiki，稍作删改。\n\n#### 简略版\n\n给出附魔书，只有同等等级的才能合并。合并的代价为两本书的累计代价之和。合成后的书的累计代价为合成前最大代价的 $2$ 倍加上 $1$。求最高等级和最小花费（要求最高等级为第一关键字），Steve 因为开了挂，所以最高等级不限。\n\n现给出 $n$ 本附魔书，每本附魔书有它的等级 $a_i$，问如何才能得到附魔书的最大等级 $x$，在此基础上，请计算合成它消耗的最小等级 $y$（我们假设每本附魔书初始的累积惩罚为 $1$）。\n\nSteve 很懒，他不想看上面的话，他只想要让你编写出一个程序计算出 $x$ 与 $y$。但 Steve 为了不外传，他只要求你输出 $x$ 在模 $y$ 意义下的乘法逆元 $k$ 即可。如果没有，请输出 $-1$。", "inputFormat": "第一行为一个整数 $n$。\n\n接下来 $n$ 行，每行均有一个整数 $a_i$，表示每本附魔书的初始等级，不保证数据有序。", "outputFormat": "一个整数 $k$，表示 $x$ 在模 $y$ 意义下的乘法逆元，如果没有，请输出 $-1$。  \n\nPS：乘法逆元 $k$ 也可以这样理解：$k$ 是使得 $kx \\equiv 1 \\pmod y$的最小正整数。", "hint": "### 样例解释\n \n第一个样例：\n\n合并两个第一等级的，合并花费 $2$ 经验，代价升为 $3$；  \n再合并两个第二等级的，花费 $3+1=4$ 经验，代价升为 $7$；  \n再合并两个第三等级的，花费 $7+1=8$ 经验，代价升为 $15$；  \n最后合并两个第四等级的，花费 $15+1=16$ 经验，代价升为 $31$。  \n\n经验总花费：$2+4+8+16=30$，最大等级：$5$。\n\n\n对于第一个样例: $x=5,y=30$；\n\n对于第二个样例: $x=3,y=10$。\n\n### 数据范围\n\n![]( https://cdn.luogu.com.cn/upload/pic/41547.png )\n\n保证数据随机，$x,y,k$ 在 `long int` 范围内。\n\n### 温馨提示\n\n本题读入量较大，请使用较快的读入方法，在此，提供一种快速读入的样式：（需包含头文件 `<cctype>`）\n\n```cpp\n#include<cctype>\ninline void read(int &x){\n     char ch=getchar();x=0;\n     while(!isdigit(ch))   ch=getchar();\n     while(isdigit(ch))   x=x*10+ch-'0',ch=getchar();\n}\n```", "locale": "zh-CN", "translations": {"en": {"title": "Experience", "background": "[In-contest Q&A](https://www.luogu.org/discuss/show/80694).\n\n**The simplified version has been updated, and the time limit has been changed to 500 ms.**\n\nSave up enough experience to enchant~~\n\nSteve often runs into problems in Minecraft:\nHe wants to repair $n$ enchanted books, and the level of each book is $a_i$. He never really understands the anvil repair and experience mechanisms, so he searched for some information on the wiki:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7qa0g8xy.png)\n\n—The figure shows the relationship between experience and level.\n\nAfter seeing this figure, he thought: the higher my level is, the more experience I need. So if my level is just enough for anvil repairing, wouldn’t I spend the least experience? He continued searching and attached the anvil mechanism below, asking you to help him solve the problem.", "description": "#### Prior Work Penalty\n\nWhether it is renaming, repairing, or combining, the experience cost increases due to the item’s previous operations on an anvil. This extra cost is called the “prior work penalty”. For an item that has never been put on an anvil, the prior work penalty is $0$.\n\nAfter each anvil operation on an item (excluding renaming), its prior work penalty is multiplied by $2$ and then increased by $1$. Therefore, after $N$ operations, the prior work penalty is $2^N-1$. After $6$ operations, the prior work penalty is $63$ levels, and in survival mode no further repairing or enchanting can be done. After $31$ operations, the penalty level is $2147483647$, and no operations can be done in any mode.\n\nWhen combining two items, the player suffers the prior work penalties of both items at the same time. The prior work penalty of the combined item is calculated based on the higher one of the two items. For example, combining two items with prior work penalties of $3$ and $15$ will add an extra penalty cost of $18$ levels, and the resulting item’s penalty is $31$ ($15 \\times 2+1$).\n\nThe prior work penalty even applies to items that do not wear out, such as enchanted books. Therefore, combining $4$ Fortune I enchanted books will produce a Fortune III enchanted book with a prior work penalty of $3$.\n\n|Total operation count|Penalty|\n|:--:|:--:|\n|$0$|$0$|\n|$1$|$1$|\n|$2$|$3$|\n|$3$|$7$|\n|$4$|$15$|\n|$5$|$31$|\n\nRepairing items using the crafting grid removes all prior work penalties, but it also removes all enchantments.\n\n#### Combining Items\n\nIn the anvil interface, the item in the first slot/on the left is called the target item; the item in the second slot/on the right is called the sacrifice item—it will disappear after combining. If the sacrifice item has enchantments, the anvil will also try to merge the sacrifice item’s enchantments into the target item. Regardless of whether the enchantments on the target item actually change, the anvil will charge the player a level cost based on the enchantments on both the target item and the sacrifice item.\n\nFor each enchantment on the sacrifice item, if the target item also has the same enchantment:\n\n- If the sacrifice item’s enchantment level is higher, the target item’s enchantment level will increase to the sacrifice item’s level.\n\n- If the sacrifice item’s enchantment level is the same, the target item’s enchantment level will increase by $1$ level, unless it is already at the maximum level.\n\n- If the sacrifice item’s enchantment level is lower, the target item’s enchantment level does not change.\n\nThe total cost of combining items is the sum of the following costs:\n\n1. The sum of the target item’s and the sacrifice item’s prior work penalties.\n\n2. If renaming is also performed, an additional renaming cost is added.\n\n3. If the target item’s durability is not full, it costs $2$ levels for repairing.\n\n4. If the sacrifice item has enchantments, an enchanting cost is added.\n\n5. If the sacrifice item is an enchanted book, there is no repairing cost. The anvil will attempt to merge the book’s enchantments into the target item. Renaming the target item can also be performed at the same time. In this case, the enchanting cost is usually less than the cost of combining two similar items.\n\n—Adapted from mcwiki with minor edits.\n\n#### Simplified Version\n\nYou are given enchanted books. Only books of the same level can be combined. The cost of combining is the sum of the two books’ accumulated costs. The accumulated cost of the resulting book becomes $2$ times the maximum accumulated cost before combining, plus $1$. Find the highest level and the minimum cost (the highest level is the primary objective). Steve is using cheats, so the highest level is unlimited.\n\nNow you are given $n$ enchanted books, and each book has its level $a_i$. Ask how to obtain the maximum level $x$ of an enchanted book. On this basis, compute the minimum level cost $y$ to combine it (we assume the initial prior work penalty of each book is $1$).\n\nSteve is lazy. He does not want to read the above text; he only wants you to write a program to compute $x$ and $y$. But to prevent it from being spread, he only asks you to output $k$, the multiplicative inverse of $x$ modulo $y$. If it does not exist, output $-1$.", "inputFormat": "The first line contains an integer $n$.\n\nIn the next $n$ lines, each line contains an integer $a_i$, representing the initial level of each enchanted book. The data is not guaranteed to be sorted.", "outputFormat": "Output one integer $k$, representing the multiplicative inverse of $x$ modulo $y$. If it does not exist, output $-1$.\n\nPS: The multiplicative inverse $k$ can also be understood as: $k$ is the smallest positive integer such that $kx \\equiv 1 \\pmod y$.", "hint": "### Sample Explanation\n\nThe first sample:\n\nCombine two level $1$ books: cost $2$ experience, accumulated cost becomes $3$;  \nThen combine two level $2$ books: cost $3+1=4$ experience, accumulated cost becomes $7$;  \nThen combine two level $3$ books: cost $7+1=8$ experience, accumulated cost becomes $15$;  \nFinally combine two level $4$ books: cost $15+1=16$ experience, accumulated cost becomes $31$.\n\nTotal experience cost: $2+4+8+16=30$, maximum level: $5$.\n\nFor the first sample: $x=5,y=30$.\n\nFor the second sample: $x=3,y=10$.\n\n### Constraints\n\n![]( https://cdn.luogu.com.cn/upload/pic/41547.png )\n\nThe data is guaranteed to be random, and $x,y,k$ are within the range of `long int`.\n\n### Friendly Reminder\n\nThe input size of this problem is large, so please use a fast input method. Here is an example of fast input (requires including the header `<cctype>`):\n\n```cpp\n#include<cctype>\ninline void read(int &x){\n     char ch=getchar();x=0;\n     while(!isdigit(ch))   ch=getchar();\n     while(isdigit(ch))   x=x*10+ch-'0',ch=getchar();\n}\n```\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "经验", "background": "[赛时答疑](https://www.luogu.org/discuss/show/80694)  \n\n**简略版已经更新，时限改为 500ms**。\n\n攒够经验附魔去~~\n\nSteve 在 Minecraft 中总是会遇上难题：\n他想要修理 $n$ 本附魔书，每本附魔书的等级为 $a_i$，他总是不知道铁砧修理和经验值的机制。他便在 wiki 上搜索到了一些资料：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7qa0g8xy.png)\n\n——图为经验值与等级的关系。\n\n他看到这个图，就想：我等级升的越高，我所需要的经验值便越多，那么如果我等级刚好够铁砧修理的话，那我所耗费的经验不就越少了吗？他便继续搜索了下去，并将铁砧机制附在了下面,让你帮他解决问题。", "description": "#### 累积惩罚\n\n无论是重命名、修复、还是合并操作，其经验花费都会因其物品先前在铁砧上的操作而增加，这些额外增加的花费被称作“累积惩罚”。对于一件从未放上铁砧的物品，累积惩罚为 $0$。\n\n一个物品每次在铁砧上操作过后（不包括重命名），其累积惩罚都会先乘 $2$ 再加 $1$。如此一来，一个物品在操作过 $N$ 次后累积惩罚是 $2^N-1$。$6$ 次操作之后，累积惩罚是 $63$ 级，此时生存模式下无法再作进一步的修复和附魔工作。$31$ 次操作后，惩罚等级是 $2147483647$ 级，此时在任何模式下都不能再进行操作。\n\n当合并两个物品时，玩家会同时受到两件物品的累积惩罚。合并后物品的累积惩罚根据先前两个物品中较高者计算。例如，合并两个累积惩罚分别是 $3$ 级和 $15$ 级的物品会额外花费 $18$ 级的惩罚经验，而合并后的物品惩罚是 $31$ 级（$15 \\times 2+1$）。\n\n累积惩罚甚至会作用在不会磨损的物品上，譬如附魔书。因此，合并 $4$ 本时运 I 的附魔书，会得到一本累积惩罚为 $3$ 的时运 III 附魔书。\n\n|累计操作数|惩罚|\n|:--:|:--:|\n|$0$|$0$|\n|$1$|$1$|\n|$2$|$3$|\n|$3$|$7$|\n|$4$|$15$|\n|$5$|$31$|\n\n使用合成方格进行的物品修复操作会移除所有累积惩罚，但也会丢失所有的魔咒。\n\n#### 合并物品\n\n铁砧界面中第一格/左边的物品称为目标物品；第二格/右边的物品称为牺牲物品——合并后会消失。如果牺牲物品附有魔咒，铁砧会同时试图将牺牲物品的附魔合并至目标物品上。无论目标物品上的魔咒是否产生实际变化，铁砧都将根据目标物品与牺牲物品上的魔咒收取玩家的等级耗费。\n\n对于牺牲物品上的每个魔咒来说，如果目标物品也拥有相同的魔咒：\n\n- 当牺牲物品的魔咒等级较高时，目标物品魔咒的等级将上升至牺牲物品上的等级。\n\n- 当牺牲物品的魔咒等级相同时，目标物品上魔咒的等级将提升 $1$ 级，除非其等级已为最高。    \n\n- 当牺牲物品的魔咒等级较低时，目标物品上该魔咒的等级不变。\n    \n合并物品的总花费将是下列费用之和：\n\n1. 目标物品和牺牲物品的累积惩罚之和。\n\n2. 如果同时进行重命名，则额外产生重命名的费用。\n\n3. 如果目标物品耐久度未满，则耗费 $2$ 级用于维修。\n\n4. 如果牺牲物品拥有魔咒，则产生附魔费用。\n\n5. 如果牺牲物品是一本附魔书，则不会产生维修费用，铁砧会尝试将书本上的魔咒合并至目标物品上。亦可同时对目标物品进行重命名。此时的附魔花费一般会少于合并两个类似物品的费用。\n\n——摘自 mcwiki，稍作删改。\n\n#### 简略版\n\n给出附魔书，只有同等等级的才能合并。合并的代价为两本书的累计代价之和。合成后的书的累计代价为合成前最大代价的 $2$ 倍加上 $1$。求最高等级和最小花费（要求最高等级为第一关键字），Steve 因为开了挂，所以最高等级不限。\n\n现给出 $n$ 本附魔书，每本附魔书有它的等级 $a_i$，问如何才能得到附魔书的最大等级 $x$，在此基础上，请计算合成它消耗的最小等级 $y$（我们假设每本附魔书初始的累积惩罚为 $1$）。\n\nSteve 很懒，他不想看上面的话，他只想要让你编写出一个程序计算出 $x$ 与 $y$。但 Steve 为了不外传，他只要求你输出 $x$ 在模 $y$ 意义下的乘法逆元 $k$ 即可。如果没有，请输出 $-1$。", "inputFormat": "第一行为一个整数 $n$。\n\n接下来 $n$ 行，每行均有一个整数 $a_i$，表示每本附魔书的初始等级，不保证数据有序。", "outputFormat": "一个整数 $k$，表示 $x$ 在模 $y$ 意义下的乘法逆元，如果没有，请输出 $-1$。  \n\nPS：乘法逆元 $k$ 也可以这样理解：$k$ 是使得 $kx \\equiv 1 \\pmod y$的最小正整数。", "hint": "### 样例解释\n \n第一个样例：\n\n合并两个第一等级的，合并花费 $2$ 经验，代价升为 $3$；  \n再合并两个第二等级的，花费 $3+1=4$ 经验，代价升为 $7$；  \n再合并两个第三等级的，花费 $7+1=8$ 经验，代价升为 $15$；  \n最后合并两个第四等级的，花费 $15+1=16$ 经验，代价升为 $31$。  \n\n经验总花费：$2+4+8+16=30$，最大等级：$5$。\n\n\n对于第一个样例: $x=5,y=30$；\n\n对于第二个样例: $x=3,y=10$。\n\n### 数据范围\n\n![]( https://cdn.luogu.com.cn/upload/pic/41547.png )\n\n保证数据随机，$x,y,k$ 在 `long int` 范围内。\n\n### 温馨提示\n\n本题读入量较大，请使用较快的读入方法，在此，提供一种快速读入的样式：（需包含头文件 `<cctype>`）\n\n```cpp\n#include<cctype>\ninline void read(int &x){\n     char ch=getchar();x=0;\n     while(!isdigit(ch))   ch=getchar();\n     while(isdigit(ch))   x=x*10+ch-'0',ch=getchar();\n}\n```", "locale": "zh-CN"}}}
{"pid": "P5033", "type": "P", "difficulty": 5, "samples": [["2\n1 4 P\n4 5 P", "1"], ["3\n1 6 P\n2 4 N\n3 4 P", "0"], ["2\n5 8 P\n7 11 P", "qwq"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP"], "title": "跑酷", "background": "[赛时答疑](https://www.luogu.org/discuss/show/80694)  \n\n跑酷这东西，还是得看人品的（比如 zm 和 mt）…", "description": "在 Minecraft 中，跑酷可以算得上是一门技术了，Steve 现在想在一个跑道上（二维）进行跑酷。但是 Steve 不知道能不能跑到终点，于是他便查询了 MC Wiki，来获得更多的知识。内容具体如下：\n\n### 生命值\n\n1. 我们规定每个玩家的初始生命为 $20$ 点。\n2. 掉落伤害的计算:\n   - 如果玩家的高度为 $3$ 格或以下，免除此伤害。\n   - 如果玩家的高度为 $4$ 格或以上，便会造成 $x-3$ 点伤害，$x$ 为摔落的高度。\n   - 这里的高度均指相对高度，即当前方块与下一个方块之间的高度差。\n3. 掉落伤害降低的情况：见特殊方块。\n\n4. 当生命值为 $0$ 的时候，视为不能到达终点。\n\n### 跑酷\n\n1. 对于站在一个方块上的玩家来说，玩家最多可以往前面跳 $3$ 格并且可以往上跳一个格子。\n2. 对于站在一个方块上的玩家来说，玩家最多也可以往前跳 $4$ 格，但是不能向上跳一个格子。\n3. 为了计算方便，我们规定下落时玩家不会移动，也就是说，如果下一个方块比现在方块的高度要低的话，我们只能正好下落到下一个方块的位置。\n4. 默认终点为最后一个方块。\n\n### 特殊方块\n\n1. **粘液块**：会使你跳跃至 $60\\%$ 坠落距离的高度，如果有小数，我们向下取整。当你达到最高点的时候，只能往前再移动一格。当然，如果落在前方的方块上，同样要受到摔落伤害。你也可以按住 Shift 键来免除反弹。我们认为在粘液块上面进行跑酷不受减速的限制。  \n2. **蜘蛛网**：下落时会让你免除伤害。我们也认为玩家在蜘蛛网上跑酷不受减速的限制。  \n\nSteve 找到了你，让你帮他去解决这个问题。判断 Steve 能不能到达终点。\n\n- 如果能到达终点，输出最少的跳跃次数；\n- 如果不能到达终点，请输出：`qwq`。", "inputFormat": "第一行为一个整数 $n$，表示有 $n$ 个方块。\n\n从第二行开始，下面连续 $n$ 行，表示有 $n$ 个方块。每个方块都有它的属性：横坐标，高度和是否为特殊方块。（普通方块输入为 $\\verb!P!$，粘液块为 $\\verb!N!$，蜘蛛网为 $\\verb!Z!$）\n", "outputFormat": "如果能到达终点，输出一个整数，表示最少的跳跃次数；\n如果不能到达终点，请输出 `qwq`。", "hint": "\n\n### 数据范围及约定\n\n数据保证输入的横坐标单调递增。每一个横坐标只有一格方块。\n\n数据保证不会在相邻的横坐标中间出现两个特殊方块。\n\n对于方块而言，默认是都没有浮空方块的存在；也就是说，所有方块下面都会有支撑柱。\n\n为了方便，不能先跳跃再下落。也就是说，只能下落到前面一格的方块。\n\n对于 $30\\%$ 的数据 $n\\le 10$；  \n对于另外 $20\\%$ 的数据，保证不存在特殊方块；  \n对于这前面的 $50\\%$ 的数据，保证 Steve 往前跳只能跳四格远或者三格远一格高；  \n对于 $100\\%$ 的数据 $1\\le n\\le 1000$，$1\\le x_{\\rm max}\\le 10000$，$1\\le height\\le 1000$。\n\n保证数据有一定梯度。", "locale": "zh-CN", "translations": {"en": {"title": "Parkour.", "background": "[In-contest Q\\&A](https://www.luogu.org/discuss/show/80694)\n\nThis parkour thing still depends on luck (for example, zm and mt)...", "description": "In Minecraft, parkour can be considered a skill. Steve now wants to do parkour on a (2D) track. But Steve does not know whether he can reach the finish, so he checked the MC Wiki to learn more. The details are as follows.\n\n### Health Points\n\n1. We define that each player starts with $20$ health points.\n2. Fall damage calculation:\n   - If the player’s height is $3$ blocks or less, this damage is ignored.\n   - If the player’s height is $4$ blocks or more, it causes $x-3$ damage, where $x$ is the falling height.\n   - The height here is relative height, i.e., the height difference between the current block and the next block.\n3. Cases where fall damage is reduced: see Special Blocks.\n4. When health becomes $0$, it is considered that the finish cannot be reached.\n\n### Parkour\n\n1. For a player standing on a block, the player can jump forward at most $3$ blocks, and can also jump up by $1$ block.\n2. For a player standing on a block, the player can also jump forward at most $4$ blocks, but cannot jump up by $1$ block.\n3. For convenience, we assume the player does not move while falling. That is, if the next block is lower than the current block, we can only fall exactly to the position of the next block.\n4. By default, the finish is the last block.\n\n### Special Blocks\n\n1. **Slime Block**: It will bounce you up to a height equal to $60\\%$ of the falling distance. If there is a decimal part, round down. When you reach the highest point, you can only move forward by one more block. Of course, if you land on a block in front, you will still take fall damage. You can also hold the Shift key to cancel the bounce. We assume that doing parkour on slime blocks is not affected by the slowdown limit.\n2. **Cobweb**: It makes you ignore damage while falling. We also assume that doing parkour on cobwebs is not affected by the slowdown limit.\n\nSteve found you and asked you to solve this problem. Determine whether Steve can reach the finish.\n\n- If he can reach the finish, output the minimum number of jumps.\n- If he cannot reach the finish, output: `qwq`.", "inputFormat": "The first line contains an integer $n$, meaning there are $n$ blocks.\n\nStarting from the second line, the next $n$ lines describe the $n$ blocks. Each block has its attributes: $x$-coordinate, height, and whether it is a special block. (A normal block is given as $\\verb!P!$, a slime block as $\\verb!N!$, and a cobweb as $\\verb!Z!$.)", "outputFormat": "If he can reach the finish, output one integer, the minimum number of jumps.\nIf he cannot reach the finish, output `qwq`.", "hint": "### Constraints and Notes\n\nThe testdata guarantees that the input $x$-coordinates are strictly increasing. Each $x$-coordinate has exactly one block.\n\nThe testdata guarantees that there will not be two special blocks between two adjacent $x$-coordinates.\n\nFor blocks, by default there are no floating blocks; that is, every block has a supporting pillar beneath it.\n\nFor convenience, you cannot jump first and then fall. That is, you can only fall onto the block that is one block ahead.\n\nFor $30\\%$ of the testdata, $n\\le 10$.\nFor another $20\\%$ of the testdata, it is guaranteed that there are no special blocks.\nFor the first $50\\%$ of the testdata, it is guaranteed that Steve’s forward jump can only be either $4$ blocks far, or $3$ blocks far with $1$ block upward.\nFor $100\\%$ of the testdata, $1\\le n\\le 1000$, $1\\le x_{\\rm max}\\le 10000$, $1\\le height\\le 1000$.\n\nThe testdata is guaranteed to have a reasonable difficulty gradient.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "跑酷", "background": "[赛时答疑](https://www.luogu.org/discuss/show/80694)  \n\n跑酷这东西，还是得看人品的（比如 zm 和 mt）…", "description": "在 Minecraft 中，跑酷可以算得上是一门技术了，Steve 现在想在一个跑道上（二维）进行跑酷。但是 Steve 不知道能不能跑到终点，于是他便查询了 MC Wiki，来获得更多的知识。内容具体如下：\n\n### 生命值\n\n1. 我们规定每个玩家的初始生命为 $20$ 点。\n2. 掉落伤害的计算:\n   - 如果玩家的高度为 $3$ 格或以下，免除此伤害。\n   - 如果玩家的高度为 $4$ 格或以上，便会造成 $x-3$ 点伤害，$x$ 为摔落的高度。\n   - 这里的高度均指相对高度，即当前方块与下一个方块之间的高度差。\n3. 掉落伤害降低的情况：见特殊方块。\n\n4. 当生命值为 $0$ 的时候，视为不能到达终点。\n\n### 跑酷\n\n1. 对于站在一个方块上的玩家来说，玩家最多可以往前面跳 $3$ 格并且可以往上跳一个格子。\n2. 对于站在一个方块上的玩家来说，玩家最多也可以往前跳 $4$ 格，但是不能向上跳一个格子。\n3. 为了计算方便，我们规定下落时玩家不会移动，也就是说，如果下一个方块比现在方块的高度要低的话，我们只能正好下落到下一个方块的位置。\n4. 默认终点为最后一个方块。\n\n### 特殊方块\n\n1. **粘液块**：会使你跳跃至 $60\\%$ 坠落距离的高度，如果有小数，我们向下取整。当你达到最高点的时候，只能往前再移动一格。当然，如果落在前方的方块上，同样要受到摔落伤害。你也可以按住 Shift 键来免除反弹。我们认为在粘液块上面进行跑酷不受减速的限制。  \n2. **蜘蛛网**：下落时会让你免除伤害。我们也认为玩家在蜘蛛网上跑酷不受减速的限制。  \n\nSteve 找到了你，让你帮他去解决这个问题。判断 Steve 能不能到达终点。\n\n- 如果能到达终点，输出最少的跳跃次数；\n- 如果不能到达终点，请输出：`qwq`。", "inputFormat": "第一行为一个整数 $n$，表示有 $n$ 个方块。\n\n从第二行开始，下面连续 $n$ 行，表示有 $n$ 个方块。每个方块都有它的属性：横坐标，高度和是否为特殊方块。（普通方块输入为 $\\verb!P!$，粘液块为 $\\verb!N!$，蜘蛛网为 $\\verb!Z!$）\n", "outputFormat": "如果能到达终点，输出一个整数，表示最少的跳跃次数；\n如果不能到达终点，请输出 `qwq`。", "hint": "\n\n### 数据范围及约定\n\n数据保证输入的横坐标单调递增。每一个横坐标只有一格方块。\n\n数据保证不会在相邻的横坐标中间出现两个特殊方块。\n\n对于方块而言，默认是都没有浮空方块的存在；也就是说，所有方块下面都会有支撑柱。\n\n为了方便，不能先跳跃再下落。也就是说，只能下落到前面一格的方块。\n\n对于 $30\\%$ 的数据 $n\\le 10$；  \n对于另外 $20\\%$ 的数据，保证不存在特殊方块；  \n对于这前面的 $50\\%$ 的数据，保证 Steve 往前跳只能跳四格远或者三格远一格高；  \n对于 $100\\%$ 的数据 $1\\le n\\le 1000$，$1\\le x_{\\rm max}\\le 10000$，$1\\le height\\le 1000$。\n\n保证数据有一定梯度。", "locale": "zh-CN"}}}
{"pid": "P5034", "type": "P", "difficulty": 5, "samples": [["3 1\n1\n2 1\n3 2", "1"], ["7 3\nLDLD\ntk_sky LDLD\nJayden_deng LDLD\nonly_xiaohuang tk_sky\nMuddled_xiaopan tk_sky\nInkn only_xiaohuang\nipdjkl only_xiaohuang", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "果冻", "background": "[赛时答疑](https://www.luogu.org/discuss/show/80694)\n\n**数据已经修复**。\n\n【生存世界】Steve：你们哪位 dalao 可以收留我啊 qwq……\n\n在 Minecraft 一个很友善、和谐的服务器里面，Steve 很喜欢在里面畅游，服务器采用小镇机制，于是有很多小镇。有一个镇叫果冻镇，镇长~~长得很像~~喜欢吃果冻，他很喜欢~~对着镜子~~吃着 bling bling 的果冻。突然，他收到“捷报”，镇上不久就要造反。他吓了一跳，赶紧从床上跳了起来（qwq），吃了一口果冻（误），着手处理这件事情。", "description": "镇上有一个镇长以及 $n-1$ 个镇员，所有的镇员都有着他的直属上司 $f_i$。每个镇镇员与镇长都有一个距离 $d_i$（也就是他与镇长之间上司的人数加 $1$）。镇长想要所有镇员都是自己的直属下司，也就是与他的距离为 $1$。\n\n他每分钟可以让自己的一个镇员变为自己的直属下司，在第 $t (t > 0)$ 分钟的时候，（也就是每一分钟的意思，而 $t$ 将从 $1$ 开始），这个镇员变为自己的直属下司，镇长可以收获 $ (d_i+t) \\& k$ 的安全指数（其中，$\\&$ 为按位与运算）。然后**这个镇员的下司都会跟着这个镇员一起变动**（也就是这个镇员的直属下司仍然是这个镇员的，除非镇长把这个下司变为自己的直属下司）。\n\n当所有镇员都是自己的直属下司后，镇长就可以安心吃他的果冻了。他现在想问你，应该怎样变动，才能使安全指数最大。因为镇长很想快点吃到果冻，他就把这个任务交给你了。", "inputFormat": "第一行是两个正整数 $n$ 和 $k$（具体意义请见题目描述）。\n\n从第二行开始，下面连续 $n$ 行，每行有两个字符串（由大写字母、小写字母、下划线、数字、上引号或者逗号组成），分别表示的是这个镇员和他的直属上司。**特别地，第二行是镇长，他没有直属上司，所以第二行只有一个字符串，表示镇长**。数据保证第二个字符串在第一个字符串前出现过。", "outputFormat": "一行一个整数，表示最大的安全值。", "hint": "### 样例解释\n\n第二个样例：（图片有可能会挂，请耐心等待一会哦 qwq）\n![](https://s1.ax1x.com/2018/10/28/ic6RmQ.png)  \n![](https://s1.ax1x.com/2018/10/28/ic6Wwj.png)    \n![](https://s1.ax1x.com/2018/10/28/ic6fTs.png)  \n![](https://s1.ax1x.com/2018/10/28/ic64kn.png)  \n![](https://s1.ax1x.com/2018/10/28/ic6gOg.png)  \n由于~~出题人过懒~~，移动子节点的情况就未列举。请自行 hack 自己。（滑稽）\n\n### 数据范围\n\n记下列两种特殊情况：  \n1. 保证字符串长度为 $1$。\n2. 树退化成一条链。\n![]( https://cdn.luogu.com.cn/upload/pic/39861.png)     \n对于所有的数据，保证 $k$ 在 `int` 范围内，字符串长度不超过 $10^6$。$n,k$ 均为正整数。", "locale": "zh-CN", "translations": {"en": {"title": "Jelly", "background": "[In-contest Q&A](https://www.luogu.org/discuss/show/80694)\n\n**The testdata has been fixed**.\n\n[Survival World] Steve: Is there any dalao who can take me in qwq……\n\nOn a very friendly and harmonious Minecraft server, Steve loves to wander around. The server uses a town system, so there are many towns. One town is called Jelly Town. The mayor ~~looks very similar~~ likes eating jelly, and he loves ~~staring at the mirror~~ eating bling bling jelly. Suddenly, he received “good news” that the town would soon start a rebellion. He was shocked, quickly jumped out of bed (qwq), took a bite of jelly (oops), and started dealing with it.", "description": "There is one mayor in the town and $n-1$ townspeople. Each townsperson has their direct boss $f_i$. Each townsperson has a distance $d_i$ to the mayor (i.e., the number of bosses between them and the mayor plus $1$). The mayor wants every townsperson to become his direct subordinate, i.e., have distance $1$ from him.\n\nEach minute, he can make one townsperson become his direct subordinate. At minute $t (t > 0)$ (i.e., each minute, and $t$ starts from $1$), when this townsperson becomes his direct subordinate, the mayor gains a safety index of $(d_i+t) \\& k$ (where $\\&$ is the bitwise AND operator). Then **all subordinates of this townsperson will move together with this townsperson** (that is, this townsperson’s direct subordinates are still their subordinates, unless the mayor makes one of those subordinates his direct subordinate).\n\nAfter all townspeople become his direct subordinates, the mayor can eat his jelly in peace. Now he wants to ask you: how should he perform the changes to maximize the safety index? Since the mayor wants to eat jelly as soon as possible, he gives this task to you.", "inputFormat": "The first line contains two positive integers $n$ and $k$ (see the description for details).\n\nStarting from the second line, there are $n$ lines. Each line contains two strings (consisting of uppercase letters, lowercase letters, underscores, digits, apostrophes, or commas), representing a townsperson and their direct boss. **In particular, the second line is the mayor. He has no direct boss, so the second line contains only one string, representing the mayor**. The data guarantees that the second string has appeared before the first string.", "outputFormat": "Output one integer in a single line, representing the maximum safety value.", "hint": "### Sample Explanation\n\nThe second sample: (the images may fail to load, please wait a moment qwq)\n![](https://s1.ax1x.com/2018/10/28/ic6RmQ.png)  \n![](https://s1.ax1x.com/2018/10/28/ic6Wwj.png)    \n![](https://s1.ax1x.com/2018/10/28/ic6fTs.png)  \n![](https://s1.ax1x.com/2018/10/28/ic64kn.png)  \nBecause ~~the problem setter is too lazy~~, the cases of moving child nodes are not listed. Please hack yourself. (troll)\n\n### Constraints\n\nNote the following two special cases:  \n1. It is guaranteed that the string length is $1$.\n2. The tree degenerates into a chain.\n![]( https://cdn.luogu.com.cn/upload/pic/39861.png)     \nFor all data, $k$ is guaranteed to be within the `int` range, and the string length does not exceed $10^6$. Both $n$ and $k$ are positive integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "果冻", "background": "[赛时答疑](https://www.luogu.org/discuss/show/80694)\n\n**数据已经修复**。\n\n【生存世界】Steve：你们哪位 dalao 可以收留我啊 qwq……\n\n在 Minecraft 一个很友善、和谐的服务器里面，Steve 很喜欢在里面畅游，服务器采用小镇机制，于是有很多小镇。有一个镇叫果冻镇，镇长~~长得很像~~喜欢吃果冻，他很喜欢~~对着镜子~~吃着 bling bling 的果冻。突然，他收到“捷报”，镇上不久就要造反。他吓了一跳，赶紧从床上跳了起来（qwq），吃了一口果冻（误），着手处理这件事情。", "description": "镇上有一个镇长以及 $n-1$ 个镇员，所有的镇员都有着他的直属上司 $f_i$。每个镇镇员与镇长都有一个距离 $d_i$（也就是他与镇长之间上司的人数加 $1$）。镇长想要所有镇员都是自己的直属下司，也就是与他的距离为 $1$。\n\n他每分钟可以让自己的一个镇员变为自己的直属下司，在第 $t (t > 0)$ 分钟的时候，（也就是每一分钟的意思，而 $t$ 将从 $1$ 开始），这个镇员变为自己的直属下司，镇长可以收获 $ (d_i+t) \\& k$ 的安全指数（其中，$\\&$ 为按位与运算）。然后**这个镇员的下司都会跟着这个镇员一起变动**（也就是这个镇员的直属下司仍然是这个镇员的，除非镇长把这个下司变为自己的直属下司）。\n\n当所有镇员都是自己的直属下司后，镇长就可以安心吃他的果冻了。他现在想问你，应该怎样变动，才能使安全指数最大。因为镇长很想快点吃到果冻，他就把这个任务交给你了。", "inputFormat": "第一行是两个正整数 $n$ 和 $k$（具体意义请见题目描述）。\n\n从第二行开始，下面连续 $n$ 行，每行有两个字符串（由大写字母、小写字母、下划线、数字、上引号或者逗号组成），分别表示的是这个镇员和他的直属上司。**特别地，第二行是镇长，他没有直属上司，所以第二行只有一个字符串，表示镇长**。数据保证第二个字符串在第一个字符串前出现过。", "outputFormat": "一行一个整数，表示最大的安全值。", "hint": "### 样例解释\n\n第二个样例：（图片有可能会挂，请耐心等待一会哦 qwq）\n![](https://s1.ax1x.com/2018/10/28/ic6RmQ.png)  \n![](https://s1.ax1x.com/2018/10/28/ic6Wwj.png)    \n![](https://s1.ax1x.com/2018/10/28/ic6fTs.png)  \n![](https://s1.ax1x.com/2018/10/28/ic64kn.png)  \n![](https://s1.ax1x.com/2018/10/28/ic6gOg.png)  \n由于~~出题人过懒~~，移动子节点的情况就未列举。请自行 hack 自己。（滑稽）\n\n### 数据范围\n\n记下列两种特殊情况：  \n1. 保证字符串长度为 $1$。\n2. 树退化成一条链。\n![]( https://cdn.luogu.com.cn/upload/pic/39861.png)     \n对于所有的数据，保证 $k$ 在 `int` 范围内，字符串长度不超过 $10^6$。$n,k$ 均为正整数。", "locale": "zh-CN"}}}
{"pid": "P5035", "type": "P", "difficulty": 2, "samples": [["1", "1"], ["2", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递推", "2018"], "title": "金坷垃", "background": "[@rainheavy](https://www.luogu.com.cn/user/107646) 原创。\n\n这是一道巨（du）水（liu）题。\n\n第一届中国国际博览会于 2018 年 11.5 ~ 11.10 在上海举行，特朗普统治的国家——美丽国带来了金坷垃。这是一种神奇的产品，据他们的广告所说：肥料用了金坷垃，能吸收 20 米以下的氮磷钾。\n\n可是，在经过富土（tu）康的质检员 DevZhu 质检的时候发现出了点问题，金坷垃的效果并不像广告所说的那样。毕竟植物的根只能到深度为 $1$ 的位置，金坷垃的效果有限。", "description": "它只有如下的效果：（以 $20$ 为例）\n\n$20$ 的真因子有 $10,5,4,2,1$。\n\n从地下 $20$ 米深处可以往上跳一个约数的长度。（比如 $10$）\n\n现在它在 $10$ 米处，$10$ 的真因子有 $5,2,1$。\n\n再跳一个 $5$，为 $5$，$5$ 的真因子有 $1$。\n\n再跳 $1$ 个 $1$，为 $4$，$4$ 的真因子有 $2,1$。\n\n**$1$ 已用过，不能再用**。\n\n再跳一个 $2$，为 $2$。$2$ 的真因子有 $1$。\n\n**$1$ 已用过**，此时没法再跳了。此时的深度为 $2$。\n\n按上述要求跳，把所有符合要求的能跳的所有情况全试一遍，只要有一种情况最后结果为 $1$，这个肥料就合格，否则不合格。\n\nDevZhu 面对一大堆待检验的金坷垃，并不想检验那么多，他想问问你有哪些金坷垃是合格的，在这些合格的金坷垃中，初始深度排在第 $k$ 个的是哪一个。\n\n把合格的金坷垃按初始深度从小到大排，请输出第 $k$ 个金坷垃的初始深度，对 $123456789$ 取模。（富土康从不用 $10^9+7$ 和 $998244353$）", "inputFormat": "一个数 $k$。", "outputFormat": "合格的第 $k$ 个金坷垃的初始深度对 $123456789$ 取模后的结果。", "hint": "（简单死了。。。）\n\n（给不会的人一点福利：有一个数据 $k=1$。）\n\n对于 $30\\%$ 的数据，$k \\le 10^5$；\n\n对于 $70\\%$ 的数据，$k \\le 10^9$；\n\n对于 $100\\%$ 的数据，$k \\le 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "Jinkela", "background": "Originally created by [@rainheavy](https://www.luogu.com.cn/user/107646).\n\nThis is a very (du) easy (liu) problem.\n\nThe 1st China International Import Expo was held in Shanghai from 2018.11.5 to 2018.11.10. The country ruled by Trump, the “beautiful country” (Meiliguo, pinyin), brought Jinkela. This is a magical product. According to their advertisements: if you use Jinkela fertilizer, it can absorb nitrogen, phosphorus, and potassium from depths below 20 meters.\n\nHowever, when it was inspected by the quality inspector DevZhu from “Futukang” (pinyin), some problems were found. The effect of Jinkela was not as the advertisement said. After all, plant roots can only reach depth $1$, so the effect of Jinkela is limited.", "description": "It only has the following effect (take $20$ as an example).\n\nThe proper divisors of $20$ are $10, 5, 4, 2, 1$.\n\nFrom a depth of $20$ meters underground, you can jump upward by a length equal to one divisor. (For example, $10$.)\n\nNow it is at depth $10$ meters. The proper divisors of $10$ are $5, 2, 1$.\n\nJump another $5$ to reach $5$. The proper divisors of $5$ are $1$.\n\nJump $1$ to reach $4$. The proper divisors of $4$ are $2, 1$.\n\n**$1$ has already been used, so it cannot be used again.**\n\nJump another $2$ to reach $2$. The proper divisors of $2$ are $1$.\n\n**$1$ has already been used**, so it cannot jump anymore. The final depth is $2$.\n\nFollowing the rules above, try all possible jump sequences that are allowed. If there exists at least one sequence whose final result is $1$, then this fertilizer is qualified; otherwise it is not qualified.\n\nDevZhu is facing a large pile of Jinkela to be tested and does not want to test so many. He wants to ask which Jinkela are qualified, and among these qualified ones, which one is the $k$-th by initial depth.\n\nSort the qualified Jinkela by initial depth from small to large. Output the initial depth of the $k$-th qualified Jinkela modulo $123456789$. (Futukang never uses $10^9+7$ or $998244353$.)", "inputFormat": "One number $k$.", "outputFormat": "Output the initial depth of the $k$-th qualified Jinkela modulo $123456789$.", "hint": "(It is super easy...)\n\n(A little benefit for those who cannot do it: there is one testdata with $k = 1$.)\n\nConstraints:\n\nFor $30\\%$ of the testdata, $k \\le 10^5$.\n\nFor $70\\%$ of the testdata, $k \\le 10^9$.\n\nFor $100\\%$ of the testdata, $k \\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "金坷垃", "background": "[@rainheavy](https://www.luogu.com.cn/user/107646) 原创。\n\n这是一道巨（du）水（liu）题。\n\n第一届中国国际博览会于 2018 年 11.5 ~ 11.10 在上海举行，特朗普统治的国家——美丽国带来了金坷垃。这是一种神奇的产品，据他们的广告所说：肥料用了金坷垃，能吸收 20 米以下的氮磷钾。\n\n可是，在经过富土（tu）康的质检员 DevZhu 质检的时候发现出了点问题，金坷垃的效果并不像广告所说的那样。毕竟植物的根只能到深度为 $1$ 的位置，金坷垃的效果有限。", "description": "它只有如下的效果：（以 $20$ 为例）\n\n$20$ 的真因子有 $10,5,4,2,1$。\n\n从地下 $20$ 米深处可以往上跳一个约数的长度。（比如 $10$）\n\n现在它在 $10$ 米处，$10$ 的真因子有 $5,2,1$。\n\n再跳一个 $5$，为 $5$，$5$ 的真因子有 $1$。\n\n再跳 $1$ 个 $1$，为 $4$，$4$ 的真因子有 $2,1$。\n\n**$1$ 已用过，不能再用**。\n\n再跳一个 $2$，为 $2$。$2$ 的真因子有 $1$。\n\n**$1$ 已用过**，此时没法再跳了。此时的深度为 $2$。\n\n按上述要求跳，把所有符合要求的能跳的所有情况全试一遍，只要有一种情况最后结果为 $1$，这个肥料就合格，否则不合格。\n\nDevZhu 面对一大堆待检验的金坷垃，并不想检验那么多，他想问问你有哪些金坷垃是合格的，在这些合格的金坷垃中，初始深度排在第 $k$ 个的是哪一个。\n\n把合格的金坷垃按初始深度从小到大排，请输出第 $k$ 个金坷垃的初始深度，对 $123456789$ 取模。（富土康从不用 $10^9+7$ 和 $998244353$）", "inputFormat": "一个数 $k$。", "outputFormat": "合格的第 $k$ 个金坷垃的初始深度对 $123456789$ 取模后的结果。", "hint": "（简单死了。。。）\n\n（给不会的人一点福利：有一个数据 $k=1$。）\n\n对于 $30\\%$ 的数据，$k \\le 10^5$；\n\n对于 $70\\%$ 的数据，$k \\le 10^9$；\n\n对于 $100\\%$ 的数据，$k \\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5036", "type": "P", "difficulty": 6, "samples": [["4\n3 2 3 2", "1 2\n1 4\n1 3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "枚举", "连通块"], "title": "随机生成树", "background": "@葛军 改编的水题。", "description": "rainheavy 在纸上画了 $N$ 个点（从 $1$ 到 $N$ 编号），每个点的颜色用一个整数描述。rainheavy 决定用这 $N$ 个点随机生成一棵树，生成的规则如下：\n\n对于 $2$ 号点到 $N$ 号点，每个点随机指定连接一个点。$i$ 号点 $(2 \\le i \\le N)$ 连的点在 $i$ 的约数中和 $i$ 的倍数中不超过 $N$ 的中随机挑选一个。（例如 $N=30$ 时 $10$ 号点的可以连接 $1$ 号，$2$ 号，$5$ 号，$20$ 号，$30$ 号）\n\n生成的树中不能有重边。（不然就不叫树了）\n\n树生成完之后，rainheavy 可以计算出这个树有多少个联通块，一个联通块是一些点的集合，需要满足以下两个条件：\n\n1、从集合中任取两个点都满足：两个点颜色相同，且这两个点之间存在一条树边组成的路径，路径上的所有点都和这两个点颜色相同。\n\n2、对于集合中的任意一个点和集合外的任意一个点：两点要么不同色，要么不存在一条树边组成的路径使得路径上所有点都和这两个点同色。\n\nrainheavy 希望计算出生成的树中联通块个数最多时，需要连接哪些边，但是 rainheavy 太强了，不屑于做这种辣鸡题目，~~更重要的是他要去 AK IOI~~，于是就把题目扔给了你。\n\n注：边的顺序\n\n1. 首先，满足连通块个数最多的优先（即对于生成连通块有贡献的优先）。\n\n2. 同样满足条件 $1$ 时，连接的两个点编号之和较小的边优先。（如满足条件 $1$ 时，连接 $3$ 号点和 $5$ 号点的边比连接 $4$ 号点和 $5$ 号点的边优先）\n\n3. 同时满足条件 $2$ 时，连接的两个点编号的之中较小的一个较小的边优先。（如满足条件2时，连接2号点和6号点的边比连接3号点和5号点的边优先）", "inputFormat": "第一行一个整数 $N$ 代表点数。\n\n第二行 $N$ 个整数，第 $i$ 个整数 $c_i$ 代表第 $i$ 个点的颜色。", "outputFormat": "输出共 $N-1$ 行，每行两个整数 $x,y$ 表示需要一条边连接点 $x$ 和点 $y$。（要求 $x<y$，且输出的顺序满足题目描述中边的顺序）\n\nTip：由于输出较多，建议用快速输出。（不会就算了顶多 T 掉嘛对不对）", "hint": "对于样例的解释：因为 $2$ 号、$4$ 号点会对生成联通块有贡献（$3$ 号你连了也没用），又因为 $1+2 \\lt 1+4$ ，所以 $(1,2)$ 比 $(1,4)$ 优先输出，最后再输出 $(1,3)$。\n\n\n对于 $30\\%$ 的数据，$2 \\le N \\le 10$；  \n对于 $60\\%$ 的数据，$2 \\le N \\le 5000$；  \n对于 $80\\%$ 的数据，$2 \\le N \\le 2 \\times 10^5$；  \n对于 $100\\%$ 的数据，$2 \\le N \\le 5 \\times 10^5,1 \\le c_i \\le 10^9$。（反正多了也没用）", "locale": "zh-CN", "translations": {"en": {"title": "Randomly Generated Tree", "background": "An easy problem adapted by @Gejun.", "description": "Rainheavy drew $N$ points on paper (numbered from $1$ to $N$). The color of each point is described by an integer. Rainheavy decides to randomly generate a tree using these $N$ points. The rules are as follows.\n\nFor points $2$ to $N$, each point randomly chooses one point to connect to. The point that node $i$ $(2 \\le i \\le N)$ connects to is randomly selected from: the divisors of $i$, and the multiples of $i$ that do not exceed $N$. (For example, when $N=30$, node $10$ can connect to node $1$, $2$, $5$, $20$, or $30$.)\n\nThe generated tree cannot have multiple edges. (Otherwise it would not be a tree.)\n\nAfter the tree is generated, Rainheavy can compute how many connected components it has. A connected component is a set of points that must satisfy the following two conditions.\n\n1. For any two points chosen from the set: the two points have the same color, and there exists a path consisting of tree edges between them such that all points on the path have the same color as these two points.\n\n2. For any point inside the set and any point outside the set: the two points are either of different colors, or there does not exist a path consisting of tree edges between them such that all points on the path have the same color as these two points.\n\nRainheavy wants to find, when the number of connected components in the generated tree is maximized, which edges should be connected. However, Rainheavy is too strong and does not bother with such a boring problem. ~~More importantly, he is going to AK IOI~~, so he throws the problem to you.\n\nNote: the order of edges.\n\n1. First, prioritize maximizing the number of connected components (i.e., prioritize edges that contribute to forming connected components).\n\n2. If condition 1 is tied, prioritize the edge with the smaller sum of the two endpoint indices. (For example, under condition 1, the edge connecting node $3$ and node $5$ has higher priority than the edge connecting node $4$ and node $5$.)\n\n3. If condition 2 is also tied, prioritize the edge whose smaller endpoint index is smaller. (For example, under condition 2, the edge connecting node $2$ and node $6$ has higher priority than the edge connecting node $3$ and node $5$.)", "inputFormat": "The first line contains an integer $N$, representing the number of nodes.\n\nThe second line contains $N$ integers. The $i$-th integer $c_i$ represents the color of node $i$.", "outputFormat": "Output a total of $N-1$ lines. Each line contains two integers $x,y$, indicating that an edge should connect node $x$ and node $y$. (It is required that $x<y$, and the output order must satisfy the edge order described in the statement.)\n\nTip: Since the output is large, fast output is recommended. (If you cannot, then forget it, at worst you will get TLE, right.)", "hint": "Explanation for the sample: Because nodes $2$ and $4$ will contribute to forming connected components (connecting node $3$ is useless), and since $1+2 \\lt 1+4$, $(1,2)$ should be output before $(1,4)$, and finally output $(1,3)$.\n\nConstraints:\n\nFor $30\\%$ of the testdata, $2 \\le N \\le 10$.  \nFor $60\\%$ of the testdata, $2 \\le N \\le 5000$.  \nFor $80\\%$ of the testdata, $2 \\le N \\le 2 \\times 10^5$.  \nFor $100\\%$ of the testdata, $2 \\le N \\le 5 \\times 10^5$, $1 \\le c_i \\le 10^9$. (Anyway, bigger is useless.)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "随机生成树", "background": "@葛军 改编的水题。", "description": "rainheavy 在纸上画了 $N$ 个点（从 $1$ 到 $N$ 编号），每个点的颜色用一个整数描述。rainheavy 决定用这 $N$ 个点随机生成一棵树，生成的规则如下：\n\n对于 $2$ 号点到 $N$ 号点，每个点随机指定连接一个点。$i$ 号点 $(2 \\le i \\le N)$ 连的点在 $i$ 的约数中和 $i$ 的倍数中不超过 $N$ 的中随机挑选一个。（例如 $N=30$ 时 $10$ 号点的可以连接 $1$ 号，$2$ 号，$5$ 号，$20$ 号，$30$ 号）\n\n生成的树中不能有重边。（不然就不叫树了）\n\n树生成完之后，rainheavy 可以计算出这个树有多少个联通块，一个联通块是一些点的集合，需要满足以下两个条件：\n\n1、从集合中任取两个点都满足：两个点颜色相同，且这两个点之间存在一条树边组成的路径，路径上的所有点都和这两个点颜色相同。\n\n2、对于集合中的任意一个点和集合外的任意一个点：两点要么不同色，要么不存在一条树边组成的路径使得路径上所有点都和这两个点同色。\n\nrainheavy 希望计算出生成的树中联通块个数最多时，需要连接哪些边，但是 rainheavy 太强了，不屑于做这种辣鸡题目，~~更重要的是他要去 AK IOI~~，于是就把题目扔给了你。\n\n注：边的顺序\n\n1. 首先，满足连通块个数最多的优先（即对于生成连通块有贡献的优先）。\n\n2. 同样满足条件 $1$ 时，连接的两个点编号之和较小的边优先。（如满足条件 $1$ 时，连接 $3$ 号点和 $5$ 号点的边比连接 $4$ 号点和 $5$ 号点的边优先）\n\n3. 同时满足条件 $2$ 时，连接的两个点编号的之中较小的一个较小的边优先。（如满足条件2时，连接2号点和6号点的边比连接3号点和5号点的边优先）", "inputFormat": "第一行一个整数 $N$ 代表点数。\n\n第二行 $N$ 个整数，第 $i$ 个整数 $c_i$ 代表第 $i$ 个点的颜色。", "outputFormat": "输出共 $N-1$ 行，每行两个整数 $x,y$ 表示需要一条边连接点 $x$ 和点 $y$。（要求 $x<y$，且输出的顺序满足题目描述中边的顺序）\n\nTip：由于输出较多，建议用快速输出。（不会就算了顶多 T 掉嘛对不对）", "hint": "对于样例的解释：因为 $2$ 号、$4$ 号点会对生成联通块有贡献（$3$ 号你连了也没用），又因为 $1+2 \\lt 1+4$ ，所以 $(1,2)$ 比 $(1,4)$ 优先输出，最后再输出 $(1,3)$。\n\n\n对于 $30\\%$ 的数据，$2 \\le N \\le 10$；  \n对于 $60\\%$ 的数据，$2 \\le N \\le 5000$；  \n对于 $80\\%$ 的数据，$2 \\le N \\le 2 \\times 10^5$；  \n对于 $100\\%$ 的数据，$2 \\le N \\le 5 \\times 10^5,1 \\le c_i \\le 10^9$。（反正多了也没用）", "locale": "zh-CN"}}}
{"pid": "P5037", "type": "P", "difficulty": 6, "samples": [["1\n5\n2 4\n1 2 3 4 5", "5"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "最短路", "素数判断,质数,筛法"], "title": "抓捕", "background": "@葛军  原创\n\n古桥文乃作为一名 OIer，每天勤奋地在洛谷上刷题，然而她的父母却认为他有网瘾，就将她送到了杨叫兽的网戒中心。\n\n![](https://cdn.luogu.com.cn/upload/pic/41018.png )\n\n一年之后，凭借不懈地努力古桥文乃终于逃了出来，并且立刻向警察蜀黍举报杨叫兽的所作所为，了解情况后警察请她带路去网戒中心抓捕杨叫兽。", "description": "啊~~~~！\n\n他们刚到达网戒中心就听到惨叫声从里面传来。古桥文乃在网戒中心呆了一年，对里面的情况很熟悉，立马就知道杨叔又在 $13$ 号治疗室“点现钱”。同时，她知道网戒中心有 $n$ 个房间，任意房间都有走廊相连，每个走廊和房间之间都有门，门是向外锁上的，且在开启后会自动锁上（即每次从房间 $i$ 进入任意一个与其相连的走廊需要花费 $c_i$ 的体力开锁，而从走廊进入房间不用耗费体力）。\n\n杨叔为了防止“盟友”逃跑，在每个房间安装了摄像头，安排了 $n$ 个手下在监控中心看着监控。\n\n**特别的，$\\bf1$ 号房间为监控中心，$\\bf1$ 号手下负责防止任何人（除了杨叔）进入监控中心（否则立刻报告给杨叔）**，其余的 $2$ 号到 $n$ 号手下每人负责监控编号是自己整数倍的房间（例如 $n=10$ 时 $2$ 号手下监控 $2$ 号，$4$ 号，$6$ 号，$8$ 号，$10$ 号房间），$13$ 号治疗室也按照此规则被监控，如果他们其中一个人看到同一个人两次，就会向杨叔报告（但是每一个手下不会互相交流信息），好在这些手下都四肢发达头脑简单，只能记得上一秒的事情。\n\n为了保证抓捕的顺利，古桥文乃和警察不能被发现，现在他们在 $x$ 号房间，$13$ 号治疗室在 $y$ 号房间，已知他们通过每一条走廊要 $1$ 秒，开锁和通过房间不用花费时间（但会被监控室的手下看到），古桥文乃和警察想知道他们在不被发现的情况下最少要花费多少体力才能进入 $13$ 号治疗室。", "inputFormat": "本题多组询问。\n\n第一行一个数 $T$，表示有 $T$ 组询问，第二行一个数 $n$，表示有 $n$ 个房间和手下（不过注意，本题中只读入一次 $n$，这个 $n$ 在每组数据中都是相同的）。\n\n对于每一个询问，第一行两个数：$x,y$，其中 $x$ 表示古桥文乃和警察所在房间的编号，$y$ 表示 $13$ 号治疗室所在房间的编号，接下来一行 $n$ 个数，表示 $c_i$。", "outputFormat": "输出共 $T$ 行，每个询问输出一行，仅一个数，表示在不被发现的情况下最少要花费多少体力才能进入 $13$ 号治疗室，若不能到达输出 $-1$。", "hint": "### 样例解释\n一种可行的方案：$2\\to3\\to4$。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$n\\leq1500$，$T\\leq15$；\n\n对于 $50\\%$ 的数据，$n\\leq2500$，$T\\leq30$；\n\n对于 $70\\%$ 的数据，$n\\leq4500$，$T\\leq50$；\n\n对于 $100%$ 的数据，$n\\leq4500$，$T\\leq200$，$2\\leq x,y\\leq n$，$c_i\\leq9900$\n\n### 提示：\n\n本题读入可能较多，建议使用快读和 O2 优化。", "locale": "zh-CN", "translations": {"en": {"title": "Capture", "background": "@Ge Jun  Original.\n\nAs an OIer, Fumino Furuhashi works hard on Luogu every day. However, her parents think she is addicted to the Internet, so they send her to Yang Jiaoshou’s Internet Addiction Treatment Center.\n\n![](https://cdn.luogu.com.cn/upload/pic/41018.png )\n\nOne year later, thanks to unremitting effort, Fumino Furuhashi finally escapes. She immediately reports Yang Jiaoshou’s actions to the police. After learning the situation, the police ask her to lead the way to the center to arrest Yang Jiaoshou.", "description": "Ah~~~~！\n\nAs soon as they arrive at the Internet Addiction Treatment Center, they hear screams coming from inside. Fumino Furuhashi has stayed in the center for a year and is very familiar with it, so she immediately knows that Uncle Yang is “counting cash” again in Treatment Room No. $13$. At the same time, she knows the center has $n$ rooms, and any two rooms are connected by corridors. There is a door between each corridor and each room. The doors are locked from the outside, and will automatically lock again after being opened (that is, each time you go from room $i$ into any corridor connected to it, you need to spend $c_i$ stamina to unlock it, while entering a room from a corridor costs no stamina).\n\nTo prevent “allies” from escaping, Uncle Yang installs cameras in every room, and assigns $n$ underlings in the monitoring center to watch the feeds.\n\n**In particular, Room $\\bf1$ is the monitoring center. Underling $\\bf1$ is responsible for preventing anyone (except Uncle Yang) from entering the monitoring center (otherwise he reports to Uncle Yang immediately).** The other underlings from No. $2$ to No. $n$ each monitor rooms whose numbers are integer multiples of their own number (for example, when $n=10$, underling No. $2$ monitors Rooms No. $2$, $4$, $6$, $8$, $10$). Treatment Room No. $13$ is also monitored by this rule. If any one of them sees the same person twice, they will report to Uncle Yang (but the underlings do not share information with each other). Fortunately, these underlings are strong but simple-minded, and can only remember what happened in the previous second.\n\nTo ensure the arrest goes smoothly, Fumino Furuhashi and the police must not be discovered. They are currently in Room $x$, and Treatment Room No. $13$ is in Room $y$. It is known that passing through each corridor takes $1$ second, and unlocking doors and passing through rooms takes no time (but will be seen by the underlings in the monitoring center). Fumino Furuhashi and the police want to know the minimum stamina needed to enter Treatment Room No. $13$ without being discovered.", "inputFormat": "This problem has multiple queries.\n\nThe first line contains an integer $T$, meaning there are $T$ queries. The second line contains an integer $n$, meaning there are $n$ rooms and underlings (note that in this problem, $n$ is read only once, and this $n$ is the same for every query).\n\nFor each query, the first line contains two integers: $x,y$, where $x$ is the room number where Fumino Furuhashi and the police are, and $y$ is the room number of Treatment Room No. $13$. The next line contains $n$ integers, representing $c_i$.", "outputFormat": "Output $T$ lines in total. For each query, output one line with one integer, meaning the minimum stamina needed to enter Treatment Room No. $13$ without being discovered. If it is impossible to reach, output $-1$.", "hint": "### Sample Explanation\n\nOne feasible plan is: $2\\to3\\to4$.\n\n### Constraints\n\nFor $30\\%$ of the testdata, $n\\leq1500$, $T\\leq15$.\n\nFor $50\\%$ of the testdata, $n\\leq2500$, $T\\leq30$.\n\nFor $70\\%$ of the testdata, $n\\leq4500$, $T\\leq50$.\n\nFor $100\\%$ of the testdata, $n\\leq4500$, $T\\leq200$, $2\\leq x,y\\leq n$, $c_i\\leq9900$.\n\n### Note\n\nThe input size may be large. Fast input and O2 optimization are recommended.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "抓捕", "background": "@葛军  原创\n\n古桥文乃作为一名 OIer，每天勤奋地在洛谷上刷题，然而她的父母却认为他有网瘾，就将她送到了杨叫兽的网戒中心。\n\n![](https://cdn.luogu.com.cn/upload/pic/41018.png )\n\n一年之后，凭借不懈地努力古桥文乃终于逃了出来，并且立刻向警察蜀黍举报杨叫兽的所作所为，了解情况后警察请她带路去网戒中心抓捕杨叫兽。", "description": "啊~~~~！\n\n他们刚到达网戒中心就听到惨叫声从里面传来。古桥文乃在网戒中心呆了一年，对里面的情况很熟悉，立马就知道杨叔又在 $13$ 号治疗室“点现钱”。同时，她知道网戒中心有 $n$ 个房间，任意房间都有走廊相连，每个走廊和房间之间都有门，门是向外锁上的，且在开启后会自动锁上（即每次从房间 $i$ 进入任意一个与其相连的走廊需要花费 $c_i$ 的体力开锁，而从走廊进入房间不用耗费体力）。\n\n杨叔为了防止“盟友”逃跑，在每个房间安装了摄像头，安排了 $n$ 个手下在监控中心看着监控。\n\n**特别的，$\\bf1$ 号房间为监控中心，$\\bf1$ 号手下负责防止任何人（除了杨叔）进入监控中心（否则立刻报告给杨叔）**，其余的 $2$ 号到 $n$ 号手下每人负责监控编号是自己整数倍的房间（例如 $n=10$ 时 $2$ 号手下监控 $2$ 号，$4$ 号，$6$ 号，$8$ 号，$10$ 号房间），$13$ 号治疗室也按照此规则被监控，如果他们其中一个人看到同一个人两次，就会向杨叔报告（但是每一个手下不会互相交流信息），好在这些手下都四肢发达头脑简单，只能记得上一秒的事情。\n\n为了保证抓捕的顺利，古桥文乃和警察不能被发现，现在他们在 $x$ 号房间，$13$ 号治疗室在 $y$ 号房间，已知他们通过每一条走廊要 $1$ 秒，开锁和通过房间不用花费时间（但会被监控室的手下看到），古桥文乃和警察想知道他们在不被发现的情况下最少要花费多少体力才能进入 $13$ 号治疗室。", "inputFormat": "本题多组询问。\n\n第一行一个数 $T$，表示有 $T$ 组询问，第二行一个数 $n$，表示有 $n$ 个房间和手下（不过注意，本题中只读入一次 $n$，这个 $n$ 在每组数据中都是相同的）。\n\n对于每一个询问，第一行两个数：$x,y$，其中 $x$ 表示古桥文乃和警察所在房间的编号，$y$ 表示 $13$ 号治疗室所在房间的编号，接下来一行 $n$ 个数，表示 $c_i$。", "outputFormat": "输出共 $T$ 行，每个询问输出一行，仅一个数，表示在不被发现的情况下最少要花费多少体力才能进入 $13$ 号治疗室，若不能到达输出 $-1$。", "hint": "### 样例解释\n一种可行的方案：$2\\to3\\to4$。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$n\\leq1500$，$T\\leq15$；\n\n对于 $50\\%$ 的数据，$n\\leq2500$，$T\\leq30$；\n\n对于 $70\\%$ 的数据，$n\\leq4500$，$T\\leq50$；\n\n对于 $100%$ 的数据，$n\\leq4500$，$T\\leq200$，$2\\leq x,y\\leq n$，$c_i\\leq9900$\n\n### 提示：\n\n本题读入可能较多，建议使用快读和 O2 优化。", "locale": "zh-CN"}}}
{"pid": "P5038", "type": "P", "difficulty": 6, "samples": [["2 \n2 2 \n1 2 \n2 3 \n3 3 \n1 2 3 \n2 3 4 \n4 3 2 ", "2 \n-1 \n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "四川", "二分", "各省省选", "网络流"], "title": "[SCOI2012] 奇怪的游戏", "background": "", "description": "Blinker 最近喜欢上一个奇怪的游戏。 \n\n这个游戏在一个 $N \\times M$ 的棋盘上玩，每个格子有一个数。每次 Blinker 会选择两个相邻的格子，并使这两个数都加上 $1$。 \n\n现在 Blinker 想知道最少多少次能使棋盘上的数都变成同一个数，如果永远不能变成同一个数则输出 $-1$。 ", "inputFormat": "输入的第一行是一个整数 $T$，表示输入数据有 $T$ 轮游戏组成。 \n\n每轮游戏的第一行有两个整数 $N$ 和 $M$，分别代表棋盘的行数和列数。  \n接下来有 $N$ 行，每行 $M$ 个数。 ", "outputFormat": "对于每个游戏输出最少能使游戏结束的次数，如果永远不能变成同一个数则输出 $-1$。", "hint": "对于 $30\\%$ 的数据，保证 $ T\\le 10,1\\le N,M \\le 8$。   \n对于 $100\\%$ 的数据，保证 $T \\le 10,1 \\le N,M\\le 40$，所有数为正整数且小于 $10^9$。 ", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2012] Strange Game", "background": "", "description": "Blinker has recently become interested in a strange game.\n\nThe game is played on an $N \\times M$ board, and each cell contains a number. Each time, Blinker chooses two adjacent cells and increases both numbers by $1$.\n\nNow Blinker wants to know the minimum number of moves needed to make all numbers on the board become the same. If it can never become the same, output $-1$.", "inputFormat": "The first line contains an integer $T$, meaning the input consists of $T$ rounds of the game.\n\nIn each round, the first line contains two integers $N$ and $M$, representing the number of rows and columns of the board.  \nThen follow $N$ lines, each containing $M$ numbers.", "outputFormat": "For each round, output the minimum number of moves needed to finish the game. If it can never become the same number, output $-1$.", "hint": "For $30\\%$ of the testdata, it is guaranteed that $T \\le 10$ and $1 \\le N, M \\le 8$.  \nFor $100\\%$ of the testdata, it is guaranteed that $T \\le 10$ and $1 \\le N, M \\le 40$. All numbers are positive integers and less than $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2012] 奇怪的游戏", "background": "", "description": "Blinker 最近喜欢上一个奇怪的游戏。 \n\n这个游戏在一个 $N \\times M$ 的棋盘上玩，每个格子有一个数。每次 Blinker 会选择两个相邻的格子，并使这两个数都加上 $1$。 \n\n现在 Blinker 想知道最少多少次能使棋盘上的数都变成同一个数，如果永远不能变成同一个数则输出 $-1$。 ", "inputFormat": "输入的第一行是一个整数 $T$，表示输入数据有 $T$ 轮游戏组成。 \n\n每轮游戏的第一行有两个整数 $N$ 和 $M$，分别代表棋盘的行数和列数。  \n接下来有 $N$ 行，每行 $M$ 个数。 ", "outputFormat": "对于每个游戏输出最少能使游戏结束的次数，如果永远不能变成同一个数则输出 $-1$。", "hint": "对于 $30\\%$ 的数据，保证 $ T\\le 10,1\\le N,M \\le 8$。   \n对于 $100\\%$ 的数据，保证 $T \\le 10,1 \\le N,M\\le 40$，所有数为正整数且小于 $10^9$。 ", "locale": "zh-CN"}}}
{"pid": "P5039", "type": "P", "difficulty": 6, "samples": [["4 6 1\n1 2 2\n1 3 2\n1 4 3\n2 3 2\n2 4 4\n3 4 5", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "各省省选", "上海"], "title": "[SHOI2010] 最小生成树", "background": "", "description": "Secsa最近对最小生成树问题特别感兴趣。他已经知道如果要去求出一个 $ n $ 个点、 $ m $ 条边的无向图的最小生成树有一个Krustal算法和另一个Prim的算法。另外，他还知道，某一个图可能有多种不同的最小生成树。例如，下面图3中所示的都是图2中的无向图的最小生成树：\n\n![](https://cdn.luogu.com.cn/upload/pic/43631.png)\n\n当然啦，这些都不是今天需要你解决的问题。Secsa想知道对于某一条无向图中的边AB，至少需要多少代价可以保证AB边在这个无向图的最小生成树中。为了使得AB边一定在最小生成树中，你可以对这个无向图进行操作，一次单独的操作是指：先选择一条图中的边 P1P2，再把图中除了这条边以外的边，每一条的权值都减少 $ 1 $ 。如图4所示就是一次这样的操作：\n\n![](https://cdn.luogu.com.cn/upload/pic/43632.png)\n\n", "inputFormat": "输入文件的第一行有3个正整数 $ n,m,Lab $ 分别表示无向图中的点数、边数、必须要在最小生成树中出现的AB边的标号。\n\n接下来 $ m $ 行依次描述标号为 $ 1,2,3 \\ldots m $ 的无向边，每行描述一条边。每个描述包含3个整数 $ x,y,d $ ，表示这条边连接着标号为 $ x,y $ 的点，且这条边的权值为 $ d $ 。\n\n输入文件保证 $ 1 \\leq x,y \\leq N $ ， $ x \\neq y $ ，且输入数据保证这个无向图一定是一个连通图。", "outputFormat": "输出文件只有一行，这行只有一个整数，即，使得标号为 $ Lab $ 边一定出现最小生成树中的最少操作次数。", "hint": "$ 1 \\leq N \\leq 500,1 \\leq M \\leq 800,1 \\leq d<10^6 $", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2010] Minimum Spanning Tree", "background": "", "description": "Secsa has recently become very interested in the minimum spanning tree problem. He already knows that to find the minimum spanning tree of an undirected graph with $n$ vertices and $m$ edges, there is the Krustal algorithm and another Prim algorithm. He also knows that a graph may have several different minimum spanning trees. For example, all the graphs shown in Figure 3 below are minimum spanning trees of the undirected graph in Figure 2:\n\n![](https://cdn.luogu.com.cn/upload/pic/43631.png)\n\nOf course, these are not what you need to solve today. Secsa wants to know, for a certain edge $AB$ in an undirected graph, at least how much cost is needed to guarantee that edge $AB$ is in the minimum spanning tree of this undirected graph. To make sure that edge $AB$ must be in the minimum spanning tree, you may perform operations on this undirected graph. A single operation is defined as follows: first choose an edge $P1P2$ in the graph, then decrease the weight of every edge except this one by $1$. Figure 4 shows one such operation:\n\n![](https://cdn.luogu.com.cn/upload/pic/43632.png)", "inputFormat": "The first line of the input file contains three positive integers $n, m, Lab$, which represent the number of vertices, the number of edges, and the index of the edge $AB$ that must appear in the minimum spanning tree.\n\nThe next $m$ lines describe the undirected edges with indices $1, 2, 3 \\ldots m$ in order, one edge per line. Each line contains three integers $x, y, d$, meaning this edge connects vertices $x$ and $y$, and its weight is $d$.\n\nThe input guarantees that $1 \\leq x, y \\leq N$, $x \\neq y$, and the undirected graph is connected.", "outputFormat": "The output file contains only one line with one integer: the minimum number of operations required to ensure that the edge with index $Lab$ must appear in the minimum spanning tree.", "hint": "Constraints: $1 \\leq N \\leq 500$, $1 \\leq M \\leq 800$, $1 \\leq d < 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2010] 最小生成树", "background": "", "description": "Secsa最近对最小生成树问题特别感兴趣。他已经知道如果要去求出一个 $ n $ 个点、 $ m $ 条边的无向图的最小生成树有一个Krustal算法和另一个Prim的算法。另外，他还知道，某一个图可能有多种不同的最小生成树。例如，下面图3中所示的都是图2中的无向图的最小生成树：\n\n![](https://cdn.luogu.com.cn/upload/pic/43631.png)\n\n当然啦，这些都不是今天需要你解决的问题。Secsa想知道对于某一条无向图中的边AB，至少需要多少代价可以保证AB边在这个无向图的最小生成树中。为了使得AB边一定在最小生成树中，你可以对这个无向图进行操作，一次单独的操作是指：先选择一条图中的边 P1P2，再把图中除了这条边以外的边，每一条的权值都减少 $ 1 $ 。如图4所示就是一次这样的操作：\n\n![](https://cdn.luogu.com.cn/upload/pic/43632.png)\n\n", "inputFormat": "输入文件的第一行有3个正整数 $ n,m,Lab $ 分别表示无向图中的点数、边数、必须要在最小生成树中出现的AB边的标号。\n\n接下来 $ m $ 行依次描述标号为 $ 1,2,3 \\ldots m $ 的无向边，每行描述一条边。每个描述包含3个整数 $ x,y,d $ ，表示这条边连接着标号为 $ x,y $ 的点，且这条边的权值为 $ d $ 。\n\n输入文件保证 $ 1 \\leq x,y \\leq N $ ， $ x \\neq y $ ，且输入数据保证这个无向图一定是一个连通图。", "outputFormat": "输出文件只有一行，这行只有一个整数，即，使得标号为 $ Lab $ 边一定出现最小生成树中的最少操作次数。", "hint": "$ 1 \\leq N \\leq 500,1 \\leq M \\leq 800,1 \\leq d<10^6 $", "locale": "zh-CN"}}}
{"pid": "P5040", "type": "P", "difficulty": 4, "samples": [["2  3", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2006", "四川", "各省省选", "Special Judge"], "title": "[SCOI2006] k进制集合的映射", "background": "", "description": "设$A(N,K)$是全体$N$位$K$进制整数$a$的集合（$a$的高位可以为$0$，例如，$0023$可看作一个$4$位$8$进制数，或一个$4$位$5$进制数，由题中指定的条件可以唯一确定），其中$2≤K≤6000$，$N=2$，$3$，$4$，即:$$A(N,K)={a|a=a_1a_2a_3\\cdots a_N,0≤a_i≤K-1,i=1,\\cdots,N}$$\n\n设$D(N-1,K)$是$A(N-1,K)$的一个子集，它是由$A(N,K)$生成的一个$N-1$位$K$进制整数$d$的集合，**生成规则如下**:\n\n对任何$d\\in D(N-1,K)$，存在$a\\in A(N,K)$，使$d=Image(a)$，其中，$d=d_1d_2\\cdots d_{N-1},d_i=min(a_i,a_{i+1})$，即$d_i$取为$a_i,a_{i+1}$的最小值。\n\n注1：我们称这个规则为$A(N,K)$ 到$A(N-1,K)$内的一个映射$d=Image(a)$，可以证明这个映射是多对一的，即：如果$d,e\\in D(N-1,k)$且$d\\not=e$，则对任何满足$d=Image(a),e=Image(c)$的$A(N,K)$中的元素$a,c$，均有$a\\not=c$\n \n注2：对某些$K,N$, $D(N-1,K)$是$A(N-1,K)$的一个真子集，例如$K=4,N=4$，则不存在$a\\in A(4,4)$，使$Image(a)=(323)$\n\n**任务**：从文本文件输入两个用空格隔开的整数 $N,K$，然后在指定的文本文件中输出下列表达式的值：\n\n$$f(N,K)=\\sum_{a\\in A(N,K),Image(a)=d}(\\prod_{i=1}^{N-1}(d_i+1))$$\n\n上式表示对$A(N,K)$中的全部元素$a$，对其映像$d=Image(a)=d_1d_2\\cdots d_{N-1}$的各位数字加$1$后的乘积求和。\n\n其中$\\prod^{N-1}_{i=1}(d_i+1)=(d_1+1)(d_2+1)\\cdots(d_{N-1}+1)$\n\n**例**：设$N=2,K=3$，则$A(N,K)={00,01,02,11,10,12,20,21,22}$，正确的输出结果应为$14$。\n\n**提示**：应先建立相应的计算方法，直接利用$f(N,K)$的表达式计算会使多数测试超时。", "inputFormat": "输入文件只有一行：用空格隔开的两个整数N  k。", "outputFormat": "输出文件只有一个大整数，为计算结果。", "hint": "**关于测试的说明**：\n\n数字完全正确，给满分。当输出结果的位数超过$15$位时，如果仅最后两位不准确时给一半分。（每个需测试的计算结果不超过$10^{19}$）。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2006] Mapping of Sets in Base $K$", "background": "", "description": "Let $A(N,K)$ be the set of all $N$-digit base-$K$ integers $a$ (the most significant digit of $a$ may be $0$; for example, $0023$ can be regarded as a $4$-digit base-$8$ number or a $4$-digit base-$5$ number. Under the conditions specified in the problem, it can be uniquely determined), where $2 \\le K \\le 6000$ and $N = 2, 3, 4$. That is,\n$$A(N,K)={a|a=a_1a_2a_3\\cdots a_N,0≤a_i≤K-1,i=1,\\cdots,N}$$\n\nLet $D(N-1,K)$ be a subset of $A(N-1,K)$. It is the set of $(N-1)$-digit base-$K$ integers $d$ generated from $A(N,K)$. **The generation rule is as follows**:\n\nFor any $d \\in D(N-1,K)$, there exists $a \\in A(N,K)$ such that $d = Image(a)$, where $d = d_1d_2\\cdots d_{N-1}$ and $d_i = min(a_i,a_{i+1})$. That is, $d_i$ is the smaller one of $a_i$ and $a_{i+1}$.\n\nNote 1: We call this rule a mapping from $A(N,K)$ to $A(N-1,K)$, written as $d = Image(a)$. It can be proven that this mapping is many-to-one. That is, if $d,e \\in D(N-1,k)$ and $d \\not= e$, then for any elements $a,c \\in A(N,K)$ satisfying $d = Image(a)$ and $e = Image(c)$, we have $a \\not= c$.\n\nNote 2: For some $K,N$, $D(N-1,K)$ is a proper subset of $A(N-1,K)$. For example, when $K=4,N=4$, there does not exist any $a \\in A(4,4)$ such that $Image(a)=(323)$.\n\n**Task**: Read two integers $N,K$ separated by a space from the input text file, and then output the value of the following expression to the specified output text file:\n\n$$f(N,K)=\\sum_{a\\in A(N,K),Image(a)=d}(\\prod_{i=1}^{N-1}(d_i+1))$$\n\nThe expression above means: for all elements $a$ in $A(N,K)$, let its image be $d = Image(a) = d_1d_2\\cdots d_{N-1}$, add $1$ to each digit of $d$, take the product, and then sum these products.\n\nWhere\n$$\\prod^{N-1}_{i=1}(d_i+1)=(d_1+1)(d_2+1)\\cdots(d_{N-1}+1)$$\n\n**Example**: Let $N=2,K=3$. Then $A(N,K)={00,01,02,11,10,12,20,21,22}$, and the correct output should be $14$.\n\n**Hint**: You should first build a suitable method for computation. Directly computing using the expression of $f(N,K)$ will cause most testdata to time out.", "inputFormat": "The input file contains only one line: two integers $N$ and $K$ separated by a space.", "outputFormat": "Output a single big integer, which is the computed result.", "hint": "**About the tests**:\n\nFull marks are given if the number is completely correct. When the number of digits of the output exceeds $15$, if only the last two digits are incorrect, half of the score is given. (Each required result does not exceed $10^{19}$.)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2006] k进制集合的映射", "background": "", "description": "设$A(N,K)$是全体$N$位$K$进制整数$a$的集合（$a$的高位可以为$0$，例如，$0023$可看作一个$4$位$8$进制数，或一个$4$位$5$进制数，由题中指定的条件可以唯一确定），其中$2≤K≤6000$，$N=2$，$3$，$4$，即:$$A(N,K)={a|a=a_1a_2a_3\\cdots a_N,0≤a_i≤K-1,i=1,\\cdots,N}$$\n\n设$D(N-1,K)$是$A(N-1,K)$的一个子集，它是由$A(N,K)$生成的一个$N-1$位$K$进制整数$d$的集合，**生成规则如下**:\n\n对任何$d\\in D(N-1,K)$，存在$a\\in A(N,K)$，使$d=Image(a)$，其中，$d=d_1d_2\\cdots d_{N-1},d_i=min(a_i,a_{i+1})$，即$d_i$取为$a_i,a_{i+1}$的最小值。\n\n注1：我们称这个规则为$A(N,K)$ 到$A(N-1,K)$内的一个映射$d=Image(a)$，可以证明这个映射是多对一的，即：如果$d,e\\in D(N-1,k)$且$d\\not=e$，则对任何满足$d=Image(a),e=Image(c)$的$A(N,K)$中的元素$a,c$，均有$a\\not=c$\n \n注2：对某些$K,N$, $D(N-1,K)$是$A(N-1,K)$的一个真子集，例如$K=4,N=4$，则不存在$a\\in A(4,4)$，使$Image(a)=(323)$\n\n**任务**：从文本文件输入两个用空格隔开的整数 $N,K$，然后在指定的文本文件中输出下列表达式的值：\n\n$$f(N,K)=\\sum_{a\\in A(N,K),Image(a)=d}(\\prod_{i=1}^{N-1}(d_i+1))$$\n\n上式表示对$A(N,K)$中的全部元素$a$，对其映像$d=Image(a)=d_1d_2\\cdots d_{N-1}$的各位数字加$1$后的乘积求和。\n\n其中$\\prod^{N-1}_{i=1}(d_i+1)=(d_1+1)(d_2+1)\\cdots(d_{N-1}+1)$\n\n**例**：设$N=2,K=3$，则$A(N,K)={00,01,02,11,10,12,20,21,22}$，正确的输出结果应为$14$。\n\n**提示**：应先建立相应的计算方法，直接利用$f(N,K)$的表达式计算会使多数测试超时。", "inputFormat": "输入文件只有一行：用空格隔开的两个整数N  k。", "outputFormat": "输出文件只有一个大整数，为计算结果。", "hint": "**关于测试的说明**：\n\n数字完全正确，给满分。当输出结果的位数超过$15$位时，如果仅最后两位不准确时给一半分。（每个需测试的计算结果不超过$10^{19}$）。", "locale": "zh-CN"}}}
{"pid": "P5041", "type": "P", "difficulty": 5, "samples": [["SHLLZSHZS", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "河南", "各省省选"], "title": "[HAOI2009] 求回文串", "background": "", "description": "所谓回文串，就是对于给定的字符串，正着读和反着读都一样，比如 ABCBA 就是一个回文串，ABCAB 则不是。我们的目标是对于任意输入的字符串，不断将第 $i$ 个字符和第 $i+1$ 个字符交换，使得该串最终变为回文串。求最少交换次数。", "inputFormat": "一个由大写字母字母组成的字符串。", "outputFormat": "若能经过有限次操作能将原串变为回文串，则输出最少操作次数；否则输出 $-1$。", "hint": "### 样例说明\n\n1. 交换 $\\tt L$ 和 $\\tt Z$ 变成 $\\tt SHLZLSHZS$；\n2. 交换 $\\tt L$ 和 $\\tt Z$ 变成 $\\tt SHZLLSHZS$；\n3. 交换 $\\tt L$ 和 $\\tt S$ 变成 $\\tt SHZLSLHZS$；\n4. 交换 $\\tt H$ 和 $\\tt Z$ 变成 $\\tt SHZLSLZHS$。\n\n### 数据范围\n\n- $40\\%$ 的数据，长度 $\\leq50000$；\n- $100\\%$ 的数据，长度 $\\leq10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2009] Make a Palindrome", "background": "", "description": "A palindrome is a string that reads the same forwards and backwards. For example, ABCBA is a palindrome, while ABCAB is not. Given any input string, you may repeatedly swap the $i$-th character with the $(i+1)$-th character to eventually make the string a palindrome. Find the minimum number of swaps.", "inputFormat": "A string consisting of uppercase letters.", "outputFormat": "If it can be transformed into a palindrome by a finite number of operations, output the minimum number of operations; otherwise output $-1$.", "hint": "Sample Explanation:\n1. Swap $\\tt L$ and $\\tt Z$ to get $\\tt SHLZLSHZS$.\n2. Swap $\\tt L$ and $\\tt Z$ to get $\\tt SHZLLSHZS$.\n3. Swap $\\tt L$ and $\\tt S$ to get $\\tt SHZLSLHZS$.\n4. Swap $\\tt H$ and $\\tt Z$ to get $\\tt SHZLSLZHS$.\n\nConstraints:\n- For $40\\%$ of the testdata, length $\\leq50000$.\n- For $100\\%$ of the testdata, length $\\leq10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2009] 求回文串", "background": "", "description": "所谓回文串，就是对于给定的字符串，正着读和反着读都一样，比如 ABCBA 就是一个回文串，ABCAB 则不是。我们的目标是对于任意输入的字符串，不断将第 $i$ 个字符和第 $i+1$ 个字符交换，使得该串最终变为回文串。求最少交换次数。", "inputFormat": "一个由大写字母字母组成的字符串。", "outputFormat": "若能经过有限次操作能将原串变为回文串，则输出最少操作次数；否则输出 $-1$。", "hint": "### 样例说明\n\n1. 交换 $\\tt L$ 和 $\\tt Z$ 变成 $\\tt SHLZLSHZS$；\n2. 交换 $\\tt L$ 和 $\\tt Z$ 变成 $\\tt SHZLLSHZS$；\n3. 交换 $\\tt L$ 和 $\\tt S$ 变成 $\\tt SHZLSLHZS$；\n4. 交换 $\\tt H$ 和 $\\tt Z$ 变成 $\\tt SHZLSLZHS$。\n\n### 数据范围\n\n- $40\\%$ 的数据，长度 $\\leq50000$；\n- $100\\%$ 的数据，长度 $\\leq10^6$。", "locale": "zh-CN"}}}
{"pid": "P5042", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "集训队互测"], "title": "[集训队互测 2015] 丢失的题面（ydc的题面）", "background": null, "description": "曾经，有一个题面摆在 ydc 的面前没有珍惜，直到失去时才后悔莫及，\n\n如果上天再给他一次机会，ydc 一定会牢牢的记住这个题面。\n\n没办法，已经失去了，所以这道题只能让你帮 ydc 做了。\n\n已知的信息只有，这道题是传统题，采用全文比较的方式，时间限制 1s，空间限制 256MB。\n\nydc 还给你提供了这道题的所有数据（见附件）。", "inputFormat": "已给出", "outputFormat": "已给出", "hint": "### 来源\n\n中国国家集训队互测2015 \n\n### Author\n\n于纪平", "locale": "zh-CN", "translations": {"en": {"title": "[CTT Mutual Test 2015] The Lost Problem Statement (ydc’s statement).", "background": "", "description": "Once, there was a problem statement placed in front of ydc, but he did not cherish it, and only felt deep regret after it was lost.\n\nIf Heaven could give him one more chance, ydc would definitely remember this problem statement firmly.\n\nBut there is no way—since it has already been lost, this problem can only be done with your help for ydc.\n\nThe only information known is that this is a traditional problem, it uses full-text comparison, the time limit is 1 s, and the memory limit is 256 MB.\n\nydc also provides you with all the testdata for this problem (see the attachment).", "inputFormat": "Already given.", "outputFormat": "Already given.", "hint": "### Source\n\nChina National CTT Mutual Test 2015.\n\n### Author\n\nYu Jiping.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[集训队互测 2015] 丢失的题面（ydc的题面）", "background": null, "description": "曾经，有一个题面摆在 ydc 的面前没有珍惜，直到失去时才后悔莫及，\n\n如果上天再给他一次机会，ydc 一定会牢牢的记住这个题面。\n\n没办法，已经失去了，所以这道题只能让你帮 ydc 做了。\n\n已知的信息只有，这道题是传统题，采用全文比较的方式，时间限制 1s，空间限制 256MB。\n\nydc 还给你提供了这道题的所有数据（见附件）。", "inputFormat": "已给出", "outputFormat": "已给出", "hint": "### 来源\n\n中国国家集训队互测2015 \n\n### Author\n\n于纪平", "locale": "zh-CN"}}}
{"pid": "P5043", "type": "P", "difficulty": 5, "samples": [["4 \n4 0 1 1 2 \n4 2 0 2 3 \n4 0 1 1 1 \n4 0 1 2 3 ", "1 \n1 \n3 \n1 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "2015", "各省省选", "北京", "哈希 hashing", "模板题"], "title": "【模板】树同构 / [BJOI2015] 树的同构", "background": null, "description": "树是一种很常见的数据结构。\n\n我们把 $N$ 个点，$N-1$ 条边的连通无向图称为树。\n\n若将某个点作为根，从根开始遍历，则其它的点都有一个前驱，这个树就成为有根树。\n\n对于两个树 $T_1$ 和 $T_2$，如果能够把树 $T_1$ 的所有点重新标号，使得树 $T_1$ 和树 $T_2$ 完全相同，那么这两个树是同构的。也就是说，它们具有相同的形态。\n\n现在，给你 $M$ 个无根树，请你把它们按同构关系分成若干个等价类。", "inputFormat": "第一行，一个整数 $M$。\n\n接下来 $M$ 行，每行包含若干个整数，表示一个树。第一个整数 $N$表示点数。接下来 $N$ 个整数，依次表示编号为 $1$ 到 $N$ 的每个点的父亲结点的编号。根节点父亲结点编号为 $0$。", "outputFormat": "输出 $M$ 行，每行一个整数，表示与每个树同构的树的最小编号。", "hint": "编号为 $1, 2, 4$ 的树是同构的。编号为 $3$ 的树只与它自身同构。\n\n对于 $100\\%$ 的数据，保证 $1\\leq N,M\\leq 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Tree Isomorphism / [BJOI2015] Tree Isomorphism.", "background": "", "description": "A tree is a very common data structure.\n\nWe call a connected undirected graph with $N$ vertices and $N - 1$ edges a tree.\n\nIf we choose a vertex as the root and traverse from the root, then every other vertex has a predecessor. This tree becomes a rooted tree.\n\nFor two trees $T_1$ and $T_2$, if we can relabel all vertices of $T_1$ so that $T_1$ and $T_2$ become exactly the same, then these two trees are isomorphic. That is, they have the same shape.\n\nNow you are given $M$ unrooted trees. Please partition them into several equivalence classes according to the isomorphism relation.", "inputFormat": "The first line contains an integer $M$.\n\nThe next $M$ lines each contain several integers describing one tree. The first integer is $N$, the number of vertices. Then follow $N$ integers, which in order give the parent vertex number of each vertex numbered from $1$ to $N$. The parent number of the root vertex is $0$.", "outputFormat": "Output $M$ lines. Each line contains one integer, representing the smallest index among the trees that are isomorphic to the corresponding tree.", "hint": "Trees numbered $1$, $2$, and $4$ are isomorphic. The tree numbered $3$ is only isomorphic to itself.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\leq N, M \\leq 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】树同构 / [BJOI2015] 树的同构", "background": null, "description": "树是一种很常见的数据结构。\n\n我们把 $N$ 个点，$N-1$ 条边的连通无向图称为树。\n\n若将某个点作为根，从根开始遍历，则其它的点都有一个前驱，这个树就成为有根树。\n\n对于两个树 $T_1$ 和 $T_2$，如果能够把树 $T_1$ 的所有点重新标号，使得树 $T_1$ 和树 $T_2$ 完全相同，那么这两个树是同构的。也就是说，它们具有相同的形态。\n\n现在，给你 $M$ 个无根树，请你把它们按同构关系分成若干个等价类。", "inputFormat": "第一行，一个整数 $M$。\n\n接下来 $M$ 行，每行包含若干个整数，表示一个树。第一个整数 $N$表示点数。接下来 $N$ 个整数，依次表示编号为 $1$ 到 $N$ 的每个点的父亲结点的编号。根节点父亲结点编号为 $0$。", "outputFormat": "输出 $M$ 行，每行一个整数，表示与每个树同构的树的最小编号。", "hint": "编号为 $1, 2, 4$ 的树是同构的。编号为 $3$ 的树只与它自身同构。\n\n对于 $100\\%$ 的数据，保证 $1\\leq N,M\\leq 50$。", "locale": "zh-CN"}}}
{"pid": "P5044", "type": "P", "difficulty": 7, "samples": [["4 2\n2 4 3 5\n0 2\n1 3\n", "10\n12\n"], ["3 3\n2 1 2\n0 0\n0 1\n0 2\n", "2\n3\n5\n"], ["5 1\n1000000000 1000000000 1 1000000000 1000000000\n0 4\n", "4000000001\n"], ["15 10\n10 71 84 33 6 47 23 25 52 64 70 31 22 31 2\n5 10\n3 7\n0 13\n8 12\n0 0\n1 3\n7 13\n1 13\n10 12\n1 1\n", "281\n180\n828\n263\n10\n201\n364\n744\n123\n71\n"]], "limits": {"time": [4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500], "memory": [824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320, 824320]}, "tags": ["2018", "IOI", "O2优化"], "title": "[IOI 2018] meetings 会议", "background": "本题为交互题，但在此请提交**完整程序**。", "description": "有 $N$ 座山横着排成一行，从左到右编号为从 $0$ 到 $N-1$。山的高度为 $H_i$（$0\\leq i\\leq N-1$）。每座山的顶上恰好住着一个人。\n\n你打算举行 $Q$ 个会议，编号为从 $0$ 到 $Q-1$。会议 $j$（$0\\leq j\\leq Q-1$） 的参加者为住在从山 $L_j$ 到山 $R_j$（包括 $L_j$ 和 $R_j$）上的人（$0\\leq L_j\\leq R_j\\leq N-1$）。对于该会议，你必须选择某个山 $x$ 做为会议举办地（$L_j\\leq x\\leq R_j$）。举办该会议的成本与你的选择有关，其计算方式如下：\n\n- 来自每座山 $y$（$L_j\\leq y\\leq R_j$） 的参会者的成本，等于在山 $x$ 和 $y$ 之间（包含 $x$ 和 $y$）的所有山的最大高度。特别地，来自山 $x$ 的参会者的成本是 $H_x$，也就是山 $x$ 的高度。\n\n- 会议的成本等于其所有参会者的成本之和。\n\n你想要用最低的成本来举办每个会议。\n\n注意，所有的参会者将在每次会议后回到他们自己的山；所以一个会议的成本不会受到先前会议的影响。", "inputFormat": "输入的第一行包含两个正整数 $N$ 和 $Q$，其意义见题目描述。\n\n第二行包含 $N$ 个正整数 $H_0,H_1,\\cdots, H_{N-1}$，表示这些山的高度。\n\n第 $3+j$ 行（$0\\leq j\\leq Q-1$），每行两个整数 $L_j, R_j$，表示这些会议的参会者的范围。", "outputFormat": "共 $Q$ 行，第 $1+j$ 行（$0\\leq j\\leq Q-1$）一个整数 $C_j$，表示举办会议 $j $ 的最低的可能成本。", "hint": "### 样例#1解释\n\n会议$j=0$有$L_j=0$和$R_j=2$，所以将由住在山$0$、$1$和$2$上的人参加。如果山$0$被选做举办地，会议$0$的成本计算如下：\n\n- 住在山$0$上的参会者的成本是$\\max\\lbrace H_0\\rbrace=2$。\n- 住在山$1$上的参会者的成本是$\\max\\lbrace H_0,H_1\\rbrace=4$。\n- 住在山$2$上的参会者的成本是$\\max\\lbrace H_0,H_1,H_2\\rbrace=4$。\n- 因此，会议$0$的成本是$2+4+4=10$。\n\n不可能以更低的成本来举办会议$0$了，因此会议$0$的最低成本是$10$。\n\n会议$j=1$有$L_j=1$和$R_j=3$，因此将由住在山$1$、$2$和$3$上的人参加。如果山$2$被选做举办地，会议$1$的成本计算如下：\n\n- 住在山$1$上的参会者的成本是$\\max\\lbrace H_1,H_2\\rbrace=4$。\n- 住在山$2$上的参会者的成本是$\\max\\lbrace H_2\\rbrace=3$。\n- 住在山$3$上的参会者的成本是$\\max\\lbrace H_1,H_2,H_3\\rbrace=5$。\n- 因此，会议$1$的成本是$4+3+5=12$。\n\n不可能以更低的成本来举办会议$1$了，所以会议$1$的最低成本是$12$。\n\n### 限制条件\n\n- $1\\leq N\\leq 750\\space000$\n- $1\\leq Q\\leq 750\\space000$\n- $1\\leq H_i\\leq1\\space000\\space000\\space000$\n- $0\\leq L_j\\leq R_j\\leq R-1(0\\leq j\\leq Q-1)$\n- $(L_j,R_j)\\neq(L_k,R_k)(0\\leq j<k\\leq Q-1)$\n\n### 子任务\n\n1. (4分) $N\\leq3000,Q\\leq10$\n2. (15分) $N\\leq5000,Q\\leq5000$\n3. (17分) $N\\leq100\\space000,Q\\leq100\\space000,H_i\\leq2(0\\leq i\\leq N-1)$\n4. (24分) $N\\leq100\\space000,Q\\leq100\\space000,H_i\\leq20(0\\leq i\\leq N-1)$\n5. (40分) 没有附加限制\n\n### Author\n\nRiku Kawasaki (Japan)\n\n### Source\n\nIOI 2018 D2T3", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2018] meetings Meeting.", "background": "This is an interactive problem, but here you should submit a **complete program**.", "description": "There are $N$ mountains arranged in a horizontal line, numbered from $0$ to $N-1$ from left to right. The height of mountain $i$ is $H_i$ ($0\\leq i\\leq N-1$). Exactly one person lives on the top of each mountain.\n\nYou plan to hold $Q$ meetings, numbered from $0$ to $Q-1$. The participants of meeting $j$ ($0\\leq j\\leq Q-1$) are the people living on mountains from $L_j$ to $R_j$ (including $L_j$ and $R_j$) ($0\\leq L_j\\leq R_j\\leq N-1$). For this meeting, you must choose some mountain $x$ as the meeting location ($L_j\\leq x\\leq R_j$). The cost of holding the meeting depends on your choice, and is computed as follows:\n\n- The cost for each participant coming from a mountain $y$ ($L_j\\leq y\\leq R_j$) equals the maximum height among all mountains between $x$ and $y$ (including $x$ and $y$). In particular, the cost for the participant from mountain $x$ is $H_x$, i.e. the height of mountain $x$.\n\n- The cost of the meeting equals the sum of the costs of all its participants.\n\nYou want to hold each meeting with the minimum possible cost.\n\nNote that all participants return to their own mountains after each meeting, so the cost of a meeting is not affected by previous meetings.", "inputFormat": "The first line contains two positive integers $N$ and $Q$, as described above.\n\nThe second line contains $N$ positive integers $H_0,H_1,\\cdots, H_{N-1}$, representing the heights of the mountains.\n\nLine $3+j$ ($0\\leq j\\leq Q-1$) contains two integers $L_j, R_j$, describing the participant range of the meeting.", "outputFormat": "Output $Q$ lines. Line $1+j$ ($0\\leq j\\leq Q-1$) contains one integer $C_j$, the minimum possible cost of holding meeting $j$.", "hint": "### Explanation of Sample #1\n\nMeeting $j=0$ has $L_j=0$ and $R_j=2$, so it will be attended by the people living on mountains $0$, $1$, and $2$. If mountain $0$ is chosen as the meeting location, the cost of meeting $0$ is computed as follows:\n\n- The cost for the participant from mountain $0$ is $\\max\\lbrace H_0\\rbrace=2$.\n- The cost for the participant from mountain $1$ is $\\max\\lbrace H_0,H_1\\rbrace=4$.\n- The cost for the participant from mountain $2$ is $\\max\\lbrace H_0,H_1,H_2\\rbrace=4$.\n- Therefore, the total cost of meeting $0$ is $2+4+4=10$.\n\nIt is not possible to hold meeting $0$ at a lower cost, so the minimum cost of meeting $0$ is $10$.\n\nMeeting $j=1$ has $L_j=1$ and $R_j=3$, so it will be attended by the people living on mountains $1$, $2$, and $3$. If mountain $2$ is chosen as the meeting location, the cost of meeting $1$ is computed as follows:\n\n- The cost for the participant from mountain $1$ is $\\max\\lbrace H_1,H_2\\rbrace=4$.\n- The cost for the participant from mountain $2$ is $\\max\\lbrace H_2\\rbrace=3$.\n- The cost for the participant from mountain $3$ is $\\max\\lbrace H_1,H_2,H_3\\rbrace=5$.\n- Therefore, the total cost of meeting $1$ is $4+3+5=12$.\n\nIt is not possible to hold meeting $1$ at a lower cost, so the minimum cost of meeting $1$ is $12$.\n\n### Constraints\n\n- $1\\leq N\\leq 750\\space000$\n- $1\\leq Q\\leq 750\\space000$\n- $1\\leq H_i\\leq1\\space000\\space000\\space000$\n- $0\\leq L_j\\leq R_j\\leq N-1(0\\leq j\\leq Q-1)$\n- $(L_j,R_j)\\neq(L_k,R_k)(0\\leq j<k\\leq Q-1)$\n\n### Subtasks\n\n1. (4 points) $N\\leq3000,Q\\leq10$.\n2. (15 points) $N\\leq5000,Q\\leq5000$.\n3. (17 points) $N\\leq100\\space000,Q\\leq100\\space000,H_i\\leq2(0\\leq i\\leq N-1)$.\n4. (24 points) $N\\leq100\\space000,Q\\leq100\\space000,H_i\\leq20(0\\leq i\\leq N-1)$.\n5. (40 points) No additional constraints.\n\n### Author\n\nRiku Kawasaki (Japan).\n\n### Source\n\nIOI 2018 D2T3.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2018] meetings 会议", "background": "本题为交互题，但在此请提交**完整程序**。", "description": "有 $N$ 座山横着排成一行，从左到右编号为从 $0$ 到 $N-1$。山的高度为 $H_i$（$0\\leq i\\leq N-1$）。每座山的顶上恰好住着一个人。\n\n你打算举行 $Q$ 个会议，编号为从 $0$ 到 $Q-1$。会议 $j$（$0\\leq j\\leq Q-1$） 的参加者为住在从山 $L_j$ 到山 $R_j$（包括 $L_j$ 和 $R_j$）上的人（$0\\leq L_j\\leq R_j\\leq N-1$）。对于该会议，你必须选择某个山 $x$ 做为会议举办地（$L_j\\leq x\\leq R_j$）。举办该会议的成本与你的选择有关，其计算方式如下：\n\n- 来自每座山 $y$（$L_j\\leq y\\leq R_j$） 的参会者的成本，等于在山 $x$ 和 $y$ 之间（包含 $x$ 和 $y$）的所有山的最大高度。特别地，来自山 $x$ 的参会者的成本是 $H_x$，也就是山 $x$ 的高度。\n\n- 会议的成本等于其所有参会者的成本之和。\n\n你想要用最低的成本来举办每个会议。\n\n注意，所有的参会者将在每次会议后回到他们自己的山；所以一个会议的成本不会受到先前会议的影响。", "inputFormat": "输入的第一行包含两个正整数 $N$ 和 $Q$，其意义见题目描述。\n\n第二行包含 $N$ 个正整数 $H_0,H_1,\\cdots, H_{N-1}$，表示这些山的高度。\n\n第 $3+j$ 行（$0\\leq j\\leq Q-1$），每行两个整数 $L_j, R_j$，表示这些会议的参会者的范围。", "outputFormat": "共 $Q$ 行，第 $1+j$ 行（$0\\leq j\\leq Q-1$）一个整数 $C_j$，表示举办会议 $j $ 的最低的可能成本。", "hint": "### 样例#1解释\n\n会议$j=0$有$L_j=0$和$R_j=2$，所以将由住在山$0$、$1$和$2$上的人参加。如果山$0$被选做举办地，会议$0$的成本计算如下：\n\n- 住在山$0$上的参会者的成本是$\\max\\lbrace H_0\\rbrace=2$。\n- 住在山$1$上的参会者的成本是$\\max\\lbrace H_0,H_1\\rbrace=4$。\n- 住在山$2$上的参会者的成本是$\\max\\lbrace H_0,H_1,H_2\\rbrace=4$。\n- 因此，会议$0$的成本是$2+4+4=10$。\n\n不可能以更低的成本来举办会议$0$了，因此会议$0$的最低成本是$10$。\n\n会议$j=1$有$L_j=1$和$R_j=3$，因此将由住在山$1$、$2$和$3$上的人参加。如果山$2$被选做举办地，会议$1$的成本计算如下：\n\n- 住在山$1$上的参会者的成本是$\\max\\lbrace H_1,H_2\\rbrace=4$。\n- 住在山$2$上的参会者的成本是$\\max\\lbrace H_2\\rbrace=3$。\n- 住在山$3$上的参会者的成本是$\\max\\lbrace H_1,H_2,H_3\\rbrace=5$。\n- 因此，会议$1$的成本是$4+3+5=12$。\n\n不可能以更低的成本来举办会议$1$了，所以会议$1$的最低成本是$12$。\n\n### 限制条件\n\n- $1\\leq N\\leq 750\\space000$\n- $1\\leq Q\\leq 750\\space000$\n- $1\\leq H_i\\leq1\\space000\\space000\\space000$\n- $0\\leq L_j\\leq R_j\\leq R-1(0\\leq j\\leq Q-1)$\n- $(L_j,R_j)\\neq(L_k,R_k)(0\\leq j<k\\leq Q-1)$\n\n### 子任务\n\n1. (4分) $N\\leq3000,Q\\leq10$\n2. (15分) $N\\leq5000,Q\\leq5000$\n3. (17分) $N\\leq100\\space000,Q\\leq100\\space000,H_i\\leq2(0\\leq i\\leq N-1)$\n4. (24分) $N\\leq100\\space000,Q\\leq100\\space000,H_i\\leq20(0\\leq i\\leq N-1)$\n5. (40分) 没有附加限制\n\n### Author\n\nRiku Kawasaki (Japan)\n\n### Source\n\nIOI 2018 D2T3", "locale": "zh-CN"}}}
{"pid": "P5045", "type": "P", "difficulty": 3, "samples": [["2\n2 0 6\n5 1 6\n1\n3 4 2\n2 2", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2003", "四川", "各省省选"], "title": "[SCOI2003] 蜘蛛难题", "background": "", "description": "有一堆管道，还有一个蜘蛛$\\text{Willy}$，如下图所示。所有管道的是上端开口，下端封底，直径都是$1cm$，连接两个管道的连接容量无限，但体积可以忽略不计。\n\n![](https://cdn.luogu.com.cn/upload/pic/43701.png)\n\n在第一个管道上方有一个水源，从中有水不断往下流，速度为每秒$0.25cm^3$。由于管道横截面积为$0.25cm^3$，所以单给一个管道注水时水面每秒上升$1cm$。根据物理知识，在前$2$秒中，水注如左边的管道底部，第$[3,5]$秒时注入右边的管道，第$[6,9]$秒同时注入两个管道（虽然流量不变，但是由于同时给两个管道注水，因此水面上升的速度仅为每秒$0.5cm$），接触到蜘蛛。 给出管道和管道之间连接的位置，以及蜘蛛$\\text{Willy}$的位置，求水面接触到$\\text{Willy}$的时间。假设蜘蛛的实际位置比给出的略高一点，因此如果蜘蛛在左边管道的$n=4$的位置，答案应该是$5$秒。因为前两秒后水面虽然看起来接触到了$\\text{Willy}$，但实际上比$\\text{Willy}$略低一点。\n\n", "inputFormat": "所有位置都用有序数对$(x, y)$表示，其中y坐标从上到下逐渐增大；$x$坐标从左到右逐渐增大，因此左上角的坐标为$(0,0)$，其他所有坐标值为$0$到$100$之间的整数。输入第一行为一个整数$p(1<=p<=20)$，表示管道的数目；以下$p$行，每行用$x, y, h$三个整数描述一根管道。$(x,y)$为管道左上角坐标；$h$为管道高度$(1<=h<=20)$。以下一行为一个整数$L(0<=L<=50)$，为连接的个数。\n\n以下$L$行每行用三个整数$x, y, d$描述一个连接，$(x,y)$为左端点的坐标，$d$为连接的长度$(1<=d<=20)$。最后一行为两个整数$a,b$，表示$\\text{Willy}$在管道$a$的$y$坐标为$b$的位置。管道按照在文件中出现的顺序编号为$1,2,3…p$\n\n以下为一些假设： 水源总是在第一根管道的正上方, 连接不会穿越管道,任意两个连接的$y$坐标都不相同,任意两个管道的左上角的$x$坐标都不相同,任意连接的两个端点都在管道上（不会出现悬空的情形）", "outputFormat": "仅一个整数，为水面接触到$\\text{Willy}$的时间。如果水面无法接触到$\\text{Willy}$，输出$-1$。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2003] Spider Problem", "background": "", "description": "There is a set of pipes and a spider $\\text{Willy}$, as shown in the figure below. All pipes are open at the top and sealed at the bottom. Each pipe has a diameter of $1cm$. The connections between two pipes have infinite capacity, but their volume can be ignored.\n\n![](https://cdn.luogu.com.cn/upload/pic/43701.png)\n\nAbove the first pipe there is a water source, from which water keeps flowing downward at a rate of $0.25cm^3$ per second. Since the cross-sectional area of a pipe is $0.25cm^2$, when filling only one pipe, the water level rises by $1cm$ per second. According to physics, during the first $2$ seconds, the water flows into the bottom of the left pipe; during seconds $[3,5]$, it flows into the right pipe; during seconds $[6,9]$, it flows into both pipes at the same time (although the total flow rate is unchanged, because two pipes are filled simultaneously, the rising speed in each pipe is only $0.5cm$ per second), and then it reaches the spider.\n\nGiven the positions of the connections between pipes and the position of the spider $\\text{Willy}$, find the time when the water level touches $\\text{Willy}$. Assume the spider’s actual position is slightly higher than the given one. Therefore, if the spider is at position $n=4$ in the left pipe, the answer should be $5$ seconds. This is because after the first two seconds the water level seems to touch $\\text{Willy}$, but it is actually slightly below $\\text{Willy}$.", "inputFormat": "All positions are represented by ordered pairs $(x, y)$, where the $y$ coordinate increases from top to bottom, and the $x$ coordinate increases from left to right. Therefore, the top-left corner is $(0,0)$. All other coordinate values are integers between $0$ and $100$.\n\nThe first line contains an integer $p(1<=p<=20)$, the number of pipes. The next $p$ lines each contain three integers $x, y, h$ describing one pipe. $(x,y)$ is the coordinate of the top-left corner of the pipe, and $h$ is the height of the pipe $(1<=h<=20)$.\n\nThe next line contains an integer $L(0<=L<=50)$, the number of connections.\n\nThe next $L$ lines each contain three integers $x, y, d$ describing a connection. $(x,y)$ is the coordinate of the left endpoint, and $d$ is the length of the connection $(1<=d<=20)$.\n\nThe last line contains two integers $a,b$, meaning that $\\text{Willy}$ is in pipe $a$ at the position whose $y$ coordinate is $b$. Pipes are numbered $1,2,3…p$ in the order they appear in the input file.\n\nThe following assumptions hold: the water source is always directly above the first pipe; connections do not cross pipes; the $y$ coordinates of any two connections are different; the $x$ coordinates of the top-left corners of any two pipes are different; and both endpoints of every connection lie on pipes (there will be no “hanging” endpoints).", "outputFormat": "Output only one integer: the time when the water level touches $\\text{Willy}$. If the water level can never touch $\\text{Willy}$, output $-1$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2003] 蜘蛛难题", "background": "", "description": "有一堆管道，还有一个蜘蛛$\\text{Willy}$，如下图所示。所有管道的是上端开口，下端封底，直径都是$1cm$，连接两个管道的连接容量无限，但体积可以忽略不计。\n\n![](https://cdn.luogu.com.cn/upload/pic/43701.png)\n\n在第一个管道上方有一个水源，从中有水不断往下流，速度为每秒$0.25cm^3$。由于管道横截面积为$0.25cm^3$，所以单给一个管道注水时水面每秒上升$1cm$。根据物理知识，在前$2$秒中，水注如左边的管道底部，第$[3,5]$秒时注入右边的管道，第$[6,9]$秒同时注入两个管道（虽然流量不变，但是由于同时给两个管道注水，因此水面上升的速度仅为每秒$0.5cm$），接触到蜘蛛。 给出管道和管道之间连接的位置，以及蜘蛛$\\text{Willy}$的位置，求水面接触到$\\text{Willy}$的时间。假设蜘蛛的实际位置比给出的略高一点，因此如果蜘蛛在左边管道的$n=4$的位置，答案应该是$5$秒。因为前两秒后水面虽然看起来接触到了$\\text{Willy}$，但实际上比$\\text{Willy}$略低一点。\n\n", "inputFormat": "所有位置都用有序数对$(x, y)$表示，其中y坐标从上到下逐渐增大；$x$坐标从左到右逐渐增大，因此左上角的坐标为$(0,0)$，其他所有坐标值为$0$到$100$之间的整数。输入第一行为一个整数$p(1<=p<=20)$，表示管道的数目；以下$p$行，每行用$x, y, h$三个整数描述一根管道。$(x,y)$为管道左上角坐标；$h$为管道高度$(1<=h<=20)$。以下一行为一个整数$L(0<=L<=50)$，为连接的个数。\n\n以下$L$行每行用三个整数$x, y, d$描述一个连接，$(x,y)$为左端点的坐标，$d$为连接的长度$(1<=d<=20)$。最后一行为两个整数$a,b$，表示$\\text{Willy}$在管道$a$的$y$坐标为$b$的位置。管道按照在文件中出现的顺序编号为$1,2,3…p$\n\n以下为一些假设： 水源总是在第一根管道的正上方, 连接不会穿越管道,任意两个连接的$y$坐标都不相同,任意两个管道的左上角的$x$坐标都不相同,任意连接的两个端点都在管道上（不会出现悬空的情形）", "outputFormat": "仅一个整数，为水面接触到$\\text{Willy}$的时间。如果水面无法接触到$\\text{Willy}$，输出$-1$。", "hint": "", "locale": "zh-CN"}}}
