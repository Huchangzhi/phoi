{"pid": "P13335", "type": "P", "difficulty": 6, "samples": [["3\n4\n1\n-2 4\n1 -2\n4 1\n0 2\n1\n4\n-5 0\n2\n5\n-1 1\n-2 2", "Case #1: 6.3245553203\nCase #2: 10.0000000000\nCase #3: 6.3245553203"]], "limits": {"time": [3000, 6000], "memory": [1048576, 1048576]}, "tags": ["数学", "计算几何", "2012", "Special Judge", "凸包", "旋转卡壳", "Google Code Jam"], "title": "[GCJ 2012 Finals] Twirling Towards Freedom", "background": "> \"I say we must move forward, not backward;\nupward, not forward;    \n> and always twirling, twirling, twirling towards freedom!\"    \n> — Former U.S. Presidential nominee Kodos.", "description": "After hearing this inspirational quote from America's first presidential nominee from the planet Rigel VII, you have decided that you too would like to twirl (rotate) towards freedom. For the purposes of this problem, you can think of \"freedom\" as being as far away from your starting location as possible.\n\nThe galaxy is a two-dimensional plane. Your space ship starts at the origin, position $(0, 0)$. There are $N$ stars in the galaxy. Every minute, you can choose a star and rotate your space ship 90 degrees clockwise around the star. You may also choose to stay where you are.\n\nHow far away can you move from the origin after $M$ minutes?\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3jmyptcf.png)\n\nThe image illustrates the first 3 rotations for a possible path in sample case 1. Note that this path is not necessarily a part of any optimal solution.", "inputFormat": "The first line of the input gives the number of test cases, $T$. $T$ test cases follow, beginning with two lines containing integers $N$ and $M$. The next $N$ lines each contain two integers, $X_i$ and $Y_i$, representing the locations of stars.\n", "outputFormat": "For each test case, output one line containing \"Case #$x$: $D$\", where $x$ is the case number (starting from 1) and $D$ is the distance from the origin to the optimal final position. Answers with absolute or relative error no larger than $10^{-6}$ will be accepted.", "hint": "**Limits**\n\n- $1 \\leq T \\leq 100;$\n- $-1000 \\leq X_i \\leq 1000;$\n- $-1000 \\leq Y_i \\leq 1000.$\n- No two stars will be at the same location.\n- There may be a star at the origin.\n\n**Test set 1 (10 Pts, Visible Verdict)**\n\n- Time limit: ~~30~~ 3 seconds.\n- $1 \\leq N \\leq 10.$\n- $1 \\leq M \\leq 10.$\n\n**Test set 2 (39 Pts, Hidden Verdict)**\n\n- Time limit: ~~60~~ 6 seconds.\n- $1 \\leq N \\leq 5000.$\n- $1 \\leq M \\leq 10^8.$\n", "locale": "en", "translations": {"en": {"title": "[GCJ 2012 Finals] Twirling Towards Freedom", "background": "> \"I say we must move forward, not backward;\nupward, not forward;    \n> and always twirling, twirling, twirling towards freedom!\"    \n> — Former U.S. Presidential nominee Kodos.", "description": "After hearing this inspirational quote from America's first presidential nominee from the planet Rigel VII, you have decided that you too would like to twirl (rotate) towards freedom. For the purposes of this problem, you can think of \"freedom\" as being as far away from your starting location as possible.\n\nThe galaxy is a two-dimensional plane. Your space ship starts at the origin, position $(0, 0)$. There are $N$ stars in the galaxy. Every minute, you can choose a star and rotate your space ship 90 degrees clockwise around the star. You may also choose to stay where you are.\n\nHow far away can you move from the origin after $M$ minutes?\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3jmyptcf.png)\n\nThe image illustrates the first 3 rotations for a possible path in sample case 1. Note that this path is not necessarily a part of any optimal solution.", "inputFormat": "The first line of the input gives the number of test cases, $T$. $T$ test cases follow, beginning with two lines containing integers $N$ and $M$. The next $N$ lines each contain two integers, $X_i$ and $Y_i$, representing the locations of stars.\n", "outputFormat": "For each test case, output one line containing \"Case #$x$: $D$\", where $x$ is the case number (starting from 1) and $D$ is the distance from the origin to the optimal final position. Answers with absolute or relative error no larger than $10^{-6}$ will be accepted.", "hint": "**Limits**\n\n- $1 \\leq T \\leq 100;$\n- $-1000 \\leq X_i \\leq 1000;$\n- $-1000 \\leq Y_i \\leq 1000.$\n- No two stars will be at the same location.\n- There may be a star at the origin.\n\n**Test set 1 (10 Pts, Visible Verdict)**\n\n- Time limit: ~~30~~ 3 seconds.\n- $1 \\leq N \\leq 10.$\n- $1 \\leq M \\leq 10.$\n\n**Test set 2 (39 Pts, Hidden Verdict)**\n\n- Time limit: ~~60~~ 6 seconds.\n- $1 \\leq N \\leq 5000.$\n- $1 \\leq M \\leq 10^8.$\n", "locale": "en"}, "zh-CN": {"title": "[GCJ 2012 Finals] Twirling Towards Freedom", "background": "> “我说我们必须向前进，而不是向后退；  \n> 向上，而不是向前；      \n> 并且永远旋转、旋转、旋转走向自由！”  \n> ——前美国总统候选人 Kodos", "description": "在听到来自 Rigel VII 星球美国首位总统候选人的这句激励人心的名言后，你也决定要旋转（即绕点旋转）走向自由。对于本题而言，你可以认为“自由”就是距离起点越远越好。\n\n银河系是一个二维平面。你的宇宙飞船起始于原点 $(0, 0)$。银河中有 $N$ 颗恒星。每过一分钟，你可以选择一颗恒星，并绕该恒星顺时针旋转 $90$ 度；你也可以选择停留在原地不动。\n\n经过 $M$ 分钟后，你最多能离原点多远？\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3jmyptcf.png)\n\n上图展示了样例第 1 组数据中某一条路径的前三次旋转。注意，这条路径不一定属于最优解的某一部分。\n", "inputFormat": "输入的第一行为测试用例数 $T$。接下来有 $T$ 组测试数据，每组首先两行，包含整数 $N$ 和 $M$。接下来 $N$ 行，每行两个整数 $X_i$ 和 $Y_i$，表示一颗恒星的位置。\n", "outputFormat": "对于每个测试用例，输出一行 \"Case #$x$: $D$\"，其中 $x$ 为测试用例编号（从 1 开始），$D$ 为距离原点的最优最终距离。答案的绝对或相对误差不超过 $10^{-6}$ 即视为正确。\n", "hint": "**限制条件**\n\n- $1 \\leq T \\leq 100$\n- $-1000 \\leq X_i \\leq 1000$\n- $-1000 \\leq Y_i \\leq 1000$\n- 不会有两颗恒星位于同一位置\n- 可能存在位于原点的恒星\n\n**测试集 1（10 分，结果可见）**\n\n- 时间限制：~~30~~ 3 秒\n- $1 \\leq N \\leq 10$\n- $1 \\leq M \\leq 10$\n\n**测试集 2（39 分，结果隐藏）**\n\n- 时间限制：~~60~~ 6 秒\n- $1 \\leq N \\leq 5000$\n- $1 \\leq M \\leq 10^8$\n\n翻译由 ChatGPT-4.1 完成。", "locale": "zh-CN"}}}
{"pid": "P13336", "type": "P", "difficulty": 7, "samples": [["2\n4\n2 1\n3 1\n2 4\n3\n2 2\n1 2", "Case #1: 8\nCase #2: Infinity"]], "limits": {"time": [6000, 6000], "memory": [1048576, 1048576]}, "tags": ["动态规划 DP", "2012", "折半搜索 meet in the middle", "Google Code Jam"], "title": "[GCJ 2012 Finals] Shifting Paths", "background": "", "description": "You have been walking in the woods for hours, and you want to go home.\n\nThe woods contain $N$ clearings labeled $1, 2, \\dots, N$. You are now at clearing $1$, and you must reach clearing $N$ in order to leave the woods. Each clearing from $1$ to $N-1$ has a left path and a right path leading out to other clearings, as well as some number of one-way paths leading in. Unfortunately, the woods are haunted, and any time you enter a clearing, one of the two outgoing paths will be blocked by shifty trees. More precisely, on your $k^{th}$ visit to any single clearing:\n\n- You must leave along the left path if $k$ is odd.\n- You must leave along the right path if $k$ is even.\n- All paths are one-way, so you have no choice at each step: you must go forward through the one unblocked outgoing path.\n\nSo the first time you are in clearing #1, you will leave along the left path. If you ever come back to clearing #1 for a second time, you would leave along the right path; the third time, you'd leave along the left path again; and so on.\n\nYou begin at clearing #1, and when you get to clearing #N, you can leave the woods. How many paths do you need to follow before you get out?\n", "inputFormat": "The first line of the input gives the number of test cases, $T$. $T$ test cases follow, each beginning with a line containing a single integer $N$.\n\n$N-1$ lines follow, each containing two integers $L_i$ and $R_i$. Here, $L_i$ represents the clearing you would end up at if you follow the left path out of clearing $i$, and $R_i$ represents the clearing you would end up at if you follow the right path out of clearing $i$.\n\nNo paths are specified for clearing $N$ because once you get there, you are finished.\n", "outputFormat": "For each test case, output one line containing \"Case #$x$: $y$\", where $x$ is the case number (starting from 1) and $y$ is the number of paths you need to follow to get to clearing $N$. If you will never get to clearing $N$, output \"Infinity\" instead.", "hint": "**Sample Explanation**\n\nIn the first sample case, your route through the woods will be as shown below:\n\n| Paths followed | Clearing | Path direction |\n|:-:|:-:|:-:|\n| 0 | 1 | Left |\n| 1 | 2 | Left |\n| 2 | 3 | Left |\n| 3 | 2 | Right |\n| 4 | 1 | Right |\n| 5 | 1 | Left |\n| 6 | 2 | Left |\n| 7 | 3 | Right |\n| 8 | 4 | - |\n\n**Limits**\n\n- $1 \\leq T \\leq 30.$\n- $1 \\leq L_i, R_i \\leq N$ for all $i$.\n\n**Test set 1 (5 Pts, Visible Verdict)**\n\n- $2 \\leq N \\leq 10.$\n\n**Test set 2 (46 Pts, Hidden Verdict)**\n\n- $2 \\leq N \\leq 40.$", "locale": "en", "translations": {"en": {"title": "[GCJ 2012 Finals] Shifting Paths", "background": "", "description": "You have been walking in the woods for hours, and you want to go home.\n\nThe woods contain $N$ clearings labeled $1, 2, \\dots, N$. You are now at clearing $1$, and you must reach clearing $N$ in order to leave the woods. Each clearing from $1$ to $N-1$ has a left path and a right path leading out to other clearings, as well as some number of one-way paths leading in. Unfortunately, the woods are haunted, and any time you enter a clearing, one of the two outgoing paths will be blocked by shifty trees. More precisely, on your $k^{th}$ visit to any single clearing:\n\n- You must leave along the left path if $k$ is odd.\n- You must leave along the right path if $k$ is even.\n- All paths are one-way, so you have no choice at each step: you must go forward through the one unblocked outgoing path.\n\nSo the first time you are in clearing #1, you will leave along the left path. If you ever come back to clearing #1 for a second time, you would leave along the right path; the third time, you'd leave along the left path again; and so on.\n\nYou begin at clearing #1, and when you get to clearing #N, you can leave the woods. How many paths do you need to follow before you get out?\n", "inputFormat": "The first line of the input gives the number of test cases, $T$. $T$ test cases follow, each beginning with a line containing a single integer $N$.\n\n$N-1$ lines follow, each containing two integers $L_i$ and $R_i$. Here, $L_i$ represents the clearing you would end up at if you follow the left path out of clearing $i$, and $R_i$ represents the clearing you would end up at if you follow the right path out of clearing $i$.\n\nNo paths are specified for clearing $N$ because once you get there, you are finished.\n", "outputFormat": "For each test case, output one line containing \"Case #$x$: $y$\", where $x$ is the case number (starting from 1) and $y$ is the number of paths you need to follow to get to clearing $N$. If you will never get to clearing $N$, output \"Infinity\" instead.", "hint": "**Sample Explanation**\n\nIn the first sample case, your route through the woods will be as shown below:\n\n| Paths followed | Clearing | Path direction |\n|:-:|:-:|:-:|\n| 0 | 1 | Left |\n| 1 | 2 | Left |\n| 2 | 3 | Left |\n| 3 | 2 | Right |\n| 4 | 1 | Right |\n| 5 | 1 | Left |\n| 6 | 2 | Left |\n| 7 | 3 | Right |\n| 8 | 4 | - |\n\n**Limits**\n\n- $1 \\leq T \\leq 30.$\n- $1 \\leq L_i, R_i \\leq N$ for all $i$.\n\n**Test set 1 (5 Pts, Visible Verdict)**\n\n- $2 \\leq N \\leq 10.$\n\n**Test set 2 (46 Pts, Hidden Verdict)**\n\n- $2 \\leq N \\leq 40.$", "locale": "en"}, "zh-CN": {"title": "[GCJ 2012 Finals] Shifting Paths", "background": "", "description": "你在森林中已经走了好几个小时，现在你只想回家。\n\n这片森林里有 $N$ 个空地，编号为 $1, 2, \\dots, N$。你现在位于空地 $1$，必须到达空地 $N$ 才能离开森林。每个空地 $1$ 到 $N-1$ 都有一条左路和一条右路通往其他空地，同时也可能有若干条单向小路通向这里。不幸的是，这片森林闹鬼，你每次进入一个空地时，两条出口中必有一条会被神秘的树木挡住。具体来说，在你第 $k$ 次进入某个空地时：\n\n- 如果 $k$ 是奇数，你必须走左路离开该空地；\n- 如果 $k$ 是偶数，你必须走右路离开该空地；\n- 所有路径都是单向的，因此每一步你都别无选择：只能沿着唯一未被封锁的出口前进。\n\n因此，你第一次到达空地 $1$ 时，会走左路离开。如果以后第二次回到空地 $1$，则会走右路离开；第三次又走左路，如此循环。\n\n你从空地 $1$ 出发，到达空地 $N$ 时即可离开森林。你需要经过多少条路径才能走出森林？", "inputFormat": "输入的第一行为测试用例数 $T$。接下来有 $T$ 组测试数据，每组首先一行一个整数 $N$。\n\n接下来 $N-1$ 行，每行两个整数 $L_i$ 和 $R_i$。$L_i$ 表示从空地 $i$ 走左路会到达的空地编号，$R_i$ 表示从空地 $i$ 走右路会到达的空地编号。\n\n空地 $N$ 没有出口，因为到达这里就算完成。", "outputFormat": "对于每个测试用例，输出一行 \"Case #$x$: $y$\"，其中 $x$ 为测试用例编号（从 1 开始），$y$ 为到达空地 $N$ 所需经过的路径数。如果永远无法到达空地 $N$，则输出 \"Infinity\"。\n", "hint": "**样例说明**\n\n在第一个样例中，你在森林中的路线如下表所示：\n\n| 路径数 | 当前空地 | 离开方向 |\n|:-:|:-:|:-:|\n| 0 | 1 | 左 |\n| 1 | 2 | 左 |\n| 2 | 3 | 左 |\n| 3 | 2 | 右 |\n| 4 | 1 | 右 |\n| 5 | 1 | 左 |\n| 6 | 2 | 左 |\n| 7 | 3 | 右 |\n| 8 | 4 | - |\n\n## 限制条件\n\n- $1 \\leq T \\leq 30$\n- 对所有 $i$，$1 \\leq L_i, R_i \\leq N$\n\n**测试集 1（5 分，结果可见）**\n\n- $2 \\leq N \\leq 10$\n\n**测试集 2（46 分，结果隐藏）**\n\n- $2 \\leq N \\leq 40$\n\n翻译由 ChatGPT-4.1 完成。", "locale": "zh-CN"}}}
{"pid": "P13337", "type": "P", "difficulty": 6, "samples": [["2 2\n1 1\n2 1 6\n-1 2 3", "4.2\n1.8 2.4"], ["2 2\n1 -1\n1 1 4\n-1 -2 -2", "4.0\n4.0 0.0"], ["3 3\n0 0 1\n-2 1 0 -4\n1 1 0 4\n1 -2 0 -4", "Infeasible"], ["2 1\n0 1\n1 0 1", "Unbounded"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化", "线性规划", "模板题"], "title": "【模板】线性规划", "background": "", "description": "本题中你需要求解一个标准型线性规划：\n\n有 $n$ 个实数变量 $x_1,x_2,\\dots,x_n$ 和 $m$ 条约束，其中第 $i$ 条约束形如 $\\sum_{j=1}^n a_{i,j}x_j \\le b_i$。\n\n此外这 $n$ 个变量需要满足非负性限制，即 $x_j\\ge 0$。\n\n在满足上述所有条件的情况下，你需要指定每个变量 $x_j$ 的取值，使得目标函数 $F=\\sum_{j=1}^n c_j x_j$ 的值最大。\n\n**保证数据随机。**", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行有 $n$ 个整数 $c_1,c_2,\\cdots,c_n$，整数间均用一个空格分隔。\n\n接下来 $m$ 行，每行代表一条约束，其中第 $i$ 行有 $n+1$ 个整数 $a_{i,1},a_{i,2},\\cdots,a_{i,n}, b_i$，整数间均用一个空格分隔。\n", "outputFormat": "如果不存在满足所有约束的解，仅输出一行 `Infeasible`。\n\n如果对于任意的 $M$，都存在一组解使得目标函数的值大于 $M$，仅输出一行 `Unbounded`。\n\n否则，第一行输出一个实数，表示目标函数的最大值 $F$。当第一行与标准答案的相对误差或绝对误差不超过 $10^{-6}$，你的答案被判为正确。\n\n第二行输出用空格隔开的 $n$ 个非负实数，表示此时 $x_1,x_2,\\dots,x_n$ 的取值，如有多组方案请任意输出其中一个。\n\n判断第二行是否合法时，我们首先检验 $F$ 与 $\\sum_{j=1}^n c_j x_j$ 的相对误差或绝对误差不超过 $10^{-6}$，再对于所有 $i$，检验 $\\sum_{j=1}^n a_{i,j}x_j\\le b_i$ 或 $\\sum_{j=1}^n a_{i,j}x_j$ 与 $b_i$ 的相对误差或绝对误差不超过 $10^{-6}$。若均满足，则判为正确。\n\n如果出现 `Infeasible` 或 `Unbounded` 时，不需要输出第二行。\n", "hint": "### 数据范围\n\n对于所有数据，$1\\leq n,m \\leq 100$，$0 \\leq |a_{i,j}|,|b_i|,|c_j|\\leq 100$。保证数据随机。\n\n| 子任务编号 | $n,m\\le $ | 特殊性质   | 分值 |\n| ---------- | --------- | ---------- | ---- |\n| 1          | $10$      |            | $20$ |\n| 2          | $20$      |            | $20$ |\n| 3          | $50$      | $b_i\\ge 0$ | $10$ |\n| 4          | $50$      |            | $20$ |\n| 5          | $100$     |            | $30$ |\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】线性规划", "background": "", "description": "本题中你需要求解一个标准型线性规划：\n\n有 $n$ 个实数变量 $x_1,x_2,\\dots,x_n$ 和 $m$ 条约束，其中第 $i$ 条约束形如 $\\sum_{j=1}^n a_{i,j}x_j \\le b_i$。\n\n此外这 $n$ 个变量需要满足非负性限制，即 $x_j\\ge 0$。\n\n在满足上述所有条件的情况下，你需要指定每个变量 $x_j$ 的取值，使得目标函数 $F=\\sum_{j=1}^n c_j x_j$ 的值最大。\n\n**保证数据随机。**", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行有 $n$ 个整数 $c_1,c_2,\\cdots,c_n$，整数间均用一个空格分隔。\n\n接下来 $m$ 行，每行代表一条约束，其中第 $i$ 行有 $n+1$ 个整数 $a_{i,1},a_{i,2},\\cdots,a_{i,n}, b_i$，整数间均用一个空格分隔。\n", "outputFormat": "如果不存在满足所有约束的解，仅输出一行 `Infeasible`。\n\n如果对于任意的 $M$，都存在一组解使得目标函数的值大于 $M$，仅输出一行 `Unbounded`。\n\n否则，第一行输出一个实数，表示目标函数的最大值 $F$。当第一行与标准答案的相对误差或绝对误差不超过 $10^{-6}$，你的答案被判为正确。\n\n第二行输出用空格隔开的 $n$ 个非负实数，表示此时 $x_1,x_2,\\dots,x_n$ 的取值，如有多组方案请任意输出其中一个。\n\n判断第二行是否合法时，我们首先检验 $F$ 与 $\\sum_{j=1}^n c_j x_j$ 的相对误差或绝对误差不超过 $10^{-6}$，再对于所有 $i$，检验 $\\sum_{j=1}^n a_{i,j}x_j\\le b_i$ 或 $\\sum_{j=1}^n a_{i,j}x_j$ 与 $b_i$ 的相对误差或绝对误差不超过 $10^{-6}$。若均满足，则判为正确。\n\n如果出现 `Infeasible` 或 `Unbounded` 时，不需要输出第二行。\n", "hint": "### 数据范围\n\n对于所有数据，$1\\leq n,m \\leq 100$，$0 \\leq |a_{i,j}|,|b_i|,|c_j|\\leq 100$。保证数据随机。\n\n| 子任务编号 | $n,m\\le $ | 特殊性质   | 分值 |\n| ---------- | --------- | ---------- | ---- |\n| 1          | $10$      |            | $20$ |\n| 2          | $20$      |            | $20$ |\n| 3          | $50$      | $b_i\\ge 0$ | $10$ |\n| 4          | $50$      |            | $20$ |\n| 5          | $100$     |            | $30$ |\n\n", "locale": "zh-CN"}}}
{"pid": "P13338", "type": "P", "difficulty": 7, "samples": [["2\n1 1 2 7 8 8\n1 1 2 7 8 8", "17.50000000000000000000"], ["4\n2 1 7 4 4 10\n4 6 3 3 5 3\n9 6 7 12 11 8\n9 2 1 6 11 10", "48.75833209115131640239"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["计算几何", "平衡树", "Special Judge", "微积分"], "title": "三角形面积并 加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P4406)", "description": "给定 $n$ 个非退化三角形 $\\triangle A_i B_i C_i\\ (1 \\leq i \\leq n)$，你的任务是计算这些三角形的并集面积。\n\n一个三角形是**非退化**的，当且仅当它具有非零面积，即三角形的三个顶点 $A_i,B_i,C_i$ 是不同的且不共线。换句话说，点 $A_i,B_i,C_i$ 不在同一条直线上，由这三点构成的三角形不是退化的。\n\n三角形的**并集面积**是至少被其中一个三角形覆盖的总面积。形式化地，三角形的并集面积是由这些三角形所占区域的并集所形成的区域的面积：\n$$\n\\text{Area}\\left(\\bigcup_{i=1}^n S_i\\right)\n$$\n其中 $S_i$ 表示三角形 $\\triangle A_i B_i C_i$ 所占的几何区域，$\\text{Area}(S_i)$ 是该区域的面积。$\\bigcup_{i=1}^n S_i$ 表示至少被其中一个三角形覆盖的区域。\n", "inputFormat": "每个测试文件中仅包含一个测试用例。\n\n第一行包含一个整数 $n\\ (1 \\leq n \\leq 10^3)$，表示三角形的数量。\n\n接下来的 $n$ 行，每行包含六个整数 $x_1\\ y_1\\ x_2\\ y_2\\ x_3\\ y_3\\ (0 \\leq |x|, |y| \\leq 10^6)$，表示三角形 $\\triangle A_i B_i C_i$ 的三个顶点的坐标。\n", "outputFormat": "输出一个实数，表示这些三角形的并集面积。你的答案的绝对误差或相对误差应小于 $10^{-6}$。当你的答案为 $a$，评测机的答案为 $b$，则当 $\\frac{|a-b|}{\\max(1,|b|)} \\leq 10^{-6}$ 时答案被接受。", "hint": "样例 2 图示：\n\n![样例 2](https://cdn.luogu.com.cn/upload/image_hosting/vwry2al7.png)\n\n对于子任务 1，输入数据满足 $1 \\leq n \\leq 100$，且 $0 \\leq |x|, |y| \\leq 10^3$。该子任务可用于测试算法的正确性。完成子任务 1 将获得总分的 $50\\%$。\n\n对于子任务 2，输入数据满足 $1 \\leq n \\leq 10^3$，且 $0 \\leq |x|, |y| \\leq 10^6$。完成子任务 2 将获得剩余 $50\\%$ 的分数。\n\n提示：求解三角形的并集面积是一个经典的 3SUM-hard 问题。你需要实现一个时间复杂度为 $\\mathcal{O}(V^2 \\log V)$ 的算法，其中 $V$ 为顶点总数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "三角形面积并 加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P4406)", "description": "给定 $n$ 个非退化三角形 $\\triangle A_i B_i C_i\\ (1 \\leq i \\leq n)$，你的任务是计算这些三角形的并集面积。\n\n一个三角形是**非退化**的，当且仅当它具有非零面积，即三角形的三个顶点 $A_i,B_i,C_i$ 是不同的且不共线。换句话说，点 $A_i,B_i,C_i$ 不在同一条直线上，由这三点构成的三角形不是退化的。\n\n三角形的**并集面积**是至少被其中一个三角形覆盖的总面积。形式化地，三角形的并集面积是由这些三角形所占区域的并集所形成的区域的面积：\n$$\n\\text{Area}\\left(\\bigcup_{i=1}^n S_i\\right)\n$$\n其中 $S_i$ 表示三角形 $\\triangle A_i B_i C_i$ 所占的几何区域，$\\text{Area}(S_i)$ 是该区域的面积。$\\bigcup_{i=1}^n S_i$ 表示至少被其中一个三角形覆盖的区域。\n", "inputFormat": "每个测试文件中仅包含一个测试用例。\n\n第一行包含一个整数 $n\\ (1 \\leq n \\leq 10^3)$，表示三角形的数量。\n\n接下来的 $n$ 行，每行包含六个整数 $x_1\\ y_1\\ x_2\\ y_2\\ x_3\\ y_3\\ (0 \\leq |x|, |y| \\leq 10^6)$，表示三角形 $\\triangle A_i B_i C_i$ 的三个顶点的坐标。\n", "outputFormat": "输出一个实数，表示这些三角形的并集面积。你的答案的绝对误差或相对误差应小于 $10^{-6}$。当你的答案为 $a$，评测机的答案为 $b$，则当 $\\frac{|a-b|}{\\max(1,|b|)} \\leq 10^{-6}$ 时答案被接受。", "hint": "样例 2 图示：\n\n![样例 2](https://cdn.luogu.com.cn/upload/image_hosting/vwry2al7.png)\n\n对于子任务 1，输入数据满足 $1 \\leq n \\leq 100$，且 $0 \\leq |x|, |y| \\leq 10^3$。该子任务可用于测试算法的正确性。完成子任务 1 将获得总分的 $50\\%$。\n\n对于子任务 2，输入数据满足 $1 \\leq n \\leq 10^3$，且 $0 \\leq |x|, |y| \\leq 10^6$。完成子任务 2 将获得剩余 $50\\%$ 的分数。\n\n提示：求解三角形的并集面积是一个经典的 3SUM-hard 问题。你需要实现一个时间复杂度为 $\\mathcal{O}(V^2 \\log V)$ 的算法，其中 $V$ 为顶点总数。", "locale": "zh-CN"}}}
{"pid": "P13339", "type": "P", "difficulty": 3, "samples": [["4 5\n1 3 0 2 3", "1 1"], ["3 6\n1 0 2 2 1 0", "0 2"], ["4 8\n0 2 0 1 2 1 3 3", "2 6"], ["3 6\n1 1 2 0 1 0", "0 3"], ["4 6\n0 1 2 0 3 2", "2 3"], ["5 13\n3 3 3 1 2 0 3 3 2 1 4 1 0", "1 9"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["贪心", "2025", "Special Judge", "双指针 two-pointer", "EGOI（欧洲/女生）"], "title": "[EGOI 2025] Gift Boxes", "background": "", "description": "This year's EGOI is organized in Bonn. The organizers want to distribute at most one gift box to every team in the contest, with each team represented by a number from $0$ to $T-1$. The contestants are standing in a single row. However, they are mixed up such that people from the same team might not be standing next to each other. Note that there will be at least one team with more than one person in the row. There are $N$ people in the row. Person $i$ is part of the team $a_i$. The problem is: each team should only receive a maximum of one gift box. In order to ensure the process runs smoothly - and willing to leave some teams with no gift as a consequence - the organizers wish to pause the gifting process exactly once, skipping a few contestants before resuming the gift box handouts. In other words, they will skip one consecutive segment $[\\ell, r]$ of the contestants.\n\nIt is not necessary that every team receives a gift. Nevertheless, the organizers want to maximize the number of teams that will receive their gifts while ensuring that no team ends up with two or more gifts, equivalent to minimizing the number of contestants that are skipped under this condition. Please help the organizers to decide when it is best to pause and when to continue distributing gifts such that as few contestants as possible are skipped.", "inputFormat": "The first line of input contains two integers, $T$ and $N$ – the number of teams and the number of contestants in the row.\n\nThe second line contains $N$ integers, $a_i$, where the $i$th integer describes which team the person at position $i$ in the row belongs to. It is guaranteed that every integer between $0$ and $T-1$ appears at least once.", "outputFormat": "Output two integers, $\\ell$ and $r$, where $\\ell$ is the index of the first person that is skipped and $r$ is the index of the last skipped person. Note that $\\ell$ and $r$ are indexed from $0$ to $N-1$. If there is more than one solution, print any one of them.", "hint": "### Examples\n\nThe first sample satisfies the constraints of test groups 1, 3, 5 and 6. Two different outputs are possible: $1 \\ 1$ corresponding to the solid blue line and $4 \\ 4$ corresponding to the red dotted line, as described in the picture below. Either way, all four teams receive gifts and no team receives more than one gift.\n\n$\\begin{array}{lllll} 1 & \\blue 3 & 0 & 2 & \\red 3 \\end{array}$\n\nThe second sample satisfies the constraints of test groups 2, 3, 4, 5 and 6. Again, two different outputs are possible: $0 \\ 2$ and $3 \\ 5$, as described in the picture below. In both cases, all three teams receive gifts.\n\n$\\begin{array}{lllll} \\blue 1 & \\blue 0 & \\blue 2 & \\red 2 & \\red 1 & \\red 0 \\end{array}$\n\nThe third sample satisfies the constraints of test groups 3, 4, 5, 6. The optimal solution is that three teams receive a gift, as shown below. The contestants with indices 0, 1 and 7, who are in teams 0, 2 and 3, respectively, receive gifts. This is the only possible solution.\n\n$\\begin{array}{lllllll} 0 & 2 & \\blue 0 & \\blue 1 & \\blue 2 & \\blue 1 & \\blue 3 & 3 \\end{array}$\n\nThe fourth sample satisfies the constraints of test groups 3, 5 and 6. Again two different outputs are possible: $0 \\ 3$ and $1 \\ 4$, as described in the picture below. In both cases, exactly two teams (team 0 and team 1) receive gifts. Team 2 does not receive a gift as doing so would require giving team 0 or 1 two gifts, which is strictly forbidden.\n\n$\\begin{array}{lllllll} \\blue 1 & \\blue 1 & \\blue 2 & \\blue 0 & 1 &  0 \\end{array}$\n\n$\\begin{array}{lllllll}  1 & \\red 1 & \\red 2 & \\red 0 & \\red 1 &  0 \\end{array}$\n\nThe fifth sample satisfies the constraints of test groups 3, 5 and 6. The only possible answer is $2 \\ 3$, as described in the picture below. All four teams receive gifts.\n\n$\\begin{array}{lllllll} 0 & 1 & \\blue 2 & \\blue 0 & 3 & 2 \\end{array}$\n\nThe sixth sample satisfies the constraints of test groups 3, 5 and 6. A maximum of four out of five teams can receive a gift, as shown below. The contestants with indices 0, 10, 11 and 12, who are in teams 3, 4, 1 and 0, respectively, receive gifts. This is the only possible solution.\n\n$\\begin{array}{lllllll} 3 & \\blue 3 & \\blue 3 & \\blue 1 & \\blue 2 & \\blue 0 & \\blue 3 & \\blue 3 & \\blue 2 & \\blue 1 & 4 & 1 & 0 \\end{array}$\n\n### Constraints and Scoring\n\n* $1 \\leq T < N \\leq 500\\,000$.\n* $0 \\leq a_i \\leq T-1$.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 8 | $N = T + 1$, i.e. only one team will appear twice |\n| 2 | 11 | $N = 2 \\cdot T$ and every team will appear exactly once in the first half and exactly once in the second half of the line |\n| 3 | 14 | $1 \\leq T < N \\leq 500$ |\n| 4 | 21 | $N = 2 \\cdot T$ and every team will appear twice |\n| 5 | 22 | $1 \\leq T < N \\leq 5\\,000$ |\n| 6 | 24 | No additional constraints |", "locale": "en", "translations": {"en": {"title": "[EGOI 2025] Gift Boxes", "background": "", "description": "This year's EGOI is organized in Bonn. The organizers want to distribute at most one gift box to every team in the contest, with each team represented by a number from $0$ to $T-1$. The contestants are standing in a single row. However, they are mixed up such that people from the same team might not be standing next to each other. Note that there will be at least one team with more than one person in the row. There are $N$ people in the row. Person $i$ is part of the team $a_i$. The problem is: each team should only receive a maximum of one gift box. In order to ensure the process runs smoothly - and willing to leave some teams with no gift as a consequence - the organizers wish to pause the gifting process exactly once, skipping a few contestants before resuming the gift box handouts. In other words, they will skip one consecutive segment $[\\ell, r]$ of the contestants.\n\nIt is not necessary that every team receives a gift. Nevertheless, the organizers want to maximize the number of teams that will receive their gifts while ensuring that no team ends up with two or more gifts, equivalent to minimizing the number of contestants that are skipped under this condition. Please help the organizers to decide when it is best to pause and when to continue distributing gifts such that as few contestants as possible are skipped.", "inputFormat": "The first line of input contains two integers, $T$ and $N$ – the number of teams and the number of contestants in the row.\n\nThe second line contains $N$ integers, $a_i$, where the $i$th integer describes which team the person at position $i$ in the row belongs to. It is guaranteed that every integer between $0$ and $T-1$ appears at least once.", "outputFormat": "Output two integers, $\\ell$ and $r$, where $\\ell$ is the index of the first person that is skipped and $r$ is the index of the last skipped person. Note that $\\ell$ and $r$ are indexed from $0$ to $N-1$. If there is more than one solution, print any one of them.", "hint": "### Examples\n\nThe first sample satisfies the constraints of test groups 1, 3, 5 and 6. Two different outputs are possible: $1 \\ 1$ corresponding to the solid blue line and $4 \\ 4$ corresponding to the red dotted line, as described in the picture below. Either way, all four teams receive gifts and no team receives more than one gift.\n\n$\\begin{array}{lllll} 1 & \\blue 3 & 0 & 2 & \\red 3 \\end{array}$\n\nThe second sample satisfies the constraints of test groups 2, 3, 4, 5 and 6. Again, two different outputs are possible: $0 \\ 2$ and $3 \\ 5$, as described in the picture below. In both cases, all three teams receive gifts.\n\n$\\begin{array}{lllll} \\blue 1 & \\blue 0 & \\blue 2 & \\red 2 & \\red 1 & \\red 0 \\end{array}$\n\nThe third sample satisfies the constraints of test groups 3, 4, 5, 6. The optimal solution is that three teams receive a gift, as shown below. The contestants with indices 0, 1 and 7, who are in teams 0, 2 and 3, respectively, receive gifts. This is the only possible solution.\n\n$\\begin{array}{lllllll} 0 & 2 & \\blue 0 & \\blue 1 & \\blue 2 & \\blue 1 & \\blue 3 & 3 \\end{array}$\n\nThe fourth sample satisfies the constraints of test groups 3, 5 and 6. Again two different outputs are possible: $0 \\ 3$ and $1 \\ 4$, as described in the picture below. In both cases, exactly two teams (team 0 and team 1) receive gifts. Team 2 does not receive a gift as doing so would require giving team 0 or 1 two gifts, which is strictly forbidden.\n\n$\\begin{array}{lllllll} \\blue 1 & \\blue 1 & \\blue 2 & \\blue 0 & 1 &  0 \\end{array}$\n\n$\\begin{array}{lllllll}  1 & \\red 1 & \\red 2 & \\red 0 & \\red 1 &  0 \\end{array}$\n\nThe fifth sample satisfies the constraints of test groups 3, 5 and 6. The only possible answer is $2 \\ 3$, as described in the picture below. All four teams receive gifts.\n\n$\\begin{array}{lllllll} 0 & 1 & \\blue 2 & \\blue 0 & 3 & 2 \\end{array}$\n\nThe sixth sample satisfies the constraints of test groups 3, 5 and 6. A maximum of four out of five teams can receive a gift, as shown below. The contestants with indices 0, 10, 11 and 12, who are in teams 3, 4, 1 and 0, respectively, receive gifts. This is the only possible solution.\n\n$\\begin{array}{lllllll} 3 & \\blue 3 & \\blue 3 & \\blue 1 & \\blue 2 & \\blue 0 & \\blue 3 & \\blue 3 & \\blue 2 & \\blue 1 & 4 & 1 & 0 \\end{array}$\n\n### Constraints and Scoring\n\n* $1 \\leq T < N \\leq 500\\,000$.\n* $0 \\leq a_i \\leq T-1$.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 8 | $N = T + 1$, i.e. only one team will appear twice |\n| 2 | 11 | $N = 2 \\cdot T$ and every team will appear exactly once in the first half and exactly once in the second half of the line |\n| 3 | 14 | $1 \\leq T < N \\leq 500$ |\n| 4 | 21 | $N = 2 \\cdot T$ and every team will appear twice |\n| 5 | 22 | $1 \\leq T < N \\leq 5\\,000$ |\n| 6 | 24 | No additional constraints |", "locale": "en"}, "zh-CN": {"title": "[EGOI 2025] Gift Boxes / 礼品盒", "background": "", "description": "今年的 EGOI 在波恩举办。主办方希望为比赛中的每支队伍最多分发一个礼品盒，每支队伍的编号为 $0$ 到 $T-1$。所有参赛选手排成一排，但他们的顺序是混乱的，因此同一队的成员可能不会站在一起。注意，队伍中一定至少有一支队伍在队列中有多于一名成员。队列中共有 $N$ 个人，第 $i$ 个人属于编号为 $a_i$ 的队伍。问题是：每支队伍最多只能获得一个礼品盒。为了让礼品发放过程顺利进行——即使因此有些队伍无法获得礼品盒——主办方希望在发放过程中**恰好暂停一次**，跳过一段连续的选手，然后再继续发放。换句话说，他们会跳过一个连续区间 $[\\ell, r]$ 的选手。\n\n并不要求每支队伍都必须收到礼品盒。然而，主办方希望在不违反“每支队伍至多一个礼品盒”这一前提下，使收到礼品盒的队伍数尽量多，同时要**最小化被跳过的选手数量**。请帮助主办方决定在哪一段暂停以及何时继续发放礼品盒，才能使被跳过的选手尽可能少。", "inputFormat": "输入的第一行包含两个整数 $T$ 和 $N$——队伍数和队列中的选手数。\n\n第二行包含 $N$ 个整数 $a_i$，第 $i$ 个整数表示队列中第 $i$ 个选手所属的队伍编号。保证 $0$ 到 $T-1$ 的每个整数至少出现一次。\n", "outputFormat": "输出两个整数 $\\ell$ 和 $r$，分别表示被跳过的第一个和最后一个选手的下标。注意，$\\ell$ 和 $r$ 的下标范围为 $0$ 到 $N-1$。如果有多个解，输出其中任意一个即可。\n", "hint": "第一个样例满足测试组 1、3、5 和 6 的约束。有两种不同的输出：$1\\ 1$（对应下划线蓝色线段）和 $4\\ 4$（对应红色虚线），如图所示。无论哪种方式，四支队伍都能收到礼品盒，且没有队伍收到多于一个礼品盒。\n\n$\\begin{array}{lllll} 1 & \\blue 3 & 0 & 2 & \\red 3 \\end{array}$\n\n第二个样例满足测试组 2、3、4、5 和 6 的约束。同样有两种不同的输出：$0\\ 2$ 和 $3\\ 5$，如图所示。两种方案下，三支队伍都能收到礼品盒。\n\n$\\begin{array}{lllll} \\blue 1 & \\blue 0 & \\blue 2 & \\red 2 & \\red 1 & \\red 0 \\end{array}$\n\n第三个样例满足测试组 3、4、5、6 的约束。最优解是三支队伍收到礼品盒，如下所示。下标为 0、1、7 的选手（分别属于队伍 0、2、3）收到礼品盒。这是唯一的可行解。\n\n$\\begin{array}{lllllll} 0 & 2 & \\blue 0 & \\blue 1 & \\blue 2 & \\blue 1 & \\blue 3 & 3 \\end{array}$\n\n第四个样例满足测试组 3、5 和 6 的约束。同样有两种不同的输出：$0\\ 3$ 和 $1\\ 4$，如图所示。两种方案下，恰好两支队伍（队伍 0 和队伍 1）获得礼品盒。队伍 2 没有获得礼品盒，因为这样会导致队伍 0 或 1 获得两个礼品盒，这是严格禁止的。\n\n$\\begin{array}{lllllll} \\blue 1 & \\blue 1 & \\blue 2 & \\blue 0 & 1 &  0 \\end{array}$\n\n$\\begin{array}{lllllll}  1 & \\red 1 & \\red 2 & \\red 0 & \\red 1 &  0 \\end{array}$\n\n第五个样例满足测试组 3、5 和 6 的约束。唯一可行答案是 $2\\ 3$，如图所示。所有四支队伍都能收到礼品盒。\n\n$\\begin{array}{lllllll} 0 & 1 & \\blue 2 & \\blue 0 & 3 & 2 \\end{array}$\n\n第六个样例满足测试组 3、5 和 6 的约束。最多有五支队伍中的四支能收到礼品盒，如下所示。下标为 0、10、11 和 12 的选手（分别属于队伍 3、4、1、0）收到礼品盒。这是唯一的可行解。\n\n$\\begin{array}{lllllll} 3 & \\blue 3 & \\blue 3 & \\blue 1 & \\blue 2 & \\blue 0 & \\blue 3 & \\blue 3 & \\blue 2 & \\blue 1 & 4 & 1 & 0 \\end{array}$\n\n### 约束与评分\n\n* $1 \\leq T < N \\leq 500\\,000$\n* $0 \\leq a_i \\leq T-1$\n\n你的解答将在一组测试组上进行评测，每组有若干测试用例。要获得该测试组的分数，你需要通过该测试组的所有测试用例。\n\n| 测试组 | 分值 | 限制条件 |\n| :-: | :-: | :-: |\n| 1 | 8 | $N = T + 1$，即只有一支队伍会出现两次 |\n| 2 | 11 | $N = 2 \\cdot T$，且每支队伍在前半部分和后半部分各出现一次 |\n| 3 | 14 | $1 \\leq T < N \\leq 500$ |\n| 4 | 21 | $N = 2 \\cdot T$，且每支队伍均出现两次 |\n| 5 | 22 | $1 \\leq T < N \\leq 5\\,000$ |\n| 6 | 24 | 无额外限制 |\n\n翻译由 ChatGPT-4.1 完成。", "locale": "zh-CN"}}}
{"pid": "P13340", "type": "P", "difficulty": 5, "samples": [["5\n\n3\n\n3", "\n? 10001\n\n? 10110\n\n! 2 4"], ["3\n\n0\n\n2\n\n0", "\n? 111\n\n? 110\n\n? 000\n\n! 1 0"], ["4\n\n3", "\n? 1010\n\n! 0 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["二分", "2025", "交互题", "Special Judge", "EGOI（欧洲/女生）"], "title": "[EGOI 2025] Dark Ride", "background": "", "description": "Erika recently got a summer job at the amusement park Phantasialand near Bonn. She was hired to control the lights in the rooms through which a dark ride passes.\n\nThe ride passes through $N$ rooms, numbered from $0$ to $N - 1$. The rooms are traversed in order, starting in room $0$ and ending in room $N - 1$. The lights in the rooms are controlled by $N$ switches (also numbered from $0$ to $N - 1$), one for each room. Switch $s$ (where $0 \\leq s < N$) controls the light in room $p_s$.\n\nErika's boss has asked her to turn on the lights in the first and last rooms and turn off all the others. Sounds easy, right? She just needs to turn on the two switches $A$ and $B$ such that $p_A = 0$ and $p_B = N - 1$ (or $p_B = 0$ and $p_A = N - 1$). Unfortunately, Erika did not fully pay attention when her boss described the controls, and **she does not remember the array $p$ – that is, which switch controls which room.**\n\nErika needs to figure this out before her boss notices. Before the start of each ride, Erika turns off all the lights and can then turn on a subset of the switches. As the ride goes from room to room, whenever the ride goes from a lit room to an unlit room or vice versa, Erika will hear the passengers scream in excitement. The speed of the ride can vary, so Erika cannot directly infer which rooms are lit but at least she will hear the number of screams. That is, she will learn the number of times the ride passes from lit to unlit room, or unlit to lit room.\n\nCan you help Erika figure out which two switches control the lights for the first and last rooms before her boss notices? You can use at most 30 rides.\n\n### Interaction\n\nThis is an interactive problem.\n\n- Your program should start by reading a line with an integer $N$: the number of rooms in the dark ride.\n- Then, your program should interact with the grader. To start a ride, you should print a line beginning with a question mark \"?\", and then a string of length $N$ consisting of 0's (turned off) and 1's (turned on), indicating how you set the $N$ switches. Then, your program should read a single integer $\\ell$ ($0 \\leq \\ell < N$), the number of times Erika hears the passengers scream.\n- When you want to answer, print a line with an exclamation mark \"!\", followed by two integers $A$ and $B$ ($0 \\leq A, B < N$). For your answer to be accepted, these must be the indices of the switches controlling the two end rooms, in any order. After this, your program should exit.\n\nThe grader is non-adaptive, meaning that the hidden array $p$ is determined before the interaction begins.\n\nMake sure to flush standard output after issuing each ride, or else your program might get judged as Time Limit Exceeded. In Python, this happens automatically as long as you use `input()` to read lines. In C++, `cout << endl;` flushes in addition to printing a newline; if using `printf`, use `fflush(stdout)`.", "inputFormat": "See Interaction.", "outputFormat": "See Interaction.", "hint": "### Example\n\nIn the first sample, the hidden permutation is $[p_0, p_1, p_2, p_3, p_4] = [2, 1, 0, 3, 4]$. This satisfies the constraints of test groups 2, 5, and 6. First, the program reads the integer $N = 5$. Then, the program requests a ride with two turned on switches: switch 4 and switch 0. These control rooms $p_4 = 4$ and $p_0 = 2$; see the illustration below. Erika hears 3 screams (marked by arrows in the figure): first when the ride passes from unlit room 1 to lit room 2; second from lit room 2 to unlit room 3; and thirdly when passing from unlit room 3 to lit room 4. The program then requests another ride where rooms $p_0, p_2,$ and $p_3$ are lit, making Erika hear 3 screams. Finally, the program answers with $A = 2$ and $B = 4$, which is indeed correct as these control the first and last rooms ($p_2 = 0$ and $p_4 = 4$). Note that $A = 4$ and $B = 2$ would also have been a correct answer.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/q3hcla6s)\n\nIn the second sample, the hidden permutation is $[p_0, p_1, p_2] = [2, 0, 1]$. This satisfies the constraints of test groups 1, 2, 5, and 6. The program requests a ride where all three switches are turned on. Since this means all the rooms are lit, Erika will hear no screams. In the second ride, switches 1 and 0 are turned on, making rooms $p_1 = 0$ and $p_0 = 2$ be lit, while room 1 is unlit. Erika hears two screams: when the ride goes from room 0 (lit) to room 1 (unlit), and from room 1 (unlit) to room 2 (lit). In the final ride, no switches are turned on, meaning that all three rooms are unlit, and again that Erika hears no screams. The program then answers with switches 1 and 0, which indeed control the first and last rooms. Both \"! 0 1\" and \"! 1 0\" are accepted answers.\n\nIn the third sample, the hidden permutation is $[p_0, p_1, p_2, p_3] = [0, 1, 2, 3]$. This satisfies the constraints of test groups 2, 3, 4, 5, and 6. Note that it is not necessarily possible to infer the answer after this one ride, but the sample solution guessed the answer and got lucky.\n\n### Testing Tool\n\nTo facilitate the testing of your solution, we have provided a simple tool that you can download. See \"attachments\" at the bottom of the problem page. The tool is optional to use. Note that the official grader differs from the provided testing tool.\n\nTo use the tool, create an input file, such as \"sample1.in\", which should start with a number $N$ followed by a line with $p_0, p_1, \\ldots, p_{N-1}$ specifying the hidden permutation. For example:\n\n```\n5\n2 1 0 3 4\n```\n\nFor Python programs, say solution.py (normally run as `pypy3 solution.py`), run:\n\n```\npython3 testing_tool.py pypy3 solution.py < sample1.in\n```\n\nFor C++ programs, first compile it (e.g. with `g++ -g -O2 -std=gnu++23 -static solution.cpp -o solution.out`) and then run:\n\n```\npython3 testing_tool.py ./solution.out < sample1.in\n```\n\n### Constraints and Scoring\n\n- $3 \\leq N \\leq 30000$.\n- You can issue at most 30 rides (printing the final answer does not count as a ride). If you exceed this limit, you will get the verdict \"Wrong Answer\".\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 9 | $N=3$ |\n| 2 | 15 | $N \\leq 30$ |\n| 3 | 17 | $p_{0}=0$, i.e., switch 0 controls room 0 |\n| 4 | 16 | $N$ is even, with the switch for one of the end rooms in the first half $\\left(0 \\leq A<\\frac{N}{2}\\right)$ and the other in the second half $\\left(\\frac{N}{2} \\leq B<N\\right)$ |\n| 5 | 14 | $N \\leq 1000$ |\n| 6 | 29 | No additional constraints |", "locale": "en", "translations": {"en": {"title": "[EGOI 2025] Dark Ride", "background": "", "description": "Erika recently got a summer job at the amusement park Phantasialand near Bonn. She was hired to control the lights in the rooms through which a dark ride passes.\n\nThe ride passes through $N$ rooms, numbered from $0$ to $N - 1$. The rooms are traversed in order, starting in room $0$ and ending in room $N - 1$. The lights in the rooms are controlled by $N$ switches (also numbered from $0$ to $N - 1$), one for each room. Switch $s$ (where $0 \\leq s < N$) controls the light in room $p_s$.\n\nErika's boss has asked her to turn on the lights in the first and last rooms and turn off all the others. Sounds easy, right? She just needs to turn on the two switches $A$ and $B$ such that $p_A = 0$ and $p_B = N - 1$ (or $p_B = 0$ and $p_A = N - 1$). Unfortunately, Erika did not fully pay attention when her boss described the controls, and **she does not remember the array $p$ – that is, which switch controls which room.**\n\nErika needs to figure this out before her boss notices. Before the start of each ride, Erika turns off all the lights and can then turn on a subset of the switches. As the ride goes from room to room, whenever the ride goes from a lit room to an unlit room or vice versa, Erika will hear the passengers scream in excitement. The speed of the ride can vary, so Erika cannot directly infer which rooms are lit but at least she will hear the number of screams. That is, she will learn the number of times the ride passes from lit to unlit room, or unlit to lit room.\n\nCan you help Erika figure out which two switches control the lights for the first and last rooms before her boss notices? You can use at most 30 rides.\n\n### Interaction\n\nThis is an interactive problem.\n\n- Your program should start by reading a line with an integer $N$: the number of rooms in the dark ride.\n- Then, your program should interact with the grader. To start a ride, you should print a line beginning with a question mark \"?\", and then a string of length $N$ consisting of 0's (turned off) and 1's (turned on), indicating how you set the $N$ switches. Then, your program should read a single integer $\\ell$ ($0 \\leq \\ell < N$), the number of times Erika hears the passengers scream.\n- When you want to answer, print a line with an exclamation mark \"!\", followed by two integers $A$ and $B$ ($0 \\leq A, B < N$). For your answer to be accepted, these must be the indices of the switches controlling the two end rooms, in any order. After this, your program should exit.\n\nThe grader is non-adaptive, meaning that the hidden array $p$ is determined before the interaction begins.\n\nMake sure to flush standard output after issuing each ride, or else your program might get judged as Time Limit Exceeded. In Python, this happens automatically as long as you use `input()` to read lines. In C++, `cout << endl;` flushes in addition to printing a newline; if using `printf`, use `fflush(stdout)`.", "inputFormat": "See Interaction.", "outputFormat": "See Interaction.", "hint": "### Example\n\nIn the first sample, the hidden permutation is $[p_0, p_1, p_2, p_3, p_4] = [2, 1, 0, 3, 4]$. This satisfies the constraints of test groups 2, 5, and 6. First, the program reads the integer $N = 5$. Then, the program requests a ride with two turned on switches: switch 4 and switch 0. These control rooms $p_4 = 4$ and $p_0 = 2$; see the illustration below. Erika hears 3 screams (marked by arrows in the figure): first when the ride passes from unlit room 1 to lit room 2; second from lit room 2 to unlit room 3; and thirdly when passing from unlit room 3 to lit room 4. The program then requests another ride where rooms $p_0, p_2,$ and $p_3$ are lit, making Erika hear 3 screams. Finally, the program answers with $A = 2$ and $B = 4$, which is indeed correct as these control the first and last rooms ($p_2 = 0$ and $p_4 = 4$). Note that $A = 4$ and $B = 2$ would also have been a correct answer.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/q3hcla6s)\n\nIn the second sample, the hidden permutation is $[p_0, p_1, p_2] = [2, 0, 1]$. This satisfies the constraints of test groups 1, 2, 5, and 6. The program requests a ride where all three switches are turned on. Since this means all the rooms are lit, Erika will hear no screams. In the second ride, switches 1 and 0 are turned on, making rooms $p_1 = 0$ and $p_0 = 2$ be lit, while room 1 is unlit. Erika hears two screams: when the ride goes from room 0 (lit) to room 1 (unlit), and from room 1 (unlit) to room 2 (lit). In the final ride, no switches are turned on, meaning that all three rooms are unlit, and again that Erika hears no screams. The program then answers with switches 1 and 0, which indeed control the first and last rooms. Both \"! 0 1\" and \"! 1 0\" are accepted answers.\n\nIn the third sample, the hidden permutation is $[p_0, p_1, p_2, p_3] = [0, 1, 2, 3]$. This satisfies the constraints of test groups 2, 3, 4, 5, and 6. Note that it is not necessarily possible to infer the answer after this one ride, but the sample solution guessed the answer and got lucky.\n\n### Testing Tool\n\nTo facilitate the testing of your solution, we have provided a simple tool that you can download. See \"attachments\" at the bottom of the problem page. The tool is optional to use. Note that the official grader differs from the provided testing tool.\n\nTo use the tool, create an input file, such as \"sample1.in\", which should start with a number $N$ followed by a line with $p_0, p_1, \\ldots, p_{N-1}$ specifying the hidden permutation. For example:\n\n```\n5\n2 1 0 3 4\n```\n\nFor Python programs, say solution.py (normally run as `pypy3 solution.py`), run:\n\n```\npython3 testing_tool.py pypy3 solution.py < sample1.in\n```\n\nFor C++ programs, first compile it (e.g. with `g++ -g -O2 -std=gnu++23 -static solution.cpp -o solution.out`) and then run:\n\n```\npython3 testing_tool.py ./solution.out < sample1.in\n```\n\n### Constraints and Scoring\n\n- $3 \\leq N \\leq 30000$.\n- You can issue at most 30 rides (printing the final answer does not count as a ride). If you exceed this limit, you will get the verdict \"Wrong Answer\".\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 9 | $N=3$ |\n| 2 | 15 | $N \\leq 30$ |\n| 3 | 17 | $p_{0}=0$, i.e., switch 0 controls room 0 |\n| 4 | 16 | $N$ is even, with the switch for one of the end rooms in the first half $\\left(0 \\leq A<\\frac{N}{2}\\right)$ and the other in the second half $\\left(\\frac{N}{2} \\leq B<N\\right)$ |\n| 5 | 14 | $N \\leq 1000$ |\n| 6 | 29 | No additional constraints |", "locale": "en"}, "zh-CN": {"title": "[EGOI 2025] Dark Ride / 黑暗乘车", "background": "", "description": "Erika 最近在波恩附近的 Phantasialand 游乐园找到了一份暑期工作。她的职责是控制黑暗游乐项目沿途各个房间的灯光。\n\n该游乐项目会依次经过 $N$ 个房间，编号从 $0$ 到 $N - 1$。游乐车从房间 $0$ 出发，最终到达房间 $N - 1$。每个房间的灯由 $N$ 个开关控制（开关编号也为 $0$ 到 $N - 1$），每个开关 $s$（$0 \\leq s < N$）控制房间 $p_s$ 的灯。\n\nErika 的老板要求她只打开首尾两个房间的灯，其余房间的灯全部关闭。听起来很简单，对吧？她只需打开两个开关 $A$ 和 $B$，使得 $p_A = 0$ 且 $p_B = N - 1$（或 $p_B = 0$ 且 $p_A = N - 1$）。不幸的是，Erika 在听老板讲解时走神了，**她不记得数组 $p$ 了——也就是说，她不知道每个开关实际控制的是哪个房间的灯。**\n\nErika 必须在老板发现之前搞清楚这一点。在每次游乐开始前，Erika 会把所有灯都关掉，然后可以选择性地打开部分开关。当游乐车从一个亮着灯的房间进入一个没开灯的房间，或者从没开灯的房间进入亮着灯的房间时，Erika 会听到乘客兴奋地尖叫一声。由于游乐车速度不定，Erika无法直接判断哪些房间亮着灯，但她**至少能知道尖叫的总次数**。也就是说，她能知道游乐车经过了多少次“亮房间 $\\leftrightarrow$ 暗房间”的切换。\n\n你能帮 Erika 在老板发现前，找出哪两个开关分别控制首尾两个房间的灯吗？你最多可以进行 30 次游乐实验。\n\n### 交互说明\n\n本题为交互题。\n\n- 程序首先读入一行整数 $N$，表示黑暗游乐项目的房间数。\n- 然后，程序与评测器交互。每次你想发起一次游乐实验时，应输出一行以问号 \"?\" 开头，后跟一个长度为 $N$ 的 01 字符串，表示你打开了哪些开关（1 表示打开，0 表示关闭）。随后，程序应读入一个整数 $\\ell$（$0 \\leq \\ell < N$），表示 Erika 听到的尖叫次数。\n- 当你想输出最终答案时，输出一行以感叹号 \"!\" 开头，后接两个整数 $A$ 和 $B$（$0 \\leq A, B < N$）。这两个数必须是控制首尾两个房间灯的开关编号，顺序不限。输出答案后，程序应立即退出。\n\n评测器是非自适应的，即隐藏数组 $p$ 在交互开始前就已确定。\n\n每次游乐实验后请确保立即刷新标准输出，否则可能被判为超时。在 Python 中，使用 `input()` 读取输入时会自动刷新；C++ 中可以用 `cout << endl;` 或 `fflush(stdout)` 手动刷新。\n", "inputFormat": "见交互说明。", "outputFormat": "见交互说明。", "hint": "### 样例说明\n\n在第一个样例中，隐藏排列为 $[p_0, p_1, p_2, p_3, p_4] = [2, 1, 0, 3, 4]$，符合测试组 2、5、6 的约束。首先，程序读入 $N = 5$。然后，程序请求一次游乐，打开了第 4 号和第 0 号开关。这两个开关分别控制房间 $p_4 = 4$ 和 $p_0 = 2$ 的灯。Erika 听到 3 次尖叫（见下图箭头）：第一次是从暗房间 1 进入亮房间 2，第二次是从亮房间 2 进入暗房间 3，第三次是从暗房间 3 进入亮房间 4。接着，程序请求另一次游乐，打开了第 0、2、3 号开关，点亮了 $p_0, p_2, p_3$ 号房间，也有 3 次尖叫。最后，程序输出 $A = 2$ 和 $B = 4$，即这两个开关分别控制首尾两个房间（$p_2 = 0$，$p_4 = 4$）。注意，$A = 4, B = 2$ 也是正确答案。\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/q3hcla6s)\n\n在第二个样例中，隐藏排列为 $[p_0, p_1, p_2] = [2, 0, 1]$，符合测试组 1、2、5、6 的约束。程序请求一次游乐，全部开关都打开，所有房间全亮，因此 Erika 听不到尖叫。第二次游乐，打开第 1、0 号开关，点亮房间 $p_1 = 0$ 和 $p_0 = 2$，房间 1 是暗的。Erika 听到两次尖叫：从房间 0（亮）到房间 1（暗），再从房间 1（暗）到房间 2（亮）。第三次游乐，所有开关均关闭，所有房间全暗，Erika 也听不到尖叫。最后，程序输出 $1\\ 0$，即这两个开关控制首尾两个房间。$! 0 1$ 和 $! 1 0$ 都是正确答案。\n\n在第三个样例中，隐藏排列为 $[p_0, p_1, p_2, p_3] = [0, 1, 2, 3]$，符合测试组 2、3、4、5、6 的约束。注意本例仅做一次游乐实验，实际上不一定能唯一推断出答案，但样例解答猜对了。\n\n### 测试工具\n\n为方便测试，官方提供了一个简单的工具。见题目页面底部的“attachments”。该工具为可选项，正式评测器与此工具略有不同。\n\n使用方法：准备一个输入文件（如 \"sample1.in\"），文件第一行为 $N$，第二行为 $p_0, p_1, \\ldots, p_{N-1}$，即隐藏排列。例如：\n\n```\n5\n2 1 0 3 4\n```\n\n对于 Python 程序（如 solution.py，通常用 `pypy3 solution.py` 运行），可用如下命令：\n\n```\npython3 testing_tool.py pypy3 solution.py < sample1.in\n```\n\nC++ 程序编译后（如 `g++ -g -O2 -std=gnu++23 -static solution.cpp -o solution.out`），可用如下命令：\n\n```\npython3 testing_tool.py ./solution.out < sample1.in\n```\n\n### 约束与评分\n\n- $3 \\leq N \\leq 30000$\n- 最多可进行 30 次游乐实验（输出最终答案不计入次数）。超出此限制将被判为 Wrong Answer。\n\n你的解答将在一组测试组上进行评测，每组有若干测试用例。要获得该测试组的分数，你需要通过该测试组的所有测试用例。\n\n| 测试组 | 分值 | 限制条件 |\n| :-: | :-: | :-: |\n| 1 | 9 | $N=3$ |\n| 2 | 15 | $N \\leq 30$ |\n| 3 | 17 | $p_0=0$，即开关 0 控制房间 0 |\n| 4 | 16 | $N$ 为偶数，且一个端点房间的开关在前半部分，另一个在后半部分 |\n| 5 | 14 | $N \\leq 1000$ |\n| 6 | 29 | 无额外限制 |\n\n翻译由 ChatGPT-4.1 完成。", "locale": "zh-CN"}}}
{"pid": "P13341", "type": "P", "difficulty": 6, "samples": [["2", "0 1 2 3 4 5 6 7 8 9 10 11\n38 39 40 41 42 43 44 45 46 47 48 49"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2025", "Special Judge", "EGOI（欧洲/女生）"], "title": "[EGOI 2025] Monster-Go", "background": "", "description": "Helen and her friends have discovered an amazing new game for their phones. The game, called Monster-Go, is about catching monsters by walking to different monster nests outdoors. There are an infinite number of monsters of a single type available at each nest. When the friends arrive at a monster nest, each of them will catch and add the monster type at that nest to their collection. There are a total of $50$ different monster types that the friends can catch, numbered $0, 1, \\ldots, 49$.\n\nTo make the game more exciting, the $N$ friends have decided that each player will have a personalized list of exactly $12$ monster types to collect. The first person to catch all the monsters on their list wins the game. They want to design the lists in such a way that, no matter the order in which they visit the monster nests, there is always a single, unique winner – never a tie. The friends always walk around together as a group and arrive together at a monster nest.\n\nCan you help them design the lists? Your score will depend on the number of values of $N$, the number of people playing, for which you are able to solve the problem.", "inputFormat": "The first and only line of input contains the integer $N$, the number of players.\n", "outputFormat": "Output $N$ lines, where the $i$th line has $12$ distinct integers $c_{i,1}, c_{i,2}, \\ldots, c_{i,12}$ (where $0 \\leq c_{i,j} \\leq 49$) representing the monster types on the list of person $i$. If there are multiple solutions, you may print any of them.", "hint": "### Example\n\nIn the sample, where there are $N = 2$ friends, the program should output two lists. Indeed, for the two lists in the sample output, the friends cannot both win at the same time, no matter the order in which they visit the monster nests. Note that there are many other valid answers.\n\n### Constraints and Scoring\n\n- $1 \\leq N \\leq 50$.\n\nYour solution will be tested on a set of test groups, each worth a number of points. The $i$th test group contains a single test case with $N = i$ and is worth 2 points. That is, there are a total of 50 tests (one for each $N = 1, 2, \\ldots, 50$), and your score on this problem is twice the number of tests your program solves.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 2 | $N = 1$ |\n| 2 | 2 | $N = 2$ |\n| 3 | 2 | $N = 3$ |\n| $\\vdots$ | $\\vdots$ | $\\vdots$ |\n| 49 | 2 | $N = 49$ |\n| 50 | 2 | $N = 50$ |", "locale": "en", "translations": {"en": {"title": "[EGOI 2025] Monster-Go", "background": "", "description": "Helen and her friends have discovered an amazing new game for their phones. The game, called Monster-Go, is about catching monsters by walking to different monster nests outdoors. There are an infinite number of monsters of a single type available at each nest. When the friends arrive at a monster nest, each of them will catch and add the monster type at that nest to their collection. There are a total of $50$ different monster types that the friends can catch, numbered $0, 1, \\ldots, 49$.\n\nTo make the game more exciting, the $N$ friends have decided that each player will have a personalized list of exactly $12$ monster types to collect. The first person to catch all the monsters on their list wins the game. They want to design the lists in such a way that, no matter the order in which they visit the monster nests, there is always a single, unique winner – never a tie. The friends always walk around together as a group and arrive together at a monster nest.\n\nCan you help them design the lists? Your score will depend on the number of values of $N$, the number of people playing, for which you are able to solve the problem.", "inputFormat": "The first and only line of input contains the integer $N$, the number of players.\n", "outputFormat": "Output $N$ lines, where the $i$th line has $12$ distinct integers $c_{i,1}, c_{i,2}, \\ldots, c_{i,12}$ (where $0 \\leq c_{i,j} \\leq 49$) representing the monster types on the list of person $i$. If there are multiple solutions, you may print any of them.", "hint": "### Example\n\nIn the sample, where there are $N = 2$ friends, the program should output two lists. Indeed, for the two lists in the sample output, the friends cannot both win at the same time, no matter the order in which they visit the monster nests. Note that there are many other valid answers.\n\n### Constraints and Scoring\n\n- $1 \\leq N \\leq 50$.\n\nYour solution will be tested on a set of test groups, each worth a number of points. The $i$th test group contains a single test case with $N = i$ and is worth 2 points. That is, there are a total of 50 tests (one for each $N = 1, 2, \\ldots, 50$), and your score on this problem is twice the number of tests your program solves.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 2 | $N = 1$ |\n| 2 | 2 | $N = 2$ |\n| 3 | 2 | $N = 3$ |\n| $\\vdots$ | $\\vdots$ | $\\vdots$ |\n| 49 | 2 | $N = 49$ |\n| 50 | 2 | $N = 50$ |", "locale": "en"}, "zh-CN": {"title": "[EGOI 2025] Monster-Go / 怪兽 Go", "background": "", "description": "Helen 和她的朋友们发现了一款非常棒的新手机游戏。这款名为 Monster-Go 的游戏，玩法是在户外前往不同的怪兽巢穴，通过行走来捕捉怪兽。在每个怪兽巢穴，都有无限只同一类型的怪兽可供捕捉。当朋友们抵达某个怪兽巢穴时，每个人都会捕获并将该巢穴的怪兽类型加入自己的收藏。总共有 $50$ 种不同类型的怪兽，编号为 $0, 1, \\ldots, 49$。\n\n为了让游戏更有趣，$N$ 位朋友决定每个人各有一份专属的怪兽收集清单，清单上恰好有 $12$ 种怪兽类型。第一个集齐自己清单上所有怪兽的人获胜。他们希望设计这些清单，使得无论以什么顺序前往怪兽巢穴，最终都只会有唯一的一名获胜者——绝不会出现平局。这些朋友们始终结伴同行，并且总是一起抵达怪兽巢穴。\n\n你能帮他们设计这些清单吗？你的得分取决于你能解决多少种 $N$（即有多少个玩家）的情况。", "inputFormat": "输入的第一行包含一个整数 $N$，表示玩家人数。\n", "outputFormat": "输出 $N$ 行，第 $i$ 行包含 $12$ 个互不相同的整数 $c_{i,1}, c_{i,2}, \\ldots, c_{i,12}$（$0 \\leq c_{i,j} \\leq 49$），表示第 $i$ 个人的怪兽清单。如果有多种方案，输出任意一种即可。\n", "hint": "### 样例解释\n\n在样例中，有 $N = 2$ 位朋友，程序应输出两份清单。事实上，无论朋友们以什么顺序前往怪兽巢穴，这两份清单都不会导致两人同时获胜。注意，还有许多其他合法答案。\n\n### 约束与评分\n\n- $1 \\leq N \\leq 50$。\n\n你的解答将在一组测试组上进行评测，每组仅包含一个测试用例，$N = i$，每组分值为 2 分。也就是说，总共有 50 个测试（分别对应 $N = 1, 2, \\ldots, 50$），你的得分等于你解出的测试数量乘以 2。\n\n| 组别 | 分值 | 限制条件 |\n| :-: | :-: | :-: |\n| 1 | 2 | $N = 1$ |\n| 2 | 2 | $N = 2$ |\n| 3 | 2 | $N = 3$ |\n| $\\vdots$ | $\\vdots$ | $\\vdots$ |\n| 49 | 2 | $N = 49$ |\n| 50 | 2 | $N = 50$ |\n\n翻译由 ChatGPT-4.1 完成。", "locale": "zh-CN"}}}
{"pid": "P13342", "type": "P", "difficulty": 6, "samples": [["5 5 3\n1 0 2\n0 2 5\n1 2 3\n3 0 6\n2 4 3\n1 1\n3 4\n1 4", "14\n8\n2"], ["5 4 4\n0 1 3\n1 2 1\n2 3 5\n3 4 2\n0 4\n2 3\n2 4\n2 2", "0\n6\n4\n11"], ["7 7 4\n6 4 3\n1 4 5\n3 2 4\n0 3 2\n5 2 3\n4 0 1\n1 3 1\n0 1\n2 3\n4 5\n5 6", "12\n10\n10\n10"], ["7 7 3\n2 6 1\n1 0 1\n0 5 1\n1 2 2\n3 4 1\n5 3 1\n5 4 1\n5 6\n1 3\n3 4", "5\n4\n6"], ["7 7 4\n6 4 3\n1 4 5\n3 2 4\n0 3 2\n5 2 3\n4 0 1\n1 3 1\n0 3\n0 6\n0 1\n0 4\n", "7\n0\n12\n6"], ["9 13 4\n0 1 1\n2 0 3\n1 2 4\n5 4 4\n2 5 6\n3 1 7\n8 1 4\n6 3 9\n0 3 5\n3 5 3\n4 3 2\n6 2 4\n7 8 5\n1 8\n4 7\n6 7\n1 2", "1\n14\n22\n24"], ["6 5 1\n0 1 1000000000\n1 2 1000000000\n2 3 1000000000\n3 4 1000000000\n4 5 1000000000\n1 1", "5000000000"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2025", "EGOI（欧洲/女生）"], "title": "[EGOI 2025] Wind Turbines", "background": "", "description": "Anna has been tasked with designing the wiring for a new offshore wind farm in the North Sea consisting of $N$ turbines, numbered $0, 1, \\ldots, N-1$. Her goal is to ensure that all turbines are connected to the shore as cheaply as possible.\n\nAnna has a list of $M$ potential connections, each linking two wind turbines and having a specific cost. Additionally, the nearby city has agreed to cover the costs of connecting a consecutive interval $[\\ell, r]$ of turbines to the shore. That is, each turbine $t$ in this range ($\\ell \\leq t \\leq r$) is directly connected to the shore for free. If all potential connections are built, there is a way to reach any wind turbine from any other wind turbine. That implies that as soon as one of the wind turbines is connected to the shore, it is possible to build connections such that the power from all the turbines can be transferred to the shore. Of course, more connections to the shore may allow for a cheaper total cost. Note that the free connections are the only direct ones to the shore.\n\nIt is Anna's job to select a subset of the potential connections in a way that minimizes the sum of their costs, while ensuring that every wind turbine can reach the shore (possibly via other wind turbines).\n\nIn order to make an informed decision, the city provides Anna with $Q$ possible options for the interval $[\\ell, r]$. The city asks Anna to compute the minimum cost for each of these scenarios.", "inputFormat": "The first line of the input contains three integers, $N$, $M$ and $Q$.\n\nThe following $M$ lines contain three integers each, $u_i$, $v_i$ and $c_i$. The $i$th line describes a potential connection between wind turbines $u_i$ and $v_i$ that has the cost $c_i$. These connections are undirected and connect two different turbines. No two connections are between the same pair of turbines. It is guaranteed that, if all potential connections are built, any wind turbine is reachable from any other (directly or indirectly).\n\nThe next $Q$ lines contain two integers each, $\\ell_i$ and $r_i$, describing the scenario where the shore directly connects to the wind turbines $\\ell_i, \\ell_i + 1, \\ldots, r_i$. Note that we can have $r_i = \\ell_i$ when the shore directly connects to a single wind turbine.\n", "outputFormat": "Output $Q$ lines, one line per scenario, containing one integer each, the minimum cost of connecting the turbines such that every turbine can deliver its power to the shore.", "hint": "### Examples\n\nIn the first example, we are given the following graph of potential connections.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/9vvrbaq1)\n\nWe are given three scenarios. In the first scenario, turbine $1$ is the only one with a connection to the shore. In this case, we need to keep all connections except for the connection between turbine $0$ and turbine $2$, giving a total cost of $2 + 3 + 6 + 3 = 14$. In the next scenario, the turbines $3$ and $4$ are connected to the shore. In this case, we keep the connections $(1,0)$, $(1,2)$ and $(2,4)$, giving a cost of $8$. In the third scenario, all but turbine $0$ are connected to the shore. In this case, we only need to connect this one to another turbine, which we do by choosing the connection $(0,1)$. The solutions to the scenarios are depicted below:\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/7y6bl7jd)![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/x7wshaz0)![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/o7avlybt)\n\nThe first and the sixth samples satisfy the constraints of test groups $2$, $5$ and $7$. The second and the seventh samples satisfy the constraints of test groups $1$, $2$, $5$ and $7$. The third sample satisfies the constraints of test groups $2$, $3$, $5$ and $7$. The fourth sample satisfies the constraints of test groups $2$, $4$, $5$ and $7$. The fifth sample satisfies the constraints of test groups $2$, $5$, $6$ and $7$.\n\n### Constraints and Scoring\n\n* $2 \\leq N \\leq 100000$.\n* $1 \\leq M \\leq 100000$.\n* $1 \\leq Q \\leq 200000$.\n* $0 \\leq u_i, v_i \\leq N-1$.\n* $u_i \\neq v_i$, and there is at most one direct connection between each pair of wind turbines.\n* $1 \\leq c_i \\leq 1000000000$.\n* $0 \\leq \\ell_i \\leq r_i \\leq N-1$.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all the test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 8 | $M = N - 1$ and the $i$th connection has $u_i = i$ and $v_i = i + 1$, i.e. if all connections are built, they form a path $0 \\leftrightarrow 1 \\leftrightarrow 2 \\leftrightarrow \\ldots \\leftrightarrow N - 1$ |\n| 2 | 11 | $N, M, Q \\leq 2000$ and $\\sum (r_i - \\ell_i + 1) \\leq 2000$ |\n| 3 | 13 | $r_i = \\ell_i + 1$ for all $i$ |\n| 4 | 17 | $1 \\leq c_i \\leq 2$ for all $i$, i.e., each connection has cost either $1$ or $2$ |\n| 5 | 16 | $\\sum (r_i - \\ell_i + 1) \\leq 400000$ |\n| 6 | 14 | $\\ell_i = 0$ for all $i$ |\n| 7 | 21 | No additional constraints |\n", "locale": "en", "translations": {"en": {"title": "[EGOI 2025] Wind Turbines", "background": "", "description": "Anna has been tasked with designing the wiring for a new offshore wind farm in the North Sea consisting of $N$ turbines, numbered $0, 1, \\ldots, N-1$. Her goal is to ensure that all turbines are connected to the shore as cheaply as possible.\n\nAnna has a list of $M$ potential connections, each linking two wind turbines and having a specific cost. Additionally, the nearby city has agreed to cover the costs of connecting a consecutive interval $[\\ell, r]$ of turbines to the shore. That is, each turbine $t$ in this range ($\\ell \\leq t \\leq r$) is directly connected to the shore for free. If all potential connections are built, there is a way to reach any wind turbine from any other wind turbine. That implies that as soon as one of the wind turbines is connected to the shore, it is possible to build connections such that the power from all the turbines can be transferred to the shore. Of course, more connections to the shore may allow for a cheaper total cost. Note that the free connections are the only direct ones to the shore.\n\nIt is Anna's job to select a subset of the potential connections in a way that minimizes the sum of their costs, while ensuring that every wind turbine can reach the shore (possibly via other wind turbines).\n\nIn order to make an informed decision, the city provides Anna with $Q$ possible options for the interval $[\\ell, r]$. The city asks Anna to compute the minimum cost for each of these scenarios.", "inputFormat": "The first line of the input contains three integers, $N$, $M$ and $Q$.\n\nThe following $M$ lines contain three integers each, $u_i$, $v_i$ and $c_i$. The $i$th line describes a potential connection between wind turbines $u_i$ and $v_i$ that has the cost $c_i$. These connections are undirected and connect two different turbines. No two connections are between the same pair of turbines. It is guaranteed that, if all potential connections are built, any wind turbine is reachable from any other (directly or indirectly).\n\nThe next $Q$ lines contain two integers each, $\\ell_i$ and $r_i$, describing the scenario where the shore directly connects to the wind turbines $\\ell_i, \\ell_i + 1, \\ldots, r_i$. Note that we can have $r_i = \\ell_i$ when the shore directly connects to a single wind turbine.\n", "outputFormat": "Output $Q$ lines, one line per scenario, containing one integer each, the minimum cost of connecting the turbines such that every turbine can deliver its power to the shore.", "hint": "### Examples\n\nIn the first example, we are given the following graph of potential connections.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/9vvrbaq1)\n\nWe are given three scenarios. In the first scenario, turbine $1$ is the only one with a connection to the shore. In this case, we need to keep all connections except for the connection between turbine $0$ and turbine $2$, giving a total cost of $2 + 3 + 6 + 3 = 14$. In the next scenario, the turbines $3$ and $4$ are connected to the shore. In this case, we keep the connections $(1,0)$, $(1,2)$ and $(2,4)$, giving a cost of $8$. In the third scenario, all but turbine $0$ are connected to the shore. In this case, we only need to connect this one to another turbine, which we do by choosing the connection $(0,1)$. The solutions to the scenarios are depicted below:\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/7y6bl7jd)![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/x7wshaz0)![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/o7avlybt)\n\nThe first and the sixth samples satisfy the constraints of test groups $2$, $5$ and $7$. The second and the seventh samples satisfy the constraints of test groups $1$, $2$, $5$ and $7$. The third sample satisfies the constraints of test groups $2$, $3$, $5$ and $7$. The fourth sample satisfies the constraints of test groups $2$, $4$, $5$ and $7$. The fifth sample satisfies the constraints of test groups $2$, $5$, $6$ and $7$.\n\n### Constraints and Scoring\n\n* $2 \\leq N \\leq 100000$.\n* $1 \\leq M \\leq 100000$.\n* $1 \\leq Q \\leq 200000$.\n* $0 \\leq u_i, v_i \\leq N-1$.\n* $u_i \\neq v_i$, and there is at most one direct connection between each pair of wind turbines.\n* $1 \\leq c_i \\leq 1000000000$.\n* $0 \\leq \\ell_i \\leq r_i \\leq N-1$.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all the test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 8 | $M = N - 1$ and the $i$th connection has $u_i = i$ and $v_i = i + 1$, i.e. if all connections are built, they form a path $0 \\leftrightarrow 1 \\leftrightarrow 2 \\leftrightarrow \\ldots \\leftrightarrow N - 1$ |\n| 2 | 11 | $N, M, Q \\leq 2000$ and $\\sum (r_i - \\ell_i + 1) \\leq 2000$ |\n| 3 | 13 | $r_i = \\ell_i + 1$ for all $i$ |\n| 4 | 17 | $1 \\leq c_i \\leq 2$ for all $i$, i.e., each connection has cost either $1$ or $2$ |\n| 5 | 16 | $\\sum (r_i - \\ell_i + 1) \\leq 400000$ |\n| 6 | 14 | $\\ell_i = 0$ for all $i$ |\n| 7 | 21 | No additional constraints |\n", "locale": "en"}, "zh-CN": {"title": "[EGOI 2025] Wind Turbines / 风力涡轮机", "background": "", "description": "Anna 负责为北海新建的一个海上风电场设计电缆布线。该风电场有 $N$ 台风力发电机，编号为 $0, 1, \\ldots, N-1$。她的目标是确保所有发电机都能以最低的成本与陆地（岸边）连通。\n\nAnna 拥有 $M$ 条可选的连接，每条连接都连接两台风力发电机，并有一个特定的费用。此外，附近的城市同意承担将一段连续编号区间 $[\\ell, r]$ 内的发电机直接接入岸边的费用。也就是说，区间内的每台发电机 $t$（$\\ell \\leq t \\leq r$）都可以免费直接接入岸边。如果所有可选连接都建成，则任意两台发电机之间都可以互相到达。这意味着只要有一台发电机接入岸边，就可以通过某些连接让所有发电机的电力都输送到岸边。当然，如果有更多发电机直接接入岸边，可能可以进一步降低总成本。注意，免费连接是唯一能直接连到岸边的方式。\n\nAnna 的任务是选择一部分可选连接，使得它们的总费用最小，并保证每台发电机都能通过某些路径与岸边连通（可以经过其他发电机）。\n\n为了让 Anna 做出明智的决策，城市方提供了 $Q$ 种不同的区间 $[\\ell, r]$ 方案。城市方希望 Anna 计算在每种方案下的最小总费用。", "inputFormat": "第一行包含三个整数 $N$、$M$ 和 $Q$。\n\n接下来的 $M$ 行，每行包含三个整数 $u_i$、$v_i$ 和 $c_i$，表示一条可选的无向连接，连接发电机 $u_i$ 和 $v_i$，费用为 $c_i$。每对发电机之间至多有一条直接连接，且 $u_i \\neq v_i$。保证如果所有可选连接都建成，任意两台发电机之间都可以互相到达。\n\n接下来 $Q$ 行，每行两个整数 $\\ell_i$ 和 $r_i$，表示一种方案，在该方案下，岸边直接接入区间 $[\\ell_i, r_i]$ 内的所有发电机。注意，可能有 $r_i = \\ell_i$，即岸边只直接接入一台发电机。\n", "outputFormat": "输出 $Q$ 行，每行一个整数，表示在对应方案下，使所有发电机都能把电送到岸边所需的最小总费用。\n", "hint": "### 样例说明\n\n在第一个样例中，给定如下图的可选连接：\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/9vvrbaq1)\n\n有三种方案。第一种方案中，只有发电机 $1$ 直接接入岸边，此时需要保留除 $(0,2)$ 以外的所有连接，总费用为 $2 + 3 + 6 + 3 = 14$。第二种方案中，发电机 $3$ 和 $4$ 直接接入岸边，此时只需保留 $(1,0)$、$(1,2)$ 和 $(2,4)$，总费用为 $8$。第三种方案中，除了发电机 $0$ 以外，其他都直接接入岸边，此时只需将 $0$ 与任一发电机连接即可，选择 $(0,1)$，费用为 $2$。下图展示了三种方案的最优方案：\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/7y6bl7jd)![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/x7wshaz0)![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/o7avlybt)\n\n第一个和第六个样例满足测试组 $2$、$5$、$7$ 的约束。第二个和第七个样例满足测试组 $1$、$2$、$5$、$7$ 的约束。第三个样例满足测试组 $2$、$3$、$5$、$7$ 的约束。第四个样例满足测试组 $2$、$4$、$5$、$7$ 的约束。第五个样例满足测试组 $2$、$5$、$6$、$7$ 的约束。\n\n### 约束与评分\n\n- $2 \\leq N \\leq 100000$\n- $1 \\leq M \\leq 100000$\n- $1 \\leq Q \\leq 200000$\n- $0 \\leq u_i, v_i \\leq N-1$\n- $u_i \\neq v_i$，且每对发电机之间至多有一条直接连接\n- $1 \\leq c_i \\leq 1000000000$\n- $0 \\leq \\ell_i \\leq r_i \\leq N-1$\n\n你的解答将在一组测试组上进行评测，每组有若干测试用例。要获得该测试组的分数，你需要通过该测试组的所有测试用例。\n\n| 组别 | 分值 | 限制条件 |\n| :-: | :-: | :-: |\n| 1 | 8 | $M = N - 1$，且第 $i$ 条连接为 $u_i = i$，$v_i = i + 1$，即所有连接连成一条链 $0 \\leftrightarrow 1 \\leftrightarrow 2 \\leftrightarrow \\ldots \\leftrightarrow N - 1$ |\n| 2 | 11 | $N, M, Q \\leq 2000$ 且 $\\sum (r_i - \\ell_i + 1) \\leq 2000$ |\n| 3 | 13 | 对所有 $i$，$r_i = \\ell_i + 1$ |\n| 4 | 17 | 对所有 $i$，$1 \\leq c_i \\leq 2$，即每条连接的费用为 $1$ 或 $2$ |\n| 5 | 16 | $\\sum (r_i - \\ell_i + 1) \\leq 400000$ |\n| 6 | 14 | 对所有 $i$，$\\ell_i = 0$ |\n| 7 | 21 | 无额外限制 |", "locale": "zh-CN"}}}
{"pid": "P13343", "type": "P", "difficulty": 4, "samples": [["5\n1 5\n4 9\n6 3\n2 7\n0 8", "3\n4 8 9\n0 5 8\n1 9 5"], ["5\n0 1\n3 2\n4 5\n6 7\n9 8", "4\n1 3 9\n4 9 3\n2 5 7\n3 7 5"], ["4\n1 4\n6 3\n5 2\n7 0", "2\n0 4 6\n1 6 4"], ["6\n3 9\n7 5\n10 2\n0 6\n1 11\n8 4", "6\n3 6 1\n4 1 2\n2 2 3\n0 3 4\n5 4 5\n1 5 6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2025", "Special Judge", "构造", "EGOI（欧洲/女生）"], "title": "[EGOI 2025] A String Problem", "background": "", "description": "Lara loves flea markets. Last Saturday, there was the Rheinaue-Flohmarkt in Bonn, one of the biggest flea markets in Germany. Of course, Lara spent the whole day there, strolling through the market, haggling over prices, and buying all kinds of curious things. The most interesting thing she brought home was a small harp in a perfectly circular shape. When she wanted to start playing it, she noticed that the strings were all over the place rather than being parallel to each other.\n\nMore specifically, there are $2 \\cdot N$ pins distributed evenly around the circular frame. Each of the $N$ strings is held in place by two of the pins, and every pin has exactly one string attached.\n\nLara does not know much about harps, but she strongly suspects that the strings should be aligned so that they are parallel to each other. To fix this issue, she decides to restring the harp. In each step, she can detach one end of a string from its pin and reattach it to a different pin. During the process it is okay if the ends of multiple strings are attached to the same pin. In the end, there should be exactly one string attached to every pin once again, and the $N$ strings should be parallel to each other.\n\nBelow you can find two examples of harps with parallel strings.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6rdakys8.png)\n\nSince each step of restringing is a lot of work, Lara wants to restring the harp with as few steps as possible. Help Lara find a restringing sequence that takes the minimum number of steps!", "inputFormat": "The first line of input contains one integer $N$, denoting the number of strings. The strings are numbered from $0$ to $N - 1$.\n\nThen follow $N$ lines, where the $i$th line ($0 \\leq i \\leq N - 1$) contains two integers $a_i$ and $b_i$, the two pins that hold the $i$th string in place. The pins are numbered in clockwise order from $0$ to $2 \\cdot N - 1$. Every pin has exactly one string attached.", "outputFormat": "Output an integer $K$, the minimum number of steps needed to restring the harp such that all strings are parallel to each other.\n\nFurther, output $K$ lines, each containing three integers $p$, $s$, and $e$, denoting that in this step of your solution, one end of the $p$th string should be detached from pin $s$ and reattached to pin $e$ ($0 \\leq p \\leq N - 1$, $0 \\leq s, e \\leq 2 \\cdot N - 1$).\n\nNote that if the $p$th string is not attached to pin $s$ at that moment, the sequence of moves is considered to be incorrect.\n\nIf several answers exist, you may print any of them. Note that partially correct answers may still score some points, as explained in the next section.", "hint": "### Examples\n\nIn the first sample, we are given a harp with five strings. In the first step, string $4$ is detached from pin $8$ and reattached to pin $9$. In the next step, string $0$ is detached from pin $5$ and reattached to pin $8$. In the last step, string $1$ is detached from pin $9$ and reattached to pin $5$. Now, there is exactly one string attached to each pin, and all strings are parallel to each other. This sequence is shown in the figure below.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/he01kk6p)\n\nThe figure below shows the initial state of the harp for samples 2, 3, and 4.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/cs6iziyp)\n\n- The first sample satisfies the constraints of test groups 4 and 5.\n- The second sample satisfies the constraints of test groups 1, 3, 4, and 5.\n- The third sample satisfies the constraints of test groups 2, 4, and 5.\n- The fourth sample satisfies the constraints of test groups 3, 4, and 5.\n\n### Constraints and Scoring\n\n* $4 \\leq N \\leq 100\\,000$.\n* $0 \\leq a_i, b_i \\leq 2 \\cdot N - 1$.\n* All $a_i$ and $b_i$ are unique.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. For each test group, your points are determined as follows:\n\n* If your program solves all test cases in the test group, you get $100\\%$ of the points.\n* If your program does not fully solve the test group but it correctly outputs the minimum number of steps for each of them, you get $50\\%$ of the points.\n\nWhen determining whether your solution scores $50\\%$ of the points for a test group, only the value $K$ it outputs is judged. The solution can just output the value $K$ and terminate, or it can even output an invalid sequence of moves. Note that your solution still has to finish within the time limit and terminate correctly.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 14 | String $i$ is attached to pins $2 \\cdot i$ and $2 \\cdot i + 1$ for all $i$ |\n| 2 | 16 | The number of steps needed is at most 2 |\n| 3 | 12 | It is guaranteed that there is a solution where one string is attached to pins 0 and 1 |\n| 4 | 28 | $N \\leq 1000$ |\n| 5 | 30 | No additional constraints |\n", "locale": "en", "translations": {"en": {"title": "[EGOI 2025] A String Problem", "background": "", "description": "Lara loves flea markets. Last Saturday, there was the Rheinaue-Flohmarkt in Bonn, one of the biggest flea markets in Germany. Of course, Lara spent the whole day there, strolling through the market, haggling over prices, and buying all kinds of curious things. The most interesting thing she brought home was a small harp in a perfectly circular shape. When she wanted to start playing it, she noticed that the strings were all over the place rather than being parallel to each other.\n\nMore specifically, there are $2 \\cdot N$ pins distributed evenly around the circular frame. Each of the $N$ strings is held in place by two of the pins, and every pin has exactly one string attached.\n\nLara does not know much about harps, but she strongly suspects that the strings should be aligned so that they are parallel to each other. To fix this issue, she decides to restring the harp. In each step, she can detach one end of a string from its pin and reattach it to a different pin. During the process it is okay if the ends of multiple strings are attached to the same pin. In the end, there should be exactly one string attached to every pin once again, and the $N$ strings should be parallel to each other.\n\nBelow you can find two examples of harps with parallel strings.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6rdakys8.png)\n\nSince each step of restringing is a lot of work, Lara wants to restring the harp with as few steps as possible. Help Lara find a restringing sequence that takes the minimum number of steps!", "inputFormat": "The first line of input contains one integer $N$, denoting the number of strings. The strings are numbered from $0$ to $N - 1$.\n\nThen follow $N$ lines, where the $i$th line ($0 \\leq i \\leq N - 1$) contains two integers $a_i$ and $b_i$, the two pins that hold the $i$th string in place. The pins are numbered in clockwise order from $0$ to $2 \\cdot N - 1$. Every pin has exactly one string attached.", "outputFormat": "Output an integer $K$, the minimum number of steps needed to restring the harp such that all strings are parallel to each other.\n\nFurther, output $K$ lines, each containing three integers $p$, $s$, and $e$, denoting that in this step of your solution, one end of the $p$th string should be detached from pin $s$ and reattached to pin $e$ ($0 \\leq p \\leq N - 1$, $0 \\leq s, e \\leq 2 \\cdot N - 1$).\n\nNote that if the $p$th string is not attached to pin $s$ at that moment, the sequence of moves is considered to be incorrect.\n\nIf several answers exist, you may print any of them. Note that partially correct answers may still score some points, as explained in the next section.", "hint": "### Examples\n\nIn the first sample, we are given a harp with five strings. In the first step, string $4$ is detached from pin $8$ and reattached to pin $9$. In the next step, string $0$ is detached from pin $5$ and reattached to pin $8$. In the last step, string $1$ is detached from pin $9$ and reattached to pin $5$. Now, there is exactly one string attached to each pin, and all strings are parallel to each other. This sequence is shown in the figure below.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/he01kk6p)\n\nThe figure below shows the initial state of the harp for samples 2, 3, and 4.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/cs6iziyp)\n\n- The first sample satisfies the constraints of test groups 4 and 5.\n- The second sample satisfies the constraints of test groups 1, 3, 4, and 5.\n- The third sample satisfies the constraints of test groups 2, 4, and 5.\n- The fourth sample satisfies the constraints of test groups 3, 4, and 5.\n\n### Constraints and Scoring\n\n* $4 \\leq N \\leq 100\\,000$.\n* $0 \\leq a_i, b_i \\leq 2 \\cdot N - 1$.\n* All $a_i$ and $b_i$ are unique.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. For each test group, your points are determined as follows:\n\n* If your program solves all test cases in the test group, you get $100\\%$ of the points.\n* If your program does not fully solve the test group but it correctly outputs the minimum number of steps for each of them, you get $50\\%$ of the points.\n\nWhen determining whether your solution scores $50\\%$ of the points for a test group, only the value $K$ it outputs is judged. The solution can just output the value $K$ and terminate, or it can even output an invalid sequence of moves. Note that your solution still has to finish within the time limit and terminate correctly.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 14 | String $i$ is attached to pins $2 \\cdot i$ and $2 \\cdot i + 1$ for all $i$ |\n| 2 | 16 | The number of steps needed is at most 2 |\n| 3 | 12 | It is guaranteed that there is a solution where one string is attached to pins 0 and 1 |\n| 4 | 28 | $N \\leq 1000$ |\n| 5 | 30 | No additional constraints |\n", "locale": "en"}, "zh-CN": {"title": "[EGOI 2025] A String Problem / 一个弦线问题", "background": null, "description": "Lara 非常喜欢跳蚤市场。上周六，德国最大的跳蚤市场之一——Rheinaue-Flohmarkt 在波恩举办。Lara 一整天都在市场里闲逛、讨价还价，并买下了各种新奇的物品。她带回家中最有趣的东西是一把完全呈圆形的小型竖琴。当她准备弹奏时，发现琴弦的分布非常混乱，根本不是彼此平行的。\n\n更具体地说，圆形琴框上均匀分布着 $2 \\cdot N$ 个琴钉。每根琴弦都由两个琴钉固定，每个琴钉正好有一根琴弦连接。\n\nLara 对竖琴并不十分了解，但她很确定琴弦应该都平行排列。为了解决这个问题，她决定重新装配琴弦。每一步操作中，她可以将某根琴弦的一端从一个琴钉上取下，并重新连接到另一个琴钉。在操作过程中，允许多个琴弦的末端临时连接到同一个琴钉。最终，要求每个琴钉上正好有一根琴弦，并且所有 $N$ 根琴弦都平行。\n\n下图给出了两种所有琴弦都平行的竖琴示例。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6rdakys8.png)\n\n由于每次装配都非常耗时，Lara 希望用尽可能少的步骤完成。请帮她找出最少的操作步骤，并给出一种装配方案！", "inputFormat": "第一行输入一个整数 $N$，表示琴弦的数量。琴弦编号为 $0$ 到 $N-1$。\n\n接下来 $N$ 行，第 $i$ 行（$0 \\leq i \\leq N-1$）包含两个整数 $a_i$ 和 $b_i$，表示第 $i$ 根琴弦当前固定在的两个琴钉上。所有琴钉顺时针编号为 $0$ 到 $2N-1$。每个琴钉正好有一根琴弦连接。", "outputFormat": "输出一个整数 $K$，表示为使所有琴弦平行所需的最少操作次数。\n\n接下来输出 $K$ 行，每行三个整数 $p$、$s$ 和 $e$，表示在该步骤中，将第 $p$ 根琴弦从琴钉 $s$ 上取下并重新连接到琴钉 $e$ 上（$0 \\leq p \\leq N-1$，$0 \\leq s, e \\leq 2N-1$）。\n\n注意，如果第 $p$ 根琴弦当前并未连接在 $s$ 上，则该操作序列无效。\n\n若存在多种方案，输出任意一种即可。部分正确的答案也有可能获得部分分，详见下方说明。", "hint": "### 样例说明\n\n在第一个样例中，给出了一把有五根琴弦的竖琴。第一步，将第 $4$ 根琴弦从琴钉 $8$ 取下，重新连接到 $9$；第二步，将第 $0$ 根琴弦从 $5$ 取下，连接到 $8$；最后一步，将第 $1$ 根琴弦从 $9$ 取下，连接到 $5$。此时每个琴钉上正好有一根琴弦，且所有琴弦都平行。如下图所示：\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/he01kk6p)\n\n下图展示了样例 2、3、4 的初始竖琴状态。\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/cs6iziyp)\n\n- 第 1 个样例满足测试组 4 和 5 的约束。\n- 第 2 个样例满足测试组 1、3、4、5 的约束。\n- 第 3 个样例满足测试组 2、4、5 的约束。\n- 第 4 个样例满足测试组 3、4、5 的约束。\n\n### 约束与评分\n\n* $4 \\leq N \\leq 100\\,000$。\n* $0 \\leq a_i, b_i \\leq 2N - 1$。\n* 所有 $a_i$ 和 $b_i$ 互不相同。\n\n你的解答将在一组测试组上进行评测，每组包含若干测试用例。每组得分规则如下：\n\n* 如果你的程序解决了该组所有测试用例，获得 $100\\%$ 分数。\n* 如果你的程序未能完全解决该组，但每个测试用例输出的 $K$ 都是最优的，则获得 $50\\%$ 分数。\n\n判断 $50\\%$ 得分时，仅判定你输出的 $K$，可以只输出 $K$ 后直接退出，也可以输出一个无效的操作序列。你的程序仍需在时限内正确结束。\n\n| 组别 | 分值 | 限制 |\n| :-: | :-: | :-: |\n| 1 | 14 | 对所有 $i$，第 $i$ 根琴弦固定在琴钉 $2i$ 和 $2i+1$ 上 |\n| 2 | 16 | 最多只需 2 步即可完成 |\n| 3 | 12 | 保证存在一种解法，使得有一根琴弦固定在琴钉 0 和 1 上 |\n| 4 | 28 | $N \\leq 1000$ |\n| 5 | 30 | 无额外限制 |\n\n翻译由 ChatGPT-4.1 完成。", "locale": "zh-CN"}}}
{"pid": "P13344", "type": "P", "difficulty": 0, "samples": [["5 6\n0 1\n1 2\n1 3\n2 4\n3 4\n0 3", "2 2 2 1"], ["7 10\n2 6\n5 3\n4 2\n1 6\n2 3\n3 6\n4 5\n0 4\n4 1\n0 1", "2 1 2 3 2 4"], ["2 1\n0 1", "1"], ["6 8\n0 1\n4 0\n1 2\n2 3\n3 5\n0 4\n4 5\n2 0", "2 4 3 3 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2025", "EGOI（欧洲/女生）"], "title": "[EGOI 2025] Currents", "background": "", "description": "Well-hidden in the atrium of an abandoned house, you have found an ancient book that uncovers the most well-kept secret of the city of Bonn. Deep below the city, there is a system of $N$ caves, connected by $M$ water channels. Within each water channel there's a one-directional magical current that can quickly transport a boat along the channel. The cave system currently has exactly one exit that is located in cave $N - 1$.\n\nYou are very excited about your discovery and cannot wait to explore the caves! However, the cave system is inhabited by a troll who likes to have some fun with uninvited visitors. The troll has some limited magical power – which he can use at most once during your visit – to modify the cave system and make it harder for you to reach the exit.\n\nYour visit to the cave system will consist of a sequence of rounds. Each round will be as follows:\n\n1. First, the troll gets to choose whether or not he uses his magical power. If he does, his spell does all of the following:\n   * reverses the direction of the magical current in every channel: $a \\rightarrow b$ will change to $b \\rightarrow a$ immediately;\n   * closes the exit in cave $N - 1$; and\n   * opens a new exit in cave 0.\n2. Then, you choose a magical current that flows from your present cave, and use your boat to travel to another cave. For simplicity, we will call the use of a boat a \"move\".\n\nAdditionally, whenever you are in the same cave as the exit, you will immediately use it to leave the cave system. Note that this can even happen during a round if you are in cave 0 and the troll decides to use his magical power.\n\nYour goal is to leave the cave system as quickly as possible to be in time for the closing ceremony of the EGOI. The troll's goal is exactly the opposite; he wants to keep you in his caves for as long as possible. The troll always knows your location and he will pick the moment at which to use his magical power in a way that serves his goal the best.\n\nSeparately for each cave $c$ ($0 \\leq c \\leq N - 2$) consider the scenario in which you start in cave $c$. For each of these scenarios, determine the **smallest number of moves in which you can definitely reach an exit from cave $c$, no matter when the troll chooses to use his power.**\n\nAssuming the spell is not used, every cave is reachable from cave 0, and cave $N - 1$ is reachable from every cave.\n", "inputFormat": "The first line of the input contains two integers, $N$ and $M$, where $N$ is the number of caves and $M$ is the number of water channels. The next $M$ lines of the input each contain two integers, $a_i$ and $b_i$, representing a channel that right now can be used to travel from cave $a_i$ to cave $b_i$. There is no channel connecting a cave to itself. For each pair of caves there is at most one channel in each direction.\n", "outputFormat": "Output a line with $N - 1$ integers, where the $i$th integer, $0 \\leq i \\leq N - 2$, is the smallest number of moves within which you can definitely reach an exit if starting from cave $i$.\n\nNote that you do not output the time for cave $N - 1$ (as you would just exit this cave immediately).", "hint": "### Examples\n\nFor the first sample, consider the case in which you start in cave 1. Since you do not know when the direction reversal will happen, you should start moving towards the exit at cave 4. You could do that via either cave 2 or cave 3. Going via cave 3 is the better option here since in case the direction reversal happens while you are there, you will now have a channel you can use to travel from cave 3 directly to cave 0 where you'll exit the cave system.\n\nMore precisely, there are only three possibilities for when the troll will decide to use his magical power:\n\n* If the troll uses his power immediately when you're in cave 1, you can then travel from cave 1 directly to cave 0 and exit.\n* If the troll uses his power after you went from cave 1 to cave 3, you can then travel from cave 3 directly to cave 0 and exit.\n* If the troll decides not to use his power in either of those two situations, you will travel from cave 3 to cave 4 and exit.\n\nIn the first option you only had to make one move, in each of the other options you made two moves. This means the answer for this case is $\\max(1, 2, 2) = 2$.\n\nNote that if you choose to go from cave 1 to cave 2, the troll can force you to make three moves.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/76rqhhwi)\n\nThe first and second samples satisfy the constraints of test groups 3, 4 and 5. The third sample satisfies the constraints of all test groups. The fourth sample satisfies the constraints of test groups 3 and 5, and is illustrated below.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/ue4hznea)\n\n### Constraints and Scoring\n\n* $2 \\leq N \\leq 200\\,000$.\n* $1 \\leq M \\leq 500\\,000$.\n* $0 \\leq a_i, b_i \\leq N - 1$ and $a_i \\neq b_i$.\n* Before the reversal, cave 0 can reach all caves, and cave $N - 1$ can be reached from all caves.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 12 | $M = N - 1$, $a_i = i$ and $b_i = i + 1$ for all $i$. In other words, the cave system forms a path $0 \\rightarrow 1 \\rightarrow 2 \\rightarrow \\ldots \\rightarrow N - 1$ |\n| 2 | 15 | For each $0 \\leq i \\leq N - 2$, there is a direct channel from cave $i$ to cave $N - 1$. Note there can be additional channels. |\n| 3 | 20 | $N, M \\leq 2000$ |\n| 4 | 29 | After leaving any cave, it is not possible to travel back to it (until the direction reversal). In other words, the channels form a directed acyclic graph. |\n| 5 | 24 | No additional constraints |\n", "locale": "en", "translations": {"en": {"title": "[EGOI 2025] Currents", "background": "", "description": "Well-hidden in the atrium of an abandoned house, you have found an ancient book that uncovers the most well-kept secret of the city of Bonn. Deep below the city, there is a system of $N$ caves, connected by $M$ water channels. Within each water channel there's a one-directional magical current that can quickly transport a boat along the channel. The cave system currently has exactly one exit that is located in cave $N - 1$.\n\nYou are very excited about your discovery and cannot wait to explore the caves! However, the cave system is inhabited by a troll who likes to have some fun with uninvited visitors. The troll has some limited magical power – which he can use at most once during your visit – to modify the cave system and make it harder for you to reach the exit.\n\nYour visit to the cave system will consist of a sequence of rounds. Each round will be as follows:\n\n1. First, the troll gets to choose whether or not he uses his magical power. If he does, his spell does all of the following:\n   * reverses the direction of the magical current in every channel: $a \\rightarrow b$ will change to $b \\rightarrow a$ immediately;\n   * closes the exit in cave $N - 1$; and\n   * opens a new exit in cave 0.\n2. Then, you choose a magical current that flows from your present cave, and use your boat to travel to another cave. For simplicity, we will call the use of a boat a \"move\".\n\nAdditionally, whenever you are in the same cave as the exit, you will immediately use it to leave the cave system. Note that this can even happen during a round if you are in cave 0 and the troll decides to use his magical power.\n\nYour goal is to leave the cave system as quickly as possible to be in time for the closing ceremony of the EGOI. The troll's goal is exactly the opposite; he wants to keep you in his caves for as long as possible. The troll always knows your location and he will pick the moment at which to use his magical power in a way that serves his goal the best.\n\nSeparately for each cave $c$ ($0 \\leq c \\leq N - 2$) consider the scenario in which you start in cave $c$. For each of these scenarios, determine the **smallest number of moves in which you can definitely reach an exit from cave $c$, no matter when the troll chooses to use his power.**\n\nAssuming the spell is not used, every cave is reachable from cave 0, and cave $N - 1$ is reachable from every cave.\n", "inputFormat": "The first line of the input contains two integers, $N$ and $M$, where $N$ is the number of caves and $M$ is the number of water channels. The next $M$ lines of the input each contain two integers, $a_i$ and $b_i$, representing a channel that right now can be used to travel from cave $a_i$ to cave $b_i$. There is no channel connecting a cave to itself. For each pair of caves there is at most one channel in each direction.\n", "outputFormat": "Output a line with $N - 1$ integers, where the $i$th integer, $0 \\leq i \\leq N - 2$, is the smallest number of moves within which you can definitely reach an exit if starting from cave $i$.\n\nNote that you do not output the time for cave $N - 1$ (as you would just exit this cave immediately).", "hint": "### Examples\n\nFor the first sample, consider the case in which you start in cave 1. Since you do not know when the direction reversal will happen, you should start moving towards the exit at cave 4. You could do that via either cave 2 or cave 3. Going via cave 3 is the better option here since in case the direction reversal happens while you are there, you will now have a channel you can use to travel from cave 3 directly to cave 0 where you'll exit the cave system.\n\nMore precisely, there are only three possibilities for when the troll will decide to use his magical power:\n\n* If the troll uses his power immediately when you're in cave 1, you can then travel from cave 1 directly to cave 0 and exit.\n* If the troll uses his power after you went from cave 1 to cave 3, you can then travel from cave 3 directly to cave 0 and exit.\n* If the troll decides not to use his power in either of those two situations, you will travel from cave 3 to cave 4 and exit.\n\nIn the first option you only had to make one move, in each of the other options you made two moves. This means the answer for this case is $\\max(1, 2, 2) = 2$.\n\nNote that if you choose to go from cave 1 to cave 2, the troll can force you to make three moves.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/76rqhhwi)\n\nThe first and second samples satisfy the constraints of test groups 3, 4 and 5. The third sample satisfies the constraints of all test groups. The fourth sample satisfies the constraints of test groups 3 and 5, and is illustrated below.\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/ue4hznea)\n\n### Constraints and Scoring\n\n* $2 \\leq N \\leq 200\\,000$.\n* $1 \\leq M \\leq 500\\,000$.\n* $0 \\leq a_i, b_i \\leq N - 1$ and $a_i \\neq b_i$.\n* Before the reversal, cave 0 can reach all caves, and cave $N - 1$ can be reached from all caves.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 12 | $M = N - 1$, $a_i = i$ and $b_i = i + 1$ for all $i$. In other words, the cave system forms a path $0 \\rightarrow 1 \\rightarrow 2 \\rightarrow \\ldots \\rightarrow N - 1$ |\n| 2 | 15 | For each $0 \\leq i \\leq N - 2$, there is a direct channel from cave $i$ to cave $N - 1$. Note there can be additional channels. |\n| 3 | 20 | $N, M \\leq 2000$ |\n| 4 | 29 | After leaving any cave, it is not possible to travel back to it (until the direction reversal). In other words, the channels form a directed acyclic graph. |\n| 5 | 24 | No additional constraints |\n", "locale": "en"}, "zh-CN": {"title": "[EGOI 2025] Currents / 水流", "background": "", "description": "你在一座废弃宅邸的中庭深处，发现了一本古老的书，揭示了波恩市最隐秘的秘密。在城市的地下深处，存在着一个由 $N$ 个洞穴组成的系统，这些洞穴通过 $M$ 条水道连接。每条水道中都流淌着单向的魔力水流，可以让船只沿着水道快速穿梭。洞穴系统目前只有一个出口，位于洞穴 $N-1$。\n\n你对自己的发现感到无比兴奋，迫不及待地想要探索这些洞穴！然而，这个洞穴系统里住着一个巨魔，他喜欢戏弄不速之客。巨魔拥有有限的魔力——在你探险期间，他最多只能使用一次——可以用来修改洞穴系统，使你更难到达出口。\n\n你的洞穴探险由若干轮组成。每一轮流程如下：\n\n1. 首先，巨魔可以选择是否使用他的魔法。如果他使用，咒语会同时产生以下效果：\n  * 立刻反转所有水道的魔力水流方向：$a \\rightarrow b$ 会变为 $b \\rightarrow a$；\n  * 关闭位于洞穴 $N-1$ 的出口；\n  * 并在洞穴 $0$ 开启一个新的出口。\n2. 然后，你可以选择一条从当前洞穴出发的水道，用船移动到另一个洞穴。为简便起见，每次乘船称为“一步移动”。\n\n此外，每当你处于有出口的洞穴时，你会立刻离开洞穴系统。注意，如果你在某一轮时正好处于洞穴 $0$，而巨魔选择此时发动魔法，你也会立即通过新开的出口离开。\n\n你的目标是尽快离开洞穴系统，好赶上 EGOI 的闭幕式。而巨魔的目标正好相反：他希望你在洞穴里待得越久越好。巨魔总是知道你的位置，并会选择对他最有利的时机发动魔法。\n\n对于每个洞穴 $c$（$0 \\leq c \\leq N-2$），考虑你从洞穴 $c$ 出发的情形。对于这些情形中的每一个，请你计算**无论巨魔何时发动魔法，你都一定能到达某个出口的最小移动次数**。\n\n假设如果不发动魔法，从洞穴 $0$ 总能到达任意洞穴，且从任意洞穴总能到达洞穴 $N-1$。", "inputFormat": "第一行输入两个整数 $N$ 和 $M$，分别表示洞穴数量和水道数量。接下来 $M$ 行，每行两个整数 $a_i$ 和 $b_i$，表示当前有一条水道可从洞穴 $a_i$ 到洞穴 $b_i$。不会有自环，每对洞穴之间每个方向最多只会有一条水道。\n", "outputFormat": "输出一行 $N-1$ 个整数，第 $i$ 个整数（$0 \\leq i \\leq N-2$）表示从洞穴 $i$ 出发，在巨魔任意时机发动魔法的情况下，你**一定**能到达出口所需的最小移动次数。\n\n注意不需要输出洞穴 $N-1$ 的答案（因为你一开始就在出口，可以立刻离开）。", "hint": "### 样例说明\n\n对于第一个样例，考虑你从洞穴 $1$ 出发的情形。由于你无法预知方向反转会在何时发生，你应当一开始就朝着出口（洞穴 $4$）前进。你可以选择经由洞穴 $2$ 或洞穴 $3$。此处，经由洞穴 $3$ 是更优的选择，因为如果巨魔在你到达洞穴 $3$ 时发动魔法，你可以直接通过从洞穴 $3$ 到洞穴 $0$ 的通道离开洞穴系统。\n\n更具体地说，巨魔有三种可能的施法时机：\n\n* 如果巨魔在你还在洞穴 $1$ 时立刻发动魔法，你可以直接从洞穴 $1$ 前往洞穴 $0$ 并离开洞穴系统。\n* 如果巨魔在你从洞穴 $1$ 到达洞穴 $3$ 后发动魔法，你可以直接从洞穴 $3$ 前往洞穴 $0$ 并离开。\n* 如果巨魔在上述两种情况下都没有发动魔法，你将从洞穴 $3$ 前往洞穴 $4$ 并离开。\n\n在第一种情况下你只需要移动一次；在其余两种情况下你需要移动两次。因此，这一情形的答案为 $\\max(1, 2, 2) = 2$。\n\n注意，如果你选择从洞穴 $1$ 前往洞穴 $2$，巨魔可以迫使你需要三步才能离开。\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/76rqhhwi)\n\n第一个和第二个样例满足测试组 3、4、5 的约束。第三个样例满足所有测试组的约束。第四个样例满足测试组 3 和 5 的约束，见下图。\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/ue4hznea)\n\n### 约束与评分\n\n* $2 \\leq N \\leq 200\\,000$\n* $1 \\leq M \\leq 500\\,000$\n* $0 \\leq a_i, b_i \\leq N - 1$ 且 $a_i \\neq b_i$\n* 在反转前，洞穴 $0$ 能到达所有洞穴，且所有洞穴都能到达洞穴 $N-1$\n\n你的解答将在一组测试组上进行评测，每组包含若干测试用例。要获得该测试组的分数，你需要通过该测试组的所有测试用例。\n\n| 测试组 | 分值 | 限制条件 |\n| :-: | :-: | :-: |\n| 1 | 12 | $M = N - 1$，且 $a_i = i$，$b_i = i + 1$，即洞穴系统是一条链 $0 \\rightarrow 1 \\rightarrow 2 \\rightarrow \\ldots \\rightarrow N-1$ |\n| 2 | 15 | 对每个 $0 \\leq i \\leq N-2$，都存在一条从 $i$ 直达 $N-1$ 的通道（可能还有其它通道） |\n| 3 | 20 | $N, M \\leq 2000$ |\n| 4 | 29 | 每次离开某洞穴后，在反转发生前无法回到该洞穴（即所有通道构成有向无环图） |\n| 5 | 24 | 无额外限制 |\n\n翻译由 ChatGPT-4.1 完成。\n", "locale": "zh-CN"}}}
{"pid": "P13345", "type": "P", "difficulty": 6, "samples": [["4 6 7\n7 7 0 2 7 0\n7 3 0 7 2 1\n7 0 0 7 0 0\n7 7 7 7 7 1", "20"], ["2 1 1\n1\n0", "1"], ["2 2 7\n7 4\n7 0", "2"], ["2 2 1\n0 1\n1 0", "2"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "2025", "EGOI（欧洲/女生）"], "title": "[EGOI 2025] IMO", "background": "", "description": "The International Mathematics Olympiad (IMO) is a maths competition for high school students that is held every year. The 2025 edition of the IMO takes place at the same time as the EGOI. As you are reading this, both contest days of the IMO have ended and the grading is probably almost done as well. Unlike programming competitions like the EGOI, the grading is done by hand, which is a long and arduous process.\n\nThis year the IMO had $M$ problems (numbered from $0$ to $M - 1$), and each problem is worth a maximum of $K$ points. There were $N$ contestants taking part in the contest. The $i$th contestant received a score of $a_{i,j}$ on problem $j$, where $a_{i,j}$ is an integer between $0$ and $K$, inclusive. The ranking of the contestants is determined by the total score of each contestant, with ties broken by the contestants' indices. More formally, contestant $x$ ranks higher than contestant $y$ if:\n\n* either the total score of contestant $x$ is bigger than the total score of contestant $y$,\n* or their total scores are the same and $x < y$.\n\nIn order to release the final ranking, the organizers need to publish some of the values $a_{i,j}$. If a value is unpublished, it is only known that it is an integer between $0$ and $K$, inclusive.\n\nThe organizers want to reveal as few of the values $a_{i,j}$ as possible. At the same time, they need to make sure that everyone knows the correct final ranking. In other words, they must reveal a set of values such that the only ranking consistent with it is the correct one.\n\nFind the smallest $S$ such that it is possible to reveal $S$ of the values $a_{i,j}$ in a way that uniquely determines the full ranking of the contestants.", "inputFormat": "The first line contains three integers $N$, $M$, and $K$: the number of contestants, the number of problems, and the maximum score of the tasks, respectively.\n\nThen follow $N$ lines, where the $i$th line contains $a_{i,j}$. That is, the first of these contains $a_{0,0}, a_{0,1}, \\ldots, a_{0,M-1}$, the second contains $a_{1,0}, a_{1,1}, \\ldots, a_{1,M-1}$, and so on.\n", "outputFormat": "Print one integer $S$, the minimum number of scores that can be revealed so that the final ranking is uniquely determined.", "hint": "### Examples\n\nIn the first example, the 20 scores can be revealed in the following way:\n\n| 7 | 7 | 0 | $\\cdot$ | 7 | $\\cdot$ |\n| --- | --- | --- | --- | --- | --- |\n| 7 | 3 | 0 | 7 | 2 | 1 |\n| $\\cdot$ | 0 | 0 | $\\cdot$ | 0 | 0 |\n| 7 | 7 | 7 | 7 | 7 | 1 |\n\nHere, the third contestant is known to have a total score between 0 and 14, which is definitely lower than any other score. It can be shown that it is impossible to reveal fewer than 20 scores. For example, if we were to hide one of the zeroes of the third contestant, then this contestant could have a total score of up to 21. This is a problem because the second contestant has a total score of 20, but should be guaranteed to rank higher than the third contestant.\n\nThe first sample satisfies the constraints of test groups 5 and 6.\n\nIn the second example, we can either reveal only the first contestant's only score, or reveal only the second contestant's only score (but not both). If we reveal only the first contestant's score, then we know that the first contestant has a total score of 1. This means that even if the second contestant also has a score of 1, the first contestant will rank higher because their index is lower. Similarly, if we only reveal the score of the second contestant, we know that they have a score of zero, which means that the first contestant will rank higher regardless of their score.\n\nThe second sample satisfies the constraints of test groups 2, 3, 4, 5, and 6.\n\nThe third sample satisfies the constraints of test groups 2, 3, 5, and 6.\n\nThe fourth sample satisfies the constraints of all test groups.\n\n### Constraints and scoring\n\n* $2 \\leq N \\leq 20000$.\n* $1 \\leq M \\leq 100$.\n* $1 \\leq K \\leq 100$.\n* $0 \\leq a_{i, j} \\leq K$ for every pair $i, j$ where $0 \\leq i \\leq N - 1$ and $0 \\leq j \\leq M - 1$.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 10 | $N = M = 2$ and $K = 1$ |\n| 2 | 13 | $N = 2$ |\n| 3 | 10 | $N \\cdot M \\leq 16$ |\n| 4 | 18 | $K = 1$ |\n| 5 | 21 | $N \\leq 10000$ and $M, K \\leq 10$ |\n| 6 | 28 | No additional constraints |", "locale": "en", "translations": {"en": {"title": "[EGOI 2025] IMO", "background": "", "description": "The International Mathematics Olympiad (IMO) is a maths competition for high school students that is held every year. The 2025 edition of the IMO takes place at the same time as the EGOI. As you are reading this, both contest days of the IMO have ended and the grading is probably almost done as well. Unlike programming competitions like the EGOI, the grading is done by hand, which is a long and arduous process.\n\nThis year the IMO had $M$ problems (numbered from $0$ to $M - 1$), and each problem is worth a maximum of $K$ points. There were $N$ contestants taking part in the contest. The $i$th contestant received a score of $a_{i,j}$ on problem $j$, where $a_{i,j}$ is an integer between $0$ and $K$, inclusive. The ranking of the contestants is determined by the total score of each contestant, with ties broken by the contestants' indices. More formally, contestant $x$ ranks higher than contestant $y$ if:\n\n* either the total score of contestant $x$ is bigger than the total score of contestant $y$,\n* or their total scores are the same and $x < y$.\n\nIn order to release the final ranking, the organizers need to publish some of the values $a_{i,j}$. If a value is unpublished, it is only known that it is an integer between $0$ and $K$, inclusive.\n\nThe organizers want to reveal as few of the values $a_{i,j}$ as possible. At the same time, they need to make sure that everyone knows the correct final ranking. In other words, they must reveal a set of values such that the only ranking consistent with it is the correct one.\n\nFind the smallest $S$ such that it is possible to reveal $S$ of the values $a_{i,j}$ in a way that uniquely determines the full ranking of the contestants.", "inputFormat": "The first line contains three integers $N$, $M$, and $K$: the number of contestants, the number of problems, and the maximum score of the tasks, respectively.\n\nThen follow $N$ lines, where the $i$th line contains $a_{i,j}$. That is, the first of these contains $a_{0,0}, a_{0,1}, \\ldots, a_{0,M-1}$, the second contains $a_{1,0}, a_{1,1}, \\ldots, a_{1,M-1}$, and so on.\n", "outputFormat": "Print one integer $S$, the minimum number of scores that can be revealed so that the final ranking is uniquely determined.", "hint": "### Examples\n\nIn the first example, the 20 scores can be revealed in the following way:\n\n| 7 | 7 | 0 | $\\cdot$ | 7 | $\\cdot$ |\n| --- | --- | --- | --- | --- | --- |\n| 7 | 3 | 0 | 7 | 2 | 1 |\n| $\\cdot$ | 0 | 0 | $\\cdot$ | 0 | 0 |\n| 7 | 7 | 7 | 7 | 7 | 1 |\n\nHere, the third contestant is known to have a total score between 0 and 14, which is definitely lower than any other score. It can be shown that it is impossible to reveal fewer than 20 scores. For example, if we were to hide one of the zeroes of the third contestant, then this contestant could have a total score of up to 21. This is a problem because the second contestant has a total score of 20, but should be guaranteed to rank higher than the third contestant.\n\nThe first sample satisfies the constraints of test groups 5 and 6.\n\nIn the second example, we can either reveal only the first contestant's only score, or reveal only the second contestant's only score (but not both). If we reveal only the first contestant's score, then we know that the first contestant has a total score of 1. This means that even if the second contestant also has a score of 1, the first contestant will rank higher because their index is lower. Similarly, if we only reveal the score of the second contestant, we know that they have a score of zero, which means that the first contestant will rank higher regardless of their score.\n\nThe second sample satisfies the constraints of test groups 2, 3, 4, 5, and 6.\n\nThe third sample satisfies the constraints of test groups 2, 3, 5, and 6.\n\nThe fourth sample satisfies the constraints of all test groups.\n\n### Constraints and scoring\n\n* $2 \\leq N \\leq 20000$.\n* $1 \\leq M \\leq 100$.\n* $1 \\leq K \\leq 100$.\n* $0 \\leq a_{i, j} \\leq K$ for every pair $i, j$ where $0 \\leq i \\leq N - 1$ and $0 \\leq j \\leq M - 1$.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Score | Limits |\n| :-: | :-: | :-: |\n| 1 | 10 | $N = M = 2$ and $K = 1$ |\n| 2 | 13 | $N = 2$ |\n| 3 | 10 | $N \\cdot M \\leq 16$ |\n| 4 | 18 | $K = 1$ |\n| 5 | 21 | $N \\leq 10000$ and $M, K \\leq 10$ |\n| 6 | 28 | No additional constraints |", "locale": "en"}, "zh-CN": {"title": "[EGOI 2025] IMO", "background": "滥用本题评测资源将被封号。", "description": "国际数学奥林匹克（IMO）是一项面向高中生的数学竞赛，每年举办一次。2025 年的 IMO 正好与 EGOI 同时进行。当你读到这道题时，两天的 IMO 正赛已经结束，评分工作也大概接近尾声。与 EGOI 这样的程序设计竞赛不同，IMO 的评分完全依靠人工完成，这是一项漫长而繁琐的工作。\n\n今年的 IMO 包含 $M$ 道题目（编号为 $0$ 到 $M-1$），每道题的满分为 $K$ 分。有 $N$ 名选手参加比赛。第 $i$ 名选手在第 $j$ 道题上的得分为 $a_{i,j}$，其中 $a_{i,j}$ 是 $0$ 到 $K$ 之间的整数（包含 $0$ 和 $K$）。选手的排名由总分决定，若总分相同，则按选手编号（索引）从小到大排名。更正式地说，若满足以下条件之一，则选手 $x$ 的排名高于选手 $y$：\n\n* 选手 $x$ 的总分大于选手 $y$ 的总分，\n* 或者两人总分相同且 $x < y$。\n\n为了公布最终排名，主办方需要公开部分 $a_{i,j}$ 的值。若某个值未公开，则只知道它是 $0$ 到 $K$ 之间的某个整数。\n\n主办方希望尽量少地公开 $a_{i,j}$ 的值。同时，他们必须确保所有人都能唯一确定最终排名。换言之，主办方需要公开一组 $a_{i,j}$，使得与这些信息相符的排名只有唯一的正确排名。\n\n请你求出最小的 $S$，使得最多只需公开 $S$ 个 $a_{i,j}$，就能唯一确定所有选手的完整排名。", "inputFormat": "第一行包含三个整数 $N$、$M$ 和 $K$，分别表示选手数、题目数和每题的最高分。\n\n接下来 $N$ 行，每行 $M$ 个整数，第 $i$ 行为 $a_{i,0}, a_{i,1}, \\ldots, a_{i,M-1}$。\n", "outputFormat": "输出一个整数 $S$，表示唯一确定最终排名所需公开的最少分数个数。\n", "hint": "### 样例说明\n\n在第一个样例中，只需公开 20 个分数即可，方案如下：\n\n| 7 | 7 | 0 | $\\cdot$ | 7 | $\\cdot$ |\n| --- | --- | --- | --- | --- | --- |\n| 7 | 3 | 0 | 7 | 2 | 1 |\n| $\\cdot$ | 0 | 0 | $\\cdot$ | 0 | 0 |\n| 7 | 7 | 7 | 7 | 7 | 1 |\n\n此时，第三名选手的总分已知在 $0$ 到 $14$ 之间，肯定低于其他所有人。可以证明，不能再少公开一个分数。例如，如果隐藏第三名选手的某个 $0$，那么他的总分最高可达 $21$，这就可能导致第二名选手的总分 $20$ 无法保证排在第三名前面。\n\n第一个样例满足测试组 5 和 6 的约束。\n\n在第二个样例中，只需公开第一名选手的唯一分数，或者只公开第二名选手的唯一分数（不可都公开）。如果只公开第一名选手的分数，就能确定他总分为 $1$，即使第二名选手分数也是 $1$，第一名选手编号更小，排名更高。类似地，如果只公开第二名选手的分数，可知他总分为 $0$，无论第一名得多少分，第一名都排名更高。\n\n第二个样例满足测试组 2、3、4、5、6 的约束。\n\n第三个样例满足测试组 2、3、5、6 的约束。\n\n第四个样例满足所有测试组的约束。\n\n### 约束与评分\n\n* $2 \\leq N \\leq 20000$\n* $1 \\leq M \\leq 100$\n* $1 \\leq K \\leq 100$\n* $0 \\leq a_{i,j} \\leq K$，对所有 $0 \\leq i \\leq N-1$，$0 \\leq j \\leq M-1$\n\n你的解答将在一组测试组上进行评测，每组包含若干测试用例。要获得该测试组的分数，你需要通过该测试组的所有测试用例。\n\n| 测试组 | 分值 | 限制条件 |\n| :-: | :-: | :-: |\n| 1 | 10 | $N = M = 2$ 且 $K = 1$ |\n| 2 | 13 | $N = 2$ |\n| 3 | 10 | $N \\cdot M \\leq 16$ |\n| 4 | 18 | $K = 1$ |\n| 5 | 21 | $N \\leq 10000$ 且 $M, K \\leq 10$ |\n| 6 | 28 | 无额外限制 |\n\n翻译由 ChatGPT-4.1 完成。", "locale": "zh-CN"}}}
{"pid": "P13346", "type": "P", "difficulty": 7, "samples": [["1 7\n0 1\n1 2\n2 3\n0 4\n0 6\n1 5", "\n\n\n\n\n\n\n\n0110\n5\n3\n2\n6\n4\n0\n"], ["2 7\n0110\n1 5\n\n2 3\n\n1 2\n\n0 6\n\n0 4\n\n0 1", "\n\n\n\n5\n\n3\n\n2\n\n6\n\n4\n\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2025", "交互题", "Special Judge", "通信题", "EGOI（欧洲/女生）"], "title": "[EGOI 2025] Laser Strike", "background": "You must choose C++20 to submit the problem.", "description": "Ann and her friend Kathrin have recently discovered a new board game that has become their favourite: Laser Strike. In this game, the two players work together to remove $N$ pieces from the board. The game runs in two phases. The catch is that Kathrin will not have complete information about the game. In order to win the game, Ann and Kathrin have to work together, while communicating as little as possible.\n\nThere are $N$ unique pieces on the board, numbered from $0$ to $N-1$. Both players can see these pieces. There are also $N-1$ connections between pairs of pieces, such that it is possible to reach any piece from any other piece by following these connections. In other words, these connections form a tree. **Only Ann can see these connections; Kathrin does not know them.**\n\nIn the first phase of the game, Ann decides on an order $l_0, l_1, \\ldots, l_{N-2}$ in which pieces should be removed, until there is only one left. This order will be kept secret from Kathrin. If she can replicate it, they will win the game. The removal of pieces must satisfy the following rule: every time a piece is removed, it must be connected with exactly one remaining piece. In other words, the removed piece must be a leaf of the tree formed by the remaining pieces and itself. (After the $N-1$ pieces have been removed, the last piece is removed automatically and the players win.) Ann must choose an order that corresponds to the above rule.\n\nAnn will also write down a message to Kathrin, in the form of a binary string. Ann can choose how long this message is – but the shorter it is, the more points they get.\n\nAfter that, the second phase of the game starts. The goal of the game is for Kathrin to remove $N-1$ pieces from the board in the order $l_0, l_1, \\ldots, l_{N-2}$. She will make $N-1$ moves. Before move $i$, Ann tells Kathrin a pair of integers $a, b$ with the following properties:\n\n* $a < b$;\n* there is still a pair of directly connected pieces with numbers $a$ and $b$; and\n* either $a$ or $b$ is the correct piece $l_i$ that should be removed in this move.\n\nNote that for Ann the connection $(a, b)$ is uniquely determined by the leaf $l_i$ in the current tree.\n\nKathrin then removes either $a$ or $b$ from the board. If this was the correct piece – that is, $\\ell_i$ – they keep playing. Otherwise they lose the game.\n\nYour task is to implement both Ann's and Kathrin's strategies so that they win the game.\n\nYour program will be scored depending on the length of the message that Ann writes in the first phase of the game.\n\n### Implementation\n\nThis is a multi-run problem, meaning that your program will be executed twice. The first time it is run, it should implement Ann's strategy for the first phase of the game. After that, it should implement Kathrin's strategy for the second phase of the game.\n\nThe first line of the input contains two integers, $P$ and $N$, where $P$ is either 1 or 2 (first or second phase), and $N$ is the number of pieces.\n\nThe following input depends on the phase:\n\n**Phase 1: Ann**\n\nAfter the first line (described above) the next $N-1$ lines of the input describe the tree. Each line contains two numbers, $a$ and $b$ ($0 \\leq a < b \\leq N-1$), indicating a connection between pieces $a$ and $b$.\n\nYour program should begin by outputting a binary string with at most 1000 characters, each 0 or 1, the message written by Ann. Note that to generate a string of length 0, it should output an empty line.\n\nAfter this, it should output $N-1$ integers $\\ell_0, \\ell_1, \\ldots, \\ell_{N-2}$ on separate lines, indicating the order in which Ann wants to remove the leaves of the tree. The order must be such that if the pieces are removed one by one from the tree in this order, the removed piece must always be a leaf, i.e., the tree must always remain connected.\n\n**Phase 2: Kathrin**\n\nAfter the first line (described above), the next line of input contains the binary string (Ann's message) from Phase 1.\n\nAfter this, there will be $N-1$ rounds of interaction, one for each of Kathrin's moves.\n\nIn the $i$th move, your program should first read two numbers, $a$ and $b$ ($0 \\leq a < b \\leq N-1$). One of these pieces is the leaf $\\ell_i$ in Ann's order, and the other piece is the only remaining piece connected to $\\ell_i$. Then, your program should output $\\ell_i$, indicating that Kathrin removes this leaf. If your program does not print the correct leaf $\\ell_i$, the girls lose the game and your submission will be judged as Wrong Answer for this test case.\n\n### Details\n\nIf the sum of the running times of the two separate runs of your program exceeds the time limit, your submission will be judged as Time Limit Exceeded.\n\nMake sure to flush standard output after printing each line, or else your program might be judged as Time Limit Exceeded. In Python, this happens automatically as long as you use `input()` to read lines. In C++, `cout << endl;` flushes in addition to printing a newline; if using printf, use `fflush(stdout);`.\n\nNote that correctly reading an empty string can be tricky. The provided templates handle this case correctly.", "inputFormat": "See Implementation.", "outputFormat": "See Implementation.", "hint": "### Example\n\nNote that the sample in this section has $N=7$ for simplicity and is therefore not a valid test case. Your program is not expected to be able to solve this case. All test cases on the grader will have $N=1000$.\n\nIn the sample, Ann is given the following tree. In the first phase, Ann reads the tree, selects a binary string \"0110\" to send to Kathrin, and also selects an order $[\\ell_0, \\ell_1, \\ldots, \\ell_{N-2}] = [5, 3, 2, 6, 4, 0]$ in which the pieces should be removed from the tree. In the second phase, Kathrin receives the string \"0110\" that was sent in the first phase. She then receives the pair $(1,5)$ and decides to remove vertex 5, which is indeed the leaf. For the next move, she receives the pair $(2,3)$ and removes the leaf 3, and so on. The following pictures depict the interactions:\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/r5zy0gd2)\n\n### Testing Tool\n\nTo facilitate the testing of your solution, we have provided a simple tool that you can download. See “attachments” at the bottom of the Kattis problem page. The tool is optional to use. Note that the official grader program on Kattis is different from the testing tool.\n\nTo use the tool, create an input file, such as “sample1.in”, which should start with a number $N$ followed by $N-1$ lines describing the tree, in the same format as in Phase 1. For example, for the sample below:\n\n```\n7\n0 1\n1 2\n2 3\n0 4\n0 6\n1 5\n```\n\nFor Python programs, say solution.py (normally run as `pypy3 solution.py`), run:\n\n```\npython3 testing_tool.py pypy3 solution.py < sample1.in\n```\n\nFor C++ programs, first compile it (e.g. with `g++ -g -O2 -std=gnu++23 -static solution.cpp -o solution.out`) and then run:\n\n```\npython3 testing_tool.py ./solution.out < sample1.in\n```\n\n### Constraints and Scoring\n\n* $N = 1000$.\n* $0 \\leq a < b \\leq N - 1$ for all connections.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Max score | Constraints |\n| :-: | :-: | :-: |\n| 1 | 8 | The tree is a star. That is, all nodes except one are leaves. |\n| 2 | 9 | The tree is a line. That is, all nodes except for two leaf nodes have exactly two adjacent nodes. |\n| 3 | 21 | The tree is a star with lines going out from it. That is, all nodes have either one or two adjacent nodes, except for one that has more than two adjacent nodes. |\n| 4 | 36 | The distance between any two nodes is at most 10. |\n| 5 | 26 | No additional constraints. |\n\nFor every test group that your program solves correctly, you will receive a score based on the following formula:\n\n$$\\text{score} = S_g \\cdot (1 - 0.3 \\cdot \\log_{10} \\max(K, 1))$$\n\nwhere $S_g$ is the maximum score for the test group, and $K$ is the maximum length of Ann's message needed for any test case in the test group. Your score for each test group will be rounded to the nearest integer.\n\nThe table below shows the number of points, for a few values of $K$, that your program will get if it solves all test groups with that $K$. In particular, to achieve a score of 100 points, your solution must solve every test case with $K \\leq 1$.\n\n| K | 1 | 5 | 10 | 50 | 100 | 500 | 1000 |\n| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |\n| Score | 100 | 79 | 70 | 49 | 39 | 20 | 11 |\n", "locale": "en", "translations": {"en": {"title": "[EGOI 2025] Laser Strike", "background": "You must choose C++20 to submit the problem.", "description": "Ann and her friend Kathrin have recently discovered a new board game that has become their favourite: Laser Strike. In this game, the two players work together to remove $N$ pieces from the board. The game runs in two phases. The catch is that Kathrin will not have complete information about the game. In order to win the game, Ann and Kathrin have to work together, while communicating as little as possible.\n\nThere are $N$ unique pieces on the board, numbered from $0$ to $N-1$. Both players can see these pieces. There are also $N-1$ connections between pairs of pieces, such that it is possible to reach any piece from any other piece by following these connections. In other words, these connections form a tree. **Only Ann can see these connections; Kathrin does not know them.**\n\nIn the first phase of the game, Ann decides on an order $l_0, l_1, \\ldots, l_{N-2}$ in which pieces should be removed, until there is only one left. This order will be kept secret from Kathrin. If she can replicate it, they will win the game. The removal of pieces must satisfy the following rule: every time a piece is removed, it must be connected with exactly one remaining piece. In other words, the removed piece must be a leaf of the tree formed by the remaining pieces and itself. (After the $N-1$ pieces have been removed, the last piece is removed automatically and the players win.) Ann must choose an order that corresponds to the above rule.\n\nAnn will also write down a message to Kathrin, in the form of a binary string. Ann can choose how long this message is – but the shorter it is, the more points they get.\n\nAfter that, the second phase of the game starts. The goal of the game is for Kathrin to remove $N-1$ pieces from the board in the order $l_0, l_1, \\ldots, l_{N-2}$. She will make $N-1$ moves. Before move $i$, Ann tells Kathrin a pair of integers $a, b$ with the following properties:\n\n* $a < b$;\n* there is still a pair of directly connected pieces with numbers $a$ and $b$; and\n* either $a$ or $b$ is the correct piece $l_i$ that should be removed in this move.\n\nNote that for Ann the connection $(a, b)$ is uniquely determined by the leaf $l_i$ in the current tree.\n\nKathrin then removes either $a$ or $b$ from the board. If this was the correct piece – that is, $\\ell_i$ – they keep playing. Otherwise they lose the game.\n\nYour task is to implement both Ann's and Kathrin's strategies so that they win the game.\n\nYour program will be scored depending on the length of the message that Ann writes in the first phase of the game.\n\n### Implementation\n\nThis is a multi-run problem, meaning that your program will be executed twice. The first time it is run, it should implement Ann's strategy for the first phase of the game. After that, it should implement Kathrin's strategy for the second phase of the game.\n\nThe first line of the input contains two integers, $P$ and $N$, where $P$ is either 1 or 2 (first or second phase), and $N$ is the number of pieces.\n\nThe following input depends on the phase:\n\n**Phase 1: Ann**\n\nAfter the first line (described above) the next $N-1$ lines of the input describe the tree. Each line contains two numbers, $a$ and $b$ ($0 \\leq a < b \\leq N-1$), indicating a connection between pieces $a$ and $b$.\n\nYour program should begin by outputting a binary string with at most 1000 characters, each 0 or 1, the message written by Ann. Note that to generate a string of length 0, it should output an empty line.\n\nAfter this, it should output $N-1$ integers $\\ell_0, \\ell_1, \\ldots, \\ell_{N-2}$ on separate lines, indicating the order in which Ann wants to remove the leaves of the tree. The order must be such that if the pieces are removed one by one from the tree in this order, the removed piece must always be a leaf, i.e., the tree must always remain connected.\n\n**Phase 2: Kathrin**\n\nAfter the first line (described above), the next line of input contains the binary string (Ann's message) from Phase 1.\n\nAfter this, there will be $N-1$ rounds of interaction, one for each of Kathrin's moves.\n\nIn the $i$th move, your program should first read two numbers, $a$ and $b$ ($0 \\leq a < b \\leq N-1$). One of these pieces is the leaf $\\ell_i$ in Ann's order, and the other piece is the only remaining piece connected to $\\ell_i$. Then, your program should output $\\ell_i$, indicating that Kathrin removes this leaf. If your program does not print the correct leaf $\\ell_i$, the girls lose the game and your submission will be judged as Wrong Answer for this test case.\n\n### Details\n\nIf the sum of the running times of the two separate runs of your program exceeds the time limit, your submission will be judged as Time Limit Exceeded.\n\nMake sure to flush standard output after printing each line, or else your program might be judged as Time Limit Exceeded. In Python, this happens automatically as long as you use `input()` to read lines. In C++, `cout << endl;` flushes in addition to printing a newline; if using printf, use `fflush(stdout);`.\n\nNote that correctly reading an empty string can be tricky. The provided templates handle this case correctly.", "inputFormat": "See Implementation.", "outputFormat": "See Implementation.", "hint": "### Example\n\nNote that the sample in this section has $N=7$ for simplicity and is therefore not a valid test case. Your program is not expected to be able to solve this case. All test cases on the grader will have $N=1000$.\n\nIn the sample, Ann is given the following tree. In the first phase, Ann reads the tree, selects a binary string \"0110\" to send to Kathrin, and also selects an order $[\\ell_0, \\ell_1, \\ldots, \\ell_{N-2}] = [5, 3, 2, 6, 4, 0]$ in which the pieces should be removed from the tree. In the second phase, Kathrin receives the string \"0110\" that was sent in the first phase. She then receives the pair $(1,5)$ and decides to remove vertex 5, which is indeed the leaf. For the next move, she receives the pair $(2,3)$ and removes the leaf 3, and so on. The following pictures depict the interactions:\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/r5zy0gd2)\n\n### Testing Tool\n\nTo facilitate the testing of your solution, we have provided a simple tool that you can download. See “attachments” at the bottom of the Kattis problem page. The tool is optional to use. Note that the official grader program on Kattis is different from the testing tool.\n\nTo use the tool, create an input file, such as “sample1.in”, which should start with a number $N$ followed by $N-1$ lines describing the tree, in the same format as in Phase 1. For example, for the sample below:\n\n```\n7\n0 1\n1 2\n2 3\n0 4\n0 6\n1 5\n```\n\nFor Python programs, say solution.py (normally run as `pypy3 solution.py`), run:\n\n```\npython3 testing_tool.py pypy3 solution.py < sample1.in\n```\n\nFor C++ programs, first compile it (e.g. with `g++ -g -O2 -std=gnu++23 -static solution.cpp -o solution.out`) and then run:\n\n```\npython3 testing_tool.py ./solution.out < sample1.in\n```\n\n### Constraints and Scoring\n\n* $N = 1000$.\n* $0 \\leq a < b \\leq N - 1$ for all connections.\n\nYour solution will be tested on a set of test groups, each worth a number of points. Each test group contains a set of test cases. To get the points for a test group, you need to solve all test cases in the test group.\n\n| Group | Max score | Constraints |\n| :-: | :-: | :-: |\n| 1 | 8 | The tree is a star. That is, all nodes except one are leaves. |\n| 2 | 9 | The tree is a line. That is, all nodes except for two leaf nodes have exactly two adjacent nodes. |\n| 3 | 21 | The tree is a star with lines going out from it. That is, all nodes have either one or two adjacent nodes, except for one that has more than two adjacent nodes. |\n| 4 | 36 | The distance between any two nodes is at most 10. |\n| 5 | 26 | No additional constraints. |\n\nFor every test group that your program solves correctly, you will receive a score based on the following formula:\n\n$$\\text{score} = S_g \\cdot (1 - 0.3 \\cdot \\log_{10} \\max(K, 1))$$\n\nwhere $S_g$ is the maximum score for the test group, and $K$ is the maximum length of Ann's message needed for any test case in the test group. Your score for each test group will be rounded to the nearest integer.\n\nThe table below shows the number of points, for a few values of $K$, that your program will get if it solves all test groups with that $K$. In particular, to achieve a score of 100 points, your solution must solve every test case with $K \\leq 1$.\n\n| K | 1 | 5 | 10 | 50 | 100 | 500 | 1000 |\n| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |\n| Score | 100 | 79 | 70 | 49 | 39 | 20 | 11 |\n", "locale": "en"}, "zh-CN": {"title": "[EGOI 2025] Laser Strike / 激光突击", "background": "请选择 C++20 提交。", "description": "Ann 和她的朋友 Kathrin 最近发现了一款新桌游，这款游戏成了她们的最爱：Laser Strike。在这款游戏中，两位玩家需要协作将棋盘上的 $N$ 个棋子全部移除。游戏分为两个阶段。关键在于，Kathrin 并不了解全部信息。为了赢得游戏，Ann 和 Kathrin 必须协作，并且尽量减少交流。\n\n棋盘上有 $N$ 个独特的棋子，编号为 $0$ 到 $N-1$。两位玩家都可以看到这些棋子。此外，棋盘上有 $N-1$ 条连接，每条连接连接一对棋子，使得任意两个棋子之间都可以通过若干条连接到达。换句话说，这些连接构成了一棵树。**只有 Ann 能看到这些连接；Kathrin 并不知道它们。**\n\n在游戏的第一阶段，Ann 决定一个移除棋子的顺序 $l_0, l_1, \\ldots, l_{N-2}$，直到只剩下最后一个棋子。这个顺序对 Kathrin 保密。如果 Kathrin 能复现这个顺序，两人就能赢得游戏。每次移除棋子时，需满足如下规则：每次被移除的棋子，必须与仅剩的一个棋子直接连接。换句话说，每次被移除的棋子都必须是当前剩余树中的一个叶子节点。（当 $N-1$ 个棋子都被移除后，最后一个棋子自动被移除，游戏胜利。）Ann 必须选择一个满足上述规则的移除顺序。\n\nAnn 还会写下一条信息给 Kathrin，形式为一个二进制字符串。Ann 可以自选信息长度——信息越短，得分越高。\n\n之后，游戏进入第二阶段。目标是让 Kathrin 按顺序 $l_0, l_1, \\ldots, l_{N-2}$ 移除 $N-1$ 个棋子。她会进行 $N-1$ 步操作。在第 $i$ 步操作前，Ann 会告诉 Kathrin 一对整数 $a, b$，满足：\n\n* $a < b$；\n* 这两个棋子 $a$ 和 $b$ 之间在当前剩余棋子中有直接连接；\n* $a$ 或 $b$ 中有一个就是本轮应被移除的棋子 $l_i$。\n\n注意，对于 Ann 来说，当前树中每个叶子 $l_i$ 都能唯一确定一个连接 $(a, b)$。\n\n然后，Kathrin 会选择移除 $a$ 或 $b$ 中的一个棋子。如果她移除的是正确的叶子 $l_i$，游戏继续；否则游戏失败。\n\n你的任务是同时实现 Ann 和 Kathrin 的策略，使她们能够赢得游戏。\n\n你的程序得分取决于 Ann 在第一阶段写下的信息长度。\n\n### 实现细节\n\n**这是一道通信题。**\n\n本题为多轮运行题目，你的程序会被执行两次。第一次运行时，实现 Ann 的策略（第一阶段）；第二次运行时，实现 Kathrin 的策略（第二阶段）。\n\n输入的第一行包含两个整数 $P$ 和 $N$，其中 $P$ 为 1 或 2（分别表示第一或第二阶段），$N$ 为棋子数量。\n\n后续输入内容取决于阶段：\n\n**阶段 1：Ann**\n\n第一行后，接下来 $N-1$ 行描述树的结构。每行两个整数 $a$ 和 $b$（$0 \\leq a < b \\leq N-1$），表示棋子 $a$ 和 $b$ 之间有一条连接。\n\n你的程序应首先输出一个二进制字符串（长度不超过 1000），即 Ann 写给 Kathrin 的信息。若信息长度为 0，输出空行。\n\n然后输出 $N-1$ 个整数 $\\ell_0, \\ell_1, \\ldots, \\ell_{N-2}$，每行一个，表示 Ann 希望的叶子移除顺序。该顺序必须满足每次移除的都是当前树的叶子。\n\n**阶段 2：Kathrin**\n\n第一行后，下一行输入为 Ann 的二进制信息。\n\n接下来有 $N-1$ 轮交互，每轮代表 Kathrin 的一次操作。\n\n在第 $i$ 轮，你的程序应首先读入两个整数 $a$ 和 $b$（$0 \\leq a < b \\leq N-1$）。其中一个是当前应移除的叶子 $\\ell_i$，另一个是唯一与其直接连接的剩余棋子。然后，你的程序应输出 $\\ell_i$，即 Kathrin 选择移除该叶子。如果输出不是正确的叶子，游戏失败，本测试点判为 Wrong Answer。\n\n### 细节说明\n\n两次运行的总时间不得超过时限，否则会被判为 TLE。\n\n每次输出后请及时刷新标准输出，否则可能被判为 TLE。Python 用 `input()` 读入时自动刷新；C++ 可用 `cout << endl;` 或 `fflush(stdout);`。\n\n注意，正确读取空字符串可能有点棘手。官方模板已正确处理此情况。", "inputFormat": "见实现细节。", "outputFormat": "见实现细节。", "hint": "### 样例说明\n\n注意，以下样例 $N=7$，仅为说明方便，并非正式测试用例。正式评测所有用例均有 $N=1000$。\n\n在样例中，Ann 得到如下树结构。在第一阶段，Ann 读入树，选择二进制串 \"0110\" 发送给 Kathrin，并选择移除顺序 $[\\ell_0, \\ell_1, \\ldots, \\ell_{N-2}] = [5, 3, 2, 6, 4, 0]$。第二阶段，Kathrin 收到 Ann 的二进制串 \"0110\"，随后收到对 $(1,5)$ 并选择移除 5，接着收到对 $(2,3)$ 并移除 3，依此类推。下图展示了交互过程：\n\n![](https://www.luogu.com.cn/fe/api/problem/downloadAttachment/r5zy0gd2)\n\n### 测试工具\n\n为方便测试，官方提供了一个简单的工具。见 Kattis 题目页面底部的“attachments”。该工具可选，正式评测器与该工具不同。\n\n用法：准备一个输入文件（如 \"sample1.in\"），文件第一行为 $N$，接下来 $N-1$ 行描述树结构，格式同阶段 1。例如：\n\n```\n7\n0 1\n1 2\n2 3\n0 4\n0 6\n1 5\n```\n\n对于 Python 程序（如 solution.py，通常用 `pypy3 solution.py` 运行），可用如下命令：\n\n```\npython3 testing_tool.py pypy3 solution.py < sample1.in\n```\n\nC++ 程序编译后（如 `g++ -g -O2 -std=gnu++23 -static solution.cpp -o solution.out`），可用如下命令：\n\n```\npython3 testing_tool.py ./solution.out < sample1.in\n```\n\n### 约束与评分\n\n* $N = 1000$\n* 对所有连接，$0 \\leq a < b \\leq N-1$\n\n你的解答将在一组测试组上进行评测，每组包含若干测试用例。要获得该测试组分数，你需要通过该组所有测试用例。\n\n| 组别 | 满分 | 限制 |\n| :-: | :-: | :-: |\n| 1 | 8 | 树为星形，即除一个节点外其余全为叶子 |\n| 2 | 9 | 树为链形，即除两个叶子外其余每个节点度数为 2 |\n| 3 | 21 | 树为“星形加链”，即所有节点度为 1 或 2，只有一个节点度大于 2 |\n| 4 | 36 | 任意两点间距离不超过 10 |\n| 5 | 26 | 无额外限制 |\n\n对于每个通过的测试组，你的得分按下式计算：\n\n$$\\text{score} = S_g \\cdot (1 - 0.3 \\cdot \\log_{10} \\max(K, 1))$$\n\n其中 $S_g$ 为该测试组满分，$K$ 为该组任一测试用例中 Ann 的消息最大长度。每组得分四舍五入取整。\n\n下表给出若干 $K$ 时的总分示例，若所有测试组都通过且 $K$ 如下：\n\n| $K$ | 1 | 5 | 10 | 50 | 100 | 500 | 1000 |\n| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |\n| 得分 | 100 | 79 | 70 | 49 | 39 | 20 | 11 |\n\n翻译由 ChatGPT-4.1 完成。", "locale": "zh-CN"}}}
{"pid": "P13347", "type": "P", "difficulty": 2, "samples": [["2 1 16 1\n0 2\n2 3", "7.33333"], ["1 15 16 1\n0 8", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化"], "title": "「ZYZ 2025」地铁", "background": "一天，小 Q 和小 S 在地铁上偶然相遇。他们只顾着互相打招呼，差点坐反！幸运的是，最终他们坐上了正确的地铁，小 S 不禁回想，如果我们坐反了会怎么样？一定会晚若干分钟到家吧。", "description": "此时小 Q 又要坐公交车了，在第 $0$ 时刻，小 Q 位于一条数轴上 $S$ 的位置，他要前往位置 $E$，保证 $0\\le S\\le E$。\n\n数轴上有 $n$ 辆公交车，其中的第 $i$ 辆公交车有两个属性 $t_i,v_i$，代表这辆公交车将会在 $t_i$ 时刻出现在**坐标原点**，并以 $v_i$ 的速度向右匀速行驶。若小 Q 与某一辆公交车同一时刻处于同一位置，无论他是否已经在一辆公交车上，他都可以瞬间转移到这辆公交车上。\n\n当然，如果小 Q 不想乘坐公交车，他也能以不超过 $v_0$ 的速度匀速向**任意方向**行走或站在原地等待。\n\n请你求出，小 Q 最早能在哪一时刻到达位置 $E$？", "inputFormat": "第一行输入四个整数 $n,S,E,v_0$，分别表示公交车总数，起点位置，终点位置和小 Q 的步行速度。\n\n接下来 $n$ 行，每行两个整数 $t_i,v_i$，意义如题目描述所示。", "outputFormat": "输出一行一个非负实数，表示小 Q 最早能在哪一时刻到达数轴上的 $E$ 位置。\n\n只要你的答案和正确答案相差不超过 $10^{-3}$，你的答案就会被认为是正确的。", "hint": "**【样例解释 #1】**\n\n以下是小 Q 的一种可能乘车方案：\n\n* 小 Q 先向左走在 $\\dfrac13$ 时刻于位置 $\\dfrac23$ 与第 $1$ 辆公交车相遇并乘车；\n* 小 Q 乘第一辆公交车在 $6$ 时刻于位置 $12$ 与第 $2$ 辆公交车相遇并换乘\n* 小 Q 乘第二辆公交车于 $\\dfrac{22}{3}$ 时刻到达终点。\n\n$7.3334,7.3333$ 等均为合法的答案。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|特殊性质|分值|\n|:-:|:-:|:-:|\n|$0$|$n=1$|$10$|\n|$1$|$n\\le 100$|$30$|\n|$2$|$v_0=0$|$20$|\n|$3$|无|$40$|\n\n对于 $100\\%$ 的测试数据，保证：$1\\le n\\le 2\\times10^5$，$0\\le S,E,v_0,t_i\\le10^9$，$1\\le v_i\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ZYZ 2025」地铁", "background": "一天，小 Q 和小 S 在地铁上偶然相遇。他们只顾着互相打招呼，差点坐反！幸运的是，最终他们坐上了正确的地铁，小 S 不禁回想，如果我们坐反了会怎么样？一定会晚若干分钟到家吧。", "description": "此时小 Q 又要坐公交车了，在第 $0$ 时刻，小 Q 位于一条数轴上 $S$ 的位置，他要前往位置 $E$，保证 $0\\le S\\le E$。\n\n数轴上有 $n$ 辆公交车，其中的第 $i$ 辆公交车有两个属性 $t_i,v_i$，代表这辆公交车将会在 $t_i$ 时刻出现在**坐标原点**，并以 $v_i$ 的速度向右匀速行驶。若小 Q 与某一辆公交车同一时刻处于同一位置，无论他是否已经在一辆公交车上，他都可以瞬间转移到这辆公交车上。\n\n当然，如果小 Q 不想乘坐公交车，他也能以不超过 $v_0$ 的速度匀速向**任意方向**行走或站在原地等待。\n\n请你求出，小 Q 最早能在哪一时刻到达位置 $E$？", "inputFormat": "第一行输入四个整数 $n,S,E,v_0$，分别表示公交车总数，起点位置，终点位置和小 Q 的步行速度。\n\n接下来 $n$ 行，每行两个整数 $t_i,v_i$，意义如题目描述所示。", "outputFormat": "输出一行一个非负实数，表示小 Q 最早能在哪一时刻到达数轴上的 $E$ 位置。\n\n只要你的答案和正确答案相差不超过 $10^{-3}$，你的答案就会被认为是正确的。", "hint": "**【样例解释 #1】**\n\n以下是小 Q 的一种可能乘车方案：\n\n* 小 Q 先向左走在 $\\dfrac13$ 时刻于位置 $\\dfrac23$ 与第 $1$ 辆公交车相遇并乘车；\n* 小 Q 乘第一辆公交车在 $6$ 时刻于位置 $12$ 与第 $2$ 辆公交车相遇并换乘\n* 小 Q 乘第二辆公交车于 $\\dfrac{22}{3}$ 时刻到达终点。\n\n$7.3334,7.3333$ 等均为合法的答案。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|特殊性质|分值|\n|:-:|:-:|:-:|\n|$0$|$n=1$|$10$|\n|$1$|$n\\le 100$|$30$|\n|$2$|$v_0=0$|$20$|\n|$3$|无|$40$|\n\n对于 $100\\%$ 的测试数据，保证：$1\\le n\\le 2\\times10^5$，$0\\le S,E,v_0,t_i\\le10^9$，$1\\le v_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P13348", "type": "P", "difficulty": 4, "samples": [["2", "2\n1 1\n2 2"], ["3", "9\n1 1\n2 2\n3 1\n2 0\n1 1\n0 2\n1 3\n2 2\n3 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化", "欧拉回路", "构造"], "title": "「ZYZ 2025」未选择的路", "background": "> 黄色的树林里分出两条路 / 可惜我不能同时去涉足  \n> 我在那路口久久伫立 / 我向着一条路极目望去 / 直到它消失在丛林深处\n>\n> 但我却选了另外一条路 / 它荒草萋萋，十分幽寂 / 显得更诱人，更美丽  \n> 虽然在这条小路上 / 很少留下旅人的足迹\n>\n> 那天清晨落叶满地 / 两条路都未经脚印污染 / 啊，留下一条路等改日再见  \n> 但我知道路径延绵无尽头 / 恐怕我难以再回返\n>\n> 也许多少年后在某个地方 / 我将轻声叹息将往事回顾  \n> 一片树林里分出两条路 / 而我选择了人迹更少的一条 / 从此决定了我一生的道路\n>\n> ——义务教育教科书语文人教版七年级下册《未选择的路》", "description": "在平面直角坐标系中，有一个 $n\\times n$ 的网格，其最左下角的点坐标为 $(0,0)$，最右上角的点坐标为 $(n,n)$。有一个人最初站在 $(0,0)$ 的位置，要到达 $(n,n)$。他每一次移动可以沿某个方格的对角线移动，并称他**经过**了这个方格。\n\n请你求出，在仅经过每个方格**至多**一次的情况下，他最多能经过多少方格，并给出一种可行的方案。\n\n你可以参照样例解释中的图片理解题意。", "inputFormat": "输入的第一行包含一个正整数 $n$。", "outputFormat": "**本题采用 Special Judge，你只需要输出任意一种符合条件的方案。**\n\n第一行输出一个整数 $k$，表示他最多能经过的方格数。\n\n接下来 $k$ 行，其中的第 $i$ 行输出两个整数 $x_i,y_i$，代表第 $i$ 次移动后这个人所在位置的坐标。", "hint": "**【样例解释 #2】**\n\n下图是输出所对应的方案，在可能会造成歧义的地方会走颜色相同的两条线段。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o0ze8nab.png)\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|特殊性质|分值|\n|:-:|:-:|:-:|\n|$0$|$n\\le6$|$30$|\n|$1$|$n$ 为奇数|$25$|\n|$2$|$n$ 为偶数|$25$|\n|$3$|无|$20$|\n\n对于所有的测试数据，保证：$1\\le n\\le10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ZYZ 2025」未选择的路", "background": "> 黄色的树林里分出两条路 / 可惜我不能同时去涉足  \n> 我在那路口久久伫立 / 我向着一条路极目望去 / 直到它消失在丛林深处\n>\n> 但我却选了另外一条路 / 它荒草萋萋，十分幽寂 / 显得更诱人，更美丽  \n> 虽然在这条小路上 / 很少留下旅人的足迹\n>\n> 那天清晨落叶满地 / 两条路都未经脚印污染 / 啊，留下一条路等改日再见  \n> 但我知道路径延绵无尽头 / 恐怕我难以再回返\n>\n> 也许多少年后在某个地方 / 我将轻声叹息将往事回顾  \n> 一片树林里分出两条路 / 而我选择了人迹更少的一条 / 从此决定了我一生的道路\n>\n> ——义务教育教科书语文人教版七年级下册《未选择的路》", "description": "在平面直角坐标系中，有一个 $n\\times n$ 的网格，其最左下角的点坐标为 $(0,0)$，最右上角的点坐标为 $(n,n)$。有一个人最初站在 $(0,0)$ 的位置，要到达 $(n,n)$。他每一次移动可以沿某个方格的对角线移动，并称他**经过**了这个方格。\n\n请你求出，在仅经过每个方格**至多**一次的情况下，他最多能经过多少方格，并给出一种可行的方案。\n\n你可以参照样例解释中的图片理解题意。", "inputFormat": "输入的第一行包含一个正整数 $n$。", "outputFormat": "**本题采用 Special Judge，你只需要输出任意一种符合条件的方案。**\n\n第一行输出一个整数 $k$，表示他最多能经过的方格数。\n\n接下来 $k$ 行，其中的第 $i$ 行输出两个整数 $x_i,y_i$，代表第 $i$ 次移动后这个人所在位置的坐标。", "hint": "**【样例解释 #2】**\n\n下图是输出所对应的方案，在可能会造成歧义的地方会走颜色相同的两条线段。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o0ze8nab.png)\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|特殊性质|分值|\n|:-:|:-:|:-:|\n|$0$|$n\\le6$|$30$|\n|$1$|$n$ 为奇数|$25$|\n|$2$|$n$ 为偶数|$25$|\n|$3$|无|$20$|\n\n对于所有的测试数据，保证：$1\\le n\\le10^3$。", "locale": "zh-CN"}}}
{"pid": "P13349", "type": "P", "difficulty": 5, "samples": [["4 3\n1 10 2 5\n10 10 1\n3 0\n900 910 1\n4 2\n0 1000 2\n2 1\n1 5", "4\n223516\n48906"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "背包 DP", "前缀和", "容斥原理"], "title": "「ZYZ 2025」自然数序列", "background": "", "description": "给定长度为 $n$ 的**正整数**序列 $a$，有 $q$ 次询问。对于每次询问，给出 $l,r,k$ 和 $k$ 个限制条件，求有多少个长度为 $n$ 的**自然数**序列 $b$ 满足 $l\\le\\sum\\limits_{i=1}^na_ib_i\\le r$ 且满足这 $k$ 个限制条件，对 $998244353$ 取模。\n\n对于每个限制条件，给出 $x,y$，要求 $b_x=y$。\n\n我们称两个长度为 $n$ 的序列 $b,b'$ 是不同的，当且仅当存在不超过 $n$ 的正整数 $i$ 满足 $b_i\\not=b_i'$。", "inputFormat": "输入的第一行包含两个正整数 $n,q$。\n\n第二行包含 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$。\n\n接下来有 $q$ 次询问，对于每一次询问：\n\n第一行包含三个非负整数 $l,r,k$。\n\n接下来 $k$ 行，每行两个非负整数 $x,y$，代表一条限制条件。", "outputFormat": "对于每一次询问，输出一行一个整数，表示对应的答案。", "hint": "**【样例解释】**\n\n对于第一次询问，有以下 $4$ 个序列 $b$ 符合条件：$\\{0,0,0,2\\},\\{0,1,0,0\\},\\{5,0,0,1\\},\\{10,0,0,0\\}$。\n\n序列 $\\{3,0,1,1\\}$ 不符合条件，因为不满足限制 $b_3=0$；序列 $\\{1,1,1,1\\}$ 不符合条件，因为不满足 $\\sum\\limits_{i=1}^na_ib_i=10$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|特殊性质|分值|\n|:-:|:-:|:-:|\n|$0$|$n,l,r,q\\le8$|$10$|\n|$1$|$n,l,r,q\\le100$|$15$|\n|$2$|$k=1$ 且 $l=r$|$25$|\n|$3$|$l=r$|$25$|\n|$4$|无|$25$|\n\n对于所有的测试数据，保证：$0\\le l,r,y\\le5\\times10^3$，$1\\le n,a_i\\le 5\\times10^3$，$1\\le q\\le 5\\times 10^4$，$0\\le k\\le8$，$1\\le x\\le n$。对于一次询问，保证每一条限制的 $x$ 互不相同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ZYZ 2025」自然数序列", "background": "", "description": "给定长度为 $n$ 的**正整数**序列 $a$，有 $q$ 次询问。对于每次询问，给出 $l,r,k$ 和 $k$ 个限制条件，求有多少个长度为 $n$ 的**自然数**序列 $b$ 满足 $l\\le\\sum\\limits_{i=1}^na_ib_i\\le r$ 且满足这 $k$ 个限制条件，对 $998244353$ 取模。\n\n对于每个限制条件，给出 $x,y$，要求 $b_x=y$。\n\n我们称两个长度为 $n$ 的序列 $b,b'$ 是不同的，当且仅当存在不超过 $n$ 的正整数 $i$ 满足 $b_i\\not=b_i'$。", "inputFormat": "输入的第一行包含两个正整数 $n,q$。\n\n第二行包含 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$。\n\n接下来有 $q$ 次询问，对于每一次询问：\n\n第一行包含三个非负整数 $l,r,k$。\n\n接下来 $k$ 行，每行两个非负整数 $x,y$，代表一条限制条件。", "outputFormat": "对于每一次询问，输出一行一个整数，表示对应的答案。", "hint": "**【样例解释】**\n\n对于第一次询问，有以下 $4$ 个序列 $b$ 符合条件：$\\{0,0,0,2\\},\\{0,1,0,0\\},\\{5,0,0,1\\},\\{10,0,0,0\\}$。\n\n序列 $\\{3,0,1,1\\}$ 不符合条件，因为不满足限制 $b_3=0$；序列 $\\{1,1,1,1\\}$ 不符合条件，因为不满足 $\\sum\\limits_{i=1}^na_ib_i=10$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|特殊性质|分值|\n|:-:|:-:|:-:|\n|$0$|$n,l,r,q\\le8$|$10$|\n|$1$|$n,l,r,q\\le100$|$15$|\n|$2$|$k=1$ 且 $l=r$|$25$|\n|$3$|$l=r$|$25$|\n|$4$|无|$25$|\n\n对于所有的测试数据，保证：$0\\le l,r,y\\le5\\times10^3$，$1\\le n,a_i\\le 5\\times10^3$，$1\\le q\\le 5\\times 10^4$，$0\\le k\\le8$，$1\\le x\\le n$。对于一次询问，保证每一条限制的 $x$ 互不相同。", "locale": "zh-CN"}}}
{"pid": "P13350", "type": "P", "difficulty": 6, "samples": [["3 0 1 2\n2 0 0\n0 0 0\n1 1 2", "500000004 500000004 0\n0 0 1\n0 1 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "树形 DP", "概率论"], "title": "「ZYZ 2025」遗传", "background": "唉，转生竞吧！", "description": "**如果你不了解生物的遗传学知识，可以阅读以下部分：**\n\n> 每个生物 M 都有两个属性，记属性一为 $X\\in\\{A,a\\}$，属性二为 $Y\\in\\{A,a\\}$，称 $XY$ 为其**基因型**，包括 $AA,Aa,aa$ 三种，这里认为 $Aa$ 和 $aA$ 等价。\n>\n> 对于生物 M 可患的遗传病 I，若 I 为**隐性遗传病**，则该生物患病当且仅当其基因型为 $aa$，若 I 为**显性遗传病**，则该生物患病当且仅当其基因型为 $Aa$ 或 $AA$。\n>\n> 若基因型为 $X_1Y_1$ 和 $X_2Y_2$ 的生物交配，则其后代的基因型有四种情况：$X_1X_2,X_1Y_2,Y_1X_2,Y_1Y_2$，且每种情况的概率相同，均为 $\\dfrac{1}{4}$。\n>\n> 若 $A$ 的**基因频率**为 $p$，则认为在没有其他条件的影响下（在本题中“其他条件”包括“知道其父母”），一个生物 M 的两个属性各自有 $p$ 的概率为 $A$，$1-p$ 的概率为 $a$，且相互独立。\n>\n> 现在有一种生物 M 可患的遗传病 I，已知其是显性还是隐性，$A$ 的基因频率为 $p$。\n\n**否则，你可以阅读以下部分：**\n\n> 现在有一种和生物 M 有关的遗传病 I，已知其是显性还是隐性，其受一对常染色体等位基因 $(A,a)$ 控制，该基因的遗传符合孟德尔遗传规律，不考虑基因突变、染色体变异，交叉互换等特殊情况。\n>\n> **已知** $A$ 的基因频率是 $p$，即认为在没有其他条件的影响下（在本题中“其他条件”包括“知道其父母”），一个生物 M 的两个基因各自有 $p$ 的概率为 $A$，$1-p$ 的概率为 $a$，且相互独立。\n\n现在有 $n$ 个生物 M，第 $i$ 个生物的父亲为 $fa_i$，母亲为 $mo_i$，若 $fa_i=0$ 或 $mo_i=0$ 则表示父亲或母亲未知。为了简化问题，保证 $fa_i$ 和 $mo_i$ 要么**均为** $0$，要么**均不为** $0$，且**恰有一个**生物 M 没有孩子，其余生物 M **恰有一个孩子**。\n\n给出 $n$ 个生物的关系，已知部分生物的患病情况，你需要分别求出每一个生物基因型为 $AA,Aa,aa$ 的概率，对 $10^9+7$ 取模。\n\n你可以参见样例解释以更好的理解这个题目。\n\n**保证数据合法且保证数据随机生成**。", "inputFormat": "第一行输入四个整数 $n,t,a,b$，$n$ 表示生物总数，$t = 0$ 表示疾病 I 为隐性，$t = 1$ 表示疾病 I 为显性，$A$ 的基因频率 $p=\\dfrac{a}{b}$。\n\n接下来 $n$ 行，第 $i$ 行首先输入一个整数 $k_i$，若 $k_i=0$ 表示第 $i$ 个生物患病，$k_i=1$ 表示不患病，$k_i=2$ 表示患病状况未知。再输入两个整数 $fa_i,mo_i$ 分别表示其父亲、母亲的编号，若编号为 $0$，则表示父母未知。", "outputFormat": "输出 $n$ 行，其中的第 $i$ 行输出三个整数，分别表示第 $i$ 个生物基因型为 $AA,Aa,aa$ 的概率，结果对 $10^9+7$ 取模。", "hint": "**【样例解释】**\n\n记第 $i$ 个生物为 $M_i$，其基因型为 $S_i$。由于 $M_2$ 患隐性遗传病，所以 $S_2=aa$ 且 $M_3$ 含有基因（属性）$a$。又因为 $M_3$ 不患病，所以 $S_3=Aa$。\n\n因为 $M_1$ 和患病的 $M_2$ 生出不患病的 $M_3$，所以 $M_1$ 一定不患病。因为 $p=\\dfrac12$，所以对于一个随机的不患病的个体，其基因型为 $AA$ 和 $Aa$ 的概率之比为：\n\n$$\\left(\\dfrac12\\times\\dfrac12\\right):\\left(2\\times\\dfrac12\\times(1-\\dfrac12)\\right)=1:2$$\n\n又因为基因型为 $AA$ 和 $aa$ 的个体生出 $Aa$ 个体的概率为 $1$，基因型为 $Aa$ 和 $aa$ 的个体生出 $Aa$ 个体的概率为 $\\dfrac12$，所以 $S_1$ 为 $AA$ 和 $Aa$ 的概率之比为：\n\n$$\\left(\\dfrac13\\times1\\right):\\left(\\dfrac23\\times\\dfrac12\\right)=1:1$$\n\n所以 $S_1$ 为 $AA$ 和 $Aa$ 的概率相同，均为 $\\dfrac12$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|特殊性质|分值|\n|:-:|:-:|:-:|\n|$0$|$n\\leq5$|$15$|\n|$1$|任意 $i\\in[1,n]$ 满足 $k_i=2$|$15$|\n|$2$|$n\\leq 5\\times 10^3$|$30$|\n|$3$|无|$40$|\n\n对于 $100\\%$ 的测试数据，保证：$1\\leq fa_i,mo_i\\leq n \\leq10^5$，$t\\in\\{0,1\\}$，$1\\leq a< b\\leq 10^9$，$k_i\\in\\{0,1,2\\}$，保证出现题目给出情况的概率在模 $10^9+7$ 意义下不为 $0$，**保证数据随机生成**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ZYZ 2025」遗传", "background": "唉，转生竞吧！", "description": "**如果你不了解生物的遗传学知识，可以阅读以下部分：**\n\n> 每个生物 M 都有两个属性，记属性一为 $X\\in\\{A,a\\}$，属性二为 $Y\\in\\{A,a\\}$，称 $XY$ 为其**基因型**，包括 $AA,Aa,aa$ 三种，这里认为 $Aa$ 和 $aA$ 等价。\n>\n> 对于生物 M 可患的遗传病 I，若 I 为**隐性遗传病**，则该生物患病当且仅当其基因型为 $aa$，若 I 为**显性遗传病**，则该生物患病当且仅当其基因型为 $Aa$ 或 $AA$。\n>\n> 若基因型为 $X_1Y_1$ 和 $X_2Y_2$ 的生物交配，则其后代的基因型有四种情况：$X_1X_2,X_1Y_2,Y_1X_2,Y_1Y_2$，且每种情况的概率相同，均为 $\\dfrac{1}{4}$。\n>\n> 若 $A$ 的**基因频率**为 $p$，则认为在没有其他条件的影响下（在本题中“其他条件”包括“知道其父母”），一个生物 M 的两个属性各自有 $p$ 的概率为 $A$，$1-p$ 的概率为 $a$，且相互独立。\n>\n> 现在有一种生物 M 可患的遗传病 I，已知其是显性还是隐性，$A$ 的基因频率为 $p$。\n\n**否则，你可以阅读以下部分：**\n\n> 现在有一种和生物 M 有关的遗传病 I，已知其是显性还是隐性，其受一对常染色体等位基因 $(A,a)$ 控制，该基因的遗传符合孟德尔遗传规律，不考虑基因突变、染色体变异，交叉互换等特殊情况。\n>\n> **已知** $A$ 的基因频率是 $p$，即认为在没有其他条件的影响下（在本题中“其他条件”包括“知道其父母”），一个生物 M 的两个基因各自有 $p$ 的概率为 $A$，$1-p$ 的概率为 $a$，且相互独立。\n\n现在有 $n$ 个生物 M，第 $i$ 个生物的父亲为 $fa_i$，母亲为 $mo_i$，若 $fa_i=0$ 或 $mo_i=0$ 则表示父亲或母亲未知。为了简化问题，保证 $fa_i$ 和 $mo_i$ 要么**均为** $0$，要么**均不为** $0$，且**恰有一个**生物 M 没有孩子，其余生物 M **恰有一个孩子**。\n\n给出 $n$ 个生物的关系，已知部分生物的患病情况，你需要分别求出每一个生物基因型为 $AA,Aa,aa$ 的概率，对 $10^9+7$ 取模。\n\n你可以参见样例解释以更好的理解这个题目。\n\n**保证数据合法且保证数据随机生成**。", "inputFormat": "第一行输入四个整数 $n,t,a,b$，$n$ 表示生物总数，$t = 0$ 表示疾病 I 为隐性，$t = 1$ 表示疾病 I 为显性，$A$ 的基因频率 $p=\\dfrac{a}{b}$。\n\n接下来 $n$ 行，第 $i$ 行首先输入一个整数 $k_i$，若 $k_i=0$ 表示第 $i$ 个生物患病，$k_i=1$ 表示不患病，$k_i=2$ 表示患病状况未知。再输入两个整数 $fa_i,mo_i$ 分别表示其父亲、母亲的编号，若编号为 $0$，则表示父母未知。", "outputFormat": "输出 $n$ 行，其中的第 $i$ 行输出三个整数，分别表示第 $i$ 个生物基因型为 $AA,Aa,aa$ 的概率，结果对 $10^9+7$ 取模。", "hint": "**【样例解释】**\n\n记第 $i$ 个生物为 $M_i$，其基因型为 $S_i$。由于 $M_2$ 患隐性遗传病，所以 $S_2=aa$ 且 $M_3$ 含有基因（属性）$a$。又因为 $M_3$ 不患病，所以 $S_3=Aa$。\n\n因为 $M_1$ 和患病的 $M_2$ 生出不患病的 $M_3$，所以 $M_1$ 一定不患病。因为 $p=\\dfrac12$，所以对于一个随机的不患病的个体，其基因型为 $AA$ 和 $Aa$ 的概率之比为：\n\n$$\\left(\\dfrac12\\times\\dfrac12\\right):\\left(2\\times\\dfrac12\\times(1-\\dfrac12)\\right)=1:2$$\n\n又因为基因型为 $AA$ 和 $aa$ 的个体生出 $Aa$ 个体的概率为 $1$，基因型为 $Aa$ 和 $aa$ 的个体生出 $Aa$ 个体的概率为 $\\dfrac12$，所以 $S_1$ 为 $AA$ 和 $Aa$ 的概率之比为：\n\n$$\\left(\\dfrac13\\times1\\right):\\left(\\dfrac23\\times\\dfrac12\\right)=1:1$$\n\n所以 $S_1$ 为 $AA$ 和 $Aa$ 的概率相同，均为 $\\dfrac12$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|特殊性质|分值|\n|:-:|:-:|:-:|\n|$0$|$n\\leq5$|$15$|\n|$1$|任意 $i\\in[1,n]$ 满足 $k_i=2$|$15$|\n|$2$|$n\\leq 5\\times 10^3$|$30$|\n|$3$|无|$40$|\n\n对于 $100\\%$ 的测试数据，保证：$1\\leq fa_i,mo_i\\leq n \\leq10^5$，$t\\in\\{0,1\\}$，$1\\leq a< b\\leq 10^9$，$k_i\\in\\{0,1,2\\}$，保证出现题目给出情况的概率在模 $10^9+7$ 意义下不为 $0$，**保证数据随机生成**。", "locale": "zh-CN"}}}
{"pid": "P13351", "type": "P", "difficulty": 7, "samples": [["10\n-10 -10 -10 10\n0 -10 0 10\n10 -10 10 10\n-10 -10 10 -10\n-10 0 10 0\n-10 10 10 10\n5 -10 5 10\n-10 5 10 5\n-2 0 -2 10\n-5 -5 10 -5", "3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树状数组", "2024", "广东", "扫描线", "省赛/邀请赛"], "title": "[GDCPC 2024] 田字格", "background": "数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>", "description": "小 I 正在学习练字，可当他打开白纸时才想起来自己之前无聊在白纸上将 $n$ 条线段涂黑了，纸上其他部分都是白的。\n\n这 $n$ 条被涂黑的线段都是水平的或者竖直的：以白纸中心为原点，平行白纸的某条边构建 $x$ 轴，另一条边构建 $y$ 轴，那么每条被涂黑的线段的两个端点 $(x_1,y_1)$ 和 $(x_2,y_2)$ 满足：$x_1 = x_2$ 和 $y_1 = y_2$ 恰有一个成立。同时，任意两条水平的线段没有交点，任意两条竖直的线段没有交点。\n\n尽管涂黑的线段很让小 I 糟心，深谙福祸相依的小 I 还是发现，涂黑的 $n$ 条线段构成了若干田字格，而他可以在这些田字格上练字。\n\n田字格可以由三元组 $(x_0, y_0, d)$ 描述。一个三元组 $(x_0, y_0, d)$ 是田字格当且仅当以下条件成立：\n\n- $x_0, y_0 \\in \\mathbb{R}$, $d \\in \\mathbb{R}^+$；\n- 设 $R = [x_0-d,x_0+d] \\times [y_0-d,y_0+d]$，即横坐标在 $[x_0-d,x_0+d]$ 内、纵坐标在 $[y_0-d,y_0+d]$ 内的所有点。那么 $R$ 中被涂黑的部分恰好构成六条线段，且这六条线段分别是 $x=x_0-d,x=x_0,x=x_0+d,y=y_0-d,y=y_0,y=y_0+d$ 这六条直线与 $R$ 的交。\n\n小 I 于是想想算算白纸上有几个田字格，也就是有多少个满足以上条件的三元组 $(x_0,y_0,d)$。但按照惯例小 I 不会算，所以这个任务交给了你。", "inputFormat": "输入的第一行一个整数 $n (1 \\le n \\le 3 \\times 10^5)$ 表示线段数。接下来 $n$ 行每行四个整数 $x_1,y_1,x_2,y_2 (-10^9 \\le x_1 \\le x_2 \\le 10^9, -10^9 \\le y_1 \\le y_2 \\le 10^9)$ 表示一条线段。\n\n输入的每条线段满足 $x_1 = x_2$ 和 $y_1 = y_2$ 恰有一个成立，且任意两条满足 $x_1 = x_2$ 的线段间没有交点，任意两条满足 $y_1 = y_2$ 的线段间没有交点。\n", "outputFormat": "输出一行一个整数表示田字格的数量。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/9hq95rak.png)\n\n如上图所示，$(5, 5, 5), (5, 0, 5), (5, -5, 5)$ 是三个合法的田字格。注意以下几个都不是田字格：\n\n- $(0, 0, 10)$，因为除了需要的六条线段以外还有其他部分被涂黑了；\n- $(-5, 5, 5)$，因为 $x=-5$ 与正方形的交没有被涂黑。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GDCPC 2024] 田字格", "background": "数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>", "description": "小 I 正在学习练字，可当他打开白纸时才想起来自己之前无聊在白纸上将 $n$ 条线段涂黑了，纸上其他部分都是白的。\n\n这 $n$ 条被涂黑的线段都是水平的或者竖直的：以白纸中心为原点，平行白纸的某条边构建 $x$ 轴，另一条边构建 $y$ 轴，那么每条被涂黑的线段的两个端点 $(x_1,y_1)$ 和 $(x_2,y_2)$ 满足：$x_1 = x_2$ 和 $y_1 = y_2$ 恰有一个成立。同时，任意两条水平的线段没有交点，任意两条竖直的线段没有交点。\n\n尽管涂黑的线段很让小 I 糟心，深谙福祸相依的小 I 还是发现，涂黑的 $n$ 条线段构成了若干田字格，而他可以在这些田字格上练字。\n\n田字格可以由三元组 $(x_0, y_0, d)$ 描述。一个三元组 $(x_0, y_0, d)$ 是田字格当且仅当以下条件成立：\n\n- $x_0, y_0 \\in \\mathbb{R}$, $d \\in \\mathbb{R}^+$；\n- 设 $R = [x_0-d,x_0+d] \\times [y_0-d,y_0+d]$，即横坐标在 $[x_0-d,x_0+d]$ 内、纵坐标在 $[y_0-d,y_0+d]$ 内的所有点。那么 $R$ 中被涂黑的部分恰好构成六条线段，且这六条线段分别是 $x=x_0-d,x=x_0,x=x_0+d,y=y_0-d,y=y_0,y=y_0+d$ 这六条直线与 $R$ 的交。\n\n小 I 于是想想算算白纸上有几个田字格，也就是有多少个满足以上条件的三元组 $(x_0,y_0,d)$。但按照惯例小 I 不会算，所以这个任务交给了你。", "inputFormat": "输入的第一行一个整数 $n (1 \\le n \\le 3 \\times 10^5)$ 表示线段数。接下来 $n$ 行每行四个整数 $x_1,y_1,x_2,y_2 (-10^9 \\le x_1 \\le x_2 \\le 10^9, -10^9 \\le y_1 \\le y_2 \\le 10^9)$ 表示一条线段。\n\n输入的每条线段满足 $x_1 = x_2$ 和 $y_1 = y_2$ 恰有一个成立，且任意两条满足 $x_1 = x_2$ 的线段间没有交点，任意两条满足 $y_1 = y_2$ 的线段间没有交点。\n", "outputFormat": "输出一行一个整数表示田字格的数量。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/9hq95rak.png)\n\n如上图所示，$(5, 5, 5), (5, 0, 5), (5, -5, 5)$ 是三个合法的田字格。注意以下几个都不是田字格：\n\n- $(0, 0, 10)$，因为除了需要的六条线段以外还有其他部分被涂黑了；\n- $(-5, 5, 5)$，因为 $x=-5$ 与正方形的交没有被涂黑。", "locale": "zh-CN"}}}
{"pid": "P13352", "type": "P", "difficulty": 6, "samples": [["4 2 378323747\nshop\npizza\npiazza\npizzala", "286"], ["9 99 998244353\nasap\npeace\npiece\npizza\nsapiens\ndazzling\nandromeda\nsakurasaku\nkokorosaku", "161369438"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "广东", "容斥原理", "AC 自动机", "KMP 算法", "省赛/邀请赛"], "title": "[GDCPC 2024] 腊肠披萨", "background": "数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>", "description": "宇宙北大街上新开了一家披萨店。这家披萨店主打使用腊肠的披萨，被顾客亲切地称为“腊肠披萨店”。这种中西合璧的做法听上去很离经叛道，但是品尝过腊肠披萨的顾客都对其称赞有加，吸引了众多食客蜂拥而至。\n\n除了配料极具特色，腊肠披萨店的 Wi-Fi 密码也是它的流量密码。菜单上写着：“本店的 Wi-Fi 密码是\n\n$$\n\\sum_{i=1}^L \\sum_{j=1}^L C^{\\left|LCPS\\left(s_i, s_j\\right)\\right|} \\bmod{P},\n$$\n\n其中 $LCPS\\left(s_i, s_j\\right)$ 表示 $s_i$ 和 $s_j$ 的最长公共前后缀，即最长的同时是 $s_i$ 前缀和 $s_j$ 后缀的字符串（可能为空，也可能为整个串）；每天的 $s_1,\\cdots,s_L$ 都不一样，服务员会在点餐后提供用于当天的 Wi-Fi 密码的字符串。每天将会从前 100 名连上 Wi-Fi 的顾客中随机抽取一位免单。”\n\n你计划下周和朋友一起来这家店聚餐，因此你想设计一个算法，快速求出这家店的 Wi-Fi 密码。", "inputFormat": "输入的第一行包含三个正整数 $L, C, P$，表示字符串的数量、底数及模数。保证 $1\\le L\\le 3\\times 10^6$，$2\\le C<P<2^{30}$。\n\n接下来 $L$ 行，每行输入一个仅由小写字符构成的字符串 $s_i$。保证 $1\\le \\left|s_i\\right| \\le 3\\times 10^6$，$\\sum_{i=1}^L \\left|s_i\\right| \\le 3\\times 10^6$。\n", "outputFormat": "输出一个非负整数，表示腊肠披萨店的 Wi-Fi 密码。", "hint": "### 样例 1 解释\n\n对于 $1\\le i,j\\le 4, i\\ne j$，\n\n- $LCPS($ `pizza` $,$ `shop` $ )=LCPS($ `piazza` $,$ `shop` $)=LCPS($ `pizzala` $,$ `shop` $)=$ `p`；\n- $LCPS($ `pizzala` $,$ `pizza` $)=$ `pizza`；\n- 其余的 $LCPS\\left(s_i, s_j\\right)=\\varepsilon$。\n\n因此对应的 Wi-Fi 密码为\n\n$$\n2^4 + 2^0 + 2^0 + 2^0 + 2^1 + 2^5 + 2^0 + 2^0 + 2^1 + 2^0 + 2^6 + 2^0 + 2^1 + 2^5 + 2^0 + 2^7 = 286.\n$$\n\n腊肠披萨店在制作披萨时使用了绝密配方。在没有专业人士指导的情况下，请不要轻易模仿。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GDCPC 2024] 腊肠披萨", "background": "数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>", "description": "宇宙北大街上新开了一家披萨店。这家披萨店主打使用腊肠的披萨，被顾客亲切地称为“腊肠披萨店”。这种中西合璧的做法听上去很离经叛道，但是品尝过腊肠披萨的顾客都对其称赞有加，吸引了众多食客蜂拥而至。\n\n除了配料极具特色，腊肠披萨店的 Wi-Fi 密码也是它的流量密码。菜单上写着：“本店的 Wi-Fi 密码是\n\n$$\n\\sum_{i=1}^L \\sum_{j=1}^L C^{\\left|LCPS\\left(s_i, s_j\\right)\\right|} \\bmod{P},\n$$\n\n其中 $LCPS\\left(s_i, s_j\\right)$ 表示 $s_i$ 和 $s_j$ 的最长公共前后缀，即最长的同时是 $s_i$ 前缀和 $s_j$ 后缀的字符串（可能为空，也可能为整个串）；每天的 $s_1,\\cdots,s_L$ 都不一样，服务员会在点餐后提供用于当天的 Wi-Fi 密码的字符串。每天将会从前 100 名连上 Wi-Fi 的顾客中随机抽取一位免单。”\n\n你计划下周和朋友一起来这家店聚餐，因此你想设计一个算法，快速求出这家店的 Wi-Fi 密码。", "inputFormat": "输入的第一行包含三个正整数 $L, C, P$，表示字符串的数量、底数及模数。保证 $1\\le L\\le 3\\times 10^6$，$2\\le C<P<2^{30}$。\n\n接下来 $L$ 行，每行输入一个仅由小写字符构成的字符串 $s_i$。保证 $1\\le \\left|s_i\\right| \\le 3\\times 10^6$，$\\sum_{i=1}^L \\left|s_i\\right| \\le 3\\times 10^6$。\n", "outputFormat": "输出一个非负整数，表示腊肠披萨店的 Wi-Fi 密码。", "hint": "### 样例 1 解释\n\n对于 $1\\le i,j\\le 4, i\\ne j$，\n\n- $LCPS($ `pizza` $,$ `shop` $ )=LCPS($ `piazza` $,$ `shop` $)=LCPS($ `pizzala` $,$ `shop` $)=$ `p`；\n- $LCPS($ `pizzala` $,$ `pizza` $)=$ `pizza`；\n- 其余的 $LCPS\\left(s_i, s_j\\right)=\\varepsilon$。\n\n因此对应的 Wi-Fi 密码为\n\n$$\n2^4 + 2^0 + 2^0 + 2^0 + 2^1 + 2^5 + 2^0 + 2^0 + 2^1 + 2^0 + 2^6 + 2^0 + 2^1 + 2^5 + 2^0 + 2^7 = 286.\n$$\n\n腊肠披萨店在制作披萨时使用了绝密配方。在没有专业人士指导的情况下，请不要轻易模仿。", "locale": "zh-CN"}}}
{"pid": "P13353", "type": "P", "difficulty": 4, "samples": [["5\n8 5 3 6 4\n1 1 3 3", "75"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "广东", "省赛/邀请赛"], "title": "[GDCPC 2024] DFS 序", "background": "数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>", "description": "给定一棵 $n$ 个点的有根树，$1$ 号点为根。每个点有一个权值 $w_i$。\n\n求一个最优的 DFS 序使得 $\\sum\\limits_{i=1}^n p_iw_i$ 最大。其中 $p_i$ 表示访问第 $i$ 个点的时刻，即第一次访问节点 $i$ 之前访问过多少个不同的节点（包含节点 $i$ 本身）。\n", "inputFormat": "第一行一个正整数 $n(1\\le n \\le 2\\times 10^5)$。\n\n第二行 $n$ 个正整数，其中第 $i$ 个表示 $w_i(1\\le w_i \\le 10^8)$。\n\n第三行 $n-1$ 个正整数，其中第 $i$ 个表示 $i+1$ 号节点的父亲，保证取值在 $1\\sim i$ 之间。", "outputFormat": "一行一个整数，表示最大的 $\\sum\\limits_{i=1}^n p_iw_i$。", "hint": "按照 $(1,3,5,4,2)$ 的访问顺序可以取得最大值 $1\\times 8+2\\times 3+3\\times 4+4\\times 6+5\\times 5=75$。\n\n注意 $(1,3,2,4,5)$ 不是一个合法的访问顺序。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GDCPC 2024] DFS 序", "background": "数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>", "description": "给定一棵 $n$ 个点的有根树，$1$ 号点为根。每个点有一个权值 $w_i$。\n\n求一个最优的 DFS 序使得 $\\sum\\limits_{i=1}^n p_iw_i$ 最大。其中 $p_i$ 表示访问第 $i$ 个点的时刻，即第一次访问节点 $i$ 之前访问过多少个不同的节点（包含节点 $i$ 本身）。\n", "inputFormat": "第一行一个正整数 $n(1\\le n \\le 2\\times 10^5)$。\n\n第二行 $n$ 个正整数，其中第 $i$ 个表示 $w_i(1\\le w_i \\le 10^8)$。\n\n第三行 $n-1$ 个正整数，其中第 $i$ 个表示 $i+1$ 号节点的父亲，保证取值在 $1\\sim i$ 之间。", "outputFormat": "一行一个整数，表示最大的 $\\sum\\limits_{i=1}^n p_iw_i$。", "hint": "按照 $(1,3,5,4,2)$ 的访问顺序可以取得最大值 $1\\times 8+2\\times 3+3\\times 4+4\\times 6+5\\times 5=75$。\n\n注意 $(1,3,2,4,5)$ 不是一个合法的访问顺序。", "locale": "zh-CN"}}}
{"pid": "P13354", "type": "P", "difficulty": 7, "samples": [["24 10\n0 0 //\n1 0 00/86/0\n2 0 /10/\n3 1 62793001\n3 1 62770334\n3 1 62783054\n3 1 62757487\n3 1 62562503\n2 0 /20/\n9 1 88331234\n9 1 83561784\n1 0 001/852/\n12 1 23587000\n1 0 010/81/0\n14 0 /3/\n15 0 /5841/2\n16 1 4111\n16 1 7926\n14 0 /6/\n19 0 /6879/\n20 1 4508\n20 1 4421\n19 0 /6850/\n23 1 6618\n7 62793001\n7 01062793001\n10 62770334\n10 01062770334\n8 02083561784\n10 0085223587000\n17 27926\n17 0668794508\n21 4421\n21 68506618", "1 4\n0 0\n0 0\n1 5\n1 11\n1 13\n1 18\n1 21\n1 22\n1 24"], ["6 6\n0 0 0/0/1\n1 0 0/1/01\n1 1 00\n1 1 01\n2 1 00\n2 1 01\n5 00\n5 0100\n5 0101\n6 01\n6 0100\n6 0101", "0 0\n1 3\n0 2\n0 0\n0 2\n1 4"], ["见下载目录下的 3.in 与 3.ans。", "见下载目录下的 3.in 与 3.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "广东", "哈希 hashing", "省赛/邀请赛"], "title": "[GDCPC 2024] 拨打电话", "background": "数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>", "description": "用一棵有根树 $T$ 表示简化的电话网络。在 $T$ 中，每个叶结点对应一个具体的通话终端，而每个内部结点表示可以处理通话请求的交换节点。每个通话终端都有一个自己的号码 $a_i$，但是为了让交换节点正确处理通话请求，通常需要在原始号码的前面加上若干前缀编号，用于指明被呼叫者在电话网络中所处的位置。例如，从中国大陆的其它地区拨打北京市的固定电话，则需要在前面按顺序加上长途冠码 `0` 及北京市区号 `10`，才能正确地拨通对应的电话。在 $T$ 中，从通话终端 $u$ 向通话终端 $v$ 拨打电话时，正确的电话号码应通过沿着在 $T$ 上从 $u$ 到 $v$ 的最短路，按顺序连接各交换节点相应前缀号（即最靠近 $u$ 的交换节点的前缀号应在最前，最靠近 $v$ 的交换节点的前缀号应在最后）后，加上 $v$ 本身的号码得到。\n\n在 $T$ 中，根据发出请求的通话终端、接受请求的通话终端与交换节点的关系，每个交换节点各有 $3$ 种可能为空的前缀号，分别为：\n\n- 从该交换节点 $v$ 在 $T$ 中对应子树内向子树外拨打电话时需要加的前缀号 $b_v$，如从中国大陆拨打其它国家或地区的电话时需加国际冠码 `00`；\n\n- 从该交换节点 $v$ 在 $T$ 中对应子树外向子树内拨打电话时需要加的前缀号 $c_v$，如从其它国家或地区向中国大陆拨打电话时需加中国大陆的国际区码 `86`；\n\n- 从该交换节点 $v$ 在 $T$ 中任意一子结点（子结点可能为某一通话终端，也可能是其它交换节点，后同）向 $v$ 发出请求，$v$ 需要将该请求转发给另外一子结点进行处理时的需要加的前缀号 $d_v$，如从中国大陆的其它地区拨打北京市的固定电话 `ABCDEFGH`，需要使用长途冠码 `0`，对应电话号码为 `010`-`ABCDEFGH`；而从其它国家或地区拨打北京市的同一电话，则只需在国际冠码之后拨打 `86`-`10`-`ABCDEFGH`，不需要使用长途冠码 `0`。\n\n现在给出 $T$ 中若干个通话请求，每个请求由拨出结点和该请求在该结点拨打的电话号码组成，请判断拨打的电话号码是否对应唯一的通话终端。如果是，请求出该通话终端；否则，请求出与该电话号码对应的通话终端数量。", "inputFormat": "输入的第一行包含两个正整数 $n, q$，表示电话网络 $T$ 的结点数和通话请求的数量。保证 $2\\le n\\le 10^5$，$1\\le q\\le 10^5$。\n\n接下来 $n$ 行，每行输入两个非负整数和一个字符串 $f_i$，$t_i$，$s_i$，分别由一个空格隔开，描述 $T$ 的第 $i$ 个结点。其中，$f_i>0$ 时表示结点 $i$ 在 $T$ 上的父结点编号，$f_i=0$ 表示结点 $i$ 是 $T$ 的根；$t_i\\in\\{0,1\\}$ 表示结点 $i$ 是否为叶结点，\n\n- 如果 $t_i=1$，则结点 $i$ 为叶结点，此时 $s_i$ 是仅由字符 `0` 至 `9` 构成的非空字符串，表示结点 $i$ 的原始电话号码 $a_i$；\n\n- 如果 $t_i = 0$，则结点 $i$ 为内部交换节点，此时 $s_i$ 包含三个由单个 `/` 字符隔开的仅由字符 `0` 至 `9` 构成的字符串（可能为空），分别为前缀号 $b_i$，$c_i$ 和 $d_i$。\n\n保证 $0\\le f_i < i$，所有叶结点的 $a_i$ 及所有内部 $b_i, c_i, d_i$ 的总长不超过 $3\\times 10^6$。\n\n接下来 $q$ 行，每行输入一个正整数 $p_i$ 和一个仅包含字符 `0` 至 `9` 的非空字符串 $r_i$，表示在结点 $p_i$ 拨打电话号码为 $r_i$ 的通话请求。保证 $p_i$ 对应叶结点，$\\sum_{i=1}^q \\left|r_i\\right| \\le 3\\times10^6$。", "outputFormat": "对每个通话请求输出一行。如果拨打的电话号码对应唯一的通话终端，输出 `1 x`，其中正整数 $x$ 是该通话终端的编号；否则，输出 `0 y`，其中非负整数 $y$ 是匹配的通话终端的数量。\n", "hint": "### 样例 1 解释\n\n为方便理解题意，该样例使用了实际存在的电话号码。其表示的电话网络见下图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x3js9qvb.png)\n\n- 第一个询问的通话请求是从北京大学计算机学院至清华大学后勤综合服务热线/校内查号台。因为这两个结点的父结点均为结点 $3$（对应北京市），且父结点 $d_3=\\varepsilon$，所以直接拨打对应电话即可。第二个询问为第一个询问加上区号的版本，在本题中认为该询问的电话号码无法拨通。\n\n- 第四个询问为香港科技大学（广州）向清华大学招生办公室发出通话请求。由于两个通话终端的父结点不同，拨打电话时应加上前缀 $b_9 + d_2 + c_3=$ `010`。第三个询问与第四个询问类似，但是没有加上前缀，故无法拨通。\n\n- 第五个询问为中国计算机学会致电广东省计算机学会，计算应拨打电话号码的方式为 $b_3 + d_2 + c_9 + a_{11}$。\n\n- 第六个询问为从香港科技大学（广州）向香港科技大学计算机科学与工程系（Department of Computer Science and Engineering）发出通话请求。拨打电话时，应先按顺序拨打中国大陆的国际冠码 $b_2=$ `00` 和中国香港的国际区码 $c_{12}=$ `852`，然后再键入原始电话号码 $a_{13}$（完整的计算方法为 $b_9 + b_2 + d_1 + c_{12} + a_{13}$）。\n\n- 第七个询问为从东京大学研究生院计算机科学专业办公室拨至情报理工学系研究科招生办公室。由于本乡校区的内部电话需要在 $4$ 位电话之前加上 $d_{16}=$ `2`，正确的电话号码为 `2` $+$ `7926` $=$ `27926`。\n\n- 第八个询问为东京大学研究生院计算机科学专业办公室向大阪大学研究生院信息科学研究科办公室拨打电话。拨打电话时，应先后加上长途冠码 $d_{14}=$ `0`、大阪的区号（市外局番）$c_{19}=$ `6` 和吹田校区所属的子区域区号（市内局番）$c_{20}=$ `6879`。应拨打的电话号码的完整表达式为 $b_{16}+b_{15}+d_{14}+c_{19}+c_{20}+a_{21}$。\n\n- 第九个询问为从大阪大学研究生院信息科学研究科办公室拨打电话给同样位于吹田校区的生命机能研究科。$d_{20}=\\varepsilon$ 意味着吹田校区的内部电话不需要加前缀，可以直接拨打对应 $4$ 位电话号码。\n\n- 第十个询问为从大阪大学研究生院信息科学研究科办公室向大阪大学信息科学系的办公室拨打电话。由于本科的信息科学系位于丰中校区，所以需要在原始电话号码前加上丰中校区对应的子区域区号（市内局番）$c_{23}=$ `6850`（实际拨打电话时，也可以使用丰中校区的内部电话前缀 `172`，但这不在本题考虑范围之内）。\n\n### 样例 2 解释\n\n从结点 $2$ 的子树中拨打 `0100`，可以匹配到结点 $3$ 和结点 $5$；拨打 `0101`，可以匹配到结点 $4$ 和结点 $6$。因为一个结点播出的电话号码不能匹配自己，所以只有第二个询问和第六个询问拨出的电话号码对应唯一的通话终端。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GDCPC 2024] 拨打电话", "background": "数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>", "description": "用一棵有根树 $T$ 表示简化的电话网络。在 $T$ 中，每个叶结点对应一个具体的通话终端，而每个内部结点表示可以处理通话请求的交换节点。每个通话终端都有一个自己的号码 $a_i$，但是为了让交换节点正确处理通话请求，通常需要在原始号码的前面加上若干前缀编号，用于指明被呼叫者在电话网络中所处的位置。例如，从中国大陆的其它地区拨打北京市的固定电话，则需要在前面按顺序加上长途冠码 `0` 及北京市区号 `10`，才能正确地拨通对应的电话。在 $T$ 中，从通话终端 $u$ 向通话终端 $v$ 拨打电话时，正确的电话号码应通过沿着在 $T$ 上从 $u$ 到 $v$ 的最短路，按顺序连接各交换节点相应前缀号（即最靠近 $u$ 的交换节点的前缀号应在最前，最靠近 $v$ 的交换节点的前缀号应在最后）后，加上 $v$ 本身的号码得到。\n\n在 $T$ 中，根据发出请求的通话终端、接受请求的通话终端与交换节点的关系，每个交换节点各有 $3$ 种可能为空的前缀号，分别为：\n\n- 从该交换节点 $v$ 在 $T$ 中对应子树内向子树外拨打电话时需要加的前缀号 $b_v$，如从中国大陆拨打其它国家或地区的电话时需加国际冠码 `00`；\n\n- 从该交换节点 $v$ 在 $T$ 中对应子树外向子树内拨打电话时需要加的前缀号 $c_v$，如从其它国家或地区向中国大陆拨打电话时需加中国大陆的国际区码 `86`；\n\n- 从该交换节点 $v$ 在 $T$ 中任意一子结点（子结点可能为某一通话终端，也可能是其它交换节点，后同）向 $v$ 发出请求，$v$ 需要将该请求转发给另外一子结点进行处理时的需要加的前缀号 $d_v$，如从中国大陆的其它地区拨打北京市的固定电话 `ABCDEFGH`，需要使用长途冠码 `0`，对应电话号码为 `010`-`ABCDEFGH`；而从其它国家或地区拨打北京市的同一电话，则只需在国际冠码之后拨打 `86`-`10`-`ABCDEFGH`，不需要使用长途冠码 `0`。\n\n现在给出 $T$ 中若干个通话请求，每个请求由拨出结点和该请求在该结点拨打的电话号码组成，请判断拨打的电话号码是否对应唯一的通话终端。如果是，请求出该通话终端；否则，请求出与该电话号码对应的通话终端数量。", "inputFormat": "输入的第一行包含两个正整数 $n, q$，表示电话网络 $T$ 的结点数和通话请求的数量。保证 $2\\le n\\le 10^5$，$1\\le q\\le 10^5$。\n\n接下来 $n$ 行，每行输入两个非负整数和一个字符串 $f_i$，$t_i$，$s_i$，分别由一个空格隔开，描述 $T$ 的第 $i$ 个结点。其中，$f_i>0$ 时表示结点 $i$ 在 $T$ 上的父结点编号，$f_i=0$ 表示结点 $i$ 是 $T$ 的根；$t_i\\in\\{0,1\\}$ 表示结点 $i$ 是否为叶结点，\n\n- 如果 $t_i=1$，则结点 $i$ 为叶结点，此时 $s_i$ 是仅由字符 `0` 至 `9` 构成的非空字符串，表示结点 $i$ 的原始电话号码 $a_i$；\n\n- 如果 $t_i = 0$，则结点 $i$ 为内部交换节点，此时 $s_i$ 包含三个由单个 `/` 字符隔开的仅由字符 `0` 至 `9` 构成的字符串（可能为空），分别为前缀号 $b_i$，$c_i$ 和 $d_i$。\n\n保证 $0\\le f_i < i$，所有叶结点的 $a_i$ 及所有内部 $b_i, c_i, d_i$ 的总长不超过 $3\\times 10^6$。\n\n接下来 $q$ 行，每行输入一个正整数 $p_i$ 和一个仅包含字符 `0` 至 `9` 的非空字符串 $r_i$，表示在结点 $p_i$ 拨打电话号码为 $r_i$ 的通话请求。保证 $p_i$ 对应叶结点，$\\sum_{i=1}^q \\left|r_i\\right| \\le 3\\times10^6$。", "outputFormat": "对每个通话请求输出一行。如果拨打的电话号码对应唯一的通话终端，输出 `1 x`，其中正整数 $x$ 是该通话终端的编号；否则，输出 `0 y`，其中非负整数 $y$ 是匹配的通话终端的数量。\n", "hint": "### 样例 1 解释\n\n为方便理解题意，该样例使用了实际存在的电话号码。其表示的电话网络见下图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x3js9qvb.png)\n\n- 第一个询问的通话请求是从北京大学计算机学院至清华大学后勤综合服务热线/校内查号台。因为这两个结点的父结点均为结点 $3$（对应北京市），且父结点 $d_3=\\varepsilon$，所以直接拨打对应电话即可。第二个询问为第一个询问加上区号的版本，在本题中认为该询问的电话号码无法拨通。\n\n- 第四个询问为香港科技大学（广州）向清华大学招生办公室发出通话请求。由于两个通话终端的父结点不同，拨打电话时应加上前缀 $b_9 + d_2 + c_3=$ `010`。第三个询问与第四个询问类似，但是没有加上前缀，故无法拨通。\n\n- 第五个询问为中国计算机学会致电广东省计算机学会，计算应拨打电话号码的方式为 $b_3 + d_2 + c_9 + a_{11}$。\n\n- 第六个询问为从香港科技大学（广州）向香港科技大学计算机科学与工程系（Department of Computer Science and Engineering）发出通话请求。拨打电话时，应先按顺序拨打中国大陆的国际冠码 $b_2=$ `00` 和中国香港的国际区码 $c_{12}=$ `852`，然后再键入原始电话号码 $a_{13}$（完整的计算方法为 $b_9 + b_2 + d_1 + c_{12} + a_{13}$）。\n\n- 第七个询问为从东京大学研究生院计算机科学专业办公室拨至情报理工学系研究科招生办公室。由于本乡校区的内部电话需要在 $4$ 位电话之前加上 $d_{16}=$ `2`，正确的电话号码为 `2` $+$ `7926` $=$ `27926`。\n\n- 第八个询问为东京大学研究生院计算机科学专业办公室向大阪大学研究生院信息科学研究科办公室拨打电话。拨打电话时，应先后加上长途冠码 $d_{14}=$ `0`、大阪的区号（市外局番）$c_{19}=$ `6` 和吹田校区所属的子区域区号（市内局番）$c_{20}=$ `6879`。应拨打的电话号码的完整表达式为 $b_{16}+b_{15}+d_{14}+c_{19}+c_{20}+a_{21}$。\n\n- 第九个询问为从大阪大学研究生院信息科学研究科办公室拨打电话给同样位于吹田校区的生命机能研究科。$d_{20}=\\varepsilon$ 意味着吹田校区的内部电话不需要加前缀，可以直接拨打对应 $4$ 位电话号码。\n\n- 第十个询问为从大阪大学研究生院信息科学研究科办公室向大阪大学信息科学系的办公室拨打电话。由于本科的信息科学系位于丰中校区，所以需要在原始电话号码前加上丰中校区对应的子区域区号（市内局番）$c_{23}=$ `6850`（实际拨打电话时，也可以使用丰中校区的内部电话前缀 `172`，但这不在本题考虑范围之内）。\n\n### 样例 2 解释\n\n从结点 $2$ 的子树中拨打 `0100`，可以匹配到结点 $3$ 和结点 $5$；拨打 `0101`，可以匹配到结点 $4$ 和结点 $6$。因为一个结点播出的电话号码不能匹配自己，所以只有第二个询问和第六个询问拨出的电话号码对应唯一的通话终端。", "locale": "zh-CN"}}}
