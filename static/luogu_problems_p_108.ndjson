{"pid": "P3189", "type": "P", "difficulty": 0, "samples": [["10 12 3 2 3 5 2 3\n0 0 0 1 0 1 1 1 9 1 1 1\n1 1 2 1 1 1 0 0 8 2 1 8\n1 0 1 0 1 6 1 1 0 0 1 1\n1 1 2 1 2 1 1 1 3 1 1 1\n0 1 0 1 1 1 2 1 6 0 2 1\n1 1 0 1 0 1 1 2 1 1 1 0\n1 0 1 1 1 0 1 0 1 1 0 1\n1 1 0 1 1 1 9 0 0 1 1 1\n0 0 1 0 1 2 1 9 1 1 0 1\n0 1 1 1 1 1 9 1 1 1 1 1", "59"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "各省省选", "湖南", "枚举", "概率论"], "title": "[HNOI2007] 海盗分宝", "background": "", "description": "据说，加勒比海盗每次抢劫完，如果有金银珠宝等贵重物品，都会以特殊的仪式分宝。\n\n他们首先将珠宝装在一个个边长为 $1$ 的土陶立方体中，并在盖子上标记出珠宝的价值 $v$。然后将这些盒子排列成一个长为 $l$，宽为 $w$ 的矩形（如果珠宝不够，可能会用空的土陶盒占据空位，并在盖子上标记价值为 $0$），第 $i$ 行第 $j$ 列的土陶盒上标记的价值为 $v_{i,j}$（其中 $0<i\\leq w$，$0<j\\leq l$，**左下角的土陶盒所在位置为第一行第一列**）。\n\n海盗们按照功劳的大小，决定分宝的顺序，被轮到选取珠宝的海盗将被发给一个底面为 $m\\times n$ 的矩形，高为 $h$ 的木箱子，并要求用这个木箱子来装所选土陶盒，最后盖上木箱盖子。\n\n土陶盒的选取需要分批选取，要求每批土陶盒为一个等同于木箱底面的紧挨着的矩形区域，且木箱长为 $m$ 的边必须与土陶盒摆成矩形时长为 $w$ 的边平行。被选走的土陶盒所在位置在被选走后马上由空土陶盒填充。海盗从土陶盒摆成的矩形底部正中出发，即从第一行的第  $\\lfloor \\frac{w}{2} \\rfloor$ 列的土陶盒的右下角出发，向上沿着据土陶盒摆成的矩形区域的最左边 $\\lfloor \\frac{w}{2} \\rfloor$ 的直线前进。\n\n如图中粗线箭头所示。设第 $k$ 批被选取的区域的最小角为第 $i_k$ 行第 $j_k$ 列的土陶盒，$j_k$ 必须满足 $\\lfloor \\frac{m}{2}+j_k-\\frac{w}{2}\\rfloor \\leq a$，其中 $k\\geq 1$，且当 $j_k=j_{k-1}$ 的时候，$i_k$ 必须满足 $i_k-i_{k-1}\\geq d_1$，当 $j_k\\neq j_{k-1}$ 时，$i_k$ 必须满足 $i_k-i_{k-1}\\geq d_2$，其中 $k\\geq 2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tft6e873.png)", "inputFormat": "第一行包括八个正整数，这些正整数之间用一个空格隔开，这八个正整数依次为 $l,w,m,n,h,a,d_1,d_2$。从第二行到第 $l+1$ 行，每行有 $w$ 个整数，不妨将输入中第 $i+1$ 行，第 $j$ 列的整数记做 $v_{i,j}$（$1\\leq j\\leq w$，$1\\leq i\\leq l$），分别表示土陶盒上标记的珠宝价值，同一行的整数之间用一个空格隔开。\n\n需注意的是：**输入时 $v_{i,j}$ 是从左上角的土陶盒开始，但在求解时左下角的那个土陶盒为第 $1$ 行第 $1$ 列的土陶盒。**\n", "outputFormat": "输出文件中的第一行为一个整数，是最多能得到的珠宝总价值 $T$。\n", "hint": "$d_1,d_2\\geq n$，$1\\leq l,w,a,d_1,d_2\\leq 2\\times 10^3$，$1\\leq m,n\\leq 200$，$1\\leq h\\leq 20$，$0\\leq v_{i,j}\\leq 255$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Pirates Dividing the Treasure", "background": "", "description": "It is said that after each raid, if there are valuables such as gold, silver, and jewels, the Caribbean pirates divide the loot with a special ceremony.\n\nThey first pack the jewels into earthenware cubes with side length $1$, and mark the value $v$ of the jewels on the lid. Then they arrange these boxes into a rectangle of length $l$ and width $w$ (if the jewels are not enough, empty earthenware boxes may be used to fill the empty positions and are marked with value $0$). The value marked on the box at row $i$ and column $j$ is $v_{i,j}$ (where $0 < i \\leq l$, $0 < j \\leq w$; the box at the lower-left corner is at row $1$, column $1$).\n\nAccording to their contributions, the pirates decide an order for picking treasures. The pirate whose turn it is will be given a wooden crate with a base of $m \\times n$ and height $h$, and is required to fill the crate with the selected earthenware boxes, then close the crate lid.\n\nThe boxes must be selected in batches. Each batch must be a contiguous rectangular region equal to the crate’s base, and the side of the crate of length $m$ must be parallel to the side of the arranged rectangle that has length $w$. The positions of the selected boxes are immediately filled with empty boxes after removal. The pirate starts from the exact center of the bottom edge of the arranged rectangle, i.e., from the lower-right corner of the box at row $1$ and column $\\lfloor \\frac{w}{2} \\rfloor$, and proceeds upward along the vertical line that is the left edge of column $\\lfloor \\frac{w}{2} \\rfloor$ of the arranged rectangle.\n\nAs shown by the bold arrows in the figure. Let the lower-left corner of the $k$-th selected region be the box at row $i_k$, column $j_k$. The index $j_k$ must satisfy $\\lfloor \\frac{m}{2} + j_k - \\frac{w}{2} \\rfloor \\leq a$, where $k \\geq 1$. Moreover, when $j_k = j_{k-1}$, $i_k$ must satisfy $i_k - i_{k-1} \\geq d_1$; when $j_k \\neq j_{k-1}$, $i_k$ must satisfy $i_k - i_{k-1} \\geq d_2$, where $k \\geq 2$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tft6e873.png)", "inputFormat": "The first line contains eight positive integers separated by single spaces: $l, w, m, n, h, a, d_1, d_2$. From the second line to line $l + 1$, each line contains $w$ integers. Denote the integer in row $i + 1$, column $j$ by $v_{i,j}$ ($1 \\leq j \\leq w$, $1 \\leq i \\leq l$), representing the jewel value marked on the box lid. The integers on the same line are separated by single spaces.\n\nNote: In the input, $v_{i,j}$ starts from the top-left box, but for the problem definition the box at the lower-left corner is at row $1$, column $1$.", "outputFormat": "Output a single integer on the first line: the maximum total jewel value $T$ that can be obtained.", "hint": "$d_1, d_2 \\geq n$, $1 \\leq l, w, a, d_1, d_2 \\leq 2 \\times 10^3$, $1 \\leq m, n \\leq 200$, $1 \\leq h \\leq 20$, $0 \\leq v_{i,j} \\leq 255$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 海盗分宝", "background": "", "description": "据说，加勒比海盗每次抢劫完，如果有金银珠宝等贵重物品，都会以特殊的仪式分宝。\n\n他们首先将珠宝装在一个个边长为 $1$ 的土陶立方体中，并在盖子上标记出珠宝的价值 $v$。然后将这些盒子排列成一个长为 $l$，宽为 $w$ 的矩形（如果珠宝不够，可能会用空的土陶盒占据空位，并在盖子上标记价值为 $0$），第 $i$ 行第 $j$ 列的土陶盒上标记的价值为 $v_{i,j}$（其中 $0<i\\leq w$，$0<j\\leq l$，**左下角的土陶盒所在位置为第一行第一列**）。\n\n海盗们按照功劳的大小，决定分宝的顺序，被轮到选取珠宝的海盗将被发给一个底面为 $m\\times n$ 的矩形，高为 $h$ 的木箱子，并要求用这个木箱子来装所选土陶盒，最后盖上木箱盖子。\n\n土陶盒的选取需要分批选取，要求每批土陶盒为一个等同于木箱底面的紧挨着的矩形区域，且木箱长为 $m$ 的边必须与土陶盒摆成矩形时长为 $w$ 的边平行。被选走的土陶盒所在位置在被选走后马上由空土陶盒填充。海盗从土陶盒摆成的矩形底部正中出发，即从第一行的第  $\\lfloor \\frac{w}{2} \\rfloor$ 列的土陶盒的右下角出发，向上沿着据土陶盒摆成的矩形区域的最左边 $\\lfloor \\frac{w}{2} \\rfloor$ 的直线前进。\n\n如图中粗线箭头所示。设第 $k$ 批被选取的区域的最小角为第 $i_k$ 行第 $j_k$ 列的土陶盒，$j_k$ 必须满足 $\\lfloor \\frac{m}{2}+j_k-\\frac{w}{2}\\rfloor \\leq a$，其中 $k\\geq 1$，且当 $j_k=j_{k-1}$ 的时候，$i_k$ 必须满足 $i_k-i_{k-1}\\geq d_1$，当 $j_k\\neq j_{k-1}$ 时，$i_k$ 必须满足 $i_k-i_{k-1}\\geq d_2$，其中 $k\\geq 2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tft6e873.png)", "inputFormat": "第一行包括八个正整数，这些正整数之间用一个空格隔开，这八个正整数依次为 $l,w,m,n,h,a,d_1,d_2$。从第二行到第 $l+1$ 行，每行有 $w$ 个整数，不妨将输入中第 $i+1$ 行，第 $j$ 列的整数记做 $v_{i,j}$（$1\\leq j\\leq w$，$1\\leq i\\leq l$），分别表示土陶盒上标记的珠宝价值，同一行的整数之间用一个空格隔开。\n\n需注意的是：**输入时 $v_{i,j}$ 是从左上角的土陶盒开始，但在求解时左下角的那个土陶盒为第 $1$ 行第 $1$ 列的土陶盒。**\n", "outputFormat": "输出文件中的第一行为一个整数，是最多能得到的珠宝总价值 $T$。\n", "hint": "$d_1,d_2\\geq n$，$1\\leq l,w,a,d_1,d_2\\leq 2\\times 10^3$，$1\\leq m,n\\leq 200$，$1\\leq h\\leq 20$，$0\\leq v_{i,j}\\leq 255$。", "locale": "zh-CN"}}}
{"pid": "P3190", "type": "P", "difficulty": 7, "samples": [["4 4\n100 300 -400 400\n-100 1000 1000 1000\n-100 -100 -100 -100\n-100 -100 -100 1000", "4000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2007", "各省省选", "湖南", "轮廓线 DP"], "title": "[HNOI2007] 神奇游乐园", "background": "", "description": "经历了一段艰辛的旅程后，主人公小 P 乘坐飞艇返回。在返回的途中，小 P 发现在漫无边际的沙漠中，有一块狭长的绿地特别显眼。往下仔细一看，才发现这是一个游乐场，专为旅途中疲惫的人设计。\n\n娱乐场可以看成是一块大小为 $n\\times m$ 的区域，且这个 $n\\times m$ 的区域被分成 $n\\times m$ 个小格子，每个小格子中就有一个娱乐项目。\n\n然而，小 P 并不喜欢其中的所有娱乐项目，于是，他给每个项目一个满意度。满意度为正时表示小 P 喜欢这个项目，值越大表示越喜欢。为负时表示他不喜欢，这个负数的绝对值越大表示他越不喜欢。为 $0$ 时表示他对这个项目没有喜恶。\n\n小 P 决定将飞艇停在某个小格中，然后每步他可以移动到相邻的上下左右四个格子的某个格子中。\n\n小 P 希望找一条路径，从飞艇所在格出发，最后又回到这个格子。\n\n小 P 有一个习惯，从不喜欢浪费时间。因此，他希望经过每个格子都是有意义的：他到一个地方后，就一定要感受以下那里的惊险和刺激，不管自己是不是喜欢那里的娱乐项目。而且，除了飞艇所在格，其他的格子他不愿意经过两次。小 P 希望自己至少要经过四个格子。\n\n在满足这些条件的情况下，小 P 希望自己玩过的娱乐项目的满意度之和最高。你能帮他找到这个最高的满意度之和吗？", "inputFormat": "第一行为两个正整数 $n$ 和 $m$，表示游乐场的大小为 $n\\times m$。\n\n接下来的 $n$ 行，每行有 $m$ 个整数，第 $(i + 1)$ 行的第 $j$ 个数表示游乐场的第 $i$ 行第 $j$ 列的小格子中的娱乐项目的满意度 $a_{i,j}$。同一行的两个整数之间用空格隔开。", "outputFormat": "仅一行为一个整数，表示最高的满意度之和。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $2\\leq n\\leq 100$，$2\\leq m\\leq 6$，$-10^3\\leq a_{i,j}\\leq 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Magical Amusement Park", "background": "", "description": "After a tough journey, the protagonist Xiao P returns by airship. On the way back, he notices a long and narrow green patch standing out in the boundless desert. Looking closer, he realizes it is an amusement park designed for weary travelers.\n\nThe amusement park can be regarded as an area of size $n\\times m$, and this $n\\times m$ area is divided into $n\\times m$ small grid cells, with one attraction in each cell.\n\nHowever, Xiao P does not like all the attractions, so he assigns a satisfaction score to each one. A positive satisfaction means Xiao P likes this attraction, and the larger the value, the more he likes it. A negative value means he dislikes it, and the larger the absolute value, the more he dislikes it. A value of $0$ means he is neutral.\n\nXiao P decides to park the airship in some cell, and at each step he can move to one of the four adjacent cells: up, down, left, or right.\n\nXiao P wants to find a path that starts from the cell where the airship is parked and finally returns to that same cell.\n\nXiao P has a habit of not wasting time. Therefore, he wants every visited cell to be meaningful: whenever he reaches a place, he must experience the thrill there, whether or not he likes that attraction. Moreover, except for the cell where the airship is parked, he is unwilling to pass through any other cell twice. Xiao P wants to visit at least four cells.\n\nUnder these conditions, Xiao P hopes the sum of the satisfaction scores of the attractions he experiences is as large as possible. Can you help him find this maximum sum?", "inputFormat": "The first line contains two positive integers $n$ and $m$, indicating the amusement park has size $n\\times m$.\n\nThe next $n$ lines each contain $m$ integers. In the $(i + 1)$-th line, the $j$-th number represents the satisfaction score $a_{i,j}$ of the attraction in row $i$, column $j$ of the amusement park. Two integers in the same line are separated by a space.", "outputFormat": "A single line containing one integer, the maximum possible sum of satisfaction scores.", "hint": "#### Constraints\n\nFor $100\\%$ of the data, it is guaranteed that $2\\leq n\\leq 100$, $2\\leq m\\leq 6$, $-10^3\\leq a_{i,j}\\leq 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 神奇游乐园", "background": "", "description": "经历了一段艰辛的旅程后，主人公小 P 乘坐飞艇返回。在返回的途中，小 P 发现在漫无边际的沙漠中，有一块狭长的绿地特别显眼。往下仔细一看，才发现这是一个游乐场，专为旅途中疲惫的人设计。\n\n娱乐场可以看成是一块大小为 $n\\times m$ 的区域，且这个 $n\\times m$ 的区域被分成 $n\\times m$ 个小格子，每个小格子中就有一个娱乐项目。\n\n然而，小 P 并不喜欢其中的所有娱乐项目，于是，他给每个项目一个满意度。满意度为正时表示小 P 喜欢这个项目，值越大表示越喜欢。为负时表示他不喜欢，这个负数的绝对值越大表示他越不喜欢。为 $0$ 时表示他对这个项目没有喜恶。\n\n小 P 决定将飞艇停在某个小格中，然后每步他可以移动到相邻的上下左右四个格子的某个格子中。\n\n小 P 希望找一条路径，从飞艇所在格出发，最后又回到这个格子。\n\n小 P 有一个习惯，从不喜欢浪费时间。因此，他希望经过每个格子都是有意义的：他到一个地方后，就一定要感受以下那里的惊险和刺激，不管自己是不是喜欢那里的娱乐项目。而且，除了飞艇所在格，其他的格子他不愿意经过两次。小 P 希望自己至少要经过四个格子。\n\n在满足这些条件的情况下，小 P 希望自己玩过的娱乐项目的满意度之和最高。你能帮他找到这个最高的满意度之和吗？", "inputFormat": "第一行为两个正整数 $n$ 和 $m$，表示游乐场的大小为 $n\\times m$。\n\n接下来的 $n$ 行，每行有 $m$ 个整数，第 $(i + 1)$ 行的第 $j$ 个数表示游乐场的第 $i$ 行第 $j$ 列的小格子中的娱乐项目的满意度 $a_{i,j}$。同一行的两个整数之间用空格隔开。", "outputFormat": "仅一行为一个整数，表示最高的满意度之和。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $2\\leq n\\leq 100$，$2\\leq m\\leq 6$，$-10^3\\leq a_{i,j}\\leq 10^3$。", "locale": "zh-CN"}}}
{"pid": "P3191", "type": "P", "difficulty": 6, "samples": [["5 5\nXXXXX\nX...D\nXX.XX\nX..XX\nXXDXX", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2007", "二分", "各省省选", "网络流", "湖南"], "title": "[HNOI2007] 紧急疏散（EVACUATE）", "background": null, "description": "发生了火警，所有人员需要紧急疏散！\n\n假设这个房间是一个 $N \\times M$ 的矩形区域。每个格子有三个状态：\n\n- 一块空地，可以通行，用 `.` 表示。\n- 一面墙，不可以通行，用 `X` 表示。\n- 一扇门，人们可以从这里撤出房间，用 `D` 表示。\n\n已知门一定在房间的边界上，并且边界上不会有空地。\n\n最初，每块空地上都有一个人。疏散开始后，每块空地上就没有人数限制了（也就是说每块空地可以同时站无数个人）。\n\n在疏散的时候，每一秒钟每个人都可以向上 / 下 / 左 / 右四个方向移动一格，当然他也可以站着不动。\n\n由于门很窄，每一秒钟只能有一个人移动到门的位置，一旦移动到门的位置，就表示他已经安全撤离了。\n\n现在的问题是：如果希望所有的人安全撤离，最短需要多少时间？或者告知根本不可能。", "inputFormat": "输入文件第一行是由空格隔开的一对正整数 $N,M$（$3 \\le N,M \\le 20$）。\n\n下面 $N$ 行 $M$ 列是一个 $N\\times M$ 的字符矩阵（其中的元素可为字符 `.`、`X` 或 `D`，且字符间无空格），描述这个房间中每个格子的状态。", "outputFormat": "只有一个整数 $K$，表示让所有人安全撤离的最短时间。\n\n如果不可能让所有人安全撤离，那么输出 `impossible`。", "hint": "Update on 2015.1.12：新加数据一组。鸣谢：1756500824\n\n对于 C++ 语言，请使用 `scanf` 读入字符矩阵！", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Emergency Evacuation (EVACUATE)", "background": "", "description": "A fire has broken out, and everyone must evacuate immediately.\n\nAssume the room is an $N \\times M$ rectangular area. Each cell is one of the following:\n- An empty cell, passable, denoted by `.`.\n- A wall, impassable, denoted by `X`.\n- A door, through which people can leave the room, denoted by `D`.\n\nDoors are guaranteed to be on the boundary of the room, and there is no empty cell on the boundary.\n\nInitially, each empty cell contains exactly one person. After the evacuation starts, there is no capacity limit per empty cell (that is, any number of people may stand on the same empty cell simultaneously).\n\nDuring the evacuation, in each second, each person may move one cell up, down, left, or right; they may also stay in place.\n\nBecause a door is narrow, in any one second at most one person can move onto a door cell. Once a person moves onto a door cell, they are considered safely evacuated.\n\nQuestion: if we want everyone to evacuate safely, what is the minimum time required? Or state that it is impossible.", "inputFormat": "The first line contains a pair of space-separated positive integers $N, M$ ($3 \\le N, M \\le 20$).\n\nThe next $N$ lines, each containing $M$ characters, form an $N \\times M$ character matrix (each character is one of `.`/`X`/`D`, with no spaces between characters), describing the state of every cell in the room.", "outputFormat": "Output a single integer $K$, the minimum time required for everyone to evacuate safely.\n\nIf it is impossible for everyone to evacuate safely, output `impossible`.", "hint": "Update on 2015.1.12: Added one new set of testdata. Thanks to: 1756500824.\n\nFor the C++ language, please use scanf to read the character matrix.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 紧急疏散（EVACUATE）", "background": null, "description": "发生了火警，所有人员需要紧急疏散！\n\n假设这个房间是一个 $N \\times M$ 的矩形区域。每个格子有三个状态：\n\n- 一块空地，可以通行，用 `.` 表示。\n- 一面墙，不可以通行，用 `X` 表示。\n- 一扇门，人们可以从这里撤出房间，用 `D` 表示。\n\n已知门一定在房间的边界上，并且边界上不会有空地。\n\n最初，每块空地上都有一个人。疏散开始后，每块空地上就没有人数限制了（也就是说每块空地可以同时站无数个人）。\n\n在疏散的时候，每一秒钟每个人都可以向上 / 下 / 左 / 右四个方向移动一格，当然他也可以站着不动。\n\n由于门很窄，每一秒钟只能有一个人移动到门的位置，一旦移动到门的位置，就表示他已经安全撤离了。\n\n现在的问题是：如果希望所有的人安全撤离，最短需要多少时间？或者告知根本不可能。", "inputFormat": "输入文件第一行是由空格隔开的一对正整数 $N,M$（$3 \\le N,M \\le 20$）。\n\n下面 $N$ 行 $M$ 列是一个 $N\\times M$ 的字符矩阵（其中的元素可为字符 `.`、`X` 或 `D`，且字符间无空格），描述这个房间中每个格子的状态。", "outputFormat": "只有一个整数 $K$，表示让所有人安全撤离的最短时间。\n\n如果不可能让所有人安全撤离，那么输出 `impossible`。", "hint": "Update on 2015.1.12：新加数据一组。鸣谢：1756500824\n\n对于 C++ 语言，请使用 `scanf` 读入字符矩阵！", "locale": "zh-CN"}}}
{"pid": "P3192", "type": "P", "difficulty": 7, "samples": [["0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 2 0 0 0 0 0\n0 0 0 0 0 0 0 2 0 2 0 0 0 0 0\n0 0 0 0 0 0 2 1 1 2 0 0 0 0 0\n0 0 0 0 0 0 0 1 2 1 0 0 0 0 0\n0 0 0 0 0 0 2 1 1 1 1 2 0 0 0\n0 0 0 0 0 0 0 1 0 1 0 1 0 0 0\n0 0 0 0 0 0 2 2 0 1 1 0 2 0 0\n0 0 0 0 0 0 0 0 0 2 0 2 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0", "3 2\n10 9\n10 11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2007", "各省省选", "湖南"], "title": "[HNOI2007] 胜负一子", "background": "", "description": "五子棋是一种流传很广的棋类游戏，在一个 $15\\times 15$ 的棋盘上，对弈双方执黑白棋子（类似于围棋），执黑子者先下，凡落下的棋子不能被提起，即不存在挪子和吃子的情况。\n\n为了简化问题，假设黑方不存在“禁手”，“禁手”是五子棋术语，指禁止走棋子的地方。当某选手的棋子在横、竖、$45$ 度斜线方向、$135$ 度斜线方向之一先出现相连的 $5$ 个棋子时，该选手获胜。\n\n先考虑轮到黑棋走的一盘残局，请给出黑棋获胜的最少步数和在该步数下能获胜的所有不同的下一步走法。", "inputFormat": "共有 $15$ 行，每行有 $15$ 个由一个空格隔开的整数。第 $i$ 行，第 $j$ 列的整数记做 $v_{i,j}$，用 $v_{i,j}=0,1,2$ 表示第 $i$ 行，第 $j$ 列的位置为空、为黑子、为白子，从左上角开始，按从左至右，自上而下的顺序输入，即输入的第 $1$ 行第 $1$ 列整数 $v_{1,1}$ 表示第 $1$ 行第 $1$ 列位置的状态，输入的第 $15$ 行第 $15$ 列整数 $v_{15,15}$ 表示第 $15$ 行第 $15$ 列位置的状态。", "outputFormat": "第一行为两个整数 $a$ 和 $b$，其中：$a$ 表示黑棋获胜的最少步数，$b$ 表示黑棋在 $a$ 步获胜的所有不同的下一步走法的种数。\n\n从第二行到第 $b+1$ 行，每行有两个整数，分别表示黑棋在 $a$ 步获胜的一种下一步走法落子位置的行数 $i$ 和列数 $j$，要求这些走法按照 $15\\times i+j$ 的大小从小到大排列。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] A Single Stone Decides the Game", "background": "", "description": "Gomoku is a widely played board game. On a $15\\times 15$ board, two players play with black and white stones (similar to Go). Black moves first. Once a stone is placed, it cannot be lifted; that is, there are no moving or capturing moves.\n\nTo simplify the problem, assume there are no “forbidden moves” for Black. “Forbidden moves” is a Gomoku term referring to places where a move is not allowed. When a player first forms a connected line of $5$ stones in one of the horizontal, vertical, $45$-degree diagonal, or $135$-degree diagonal directions, that player wins.\n\nConsider an endgame position with Black to move. Please output the minimum number of moves for Black to win and all distinct next moves that allow Black to win in that number of moves.", "inputFormat": "There are $15$ lines, each containing $15$ integers separated by a space. Let the integer in the $i$-th row and the $j$-th column be $v_{i,j}$. Use $v_{i,j}=0,1,2$ to indicate that the position at row $i$, column $j$ is empty, has a black stone, or has a white stone, respectively. Input is given from the top-left corner, in left-to-right and top-to-bottom order. That is, the first integer $v_{1,1}$ represents the state of row $1$, column $1$, and the last integer $v_{15,15}$ represents the state of row $15$, column $15$.", "outputFormat": "The first line contains two integers $a$ and $b$, where $a$ is the minimum number of moves for Black to win, and $b$ is the number of distinct next moves by which Black can win in $a$ moves.\n\nFrom the second line to the $(b+1)$-th line, each line contains two integers that represent a row $i$ and a column $j$ for one such next move by Black that leads to a win in $a$ moves. These moves must be sorted in ascending order by $15\\times i+j$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 胜负一子", "background": "", "description": "五子棋是一种流传很广的棋类游戏，在一个 $15\\times 15$ 的棋盘上，对弈双方执黑白棋子（类似于围棋），执黑子者先下，凡落下的棋子不能被提起，即不存在挪子和吃子的情况。\n\n为了简化问题，假设黑方不存在“禁手”，“禁手”是五子棋术语，指禁止走棋子的地方。当某选手的棋子在横、竖、$45$ 度斜线方向、$135$ 度斜线方向之一先出现相连的 $5$ 个棋子时，该选手获胜。\n\n先考虑轮到黑棋走的一盘残局，请给出黑棋获胜的最少步数和在该步数下能获胜的所有不同的下一步走法。", "inputFormat": "共有 $15$ 行，每行有 $15$ 个由一个空格隔开的整数。第 $i$ 行，第 $j$ 列的整数记做 $v_{i,j}$，用 $v_{i,j}=0,1,2$ 表示第 $i$ 行，第 $j$ 列的位置为空、为黑子、为白子，从左上角开始，按从左至右，自上而下的顺序输入，即输入的第 $1$ 行第 $1$ 列整数 $v_{1,1}$ 表示第 $1$ 行第 $1$ 列位置的状态，输入的第 $15$ 行第 $15$ 列整数 $v_{15,15}$ 表示第 $15$ 行第 $15$ 列位置的状态。", "outputFormat": "第一行为两个整数 $a$ 和 $b$，其中：$a$ 表示黑棋获胜的最少步数，$b$ 表示黑棋在 $a$ 步获胜的所有不同的下一步走法的种数。\n\n从第二行到第 $b+1$ 行，每行有两个整数，分别表示黑棋在 $a$ 步获胜的一种下一步走法落子位置的行数 $i$ 和列数 $j$，要求这些走法按照 $15\\times i+j$ 的大小从小到大排列。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3193", "type": "P", "difficulty": 5, "samples": [["4 3 100\n111", "81"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2008", "各省省选", "湖南", "矩阵乘法", "KMP 算法"], "title": "[HNOI2008] GT考试", "background": "", "description": "阿申准备报名参加 GT 考试，准考证号为 $N$ 位数$X_1,X_2…X_n\\ (0\\le X_i\\le 9)$，他不希望准考证号上出现不吉利的数字。\n他的不吉利数字$A_1,A_2,\\cdots, A_m\\ (0\\le A_i\\le 9)$ 有 $M$ 位，不出现是指 $X_1,X_2\\cdots X_n$ 中没有一段恰好等于 $A_1,A_2,\\cdots ,A_m$，$A_1$ 和 $X_1$ 可以为 $0$。", "inputFormat": "第一行输入 $N,M,K$ 接下来一行输入 $M$ 位的数。", "outputFormat": "阿申想知道不出现不吉利数字的号码有多少种，输出模 $K$ 取余的结果。", "hint": "### 数据范围及约定\n\n对于全部数据，$N\\leq10^9$，$M\\leq 20$，$K\\leq10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] GT Exam", "background": "", "description": "Ashen is preparing to register for the GT Exam. His examinee number is an $N$-digit sequence $X_1,X_2…X_n\\ (0\\le X_i\\le 9)$, and he does not want any unlucky number to appear in it.\nHis unlucky number is an $M$-digit sequence $A_1,A_2,\\cdots, A_m\\ (0\\le A_i\\le 9)$. “Does not appear” means that in $X_1,X_2\\cdots X_n$ there is no contiguous segment exactly equal to $A_1,A_2,\\cdots ,A_m$. Both $A_1$ and $X_1$ may be $0$.", "inputFormat": "The first line contains $N,M,K$. The next line contains an $M$-digit number.", "outputFormat": "Ashen wants to know how many examinee numbers do not contain the unlucky number. Output the result modulo $K$.", "hint": "### Constraints\n\nFor all testdata, $N\\leq10^9$, $M\\leq 20$, $K\\leq10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] GT考试", "background": "", "description": "阿申准备报名参加 GT 考试，准考证号为 $N$ 位数$X_1,X_2…X_n\\ (0\\le X_i\\le 9)$，他不希望准考证号上出现不吉利的数字。\n他的不吉利数字$A_1,A_2,\\cdots, A_m\\ (0\\le A_i\\le 9)$ 有 $M$ 位，不出现是指 $X_1,X_2\\cdots X_n$ 中没有一段恰好等于 $A_1,A_2,\\cdots ,A_m$，$A_1$ 和 $X_1$ 可以为 $0$。", "inputFormat": "第一行输入 $N,M,K$ 接下来一行输入 $M$ 位的数。", "outputFormat": "阿申想知道不出现不吉利数字的号码有多少种，输出模 $K$ 取余的结果。", "hint": "### 数据范围及约定\n\n对于全部数据，$N\\leq10^9$，$M\\leq 20$，$K\\leq10000$。", "locale": "zh-CN"}}}
{"pid": "P3194", "type": "P", "difficulty": 5, "samples": [["3\n-1 0\n1 0\n0 0", "1 2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2008", "各省省选", "湖南", "栈", "凸包"], "title": "[HNOI2008] 水平可见直线", "background": "", "description": "在 $x-y$ 直角坐标平面上有 $n$ 条直线 $L_1,L_2,…L_n$，若在 $y$ 值为正无穷大处往下看，能见到 $L_i$ 的某个子线段，则称 $L_i$ 为可见的，否则 $L_i$ 为被覆盖的。\n例如，对于直线:\n$L_1:y=x$;\n$L_2:y=-x$;\n$L_3:y=0$;\n则 $L_1$ 和 $L_2$ 是可见的，$L_3$ 是被覆盖的。给出 $n$ 条直线，表示成 $y=Ax+B$ 的形式($|A|,|B| \\le 500000$)，且 $n$ 条直线两两不重合，求出所有可见的直线。", "inputFormat": "第一行为 $N$ ($0<N\\leq50000$)，接下来的 $N$ 行输入 $A_i,B_i$", "outputFormat": "从小到大输出可见直线的编号，两两中间用空格隔开，最后一个数字后面也必须有个空格。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] Horizontally Visible Lines", "background": "", "description": "On the $x-y$ Cartesian coordinate plane, there are $n$ lines $L_1, L_2, \\dots, L_n$. If, when looking downward from $y = +\\infty$, some subsegment of $L_i$ is visible, we say that $L_i$ is visible; otherwise, $L_i$ is covered.\nFor example, for the lines:\n$L_1: y = x$;\n$L_2: y = -x$;\n$L_3: y = 0$;\nthen $L_1$ and $L_2$ are visible, and $L_3$ is covered. Given $n$ lines in the form $y = A x + B$ ($|A|, |B| \\le 500000$), and no two lines coincide, find all visible lines.", "inputFormat": "The first line contains $N$ ($0 < N < 50000$). The next $N$ lines each contain $A_i, B_i$.", "outputFormat": "Output the indices of the visible lines in increasing order, separated by spaces. There must also be a space after the last number.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 水平可见直线", "background": "", "description": "在 $x-y$ 直角坐标平面上有 $n$ 条直线 $L_1,L_2,…L_n$，若在 $y$ 值为正无穷大处往下看，能见到 $L_i$ 的某个子线段，则称 $L_i$ 为可见的，否则 $L_i$ 为被覆盖的。\n例如，对于直线:\n$L_1:y=x$;\n$L_2:y=-x$;\n$L_3:y=0$;\n则 $L_1$ 和 $L_2$ 是可见的，$L_3$ 是被覆盖的。给出 $n$ 条直线，表示成 $y=Ax+B$ 的形式($|A|,|B| \\le 500000$)，且 $n$ 条直线两两不重合，求出所有可见的直线。", "inputFormat": "第一行为 $N$ ($0<N\\leq50000$)，接下来的 $N$ 行输入 $A_i,B_i$", "outputFormat": "从小到大输出可见直线的编号，两两中间用空格隔开，最后一个数字后面也必须有个空格。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3195", "type": "P", "difficulty": 6, "samples": [["5 4\n3\n4\n2\n1\n4", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "各省省选", "单调队列", "湖南", "斜率优化"], "title": "[HNOI2008] 玩具装箱", "background": null, "description": "P 教授要去看奥运，但是他舍不下他的玩具，于是他决定把所有的玩具运到北京。他使用自己的压缩器进行压缩，其可以将任意物品变成一维，再放到一种特殊的一维容器中。\n\nP 教授有编号为 $1 \\cdots n$ 的 $n$ 件玩具，第 $i$ 件玩具经过压缩后的一维长度为 $C_i$。\n\n为了方便整理，P 教授要求：\n\n- 在一个一维容器中的玩具编号是连续的。\n\n- 同时如果一个一维容器中有多个玩具，那么两件玩具之间要加入一个单位长度的填充物。形式地说，如果将第 $i$ 件玩具到第 $j$ 个玩具放到一个容器中，那么容器的长度将为 $x=j-i+\\sum\\limits_{k=i}^{j}C_k$。\n\n制作容器的费用与容器的长度有关，根据教授研究，如果容器长度为 $x$，其制作费用为 $(x-L)^2$。其中 $L$ 是一个常量。P 教授不关心容器的数目，他可以制作出任意长度的容器，甚至超过 $L$。但他希望所有容器的总费用最小。", "inputFormat": "第一行有两个整数，用一个空格隔开，分别代表 $n$ 和 $L$。\n\n第 $2$ 到 第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数代表第 $i$ 件玩具的长度 $C_i$。", "outputFormat": "输出一行一个整数，代表所有容器的总费用最小是多少。", "hint": "对于全部的测试点，$1 \\leq n \\leq 5 \\times 10^4$，$1 \\leq L \\leq 10^7$，$1 \\leq C_i \\leq 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] Toy Packing", "background": "", "description": "Professor P is going to watch the Olympics, but he cannot part with his toys, so he decides to ship all his toys to Beijing. He uses his own compressor, which can compress any item into a lump and then place it into a special one-dimensional container.\n\nProfessor P has $n$ toys numbered $1 \\cdots n$. After compression, the one-dimensional length of the $i$-th toy is $C_i$.\n\nTo organize them conveniently, Professor P requires:\n- The toy indices in a one-dimensional container must be consecutive.\n- Additionally, if a container holds more than one toy, a unit-length filler must be added between any two adjacent toys. Formally, if toys $i$ through $j$ are placed in one container, the container length is $x=j-i+\\sum\\limits_{k=i}^{j}C_k$.\n\nThe manufacturing cost of a container depends on its length. According to the professor’s study, if a container has length $x$, its cost is $(x-L)^2$, where $L$ is a constant. Professor P does not care about the number of containers; he can make containers of any length, even exceeding $L$. He wants the total cost of all containers to be minimized.", "inputFormat": "The first line contains two integers separated by a space, denoting $n$ and $L$.\n\nLines $2$ to $(n + 1)$ each contain one integer. Line $(i + 1)$ contains the length $C_i$ of the $i$-th toy.", "outputFormat": "Output a single integer on one line, the minimum possible total cost of all containers.", "hint": "For all test points, $1 \\leq n \\leq 5 \\times 10^4$, $1 \\leq L \\leq 10^7$, $1 \\leq C_i \\leq 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 玩具装箱", "background": null, "description": "P 教授要去看奥运，但是他舍不下他的玩具，于是他决定把所有的玩具运到北京。他使用自己的压缩器进行压缩，其可以将任意物品变成一维，再放到一种特殊的一维容器中。\n\nP 教授有编号为 $1 \\cdots n$ 的 $n$ 件玩具，第 $i$ 件玩具经过压缩后的一维长度为 $C_i$。\n\n为了方便整理，P 教授要求：\n\n- 在一个一维容器中的玩具编号是连续的。\n\n- 同时如果一个一维容器中有多个玩具，那么两件玩具之间要加入一个单位长度的填充物。形式地说，如果将第 $i$ 件玩具到第 $j$ 个玩具放到一个容器中，那么容器的长度将为 $x=j-i+\\sum\\limits_{k=i}^{j}C_k$。\n\n制作容器的费用与容器的长度有关，根据教授研究，如果容器长度为 $x$，其制作费用为 $(x-L)^2$。其中 $L$ 是一个常量。P 教授不关心容器的数目，他可以制作出任意长度的容器，甚至超过 $L$。但他希望所有容器的总费用最小。", "inputFormat": "第一行有两个整数，用一个空格隔开，分别代表 $n$ 和 $L$。\n\n第 $2$ 到 第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数代表第 $i$ 件玩具的长度 $C_i$。", "outputFormat": "输出一行一个整数，代表所有容器的总费用最小是多少。", "hint": "对于全部的测试点，$1 \\leq n \\leq 5 \\times 10^4$，$1 \\leq L \\leq 10^7$，$1 \\leq C_i \\leq 10^7$。", "locale": "zh-CN"}}}
{"pid": "P3196", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2\n1 4\n2 4\n2 3\n3 4", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "湖南", "广度优先搜索 BFS", "哈希 hashing", "弦图"], "title": "[HNOI2008] 神奇的国度", "background": "", "description": "K国是一个热衷三角形的国度,连人的交往也只喜欢三角原则.他们认为三角关系:即AB相互认识,BC相互认识,CA相互认识,是简洁高效的.为了巩固三角关系,K国禁止四边关系,五边关系等等的存在.\n\n所谓N边关系,是指N个人 A1A2...An之间仅存在N对认识关系:(A1A2)(A2A3)...(AnA1),而没有其它认识关系.比如四边关系指ABCD四个人 AB,BC,CD,DA相互认识,而AC,BD不认识.全民比赛时,为了防止做弊，规定任意一对相互认识的人不得在一队，国王相知道，最少可以分多少支队。\n", "inputFormat": "第一行两个整数N，M。1<=N<=10000,1<=M<=1000000.表示有N个人，M对认识关系. 接下来M行每行输入一对朋友\n", "outputFormat": "输出一个整数，最少可以分多少队\n", "hint": "一种方案(1,3)(2)(4)\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] A Magical Country", "background": "", "description": "Country K is obsessed with triangles; even interpersonal relationships follow a triangle principle. They consider a triangle relationship—namely, $A B$, $B C$, and $C A$ are mutually acquainted—to be simple and efficient. To reinforce triangle relationships, Country K forbids the existence of four-cycle relationships, five-cycle relationships, and so on.\n\nAn $N$-cycle relationship means that among $N$ people $A_1, A_2, \\ldots, A_n$, there exist exactly $N$ acquaintance pairs: $(A_1, A_2)$, $(A_2, A_3)$, $\\ldots$, $(A_n, A_1)$, and no other acquaintance pairs among them. For example, a four-cycle relationship means that among $A, B, C, D$, the pairs $(A, B)$, $(B, C)$, $(C, D)$, $(D, A)$ are mutually acquainted, while $(A, C)$ and $(B, D)$ are not acquainted.\n\nDuring a national contest, to prevent cheating, it is required that any two people who are acquainted must not be placed on the same team. The king wants to know the minimum number of teams needed.", "inputFormat": "The first line contains two integers $N$ and $M$ ($1 \\le N \\le 10000$, $1 \\le M \\le 1000000$), indicating there are $N$ people and $M$ acquaintance pairs. The next $M$ lines each contain one pair of friends.", "outputFormat": "Output a single integer: the minimum number of teams.", "hint": "One possible arrangement: (1, 3) (2) (4).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 神奇的国度", "background": "", "description": "K国是一个热衷三角形的国度,连人的交往也只喜欢三角原则.他们认为三角关系:即AB相互认识,BC相互认识,CA相互认识,是简洁高效的.为了巩固三角关系,K国禁止四边关系,五边关系等等的存在.\n\n所谓N边关系,是指N个人 A1A2...An之间仅存在N对认识关系:(A1A2)(A2A3)...(AnA1),而没有其它认识关系.比如四边关系指ABCD四个人 AB,BC,CD,DA相互认识,而AC,BD不认识.全民比赛时,为了防止做弊，规定任意一对相互认识的人不得在一队，国王相知道，最少可以分多少支队。\n", "inputFormat": "第一行两个整数N，M。1<=N<=10000,1<=M<=1000000.表示有N个人，M对认识关系. 接下来M行每行输入一对朋友\n", "outputFormat": "输出一个整数，最少可以分多少队\n", "hint": "一种方案(1,3)(2)(4)\n", "locale": "zh-CN"}}}
{"pid": "P3197", "type": "P", "difficulty": 3, "samples": [["2 3\n", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2008", "各省省选", "湖南", "O2优化", "组合数学", "容斥原理"], "title": "[HNOI2008] 越狱", "background": "", "description": "监狱有 $n$ 个房间，每个房间关押一个犯人，有 $m$ 种宗教，每个犯人会信仰其中一种。如果相邻房间的犯人的宗教相同，就可能发生越狱，求有多少种状态可能发生越狱。\n\n答案对 $100,003$ 取模。", "inputFormat": "输入只有一行两个整数，分别代表宗教数 $m$ 和房间数 $n$。", "outputFormat": "输出一行一个整数代表答案。", "hint": "#### 样例输入输出 1 解释\n\n| 状态编号 | 1 号房间 | 2 号房间 | 3 号房间 |\n| :--------: | :--------: | :-------: | :--------: |\n| 1 | 信仰 1 | 信仰 1 | 信仰 1 |\n| 2 | 信仰 1 | 信仰 1 | 信仰 2 |\n| 3 | 信仰 1 | 信仰 2 | 信仰 2 |\n| 4 | 信仰 2 | 信仰 1 | 信仰 1 |\n| 5 | 信仰 2 | 信仰 2 | 信仰 2 |\n| 6 | 信仰 2 | 信仰 2 | 信仰 1 |\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\le m \\le 10^8$，$1 \\le n \\le 10^{12}$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] Prison Break", "background": "", "description": "There are $n$ rooms in the prison, with one prisoner in each room. There are $m$ religions, and each prisoner believes in exactly one of them. If prisoners in adjacent rooms have the same religion, a prison break may occur. Count how many states may lead to a prison break.\n\nOutput the answer modulo $100{,}003$.", "inputFormat": "The input contains a single line with two integers, the number of religions $m$ and the number of rooms $n$.", "outputFormat": "Output a single integer on one line representing the answer.", "hint": "#### Sample Input/Output 1 Explanation\n\n| State ID | Room 1 | Room 2 | Room 3 |\n| :--------: | :--------: | :-------: | :--------: |\n| 1 | Religion 1 | Religion 1 | Religion 1 |\n| 2 | Religion 1 | Religion 1 | Religion 2 |\n| 3 | Religion 1 | Religion 2 | Religion 2 |\n| 4 | Religion 2 | Religion 1 | Religion 1 |\n| 5 | Religion 2 | Religion 2 | Religion 2 |\n| 6 | Religion 2 | Religion 2 | Religion 1 |\n\n#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le m \\le 10^8$, $1 \\le n \\le 10^{12}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 越狱", "background": "", "description": "监狱有 $n$ 个房间，每个房间关押一个犯人，有 $m$ 种宗教，每个犯人会信仰其中一种。如果相邻房间的犯人的宗教相同，就可能发生越狱，求有多少种状态可能发生越狱。\n\n答案对 $100,003$ 取模。", "inputFormat": "输入只有一行两个整数，分别代表宗教数 $m$ 和房间数 $n$。", "outputFormat": "输出一行一个整数代表答案。", "hint": "#### 样例输入输出 1 解释\n\n| 状态编号 | 1 号房间 | 2 号房间 | 3 号房间 |\n| :--------: | :--------: | :-------: | :--------: |\n| 1 | 信仰 1 | 信仰 1 | 信仰 1 |\n| 2 | 信仰 1 | 信仰 1 | 信仰 2 |\n| 3 | 信仰 1 | 信仰 2 | 信仰 2 |\n| 4 | 信仰 2 | 信仰 1 | 信仰 1 |\n| 5 | 信仰 2 | 信仰 2 | 信仰 2 |\n| 6 | 信仰 2 | 信仰 2 | 信仰 1 |\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\le m \\le 10^8$，$1 \\le n \\le 10^{12}$。", "locale": "zh-CN"}}}
{"pid": "P3198", "type": "P", "difficulty": 6, "samples": [["5 0.3\n3\n5\n6\n2\n4", "0.000000\n0.000000\n0.000000\n1.968750\n2.976000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "湖南", "Special Judge"], "title": "[HNOI2008] 遥远的行星", "background": null, "description": "直线上 $N$ 颗行星，$X=i$ 处有行星 $i$，行星 $J$ 受到行星 $I$ 的作用力，当且仅当 $i \\le A J$，此时 $J$ 受到作用力的大小为$F_{i->j}=\\frac{M_i \\times M_j}{j-i}$。\n\n其中 $A$ 为很小的常量，故直观上说每颗行星都只受到距离遥远的行星的作用。\n请计算每颗行星的受力，只要结果的相对误差不超过 5% 即可.", "inputFormat": "第一行两个整数 $N$ 和 $A$。  \n接下来 $N$ 行输入 $N$ 个行星的质量 $M_i$", "outputFormat": "$N$ 行，依次输出各行星的受力情况", "hint": "$1 \\le N \\le 10^5$  \n$0.01 < A \\le 0.35$  \n$0 \\le M_i \\le 10^7$", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] Distant Planets", "background": "", "description": "There are $N$ planets on a line; planet $i$ is located at position $X = i$. Planet $J$ is affected by the force from planet $I$ if and only if $i \\le A J$. In this case, the magnitude of the force on $J$ is $F_{i->j}=\\frac{M_i \\times M_j}{j-i}$.\n\nHere $A$ is a very small constant, so intuitively each planet is only affected by planets that are far away. Compute the force on each planet. The answer is accepted if the relative error does not exceed 5%.", "inputFormat": "The first line contains an integer $N$ and a real number $A$.  \nThe next $N$ lines contain the masses $M_i$ of the $N$ planets.", "outputFormat": "Output $N$ lines, the force on each planet in order.", "hint": "$1 \\le N \\le 10^5$.  \n$0.01 < A \\le 0.35$.  \n$0 \\le M_i \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 遥远的行星", "background": null, "description": "直线上 $N$ 颗行星，$X=i$ 处有行星 $i$，行星 $J$ 受到行星 $I$ 的作用力，当且仅当 $i \\le A J$，此时 $J$ 受到作用力的大小为$F_{i->j}=\\frac{M_i \\times M_j}{j-i}$。\n\n其中 $A$ 为很小的常量，故直观上说每颗行星都只受到距离遥远的行星的作用。\n请计算每颗行星的受力，只要结果的相对误差不超过 5% 即可.", "inputFormat": "第一行两个整数 $N$ 和 $A$。  \n接下来 $N$ 行输入 $N$ 个行星的质量 $M_i$", "outputFormat": "$N$ 行，依次输出各行星的受力情况", "hint": "$1 \\le N \\le 10^5$  \n$0.01 < A \\le 0.35$  \n$0 \\le M_i \\le 10^7$", "locale": "zh-CN"}}}
{"pid": "P3199", "type": "P", "difficulty": 5, "samples": [["4 5\n1 2 5\n2 3 5\n3 1 5\n2 4 3\n4 1 3", "3.66666667"], ["2 2\n1 2 -2.9\n2 1 -3.1", "-3.00000000"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2009", "各省省选", "湖南", "深度优先搜索 DFS", "分数规划"], "title": "[HNOI2009] 最小圈", "background": "", "description": "考虑带权有向图 $G=(V,E)$ 以及 $w:E\\rightarrow \\R$，每条边 $e=(i,j)$（$i\\neq j$，$i, j\\in V$）的权值定义为 $w_{i,j}$。设 $n=|V|$。\n\n$c=(c_1,c_2,\\cdots,c_k)$（$c_i\\in V$）是 $G$ 中的一个圈当且仅当 $(c_i,c_{i+1})$（$1\\le i<k$）和 $(c_k,c_1)$ 都在 $E$ 中。称 $k$ 为圈 $c$ 的长度，同时记 $c_{k+1}=c_1$，并定义圈 $c=(c_1,c_2,\\cdots,c_k)$ 的平均值为\n$$\n\\mu(c)= \\frac 1 k \\sum\\limits_{i=1}^{k} w_{c_i,c_{i+1}}\n$$\n即 $c$ 上所有边的权值的平均值。设 $\\mu'(G)=\\min_c\\mu(c)$ 为 $G$ 中所有圈 $c$ 的平均值的最小值。\n\n给定图 $G=(V,E)$ 以及 $w:E\\rightarrow \\R$，求出 $G$ 中所有圈 $c$ 的平均值的最小值 $\\mu'(G)$。\n", "inputFormat": "第一行两个正整数，分别为 $n$ 和 $m$，并用一个空格隔开。其中 $n=|V|$，$m=|E|$ 分别表示图中有 $n$ 个点 和 $m$ 条边。\n\n接下来 $m$ 行，每行三个数 $i,j,w_{i,j}$，表示有一条边 $(i,j)$ 且该边的权值为 $w_{i,j}$，注意边权可以是实数。输入数据保证图 $G=(V,E)$ 连通，存在圈且有一个点能到达其他所有点。\n", "outputFormat": "一个实数 $\\mu'(G)$，要求精确到小数点后 $8$ 位。\n", "hint": "对于 $100\\%$ 的数据，$2\\leq n\\le 3000$，$1\\leq m\\le 10000$，$|w_{i,j}| \\le 10^7$，$1\\leq i, j\\leq n$ 且 $i\\neq j$。\n\n------------\n提示：本题存在 $O(nm)$ 的做法，但是 $O(nm\\log n)$ 的做法也可以通过。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2009] Minimum Mean Cycle", "background": "", "description": "Consider a weighted directed graph $G=(V,E)$ and $w: E \\rightarrow \\mathbb{R}$. Each edge $e=(i,j)$ ($i \\neq j$, $i, j \\in V$) has weight $w_{i,j}$. Let $n = |V|$.\n\nA sequence $c=(c_1, c_2, \\cdots, c_k)$ ($c_i \\in V$) is a cycle in $G$ if and only if $(c_i, c_{i+1})$ ($1 \\le i < k$) and $(c_k, c_1)$ are both in $E$. We call $k$ the length of cycle $c$, and set $c_{k+1} = c_1$. The average value of cycle $c=(c_1, c_2, \\cdots, c_k)$ is defined as\n$$\n\\mu(c)= \\frac 1 k \\sum\\limits_{i=1}^{k} w_{c_i,c_{i+1}}.\n$$\nLet $\\mu'(G)=\\min_c \\mu(c)$ be the minimum average value over all cycles $c$ in $G$.\n\nGiven $G=(V,E)$ and $w: E \\rightarrow \\mathbb{R}$, compute the minimum average value $\\mu'(G)$ over all cycles $c$ in $G$.", "inputFormat": "The first line contains two positive integers $n$ and $m$, separated by a space. Here $n = |V|$ and $m = |E|$ denote the number of vertices and edges, respectively.\n\nThe next $m$ lines each contain three numbers $i, j, w_{i,j}$, indicating there is an edge $(i, j)$ with weight $w_{i,j}$. Note that edge weights can be real numbers. The input guarantees that the graph $G=(V,E)$ is connected, contains at least one cycle, and there exists a vertex that can reach all other vertices.", "outputFormat": "Output a real number $\\mu'(G)$, printed with $8$ digits after the decimal point.", "hint": "- Constraints: For $100\\%$ of the testdata, $2 \\le n \\le 3000$, $1 \\le m \\le 10000$, $|w_{i,j}| \\le 10^7$, $1 \\le i, j \\le n$ and $i \\neq j$.\n- Note: There exists an $O(nm)$ solution; an $O(nm \\log n)$ solution also passes.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2009] 最小圈", "background": "", "description": "考虑带权有向图 $G=(V,E)$ 以及 $w:E\\rightarrow \\R$，每条边 $e=(i,j)$（$i\\neq j$，$i, j\\in V$）的权值定义为 $w_{i,j}$。设 $n=|V|$。\n\n$c=(c_1,c_2,\\cdots,c_k)$（$c_i\\in V$）是 $G$ 中的一个圈当且仅当 $(c_i,c_{i+1})$（$1\\le i<k$）和 $(c_k,c_1)$ 都在 $E$ 中。称 $k$ 为圈 $c$ 的长度，同时记 $c_{k+1}=c_1$，并定义圈 $c=(c_1,c_2,\\cdots,c_k)$ 的平均值为\n$$\n\\mu(c)= \\frac 1 k \\sum\\limits_{i=1}^{k} w_{c_i,c_{i+1}}\n$$\n即 $c$ 上所有边的权值的平均值。设 $\\mu'(G)=\\min_c\\mu(c)$ 为 $G$ 中所有圈 $c$ 的平均值的最小值。\n\n给定图 $G=(V,E)$ 以及 $w:E\\rightarrow \\R$，求出 $G$ 中所有圈 $c$ 的平均值的最小值 $\\mu'(G)$。\n", "inputFormat": "第一行两个正整数，分别为 $n$ 和 $m$，并用一个空格隔开。其中 $n=|V|$，$m=|E|$ 分别表示图中有 $n$ 个点 和 $m$ 条边。\n\n接下来 $m$ 行，每行三个数 $i,j,w_{i,j}$，表示有一条边 $(i,j)$ 且该边的权值为 $w_{i,j}$，注意边权可以是实数。输入数据保证图 $G=(V,E)$ 连通，存在圈且有一个点能到达其他所有点。\n", "outputFormat": "一个实数 $\\mu'(G)$，要求精确到小数点后 $8$ 位。\n", "hint": "对于 $100\\%$ 的数据，$2\\leq n\\le 3000$，$1\\leq m\\le 10000$，$|w_{i,j}| \\le 10^7$，$1\\leq i, j\\leq n$ 且 $i\\neq j$。\n\n------------\n提示：本题存在 $O(nm)$ 的做法，但是 $O(nm\\log n)$ 的做法也可以通过。", "locale": "zh-CN"}}}
{"pid": "P3200", "type": "P", "difficulty": 4, "samples": [["3 10", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "各省省选", "湖南", "素数判断,质数,筛法", "Catalan 数", "栈"], "title": "[HNOI2009] 有趣的数列", "background": null, "description": "我们称一个长度为 $2n$ 的数列是有趣的，当且仅当该数列满足以下三个条件：\n\n- 它是从 $1 \\sim 2n$ 共 $2n$ 个整数的一个排列 $\\{a_n\\}_{n=1}^{2n}$；\n\n- 所有的奇数项满足 $a_1<a_3< \\dots < a_{2n-1}$，所有的偶数项满足 $a_2<a_4< \\dots <a_{2n}$；\n\n- 任意相邻的两项 $a_{2i-1}$ 与 $a_{2i}$ 满足：$a_{2i-1}<a_{2i}$。\n\n对于给定的 $n$，请求出有多少个不同的长度为 $2n$ 的有趣的数列。  \n因为最后的答案可能很大，所以只要求输出答案对 $p$ 取模。", "inputFormat": "一行两个正整数 $n,p$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】   \n对于 $50\\%$ 的数据，$1\\le n \\le 1000$；  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^6$，$1\\le p \\le 10^9$。\n\n【样例解释】   \n对应的 $5$ 个有趣的数列分别为$(1,2,3,4,5,6),(1,2,3,5,4,6),(1,3,2,4,5,6),(1,3,2,5,4,6),(1,4,2,5,3,6)$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2009] Interesting Sequence", "background": "", "description": "We call a sequence of length $2n$ interesting if and only if it satisfies the following three conditions:\n- It is a permutation of the $2n$ integers from $1$ to $2n$, written as $a_1, a_2, \\dots, a_{2n}$.\n- All odd-indexed terms satisfy $a_1 < a_3 < \\dots < a_{2n-1}$, and all even-indexed terms satisfy $a_2 < a_4 < \\dots < a_{2n}$.\n- For every adjacent pair $a_{2i-1}$ and $a_{2i}$, it holds that $a_{2i-1} < a_{2i}$.\n\nFor a given $n$, find the number of different interesting sequences of length $2n$. Since the answer can be large, output the answer modulo $p$.", "inputFormat": "One line with two positive integers $n, p$.", "outputFormat": "Output a single integer on one line, the answer.", "hint": "Constraints  \nFor $50\\%$ of the testdata, $1 \\le n \\le 1000$.  \nFor $100\\%$ of the testdata, $1 \\le n \\le 10^6$, $1 \\le p \\le 10^9$.\n\nSample explanation  \nThe $5$ interesting sequences are (1, 2, 3, 4, 5, 6), (1, 2, 3, 5, 4, 6), (1, 3, 2, 4, 5, 6), (1, 3, 2, 5, 4, 6), (1, 4, 2, 5, 3, 6).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2009] 有趣的数列", "background": null, "description": "我们称一个长度为 $2n$ 的数列是有趣的，当且仅当该数列满足以下三个条件：\n\n- 它是从 $1 \\sim 2n$ 共 $2n$ 个整数的一个排列 $\\{a_n\\}_{n=1}^{2n}$；\n\n- 所有的奇数项满足 $a_1<a_3< \\dots < a_{2n-1}$，所有的偶数项满足 $a_2<a_4< \\dots <a_{2n}$；\n\n- 任意相邻的两项 $a_{2i-1}$ 与 $a_{2i}$ 满足：$a_{2i-1}<a_{2i}$。\n\n对于给定的 $n$，请求出有多少个不同的长度为 $2n$ 的有趣的数列。  \n因为最后的答案可能很大，所以只要求输出答案对 $p$ 取模。", "inputFormat": "一行两个正整数 $n,p$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】   \n对于 $50\\%$ 的数据，$1\\le n \\le 1000$；  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^6$，$1\\le p \\le 10^9$。\n\n【样例解释】   \n对应的 $5$ 个有趣的数列分别为$(1,2,3,4,5,6),(1,2,3,5,4,6),(1,3,2,4,5,6),(1,3,2,5,4,6),(1,4,2,5,3,6)$。", "locale": "zh-CN"}}}
{"pid": "P3201", "type": "P", "difficulty": 5, "samples": [["4 3\n1 2 2 1\n2\n1 2 1\n2\n", "3\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2009", "线段树", "各省省选", "平衡树", "湖南", "枚举", "线段树合并", "启发式合并"], "title": "[HNOI2009] 梦幻布丁", "background": "", "description": "$n$ 个布丁摆成一行，进行 $m$ 次操作。每次将某个颜色的布丁全部变成另一种颜色的，然后再询问当前一共有多少段颜色。\n\n例如，颜色分别为 $1,2,2,1$ 的四个布丁一共有 $3$ 段颜色.", "inputFormat": "第一行是两个整数，分别表示布丁个数 $n$ 和操作次数 $m$。  \n第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个布丁的颜色 $a_i$。  \n接下来 $m$ 行，每行描述一次操作。每行首先有一个整数 $op$ 表示操作类型：\n- 若 $op = 1$，则后有两个整数 $x, y$，表示将颜色 $x$ 的布丁全部变成颜色 $y$。\n- 若 $op = 2$，则表示一次询问。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n初始时布丁颜色依次为 $1, 2, 2, 1$，三段颜色分别为 $[1, 1], [2, 3], [4, 4]$。  \n一次操作后，布丁的颜色变为 $1, 1, 1, 1$，只有 $[1, 4]$ 一段颜色。\n\n### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq n, m \\leq 10^5$，$1 \\leq a_i ,x, y \\leq 10^6$。\n\n### 提示\n\n请注意，**不保证**颜色的编号不大于 $n$，也**不保证** $x \\neq y$，$m$ **不是**颜色的编号上限。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2009] Dream Pudding", "background": "", "description": "There are $n$ puddings in a line, and we will perform $m$ operations. An operation may recolor all puddings of one color into another color, or ask how many color segments there are at the moment.\n\nFor example, four puddings with colors $1, 2, 2, 1$ have $3$ color segments.", "inputFormat": "The first line contains two integers, the number of puddings $n$ and the number of operations $m$.  \nThe second line contains $n$ integers; the $i$-th integer is the color $a_i$ of the $i$-th pudding.  \nThen there are $m$ lines, each describing one operation. Each line starts with an integer $op$ indicating the type:\n- If $op = 1$, then two integers $x, y$ follow, meaning recolor all puddings of color $x$ to color $y$.\n- If $op = 2$, it denotes a query.", "outputFormat": "For each query, output one integer on a single line, indicating the answer.", "hint": "Sample 1 Explanation  \nInitially the colors are $1, 2, 2, 1$, and the three color segments are $[1, 1], [2, 3], [4, 4]$.  \nAfter one operation, the colors become $1, 1, 1, 1$, leaving only one segment $[1, 4]$.\n\nConstraints  \nFor all test points, it is guaranteed that $1 \\leq n, m \\leq 10^5$, $1 \\leq a_i, x, y \\leq 10^6$.\n\nNotes  \nPlease note that it is **not guaranteed** that color IDs are at most $n$, it is also **not guaranteed** that $x \\neq y$, and $m$ is **not** an upper bound on color IDs.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2009] 梦幻布丁", "background": "", "description": "$n$ 个布丁摆成一行，进行 $m$ 次操作。每次将某个颜色的布丁全部变成另一种颜色的，然后再询问当前一共有多少段颜色。\n\n例如，颜色分别为 $1,2,2,1$ 的四个布丁一共有 $3$ 段颜色.", "inputFormat": "第一行是两个整数，分别表示布丁个数 $n$ 和操作次数 $m$。  \n第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个布丁的颜色 $a_i$。  \n接下来 $m$ 行，每行描述一次操作。每行首先有一个整数 $op$ 表示操作类型：\n- 若 $op = 1$，则后有两个整数 $x, y$，表示将颜色 $x$ 的布丁全部变成颜色 $y$。\n- 若 $op = 2$，则表示一次询问。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n初始时布丁颜色依次为 $1, 2, 2, 1$，三段颜色分别为 $[1, 1], [2, 3], [4, 4]$。  \n一次操作后，布丁的颜色变为 $1, 1, 1, 1$，只有 $[1, 4]$ 一段颜色。\n\n### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq n, m \\leq 10^5$，$1 \\leq a_i ,x, y \\leq 10^6$。\n\n### 提示\n\n请注意，**不保证**颜色的编号不大于 $n$，也**不保证** $x \\neq y$，$m$ **不是**颜色的编号上限。", "locale": "zh-CN"}}}
{"pid": "P3202", "type": "P", "difficulty": 6, "samples": [["3\n10 2\n4 5 10 6 6 9 4 7 9 8\n3 1\n6 4 0\n4 2\n3 0 6 3", "6\nimpossible\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2009", "各省省选", "湖南"], "title": "[HNOI2009] 通往城堡之路", "background": null, "description": "听说公主被关押在城堡里，彭大侠下定决心：不管一路上有多少坎坷，不管城堡中的看守有多少厉害，不管救了公主之后公主会不会再被抓走，不管公主是否漂亮、是否会钟情于自己，他将义无反顾地朝着城堡前进。\n\n可是，通往城堡的路上出现了一些情况。抽象地说，假象地图在二维平面的第一象限。在每个横轴的 $x$ 位置上有一个高为 $h_x$ 的支撑点，如果彭大侠没有跳到支撑点上，那么他就会掉下去，牺牲在路途。\n\n开始时彭大侠在起点 $(1,h_1)$ 处，而城堡的入口在 $(n,h_n)$ 处。彭大侠每次可以从支撑点 $(x,h_x)$ 跳到支撑点 $(x+1,h_{x+1})$。但是彭大侠每次的跳跃能量只有 $d$，也就是说，每次跳跃必须满足条件 $|h_{x+1}-h_x| \\le d$。换句话说，如果两个相邻支撑点的纵向落差大于 $d$，那么彭大侠就无法跳跃了！幸运的是，彭大侠还有一个杀手锏。\n\n在起点处，他可以花一个金币，把某个支撑点升高 $1$ 个单位，或者降低 $1$ 个单位。但是，起点处和城堡入口处的支撑点高度不能改变，并且一旦离开起点彭大侠就无法使用该杀手锏。\n\n彭大侠被告知 $100$ 个金币可兑换一单位生命。于是他希望通过少花金币来保存更多单位的生命。\n\n他终于找到了你这位热心的高手，请你帮他规划一下以便耗费尽量少的金币来到达城堡。", "inputFormat": "文件第一行包含一个整数 $m(m \\le 5)$，表示问题求解次数。接下来的 $2m$ 行依次表示每次求解的输入数据块。每个输入数据块占 $2$ 行，其中第一行包含两个整数 $n$ 和 $d$，分别表示从起点到城堡入口处必须经过的支撑点数和每次跳跃允许的最大纵向落差，$n$ 和 $d$ 之间用空格隔开，输入数据保证 $2 \\le n \\le 5000，0 \\le d \\le 10^9$；第二行包含用空格隔开的 $n$ 个非负整数 $h_1, h_2,\\dots , h_n$，其中 $h_i(1 \\le i \\le n)$ 表示第 $i$ 个支撑点的高度，特别地，$h_1$ 表示彭大侠出发时所在支撑点的高度，$h_n$ 表示城堡入口所在支撑点的高度，输入数据保证对所有 $1 \\le i \\le n$ 有 $0 \\le h_i \\le 10^9$。", "outputFormat": "有 $m$ 行，第 $I(1 \\le I \\le m)$ 行表示第 $I$ 次求解时彭大侠到达城堡必须耗费的最少金币数量。若无论怎样使用杀手锏他都无法到达城堡，则输出 `impossible`。输入数据保证答案在 int64 范围之内。", "hint": "对样例中的第一个输入数据块，$d=2$，把第三个支撑点降低 $3$ 个单位，把第六个支撑点降低 $1$ 个单位，把第七个支撑点升高 $2$ 个单位，原序列变成：`4 5 7 6 6 8 6 7 9 8`，这时任意相邻支撑点的纵向落差没有超过 $2$，彭大侠可以到达城堡！\n\n对样例中的第二个输入数据块，$d=1$，这时不管怎样调节第二个支撑点的高度，都无法使任意相邻支撑点的纵向落差不超过 $1$。\n\n对样例中的第三个输入数据块，$d=2$，这时，把第二个支撑点升高 $1$ 个单位，把第三个支撑点降低 $3$ 个单位就满足条件了。\n\n【数据规模】\n\n对于 $20\\%$ 的数据，$n \\le 100$；\n\n对于 $40\\%$ 的数据，$n \\le 1000$；\n\n对于 $100\\%$ 的数据，$n \\le 5000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2009] The Road to the Castle", "background": "", "description": "It is said that the princess is imprisoned in the castle. Peng the Hero is determined: no matter how many obstacles lie ahead, no matter how powerful the guards in the castle are, no matter whether the princess might be captured again after being rescued, and no matter whether the princess is beautiful or will fall for him, he will march toward the castle without hesitation.\n\nHowever, something has happened on the road to the castle. Abstractly, imagine the map lies in the first quadrant of the 2D plane. At each horizontal position $x$ there is a support point of height $h_x$. If Peng the Hero fails to land on a support point, he will fall and perish on the way.\n\nInitially, Peng the Hero is at the starting point $(1, h_1)$, and the castle entrance is at $(n, h_n)$. Each time, Peng the Hero can jump from support point $(x, h_x)$ to support point $(x+1, h_{x+1})$. But each jump only has energy $d$, that is, every jump must satisfy $|h_{x+1} - h_x| \\le d$. In other words, if the vertical difference between two adjacent support points is greater than $d$, Peng the Hero cannot jump! Fortunately, he has a trump card.\n\nAt the starting point, he can spend one coin to increase the height of some support point by $1$ unit, or decrease it by $1$ unit. However, the heights of the support points at the starting point and at the castle entrance cannot be changed, and once he leaves the start, Peng the Hero can no longer use this trump card.\n\nPeng the Hero is told that $100$ coins can be exchanged for one unit of life. Therefore, he wants to save as many units of life as possible by spending as few coins as possible.\n\nHe finally found you, a helpful expert. Please help him plan so that he reaches the castle while spending the fewest coins.", "inputFormat": "The first line contains an integer $m$ ($m \\le 5$), the number of test cases. The following $2m$ lines describe the input data blocks for each test case in order. Each test case occupies $2$ lines:\n- The first line contains two integers $n$ and $d$, representing the number of support points that must be traversed from the start to the castle entrance, and the maximum allowed vertical difference per jump, respectively, separated by a space. It is guaranteed that $2 \\le n \\le 5000$, $0 \\le d \\le 10^9$.\n- The second line contains $n$ non-negative integers $h_1, h_2, \\dots, h_n$ separated by spaces, where $h_i$ ($1 \\le i \\le n$) is the height of the $i$-th support point. In particular, $h_1$ is the height at the start and $h_n$ is the height at the castle entrance. It is guaranteed that for all $1 \\le i \\le n$, $0 \\le h_i \\le 10^9$.", "outputFormat": "Output $m$ lines. The $I$-th line ($1 \\le I \\le m$) contains the minimum number of coins Peng the Hero must spend to reach the castle in the $I$-th test case. If he cannot reach the castle no matter how he uses the trump card, output `impossible`. It is guaranteed that the answer fits within the int64 range.", "hint": "For the first sample input block, $d = 2$. Lower the third support point by $3$ units, lower the sixth by $1$ unit, and raise the seventh by $2$ units. The sequence becomes: `4 5 7 6 6 8 6 7 9 8`. Now the vertical difference between any adjacent support points does not exceed $2$, so Peng the Hero can reach the castle!\n\nFor the second sample input block, $d = 1$. No matter how you adjust the height of the second support point, you cannot make every adjacent vertical difference at most $1$.\n\nFor the third sample input block, $d = 2$. Raising the second support point by $1$ unit and lowering the third by $3$ units suffices.\n\nConstraints\n\n- For $20\\%$ of the testdata, $n \\le 100$.\n- For $40\\%$ of the testdata, $n \\le 1000$.\n- For $100\\%$ of the testdata, $n \\le 5000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2009] 通往城堡之路", "background": null, "description": "听说公主被关押在城堡里，彭大侠下定决心：不管一路上有多少坎坷，不管城堡中的看守有多少厉害，不管救了公主之后公主会不会再被抓走，不管公主是否漂亮、是否会钟情于自己，他将义无反顾地朝着城堡前进。\n\n可是，通往城堡的路上出现了一些情况。抽象地说，假象地图在二维平面的第一象限。在每个横轴的 $x$ 位置上有一个高为 $h_x$ 的支撑点，如果彭大侠没有跳到支撑点上，那么他就会掉下去，牺牲在路途。\n\n开始时彭大侠在起点 $(1,h_1)$ 处，而城堡的入口在 $(n,h_n)$ 处。彭大侠每次可以从支撑点 $(x,h_x)$ 跳到支撑点 $(x+1,h_{x+1})$。但是彭大侠每次的跳跃能量只有 $d$，也就是说，每次跳跃必须满足条件 $|h_{x+1}-h_x| \\le d$。换句话说，如果两个相邻支撑点的纵向落差大于 $d$，那么彭大侠就无法跳跃了！幸运的是，彭大侠还有一个杀手锏。\n\n在起点处，他可以花一个金币，把某个支撑点升高 $1$ 个单位，或者降低 $1$ 个单位。但是，起点处和城堡入口处的支撑点高度不能改变，并且一旦离开起点彭大侠就无法使用该杀手锏。\n\n彭大侠被告知 $100$ 个金币可兑换一单位生命。于是他希望通过少花金币来保存更多单位的生命。\n\n他终于找到了你这位热心的高手，请你帮他规划一下以便耗费尽量少的金币来到达城堡。", "inputFormat": "文件第一行包含一个整数 $m(m \\le 5)$，表示问题求解次数。接下来的 $2m$ 行依次表示每次求解的输入数据块。每个输入数据块占 $2$ 行，其中第一行包含两个整数 $n$ 和 $d$，分别表示从起点到城堡入口处必须经过的支撑点数和每次跳跃允许的最大纵向落差，$n$ 和 $d$ 之间用空格隔开，输入数据保证 $2 \\le n \\le 5000，0 \\le d \\le 10^9$；第二行包含用空格隔开的 $n$ 个非负整数 $h_1, h_2,\\dots , h_n$，其中 $h_i(1 \\le i \\le n)$ 表示第 $i$ 个支撑点的高度，特别地，$h_1$ 表示彭大侠出发时所在支撑点的高度，$h_n$ 表示城堡入口所在支撑点的高度，输入数据保证对所有 $1 \\le i \\le n$ 有 $0 \\le h_i \\le 10^9$。", "outputFormat": "有 $m$ 行，第 $I(1 \\le I \\le m)$ 行表示第 $I$ 次求解时彭大侠到达城堡必须耗费的最少金币数量。若无论怎样使用杀手锏他都无法到达城堡，则输出 `impossible`。输入数据保证答案在 int64 范围之内。", "hint": "对样例中的第一个输入数据块，$d=2$，把第三个支撑点降低 $3$ 个单位，把第六个支撑点降低 $1$ 个单位，把第七个支撑点升高 $2$ 个单位，原序列变成：`4 5 7 6 6 8 6 7 9 8`，这时任意相邻支撑点的纵向落差没有超过 $2$，彭大侠可以到达城堡！\n\n对样例中的第二个输入数据块，$d=1$，这时不管怎样调节第二个支撑点的高度，都无法使任意相邻支撑点的纵向落差不超过 $1$。\n\n对样例中的第三个输入数据块，$d=2$，这时，把第二个支撑点升高 $1$ 个单位，把第三个支撑点降低 $3$ 个单位就满足条件了。\n\n【数据规模】\n\n对于 $20\\%$ 的数据，$n \\le 100$；\n\n对于 $40\\%$ 的数据，$n \\le 1000$；\n\n对于 $100\\%$ 的数据，$n \\le 5000$。", "locale": "zh-CN"}}}
{"pid": "P3203", "type": "P", "difficulty": 6, "samples": [["4\n1 2 1 1\n3\n1 1\n2 1 1\n1 1", "2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "各省省选", "湖南", "动态树 LCT", "分块"], "title": "[HNOI2010] 弹飞绵羊", "background": "", "description": "某天，Lostmonkey 发明了一种超级弹力装置，为了在他的绵羊朋友面前显摆，他邀请小绵羊一起玩个游戏。  \n\n游戏一开始，Lostmonkey 在地上沿着一条直线摆上 $n$ 个装置，每个装置设定初始弹力系数 $k_i$，当绵羊达到第 $i$ 个装置时，它会往后弹 $k_i$ 步，达到第 $i+k_i$ 个装置，若不存在第 $i+k_i$ 个装置，则绵羊被弹飞。  \n\n绵羊想知道当它从第 $i$ 个装置起步时，被弹几次后会被弹飞。为了使得游戏更有趣，Lostmonkey 可以修改某个弹力装置的弹力系数，任何时候弹力系数均为正整数。\n", "inputFormat": "第一行包含一个整数 $n$，表示地上有 $n$ 个装置，装置的编号从 $0 \\sim n-1$。\n\n接下来一行有 $n$ 个正整数，依次为那 $n$ 个装置的初始弹力系数。\n\n第三行有一个正整数 $m$，表示操作次数。接下来 $m$ 行每行至少有两个数 $i,j$。  \n\n- 若 $i=1$，你要输出从编号为 $j$ 的装置出发被弹几次后被弹飞  \n\n- 若 $i=2$，则还会再输入一个正整数 $k$，表示编号为 $j$ 的弹力装置的系数被修改成 $k$。", "outputFormat": "对于每个 $i=1$ 的操作，输出一行一个整数表示答案。\n", "hint": "【数据范围】   \n对于 $20\\%$ 的数据，$1 \\le n,m \\le 10^4$；   \n对于 $100\\%$ 的数据，$1\\le n \\le 2\\times 10^5$，$1\\le m \\le 10^5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Bouncing Sheep", "background": "", "description": "One day, Lostmonkey invented a super elastic device. To show off in front of his sheep friends, he invited a little sheep to play a game.\n\nAt the start of the game, Lostmonkey places $n$ devices along a straight line on the ground. Each device has an initial elasticity coefficient $k_i$. When the sheep reaches the $i$-th device, it will bounce forward $k_i$ steps, reaching the $(i + k_i)$-th device. If the $(i + k_i)$-th device does not exist, the sheep will be launched away.\n\nThe sheep wants to know, starting from the $i$-th device, after how many bounces it will be launched away. To make the game more interesting, Lostmonkey may modify the elasticity coefficient of any device, and the coefficients are positive integers at all times.", "inputFormat": "The first line contains an integer $n$, indicating there are $n$ devices on the ground, numbered from $0 \\sim n-1$.\n\nThe next line contains $n$ positive integers, which are the initial elasticity coefficients of the $n$ devices in order.\n\nThe third line contains a positive integer $m$, the number of operations. Each of the next $m$ lines contains at least two integers $i, j$.  \n- If $i = 1$, you should output after how many bounces the sheep starting from device $j$ will be launched away.  \n- If $i = 2$, there will be one more positive integer $k$, meaning the coefficient of device $j$ is updated to $k$.", "outputFormat": "For each operation with $i = 1$, output one line containing a single integer representing the answer.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $1 \\le n, m \\le 10^4$.  \nFor $100\\%$ of the testdata, $1 \\le n \\le 2 \\times 10^5$, $1 \\le m \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 弹飞绵羊", "background": "", "description": "某天，Lostmonkey 发明了一种超级弹力装置，为了在他的绵羊朋友面前显摆，他邀请小绵羊一起玩个游戏。  \n\n游戏一开始，Lostmonkey 在地上沿着一条直线摆上 $n$ 个装置，每个装置设定初始弹力系数 $k_i$，当绵羊达到第 $i$ 个装置时，它会往后弹 $k_i$ 步，达到第 $i+k_i$ 个装置，若不存在第 $i+k_i$ 个装置，则绵羊被弹飞。  \n\n绵羊想知道当它从第 $i$ 个装置起步时，被弹几次后会被弹飞。为了使得游戏更有趣，Lostmonkey 可以修改某个弹力装置的弹力系数，任何时候弹力系数均为正整数。\n", "inputFormat": "第一行包含一个整数 $n$，表示地上有 $n$ 个装置，装置的编号从 $0 \\sim n-1$。\n\n接下来一行有 $n$ 个正整数，依次为那 $n$ 个装置的初始弹力系数。\n\n第三行有一个正整数 $m$，表示操作次数。接下来 $m$ 行每行至少有两个数 $i,j$。  \n\n- 若 $i=1$，你要输出从编号为 $j$ 的装置出发被弹几次后被弹飞  \n\n- 若 $i=2$，则还会再输入一个正整数 $k$，表示编号为 $j$ 的弹力装置的系数被修改成 $k$。", "outputFormat": "对于每个 $i=1$ 的操作，输出一行一个整数表示答案。\n", "hint": "【数据范围】   \n对于 $20\\%$ 的数据，$1 \\le n,m \\le 10^4$；   \n对于 $100\\%$ 的数据，$1\\le n \\le 2\\times 10^5$，$1\\le m \\le 10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P3204", "type": "P", "difficulty": 6, "samples": [["10 3 3", "1"], ["5 2 3", "3"], ["10 2 4", "81"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "各省省选", "湖南", "矩阵加速", "进制", "状压 DP"], "title": "[HNOI2010] 公交线路", "background": null, "description": "小 Z 所在的城市有 $N$ 个公交车站，排列在一条长 $(N-1)\\  \\rm km$ 的直线上，从左到右依次编号为 $1$ 到 $N$，相邻公交车站间的距离均为 $1 \\ \\rm km$。作为公交车线路的规划者，小 Z 调查了市民的需求，决定按下述规则设计线路：\n\n1. 设共 $K$ 辆公交车，则 $1$ 到 $K$ 号站作为始发站，$N-K+1$ 到 $N$ 号台作为终点站。\n2. 每个车站必须被一辆且仅一辆公交车经过（始发站和终点站也算被经过）。\n3. 公交车只能从编号较小的站台驶往编号较大的站台。\n4. 一辆公交车经过的相邻两个站台间距离不得超过 $P \\ \\rm km$。\n\n在最终设计线路之前，小 Z 想知道有多少种满足要求的方案。由于答案可能很大，你只需求出答案对 $30031$ 取模的结果。", "inputFormat": "仅一行包含三个正整数 $N$、$K$、$P$，分别表示公交车站数、公交车数、相邻站台的距离限制。", "outputFormat": "仅包含一个整数，表示满足要求的方案数对 $30031$ 取模的结果。", "hint": "【样例说明】\n\n样例一的可行方案如下：$(1,4,7,10)$，$(2,5,8)$，$(3,6,9)$。\n\n样例二的可行方案如下：$(1,3,5)$，$(2,4)(1,3,4)$，$(2,5)(1,4)$，$(2,3,5)$。\n\n对于 $100 \\%$ 的数据，$1 \\le N \\le 10^9$，$1 < P \\le 10$，$K<N$，$1<K \\le P$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Bus Routes", "background": "", "description": "There are $N$ bus stops in Xiao Z’s city, arranged on a straight line of length $(N-1)\\  \\rm km$, numbered from left to right as $1$ to $N$. The distance between any two adjacent bus stops is $1 \\ \\rm km$. As the planner of bus routes, Xiao Z decides to design the routes according to the following rules:\n\n1. Suppose there are $K$ buses. Then stops $1$ to $K$ serve as the starting stops, and stops $N-K+1$ to $N$ serve as the terminal stops.\n2. Each stop must be visited by exactly one bus (starting and terminal stops are also considered visited).\n3. A bus may only travel from a lower-numbered stop to a higher-numbered stop.\n4. For any single bus, the distance between two consecutive stops it visits must not exceed $P \\ \\rm km$.\n\nBefore finalizing the design, Xiao Z wants to know how many valid plans satisfy the rules. Since the answer can be large, output the result modulo $30031$.", "inputFormat": "A single line contains three positive integers $N$, $K$, and $P$, representing the number of bus stops, the number of buses, and the distance limit between consecutive stops, respectively.", "outputFormat": "Output a single integer: the number of valid plans modulo $30031$.", "hint": "Sample explanation:\n\n- Sample 1 has the following valid plan: $(1,4,7,10)$, $(2,5,8)$, $(3,6,9)$.\n- Sample 2 has the following valid plans: $(1,3,5)$, $(2,4)$; $(1,3,4)$, $(2,5)$; $(1,4)$, $(2,3,5)$.\n\nConstraints:\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 10^9$, $1 < P \\le 10$, $K < N$, $1 < K \\le P$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 公交线路", "background": null, "description": "小 Z 所在的城市有 $N$ 个公交车站，排列在一条长 $(N-1)\\  \\rm km$ 的直线上，从左到右依次编号为 $1$ 到 $N$，相邻公交车站间的距离均为 $1 \\ \\rm km$。作为公交车线路的规划者，小 Z 调查了市民的需求，决定按下述规则设计线路：\n\n1. 设共 $K$ 辆公交车，则 $1$ 到 $K$ 号站作为始发站，$N-K+1$ 到 $N$ 号台作为终点站。\n2. 每个车站必须被一辆且仅一辆公交车经过（始发站和终点站也算被经过）。\n3. 公交车只能从编号较小的站台驶往编号较大的站台。\n4. 一辆公交车经过的相邻两个站台间距离不得超过 $P \\ \\rm km$。\n\n在最终设计线路之前，小 Z 想知道有多少种满足要求的方案。由于答案可能很大，你只需求出答案对 $30031$ 取模的结果。", "inputFormat": "仅一行包含三个正整数 $N$、$K$、$P$，分别表示公交车站数、公交车数、相邻站台的距离限制。", "outputFormat": "仅包含一个整数，表示满足要求的方案数对 $30031$ 取模的结果。", "hint": "【样例说明】\n\n样例一的可行方案如下：$(1,4,7,10)$，$(2,5,8)$，$(3,6,9)$。\n\n样例二的可行方案如下：$(1,3,5)$，$(2,4)(1,3,4)$，$(2,5)(1,4)$，$(2,3,5)$。\n\n对于 $100 \\%$ 的数据，$1 \\le N \\le 10^9$，$1 < P \\le 10$，$K<N$，$1<K \\le P$。", "locale": "zh-CN"}}}
{"pid": "P3205", "type": "P", "difficulty": 4, "samples": [["4\n1701 1702 1703 1704", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2010", "各省省选", "湖南", "区间 DP"], "title": "[HNOI2010] 合唱队", "background": null, "description": "为了在即将到来的晚会上有更好的演出效果，作为 AAA 合唱队负责人的小 A 需要将合唱队的人根据他们的身高排出一个队形。假定合唱队一共 $n$ 个人，第 $i$ 个人的身高为 $h_i$ 米（$1000 \\le h_i \\le 2000$），并已知任何两个人的身高都不同。假定最终排出的队形是 $A$ 个人站成一排，为了简化问题，小 A 想出了如下排队的方式：他让所有的人先按任意顺序站成一个初始队形，然后从左到右按以下原则依次将每个人插入最终排出的队形中：\n\n- 第一个人直接插入空的当前队形中。\n\n- 对从第二个人开始的每个人，如果他比前面那个人高（$h$ 较大），那么将他插入当前队形的最右边。如果他比前面那个人矮（$h$ 较小），那么将他插入当前队形的最左边。\n\n当 $n$ 个人全部插入当前队形后便获得最终排出的队形。\n\n例如，有 $6$ 个人站成一个初始队形，身高依次为 $1850, 1900, 1700, 1650, 1800, 1750$，  \n那么小 A 会按以下步骤获得最终排出的队形：\n\n- $1850$。\n\n- $1850, 1900$，因为 $1900 > 1850$。\n\n- $1700, 1850, 1900$，因为 $1700 < 1900$。\n\n- $1650, 1700, 1850, 1900$，因为 $1650 < 1700$。\n\n- $1650, 1700, 1850, 1900, 1800$，因为 $1800 > 1650$。\n\n- $1750, 1650, 1700, 1850, 1900, 1800$，因为 $1750 < 1800$。\n\n因此，最终排出的队形是 $1750, 1650, 1700, 1850, 1900, 1800$。\n\n小 A 心中有一个理想队形，他想知道多少种初始队形可以获得理想的队形。\n\n请求出答案对 $19650827$ 取模的值。", "inputFormat": "第一行一个整数 $n$。  \n第二行 $n$ 个整数，表示小 A 心中的理想队形。", "outputFormat": "输出一行一个整数，表示答案 $\\bmod 19650827$ 的值。", "hint": "对于 $30\\%$ 的数据，$n \\le 100$。  \n对于 $100\\%$ 的数据，$n \\le 1000$，$1000 \\le h_i \\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Choir", "background": "", "description": "To achieve a better performance at the upcoming gala, Xiao A, the leader of the AAA choir, needs to arrange the choir members into a lineup based on their heights. Suppose there are $n$ people in total, the $i$-th person’s height is $h_i$ meters ($1000 \\le h_i \\le 2000$), and any two people have different heights. Suppose the final lineup consists of $n$ people standing in one row. To simplify the process, Xiao A came up with the following method: he first lets everyone stand in an initial lineup in an arbitrary order, and then, from left to right, inserts each person into the final lineup according to these rules:\n\n- The first person is directly inserted into the empty current lineup.\n\n- For each person starting from the second, if he is taller than the person immediately before him in the initial lineup ($h$ is larger), insert him at the right end of the current lineup. If he is shorter ($h$ is smaller), insert him at the left end.\n\nAfter all $n$ people have been inserted into the current lineup, the final lineup is obtained.\n\nFor example, there are $6$ people in the initial lineup, with heights $1850, 1900, 1700, 1650, 1800, 1750$.  \nThen Xiao A will obtain the final lineup step by step as follows:\n\n- 1850.\n\n- 1850, 1900, because $1900 > 1850$.\n\n- 1700, 1850, 1900, because $1700 < 1900$.\n\n- 1650, 1700, 1850, 1900, because $1650 < 1700$.\n\n- 1650, 1700, 1850, 1900, 1800, because $1800 > 1650$.\n\n- 1750, 1650, 1700, 1850, 1900, 1800, because $1750 < 1800$.\n\nTherefore, the final lineup is 1750, 1650, 1700, 1850, 1900, 1800.\n\nXiao A has an ideal lineup in mind and wants to know how many initial lineups can result in that ideal lineup.\n\nCompute the answer modulo $19650827$.", "inputFormat": "The first line contains an integer $n$.  \nThe second line contains $n$ integers, representing Xiao A’s ideal lineup.", "outputFormat": "Output one line with a single integer, which is the value of the answer $\\bmod 19650827$.", "hint": "For 30% of the testdata, $n \\le 100$.  \nFor 100% of the testdata, $n \\le 1000$, $1000 \\le h_i \\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 合唱队", "background": null, "description": "为了在即将到来的晚会上有更好的演出效果，作为 AAA 合唱队负责人的小 A 需要将合唱队的人根据他们的身高排出一个队形。假定合唱队一共 $n$ 个人，第 $i$ 个人的身高为 $h_i$ 米（$1000 \\le h_i \\le 2000$），并已知任何两个人的身高都不同。假定最终排出的队形是 $A$ 个人站成一排，为了简化问题，小 A 想出了如下排队的方式：他让所有的人先按任意顺序站成一个初始队形，然后从左到右按以下原则依次将每个人插入最终排出的队形中：\n\n- 第一个人直接插入空的当前队形中。\n\n- 对从第二个人开始的每个人，如果他比前面那个人高（$h$ 较大），那么将他插入当前队形的最右边。如果他比前面那个人矮（$h$ 较小），那么将他插入当前队形的最左边。\n\n当 $n$ 个人全部插入当前队形后便获得最终排出的队形。\n\n例如，有 $6$ 个人站成一个初始队形，身高依次为 $1850, 1900, 1700, 1650, 1800, 1750$，  \n那么小 A 会按以下步骤获得最终排出的队形：\n\n- $1850$。\n\n- $1850, 1900$，因为 $1900 > 1850$。\n\n- $1700, 1850, 1900$，因为 $1700 < 1900$。\n\n- $1650, 1700, 1850, 1900$，因为 $1650 < 1700$。\n\n- $1650, 1700, 1850, 1900, 1800$，因为 $1800 > 1650$。\n\n- $1750, 1650, 1700, 1850, 1900, 1800$，因为 $1750 < 1800$。\n\n因此，最终排出的队形是 $1750, 1650, 1700, 1850, 1900, 1800$。\n\n小 A 心中有一个理想队形，他想知道多少种初始队形可以获得理想的队形。\n\n请求出答案对 $19650827$ 取模的值。", "inputFormat": "第一行一个整数 $n$。  \n第二行 $n$ 个整数，表示小 A 心中的理想队形。", "outputFormat": "输出一行一个整数，表示答案 $\\bmod 19650827$ 的值。", "hint": "对于 $30\\%$ 的数据，$n \\le 100$。  \n对于 $100\\%$ 的数据，$n \\le 1000$，$1000 \\le h_i \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P3206", "type": "P", "difficulty": 6, "samples": [["5 5 3\n1 2 1\n2 3 2\n3 4 3\n4 5 4\n5 1 5\n1 6\n1 1\n5 3", "14\n10\n9"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2010", "各省省选", "湖南", "cdq 分治", "分治", "生成树", "动态树 LCT", "线段树分治"], "title": "[HNOI2010] 城市建设", "background": "", "description": "PS 国是一个拥有诸多城市的大国。国王 Louis 为城市的交通建设可谓绞尽脑汁。Louis 可以在某些城市之间修建道路，在不同的城市之间修建道路需要不同的花费。\n\nLouis 希望建造最少的道路使得国内所有的城市连通。但是由于某些因素，城市之间修建道路需要的花费会随着时间而改变。Louis 会不断得到某道路的修建代价改变的消息。他希望每得到一条消息后能立即知道使城市连通的最小花费总和。Louis 决定求助于你来完成这个任务。\n", "inputFormat": "第一行包含三个整数 $n,m,q$，分别表示城市的数目，可以修建的道路个数，及收到的消息个数。\n\n接下来 $m$ 行，第 $i+1$ 行有三个用空格隔开的整数 $x_i,y_i,z_i$，表示在城市 $x_i$ 与城市 $y_i$ 之间修建道路的代价为 $z_i$。接下来 $q$ 行，每行包含两个数 $k,d$，表示输入的第 $k$ 个道路的修建代价修改为 $d$（即将 $z_k$ 修改为 $d$）。", "outputFormat": "输出包含 $q$ 行，第 $i$ 行输出得知前 $i$ 条消息后使城市连通的最小花费总和。", "hint": "### 数据规模与约定\n- 对于 $20\\%$ 的数据，$n\\le 10^3$，$m,q\\le 6\\times 10^3$。\n- 对于另外 $20\\%$ 的数据，$n\\le 10^3$，$m\\le 5\\times 10^4$，$q\\le 8\\times 10^3$。修改后的代价不会比之前的代价低。\n- 对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^4$，$1\\le m,q\\le 5\\times 10^4$，$1\\le x_i,y_i\\le n$，$0\\le z_i\\le 5\\times 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] City Construction", "background": "", "description": "The PS Kingdom is a large country with many cities. King Louis has racked his brains over urban transportation. Louis can build roads between certain pairs of cities, and building roads between different pairs costs different amounts.\n\nLouis wants to build the fewest roads so that all cities in the country are connected. However, due to certain factors, the cost to build roads between cities changes over time. Louis will continuously receive notifications that the construction cost of some road has changed. He hopes that after receiving each notification, he can immediately know the minimal total cost to connect all cities. Louis has decided to ask you for help with this task.", "inputFormat": "The first line contains three integers $n, m, q$, representing the number of cities, the number of roads that can be built, and the number of notifications, respectively.\n\nThe next $m$ lines: on the $(i + 1)$-th line there are three integers $x_i, y_i, z_i$, meaning the cost to build a road between city $x_i$ and city $y_i$ is $z_i$. Then the next $q$ lines: each line contains two integers $k, d$, meaning the construction cost of the $k$-th road is updated to $d$ (that is, set $z_k$ to $d$).", "outputFormat": "Output contains $q$ lines. On the $i$-th line, output the minimal total cost to make all cities connected after processing the first $i$ notifications.", "hint": "Constraints\n- For $20\\%$ of the testdata, $n \\le 10^3$, $m, q \\le 6 \\times 10^3$.\n- For another $20\\%$ of the testdata, $n \\le 10^3$, $m \\le 5 \\times 10^4$, $q \\le 8 \\times 10^3$. The updated cost will not be lower than the previous cost.\n- For $100\\%$ of the testdata, $1 \\le n \\le 2 \\times 10^4$, $1 \\le m, q \\le 5 \\times 10^4$, $1 \\le x_i, y_i \\le n$, $0 \\le z_i \\le 5 \\times 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 城市建设", "background": "", "description": "PS 国是一个拥有诸多城市的大国。国王 Louis 为城市的交通建设可谓绞尽脑汁。Louis 可以在某些城市之间修建道路，在不同的城市之间修建道路需要不同的花费。\n\nLouis 希望建造最少的道路使得国内所有的城市连通。但是由于某些因素，城市之间修建道路需要的花费会随着时间而改变。Louis 会不断得到某道路的修建代价改变的消息。他希望每得到一条消息后能立即知道使城市连通的最小花费总和。Louis 决定求助于你来完成这个任务。\n", "inputFormat": "第一行包含三个整数 $n,m,q$，分别表示城市的数目，可以修建的道路个数，及收到的消息个数。\n\n接下来 $m$ 行，第 $i+1$ 行有三个用空格隔开的整数 $x_i,y_i,z_i$，表示在城市 $x_i$ 与城市 $y_i$ 之间修建道路的代价为 $z_i$。接下来 $q$ 行，每行包含两个数 $k,d$，表示输入的第 $k$ 个道路的修建代价修改为 $d$（即将 $z_k$ 修改为 $d$）。", "outputFormat": "输出包含 $q$ 行，第 $i$ 行输出得知前 $i$ 条消息后使城市连通的最小花费总和。", "hint": "### 数据规模与约定\n- 对于 $20\\%$ 的数据，$n\\le 10^3$，$m,q\\le 6\\times 10^3$。\n- 对于另外 $20\\%$ 的数据，$n\\le 10^3$，$m\\le 5\\times 10^4$，$q\\le 8\\times 10^3$。修改后的代价不会比之前的代价低。\n- 对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^4$，$1\\le m,q\\le 5\\times 10^4$，$1\\le x_i,y_i\\le n$，$0\\le z_i\\le 5\\times 10^7$。", "locale": "zh-CN"}}}
{"pid": "P3207", "type": "P", "difficulty": 5, "samples": [["1\n8 3 5 2 7 4", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "并查集", "各省省选", "湖南", "置换"], "title": "[HNOI2010] 物品调度", "background": "", "description": "现在找工作不容易，Lostmonkey 费了好大劲才得到 fsk 公司基层流水线操作员的职位。流水线上有 $n$ 个位置，从 $0$ 到 $n - 1$ 依次编号，一开始 $0$ 号位置是空的，其它的位置 $i$ 上有编号为 $i$ 的盒子。Lostmonkey 要按照以下规则重新排列这些盒子。\n\n规则由五个数描述，$q, p, m, d, s$，$s$ 表示空位的最终位置。\n\n首先生成一个序列 $c$，$c_0=0$，$c_{i+1}=(c_i\\times q+p)\\bmod m$。\n\n接下来从第一个盒子开始依次生成每个盒子的最终位置 $pos_i$，$pos_i=(c_i+d\\times x_i+y_i)\\bmod n$，$x_i,y_i$ 是为了让第 $i$ 个盒子不与之前的盒子位置相同的由你设定的非负整数，且 $pos_i$ 还不能为 $s$。\n\n如果有多个序列 $x,y$ 满足要求，你需要选择 $y$ 的字典序最小的，当 $y$ 相同时选择 $x$ 字典序最小的。这样你得到了所有盒子的最终位置，现在你每次可以把某个盒子移动到空位上，移动后原盒子所在的位置成为空位。\n\n问把所有的盒子移动到最终位置所需的最少步数。", "inputFormat": "第一行包含一个整数 $t$，表示数据组数。\n\n接下来 $t$ 行，每行六个数，$n, s, q, p, m, d$ 意义如上所述。", "outputFormat": "对于每组数据输出一个数占一行，表示最少移动步数。\n", "hint": "**【样例解释】**\n\n第 $1$ 个到第 $7$ 个盒子的最终位置依次是：$[2, 5, 6, 4, 1, 0, 7]$。\n\n**【数据范围】**\n\n对于 $30 \\%$ 的数据，$n \\le 100$，  \n对于 $100 \\%$ 的数据，$1 \\le t \\le 20$，$1 \\le n \\le 100000$，$0 \\le s < n$。\n\n其余所有数字均为不超过 $100000$ 的正整数。\n\n**【提示】**\n\n计算过程可能超过整型范围。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Item Scheduling", "background": "", "description": "Finding a job is not easy. Lostmonkey finally managed to get an entry-level assembly line operator position at fsk. There are $n$ positions on the line, numbered from $0$ to $n - 1$. Initially, position $0$ is empty, and each other position $i$ holds a box numbered $i$. Lostmonkey needs to rearrange these boxes according to the following rules.\n\nThe rules are determined by five numbers, $q, p, m, d, s$, where $s$ is the final position of the empty slot.\n\nFirst, generate a sequence $c$ with $c_0=0$, and $c_{i+1}=(c_i\\times q+p)\\bmod m$.\n\nNext, starting from the first box, generate the final position $pos_i$ for each box in order: $pos_i=(c_i+d\\times x_i+y_i)\\bmod n$, where $x_i, y_i$ are non-negative integers chosen by you so that the $i$-th box does not share the same position as any previous box, and $pos_i$ must not be $s$.\n\nIf there are multiple sequences $x, y$ that satisfy the requirements, you must choose the one with the lexicographically smallest $y$. If $y$ is the same, choose the lexicographically smallest $x$. In this way, you obtain the final positions for all boxes. Each move allows you to move any box into the empty slot; after moving, the original position of that box becomes the empty slot.\n\nFind the minimum number of moves required to move all boxes to their final positions.", "inputFormat": "The first line contains an integer $t$, the number of test cases.\n\nThen follow $t$ lines. Each line contains six numbers, $n, s, q, p, m, d$, as described above.", "outputFormat": "For each test case, output one number on a single line, the minimum number of moves.", "hint": "[Sample Explanation]\n\nThe final positions of boxes $1$ through $7$ are: $[2, 5, 6, 4, 1, 0, 7]$.\n\nConstraints\n\n- For $30\\%$ of the testdata, $n \\le 100$.\n- For $100\\%$ of the testdata, $1 \\le t \\le 20$, $1 \\le n \\le 100000$, $0 \\le s < n$.\n- All other numbers are positive integers not exceeding $100000$.\n\nAdditional Hint\n\nThe computation may exceed the integer range.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 物品调度", "background": "", "description": "现在找工作不容易，Lostmonkey 费了好大劲才得到 fsk 公司基层流水线操作员的职位。流水线上有 $n$ 个位置，从 $0$ 到 $n - 1$ 依次编号，一开始 $0$ 号位置是空的，其它的位置 $i$ 上有编号为 $i$ 的盒子。Lostmonkey 要按照以下规则重新排列这些盒子。\n\n规则由五个数描述，$q, p, m, d, s$，$s$ 表示空位的最终位置。\n\n首先生成一个序列 $c$，$c_0=0$，$c_{i+1}=(c_i\\times q+p)\\bmod m$。\n\n接下来从第一个盒子开始依次生成每个盒子的最终位置 $pos_i$，$pos_i=(c_i+d\\times x_i+y_i)\\bmod n$，$x_i,y_i$ 是为了让第 $i$ 个盒子不与之前的盒子位置相同的由你设定的非负整数，且 $pos_i$ 还不能为 $s$。\n\n如果有多个序列 $x,y$ 满足要求，你需要选择 $y$ 的字典序最小的，当 $y$ 相同时选择 $x$ 字典序最小的。这样你得到了所有盒子的最终位置，现在你每次可以把某个盒子移动到空位上，移动后原盒子所在的位置成为空位。\n\n问把所有的盒子移动到最终位置所需的最少步数。", "inputFormat": "第一行包含一个整数 $t$，表示数据组数。\n\n接下来 $t$ 行，每行六个数，$n, s, q, p, m, d$ 意义如上所述。", "outputFormat": "对于每组数据输出一个数占一行，表示最少移动步数。\n", "hint": "**【样例解释】**\n\n第 $1$ 个到第 $7$ 个盒子的最终位置依次是：$[2, 5, 6, 4, 1, 0, 7]$。\n\n**【数据范围】**\n\n对于 $30 \\%$ 的数据，$n \\le 100$，  \n对于 $100 \\%$ 的数据，$1 \\le t \\le 20$，$1 \\le n \\le 100000$，$0 \\le s < n$。\n\n其余所有数字均为不超过 $100000$ 的正整数。\n\n**【提示】**\n\n计算过程可能超过整型范围。", "locale": "zh-CN"}}}
{"pid": "P3208", "type": "P", "difficulty": 7, "samples": [["3 3 3\n0 0 0\n0 4 5\n0 5 3\n", "0 0 2\n2 2 1\n1 0 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "各省省选", "湖南", "枚举", "剪枝", "图论建模", "2-SAT", "构造", "bitset"], "title": "[HNOI2010] 矩阵", "background": "", "description": "小 Z 近日闲来无事，便研究起矩阵来。他先写了一个 $N\\times M$ 的矩阵，每个格子里填入了一个小于 $P$ 的非负整数，然后他对于每个 $2\\times 2$ 的子矩阵，算出了其中数的和。\n\n譬如 $N=3, M=3, P=3$，小 Z 写的矩阵如下：\n\n$$ A = \\begin{pmatrix} 0 & 1 & 2 \\\\ 1 & 2 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix} $$\n\n共有 $4$ 个 $2\\times 2$ 的子矩阵，容易算出它们的和如下：\n\n$$ A = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 4 & 5 \\\\ 0 & 5 & 3 \\end{pmatrix} $$\n\n(第一行和第一列的 $0$ 是为了格式美观而添加进去的)\n\n现在小 Z 想试一试能不能根据这些和推算出原矩阵。由于小 Z 的数学并不好，因此这个任务就交给你了。\n\n当然，小 Z 早就发现了，解很可能不唯一，譬如下面的矩阵算出的和与 $A$ 相同：\n\n$$ A = \\begin{pmatrix} 0 & 2 & 1 \\\\ 0 & 2 & 0 \\\\ 2 & 1 & 0 \\end{pmatrix} $$\n\n示意图在有多个矩阵满足要求的情况下请你输出字典序最小的那一个。\n\n字典序的比较方式如下：对于两个解矩阵 $X$ 和 $Y$，找到 $X$ 和 $Y$ 不同的位置中行数最小的那一个格子，若有多个则取列数最小的那个格子，该位置较小的矩阵字典序较小。\n\n譬如上述的矩阵 $A$ 和 $B$，第一个不同的格子应是第一行第二个格子，而 $A[1][2] < B[1][2]$，故矩阵 $A$ 的字典序比 $B$ 小。\n\n另外，小 Z 的数学还没有差到加法都做错，因此保证输入数据都是有解的。\n", "inputFormat": "第一行包含三个正整数 $N, M, P$ 表示矩阵的行数列数以及每个数的范围，接下来 $N$ 行每行包含 $M$ 个非负整数，其中第 $i$ 行第 $j$ 个数表示以格子 $(i,j)$ 为右下角的 $2 \\times 2$ 子矩阵中的数的和。保证第一行与第一列的数均为 $0$，且每个和都不超过 $4 (P-1)$。\n", "outputFormat": "包含 $N$ 行，每行 $M$ 个整数，描述你求出的矩阵，相邻的整数用空格分开。（行末不要有多余空格）\n", "hint": "$1 \\le N, M \\le 200$\n\n$2 \\le P \\le 10$\n\n感谢 @ASC\\_8384 提供题面\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Matrix", "background": "", "description": "Xiao Z has recently been studying matrices. He first wrote an $N\\times M$ matrix where each cell contains a non-negative integer less than $P$. Then, for every $2\\times 2$ submatrix, he computed the sum of its four numbers.\n\nFor example, when $N=3, M=3, P=3$, the matrix he wrote is:\n\n$$ A = \\begin{pmatrix} 0 & 1 & 2 \\\\ 1 & 2 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix} $$\n\nThere are $4$ submatrices of size $2\\times 2$, and their sums are:\n\n$$ A = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 4 & 5 \\\\ 0 & 5 & 3 \\end{pmatrix} $$\n\n(The zeros in the first row and first column are added only for formatting.)\n\nNow Xiao Z wants to see whether he can reconstruct the original matrix from these sums. Since his math is not very good, he asks you to do it.\n\nOf course, the solution may not be unique. For example, the following matrix produces the same sums as above:\n\n$$ A = \\begin{pmatrix} 0 & 2 & 1 \\\\ 0 & 2 & 0 \\\\ 2 & 1 & 0 \\end{pmatrix} $$\n\nIf multiple matrices satisfy the requirement, output the lexicographically smallest one.\n\nLexicographic order is defined as follows: for two solution matrices $X$ and $Y$, find the cell with the smallest row index where they differ; if there are multiple such cells, take the one with the smallest column index. The matrix with the smaller value at that cell is lexicographically smaller.\n\nFor the two example matrices above, the first differing cell is the second cell in the first row, and since the first matrix has a smaller value there, it is lexicographically smaller.\n\nAlso, it is guaranteed that the input is solvable.", "inputFormat": "The first line contains three positive integers $N, M, P$, denoting the number of rows and columns of the matrix and the value range of each number. Then follow $N$ lines, each containing $M$ non-negative integers. In the $i$-th line, the $j$-th number is the sum of the $2 \\times 2$ submatrix whose bottom-right corner is cell $(i, j)$. The numbers in the first row and the first column are guaranteed to be $0$, and each sum does not exceed $4 (P-1)$.", "outputFormat": "Output $N$ lines, each containing $M$ integers describing the matrix you reconstructed, with adjacent integers separated by single spaces. Do not print trailing spaces at the end of a line.", "hint": "$1 \\le N, M \\le 200$.\n\n$2 \\le P \\le 10$.\n\nThanks to @ASC\\_8384 for providing the problem statement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 矩阵", "background": "", "description": "小 Z 近日闲来无事，便研究起矩阵来。他先写了一个 $N\\times M$ 的矩阵，每个格子里填入了一个小于 $P$ 的非负整数，然后他对于每个 $2\\times 2$ 的子矩阵，算出了其中数的和。\n\n譬如 $N=3, M=3, P=3$，小 Z 写的矩阵如下：\n\n$$ A = \\begin{pmatrix} 0 & 1 & 2 \\\\ 1 & 2 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix} $$\n\n共有 $4$ 个 $2\\times 2$ 的子矩阵，容易算出它们的和如下：\n\n$$ A = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 4 & 5 \\\\ 0 & 5 & 3 \\end{pmatrix} $$\n\n(第一行和第一列的 $0$ 是为了格式美观而添加进去的)\n\n现在小 Z 想试一试能不能根据这些和推算出原矩阵。由于小 Z 的数学并不好，因此这个任务就交给你了。\n\n当然，小 Z 早就发现了，解很可能不唯一，譬如下面的矩阵算出的和与 $A$ 相同：\n\n$$ A = \\begin{pmatrix} 0 & 2 & 1 \\\\ 0 & 2 & 0 \\\\ 2 & 1 & 0 \\end{pmatrix} $$\n\n示意图在有多个矩阵满足要求的情况下请你输出字典序最小的那一个。\n\n字典序的比较方式如下：对于两个解矩阵 $X$ 和 $Y$，找到 $X$ 和 $Y$ 不同的位置中行数最小的那一个格子，若有多个则取列数最小的那个格子，该位置较小的矩阵字典序较小。\n\n譬如上述的矩阵 $A$ 和 $B$，第一个不同的格子应是第一行第二个格子，而 $A[1][2] < B[1][2]$，故矩阵 $A$ 的字典序比 $B$ 小。\n\n另外，小 Z 的数学还没有差到加法都做错，因此保证输入数据都是有解的。\n", "inputFormat": "第一行包含三个正整数 $N, M, P$ 表示矩阵的行数列数以及每个数的范围，接下来 $N$ 行每行包含 $M$ 个非负整数，其中第 $i$ 行第 $j$ 个数表示以格子 $(i,j)$ 为右下角的 $2 \\times 2$ 子矩阵中的数的和。保证第一行与第一列的数均为 $0$，且每个和都不超过 $4 (P-1)$。\n", "outputFormat": "包含 $N$ 行，每行 $M$ 个整数，描述你求出的矩阵，相邻的整数用空格分开。（行末不要有多余空格）\n", "hint": "$1 \\le N, M \\le 200$\n\n$2 \\le P \\le 10$\n\n感谢 @ASC\\_8384 提供题面\n", "locale": "zh-CN"}}}
