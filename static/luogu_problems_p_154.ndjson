{"pid": "P4118", "type": "P", "difficulty": 7, "samples": [["5 5\n-2 -3 -3 -3 -3\n2 1 5\n1 2 4 4\n2 1 5\n1 2 3 1\n2 3 3", "0\n3\n2"], ["5 5\n-2 3 3 -3 3\n2 1 5\n1 2 4 -4\n2 1 5\n1 2 3 1\n2 3 3", "6\n3\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2018] 末日时在做什么？有没有空？可以来拯救吗？", "background": "今天真是多谢你了\n\n让我体验了许多美好\n\n我留下了如同美梦一般的回忆 不过时间到了\n\n最后我还想拜托你一件事\n\n希望你可以把我忘掉\n\n ![](https://cdn.luogu.com.cn/upload/pic/13170.png) \n\n在自己消失之前\n\n心怀不想消失的愿望\n\n希望让某个人记住我\n\n希望能留下羁绊\n\n我这么希望着，又有什么不可以的吗\n\n ![](https://cdn.luogu.com.cn/upload/pic/13171.png) \n\n香香甜甜的，真好闻\n\n看起来很好吃\n\n ![](https://cdn.luogu.com.cn/upload/pic/13173.png) \n\n我遵守了...\n\n约...约定\n\n我非常...非常努力哦...\n\n ![](https://cdn.luogu.com.cn/upload/pic/13172.png) \n\n欢迎回来，珂朵莉\n", "description": "珂朵莉给了你一个长为 $n$ 的序列 $a$，有 $m$ 次操作。\n\n1. 把区间 $[l,r]$ 内所有数都加上 $x$。\n2. 查询区间 $[l,r]$ 内的最大子段和，可以不选数。\n", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n后面 $m$ 行：\n\n- `1 l r x`：把区间 $[l,r]$ 内所有数加上 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的最大子段和。\n", "outputFormat": "对于每个询问，输出一个数表示答案。\n", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：nzhtl1477&ccz181078&mrsrz，Data：nzhtl1477&mrsrz&w33z8kqrqk8zzzx33\n\n$1 \\le n , m \\le 10^5$，$| a_i | \\leq 10^9$，$|x|\\leq 10^9$。\n\n**保证任意时刻 $|a_i|\\leq 2\\times 10^9$。**\n\nBy nzhtl1477 & ccz181078\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] What Are You Doing at the End of the World? Are You Busy? Will You Save Us?", "background": "Thank you so much for today.\nYou let me experience so many wonderful things.\nI have left behind memories like a beautiful dream, but time is up.\nOne last favor.\nI hope you can forget me.\n\n ![](https://cdn.luogu.com.cn/upload/pic/13170.png) \n\nBefore I disappear,\nI hold a wish not to disappear.\nI hope someone will remember me.\nI hope to leave a bond.\nIf I wish for that, is there anything wrong?\n\n ![](https://cdn.luogu.com.cn/upload/pic/13171.png) \n\nSweet and fragrant, it smells so nice.\nIt looks delicious.\n\n ![](https://cdn.luogu.com.cn/upload/pic/13173.png) \n\nI kept...\nour... our promise.\nI really... really tried hard...\n\n ![](https://cdn.luogu.com.cn/upload/pic/13172.png) \n\nWelcome back, Chtholly.", "description": "Chtholly gives you a sequence $a$ of length $n$, and there are $m$ operations.\n\n1. Add $x$ to all numbers in the interval $[l, r]$.\n2. Query the maximum subarray sum in the interval $[l, r]$, where choosing no elements is allowed.", "inputFormat": "The first line contains two integers $n, m$.\nThe second line contains $n$ integers representing the sequence $a$.\nThe following $m$ lines:\n- `1 l r x`: add $x$ to all numbers in the interval $[l, r]$.\n- `2 l r`: query the maximum subarray sum in the interval $[l, r]$, with the empty subarray allowed.", "outputFormat": "For each query, output one number representing the answer.", "hint": "Idea: nzhtl1477, Solution: ccz181078, Code: nzhtl1477 & ccz181078 & mrsrz, Data: nzhtl1477 & mrsrz & w33z8kqrqk8zzzx33.\n\n$1 \\le n , m \\le 10^5$, $| a_i | \\leq 10^9$, $|x|\\leq 10^9$.\n\n**It is guaranteed that at any time $|a_i|\\leq 2\\times 10^9$.**\n\nBy nzhtl1477 & ccz181078.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] 末日时在做什么？有没有空？可以来拯救吗？", "background": "今天真是多谢你了\n\n让我体验了许多美好\n\n我留下了如同美梦一般的回忆 不过时间到了\n\n最后我还想拜托你一件事\n\n希望你可以把我忘掉\n\n ![](https://cdn.luogu.com.cn/upload/pic/13170.png) \n\n在自己消失之前\n\n心怀不想消失的愿望\n\n希望让某个人记住我\n\n希望能留下羁绊\n\n我这么希望着，又有什么不可以的吗\n\n ![](https://cdn.luogu.com.cn/upload/pic/13171.png) \n\n香香甜甜的，真好闻\n\n看起来很好吃\n\n ![](https://cdn.luogu.com.cn/upload/pic/13173.png) \n\n我遵守了...\n\n约...约定\n\n我非常...非常努力哦...\n\n ![](https://cdn.luogu.com.cn/upload/pic/13172.png) \n\n欢迎回来，珂朵莉\n", "description": "珂朵莉给了你一个长为 $n$ 的序列 $a$，有 $m$ 次操作。\n\n1. 把区间 $[l,r]$ 内所有数都加上 $x$。\n2. 查询区间 $[l,r]$ 内的最大子段和，可以不选数。\n", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n后面 $m$ 行：\n\n- `1 l r x`：把区间 $[l,r]$ 内所有数加上 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的最大子段和。\n", "outputFormat": "对于每个询问，输出一个数表示答案。\n", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：nzhtl1477&ccz181078&mrsrz，Data：nzhtl1477&mrsrz&w33z8kqrqk8zzzx33\n\n$1 \\le n , m \\le 10^5$，$| a_i | \\leq 10^9$，$|x|\\leq 10^9$。\n\n**保证任意时刻 $|a_i|\\leq 2\\times 10^9$。**\n\nBy nzhtl1477 & ccz181078\n", "locale": "zh-CN"}}}
{"pid": "P4119", "type": "P", "difficulty": 7, "samples": [["3 3\n2 3 3\n2 1 3 1\n1 1 3 3 1\n2 1 3 2", "2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2018", "并查集", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2018] 未来日记", "background": "所以说，小雪的未来是由乃的~\n\n ![](https://cdn.luogu.com.cn/upload/pic/13174.png) \n\n嗯...我知道你的未来会怎样\n\n听好吧，我妻由乃\n\n ![](https://cdn.luogu.com.cn/upload/pic/13175.png) \n\n因为小雪改变了未来，所以他们三人才能在一起...\n\n为什么...\n\n这样我简直就是坏人...\n\n ![](https://cdn.luogu.com.cn/upload/pic/13176.png) \n\n我不会刺的\n\n因为...这就是未来啊\n\n这里...就是我的家\n\n![](https://cdn.luogu.com.cn/upload/pic/13177.png)\n", "description": "我妻由乃给了你一个长为 $n$ 的序列 $a$，有 $m$ 次操作。\n\n1. 把区间 $[l,r]$ 内所有的 $x$ 变成 $y$。\n2. 查询区间 $[l,r]$ 内第 $k$ 小值。\n", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n后面 $m$ 行：\n\n`1 l r x y` : 把区间 $[l,r]$ 中所有 $x$ 变成 $y$。\n\n`2 l r k` : 查询区间 $[l,r]$ 中的 $k$ 小值。\n", "outputFormat": "对于每个询问，输出一个整数表示答案。\n", "hint": "Idea：f321dd，Solution：f321dd&nzhtl1477，Code：nzhtl1477&Claris，Data：nzhtl1477&Juan_feng\n\n$1\\le n,m,a_i \\le 10^5$。\n\nBy f321dd & nzhtl1477 & Claris\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] Future Diary", "background": "So, Xiaoxue’s (pinyin) future belongs to Yuno’s~\n\n![](https://cdn.luogu.com.cn/upload/pic/13174.png)\n\nHmm... I know what your future will be like.\n\nListen up, I am Yuno Gasai.\n\n![](https://cdn.luogu.com.cn/upload/pic/13175.png)\n\nBecause Xiaoxue changed the future, the three of them could be together...\n\nWhy...\n\nThat makes me the bad guy...\n\n![](https://cdn.luogu.com.cn/upload/pic/13176.png)\n\nI won’t stab.\n\nBecause... this is the future.\n\nThis... is my home.\n\n![](https://cdn.luogu.com.cn/upload/pic/13177.png)", "description": "Yuno Gasai gave you a sequence $a$ of length $n$, with $m$ operations.\n\n1. Replace all occurrences of $x$ with $y$ within the interval $[l, r]$.\n2. Query the $k$-th smallest value within the interval $[l, r]$.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThe second line contains $n$ integers representing the sequence $a$.\n\nThe next $m$ lines:\n\n`1 l r x y`: Replace all $x$ in $[l, r]$ with $y$.\n\n`2 l r k`: Query the $k$-th smallest value in $[l, r]$.", "outputFormat": "For each query, output one integer as the answer.", "hint": "Idea: f321dd, Solution: f321dd & nzhtl1477, Code: nzhtl1477 & Claris, testdata: nzhtl1477 & Juan_feng.\n\nConstraints: $1 \\le n, m, a_i \\le 10^5$.\n\nBy f321dd & nzhtl1477 & Claris.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] 未来日记", "background": "所以说，小雪的未来是由乃的~\n\n ![](https://cdn.luogu.com.cn/upload/pic/13174.png) \n\n嗯...我知道你的未来会怎样\n\n听好吧，我妻由乃\n\n ![](https://cdn.luogu.com.cn/upload/pic/13175.png) \n\n因为小雪改变了未来，所以他们三人才能在一起...\n\n为什么...\n\n这样我简直就是坏人...\n\n ![](https://cdn.luogu.com.cn/upload/pic/13176.png) \n\n我不会刺的\n\n因为...这就是未来啊\n\n这里...就是我的家\n\n![](https://cdn.luogu.com.cn/upload/pic/13177.png)\n", "description": "我妻由乃给了你一个长为 $n$ 的序列 $a$，有 $m$ 次操作。\n\n1. 把区间 $[l,r]$ 内所有的 $x$ 变成 $y$。\n2. 查询区间 $[l,r]$ 内第 $k$ 小值。\n", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n后面 $m$ 行：\n\n`1 l r x y` : 把区间 $[l,r]$ 中所有 $x$ 变成 $y$。\n\n`2 l r k` : 查询区间 $[l,r]$ 中的 $k$ 小值。\n", "outputFormat": "对于每个询问，输出一个整数表示答案。\n", "hint": "Idea：f321dd，Solution：f321dd&nzhtl1477，Code：nzhtl1477&Claris，Data：nzhtl1477&Juan_feng\n\n$1\\le n,m,a_i \\le 10^5$。\n\nBy f321dd & nzhtl1477 & Claris\n", "locale": "zh-CN"}}}
{"pid": "P4120", "type": "P", "difficulty": 7, "samples": [["mst 0\n4 5 2 3\n1 2 1\n1 3 1\n2 3 1\n2 4 2\n3 4 2", "5"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "生成树", "WC"], "title": "[WC2012] 最小生成树", "background": null, "description": "给定无向带权连通图$G$，我们希望通过修改边的权值，使它的最小生成树唯一，已知减小，增加一条边的权值的单位代价分别为 $a$ 和 $b$，且修改后的权值必须为非负整数。\n\n例如，对某个图 $G$，如果将一条边的权值减 $3$，另一条边的权值加 $2$ 之后，它的最小生成树唯一，则此时的代价之和是 $3a+2b$。试计算代价之和的最小值。", "inputFormat": "从文件mst.in中读入数据。\n\n第一行包含字符串“$mst$” 和数据编号。\n\n第二行包含 $4$ 个正整数 $n$,$m$,$a$,$b$，分别表示图 $G$ 顶点的个数，边的条数，以及对一条边的权值减小 $1$，增加 $1$ 的代价。\n\n接下来 $m$ 行，每行 $3$ 个正整数 $x$,$y$,$w$，表示顶点 $x$ 和顶点 $y$ 之间有一条初始权值为 $w$ 的边。\n\n顶点由 $1$ 至 $n$ 编号。", "outputFormat": "输出到文件mst.out中。\n\n输出文件仅一行，包含一个整数，表示最小代价，无需修改则输出 $0$。", "hint": "【样例说明】\n\n将边$(2,4)$的权值减 $1$，边$(2,3)$的权值加 $1$ 之后，图 $G$ 的最小生成树唯一，且此时的代价之和为最小值。\n\n【数据范围】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b10vkiev.png)\n[测试点$6$~$10$下载](https://pan.baidu.com/s/1bqiS6w3)", "locale": "zh-CN", "translations": {"en": {"title": "[WC2012] Minimum Spanning Tree", "background": "", "description": "Given an undirected, weighted, connected graph $G$, we want to modify edge weights so that its minimum spanning tree is unique. The unit costs to decrease and increase the weight of an edge by 1 are $a$ and $b$, respectively, and the modified weights must be non-negative integers.\n\nFor example, for some graph $G$, if after decreasing the weight of one edge by $3$ and increasing the weight of another edge by $2$ the minimum spanning tree becomes unique, then the total cost is $3a+2b$. Compute the minimal total cost.", "inputFormat": "Read from standard input.\n\nThe first line contains the string “$mst$” and a testdata ID.\n\nThe second line contains 4 positive integers $n$, $m$, $a$, $b$, denoting the number of vertices of $G$, the number of edges, and the unit costs to decrease an edge weight by $1$ and to increase it by $1$, respectively.\n\nEach of the next $m$ lines contains 3 positive integers $x$, $y$, $w$, indicating that there is an edge between vertices $x$ and $y$ with initial weight $w$.\n\nVertices are numbered from $1$ to $n$.", "outputFormat": "Write to standard output.\n\nOutput a single line containing one integer, the minimal total cost. If no modification is needed, output $0$.", "hint": "[Sample explanation]\n\nAfter decreasing the weight of edge $(2,4)$ by $1$ and increasing the weight of edge $(2,3)$ by $1$, the minimum spanning tree of graph $G$ becomes unique, and the total cost is minimal.\n\n[Constraints]\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b10vkiev.png)\n[Test points $6$~$10$ download](https://pan.baidu.com/s/1bqiS6w3)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2012] 最小生成树", "background": null, "description": "给定无向带权连通图$G$，我们希望通过修改边的权值，使它的最小生成树唯一，已知减小，增加一条边的权值的单位代价分别为 $a$ 和 $b$，且修改后的权值必须为非负整数。\n\n例如，对某个图 $G$，如果将一条边的权值减 $3$，另一条边的权值加 $2$ 之后，它的最小生成树唯一，则此时的代价之和是 $3a+2b$。试计算代价之和的最小值。", "inputFormat": "从文件mst.in中读入数据。\n\n第一行包含字符串“$mst$” 和数据编号。\n\n第二行包含 $4$ 个正整数 $n$,$m$,$a$,$b$，分别表示图 $G$ 顶点的个数，边的条数，以及对一条边的权值减小 $1$，增加 $1$ 的代价。\n\n接下来 $m$ 行，每行 $3$ 个正整数 $x$,$y$,$w$，表示顶点 $x$ 和顶点 $y$ 之间有一条初始权值为 $w$ 的边。\n\n顶点由 $1$ 至 $n$ 编号。", "outputFormat": "输出到文件mst.out中。\n\n输出文件仅一行，包含一个整数，表示最小代价，无需修改则输出 $0$。", "hint": "【样例说明】\n\n将边$(2,4)$的权值减 $1$，边$(2,3)$的权值加 $1$ 之后，图 $G$ 的最小生成树唯一，且此时的代价之和为最小值。\n\n【数据范围】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b10vkiev.png)\n[测试点$6$~$10$下载](https://pan.baidu.com/s/1bqiS6w3)", "locale": "zh-CN"}}}
{"pid": "P4121", "type": "P", "difficulty": 6, "samples": [["5\n0 1 0 0 0\n0 1 1 1 0\n1 0 0 0 1\n0 0 1 0 0\n1 0 0 0 0\n2\n3 2\n2 3", "4 3\n5 2"]], "limits": {"time": [700, 700, 700, 700, 700, 700, 700, 700, 700, 700], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "线段树", "并查集", "生成树", "动态树 LCT", "WC"], "title": "[WC2005] 双面棋盘", "background": "", "description": "佳佳有一个 $n$ 行 $n$ 列的黑白棋盘，每个格子都有两面，一面白色，一面黑色。佳佳把棋盘平放在桌子上，因此每个格子恰好一面朝上，如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rcejbuct.png)\n\n我们把每行从上到下编号为 $1$，$2$，$3$，……，$n$，各列从左到右编号为 $1$，$2$，$3$，……，$n$，则每个格子可以用棋盘坐标$(x, y)$表示。在上图中，有 $8$ 个格子黑色朝上，另外 $17$ 个格子白色朝上。\n\n如果两个同色格子有一条公共边，我们称这两个同色格子属于同一个连通块。上图共有 $5$ 个黑色连通块和 $3$ 个白色连通块。\n\n佳佳可以每分钟将一个格子翻转（即白色变成黑色，黑色变成白色），然后计算当前有多少个黑色连通块和白色连通块，你能算得更快吗？\n", "inputFormat": "输入文件的第一行包含一个正整数 $n$，为格子的边长。以下 $n$ 行每行 $n$ 个整数，非 $0$ 即 $1$，表示初始状态。$0$ 表示白色，$1$ 表示黑色。  \n\n下一行包含一个整数 $m$，表示操作的数目。以下 $m$ 行每行两个整数 $x$, $y$ ( $1 \\le x,y \\le n$ )，表示把坐标为 $(x, y)$ 的格子翻转。\n", "outputFormat": "输出文件包含 $m$ 行，每行对应一个操作。该行包括两个整数 $b$, $w$，表示黑色区域和白色区域数目。\n", "hint": "【样例说明】\n\n翻转 $(3, 2)$ 之后，棋盘变为：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9oqt0zsv.png)\n\n有 $4$ 个黑色区域和 $3$ 个白色区域\n\n翻转 $(2, 3)$ 之后，棋盘变为：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f335hulm.png)\n\n有 $5$ 个黑色区域和 $2$ 个白色区域\n\n【数据范围】   \n对于 $100\\%$ 的数据，$1\\le n \\le 200$，$1\\le m \\le 10^4$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[WC2005] Double-faced Board", "background": "", "description": "Jiajia has an $n \\times n$ black-and-white board. Each cell has two faces: one white and one black. Jiajia lays the board flat on the table, so exactly one face of each cell is up, as shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rcejbuct.png)\n\nWe number the rows from top to bottom as $1, 2, 3, \\ldots, n$, and the columns from left to right as $1, 2, 3, \\ldots, n$. Thus, each cell can be represented by board coordinates $(x, y)$. In the figure above, there are $8$ cells with the black side up, and the other $17$ cells have the white side up.\n\nIf two cells of the same color share a common edge, we say these two same-colored cells belong to the same connected component. In the figure above, there are $5$ black connected components and $3$ white connected components.\n\nJiajia can flip one cell per minute (i.e., white becomes black, and black becomes white), then count how many black connected components and white connected components there are. Can you compute it faster?", "inputFormat": "The first line contains a positive integer $n$, the side length of the board.  \nEach of the next $n$ lines contains $n$ integers, each either $0$ or $1$, representing the initial state. $0$ means white, and $1$ means black.\n\nThe next line contains an integer $m$, the number of operations.  \nEach of the next $m$ lines contains two integers $x$, $y$ ($1 \\le x, y \\le n$), indicating to flip the cell at coordinates $(x, y)$.", "outputFormat": "Output contains $m$ lines, one for each operation. Each line contains two integers $b$, $w$, denoting the numbers of black connected components and white connected components.", "hint": "【Sample Explanation】\n\nAfter flipping $(3, 2)$, the board becomes:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9oqt0zsv.png)\n\nThere are $4$ black connected components and $3$ white connected components.\n\nAfter flipping $(2, 3)$, the board becomes:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f335hulm.png)\n\nThere are $5$ black connected components and $2$ white connected components.\n\n【Constraints】  \nFor $100\\%$ of the testdata, $1 \\le n \\le 200$, $1 \\le m \\le 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2005] 双面棋盘", "background": "", "description": "佳佳有一个 $n$ 行 $n$ 列的黑白棋盘，每个格子都有两面，一面白色，一面黑色。佳佳把棋盘平放在桌子上，因此每个格子恰好一面朝上，如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rcejbuct.png)\n\n我们把每行从上到下编号为 $1$，$2$，$3$，……，$n$，各列从左到右编号为 $1$，$2$，$3$，……，$n$，则每个格子可以用棋盘坐标$(x, y)$表示。在上图中，有 $8$ 个格子黑色朝上，另外 $17$ 个格子白色朝上。\n\n如果两个同色格子有一条公共边，我们称这两个同色格子属于同一个连通块。上图共有 $5$ 个黑色连通块和 $3$ 个白色连通块。\n\n佳佳可以每分钟将一个格子翻转（即白色变成黑色，黑色变成白色），然后计算当前有多少个黑色连通块和白色连通块，你能算得更快吗？\n", "inputFormat": "输入文件的第一行包含一个正整数 $n$，为格子的边长。以下 $n$ 行每行 $n$ 个整数，非 $0$ 即 $1$，表示初始状态。$0$ 表示白色，$1$ 表示黑色。  \n\n下一行包含一个整数 $m$，表示操作的数目。以下 $m$ 行每行两个整数 $x$, $y$ ( $1 \\le x,y \\le n$ )，表示把坐标为 $(x, y)$ 的格子翻转。\n", "outputFormat": "输出文件包含 $m$ 行，每行对应一个操作。该行包括两个整数 $b$, $w$，表示黑色区域和白色区域数目。\n", "hint": "【样例说明】\n\n翻转 $(3, 2)$ 之后，棋盘变为：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9oqt0zsv.png)\n\n有 $4$ 个黑色区域和 $3$ 个白色区域\n\n翻转 $(2, 3)$ 之后，棋盘变为：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f335hulm.png)\n\n有 $5$ 个黑色区域和 $2$ 个白色区域\n\n【数据范围】   \n对于 $100\\%$ 的数据，$1\\le n \\le 200$，$1\\le m \\le 10^4$。\n", "locale": "zh-CN"}}}
{"pid": "P4122", "type": "P", "difficulty": 2, "samples": [["1 2 3 5\n6 0 10 4\n2 1 8 3", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2017", "USACO", "离散化"], "title": "[USACO17DEC] Blocked Billboard B", "background": "", "description": "During long milking sessions, Bessie the cow likes to stare out the window of her barn at two huge rectangular billboards across the street advertising \"Farmer Alex's Amazingly Appetizing Alfalfa\" and \"Farmer Greg's Great Grain\". Pictures of these two cow feed products on the billboards look much tastier to Bessie than the grass from her farm.\n\nOne day, as Bessie is staring out the window, she is alarmed to see a huge rectangular truck parking across the street. The side of the truck has an advertisement for \"Farmer Smith's Superb Steaks\", which Bessie doesn't quite understand, but she is mostly concerned about the truck potentially blocking the view of her two favorite billboards.\n\nGiven the locations of the two billboards and the location of the truck, please calculate the total combined area of both billboards that is still visible. It is possible that the truck obscures neither, both, or only one of the billboards.\n", "inputFormat": "The first line of input contains four space-separated integers: $x_1,y_1,x_2 y_2$, where $(x_1,y_1)$ and $(x_2,y_2)$ are the coordinates of the lower-left and upper-right corners of the first billboard in Bessie's 2D field of view. The next line contains four more integers, similarly specifying the lower-left and upper-right corners of the second billboard. The third and final line of input contains four integers specifying the lower-left and upper-right corners of the truck. All coordinates are in the range $-1000$ to $+1000$. The two billboards are guaranteed not to have any positive area of overlap between themselves.", "outputFormat": "Please output the total combined area of both billboards that remains visible.", "hint": "Here, 5 units of area from the first billboard and 12 units of area from the second billboard remain visible.\n\nProblem credits: Brian Dean", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] Blocked Billboard B", "background": "", "description": "During long milking sessions, Bessie the cow likes to stare out the window of her barn at two huge rectangular billboards across the street advertising \"Farmer Alex's Amazingly Appetizing Alfalfa\" and \"Farmer Greg's Great Grain\". Pictures of these two cow feed products on the billboards look much tastier to Bessie than the grass from her farm.\n\nOne day, as Bessie is staring out the window, she is alarmed to see a huge rectangular truck parking across the street. The side of the truck has an advertisement for \"Farmer Smith's Superb Steaks\", which Bessie doesn't quite understand, but she is mostly concerned about the truck potentially blocking the view of her two favorite billboards.\n\nGiven the locations of the two billboards and the location of the truck, please calculate the total combined area of both billboards that is still visible. It is possible that the truck obscures neither, both, or only one of the billboards.\n", "inputFormat": "The first line of input contains four space-separated integers: $x_1,y_1,x_2 y_2$, where $(x_1,y_1)$ and $(x_2,y_2)$ are the coordinates of the lower-left and upper-right corners of the first billboard in Bessie's 2D field of view. The next line contains four more integers, similarly specifying the lower-left and upper-right corners of the second billboard. The third and final line of input contains four integers specifying the lower-left and upper-right corners of the truck. All coordinates are in the range $-1000$ to $+1000$. The two billboards are guaranteed not to have any positive area of overlap between themselves.", "outputFormat": "Please output the total combined area of both billboards that remains visible.", "hint": "Here, 5 units of area from the first billboard and 12 units of area from the second billboard remain visible.\n\nProblem credits: Brian Dean", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] Blocked Billboard B", "background": null, "description": "在漫长的挤奶过程中，奶牛 Bessie 喜欢透过谷仓的窗户盯着街对面的两块巨大的矩形广告牌，上面分别写着“Farmer Alex 的美味苜蓿”和“Farmer Greg 的优质谷物”。广告牌上这两种奶牛饲料的图片对 Bessie 来说比她农场里的草看起来美味得多。\n\n有一天，当 Bessie 正盯着窗外时，她惊讶地看到一辆巨大的矩形卡车停在街对面。卡车的侧面有一则广告，写着“Farmer Smith 的顶级牛排”，Bessie 不太理解这则广告，但她更担心的是卡车可能会挡住她最喜欢的两块广告牌的视线。\n\n给定两块广告牌和卡车的位置，请计算两块广告牌仍然可见的总面积。卡车可能遮挡了其中一块、两块，或者没有遮挡任何一块广告牌。", "inputFormat": "输入的第一行包含四个用空格分隔的整数：$x_1,y_1,x_2,y_2$，其中 $(x_1,y_1)$ 和 $(x_2,y_2)$ 是 Bessie 的二维视野中第一块广告牌的左下角和右上角坐标。第二行包含四个整数，以相同的方式指定第二块广告牌的左下角和右上角坐标。第三行也是最后一行输入包含四个整数，指定卡车的左下角和右上角坐标。所有坐标都在 $-1000$ 到 $+1000$ 的范围内。保证两块广告牌之间没有任何重叠的正面积区域。", "outputFormat": "请输出两块广告牌仍然可见的总面积。", "hint": "在这个例子中，第一块广告牌有 $5$ 单位面积可见，第二块广告牌有 $12$ 单位面积可见。\n\n题目来源：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P4123", "type": "P", "difficulty": 6, "samples": [["4 4\n1 2 3\n1 3 6\n2 4 5\n3 4 4", "3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "重庆", "各省省选", "网络流", "分治", "最小割"], "title": "[CQOI2016] 不同的最小割", "background": "", "description": "学过图论的同学都知道最小割的概念：对于一个图，某个对图中结点的划分将图中所有结点分成两个部分，如果结点 $s,t$ 不在同一个部分中，则称这个划分是关于 $s,t$ 的割。对于带权图来说，将所有顶点处在不同部分的边的权值相加所得到的值定义为这个割的容量，而 $s,t$ 的最小割指的是在关于 $s,t$ 的割中容量最小的割。\n\n而对冲刺 NOI 竞赛的选手而言，求带权图中两点的最小割已经不是什么难事了。我们可以把视野放宽，考虑有 $N$ 个点的无向连通图中所有点对的最小割的容量，共能得到 $N(N-1)/2$ 个数值。这些数值中互不相同的有多少个呢？这似乎是个有趣的问题。", "inputFormat": "第一行包含两个数 $N,M$，表示点数和边数。\n\n接下来 $M$ 行，每行三个数 $u,v,w$，表示点 $u$ 和点 $v$ (从 $1$ 开始标号) 之间有一条权值是 $w$ 的边。", "outputFormat": "第一行为一个整数，表示不同的最小割容量的个数。", "hint": "$1\\leq N\\leq 850,1\\leq M\\leq 8500,1\\leq w\\leq 100000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2016] Distinct Minimum Cuts", "background": "", "description": "Students who have studied graph theory all know the concept of the minimum cut: For a graph, a partition of the nodes divides all nodes into two parts. If nodes $s, t$ are not in the same part, then the partition is called a cut with respect to $s, t$. For a weighted graph, the capacity of a cut is defined as the sum of the weights of edges whose endpoints lie in different parts, and the $s, t$ minimum cut is the cut of minimum capacity among all cuts with respect to $s, t$.\n\nFor contestants preparing for the NOI, finding the minimum cut between two nodes in a weighted graph is no longer difficult. Let us broaden the view: In an undirected connected graph with $N$ nodes, consider the minimum cut capacity for every unordered pair of nodes. In total we obtain $\\,$ $N(N-1)/2$ $\\,$ values. How many of these values are distinct? This seems like an interesting problem.", "inputFormat": "The first line contains two integers $N, M$, the number of nodes and the number of edges.\n\nEach of the next $M$ lines contains three integers $u, v, w$, indicating there is an edge between node $u$ and node $v$ (indexed from $1$) with weight $w$.", "outputFormat": "Output a single integer on the first line, the number of distinct minimum cut capacities.", "hint": "Constraints: $1 \\leq N \\leq 850$, $1 \\leq M \\leq 8500$, $1 \\leq w \\leq 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2016] 不同的最小割", "background": "", "description": "学过图论的同学都知道最小割的概念：对于一个图，某个对图中结点的划分将图中所有结点分成两个部分，如果结点 $s,t$ 不在同一个部分中，则称这个划分是关于 $s,t$ 的割。对于带权图来说，将所有顶点处在不同部分的边的权值相加所得到的值定义为这个割的容量，而 $s,t$ 的最小割指的是在关于 $s,t$ 的割中容量最小的割。\n\n而对冲刺 NOI 竞赛的选手而言，求带权图中两点的最小割已经不是什么难事了。我们可以把视野放宽，考虑有 $N$ 个点的无向连通图中所有点对的最小割的容量，共能得到 $N(N-1)/2$ 个数值。这些数值中互不相同的有多少个呢？这似乎是个有趣的问题。", "inputFormat": "第一行包含两个数 $N,M$，表示点数和边数。\n\n接下来 $M$ 行，每行三个数 $u,v,w$，表示点 $u$ 和点 $v$ (从 $1$ 开始标号) 之间有一条权值是 $w$ 的边。", "outputFormat": "第一行为一个整数，表示不同的最小割容量的个数。", "hint": "$1\\leq N\\leq 850,1\\leq M\\leq 8500,1\\leq w\\leq 100000$。", "locale": "zh-CN"}}}
{"pid": "P4124", "type": "P", "difficulty": 5, "samples": [["12121284000 12121285550", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2016", "重庆", "各省省选", "数位 DP"], "title": "[CQOI2016] 手机号码", "background": "", "description": "人们选择手机号码时都希望号码好记、吉利。比如号码中含有几位相邻的相同数字、不含谐音不吉利的数字等。手机运营商在发行新号码时也会考虑这些因素，从号段中选取含有某些特征的号码单独出售。为了便于前期规划，运营商希望开发一个工具来自动统计号段中满足特征的号码数量。\n\n工具需要检测的号码特征有两个：号码中要出现至少 $3$ 个相邻的相同数字；号码中不能同时出现 $8$ 和 $4$。号码必须同时包含两个特征才满足条件。满足条件的号码例如：13000988721、23333333333、14444101000。而不满足条件的号码例如：1015400080、10010012022。\n\n手机号码一定是 $11$ 位数，且不含前导的 $0$。工具接收两个数 $L$ 和 $R$，自动统计出 $[L,R]$ 区间内所有满足条件的号码数量。$L$ 和 $R$ 也是 $11$ 位的手机号码。", "inputFormat": "输入文件内容只有一行，为空格分隔的 $2$ 个正整数 $L,R$。", "outputFormat": "输出文件内容只有一行，为 $1$ 个整数，表示满足条件的手机号数量。", "hint": "样例解释：满足条件的号码： 12121285000、 12121285111、 12121285222、 12121285333、 12121285550。\n\n数据范围：$10^{10}\\leq L\\leq R<10^{11}$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2016] Mobile Phone Number", "background": "", "description": "People prefer mobile phone numbers that are easy to remember or considered lucky. For example, numbers that contain several adjacent identical digits, or numbers that avoid digits with inauspicious homophones. Mobile operators also consider these factors when issuing new numbers and may select numbers with certain features from a number range to sell separately. To aid planning, the operator wants a tool to automatically count how many numbers in a range satisfy certain features.\n\nThe tool checks two features: the number must contain at least $3$ consecutive identical digits; the number must not contain both $8$ and $4$ at the same time. A number is valid only if it satisfies both features. Examples that satisfy the conditions: 13000988721, 23333333333, 14444101000. Examples that do not satisfy the conditions: 1015400080, 10010012022.\n\nA mobile phone number has exactly $11$ digits and does not have a leading $0$. The tool receives two numbers $L$ and $R$ and automatically counts how many numbers in the interval $[L,R]$ satisfy the conditions. $L$ and $R$ are also $11$-digit mobile phone numbers.", "inputFormat": "The input contains a single line with $2$ positive integers $L,R$ separated by a space.", "outputFormat": "Output a single line with $1$ integer, the number of valid mobile phone numbers.", "hint": "Sample explanation: valid numbers are 12121285000, 12121285111, 12121285222, 12121285333, 12121285550.\n\nConstraints: $10^{10}\\leq L\\leq R<10^{11}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2016] 手机号码", "background": "", "description": "人们选择手机号码时都希望号码好记、吉利。比如号码中含有几位相邻的相同数字、不含谐音不吉利的数字等。手机运营商在发行新号码时也会考虑这些因素，从号段中选取含有某些特征的号码单独出售。为了便于前期规划，运营商希望开发一个工具来自动统计号段中满足特征的号码数量。\n\n工具需要检测的号码特征有两个：号码中要出现至少 $3$ 个相邻的相同数字；号码中不能同时出现 $8$ 和 $4$。号码必须同时包含两个特征才满足条件。满足条件的号码例如：13000988721、23333333333、14444101000。而不满足条件的号码例如：1015400080、10010012022。\n\n手机号码一定是 $11$ 位数，且不含前导的 $0$。工具接收两个数 $L$ 和 $R$，自动统计出 $[L,R]$ 区间内所有满足条件的号码数量。$L$ 和 $R$ 也是 $11$ 位的手机号码。", "inputFormat": "输入文件内容只有一行，为空格分隔的 $2$ 个正整数 $L,R$。", "outputFormat": "输出文件内容只有一行，为 $1$ 个整数，表示满足条件的手机号数量。", "hint": "样例解释：满足条件的号码： 12121285000、 12121285111、 12121285222、 12121285333、 12121285550。\n\n数据范围：$10^{10}\\leq L\\leq R<10^{11}$。", "locale": "zh-CN"}}}
{"pid": "P4125", "type": "P", "difficulty": 7, "samples": [["5 \n2 5 5 8 \n2 1 3 5 \n5 2 6 5 \n7 0 4 2 \n3 1 4 0 \n2 0 \n3 0 \n4 0 \n1 2 \n5 1 ", "3 \n2 0 \n3 0 \n4 3 \n1 2 \n5 1 "], ["4\n-1 1 2 3\n13 5 9 8\n10 10 15 14\n10 17 0 20\n3 1\n2 1\n1 1\n\n4 1", "2\n4 1\n3 1\n2 1\n1 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2012", "线段树", "Special Judge", "拓扑排序", "WC"], "title": "[WC2012] 记忆中的水杉树", "background": "", "description": "江苏省常州高级中学是一所百年名校，这里萦绕着无数人难以忘怀的回忆。\n\nWill 记得，在他小的时候，常州高级中学改建以前，学校里有一片高大的水杉林，每到水杉落叶之时，针状的叶子会像毯子一样盖在地上，走在上面浪漫而又闲适。那时，Will 和同学们还喜欢用这些针叶，在水杉树下，玩“取叶子”的游戏。 \n\n游戏一开始，大家先将 $n$ 片针叶平铺在地上。接着，每一轮可以有一个同学选择一片针叶，按水平或者垂直方向将针叶移走（也就是平移到无穷远处）——当然，前提是移动过程中不被任何尚未移走的针叶所阻碍。如果某一轮针叶的移动会被阻碍，那么这次移动就是非法的，是不被允许的。\n\n$n$ 轮过后，当针叶都被移走时，游戏也就结束了。 针叶并不是任何时刻都可以被移动的。当针叶很多的时候，判断每一轮中一片针叶是否可以按一个特定的方向移动是一件很麻烦的事情。 现在我们将地面抽象为平面直角坐标系，$n$ 片针叶抽象为平面上 $n$ 条互不相交的线段，并将其从 $1$ 到 $n$ 编号，Will 还将给出每一轮游戏中，他想要移动的针叶编号以及移动方向，请你帮助他：\n\n1. 找出最早的一次非法移动出现在哪一轮；\n\n2. 给出一个合法的移动方案完成这个游戏。\n\n注意：在线段移动时仅端点接触不会造成阻碍，具体请参见样例。\n", "inputFormat": "输入文件的第一行包含一个正整数 $n$，表示针叶的数量。\n\n接下来 $n$ 行，每行 $4$ 个整数，描述针叶的位置信息。其中第 $i$ 行的整数为 $a_i$，$b_i$，$c_i$，$d_i$，表示编号为 $i$ 的针叶所抽象成的线段的端点为$(a_i, b_i)$和$(c_i, d_i)$。\n\n接下来 $n$ 行，每行 $2$ 个整数，描述移动操作。其中第 $i$ 行的整数为 $p_i$，$q_i$，表示第 $i$ 轮移动的针叶编号为 $p_i$，方向为 $q_i$。其中 $q_i$为一个 $0$ 到 $3$ 之间的整数，$0$ 表示向左平移（即 $x$ 轴负方向） ，$1$ 表示向上平移（即 $y$ 轴正方向） ，$2$ 表示向右平移，$3$ 表示向下平移。\n\n输入数据保证：\n\n- 所有线段长度为正，两两之间没有公共点，且不存在垂直或者水平的线段;\n- $p_1$ 到 $p_n$ 恰好组成一个 $1$ 到 $n$ 的排列；\n- Will 所给出的移动操作中一定存在非法移动；\n- $n$ 轮均合法的移动操作总是存在的。\n", "outputFormat": "输出文件一共包含 $n+1$ 行。\n\n输出的第一行包含一个 $1$ 到 $n$ 之间的整数，表示最早出现非法移动的是哪一轮。\n\n接下来 $n$ 行，每行两个整数，内容同输入格式所述，描述一个合法的移动序列。\n", "hint": "【样例说明】\n\n在 Will 给出的移动方案的第 $3$ 轮中，编号为 $4$ 的针叶向左移动会被编号为 $5$ 的针叶阻碍。\n\n【数据范围】\n\n具体数据范围见下表。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y7thkctp.png)\n\n对于一个测试点：\n\n如果非法移动判断正确，但是给出的方案错误，可以得到 $5$ 分。此时会提示：`An invalid move in step`\n\n如果非法移动判断错误，但是给出的方案正确，可以得到 $5$ 分。此时会提示：`Negative error detection!`\n\n如果非法移动的判断与给出方案均正确，则可以得到 $10$ 分；\n\n否则，得 $0$ 分。\n\n 如果程序的输出格式不正确，将被直接判作输出格式不正确，将被直接判作 $0$ 分。\n", "locale": "zh-CN", "translations": {"en": {"title": "[WC2012] Metasequoia in Memory", "background": "", "description": "Changzhou Senior High School of Jiangsu is a century-old prestigious school, filled with countless unforgettable memories.\n\nWill remembers that when he was little, before the school's reconstruction, there was a tall metasequoia grove. When the metasequoias shed their leaves, the needles would cover the ground like a blanket, making it romantic and leisurely to walk on. Back then, Will and his classmates liked to use these needles to play a “taking needles” game under the metasequoias.\n\nAt the start of the game, everyone lays $n$ needles flat on the ground. Then, in each round, one player may choose one needle and move it in the horizontal or vertical direction (that is, translate it to infinity) — provided that during the movement it is not blocked by any needle that has not yet been moved away. If a needle’s movement would be blocked in a round, then this move is illegal and not allowed.\n\nAfter $n$ rounds, when all needles have been removed, the game ends. Not every needle can be moved at any time. When there are many needles, determining in each round whether a specific needle can be moved in a given direction is troublesome. Now we abstract the ground as a 2D Cartesian plane, the $n$ needles as $n$ pairwise disjoint line segments in the plane, labeled from $1$ to $n$. Will also provides, for each round, the index of the needle he wants to move and the direction. Please help him:\n\n1. Find in which round the earliest illegal move occurs.\n2. Provide a legal move sequence that completes the game.\n\nNote: When moving segments, merely touching at endpoints does not cause obstruction. See the sample for details.", "inputFormat": "The first line contains a positive integer $n$, the number of needles.\n\nThe next $n$ lines each contain $4$ integers describing the positions of the needles. On the $i$-th of these lines, the integers $a_i$, $b_i$, $c_i$, $d_i$ indicate that the endpoints of the line segment abstracting needle $i$ are $(a_i, b_i)$ and $(c_i, d_i)$.\n\nThe next $n$ lines each contain $2$ integers describing the moves. On the $i$-th of these lines, the integers $p_i$, $q_i$ indicate that in round $i$, the needle to move is $p_i$, and the direction is $q_i$. Here $q_i$ is an integer between $0$ and $3$: $0$ means move left (the negative $x$-axis direction), $1$ means move up (the positive $y$-axis direction), $2$ means move right, and $3$ means move down.\n\nThe input is guaranteed that:\n\n- All segments have positive length, no two segments share a point, and there are no vertical or horizontal segments.\n- $p_1$ through $p_n$ form a permutation of $1$ through $n$.\n- There is at least one illegal move in Will’s given sequence.\n- There always exists a sequence of $n$ legal moves that completes the game.", "outputFormat": "The output contains $n+1$ lines.\n\nThe first line contains an integer between $1$ and $n$, indicating the earliest round in which an illegal move occurs.\n\nThe next $n$ lines each contain two integers, as in the input format, describing a legal move sequence.", "hint": "[Sample explanation]\n\nIn round $3$ of Will’s given plan, moving needle $4$ to the left is blocked by needle $5$.\n\n[Constraints]\n\nSee the table below.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y7thkctp.png)\n\nFor a test point:\n\n- If the illegal move detection is correct but the provided plan is wrong, you can get $5$ points. The message will be: `An invalid move in step`.\n- If the illegal move detection is wrong but the provided plan is correct, you can get $5$ points. The message will be: `Negative error detection!`.\n- If both the detection and the plan are correct, you get $10$ points; otherwise, $0$ points.\n\nIf the program’s output format is incorrect, it will be directly judged as $0$ points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2012] 记忆中的水杉树", "background": "", "description": "江苏省常州高级中学是一所百年名校，这里萦绕着无数人难以忘怀的回忆。\n\nWill 记得，在他小的时候，常州高级中学改建以前，学校里有一片高大的水杉林，每到水杉落叶之时，针状的叶子会像毯子一样盖在地上，走在上面浪漫而又闲适。那时，Will 和同学们还喜欢用这些针叶，在水杉树下，玩“取叶子”的游戏。 \n\n游戏一开始，大家先将 $n$ 片针叶平铺在地上。接着，每一轮可以有一个同学选择一片针叶，按水平或者垂直方向将针叶移走（也就是平移到无穷远处）——当然，前提是移动过程中不被任何尚未移走的针叶所阻碍。如果某一轮针叶的移动会被阻碍，那么这次移动就是非法的，是不被允许的。\n\n$n$ 轮过后，当针叶都被移走时，游戏也就结束了。 针叶并不是任何时刻都可以被移动的。当针叶很多的时候，判断每一轮中一片针叶是否可以按一个特定的方向移动是一件很麻烦的事情。 现在我们将地面抽象为平面直角坐标系，$n$ 片针叶抽象为平面上 $n$ 条互不相交的线段，并将其从 $1$ 到 $n$ 编号，Will 还将给出每一轮游戏中，他想要移动的针叶编号以及移动方向，请你帮助他：\n\n1. 找出最早的一次非法移动出现在哪一轮；\n\n2. 给出一个合法的移动方案完成这个游戏。\n\n注意：在线段移动时仅端点接触不会造成阻碍，具体请参见样例。\n", "inputFormat": "输入文件的第一行包含一个正整数 $n$，表示针叶的数量。\n\n接下来 $n$ 行，每行 $4$ 个整数，描述针叶的位置信息。其中第 $i$ 行的整数为 $a_i$，$b_i$，$c_i$，$d_i$，表示编号为 $i$ 的针叶所抽象成的线段的端点为$(a_i, b_i)$和$(c_i, d_i)$。\n\n接下来 $n$ 行，每行 $2$ 个整数，描述移动操作。其中第 $i$ 行的整数为 $p_i$，$q_i$，表示第 $i$ 轮移动的针叶编号为 $p_i$，方向为 $q_i$。其中 $q_i$为一个 $0$ 到 $3$ 之间的整数，$0$ 表示向左平移（即 $x$ 轴负方向） ，$1$ 表示向上平移（即 $y$ 轴正方向） ，$2$ 表示向右平移，$3$ 表示向下平移。\n\n输入数据保证：\n\n- 所有线段长度为正，两两之间没有公共点，且不存在垂直或者水平的线段;\n- $p_1$ 到 $p_n$ 恰好组成一个 $1$ 到 $n$ 的排列；\n- Will 所给出的移动操作中一定存在非法移动；\n- $n$ 轮均合法的移动操作总是存在的。\n", "outputFormat": "输出文件一共包含 $n+1$ 行。\n\n输出的第一行包含一个 $1$ 到 $n$ 之间的整数，表示最早出现非法移动的是哪一轮。\n\n接下来 $n$ 行，每行两个整数，内容同输入格式所述，描述一个合法的移动序列。\n", "hint": "【样例说明】\n\n在 Will 给出的移动方案的第 $3$ 轮中，编号为 $4$ 的针叶向左移动会被编号为 $5$ 的针叶阻碍。\n\n【数据范围】\n\n具体数据范围见下表。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y7thkctp.png)\n\n对于一个测试点：\n\n如果非法移动判断正确，但是给出的方案错误，可以得到 $5$ 分。此时会提示：`An invalid move in step`\n\n如果非法移动判断错误，但是给出的方案正确，可以得到 $5$ 分。此时会提示：`Negative error detection!`\n\n如果非法移动的判断与给出方案均正确，则可以得到 $10$ 分；\n\n否则，得 $0$ 分。\n\n 如果程序的输出格式不正确，将被直接判作输出格式不正确，将被直接判作 $0$ 分。\n", "locale": "zh-CN"}}}
{"pid": "P4126", "type": "P", "difficulty": 6, "samples": [["6 7 1 6\n1 2 3\n1 3 2\n2 4 4\n2 5 1\n3 5 5\n4 6 2\n5 6 3", "1 0\n1 0\n0 0\n1 0\n0 0\n1 0\n1 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "并查集", "各省省选", "安徽", "强连通分量", "最小割"], "title": "[AHOI2009] 最小割", "background": null, "description": "$A,B$ 两个国家正在交战，其中 $A$ 国的物资运输网中有 $N$ 个中转站，$M$ 条单向道路。设其中第 $i(1\\le i\\le M)$ 条道路连接了 $v_i,u_i$ 两个中转站，那么中转站 $v_i$ 可以通过该道路到达 $u_i$ 中转站，如果切断这条道路，需要代价 $c_i$。\n\n现在 $B$ 国想找出一个路径切断方案，使中转站 $s$ 不能到达中转站 $t$，并且切断路径的代价之和最小。\n\n小可可一眼就看出，这是一个求最小割的问题。但爱思考的小可可并不局限于此。现在他对每条单向道路提出两个问题：\n\n- 问题一：是否存在一个最小代价路径切断方案，其中该道路被切断？\n- 问题二：是否对任何一个最小代价路径切断方案，都有该道路被切断？\n\n现在请你回答这两个问题。", "inputFormat": "第一行有 $4$ 个正整数，依次为 $N,M,s,t$。\n\n第 $2$ 行到第 $(M+1)$ 行每行 $3$ 个正整数 $v,u,c$，表示 $v$ 中转站到 $u$ 中转站之间有单向道路相连，单向道路的起点是 $v$，终点是 $u$，切断它的代价是 $c(1\\le c\\le100000)$。\n\n注意:两个中转站之间可能有多条道路直接相连。 同一行相邻两数之间可能有一个或多个空格。", "outputFormat": "对每条单向边，按输入顺序，依次输出一行，包含两个非 $0$ 即 $1$ 的整数，分别表示对问题一和问题二的回答(其中输出 $1$ 表示是，输出 $0$ 表示否)。 同一行相邻两数之间用一个空格隔开，每行开头和末尾没有多余空格。", "hint": "设第 $(i+1)$ 行输入的边为 $i$ 号边，那么 $\\{1,2\\},\\{6,7\\},\\{2,4,6\\}$ 是仅有的三个最小代价切割方案。它们的并是 $\\{1,2,4,6,7\\}$，交是 $\\{\\varnothing \\}$。\n\n测试数据规模如下表所示\n\n数据编号|N|M|数据编号|N|M\n-|-|-|-|-|-\n1|10|50|6|1000|20000\n2|20|200|7|1000|40000\n3|200|2000|8|2000|50000\n4|200|2000|9|3000|60000\n5|1000|20000|10|4000|60000", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2009] Minimum Cut", "background": "", "description": "Countries $A, B$ are at war. In country $A$’s supply transport network, there are $N$ transshipment stations and $M$ directed roads. Suppose the $i$-th ($1\\le i\\le M$) road connects stations $v_i, u_i$, meaning that station $v_i$ can reach station $u_i$ via this road. Cutting this road costs $c_i$.\n\nCountry $B$ wants to find a set of roads to cut so that station $s$ cannot reach station $t$, and the total cutting cost is minimized.\n\nXiao Keke immediately recognizes that this is a minimum cut problem. But the thoughtful Xiao Keke goes further. For each directed road, he asks two questions:\n\n- Question 1: Does there exist a minimum-cost cut in which this road is cut?\n- Question 2: Is this road cut in every minimum-cost cut?\n\nPlease answer these two questions.", "inputFormat": "The first line contains $4$ positive integers: $N, M, s, t$.\n\nEach of the next $M$ lines contains $3$ positive integers $v, u, c$, indicating a directed road from station $v$ to station $u$, with cutting cost $c$ ($1\\le c\\le 100000$).\n\nNote: There may be multiple roads directly connecting the same pair of stations. Within the same line, adjacent numbers may be separated by one or more spaces.", "outputFormat": "For each directed road, in the input order, output one line containing two integers, each either $0$ or $1$. They are the answers to Question 1 and Question 2 respectively ($1$ means yes, $0$ means no). Separate the two numbers on the same line with a single space, and do not print extra spaces at the beginning or end of the line.", "hint": "Let the edge given on line $(i+1)$ be labeled as edge $i$. Then $\\{1,2\\}, \\{6,7\\}, \\{2,4,6\\}$ are the only three minimum-cost cuts. Their union is $\\{1,2,4,6,7\\}$, and their intersection is $\\varnothing$.\n\nThe scale of the testdata is shown in the table below.\n\nTestdata ID|N|M|Testdata ID|N|M\n-|-|-|-|-|-\n1|10|50|6|1000|20000\n2|20|200|7|1000|40000\n3|200|2000|8|2000|50000\n4|200|2000|9|3000|60000\n5|1000|20000|10|4000|60000\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2009] 最小割", "background": null, "description": "$A,B$ 两个国家正在交战，其中 $A$ 国的物资运输网中有 $N$ 个中转站，$M$ 条单向道路。设其中第 $i(1\\le i\\le M)$ 条道路连接了 $v_i,u_i$ 两个中转站，那么中转站 $v_i$ 可以通过该道路到达 $u_i$ 中转站，如果切断这条道路，需要代价 $c_i$。\n\n现在 $B$ 国想找出一个路径切断方案，使中转站 $s$ 不能到达中转站 $t$，并且切断路径的代价之和最小。\n\n小可可一眼就看出，这是一个求最小割的问题。但爱思考的小可可并不局限于此。现在他对每条单向道路提出两个问题：\n\n- 问题一：是否存在一个最小代价路径切断方案，其中该道路被切断？\n- 问题二：是否对任何一个最小代价路径切断方案，都有该道路被切断？\n\n现在请你回答这两个问题。", "inputFormat": "第一行有 $4$ 个正整数，依次为 $N,M,s,t$。\n\n第 $2$ 行到第 $(M+1)$ 行每行 $3$ 个正整数 $v,u,c$，表示 $v$ 中转站到 $u$ 中转站之间有单向道路相连，单向道路的起点是 $v$，终点是 $u$，切断它的代价是 $c(1\\le c\\le100000)$。\n\n注意:两个中转站之间可能有多条道路直接相连。 同一行相邻两数之间可能有一个或多个空格。", "outputFormat": "对每条单向边，按输入顺序，依次输出一行，包含两个非 $0$ 即 $1$ 的整数，分别表示对问题一和问题二的回答(其中输出 $1$ 表示是，输出 $0$ 表示否)。 同一行相邻两数之间用一个空格隔开，每行开头和末尾没有多余空格。", "hint": "设第 $(i+1)$ 行输入的边为 $i$ 号边，那么 $\\{1,2\\},\\{6,7\\},\\{2,4,6\\}$ 是仅有的三个最小代价切割方案。它们的并是 $\\{1,2,4,6,7\\}$，交是 $\\{\\varnothing \\}$。\n\n测试数据规模如下表所示\n\n数据编号|N|M|数据编号|N|M\n-|-|-|-|-|-\n1|10|50|6|1000|20000\n2|20|200|7|1000|40000\n3|200|2000|8|2000|50000\n4|200|2000|9|3000|60000\n5|1000|20000|10|4000|60000", "locale": "zh-CN"}}}
{"pid": "P4127", "type": "P", "difficulty": 5, "samples": [["10 19", "3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "递推", "2009", "各省省选", "安徽", "枚举", "数位 DP"], "title": "[AHOI2009] 同类分布", "background": null, "description": "给出两个数 $a,b$，求出 $[a,b]$ 中各位数字之和能整除原数的数的个数。", "inputFormat": "一行，两个整数 $a$ 和 $b$。", "outputFormat": "一个整数，表示答案。", "hint": "对于所有的数据，$1 \\le a \\le b \\le 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2009] Similar Distribution", "background": "", "description": "Given two numbers $a, b$, find the count of integers in $[a, b]$ whose sum of digits divides the number itself.", "inputFormat": "One line, two integers $a$ and $b$.", "outputFormat": "A single integer representing the answer.", "hint": "For all testdata, $1 \\le a \\le b \\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2009] 同类分布", "background": null, "description": "给出两个数 $a,b$，求出 $[a,b]$ 中各位数字之和能整除原数的数的个数。", "inputFormat": "一行，两个整数 $a$ 和 $b$。", "outputFormat": "一个整数，表示答案。", "hint": "对于所有的数据，$1 \\le a \\le b \\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P4128", "type": "P", "difficulty": 7, "samples": [["1 1 2", "1"], ["3 2 97", "4"], ["3 4 97", "20"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2006", "各省省选", "上海", "群论", "置换", "Pólya 定理"], "title": "[SHOI2006] 有色图", "background": null, "description": "如果一张无向完全图（完全图就是任意两个不同的顶点之间有且仅有一条边相连）的每条边都被染成了一种颜色，我们就称这种图为有色图。如果两张有色图有相同数量的顶点，而且经过某种顶点编号的重排，能够使得两张图对应的边的颜色是一样的，我们就称这两张有色图是同构的。以下两张图就是同构的，因为假如你把第一张图的顶点 $(1,2,3,4)$ 置换成第二张图的 $(4,1,2,3)$，就会发现它们是一样的。\n\n![](https://cdn.luogu.com.cn/upload/pic/13240.png) \n\n你的任务是，对于计算所有顶点数为 $n$，颜色种类不超过 $m$ 的图，最多有几张是两两不同构的图。由于最后的答案会很大，你只要输出结论模 $p$ 的余数就可以了（$p$ 是一个质数）。", "inputFormat": "输入文件只有一行，由三个正整数 $n,m,p$ 组成。", "outputFormat": "即总数模 $p$ 后的余数。", "hint": "对于 $100 \\%$ 的数据，$1\\leq n\\leq 53$，$1\\leq m\\leq 1000$，$n<p\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2006] Colored Graph", "background": "", "description": "If every edge of an undirected complete graph (a complete graph means that any two distinct vertices are connected by exactly one edge) is colored with one color, we call such a graph a colored graph. If two colored graphs have the same number of vertices and, after some relabeling of the vertices, the colors of the corresponding edges are identical, then the two colored graphs are said to be isomorphic. The following two graphs are isomorphic, because if you permute the vertices of the first graph $(1,2,3,4)$ into $(4,1,2,3)$ in the second graph, you will find they are the same.\n\n![](https://cdn.luogu.com.cn/upload/pic/13240.png) \n\nYour task is to compute, among all undirected complete graphs on $n$ vertices whose edges are colored using at most $m$ colors, how many pairwise non-isomorphic graphs there are. Since the answer can be very large, you only need to output the remainder modulo $p$ (where $p$ is a prime).", "inputFormat": "The input contains a single line with three positive integers $n,m,p$.", "outputFormat": "Output the remainder of the total count modulo $p$.", "hint": "For $100\\%$ of the testdata, $1 \\leq n \\leq 53$, $1 \\leq m \\leq 1000$, $n < p \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2006] 有色图", "background": null, "description": "如果一张无向完全图（完全图就是任意两个不同的顶点之间有且仅有一条边相连）的每条边都被染成了一种颜色，我们就称这种图为有色图。如果两张有色图有相同数量的顶点，而且经过某种顶点编号的重排，能够使得两张图对应的边的颜色是一样的，我们就称这两张有色图是同构的。以下两张图就是同构的，因为假如你把第一张图的顶点 $(1,2,3,4)$ 置换成第二张图的 $(4,1,2,3)$，就会发现它们是一样的。\n\n![](https://cdn.luogu.com.cn/upload/pic/13240.png) \n\n你的任务是，对于计算所有顶点数为 $n$，颜色种类不超过 $m$ 的图，最多有几张是两两不同构的图。由于最后的答案会很大，你只要输出结论模 $p$ 的余数就可以了（$p$ 是一个质数）。", "inputFormat": "输入文件只有一行，由三个正整数 $n,m,p$ 组成。", "outputFormat": "即总数模 $p$ 后的余数。", "hint": "对于 $100 \\%$ 的数据，$1\\leq n\\leq 53$，$1\\leq m\\leq 1000$，$n<p\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4129", "type": "P", "difficulty": 5, "samples": [["14 3\n9 1 2 3 4 5 6 7 8 3\n7 2 9 10 11 12 13 10\n2 2 14", "35"], ["10 2\n7 1 2 3 4 5 6 1\n6 3 7 8 9 10 2", "0"], ["5 1\n4 1 2 3 4", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "高精度", "2005", "2006", "各省省选", "上海", "仙人掌", "ICPC", "NERC/NEERC"], "title": "[NEERC 2005 / SHOI2006] 仙人掌", "background": "本题不同于 bzoj1023，bzoj1023 洛谷快捷通道：[[SHOI2008] 仙人掌图 II](/problem/P4244)。", "description": "仙人掌图（cactus）是一种无向连通图，它的每条边最多只能出现在一个简单回路（simple cycle）里面。从直观上说，可以把仙人掌图理解为允许存在回路的树。但是仙人掌图和树之间有个本质的不同，仙人掌图可以拥有多个支撑子图（spanning subgraph），而树的支撑子图只有一个（它自身），我们把仙人掌图的支撑子图的数目称为“仙人数”。你的任务就是计算给定图的“仙人数”。\n\n一些关于仙人掌图的举例：\n ![](https://cdn.luogu.com.cn/upload/pic/13241.png) \n\n第一张图是一个仙人掌图，第二张图的边 $(2,3)$ 在两个不同的回路里面，所以不是仙人掌图，第三张图不是一个连通图，所以也不是仙人掌图。\n\n以下是对一些术语的解释：\n\n- 简单回路（simple cycle）：简单回路是原图的一条路径，这条路径的边集构成了回路，回路中顶点只能出现一次。比如对于上例中第二个图来说，它一共有三个简单回路，分别是 $(4,3,2,1,6,5)$、$(7,8,9,10,2,3)$ 和 $(4,3,7,8,9,10,2,1,6,5)$；\n- 支撑子图（spanning subgraph）：支撑子图也是原图的子图，这种子图可以比原来少一些边，但是不能破坏图的连通性，也不能去除原来图上的任何顶点。“支撑”的概念类似于我们熟知的“最小支撑树”，对于上例中的第一张图来说，任意去除回路I中的图或回路II中的一条边都能构成一个支撑子图，所以它的支撑子图一共有 $6 + 4 + 6 × 4 + 1 = 35$ 种（注意图自身也是自己的一个子图）。", "inputFormat": "输入文件的第一行是两个整数 $n$ 和 $m$。$n$ 代表图的顶点数，顶点的编号总是从 $1$ 到 $n$ 表示的。\n\n接下来一共有 $m$ 行。每行都代表了图上的一条路径（注意：这里所表示的一条路径可不一定是一条回路）。这些行的格式是首先有一个整数 $k_i$ 代表这条路径通过了几个顶点，接下来是 $k_i$ 个在 $1$ 到 $n$ 之间的数字，其中每个数字代表了图上的一个顶点，相邻的顶点之间就定义了一条边。一条路径上可能通过一个顶点好几次，比如对于第一个例子，第一条路径从 $2$ 经过 $3$，又从 $8$ 返回到了 $3$，但是我们保证所有的边都会出现在某条路径上，而且不会重复出现在两条路径上，或者在一条路径上出现两次。", "outputFormat": "输出这张图的“仙人数”，如果它不是一张仙人掌图，输出 `0`。注意最后的答案可能是一个很大很大的数。", "hint": "对于所有数据，满足 $1\\le n\\le 20000$，$0\\le m\\le 1000$，$2\\le k_i\\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[NEERC 2005 / SHOI2006] Cactus", "background": "This problem is different from bzoj1023. Luogu quick access to bzoj1023: [[SHOI2008] Cactus II](/problem/P4244).", "description": "A cactus is an undirected connected graph in which each edge appears in at most one simple cycle. Intuitively, a cactus can be viewed as a tree that is allowed to have cycles. There is, however, a fundamental difference between cacti and trees: a cactus can have multiple connected spanning subgraphs, whereas a tree has only one (itself). We call the number of connected spanning subgraphs the “Xian” number (xiān). Your task is to compute the “Xian” number of the given graph.\n\nSome examples of cacti:\n ![](https://cdn.luogu.com.cn/upload/pic/13241.png) \n\nThe first figure is a cactus. In the second figure, the edge $(2,3)$ lies on two different cycles, so it is not a cactus. The third figure is not connected, so it is not a cactus either.\n\nExplanations of some terms:\n\n- Simple cycle: A simple cycle is a path in the original graph whose edge set forms a cycle, and each vertex appears at most once in the cycle. For example, for the second figure above, it has three simple cycles: $(4,3,2,1,6,5)$, $(7,8,9,10,2,3)$, and $(4,3,7,8,9,10,2,1,6,5)$.\n- Spanning subgraph: A spanning subgraph is also a subgraph of the original graph; it may have fewer edges, but it must preserve connectivity and must not remove any vertices of the original graph. The notion of “spanning” is similar to that in the familiar “minimum spanning tree.” For the first figure above, removing any one edge in cycle I or any one edge in cycle II yields a spanning subgraph, so the total number of spanning subgraphs is $6 + 4 + 6 \\times 4 + 1 = 35$ (note that a graph is also a subgraph of itself).", "inputFormat": "The first line contains two integers $n$ and $m$. The $n$ vertices are numbered from $1$ to $n$.\n\nEach of the next $m$ lines describes a path in the graph (note: such a path is not necessarily a cycle). The format of a line is: an integer $k_i$ indicating how many vertices this path goes through, followed by $k_i$ integers between $1$ and $n$, each denoting a vertex of the graph; consecutive vertices define an edge. A path may pass through the same vertex multiple times. For example, in the first figure, the first path goes from $2$ through $3$, and then returns to $3$ from $8$. We guarantee that every edge appears in exactly one path: no edge appears in two different paths, and no edge appears twice within a single path.", "outputFormat": "Output the graph’s “Xian” number. If it is not a cactus, output `0`. Note that the final answer can be very large.", "hint": "For all testdata, $1 \\le n \\le 20000$, $0 \\le m \\le 1000$, and $2 \\le k_i \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NEERC 2005 / SHOI2006] 仙人掌", "background": "本题不同于 bzoj1023，bzoj1023 洛谷快捷通道：[[SHOI2008] 仙人掌图 II](/problem/P4244)。", "description": "仙人掌图（cactus）是一种无向连通图，它的每条边最多只能出现在一个简单回路（simple cycle）里面。从直观上说，可以把仙人掌图理解为允许存在回路的树。但是仙人掌图和树之间有个本质的不同，仙人掌图可以拥有多个支撑子图（spanning subgraph），而树的支撑子图只有一个（它自身），我们把仙人掌图的支撑子图的数目称为“仙人数”。你的任务就是计算给定图的“仙人数”。\n\n一些关于仙人掌图的举例：\n ![](https://cdn.luogu.com.cn/upload/pic/13241.png) \n\n第一张图是一个仙人掌图，第二张图的边 $(2,3)$ 在两个不同的回路里面，所以不是仙人掌图，第三张图不是一个连通图，所以也不是仙人掌图。\n\n以下是对一些术语的解释：\n\n- 简单回路（simple cycle）：简单回路是原图的一条路径，这条路径的边集构成了回路，回路中顶点只能出现一次。比如对于上例中第二个图来说，它一共有三个简单回路，分别是 $(4,3,2,1,6,5)$、$(7,8,9,10,2,3)$ 和 $(4,3,7,8,9,10,2,1,6,5)$；\n- 支撑子图（spanning subgraph）：支撑子图也是原图的子图，这种子图可以比原来少一些边，但是不能破坏图的连通性，也不能去除原来图上的任何顶点。“支撑”的概念类似于我们熟知的“最小支撑树”，对于上例中的第一张图来说，任意去除回路I中的图或回路II中的一条边都能构成一个支撑子图，所以它的支撑子图一共有 $6 + 4 + 6 × 4 + 1 = 35$ 种（注意图自身也是自己的一个子图）。", "inputFormat": "输入文件的第一行是两个整数 $n$ 和 $m$。$n$ 代表图的顶点数，顶点的编号总是从 $1$ 到 $n$ 表示的。\n\n接下来一共有 $m$ 行。每行都代表了图上的一条路径（注意：这里所表示的一条路径可不一定是一条回路）。这些行的格式是首先有一个整数 $k_i$ 代表这条路径通过了几个顶点，接下来是 $k_i$ 个在 $1$ 到 $n$ 之间的数字，其中每个数字代表了图上的一个顶点，相邻的顶点之间就定义了一条边。一条路径上可能通过一个顶点好几次，比如对于第一个例子，第一条路径从 $2$ 经过 $3$，又从 $8$ 返回到了 $3$，但是我们保证所有的边都会出现在某条路径上，而且不会重复出现在两条路径上，或者在一条路径上出现两次。", "outputFormat": "输出这张图的“仙人数”，如果它不是一张仙人掌图，输出 `0`。注意最后的答案可能是一个很大很大的数。", "hint": "对于所有数据，满足 $1\\le n\\le 20000$，$0\\le m\\le 1000$，$2\\le k_i\\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P4130", "type": "P", "difficulty": 6, "samples": [["5 3\n1 2 3 2 1\n4\nC\nR 2\nP 5 5 2\nCS 4 1", "4\n1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "线段树", "NOI"], "title": "[NOI2007] 项链工厂", "background": "T 公司是一家专门生产彩色珠子项链的公司，其生产的项链设计新颖、款式多样、价格适中，广受青年人的喜爱。\n\n最近 T 公司打算推出一款项链自助生产系统，使用该系统顾客可以自行设计心目中的美丽项链。该项链自助生产系统包括硬件系统与软件系统，软件系统与用户进行交互并控制硬件系统，硬件系统接受软件系统的命令生产指定的项链。该系统的硬件系统已经完成，而软件系统尚未开发，T 公司的人找到了正在参加全国信息学竞赛的你，你能帮助 T 公司编写一个软件模拟系统吗？", "description": "一条项链包含 $N$ 个珠子，每个珠子的颜色是 $1,2,…,c$ 中的一种。项链被固定在一个平板上，平板的某个位置被标记位置 $1$ ，按顺时针方向其他位置被记为 $2,3,…,N$。\n\n ![](https://cdn.luogu.com.cn/upload/pic/13560.png) \n\n你将要编写的软件系统应支持如下命令：\n\n ![](https://cdn.luogu.com.cn/upload/pic/13561.png) \n\n![](https://cdn.luogu.com.cn/upload/pic/13562.png)", "inputFormat": "输入文件第一行包含两个整数 $N,c$，分别表示项链包含的珠子数目以及颜色数目。\n\n第二行包含 $N$ 个整数，$x_1,x_2,\\cdots,x_n$，表示从位置 $1$ 到位置 $N$ 的珠子的颜色，$1 \\le x_i \\le c$。\n\n第三行包含一个整数 $Q$，表示命令数目。\n\n接下来的 $Q$ 行每行一条命令，如上文所述。", "outputFormat": "对于每一个 `C` 和 `CS` 命令，应输出一个整数代表相应的答案。", "hint": "【数据规模和约定】\n\n对于 60% 的数据，$N \\le 1000$，$Q \\le 1000$；\n\n对于 100% 的数据，$N \\le 500000$，$Q \\le 500000$，$c \\le 1000$。\n\n关于旋转和翻转\n\n\n注意旋转命令旋转“珠子”但不改变“位置”的编号，而反转命令始终以位置 1 为对称轴。例如当 $N=10$ 时，项链上的位置编号如图 1：\n\n\n但注意此时项链上的位置编号仍然如图 1 所示，于是翻转的对称轴不变。因而再执行一次“F”命令时，项链的颜色如图 4 所示。\n\n ![](https://cdn.luogu.com.cn/upload/pic/13244.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/13245.png) \n\n关于 CountSegment 命令\n\n\nCS 命令表示查询一个“线段”中有多少个“部分”。尤其注意当查询的长度等于 $N$ 时，我们仍然将查询部分作为“线段”理解。\n\n\n例如在图 4 所示的情况中，执行“CS 1 10”命令，查询从位置 1 开始到位置 10 结束的这个长度为 10 的线段中有多少个“部分”，于是得到返回值 3。与之形成对照的是，若执行“C”命令，返回值则为 2。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2007] Necklace Factory", "background": "Company T specializes in producing necklaces made of colored beads. Its necklaces have fresh designs, diverse styles, and reasonable prices, and are popular among young people.\n\nRecently, Company T plans to launch a self-service necklace production system. With this system, customers can design their own beautiful necklaces. The system consists of a hardware component and a software component. The software interacts with users and controls the hardware, and the hardware executes the software’s commands to produce the specified necklace. The hardware has already been completed, but the software has not yet been developed. The team at Company T has found you, a participant in a national informatics competition. Can you help Company T write software to simulate this system?", "description": "A necklace contains $N$ beads. Each bead’s color is one of $1, 2, \\ldots, c$. The necklace is fixed on a flat board. Some point on the board is marked as position $1$, and in the clockwise direction the other positions are labelled $2, 3, \\ldots, N$.\n\n ![](https://cdn.luogu.com.cn/upload/pic/13560.png) \n\nThe software system you will write should support the following commands:\n\n ![](https://cdn.luogu.com.cn/upload/pic/13561.png) \n\n![](https://cdn.luogu.com.cn/upload/pic/13562.png)", "inputFormat": "The first line contains two integers $N, c$, representing the number of beads in the necklace and the number of colors, respectively.\n\nThe second line contains $N$ integers, $x_1, x_2, \\cdots, x_N$, representing the colors of the beads from position $1$ to position $N$, where $1 \\le x_i \\le c$.\n\nThe third line contains an integer $Q$, representing the number of commands.\n\nEach of the next $Q$ lines contains one command, as described above.", "outputFormat": "For each `C` and `CS` command, output one integer representing the corresponding answer.", "hint": "[Constraints and Conventions]\n\nFor 60% of the testdata, $N \\le 1000$, $Q \\le 1000$.\n\nFor 100% of the testdata, $N \\le 500000$, $Q \\le 500000$, $c \\le 1000$.\n\nAbout rotation and flip\n\nNote that the rotation command rotates the beads but does not change the labels of the positions, and the flip command is always symmetric about position $1$. For example, when $N = 10$, the position labels on the necklace are as shown in Figure 1:\n\nHowever, note that the position labels on the necklace still remain as shown in Figure 1, so the axis of symmetry for flipping does not change. Therefore, after executing another “F” command, the colors on the necklace are as shown in Figure 4.\n\n ![](https://cdn.luogu.com.cn/upload/pic/13244.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/13245.png) \n\nAbout the CountSegment command\n\nThe `CS` command queries how many “segments” there are in a linear “segment” of the necklace. In particular, when the query length equals $N$, we still treat the query range as a linear “segment”.\n\nFor example, in the situation shown in Figure 4, executing the command `CS 1 10` queries how many “segments” there are in the linear segment starting at position $1$ and ending at position $10$, which has length $10$, and the return value is $3$. In contrast, if you execute the `C` command, the return value would be $2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2007] 项链工厂", "background": "T 公司是一家专门生产彩色珠子项链的公司，其生产的项链设计新颖、款式多样、价格适中，广受青年人的喜爱。\n\n最近 T 公司打算推出一款项链自助生产系统，使用该系统顾客可以自行设计心目中的美丽项链。该项链自助生产系统包括硬件系统与软件系统，软件系统与用户进行交互并控制硬件系统，硬件系统接受软件系统的命令生产指定的项链。该系统的硬件系统已经完成，而软件系统尚未开发，T 公司的人找到了正在参加全国信息学竞赛的你，你能帮助 T 公司编写一个软件模拟系统吗？", "description": "一条项链包含 $N$ 个珠子，每个珠子的颜色是 $1,2,…,c$ 中的一种。项链被固定在一个平板上，平板的某个位置被标记位置 $1$ ，按顺时针方向其他位置被记为 $2,3,…,N$。\n\n ![](https://cdn.luogu.com.cn/upload/pic/13560.png) \n\n你将要编写的软件系统应支持如下命令：\n\n ![](https://cdn.luogu.com.cn/upload/pic/13561.png) \n\n![](https://cdn.luogu.com.cn/upload/pic/13562.png)", "inputFormat": "输入文件第一行包含两个整数 $N,c$，分别表示项链包含的珠子数目以及颜色数目。\n\n第二行包含 $N$ 个整数，$x_1,x_2,\\cdots,x_n$，表示从位置 $1$ 到位置 $N$ 的珠子的颜色，$1 \\le x_i \\le c$。\n\n第三行包含一个整数 $Q$，表示命令数目。\n\n接下来的 $Q$ 行每行一条命令，如上文所述。", "outputFormat": "对于每一个 `C` 和 `CS` 命令，应输出一个整数代表相应的答案。", "hint": "【数据规模和约定】\n\n对于 60% 的数据，$N \\le 1000$，$Q \\le 1000$；\n\n对于 100% 的数据，$N \\le 500000$，$Q \\le 500000$，$c \\le 1000$。\n\n关于旋转和翻转\n\n\n注意旋转命令旋转“珠子”但不改变“位置”的编号，而反转命令始终以位置 1 为对称轴。例如当 $N=10$ 时，项链上的位置编号如图 1：\n\n\n但注意此时项链上的位置编号仍然如图 1 所示，于是翻转的对称轴不变。因而再执行一次“F”命令时，项链的颜色如图 4 所示。\n\n ![](https://cdn.luogu.com.cn/upload/pic/13244.png) \n\n ![](https://cdn.luogu.com.cn/upload/pic/13245.png) \n\n关于 CountSegment 命令\n\n\nCS 命令表示查询一个“线段”中有多少个“部分”。尤其注意当查询的长度等于 $N$ 时，我们仍然将查询部分作为“线段”理解。\n\n\n例如在图 4 所示的情况中，执行“CS 1 10”命令，查询从位置 1 开始到位置 10 结束的这个长度为 10 的线段中有多少个“部分”，于是得到返回值 3。与之形成对照的是，若执行“C”命令，返回值则为 2。", "locale": "zh-CN"}}}
{"pid": "P4131", "type": "P", "difficulty": 6, "samples": [["5 3\n1 2 3\n-5 3 2\n-2 3 0\n0 5 9\n3 4 -1\n-10 -11 7", "3 5\n36"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "Special Judge", "枚举", "WC", "状压 DP"], "title": "[WC2005] 友好的生物", "background": "", "description": "$W$ 星球是一个和地球一样气候适宜、物种聚集的星球。经过多年的研究，外星生物学家们已经发现了数万种生物，而且这个数字还在不断增大。\n\n$W$ 星球上的生物很有趣，有些生物之间很友好，朝夕相伴，形影不离；但有些却很敌对，一见面就难免发生战斗。为了能够更好地了解它们之间的友好程度，外星生物学家希望进行一些量化的计算。他们发现，两种生物之间的友好程度和它们的 $K$ 种属性有关，暂且将它们编号为属性 $1$、属性 $2$、……、属性 $K$，这些属性都是可以进行量化的。外星生物学家研究发现，如果前 $K-1$ 种属性的差别越大，这两种生物就越友好；但是属性 $K$ 与众不同，这种属性差别越小的两种生物越友好。\n\n因此他们猜想是不是可以用这样一个公式量化两种生物之间的友好程度：$Friendliness=(\\sum_{i=1}^{k-1} C_id_i)-C_Kd_K$\n\n其中 $C_i$ 是非负常数，$d_i$ 是属性 $i$ 的差别。如果知道了每种生物的各种属性，利用上述公式就很容易算出它们之间的友好程度了。现在，外星生物学家们想问一问：在目前发现的这些生物当中，关系最友好的那对生物是哪一对呢？它们之间的友好程度是多少？\n", "inputFormat": "输入文件的第一行是两个整数 $N$ 和 $K$，分别表示目前发现的生物种数和属性的种数。\n\n第二行有 $K$ 个非负整数 $C_i$，即计算友好程度时所需的常数。\n\n接下来的 $N$ 行，描述每种生物，按照先后顺序依次编号为生物 $1$、生物 $2$、……、生物 $N$。每一行都有 $K$ 个整数，给出该种生物的各项属性值，按照先后顺序依次编号为属性 $1$、属性 $2$、……、属性 $K$。\n", "outputFormat": "输出文件包含两行。第一行为两个整数 $i$ 和 $j$（$i \\neq j$），表示你所找到的关系最友好的两种生物为生物 $i$ 和生物 $j$。若最友好的不止一对，输出任意一对。\n\n第二行为一个整数，表示生物 $i$ 和生物 $j$ 之间的友好程度。\n", "hint": "【样例说明】\n\n生物 $3$ 和 $5$ 之间的友好程度为 $1\\times |0-(-10)|+2\\times |5-(-11)|-3\\times |9-7|=36$。\n\n【约定】\n\n- $2 \\leq N \\leq 100,000$\n\n- $2 \\leq K \\leq 5$\n\n- $0 \\leq C_i \\leq 100$。\n\n- 每种生物的各项属性值不小于$-10000$ 且不大于 $10000$。\n\n- 最大的友好程度一定大于 $0$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[WC2005] Friendly Creatures", "background": "", "description": "Planet $W$ is a world with an Earth-like climate and a diverse collection of species. After years of research, xenobiologists have discovered tens of thousands of species, and the number keeps growing.\n\nSpecies on planet $W$ are interesting: some pairs are very friendly, always together and inseparable; others are hostile and fight upon meeting. To better understand their degrees of friendliness, the xenobiologists want to run some quantitative calculations. They have found that the friendliness between two species depends on their $K$ attributes, temporarily numbered as attribute $1$, attribute $2$, …, attribute $K$, all of which are quantifiable. Their research suggests that the larger the differences in the first $K-1$ attributes, the friendlier the pair; but attribute $K$ is special: the smaller the difference in this attribute, the friendlier the pair.\n\nTherefore, they conjecture that the following formula can quantify the friendliness between two species: $Friendliness=(\\sum_{i=1}^{k-1} C_id_i)-C_Kd_K$,\n\nwhere $C_i$ are non-negative constants and $d_i$ is the difference in attribute $i$ (i.e., the absolute difference). If the attributes of each species are known, the above formula makes it easy to compute the friendliness between any pair. Now the xenobiologists ask: among the species discovered so far, which pair is the friendliest, and what is their friendliness?", "inputFormat": "The first line contains two integers $N$ and $K$, the number of discovered species and the number of attributes, respectively.\n\nThe second line contains $K$ non-negative integers $C_i$, the constants used to compute the friendliness.\n\nThe next $N$ lines describe each species, numbered in order as species $1$, species $2$, …, species $N$. Each line contains $K$ integers, giving the values of attributes $1$, $2$, …, $K$ for that species.", "outputFormat": "Output two lines. The first line contains two integers $i$ and $j$ ($i \\neq j$), indicating that the friendliest pair you found is species $i$ and species $j$. If there is more than one friendliest pair, output any one of them.\n\nThe second line contains an integer, the friendliness between species $i$ and species $j$.", "hint": "[Sample Explanation]\n\nThe friendliness between species $3$ and $5$ is $1\\times |0-(-10)|+2\\times |5-(-11)|-3\\times |9-7|=36$.\n\n[Constraints]\n- $2 \\leq N \\leq 100{,}000$.\n- $2 \\leq K \\leq 5$.\n- $0 \\leq C_i \\leq 100$.\n- Each attribute value is at least $-10000$ and at most $10000$.\n- The maximum friendliness is guaranteed to be greater than $0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2005] 友好的生物", "background": "", "description": "$W$ 星球是一个和地球一样气候适宜、物种聚集的星球。经过多年的研究，外星生物学家们已经发现了数万种生物，而且这个数字还在不断增大。\n\n$W$ 星球上的生物很有趣，有些生物之间很友好，朝夕相伴，形影不离；但有些却很敌对，一见面就难免发生战斗。为了能够更好地了解它们之间的友好程度，外星生物学家希望进行一些量化的计算。他们发现，两种生物之间的友好程度和它们的 $K$ 种属性有关，暂且将它们编号为属性 $1$、属性 $2$、……、属性 $K$，这些属性都是可以进行量化的。外星生物学家研究发现，如果前 $K-1$ 种属性的差别越大，这两种生物就越友好；但是属性 $K$ 与众不同，这种属性差别越小的两种生物越友好。\n\n因此他们猜想是不是可以用这样一个公式量化两种生物之间的友好程度：$Friendliness=(\\sum_{i=1}^{k-1} C_id_i)-C_Kd_K$\n\n其中 $C_i$ 是非负常数，$d_i$ 是属性 $i$ 的差别。如果知道了每种生物的各种属性，利用上述公式就很容易算出它们之间的友好程度了。现在，外星生物学家们想问一问：在目前发现的这些生物当中，关系最友好的那对生物是哪一对呢？它们之间的友好程度是多少？\n", "inputFormat": "输入文件的第一行是两个整数 $N$ 和 $K$，分别表示目前发现的生物种数和属性的种数。\n\n第二行有 $K$ 个非负整数 $C_i$，即计算友好程度时所需的常数。\n\n接下来的 $N$ 行，描述每种生物，按照先后顺序依次编号为生物 $1$、生物 $2$、……、生物 $N$。每一行都有 $K$ 个整数，给出该种生物的各项属性值，按照先后顺序依次编号为属性 $1$、属性 $2$、……、属性 $K$。\n", "outputFormat": "输出文件包含两行。第一行为两个整数 $i$ 和 $j$（$i \\neq j$），表示你所找到的关系最友好的两种生物为生物 $i$ 和生物 $j$。若最友好的不止一对，输出任意一对。\n\n第二行为一个整数，表示生物 $i$ 和生物 $j$ 之间的友好程度。\n", "hint": "【样例说明】\n\n生物 $3$ 和 $5$ 之间的友好程度为 $1\\times |0-(-10)|+2\\times |5-(-11)|-3\\times |9-7|=36$。\n\n【约定】\n\n- $2 \\leq N \\leq 100,000$\n\n- $2 \\leq K \\leq 5$\n\n- $0 \\leq C_i \\leq 100$。\n\n- 每种生物的各项属性值不小于$-10000$ 且不大于 $10000$。\n\n- 最大的友好程度一定大于 $0$。\n", "locale": "zh-CN"}}}
{"pid": "P4132", "type": "P", "difficulty": 5, "samples": [["5 7", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "各省省选", "北京", "O2优化"], "title": "[BJOI2012] 算不出的等式", "background": "曾经有一个老掉牙的游戏放在我面前，我没有珍惜。直到这个游戏停产才追悔莫及。人世间最痛苦的事情莫过于此，如果上天给我一个再玩一次的机会，我一定要，通关！", "description": "如果你真的很想玩这个游戏，那么就先看看我的题目吧，搞不定这些的话是没办法通关的哟。第一关其实很简单，只有一个关闭的有密码锁的大门。这大门上写着一个奇怪的算式，估计是要你利用它算出密码来开门吧（果然是老掉牙的情节）。\n\n传说中这个式子中的 $p$ 和 $q$ 是两个奇质数，等号右边算出来应该就是密码了吧，你是真的算不出来么？\n\n\n$$\n\\sum_{k=1}^{\\frac{p-1}{2}} \\biggl\\lfloor\\frac{kq}{p}\\biggr\\rfloor+\\sum_{k=1}^{\\frac{q-1}{2}} \\biggl\\lfloor\\frac{kp}{q}\\biggr\\rfloor\n$$", "inputFormat": "只有一行，两个奇质数，分别表示 $p,q$。", "outputFormat": "一个数，表示算式结果。", "hint": "$p,q<2^{32}$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2012] The Uncomputable Equation", "background": "Once there was a cheesy old game right in front of me, and I didn’t cherish it. Only when the game was discontinued did I deeply regret it. There is nothing more painful in this world than that. If heaven gave me one more chance to play it, I would definitely beat it!", "description": "If you really want to play this game, then take a look at my problem first. If you can’t handle these, you won’t be able to clear the game. The first level is actually simple: there is only a locked door with a password. There is a strange formula written on the door; I guess you are supposed to use it to compute the password to open the door (what a cliché).\n\nLegend says that in this expression, $p$ and $q$ are two odd primes. The computed value should be the password. Can you really not work it out?\n\n$$\n\\sum_{k=1}^{\\frac{p-1}{2}} \\biggl\\lfloor\\frac{kq}{p}\\biggr\\rfloor+\\sum_{k=1}^{\\frac{q-1}{2}} \\biggl\\lfloor\\frac{kp}{q}\\biggr\\rfloor\n$$", "inputFormat": "A single line containing two odd primes, denoting $p, q$.", "outputFormat": "A single number, the value of the expression.", "hint": "$p, q < 2^{32}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2012] 算不出的等式", "background": "曾经有一个老掉牙的游戏放在我面前，我没有珍惜。直到这个游戏停产才追悔莫及。人世间最痛苦的事情莫过于此，如果上天给我一个再玩一次的机会，我一定要，通关！", "description": "如果你真的很想玩这个游戏，那么就先看看我的题目吧，搞不定这些的话是没办法通关的哟。第一关其实很简单，只有一个关闭的有密码锁的大门。这大门上写着一个奇怪的算式，估计是要你利用它算出密码来开门吧（果然是老掉牙的情节）。\n\n传说中这个式子中的 $p$ 和 $q$ 是两个奇质数，等号右边算出来应该就是密码了吧，你是真的算不出来么？\n\n\n$$\n\\sum_{k=1}^{\\frac{p-1}{2}} \\biggl\\lfloor\\frac{kq}{p}\\biggr\\rfloor+\\sum_{k=1}^{\\frac{q-1}{2}} \\biggl\\lfloor\\frac{kp}{q}\\biggr\\rfloor\n$$", "inputFormat": "只有一行，两个奇质数，分别表示 $p,q$。", "outputFormat": "一个数，表示算式结果。", "hint": "$p,q<2^{32}$。", "locale": "zh-CN"}}}
{"pid": "P4133", "type": "P", "difficulty": 5, "samples": [["16", "4"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "递推", "2012", "各省省选", "北京", "O2优化", "枚举", "Fibonacci 数列"], "title": "[BJOI2012] 最多的方案", "background": "", "description": "第二关和很出名的斐波那契数列有关，地球上的 OIer 都知道：  \n$$F_n = \\begin{cases} 1 & (n \\le 2) \\\\ F_{n-1}+F_{n-2} & (n \\ge 3) \\end{cases}$$ \n每一项都可以称为斐波那契数。  \n\n现在给一个正整数 $n$，它可以写成一些斐波那契数的和的形式。如果我们要求不同的方案中不能有相同的斐波那契数，那么对一个 $n$ 最多可以写出多少种方案呢？\n", "inputFormat": "只有一个整数 $n$。\n", "outputFormat": "一个整数表示方案数。", "hint": "Hint：16=3+13=3+5+8=1+2+13=1+2+5+8\n\n【数据范围】   \n对于 $30\\%$ 的数据，$n \\le 256$；  \n对于 $100\\%$ 的数据，$n \\le 10^{18}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "{{[BJOI2012] Maximum Number of Ways}}", "background": "{{}}", "description": "{{The second stage is related to the famous Fibonacci sequence. Every OIer on Earth knows:\n$$F_n = \\begin{cases} 1 & (n \\le 2) \\\\ F_{n-1}+F_{n-2} & (n \\ge 3) \\end{cases}$$\nEach term is called a Fibonacci number.\n\nNow given a positive integer $n$, it can be written as a sum of some Fibonacci numbers. If we require that in each representation the Fibonacci numbers are distinct (no repetition), then for a given $n$, how many different ways can it be written?}}", "inputFormat": "{{A single integer $n$.}}", "outputFormat": "{{Output a single integer representing the number of ways.}}", "hint": "{{Hint: 16 = 3 + 13 = 3 + 5 + 8 = 1 + 2 + 13 = 1 + 2 + 5 + 8.\n\nConstraints  \nFor 30% of the testdata, $n \\le 256$.  \nFor 100% of the testdata, $n \\le 10^{18}$.}}\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2012] 最多的方案", "background": "", "description": "第二关和很出名的斐波那契数列有关，地球上的 OIer 都知道：  \n$$F_n = \\begin{cases} 1 & (n \\le 2) \\\\ F_{n-1}+F_{n-2} & (n \\ge 3) \\end{cases}$$ \n每一项都可以称为斐波那契数。  \n\n现在给一个正整数 $n$，它可以写成一些斐波那契数的和的形式。如果我们要求不同的方案中不能有相同的斐波那契数，那么对一个 $n$ 最多可以写出多少种方案呢？\n", "inputFormat": "只有一个整数 $n$。\n", "outputFormat": "一个整数表示方案数。", "hint": "Hint：16=3+13=3+5+8=1+2+13=1+2+5+8\n\n【数据范围】   \n对于 $30\\%$ 的数据，$n \\le 256$；  \n对于 $100\\%$ 的数据，$n \\le 10^{18}$。\n", "locale": "zh-CN"}}}
{"pid": "P4134", "type": "P", "difficulty": 6, "samples": [["1 15", "2 34"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "北京", "二分图", "费用流"], "title": "[BJOI2012] 连连看", "background": "", "description": "凡是考智商的题里面总会有这么一种消除游戏。不过现在面对的这关连连看可不是 QQ 游戏里那种考眼力的游戏。我们的规则是，给出一个闭区间 $[a,b]$ 中的全部整数，如果其中某两个数 $x$，$y$（$x>y$）的平方差 $x^2-y^2$ 是一个完全平方数 $z^2$，并且 $y$ 与 $z$ 互质，那么就可以将 $x$ 和 $y$ 连起来并且将它们一起消除，同时得到 $x+y$ 点分数。那么过关的要求就是，消除的数对尽可能多的前提下，得到足够的分数。快动手动笔算一算吧。", "inputFormat": "只有一行，两个整数，分别表示 $a$，$b$。", "outputFormat": "两个数，可以消去的对数，及在此基础上能得到的最大分数。\n", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $1\\le a,b\\le100$。\n- 对于 $100\\%$ 的数据，保证 $1\\le a,b\\le1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2012] Lianliankan", "background": "", "description": "Among IQ-test problems there is often an elimination game. But this round of Lianliankan is not the visual-matching game on QQ. Our rule is: given all integers in the closed interval $[a, b]$, if there exist two numbers $x$, $y$ ($x > y$) such that their square difference $x^2 - y^2$ is a perfect square $z^2$, and $y$ and $z$ are coprime, then you may connect $x$ and $y$, remove them together, and gain $x + y$ points. The goal is to maximize the number of removable pairs, and subject to that, maximize the total score. Try to figure it out.", "inputFormat": "One line with two integers, denoting $a$ and $b$.", "outputFormat": "Two integers: the number of pairs that can be removed, and, under that condition, the maximum total score.", "hint": "Constraints:\n- For $30\\%$ of the testdata, $1 \\le a, b \\le 100$.\n- For $100\\%$ of the testdata, $1 \\le a, b \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2012] 连连看", "background": "", "description": "凡是考智商的题里面总会有这么一种消除游戏。不过现在面对的这关连连看可不是 QQ 游戏里那种考眼力的游戏。我们的规则是，给出一个闭区间 $[a,b]$ 中的全部整数，如果其中某两个数 $x$，$y$（$x>y$）的平方差 $x^2-y^2$ 是一个完全平方数 $z^2$，并且 $y$ 与 $z$ 互质，那么就可以将 $x$ 和 $y$ 连起来并且将它们一起消除，同时得到 $x+y$ 点分数。那么过关的要求就是，消除的数对尽可能多的前提下，得到足够的分数。快动手动笔算一算吧。", "inputFormat": "只有一行，两个整数，分别表示 $a$，$b$。", "outputFormat": "两个数，可以消去的对数，及在此基础上能得到的最大分数。\n", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $1\\le a,b\\le100$。\n- 对于 $100\\%$ 的数据，保证 $1\\le a,b\\le1000$。", "locale": "zh-CN"}}}
{"pid": "P4135", "type": "P", "difficulty": 6, "samples": [["5 3 5\n1 2 2 3 1\n0 4\n1 2\n2 2\n2 3\n3 5", "2\n0\n0\n0\n1"]], "limits": {"time": [1500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "枚举", "分块"], "title": "作诗", "background": "神犇 SJY 虐完 HEOI 之后给傻× LYD 出了一题：\n\nSHY 是 T 国的公主，平时的一大爱好是作诗。", "description": "由于时间紧迫，SHY 作完诗之后还要虐 OI，于是 SHY 找来一篇长度为 $n$ 的文章，阅读 $m$ 次，每次只阅读其中连续的一段 $[l,r]$，从这一段中选出一些汉字构成诗。因为 SHY 喜欢对偶，所以 SHY 规定最后选出的每个汉字都必须在 $[l,r]$ 里出现了正偶数次。而且 SHY 认为选出的汉字的种类数（两个一样的汉字称为同一种）越多越好（为了拿到更多的素材！）。于是 SHY 请 LYD 安排选法。\n\nLYD 这种傻×当然不会了，于是向你请教……\n\n问题简述：给定 $n$ 个不大于 $c$ 的正整数 $a_1 \\dots a_n$ 和 $m$ 组询问，每次问 $[l,r]$ 中有多少个数出现正偶数次。", "inputFormat": "**本题强制在线**。\n\n第一行有三个整数 $n$、$c$ 以及 $m$ 。表示文章字数、汉字的种类数、要选择 $m$ 次。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个汉字的编码 $a_i$。\n\n接下来 $m$ 行每行两个整数 $L$ 和 $R$，设上一个询问的答案为 $ans$（第一个询问时 $ans=0$），令 $l=((L+ans)\\bmod n)+1$，$r=((R+ans)\\bmod n)+1$，若 $l>r$，交换 $l$ 和 $r$，则本次询问为 $[l,r]$。", "outputFormat": "输出共 $m$ 行，每行一个整数，第 $i$ 个数表示 SHY 第 $i$ 次能选出的汉字的最多种类数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n,c,m\\le 10^5$，$1 \\leq a_i \\leq c$，$1 \\leq l,r \\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "Composing Poetry", "background": "The \"shenben\" SJY, after crushing HEOI, gave a problem to the \"sha×\" LYD.\n\nSHY is the princess of country T, and one of her hobbies is composing poetry.", "description": "Due to time pressure, after finishing a poem SHY still needs to crush OI, so she takes an article of length $n$, reads it $m$ times, and each time reads only a contiguous segment $[l, r]$. From this segment, she selects some Chinese characters to form a poem. Because SHY likes parallelism, she requires that every selected character must appear a positive even number of times within $[l, r]$. Also, SHY wants the number of distinct selected characters (two identical characters are considered the same type) to be as large as possible. So SHY asks LYD to arrange the selection.\n\nLYD, being a \"sha×\", certainly cannot do it, so he asks you for help.\n\nProblem summary: Given $n$ positive integers $a_1 \\dots a_n$ not greater than $c$ and $m$ queries, each query asks how many numbers in $[l, r]$ appear a positive even number of times.", "inputFormat": "This problem is strictly online.\n\nThe first line contains three integers $n$, $c$, and $m$, representing the article length, the number of character types, and the number of selections.\n\nThe second line contains $n$ integers. The $i$-th integer is the code $a_i$ of the $i$-th character.\n\nEach of the next $m$ lines contains two integers $L$ and $R$. Let the previous query’s answer be $ans$ (for the first query, $ans = 0$). Define $l=((L+ans)\\bmod n)+1$, $r=((R+ans)\\bmod n)+1$, and if $l>r$, swap $l$ and $r$. Then the current query is $[l, r]$.", "outputFormat": "Output $m$ lines. The $i$-th integer is the maximum number of distinct characters SHY can select for the $i$-th query.", "hint": "Constraints\n\nFor $100\\%$ of the testdata, $1 \\le n, c, m \\le 10^5$, $1 \\leq a_i \\leq c$, $1 \\leq l, r \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "作诗", "background": "神犇 SJY 虐完 HEOI 之后给傻× LYD 出了一题：\n\nSHY 是 T 国的公主，平时的一大爱好是作诗。", "description": "由于时间紧迫，SHY 作完诗之后还要虐 OI，于是 SHY 找来一篇长度为 $n$ 的文章，阅读 $m$ 次，每次只阅读其中连续的一段 $[l,r]$，从这一段中选出一些汉字构成诗。因为 SHY 喜欢对偶，所以 SHY 规定最后选出的每个汉字都必须在 $[l,r]$ 里出现了正偶数次。而且 SHY 认为选出的汉字的种类数（两个一样的汉字称为同一种）越多越好（为了拿到更多的素材！）。于是 SHY 请 LYD 安排选法。\n\nLYD 这种傻×当然不会了，于是向你请教……\n\n问题简述：给定 $n$ 个不大于 $c$ 的正整数 $a_1 \\dots a_n$ 和 $m$ 组询问，每次问 $[l,r]$ 中有多少个数出现正偶数次。", "inputFormat": "**本题强制在线**。\n\n第一行有三个整数 $n$、$c$ 以及 $m$ 。表示文章字数、汉字的种类数、要选择 $m$ 次。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个汉字的编码 $a_i$。\n\n接下来 $m$ 行每行两个整数 $L$ 和 $R$，设上一个询问的答案为 $ans$（第一个询问时 $ans=0$），令 $l=((L+ans)\\bmod n)+1$，$r=((R+ans)\\bmod n)+1$，若 $l>r$，交换 $l$ 和 $r$，则本次询问为 $[l,r]$。", "outputFormat": "输出共 $m$ 行，每行一个整数，第 $i$ 个数表示 SHY 第 $i$ 次能选出的汉字的最多种类数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n,c,m\\le 10^5$，$1 \\leq a_i \\leq c$，$1 \\leq l,r \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P4136", "type": "P", "difficulty": 4, "samples": [["2\n0", "Alice"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "博弈论", "位运算"], "title": "谁能赢呢？", "background": "", "description": "小明和小红经常玩一个博弈游戏。给定一个 $n\\times n$ 的棋盘，一个石头被放在棋盘的左上角。他们轮流移动石头。每一回合，选手只能把石头向上，下，左，右四个方向移动一格，并且要求移动到的格子之前不能被访问过。谁不能移动石头了就算输。\n\n假如小明先移动石头，而且两个选手都以最优策略走步，问最后谁能赢？\n", "inputFormat": "输入文件有多组数据。\n\n输入第一行包含一个整数 $n$，表示棋盘的规模。\n\n当输入 $n$ 为 $0$ 时，表示输入结束。", "outputFormat": "对于每组数据，如果小明最后能赢，则输出 `Alice`，否则输出 `Bob`，每一组答案独占一行。", "hint": "对于 $20\\%$ 的数据，保证 $1\\le n\\le 10$；\n\n对于 $40\\%$ 的数据，保证 $1\\le n\\le 1000$；\n\n对于 $100\\%$ 数据，保证 $1\\le n\\le 10000$。", "locale": "zh-CN", "translations": {"en": {"title": "Who Will Win?", "background": "", "description": "Xiao Ming and Xiao Hong often play a game. Given an $n \\times n$ board, a stone is placed at the upper-left corner. They take turns moving the stone. On each turn, a player may move the stone exactly one cell in one of the four directions: up, down, left, or right, and the destination cell must not have been visited before. The player who cannot move loses.\n\nIf Xiao Ming moves first and both players play optimally, who will win?", "inputFormat": "There are multiple test cases.\n\nEach test case consists of a single integer $n$, the size of the board, on its own line.\n\nInput ends when $n = 0$.", "outputFormat": "For each test case, if Xiao Ming eventually wins, output `Alice`; otherwise output `Bob`. Print one answer per line.", "hint": "- For $20\\%$ of the testdata, $1 \\le n \\le 10$.\n- For $40\\%$ of the testdata, $1 \\le n \\le 1000$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "谁能赢呢？", "background": "", "description": "小明和小红经常玩一个博弈游戏。给定一个 $n\\times n$ 的棋盘，一个石头被放在棋盘的左上角。他们轮流移动石头。每一回合，选手只能把石头向上，下，左，右四个方向移动一格，并且要求移动到的格子之前不能被访问过。谁不能移动石头了就算输。\n\n假如小明先移动石头，而且两个选手都以最优策略走步，问最后谁能赢？\n", "inputFormat": "输入文件有多组数据。\n\n输入第一行包含一个整数 $n$，表示棋盘的规模。\n\n当输入 $n$ 为 $0$ 时，表示输入结束。", "outputFormat": "对于每组数据，如果小明最后能赢，则输出 `Alice`，否则输出 `Bob`，每一组答案独占一行。", "hint": "对于 $20\\%$ 的数据，保证 $1\\le n\\le 10$；\n\n对于 $40\\%$ 的数据，保证 $1\\le n\\le 1000$；\n\n对于 $100\\%$ 数据，保证 $1\\le n\\le 10000$。", "locale": "zh-CN"}}}
{"pid": "P4137", "type": "P", "difficulty": 5, "samples": [["5 5\n2 1 0 2 1\n3 3\n2 3\n2 4\n1 2\n3 5", "1\n2\n3\n0\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["莫队", "线段树", "可持久化", "分块", "CTT（清华集训/北大集训）"], "title": "Rmq Problem / mex", "background": "", "description": "有一个长度为 $n$ 的数组 $\\{a_1,a_2,\\ldots,a_n\\}$。\n\n$m$ 次询问，每次询问一个区间内最小没有出现过的自然数。", "inputFormat": "第一行，两个正整数 $n,m$。  \n第二行，$n$ 个非负整数 $a_1, a_2, \\ldots , a_n$。  \n接下来 $m$ 行，每行两个正整数 $l,r$，表示一次询问。", "outputFormat": "输出 $m$ 行，每行一个数，依次表示每个询问的答案。", "hint": "对于 $30\\%$ 的数据：$1\\leq n,m\\leq 1000$。  \n对于 $100\\%$ 的数据：$1\\leq n,m\\leq 2\\times {10}^5$，$1\\leq l\\leq r\\leq n$，$0\\leq a_i\\leq 2\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Rmq Problem / mex", "background": "", "description": "There is an array $\\{a_1,a_2,\\ldots,a_n\\}$ of length $n$.\n\nThere are $m$ queries; for each query, find the smallest non-negative integer that does not appear in the interval (mex).", "inputFormat": "The first line contains two positive integers $n,m$.  \nThe second line contains $n$ non-negative integers $a_1, a_2, \\ldots , a_n$.  \nThen follow $m$ lines, each containing two positive integers $l,r$, representing a query.", "outputFormat": "Output $m$ lines, one number per line, giving the answer to each query in order.", "hint": "For $30\\%$ of the testdata: $1\\leq n,m\\leq 1000$.  \nFor $100\\%$ of the testdata: $1\\leq n,m\\leq 2\\times {10}^5$, $1\\leq l\\leq r\\leq n$, $0\\leq a_i\\leq 2\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Rmq Problem / mex", "background": "", "description": "有一个长度为 $n$ 的数组 $\\{a_1,a_2,\\ldots,a_n\\}$。\n\n$m$ 次询问，每次询问一个区间内最小没有出现过的自然数。", "inputFormat": "第一行，两个正整数 $n,m$。  \n第二行，$n$ 个非负整数 $a_1, a_2, \\ldots , a_n$。  \n接下来 $m$ 行，每行两个正整数 $l,r$，表示一次询问。", "outputFormat": "输出 $m$ 行，每行一个数，依次表示每个询问的答案。", "hint": "对于 $30\\%$ 的数据：$1\\leq n,m\\leq 1000$。  \n对于 $100\\%$ 的数据：$1\\leq n,m\\leq 2\\times {10}^5$，$1\\leq l\\leq r\\leq n$，$0\\leq a_i\\leq 2\\times 10^5$。", "locale": "zh-CN"}}}
