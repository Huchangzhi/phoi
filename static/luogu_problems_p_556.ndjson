{"pid": "P12284", "type": "P", "difficulty": 5, "samples": [["10 9", "1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "数位 DP", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Python A] 数字与留言", "background": "", "description": "在一个阳光明媚的上午，小蓝走进了数学教室。他的目光很快被黑板上两个孤零零的数字 $x, y$ 吸引。数学老师总爱出些奇妙的谜题，今天显然也不例外。老师留言称，这两个数字暗含着一层不同寻常的心意，要想揭开这份心意的神秘面纱，就必须在 $1 \\sim x$ 之间找到三个不同的正整数，使得这三个数的和除以 $2024$ 的余数值为 $y$，且这三个数的各个数位都不得包含数字 $2$ 和 $4$。\n\n现在，请你帮助小蓝，求出有多少种不同的满足条件的三个数的组合。由于这个答案可能很大，你只需要输出答案对 $10^9 + 7$ 取余后的结果即可。\n\n注意，如果通过改变三个正整数的顺序可以得到相同的组合，则这样的组合也被视为同一种。例如，对于 $x = 10, y = 9$，无论是 $1 + 3 + 5$ 还是 $5 + 3 + 1$，都只算作一种。", "inputFormat": "输入一行包含两个整数 $x, y$，用一个空格分隔。", "outputFormat": "输出一行包含一个整数，表示答案对 $10^9 + 7$ 取余后的结果。", "hint": "### 样例说明\n\n满足条件的组合仅有一组：$(1, 3, 5)$。\n\n### 评测用例规模与约定\n\n- 对于 $10\\%$ 的评测用例，$1 \\leq x \\leq 700$，$0 \\leq y \\leq 2023$。\n- 对于 $30\\%$ 的评测用例，$1 \\leq x \\leq 10^5$，$0 \\leq y \\leq 2023$。\n- 对于所有评测用例，$1 \\leq x \\leq 10^{12}$，$0 \\leq y \\leq 2023$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Python A] 数字与留言", "background": "", "description": "在一个阳光明媚的上午，小蓝走进了数学教室。他的目光很快被黑板上两个孤零零的数字 $x, y$ 吸引。数学老师总爱出些奇妙的谜题，今天显然也不例外。老师留言称，这两个数字暗含着一层不同寻常的心意，要想揭开这份心意的神秘面纱，就必须在 $1 \\sim x$ 之间找到三个不同的正整数，使得这三个数的和除以 $2024$ 的余数值为 $y$，且这三个数的各个数位都不得包含数字 $2$ 和 $4$。\n\n现在，请你帮助小蓝，求出有多少种不同的满足条件的三个数的组合。由于这个答案可能很大，你只需要输出答案对 $10^9 + 7$ 取余后的结果即可。\n\n注意，如果通过改变三个正整数的顺序可以得到相同的组合，则这样的组合也被视为同一种。例如，对于 $x = 10, y = 9$，无论是 $1 + 3 + 5$ 还是 $5 + 3 + 1$，都只算作一种。", "inputFormat": "输入一行包含两个整数 $x, y$，用一个空格分隔。", "outputFormat": "输出一行包含一个整数，表示答案对 $10^9 + 7$ 取余后的结果。", "hint": "### 样例说明\n\n满足条件的组合仅有一组：$(1, 3, 5)$。\n\n### 评测用例规模与约定\n\n- 对于 $10\\%$ 的评测用例，$1 \\leq x \\leq 700$，$0 \\leq y \\leq 2023$。\n- 对于 $30\\%$ 的评测用例，$1 \\leq x \\leq 10^5$，$0 \\leq y \\leq 2023$。\n- 对于所有评测用例，$1 \\leq x \\leq 10^{12}$，$0 \\leq y \\leq 2023$。", "locale": "zh-CN"}}}
{"pid": "P12285", "type": "P", "difficulty": 6, "samples": [["3 1000000007\n1 2 3", "75"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2024", "概率论", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Python A] 药剂", "background": "", "description": "小蓝今天的实验内容是合并 $N$ 瓶试剂。每瓶试剂初始都有一个魔法值 $a_i$，所有魔法值都是正整数。\n\n每次小蓝会随机从手头的试剂中选出两瓶，将其合并。合并时，两瓶试剂会发生化学反应，产生强大的力量，也有可能效果没有那么好。但无论如何，小蓝会得到一瓶全新的，可以和其他试剂合并的试剂。我们认为，小蓝在合并两瓶试剂时，如果两瓶试剂的魔法值分别是 $x$ 和 $y$，有 $\\frac{1}{2}$ 的概率，小蓝得到的新试剂魔法值为 $x+y$，对于另 $\\frac{1}{2}$ 概率，小蓝得到的新试剂的魔法值为 $xy$。\n\n像这样，小蓝重复合并操作 $n-1$ 次，最后只会剩下一瓶试剂。小蓝希望知道，最后这瓶试剂的魔法值期望是多少。为了方便，假定这个值是 $ans$，你只需要告诉小蓝，$ans$ 乘上 $2^{n-1}\\displaystyle \\prod_{i=2}^{n}C_i^2$ 的结果，其中 $C_i^2$ 是组合数。不难证明这个值一定是一个整数。但这个乘积显然太大了，小蓝只希望你告诉她这个乘积对整数 $mo$ 取模之后的结果。", "inputFormat": "输入的第一行包含两个正整数 $N, mo$，用一个空格分隔。\n\n第二行包含 $N$ 个正整数，相邻整数之间使用一个空格分隔，其中第 $i$ 个正整数表示第 $i$ 瓶试剂的魔法值 $a_i$。", "outputFormat": "输出一行包含一个整数表示答案，即最后一瓶试剂魔法值的期望乘上 $2^{n-1}\\displaystyle \\prod_{i=2}^{n}C_i^2$ 的结果。", "hint": "### 样例说明\n\n可能的合并情形较多，这里给出样例中两种可能的情况：\n\n- 第一次小蓝随机选中魔法值为 $1$ 和 $3$ 的试剂进行合并，得到魔法值为 $1+3=4$ 的一瓶新的试剂。\n- 然后小蓝对仅剩的两瓶试剂进行合并，得到 $4 \\times 2=8$ 的一瓶试剂。\n- 因此这种情况最终试剂的魔法值为 $8$。\n\n又或者：\n\n- 第一次小蓝随机选中魔法值为 $1$ 和 $2$ 的试剂进行合并，得到魔法值为 $1 \\times 2=2$ 的一瓶新的试剂。\n- 然后小蓝对仅剩的两瓶试剂进行合并，得到 $2+3=5$ 的一瓶试剂。\n- 因此这种情况最终试剂的魔法值为 $5$。\n\n### 评测用例规模与约定\n\n- 对于 $30\\%$ 的评测用例，$1 \\leq N \\leq 5$，$mo = 10^9 + 7$；\n- 对于 $50\\%$ 的评测用例，$1 \\leq N \\leq 50$，$mo = 10^9 + 7$；\n- 对于 $70\\%$ 的评测用例，$1 \\leq N \\leq 300$，$mo = 10^9 + 7$；\n- 对于 $80\\%$ 的评测用例，$mo = 10^9 + 7$；\n- 对于所有评测用例，$1 \\leq N \\leq 3000$，$1 \\leq a_i \\leq 10^9$，$1 \\leq mo \\leq 10^9 + 7$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Python A] 药剂", "background": "", "description": "小蓝今天的实验内容是合并 $N$ 瓶试剂。每瓶试剂初始都有一个魔法值 $a_i$，所有魔法值都是正整数。\n\n每次小蓝会随机从手头的试剂中选出两瓶，将其合并。合并时，两瓶试剂会发生化学反应，产生强大的力量，也有可能效果没有那么好。但无论如何，小蓝会得到一瓶全新的，可以和其他试剂合并的试剂。我们认为，小蓝在合并两瓶试剂时，如果两瓶试剂的魔法值分别是 $x$ 和 $y$，有 $\\frac{1}{2}$ 的概率，小蓝得到的新试剂魔法值为 $x+y$，对于另 $\\frac{1}{2}$ 概率，小蓝得到的新试剂的魔法值为 $xy$。\n\n像这样，小蓝重复合并操作 $n-1$ 次，最后只会剩下一瓶试剂。小蓝希望知道，最后这瓶试剂的魔法值期望是多少。为了方便，假定这个值是 $ans$，你只需要告诉小蓝，$ans$ 乘上 $2^{n-1}\\displaystyle \\prod_{i=2}^{n}C_i^2$ 的结果，其中 $C_i^2$ 是组合数。不难证明这个值一定是一个整数。但这个乘积显然太大了，小蓝只希望你告诉她这个乘积对整数 $mo$ 取模之后的结果。", "inputFormat": "输入的第一行包含两个正整数 $N, mo$，用一个空格分隔。\n\n第二行包含 $N$ 个正整数，相邻整数之间使用一个空格分隔，其中第 $i$ 个正整数表示第 $i$ 瓶试剂的魔法值 $a_i$。", "outputFormat": "输出一行包含一个整数表示答案，即最后一瓶试剂魔法值的期望乘上 $2^{n-1}\\displaystyle \\prod_{i=2}^{n}C_i^2$ 的结果。", "hint": "### 样例说明\n\n可能的合并情形较多，这里给出样例中两种可能的情况：\n\n- 第一次小蓝随机选中魔法值为 $1$ 和 $3$ 的试剂进行合并，得到魔法值为 $1+3=4$ 的一瓶新的试剂。\n- 然后小蓝对仅剩的两瓶试剂进行合并，得到 $4 \\times 2=8$ 的一瓶试剂。\n- 因此这种情况最终试剂的魔法值为 $8$。\n\n又或者：\n\n- 第一次小蓝随机选中魔法值为 $1$ 和 $2$ 的试剂进行合并，得到魔法值为 $1 \\times 2=2$ 的一瓶新的试剂。\n- 然后小蓝对仅剩的两瓶试剂进行合并，得到 $2+3=5$ 的一瓶试剂。\n- 因此这种情况最终试剂的魔法值为 $5$。\n\n### 评测用例规模与约定\n\n- 对于 $30\\%$ 的评测用例，$1 \\leq N \\leq 5$，$mo = 10^9 + 7$；\n- 对于 $50\\%$ 的评测用例，$1 \\leq N \\leq 50$，$mo = 10^9 + 7$；\n- 对于 $70\\%$ 的评测用例，$1 \\leq N \\leq 300$，$mo = 10^9 + 7$；\n- 对于 $80\\%$ 的评测用例，$mo = 10^9 + 7$；\n- 对于所有评测用例，$1 \\leq N \\leq 3000$，$1 \\leq a_i \\leq 10^9$，$1 \\leq mo \\leq 10^9 + 7$。", "locale": "zh-CN"}}}
{"pid": "P12286", "type": "P", "difficulty": 4, "samples": [], "limits": {"time": [1000], "memory": [524288]}, "tags": ["2024", "数论", "组合数学", "排列组合", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Java A] 空间传送装置", "background": "", "description": "蓝桥王国拥有 $42$ 座城市以及 $42$ 位骑士。这些骑士按照 $1$ 到 $42$ 的编号顺序，分别居住在对应编号的城市中。即第 $1$ 位骑士居住在城市 $1$，第 $2$ 位骑士居住在城市 $2$，依此类推。\n\n最近，王国中引入了一项革命性技术：空间传送装置。该装置可以根据一个长度为 $42$ 的数字排列 $a$，将所有骑士一次性传送至新的城市。\n\n排列 $a$ 必须由 $1 \\sim 42$ 共 $42$ 个数字组成，且每个数字只出现一次。在传送操作中，位于城市 $i$（$i = 1, 2, 3, \\cdots, 42$）的骑士会被传送到城市 $a_i$。例如，如果 $a_1$ 的值为 $3$，那么当前位于城市 $1$ 的骑士会被传送至城市 $3$。\n\n为测试技术的可靠性，王国决定连续 $2024$ 天每天使用同一排列 $a$ 进行一次传送操作。\n\n小蓝负责为这次测试设计排列 $a$，她的目标是确保所有骑士在经过 $2024$ 天传送后，都能返回自己的起始城市。而在此之前的任何一天，不会出现所有骑士都回到起始城市的情况。\n\n请问，有多少种不同的数字排列 $a$ 能满足小蓝的需求？由于答案可能很大，因此你只需要将答案对 $10^9 + 7$ 取模后提交即可。\n\n数字排列 $a$ 是由 $1$ 到 $42$ 这 $42$ 个数字按照一定顺序排列而成的序列。每个数字在排列中只能出现一次，且所有数字必须全部包含在排列中。\n\n如果两个排列中至少有一个位置上的数字不同，则这两个排列被视为不同的数字排列。例如，$\\{1, 2, 3, \\cdots, 42\\}$ 和 $\\{1, 3, 2, \\cdots, 42\\}$ 就是不同的数字排列，因为它们在第二个位置上的数不相同。", "inputFormat": "", "outputFormat": "这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只需要**编写一个程序输出这个整数**，输出多余的内容将无法得分。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Java A] 空间传送装置", "background": "", "description": "蓝桥王国拥有 $42$ 座城市以及 $42$ 位骑士。这些骑士按照 $1$ 到 $42$ 的编号顺序，分别居住在对应编号的城市中。即第 $1$ 位骑士居住在城市 $1$，第 $2$ 位骑士居住在城市 $2$，依此类推。\n\n最近，王国中引入了一项革命性技术：空间传送装置。该装置可以根据一个长度为 $42$ 的数字排列 $a$，将所有骑士一次性传送至新的城市。\n\n排列 $a$ 必须由 $1 \\sim 42$ 共 $42$ 个数字组成，且每个数字只出现一次。在传送操作中，位于城市 $i$（$i = 1, 2, 3, \\cdots, 42$）的骑士会被传送到城市 $a_i$。例如，如果 $a_1$ 的值为 $3$，那么当前位于城市 $1$ 的骑士会被传送至城市 $3$。\n\n为测试技术的可靠性，王国决定连续 $2024$ 天每天使用同一排列 $a$ 进行一次传送操作。\n\n小蓝负责为这次测试设计排列 $a$，她的目标是确保所有骑士在经过 $2024$ 天传送后，都能返回自己的起始城市。而在此之前的任何一天，不会出现所有骑士都回到起始城市的情况。\n\n请问，有多少种不同的数字排列 $a$ 能满足小蓝的需求？由于答案可能很大，因此你只需要将答案对 $10^9 + 7$ 取模后提交即可。\n\n数字排列 $a$ 是由 $1$ 到 $42$ 这 $42$ 个数字按照一定顺序排列而成的序列。每个数字在排列中只能出现一次，且所有数字必须全部包含在排列中。\n\n如果两个排列中至少有一个位置上的数字不同，则这两个排列被视为不同的数字排列。例如，$\\{1, 2, 3, \\cdots, 42\\}$ 和 $\\{1, 3, 2, \\cdots, 42\\}$ 就是不同的数字排列，因为它们在第二个位置上的数不相同。", "inputFormat": "", "outputFormat": "这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只需要**编写一个程序输出这个整数**，输出多余的内容将无法得分。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12287", "type": "P", "difficulty": 2, "samples": [["2\n1010 23\nA1 160", "10\n-1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "枚举", "进制", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Java A] 进制判断", "background": "", "description": "小蓝有 $n$ 个数，他将这 $n$ 个数分别转换成了 $2, 4, 8, 16$ 进制之一的形式。其中 $16$ 进制用大写字母 $A$ 至 $F$ 表示大于等于 $10$ 的数位。\n\n小蓝现在有这 $n$ 个数转换后的结果 $A_i$，但他不记得具体每个数转换后是几进制了，他现在只知道转换后的 $A_i$ 以及其原本应该小于等于某个数 $B_i$（$10$ 进制表示）。\n\n请你帮他找出每个数原本在 $10$ 进制下的值，如果不存在唯一结果请输出 $-1$。", "inputFormat": "输入的第一行包含一个整数 $n$。\n\n接下来 $n$ 行，每行包含两个整数 $A_i, B_i$，用一个空格分隔，其中 $A_i$ 是 $2, 4, 8, 16$ 进制中的一种，$B_i$ 是十进制。\n", "outputFormat": "输出 $n$ 行，每行包含一个整数表示答案。", "hint": "### 评测用例规模与约定\n\n- 对于 $40\\%$ 的评测用例，$n = 1$；\n- 对于 $70\\%$ 的评测用例，$1 \\leq n \\leq 10$；\n- 对于所有评测用例，$1 \\leq n \\leq 1000$，$1 \\leq \\mathrm{length}(A_i) \\leq 30$，$1 \\leq B_i \\leq 10^9$，其中 $\\mathrm{length}(A_i)$ 表示 $A_i$ 的长度（数位个数）。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Java A] 进制判断", "background": "", "description": "小蓝有 $n$ 个数，他将这 $n$ 个数分别转换成了 $2, 4, 8, 16$ 进制之一的形式。其中 $16$ 进制用大写字母 $A$ 至 $F$ 表示大于等于 $10$ 的数位。\n\n小蓝现在有这 $n$ 个数转换后的结果 $A_i$，但他不记得具体每个数转换后是几进制了，他现在只知道转换后的 $A_i$ 以及其原本应该小于等于某个数 $B_i$（$10$ 进制表示）。\n\n请你帮他找出每个数原本在 $10$ 进制下的值，如果不存在唯一结果请输出 $-1$。", "inputFormat": "输入的第一行包含一个整数 $n$。\n\n接下来 $n$ 行，每行包含两个整数 $A_i, B_i$，用一个空格分隔，其中 $A_i$ 是 $2, 4, 8, 16$ 进制中的一种，$B_i$ 是十进制。\n", "outputFormat": "输出 $n$ 行，每行包含一个整数表示答案。", "hint": "### 评测用例规模与约定\n\n- 对于 $40\\%$ 的评测用例，$n = 1$；\n- 对于 $70\\%$ 的评测用例，$1 \\leq n \\leq 10$；\n- 对于所有评测用例，$1 \\leq n \\leq 1000$，$1 \\leq \\mathrm{length}(A_i) \\leq 30$，$1 \\leq B_i \\leq 10^9$，其中 $\\mathrm{length}(A_i)$ 表示 $A_i$ 的长度（数位个数）。", "locale": "zh-CN"}}}
{"pid": "P12288", "type": "P", "difficulty": 3, "samples": [["4\n1\n2\n3\n2", "0\n1\n2\n1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "链表", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Java A] 栈", "background": "", "description": "小蓝有一个栈，他不断地向这个栈的顶端添加数字。小蓝希望栈中不存在相同的数，当他加入了一个之前已经存在的数时，栈中之前存在的那个数会消失（其它原有元素的相对顺序不变），小蓝还想随时知道栈中所有相邻的数中和为奇数的总共有多少组，请你计算出小蓝要求的结果。", "inputFormat": "输入的第一行包含一个整数 $n$。\n\n接下来 $n$ 行，每行包含一个整数 $A_i$，表示被添加的数。", "outputFormat": "输出 $n$ 行，每行包含一个整数表示每次添加数后的答案。", "hint": "### 评测用例规模与约定\n\n- 对于 $30\\%$ 的评测用例，$1 \\leq n \\leq 1000$，$A_i \\leq 300$；\n- 对于 $70\\%$ 的评测用例，$1 \\leq n \\leq 10^5$，$A_i \\leq 1000$；\n- 对于所有评测用例，$1 \\leq n \\leq 5 \\times 10^5$，$1 \\leq A_i \\leq 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Java A] 栈", "background": "", "description": "小蓝有一个栈，他不断地向这个栈的顶端添加数字。小蓝希望栈中不存在相同的数，当他加入了一个之前已经存在的数时，栈中之前存在的那个数会消失（其它原有元素的相对顺序不变），小蓝还想随时知道栈中所有相邻的数中和为奇数的总共有多少组，请你计算出小蓝要求的结果。", "inputFormat": "输入的第一行包含一个整数 $n$。\n\n接下来 $n$ 行，每行包含一个整数 $A_i$，表示被添加的数。", "outputFormat": "输出 $n$ 行，每行包含一个整数表示每次添加数后的答案。", "hint": "### 评测用例规模与约定\n\n- 对于 $30\\%$ 的评测用例，$1 \\leq n \\leq 1000$，$A_i \\leq 300$；\n- 对于 $70\\%$ 的评测用例，$1 \\leq n \\leq 10^5$，$A_i \\leq 1000$；\n- 对于所有评测用例，$1 \\leq n \\leq 5 \\times 10^5$，$1 \\leq A_i \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P12289", "type": "P", "difficulty": 3, "samples": [["123456789301", "1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "单调队列", "2024", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Java A] 修改数位", "background": null, "description": "给定一个 $n$ 位的没有前导零的十进制数 $m$，你可以将其任意位 $a_i$ 改为任意其它数字 $b_i$，花费为 $|b_i - a_i|$。我们希望通过最少的花费使得修改后的数中存在连续的 $10$ 位，包含了从 $0$ 到 $9$ 的所有数字，且每个数字恰好出现一次。\n\n请输出最少需要的花费是多少（修改后也要求没有前导零）。", "inputFormat": "输入一行包含一个整数表示 $m$。", "outputFormat": "输出一行包含一个整数表示答案。", "hint": "### 样例说明\n\n将右边第 $3$ 位改为 $2$ 是一种方案，此时后 $10$ 位恰好含有 $0 \\sim 9$ 各一个。\n\n### 评测用例规模与约定\n\n- 对于 $40\\%$ 的评测用例，$10 \\leq n \\leq 500$；\n- 对于 $60\\%$ 的评测用例，$10 \\leq n \\leq 5000$；\n- 对于所有评测用例，$10 \\leq n \\leq 10^6$，请注意 $n$ 表示数位个数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Java A] 修改数位", "background": null, "description": "给定一个 $n$ 位的没有前导零的十进制数 $m$，你可以将其任意位 $a_i$ 改为任意其它数字 $b_i$，花费为 $|b_i - a_i|$。我们希望通过最少的花费使得修改后的数中存在连续的 $10$ 位，包含了从 $0$ 到 $9$ 的所有数字，且每个数字恰好出现一次。\n\n请输出最少需要的花费是多少（修改后也要求没有前导零）。", "inputFormat": "输入一行包含一个整数表示 $m$。", "outputFormat": "输出一行包含一个整数表示答案。", "hint": "### 样例说明\n\n将右边第 $3$ 位改为 $2$ 是一种方案，此时后 $10$ 位恰好含有 $0 \\sim 9$ 各一个。\n\n### 评测用例规模与约定\n\n- 对于 $40\\%$ 的评测用例，$10 \\leq n \\leq 500$；\n- 对于 $60\\%$ 的评测用例，$10 \\leq n \\leq 5000$；\n- 对于所有评测用例，$10 \\leq n \\leq 10^6$，请注意 $n$ 表示数位个数。", "locale": "zh-CN"}}}
{"pid": "P12290", "type": "P", "difficulty": 4, "samples": [["4\n2 3 5 6", "3 5"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "字典树 Trie", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Java A] 基因组合", "background": "", "description": "在医学领域，两位杰出的医生，小蓝和小乔，正在研究一种新型的基因治疗方案。他们需要从 $n$ 个候选基因中分别选择一个，并通过某种特定的运算将它们组合起来，以评估治疗方案的有效性。\n\n已知这 $n$ 个候选基因可以用一个数组 $\\{a_1, a_2, \\cdots, a_n\\}$ 来表示，其中 $a_i$ 代表第 $i$ 个基因的特性数值。而将两个基因组合起来的方式，则是将它们的特性数值进行异或运算（用符号 $\\oplus$ 表示）。\n\n小蓝倾向于激进的治疗方案，他总是希望所选基因组合的异或值尽可能大，以获得显著的治疗效果。小乔则更注重治疗的稳定性，他总是希望所选基因组合的异或值尽可能小，以降低治疗风险。\n\n现在，两位医生需要决定先后选择的顺序。\n\n假设双方都足够聪明，且都会使用最佳策略来最大化或最小化基因组合的异或值。请问，如果小蓝先选择基因，小乔后选择，那么他们能够得到的基因组合的最大异或值会是多少？反之，如果小乔先选择基因，小蓝后选择，那么他们能够得到的基因组合的最小异或值又会是多少？", "inputFormat": "输入的第一行包含一个整数 $n$，表示候选基因的数量。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\cdots, a_n$，相邻整数之间使用一个空格分隔，依次表示每个基因的特性数值。", "outputFormat": "输出一行，包含两个整数。第一个整数表示小蓝先选择基因时能够得到的基因组合的最大异或值；第二个整数表示小乔先选择基因时能够得到的基因组合的最小异或值。", "hint": "### 样例说明\n\n在给定样例中，候选基因的数量为 $4$，特性数值分别为 $2$、$3$、$5$ 和 $6$。\n\n当小蓝先选择基因时，小蓝可以选择特性值为 $6$ 的基因，使基因组合的异或值尽可能大，小乔则会选择特性值为 $5$ 的基因，使基因组合的异或值尽可能小：$6 \\oplus 5 = 3$。\n\n当小乔先选择基因时，小乔可以选择特性值为 $6$ 的基因，使基因组合的异或值尽可能小，小蓝则会选择特性值为 $3$ 的基因，使基因组合的异或值尽可能大：$6 \\oplus 3 = 5$。\n\n### 评测用例规模与约定\n\n- 对于 $30\\%$ 的评测用例，$2 \\leq n \\leq 10^3$，$1 \\leq a_i \\leq 10^5$。\n- 对于所有评测用例，$2 \\leq n \\leq 10^5$，$1 \\leq a_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Java A] 基因组合", "background": "", "description": "在医学领域，两位杰出的医生，小蓝和小乔，正在研究一种新型的基因治疗方案。他们需要从 $n$ 个候选基因中分别选择一个，并通过某种特定的运算将它们组合起来，以评估治疗方案的有效性。\n\n已知这 $n$ 个候选基因可以用一个数组 $\\{a_1, a_2, \\cdots, a_n\\}$ 来表示，其中 $a_i$ 代表第 $i$ 个基因的特性数值。而将两个基因组合起来的方式，则是将它们的特性数值进行异或运算（用符号 $\\oplus$ 表示）。\n\n小蓝倾向于激进的治疗方案，他总是希望所选基因组合的异或值尽可能大，以获得显著的治疗效果。小乔则更注重治疗的稳定性，他总是希望所选基因组合的异或值尽可能小，以降低治疗风险。\n\n现在，两位医生需要决定先后选择的顺序。\n\n假设双方都足够聪明，且都会使用最佳策略来最大化或最小化基因组合的异或值。请问，如果小蓝先选择基因，小乔后选择，那么他们能够得到的基因组合的最大异或值会是多少？反之，如果小乔先选择基因，小蓝后选择，那么他们能够得到的基因组合的最小异或值又会是多少？", "inputFormat": "输入的第一行包含一个整数 $n$，表示候选基因的数量。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\cdots, a_n$，相邻整数之间使用一个空格分隔，依次表示每个基因的特性数值。", "outputFormat": "输出一行，包含两个整数。第一个整数表示小蓝先选择基因时能够得到的基因组合的最大异或值；第二个整数表示小乔先选择基因时能够得到的基因组合的最小异或值。", "hint": "### 样例说明\n\n在给定样例中，候选基因的数量为 $4$，特性数值分别为 $2$、$3$、$5$ 和 $6$。\n\n当小蓝先选择基因时，小蓝可以选择特性值为 $6$ 的基因，使基因组合的异或值尽可能大，小乔则会选择特性值为 $5$ 的基因，使基因组合的异或值尽可能小：$6 \\oplus 5 = 3$。\n\n当小乔先选择基因时，小乔可以选择特性值为 $6$ 的基因，使基因组合的异或值尽可能小，小蓝则会选择特性值为 $3$ 的基因，使基因组合的异或值尽可能大：$6 \\oplus 3 = 5$。\n\n### 评测用例规模与约定\n\n- 对于 $30\\%$ 的评测用例，$2 \\leq n \\leq 10^3$，$1 \\leq a_i \\leq 10^5$。\n- 对于所有评测用例，$2 \\leq n \\leq 10^5$，$1 \\leq a_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P12291", "type": "P", "difficulty": 4, "samples": [["4\n1 1 1 1", "4"], ["2\n0 0", "1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "组合数学", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Java A] 粉刷匠小蓝", "background": "", "description": "小蓝是一名勤劳的粉刷匠，今天他收到了一份来自蓝桥学院的委托，需要为学院的 $n$ 面墙进行粉刷。这 $n$ 面墙从左到右依次排列，编号从 $1$ 到 $n$。起初，所有墙的颜色均为白色。\n\n学院希望小蓝能将其中一部分墙刷成蓝色，以营造一种冷色调的艺术氛围。为此，学院给小蓝提供了一个长度为 $n$ 的数组 $\\{a_1, a_2, \\cdots, a_n\\}$，来指定每面墙的颜色要求。具体地，如果 $a_i = 0$，则第 $i$ 面墙保持白色；如果 $a_i = 1$，则小蓝需要将第 $i$ 面墙刷成蓝色。\n\n小蓝每次只能刷一面墙，他会将一面墙完整的刷完后再刷另一面墙。为了确保整体墙面的视觉效果，学院还提一个小小的要求：在粉刷过程中，如果要将第 $i$ 面墙刷成蓝色，那么它右侧（第 $i + 1$ 面墙 $\\sim$ 第 $n$ 面墙）蓝色的墙的个数必须是偶数（包括 $0$ 个）。\n\n现在，请你计算小蓝共有多少种刷墙顺序可以满足学院的要求？由于答案可能很大，因此你只需要给出答案对 $10^9 + 7$ 取模后的结果即可。\n\n在本题中，不同的刷墙方法只与小蓝刷墙的顺序有关。例如，先刷第 $1$ 面墙再刷第 $2$ 面墙，与先刷第 $2$ 面墙再刷第 $1$ 面墙，被视为两种不同的方法。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示墙的数量。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\cdots, a_n$，相邻整数之间使用一个空格分隔，按编号从 $1$ 到 $n$ 的顺序依次表示每面墙的颜色要求。", "outputFormat": "输出一行包含一个整数，表示满足要求的刷墙顺序数量对 $10^9 + 7$ 取模后的结果。", "hint": "### 样例说明\n\n在样例 $1$ 中，有 $4$ 面墙，且都需要刷为蓝色。总共有以下 $4$ 种粉刷顺序可以满足学院的要求：\n\n1. $[1,2,3,4]$：先刷第 $1$ 面，再刷第 $2$ 面，然后刷第 $3$ 面，最后刷第 $4$ 面。\n2. $[1,3,4,2]$：先刷第 $1$ 面，再刷第 $3$ 面，然后刷第 $4$ 面，最后刷第 $2$ 面。\n3. $[2,3,1,4]$：先刷第 $2$ 面，再刷第 $3$ 面，然后刷第 $1$ 面，最后刷第 $4$ 面。\n4. $[3,4,1,2]$：先刷第 $3$ 面，再刷第 $4$ 面，然后刷第 $1$ 面，最后刷第 $2$ 面。\n\n在样例 2 中，有 $2$ 面墙，且都要保持白色。只有 $1$ 种刷墙方法可以满足学院的要求，即不刷任何一面墙壁。\n\n### 评测用例规模与约定\n\n- 对于 $20\\%$ 的评测用例，$1 \\leq n \\leq 13$，$a_i = 1$。\n- 对于所有评测用例，$1 \\leq n \\leq 2 \\times 10^5$，$0 \\leq a_i \\leq 1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Java A] 粉刷匠小蓝", "background": "", "description": "小蓝是一名勤劳的粉刷匠，今天他收到了一份来自蓝桥学院的委托，需要为学院的 $n$ 面墙进行粉刷。这 $n$ 面墙从左到右依次排列，编号从 $1$ 到 $n$。起初，所有墙的颜色均为白色。\n\n学院希望小蓝能将其中一部分墙刷成蓝色，以营造一种冷色调的艺术氛围。为此，学院给小蓝提供了一个长度为 $n$ 的数组 $\\{a_1, a_2, \\cdots, a_n\\}$，来指定每面墙的颜色要求。具体地，如果 $a_i = 0$，则第 $i$ 面墙保持白色；如果 $a_i = 1$，则小蓝需要将第 $i$ 面墙刷成蓝色。\n\n小蓝每次只能刷一面墙，他会将一面墙完整的刷完后再刷另一面墙。为了确保整体墙面的视觉效果，学院还提一个小小的要求：在粉刷过程中，如果要将第 $i$ 面墙刷成蓝色，那么它右侧（第 $i + 1$ 面墙 $\\sim$ 第 $n$ 面墙）蓝色的墙的个数必须是偶数（包括 $0$ 个）。\n\n现在，请你计算小蓝共有多少种刷墙顺序可以满足学院的要求？由于答案可能很大，因此你只需要给出答案对 $10^9 + 7$ 取模后的结果即可。\n\n在本题中，不同的刷墙方法只与小蓝刷墙的顺序有关。例如，先刷第 $1$ 面墙再刷第 $2$ 面墙，与先刷第 $2$ 面墙再刷第 $1$ 面墙，被视为两种不同的方法。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示墙的数量。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\cdots, a_n$，相邻整数之间使用一个空格分隔，按编号从 $1$ 到 $n$ 的顺序依次表示每面墙的颜色要求。", "outputFormat": "输出一行包含一个整数，表示满足要求的刷墙顺序数量对 $10^9 + 7$ 取模后的结果。", "hint": "### 样例说明\n\n在样例 $1$ 中，有 $4$ 面墙，且都需要刷为蓝色。总共有以下 $4$ 种粉刷顺序可以满足学院的要求：\n\n1. $[1,2,3,4]$：先刷第 $1$ 面，再刷第 $2$ 面，然后刷第 $3$ 面，最后刷第 $4$ 面。\n2. $[1,3,4,2]$：先刷第 $1$ 面，再刷第 $3$ 面，然后刷第 $4$ 面，最后刷第 $2$ 面。\n3. $[2,3,1,4]$：先刷第 $2$ 面，再刷第 $3$ 面，然后刷第 $1$ 面，最后刷第 $4$ 面。\n4. $[3,4,1,2]$：先刷第 $3$ 面，再刷第 $4$ 面，然后刷第 $1$ 面，最后刷第 $2$ 面。\n\n在样例 2 中，有 $2$ 面墙，且都要保持白色。只有 $1$ 种刷墙方法可以满足学院的要求，即不刷任何一面墙壁。\n\n### 评测用例规模与约定\n\n- 对于 $20\\%$ 的评测用例，$1 \\leq n \\leq 13$，$a_i = 1$。\n- 对于所有评测用例，$1 \\leq n \\leq 2 \\times 10^5$，$0 \\leq a_i \\leq 1$。", "locale": "zh-CN"}}}
{"pid": "P12292", "type": "P", "difficulty": 6, "samples": [["2 1000000007\n500000004 500000004", "666666672 333333336"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "概率论", "蓝桥杯国赛", "状压 DP"], "title": "[蓝桥杯 2024 国 Java A] 斗蛐蛐", "background": "", "description": "小蓝最近非常热衷于斗蛐蛐。她有 $n$ 只不同的蛐蛐，每只蛐蛐的战斗力都可以用一个数 $a_i$ 表示，含义是当第 $i$ 只蛐蛐攻击别的蛐蛐时有 $a_i$ 的概率打倒对方，有 $1 - a_i$ 的概率无事发生。\n\n小蓝将 $n$ 只蛐蛐按编号由 $1$ 到 $n$ 顺时针的顺序排成一圈，然后从 $1$ 号蛐蛐开始发生以下的过程直到只剩下 $1$ 只蛐蛐：\n\n1. 这只蛐蛐以各 $1/2$ 的概率选定顺时针或逆时针方向。\n2. 这只蛐蛐攻击这个方向上第一只未被打倒的蛐蛐。\n3. 无论这次攻击是否打倒了蛐蛐，顺时针方向的下一只蛐蛐开始行动。\n\n现在小蓝希望知道，最后剩下的蛐蛐是 $i$ 号蛐蛐的概率是多少。为了防止精度误差，她希望你给出这个值在模素数 $m$ 下的结果。", "inputFormat": "输入的第一行包含两个正整数 $n, m$，用一个空格分隔。\n\n第二行包含 $n$ 个正整数，其中第 $i$ 个正整数表示第 $i$ 只蛐蛐在模 $m$ 下的战斗力 $a_i$。", "outputFormat": "输出一行包含 $n$ 整数，相邻整数之间使用一个空格分隔，其中第 $i$ 个整数表示最后一只蛐蛐是 $i$ 号蛐蛐的概率在模 $m$ 下的表示。", "hint": "### 样例说明\n\n一共两只蛐蛐，蛐蛐的战斗力都是 $1/2$，$1$ 号蛐蛐攻击 $2$ 号蛐蛐若成功，则 $1$ 号蛐蛐获胜，若失败则相当于双方位置交换，所以最终 $1$ 号蛐蛐获胜概率 $p$ 满足 $p = 1/2 + 1/2(1 - p)$ 解得 $p = 2/3$。\n\n### 评测用例规模与约定\n\n- 对于 $30\\%$ 的评测用例，$n \\leq 8$，$a_i = (m + 1)/2$，即 $a_i$ 在模 $m$ 意义下为 $\\frac{1}{2}$；\n- 对于 $50\\%$ 的评测用例，$n \\leq 8$；\n- 对于所有评测用例，$2 \\leq a_i < m \\leq 10^9 + 7$，$2 \\leq n \\leq 15$，$m$ 必定为一个大于 $2$ 的素数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Java A] 斗蛐蛐", "background": "", "description": "小蓝最近非常热衷于斗蛐蛐。她有 $n$ 只不同的蛐蛐，每只蛐蛐的战斗力都可以用一个数 $a_i$ 表示，含义是当第 $i$ 只蛐蛐攻击别的蛐蛐时有 $a_i$ 的概率打倒对方，有 $1 - a_i$ 的概率无事发生。\n\n小蓝将 $n$ 只蛐蛐按编号由 $1$ 到 $n$ 顺时针的顺序排成一圈，然后从 $1$ 号蛐蛐开始发生以下的过程直到只剩下 $1$ 只蛐蛐：\n\n1. 这只蛐蛐以各 $1/2$ 的概率选定顺时针或逆时针方向。\n2. 这只蛐蛐攻击这个方向上第一只未被打倒的蛐蛐。\n3. 无论这次攻击是否打倒了蛐蛐，顺时针方向的下一只蛐蛐开始行动。\n\n现在小蓝希望知道，最后剩下的蛐蛐是 $i$ 号蛐蛐的概率是多少。为了防止精度误差，她希望你给出这个值在模素数 $m$ 下的结果。", "inputFormat": "输入的第一行包含两个正整数 $n, m$，用一个空格分隔。\n\n第二行包含 $n$ 个正整数，其中第 $i$ 个正整数表示第 $i$ 只蛐蛐在模 $m$ 下的战斗力 $a_i$。", "outputFormat": "输出一行包含 $n$ 整数，相邻整数之间使用一个空格分隔，其中第 $i$ 个整数表示最后一只蛐蛐是 $i$ 号蛐蛐的概率在模 $m$ 下的表示。", "hint": "### 样例说明\n\n一共两只蛐蛐，蛐蛐的战斗力都是 $1/2$，$1$ 号蛐蛐攻击 $2$ 号蛐蛐若成功，则 $1$ 号蛐蛐获胜，若失败则相当于双方位置交换，所以最终 $1$ 号蛐蛐获胜概率 $p$ 满足 $p = 1/2 + 1/2(1 - p)$ 解得 $p = 2/3$。\n\n### 评测用例规模与约定\n\n- 对于 $30\\%$ 的评测用例，$n \\leq 8$，$a_i = (m + 1)/2$，即 $a_i$ 在模 $m$ 意义下为 $\\frac{1}{2}$；\n- 对于 $50\\%$ 的评测用例，$n \\leq 8$；\n- 对于所有评测用例，$2 \\leq a_i < m \\leq 10^9 + 7$，$2 \\leq n \\leq 15$，$m$ 必定为一个大于 $2$ 的素数。", "locale": "zh-CN"}}}
{"pid": "P12293", "type": "P", "difficulty": 6, "samples": [["3 5\n2 1\n3 1\n4 1", "406692146"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864]}, "tags": ["动态规划 DP", "2024", "期望", "蓝桥杯国赛"], "title": "[蓝桥杯 2024 国 Java A] 合并小球", "background": "", "description": "给定 $n$ 个小球，其中第 $i$ 个小球位于数轴的 $x_i$ 处，小球上有数字 $y_i$。\n\n每经过一秒，每个小球都有 $\\frac{1}{2}$ 的概率向右移动一步。当任意小球到达位置 $T$ 时，小球会被立刻取走。\n\n如果某一秒，有两个相邻的小球，左边的向右移动且右边的不动，那么两个小球会合并成一个，且合并后小球的数字为合并前的小球数字的乘积。\n\n求所有小球都被取走时的数字之和的期望值，答案对 $998244353$ 取模。", "inputFormat": "输入的第一行包含两个整数 $n, T$，用一个空格分隔。\n\n接下来 $n$ 行，每行包含两个数 $x_i, y_i$，用一个空格分隔。", "outputFormat": "输出一行包含一个整数表示答案。", "hint": "### 样例说明\n\n$\\frac{59}{27} \\equiv 406692146 \\pmod{998244353}$，其中 $\\frac{1}{27} \\equiv 480636170 \\pmod{998244353}$。\n\n### 评测用例规模与约定\n\n- 对于 $20\\%$ 的评测用例，$n \\leq 5$，$T \\leq 10$；\n- 对于 $40\\%$ 的评测用例，$n \\leq 10$，$T \\leq 20$；\n- 对于所有评测用例，$1 \\leq n < T \\leq 100$，$1 \\leq x_{i-1} < x_i < T$，$1 \\leq y_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[蓝桥杯 2024 国 Java A] 合并小球", "background": "", "description": "给定 $n$ 个小球，其中第 $i$ 个小球位于数轴的 $x_i$ 处，小球上有数字 $y_i$。\n\n每经过一秒，每个小球都有 $\\frac{1}{2}$ 的概率向右移动一步。当任意小球到达位置 $T$ 时，小球会被立刻取走。\n\n如果某一秒，有两个相邻的小球，左边的向右移动且右边的不动，那么两个小球会合并成一个，且合并后小球的数字为合并前的小球数字的乘积。\n\n求所有小球都被取走时的数字之和的期望值，答案对 $998244353$ 取模。", "inputFormat": "输入的第一行包含两个整数 $n, T$，用一个空格分隔。\n\n接下来 $n$ 行，每行包含两个数 $x_i, y_i$，用一个空格分隔。", "outputFormat": "输出一行包含一个整数表示答案。", "hint": "### 样例说明\n\n$\\frac{59}{27} \\equiv 406692146 \\pmod{998244353}$，其中 $\\frac{1}{27} \\equiv 480636170 \\pmod{998244353}$。\n\n### 评测用例规模与约定\n\n- 对于 $20\\%$ 的评测用例，$n \\leq 5$，$T \\leq 10$；\n- 对于 $40\\%$ 的评测用例，$n \\leq 10$，$T \\leq 20$；\n- 对于所有评测用例，$1 \\leq n < T \\leq 100$，$1 \\leq x_{i-1} < x_i < T$，$1 \\leq y_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P12294", "type": "P", "difficulty": 7, "samples": [["00011011 2\n10101\n00000", "((101)01)\n-1"], ["00010111 4\n11100\n11000\n10100\n10000", "(11(100))\n(11(000))\n-1\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "状态合并", "有限状态自动机", "构造"], "title": "[THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1（加强版）", "background": "关于 $a,b,c$ 的三目运算表 $s_0s_1\\cdots s_7$（$s$ 仅由 `0,1` 组成）的含义是，如果 $s$ 的第 $a+2b+4c$ 位为 `1`，那么返回 $1$，否则返回 $0$。\n\n本题参考了 [[THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1](https://www.luogu.com.cn/problem/P12055)。", "description": "给定运算表 $s$ 以及 $q$ 个长为 $2n+1$ 的 01 串，你需要对于对每个 01 串分别回答：\n\n能否操作 $n$ 次，每次将三位连续的数字替换为所对应的运算值，使得运算的结果为 $1$，或判断无解。", "inputFormat": "第一行为长度为 $8$ 的字符串 $s$ 以及给定询问串数量 $q$。\n\n接下去 $q$ 行，每行一个长为奇数的 01 串，表示给定的字符串。", "outputFormat": "对于每组询问输出一行，如果无解输出 `-1`，否则，输出一个由 `0,1,(,)` 组成的字符串描述运算方式及顺序，具体而言，计算的时候，会按照括号从内到外，从左到右的顺序依次解析括号，将对应的数字替换为运算结果，你需要保证每次运算时参与计算的运算数恰好为 $3$，具体可参见样例输出。", "hint": "### 样例 #1 解释\n\n本样例即为 [THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1 一题中的样例。\n\n### 样例 #2 解释\n\n本样例即为 [AGC022E] Median Replace 一题中的样例。\n\n### 数据范围\n\n本题共 $256$ 个测试点，其中测试点编号为 $i(1\\le i\\le256)$ 的 $s$ 为 $i-1$ 的二进制表达（低位在前，高位在后），其中每个测试点输入的单个字符串长度不超过 $10^5$，字符串长度总和不超过 $3\\times10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1（加强版）", "background": "关于 $a,b,c$ 的三目运算表 $s_0s_1\\cdots s_7$（$s$ 仅由 `0,1` 组成）的含义是，如果 $s$ 的第 $a+2b+4c$ 位为 `1`，那么返回 $1$，否则返回 $0$。\n\n本题参考了 [[THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1](https://www.luogu.com.cn/problem/P12055)。", "description": "给定运算表 $s$ 以及 $q$ 个长为 $2n+1$ 的 01 串，你需要对于对每个 01 串分别回答：\n\n能否操作 $n$ 次，每次将三位连续的数字替换为所对应的运算值，使得运算的结果为 $1$，或判断无解。", "inputFormat": "第一行为长度为 $8$ 的字符串 $s$ 以及给定询问串数量 $q$。\n\n接下去 $q$ 行，每行一个长为奇数的 01 串，表示给定的字符串。", "outputFormat": "对于每组询问输出一行，如果无解输出 `-1`，否则，输出一个由 `0,1,(,)` 组成的字符串描述运算方式及顺序，具体而言，计算的时候，会按照括号从内到外，从左到右的顺序依次解析括号，将对应的数字替换为运算结果，你需要保证每次运算时参与计算的运算数恰好为 $3$，具体可参见样例输出。", "hint": "### 样例 #1 解释\n\n本样例即为 [THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1 一题中的样例。\n\n### 样例 #2 解释\n\n本样例即为 [AGC022E] Median Replace 一题中的样例。\n\n### 数据范围\n\n本题共 $256$ 个测试点，其中测试点编号为 $i(1\\le i\\le256)$ 的 $s$ 为 $i-1$ 的二进制表达（低位在前，高位在后），其中每个测试点输入的单个字符串长度不超过 $10^5$，字符串长度总和不超过 $3\\times10^5$。", "locale": "zh-CN"}}}
{"pid": "P12295", "type": "P", "difficulty": 3, "samples": [], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2022", "2023", "交互题", "Special Judge", "ICPC", "WF"], "title": "[ICPC 2022/2023 WF] Riddle of the Sphinx", "background": "", "description": "One of the most remarkable landmarks in Egypt is the Great Sphinx of Giza, a statue depicting a mythical creature with the head of a human, the body of a lion, and the wings of an eagle. Sphinxes were regarded as guardians in Egyptian and Greek mythologies. Probably the most famous sphinx is the one who guarded the Greek city of Thebes. According to myths, when Oedipus tried to enter the city, the sphinx gave him the following riddle: \"Which creature has one voice, but has four feet in the morning, two feet in the afternoon, and three feet at night?\" As you might have heard, Oedipus correctly answered, \"Man— who crawls on all fours as a baby, then walks on two feet as an adult, and then uses a walking stick in old age.\"\n\nIn this problem, you meet a different sphinx who gives you a somewhat reversed riddle: \"How many legs do an axex, a basilisk, and a centaur have?\" While you recognize these as creatures from Egyptian and Greek mythology, you have no clue how many legs each has (except that it is a nonnegative integer). The sphinx sternly instructs you to not touch anything so you are unable to search for the answer on your phone.\n\nHowever, the sphinx allows you to ask her five questions. In each question you can ask the sphinx how many legs some number of these creatures have in total. For instance, you could ask, \"How many legs do three basilisks and one axex have in total?\" or \"How many legs do five centaurs have?\" Seems easy enough, you think, but then you remember that sphinxes are tricky creatures: one of the sphinx's five answers might be an outright lie, and you do not know which one.\n\nWrite a program to talk to the sphinx, ask the five questions, and solve the riddle.\n\n### Interaction\n\nThere are exactly five rounds of questions. In each question round, you must first write a line containing three space-separated integers $a$, $b$, and $c$ ($0 \\le a, b, c \\le 10$), representing the question \"How many legs do $a$ axex, $b$ basilisks, and $c$ centaurs have in total?\" After the question is asked, an input line containing a single integer $r$ ($0 \\le r \\le 10^5$) is available on standard input, giving the sphinx's answer to your question.\n\nAfter the five rounds of questions, output a line containing three space-separated nonnegative integers $\\ell_a$, $\\ell_b$, and $\\ell_c$, indicating the number of legs of an axex, a basilisk, and a centaur, respectively.\n\n### Sample Interaction 1\n\n| Read | Write |\n| :------: | :------: |\n|          | `1 1 1`  |\n|   `12`   |          |\n|          | `1 1 1`  |\n|   `13`   |          |\n|          | `5 0 1`  |\n|   `24`   |          |\n|          | `1 0 0`  |\n|   `4`    |          |\n|          | `1 1 0`  |\n|   `8`    |          |\n|          | `4 4 4`  |\n\n### Sample Interaction 2\n\n| Read | Write |\n| :------: | :---------: |\n|          |   `4 4 4`   |\n|  `2023`  |             |\n|          |   `1 0 0`   |\n|   `0`    |             |\n|          |   `0 1 0`   |\n|   `42`   |             |\n|          |   `0 0 1`   |\n|  `2024`  |             |\n|          |   `0 0 0`   |\n|   `0`    |             |\n|          | `0 42 2024` |\n\n", "inputFormat": "", "outputFormat": "", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2022/2023 WF] Riddle of the Sphinx", "background": "", "description": "One of the most remarkable landmarks in Egypt is the Great Sphinx of Giza, a statue depicting a mythical creature with the head of a human, the body of a lion, and the wings of an eagle. Sphinxes were regarded as guardians in Egyptian and Greek mythologies. Probably the most famous sphinx is the one who guarded the Greek city of Thebes. According to myths, when Oedipus tried to enter the city, the sphinx gave him the following riddle: \"Which creature has one voice, but has four feet in the morning, two feet in the afternoon, and three feet at night?\" As you might have heard, Oedipus correctly answered, \"Man— who crawls on all fours as a baby, then walks on two feet as an adult, and then uses a walking stick in old age.\"\n\nIn this problem, you meet a different sphinx who gives you a somewhat reversed riddle: \"How many legs do an axex, a basilisk, and a centaur have?\" While you recognize these as creatures from Egyptian and Greek mythology, you have no clue how many legs each has (except that it is a nonnegative integer). The sphinx sternly instructs you to not touch anything so you are unable to search for the answer on your phone.\n\nHowever, the sphinx allows you to ask her five questions. In each question you can ask the sphinx how many legs some number of these creatures have in total. For instance, you could ask, \"How many legs do three basilisks and one axex have in total?\" or \"How many legs do five centaurs have?\" Seems easy enough, you think, but then you remember that sphinxes are tricky creatures: one of the sphinx's five answers might be an outright lie, and you do not know which one.\n\nWrite a program to talk to the sphinx, ask the five questions, and solve the riddle.\n\n### Interaction\n\nThere are exactly five rounds of questions. In each question round, you must first write a line containing three space-separated integers $a$, $b$, and $c$ ($0 \\le a, b, c \\le 10$), representing the question \"How many legs do $a$ axex, $b$ basilisks, and $c$ centaurs have in total?\" After the question is asked, an input line containing a single integer $r$ ($0 \\le r \\le 10^5$) is available on standard input, giving the sphinx's answer to your question.\n\nAfter the five rounds of questions, output a line containing three space-separated nonnegative integers $\\ell_a$, $\\ell_b$, and $\\ell_c$, indicating the number of legs of an axex, a basilisk, and a centaur, respectively.\n\n### Sample Interaction 1\n\n| Read | Write |\n| :------: | :------: |\n|          | `1 1 1`  |\n|   `12`   |          |\n|          | `1 1 1`  |\n|   `13`   |          |\n|          | `5 0 1`  |\n|   `24`   |          |\n|          | `1 0 0`  |\n|   `4`    |          |\n|          | `1 1 0`  |\n|   `8`    |          |\n|          | `4 4 4`  |\n\n### Sample Interaction 2\n\n| Read | Write |\n| :------: | :---------: |\n|          |   `4 4 4`   |\n|  `2023`  |             |\n|          |   `1 0 0`   |\n|   `0`    |             |\n|          |   `0 1 0`   |\n|   `42`   |             |\n|          |   `0 0 1`   |\n|  `2024`  |             |\n|          |   `0 0 0`   |\n|   `0`    |             |\n|          | `0 42 2024` |\n\n", "inputFormat": "", "outputFormat": "", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022/2023 WF] 斯芬克斯的谜语", "background": "", "description": "埃及最有名的地标之一是吉萨的狮身人面像，这座雕像描绘了一个人头狮身鹰翼的神兽斯芬克斯的形象。在埃及和希腊神话中，斯芬克斯被认为是守护神。最有名的斯芬克斯大概是守卫雅典城市底比斯的那位。根据神话，当俄狄浦斯试图进城时，斯芬克斯问了他一个谜语：「哪种生物有一种声音，但是早上有四只脚，下午有两只脚，晚上有三只脚？」你可能听说过，俄狄浦斯正确地回答了：「是人——人在婴儿时用双脚双手爬行，成年时用双脚走路，晚年使用拐杖。」\n\n本题中，你遇到了另一个斯芬克斯，他问了你一个有点相反的谜语：「一只格里芬，一只巴西利斯克和一只半人马分别有几条腿？」当意识到这是埃及和希腊神话中的神兽时，你并不清楚他们有多少条腿（除了这个数量应该是个非负整数以外）。斯芬克斯严厉地指示你不要碰任何东西，这样你就没法用手机搜索答案了。\n\n然而，斯芬克斯允许你问她五个问题。在每个问题中，你都可以问斯芬克斯一些数量的神兽一共有多少条腿。例如，你可以问「三只巴西利斯克和一只格里芬一共有几条腿？」，或者「五只半人马一共有几条腿？」。你觉得看起来太简单了，但是你此时想起斯芬克斯是十分狡猾的生物：斯芬克斯的五个回答中可能有一个是彻头彻尾的假话，并且你不知道是哪一个。\n\n写一个程序和斯芬克斯交流，询问五个问题，并解开这个谜语。\n\n### 交互过程\n\n恰好有五轮提问过程。每轮提问中，你必须首先输出一行用空格隔开的三个整数 $a,b$ 和 $c$（$0\\le a,b,c\\le 10$），表示你的问题：「$a$ 只格里芬，$b$ 只巴西利斯克和 $c$ 只半人马一共有几条腿？」在问题问完后，标准输入中会出现一行一个整数 $r$（$0\\le r\\le 10^5$），表示斯芬克斯对你的问题的回答。\n\n> 特别提示：对于每行输出，你必须输出换行（`\\n`），并刷新缓冲区。\n\n在五次提问结束后，输出一行三个被空格隔开的非负整数 $\\ell_a,\\ell_b$ 和 $\\ell_c$，表示一只格里芬，一只巴西利克斯和一只半人马分别有多少条腿。\n\n### 样例交互 1\n\n| 标准输入 | 标准输出 |\n| :------: | :------: |\n|          | `1 1 1`  |\n|   `12`   |          |\n|          | `1 1 1`  |\n|   `13`   |          |\n|          | `5 0 1`  |\n|   `24`   |          |\n|          | `1 0 0`  |\n|   `4`    |          |\n|          | `1 1 0`  |\n|   `8`    |          |\n|          | `4 4 4`  |\n\n### 样例交互 2\n\n| 标准输入 |  标准输出   |\n| :------: | :---------: |\n|          |   `4 4 4`   |\n|  `2023`  |             |\n|          |   `1 0 0`   |\n|   `0`    |             |\n|          |   `0 1 0`   |\n|   `42`   |             |\n|          |   `0 0 1`   |\n|  `2024`  |             |\n|          |   `0 0 0`   |\n|   `0`    |             |\n|          | `0 42 2024` |\n\n", "inputFormat": "", "outputFormat": "", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12296", "type": "P", "difficulty": 6, "samples": [["2 6\n", "4\n11\n12\n21\n22\n11\n12\n"], ["2 1\n", "infinity\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2023", "ICPC", "WF"], "title": "[ICPC 2023 WF] Schedule", "background": "", "description": "The Institute for Creative Product Combinations (ICPC) tries to find unusual and innovative ways to unite seemingly unrelated products or technologies, opening up new markets and creating new jobs. (For instance, their most recent success was the \"hairbachi,\" a hair-dryer with a hibachi grill top attachment for preparing on-the-go hot meals.) The company employs $n$ teams of size $2$ to research individual products, then members of the different teams get together to explore ways of combining products.\n\nDuring the pandemic, the ICPC management organized everyone's schedule in such a way that there were never more than $n$ people in the office at the same time, and things ran so smoothly that they continued the process once things began to return to normal. Here is the scheme they used. Label the teams with integers $1$ through $n$ and the two people on the $i^\\text{th}$ team as $(i, 1)$ and $(i, 2)$ for each $i$ from $1$ to $n$. Each week, exactly one person from each team is allowed in the office, while the other has to stay away. The employees $(i, 1)$ and $(i, 2)$ know each other well and collaborate productively regardless of being isolated from each other, so members of the same team do not need to meet in person in the office. However, isolation between members from different teams is still a concern.\n\nEach pair of teams $i$ and $j$ for $i \\neq j$ has to collaborate occasionally. For a given number $w$ of weeks and for fixed team members $(i, a)$ and $(j, b)$, let $w_1 < w_2 < \\ldots < w_k$ be the weeks in which these two team members meet in the office. The isolation of those two people is the maximum of\n\n$$\n\\{w_1,w_2-w_1,w_3-w_2,\\ldots,w_k-w_{k-1},w+1-w_k\\}\n$$\n\nor infinity if those two people never meet. The isolation of the whole company is the maximum isolation across all choices of $i$, $j$, $a$, and $b$.\n\nYou have been tasked to find a weekly schedule that minimizes the isolation of the whole company over a given number $w$ of weeks.", "inputFormat": "The input consists of a single line containing two integers $n$ ($2 \\le n \\le 10^4$) and $w$ ($1 \\le w \\le 52$), where $n$ is the number of teams and $w$ is the number of weeks that need to be scheduled.", "outputFormat": "Output a line containing either an integer representing the minimum isolation achievable for $n$ teams or the word `infinity` if no schedule guarantees that every pair of individuals on different teams can meet. If the isolation is finite, it is followed by $w$ lines representing a schedule that achieves this isolation. The $j^\\text{th}$ line of the schedule is a string of length $n$ containing only the symbols `1` and `2`, where the $i^\\text{th}$ symbol indicates which of the two members from team $i$ comes into the office on week $j$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2023 WF] Schedule", "background": "", "description": "The Institute for Creative Product Combinations (ICPC) tries to find unusual and innovative ways to unite seemingly unrelated products or technologies, opening up new markets and creating new jobs. (For instance, their most recent success was the \"hairbachi,\" a hair-dryer with a hibachi grill top attachment for preparing on-the-go hot meals.) The company employs $n$ teams of size $2$ to research individual products, then members of the different teams get together to explore ways of combining products.\n\nDuring the pandemic, the ICPC management organized everyone's schedule in such a way that there were never more than $n$ people in the office at the same time, and things ran so smoothly that they continued the process once things began to return to normal. Here is the scheme they used. Label the teams with integers $1$ through $n$ and the two people on the $i^\\text{th}$ team as $(i, 1)$ and $(i, 2)$ for each $i$ from $1$ to $n$. Each week, exactly one person from each team is allowed in the office, while the other has to stay away. The employees $(i, 1)$ and $(i, 2)$ know each other well and collaborate productively regardless of being isolated from each other, so members of the same team do not need to meet in person in the office. However, isolation between members from different teams is still a concern.\n\nEach pair of teams $i$ and $j$ for $i \\neq j$ has to collaborate occasionally. For a given number $w$ of weeks and for fixed team members $(i, a)$ and $(j, b)$, let $w_1 < w_2 < \\ldots < w_k$ be the weeks in which these two team members meet in the office. The isolation of those two people is the maximum of\n\n$$\n\\{w_1,w_2-w_1,w_3-w_2,\\ldots,w_k-w_{k-1},w+1-w_k\\}\n$$\n\nor infinity if those two people never meet. The isolation of the whole company is the maximum isolation across all choices of $i$, $j$, $a$, and $b$.\n\nYou have been tasked to find a weekly schedule that minimizes the isolation of the whole company over a given number $w$ of weeks.", "inputFormat": "The input consists of a single line containing two integers $n$ ($2 \\le n \\le 10^4$) and $w$ ($1 \\le w \\le 52$), where $n$ is the number of teams and $w$ is the number of weeks that need to be scheduled.", "outputFormat": "Output a line containing either an integer representing the minimum isolation achievable for $n$ teams or the word `infinity` if no schedule guarantees that every pair of individuals on different teams can meet. If the isolation is finite, it is followed by $w$ lines representing a schedule that achieves this isolation. The $j^\\text{th}$ line of the schedule is a string of length $n$ containing only the symbols `1` and `2`, where the $i^\\text{th}$ symbol indicates which of the two members from team $i$ comes into the office on week $j$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2023 WF] 日程", "background": "", "description": "创意产品组合学院（*The Institute for Creative Product Combinations*, ICPC）致力于寻找不同寻常的创新方法，将看似毫不相干的产品或技术结合起来，从而开拓新的市场，创造新的就业机会。（例如，他们最近成功的产品是「火盆电吹风」，这是一种带有炭烤火盆的吹风机，可以随时随地制作热餐。）这个公司雇佣了 $n$ 个大小为 $2$ 的团队来研发各自的产品，然后不同团队的成员聚集起来共同探索组合产品的方式。\n\n疫情期间，ICPC 的管理层合理安排了每个人的日程，使办公室里从来没有同时出现过超过 $n$ 人的情况。安排进行地十分顺利，以至于疫情结束后他们仍继续着这样的工作模式。下面是他们使用的安排计划。将团队用 $1$ 到 $n$ 的正整数编号，第 $i$ 个团队的两个人编号为 $(i,1)$ 和 $(i,2)$。每周内，每队只有一人允许进入办公室，另一个人不得不离开。员工 $(i,1)$ 和 $(i,2)$ 彼此熟识，并且可以在远离对方的情况下通力协作，所以相同团队的成员不需要到办公室见面。然而，不同团队成员的隔离仍是一个问题。\n\n对于 $i\\neq j$ 的每对团队 $i$ 和 $j$ 需要偶尔合作。对于给定的周数 $w$ 和固定的团队成员 $(i,a)$ 与 $(j,b)$，令 $w_1<w_2<\\ldots<w_k$ 为这两个成员在办公室见面的周。这两个人疏远度是下列数组元素的最大值\n$$\n\\{w_1,w_2-w_1,w_3-w_2,\\ldots,w_k-w_{k-1},w+1-w_k\\}\n$$\n如果两人从不见面，则疏远度为无穷。整个公司的疏远度是对于 $i,j,a,b$ 所有取值的疏远度的最大值。\n\n你需要规划一个每周日程，对于给定的周数 $w$，你需要最小化整个公司的疏远度。", "inputFormat": "输入包含一行两个整数 $n$（$2\\le n\\le 10^4$）和 $w$（$1\\le w\\le 52$），$n$ 为团队数，$w$ 是需要规划日程的周数。", "outputFormat": "如果不存在一种日程，满足不同团队的每对人员可以见面，输出一行 `infinity`，否则输出一个整数，表示可以达到的最小疏远度。如果最小疏远度是有限的，接下来输出 $w$ 行，表示能达到这个疏远度的日程安排。第 $j$ 行输出只由 `1` 和 `2` 组成且长为 $n$ 的字符串，第 $i$ 个字符表示团队 $i$ 在第 $j$ 周到办公室的成员。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12297", "type": "P", "difficulty": 6, "samples": [["6 1 1 6 6 8 8\n3 2 4 9\n", "0.291666667 0.750000000\n"], ["4 9 3 7 5\n3 4 2 3\n", "0.500000000 0.500000000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2022", "2023", "Special Judge", "ICPC", "WF"], "title": "[ICPC 2022/2023 WF] Three Kinds of Dice", "background": "", "description": "See how they roll! According to a famous story, Warren Buffett once challenged Bill Gates to a simple game of dice. He had three dice; the first player could examine them and choose one of the three. The second player would then choose one of the remaining dice, and both players would roll their dice against each other, aiming for the highest numbers. Warren offered to let Bill go first, but this made Bill suspicious so he opted to go second. It turned out to be a wise choice: these were *intransitive dice*. The first die had an advantage when rolling against the second, the second had an advantage when rolling against the third, but the first did not have an advantage when rolling against the third!\n\nTo formalize this: define a \"die\" as any shape with at least one face such that each face shows a positive integer. When a die is rolled, one of its faces is selected uniformly at random. When two dice roll against each other, the die whose selected face shows a higher number earns $1$ point; if both numbers are equal, each die earns $\\frac{1}{2}$ points. For dice $D$ and $D'$, define $score(D, D')$ as the expected number of points $D$ earns from a single roll against $D'$. If $score(D, D') > \\frac{1}{2}$, we say that $D$ has an advantage over $D'$; if $score(D, D') = \\frac{1}{2}$, the two dice are tied. For example, if $D$ is the first die in the sample input and $D'$ is the second, $score(D, D') = \\frac{4}{9}$ and $score(D', D) = \\frac{5}{9}$, so $D'$ has an advantage over $D$.\n\nGiven two dice $D_1$ and $D_2$ such that $D_1$ has an advantage over $D_2$, you want a third die $D_3$ that forms an intransitive trio with the other two. Among all $D_3$ that have an advantage over or tie with $D_1$, compute the lowest possible $score(D_3, D_2)$. If this is less than $\\frac{1}{2}$, you can make an intransitive trio! Similarly, among all $D_3$ such that $D_2$ has an advantage over or ties with $D_3$, compute the highest possible $score(D_3, D_1)$.", "inputFormat": "The input contains two lines, each describing one die. One of the dice (the first or the second) has an advantage over the other. The die with the advantage is $D_1$ and the other is $D_2$.\n\nThe first integer on a line gives $n$ ($1 \\le n \\le 10^5$), the number of faces on the die. Then follow $n$ integers $f_i$ ($1 \\le f_i \\le 10^9$ for each $1 \\le i \\le n$), giving the integer on each face.", "outputFormat": "Output one line containing the lowest $score(D_3, D_2)$ and the highest $score(D_3, D_1)$ under the above conditions. The two scores do not need to use the same die $D_3$. Your answer should have an absolute error of at most $10^{-6}$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2022/2023 WF] Three Kinds of Dice", "background": "", "description": "See how they roll! According to a famous story, Warren Buffett once challenged Bill Gates to a simple game of dice. He had three dice; the first player could examine them and choose one of the three. The second player would then choose one of the remaining dice, and both players would roll their dice against each other, aiming for the highest numbers. Warren offered to let Bill go first, but this made Bill suspicious so he opted to go second. It turned out to be a wise choice: these were *intransitive dice*. The first die had an advantage when rolling against the second, the second had an advantage when rolling against the third, but the first did not have an advantage when rolling against the third!\n\nTo formalize this: define a \"die\" as any shape with at least one face such that each face shows a positive integer. When a die is rolled, one of its faces is selected uniformly at random. When two dice roll against each other, the die whose selected face shows a higher number earns $1$ point; if both numbers are equal, each die earns $\\frac{1}{2}$ points. For dice $D$ and $D'$, define $score(D, D')$ as the expected number of points $D$ earns from a single roll against $D'$. If $score(D, D') > \\frac{1}{2}$, we say that $D$ has an advantage over $D'$; if $score(D, D') = \\frac{1}{2}$, the two dice are tied. For example, if $D$ is the first die in the sample input and $D'$ is the second, $score(D, D') = \\frac{4}{9}$ and $score(D', D) = \\frac{5}{9}$, so $D'$ has an advantage over $D$.\n\nGiven two dice $D_1$ and $D_2$ such that $D_1$ has an advantage over $D_2$, you want a third die $D_3$ that forms an intransitive trio with the other two. Among all $D_3$ that have an advantage over or tie with $D_1$, compute the lowest possible $score(D_3, D_2)$. If this is less than $\\frac{1}{2}$, you can make an intransitive trio! Similarly, among all $D_3$ such that $D_2$ has an advantage over or ties with $D_3$, compute the highest possible $score(D_3, D_1)$.", "inputFormat": "The input contains two lines, each describing one die. One of the dice (the first or the second) has an advantage over the other. The die with the advantage is $D_1$ and the other is $D_2$.\n\nThe first integer on a line gives $n$ ($1 \\le n \\le 10^5$), the number of faces on the die. Then follow $n$ integers $f_i$ ($1 \\le f_i \\le 10^9$ for each $1 \\le i \\le n$), giving the integer on each face.", "outputFormat": "Output one line containing the lowest $score(D_3, D_2)$ and the highest $score(D_3, D_1)$ under the above conditions. The two scores do not need to use the same die $D_3$. Your answer should have an absolute error of at most $10^{-6}$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022/2023 WF] 三种骰子", "background": null, "description": "看看他们是如何掷骰子的！有一个著名的故事，沃伦·巴菲特曾经挑战比尔·盖茨玩一个简单的掷骰子游戏。他有三颗骰子，第一位玩家可以检查这三颗骰子并从中选择一颗。然后，第二位玩家从剩下的骰子中选择一个，然后双方分别掷骰子，目标是掷出最大的数字。沃伦提出让比尔先来，但这让比尔起了疑心，于是他选择了后选。事实证明，这是一个明智的选择：这些骰子是**非传递性骰子**。第一个骰子在与第二个骰子对掷时有优势，第二个骰子在与第三个骰子对掷时有优势，但第一个骰子在与第三个骰子对掷时没有优势！\n\n为了形式化说明这个现象：定义「多面骰子」为至少有一个面的任意形状，满足每个面上都有一个正整数。当一个多面骰子掷出后，朝上的面均匀随机选取。当两个骰子对掷时，朝上的面上的数更大的一方获得一分；如果两个数相等，每个骰子获得 $\\frac{1}{2}$ 分。对于骰子 $D$ 和 $D'$，定义 $score(D,D')$ 为 $D$ 与 $D'$ 对掷时 $D$ 的期望得分。如果 $score(D,D')>\\frac{1}{2}$，我们称 $D$ 较 $D'$ 有优势；如果 $score(D,D')=\\frac{1}{2}$，那么两个骰子达成平局。例如，如果 $D$ 是样例输入中的第一个骰子，$D'$ 为第二个，$score(D,D')=\\frac{4}{9}$ 且 $score(D',D)=\\frac{5}{9}$，因此 $D'$ 较 $D$ 有优势。\n\n给定两个骰子 $D_1$ 和 $D_2$，且 $D_1$ 较 $D_2$ 有优势，你想要第三个骰子 $D_3$ 与前两个骰子形成一个非传递性骰子三元组。在所有较 $D_1$ 有优势或达成平局的 $D_3$ 中，计算最小可能的 $score(D_3,D_2)$。如果这个值小于 $\\frac{1}{2}$，你就可以达成非传递性骰子三元组的情况了！类似地，在所有满足 $D_2$ 较 $D_3$ 有优势或达成平局的 $D_3$ 中，计算最大可能的 $score(D_3,D_1)$。", "inputFormat": "输入包含两行，每行描述一个多面骰子。其中一个骰子（第一或第二个）较另一个骰子有优势。有优势的骰子为 $D_1$，另一个是 $D_2$。\n\n每行第一个整数为 $n$（$1\\le n\\le 10^5$），表示骰子的面数。接下来 $n$ 个整数 $f_i$（对于 $1\\le i\\le n$，$1\\le f_i\\le 10^9$），给定每个面上的整数。", "outputFormat": "输出一行两个实数，表示满足上述条件下最小的 $score(D_3,D_2)$ 和最大的 $score(D_3,D_1)$。达成两个分数时不需要使用相同的 $D_3$。你的输出与答案之间的绝对误差最大应为 $10^{-6}$。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P12298", "type": "P", "difficulty": 6, "samples": [["0 0 10 0 4\n9 18 34 26 42\n", "60.866649532\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["计算几何", "2022", "2023", "三分", "Special Judge", "ICPC", "WF"], "title": "[ICPC 2022/2023 WF] Carl’s Vacation", "background": "", "description": "Carl the ant is back! After traversing meandering paths (Problem A, 2004 World Finals) and wandering over octahedrons (Problem C, 2009 World Finals) it is time for a little vacation — time to see the sights! And where better to see the sights than at the tips of tall structures like, say, pyramids!! And where better to see tall pyramids but Egypt!!! (This is so exciting!!!!!)\n\nAfter taking in the view from the tip of one pyramid, Carl would like to go to the tip of another. Since ants do not do particularly well in the hot sun, he wants to find the minimum distance to travel between the tips of these two pyramids, assuming he can only walk on the surfaces of the pyramids and the plane which the pyramids sit upon. The pyramids are, geometrically, right square pyramids, meaning the apex of the pyramid lies directly above the center of a square base.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t5j6zy9j.png)\n\nIllustration of two pyramids corresponding to Sample Input 1. The black line shows the shortest path between their apexes.", "inputFormat": "The first line of input contains five integers $x_1, y_1, x_2, y_2, h$ where $x_1, y_1, x_2, y_2$ ($-10^5 \\le x_1, x_2, y_1, y_2 \\le 10^5$ and $(x_1, y_1) \\neq (x_2, y_2)$) define an edge of the first pyramid, with the body of the pyramid lying to the left of the directed vector from $(x_1, y_1)$ to $(x_2, y_2)$, and $h$ ($1 \\le h \\le 10^5$) is the height of the pyramid. The second line of input describes the second pyramid in the same format. The intersection of the bases of the two pyramids has $0$ area.", "outputFormat": "Output the minimum distance Carl travels between the tips of the two pyramids. Your answer should have an absolute or relative error of at most $10^{-6}$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2022/2023 WF] Carl’s Vacation", "background": "", "description": "Carl the ant is back! After traversing meandering paths (Problem A, 2004 World Finals) and wandering over octahedrons (Problem C, 2009 World Finals) it is time for a little vacation — time to see the sights! And where better to see the sights than at the tips of tall structures like, say, pyramids!! And where better to see tall pyramids but Egypt!!! (This is so exciting!!!!!)\n\nAfter taking in the view from the tip of one pyramid, Carl would like to go to the tip of another. Since ants do not do particularly well in the hot sun, he wants to find the minimum distance to travel between the tips of these two pyramids, assuming he can only walk on the surfaces of the pyramids and the plane which the pyramids sit upon. The pyramids are, geometrically, right square pyramids, meaning the apex of the pyramid lies directly above the center of a square base.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t5j6zy9j.png)\n\nIllustration of two pyramids corresponding to Sample Input 1. The black line shows the shortest path between their apexes.", "inputFormat": "The first line of input contains five integers $x_1, y_1, x_2, y_2, h$ where $x_1, y_1, x_2, y_2$ ($-10^5 \\le x_1, x_2, y_1, y_2 \\le 10^5$ and $(x_1, y_1) \\neq (x_2, y_2)$) define an edge of the first pyramid, with the body of the pyramid lying to the left of the directed vector from $(x_1, y_1)$ to $(x_2, y_2)$, and $h$ ($1 \\le h \\le 10^5$) is the height of the pyramid. The second line of input describes the second pyramid in the same format. The intersection of the bases of the two pyramids has $0$ area.", "outputFormat": "Output the minimum distance Carl travels between the tips of the two pyramids. Your answer should have an absolute or relative error of at most $10^{-6}$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022/2023 WF] Carl 的假期", "background": "", "description": "蚂蚁 Carl 回来了！在走过蜿蜒曲折的小路（ICPC World Finals 2004. A.）和八面体上（ICPC World Finals 2009. C.）之后，是时候给自己放个小假——来看看风景了！还有什么地方比金字塔等高大建筑的顶端更适合观赏风景呢？要看高大的金字塔，除了埃及，还有哪里更好呢！！！（这太令人兴奋了！！！！！）\n\n在一座金字塔尖看完风景后，Carl 想要去另一个金字塔尖。由于蚂蚁不善于应对烈日环境，他想找到从这座金字塔尖到另一座金字塔尖之间的最短距离，假设他只能在金字塔的表面和金字塔所在的平面上行走。从几何学上说，金字塔是正四棱锥，即金字塔的顶点位于正方形底面中心的正上方。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t5j6zy9j.png)\n\n样例一的图示。黑色线段表示两座金字塔的塔尖之间的最短路径。", "inputFormat": "第一行包含五个整数 $x_1,y_1,x_2,y_2,h$，其中 $x_1,y_1,x_2,y_2$（$-10^5\\le x_1,x_2,y_1,y_2$ 且 $(x_1,y_1)\\neq (x_2,y_2)$）定义了第一座金字塔的一条棱，金字塔的主体位于从 $(x_1,y_1)$ 指向 $(x_2,y_2)$ 的向量的左边，$h$（$1\\le h\\le 10^5$）表示金字塔的高度。\n\n第二行按相同的格式描述第二座金字塔。两座金字塔底面的交集面积为 $0$。", "outputFormat": "输出 Carl 从第一座金字塔尖到第二座金字塔尖之间的最短距离。你的输出与答案之间的绝对误差或相对误差最大应为 $10^{-6}$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12299", "type": "P", "difficulty": 7, "samples": [["3\n", "2\n1 1\n1 1\n2 3 5 8 13 21 34 55 89 144\n"], ["1235\n", "4\n1 1 3 1\n3 2 1 1\n9 15 44 99 255 611 1519 3706 9129 22377\n"]], "limits": {"time": [20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2023", "ICPC", "WF"], "title": "[ICPC 2023 WF] A Recurring Problem", "background": "", "description": "You have a very big problem! You love recurrence relations, perhaps a bit too much. In particular, you are a fan of positive linear recurrence relations (PLRR), which can be defined as follows. First, you choose the order $k$ of the relation. Then you choose coefficients $c_1, c_2, \\ldots , c_k$, and the first $k$ elements of a sequence $a_1, a_2, \\ldots , a_k$. The relation is called \"positive\" if all of these numbers are positive integers. The rest of the sequence can then be generated indefinitely using the formula\n\n$$\na_{i+k}=c_1\\cdot a_i+c_2\\cdot a_{i+1}+\\ldots+c_k\\cdot a_{i+k-1} \\quad \\text{for} \\quad i\\ge 1\n$$\n\nThe Fibonacci sequence is the most famous recurrence of this form, but there are many others.\n\nIn fact, yesterday, in a fit of mad mathematical inspiration, you wrote down *all* possible ways of choosing a positive linear recurrence relation, and each associated infinite sequence, on some index cards, one per card. (You have a lot of index cards; you buy in bulk.) It has all been a bit of a blur. But when you woke up today, you realized that you do not have a good way to order or count the PLRRs. You tried just sorting the sequences lexicographically, but there are too many that start with \"$1$\" — you will never make it to the later ones.\n\nFortunately, inspiration struck again! You realized that you can instead order the PLRRs lexicographically by the generated part of the sequence only (that is, the part of the sequence starting after the initial $k$ values). Ties are broken by lexicographic order of the coefficients. For example $k = 1, c_1 = 2, a_1 = 2$ comes before $k = 2, (c_1, c_2) = (2, 1), (a_1, a_2) = (1, 2)$, even though the continuation of the sequence is the same for both. This allows you to properly index your cards, starting from $1$, with every card being assigned a number.\n\nGiven the number on a card, describe the sequence on it!", "inputFormat": "The input consists of a single line with an integer $n$ ($1 \\le n \\le 10^9$), the index of the desired PLRR.", "outputFormat": "Output four lines detailing the desired recurrence relation. The first line contains its order $k$. The second line contains the $k$ coefficients $c_1, c_2, \\ldots , c_k$. The third line contains the $k$ starting values $a_1, a_2, \\ldots , a_k$. The fourth line contains the first $10$ of the generated values.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2023 WF] A Recurring Problem", "background": "", "description": "You have a very big problem! You love recurrence relations, perhaps a bit too much. In particular, you are a fan of positive linear recurrence relations (PLRR), which can be defined as follows. First, you choose the order $k$ of the relation. Then you choose coefficients $c_1, c_2, \\ldots , c_k$, and the first $k$ elements of a sequence $a_1, a_2, \\ldots , a_k$. The relation is called \"positive\" if all of these numbers are positive integers. The rest of the sequence can then be generated indefinitely using the formula\n\n$$\na_{i+k}=c_1\\cdot a_i+c_2\\cdot a_{i+1}+\\ldots+c_k\\cdot a_{i+k-1} \\quad \\text{for} \\quad i\\ge 1\n$$\n\nThe Fibonacci sequence is the most famous recurrence of this form, but there are many others.\n\nIn fact, yesterday, in a fit of mad mathematical inspiration, you wrote down *all* possible ways of choosing a positive linear recurrence relation, and each associated infinite sequence, on some index cards, one per card. (You have a lot of index cards; you buy in bulk.) It has all been a bit of a blur. But when you woke up today, you realized that you do not have a good way to order or count the PLRRs. You tried just sorting the sequences lexicographically, but there are too many that start with \"$1$\" — you will never make it to the later ones.\n\nFortunately, inspiration struck again! You realized that you can instead order the PLRRs lexicographically by the generated part of the sequence only (that is, the part of the sequence starting after the initial $k$ values). Ties are broken by lexicographic order of the coefficients. For example $k = 1, c_1 = 2, a_1 = 2$ comes before $k = 2, (c_1, c_2) = (2, 1), (a_1, a_2) = (1, 2)$, even though the continuation of the sequence is the same for both. This allows you to properly index your cards, starting from $1$, with every card being assigned a number.\n\nGiven the number on a card, describe the sequence on it!", "inputFormat": "The input consists of a single line with an integer $n$ ($1 \\le n \\le 10^9$), the index of the desired PLRR.", "outputFormat": "Output four lines detailing the desired recurrence relation. The first line contains its order $k$. The second line contains the $k$ coefficients $c_1, c_2, \\ldots , c_k$. The third line contains the $k$ starting values $a_1, a_2, \\ldots , a_k$. The fourth line contains the first $10$ of the generated values.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2023 WF] 一个递推问题", "background": "", "description": "你有一个大问题！你可能过于喜欢递推关系了。实际上，你十分喜欢正线性递推关系（*positive linear recurrence relations*, PLRR），可以按如下方式定义。首先选取关系的阶数 $k$。然后选取系数 $c_1,c_2,\\ldots,c_k$ 和序列的前 $k$ 个元素 $a_1,a_2,\\ldots,a_k$。如果所有这些数都是正整数，则这个关系被称为「正」的。序列的其余部分可以用如下公式无限生成\n$$\na_{i+k}=c_1\\cdot a_i+c_2\\cdot a_{i+1}+\\ldots+c_k\\cdot a_{i+k-1} \\quad \\text{for} \\quad i\\ge 1\n$$\nFibonacci 数列是这种形式的最有名的递推数列，但是还有其他很多。\n\n事实上，昨天你数学灵感乍现，在一些卡片上写下了**所有**可能的正线性递推关系，以及每个关系对应的无穷序列，每张卡片写了一个。（你有很多卡片；成批买的）这一切都有点模糊。但是当你今天醒来的时候，你意识到你没有一个好的方法来对 PLRR 进行排序或计数。你试过按序列的字典序排序，但以 $1$ 开头的序列太多了，你永远也数不清后面的序列。\n\n幸运的是，灵感再次乍现！你们意识到，可以只按序列中生成的部分（即序列中从初始的 $k$ 个值之后开始的部分）的字典序顺序排列 PLRR。并用系数的字典序打破相等局面。例如，$k = 1,c_1 = 2,a_1 = 2$ 在 $k = 2, (c_1, c_2) = (2, 1),(a_1, a_2) = (1, 2)$ 之前，即使两者序列的生成部分相同。这样你就可以从 $1$ 开始，为每张卡片分配一个编号，从而正确地为卡片创建索引了。\n\n给定卡片的索引，请描述写在这张卡片上的序列！", "inputFormat": "输入包含一行一个整数 $n$（$1\\le n\\le 10^9$），表示要求的 PLRR 的编号。", "outputFormat": "输出四行，表示要求的递推关系。第一行包含它的阶数 $k$。第二行包含 $k$ 个系数 $c_1,\\ldots,c_k$。第三行包含 $k$ 个初始值 $a_1,\\ldots,a_k$。第四行包含前 $10$ 个生成值。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12300", "type": "P", "difficulty": 6, "samples": [["4 4\n.r..\nrgyb\n.b..\n.yr.\n\nyrbr\n..yr\n...g\n...b\n", "yes\n"], ["1 7\n....x..\n\n..x....\n", "no\n"], ["4 3\nyr.\n..b\nry.\nb..\n\n...\n..b\n.ry\nbyb", "no\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2023", "ICPC", "WF"], "title": "[ICPC 2023 WF] Tilting Tiles", "background": "", "description": "You found a weird puzzle in a box with old toys in your attic. The puzzle forms a rectangular grid board made of $h \\times w$ square cells. Some cells in that grid have a colored tile placed on them, as shown in Figure F.1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wwiv0grk.png)\n\nFigure F.1: Color tiles correspond to the starting arrangement in Sample Input 1.\n\nYou are not yet sure what the exact goal of this puzzle is, but you started examining possible ways of rearranging the tiles. Their arrangement can be manipulated by tilting the grid in one of the four cardinal directions: to your left, to your right, towards you, or away from you. Tilting causes all the tiles to slide in the respective direction until they are blocked either by the boundary or by another tile. Given a starting and ending arrangement, determine whether there exists some sequence of tilts that transforms the former into the latter. Figure F.2 illustrates tilting of the puzzle shown in Sample Input 1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yq2anvm9.png)\n\nFigure F.2: Solution to Sample Input 1.", "inputFormat": "The first line of input contains two integers $h$ and $w$ ($1 \\le h, w \\le 500$) representing the height and width of the grid. Then follow $h$ lines giving the starting arrangement from the top row to the bottom row. Each of these lines contains a string of length $w$ describing cells on the row from left to right. If a cell is empty, the corresponding character is a dot (`.`). If there is a tile, the color of that tile is given, denoted by a lowercase letter (`a-z`). Different letters represent different colors, and tiles of the same color cannot be distinguished.\n\nAfter the starting arrangement, there is one empty line and then follows a description of the ending arrangement, consisting of $h$ lines in the same format as for the starting arrangement.", "outputFormat": "Output `yes` if a sequence of tilts exists that transforms the starting arrangement to the ending arrangement, and `no` otherwise.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2023 WF] Tilting Tiles", "background": "", "description": "You found a weird puzzle in a box with old toys in your attic. The puzzle forms a rectangular grid board made of $h \\times w$ square cells. Some cells in that grid have a colored tile placed on them, as shown in Figure F.1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wwiv0grk.png)\n\nFigure F.1: Color tiles correspond to the starting arrangement in Sample Input 1.\n\nYou are not yet sure what the exact goal of this puzzle is, but you started examining possible ways of rearranging the tiles. Their arrangement can be manipulated by tilting the grid in one of the four cardinal directions: to your left, to your right, towards you, or away from you. Tilting causes all the tiles to slide in the respective direction until they are blocked either by the boundary or by another tile. Given a starting and ending arrangement, determine whether there exists some sequence of tilts that transforms the former into the latter. Figure F.2 illustrates tilting of the puzzle shown in Sample Input 1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yq2anvm9.png)\n\nFigure F.2: Solution to Sample Input 1.", "inputFormat": "The first line of input contains two integers $h$ and $w$ ($1 \\le h, w \\le 500$) representing the height and width of the grid. Then follow $h$ lines giving the starting arrangement from the top row to the bottom row. Each of these lines contains a string of length $w$ describing cells on the row from left to right. If a cell is empty, the corresponding character is a dot (`.`). If there is a tile, the color of that tile is given, denoted by a lowercase letter (`a-z`). Different letters represent different colors, and tiles of the same color cannot be distinguished.\n\nAfter the starting arrangement, there is one empty line and then follows a description of the ending arrangement, consisting of $h$ lines in the same format as for the starting arrangement.", "outputFormat": "Output `yes` if a sequence of tilts exists that transforms the starting arrangement to the ending arrangement, and `no` otherwise.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2023 WF] 倾斜方块", "background": "", "description": "你在阁楼上的一个旧玩具箱里发现了一个奇怪的玩具。这个玩具是一个由 $h \\times w$ 个正方形单元格组成的长方形网格板。如图 F.1 所示，网格中的一些单元格上放置了一块彩色方块。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wwiv0grk.png)\n\n图 F.1. 样例 1 中初始的彩色方块排布\n\n你还不确定这个玩具的确切目标是什么，但你已经开始研究重新排列方块的可能方法。可以通过将网格向左、向右、向着你或远离你的四个方向之一倾斜来实现让这些方块重排。倾斜会使所有方块向相应的方向滑动，直到被边界或其他方块挡住为止。给定一个起始和目标的方块排布，判断是否存在某种倾斜序列能将前者转化为后者。图 F.2 展示了样例 1 中所示玩具的倾斜过程。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6eusiqk7.png)\n\n图 F.2. 样例 1 的解", "inputFormat": "第一行输入包含两个整数 $h$ 和 $w$（$1 \\le h, w \\le 500$），分别代表网格的高度和宽度。随后的 $h$ 行给出了从第一行到最后一行的初始排布。每一行都包含一个长度为 $w$ 的字符串，从左到右描述该行的单元格。如果单元格是空的，对应的字符就是一个点（`.`）。如果有一个方块，则给出该方块的颜色，用小写字母（`a-z`）表示。不同的字母代表不同的颜色，相同颜色的方块无法区分。\n\n在初始排布之后是一个空行，然后是对目标排布的描述，由 $h$ 行组成，格式与初始排布相同。", "outputFormat": "如果存在将初始排布转换为目标排布的倾斜序列，则输出 `yes`，否则输出 `no`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12301", "type": "P", "difficulty": 4, "samples": [["8 6\nGBRBRRRG\n2 1 4\n1 2\n4 4 5 6 7\n3 5 6 7\n1 8\n1 8\n", "8\n"], ["4 3\nRGBR\n2 1 2\n2 2 3\n2 3 4\n", "impossible\n"], ["4 4\nGBRG\n2 1 2\n2 2 3\n2 3 4\n1 4\n", "6\n"], ["3 3\nRGB\n1 1\n1 2\n1 3\n", "3\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["图论", "2022", "2023", "ICPC", "WF"], "title": "[ICPC 2022/2023 WF] Turning Red", "background": "", "description": "Mei's parents have spent the last year remodeling their house, but their lighting system is quite complex! Each room in the house has an LED light, which can be set to red, green, or blue, as seen in Figure G.1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wjoki4ab.png)\n\nFigure G.1: The initial state of the lights in Sample Input 1. Buttons and wires not shown.\n\nThroughout the house are various buttons which are each connected to one or more lights. When a button is pressed, any red lights connected to that button become green, any green lights connected to that button become blue, and any blue lights connected to that button become red. Each button can be pressed multiple times. Because the house was built prior to the invention of crossbar wiring, each light is controlled by at most two buttons.\n\nMei's favorite color is red, so she wants to turn all of the lights red. Her parents, fearing the buttons will wear out, have asked her to minimize the total number of button presses.", "inputFormat": "The first line of input contains two positive integers $l$ and $b$, where $l$ ($1 \\le l \\le 2\\cdot 10^5$) is the number of lights and $b$ ($0 \\le b \\le 2\\cdot l$) is the number of buttons. The second line of input is a string of $l$ characters, all either `R`, `G`, or `B`, where the $i^\\text{th}$ character is the initial color of the $i^\\text{th}$ light. The next $b$ lines describe the buttons. Each of these lines begins with an integer $k$ ($1 \\le k \\le l$), the number of lights controlled by this button. Then $k$ distinct integers follow, the lights controlled by this button. The lights are indexed from $1$ to $l$, inclusive. Each light appears at most twice across all buttons.", "outputFormat": "Output the minimum number of button presses Mei needs to turn all the lights red. If it is impossible for Mei to turn all of the lights red, output `impossible`.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2022/2023 WF] Turning Red", "background": "", "description": "Mei's parents have spent the last year remodeling their house, but their lighting system is quite complex! Each room in the house has an LED light, which can be set to red, green, or blue, as seen in Figure G.1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wjoki4ab.png)\n\nFigure G.1: The initial state of the lights in Sample Input 1. Buttons and wires not shown.\n\nThroughout the house are various buttons which are each connected to one or more lights. When a button is pressed, any red lights connected to that button become green, any green lights connected to that button become blue, and any blue lights connected to that button become red. Each button can be pressed multiple times. Because the house was built prior to the invention of crossbar wiring, each light is controlled by at most two buttons.\n\nMei's favorite color is red, so she wants to turn all of the lights red. Her parents, fearing the buttons will wear out, have asked her to minimize the total number of button presses.", "inputFormat": "The first line of input contains two positive integers $l$ and $b$, where $l$ ($1 \\le l \\le 2\\cdot 10^5$) is the number of lights and $b$ ($0 \\le b \\le 2\\cdot l$) is the number of buttons. The second line of input is a string of $l$ characters, all either `R`, `G`, or `B`, where the $i^\\text{th}$ character is the initial color of the $i^\\text{th}$ light. The next $b$ lines describe the buttons. Each of these lines begins with an integer $k$ ($1 \\le k \\le l$), the number of lights controlled by this button. Then $k$ distinct integers follow, the lights controlled by this button. The lights are indexed from $1$ to $l$, inclusive. Each light appears at most twice across all buttons.", "outputFormat": "Output the minimum number of button presses Mei needs to turn all the lights red. If it is impossible for Mei to turn all of the lights red, output `impossible`.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022/2023 WF] 变成红灯", "background": "", "description": "Mei 的父母去年一年都在重新设计如何装修房子，但是他们的照明系统十分复杂！房子中每个房间都有一盏 LED 灯，灯可以设成红色，绿色或蓝色，如图 G.1 所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wjoki4ab.png)\n\n图 G.1. 样例 1 中灯的初始状态。按钮和导线没有画出。\n\n房子里到处都有各种按钮，每个按钮都与一盏或多盏灯相连。按下一个按钮后，与该按钮相连的红灯会变成绿灯，绿灯会变成蓝灯，蓝灯会变成红灯。每个按钮都可以多次按下。由于房屋建造于多路开关布线发明之前，每盏灯最多只由两个按钮控制。\n\nMei 最喜欢的颜色是红色，所以她想把所有的灯都变成红色。她的父母担心按钮会磨损，要求她尽量减少按下按钮的次数。", "inputFormat": "第一行两个整数 $l$ 和 $b$，其中 $l$（$1\\le l\\le 2\\cdot 10^5$）是灯的数量，$b$（$0\\le b\\le 2\\cdot l$）是按钮数量。输入第二行是一个长为 $l$ 的字符串，字符串中的字符是 `R`，`G`，`B` 中的一个，其中第 $i$ 个字符表示第 $i$ 盏灯的初始颜色。接下来 $b$ 行描述按钮。每行开始于一个整数 $k$（$1\\le k\\le l$），表示这个按钮控制的灯的数量。接下来 $k$ 个互不相同的整数，表示这个按钮控制的灯。灯从 $1$ 到 $l$ 编号（包括两端）。在所有按钮中，每盏灯最多出现两次。", "outputFormat": "输出 Mei 最少要按多少次按钮才能把所有灯变为红色。如果 Mei 不可能达成目标，输出 `impossible`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12302", "type": "P", "difficulty": 4, "samples": [["3\n30 45\n60 90\n120 180\n", "2\n0 30\n90 120\n"], ["1\n0 60\n", "impossible\n"], ["7\n31 32\n35 41\n48 55\n69 91\n1000 2022\n2022 2023\n2994 4096\n", "5\n0 5\n10 28\n56 68\n92 900\n2025 2900\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["贪心", "2023", "Special Judge", "ICPC", "线性 DP", "WF"], "title": "[ICPC 2023 WF] Jet Lag", "background": "", "description": "The ICPC World Finals are here and they are packed full of activities you want to attend — speeches, presentations, fun events, not to mention the contest itself. There is only one problem: when are you going to sleep?\n\nWhen you fall asleep, you always set a timer because otherwise you would be able to sleep forever. Using the timer, you can choose to sleep for any positive integer amount of minutes. After sleeping for $k$ minutes, you will be rested for another $k$ minutes (and so you will not be able to fall asleep again); and then you will be able to function for a third $k$ minutes (so you can stay awake, but you can also go to sleep if you want to).\n\nYou know the times of all the activities at the Finals; you should plan your sleep schedule to not miss any part of any event. Just before the Finals start (at minute $0$), you will arrive in your hotel room after a long journey and you will need to sleep immediately.", "inputFormat": "The first line of input contains a positive integer $n$ ($1 \\le n \\le 200\\, 000$), the number of activities planned for the Finals.\n\nThe $i^\\text{th}$ of the remaining $n$ lines contains two positive integers $b_i$ and $e_i$ ($b_i < e_i$, $e_i \\le b_{i+1}$, $0 \\le b_1, e_n \\le 10^{10}$), the beginning and end time of the activity, counted in minutes from the beginning of the Finals.", "outputFormat": "If it is possible to find a sleep schedule that allows you to participate in all planned activities in their entirety, then output such a schedule in the format described below. Otherwise, output `impossible`.\n\nA sleep schedule is specified by a line containing the number $p$ ($1 \\le p \\le 10^6$) of sleep periods, followed by $p$ lines. The $i^\\text{th}$ of these lines contains two integers $s_i$ and $t_i$ — the beginning and end time of the $i^\\text{th}$ sleep period, counted in minutes from the beginning of the Finals. Note that you should not output any sleep period after the last activity.\n\nThe sleep periods must satisfy $0 = s_1 < t_1 < s_2 < t_2 < \\ldots < t_p \\le b_n$ as well as the condition described in the statement that does not allow you to fall asleep for some time after a sleep period. You may fall asleep immediately after an activity (so it may be that $s_i = e_j$) and you may wake up just before an activity (so it may be that $t_i = b_j$).\n\nIf there are multiple valid sleep schedules, any one will be accepted. It can be shown that if there is a valid sleep schedule, then there is also one with at most $10^6$ sleep periods.", "hint": "If there's anything wrong with SPJ, contact @[StayAlone](https://www.luogu.com.cn/user/409236) please.", "locale": "en", "translations": {"en": {"title": "[ICPC 2023 WF] Jet Lag", "background": "", "description": "The ICPC World Finals are here and they are packed full of activities you want to attend — speeches, presentations, fun events, not to mention the contest itself. There is only one problem: when are you going to sleep?\n\nWhen you fall asleep, you always set a timer because otherwise you would be able to sleep forever. Using the timer, you can choose to sleep for any positive integer amount of minutes. After sleeping for $k$ minutes, you will be rested for another $k$ minutes (and so you will not be able to fall asleep again); and then you will be able to function for a third $k$ minutes (so you can stay awake, but you can also go to sleep if you want to).\n\nYou know the times of all the activities at the Finals; you should plan your sleep schedule to not miss any part of any event. Just before the Finals start (at minute $0$), you will arrive in your hotel room after a long journey and you will need to sleep immediately.", "inputFormat": "The first line of input contains a positive integer $n$ ($1 \\le n \\le 200\\, 000$), the number of activities planned for the Finals.\n\nThe $i^\\text{th}$ of the remaining $n$ lines contains two positive integers $b_i$ and $e_i$ ($b_i < e_i$, $e_i \\le b_{i+1}$, $0 \\le b_1, e_n \\le 10^{10}$), the beginning and end time of the activity, counted in minutes from the beginning of the Finals.", "outputFormat": "If it is possible to find a sleep schedule that allows you to participate in all planned activities in their entirety, then output such a schedule in the format described below. Otherwise, output `impossible`.\n\nA sleep schedule is specified by a line containing the number $p$ ($1 \\le p \\le 10^6$) of sleep periods, followed by $p$ lines. The $i^\\text{th}$ of these lines contains two integers $s_i$ and $t_i$ — the beginning and end time of the $i^\\text{th}$ sleep period, counted in minutes from the beginning of the Finals. Note that you should not output any sleep period after the last activity.\n\nThe sleep periods must satisfy $0 = s_1 < t_1 < s_2 < t_2 < \\ldots < t_p \\le b_n$ as well as the condition described in the statement that does not allow you to fall asleep for some time after a sleep period. You may fall asleep immediately after an activity (so it may be that $s_i = e_j$) and you may wake up just before an activity (so it may be that $t_i = b_j$).\n\nIf there are multiple valid sleep schedules, any one will be accepted. It can be shown that if there is a valid sleep schedule, then there is also one with at most $10^6$ sleep periods.", "hint": "If there's anything wrong with SPJ, contact @[StayAlone](https://www.luogu.com.cn/user/409236) please.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2023 WF] 时差", "background": "", "description": "ICPC World Finals 到了，其中有很多你想参加的活动——演讲、现场展示、趣味活动，更不用说比赛本身了。只有一个问题：你什么时候睡觉？\n\n当你入睡时，你总是会设置一个闹钟，否则你就可能一直睡下去。用了闹钟，你就可以选择睡任意正整数分钟。在睡 $k$ 分钟后，你会再休息 $k$ 分钟（因此你将无法再次入睡）；然后你将能够在第三个 $k$ 分钟内正常活动（因此你可以保持清醒，但如果你想睡觉，也可以直接睡）。\n\n你知道 WF 所有活动的时间；你应该计划好自己的睡眠时间，以免错过任何活动的任何部分。就在 WF 开始前（第 $0$ 分钟），你会经过长途旅行抵达酒店房间，需要立即入睡。", "inputFormat": "第一行包含一个正整数 $n$（$1\\le n\\le 200\\,000$），表示 WF 中活动的数量。\n\n接下来 $n$ 行，第 $i$ 行包含两个正整数 $b_i$ 和 $e_i$（$b_i<e_i$，$e_i\\le b_{i+1}$，$0\\le b_1,e_n\\le 10^{10}$），分别表示活动的开始和结束时间，按 WF 开始的时间计算，以分钟为单位。", "outputFormat": "如果可以规划一个睡眠时间表，使你能够完整地参加所有计划的活动，那么就按下列格式输出一个时间表。否则，输出 `impossible`。\n\n睡眠时间表由第一行输出的睡眠时段数 $p$（$1\\le p\\le 10^6$）和后面的 $p$ 行确定。其中第 $i$ 行包含两个整数 $s_i$ 和 $t_i$，即第 $i$ 个睡眠时段的开始和结束时间，从 WF 开始算起，以分钟为单位。注意不应输出在最后一个活动结束后的睡眠时段。\n\n睡眠时段必须满足 $0=s_1<t_1<s_2<t_2<\\ldots<t_p\\le b_n$ 和题目描述中不允许在醒来之后的某些时间内睡觉的条件。你可以在某个活动之后立刻睡觉（因此可能有 $s_i=e_j$）或者恰好在某个活动开始之前醒来（因此可能有 $t_i=b_j$）。\n\n如果有多个合法的睡眠时间表，那么输出任何一个都可以。可以证明，如果存在一个合法的睡眠时间表，那么也存在一个最多有 $10^6$ 个睡眠时段的合法睡眠时间表。", "hint": "如遇 SPJ 相关问题，请联系搬题人 @[StayAlone](https://www.luogu.com.cn/user/409236)。", "locale": "zh-CN"}}}
{"pid": "P12303", "type": "P", "difficulty": 6, "samples": [["3 7\n63 61 55 54 77 87 89\n73 60 38 5 16 56 91\n75 43 11 3 16 20 95\n", "51.809523810\n"], ["4 3\n10 10 10\n10 10 10\n10 10 10\n10 10 10\n", "10.000000000\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2023", "Special Judge", "ICPC", "WF"], "title": "[ICPC 2023 WF] Waterworld", "background": "", "description": "Thousands of planets outside the Solar System have been discovered in recent years. An important factor for potential life support is the availability of liquid water. Detecting water on faraway planets is not easy. For rotating planets, a brand-new technology using relativistic quantum-polarized spectroscopy can help. It works as follows (this is a simplified description as only three people on *this* planet understand how it really works).\n\nAssume the telescope shows the planet such that its rotating axis is vertical and its equator is horizontal. Only the vertical line at the center of the image (the line that covers the rotating axis) is analyzed, because it provides the highest resolution of the planet's surface.\n\nThe analysis proceeds in steps of $d$ degrees. In one step, data is aggregated while the planet rotates by $d$ degrees, so each step gives information about a slice of $d$ degrees of the planet's surface. The image is split into $n$ segments of equal height, which are analyzed separately. So the slice of $d$ degrees is partitioned into $n$ areas $A_1, \\ldots , A_n$. For each area $A_i$, image analysis produces a number that gives the percentage of $A_i$ covered by water. The areas $A_i$ for one step are highlighted in the diagram on the right.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/28osnoqb.png)\n\nYou may assume the planet's surface is a sphere. This means each area $A_2, \\ldots , A_{n-1}$ is a spherical quadrilateral: it has four vertices, two sides parallel to the equator (that is, in planes parallel to the equator's plane) and two sides on great circles through the planet's poles, where the great circles are $d$ degrees apart. At either pole, two of the four vertices collapse into the pole, so $A_1$ and $A_n$ are spherical triangles with only one side parallel to the equator. Due to the curvature of the surface, sides that are parallel to the equator are longer if they are closer to the equator, while sides on great circles are longer if they are closer to the poles.\n\nThe above process is repeated for the next $d$ degrees of rotation, and so on, a total number of $m$ times, until the whole surface of the planet has been covered (that is, $md = 360$ degrees). Your task is to compute the percentage of the planet's surface covered by water from the given data.", "inputFormat": "The first line of input contains the two integers $n$ and $m$ ($2 \\le n, m \\le 1000$). Each of the following $n$ lines contains $m$ integers $a_{i,j}$ ($0 \\le a_{i,j} \\le 100$ for $1 \\le i \\le n$ and $1 \\le j \\le m$). Each column of this matrix describes the measurements for a single step, that is, a rotation by $d$ degrees. The number $a_{i,j}$ is the percentage of area $A_i$ that is covered by water in the $j^\\text{th}$ step.", "outputFormat": "Output the percentage of the planet's surface covered by water. Your answer should have an absolute error of at most $10^{-6}$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2023 WF] Waterworld", "background": "", "description": "Thousands of planets outside the Solar System have been discovered in recent years. An important factor for potential life support is the availability of liquid water. Detecting water on faraway planets is not easy. For rotating planets, a brand-new technology using relativistic quantum-polarized spectroscopy can help. It works as follows (this is a simplified description as only three people on *this* planet understand how it really works).\n\nAssume the telescope shows the planet such that its rotating axis is vertical and its equator is horizontal. Only the vertical line at the center of the image (the line that covers the rotating axis) is analyzed, because it provides the highest resolution of the planet's surface.\n\nThe analysis proceeds in steps of $d$ degrees. In one step, data is aggregated while the planet rotates by $d$ degrees, so each step gives information about a slice of $d$ degrees of the planet's surface. The image is split into $n$ segments of equal height, which are analyzed separately. So the slice of $d$ degrees is partitioned into $n$ areas $A_1, \\ldots , A_n$. For each area $A_i$, image analysis produces a number that gives the percentage of $A_i$ covered by water. The areas $A_i$ for one step are highlighted in the diagram on the right.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/28osnoqb.png)\n\nYou may assume the planet's surface is a sphere. This means each area $A_2, \\ldots , A_{n-1}$ is a spherical quadrilateral: it has four vertices, two sides parallel to the equator (that is, in planes parallel to the equator's plane) and two sides on great circles through the planet's poles, where the great circles are $d$ degrees apart. At either pole, two of the four vertices collapse into the pole, so $A_1$ and $A_n$ are spherical triangles with only one side parallel to the equator. Due to the curvature of the surface, sides that are parallel to the equator are longer if they are closer to the equator, while sides on great circles are longer if they are closer to the poles.\n\nThe above process is repeated for the next $d$ degrees of rotation, and so on, a total number of $m$ times, until the whole surface of the planet has been covered (that is, $md = 360$ degrees). Your task is to compute the percentage of the planet's surface covered by water from the given data.", "inputFormat": "The first line of input contains the two integers $n$ and $m$ ($2 \\le n, m \\le 1000$). Each of the following $n$ lines contains $m$ integers $a_{i,j}$ ($0 \\le a_{i,j} \\le 100$ for $1 \\le i \\le n$ and $1 \\le j \\le m$). Each column of this matrix describes the measurements for a single step, that is, a rotation by $d$ degrees. The number $a_{i,j}$ is the percentage of area $A_i$ that is covered by water in the $j^\\text{th}$ step.", "outputFormat": "Output the percentage of the planet's surface covered by water. Your answer should have an absolute error of at most $10^{-6}$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2023 WF] 未来水世界", "background": "", "description": "近年来，人们在太阳系外发现了数千颗行星。支持潜在生命存在的一个重要因素是是否有液态水。探测遥远的行星上是否有水并不容易。对于旋转的行星，一种利用相对论量子偏振光谱学的全新技术可以提供帮助。它的工作原理如下（这是一个简化的描述，因为**这个**星球上只有三个人了解它的真正工作原理）。\n\n假设望远镜观察到的行星旋转轴是垂直的，赤道是水平的。我们只分析图像中心的垂直线（覆盖旋转轴的线），因为这条线上行星表面图像的分辨率最高。\n\n分析以 $d$ 度为一步进行。在一步中，行星旋转 $d$ 度时的数据被汇总，因此每一步都提供了行星表面 $d$ 度的切片信息。图像被分割成 $n$ 个等高的片段，分别进行分析。因此，$d$ 度的切片被划分为 $n$ 个区域 $A_1,\\ldots,A_n$。对于每个区域 $A_i$，分析图像得出一个数字，该数字表示 $A_i$ 被水覆盖的百分比。下图展示了一个步骤中的区域 $A_i$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/28osnoqb.png)\n\n你可以假设行星的表面是一个球面。这意味着区域 $A_2,\\ldots,A_{n-1}$ 都是球面四边形：它有四个顶点，两条边平行于赤道（即在平行于赤道平面的平面上），两条边在经过行星两极的大圆上，大圆之间相距 $d$ 度。在任一极点，四个顶点中有两个坍缩到极点，因此 $A_1$ 和 $A_n$ 是球面三角形，只有一条边与赤道平行。由于表面的曲率，平行于赤道的边越靠近赤道就越长，而大圆上的边越靠近两极就越长。\n\n在接下来的 $d$ 度旋转中重复上述过程，以此类推，总共重复 $m$ 次，直到覆盖整个行星表面（即 $md = 360^{\\circ}$）。你的任务是根据给定的数据计算水覆盖行星表面的百分比。", "inputFormat": "第一行输入包含两个整数 $n$ 和 $m$（$2 \\le n, m \\le 1000$）。接下来的 $n$ 行，每行包含 $m$ 个整数 $a_{i,j}$（$0 \\le a_{i,j} \\le 100,1 \\le i \\le n, 1 \\le j \\le m$）。该矩阵的每一列描述了一步的测量结果，即旋转 $d$ 度时的结果。数字 $a_{i,j}$ 是第 $j$ 步中水覆盖区域占 $A_i$ 面积的百分比。", "outputFormat": "输出行星表面被水覆盖面积占总面积的百分比。输出与答案之间的绝对误差不应超过 $10^{-6}$。", "hint": "", "locale": "zh-CN"}}}
