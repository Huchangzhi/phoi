{"pid": "P3108", "type": "P", "difficulty": 6, "samples": [["4 1 2 \n-2 1 \\ \n2 1 / \n2 2 \\ \n-2 2 / \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2014", "线段树", "USACO", "前缀和"], "title": "[USACO14OPEN] Cow Optics G", "background": null, "description": "农场主约翰的牛想在谷仓里面举办舞会，用激光灯来表演。但不幸的是唯一的激光灯离谷仓太远，并且搬不动，所以牛们想用镜子来反射激光，使得激光照到谷仓。\n\n激光的位置在 $(0,0)$，指向为北方（即 y 轴正方向），谷仓在位置 $(Bx,By)$。已经有 $N$ 头奶牛拿着镜子分散在农场的各个位置 $(1 \\le N \\le 100,000)$，镜子与原点之间的夹角为 45 度。例如一个这样（“\\”）的镜子可以把从下方射来的光线反射成向左的光线。\n\nBessie 在启动激光的前一刻意识到计划有缺陷，所以她自己又拿着一面镜子出去了，恰好使得激光照到谷仓。\n\n请计算 Bessie 可能站在的位置的总数。\n\n坐标范围：-1,000,000,000 到 1,000,000,000，数据保证初始时激光光束不会反射回 $(0,0)$ 位置。同一点上不可能有多头牛，Bessie 不能站在其他牛的位置。", "inputFormat": "第一行三个整数：$N$，$Bx$，$By$。\n\n第 $2∼N+1$行：每行两个整数表示牛的位置，一个字符（“/”或“\\\\”）表示镜子怎么放置的。", "outputFormat": "Bessie 所有可能站在的位置总数。", "hint": "样例中 Bessie 可能站在 $(0,1)$ 或者 $(0,2)$。\n\n感谢 @SystemLLH 提供翻译。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO14OPEN] Cow Optics G", "background": null, "description": "Farmer John's cows would like to host a dance party in their barn, complete with a laser light show. Unfortunately, the only working laser they have found is located far away from the barn and too heavy to move, so they plan to re-direct the laser light to the barn using a series of mirrors.\n\nThe layout of the farm has the laser at position $(0,0)$ pointing north (in the positive y direction), and the barn at $(Bx, By)$; we can think of both the laser and the barn as points in the 2D plane. There are already $N$ cows $(1 \\le N \\le 100,000)$ scattered throughout the farm holding mirrors that are aligned at angles of 45 degrees to the axes. For example, a mirror aligned like \\ will take a beam of light entering from below and reflect it to the left. We can also think of the mirrors as being located at points in the 2D plane.\n\nJust before pressing the big red button to activate the laser, Bessie noticed a major flaw in the plan: the laser cannot hit the barn with the mirrors in their current configuration! As a result, she plans to run out onto the field, and hold up one more mirror (placed once again at a 45 degree angle) in order to redirect the laser onto the barn. Please count the number of locations in the field where Bessie can stand to accomplish this goal.\n\nAll coordinates are integers between $-1,000,000,000$ and $1,000,000,000$. It is guaranteed that any mirrors to be placed will be in this range as well. The cows running the laser insist that the beam should never come back to $(0,0)$ after leaving this location (and with the mirrors in their initial configuration, it is guaranteed that this will not happen). No two cows occupy the same point in space, and Bessie cannot locate herself at the same position as an existing cow.", "inputFormat": "Line 1: The integers $N$, $Bx$, and $By$.\n\nLines 2...$N + 1$: Line $i+1$ describes the ith mirror with 3 elements: its $(x,y)$ location, and its orientation (either '\\\\' or '/').", "outputFormat": "where Bessie can stand to redirect the laser to the barn.", "hint": "A mirror at $(0,1)$ or $(0,2)$ placed in either direction would do the trick.", "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Cow Optics G", "background": null, "description": "农场主约翰的牛想在谷仓里面举办舞会，用激光灯来表演。但不幸的是唯一的激光灯离谷仓太远，并且搬不动，所以牛们想用镜子来反射激光，使得激光照到谷仓。\n\n激光的位置在 $(0,0)$，指向为北方（即 y 轴正方向），谷仓在位置 $(Bx,By)$。已经有 $N$ 头奶牛拿着镜子分散在农场的各个位置 $(1 \\le N \\le 100,000)$，镜子与原点之间的夹角为 45 度。例如一个这样（“\\”）的镜子可以把从下方射来的光线反射成向左的光线。\n\nBessie 在启动激光的前一刻意识到计划有缺陷，所以她自己又拿着一面镜子出去了，恰好使得激光照到谷仓。\n\n请计算 Bessie 可能站在的位置的总数。\n\n坐标范围：-1,000,000,000 到 1,000,000,000，数据保证初始时激光光束不会反射回 $(0,0)$ 位置。同一点上不可能有多头牛，Bessie 不能站在其他牛的位置。", "inputFormat": "第一行三个整数：$N$，$Bx$，$By$。\n\n第 $2∼N+1$行：每行两个整数表示牛的位置，一个字符（“/”或“\\\\”）表示镜子怎么放置的。", "outputFormat": "Bessie 所有可能站在的位置总数。", "hint": "样例中 Bessie 可能站在 $(0,1)$ 或者 $(0,2)$。\n\n感谢 @SystemLLH 提供翻译。", "locale": "zh-CN"}}}
{"pid": "P3109", "type": "P", "difficulty": 6, "samples": [["6 2 \n0 \n1 \n2 \n3 \n3 \n4 01234 \n5 91234 \n", "19 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2014", "线段树", "USACO", "树形 DP", "容斥原理", "字典树 Trie"], "title": "[USACO14OPEN] Code Breaking G", "background": null, "description": "有一棵 $N$ $(1 \\leq N \\leq 2\\times 10^4)$ 个节点的有根树，每个节点可以填 $0\\sim9$。\n\n有 $M$ $(1 \\leq M \\leq 5\\times 10^4)$ 个限制，限制了从 $X$ 开始往祖先跳的的包含 $X$ 的 $5$ 个节点（保证 $X$ 上面一定存在这样一条路径,也就是说 $X$ 的深度至少为 $5$），一定不是 $ABCDE$。\n\n请你求出，根据这 $M$ 个限制，共有多少种给这棵树全部填上数的方案一定是**不可能**的。", "inputFormat": "第 $1$ 行：两个用空格分隔的整数 $N$ 和 $M$。\n\n第 $2\\sim N$ 行：第 $i+1$ 行包含一个整数 $p_i$，表示树中节点 $i$ 的父节点，满足 $0\\leq p_i<i$。\n\n第 $N+1\\sim N+M$ 行：第 $N+i$ 行描述第 $i$ 个禁止出现的序列。该行包含用空格分隔的 $v_i$ 和 $s_i$，其中 $v_i$ 是该序列的起始节点，$s_i$ 是一个 $5$ 位字符串，已知从 $v_i$ 开始向上遍历树得到的 $5$ 个节点的数字序列，不能等于 $s_i$ 对应的序列。题目保证从 $v_i$ 向上至少有 $5$ 个节点。", "outputFormat": "一行一个整数，表示被排除的不合法配置数量，结果对 $1234567$ 取模。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": null, "background": null, "description": "The cows keep getting in trouble by taking rides on Farmer John's tractor, so he has hidden the keys to the tractor in a fancy new safe in his office. Undeterred, the cows have vowed to try and break into this safe.\n\nThe safe is protected by a rather complicated passcode system. The passcode entry system is arranged as a rooted tree of $N$ $(1 \\leq N \\leq 20,000)$ nodes, each of which requires a digit between $0$ and $9$. The nodes are indexed $0 \\dots N-1$.\n\nThe only information that the cows have is that certain sequences of length $5$ do not occur along particular paths upwards through the tree.\n\nGiven $M$ $(1 \\leq M \\leq 50,000)$ length-$5$ sequences, together with their starting nodes in the tree, help the cows figure out how many passcodes have been ruled out. You should compute your answer modulo $1234567$.", "inputFormat": "Line $1$: Two space-separated integers, $N$ and $M$.\n\nLines $2\\dots N$: Line $i+1$ contains a single integer $p(i)$, denoting the parent of node i in the tree $(0 \\leq p(i) < i)$.\n\nLines $N+1\\dots N+M$: Line $N+i$ describes the ith sequence known not to occur in the code.  The line will contain $v(i)$ and $s(i)$ separated by a space, where $v(i)$ is the starting node of the sequence, and $s(i)$ is a $5$-digit string known not to occur starting at $v(i)$ and proceeding upward in the tree. It is guaranteed that the root is at least $4$ steps upward from $v(i)$.", "outputFormat": "Line $1$: A single integer giving the number of ruled-out configurations,modulo $1234567$.", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Code Breaking G", "background": null, "description": "有一棵 $N$ $(1 \\leq N \\leq 2\\times 10^4)$ 个节点的有根树，每个节点可以填 $0\\sim9$。\n\n有 $M$ $(1 \\leq M \\leq 5\\times 10^4)$ 个限制，限制了从 $X$ 开始往祖先跳的的包含 $X$ 的 $5$ 个节点（保证 $X$ 上面一定存在这样一条路径,也就是说 $X$ 的深度至少为 $5$），一定不是 $ABCDE$。\n\n请你求出，根据这 $M$ 个限制，共有多少种给这棵树全部填上数的方案一定是**不可能**的。", "inputFormat": "第 $1$ 行：两个用空格分隔的整数 $N$ 和 $M$。\n\n第 $2\\sim N$ 行：第 $i+1$ 行包含一个整数 $p_i$，表示树中节点 $i$ 的父节点，满足 $0\\leq p_i<i$。\n\n第 $N+1\\sim N+M$ 行：第 $N+i$ 行描述第 $i$ 个禁止出现的序列。该行包含用空格分隔的 $v_i$ 和 $s_i$，其中 $v_i$ 是该序列的起始节点，$s_i$ 是一个 $5$ 位字符串，已知从 $v_i$ 开始向上遍历树得到的 $5$ 个节点的数字序列，不能等于 $s_i$ 对应的序列。题目保证从 $v_i$ 向上至少有 $5$ 个节点。", "outputFormat": "一行一个整数，表示被排除的不合法配置数量，结果对 $1234567$ 取模。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3110", "type": "P", "difficulty": 3, "samples": [["4 4 5 8 8 \n1 4 \n2 3 \n3 4 \n4 7 \n2 5 \n5 6 \n6 8 \n7 8 ", "22 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO", "广度优先搜索 BFS", "最短路"], "title": "[USACO14DEC] Piggy Back S", "background": "", "description": "Bessie and her sister Elsie graze in different fields during the day, and in the evening they both want to walk back to the barn to rest. Being clever bovines, they come up with a plan to minimize the total amount of energy they both spend while walking.\n\nBessie spends B units of energy when walking from a field to an adjacent field, and Elsie spends E units of energy when she walks to an adjacent field.  However, if Bessie and Elsie are together in the same field, Bessie can carry Elsie on her shoulders and both can move to an adjacent field while spending only P units of energy (where P might be considerably less than B+E, the amount Bessie and Elsie would have spent individually walking to the adjacent field).  If P is very small, the most energy-efficient solution may involve Bessie and Elsie traveling to a common meeting field, then traveling together piggyback for the rest of the journey to the barn.  Of course, if P is large, it may still make the most sense for Bessie and Elsie to travel\n\nseparately.  On a side note, Bessie and Elsie are both unhappy with the term \"piggyback\", as they don't see why the pigs on the farm should deserve all the credit for this remarkable form of\n\ntransportation.\n\nGiven B, E, and P, as well as the layout of the farm, please compute the minimum amount of energy required for Bessie and Elsie to reach the barn.\n\n", "inputFormat": "INPUT: (file piggyback.in) \n\nThe first line of input contains the positive integers B, E, P, N, and M.  All of these are at most 40,000.  B, E, and P are described above. N is the number of fields in the farm (numbered 1..N, where N >= 3), and M is the number of connections between fields.  Bessie and Elsie start in fields 1 and 2, respectively.  The barn resides in field N. \n\nThe next M lines in the input each describe a connection between a pair of different fields, specified by the integer indices of the two fields.  Connections are bi-directional.  It is always possible to travel from field 1 to field N, and field 2 to field N, along a series of such connections.\n", "outputFormat": "OUTPUT: (file piggyback.out) \n\nA single integer specifying the minimum amount of energy Bessie and\n\nElsie collectively need to spend to reach the barn.  In the example\n\nshown here, Bessie travels from 1 to 4 and Elsie travels from 2 to 3\n\nto 4.  Then, they travel together from 4 to 7 to 8.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO14DEC] Piggy Back S", "background": "", "description": "Bessie and her sister Elsie graze in different fields during the day, and in the evening they both want to walk back to the barn to rest. Being clever bovines, they come up with a plan to minimize the total amount of energy they both spend while walking.\n\nBessie spends B units of energy when walking from a field to an adjacent field, and Elsie spends E units of energy when she walks to an adjacent field.  However, if Bessie and Elsie are together in the same field, Bessie can carry Elsie on her shoulders and both can move to an adjacent field while spending only P units of energy (where P might be considerably less than B+E, the amount Bessie and Elsie would have spent individually walking to the adjacent field).  If P is very small, the most energy-efficient solution may involve Bessie and Elsie traveling to a common meeting field, then traveling together piggyback for the rest of the journey to the barn.  Of course, if P is large, it may still make the most sense for Bessie and Elsie to travel\n\nseparately.  On a side note, Bessie and Elsie are both unhappy with the term \"piggyback\", as they don't see why the pigs on the farm should deserve all the credit for this remarkable form of\n\ntransportation.\n\nGiven B, E, and P, as well as the layout of the farm, please compute the minimum amount of energy required for Bessie and Elsie to reach the barn.\n\n", "inputFormat": "INPUT: (file piggyback.in) \n\nThe first line of input contains the positive integers B, E, P, N, and M.  All of these are at most 40,000.  B, E, and P are described above. N is the number of fields in the farm (numbered 1..N, where N >= 3), and M is the number of connections between fields.  Bessie and Elsie start in fields 1 and 2, respectively.  The barn resides in field N. \n\nThe next M lines in the input each describe a connection between a pair of different fields, specified by the integer indices of the two fields.  Connections are bi-directional.  It is always possible to travel from field 1 to field N, and field 2 to field N, along a series of such connections.\n", "outputFormat": "OUTPUT: (file piggyback.out) \n\nA single integer specifying the minimum amount of energy Bessie and\n\nElsie collectively need to spend to reach the barn.  In the example\n\nshown here, Bessie travels from 1 to 4 and Elsie travels from 2 to 3\n\nto 4.  Then, they travel together from 4 to 7 to 8.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Piggy Back S", "background": "", "description": "Bessie 和 Elsie 在不同的区域放牧，他们希望花费最小的能量返回谷仓。从一个区域走到一个相连区域，Bessie 要花费 $B$ 单位的能量，Elsie要花费 $E$ 单位的能量。\n\n如果某次他们两走到同一个区域，Bessie 可以背着 Elsie 走路，花费 $P$ 单位的能量走到另外一个相连的区域。当然，存在 $P>B+E$ 的情况。\n\n相遇后，他们可以一直背着走，也可以独立分开。\n\nBessie 从 $1$ 号区域出发，Elsie 从 $2$ 号区域出发，两个人都要返回到位于 $n$ 号区域的谷仓。", "inputFormat": "第一行输入 5 个整数 $B,E,P,n,m$。$B,E,P$ 的含义如上文所述。\n$n$ 表示农场中区域的数量，$m$ 表示连接两个区域的道路的数量。\n\n接下来 $m$ 行，每行两个整数 $x,y$，描述一条 $x$ 区域和 $y$ 区域之间的双向边。数据保证图是连通的。", "outputFormat": "一行一个整数，表示 Bessie 和 Elsie 能量花费总和的最小值。", "hint": "$1 \\leq B,E,P,n,m \\leq 4 \\times 10^4$。\n\n#### 样例解释：\nBessie 从 1 走到 4，Elsie 从 2 走到 3 再走到 4。然后，两个人一起从 4 走到 7，再走到 8。", "locale": "zh-CN"}}}
{"pid": "P3111", "type": "P", "difficulty": 3, "samples": [["5 3 \n0 1 \n1 2 \n2 3 \n3 2 \n6 1 \n\n \n\n", " \n\n3 \n\n \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2014", "USACO", "排序", "广度优先搜索 BFS"], "title": "[USACO14DEC] Cow Jog S", "background": "", "description": " \n\nThe cows are out exercising their hooves again!  There are N cows\n\njogging on an infinitely-long single-lane track (1 <= N <= 100,000).\n\nEach cow starts at a distinct position on the track, and some cows jog\n\nat different speeds.\n\n\n \n\nWith only one lane in the track, cows cannot pass each other.  When a\n\nfaster cow catches up to another cow, she has to slow down to avoid\n\nrunning into the other cow, becoming part of the same running group.\n\n \n\nThe cows will run for T minutes (1 <= T <= 1,000,000,000).  Please\n\nhelp Farmer John determine how many groups will be left at this time.\n\nTwo cows should be considered part of the same group if they are at\n\n\nthe same position at the end of T minutes. \n\n有N (1 <= N <= 100,000)头奶牛在一个单人的超长跑道上慢跑，每头牛的起点位置都不同。由于是单人跑道，所有他们之间不能相互超越。当一头速度快的奶牛追上另外一头奶牛的时候，他必须降速成同等速度。我们把这些跑走同一个位置而且同等速度的牛看成一个小组。\n\n\n请计算T (1 <= T <= 1,000,000,000)时间后，奶牛们将分为多少小组。\n\n", "inputFormat": "INPUT: (file cowjog.in) \n\nThe first line of input contains the two integers N and T.\n\n\nThe following N lines each contain the initial position and speed of a\n\nsingle cow.  Position is a nonnegative integer and speed is a positive\n\ninteger; both numbers are at most 1 billion.  All cows start at\n\ndistinct positions, and these will be given in increasing order in\n\nthe input.\n\n\n ", "outputFormat": "OUTPUT: (file cowjog.out) \n\nA single integer indicating how many groups remain after T minutes.\n\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO14DEC] Cow Jog S", "background": "", "description": "There are $N$ cows jogging on an infinitely long single-lane track, where $1 \\le N \\le 100000$. Each cow starts at a distinct position on the track, and some cows jog at different speeds.\n\nSince the track has only one lane, cows cannot pass each other. When a faster cow catches up to a slower cow, she must slow down to avoid running into her, becoming part of the same running group.\n\nThe cows will run for $T$ minutes, where $1 \\le T \\le 1000000000$. Please determine how many groups remain at that time. Two cows are considered part of the same group if they are at the same position at the end of $T$ minutes.", "inputFormat": "- The first line contains two integers $N$ and $T$.\n- Each of the following $N$ lines contains two integers: the initial position and speed of a single cow. The position is a nonnegative integer and the speed is a positive integer; both are at most $10^9$. All cows start at distinct positions, given in increasing order.", "outputFormat": "Output a single integer indicating how many groups remain after $T$ minutes.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Cow Jog S", "background": "", "description": " \n\nThe cows are out exercising their hooves again!  There are N cows\n\njogging on an infinitely-long single-lane track (1 <= N <= 100,000).\n\nEach cow starts at a distinct position on the track, and some cows jog\n\nat different speeds.\n\n\n \n\nWith only one lane in the track, cows cannot pass each other.  When a\n\nfaster cow catches up to another cow, she has to slow down to avoid\n\nrunning into the other cow, becoming part of the same running group.\n\n \n\nThe cows will run for T minutes (1 <= T <= 1,000,000,000).  Please\n\nhelp Farmer John determine how many groups will be left at this time.\n\nTwo cows should be considered part of the same group if they are at\n\n\nthe same position at the end of T minutes. \n\n有N (1 <= N <= 100,000)头奶牛在一个单人的超长跑道上慢跑，每头牛的起点位置都不同。由于是单人跑道，所有他们之间不能相互超越。当一头速度快的奶牛追上另外一头奶牛的时候，他必须降速成同等速度。我们把这些跑走同一个位置而且同等速度的牛看成一个小组。\n\n\n请计算T (1 <= T <= 1,000,000,000)时间后，奶牛们将分为多少小组。\n\n", "inputFormat": "INPUT: (file cowjog.in) \n\nThe first line of input contains the two integers N and T.\n\n\nThe following N lines each contain the initial position and speed of a\n\nsingle cow.  Position is a nonnegative integer and speed is a positive\n\ninteger; both numbers are at most 1 billion.  All cows start at\n\ndistinct positions, and these will be given in increasing order in\n\nthe input.\n\n\n ", "outputFormat": "OUTPUT: (file cowjog.out) \n\nA single integer indicating how many groups remain after T minutes.\n\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3112", "type": "P", "difficulty": 5, "samples": [["4 10 \n9 4 1 \n3 3 5 \n5 5 10 \n4 4 5 ", "2 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "2014", "USACO", "状压 DP"], "title": "[USACO14DEC] Guard Mark G", "background": null, "description": "Farmer John and his herd are playing frisbee.  Bessie throws thefrisbee down the field, but it's going straight to Mark the field handon the other team!  Mark has height $H$ ($1 \\le H \\le 10^9$), butthere are $N$ cows on Bessie's team gathered around Mark ($2 \\le N \\le 20$).They can only catch the frisbee if they can stack up to be at least ashigh as Mark.  Each of the $N$ cows has a height, weight, and strength.A cow's strength indicates the maximum amount of total weight of thecows that can be stacked above her. \n \n Given these constraints, Bessie wants to know if it is possible forher team to build a tall enough stack to catch the frisbee, and if so,what is the maximum safety factor of such a stack.  The safety factorof a stack is the amount of weight that can be added to the top of thestack without exceeding any cow's strength.", "inputFormat": "INPUT: (file guard.in) \n\nThe first line of input contains $N$ and $H$.\n\nThe next N lines of input each describe a cow, giving its height,weight, and strength.  All are positive integers at most $1$ billion.", "outputFormat": "OUTPUT: (file guard.out) \n\n If Bessie's team can build a stack tall enough to catch the frisbee, please output the maximum achievable safety factor for such a stack. \n\nOtherwise output \"Mark is too tall\" (without the quotes).", "hint": null, "locale": "en", "translations": {"en": {"title": "[USACO14DEC] Guard Mark G", "background": null, "description": "Farmer John and his herd are playing frisbee.  Bessie throws thefrisbee down the field, but it's going straight to Mark the field handon the other team!  Mark has height $H$ ($1 \\le H \\le 10^9$), butthere are $N$ cows on Bessie's team gathered around Mark ($2 \\le N \\le 20$).They can only catch the frisbee if they can stack up to be at least ashigh as Mark.  Each of the $N$ cows has a height, weight, and strength.A cow's strength indicates the maximum amount of total weight of thecows that can be stacked above her. \n \n Given these constraints, Bessie wants to know if it is possible forher team to build a tall enough stack to catch the frisbee, and if so,what is the maximum safety factor of such a stack.  The safety factorof a stack is the amount of weight that can be added to the top of thestack without exceeding any cow's strength.", "inputFormat": "INPUT: (file guard.in) \n\nThe first line of input contains $N$ and $H$.\n\nThe next N lines of input each describe a cow, giving its height,weight, and strength.  All are positive integers at most $1$ billion.", "outputFormat": "OUTPUT: (file guard.out) \n\n If Bessie's team can build a stack tall enough to catch the frisbee, please output the maximum achievable safety factor for such a stack. \n\nOtherwise output \"Mark is too tall\" (without the quotes).", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Guard Mark G", "background": null, "description": "农夫约翰和他的牛群正在玩飞盘。贝茜将飞盘扔向场地，但它正好飞向对方队伍的场地工马克！马克的身高为 $H$（$1 \\leq H \\leq 10^9$），但贝茜队伍中有 $N$ 头牛围在马克周围（$2 \\leq N \\leq 20$）。只有当它们堆叠起来的高度至少和马克一样高时，它们才能接住飞盘。每头牛都有一个高度、重量和力量。牛的力量表示可以堆叠在她上面的牛的总重量的最大值。\n\n在这些限制条件下，贝茜想知道她的队伍是否可以搭建一个足够高的堆叠来接住飞盘，如果可以，那么这种堆叠的最大安全系数是多少。堆叠的安全系数是指在不超过任何牛的力量的情况下，可以添加到堆叠顶部的重量。", "inputFormat": "输入：（文件 guard.in）\n\n输入的第一行包含 $N$ 和 $H$。\n\n接下来的 $N$ 行输入每行描述一头牛，给出它的高度、重量和力量。所有值都是不超过 10 亿的正整数。", "outputFormat": "输出：（文件 guard.out）\n\n如果贝茜的队伍可以搭建一个足够高的堆叠来接住飞盘，请输出这种堆叠的最大可实现安全系数。\n\n否则输出“Mark is too tall”（不带引号）。", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P3113", "type": "P", "difficulty": 5, "samples": [["5 5 \n-4 4 \n-5 -3 \n-1 5 \n-3 4 \n0 5 \nQ 1 5 \nU 4 0 1 \nU 4 -1 1 \nQ 2 4 \nQ 1 4 \n", "11 \n8 \n8 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "动态规划 DP", "2014", "线段树", "USACO", "枚举"], "title": "[USACO14DEC] Marathon G", "background": "", "description": "An avid marathon runner herself, Bessie enjoys creating marathon courses for her fellow cows to run.  She has most recently designed a route specified by N checkpoints (1 <= N <= 100,000) that must be visited in sequence.\n\n\nUnfortunately, Bessie realizes that the other cows may not have the stamina to run the full route. She therefore wants to know how long certain sub-routes take to run, where a sub-route is a contiguous subsequence of the checkpoints from the full route.  To make matters more complicated, Bessie knows that the other cows, being lazy, might choose to skip one checkpoint any time they run a sub-route -- whichever one results in a minimum total travel time.  They are not allowed to skip the first or last checkpoints in a sub-route, however.\n\n \nIn order to build the best possible marathon course, Bessie wants to investigate the ramifications of making changes to the checkpoint locations in her current course.  Please help her determine how certain changes to checkpoint locations will affect the time required to run different sub-routes (taking into account that the cows might choose to omit one checkpoint any time they run a sub-route).\n\n \nSince the course is set in a downtown area with a grid of streets, the distance between two checkpoints at locations (x1, y1) and (x2, y2) is given by |x1-x2| + |y1-y2|. ", "inputFormat": "\nINPUT: (file marathon.in) \n\nThe first line gives N and Q (1 <= Q <= 100,000). \n\nThe next N lines contain (x, y) locations of N checkpoints in the \n\nsequence they must be visited along the route.  All coordinates are in the range -1000 .. 1000.\n\n\nThe next Q lines consist of updates and queries, one per line, to be processed in the order they are given. Lines will either take the form \"U I X Y\" or \"Q I J\".  A line of the form \"U I X Y\" indicates that the location of checkpoint I (1 <= I <= N) is to be changed to location (X, Y).  A line of the form \"Q I J\" asks for the minimum travel time of the sub-route from checkpoint I to checkpoint J (I <= J), given that the cows choose to skip one checkpoint along this sub-route (but not the endpoints I and J).\n\n", "outputFormat": " \nOUTPUT: (file marathon.out) \n\nFor each sub-route length request, output on a single line the desired length. \n\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO14DEC] Marathon G", "background": "", "description": "An avid marathon runner herself, Bessie enjoys creating marathon courses for her fellow cows to run.  She has most recently designed a route specified by N checkpoints (1 <= N <= 100,000) that must be visited in sequence.\n\n\nUnfortunately, Bessie realizes that the other cows may not have the stamina to run the full route. She therefore wants to know how long certain sub-routes take to run, where a sub-route is a contiguous subsequence of the checkpoints from the full route.  To make matters more complicated, Bessie knows that the other cows, being lazy, might choose to skip one checkpoint any time they run a sub-route -- whichever one results in a minimum total travel time.  They are not allowed to skip the first or last checkpoints in a sub-route, however.\n\n \nIn order to build the best possible marathon course, Bessie wants to investigate the ramifications of making changes to the checkpoint locations in her current course.  Please help her determine how certain changes to checkpoint locations will affect the time required to run different sub-routes (taking into account that the cows might choose to omit one checkpoint any time they run a sub-route).\n\n \nSince the course is set in a downtown area with a grid of streets, the distance between two checkpoints at locations (x1, y1) and (x2, y2) is given by |x1-x2| + |y1-y2|. ", "inputFormat": "\nINPUT: (file marathon.in) \n\nThe first line gives N and Q (1 <= Q <= 100,000). \n\nThe next N lines contain (x, y) locations of N checkpoints in the \n\nsequence they must be visited along the route.  All coordinates are in the range -1000 .. 1000.\n\n\nThe next Q lines consist of updates and queries, one per line, to be processed in the order they are given. Lines will either take the form \"U I X Y\" or \"Q I J\".  A line of the form \"U I X Y\" indicates that the location of checkpoint I (1 <= I <= N) is to be changed to location (X, Y).  A line of the form \"Q I J\" asks for the minimum travel time of the sub-route from checkpoint I to checkpoint J (I <= J), given that the cows choose to skip one checkpoint along this sub-route (but not the endpoints I and J).\n\n", "outputFormat": " \nOUTPUT: (file marathon.out) \n\nFor each sub-route length request, output on a single line the desired length. \n\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Marathon G", "background": "", "description": "贝茜自己是一名狂热的马拉松跑者，她喜欢为她的牛朋友们设计马拉松路线。最近，她设计了一条由 $N$ 个检查点组成的路线，这些检查点必须按顺序访问。\n\n不幸的是，贝茜意识到其他牛可能没有足够的耐力跑完整条路线。因此，她想知道某些子路线需要多长时间，其中子路线是完整路线中连续的一段。更复杂的是，贝茜知道其他牛可能会因为懒惰而选择在跑子路线时跳过一个检查点——无论哪个检查点能使总旅行时间最短。然而，他们不允许跳过子路线的第一个或最后一个检查点。\n\n为了构建最佳的马拉松路线，贝茜想研究对当前路线中的检查点位置进行更改的影响。请帮助她确定对检查点位置的某些更改将如何影响跑不同子路线所需的时间（考虑到牛可能会在跑子路线时选择省略一个检查点）。\n\n由于路线设置在市中心的街道网格中，位于 $(x_1,y_1)$ 和 $(x_2,y_2)$ 的两个检查点之间的距离由 $\\lvert x_1-x_2\\rvert+\\lvert y_1-y_2\\rvert$ 给出。", "inputFormat": "第一行给出 $N$ 和 $Q$。\n\n接下来的 $N$ 行包含 $N$ 个检查点的 $(x,y)$ 位置，按照路线中必须访问的顺序给出。所有坐标的范围为 $-1000$ 到 $1000$。\n\n接下来的 $Q$ 行由更新和查询组成，每行一个操作，按给定顺序处理。这些行的形式要么是 `U I X Y`，要么是 `Q I J`。  \n形式为 `U I X Y` 的行表示检查点 $I$ 的位置要更改为 $(X,Y)$。  \n形式为 `Q I J` 的行要求输出从检查点 $I$ 到检查点 $J$ 的子路线的最短旅行时间，前提是牛选择在此子路线中跳过一个检查点（但不能是端点 $I$ 和 $J$）。", "outputFormat": "对于每个子路线长度请求，在单独一行输出所需的长度。", "hint": "对于 $100\\%$ 的数据，$1\\le N, Q\\le10^5,1\\le I\\le N$。  \n（本题由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3114", "type": "P", "difficulty": 5, "samples": [["3 \n-2 1 3 \n-3 2 3 \n-5 100 1 \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "线段树", "USACO", "离散化"], "title": "[USACO15JAN] Stampede S", "background": "", "description": "Farmer John's N cows (1 <= N <= 50,000) appear to be stampeding along the road at the front of FJ's farm, but they are actually just running in a foot race to see which cow is the fastest.\n\nViewed from above, each cow is represented by a unit-length horizontal line segment, specified by the coordinates of its left corner point at time t=0.  For example, (-3,6) would specify a cow who at time t=0 is represented by the segment from (-3,6) to (-2,6).  Each cow is moving to the right (in the +x direction) at a certain rate, specified by the integer amount of time it takes her to move 1 unit to the right.\n\nFJ is not particularly thrilled that his cows are outside running instead of in the barn producing milk.  He plans to admonish them with a stern lecture after the race ends.  In order to determine which of his cows are participating in the race, FJ situates himself at (0,0) and looks along a ray extending in the +y direction.  As the race unfolds, FJ sees a cow if she is ever the first cow visible along this ray.  That is, a cow might not be visible if another cow is \"in front\" of her during the entire time she crosses FJ's line of sight.\n\nPlease compute the number of cows FJ can see during the entire race.", "inputFormat": "INPUT:\n\nThe first line of the input contains N.  Each of the following N lines describes a cow with three integers x y r, corresponding to a cow whose left endpoint is at (x,y) at time t=0, moving to the right at a continuous speed of 1 unit of distance every r units of time.  The value of x is in the range -1000..-1, the value of y is in the range 1..1,000,000 (and distinct for every cow, to prevent any possible collisions), and the value of r is in the range 1..1,000,000. ", "outputFormat": "OUTPUT:\n\nA single integer, specifying the number of cows FJ can see during the entire race (from t=0 onward). \n\n", "hint": "SOLUTION NOTES:\n\nFJ can see cows 1 and 2 but not cow 3.\n\n", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Stampede S", "background": "", "description": "Farmer John's N cows (1 <= N <= 50,000) appear to be stampeding along the road at the front of FJ's farm, but they are actually just running in a foot race to see which cow is the fastest.\n\nViewed from above, each cow is represented by a unit-length horizontal line segment, specified by the coordinates of its left corner point at time t=0.  For example, (-3,6) would specify a cow who at time t=0 is represented by the segment from (-3,6) to (-2,6).  Each cow is moving to the right (in the +x direction) at a certain rate, specified by the integer amount of time it takes her to move 1 unit to the right.\n\nFJ is not particularly thrilled that his cows are outside running instead of in the barn producing milk.  He plans to admonish them with a stern lecture after the race ends.  In order to determine which of his cows are participating in the race, FJ situates himself at (0,0) and looks along a ray extending in the +y direction.  As the race unfolds, FJ sees a cow if she is ever the first cow visible along this ray.  That is, a cow might not be visible if another cow is \"in front\" of her during the entire time she crosses FJ's line of sight.\n\nPlease compute the number of cows FJ can see during the entire race.", "inputFormat": "INPUT:\n\nThe first line of the input contains N.  Each of the following N lines describes a cow with three integers x y r, corresponding to a cow whose left endpoint is at (x,y) at time t=0, moving to the right at a continuous speed of 1 unit of distance every r units of time.  The value of x is in the range -1000..-1, the value of y is in the range 1..1,000,000 (and distinct for every cow, to prevent any possible collisions), and the value of r is in the range 1..1,000,000. ", "outputFormat": "OUTPUT:\n\nA single integer, specifying the number of cows FJ can see during the entire race (from t=0 onward). \n\n", "hint": "SOLUTION NOTES:\n\nFJ can see cows 1 and 2 but not cow 3.\n\n", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Stampede S", "background": "", "description": "FJ 的 $N$ 头奶牛（$1 \\leq N \\leq 50,000$）看似在农场前的路上狂奔，实际上它们正在进行一场赛跑。\n\n从上方俯视，每头牛在时间 $t = 0$ 时被表示为一个单位长度的水平线段，其左端点坐标为 $(x, y)$。例如，$(-3, 6)$ 表示一头在 $t = 0$ 时从 $(-3, 6)$ 延伸到 $(-2, 6)$ 的奶牛。每头牛以一定速度向右（$+x$ 方向）移动，该速度由移动 1 单位距离所需的整数时间 $r$ 描述。\n\nFJ 并不满意他的奶牛在外赛跑而不在牛棚产奶。他计划在比赛结束后训斥参赛的奶牛。为了确定哪些奶牛参赛，FJ 站在 $(0, 0)$ 处并沿 $+y$ 方向的射线观察。当一头牛在某个时刻成为这条射线上首个可见的牛时，FJ 就会看到它。如果一头牛在穿过 FJ 视线期间始终被其他牛\"挡住\"，则她不可见。\n\n请计算 FJ 在整个比赛过程中能看到的奶牛数量。", "inputFormat": "第一行包含 $N$。接下来 $N$ 行每行描述一头牛，包含三个整数 $x$ $y$ $r$，分别表示：左端点初始坐标为 $(x, y)$，以每移动 1 单位距离需要 $r$ 单位时间的速度向右移动。$x$ 的取值范围为 $-1000$ 到 $-1$，$y$ 的取值范围为 $1$ 到 $1,000,000$（所有牛的 $y$ 值互不相同以避免碰撞），$r$ 的取值范围为 $1$ 到 $1,000,000$。", "outputFormat": "一个整数，表示 FJ 能看到的奶牛数量。", "hint": "FJ 可以看到牛 1 和 2，但看不到牛 3。", "locale": "zh-CN"}}}
{"pid": "P3115", "type": "P", "difficulty": 5, "samples": [["3 4 3 \n3 5 \n1 2 3 4 5 \n2 3 \n3 5 4 \n1 2 \n1 5 \n", "2 2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "最短路"], "title": "[USACO15JAN] Cow Routing S", "background": "", "description": "Tired of the cold winter weather on her farm, Bessie the cow plans to fly to a warmer destination for vacation. Unfortunately, she discovers that only one airline, Air Bovinia, is willing to sell tickets to cows, and that these tickets are somewhat complicated in structure.\n\nAir Bovinia owns N planes (1 <= N <= 1000), each of which flies on a specific \"route\" consisting of two or more cities.  For example, one plane might fly on a route that starts at city 1, then flies to city 5, then flies to city 2, and then finally flies to city 8. No city appears multiple times in a route. If Bessie chooses to utilize a route, she can board at any city along the route and then disembark at any city later along the route. She does not need to board at the first city or disembark at the last city. Each route has a certain cost, which Bessie must pay if she uses any part of the route, irrespective of the number of cities she visits along the route. If Bessie uses a route multiple times during her travel (that is, if she leaves the route and later comes back to use it from antoher city), she must pay for it each time it is used.\n\nBessie would like to find the cheapest way to travel from her farm (in city A) to her tropical destination (city B). Please help her decide what is the minimum cost she must pay, and also the smallest number of individual flights she must use take to achieve this minimum cost.\n", "inputFormat": "The first line of input contains A, B, and N, separated by spaces.\n\nThe next 2N lines describe the available routes, in two lines per route. The first line contains the cost of using the route (an integer in the range 1..1,000,000,000), and the number of cities along the route (an integer in the range 1..100).  The second line contains a list of the cities in order along the route.  Each city is identified by an integer in the range 1..1000. Note that the cost of an itinerary can easily add up to more than can fit into a 32-bit integer, so you should probably use 64-bit integers (e.g., \"long long\" integers in C/C++).\n", "outputFormat": "Output the minimum cost of an itinerary that Bessie can use to travel from city A to city B, as well as the minimum number of individual flights required to achieve this minimum cost. If there is no solution, output \"-1 -1\" (quotes for clarity) on a single line.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Cow Routing S", "background": "", "description": "Tired of the cold winter weather on her farm, Bessie the cow plans to fly to a warmer destination for vacation. Unfortunately, she discovers that only one airline, Air Bovinia, is willing to sell tickets to cows, and that these tickets are somewhat complicated in structure.\n\nAir Bovinia owns N planes (1 <= N <= 1000), each of which flies on a specific \"route\" consisting of two or more cities.  For example, one plane might fly on a route that starts at city 1, then flies to city 5, then flies to city 2, and then finally flies to city 8. No city appears multiple times in a route. If Bessie chooses to utilize a route, she can board at any city along the route and then disembark at any city later along the route. She does not need to board at the first city or disembark at the last city. Each route has a certain cost, which Bessie must pay if she uses any part of the route, irrespective of the number of cities she visits along the route. If Bessie uses a route multiple times during her travel (that is, if she leaves the route and later comes back to use it from antoher city), she must pay for it each time it is used.\n\nBessie would like to find the cheapest way to travel from her farm (in city A) to her tropical destination (city B). Please help her decide what is the minimum cost she must pay, and also the smallest number of individual flights she must use take to achieve this minimum cost.\n", "inputFormat": "The first line of input contains A, B, and N, separated by spaces.\n\nThe next 2N lines describe the available routes, in two lines per route. The first line contains the cost of using the route (an integer in the range 1..1,000,000,000), and the number of cities along the route (an integer in the range 1..100).  The second line contains a list of the cities in order along the route.  Each city is identified by an integer in the range 1..1000. Note that the cost of an itinerary can easily add up to more than can fit into a 32-bit integer, so you should probably use 64-bit integers (e.g., \"long long\" integers in C/C++).\n", "outputFormat": "Output the minimum cost of an itinerary that Bessie can use to travel from city A to city B, as well as the minimum number of individual flights required to achieve this minimum cost. If there is no solution, output \"-1 -1\" (quotes for clarity) on a single line.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Cow Routing S", "background": "", "description": "Bessie 对她农场那寒冷的天气感到厌烦，于是她准备坐飞机到一个更温暖的地方度假。不幸的是，她发现只有一个航空公司：Air Bovinia，愿意卖票给牛，并且这些票的结构有些复杂。\n\nAir Bovinia 拥有 $n$ 架飞机，每架飞机都有一个经过两个及以上的城市的特殊航线。举个例子：一架飞机可以从城市 $1$ 出发，然后飞往城市 $5$，再飞到城市 $2$，最后飞到城市 $8$。注意**航线是单向的**。任何城市都不会在同一条航线上出现多次。如果 Bessie 选择了一条航线，那么她可以从航线上的任意一个城市上飞机，然后在途中任意一个城市下飞机。他不必从航线的起点上飞机，再从航线的终点下飞机。每条航线都有一个确定的花费，只要它搭乘了这个航班，她就必须支付这个航班的全额花费，不论她途经了几个城市。如果 Bessie 多次搭乘了某个航班，那么每次搭乘 Bessie 都必须支付航班的花费。\n\nBessie 想要找到从她农场所在的城市（城市 $A$）到她目的地所在城市（城市 $B$）最便宜的路线。请你告诉她他最少要花多少钱，并告诉她在此基础上她最少要**经过几段航线**，也即经过的城市数量 $-1$（包括起点和终点）。", "inputFormat": "第一行三个整数 $A,B,n$。\n\n接下来 $2n$ 行，每两行描述一次航班。第一行包括航线的花费 $cost$ 与经过的城市数 $len$。第二行 $len$ 个整数，表示航班依次经过的城市。", "outputFormat": "一行两个整数，输出 Bessie 旅行最少要花的钱以及在此基础上最少的经过航线数量。\n\n如果 Bessie 不能从她的农场到达她的目的地，则输出 `-1 -1`。", "hint": "$1\\le n\\le 1000$，$1\\le cost\\le 10^9$，$1\\le len\\le 100$。城市的编号均不超过 $1000$。\n\n可能需要开 `long long`。", "locale": "zh-CN"}}}
{"pid": "P3116", "type": "P", "difficulty": 4, "samples": [["3 3 \n1 3 1 2 \n1 2 1 2 \n2 3 1 2 \n", "2 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "USACO", "拓扑排序"], "title": "[USACO15JAN] Meeting Time S", "background": "", "description": "Bessie and her sister Elsie want to travel from the barn to their favorite field, such that they leave at exactly the same time from the barn, and also arrive at exactly the same time at their favorite field.\n\nThe farm is a collection of N fields (1 <= N <= 100) numbered 1..N, where field 1 contains the barn and field N is the favorite field. The farm is built on the side of a hill, with field X being higher in elevation than field Y if X < Y.  An assortment of M paths connect pairs of fields.  However, since each path is rather steep, it can only be followed in a downhill direction. For example, a path connecting field 5 with field 8 could be followed in the 5 -> 8 direction but not the other way, since this would be uphill.  Each pair of fields is connected by at most one path, so M <= N(N-1)/2.\n\nIt might take Bessie and Elsie different amounts of time to follow a path; for example, Bessie might take 10 units of time, and Elsie 20. Moreover, Bessie and Elsie only consume time when traveling on paths between fields -- since they are in a hurry, they always travel through a field in essentially zero time, never waiting around anywhere.\n\nPlease help determine the shortest amount of time Bessie and Elsie must take in order to reach their favorite field at exactly the same moment.\n", "inputFormat": "The first input line contains N and M, separated by a space.\n\nEach of the following M lines describes a path using four integers A B C D, where A and B (with A < B) are the fields connected by the path, C is the time required for Bessie to follow the path, and D is the time required for Elsie to follow the path.  Both C and D are in the range 1..100.\n", "outputFormat": "A single integer, giving the minimum time required for Bessie and Elsie to travel to their favorite field and arrive at the same moment.\n\nIf this is impossible, or if there is no way for Bessie or Elsie to reach the favorite field at all, output the word IMPOSSIBLE on a single line.\n", "hint": "SOLUTION NOTES:\n\nBessie is twice as fast as Elsie on each path, but if Bessie takes the path 1->2->3 and Elsie takes the path 1->3 they will arrive at the same time.\n\n", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Meeting Time S", "background": "", "description": "Bessie and her sister Elsie want to travel from the barn to their favorite field, such that they leave at exactly the same time from the barn, and also arrive at exactly the same time at their favorite field.\n\nThe farm is a collection of N fields (1 <= N <= 100) numbered 1..N, where field 1 contains the barn and field N is the favorite field. The farm is built on the side of a hill, with field X being higher in elevation than field Y if X < Y.  An assortment of M paths connect pairs of fields.  However, since each path is rather steep, it can only be followed in a downhill direction. For example, a path connecting field 5 with field 8 could be followed in the 5 -> 8 direction but not the other way, since this would be uphill.  Each pair of fields is connected by at most one path, so M <= N(N-1)/2.\n\nIt might take Bessie and Elsie different amounts of time to follow a path; for example, Bessie might take 10 units of time, and Elsie 20. Moreover, Bessie and Elsie only consume time when traveling on paths between fields -- since they are in a hurry, they always travel through a field in essentially zero time, never waiting around anywhere.\n\nPlease help determine the shortest amount of time Bessie and Elsie must take in order to reach their favorite field at exactly the same moment.\n", "inputFormat": "The first input line contains N and M, separated by a space.\n\nEach of the following M lines describes a path using four integers A B C D, where A and B (with A < B) are the fields connected by the path, C is the time required for Bessie to follow the path, and D is the time required for Elsie to follow the path.  Both C and D are in the range 1..100.\n", "outputFormat": "A single integer, giving the minimum time required for Bessie and Elsie to travel to their favorite field and arrive at the same moment.\n\nIf this is impossible, or if there is no way for Bessie or Elsie to reach the favorite field at all, output the word IMPOSSIBLE on a single line.\n", "hint": "SOLUTION NOTES:\n\nBessie is twice as fast as Elsie on each path, but if Bessie takes the path 1->2->3 and Elsie takes the path 1->3 they will arrive at the same time.\n\n", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Meeting Time S", "background": null, "description": "$\\texttt{Bessie}$ 和她的妹妹 $\\texttt{Elsie}$ 想从粮仓去她们最喜欢的田地，也就是能够使她们一起从粮仓离开，并且能同一时间到达的田地。\n\n这个农场是由 $N$ 块 $(1\\leq N\\leq 100)$ 编号为 $1\\cdots N$ 的田地构成的，第一块田地就是粮仓，并且第 $N$ 块田地是她们最喜欢的田地。\n\n这个农场建在山的一边，所以，如果 $X < Y$ 的话则满足第 $X$ 块田地的高度要高于第 $Y$ 块田地的高度。在这之中，有 $M$ 条交错纵横的路径将不同的田地连接起来。\n\n不过，显而易见的是，因为每条路都太陡了，所以这些小路只能沿着从高到低的方向走。例如，一条连接第 $5$ 块田地和 $8$ 块田地的小路只能沿着 $5\\to 8$ 的方向走，而不能沿着其他方向，因为那样会成为上坡路。每两块田地最多只能有一条路径相连接，所以只算有效路径的话，一定有 $M \\leq \\dfrac{N(N-1)}{2}$。\n\n有可能的是，$\\texttt{Bessie}$ 和 $\\texttt{Elsie}$ 两个人走同一条小路会耗费不同的时间；比如，通过同一条小路，$\\texttt{Bessie}$ 可能会耗费 $10$ 个单位的时间，而 $\\texttt{Elsie}$ 会耗费 $20$ 个单位的时间。\n\n此外，$\\texttt{Bessie}$ 和 $\\texttt{Elsie}$ 只会在通过连接两块田地的小路时耗费时间——因为她们太匆忙了，在穿过田地时不会耗费任何时间，也从来不在任何地方停下来等待。\n\n现在，请你判断出，能够满足使 $\\texttt{Bessie}$ 和 $\\texttt{Elsie}$ 同时出发并且同时到达她们喜欢的田地的最短的时间。", "inputFormat": "第一行输入 $N$ 和 $M$，中间用空格分开。\n\n接下来的 $M$ 行，每行有四个整数 $A,B,C,D$，其中，$A$ 和$B$ 代表着两块用这条小路连接的田地，$C$ 代表 $\\texttt{Bessie}$ 通过这条小路的时间，而 $D$ 代表 $\\texttt{Elsie}$ 通过这条小路的时间。$C$ 和 $D$ 均在 $1\\cdots100$ 的范围之内。", "outputFormat": "一个整数，输出的是能够使两人同时出发并且同时到达目的地的最短时间，如果没有满足条件的答案，则输出 `IMPOSSIBLE`。", "hint": "$\\texttt{Bessie}$ 在每一条路都比 $\\texttt{Elsie}$ 快两倍。\n\n如果 $\\texttt{Bessie}$ 经过 $1\\to 2\\to 3$ 的路线，$\\texttt{Elsie}$ 经过 $1\\to 3$ 的路线，他们可以同时到达。", "locale": "zh-CN"}}}
{"pid": "P3117", "type": "P", "difficulty": 5, "samples": [["5 \n1 1 H \n2 2 H \n3 3 G \n4 4 H \n6 6 H \n", "2 \n1 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "单调队列", "离散化", "前缀和", "扫描线"], "title": "[USACO15JAN] Cow Rectangles G", "background": "", "description": "The locations of Farmer John's N cows (1 <= N <= 500) are described by distinct points in the 2D plane.  The cows belong to two different breeds: Holsteins and Guernseys.  Farmer John wants to build a rectangular fence with sides parallel to the coordinate axes enclosing only Holsteins, with no Guernseys (a cow counts as enclosed even if it is on the boundary of the fence).  Among all such fences, Farmer John wants to build a fence enclosing the maximum number of Holsteins.  And among all these fences, Farmer John wants to build a fence of minimum possible area.  Please determine this area.  A fence of zero width or height is allowable.\n", "inputFormat": "The first line of input contains N.  Each of the next N lines describes a cow, and contains two integers and a character. The integers indicate a point (x,y) (0 <= x, y <= 1000) at which the cow is located. The character is H or G, indicating the cow's breed.  No two cows are located at the same point, and there is always at least one Holstein.\n", "outputFormat": "Print two integers. The first line should contain the maximum number of Holsteins that can be enclosed by a fence containing no Guernseys, and second line should contain the minimum area enclosed by such a fence.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Cow Rectangles G", "background": "", "description": "The locations of Farmer John's N cows (1 <= N <= 500) are described by distinct points in the 2D plane.  The cows belong to two different breeds: Holsteins and Guernseys.  Farmer John wants to build a rectangular fence with sides parallel to the coordinate axes enclosing only Holsteins, with no Guernseys (a cow counts as enclosed even if it is on the boundary of the fence).  Among all such fences, Farmer John wants to build a fence enclosing the maximum number of Holsteins.  And among all these fences, Farmer John wants to build a fence of minimum possible area.  Please determine this area.  A fence of zero width or height is allowable.\n", "inputFormat": "The first line of input contains N.  Each of the next N lines describes a cow, and contains two integers and a character. The integers indicate a point (x,y) (0 <= x, y <= 1000) at which the cow is located. The character is H or G, indicating the cow's breed.  No two cows are located at the same point, and there is always at least one Holstein.\n", "outputFormat": "Print two integers. The first line should contain the maximum number of Holsteins that can be enclosed by a fence containing no Guernseys, and second line should contain the minimum area enclosed by such a fence.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Cow Rectangles G", "background": "", "description": "农夫约翰的 $N$ 头牛（$1 \\leq N \\leq 500$）的位置由二维平面上互不相同的点描述。这些牛分为两个品种：Holsteins 和 Guernseys。农夫约翰希望建造一个边与坐标轴平行的矩形围栏，仅包含 Holsteins 且不包含任何 Guernseys（即使牛位于围栏边界上也视为被包含）。在所有满足条件的围栏中，农夫约翰希望选择包含最多 Holsteins 的围栏。若存在多个这样的围栏，则选择其中面积最小的一个。请确定这个面积。允许围栏的宽度或高度为零。", "inputFormat": "第一行输入包含 $N$。接下来的 $N$ 行每行描述一头牛，包含两个整数和一个字符。整数表示牛所在点的坐标 $(x, y)$（$0 \\leq x, y \\leq 1000$），字符为 H 或 G 表示牛的品种。没有两头牛位于同一位置，且至少存在一头 Holstein。", "outputFormat": "输出两个整数。第一行应包含不包含任何 Guernseys 的围栏能包围的最大 Holsteins 数量，第二行应包含满足该条件的围栏的最小面积。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3118", "type": "P", "difficulty": 5, "samples": [["4 100 \n50 3 15 30 55 \n40 2 0 65 \n30 2 20 90 \n20 1 0 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "O2优化", "状压 DP"], "title": "[USACO15JAN] Moovie Mooving G", "background": null, "description": "Bessie is out at the movies.  Being mischievous as always, she has decided to hide from Farmer John for $L$ ($1 \\le L \\le 10^8$) minutes, during which time she wants to watch movies continuously. She has $N$ ($1 \\le N \\le 20$) movies to choose from, each of which has a certain duration and a set of showtimes during the day.  Bessie may enter and exit a movie at any time during one if its showtimes, but she does not want to ever visit the same movie twice, and she cannot switch to another showtime of the same movie that overlaps the current showtime.\n\nHelp Bessie by determining if it is possible for her to achieve her goal of watching movies continuously from time $0$ through time $L$.  If it is, determine the minimum number of movies she needs to see to achieve this goal (Bessie gets confused with plot lines if she watches too many movies).", "inputFormat": "The first line of input contains $N$ and $L$.\n\nThe next $N$ lines each describe a movie.  They begin with its integer duration, $D$ ($1 \\le D \\le L$) and the number of showtimes, $C$ ($1 \\le C \\le 1000$).  The remaining $C$ integers on the same line are each in the range $0 \\dots L$, and give the starting time of one of the showings of the movie.  Showtimes are distinct, in the range $0 \\dots L$, and given in increasing order.", "outputFormat": "A single integer indicating the minimum number of movies that Bessie needs to see to achieve her goal. If this is impossible output $-1$ instead.", "hint": "Bessie should attend the first showing of the fourth movie from time $0$ to time $20$.  Then she watches the first showing of the first movie from time $20$ to time $65$.  Finally she watches the last showing of the second movie from time $65$ to time $100$.", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Moovie Mooving G", "background": null, "description": "Bessie is out at the movies.  Being mischievous as always, she has decided to hide from Farmer John for $L$ ($1 \\le L \\le 10^8$) minutes, during which time she wants to watch movies continuously. She has $N$ ($1 \\le N \\le 20$) movies to choose from, each of which has a certain duration and a set of showtimes during the day.  Bessie may enter and exit a movie at any time during one if its showtimes, but she does not want to ever visit the same movie twice, and she cannot switch to another showtime of the same movie that overlaps the current showtime.\n\nHelp Bessie by determining if it is possible for her to achieve her goal of watching movies continuously from time $0$ through time $L$.  If it is, determine the minimum number of movies she needs to see to achieve this goal (Bessie gets confused with plot lines if she watches too many movies).", "inputFormat": "The first line of input contains $N$ and $L$.\n\nThe next $N$ lines each describe a movie.  They begin with its integer duration, $D$ ($1 \\le D \\le L$) and the number of showtimes, $C$ ($1 \\le C \\le 1000$).  The remaining $C$ integers on the same line are each in the range $0 \\dots L$, and give the starting time of one of the showings of the movie.  Showtimes are distinct, in the range $0 \\dots L$, and given in increasing order.", "outputFormat": "A single integer indicating the minimum number of movies that Bessie needs to see to achieve her goal. If this is impossible output $-1$ instead.", "hint": "Bessie should attend the first showing of the fourth movie from time $0$ to time $20$.  Then she watches the first showing of the first movie from time $20$ to time $65$.  Finally she watches the last showing of the second movie from time $65$ to time $100$.", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Moovie Mooving G", "background": "", "description": "Bessie 正在外看电影。调皮的她想在 $L$（$1 \\leq L \\leq 100,000,000$）分钟内连续观看电影来躲避农夫 John。她有 $N$（$1 \\leq N \\leq 20$）部电影可选，每部电影有特定时长和多个放映场次。Bessie 可以在电影放映期间的任意时刻入场或离场，但不能重复观看同一部电影，也不能切换到同一部电影时间重叠的场次。\n\n请判断 Bessie 是否能从时间 $0$ 到时间 $L$ 连续观看电影。若可行，求出达成目标所需观看的最小电影数量（过多电影会让 Bessie 混淆剧情）。", "inputFormat": "第一行输入包含 $N$ 和 $L$。\n\n接下来 $N$ 行描述每部电影：每行以整数时长 $D$（$1 \\leq D \\leq L$）和场次数 $C$（$1 \\leq C \\leq 1000$）开头，随后给出 $C$ 个按升序排列的场次开始时间（范围 $0$ 至 $L$，且互不重复）。", "outputFormat": "输出达成目标所需的最小电影数量。若不可能则输出 $-1$。", "hint": "Bessie 可以观看第四部电影的首场（时间 $0$ 至 $20$），接着观看第一部电影的首场（时间 $20$ 至 $65$），最后观看第二部电影的末场（时间 $65$ 至 $100$）。", "locale": "zh-CN"}}}
{"pid": "P3119", "type": "P", "difficulty": 5, "samples": [["7 10 \n1 2 \n3 1 \n2 5 \n2 4 \n3 7 \n3 5 \n3 6 \n6 5 \n7 2 \n4 7 \n\n", "6 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "USACO", "拓扑排序", "强连通分量", "Tarjan"], "title": "[USACO15JAN] Grass Cownoisseur G", "background": "", "description": "In an effort to better manage the grazing patterns of his cows, Farmer John has installed one-way cow paths all over his farm. The farm consists of N fields, conveniently numbered 1..N, with each one-way cow path connecting a pair of fields. For example, if a path connects from field X to field Y, then cows are allowed to travel from X to Y but not from Y to X.\n\nBessie the cow, as we all know, enjoys eating grass from as many fields as possible. She always starts in field 1 at the beginning of the day and visits a sequence of fields, returning to field 1 at the end of the day. She tries to maximize the number of distinct fields along her route, since she gets to eat the grass in each one (if she visits a field multiple times, she only eats the grass there once).\n\nAs one might imagine, Bessie is not particularly happy about the one-way restriction on FJ's paths, since this will likely reduce the number of distinct fields she can possibly visit along her daily route.  She wonders how much grass she will be able to eat if she breaks the rules and follows up to one path in the wrong direction. Please compute the maximum number of distinct fields she can visit along a route starting and ending at field 1, where she can follow up to one path along the route in the wrong direction.  Bessie can only travel backwards at most once in her journey.  In particular, she cannot even take the same path backwards twice.", "inputFormat": "The first line of input contains N and M, giving the number of fields and the number of one-way paths (1 <= N, M <= 100,000). \n\nThe following M lines each describe a one-way cow path.  Each line contains two distinct field numbers X and Y, corresponding to a cow path from X to Y.  The same cow path will never appear more than once.", "outputFormat": "A single line indicating the maximum number of distinct fields Bessie can visit along a route starting and ending at field 1, given that she can follow at most one path along this route in the wrong direction.", "hint": "SOLUTION NOTES:\n\nHere is an ASCII drawing of the sample input:\n\n```cpp\nv---3-->6\n7   | \\ |\n^\\  v  \\|\n| \\ 1   |\n|   |   v\n|   v   5\n4<--2---^\n```\n\nBessie can visit pastures 1, 2, 4, 7, 2, 5, 3, 1 by traveling backwards on the path between 5 and 3.  When she arrives at 3 she cannot reach 6 without following another backwards path.", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Grass Cownoisseur G", "background": "", "description": "In an effort to better manage the grazing patterns of his cows, Farmer John has installed one-way cow paths all over his farm. The farm consists of N fields, conveniently numbered 1..N, with each one-way cow path connecting a pair of fields. For example, if a path connects from field X to field Y, then cows are allowed to travel from X to Y but not from Y to X.\n\nBessie the cow, as we all know, enjoys eating grass from as many fields as possible. She always starts in field 1 at the beginning of the day and visits a sequence of fields, returning to field 1 at the end of the day. She tries to maximize the number of distinct fields along her route, since she gets to eat the grass in each one (if she visits a field multiple times, she only eats the grass there once).\n\nAs one might imagine, Bessie is not particularly happy about the one-way restriction on FJ's paths, since this will likely reduce the number of distinct fields she can possibly visit along her daily route.  She wonders how much grass she will be able to eat if she breaks the rules and follows up to one path in the wrong direction. Please compute the maximum number of distinct fields she can visit along a route starting and ending at field 1, where she can follow up to one path along the route in the wrong direction.  Bessie can only travel backwards at most once in her journey.  In particular, she cannot even take the same path backwards twice.", "inputFormat": "The first line of input contains N and M, giving the number of fields and the number of one-way paths (1 <= N, M <= 100,000). \n\nThe following M lines each describe a one-way cow path.  Each line contains two distinct field numbers X and Y, corresponding to a cow path from X to Y.  The same cow path will never appear more than once.", "outputFormat": "A single line indicating the maximum number of distinct fields Bessie can visit along a route starting and ending at field 1, given that she can follow at most one path along this route in the wrong direction.", "hint": "SOLUTION NOTES:\n\nHere is an ASCII drawing of the sample input:\n\n```cpp\nv---3-->6\n7   | \\ |\n^\\  v  \\|\n| \\ 1   |\n|   |   v\n|   v   5\n4<--2---^\n```\n\nBessie can visit pastures 1, 2, 4, 7, 2, 5, 3, 1 by traveling backwards on the path between 5 and 3.  When she arrives at 3 she cannot reach 6 without following another backwards path.", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Grass Cownoisseur G", "background": "", "description": "为了更好地管理牛群的放牧路线，Farmer John 在他的农场中安装了若干单向牛道。农场由 $N$ 块草场组成，编号为 $1$ 到 $N$，每条单向牛道连接一对草场。例如，若存在一条从草场 $X$ 到 $Y$ 的路径，则牛可以从 $X$ 前往 $Y$，但不能从 $Y$ 返回 $X$。\n\n众所周知，Bessie 喜欢尽可能多地品尝不同草场的牧草。她每天从草场 $1$ 出发，访问一系列草场后返回草场 $1$。她试图最大化沿途经过的不同草场数量（重复访问的草场只算一次）。\n\n由于单向路径的限制，Bessie 担心这会减少她每日路线中可以访问的草场数量。她想知道如果她违反规则，在路线中最多逆向通过某条道路一次，最多能品尝多少草场的牧草。请计算她从草场 $1$ 出发并返回的情况下，最多能访问的不同草场数量。注意 Bessie 在整个旅程中最多只能逆向通过一条道路，且同一条路径不能逆向两次。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$，表示草场数量和单向牛道数量（$1 \\leq N, M \\leq 100,000$）。\n\n接下来 $M$ 行每行描述一条单向牛道，包含两个不同的整数 $X$ 和 $Y$，表示从 $X$ 到 $Y$ 的单向路径。保证每条路径不会重复出现。", "outputFormat": "输出一行，表示 Bessie 在最多逆向通过一条道路的情况下，从草场 $1$ 出发并返回时能访问的最大不同草场数量。", "hint": "**样例解析：**\n\n以下是样例输入的 ASCII 图示：\n\n```\nv---3-->6\n7   | \\ |\n^\\  v  \\|\n| \\ 1   |\n|   |   v\n|   v   5\n4<--2---^\n```\n\nBessie 可以通过逆向路径 $5\\to 3$ 访问草场 $1, 2, 4, 7, 2, 5, 3, 1$。到达草场 $3$ 后，若不再次逆向其他路径则无法前往 $6$。", "locale": "zh-CN"}}}
{"pid": "P3120", "type": "P", "difficulty": 5, "samples": [["4 4 4 \n1 1 1 1 \n1 3 2 1 \n1 2 4 1 \n1 1 1 1 \n", "5 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "线段树", "USACO", "cdq 分治", "前缀和"], "title": "[USACO15FEB] Cow Hopscotch G", "background": "", "description": "Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play.  Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.\n\nThe game is played on an R by C grid (2 <= R <= 750, 2 <= C <= 750), where each square is labeled with an integer in the range 1..K (1 <= K <= R\\*C).  Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if\n\n1) You are jumping to a square labeled with a different integer than your current square,\n\n2) The square that you are jumping to is at least one row below the current square that you are on, and\n\n3) The square that you are jumping to is at least one column to the right of the current square that you are on.\n\nPlease help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.", "inputFormat": "The first line contains the integers R, C, and K.\n\nThe next R lines will each contain C integers, each in the range 1..K.", "outputFormat": "Output the number of different ways one can jump from the top-left square to the bottom-right square, mod 1000000007.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15FEB] Cow Hopscotch G", "background": "", "description": "Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play.  Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.\n\nThe game is played on an R by C grid (2 <= R <= 750, 2 <= C <= 750), where each square is labeled with an integer in the range 1..K (1 <= K <= R\\*C).  Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if\n\n1) You are jumping to a square labeled with a different integer than your current square,\n\n2) The square that you are jumping to is at least one row below the current square that you are on, and\n\n3) The square that you are jumping to is at least one column to the right of the current square that you are on.\n\nPlease help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.", "inputFormat": "The first line contains the integers R, C, and K.\n\nThe next R lines will each contain C integers, each in the range 1..K.", "outputFormat": "Output the number of different ways one can jump from the top-left square to the bottom-right square, mod 1000000007.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Cow Hopscotch G", "background": "", "description": "与人类喜欢玩跳格子游戏类似，Farmer John 的奶牛们也发明了自己的游戏版本。尽管体重接近一吨的笨拙动物玩这个游戏几乎总会以灾难收场，但这意料之外地没有阻止奶牛们每天下午尝试玩耍的热情。\n\n游戏在一个 $R$ 行 $C$ 列的网格上进行（$2 \\leq R, C \\leq 750$），每个格子标有 $1$ 到 $K$ 的整数（$1 \\leq K \\leq R \\times C$）。奶牛从左上角的格子出发，通过一系列合法跳跃到达右下角的格子。一次跳跃被定义为合法当且仅当满足以下条件：\n\n1. 目标格子的标签数字与当前格子不同；\n2. 目标格子所在行至少比当前格子多一行；\n3. 目标格子所在列至少比当前格子多一列。\n\n请帮助奶牛计算从左上角到右下角的不同合法跳跃序列总数。", "inputFormat": "第一行包含三个整数 $R$, $C$, $K$。\n\n接下来 $R$ 行，每行包含 $C$ 个整数，表示网格的标签（范围 $1$ 到 $K$）。", "outputFormat": "输出从左上角到右下角的不同跳跃路径数量，结果对 $1000000007$ 取模。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3121", "type": "P", "difficulty": 5, "samples": [["begintheescapexecutionatthebreakofdawn \n2 \nescape \nexecution \n", "beginthatthebreakofdawn \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2015", "USACO", "哈希 hashing", "栈", "AC 自动机"], "title": "[USACO15FEB] Censoring G", "background": "", "description": "FJ 把杂志上所有的文章摘抄了下来并把它变成了一个长度不超过 $10^5$ 的字符串 $s$。他有一个包含 $n$ 个单词的列表，列表里的 $n$ 个单词记为 $t_1 \\cdots t_n$。他希望从 $s$ 中删除这些单词。\n\nFJ 每次在 $s$ 中找到最早出现的列表中的单词（最早出现指该单词的开始位置最小），然后从 $s$ 中删除这个单词。他重复这个操作直到 $s$ 中没有列表里的单词为止。注意删除一个单词后可能会导致 $s$ 中出现另一个列表中的单词。\n\nFJ 注意到列表中的单词不会出现一个单词是另一个单词子串的情况，这意味着每个列表中的单词在 $s$ 中出现的开始位置是互不相同的。\n\n请帮助 FJ 完成这些操作并输出最后的 $s$。", "inputFormat": "第一行是一个字符串，表示文章 $s$。\n\n第二行有一个整数，表示单词列表的单词个数 $n$。\n\n第 $3$ 到第 $(n + 2)$ 行，每行一个字符串，第 $(i + 2)$ 行的字符串 $t_i$ 表示第 $i$ 个单词。", "outputFormat": "输出一行一个字符串，表示操作结束后的 $s$。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq |s|, \\sum\\limits_{i = 1}^n |t_i|, n \\leq 10^5$。\n- 字符串均只含小写字母。\n- 操作结束后 $s$ 不会被删成空串。\n- 对于所有的 $i \\neq j$，$t_i$ 不是 $t_j$ 的子串。\n\n其中对于一个字符串 $x$，约定 $|x|$ 表示 $x$ 的长度。\n\n---\n\n#### 提示\n\n操作过程中 $s$ 有可能某一个前缀子串被完全删除，请格外注意这一点。\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO15FEB] Censoring G", "background": "", "description": "FJ copied all the articles from a magazine and turned them into a string $s$ of length at most $10^5$. He has a list of $n$ words, denoted by $t_1 \\cdots t_n$. He wants to delete these words from $s$.\n\nEach time, FJ finds in $s$ the earliest occurrence of any word from the list (the earliest occurrence means the smallest starting position), and then deletes that word from $s$. He repeats this operation until no listed word remains in $s$. Note that deleting a word may cause another listed word to appear in $s$.\n\nFJ noticed that within the list, no word is a substring of another, which implies that the starting positions of occurrences of listed words in $s$ are pairwise distinct.\n\nPlease help FJ perform these operations and output the final $s$.", "inputFormat": "The first line contains a string, the article $s$.\n\nThe second line contains an integer, the number of words in the list $n$.\n\nLines $3$ through $(n + 2)$ each contain a string; the string on line $(i + 2)$, $t_i$, denotes the $i$-th word.", "outputFormat": "Output a single line containing the string $s$ after all operations.", "hint": "#### Constraints\n\nFor all test points, it is guaranteed that:\n\n- $1 \\leq |s|, \\sum\\limits_{i = 1}^n |t_i|, n \\leq 10^5$.\n- All strings contain only lowercase letters.\n- After the operations finish, $s$ will not become an empty string.\n- For all $i \\neq j$, $t_i$ is not a substring of $t_j$.\n\nHere, for a string $x$, $|x|$ denotes its length.\n\n---\n\n#### Hint\n\nDuring the process, a prefix of $s$ may be completely deleted; pay special attention to this.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Censoring G", "background": "", "description": "FJ 把杂志上所有的文章摘抄了下来并把它变成了一个长度不超过 $10^5$ 的字符串 $s$。他有一个包含 $n$ 个单词的列表，列表里的 $n$ 个单词记为 $t_1 \\cdots t_n$。他希望从 $s$ 中删除这些单词。\n\nFJ 每次在 $s$ 中找到最早出现的列表中的单词（最早出现指该单词的开始位置最小），然后从 $s$ 中删除这个单词。他重复这个操作直到 $s$ 中没有列表里的单词为止。注意删除一个单词后可能会导致 $s$ 中出现另一个列表中的单词。\n\nFJ 注意到列表中的单词不会出现一个单词是另一个单词子串的情况，这意味着每个列表中的单词在 $s$ 中出现的开始位置是互不相同的。\n\n请帮助 FJ 完成这些操作并输出最后的 $s$。", "inputFormat": "第一行是一个字符串，表示文章 $s$。\n\n第二行有一个整数，表示单词列表的单词个数 $n$。\n\n第 $3$ 到第 $(n + 2)$ 行，每行一个字符串，第 $(i + 2)$ 行的字符串 $t_i$ 表示第 $i$ 个单词。", "outputFormat": "输出一行一个字符串，表示操作结束后的 $s$。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq |s|, \\sum\\limits_{i = 1}^n |t_i|, n \\leq 10^5$。\n- 字符串均只含小写字母。\n- 操作结束后 $s$ 不会被删成空串。\n- 对于所有的 $i \\neq j$，$t_i$ 不是 $t_j$ 的子串。\n\n其中对于一个字符串 $x$，约定 $|x|$ 表示 $x$ 的长度。\n\n---\n\n#### 提示\n\n操作过程中 $s$ 有可能某一个前缀子串被完全删除，请格外注意这一点。\n", "locale": "zh-CN"}}}
{"pid": "P3122", "type": "P", "difficulty": 6, "samples": [["3 4 \n0 0 \n0 1 \n1 0 \n2 2 2 3 \n1 1 1 \n2 2 2 3 \n2 0 1 1 \n", "YES \nNO \nNO \n\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["计算几何", "2015", "USACO", "cdq 分治", "凸包"], "title": "[USACO15FEB] Fencing the Herd G", "background": "", "description": "Farmer John 需要你帮助他决定在哪里建造形状是一条无限长的直线的栅栏来限制他的牛的活动。他选出了几个可能的建造栅栏的位置，你需要帮助他判断哪些栅栏是有用的。一个栅栏是有用的当且仅当所有奶牛都在栅栏的同一侧。（如果有牛群在栅栏所在的直线上，那么栅栏是没用的），Farmer John 将会多次询问你一个栅栏是否有用，如果这个栅栏是有用的，需要输出 `YES`，反之输出 `NO`。\n\n另外，Farmer John 也可能会带来一些新的奶牛加入这个牛群。一头牛加入之后，以后的所有询问中，这头牛也需要与其它的牛在栅栏的同一侧。\n", "inputFormat": "\n第一行，两个正整数 $n,q$，表示初始时牛群的数量与询问个数；\n\n后 $n$ 行，每行两个整数 $x,y$，表示一个牛群的初始位置；\n\n后 $q$ 行，每行多个整数，表示一次询问，询问的格式如下：\n\n- 1 $x$ $y$：表示一个新的牛群加入了牧场，驻留在 $(x,y)$ 上；\n- 2 $A$ $B$ $C$：表示 Farmer John 询问栅栏 $Ax+By=C$ 是否有用。", "outputFormat": "对于每个 $2$ 类型的询问，如果栅栏有用，输出 `YES`，否则输出 `NO`。\n", "hint": "直线 $2x+2y=3$ 使得初始的三个牛群都在同侧；然而在该栅栏另一侧的牛群 $(1,1)$ 的加入使得它没有用了。\n\n直线 $y=1$ 没用因为牛群 $(0,1)$，$(1,1)$ 恰好在它上面。\n\n---\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5$，$1\\leq q\\leq 10^5$，所有牛群的坐标都各不相同且满足 $-10^9\\leq x,y\\leq 10^9$，$-10^9\\leq A,B\\leq 10^9$，$-10^{18}\\leq C\\leq 10^{18}$。\n\n数据保证不存在栅栏满足 $A=B=0$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO15FEB] Fencing the Herd G", "background": "", "description": "Farmer John needs your help deciding where to build a fence shaped as an infinitely long straight line to restrict the movement of his cows. He has selected several candidate positions for building the fence, and you need to determine which fences are useful. A fence is useful if and only if all cows lie on the same side of the fence. If any cow lies exactly on the fence line, then the fence is useless. Farmer John will ask you multiple times whether a fence is useful; for each query, output YES if the fence is useful, otherwise output NO.\n\nAdditionally, Farmer John may bring in new cows to join the herd. After a cow joins, it must be considered in all subsequent queries and must also lie on the same side of the fence as the other cows.", "inputFormat": "The first line contains two positive integers $n, q$, the initial number of cows and the number of queries.\n\nThe next $n$ lines each contain two integers $x, y$, the initial positions of the cows.\n\nThe next $q$ lines each describe a query in one of the following formats:\n- 1 $x$ $y$: a new cow joins the pasture at $(x, y)$.\n- 2 $A$ $B$ $C$: Farmer John asks whether the fence $Ax + By = C$ is useful.", "outputFormat": "For each query of type $2$, output YES if the fence is useful, otherwise output NO.", "hint": "The line $2x + 2y = 3$ places all three initial cows on the same side; however, adding the cow $(1, 1)$ on the other side makes it useless.\n\nThe line $y = 1$ is useless because cows $(0, 1)$ and $(1, 1)$ lie exactly on it.\n\n---\n\nConstraints.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\leq n \\leq 10^5$, $1 \\leq q \\leq 10^5$, all cows have distinct coordinates and satisfy $-10^9 \\leq x, y \\leq 10^9$, $-10^9 \\leq A, B \\leq 10^9$, $-10^{18} \\leq C \\leq 10^{18}$.\n\nIt is guaranteed that there is no fence with $A = B = 0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Fencing the Herd G", "background": "", "description": "Farmer John 需要你帮助他决定在哪里建造形状是一条无限长的直线的栅栏来限制他的牛的活动。他选出了几个可能的建造栅栏的位置，你需要帮助他判断哪些栅栏是有用的。一个栅栏是有用的当且仅当所有奶牛都在栅栏的同一侧。（如果有牛群在栅栏所在的直线上，那么栅栏是没用的），Farmer John 将会多次询问你一个栅栏是否有用，如果这个栅栏是有用的，需要输出 `YES`，反之输出 `NO`。\n\n另外，Farmer John 也可能会带来一些新的奶牛加入这个牛群。一头牛加入之后，以后的所有询问中，这头牛也需要与其它的牛在栅栏的同一侧。\n", "inputFormat": "\n第一行，两个正整数 $n,q$，表示初始时牛群的数量与询问个数；\n\n后 $n$ 行，每行两个整数 $x,y$，表示一个牛群的初始位置；\n\n后 $q$ 行，每行多个整数，表示一次询问，询问的格式如下：\n\n- 1 $x$ $y$：表示一个新的牛群加入了牧场，驻留在 $(x,y)$ 上；\n- 2 $A$ $B$ $C$：表示 Farmer John 询问栅栏 $Ax+By=C$ 是否有用。", "outputFormat": "对于每个 $2$ 类型的询问，如果栅栏有用，输出 `YES`，否则输出 `NO`。\n", "hint": "直线 $2x+2y=3$ 使得初始的三个牛群都在同侧；然而在该栅栏另一侧的牛群 $(1,1)$ 的加入使得它没有用了。\n\n直线 $y=1$ 没用因为牛群 $(0,1)$，$(1,1)$ 恰好在它上面。\n\n---\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5$，$1\\leq q\\leq 10^5$，所有牛群的坐标都各不相同且满足 $-10^9\\leq x,y\\leq 10^9$，$-10^9\\leq A,B\\leq 10^9$，$-10^{18}\\leq C\\leq 10^{18}$。\n\n数据保证不存在栅栏满足 $A=B=0$。", "locale": "zh-CN"}}}
{"pid": "P3123", "type": "P", "difficulty": 3, "samples": [["10\nB 2\nE 5\nS 7\nI 10\nO 16\nM 19\nB 3\nG 1\nI 9\nM 2", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2015", "USACO", "枚举"], "title": "[USACO15OPEN] Bessie Goes Moo S", "background": "", "description": "Farmer John and Bessie the cow love to exchange math puzzles in their free time.\n\nThe last puzzle FJ gave Bessie was quite difficult and she failed to solve it.\n\nNow she wants to get even with FJ by giving him a challenging puzzle.\n\nBessie gives FJ the expression $(B+E+S+S+I+E)(G+O+E+S)(M+O+O)$, containing the seven variables $B,E,S,I,G,O,M$ (the \"$O$\" is a variable, not a zero).  For each variable, she gives FJ a list of up to 500 integer values the variable can possibly take.\n\nShe asks FJ to count the number of different ways he can assign values to the variables so the entire expression evaluates to a multiple of 7.\n\nNote that the answer to this problem can be too large to fit into a 32-bit integer, so you probably want to use 64-bit integers (e.g., \"long long\"s in C or C++).", "inputFormat": "The first line of the input contains an integer $N$.  The next $N$ lines each contain a variable and a possible value for that variable.  \n\nEach variable will appear in this list at least once and at most 500 times. No possible value will be listed more than once for the same variable. All possible values will be in the range $-10^5$ to $10^5$.\n", "outputFormat": "Print a single integer, giving the number of ways FJ can assign values to variables so the expression above evaluates to a multiple of 7.\n", "hint": "The two possible assignments are\n\n\n(B,E,S,I,G,O,M) = (2, 5, 7, 9,  1, 16, 19) -> 51,765\n\n(B,E,S,I,G,O,B) = (2, 5, 7, 9,  1, 16, 2 ) -> 34,510\n", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Bessie Goes Moo S", "background": "", "description": "Farmer John and Bessie the cow love to exchange math puzzles in their free time.\n\nThe last puzzle FJ gave Bessie was quite difficult and she failed to solve it.\n\nNow she wants to get even with FJ by giving him a challenging puzzle.\n\nBessie gives FJ the expression $(B+E+S+S+I+E)(G+O+E+S)(M+O+O)$, containing the seven variables $B,E,S,I,G,O,M$ (the \"$O$\" is a variable, not a zero).  For each variable, she gives FJ a list of up to 500 integer values the variable can possibly take.\n\nShe asks FJ to count the number of different ways he can assign values to the variables so the entire expression evaluates to a multiple of 7.\n\nNote that the answer to this problem can be too large to fit into a 32-bit integer, so you probably want to use 64-bit integers (e.g., \"long long\"s in C or C++).", "inputFormat": "The first line of the input contains an integer $N$.  The next $N$ lines each contain a variable and a possible value for that variable.  \n\nEach variable will appear in this list at least once and at most 500 times. No possible value will be listed more than once for the same variable. All possible values will be in the range $-10^5$ to $10^5$.\n", "outputFormat": "Print a single integer, giving the number of ways FJ can assign values to variables so the expression above evaluates to a multiple of 7.\n", "hint": "The two possible assignments are\n\n\n(B,E,S,I,G,O,M) = (2, 5, 7, 9,  1, 16, 19) -> 51,765\n\n(B,E,S,I,G,O,B) = (2, 5, 7, 9,  1, 16, 2 ) -> 34,510\n", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Bessie Goes Moo S", "background": null, "description": "Farmer John 和奶牛 Bessie 喜欢在空闲时间互相出数学谜题。\n\n上一次 FJ 给 Bessie 出的谜题非常难，她没能解出来。\n\n现在，她想通过给 FJ 出一个有挑战性的谜题来报复他。\n\nBessie 给 FJ 的表达式是 $(B+E+S+S+I+E)(G+O+E+S)(M+O+O)$，其中包含七个变量 $B,E,S,I,G,O,M$（\"$O$\" 是一个变量，不是零）。对于每个变量，她给 FJ 提供了一个最多包含 500 个整数值的列表，表示该变量可能取的值。\n\n她要求 FJ 计算有多少种不同的方式可以为这些变量赋值，使得整个表达式的值是 7 的倍数。\n\n注意，这个问题的答案可能太大，无法用 32 位整数表示，因此你可能需要使用 64 位整数（例如，C 或 C++ 中的 \"long long\"）。", "inputFormat": "输入的第一行包含一个整数 $N$。接下来的 $N$ 行每行包含一个变量及其可能的值。\n\n每个变量在这个列表中至少出现一次，最多出现 500 次。对于同一个变量，不会列出重复的可能值。所有可能的值都在 $-10^5$ 到 $10^5$ 的范围内。", "outputFormat": "输出一个整数，表示 FJ 可以为变量赋值的方式数，使得上述表达式的值是 7 的倍数。", "hint": "两种可能的赋值方式是：\n\n$(B,E,S,I,G,O,M) = (2, 5, 7, 9, 1, 16, 19)$ -> 51,765\n\n$(B,E,S,I,G,O,M) = (2, 5, 7, 9, 1, 16, 2)$ -> 34,510", "locale": "zh-CN"}}}
{"pid": "P3124", "type": "P", "difficulty": 5, "samples": [["5 7\n8 1\n1 4\n3 8\n12 15\n20 20", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2015", "USACO", "排序"], "title": "[USACO15OPEN] Trapped in the Haybales S", "background": "", "description": "Farmer John has received a shipment of $N$ large hay bales ($1 \\le N \\le 100,000$), and placed them at various locations along the road connecting the barn with his house.  Each bale $j$ has a size $S_j$ and a distinct position $P_j$ giving its location along the one-dimensional road. Bessie the cow is currently located at position $B$, where there is no hay bale.\n\nBessie the cow can move around freely along the road, even up to the position at which a bale is located, but she cannot cross through this position.  As an exception, if she runs in the same direction for $D$ units of distance, she builds up enough speed to break through and permanently eliminate any hay bale of size strictly less than $D$. Of course, after doing this, she might open up more space to allow her to make a run at other hay bales, eliminating them as well.\n\nFJ is currently re-painting his house and his barn, and wants to make sure Bessie cannot reach either one (cows and fresh paint do not make a good combination!)  Accordingly, FJ wants to make sure Bessie never breaks through the leftmost or rightmost hay bale, so she stays effectively trapped within the hay bales.  FJ has the ability to add hay to a single bale of his choosing to help keep Bessie trapped.  Please help him determine the minimum amount of extra size he needs to add to some bale to ensure Bessie stays trapped.", "inputFormat": "The first line of input contains $N$ as well as Bessie's initial position $B$. Each of the next $N$ lines describes a bale, and contains two integers giving its size and position.  All sizes and positions are in the range $1\\ldots 10^9$.\n", "outputFormat": "Print a single integer, giving the minimum amount of hay FJ needs to add to prevent Bessie from escaping.  Print -1 if it is impossible to prevent Bessie's escape.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Trapped in the Haybales S", "background": "", "description": "Farmer John has received a shipment of $N$ large hay bales ($1 \\le N \\le 100,000$), and placed them at various locations along the road connecting the barn with his house.  Each bale $j$ has a size $S_j$ and a distinct position $P_j$ giving its location along the one-dimensional road. Bessie the cow is currently located at position $B$, where there is no hay bale.\n\nBessie the cow can move around freely along the road, even up to the position at which a bale is located, but she cannot cross through this position.  As an exception, if she runs in the same direction for $D$ units of distance, she builds up enough speed to break through and permanently eliminate any hay bale of size strictly less than $D$. Of course, after doing this, she might open up more space to allow her to make a run at other hay bales, eliminating them as well.\n\nFJ is currently re-painting his house and his barn, and wants to make sure Bessie cannot reach either one (cows and fresh paint do not make a good combination!)  Accordingly, FJ wants to make sure Bessie never breaks through the leftmost or rightmost hay bale, so she stays effectively trapped within the hay bales.  FJ has the ability to add hay to a single bale of his choosing to help keep Bessie trapped.  Please help him determine the minimum amount of extra size he needs to add to some bale to ensure Bessie stays trapped.", "inputFormat": "The first line of input contains $N$ as well as Bessie's initial position $B$. Each of the next $N$ lines describes a bale, and contains two integers giving its size and position.  All sizes and positions are in the range $1\\ldots 10^9$.\n", "outputFormat": "Print a single integer, giving the minimum amount of hay FJ needs to add to prevent Bessie from escaping.  Print -1 if it is impossible to prevent Bessie's escape.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Trapped in the Haybales S", "background": "", "description": "FJ 收到了 $N$ 捆干草，并将它们放置在连接房屋与谷仓的道路上。第 $j$ 捆干草的大小为 $S_j$，位置为 $P_j$。Bessie 一开始在 $B$ 处，不与任何一捆干草的位置重合。\n\nBessie 可以在干草捆之间任意移动（也可以到达干草捆所在的位置），但不能越过干草捆。但凡事总有例外：当 Bessie 进行了长度为 $D$ 的冲刺后，她就可以击碎一捆大小严格小于 $D$ 的干草，这意味着这捆干草不复存在。\n\n由于某些原因，FJ 希望把 Bessie 困在最左边与最右边的干草捆之间。为此，他希望将某一捆干草的大小增加一些。如果可能把 Bessie 困住，请输出他最少需要增加多少干草；否则输出 `-1`。\n\n$1 \\leqslant N \\leqslant 10^5$，$1 \\leqslant S_i, P_i, B \\leqslant 10^9$。", "inputFormat": "第一行，两个整数 $N, B$，分别表示干草捆数量与 Bessie 所在位置。\n\n接下来 $N$ 行，第 $i$ 行为两个整数 $S_i, P_i$，分别表示第 $i$ 捆干草的大小与位置。", "outputFormat": "如果可能把 Bessie 困住，输出一行一个整数，表示最少需要增加多少干草；否则输出 `-1`。\n\nTranslated by [KHIN](/user/236807).", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3125", "type": "P", "difficulty": 5, "samples": [["5 2\n4 1 2\n1 3 1 3 4\n6 2 2 5\n5 2 2 5\n2 2 3 4", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "USACO", "最短路"], "title": "[USACO15OPEN] Bessie's Birthday Buffet S", "background": "", "description": "For Bessie the cow’s birthday, Farmer John has given her free reign over one of his best fields to eat grass.\n\nThe field is covered in $N$ patches of grass ($1 \\le N \\le 1000$), conveniently numbered $1\\ldots N$, that each have a distinct quality value.  If Bessie eats grass of quality $Q$, she gains $Q$ units of energy.  Each patch is connected to up to 10 neighboring patches via bi-directional paths, and it takes Bessie $E$ units of energy to move between adjacent patches ($1 \\le E \\le 1,000,000$).\n\nBessie can choose to start grazing in any patch she wishes, and she wants to stop grazing once she has accumulated a maximum amount of energy.\n\nUnfortunately, Bessie is a picky bovine, and once she eats grass of a certain quality, she’ll never eat grass at or below that quality level again!  She is still happy to walk through patches without eating their grass; in fact, she might find it beneficial to walk through a patch of high-quality grass without eating it, only to return later for a tasty snack.\n\nPlease help determine the maximum amount of energy Bessie can accumulate.", "inputFormat": "The first line of input contains $N$ and $E$.  Each of the remaining $N$ lines describe a patch of grass.  They contain two integers $Q$ and $D$ giving the quality of the patch (in the range $1\\ldots 1,000,000$) and its number of neighbors.  The remaining $D$ numbers on the line specify the neighbors.", "outputFormat": "Please output the maximum amount of energy Bessie can accumulate.", "hint": "Bessie starts at patch 4 gaining 5 units of energy from the grass there. She then takes the path to patch 5 losing 2 units of energy during her travel. She refuses to eat the lower quality grass at patch 5 and travels to patch 3 again losing 2 units of energy.  Finally she eats the grass at patch 3 gaining 6 units of energy for a total of 7 energy.\n\nNote that the sample case above is different from test case 1 when you submit.", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Bessie's Birthday Buffet S", "background": "", "description": "For Bessie the cow’s birthday, Farmer John has given her free reign over one of his best fields to eat grass.\n\nThe field is covered in $N$ patches of grass ($1 \\le N \\le 1000$), conveniently numbered $1\\ldots N$, that each have a distinct quality value.  If Bessie eats grass of quality $Q$, she gains $Q$ units of energy.  Each patch is connected to up to 10 neighboring patches via bi-directional paths, and it takes Bessie $E$ units of energy to move between adjacent patches ($1 \\le E \\le 1,000,000$).\n\nBessie can choose to start grazing in any patch she wishes, and she wants to stop grazing once she has accumulated a maximum amount of energy.\n\nUnfortunately, Bessie is a picky bovine, and once she eats grass of a certain quality, she’ll never eat grass at or below that quality level again!  She is still happy to walk through patches without eating their grass; in fact, she might find it beneficial to walk through a patch of high-quality grass without eating it, only to return later for a tasty snack.\n\nPlease help determine the maximum amount of energy Bessie can accumulate.", "inputFormat": "The first line of input contains $N$ and $E$.  Each of the remaining $N$ lines describe a patch of grass.  They contain two integers $Q$ and $D$ giving the quality of the patch (in the range $1\\ldots 1,000,000$) and its number of neighbors.  The remaining $D$ numbers on the line specify the neighbors.", "outputFormat": "Please output the maximum amount of energy Bessie can accumulate.", "hint": "Bessie starts at patch 4 gaining 5 units of energy from the grass there. She then takes the path to patch 5 losing 2 units of energy during her travel. She refuses to eat the lower quality grass at patch 5 and travels to patch 3 again losing 2 units of energy.  Finally she eats the grass at patch 3 gaining 6 units of energy for a total of 7 energy.\n\nNote that the sample case above is different from test case 1 when you submit.", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Bessie's Birthday Buffet S", "background": null, "description": "为了庆祝奶牛 Bessie 的生日，Farmer John 允许她在他最好的草地上自由吃草。\n\n这片草地被划分为 $N$ 块草皮（$1 \\le N \\le 1000$），编号为 $1\\ldots N$，每块草皮都有一个独特的质量值。如果 Bessie 吃了质量为 $Q$ 的草，她会获得 $Q$ 单位的能量。每块草皮通过双向路径与最多 10 个相邻草皮相连，Bessie 在相邻草皮之间移动需要消耗 $E$ 单位的能量（$1 \\le E \\le 1,000,000$）。\n\nBessie 可以选择从任意一块草皮开始吃草，她希望在积累最大能量后停止吃草。\n\n不幸的是，Bessie 是一头挑剔的牛，一旦她吃了某种质量的草，她就再也不会吃质量等于或低于该水平的草了！她仍然乐意在不吃草的情况下穿过草皮；事实上，她可能会发现穿过一块高质量草皮而不吃草是有益的，只是为了稍后再回来享用美味的小吃。\n\n请帮助确定 Bessie 能够积累的最大能量。", "inputFormat": "输入的第一行包含 $N$ 和 $E$。接下来的 $N$ 行描述每块草皮。每行包含两个整数 $Q$ 和 $D$，分别表示草皮的质量（范围为 $1\\ldots 1,000,000$）和它相邻的草皮数量。该行剩下的 $D$ 个数字指定了它相邻的草皮的编号。", "outputFormat": "请输出 Bessie 能够积累的最大能量。", "hint": "Bessie 从草皮 4 开始，获得 5 单位的能量。然后她沿着路径移动到草皮 5，在移动过程中消耗了 2 单位的能量。她拒绝吃草皮 5 上质量较低的草，并继续移动到草皮 3，再次消耗了 2 单位的能量。最后，她吃了草皮 3 上的草，获得了 6 单位的能量，总共积累了 7 单位的能量。\n\n请注意，上述样例与提交时的测试用例 1 不同。", "locale": "zh-CN"}}}
{"pid": "P3126", "type": "P", "difficulty": 5, "samples": [["4\nABCD\nBXZX\nCDXB\nWCBA", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "动态规划 DP", "2015", "USACO", "枚举"], "title": "[USACO15OPEN] Palindromic Paths G", "background": "", "description": "Farmer John's farm is in the shape of an $N \\times N$ grid of fields ($1 \\le N \\le 500$), each labeled with a letter in the alphabet.  For example:\n\n```cpp\nABCD\nBXZX\nCDXB\nWCBA\n```\nEach day, Bessie the cow walks from the upper-left field to the lower-right field, each step taking her either one field to the right or one field downward. Bessie keeps track of the string that she generates during this process, built from the letters she walks across. She gets very disoriented, however, if this string is a palindrome (reading the same forward as backward), since she gets confused about which direction she had walked. Please help Bessie determine the number of distinct routes she can take that  correspond to palindromes. Different ways of obtaining the same palindrome count multiple times. Please print your answer modulo 1,000,000,007.", "inputFormat": "The first line of input contains $N$, and the remaining $N$ lines contain the $N$ rows of the grid of fields. Each row contains $N$ characters that are in the range A..Z.", "outputFormat": "Please output the number of distinct palindromic routes Bessie can take, modulo 1,000,000,007.", "hint": "Bessie can make the following palindromes\n\n1 x \"ABCDCBA\"\n\n1 x \"ABCWCBA\"\n\n6 x \"ABXZXBA\"\n\n4 x \"ABXDXBA\"\n", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Palindromic Paths G", "background": "", "description": "Farmer John's farm is in the shape of an $N \\times N$ grid of fields ($1 \\le N \\le 500$), each labeled with a letter in the alphabet.  For example:\n\n```cpp\nABCD\nBXZX\nCDXB\nWCBA\n```\nEach day, Bessie the cow walks from the upper-left field to the lower-right field, each step taking her either one field to the right or one field downward. Bessie keeps track of the string that she generates during this process, built from the letters she walks across. She gets very disoriented, however, if this string is a palindrome (reading the same forward as backward), since she gets confused about which direction she had walked. Please help Bessie determine the number of distinct routes she can take that  correspond to palindromes. Different ways of obtaining the same palindrome count multiple times. Please print your answer modulo 1,000,000,007.", "inputFormat": "The first line of input contains $N$, and the remaining $N$ lines contain the $N$ rows of the grid of fields. Each row contains $N$ characters that are in the range A..Z.", "outputFormat": "Please output the number of distinct palindromic routes Bessie can take, modulo 1,000,000,007.", "hint": "Bessie can make the following palindromes\n\n1 x \"ABCDCBA\"\n\n1 x \"ABCWCBA\"\n\n6 x \"ABXZXBA\"\n\n4 x \"ABXDXBA\"\n", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Palindromic Paths G", "background": "", "description": "Farmer John 的农场是一个 $N \\times N$ 的网格（$1 \\le N \\le 500$），每个格子标有一个字母。例如：\n\n```\nABCD\nBXZX\nCDXB\nWCBA\n```\n\n每天，奶牛 Bessie 从左上角的格子走到右下角的格子，每一步只能向右或向下移动一个格子。Bessie 会记录下她走过的路径所生成的字符串，这个字符串由她经过的格子上的字母组成。然而，如果这个字符串是一个回文串（即正读和反读相同），她会感到非常困惑，因为她会分不清自己走过的方向。请帮助 Bessie 计算她可以走的不同路径中，对应回文串的数量。即使生成相同回文串的方式不同，也需要分别计数。请输出答案对 1,000,000,007 取模的结果。", "inputFormat": "输入的第一行包含 $N$，接下来的 $N$ 行包含网格的 $N$ 行。每行包含 $N$ 个字符，字符范围为 A..Z。", "outputFormat": "请输出 Bessie 可以走的不同回文路径的数量，对 1,000,000,007 取模。", "hint": "Bessie 可以生成以下回文串：\n\n- 1 个 \"ABCDCBA\"\n- 1 个 \"ABCWCBA\"\n- 6 个 \"ABXZXBA\"\n- 4 个 \"ABXDXBA\"", "locale": "zh-CN"}}}
{"pid": "P3127", "type": "P", "difficulty": 5, "samples": [["5\n8 1\n1 4\n8 8\n7 15\n4 20", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "USACO", "并查集", "离散化", "枚举"], "title": "[USACO15OPEN] Trapped in the Haybales G", "background": "", "description": "Farmer John has received a shipment of N large hay bales ($1 \\le N \\le 100,000$), and placed them at various locations along the road leading to his barn. Unfortunately, he completely forgets that Bessie the cow is out grazing along the road, and she may now be trapped within the bales! Each bale $j$ has a size $S_j$ and a position $P_j$ giving its location along the one-dimensional road.  Bessie the cow can move around freely along the road, even up to the position at which a bale is located, but she cannot cross through this position.  As an exception, if she runs in the same direction for $D$ units of distance, she builds up enough speed to break through and permanently eliminate any hay bale of size strictly less than $D$.  Of course, after doing this, she might open up more space to allow her to make a run at other hay bales, eliminating them as well.\n\nBessie can escape to freedom if she can eventually break through either the  leftmost or rightmost hay bale.  Please compute the total area of the road consisting of real-valued starting positions from which Bessie cannot escape.\n\n", "inputFormat": "The first line of input contains $N$.  Each of the next $N$ lines describes a bale, and contains two integers giving its size and position, each in the range $1\\ldots 10^9$. All positions are distinct.\n", "outputFormat": "Print a single integer, giving the area of the road from which Bessie cannot escape.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Trapped in the Haybales G", "background": "", "description": "Farmer John has received a shipment of N large hay bales ($1 \\le N \\le 100,000$), and placed them at various locations along the road leading to his barn. Unfortunately, he completely forgets that Bessie the cow is out grazing along the road, and she may now be trapped within the bales! Each bale $j$ has a size $S_j$ and a position $P_j$ giving its location along the one-dimensional road.  Bessie the cow can move around freely along the road, even up to the position at which a bale is located, but she cannot cross through this position.  As an exception, if she runs in the same direction for $D$ units of distance, she builds up enough speed to break through and permanently eliminate any hay bale of size strictly less than $D$.  Of course, after doing this, she might open up more space to allow her to make a run at other hay bales, eliminating them as well.\n\nBessie can escape to freedom if she can eventually break through either the  leftmost or rightmost hay bale.  Please compute the total area of the road consisting of real-valued starting positions from which Bessie cannot escape.\n\n", "inputFormat": "The first line of input contains $N$.  Each of the next $N$ lines describes a bale, and contains two integers giving its size and position, each in the range $1\\ldots 10^9$. All positions are distinct.\n", "outputFormat": "Print a single integer, giving the area of the road from which Bessie cannot escape.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Trapped in the Haybales G", "background": "", "description": "Farmer John 收到了一批 $N$ 个大型干草捆（$1 \\le N \\le 100,000$），并将它们放置在他通往谷仓的道路上的不同位置。不幸的是，他完全忘记了奶牛 Bessie 正在这条路上吃草，她现在可能被困在这些干草捆之间了！每个干草捆 $j$ 有一个大小 $S_j$ 和一个位置 $P_j$，表示它在这条一维道路上的位置。Bessie 可以在道路上自由移动，甚至可以移动到干草捆所在的位置，但她无法穿过这个位置。唯一的例外是，如果她朝同一方向连续移动 $D$ 单位的距离，她将获得足够的速度，能够突破并永久消除任何大小严格小于 $D$ 的干草捆。当然，在突破之后，她可能会打开更多的空间，从而有机会突破其他干草捆，并继续消除它们。\n\n如果 Bessie 最终能够突破最左侧或最右侧的干草捆，她就可以成功逃脱。请计算道路中所有无法逃脱的实数起始位置的总面积。", "inputFormat": "输入的第一行包含 $N$。接下来的 $N$ 行描述每个干草捆，每行包含两个整数，分别表示干草捆的大小和位置，范围均为 $1 \\ldots 10^9$。所有位置均不相同。", "outputFormat": "输出一个整数，表示 Bessie 无法逃脱的道路总面积。", "hint": "", "locale": "zh-CN"}}}
