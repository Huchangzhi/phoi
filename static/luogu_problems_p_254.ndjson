{"pid": "P6138", "type": "P", "difficulty": 6, "samples": [["5 3 3\n1 0 2 4\n1 3\n0 1\n0 1\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "IOI"], "title": "[IOI 2012] 骑马比武竞赛", "background": "", "description": "1491 年公爵 Milan Lodovico Sforza 为了他与 Beatrice d'Este 的婚礼，要求Leonardo 来负责筹备婚礼的庆典。在这个庆典中包含了一个盛大的持续三天的骑马比武竞赛，但是最受欢迎的骑士迟到了...\n\n在一骑马比武的竞赛，$N$ 个骑士一开始被排成一排然后按照他们的位置从 $0$ 到 $N-1$ 开始编号。骑马比武的主持人每一回合叫出两个位置 $S$ 跟 $E$ （其中 $0 \\le S < E \\le N - 1$）。所有介于 $S$ 与 $E$ （含） 这两个位置的骑士则开始进行骑马比武。最后的赢家可以留下来继续进行竞赛， 并回到他原来的位置，而输家则离开这个竞赛。在这之后，剩下的骑士按照原来排列的顺 序，往前挤掉空出来的位置。所以他们的位置编号变成从 $0$ 到 $N - (E - S) - 1$。骑马比武竞赛的主持人接着进行下一个回合的比赛，直到最后剩下唯一个骑士。\n\nLeonardo 知道所有骑士有不同的强度，这个强度从 $0$ (最弱) 到 $N-1$ (最强)。他也知道骑马比武竞赛的主持人会下怎么样的命令来进行C回合的竞赛，毕竟他是无所不能的   Leonardo。而且他也确定在每一个回合中，拥有最大强度的骑士会获得胜利。\n\n$N$ 个骑士中的 $N-1$ 个骑士已经排成了一排，只是最受欢迎的骑士还未出现。这个骑士的强度为 $R$ 但是他迟到了。为了让这场竞赛达到最高潮, Leonardo  想要让这个骑士能好好展现他的风采，所以想要帮他安插一个位置，而这个位置可以使得这个骑士能获得最多回合的 胜利。请注意，我们不关心与此骑士无关的回合。我们只关心包含此骑士而且由他赢得胜利的回合。\n\n**例子**\n\n假设有 $5$ 个骑士，其中 $4$ 个骑士已经排列好，而他们的强度分别是 $[1,0,2,4]$。而迟到骑士的强度为 $3$ 。假设要进行 $3$ 回合，骑马比武的主持人打算要叫出的位置 $(S,E)$ 分别是 $(1, 3)$，$(0, 1)$，$(0, 1)$。\n\n假设 Leonardo  将迟到的骑士插到第一个位置而且迟到的骑士强度为 $3$。那么骑士强度的排列将会是 $[3, 1, 0, 2, 4]$。第一回合参与的骑士为位置 $1,2,3$ 的骑士，他们的强度分别是 $1,0,2$，所以由强度 $2$ 的骑士获得胜利。经过这一回合，新的骑士强度的排列变成 $[3, 2, 4]]$。下一个回合是由强度 $3$ 与强度 $2$（位置 $0,1$）的骑士进行比赛，由强度 $3$ 的骑士获得胜利。而骑士强度的排列则变成 $[3,4]$。最后一回合（位置 $0,1$）由强度 $4$ 的骑士获得胜利。那么，迟到的骑士只有获得一回合的胜利 (第二回合)。\n\n若 Leonardo 将迟到的骑士插入强度 $1$ 与强度 $0$ 的骑士中间，骑士强度的排列将会是 $[1,3,0,2,4]$。这一次,  第一回合比赛的骑士强度为 $3,0,2$。由强度 $3$ 的骑士获胜，然后骑士强度的排列变成 $[1,3,4]$。在第二回合中由强度 $1$ 对上强度 $3$ 的骑士，由强度 $3$ 的骑士获胜。最后的一回合，骑士强度的排列变成  $[3,4]$，由强度 $4$ 的骑士获得胜利。在这个排列中，迟到的骑士获得两回合的胜利。这实际上是最佳的位置，因为没有其他的位置可以让迟到的骑士获得两回合以上的胜利。\n\n你的任务是写一个程序来帮迟到的骑士选择最佳的位置让他能获得最多的胜利回合数，以符合 Leonardo 的期待。", "inputFormat": "- 第一行，$3$个整数 $N$，$C$，$R$，其中 $N$ 表示骑士的个数，$C$ 表示竞赛主持人会进行的回合数，$R$ 表示迟到的骑士的强度。\n- 第二行，$N$ 个整数 $K[0],K[1],\\cdots,K[N-1]$，表示已经排列好成一列的 $N-1$ 个骑士的强度\n- 第三行，$2C$ 个整数 $S[0],E[0],S[1],E[1],\\cdots,E[N-1],S[N-1]$，对于 $0 \\le i \\le C-1$，竞赛主持人进行第 $i +1$ 回合比赛的骑士为从位置 $S[i]$ 到位置 $E[i]$ (含). 你可以假设对每一个 $i$ , $S[i] < E[i]$。", "outputFormat": "共一行，让迟到的骑士能获得最多胜利回合数的位置。如果存在多个最优的位置，输出编号最小的位置。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le C \\le N-1$，在第 $i+1$ 回合，$E[i]$ 会小于这个回合剩下的骑士数量。经过 $C$ 回合的命令之后，只会剩下一个骑士。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[IOI 2012] 骑马比武竞赛", "background": "", "description": "1491 年公爵 Milan Lodovico Sforza 为了他与 Beatrice d'Este 的婚礼，要求Leonardo 来负责筹备婚礼的庆典。在这个庆典中包含了一个盛大的持续三天的骑马比武竞赛，但是最受欢迎的骑士迟到了...\n\n在一骑马比武的竞赛，$N$ 个骑士一开始被排成一排然后按照他们的位置从 $0$ 到 $N-1$ 开始编号。骑马比武的主持人每一回合叫出两个位置 $S$ 跟 $E$ （其中 $0 \\le S < E \\le N - 1$）。所有介于 $S$ 与 $E$ （含） 这两个位置的骑士则开始进行骑马比武。最后的赢家可以留下来继续进行竞赛， 并回到他原来的位置，而输家则离开这个竞赛。在这之后，剩下的骑士按照原来排列的顺 序，往前挤掉空出来的位置。所以他们的位置编号变成从 $0$ 到 $N - (E - S) - 1$。骑马比武竞赛的主持人接着进行下一个回合的比赛，直到最后剩下唯一个骑士。\n\nLeonardo 知道所有骑士有不同的强度，这个强度从 $0$ (最弱) 到 $N-1$ (最强)。他也知道骑马比武竞赛的主持人会下怎么样的命令来进行C回合的竞赛，毕竟他是无所不能的   Leonardo。而且他也确定在每一个回合中，拥有最大强度的骑士会获得胜利。\n\n$N$ 个骑士中的 $N-1$ 个骑士已经排成了一排，只是最受欢迎的骑士还未出现。这个骑士的强度为 $R$ 但是他迟到了。为了让这场竞赛达到最高潮, Leonardo  想要让这个骑士能好好展现他的风采，所以想要帮他安插一个位置，而这个位置可以使得这个骑士能获得最多回合的 胜利。请注意，我们不关心与此骑士无关的回合。我们只关心包含此骑士而且由他赢得胜利的回合。\n\n**例子**\n\n假设有 $5$ 个骑士，其中 $4$ 个骑士已经排列好，而他们的强度分别是 $[1,0,2,4]$。而迟到骑士的强度为 $3$ 。假设要进行 $3$ 回合，骑马比武的主持人打算要叫出的位置 $(S,E)$ 分别是 $(1, 3)$，$(0, 1)$，$(0, 1)$。\n\n假设 Leonardo  将迟到的骑士插到第一个位置而且迟到的骑士强度为 $3$。那么骑士强度的排列将会是 $[3, 1, 0, 2, 4]$。第一回合参与的骑士为位置 $1,2,3$ 的骑士，他们的强度分别是 $1,0,2$，所以由强度 $2$ 的骑士获得胜利。经过这一回合，新的骑士强度的排列变成 $[3, 2, 4]]$。下一个回合是由强度 $3$ 与强度 $2$（位置 $0,1$）的骑士进行比赛，由强度 $3$ 的骑士获得胜利。而骑士强度的排列则变成 $[3,4]$。最后一回合（位置 $0,1$）由强度 $4$ 的骑士获得胜利。那么，迟到的骑士只有获得一回合的胜利 (第二回合)。\n\n若 Leonardo 将迟到的骑士插入强度 $1$ 与强度 $0$ 的骑士中间，骑士强度的排列将会是 $[1,3,0,2,4]$。这一次,  第一回合比赛的骑士强度为 $3,0,2$。由强度 $3$ 的骑士获胜，然后骑士强度的排列变成 $[1,3,4]$。在第二回合中由强度 $1$ 对上强度 $3$ 的骑士，由强度 $3$ 的骑士获胜。最后的一回合，骑士强度的排列变成  $[3,4]$，由强度 $4$ 的骑士获得胜利。在这个排列中，迟到的骑士获得两回合的胜利。这实际上是最佳的位置，因为没有其他的位置可以让迟到的骑士获得两回合以上的胜利。\n\n你的任务是写一个程序来帮迟到的骑士选择最佳的位置让他能获得最多的胜利回合数，以符合 Leonardo 的期待。", "inputFormat": "- 第一行，$3$个整数 $N$，$C$，$R$，其中 $N$ 表示骑士的个数，$C$ 表示竞赛主持人会进行的回合数，$R$ 表示迟到的骑士的强度。\n- 第二行，$N$ 个整数 $K[0],K[1],\\cdots,K[N-1]$，表示已经排列好成一列的 $N-1$ 个骑士的强度\n- 第三行，$2C$ 个整数 $S[0],E[0],S[1],E[1],\\cdots,E[N-1],S[N-1]$，对于 $0 \\le i \\le C-1$，竞赛主持人进行第 $i +1$ 回合比赛的骑士为从位置 $S[i]$ 到位置 $E[i]$ (含). 你可以假设对每一个 $i$ , $S[i] < E[i]$。", "outputFormat": "共一行，让迟到的骑士能获得最多胜利回合数的位置。如果存在多个最优的位置，输出编号最小的位置。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le C \\le N-1$，在第 $i+1$ 回合，$E[i]$ 会小于这个回合剩下的骑士数量。经过 $C$ 回合的命令之后，只会剩下一个骑士。", "locale": "zh-CN"}}}
{"pid": "P6139", "type": "P", "difficulty": 6, "samples": [["4\naa\nab\nbac\ncaa", "10\n10"], ["1\na", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["后缀自动机 SAM", "O2优化", "模板题"], "title": "【模板】广义后缀自动机（广义 SAM）", "background": "管理员备注：本题于 2023 年 5 月 4 日加入输出点数的要求。本题在此之前提交的题解均没有输出点数，特此注明。", "description": "给定 $n$ 个由小写字母组成的字符串 $s_1,s_2\\ldots s_n$，求本质不同的子串个数。（不包含空串）\n\n进一步，设 $Q$ 为能接受 $s_1,s_2,\\dots,s_n$ 的所有后缀的最小 DFA，请你输出 $Q$ 的点数。（如果你无法理解这句话，可以认为就是输出 $s_1,s_2,\\dots,s_n$ 建成的“广义后缀自动机”的点数）。", "inputFormat": "第一行一个正整数 $n$。\n\n以下 $n$ 行，每行一个字符串，第 $i$ 行表示字符串 $s_{i-1}$。", "outputFormat": "第一行一个正整数，为本质不同的子串个数。\n\n第二行一个正整数，为 $Q$ 的点数。", "hint": "数据范围：$1\\le n\\le 4\\cdot 10^5$，$1\\le \\sum{|s_i|}\\le 10^6$。\n\n样例 1 解释：共有 $10$ 个本质不同的子串，它们是：`\"a\",\"b\",\"c\",\"aa\",\"ab\",\"ac\",\"ba\",\"ca\",\"bac\",\"caa\"`。 DFA 结构略去。\n\n样例 2 解释：共有 $1$ 个本质不同的子串，它们是：`\"a\"`。DFA 包含一个起始结点 $S$ 和一个结点 $T$，有一条边 $S\\to T$，其上字符为 `a`。故总结点数为 $2$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】广义后缀自动机（广义 SAM）", "background": "管理员备注：本题于 2023 年 5 月 4 日加入输出点数的要求。本题在此之前提交的题解均没有输出点数，特此注明。", "description": "给定 $n$ 个由小写字母组成的字符串 $s_1,s_2\\ldots s_n$，求本质不同的子串个数。（不包含空串）\n\n进一步，设 $Q$ 为能接受 $s_1,s_2,\\dots,s_n$ 的所有后缀的最小 DFA，请你输出 $Q$ 的点数。（如果你无法理解这句话，可以认为就是输出 $s_1,s_2,\\dots,s_n$ 建成的“广义后缀自动机”的点数）。", "inputFormat": "第一行一个正整数 $n$。\n\n以下 $n$ 行，每行一个字符串，第 $i$ 行表示字符串 $s_{i-1}$。", "outputFormat": "第一行一个正整数，为本质不同的子串个数。\n\n第二行一个正整数，为 $Q$ 的点数。", "hint": "数据范围：$1\\le n\\le 4\\cdot 10^5$，$1\\le \\sum{|s_i|}\\le 10^6$。\n\n样例 1 解释：共有 $10$ 个本质不同的子串，它们是：`\"a\",\"b\",\"c\",\"aa\",\"ab\",\"ac\",\"ba\",\"ca\",\"bac\",\"caa\"`。 DFA 结构略去。\n\n样例 2 解释：共有 $1$ 个本质不同的子串，它们是：`\"a\"`。DFA 包含一个起始结点 $S$ 和一个结点 $T$，有一条边 $S\\to T$，其上字符为 `a`。故总结点数为 $2$。\n", "locale": "zh-CN"}}}
{"pid": "P6140", "type": "P", "difficulty": 3, "samples": [["6\nA\nC\nD\nB\nC\nB", "ABCBCD"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07NOV] Best Cow Line S", "background": "*本题和 [2007 年 12 月月赛金组同名题目](/problem/P2870) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 打算带领 $N$（$1 \\leq N \\leq 2\\,000$）头奶牛参加一年一度的”全美农场主大奖赛“。在这场比赛中，每个参赛者必须让他的奶牛排成一列，然后带领这些奶牛从裁判面前依此走过。\n\n今年，竞赛委员会在接受报名时，采用了一种新的登记规则：取每头奶牛名字的首字母，按照它们在队伍中的次序排成一列。将所有队伍的名字按字典序升序排序，从而得到出场顺序。\n\nFJ 由于事务繁忙，他希望能够尽早出场。因此他决定重排队列。\n\n他的调整方式是这样的：每次，他从原队列的首端或尾端牵出一头奶牛，将她安排到新队列尾部。重复这一操作直到所有奶牛都插入新队列为止。\n\n现在请你帮 FJ 算出按照上面这种方法能排出的字典序最小的队列。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行每行一个大写字母，表示初始队列。", "outputFormat": "输出一个长度为 $N$ 的字符串，表示可能的最小字典序队列。\n\n每输出 $80$ 个字母需要一个换行。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07NOV] Best Cow Line S", "background": "*本题和 [2007 年 12 月月赛金组同名题目](/problem/P2870) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 打算带领 $N$（$1 \\leq N \\leq 2\\,000$）头奶牛参加一年一度的”全美农场主大奖赛“。在这场比赛中，每个参赛者必须让他的奶牛排成一列，然后带领这些奶牛从裁判面前依此走过。\n\n今年，竞赛委员会在接受报名时，采用了一种新的登记规则：取每头奶牛名字的首字母，按照它们在队伍中的次序排成一列。将所有队伍的名字按字典序升序排序，从而得到出场顺序。\n\nFJ 由于事务繁忙，他希望能够尽早出场。因此他决定重排队列。\n\n他的调整方式是这样的：每次，他从原队列的首端或尾端牵出一头奶牛，将她安排到新队列尾部。重复这一操作直到所有奶牛都插入新队列为止。\n\n现在请你帮 FJ 算出按照上面这种方法能排出的字典序最小的队列。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行每行一个大写字母，表示初始队列。", "outputFormat": "输出一个长度为 $N$ 的字符串，表示可能的最小字典序队列。\n\n每输出 $80$ 个字母需要一个换行。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6141", "type": "P", "difficulty": 5, "samples": [["5 5\n2 4 6 8 10\n0 1 2\n1 4 3\n2 4 2\n1 1 9\n0 4 7", "0\n2\n0\n4\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "各省省选", "江苏"], "title": "[JSOI2013] 贪心的导游", "background": "", "description": "南京有一条著名的购物街。购物街嘛，就是一排整齐的商店啦~\n\n导游小 Z 每次都会把游客团带到购物街里走一段，然后选择一个商店进去购物。\n\n小 Z 接待的游客都是购物狂，他们恨不得将店内的商品洗劫一空，也就是说，只要他们能买，就一定会继续买（钱够不够你不用考虑，他们都有信用卡可以透支）。\n\n但是有一点，他们都非常讲究平等、很谦虚，每个人都不能忍受比别人多买什么东西或者少买什么东西，于是他们每个人最后买的商品数量都是一样的。这虽然导致他们没办法每次都把商店搬空，但是每次已经给店家带来一大笔生意了，店家已经非常感谢了！为了表示感谢，店家决定把游客们买完之后剩下来那几件没卖掉的商品就送给导游小 Z 了。\n\n贪心的小 Z 自然希望自己能获赠的商品数量越大越好啦~\n\n现在告诉你这一排共 $n$ 个商店（标号为 $0$ 到 $n-1$）每个商店里的商品总数，每次小 Z 会带一批共 $p$ 个游客的旅游团，到其中 $u$ 号商店和 $v$ 号商店之间逛一逛，请你帮小 Z 在所逛的商店区间内选择一个，告诉小 Z 他最多能获赠多少件商品。", "inputFormat": "第一行，包含两个整数 $n,m$，分别表示商店个数和小 Z 带来的旅游团个数。\n\n接下来一行，包含 $n$ 个整数 $a_i$，表示第 $i$ 个商店的商品总数。\n\n接下来 $m$ 行，每行三个整数 $u,v,p$，表示这个旅游团逛 $u$ 号商店和 $v$ 号商店之间的商店（包含 $u$ 和 $v$），且这个旅游团的人数为 $p$。", "outputFormat": "共输出 $m$ 行，每行一个整数，第 $i$ 行输出第 $i$ 个旅游团购物后，小 Z 最多能获赠的商品数量。", "hint": "### 样例解释\n\n第一个旅游团， $2$ 个人， $0$ 号商店到 $1$ 号商店的区间。若去 $1$ 号商店，共 $2$ 件商品，每人买 $1$ 件，剩 $0$ 件。若去 $2$ 号商店，共 $4$ 件商品，每人买 $2$ 件，剩 $0$ 件。所以，小 Z 最多获赠 $0$ 件。\n\n第二个旅游团， $3$ 个人，小 Z 选择带他们去 $4$ 号商店，共 $8$ 件商品，每人买 $2$ 件商品（因为每人 $3$ 件不够），剩下 $2$ 件，小 Z 最多获赠就是 $2$ 件。 可以验证去其它商店小 Z 最多获赠的商品不会达到 $2$ 件。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1 \\leq n\\leq 10^6,1 \\leq m\\leq 5\\times 10^4,0\\leq a_i\\leq 10^3,2\\leq p\\leq 10^3,0\\leq u,v\\leq n-1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2013] 贪心的导游", "background": "", "description": "南京有一条著名的购物街。购物街嘛，就是一排整齐的商店啦~\n\n导游小 Z 每次都会把游客团带到购物街里走一段，然后选择一个商店进去购物。\n\n小 Z 接待的游客都是购物狂，他们恨不得将店内的商品洗劫一空，也就是说，只要他们能买，就一定会继续买（钱够不够你不用考虑，他们都有信用卡可以透支）。\n\n但是有一点，他们都非常讲究平等、很谦虚，每个人都不能忍受比别人多买什么东西或者少买什么东西，于是他们每个人最后买的商品数量都是一样的。这虽然导致他们没办法每次都把商店搬空，但是每次已经给店家带来一大笔生意了，店家已经非常感谢了！为了表示感谢，店家决定把游客们买完之后剩下来那几件没卖掉的商品就送给导游小 Z 了。\n\n贪心的小 Z 自然希望自己能获赠的商品数量越大越好啦~\n\n现在告诉你这一排共 $n$ 个商店（标号为 $0$ 到 $n-1$）每个商店里的商品总数，每次小 Z 会带一批共 $p$ 个游客的旅游团，到其中 $u$ 号商店和 $v$ 号商店之间逛一逛，请你帮小 Z 在所逛的商店区间内选择一个，告诉小 Z 他最多能获赠多少件商品。", "inputFormat": "第一行，包含两个整数 $n,m$，分别表示商店个数和小 Z 带来的旅游团个数。\n\n接下来一行，包含 $n$ 个整数 $a_i$，表示第 $i$ 个商店的商品总数。\n\n接下来 $m$ 行，每行三个整数 $u,v,p$，表示这个旅游团逛 $u$ 号商店和 $v$ 号商店之间的商店（包含 $u$ 和 $v$），且这个旅游团的人数为 $p$。", "outputFormat": "共输出 $m$ 行，每行一个整数，第 $i$ 行输出第 $i$ 个旅游团购物后，小 Z 最多能获赠的商品数量。", "hint": "### 样例解释\n\n第一个旅游团， $2$ 个人， $0$ 号商店到 $1$ 号商店的区间。若去 $1$ 号商店，共 $2$ 件商品，每人买 $1$ 件，剩 $0$ 件。若去 $2$ 号商店，共 $4$ 件商品，每人买 $2$ 件，剩 $0$ 件。所以，小 Z 最多获赠 $0$ 件。\n\n第二个旅游团， $3$ 个人，小 Z 选择带他们去 $4$ 号商店，共 $8$ 件商品，每人买 $2$ 件商品（因为每人 $3$ 件不够），剩下 $2$ 件，小 Z 最多获赠就是 $2$ 件。 可以验证去其它商店小 Z 最多获赠的商品不会达到 $2$ 件。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1 \\leq n\\leq 10^6,1 \\leq m\\leq 5\\times 10^4,0\\leq a_i\\leq 10^3,2\\leq p\\leq 10^3,0\\leq u,v\\leq n-1$。", "locale": "zh-CN"}}}
{"pid": "P6142", "type": "P", "difficulty": 5, "samples": [["8\n1 2\n1 3\n1 4\n4 5\n1 6\n6 7\n7 8", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2020", "二分", "USACO"], "title": "[USACO20FEB] Delegation P", "background": null, "description": "Farmer John 有 $N$ 个牧场，这些牧场通过 $N-1$ 条道路连接，形成了一个树形结构。\n\n但在 28 年的经营后（译者注：USACO 创办于 1992 年），FJ 觉得处理树上问题非常辣手，他认为一条链上的问题更加简单。\n\n因此他决定将整棵树划分为若干条链，将每一条链的管理权授予一位工人。他不关心链的数量，却关心链的长度，他希望划分的链都尽可能长，从而不会有人用效率低下的算法蒙混过关。\n\nFJ 现在想知道最大的正整数 $K$，使得整棵树被划分成若干条链，且每条链的长度都**至少**是 $K$。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 的道路。", "outputFormat": "输出 $K$。", "hint": "### 样例解释\n\n一种划分方案如下：\n\n$$\n2-1-6-7-8, 3-1-4-5\n$$\n\n### 子任务\n\n- 测试点 $2 \\sim 4$ 满足**最多**有一个点的度数大于 $2$。\n- 测试点 $5 \\sim 8$ 满足 $N \\leq 10^3$。\n- 测试点 $9 \\sim 15$ 没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Delegation P", "background": null, "description": "Farmer John 有 $N$ 个牧场，这些牧场通过 $N-1$ 条道路连接，形成了一个树形结构。\n\n但在 28 年的经营后（译者注：USACO 创办于 1992 年），FJ 觉得处理树上问题非常辣手，他认为一条链上的问题更加简单。\n\n因此他决定将整棵树划分为若干条链，将每一条链的管理权授予一位工人。他不关心链的数量，却关心链的长度，他希望划分的链都尽可能长，从而不会有人用效率低下的算法蒙混过关。\n\nFJ 现在想知道最大的正整数 $K$，使得整棵树被划分成若干条链，且每条链的长度都**至少**是 $K$。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 的道路。", "outputFormat": "输出 $K$。", "hint": "### 样例解释\n\n一种划分方案如下：\n\n$$\n2-1-6-7-8, 3-1-4-5\n$$\n\n### 子任务\n\n- 测试点 $2 \\sim 4$ 满足**最多**有一个点的度数大于 $2$。\n- 测试点 $5 \\sim 8$ 满足 $N \\leq 10^3$。\n- 测试点 $9 \\sim 15$ 没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6143", "type": "P", "difficulty": 5, "samples": [["3\n*..\n.*.\n*..", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2020", "USACO", "枚举", "平面几何"], "title": "[USACO20FEB] Equilateral Triangles P", "background": "", "description": "Farmer John 的农场可以用一个 $N \\times N$ 的方阵（$1 \\leq N \\leq 300$）。对于方阵内的每个格子，如果这个格子有奶牛，就用 `*` 表示，否则用 `.` 表示。\n\nFJ 相信他的牧场的美丽程度正比于两两距离相等的奶牛三元组的数量。也就是说，她们组成一个等边三角形。不幸的是，直到最近 FJ 才发现，由于他的奶牛都处在整数坐标位置，如果使用欧几里得距离进行计算，不可能存在美丽的奶牛三元组！于是，FJ 决定改用“曼哈顿”距离。形式化地说，两点 $(x_0,y_0)$ 和 $(x_1,y_1)$ 的曼哈顿距离等于 $|x_0-x_1|+|y_0-y_1|$。\n\n给定表示奶牛位置的方阵，计算等边三角形的数量。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个长度为 $N$ 的字符串，第 $i$ 行的第 $j$ 个字符表示位置 $(i,j)$ 上是否有奶牛。", "outputFormat": "输出一个整数，为所求的答案。可以证明答案可以用 32 位有符号整数型存储。", "hint": "### 样例解释\n\n有三头奶牛，并且她们组成了一个等边三角形，因为每对奶牛之间的曼哈顿距离都等于二。\n\n### 子任务\n\n- 对于测试点 $T$（$T \\in [2,11]$），满足 $N=25T$；\n- 对于测试点 $T$（$T \\in [12,15]$），满足 $N=300$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Equilateral Triangles P", "background": "", "description": "Farmer John 的农场可以用一个 $N \\times N$ 的方阵（$1 \\leq N \\leq 300$）。对于方阵内的每个格子，如果这个格子有奶牛，就用 `*` 表示，否则用 `.` 表示。\n\nFJ 相信他的牧场的美丽程度正比于两两距离相等的奶牛三元组的数量。也就是说，她们组成一个等边三角形。不幸的是，直到最近 FJ 才发现，由于他的奶牛都处在整数坐标位置，如果使用欧几里得距离进行计算，不可能存在美丽的奶牛三元组！于是，FJ 决定改用“曼哈顿”距离。形式化地说，两点 $(x_0,y_0)$ 和 $(x_1,y_1)$ 的曼哈顿距离等于 $|x_0-x_1|+|y_0-y_1|$。\n\n给定表示奶牛位置的方阵，计算等边三角形的数量。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个长度为 $N$ 的字符串，第 $i$ 行的第 $j$ 个字符表示位置 $(i,j)$ 上是否有奶牛。", "outputFormat": "输出一个整数，为所求的答案。可以证明答案可以用 32 位有符号整数型存储。", "hint": "### 样例解释\n\n有三头奶牛，并且她们组成了一个等边三角形，因为每对奶牛之间的曼哈顿距离都等于二。\n\n### 子任务\n\n- 对于测试点 $T$（$T \\in [2,11]$），满足 $N=25T$；\n- 对于测试点 $T$（$T \\in [12,15]$），满足 $N=300$。", "locale": "zh-CN"}}}
{"pid": "P6144", "type": "P", "difficulty": 6, "samples": [["3 2\n1 6\n2 3\n4 5", "10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2020", "线段树", "USACO", "Stirling 数"], "title": "[USACO20FEB] Help Yourself P", "background": "", "description": "在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。\n\n定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。\n\n定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目的 $K$ 次方。\n\n现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。\n\n你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！", "inputFormat": "第一行两个整数 $N$，$K$（$1 \\leq N \\leq 10^5$。$2 \\leq K \\leq 10$）。\n\n接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \\leq l_i \\lt r_i \\leq 2N$，且任意两个端点都不在同一位置上。", "outputFormat": "输出所求答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n所有非空子集的复杂度如下所示（显然空集的复杂度为零）：\n\n$$\n\\{[1,6]\\} \\implies 1, \\{[2,3]\\} \\implies 1, \\{[4,5]\\} \\implies 1\n$$\n\n$$\n\\{[1,6],[2,3]\\} \\implies 1, \\{[1,6],[4,5]\\} \\implies 1, \\{[2,3],[4,5]\\} \\implies 4\n$$\n\n$$\n\\{[1,6],[2,3],[4,5]\\} \\implies 1\n$$\n\n故答案为 $1+1+1+1+1+4+1=10$。\n\n### 子任务\n\n- 测试点 $2$ 满足 $N \\leq 16$；\n- 测试点 $3 \\sim 5$ 满足 $N \\leq 10^3$，且 $K=2$；\n- 测试点 $6 \\sim 8$ 满足 $N \\leq 10^3$；\n- 对于测试点 $T$（$T \\in [9,16]$），满足 $K=3+(T-9)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Help Yourself P", "background": "", "description": "在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。\n\n定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。\n\n定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目的 $K$ 次方。\n\n现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。\n\n你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！", "inputFormat": "第一行两个整数 $N$，$K$（$1 \\leq N \\leq 10^5$。$2 \\leq K \\leq 10$）。\n\n接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \\leq l_i \\lt r_i \\leq 2N$，且任意两个端点都不在同一位置上。", "outputFormat": "输出所求答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n所有非空子集的复杂度如下所示（显然空集的复杂度为零）：\n\n$$\n\\{[1,6]\\} \\implies 1, \\{[2,3]\\} \\implies 1, \\{[4,5]\\} \\implies 1\n$$\n\n$$\n\\{[1,6],[2,3]\\} \\implies 1, \\{[1,6],[4,5]\\} \\implies 1, \\{[2,3],[4,5]\\} \\implies 4\n$$\n\n$$\n\\{[1,6],[2,3],[4,5]\\} \\implies 1\n$$\n\n故答案为 $1+1+1+1+1+4+1=10$。\n\n### 子任务\n\n- 测试点 $2$ 满足 $N \\leq 16$；\n- 测试点 $3 \\sim 5$ 满足 $N \\leq 10^3$，且 $K=2$；\n- 测试点 $6 \\sim 8$ 满足 $N \\leq 10^3$；\n- 对于测试点 $T$（$T \\in [9,16]$），满足 $K=3+(T-9)$。", "locale": "zh-CN"}}}
{"pid": "P6145", "type": "P", "difficulty": 3, "samples": [["4 10 3\n1 2 3 4\n1 2 5\n2 4 2\n3 4 4", "1\n6\n3\n8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["图论", "2020", "USACO", "拓扑排序", "差分约束"], "title": "[USACO20FEB] Timeline G", "background": "", "description": "Bessie 在过去的 $M$ 天内参加了 $N$ 次挤奶。但她已经忘了她每次挤奶是在哪个时候了。\n\n对于第 $i$ 次挤奶，Bessie 记得它不早于第 $S_i$ 天进行。另外，她还有 $C$ 条记忆，每条记忆形如一个三元组 $(a,b,x)$，含义是第 $b$ 次挤奶在第 $a$ 次挤奶结束至少 $x$ 天后进行。\n\n现在请你帮 Bessie 算出在满足所有条件的前提下，每次挤奶的最早日期。\n\n保证 Bessie 的记忆没有错误，这意味着一定存在一种合法的方案，使得：\n\n- 第 $i$ 次挤奶不早于第 $S_i$ 天进行，且不晚于第 $M$ 天进行；\n- 所有的记忆都得到满足；", "inputFormat": "第一行三个整数 $N,M,C$。保证 $1 \\leq N,C \\leq 10^5$，$2 \\leq M \\leq 10^9$。\n\n接下来一行包含 $N$ 个整数 $S_1, S_2 , \\ldots, S_n$，保证 $\\forall 1 \\leq i \\leq n$，都满足 $1 \\leq S_i \\leq M$。\n\n下面 $C$ 行每行三个整数 $a,b,x$，描述一条记忆。保证 $a \\neq b$，且 $1 \\leq x \\leq M$。", "outputFormat": "输出 $N$ 行，每行一个整数，第 $i$ 行的数表示第 $i$ 次挤奶的最早日期。", "hint": "- 测试点 $2 \\sim 4$ 满足 $N,C \\leq 10^3$。\n- 测试点 $5 \\sim 10$ 没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Timeline G", "background": "", "description": "Bessie 在过去的 $M$ 天内参加了 $N$ 次挤奶。但她已经忘了她每次挤奶是在哪个时候了。\n\n对于第 $i$ 次挤奶，Bessie 记得它不早于第 $S_i$ 天进行。另外，她还有 $C$ 条记忆，每条记忆形如一个三元组 $(a,b,x)$，含义是第 $b$ 次挤奶在第 $a$ 次挤奶结束至少 $x$ 天后进行。\n\n现在请你帮 Bessie 算出在满足所有条件的前提下，每次挤奶的最早日期。\n\n保证 Bessie 的记忆没有错误，这意味着一定存在一种合法的方案，使得：\n\n- 第 $i$ 次挤奶不早于第 $S_i$ 天进行，且不晚于第 $M$ 天进行；\n- 所有的记忆都得到满足；", "inputFormat": "第一行三个整数 $N,M,C$。保证 $1 \\leq N,C \\leq 10^5$，$2 \\leq M \\leq 10^9$。\n\n接下来一行包含 $N$ 个整数 $S_1, S_2 , \\ldots, S_n$，保证 $\\forall 1 \\leq i \\leq n$，都满足 $1 \\leq S_i \\leq M$。\n\n下面 $C$ 行每行三个整数 $a,b,x$，描述一条记忆。保证 $a \\neq b$，且 $1 \\leq x \\leq M$。", "outputFormat": "输出 $N$ 行，每行一个整数，第 $i$ 行的数表示第 $i$ 次挤奶的最早日期。", "hint": "- 测试点 $2 \\sim 4$ 满足 $N,C \\leq 10^3$。\n- 测试点 $5 \\sim 10$ 没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6146", "type": "P", "difficulty": 4, "samples": [["3\n1 6\n2 3\n4 5", "8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["递推", "2020", "二分", "USACO", "排序", "组合数学", "前缀和"], "title": "[USACO20FEB] Help Yourself G", "background": "", "description": "在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。\n\n定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。\n\n定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目。\n\n现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。\n\n你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \\leq l_i \\lt r_i \\leq 2N$，且任意两个端点都不在同一位置上。", "outputFormat": "输出所求答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n所有非空子集的复杂度如下所示（显然空集的复杂度为零）：\n$$\n\\{[1,6]\\} \\implies 1, \\{[2,3]\\} \\implies 1, \\{[4,5]\\} \\implies 1\n$$\n\n$$\n\\{[1,6],[2,3]\\} \\implies 1, \\{[1,6],[4,5]\\} \\implies 1, \\{[2,3],[4,5]\\} \\implies 2\n$$\n\n$$\n\\{[1,6],[2,3],[4,5]\\} \\implies 1\n$$\n\n故答案为 $1+1+1+1+1+2+1=8$。\n\n### 子任务\n\n- 测试点 $2 \\sim 3$ 满足 $N \\leq 16$；\n- 测试点 $4 \\sim 7$ 满足 $N \\leq 1000$；\n- 测试点 $8 \\sim 12$ 没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Help Yourself G", "background": "", "description": "在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。\n\n定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。\n\n定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目。\n\n现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。\n\n你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \\leq l_i \\lt r_i \\leq 2N$，且任意两个端点都不在同一位置上。", "outputFormat": "输出所求答案对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n所有非空子集的复杂度如下所示（显然空集的复杂度为零）：\n$$\n\\{[1,6]\\} \\implies 1, \\{[2,3]\\} \\implies 1, \\{[4,5]\\} \\implies 1\n$$\n\n$$\n\\{[1,6],[2,3]\\} \\implies 1, \\{[1,6],[4,5]\\} \\implies 1, \\{[2,3],[4,5]\\} \\implies 2\n$$\n\n$$\n\\{[1,6],[2,3],[4,5]\\} \\implies 1\n$$\n\n故答案为 $1+1+1+1+1+2+1=8$。\n\n### 子任务\n\n- 测试点 $2 \\sim 3$ 满足 $N \\leq 16$；\n- 测试点 $4 \\sim 7$ 满足 $N \\leq 1000$；\n- 测试点 $8 \\sim 12$ 没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6147", "type": "P", "difficulty": 5, "samples": [["13\n1 2\n2 3\n2 4\n4 5\n2 6\n6 7\n6 8\n8 9\n9 10\n8 11\n11 12\n12 13", "111000000000"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "USACO", "数论", "树的遍历"], "title": "[USACO20FEB] Delegation G", "background": "", "description": "Farmer John 有 $N$ 个牧场，这些牧场通过 $N-1$ 条道路连接，形成了一个树形结构。\n\n但在 28 年的经营后（译者注：USACO 创办于 1992 年），FJ 觉得处理树上问题非常辣手，他认为一条链上的问题更加简单。\n\n因此他决定将整棵树划分为若干条链，将每一条链的管理权授予一位工人。为了避免可能的争端，他希望所有链的长度均相同。\n\nFJ 现在想知道，对于每一个满足 $1 \\leq K \\leq N-1$ 的 $K$，是否存在一种划分方案，使得整棵树被划分成若干条链，且每条链的长度都**恰好**是 $K$。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 的道路。", "outputFormat": "输出一个长度 $N-1$ 的 0/1 串。第 $i$ 位的值为 $1$ 当且仅当存在一种划分方案，使得整棵树被划分成若干条链，且每条链的长度都恰好是 $i$，否则第 $i$ 位的值为 $0$。", "hint": "### 样例解释\n\n$K=1,2,3$ 时都存在一种合法的划分方案。\n\n$K=3$ 时的一种划分方案如下：\n\n$13-12-11-8, 10-9-8-6, 7-6-2-3, 5-4-2-1$\n\n### 子任务\n\n- 测试点 $2 \\sim 4$ 满足**最多**有一个点的度数大于 $2$。\n- 测试点 $5 \\sim 8$ 满足 $N \\leq 10^3$。\n- 测试点 $9 \\sim 15$ 没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Delegation G", "background": "", "description": "Farmer John 有 $N$ 个牧场，这些牧场通过 $N-1$ 条道路连接，形成了一个树形结构。\n\n但在 28 年的经营后（译者注：USACO 创办于 1992 年），FJ 觉得处理树上问题非常辣手，他认为一条链上的问题更加简单。\n\n因此他决定将整棵树划分为若干条链，将每一条链的管理权授予一位工人。为了避免可能的争端，他希望所有链的长度均相同。\n\nFJ 现在想知道，对于每一个满足 $1 \\leq K \\leq N-1$ 的 $K$，是否存在一种划分方案，使得整棵树被划分成若干条链，且每条链的长度都**恰好**是 $K$。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 的道路。", "outputFormat": "输出一个长度 $N-1$ 的 0/1 串。第 $i$ 位的值为 $1$ 当且仅当存在一种划分方案，使得整棵树被划分成若干条链，且每条链的长度都恰好是 $i$，否则第 $i$ 位的值为 $0$。", "hint": "### 样例解释\n\n$K=1,2,3$ 时都存在一种合法的划分方案。\n\n$K=3$ 时的一种划分方案如下：\n\n$13-12-11-8, 10-9-8-6, 7-6-2-3, 5-4-2-1$\n\n### 子任务\n\n- 测试点 $2 \\sim 4$ 满足**最多**有一个点的度数大于 $2$。\n- 测试点 $5 \\sim 8$ 满足 $N \\leq 10^3$。\n- 测试点 $9 \\sim 15$ 没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6148", "type": "P", "difficulty": 4, "samples": [["7 2 2\n2 5\n3 7", "1\n2\n4\n3\n5\n7\n6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2020", "倍增", "USACO"], "title": "[USACO20FEB] Swapity Swapity Swap S", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$1\\leq N\\leq 10^5$）站成一排。对于每一个 $1\\leq i\\leq N$，从左往右数第 $i$ 头奶牛的编号为 $i$。\n\nFarmer John 想到了一个新的奶牛晨练方案。他给奶牛们 $M$ 对整数 $(L_1,R_1)\\ldots (L_M,R_M)$，其中 $1\\leq M\\leq 100$。他让她们重复以下包含 $M$ 个步骤的过程 $K$（$1\\leq K\\leq 10^9$）次：\n\n对于从 $1$ 到 $M$ 的每一个 $i$：\n- 当前从左往右数在位置 $L_i\\ldots R_i$ 的奶牛序列反转她们的顺序。\n- 当奶牛们重复这一过程 $K$ 次后，请对每一个 $1\\leq i\\leq N$ 输出从左往右数第 $i$ 头奶牛的编号。", "inputFormat": "输入的第一行包含 $N$，$M$ 和 $K$。对于每一个 $1\\leq i\\leq M$，第 $i+1$ 行包含 $L_i$ 和 $R_i$，均为范围在 $1\\ldots N$ 内的整数，其中 $L_i<R_i$。", "outputFormat": "在第 $i$ 行输出指令序列执行了 $K$ 次后奶牛序列中从左往右数第 $i$ 个元素的编号。", "hint": "#### 样例解释：\n初始时，奶牛们的顺序从左往右为 [$1,2,3,4,5,6,7$]。在这一过程的第一步过后，顺序变为 [$1,5,4,3,2,6,7$]。在这一过程的第二步过后，顺序变为 [$1,5,7,6,2,3,4$]。再重复这两个步骤各一次可以得到样例的输出。\n\n#### 子任务：\n- 测试点 $2$ 满足 $N=K=100$。\n- 测试点 $3$-$5$ 满足 $K\\leq 10^3$。\n- 测试点 $6$-$10$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Swapity Swapity Swap S", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$1\\leq N\\leq 10^5$）站成一排。对于每一个 $1\\leq i\\leq N$，从左往右数第 $i$ 头奶牛的编号为 $i$。\n\nFarmer John 想到了一个新的奶牛晨练方案。他给奶牛们 $M$ 对整数 $(L_1,R_1)\\ldots (L_M,R_M)$，其中 $1\\leq M\\leq 100$。他让她们重复以下包含 $M$ 个步骤的过程 $K$（$1\\leq K\\leq 10^9$）次：\n\n对于从 $1$ 到 $M$ 的每一个 $i$：\n- 当前从左往右数在位置 $L_i\\ldots R_i$ 的奶牛序列反转她们的顺序。\n- 当奶牛们重复这一过程 $K$ 次后，请对每一个 $1\\leq i\\leq N$ 输出从左往右数第 $i$ 头奶牛的编号。", "inputFormat": "输入的第一行包含 $N$，$M$ 和 $K$。对于每一个 $1\\leq i\\leq M$，第 $i+1$ 行包含 $L_i$ 和 $R_i$，均为范围在 $1\\ldots N$ 内的整数，其中 $L_i<R_i$。", "outputFormat": "在第 $i$ 行输出指令序列执行了 $K$ 次后奶牛序列中从左往右数第 $i$ 个元素的编号。", "hint": "#### 样例解释：\n初始时，奶牛们的顺序从左往右为 [$1,2,3,4,5,6,7$]。在这一过程的第一步过后，顺序变为 [$1,5,4,3,2,6,7$]。在这一过程的第二步过后，顺序变为 [$1,5,7,6,2,3,4$]。再重复这两个步骤各一次可以得到样例的输出。\n\n#### 子任务：\n- 测试点 $2$ 满足 $N=K=100$。\n- 测试点 $3$-$5$ 满足 $K\\leq 10^3$。\n- 测试点 $6$-$10$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6149", "type": "P", "difficulty": 4, "samples": [["4\n0 0\n0 1\n1 0\n1 2", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2020", "USACO", "排序"], "title": "[USACO20FEB] Triangles S", "background": "", "description": "Farmer John 想要给他的奶牛们建造一个三角形牧场。\n\n有 $N$（$3\\leq N\\leq 10^5$）个栅栏柱子分别位于农场的二维平面上不同的点 $(X_1,Y_1)\\ldots (X_N,Y_N)$。他可以选择其中三个点组成三角形牧场，只要三角形有一条边与 $x$ 轴平行，且有另一条边与 $y$ 轴平行。\n\nFJ 可以组成的所有可能的牧场的面积之和等于多少？", "inputFormat": "第一行包含 $N$。\n\n以下 $N$ 行每行包含两个整数 $X_i$ 和 $Y_i$，均在范围 $−10^4\\ldots 10^4$ 之内，描述一个栅栏柱子的位置。", "outputFormat": "由于面积之和不一定为整数且可能非常大，输出面积之和的**两倍**模 $10^9+7$ 的余数。", "hint": "#### 样例解释：\n栅栏木桩 ($0,0$)、($1,0$) 和 ($1,2$) 组成了一个面积为 $1$ 的三角形，($0,0$)、($1,0$) 和 ($0,1$) 组成了一个面积为 $0.5$ 的三角形。所以答案为 $2\\times (1+0.5)=3$。\n\n#### 子任务：\n- 测试点 $2$ 满足 $N=200$。\n- 测试点 $3$-$4$ 满足 $N\\leq 5000$。\n- 测试点 $5$-$10$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Triangles S", "background": "", "description": "Farmer John 想要给他的奶牛们建造一个三角形牧场。\n\n有 $N$（$3\\leq N\\leq 10^5$）个栅栏柱子分别位于农场的二维平面上不同的点 $(X_1,Y_1)\\ldots (X_N,Y_N)$。他可以选择其中三个点组成三角形牧场，只要三角形有一条边与 $x$ 轴平行，且有另一条边与 $y$ 轴平行。\n\nFJ 可以组成的所有可能的牧场的面积之和等于多少？", "inputFormat": "第一行包含 $N$。\n\n以下 $N$ 行每行包含两个整数 $X_i$ 和 $Y_i$，均在范围 $−10^4\\ldots 10^4$ 之内，描述一个栅栏柱子的位置。", "outputFormat": "由于面积之和不一定为整数且可能非常大，输出面积之和的**两倍**模 $10^9+7$ 的余数。", "hint": "#### 样例解释：\n栅栏木桩 ($0,0$)、($1,0$) 和 ($1,2$) 组成了一个面积为 $1$ 的三角形，($0,0$)、($1,0$) 和 ($0,1$) 组成了一个面积为 $0.5$ 的三角形。所以答案为 $2\\times (1+0.5)=3$。\n\n#### 子任务：\n- 测试点 $2$ 满足 $N=200$。\n- 测试点 $3$-$4$ 满足 $N\\leq 5000$。\n- 测试点 $5$-$10$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6150", "type": "P", "difficulty": 4, "samples": [["4\n11 10 11 11\n1 2\n2 3\n2 4", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["搜索", "2020", "USACO", "深度优先搜索 DFS", "图遍历"], "title": "[USACO20FEB] Clock Tree S", "background": "", "description": "Farmer John 的新牛棚的设计十分奇怪：它由编号为 $1\\ldots N$ 的 $N$ 间房间（$2\\leq N\\leq 2\\,500$），以及 $N−1$ 条走廊组成。每条走廊连接两间房间，使得每间房间都可以沿着一些走廊到达任意其他房间。\n\n牛棚里的每间房间都装有一个在表盘上印有标准的整数 $1\\ldots 12$ 的圆形时钟。然而，这些时钟只有一根指针，并且总是直接指向表盘上的某个数字（它从不指向两个数字之间）。\n\n奶牛 Bessie 想要同步牛棚中的所有时钟，使它们都指向整数 $12$。然而，她头脑稍有些简单，当她在牛棚里行走的时候，每次她进入一间房间，她将房间里的时钟的指针向后拨动一个位置。例如，如果原来时钟指向 $5$，现在它会指向 $6$，如果原来时钟指向 $12$，现在它会指向 $1$。如果 Bessie 进入同一间房间多次，她每次进入都会拨动这间房间的时钟。\n\n请求出 Bessie 可能的出发房间数量，使得她可以在牛棚中走动并使所有时钟指向 $12$。注意 Bessie 并不拨动她出发房间的时钟，但任意时刻她再次进入的时候会拨动它。时钟不会自己走动；时钟只会在 Bessie 进入时被拨动。此外，Bessie 一旦进入了一条走廊，她必须到达走廊的另一端（不允许走到一半折回原来的房间）。", "inputFormat": "输入的第一行包含 $N$。下一行包含 $N$ 个整数，均在范围 $1\\ldots 12$ 之内，表示每间房间初始时的时钟设置。以下 $N−1$ 行每行用两个整数 $a$ 和 $b$ 描述了一条走廊，两数均在范围 $1\\ldots N$ 之内，为该走廊连接的两间房间的编号。", "outputFormat": "输出出发房间的数量，使得 Bessie 有可能使所有时钟指向 $12$。", "hint": "#### 样例解释：\n在这个例子中，当且仅当 Bessie 从房间 $2$ 出发时她可以使所有房间的时钟指向 $12$（比如，移动到房间 $1$，$2$，$3$，$2$，最后到 $4$）。\n\n#### 子任务：\n- 测试点 $2$-$7$ 满足 $N\\leq 100$。\n- 测试点 $8$-$15$ 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO20FEB] Clock Tree S", "background": "", "description": "Farmer John 的新牛棚的设计十分奇怪：它由编号为 $1\\ldots N$ 的 $N$ 间房间（$2\\leq N\\leq 2\\,500$），以及 $N−1$ 条走廊组成。每条走廊连接两间房间，使得每间房间都可以沿着一些走廊到达任意其他房间。\n\n牛棚里的每间房间都装有一个在表盘上印有标准的整数 $1\\ldots 12$ 的圆形时钟。然而，这些时钟只有一根指针，并且总是直接指向表盘上的某个数字（它从不指向两个数字之间）。\n\n奶牛 Bessie 想要同步牛棚中的所有时钟，使它们都指向整数 $12$。然而，她头脑稍有些简单，当她在牛棚里行走的时候，每次她进入一间房间，她将房间里的时钟的指针向后拨动一个位置。例如，如果原来时钟指向 $5$，现在它会指向 $6$，如果原来时钟指向 $12$，现在它会指向 $1$。如果 Bessie 进入同一间房间多次，她每次进入都会拨动这间房间的时钟。\n\n请求出 Bessie 可能的出发房间数量，使得她可以在牛棚中走动并使所有时钟指向 $12$。注意 Bessie 并不拨动她出发房间的时钟，但任意时刻她再次进入的时候会拨动它。时钟不会自己走动；时钟只会在 Bessie 进入时被拨动。此外，Bessie 一旦进入了一条走廊，她必须到达走廊的另一端（不允许走到一半折回原来的房间）。", "inputFormat": "输入的第一行包含 $N$。下一行包含 $N$ 个整数，均在范围 $1\\ldots 12$ 之内，表示每间房间初始时的时钟设置。以下 $N−1$ 行每行用两个整数 $a$ 和 $b$ 描述了一条走廊，两数均在范围 $1\\ldots N$ 之内，为该走廊连接的两间房间的编号。", "outputFormat": "输出出发房间的数量，使得 Bessie 有可能使所有时钟指向 $12$。", "hint": "#### 样例解释：\n在这个例子中，当且仅当 Bessie 从房间 $2$ 出发时她可以使所有房间的时钟指向 $12$（比如，移动到房间 $1$，$2$，$3$，$2$，最后到 $4$）。\n\n#### 子任务：\n- 测试点 $2$-$7$ 满足 $N\\leq 100$。\n- 测试点 $8$-$15$ 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P6151", "type": "P", "difficulty": 7, "samples": [["2\n2 2", "18"], ["6\n7 8 9 10 11 12", "515320459"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "O2优化", "容斥原理", "快速傅里叶变换 FFT"], "title": "[集训队作业2019] 青春猪头少年不会梦到兔女郎学姐", "background": "来源：2019 集训队作业 Round4", "description": "若干个正整数排成一个序列，其中数字 $i$ 的出现次数为 $c_i$，对于每一个这样的序列，定义他的权值如下：\n\n把这个序列首尾相接放在一个圆上，把这些数字分成若干相邻的段，使得每段都是在圆上相邻的数字，任意两段没有公共的元素，每一段中的数字都相同，相邻段中的数字不同，则这个序列的权值定义为所有段的长度之积。\n\n求所有的序列的权值和对 $998244353$ 取模。\n\n注：虽然计算序列的权值的时候是圆排列，但互为循环排列的不同序列仍然被认为是不同的，如 $(1,2,1,2)$ 和 $(2,1,2,1)$ 被认为是不同的序列。", "inputFormat": "若干行，第一行一个正整数 $n$ ，表示数字种类数。\n\n第二行 $n$ 个正整数 $c_i$，表示第 $i$ 个数字的出现次数。", "outputFormat": "一行，表示所有出现次数符合条件的序列的权值和对 $998244353$ 取模的值。", "hint": "样例解释 #1：\n\n合法序列为 $(1,1,2,2),(1,2,1,2),(1,2,2,1),(2,1,1,2),(2,1,2,1),(2,2,1,1)$。\n权值分别为 $4,1,4,4,1,4$，和为 $18$。\n\n$\\sum c_i \\le 2\\times 10^5$\n\n$2\\le n\\le 2\\times 10^5$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队作业2019] 青春猪头少年不会梦到兔女郎学姐", "background": "来源：2019 集训队作业 Round4", "description": "若干个正整数排成一个序列，其中数字 $i$ 的出现次数为 $c_i$，对于每一个这样的序列，定义他的权值如下：\n\n把这个序列首尾相接放在一个圆上，把这些数字分成若干相邻的段，使得每段都是在圆上相邻的数字，任意两段没有公共的元素，每一段中的数字都相同，相邻段中的数字不同，则这个序列的权值定义为所有段的长度之积。\n\n求所有的序列的权值和对 $998244353$ 取模。\n\n注：虽然计算序列的权值的时候是圆排列，但互为循环排列的不同序列仍然被认为是不同的，如 $(1,2,1,2)$ 和 $(2,1,2,1)$ 被认为是不同的序列。", "inputFormat": "若干行，第一行一个正整数 $n$ ，表示数字种类数。\n\n第二行 $n$ 个正整数 $c_i$，表示第 $i$ 个数字的出现次数。", "outputFormat": "一行，表示所有出现次数符合条件的序列的权值和对 $998244353$ 取模的值。", "hint": "样例解释 #1：\n\n合法序列为 $(1,1,2,2),(1,2,1,2),(1,2,2,1),(2,1,1,2),(2,1,2,1),(2,2,1,1)$。\n权值分别为 $4,1,4,4,1,4$，和为 $18$。\n\n$\\sum c_i \\le 2\\times 10^5$\n\n$2\\le n\\le 2\\times 10^5$", "locale": "zh-CN"}}}
{"pid": "P6152", "type": "P", "difficulty": 7, "samples": [["7 2\n2 1 3 1 3 1 4\n1 7\n4 5", "10\n2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2018", "后缀自动机 SAM", "O2优化"], "title": "[集训队作业2018] 后缀树节点数", "background": "来源：陈江伦 2018 候选队论文题", "description": "给定一个长度为 $n$ 的字符串 $P$，有 $m$ 次询问，每次给定两个参数 $l$ , $r$，询问子串 $P[l,r]$ 所构成的后缀树的结点数。\n\n如果你不了解后缀树，你也可以理解为对 $[l,r]$ 的反串建后缀自动机。\n\n注意在本题中，后缀树的根节点不计入答案。", "inputFormat": "本题中用数字来表示字符串，不同的数字代表不同的字符，相同的数字代表相同的字符，数字的范围在 $[0,n]$ 之间。\n\n第一行两个正整数 $n$ 和 $m$，表示字符串长度和询问个数。\n第二行 $n$ 个用空格隔开的非负整数，表示这个字符串。\n接下来 $m$ 行，每行两个正整数 $l,r$，表示询问子串 $[l,r]$ 的后缀树的结点数。", "outputFormat": "输出 $m$ 行，每行一个正整数表示答案。", "hint": "对于 $30\\%$ 的数据：$n,m\\le 3\\times 10^3$；\n\n对于 $100\\%$ 的数据满足：$n\\le 10^5$，$m\\le 3\\times 10^5$，字符串的每个数字 $\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队作业2018] 后缀树节点数", "background": "来源：陈江伦 2018 候选队论文题", "description": "给定一个长度为 $n$ 的字符串 $P$，有 $m$ 次询问，每次给定两个参数 $l$ , $r$，询问子串 $P[l,r]$ 所构成的后缀树的结点数。\n\n如果你不了解后缀树，你也可以理解为对 $[l,r]$ 的反串建后缀自动机。\n\n注意在本题中，后缀树的根节点不计入答案。", "inputFormat": "本题中用数字来表示字符串，不同的数字代表不同的字符，相同的数字代表相同的字符，数字的范围在 $[0,n]$ 之间。\n\n第一行两个正整数 $n$ 和 $m$，表示字符串长度和询问个数。\n第二行 $n$ 个用空格隔开的非负整数，表示这个字符串。\n接下来 $m$ 行，每行两个正整数 $l,r$，表示询问子串 $[l,r]$ 的后缀树的结点数。", "outputFormat": "输出 $m$ 行，每行一个正整数表示答案。", "hint": "对于 $30\\%$ 的数据：$n,m\\le 3\\times 10^3$；\n\n对于 $100\\%$ 的数据满足：$n\\le 10^5$，$m\\le 3\\times 10^5$，字符串的每个数字 $\\le n$。", "locale": "zh-CN"}}}
{"pid": "P6153", "type": "P", "difficulty": 1, "samples": [["11 8 \n1 2\n4 3\n5 4\n1 3\n5 6\n7 10\n5 10\n8 9", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2020"], "title": "询问", "background": " zbw 被邀请至幼儿园给小朋友们出题。", "description": "　现在 zbw 有 $n$ 个物品，编号从 $1 \\sim n$，他会告诉你 $m$ 个条件，每个条件包含两个数 $x,y$，表示第 $x$ 个物品和第 $y$ 个物品是相同的。\n\n 因为 zbw 特别赶时间，所以他保证**每次给出的条件都是有用的，也就是说，每次给出的条件无法由之前的条件推导得来。**\n\n你需要回答有多少**种**不同的物品。", "inputFormat": "　第一行两个整数 $n$,$m$。\n\n   之后 $m$ 行，每行两个数 $x,y$，表示第 $x$ 个物品和第 $y$ 个物品是相同的。", "outputFormat": "一个整数，不同物品的数量。", "hint": "对于 $20\\%$ 的数据，$n,m \\le 10$。\n\n对于 $40\\%$ 的数据，$n,m \\le 10^3$。\n\n对于 $60\\%$ 的数据，$n,m \\le 10^5$。\n\n对于 $80\\%$ 的数据，$m \\le 10^6$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^{18}$，$1 \\le m \\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "Queries", "background": "zbw was invited to a kindergarten to create problems for children.", "description": "Now zbw has $n$ items, numbered from $1 \\sim n$. He will tell you $m$ conditions. Each condition contains two numbers $x, y$, meaning that item $x$ and item $y$ are the same.\n\nBecause zbw is in a big hurry, he guarantees that **every condition he gives is useful; that is, each condition cannot be deduced from the previous conditions.**\n\nYou need to answer how many **different kinds** of items there are.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThen follow $m$ lines. Each line contains two numbers $x, y$, meaning that item $x$ and item $y$ are the same.", "outputFormat": "Output one integer: the number of different items.", "hint": "For $20\\%$ of the testdata, $n, m \\le 10$.\n\nFor $40\\%$ of the testdata, $n, m \\le 10^3$.\n\nFor $60\\%$ of the testdata, $n, m \\le 10^5$.\n\nFor $80\\%$ of the testdata, $m \\le 10^6$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^{18}$, $1 \\le m \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "询问", "background": " zbw 被邀请至幼儿园给小朋友们出题。", "description": "　现在 zbw 有 $n$ 个物品，编号从 $1 \\sim n$，他会告诉你 $m$ 个条件，每个条件包含两个数 $x,y$，表示第 $x$ 个物品和第 $y$ 个物品是相同的。\n\n 因为 zbw 特别赶时间，所以他保证**每次给出的条件都是有用的，也就是说，每次给出的条件无法由之前的条件推导得来。**\n\n你需要回答有多少**种**不同的物品。", "inputFormat": "　第一行两个整数 $n$,$m$。\n\n   之后 $m$ 行，每行两个数 $x,y$，表示第 $x$ 个物品和第 $y$ 个物品是相同的。", "outputFormat": "一个整数，不同物品的数量。", "hint": "对于 $20\\%$ 的数据，$n,m \\le 10$。\n\n对于 $40\\%$ 的数据，$n,m \\le 10^3$。\n\n对于 $60\\%$ 的数据，$n,m \\le 10^5$。\n\n对于 $80\\%$ 的数据，$m \\le 10^6$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^{18}$，$1 \\le m \\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P6154", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2\n3 2", "199648871"], ["6 5\n1 3\n2 3\n3 4\n4 5\n4 6", "630470119"], ["5 6\n1 2\n1 3\n4 5\n3 4\n3 5\n2 4", "887328315"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "记忆化搜索", "拓扑排序", "期望"], "title": "游走", "background": "zbw 在 B 城游走。", "description": "B 城可以看作一个有 $n$ 个点 $m$ 条边的**有向无环图**。**可能存在重边**。\n\nzbw 在 B 城随机游走，他会在所有路径中随机选择一条路径，选择所有路径的概率相等。路径的起点和终点可以相同。\n\n定义一条路径的长度为经过的边数，你需要求出 zbw 走的路径长度的期望，答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $x,y$，表示存在一条从 $x$ 到 $y$ 的有向边。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "样例说明：样例的答案分别为 $\\dfrac{2}{5}$，$\\dfrac{25}{19}$ 和 $\\dfrac{11}{9}$。\n\n| 测试点编号 | $n$ | $m$ | 特殊性质 | 每测试点分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10$ | $\\le 10$ | 无 | $2$ |\n| $3,4,5$ | $\\le 15$ | $\\le 100$ | 无 | $2$ |\n| $6,7,8$ | $\\le 100$ | $\\le 10^3$ | 无 | $2$ |\n| $9,10$ | $\\le 10^3$ | $\\le 10^4$ | 无 | $2$ |\n| $11,12$ | $\\le 10^4$ | $\\le 10^5$ | 无 | $5$ |\n| $13,14$ | $\\le 10^5$ | $\\le 2\\times10^5$ | 无 | $5$ |\n| $15,16$ | $\\le 10^5$ | $\\le 7\\times10^5$ | 无 | $10$ |\n| $17$ | $\\le 10$ | $=n-1$ | 有向树 | $10$ |\n| $18$ | $\\le 10^3$ | $=n-1$ | 有向树 | $10$ |\n| $19$ | $\\le 10^4$ | $=n-1$ | 有向树 | $10$ |\n| $20$ | $\\le 10^5$ | $=n-1$ | 有向树 | $10$ |\n\n其中，“有向树”的定义是：若把图视为无向图，则为一棵树（如样例 $1,2$）。\n\n保证所有数据均按照某种方式随机，这意味着你可以认为算法执行过程中，你可以放心执行模意义下除法操作而不用担心除以零。", "locale": "zh-CN", "translations": {"en": {"title": "Random Walk", "background": "zbw is wandering in City B.", "description": "City B can be seen as a **directed acyclic graph** with $n$ vertices and $m$ edges. **Multiple edges may exist**.\n\nzbw walks randomly in City B. He will randomly choose one path among all paths, and every path is chosen with equal probability. The starting vertex and the ending vertex of a path may be the same.\n\nDefine the length of a path as the number of edges it passes through. You need to compute the expected length of the path zbw walks, and output the answer modulo $998244353$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next $m$ lines each contain two integers $x, y$, indicating that there is a directed edge from $x$ to $y$.", "outputFormat": "Output one integer per line, representing the answer modulo $998244353$.", "hint": "Sample explanation: the answers for the samples are $\\dfrac{2}{5}$, $\\dfrac{25}{19}$, and $\\dfrac{11}{9}$.\n\n## Constraints\n\n| Test Point ID | $n$ | $m$ | Special Property | Score per Test Point |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10$ | $\\le 10$ | None | $2$ |\n| $3,4,5$ | $\\le 15$ | $\\le 100$ | None | $2$ |\n| $6,7,8$ | $\\le 100$ | $\\le 10^3$ | None | $2$ |\n| $9,10$ | $\\le 10^3$ | $\\le 10^4$ | None | $2$ |\n| $11,12$ | $\\le 10^4$ | $\\le 10^5$ | None | $5$ |\n| $13,14$ | $\\le 10^5$ | $\\le 2\\times 10^5$ | None | $5$ |\n| $15,16$ | $\\le 10^5$ | $\\le 7\\times 10^5$ | None | $10$ |\n| $17$ | $\\le 10$ | $= n - 1$ | Directed Tree | $10$ |\n| $18$ | $\\le 10^3$ | $= n - 1$ | Directed Tree | $10$ |\n| $19$ | $\\le 10^4$ | $= n - 1$ | Directed Tree | $10$ |\n| $20$ | $\\le 10^5$ | $= n - 1$ | Directed Tree | $10$ |\n\nHere, a “Directed Tree” means: if you view the graph as an undirected graph, it is a tree (as in samples $1,2$).\n\nIt is guaranteed that all testdata is generated randomly in some way. This means you may assume that during the algorithm, you can safely perform division modulo $998244353$ without worrying about dividing by zero.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "游走", "background": "zbw 在 B 城游走。", "description": "B 城可以看作一个有 $n$ 个点 $m$ 条边的**有向无环图**。**可能存在重边**。\n\nzbw 在 B 城随机游走，他会在所有路径中随机选择一条路径，选择所有路径的概率相等。路径的起点和终点可以相同。\n\n定义一条路径的长度为经过的边数，你需要求出 zbw 走的路径长度的期望，答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $x,y$，表示存在一条从 $x$ 到 $y$ 的有向边。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "样例说明：样例的答案分别为 $\\dfrac{2}{5}$，$\\dfrac{25}{19}$ 和 $\\dfrac{11}{9}$。\n\n| 测试点编号 | $n$ | $m$ | 特殊性质 | 每测试点分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10$ | $\\le 10$ | 无 | $2$ |\n| $3,4,5$ | $\\le 15$ | $\\le 100$ | 无 | $2$ |\n| $6,7,8$ | $\\le 100$ | $\\le 10^3$ | 无 | $2$ |\n| $9,10$ | $\\le 10^3$ | $\\le 10^4$ | 无 | $2$ |\n| $11,12$ | $\\le 10^4$ | $\\le 10^5$ | 无 | $5$ |\n| $13,14$ | $\\le 10^5$ | $\\le 2\\times10^5$ | 无 | $5$ |\n| $15,16$ | $\\le 10^5$ | $\\le 7\\times10^5$ | 无 | $10$ |\n| $17$ | $\\le 10$ | $=n-1$ | 有向树 | $10$ |\n| $18$ | $\\le 10^3$ | $=n-1$ | 有向树 | $10$ |\n| $19$ | $\\le 10^4$ | $=n-1$ | 有向树 | $10$ |\n| $20$ | $\\le 10^5$ | $=n-1$ | 有向树 | $10$ |\n\n其中，“有向树”的定义是：若把图视为无向图，则为一棵树（如样例 $1,2$）。\n\n保证所有数据均按照某种方式随机，这意味着你可以认为算法执行过程中，你可以放心执行模意义下除法操作而不用担心除以零。", "locale": "zh-CN"}}}
{"pid": "P6155", "type": "P", "difficulty": 4, "samples": [["3\n3 3 3\n1 2 3", "4"], ["3\n3 3 4\n3 2 1", "2"], ["3\n3 4 5\n2 1 3", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2020", "栈"], "title": "修改", "background": "", "description": "给定一个长度为 $n$ 的整数序列 $a_i$，再给定一个长度为 $n$ 的整数序列 $b_i$。\n\n你可以进行一些修改，每次你可以将一个 $a_i$ 增加 $1$，花费为 $b_i$，你需要使所有的 $a_i$ 不相等，且同时满足花费最少。\n\n但 zbw 认为太过简单，于是他规定，你可以在修改前进行**无限**次如下操作：交换 $b_i,b_j(1 \\leq i,j \\leq n)$。\n\n求最小的花费。\n\n**由于答案可能很大，请输出答案对  $2^{64}$ 取模后的值。**\n\n\n", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数，第 $i$ 个数表示 $a_i$。\n\n第三行 $n$ 个整数，第 $i$ 个数表示 $b_i$。", "outputFormat": "输出一行一个整数，表示答案对 $2^{64}$ 取模的值。", "hint": "样例 $1$：不改变 $b$，让 $a_1$ 增加 $2$，$a_2$ 增加 $1$，总花费为 $4$。\n\n样例 $2$：交换 $b_1,b_3$，让 $a_1$ 增加 $2$，总花费为 $2$。\n\n样例 $3$：不做任何改变。\n\n**本题输入量较大，请使用读入优化。**\n\n\n\n| 测试点 |$n$  |$a_i$  |特殊性质|\n| :----------: | :----------: | :----------: |  :----------: |\n| $1,2$ |$\\leq10$  |$\\leq10^9$  |无 |\n| $3\\sim6$ |$\\leq10^3$  |$\\leq10^9$  |无| \n| $7\\sim10$ |$\\leq10^6$  |$\\leq10^6$  | 无|\n| $11\\sim14$ |$\\leq10^6$  |$\\leq10^9$  |所有 $b_i$ 相等 |\n| $15\\sim20$ |$\\leq10^6$  |$\\leq10^9$  |无|\n\n对于所有数据 $1 \\leq n \\leq 10^6$，$1\\leq a_i,b_i\\leq10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "修改", "background": "", "description": "给定一个长度为 $n$ 的整数序列 $a_i$，再给定一个长度为 $n$ 的整数序列 $b_i$。\n\n你可以进行一些修改，每次你可以将一个 $a_i$ 增加 $1$，花费为 $b_i$，你需要使所有的 $a_i$ 不相等，且同时满足花费最少。\n\n但 zbw 认为太过简单，于是他规定，你可以在修改前进行**无限**次如下操作：交换 $b_i,b_j(1 \\leq i,j \\leq n)$。\n\n求最小的花费。\n\n**由于答案可能很大，请输出答案对  $2^{64}$ 取模后的值。**\n\n\n", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数，第 $i$ 个数表示 $a_i$。\n\n第三行 $n$ 个整数，第 $i$ 个数表示 $b_i$。", "outputFormat": "输出一行一个整数，表示答案对 $2^{64}$ 取模的值。", "hint": "样例 $1$：不改变 $b$，让 $a_1$ 增加 $2$，$a_2$ 增加 $1$，总花费为 $4$。\n\n样例 $2$：交换 $b_1,b_3$，让 $a_1$ 增加 $2$，总花费为 $2$。\n\n样例 $3$：不做任何改变。\n\n**本题输入量较大，请使用读入优化。**\n\n\n\n| 测试点 |$n$  |$a_i$  |特殊性质|\n| :----------: | :----------: | :----------: |  :----------: |\n| $1,2$ |$\\leq10$  |$\\leq10^9$  |无 |\n| $3\\sim6$ |$\\leq10^3$  |$\\leq10^9$  |无| \n| $7\\sim10$ |$\\leq10^6$  |$\\leq10^6$  | 无|\n| $11\\sim14$ |$\\leq10^6$  |$\\leq10^9$  |所有 $b_i$ 相等 |\n| $15\\sim20$ |$\\leq10^6$  |$\\leq10^9$  |无|\n\n对于所有数据 $1 \\leq n \\leq 10^6$，$1\\leq a_i,b_i\\leq10^9$。", "locale": "zh-CN"}}}
{"pid": "P6156", "type": "P", "difficulty": 6, "samples": [["3 3", "1216"], ["2 6", "9714"], ["18 2", "260108"], ["143 1", "7648044"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2020", "莫比乌斯反演", "分块", "差分"], "title": "简单题", "background": "zbw 遇上了一道题，由于他急着去找 qby，所以他想让你来帮他做。", "description": "给你 $n,k$ 求下式的值：\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n(i+j)^kf(\\gcd(i,j))\\gcd(i,j)$\n\n其中 $\\gcd(i,j)$ 表示 $i,j$ 的最大公约数。\n\n$f$ 函数定义如下：\n\n如果 $k$ 有平方因子 $f(k)=0$，否则 $f(k)=1$。\n\n**Update:平方因子定义 如果存在一个整数 $k(k>1),k^2|n$ 则 $k$ 是 $n$ 的一个平方因子** \n\n**请输出答案对 $998244353$ 取模的值。**", "inputFormat": "一行两个整数 $n,k$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "|  测试点|$n$  |$k$  |\n| :----------: | :----------: | :----------: |\n| $1,2$ |$\\leq10^3$  |$\\leq10^3$  |\n| $3,4$ |$\\leq2 \\times 10^3$  |$\\leq10^{18}$  |\n| $5 \\sim8$ | $\\leq5 \\times 10^4$ |$\\leq10^{18}$  |\n| $9$ |$\\leq 5\\times10^6$  |$=1$  |\n| $10,11$ |$\\leq 5\\times10^6$  | $=2$ |\n| $12,13$ | $\\leq 5\\times10^6$ | $\\leq10^3$ |\n| $14 \\sim20$ | $\\leq 5\\times10^6$ | $\\leq10^{18}$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5 \\times 10^6$，$1 \\leq k \\leq 10^{18}$。\n\n**Update on 2020/3/16:**\n\n时间调至 $1$s,卡掉了 $O(n\\log k)$,$O(n\\log mod)$ 的做法。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "简单题", "background": "zbw 遇上了一道题，由于他急着去找 qby，所以他想让你来帮他做。", "description": "给你 $n,k$ 求下式的值：\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n(i+j)^kf(\\gcd(i,j))\\gcd(i,j)$\n\n其中 $\\gcd(i,j)$ 表示 $i,j$ 的最大公约数。\n\n$f$ 函数定义如下：\n\n如果 $k$ 有平方因子 $f(k)=0$，否则 $f(k)=1$。\n\n**Update:平方因子定义 如果存在一个整数 $k(k>1),k^2|n$ 则 $k$ 是 $n$ 的一个平方因子** \n\n**请输出答案对 $998244353$ 取模的值。**", "inputFormat": "一行两个整数 $n,k$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "|  测试点|$n$  |$k$  |\n| :----------: | :----------: | :----------: |\n| $1,2$ |$\\leq10^3$  |$\\leq10^3$  |\n| $3,4$ |$\\leq2 \\times 10^3$  |$\\leq10^{18}$  |\n| $5 \\sim8$ | $\\leq5 \\times 10^4$ |$\\leq10^{18}$  |\n| $9$ |$\\leq 5\\times10^6$  |$=1$  |\n| $10,11$ |$\\leq 5\\times10^6$  | $=2$ |\n| $12,13$ | $\\leq 5\\times10^6$ | $\\leq10^3$ |\n| $14 \\sim20$ | $\\leq 5\\times10^6$ | $\\leq10^{18}$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5 \\times 10^6$，$1 \\leq k \\leq 10^{18}$。\n\n**Update on 2020/3/16:**\n\n时间调至 $1$s,卡掉了 $O(n\\log k)$,$O(n\\log mod)$ 的做法。", "locale": "zh-CN"}}}
{"pid": "P6157", "type": "P", "difficulty": 6, "samples": [["7\n1 2\n2 3\n2 4\n1 5\n5 6\n5 7\n5 4 3 2 1 4 3\n6\n1 3 4\n1 2 5\n1 2 1\n0 2 1\n1 2 5\n1 2 1", "3 4\n4 3\n4 3\n1 4\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "线段树", "树链剖分"], "title": "有趣的游戏", "background": "小 A 和小 B 正在玩一个有趣的电脑游戏。", "description": "游戏在一棵大小为 $n$ 的树上进行。其中每个点都有点权，第 $i$ 个点的点权为 $w_i$。\n\n每一次系统会给出一条链，小 A 可以从这条链上找出两个**点权不同**的点 $x,y$，他的得分是 $w_x\\bmod w_y$。然后小 B 会从**整棵树**中选取两个**小 A 没有选过**的点，计分方式同小 A。\n\n为了保持游戏难度，系统有时会增加一个点的权值。\n\n当然，小 A 会尽可能使自己得分最大，他想知道这个值是多少。同时，他想知道，在自己得分最大的情况下，小 B 的最大得分是多少。", "inputFormat": "第一行一个整数 $n$ 表示树的节点个数。\n\n接下来 $n-1$ 行，每行两个整数 $a,b$，表示 $a,b$ 之间有一条边。\n\n接下来一行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个点的点权。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行三个整数 $opt,x,y$。\n\n若 $opt=0$，将  $w_x$ 增加 $y$。\n\n若 $opt=1$，表示系统给出一条从 $x$ 到 $y$ 的链。", "outputFormat": "对于每一次 $opt=1$，输出一行两个整数 $suma,sumb$ 。分别表示小 A 的最大得分和在这情况下小 B 的最大得分 。\n\n**如果小 A 无法选出两个权值不同的点，那么只输出一个数 $-1$。**", "hint": "样例解释：\n\n第一次：小 A 选择点 $3$ 和点 $2$，得分为 $3\\bmod 4=3$，小 B 选择点 $6$ 和点 $1$ 得分为 $4\\bmod 5=4$。\n\n第二次：小 A 选择点 $2$ 和点 $1$，得分为 $4\\bmod 5=4$，小 B 选择点 $7$ 和点 $6$ 得分为 $3\\bmod 4=3$。\n\n第三次：小 A 选择点 $2$ 和点 $1$，得分为 $4\\bmod 5=4$，小 B 选择点 $7$ 和点 $6$ 得分为 $3\\bmod 4=3$。\n\n第四次：第 $2$ 个点点权变为 $5$。\n\n第五次：小 A 选择点 $5$ 和点 $1$，得分为 $1\\bmod 5=1$，小 B 选择点 $6$ 和点 $2$ 得分为 $4\\bmod 5=4$。\n\n第六次：小 A 可以选的点只有 $1,2$ ，点权都是 $5$，没有可以选的方案。\n\n**本题采用捆绑测试。**\n| Subtasks |$n,q$  |特殊性质  |分数  |\n| :----------: | :----------: | :----------: | :----------: |\n|Subtask1  |$\\leq10^3$  |无  |$10$  |\n|Subtask2  |$\\leq10^5$  |树的形态，点权随机  |$15$  |\n|Subtask3  |$\\leq10^5$  |最多有 $5$ 种不同的点权，且没有修改 |$15$  |\n|Subtask4  |$\\leq10^5$  |树为一条链，且第 $i$ $(i>1)$ 个点的父亲为 $i-1$ |$25$  |\n|Subtask5  |$\\leq10^5$  |无  |$35$  |\n\n对于所有数据 $1 \\leq n,q \\leq 10^5$，$1 \\leq w_i \\leq 10^4$，增加的数为不大于 $10^3$ 的正整数，且输入为一棵合法的树。**保证任何时候不同种类的数大于等于 $4$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "有趣的游戏", "background": "小 A 和小 B 正在玩一个有趣的电脑游戏。", "description": "游戏在一棵大小为 $n$ 的树上进行。其中每个点都有点权，第 $i$ 个点的点权为 $w_i$。\n\n每一次系统会给出一条链，小 A 可以从这条链上找出两个**点权不同**的点 $x,y$，他的得分是 $w_x\\bmod w_y$。然后小 B 会从**整棵树**中选取两个**小 A 没有选过**的点，计分方式同小 A。\n\n为了保持游戏难度，系统有时会增加一个点的权值。\n\n当然，小 A 会尽可能使自己得分最大，他想知道这个值是多少。同时，他想知道，在自己得分最大的情况下，小 B 的最大得分是多少。", "inputFormat": "第一行一个整数 $n$ 表示树的节点个数。\n\n接下来 $n-1$ 行，每行两个整数 $a,b$，表示 $a,b$ 之间有一条边。\n\n接下来一行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个点的点权。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行三个整数 $opt,x,y$。\n\n若 $opt=0$，将  $w_x$ 增加 $y$。\n\n若 $opt=1$，表示系统给出一条从 $x$ 到 $y$ 的链。", "outputFormat": "对于每一次 $opt=1$，输出一行两个整数 $suma,sumb$ 。分别表示小 A 的最大得分和在这情况下小 B 的最大得分 。\n\n**如果小 A 无法选出两个权值不同的点，那么只输出一个数 $-1$。**", "hint": "样例解释：\n\n第一次：小 A 选择点 $3$ 和点 $2$，得分为 $3\\bmod 4=3$，小 B 选择点 $6$ 和点 $1$ 得分为 $4\\bmod 5=4$。\n\n第二次：小 A 选择点 $2$ 和点 $1$，得分为 $4\\bmod 5=4$，小 B 选择点 $7$ 和点 $6$ 得分为 $3\\bmod 4=3$。\n\n第三次：小 A 选择点 $2$ 和点 $1$，得分为 $4\\bmod 5=4$，小 B 选择点 $7$ 和点 $6$ 得分为 $3\\bmod 4=3$。\n\n第四次：第 $2$ 个点点权变为 $5$。\n\n第五次：小 A 选择点 $5$ 和点 $1$，得分为 $1\\bmod 5=1$，小 B 选择点 $6$ 和点 $2$ 得分为 $4\\bmod 5=4$。\n\n第六次：小 A 可以选的点只有 $1,2$ ，点权都是 $5$，没有可以选的方案。\n\n**本题采用捆绑测试。**\n| Subtasks |$n,q$  |特殊性质  |分数  |\n| :----------: | :----------: | :----------: | :----------: |\n|Subtask1  |$\\leq10^3$  |无  |$10$  |\n|Subtask2  |$\\leq10^5$  |树的形态，点权随机  |$15$  |\n|Subtask3  |$\\leq10^5$  |最多有 $5$ 种不同的点权，且没有修改 |$15$  |\n|Subtask4  |$\\leq10^5$  |树为一条链，且第 $i$ $(i>1)$ 个点的父亲为 $i-1$ |$25$  |\n|Subtask5  |$\\leq10^5$  |无  |$35$  |\n\n对于所有数据 $1 \\leq n,q \\leq 10^5$，$1 \\leq w_i \\leq 10^4$，增加的数为不大于 $10^3$ 的正整数，且输入为一棵合法的树。**保证任何时候不同种类的数大于等于 $4$。**", "locale": "zh-CN"}}}
