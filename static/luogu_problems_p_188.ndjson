{"pid": "P4801", "type": "P", "difficulty": 5, "samples": [["3 20\n18\n25\n18", "7 16"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2015", "枚举", "排序", "CCO（加拿大）"], "title": "[CCO 2015] 饥饿的狐狸", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/index.html) Day1 T1「[Hungry Fox](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/stage%202/day1.pdf)」**\n\n到你的宠物狐狸的晚餐时间啦！他的晚餐包含 $N$ 块饼干，第 $i$ 块饼干的温度是 $T_i$ 摄氏度。同时，在晚餐中还包含了一大盘 $W$ 摄氏度的水。\n\n在喝了一口水之后，你的狐狸开始吃饭了。每当他吃一块饼干时，这块饼干的美味度为当前饼干与吃/喝的前一样食物（包括饼干和水）的温度的差的绝对值。它可以在任意时间喝水（保证水喝不完），或按任意顺序吃饼干。\n\n最后狐狸获得的美味值为它吃下的每块饼干的美味度之和。请求出狐狸获得的最小和最大的美味值。", "inputFormat": "第一行两个整数 $N,W$，表示饼干总数和水的温度。  \n\n接下来 $N$ 行，每行一个整数 $T_i(1\\le i\\le N)$ 表示第 $i$ 块饼干的温度。", "outputFormat": "输出两个整数，分别为狐狸获得的最小和最大的美味值。", "hint": "要得到最小美味值，一种可行的方案是，狐狸先喝水，然后吃第一块饼干，再吃第三块饼干，接着喝水，最后吃下第二块饼干，这样做，它所感受到的温度分别为 $20,18,18,20,25$ 摄氏度，总的美味度为 $2+0+5=7$。\n\n要得到最大美味值，一种可行的方案是，狐狸先喝水，然后按顺序吃饼干，它所感受到的温度分别为 $20,18,25,18$ 摄氏度，总的美味度为 $2+7+7=16$。\n\n对于 $30\\%$ 及以上的数据， $W=0$；  \n\n对于 $100\\%$ 的数据， $1\\le N \\le 100000, 0\\le W \\le 10^9, 0 \\le T _ i \\le 10 ^ 9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Hungry Fox", "background": "", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/index.html) Day 1 T1 “[Hungry Fox](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/stage%202/day1.pdf)”.**\n\nIt is dinner time for your pet fox. His dinner contains $N$ cookies, and the temperature of the $i$-th cookie is $T_i$ degrees Celsius. Also, there is a large bowl of water at $W$ degrees Celsius.\n\nAfter taking a sip of water, your fox starts eating. Each time he eats a cookie, the tastiness of this cookie is the absolute value of the difference between the current cookie’s temperature and the temperature of the previous item he ate or drank (including both cookies and water). He may drink water at any time (the water never runs out), and he may eat the cookies in any order.\n\nThe fox’s final tastiness value is the sum of the tastiness of every cookie he eats. Please find the minimum and maximum possible tastiness values the fox can obtain.", "inputFormat": "The first line contains two integers $N, W$, representing the number of cookies and the temperature of the water.\n\nThe next $N$ lines each contain one integer $T_i \\ (1 \\le i \\le N)$, representing the temperature of the $i$-th cookie.", "outputFormat": "Output two integers: the minimum and the maximum tastiness values the fox can obtain.", "hint": "To achieve the minimum tastiness value, one possible plan is: the fox drinks water first, then eats the first cookie, then the third cookie, then drinks water, and finally eats the second cookie. In this way, the temperatures he experiences are $20, 18, 18, 20, 25$ degrees Celsius, and the total tastiness is $2 + 0 + 5 = 7$.\n\nTo achieve the maximum tastiness value, one possible plan is: the fox drinks water first, then eats the cookies in order. The temperatures he experiences are $20, 18, 25, 18$ degrees Celsius, and the total tastiness is $2 + 7 + 7 = 16$.\n\nFor at least $30\\%$ of the testdata, $W = 0$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 100000$, $0 \\le W \\le 10^9$, $0 \\le T_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 饥饿的狐狸", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/index.html) Day1 T1「[Hungry Fox](https://cemc.math.uwaterloo.ca/contests/computing/past_ccc_contests/2015/stage%202/day1.pdf)」**\n\n到你的宠物狐狸的晚餐时间啦！他的晚餐包含 $N$ 块饼干，第 $i$ 块饼干的温度是 $T_i$ 摄氏度。同时，在晚餐中还包含了一大盘 $W$ 摄氏度的水。\n\n在喝了一口水之后，你的狐狸开始吃饭了。每当他吃一块饼干时，这块饼干的美味度为当前饼干与吃/喝的前一样食物（包括饼干和水）的温度的差的绝对值。它可以在任意时间喝水（保证水喝不完），或按任意顺序吃饼干。\n\n最后狐狸获得的美味值为它吃下的每块饼干的美味度之和。请求出狐狸获得的最小和最大的美味值。", "inputFormat": "第一行两个整数 $N,W$，表示饼干总数和水的温度。  \n\n接下来 $N$ 行，每行一个整数 $T_i(1\\le i\\le N)$ 表示第 $i$ 块饼干的温度。", "outputFormat": "输出两个整数，分别为狐狸获得的最小和最大的美味值。", "hint": "要得到最小美味值，一种可行的方案是，狐狸先喝水，然后吃第一块饼干，再吃第三块饼干，接着喝水，最后吃下第二块饼干，这样做，它所感受到的温度分别为 $20,18,18,20,25$ 摄氏度，总的美味度为 $2+0+5=7$。\n\n要得到最大美味值，一种可行的方案是，狐狸先喝水，然后按顺序吃饼干，它所感受到的温度分别为 $20,18,25,18$ 摄氏度，总的美味度为 $2+7+7=16$。\n\n对于 $30\\%$ 及以上的数据， $W=0$；  \n\n对于 $100\\%$ 的数据， $1\\le N \\le 100000, 0\\le W \\le 10^9, 0 \\le T _ i \\le 10 ^ 9$。", "locale": "zh-CN"}}}
{"pid": "P4802", "type": "P", "difficulty": 4, "samples": [["3 3\n0 2 5\n0 1 4\n1 2 3", "7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["搜索", "2015", "CCO（加拿大）", "状压 DP"], "title": "[CCO 2015] 路短最", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day1 T2「[Artskjid](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)」**\n\n你可以通过许多的算法找到从一个地方到另外一个地方的最短路径。人们在他们的车上安装 GPS 设备然后他们的手机告诉他们最快的到达目的地的方式。然而，当在假期时，Troy 喜欢慢慢旅游。他想找最长的到目的地的路径以便他可以在路途中看许多新的以及有趣的地方。\n\n因此，一个有效的路径包含一个不同城市的序列 $c_1,c_2,...,c_k$，并且对于每个 $1\\le i<k$，有道路从 $c_i$ 通往 $c_{i+1}$。\n\n他不想重复访问任何城市，请帮他找出最长路径。", "inputFormat": "第一行输入包括两个整数 $n,m$，分别表示城市总数和连接城市间的道路数，两城市间至多有一条道路。城市编号从 $0$ 到 $n-1$，Troy 一开始在城市 $0$，城市 $n-1$ 是他的目的地。\n\n接下来 $m$ 行每行三个整数 $s,d,l$，每个三元组表示这里有一条长为 $l$ 的从城市 $s$ 到城市 $d$ 的路。每条路都是有向的，只能从 $s$ 到 $d$，不能反向。保证有一条从城市 $0$ 到 $n-1$ 的路径。", "outputFormat": "输出一个整数表示以城市 $0$ 为起点，以 $n-1$ 为终点的最长路径长度，并且其中不重复访问城市，路径长度是所经过的道路长度之和。", "hint": "最短路为直接走城市 $0$ 至城市 $2$ 的道路，长度为 $5$ km。最长路为 $0$ 至 $1$ 至 $2$， 长度 $4+3=7$ km。\n\n对于至少 $30\\%$ 的数据，$n\\le 8$；  \n\n对于 $100\\%$ 的数据，有 $2\\le n \\le 18,$ $1\\le m \\le n^2-n,$ $0\\le s,d \\le n-1,$ $s\\neq d,$ $1\\le l\\le 10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Shortest-Longest Path", "background": "", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day 1 T2 “[Artskjid](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)”**.\n\nYou can use many algorithms to find the shortest path from one place to another. People install GPS devices in their cars, and then their phones tell them the fastest way to reach the destination. However, when on vacation, Troy likes to travel slowly. He wants to find the longest path to the destination so that he can see many new and interesting places along the way.\n\nTherefore, a valid path consists of a sequence of distinct cities $c_1,c_2,\\ldots,c_k$, and for each $1\\le i<k$, there is a road from $c_i$ to $c_{i+1}$.\n\nHe does not want to visit any city more than once. Please help him find the longest path.", "inputFormat": "The first line contains two integers $n,m$, representing the number of cities and the number of roads between cities. There is at most one road between any pair of cities. Cities are numbered from $0$ to $n-1$. Troy starts at city $0$, and city $n-1$ is his destination.\n\nThe next $m$ lines each contain three integers $s,d,l$. Each triple indicates that there is a directed road of length $l$ from city $s$ to city $d$. Each road is one-way: you can only travel from $s$ to $d$, not in the reverse direction. It is guaranteed that there is a path from city $0$ to city $n-1$.", "outputFormat": "Output one integer: the length of the longest path that starts at city $0$ and ends at city $n-1$, without visiting any city more than once. The path length is the sum of the lengths of the roads used.", "hint": "The shortest path is to take the road directly from city $0$ to city $2$, with length $5$ km. The longest path is $0 \\to 1 \\to 2$, with length $4+3=7$ km.\n\nFor at least $30\\%$ of the testdata, $n\\le 8$.\n\nFor $100\\%$ of the testdata, $2\\le n \\le 18$, $1\\le m \\le n^2-n$, $0\\le s,d \\le n-1$, $s\\neq d$, $1\\le l\\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 路短最", "background": "", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day1 T2「[Artskjid](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)」**\n\n你可以通过许多的算法找到从一个地方到另外一个地方的最短路径。人们在他们的车上安装 GPS 设备然后他们的手机告诉他们最快的到达目的地的方式。然而，当在假期时，Troy 喜欢慢慢旅游。他想找最长的到目的地的路径以便他可以在路途中看许多新的以及有趣的地方。\n\n因此，一个有效的路径包含一个不同城市的序列 $c_1,c_2,...,c_k$，并且对于每个 $1\\le i<k$，有道路从 $c_i$ 通往 $c_{i+1}$。\n\n他不想重复访问任何城市，请帮他找出最长路径。", "inputFormat": "第一行输入包括两个整数 $n,m$，分别表示城市总数和连接城市间的道路数，两城市间至多有一条道路。城市编号从 $0$ 到 $n-1$，Troy 一开始在城市 $0$，城市 $n-1$ 是他的目的地。\n\n接下来 $m$ 行每行三个整数 $s,d,l$，每个三元组表示这里有一条长为 $l$ 的从城市 $s$ 到城市 $d$ 的路。每条路都是有向的，只能从 $s$ 到 $d$，不能反向。保证有一条从城市 $0$ 到 $n-1$ 的路径。", "outputFormat": "输出一个整数表示以城市 $0$ 为起点，以 $n-1$ 为终点的最长路径长度，并且其中不重复访问城市，路径长度是所经过的道路长度之和。", "hint": "最短路为直接走城市 $0$ 至城市 $2$ 的道路，长度为 $5$ km。最长路为 $0$ 至 $1$ 至 $2$， 长度 $4+3=7$ km。\n\n对于至少 $30\\%$ 的数据，$n\\le 8$；  \n\n对于 $100\\%$ 的数据，有 $2\\le n \\le 18,$ $1\\le m \\le n^2-n,$ $0\\le s,d \\le n-1,$ $s\\neq d,$ $1\\le l\\le 10000$。", "locale": "zh-CN"}}}
{"pid": "P4803", "type": "P", "difficulty": 5, "samples": [["12 4 3 3\n1 4 5\n2 2 3\n6 3 6\n2 1\n1 8\n3 0", "11\n6\n0"]], "limits": {"time": [15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000, 15000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "二分", "CCO（加拿大）", "前缀和"], "title": "[CCO 2015] 太阳能飞行", "background": "**警告：滥用本题评测将被封号**", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day1 T3「[Solar Flight](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)」**\n\n航空的新纪元正在来临——第一个太阳能驱动的巨型喷气式飞机即将商用！然而，公众对前沿技术有一些在安全方面的焦虑，因为驱动飞机的阳光的光线可能会被其他在空中的物体挡住。因此，必须先进行一些统计和计算来规划第一次航行。\n\n我们考虑一个包含 $N$ 个从一个城市到另外一个城市的航路组成的图。一架飞机可以被考虑成一个点。它穿过的天空可以被模型化为一个笛卡尔坐标系，其中 $X$ 轴表示从任意一个点向东出发的距离，$Y$ 轴表示高度。我们只考虑 $x$ 值的范围在 $[0,X]$，所有航路均为直线的部分。第 $i$ 架飞机从 $(0,A_i)$ 飞到 $(X,B_i)$。所有$A$值互不相同，对于$B$也如此。飞机以未知的，可能是非恒定的速度沿着航路行驶，所以任意时间点，飞机可能在航路的任意位置上。然而，已知的是飞机从不与其他飞机相撞，所以如果两个航道交错，两个飞机不会同时到达交点。\n\n每个飞机 $i$ 同时也有一个干扰因素值 $C_i$，表示一个飞机影响它下面飞机太阳吸收能力的强弱。\n\n各个飞机上的太阳能板非常奇怪，那些太阳能板只能收集飞机正上方的能量。这就意味着一个飞机能吸收的阳光可能会被其他与其的 $x$ 值相同，但是 $y$ 值比他大的飞机挡住。具体来说，太阳能板吸收的太阳光减少的值为挡住它的飞机的干扰因素值之和。\n\n根据这些信息，以及一个距离常数 $K$，你要回答 $Q$ 个关于可能对太阳能板影响的询问。第 $i$ 个询问询问你在一个时刻飞机 $P_i$ 的太阳能板吸收的太阳光减少的值。在任意时刻飞机的 $x$ 值均在 $[S_i,S_i+K]$之间。", "inputFormat": "第一行四个整数 $X,K,N,Q$，分别表示最大考虑的 $x$ 值，距离常数，航路总数，询问总数。\n\n接下来 $N$ 行每行三个整数 $A_i,B_i,C_i(1\\le i \\le N)$，表示飞机 $i$ 初始 $y$ 值，终止 $y$值，干扰因素值。\n\n接下来 $Q$ 行每行两个整数，$P_i, S_i(1\\le i \\le Q)$，表示根据 $P_i$ 和 $S_i$ 回答题目中的问题。", "outputFormat": "输出 $Q$ 行，每行一个整数表示对于询问 $i(1\\le i \\le Q)$ 的回答。", "hint": "飞机的航路示意图如下图所示。\n\n![CCO2015D1T3Pic1](https://cdn.luogu.com.cn/upload/image_hosting/dur1tb8u.png)\n\n询问 $1$ 是对于 $2$ 号飞机在 $[1,5]$ 范围内所提出的询问，当飞机在 $x\\le 4$ 时可能会被飞机 $3$ 挡住，但是绝不是飞机 $1$。然而，但是当它的 $x>4$ 时可能会被其他所有飞机挡住，因此，该询问的答案即其他所有飞机的影响因素值之和，为 $5+6=11$。\n\n对于询问 $2$，当 $x<10$ 时飞机 $1$ 可能会被飞机 $3$ 挡住，并且当 $x\\geq10$ 时不会被任何飞机盖住，因此只可能被飞机 $3$ 影响，即结果等于飞机 $3$ 的影响因素值 $6$。\n\n对于询问 $3$，飞机 $1,2$ 都不能在飞机 $3$ 的正上方除非 $x$ 达到 $10$。所以该询问的答案为0。\n\n对于 $40\\%$ 的数据，$Q\\le 1000$。  \n\n对于 $100\\%$ 的数据，$1\\le N\\le 2000,$ $1\\le K\\le X,$ $1\\le X,A_i,B_i,C_i\\le 10^9,$ $0\\le S_i\\le X-K,$ $1\\le Q \\le 800000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2015] Solar Flight", "background": "**Warning: abusing the judging system for this problem will result in your account being banned.**", "description": "**This problem is translated from [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day 1 T3 “[Solar Flight](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)”.**\n\nA new era of aviation is coming—the first solar-powered giant jet airliner is about to enter commercial service. However, the public has some safety concerns about cutting-edge technology, because the sunlight that powers the plane may be blocked by other objects in the sky. Therefore, some statistics and calculations must be done first to plan the first flight.\n\nWe consider a graph consisting of $N$ air routes from one city to another. An airplane can be regarded as a point. The sky it travels through can be modeled as a Cartesian coordinate system, where the $X$ axis represents the distance eastward from any point, and the $Y$ axis represents altitude. We only consider $x$ values in the range $[0,X]$, and all routes are straight line segments. Plane $i$ flies from $(0,A_i)$ to $(X,B_i)$. All $A$ values are distinct, and all $B$ values are also distinct. Planes move along their routes at an unknown, possibly non-constant speed, so at any time, a plane may be at any position on its route. However, it is known that planes never collide with each other, so if two routes intersect, the two planes will never reach the intersection point at the same time.\n\nEach plane $i$ also has an interference value $C_i$, which represents how strongly a plane affects the solar energy absorption of planes below it.\n\nThe solar panels on each plane are very strange: they can only collect energy directly above the plane. This means that the sunlight a plane can absorb may be blocked by other planes that have the same $x$ value but a larger $y$ value. Specifically, the amount by which the absorbed sunlight is reduced equals the sum of the interference values of the planes blocking it.\n\nGiven this information and a distance constant $K$, you need to answer $Q$ queries about possible effects on the solar panels. Query $i$ asks for the reduction in absorbed sunlight for plane $P_i$ at some moment, where at that moment the plane’s $x$ value lies within $[S_i,S_i+K]$.", "inputFormat": "The first line contains four integers $X,K,N,Q$, representing the maximum $x$ value considered, the distance constant, the total number of routes, and the number of queries.\n\nThe next $N$ lines each contain three integers $A_i,B_i,C_i(1\\le i \\le N)$, representing plane $i$’s starting $y$ value, ending $y$ value, and interference value.\n\nThe next $Q$ lines each contain two integers $P_i, S_i(1\\le i \\le Q)$, meaning you should answer the question described above based on $P_i$ and $S_i$.", "outputFormat": "Output $Q$ lines. Each line contains one integer: the answer to query $i(1\\le i \\le Q)$.", "hint": "A diagram of the flight routes is shown below.\n\n![CCO2015D1T3Pic1](https://cdn.luogu.com.cn/upload/image_hosting/dur1tb8u.png)\n\nQuery $1$ asks about plane $2$ within the range $[1,5]$. When the plane is at $x\\le 4$, it may be blocked by plane $3$, but never by plane $1$. However, when $x>4$, it may be blocked by all other planes. Therefore, the answer to this query is the sum of the interference values of all other planes, which is $5+6=11$.\n\nFor query $2$, when $x<10$, plane $1$ may be blocked by plane $3$, and when $x\\geq10$, it will not be blocked by any plane. Therefore, it can only be affected by plane $3$, so the result equals plane $3$’s interference value $6$.\n\nFor query $3$, planes $1$ and $2$ cannot be directly above plane $3$ unless $x$ reaches $10$. Therefore, the answer to this query is $0$.\n\nFor $40\\%$ of the testdata, $Q\\le 1000$.\n\nFor $100\\%$ of the testdata, $1\\le N\\le 2000,$ $1\\le K\\le X,$ $1\\le X,A_i,B_i,C_i\\le 10^9,$ $0\\le S_i\\le X-K,$ $1\\le Q \\le 800000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2015] 太阳能飞行", "background": "**警告：滥用本题评测将被封号**", "description": "**本题译自 [CCO 2015](https://cemc.math.uwaterloo.ca/contests/computing/2015/index.html) Day1 T3「[Solar Flight](https://cemc.math.uwaterloo.ca/contests/computing/2015/stage%202/day1.pdf)」**\n\n航空的新纪元正在来临——第一个太阳能驱动的巨型喷气式飞机即将商用！然而，公众对前沿技术有一些在安全方面的焦虑，因为驱动飞机的阳光的光线可能会被其他在空中的物体挡住。因此，必须先进行一些统计和计算来规划第一次航行。\n\n我们考虑一个包含 $N$ 个从一个城市到另外一个城市的航路组成的图。一架飞机可以被考虑成一个点。它穿过的天空可以被模型化为一个笛卡尔坐标系，其中 $X$ 轴表示从任意一个点向东出发的距离，$Y$ 轴表示高度。我们只考虑 $x$ 值的范围在 $[0,X]$，所有航路均为直线的部分。第 $i$ 架飞机从 $(0,A_i)$ 飞到 $(X,B_i)$。所有$A$值互不相同，对于$B$也如此。飞机以未知的，可能是非恒定的速度沿着航路行驶，所以任意时间点，飞机可能在航路的任意位置上。然而，已知的是飞机从不与其他飞机相撞，所以如果两个航道交错，两个飞机不会同时到达交点。\n\n每个飞机 $i$ 同时也有一个干扰因素值 $C_i$，表示一个飞机影响它下面飞机太阳吸收能力的强弱。\n\n各个飞机上的太阳能板非常奇怪，那些太阳能板只能收集飞机正上方的能量。这就意味着一个飞机能吸收的阳光可能会被其他与其的 $x$ 值相同，但是 $y$ 值比他大的飞机挡住。具体来说，太阳能板吸收的太阳光减少的值为挡住它的飞机的干扰因素值之和。\n\n根据这些信息，以及一个距离常数 $K$，你要回答 $Q$ 个关于可能对太阳能板影响的询问。第 $i$ 个询问询问你在一个时刻飞机 $P_i$ 的太阳能板吸收的太阳光减少的值。在任意时刻飞机的 $x$ 值均在 $[S_i,S_i+K]$之间。", "inputFormat": "第一行四个整数 $X,K,N,Q$，分别表示最大考虑的 $x$ 值，距离常数，航路总数，询问总数。\n\n接下来 $N$ 行每行三个整数 $A_i,B_i,C_i(1\\le i \\le N)$，表示飞机 $i$ 初始 $y$ 值，终止 $y$值，干扰因素值。\n\n接下来 $Q$ 行每行两个整数，$P_i, S_i(1\\le i \\le Q)$，表示根据 $P_i$ 和 $S_i$ 回答题目中的问题。", "outputFormat": "输出 $Q$ 行，每行一个整数表示对于询问 $i(1\\le i \\le Q)$ 的回答。", "hint": "飞机的航路示意图如下图所示。\n\n![CCO2015D1T3Pic1](https://cdn.luogu.com.cn/upload/image_hosting/dur1tb8u.png)\n\n询问 $1$ 是对于 $2$ 号飞机在 $[1,5]$ 范围内所提出的询问，当飞机在 $x\\le 4$ 时可能会被飞机 $3$ 挡住，但是绝不是飞机 $1$。然而，但是当它的 $x>4$ 时可能会被其他所有飞机挡住，因此，该询问的答案即其他所有飞机的影响因素值之和，为 $5+6=11$。\n\n对于询问 $2$，当 $x<10$ 时飞机 $1$ 可能会被飞机 $3$ 挡住，并且当 $x\\geq10$ 时不会被任何飞机盖住，因此只可能被飞机 $3$ 影响，即结果等于飞机 $3$ 的影响因素值 $6$。\n\n对于询问 $3$，飞机 $1,2$ 都不能在飞机 $3$ 的正上方除非 $x$ 达到 $10$。所以该询问的答案为0。\n\n对于 $40\\%$ 的数据，$Q\\le 1000$。  \n\n对于 $100\\%$ 的数据，$1\\le N\\le 2000,$ $1\\le K\\le X,$ $1\\le X,A_i,B_i,C_i\\le 10^9,$ $0\\le S_i\\le X-K,$ $1\\le Q \\le 800000$。", "locale": "zh-CN"}}}
{"pid": "P4804", "type": "P", "difficulty": 6, "samples": [["7 1\n0000001", "1000010"], ["5 3\n01011", "10100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "CCC（加拿大）"], "title": "[CCC 2016] 生命中的圆", "background": "", "description": "**译自 [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T5「[Circle of Life](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)」**\n\n> 也许你听说过康威生命游戏（Conway's Game of Life）。康威生命游戏适用于方格组成的矩阵。但它可以产生十分复杂的结构。在这道题目中，我们将使用简化版的生命游戏来虐你。\n\n这个游戏是 0 人游戏，换句话说，只要给定初始条件，这个游戏就能自己进行下去。\n\n将一个圆环分为 $N$ 段，将这 $N$ 段顺时针依次编为 $1,\\dots,N$ 号。每一段要么是活的（以 `1` 表示），要么是死的（以 `0` 表示）。\n\n游戏会进行 $T$ 轮「变化」。如果一个方格**恰好**有一个相邻的方格在这次变化中存活，那么该方格会在下次变化中存活。否则，该方格会死亡。\n\n给定圆环的初始状态，求经过 $T$ 次变化之后的状态。", "inputFormat": "第一行，两个整数 $N$ 和 $T(3 \\le N \\le 100\\ 000;1 \\le T \\le 10^{15})$。\n\n第二行，一个长度为 $N$ 的字符串，表示 $N$ 个方格的初始状态。保证每个字符只有 `0` 或 `1` 两种可能。第 $i$ 位表示编号为 $i$ 的方格的初始状态。", "outputFormat": "输出一个长度为 $N$ 的字符串，表示最终的状态。格式同输入。", "hint": "#### 样例解释 1\n方格 $1$ 和 $N - 1$ 和 $N$ 相邻，因此在一次变化后仍存活。\n\n#### 样例解释 2\n一次变化后，状态为 ` 00011`。\n\n两次变化后，状态为 ` 10111`。\n\n对于 $\\frac{1}{15}$ 的数据，$N \\le 15,T \\le 15$。\n\n对于另外的 $\\frac{6}{15}$ 的数据，$N \\le 15$。\n\n对于另外的 $\\frac{4}{15}$ 的数据，$N \\le 4000,T \\le 10\\ 000\\ 000$。\n\n注意对于所有的数据，你需要使用 64 位整数。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2016] Circle of Life", "background": "", "description": "**Translated from [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T5 “[Circle of Life](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)”**\n\n> You may have heard of Conway's Game of Life. Conway's Game of Life runs on a grid matrix. However, it can produce very complex structures. In this problem, we will use a simplified version of the Game of Life.\n\nThis is a zero-player game. In other words, once the initial condition is given, the game runs by itself.\n\nDivide a ring into $N$ segments, and label these $N$ segments clockwise as $1,\\dots,N$. Each segment is either alive (represented by `1`) or dead (represented by `0`).\n\nThe game will go through $T$ rounds of “changes”. If a cell has **exactly** one adjacent cell that is alive during this change, then the cell will be alive in the next change. Otherwise, the cell will be dead.\n\nGiven the initial state of the ring, find the state after $T$ changes.", "inputFormat": "The first line contains two integers $N$ and $T(3 \\le N \\le 100\\ 000;1 \\le T \\le 10^{15})$.\n\nThe second line contains a string of length $N$, describing the initial states of the $N$ cells. Each character is guaranteed to be either `0` or `1`. The $i$-th character represents the initial state of cell $i$.", "outputFormat": "Output a string of length $N$, representing the final state. The format is the same as the input.", "hint": "#### Sample Explanation 1\n\nCells $1$, $N - 1$, and $N$ are adjacent, so they remain alive after one change.\n\n#### Sample Explanation 2\n\nAfter one change, the state is `00011`.\n\nAfter two changes, the state is `10111`.\n\nFor $\\frac{1}{15}$ of the testdata, $N \\le 15,T \\le 15$.\n\nFor another $\\frac{6}{15}$ of the testdata, $N \\le 15$.\n\nFor another $\\frac{4}{15}$ of the testdata, $N \\le 4000,T \\le 10\\ 000\\ 000$.\n\nNote that for all testdata, you need to use 64-bit integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2016] 生命中的圆", "background": "", "description": "**译自 [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T5「[Circle of Life](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)」**\n\n> 也许你听说过康威生命游戏（Conway's Game of Life）。康威生命游戏适用于方格组成的矩阵。但它可以产生十分复杂的结构。在这道题目中，我们将使用简化版的生命游戏来虐你。\n\n这个游戏是 0 人游戏，换句话说，只要给定初始条件，这个游戏就能自己进行下去。\n\n将一个圆环分为 $N$ 段，将这 $N$ 段顺时针依次编为 $1,\\dots,N$ 号。每一段要么是活的（以 `1` 表示），要么是死的（以 `0` 表示）。\n\n游戏会进行 $T$ 轮「变化」。如果一个方格**恰好**有一个相邻的方格在这次变化中存活，那么该方格会在下次变化中存活。否则，该方格会死亡。\n\n给定圆环的初始状态，求经过 $T$ 次变化之后的状态。", "inputFormat": "第一行，两个整数 $N$ 和 $T(3 \\le N \\le 100\\ 000;1 \\le T \\le 10^{15})$。\n\n第二行，一个长度为 $N$ 的字符串，表示 $N$ 个方格的初始状态。保证每个字符只有 `0` 或 `1` 两种可能。第 $i$ 位表示编号为 $i$ 的方格的初始状态。", "outputFormat": "输出一个长度为 $N$ 的字符串，表示最终的状态。格式同输入。", "hint": "#### 样例解释 1\n方格 $1$ 和 $N - 1$ 和 $N$ 相邻，因此在一次变化后仍存活。\n\n#### 样例解释 2\n一次变化后，状态为 ` 00011`。\n\n两次变化后，状态为 ` 10111`。\n\n对于 $\\frac{1}{15}$ 的数据，$N \\le 15,T \\le 15$。\n\n对于另外的 $\\frac{6}{15}$ 的数据，$N \\le 15$。\n\n对于另外的 $\\frac{4}{15}$ 的数据，$N \\le 4000,T \\le 10\\ 000\\ 000$。\n\n注意对于所有的数据，你需要使用 64 位整数。", "locale": "zh-CN"}}}
{"pid": "P4805", "type": "P", "difficulty": 4, "samples": [["7\n47 12 12 3 9 9 3", "48"], ["4\n1 2 3 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2016", "CCC（加拿大）", "区间 DP", "双指针 two-pointer"], "title": "[CCC 2016] 合并饭团", "background": "", "description": "**译自 [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T4「[Combining Riceballs](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)」**\n\nAlphonse 有 $N$ 个美味的饭团，它们大小不一，摆放成一行。他想把最大的饭团让给自己的基友。他可以执行以下操作：\n\n - 如果两个**相邻的**饭团大小相同，Alphonse 可以把它们合并成一个新的饭团。新饭团的大小是两个原饭团大小之和。它将占据两个原饭团先前占据的位置。\n\n - 如果两个饭团大小相同，且它们之间只有一个饭团，Alphonse 也可以把它们合并成一个新的饭团。（中间的饭团大小没有规定。）新饭团的大小是三个原饭团大小之和，并占据三个原饭团先前的位置。\n\nAlphonse 可以按照他的意愿执行任意次操作。\n\n在执行 0 或更多次操作后，确定他应该把哪个饭团让给基友。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 400)$。\n\n第二行，$N$ 个以空格分隔的整数，表示每个饭团的大小，按照从左到右的顺序给出。每个整数的上界为 $1\\ 000\\ 000$。", "outputFormat": "输出 Alphonse 可以得到的最大的饭团大小。", "hint": "#### 样例解释 1\n有一种可能的合并方案为：合并大小同为 $12$ 的两个饭团，得到一个大小为 $24$ 的饭团。然后合并大小同为 $9$ 的两个饭团，得到一个大小为 $18$。接着合并大小为 $3,18$ 和 $3$ 的三个饭团，得到一个大小为 $24$ 的饭团。最后合并大小同为 $24$ 的两个饭团，得到一个大小为 $48$ 的饭团。\n\n#### 样例解释 2\n我们无法进行操作，所以答案为 $3$。\n\n对于 $\\frac1{15}$ 的数据，$N = 4$。\n\n对于另外 $\\frac2{15}$ 的数据，$N \\le 10$。\n\n对于另外 $\\frac5{15}$ 的数据，$N \\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2016] Combining Riceballs", "background": "", "description": "**Translated from [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T4 “[Combining Riceballs](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)”**\n\nAlphonse has $N$ delicious riceballs of different sizes, arranged in a line. He wants to give the largest riceball to his best friend. He can perform the following operations:\n\n- If two **adjacent** riceballs have the same size, Alphonse can combine them into one new riceball. The new riceball’s size is the sum of the two original riceballs’ sizes. It will occupy the positions previously occupied by the two original riceballs.\n\n- If two riceballs have the same size, and there is exactly one riceball between them, Alphonse can also combine them into one new riceball. (There is no restriction on the middle riceball’s size.) The new riceball’s size is the sum of the three original riceballs’ sizes, and it occupies the positions previously occupied by the three original riceballs.\n\nAlphonse may perform the operations any number of times, in any order.\n\nAfter performing $0$ or more operations, determine which riceball he should give to his friend.", "inputFormat": "The first line contains an integer $N$ $(1 \\le N \\le 400)$.\n\nThe second line contains $N$ space-separated integers, giving the sizes of the riceballs from left to right. Each integer is at most $1\\ 000\\ 000$.", "outputFormat": "Output the maximum riceball size that Alphonse can obtain.", "hint": "#### Sample Explanation 1.\nOne possible sequence of merges is: combine the two riceballs of size $12$ to get a riceball of size $24$. Then combine the two riceballs of size $9$ to get a riceball of size $18$. Next, combine the three riceballs of size $3, 18,$ and $3$ to get a riceball of size $24$. Finally, combine the two riceballs of size $24$ to get a riceball of size $48$.\n\n#### Sample Explanation 2.\nWe cannot perform any operation, so the answer is $3$.\n\nFor $\\frac1{15}$ of the testdata, $N = 4$.\n\nFor another $\\frac2{15}$ of the testdata, $N \\le 10$.\n\nFor another $\\frac5{15}$ of the testdata, $N \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2016] 合并饭团", "background": "", "description": "**译自 [CCC2016](https://cemc.math.uwaterloo.ca/contests/computing/2016/index.html) Senior T4「[Combining Riceballs](https://cemc.math.uwaterloo.ca/contests/computing/2016/stage%201/seniorEn.pdf)」**\n\nAlphonse 有 $N$ 个美味的饭团，它们大小不一，摆放成一行。他想把最大的饭团让给自己的基友。他可以执行以下操作：\n\n - 如果两个**相邻的**饭团大小相同，Alphonse 可以把它们合并成一个新的饭团。新饭团的大小是两个原饭团大小之和。它将占据两个原饭团先前占据的位置。\n\n - 如果两个饭团大小相同，且它们之间只有一个饭团，Alphonse 也可以把它们合并成一个新的饭团。（中间的饭团大小没有规定。）新饭团的大小是三个原饭团大小之和，并占据三个原饭团先前的位置。\n\nAlphonse 可以按照他的意愿执行任意次操作。\n\n在执行 0 或更多次操作后，确定他应该把哪个饭团让给基友。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 400)$。\n\n第二行，$N$ 个以空格分隔的整数，表示每个饭团的大小，按照从左到右的顺序给出。每个整数的上界为 $1\\ 000\\ 000$。", "outputFormat": "输出 Alphonse 可以得到的最大的饭团大小。", "hint": "#### 样例解释 1\n有一种可能的合并方案为：合并大小同为 $12$ 的两个饭团，得到一个大小为 $24$ 的饭团。然后合并大小同为 $9$ 的两个饭团，得到一个大小为 $18$。接着合并大小为 $3,18$ 和 $3$ 的三个饭团，得到一个大小为 $24$ 的饭团。最后合并大小同为 $24$ 的两个饭团，得到一个大小为 $48$ 的饭团。\n\n#### 样例解释 2\n我们无法进行操作，所以答案为 $3$。\n\n对于 $\\frac1{15}$ 的数据，$N = 4$。\n\n对于另外 $\\frac2{15}$ 的数据，$N \\le 10$。\n\n对于另外 $\\frac5{15}$ 的数据，$N \\le 50$。", "locale": "zh-CN"}}}
{"pid": "P4806", "type": "P", "difficulty": 6, "samples": [["4 4 0\n1 2 1\n2 3 2\n3 4 1\n4 1 1", "1"], ["5 6 2\n1 2 5\n2 3 5\n1 4 5\n4 5 5\n1 3 1\n1 5 1", "2"], ["4 4 0\n1 2 715827882\n2 3 715827882\n3 4 715827882\n4 1 715827884", "0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "CCC（加拿大）", "生成树", "最近公共祖先 LCA"], "title": "[CCC 2017] 最小费用流", "background": "", "description": " **译自 [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T4「[Minimum Cost Flow](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)」**\n\nWatermoo 中有编号为 $1,2,\\dots,N$ 的建筑物。其中还有 $M$ 条管道将建筑物两两连接。由于城市规划的疏漏，$1$ 号建筑是全市唯一的污水处理厂。每条管道可能是*活动的*或是*非活动的*。如果建筑 $1$ 通过活动管道直接或是间接地与其他每个建筑连通，则称活动管道集是一个有效的方案。（每条管道将两个建筑直接连接。如果建筑 $X$ 直接或间接连接建筑 $Y$，且建筑 $Y$ 直接或间接连接建筑 $Z$，那么我们说 $X$ 和 $Z$ 间接连接。）\n\nWatermoo 的市政府正在使用一个 $N-1$ 条管道组成的显然有效的方案，但是这使得政府已经透支很多经费了！每条管道都有各自的月维修费，这是在其活动时必须支付的，一个有效方案的总成本为所有有效管道的维修费的总和。（非活动的管道不花费一分钱。）\n\n此外，一个好消息是：Watermoo 大学的研究人员开发出了一种不完善的管道推进器，你可以在一条管道上使用它。它将从 $C$ 到 $\\mathrm{max}(0,C-D)$ 降低该管道的维修成本，$D$ 为该推进器的强度。\n\n市政府希望将成本降到最低，同时也希望你能尽快完成这个任务。每天，城市会允许你激活一条管道并关闭另一条管道。问：你需要多少天才能使一组活动管道形成一个有效方案并使其在所有有效方案和推进方案中费用最小？\n\n请注意，在你规划的过程中方案可能会无效，但是到最后，他应该是一个有效的方案。", "inputFormat": "第一行，三个整数 $N,M$ 和 $D(1 \\le N \\le 100\\ 000,N - 1 \\le M \\le 200\\ 000,0 \\le D \\le 10^9)$。\n\n接下来 $M$ 行，每行三个整数 $A_i,B_i$ 和 $C_i$，表示有一条月维修成本为 $C_i$ 的管道从建筑 $A_i$ 连接到建筑 $B_i(1 \\le A_i,B_i \\le N,1 \\le C_i \\le 10^9)$。\n\n前 $N-1$ 行表示 Watermoo 正在使用的有效方案。\n\n保证数据没有重边和自环。", "outputFormat": "输出一行，一个整数，表示完成任务的最小天数。如果初始方案即最优方案，输出`0`。", "hint": "#### 样例解释 1\n因为 $D=0$，所以管道推进器一无是处。\n\n第一天，你应当关闭建筑 $2$ 到 $3$ 的管道并激活建筑 $4$ 到 $1$ 的管道。\n\n#### 样例解释 2\n一个可行的解为：首先在连接建筑 $1,2$ 的管道上安装推进器，使成本降低到 $3$。第一天，以连接 $1,3$ 的管道替换连接 $2,3$ 的管道。第二天，以连接 $1,5$ 的管道替换连接 $1,4$ 的管道。\n\n此外，在连接 $1,3$ 或连接 $1,5$ 的管道上安装推进器毫无意义。这样做将会使得该管道的维修成本为 $0$，最优的费用为 $11$ （如你所见，我们已经找到了费用为 $10$ 的方案）。\n\n#### 样例解释 3\n初始的方案即最优方案。请注意整数上溢。\n\n对于 $\\frac3{15}$ 的数据，$N \\le 8,M \\le 28,D=0$。\n\n对于另外 $\\frac5{15}$ 的数据，$N \\le 1\\ 000,M \\le 5\\ 000,D=0$。\n\n对于另外 $\\frac3{15}$ 的数据，$D=0$。\n\n对于另外 $\\frac2{15}$ 的数据，$N \\le 1\\ 000,M \\le 5\\ 000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2017] Minimum Cost Flow", "background": "", "description": "**Translated from [CCC 2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T4 “[Minimum Cost Flow](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)”.**\n\nIn Watermoo, there are buildings numbered $1,2,\\dots,N$. There are also $M$ pipes, each connecting a pair of buildings. Due to an oversight in city planning, Building $1$ is the only sewage treatment plant in the city. Each pipe can be *active* or *inactive*. If Building $1$ is directly or indirectly connected to every other building using only active pipes, then the set of active pipes is called a valid plan. (Each pipe directly connects two buildings. If building $X$ is directly or indirectly connected to building $Y$, and building $Y$ is directly or indirectly connected to building $Z$, then we say $X$ and $Z$ are indirectly connected.)\n\nThe city government of Watermoo is currently using an obviously valid plan consisting of exactly $N-1$ pipes, but this has already pushed the budget too far. Each pipe has its own monthly maintenance cost, which must be paid if the pipe is active. The total cost of a valid plan is the sum of the maintenance costs of all active pipes. (Inactive pipes cost nothing.)\n\nThere is also good news: researchers at Watermoo University have developed an imperfect pipe booster, which you may use on exactly one pipe. It reduces that pipe’s maintenance cost from $C$ to $\\mathrm{max}(0,C-D)$, where $D$ is the strength of the booster.\n\nThe government wants to minimize the cost, and also wants you to finish as quickly as possible. Each day, the city allows you to activate one pipe and deactivate one other pipe. How many days do you need so that the set of active pipes forms a valid plan and has the minimum possible cost among all valid plans and all choices of where to use the booster?\n\nNote that during your process, the plan may be invalid, but in the end it must be a valid plan.", "inputFormat": "The first line contains three integers $N, M$ and $D(1 \\le N \\le 100\\ 000, N - 1 \\le M \\le 200\\ 000, 0 \\le D \\le 10^9)$.\n\nThe next $M$ lines each contain three integers $A_i, B_i$ and $C_i$, meaning there is a pipe with monthly maintenance cost $C_i$ connecting building $A_i$ and building $B_i$ $(1 \\le A_i, B_i \\le N, 1 \\le C_i \\le 10^9)$.\n\nThe first $N-1$ of these $M$ lines describe the valid plan Watermoo is currently using.\n\nIt is guaranteed that there are no multiple edges and no self-loops in the testdata.", "outputFormat": "Output one line containing an integer, the minimum number of days needed to finish the task. If the initial plan is already optimal, output `0`.", "hint": "#### Sample Explanation 1\n\nSince $D=0$, the pipe booster is useless.\n\nOn the first day, you should deactivate the pipe between buildings $2$ and $3$ and activate the pipe between buildings $4$ and $1$.\n\n#### Sample Explanation 2\n\nOne feasible solution is: first install the booster on the pipe connecting buildings $1$ and $2$, reducing its cost to $3$. On the first day, replace the pipe connecting $2$ and $3$ with the pipe connecting $1$ and $3$. On the second day, replace the pipe connecting $1$ and $4$ with the pipe connecting $1$ and $5$.\n\nIn addition, installing the booster on the pipe connecting $1$ and $3$ or the pipe connecting $1$ and $5$ is meaningless. Doing so would make that pipe’s maintenance cost $0$, and the optimal total cost would be $11$ (as you can see, we have already found a plan with total cost $10$).\n\n#### Sample Explanation 3\n\nThe initial plan is already optimal. Please note integer overflow.\n\nFor $\\frac3{15}$ of the testdata, $N \\le 8, M \\le 28, D=0$.\n\nFor another $\\frac5{15}$ of the testdata, $N \\le 1\\ 000, M \\le 5\\ 000, D=0$.\n\nFor another $\\frac3{15}$ of the testdata, $D=0$.\n\nFor another $\\frac2{15}$ of the testdata, $N \\le 1\\ 000, M \\le 5\\ 000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2017] 最小费用流", "background": "", "description": " **译自 [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T4「[Minimum Cost Flow](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)」**\n\nWatermoo 中有编号为 $1,2,\\dots,N$ 的建筑物。其中还有 $M$ 条管道将建筑物两两连接。由于城市规划的疏漏，$1$ 号建筑是全市唯一的污水处理厂。每条管道可能是*活动的*或是*非活动的*。如果建筑 $1$ 通过活动管道直接或是间接地与其他每个建筑连通，则称活动管道集是一个有效的方案。（每条管道将两个建筑直接连接。如果建筑 $X$ 直接或间接连接建筑 $Y$，且建筑 $Y$ 直接或间接连接建筑 $Z$，那么我们说 $X$ 和 $Z$ 间接连接。）\n\nWatermoo 的市政府正在使用一个 $N-1$ 条管道组成的显然有效的方案，但是这使得政府已经透支很多经费了！每条管道都有各自的月维修费，这是在其活动时必须支付的，一个有效方案的总成本为所有有效管道的维修费的总和。（非活动的管道不花费一分钱。）\n\n此外，一个好消息是：Watermoo 大学的研究人员开发出了一种不完善的管道推进器，你可以在一条管道上使用它。它将从 $C$ 到 $\\mathrm{max}(0,C-D)$ 降低该管道的维修成本，$D$ 为该推进器的强度。\n\n市政府希望将成本降到最低，同时也希望你能尽快完成这个任务。每天，城市会允许你激活一条管道并关闭另一条管道。问：你需要多少天才能使一组活动管道形成一个有效方案并使其在所有有效方案和推进方案中费用最小？\n\n请注意，在你规划的过程中方案可能会无效，但是到最后，他应该是一个有效的方案。", "inputFormat": "第一行，三个整数 $N,M$ 和 $D(1 \\le N \\le 100\\ 000,N - 1 \\le M \\le 200\\ 000,0 \\le D \\le 10^9)$。\n\n接下来 $M$ 行，每行三个整数 $A_i,B_i$ 和 $C_i$，表示有一条月维修成本为 $C_i$ 的管道从建筑 $A_i$ 连接到建筑 $B_i(1 \\le A_i,B_i \\le N,1 \\le C_i \\le 10^9)$。\n\n前 $N-1$ 行表示 Watermoo 正在使用的有效方案。\n\n保证数据没有重边和自环。", "outputFormat": "输出一行，一个整数，表示完成任务的最小天数。如果初始方案即最优方案，输出`0`。", "hint": "#### 样例解释 1\n因为 $D=0$，所以管道推进器一无是处。\n\n第一天，你应当关闭建筑 $2$ 到 $3$ 的管道并激活建筑 $4$ 到 $1$ 的管道。\n\n#### 样例解释 2\n一个可行的解为：首先在连接建筑 $1,2$ 的管道上安装推进器，使成本降低到 $3$。第一天，以连接 $1,3$ 的管道替换连接 $2,3$ 的管道。第二天，以连接 $1,5$ 的管道替换连接 $1,4$ 的管道。\n\n此外，在连接 $1,3$ 或连接 $1,5$ 的管道上安装推进器毫无意义。这样做将会使得该管道的维修成本为 $0$，最优的费用为 $11$ （如你所见，我们已经找到了费用为 $10$ 的方案）。\n\n#### 样例解释 3\n初始的方案即最优方案。请注意整数上溢。\n\n对于 $\\frac3{15}$ 的数据，$N \\le 8,M \\le 28,D=0$。\n\n对于另外 $\\frac5{15}$ 的数据，$N \\le 1\\ 000,M \\le 5\\ 000,D=0$。\n\n对于另外 $\\frac3{15}$ 的数据，$D=0$。\n\n对于另外 $\\frac2{15}$ 的数据，$N \\le 1\\ 000,M \\le 5\\ 000$。", "locale": "zh-CN"}}}
{"pid": "P4807", "type": "P", "difficulty": 6, "samples": [["5 2 5\n1 2 1 2 2\n1 2 3 4 5\n1 1 5\n2 1\n1 3 5\n2 2\n1 1 3", "15\n10\n9"], ["3 1 7\n1 1 1\n114 101 109\n1 1 1\n2 1\n1 1 1\n2 1\n1 1 1\n2 1\n1 1 1", "114\n109\n101\n114"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2017", "CCC（加拿大）"], "title": "[CCC 2017] 地铁交通", "background": "**滥用本题评测将被封号**", "description": " **译自 [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T5「[RMT](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)」**\n\nRMT 地铁交通运行着一个不寻常的地铁系统。有 $N$ 个地铁站，从 $1$ 到 $N$ 编号。有 $M$ 条地铁线路，从 $1$ 到 $M$ 编号，每个地铁站只属于一条线路且每条线路至少经过一个地铁站。整个地铁网络呈圆形。也就是说，如果有一个编号为 $S$ 的地铁站，那么与它同一线路的下一个地铁站是下一个编号比它大的地铁站。除非 $S$ 是同线路中编号最大的地铁站，在这种情况下，它的下一个地铁站是同一线路中编号最小的地铁站。\n\nRMT 正在以志愿者对他们的系统进行负载测试。测试从每一站以一列地铁列车开始，且对于每一个 $i$，会有 $A_i$ 个志愿者在第 $i$ 站的测试列车上。在整个测试期间，志愿者不会离开对应的列车。\n\n测试过程中，RMT 会进行 $Q$ 个操作，每个操作只有两种可能：一种是询问第 $l$ 站到第 $r$ 站地铁上的志愿者人数；或是在线路 $x$ 运行所有的地铁。当有一列地铁在 $x$ 线路运行，它会前往线路中的下一站。\n\n你是 RMT 的铁杆骨灰级粉丝，所以你自愿协助他们进行操作并告诉他们操作的结果。", "inputFormat": "第一行，三个整数，$N,M$ 和 $Q(1 \\le M \\le N \\le 150\\ 000;1 \\le Q \\le 150\\ 000)$。\n\n第二行，$N$ 个整数 $L_1,L_2,\\dots,L_N$，表示每个地铁站所属线路的编号。\n\n第三行，$N$ 个整数 $A_1,A_2,\\dots,A_N$，表示每个地铁站起始时刻的志愿者人数。\n\n以下 $Q$ 行，每行只有以下其中一种形态：\n\n - `1 l r`，表示一个询问 $(1 \\le l \\le r \\le N)$。\n\n -  `2 x`，表示 RMT 会在 $x$ 线路运行 $(1 \\le x \\le M)$。", "outputFormat": "对于每个询问，输出一行，表示询问的答案。", "hint": "### 样例解释 1\n地铁系统如下图所示，地铁站编号为 $1$ 到 $5$，由编号为 $1$ 或 $2$ 的线路连接：\n\n![](https://i.loli.net/2018/08/16/5b74e41916341.png)\n\n开始时，每个地铁站的志愿者人数为 $\\{1,2,3,4,5\\}$。\n\n第一个询问的答案为 $1+2+3+4+5=15$。\n\n线路 $1$ 被运行之后，每个地铁站的志愿者人数为 $\\{3,2,1,4,5\\}$。\n\n第二个询问的答案为 $1+4+5=10$。\n\n线路 $2$ 被运行之后，每个地铁站的志愿者人数为 $\\{3,5,1,2,4\\}$。\n\n第三个询问的答案为 $3+5+1=9$。\n\n#### 样例解释 2\n地铁系统如下图所示，地铁站编号为 $1$ 到 $3$，只有线路 $1$ 连接：\n\n![](https://i.loli.net/2018/08/16/5b74e56617ad0.png)\n\n第一次询问之前，每个地铁站的志愿者人数为 $\\{114,101,109\\}$。\n\n第二次询问之前，每个地铁站的志愿者人数为 $\\{109,114,101\\}$。\n\n第三次询问之前，每个地铁站的志愿者人数为 $\\{101,109,114\\}$。\n\n第四次询问之前，每个地铁站的志愿者人数为 $\\{114,101,109\\}$。\n\n对于 $\\frac2{15}$ 的数据，$N \\le 1\\ 000,Q \\le 1\\ 000$。\n\n对于另外 $\\frac2{15}$ 的数据，$L_i \\le L{i+1}(1 \\le i < N)$。\n\n对于另外 $\\frac3{15}$ 的数据，$M \\le 200$。\n\n对于另外 $\\frac3{15}$ 的数据，每条线路的地铁数量都不超过 $200$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2017] Subway Transit", "background": "**Abusing the judging system for this problem will result in your account being banned.**", "description": "**Translated from [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T5 “[RMT](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)”.**\n\nRMT Subway Transit operates an unusual subway system. There are $N$ stations, numbered from $1$ to $N$. There are $M$ subway lines, numbered from $1$ to $M$. Each station belongs to exactly one line, and each line contains at least one station. The entire subway network is circular. That is, if there is a station numbered $S$, then the next station on the same line is the station on that line with the smallest number that is greater than $S$. Unless $S$ is the station with the largest number on that line, in which case its next station is the station with the smallest number on that line.\n\nRMT is using volunteers to load-test their system. The test starts with one subway train at each station, and for each $i$, there are $A_i$ volunteers on the test train at station $i$. Throughout the test, volunteers will not leave their corresponding trains.\n\nDuring the test, RMT will perform $Q$ operations. Each operation is one of two types: either query the number of volunteers on the trains from station $l$ to station $r$, or run all trains on line $x$. When a train runs on line $x$, it moves to the next station on that line.\n\nYou are a die-hard fan of RMT, so you volunteer to help them perform the operations and report the results.", "inputFormat": "The first line contains three integers $N, M$ and $Q(1 \\le M \\le N \\le 150\\ 000;1 \\le Q \\le 150\\ 000)$.\n\nThe second line contains $N$ integers $L_1, L_2, \\dots, L_N$, indicating the line number that each station belongs to.\n\nThe third line contains $N$ integers $A_1, A_2, \\dots, A_N$, indicating the initial number of volunteers at each station.\n\nThe next $Q$ lines are each in one of the following forms:\n\n- `1 l r`, indicating a query $(1 \\le l \\le r \\le N)$.\n\n- `2 x`, indicating that RMT runs line $x$ $(1 \\le x \\le M)$.", "outputFormat": "For each query, output one line containing the answer.", "hint": "### Sample Explanation 1\n\nThe subway system is shown in the figure below. Stations are numbered from $1$ to $5$, and are connected by line $1$ or $2$:\n\n![](https://i.loli.net/2018/08/16/5b74e41916341.png)\n\nAt the start, the number of volunteers at each station is $\\{1,2,3,4,5\\}$.\n\nThe answer to the first query is $1+2+3+4+5=15$.\n\nAfter line $1$ is run, the number of volunteers at each station becomes $\\{3,2,1,4,5\\}$.\n\nThe answer to the second query is $1+4+5=10$.\n\nAfter line $2$ is run, the number of volunteers at each station becomes $\\{3,5,1,2,4\\}$.\n\nThe answer to the third query is $3+5+1=9$.\n\n#### Sample Explanation 2\n\nThe subway system is shown in the figure below. Stations are numbered from $1$ to $3$, and only line $1$ connects them:\n\n![](https://i.loli.net/2018/08/16/5b74e56617ad0.png)\n\nBefore the first query, the number of volunteers at each station is $\\{114,101,109\\}$.\n\nBefore the second query, the number of volunteers at each station is $\\{109,114,101\\}$.\n\nBefore the third query, the number of volunteers at each station is $\\{101,109,114\\}$.\n\nBefore the fourth query, the number of volunteers at each station is $\\{114,101,109\\}$.\n\nFor $\\frac2{15}$ of the testdata, $N \\le 1\\ 000, Q \\le 1\\ 000$.\n\nFor another $\\frac2{15}$ of the testdata, $L_i \\le L{i+1}(1 \\le i < N)$.\n\nFor another $\\frac3{15}$ of the testdata, $M \\le 200$.\n\nFor another $\\frac3{15}$ of the testdata, each line has at most $200$ trains.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2017] 地铁交通", "background": "**滥用本题评测将被封号**", "description": " **译自 [CCC2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/index.html) Senior T5「[RMT](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%201/seniorEF.pdf)」**\n\nRMT 地铁交通运行着一个不寻常的地铁系统。有 $N$ 个地铁站，从 $1$ 到 $N$ 编号。有 $M$ 条地铁线路，从 $1$ 到 $M$ 编号，每个地铁站只属于一条线路且每条线路至少经过一个地铁站。整个地铁网络呈圆形。也就是说，如果有一个编号为 $S$ 的地铁站，那么与它同一线路的下一个地铁站是下一个编号比它大的地铁站。除非 $S$ 是同线路中编号最大的地铁站，在这种情况下，它的下一个地铁站是同一线路中编号最小的地铁站。\n\nRMT 正在以志愿者对他们的系统进行负载测试。测试从每一站以一列地铁列车开始，且对于每一个 $i$，会有 $A_i$ 个志愿者在第 $i$ 站的测试列车上。在整个测试期间，志愿者不会离开对应的列车。\n\n测试过程中，RMT 会进行 $Q$ 个操作，每个操作只有两种可能：一种是询问第 $l$ 站到第 $r$ 站地铁上的志愿者人数；或是在线路 $x$ 运行所有的地铁。当有一列地铁在 $x$ 线路运行，它会前往线路中的下一站。\n\n你是 RMT 的铁杆骨灰级粉丝，所以你自愿协助他们进行操作并告诉他们操作的结果。", "inputFormat": "第一行，三个整数，$N,M$ 和 $Q(1 \\le M \\le N \\le 150\\ 000;1 \\le Q \\le 150\\ 000)$。\n\n第二行，$N$ 个整数 $L_1,L_2,\\dots,L_N$，表示每个地铁站所属线路的编号。\n\n第三行，$N$ 个整数 $A_1,A_2,\\dots,A_N$，表示每个地铁站起始时刻的志愿者人数。\n\n以下 $Q$ 行，每行只有以下其中一种形态：\n\n - `1 l r`，表示一个询问 $(1 \\le l \\le r \\le N)$。\n\n -  `2 x`，表示 RMT 会在 $x$ 线路运行 $(1 \\le x \\le M)$。", "outputFormat": "对于每个询问，输出一行，表示询问的答案。", "hint": "### 样例解释 1\n地铁系统如下图所示，地铁站编号为 $1$ 到 $5$，由编号为 $1$ 或 $2$ 的线路连接：\n\n![](https://i.loli.net/2018/08/16/5b74e41916341.png)\n\n开始时，每个地铁站的志愿者人数为 $\\{1,2,3,4,5\\}$。\n\n第一个询问的答案为 $1+2+3+4+5=15$。\n\n线路 $1$ 被运行之后，每个地铁站的志愿者人数为 $\\{3,2,1,4,5\\}$。\n\n第二个询问的答案为 $1+4+5=10$。\n\n线路 $2$ 被运行之后，每个地铁站的志愿者人数为 $\\{3,5,1,2,4\\}$。\n\n第三个询问的答案为 $3+5+1=9$。\n\n#### 样例解释 2\n地铁系统如下图所示，地铁站编号为 $1$ 到 $3$，只有线路 $1$ 连接：\n\n![](https://i.loli.net/2018/08/16/5b74e56617ad0.png)\n\n第一次询问之前，每个地铁站的志愿者人数为 $\\{114,101,109\\}$。\n\n第二次询问之前，每个地铁站的志愿者人数为 $\\{109,114,101\\}$。\n\n第三次询问之前，每个地铁站的志愿者人数为 $\\{101,109,114\\}$。\n\n第四次询问之前，每个地铁站的志愿者人数为 $\\{114,101,109\\}$。\n\n对于 $\\frac2{15}$ 的数据，$N \\le 1\\ 000,Q \\le 1\\ 000$。\n\n对于另外 $\\frac2{15}$ 的数据，$L_i \\le L{i+1}(1 \\le i < N)$。\n\n对于另外 $\\frac3{15}$ 的数据，$M \\le 200$。\n\n对于另外 $\\frac3{15}$ 的数据，每条线路的地铁数量都不超过 $200$。", "locale": "zh-CN"}}}
{"pid": "P4808", "type": "P", "difficulty": 6, "samples": [["4", "3"], ["10", "13"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "CCC（加拿大）"], "title": "[CCC 2018] 平衡树", "background": "", "description": "**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S4「[Balanced Trees](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**\n\n我们定义「完美平衡树」如下：\n\n每棵完美平衡树都有一个正整数权值。权值为 $1$  的完美平衡树为只含有 $1$  个节点的树。否则，这棵树的权值为 $w(w\\ge2)$，则这棵树为一棵含有 $k(2\\le k\\le w)$ 棵子树的有根树。所有的 $k$ 棵子树都必须是相同的，且它的所有 $k$ 棵子树必须完全相同，且自身是完美平衡的。\n\n特别地，所有 $k$ 棵子树权值必须相同。它们的权值必须为 $\\left\\lfloor\\frac{w}{k}\\right\\rfloor$ 。例如，如果一棵权值为 $8$ 的完美平衡树有 $3$ 棵子树，那么每棵子树的权值为 $2$，因为 $2+2+2=6\\le8$。\n\n给定 $N$，求出权值为 $N$ 的完美平衡树的数量。\n", "inputFormat": "输入包含一行一个整数 $N$。", "outputFormat": "输出一个整数表示权值为 $N$ 的完美平衡树的数量。", "hint": "#### 样例解释 1\n\n合法的树如下：\n\n - 一棵以有 $4$ 棵权值为 $1$ 的子树为根的完美平衡树；\n - 一棵以有 $2$ 棵权值为 $2$ 的子树为根的完美平衡树；\n - 一棵以有 $3$ 棵权值为 $1$ 的子树为根的完美平衡树。\n\n对于 $33\\%$ 的数据，$N\\le1000$；  \n对于另外 $13\\%$ 的数据，$N\\le5\\times 10^4$；  \n对于另外 $13\\%$ 的数据，$N\\le10^6$；  \n对于全部的数据，$1\\le N\\le10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2018] Balanced Trees", "background": "", "description": "**This problem is translated from [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S4 “[Balanced Trees](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)”.**\n\nWe define a “perfectly balanced tree” as follows:\n\nEach perfectly balanced tree has a positive integer weight. A perfectly balanced tree with weight $1$ is a tree with only $1$ node. Otherwise, if the tree has weight $w(w\\ge2)$, then it is a rooted tree with $k(2\\le k\\le w)$ subtrees. All $k$ subtrees must be the same, and all of its $k$ subtrees must be exactly identical, and each subtree itself must be perfectly balanced.\n\nIn particular, the weights of all $k$ subtrees must be the same. Their weight must be $\\left\\lfloor\\frac{w}{k}\\right\\rfloor$. For example, if a perfectly balanced tree of weight $8$ has $3$ subtrees, then each subtree has weight $2$, because $2+2+2=6\\le8$.\n\nGiven $N$, find the number of perfectly balanced trees with weight $N$.", "inputFormat": "The input contains one line with one integer $N$.", "outputFormat": "Output one integer, the number of perfectly balanced trees with weight $N$.", "hint": "#### Sample Explanation 1\n\nThe valid trees are:\n\n- A perfectly balanced tree whose root has $4$ subtrees of weight $1$.\n- A perfectly balanced tree whose root has $2$ subtrees of weight $2$.\n- A perfectly balanced tree whose root has $3$ subtrees of weight $1$.\n\nConstraints:\n\nFor $33\\%$ of the testdata, $N\\le1000$.  \nFor another $13\\%$ of the testdata, $N\\le5\\times 10^4$.  \nFor another $13\\%$ of the testdata, $N\\le10^6$.  \nFor all testdata, $1\\le N\\le10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2018] 平衡树", "background": "", "description": "**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S4「[Balanced Trees](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**\n\n我们定义「完美平衡树」如下：\n\n每棵完美平衡树都有一个正整数权值。权值为 $1$  的完美平衡树为只含有 $1$  个节点的树。否则，这棵树的权值为 $w(w\\ge2)$，则这棵树为一棵含有 $k(2\\le k\\le w)$ 棵子树的有根树。所有的 $k$ 棵子树都必须是相同的，且它的所有 $k$ 棵子树必须完全相同，且自身是完美平衡的。\n\n特别地，所有 $k$ 棵子树权值必须相同。它们的权值必须为 $\\left\\lfloor\\frac{w}{k}\\right\\rfloor$ 。例如，如果一棵权值为 $8$ 的完美平衡树有 $3$ 棵子树，那么每棵子树的权值为 $2$，因为 $2+2+2=6\\le8$。\n\n给定 $N$，求出权值为 $N$ 的完美平衡树的数量。\n", "inputFormat": "输入包含一行一个整数 $N$。", "outputFormat": "输出一个整数表示权值为 $N$ 的完美平衡树的数量。", "hint": "#### 样例解释 1\n\n合法的树如下：\n\n - 一棵以有 $4$ 棵权值为 $1$ 的子树为根的完美平衡树；\n - 一棵以有 $2$ 棵权值为 $2$ 的子树为根的完美平衡树；\n - 一棵以有 $3$ 棵权值为 $1$ 的子树为根的完美平衡树。\n\n对于 $33\\%$ 的数据，$N\\le1000$；  \n对于另外 $13\\%$ 的数据，$N\\le5\\times 10^4$；  \n对于另外 $13\\%$ 的数据，$N\\le10^6$；  \n对于全部的数据，$1\\le N\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P4809", "type": "P", "difficulty": 5, "samples": [["2 2 1 2\n1 2 1\n2 1 1\n2 1 1", "3"], ["2 3 4 1\n2 3 5\n3 2 7\n1 2 6\n1 1 8\n2 1 5", "41"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "CCC（加拿大）"], "title": "[CCC 2018] 最大战略储备", "background": "", "description": "**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S5「[Maximum Strategic Savings](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**\n\n有 $N$ 个星球，编号为 $1\\ldots N$。每个星球有 $M$ 座城市，编号为 $1\\ldots M$。我们将 $e$ 星球上的城市 $f$ 记作 $(e,\\,f)$。\n\n有 $N\\times P$ 条双向航线，对于每个星球 $e(1\\le e\\le N)$，有 $P$ 条航线，编号为 $1$ 到 $P$。第 $i$ 条航线连接城市 $(e,\\,a_i)$ 和 $(e,\\,b_i)$，且每天需要花费 $c_i$ 的代价维护。\n\n有 $M\\times Q$ 个双向港口。对于所有编号为 $f(1\\le f\\le M)$ 的城市，有 $Q$ 个港口，编号为 $1$ 到 $Q$。第 $j$ 个港口可以连接城市 $(x_j,\\,f)$ 和 $(y_j,\\,f)$，且每天需要花费 $z_j$ 的代价维护。\n\n现在需要拆除一些港口和（或）取消一些航线，使得城市之间仍能保持联通，且节省的代价之和最大。", "inputFormat": "第一行四个整数，分别为 $N,\\,M,\\,P,\\,Q\\ (0\\le N,\\,M,\\,P,\\,Q\\le10^5)$。\n\n接下来 $P$ 行，每行三个整数 $a_i,\\,b_i,\\,c_i(1\\le a_i,\\,b_i\\le M,\\,1\\le c_i\\le10^8)$。\n\n再接下来 $Q$ 行，每行三个整数 $x_j,\\,y_j,\\,z_j(1\\le x_j,\\,y_j\\le N,\\,1\\le z_j\\le 10^8)$。\n\n数据保证城市之间两两联通，可能有重边或自环。", "outputFormat": "输出一行一个整数表示每天最多能节省的代价之和。", "hint": "#### 样例 2 解释\n一种可行的最优解是关闭城市 $(1,\\,1)$ 与 $(1,1)$、$(2,\\,1)$ 与 $(2,\\,1)$、$(1,\\,1)$ 与 $(1,\\,2)$、$(1,\\,3)$ 与 $(1,\\,2)$、$(2,\\,3)$ 与 $(2,\\,2)$ 之间的航线；并关闭城市 $(2,\\,3)$ 与 $(1,\\,3)$ 间的港口。最终可以节省 $8 + 8 + 6 + 7 + 7 + 5 = 41$ 的代价。\n\n对于 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le100$，且对于所有的 $1\\le i\\le P$，都有 $c_i=1$；对于所有的 $1\\le j\\le Q$，都有 $z_j=1$；\n\n对于另外 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le 200$；\n\n对于另外 $\\frac{5}{15}$ 的数据，$N,\\,M\\le 200$；\n\n对于全部的数据，$1\\le N,\\,M,\\,P,\\,Q\\le10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCC 2018] Maximum Strategic Savings", "background": "", "description": "**This problem is translated from [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S5 “[Maximum Strategic Savings](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)”.**\n\nThere are $N$ planets, numbered $1\\ldots N$. Each planet has $M$ cities, numbered $1\\ldots M$. We denote city $f$ on planet $e$ as $(e,\\,f)$.\n\nThere are $N\\times P$ undirected flight routes. For each planet $e(1\\le e\\le N)$, there are $P$ routes, numbered from $1$ to $P$. Route $i$ connects cities $(e,\\,a_i)$ and $(e,\\,b_i)$, and it costs $c_i$ per day to maintain.\n\nThere are $M\\times Q$ undirected ports. For every city index $f(1\\le f\\le M)$, there are $Q$ ports, numbered from $1$ to $Q$. Port $j$ can connect cities $(x_j,\\,f)$ and $(y_j,\\,f)$, and it costs $z_j$ per day to maintain.\n\nNow you need to remove some ports and/or cancel some flight routes such that all cities are still connected, and the total saved cost is maximized.", "inputFormat": "The first line contains four integers $N,\\,M,\\,P,\\,Q\\ (0\\le N,\\,M,\\,P,\\,Q\\le10^5)$.\n\nThe next $P$ lines each contain three integers $a_i,\\,b_i,\\,c_i(1\\le a_i,\\,b_i\\le M,\\,1\\le c_i\\le10^8)$.\n\nThe next $Q$ lines each contain three integers $x_j,\\,y_j,\\,z_j(1\\le x_j,\\,y_j\\le N,\\,1\\le z_j\\le 10^8)$.\n\nThe testdata guarantees that all cities are connected to each other. There may be multiple edges or self-loops.", "outputFormat": "Output one integer on a single line, representing the maximum total cost that can be saved per day.", "hint": "#### Explanation for Sample 2\n\nOne possible optimal solution is to close the flight routes between cities $(1,\\,1)$ and $(1,1)$, $(2,\\,1)$ and $(2,\\,1)$, $(1,\\,1)$ and $(1,\\,2)$, $(1,\\,3)$ and $(1,\\,2)$, and $(2,\\,3)$ and $(2,\\,2)$; and close the port between cities $(2,\\,3)$ and $(1,\\,3)$. In the end, you can save a cost of $8 + 8 + 6 + 7 + 7 + 5 = 41$.\n\nFor $\\frac{2}{15}$ of the testdata, $P,\\,Q\\le100$, and for all $1\\le i\\le P$, $c_i=1$; for all $1\\le j\\le Q$, $z_j=1$.\n\nFor another $\\frac{2}{15}$ of the testdata, $P,\\,Q\\le 200$.\n\nFor another $\\frac{5}{15}$ of the testdata, $N,\\,M\\le 200$.\n\nFor all testdata, $1\\le N,\\,M,\\,P,\\,Q\\le10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCC 2018] 最大战略储备", "background": "", "description": "**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S5「[Maximum Strategic Savings](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)」**\n\n有 $N$ 个星球，编号为 $1\\ldots N$。每个星球有 $M$ 座城市，编号为 $1\\ldots M$。我们将 $e$ 星球上的城市 $f$ 记作 $(e,\\,f)$。\n\n有 $N\\times P$ 条双向航线，对于每个星球 $e(1\\le e\\le N)$，有 $P$ 条航线，编号为 $1$ 到 $P$。第 $i$ 条航线连接城市 $(e,\\,a_i)$ 和 $(e,\\,b_i)$，且每天需要花费 $c_i$ 的代价维护。\n\n有 $M\\times Q$ 个双向港口。对于所有编号为 $f(1\\le f\\le M)$ 的城市，有 $Q$ 个港口，编号为 $1$ 到 $Q$。第 $j$ 个港口可以连接城市 $(x_j,\\,f)$ 和 $(y_j,\\,f)$，且每天需要花费 $z_j$ 的代价维护。\n\n现在需要拆除一些港口和（或）取消一些航线，使得城市之间仍能保持联通，且节省的代价之和最大。", "inputFormat": "第一行四个整数，分别为 $N,\\,M,\\,P,\\,Q\\ (0\\le N,\\,M,\\,P,\\,Q\\le10^5)$。\n\n接下来 $P$ 行，每行三个整数 $a_i,\\,b_i,\\,c_i(1\\le a_i,\\,b_i\\le M,\\,1\\le c_i\\le10^8)$。\n\n再接下来 $Q$ 行，每行三个整数 $x_j,\\,y_j,\\,z_j(1\\le x_j,\\,y_j\\le N,\\,1\\le z_j\\le 10^8)$。\n\n数据保证城市之间两两联通，可能有重边或自环。", "outputFormat": "输出一行一个整数表示每天最多能节省的代价之和。", "hint": "#### 样例 2 解释\n一种可行的最优解是关闭城市 $(1,\\,1)$ 与 $(1,1)$、$(2,\\,1)$ 与 $(2,\\,1)$、$(1,\\,1)$ 与 $(1,\\,2)$、$(1,\\,3)$ 与 $(1,\\,2)$、$(2,\\,3)$ 与 $(2,\\,2)$ 之间的航线；并关闭城市 $(2,\\,3)$ 与 $(1,\\,3)$ 间的港口。最终可以节省 $8 + 8 + 6 + 7 + 7 + 5 = 41$ 的代价。\n\n对于 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le100$，且对于所有的 $1\\le i\\le P$，都有 $c_i=1$；对于所有的 $1\\le j\\le Q$，都有 $z_j=1$；\n\n对于另外 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le 200$；\n\n对于另外 $\\frac{5}{15}$ 的数据，$N,\\,M\\le 200$；\n\n对于全部的数据，$1\\le N,\\,M,\\,P,\\,Q\\le10^5$。", "locale": "zh-CN"}}}
{"pid": "P4810", "type": "P", "difficulty": 5, "samples": [["5\na 0\na 1\nb 2\nc 2 3\nb 4", "2\n1\n2"], ["11\na 0\na 1\na 2\na 3\na 2\nc 4 5\na 5\na 6\nc 8 7\nb 8\nb 8", "2\n2\n8\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] STOGOVI", "background": "", "description": " **译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T5「STOGOVI」**\n\nMirko 正在玩栈。游戏开始时，他有一个编号为 $0$ 的空栈。在游戏中的第 $i$ 步，他会选择一个存在的编号为 $v$ 的栈，将它复制一份并进行以下其中一种操作：\n\n 1. 将数字 $i$ 加入新栈的顶部。\n\n 2. 将新栈顶部的数字删除。\n\n 3. 选择另外一个编号为 $w$ 的栈，并统计有多少个不同的数同时存在于新栈与栈 $w$ 中。\n\n新创建的栈编号为 $i$。\n\nMirko 不喜欢自己用栈模拟这个过程，所以他想要你替他写一个程序来执行这个过程。对于每个删除操作输出删除的数，且对于每个统计操作，输出统计的结果。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 300\\ 000)$，表示这局游戏的步数。\n\n游戏的步骤以时间顺序按前 $N$ 个整数编号。\n\n以下 $N$ 行，第 $i$ 行表示游戏的第 $i$ 步，为以下三种格式之一：\n\n - `a v`，表示加入操作。\n\n - `b v`，表示删除操作。\n\n - `c v w`，表示统计操作。\n\n操作所涉及的编号一定在 $[0,i-1]$ 中。\n\n保证删除操作不会操作空栈。", "outputFormat": "对于每个删除或统计操作，输出一行，表示请求的数字。按照输入文件给出的操作顺序排列。", "hint": "#### 样例解释 1\n\n开始时，我们有栈 $S_0 = \\{\\}$。\n\n第一步，我们复制 $S_0$ 并将数字 $1$ 加入到顶部，$S_1 = \\{1\\}$。\n\n第二步，我们复制 $S_1$ 并将数字 $2$ 加入到顶部，$S_2 = \\{1,2\\}$。\n\n第三步，我们复制 $S_2$ 并删除数字，$2$，$S_3 = \\{1\\}$。\n\n第四步，我们复制 $S_2$ 并编号为 $S_4$，统计有多少个不同的数同时存在于 $S_4$ 与 $S_3$ 中。唯一同时存在于两个栈中的数是 $1$，所以答案为 $1$。\n\n第五步，我们复制 $S_4$ 并删除数字，$2$，$S_5 = \\{1\\}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2014/2015 #3] STOGOVI", "background": "", "description": "**Translated from [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T5 “STOGOVI”.**\n\nMirko is playing with stacks. At the start of the game, he has an empty stack numbered $0$. In step $i$ of the game, he chooses an existing stack numbered $v$, makes a copy of it, and then performs one of the following operations:\n\n1. Push the number $i$ onto the top of the new stack.\n\n2. Pop (delete) the number on the top of the new stack.\n\n3. Choose another stack numbered $w$, and count how many distinct numbers appear in both the new stack and stack $w$.\n\nThe newly created stack is numbered $i$.\n\nMirko does not like simulating this process with stacks by himself, so he wants you to write a program to carry it out. For each pop operation, output the deleted number, and for each counting operation, output the result.", "inputFormat": "The first line contains an integer $N$ $(1 \\le N \\le 300\\ 000)$, the number of steps in the game.\n\nThe steps of the game are numbered by the first $N$ integers in chronological order.\n\nEach of the next $N$ lines describes step $i$ in one of the following three formats:\n\n- `a v`, meaning a push operation.\n\n- `b v`, meaning a pop operation.\n\n- `c v w`, meaning a counting operation.\n\nAll indices involved in an operation are guaranteed to be in $[0, i - 1]$.\n\nIt is guaranteed that no pop operation will be applied to an empty stack.", "outputFormat": "For each pop or counting operation, output one line containing the requested number, in the order of operations given in the input file.", "hint": "#### Sample Explanation 1\n\nAt the start, we have the stack $S_0 = \\{\\}$.\n\nIn the first step, we copy $S_0$ and push the number $1$ onto the top, so $S_1 = \\{1\\}$.\n\nIn the second step, we copy $S_1$ and push the number $2$ onto the top, so $S_2 = \\{1,2\\}$.\n\nIn the third step, we copy $S_2$ and pop the number $2$, so $S_3 = \\{1\\}$.\n\nIn the fourth step, we copy $S_2$ as $S_4$, and count how many distinct numbers appear in both $S_4$ and $S_3$. The only number that appears in both stacks is $1$, so the answer is $1$.\n\nIn the fifth step, we copy $S_4$ and pop the number $2$, so $S_5 = \\{1\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2014/2015 #3] STOGOVI", "background": "", "description": " **译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T5「STOGOVI」**\n\nMirko 正在玩栈。游戏开始时，他有一个编号为 $0$ 的空栈。在游戏中的第 $i$ 步，他会选择一个存在的编号为 $v$ 的栈，将它复制一份并进行以下其中一种操作：\n\n 1. 将数字 $i$ 加入新栈的顶部。\n\n 2. 将新栈顶部的数字删除。\n\n 3. 选择另外一个编号为 $w$ 的栈，并统计有多少个不同的数同时存在于新栈与栈 $w$ 中。\n\n新创建的栈编号为 $i$。\n\nMirko 不喜欢自己用栈模拟这个过程，所以他想要你替他写一个程序来执行这个过程。对于每个删除操作输出删除的数，且对于每个统计操作，输出统计的结果。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 300\\ 000)$，表示这局游戏的步数。\n\n游戏的步骤以时间顺序按前 $N$ 个整数编号。\n\n以下 $N$ 行，第 $i$ 行表示游戏的第 $i$ 步，为以下三种格式之一：\n\n - `a v`，表示加入操作。\n\n - `b v`，表示删除操作。\n\n - `c v w`，表示统计操作。\n\n操作所涉及的编号一定在 $[0,i-1]$ 中。\n\n保证删除操作不会操作空栈。", "outputFormat": "对于每个删除或统计操作，输出一行，表示请求的数字。按照输入文件给出的操作顺序排列。", "hint": "#### 样例解释 1\n\n开始时，我们有栈 $S_0 = \\{\\}$。\n\n第一步，我们复制 $S_0$ 并将数字 $1$ 加入到顶部，$S_1 = \\{1\\}$。\n\n第二步，我们复制 $S_1$ 并将数字 $2$ 加入到顶部，$S_2 = \\{1,2\\}$。\n\n第三步，我们复制 $S_2$ 并删除数字，$2$，$S_3 = \\{1\\}$。\n\n第四步，我们复制 $S_2$ 并编号为 $S_4$，统计有多少个不同的数同时存在于 $S_4$ 与 $S_3$ 中。唯一同时存在于两个栈中的数是 $1$，所以答案为 $1$。\n\n第五步，我们复制 $S_4$ 并删除数字，$2$，$S_5 = \\{1\\}$。\n", "locale": "zh-CN"}}}
{"pid": "P4811", "type": "P", "difficulty": 7, "samples": [["3 3\n3 1 3 1\n2 2 1\n3 3 1 3\n1 2\n2 3\n3 1", "1\n0\n2"], ["2 1\n4 1 6 3 6\n7 3 4 2 6 5 6 1\n1 2", "3"], ["3 4\n3 1 4 2\n4 3 4 2 4\n3 4 1 3\n1 2\n2 3\n3 1\n1 3", "2\n1\n2\n2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] KAMIONI", "background": null, "description": "**译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T6「KAMIONI」**\n\n有一条马路，我们将其视为一条数轴。马路上有 $N$ 辆卡车，开始时，卡车都在整点上。所有卡车一起开始移动，并且都以**同样的速率**移动。**没有卡车保持静止**。每辆卡车花 $1$ 分钟可以移动 $1$ 个单位距离。\n\n给出每辆卡车的「路线」。路线用一个含有 $k$ 个元素的数组 $A_1,A_2,\\dots,A_k$ 表示。该卡车首先 $A_1$ 开往 $A_2$，然后立即掉头开往 $A_3$，以此类推。忽略掉头的耗时。考虑到卡车会掉头，我们保证：\n\n$$A_1 < A_2 > A_3 < A_4 > \\dots\\ \\mathrm{or}\\ A_1 > A_2 < A_3 > A_4 < \\dots$$\n\n一条可能的路线为 $2→5→1→7$（给出的点要么是起点，要么是终点，要么就是掉头的位置）。开始时卡车位于 $2$，出发 $3$ 分钟后到达位置 $5$，接着掉头。卡车继续行驶到位置 $1$ ，此时距出发已过去了 $7$ 分钟。卡车再次掉头，并行驶到位置 $7$，此时距出发已经经过了 $13$ 分钟。\n\n当卡车到达路线终点后，会有神秘的 ~~Planet6174~~ 外星人出现并把它带回飞船。\n\n给出这 $N$ 辆卡车的路线。现在有 $M$ 组询问，每组询问包含两辆卡车。对于每组询问，请回答这对卡车出现在同一位置的次数。位置不一定是整数，比如它们可以在位置 $2.5$ 相遇。\n\n请注意，保证每一对**询问的**（而不是随便一对）卡车：\n\n - 其中一个被 ~~Planet6174~~ 外星人带走的时候，它们不会在同一位置。\n - 它们不会在初始时刻或是其中一个转弯的时候在同一位置。\n\n> Planet6174：翻译这道题目的人已经被解决掉了（滑稽", "inputFormat": "第一行，两个整数 $N$ 和 $M(1 \\le N \\le 10^5,1 \\le M \\le 10^5)$，表示卡车的数量和询问的卡车的对数。\n\n以下 $N$ 行，其中第 $i$ 行表示第 $i$ 辆卡车的路线。  \n每行第一个整数 $K_i(1 \\le K_i \\le 3 \\cdot 10^5)$ 表示路线的长度。紧接着是 $K_i$ 个整数 $A_j(1 \\le A_j \\le 10^9)$，表示卡车 $i$ 路线上的点。给出的点要么是起点，要么是终点，要么就是掉头的位置。  \n所有卡车移动的路线长度之和不会超过 $3 \\cdot 10 ^5$。\n\n以下 $M$ 行，其中第 $i$ 行包含两个整数 $(a_i,b_i)$，表示第 $i$ 个询问的两辆卡车。", "outputFormat": "输出 $M$ 行，第 $i$ 行包含我们询问的第 $i$ 对卡车相遇的次数。", "hint": "对于 $50\\%$ 的数据，保证 $N \\le 10^2,K_i \\le 10^3,M \\le 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2014/2015 #3] KAMIONI", "background": "", "description": "**Translated from [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T6 \"KAMIONI\".**\n\nThere is a road, and we view it as a number line. There are $N$ trucks on the road. Initially, all trucks are at integer points. All trucks start moving at the same time, and they all move at the **same speed**. **No truck stays still.** Each truck can move $1$ unit of distance in $1$ minute.\n\nFor each truck, its \"route\" is given. A route is represented by an array $A_1,A_2,\\dots,A_k$ with $k$ elements. The truck first drives from $A_1$ to $A_2$, then immediately turns around and drives to $A_3$, and so on. Ignore the time spent on turning around. Since the truck turns around, we guarantee:\n\n$$A_1 < A_2 > A_3 < A_4 > \\dots\\ \\mathrm{or}\\ A_1 > A_2 < A_3 > A_4 < \\dots$$\n\nOne possible route is $2→5→1→7$ (the given points are either the start, the end, or turning points). At the beginning the truck is at $2$. After $3$ minutes it reaches position $5$, and then turns around. The truck continues to position $1$; at this time $7$ minutes have passed since it started. The truck turns around again and drives to position $7$; at this time $13$ minutes have passed since it started.\n\nWhen a truck reaches the end of its route, mysterious ~~Planet6174~~ aliens appear and take it back to their spaceship.\n\nThe routes of these $N$ trucks are given. Now there are $M$ queries, and each query contains two trucks. For each query, output how many times this pair of trucks appears at the same position. The position does not have to be an integer; for example, they can meet at position $2.5$.\n\nNote that for every pair of trucks **that is queried** (not an arbitrary pair), it is guaranteed that:\n\n- When one of them is taken away by the ~~Planet6174~~ aliens, they are not at the same position.\n- They are not at the same position at the initial time, nor at the moment when one of them turns around.\n\n> Planet6174: The person who translated this problem has already been dealt with (joking).", "inputFormat": "The first line contains two integers $N$ and $M(1 \\le N \\le 10^5,1 \\le M \\le 10^5)$, representing the number of trucks and the number of queried pairs.\n\nThe next $N$ lines describe the routes.  \nThe $i$-th line describes the route of the $i$-th truck. The first integer on the line is $K_i(1 \\le K_i \\le 3 \\cdot 10^5)$, the length of the route. This is followed by $K_i$ integers $A_j(1 \\le A_j \\le 10^9)$, representing the points on truck $i$'s route. The given points are either the start, the end, or turning points.  \nThe total sum of route lengths of all trucks does not exceed $3 \\cdot 10 ^ 5$.\n\nThe next $M$ lines each contain two integers $(a_i,b_i)$, representing the two trucks in the $i$-th query.", "outputFormat": "Output $M$ lines. The $i$-th line should contain the number of meetings for the $i$-th queried pair of trucks.", "hint": "For $50\\%$ of the testdata, it is guaranteed that $N \\le 10^2,K_i \\le 10^3,M \\le 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2014/2015 #3] KAMIONI", "background": null, "description": "**译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T6「KAMIONI」**\n\n有一条马路，我们将其视为一条数轴。马路上有 $N$ 辆卡车，开始时，卡车都在整点上。所有卡车一起开始移动，并且都以**同样的速率**移动。**没有卡车保持静止**。每辆卡车花 $1$ 分钟可以移动 $1$ 个单位距离。\n\n给出每辆卡车的「路线」。路线用一个含有 $k$ 个元素的数组 $A_1,A_2,\\dots,A_k$ 表示。该卡车首先 $A_1$ 开往 $A_2$，然后立即掉头开往 $A_3$，以此类推。忽略掉头的耗时。考虑到卡车会掉头，我们保证：\n\n$$A_1 < A_2 > A_3 < A_4 > \\dots\\ \\mathrm{or}\\ A_1 > A_2 < A_3 > A_4 < \\dots$$\n\n一条可能的路线为 $2→5→1→7$（给出的点要么是起点，要么是终点，要么就是掉头的位置）。开始时卡车位于 $2$，出发 $3$ 分钟后到达位置 $5$，接着掉头。卡车继续行驶到位置 $1$ ，此时距出发已过去了 $7$ 分钟。卡车再次掉头，并行驶到位置 $7$，此时距出发已经经过了 $13$ 分钟。\n\n当卡车到达路线终点后，会有神秘的 ~~Planet6174~~ 外星人出现并把它带回飞船。\n\n给出这 $N$ 辆卡车的路线。现在有 $M$ 组询问，每组询问包含两辆卡车。对于每组询问，请回答这对卡车出现在同一位置的次数。位置不一定是整数，比如它们可以在位置 $2.5$ 相遇。\n\n请注意，保证每一对**询问的**（而不是随便一对）卡车：\n\n - 其中一个被 ~~Planet6174~~ 外星人带走的时候，它们不会在同一位置。\n - 它们不会在初始时刻或是其中一个转弯的时候在同一位置。\n\n> Planet6174：翻译这道题目的人已经被解决掉了（滑稽", "inputFormat": "第一行，两个整数 $N$ 和 $M(1 \\le N \\le 10^5,1 \\le M \\le 10^5)$，表示卡车的数量和询问的卡车的对数。\n\n以下 $N$ 行，其中第 $i$ 行表示第 $i$ 辆卡车的路线。  \n每行第一个整数 $K_i(1 \\le K_i \\le 3 \\cdot 10^5)$ 表示路线的长度。紧接着是 $K_i$ 个整数 $A_j(1 \\le A_j \\le 10^9)$，表示卡车 $i$ 路线上的点。给出的点要么是起点，要么是终点，要么就是掉头的位置。  \n所有卡车移动的路线长度之和不会超过 $3 \\cdot 10 ^5$。\n\n以下 $M$ 行，其中第 $i$ 行包含两个整数 $(a_i,b_i)$，表示第 $i$ 个询问的两辆卡车。", "outputFormat": "输出 $M$ 行，第 $i$ 行包含我们询问的第 $i$ 对卡车相遇的次数。", "hint": "对于 $50\\%$ 的数据，保证 $N \\le 10^2,K_i \\le 10^3,M \\le 10^3$。", "locale": "zh-CN"}}}
{"pid": "P4812", "type": "P", "difficulty": 4, "samples": [["5\n250 180\n250 132\n220 123\n132 194\n220 105", "1 3\n1 3\n3 5\n1 5\n3 5"], ["10\n650 550\n550 554\n560 512\n610 460\n610 456\n650 392\n580 436\n650 366\n520 456\n490 456", "1 4\n1 8\n2 8\n2 7\n2 9\n1 10\n4 10\n1 10\n5 10\n5 10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "树状数组", "前缀和", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #3] COCI", "background": "", "description": " **译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T4「COCI」**\n\n第三轮 COCI 来了！为了估分，我们猜测：如果选手 $\\mathrm{A}$ 在前两轮比赛中分数都高于选手 $\\mathrm{B}$，那么选手 $\\mathrm{A}$ 第三轮的分数与选手 $\\mathrm{B}$ 的分数**至少相等**。\n\n在每轮比赛中（包括这一场）选手至少会为 $0$ 分，至多会得到 $650$ 分。在**总排行榜**中，选手们将会按照**三轮比赛的总得分**降序排列。如果有两名选手分数相同则排名相同，下一名分数更小的选手排名后移。\n比如有 $5$ 名选手，总得分分别为 $1000,1000,900,900$ 和 $800$，那么对应的排名为 $\\text{No.}\\ 1,$ $\\text{No.}\\ 1,$ $\\text{No.}\\ 3,$ $\\text{No.}\\ 3$ 和 $\\text{No.}\\ 5$。\n\n对于 $N$ 名选手中的每一名选手，我们知道他们的第一轮和第二轮得分。基于上述假设，请确定每名选手在经过三轮 COCI 之后可以获得的最高名次和最低名次。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 5\\times 10^5)$，表示选手的个数。\n\n以下 $N$ 行，每行两个整数，在 $[0,650]$ 范围内，表示每个选手第一场和第二场比赛的得分。", "outputFormat": "对于每个选手，输出一行，两个整数，分别为他可能得到的最高名次和最低名次。", "hint": "$1 \\le N \\le 5\\times 10^5$，所有的选手分数均在 $[0,650]$ 范围内。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2014/2015 #3] COCI", "background": "", "description": "**Translated from T4 \"COCI\" of [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/).**\n\nThe third round of COCI is coming! For the purpose of estimating scores, we make the following guess: if contestant $\\mathrm{A}$ scored higher than contestant $\\mathrm{B}$ in both of the first two rounds, then in the third round contestant $\\mathrm{A}$'s score is **at least equal to** contestant $\\mathrm{B}$'s score.\n\nIn each round (including this one), a contestant can score at least $0$ points and at most $650$ points. In the **overall leaderboard**, contestants are ranked in descending order by their **total score over the three rounds**. If two contestants have the same total score, they share the same rank, and the next contestant with a smaller score is ranked lower accordingly.\nFor example, if there are $5$ contestants with total scores $1000, 1000, 900, 900,$ and $800$, then their ranks are $\\text{No.}\\ 1,$ $\\text{No.}\\ 1,$ $\\text{No.}\\ 3,$ $\\text{No.}\\ 3,$ and $\\text{No.}\\ 5$.\n\nFor each of the $N$ contestants, we know their scores in the first and second rounds. Based on the assumption above, determine the best possible rank and the worst possible rank each contestant can obtain after three rounds of COCI.", "inputFormat": "The first line contains an integer $N \\ (1 \\le N \\le 5\\times 10^5)$, the number of contestants.\n\nThe next $N$ lines each contain two integers in the range $[0,650]$, representing the scores of each contestant in the first and second rounds.", "outputFormat": "For each contestant, output one line with two integers: their best possible rank and their worst possible rank.", "hint": "$1 \\le N \\le 5\\times 10^5$. All contestants' scores are in the range $[0,650]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2014/2015 #3] COCI", "background": "", "description": " **译自 [COCI 2014/2015 Contest 3](http://www.hsin.hr/coci/archive/2014_2015/) T4「COCI」**\n\n第三轮 COCI 来了！为了估分，我们猜测：如果选手 $\\mathrm{A}$ 在前两轮比赛中分数都高于选手 $\\mathrm{B}$，那么选手 $\\mathrm{A}$ 第三轮的分数与选手 $\\mathrm{B}$ 的分数**至少相等**。\n\n在每轮比赛中（包括这一场）选手至少会为 $0$ 分，至多会得到 $650$ 分。在**总排行榜**中，选手们将会按照**三轮比赛的总得分**降序排列。如果有两名选手分数相同则排名相同，下一名分数更小的选手排名后移。\n比如有 $5$ 名选手，总得分分别为 $1000,1000,900,900$ 和 $800$，那么对应的排名为 $\\text{No.}\\ 1,$ $\\text{No.}\\ 1,$ $\\text{No.}\\ 3,$ $\\text{No.}\\ 3$ 和 $\\text{No.}\\ 5$。\n\n对于 $N$ 名选手中的每一名选手，我们知道他们的第一轮和第二轮得分。基于上述假设，请确定每名选手在经过三轮 COCI 之后可以获得的最高名次和最低名次。", "inputFormat": "第一行，一个整数 $N(1 \\le N \\le 5\\times 10^5)$，表示选手的个数。\n\n以下 $N$ 行，每行两个整数，在 $[0,650]$ 范围内，表示每个选手第一场和第二场比赛的得分。", "outputFormat": "对于每个选手，输出一行，两个整数，分别为他可能得到的最高名次和最低名次。", "hint": "$1 \\le N \\le 5\\times 10^5$，所有的选手分数均在 $[0,650]$ 范围内。", "locale": "zh-CN"}}}
{"pid": "P4813", "type": "P", "difficulty": 4, "samples": [["5\n.....\n.###.\n.###.\n#####\n.....", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2014", "CCO（加拿大）"], "title": "[CCO 2014] Troy 与三角形", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T1「[Troyangles](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\nTroy 喜欢三角形，所以他也特别喜欢数三角形。他有一个由 `.` 和 `#` 组成的 $N\\times N$ 的网格。帮他数数在网格中仅由 `#` 组成的三角的个数。三角形表示为如下形式：\n```plain\n          #\n    #    ###\n#, ###, #####, ...\n```\n更加形式化地说，一个高度为 $h$，有 $h$ 列的三角形，其中 $h$ 为正整数，第 $i$ 行有 $2i-1(1\\le i \\le h)$ 个 `#`，行在彼此上方居中，所以它们是关于它们的垂直中线对称的。", "inputFormat": "第一行一个数 $N$ 表示网格大小，接下来 $N$ 行每行 $N$ 个字符表示这个网格。", "outputFormat": "输出网格中的三角形个数。", "hint": "对于 $20\\%$ 的数据，$1\\le N\\le 50$；\n\n对于 $100\\%$ 的数据，$1\\le N \\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2014] Troy and Triangles", "background": "", "description": "**This problem is translated from [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day 1 T1 “[Troyangles](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)”.**\n\nTroy likes triangles, so he especially likes counting triangles. He has an $N \\times N$ grid consisting of `.` and `#`. Help him count how many triangles made only of `#` appear in the grid. A triangle looks like this:\n```plain\n          #\n    #    ###\n#, ###, #####, ...\n```\nMore formally, a triangle of height $h$ has $h$ rows, where $h$ is a positive integer. Row $i$ has $2i-1$ `#` characters $(1 \\le i \\le h)$. The rows are centered above each other, so the triangle is symmetric about its vertical center line.", "inputFormat": "The first line contains an integer $N$, the size of the grid. The next $N$ lines each contain $N$ characters describing the grid.", "outputFormat": "Output the number of triangles in the grid.", "hint": "For $20\\%$ of the testdata, $1 \\le N \\le 50$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2014] Troy 与三角形", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T1「[Troyangles](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\nTroy 喜欢三角形，所以他也特别喜欢数三角形。他有一个由 `.` 和 `#` 组成的 $N\\times N$ 的网格。帮他数数在网格中仅由 `#` 组成的三角的个数。三角形表示为如下形式：\n```plain\n          #\n    #    ###\n#, ###, #####, ...\n```\n更加形式化地说，一个高度为 $h$，有 $h$ 列的三角形，其中 $h$ 为正整数，第 $i$ 行有 $2i-1(1\\le i \\le h)$ 个 `#`，行在彼此上方居中，所以它们是关于它们的垂直中线对称的。", "inputFormat": "第一行一个数 $N$ 表示网格大小，接下来 $N$ 行每行 $N$ 个字符表示这个网格。", "outputFormat": "输出网格中的三角形个数。", "hint": "对于 $20\\%$ 的数据，$1\\le N\\le 50$；\n\n对于 $100\\%$ 的数据，$1\\le N \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P4814", "type": "P", "difficulty": 4, "samples": [["4 5 1 3\n1 2 5 1\n1 2 8 50\n2 3 2 15\n3 1 80 1000\n3 4 1 1\n4\n8\n6\n90\n94", "16\n0\n66\n1066"], ["4 3 1 2\n2 1 1 1\n3 4 10000 10000\n4 3 10000 10000\n1\n1000000000", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "CCO（加拿大）"], "title": "[CCO 2014] 国王格鲁夫", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T2「[King Gruff](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\n狼国王格鲁夫统治着一个居住着可爱的狐狸的繁荣、快乐的领地。对狐狸们来说，不幸的是，他根本不是一个好国王，而且还想让他们的生活过得很惨。\n\n他的国家有 $N$ 个城市，由 $M$ 条路连接，第 $i$ 条路可以让你从城市 $X_i$ 走到另一个城市 $Y_i$，并且只能往这个方向走，这条路的长度为 $L_i$，关闭费为 $C_i$，可能会有多条道路以相同的方向连接着两个相同的城市。\n\n国王格鲁夫尤其不喜欢住在两个不同城市 $A$ 和 $B$ 里的狐狸并且想让他们从城市 $A$ \n 到城市 $B$ 很麻烦甚至根本行不通。具体来说，他将选择一个距离 $D$，并且同时关闭某些他王国里的路。关闭的条件是，如果这条路是城市 $A$ 到城市 $B$ 路径上的一部分且该路径总长不超过 $D$。对于每条这样的路，他将用皇家金库里的钱取支付它的关闭费。一个路径包含一个路的序列，除了第一条路外，每条路起点在前一条路的终点，并且可能多次访问同一个城市或走同一条路。\n\n格鲁夫正在纠结选哪个 $D$，不管怎样，大一些的 $D$ 值可以使得他的狐狸子民更加不方便，但是可能花费他更多的钱！因此，他想了 $Q$ 个不同的值 $D_1,D_2,...,D_Q$，对于每一个值，他想知道需要花费多少来满足他的要求。因为你也不喜欢狐狸，你同意帮他写个程序计算最小花费。", "inputFormat": "第一行包括四个由空格分隔的整数 $N,M,A,B$，城市数，道路数，开始城市，结束城市。\n\n接下来 $M$ 行四个空格分隔的整数 $X_i,Y_i,L_i,C_i$，表示一条从 $X_i$ 到 $Y_i$ 的长为 $L_i$ 的路，它的关闭费为 $C_i$。\n\n接下来一行一个数 $Q$，表示询问个数。\n\n接下来 $Q$ 行包含一个数 $D_i$ 表示题中所述距离参数。", "outputFormat": "输出包括 $Q$ 行，表示根据距离参数 $D_i(1\\le i\\le Q)$ 求出的关闭所有必要的路的总花费。", "hint": "王国如下图所示，每条路只标注了长度。\n\n![CCO2014D1T2Pic1](https://upload.acmicpc.net/e0b8a0c8-3404-462a-9f08-c756f00f5234/-/preview/)\n\n如果 $D=8$，第一、三条路需要被关闭，他们都是从城市 $1$ 到 城市 $3$ 的长为 $7$ 的路径的一部分，总花费 $1+15=16$。\n\n如果 $D=6$，不需要关闭任何路，因为没有从城市 $1$ 到城市 $3$ 的路长度小于或等于 $6$。\n\n如果 $D=90$，前三条路都要被关闭。\n\n如果 $D=94$，第四条路也要被关闭，因为它在城市 $1$ 到城市 $3$ 的路径上，该路径长度刚好为 $94$，路径为依次走第一、三、四、一、三条路。\n\n王国如下图所示\n\n![CCOD2T2Pic2](https://upload.acmicpc.net/f0b3c521-616d-4259-8805-40e641a6f90b/-/preview/)\n\n就像你所看到的一样，狐狸已经有麻烦了，因为这里根本没有从城市 $1$ 到城市 $2$ 的路径，因此对于任何 $D$ 格鲁夫国王都不需要关闭任何道路。\n\n对于至多 $20\\%$ 的数据，$1\\le N\\le 500$；\n\n对于至多 $20\\%$ 的数据，$Q=1$；\n\n对于至多 $80\\%$ 的数据，$1\\le Q\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le X_i,Y_i,A,B\\le N \\le 10^5,$ $0\\le M\\le 10^5,$ $1\\le L_i,C_i\\le 10^4,$ $1\\le Q\\le 10^5,$ $1\\le D\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2014] King Gruff", "background": "", "description": "**This problem is translated from [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day 1 T2 “[King Gruff](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)”.**\n\nWolf King Gruff rules a prosperous and happy land inhabited by adorable foxes. Unfortunately for the foxes, he is not a good king at all, and he wants to make their lives miserable.\n\nHis country has $N$ cities connected by $M$ roads. Road $i$ allows you to travel from city $X_i$ to another city $Y_i$, and you may only travel in this direction. This road has length $L_i$ and closing cost $C_i$. There may be multiple roads in the same direction connecting the same pair of cities.\n\nKing Gruff especially dislikes foxes living in two different cities $A$ and $B$, and he wants traveling from city $A$ to city $B$ to be difficult or even impossible. Specifically, he will choose a distance $D$ and close some roads in his kingdom at the same time. A road must be closed if it is part of some path from city $A$ to city $B$ whose total length is at most $D$. For each such road, he will pay its closing cost from the royal treasury. A path consists of a sequence of roads where, except for the first road, the start city of each road is the end city of the previous road. The same city or the same road may be visited multiple times.\n\nGruff cannot decide which $D$ to choose. In general, a larger $D$ can make life more inconvenient for his fox subjects, but it may cost him more money. Therefore, he has come up with $Q$ different values $D_1, D_2, ..., D_Q$. For each value, he wants to know how much it would cost to meet his requirement. Since you also dislike foxes, you agree to help him write a program to compute the minimum total cost.", "inputFormat": "The first line contains four integers $N, M, A, B$ separated by spaces: the number of cities, the number of roads, the starting city, and the ending city.\n\nThe next $M$ lines each contain four integers $X_i, Y_i, L_i, C_i$ separated by spaces, describing a road from $X_i$ to $Y_i$ with length $L_i$ and closing cost $C_i$.\n\nThe next line contains an integer $Q$, the number of queries.\n\nThe next $Q$ lines each contain one integer $D_i$, the distance parameter described above.", "outputFormat": "Output $Q$ lines. Each line should be the total cost to close all required roads for the corresponding distance parameter $D_i$ ($1 \\le i \\le Q$).", "hint": "The kingdom is shown in the figure below, where each road is labeled only with its length.\n\n![CCO2014D1T2Pic1](https://upload.acmicpc.net/e0b8a0c8-3404-462a-9f08-c756f00f5234/-/preview/)\n\nIf $D = 8$, the first and third roads must be closed. They are both part of a path from city $1$ to city $3$ of length $7$, so the total cost is $1 + 15 = 16$.\n\nIf $D = 6$, no roads need to be closed, because there is no path from city $1$ to city $3$ with length less than or equal to $6$.\n\nIf $D = 90$, the first three roads must all be closed.\n\nIf $D = 94$, the fourth road must also be closed, because it lies on a path from city $1$ to city $3$ whose length is exactly $94$. The path takes, in order, the first, third, fourth, first, and third roads.\n\nThe kingdom is shown in the figure below.\n\n![CCOD2T2Pic2](https://upload.acmicpc.net/f0b3c521-616d-4259-8805-40e641a6f90b/-/preview/)\n\nAs you can see, the foxes are already in trouble, because there is no path from city $1$ to city $2$ at all. Therefore, for any $D$, King Gruff does not need to close any roads.\n\nConstraints:\n\nFor at most $20\\%$ of the testdata, $1 \\le N \\le 500$.\n\nFor at most $20\\%$ of the testdata, $Q = 1$.\n\nFor at most $80\\%$ of the testdata, $1 \\le Q \\le 20$.\n\nFor $100\\%$ of the testdata, $1 \\le X_i, Y_i, A, B \\le N \\le 10^5$, $0 \\le M \\le 10^5$, $1 \\le L_i, C_i \\le 10^4$, $1 \\le Q \\le 10^5$, $1 \\le D \\le 10^9$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2014] 国王格鲁夫", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T2「[King Gruff](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\n狼国王格鲁夫统治着一个居住着可爱的狐狸的繁荣、快乐的领地。对狐狸们来说，不幸的是，他根本不是一个好国王，而且还想让他们的生活过得很惨。\n\n他的国家有 $N$ 个城市，由 $M$ 条路连接，第 $i$ 条路可以让你从城市 $X_i$ 走到另一个城市 $Y_i$，并且只能往这个方向走，这条路的长度为 $L_i$，关闭费为 $C_i$，可能会有多条道路以相同的方向连接着两个相同的城市。\n\n国王格鲁夫尤其不喜欢住在两个不同城市 $A$ 和 $B$ 里的狐狸并且想让他们从城市 $A$ \n 到城市 $B$ 很麻烦甚至根本行不通。具体来说，他将选择一个距离 $D$，并且同时关闭某些他王国里的路。关闭的条件是，如果这条路是城市 $A$ 到城市 $B$ 路径上的一部分且该路径总长不超过 $D$。对于每条这样的路，他将用皇家金库里的钱取支付它的关闭费。一个路径包含一个路的序列，除了第一条路外，每条路起点在前一条路的终点，并且可能多次访问同一个城市或走同一条路。\n\n格鲁夫正在纠结选哪个 $D$，不管怎样，大一些的 $D$ 值可以使得他的狐狸子民更加不方便，但是可能花费他更多的钱！因此，他想了 $Q$ 个不同的值 $D_1,D_2,...,D_Q$，对于每一个值，他想知道需要花费多少来满足他的要求。因为你也不喜欢狐狸，你同意帮他写个程序计算最小花费。", "inputFormat": "第一行包括四个由空格分隔的整数 $N,M,A,B$，城市数，道路数，开始城市，结束城市。\n\n接下来 $M$ 行四个空格分隔的整数 $X_i,Y_i,L_i,C_i$，表示一条从 $X_i$ 到 $Y_i$ 的长为 $L_i$ 的路，它的关闭费为 $C_i$。\n\n接下来一行一个数 $Q$，表示询问个数。\n\n接下来 $Q$ 行包含一个数 $D_i$ 表示题中所述距离参数。", "outputFormat": "输出包括 $Q$ 行，表示根据距离参数 $D_i(1\\le i\\le Q)$ 求出的关闭所有必要的路的总花费。", "hint": "王国如下图所示，每条路只标注了长度。\n\n![CCO2014D1T2Pic1](https://upload.acmicpc.net/e0b8a0c8-3404-462a-9f08-c756f00f5234/-/preview/)\n\n如果 $D=8$，第一、三条路需要被关闭，他们都是从城市 $1$ 到 城市 $3$ 的长为 $7$ 的路径的一部分，总花费 $1+15=16$。\n\n如果 $D=6$，不需要关闭任何路，因为没有从城市 $1$ 到城市 $3$ 的路长度小于或等于 $6$。\n\n如果 $D=90$，前三条路都要被关闭。\n\n如果 $D=94$，第四条路也要被关闭，因为它在城市 $1$ 到城市 $3$ 的路径上，该路径长度刚好为 $94$，路径为依次走第一、三、四、一、三条路。\n\n王国如下图所示\n\n![CCOD2T2Pic2](https://upload.acmicpc.net/f0b3c521-616d-4259-8805-40e641a6f90b/-/preview/)\n\n就像你所看到的一样，狐狸已经有麻烦了，因为这里根本没有从城市 $1$ 到城市 $2$ 的路径，因此对于任何 $D$ 格鲁夫国王都不需要关闭任何道路。\n\n对于至多 $20\\%$ 的数据，$1\\le N\\le 500$；\n\n对于至多 $20\\%$ 的数据，$Q=1$；\n\n对于至多 $80\\%$ 的数据，$1\\le Q\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le X_i,Y_i,A,B\\le N \\le 10^5,$ $0\\le M\\le 10^5,$ $1\\le L_i,C_i\\le 10^4,$ $1\\le Q\\le 10^5,$ $1\\le D\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4815", "type": "P", "difficulty": 5, "samples": [["2 1 1\nD 1 2", "1"], ["2 1 0", "2"], ["3 2 2\nA 1 2\nD 1 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2014", "CCO（加拿大）"], "title": "[CCO 2014] 狼人游戏", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T3「[Werewolf](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\n和往常一样，$N$ 个机器人在玩狼人游戏，机器人从 $1$ 到 $N$ 编号。$W$ 个机器人扮演狼人，剩下的扮演市民。虽然狼人游戏包括不同的角度，但我们将只着眼于其中一个角度。\n\n机器人指控其他人是狼人并且防止其他机器人无辜地指控它。\n\n狼人知道其他人的角色以及：\n\n- 一个狼人从不指控其他狼人；\n\n- 任何狼人机器人保护的都是其他狼人机器人。\n\n市民可能会指控或保护任何类型的机器人。\n\n其他的一些限制使得题目更简单：\n\n- 没有机器人又被指控又被保护；\n\n- 没有机器人被指控或保护一次以上；\n\n- 如果有一个编号为 $A$ 机器人指控或保护编号为 $B$ 的机器人，那么我们保证$A<B$。\n\n你将知道 $N$ 个机器人间的所有指控和保护关系，并且知道狼人数为 $W$。每个机器人所扮演的角色要么是狼人要么是市民。你的目标是计算出符合上述限制的角色安排方案数。", "inputFormat": "第一行三个数 $N,W,M$，分别表示机器人数、狼人数、指控和保护关系数。\n\n接下来 $M$ 行每行描述一个关系，接下来每行都是以下两个形式之一：\n- `A a b`，表示机器人 $a$ 指控机器人 $b$ 是狼人。\n- `D a b`，表示机器人 $a$ 保护机器人 $b$。\n", "outputFormat": "输出满足以上条件的角色安排方案数量。可想而知，结果可能非常大，所以需要对 $10^9+7$ 取模。", "hint": "#### 样例解释 1\n如果机器人 $1$ 是狼人，机器人 $2$ 也必须是，那么狼人就太多了！唯一的可能是机器人 $2$ 是唯一的狼人。\n\n#### 样例输出 2\n没有额外的保护或指控信息的话，机器人 $1$ 和机器人 $2$ 都可能是狼人。\n\n#### 样例解释 3\n如果机器人 $1$ 是狼人，机器人 $2$ 将是市民，机器人 $3$ 也是狼人；或者机器人 $1$ 是市民，那么机器人 $2$ 和 $3$ 将是狼人。\n\n对于 $20\\%$ 的数据，$1\\le N\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 200,$ $0\\le W\\le N,$ $0\\le M<N$。", "locale": "zh-CN", "translations": {"en": {"title": "[CCO 2014] Werewolf Game", "background": "", "description": "**This problem is translated from [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day 1 T3「[Werewolf](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」.**\n\nAs usual, $N$ robots are playing a game of werewolf. The robots are numbered from $1$ to $N$. Exactly $W$ robots are werewolves, and the rest are villagers. Although the game of werewolf can be studied from different angles, we will focus on just one aspect.\n\nRobots may accuse others of being werewolves, and they may also protect other robots from being falsely accused.\n\nWerewolves know everyone’s roles, and:\n\n- A werewolf never accuses another werewolf.\n- Any robot protected by a werewolf is also a werewolf.\n\nVillagers may accuse or protect robots of any type.\n\nSome additional restrictions make the problem easier:\n\n- No robot is both accused and protected.\n- No robot is accused or protected more than once.\n- If a robot with number $A$ accuses or protects a robot with number $B$, then we guarantee that $A < B$.\n\nYou are given all accusation and protection relationships among the $N$ robots, as well as the number of werewolves $W$. Each robot’s role is either werewolf or villager. Your task is to count the number of role assignments that satisfy all the above restrictions.", "inputFormat": "The first line contains three integers $N, W, M$, representing the number of robots, the number of werewolves, and the number of accusation/protection relationships.\n\nThe next $M$ lines each describe one relationship. Each line is in one of the following two forms:\n- `A a b`, meaning robot $a$ accuses robot $b$ of being a werewolf.\n- `D a b`, meaning robot $a$ protects robot $b$.", "outputFormat": "Output the number of role assignments that satisfy the conditions above. Since the result can be very large, output it modulo $10^9 + 7$.", "hint": "#### Sample Explanation 1\n\nIf robot $1$ is a werewolf, then robot $2$ must also be a werewolf, which would give too many werewolves. The only possibility is that robot $2$ is the only werewolf.\n\n#### Sample Output 2\n\nIf there is no additional protection or accusation information, then both robot $1$ and robot $2$ could be the werewolf.\n\n#### Sample Explanation 3\n\nIf robot $1$ is a werewolf, then robot $2$ will be a villager and robot $3$ will also be a werewolf; or if robot $1$ is a villager, then robots $2$ and $3$ will be werewolves.\n\nFor $20\\%$ of the testdata, $1 \\le N \\le 20$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 200$, $0 \\le W \\le N$, $0 \\le M < N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CCO 2014] 狼人游戏", "background": "", "description": "**本题译自 [CCO 2014](https://cemc.math.uwaterloo.ca/contests/computing/2014/index.html) Day1 T3「[Werewolf](https://cemc.math.uwaterloo.ca/contests/computing/2014/Stage%202/day1.pdf)」**\n\n和往常一样，$N$ 个机器人在玩狼人游戏，机器人从 $1$ 到 $N$ 编号。$W$ 个机器人扮演狼人，剩下的扮演市民。虽然狼人游戏包括不同的角度，但我们将只着眼于其中一个角度。\n\n机器人指控其他人是狼人并且防止其他机器人无辜地指控它。\n\n狼人知道其他人的角色以及：\n\n- 一个狼人从不指控其他狼人；\n\n- 任何狼人机器人保护的都是其他狼人机器人。\n\n市民可能会指控或保护任何类型的机器人。\n\n其他的一些限制使得题目更简单：\n\n- 没有机器人又被指控又被保护；\n\n- 没有机器人被指控或保护一次以上；\n\n- 如果有一个编号为 $A$ 机器人指控或保护编号为 $B$ 的机器人，那么我们保证$A<B$。\n\n你将知道 $N$ 个机器人间的所有指控和保护关系，并且知道狼人数为 $W$。每个机器人所扮演的角色要么是狼人要么是市民。你的目标是计算出符合上述限制的角色安排方案数。", "inputFormat": "第一行三个数 $N,W,M$，分别表示机器人数、狼人数、指控和保护关系数。\n\n接下来 $M$ 行每行描述一个关系，接下来每行都是以下两个形式之一：\n- `A a b`，表示机器人 $a$ 指控机器人 $b$ 是狼人。\n- `D a b`，表示机器人 $a$ 保护机器人 $b$。\n", "outputFormat": "输出满足以上条件的角色安排方案数量。可想而知，结果可能非常大，所以需要对 $10^9+7$ 取模。", "hint": "#### 样例解释 1\n如果机器人 $1$ 是狼人，机器人 $2$ 也必须是，那么狼人就太多了！唯一的可能是机器人 $2$ 是唯一的狼人。\n\n#### 样例输出 2\n没有额外的保护或指控信息的话，机器人 $1$ 和机器人 $2$ 都可能是狼人。\n\n#### 样例解释 3\n如果机器人 $1$ 是狼人，机器人 $2$ 将是市民，机器人 $3$ 也是狼人；或者机器人 $1$ 是市民，那么机器人 $2$ 和 $3$ 将是狼人。\n\n对于 $20\\%$ 的数据，$1\\le N\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 200,$ $0\\le W\\le N,$ $0\\le M<N$。", "locale": "zh-CN"}}}
{"pid": "P4816", "type": "P", "difficulty": 4, "samples": [["4\n1\n8\n4\n3\n", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2015", "USACO", "枚举", "排序"], "title": "[USACO15DEC] High Card Low Card G", "background": "", "description": "Bessie the cow is a huge fan of card games, which is quite surprising, given her lack of opposable thumbs. Unfortunately, none of the other cows in the herd are good opponents. They are so bad, in fact, that they always play in a completely predictable fashion! Nonetheless, it can still be a challenge for Bessie to figure out how to win.\n\nBessie and her friend Elsie are currently playing a simple card game where they take a deck of $2N$ cards, conveniently numbered $1…2N$, and divide them into $N$ cards for Bessie and $N$ cards for Elsie. The two then play $N$ rounds, where in each round Bessie and Elsie both play a single card. In the first $N/2$ rounds, the player with the highest card earns a point, and in the last $N/2$ rounds, the rules switch and the player who plays the lowest card wins a point.\n\nGiven that Bessie can predict the order in which Elsie will play her cards, please determine the maximum number of points Bessie can win. ", "inputFormat": "The first line of input contains the value of $N$ ($2 ≤ N ≤ 50,000$; N will be even).\n\nThe next $N$ lines contain the cards that Elsie will play in each of the successive rounds of the game. Note that it is easy to determine Bessie's cards from this information. ", "outputFormat": " Output a single line giving the maximum number of points Bessie can score. ", "hint": "Here, Bessie must have cards 2, 5, and 6, and 7 in her hand, and she can use these to win at most 2 points, by saving her '2' card until one of the hands in the second half of the game.\n\nProblem credits: Brian Dean ", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] High Card Low Card G", "background": "", "description": "Bessie the cow is a huge fan of card games, which is quite surprising, given her lack of opposable thumbs. Unfortunately, none of the other cows in the herd are good opponents. They are so bad, in fact, that they always play in a completely predictable fashion! Nonetheless, it can still be a challenge for Bessie to figure out how to win.\n\nBessie and her friend Elsie are currently playing a simple card game where they take a deck of $2N$ cards, conveniently numbered $1…2N$, and divide them into $N$ cards for Bessie and $N$ cards for Elsie. The two then play $N$ rounds, where in each round Bessie and Elsie both play a single card. In the first $N/2$ rounds, the player with the highest card earns a point, and in the last $N/2$ rounds, the rules switch and the player who plays the lowest card wins a point.\n\nGiven that Bessie can predict the order in which Elsie will play her cards, please determine the maximum number of points Bessie can win. ", "inputFormat": "The first line of input contains the value of $N$ ($2 ≤ N ≤ 50,000$; N will be even).\n\nThe next $N$ lines contain the cards that Elsie will play in each of the successive rounds of the game. Note that it is easy to determine Bessie's cards from this information. ", "outputFormat": " Output a single line giving the maximum number of points Bessie can score. ", "hint": "Here, Bessie must have cards 2, 5, and 6, and 7 in her hand, and she can use these to win at most 2 points, by saving her '2' card until one of the hands in the second half of the game.\n\nProblem credits: Brian Dean ", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] High Card Low Card G", "background": "", "description": "奶牛 Bessie 是卡牌游戏的狂热爱好者，尽管她没有对生拇指，但这并不影响她的热情。遗憾的是，她的同伴们在卡牌游戏方面水平堪忧，甚至出牌顺序都完全可预测！尽管如此，Bessie 仍需精心策划才能获胜。\n\nBessie 和她的朋友 Elsie 正在玩一个简单的卡牌游戏。她们使用一副包含 $2N$ 张卡牌的牌组（编号为 $1 \\ldots 2N$），并将牌分成各 $N$ 张。随后进行 $N$ 轮比赛：每轮双方各打出一张牌。在前 $N/2$ 轮中，打出较大数字的玩家得 1 分；在后 $N/2$ 轮中，规则反转，打出较小数字的玩家得 1 分。\n\n已知 Bessie 可以预知 Elsie 每轮出牌的顺序，请计算 Bessie 能够获得的最大分数。", "inputFormat": "第一行输入包含整数 $N$（$2 \\leq N \\leq 50,000$，且 $N$ 为偶数）。\n\n接下来 $N$ 行按顺序给出 Elsie 在每轮比赛中将打出的卡牌。注意根据这些信息可以推断出 Bessie 手中的卡牌。", "outputFormat": "输出一行，包含 Bessie 能够获得的最大分数。", "hint": "在此样例中，Bessie 手中的卡牌为 $2$、$5$、$6$ 和 $7$。她可以通过在比赛后半段保留 $2$ 这张牌，从而最多获得 2 分。\n\n题目提供者：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P4817", "type": "P", "difficulty": 3, "samples": [["8 5 6", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "枚举"], "title": "[USACO15DEC] Fruit Feast G", "background": "", "description": "Bessie has broken into Farmer John's house again! She has discovered a pile of lemons and a pile of oranges in the kitchen (effectively an unlimited number of each), and she is determined to eat as much as possible.\n\nBessie has a maximum fullness of $T$ $(1 ≤ T ≤ 5,000,000)$. Eating an orange increases her fullness by $A$, and eating a lemon increases her fullness by $B$ ($1 ≤ A,B ≤ T$). Additionally, if she wants, Bessie can drink water at most one time, which will instantly decrease her fullness by half (and will round down).\n\nHelp Bessie determine the maximum fullness she can achieve! ", "inputFormat": "The first (and only) line has three integers $T$, $A$, and $B$. ", "outputFormat": " A single integer, representing the maximum fullness Bessie can achieve. ", "hint": "Problem credits: Nathan Pinsker ", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] Fruit Feast G", "background": "", "description": "Bessie has broken into Farmer John's house again! She has discovered a pile of lemons and a pile of oranges in the kitchen (effectively an unlimited number of each), and she is determined to eat as much as possible.\n\nBessie has a maximum fullness of $T$ $(1 ≤ T ≤ 5,000,000)$. Eating an orange increases her fullness by $A$, and eating a lemon increases her fullness by $B$ ($1 ≤ A,B ≤ T$). Additionally, if she wants, Bessie can drink water at most one time, which will instantly decrease her fullness by half (and will round down).\n\nHelp Bessie determine the maximum fullness she can achieve! ", "inputFormat": "The first (and only) line has three integers $T$, $A$, and $B$. ", "outputFormat": " A single integer, representing the maximum fullness Bessie can achieve. ", "hint": "Problem credits: Nathan Pinsker ", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] Fruit Feast G", "background": "", "description": "Bessie 再次闯入了 Farmer John 的房屋！她在厨房发现了一堆柠檬和一堆橙子（每种水果的数量都可以视为无限），并决定尽可能多吃。\n\nBessie 的最大饱腹度为 $T$（$1 \\leq T \\leq 5,000,000$）。每吃一个橙子会使饱腹度增加 $A$，每吃一个柠檬会使饱腹度增加 $B$（$1 \\leq A,B \\leq T$）。此外，Bessie 最多可以喝一次水，这将使饱腹度立即减半（向下取整）。\n\n请帮助 Bessie 计算她能达到的最大饱腹度！", "inputFormat": "唯一一行包含三个整数 $T$、$A$ 和 $B$。", "outputFormat": "输出一个整数，表示 Bessie 能达到的最大饱腹度。", "hint": "题目提供者：Nathan Pinsker", "locale": "zh-CN"}}}
{"pid": "P4818", "type": "P", "difficulty": 5, "samples": [["4 4\n1 0 2 1\n1 1 4 1\n1 0 4 0\n1 3 1 1", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "搜索", "2015", "USACO"], "title": "[USACO15DEC] Bessie's Dream G", "background": "", "description": "After eating too much fruit in Farmer John's kitchen, Bessie the cow is getting some very strange dreams! In her most recent dream, she is trapped in a maze in the shape of an $N×M$ grid of tiles $(1≤N,M≤1,000)$. She starts on the top-left tile and wants to get to the bottom-right tile. When she is standing on a tile, she can potentially move to the adjacent tiles in any of the four cardinal directions.\n\nBut wait! Each tile has a color, and each color has a different property! Bessie's head hurts just thinking about it:\n\n- If a tile is **red**, then it is impassable.\n\n- If a tile is **pink**, then it can be walked on normally.\n\n- If a tile is **orange**, then it can be walked on normally, but will make Bessie smell like oranges.\n\n- If a tile is **blue**, then it contains piranhas that will only let Bessie pass if she smells like oranges.\n\n- If a tile is **purple**, then Bessie will slide to the next tile in that direction (unless she is unable to cross it). If this tile is also a purple tile, then Bessie will continue to slide until she lands on a non-purple tile or hits an impassable tile. Sliding through a tile counts as a move. **Purple tiles will also remove Bessie's smell.**\n\n(If you're confused about purple tiles, the example will illustrate their use.)\n\nPlease help Bessie get from the top-left to the bottom-right in as few moves as possible. ", "inputFormat": " The first line has two integers $N$ and $M$, representing the number of rows and columns of the maze.\n\nThe next $N$ lines have $M$ integers each, representing the maze:\n\n- The integer '0' is a red tile\n\n- The integer '1' is a pink tile\n\n- The integer '2' is an orange tile\n\n- The integer '3' is a blue tile\n\n- The integer '4' is a purple tile \n\nThe top-left and bottom-right integers will always be '1'. ", "outputFormat": "A single integer, representing the minimum number of moves Bessie must use to cross the maze, or -1 if it is impossible to do so. ", "hint": "In this example, Bessie walks one square down and two squares to the right (and then slides one more square to the right). She walks one square up, one square left, and one square down (sliding two more squares down) and finishes by walking one more square right. This is a total of 10 moves (DRRRULDDDR).\n\nProblem credits: Nathan Pinsker, inspired by the game \"Undertale\". ", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] Bessie's Dream G", "background": "", "description": "After eating too much fruit in Farmer John's kitchen, Bessie the cow is getting some very strange dreams! In her most recent dream, she is trapped in a maze in the shape of an $N×M$ grid of tiles $(1≤N,M≤1,000)$. She starts on the top-left tile and wants to get to the bottom-right tile. When she is standing on a tile, she can potentially move to the adjacent tiles in any of the four cardinal directions.\n\nBut wait! Each tile has a color, and each color has a different property! Bessie's head hurts just thinking about it:\n\n- If a tile is **red**, then it is impassable.\n\n- If a tile is **pink**, then it can be walked on normally.\n\n- If a tile is **orange**, then it can be walked on normally, but will make Bessie smell like oranges.\n\n- If a tile is **blue**, then it contains piranhas that will only let Bessie pass if she smells like oranges.\n\n- If a tile is **purple**, then Bessie will slide to the next tile in that direction (unless she is unable to cross it). If this tile is also a purple tile, then Bessie will continue to slide until she lands on a non-purple tile or hits an impassable tile. Sliding through a tile counts as a move. **Purple tiles will also remove Bessie's smell.**\n\n(If you're confused about purple tiles, the example will illustrate their use.)\n\nPlease help Bessie get from the top-left to the bottom-right in as few moves as possible. ", "inputFormat": " The first line has two integers $N$ and $M$, representing the number of rows and columns of the maze.\n\nThe next $N$ lines have $M$ integers each, representing the maze:\n\n- The integer '0' is a red tile\n\n- The integer '1' is a pink tile\n\n- The integer '2' is an orange tile\n\n- The integer '3' is a blue tile\n\n- The integer '4' is a purple tile \n\nThe top-left and bottom-right integers will always be '1'. ", "outputFormat": "A single integer, representing the minimum number of moves Bessie must use to cross the maze, or -1 if it is impossible to do so. ", "hint": "In this example, Bessie walks one square down and two squares to the right (and then slides one more square to the right). She walks one square up, one square left, and one square down (sliding two more squares down) and finishes by walking one more square right. This is a total of 10 moves (DRRRULDDDR).\n\nProblem credits: Nathan Pinsker, inspired by the game \"Undertale\". ", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] Bessie's Dream G", "background": "", "description": "Bessie 在 Farmer John 的厨房暴食水果后，开始做奇怪的梦！在最近的梦境中，她被困在一个 $N \\times M$ 的网格迷宫（$1 \\leq N,M \\leq 1,000$）中。她需要从左上角的格子移动到右下角的格子。当站在某个格子时，她可以向四个基本方向移动至相邻格子。\n\n但请注意！每个格子有不同的颜色和特殊属性：\n\n- **红色（0）**：不可通行  \n- **粉色（1）**：可正常通行  \n- **橙色（2）**：可正常通行，且会使 Bessie 带有橙子气味  \n- **蓝色（3）**：仅当 Bessie 带有橙子气味时方可通行  \n- **紫色（4）**：Bessie 将沿该方向滑动到下一个格子（除非无法通过）。若下一个格子仍是紫色，则继续滑动直至遇到非紫色格子或不可通行格子。**每次滑动均计为一步移动**，且**紫色格子会消除 Bessie 的气味**\n\n（若对紫色格子机制有疑问，样例将帮助理解）\n\n请帮助 Bessie 找到从左上角到右下角的最短路径步数。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$，表示迷宫的行数和列数。  \n接下来 $N$ 行每行包含 $M$ 个整数描述迷宫：  \n- 0 表示红色  \n- 1 表示粉色  \n- 2 表示橙色  \n- 3 表示蓝色  \n- 4 表示紫色  \n\n保证左上角和右下角的格子始终为 1。", "outputFormat": "输出一个整数，表示 Bessie 穿越迷宫所需的最少步数，若无法到达则输出 -1。", "hint": "样例中，Bessie 的移动路径为：向下 1 步，向右 2 步（滑动再向右 1 步），向上 1 步，向左 1 步，向下 1 步（滑动再向下 2 步），最后向右 1 步。总计 10 步（路径表示为 DRRRULDDDR）。\n\n题目提供者：Nathan Pinsker，灵感来自游戏《Undertale》", "locale": "zh-CN"}}}
{"pid": "P4819", "type": "P", "difficulty": 6, "samples": [["5 4 \n1 2 \n1 3 \n1 4 \n1 5 ", "0.800000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["图论建模", "强连通分量"], "title": "[中山市选] 杀人游戏", "background": null, "description": "一位冷血的杀手潜入 Na-wiat，并假装成平民。警察希望能在 $N$ 个人里面，查出谁是杀手。警察能够对每一个人进行查证，假如查证的对象是平民，他会告诉警察，他认识的人，谁是杀手，谁是平民。假如查证的对象是杀手，杀手将会把警察干掉。现在警察掌握了每一个人认识谁。每一个人都有可能是杀手，可看作他们是杀手的概率是相同的。\n\n问：根据最优的情况，保证警察自身安全并知道谁是杀手的概率最大是多少？", "inputFormat": "第一行有两个整数 $N,M$。\n\n接下来有 $M$ 行，每行两个整数 $x,y$，表示 $x$ 认识 $y$（$y$ 不一定认识 $x$，例如 President 同志）。", "outputFormat": "仅包含一行一个实数，保留小数点后面 $6$ 位，表示最大概率。", "hint": "警察只需要查证 $1$。假如 $1$ 是杀手，警察就会被杀。假如 $1$ 不是杀手，他会告诉警察 $2,3,4,5$ 谁是杀手。而 $1$ 是杀手的概率是 $0.2$，所以能知道谁是杀手但没被杀的概率是 $0.8$。\n\n对于 $100\\%$ 的数据有 $1\\le N\\le 1\\times 10^5,0\\le M\\le 3\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Zhongshan City Selection] Murder Game", "background": "", "description": "A cold-blooded killer sneaks into Na-wiat and pretends to be a civilian. The police want to find out who the killer is among $N$ people. The police can verify people one by one. If the verified person is a civilian, they will tell the police, among the people they know, who is the killer and who is a civilian. If the verified person is the killer, the killer will kill the police.\n\nNow the police know, for every person, whom they know. Everyone could be the killer, and the probability that each person is the killer is the same.\n\nQuestion: Under an optimal strategy, what is the maximum possible probability that the police can both guarantee their own safety and know who the killer is?", "inputFormat": "The first line contains two integers $N, M$.\n\nThe next $M$ lines each contain two integers $x, y$, meaning that $x$ knows $y$ ($y$ does not necessarily know $x$, for example, Comrade President).", "outputFormat": "Output only one real number in a single line, rounded to $6$ digits after the decimal point, representing the maximum probability.", "hint": "The police only need to verify person $1$. If $1$ is the killer, the police will be killed. If $1$ is not the killer, they will tell the police, among $2, 3, 4, 5$, who is the killer. Since the probability that $1$ is the killer is $0.2$, the probability that the police can know who the killer is without being killed is $0.8$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 1 \\times 10^5$, $0 \\le M \\le 3 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[中山市选] 杀人游戏", "background": null, "description": "一位冷血的杀手潜入 Na-wiat，并假装成平民。警察希望能在 $N$ 个人里面，查出谁是杀手。警察能够对每一个人进行查证，假如查证的对象是平民，他会告诉警察，他认识的人，谁是杀手，谁是平民。假如查证的对象是杀手，杀手将会把警察干掉。现在警察掌握了每一个人认识谁。每一个人都有可能是杀手，可看作他们是杀手的概率是相同的。\n\n问：根据最优的情况，保证警察自身安全并知道谁是杀手的概率最大是多少？", "inputFormat": "第一行有两个整数 $N,M$。\n\n接下来有 $M$ 行，每行两个整数 $x,y$，表示 $x$ 认识 $y$（$y$ 不一定认识 $x$，例如 President 同志）。", "outputFormat": "仅包含一行一个实数，保留小数点后面 $6$ 位，表示最大概率。", "hint": "警察只需要查证 $1$。假如 $1$ 是杀手，警察就会被杀。假如 $1$ 不是杀手，他会告诉警察 $2,3,4,5$ 谁是杀手。而 $1$ 是杀手的概率是 $0.2$，所以能知道谁是杀手但没被杀的概率是 $0.8$。\n\n对于 $100\\%$ 的数据有 $1\\le N\\le 1\\times 10^5,0\\le M\\le 3\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4820", "type": "P", "difficulty": 6, "samples": [["1 100", "49"], ["2 100", "74"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000, 259000]}, "tags": ["集训队互测"], "title": "[国家集训队] 书堆", "background": null, "description": "蚂蚁是勤劳的动物，他们喜欢挑战极限?现在他们迎来了一个难题！蚂蚁居住在图书馆里，图书馆里有大量的书籍。书是形状大小质量都一样的矩形。蚂蚁要把这些书摆在水平桌子的边缘。蚂蚁喜欢整洁的布置，所以蚂蚁规定书本必须水平摆放，宽必须平行于桌缘（如图），而且不允许同一高度摆多本书。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6wnkei7t.png)\n\n蚂蚁想要让书本伸出桌子边缘尽量远，同时不让书因为重力垮下来。它们己经用不知道什么方法测出了书的长度 $ M $\n (如图)。如果总共有 $ N $ 本书，请你帮忙计算如何摆放使得最多水平伸出桌缘多远。你不用考虑蚂蚁用什么方法搭建这堆书。\n\n如果某本书以上的所有书的重心的竖直射影不在这本书上，或者正好落在在这本书的边界上，那么这堆书是不稳定的，会因为重力而垮下来。\n\n考虑以下的假设：\n\n- 不考虑地球自转，重力系数也不因高度改变；\n- 书是质量均匀，质地坚硬的理想二维物体；\n- 在不会垮的前提下，每本书的位置坐标可以是任意实数。", "inputFormat": "第一行正整数 $ N $, $ M $", "outputFormat": "输出一个整数 $ L $ 表示水平延伸最远的整数距离 （不大于答案的最大整数）。", "hint": "$ N \\le 10^{18} $，数据保证答案 $< 10^{6}$", "locale": "zh-CN", "translations": {"en": {"title": "[CTT] Book Stack", "background": "", "description": "Ants are hardworking animals, and they like to challenge limits. Now they have run into a difficult problem. The ants live in a library with a large number of books. Each book is a rectangle with the same shape, size, and mass. The ants want to place these books at the edge of a horizontal table. The ants like a neat arrangement, so they require that the books must be placed horizontally, with their width parallel to the table edge (as shown in the figure), and it is not allowed to place more than one book at the same height.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6wnkei7t.png)\n\nThe ants want the books to extend out of the table edge as far as possible, while not letting the stack collapse due to gravity. They have already measured the book length $M$ (as shown in the figure) using some unknown method. If there are a total of $N$ books, please help compute how to place them so that the maximum horizontal overhang beyond the table edge is as large as possible. You do not need to consider how the ants build this stack of books.\n\nIf the vertical projection of the center of mass of all books above a certain book is not on that book, or falls exactly on the boundary of that book, then the stack is unstable and will collapse due to gravity.\n\nConsider the following assumptions:\n\n- Ignore the Earth's rotation, and the gravitational coefficient does not change with height.\n- The books are ideal 2D objects with uniform mass and rigid material.\n- Under the condition that the stack does not collapse, each book's position coordinates can be any real number.\n\n## Constraints\n\n- $N \\le 10^{18}$, and the testdata guarantees that the answer is $< 10^{6}$.", "inputFormat": "The first line contains positive integers $N$ and $M$.", "outputFormat": "Output an integer $L$, representing the farthest integer distance of horizontal extension (the greatest integer not exceeding the answer).", "hint": "$N \\le 10^{18}$, and the testdata guarantees that the answer is $< 10^{6}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[国家集训队] 书堆", "background": null, "description": "蚂蚁是勤劳的动物，他们喜欢挑战极限?现在他们迎来了一个难题！蚂蚁居住在图书馆里，图书馆里有大量的书籍。书是形状大小质量都一样的矩形。蚂蚁要把这些书摆在水平桌子的边缘。蚂蚁喜欢整洁的布置，所以蚂蚁规定书本必须水平摆放，宽必须平行于桌缘（如图），而且不允许同一高度摆多本书。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6wnkei7t.png)\n\n蚂蚁想要让书本伸出桌子边缘尽量远，同时不让书因为重力垮下来。它们己经用不知道什么方法测出了书的长度 $ M $\n (如图)。如果总共有 $ N $ 本书，请你帮忙计算如何摆放使得最多水平伸出桌缘多远。你不用考虑蚂蚁用什么方法搭建这堆书。\n\n如果某本书以上的所有书的重心的竖直射影不在这本书上，或者正好落在在这本书的边界上，那么这堆书是不稳定的，会因为重力而垮下来。\n\n考虑以下的假设：\n\n- 不考虑地球自转，重力系数也不因高度改变；\n- 书是质量均匀，质地坚硬的理想二维物体；\n- 在不会垮的前提下，每本书的位置坐标可以是任意实数。", "inputFormat": "第一行正整数 $ N $, $ M $", "outputFormat": "输出一个整数 $ L $ 表示水平延伸最远的整数距离 （不大于答案的最大整数）。", "hint": "$ N \\le 10^{18} $，数据保证答案 $< 10^{6}$", "locale": "zh-CN"}}}
