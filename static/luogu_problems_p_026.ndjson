{"pid": "P7581", "type": "P", "difficulty": 6, "samples": [["5 3 \n1 2 2\n1 3 1\n2 4 1\n2 5 2\n1 1\n1 2\n2 1", "3\n3\n3"], ["10 5\n1 2 1\n1 3 3\n2 4 2\n2 5 2\n3 6 3\n3 7 1\n5 8 2\n6 9 1\n6 10 3\n1 2\n3 2\n6 1\n1 3\n2 2", "40\n4\n4\n30\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "树形 DP", "树链剖分", "线段树合并", "离线处理"], "title": "「RdOI R2」路径权值(distance)", "background": "此题读入量较大，请选择合适的读入方式。", "description": "给你一棵 $n$ 个点的边带权有根树，根节点为编号为 $1$ 的节点。定义 $u$ 的 $k-son$ 为 $u$ 子树中深度（指经过边数）比 $u$ **恰好**大 $k$ 的所有点。  \n$m$ 次询问求一个点 $u$ 的 $k-son$ 两两之间距离的和。你需要输出这个值 $\\bmod\\left(10^9+7\\right)$ 的结果。", "inputFormat": "第一行两个数 $n,m$。  \n接下来 $n-1$ 行每行三个数 $u,v,w$，代表 $u,v$ 之间有一条边权为 $w$ 的边。  \n接下来 $m$ 行每行两个数 $u,k$，代表一个询问。", "outputFormat": "对于每个询问输出一行答案。", "hint": "**样例 $1$ 解释**\n\n以下是样例中的树。  \n![](https://cdn.luogu.com.cn/upload/image_hosting/lz4oy8ao.png)\n\n---\n\n**样例 $2$ 解释**\n\n以下是样例中的树。  \n![](https://cdn.luogu.com.cn/upload/image_hosting/hb45pofr.png)\n\n---\n\n**数据范围**\n\n对于 $20\\%$ 的数据，$n,m,k\\le100$。  \n对于 $50\\%$ 的数据，$n,m,k\\le10^3$。  \n对于 $80\\%$ 的数据，$n,m,k\\le10^5$。  \n对于 $100\\%$ 的数据，$1\\le n,m,k\\le10^6,1\\le k\\le n,1\\le w\\le10^5,1\\le u,v\\le n$，保证给出的是一棵树。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R2」路径权值(distance)", "background": "此题读入量较大，请选择合适的读入方式。", "description": "给你一棵 $n$ 个点的边带权有根树，根节点为编号为 $1$ 的节点。定义 $u$ 的 $k-son$ 为 $u$ 子树中深度（指经过边数）比 $u$ **恰好**大 $k$ 的所有点。  \n$m$ 次询问求一个点 $u$ 的 $k-son$ 两两之间距离的和。你需要输出这个值 $\\bmod\\left(10^9+7\\right)$ 的结果。", "inputFormat": "第一行两个数 $n,m$。  \n接下来 $n-1$ 行每行三个数 $u,v,w$，代表 $u,v$ 之间有一条边权为 $w$ 的边。  \n接下来 $m$ 行每行两个数 $u,k$，代表一个询问。", "outputFormat": "对于每个询问输出一行答案。", "hint": "**样例 $1$ 解释**\n\n以下是样例中的树。  \n![](https://cdn.luogu.com.cn/upload/image_hosting/lz4oy8ao.png)\n\n---\n\n**样例 $2$ 解释**\n\n以下是样例中的树。  \n![](https://cdn.luogu.com.cn/upload/image_hosting/hb45pofr.png)\n\n---\n\n**数据范围**\n\n对于 $20\\%$ 的数据，$n,m,k\\le100$。  \n对于 $50\\%$ 的数据，$n,m,k\\le10^3$。  \n对于 $80\\%$ 的数据，$n,m,k\\le10^5$。  \n对于 $100\\%$ 的数据，$1\\le n,m,k\\le10^6,1\\le k\\le n,1\\le w\\le10^5,1\\le u,v\\le n$，保证给出的是一棵树。  ", "locale": "zh-CN"}}}
{"pid": "P7582", "type": "P", "difficulty": 7, "samples": [["3 4\nab 1\nba 2\na 1\n3 1 3 aba\n1 1 2 1\n2 2 3 2\n3 1 2 abab", "5\n6"], ["6 6\naba 3\nba 2\naa 2\nc 1\nabac 4\nab 2\n3 2 5 abac\n2 3 5 3\n3 4 6 abc\n1 2 3 1\n3 1 3 aabaa\n3 2 5 aabac", "7\n5\n14\n13"], ["6 3\nb 1\naa 8\ncc 9\ncac 8\nab 10\na 7\n2 1 3 2\n3 1 4 acac\n3 1 6 ccaba", "8\n28"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["树状数组", "2021", "O2优化", "分块", "AC 自动机", "KMP 算法"], "title": "「RdOI R2」风雨(rain)", "background": "经历过风雨的洗礼，小 Soup 才更懂得珍惜。他认为所有的一切对他来说都有重要的意义。为了能让这一切被自己牢牢铭记，小 Soup 决定用一些手段将它们记录下来。  \n\n[$\\text\\color{white}{真正的题目背景}$](https://z3.ax1x.com/2021/03/29/c9xbLj.gif)\n", "description": "小 Soup 在这段时间中记录了 $n$ 个有意义的东西，他把它们用字符串表示了出来，第 $i$ 个东西被表示成 $s_i$，并定义了它的价值 $a_i$。下面，小 Soup 会进行 $m$ 次操作。  \n操作 $1$：小 Soup 将区间 $l,r$ 里的 $a_i$ 都加上一个常数 $k$。  \n操作 $2$：小 Soup 将区间 $l,r$ 里的 $a_i$ 都赋值成一个常数 $k$。  \n操作 $3$：小 Soup 给出了一段回忆，这段回忆形成了一个字符串 $S$，他想求 $S$ 在区间 $l,r$ 中的意义有多大。定义 $cnt_i$ 为 $s_i$ 在 $S$ 中的出现次数，则 $S$ 在区间 $l,r$ 中的意义为 $\\sum\\limits_{i=l}^r cnt_i\\times a_i$。", "inputFormat": "第一行两个数，$n,m$。  \n接下来 $n$ 行第 $i$ 行一个字符串 $s_i$ 和一个数 $a_i$。  \n接下来 $m$ 行每行一个操作，先有三个数，$op,l,r$。其中 $op$ 代表操作类型。$op=3$ 时，多输入一个字符串 $S$，否则多输入一个数 $k$。", "outputFormat": "对于每个 $3$ 操作输出一个数，代表总价值。", "hint": "**样例 $1$ 解释**\n\n对于第一次询问，$s_1$ 出现了 $1$ 次，对价值贡献为 $1$；$s_2$ 出现了 $1$ 次，对价值贡献为 $2$；$s_3$ 出现了 $2$ 次，对价值贡献为 $2$，总价值为 $5$。  \n对于第二次询问，$s_1$ 出现了 $2$ 次，对价值贡献为 $4$；$s_2$ 出现了 $1$ 次，对价值贡献为 $2$，总价值为 $6$。 \n\n---\n\n**数据范围**\n\n|数据编号|$\\sum s,\\sum S$|$n,m$|特殊性质|\n|:---:|:---:|:---:|:---:|\n|$1\\sim 2$|$\\le5\\times10^3$|$10^3$|$\\diagdown$|\n|$3\\sim 4$|$\\le2\\times 10^5$|$3\\times10^4$|没有 $1$ 操作|\n|$5\\sim 8$|$\\le2\\times 10^5$|$3\\times10^4$|没有 $1,2$ 操作|\n|$9\\sim 13$|$\\le2\\times 10^5$|$3\\times10^4$| $\\diagdown$|\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le3\\times10^4,k\\ge 1,\\sum |S|,\\sum |s|\\le2\\times10^5$，任何时刻 $1\\le a_i\\le2\\times10^4$，保证只会出现 $a,b,c$ 三种字符。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R2」风雨(rain)", "background": "经历过风雨的洗礼，小 Soup 才更懂得珍惜。他认为所有的一切对他来说都有重要的意义。为了能让这一切被自己牢牢铭记，小 Soup 决定用一些手段将它们记录下来。  \n\n[$\\text\\color{white}{真正的题目背景}$](https://z3.ax1x.com/2021/03/29/c9xbLj.gif)\n", "description": "小 Soup 在这段时间中记录了 $n$ 个有意义的东西，他把它们用字符串表示了出来，第 $i$ 个东西被表示成 $s_i$，并定义了它的价值 $a_i$。下面，小 Soup 会进行 $m$ 次操作。  \n操作 $1$：小 Soup 将区间 $l,r$ 里的 $a_i$ 都加上一个常数 $k$。  \n操作 $2$：小 Soup 将区间 $l,r$ 里的 $a_i$ 都赋值成一个常数 $k$。  \n操作 $3$：小 Soup 给出了一段回忆，这段回忆形成了一个字符串 $S$，他想求 $S$ 在区间 $l,r$ 中的意义有多大。定义 $cnt_i$ 为 $s_i$ 在 $S$ 中的出现次数，则 $S$ 在区间 $l,r$ 中的意义为 $\\sum\\limits_{i=l}^r cnt_i\\times a_i$。", "inputFormat": "第一行两个数，$n,m$。  \n接下来 $n$ 行第 $i$ 行一个字符串 $s_i$ 和一个数 $a_i$。  \n接下来 $m$ 行每行一个操作，先有三个数，$op,l,r$。其中 $op$ 代表操作类型。$op=3$ 时，多输入一个字符串 $S$，否则多输入一个数 $k$。", "outputFormat": "对于每个 $3$ 操作输出一个数，代表总价值。", "hint": "**样例 $1$ 解释**\n\n对于第一次询问，$s_1$ 出现了 $1$ 次，对价值贡献为 $1$；$s_2$ 出现了 $1$ 次，对价值贡献为 $2$；$s_3$ 出现了 $2$ 次，对价值贡献为 $2$，总价值为 $5$。  \n对于第二次询问，$s_1$ 出现了 $2$ 次，对价值贡献为 $4$；$s_2$ 出现了 $1$ 次，对价值贡献为 $2$，总价值为 $6$。 \n\n---\n\n**数据范围**\n\n|数据编号|$\\sum s,\\sum S$|$n,m$|特殊性质|\n|:---:|:---:|:---:|:---:|\n|$1\\sim 2$|$\\le5\\times10^3$|$10^3$|$\\diagdown$|\n|$3\\sim 4$|$\\le2\\times 10^5$|$3\\times10^4$|没有 $1$ 操作|\n|$5\\sim 8$|$\\le2\\times 10^5$|$3\\times10^4$|没有 $1,2$ 操作|\n|$9\\sim 13$|$\\le2\\times 10^5$|$3\\times10^4$| $\\diagdown$|\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le3\\times10^4,k\\ge 1,\\sum |S|,\\sum |s|\\le2\\times10^5$，任何时刻 $1\\le a_i\\le2\\times10^4$，保证只会出现 $a,b,c$ 三种字符。", "locale": "zh-CN"}}}
{"pid": "P7583", "type": "P", "difficulty": 1, "samples": [["LOVA", "LOV"], ["KARIJERA", "KJ"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "字符串", "2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #1] DOM", "background": "", "description": "给定一个仅包含大写字母的单词，删除该单词中的以下九个字母：$\\texttt{C,A,M,B,R,I,D,G,E}$。", "inputFormat": "一行一个字符串，表示给定的单词。", "outputFormat": "一行一个字符串，表示删除字母后的字符串。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，保证 $3 \\le$ 单词长度 $\\le 100$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 **[COCI2012-2013 CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf)  _T1 DOM_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #1] DOM", "background": "", "description": "给定一个仅包含大写字母的单词，删除该单词中的以下九个字母：$\\texttt{C,A,M,B,R,I,D,G,E}$。", "inputFormat": "一行一个字符串，表示给定的单词。", "outputFormat": "一行一个字符串，表示删除字母后的字符串。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，保证 $3 \\le$ 单词长度 $\\le 100$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 **[COCI2012-2013 CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf)  _T1 DOM_**。", "locale": "zh-CN"}}}
{"pid": "P7584", "type": "P", "difficulty": 2, "samples": [["3\n8\n10\n9", "3"], ["5\n15\n14\n15\n12\n14", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["贪心", "2012", "排序", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #1] F7", "background": "", "description": "有 $N$ 位选手参加一个比赛。每个回合，第一名会得到 $N$ 分，第二名会得到 $N - 1$ 分，以此类推，最后一名会得到 $1$ 分。\n\n现在第 $i$ 位选手初始有 $B_i$ 分。求多少选手经过一个回合，分数有机会变成所有选手中最高的。", "inputFormat": "输入共 $N+1$ 行。\n\n第一行包含一个正整数 $N$，表示选手总数。\n\n接下来 $N$ 行，每行包含一个整数 $B_i$，表示第 $i$ 位选手的初始分数。", "outputFormat": "输出一行一个整数，表示多少选手的分数有机会变成所有选手中最高的。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 3 \\times 10^5$，$1 \\le B_i \\le 2 \\cdot 10^6$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 **[COCI2012-2013](https://hsin.hr/coci/archive/2012_2013) [CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf) _T2 F7_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #1] F7", "background": "", "description": "有 $N$ 位选手参加一个比赛。每个回合，第一名会得到 $N$ 分，第二名会得到 $N - 1$ 分，以此类推，最后一名会得到 $1$ 分。\n\n现在第 $i$ 位选手初始有 $B_i$ 分。求多少选手经过一个回合，分数有机会变成所有选手中最高的。", "inputFormat": "输入共 $N+1$ 行。\n\n第一行包含一个正整数 $N$，表示选手总数。\n\n接下来 $N$ 行，每行包含一个整数 $B_i$，表示第 $i$ 位选手的初始分数。", "outputFormat": "输出一行一个整数，表示多少选手的分数有机会变成所有选手中最高的。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 3 \\times 10^5$，$1 \\le B_i \\le 2 \\cdot 10^6$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 **[COCI2012-2013](https://hsin.hr/coci/archive/2012_2013) [CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf) _T2 F7_**。", "locale": "zh-CN"}}}
{"pid": "P7585", "type": "P", "difficulty": 2, "samples": [["5 2\n7\n4", "3"], ["7 5\n7\n1\n7\n4\n4", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "二分", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #1] LJUBOMORA", "background": "", "description": "一家弹珠厂向一所幼儿园捐赠了一些弹珠，弹珠一共有 $M$ 种颜色，每颗弹珠都有一种颜色。老师需要把所有的弹珠分给 $N$ 个孩子。每个孩子得到的所有弹珠都必须是**相同的颜色**，而且可以有一些孩子一颗弹珠也没得到。\n\n我们把**嫉妒值**定义为分给一个孩子最多的弹珠数量。请你帮助老师分弹珠，使得嫉妒值**最小**。\n\n例如，如果有 $4$ 个红色的弹珠（$\\texttt{RRRR}$）和 $7$ 个蓝色的弹珠（$\\texttt{BBBBBBB}$），要分给 $5$ 个孩子，那么我们可以这样划分：$\\texttt{RR}$，$\\texttt{RR}$，$\\texttt{BB}$，$\\texttt{BB}$，$\\texttt{BBB}$。这样分的嫉妒值为 $3$，是最小的。", "inputFormat": "输入共 $M+1$ 行。\n\n第一行包含两个正整数 $N,M$，分别表示孩子数和弹珠的颜色总数。\n\n接下来 $M$ 行的第 $i$ 行包含一个正整数 $x$（$x \\in [1,10^9]$），表示有 $x$ 个颜色为 $i$ 的弹珠。", "outputFormat": "输出一行一个整数，表示最小的嫉妒值。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1 \\le M \\le 3 \\times 10^5$，$1 \\le N \\le 10^9$，$M \\le N$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 **[COCI2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf)** ___T4 LJUBOMORA___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #1] LJUBOMORA", "background": "", "description": "一家弹珠厂向一所幼儿园捐赠了一些弹珠，弹珠一共有 $M$ 种颜色，每颗弹珠都有一种颜色。老师需要把所有的弹珠分给 $N$ 个孩子。每个孩子得到的所有弹珠都必须是**相同的颜色**，而且可以有一些孩子一颗弹珠也没得到。\n\n我们把**嫉妒值**定义为分给一个孩子最多的弹珠数量。请你帮助老师分弹珠，使得嫉妒值**最小**。\n\n例如，如果有 $4$ 个红色的弹珠（$\\texttt{RRRR}$）和 $7$ 个蓝色的弹珠（$\\texttt{BBBBBBB}$），要分给 $5$ 个孩子，那么我们可以这样划分：$\\texttt{RR}$，$\\texttt{RR}$，$\\texttt{BB}$，$\\texttt{BB}$，$\\texttt{BBB}$。这样分的嫉妒值为 $3$，是最小的。", "inputFormat": "输入共 $M+1$ 行。\n\n第一行包含两个正整数 $N,M$，分别表示孩子数和弹珠的颜色总数。\n\n接下来 $M$ 行的第 $i$ 行包含一个正整数 $x$（$x \\in [1,10^9]$），表示有 $x$ 个颜色为 $i$ 的弹珠。", "outputFormat": "输出一行一个整数，表示最小的嫉妒值。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1 \\le M \\le 3 \\times 10^5$，$1 \\le N \\le 10^9$，$M \\le N$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 **[COCI2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf)** ___T4 LJUBOMORA___。", "locale": "zh-CN"}}}
{"pid": "P7586", "type": "P", "difficulty": 4, "samples": [["3 6", "11"], ["100 200", "262"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["数学", "2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #1] SNAGA", "background": "", "description": "从一个正整数 $N$ 开始，找到不能被 $N$ 整除的最小正整数。如果我们用得到的正整数重复这个过程，我们最终会得到 $2$。\n\n定义 $\\operatorname{strength}(N)$ 为结果序列的长度。例如 $N = 6$，可以得到由 $4$ 个数字组成的结果序列 $6,4,3,2$，包含 $4$ 个整数，所以 $\\operatorname{strength}(6) = 4$。\n\n给定两个正整数 $A,B$，请计算：\n\n$$ \\sum\\limits_{i=A}^B \\operatorname{strength}(i)$$", "inputFormat": "输入共一行，包含两个用空格分隔的整数 $A,B$。", "outputFormat": "输出一行一个整数，表示结果。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，保证 $3 \\le A < B \\le 10^{17}$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自 **[COCI2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf)** ___T5 SNAGA___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #1] SNAGA", "background": "", "description": "从一个正整数 $N$ 开始，找到不能被 $N$ 整除的最小正整数。如果我们用得到的正整数重复这个过程，我们最终会得到 $2$。\n\n定义 $\\operatorname{strength}(N)$ 为结果序列的长度。例如 $N = 6$，可以得到由 $4$ 个数字组成的结果序列 $6,4,3,2$，包含 $4$ 个整数，所以 $\\operatorname{strength}(6) = 4$。\n\n给定两个正整数 $A,B$，请计算：\n\n$$ \\sum\\limits_{i=A}^B \\operatorname{strength}(i)$$", "inputFormat": "输入共一行，包含两个用空格分隔的整数 $A,B$。", "outputFormat": "输出一行一个整数，表示结果。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，保证 $3 \\le A < B \\le 10^{17}$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自 **[COCI2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf)** ___T5 SNAGA___。", "locale": "zh-CN"}}}
{"pid": "P7587", "type": "P", "difficulty": 5, "samples": [["2\n0 7 2 1\n7 0 4 3\n2 4 0 5\n1 3 5 0", "13"], ["3\n0 2 6 3 4 7 1 3\n2 0 7 10 9 1 3 6\n6 7 0 3 5 6 5 5\n3 10 3 0 9 8 9 7\n4 9 5 9 0 9 8 4\n7 1 6 8 9 0 8 7\n1 3 5 9 8 8 0 10\n3 6 5 7 4 7 10 0", "32"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["动态规划 DP", "2012", "区间 DP", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #1] MARS", "background": "", "description": "科学家在火星上发现了一些奇怪的细菌，正在研究它们。他们注意到细菌的数量是 $2$ 的次方，因为每一种细菌都会分裂成两种新的细菌，而初始有一种细菌。因此，在第一代中只有一种细菌，第二代中有两种细菌，第三代中有四种细菌，以此类推，直到第 $K + 1$ 代中有 $2^K$ 种细菌。\n\n科学家们用 $1$ 至 $2^K$ 之间的整数给细菌进行了编号，方法如下：\n\n- 第 $K$ 代细菌的后代按顺序分别为：$\\{1,2\\},\\{3,4\\},\\{5,6\\},\\cdots,\\{2^K-1,2^K\\}$\n- 第 $K - 1$ 代细菌的后代按顺序分别为：$\\{1,2,3,4\\},\\{5,6,7,8\\},\\cdots,\\{2^K-3,2^K-2,2^K-1,2^K\\}$\n- 第 $K - 2$ 代细菌的后代按顺序分别为：$\\{1,2,3,4,5,6,7,8\\},\\cdots,\\{2^K-7,2^K-6,2^K-5,2^K-4,2^K-3,2^K-2,2^K-1,2^K\\}$\n- $\\cdots$\n- 第 $1$ 代细菌的后代按顺序分别为：$\\{1,2,\\cdots,2^{K-1}\\},\\{2^{K-1}+1,2^{K-1}+2,\\cdots,2^K\\}$\n\n其中花括号表示一个细菌的一组后代。\n\n也就是说，对当前这一代的 $2^K$ 个细菌进行编号，使得任何较老细菌的后代都有连续的编号。**注意这些细菌存在许多种不同的 仍然满足任何较老细菌的后代都有连续编号的条件 的排列。**\n\n科学家想把细菌排列成一个**长度尽可能短**的序列。细菌序列的长度是**所有相邻的细菌对之间的距离的总和**。\n\n确切地说，每两个细菌之间都有一定的**排斥值**。如果它们在序列中相邻，这个排斥值就是它们之间的最小距离（序列中不相邻的细菌之间的排斥值不起作用）。给定所有细菌对的排斥值，找出满足上述后代规则的细菌序列（排列）的最小长度。", "inputFormat": "输入的第一行包含一个正整数 $K$，意义见题目描述。\n\n接下来的 $2^K$ 行，每行包含在 $[0,10^6]$ 范围内的 $2^K$ 个整数。这 $2^K \\times 2^K$ 个整数表示细菌对之间的排斥值：第 $m$ 行第 $n$ 列中的整数是细菌 $m$ 和细菌 $n$ 之间的排斥值。当然这个整数等于第 $n$ 行第 $m$ 列的整数。如果 $m=n$，这个整数将会是 $0$。", "outputFormat": "输出一行一个整数，表示满足条件的细菌序列的最小长度。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1 \\le K \\le 9$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自 **[COCI2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf)** ___T6 MARS___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #1] MARS", "background": "", "description": "科学家在火星上发现了一些奇怪的细菌，正在研究它们。他们注意到细菌的数量是 $2$ 的次方，因为每一种细菌都会分裂成两种新的细菌，而初始有一种细菌。因此，在第一代中只有一种细菌，第二代中有两种细菌，第三代中有四种细菌，以此类推，直到第 $K + 1$ 代中有 $2^K$ 种细菌。\n\n科学家们用 $1$ 至 $2^K$ 之间的整数给细菌进行了编号，方法如下：\n\n- 第 $K$ 代细菌的后代按顺序分别为：$\\{1,2\\},\\{3,4\\},\\{5,6\\},\\cdots,\\{2^K-1,2^K\\}$\n- 第 $K - 1$ 代细菌的后代按顺序分别为：$\\{1,2,3,4\\},\\{5,6,7,8\\},\\cdots,\\{2^K-3,2^K-2,2^K-1,2^K\\}$\n- 第 $K - 2$ 代细菌的后代按顺序分别为：$\\{1,2,3,4,5,6,7,8\\},\\cdots,\\{2^K-7,2^K-6,2^K-5,2^K-4,2^K-3,2^K-2,2^K-1,2^K\\}$\n- $\\cdots$\n- 第 $1$ 代细菌的后代按顺序分别为：$\\{1,2,\\cdots,2^{K-1}\\},\\{2^{K-1}+1,2^{K-1}+2,\\cdots,2^K\\}$\n\n其中花括号表示一个细菌的一组后代。\n\n也就是说，对当前这一代的 $2^K$ 个细菌进行编号，使得任何较老细菌的后代都有连续的编号。**注意这些细菌存在许多种不同的 仍然满足任何较老细菌的后代都有连续编号的条件 的排列。**\n\n科学家想把细菌排列成一个**长度尽可能短**的序列。细菌序列的长度是**所有相邻的细菌对之间的距离的总和**。\n\n确切地说，每两个细菌之间都有一定的**排斥值**。如果它们在序列中相邻，这个排斥值就是它们之间的最小距离（序列中不相邻的细菌之间的排斥值不起作用）。给定所有细菌对的排斥值，找出满足上述后代规则的细菌序列（排列）的最小长度。", "inputFormat": "输入的第一行包含一个正整数 $K$，意义见题目描述。\n\n接下来的 $2^K$ 行，每行包含在 $[0,10^6]$ 范围内的 $2^K$ 个整数。这 $2^K \\times 2^K$ 个整数表示细菌对之间的排斥值：第 $m$ 行第 $n$ 列中的整数是细菌 $m$ 和细菌 $n$ 之间的排斥值。当然这个整数等于第 $n$ 行第 $m$ 列的整数。如果 $m=n$，这个整数将会是 $0$。", "outputFormat": "输出一行一个整数，表示满足条件的细菌序列的最小长度。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1 \\le K \\le 9$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自 **[COCI2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #1](https://hsin.hr/coci/archive/2012_2013/contest1_tasks.pdf)** ___T6 MARS___。", "locale": "zh-CN"}}}
{"pid": "P7588", "type": "P", "difficulty": 3, "samples": [["4\n3 3\n4 4\n1 5\n1 15", "1\n0\n3\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 98304]}, "tags": ["数学", "二分", "2021", "O2优化", "素数判断,质数,筛法"], "title": "双重素数（2021 CoE-II A）", "background": "", "description": "素数（质数）是指在大于 $1$ 的自然数中，除了 $1$ 和它本身以外不再有其他因数的自然数。定义**双重素数**为这样的素数：它的各位数字之和也是一个素数。给定一个闭区间，试确定在该区间内双重素数的个数。", "inputFormat": "**输入包含多组测试数据。**\n\n输入第一行包含一个整数 $T$，表示测试数据的组数。接下来每行一组测试数据，每组测试数据包含以空格分隔的两个整数 $L$ 和 $R$。", "outputFormat": "每组测试数据输出一行，包含一个整数，表示在闭区间 $[L,\\ R]$ 内双重素数的个数。", "hint": "**样例说明**\n\n从 $1$ 到 $15$ 共有 $6$ 个素数：$2$，$3$，$5$，$7$，$11$，$13$。前五个素数各自的数字之和也是素数，因此都是双重素数。素数 $13$ 的各位数字之和为 $4$，不是素数，故 $13$ 不是双重素数。\n\n------------\n\n\n**数据范围**\n\n- Subtask $1$ ：$1 \\le L \\le R \\le 10^2$，$10$ 分。\n- Subtask $2$ ：$1 \\le L \\le R \\le 10^4$，$20$ 分。\n- Subtask $3$ ：$1 \\le L \\le R \\le 10^6$，$60$ 分。\n- Subtask $4$ ：$1 \\le L \\le R \\le 10^8$，$10$ 分。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 100$。\n\n\n------------\n\n**提示（数据已经加强）**\n\n最后一个子任务要求你的程序必须具有较高的空间使用效率和时间效率，否则容易超出内存限制或时间限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "双重素数（2021 CoE-II A）", "background": "", "description": "素数（质数）是指在大于 $1$ 的自然数中，除了 $1$ 和它本身以外不再有其他因数的自然数。定义**双重素数**为这样的素数：它的各位数字之和也是一个素数。给定一个闭区间，试确定在该区间内双重素数的个数。", "inputFormat": "**输入包含多组测试数据。**\n\n输入第一行包含一个整数 $T$，表示测试数据的组数。接下来每行一组测试数据，每组测试数据包含以空格分隔的两个整数 $L$ 和 $R$。", "outputFormat": "每组测试数据输出一行，包含一个整数，表示在闭区间 $[L,\\ R]$ 内双重素数的个数。", "hint": "**样例说明**\n\n从 $1$ 到 $15$ 共有 $6$ 个素数：$2$，$3$，$5$，$7$，$11$，$13$。前五个素数各自的数字之和也是素数，因此都是双重素数。素数 $13$ 的各位数字之和为 $4$，不是素数，故 $13$ 不是双重素数。\n\n------------\n\n\n**数据范围**\n\n- Subtask $1$ ：$1 \\le L \\le R \\le 10^2$，$10$ 分。\n- Subtask $2$ ：$1 \\le L \\le R \\le 10^4$，$20$ 分。\n- Subtask $3$ ：$1 \\le L \\le R \\le 10^6$，$60$ 分。\n- Subtask $4$ ：$1 \\le L \\le R \\le 10^8$，$10$ 分。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 100$。\n\n\n------------\n\n**提示（数据已经加强）**\n\n最后一个子任务要求你的程序必须具有较高的空间使用效率和时间效率，否则容易超出内存限制或时间限制。", "locale": "zh-CN"}}}
{"pid": "P7589", "type": "P", "difficulty": 4, "samples": [["2\n\n2 0 10\n3 4 8\n7 7 5\n\n3 5 15\n-3 -9 -19\n-7 10 21\n12 12 16", "Yes\nNo"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["博弈论", "2021", "O2优化", "SG 函数"], "title": "黑白棋（2021 CoE-II B）", "background": "", "description": "$\\text{Alice}$ 和 $\\text{Bob}$ 正在玩一种称为“黑白棋”的游戏。该游戏的规则如下：\n\n- 游戏在直角坐标系中进行。\n\n- $\\text{Alice}$ 执黑棋，$\\text{Bob}$ 执白棋。\n\n- 初始时，在直角坐标系中任选 $n$ 条与 $X$ 轴平行的直线，直线在 $Y$ 轴上的截距均为整数，且互不相同。$\\text{Alice}$ 在每条直线上都会放置一枚黑棋，$\\text{Bob}$ 在每条直线上都会放置一枚白棋，棋子位置的 $X$ 坐标值均为整数。在同一条直线上的两枚棋子位置不会相同。\n\n- $\\text{Alice}$ 和 $\\text{Bob}$ 轮流走棋，$\\text{Alice}$ 总是先走棋。每名玩家在走棋时，先选择一条直线，然后沿着直线移动该条直线上己方颜色的棋子。\n\n- 每个玩家可以将自己的棋子向着靠近对方棋子的方向一次性移动若干整数单位距离，称之为**前进**。每个玩家也可以向着远离对方棋子的方向一次性移动若干整数单位距离，称之为**后退**。只要在前进时不跨过对方的棋子，也不使黑棋和白棋的位置发生重叠，前进的最远距离不限，但是前进的距离至少为 $1$，如果无法满足前述条件，则玩家不能执行前进操作。为了避免玩家反复后退导致游戏无法结束，在一局游戏中，某个玩家执行后退操作的总次数不能超过 $k$ 次。与此同时，为了防止游戏区域太大以致在显示游戏状态上造成不便，每次后退的距离至少为 $1$，但不能超过 $d$。如果无法满足前述条件，玩家不能执行后退操作。\n\n- 玩家在轮到自己走棋时，如果能够执行操作就必须执行一次操作，此操作可以是前进操作，也可以是后退操作（如果未超出后退次数的限制）。\n\n- 如果某个玩家无法执行任何操作来移动自己的棋子，将输掉游戏，游戏结束。\n\n给定游戏的初始状态，假设 $\\text{Alice}$ 和 $\\text{Bob}$ 在游戏时均采用最佳策略，试确定 $\\text{Alice}$ 能否获胜。", "inputFormat": "**输入包含多组测试数据。**\n\n输入第一行包含一个整数 $T$，表示测试数据的组数。接着是一个空行。接下来是 $T$ 组表示游戏初始状态的数据。\n\n每组数据的第一行包含三个整数 $n$，$k$，$d$，表示直线的数量，允许后退的总次数，每次后退的最大距离。接下来是 $n$ 行数据，每行包含三个整数 $y_i$，$b_i$，$w_i$，分别表示第 $i$ 条直线的 $Y$ 轴截距以及在该条直线上的黑棋的 $X$ 坐标值和白棋的 $X$ 坐标值（$b_i \\ne w_i$）。\n\n每两组测试数据之间有一个空行。", "outputFormat": "如果 $\\text{Alice}$ 能够获胜，输出 `Yes`，否则输出 `No`。", "hint": "**样例说明**\n\n下图对应输入 \\#1 的第一组数据，如果 $\\text{Alice}$ 采用最优策略，无论 $\\text{Bob}$ 如何走棋，$\\text{Alice}$ 都能够获胜。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3y151p4f.png)\n\n以下是 $\\text{Alice}$ 的必胜策略。首先，$\\text{Alice}$ 选择将 $y=3$ 的直线上的黑棋从 `4` 移动到 `6`，使得两条直线上黑棋和白棋之间的间距均为 $2$，由于 $k$ 为 $0$，相当于不允许执行后退操作，如果 $\\text{Bob}$ 选择移动 $y=3$ 直线上的白棋，将使得该直线上的两颗棋子相邻，后续无法再移动。同样的，如果 $\\text{Bob}$ 选择移动 $y=7$ 直线上的白棋，也将使得该直线上的两颗棋子相邻，后续无法再移动。因此无论 $\\text{Bob}$ 如何操作，总会使得一条直线上的两颗棋子相邻，无法再继续移动，而另外一条直线上的棋子间距为 $2$，还可以再移动一次，$\\text{Alice}$ 将剩下可以移动的黑棋再移动一步后，后续 $\\text{Bob}$ 无法移动白棋，因此 $\\text{Alice}$ 会获胜。\n\n对于输入 \\#1 的第二组数据，无论 $\\text{Alice}$ 如何走棋，$\\text{Bob}$ 总能够获胜。\n\n------------\n\n**数据范围**\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 100$，$1 \\le n \\le 100$，$0 \\le k \\le 100$，$1 \\le d \\le 20$，$-100 \\le y_i \\le 100$，$-10^3 \\le b_i \\le 10^3$，$-10^3 \\le w_i \\le 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "黑白棋（2021 CoE-II B）", "background": "", "description": "$\\text{Alice}$ 和 $\\text{Bob}$ 正在玩一种称为“黑白棋”的游戏。该游戏的规则如下：\n\n- 游戏在直角坐标系中进行。\n\n- $\\text{Alice}$ 执黑棋，$\\text{Bob}$ 执白棋。\n\n- 初始时，在直角坐标系中任选 $n$ 条与 $X$ 轴平行的直线，直线在 $Y$ 轴上的截距均为整数，且互不相同。$\\text{Alice}$ 在每条直线上都会放置一枚黑棋，$\\text{Bob}$ 在每条直线上都会放置一枚白棋，棋子位置的 $X$ 坐标值均为整数。在同一条直线上的两枚棋子位置不会相同。\n\n- $\\text{Alice}$ 和 $\\text{Bob}$ 轮流走棋，$\\text{Alice}$ 总是先走棋。每名玩家在走棋时，先选择一条直线，然后沿着直线移动该条直线上己方颜色的棋子。\n\n- 每个玩家可以将自己的棋子向着靠近对方棋子的方向一次性移动若干整数单位距离，称之为**前进**。每个玩家也可以向着远离对方棋子的方向一次性移动若干整数单位距离，称之为**后退**。只要在前进时不跨过对方的棋子，也不使黑棋和白棋的位置发生重叠，前进的最远距离不限，但是前进的距离至少为 $1$，如果无法满足前述条件，则玩家不能执行前进操作。为了避免玩家反复后退导致游戏无法结束，在一局游戏中，某个玩家执行后退操作的总次数不能超过 $k$ 次。与此同时，为了防止游戏区域太大以致在显示游戏状态上造成不便，每次后退的距离至少为 $1$，但不能超过 $d$。如果无法满足前述条件，玩家不能执行后退操作。\n\n- 玩家在轮到自己走棋时，如果能够执行操作就必须执行一次操作，此操作可以是前进操作，也可以是后退操作（如果未超出后退次数的限制）。\n\n- 如果某个玩家无法执行任何操作来移动自己的棋子，将输掉游戏，游戏结束。\n\n给定游戏的初始状态，假设 $\\text{Alice}$ 和 $\\text{Bob}$ 在游戏时均采用最佳策略，试确定 $\\text{Alice}$ 能否获胜。", "inputFormat": "**输入包含多组测试数据。**\n\n输入第一行包含一个整数 $T$，表示测试数据的组数。接着是一个空行。接下来是 $T$ 组表示游戏初始状态的数据。\n\n每组数据的第一行包含三个整数 $n$，$k$，$d$，表示直线的数量，允许后退的总次数，每次后退的最大距离。接下来是 $n$ 行数据，每行包含三个整数 $y_i$，$b_i$，$w_i$，分别表示第 $i$ 条直线的 $Y$ 轴截距以及在该条直线上的黑棋的 $X$ 坐标值和白棋的 $X$ 坐标值（$b_i \\ne w_i$）。\n\n每两组测试数据之间有一个空行。", "outputFormat": "如果 $\\text{Alice}$ 能够获胜，输出 `Yes`，否则输出 `No`。", "hint": "**样例说明**\n\n下图对应输入 \\#1 的第一组数据，如果 $\\text{Alice}$ 采用最优策略，无论 $\\text{Bob}$ 如何走棋，$\\text{Alice}$ 都能够获胜。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3y151p4f.png)\n\n以下是 $\\text{Alice}$ 的必胜策略。首先，$\\text{Alice}$ 选择将 $y=3$ 的直线上的黑棋从 `4` 移动到 `6`，使得两条直线上黑棋和白棋之间的间距均为 $2$，由于 $k$ 为 $0$，相当于不允许执行后退操作，如果 $\\text{Bob}$ 选择移动 $y=3$ 直线上的白棋，将使得该直线上的两颗棋子相邻，后续无法再移动。同样的，如果 $\\text{Bob}$ 选择移动 $y=7$ 直线上的白棋，也将使得该直线上的两颗棋子相邻，后续无法再移动。因此无论 $\\text{Bob}$ 如何操作，总会使得一条直线上的两颗棋子相邻，无法再继续移动，而另外一条直线上的棋子间距为 $2$，还可以再移动一次，$\\text{Alice}$ 将剩下可以移动的黑棋再移动一步后，后续 $\\text{Bob}$ 无法移动白棋，因此 $\\text{Alice}$ 会获胜。\n\n对于输入 \\#1 的第二组数据，无论 $\\text{Alice}$ 如何走棋，$\\text{Bob}$ 总能够获胜。\n\n------------\n\n**数据范围**\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 100$，$1 \\le n \\le 100$，$0 \\le k \\le 100$，$1 \\le d \\le 20$，$-100 \\le y_i \\le 100$，$-10^3 \\le b_i \\le 10^3$，$-10^3 \\le w_i \\le 10^3$。", "locale": "zh-CN"}}}
{"pid": "P7590", "type": "P", "difficulty": 4, "samples": [["1\n\n3\n1 2 3\n2 3 4", "Failed!"], ["1\n\n10\n1 2 3 4 5 6 7 8 9 10\n3 2 1 2 3 4 5 6 7 8", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["单调队列", "2021", "其它技巧"], "title": "回旋加速器（2021 CoE-II C）", "background": "", "description": "回旋加速器（$\\text{Cyclotron}$）是利用磁场和电场使带电粒子作回旋运动并经高频电场反复加速的装置，是高能物理中的重要仪器。\n\n我们来研究回旋加速器的一个简化模型。将回旋加速器视为一个环形的轨道，轨道上设置了 $n$ 个加速腔，依次编号为 $1$ 至 $n$。将一束质子从某个加速腔导入，在导入时，质子束的动能为零。第 $i$ 个加速腔能够为质子束提供 $e_i$ 的动能 ，质子束从第 $i$ 个加速腔运行到第 $i + 1$ 个加速腔会损失 $d_i$ 的动能（由于是环形轨道，编号为 $n$ 的加速腔后面是编号为 $1$ 的加速腔）。\n\n给定每个加速腔能够提供的动能值以及质子束在各个加速腔之间运行所损失的动能值，试确定质子束能否绕环形轨道运行一周。如果能够成功，应该选择从哪个加速腔导入质子束。质子束在两个加速腔之间运行时，动能不能为零，但质子束刚到达加速腔时，动能可以为零，因为可以立即获得加速腔所提供的动能。", "inputFormat": "**输入包含多组测试数据。**\n\n输入第一行包含一个整数 $T$，表示测试数据的组数。接着是一个空行。\n\n接下来是 $T$ 组数据，每组数据由三行构成。两组数据之间有一个空行。\n\n每组数据的第一行是一个整数 $n$，表示加速腔的个数。第二行一共 $n$ 个整数，依次表示编号为 $i$ 的加速腔能够提供的动能 $e_i$。第三行一共 $n$ 个整数，依次表示质子束从第 $i$ 个加速腔运行到第 $i + 1$ 个加速腔所损失的动能 $d_i$。由于是环形轨道，第三行的第 $n$ 个整数表示的是从第 $n$ 个加速腔运行到第 $1$ 个加速腔时损失的动能。", "outputFormat": "每组数据输出一行。如果质子束无法环绕加速器运行一周，输出 `Failed!`，否则输出导入质子束的加速腔编号，如果有多个加速腔可供选择，选择具有最小编号的加速腔。", "hint": "**样例说明**\n\n输入 #1\n\n该组输入共有 $3$ 个加速腔，依次能够提供的动能为 $1$、$2$、$3$。从第 $1$ 个加速腔运行到第 $2$ 个加速腔损失 $2$ 动能，从第 $2$ 个加速腔运行到第 $3$ 个加速腔损失 $3$ 动能，从第 $3$ 个加速腔运行到第 $1$ 个加速腔损失 $4$ 动能。不管从哪个加速腔导入质子束，都会使得质子束在两个加速腔运行过程中动能变为零，无法环绕轨道一周。\n\n输入 #2\n\n该组输入共有 $10$ 个加速腔，如果从第 $1$ 个加速腔导入质子束，将获得动能 $1$，但是在从第 $1$ 个加速腔运行到第 $2$ 个加速腔的过程中会损失 $3$ 动能，因此会使得质子束无法环绕轨道一周。而从第 $2$ 个到第 $10$ 个加速腔中的任意一个导入质子束，均能保证质子束在加速腔之间运行时动能不为零，因此都可作为导入质子束的加速腔，但编号为 $2$ 的加速腔具有最小的编号。需要注意，从第 $2$ 个加速腔导入质子束，当运行到第 $3$ 个加速腔时，动能恰为零，根据题意，这种情形是允许的。\n\n------------\n\n\n**数据范围**\n\n- Subtask $1$：$2 \\le n \\le 10$，$10$ 分。\n- Subtask $2$：$2 \\le n \\le 10^3$，$30$ 分。\n- Subtask $3$：$2 \\le n \\le 10^5$，$30$ 分。\n- Subtask $4$：$2 \\le n \\le 10^6$，$30$ 分。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 20$，$0 \\lt e_i \\le 100$，$0 \\lt d_i \\le 100$。\n\n\n\n------------\n\n**约定**\n\n质子束的运行方向规定为：从第 $1$ 个加速腔到第 $2$ 个加速腔，从第 $2$ 个加速腔到第 $3$ 个加速腔$\\cdots$从第 $n$ 个加速腔到第 $1$ 个加速腔。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "回旋加速器（2021 CoE-II C）", "background": "", "description": "回旋加速器（$\\text{Cyclotron}$）是利用磁场和电场使带电粒子作回旋运动并经高频电场反复加速的装置，是高能物理中的重要仪器。\n\n我们来研究回旋加速器的一个简化模型。将回旋加速器视为一个环形的轨道，轨道上设置了 $n$ 个加速腔，依次编号为 $1$ 至 $n$。将一束质子从某个加速腔导入，在导入时，质子束的动能为零。第 $i$ 个加速腔能够为质子束提供 $e_i$ 的动能 ，质子束从第 $i$ 个加速腔运行到第 $i + 1$ 个加速腔会损失 $d_i$ 的动能（由于是环形轨道，编号为 $n$ 的加速腔后面是编号为 $1$ 的加速腔）。\n\n给定每个加速腔能够提供的动能值以及质子束在各个加速腔之间运行所损失的动能值，试确定质子束能否绕环形轨道运行一周。如果能够成功，应该选择从哪个加速腔导入质子束。质子束在两个加速腔之间运行时，动能不能为零，但质子束刚到达加速腔时，动能可以为零，因为可以立即获得加速腔所提供的动能。", "inputFormat": "**输入包含多组测试数据。**\n\n输入第一行包含一个整数 $T$，表示测试数据的组数。接着是一个空行。\n\n接下来是 $T$ 组数据，每组数据由三行构成。两组数据之间有一个空行。\n\n每组数据的第一行是一个整数 $n$，表示加速腔的个数。第二行一共 $n$ 个整数，依次表示编号为 $i$ 的加速腔能够提供的动能 $e_i$。第三行一共 $n$ 个整数，依次表示质子束从第 $i$ 个加速腔运行到第 $i + 1$ 个加速腔所损失的动能 $d_i$。由于是环形轨道，第三行的第 $n$ 个整数表示的是从第 $n$ 个加速腔运行到第 $1$ 个加速腔时损失的动能。", "outputFormat": "每组数据输出一行。如果质子束无法环绕加速器运行一周，输出 `Failed!`，否则输出导入质子束的加速腔编号，如果有多个加速腔可供选择，选择具有最小编号的加速腔。", "hint": "**样例说明**\n\n输入 #1\n\n该组输入共有 $3$ 个加速腔，依次能够提供的动能为 $1$、$2$、$3$。从第 $1$ 个加速腔运行到第 $2$ 个加速腔损失 $2$ 动能，从第 $2$ 个加速腔运行到第 $3$ 个加速腔损失 $3$ 动能，从第 $3$ 个加速腔运行到第 $1$ 个加速腔损失 $4$ 动能。不管从哪个加速腔导入质子束，都会使得质子束在两个加速腔运行过程中动能变为零，无法环绕轨道一周。\n\n输入 #2\n\n该组输入共有 $10$ 个加速腔，如果从第 $1$ 个加速腔导入质子束，将获得动能 $1$，但是在从第 $1$ 个加速腔运行到第 $2$ 个加速腔的过程中会损失 $3$ 动能，因此会使得质子束无法环绕轨道一周。而从第 $2$ 个到第 $10$ 个加速腔中的任意一个导入质子束，均能保证质子束在加速腔之间运行时动能不为零，因此都可作为导入质子束的加速腔，但编号为 $2$ 的加速腔具有最小的编号。需要注意，从第 $2$ 个加速腔导入质子束，当运行到第 $3$ 个加速腔时，动能恰为零，根据题意，这种情形是允许的。\n\n------------\n\n\n**数据范围**\n\n- Subtask $1$：$2 \\le n \\le 10$，$10$ 分。\n- Subtask $2$：$2 \\le n \\le 10^3$，$30$ 分。\n- Subtask $3$：$2 \\le n \\le 10^5$，$30$ 分。\n- Subtask $4$：$2 \\le n \\le 10^6$，$30$ 分。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 20$，$0 \\lt e_i \\le 100$，$0 \\lt d_i \\le 100$。\n\n\n\n------------\n\n**约定**\n\n质子束的运行方向规定为：从第 $1$ 个加速腔到第 $2$ 个加速腔，从第 $2$ 个加速腔到第 $3$ 个加速腔$\\cdots$从第 $n$ 个加速腔到第 $1$ 个加速腔。", "locale": "zh-CN"}}}
{"pid": "P7591", "type": "P", "difficulty": 6, "samples": [["1\n1 2 1.00\n1\n0 1 2 3\n10 20", "5.0 8.0"], ["3\n1 2 1.00\n2 3 0.50\n3 4 0.70\n2\n0 1 2 3\n0 2 4 5\n10 20", "7.5 10.5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2021", "Special Judge", "O2优化", "期望"], "title": "狩猎（2021 CoE-II D）", "background": "", "description": "母狮 $\\text{Dina}$ 的领地里有固定的 $n$ 个狩猎点，第 $i$ 个狩猎点有 $p_i$ 的概率可以捕捉到猎物，$\\text{Dina}$ 的巢穴和 $n$ 个狩猎点相互之间存在若干条直接连接的双向道路。\n\n每天早晨，$\\text{Dina}$ 从她的巢穴出发，随机选择一个与巢穴相邻的狩猎点 $u$ 进行一次捕猎，如果她未捕捉到猎物，她会随机选择一个与当前狩猎点 $u$ 相邻的其他狩猎点 $v$ 继续进行一次捕猎，如果在狩猎点 $v$ 仍未捕捉到猎物，$\\text{Dina}$ 会按照前述过程继续捕猎。如果在某个狩猎点捕捉到了猎物，$\\text{Dina}$ 会立即返回巢穴，结束捕猎。若当前狩猎点 $u$ 与巢穴相邻，而与其他狩猎点不相邻，$\\text{Dina}$ 也会选择立即返回巢穴，然后从与巢穴相邻的狩猎点中，随机选择一个狩猎点继续上述捕猎过程。$\\text{Dina}$ 在每个狩猎点只进行一次捕猎，然后离开，但后续可能还会回到该狩猎点再次进行捕猎。在本题环境下，如果地点 $u$ 和地点 $v$ 之间有一条直接连接的双向道路，称地点 $u$ 和地点 $v$ **相邻**，否则称地点 $u$ 和地点 $v$ **不相邻**。\n\n令巢穴的编号为 $0$，$n$ 个狩猎点的编号从 $1$ 到 $n$，$\\text{Dina}$ 从编号为 $u$ 的地点到达另外一个编号为 $v$ 的地点需要消耗 $h_{u,v}$ 体力和 $t_{u,v}$ 时间。在第 $i$ 个狩猎点每进行一次捕猎，$\\text{Dina}$ 会消耗 $h_i$ 体力和 $t_i$ 时间。每当 $\\text{Dina}$ 到达某个狩猎点并进行一次捕猎后，她会评估自己的体力消耗和时间花费，如果体力消耗已经达到（或超过）限值 $H$，她就选择立即返回巢穴结束捕猎。如果时间花费已经达到（或超过）限值 $T$，她也会选择立即返回巢穴结束捕猎。$\\text{Dina}$ 只有在到达狩猎点并进行一次捕猎后才进行评估，在任何其他时刻均不会进行评估。如果当前位于巢穴，她会在到达巢穴时就进行评估，因为巢穴并无猎物可供捕捉。\n\n需要注意，$\\text{Dina}$ 在沿着两个地点间的双向道路移动的过程中并不会评估，因此可能会出现以下情形：到达某个狩猎点且尚未进行捕猎时，$\\text{Dina}$ 已消耗的体力或者已花费的时间已经超过限值。在这种情形下，$\\text{Dina}$ 仍然会进行一次捕猎，之后再进行评估。\n\n当 $\\text{Dina}$ 因为捕猎成功、体力消耗或时间花费达到（或超过）相应限值、当前狩猎点与其他狩猎点不相邻而返回巢穴时，她总会选择一条具有最少时间花费的路径。如果存在多条具有最少时间花费的路径返回巢穴，她会选择其中体力消耗最少的路径。$\\text{Dina}$ 在返回巢穴的过程中不会进行捕猎。\n\n将 $\\text{Dina}$ 从巢穴出发，因满足以下三个条件之一：\n\n- 捕猎成功\n- 体力消耗达到（或超过）限值 $H$\n- 时间花费达到（或超过）限值 $T$\n\n返回到达巢穴并结束捕猎的过程称为一次狩猎。给出巢穴和狩猎点之间的道路、每条道路所需要消耗的体力和花费的时间、每个狩猎点进行一次捕猎能够捕获猎物的概率以及所需消耗的体力、花费的时间，试确定 $\\text{Dina}$ 完成一次狩猎所消耗体力和花费时间的平均值。", "inputFormat": "输入的第一行包含一个整数 $n$，表示狩猎点的数量。\n\n接下来 $n$ 行，每行包含三个数值：整数 $h_i$，整数 $t_i$，实数 $p_i$，分别表示在第 $i$ 个狩猎点进行一次捕猎所消耗的体力、花费的时间、能够捕获猎物的概率。\n\n接下来是一个整数 $m$，表示连接各个地点的双向道路的数量。接着 $m$ 行，每行包含四个整数 $u$，$v$，$h_{u,v}$，$t_{u,v}$，表示从编号为 $u$（$0 \\le i \\le n$）的地点到另外一个编号为 $v$（$0 \\le i \\le n$，$u \\ne v$）的地点之间存在一条直接连通的道路，需要消耗 $h_{u,v}$ 体力和花费 $t_{u,v}$ 时间。由于是双向道路，从地点 $u$ 到达地点 $v$ 与从地点 $v$ 到达地点 $u$ 所消耗体力和花费时间相同。\n\n最后是两个整数 $H$ 和 $T$，表示体力和时间的限值。", "outputFormat": "输出一行，包含两个实数，精确到小数点后一位，分别表示 $\\text{Dina}$ 完成一次狩猎所消耗体力和花费时间的平均值。如果你的输出和参考输出绝对误差小于$10^{-1}$，均认为正确。", "hint": "**子任务测试采用捆绑方式计分。**\n\n**样例说明**\n\n输入 #1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/62vbngdn.png)\n\n该输入只包含一个狩猎点，从巢穴到狩猎点 $1$ 之间的道路需要消耗 $2$ 体力和 $3$ 时间，体力的限值为 $10$，时间的限值为 $20$，在狩猎点 $1$ 进行一次捕猎需要消耗 $1$ 体力和 $2$ 时间，在狩猎点 $1$ 捕获猎物的概率为 $1.00$，即一定会捕捉到猎物。容易知道，进行一次狩猎所消耗的体力和花费时间的平均值分别为 $5.0=(2+1+2) \\times 100\\%$ 和 $8.0=(3+2+3) \\times 100\\%$。\n\n输入 #2\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k4q1qkwr.png)\n\n相较于第一组输入，新增了两个狩猎点，但只有狩猎点 $1$ 和狩猎点 $2$ 与巢穴有直接道路相连。三个狩猎点之间无直接道路相连，但狩猎点 $1$ 可以间接通过巢穴与狩猎点 $2$ 连通。从巢穴到狩猎点 $2$ 的道路需要消耗 $4$ 体力和 $5$ 时间，在狩猎点 $2$ 进行一次捕猎需要消耗 $2$ 体力和 $3$ 时间。在狩猎点 $1$ 捕获猎物的概率为 $1.00$，即一定会捕捉到猎物，因此 $\\text{Dina}$ 会立即返回巢穴并结束狩猎。在狩猎点 $2$ 捕获猎物的概率为 $0.50$，即有 $50\\%$ 的概率会捕捉到猎物，但由于狩猎点 $2$ 没有其他狩猎点与之直接连通，因此不管在狩猎点 $2$ 是否捕获到猎物，$\\text{Dina}$ 都会选择立即返回巢穴，在返回巢穴时，已经消耗 $10$ 体力，根据题意，不管 $\\text{Dina}$ 是否已经捕捉到了猎物，她都会结束狩猎。由于是随机选择，故在巢穴时选择狩猎点 $1$ 和 $2$ 进行狩猎的概率均为 $50\\%$，根据计算可知，进行一次狩猎所消耗的体力和花费时间的平均值分别为 $7.5=(2+1+2) \\times 50\\%+(4+2+4) \\times 50\\%$ 和 $10.5=(3+2+3) \\times 50\\%+(5+3+5) \\times 50\\%$。\n\n------------\n\n**数据范围**\n\n- Subtask $1$：$n=1$，$10$ 分。\n- Subtask $2$：$1 \\le n \\le 20$，每个狩猎点和其他狩猎点均无直接道路相连，$20$ 分。\n- Subtask $3$：无特殊限制，$70$ 分。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 200$，$1 \\le h_i \\le 10$，$1 \\le t_i \\le 10$，$0 \\le p_i \\le 1$，$1 \\le m \\le \\text{min}(n (n+1) / 2$，$2000$)，$1 \\le h_{u,v} \\le 20$，$1 \\le t_{u,v} \\le 20$，$1 \\le H \\le 200$，$1 \\le T \\le 200$。\n\n------------\n\n**约定**\n\n- 地点 $u$ 和地点 $v$ 之间至多有一条直接连接的双向道路，两个地点之间的直连双向道路不会重复给出。\n- 忽略 $\\text{Dina}$ 进行评估所需要的时间。\n- 在输入中，表示概率 $p_i$ 的数值是一个具有两位小数的实数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "狩猎（2021 CoE-II D）", "background": "", "description": "母狮 $\\text{Dina}$ 的领地里有固定的 $n$ 个狩猎点，第 $i$ 个狩猎点有 $p_i$ 的概率可以捕捉到猎物，$\\text{Dina}$ 的巢穴和 $n$ 个狩猎点相互之间存在若干条直接连接的双向道路。\n\n每天早晨，$\\text{Dina}$ 从她的巢穴出发，随机选择一个与巢穴相邻的狩猎点 $u$ 进行一次捕猎，如果她未捕捉到猎物，她会随机选择一个与当前狩猎点 $u$ 相邻的其他狩猎点 $v$ 继续进行一次捕猎，如果在狩猎点 $v$ 仍未捕捉到猎物，$\\text{Dina}$ 会按照前述过程继续捕猎。如果在某个狩猎点捕捉到了猎物，$\\text{Dina}$ 会立即返回巢穴，结束捕猎。若当前狩猎点 $u$ 与巢穴相邻，而与其他狩猎点不相邻，$\\text{Dina}$ 也会选择立即返回巢穴，然后从与巢穴相邻的狩猎点中，随机选择一个狩猎点继续上述捕猎过程。$\\text{Dina}$ 在每个狩猎点只进行一次捕猎，然后离开，但后续可能还会回到该狩猎点再次进行捕猎。在本题环境下，如果地点 $u$ 和地点 $v$ 之间有一条直接连接的双向道路，称地点 $u$ 和地点 $v$ **相邻**，否则称地点 $u$ 和地点 $v$ **不相邻**。\n\n令巢穴的编号为 $0$，$n$ 个狩猎点的编号从 $1$ 到 $n$，$\\text{Dina}$ 从编号为 $u$ 的地点到达另外一个编号为 $v$ 的地点需要消耗 $h_{u,v}$ 体力和 $t_{u,v}$ 时间。在第 $i$ 个狩猎点每进行一次捕猎，$\\text{Dina}$ 会消耗 $h_i$ 体力和 $t_i$ 时间。每当 $\\text{Dina}$ 到达某个狩猎点并进行一次捕猎后，她会评估自己的体力消耗和时间花费，如果体力消耗已经达到（或超过）限值 $H$，她就选择立即返回巢穴结束捕猎。如果时间花费已经达到（或超过）限值 $T$，她也会选择立即返回巢穴结束捕猎。$\\text{Dina}$ 只有在到达狩猎点并进行一次捕猎后才进行评估，在任何其他时刻均不会进行评估。如果当前位于巢穴，她会在到达巢穴时就进行评估，因为巢穴并无猎物可供捕捉。\n\n需要注意，$\\text{Dina}$ 在沿着两个地点间的双向道路移动的过程中并不会评估，因此可能会出现以下情形：到达某个狩猎点且尚未进行捕猎时，$\\text{Dina}$ 已消耗的体力或者已花费的时间已经超过限值。在这种情形下，$\\text{Dina}$ 仍然会进行一次捕猎，之后再进行评估。\n\n当 $\\text{Dina}$ 因为捕猎成功、体力消耗或时间花费达到（或超过）相应限值、当前狩猎点与其他狩猎点不相邻而返回巢穴时，她总会选择一条具有最少时间花费的路径。如果存在多条具有最少时间花费的路径返回巢穴，她会选择其中体力消耗最少的路径。$\\text{Dina}$ 在返回巢穴的过程中不会进行捕猎。\n\n将 $\\text{Dina}$ 从巢穴出发，因满足以下三个条件之一：\n\n- 捕猎成功\n- 体力消耗达到（或超过）限值 $H$\n- 时间花费达到（或超过）限值 $T$\n\n返回到达巢穴并结束捕猎的过程称为一次狩猎。给出巢穴和狩猎点之间的道路、每条道路所需要消耗的体力和花费的时间、每个狩猎点进行一次捕猎能够捕获猎物的概率以及所需消耗的体力、花费的时间，试确定 $\\text{Dina}$ 完成一次狩猎所消耗体力和花费时间的平均值。", "inputFormat": "输入的第一行包含一个整数 $n$，表示狩猎点的数量。\n\n接下来 $n$ 行，每行包含三个数值：整数 $h_i$，整数 $t_i$，实数 $p_i$，分别表示在第 $i$ 个狩猎点进行一次捕猎所消耗的体力、花费的时间、能够捕获猎物的概率。\n\n接下来是一个整数 $m$，表示连接各个地点的双向道路的数量。接着 $m$ 行，每行包含四个整数 $u$，$v$，$h_{u,v}$，$t_{u,v}$，表示从编号为 $u$（$0 \\le i \\le n$）的地点到另外一个编号为 $v$（$0 \\le i \\le n$，$u \\ne v$）的地点之间存在一条直接连通的道路，需要消耗 $h_{u,v}$ 体力和花费 $t_{u,v}$ 时间。由于是双向道路，从地点 $u$ 到达地点 $v$ 与从地点 $v$ 到达地点 $u$ 所消耗体力和花费时间相同。\n\n最后是两个整数 $H$ 和 $T$，表示体力和时间的限值。", "outputFormat": "输出一行，包含两个实数，精确到小数点后一位，分别表示 $\\text{Dina}$ 完成一次狩猎所消耗体力和花费时间的平均值。如果你的输出和参考输出绝对误差小于$10^{-1}$，均认为正确。", "hint": "**子任务测试采用捆绑方式计分。**\n\n**样例说明**\n\n输入 #1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/62vbngdn.png)\n\n该输入只包含一个狩猎点，从巢穴到狩猎点 $1$ 之间的道路需要消耗 $2$ 体力和 $3$ 时间，体力的限值为 $10$，时间的限值为 $20$，在狩猎点 $1$ 进行一次捕猎需要消耗 $1$ 体力和 $2$ 时间，在狩猎点 $1$ 捕获猎物的概率为 $1.00$，即一定会捕捉到猎物。容易知道，进行一次狩猎所消耗的体力和花费时间的平均值分别为 $5.0=(2+1+2) \\times 100\\%$ 和 $8.0=(3+2+3) \\times 100\\%$。\n\n输入 #2\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k4q1qkwr.png)\n\n相较于第一组输入，新增了两个狩猎点，但只有狩猎点 $1$ 和狩猎点 $2$ 与巢穴有直接道路相连。三个狩猎点之间无直接道路相连，但狩猎点 $1$ 可以间接通过巢穴与狩猎点 $2$ 连通。从巢穴到狩猎点 $2$ 的道路需要消耗 $4$ 体力和 $5$ 时间，在狩猎点 $2$ 进行一次捕猎需要消耗 $2$ 体力和 $3$ 时间。在狩猎点 $1$ 捕获猎物的概率为 $1.00$，即一定会捕捉到猎物，因此 $\\text{Dina}$ 会立即返回巢穴并结束狩猎。在狩猎点 $2$ 捕获猎物的概率为 $0.50$，即有 $50\\%$ 的概率会捕捉到猎物，但由于狩猎点 $2$ 没有其他狩猎点与之直接连通，因此不管在狩猎点 $2$ 是否捕获到猎物，$\\text{Dina}$ 都会选择立即返回巢穴，在返回巢穴时，已经消耗 $10$ 体力，根据题意，不管 $\\text{Dina}$ 是否已经捕捉到了猎物，她都会结束狩猎。由于是随机选择，故在巢穴时选择狩猎点 $1$ 和 $2$ 进行狩猎的概率均为 $50\\%$，根据计算可知，进行一次狩猎所消耗的体力和花费时间的平均值分别为 $7.5=(2+1+2) \\times 50\\%+(4+2+4) \\times 50\\%$ 和 $10.5=(3+2+3) \\times 50\\%+(5+3+5) \\times 50\\%$。\n\n------------\n\n**数据范围**\n\n- Subtask $1$：$n=1$，$10$ 分。\n- Subtask $2$：$1 \\le n \\le 20$，每个狩猎点和其他狩猎点均无直接道路相连，$20$ 分。\n- Subtask $3$：无特殊限制，$70$ 分。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 200$，$1 \\le h_i \\le 10$，$1 \\le t_i \\le 10$，$0 \\le p_i \\le 1$，$1 \\le m \\le \\text{min}(n (n+1) / 2$，$2000$)，$1 \\le h_{u,v} \\le 20$，$1 \\le t_{u,v} \\le 20$，$1 \\le H \\le 200$，$1 \\le T \\le 200$。\n\n------------\n\n**约定**\n\n- 地点 $u$ 和地点 $v$ 之间至多有一条直接连接的双向道路，两个地点之间的直连双向道路不会重复给出。\n- 忽略 $\\text{Dina}$ 进行评估所需要的时间。\n- 在输入中，表示概率 $p_i$ 的数值是一个具有两位小数的实数。", "locale": "zh-CN"}}}
{"pid": "P7592", "type": "P", "difficulty": 7, "samples": [["2 3 6 1 2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2021", "O2优化", "生成函数"], "title": "数树（2021 CoE-II E）", "background": "", "description": "定义一棵树 $\\mathcal T$ 为 $k_1-k_2$ 叉树，当且仅当每个节点 $p\\in \\mathcal T$ 有儿子，要么有 $k_1$ 个儿子，要么有 $k_2$ 个儿子，$k_1 \\ne k_2$。我们定义两棵 $k_1-k_2$ 树同构，当且仅当以下伪代码返回的字符串相同：\n$$\n\\begin{array}{ll}\n1 &  \\textbf{Input. } \\text{The edges of the tree } \\mathcal T  \\\\\n2 &  \\textbf{Output. } \\text{The eigenvalue of tree } \\mathcal T.\\\\\n3 &  \\textbf{Algorithm. }  \\text{dfs}(u)\\\\\n4 &  \\qquad result \\gets \\texttt{'('} \\\\\n5 &  \\qquad \\textbf{for} \\text{ each } (u, v) \\text{ in the  } \\mathcal T \\\\\n6 &  \\qquad \\qquad \\textbf{if }  v \\text{ is not the father of  } u \\\\\n7 &  \\qquad \\qquad\\qquad  result \\gets result\\  +\\ \\mathrm{dfs}(v) \\\\\n8 &  \\qquad result\\gets result\\ +\\ \\texttt{')'} \\\\\n9 & \\qquad \\textbf{return }  result \\\\\n10 & \\textbf{Method. } \\text{check}(\\mathcal T) \\\\\n11 & \\qquad \\textbf{return } \\text{dfs(the root of the tree } \\mathcal T\\text{)}\n\\end{array}\n$$\n\n形式化地，$k_1-k_2$ 叉树有**确定的根节点**，每个节点的若干儿子之间**有顺序**，但是节点**没有标号**。\n\n若 $k_1-k_2$ 叉树 $\\mathcal T$ 有一个 $k_1$ 叉节点，则得分 $a$，若有一个 $k_2$ 叉节点，则得分 $b$，叶节点无得分。定义一棵树的得分为其所有节点的得分之和，记为 $v(\\mathcal T)$。\n\n现在我们在所有互不同构的 $n$ 个节点的 $k_1-k_2$ 叉树中等概率随机生成一棵 $\\mathcal T$，记 $v(\\mathcal T)$ 的期望值为 $\\mathbb{E}(v(\\mathcal T))$。\n\n可以证明 $\\mathbb{E}(v(\\mathcal T))$ 为有理数。当 $\\mathbb{E}(v(\\mathcal T))$ 不为零时，令答案 $\\mathbb{E}(v(\\mathcal T)) = p/q$，其中 $p$ 与 $q$ 互质。你需要输出最小的自然数 $x$ 使得 $p\\equiv qx\\pmod P$，其中 $P=998244353$，可以证明这样的自然数 $x$ 必定存在。", "inputFormat": "输入包含五个整数 $k_1,\\ k_2,\\ n,\\ a,\\ b$，其含义如题目描述所示。", "outputFormat": "输出一个整数 $x$，表示方程 $p\\equiv qx\\pmod P$ 的最小自然数解，其中 $P=998244353$。", "hint": "**样例说明**\n\n具有 $6$ 个结点的不同构 $2-3$ 叉树共有 $5$ 棵，每棵得分均为 $3$ 分，则 $\\mathbb{E}(v(\\mathcal T))=15/5=3$，故 $p=3$ 且 $q=1$，则 $x=3$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nqywy0df.png)\n\n------------\n\n**数据范围**\n\n共 $10$ 个测试点。\n\n对于测试点 $1$，满足 $1 \\le k_1,\\ k_2<n\\leq 10$。\n\n对于测试点 $2$，满足 $1 \\le k_1,\\ k_2<n\\leq 15$。\n\n对于测试点 $3\\sim 4$，满足 $1 \\le k_1,\\ k_2<n\\leq 5 \\times 10^3$。\n\n对于测试点 $5\\sim 6$，满足 $a=b=1,\\ 1 \\le k_1,\\ k_2<n\\leq 10^5$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le k_1,\\ k_2<n\\leq 10^7,\\ k_1 \\ne k_2, \\ k_1+k_2 \\le n, \\  \\ 1 \\le \\ a,\\ b\\leq 10^7$。\n\n\n------------\n\n**约定**\n\n- 测试数据保证 $\\mathbb{E}(v(\\mathcal T))$ 不为零。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "数树（2021 CoE-II E）", "background": "", "description": "定义一棵树 $\\mathcal T$ 为 $k_1-k_2$ 叉树，当且仅当每个节点 $p\\in \\mathcal T$ 有儿子，要么有 $k_1$ 个儿子，要么有 $k_2$ 个儿子，$k_1 \\ne k_2$。我们定义两棵 $k_1-k_2$ 树同构，当且仅当以下伪代码返回的字符串相同：\n$$\n\\begin{array}{ll}\n1 &  \\textbf{Input. } \\text{The edges of the tree } \\mathcal T  \\\\\n2 &  \\textbf{Output. } \\text{The eigenvalue of tree } \\mathcal T.\\\\\n3 &  \\textbf{Algorithm. }  \\text{dfs}(u)\\\\\n4 &  \\qquad result \\gets \\texttt{'('} \\\\\n5 &  \\qquad \\textbf{for} \\text{ each } (u, v) \\text{ in the  } \\mathcal T \\\\\n6 &  \\qquad \\qquad \\textbf{if }  v \\text{ is not the father of  } u \\\\\n7 &  \\qquad \\qquad\\qquad  result \\gets result\\  +\\ \\mathrm{dfs}(v) \\\\\n8 &  \\qquad result\\gets result\\ +\\ \\texttt{')'} \\\\\n9 & \\qquad \\textbf{return }  result \\\\\n10 & \\textbf{Method. } \\text{check}(\\mathcal T) \\\\\n11 & \\qquad \\textbf{return } \\text{dfs(the root of the tree } \\mathcal T\\text{)}\n\\end{array}\n$$\n\n形式化地，$k_1-k_2$ 叉树有**确定的根节点**，每个节点的若干儿子之间**有顺序**，但是节点**没有标号**。\n\n若 $k_1-k_2$ 叉树 $\\mathcal T$ 有一个 $k_1$ 叉节点，则得分 $a$，若有一个 $k_2$ 叉节点，则得分 $b$，叶节点无得分。定义一棵树的得分为其所有节点的得分之和，记为 $v(\\mathcal T)$。\n\n现在我们在所有互不同构的 $n$ 个节点的 $k_1-k_2$ 叉树中等概率随机生成一棵 $\\mathcal T$，记 $v(\\mathcal T)$ 的期望值为 $\\mathbb{E}(v(\\mathcal T))$。\n\n可以证明 $\\mathbb{E}(v(\\mathcal T))$ 为有理数。当 $\\mathbb{E}(v(\\mathcal T))$ 不为零时，令答案 $\\mathbb{E}(v(\\mathcal T)) = p/q$，其中 $p$ 与 $q$ 互质。你需要输出最小的自然数 $x$ 使得 $p\\equiv qx\\pmod P$，其中 $P=998244353$，可以证明这样的自然数 $x$ 必定存在。", "inputFormat": "输入包含五个整数 $k_1,\\ k_2,\\ n,\\ a,\\ b$，其含义如题目描述所示。", "outputFormat": "输出一个整数 $x$，表示方程 $p\\equiv qx\\pmod P$ 的最小自然数解，其中 $P=998244353$。", "hint": "**样例说明**\n\n具有 $6$ 个结点的不同构 $2-3$ 叉树共有 $5$ 棵，每棵得分均为 $3$ 分，则 $\\mathbb{E}(v(\\mathcal T))=15/5=3$，故 $p=3$ 且 $q=1$，则 $x=3$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nqywy0df.png)\n\n------------\n\n**数据范围**\n\n共 $10$ 个测试点。\n\n对于测试点 $1$，满足 $1 \\le k_1,\\ k_2<n\\leq 10$。\n\n对于测试点 $2$，满足 $1 \\le k_1,\\ k_2<n\\leq 15$。\n\n对于测试点 $3\\sim 4$，满足 $1 \\le k_1,\\ k_2<n\\leq 5 \\times 10^3$。\n\n对于测试点 $5\\sim 6$，满足 $a=b=1,\\ 1 \\le k_1,\\ k_2<n\\leq 10^5$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le k_1,\\ k_2<n\\leq 10^7,\\ k_1 \\ne k_2, \\ k_1+k_2 \\le n, \\  \\ 1 \\le \\ a,\\ b\\leq 10^7$。\n\n\n------------\n\n**约定**\n\n- 测试数据保证 $\\mathbb{E}(v(\\mathcal T))$ 不为零。\n", "locale": "zh-CN"}}}
{"pid": "P7593", "type": "P", "difficulty": 1, "samples": [["3\n5 2 10\n5 2 5\n5 2 2", "No\nYes\nNo"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "「EZEC-8」凑数", "background": "", "description": "给定 $1$ 到 $n$ 这 $n$ 个正整数，请问能否恰好选择 $k$ 个数，使选中的数之和为 $s$（每个数只能用 $1$ 次）。", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，一行 $3$ 个正整数 $n,k,s$。", "outputFormat": "对于每组数据：\n\n输出一行，一个字符串，`Yes` 或 `No`，表示是否可以恰好选择 $k$ 个数，使选中的数之和为 $s$。", "hint": "**本题采用捆绑测试。**\n\n-  Subtask 1（15 points）：$n\\le5$。\n-  Subtask 2（15 points）：$n\\le15$。\n-  Subtask 3（20 points）：$n\\le100$。\n-  Subtask 4（15 points）：$k=1$。\n-  Subtask 5（15 points）：$s\\le15$。\n-  Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^3$，$1\\le k\\le n\\le10^9$，$1\\le s\\le10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-8」凑数", "background": "", "description": "给定 $1$ 到 $n$ 这 $n$ 个正整数，请问能否恰好选择 $k$ 个数，使选中的数之和为 $s$（每个数只能用 $1$ 次）。", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，一行 $3$ 个正整数 $n,k,s$。", "outputFormat": "对于每组数据：\n\n输出一行，一个字符串，`Yes` 或 `No`，表示是否可以恰好选择 $k$ 个数，使选中的数之和为 $s$。", "hint": "**本题采用捆绑测试。**\n\n-  Subtask 1（15 points）：$n\\le5$。\n-  Subtask 2（15 points）：$n\\le15$。\n-  Subtask 3（20 points）：$n\\le100$。\n-  Subtask 4（15 points）：$k=1$。\n-  Subtask 5（15 points）：$s\\le15$。\n-  Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^3$，$1\\le k\\le n\\le10^9$，$1\\le s\\le10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P7594", "type": "P", "difficulty": 5, "samples": [["5\n1 4 3 4 1\n", "5\n"], ["8\n1 2 1 0 0 1 2 1\n", "4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "「EZEC-8」Clean Up", "background": "", "description": "有一个宽度为 $n$ 的区间，第 $i$ 个位置上如俄罗斯方块一样堆着 $a_i$ 个方块。\n\n你可以选择任何一个位置，花费 $k$ 点能量清除这个位置上的至多 $k$ 个方块，同时在与选定位置相距为 $d$ 的位置清除至多 $\\max(k-d,0)$ 个方块，相邻两个位置的距离为 $1$。请注意，**$k$ 必须是正整数。**\n\n请问最少要多少能量才能清空整个区间的所有方块。", "inputFormat": "输入共两行。\n\n第一行，输入一个整数 $n$。\n\n第二行，输入 $n$ 个整数，第 $i$ 个数为 $a_i$。", "outputFormat": "输出一行，一个数，表示所需的能量最小值。", "hint": "**样例解释**\n\n对于第一组样例，一种最佳方案是选择位置 $3$ 花费 $5$ 点能量。\n\n对于第二组样例，一种最佳方案是选择位置 $2$ 花费 $2$ 点能量，再选择位置 $7$ 花费 $2$ 点能量。\n\n-------\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：$n \\leq 2$。\n- Subtask 2（20 points）：$n \\leq 10^3$，$a_i \\neq 0$。\n- Subtask 3（20 points）：$a_i \\neq 0$。\n- Subtask 4（20 points）：$n \\leq 10^3$。\n- Subtask 5（35 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n \\leq 10^6$，$0 \\leq a_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-8」Clean Up", "background": "", "description": "有一个宽度为 $n$ 的区间，第 $i$ 个位置上如俄罗斯方块一样堆着 $a_i$ 个方块。\n\n你可以选择任何一个位置，花费 $k$ 点能量清除这个位置上的至多 $k$ 个方块，同时在与选定位置相距为 $d$ 的位置清除至多 $\\max(k-d,0)$ 个方块，相邻两个位置的距离为 $1$。请注意，**$k$ 必须是正整数。**\n\n请问最少要多少能量才能清空整个区间的所有方块。", "inputFormat": "输入共两行。\n\n第一行，输入一个整数 $n$。\n\n第二行，输入 $n$ 个整数，第 $i$ 个数为 $a_i$。", "outputFormat": "输出一行，一个数，表示所需的能量最小值。", "hint": "**样例解释**\n\n对于第一组样例，一种最佳方案是选择位置 $3$ 花费 $5$ 点能量。\n\n对于第二组样例，一种最佳方案是选择位置 $2$ 花费 $2$ 点能量，再选择位置 $7$ 花费 $2$ 点能量。\n\n-------\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：$n \\leq 2$。\n- Subtask 2（20 points）：$n \\leq 10^3$，$a_i \\neq 0$。\n- Subtask 3（20 points）：$a_i \\neq 0$。\n- Subtask 4（20 points）：$n \\leq 10^3$。\n- Subtask 5（35 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n \\leq 10^6$，$0 \\leq a_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7595", "type": "P", "difficulty": 5, "samples": [["5\n\n1\n\n5 1 5 2 4 3\n\n3 4 2 5\n\n1 3", "\n? 1 1 2\n\n? 2 1\n\n? 2 2\n\n? 2 3\n\n! 1 1 2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["交互题", "Special Judge", "O2优化"], "title": "「EZEC-8」猜树", "background": "这是一道交互题。", "description": "有一棵以 $1$ 为根的 $n$ 个点的有根树，您需要通过若干次询问得到这棵树的结构。\n\n您可以使用两种询问：\n\n1. `? 1 u v` 通过这种询问，您可以获得 $u$ 和 $v$ 之间的距离。\n2. `? 2 u` 通过这种询问，您可以获得 $u$ 子树的大小和 $u$ 子树中的所有节点。\n\n请通过使交互库输出不超过 $10^5$ 个数，得到这棵树的结构。\n\n### 交互方式\n\n输入树的大小 $n$ 以开始交互。\n\n交互过程中，您可以进行题目描述中的两种询问。\n\n对于第一种询问，交互库将会返回一个非负整数，表示 $u$ 节点和 $v$ 节点间的距离。\n\n对于第二种询问，交互库将会先返回一个正整数 $num$，表示 $u$ 子树的大小。接下来会在同一行中返回 $num$ 个正整数，表示 $u$ 子树中的所有节点（节点顺序会被打乱）。\n\n在您确定答案后，请以 `! fa[2] fa[3] ... fa[n]` 的形式输出一行，停止交互。其中 $fa[i]$ 表示这棵树中 $i$ 号节点的父节点。\n\n在您输出一行后，请清空缓冲区：\n\n- 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n- 在 Pascal 中，使用 `flush(output)`。\n- 在 Python 中，使用 `stdout.flush()`。\n- 其它语言请自行查阅文档。", "inputFormat": "见「交互方式」。", "outputFormat": "见「交互方式」。", "hint": "**本题采用捆绑测试。**\n\n-  Subtask 1（5 points）：$n \\leq 5$。\n-  Subtask 2（15 points）：$n \\leq 100$。\n-  Subtask 3（20 points）：$n \\leq 500$。\n-  Subtask 4（15 points）：树是一条链。\n-  Subtask 5（15 points）：树是一棵完全二叉树。\n-  Subtask 6（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$2 \\leq n \\leq 2000$，$1\\le u,v \\le n$。\n\n**注意：询问不合法或交互库输出数超过 $10^5$ 后继续询问可能导致 TLE。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-8」猜树", "background": "这是一道交互题。", "description": "有一棵以 $1$ 为根的 $n$ 个点的有根树，您需要通过若干次询问得到这棵树的结构。\n\n您可以使用两种询问：\n\n1. `? 1 u v` 通过这种询问，您可以获得 $u$ 和 $v$ 之间的距离。\n2. `? 2 u` 通过这种询问，您可以获得 $u$ 子树的大小和 $u$ 子树中的所有节点。\n\n请通过使交互库输出不超过 $10^5$ 个数，得到这棵树的结构。\n\n### 交互方式\n\n输入树的大小 $n$ 以开始交互。\n\n交互过程中，您可以进行题目描述中的两种询问。\n\n对于第一种询问，交互库将会返回一个非负整数，表示 $u$ 节点和 $v$ 节点间的距离。\n\n对于第二种询问，交互库将会先返回一个正整数 $num$，表示 $u$ 子树的大小。接下来会在同一行中返回 $num$ 个正整数，表示 $u$ 子树中的所有节点（节点顺序会被打乱）。\n\n在您确定答案后，请以 `! fa[2] fa[3] ... fa[n]` 的形式输出一行，停止交互。其中 $fa[i]$ 表示这棵树中 $i$ 号节点的父节点。\n\n在您输出一行后，请清空缓冲区：\n\n- 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n- 在 Pascal 中，使用 `flush(output)`。\n- 在 Python 中，使用 `stdout.flush()`。\n- 其它语言请自行查阅文档。", "inputFormat": "见「交互方式」。", "outputFormat": "见「交互方式」。", "hint": "**本题采用捆绑测试。**\n\n-  Subtask 1（5 points）：$n \\leq 5$。\n-  Subtask 2（15 points）：$n \\leq 100$。\n-  Subtask 3（20 points）：$n \\leq 500$。\n-  Subtask 4（15 points）：树是一条链。\n-  Subtask 5（15 points）：树是一棵完全二叉树。\n-  Subtask 6（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$2 \\leq n \\leq 2000$，$1\\le u,v \\le n$。\n\n**注意：询问不合法或交互库输出数超过 $10^5$ 后继续询问可能导致 TLE。**", "locale": "zh-CN"}}}
{"pid": "P7596", "type": "P", "difficulty": 6, "samples": [["10 10\n1 10 6 2 2 5 10 8 9 5\n1 3 5 7\n2 3 5 6\n3 6 9 10\n1 4 5 10\n1 2 4 7\n1 2 4 9\n3 5 7 8\n4 7 8 9\n2 3 4 8\n1 5 6 7", "A\nA\nA\nB\nA\nA\nB\nA\nA\nB"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "「EZEC-8」游戏蛇", "background": "", "description": "小 A 和小 B 是两条蛇，他们正在一棵特殊的树上做游戏。\n\n这棵树的结构如下：首先有一条长度为 $n$ 的链，称为“主链”。主链由 $1$ 至 $n$ 这 $n$ 个节点构成。在主链上，编号相邻的点有边相连，否则则没有。\n\n主链上的每一个点都挂着一条链，称为“副链”。主链上的第 $i$ 个点挂的副链长度（链上的点数）为 $x_i$。\n\n小 A 和小 B 初始时都在主链上，具体而言，小 A 的**蛇尾**在点 $a$，**蛇头**在点 $b$，小 B 的**蛇头**在点 $c$，**蛇尾**在点 $d$。满足 $1\\le a<b<c<d\\le n$。\n\n他们的游戏规则如下：\n- 小 A 和小 B 轮流移动，小 A 先手。\n- 每条蛇移动时，他会尝试整体向某一方向移动一个节点，**但不能向原来蛇尾方向移动，也就是蛇不能倒退**。需满足移动后蛇头不得与另外一条蛇的任意部分重合。\n- 当一条蛇无法移动时，游戏结束，对手获胜。\n\n现在有 $q$ 次询问，每次询问给定 $a,b,c,d$，请求出当两条蛇都采取最优策略时，哪一条蛇会获胜。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个正整数，表示 $x_i$。\n\n接下来 $q$ 行，每行四个正整数表示此次询问的 $a,b,c,d$。", "outputFormat": "输出共 $q$ 行。\n\n对于每组询问，输出 `A` 或 `B`，表示最终能获胜的蛇。", "hint": "**本题采用捆绑测试。**\n\n-  Subtask 1（10 points）：$n,q \\le500$。\n-  Subtask 2（10 points）：$n\\le10^5$，$q\\le500$。\n-  Subtask 3（5 points）：所有 $x_i$ 都相等。\n-  Subtask 4（10 points）：所有询问中小 A 和小 B 的长度总和不超过 $5\\times10^7$。\n-  Subtask 5（15 points）：$x_i$ 在 $[1,10^9]$ 内随机生成。\n-  Subtask 6（20 points）：$n\\le5\\times10^3$。\n-  Subtask 7（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n,q\\le5\\times10^5$，$1\\le x_i\\le10^9$，$1\\le a<b<c<d\\le n$。\n\n小 A 的长度定义为 $b-a+1$，小 B 的长度定义为 $d-c+1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-8」游戏蛇", "background": "", "description": "小 A 和小 B 是两条蛇，他们正在一棵特殊的树上做游戏。\n\n这棵树的结构如下：首先有一条长度为 $n$ 的链，称为“主链”。主链由 $1$ 至 $n$ 这 $n$ 个节点构成。在主链上，编号相邻的点有边相连，否则则没有。\n\n主链上的每一个点都挂着一条链，称为“副链”。主链上的第 $i$ 个点挂的副链长度（链上的点数）为 $x_i$。\n\n小 A 和小 B 初始时都在主链上，具体而言，小 A 的**蛇尾**在点 $a$，**蛇头**在点 $b$，小 B 的**蛇头**在点 $c$，**蛇尾**在点 $d$。满足 $1\\le a<b<c<d\\le n$。\n\n他们的游戏规则如下：\n- 小 A 和小 B 轮流移动，小 A 先手。\n- 每条蛇移动时，他会尝试整体向某一方向移动一个节点，**但不能向原来蛇尾方向移动，也就是蛇不能倒退**。需满足移动后蛇头不得与另外一条蛇的任意部分重合。\n- 当一条蛇无法移动时，游戏结束，对手获胜。\n\n现在有 $q$ 次询问，每次询问给定 $a,b,c,d$，请求出当两条蛇都采取最优策略时，哪一条蛇会获胜。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个正整数，表示 $x_i$。\n\n接下来 $q$ 行，每行四个正整数表示此次询问的 $a,b,c,d$。", "outputFormat": "输出共 $q$ 行。\n\n对于每组询问，输出 `A` 或 `B`，表示最终能获胜的蛇。", "hint": "**本题采用捆绑测试。**\n\n-  Subtask 1（10 points）：$n,q \\le500$。\n-  Subtask 2（10 points）：$n\\le10^5$，$q\\le500$。\n-  Subtask 3（5 points）：所有 $x_i$ 都相等。\n-  Subtask 4（10 points）：所有询问中小 A 和小 B 的长度总和不超过 $5\\times10^7$。\n-  Subtask 5（15 points）：$x_i$ 在 $[1,10^9]$ 内随机生成。\n-  Subtask 6（20 points）：$n\\le5\\times10^3$。\n-  Subtask 7（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n,q\\le5\\times10^5$，$1\\le x_i\\le10^9$，$1\\le a<b<c<d\\le n$。\n\n小 A 的长度定义为 $b-a+1$，小 B 的长度定义为 $d-c+1$。", "locale": "zh-CN"}}}
{"pid": "P7597", "type": "P", "difficulty": 6, "samples": [["5\n\n1\n\n5 1 5 2 4 3\n\n3 4 2 5\n\n1 3", "\n? 1 1 2\n\n? 2 1\n\n? 2 2\n\n? 2 3\n\n! 1 1 2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["交互题", "Special Judge", "O2优化"], "title": "「EZEC-8」猜树 加强版", "background": "这是一道交互题。", "description": "有一棵以 $1$ 为根的 $n$ 个点的有根树，您需要通过若干次询问得到这棵树的结构。\n\n您可以使用两种询问：\n\n1. `? 1 u v` 通过这种询问，您可以获得 $u$ 和 $v$ 之间的距离。\n2. `? 2 u` 通过这种询问，您可以获得 $u$ 子树的大小和 $u$ 子树中的所有节点。\n\n请通过使交互库输出不超过 $40000$ 个数，得到这棵树的结构。\n\n### 交互方式\n\n输入树的大小 $n$ 以开始交互。\n\n交互过程中，您可以进行题目描述中的两种询问。\n\n对于第一种询问，交互库将会返回一个非负整数，表示 $u$ 节点和 $v$ 节点间的距离。\n\n对于第二种询问，交互库将会先返回一个正整数 $num$，表示 $u$ 子树的大小。接下来会在同一行中返回 $num$ 个正整数，表示 $u$ 子树中的所有节点（节点顺序会被打乱）。\n\n在您确定答案后，请以 `! fa[2] fa[3] ... fa[n]` 的形式输出一行，停止交互。其中 $fa[i]$ 表示这棵树中 $i$ 号节点的父节点。\n\n在您输出一行后，请清空缓冲区：\n\n- 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n- 在 Pascal 中，使用 `flush(output)`。\n- 在 Python 中，使用 `stdout.flush()`。\n- 其它语言请自行查阅文档。", "inputFormat": "见「交互方式」。", "outputFormat": "见「交互方式」。", "hint": "对于 $100\\%$ 的数据：$2 \\leq n \\leq 5000$，$1\\le u,v\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-8」猜树 加强版", "background": "这是一道交互题。", "description": "有一棵以 $1$ 为根的 $n$ 个点的有根树，您需要通过若干次询问得到这棵树的结构。\n\n您可以使用两种询问：\n\n1. `? 1 u v` 通过这种询问，您可以获得 $u$ 和 $v$ 之间的距离。\n2. `? 2 u` 通过这种询问，您可以获得 $u$ 子树的大小和 $u$ 子树中的所有节点。\n\n请通过使交互库输出不超过 $40000$ 个数，得到这棵树的结构。\n\n### 交互方式\n\n输入树的大小 $n$ 以开始交互。\n\n交互过程中，您可以进行题目描述中的两种询问。\n\n对于第一种询问，交互库将会返回一个非负整数，表示 $u$ 节点和 $v$ 节点间的距离。\n\n对于第二种询问，交互库将会先返回一个正整数 $num$，表示 $u$ 子树的大小。接下来会在同一行中返回 $num$ 个正整数，表示 $u$ 子树中的所有节点（节点顺序会被打乱）。\n\n在您确定答案后，请以 `! fa[2] fa[3] ... fa[n]` 的形式输出一行，停止交互。其中 $fa[i]$ 表示这棵树中 $i$ 号节点的父节点。\n\n在您输出一行后，请清空缓冲区：\n\n- 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n- 在 Pascal 中，使用 `flush(output)`。\n- 在 Python 中，使用 `stdout.flush()`。\n- 其它语言请自行查阅文档。", "inputFormat": "见「交互方式」。", "outputFormat": "见「交互方式」。", "hint": "对于 $100\\%$ 的数据：$2 \\leq n \\leq 5000$，$1\\le u,v\\le n$。", "locale": "zh-CN"}}}
{"pid": "P7598", "type": "P", "difficulty": 7, "samples": [["17 2 3\n1 1\n2 2\n3 2\n4 1\n5 1\n4 1\n3 1\n2 2\n1 3\n6 2\n2 3\n3 1\n4 6\n5 3\n6 3\n6 2\n1 1", "1003"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "APIO", "交互题", "Special Judge", "O2优化"], "title": "[APIO2021] 六边形领域", "background": "本题只支持 C++ 提交，提交时不需要包含 `hexagon.h` 头文件，只需要将附件中的 `hexagon.h` 中的内容粘贴到代码的开头即可。", "description": "对于一个用六边形无限平铺的平面，Pak Dengklek 站在其中一个格子上，并称该格子为初始格子。如果六边形平铺中的两个格子有公共边，则称它们是相邻的格子。对于一步移动，Pak Dengklek 可以从一个格子向六个可能的方向（从 $1$ 到 $6$ 编号，如下图所示）移动到与其相邻的格子上。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cojdvvvr.png)\n\n对于某个由 $N$ 次行动构成的行动序列，Pak Dengklek 可以用其产生的路径（对应一个按序访问的格子序\n列）构造一个领域。其中第 $i$ 次行动由移动方向 $D[i]$ 和在该方向上的移动步数 $L[i]$ 组成，并且该路径应有如下性质：\n\n- 路径是 _封闭_ 的，这意味着在格子序列中，起点格子与终点格子（即初始格子）相同。\n- 路径是 _简单_ 的，这意味着在格子序列中，除了初始格子访问过恰好两次（起点和终点分别访问一\n次），其他格子只能被访问至多一次。\n- 路径是 _暴露_ 的，这意味着在格子序列中，每个格子与至少一个不在序列中出现过的非 _内部格子_ 相邻。\n    - 如果一个格子不在格子序列中出现过，并且从它出发，在不经过格子序列中任何格子的情况下，（通过若干步移动） 只能访问到有限个格子，我们就称该格子是 _内部格子_ 。\n\n下图是一个符合上述条件的路径例子。其中：\n\n- $1$ 号格子（粉色）是初始格子。\n- 被编号的格子（淡蓝色）组成格子序列，编号代表它被访问的顺序。\n- 被标上叉号的格子（深蓝色）是 _内部格子_。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/znccjlim.png)\n\n构造出的领域只包含所有路径上的格子和内部格子。领域中格子 $c$ 的距离定义为：在只经过领域中包含格子的情况下，从初始格子出发到达 $c$ 所需要的最少移动步数。领域中一个格子的分数定义为 $A+d \\times B$，其中 $A$ 和 $B$ 是 Pak Dengklek 给定的常数，$d$ 是该格子在领域中的距离。下图给出了用上示路径构成的领域中每个格子的距离。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/u9gjh0n6.png)\n\n请帮助 Pak Dengklek 计算，用给出的行动序列构成的领域中，所有格子的分数之和。由于总分数值可能很大，最终结果对 ${10}^9+7$ 取模。\n\n你需要实现下列函数：\n\n`int draw_territory(int N, int A, int B, int[] D, int[] L)`\n\n- $N$：行动序列中行动的次数。\n- $A,B$：分数计算中的常数。\n- $D$：大小为 $N$ 的数组，其中 $D[i]$ 表示第 $i$ 次行动的方向。\n- $L$：大小为 $N$ 的数组，其中 $L[i]$ 表示第 $i$ 次行动的移动步数。\n- 函数应该返回用给出的行动序列所构成的领域中，所有格子的分数总和对 ${10}^9+7$ 取模后的值。\n- 该函数将被调用恰好一次。", "inputFormat": "示例测试程序按如下格式读取输入数据：\n\n- 第 $1$ 行：$N$ $A$ $B$\n- 第 $2+i$（$0 \\le i \\le N-1$）行：$D[i]$ $L[i]$", "outputFormat": "示例测试程序按如下格式输出你的答案：\n\n- 第 $1$ 行：`draw_territory` 的返回值。", "hint": "**【样例解释】**\n\n考虑下列调用：\n\n```plain\ndraw_territory(17, 2, 3,\n\t\t\t   [1, 2, 3, 4, 5, 4, 3, 2, 1, 6, 2, 3, 4, 5, 6, 6, 1],\n\t\t\t   [1, 2, 2, 1, 1, 1, 1, 2, 3, 2, 3, 1, 6, 3, 3, 2, 1])\n```\n\n该行动序列和上述题面中给出的例子相同。下表列出了该领域中所有可能的距离值所对应的分数。\n\n| 距离值 | 格子数 | 每个格子分数 | 总分数 |\n|:-:|:-:|:-:|:-:|\n|$0$|$1$|$2+0 \\times 3=2$|$1 \\times 2=2$|\n|$1$|$4$|$2+1 \\times 3=5$|$4 \\times 5=20$|\n|$2$|$5$|$2+2 \\times 3=8$|$5 \\times 8=40$|\n|$3$|$6$|$2+3 \\times 3=11$|$6 \\times 11=66$|\n|$4$|$4$|$2+4 \\times 3=14$|$4 \\times 14=56$|\n|$5$|$3$|$2+5 \\times 3=17$|$3 \\times 17=51$|\n|$6$|$4$|$2+6 \\times 3=20$|$4 \\times 20=80$|\n|$7$|$4$|$2+7 \\times 3=23$|$4 \\times 23=92$|\n|$8$|$5$|$2+8 \\times 3=26$|$5 \\times 26=130$|\n|$9$|$3$|$2+9 \\times 3=29$|$3 \\times 29=87$|\n|$10$|$4$|$2+10 \\times 3=32$|$4 \\times 32=128$|\n|$11$|$5$|$2+11 \\times 3=35$|$5 \\times 35=175$|\n|$12$|$2$|$2+12 \\times 3=38$|$2 \\times 38=76$|\n\n总分数值为 $2+20+40+66+56+51+80+92+130+87+128+175+76=1003$。\n\n因此，`draw_territory` 应该返回 $1003$。\n\n**【数据范围】**\n\n- $3 \\le N \\le 2\\times {10}^5$。\n- $0 \\le A,B \\le {10}^9$。\n- $1 \\le D[i] \\le 6$（$0 \\le i \\le N-1$）。\n- $1 \\le L[i]$（$0 \\le i \\le N-1$）。\n- $L$ 中的元素之和不超过 ${10}^9$。\n- 给出的行动序列所对应的路径一定是 _封闭_、_简单_ 和 _暴露_ 的。\n\n**【子任务】**\n\n1. （3 分）：$N=3$，$B=0$。\n2. （6 分）：$N=3$。\n3. （11 分）：$L$ 中的元素之和不超过 $2000$。\n4. （12 分）：$B=0$，$L$ 中的元素之和不超过 $2\\times {10}^5$。\n5. （15 分）：$B=0$。\n6. （19 分）：$L$ 中的元素之和不超过 $2\\times {10}^5$。\n7. （18 分）：$L[i]=L[i+1]$（$0 \\le i \\le N-2$）。\n8. （16 分）：无附加限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[APIO2021] 六边形领域", "background": "本题只支持 C++ 提交，提交时不需要包含 `hexagon.h` 头文件，只需要将附件中的 `hexagon.h` 中的内容粘贴到代码的开头即可。", "description": "对于一个用六边形无限平铺的平面，Pak Dengklek 站在其中一个格子上，并称该格子为初始格子。如果六边形平铺中的两个格子有公共边，则称它们是相邻的格子。对于一步移动，Pak Dengklek 可以从一个格子向六个可能的方向（从 $1$ 到 $6$ 编号，如下图所示）移动到与其相邻的格子上。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cojdvvvr.png)\n\n对于某个由 $N$ 次行动构成的行动序列，Pak Dengklek 可以用其产生的路径（对应一个按序访问的格子序\n列）构造一个领域。其中第 $i$ 次行动由移动方向 $D[i]$ 和在该方向上的移动步数 $L[i]$ 组成，并且该路径应有如下性质：\n\n- 路径是 _封闭_ 的，这意味着在格子序列中，起点格子与终点格子（即初始格子）相同。\n- 路径是 _简单_ 的，这意味着在格子序列中，除了初始格子访问过恰好两次（起点和终点分别访问一\n次），其他格子只能被访问至多一次。\n- 路径是 _暴露_ 的，这意味着在格子序列中，每个格子与至少一个不在序列中出现过的非 _内部格子_ 相邻。\n    - 如果一个格子不在格子序列中出现过，并且从它出发，在不经过格子序列中任何格子的情况下，（通过若干步移动） 只能访问到有限个格子，我们就称该格子是 _内部格子_ 。\n\n下图是一个符合上述条件的路径例子。其中：\n\n- $1$ 号格子（粉色）是初始格子。\n- 被编号的格子（淡蓝色）组成格子序列，编号代表它被访问的顺序。\n- 被标上叉号的格子（深蓝色）是 _内部格子_。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/znccjlim.png)\n\n构造出的领域只包含所有路径上的格子和内部格子。领域中格子 $c$ 的距离定义为：在只经过领域中包含格子的情况下，从初始格子出发到达 $c$ 所需要的最少移动步数。领域中一个格子的分数定义为 $A+d \\times B$，其中 $A$ 和 $B$ 是 Pak Dengklek 给定的常数，$d$ 是该格子在领域中的距离。下图给出了用上示路径构成的领域中每个格子的距离。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/u9gjh0n6.png)\n\n请帮助 Pak Dengklek 计算，用给出的行动序列构成的领域中，所有格子的分数之和。由于总分数值可能很大，最终结果对 ${10}^9+7$ 取模。\n\n你需要实现下列函数：\n\n`int draw_territory(int N, int A, int B, int[] D, int[] L)`\n\n- $N$：行动序列中行动的次数。\n- $A,B$：分数计算中的常数。\n- $D$：大小为 $N$ 的数组，其中 $D[i]$ 表示第 $i$ 次行动的方向。\n- $L$：大小为 $N$ 的数组，其中 $L[i]$ 表示第 $i$ 次行动的移动步数。\n- 函数应该返回用给出的行动序列所构成的领域中，所有格子的分数总和对 ${10}^9+7$ 取模后的值。\n- 该函数将被调用恰好一次。", "inputFormat": "示例测试程序按如下格式读取输入数据：\n\n- 第 $1$ 行：$N$ $A$ $B$\n- 第 $2+i$（$0 \\le i \\le N-1$）行：$D[i]$ $L[i]$", "outputFormat": "示例测试程序按如下格式输出你的答案：\n\n- 第 $1$ 行：`draw_territory` 的返回值。", "hint": "**【样例解释】**\n\n考虑下列调用：\n\n```plain\ndraw_territory(17, 2, 3,\n\t\t\t   [1, 2, 3, 4, 5, 4, 3, 2, 1, 6, 2, 3, 4, 5, 6, 6, 1],\n\t\t\t   [1, 2, 2, 1, 1, 1, 1, 2, 3, 2, 3, 1, 6, 3, 3, 2, 1])\n```\n\n该行动序列和上述题面中给出的例子相同。下表列出了该领域中所有可能的距离值所对应的分数。\n\n| 距离值 | 格子数 | 每个格子分数 | 总分数 |\n|:-:|:-:|:-:|:-:|\n|$0$|$1$|$2+0 \\times 3=2$|$1 \\times 2=2$|\n|$1$|$4$|$2+1 \\times 3=5$|$4 \\times 5=20$|\n|$2$|$5$|$2+2 \\times 3=8$|$5 \\times 8=40$|\n|$3$|$6$|$2+3 \\times 3=11$|$6 \\times 11=66$|\n|$4$|$4$|$2+4 \\times 3=14$|$4 \\times 14=56$|\n|$5$|$3$|$2+5 \\times 3=17$|$3 \\times 17=51$|\n|$6$|$4$|$2+6 \\times 3=20$|$4 \\times 20=80$|\n|$7$|$4$|$2+7 \\times 3=23$|$4 \\times 23=92$|\n|$8$|$5$|$2+8 \\times 3=26$|$5 \\times 26=130$|\n|$9$|$3$|$2+9 \\times 3=29$|$3 \\times 29=87$|\n|$10$|$4$|$2+10 \\times 3=32$|$4 \\times 32=128$|\n|$11$|$5$|$2+11 \\times 3=35$|$5 \\times 35=175$|\n|$12$|$2$|$2+12 \\times 3=38$|$2 \\times 38=76$|\n\n总分数值为 $2+20+40+66+56+51+80+92+130+87+128+175+76=1003$。\n\n因此，`draw_territory` 应该返回 $1003$。\n\n**【数据范围】**\n\n- $3 \\le N \\le 2\\times {10}^5$。\n- $0 \\le A,B \\le {10}^9$。\n- $1 \\le D[i] \\le 6$（$0 \\le i \\le N-1$）。\n- $1 \\le L[i]$（$0 \\le i \\le N-1$）。\n- $L$ 中的元素之和不超过 ${10}^9$。\n- 给出的行动序列所对应的路径一定是 _封闭_、_简单_ 和 _暴露_ 的。\n\n**【子任务】**\n\n1. （3 分）：$N=3$，$B=0$。\n2. （6 分）：$N=3$。\n3. （11 分）：$L$ 中的元素之和不超过 $2000$。\n4. （12 分）：$B=0$，$L$ 中的元素之和不超过 $2\\times {10}^5$。\n5. （15 分）：$B=0$。\n6. （19 分）：$L$ 中的元素之和不超过 $2\\times {10}^5$。\n7. （18 分）：$L[i]=L[i+1]$（$0 \\le i \\le N-2$）。\n8. （16 分）：无附加限制。", "locale": "zh-CN"}}}
{"pid": "P7599", "type": "P", "difficulty": 6, "samples": [["7 3\n3 2 1 6 4 5 7\n4 4 6 6\n1 3 5 6\n0 1 2 2\n", "2\n1\n-1\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "APIO", "交互题", "Special Judge", "O2优化"], "title": "[APIO2021] 雨林跳跃", "background": "本题只支持 C++ 提交，不支持 C++14 (GCC 9)，提交时不需要包含 jumps.h 头文件，只需要将附件中的 jumps.h 中的内容粘贴到代码的开头即可。", "description": "在苏门答腊岛的热带雨林中，有 $N$ 棵树排成一排，从左到右依次用 $0$ 到 $N-1$ 进行编号，其中 $i$ 号树的高度为 $H[i]$，且所有树的高度**互不相同**。\n\nPak Dengklek 正在训练一只猩猩，让她能够从一棵树上跳到另一棵树上。对于一次跳跃，猩猩可以从一棵树，向左或向右跳到比当前这棵树高的第一棵树上。形式化地，如果猩猩当前在 $x$ 号树，那么当且仅当满足下列条件之一时，她能够跳到 $y$ 号树上：\n\n- $y$ 是满足 $H[z]>H[x]$ 的所有 $z$ 中比 $x$ 小的最大非负整数；或者：\n- $y$ 是满足 $H[z]>H[x]$ 的所有 $z$ 中比 $x$ 大的最小非负整数。\n\nPak Dengklek 有 $Q$ 个跳跃计划，每个计划用四个整数 $A$，$B$，$C$ 和 $D$（$A \\le B<C \\le D$）来描述。对于每个计划，Pak Dengklek 想知道猩猩是否能够从某棵树 $s$（$A \\le s \\le B$）出发，经过若干次跳跃，到达某棵树 $e$（$C \\le e \\le D$）。若该计划可行，Pak Dengklek 还想知道可行方案中猩猩需要的最少跳跃次数。\n\n你需要实现下列函数：\n\n`void init(int N, int[] H)`\n\n- $N$：树的数量。\n- $H$：大小为 $N$ 的数组，$H[i]$ 表示 $i$ 号树的高度。\n- 该函数在第一次 `minimum_jumps` 的调用前，将会被调用恰好一次。\n\n`int minimum_jumps(int A, int B, int C, int D)`\n\n- $A,B$：可以用作起点的树的编号范围。\n- $C,D$：可以用作终点的树的编号范围。\n- 该函数需要返回可行方案中猩猩需要的最少跳跃次数，或者返回 $-1$ 表示该计划不可行。\n- 该函数将被调用恰好 $Q$ 次。", "inputFormat": "示例测试程序按如下格式读取输入数据：\n\n- 第 $1$ 行：$N$ $Q$\n- 第 $2$ 行：$H[0]$ $H[1]$ $\\cdots$ $H[N-1]$\n- 第 $3+i$（$0 \\le i \\le Q-1$）行：$A$ $B$ $C$ $D$，表示第 $i$ 次 `minimum_jumps` 调用的参数。", "outputFormat": "示例测试程序按如下格式输出你的答案：\n\n- 第 $1+i$（$0 \\le i \\le Q-1$）行：第 $i$ 次 `minimum_jumps` 调用的返回值。", "hint": "**【样例解释】**\n\n考虑如下调用： \n\n`init(7, [3, 2, 1, 6, 4, 5, 7])`\n\n在初始化完成后，考虑如下调用：\n\n`minimum_jumps(4, 4, 6, 6)`\n\n该计划意味着猩猩必须从 $4$ 号树（高度为 $4$）出发，并到达 $6$ 号树（高度为 $7$）。\n\n一种跳跃次数最少的可行方案为：先跳到 $3$ 号树（高度为 $6$），再跳到 $6$ 号树。\n\n另一种方案为：先跳到 $5$ 号树（高度为 $5$），再跳到 $6$ 号树。\n\n因此，`minimum_jumps` 应该返回 $2$。\n\n考虑另一个调用：\n\n`minimum_jumps(1, 3, 5, 6)`\n\n该计划意味着猩猩必须从 $1$ 号树（高度为 $2$），$2$ 号树（高度为 $1$），或 $3$ 号树（高度为 $6$）之一出发，并最终到达 $5$ 号树（高度为 $5$）或者 $6$ 号树（高度为 $7$）。\n\n唯一一种跳跃次数最少的可行方案为：从 $3$ 号树出发，直接跳到 $6$ 号树。\n\n因此，`minimum_jumps` 应该返回 $1$。\n\n考虑另一个调用：\n\n`minimum jumps(0, 1, 2, 2)`\n\n该计划意味着猩猩必须从 $0$ 号树（高度为 $3$）或者 $1$ 号树（高度为 $2$）出发，并最终到达 $2$ 号树（高度为 $1$）。\n\n由于 $2$ 号树是高度最低的树，所以无法从其他树上跳到 $2$ 号树。\n\n因此，`minimum_jumps` 应该返回 $-1$。\n\n**【数据范围】**\n\n- $2 \\le N \\le 2 \\times {10}^5$。\n- $1 \\le Q \\le {10}^5$。\n- $1 \\le H[i] \\le N$（$0 \\le i \\le N - 1$）。\n- $H[i]\\ne H[j]$（$0 \\le i<j \\le N - 1$）。\n- $0 \\le A \\le B<C \\le D \\le N - 1$。\n\n**【子任务】**\n\n1. （4 分）：$H[i]=i+1$（$0 \\le i \\le N-1$）。\n2. （8 分）：$N,Q \\le 200$。\n3. （13 分）：$N,Q \\le 2000$。\n4. （12 分）：$Q \\le 5$。\n5. （23 分）：$A=B$，$C=D$。\n6. （21 分）：$C=D$。\n7. （19 分）：无附加限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[APIO2021] 雨林跳跃", "background": "本题只支持 C++ 提交，不支持 C++14 (GCC 9)，提交时不需要包含 jumps.h 头文件，只需要将附件中的 jumps.h 中的内容粘贴到代码的开头即可。", "description": "在苏门答腊岛的热带雨林中，有 $N$ 棵树排成一排，从左到右依次用 $0$ 到 $N-1$ 进行编号，其中 $i$ 号树的高度为 $H[i]$，且所有树的高度**互不相同**。\n\nPak Dengklek 正在训练一只猩猩，让她能够从一棵树上跳到另一棵树上。对于一次跳跃，猩猩可以从一棵树，向左或向右跳到比当前这棵树高的第一棵树上。形式化地，如果猩猩当前在 $x$ 号树，那么当且仅当满足下列条件之一时，她能够跳到 $y$ 号树上：\n\n- $y$ 是满足 $H[z]>H[x]$ 的所有 $z$ 中比 $x$ 小的最大非负整数；或者：\n- $y$ 是满足 $H[z]>H[x]$ 的所有 $z$ 中比 $x$ 大的最小非负整数。\n\nPak Dengklek 有 $Q$ 个跳跃计划，每个计划用四个整数 $A$，$B$，$C$ 和 $D$（$A \\le B<C \\le D$）来描述。对于每个计划，Pak Dengklek 想知道猩猩是否能够从某棵树 $s$（$A \\le s \\le B$）出发，经过若干次跳跃，到达某棵树 $e$（$C \\le e \\le D$）。若该计划可行，Pak Dengklek 还想知道可行方案中猩猩需要的最少跳跃次数。\n\n你需要实现下列函数：\n\n`void init(int N, int[] H)`\n\n- $N$：树的数量。\n- $H$：大小为 $N$ 的数组，$H[i]$ 表示 $i$ 号树的高度。\n- 该函数在第一次 `minimum_jumps` 的调用前，将会被调用恰好一次。\n\n`int minimum_jumps(int A, int B, int C, int D)`\n\n- $A,B$：可以用作起点的树的编号范围。\n- $C,D$：可以用作终点的树的编号范围。\n- 该函数需要返回可行方案中猩猩需要的最少跳跃次数，或者返回 $-1$ 表示该计划不可行。\n- 该函数将被调用恰好 $Q$ 次。", "inputFormat": "示例测试程序按如下格式读取输入数据：\n\n- 第 $1$ 行：$N$ $Q$\n- 第 $2$ 行：$H[0]$ $H[1]$ $\\cdots$ $H[N-1]$\n- 第 $3+i$（$0 \\le i \\le Q-1$）行：$A$ $B$ $C$ $D$，表示第 $i$ 次 `minimum_jumps` 调用的参数。", "outputFormat": "示例测试程序按如下格式输出你的答案：\n\n- 第 $1+i$（$0 \\le i \\le Q-1$）行：第 $i$ 次 `minimum_jumps` 调用的返回值。", "hint": "**【样例解释】**\n\n考虑如下调用： \n\n`init(7, [3, 2, 1, 6, 4, 5, 7])`\n\n在初始化完成后，考虑如下调用：\n\n`minimum_jumps(4, 4, 6, 6)`\n\n该计划意味着猩猩必须从 $4$ 号树（高度为 $4$）出发，并到达 $6$ 号树（高度为 $7$）。\n\n一种跳跃次数最少的可行方案为：先跳到 $3$ 号树（高度为 $6$），再跳到 $6$ 号树。\n\n另一种方案为：先跳到 $5$ 号树（高度为 $5$），再跳到 $6$ 号树。\n\n因此，`minimum_jumps` 应该返回 $2$。\n\n考虑另一个调用：\n\n`minimum_jumps(1, 3, 5, 6)`\n\n该计划意味着猩猩必须从 $1$ 号树（高度为 $2$），$2$ 号树（高度为 $1$），或 $3$ 号树（高度为 $6$）之一出发，并最终到达 $5$ 号树（高度为 $5$）或者 $6$ 号树（高度为 $7$）。\n\n唯一一种跳跃次数最少的可行方案为：从 $3$ 号树出发，直接跳到 $6$ 号树。\n\n因此，`minimum_jumps` 应该返回 $1$。\n\n考虑另一个调用：\n\n`minimum jumps(0, 1, 2, 2)`\n\n该计划意味着猩猩必须从 $0$ 号树（高度为 $3$）或者 $1$ 号树（高度为 $2$）出发，并最终到达 $2$ 号树（高度为 $1$）。\n\n由于 $2$ 号树是高度最低的树，所以无法从其他树上跳到 $2$ 号树。\n\n因此，`minimum_jumps` 应该返回 $-1$。\n\n**【数据范围】**\n\n- $2 \\le N \\le 2 \\times {10}^5$。\n- $1 \\le Q \\le {10}^5$。\n- $1 \\le H[i] \\le N$（$0 \\le i \\le N - 1$）。\n- $H[i]\\ne H[j]$（$0 \\le i<j \\le N - 1$）。\n- $0 \\le A \\le B<C \\le D \\le N - 1$。\n\n**【子任务】**\n\n1. （4 分）：$H[i]=i+1$（$0 \\le i \\le N-1$）。\n2. （8 分）：$N,Q \\le 200$。\n3. （13 分）：$N,Q \\le 2000$。\n4. （12 分）：$Q \\le 5$。\n5. （23 分）：$A=B$，$C=D$。\n6. （21 分）：$C=D$。\n7. （19 分）：无附加限制。", "locale": "zh-CN"}}}
{"pid": "P7600", "type": "P", "difficulty": 6, "samples": [["5\n0 1 1\n0 2 4\n0 3 3\n2 4 2\n", "10 5 1 0 0\n"], ["4\n0 1 5\n2 0 10\n0 3 5\n", "20 10 5 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "APIO", "交互题", "Special Judge", "O2优化"], "title": "[APIO2021] 封闭道路", "background": "本题只支持 C++ 提交，提交时不需要包含 `roads.h` 头文件，只需要将附件中的 `roads.h` 中的内容粘贴到代码的开头即可。\n\n", "description": "在泗水市，有 $N$ 个路口（编号从 $0$ 到 $N-1$）。这些路口由 $N-1$ 条双向道路连接（编号从 $0$ 到 $N-2$），因此通过这些道路，任意一对路口之间都有一条唯一的路径。$i$ 号道路（$0 \\le i \\le N-2$）连接着 $U[i]$ 号和 $V[i]$ 号路口。\n\n为了提高环保意识，泗水市长 Pak Dengklek 计划举办无车日。为了鼓励该活动，Pak Dengklek 将组织封路。Pak Dengklek 将首先选择一个非负整数 $k$，然后封闭一些道路，以使每个路口只能直接连接至多 $k$ 条未封闭的道路。封闭 $i$ 号道路的成本为 $W[i]$。\n\n请你帮助 Pak Dengklek 对每个可能的非负整数 $k$（$0 \\le k \\le N-1$）计算封闭道路的最低总成本。\n\n你需要实现下列函数：\n\n`int64[] minimum_closure_costs(int N, int[] U, int[] V, int[] W)`\n\n- $N$：泗水市的路口数量。\n\n- $U$ 和 $V$：大小为 $N-1$ 的数组，其中 $U[i]$ 号路口和 $V[i]$ 路口通过 $i$ 号道路直接连接。\n\n- $W$：大小为 $N-1$ 的数组，其中封闭 $i$ 号道路的成本为 $W[i]$。\n\n- 该函数需要返回一个大小为 $N$ 的数组。对每个 $k$（$0 \\le k \\le N-1$），$k$ 号元素是使得每个路口与至多 $k$ 条未封闭道路直接连接的最低总成本。\n\n该函数将被调用恰好一次。", "inputFormat": "示例测试程序按如下格式读取输入数据:\n\n- 第 $1$ 行：$N$\n- 第 $2+i$（$0 \\le i \\le N-2$）行：$U[i]$ $V[i]$ $W[i]$\n", "outputFormat": "示例测试程序输出仅一行，包含一个数组，表示 `minimum_closure_costs` 的返回值。", "hint": "## 例子\n\n### 例子 $1$\n\n考虑如下调用:\n\n`minimum_closure_costs(5, [0, 0, 0, 2], [1, 2, 3, 4], [1, 4, 3, 2])`\n\n这个例子中共有 $5$ 个路口和 $4$ 条道路，分别连接着路口 $(0,1),(0,2),(0,3)$ 和 $(2,4)$，封闭它们的成本依次为 $1,4,3$ 和 $2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k3z9vmxl.png)\n\n为了得到最低的总成本：\n\n- 如果 Pak_Dengklek 选择 $k=0$，那么所有道路都需要封闭，总成本为 $1+4+3+2=10$；\n- 如果 Pak_Dengklek 选择 $k=1$，那么需要封闭 $0$ 号道路和 $1$ 号道路，总成本为 $1+4=5$；\n- 如果 Pak_Dengklek 选择 $k=2$，那么需要封闭 $0$ 号道路，总成本为 $1$；\n- 如果 Pak_Dengklek 选择 $k=3$ 或 $k=4$，那么没有道路需要封闭。\n\n因此，`minimum_closure_costs` 应该返回数组 $[10,5,1,0,0]$。\n\n### 例子 $2$\n\n考虑如下调用：\n\n`minimum_closure_costs(4, [0, 2, 0], [1, 0, 3], [5, 10, 5])\n`\n\n这个例子中共有 $4$ 个路口和 $3$ 条道路，分别连接着路口 $(0,1),(2,0)$ 和 $(0,3)$，封闭它们的成本依次为 $5,10$ 和 $5$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9fdtl4aj.png)\n\n为了得到最低的总成本:\n\n- 如果 PakDengklek 选择 $k=0$，那么所有道路都需要封闭，总成本为 $5+10+5=20$；\n- 如果 PakDengklek 选择 $k=1$，那么需要封闭 $0$ 号道路和 $2$ 号道路，总成本为 $5+5=10$；\n- 如果 PakDengklek 选择 $k=2$，那么需要封闭 $0$ 号道路或 $2$ 号道路，总成本为 $5$；\n- 如果 PakDengklek 选择 $k=3$，那么没有道路需要封闭。\n\n因此，minimum_closure_costs 应该返回数组 $[20,10,5,0]$。\n\n## 约束\n\n- $2 \\le N \\le 10^5$\n- $0 \\le U[i],V[i] \\le N-1$ $(0 \\le i \\le N-2)$\n- 任意一对路口可以通过道路互相到达。\n- $1 \\le W[i] \\le 10^9$ $(0 \\le i \\le N-2)$。\n\n## 子任务\n1. (5 分) $U[i]=0$ $(0 \\le i \\le N-2)$\n2. (7 分) $U[i]=i$，$V[i]=i+1$ $(0 \\le i \\le N-2)$\n3. (14 分) $N \\le 200$\n4. (10 分) $N \\le 2000$\n5. (17 分) $W[i]=1$ $(0 \\le i \\le N-2)$\n6. (25 分) $W[i] \\le 10$ $(0 \\le i \\le N-2)$\n7. (22 分) 无附加限制", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[APIO2021] 封闭道路", "background": "本题只支持 C++ 提交，提交时不需要包含 `roads.h` 头文件，只需要将附件中的 `roads.h` 中的内容粘贴到代码的开头即可。\n\n", "description": "在泗水市，有 $N$ 个路口（编号从 $0$ 到 $N-1$）。这些路口由 $N-1$ 条双向道路连接（编号从 $0$ 到 $N-2$），因此通过这些道路，任意一对路口之间都有一条唯一的路径。$i$ 号道路（$0 \\le i \\le N-2$）连接着 $U[i]$ 号和 $V[i]$ 号路口。\n\n为了提高环保意识，泗水市长 Pak Dengklek 计划举办无车日。为了鼓励该活动，Pak Dengklek 将组织封路。Pak Dengklek 将首先选择一个非负整数 $k$，然后封闭一些道路，以使每个路口只能直接连接至多 $k$ 条未封闭的道路。封闭 $i$ 号道路的成本为 $W[i]$。\n\n请你帮助 Pak Dengklek 对每个可能的非负整数 $k$（$0 \\le k \\le N-1$）计算封闭道路的最低总成本。\n\n你需要实现下列函数：\n\n`int64[] minimum_closure_costs(int N, int[] U, int[] V, int[] W)`\n\n- $N$：泗水市的路口数量。\n\n- $U$ 和 $V$：大小为 $N-1$ 的数组，其中 $U[i]$ 号路口和 $V[i]$ 路口通过 $i$ 号道路直接连接。\n\n- $W$：大小为 $N-1$ 的数组，其中封闭 $i$ 号道路的成本为 $W[i]$。\n\n- 该函数需要返回一个大小为 $N$ 的数组。对每个 $k$（$0 \\le k \\le N-1$），$k$ 号元素是使得每个路口与至多 $k$ 条未封闭道路直接连接的最低总成本。\n\n该函数将被调用恰好一次。", "inputFormat": "示例测试程序按如下格式读取输入数据:\n\n- 第 $1$ 行：$N$\n- 第 $2+i$（$0 \\le i \\le N-2$）行：$U[i]$ $V[i]$ $W[i]$\n", "outputFormat": "示例测试程序输出仅一行，包含一个数组，表示 `minimum_closure_costs` 的返回值。", "hint": "## 例子\n\n### 例子 $1$\n\n考虑如下调用:\n\n`minimum_closure_costs(5, [0, 0, 0, 2], [1, 2, 3, 4], [1, 4, 3, 2])`\n\n这个例子中共有 $5$ 个路口和 $4$ 条道路，分别连接着路口 $(0,1),(0,2),(0,3)$ 和 $(2,4)$，封闭它们的成本依次为 $1,4,3$ 和 $2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k3z9vmxl.png)\n\n为了得到最低的总成本：\n\n- 如果 Pak_Dengklek 选择 $k=0$，那么所有道路都需要封闭，总成本为 $1+4+3+2=10$；\n- 如果 Pak_Dengklek 选择 $k=1$，那么需要封闭 $0$ 号道路和 $1$ 号道路，总成本为 $1+4=5$；\n- 如果 Pak_Dengklek 选择 $k=2$，那么需要封闭 $0$ 号道路，总成本为 $1$；\n- 如果 Pak_Dengklek 选择 $k=3$ 或 $k=4$，那么没有道路需要封闭。\n\n因此，`minimum_closure_costs` 应该返回数组 $[10,5,1,0,0]$。\n\n### 例子 $2$\n\n考虑如下调用：\n\n`minimum_closure_costs(4, [0, 2, 0], [1, 0, 3], [5, 10, 5])\n`\n\n这个例子中共有 $4$ 个路口和 $3$ 条道路，分别连接着路口 $(0,1),(2,0)$ 和 $(0,3)$，封闭它们的成本依次为 $5,10$ 和 $5$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9fdtl4aj.png)\n\n为了得到最低的总成本:\n\n- 如果 PakDengklek 选择 $k=0$，那么所有道路都需要封闭，总成本为 $5+10+5=20$；\n- 如果 PakDengklek 选择 $k=1$，那么需要封闭 $0$ 号道路和 $2$ 号道路，总成本为 $5+5=10$；\n- 如果 PakDengklek 选择 $k=2$，那么需要封闭 $0$ 号道路或 $2$ 号道路，总成本为 $5$；\n- 如果 PakDengklek 选择 $k=3$，那么没有道路需要封闭。\n\n因此，minimum_closure_costs 应该返回数组 $[20,10,5,0]$。\n\n## 约束\n\n- $2 \\le N \\le 10^5$\n- $0 \\le U[i],V[i] \\le N-1$ $(0 \\le i \\le N-2)$\n- 任意一对路口可以通过道路互相到达。\n- $1 \\le W[i] \\le 10^9$ $(0 \\le i \\le N-2)$。\n\n## 子任务\n1. (5 分) $U[i]=0$ $(0 \\le i \\le N-2)$\n2. (7 分) $U[i]=i$，$V[i]=i+1$ $(0 \\le i \\le N-2)$\n3. (14 分) $N \\le 200$\n4. (10 分) $N \\le 2000$\n5. (17 分) $W[i]=1$ $(0 \\le i \\le N-2)$\n6. (25 分) $W[i] \\le 10$ $(0 \\le i \\le N-2)$\n7. (22 分) 无附加限制", "locale": "zh-CN"}}}
{"pid": "P7601", "type": "P", "difficulty": 7, "samples": [["5\n2 1 3 2 1\n4\n2 4\n1 5\n3 5\n2 2", "1\n3\n3\n0"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 区间本质不同逆序对", "background": null, "description": "给定一个长为 $n$ 的序列 $a$。\n\n有 $m$ 次询问，每次询问给定一个区间 $[l,r]$，求 $|\\{(a_i,a_j) : l\\le i<j\\le r \\wedge a_i>a_j\\}|$。\n\n$1\\le n\\le 10^5$，$1\\le m\\le 5\\times 10^5$。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，其中第 $i$ 个数 $a_i$ 表示序列第 $i$ 个位置的值，保证 $1\\leq a_i \\leq n$。\n\n第三行一个正整数 $m$。\n\n之后 $m$ 行，每行用两个空格隔开的正整数，分别表示 $l,r$，表示一次询问，保证 $1\\leq l\\le r \\leq n$。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一行一个整数，表示第 $i$ 次询问的答案。", "hint": "**【样例解释】**\n\n对于第一次询问，集合为 $\\{(3,2)\\}$。\n\n对于第二次与第三次询问，集合为 $\\{(2,1),(3,1),(3,2)\\}$。\n\n对于第四次询问，集合为空集。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 区间本质不同逆序对", "background": null, "description": "给定一个长为 $n$ 的序列 $a$。\n\n有 $m$ 次询问，每次询问给定一个区间 $[l,r]$，求 $|\\{(a_i,a_j) : l\\le i<j\\le r \\wedge a_i>a_j\\}|$。\n\n$1\\le n\\le 10^5$，$1\\le m\\le 5\\times 10^5$。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，其中第 $i$ 个数 $a_i$ 表示序列第 $i$ 个位置的值，保证 $1\\leq a_i \\leq n$。\n\n第三行一个正整数 $m$。\n\n之后 $m$ 行，每行用两个空格隔开的正整数，分别表示 $l,r$，表示一次询问，保证 $1\\leq l\\le r \\leq n$。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一行一个整数，表示第 $i$ 次询问的答案。", "hint": "**【样例解释】**\n\n对于第一次询问，集合为 $\\{(3,2)\\}$。\n\n对于第二次与第三次询问，集合为 $\\{(2,1),(3,1),(3,2)\\}$。\n\n对于第四次询问，集合为空集。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7602", "type": "P", "difficulty": 5, "samples": [["5 5\n0 2 3 3\n1 4\n0 2 4 3\n1 4\n1 3\n", "2\n1\n4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 视频倍增期", "background": "", "description": "为了更好地衡量视频质量，快手的产品经理提出了视频的“倍增期”的概念。倍增期是一个以秒为单位的时间量指标，其含义是视频的累计播放量从只有目前的一半到当前总播放量所耗费的时长。低质量的视频往往高开低走，刚发布时人们出于好奇或者是被标题吸引而点击，一段时间之后口碑断崖式滑坡，所以倍增期很长；高质量的视频则往往低开高走，人们看过之后自发传播和推荐，逐渐积攒起口碑和流量，所以倍增期较短。\n\n小张是快手的一位视频后台管理员，有 $n$ 个视频是由小张负责监控的，从 $1$ 到 $n$ 依次编号。小张的一周有 $m$ 秒钟的工作时间，在每秒钟都会有一个需要处理的请求从前台传来，请求分成两种：\n\n- 更新请求：在这一秒钟内，编号在区间 $[l, r]$ 内的视频均获得了 $x$ 次的播放量，需要更新后台的数据；\n- 查询请求：前台希望知道编号为 $i$ 的视频的倍增期。设该视频本周当前的累计播放量为 $x$，该查询请求是第 $j$ 秒传来的，该视频本周的累计播放量恰好达到 $\\lceil x / 2 \\rceil$ 时是在第 $j'$ 秒（$j' \\ge 0$），则倍增期被定义为 $j - j'$。\n\n面对如此高频度的信息更新和查询需求，小张感到有些棘手，他希望能得到你的帮助。", "inputFormat": "输入的第一行包含两个正整数 $n$ 和 $m$，保证 $1 \\le n, m \\le {10}^5$。\n\n接下来 $m$ 行，第 $j$ 行表示第 $j$ 秒的请求（$1 \\le j \\le m$），其格式为以下两种之一：\n\n - $0 \\ l \\ r \\ x$：表示这是一个更新请求，在第 $j$ 秒，编号在区间 $[l, r]$（$1 \\le l \\le r \\le n$）内的视频获得了 $x$ 次播放量，保证 $1 \\le x \\le {10}^8$；\n - $1 \\ i$：表示这是一个查询请求，查询编号为 $i$（$1 \\le i \\le n$）的视频在第 $j$ 秒的倍增期。", "outputFormat": "对于每一个查询请求，依次输出一行，表示所查询的倍增期。", "hint": "**【样例解释】**\n\n- 第 $2$ 秒时，$4$ 号视频的累计播放量为 $0$，在第 $0$ 秒时达到了 $\\lceil 0 / 2 \\rceil = 0$ 秒的累计播放量，所以此时 $4$ 号视频的倍增期为 $2$ 秒。\n - 第 $4$ 秒时，$4$ 号视频的累计播放量为 $3$，在第 $3$ 秒时达到了 $\\lceil 3 / 2 \\rceil = 2$ 秒的累计播放量，所以此时 $4$ 号视频的倍增期为 $1$ 秒。\n - 第 $5$ 秒时，$3$ 号视频的累计播放量为 $6$，在第 $1$ 秒时达到了 $\\lceil 6 / 2 \\rceil = 3$ 秒的累计播放量，所以此时 $3$ 号视频的倍增期为 $4$ 秒。\n \n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 视频倍增期", "background": "", "description": "为了更好地衡量视频质量，快手的产品经理提出了视频的“倍增期”的概念。倍增期是一个以秒为单位的时间量指标，其含义是视频的累计播放量从只有目前的一半到当前总播放量所耗费的时长。低质量的视频往往高开低走，刚发布时人们出于好奇或者是被标题吸引而点击，一段时间之后口碑断崖式滑坡，所以倍增期很长；高质量的视频则往往低开高走，人们看过之后自发传播和推荐，逐渐积攒起口碑和流量，所以倍增期较短。\n\n小张是快手的一位视频后台管理员，有 $n$ 个视频是由小张负责监控的，从 $1$ 到 $n$ 依次编号。小张的一周有 $m$ 秒钟的工作时间，在每秒钟都会有一个需要处理的请求从前台传来，请求分成两种：\n\n- 更新请求：在这一秒钟内，编号在区间 $[l, r]$ 内的视频均获得了 $x$ 次的播放量，需要更新后台的数据；\n- 查询请求：前台希望知道编号为 $i$ 的视频的倍增期。设该视频本周当前的累计播放量为 $x$，该查询请求是第 $j$ 秒传来的，该视频本周的累计播放量恰好达到 $\\lceil x / 2 \\rceil$ 时是在第 $j'$ 秒（$j' \\ge 0$），则倍增期被定义为 $j - j'$。\n\n面对如此高频度的信息更新和查询需求，小张感到有些棘手，他希望能得到你的帮助。", "inputFormat": "输入的第一行包含两个正整数 $n$ 和 $m$，保证 $1 \\le n, m \\le {10}^5$。\n\n接下来 $m$ 行，第 $j$ 行表示第 $j$ 秒的请求（$1 \\le j \\le m$），其格式为以下两种之一：\n\n - $0 \\ l \\ r \\ x$：表示这是一个更新请求，在第 $j$ 秒，编号在区间 $[l, r]$（$1 \\le l \\le r \\le n$）内的视频获得了 $x$ 次播放量，保证 $1 \\le x \\le {10}^8$；\n - $1 \\ i$：表示这是一个查询请求，查询编号为 $i$（$1 \\le i \\le n$）的视频在第 $j$ 秒的倍增期。", "outputFormat": "对于每一个查询请求，依次输出一行，表示所查询的倍增期。", "hint": "**【样例解释】**\n\n- 第 $2$ 秒时，$4$ 号视频的累计播放量为 $0$，在第 $0$ 秒时达到了 $\\lceil 0 / 2 \\rceil = 0$ 秒的累计播放量，所以此时 $4$ 号视频的倍增期为 $2$ 秒。\n - 第 $4$ 秒时，$4$ 号视频的累计播放量为 $3$，在第 $3$ 秒时达到了 $\\lceil 3 / 2 \\rceil = 2$ 秒的累计播放量，所以此时 $4$ 号视频的倍增期为 $1$ 秒。\n - 第 $5$ 秒时，$3$ 号视频的累计播放量为 $6$，在第 $1$ 秒时达到了 $\\lceil 6 / 2 \\rceil = 3$ 秒的累计播放量，所以此时 $3$ 号视频的倍增期为 $4$ 秒。\n \n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7603", "type": "P", "difficulty": 6, "samples": [["20 9\n1 10 2\n0 5 0\n0 6 1\n0 7 1\n0 15 1\n1 12 3\n0 8 0\n1 5 0\n0 8 2\n", "0\n0\n0\n1 1\n0\n2 2 3\n"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 鬼街", "background": "", "description": "那条街有“鬼街”之称,十年前是 A 市最繁华的地段之一，然而如今这里已无活人居住。\n\n街边七零八落地排着 $n$ 座房子，每栋房子都有一个 $1$ 到 $n$ 之间的独一无二的编号，用仿佛来自地狱的黑漆涂在破瓦残砖上，在黄尘中隐隐若现。\n\n传说，这条街上的鬼是与别处的鬼是不同的，它们喜欢研究数论，会根据数字的性质来选择自己的生活，所以它们才为每一栋房子都画上了编号。\n\n新上任的 A 市市长并不相信魑魅魍魉的传言，为了探清真相，他决定为这条街装上灵异事件监控器。\n\n下面有 $m$ 个事件依次发生。\n\n- 灵异事件：在以 $x$ 的所有质因子为编号的房子里，都发生了 $y$ 次闹鬼。由于神秘的原因，次数 $y$ 可能为 $0$。\n- 监控事件：有一个监控器被安装，其监控以 $x$ 的所有质因子为编号的房子，当累计的闹鬼总次数达到阈值 $y$ 时，该监控器会触发报警（若 $y = 0$，则不论被监控的房子是哪几栋，下一次灵异事件都会立即触发该监控器的报警）。不同房子发生的灵异事件次数会被分开统计，不同的监控器互不影响。所有的监控器被从 $1$ 开始依次编号。\n\n请将所有的报警反馈给市长，即每个灵异事件之后，有哪些监控器被触发。", "inputFormat": "输入的第一行依次包含两个正整数 $n$ 和 $m$，保证 $1 < n, m \\le {10}^5$。\n\n接下来 $m$ 行，每行依次包含三个非负整数 $op$，$x$ 和 $y'$。其中 $op \\in \\{ 0, 1 \\}$，若 $op$ 为 $0$，表示这是一个灵异事件；若 $op$ 为 $1$，表示这是一个监控事件。保证 $1 < x \\le n$，$0 \\le y' < 2^{32}$。由于神秘的原因，你无法直接得到真实的 $y$，假设 $k'$ 为上一个灵异事件触发的监控器的数量（如果尚未有灵异事件发生，则 $k'$ 为 $0$），真实的 $y$ 为 $y' \\oplus k'$。$x$ 和 $y$ 在每个事件中的具体含义如上所述。", "outputFormat": "对于每一个灵异事件，依次输出一行。行首是一个非负整数 $k$，表示这个灵异事件触发的报警数量，之后是 $k$ 个从小到大排列的整数，表示触发的监控器的编号。", "hint": "**【样例解释】**\n\n在本样例中，依次发生了以下事件：\n\n- 安装了 $1$ 号监控器，监控编号为 $2$ 和 $5$ 的房子，报警阈值为 $2$。\n- 发生了一次灵异事件，$5$ 号房子似乎有闹鬼，但次数为 $0$，没有报警被触发。\n- 发生了一次灵异事件，$2$ 号和 $3$ 号房子发生了 $1$ 次闹鬼。$1$ 号监控器上的累计次数达到了 $1$，但尚未触发报警。\n- 发生了一次灵异事件，$7$ 号房子发生了 $1$ 次闹鬼，没有报警被触发。\n- 发生了一次灵异事件，$3$ 号和 $5$ 号房子发生了 $1$ 次闹鬼。$1$ 号监控器的累计次数达到阈值 $2$，触发报警。\n- 安装了 $2$ 号监控器，监控编号为 $2$ 和 $3$ 的房子，报警阈值为 $2$。\n- 发生了一次灵异事件，$2$ 号房子发生了 $1$ 次闹鬼。$2$ 号监控器的累计次数达到了 $1$，但尚未触发报警。\n- 安装了 $3$ 号监控器，不过其阈值为 $0$，所以下一次灵异事件必会触发其报警。\n- 发生了一次灵异事件，$2$ 号房子发生了 $2$ 次闹鬼。$2$ 号监控器的累计次数达到了 $3$，超过了其报警阈值 $2$，所以被触发了报警。同时 $3$ 号监控器的报警也被触发。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 鬼街", "background": "", "description": "那条街有“鬼街”之称,十年前是 A 市最繁华的地段之一，然而如今这里已无活人居住。\n\n街边七零八落地排着 $n$ 座房子，每栋房子都有一个 $1$ 到 $n$ 之间的独一无二的编号，用仿佛来自地狱的黑漆涂在破瓦残砖上，在黄尘中隐隐若现。\n\n传说，这条街上的鬼是与别处的鬼是不同的，它们喜欢研究数论，会根据数字的性质来选择自己的生活，所以它们才为每一栋房子都画上了编号。\n\n新上任的 A 市市长并不相信魑魅魍魉的传言，为了探清真相，他决定为这条街装上灵异事件监控器。\n\n下面有 $m$ 个事件依次发生。\n\n- 灵异事件：在以 $x$ 的所有质因子为编号的房子里，都发生了 $y$ 次闹鬼。由于神秘的原因，次数 $y$ 可能为 $0$。\n- 监控事件：有一个监控器被安装，其监控以 $x$ 的所有质因子为编号的房子，当累计的闹鬼总次数达到阈值 $y$ 时，该监控器会触发报警（若 $y = 0$，则不论被监控的房子是哪几栋，下一次灵异事件都会立即触发该监控器的报警）。不同房子发生的灵异事件次数会被分开统计，不同的监控器互不影响。所有的监控器被从 $1$ 开始依次编号。\n\n请将所有的报警反馈给市长，即每个灵异事件之后，有哪些监控器被触发。", "inputFormat": "输入的第一行依次包含两个正整数 $n$ 和 $m$，保证 $1 < n, m \\le {10}^5$。\n\n接下来 $m$ 行，每行依次包含三个非负整数 $op$，$x$ 和 $y'$。其中 $op \\in \\{ 0, 1 \\}$，若 $op$ 为 $0$，表示这是一个灵异事件；若 $op$ 为 $1$，表示这是一个监控事件。保证 $1 < x \\le n$，$0 \\le y' < 2^{32}$。由于神秘的原因，你无法直接得到真实的 $y$，假设 $k'$ 为上一个灵异事件触发的监控器的数量（如果尚未有灵异事件发生，则 $k'$ 为 $0$），真实的 $y$ 为 $y' \\oplus k'$。$x$ 和 $y$ 在每个事件中的具体含义如上所述。", "outputFormat": "对于每一个灵异事件，依次输出一行。行首是一个非负整数 $k$，表示这个灵异事件触发的报警数量，之后是 $k$ 个从小到大排列的整数，表示触发的监控器的编号。", "hint": "**【样例解释】**\n\n在本样例中，依次发生了以下事件：\n\n- 安装了 $1$ 号监控器，监控编号为 $2$ 和 $5$ 的房子，报警阈值为 $2$。\n- 发生了一次灵异事件，$5$ 号房子似乎有闹鬼，但次数为 $0$，没有报警被触发。\n- 发生了一次灵异事件，$2$ 号和 $3$ 号房子发生了 $1$ 次闹鬼。$1$ 号监控器上的累计次数达到了 $1$，但尚未触发报警。\n- 发生了一次灵异事件，$7$ 号房子发生了 $1$ 次闹鬼，没有报警被触发。\n- 发生了一次灵异事件，$3$ 号和 $5$ 号房子发生了 $1$ 次闹鬼。$1$ 号监控器的累计次数达到阈值 $2$，触发报警。\n- 安装了 $2$ 号监控器，监控编号为 $2$ 和 $3$ 的房子，报警阈值为 $2$。\n- 发生了一次灵异事件，$2$ 号房子发生了 $1$ 次闹鬼。$2$ 号监控器的累计次数达到了 $1$，但尚未触发报警。\n- 安装了 $3$ 号监控器，不过其阈值为 $0$，所以下一次灵异事件必会触发其报警。\n- 发生了一次灵异事件，$2$ 号房子发生了 $2$ 次闹鬼。$2$ 号监控器的累计次数达到了 $3$，超过了其报警阈值 $2$，所以被触发了报警。同时 $3$ 号监控器的报警也被触发。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7604", "type": "P", "difficulty": 6, "samples": [["()()()", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 形式语言与自动机", "background": "《形式语言与自动机》是 T 大学 C 系开设的一门专业基础课，在这门课程中，你能学到“常用语言类及其相应的计算模型，以及计算模型之间的联系”。这门课程涉及到不少较为晦涩难懂的理论知识；但对于你的好朋友，曾经在国际比赛中捧杯的小 A 来说，它似乎有些太简单了。", "description": "不知道为什么，小 A 虽然上课总在做自己的事情，但是每次布置的作业他用了十几分钟就做完了。你很好奇小 A 为什么这么熟练，但眼下，小 A 上课做的事情似乎更吸引你。\n\n“你每周上课都不认真听，是在做什么？”\n\n“我觉得老师上课讲得还挺水的，就随便做点东西玩玩。不过充其量也就是跟课程相关的吧，随便设计点自动机什么的，测试一下它能接受什么状态。”小 A 盯着他电脑前的草稿纸说道。\n\n过了一会，小 A 看到他屏幕上出现了一堆圆括号。你猜想他可能是设计了一个判断括号序列是否匹配的自动机。但正当你准备和小 A 搭话时，他突然指着屏幕对你说：“你说说这合理吗，我本来输了一个测试用的括号序列，结果手一滑，把光标蹭到了奇怪的地方。我就想着怎么看半天没看出来程序哪里有问题，原来是我输错了。”\n\n你苦笑着回复说：“这不常有的事吗，反正知道问题在哪就好了。”\n\n没想到，这句话反而让小 A 更烦躁了。\n\n“你说常有，那我给你这个串，你试试有多少种方法把它变回一个合法的括号序列。”\n\n诚然，你不是不会算，但是你更想听课。可惜，你没来得及打断小 A 的下一句话。\n\n“那就这么说定了，你要是下课前没算出来，请我吃香锅。”", "inputFormat": "输入仅包括一个串 $s$，表示小 A 实际输入的串。保证 $s$ 仅包括 `(` 和 `)`，且二者数量相等。", "outputFormat": "输出一个整数，表示**本质不同**的还原方案的个数。\n\n我们定义一种方案可以还原一个括号序列 $s=s_1 s_2 \\cdots s_n$，当且仅当存在一个划分 $s=uvw$ 使得 $uwv$ 是合法的括号序列。其中，$u=s_1\\cdots s_l$ 可以为空串（此时 $l=0$），但 $v=s_{l+1}\\cdots s_r$ 和 $w=s_{r+1}\\cdots s_n$ 不是空串。我们称两种还原方案**本质不同**，当且仅当两种方案中的 $l$ 不相同或 $r$ 不相同；即使两种还原方案还原出的串相同，这两种还原方案也可能本质不同。", "hint": "**【样例解释】**\n\n所有可能的还原方案为（其中箭头前后分别为 $s=u+v+w$ 和 $uwv$）：\n\n1. $l=0,r=2$，对应 $\\varepsilon$（空串，下同）$+$`()`$+$`()()` $\\Rightarrow$ `()()()`；\n2. $l=0,r=4$，对应 $\\varepsilon+$`()()`$+$`()`$\\Rightarrow$`()()()`；\n3. $l=1,r=2$，对应 `(`$+$`)`$+$`()()`$\\Rightarrow$`(()())`；\n4. $l=1,r=4$，对应 `(`$+$`)()`$+$`()`$\\Rightarrow$`(())()`；\n5. $l=2,r=4$，对应 `()`$+$`()`$+$`()`$\\Rightarrow$`()()()`；\n6. $l=3,r=4$，对应 `()(`$+$`)`$+$`()`$\\Rightarrow$`()(())`。\n\n这些划分方案中，方案 $1,2,5$ 还原出的串和输入的串相同，但这并不影响它们划分的方式不同。\n\n另外，`()()`$+$`()`$+\\varepsilon$ 和 `()()`$+\\varepsilon+$`()` 都不是合法的还原方案，因为在前一种划分中 $w=\\varepsilon$，而在后一种划分中 $v=\\varepsilon$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，保证 $1\\le |s| \\le 10,000,000$。\n\n**【提示】**\n\n你不需要掌握《形式语言与自动机》这门课程的相关知识也能通过本题。\n\n另外，《形式语言与自动机》这门课程“很简单”的说法只是本题中虚构人物小 A 的看法，不代表出题人的意见。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 形式语言与自动机", "background": "《形式语言与自动机》是 T 大学 C 系开设的一门专业基础课，在这门课程中，你能学到“常用语言类及其相应的计算模型，以及计算模型之间的联系”。这门课程涉及到不少较为晦涩难懂的理论知识；但对于你的好朋友，曾经在国际比赛中捧杯的小 A 来说，它似乎有些太简单了。", "description": "不知道为什么，小 A 虽然上课总在做自己的事情，但是每次布置的作业他用了十几分钟就做完了。你很好奇小 A 为什么这么熟练，但眼下，小 A 上课做的事情似乎更吸引你。\n\n“你每周上课都不认真听，是在做什么？”\n\n“我觉得老师上课讲得还挺水的，就随便做点东西玩玩。不过充其量也就是跟课程相关的吧，随便设计点自动机什么的，测试一下它能接受什么状态。”小 A 盯着他电脑前的草稿纸说道。\n\n过了一会，小 A 看到他屏幕上出现了一堆圆括号。你猜想他可能是设计了一个判断括号序列是否匹配的自动机。但正当你准备和小 A 搭话时，他突然指着屏幕对你说：“你说说这合理吗，我本来输了一个测试用的括号序列，结果手一滑，把光标蹭到了奇怪的地方。我就想着怎么看半天没看出来程序哪里有问题，原来是我输错了。”\n\n你苦笑着回复说：“这不常有的事吗，反正知道问题在哪就好了。”\n\n没想到，这句话反而让小 A 更烦躁了。\n\n“你说常有，那我给你这个串，你试试有多少种方法把它变回一个合法的括号序列。”\n\n诚然，你不是不会算，但是你更想听课。可惜，你没来得及打断小 A 的下一句话。\n\n“那就这么说定了，你要是下课前没算出来，请我吃香锅。”", "inputFormat": "输入仅包括一个串 $s$，表示小 A 实际输入的串。保证 $s$ 仅包括 `(` 和 `)`，且二者数量相等。", "outputFormat": "输出一个整数，表示**本质不同**的还原方案的个数。\n\n我们定义一种方案可以还原一个括号序列 $s=s_1 s_2 \\cdots s_n$，当且仅当存在一个划分 $s=uvw$ 使得 $uwv$ 是合法的括号序列。其中，$u=s_1\\cdots s_l$ 可以为空串（此时 $l=0$），但 $v=s_{l+1}\\cdots s_r$ 和 $w=s_{r+1}\\cdots s_n$ 不是空串。我们称两种还原方案**本质不同**，当且仅当两种方案中的 $l$ 不相同或 $r$ 不相同；即使两种还原方案还原出的串相同，这两种还原方案也可能本质不同。", "hint": "**【样例解释】**\n\n所有可能的还原方案为（其中箭头前后分别为 $s=u+v+w$ 和 $uwv$）：\n\n1. $l=0,r=2$，对应 $\\varepsilon$（空串，下同）$+$`()`$+$`()()` $\\Rightarrow$ `()()()`；\n2. $l=0,r=4$，对应 $\\varepsilon+$`()()`$+$`()`$\\Rightarrow$`()()()`；\n3. $l=1,r=2$，对应 `(`$+$`)`$+$`()()`$\\Rightarrow$`(()())`；\n4. $l=1,r=4$，对应 `(`$+$`)()`$+$`()`$\\Rightarrow$`(())()`；\n5. $l=2,r=4$，对应 `()`$+$`()`$+$`()`$\\Rightarrow$`()()()`；\n6. $l=3,r=4$，对应 `()(`$+$`)`$+$`()`$\\Rightarrow$`()(())`。\n\n这些划分方案中，方案 $1,2,5$ 还原出的串和输入的串相同，但这并不影响它们划分的方式不同。\n\n另外，`()()`$+$`()`$+\\varepsilon$ 和 `()()`$+\\varepsilon+$`()` 都不是合法的还原方案，因为在前一种划分中 $w=\\varepsilon$，而在后一种划分中 $v=\\varepsilon$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，保证 $1\\le |s| \\le 10,000,000$。\n\n**【提示】**\n\n你不需要掌握《形式语言与自动机》这门课程的相关知识也能通过本题。\n\n另外，《形式语言与自动机》这门课程“很简单”的说法只是本题中虚构人物小 A 的看法，不代表出题人的意见。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7605", "type": "P", "difficulty": 6, "samples": [["12\n3 5 1 4 9 3 3 5 1 4 9 3\n", "0 5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "区间 DP", "THUPC"], "title": "[THUPC 2021] 小 E 爱消除", "background": "", "description": "管道中塞着 $n$ 个彩色的球。这些球的直径相同。从一端到另一端它们的颜色分别为 $c_1,c_2,\\ldots,c_n$。\n\n小 E 有一个空的杯子。杯口的直径恰好比球的直径大一些，所以小 E 可以把球放入杯子中，但一次只能放入一个，并且球在杯子中只能竖直叠放。杯子中两个相邻的同色球会一起消失。\n\n由于管道的特殊性，小 E 每次只能选择管道的一端，将最靠外的球取出，然后马上放进杯子里。\n\n问当管道中的球全部取出后，杯子里最少会剩下几个球，以及在此前提下至少需要多大的杯子。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，第 $i$ 个表示 $c_i$。", "outputFormat": "输出一行，包含两个非负整数。第一个数表示杯子里剩下球数的最小值。第二个数表示在此前提下杯子需要至少能装下多少个球。", "hint": "**【样例解释】**\n\n一种最优的方案如下：\n\n先将两端的 $3$ 放入杯子中消去。\n\n然后把左端的 $5,1,4,9$ 依次放入杯子，这时杯子中有 $4$ 个球。\n\n再把右端的 $9,4$ 依次放入杯子，每放入一个球就会和杯子里的另一个球消去。在放入 $9$ 后消去前杯子中有 $5,1,4,9,9$，所以杯子需要能够容纳 $5$ 个球。\n\n接着把左端的 $3,3$ 放入杯子，这时被杯子中有 $2$ 个球。\n\n最后把右端的 $1,5$ 依次放入杯子。这时杯子是空的。\n\n图片可见下发文件中的 `Sampledescription.pptx`。\n\n**【数据范围】**\n\n保证 $1 \\le n \\le 50$，$1 \\le c_i \\le n$。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 小 E 爱消除", "background": "", "description": "管道中塞着 $n$ 个彩色的球。这些球的直径相同。从一端到另一端它们的颜色分别为 $c_1,c_2,\\ldots,c_n$。\n\n小 E 有一个空的杯子。杯口的直径恰好比球的直径大一些，所以小 E 可以把球放入杯子中，但一次只能放入一个，并且球在杯子中只能竖直叠放。杯子中两个相邻的同色球会一起消失。\n\n由于管道的特殊性，小 E 每次只能选择管道的一端，将最靠外的球取出，然后马上放进杯子里。\n\n问当管道中的球全部取出后，杯子里最少会剩下几个球，以及在此前提下至少需要多大的杯子。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，第 $i$ 个表示 $c_i$。", "outputFormat": "输出一行，包含两个非负整数。第一个数表示杯子里剩下球数的最小值。第二个数表示在此前提下杯子需要至少能装下多少个球。", "hint": "**【样例解释】**\n\n一种最优的方案如下：\n\n先将两端的 $3$ 放入杯子中消去。\n\n然后把左端的 $5,1,4,9$ 依次放入杯子，这时杯子中有 $4$ 个球。\n\n再把右端的 $9,4$ 依次放入杯子，每放入一个球就会和杯子里的另一个球消去。在放入 $9$ 后消去前杯子中有 $5,1,4,9,9$，所以杯子需要能够容纳 $5$ 个球。\n\n接着把左端的 $3,3$ 放入杯子，这时被杯子中有 $2$ 个球。\n\n最后把右端的 $1,5$ 依次放入杯子。这时杯子是空的。\n\n图片可见下发文件中的 `Sampledescription.pptx`。\n\n**【数据范围】**\n\n保证 $1 \\le n \\le 50$，$1 \\le c_i \\le n$。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7606", "type": "P", "difficulty": 6, "samples": [["3 10\n3 5 1 4 9 3 0 0 0 0 0 0\n0 0 0 0 0 0 3 5 1 4 9 3\n3 5 1 4 9 3 3 5 1 4 9 3\n3 2\n", "Chaotic Evil\n"]], "limits": {"time": [700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "背包 DP", "随机化", "THUPC"], "title": "[THUPC 2021] 混乱邪恶", "background": "出题人分为 $9$ 种阵营：守序善良、守序中立、守序邪恶、中立善良、绝对中立、中立邪恶、混乱善良、混乱中立和混乱邪恶。真正的出题人，就要能够在阵营之间不断切换，而又不迷失在境界之中。\n\n境界是一个无限大的三角形网格。网格如下图，每个交叉点都有 $6$ 个相邻的交叉点。你从某一个交叉点出发，每次给一个出题 idea 设定风格都会使你在境界中移动一步。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dwgwh04i.png)", "description": "每个出题人都有一个守序指数 $L$ 和善良指数 $G$。对于一个 idea，从题面、样例或数据范围的角度，可以从 $6$ 个方向中选择恰好一个作为这个 idea 对应的题目的特有风格，同时会在境界中沿着所选的箭头方向移动一步：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5k7jqygw.png)\n\n你现在一共有 $n$ 个 idea，你知道你给每个 idea 设定某一个风格时你的 $L$ 指数和 $G$ 指数的变化。具体地，对于第 $i$ 个idea有 $12$ 个参数 $tl_{i,l},tl_{i,g},l_{i,l},l_{i,g},bl_{i,l},bl_{i,g},br_{i,l},br_{i,g},r_{i,l},r_{i,g},tr_{i,l},tr_{i,g}$：\n\n如果选择“简洁的题面”，那么 $L$ 变成 $L+tl_{i,l}$，$G$ 变成 $G+tl_{i,g}$；\n\n如果选择“平凡无用的样例”，那么 $L$ 变成 $L+l_{i,l}$，$G$ 变成 $G+l_{i,g}$；\n\n如果选择“宽松的数据范围”，那么 $L$ 变成 $L+bl_{i,l}$，$G$ 变成 $G+bl_{i,g}$；\n\n如果选择“复杂的题面”，那么 $L$ 变成 $L+br_{i,l}$，$G$ 变成 $G+br_{i,g}$；\n\n如果选择“无私馈赠的样例”，那么 $L$ 变成 $L+r_{i,l}$，$G$ 变成 $G+r_{i,g}$；\n\n如果选择“松松松的数据范围”，那么 $L$ 变成 $L+tr_{i,l}$，$G$ 变成 $G+tr_{i,g}$。\n\n这里所有的加法都在模 $p$ 意义下进行。\n\n进入混乱邪恶阵营的要求很苛刻，需要 $L$ 恰好等于 $L^*$ 且 $G$ 恰好等于 $G^*$。\n\n你的 $L$ 指数和 $G$ 指数开始时都为 $0$。请问是否存在一种设定风格的方式使得设定完全部 $n$ 个 idea 的风格后你仍在境界中原来的位置，但是能够进入混乱邪恶阵营。", "inputFormat": "第一行两个正整数 $n,p$。\n\n接下来 $n$ 行，每行 $12$ 个非负整数 $tl_{i,l},tl_{i,g},l_{i,l},l_{i,g},bl_{i,l},bl_{i,g},br_{i,l},br_{i,g},r_{i,l},r_{i,g},tr_{i,l},tr_{i,g}$。参数的顺序与题目描述中的一致，无需额外检查。\n\n最后一行两个非负整数 $L^*,G^*$。", "outputFormat": "如果能，输出一行 `Chaotic Evil`。\n\n如果不能，输出一行 `Not a true problem setter`。", "hint": "**【样例解释】**\n\n给第 $1$ 个 idea 设定风格为”简洁的题面“，此时你的守序指数为 $0+3=3$，善良指数为 $0+5=5$。你往左上方移动一步。\n\n给第 $3$ 个 idea 设定风格为”宽松的数据范围“，此时你的守序指数为 $3+9=2$，善良指数为 $5+3=8$。你往左下方移动一步。\n\n给第 $2$ 个 idea 设定风格为”无私馈赠的样例“，此时你的守序指数为 $2+1=3$，善良指数为 $8+4=2$。你往右边移动一步。此时你回到了原点并且守序指数为 $3$，善良指数为 $2$。所以你可以进入混乱邪恶阵营。\n\n**【数据范围】**\n\n保证 $1 \\le n \\le 100$，$1 \\le p \\le 100$。\n\n保证其他输入数据在 $0$ 到 $p-1$ 之间。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 混乱邪恶", "background": "出题人分为 $9$ 种阵营：守序善良、守序中立、守序邪恶、中立善良、绝对中立、中立邪恶、混乱善良、混乱中立和混乱邪恶。真正的出题人，就要能够在阵营之间不断切换，而又不迷失在境界之中。\n\n境界是一个无限大的三角形网格。网格如下图，每个交叉点都有 $6$ 个相邻的交叉点。你从某一个交叉点出发，每次给一个出题 idea 设定风格都会使你在境界中移动一步。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dwgwh04i.png)", "description": "每个出题人都有一个守序指数 $L$ 和善良指数 $G$。对于一个 idea，从题面、样例或数据范围的角度，可以从 $6$ 个方向中选择恰好一个作为这个 idea 对应的题目的特有风格，同时会在境界中沿着所选的箭头方向移动一步：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5k7jqygw.png)\n\n你现在一共有 $n$ 个 idea，你知道你给每个 idea 设定某一个风格时你的 $L$ 指数和 $G$ 指数的变化。具体地，对于第 $i$ 个idea有 $12$ 个参数 $tl_{i,l},tl_{i,g},l_{i,l},l_{i,g},bl_{i,l},bl_{i,g},br_{i,l},br_{i,g},r_{i,l},r_{i,g},tr_{i,l},tr_{i,g}$：\n\n如果选择“简洁的题面”，那么 $L$ 变成 $L+tl_{i,l}$，$G$ 变成 $G+tl_{i,g}$；\n\n如果选择“平凡无用的样例”，那么 $L$ 变成 $L+l_{i,l}$，$G$ 变成 $G+l_{i,g}$；\n\n如果选择“宽松的数据范围”，那么 $L$ 变成 $L+bl_{i,l}$，$G$ 变成 $G+bl_{i,g}$；\n\n如果选择“复杂的题面”，那么 $L$ 变成 $L+br_{i,l}$，$G$ 变成 $G+br_{i,g}$；\n\n如果选择“无私馈赠的样例”，那么 $L$ 变成 $L+r_{i,l}$，$G$ 变成 $G+r_{i,g}$；\n\n如果选择“松松松的数据范围”，那么 $L$ 变成 $L+tr_{i,l}$，$G$ 变成 $G+tr_{i,g}$。\n\n这里所有的加法都在模 $p$ 意义下进行。\n\n进入混乱邪恶阵营的要求很苛刻，需要 $L$ 恰好等于 $L^*$ 且 $G$ 恰好等于 $G^*$。\n\n你的 $L$ 指数和 $G$ 指数开始时都为 $0$。请问是否存在一种设定风格的方式使得设定完全部 $n$ 个 idea 的风格后你仍在境界中原来的位置，但是能够进入混乱邪恶阵营。", "inputFormat": "第一行两个正整数 $n,p$。\n\n接下来 $n$ 行，每行 $12$ 个非负整数 $tl_{i,l},tl_{i,g},l_{i,l},l_{i,g},bl_{i,l},bl_{i,g},br_{i,l},br_{i,g},r_{i,l},r_{i,g},tr_{i,l},tr_{i,g}$。参数的顺序与题目描述中的一致，无需额外检查。\n\n最后一行两个非负整数 $L^*,G^*$。", "outputFormat": "如果能，输出一行 `Chaotic Evil`。\n\n如果不能，输出一行 `Not a true problem setter`。", "hint": "**【样例解释】**\n\n给第 $1$ 个 idea 设定风格为”简洁的题面“，此时你的守序指数为 $0+3=3$，善良指数为 $0+5=5$。你往左上方移动一步。\n\n给第 $3$ 个 idea 设定风格为”宽松的数据范围“，此时你的守序指数为 $3+9=2$，善良指数为 $5+3=8$。你往左下方移动一步。\n\n给第 $2$ 个 idea 设定风格为”无私馈赠的样例“，此时你的守序指数为 $2+1=3$，善良指数为 $8+4=2$。你往右边移动一步。此时你回到了原点并且守序指数为 $3$，善良指数为 $2$。所以你可以进入混乱邪恶阵营。\n\n**【数据范围】**\n\n保证 $1 \\le n \\le 100$，$1 \\le p \\le 100$。\n\n保证其他输入数据在 $0$ 到 $p-1$ 之间。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7607", "type": "P", "difficulty": 6, "samples": [["3 9 1\n", "6\n"], ["3 9 10\n", "13\n"], ["10 2000 20201003\n", "365520548\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 赌徒问题", "background": "", "description": "国籍不明，年龄不详的赌徒 Picar 和 Roman 正在玩一个游戏。\n\n正如一些经典的和赌博相关的问题中提到的那样，这个游戏是纯随机的。\n\n每一轮游戏中，参加游戏的赌徒需要先选定一个要下注的号码，并将要下注的金额支付给系统（不妨记游戏中使用的货币单位为 G）。选择的号码可以是 $1$ 至 $n$ 之间的任意整数（$n$ 是固定的正整数），其中号码 $i$ 对应正整数权重 $a_i$。记 $s=\\sum_{i=1}^n a_i$，那么系统在每轮游戏中选出号码 $i$ 的概率总为 $a_i/s$。所有参加游戏的赌徒下注结束之后，系统将会按照给定的概率随机挑选一个号码作为中奖号码。下注了中奖号码的赌徒可以根据其下注的金额及中奖号码对应的概率获得相应的奖金，而下注了其它号码的赌徒不会获得任何奖金。\n\n至于返还奖金的比例，一个自然的想法是：无论一个赌徒给哪个号码下注，其期望获得的奖金应该与其下注的金额相等。也就是说，如果一个赌徒为号码 $i$ 支付了 $x$ G，那么他中奖时应获得 $sx/a_i$ 的奖金。\n\n这个游戏的一个小缺陷是，货币 G 的最小面额是 $1$ G，也就是说系统不能返还奖金的小数部分。为了避免这一现象，规定每次下注的金额必须是 $k$ 的正整数倍（其中 $k$ 是固定的正整数）。游戏的设计者需要保证，在给定 $k$ 之后，$k s$ 是每个 $a_i$（$i = 1, \\ldots , n$）的正整数倍，这样计算奖金时就不会出现非整数值。\n\nPicar 和 Roman 觉得这游戏很有意思，他们希望在不同的参数下各玩几轮。但是他们不喜欢太大的数字，所以 $s$ 不能超过一个给定的正整数 $m$（显然，由于权重之和最多为 $m$，每个权重也最多是 $m$）。对于权重集合相同的方案，仅仅打乱权重的顺序对游戏体验的改变不大，所以 Picar 和 Roman 认为，两组权重参数本质不同当且仅当这两组参数对应的**可重集合**不同。换句话说，如果将两组权重参数 $a_1, \\ldots, a_n$ 和 $b_1, \\ldots, b_n$ 分别从小到大排序，得到 $1\\le\\alpha_1\\le\\alpha_2\\le\\cdots\\le\\alpha_n$ 和 $1\\le\\beta_1\\le\\beta_2\\le\\cdots\\le\\beta_n$，那么这两组参数本质不同当且仅当存在下标 $i\\in\\left\\{1, \\ldots, n\\right\\}$ 使得 $\\alpha_i \\ne \\beta_i$。\n\nPicar 和 Roman 想知道，给定 $n, m, k$，有多少种满足“要求”的**本质不同**的参数方案。需要注意的是，由于这里吝啬的 Picar 和 Roman 只给了你 $k$，你需要保证你统计的每个方案中，$ks$ 是每个权重 $a_i$（$i = 1, \\ldots , n$）的正整数倍。", "inputFormat": "输入仅一行，包括三个正整数 $n, m, k$，两个数之间由一个空格隔开。", "outputFormat": "输出一个非负整数，表示方案数对 ${10}^9+7$ 取模的结果。", "hint": "**【样例解释 #1】**\n\n满足要求的方案有：\n\n1. $3=1+1+1$；\n2. $4=1+1+2$；\n3. $6=1+2+3$；\n4. $6=2+2+2$；\n5. $8=2+2+4$；\n6. $9=3+3+3$。\n\n请特别注意，本题的方案是顺序无关的。\n\n**【样例解释 #2】**\n\n除了样例 #1 中的方案外，还有：\n\n7. $5=1+2+2$；\n8. $6=1+1+4$；\n9. $7=1+1+5$；\n10. $8=1+2+5$；\n11. $9=1+2+6$；\n12. $9=1+3+5$；\n13. $9=2+2+5$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10$，$1\\le m \\le 2000$，$1\\le k \\le 10^9$。\n\n**【提示】**\n\n赌博有风险，建议远离赌博。\n\n请选手在提交评测之前确认自己对于数据范围的理解正确。如果你的理解不是正确的，你将有可能获得 Wrong Answer 的评测结果。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 赌徒问题", "background": "", "description": "国籍不明，年龄不详的赌徒 Picar 和 Roman 正在玩一个游戏。\n\n正如一些经典的和赌博相关的问题中提到的那样，这个游戏是纯随机的。\n\n每一轮游戏中，参加游戏的赌徒需要先选定一个要下注的号码，并将要下注的金额支付给系统（不妨记游戏中使用的货币单位为 G）。选择的号码可以是 $1$ 至 $n$ 之间的任意整数（$n$ 是固定的正整数），其中号码 $i$ 对应正整数权重 $a_i$。记 $s=\\sum_{i=1}^n a_i$，那么系统在每轮游戏中选出号码 $i$ 的概率总为 $a_i/s$。所有参加游戏的赌徒下注结束之后，系统将会按照给定的概率随机挑选一个号码作为中奖号码。下注了中奖号码的赌徒可以根据其下注的金额及中奖号码对应的概率获得相应的奖金，而下注了其它号码的赌徒不会获得任何奖金。\n\n至于返还奖金的比例，一个自然的想法是：无论一个赌徒给哪个号码下注，其期望获得的奖金应该与其下注的金额相等。也就是说，如果一个赌徒为号码 $i$ 支付了 $x$ G，那么他中奖时应获得 $sx/a_i$ 的奖金。\n\n这个游戏的一个小缺陷是，货币 G 的最小面额是 $1$ G，也就是说系统不能返还奖金的小数部分。为了避免这一现象，规定每次下注的金额必须是 $k$ 的正整数倍（其中 $k$ 是固定的正整数）。游戏的设计者需要保证，在给定 $k$ 之后，$k s$ 是每个 $a_i$（$i = 1, \\ldots , n$）的正整数倍，这样计算奖金时就不会出现非整数值。\n\nPicar 和 Roman 觉得这游戏很有意思，他们希望在不同的参数下各玩几轮。但是他们不喜欢太大的数字，所以 $s$ 不能超过一个给定的正整数 $m$（显然，由于权重之和最多为 $m$，每个权重也最多是 $m$）。对于权重集合相同的方案，仅仅打乱权重的顺序对游戏体验的改变不大，所以 Picar 和 Roman 认为，两组权重参数本质不同当且仅当这两组参数对应的**可重集合**不同。换句话说，如果将两组权重参数 $a_1, \\ldots, a_n$ 和 $b_1, \\ldots, b_n$ 分别从小到大排序，得到 $1\\le\\alpha_1\\le\\alpha_2\\le\\cdots\\le\\alpha_n$ 和 $1\\le\\beta_1\\le\\beta_2\\le\\cdots\\le\\beta_n$，那么这两组参数本质不同当且仅当存在下标 $i\\in\\left\\{1, \\ldots, n\\right\\}$ 使得 $\\alpha_i \\ne \\beta_i$。\n\nPicar 和 Roman 想知道，给定 $n, m, k$，有多少种满足“要求”的**本质不同**的参数方案。需要注意的是，由于这里吝啬的 Picar 和 Roman 只给了你 $k$，你需要保证你统计的每个方案中，$ks$ 是每个权重 $a_i$（$i = 1, \\ldots , n$）的正整数倍。", "inputFormat": "输入仅一行，包括三个正整数 $n, m, k$，两个数之间由一个空格隔开。", "outputFormat": "输出一个非负整数，表示方案数对 ${10}^9+7$ 取模的结果。", "hint": "**【样例解释 #1】**\n\n满足要求的方案有：\n\n1. $3=1+1+1$；\n2. $4=1+1+2$；\n3. $6=1+2+3$；\n4. $6=2+2+2$；\n5. $8=2+2+4$；\n6. $9=3+3+3$。\n\n请特别注意，本题的方案是顺序无关的。\n\n**【样例解释 #2】**\n\n除了样例 #1 中的方案外，还有：\n\n7. $5=1+2+2$；\n8. $6=1+1+4$；\n9. $7=1+1+5$；\n10. $8=1+2+5$；\n11. $9=1+2+6$；\n12. $9=1+3+5$；\n13. $9=2+2+5$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10$，$1\\le m \\le 2000$，$1\\le k \\le 10^9$。\n\n**【提示】**\n\n赌博有风险，建议远离赌博。\n\n请选手在提交评测之前确认自己对于数据范围的理解正确。如果你的理解不是正确的，你将有可能获得 Wrong Answer 的评测结果。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7608", "type": "P", "difficulty": 5, "samples": [["6 2 4\n", "Wrong, don't cheat me, you are too far away from the Turing Award.\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 挑战图灵奖", "background": "图染色问题是这样的——给定一个 $n$ 个点，$m$ 条边的图，要求将每个点染上一种颜色，满足任意有边相连的两个点颜色不同，问最少需要多少种颜色。众所周知，图染色是 NPC 问题之一，如果有人能在多项式时间内解决图染色问题，那就相当于证明了 P = NP，恭喜你，下一位图灵奖得主非你莫属！", "description": "今天，你的好朋友——敏珂找到了你，宣称他证明了半个图染色问题，希望你帮他看看他的做法对不对，如果你能帮他验证，他会考虑与你分享图灵奖的奖金。敏珂宣称自己解决的问题是这样的：对于一个 $n$ 个点的无向图，图上所有节点编号为  $1,2,\\ldots, n$，两点之间有连边，当且仅当两点编号在模 $n$ 意义下相差不超过 $k$，即 $(x,y)$ 之间有一条无向边，当且仅当 $x \\neq y$ 且存在 $i$ 满足 $1 \\le i \\le k$，\n\n$$(x+i) \\equiv y \\pmod n$$ \n\n或 \n\n$$(y+i) \\equiv x \\pmod n $$\n\n，他能够快速求出这个图的染色数。作为评审，你只需要解决一个判定性问题——对于每组数据，敏珂会给出三个正整数 $n$，$k$ 和 $x$，表示在给定 $n$ 和 $k$ 时（$n, k$ 的意义如上文所述），他认为这个图的**染色数**是 $x$，你需要判断他的答案是否正确。\n\n如果你认为他的答案是**正确**的，输出一行 `Correct, but it doesn't necessarily mean that you can win the Turing Award.`；如果你认为他的答案是**错误**的，在第一行输出 `Wrong, don't cheat me, you are too far away from the Turing Award.`。为了让你的答案更有信服力，你还需要在第二行输出一个字符 `0` 或 `1`，`0` 表示你认为敏珂的答案小于这个图的实际染色数，`1` 表示你认为他的答案大于这个图的实际染色数；如果你认为这个问题**以当下计算机算力无法作出准确判断**，输出一行 `The problem is unsolvable, please stop cheating me, Mr.Minke.`。", "inputFormat": "输入只有一行，包含三个正整数，分别表示 $n, k, x$,  意义如题面所述。\n\n其中 $1\\le x, n \\le 10^{1,000,000}$，$1 \\le k \\le 100$，所有输入均为正整数，且对于所有数据，$n$ 只可能满足 $n \\le 10^5$ 或 $n \\ge 10^{100}$。", "outputFormat": "输出共 $1$ 或 $2$ 行，第一行表示你的判断结果，格式如题面所述；\n\n如果你顺利完成判断并认为敏珂的答案是错误的，则需要在第二行输出一个字符 `0` 或 `1`，`0` 表示敏珂的答案小了，`1` 表示敏珂的答案大了。", "hint": "**【样例解释】**\n\n很显然，给 $1 \\sim 6$ 号点分别染色为 $1, 2, 3, 1, 2, 3$ 是可行的，所以 $n = 6$，$k = 2$ 情况下对应的染色数为 $3$。\n\n**【提示】**\n\n1. 如果没有 idea，请再次阅读题面给的数据范围，也许能对解题有一些帮助。\n\n2. Hint 1 可能没有用。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 挑战图灵奖", "background": "图染色问题是这样的——给定一个 $n$ 个点，$m$ 条边的图，要求将每个点染上一种颜色，满足任意有边相连的两个点颜色不同，问最少需要多少种颜色。众所周知，图染色是 NPC 问题之一，如果有人能在多项式时间内解决图染色问题，那就相当于证明了 P = NP，恭喜你，下一位图灵奖得主非你莫属！", "description": "今天，你的好朋友——敏珂找到了你，宣称他证明了半个图染色问题，希望你帮他看看他的做法对不对，如果你能帮他验证，他会考虑与你分享图灵奖的奖金。敏珂宣称自己解决的问题是这样的：对于一个 $n$ 个点的无向图，图上所有节点编号为  $1,2,\\ldots, n$，两点之间有连边，当且仅当两点编号在模 $n$ 意义下相差不超过 $k$，即 $(x,y)$ 之间有一条无向边，当且仅当 $x \\neq y$ 且存在 $i$ 满足 $1 \\le i \\le k$，\n\n$$(x+i) \\equiv y \\pmod n$$ \n\n或 \n\n$$(y+i) \\equiv x \\pmod n $$\n\n，他能够快速求出这个图的染色数。作为评审，你只需要解决一个判定性问题——对于每组数据，敏珂会给出三个正整数 $n$，$k$ 和 $x$，表示在给定 $n$ 和 $k$ 时（$n, k$ 的意义如上文所述），他认为这个图的**染色数**是 $x$，你需要判断他的答案是否正确。\n\n如果你认为他的答案是**正确**的，输出一行 `Correct, but it doesn't necessarily mean that you can win the Turing Award.`；如果你认为他的答案是**错误**的，在第一行输出 `Wrong, don't cheat me, you are too far away from the Turing Award.`。为了让你的答案更有信服力，你还需要在第二行输出一个字符 `0` 或 `1`，`0` 表示你认为敏珂的答案小于这个图的实际染色数，`1` 表示你认为他的答案大于这个图的实际染色数；如果你认为这个问题**以当下计算机算力无法作出准确判断**，输出一行 `The problem is unsolvable, please stop cheating me, Mr.Minke.`。", "inputFormat": "输入只有一行，包含三个正整数，分别表示 $n, k, x$,  意义如题面所述。\n\n其中 $1\\le x, n \\le 10^{1,000,000}$，$1 \\le k \\le 100$，所有输入均为正整数，且对于所有数据，$n$ 只可能满足 $n \\le 10^5$ 或 $n \\ge 10^{100}$。", "outputFormat": "输出共 $1$ 或 $2$ 行，第一行表示你的判断结果，格式如题面所述；\n\n如果你顺利完成判断并认为敏珂的答案是错误的，则需要在第二行输出一个字符 `0` 或 `1`，`0` 表示敏珂的答案小了，`1` 表示敏珂的答案大了。", "hint": "**【样例解释】**\n\n很显然，给 $1 \\sim 6$ 号点分别染色为 $1, 2, 3, 1, 2, 3$ 是可行的，所以 $n = 6$，$k = 2$ 情况下对应的染色数为 $3$。\n\n**【提示】**\n\n1. 如果没有 idea，请再次阅读题面给的数据范围，也许能对解题有一些帮助。\n\n2. Hint 1 可能没有用。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7609", "type": "P", "difficulty": 6, "samples": [["6 3\n2 3 4\n", "4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 游戏", "background": "", "description": "小 C 和小 W 两个人打算玩一局双人博弈游戏。\n\n现在小 C 手里有 $n$ 颗相同的石子，小 W 打算把它们分为有顺序的 $m$ 堆，其中第 $i$ 堆石子的数量不能超过 $a_i$，但允许为 $0$。\n\n随后，由小 C 先手，两人轮流进行操作，每次可以选择一堆非空的石子并拿走其中若干个（至少 $1$ 个），无法操作者输。\n\n作为算法竞赛界的老司机，小 C 和小 W 早已对各种游戏的策略摸得门儿清，于是这次他们打算玩点不一样的：他们想要知道，有多少种分石子的方法能使得小 C 有必胜策略。", "inputFormat": "第一行，两个正整数 $n, m$（$1 \\le n \\le {10}^{18}$，$1 \\le m \\le 10$）。\n\n第二行，$m$ 个非负整数 $a_i$（$0 \\le a_i \\le {10}^{18}$）。", "outputFormat": "一个非负整数，表示方案数对 $998244353$ 取模的结果。", "hint": "**【样例解释】**\n\n以下 $4$ 种方案是符合题意的：$(0,2,4)$、$(1,1,4)$、$(2,0,4)$、$(2,2,2)$。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 游戏", "background": "", "description": "小 C 和小 W 两个人打算玩一局双人博弈游戏。\n\n现在小 C 手里有 $n$ 颗相同的石子，小 W 打算把它们分为有顺序的 $m$ 堆，其中第 $i$ 堆石子的数量不能超过 $a_i$，但允许为 $0$。\n\n随后，由小 C 先手，两人轮流进行操作，每次可以选择一堆非空的石子并拿走其中若干个（至少 $1$ 个），无法操作者输。\n\n作为算法竞赛界的老司机，小 C 和小 W 早已对各种游戏的策略摸得门儿清，于是这次他们打算玩点不一样的：他们想要知道，有多少种分石子的方法能使得小 C 有必胜策略。", "inputFormat": "第一行，两个正整数 $n, m$（$1 \\le n \\le {10}^{18}$，$1 \\le m \\le 10$）。\n\n第二行，$m$ 个非负整数 $a_i$（$0 \\le a_i \\le {10}^{18}$）。", "outputFormat": "一个非负整数，表示方案数对 $998244353$ 取模的结果。", "hint": "**【样例解释】**\n\n以下 $4$ 种方案是符合题意的：$(0,2,4)$、$(1,1,4)$、$(2,0,4)$、$(2,2,2)$。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7610", "type": "P", "difficulty": 6, "samples": [["3\n2 8 1 1\n1 2 3\n3 1 1\n7 2 1 2\n6 6 3 0\n1 2 3\n5 1 1\n7 2 1 1\n99 10 1 1\n2 1 3\n1 0 0\n10 10 0 0\n9 10 1 0\n1 2 3\n2 1 0\n8 2 1 0\n8 7 2 1\n2 1 3\n1 0 0\n4 2 1 0\n99 10 2 0\n2 1 3\n1 0 0\n10 10 0 0\n", "15\nAlice\n2 0 96 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 群星连结", "background": "众所周知，群星和公主连结联动啦！联动的结果是一个叫做群星连结的游戏。\n\n这是一个双人回合制竞赛游戏，双方记为 Alice 和 Bob。游戏有若干**回合**，每个回合依次由先手和后手分别行动一次。\n\n现在聪明的你写了一个优秀的 AI 来玩这个游戏，这个 AI 会遵从游戏规则，并且按照游戏过程条目里既定的策略进行游戏。但是由于您太强了，所以世界上只有这么一个 AI，所以只能自己和自己打。\n\n现在给定这个游戏的初始局面，让这个 AI 分别作为 Alice 和 Bob 对战，其中 Alice 先手。你需要模拟游戏过程，并且判断最终是 Alice 获胜还是 Bob 获胜。\n\n游戏初始局面会通过输入给出。\n\n**【提示】**\n\n本题中，**伤害**、**真实伤害**、**生命值扣除**是三个不同的概念，请注意区分。", "description": "#### 基础参数\n\n首先，在游戏开始之前，每个玩家需要选择恰好 $n$ 个角色，并编号 $1,2,3,\\dots,n$。\n\n每个角色都有一些基础参数：\n\n1. $HP,hp$ ：最大生命值，生命值；\n2. $MP,mp$：最大能量值，能量值；\n3. $atk,\\Delta_{atk}$：基础攻击力，攻击力增益；\n4. $def,\\Delta_{def}$：基础防御力，防御力增益；\n\n另外，为方便起见，下文中记 $A=\\max(atk+\\Delta_{atk},1)$，$D=\\max(def+\\Delta_{def},0)$。\n\n游戏开始时，生命值 $hp$ 等于最大生命值 $HP$，能量值 $mp$、攻击力增益 $\\Delta_{atk}$、防御力增益 $\\Delta_{def}$ 均等于 $0$。\n\n$HP,MP,atk,def$ 将由输入给出。\n\n除此之外，每个角色分别拥有一个**天赋**和一个**技能**，分别见**天赋**条目和**技能**条目。\n\n#### 死亡判定\n\n游戏过程的任意时刻，如果某个角色生命值 $hp$ 降到 $0$ **及**以下，则判定该角色【死亡】。\n\n一个角色一旦被判定为【死亡】，则该角色将从场上完全退出，并且生命值被恒定为 $0$，不能通过任何方式回复生命值（即不能起死回生，即使拥有【天赋 — 心胜于物】；另外，也不能通过己方其它角色技能回复生命值），不能普通攻击、发动技能，也不能被选定为优先目标，因而不能被普通攻击。\n\n总之就是不以任何形式参与后续游戏的进程，并且本题中所有“全体”、“所有角色”等词均不包含【死亡】角色。\n\n当某方角色全部被判定【死亡】时，游戏立刻结束，并判定另一方胜利（若此时仍有尚未完成的结算，也全部不再进行）。\n\n#### 参数溢出\n\n在游戏过程的任意时刻，如果某个角色的生命值 $hp>HP$，则 $hp$ 会立刻变成为 $HP$。\n\n在游戏过程的任意时刻，如果某个角色的能量值 $mp>MP$，则 $mp$ 会立刻变成为 $MP$。\n\n#### 优先目标\n\n游戏开始前，每个玩家需要为每个角色选定一个攻击顺序。\n\n具体来说，对编号为 $i$ 的角色，需要确定一个攻击顺序 $p_{i,1},\\ldots,p_{i,n}$，满足 $p_{i,1},\\ldots,p_{i,n}$ 是一个关于 $1,\\ldots,n$ 的排列。\n\n游戏过程的任意时刻，称编号为 $i$ 的优先目标是 $p_{i,j}$，当且仅当 $p_{i,1},\\ldots,p_{i,j-1}$ 全部【死亡】，并且 $p_{i,j}$ 没有【死亡】。\n\n#### 普通攻击\n\n普通攻击会对优先目标造成 $A$ 点伤害。\n\n拥有【天赋 — 超凡入圣】的角色则会对优先目标造成 $A$ 点真实伤害。详见**天赋**条目。\n\n拥有【天赋 — 星河力量投射】的角色普通攻击会附加真实伤害。详见**天赋**条目。\n\n#### 天赋\n\n天赋有以下几种类型（每行前的编号为天赋类型的编号，圆括弧 `()` 内部为附加参数）：\n\n0. 【天赋 — 我自闭了】该角色的天赋毫无作用；\n1. 【天赋 — 血肉皮囊】该角色免疫一半真实伤害。详情见**生命值扣除环节**条目。  \n   **真实伤害见生命值扣除条目**；\n2. 【天赋 — 星河力量投射】$(x)$ 该角色每次普通攻击会附加的 $x$ 点真实伤害；\n3. 【天赋 — 心胜于物】$(x,y)$ 该角色每次己方行动结束后回复 $x$ 点生命值，并**额外**回复 $y$ 点能量值；\n4. 【天赋 — 超凡入圣】该角色的普通攻击被视为真实伤害攻击，即该角色的普通攻击不造成伤害，但造成 $A$ 点真实伤害。\n5. 【天赋 — 科技至上】$(x,y)$ 该角色每次进行普通攻击后，回复 $x$ 点生命值；该角色每次发动技能后，**额外**回复 $y$ 点能量值。注意：如果普通攻击或发动技能造成对方全部角色【死亡】，则该角色不再回复生命值或能量值。\n\n本题保证天赋附加参数均为**正**整数（但在输入数据中可能会有 $0$，详情参见**输入格式**条目）。\n\n#### 技能\n\n当某个角色能量值等于其最大能量值时（并且在游戏过程中被选定为发动技能的角色），可以清零其能量值并发动一次技能。\n\n技能有以下几种类型（每行前的编号为技能类型的编号，圆括弧` ()` 内部为附加参数）：\n\n0. 【技能：心态崩了！】该角色的主动技能毫无作用。注意，该技能仍然可以被发动，只不过毫无效果而已。\n1. 【技能：格林炸裂！】$(x)$ 对敌方**所有**角色造成 $x$ 点伤害，**然后**使敌方**所有**角色能量值减少 $\\left\\lfloor\\frac{mp_{enemy}}{10}\\right\\rfloor$，其中 $mp_{enemy}$ 为敌方该角色能量值（即对于每个敌方角色，若其当前的能量值为 $mp_{enemy}$，那么受此技能影响，其能量值会变成 $mp_{enemy}-\\left\\lfloor\\frac{mp_{enemy}}{10}\\right\\rfloor$）。注意，根据规则，敌方角色会先受到伤害而进入生命值扣除环节，在该环节中回复能量值，然后再被该技能扣除能量值。\n2. 【技能：日 (zhou) 昇 (ji) 之 (dao) 雨 (dan)！】对敌方**所有**角色造成 $A$ 点真实伤害。\n3. 【技能：天楼霸断剑！】$(x)$ 对敌方**所有**目标造成 $\\min\\left(\\left\\lfloor\\frac{HP_{enemy}}{10}\\right\\rfloor,x\\times A\\right)$ 点伤害，其中 $HP_{enemy}$ 为被攻击目标的最大生命值。\n4. 【技能：演出开始！】$(x,y)$ 设当前为第 $t$ 回合，则从发动技能开始，到第 $t+x-1$ 回合结束期间，在己方行动结束时，己方全体角色**额外**回复 $y$ 点能量值。\n5. 【技能：天狼噬斩！】$(x)$ 将优先目标的防御力增益减小 $x$，**然后**对优先目标造成 $A$ 点真实伤害。\n6. 【技能：地 (太) 球 (虚) 蓝 (苍) 色 (蓝) 闪 (闪) 电！】$(x,y)$ 对优先目标造成 $A$ 点真实伤害。另外，设当前为第 $t$ 回合，则从发动技能开始，到第 $t+x-1$ 回合结束期间，敌方所有角色攻击力增益减小 $y$。\n7. 【技能：极光绽放！】$(x,y,z)$ 使己方未【死亡】角色生命值最低（如有多个，则编号最小）的恰好一名角色回复 $z$ 点生命值。另外，设当前为第 $t$ 回合，则从发动技能开始到第 $t+x-1$ 回合结束期间，己方所有角色攻击力增益增大 $y$。\n8. 【技能：流星！】$(x,y)$ 对敌方所有角色造成 $A$ 点伤害。设当前为第 $t$ 回合，则**从该技能造成伤害后**，到第 $t+x-1$ 回合结束期间，使敌方所有角色防御力增益减小 $y$。注意，本技能先造成伤害，再产生减益。\n9. 【技能：精灵庇护！】$(x,y,z)$ 己方全体角色回复 $z$ 点生命值。设当前为第 $t$ 回合，则从发动技能开始，到第 $t+x-1$ 回合结束期间，己方所有角色防御力增益增大 $y$。\n10. 【技能：全力超全开！轮回之终末！】$(x)$ 己方所有角色基础攻击力 $atk$、基础防御力 $def$ 变为原先的两倍 $2\\times atk, 2\\times def$；未【死亡】角色生命值 $hp$ 变为 $\\max\\left(\\left\\lfloor\\frac{HP}2\\right\\rfloor,hp\\right)$，能量值 $mp$ 变为 $\\max\\left(\\left\\lfloor\\frac{MP}2\\right\\rfloor,mp\\right)$；设当前为第 $t$ 回合，则从发动技能开始，到第 $t+x-1$ 回合结束期间，己方行动结束时，己方所有角色**额外**回复 $1$ 点能量值。在第 $t+x-1$ 回合结束时，若敌方仍有角色未【死亡】，则己方全体角色强制生命值清零，并被判定为【死亡】。另外，在发动该技能时，场上所有拥有这个技能的角色（包括自己）的技能将被强制替换为 0 号【技能：心态崩了！】（因此该技能最多在游戏中被发动一次）。\n\n本题保证技能附加参数均为**正**整数（但在输入数据中可能会有 $0$，详情参见**输入**条目）。\n\n注意：上述形如“设当前为第 $t$ 回合，则从发动技能开始到第 $t+x-1$ 回合结束期间，……”产生的效果是**可以叠加**的。\n\n#### 生命回复与能量回复\n\n生命值仅可通过天赋和技能回复。\n\n己方行动结束时，己方全体角色能量值增加 $1$。拥有【天赋 — 心胜于物】的角色，以及受【技能：演出开始！】和【技能：全力超全开！轮回之终末！】影响的角色可以额外回复能量值。\n\n当己方角色进行普通攻击或者发动技能后，该角色能量值增加 $1$。拥有【天赋 — 科技至上】的角色发动技能后会回复额外的能量值。\n\n注意，发动技能时，先扣除全部能量值，再发动技能，然后再增加能量值。\n\n特别的，若该技能为【技能：全力超全开！轮回之终末！】，则使发动该技能的角色 $mp=\\max\\left(mp,\\left\\lfloor\\frac{MP}2\\right\\rfloor\\right)$ 后再增加能量值。\n\n当己方角色因受到伤害而进入生命值扣除环节时，该角色能量值增加 $1$（无论其是否实际扣除生命值）。\n\n**生命值扣除见生命值扣除环节。**\n\n#### 生命值扣除环节\n\n当角色受到伤害或者真实伤害时，该角色立即进入生命值扣除环节（注意，即使受到了 $0$ 点伤害，也会进入生命值扣除环节）。\n\n进入生命值扣除环节后，由能量回复条目，该角色能量值增加 $1$。\n\n假设其受到 $x$ 点伤害和 $y$ 点真实伤害，那么：\n\n- 若该角色因拥有【天赋—血肉皮囊】而免疫一半真实伤害，则其生命值扣除 $\\max(x-D,0)+y-\\left\\lfloor\\frac y2\\right\\rfloor$。\n- 否则，其生命值扣除 $\\max(x-D,0)+y$。\n\n#### 游戏过程\n\n游戏开始后，可视为若干回合，编号从 $1$ 开始。\n\n每个回合，可以划分为如下 $5$ 个阶段：Alice 行动（期间）、Alice 行动结束、Bob 行动（期间）、Bob 行动结束、当前回合结束。\n\n己方行动期间，\n\n1. 如果己方存在至少一个角色可以发动技能时，则按照技能编号从大到小的顺序选择其中一位发动技能。如果有多个角色满足可以发动相同编号的技能，则选择这些角色中角色编号最大的角色发动技能。\n2. 如果己方没有角色可以发动技能，则选择一个优先目标生命值最高的角色发动普通攻击。如果有多个角色的优先目标生命值最高，则选择能对优先目标扣除更多生命值（而不是造成更多伤害！）的角色发动攻击。如果仍然有多个角色可以选择，则选择其中编号最大的角色发动普通攻击。\n\n己方行动结束。\n\n注意，己方行动期间，仅能选择一位角色发动技能，或者选择一位角色进行普通攻击。", "inputFormat": "第一行一个正整数 $n$，表示 `Alice` 和 `Bob` 分别有 $n$ 个角色。\n\n接下来 $4 n$ 行，第 $4 i - 3$ 到第 $4 i$ 行描述 `Alice` 的编号为 $i$ 的角色。\n\n在这四行中：\n\n- 第一行，四个非负整数 $HP,MP,atk,def$ 分别表示该角色的最大生命值、最大能量值、基础攻击力、基础防御力，保证 $HP,MP>0$。\n- 第二行，$n$ 个正整数 $p_{i,1},p_{i,2}, \\ldots ,p_{i,n}$，表示该角色攻击顺序，保证这是一个关于 $1$ 到 $n$ 的排列。\n- 第三行，三个非负整数 $tf,x,y$ 表示天赋编号以及附加参数。如果该天赋附加参数不足两个，那么你可以忽略多余的部分（保证此时多余的部分在输入数据中是 $0$）。\n- 第四行，四个非负整数 $jn,x,y,z$ 表示技能编号及附加参数。如果该技能附加参数不足三个，那么你可以忽略多余的部分（保证此时多余的部分在输入数据中是 $0$）。\n\n接下来 $4n$ 行描述 `Bob` 的 $n$ 个角色，形式同上。", "outputFormat": "如果游戏能够以某一方胜利而结束，那么：\n\n- 第一行，输出一个正整数 $x$，表示游戏在第 $x$ 个回合结束的。\n- 第二行，输出一个字符串（`Alice` 或 `Bob`）表示胜者。\n- 第三行，输出 $n$ 个非负整数，依次表示胜者的每一个角色在游戏结束时的 $hp$，若该角色已死亡则输出 $0$。\n\n如果游戏永远不会结束或者双方平局，请输出任意卖萌表情。", "hint": "**【数据范围】**\n\n$n \\le 10$，$HP, MP, atk \\gt 0$，$def \\ge 0$。\n\n保证在游戏中的任意时刻，所有题面中提及到的参数及表达式的绝对值均不超过 ${10}^9$。\n\n保证游戏在 $23333$ 回合内结束。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 群星连结", "background": "众所周知，群星和公主连结联动啦！联动的结果是一个叫做群星连结的游戏。\n\n这是一个双人回合制竞赛游戏，双方记为 Alice 和 Bob。游戏有若干**回合**，每个回合依次由先手和后手分别行动一次。\n\n现在聪明的你写了一个优秀的 AI 来玩这个游戏，这个 AI 会遵从游戏规则，并且按照游戏过程条目里既定的策略进行游戏。但是由于您太强了，所以世界上只有这么一个 AI，所以只能自己和自己打。\n\n现在给定这个游戏的初始局面，让这个 AI 分别作为 Alice 和 Bob 对战，其中 Alice 先手。你需要模拟游戏过程，并且判断最终是 Alice 获胜还是 Bob 获胜。\n\n游戏初始局面会通过输入给出。\n\n**【提示】**\n\n本题中，**伤害**、**真实伤害**、**生命值扣除**是三个不同的概念，请注意区分。", "description": "#### 基础参数\n\n首先，在游戏开始之前，每个玩家需要选择恰好 $n$ 个角色，并编号 $1,2,3,\\dots,n$。\n\n每个角色都有一些基础参数：\n\n1. $HP,hp$ ：最大生命值，生命值；\n2. $MP,mp$：最大能量值，能量值；\n3. $atk,\\Delta_{atk}$：基础攻击力，攻击力增益；\n4. $def,\\Delta_{def}$：基础防御力，防御力增益；\n\n另外，为方便起见，下文中记 $A=\\max(atk+\\Delta_{atk},1)$，$D=\\max(def+\\Delta_{def},0)$。\n\n游戏开始时，生命值 $hp$ 等于最大生命值 $HP$，能量值 $mp$、攻击力增益 $\\Delta_{atk}$、防御力增益 $\\Delta_{def}$ 均等于 $0$。\n\n$HP,MP,atk,def$ 将由输入给出。\n\n除此之外，每个角色分别拥有一个**天赋**和一个**技能**，分别见**天赋**条目和**技能**条目。\n\n#### 死亡判定\n\n游戏过程的任意时刻，如果某个角色生命值 $hp$ 降到 $0$ **及**以下，则判定该角色【死亡】。\n\n一个角色一旦被判定为【死亡】，则该角色将从场上完全退出，并且生命值被恒定为 $0$，不能通过任何方式回复生命值（即不能起死回生，即使拥有【天赋 — 心胜于物】；另外，也不能通过己方其它角色技能回复生命值），不能普通攻击、发动技能，也不能被选定为优先目标，因而不能被普通攻击。\n\n总之就是不以任何形式参与后续游戏的进程，并且本题中所有“全体”、“所有角色”等词均不包含【死亡】角色。\n\n当某方角色全部被判定【死亡】时，游戏立刻结束，并判定另一方胜利（若此时仍有尚未完成的结算，也全部不再进行）。\n\n#### 参数溢出\n\n在游戏过程的任意时刻，如果某个角色的生命值 $hp>HP$，则 $hp$ 会立刻变成为 $HP$。\n\n在游戏过程的任意时刻，如果某个角色的能量值 $mp>MP$，则 $mp$ 会立刻变成为 $MP$。\n\n#### 优先目标\n\n游戏开始前，每个玩家需要为每个角色选定一个攻击顺序。\n\n具体来说，对编号为 $i$ 的角色，需要确定一个攻击顺序 $p_{i,1},\\ldots,p_{i,n}$，满足 $p_{i,1},\\ldots,p_{i,n}$ 是一个关于 $1,\\ldots,n$ 的排列。\n\n游戏过程的任意时刻，称编号为 $i$ 的优先目标是 $p_{i,j}$，当且仅当 $p_{i,1},\\ldots,p_{i,j-1}$ 全部【死亡】，并且 $p_{i,j}$ 没有【死亡】。\n\n#### 普通攻击\n\n普通攻击会对优先目标造成 $A$ 点伤害。\n\n拥有【天赋 — 超凡入圣】的角色则会对优先目标造成 $A$ 点真实伤害。详见**天赋**条目。\n\n拥有【天赋 — 星河力量投射】的角色普通攻击会附加真实伤害。详见**天赋**条目。\n\n#### 天赋\n\n天赋有以下几种类型（每行前的编号为天赋类型的编号，圆括弧 `()` 内部为附加参数）：\n\n0. 【天赋 — 我自闭了】该角色的天赋毫无作用；\n1. 【天赋 — 血肉皮囊】该角色免疫一半真实伤害。详情见**生命值扣除环节**条目。  \n   **真实伤害见生命值扣除条目**；\n2. 【天赋 — 星河力量投射】$(x)$ 该角色每次普通攻击会附加的 $x$ 点真实伤害；\n3. 【天赋 — 心胜于物】$(x,y)$ 该角色每次己方行动结束后回复 $x$ 点生命值，并**额外**回复 $y$ 点能量值；\n4. 【天赋 — 超凡入圣】该角色的普通攻击被视为真实伤害攻击，即该角色的普通攻击不造成伤害，但造成 $A$ 点真实伤害。\n5. 【天赋 — 科技至上】$(x,y)$ 该角色每次进行普通攻击后，回复 $x$ 点生命值；该角色每次发动技能后，**额外**回复 $y$ 点能量值。注意：如果普通攻击或发动技能造成对方全部角色【死亡】，则该角色不再回复生命值或能量值。\n\n本题保证天赋附加参数均为**正**整数（但在输入数据中可能会有 $0$，详情参见**输入格式**条目）。\n\n#### 技能\n\n当某个角色能量值等于其最大能量值时（并且在游戏过程中被选定为发动技能的角色），可以清零其能量值并发动一次技能。\n\n技能有以下几种类型（每行前的编号为技能类型的编号，圆括弧` ()` 内部为附加参数）：\n\n0. 【技能：心态崩了！】该角色的主动技能毫无作用。注意，该技能仍然可以被发动，只不过毫无效果而已。\n1. 【技能：格林炸裂！】$(x)$ 对敌方**所有**角色造成 $x$ 点伤害，**然后**使敌方**所有**角色能量值减少 $\\left\\lfloor\\frac{mp_{enemy}}{10}\\right\\rfloor$，其中 $mp_{enemy}$ 为敌方该角色能量值（即对于每个敌方角色，若其当前的能量值为 $mp_{enemy}$，那么受此技能影响，其能量值会变成 $mp_{enemy}-\\left\\lfloor\\frac{mp_{enemy}}{10}\\right\\rfloor$）。注意，根据规则，敌方角色会先受到伤害而进入生命值扣除环节，在该环节中回复能量值，然后再被该技能扣除能量值。\n2. 【技能：日 (zhou) 昇 (ji) 之 (dao) 雨 (dan)！】对敌方**所有**角色造成 $A$ 点真实伤害。\n3. 【技能：天楼霸断剑！】$(x)$ 对敌方**所有**目标造成 $\\min\\left(\\left\\lfloor\\frac{HP_{enemy}}{10}\\right\\rfloor,x\\times A\\right)$ 点伤害，其中 $HP_{enemy}$ 为被攻击目标的最大生命值。\n4. 【技能：演出开始！】$(x,y)$ 设当前为第 $t$ 回合，则从发动技能开始，到第 $t+x-1$ 回合结束期间，在己方行动结束时，己方全体角色**额外**回复 $y$ 点能量值。\n5. 【技能：天狼噬斩！】$(x)$ 将优先目标的防御力增益减小 $x$，**然后**对优先目标造成 $A$ 点真实伤害。\n6. 【技能：地 (太) 球 (虚) 蓝 (苍) 色 (蓝) 闪 (闪) 电！】$(x,y)$ 对优先目标造成 $A$ 点真实伤害。另外，设当前为第 $t$ 回合，则从发动技能开始，到第 $t+x-1$ 回合结束期间，敌方所有角色攻击力增益减小 $y$。\n7. 【技能：极光绽放！】$(x,y,z)$ 使己方未【死亡】角色生命值最低（如有多个，则编号最小）的恰好一名角色回复 $z$ 点生命值。另外，设当前为第 $t$ 回合，则从发动技能开始到第 $t+x-1$ 回合结束期间，己方所有角色攻击力增益增大 $y$。\n8. 【技能：流星！】$(x,y)$ 对敌方所有角色造成 $A$ 点伤害。设当前为第 $t$ 回合，则**从该技能造成伤害后**，到第 $t+x-1$ 回合结束期间，使敌方所有角色防御力增益减小 $y$。注意，本技能先造成伤害，再产生减益。\n9. 【技能：精灵庇护！】$(x,y,z)$ 己方全体角色回复 $z$ 点生命值。设当前为第 $t$ 回合，则从发动技能开始，到第 $t+x-1$ 回合结束期间，己方所有角色防御力增益增大 $y$。\n10. 【技能：全力超全开！轮回之终末！】$(x)$ 己方所有角色基础攻击力 $atk$、基础防御力 $def$ 变为原先的两倍 $2\\times atk, 2\\times def$；未【死亡】角色生命值 $hp$ 变为 $\\max\\left(\\left\\lfloor\\frac{HP}2\\right\\rfloor,hp\\right)$，能量值 $mp$ 变为 $\\max\\left(\\left\\lfloor\\frac{MP}2\\right\\rfloor,mp\\right)$；设当前为第 $t$ 回合，则从发动技能开始，到第 $t+x-1$ 回合结束期间，己方行动结束时，己方所有角色**额外**回复 $1$ 点能量值。在第 $t+x-1$ 回合结束时，若敌方仍有角色未【死亡】，则己方全体角色强制生命值清零，并被判定为【死亡】。另外，在发动该技能时，场上所有拥有这个技能的角色（包括自己）的技能将被强制替换为 0 号【技能：心态崩了！】（因此该技能最多在游戏中被发动一次）。\n\n本题保证技能附加参数均为**正**整数（但在输入数据中可能会有 $0$，详情参见**输入**条目）。\n\n注意：上述形如“设当前为第 $t$ 回合，则从发动技能开始到第 $t+x-1$ 回合结束期间，……”产生的效果是**可以叠加**的。\n\n#### 生命回复与能量回复\n\n生命值仅可通过天赋和技能回复。\n\n己方行动结束时，己方全体角色能量值增加 $1$。拥有【天赋 — 心胜于物】的角色，以及受【技能：演出开始！】和【技能：全力超全开！轮回之终末！】影响的角色可以额外回复能量值。\n\n当己方角色进行普通攻击或者发动技能后，该角色能量值增加 $1$。拥有【天赋 — 科技至上】的角色发动技能后会回复额外的能量值。\n\n注意，发动技能时，先扣除全部能量值，再发动技能，然后再增加能量值。\n\n特别的，若该技能为【技能：全力超全开！轮回之终末！】，则使发动该技能的角色 $mp=\\max\\left(mp,\\left\\lfloor\\frac{MP}2\\right\\rfloor\\right)$ 后再增加能量值。\n\n当己方角色因受到伤害而进入生命值扣除环节时，该角色能量值增加 $1$（无论其是否实际扣除生命值）。\n\n**生命值扣除见生命值扣除环节。**\n\n#### 生命值扣除环节\n\n当角色受到伤害或者真实伤害时，该角色立即进入生命值扣除环节（注意，即使受到了 $0$ 点伤害，也会进入生命值扣除环节）。\n\n进入生命值扣除环节后，由能量回复条目，该角色能量值增加 $1$。\n\n假设其受到 $x$ 点伤害和 $y$ 点真实伤害，那么：\n\n- 若该角色因拥有【天赋—血肉皮囊】而免疫一半真实伤害，则其生命值扣除 $\\max(x-D,0)+y-\\left\\lfloor\\frac y2\\right\\rfloor$。\n- 否则，其生命值扣除 $\\max(x-D,0)+y$。\n\n#### 游戏过程\n\n游戏开始后，可视为若干回合，编号从 $1$ 开始。\n\n每个回合，可以划分为如下 $5$ 个阶段：Alice 行动（期间）、Alice 行动结束、Bob 行动（期间）、Bob 行动结束、当前回合结束。\n\n己方行动期间，\n\n1. 如果己方存在至少一个角色可以发动技能时，则按照技能编号从大到小的顺序选择其中一位发动技能。如果有多个角色满足可以发动相同编号的技能，则选择这些角色中角色编号最大的角色发动技能。\n2. 如果己方没有角色可以发动技能，则选择一个优先目标生命值最高的角色发动普通攻击。如果有多个角色的优先目标生命值最高，则选择能对优先目标扣除更多生命值（而不是造成更多伤害！）的角色发动攻击。如果仍然有多个角色可以选择，则选择其中编号最大的角色发动普通攻击。\n\n己方行动结束。\n\n注意，己方行动期间，仅能选择一位角色发动技能，或者选择一位角色进行普通攻击。", "inputFormat": "第一行一个正整数 $n$，表示 `Alice` 和 `Bob` 分别有 $n$ 个角色。\n\n接下来 $4 n$ 行，第 $4 i - 3$ 到第 $4 i$ 行描述 `Alice` 的编号为 $i$ 的角色。\n\n在这四行中：\n\n- 第一行，四个非负整数 $HP,MP,atk,def$ 分别表示该角色的最大生命值、最大能量值、基础攻击力、基础防御力，保证 $HP,MP>0$。\n- 第二行，$n$ 个正整数 $p_{i,1},p_{i,2}, \\ldots ,p_{i,n}$，表示该角色攻击顺序，保证这是一个关于 $1$ 到 $n$ 的排列。\n- 第三行，三个非负整数 $tf,x,y$ 表示天赋编号以及附加参数。如果该天赋附加参数不足两个，那么你可以忽略多余的部分（保证此时多余的部分在输入数据中是 $0$）。\n- 第四行，四个非负整数 $jn,x,y,z$ 表示技能编号及附加参数。如果该技能附加参数不足三个，那么你可以忽略多余的部分（保证此时多余的部分在输入数据中是 $0$）。\n\n接下来 $4n$ 行描述 `Bob` 的 $n$ 个角色，形式同上。", "outputFormat": "如果游戏能够以某一方胜利而结束，那么：\n\n- 第一行，输出一个正整数 $x$，表示游戏在第 $x$ 个回合结束的。\n- 第二行，输出一个字符串（`Alice` 或 `Bob`）表示胜者。\n- 第三行，输出 $n$ 个非负整数，依次表示胜者的每一个角色在游戏结束时的 $hp$，若该角色已死亡则输出 $0$。\n\n如果游戏永远不会结束或者双方平局，请输出任意卖萌表情。", "hint": "**【数据范围】**\n\n$n \\le 10$，$HP, MP, atk \\gt 0$，$def \\ge 0$。\n\n保证在游戏中的任意时刻，所有题面中提及到的参数及表达式的绝对值均不超过 ${10}^9$。\n\n保证游戏在 $23333$ 回合内结束。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7611", "type": "P", "difficulty": 5, "samples": [["3\n1 2 3\n1 3 6\n2 2 2\n", "0\n2\n-1\n"], ["10\n852473158087426181 40698107377421 34573878586\n581501852629475409 3507820691986234 325392124094986\n983001573592419694 12758046154806915 391181873366625\n523432507089908187 22235351323484 99720444415644\n547133061299817509 6492909838101120 234547940354112\n315440975649541747 11555829815904864 467063676334080\n439602165995515631 4284196383788100 23950691236800\n8041598789940150 37468471223945472 3903034663348992\n6871678354485379 19849006524667320 441009815372280\n332133101579862271 12172161650895405 171736644454695\n", "62\n8653\n209\n9153\n11\n515\n391\n-1\n109\n23\n"], ["10\n12783455250264173814286920561815033129455292749111618918427759878900279810751984733300641240295647645498994599162724672629047892495532138517304022796851646558771922984858980119262334693601019798098147528413114685574056503715436537549292522354971173131279934494296523856354172666493759578559235721409803839003282397252589124075035701330994071273489705237262616797742375568061616753874936817653732331053918236491719070433469272496053789879577293093136499356430366004876174347137875860926532055047193332536966232985234902943131367685839673058435700772348235953215944653853083095646817090284623088732200913621558545052386885042144165328321547940688685206283677824239012495336775290807495043909817845678605221553727459510132354991460204987208647245314559868770002161766721560065585437486661777527998592610144754342130391951953419017996795637883263220168976979322596122704959150231743451325634540339716294155725269960803221336542937571792081037139459330357824733566717243006876271409335003836078762849002147189955692085715248990876391981766255248969629842537112053108152500087637823362918408326282337474710378962500600610349693653993027550952316316670853506306449406813119139788643083838328211821035371108143341935600097829865434811530599524028359788523071541453847264583333710123798328108566001918896610874808288975227629962146563973302514985616457681694941096019675649638734197123802474002128602378887819093164289307336054709619640526458697226534314914555408935927007541621264931926037372185067494993786587959784478212898791101939208908593012681830298437720655297000446578120709407231943461962332188295524845355039581215838303320770764898539181428691049707794809167418051510339852221874475513290850113263684417176656727864613919612116766407162187109690857320432723321345280123657010476175722098557540458136644293946857141877052604661078603646541069981640502793371518767316335666923800759018243396579180815135128964451989008345328070525364016754509674392674714149756548873402632728838590166371254746489441 44924584934298356258235247139515550277657144458132498920711701319209046837005601491725325650104446122603984225820428968942657142821237106326448598486364447934821424060473757046276786629098102167527673538036553991151541273947919892025604291204237290090107405121447367158704606912774391763259262891780036252203471524703366851604160103580747787054352898175420368862462141358161847230152789331018843086484212593329912348222277059280691902695892264715387133615653190723569903496603187488405999349317653662737078745787648567769844869079173449207207336861979579973618425342144127230835761987073422043679970470242803266680165591525343971536842802558791640600538155258124140299021534839210512287020369411255622076001574169024425018843663426370052763964519938206410908872864827508775245746148576446182132439091342389634159768379083582026347741997321884886737792957927430751871598993475295804545197485174215520946553554142369982004403301347822655088593311670803072067266836118377714175090223734357674032248208701205930266597361715787857546714454088116120186313378149957771238446809076734604509819777562794256682442798983992784805977674130798914112259542030082316812430332480137894887849353465816771517001487228826702481634158900000584884037245812401362420480513482406397747444923413014074744388374838428558981078412305694751828874536036424472521362350582327431095920954542444127350875313899455937053196754578226522615043097434617433872338162475543334536129590832318833885540797192698239197981846583995050379640905098742128786110292101587674488125232154270321372909033370681160671649283314323722096925350863808047856477440056435018490894338429353427141589876219024477179729631938051306076244246416874565368361240044590878306774259720122597553009341153034167032076164949807496735558195231891853274727424580590078545571228143320752605915739557205466685170808940973239406905759020140456486166288311181816084506195325571257785796456436314342322618444284460747087145534327694182582707201155919191443563283517335157400 38747494824482070352922587971841345158134903677937706957299078554979000613898400264161213696959780419626514843489882827363931833471571900799931389264885796060680852268380296956177808630532157537935843414998992446032247552157856432000542891503851657893782948827980727230427161405080959377685702832315987666462402218640129981671726165110123051269395991433442860368246889219321001435529202399441366581263889438274134699557132587877406202775593903912529009623542096112776930341884977271842416447501670853385639008908426571573611610786536213660289361256408832905404380583822900591210687791655768439671982694504173896423808038977485392820385621746604581835443903380115272605039828735814660821401711818639601856352838495166380090763345033751522719782678336797837843387051795142062674360832974985033387100640784846312740830468788910911396917042527059380518083709058020615301150521123821323958109313333631721204038674221023981991827354563263711070097215189823416971262460611188672079513977060016319191797286488531698281804309204994470892812968854344033573756107485666854351856329837880277206713967616917550502997590445436574061195849736842645211019046341821326776069645496417998633259355910660181224522116143322468134463772412359215924855604823837491968146789346969393924055883849300817457585642868360420670518949271943333467146814232203433930153429306269394554111755357753530856669497047739361691204973068008613760398045416010523150593286591673737667040288388747625774199973413789428573616832754510756063591544685139679254476429198760166173451813848111809372183614212698870570076468560163433343251353255684575425592093737878527625867970840551591992779555508493839981183028778838611310183372308931445734131618463296085126401128983294049031977185777097631053960342390543188211057297084934649118633078456216996692272841959873668728567294856722649798481835479581811687649444560833091325867704687545605943939826508498459439328451675261432043076070965791891222942159677083629301343061534654612554575659485714015900\n81332009164280198104243050654578313400260551479800084981524084381560176473453703114640913028814355267566577529249914014147363702153785145757490568951334307043555860487273931271290443431529953483184104096911570791495128099333034121552409684546396555569656533603319539702056218234482100743397712302035879860825225443287114760788526905645241667375749372110483782524638434244979662294230290338407174220856698902138988360815356669332705152797831173662441969150409842411086337282138124779808769828805550815440031823416805936999849185662128161867619975205037914735829949696585394145819812050032847538811573638228682342657769993163722030953487008513448492703254323756486607765011844468240468568440937488775844389577360223225823034762613287041147993797380751937733867318890767079850781128012374504286850190809205004917770282086228825226577049603469762339221055659316340485625132953555942461139813318207602394712115271414444287962751581723198828452476455146508258661556761872667324128473284926030223067861873702023772355926887037681481790097251425579152310033555969417483209174032713097323354489509881481911965163388666851423922448585330045109501273849319797114843825308736852231314916548350526442453572343436336288547942035727663634821702367894536801519804727887749062667619027610401930957784447886329284834946943925934865156145248273763419986704670511735519684685560467655386148155124542591321254399749929798358551271860407448843950184525918813741048140714880108190294254013916949814572060925250279625747646689810535371298277457301835158012219729403955929204033946526988124434214700249855894178020011112358864948265333903603790999947102841540472306398893957078459294257562347672585703505242007284808333446332800017534838042660862672840050192995501853950272373270133704502250482638588846820750792837805008197474706881074163776404110206156808610458933057993946656037474685736941894421761737203125566591259684233704220077772726085183139556134626048425941614787054616966100538878214136815505145940609158859253727 67189780654249916596872549796808271354801419943278404837046414451153903246475394545718365630145246993175503713305427127068002457734677406859239536496173722455185479704801478542678624034927166517549956573877631021797649984151680107854452990076088975142455672829738983704626492361044522043961941131197397231806860046515780296989842104538831365443682251010853311952532732591299710955383977132309618347583593402995414783354996067316741339822015791599606888311629951715433119695655333509335552208901522380604417964256333909964399656261262877089298095276424202566604428801890639413787270131630617949793299221207839952368099865805828675029242931942293566440773796611801440260880793820114575865930364645437513204868079835959229088688955572576876913353636589131001183003105505217391926041259856308850680676620238420314003506882749874028303148585786525114460361669367101414647725090633113214817753652259062270027732766784793390157949249796952943443569469523595982553165648292080957552997629325958998391345666017069511164985904795577546277787244237167161784232399154087879976611401283343427037741290820927604478753188496198456061171810374757709263860305056210843254380895805909460895461813449445292226811602489612097432189044742660686474284199410408525913090325798574593480120864632089894843204371072872624702022539695137926270328854830664232452507284897370310551213474196366924297134304904860177468655275204281377047232738671779686294390905206794132292002603893107670923235091605193908617473024369852454248776474614537299154768507480296719262177616782097487657347026914488533177377739493120554458418659883483565594749540843442148322813432471854031400600540986833679775938919096356401142899955131349940431860415531666330976231641373041578168784003591035041934081121955735560439389436213784031272267416188903784625848762642635842813021135679916490330139655597128011225331182724819419307888128040161781018847150388810878439688548948649815928703141203170144979220128083604905772683899619046336037846906011443647200 56185112692214153591737642320891492869466117671430498312224782898555308033049401873334781445152649047455316782951885261832955960223050908137202186907211810218374603767716317708773685797165339384829324237330931092868163766331808376943251153876254941023930386586751266187940398767591232663510121592956769648908167169198669494352941440910147521421753129166267606036698639785530759526471838535489372628448926184806275681591347735039991460287619076556388777705898683995041427115387708043465217931786789942882919538584014962097852127176121044577525042300675541534224845720718297540182966449630731591166799936783233741731572354169069048960309685029165473971411202629034298501500865132789040973219740668347911181884703202526751980656473309357075485334688942822829905363956465346101301608166097910402580864128848618185341590653322684230099427241994330928576165692296371474570555698426861465067488655426142448642887149147531712706444281092677176635699890313683102514275397951246902281827537468751179553680310326811042425853072974831941247403223645643209286520339730763962407422352850666596404468284127508008936960356469562423925425032253396710024077385850692948826218489398170312625251655287964953803231952416697058743601166605772257161904025010727984357400324663421672964827052978684703502591418209965350356544684096845776535078370713658242946382674379487194724655684382035371941336300208252129801362123962609477508461139254559412334378048359448259487020504819182890880752456250267765704938530681089530735425679234812570237854510837827151065925458565690767266863912463924464087193859583398311859462535001928331416586560856720513300498601203156409026935037379586181002559084419446436220139034346521821015007809471443603559288327197760945172830985729585190206485431115110506893108329459123375340185270519651472645699020956825358988288608628508476913451376461165723893902031309917726228775542885166539890253552623140728271489418657249834243504146288350321297840493130193915761417974032179804766411779973020842496\n84350987575450133568399904563649208221152856678091798660751936486316891720557914337422753845536624805754980801202659143640614641354053793205787213637775068895302437434001301004972408419310113378895015736004762599410927500529311563957081773968385636981954463571700513673000199519125443004427479355955006576685150380492360113392042315628972391820331462562908764479160032820774981431541025495452086886902574258771766623974706346169132650825396092929509366446252213394238131817380583339661286529727415379123300439731595744248455058640711207498698592248868995883798357110156439065468781073953084414045417887816101866149011407894795064260697596969313448012773967088792585140611376566624251464889716869798884028035689746040528885789848554574565731682729611420080070074313628390075311801071578873891710431004692355066582668959342787345179737701965136055860058227812657596833810394766494910090896462619074624139875870305928343657047248270385569367262762283167702552525550695169963634186449787087851105807293393610277361789742825167816353323952966113746830052125016568061300009426028935149554547199744909222993238936879652982443760298705870959854327257698024543534685721831986546039063315078786518447747409383399973071917691006080030114268295189542605141460275625820850740228404777627975453410896270887540515654399080011628994836912452341648418754181362109352227900858934599200169827963426808829471680469159206996915344878009111231170398652514280054577040803880575525713890554741195698863747847939230511445618981182246341781079758012484570875092406888539033151735448702685604563582660724100418840466994174941224316239281184471726054839899313816759283722899506495258465038559560800671175041766307962711487173857907842777846085584243655488636581792242878798146076772507392641089349530451977173712799927582324724940322196067635337158631271755022993780950532346642931767786635924330892053831167299785816724564773735921938531577802941724403258222844563555306565982792646897596956963034584443407343691163881708340401 1224230609186083090871344528234742852938978730719265421270178816295630103245961447145593187918332077258814659724590053806893902102661318997171246964657624787758566467687244105952321044294007308047421705570960162476549947228529530187087604866776023169073636478501762258330054060063724792161196516384218105293700945094615995150783659487910277872518586584061687757736700457220659137267186628195622696808259780352755800581564604191251088189465652691997167725510272817275063042266001397867863601991296653822697521447734079993651803161126041646061076458143298857926175753920129461236566443626415712158544374801987224758014471511357676839963382207732840712767003195267708380738760783857633410654273756886229176045025944959601319684884235364255743789395343479711914342417534810167249083707295213237295270098108195922614023911460854497980564221378415845669727832925548181664130381896060414235887281003371727297720977505427075966249986036558189618131953877287296676080672447814404378737249637832043691616733383664127992481284411919679118554754898361546678806480414858821344339495629710521840861344838612536096167606280717655717140396689414785583901585882866720759802370514548829196035086197893864344506359157998757905276913908242969156973100044126791940830641643449209404601207378467766615550153133648953275712201833524381336808433885533055348627837369596502806760236465834564845452866997889850841034685023820368072152458637047501689898664853127397068762099107721486425206371709793512455710930304561981510634671013319195747894489546866475381638629477950625360508130484047594087194682319481220041506105484500253033973770507474964041614114601663102027820784741604410713216181571950294507875605383658690100336139030496664607135201681663550410369957079581150627279499977257709199078528142811714360098312915089368371886244967628214032466490298434289966489193366400860611245729820850563504992802227600421756144009528987608523461558698724177036508876396116289454347654568681252229540745368978161659397437368680851114 2275026600958275730031591933966807888903475875662361454307548759543844186809238332661342101725523118441719594954261734417160477825311961755520452599891630793953453155781459587212293216318654166133993615246671173474896093348445058604635516568835969685325140212486632895083453401567304009631671079797146775036509103193044823358175978381921651660716917071055116943067312144853210171181667114018014524004461803401659345029754568214976517829601275333415017657965027566730209099001991570204952099725631339868759629742008016191476022647103525473582575137904122933547509408130255739814848330747776251288317155328055957232166289850271482944201091236330300697078941015755262045114670819187652724377941806230094172380160428740272794777162356026943419944294215783530411859954498109483552197039651673653321531451167744467110192470320407680876797348492593944968643766259727779033641766907531810684428324859807937945921271323473408412036124770154571725334052299645962920883262826020237043043095266923978852557164729241396736043340267919136278950471687239853401213359112329894781389541379593595583746592448369616102995763873265831201095911154086526926767207965082823934478154605930374103427382251599370603342305014856415816070335995785793457305437924136525372428514537946025686376149284809785390806268757086530491808142321221549621624390003128624686736819921285811159880479895357592392406625220752087812517873648214531075542528839106772292684861982207710474543155068040802055804114477814688245560892848042272963067624063996620918507115144056416296632159885738918257708233832357871548632215036410303562450938058624454082168388345239474731086566018905658507771824609272356765040195643784672196551219894545416080284488834938420390457302539683767582803847391999776747830524662391490890159206714043282955583542183703928032459331728048322631919147140994656029262451828475372511174176169141378604983706620902473162340688952656076730553708938187023375175337964949808512941048856134940237882172800856002383391098183871042544\n96775284796852884391411415668604858087504637893768817031348743933802911426188253949257197208308408628852124924949933331821512664211690573382964497337746938491971080208194652439855412924204747257241698093481231296506425566464567909151164277087402737220694838916284865456352543884982239710005770084587066275895920189010393343252286855956453196011847419082807472195242180854041227722239250321601110385065403176563469251065969164615182283683984006872929794126686167219497099652195311795864282870334017969621081755941658037697761106067815673867138896248987480665039470857450598576239274416493223493171295319060495417707886734314784794164294449588059373485929796757125950257057565145025166277150247232453218328842406558624431443339287371877070418875514586196921357661927915178820018859115589286655509654510421410301396972484467720146887744746924177620276635130620799568328844280319481402122079959450476931918190291446896878420117661167396284487124202833213193079227440720610886585724503649174699302062701405069547843814437398787217572370093605867953718830180496247966710963048933693807126458991682399088761039811192867301882631130921432709113992004416284420757285746311770182159089741745748970468400992408763219073070304765581467910188116286827129674553558951295383066670352121321235185488479110151955509067852304651949501432531592557213500725108607655375819965806027916995500065250854159012313679030131207152961091165360114374949036091748765850654070594240249392807275655083568742704449377253416871090747704434802036960772714827462639505635237101216444512914498045922568305542286170467446146647209377686736178365249328686321715937116036402511852533030976093494618494123090786360380349914238970027505436728530280248274722980268522015977848072489556807006326095826626032883724175812819915080453304772539588420861178233444248956249774243057955382812622781411585228496535147627563693052796141691998632084520439125351938739935582093484517131421587853507029801561884247024669192517509341894058117939269153163122 6412614028741753895851812914100282131747759843095904563948949057593094375697786064406758418681547754808055876022106992839263857039352376442674865659671155463383424262532534450904330889849237372603070931573829127772051056223869551732119046995123776575742450901271320543871539347619289468625190270701092360984487313635658250422572364781741592563077687217845189836872581160033890324329961060071569260597573956657305459091700395159517119878889453966504156139926946242387685698635384099747638905724061849329519674559657633848052949456052516756122985928643264625038170997887787545776812962888340846335819712631017471547840278300002983088304212430269270729462364614469354190907693075412268997589993936501595704297425027606259072141586230695990220224492294901884658479608322050543394835654135734366982768491066490987995633336093796604414450132111347045209445252667050929308447321995542626859422960017657323481888501697033945582065885163924183996765086671365521868435402007172764322026773466404980546923419150924277730726736062830562256435514666041204537551054765112689236304174595199703453156427467899122190545076537322094942117143597436123221772446996481295466638544988194435668652442900037683086636097010364594953931112520967380487814455269612509781078938747636327165458978340441497145785255721240788843989625333479878596332644795465931450117746676888678193268195995810234436595466499833965395617927860275061012343539394032784660888024104814954953740722129248566897671270128182006910548351484290806910574428163408147719913264693556140375583874104290619562249155574142992668992888816601248676610893555979163558830953938610215919101287706718947682462640060617267863394179757552193102534097736733147715463060216220619479053276387962485266444905629945779730223932965604334886120923675069149310240103543049225539874223900921978567890026395701240629742194084509746144891272933740557357787478127592437983254156775239720696371811513485060748736387725411290142534771625341159841581784660549279757836579178954572258 7416484118673843516727845676634962714548111071662976507136467192537896455457448881887938845292726237417623019550630048768269797446213749781707099965218640393652520713633750790692403312155399217307399692037474818478549177695957741629531786074472486755754631892813065543924186090264717450207848312598663342595215460145112915976409483087111659759182944095447840364234122403004576146644341683177206196492368132971587238142376943230581458388386990526885997334420447658729059732829145484262066987222287191452603669871891507916075911877596834582886751944031141693169151513041978992108128515342058354000969017461350968304661094087646427980535321297178366843411482778971584524479485355274281773216654064334527020933135804643776964245703977673167757861691029403375838535517526699964583572427720295417854592925565691568207034949524983090976830338564585535489894010528839652349173327495032064720643888267140412900068991709346560266822119526324338631663658896914977199240923306273810371076916839943421383505398649575411844354627425899965232921752509071808664508270399291511141436177230832198613341213447342084336053980067288592203403824739080065251598264758732848223424154911956748210808760478079563343223520171277865182439714329657890551829781174378465076523651788522446943493686904303710113444652419677406065739161768779563039012636405469937324251155371747435844426590644408222011559146485825449562142231370915686101500316702197008591693703579636843741018573253966228001350626289914637849827047411502711557410091141541436777388577967903294145574358247334138999826441675684709164837638899395395698341036941888666468129298674808328696944279368692279428541741994536732769841010458077510590514055375750813939363334253757446416226584692159524052825055366809731599237055621949808371726357919550278092912759645147809696979956498414348196145350779787239774473479906559219393950723697800524158714778406211764533305306069885038398113623176977875822539604313784173522205959854783419124969305409515179825009531317625735124\n6158659356485648366052085482060205090663818370502227399330647623634187689790570651826136840672096700669743101341667492011690361829907252705326633228528266149737889075916278517986355137207084194864778793206462408793830624078070988071894762591160712068826908694831147590094897419256616795418996974979227339662663071423626395383417592177334271206140564479843631912095305684816117712945774408911040577564379519477320390548334524726608768255743238155894054281468170587396736345991250145924282869464972350820570373139876841309110371451196091237349335100025060248325378103997849172446464968599525299425443016593161468466439924150071407579930271852733166247497615006811664960170509296175820218675045703596909323434554858771572049193638699156203934019039821469033755683719566739087305111375038673991213820806521403918400227188936690242168308872721338646816157730961722552744139184776914739920492777378822450086499942946621705025769668280326949751283355885613444262036923234420909228417199302590042740848819744238613970099598496906384993588646860747410469610177085588343099682072433861716748521728761397383310596311398611873304235565003846627246103756255876066131253753824857390635550222169387648891129209058898854397007778333684451324238776081247857007384839077357013790615335688937586569462860801233591211109337024266872987786147610499548179276959948600440957343182480022349206950656620723620716548433199561393526777412486534651076779880021693589204197615811460738040751957052401763637797669638084575582599856410730017318691756616010375546333987162129839236780574228687334183072667145747533950011747528115860259818642393576524932578138447313527096622250093486470001032883876079403207033529786765199063164279344912692057085804014509251364230872891160471443409575958033979127178354971498727100054391568864637909784474283766385940025983495216662971264322517790275066666135105309597397395510963570626005526454254716318054279702140238873694910205782203085658489612028768871332905380398423614322865669908726160639 21102177223164868795722447331153786297407154237009273207995817107023370803639341210247408834931175441495811560064704246011124767619270561982633685305682140990346235928968485705353863397068381897224132326068530689819841672522242114880802377812229876795681047433252325975010794153659818022398674413682966964660417928854010944837250664607555888291292207140335958782125650117331306673041936265543422038046876946014611763156528900427522231361452158063940896401556527195477455049055230236995218390994179605389537285615307945060136466080719458519395693061981240084692411215465832890460394002023066435946134577582222453191490844209054557378784667280862490154660222755577844802517725496367808233151770642510988746863842350502633156049785970017024248624460229780380118031911781168976659826489320846190567681524610865317984359263350447946503657524057585330216290015171199129345848476791519218024694036380913467591061857410810819419166145865266866079242241004574687956657008844236700410853039159385821015985768716005454397616235835104487125358432748336833197208547043809715676413952138242359024655364676361699302756490990851142952002759604124442384335247090709219313818971092661894250745643315727730680720433666754570788017839507001794536791930518670148616147784514430754588269979574048470797923048621002919605351820758448191869222539637366190289690926880665173779213972590586136047115647061303795694514915461990924616728141396417120315765171300064516952397635950918144351009466904826588181102931616550759201622457211537389517797219424152722236077274510905998741133824392482159277503865733676664020018213266911440950989497202214493690462134256726529184461297830537827126329387454089257140359369993835450354428857849426693840889473982566597512832624718015607822551722783548719709932214007133858585296640605688907390488007615522622310187524716360440537246222293844759051593194408569878604483065163350149375173602431517507688487949741012044065486792749870508490766952174921721290876686832304766470611182938539790828 805987277784173363235419260062224908526588772720678090006394478285154504876630189665064141083959913496680863552131752436777382060201460892535170601073777827138593591470805404208074724609561672615254998075555479178549458228370742412973843438554956996971865802959081916506756788529643597529315075842006157495137343909915819461004517193481950048403052734717664795445877247828297669361270965150126208650639286468031337438215547689711963366436222863813777453592731070769750260229404472622835611279513673913421059438031111375322543447548139539941134278256116196306802535171122339465489634779811079470846831189512593652365588302413446547970294373286010675461254384169660863295217042153778914148837839426023282903527290241700080061650047120487312653604117625473570478209408973307976763755518753389306375166012900636366489576778375099503205821093726608966602779627915467784829936762756109193206022423769296738837960339413248119264958957930159469959831960281531791791500719121342457212560968842424589563240415139304223901324826606493472461245168356988350910733960278069558260875818599953493480257007576373021001496567056458961248102583973519372964923522404943626307823893541963565393241921661988137705426787753277920787246327239505915553328217387211981338858920416482521559708272593792228130149461660379944683393452864326411103909283626743845648680274502559853903382881450294826258413707301992471828012762031525959549976892693772472332001184490768441123366052247248133286474506908071568950171201437496484272045558651652775618198097458139758205087952996418783532190564498441815482461910936035433970453322353074935059888195531095934924049013998908360464541223571445763083644684454553725668541089328673414046269092440753744533904613427329552962684846542139239443844809238030297099837655364247463960963745975879929164422299383579897168942354316265089805981985074576382613161528354208239194375159210793989617424394269125671060005298015657260022569449637177528545119057106950200394514340449921040649783758563311216\n33406707748543891057069392011094583625341657022134142656399818930288691256894827039008477180073571565608059337375573718533291142348053797559832983419619067070125902967660636333378209815574837363101608037263619690716580073348476294384835814008293663925414807221973468207305943873348561422781056595979443119910313349935845848495709426691302464288631985207270117037384066401574062785105342261831640536535918534716353330406848121071158196650583320327596624096636229350779188157644286884384444926729678073199341676978012076979904265250280566619050576387935624271621984671840461743465632680243516980899076076762609382511636028553048483481249876560193053416530717995813535481216889672838860700650001692258645415619726969769477737190256899774105583327461318494458659628781345735471704608842821713311897601548176553792796214681283765581283934854635162195426639064207064413662689572465901648286356578985127625516136733480761512303918381185017757072886644792311906782249051760599464933648158240092315830631975895317296672483323648688705808828076642494613363002259348655338243036359631277400145098994304034281787679132050617327219692138912576618525701304854978187558279561681135013706645745781778698716598211856613189298019946696520526420222745766335473675116199922402935902022547502861910403887394662025322697245330851565463281993860950994405652769244354061647569534505123742746913812202944153646153237087582441084910965302426938882261186209710899155408226054041767180638239055177964390933957014483167879241401459010817221634511439612433793857226129524284777151773880733390080311618071418183788206637523523044190750096637133987859180024897528503781014804716548008787131039976728098271294083898497953363184292434778822031298698705249830976149117198611137254682978383243690134529767095005732265644343192647527920257704772189059414128244654189500318466495901894368262138402461831113048231880088448888119916530009563771328108164072117056945723439728317268784606904928015041969330035672968722205519220053202095523411 212505986337520393451226680556238605811774909765688339947390162465692433729115611137181520687962445807583747974460157318378911039418101450356803245195261004394755111457434659324362163429681780870457115783876966457885247990828198098286557187294779642704320431068920240312604046192158396779762345500121203343634769246189704655458117563843180808185647687203065210768017861785469711843788735342982716558058448945339724932684749152240154709915140376765987726363197041783447102165729534737598269370704388627458485037446069832175243647686177327832538309326916129947050544730354199534974310984098983774986254313330926427184272499650954113973478610334000092314197647192333627697001776553024558540290084098798128344237266793549515902616192917718272601313502894423941445949190098971568626672160846530851680041299782589473750550488559806158512450518677835303222185238257400830697889197105491354018056097983974231049487131906925062445090740016527377010730165630449280222307963895631230113281720241964159801857053975437289449251570812647482117449536909540523490304774269986458882027166684802820903226725126899698314838249056812347007614793698815223572323221109129119778544015522959467365265365774580892642061504384883624345580824640075294009304070434545085928275201316114716557247051328765987901683303903786407117276912404934944268558720281968030948878183379959873734078615528454575494345248295223787241127286452233451035544945230888635192993148426610275756271991260115447279597135438570867030225910909765311464035964369095685779840824055740278018009021986388851703969306956980262242839940376085102531945239476505974109945168238001426660563627016860639940279884937896978897783369149256726161135901696793608878946192270105975872387938839516776557780724905469408815579437719285759546512212121634927570178109202105315767795101751353656331333327887596900336201866902727841570220829655619306435414158707811770908915092982726059215003901242692632077182525968513934863067034494847580962268429354264333795821427003537900 25758784573266142419782163811428399568169803000092875527221111572985243284731829228312077637894996117086109435066846350613576593416823423337930630829232291970764954453245409120718556138863901998130126552757905476673940162071974303429224736667100157256003524644944191534277782601163620598912237588152444874730350572561366923837425681589932714279279205472504062039649958982008097988026219875161343472200053466067319243376172575073531603320293823567398088334040895612526885903823999297067492264986376437375645669805173457846442129881683983955215797501976661104565027073534694710753627563909249842589404577606859788425160249929846757862464483366922364947549650552758585829351783598401812732919474197172860162542150411645612889800103127432743945860057444719172010807670288869923991890441259266405963213195070766475489025151326698299367922424715531200271189258821423528067039677098381366329688308370067326966789335436190051696902214802256076423419995774958522328565368962256775325513529283106304269197463280611073430762286129468823230730011241116615618949013093448937920275312418847389324454283801001151027737732150795341247772589312219832755312491229226213285673150999434317742848097438029024778348298584225511226733259418128471385182830469614645053005079204515149912754959148461733381577575439857321454407143326126528026491957668965638919760757029110618632527240757498963769444271593692966386743389975556537986467507624260953108452140706406606201947825481910922090700134754680036697780691485326198196932697847395469347081201734025328551767885172208268817017152197283741823230064475868773438698880691820518497065734041175925831983739413474130426360348702803734636433376776495134020403813542314586955404525007061970850987209343171655175887138016345512131807103990206036653519891975290770469512256238368547093733340143279589174261015746117570619000973590399260558044070581410054817525692081543058465108526459575368717678197006673216963346824599407250771516682771793325313672576623473364336734968684818703300\n46211008232645482723168432341933624196342917963346614387825255673339518064948566785658753162011224263323538372064154735806061810497408697363336605893842074469829156710876196477409276656349990815356079114745022529048719552376561310604679527873777320249506809230137367627225654371379190430661681674380533106208429647152483212873599333135901553735868477365512429190114177337007047163362565385343629504218467115642154545589228542436866701896847486020832466753398501710629987032288881412362800177657959059498046638993041672290555030655132401214220159171372278157167196115674130583317903412655166006848347136313130447432662149698858302401459088112612440981411845221766848136153805695362983967961469319627002444810388701073893023706375631690724935379200368445849345935128295179152191520659235637940059989195364273167686757953143037550373232788343826353643977035575701965390929019431805110760276907175312675836152550088477309131306203809426893259582769271168693999135873174872862822999695912286149011552274723489491484350632057310436243610004282599229326864460742999356435995382844104498173941491641713202106579670960374402595756318433853020144324588048399847519325838204999016644429285695719988766854543816708512453830879625486194879793955235401871890684125077911157673523822446005439689515647493926129540433211419179497209240404684623227356053175650231073821475295573814155042728538809555277679154225409079928235130945513800736895746675341782247574486195413310728019587982875956576064756775638528420783865614989287281884355234030782927618917952840159710121692500222692046512877117786435565847959515227117026446744929052686453258962281355876807593158594023970608214756419095654995660080164141599701263712589439115672695392568872228134301339674975479439514655177960517406746919018057439539367915281941066030005756477322456671171045884084984515575648735009345393756039061223222476677811394470091097410164160377480041597602194678125707642167644982340212973678749733080959786296683229328234271983912568648892287 23535144785223664820795054118209360451083439023597655195754608967916851170447960799203368959710357908528514805241357623059718364777662053250971925657246802043284276385940865096330824024227098580833334889121326560506787118938300843456561606820784234502753490623336398155163711305724696370549522501466036841639689715915016923017386667653880991816643003049061089427514871561443938919875029002760992612009672620806956608409344058304446991543126748113631922783876626327014764202379591114449306687282476010310569782172084496348321828034478754708904165372392291408916310908869842096687620135864925911181577016475435408486214744646507424293080864071969791461714305303697634974996135100971301285813600457528753562546146848535360978083558352271843770440278335734804587042772643583268108226055536360774879790675217240338087287428261607584015939122816630447439568192124585154727073010619109987525136196564048578530726012381939791622236362947615369417190366076246203185938701621512123329819530906964522909789036505336244724429654400682684706925655275698265257622978386163547628848800463427300877515313630999337389827674363788219962050190044069823776479723659138200471629377053993741110302549225614159857499011009363994014046104663331091094100834930874190016851177152713577516281103529771661929387180962737523845760678581541505280187868364124960322668231458530637202642194838976482458608174095615048250368519255080755003001417018987385641059139678058777313274458437804088557306391111956972152968732027175855837983505827358286122557325673575921610645190651960832976208388337352488671509581895043304344024680507240899622456722222215876098778794631498430219560952462342117949074673327552528137845340453102544623761159816229795000731492768623127092115789451713609369624779008526563546529074884948316330020699062600468711134639115168015067610841518582160032817537182445896357200104736279812110546815328681477486856855112568819547746351537287104556355495225605395528936137515929303172619128907928720732758729438199381988 12440405276747938918908727579012811228514747029681601386369016297866017809667021040529732765137242270130494775713939683742734878983447691629323118459915804140254573244782962988434052572379949350497496328043249855766946198902353307889662377712624223578317166886437183169659628250053905784806273820767145632884308283247174327550824384247550297826258706202494042462427379477159484473650139963395733263185065708509772489322252326693401957370716560265893330669053404792575614562022671918122978485163771052253421728163230947533008710438378432752025100449882402579347115496622747218296157061743120071212314247059983654274062267326853201436599834736516980386750415838623871041410187744713390807943005858287203465594881736805444081992010896579905583230314041171570166918155112430087389695928885334057840875916836742709624249760637827889620081185326721930349430070907557901238490311036315244668138031336650254396934630720365267132276734825114796838725606400731846909024056699675798332393139964309084451953627926876036913724395924863714556565463433162182791992789073406427546554031809766445368480872854671831245969244442553557661349056077816306566277071357276076729649999164611154032647464298887297836507957151919628917090124834024263148406606217183910882579759081079288419242129199960166337982909960165737353526014825503310035146361790085712483326943165593206626124284329249484526185744886520114326827473993132265767268190395431820149443832122219960770084743167948067768836954703359992616898671215798548613528159967303979121487358381457662936593818074213764467083673684724282041177262528885028069142520097167063740237445005283860441621164722646888192510544863643192645067484739092156394690646470686368702632865216701428904696584117338546535824997175871454253935160246276380309442749048616432151198415271175500256854453672960305259263243721999994367587528159417716117635836015968654057633191661646262098700908521566923967071909771999204041213621690001346803948247225191487731283889490517955037103122520697662288\n80726067561942906197800970673828607803786462298310998667700633882116120100477197813831733405144552345844008252555665630506634178745226853503406548582070328059130417010725532021013775551199177730031871176635075446117279605951301406100336516959477381844527653082342954274257416150618324756559356723041117701162923001528292987583784316001797166134349275594899116979538286892388149912005721723731473009518839348772405562151948985050600629103993560488621363628953963769622272347553023185740432596328697343062475483120896873330021061868869275437528693886048815042878514946808507329053566444439330201525090987276640022548615399910779655338395802239675542771119035531143382022223199354730992506623993898554525141678274288390860017396109229673997917117169380513003317323937799434005744661835999261004376229919345515741599418079215462657726487802504962157952650078467822556790533188915089384413940968875952163945044045978858086372831319990417834063709167678511724317389163607555049050892847637370348484065190521311323151453465976172203982463685099699360507978107045672657962098698270737777816134829766754615058866751239818228000565388589930561845918255627118656882387890626493172707502407375134168512954843825470316429655872959394882066238329123030323988858933720248707379310275499100772416488340907498610268258155732264421888515415381437156647758986894581377556339718320818487369740297746605980985765053466815044244470841983248877772871653592250045664203265179208271924856616645707673952157545558992697524822372699397679245969520694466643317558459234400651888665547490319309821511928306348951320989974271230884067343143746337531202341400667838803831523342169174924381481267224147362377637470605250147696717720961947982933587692289637476659899655273141820932277400181214008089215755893131338031758899486122805831637230620904575985853407930425368257637395746496952551247307197069011834354529040103220766587497402490914795011076282026950137083131811085334781336628862463682088843730735430095588910336648839877313 5861364899073818060455360512027362558247959720930673379036386415925468346259865453512757023443146652332017600613848235605875711831034865533543143770350794459553341482454981838089761160931576909387176972156836137178493500099044051419477965038643533150534833929182505924123528074523423703700363670678698365202658220148728043284969016585802586371203451288107250421995831486626220092606933680252081582853527850960374040889083639988030294440104723174307219812003707462624798283525110330984076221724798979689481424024747329119680381257964456543234980003193109419287098556896761803489881225043866431384305862094183010429205660731455273439149201858790660539656434633941813910086558524028714848367676425863797087058535969581588921292590030710390571286517634845215742859343174139268027734598625546344442696817519070067410953970361474411615877282731410965472517150734452922195760744328385386099524021352943697900782817705170432884711849778407291925972463793249698445536957317811516729262855334808267243898948296972438946355671610030941666408680675407099154376463444452581212601885048305253263791436451510052804303841146278354211176099397573803267244920980909580343598664114391000762188056470280891424891443346250666642732529274797028587924190650253523702199688634672619963675368450632195068107735002761810416063707995579829277809323345851435089099111971875139519544148253786394546807582373692275478841686532757058644599385502306144706314024772866827434429183539609535184756719535527916158005034255699974328736554086426194095430357236288024221206428714197042996156010415778117277071423294217084996300488091171109002908957017357173361921268426986380092214949650608843036196206469925522522942280996783913528551406089610996699246313831243736926120267065045848150227202441258060499674626853089969751141639971110402943468364408422412732156605359660740210821803087638385423068775876260436257758870241723649413963049589933016409458799708378847594640842290503695450474977931690455272247306747359293467446158604735906432 1894434909569636718934633713058256315173187272055977152569734796997418097954947467507424756534256339875208487943303409543034447155802467407885897981131250587341228085534126148530095774632860962043631922441325343502395672257417583013414144653679300843643250099817321587533060257230901128984167395763323854199035054227871853566615073528336936561594793979434651653037716218548034483849097312055178611047302216364879261182591320280667225628763114500219830788906115379221276500570031909362138884385138831435053313231032911234624300688697701879265903840260342191325680846084294170853274070925262918136271941717936057702611353590760264910350908007461017608796615346523540058988167449992518487024446859004438882310531542085285036043152592883575449195583910362791172856839852162570373269478544283277633524498598158305553851613453865194495053729302962901703553229444381103595252984790145070858562104457975534730047732365605755937444048769744485827845061817037628182186427770204522469068624647472264064569426544680972157758691121658688990513514036509414627806006329894255649821410175487287365779725218517487681111748974451116437946344069566733818242576313643547732475420065982731858086107426767274910152670040803409732941266245035496247259723152640225748590782885836636990775192021897875026371129040762952654189122074070134240045230662052660896033323152221926198019921578524846978515200779832596652515468167612680596167499678760514280449094234901145700313185777950818739079118012447925069095762787925518663887118214015577714550891665097290312340698807209997250481868050937340630034271759662964717073521541874669379476802623614329821363657639259910909996822625515675741374093205599131494309759229198242434227027018104916686303413694540708849131961812185067490927492680945475899099672119232379463799164124178119767218025267135831445335836952336835847867567919673598311703759921807390284869606013973972780270242057156727634000117251115561588514179075718273724185093936202637039566232682192230435814158659533007660\n9022350465366174997283847919398349945633938016104425583860172324176263489361275975009667593038004932687667364874105163892462496885314014908643263326856000372859576083332702726365803964965612459510217293945742324165460877668241497276551342282668646943574832458113160585492183415883647501781717889558978865392772224541065392167546673474741614500160191418704984200050694178212870182632344324620453956363326887681039920226446997083272316385388521326434541090517952433950525433228949943207791117617336586597055185835636143165579863319669227381265651295860327700836191420851833096352355364158455759936349295324840755532195834786495480749596555898829057263924800464318647317952410319136211113196702055469248878152343235293998428488219981553746620981330409457732609587036046817990777041527282479214574080206817435928277059939288849600459911021713775937897892405355254315126569107158564247999317316718483427722955425855482016244411019914948488735880721210735665656305032527979084088502142907014707379774982155237461271110239643442182704616997425509588170510879119957191445286648203735778500178463935047229793523710938940856892769255975677373946536876820289525221586274769960397963148312478510933866595260166008038569943390972312367027678277018588806705436630234745017725533598917717696661761449981454029132906017277890180578422965195412928393259881214603112162460466262100899824011347518062666252858555941834289631186666429499627092672893054716300985128012323278130308495384439455957536346032612317933114304839933084600855909538890414149728987486776084216057289261871588036905157527996581095566604827725585895684627520610720098597049758606548020143513068135008827983614484292230055034970426323155692818336187550647113038707593592987411380313998875932511436736623239997851326877111264915889575138246573980849287148083870425370090874853968611767112024269808843297017204512317422795496511790069287123620934712807235016574232281446632747065243918688321172769768658035768847021747500202496722098981212122723426191 1058699994567456386051988099789906882282897056928675755897254621570366716449454996510283857083638192071817008530465247043578186434946918889294028568301273439962763818506148971675827938163894743053955607916598088803436520189938566781998950556796212499308212484403252622244410854944843773844980312966376343035622063664095184066333372673908829539425847847206454811981326317035401090156833262316513361800521426521383595068854784432026040111597545873126659983942386459273309399974438683726439761945113432389174952261210527484801478796707480533295702234777525452119176262505758000228932395859429139171755900855071518192355754722709499778279693842086613937782438036359676996800592750727234184052949718377088872899573216353728562388287307027850207917859490190081507157679337228065576520106615049007029460254789103989366854896829904728977024077299283132011778098938254310701807712024600935370235989779568324535443330251228660632530337167126327167912382026646507946716969152055758403581590759923975869874087571459658748959086489064871939742478982007277060690969983202505547220593809031772514573276417779804628787991237258838355748174562331235599037687611604915645017218355720699759416558858588985701341050750427674194123540281510484826183918089145486307559577717585044119195043067814506514474786200819408641903796159506347022266070908808297970362892218690867230134703308210585876923845041275614783063315239645775161182566313752305923434347670359998750065723006373705860782512535436814574474916656191776450075760117559564015284594489869981194881114382637138897114031534838077775401813552085067025360920160057552244831151970638692864423056108291008227979430237708815473134005273435451176611310212116248360141662693085865512927552718250808087969470342138952876789139143434474670501618870770400636743385571856286514152985116257532012850617197129445628408472091102178936374730408150742184376561351372601819061860584012814517350674350028052326401079723189881610955613598594550278154987155449961930333156849417263850 90291778555653550716493489542237092648376821343798066802396897320460083119408035125492774024615043460383542670677842854482720262234910465211522006855178566450306801553545149409367071043366034468190885139742859118664420300214443797916430078105503270756280470328263948869263628832479836714863450254567147551271091848613597295161427210316689678422338676771168867022949759981033926294153106622753829408728375980226896095079451901665967219962815675542238174816566644168754300066032630267719430542526513296155344107610505357310272044998227163107602477626814962864721885126262509683187862901808919508311763657336634522653548788245491512003117918076084793361550686098426584796821463542209737852661794754725450661638101737144533890630719128116166022033987180830784663532448695424837519682575788580641992175491112019952780415124223753556516014129256436602247328153727225076752804162498634047964081458669545437057156523163544840185411186996833128555354855257353453509644619678610825845149317482672436540525725916754095931545261993786086245740912590651063958878198048186776177585955323087390626661758696600467288998427845007776090373208635964455924721808169796255326531528474320908057724474007272029423689869138010576148743138517158964539044652950682900907114535359200803856270595331575177719023985693615634599353953547497517828427555951982457134348280741098108778513306873950292762724992282424481810778898240414609079188685467032694027139207991169681691089307681827757093331790950778147228110693442952443348767327939497054118087236782343905763684171896427338823079523838936953603935676502049900624123670462843014651117999508751852193500562573635554259610600582586095461030961795432841724225498060925298912635795202587530522522877561469815756657208161699603814540000180968487882246505488910918137135036046842825020083849435984261455192124801811574873036423197033315924382761958950762329982789532467565514400279651575019202638122056269706846436324142958722187158801617988013399462193181028632790588614321674250\n42034625645597317079759786587567597620818135981519245116964305703195585958588137015319643208245432495445385228776918868137278793634039559082988064708878845215760464045435638349276604395244516982648968811193870005073490149079749988896567680372252938535440043711885833247299877739281291945721732219548220032031361897433419552731756188491608326088200563733880701894506679097474652849163815735196431967789681086040936911921259759140949151028601293289531220073210871108161977945133946335633911965723537384129641123185144281108735611315874021499737099153455246366735472569884441236762624268813540966600366572845616962438136560377549611751529168951940843130701211441910032966428554877803642477806895439169839498006165622838076122086892663854008685851048975354096526669750089694798655644849811524468234431980953265011647901904607257484260299377279025716663748286465855327746591416567251338358030334965777613873995033560755074094018961728450653388971685618835605349524415220665996064057644276171179883318244148681424281495607004028836111527303639653542646499001391727251684600256798372206030464612151222381648282338056353779638751829472031597084040184284856450132453699705265626187668901617408812678209890631896542839806230749056471150280344691655112588170467225917434916720983195909005227353991431589051370836357198884276999781624617864755660032200090322660887634120840547002704663072688612325248736893516235951979665246219640176473804111847803055996402592598901957659786987402990527359813292276370341857756399112068520078347241912655854243544103036343280733288656531684215269564624026269009850991140630471356262178237024658348271863517588987526515341583602432034531157650806000598353956255264515095785459727103878142305598828598013631276999877805049611197369783793459410118823597772491040504676767558953022390840253609096489921574511147593494514798226210630688817315826047329610735034953240721838195466860963172133519087929050342121960466161718074272809726634064842934722244243233313371232626401688761869203 14318694548450178955732351939004055266562398661702795582425519810966507508854578807695360148251306221959608022229782583473972069368827803090486843176421946300758304055804640646350451574217622333462637333695107471842536420426307571744050340977886833263243402211201718040174887618334950559341064884177183626659551835243802122974095175062667601895966119822102014089697200954709670703122405808224060542246226380066742721963281039913720136183196909018640046660036828149751015464724416362123027922215667451098805881549847617518967353533276586076219206989092983976735291322426266496178572094944079562926758576758995851321052043660453029305185123174434137405231656099859171807410123225286587442443698805523052163194439851740402619473556113431874499707430440328967435073617760408980909690113551697122565359752661044695205174417214058952639858037928539771569689381771011930748458443203910314170400449759775142177259696608615960672520283038705347325258932766329386266007063224434367170242322297324510238400739648039102932191663551030780817913512008465216433104478646835232909034121830606598804331066677002015096590150806609968008188901879526887996402914511695431164804438067898396652670162587135304605368494894011155311574290644272131809434693932838650350545645541411492266863451082436733594122144246826208121855480203014748912125205336468257370385198878125276766090949423005507565767450097409145392650842132779705398036118330873918471908594709300830522117006970393459722846209838558355747425205287117867871710030279448100684435606811188471296325847574723832379715963751177784455176172284683363980454246986142817712297387131169677294828557137362786594662141014231730670327101372124317917223429276711271944805939461614344495928850457673121752822775772826973312002865692332622120290552734056511165792619412996081476985203765802430125716713507892299022963452891946713297536100753376939290767181104499742765323346488336921953739729936390013452688584309139846950933889077360963752270188632984752144816994603199233100 4571197952220902642199822260426493649174810582709202279035389490325773583696103638593361743562743193231240756081956826958411672562481519294584659826182348040731696539364525821109014958123599098074636455488258018399601145233714028974829597636751851506383165461260945491930881077206718227733809267062263893043331978843529490079522814978320169067785856719003158410021831780988623287289746342834259072800282262374878844964426430939689378224698917053865591830977977335164752606209112101990896596068473347520334218852346920594155205772675878912672532597016053201206400176298024294489656125349812623291181821859253110854540672818604642666783187884037001940338411786929111179925015039680202133532451634817597245820709721142010637750091163778221348936594714731062601416058910756823859846509466385937452069699191666042909860547578174127751627988561968921554572409169567872909314025796042870249840392080634810080294767283114828391755042573541855747541329726309111084701233673963662274839780266337938654555897865710637879352946582495222470955558041080165095018998173173159846782186843305288131059363326556540086679910935167560819550476491039849469228262876401839146953378291886160450076613263875094854180279611008895691314320837275588147552657315990677501507166948521124343525115740662851885560364182407962911286638750325126729606979660946803787756078220784506691812096267182601073864824582018953124723298409658282240551932951095510878096999399781099349182393606838852883232721982562559603741171502918412089894118997685230632518536793384656581578444262189481829840774492154923474661940666906688030248811541197285916358878784030362021788057670200721228914618579994312933588153960283591269950692938445607566561080156280559559315393298039082228289490343747716749870005173203032748275295004067530267950701091570860738672847122281103852689139506733255009158105467859238497297821097803409517169521962285291268852157160744181660479847051968748480614600415494828230176101789441913305487597506279154665132704288880974940\n", "78299676090881850562479442596885275232341121074278284851478038310345605992517416134561135341691055886772955171566391029800095806748004727326149614594477633642501025027105267183304810244258038228176248773230874083637980620093474929422222851518823355752827203418869069433751519250333873153097071840500699588916542538447569700689930504513184464145079269997987022553668233664350370195968477428116268848290669358107858811522148619871920710981672188608584950983636266602738161753861068645022137817119400093\n33097265104199847767189488302651072543382318177434155466448252805425338433107915048908262248908210605754161313401514020013238362579336071970484568247433877586812519908303621039304597746898538004923923337546359645832338136260806672116305031259289676295245048442077286436335999136942798650764900279884341078712268507817476698605715392827762653005304862900768755495669034237632813800483492727251821394658766505741199857751899054637489537901717408616749876825713942503519167615678504972110465590743589443\n9039633520156376052571730787353957079218872301970532684737975064714828387766080658480879047539494337793677137312234019438325177991546539704031533877323308344149474402822810987150317424359078551265796314678815105692150911475701567040681691802567308571921285556799768816593159863834666015001095780223873524280253058765456143028713605830375063004586136882448530457457981532186293023299682526217377981044598900399179325983760427538804107941558612293290577811036690795649204510230495180413191241919591931\n-1\n345842586075250271329088769074411195793511356766356527703943320748214365271138843316516258596305375028542576680157444882243643142248317696230661057511516236952699650936240331966032021713048567887768062203966070478934410111722160861271229518949484333123957284295154581562705552499868735559991458433681077989986062463722907020587333763822524960016511895616189022380422921068900128254086668985976564414809727660790260268758659004391480796809495625540323266397876403734146514134074566238130439903612537\n15348719271514799433842321797859554467814730772066621589799846025233366813265861892039310804110788794332439462342882640669701285931800527775380896000511733356643764536626810975968978888178770741349966923101948427120897671615356056325256321575097927871563213098334622325814777811944516732961149712727202431023929504767869151198954481749841131119057890374377884205448114125940593167670330502015253855127269096179100009294709341966737209579540246593117860314357986022108349627814476930358381574273419139\n28728904028390938914156967079088017722688187091773547521319035516456899488083810007314403608864620463310961904307727019313270206486805654570695060662937057757479961855520191690824360362753701494066750891955731378582661279403074738173298502477708455101416811455414291738449695238597379444936341998284262838648724405952400496704034403625221144556679983883479964945931860876387183116230403891183965239047830442433724986111814129974935985568911642062675252992624546378365710213787090670646521825174304831\n32454982476168113503128623934856095908542906720926673867332114372725430950168035868658685349991750495139364137274536490156026645338311791401186669165593337157285046496651954352095827455003764047049976002481015890242989430394538551670322689517626782880896242177870592325552815582417040884548255771629553492966719603684419526132318653162420620189935135940293661201457332826717103854473442219366012490280459301445038705063145194278882808329858541143564361692598343873304008549795689036557193665879213995\n59649030133765641301536952303827256284404117457008067900601727216701103277257124326268774170481334749522093819176526413201600969156420065141885345899376919941993501075267014556750707900827638877492792093513765617385074209138498984801423840159419298856581191434292450620727995643185026734134960512998148170269282601724877080394092620068805582357663445183114233556687765320240174791814384848769967716788415919739456599503140656755246564285380626812361070394135603887532529416448483300351439067115491629\n72579315571073433647251940755485905519831002112522565153699016653688657019846088445799095126084773051551178401160027429648878285287660551880804223309566823084169969860459355489791651437849537256359630534034267594249201733810572183765420029170840233463255233381114571837650234144211281743417503112511743626923284974539750788245158006833580300672567927831235726684880957261018123067990357928900821615738184219991803888329354150620144054935516045495832489018163428138154428998737456807348422412222387917\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "Special Judge", "O2优化", "THUPC"], "title": "[THUPC 2021] 幸运位置", "background": "", "description": "小 Z 是一个活泼好动的孩子。有一天，她站在数轴上 $b$ 的位置，并准备开始沿着数轴的正半轴移动。小 Z 每移动一步，就会立刻沿着数轴的正半轴前进 $a$ 个单位。奇妙的是，$a,b$ 都是正整数，所以小 Z 任意时刻所处的位置也都是正整数。\n\n小 Z 的幸运数字是一个正整数 $c$。小 Z 认为如果她移动到的位置恰好与 $c$ 互质，那么她认为这个位置是一个幸运位置。请你帮小 Z 计算她是否可以移动到幸运位置；如果可以，请计算出能移动到幸运位置的任意一个移动步数 $n$。\n\n简洁题意：给定三个正整数 $a,b,c$，判断是否存在非负整数 $n$ 使 $(an+b, c)=1$，若存在求任意一个解，其中 $(\\cdot, \\cdot)$ 表示最大公因数。", "inputFormat": "第一行为一个正整数 $T$，表示数据组数。接下来依次输入每组数据。\n\n对于每组数据，输入为一行三个正整数 $a,b,c$，含义见题目描述。\n\n对于所有的输入数据，都有 $1\\le T\\le 10$，$1\\le a,b,c < 10^{2000}$，所有输入数据均按照十进制给出。", "outputFormat": "对于每组数据输出一行一个整数。如果找不到合法的移动步数 $n$ 输出 `-1`，否则输出一个非负整数表示一个合法的移动步数 $n$。\n\n所有输出应按照十进制输出，每行输出的长度不得超过 $2000$，测试数据将保证存在输出长度限制内的解。另外，请不要输出多余的空格及任何多余字符，并保证文末有换行符，否则可能将影响评测程序对结果的判定。", "hint": "**【样例解释】**\n\n对于第一组数据，$a=1,b=2,c=3$，此时 $b,c$ 已经互质，$n=0$ 是一个解；\n\n对于第二组数据，$a=1,b=3,c=6$，取 $n=2$ 时有 $an+b=5$，与 $6$ 互质，因此是一个解；\n\n对于第三组数据，$a=2,b=2,c=2$，于是 $an+b=2n+2$，对于任意 $n$ 都有 $(an+b,c)=2$，因此不存在这样的 $n$，故输出 `-1`。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 幸运位置", "background": "", "description": "小 Z 是一个活泼好动的孩子。有一天，她站在数轴上 $b$ 的位置，并准备开始沿着数轴的正半轴移动。小 Z 每移动一步，就会立刻沿着数轴的正半轴前进 $a$ 个单位。奇妙的是，$a,b$ 都是正整数，所以小 Z 任意时刻所处的位置也都是正整数。\n\n小 Z 的幸运数字是一个正整数 $c$。小 Z 认为如果她移动到的位置恰好与 $c$ 互质，那么她认为这个位置是一个幸运位置。请你帮小 Z 计算她是否可以移动到幸运位置；如果可以，请计算出能移动到幸运位置的任意一个移动步数 $n$。\n\n简洁题意：给定三个正整数 $a,b,c$，判断是否存在非负整数 $n$ 使 $(an+b, c)=1$，若存在求任意一个解，其中 $(\\cdot, \\cdot)$ 表示最大公因数。", "inputFormat": "第一行为一个正整数 $T$，表示数据组数。接下来依次输入每组数据。\n\n对于每组数据，输入为一行三个正整数 $a,b,c$，含义见题目描述。\n\n对于所有的输入数据，都有 $1\\le T\\le 10$，$1\\le a,b,c < 10^{2000}$，所有输入数据均按照十进制给出。", "outputFormat": "对于每组数据输出一行一个整数。如果找不到合法的移动步数 $n$ 输出 `-1`，否则输出一个非负整数表示一个合法的移动步数 $n$。\n\n所有输出应按照十进制输出，每行输出的长度不得超过 $2000$，测试数据将保证存在输出长度限制内的解。另外，请不要输出多余的空格及任何多余字符，并保证文末有换行符，否则可能将影响评测程序对结果的判定。", "hint": "**【样例解释】**\n\n对于第一组数据，$a=1,b=2,c=3$，此时 $b,c$ 已经互质，$n=0$ 是一个解；\n\n对于第二组数据，$a=1,b=3,c=6$，取 $n=2$ 时有 $an+b=5$，与 $6$ 互质，因此是一个解；\n\n对于第三组数据，$a=2,b=2,c=2$，于是 $an+b=2n+2$，对于任意 $n$ 都有 $(an+b,c)=2$，因此不存在这样的 $n$，故输出 `-1`。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7612", "type": "P", "difficulty": 7, "samples": [["5\n30 10 10 9\n100 -10 100 50\n-30 100 50 30\n12 42 64 20\n287 123 46 31\n", "67877\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "O2优化", "THUPC"], "title": "[THUPC 2021] 星星", "background": "**往寻奥之星辰** ——镜（于建安七年（A.D. 0202））\n\n> “某年月日，有挚友二人，曰镜曰奥，求索星辰之秘。初苦无所用，次苦无所得。后逢乱，奥迁于外，亦不知所踪矣。区区之身亦可望天命耶，固其情可叹矣。余撰此文以叙之。”\n> ——《荧惑记<序>》\n\n宇宙纪元 1024 太阳年第 256 地球日，于斯特罗法斯星系，“赫希萨基”小行星矿区，“吉伽克”号高级采矿船。\n\n库洛船长本来在阅读几千年前所书写的《荧惑记》，这被考证是人类第一次对于星空的正式的有其科学目的观察记录，可是系统里一阵急促的报警声打扰了他。\n\n“副牵引仓隔离罩人为损坏”船员在系统损管备注里写道，“我们可爱的公主柯娜达又拉来了一块巨大的石头把隔离罩磕坏了，还说要送给马卡那小子”\n\n柯娜达是船长的女儿，马卡是大副的公子，大概还算得上是青梅竹马吧。\n\n库洛船长又开始头痛了，这已经是第三次了，维修科上次就警告过没有多余的当前型号的隔离罩了。\n\n“您还是不要责怪可爱的柯娜达了，”维修科的队长表示，“不过倒可以尝试用那些不能旋转的做一个替代出来，可我算不清楚要开多大的孔。”\n\n作为主脑数据组的一员，库洛船长请你帮助维修科计算一下至少要开多大的孔。", "description": "隔离罩是用来尽量防止其他宇宙射线对于扫描仪（不是牵引器！）的损坏的重要部件。\n\n简单的，我们可以把切割前的隔离罩看成一个单位球面如下图所示：\n\n工作计划上要完成 $N$（$1 \\le N \\le {10}^6$）次观测任务。\n\n对于第 $i$ 观测次，我们从点 $(0,0)$ 出发，扫描位于点 $(x_i,y_i,z_i)$，半径为 $r_i$（$-{10}^6 < x_i,y_i < {10}^6$，$0 < r_i < z_i < {10}^6$）的陨石。  \n这里我们可以简单的将陨石认为成一个圆球体。\n\n每次观测我们都要保证我们可以通过防护罩上开的洞扫描陨石的全貌。\n\n现在请你计算我们将要开的防护罩上的圆洞在球面上的半径（大圆弧长），即所有陨石球在上半单位球投影的并的最小覆盖圆（这里的圆是在曲面上的）。\n\n由于是单位球，所以这个数值应该等于该圆洞直径上两点与球心连线所呈平面角角度的一半。\n\n显然的，这个角度小于 $\\frac{\\pi}{2}$ 大于 $0$。若角度为 $\\omega$ rad 请你输出 $\\frac{\\omega}{\\pi/2} \\times {10}^5$ 并向下取整。", "inputFormat": "第一行一个整数 $N$，代表后面有 $N$ 个观测计划。\n\n之后每行四个整数，以空格分割，依序分别为 $x_i,y_i,z_i,r_i$。", "outputFormat": "输出一个范围在 $[0, 99999]$ 的整数。", "hint": "**【样例解释】**\n\n下图是各个小行星投影至防护罩的圆和最后挖出来圆洞的示意图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tdi9z9kx.png)\n\n**【提示】**\n\n- 这并不是一道计算机图形学题目。\n- 背景故事中所有人物、时间、事件、文字均为虚构。\n- 输入较大，建议使用更好的读入输出方式。\n- 请尽可能地利用您的代数知识。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2021] 星星", "background": "**往寻奥之星辰** ——镜（于建安七年（A.D. 0202））\n\n> “某年月日，有挚友二人，曰镜曰奥，求索星辰之秘。初苦无所用，次苦无所得。后逢乱，奥迁于外，亦不知所踪矣。区区之身亦可望天命耶，固其情可叹矣。余撰此文以叙之。”\n> ——《荧惑记<序>》\n\n宇宙纪元 1024 太阳年第 256 地球日，于斯特罗法斯星系，“赫希萨基”小行星矿区，“吉伽克”号高级采矿船。\n\n库洛船长本来在阅读几千年前所书写的《荧惑记》，这被考证是人类第一次对于星空的正式的有其科学目的观察记录，可是系统里一阵急促的报警声打扰了他。\n\n“副牵引仓隔离罩人为损坏”船员在系统损管备注里写道，“我们可爱的公主柯娜达又拉来了一块巨大的石头把隔离罩磕坏了，还说要送给马卡那小子”\n\n柯娜达是船长的女儿，马卡是大副的公子，大概还算得上是青梅竹马吧。\n\n库洛船长又开始头痛了，这已经是第三次了，维修科上次就警告过没有多余的当前型号的隔离罩了。\n\n“您还是不要责怪可爱的柯娜达了，”维修科的队长表示，“不过倒可以尝试用那些不能旋转的做一个替代出来，可我算不清楚要开多大的孔。”\n\n作为主脑数据组的一员，库洛船长请你帮助维修科计算一下至少要开多大的孔。", "description": "隔离罩是用来尽量防止其他宇宙射线对于扫描仪（不是牵引器！）的损坏的重要部件。\n\n简单的，我们可以把切割前的隔离罩看成一个单位球面如下图所示：\n\n工作计划上要完成 $N$（$1 \\le N \\le {10}^6$）次观测任务。\n\n对于第 $i$ 观测次，我们从点 $(0,0)$ 出发，扫描位于点 $(x_i,y_i,z_i)$，半径为 $r_i$（$-{10}^6 < x_i,y_i < {10}^6$，$0 < r_i < z_i < {10}^6$）的陨石。  \n这里我们可以简单的将陨石认为成一个圆球体。\n\n每次观测我们都要保证我们可以通过防护罩上开的洞扫描陨石的全貌。\n\n现在请你计算我们将要开的防护罩上的圆洞在球面上的半径（大圆弧长），即所有陨石球在上半单位球投影的并的最小覆盖圆（这里的圆是在曲面上的）。\n\n由于是单位球，所以这个数值应该等于该圆洞直径上两点与球心连线所呈平面角角度的一半。\n\n显然的，这个角度小于 $\\frac{\\pi}{2}$ 大于 $0$。若角度为 $\\omega$ rad 请你输出 $\\frac{\\omega}{\\pi/2} \\times {10}^5$ 并向下取整。", "inputFormat": "第一行一个整数 $N$，代表后面有 $N$ 个观测计划。\n\n之后每行四个整数，以空格分割，依序分别为 $x_i,y_i,z_i,r_i$。", "outputFormat": "输出一个范围在 $[0, 99999]$ 的整数。", "hint": "**【样例解释】**\n\n下图是各个小行星投影至防护罩的圆和最后挖出来圆洞的示意图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tdi9z9kx.png)\n\n**【提示】**\n\n- 这并不是一道计算机图形学题目。\n- 背景故事中所有人物、时间、事件、文字均为虚构。\n- 输入较大，建议使用更好的读入输出方式。\n- 请尽可能地利用您的代数知识。\n\n**【题目来源】**\n\n来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。\n\n题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。", "locale": "zh-CN"}}}
{"pid": "P7614", "type": "P", "difficulty": 1, "samples": [["20\n30\n50\n48\n33\n66\n0\n64", "261\n3 4 5 6 8"], ["20\n0\n50\n80\n77\n110\n56\n48", "373\n3 4 5 6 7"], ["20\n30\n50\n80\n110\n11\n0\n85", "355\n2 3 4 5 8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "枚举", "排序", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #2] NAJBOLJIH 5", "background": "", "description": "给定 $8$ 个数字 $X_1,X_2,...,X_8$，从中选出 $5$ 个数字，使得这 $5$ 个数字的总和最大。输出这 $5$ 个数字的和以及它们的编号。$X_i$ 的编号为 $i$。", "inputFormat": "输入共 $8$ 行，第 $i$ 行包含一个正整数 $X_i$。**保证所有 $X_i$ 互不相同**。", "outputFormat": "输出共两行。\n\n第一行包含一个整数，表示最大的总和。\n\n第二行包含 $5$ 个整数，表示 $5$ 个数的编号，**按升序排序**。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le X_i \\le 150$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T1 NAJBOLJIH 5___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #2] NAJBOLJIH 5", "background": "", "description": "给定 $8$ 个数字 $X_1,X_2,...,X_8$，从中选出 $5$ 个数字，使得这 $5$ 个数字的总和最大。输出这 $5$ 个数字的和以及它们的编号。$X_i$ 的编号为 $i$。", "inputFormat": "输入共 $8$ 行，第 $i$ 行包含一个正整数 $X_i$。**保证所有 $X_i$ 互不相同**。", "outputFormat": "输出共两行。\n\n第一行包含一个整数，表示最大的总和。\n\n第二行包含 $5$ 个整数，表示 $5$ 个数的编号，**按升序排序**。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le X_i \\le 150$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T1 NAJBOLJIH 5___。", "locale": "zh-CN"}}}
{"pid": "P7615", "type": "P", "difficulty": 1, "samples": [["4 3\nXXX\nX.X\nX.X\nXXX", "1"], ["5 5\nXX.XX\nX...X\n.....\nX...X\nXX.XX", "1"], ["3 9\n...XXX...\n.X.....X.\n...XXX...", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #2] OKRET", "background": "", "description": "给定一幅 $R \\times C$ 的地图，其中 `.` 表示该格子能走，`X` 表示该格子不能走。判断该地图是否有死胡同。\n\n如果一个格子满足上下左右四个格子中**只有一个格子能走**，那么这个格子就是死胡同。当然，不能走到地图外。", "inputFormat": "输入的第一行包含两个正整数 $R,C$。\n\n接下来 $R$ 行，每行包含 $C$ 个字符，描述这幅地图。", "outputFormat": "如果地图中有死胡同，输出 $1$，否则输出 $0$。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$3 \\le R,C \\le 10$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T2 OKRET___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #2] OKRET", "background": "", "description": "给定一幅 $R \\times C$ 的地图，其中 `.` 表示该格子能走，`X` 表示该格子不能走。判断该地图是否有死胡同。\n\n如果一个格子满足上下左右四个格子中**只有一个格子能走**，那么这个格子就是死胡同。当然，不能走到地图外。", "inputFormat": "输入的第一行包含两个正整数 $R,C$。\n\n接下来 $R$ 行，每行包含 $C$ 个字符，描述这幅地图。", "outputFormat": "如果地图中有死胡同，输出 $1$，否则输出 $0$。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$3 \\le R,C \\le 10$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T2 OKRET___。", "locale": "zh-CN"}}}
{"pid": "P7616", "type": "P", "difficulty": 3, "samples": [["3\n2 3 5\n2\n4 5", "10"], ["4\n6 2 3 4\n1\n1", "1"], ["3\n358572 83391967 82\n3\n50229961 1091444 8863", "000012028"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["数学", "2011", "枚举", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #2] ZADAĆA", "background": "", "description": "给定 $N$ 个正整数 $A_1,A_2,...,A_N$ 和 $M$ 个正整数 $B_1,B_2,...,B_M$，求：\n\n$$\\gcd(\\prod\\limits_{i=1}^NA_i,\\prod\\limits_{i=1}^MB_i)$$", "inputFormat": "第一行包含一个正整数 $N$。\n\n第二行包含 $N$ 个正整数 $A_i$。\n\n第三行包含一个正整数 $M$。\n\n第四行包含 $M$ 个正整数 $B_i$。", "outputFormat": "输出一行，表示答案。**如果答案超过九位数，你只需输出它的最后九位即可**。", "hint": "#### 【样例 1 解释】\n\n$\\gcd(30,20) = 10$，因此答案为 $10$。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 1000$，$1 \\le A_i,B_i \\le 10^9$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T3 ZADAĆA___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #2] ZADAĆA", "background": "", "description": "给定 $N$ 个正整数 $A_1,A_2,...,A_N$ 和 $M$ 个正整数 $B_1,B_2,...,B_M$，求：\n\n$$\\gcd(\\prod\\limits_{i=1}^NA_i,\\prod\\limits_{i=1}^MB_i)$$", "inputFormat": "第一行包含一个正整数 $N$。\n\n第二行包含 $N$ 个正整数 $A_i$。\n\n第三行包含一个正整数 $M$。\n\n第四行包含 $M$ 个正整数 $B_i$。", "outputFormat": "输出一行，表示答案。**如果答案超过九位数，你只需输出它的最后九位即可**。", "hint": "#### 【样例 1 解释】\n\n$\\gcd(30,20) = 10$，因此答案为 $10$。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 1000$，$1 \\le A_i,B_i \\le 10^9$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T3 ZADAĆA___。", "locale": "zh-CN"}}}
{"pid": "P7617", "type": "P", "difficulty": 4, "samples": [["3\n4\n20\n44", "1"], ["4\n32\n51\n123\n282", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "进制", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #2] KOMPIĆI", "background": "", "description": "给定 $N$ 个正整数 $A_1,A_2,...,A_N$，求有多少整数对 $(i,j)$，满足以下条件：\n\n- $1 \\le i < j \\le N$\n- **$A_i$ 和 $A_j$ 至少有一位数字是相同的（不一定要在相同的数位）**。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行，每行包含一个正整数 $A_i$。", "outputFormat": "输出一行一个整数，表示满足条件的整数对。", "hint": "#### 【样例解释】\n\n样例 1 中，满足要求的整数对为 $(1,3)$。\n\n样例 2 中，满足要求的整数对为 $(1,3)$，$(1,4)$，$(2,3)$，$(3,4)$。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^6$，$1 \\le A_i \\le 10^{18}$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T4 KOMPIĆI___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #2] KOMPIĆI", "background": "", "description": "给定 $N$ 个正整数 $A_1,A_2,...,A_N$，求有多少整数对 $(i,j)$，满足以下条件：\n\n- $1 \\le i < j \\le N$\n- **$A_i$ 和 $A_j$ 至少有一位数字是相同的（不一定要在相同的数位）**。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行，每行包含一个正整数 $A_i$。", "outputFormat": "输出一行一个整数，表示满足条件的整数对。", "hint": "#### 【样例解释】\n\n样例 1 中，满足要求的整数对为 $(1,3)$。\n\n样例 2 中，满足要求的整数对为 $(1,3)$，$(1,4)$，$(2,3)$，$(3,4)$。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^6$，$1 \\le A_i \\le 10^{18}$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T4 KOMPIĆI___。", "locale": "zh-CN"}}}
{"pid": "P7618", "type": "P", "difficulty": 5, "samples": [["2\n1 2\na 3", "5"], ["3\n2 3\n1 2\n1 a", "10"], ["3\n1 2\na 3\n1 b", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "图论", "2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #2] FUNKCIJA", "background": "", "description": "Mirko 写了如下的函数：\n\n（C++）\n\n```cpp\nint fun() {\n    int ret = 0;\n    for (int a = X1; a <= Y1; ++a)\n         for (int b = X2; b <= Y2; ++b)\n             ...\n                 for (int <N-th> = XN; <N-th> <= YN; ++<N-th>)\n                     ret = (ret + 1) % 1000000007;\n    return ret;\n}\n\n```\n\n（Pascal）\n\n```pascal\nfunction fun: longint;\nvar\n  ret: longint;\n  a, b, ... , y, z: longint;\nbegin\n  ret := 0;\n  for a := X1 to Y1 do\n    for b := X2 to Y2 do\n      ...\n        for <N-th> := XN to YN do\n          ret := (ret + 1) mod 1000000007;\n  fun := ret;\nend;\n```\n\n_<N-th>_ 表示第 $N$ 个小写字母。每个 $X_i$ 和 $Y_i$ 可能表示外层循环的变量名，也可能表示一个 $\\le 10^5$ 的正整数。例如 $X_3$ 可以是 $a$，$b$，也可以是一个整数常量。$X_i$ 和 $Y_i$ 中至少有一个会是整数常量。\n\n计算这个函数的返回值。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行的第 $i$ 行每行包含用空格分隔的 $X_i,Y_i$。如果 $X_i$ 和 $Y_i$ 都是整数常量，那么 $X_i \\le Y_i$。", "outputFormat": "输出一行一个整数，表示函数的返回值。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 26$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $150$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T5 FUNKCIJA___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #2] FUNKCIJA", "background": "", "description": "Mirko 写了如下的函数：\n\n（C++）\n\n```cpp\nint fun() {\n    int ret = 0;\n    for (int a = X1; a <= Y1; ++a)\n         for (int b = X2; b <= Y2; ++b)\n             ...\n                 for (int <N-th> = XN; <N-th> <= YN; ++<N-th>)\n                     ret = (ret + 1) % 1000000007;\n    return ret;\n}\n\n```\n\n（Pascal）\n\n```pascal\nfunction fun: longint;\nvar\n  ret: longint;\n  a, b, ... , y, z: longint;\nbegin\n  ret := 0;\n  for a := X1 to Y1 do\n    for b := X2 to Y2 do\n      ...\n        for <N-th> := XN to YN do\n          ret := (ret + 1) mod 1000000007;\n  fun := ret;\nend;\n```\n\n_<N-th>_ 表示第 $N$ 个小写字母。每个 $X_i$ 和 $Y_i$ 可能表示外层循环的变量名，也可能表示一个 $\\le 10^5$ 的正整数。例如 $X_3$ 可以是 $a$，$b$，也可以是一个整数常量。$X_i$ 和 $Y_i$ 中至少有一个会是整数常量。\n\n计算这个函数的返回值。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行的第 $i$ 行每行包含用空格分隔的 $X_i,Y_i$。如果 $X_i$ 和 $Y_i$ 都是整数常量，那么 $X_i \\le Y_i$。", "outputFormat": "输出一行一个整数，表示函数的返回值。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 26$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $150$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T5 FUNKCIJA___。", "locale": "zh-CN"}}}
{"pid": "P7619", "type": "P", "difficulty": 5, "samples": [["3 2\n10 2\n6 5\n4 3\n1 6 1\n3 0 10", "3\n2\n-11"], ["4 2\n3 2\n0 3\n4 3\n4 1\n3 0 4\n1 4 5", "-8\n-13\n-18"], ["6 7\n17 5\n26 4\n5 5\n12 4\n8 1\n18 2\n3 31 3\n4 11 5\n4 19 3\n5 23 2\n6 15 1\n5 19 1\n3 10 4", "27\n59\n56\n69\n78\n81\n82\n58"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "线段树", "平衡树", "树状数组", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #2] RASPORED", "background": null, "description": "Mirko 的比萨店是城里最好的，镇上所有的居民每天午餐都吃比萨饼。而且 Mirko 的送货服务很快，送货时间可以忽略不计。但是 Mirko 只有一个小烤箱，一次只能烤一个比萨饼。\n\n我们将城里的 $N$ 个居民从 $1$ 到 $N$ 编号，他们计划吃午餐的时间为 $L_i$，Mirko 需要为他们烘焙比萨的所需时间为 $T_i$。\n\n如果一个居民在他计划吃午餐时间的前 $K$ 个时间单位收到了他的比萨饼，那么 Mirko 会得到 $K$ 元小费。相应地，如果一个居民在他计划吃午餐时间的后 $K$ 个时间单位才收到了他的比萨饼，那么 Mirko 必须向居民付款 $K$ 元。如果比萨饼准时送到，Mirko 不会得到小费，但是也不用付任何费用。\n\n请你帮助 Mirko 安排一天的比萨烘焙顺序，使得他一天赚取的**总小费最大**。\n\n**注意：**\n\n1. 一天从时间单位 $0$ 开始，你可以认为这一天是无限长的。\n\n2. 居民们有时会改变他们的 $T_i,L_i$。", "inputFormat": "输入的第一行包含两个正整数 $N,C$，分别表示居民人数和比萨需求改变的数量。\n\n接下来 $N$ 行，每行包含两个整数 $L_i,T_i$。\n\n接下来 $C$ 行，每行包含三个正整数 $R_j,L_j,T_j$，分别表示要改变的居民编号、改变后的 $L_i$ 和改变后的 $T_i$。", "outputFormat": "输出的第一行包含一个整数，表示未修改前 Mirko 能得到的最大总小费。\n\n接下来对于每一个修改操作输出一行一个整数，表示这次修改后 Mirko 能得到的最大总小费。", "hint": "#### 【样例 1 解释】\n\n最优的比萨烘焙顺序为 $(1,3,2)$。这样的话，第 $1$ 个比萨在第 $2$ 个时间单位送达，第 $3$ 个比萨在第 $5$ 个时间单位送达，第 $2$ 个比萨在第 $10$ 个时间单位送达。\n\n第 $1$ 个比萨由于早送了 $8$ 个时间单位，所以 Mirko 得到了 $8$ 元小费；第 $2$ 个比萨由于迟送了 $1$ 个时间单位，所以 Mirko 需要付 $1$ 元；第 $3$ 个比萨由于迟送了 $4$ 个时间单位，所以 Mirko 需要付 $4$ 元。因此最大的总小费为 $3$。\n\n经过第 $1$ 次修改后，比萨烘焙顺序没有变，小费变成了 $5,0,-3$。\n\n经过第 $2$ 次修改后，比萨烘焙顺序变为 $(1,2,3)$，小费变成了 $5,0,-16$。\n\n#### 【数据范围】\n\n对于 $50\\%$ 的数据，$1 \\le T_i,T_j \\le 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\le N,C \\le 2 \\times 10^5$，$0 \\le L_i,L_j \\le 10^5$，$1 \\le T_i,T_j \\le 10^5$，$1 \\le R_j \\le N$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $150$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T6 RASPORED___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #2] RASPORED", "background": null, "description": "Mirko 的比萨店是城里最好的，镇上所有的居民每天午餐都吃比萨饼。而且 Mirko 的送货服务很快，送货时间可以忽略不计。但是 Mirko 只有一个小烤箱，一次只能烤一个比萨饼。\n\n我们将城里的 $N$ 个居民从 $1$ 到 $N$ 编号，他们计划吃午餐的时间为 $L_i$，Mirko 需要为他们烘焙比萨的所需时间为 $T_i$。\n\n如果一个居民在他计划吃午餐时间的前 $K$ 个时间单位收到了他的比萨饼，那么 Mirko 会得到 $K$ 元小费。相应地，如果一个居民在他计划吃午餐时间的后 $K$ 个时间单位才收到了他的比萨饼，那么 Mirko 必须向居民付款 $K$ 元。如果比萨饼准时送到，Mirko 不会得到小费，但是也不用付任何费用。\n\n请你帮助 Mirko 安排一天的比萨烘焙顺序，使得他一天赚取的**总小费最大**。\n\n**注意：**\n\n1. 一天从时间单位 $0$ 开始，你可以认为这一天是无限长的。\n\n2. 居民们有时会改变他们的 $T_i,L_i$。", "inputFormat": "输入的第一行包含两个正整数 $N,C$，分别表示居民人数和比萨需求改变的数量。\n\n接下来 $N$ 行，每行包含两个整数 $L_i,T_i$。\n\n接下来 $C$ 行，每行包含三个正整数 $R_j,L_j,T_j$，分别表示要改变的居民编号、改变后的 $L_i$ 和改变后的 $T_i$。", "outputFormat": "输出的第一行包含一个整数，表示未修改前 Mirko 能得到的最大总小费。\n\n接下来对于每一个修改操作输出一行一个整数，表示这次修改后 Mirko 能得到的最大总小费。", "hint": "#### 【样例 1 解释】\n\n最优的比萨烘焙顺序为 $(1,3,2)$。这样的话，第 $1$ 个比萨在第 $2$ 个时间单位送达，第 $3$ 个比萨在第 $5$ 个时间单位送达，第 $2$ 个比萨在第 $10$ 个时间单位送达。\n\n第 $1$ 个比萨由于早送了 $8$ 个时间单位，所以 Mirko 得到了 $8$ 元小费；第 $2$ 个比萨由于迟送了 $1$ 个时间单位，所以 Mirko 需要付 $1$ 元；第 $3$ 个比萨由于迟送了 $4$ 个时间单位，所以 Mirko 需要付 $4$ 元。因此最大的总小费为 $3$。\n\n经过第 $1$ 次修改后，比萨烘焙顺序没有变，小费变成了 $5,0,-3$。\n\n经过第 $2$ 次修改后，比萨烘焙顺序变为 $(1,2,3)$，小费变成了 $5,0,-16$。\n\n#### 【数据范围】\n\n对于 $50\\%$ 的数据，$1 \\le T_i,T_j \\le 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\le N,C \\le 2 \\times 10^5$，$0 \\le L_i,L_j \\le 10^5$，$1 \\le T_i,T_j \\le 10^5$，$1 \\le R_j \\le N$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $150$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #2](https://hsin.hr/coci/archive/2011_2012/contest2_tasks.pdf)** ___T6 RASPORED___。", "locale": "zh-CN"}}}
{"pid": "P7620", "type": "P", "difficulty": 7, "samples": [["3 2\n0 1 3\n", "2\n"], ["4 3\n0 3 6 7\n", "6\n"], ["5 5\n1 5 9 10 23\n", "20\n"], ["10 7\n39 62 64 79 81 83 96 109 120 122\n", "678132\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": [], "title": "CF1431J Zero-XOR Array", "background": "这是一道来自 Kotlin Heroes 的题目。但是这里允许其他语言提交。", "description": "给定一个包含 $n$ 个整数的序列 $a$，其中第 $i$ 个整数为 $a_i$。这个序列满足单调不递减性质，即 $a_1 \\le a_2 \\le \\ldots \\le a_n$。\n\n你需要找出所有包含 $2n-1$ 个整数的序列 $b$，使其满足以下条件：\n\n* $b_{2i−1}=a_i$ ($1\\leq i\\leq n$)；\n\n* $b$ 满足单调不递减性质；\n\n* $b1\\oplus b2\\oplus \\ldots \\oplus b_{2n−1}=0$（$\\oplus$ 表示按位异或运算。在 Kotlin 语言中，用函数 `xor` 表示）。\n\n请计算出不同的序列 $b$ 的个数对 $998244353$ 取模的结果。", "inputFormat": "第一行两个整数 $n, m$，表示 $a_i, b_i < 2 ^ m$。\n\n第二行 $n$ 个整数 $b_1, b_3,\\ldots , b_{2n−1}$。", "outputFormat": "输出一行，一个整数，表示答案对 $998244353$ 取模后的结果。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/aq4idgel.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "CF1431J Zero-XOR Array", "background": "这是一道来自 Kotlin Heroes 的题目。但是这里允许其他语言提交。", "description": "给定一个包含 $n$ 个整数的序列 $a$，其中第 $i$ 个整数为 $a_i$。这个序列满足单调不递减性质，即 $a_1 \\le a_2 \\le \\ldots \\le a_n$。\n\n你需要找出所有包含 $2n-1$ 个整数的序列 $b$，使其满足以下条件：\n\n* $b_{2i−1}=a_i$ ($1\\leq i\\leq n$)；\n\n* $b$ 满足单调不递减性质；\n\n* $b1\\oplus b2\\oplus \\ldots \\oplus b_{2n−1}=0$（$\\oplus$ 表示按位异或运算。在 Kotlin 语言中，用函数 `xor` 表示）。\n\n请计算出不同的序列 $b$ 的个数对 $998244353$ 取模的结果。", "inputFormat": "第一行两个整数 $n, m$，表示 $a_i, b_i < 2 ^ m$。\n\n第二行 $n$ 个整数 $b_1, b_3,\\ldots , b_{2n−1}$。", "outputFormat": "输出一行，一个整数，表示答案对 $998244353$ 取模后的结果。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/aq4idgel.png)", "locale": "zh-CN"}}}
{"pid": "P7621", "type": "P", "difficulty": 1, "samples": [["1\n23.70 1", "20.1"], ["3\n3.00 2\n17.95 1\n0.10 1", "20.4"], ["见附加文件的 shopping3.in。", "见附加文件的 shopping3.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "2021", "安徽"], "title": "[AHOI2021初中组] 超市购物", "background": "AHOI2021 初中组 T1\n\n**你可以选择跳过背景部分。**\n\n春的一天，正是乍暖还寒时候，狂风乍起。小可可裹紧了单薄的外衣，往小雪家中赶去。\n\n“今天真不是个出门的时候啊！”小可可感叹道。\n\n“但是我还有东西要买……你就陪我去下超市吧？”\n\n在超市里，小雪一共买了 23.70 元的东西，最后却只付了 20.1 元，小可可见状很疑惑。\n\n“超市对学生有优惠呗，最后会打八五折。”\n\n“那也不可能是这个价啊？我想想……应该是 20.145 元才对。”\n\n“超市结算的时候最后会去分化整，也就是说，以角作为付钱的最小单位，多的零头就不要了。”", "description": "现在，假如小可可一共买了 $n$ 种类型的商品，第 $i$ 种商品的单价为 $a_i$ 元，买了 $b_i$ 件，最后打八五折，并且舍去多出的小于一角的零头，你能不能帮他算算实际要付的钱数？", "inputFormat": "第一行一个正整数 $n$，表示商品的种类数。\n\n下面 $n$ 行，每行一个**两位小数 $a_i$** 和一个整数 $b_i$，用空格隔开，分别表示第 $i$ 种商品的单价和购买量。**注意，输入中不会省略小数点后的零。**", "outputFormat": "仅一行，一个**一位小数**，表示小可可在打折并去分后要付的实际元数。**注意，即使小数点后一位是 0，也要输出。**", "hint": "【样例 1 解释】\n\n这就是【题目背景】中的例子。\n\n【样例 2 解释】\n\n小可可的原购买金额为 $3.00 \\times 2 + 17.95 \\times 1 + 0.10 \\times 1 = 24.05$ 元，打八五折后为 $24.05 \\times 85\\% = 20.4425$ 元，去掉零头后为 $20.4$ 元。\n\n【数据范围与提示】\n\n**提示：如果你对浮点数不熟悉的话，请尽量利用整数完成。**\n\n- 对于 $30\\%$ 的测试点，保证 $n=1$；\n- 对于另外 $30\\%$ 的测试点，保证答案是整角；\n- 对于 $100\\%$ 的测试点，保证 $1 \\le n \\le 10$，$0.01 \\le a_i \\le 99.99$，$1 \\le b_i \\le 10$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[AHOI2021初中组] 超市购物", "background": "AHOI2021 初中组 T1\n\n**你可以选择跳过背景部分。**\n\n春的一天，正是乍暖还寒时候，狂风乍起。小可可裹紧了单薄的外衣，往小雪家中赶去。\n\n“今天真不是个出门的时候啊！”小可可感叹道。\n\n“但是我还有东西要买……你就陪我去下超市吧？”\n\n在超市里，小雪一共买了 23.70 元的东西，最后却只付了 20.1 元，小可可见状很疑惑。\n\n“超市对学生有优惠呗，最后会打八五折。”\n\n“那也不可能是这个价啊？我想想……应该是 20.145 元才对。”\n\n“超市结算的时候最后会去分化整，也就是说，以角作为付钱的最小单位，多的零头就不要了。”", "description": "现在，假如小可可一共买了 $n$ 种类型的商品，第 $i$ 种商品的单价为 $a_i$ 元，买了 $b_i$ 件，最后打八五折，并且舍去多出的小于一角的零头，你能不能帮他算算实际要付的钱数？", "inputFormat": "第一行一个正整数 $n$，表示商品的种类数。\n\n下面 $n$ 行，每行一个**两位小数 $a_i$** 和一个整数 $b_i$，用空格隔开，分别表示第 $i$ 种商品的单价和购买量。**注意，输入中不会省略小数点后的零。**", "outputFormat": "仅一行，一个**一位小数**，表示小可可在打折并去分后要付的实际元数。**注意，即使小数点后一位是 0，也要输出。**", "hint": "【样例 1 解释】\n\n这就是【题目背景】中的例子。\n\n【样例 2 解释】\n\n小可可的原购买金额为 $3.00 \\times 2 + 17.95 \\times 1 + 0.10 \\times 1 = 24.05$ 元，打八五折后为 $24.05 \\times 85\\% = 20.4425$ 元，去掉零头后为 $20.4$ 元。\n\n【数据范围与提示】\n\n**提示：如果你对浮点数不熟悉的话，请尽量利用整数完成。**\n\n- 对于 $30\\%$ 的测试点，保证 $n=1$；\n- 对于另外 $30\\%$ 的测试点，保证答案是整角；\n- 对于 $100\\%$ 的测试点，保证 $1 \\le n \\le 10$，$0.01 \\le a_i \\le 99.99$，$1 \\le b_i \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P7622", "type": "P", "difficulty": 3, "samples": [["3 2\n3 -1 2\n0 10", "5"], ["见附加文件的 hole2.in。 ", "见附加文件的 hole2.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "安徽"], "title": "[AHOI2021初中组] 坑", "background": "AHOI2021 初中组 T2\n\n**你可以选择跳过背景部分。**\n\n买东西的路上小雪吸了好几口雾霾，最后打了个喷嚏。恶劣的天气、压抑的氛围让小雪心情越来越差，之后倒起了苦水：\n\n“唉！今天又被一个不靠谱的同学坑了，浪费了我好多时间。”\n\n“期中考试还早，有什么好焦虑的呢？别卷了，正好来看看最近在蛐蛐国流行的一个游戏吧。”\n\n小雪看了游戏来了精神：看起来好像很解压。", "description": "游戏在一个左右无限延伸的数轴上进行，上面有 $n$ 只跳蚤和 $m$ 个坑，它们都可以被抽象成数轴上的一个点。\n\n玩家每回合需要选择让所有跳蚤一起向左/向右跳一个单位长度。如果一个代表跳蚤的点与一个代表坑的点重合了，跳蚤就会掉进坑中，发出惨叫后死去。\n\n郁闷的小雪想用最快的时间杀死所有跳蚤，请你帮小雪计算一下这个最少的回合数。", "inputFormat": "第一行两个空格隔开的正整数 $n,m$。\n\n第二行 $n$ 个空格隔开的整数 $x_1,x_2,\\ldots,x_n$，其中 $x_i$ 表示第 $i$ 只跳蚤初始时的坐标。\n\n第三行 $m$ 个空格隔开的整数 $y_1,y_2,\\ldots,y_m$，其中 $y_i$ 表示第 $i$ 个坑的坐标。\n\n输入数据保证以上 $n+m$ 个坐标两两互不相等。", "outputFormat": "仅一行一个整数，表示杀死所有跳蚤的最少回合数。", "hint": "【样例 1 解释】\n\n第一回合让所有跳蚤向右跳一步，第 2 个跳蚤进第一个坑，剩下两个跳蚤分别位于 4, 3。\n\n下面四回合让所有跳蚤向左跳，两个跳蚤都进入第一个坑，游戏结束。\n\n\n【数据范围与提示】\n\n**提示：本题输入规模较大，请避免使用过慢的输入方式。**\n\n- 对于 $20\\%$ 的数据，保证 $1 \\le n \\le 20$，$1 \\le m \\le 300$；\n- 对于另外 $20\\%$ 的数据，保证 $1 \\le n,m \\le 300$；\n- 对于另外 $20\\%$ 的数据，保证 $1 \\le x_i,y_i \\le 2000$；\n- 对于另外 $10\\%$ 的数据，保证 $1 \\le n,m \\le 2000$；\n- 对于另外 $10\\%$ 的数据，保证 $m=2$；\n- 对于 $100\\%$ 的数据，保证 $1 \\le n,m \\le 2 \\times 10^5$，$-10^9 \\le x_i,y_i \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[AHOI2021初中组] 坑", "background": "AHOI2021 初中组 T2\n\n**你可以选择跳过背景部分。**\n\n买东西的路上小雪吸了好几口雾霾，最后打了个喷嚏。恶劣的天气、压抑的氛围让小雪心情越来越差，之后倒起了苦水：\n\n“唉！今天又被一个不靠谱的同学坑了，浪费了我好多时间。”\n\n“期中考试还早，有什么好焦虑的呢？别卷了，正好来看看最近在蛐蛐国流行的一个游戏吧。”\n\n小雪看了游戏来了精神：看起来好像很解压。", "description": "游戏在一个左右无限延伸的数轴上进行，上面有 $n$ 只跳蚤和 $m$ 个坑，它们都可以被抽象成数轴上的一个点。\n\n玩家每回合需要选择让所有跳蚤一起向左/向右跳一个单位长度。如果一个代表跳蚤的点与一个代表坑的点重合了，跳蚤就会掉进坑中，发出惨叫后死去。\n\n郁闷的小雪想用最快的时间杀死所有跳蚤，请你帮小雪计算一下这个最少的回合数。", "inputFormat": "第一行两个空格隔开的正整数 $n,m$。\n\n第二行 $n$ 个空格隔开的整数 $x_1,x_2,\\ldots,x_n$，其中 $x_i$ 表示第 $i$ 只跳蚤初始时的坐标。\n\n第三行 $m$ 个空格隔开的整数 $y_1,y_2,\\ldots,y_m$，其中 $y_i$ 表示第 $i$ 个坑的坐标。\n\n输入数据保证以上 $n+m$ 个坐标两两互不相等。", "outputFormat": "仅一行一个整数，表示杀死所有跳蚤的最少回合数。", "hint": "【样例 1 解释】\n\n第一回合让所有跳蚤向右跳一步，第 2 个跳蚤进第一个坑，剩下两个跳蚤分别位于 4, 3。\n\n下面四回合让所有跳蚤向左跳，两个跳蚤都进入第一个坑，游戏结束。\n\n\n【数据范围与提示】\n\n**提示：本题输入规模较大，请避免使用过慢的输入方式。**\n\n- 对于 $20\\%$ 的数据，保证 $1 \\le n \\le 20$，$1 \\le m \\le 300$；\n- 对于另外 $20\\%$ 的数据，保证 $1 \\le n,m \\le 300$；\n- 对于另外 $20\\%$ 的数据，保证 $1 \\le x_i,y_i \\le 2000$；\n- 对于另外 $10\\%$ 的数据，保证 $1 \\le n,m \\le 2000$；\n- 对于另外 $10\\%$ 的数据，保证 $m=2$；\n- 对于 $100\\%$ 的数据，保证 $1 \\le n,m \\le 2 \\times 10^5$，$-10^9 \\le x_i,y_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7623", "type": "P", "difficulty": 4, "samples": [["5\n1 2 3 4 5\n1 2 3 4\n1 2 3\n1 2", "1080"], ["见附加文件的 sort2.in。 ", "见附加文件的 sort2.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2021", "安徽"], "title": "[AHOI2021初中组] 收衣服", "background": "AHOI2021 初中组 T3\n\n**你可以选择跳过背景部分。**\n\n沉迷于虐待跳蚤游戏的小雪没有发觉时间过了多久，一抬头发现竟然天色大变！天空一片昏黄，一股怪味扑鼻而来。没想到在如此发达的 2077 年，城市中还能碰到沙尘暴，这超现实的场景让小雪怀疑是跳蚤国王显灵。\n\n“别愣着了，快去收衣服呀！”小可可突然想到。", "description": "看着这么多蒙灰的衣服，他们俩欲哭无泪；而且，有的衣服是没法一起洗的，为了分门别类，小可可给了每件衣服一个 $1 \\sim n$ 的两两不同的标号，其中 $n$ 是衣服的件数，把衣服排成 $1,2,\\ldots,n$ 的顺序再洗会比较方便。\n\n小可可还想到，我们可以把一段连续的晾衣架拿出来，在手上翻转顺序，再放回去。作为 OI 选手的你，马上抽象出了小可可排序衣服的算法：我们设初始时从左往右第 $i$ 件衣服的标号为 $p_i$，按 $1,2,\\ldots,n-1$ 的顺序枚举 $i$，设 $p_i,p_{i+1},\\ldots,p_n$ 中标号最小的是 $p_j$，那么将 $p_i,p_{i+1},\\ldots,p_{j-1},p_j$ 左右翻转变成 $p_j,p_{j-1},\\ldots,p_{i+1},p_i$。\n\n小雪很快发现，小可可的算法看似厉害，实际上很傻——在天色的影响下，大家都分不出衣服的标号了。于是他们只能回到房间进行理性愉悦：我们假设左右翻转区间 $[i,j]$ 的操作代价是 $w_{i,j}$，一次排序的代价是每次翻转的操作代价之和。现在小可可想知道，当 $p$ 取遍 $n!$ 种排列时，所有情况的排序代价之和。\n\n只用输出答案对 $998244353$（$=7 \\times 17 \\times 2^{23} + 1$，一个质数）取模后的值。", "inputFormat": "第一行一个整数 $n$。\n\n下面 $n-1$ 行，第 $i(1 \\le i \\le n)$ 行 $n - i + 1$ 个空格隔开的整数，第 $j$ 个表示 $w_{i,j}$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "【样例 1 解释】\n\n我们举一个例子，当 $p=[3,2,5,1,4]$ 时，算法的执行步骤如下：\n\n- 执行到 $i=1$，$p_1,p_2,p_3,p_4,p_5$ 即 $3,2,5,1,4$ 中的最小值为 $p_4=1$，我们翻转区间 $[1,4]$，$p$ 变为 $[1,5,2,3,4]$，代价为 $w_{1,4}=4$；\n- 执行到 $i=2$，$p_2,p_3,p_4,p_5$ 即 $5,2,3,4$ 中的最小值为 $p_3=2$，我们翻转区间 $[2,3]$，$p$ 变为 $[1,2,5,3,4]$，代价为 $w_{2,3}=2$；\n- 执行到 $i=3$，$p_3,p_4,p_5$ 即 $5,3,4$ 中的最小值为 $p_4=3$，我们翻转区间 $[3,4]$，$p$ 变为 $[1,2,3,5,4]$，代价为 $w_{3,4}=2$；\n- 执行到 $i=4$，$p_4,p_5$ 即 $5,4$ 中的最小值为 $p_5=4$，我们翻转区间 $[4,5]$，$p$ 变为 $[1,2,3,4,5]$，代价为 $w_{4,5}=2$。\n\n可以看到，算法执行到第 $i$ 步结束时，序列的 $[1,i]$ 位置上恰好是 $[1,i]$ 号衣服，算法结束后 $p$ 被排好了序。这次排序总共付出了 $4+2+2+2=10$ 的代价。\n\n**注意：算法一定会执行 $n-1$ 步，即使中间就排好了序也不会提前退出。**\n\n【数据范围与提示】\n\n**提示：本题输入规模较大，请避免使用过慢的输入方式。**\n\n- 对于 $25\\%$ 的数据，保证 $1 \\le n \\le 9$；\n- 对于 $50\\%$ 的数据，保证 $1 \\le n \\le 16$；\n- 对于 $70\\%$ 的数据，保证 $1 \\le n \\le 50$；\n- 对于另外 $15\\%$ 的数据，保证 $w_{i,j}=1$；\n- 对于 $100\\%$ 的数据，保证 $1 \\le n \\le 500$，$0 \\le w_{i,j} < 998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[AHOI2021初中组] 收衣服", "background": "AHOI2021 初中组 T3\n\n**你可以选择跳过背景部分。**\n\n沉迷于虐待跳蚤游戏的小雪没有发觉时间过了多久，一抬头发现竟然天色大变！天空一片昏黄，一股怪味扑鼻而来。没想到在如此发达的 2077 年，城市中还能碰到沙尘暴，这超现实的场景让小雪怀疑是跳蚤国王显灵。\n\n“别愣着了，快去收衣服呀！”小可可突然想到。", "description": "看着这么多蒙灰的衣服，他们俩欲哭无泪；而且，有的衣服是没法一起洗的，为了分门别类，小可可给了每件衣服一个 $1 \\sim n$ 的两两不同的标号，其中 $n$ 是衣服的件数，把衣服排成 $1,2,\\ldots,n$ 的顺序再洗会比较方便。\n\n小可可还想到，我们可以把一段连续的晾衣架拿出来，在手上翻转顺序，再放回去。作为 OI 选手的你，马上抽象出了小可可排序衣服的算法：我们设初始时从左往右第 $i$ 件衣服的标号为 $p_i$，按 $1,2,\\ldots,n-1$ 的顺序枚举 $i$，设 $p_i,p_{i+1},\\ldots,p_n$ 中标号最小的是 $p_j$，那么将 $p_i,p_{i+1},\\ldots,p_{j-1},p_j$ 左右翻转变成 $p_j,p_{j-1},\\ldots,p_{i+1},p_i$。\n\n小雪很快发现，小可可的算法看似厉害，实际上很傻——在天色的影响下，大家都分不出衣服的标号了。于是他们只能回到房间进行理性愉悦：我们假设左右翻转区间 $[i,j]$ 的操作代价是 $w_{i,j}$，一次排序的代价是每次翻转的操作代价之和。现在小可可想知道，当 $p$ 取遍 $n!$ 种排列时，所有情况的排序代价之和。\n\n只用输出答案对 $998244353$（$=7 \\times 17 \\times 2^{23} + 1$，一个质数）取模后的值。", "inputFormat": "第一行一个整数 $n$。\n\n下面 $n-1$ 行，第 $i(1 \\le i \\le n)$ 行 $n - i + 1$ 个空格隔开的整数，第 $j$ 个表示 $w_{i,j}$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "【样例 1 解释】\n\n我们举一个例子，当 $p=[3,2,5,1,4]$ 时，算法的执行步骤如下：\n\n- 执行到 $i=1$，$p_1,p_2,p_3,p_4,p_5$ 即 $3,2,5,1,4$ 中的最小值为 $p_4=1$，我们翻转区间 $[1,4]$，$p$ 变为 $[1,5,2,3,4]$，代价为 $w_{1,4}=4$；\n- 执行到 $i=2$，$p_2,p_3,p_4,p_5$ 即 $5,2,3,4$ 中的最小值为 $p_3=2$，我们翻转区间 $[2,3]$，$p$ 变为 $[1,2,5,3,4]$，代价为 $w_{2,3}=2$；\n- 执行到 $i=3$，$p_3,p_4,p_5$ 即 $5,3,4$ 中的最小值为 $p_4=3$，我们翻转区间 $[3,4]$，$p$ 变为 $[1,2,3,5,4]$，代价为 $w_{3,4}=2$；\n- 执行到 $i=4$，$p_4,p_5$ 即 $5,4$ 中的最小值为 $p_5=4$，我们翻转区间 $[4,5]$，$p$ 变为 $[1,2,3,4,5]$，代价为 $w_{4,5}=2$。\n\n可以看到，算法执行到第 $i$ 步结束时，序列的 $[1,i]$ 位置上恰好是 $[1,i]$ 号衣服，算法结束后 $p$ 被排好了序。这次排序总共付出了 $4+2+2+2=10$ 的代价。\n\n**注意：算法一定会执行 $n-1$ 步，即使中间就排好了序也不会提前退出。**\n\n【数据范围与提示】\n\n**提示：本题输入规模较大，请避免使用过慢的输入方式。**\n\n- 对于 $25\\%$ 的数据，保证 $1 \\le n \\le 9$；\n- 对于 $50\\%$ 的数据，保证 $1 \\le n \\le 16$；\n- 对于 $70\\%$ 的数据，保证 $1 \\le n \\le 50$；\n- 对于另外 $15\\%$ 的数据，保证 $w_{i,j}=1$；\n- 对于 $100\\%$ 的数据，保证 $1 \\le n \\le 500$，$0 \\le w_{i,j} < 998244353$。", "locale": "zh-CN"}}}
{"pid": "P7624", "type": "P", "difficulty": 6, "samples": [["4 6\n1 1 3 3\n2 2 4 5\n1 2 4 4\n1 3 1 4\n2 4 2 5\n1 4 2 3", "4"], ["3 2\n2 1 2 1\n2 2 3 1", "-1"], ["见附加文件的 subway3.in。 ", "见附加文件的 subway3.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "2021", "安徽", "图论建模", "负权环", "差分约束"], "title": "[AHOI2021初中组] 地铁", "background": "AHOI2021 初中组 T4\n\n**你可以选择跳过背景部分。**\n\n小可可发现自己所学算法在生活中其实无大用，感觉十分沮丧。小雪见状还是嘀咕了几句“应该还是有用的吧”。\n\n“不过没用又怎么样呢？算法只不过是一块名牌大学的敲门砖罢了。”\n\n“你这话我就不同意了。跳蚤国王曾经和我说过，以后科研或者工作中我们还会和信息学竞赛中的某些东西重逢，虽然可能不会再有信息学竞赛这么难。\n\n“除开功利的因素之外，搞信息学竞赛还是能享受到很多思考的乐趣的。”\n\n“你说的也对。每次我在考场上不会做质疑这题是不是有问题的时候，考后看题解总是懊恼又快乐——这么自然的思路我怎么想不到呢！”\n\n一颗理论计算机科学家的种子悄悄萌芽。\n\n沙尘暴突然神奇般的散去了。实在坐不下去的两人决定出门坐地铁瞎逛，随性下车。即使没有刻意为之，小雪在地铁上却想出了一个有意思的问题，你能解决吗？", "description": "B 市的地铁历史悠久，小雪和小可可乘坐的 X 号线是环形路线，上面分布着 $n$ 个车站，**相邻两个车站之间的铁路长度为正整数**。现在小雪进行了一些观察，得到了 $m$ 条信息，第 $i$ 条信息是如下形式之一：\n\n1. 环上顺时针由 $S_i$ 到 $T_i$ 的一段距离不小于一个给定的值 $L_i$（$S_i$ 和 $T_i$ 是两个车站）；\n2. 环上顺时针由 $S_i$ 到 $T_i$ 的一段距离不大于一个给定的值 $L_i$。\n\n小雪想要你计算最后 X 线地铁的总长度有多少种不同的合法取值。", "inputFormat": "第一行两个空格隔开的正整数 $n$ 和 $m$。\n\n下面 $m$ 行，第 $i$ 行四个空格隔开的正整数 $type_i,S_i,T_i,L_i$，其中 $type_i \\in \\{1,2\\}$ 表示信息的类型。车站顺时针编号为从 1 开始的连续整数。保证 $1 \\le S_i,T_i \\le n$ 且 $S_i \\ne T_i$。", "outputFormat": "仅一行一个整数，表示所求答案。如果有无穷种取值，请输出 `-1`。\n\n**保证答案不为 0，即至少有一种可能的方案。**", "hint": "【样例 1 解释】\n\n定义数组 $d[1..4]$，其中 $d[i]$ 表示 $i$ 号车站顺时针到 $i+1$ 号车站的铁路长度。\n\n1. $d=[1,2,2,2]$，总长度为 $7$；\n2. $d=[1,2,2,3]$，总长度为 $8$；\n3. $d=[1,2,2,4]$，总长度为 $9$；\n4. $d=[1,2,3,4]$，总长度为 $10$。\n\n可以证明，不存在其他的可能长度，于是答案为 $4$。\n\n【样例 2 解释】\n\n$3$ 号车站顺时针到 $1$ 号车站的铁路长度可以为任意正整数。\n\n【数据范围与提示】\n\n- 对于 $30\\%$ 的数据，保证 $n,m \\le 9$，$L_i \\le 5$；\n- 对于另外 $15\\%$ 的数据，保证 $T_i$ 是 $S_i$ 顺时针方向后第一个车站；\n- 对于另外 $20\\%$ 的数据，保证 $T_i$ 是 $S_i$ 顺时针方向后第二个车站；\n- 对于另外 $25\\%$ 的数据，保证 $n,m \\le 50$；\n- 对于 $100\\%$ 的数据，保证 $3 \\le n \\le 500$，$1 \\le m \\le 500$，$1 \\le L_i \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[AHOI2021初中组] 地铁", "background": "AHOI2021 初中组 T4\n\n**你可以选择跳过背景部分。**\n\n小可可发现自己所学算法在生活中其实无大用，感觉十分沮丧。小雪见状还是嘀咕了几句“应该还是有用的吧”。\n\n“不过没用又怎么样呢？算法只不过是一块名牌大学的敲门砖罢了。”\n\n“你这话我就不同意了。跳蚤国王曾经和我说过，以后科研或者工作中我们还会和信息学竞赛中的某些东西重逢，虽然可能不会再有信息学竞赛这么难。\n\n“除开功利的因素之外，搞信息学竞赛还是能享受到很多思考的乐趣的。”\n\n“你说的也对。每次我在考场上不会做质疑这题是不是有问题的时候，考后看题解总是懊恼又快乐——这么自然的思路我怎么想不到呢！”\n\n一颗理论计算机科学家的种子悄悄萌芽。\n\n沙尘暴突然神奇般的散去了。实在坐不下去的两人决定出门坐地铁瞎逛，随性下车。即使没有刻意为之，小雪在地铁上却想出了一个有意思的问题，你能解决吗？", "description": "B 市的地铁历史悠久，小雪和小可可乘坐的 X 号线是环形路线，上面分布着 $n$ 个车站，**相邻两个车站之间的铁路长度为正整数**。现在小雪进行了一些观察，得到了 $m$ 条信息，第 $i$ 条信息是如下形式之一：\n\n1. 环上顺时针由 $S_i$ 到 $T_i$ 的一段距离不小于一个给定的值 $L_i$（$S_i$ 和 $T_i$ 是两个车站）；\n2. 环上顺时针由 $S_i$ 到 $T_i$ 的一段距离不大于一个给定的值 $L_i$。\n\n小雪想要你计算最后 X 线地铁的总长度有多少种不同的合法取值。", "inputFormat": "第一行两个空格隔开的正整数 $n$ 和 $m$。\n\n下面 $m$ 行，第 $i$ 行四个空格隔开的正整数 $type_i,S_i,T_i,L_i$，其中 $type_i \\in \\{1,2\\}$ 表示信息的类型。车站顺时针编号为从 1 开始的连续整数。保证 $1 \\le S_i,T_i \\le n$ 且 $S_i \\ne T_i$。", "outputFormat": "仅一行一个整数，表示所求答案。如果有无穷种取值，请输出 `-1`。\n\n**保证答案不为 0，即至少有一种可能的方案。**", "hint": "【样例 1 解释】\n\n定义数组 $d[1..4]$，其中 $d[i]$ 表示 $i$ 号车站顺时针到 $i+1$ 号车站的铁路长度。\n\n1. $d=[1,2,2,2]$，总长度为 $7$；\n2. $d=[1,2,2,3]$，总长度为 $8$；\n3. $d=[1,2,2,4]$，总长度为 $9$；\n4. $d=[1,2,3,4]$，总长度为 $10$。\n\n可以证明，不存在其他的可能长度，于是答案为 $4$。\n\n【样例 2 解释】\n\n$3$ 号车站顺时针到 $1$ 号车站的铁路长度可以为任意正整数。\n\n【数据范围与提示】\n\n- 对于 $30\\%$ 的数据，保证 $n,m \\le 9$，$L_i \\le 5$；\n- 对于另外 $15\\%$ 的数据，保证 $T_i$ 是 $S_i$ 顺时针方向后第一个车站；\n- 对于另外 $20\\%$ 的数据，保证 $T_i$ 是 $S_i$ 顺时针方向后第二个车站；\n- 对于另外 $25\\%$ 的数据，保证 $n,m \\le 50$；\n- 对于 $100\\%$ 的数据，保证 $3 \\le n \\le 500$，$1 \\le m \\le 500$，$1 \\le L_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7625", "type": "P", "difficulty": 1, "samples": [["5 1\n3\n1\n5\n3", "6"], ["5 2\n3\n1\n5\n3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #1] JABUKE", "background": "", "description": "Mirko 最近迷上了一款电子游戏。\n\n这款游戏的屏幕被分成 $N$ 列。在屏幕的底部，有一艘 $M$ 列宽的船。游戏中，玩家可以将这艘船左右移动，但船必须**时刻保持完全在屏幕内**。初始时船占据屏幕最左边的 $M$ 列。\n\n有苹果会从屏幕顶部掉落。每个苹果都从顶部的 $N$ 列的其中一列开始以直线掉落。当当前的苹果掉落到屏幕底部时，下一个苹果开始掉落。\n\n如果当一个苹果掉落到底部时，船覆盖了苹果所在的列，那么我们说**这个苹果是被捡起的**。你的任务是在捡起所有苹果的前提下，最小化船移动的距离。", "inputFormat": "第一行包含两个以空格分隔的整数 $N,M$。\n\n第二行包含一个整数 $J$，表示将要掉落的苹果的个数。\n\n接下来 $J$ 行的第 $i$ 行包含一个整数，表示第 $i$ 个苹果将要从哪一列开始掉落。", "outputFormat": "输出一行一个整数，表示最小的船移动的距离。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le M < N \\le 10$，$1 \\le J \\le 20$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T1 JABUKE___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #1] JABUKE", "background": "", "description": "Mirko 最近迷上了一款电子游戏。\n\n这款游戏的屏幕被分成 $N$ 列。在屏幕的底部，有一艘 $M$ 列宽的船。游戏中，玩家可以将这艘船左右移动，但船必须**时刻保持完全在屏幕内**。初始时船占据屏幕最左边的 $M$ 列。\n\n有苹果会从屏幕顶部掉落。每个苹果都从顶部的 $N$ 列的其中一列开始以直线掉落。当当前的苹果掉落到屏幕底部时，下一个苹果开始掉落。\n\n如果当一个苹果掉落到底部时，船覆盖了苹果所在的列，那么我们说**这个苹果是被捡起的**。你的任务是在捡起所有苹果的前提下，最小化船移动的距离。", "inputFormat": "第一行包含两个以空格分隔的整数 $N,M$。\n\n第二行包含一个整数 $J$，表示将要掉落的苹果的个数。\n\n接下来 $J$ 行的第 $i$ 行包含一个整数，表示第 $i$ 个苹果将要从哪一列开始掉落。", "outputFormat": "输出一行一个整数，表示最小的船移动的距离。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le M < N \\le 10$，$1 \\le J \\le 20$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T1 JABUKE___。", "locale": "zh-CN"}}}
{"pid": "P7626", "type": "P", "difficulty": 3, "samples": [["2\n1 -2\n4 5", "4"], ["3\n1 2 3\n4 5 6\n7 8 9", "0"], ["3\n-3 4 5\n7 9 -2\n1 0 -6", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "2011", "枚举", "前缀和", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #1] MATRIX", "background": "", "description": "有一个 $N \\times N$ 的矩阵，找出它的美丽值最大的子矩阵，要求这个子矩阵是正方形，即长和宽相等。\n\n定义一个矩阵的**美丽值**为：将这个矩阵**主对角线**上的数的和定义为 $A$，另一条对角线上的数的和定义为 $B$，则这个矩阵的美丽值为 $A - B$。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行每行包含 $N$ 个整数，表示这个矩阵。", "outputFormat": "输出一行一个整数，表示最大的美丽值。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 400$，矩阵元素 $\\in [-10^3,10^3]$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T2 MATRIX___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #1] MATRIX", "background": "", "description": "有一个 $N \\times N$ 的矩阵，找出它的美丽值最大的子矩阵，要求这个子矩阵是正方形，即长和宽相等。\n\n定义一个矩阵的**美丽值**为：将这个矩阵**主对角线**上的数的和定义为 $A$，另一条对角线上的数的和定义为 $B$，则这个矩阵的美丽值为 $A - B$。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行每行包含 $N$ 个整数，表示这个矩阵。", "outputFormat": "输出一行一个整数，表示最大的美丽值。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 400$，矩阵元素 $\\in [-10^3,10^3]$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T2 MATRIX___。", "locale": "zh-CN"}}}
{"pid": "P7627", "type": "P", "difficulty": 3, "samples": [["2\n19\n10", "25"], ["3\n7\n3\n5", "12"], ["5\n9\n13\n1\n9\n6", "84"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "进制", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #1] X3", "background": "", "description": "给定一个长度为 $N$ 的序列 $A_1,A_2,...,A_N$，求序列元素两两异或的总和。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行每行包含一个正整数 $A_i$。", "outputFormat": "输出一行一个整数，表示两两异或后的总和。", "hint": "#### 【样例 2 解释】\n\n$A_1 ⊕ A_2 = 4$，$A_1 ⊕ A_3 = 2$，$A_2 ⊕ A_3 = 6$，$4 + 2 + 6 = 12$，因此答案为 $12$。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^6$，$1 \\le A_i \\le 10^6$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $110$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T3 X3___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #1] X3", "background": "", "description": "给定一个长度为 $N$ 的序列 $A_1,A_2,...,A_N$，求序列元素两两异或的总和。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行每行包含一个正整数 $A_i$。", "outputFormat": "输出一行一个整数，表示两两异或后的总和。", "hint": "#### 【样例 2 解释】\n\n$A_1 ⊕ A_2 = 4$，$A_1 ⊕ A_3 = 2$，$A_2 ⊕ A_3 = 6$，$4 + 2 + 6 = 12$，因此答案为 $12$。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^6$，$1 \\le A_i \\le 10^6$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $110$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T3 X3___。", "locale": "zh-CN"}}}
{"pid": "P7628", "type": "P", "difficulty": 4, "samples": [["1\n-1800\n1800", "0"], ["1\n1700\n-1800", "1"], ["2\n-1800 -2200\n1900 1700", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #1] PLES", "background": "", "description": "舞会上有 $N$ 个男孩和 $N$ 个女孩，我们知道他们的身高。规定每个人最多只能和一个舞伴跳舞。\n\n每个男孩要么想和比他高的女孩跳舞，要么想和比他矮的女孩跳舞。类似地，每个女孩要么想和比她高的男孩跳舞，要么想和比她矮的男孩跳舞。没有同样高的男孩和女孩想和对方跳舞。\n\n求如果遵照每个人的意愿，最大的舞伴对数是多少。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行，每行包含一个整数 $A_i$。$A_i$ 的绝对值表示第 $i$ 个男孩的身高。如果 $A_i$ 为正数，表示第 $i$ 个男孩想和比他高的女孩跳舞；如果 $A_i$ 为负数，表示第 $i$ 个男孩想和比他矮的女孩跳舞。\n\n接下来 $N$ 行，每行包含一个整数 $B_j$。$B_j$ 的绝对值表示第 $j$ 个女孩的身高。如果 $B_j$ 为正数，表示第 $j$ 个女孩想和比他高的男孩跳舞；如果 $B_j$ 为负数，表示第 $j$ 个女孩想和比他矮的男孩跳舞。", "outputFormat": "输出一行一个整数，表示最大的舞伴对数。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1500 \\le |A_i,B_j| \\le 2500$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $110$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T4 PLES___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #1] PLES", "background": "", "description": "舞会上有 $N$ 个男孩和 $N$ 个女孩，我们知道他们的身高。规定每个人最多只能和一个舞伴跳舞。\n\n每个男孩要么想和比他高的女孩跳舞，要么想和比他矮的女孩跳舞。类似地，每个女孩要么想和比她高的男孩跳舞，要么想和比她矮的男孩跳舞。没有同样高的男孩和女孩想和对方跳舞。\n\n求如果遵照每个人的意愿，最大的舞伴对数是多少。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n接下来 $N$ 行，每行包含一个整数 $A_i$。$A_i$ 的绝对值表示第 $i$ 个男孩的身高。如果 $A_i$ 为正数，表示第 $i$ 个男孩想和比他高的女孩跳舞；如果 $A_i$ 为负数，表示第 $i$ 个男孩想和比他矮的女孩跳舞。\n\n接下来 $N$ 行，每行包含一个整数 $B_j$。$B_j$ 的绝对值表示第 $j$ 个女孩的身高。如果 $B_j$ 为正数，表示第 $j$ 个女孩想和比他高的男孩跳舞；如果 $B_j$ 为负数，表示第 $j$ 个女孩想和比他矮的男孩跳舞。", "outputFormat": "输出一行一个整数，表示最大的舞伴对数。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1500 \\le |A_i,B_j| \\le 2500$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $110$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T4 PLES___。", "locale": "zh-CN"}}}
{"pid": "P7629", "type": "P", "difficulty": 4, "samples": [["2\n2 1", "1"], ["4\n4 3 2 1", "1"], ["4\n3 1 4 2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "线段树", "树状数组", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #1] SORT", "background": "", "description": "考虑如下的排序算法：\n\n```\nreverse-sort(sequence a)\n    while (a is not in nondecreasing order)\n        partition a into the minimum number of slopes\n        for every slope with length greater than one\n            reverse(slope)\n```\n\n定义 `slope` 为 `a` 的递减子串，`reverse()` 将翻转一段序列。\n\n给定一个 $1$ ~ $N$ 的排列，保证在第一次划分时每个 `slope` 的长度都为偶数，求如果使用这种排序算法对给定的排列进行排序，需要调用多少次 `reverse(slope)`。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n第二行包含 $N$ 个互不相同的的正整数，代表待排序的排列。", "outputFormat": "输出一行一个整数，表示 `reverse(slope)` 需要被调用的次数。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 10^5$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T5 SORT___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #1] SORT", "background": "", "description": "考虑如下的排序算法：\n\n```\nreverse-sort(sequence a)\n    while (a is not in nondecreasing order)\n        partition a into the minimum number of slopes\n        for every slope with length greater than one\n            reverse(slope)\n```\n\n定义 `slope` 为 `a` 的递减子串，`reverse()` 将翻转一段序列。\n\n给定一个 $1$ ~ $N$ 的排列，保证在第一次划分时每个 `slope` 的长度都为偶数，求如果使用这种排序算法对给定的排列进行排序，需要调用多少次 `reverse(slope)`。", "inputFormat": "输入的第一行包含一个正整数 $N$。\n\n第二行包含 $N$ 个互不相同的的正整数，代表待排序的排列。", "outputFormat": "输出一行一个整数，表示 `reverse(slope)` 需要被调用的次数。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 10^5$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T5 SORT___。", "locale": "zh-CN"}}}
{"pid": "P7630", "type": "P", "difficulty": 6, "samples": [["3 2\n1 1\n1 3 2\n2 3 2\n3 1 1", "2\n1 1\n1 3"], ["5 6\n2 3\n4 5 3 2 3\n1 3 4 3 1\n3 4 1 3 2\n4 4 2 1 3\n4 6 4 9 2", "5\n1 4\n2 1\n2 5\n4 5\n5 2"], ["3 3\n2 2\n3 6 4\n2 2 5\n1 3 7", "0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["数学", "2011", "进制", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #1] SKAKAC", "background": "", "description": "Mirko 和 Slavko 正在玩一个游戏。\n\nMirko 把一个骑士棋子放在一个 $N \\times N$ 的棋盘上，蒙住 Slavko 的眼睛，接下来将骑士移动 $T$ 步，每秒走一步。之后，Slavko 必须猜出骑士的最终位置才能获胜。\n\n这个游戏中的棋盘是特别的，因为每个格子都有一部分时间被禁止通行。更准确地说，每个格子上都有一个为正整数的标记，标有数字 $K$ 的正方形只有在第 $0,K,K \\times 2,K \\times 3,...$ 秒内才是允许通行的，在其他时间这个格子都禁止通行。当然，骑士只能在某个格子允许通行时走到该格子。\n\n游戏从第 $0$ 秒开始。每秒钟 Mirko 必须将骑士移动一步（根据国际象棋的规则，骑士走日字，类似中国象棋中的马）。请帮助 Slavko 写一个程序来计算出所有 $T$ 秒过后骑士可能位于的格子。", "inputFormat": "输入的第一行包含两个正整数 $N,T$。\n\n第二行包含两个正整数 $X,Y$，代表骑士的初始坐标。\n\n接下来 $N$ 行，每行包含 $N$ 个不超过 $10^9$ 的正整数，描述这个棋盘。", "outputFormat": "输出的第一行为一个非负整数 $M$，表示 $T$ 秒过后骑士可能位于的格子的数量。\n\n接下来 $M$ 行，每行包含一个坐标，表示 $T$ 秒过后骑士可能位于的格子。输出的坐标按行数升序排序，如果行数相同按列数升序排序。", "hint": "#### 【样例 1 解释】\n\n棋盘的状态如下图所示。`.` 代表允许通行的格子，`#` 代表禁止通行的格子，`K` 代表骑士可能位于的格子。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9opnymlm.png)\n\n#### 【数据范围】\n\n对于 $40\\%$ 的数据，$T \\le 5 \\times 10^4$。\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 30$，$1 \\le T \\le 10^6$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T6 SKAKAC___。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #1] SKAKAC", "background": "", "description": "Mirko 和 Slavko 正在玩一个游戏。\n\nMirko 把一个骑士棋子放在一个 $N \\times N$ 的棋盘上，蒙住 Slavko 的眼睛，接下来将骑士移动 $T$ 步，每秒走一步。之后，Slavko 必须猜出骑士的最终位置才能获胜。\n\n这个游戏中的棋盘是特别的，因为每个格子都有一部分时间被禁止通行。更准确地说，每个格子上都有一个为正整数的标记，标有数字 $K$ 的正方形只有在第 $0,K,K \\times 2,K \\times 3,...$ 秒内才是允许通行的，在其他时间这个格子都禁止通行。当然，骑士只能在某个格子允许通行时走到该格子。\n\n游戏从第 $0$ 秒开始。每秒钟 Mirko 必须将骑士移动一步（根据国际象棋的规则，骑士走日字，类似中国象棋中的马）。请帮助 Slavko 写一个程序来计算出所有 $T$ 秒过后骑士可能位于的格子。", "inputFormat": "输入的第一行包含两个正整数 $N,T$。\n\n第二行包含两个正整数 $X,Y$，代表骑士的初始坐标。\n\n接下来 $N$ 行，每行包含 $N$ 个不超过 $10^9$ 的正整数，描述这个棋盘。", "outputFormat": "输出的第一行为一个非负整数 $M$，表示 $T$ 秒过后骑士可能位于的格子的数量。\n\n接下来 $M$ 行，每行包含一个坐标，表示 $T$ 秒过后骑士可能位于的格子。输出的坐标按行数升序排序，如果行数相同按列数升序排序。", "hint": "#### 【样例 1 解释】\n\n棋盘的状态如下图所示。`.` 代表允许通行的格子，`#` 代表禁止通行的格子，`K` 代表骑士可能位于的格子。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9opnymlm.png)\n\n#### 【数据范围】\n\n对于 $40\\%$ 的数据，$T \\le 5 \\times 10^4$。\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 30$，$1 \\le T \\le 10^6$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自 **[COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #1](https://hsin.hr/coci/archive/2011_2012/contest1_tasks.pdf)** ___T6 SKAKAC___。", "locale": "zh-CN"}}}
{"pid": "P7631", "type": "P", "difficulty": 1, "samples": [["10\n20\n30\n40\n50\n60\n70\n80\n90\n100 ", "100"], ["1\n2\n3\n5\n8\n13\n21\n34\n55\n89 \n", "87"], ["40\n40\n40\n40\n40\n40\n40\n40\n40\n40 \n", "120"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2010", "COCI（克罗地亚）"], "title": "[COCI 2010/2011 #5] GLJIVE", "background": "", "description": "在超级马里奥面前有 $10$ 个蘑菇，排成一排。每挑选一个蘑菇就奖励一些分数。\n\n超级马里奥必须按蘑菇出现的顺序挑选蘑菇，但并不是要求把他们都采集出来——他的目标是得分尽可能接近 $100$。**采集的蘑菇必须从第一个开始且是连续的**。\n\n如果存在两个同样接近 $100$ 的数字（例如 $98$ 和 $102$），马里奥会选择较大的那个（这里是 $102$）。\n\n帮助超级马里奥，告诉他他能得到多少分。", "inputFormat": "输入共 $10$ 行，每一行包含一个正整数 $A_i$，表示挑选当前蘑菇所获得的分数，按照马里奥挑选蘑菇的顺序排列。", "outputFormat": "输出共 $1$ 行，一个整数，表示马里奥能得到的分数。", "hint": "**【样例解释#1】**\n\n马里奥选择第 $10$ 个蘑菇，得到 $100$ 分。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le A_i\\le 100$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $30$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T1 GLJIVE**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2010/2011 #5] GLJIVE", "background": "", "description": "在超级马里奥面前有 $10$ 个蘑菇，排成一排。每挑选一个蘑菇就奖励一些分数。\n\n超级马里奥必须按蘑菇出现的顺序挑选蘑菇，但并不是要求把他们都采集出来——他的目标是得分尽可能接近 $100$。**采集的蘑菇必须从第一个开始且是连续的**。\n\n如果存在两个同样接近 $100$ 的数字（例如 $98$ 和 $102$），马里奥会选择较大的那个（这里是 $102$）。\n\n帮助超级马里奥，告诉他他能得到多少分。", "inputFormat": "输入共 $10$ 行，每一行包含一个正整数 $A_i$，表示挑选当前蘑菇所获得的分数，按照马里奥挑选蘑菇的顺序排列。", "outputFormat": "输出共 $1$ 行，一个整数，表示马里奥能得到的分数。", "hint": "**【样例解释#1】**\n\n马里奥选择第 $10$ 个蘑菇，得到 $100$ 分。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le A_i\\le 100$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $30$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T1 GLJIVE**_。", "locale": "zh-CN"}}}
{"pid": "P7632", "type": "P", "difficulty": 2, "samples": [["1\n1 20:00 ", "28:00\n00:00 \n"], ["3\n1 01:10\n2 21:10\n2 31:30 ", "20:00\n16:30 "], ["5\n1 01:10\n1 02:20\n2 45:30\n2 46:40\n2 47:50 ", "45:30\n00:10 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2010", "COCI（克罗地亚）"], "title": "[COCI 2010/2011 #5] KOŠARKA", "background": "", "description": "Slavko 已经开始关注 NBA 了。比赛持续时间正好是 $48$ 分钟。当一场比赛最后会显示统计数据。每当一个球队得分，Slavko 都会记下。他很好奇每个队领先的持续时间。", "inputFormat": "输入共 $N$ 行：\n\n第 $1$ 行包含一个整数 $N$，表示事件个数。\n\n下面的 $N$ 行描述了一个队得分时的情况：\n\n每个描述由一个得分的球队（$1$ 或 $2$）和一个时间组成，\n\n时间的格式：$MM:SS$。如果分钟数或秒数 $\\le9$，则用前导 $0$ 填充。", "outputFormat": "输出的第 $1$ 行为第一个团队处于领先地位的持续时间；\n\n第 $2$ 行为第二个团队处于领先地位的持续时间。\n\n所有的持续时间应该是 $MM:SS$ 格式，包含前导零。", "hint": "**【样例解释#1】**\n\n队伍 $1$ 在 $20$ 分钟整的时候得一分，比分 $1:0$，处于领先地位。\n\n后面 $28$ 分钟队伍 $2$ 没有进球，故队伍 $1$ 一直保持着领先地位。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 100$，$0\\le$ 分钟数 $\\le 47$，$0\\le $ 秒数 $\\le 59$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T2 KOŠARKA**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2010/2011 #5] KOŠARKA", "background": "", "description": "Slavko 已经开始关注 NBA 了。比赛持续时间正好是 $48$ 分钟。当一场比赛最后会显示统计数据。每当一个球队得分，Slavko 都会记下。他很好奇每个队领先的持续时间。", "inputFormat": "输入共 $N$ 行：\n\n第 $1$ 行包含一个整数 $N$，表示事件个数。\n\n下面的 $N$ 行描述了一个队得分时的情况：\n\n每个描述由一个得分的球队（$1$ 或 $2$）和一个时间组成，\n\n时间的格式：$MM:SS$。如果分钟数或秒数 $\\le9$，则用前导 $0$ 填充。", "outputFormat": "输出的第 $1$ 行为第一个团队处于领先地位的持续时间；\n\n第 $2$ 行为第二个团队处于领先地位的持续时间。\n\n所有的持续时间应该是 $MM:SS$ 格式，包含前导零。", "hint": "**【样例解释#1】**\n\n队伍 $1$ 在 $20$ 分钟整的时候得一分，比分 $1:0$，处于领先地位。\n\n后面 $28$ 分钟队伍 $2$ 没有进球，故队伍 $1$ 一直保持着领先地位。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 100$，$0\\le$ 分钟数 $\\le 47$，$0\\le $ 秒数 $\\le 59$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T2 KOŠARKA**_。", "locale": "zh-CN"}}}
{"pid": "P7633", "type": "P", "difficulty": 3, "samples": [["3\n1\n3\n4 ", "2"], ["5\n1\n7\n10\n13\n19 \n", "2"], ["3\n1\n500000000\n999999999", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2010", "COCI（克罗地亚）"], "title": "[COCI 2010/2011 #5] BRODOVI", "background": "", "description": "Mirko 住在一个难得有船经过的有港口的小镇上。然而，直到今天，Mirko 还记得那天所有造访过这个港口的船只都出现了。他用索引 $1$ 表示这一天。\n\n许多天过去了，Mirko 记下了至少有一艘船访问港口的日子，把这些日子命名为娱乐日。\n\n此外，Mirko 注意到每艘船都定期访问港口。例如，长度为 $3$ 的间隔表示某艘船在第 $1$ 天、第 $4$ 天、第 $7$ 天、第 $10$ 天等时间访问港口。\n\n给出 Mirko 的娱乐日列表（包括今天，且今天也是一个娱乐日），计算访问他的港口的最小可能的船只数量。\n\n注:所有娱乐日都出现在 Mirko 的列表上，保证永远存在答案。", "inputFormat": "输入的第 $1$ 行包含一个整数 $N$，即娱乐天的个数。\n\n下面 $N$ 行，每行一个整数 $A_i$，表示表上的娱乐天数，按升序排列。第一个和最后一个娱乐天分别是 Mirko 开始监测港口交通的日期和今天。今天将一直出现在列表上。第一个索引总是 $1$。", "outputFormat": "输出共一行，一个整数，为最小的访问 Mirko 的港口的船舶的数量。", "hint": "**【样例说明#1】**\n\n最少需要两条船，第一条每 $2$ 天来一次，第二条每 $3$ 天来一次。\n\n**【数据范围】**\n\n对于 $70\\%$ 的数据，$A_i\\le 5\\times 10^6$\n\n对于 $100\\%$ 的数据，$2\\le N\\le 5000$，$1 \\le A_i\\le 10^9$\n\n**【说明】**\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $70$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T3 BRODOVI**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2010/2011 #5] BRODOVI", "background": "", "description": "Mirko 住在一个难得有船经过的有港口的小镇上。然而，直到今天，Mirko 还记得那天所有造访过这个港口的船只都出现了。他用索引 $1$ 表示这一天。\n\n许多天过去了，Mirko 记下了至少有一艘船访问港口的日子，把这些日子命名为娱乐日。\n\n此外，Mirko 注意到每艘船都定期访问港口。例如，长度为 $3$ 的间隔表示某艘船在第 $1$ 天、第 $4$ 天、第 $7$ 天、第 $10$ 天等时间访问港口。\n\n给出 Mirko 的娱乐日列表（包括今天，且今天也是一个娱乐日），计算访问他的港口的最小可能的船只数量。\n\n注:所有娱乐日都出现在 Mirko 的列表上，保证永远存在答案。", "inputFormat": "输入的第 $1$ 行包含一个整数 $N$，即娱乐天的个数。\n\n下面 $N$ 行，每行一个整数 $A_i$，表示表上的娱乐天数，按升序排列。第一个和最后一个娱乐天分别是 Mirko 开始监测港口交通的日期和今天。今天将一直出现在列表上。第一个索引总是 $1$。", "outputFormat": "输出共一行，一个整数，为最小的访问 Mirko 的港口的船舶的数量。", "hint": "**【样例说明#1】**\n\n最少需要两条船，第一条每 $2$ 天来一次，第二条每 $3$ 天来一次。\n\n**【数据范围】**\n\n对于 $70\\%$ 的数据，$A_i\\le 5\\times 10^6$\n\n对于 $100\\%$ 的数据，$2\\le N\\le 5000$，$1 \\le A_i\\le 10^9$\n\n**【说明】**\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $70$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T3 BRODOVI**_。", "locale": "zh-CN"}}}
{"pid": "P7634", "type": "P", "difficulty": 3, "samples": [["3\n3 0 1\n0 1 \n", "3"], ["4\n1 5 3 0\n0 2 1 ", "33"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2010", "COCI（克罗地亚）"], "title": "[COCI 2010/2011 #5] HONI", "background": "", "description": "COCI 的出题者必须从一堆题目中选择在下一轮中出现的题目。\n\n题目的难度用 $1$ 到 $n$ 的整数来描述，但是对于某些题目来说，这并不容易准确地确定它们的难度。COCI 的出题者认为这些题目可以被视为有两个连续难度之一。例如，某些题目可以被视为难度为 $3$ 或 $4$。\n\n下一轮 COCI 将包含的 $N$ 个题目。每一个难度，都会有且仅有一个题目。当然，没有题目会出现两次。\n\n找出出题者为下一轮选择题目的不同方法的数量。我们认为两种方法是不同的仅当相同的任务分配给了不同的难度。\n\n由于预期的结果可以非常大，输出的方案数 $\\% 10^9+7$。", "inputFormat": "输入的第一行包含整数 $N$。\n\n第二行包含 $N$ 个整数 $A_i$，第 $i$ 个数代表困难度恰好为 $i$ 的题目的数量。\n\n第三行输入包含 $N-1$ 个整数 $B_i$，第 $i$ 个数代表困难度为 $i$ 或 $i+1$ 的题目的数量。", "outputFormat": "输出共一行，一个整数，表示方案数 $\\% 10^9+7$。", "hint": "**【样例解释#1】**\n\n共 $3$ 种方案：将难度为 $2$ 或 $3$ 的题目视为难度为 $2$ 的，因为难度为 $1$ 的题目有 $3$ 道，所以共 $3$ 种方案。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$2\\le N\\le 10^5$，$0\\le A_i,B_i\\le 10^9$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T4 HONI**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2010/2011 #5] HONI", "background": "", "description": "COCI 的出题者必须从一堆题目中选择在下一轮中出现的题目。\n\n题目的难度用 $1$ 到 $n$ 的整数来描述，但是对于某些题目来说，这并不容易准确地确定它们的难度。COCI 的出题者认为这些题目可以被视为有两个连续难度之一。例如，某些题目可以被视为难度为 $3$ 或 $4$。\n\n下一轮 COCI 将包含的 $N$ 个题目。每一个难度，都会有且仅有一个题目。当然，没有题目会出现两次。\n\n找出出题者为下一轮选择题目的不同方法的数量。我们认为两种方法是不同的仅当相同的任务分配给了不同的难度。\n\n由于预期的结果可以非常大，输出的方案数 $\\% 10^9+7$。", "inputFormat": "输入的第一行包含整数 $N$。\n\n第二行包含 $N$ 个整数 $A_i$，第 $i$ 个数代表困难度恰好为 $i$ 的题目的数量。\n\n第三行输入包含 $N-1$ 个整数 $B_i$，第 $i$ 个数代表困难度为 $i$ 或 $i+1$ 的题目的数量。", "outputFormat": "输出共一行，一个整数，表示方案数 $\\% 10^9+7$。", "hint": "**【样例解释#1】**\n\n共 $3$ 种方案：将难度为 $2$ 或 $3$ 的题目视为难度为 $2$ 的，因为难度为 $1$ 的题目有 $3$ 道，所以共 $3$ 种方案。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$2\\le N\\le 10^5$，$0\\le A_i,B_i\\le 10^9$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T4 HONI**_。", "locale": "zh-CN"}}}
{"pid": "P7635", "type": "P", "difficulty": 4, "samples": [["5 10000\n1\n1\n1\n1\n1 ", "4\n4\n2\n2\n0 \n"], ["5 9\n1\n1\n10\n1\n9 ", "2\n0\n0\n2\n0 "], ["8 3\n1\n1\n1\n1\n1\n1\n1\n1 ", "6\n6\n6\n4\n4\n2\n2\n0 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2010", "COCI（克罗地亚）"], "title": "[COCI 2010/2011 #5] DVONIZ", "background": "", "description": "当前 $K$ 个元素的和与最后 $K$ 个元素的和都不大于 $S$ 时，我们说这个 $2\\times K$ 个元素的序列是有趣的。\n\n给出一个长度为 $N$ 的序列 $A$。对于每个元素，输出从该元素开始的最长的有趣的子段。", "inputFormat": "第一行包含整数 $N$ 和 $S$。\n\n下面的 $N$ 行，每行包含序列 $A$ 中的一个整数 $A_i$。这些整数都是正的且它们的和不超过 $2\\times 10^9$。", "outputFormat": "输出共 $N$ 行。第 $i$ 行包含一个整数，从第 $i$ 元素开始的最长的有趣的子段的长度。\n\n如果当前位置上没有有趣的子段，输出 `0`。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$2\\le N\\le 10^5$，$1\\le S\\le 2\\times 10^9$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T5 DVONIZ**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2010/2011 #5] DVONIZ", "background": "", "description": "当前 $K$ 个元素的和与最后 $K$ 个元素的和都不大于 $S$ 时，我们说这个 $2\\times K$ 个元素的序列是有趣的。\n\n给出一个长度为 $N$ 的序列 $A$。对于每个元素，输出从该元素开始的最长的有趣的子段。", "inputFormat": "第一行包含整数 $N$ 和 $S$。\n\n下面的 $N$ 行，每行包含序列 $A$ 中的一个整数 $A_i$。这些整数都是正的且它们的和不超过 $2\\times 10^9$。", "outputFormat": "输出共 $N$ 行。第 $i$ 行包含一个整数，从第 $i$ 元素开始的最长的有趣的子段的长度。\n\n如果当前位置上没有有趣的子段，输出 `0`。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$2\\le N\\le 10^5$，$1\\le S\\le 2\\times 10^9$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T5 DVONIZ**_。", "locale": "zh-CN"}}}
{"pid": "P7636", "type": "P", "difficulty": 5, "samples": [["4 3 2\nPAINT 2 0 0 3 3\nPAINT 3 0 3 3 3 ", "2 1 2 3\n1 2 1 2\n2 1 2 3\n1 2 1 2 "], ["3 3 4\nPAINT 3 0 0 1 1\nSAVE\nPAINT 2 1 1 2 2\nLOAD 1 ", "3 1 1\n1 3 1\n1 1 1 "], ["3 4 7\nPAINT 2 0 0 1 1\nSAVE\nPAINT 3 1 1 2 2\nSAVE\nPAINT 4 0 2 0 2\nLOAD 2\nPAINT 4 2 0 2 0 ", "2 1 1\n1 3 1\n4 1 3 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "COCI（克罗地亚）"], "title": "[COCI 2010/2011 #5] SLIKA", "background": "", "description": "Mirko 刚刚安装了一个全新的绘图程序。该程序支持 $K$ 种不同的颜色，用从 $1$ 到 $K$ 的整数表示。所有的绘图都是在一个尺寸为 $N\\times N$ 的画布上完成的。在开始时，所有格子都是白色的(用 `1`表示)。\n\n画布左上角的单元格为坐标 $(0,0)$。第一个坐标 $x$ 表示行，第二个坐标 $y$ 表示列。\n\nMirko 最喜欢的消遣是使用 `PAINT c x1 y1 x2 y2` 命令绘制矩形棋盘图案，其中 $c$ 表示所选的颜色，$(x1,y1)$ 和 $(x2,y2)$ 分别是左上的坐标和右下的坐标。\n\n矩形左上角的单元格将被绘制为所选的颜色，而其余的则如棋盘一样涂色。没有被所选颜色覆盖的单元格将保持它们之前的颜色。\n\n例如，一个白色的画布涂上一个红色的棋盘图案看起来就像这样的:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/03pv1kce.png)\n\nMirko最近发现了另外两个命令。他可以随时保存他的画通过使用 `SAVE` 的命令，稍后使用 `load x` 命令再次加载它，其中 $x$ 表示保存的序列号的正整数。\n\n不幸的是，程序崩溃了，Mirko 的画永远丢失了。幸运的是，Mirko 用了一个保存所有已使用命令的日志。你能帮 Mirko 修复那幅丢失的画吗?", "inputFormat": "输入的第一行包含三个正整数 $N,K,M$，$N$ 代表画布的边长，$K$ 代表有 $K$ 种颜色，$M$ 代表命令个数。\n\n下面的 $M$ 行每一行都包含描述的三个命令中的一个。输入将不包含任何非法的命令。", "outputFormat": "输出共 $N$ 行，每一行包含 $N$ 个表示单元格颜色的整数，对应一行的画。", "hint": "**【样例解释#1】**\n\n命令 $1$ 将 $(0,0)$ 到 $(3,3)$ 的格子染成了棋盘式，即把 $(0,0)$，$(0,2)$，$(1,1)$，$(1,3)$，$(2,0)$，$(2,2)$，$(3,1)$，$(3,3)$ 都染成了 $2$。\n\n命令 $2$ 将 $(0,3)$ 到 $(3,3)$ 的格子染成了棋盘式，即把 $(0,3)$，$(2,3)$ 染成了 $3$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 1000$，$2\\le K\\le 10^5$，$1 \\leq M \\leq 10^5$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $130$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T6 SLIKA**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2010/2011 #5] SLIKA", "background": "", "description": "Mirko 刚刚安装了一个全新的绘图程序。该程序支持 $K$ 种不同的颜色，用从 $1$ 到 $K$ 的整数表示。所有的绘图都是在一个尺寸为 $N\\times N$ 的画布上完成的。在开始时，所有格子都是白色的(用 `1`表示)。\n\n画布左上角的单元格为坐标 $(0,0)$。第一个坐标 $x$ 表示行，第二个坐标 $y$ 表示列。\n\nMirko 最喜欢的消遣是使用 `PAINT c x1 y1 x2 y2` 命令绘制矩形棋盘图案，其中 $c$ 表示所选的颜色，$(x1,y1)$ 和 $(x2,y2)$ 分别是左上的坐标和右下的坐标。\n\n矩形左上角的单元格将被绘制为所选的颜色，而其余的则如棋盘一样涂色。没有被所选颜色覆盖的单元格将保持它们之前的颜色。\n\n例如，一个白色的画布涂上一个红色的棋盘图案看起来就像这样的:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/03pv1kce.png)\n\nMirko最近发现了另外两个命令。他可以随时保存他的画通过使用 `SAVE` 的命令，稍后使用 `load x` 命令再次加载它，其中 $x$ 表示保存的序列号的正整数。\n\n不幸的是，程序崩溃了，Mirko 的画永远丢失了。幸运的是，Mirko 用了一个保存所有已使用命令的日志。你能帮 Mirko 修复那幅丢失的画吗?", "inputFormat": "输入的第一行包含三个正整数 $N,K,M$，$N$ 代表画布的边长，$K$ 代表有 $K$ 种颜色，$M$ 代表命令个数。\n\n下面的 $M$ 行每一行都包含描述的三个命令中的一个。输入将不包含任何非法的命令。", "outputFormat": "输出共 $N$ 行，每一行包含 $N$ 个表示单元格颜色的整数，对应一行的画。", "hint": "**【样例解释#1】**\n\n命令 $1$ 将 $(0,0)$ 到 $(3,3)$ 的格子染成了棋盘式，即把 $(0,0)$，$(0,2)$，$(1,1)$，$(1,3)$，$(2,0)$，$(2,2)$，$(3,1)$，$(3,3)$ 都染成了 $2$。\n\n命令 $2$ 将 $(0,3)$ 到 $(3,3)$ 的格子染成了棋盘式，即把 $(0,3)$，$(2,3)$ 染成了 $3$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 1000$，$2\\le K\\le 10^5$，$1 \\leq M \\leq 10^5$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $130$。\n\n题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T6 SLIKA**_。", "locale": "zh-CN"}}}
{"pid": "P7637", "type": "P", "difficulty": 0, "samples": [["8 4\n3 1 2 2\n2 4\n1 4\n0 0\n1 7\n1 4\n1 2\n3 4\n2 3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2006", "BalticOI（波罗的海）"], "title": "[BalticOI 2006] BITWISE EXPRESSIONS (Day 1)", "background": "在信号处理中，当变量是在一定范围内的整数时，人们有时会对包含按位 AND 和 OR 运算符的某个表达式的最大值感兴趣。你要编写一个程序，以这样的表达式和每个变量的范围作为输入，并确定表达式可以接受的最大值。", "description": "为简单起见，该表达式具有特定的形式，即由按位 AND 操作符（表示 $\\& $）分隔的圆括号内的若干子表达式。每个子表达式由一个或多个变量组成，变量之间用按位 OR 操作符（表示为 $|$ ）分隔。使用这种约定，可以通过给出子表达式的数量以及每个子表达式中变量的数量来完全指定表达式。变量只是根据它们在表达式中的出现情况进行编号。  \n举例，如果子表达式的个数为 $4$，并且每个子表达式中的变量个数为 $3$，$1$，$2$，$2$，则表达式为:  \n$$E=(v_1|v_2|v_3) \\& (v_4) \\& (v_5|v_6) \\& (v_7|v_8)$$  \n按位操作符是用普通的方式定义的。例如，要执行 $21 \\& 6$ 的运算，我们首先写下数字（操作数）的二进制形式：$10101$ 和 $110$（因为 $21=2^4+2^2+2^0$ 和 $6=2^2+2^1$）。结果中的每个二进制数字现在都取决于操作数中对应的数字:如果两个操作数中都是 $1$，那么结果数字就是 $1$，否则就是 $0$。如下图最左边所示，结果值为 $4$。如果我们想计算 $21| 6$，其过程是相同的，唯一不同的是，如果对应的数字在任何一个操作数中都是 $1$，则结果是 $1$，因此只有在两个操作数中都是 $0$ 的情况下，结果才会是 $0$。如下图中央所示，结果是 $23$。推广到两个以上操作数是很简单的。下面最右边的例子说明了 $30 \\& 11 \\& 7=2$。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/o3cxkqdr.png)", "inputFormat": "第一行给出两个正整数 $N$ 和 $P$。第二行给出 $P$ 个正整数（$K_1,K_2, \\cdots ,K_P$），其中 $K_i$ 为第 $i$ 个子表达式中的变量个数。$K_i$ 都大于等于 $1$，并且它们的和等于 $N$。下面 $N$ 行中每一行包含两个整数 $A_j$ 和 $B_j$，根据 $A_j \\le v_j \\le B_j$ 指定表达式中第 $j$ 个变量的取值范围。", "outputFormat": "一行，包含一个整数：表达式可以接受的最大值。", "hint": "#### 数据规模与约定  \n对于 $100 \\% $ 的数据，$1 \\le N \\le 100$，$1 \\le P \\le N$，$0 \\le A_j \\le B_j \\le 2×10^9$。  \n#### 样例说明 \n样例限制上述表达式中八个变量的值，分别为：$2 \\le v_1 \\le 4、1 \\le v_2 \\le 4、v_3=0、1 \\le v_4 \\le 7、1 \\le v_5 \\le 4、1 \\le v_6 \\le 2、3 \\le v_7 \\le 4$ 和 $2 \\le v_8 \\le 3$。如果用二进制记数法写，最好的赋值之一给出了表达式 $(100|011|000) \\& (111) \\& (100|010) \\& (100|011)$，从中我们可以注意到，所有子表达式可以变成等于 $7$，除了第三个。  \n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 1:Bitwise](https://www.cs.helsinki.fi/group/boi2006/tasks/bitwise.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2006] BITWISE EXPRESSIONS (Day 1)", "background": "在信号处理中，当变量是在一定范围内的整数时，人们有时会对包含按位 AND 和 OR 运算符的某个表达式的最大值感兴趣。你要编写一个程序，以这样的表达式和每个变量的范围作为输入，并确定表达式可以接受的最大值。", "description": "为简单起见，该表达式具有特定的形式，即由按位 AND 操作符（表示 $\\& $）分隔的圆括号内的若干子表达式。每个子表达式由一个或多个变量组成，变量之间用按位 OR 操作符（表示为 $|$ ）分隔。使用这种约定，可以通过给出子表达式的数量以及每个子表达式中变量的数量来完全指定表达式。变量只是根据它们在表达式中的出现情况进行编号。  \n举例，如果子表达式的个数为 $4$，并且每个子表达式中的变量个数为 $3$，$1$，$2$，$2$，则表达式为:  \n$$E=(v_1|v_2|v_3) \\& (v_4) \\& (v_5|v_6) \\& (v_7|v_8)$$  \n按位操作符是用普通的方式定义的。例如，要执行 $21 \\& 6$ 的运算，我们首先写下数字（操作数）的二进制形式：$10101$ 和 $110$（因为 $21=2^4+2^2+2^0$ 和 $6=2^2+2^1$）。结果中的每个二进制数字现在都取决于操作数中对应的数字:如果两个操作数中都是 $1$，那么结果数字就是 $1$，否则就是 $0$。如下图最左边所示，结果值为 $4$。如果我们想计算 $21| 6$，其过程是相同的，唯一不同的是，如果对应的数字在任何一个操作数中都是 $1$，则结果是 $1$，因此只有在两个操作数中都是 $0$ 的情况下，结果才会是 $0$。如下图中央所示，结果是 $23$。推广到两个以上操作数是很简单的。下面最右边的例子说明了 $30 \\& 11 \\& 7=2$。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/o3cxkqdr.png)", "inputFormat": "第一行给出两个正整数 $N$ 和 $P$。第二行给出 $P$ 个正整数（$K_1,K_2, \\cdots ,K_P$），其中 $K_i$ 为第 $i$ 个子表达式中的变量个数。$K_i$ 都大于等于 $1$，并且它们的和等于 $N$。下面 $N$ 行中每一行包含两个整数 $A_j$ 和 $B_j$，根据 $A_j \\le v_j \\le B_j$ 指定表达式中第 $j$ 个变量的取值范围。", "outputFormat": "一行，包含一个整数：表达式可以接受的最大值。", "hint": "#### 数据规模与约定  \n对于 $100 \\% $ 的数据，$1 \\le N \\le 100$，$1 \\le P \\le N$，$0 \\le A_j \\le B_j \\le 2×10^9$。  \n#### 样例说明 \n样例限制上述表达式中八个变量的值，分别为：$2 \\le v_1 \\le 4、1 \\le v_2 \\le 4、v_3=0、1 \\le v_4 \\le 7、1 \\le v_5 \\le 4、1 \\le v_6 \\le 2、3 \\le v_7 \\le 4$ 和 $2 \\le v_8 \\le 3$。如果用二进制记数法写，最好的赋值之一给出了表达式 $(100|011|000) \\& (111) \\& (100|010) \\& (100|011)$，从中我们可以注意到，所有子表达式可以变成等于 $7$，除了第三个。  \n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 1:Bitwise](https://www.cs.helsinki.fi/group/boi2006/tasks/bitwise.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7638", "type": "P", "difficulty": 0, "samples": [["7 25\n1 0\n2 0\n3 1\n5 0\n10 0\n13 0\n20 0", "3\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2006", "BalticOI（波罗的海）"], "title": "[BalticOI 2006] COIN COLLECTOR (Day 1)", "background": "", "description": "在一个国家，有 $N$ 种面额的硬币在流通，包括 $1$ 分硬币。此外，还有一种面值 $K$ 分的纸币，其价值超过了任何一种硬币。有个硬币收藏家想收集每种面额的硬币标本。他家里已经有几枚硬币了，但目前他的钱包里只有一张 $K$ 分的纸币。他在一家商店里，那里的商品都以低于 $K$ 分的所有价格出售（$1$ 分，$2$ 分，$3$ 分，$\\cdots$，$K-1$ 分）。在这家商店，零钱是按照以下算法找零的：  \n1. 让零钱的数额是 $A$ 分。  \n1. 找到不超过 $A$ 的最高面额(让它是 $B$ 分硬币)。  \n1. 给顾客一枚 $B$ 分硬币，把 $A$ 减去 $B$。  \n1. 如果 $A=0$ ，结束；否则返回步骤 $2$。  \n  \n硬币收藏家用 $K$ 分买了一件东西。  \n你的任务是编写一个程序来确定:     \n\n- 有多少种不同的硬币，收藏家在他的之前的收藏中没有而可以通过此次交易获得?  \n- 在这个过程中，商店能卖给他的最贵的东西是什么?", "inputFormat": "第一行包含整数 $N$ 和 $K$。接下来的 $N$ 行描述流通中的货币。第 $i+1$ 行包含整数 $c_i$ 和 $d_i$，$c_i$ 表示硬币的面额（分），$d_i$ 为 $1$ 表示该收藏家已有该面额硬币，为 $0$ 表示还无。硬币按价值递增的顺序排列，即：$c_1 < c_2 <  \\cdots < c_N$。第一枚硬币已知是 $1$ 分硬币，即：$c_1=1$。", "outputFormat": "第一行包含一个整数，即收集者尚未拥有、但可以通过一次购买获得的最多硬币面额数。第二行包含一个整数，即要购买的商品的最高价格，以便找零包括第一行的新面额的最大数量。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le N \\le 5×10^5$，$2 \\le K \\le 10^9$，$1 \\le c_i \\le K$。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 1:Coins](https://www.cs.helsinki.fi/group/boi2006/tasks/coins.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2006] COIN COLLECTOR (Day 1)", "background": "", "description": "在一个国家，有 $N$ 种面额的硬币在流通，包括 $1$ 分硬币。此外，还有一种面值 $K$ 分的纸币，其价值超过了任何一种硬币。有个硬币收藏家想收集每种面额的硬币标本。他家里已经有几枚硬币了，但目前他的钱包里只有一张 $K$ 分的纸币。他在一家商店里，那里的商品都以低于 $K$ 分的所有价格出售（$1$ 分，$2$ 分，$3$ 分，$\\cdots$，$K-1$ 分）。在这家商店，零钱是按照以下算法找零的：  \n1. 让零钱的数额是 $A$ 分。  \n1. 找到不超过 $A$ 的最高面额(让它是 $B$ 分硬币)。  \n1. 给顾客一枚 $B$ 分硬币，把 $A$ 减去 $B$。  \n1. 如果 $A=0$ ，结束；否则返回步骤 $2$。  \n  \n硬币收藏家用 $K$ 分买了一件东西。  \n你的任务是编写一个程序来确定:     \n\n- 有多少种不同的硬币，收藏家在他的之前的收藏中没有而可以通过此次交易获得?  \n- 在这个过程中，商店能卖给他的最贵的东西是什么?", "inputFormat": "第一行包含整数 $N$ 和 $K$。接下来的 $N$ 行描述流通中的货币。第 $i+1$ 行包含整数 $c_i$ 和 $d_i$，$c_i$ 表示硬币的面额（分），$d_i$ 为 $1$ 表示该收藏家已有该面额硬币，为 $0$ 表示还无。硬币按价值递增的顺序排列，即：$c_1 < c_2 <  \\cdots < c_N$。第一枚硬币已知是 $1$ 分硬币，即：$c_1=1$。", "outputFormat": "第一行包含一个整数，即收集者尚未拥有、但可以通过一次购买获得的最多硬币面额数。第二行包含一个整数，即要购买的商品的最高价格，以便找零包括第一行的新面额的最大数量。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le N \\le 5×10^5$，$2 \\le K \\le 10^9$，$1 \\le c_i \\le K$。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 1:Coins](https://www.cs.helsinki.fi/group/boi2006/tasks/coins.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7639", "type": "P", "difficulty": 5, "samples": [["5\n2 5 14\n2 3 2\n3 2 7\n1 1 2\n2 1 3", "K\nD\nK\n3\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2006", "BalticOI（波罗的海）"], "title": "[BalticOI 2006] COUNTRIES (Day 1)", "background": "任何一个国家都是由弱小而拼搏斗争逐渐强大崛起的。", "description": "考虑地区的二维地图，在这张地图上有 $n$ 个城市。每个城市 $i$ 在地图上都有一个独特的坐标（$x_i$,$y_i$）。每个城市在一个将军的指挥下有 $s_i$ 个士兵。  \n城市 $i$ 对另一个位置（$x$,$y$）的威慑为 $s_i$ 除于它和（$x$,$y$）间距离的平方。这就好像城市 $i$ 中的大量士兵对它周围所有地图位置施加了威慑。如果城市 $j$ 对（$x_i$,$y_i$）的城市 $i$ 的威慑超过其士兵数 $s_i$：城市 $j$ 可以派遣足够的士兵前去制服保卫城市 $i$ 的士兵，那么城市 $i$ 就被城市 $j$ 所威胁。如果城市 $i$ 没有受到任何其他城市 $j$ 的威胁，那么心存感激的市民将选出其无敌的将军作为他们的国王，并将他们的城市变成他的王国的首都。  \n另一方面，如果一些城市 $j$ 对（$x_i$,$y_i$）的城市 $i$ 的威胁比另一个城市 $k$ 对城市 $i$ 的威胁更具威慑，那么城市 $i$ 的居民别无选择：城市 $i$ 只能向城市 $j$ 投降。从今以后，城市 $i$ 必须服从城市 $j$ 所服从的首都；然而城市 $i$ 的士兵并没有加入城市 $j$ 或其首都的军队。除此之外，城市 $i$ 会因为 $j$ 和 $k$ 两个对它具有同等威胁的城市之间相互防备而得救：如果其中一个城市攻击并征服城市 $i$，那么另一个城市将会前来攻击并战胜先前刚战斗完而疲惫不堪的攻击方士兵。但这种情况下，城市 $i$ 的居民们将不再选举他们的将军为他们的国王，因为他未能履行他的职责保护城市免受威胁。因此，他们必须把他们的城市变成一个民主国家的首都。  \n你的任务是编写一个程序，将地图上的城市信息作为输入，并为每个城市 $i$ 输出三种结果之一:  \n- 它是一个王国的首都。  \n- 它是一个民主国家的首都。  \n- 它服从城市 $j$ 作为它的首都。", "inputFormat": "第一行由一个整数 $n$ 组成，表示城市数。接下来的 $n$ 行给出这 $n$ 个城市的信息，每行给出一个城市的。第 $i+1$ 行以三个整数 $x_i$，$y_i$，$s_i$ 表示城市 $i$ 的信息，这三个整数由单个空格字符分隔。", "outputFormat": "输出由 $n$ 行组成，其中第 $i$ 行由城市 $i$ 的结果组成:  \n- 字母 $\\texttt{K}$ 表示城市 $i$ 是一个王国的首都。  \n- 字母 $\\texttt{D}$ 表示城市 $i$ 是一个民主国家的首都。  \n- 正整数 $j$ 表示城市 $i$ 不得不投降而服从其首都的城市 $j$ 。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le n \\le 1000$，$0 \\le x_i,y_i,s_i \\le 1000$，$1 \\le j \\le n$。\n#### 样例说明  \n考虑以下地图，其中每个点代表一个城市，上面给出了它的士兵数量：  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/gmptiqan.png)  \n也就是说，位置（$3$,$2$）上的城市 $3$ 是一个王国的首都，它还包括位置（$1$,$1$）上的城市 $4$ 和位置（$2$,$1$）上的城市 $5$。另一方面，位于位置（$2$,$5$）的城市 $1$ 自己形成了一个王国，而位于位置（$2$,$3$）的城市 $2$ 自己形成了一个民主国家。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 1:Countries](https://www.cs.helsinki.fi/group/boi2006/tasks/countries.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2006] COUNTRIES (Day 1)", "background": "任何一个国家都是由弱小而拼搏斗争逐渐强大崛起的。", "description": "考虑地区的二维地图，在这张地图上有 $n$ 个城市。每个城市 $i$ 在地图上都有一个独特的坐标（$x_i$,$y_i$）。每个城市在一个将军的指挥下有 $s_i$ 个士兵。  \n城市 $i$ 对另一个位置（$x$,$y$）的威慑为 $s_i$ 除于它和（$x$,$y$）间距离的平方。这就好像城市 $i$ 中的大量士兵对它周围所有地图位置施加了威慑。如果城市 $j$ 对（$x_i$,$y_i$）的城市 $i$ 的威慑超过其士兵数 $s_i$：城市 $j$ 可以派遣足够的士兵前去制服保卫城市 $i$ 的士兵，那么城市 $i$ 就被城市 $j$ 所威胁。如果城市 $i$ 没有受到任何其他城市 $j$ 的威胁，那么心存感激的市民将选出其无敌的将军作为他们的国王，并将他们的城市变成他的王国的首都。  \n另一方面，如果一些城市 $j$ 对（$x_i$,$y_i$）的城市 $i$ 的威胁比另一个城市 $k$ 对城市 $i$ 的威胁更具威慑，那么城市 $i$ 的居民别无选择：城市 $i$ 只能向城市 $j$ 投降。从今以后，城市 $i$ 必须服从城市 $j$ 所服从的首都；然而城市 $i$ 的士兵并没有加入城市 $j$ 或其首都的军队。除此之外，城市 $i$ 会因为 $j$ 和 $k$ 两个对它具有同等威胁的城市之间相互防备而得救：如果其中一个城市攻击并征服城市 $i$，那么另一个城市将会前来攻击并战胜先前刚战斗完而疲惫不堪的攻击方士兵。但这种情况下，城市 $i$ 的居民们将不再选举他们的将军为他们的国王，因为他未能履行他的职责保护城市免受威胁。因此，他们必须把他们的城市变成一个民主国家的首都。  \n你的任务是编写一个程序，将地图上的城市信息作为输入，并为每个城市 $i$ 输出三种结果之一:  \n- 它是一个王国的首都。  \n- 它是一个民主国家的首都。  \n- 它服从城市 $j$ 作为它的首都。", "inputFormat": "第一行由一个整数 $n$ 组成，表示城市数。接下来的 $n$ 行给出这 $n$ 个城市的信息，每行给出一个城市的。第 $i+1$ 行以三个整数 $x_i$，$y_i$，$s_i$ 表示城市 $i$ 的信息，这三个整数由单个空格字符分隔。", "outputFormat": "输出由 $n$ 行组成，其中第 $i$ 行由城市 $i$ 的结果组成:  \n- 字母 $\\texttt{K}$ 表示城市 $i$ 是一个王国的首都。  \n- 字母 $\\texttt{D}$ 表示城市 $i$ 是一个民主国家的首都。  \n- 正整数 $j$ 表示城市 $i$ 不得不投降而服从其首都的城市 $j$ 。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le n \\le 1000$，$0 \\le x_i,y_i,s_i \\le 1000$，$1 \\le j \\le n$。\n#### 样例说明  \n考虑以下地图，其中每个点代表一个城市，上面给出了它的士兵数量：  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/gmptiqan.png)  \n也就是说，位置（$3$,$2$）上的城市 $3$ 是一个王国的首都，它还包括位置（$1$,$1$）上的城市 $4$ 和位置（$2$,$1$）上的城市 $5$。另一方面，位于位置（$2$,$5$）的城市 $1$ 自己形成了一个王国，而位于位置（$2$,$3$）的城市 $2$ 自己形成了一个民主国家。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 1:Countries](https://www.cs.helsinki.fi/group/boi2006/tasks/countries.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7640", "type": "P", "difficulty": 0, "samples": [["17 5 4\n100\n107\n114\n121", "1778"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2006", "BalticOI（波罗的海）"], "title": "[BalticOI 2006] CITY PLANNING (Day 2)", "background": "", "description": "一个星球上将建造一个空间站。这个空间站将雇用 $N$ 人。他们必须住在某个地方，为此，空间站周围将建起一座城市。空间站周围的土地被划分为等大小的方形地块，每个地块上可以建一幢最高 $K$ 层的公寓楼。每幢楼每层都应有一套公寓，每个人都应住在单独的公寓里。其空间站的坐标为（$0$,$0$），其余的编号如下所示：\n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/8rtnay67.png)  \n由于地块之间的交通只能在街道上通行，所以地块（$x$,$y$）到空间站的距离为 $|x|+|y|-1$ 个单位。  \n建造一幢座房子的费用等于建每层楼的费用之和。众所周知，建造一个楼层的成本取决于楼层的高度，而不是建筑的位置。  \n将要建造的房子将使用 $30$ 年。住在这些房子里的人将去空间站工作，在这 $30$ 年里，将他们运送到空间站和离开空间站将花费每人 $T·d$，其中 $d$ 是一个人的建筑到空间站的距离。  \n我们可以假设星球足够大，待建的城市只占地表的一小部分，所以我们不需要考虑星球表面的曲率。  \n你的任务是写一个程序来确定 $30$ 年来建造房屋和运营运输系统的最低总成本。", "inputFormat": "第一行包含整数 $N$，$T$和 $K$。接下来的 $K$ 行指定了每层楼的公寓建造成本。第 $i+1$ 行包含整数 $c_i$，表示在第 $i$ 层建造一套公寓的成本（假设所有第 $i−1$ 层以下都已经建造）。众所周知，建设一个较高的楼层总是比建设一个较低的楼层更昂贵：$c_1<c_2< \\cdots <c_k$。", "outputFormat": "唯一的一行包含一个整数——建设城市和运营交通系统 $30$ 年的总成本。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le N \\le 10^{12}$，$1 \\le T \\le 5×10^5$，$1 \\le K \\le 20000$，$1 \\le c_i \\le 2×10^9$，约定答案不超过 $8×10^{18}$（也就是说，它将适合64位带符号整数）。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 2:City](https://www.cs.helsinki.fi/group/boi2006/tasks/city.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2006] CITY PLANNING (Day 2)", "background": "", "description": "一个星球上将建造一个空间站。这个空间站将雇用 $N$ 人。他们必须住在某个地方，为此，空间站周围将建起一座城市。空间站周围的土地被划分为等大小的方形地块，每个地块上可以建一幢最高 $K$ 层的公寓楼。每幢楼每层都应有一套公寓，每个人都应住在单独的公寓里。其空间站的坐标为（$0$,$0$），其余的编号如下所示：\n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/8rtnay67.png)  \n由于地块之间的交通只能在街道上通行，所以地块（$x$,$y$）到空间站的距离为 $|x|+|y|-1$ 个单位。  \n建造一幢座房子的费用等于建每层楼的费用之和。众所周知，建造一个楼层的成本取决于楼层的高度，而不是建筑的位置。  \n将要建造的房子将使用 $30$ 年。住在这些房子里的人将去空间站工作，在这 $30$ 年里，将他们运送到空间站和离开空间站将花费每人 $T·d$，其中 $d$ 是一个人的建筑到空间站的距离。  \n我们可以假设星球足够大，待建的城市只占地表的一小部分，所以我们不需要考虑星球表面的曲率。  \n你的任务是写一个程序来确定 $30$ 年来建造房屋和运营运输系统的最低总成本。", "inputFormat": "第一行包含整数 $N$，$T$和 $K$。接下来的 $K$ 行指定了每层楼的公寓建造成本。第 $i+1$ 行包含整数 $c_i$，表示在第 $i$ 层建造一套公寓的成本（假设所有第 $i−1$ 层以下都已经建造）。众所周知，建设一个较高的楼层总是比建设一个较低的楼层更昂贵：$c_1<c_2< \\cdots <c_k$。", "outputFormat": "唯一的一行包含一个整数——建设城市和运营交通系统 $30$ 年的总成本。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le N \\le 10^{12}$，$1 \\le T \\le 5×10^5$，$1 \\le K \\le 20000$，$1 \\le c_i \\le 2×10^9$，约定答案不超过 $8×10^{18}$（也就是说，它将适合64位带符号整数）。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 2:City](https://www.cs.helsinki.fi/group/boi2006/tasks/city.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7641", "type": "P", "difficulty": 5, "samples": [["4\n20\n1 0 0 1 0 2 3 0 3 2 0 1 0 0 3 0 2 1 0 1", "19\n1 0 1 0 0 0 1 2 3 1 3 2 0 3 0 2 1 0 1"], ["14\n15\n10 10 10 0 10 0 10 10 13 10 10 13 10 10 13", "9\n0 10 13 0 10 13 0 10 10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2006", "Special Judge", "动态规划优化", "BalticOI（波罗的海）"], "title": "[BalticOI 2006] RLE COMPRESSION (Day 2)", "background": "", "description": "RLE 是一种简单的压缩算法，用于压缩包含相同字符后续重复的序列。 通过压缩特定的序列，我们获得其编码。这个想法是用一个计数器表示给定字符（例如 $\\texttt{aaaaa}$）的重复，以表示有多少次重复。即，我们用包含重复标记，重复字符和代表重复次数的整数的三元组来表示它。 例如，$\\texttt{aaaaa}$ 可以编码为 $\\texttt{＃a5}$ （其中 $\\texttt{＃}$ 表示重复标记）。  \n我们需要以某种方式表示字母，重复标记和计数器。让字母由 $n$ 个字符组成，这些字符由集合 $\\Sigma= \\lbrace 0,1, \\cdots ,n-1 \\rbrace$ 中的整数表示。来自 $\\Sigma$ 的字符序列的编码也是来自 $\\Sigma$ 的字符序列。 在任何时候，重复标记都由 $\\Sigma$ 中的字符表示，用 $e$ 表示。最初 $e$ 为 $0$，但在编码过程中可能会改变。  \n该编码解释如下：  \n- 除重复标记外，编码中的任何字符 $a$ 都表示自身；  \n- 如果编码中出现重复标记 $e$，则以下两个字符具有特殊含义：  \n   $\\circ$ 如果 $e$ 后面跟着 $ek$，则表示 $e$ 的 $k+1$ 个重复，  \n   $\\circ$ 否则，如果 $e$ 后跟 $b0$（其中 $b {=}\\mathllap{/\\,} e$），则 $b$ 将是从该点开始的重复标记，  \n   $\\circ$ 否则，如果 $e$ 后面跟随 $bk$（其中 $b {=}\\mathllap{/\\,} e$ 并且 $k>0$），则它表示 $b$ 的 $k+3$ 个重复。  \n  \n使用上述方案，我们可以从 $\\Sigma$ 编码任何字符序列。例如，对于 $n=4$，序列 $\\texttt{1002222223333303020000}$ 可以编码为 $\\texttt{10010230320100302101}$。编码 $\\texttt{1}$ 的第一个字符表示简单 $\\texttt{1}$。接下来的 $\\texttt{001}$ 编码为 $\\texttt{00}$。然后，$\\texttt{023}$ 表示 $\\texttt{222222}$，$\\texttt{032}$ 表示 $\\texttt{33333}$，而 $\\texttt{010}$ 将重复标记切换为 $\\texttt{1}$，然后 $\\texttt{0302}$ 代表自己，最后 $\\texttt{101}$ 编码 $\\texttt{0000}$。  \n序列可以以多种方式编码，并且编码长度可以变化。给定一个已经编码的序列，您的任务是查找字符数最少的编码。  \n编写一个程序，该程序：  \n- 读取字母的大小和序列的编码。  \n- 查找该序列的最短编码。  \n- 写出结果。", "inputFormat": "第一行包含一个整数 $n$：字母的大小。第二行包含一个整数 $m$：编码的长度。最后一行包含 $\\lbrace 0,1, \\cdots ,n−1 \\rbrace$ 中的 $m$ 个整数，这些整数之间用单个空格分隔，表示序列的编码。", "outputFormat": "第一行应包含一个整数 $m'$：代表给定序列的编码中最少的字符数。输出的最后一行应包含集合 $\\lbrace 0,1, \\cdots ,n−1 \\rbrace $中的 $m'$ 个整数，以单个空格分隔：该序列的编码。如果存在几个最短的序列，则程序应输出其中的任何一个。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$2 \\le n \\le 10^5$，$1 \\le m \\le 2×10^6$。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 2:RLE](https://www.cs.helsinki.fi/group/boi2006/tasks/rle.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \nSpecial Judge 感谢 Jakub Pawlewicz 和  @[AzzyZhe](/user/274209)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2006] RLE COMPRESSION (Day 2)", "background": "", "description": "RLE 是一种简单的压缩算法，用于压缩包含相同字符后续重复的序列。 通过压缩特定的序列，我们获得其编码。这个想法是用一个计数器表示给定字符（例如 $\\texttt{aaaaa}$）的重复，以表示有多少次重复。即，我们用包含重复标记，重复字符和代表重复次数的整数的三元组来表示它。 例如，$\\texttt{aaaaa}$ 可以编码为 $\\texttt{＃a5}$ （其中 $\\texttt{＃}$ 表示重复标记）。  \n我们需要以某种方式表示字母，重复标记和计数器。让字母由 $n$ 个字符组成，这些字符由集合 $\\Sigma= \\lbrace 0,1, \\cdots ,n-1 \\rbrace$ 中的整数表示。来自 $\\Sigma$ 的字符序列的编码也是来自 $\\Sigma$ 的字符序列。 在任何时候，重复标记都由 $\\Sigma$ 中的字符表示，用 $e$ 表示。最初 $e$ 为 $0$，但在编码过程中可能会改变。  \n该编码解释如下：  \n- 除重复标记外，编码中的任何字符 $a$ 都表示自身；  \n- 如果编码中出现重复标记 $e$，则以下两个字符具有特殊含义：  \n   $\\circ$ 如果 $e$ 后面跟着 $ek$，则表示 $e$ 的 $k+1$ 个重复，  \n   $\\circ$ 否则，如果 $e$ 后跟 $b0$（其中 $b {=}\\mathllap{/\\,} e$），则 $b$ 将是从该点开始的重复标记，  \n   $\\circ$ 否则，如果 $e$ 后面跟随 $bk$（其中 $b {=}\\mathllap{/\\,} e$ 并且 $k>0$），则它表示 $b$ 的 $k+3$ 个重复。  \n  \n使用上述方案，我们可以从 $\\Sigma$ 编码任何字符序列。例如，对于 $n=4$，序列 $\\texttt{1002222223333303020000}$ 可以编码为 $\\texttt{10010230320100302101}$。编码 $\\texttt{1}$ 的第一个字符表示简单 $\\texttt{1}$。接下来的 $\\texttt{001}$ 编码为 $\\texttt{00}$。然后，$\\texttt{023}$ 表示 $\\texttt{222222}$，$\\texttt{032}$ 表示 $\\texttt{33333}$，而 $\\texttt{010}$ 将重复标记切换为 $\\texttt{1}$，然后 $\\texttt{0302}$ 代表自己，最后 $\\texttt{101}$ 编码 $\\texttt{0000}$。  \n序列可以以多种方式编码，并且编码长度可以变化。给定一个已经编码的序列，您的任务是查找字符数最少的编码。  \n编写一个程序，该程序：  \n- 读取字母的大小和序列的编码。  \n- 查找该序列的最短编码。  \n- 写出结果。", "inputFormat": "第一行包含一个整数 $n$：字母的大小。第二行包含一个整数 $m$：编码的长度。最后一行包含 $\\lbrace 0,1, \\cdots ,n−1 \\rbrace$ 中的 $m$ 个整数，这些整数之间用单个空格分隔，表示序列的编码。", "outputFormat": "第一行应包含一个整数 $m'$：代表给定序列的编码中最少的字符数。输出的最后一行应包含集合 $\\lbrace 0,1, \\cdots ,n−1 \\rbrace $中的 $m'$ 个整数，以单个空格分隔：该序列的编码。如果存在几个最短的序列，则程序应输出其中的任何一个。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$2 \\le n \\le 10^5$，$1 \\le m \\le 2×10^6$。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 2:RLE](https://www.cs.helsinki.fi/group/boi2006/tasks/rle.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \nSpecial Judge 感谢 Jakub Pawlewicz 和  @[AzzyZhe](/user/274209)。", "locale": "zh-CN"}}}
{"pid": "P7642", "type": "P", "difficulty": 4, "samples": [["4\n2 3 3 1\n1 2 1 3\n1 2 3 1\n3 1 1 0", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "高精度", "2006", "BalticOI（波罗的海）"], "title": "[BalticOI 2006] JUMP THE BOARD! (Day 2)", "background": "", "description": "一个 $n×n$ 的游戏板是由整数填充的，每格一个非负整数。目标是从左上角以任何合法路径跳到右下角。任何一格中的整数表示跳离该位置的步长。如果步长将推进越出游戏板，那么在那个特定的方向上的跳步是禁止的。所有的跳步必须是向右或向下。请注意，$0$ 是一个死胡同，它阻止任何进一步的进展。  \n如图 $1$ 中所示的 $4×4$ 板，实圆标识起始位置，虚线圆标识目标位置。图 $2$ 展示了从起点位置到目标位置的三条合法路径，每个路径中都删除了不相关的数字。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/0ql0hhx0.png)  \n你的任务是编写一个程序来确定从左上角到右下角的合法路径的数量。", "inputFormat": "第一行包含一个正整数 $n$，表示该板的行列数。接下来 $n$ 行数据。每行包含 $n$ 个整数，每个整数的范围是 $0 \\cdots 9$。", "outputFormat": "唯一的一行包含一个整数，即从左上角到右下角的合法路径数。", "hint": "#### 数据规模与约定  \n- 对于 $100 \\%$ 的数据， $4 \\le n \\le 100$。  \n- 合法路径的数量可能相当大。使用 $64$ 位整数变量（C 中的 `long long int`，Pascal 中的 `Int64`）只能获得 $70 \\%$ 的分数。可以保证所有的输入导致的路径数可以用不超过 $100$ 位的数字写出。\n\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 2:Jump](https://www.cs.helsinki.fi/group/boi2006/tasks/jump.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2006] JUMP THE BOARD! (Day 2)", "background": "", "description": "一个 $n×n$ 的游戏板是由整数填充的，每格一个非负整数。目标是从左上角以任何合法路径跳到右下角。任何一格中的整数表示跳离该位置的步长。如果步长将推进越出游戏板，那么在那个特定的方向上的跳步是禁止的。所有的跳步必须是向右或向下。请注意，$0$ 是一个死胡同，它阻止任何进一步的进展。  \n如图 $1$ 中所示的 $4×4$ 板，实圆标识起始位置，虚线圆标识目标位置。图 $2$ 展示了从起点位置到目标位置的三条合法路径，每个路径中都删除了不相关的数字。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/0ql0hhx0.png)  \n你的任务是编写一个程序来确定从左上角到右下角的合法路径的数量。", "inputFormat": "第一行包含一个正整数 $n$，表示该板的行列数。接下来 $n$ 行数据。每行包含 $n$ 个整数，每个整数的范围是 $0 \\cdots 9$。", "outputFormat": "唯一的一行包含一个整数，即从左上角到右下角的合法路径数。", "hint": "#### 数据规模与约定  \n- 对于 $100 \\%$ 的数据， $4 \\le n \\le 100$。  \n- 合法路径的数量可能相当大。使用 $64$ 位整数变量（C 中的 `long long int`，Pascal 中的 `Int64`）只能获得 $70 \\%$ 的分数。可以保证所有的输入导致的路径数可以用不超过 $100$ 位的数字写出。\n\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2006](https://www.cs.helsinki.fi/group/boi2006/) 的 [Day 2:Jump](https://www.cs.helsinki.fi/group/boi2006/tasks/jump.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7644", "type": "P", "difficulty": 1, "samples": [["AEB|C", "C-dur"], ["CD|EC|CD|EC|EF|G|EF|G|GAGF|EC|GAGF|EC|CG|C|CG|C", "C-dur"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #5] LJESTVICA", "background": "", "description": "Veronica attends a music academy. She was given a music sheet of a composition with only notes (without annotations), and needs to recognise the scale used. In this problem, we will limit ourselves to only the two most frequently used (and usually taught in schools first) scales: A-minor and C-major. This doesn't make them simpler or more basic than other minor and major scales - all minor scales are mutually equivalent save for translation, and so are major scales.\n\nStill, out of the $12$ tones of an octave $\\{A, A\\#, B, C, C\\#, D, D\\#, E, F, F\\#, G, G\\#\\}$ used in modern music, A-minor and C-major scales do use the tones with shortest names: A-minor is defined as an ordered septuple $(A, B, C, D, E, F, G)$, and C-major as $(C, D, E, F, G, A, B)$.\n\nNotice that the sets of tones of these two scales are equal. What's the difference? The catch is that not only the set of tones, but also their usage, determines a scale. Specifically, the tonic (the first tone of a scale), subdominant (the fourth tone) and dominant (the fifth tone) are the primary candidates for accented tones in a composition. In A-minor, these are A, D, and E, and in C-major, they are C, F, and G. We will name these tones main tones.\n\nAren't the scales still equivalent save for translation? They are not: for example, the third tone of A-minor (C) is three half-tones higher than the tonic (A), while the third tone of C-major (E) is four half-tones higher than the tonic (C). The difference, therefore, lies in the intervals. This makes minor scales \"sad\" and major scales \"happy\".\n\nWrite a program to decide if a composition is more likely written in A-minor or C-major by counting whether there are more main tones of A-minor or of C-major among the accented tones (the first tones in each measure). If there is an equal number of main tones, determine the scale based on the last tone (which is guaranteed to be either A for A-minor or C for C-major in any such test case).\n\nFor example, examine the well-known melody \"Frère Jacques\":\n$$\n\nCD|EC|CD|EC|EF|G|EF|G|GAGF|EC|GAGF|EC|CG|C|CG|C\n\n$$\n\nThe character \"|\" separates measures, so the accented tones are, in order: C, E, C, E, E, G, E, G, E, G, E, G, E, C, C, C, C. Ten of them (C, C, G, G, G, G, C, C, C, C) are main tones of C-major, while six (E, E, E, E, E, E) are main tones of A-minor. Therefore, our best estimate is that the song was written in C-major.", "inputFormat": "The first and only line of input contains a sequence of at least $5$, and at most $100$, characters from the set $\\{\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"|\"\\}$. This is a simplified notation for a composition, where the character \"|\" separates measures. The characters \"|\" will never appear adjacent to one another, at the beginning, or at the end of the sequence.", "outputFormat": "The first and only line of output must contain the text \"C-dur\" (for C-major) or \"A-mol\" (for A-minor).", "hint": "Source:[COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T1 LJESTVICA**_ ", "locale": "en", "translations": {"en": {"title": "[COCI 2012/2013 #5] LJESTVICA", "background": "", "description": "Veronica attends a music academy. She was given a music sheet of a composition with only notes (without annotations), and needs to recognise the scale used. In this problem, we will limit ourselves to only the two most frequently used (and usually taught in schools first) scales: A-minor and C-major. This doesn't make them simpler or more basic than other minor and major scales - all minor scales are mutually equivalent save for translation, and so are major scales.\n\nStill, out of the $12$ tones of an octave $\\{A, A\\#, B, C, C\\#, D, D\\#, E, F, F\\#, G, G\\#\\}$ used in modern music, A-minor and C-major scales do use the tones with shortest names: A-minor is defined as an ordered septuple $(A, B, C, D, E, F, G)$, and C-major as $(C, D, E, F, G, A, B)$.\n\nNotice that the sets of tones of these two scales are equal. What's the difference? The catch is that not only the set of tones, but also their usage, determines a scale. Specifically, the tonic (the first tone of a scale), subdominant (the fourth tone) and dominant (the fifth tone) are the primary candidates for accented tones in a composition. In A-minor, these are A, D, and E, and in C-major, they are C, F, and G. We will name these tones main tones.\n\nAren't the scales still equivalent save for translation? They are not: for example, the third tone of A-minor (C) is three half-tones higher than the tonic (A), while the third tone of C-major (E) is four half-tones higher than the tonic (C). The difference, therefore, lies in the intervals. This makes minor scales \"sad\" and major scales \"happy\".\n\nWrite a program to decide if a composition is more likely written in A-minor or C-major by counting whether there are more main tones of A-minor or of C-major among the accented tones (the first tones in each measure). If there is an equal number of main tones, determine the scale based on the last tone (which is guaranteed to be either A for A-minor or C for C-major in any such test case).\n\nFor example, examine the well-known melody \"Frère Jacques\":\n$$\n\nCD|EC|CD|EC|EF|G|EF|G|GAGF|EC|GAGF|EC|CG|C|CG|C\n\n$$\n\nThe character \"|\" separates measures, so the accented tones are, in order: C, E, C, E, E, G, E, G, E, G, E, G, E, C, C, C, C. Ten of them (C, C, G, G, G, G, C, C, C, C) are main tones of C-major, while six (E, E, E, E, E, E) are main tones of A-minor. Therefore, our best estimate is that the song was written in C-major.", "inputFormat": "The first and only line of input contains a sequence of at least $5$, and at most $100$, characters from the set $\\{\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"|\"\\}$. This is a simplified notation for a composition, where the character \"|\" separates measures. The characters \"|\" will never appear adjacent to one another, at the beginning, or at the end of the sequence.", "outputFormat": "The first and only line of output must contain the text \"C-dur\" (for C-major) or \"A-mol\" (for A-minor).", "hint": "Source:[COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T1 LJESTVICA**_ ", "locale": "en"}, "zh-CN": {"title": "[COCI 2012/2013 #5] LJESTVICA", "background": "Veronica 在音乐学院上学，她拿到了一张只有音符的乐谱，并且需要识别其所使用的音阶。", "description": "在这个问题中，我们只考虑 A 小调和 C 大调。其中 A 小调音阶为 $\\{ A,B,C,D,E,F,G \\}$，C 大调音阶为 $\\{ C,D,E,F,G,A,B \\}$。\n\n称每个音阶的第一个、第四个和第五个音为主调，你需要判断给定的乐谱是 A 小调或是 C 大调。\n\n判断方法：\n\n判断此乐谱中每个小节的第一个音符，是 A 小调的主调或是 C 大调的主调，最后判断哪个音阶的主音个数更多。\n\n如果两者个数一样多，取整个乐谱的最后一个音符。如果最后一个音符为 A 则属于 A 小调，否则属于 C 大调。", "inputFormat": "输入共一行，一个字符串，表示给出的乐谱，保证给出的乐谱中只包含 $\\{ $`A`,`B`,`C`,`D`,`E`,`F`,`G`,`|` $\\}$，其中 `|` 用来分割小节。", "outputFormat": "输出共一行，一个字符串 `C-dur` 表示 C 大调，或 `A-mol` 表示 A 小调。", "hint": "**【样例解释#1】**\n\n两个小节的第一个音符分别为 `A` 和 `C`，由于两个音阶的主调个数相同，取后出现的 `C`，即 C 大调。\n\n\n------------\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，保证 $5\\le$ 乐谱长度 $\\le100$，且给出的乐谱合法。\n\n\n------------\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 [COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T1 LJESTVICA**_ 。", "locale": "zh-CN"}}}
{"pid": "P7645", "type": "P", "difficulty": 2, "samples": [["5 3\n...\n.X.\n.X.\n.X.\n...", "X"], ["3 10\n..........\n..XXX.XXX.\nXXX.......\n", ".XX...X\nXX....."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #5] ARHIPELAG", "background": "", "description": "A popular tourist destination country is situated on a breathtakingly beautiful archipelago constantly bathed by the sun. The country's residents are very proud of their numerous islands. However, global warming has them very worried: raising sea levels are resulting in rapidly increasing loss of dry land, which is diminishing the beauty of the archipelago.\n\nThe map of the archipelago is represented by a grid of $R$ by $C$ squares (characters). The character 'X' (uppercase letter x) represents dry land, while '.' (period) represents sea.\n\nIt has been estimated that, in fifty years, sea will have flooded every square of land that is currently surrounded by sea on three or on all four sides (north, south, east, west). Assume that all squares outside the map (along the edges) are covered by sea.\n\nYour task is computing the map of the archipelago in fifty years (after the described sea level rise). Since there will probably be less land than today, you shouldn't print out the whole map, but only its smallest rectangular part that contains all land squares. It is guaranteed that at least one square of land will remain in all test cases.", "inputFormat": "The first line of input contains two positive integers, $R$ and $C$ ( $1 \\le R, C \\le 10$ ), the dimensions of the current map.\n\nEach of the following $R$ lines contains $C$ characters. These $R$ by $C$ characters represent the current map of the archipelago.", "outputFormat": "The output must contain an appropriate number of lines representing the required rectangular part of the future (flooded) map.", "hint": "Source:[COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T2 ARHIPELAG**_", "locale": "en", "translations": {"en": {"title": "[COCI 2012/2013 #5] ARHIPELAG", "background": "", "description": "A popular tourist destination country is situated on a breathtakingly beautiful archipelago constantly bathed by the sun. The country's residents are very proud of their numerous islands. However, global warming has them very worried: raising sea levels are resulting in rapidly increasing loss of dry land, which is diminishing the beauty of the archipelago.\n\nThe map of the archipelago is represented by a grid of $R$ by $C$ squares (characters). The character 'X' (uppercase letter x) represents dry land, while '.' (period) represents sea.\n\nIt has been estimated that, in fifty years, sea will have flooded every square of land that is currently surrounded by sea on three or on all four sides (north, south, east, west). Assume that all squares outside the map (along the edges) are covered by sea.\n\nYour task is computing the map of the archipelago in fifty years (after the described sea level rise). Since there will probably be less land than today, you shouldn't print out the whole map, but only its smallest rectangular part that contains all land squares. It is guaranteed that at least one square of land will remain in all test cases.", "inputFormat": "The first line of input contains two positive integers, $R$ and $C$ ( $1 \\le R, C \\le 10$ ), the dimensions of the current map.\n\nEach of the following $R$ lines contains $C$ characters. These $R$ by $C$ characters represent the current map of the archipelago.", "outputFormat": "The output must contain an appropriate number of lines representing the required rectangular part of the future (flooded) map.", "hint": "Source:[COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T2 ARHIPELAG**_", "locale": "en"}, "zh-CN": {"title": "[COCI 2012/2013 #5] ARHIPELAG", "background": "一个受欢迎的旅游目的地国家坐落在一个惊人美丽的群岛上沐浴在阳光下。这个国家的居民以其众多的岛屿为傲。然而,全球气候变暖让他们非常担心:海平面上升导致干燥土地的流失迅速增加，这削弱了群岛的美丽。", "description": "这个群岛的地图是一个 $R$ 行 $C$ 列的方阵。`X` 表示陆地，`.` 表示海。据估计，在 $50$ 年里，海水将淹没目前所有三面或四面环海的土地。\n\n假设地图外全被海覆盖。你的任务是计算出 $50$ 年后的群岛地图(在所描述的海平面上升之后)。\n\n因为那时的土地可能会比今天更少，你不需要打印出整个地图，而只是包含所有的土地的最小的矩形部分。", "inputFormat": "第一行包含两个整数 $R$ 和 $C$，表示地图有 $R$ 行 $C$ 列；\n\n第 $2$ 至 $R+1$ 行，目前群岛的地图，`X` 表示陆地，`.` 表示海。", "outputFormat": "一个矩阵，表示 $50$ 年后群岛的地图。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le R,C \\le 10$。\n\n\n------------\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 [COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T2 ARHIPELAG**_。", "locale": "zh-CN"}}}
{"pid": "P7646", "type": "P", "difficulty": 4, "samples": [["9 3 5\n1 2 3\n1 4 5\n3 6 7\n5 6 7\n6 8 9", "4"], ["15 8 4\n11 12 8 14 13 6 10 7\n1 5 8 12 13 6 2 4\n10 15 4 5 9 8 14 12\n11 12 14 3 5 6 1 13", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #5] HIPERCIJEVI", "background": "", "description": "In a galaxy far, far away, the fastest method of transportation is using hypertubes. Each hypertube directly connects $K$ stations with each other. What is the minimum number of stations that we need to pass through in order to get from station $1$ to station $N$?", "inputFormat": "The first line of input contains three positive integers: $N$ ( $1 \\le N \\le 100000$ ), the number of stations, $K$ ( $1 \\le K \\le 1000$ ), the number of stations that any single hypertube directly interconnects, and $M$ ( $1 \\le M \\le 1000$ ), the number of hypertubes.\n\nEach of the following $M$ lines contains the description of a single hypertube: $K$ positive integers, the labels of stations connected to that hypertube.", "outputFormat": "The first and only line of output must contain the required minimum number of stations. If it isn't possible to travel from station $1$ to station $N$, output $-1$.", "hint": "Clarification of the first example: It is possible to travel from station $1$ to station $9$ using only four stations in the following ways: $1$-$3$-$6$-$9$, or $1$-$5$-$6$-$9$.\n\nSource:[COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST#5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T4 HIPERCIJEVI**_", "locale": "en", "translations": {"en": {"title": "[COCI 2012/2013 #5] HIPERCIJEVI", "background": "", "description": "In a galaxy far, far away, the fastest method of transportation is using hypertubes. Each hypertube directly connects $K$ stations with each other. What is the minimum number of stations that we need to pass through in order to get from station $1$ to station $N$?", "inputFormat": "The first line of input contains three positive integers: $N$ ( $1 \\le N \\le 100000$ ), the number of stations, $K$ ( $1 \\le K \\le 1000$ ), the number of stations that any single hypertube directly interconnects, and $M$ ( $1 \\le M \\le 1000$ ), the number of hypertubes.\n\nEach of the following $M$ lines contains the description of a single hypertube: $K$ positive integers, the labels of stations connected to that hypertube.", "outputFormat": "The first and only line of output must contain the required minimum number of stations. If it isn't possible to travel from station $1$ to station $N$, output $-1$.", "hint": "Clarification of the first example: It is possible to travel from station $1$ to station $9$ using only four stations in the following ways: $1$-$3$-$6$-$9$, or $1$-$5$-$6$-$9$.\n\nSource:[COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST#5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T4 HIPERCIJEVI**_", "locale": "en"}, "zh-CN": {"title": "[COCI 2012/2013 #5] HIPERCIJEVI", "background": "", "description": "在遥远的星系中，最快的运输方式是超级管道，它们将 $K$ 个站台连接在一起。从站台 $1$ 到达站台 $N$ 最少需要经过多少个站台?", "inputFormat": "第一行，三个整数 $N,K,M$，分别表示站台数，每根超级管道连接的站台数和超级管道数。\n\n接下来 $M$ 行，每行 $K$ 个正整数，表示这跟超级管道连接的站台编号。", "outputFormat": "一行，一个正整数，表示最少需要经过的站台数，如果到达不了站台 $N$ ，则输出 `-1`。", "hint": "**【样例解释#1】**\n\n有两种方法从站台 $1$ 走到站台 $9$：\n\n$1\\Rightarrow 3\\Rightarrow 6\\Rightarrow 9$ 或 $1\\Rightarrow 5\\Rightarrow 6\\Rightarrow 9$\n\n共经过了 $4$ 个站台，可以证明这是经过站台最少的情况。\n\n\n------------\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5$，$1\\le K,M\\le 1000$。\n\n\n------------\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 [COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST#5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T4 HIPERCIJEVI**_。", "locale": "zh-CN"}}}
{"pid": "P7647", "type": "P", "difficulty": 5, "samples": [["4 2 2\n2 2\n1 1\n3 2 1 0", "0 1 2 3"], ["8 4 4\n1 3\n1 15\n1 -5\n2 -1\n6 10 14 19 2 16 17 1", "6 10 14 1 2 16 17 19"], ["9 3 5\n1 1\n2 -8\n2 9\n1 1\n2 -4\n3 1 8 7 4 5 2 6 9", "5 3 6 9 7 1 8 2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #5] ROTIRAJ", "background": "", "description": "Mislav and Marko have devised a new game, creatively named Rotate. First, Mirko imagines a number sequence of length $N$ and divides it into sections, with each section containing $K$ numbers ($K$ evenly divides $N$). The first section contains numbers in the first $K$ positions in the sequence, the second section the following $K$ positions, and so on.\n\nThen, Marko asks Mislav to apply a number of operations on the sequence, with each operation being one of the following two types:\n\n1. Rotate the numbers in each section to the left/right by $X$ positions\n2. Rotate the whole sequence to the left/right by $X$ positions\n\nNotice that an operation of type 2 can change the numbers belonging to each section. After applying all the operations, Mislav reveals the final sequence to Marko. Marko's task is finding Mislav's starting sequence. He has asked you for help.", "inputFormat": "The first line of input contains three positive integers: $N$ ( $1 \\le N \\le 100000$ ), the length of the sequence, $K$ ( $1 \\le K \\le 100000$ ), the size of each section, and $Q$ ( $1 \\le Q \\le 100000$ ), the number of operations.\n\nEach of the following $Q$ lines contains two integers: $A$ ( $1 \\le A \\le 2$ ), the operation type, and $X$ ( $-100000 \\le X \\le 100000$ ), the number of positions to rotate by. A negative number represents rotation to the left, while a positive one represents rotation to the right.\n\nThe last line of input contains $N$ space-separated integers $Z_i$ ( $0 \\le Z_i \\le 100000$ ) representing the final sequence (after applying all operations).", "outputFormat": "The first and only line of output must contain the required starting sequence.", "hint": "### SCORING\n\nIn test data worth at least $40\\%$ of total points, $N$ will be at most $100$. In test data worth at least $70\\%$ of total points, $K$ will be at most $100$.\n\n### Clarification of the first example\n\nThe starting sequence is $0\\ 1\\ 2\\ 3$. After the first operation, the sequence is $2\\ 3\\ 0\\ 1$, and after the second operation, it becomes $3\\ 2\\ 1\\ 0$. This corresponds to the final sequence.\n\nSource:[COCI2012_2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T5 ROTIRAJ**_", "locale": "en", "translations": {"en": {"title": "[COCI 2012/2013 #5] ROTIRAJ", "background": "", "description": "Mislav and Marko have devised a new game, creatively named Rotate. First, Mirko imagines a number sequence of length $N$ and divides it into sections, with each section containing $K$ numbers ($K$ evenly divides $N$). The first section contains numbers in the first $K$ positions in the sequence, the second section the following $K$ positions, and so on.\n\nThen, Marko asks Mislav to apply a number of operations on the sequence, with each operation being one of the following two types:\n\n1. Rotate the numbers in each section to the left/right by $X$ positions\n2. Rotate the whole sequence to the left/right by $X$ positions\n\nNotice that an operation of type 2 can change the numbers belonging to each section. After applying all the operations, Mislav reveals the final sequence to Marko. Marko's task is finding Mislav's starting sequence. He has asked you for help.", "inputFormat": "The first line of input contains three positive integers: $N$ ( $1 \\le N \\le 100000$ ), the length of the sequence, $K$ ( $1 \\le K \\le 100000$ ), the size of each section, and $Q$ ( $1 \\le Q \\le 100000$ ), the number of operations.\n\nEach of the following $Q$ lines contains two integers: $A$ ( $1 \\le A \\le 2$ ), the operation type, and $X$ ( $-100000 \\le X \\le 100000$ ), the number of positions to rotate by. A negative number represents rotation to the left, while a positive one represents rotation to the right.\n\nThe last line of input contains $N$ space-separated integers $Z_i$ ( $0 \\le Z_i \\le 100000$ ) representing the final sequence (after applying all operations).", "outputFormat": "The first and only line of output must contain the required starting sequence.", "hint": "### SCORING\n\nIn test data worth at least $40\\%$ of total points, $N$ will be at most $100$. In test data worth at least $70\\%$ of total points, $K$ will be at most $100$.\n\n### Clarification of the first example\n\nThe starting sequence is $0\\ 1\\ 2\\ 3$. After the first operation, the sequence is $2\\ 3\\ 0\\ 1$, and after the second operation, it becomes $3\\ 2\\ 1\\ 0$. This corresponds to the final sequence.\n\nSource:[COCI2012_2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T5 ROTIRAJ**_", "locale": "en"}, "zh-CN": {"title": "[COCI 2012/2013 #5] ROTIRAJ", "background": "", "description": "给定一个长度为 $N$ 的序列，将其划分，使每个子序列正好有 $K$ 个数（保证 $K$ 能被 $N$ 整除），有两种操作：\n\n- 一、将每个序列中的数字向左/向右移动 $X$ 个位置\n\n- 二、将整个序列向左/向右移动 $X$ 个位置\n\n注意只有操作二才能改变子序列中的数字。\n\n现给出所有操作后得到的序列和所有操作，请你求出原始序列。", "inputFormat": "第一行三个正整数 $N,K,Q$，分别表示操作后序列的长度，每个子序列的长度和操作数。\n\n接下来 $Q$ 行，每行两个正整数 $A_i$ 和 $X_i$，分别表示操作类型和移动的长度。$X>0$ 时表示向右移动，$X<0$ 时表示向左移动。\n\n最后一行包含 $N$ 个整数 $Z_i$，表示操作后的序列。", "outputFormat": "共一行，$N$ 个整数，表示原始序列。", "hint": "**【样例解释#1】**\n\n起始序列是 $[0,1,2,3]$，第一个操作后变为 $[2,3,0,1]$，第二个操作后变为 $[3,2,1,0]$。\n\n\n------------\n\n**【数据范围】**\n\n对于 $40\\%$ 的数据，$1\\le N\\le 100$；\n\n对于 $70\\%$ 的数据，$1\\le K\\le 100$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5$，$1\\le N\\le 10^5$，$1\\le Q\\le 10^5$，$1\\le A_i\\le 2$，$-10^5\\le X_i\\le 10^5$，$0\\le Z_i\\le 10^5$。\n\n\n------------\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自 [COCI2012_2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T5 ROTIRAJ**_。", "locale": "zh-CN"}}}
{"pid": "P7648", "type": "P", "difficulty": 6, "samples": [["1 1 2\n0.5 0 1 1\n0.5 0 1 1", "0.56250\n0.18750\n0.25000"], ["2 2 5\n0.0 1 2 2 1 2\n1.0 0 0\n0.5 1 0 2\n0.5 1 0 1", "0.2578125\n0.2812500\n0.0703125\n0.1718750\n0.1640625\n0.0234375\n0.0156250\n0.0156250"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2012", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #5] MNOGOMET", "background": "", "description": "$2N$ people are playing football (soccer), divided into two teams. Each player wears a dress with the team logo and a unique (in the team) positive integer between $1$ and $N$, inclusive. For each player, we know his precision, the set of teammates whom he can pass the ball to ($F$) and the set of opponents who can take the ball from him ($E$). When a player comes into possession of the ball, after exactly one second one of the following events will happen:\n\n- the player passes the ball to a random teammate from the set $F$;\n- a random opponent from the set $E$ takes the ball from him;\n- the player attempts a shot at the goal.\n\nIf the player attempts a shot, the probability of scoring a goal is equal to his precision. After the shot, whether it was successful or not, the ball is awarded to the player number $1$ from the opposing team.\n\nThe probabilities of different events are in the proportion $|F| : |E| : 1$, in order, and depend only on the player currently in possession of the ball ( $|S|$ determines the size of the set $S$ corresponding to the current player), not on any previous events in the game. The word \"random\" means that all players from the set $F$ (or $E$) have the same probability of being passed (or taking) the ball by (from) the player that is currently in the ball's possession. The time that a ball spends outside of a player's possession is negligible.\n\nThe match begins with player $1$ from the first team in possession of the ball and ends either when one team has scored $R$ goals or when $T$ seconds have elapsed, whichever happens first. For each possible final score, determine the probability that the match will end with it.", "inputFormat": "The first line of input contains three positive integers: $N$ ( $1 \\le N \\le 100$ ), the number of players in each team, $R$ ( $1 \\le R \\le 10$ ), the number of goals needed for victory, and $T$ ( $1 \\le T \\le 500$ ), the maximum duration of the match.\n\nThe following $N$ lines contain descriptions of the first team's players, one per line, while the next $N$ lines after that contain descriptions of the second team's players. A description of a single player consists of a real number $p$ ( $0 \\le p \\le 1$ ), the player's precision, followed by two positive integers, $nF$ ( $0 \\le nF \\le N - 1$ ) and $nE$ ( $0 \\le nE \\le N$ ), the sizes of the sets $F$ and $E$, respectively, followed by $nF + nE$ player labels representing the sets $F$ and $E$ themselves (in that order), all space-separated. Note that the labels from $F$ represent players from one team, and labels from $E$ the other team. The set $F$ will not contain the label of the player currently being described.", "outputFormat": "The match can theoretically end with one of $R \\times (R + 2)$ different final results. For each result, output the probability of its realization as a real number, one per line. Order the results first by the number of goals scored by the first team, then by the number of goals scored by the second team, in ascending order. The permitted difference from the exact value for each probability is $0.000001$.", "hint": "Clarification of the first example: The star denotes the player in possession of the ball in the beginning. The match lasts for only $T = 2$ moves or until someone scores $R = 1$ goal. Since $N = 1$, there are only two players in the match, playing one against the other. Both players have the precision of $0.5$, which means that each has a $50\\%$ chance of scoring a goal when trying to shoot, after which the ball is awarded to the opponent.\n\nLet us label the grey player as A, and the white player as B. Under these assumptions, there are only $6$ possible matches. Each of them is described in the table below, with the corresponding probability, description and outcome:\n\n| Probability | Description | Outcome |\n|-------------|-------------|---------|\n| $0.25$ | A decides to shoot and scores! | 1:0 |\n| $0.25 \\times 0.25$ | A decides to shoot, but misses. 0:1 B decides to shoot and scores! | 0:1 |\n| $0.25 \\times 0.25$ | A decides to shoot, but misses. 0:0 B decides to shoot, but also misses. | 0:0 |\n| $0.50 \\times 0.25$ | A loses the ball to B. 0:1 B decides to shoot and scores! | 0:1 |\n| $0.50 \\times 0.50$ | A loses the ball to B. 0:0 B loses the ball to A. | 0:0 |\n| $0.50 \\times 0.25$ | A loses the ball to B. 0:0 B decides to shoot, but misses. | 0:0 |\n\nBy summing probabilities for particular final results, we obtain the following solution:\n\n| Result | Probability |\n|--------|-------------|\n| 0:0 | $0.25 \\times 0.25 + 0.5 \\times 0.5 + 0.5 \\times 0.25 = 0.5625$ |\n| 0:1 | $0.25 \\times 0.25 + 0.5 \\times 0.25 = 0.1875$ |\n| 1:0 | $0.25$ |\n\nSource:[COCI2012_2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T6 MNOGOMET**_", "locale": "en", "translations": {"en": {"title": "[COCI 2012/2013 #5] MNOGOMET", "background": "", "description": "$2N$ people are playing football (soccer), divided into two teams. Each player wears a dress with the team logo and a unique (in the team) positive integer between $1$ and $N$, inclusive. For each player, we know his precision, the set of teammates whom he can pass the ball to ($F$) and the set of opponents who can take the ball from him ($E$). When a player comes into possession of the ball, after exactly one second one of the following events will happen:\n\n- the player passes the ball to a random teammate from the set $F$;\n- a random opponent from the set $E$ takes the ball from him;\n- the player attempts a shot at the goal.\n\nIf the player attempts a shot, the probability of scoring a goal is equal to his precision. After the shot, whether it was successful or not, the ball is awarded to the player number $1$ from the opposing team.\n\nThe probabilities of different events are in the proportion $|F| : |E| : 1$, in order, and depend only on the player currently in possession of the ball ( $|S|$ determines the size of the set $S$ corresponding to the current player), not on any previous events in the game. The word \"random\" means that all players from the set $F$ (or $E$) have the same probability of being passed (or taking) the ball by (from) the player that is currently in the ball's possession. The time that a ball spends outside of a player's possession is negligible.\n\nThe match begins with player $1$ from the first team in possession of the ball and ends either when one team has scored $R$ goals or when $T$ seconds have elapsed, whichever happens first. For each possible final score, determine the probability that the match will end with it.", "inputFormat": "The first line of input contains three positive integers: $N$ ( $1 \\le N \\le 100$ ), the number of players in each team, $R$ ( $1 \\le R \\le 10$ ), the number of goals needed for victory, and $T$ ( $1 \\le T \\le 500$ ), the maximum duration of the match.\n\nThe following $N$ lines contain descriptions of the first team's players, one per line, while the next $N$ lines after that contain descriptions of the second team's players. A description of a single player consists of a real number $p$ ( $0 \\le p \\le 1$ ), the player's precision, followed by two positive integers, $nF$ ( $0 \\le nF \\le N - 1$ ) and $nE$ ( $0 \\le nE \\le N$ ), the sizes of the sets $F$ and $E$, respectively, followed by $nF + nE$ player labels representing the sets $F$ and $E$ themselves (in that order), all space-separated. Note that the labels from $F$ represent players from one team, and labels from $E$ the other team. The set $F$ will not contain the label of the player currently being described.", "outputFormat": "The match can theoretically end with one of $R \\times (R + 2)$ different final results. For each result, output the probability of its realization as a real number, one per line. Order the results first by the number of goals scored by the first team, then by the number of goals scored by the second team, in ascending order. The permitted difference from the exact value for each probability is $0.000001$.", "hint": "Clarification of the first example: The star denotes the player in possession of the ball in the beginning. The match lasts for only $T = 2$ moves or until someone scores $R = 1$ goal. Since $N = 1$, there are only two players in the match, playing one against the other. Both players have the precision of $0.5$, which means that each has a $50\\%$ chance of scoring a goal when trying to shoot, after which the ball is awarded to the opponent.\n\nLet us label the grey player as A, and the white player as B. Under these assumptions, there are only $6$ possible matches. Each of them is described in the table below, with the corresponding probability, description and outcome:\n\n| Probability | Description | Outcome |\n|-------------|-------------|---------|\n| $0.25$ | A decides to shoot and scores! | 1:0 |\n| $0.25 \\times 0.25$ | A decides to shoot, but misses. 0:1 B decides to shoot and scores! | 0:1 |\n| $0.25 \\times 0.25$ | A decides to shoot, but misses. 0:0 B decides to shoot, but also misses. | 0:0 |\n| $0.50 \\times 0.25$ | A loses the ball to B. 0:1 B decides to shoot and scores! | 0:1 |\n| $0.50 \\times 0.50$ | A loses the ball to B. 0:0 B loses the ball to A. | 0:0 |\n| $0.50 \\times 0.25$ | A loses the ball to B. 0:0 B decides to shoot, but misses. | 0:0 |\n\nBy summing probabilities for particular final results, we obtain the following solution:\n\n| Result | Probability |\n|--------|-------------|\n| 0:0 | $0.25 \\times 0.25 + 0.5 \\times 0.5 + 0.5 \\times 0.25 = 0.5625$ |\n| 0:1 | $0.25 \\times 0.25 + 0.5 \\times 0.25 = 0.1875$ |\n| 1:0 | $0.25$ |\n\nSource:[COCI2012_2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T6 MNOGOMET**_", "locale": "en"}, "zh-CN": {"title": "[COCI 2012/2013 #5] MNOGOMET", "background": null, "description": "$2N$ 个球员正在踢足球，分成两个队伍。每个球员都穿着队服，上面印着一个在队中独一无二的 $1$ 至 $N$ 的正整数编号，包括 $1$ 和 $N$。对于每个球员，我们都知道他的**精准度**、他能把球传给的**队友**集合 $F$、以及能抢断他的**对手**集合 $E$。当一名球员接到球的**恰好一秒**后，会发生以下情况中的一种:\n\n* 球员将球传给集合 $F$ 中的**随机**一名队友；\n* 集合 $E$ 中的**随机**一位对手将球夺过；\n* 球员试图射门。\n\n如果球员试图射门，进球得分的概率等于他的精准度。无论射门成功与否，球都会被判给**对方**的 $1$ 号球员。\n\n这些事件发生概率的比例依次为 $|F|:|E|:1$，即只由目前持球的玩家决定，与之前发生的事件无关，其中 $|S|$ 代表集合 $S$ 的大小。“随机”一词指的是集合 $F$ 或 $E$ 中的所有球员均有**相同的概率**被选中。不需要考虑传球的时间。\n\n比赛以第一个队伍的球员 $1$ 持球开始，并在某一个球队进了 $R$ 个球或者 $T$ 秒后结束（以两者中先发生的时间为准）。对于**每一种可能的最终比分**，输出比赛以该比分结束的概率。", "inputFormat": "第一行包含三个正整数 $N,R,T$，分别表示每个队伍中球员的人数，赢得比赛需要的进球数和比赛的时长。\n\n接下来的 $N$ 行，描述第一个队伍中球员的信息；再下来的 $N$ 行，描述第二个队伍中球员的信息。\n\n每一个球员的信息占一行，包含：一个实数 $p$，表示此球员的精准度；两个正整数 $N_F,N_E$，分别表示集合 $F$ 和 $E$ 的大小；接下来 $N_F$ 个数，表示集合 $F$ 中的元素；接下来 $N_E$ 个数，表示集合 $E$ 中的元素。\n\n注意：集合 $F$ 中不会包含这个球员自身。", "outputFormat": "比赛有 $R\\times(R+2)$ 种不同的最终比分。将所有可能的比分以第一个队伍进球数作为第一关键字，第二个队伍进球数作为第二个关键字进行升序排序后，按照该顺序对于每一种可能的比分输出一行一个实数表示比赛以该比分结束的**概率**。\n\n输出的答案与标准答案相差不超过 $0.000001$ 即视为正确。", "hint": "**【样例解释#1】**\n\n比赛只持续 $2$ 秒或直到某人得分。由于 $N=1$，比赛中只有两名选手，两个选手的射门精确度都是 $0.5$，也就是说每个人的精确度都是 $50\\%$。\n\n让我们将灰色玩家标记为 $A$，将白色玩家标记为 $B$。在这些假设下，只有 $6$ 个可能的情况。下表分别描述了这些情况和对应的概率：\n\n| 概率 | 描述 | 比分 |\n| :----------: | :----------: | :----------: |\n| $0.25$ | $A$ 射门并得分 | $1:0$ |\n| $0.25\\times 0.25$ | $A$ 射门但未得分，$B$ 射门并得分 | $0:1$ |\n| $0.25\\times 0.25$ | $A$ 射门但未得分，$B$ 射门但并未得分 | $0:0$ |\n| $0.50\\times 0.25$ | 球被 $B$ 从 $A$ 那里抢走，$B$ 射门并得分 | $0:1$ |\n| $0.50\\times 0.50$ | 球被 $B$ 从 $A$ 那里抢走，球被 $A$ 从 $B$ 那里抢走 | $0:0$ |\n| $0.50\\times 0.25$ | 球被 $B$ 从 $A$ 那里抢走，$B$ 射门但并未得分 | $0:0$ |\n\n通过把这些概率加在一起，我们可以得到答案：\n\n| 比分 | 概率相加 | 总和 |\n| :----------: | :----------: | :----------: |\n| $0:0$ | $0.25 \\times 0.25 + 0.5 \\times 0.5 + 0.5 \\times 0.25$ | $0.5625$ |\n| $0:1$ | $0.25 \\times 0.25 + 0.5 \\times 0.25$ | $0.1875$ |\n| $1:0$ | $0.25$ | $0.25$ |\n\n\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 100$，$1\\le R\\le 10$，$1\\le T\\le 500$，$0\\le p\\le 1$，$0\\le N_f\\le N-1$，$0\\le N_e\\le N$。\n\n\n------------\n\n**【说明】**\n\n本题 spj 用于判断答案精确度。\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自 [COCI2012_2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST #5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T6 MNOGOMET**_。", "locale": "zh-CN"}}}
{"pid": "P7649", "type": "P", "difficulty": 3, "samples": [["42", "3 3 9 27\n1 81"], ["30", "0\n2 3 27"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["高精度", "2004", "进制", "BalticOI（波罗的海）"], "title": "[BalticOI 2004] Scales (Day1)", "background": null, "description": "给您一个平衡的臂秤，一组砝码和一个物体。这些砝码的重量为 $1, 3, 9, 27, 81, \\dots$，即每个砝码的重量为 $3$ 的幂，对于每个整数 $k \\ge 0$ 正好有一块砝码重量 $3^k$。物体的重量是 $m$，其中 $m$ 是正整数。你的任务是把物体放在左边的秤盘上，然后把一些砝码放在左右一个或两个秤盘上，使得秤平衡。", "inputFormat": "第一行包含一个整数 $m$。", "outputFormat": "第一行包含有关放在左秤盘上砝码的信息，第一个数字必须为非负整数――放在左秤盘上的砝码个数，然后是各砝码重量且按递增顺序，数字必须用单个空格分隔。第二行包含与第一行相同格式的有关放置在右秤盘上的砝码的信息。", "hint": "#### 数据规模与约定\n\n对于 $100 \\%$ 的数据，$1 \\le m \\le 10^{100}$。\n\n#### 题目说明\n\n来源于 [Baltic Olympiad in Informatics 2004](http://www.boi2004.lv/) 的 [Day 1:SCALES](http://www.boi2004.lv/Uzd_diena1.pdf)。\n\n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2004] Scales (Day1)", "background": null, "description": "给您一个平衡的臂秤，一组砝码和一个物体。这些砝码的重量为 $1, 3, 9, 27, 81, \\dots$，即每个砝码的重量为 $3$ 的幂，对于每个整数 $k \\ge 0$ 正好有一块砝码重量 $3^k$。物体的重量是 $m$，其中 $m$ 是正整数。你的任务是把物体放在左边的秤盘上，然后把一些砝码放在左右一个或两个秤盘上，使得秤平衡。", "inputFormat": "第一行包含一个整数 $m$。", "outputFormat": "第一行包含有关放在左秤盘上砝码的信息，第一个数字必须为非负整数――放在左秤盘上的砝码个数，然后是各砝码重量且按递增顺序，数字必须用单个空格分隔。第二行包含与第一行相同格式的有关放置在右秤盘上的砝码的信息。", "hint": "#### 数据规模与约定\n\n对于 $100 \\%$ 的数据，$1 \\le m \\le 10^{100}$。\n\n#### 题目说明\n\n来源于 [Baltic Olympiad in Informatics 2004](http://www.boi2004.lv/) 的 [Day 1:SCALES](http://www.boi2004.lv/Uzd_diena1.pdf)。\n\n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7650", "type": "P", "difficulty": 7, "samples": [["5\n20\n30\n5\n15\n10", "2\n2 1\n3 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2007", "Special Judge", "排序", "BalticOI（波罗的海）"], "title": "[BalticOI 2007] Ranklist Sorting (Day 1)", "background": "", "description": "在一场比赛中，你会得到几名选手的分数。你的任务是创建一个按分数递减排序的选手的排名表。  \n不幸的是，用于选手排名表的数据结构仅支持一种操作，即在不改变其他玩家的相对顺序的情况下将玩家从位置 $i$ 移动到位置 $j$。如果 $i > j$，则 $j$ 和 $i-1$ 之间位置的玩家位置增加 $1$，否则如果 $i < j$，则 $i+1$ 和 $j$ 之间位置的玩家位置减少 $1$。  \n这个操作需要 $i$ 步来定位要移动的玩家，$j$ 步来定位他或她移动到的位置，所以将一个玩家从位置 $i$ 移动到位置 $j$ 的总成本是 $i+j$。规定，位置从 $1$ 开始编号。  \n确定一个步法序列来创建排名表，使步法的代价之和最小化。", "inputFormat": "第一行包含整数 $n$，即玩家数量。  \n接下来的 $n$ 行中的每一行都包含一个非负整数 $s_i$，即当前顺序中玩家的分数。您可以假设所有分数都是不同的。", "outputFormat": "第一行输出用于创建排名表的移动次数。以下几行应按应用顺序指定移动，每次移动都应该用一行包含两个整数 $i$ 和 $j$ 来描述，表示位置 $i$ 的玩家被移动到位置 $j$。数字 $i$ 和 $j$ 必须用一个空格分隔。", "hint": "#### 数据规模与约定  \n对于 $30 \\% $ 的数据，$n \\le 10$，$0  \\le s_i \\le 10^6$。  \n对于 $100 \\%$ 的数据，$2 \\le n \\le 10^3$，$0  \\le s_i \\le 10^6$。\n #### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2007](https://www.boi2007.de/en/welcome) 的 [Day 1:sorting](https://www.boi2007.de/tasks/sorting.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2007] Ranklist Sorting (Day 1)", "background": "", "description": "在一场比赛中，你会得到几名选手的分数。你的任务是创建一个按分数递减排序的选手的排名表。  \n不幸的是，用于选手排名表的数据结构仅支持一种操作，即在不改变其他玩家的相对顺序的情况下将玩家从位置 $i$ 移动到位置 $j$。如果 $i > j$，则 $j$ 和 $i-1$ 之间位置的玩家位置增加 $1$，否则如果 $i < j$，则 $i+1$ 和 $j$ 之间位置的玩家位置减少 $1$。  \n这个操作需要 $i$ 步来定位要移动的玩家，$j$ 步来定位他或她移动到的位置，所以将一个玩家从位置 $i$ 移动到位置 $j$ 的总成本是 $i+j$。规定，位置从 $1$ 开始编号。  \n确定一个步法序列来创建排名表，使步法的代价之和最小化。", "inputFormat": "第一行包含整数 $n$，即玩家数量。  \n接下来的 $n$ 行中的每一行都包含一个非负整数 $s_i$，即当前顺序中玩家的分数。您可以假设所有分数都是不同的。", "outputFormat": "第一行输出用于创建排名表的移动次数。以下几行应按应用顺序指定移动，每次移动都应该用一行包含两个整数 $i$ 和 $j$ 来描述，表示位置 $i$ 的玩家被移动到位置 $j$。数字 $i$ 和 $j$ 必须用一个空格分隔。", "hint": "#### 数据规模与约定  \n对于 $30 \\% $ 的数据，$n \\le 10$，$0  \\le s_i \\le 10^6$。  \n对于 $100 \\%$ 的数据，$2 \\le n \\le 10^3$，$0  \\le s_i \\le 10^6$。\n #### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2007](https://www.boi2007.de/en/welcome) 的 [Day 1:sorting](https://www.boi2007.de/tasks/sorting.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7651", "type": "P", "difficulty": 5, "samples": [["0 5.0\n10.00 -5\n3.0 1 4.00", "46.64"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["计算几何", "BalticOI（波罗的海）", "1996"], "title": "[BalticOI 1996] A SQUARE AND A CIRCLE (Day 1)", "background": "", "description": "一个平面上有一个正方形和一个圆，给定正方形的两个相对顶点的坐标和圆的圆心坐标和半径，求这个正方形和这个圆的公共面积。", "inputFormat": "前两行包含正方形的两个相对顶点的坐标 （$x_1,y_1$）和（$x_2,y_2$），第三行包含圆心坐标（$x_3,y_3$）和半径 $r$，为实数。", "outputFormat": "输出两个图形的公共面积，小数点后两位。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$-1200.00 \\le x_i,y_i \\le 1200.00$，$0 < r \\le 200.00$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $30$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 1996 的 [Day 1:A SQUARE AND A CIRCLE](https://boi.cses.fi/files/boi1996_day1.pdf) 。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 1996] A SQUARE AND A CIRCLE (Day 1)", "background": "", "description": "一个平面上有一个正方形和一个圆，给定正方形的两个相对顶点的坐标和圆的圆心坐标和半径，求这个正方形和这个圆的公共面积。", "inputFormat": "前两行包含正方形的两个相对顶点的坐标 （$x_1,y_1$）和（$x_2,y_2$），第三行包含圆心坐标（$x_3,y_3$）和半径 $r$，为实数。", "outputFormat": "输出两个图形的公共面积，小数点后两位。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$-1200.00 \\le x_i,y_i \\le 1200.00$，$0 < r \\le 200.00$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $30$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 1996 的 [Day 1:A SQUARE AND A CIRCLE](https://boi.cses.fi/files/boi1996_day1.pdf) 。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7652", "type": "P", "difficulty": 0, "samples": [["6\n12\n33\n97\n18\n15\n33", "2\n12 1\n33 1\n97 2\n18 2\n15 2\n33 1"], ["1\n88", "0"], ["4\n77\n22\n22\n11", "1\n77 1\n22 1\n22 1\n11 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["递归", "BalticOI（波罗的海）", "1996"], "title": "[BalticOI 1996] A NICE SEQUENCE (Day 1)", "background": "", "description": "有一个由 $N$ 个整数组成的序列 $a_1,a_2, \\cdots ,a_N$。序列 $b_1,b_2, \\cdots ,b_L$ 是给定序列的子序列，如果  \n1. 对于每个 $i$ （$1 \\leq i \\leq L$），存在这样的 $j$ （$1 \\leq j \\leq N$），使得 $b_i= a_j$；  \n1. 对于每个 $i_1$ 和 $i_2$ 使得 $i_1 < i_2$，$b_{i1} = a_{j1}$，$b_{i2} = a_{j2}$，关系 $j_1 < j_2$ 是有效的。  \n\n序列 $b_1,b_2, \\cdots,b_L$ 是非递增的，如果对于每个 $i$（$1 \\le i < L$），$b_i \\le b_{i+1}$。  \n序列 $b_1,b_2, \\cdots,b_L$ 是非递减的，如果对于每个 $i$（$1 \\le i < L$），$b_i \\le b_{i+1}$。  \n给定的序列称为 **NICE**，如果我们可以选择该序列的 $K$ 个子序列使得：  \n1. 每个子序列至少有 $2$ 个成员，  \n1. 每个子序列要么不增加要么不减少，  \n1. 给定序列的每个成员直接属于一个子序列。  \n\n找出给定序列的最小可能 $K$。", "inputFormat": "第一行包含一个整数为 $N$ 的值，接下来的 $N$ 行包含序列成员的值（每行一个整数，对于每个 $j$（$1 \\le a_j \\le 100$））。", "outputFormat": "输出数据必须包含：\n1. 第一行中 $K$ 的值，  \n1. 将给定序列划分为 $K$ 个子序列的一个示例（即必须有 $N$ 行，每行包含子序列的 $a_j$ 和其 $a_j$ 属于的 索引（$1 \\le$ 索引 $\\le K$））。  \n\n如果给定的序列不是 **NICE**，则输出文件的第一行必须仅包含 $0$。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le N \\le 25$，$0 < K \\le N$。\n#### 样例说明  \n样例一中，子序列是 $12，33，33$ 和  $97，18，15$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $40$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 2000] 的 [Day 1:A NICE SEQUENCE](https://boi.cses.fi/files/boi1996_day1.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 1996] A NICE SEQUENCE (Day 1)", "background": "", "description": "有一个由 $N$ 个整数组成的序列 $a_1,a_2, \\cdots ,a_N$。序列 $b_1,b_2, \\cdots ,b_L$ 是给定序列的子序列，如果  \n1. 对于每个 $i$ （$1 \\leq i \\leq L$），存在这样的 $j$ （$1 \\leq j \\leq N$），使得 $b_i= a_j$；  \n1. 对于每个 $i_1$ 和 $i_2$ 使得 $i_1 < i_2$，$b_{i1} = a_{j1}$，$b_{i2} = a_{j2}$，关系 $j_1 < j_2$ 是有效的。  \n\n序列 $b_1,b_2, \\cdots,b_L$ 是非递增的，如果对于每个 $i$（$1 \\le i < L$），$b_i \\le b_{i+1}$。  \n序列 $b_1,b_2, \\cdots,b_L$ 是非递减的，如果对于每个 $i$（$1 \\le i < L$），$b_i \\le b_{i+1}$。  \n给定的序列称为 **NICE**，如果我们可以选择该序列的 $K$ 个子序列使得：  \n1. 每个子序列至少有 $2$ 个成员，  \n1. 每个子序列要么不增加要么不减少，  \n1. 给定序列的每个成员直接属于一个子序列。  \n\n找出给定序列的最小可能 $K$。", "inputFormat": "第一行包含一个整数为 $N$ 的值，接下来的 $N$ 行包含序列成员的值（每行一个整数，对于每个 $j$（$1 \\le a_j \\le 100$））。", "outputFormat": "输出数据必须包含：\n1. 第一行中 $K$ 的值，  \n1. 将给定序列划分为 $K$ 个子序列的一个示例（即必须有 $N$ 行，每行包含子序列的 $a_j$ 和其 $a_j$ 属于的 索引（$1 \\le$ 索引 $\\le K$））。  \n\n如果给定的序列不是 **NICE**，则输出文件的第一行必须仅包含 $0$。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le N \\le 25$，$0 < K \\le N$。\n#### 样例说明  \n样例一中，子序列是 $12，33，33$ 和  $97，18，15$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $40$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 2000] 的 [Day 1:A NICE SEQUENCE](https://boi.cses.fi/files/boi1996_day1.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7653", "type": "P", "difficulty": 4, "samples": [["a&(b&b) \nc+c\na&b+c\n#a\na&b ", "R1\nR2\nR4\nR3=R1+R2\nR5=R1 "]], "limits": {"time": [1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072]}, "tags": ["BalticOI（波罗的海）", "1996"], "title": "[BalticOI 1996] LOGICAL EXPRESSIONS (Day 1)", "background": "", "description": "有五个逻辑表达式，称为 R1、R2、R3、R4、R5。只有逻辑变量 $a、b、c、d、e、f、g、h$，逻辑运算  \n`#（not）`  \n`&（and）`  \n`+（or）`  \n和圆括号可以在表达式中使用。操作的优先级如上所述。可以使用圆括号定义执行操作的不同顺序。  \n操作由这样的表定义  \n![Biao](https://cdn.luogu.com.cn/upload/image_hosting/ilfi8gbz.png)  \n假设有一些表达式可以通过带有一个或两个参数的单个逻辑运算来表达：  \n- $R_i = R_j$（$R_i$ 等价于 $R_j$，即对于每组变量值，$R_i$ 给出与 $R_j$ 相同的值）；  \n- $R_i =$ # $R_j$（$R_i$ 等价于 $R_j$ 的否定）；  \n- $R_i = R_j $ &  $R_k  $（结合）;  \n- $R_i = R_j + R_k$（分离）；其中（$i≠k，i≠j$）。  \n\n一组基本的表达式是通过它可以表示（表达）未包含在该组中的任何其他表达式，如上定义。  \n编写一个程序来查找：   \n1. 任何最不基本的表达式集；   \n1. 每个表达式的任何表示（表达）（不属于表达式的基本集合）。应该使用带有一个或两个参数的任何单个逻辑运算来获得表示，即来自基本集合的表达式。", "inputFormat": "一行一个表达式，R1 在第一行,以此类推。表达式中没有空格。假设输入数据是正确的。每行的长度小于 $256$。", "outputFormat": "应包含 $5$ 行，每个表达式一行。将基本表达式的名称写入输出的第一行。其余行应包含所有其他表达式（即不属于基本表达式集的表达式）的等式（等价）形式的表示（表达式），如下面的示例所示。", "hint": "#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $30$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 1996 的 [Day 1:LOGICAL EXPRESSIONS](https://boi.cses.fi/files/boi1996_day1.pdf) 。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 1996] LOGICAL EXPRESSIONS (Day 1)", "background": "", "description": "有五个逻辑表达式，称为 R1、R2、R3、R4、R5。只有逻辑变量 $a、b、c、d、e、f、g、h$，逻辑运算  \n`#（not）`  \n`&（and）`  \n`+（or）`  \n和圆括号可以在表达式中使用。操作的优先级如上所述。可以使用圆括号定义执行操作的不同顺序。  \n操作由这样的表定义  \n![Biao](https://cdn.luogu.com.cn/upload/image_hosting/ilfi8gbz.png)  \n假设有一些表达式可以通过带有一个或两个参数的单个逻辑运算来表达：  \n- $R_i = R_j$（$R_i$ 等价于 $R_j$，即对于每组变量值，$R_i$ 给出与 $R_j$ 相同的值）；  \n- $R_i =$ # $R_j$（$R_i$ 等价于 $R_j$ 的否定）；  \n- $R_i = R_j $ &  $R_k  $（结合）;  \n- $R_i = R_j + R_k$（分离）；其中（$i≠k，i≠j$）。  \n\n一组基本的表达式是通过它可以表示（表达）未包含在该组中的任何其他表达式，如上定义。  \n编写一个程序来查找：   \n1. 任何最不基本的表达式集；   \n1. 每个表达式的任何表示（表达）（不属于表达式的基本集合）。应该使用带有一个或两个参数的任何单个逻辑运算来获得表示，即来自基本集合的表达式。", "inputFormat": "一行一个表达式，R1 在第一行,以此类推。表达式中没有空格。假设输入数据是正确的。每行的长度小于 $256$。", "outputFormat": "应包含 $5$ 行，每个表达式一行。将基本表达式的名称写入输出的第一行。其余行应包含所有其他表达式（即不属于基本表达式集的表达式）的等式（等价）形式的表示（表达式），如下面的示例所示。", "hint": "#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $30$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 1996 的 [Day 1:LOGICAL EXPRESSIONS](https://boi.cses.fi/files/boi1996_day1.pdf) 。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7654", "type": "P", "difficulty": 0, "samples": [["3 8\nP 1 100\nV 2 1\nP 2 40\nV 1 2\nV 1 3\nV 1 3\nP 3 70\nV 1 3 ", "OK 75.00 95.00 "], ["3 8 \nP 1 100\nV 2 1\nP 2 40\nV 1 2\nV 1 3\nV 1 3\nP 3 70\nV 1 3 ", "OVERFLOW 7 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["BalticOI（波罗的海）", "1996"], "title": "[BalticOI 1996] THE FILLING OF BARRELS (Day 2)", "background": "", "description": "在水平面上有 $N$ 个相等的空桶。每桶容积为 $100$ 个单位。它们中的每两个都用一根管道连接。每根管道都连接到两个桶的底部，其有自己的阀门，只能“打开“ ”或“关闭”。开始时，所有阀门都是关闭的。如果一个阀门打开，那么从一个连接的桶中的液体可以快速自由地流向另一个桶，从而使这些桶中的液体量变得相等（连通器原理）。如果阀门关闭，则液体无法通过该管道。  \n现允许两种操作：  \n1. “P”（倾倒）一定量的液体倒入规定的桶中。操作说明为：“P $n$ $m$”，其中 $n$ 为桶的编号，$m$ 为要倒入该桶的液体量（单位），  \n1. “V”（用于阀门）一个规定的阀门转到相反位置（即该阀门原打开现关闭，如果原关闭则现打开）。操作说明为：“V $n_1$ $n_2$”，其中 $n_1$ 和 $n_2$ 为连接有该阀门的管道的桶编号。两种不同的描述 “V $n_1$ $n_2$” 和 “V $n_2$ $n_1$” 指的是同一个阀门。  \n\n您的目标是执行给定的操作序列。您必须忽略管道中的液体量。如果某些倾倒操作因液体溢出而无法执行，则必须在适当输出后停止执行该操作序列。", "inputFormat": "第一行包含整数 $N$ 和 $K$（操作数），其余 $K$ 行包含操作描述（每行一个描述）。", "outputFormat": "必须包含 “OK” 以及序列执行结束时所有桶中的最小和最大液体量的值或 “OVERFLOW” 和发生溢出的操作。液体量的数值必须写成实数，小数点后有两位。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 < N \\le 100$。$n$ 和 $m$ 为整数，$0 < n \\le N$， $0 < m \\le 1000$。$n_1$ 和 $n_2$ 为整数，$0 < n_1 \\le N$，$0 < n_2 \\le N$，$n_1 ≠ n_2$。 $0 < K \\le 1000$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $25$ 。  \n#### 题目说明  \n\n来源于 Baltic Olympiad in Informatics 1996 的 [Day 2:THE FILLING OF BARRELS](https://boi.cses.fi/files/boi1996_day2.pdf) 。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 1996] THE FILLING OF BARRELS (Day 2)", "background": "", "description": "在水平面上有 $N$ 个相等的空桶。每桶容积为 $100$ 个单位。它们中的每两个都用一根管道连接。每根管道都连接到两个桶的底部，其有自己的阀门，只能“打开“ ”或“关闭”。开始时，所有阀门都是关闭的。如果一个阀门打开，那么从一个连接的桶中的液体可以快速自由地流向另一个桶，从而使这些桶中的液体量变得相等（连通器原理）。如果阀门关闭，则液体无法通过该管道。  \n现允许两种操作：  \n1. “P”（倾倒）一定量的液体倒入规定的桶中。操作说明为：“P $n$ $m$”，其中 $n$ 为桶的编号，$m$ 为要倒入该桶的液体量（单位），  \n1. “V”（用于阀门）一个规定的阀门转到相反位置（即该阀门原打开现关闭，如果原关闭则现打开）。操作说明为：“V $n_1$ $n_2$”，其中 $n_1$ 和 $n_2$ 为连接有该阀门的管道的桶编号。两种不同的描述 “V $n_1$ $n_2$” 和 “V $n_2$ $n_1$” 指的是同一个阀门。  \n\n您的目标是执行给定的操作序列。您必须忽略管道中的液体量。如果某些倾倒操作因液体溢出而无法执行，则必须在适当输出后停止执行该操作序列。", "inputFormat": "第一行包含整数 $N$ 和 $K$（操作数），其余 $K$ 行包含操作描述（每行一个描述）。", "outputFormat": "必须包含 “OK” 以及序列执行结束时所有桶中的最小和最大液体量的值或 “OVERFLOW” 和发生溢出的操作。液体量的数值必须写成实数，小数点后有两位。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 < N \\le 100$。$n$ 和 $m$ 为整数，$0 < n \\le N$， $0 < m \\le 1000$。$n_1$ 和 $n_2$ 为整数，$0 < n_1 \\le N$，$0 < n_2 \\le N$，$n_1 ≠ n_2$。 $0 < K \\le 1000$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $25$ 。  \n#### 题目说明  \n\n来源于 Baltic Olympiad in Informatics 1996 的 [Day 2:THE FILLING OF BARRELS](https://boi.cses.fi/files/boi1996_day2.pdf) 。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7655", "type": "P", "difficulty": 4, "samples": [["1 3\n6 7\n1 2 9\n1 6 2\n1 5 10\n5 4 1\n4 6 2\n4 3 4\n2 3 5", "1 5 1 10\n5 4 1 1\n4 3 3 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge", "最短路", "BalticOI（波罗的海）", "1996"], "title": "[BalticOI 1996] A FAST JOURNEY (Day 2)", "background": "", "description": "一侧的交通道路连接了许多城市。城市从 $1$ 到 $n$ 编号，其中 $n$ 是城市的数量。在奇数天，车辆按照交通指示的方向行驶，在偶数天，则沿相反的方向行驶。两个城市之间的道路长度用一个整数值来衡量——从一个城市到另一个城市的旅程的持续时间（以小时为单位），它与方向无关。  \n\n编写一个程序来查找从城市 A 到城市 B 的路线，以便尽可能快地到达城市 B。  \n\n旅程的第一天是奇数天。一天之内的旅程不能超过十二个小时。晚上必须在一个城市度过。行程可能会在第二天继续。", "inputFormat": "第一行包含两个整数为 A 和 B 城市的编号，第二行包含两个整数为城市总数和道路总数 $k$。剩下的 $k$ 行中有每条道路的信息，每行包含三个整数——道路连接的两个城市的编号以及以小时表示的城市之间旅程的持续时间。道路的方向是从第一城到第二城。", "outputFormat": "每条中间路径输出一行。每行应该有四个整数——出发城市标号、到达城市编号、日期和道路长度。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 < n \\le 100$，$1 \\le k \\le 1000$。\n#### 样例说明  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/onmlfj8f.png)\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $35$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 1996 的 [Day 2:A FAST JOURNEY](https://boi.cses.fi/files/boi1996_day2.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 1996] A FAST JOURNEY (Day 2)", "background": "", "description": "一侧的交通道路连接了许多城市。城市从 $1$ 到 $n$ 编号，其中 $n$ 是城市的数量。在奇数天，车辆按照交通指示的方向行驶，在偶数天，则沿相反的方向行驶。两个城市之间的道路长度用一个整数值来衡量——从一个城市到另一个城市的旅程的持续时间（以小时为单位），它与方向无关。  \n\n编写一个程序来查找从城市 A 到城市 B 的路线，以便尽可能快地到达城市 B。  \n\n旅程的第一天是奇数天。一天之内的旅程不能超过十二个小时。晚上必须在一个城市度过。行程可能会在第二天继续。", "inputFormat": "第一行包含两个整数为 A 和 B 城市的编号，第二行包含两个整数为城市总数和道路总数 $k$。剩下的 $k$ 行中有每条道路的信息，每行包含三个整数——道路连接的两个城市的编号以及以小时表示的城市之间旅程的持续时间。道路的方向是从第一城到第二城。", "outputFormat": "每条中间路径输出一行。每行应该有四个整数——出发城市标号、到达城市编号、日期和道路长度。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 < n \\le 100$，$1 \\le k \\le 1000$。\n#### 样例说明  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/onmlfj8f.png)\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $35$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 1996 的 [Day 2:A FAST JOURNEY](https://boi.cses.fi/files/boi1996_day2.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7656", "type": "P", "difficulty": 4, "samples": [["3 2", "B wins\n1 2\n2 1"], ["7 4", "A wins\n1 winning\n2 winning\n3 4\n4 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["博弈论", "记忆化搜索", "BalticOI（波罗的海）", "1996"], "title": "[BalticOI 1996] A NUMBER GAME (Day 2)", "background": "", "description": "下面是一个游戏。首先我们赋给变量 $n$ 和变量 $m$ 整数值。玩家 A 和 B 开始轮流移动（A 先）。每次移动都会选择一个正整数 $k \\le \\min \\lbrace m,n \\rbrace$，这会将变量 $n$ 的值减少 $k$。但是，不允许使用一个或另一个玩家在之前的移动中已经使用的数字。当其中一名玩家无法移动时，游戏结束。 走最后一步的玩家是赢家。  \n请编写一个程序，说明哪个玩家有获胜策略。", "inputFormat": "第一行包含两个整数 $n$ 和 $m$，用空格分隔。", "outputFormat": "第一行：谁有获胜策略；接下来的行：A 的所有可能的第一步动作依次递增，然后是单词 “winning” 或 B 的一个获胜答案。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$0 < n \\le 70$，$0 < m \\le 20$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $40$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 1996 的 [Day 2:A NUMBER GAME](https://boi.cses.fi/files/boi1996_day2.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 1996] A NUMBER GAME (Day 2)", "background": "", "description": "下面是一个游戏。首先我们赋给变量 $n$ 和变量 $m$ 整数值。玩家 A 和 B 开始轮流移动（A 先）。每次移动都会选择一个正整数 $k \\le \\min \\lbrace m,n \\rbrace$，这会将变量 $n$ 的值减少 $k$。但是，不允许使用一个或另一个玩家在之前的移动中已经使用的数字。当其中一名玩家无法移动时，游戏结束。 走最后一步的玩家是赢家。  \n请编写一个程序，说明哪个玩家有获胜策略。", "inputFormat": "第一行包含两个整数 $n$ 和 $m$，用空格分隔。", "outputFormat": "第一行：谁有获胜策略；接下来的行：A 的所有可能的第一步动作依次递增，然后是单词 “winning” 或 B 的一个获胜答案。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$0 < n \\le 70$，$0 < m \\le 20$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $40$ 。\n#### 题目说明  \n来源于 Baltic Olympiad in Informatics 1996 的 [Day 2:A NUMBER GAME](https://boi.cses.fi/files/boi1996_day2.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7657", "type": "P", "difficulty": 5, "samples": [["3", "8"], ["4", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2007", "BalticOI（波罗的海）"], "title": "[BalticOI 2007] Connected Points (Day 2)", "background": "", "description": "考虑一个有 $3×N$ 点的规则网格，网格中的每个点最多有八个相邻点（见图 $1$）。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/4j322bxt.png)  \n我们有兴趣计算连接网格点以形成满足以下条件的多边形的不同方式的数量：  \n1. 多边形的顶点集由所有 $3×N$ 个点组成。\n1. 多边形的相邻顶点是网格中的相邻点。  \n1. 每个多边形都很简单，即不能有任何自相交。  \n\n当 $N=6$ 时的两个可能的多边形如图 $2$。\n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/e2yye0px.png)  \n请编写一个程序，为给定的 $N$ 计算连接点的可能方法数，答案对 $10^9$ 取模。", "inputFormat": "唯一的一行包含一个正整数 $N$。", "outputFormat": "唯一的一行包含一个整数，为对 $10^9$ 取模的连接这些点的方法数。", "hint": "#### 数据规模与约定  \n对于 $30 \\% $ 的数据，$0 < N \\le 200$。  \n对于 $70 \\% $ 的数据，$0 <N \\le 10^5$。  \n对于 $100 \\%$ 的数据，$0 <N \\le 10^9$。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2007](https://www.boi2007.de/en/welcome) 的 [Day 2:points](https://www.boi2007.de/tasks/points.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2007] Connected Points (Day 2)", "background": "", "description": "考虑一个有 $3×N$ 点的规则网格，网格中的每个点最多有八个相邻点（见图 $1$）。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/4j322bxt.png)  \n我们有兴趣计算连接网格点以形成满足以下条件的多边形的不同方式的数量：  \n1. 多边形的顶点集由所有 $3×N$ 个点组成。\n1. 多边形的相邻顶点是网格中的相邻点。  \n1. 每个多边形都很简单，即不能有任何自相交。  \n\n当 $N=6$ 时的两个可能的多边形如图 $2$。\n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/e2yye0px.png)  \n请编写一个程序，为给定的 $N$ 计算连接点的可能方法数，答案对 $10^9$ 取模。", "inputFormat": "唯一的一行包含一个正整数 $N$。", "outputFormat": "唯一的一行包含一个整数，为对 $10^9$ 取模的连接这些点的方法数。", "hint": "#### 数据规模与约定  \n对于 $30 \\% $ 的数据，$0 < N \\le 200$。  \n对于 $70 \\% $ 的数据，$0 <N \\le 10^5$。  \n对于 $100 \\%$ 的数据，$0 <N \\le 10^9$。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2007](https://www.boi2007.de/en/welcome) 的 [Day 2:points](https://www.boi2007.de/tasks/points.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7658", "type": "P", "difficulty": 0, "samples": [["2\n1\nLOCK X\n2\nLOCK X\nLOCK Y", "1\n-1 1"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2000", "BalticOI（波罗的海）"], "title": "[BalticOI 2000] MUTEXES (Day 2)", "background": "", "description": "现代编程语言允许编写由多个执行线程组成的程序。这就好像有几个程序在同一个地址空间并行运行，访问相同的变量。通常，线程需要彼此同步。例如，一个线程可能需要等待另一个线程完成某些计算并将结果存储到某个变量中。  \n最简单的线程同步工具是互斥锁。互斥锁是一种特殊的对象，可以处于锁定或解锁状态。锁定的互斥锁始终由一个线程拥有。线程可以对互斥锁应用两种操作：LOCK 和 UNLOCK。  \n当线程对当前未锁定的互斥锁应用 LOCK 时，该互斥锁将被锁定并且该线程获得该互斥锁的所有权。如果一个线程尝试将 LOCK 应用于已被其他线程锁定的互斥锁，则该线程将被阻塞，直到该互斥锁被解锁。  \n当线程对其拥有的互斥锁应用 UNLOCK 时，该互斥锁将变为未锁定状态。如果有其他线程等待锁定互斥锁，则其中一个线程被授予互斥锁的所有权。如果有多个线程在等待，则任意选择一个。  \n多线程程序中的常见问题之一是死锁。当两个或多个线程正在等待彼此释放互斥锁并且它们都不能继续时，就会发生死锁。当一个线程正在等待被另一个线程锁定的互斥锁时，也会发生死锁，该线程已终止而没有释放互斥锁。  \n现为您提供一些线程的描述，您的任务是确定是否会发生死锁。  \n每个线程都是以下形式的指令序列：  \n``LOCK <mutex>``   \n``UNLOCK <mutex> ``  \n您可以假设以下有关命令：  \n- 互斥锁的名称是大写字母 A$\\cdots$Z；  \n- 没有线程试图锁定它已经拥有的互斥锁；  \n- 没有线程试图解锁不属于它的互斥锁。", "inputFormat": "第一行包含一个整数为线程数 $M$，后跟描述每个线程的 $M$ 个块。描述线程 $i$ 的块的第一行包含一个整数为该线程中的指令数  $N_i$，然后是 $N$ 行指令。指令不包含多余的空格。", "outputFormat": "第一行必须包含一个整数：$D$。如果可能出现死锁，$D$ 必须为 $1$，否则为 $0$。  \n如果可能出现死锁，则第二行必须描述发生死锁的程序状态。如果存在多个死锁状态，则输出其中任何一个。在这种情况下，我们寻找的是完全死锁，即没有一个线程可以继续执行——线程必须被互斥锁终止或阻塞。如果不可能出现死锁，则该行必须为空。  \n程序状态通过按照线程在输入中出现的顺序为每个线程指定当前指令的从零开始的索引来描述。对于终止的线程，输出 $-1$ 作为索引。 索引必须在一行上并用空格分隔。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le M \\le 5$，$1 \\le N_i \\le 10$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $60$ 。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2000](http://ingforum.haninge.kth.se/BOI00/boi00.html) 的 [Day 2:Mutexes](http://ingforum.haninge.kth.se/BOI00/BOI007.html#anchor84989)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2000] MUTEXES (Day 2)", "background": "", "description": "现代编程语言允许编写由多个执行线程组成的程序。这就好像有几个程序在同一个地址空间并行运行，访问相同的变量。通常，线程需要彼此同步。例如，一个线程可能需要等待另一个线程完成某些计算并将结果存储到某个变量中。  \n最简单的线程同步工具是互斥锁。互斥锁是一种特殊的对象，可以处于锁定或解锁状态。锁定的互斥锁始终由一个线程拥有。线程可以对互斥锁应用两种操作：LOCK 和 UNLOCK。  \n当线程对当前未锁定的互斥锁应用 LOCK 时，该互斥锁将被锁定并且该线程获得该互斥锁的所有权。如果一个线程尝试将 LOCK 应用于已被其他线程锁定的互斥锁，则该线程将被阻塞，直到该互斥锁被解锁。  \n当线程对其拥有的互斥锁应用 UNLOCK 时，该互斥锁将变为未锁定状态。如果有其他线程等待锁定互斥锁，则其中一个线程被授予互斥锁的所有权。如果有多个线程在等待，则任意选择一个。  \n多线程程序中的常见问题之一是死锁。当两个或多个线程正在等待彼此释放互斥锁并且它们都不能继续时，就会发生死锁。当一个线程正在等待被另一个线程锁定的互斥锁时，也会发生死锁，该线程已终止而没有释放互斥锁。  \n现为您提供一些线程的描述，您的任务是确定是否会发生死锁。  \n每个线程都是以下形式的指令序列：  \n``LOCK <mutex>``   \n``UNLOCK <mutex> ``  \n您可以假设以下有关命令：  \n- 互斥锁的名称是大写字母 A$\\cdots$Z；  \n- 没有线程试图锁定它已经拥有的互斥锁；  \n- 没有线程试图解锁不属于它的互斥锁。", "inputFormat": "第一行包含一个整数为线程数 $M$，后跟描述每个线程的 $M$ 个块。描述线程 $i$ 的块的第一行包含一个整数为该线程中的指令数  $N_i$，然后是 $N$ 行指令。指令不包含多余的空格。", "outputFormat": "第一行必须包含一个整数：$D$。如果可能出现死锁，$D$ 必须为 $1$，否则为 $0$。  \n如果可能出现死锁，则第二行必须描述发生死锁的程序状态。如果存在多个死锁状态，则输出其中任何一个。在这种情况下，我们寻找的是完全死锁，即没有一个线程可以继续执行——线程必须被互斥锁终止或阻塞。如果不可能出现死锁，则该行必须为空。  \n程序状态通过按照线程在输入中出现的顺序为每个线程指定当前指令的从零开始的索引来描述。对于终止的线程，输出 $-1$ 作为索引。 索引必须在一行上并用空格分隔。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\le M \\le 5$，$1 \\le N_i \\le 10$。\n#### 分值说明  \n本题分值按 BOI 原题设置，**满分** $60$ 。\n#### 题目说明  \n来源于 [Baltic Olympiad in Informatics 2000](http://ingforum.haninge.kth.se/BOI00/boi00.html) 的 [Day 2:Mutexes](http://ingforum.haninge.kth.se/BOI00/BOI007.html#anchor84989)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7659", "type": "P", "difficulty": 1, "samples": [["5\n2\n1\n4\n5\n1\n2\n3", "12"], ["2\n6\n5\n3\n3\n7\n2\n6", "19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #5] FUNGHI", "background": "", "description": "Hansel 和 Gretel 得到了一块分成 $8$ 片的披萨，每片上面有不同数量的蘑菇，表示为 $S_1,S_2,...,S_8$。Gretel 很喜欢蘑菇，她想要找到连续的四片披萨使得上面的蘑菇最多。\n\n请注意，因为披萨是一个圆，因此编号为 $1$ 的披萨片与编号为 $8$ 的披萨片是相邻的。", "inputFormat": "一共 $8$ 行，每行一个正整数 $S_i$（$i$ 为行数），表示披萨片上的蘑菇数。", "outputFormat": "一行一个正整数，表示连续的四片披萨上最多有几个蘑菇。", "hint": "对于 $100\\%$ 的数据，$0 \\leq S_i \\leq 50$。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #5] FUNGHI", "background": "", "description": "Hansel 和 Gretel 得到了一块分成 $8$ 片的披萨，每片上面有不同数量的蘑菇，表示为 $S_1,S_2,...,S_8$。Gretel 很喜欢蘑菇，她想要找到连续的四片披萨使得上面的蘑菇最多。\n\n请注意，因为披萨是一个圆，因此编号为 $1$ 的披萨片与编号为 $8$ 的披萨片是相邻的。", "inputFormat": "一共 $8$ 行，每行一个正整数 $S_i$（$i$ 为行数），表示披萨片上的蘑菇数。", "outputFormat": "一行一个正整数，表示连续的四片披萨上最多有几个蘑菇。", "hint": "对于 $100\\%$ 的数据，$0 \\leq S_i \\leq 50$。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7660", "type": "P", "difficulty": 2, "samples": [["5 5\n...J.\n.....\nJ..J.\nJ....\nZ....", "7"], ["5 5\n.....\nJ...J\n.J.J.\n.JJJ.\nZ....", "15"], ["3 4\n...J\n....\nZ...", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #5] ZMIJA", "background": "Mirko 在玩魔改的贪吃蛇。", "description": "给你一个 $n\\times m$ 的矩阵，其中：\n\n- 蛇在左下角，用 `Z` 表示；\n- 其他格子苹果用 `J` 表示，空白用 `.` 表示；\n- 操作 A 让蛇向它面对的方向走一步（不能走出矩阵）；\n- 操作 B 让蛇向上走一步，并且方向转 $180\\degree$；\n- 当蛇所在格子有苹果时，蛇会把这个苹果吃掉。\n\n现在蛇面向右，求最少操作数使蛇吃掉所有苹果。", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串，只含 `.`, `J`, `Z` ，表示该矩阵。", "outputFormat": "一个正整数，表示蛇吃掉所有苹果的最少操作数。", "hint": "对于 $100\\%$ 的数据，$2 \\leq n,m \\leq 1000$，矩阵的左下角一定是 `Z`。\n\n**样例 1 解释：** 依次执行操作 $BBAAABB$ 可吃掉所有苹果。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #5] ZMIJA", "background": "Mirko 在玩魔改的贪吃蛇。", "description": "给你一个 $n\\times m$ 的矩阵，其中：\n\n- 蛇在左下角，用 `Z` 表示；\n- 其他格子苹果用 `J` 表示，空白用 `.` 表示；\n- 操作 A 让蛇向它面对的方向走一步（不能走出矩阵）；\n- 操作 B 让蛇向上走一步，并且方向转 $180\\degree$；\n- 当蛇所在格子有苹果时，蛇会把这个苹果吃掉。\n\n现在蛇面向右，求最少操作数使蛇吃掉所有苹果。", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串，只含 `.`, `J`, `Z` ，表示该矩阵。", "outputFormat": "一个正整数，表示蛇吃掉所有苹果的最少操作数。", "hint": "对于 $100\\%$ 的数据，$2 \\leq n,m \\leq 1000$，矩阵的左下角一定是 `Z`。\n\n**样例 1 解释：** 依次执行操作 $BBAAABB$ 可吃掉所有苹果。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7661", "type": "P", "difficulty": 2, "samples": [["4 3\n1 2\n3 4\n3 2\n4 5", "4"], ["7 4\n3 1\n2 2\n4 1\n3 2\n2 3\n1 4\n1 3", "6"], ["5 2\n1 1\n2 1\n1 2\n1 3\n1 4", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #5] TRAKTOR", "background": "Mirko 用拖拉机采蘑菇。", "description": "已知一个平面上 $n$ 个点，每个点的坐标可以用正整数 $X_i,Y_i$ 表示，求最小的 $ans$ 使前 $ans$ 个点中有至少 $k$ 个点处于同一行或同一列或同一与对角线平行的斜线。", "inputFormat": "第一行两个正整数 $n,k$。\n\n接下来 $n$ 行，每行两个正整数 $X_i,Y_i$。", "outputFormat": "一个正整数 $ans$。如无解输出 $-1$。", "hint": "对于 $50\\%$ 的数据，$1 \\leq X_i,Y_i \\leq 300$。\n\n对于 $100\\%$ 的数据，$2 \\leq k \\leq n \\leq 10^6$，$1 \\leq X_i,Y_i \\leq 10^5$。\n\n**样例 1 解释：**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pjop5zum.png)。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #5] TRAKTOR", "background": "Mirko 用拖拉机采蘑菇。", "description": "已知一个平面上 $n$ 个点，每个点的坐标可以用正整数 $X_i,Y_i$ 表示，求最小的 $ans$ 使前 $ans$ 个点中有至少 $k$ 个点处于同一行或同一列或同一与对角线平行的斜线。", "inputFormat": "第一行两个正整数 $n,k$。\n\n接下来 $n$ 行，每行两个正整数 $X_i,Y_i$。", "outputFormat": "一个正整数 $ans$。如无解输出 $-1$。", "hint": "对于 $50\\%$ 的数据，$1 \\leq X_i,Y_i \\leq 300$。\n\n对于 $100\\%$ 的数据，$2 \\leq k \\leq n \\leq 10^6$，$1 \\leq X_i,Y_i \\leq 10^5$。\n\n**样例 1 解释：**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pjop5zum.png)。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)", "locale": "zh-CN"}}}
{"pid": "P7662", "type": "P", "difficulty": 4, "samples": [["13", "12 14"], ["5801001", "5810101"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #5] ZGODAN", "background": "", "description": "定义 Handsome 数：这个正整数中任意两个相邻的数位的奇偶性不同。\n\n给你一个正整数 $n$，求与 $n$ 最近的 Handsome 数。如果有多个按从小到大的顺序输出。", "inputFormat": "一个正整数 $n$。", "outputFormat": "与 $n$ 最近的 Handsome 数。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^{1000}$。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #5] ZGODAN", "background": "", "description": "定义 Handsome 数：这个正整数中任意两个相邻的数位的奇偶性不同。\n\n给你一个正整数 $n$，求与 $n$ 最近的 Handsome 数。如果有多个按从小到大的顺序输出。", "inputFormat": "一个正整数 $n$。", "outputFormat": "与 $n$ 最近的 Handsome 数。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^{1000}$。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7663", "type": "P", "difficulty": 4, "samples": [["3 3\nx..\n...\n...\n3\n1 3\n1 1\n3 2", "4\n0\n5"], ["5 5\n..x..\n....x\n.....\n.....\n.....\n4\n3 1\n5 3\n4 5\n3 5", "8\n8\n4\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #5] JABUKE", "background": "", "description": "给你一个 $n \\times m$ 的矩阵，其中苹果树用 `x` 表示，空地用 `.` 表示。\n\n有 $g$ 年，每年都会从天而降一个苹果，落在坐标 $(x_i,y_i)$ 上，要求出**这个苹果离最近一棵苹果树的距离的平方**。当然，一年后这个苹果会长成新的一颗苹果树，并参与一年后落下的那个苹果的计算。", "inputFormat": "第一行两个正整数 $n,m$，表示矩阵的长，宽。\n\n接下来 $n$ 行，每行 $m$ 个字符，字符仅含 `x` 和 `.`，表示该矩阵。\n\n接下来一个正整数 $g$，表示年份。\n\n接下来 $g$ 行每行两个正整数 $x_i,y_i$，表示每年苹果下落的位置。", "outputFormat": "一共 $g$ 行，每行一个整数，表示每个苹果下落时离最近一棵苹果树的距离的平方。", "hint": "对于 $30\\%$ 的数据，$1 \\leq g \\leq 500$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m \\leq 500,1 \\leq g \\leq 10^5$，保证初始矩阵至少包含一棵苹果树。\n\n距离计算公式：$d((x_1,y_1),(x_2,y_2))=\\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #5] JABUKE", "background": "", "description": "给你一个 $n \\times m$ 的矩阵，其中苹果树用 `x` 表示，空地用 `.` 表示。\n\n有 $g$ 年，每年都会从天而降一个苹果，落在坐标 $(x_i,y_i)$ 上，要求出**这个苹果离最近一棵苹果树的距离的平方**。当然，一年后这个苹果会长成新的一颗苹果树，并参与一年后落下的那个苹果的计算。", "inputFormat": "第一行两个正整数 $n,m$，表示矩阵的长，宽。\n\n接下来 $n$ 行，每行 $m$ 个字符，字符仅含 `x` 和 `.`，表示该矩阵。\n\n接下来一个正整数 $g$，表示年份。\n\n接下来 $g$ 行每行两个正整数 $x_i,y_i$，表示每年苹果下落的位置。", "outputFormat": "一共 $g$ 行，每行一个整数，表示每个苹果下落时离最近一棵苹果树的距离的平方。", "hint": "对于 $30\\%$ 的数据，$1 \\leq g \\leq 500$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m \\leq 500,1 \\leq g \\leq 10^5$，保证初始矩阵至少包含一棵苹果树。\n\n距离计算公式：$d((x_1,y_1),(x_2,y_2))=\\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7666", "type": "P", "difficulty": 2, "samples": [["3 2\n1\n3\n6", "4"], ["3 1\n1\n2\n6", "6"], ["3 3\n1\n3\n6", "3"], ["10 5\n1\n2\n5\n6\n8\n11\n13\n15\n16\n20", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "2018", "排序", "JOI（日本）"], "title": "[JOI 2018 Final] 寒冬暖炉 / Stove", "background": "", "description": "JOI 君的房间里有一个炉子。因为 JOI 君已经习惯了寒冷的温度，所以当他一个人在房间里时，他不需要打开炉子。但是，有客人时，他需要打开炉子。有一天，$N$ 位客人将拜访 JOI 君。第 $i$ 个客人 ($1 \\leq i \\leq N$) 将在时间 $T_i$ 到达，并在时间 $T_i+1$ 离开。任何时间最多有一个客人访问  JOI 君。JOI 君可以随时开火或关火。JOI 君用火柴打开炉子。JOI 君只有 $K$ 根火柴。 因此他最多可以打开炉子 $K$ 次。在一天的开始，炉子是关闭的。当炉子打开时，它需要燃料。因此，JOI 君控制着他何时打开或关闭炉子，他想尽量减少炉子的总运行时间。  \n现给定访问 JOI 君的客人数据和 JOI 君拥有的火柴数，请编写一个程序来计算炉子总运行时间的最小值。", "inputFormat": "第一行包含两个空格分隔的整数 $N$，$K$。 这意味着 $N$ 位客人将访问 JOI 君，而 JOI 君 有 $K$ 根火柴。接下来的下 $N$ 行的第 $i$ 行包含整数 $T_i$。这意味着第 $i$ 个客人将在时间 $T_i$ 到达，并在时间 $T_i+1$ 离开。", "outputFormat": "唯一的一行应包含一个整数为炉子总运行时间的最小值。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq N \\leq 10^5$，$1 \\leq K \\leq N$，$1 \\leq T_i \\leq 10^9$（$1 \\leq i \\leq N$），$T_i < T_{i+1}$（$1 \\leq i \\leq N-1$）。  \n- Subtask $1$（$20$ points）：$N \\leq 20$。  \n- Subtask $2$（$30$ points）：$N \\leq 5000$。  \n- Subtask $3$（$50$ points）：没有额外的限制。  \n#### 样例说明  \n**对于样例 $1$**：三位客人将访问 JOI 君。如果他按以下方式打开和关闭炉子，那么当客人来访时打开炉子，他打开炉子两次，炉子的总运行时间为 $(4-1)+(7-6)=4$。  \n- 当第一位客人到来时，他在时间 1 打开炉子。  \n- 当第二位客人离开时，他在时间 4 关掉炉子。  \n- 当第三位客人到来时，他在时间 6 打开炉子。  \n- 当第三位客人离开时，他在时间 7 关掉炉子。  \n\n由于炉子的总运行时间不能小于 $4$，输出 $4$。  \n**对于样例 $2$**：JOI 君只能打开一次炉子。因此，他在第一个客人来的时间 $1$ 打开炉子，当第三位客人离开时他在时间 $7$ 关掉炉子。  \n请注意，客人离开的时间可以与下一位客人到来的时间相同。  \n**对于样例 $3$**：JOI 君在每位客人到来时打开炉子，并在每位客人离开时关掉炉子。  \n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T1：Stove](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t1-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2018 Final] 寒冬暖炉 / Stove", "background": "", "description": "JOI 君的房间里有一个炉子。因为 JOI 君已经习惯了寒冷的温度，所以当他一个人在房间里时，他不需要打开炉子。但是，有客人时，他需要打开炉子。有一天，$N$ 位客人将拜访 JOI 君。第 $i$ 个客人 ($1 \\leq i \\leq N$) 将在时间 $T_i$ 到达，并在时间 $T_i+1$ 离开。任何时间最多有一个客人访问  JOI 君。JOI 君可以随时开火或关火。JOI 君用火柴打开炉子。JOI 君只有 $K$ 根火柴。 因此他最多可以打开炉子 $K$ 次。在一天的开始，炉子是关闭的。当炉子打开时，它需要燃料。因此，JOI 君控制着他何时打开或关闭炉子，他想尽量减少炉子的总运行时间。  \n现给定访问 JOI 君的客人数据和 JOI 君拥有的火柴数，请编写一个程序来计算炉子总运行时间的最小值。", "inputFormat": "第一行包含两个空格分隔的整数 $N$，$K$。 这意味着 $N$ 位客人将访问 JOI 君，而 JOI 君 有 $K$ 根火柴。接下来的下 $N$ 行的第 $i$ 行包含整数 $T_i$。这意味着第 $i$ 个客人将在时间 $T_i$ 到达，并在时间 $T_i+1$ 离开。", "outputFormat": "唯一的一行应包含一个整数为炉子总运行时间的最小值。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq N \\leq 10^5$，$1 \\leq K \\leq N$，$1 \\leq T_i \\leq 10^9$（$1 \\leq i \\leq N$），$T_i < T_{i+1}$（$1 \\leq i \\leq N-1$）。  \n- Subtask $1$（$20$ points）：$N \\leq 20$。  \n- Subtask $2$（$30$ points）：$N \\leq 5000$。  \n- Subtask $3$（$50$ points）：没有额外的限制。  \n#### 样例说明  \n**对于样例 $1$**：三位客人将访问 JOI 君。如果他按以下方式打开和关闭炉子，那么当客人来访时打开炉子，他打开炉子两次，炉子的总运行时间为 $(4-1)+(7-6)=4$。  \n- 当第一位客人到来时，他在时间 1 打开炉子。  \n- 当第二位客人离开时，他在时间 4 关掉炉子。  \n- 当第三位客人到来时，他在时间 6 打开炉子。  \n- 当第三位客人离开时，他在时间 7 关掉炉子。  \n\n由于炉子的总运行时间不能小于 $4$，输出 $4$。  \n**对于样例 $2$**：JOI 君只能打开一次炉子。因此，他在第一个客人来的时间 $1$ 打开炉子，当第三位客人离开时他在时间 $7$ 关掉炉子。  \n请注意，客人离开的时间可以与下一位客人到来的时间相同。  \n**对于样例 $3$**：JOI 君在每位客人到来时打开炉子，并在每位客人离开时关掉炉子。  \n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T1：Stove](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t1-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7667", "type": "P", "difficulty": 3, "samples": [["3\n2 3\n11 2\n4 5", "6"], ["6\n4 1\n1 5\n10 3\n9 1\n4 2\n5 3", "7"], ["15 \n1543361732 260774320\n2089759661 257198921\n1555665663 389548466\n4133306295 296394520\n2596448427 301103944\n1701413087 274491541\n2347488426 912791996\n2133012079 444074242\n2659886224 656957044\n1345396764 259870638\n2671164286 233246973\n2791812672 585862344\n2996614635 91065315\n971304780 488995617\n1523452673 988137562", "4232545716"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2018", "JOI（日本）"], "title": "[JOI 2018 Final] 美术展览 / Art Exhibition", "background": "JOI 共和国将举行一个艺术展。许多来自全国各地的艺术作品将在艺术展中展出。", "description": "有 $N$ 件艺术品是展览的候选作品。艺术品编号从 $1$ 到  $N$。每件艺术品都定义了两个整数：尺寸和价值。艺术品 $i$（$1 \\leq i \\leq N$）的尺寸为 $A_i$，艺术品 $i$ 的价值为 $B_i$。  \n在艺术展中，至少会选择并展示一件艺术品。由于展厅足够大，可以将 $N$ 件作品全部展示。但是，由于 JOI 共和国人的审美意识，我们希望展览选择的艺术品，使展出的艺术品尺寸之间的差异不会太大。另一方面，我们想展示许多具有高价值的艺术品。我们决定按照以下规则选择展览的艺术品：  \n- 在选择的展览作品中，$A_{max}$ 为所选作品中最大的尺寸，$A_{min}$ 为所选作品中最小的尺寸。设 $S$ 为所选艺术品的总价值。  \n- 然后，我们想要最大化 $S−(A_{max}−A_{min})$。  \n现给定展览的艺术品候选数量，以及每件艺术品的尺寸和价值，请编写一个程序来计算 $S−(A_{max}−A_{min})$ 的最大值。", "inputFormat": "第一行包含一个整数 $N$，即展览艺术品的候选数量。接下来的 $N$ 行的第 $i$ 行包含两个空格分隔的整数 $A_i$、$B_i$，这意味着艺术品 $i$ 的尺寸是 $A_i$，价值是 $B_i$。", "outputFormat": "唯一的一行包含一个整数为 $S−(A_{max}−A_{min})$ 的最大值。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$2 \\leq N \\leq 5×10^5$，$1 \\leq A_i \\leq 10^{15}$（$1 \\leq i \\leq N$），$1 \\leq B_i \\leq 10^9$（$1 \\leq i \\leq N$）。  \n- Subtask $1$（$10$ points）：$N \\leq 16$。  \n- Subtask $1$（$20$ points）：$N \\leq 300$。  \n- Subtask $2$（$20$ points）：$N \\leq 5000$。  \n- Subtask $3$（$50$ points）：没有额外的限制。  \n#### 样例说明  \n**对于样例 $1$**：本次展览共有 $3$ 幅作品候选。每件艺术品的尺寸和价值如下：  \n- 艺术品 $1$ 的尺寸为 $2$，价值为 $3$。  \n- 艺术品 $2$ 的尺寸为 $11$，价值为 $2$。  \n- 艺术品 $3$ 的尺寸为 $4$，价值为 $5$。  \n\n在这种情况下，如果我们为展览选择艺术品 $1$ 和艺术品 $3$，我们有 $S−(A_{max}−A_{min})$  如下：  \n- 在选择的艺术品中，艺术品 $3$ 的尺寸最大。因此，$A_{max} = 4$。  \n- 在所选的艺术品中，艺术品 $1$ 的尺寸最小。因此，$A_{min} = 2$。  \n- 所选艺术品的总价值为 $3+5=8$。因此，$S=8$。  \n由于 $S−(A_{max}−A_{min})$ 不能大于 $7$，因此输出 $6$。\n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T2：Art Exhibition](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t2-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2018 Final] 美术展览 / Art Exhibition", "background": "JOI 共和国将举行一个艺术展。许多来自全国各地的艺术作品将在艺术展中展出。", "description": "有 $N$ 件艺术品是展览的候选作品。艺术品编号从 $1$ 到  $N$。每件艺术品都定义了两个整数：尺寸和价值。艺术品 $i$（$1 \\leq i \\leq N$）的尺寸为 $A_i$，艺术品 $i$ 的价值为 $B_i$。  \n在艺术展中，至少会选择并展示一件艺术品。由于展厅足够大，可以将 $N$ 件作品全部展示。但是，由于 JOI 共和国人的审美意识，我们希望展览选择的艺术品，使展出的艺术品尺寸之间的差异不会太大。另一方面，我们想展示许多具有高价值的艺术品。我们决定按照以下规则选择展览的艺术品：  \n- 在选择的展览作品中，$A_{max}$ 为所选作品中最大的尺寸，$A_{min}$ 为所选作品中最小的尺寸。设 $S$ 为所选艺术品的总价值。  \n- 然后，我们想要最大化 $S−(A_{max}−A_{min})$。  \n现给定展览的艺术品候选数量，以及每件艺术品的尺寸和价值，请编写一个程序来计算 $S−(A_{max}−A_{min})$ 的最大值。", "inputFormat": "第一行包含一个整数 $N$，即展览艺术品的候选数量。接下来的 $N$ 行的第 $i$ 行包含两个空格分隔的整数 $A_i$、$B_i$，这意味着艺术品 $i$ 的尺寸是 $A_i$，价值是 $B_i$。", "outputFormat": "唯一的一行包含一个整数为 $S−(A_{max}−A_{min})$ 的最大值。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$2 \\leq N \\leq 5×10^5$，$1 \\leq A_i \\leq 10^{15}$（$1 \\leq i \\leq N$），$1 \\leq B_i \\leq 10^9$（$1 \\leq i \\leq N$）。  \n- Subtask $1$（$10$ points）：$N \\leq 16$。  \n- Subtask $1$（$20$ points）：$N \\leq 300$。  \n- Subtask $2$（$20$ points）：$N \\leq 5000$。  \n- Subtask $3$（$50$ points）：没有额外的限制。  \n#### 样例说明  \n**对于样例 $1$**：本次展览共有 $3$ 幅作品候选。每件艺术品的尺寸和价值如下：  \n- 艺术品 $1$ 的尺寸为 $2$，价值为 $3$。  \n- 艺术品 $2$ 的尺寸为 $11$，价值为 $2$。  \n- 艺术品 $3$ 的尺寸为 $4$，价值为 $5$。  \n\n在这种情况下，如果我们为展览选择艺术品 $1$ 和艺术品 $3$，我们有 $S−(A_{max}−A_{min})$  如下：  \n- 在选择的艺术品中，艺术品 $3$ 的尺寸最大。因此，$A_{max} = 4$。  \n- 在所选的艺术品中，艺术品 $1$ 的尺寸最小。因此，$A_{min} = 2$。  \n- 所选艺术品的总价值为 $3+5=8$。因此，$S=8$。  \n由于 $S−(A_{max}−A_{min})$ 不能大于 $7$，因此输出 $6$。\n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T2：Art Exhibition](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t2-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7668", "type": "P", "difficulty": 5, "samples": [["3 4\nRGWR\nGRGG\nRGWW", "3"], ["4 4\nRGWR\nGRRG\nWGGW\nWWWR", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "JOI（日本）"], "title": "[JOI 2018 Final] 团子制作 / Dango Maker", "background": "你是一名专业的糕点师，制作团子，日本甜饺子。现在，你要串饺子了。", "description": "饺子被放置在具有 $N$ 行和 $M$ 列的单元格网格上。每个单元格包含一个饺子。每个饺子的颜色是红色（$\\texttt{R}$）、绿色（$\\texttt{G}$）或 白色（$\\texttt{W}$）。  \n您将从单元格中选择三个连续的饺子，并将它们串成一根棍子。所选的三个连续饺子的方向必须是从左到右，或从上到下。  \n现在，您要按此顺序制作颜色为红色、绿色、白色的饺子串。你想做尽可能多的饺子串。串到棍子上的饺子的顺序必须与从单元格中选择的饺子的顺序相同。一个饺子上不能串多根棍子。 \n你能做多少串饺子？  \n现给定放置在单元格上的饺子的颜色，请编写一个程序来计算您可以制作的饺子的最大数量。颜色必须按此顺序为红色、绿色、白色。", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $M$。接下来的 $N$ 行的第 $i$ 行包含大小为 $M$ 的字符串，由 $\\texttt{R}$、$\\texttt{G}$ 或 $\\texttt{W}$ 组成。该字符串的第 $j$ 个字符是从上数第 $i$ 行、从左数第 $j$ 列的饺子的颜色。", "outputFormat": "输出一个整数饺子串的最大数量。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq N \\leq 3000$，$1 \\leq M \\leq 3000$，$1 \\leq i \\leq N$，$1 \\leq j \\leq M$。  \n- Subtask $1$（$13$ points）：$N \\leq 4$，$M \\leq 4$。  \n- Subtask $2$（$20$ points）：$N \\leq 10$，$M \\leq 10$。  \n- Subtask $3$（$67$ points）：没有额外的限制。  \n#### 样例说明  \n**对于样例 $1$**：你能制作 $3$ 串饺子。 \n- 您从顶部的第一行和左侧的第一列中选择三个连续的饺子。方向是从左到右。然后，你按照这个顺序把它们串成一串。  \n- 您从上数第一行和左数第 $4$ 列中选择三个连续的饺子。方向是从上到下。然后，你按照这个顺序把它们串成一串。  \n- 您从上数第三行和左数第一列中选择三个连续的饺子。方向是从左到右。然后，你按照这个顺序把它们串成一串。  \n\n因为你不能做 $4$ 串，所以输出 $3$。  \n**对于样例 $2$**：你能制作 $4$ 串饺子。 \n- 您从顶部的第一行和左侧的第一列中选择三个连续的饺子。方向是从左到右。然后，你按照这个顺序把它们串成一串。  \n- 您从顶部的第一行和左侧的第 4 列中选择三个连续的饺子。方向是从上到下。然后，你按照这个顺序把它们串成一串。  \n- 您从上数第二行和左数第二列中选择三个连续的饺子。方向是从上到下。然后，你按照这个顺序把它们串成一串。  \n- 您从上数第二行和左数第三列中选择三个连续的饺子。方向是从上到下。然后，你按照这个顺序把它们串成一串。  \n\n因为你不能做 $5$ 串，所以输出 $4$。  \n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T3：Dango Maker](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t3-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2018 Final] 团子制作 / Dango Maker", "background": "你是一名专业的糕点师，制作团子，日本甜饺子。现在，你要串饺子了。", "description": "饺子被放置在具有 $N$ 行和 $M$ 列的单元格网格上。每个单元格包含一个饺子。每个饺子的颜色是红色（$\\texttt{R}$）、绿色（$\\texttt{G}$）或 白色（$\\texttt{W}$）。  \n您将从单元格中选择三个连续的饺子，并将它们串成一根棍子。所选的三个连续饺子的方向必须是从左到右，或从上到下。  \n现在，您要按此顺序制作颜色为红色、绿色、白色的饺子串。你想做尽可能多的饺子串。串到棍子上的饺子的顺序必须与从单元格中选择的饺子的顺序相同。一个饺子上不能串多根棍子。 \n你能做多少串饺子？  \n现给定放置在单元格上的饺子的颜色，请编写一个程序来计算您可以制作的饺子的最大数量。颜色必须按此顺序为红色、绿色、白色。", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $M$。接下来的 $N$ 行的第 $i$ 行包含大小为 $M$ 的字符串，由 $\\texttt{R}$、$\\texttt{G}$ 或 $\\texttt{W}$ 组成。该字符串的第 $j$ 个字符是从上数第 $i$ 行、从左数第 $j$ 列的饺子的颜色。", "outputFormat": "输出一个整数饺子串的最大数量。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq N \\leq 3000$，$1 \\leq M \\leq 3000$，$1 \\leq i \\leq N$，$1 \\leq j \\leq M$。  \n- Subtask $1$（$13$ points）：$N \\leq 4$，$M \\leq 4$。  \n- Subtask $2$（$20$ points）：$N \\leq 10$，$M \\leq 10$。  \n- Subtask $3$（$67$ points）：没有额外的限制。  \n#### 样例说明  \n**对于样例 $1$**：你能制作 $3$ 串饺子。 \n- 您从顶部的第一行和左侧的第一列中选择三个连续的饺子。方向是从左到右。然后，你按照这个顺序把它们串成一串。  \n- 您从上数第一行和左数第 $4$ 列中选择三个连续的饺子。方向是从上到下。然后，你按照这个顺序把它们串成一串。  \n- 您从上数第三行和左数第一列中选择三个连续的饺子。方向是从左到右。然后，你按照这个顺序把它们串成一串。  \n\n因为你不能做 $4$ 串，所以输出 $3$。  \n**对于样例 $2$**：你能制作 $4$ 串饺子。 \n- 您从顶部的第一行和左侧的第一列中选择三个连续的饺子。方向是从左到右。然后，你按照这个顺序把它们串成一串。  \n- 您从顶部的第一行和左侧的第 4 列中选择三个连续的饺子。方向是从上到下。然后，你按照这个顺序把它们串成一串。  \n- 您从上数第二行和左数第二列中选择三个连续的饺子。方向是从上到下。然后，你按照这个顺序把它们串成一串。  \n- 您从上数第二行和左数第三列中选择三个连续的饺子。方向是从上到下。然后，你按照这个顺序把它们串成一串。  \n\n因为你不能做 $5$ 串，所以输出 $4$。  \n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T3：Dango Maker](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t3-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7669", "type": "P", "difficulty": 6, "samples": [["6 6\n1 6\n1 4\n1 2 1\n2 3 1\n3 5 1\n2 4 3\n4 5 2\n5 6 1", "2"], ["6 5\n1 2\n3 6\n1 2 1000000000 \n2 3 1000000000\n3 4 1000000000\n4 5 1000000000\n5 6 1000000000", "3000000000"], ["8 8\n5 7\n6 8\n1 2 2\n2 3 3\n3 4 4\n1 4 1\n1 5 5\n2 6 6\n3 7 7\n4 8 8", "15"], ["5 5\n1 5\n2 3\n1 2 1\n2 3 10\n2 4 10\n3 5 10\n4 5 10", "0"], ["10 15\n6 8\n7 9\n2 7 12\n8 10 17\n1 3 1\n3 8 14\n5 7 15\n2 3 7\n1 10 14\n3 6 12\n1 5 10\n8 9 1\n2 9 7\n1 4 1  \n1 8 1\n2 4 7\n5 6 16", "19"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2018", "拓扑排序", "最短路", "JOI（日本）"], "title": "[JOI 2018 Final] 月票购买 / Commuter Pass", "background": "", "description": "JOI 君住在一个有 $N$ 个车站的城市。车站编号为 $1$ 至$N$。编号为 $1$ 至 $M$ 的有 $M$ 条铁路。铁路 $i$（$1 \\leq i \\leq M$）双向连接 $A_i$ 站和 $B_i$ 站，票价为 $C_i$ 日元。  \nJOI 君住在 $S$ 站附近，去 $T$ 站附近的 IOI 高中。他打算买一张连接这两个站的通勤票。当他购买通勤票时，他需要选择一条成本最低的 $S$ 站和 $T$ 站之间的路线。使用此通勤票，他可以沿任何方向乘坐所选路线中包含的任何铁路，而无需额外费用。  \nJOI 君经常去 $U$ 站和 $V$ 站附近的书店。因此，他想买一张通勤票，这样从 $U$ 站到 $V$ 站的费用可以降到最低。  \n当他从 $U$ 站移动到 $V$ 站时，他首先选择了一条从 $U$ 站到 $V$ 站的路线，那么他需要支付的车费是：  \n- $0$ 日元：如果铁路 $i$ 包含在他购买的通勤票时选择的路线中，或者，  \n- $C_i$ 日元：如果铁路 $i$ 不包含在他购买通勤票时选择的路线中。  \n\n上述票价的总和就是从 $U$ 站到 $V$ 站的成本。  \n他想知道如果他在购买通勤票时选择合适的路线，从 $U$ 站到 $V$ 站的最低成本。", "inputFormat": "第一行包含两个空格分隔的整数 $N$，$M$。这意味着 JOI 君居住的城市有 $N$ 个车站和 $M$ 条铁路。第二行包含两个空格分隔的整数 $S$，$T$。这意味着 JOI 君计划购买从 $S$ 站到 $T$ 站的通勤票。第三行包含两个空格分隔的整数 $U$，$V$。这意味着 JOI 君想要最小化从站 $U$ 到站 $V$ 的成本。接下来的 $M$ 行的第 $i$ 行包含三个空格分隔的整数 $A_i$，$B_i$，$C_i$。铁路 $i$ 双向连接 $A_i$ 站和 $B_i$ 站，票价为 $C_i$ 日元。", "outputFormat": "如果他在购买通勤票时选择了适当的路线，则输出应包含一个整数为从站 $U$ 到站 $V$ 的最小成本。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，  \n$2 \\leq N \\leq 10^5$，$1 \\leq M \\leq 2×10^5$，$1 \\leq S \\leq N$，$1 \\leq T \\leq N$，$1 \\leq U \\leq N$，$1 \\leq V \\leq N$，$S {=}\\mathllap{/\\,} T$，$U {=}\\mathllap{/\\,} V$，$ S{=}\\mathllap{/\\,} U$ 或 $T {=}\\mathllap{/\\,} V$，$1 \\leq A_i \\leq B_i \\leq N$（$1 \\leq i \\leq M$）。对于每 $1 \\leq i < j \\leq M$，$A_i {=}\\mathllap{/\\,} A_j$ 或 $B_i {=}\\mathllap{/\\,} B_j$，$1 \\leq C_i \\leq 10^9$（$1 \\leq i \\leq M$）。JOI 君可以从任何车站移动到任何其他车站乘坐铁路。  \n- Subtask $1$（$16$ points）：$S=U$。  \n- Subtask $2$（$15$ points）：从 $S$ 站到 $T$ 站有一条成本最低的唯一路线。  \n- Subtask $3$（$24$ points）：$N \\leq 300$。  \n- Subtask $4$（$45$ points）：没有额外的限制。  \n#### 样例说明  \n**对于样例 $1$**：JOI 君在购买通勤票时只能选择一条路线：$1$ 号站 → $2$ 号站 →$3$ 号站 → $5$ 号站 → $6$ 号站。为了尽量减少从 $1$ 号站到 $4$ 号站的成本 ，他选择以下路线：$1$ 站 → $2$ 站 → $3$ 站 → $5$ 站 → $4$ 站。选择这条路线时，他需要支付的车费为。  \n- $2$ 日元用于车站 $4$ 和车站 $5$ 的铁路 $5$，以及，  \n- $0$ 日元：其他铁路。  \n  \n**对于样例 $2$**：JOI 君从 $3$ 号站移动到 $6$ 号站时，不使用通勤票。  \n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T4：Commuter Pass](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t4-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \n#### Hack 说明  \n[@gaojunqing](https://www.luogu.com.cn/user/536005) 于 2021 年 11 月 6 日向供题人提供一组 hack 数据，经过多次检验后于 2021 年 11 月 7 日加入到本题测试数据中。  \n出于对该 JOI 原题的尊重与体验考虑，一律所加入的 hack 数据均不做分值改变，即满分依然为 100 分，新增 hack 数据单独放置在 Subtask #5 ，且分数为 0 分。即如通过原所有测试数据而未通过 hack 数据，将获得 100 分但不能 AC，当且仅当通过全部测试数据方可 AC。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2018 Final] 月票购买 / Commuter Pass", "background": "", "description": "JOI 君住在一个有 $N$ 个车站的城市。车站编号为 $1$ 至$N$。编号为 $1$ 至 $M$ 的有 $M$ 条铁路。铁路 $i$（$1 \\leq i \\leq M$）双向连接 $A_i$ 站和 $B_i$ 站，票价为 $C_i$ 日元。  \nJOI 君住在 $S$ 站附近，去 $T$ 站附近的 IOI 高中。他打算买一张连接这两个站的通勤票。当他购买通勤票时，他需要选择一条成本最低的 $S$ 站和 $T$ 站之间的路线。使用此通勤票，他可以沿任何方向乘坐所选路线中包含的任何铁路，而无需额外费用。  \nJOI 君经常去 $U$ 站和 $V$ 站附近的书店。因此，他想买一张通勤票，这样从 $U$ 站到 $V$ 站的费用可以降到最低。  \n当他从 $U$ 站移动到 $V$ 站时，他首先选择了一条从 $U$ 站到 $V$ 站的路线，那么他需要支付的车费是：  \n- $0$ 日元：如果铁路 $i$ 包含在他购买的通勤票时选择的路线中，或者，  \n- $C_i$ 日元：如果铁路 $i$ 不包含在他购买通勤票时选择的路线中。  \n\n上述票价的总和就是从 $U$ 站到 $V$ 站的成本。  \n他想知道如果他在购买通勤票时选择合适的路线，从 $U$ 站到 $V$ 站的最低成本。", "inputFormat": "第一行包含两个空格分隔的整数 $N$，$M$。这意味着 JOI 君居住的城市有 $N$ 个车站和 $M$ 条铁路。第二行包含两个空格分隔的整数 $S$，$T$。这意味着 JOI 君计划购买从 $S$ 站到 $T$ 站的通勤票。第三行包含两个空格分隔的整数 $U$，$V$。这意味着 JOI 君想要最小化从站 $U$ 到站 $V$ 的成本。接下来的 $M$ 行的第 $i$ 行包含三个空格分隔的整数 $A_i$，$B_i$，$C_i$。铁路 $i$ 双向连接 $A_i$ 站和 $B_i$ 站，票价为 $C_i$ 日元。", "outputFormat": "如果他在购买通勤票时选择了适当的路线，则输出应包含一个整数为从站 $U$ 到站 $V$ 的最小成本。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，  \n$2 \\leq N \\leq 10^5$，$1 \\leq M \\leq 2×10^5$，$1 \\leq S \\leq N$，$1 \\leq T \\leq N$，$1 \\leq U \\leq N$，$1 \\leq V \\leq N$，$S {=}\\mathllap{/\\,} T$，$U {=}\\mathllap{/\\,} V$，$ S{=}\\mathllap{/\\,} U$ 或 $T {=}\\mathllap{/\\,} V$，$1 \\leq A_i \\leq B_i \\leq N$（$1 \\leq i \\leq M$）。对于每 $1 \\leq i < j \\leq M$，$A_i {=}\\mathllap{/\\,} A_j$ 或 $B_i {=}\\mathllap{/\\,} B_j$，$1 \\leq C_i \\leq 10^9$（$1 \\leq i \\leq M$）。JOI 君可以从任何车站移动到任何其他车站乘坐铁路。  \n- Subtask $1$（$16$ points）：$S=U$。  \n- Subtask $2$（$15$ points）：从 $S$ 站到 $T$ 站有一条成本最低的唯一路线。  \n- Subtask $3$（$24$ points）：$N \\leq 300$。  \n- Subtask $4$（$45$ points）：没有额外的限制。  \n#### 样例说明  \n**对于样例 $1$**：JOI 君在购买通勤票时只能选择一条路线：$1$ 号站 → $2$ 号站 →$3$ 号站 → $5$ 号站 → $6$ 号站。为了尽量减少从 $1$ 号站到 $4$ 号站的成本 ，他选择以下路线：$1$ 站 → $2$ 站 → $3$ 站 → $5$ 站 → $4$ 站。选择这条路线时，他需要支付的车费为。  \n- $2$ 日元用于车站 $4$ 和车站 $5$ 的铁路 $5$，以及，  \n- $0$ 日元：其他铁路。  \n  \n**对于样例 $2$**：JOI 君从 $3$ 号站移动到 $6$ 号站时，不使用通勤票。  \n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T4：Commuter Pass](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t4-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \n#### Hack 说明  \n[@gaojunqing](https://www.luogu.com.cn/user/536005) 于 2021 年 11 月 6 日向供题人提供一组 hack 数据，经过多次检验后于 2021 年 11 月 7 日加入到本题测试数据中。  \n出于对该 JOI 原题的尊重与体验考虑，一律所加入的 hack 数据均不做分值改变，即满分依然为 100 分，新增 hack 数据单独放置在 Subtask #5 ，且分数为 0 分。即如通过原所有测试数据而未通过 hack 数据，将获得 100 分但不能 AC，当且仅当通过全部测试数据方可 AC。", "locale": "zh-CN"}}}
{"pid": "P7670", "type": "P", "difficulty": 6, "samples": [["3 5\n12345678\n000\n0??\n1?0\n?11\n???", "1\n10\n12\n12\n36"], ["4 8\n3141592653589793\n0101\n?01?\n??1?\n?0??\n1?00\n01?1\n??10\n????", "9\n18\n38\n30\n14\n15\n20\n80"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2018", "JOI（日本）"], "title": "[JOI 2018 Final] 毒蛇越狱 / Snake Escaping", "background": "**请注意本题特殊的内存限制。**", "description": "JOI 实验室有 $2^L$ 条毒蛇。蛇的编号为  $0,1,\\cdots,2^L−1$。每条蛇从头到尾分为  $L$ 个部分。每个部分的颜色是蓝色或红色。 对于毒蛇 $i$，令 $i = \\sum_{k=1}^{L} c_k2^{L-k}$（$0 \\leq c_k \\leq 1$）为 $i$ 的二进制表达式。那么，  \n- 如果 $c_k=0$，毒蛇 $i$ 从头开始的第 $k$ 部分的颜色是蓝色，  \n- 如果 $c_k=1$，毒蛇 $i$ 从头开始的第 $k$ 部分的颜色是红色。  \n\n每条毒蛇都有一个 $0$ 到 $9$ 之间的整数，包括 $0$ 和 $9$，为毒性。给出一个由 $\\texttt{0,1,2,3,4,5,6,7,8,9}$ 组成的长度为  $2^L$ 的字符串 $S$。第 $i$ 个字符（$1 \\leq i \\leq 2^L$）是毒蛇 $i−1$ 的毒性。由于毒蛇行动迅速，所以经常从 JOI 实验室逃走。住在实验室附近的人向 JOI 实验室投诉，他们看到毒蛇从实验室逃逸。您将收到 $Q$ 天的投诉清单。 第 $d$ 天的投诉（$1 \\leq d \\leq Q$）是一个长度为 $L$ 的字符串 $T_d$，由 $\\texttt{0,1,?}$ 组成。  \n- 如果 $T_d$ 的第 $j$ 个字符（$1 \\leq j ≤ L$）为 $\\texttt{0}$，这意味着第 $d$ 天从实验室逃出的每条毒蛇的第 $j$ 个部分是蓝色的，  \n- 如果 $T_d$ 的第 $j$ 个字符（$1 \\leq j \\leq L$）为 $\\texttt{1}$，这意味着第 $d$ 天从实验室逃出的每条毒蛇的第 $j$ 部分是红色的，并且  \n- 如果 $T_d$ 的第 $j$ 个字符（$1 \\leq j \\leq L$）为 $\\texttt{?}$，这意味着人们没有提供关于第 $d$ 天从实验室逃逸的毒蛇的第 $j$ 部分的信息。  \n\n所有的投诉都是准确的信息。所有从实验室逃逸的毒蛇都在同一天被 JOI 实验室的工作人员收留。可能发生同一条蛇在不同的日子逃脱。  \nJOI 实验室执行主任 K 教授为了估计毒蛇逃逸的风险，想知道可能逃出实验室的毒蛇的毒性总和。 你的任务是编写一个程序，根据 $Q$ 天的投诉列表，计算每天可能从实验室逃逸的蛇的毒性总和。  \n现给定描述毒蛇毒性的字符串 $S$ 和 $Q$ 天的投诉列表，请编写一个程序来计算每天可能从实验室逃逸的蛇的毒性总和。  \n", "inputFormat": "第一行包含两个空格分隔的整数 $L$，$Q$，分别是每条毒蛇的部位数和投诉天数。第二行包含长度为 $2^L$ 的字符串 $S$，描述了毒蛇的毒性。后面 $Q$ 行的第 $d$ 行包含一个长度为 $L$ 的字符串 $T_d$，为第 $d$ 天的投诉。", "outputFormat": "共 $Q$ 行，第 $d$ 行应包含一个整数，即第 $d$ 天可能从实验室逃逸的蛇的毒性总和。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq L \\leq 20$，$1 \\leq Q \\leq 10^6$，$S$ 是长度为 $2^L$ 的字符串，字符串 $S$ 由 $\\texttt{0,1,2,3,4,5,6,7,8,9}$ 组成，$T_d$ 是长度为 $L$（$1 \\leq d \\leq Q$）的字符串，字符串 $T_d$ 由 $\\texttt{0,1,?}$（$1 \\leq d \\leq Q$）组成。  \n- Subtask $1$（$5$ points）：$L \\leq 10$，$Q \\leq 1000$。  \n- Subtask $2$（$7$ points）：$L \\leq 10$。  \n- Subtask $3$（$10$ points）：$L \\leq 13$。  \n- Subtask $4$（$53$ points）：$Q \\leq 5000$。  \n- Subtask $5$（$25$ points）：没有额外的限制。  \n\n#### 样例说明  \n**对于样例 $1$**：$L=3$，共 $2^3=8$条毒蛇，它们中的每一条都分为 $3$ 个部分。 投诉时间为 $5$ 天。  \n- 第一天，可能逃出实验室的毒蛇只有毒蛇 $0$。毒性总和为 $1$。  \n- 第二天，可能从实验室逃逸的毒蛇是毒蛇 $0,1,2,3$。毒性总和为 $10$。  \n- 第三天，可能从实验室逃逸的毒蛇是毒蛇  $4,6$。毒性总和为 $12$。  \n- 第四天，可能从实验室逃逸的毒蛇是毒蛇 $3,7$。毒性总和是 $12$。  \n- 第五天，可能从实验室逃逸的毒蛇是毒蛇 $0,1,2,3,4,5,6,7$。毒性总和为 $36$。  \n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T5：Snake Escaping](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t5-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2018 Final] 毒蛇越狱 / Snake Escaping", "background": "**请注意本题特殊的内存限制。**", "description": "JOI 实验室有 $2^L$ 条毒蛇。蛇的编号为  $0,1,\\cdots,2^L−1$。每条蛇从头到尾分为  $L$ 个部分。每个部分的颜色是蓝色或红色。 对于毒蛇 $i$，令 $i = \\sum_{k=1}^{L} c_k2^{L-k}$（$0 \\leq c_k \\leq 1$）为 $i$ 的二进制表达式。那么，  \n- 如果 $c_k=0$，毒蛇 $i$ 从头开始的第 $k$ 部分的颜色是蓝色，  \n- 如果 $c_k=1$，毒蛇 $i$ 从头开始的第 $k$ 部分的颜色是红色。  \n\n每条毒蛇都有一个 $0$ 到 $9$ 之间的整数，包括 $0$ 和 $9$，为毒性。给出一个由 $\\texttt{0,1,2,3,4,5,6,7,8,9}$ 组成的长度为  $2^L$ 的字符串 $S$。第 $i$ 个字符（$1 \\leq i \\leq 2^L$）是毒蛇 $i−1$ 的毒性。由于毒蛇行动迅速，所以经常从 JOI 实验室逃走。住在实验室附近的人向 JOI 实验室投诉，他们看到毒蛇从实验室逃逸。您将收到 $Q$ 天的投诉清单。 第 $d$ 天的投诉（$1 \\leq d \\leq Q$）是一个长度为 $L$ 的字符串 $T_d$，由 $\\texttt{0,1,?}$ 组成。  \n- 如果 $T_d$ 的第 $j$ 个字符（$1 \\leq j ≤ L$）为 $\\texttt{0}$，这意味着第 $d$ 天从实验室逃出的每条毒蛇的第 $j$ 个部分是蓝色的，  \n- 如果 $T_d$ 的第 $j$ 个字符（$1 \\leq j \\leq L$）为 $\\texttt{1}$，这意味着第 $d$ 天从实验室逃出的每条毒蛇的第 $j$ 部分是红色的，并且  \n- 如果 $T_d$ 的第 $j$ 个字符（$1 \\leq j \\leq L$）为 $\\texttt{?}$，这意味着人们没有提供关于第 $d$ 天从实验室逃逸的毒蛇的第 $j$ 部分的信息。  \n\n所有的投诉都是准确的信息。所有从实验室逃逸的毒蛇都在同一天被 JOI 实验室的工作人员收留。可能发生同一条蛇在不同的日子逃脱。  \nJOI 实验室执行主任 K 教授为了估计毒蛇逃逸的风险，想知道可能逃出实验室的毒蛇的毒性总和。 你的任务是编写一个程序，根据 $Q$ 天的投诉列表，计算每天可能从实验室逃逸的蛇的毒性总和。  \n现给定描述毒蛇毒性的字符串 $S$ 和 $Q$ 天的投诉列表，请编写一个程序来计算每天可能从实验室逃逸的蛇的毒性总和。  \n", "inputFormat": "第一行包含两个空格分隔的整数 $L$，$Q$，分别是每条毒蛇的部位数和投诉天数。第二行包含长度为 $2^L$ 的字符串 $S$，描述了毒蛇的毒性。后面 $Q$ 行的第 $d$ 行包含一个长度为 $L$ 的字符串 $T_d$，为第 $d$ 天的投诉。", "outputFormat": "共 $Q$ 行，第 $d$ 行应包含一个整数，即第 $d$ 天可能从实验室逃逸的蛇的毒性总和。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq L \\leq 20$，$1 \\leq Q \\leq 10^6$，$S$ 是长度为 $2^L$ 的字符串，字符串 $S$ 由 $\\texttt{0,1,2,3,4,5,6,7,8,9}$ 组成，$T_d$ 是长度为 $L$（$1 \\leq d \\leq Q$）的字符串，字符串 $T_d$ 由 $\\texttt{0,1,?}$（$1 \\leq d \\leq Q$）组成。  \n- Subtask $1$（$5$ points）：$L \\leq 10$，$Q \\leq 1000$。  \n- Subtask $2$（$7$ points）：$L \\leq 10$。  \n- Subtask $3$（$10$ points）：$L \\leq 13$。  \n- Subtask $4$（$53$ points）：$Q \\leq 5000$。  \n- Subtask $5$（$25$ points）：没有额外的限制。  \n\n#### 样例说明  \n**对于样例 $1$**：$L=3$，共 $2^3=8$条毒蛇，它们中的每一条都分为 $3$ 个部分。 投诉时间为 $5$ 天。  \n- 第一天，可能逃出实验室的毒蛇只有毒蛇 $0$。毒性总和为 $1$。  \n- 第二天，可能从实验室逃逸的毒蛇是毒蛇 $0,1,2,3$。毒性总和为 $10$。  \n- 第三天，可能从实验室逃逸的毒蛇是毒蛇  $4,6$。毒性总和为 $12$。  \n- 第四天，可能从实验室逃逸的毒蛇是毒蛇 $3,7$。毒性总和是 $12$。  \n- 第五天，可能从实验室逃逸的毒蛇是毒蛇 $0,1,2,3,4,5,6,7$。毒性总和为 $36$。  \n#### 题目说明：  \n来源于 The 17th Japanese Olympiad in Informatics (JOI 2017/2018) Final Round 的 [T5：Snake Escaping](https://www.ioi-jp.org/joi/2017/2018-ho/2018-ho-t5-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7671", "type": "P", "difficulty": 7, "samples": [["5 6\n1 2\n2 3\n3 4\n4 5\n1 2 3 4 5\n1 1 5 2\n3 0\n1 1 3 2\n1 3 4 2\n3 2\n2 1 5", "73"], ["5 4\n1 2\n1 3\n2 4\n3 5\n1 1 1 2 2\n1 1 4 2\n2 1 4\n3 12\n2 13 8", "12\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2016", "各省省选", "广东", "树链剖分", "可持久化线段树"], "title": "[GDOI2016] 疯狂动物城", "background": "原题空间限制 512MB。\n\n---\n\nNick 是只在动物城以坑蒙拐骗为生的狐狸，儿时受到偏见的伤害，放弃了自己的理想。他被兔子 Judy 设下圈套，被迫与她合作查案，而卷入意想不到的阴谋，历尽艰险后成为搭档。他们识破了绵羊副市长 Bellwether 的计划，发现是 Bellwether 陷害食肉动物，用毒药让食肉动物发狂。Bellwether 被抓到了监狱里面， Nick 和 Judy 过上了一段平静的日子。\n\n然而，故事并没有这样结束，之前在车管所帮他们查车牌号的憨厚的树懒 Flash，才是陷害食肉动物事件的幕后主使。Flash 批量制作了大量让食肉动物发狂的药剂，投放到了食肉动物群中。现在，大量的食肉动物被感染，动物城陷入了一片混乱。警察局的牛局长 Bogo 找到了 Nick，希望他能帮忙。幸运的是，动物城联邦安全局非常有先见之明，他们在每个州都秘密放置了一台机器，机器能生产能量石，这些能量石能让食肉动物恢复正常。现在 Nick 和 Judy 需要去启动这些机器。", "description": "**提示：我们在文末提供了一份形式化题意。**\n\n动物城是一个有 $N$ 个州的联邦，该联邦是一个树的形状，即 $N$ 个州共有 $N-1$ 条双向道路连接它们，且 $N$ 个州是相互连通的。$N$ 个州的编号依次为 $1,2,3,\\dots,N$。每个州都有且仅有一台机器。一台机器启动后的下一个时刻，就会开始生产能量石，每个单位时间生产一个。能量石从被生产的时刻开始即生效，每一个单位时间能救一定数量的食肉动物。每个州的解毒机器制造出的能量石的品种可能是不同，第 $i$ 个州的机器生产的能量石每个单位时间能救 $a_i$ 只食肉动物。\n   \n   Nick 和 Judy 剩下的时间不多了，他们决定分工合作。 Nick 从 $X$ 州出发，目的地为 $Y$ 州，路径为 $X$ 到 $Y$ 的最短路径。 Nick 从 $X$ 州出发的时刻为 $0$，每隔一个单位时间移动一个州。每到一个州，Nick 就会启动这个州的机器。 Nick 想知道他从 $X$ 州出发到达 $Y$ 州的这段时间里，一共有多少食肉动物被拯救。Nick 在纠结他的路线选择，因此，他会给你若干的询问，希望比他更聪明的你能帮助他。\n\n   在他给你询问的过程中，动物城的局势也在发生着一些变化。动物城联邦安全局可以执行一个修改操作 $X,Y,\\Delta$，会对 $X$ 州到 $Y$ 州的最短路径上的州（包括 $X,Y$ 州）的机器进行升级，这样，这些机器生产出来的能量石，每个单位时间能救的食肉动物的数量会增加 $\\Delta$。\n   \n   树懒 Flash 当然也不会坐以待毙，他有一台监控仪，会监控每个州的机器的情况，每当有机器被升级，监控仪就会保存下当前所有州的机器的属性 $a_i$。Flash 可以用一种神秘的武器执行一个读取操作 $X$，把当前各个州的机器恢复到第 $X$ 次保存的状态（$X=0$ 表示未进行过升级时的初始状态）。注意，只有修改操作执行的时后会进行保存。\n\n   现在，依次给出 $M$ 个操作，若该操作为一个询问，请你输出 Nick 在当前局面下，他从 $X$ 州出发到达 $Y$ 州的这段时间里，一共有多少食肉动物被拯救，由于这个答案可能很大，你只需要输出答案模 $20160501$ 后的值。请注意，$M$ 个操作都是被加密过的。\n   \n****\n\n**形式化题意**：\n\n给你一棵 $N$ 个点的树，接下来有三种操作共 $M$ 次：\n\n- `1 x y w`，表示将 $x$ 到 $y$ 的路径上的所有点的点权加上 $w$。\n- `2 x y`，表示一次询问。记 $x$ 到 $y$ 的路径上的点集为 $S(x,y)$，点 $p,q$ 之间的路径长度为 $\\text{dis}(p,q)$，求出 $\\sum_{i\\in S(x,y)}\\sum_{j\\le \\text{dis}(i,y)}a_i\\cdot j$ 的值。将答案对 $20160501$ 取模。\n- `3 x`，表示将这棵树的所有点权恢复到第 $x$ 次 `1` 操作之后的状态。\n\n强制在线。", "inputFormat": "第一行 $2$ 个整数 $N,M$ 表示节点个数和操作次数。\n\n接下来 $N-1$ 每行 $2$ 个整数 $u,v$ 表示了这棵树中 $u$ 和 $v$ 这 $2$ 个州间有边相连。\n\n接下来一行 $N$ 个整数, 表示这 $N$ 个州的机器制造的能量 $a_i$ 的初始值。\n\n接下来 $M$ 行每行先有一个数字表示了操作的类型：\n\n- 类型 1，代表一个修改操作，接下来有 $3$ 个整数 $X',Y',\\Delta$。\n- 类型 2，代表一个询问操作，接下来有 $2$ 个整数 $X',Y'$。\n- 类型 3，代表一次读取操作，接下来 $1$ 个整数 $X'$。\n   \n其中 $X',Y'$ 表示加密后的数字。正确的 $X=X' \\text{xor lastans} ,Y=Y' \\text{xor lastans}$。其中 $\\text{lastans}$ 为上次 `2` 操作取模后的答案，如果之前没有 `2` 操作过那么其值等于 $0$。", "outputFormat": " 对于每个操作 `2`，输出一行，每行一个数，为所询问的答案模 $20160501$ 后的值。", "hint": "对于所有数据，保证 $1\\le n,m\\le 10^5$，$1\\le a_i,\\Delta\\le 10^5$，$1\\le x,y\\le n$。\n\n对于其中 $20\\%$ 的数据，保证 $n,m\\le 2000$。\n\n对于另外 $20\\%$ 的数据，保证树为一条链，且不含有操作 `3`。\n\n对于另外 $40\\%$ 的数据，保证树为一条链。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GDOI2016] 疯狂动物城", "background": "原题空间限制 512MB。\n\n---\n\nNick 是只在动物城以坑蒙拐骗为生的狐狸，儿时受到偏见的伤害，放弃了自己的理想。他被兔子 Judy 设下圈套，被迫与她合作查案，而卷入意想不到的阴谋，历尽艰险后成为搭档。他们识破了绵羊副市长 Bellwether 的计划，发现是 Bellwether 陷害食肉动物，用毒药让食肉动物发狂。Bellwether 被抓到了监狱里面， Nick 和 Judy 过上了一段平静的日子。\n\n然而，故事并没有这样结束，之前在车管所帮他们查车牌号的憨厚的树懒 Flash，才是陷害食肉动物事件的幕后主使。Flash 批量制作了大量让食肉动物发狂的药剂，投放到了食肉动物群中。现在，大量的食肉动物被感染，动物城陷入了一片混乱。警察局的牛局长 Bogo 找到了 Nick，希望他能帮忙。幸运的是，动物城联邦安全局非常有先见之明，他们在每个州都秘密放置了一台机器，机器能生产能量石，这些能量石能让食肉动物恢复正常。现在 Nick 和 Judy 需要去启动这些机器。", "description": "**提示：我们在文末提供了一份形式化题意。**\n\n动物城是一个有 $N$ 个州的联邦，该联邦是一个树的形状，即 $N$ 个州共有 $N-1$ 条双向道路连接它们，且 $N$ 个州是相互连通的。$N$ 个州的编号依次为 $1,2,3,\\dots,N$。每个州都有且仅有一台机器。一台机器启动后的下一个时刻，就会开始生产能量石，每个单位时间生产一个。能量石从被生产的时刻开始即生效，每一个单位时间能救一定数量的食肉动物。每个州的解毒机器制造出的能量石的品种可能是不同，第 $i$ 个州的机器生产的能量石每个单位时间能救 $a_i$ 只食肉动物。\n   \n   Nick 和 Judy 剩下的时间不多了，他们决定分工合作。 Nick 从 $X$ 州出发，目的地为 $Y$ 州，路径为 $X$ 到 $Y$ 的最短路径。 Nick 从 $X$ 州出发的时刻为 $0$，每隔一个单位时间移动一个州。每到一个州，Nick 就会启动这个州的机器。 Nick 想知道他从 $X$ 州出发到达 $Y$ 州的这段时间里，一共有多少食肉动物被拯救。Nick 在纠结他的路线选择，因此，他会给你若干的询问，希望比他更聪明的你能帮助他。\n\n   在他给你询问的过程中，动物城的局势也在发生着一些变化。动物城联邦安全局可以执行一个修改操作 $X,Y,\\Delta$，会对 $X$ 州到 $Y$ 州的最短路径上的州（包括 $X,Y$ 州）的机器进行升级，这样，这些机器生产出来的能量石，每个单位时间能救的食肉动物的数量会增加 $\\Delta$。\n   \n   树懒 Flash 当然也不会坐以待毙，他有一台监控仪，会监控每个州的机器的情况，每当有机器被升级，监控仪就会保存下当前所有州的机器的属性 $a_i$。Flash 可以用一种神秘的武器执行一个读取操作 $X$，把当前各个州的机器恢复到第 $X$ 次保存的状态（$X=0$ 表示未进行过升级时的初始状态）。注意，只有修改操作执行的时后会进行保存。\n\n   现在，依次给出 $M$ 个操作，若该操作为一个询问，请你输出 Nick 在当前局面下，他从 $X$ 州出发到达 $Y$ 州的这段时间里，一共有多少食肉动物被拯救，由于这个答案可能很大，你只需要输出答案模 $20160501$ 后的值。请注意，$M$ 个操作都是被加密过的。\n   \n****\n\n**形式化题意**：\n\n给你一棵 $N$ 个点的树，接下来有三种操作共 $M$ 次：\n\n- `1 x y w`，表示将 $x$ 到 $y$ 的路径上的所有点的点权加上 $w$。\n- `2 x y`，表示一次询问。记 $x$ 到 $y$ 的路径上的点集为 $S(x,y)$，点 $p,q$ 之间的路径长度为 $\\text{dis}(p,q)$，求出 $\\sum_{i\\in S(x,y)}\\sum_{j\\le \\text{dis}(i,y)}a_i\\cdot j$ 的值。将答案对 $20160501$ 取模。\n- `3 x`，表示将这棵树的所有点权恢复到第 $x$ 次 `1` 操作之后的状态。\n\n强制在线。", "inputFormat": "第一行 $2$ 个整数 $N,M$ 表示节点个数和操作次数。\n\n接下来 $N-1$ 每行 $2$ 个整数 $u,v$ 表示了这棵树中 $u$ 和 $v$ 这 $2$ 个州间有边相连。\n\n接下来一行 $N$ 个整数, 表示这 $N$ 个州的机器制造的能量 $a_i$ 的初始值。\n\n接下来 $M$ 行每行先有一个数字表示了操作的类型：\n\n- 类型 1，代表一个修改操作，接下来有 $3$ 个整数 $X',Y',\\Delta$。\n- 类型 2，代表一个询问操作，接下来有 $2$ 个整数 $X',Y'$。\n- 类型 3，代表一次读取操作，接下来 $1$ 个整数 $X'$。\n   \n其中 $X',Y'$ 表示加密后的数字。正确的 $X=X' \\text{xor lastans} ,Y=Y' \\text{xor lastans}$。其中 $\\text{lastans}$ 为上次 `2` 操作取模后的答案，如果之前没有 `2` 操作过那么其值等于 $0$。", "outputFormat": " 对于每个操作 `2`，输出一行，每行一个数，为所询问的答案模 $20160501$ 后的值。", "hint": "对于所有数据，保证 $1\\le n,m\\le 10^5$，$1\\le a_i,\\Delta\\le 10^5$，$1\\le x,y\\le n$。\n\n对于其中 $20\\%$ 的数据，保证 $n,m\\le 2000$。\n\n对于另外 $20\\%$ 的数据，保证树为一条链，且不含有操作 `3`。\n\n对于另外 $40\\%$ 的数据，保证树为一条链。\n", "locale": "zh-CN"}}}
{"pid": "P7672", "type": "P", "difficulty": 2, "samples": [["4\nlas\ngod\npsala\nsal ", "3 a"], ["4\nkisik\nptq\ntttrp\ntulipan", "5 s"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #5] LOZINKA", "background": "", "description": "给出一些长度为奇数的字符串，请你找出一个字符串，且它反转后的字符串也在给出的字符串中。\n\n例如：字符串 `abcca`，如果满足条件，则字符串 `accba` 也必须出现在输入的字符串中。\n\n输出这个字符串的长度和它处于最中间的字符。", "inputFormat": "输入共 $n+1$ 行：\n\n第 $1$ 行，一个整数 $n$，表示给出的字符串的个数；\n\n第 $2$ 至 $n+1$ 行，每行一个字符串。 ", "outputFormat": "输出共 $1$ 行，一个整数和一个字符，用空格隔开，分别表示符合要求的字符串的长度和它处于字符串中间的字符。", "hint": "**【样例解释 #1】**\n\n`las` 和 `sal` 是符合要求的字符串对，长度为 $3$，中间的字符为 `a`。\n\n**【样例解释 #2】**\n\n`kisik` 是回文串，翻转后的字符串仍是 `kisik`，满足要求。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le n\\le 100$，$3\\le $ 字符串长度 $\\le 13$，所有字符串均由小写字母组成，保证答案是唯一的。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T1 LOZINKA**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #5] LOZINKA", "background": "", "description": "给出一些长度为奇数的字符串，请你找出一个字符串，且它反转后的字符串也在给出的字符串中。\n\n例如：字符串 `abcca`，如果满足条件，则字符串 `accba` 也必须出现在输入的字符串中。\n\n输出这个字符串的长度和它处于最中间的字符。", "inputFormat": "输入共 $n+1$ 行：\n\n第 $1$ 行，一个整数 $n$，表示给出的字符串的个数；\n\n第 $2$ 至 $n+1$ 行，每行一个字符串。 ", "outputFormat": "输出共 $1$ 行，一个整数和一个字符，用空格隔开，分别表示符合要求的字符串的长度和它处于字符串中间的字符。", "hint": "**【样例解释 #1】**\n\n`las` 和 `sal` 是符合要求的字符串对，长度为 $3$，中间的字符为 `a`。\n\n**【样例解释 #2】**\n\n`kisik` 是回文串，翻转后的字符串仍是 `kisik`，满足要求。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le n\\le 100$，$3\\le $ 字符串长度 $\\le 13$，所有字符串均由小写字母组成，保证答案是唯一的。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T1 LOZINKA**_", "locale": "zh-CN"}}}
{"pid": "P7673", "type": "P", "difficulty": 3, "samples": [["2\n2 1 3 ", "1\n2 3 "], ["3\n1 6 4 3 5 2 7", "3\n6 2\n1 4 5 7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #5] OBILAZAK", "background": "", "description": "给出一棵有 $2^K-1$ 个节点的完全二叉树，遍历这棵树的规律如下：\n\n- 起点是二叉树第一层的唯一一个节点。\n\n- 如果当前节点的左孩子还没有记录到，那么就记录左孩子的编号并移动到左孩子处。\n\n- 如果当前节点没有左孩子或者左孩子已经记录过，就记录当前节点的编号。\n\n- 如果当前节点已经记录过，那么就记录右孩子的编号并移动到右孩子处。\n\n- 如果当前节点及此节点的左右孩子都已经记录过，那么就移动到当前节点的父节点处。\n\n现在给出从第一层的节点出发记录下的编号顺序，请你求出原本的完全二叉树。", "inputFormat": "第一行，一个整数 $K$，表示这个完全二叉树有 $2^K-1$ 个节点；\n\n第二行，$2^K-1$ 个整数，表示从第一层的节点出发记录下的编号顺序。", "outputFormat": "输出共 $K$ 行，为原本的完全二叉树。", "hint": "**【样例解释 #1】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wk4ai6vq.png)\n\n先移动到节点 $1$，发现左孩子没有记录，移动到节点 $2$ 并记录节点 $2$；发现节点 $2$ 没有孩子，返回节点 $1$ ，发现此节点没有记录，记录节点 $1$；发现右孩子没有记录，移动到节点 $3$ 并记录节点 $3$。\n\n**【样例解释 #2】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e8txnko0.png)\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le K\\le 10$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T2 OBILAZAK**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #5] OBILAZAK", "background": "", "description": "给出一棵有 $2^K-1$ 个节点的完全二叉树，遍历这棵树的规律如下：\n\n- 起点是二叉树第一层的唯一一个节点。\n\n- 如果当前节点的左孩子还没有记录到，那么就记录左孩子的编号并移动到左孩子处。\n\n- 如果当前节点没有左孩子或者左孩子已经记录过，就记录当前节点的编号。\n\n- 如果当前节点已经记录过，那么就记录右孩子的编号并移动到右孩子处。\n\n- 如果当前节点及此节点的左右孩子都已经记录过，那么就移动到当前节点的父节点处。\n\n现在给出从第一层的节点出发记录下的编号顺序，请你求出原本的完全二叉树。", "inputFormat": "第一行，一个整数 $K$，表示这个完全二叉树有 $2^K-1$ 个节点；\n\n第二行，$2^K-1$ 个整数，表示从第一层的节点出发记录下的编号顺序。", "outputFormat": "输出共 $K$ 行，为原本的完全二叉树。", "hint": "**【样例解释 #1】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wk4ai6vq.png)\n\n先移动到节点 $1$，发现左孩子没有记录，移动到节点 $2$ 并记录节点 $2$；发现节点 $2$ 没有孩子，返回节点 $1$ ，发现此节点没有记录，记录节点 $1$；发现右孩子没有记录，移动到节点 $3$ 并记录节点 $3$。\n\n**【样例解释 #2】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e8txnko0.png)\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le K\\le 10$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T2 OBILAZAK**_", "locale": "zh-CN"}}}
{"pid": "P7674", "type": "P", "difficulty": 3, "samples": [["mirkovC4nizCC44\nC4 ", "mirkovniz"], ["12ab112ab2ab\n12ab", "FRULA"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #5]  EKSPLOZIJA", "background": "", "description": "给出一个字符串和一个目标字符串，在给出的字符串中找到所有的目标字符串并删除。\n\n将剩下的小字符串按照原来的顺序拼接，再继续在剩下的字符串中持续这种操作，直到没有更多的目标字符串出现为止。\n\n请打印出剩下的字符串。如果没有剩下的字符串，输出 `FRULA`。", "inputFormat": "第一行，一个字符串，表示原字符串；\n\n第二行，一个字符串，表示目标字符串。", "outputFormat": "一行，一个字符串，表示剩下的字符串。", "hint": "**【样例解释 #1】**\n\n第一次删除，原字符串变为 `mirkov**nizC**4` （`*` 表示被删除的字符），即 `mirkovnizC4`。\n\n第二次删除，字符串变为 `mirkovniz**`，即 `mirkovniz`。\n\n**【样例解释 #2】**\n\n第一次删除，原字符串变为 `****1****2ab` （`*` 表示被删除的字符），即 `12ab`。\n\n第二次删除，字符串变为 `****`。故输出 `FRULA`。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，$1\\le $ 原字符串长度 $\\le 3000$；\n\n对于 $100\\%$ 的数据，$1\\le $ 原字符串长度 $\\le 10^6$，$1\\le $ 目标字符串长度 $\\le 36$，所有字符串均由大写字母、小写字母和数字 $0,1...9$ 组成，保证目标字符串中没有重复的字符。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T3 EKSPLOZIJA**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #5]  EKSPLOZIJA", "background": "", "description": "给出一个字符串和一个目标字符串，在给出的字符串中找到所有的目标字符串并删除。\n\n将剩下的小字符串按照原来的顺序拼接，再继续在剩下的字符串中持续这种操作，直到没有更多的目标字符串出现为止。\n\n请打印出剩下的字符串。如果没有剩下的字符串，输出 `FRULA`。", "inputFormat": "第一行，一个字符串，表示原字符串；\n\n第二行，一个字符串，表示目标字符串。", "outputFormat": "一行，一个字符串，表示剩下的字符串。", "hint": "**【样例解释 #1】**\n\n第一次删除，原字符串变为 `mirkov**nizC**4` （`*` 表示被删除的字符），即 `mirkovnizC4`。\n\n第二次删除，字符串变为 `mirkovniz**`，即 `mirkovniz`。\n\n**【样例解释 #2】**\n\n第一次删除，原字符串变为 `****1****2ab` （`*` 表示被删除的字符），即 `12ab`。\n\n第二次删除，字符串变为 `****`。故输出 `FRULA`。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，$1\\le $ 原字符串长度 $\\le 3000$；\n\n对于 $100\\%$ 的数据，$1\\le $ 原字符串长度 $\\le 10^6$，$1\\le $ 目标字符串长度 $\\le 36$，所有字符串均由大写字母、小写字母和数字 $0,1...9$ 组成，保证目标字符串中没有重复的字符。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T3 EKSPLOZIJA**_", "locale": "zh-CN"}}}
{"pid": "P7675", "type": "P", "difficulty": 4, "samples": [["5 3\n2 1 -1\n1 3 2\n0 2 3\n2 1 1\n3 3 0 ", "16 "], ["2 2\n0 4 1\n3 5 1 ", "13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #5] DOMINE", "background": "", "description": "给出一个 $N\\times 3$ 的棋盘，上面写有数字。给你 $K$ 块 $1\\times 2$ 的多米诺骨牌，请你求出用这 $K$ 块骨牌能覆盖的棋盘上的数字之和的最大值。", "inputFormat": "第一行，两个整数 $N$ 和 $K$，分别表示棋盘的行数和骨牌块数；\n\n接下来 $N$ 行，每行 $3$ 个整数，表示棋盘上的数字。", "outputFormat": "输出一个整数，表示这 $K$ 块骨牌能覆盖的棋盘上的数字之和的最大值。", "hint": "**【样例解释 #1】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r38fixsz.png)\n\n如图，总和为 $3+2+2+3+3+3=16$，可以证明这是最大的。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N,K\\le 1000$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T4  DOMINE**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #5] DOMINE", "background": "", "description": "给出一个 $N\\times 3$ 的棋盘，上面写有数字。给你 $K$ 块 $1\\times 2$ 的多米诺骨牌，请你求出用这 $K$ 块骨牌能覆盖的棋盘上的数字之和的最大值。", "inputFormat": "第一行，两个整数 $N$ 和 $K$，分别表示棋盘的行数和骨牌块数；\n\n接下来 $N$ 行，每行 $3$ 个整数，表示棋盘上的数字。", "outputFormat": "输出一个整数，表示这 $K$ 块骨牌能覆盖的棋盘上的数字之和的最大值。", "hint": "**【样例解释 #1】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r38fixsz.png)\n\n如图，总和为 $3+2+2+3+3+3=16$，可以证明这是最大的。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N,K\\le 1000$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T4  DOMINE**_", "locale": "zh-CN"}}}
{"pid": "P7676", "type": "P", "difficulty": 4, "samples": [["6\n0 1 0\n-5 3 0\n-5 -2 25\n0 1 -3\n0 1 -2\n-4 -5 29 ", "10"], ["5\n-5 3 0\n-5 -3 -30\n0 1 0\n3 7 35\n1 -2 -1 ", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #5] TROKUTI", "background": "", "description": "给定 $N$ 条在平面直角坐标系内的直线，这些直线上的点满足 $A_ix+B_iy+C_i=0$。\n\n请你求出这些直线围出的三角形个数，答案对 $10^9+7$ 取模。\n\n保证没有三线共点。", "inputFormat": "第一行，一个整数 $N$，表示直线条数；\n\n接下来 $N$ 行，每行 $3$ 个 $A_i,B_i,C_i$，表示直线 $i$ 满足的条件。", "outputFormat": "一个整数，表示这些直线围出的三角形对 $10^9+7$ 取模后的个数。", "hint": "**【样例解释 #1】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rrp71ksq.png)\n\n上图即为所有直线在平面直角坐标系上的位置，共围出了 $10$ 个三角形。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 3\\times 10^5$，$|A_i|,|B_i|,|C_i|\\le 10^9$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T5 TROKUTI*_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #5] TROKUTI", "background": "", "description": "给定 $N$ 条在平面直角坐标系内的直线，这些直线上的点满足 $A_ix+B_iy+C_i=0$。\n\n请你求出这些直线围出的三角形个数，答案对 $10^9+7$ 取模。\n\n保证没有三线共点。", "inputFormat": "第一行，一个整数 $N$，表示直线条数；\n\n接下来 $N$ 行，每行 $3$ 个 $A_i,B_i,C_i$，表示直线 $i$ 满足的条件。", "outputFormat": "一个整数，表示这些直线围出的三角形对 $10^9+7$ 取模后的个数。", "hint": "**【样例解释 #1】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rrp71ksq.png)\n\n上图即为所有直线在平面直角坐标系上的位置，共围出了 $10$ 个三角形。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 3\\times 10^5$，$|A_i|,|B_i|,|C_i|\\le 10^9$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T5 TROKUTI*_", "locale": "zh-CN"}}}
{"pid": "P7677", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2\n1 3\n1 2\n1 3\n1 2 ", "LADICA\nLADICA\nLADICA\nSMECE\nSMECE "], ["9 10\n1 2\n3 4\n5 6\n7 8\n9 10\n2 3\n1 5\n8 2\n7 9 ", "LADICA\nLADICA\nLADICA\nLADICA\nLADICA\nLADICA\nLADICA\nLADICA\nLADICA"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #5] LADICE", "background": null, "description": "有 $N$ 个物品，$L$ 个抽屉，每个抽屉只能放 $1$ 个物品，每个物品都能被放进抽屉 $A_i$ 或 $B_i$ 中。\n\n放物品的规则如下（按照顺序执行，即满足条件 $1$ 时就立刻执行，不会执行条件 $2$；不满足条件 $1$ 时就判断条件 $2$）：\n\n- $1.$ 如果抽屉 $A_i$ 是空的，就把这个物品放进抽屉 $A_i$ 中；\n\n- $2$ 如果抽屉 $B_i$ 是空的，就把这个物品放进抽屉 $B_i$ 中；\n\n- $3.$ 把抽屉 $A_i$ 中的物品移到它的另一个抽屉里；如果这个抽屉也满了，就把这个抽屉里的物品放到它的另一个抽屉里，直到你成功或回到之前遇到过的抽屉为止。如果成功了，就把这个物品放进这个抽屉中；\n\n- $4.$ 把抽屉 $B_i$ 中的物品移到它的另一个抽屉里；如果这个抽屉也满了，就把这个抽屉里的物品放到它的另一个抽屉里，直到你成功或回到之前遇到过的抽屉为止。如果成功了，就把这个物品放进这个抽屉中；\n\n- $5.$ 扔掉此物品。\n\n对于给定的每件物品，请你求出哪些物品将被保存，哪些将被扔掉。", "inputFormat": "第一行，两个整数 $N$ 和 $L$，分别表示物品个数和抽屉个数；\n\n接下来的 $N$ 行，每行两个整数 $A_i$ 和 $B_i$，表示物品 $i$ 能被储存的两个抽屉。", "outputFormat": "输出共 $N$ 行，每行一个字符串：\n\n如果该物品成功被保存，输出 `LADICA`；\n\n如果该物品被扔掉，输出 `SMECE`。", "hint": "**【样例解释 #1】**\n\n物品 $1$ 放入抽屉 $1$，物品 $2$ 放入抽屉 $3$，物品 $3$ 放入抽屉 $2$，物品 $4$ 和物品 $5$ 没有地方放。\n\n**【样例解释 #2】**\n\n物品 $1$ 放入抽屉 $1$，物品 $2$ 放入抽屉 $3$，物品 $3$ 放入抽屉 $5$，物品 $4$ 放入抽屉 $7$，物品 $5$ 放入抽屉 $9$，物品 $6$ 放入抽屉 $2$，物品 $8$ 放入抽屉 $8$。\n\n物品 $7$ 的两个抽屉都满了，将抽屉 $1$ 里的物品 $1$ 移到抽屉 $2$ 里，将抽屉 $2$ 里的物品 $6$ 移到抽屉 $3$ 里，将抽屉 $3$ 里的物品 $2$ 移到抽屉 $4$ 里，抽屉 $4$ 是空的，成功放入。\n\n物品 $9$ 的两个抽屉都满了，将抽屉 $7$ 里的物品 $4$ 移到抽屉 $8$ 里，将抽屉 $8$ 里的物品 $8$ 移到抽屉 $2$ 里，将抽屉 $2$ 里的物品 $1$ 移到抽屉 $1$ 里，将抽屉 $1$ 里的物品 $7$ 移到抽屉 $5$ 里，将抽屉 $5$ 里的物品 $3$ 移到抽屉 $6$ 里，抽屉 $6$ 是空的，成功放入。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，$1\\le N,L\\le 2000$；\n\n对于 $100\\%$ 的数据，$1\\le N,L\\le 3\\times 10^5$，$1\\le A_i,B_i\\le L$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T6  LADICE**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #5] LADICE", "background": null, "description": "有 $N$ 个物品，$L$ 个抽屉，每个抽屉只能放 $1$ 个物品，每个物品都能被放进抽屉 $A_i$ 或 $B_i$ 中。\n\n放物品的规则如下（按照顺序执行，即满足条件 $1$ 时就立刻执行，不会执行条件 $2$；不满足条件 $1$ 时就判断条件 $2$）：\n\n- $1.$ 如果抽屉 $A_i$ 是空的，就把这个物品放进抽屉 $A_i$ 中；\n\n- $2$ 如果抽屉 $B_i$ 是空的，就把这个物品放进抽屉 $B_i$ 中；\n\n- $3.$ 把抽屉 $A_i$ 中的物品移到它的另一个抽屉里；如果这个抽屉也满了，就把这个抽屉里的物品放到它的另一个抽屉里，直到你成功或回到之前遇到过的抽屉为止。如果成功了，就把这个物品放进这个抽屉中；\n\n- $4.$ 把抽屉 $B_i$ 中的物品移到它的另一个抽屉里；如果这个抽屉也满了，就把这个抽屉里的物品放到它的另一个抽屉里，直到你成功或回到之前遇到过的抽屉为止。如果成功了，就把这个物品放进这个抽屉中；\n\n- $5.$ 扔掉此物品。\n\n对于给定的每件物品，请你求出哪些物品将被保存，哪些将被扔掉。", "inputFormat": "第一行，两个整数 $N$ 和 $L$，分别表示物品个数和抽屉个数；\n\n接下来的 $N$ 行，每行两个整数 $A_i$ 和 $B_i$，表示物品 $i$ 能被储存的两个抽屉。", "outputFormat": "输出共 $N$ 行，每行一个字符串：\n\n如果该物品成功被保存，输出 `LADICA`；\n\n如果该物品被扔掉，输出 `SMECE`。", "hint": "**【样例解释 #1】**\n\n物品 $1$ 放入抽屉 $1$，物品 $2$ 放入抽屉 $3$，物品 $3$ 放入抽屉 $2$，物品 $4$ 和物品 $5$ 没有地方放。\n\n**【样例解释 #2】**\n\n物品 $1$ 放入抽屉 $1$，物品 $2$ 放入抽屉 $3$，物品 $3$ 放入抽屉 $5$，物品 $4$ 放入抽屉 $7$，物品 $5$ 放入抽屉 $9$，物品 $6$ 放入抽屉 $2$，物品 $8$ 放入抽屉 $8$。\n\n物品 $7$ 的两个抽屉都满了，将抽屉 $1$ 里的物品 $1$ 移到抽屉 $2$ 里，将抽屉 $2$ 里的物品 $6$ 移到抽屉 $3$ 里，将抽屉 $3$ 里的物品 $2$ 移到抽屉 $4$ 里，抽屉 $4$ 是空的，成功放入。\n\n物品 $9$ 的两个抽屉都满了，将抽屉 $7$ 里的物品 $4$ 移到抽屉 $8$ 里，将抽屉 $8$ 里的物品 $8$ 移到抽屉 $2$ 里，将抽屉 $2$ 里的物品 $1$ 移到抽屉 $1$ 里，将抽屉 $1$ 里的物品 $7$ 移到抽屉 $5$ 里，将抽屉 $5$ 里的物品 $3$ 移到抽屉 $6$ 里，抽屉 $6$ 是空的，成功放入。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，$1\\le N,L\\le 2000$；\n\n对于 $100\\%$ 的数据，$1\\le N,L\\le 3\\times 10^5$，$1\\le A_i,B_i\\le L$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T6  LADICE**_", "locale": "zh-CN"}}}
{"pid": "P7678", "type": "P", "difficulty": 1, "samples": [["dz=ak", "3"], ["ljes=njak", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["2008", "COCI（克罗地亚）"], "title": "[COCI 2008/2009 #5] LJESNJAK", "background": "", "description": "不久以前，在操作系统还未像今天如此发达的时候，计算机无法处理克罗地亚字母表中的某些字母，于是程序员被允许用二到三个计算机能够显示的字符替换这个不能显示的字母，如下表：\n\n| 不能显示的字母 | 用来替换的字符 |\n| :----------: | :----------: |\n| `č` | `c=` |\n| `ć` | `c-` |\n| `dž` | `dz=` |\n| `ñ` | `d-` |\n| `lj` | `lj` |\n| `nj` | `nj` |\n| `š` | `s=` |\n| `ž` | `z=` |\n\n例如说，`ljes=njak` 这一个字符串可以用来表示克罗地亚字母表中的六个字母：`lj`、`e`、`š`、`nj`、`a`、`k`。\n\n现在给出一个字符串，请你求出解码后这一个字符串里面包含多少个克罗地亚字母表中的字母。字母的匹配是贪心的，尽可能长的匹配当前字母，例如 `lj` 不应该被认为是两个英文字母 `l` 和 `j`。\n\n克罗地亚字母表中的字母除了有上表中的几个字母外，还有英语中的 `a`~`z` 这 26 个字母。", "inputFormat": "输入仅一行，一个字符串，表示一个按上述方式编码的字符串。", "outputFormat": "输出仅一行，表示解码之后的字符串包含的克罗地亚字母表中的字母个数。", "hint": "**【数据范围】**\n\n对于所有数据，满足字符串的长度不超过 $100$，且仅包含小写字母和 `-`、`=` 字符。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T1 LJESNJAK_**，按照原题数据配置，满分 $30$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2008/2009 #5] LJESNJAK", "background": "", "description": "不久以前，在操作系统还未像今天如此发达的时候，计算机无法处理克罗地亚字母表中的某些字母，于是程序员被允许用二到三个计算机能够显示的字符替换这个不能显示的字母，如下表：\n\n| 不能显示的字母 | 用来替换的字符 |\n| :----------: | :----------: |\n| `č` | `c=` |\n| `ć` | `c-` |\n| `dž` | `dz=` |\n| `ñ` | `d-` |\n| `lj` | `lj` |\n| `nj` | `nj` |\n| `š` | `s=` |\n| `ž` | `z=` |\n\n例如说，`ljes=njak` 这一个字符串可以用来表示克罗地亚字母表中的六个字母：`lj`、`e`、`š`、`nj`、`a`、`k`。\n\n现在给出一个字符串，请你求出解码后这一个字符串里面包含多少个克罗地亚字母表中的字母。字母的匹配是贪心的，尽可能长的匹配当前字母，例如 `lj` 不应该被认为是两个英文字母 `l` 和 `j`。\n\n克罗地亚字母表中的字母除了有上表中的几个字母外，还有英语中的 `a`~`z` 这 26 个字母。", "inputFormat": "输入仅一行，一个字符串，表示一个按上述方式编码的字符串。", "outputFormat": "输出仅一行，表示解码之后的字符串包含的克罗地亚字母表中的字母个数。", "hint": "**【数据范围】**\n\n对于所有数据，满足字符串的长度不超过 $100$，且仅包含小写字母和 `-`、`=` 字符。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T1 LJESNJAK_**，按照原题数据配置，满分 $30$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7679", "type": "P", "difficulty": 2, "samples": [["4 8", "1 4 8\n2 2 4\n4 1 2"], ["15 12", "1 15 12\n3 5 4"], ["42 105", "1 42 105\n3 14 35\n7 6 15\n21 2 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2008", "COCI（克罗地亚）"], "title": "[COCI 2008/2009 #5] JABUKA", "background": "", "description": "Mirko 拥有 $R$ 个红苹果和 $G$ 个绿苹果，他想把他分给若干个朋友，使得所有朋友分得的红苹果个数和绿苹果个数都一样。由于 Mirko 自己不喜欢苹果，所以他不会给自己留苹果。\n\n例如，假设 Mirko 有 $4$ 个红苹果和 $8$ 个绿苹果，则以下是分配苹果的所有方案：\n\n- 分给一个朋友，即将 $4$ 个红苹果和 $8$ 个绿苹果全部分给这个朋友。\n- 分给两个朋友，每个朋友分得 $2$ 个红苹果和 $4$ 个绿苹果。 \n- 分给四个朋友，每个朋友分得 $1$ 个红苹果和 $2$ 个绿苹果。\n\n现给定 $R,G$，请你帮助 Mirko 找到所有的分配苹果的方案。可以证明一定存在分配苹果的方案。", "inputFormat": "输入仅一行，两个整数 $R,G$，分别表示红苹果的个数和绿苹果的个数。 ", "outputFormat": "输出若干行，每行三个整数，分别表示分给的朋友数，每个朋友分得的红苹果个数和绿苹果个数。\n\n如果有多种方案，请按照**朋友的个数升序排列**输出。\n\n数据保证不会超出输出限制。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant R,G\\leqslant 10^9$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T2 JABUKA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2008/2009 #5] JABUKA", "background": "", "description": "Mirko 拥有 $R$ 个红苹果和 $G$ 个绿苹果，他想把他分给若干个朋友，使得所有朋友分得的红苹果个数和绿苹果个数都一样。由于 Mirko 自己不喜欢苹果，所以他不会给自己留苹果。\n\n例如，假设 Mirko 有 $4$ 个红苹果和 $8$ 个绿苹果，则以下是分配苹果的所有方案：\n\n- 分给一个朋友，即将 $4$ 个红苹果和 $8$ 个绿苹果全部分给这个朋友。\n- 分给两个朋友，每个朋友分得 $2$ 个红苹果和 $4$ 个绿苹果。 \n- 分给四个朋友，每个朋友分得 $1$ 个红苹果和 $2$ 个绿苹果。\n\n现给定 $R,G$，请你帮助 Mirko 找到所有的分配苹果的方案。可以证明一定存在分配苹果的方案。", "inputFormat": "输入仅一行，两个整数 $R,G$，分别表示红苹果的个数和绿苹果的个数。 ", "outputFormat": "输出若干行，每行三个整数，分别表示分给的朋友数，每个朋友分得的红苹果个数和绿苹果个数。\n\n如果有多种方案，请按照**朋友的个数升序排列**输出。\n\n数据保证不会超出输出限制。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant R,G\\leqslant 10^9$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T2 JABUKA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7680", "type": "P", "difficulty": 2, "samples": [["11 3\n6 5\n3 1\n11 1", "4\n1\n6"], ["16 3\n2 2\n12 3\n6 11", "2\n7\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2008", "COCI（克罗地亚）"], "title": "[COCI 2008/2009 #5] JAGODA", "background": "", "description": "Slavko 养了 $n$ 只兔子，他每天用各种水果和蔬菜喂兔子。然而，兔子最喜欢草莓。草莓在隆冬时节很难找到，而且很贵，所以 Slavko 只给部分兔子吃草莓。Slavko 把兔子编号为 $1\\sim n$。为了帮助追踪每只兔子得到多少草莓，他决定采用以下草莓分配程序。\n\nSlavko 每天都会买 $S$ 个草莓，然后选一个兔子 $A$ ，然后给它第一个草莓。之后，兔子 $A+1$ 会得到第二个草莓，兔子 $A+2$ 会得到第三个，以此类推。\n\n给每只兔子分配一个最初为空的火柴盒，然后把这 $n$ 个火柴盒排成一排。设 $k$ 为使得 $k^2\\leqslant n$ 的最大整数。这样就可以把兔子分成 $\\left\\lceil\\dfrac{n}{k}\\right\\rceil$组，每组 $k$ 个火柴盒（从第一个开始，最后一组有可能不足 $k$ 个），每组火柴盒旁边也会有一个杯子。我们说 $k$ 个连续的火柴盒和它们的杯子形成一组。\n\n在给兔子草莓之后，Slavko 会把一根火柴放进每个得到草莓的兔子的火柴盒里，**除非**他把火柴放进一组里所有的火柴盒里。此时他不会把火柴放在一组的所有火柴盒里，而是把一根火柴放在这一组所在的杯子里。通过这种方式，兔子收到的草莓总数可以用火柴盒里的火柴数加上杯子里的火柴数来计算。例如，假设 Slavko 有 $11$ 只兔子，即 $n=11$。数字 $3$ 是使得 $k^2\\leqslant n$ 的最大整数 $k$，因此 $k=3$。因此这些兔子将会被分成四组（最后一组只有两只兔子和两个火柴盒），自然就会有四个杯子，如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/taccw9un.png)\n\n如果 Slavko 买了 $6$ 个草莓，把第一个送给兔子 $5$，杯子和火柴盒里的状态将变为如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2tfy24vf.png)\n\n现在，请你编写一个程序，给定兔子的数量 $n$、天数 $m$ 以及 $m$ 天中的每一天购买的草莓数量 $S$ 和得到第一个草莓的兔子编号 $A$。对于每一天，输出 Slavko 当天使用的所有火柴盒和杯子中的火柴总数。", "inputFormat": "输入共 $m+1$ 行。\n\n第一行两个整数 $n,m$，分别表示兔子的总数（也是火柴盒数）和天数。  \n随后 $m$ 行，第 $i$ 行两个整数 $S,A$，分别表示第 $i$ 天购买的草莓数量和得到第一个草莓的兔子编号。", "outputFormat": "输出共 $m$ 行，第 $i$ 行一个整数，表示 Slavko 第 $i$ 天使用的所有火柴盒和杯子中的火柴总数。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，兔子、火柴盒和杯子摆放的情况即为题面中所给出的例子。\n\n第一天即为题面中所给出的例子，因此 Slavko 第一天放入 $4$ 根火柴。\n\n第二天 Slavko 买了 $3$ 个草莓，并将第一个草莓给了 $1$ 号兔子，这样的话，$1$、$2$、$3$ 号兔子都得到草莓，由于它们三个兔子都在一组里面，所以 Slavko 只需要在第 $1$ 个杯子里面放入一根火柴。因此 Slavko 第一天放入 $1$ 根火柴。\n\n第三天，Slavko 可以给他所有的兔子送草莓，所以需要在每个杯子里放一根火柴。总共是把 $4$ 根火柴放到杯子里，他在这天使用的杯子里（就是所有杯子）在他放置后一共有 $6$ 根火柴，所以输出 $6$。\n\n**【数据范围】**\n\n对于所有数据。$1\\leqslant n,m\\leqslant 10^5$，$1\\leqslant A\\leqslant n$，$1\\leqslant A+S-1\\leqslant n$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T3 JAGODA_**，按照原题数据配置，满分 $70$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2008/2009 #5] JAGODA", "background": "", "description": "Slavko 养了 $n$ 只兔子，他每天用各种水果和蔬菜喂兔子。然而，兔子最喜欢草莓。草莓在隆冬时节很难找到，而且很贵，所以 Slavko 只给部分兔子吃草莓。Slavko 把兔子编号为 $1\\sim n$。为了帮助追踪每只兔子得到多少草莓，他决定采用以下草莓分配程序。\n\nSlavko 每天都会买 $S$ 个草莓，然后选一个兔子 $A$ ，然后给它第一个草莓。之后，兔子 $A+1$ 会得到第二个草莓，兔子 $A+2$ 会得到第三个，以此类推。\n\n给每只兔子分配一个最初为空的火柴盒，然后把这 $n$ 个火柴盒排成一排。设 $k$ 为使得 $k^2\\leqslant n$ 的最大整数。这样就可以把兔子分成 $\\left\\lceil\\dfrac{n}{k}\\right\\rceil$组，每组 $k$ 个火柴盒（从第一个开始，最后一组有可能不足 $k$ 个），每组火柴盒旁边也会有一个杯子。我们说 $k$ 个连续的火柴盒和它们的杯子形成一组。\n\n在给兔子草莓之后，Slavko 会把一根火柴放进每个得到草莓的兔子的火柴盒里，**除非**他把火柴放进一组里所有的火柴盒里。此时他不会把火柴放在一组的所有火柴盒里，而是把一根火柴放在这一组所在的杯子里。通过这种方式，兔子收到的草莓总数可以用火柴盒里的火柴数加上杯子里的火柴数来计算。例如，假设 Slavko 有 $11$ 只兔子，即 $n=11$。数字 $3$ 是使得 $k^2\\leqslant n$ 的最大整数 $k$，因此 $k=3$。因此这些兔子将会被分成四组（最后一组只有两只兔子和两个火柴盒），自然就会有四个杯子，如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/taccw9un.png)\n\n如果 Slavko 买了 $6$ 个草莓，把第一个送给兔子 $5$，杯子和火柴盒里的状态将变为如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2tfy24vf.png)\n\n现在，请你编写一个程序，给定兔子的数量 $n$、天数 $m$ 以及 $m$ 天中的每一天购买的草莓数量 $S$ 和得到第一个草莓的兔子编号 $A$。对于每一天，输出 Slavko 当天使用的所有火柴盒和杯子中的火柴总数。", "inputFormat": "输入共 $m+1$ 行。\n\n第一行两个整数 $n,m$，分别表示兔子的总数（也是火柴盒数）和天数。  \n随后 $m$ 行，第 $i$ 行两个整数 $S,A$，分别表示第 $i$ 天购买的草莓数量和得到第一个草莓的兔子编号。", "outputFormat": "输出共 $m$ 行，第 $i$ 行一个整数，表示 Slavko 第 $i$ 天使用的所有火柴盒和杯子中的火柴总数。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，兔子、火柴盒和杯子摆放的情况即为题面中所给出的例子。\n\n第一天即为题面中所给出的例子，因此 Slavko 第一天放入 $4$ 根火柴。\n\n第二天 Slavko 买了 $3$ 个草莓，并将第一个草莓给了 $1$ 号兔子，这样的话，$1$、$2$、$3$ 号兔子都得到草莓，由于它们三个兔子都在一组里面，所以 Slavko 只需要在第 $1$ 个杯子里面放入一根火柴。因此 Slavko 第一天放入 $1$ 根火柴。\n\n第三天，Slavko 可以给他所有的兔子送草莓，所以需要在每个杯子里放一根火柴。总共是把 $4$ 根火柴放到杯子里，他在这天使用的杯子里（就是所有杯子）在他放置后一共有 $6$ 根火柴，所以输出 $6$。\n\n**【数据范围】**\n\n对于所有数据。$1\\leqslant n,m\\leqslant 10^5$，$1\\leqslant A\\leqslant n$，$1\\leqslant A+S-1\\leqslant n$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T3 JAGODA_**，按照原题数据配置，满分 $70$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7681", "type": "P", "difficulty": 3, "samples": [["4 1\n0110\n1001\n1001\n0110", "2"], ["4 2\n0110\n1001\n1001\n0110", "14"], ["5 3\n01000\n10110\n01000\n01001\n00010 ", "26"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2008", "COCI（克罗地亚）"], "title": "[COCI 2008/2009 #5] LUBENICA", "background": "", "description": "一个班有 $n$ 个孩子，他们上课时并没有认真听课，而是在玩 Facebook 社交网页上的扔西瓜游戏。\n\n第一节课上，Goran 向他的每个朋友扔了一个西瓜，**随后几节课**，孩子们都会按照以下方式采取行动：\n\n- 如果上节课一个人被奇数个西瓜扔中，那么这节课他会向所有他的朋友各扔一个西瓜。\n- 如果上节课一个人被偶数（**包括 $0$**）个西瓜扔中，那么这节课他会向所有他的朋友各扔两个西瓜。\n\n孩子们按照 $1\\sim n$ 编号，其中 Goran 的编号为 $1$。\n\n现在，给定孩子的个数 $n$ 和他们所有人的朋友关系，请求出 $h$ 节课之后，孩子们一共扔了多少个西瓜。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行，两个整数 $n,h$，分别表示孩子的个数和课程的节数。  \n随后 $n$ 行，每行 $n$ 个整数（**不用空格隔开**），形成一个矩阵。第 $i$ 行描述第 $i$ 个孩子的朋友关系，具体地，如果第 $i$ 行第 $j$ 个元素是 $1$，则表示第 $i$ 个孩子和第 $j$ 个孩子是朋友，否则不是。\n\n输入矩阵是对称的（即 $A$ 如果是 $B$ 的朋友，那么 $B$ 也会是 $A$ 的朋友），并且保证不会出现一个孩子和自己成为朋友的情况。", "outputFormat": "输出仅一行，一个整数，表示 $h$ 节课之后孩子们扔出的西瓜总数。", "hint": "**【样例 1/2 解释】**\n\n对于样例 $1/2$，首先，Goran 在第一节课上向第 $2$、$3$ 号孩子扔出一个西瓜，并且没有其他孩子扔出西瓜。因此，样例 $1$ 的答案为 $2$。  \n第二节课上，第 $2$、$3$ 号孩子都向第 $1$、$4$ 号孩子各扔出一个西瓜，同时第 $1$、$4$ 号孩子由于在上一节课没有被西瓜扔中，因此他们都向第 $2$、$3$ 号孩子各扔出 $2$ 个西瓜。因此第二节课上一共扔出了 $2\\times 2\\times 1+2\\times 2\\times 2=12$ 个西瓜。\n\n因此，前两节课一共扔出了 $2+12=14$ 个西瓜，而这就是样例 $2$ 的答案。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，满足 $h\\leqslant 1000$。  \n对于所有数据，$1\\leqslant n\\leqslant 20$，$1\\leqslant h\\leqslant 10^9$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T4 LUBENICA_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2008/2009 #5] LUBENICA", "background": "", "description": "一个班有 $n$ 个孩子，他们上课时并没有认真听课，而是在玩 Facebook 社交网页上的扔西瓜游戏。\n\n第一节课上，Goran 向他的每个朋友扔了一个西瓜，**随后几节课**，孩子们都会按照以下方式采取行动：\n\n- 如果上节课一个人被奇数个西瓜扔中，那么这节课他会向所有他的朋友各扔一个西瓜。\n- 如果上节课一个人被偶数（**包括 $0$**）个西瓜扔中，那么这节课他会向所有他的朋友各扔两个西瓜。\n\n孩子们按照 $1\\sim n$ 编号，其中 Goran 的编号为 $1$。\n\n现在，给定孩子的个数 $n$ 和他们所有人的朋友关系，请求出 $h$ 节课之后，孩子们一共扔了多少个西瓜。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行，两个整数 $n,h$，分别表示孩子的个数和课程的节数。  \n随后 $n$ 行，每行 $n$ 个整数（**不用空格隔开**），形成一个矩阵。第 $i$ 行描述第 $i$ 个孩子的朋友关系，具体地，如果第 $i$ 行第 $j$ 个元素是 $1$，则表示第 $i$ 个孩子和第 $j$ 个孩子是朋友，否则不是。\n\n输入矩阵是对称的（即 $A$ 如果是 $B$ 的朋友，那么 $B$ 也会是 $A$ 的朋友），并且保证不会出现一个孩子和自己成为朋友的情况。", "outputFormat": "输出仅一行，一个整数，表示 $h$ 节课之后孩子们扔出的西瓜总数。", "hint": "**【样例 1/2 解释】**\n\n对于样例 $1/2$，首先，Goran 在第一节课上向第 $2$、$3$ 号孩子扔出一个西瓜，并且没有其他孩子扔出西瓜。因此，样例 $1$ 的答案为 $2$。  \n第二节课上，第 $2$、$3$ 号孩子都向第 $1$、$4$ 号孩子各扔出一个西瓜，同时第 $1$、$4$ 号孩子由于在上一节课没有被西瓜扔中，因此他们都向第 $2$、$3$ 号孩子各扔出 $2$ 个西瓜。因此第二节课上一共扔出了 $2\\times 2\\times 1+2\\times 2\\times 2=12$ 个西瓜。\n\n因此，前两节课一共扔出了 $2+12=14$ 个西瓜，而这就是样例 $2$ 的答案。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，满足 $h\\leqslant 1000$。  \n对于所有数据，$1\\leqslant n\\leqslant 20$，$1\\leqslant h\\leqslant 10^9$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T4 LUBENICA_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7682", "type": "P", "difficulty": 4, "samples": [["1 9", "45"], ["100 111", "68"], ["7774407 7774407", "86"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2008", "COCI（克罗地亚）"], "title": "[COCI 2008/2009 #5] TRESNJA", "background": "", "description": "Lana 住在一个快乐的小村庄里。主街旁边有一排樱桃树。Lana 注意到每棵树用从 $1$ 开始的连续整数编号。经过大量研究，Lana 注意到树的编号唯一地决定了树的樱桃数量。对于一棵树，考虑将树编号中的连续数字组拆分出来。对于每组数字，将这一组中唯一的数字乘以该组数字长度的平方。把这些数字加在一起就得到了树上的樱桃总数。例如，在编号为 $77744007$ 的树中，我们将编号中的连续数字组拆分出来，得到 $4$ 组数：$777$、$44$、$00$ 和 $7$。所以编号为 $77744007$ 的树中樱桃的数量为 $7\\times 3^2+4\\times 2^2+0\\times2^2+7\\times1^2=86$ 个。\n\n到了摘樱桃的时候了，村民们同意把编号在区间 $[a,b]$ 中的树上的樱桃都摘下来。现在请你编写一个程序来计算采摘樱桃的总量。", "inputFormat": "输入仅一行，两个整数 $a,b$，代表能够采摘樱桃的树的起始点和终止点。", "outputFormat": "输出仅一行，一个整数，代表能够采摘的樱桃总量。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant a\\leqslant b\\leqslant 10^{15}$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T5 TRESNJA_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2008/2009 #5] TRESNJA", "background": "", "description": "Lana 住在一个快乐的小村庄里。主街旁边有一排樱桃树。Lana 注意到每棵树用从 $1$ 开始的连续整数编号。经过大量研究，Lana 注意到树的编号唯一地决定了树的樱桃数量。对于一棵树，考虑将树编号中的连续数字组拆分出来。对于每组数字，将这一组中唯一的数字乘以该组数字长度的平方。把这些数字加在一起就得到了树上的樱桃总数。例如，在编号为 $77744007$ 的树中，我们将编号中的连续数字组拆分出来，得到 $4$ 组数：$777$、$44$、$00$ 和 $7$。所以编号为 $77744007$ 的树中樱桃的数量为 $7\\times 3^2+4\\times 2^2+0\\times2^2+7\\times1^2=86$ 个。\n\n到了摘樱桃的时候了，村民们同意把编号在区间 $[a,b]$ 中的树上的樱桃都摘下来。现在请你编写一个程序来计算采摘樱桃的总量。", "inputFormat": "输入仅一行，两个整数 $a,b$，代表能够采摘樱桃的树的起始点和终止点。", "outputFormat": "输出仅一行，一个整数，代表能够采摘的樱桃总量。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant a\\leqslant b\\leqslant 10^{15}$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T5 TRESNJA_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7683", "type": "P", "difficulty": 4, "samples": [["3 1\n0", "2"], ["5 2\n2\n1 3 RRSRRRR\n1 5 RRRRLRR", "4"], ["5 5\n3\n1 3 SSRSSSS\n3 3 SSSLSSS\n4 3 SSRSSLS", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2008", "COCI（克罗地亚）"], "title": "[COCI 2008/2009 #5] KRUSKA", "background": "Aladdin 已经厌倦了宫殿里的生活。他有一份稳定的工作，他的妻子 Jasmine 和孩子们都在路上，生活变得单调。在这一切的驱使下，他决定在安顿下来之前再进行一次冒险。他决定找到 Golden Pear，这是一件极为珍贵的传奇文物，至今无人能找到。", "description": "Aladdin 正在寻找的沙漠可以被看作是一个 $n×n$ 的网格。行和列从上到下、从左到右编号为 $1$ 到 $n$。沙漠中的网格里一共有 $m$ 个巫师，他们以一种不同寻常的方式帮助 Aladdin 完成任务。\n\nAladdin 星期一在沙漠的左上角 $(1,1)$ 开始他的任务并面朝右。他的动作包括重复这些步骤：\n\n1. 如果当前的网格里有一个醒着的巫师，那么 Aladdin 会根据巫师说的话向左或向右转 $90$ 度。\n2. 如果向前走会把 Aladdin 带出沙漠，他会转过 $180$ 度。\n3. Aladdin 向前移动了一格，这将花费他一天的时间。\n\n对于每个巫师，我们都知道他的位置和一周中每一天的活动计划。每个巫师的日程表是一个由七个字母（仅包含`L`、`R` 或 `S`）组成的字符串，每个字符告诉我们巫师在一周中的某一天（从**星期一**开始）做什么。字母 `L` 表示 Aladdin 将在这一天被告知向左转，`R` 表示 Aladdin 将在这一天被告知向右转，而 `S` 表示巫师那天正在睡觉。\n\n一个古老的预言说，在改变 $k$ 次方向（通过**步骤 $1$ 和步骤 $2$**）后，Aladdin 会找到 Golden Pear。根据古老的预言，写一个程序来计算冒险将持续多少天。", "inputFormat": "输入共 $m+2$ 行。\n\n第一行，两个整数 $n,k$，分别表示沙漠的边长和古老的预言中所说的要改变方向的次数。  \n第二行，一个整数 $m$，表示巫师的个数。  \n随后 $m$ 行，第 $i$ 行两个整数和一个字符串，分别表示巫师所在的横坐标，纵坐标和一个星期内的行动（从**星期一**开始）。\n\n数据保证不存在在 $(1,1)$ 处的巫师、两个在同一网格的巫师或者在沙漠外的巫师。", "outputFormat": "输出仅一行，一个整数，代表冒险持续的天数。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，Aladdin 移动了两格之后到达沙漠的边缘，随后他转过 $180$ 度，找到了 Golden Pear。所以冒险将持续 $2$ 天。\n\n**【样例 2 解释】**\n\n对于样例 $2$，Aladdin 在走了两天之后找到了第一个巫师，但是这个巫师此时正在睡觉，所以 Aladdin 继续走了两天，然后他在第 $4$ 天找到了第二个巫师，这个巫师告诉他要向左转，Aladdin 这么做了，然后他来到了沙漠的边缘，转过 $180$ 度，找到了 Golden Pear。所以冒险将持续 $4$ 天。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，保证 $k\\leqslant 1000$。  \n对于所有数据，$2\\leqslant n\\leqslant 200$，$1\\leqslant k\\leqslant 10^9$，$0\\leqslant m\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T6 KRUSKA_**，按照原题数据配置，满分 $130$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2008/2009 #5] KRUSKA", "background": "Aladdin 已经厌倦了宫殿里的生活。他有一份稳定的工作，他的妻子 Jasmine 和孩子们都在路上，生活变得单调。在这一切的驱使下，他决定在安顿下来之前再进行一次冒险。他决定找到 Golden Pear，这是一件极为珍贵的传奇文物，至今无人能找到。", "description": "Aladdin 正在寻找的沙漠可以被看作是一个 $n×n$ 的网格。行和列从上到下、从左到右编号为 $1$ 到 $n$。沙漠中的网格里一共有 $m$ 个巫师，他们以一种不同寻常的方式帮助 Aladdin 完成任务。\n\nAladdin 星期一在沙漠的左上角 $(1,1)$ 开始他的任务并面朝右。他的动作包括重复这些步骤：\n\n1. 如果当前的网格里有一个醒着的巫师，那么 Aladdin 会根据巫师说的话向左或向右转 $90$ 度。\n2. 如果向前走会把 Aladdin 带出沙漠，他会转过 $180$ 度。\n3. Aladdin 向前移动了一格，这将花费他一天的时间。\n\n对于每个巫师，我们都知道他的位置和一周中每一天的活动计划。每个巫师的日程表是一个由七个字母（仅包含`L`、`R` 或 `S`）组成的字符串，每个字符告诉我们巫师在一周中的某一天（从**星期一**开始）做什么。字母 `L` 表示 Aladdin 将在这一天被告知向左转，`R` 表示 Aladdin 将在这一天被告知向右转，而 `S` 表示巫师那天正在睡觉。\n\n一个古老的预言说，在改变 $k$ 次方向（通过**步骤 $1$ 和步骤 $2$**）后，Aladdin 会找到 Golden Pear。根据古老的预言，写一个程序来计算冒险将持续多少天。", "inputFormat": "输入共 $m+2$ 行。\n\n第一行，两个整数 $n,k$，分别表示沙漠的边长和古老的预言中所说的要改变方向的次数。  \n第二行，一个整数 $m$，表示巫师的个数。  \n随后 $m$ 行，第 $i$ 行两个整数和一个字符串，分别表示巫师所在的横坐标，纵坐标和一个星期内的行动（从**星期一**开始）。\n\n数据保证不存在在 $(1,1)$ 处的巫师、两个在同一网格的巫师或者在沙漠外的巫师。", "outputFormat": "输出仅一行，一个整数，代表冒险持续的天数。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，Aladdin 移动了两格之后到达沙漠的边缘，随后他转过 $180$ 度，找到了 Golden Pear。所以冒险将持续 $2$ 天。\n\n**【样例 2 解释】**\n\n对于样例 $2$，Aladdin 在走了两天之后找到了第一个巫师，但是这个巫师此时正在睡觉，所以 Aladdin 继续走了两天，然后他在第 $4$ 天找到了第二个巫师，这个巫师告诉他要向左转，Aladdin 这么做了，然后他来到了沙漠的边缘，转过 $180$ 度，找到了 Golden Pear。所以冒险将持续 $4$ 天。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，保证 $k\\leqslant 1000$。  \n对于所有数据，$2\\leqslant n\\leqslant 200$，$1\\leqslant k\\leqslant 10^9$，$0\\leqslant m\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T6 KRUSKA_**，按照原题数据配置，满分 $130$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7684", "type": "P", "difficulty": 6, "samples": [["5  6\n4 1 3 1 6 5 2 3 2 3 5 6 2 1 4 5 6 4 1 3 2 4 5 5 1 2 3 4 6 6", "8\n9 31\n18 9\n10 18 \n4 10\n31 4\n30 31\n24 30\n31 24"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["图论", "2005", "Special Judge", "CEOI（中欧）", "欧拉回路", "二分图", "构造"], "title": "[CEOI 2005] Depot Rearrangement", "background": "", "description": "一家公司经营着 $N$ 个店铺，每个店铺都销售 $M$ 种不同的产品。该公司有一个大型仓库，产品在运送到商店之前在都会那里进行包装。每家商店将会收到相同数量的每种产品。因此，该公司将一定数量的相应产品分别包装到一个集装箱中，并用产品标识符标记该集装箱。产品由 $1$ 到 $M$ 的数字标识。因此，在包装结束后，仓库中将会有 $N×M$ 个集装箱，并且正好 $N$ 个集装箱贴有每个产品的对应标签。由于该仓库位于一个狭窄的建筑物内，所以集装箱排成了一排。但为了加快配送速度，仓库经理想要重新排列集装箱。由于将产品配送到商店是通过向每个商店发出一辆卡车来实现的，并且每辆卡车运载每种产品的一个集装箱，其合适的安排如下。该行最前部分 $M$ 个集装箱必须贴有不同的产品标签，该行的第二部分 $M$ 个集装箱必须贴有不同的产品标签，依此类推。不幸的是，在这一行的尽头只有一个空闲的地方可以放置一个集装箱。因此，必须通过依次拿起集装箱并将其移动到空闲位置来进行重新排列。重新排列后，空闲位置也必须在行的末尾。  \n目标是通过最少的移动以实现所需的重新排列。  \n现请您编写一个程序来计算需要最少移动多少次使得达成目标重排。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$。$N$ 是商店的数量，$M$ 是产品的数量。第二行包含 $N×M$ 个整数，即按初始顺序排列的集装箱标签。每个产品标识符 $x$ 在行中恰好出现 $N$ 次。", "outputFormat": "第一行包含一个整数 $S$，这是达成集装箱所需排列所需的最小移动次数。以下 $S$ 行描述了重新排列。每行包含一对整数 $x$，$y$。一对 $x$，$y$ 描述了一个移动：位于 $x$ 位置的集装箱将移动到位置 $y$。位置由从 $1$ 到 $N×M+1$ 的数字标识；最初位置 $N×M+1$ 是空闲的（没有集装箱）。只有在移动之前位置 $y$ 是空闲的，从 $x$ 到 $y$ 的移动才是合法的。从 $x$ 移动到 $y$ 后，位置 $x$ 将是空闲的。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq N \\leq 400$，$1 \\leq M \\leq 400$，$1 \\leq x \\leq M$。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2005 的 Depot Rearrangement。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \nSpecial Judge 感谢 @[abruce](/user/104324)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2005] Depot Rearrangement", "background": "", "description": "一家公司经营着 $N$ 个店铺，每个店铺都销售 $M$ 种不同的产品。该公司有一个大型仓库，产品在运送到商店之前在都会那里进行包装。每家商店将会收到相同数量的每种产品。因此，该公司将一定数量的相应产品分别包装到一个集装箱中，并用产品标识符标记该集装箱。产品由 $1$ 到 $M$ 的数字标识。因此，在包装结束后，仓库中将会有 $N×M$ 个集装箱，并且正好 $N$ 个集装箱贴有每个产品的对应标签。由于该仓库位于一个狭窄的建筑物内，所以集装箱排成了一排。但为了加快配送速度，仓库经理想要重新排列集装箱。由于将产品配送到商店是通过向每个商店发出一辆卡车来实现的，并且每辆卡车运载每种产品的一个集装箱，其合适的安排如下。该行最前部分 $M$ 个集装箱必须贴有不同的产品标签，该行的第二部分 $M$ 个集装箱必须贴有不同的产品标签，依此类推。不幸的是，在这一行的尽头只有一个空闲的地方可以放置一个集装箱。因此，必须通过依次拿起集装箱并将其移动到空闲位置来进行重新排列。重新排列后，空闲位置也必须在行的末尾。  \n目标是通过最少的移动以实现所需的重新排列。  \n现请您编写一个程序来计算需要最少移动多少次使得达成目标重排。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$。$N$ 是商店的数量，$M$ 是产品的数量。第二行包含 $N×M$ 个整数，即按初始顺序排列的集装箱标签。每个产品标识符 $x$ 在行中恰好出现 $N$ 次。", "outputFormat": "第一行包含一个整数 $S$，这是达成集装箱所需排列所需的最小移动次数。以下 $S$ 行描述了重新排列。每行包含一对整数 $x$，$y$。一对 $x$，$y$ 描述了一个移动：位于 $x$ 位置的集装箱将移动到位置 $y$。位置由从 $1$ 到 $N×M+1$ 的数字标识；最初位置 $N×M+1$ 是空闲的（没有集装箱）。只有在移动之前位置 $y$ 是空闲的，从 $x$ 到 $y$ 的移动才是合法的。从 $x$ 移动到 $y$ 后，位置 $x$ 将是空闲的。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq N \\leq 400$，$1 \\leq M \\leq 400$，$1 \\leq x \\leq M$。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2005 的 Depot Rearrangement。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \nSpecial Judge 感谢 @[abruce](/user/104324)。", "locale": "zh-CN"}}}
{"pid": "P7685", "type": "P", "difficulty": 5, "samples": [["5 9\n0 1 1 1 1\n1 0 2 3 2\n1 1 0 4 1\n2 1 5 0 1\n4 2 3 4 0\n4 2 4 1 5 4 3 2 1", "5\n1 2 1 2 2 1 3 1 3 "]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["动态规划 DP", "2005", "Special Judge", "CEOI（中欧）"], "title": "[CEOI 2005] Mobile Service", "background": "", "description": "一家公司为其位于不同城镇的合作伙伴提供服务。公司现有流动服务人员 $3$ 名。如果服务请求发生在某个位置，服务人员必须从他当前的位置移动到请求的位置（如果没有员工在那里）以满足请求。任何时候只有一名员工可以移动。他们只能应要求移动，并且不允许多名员工在同一位置。将员工从位置 $p$ 移动到位置 $q$ 会产生一定的成本 $C(p,q)$。成本计算不一定是对等的，但不动代价为 $0$，即 $C(p,p)=0$。公司必须以严格按照先请求先得服务的原则满足收到的要求。  \n请您编写一个程序，该程序决定服务人员中的哪位员工要为每个请求移动，以便为给定的请求列表提供服务的总成本尽可能小。", "inputFormat": "第一行包含两个整数 $L$ 和 $N$。$L$ 是表示位置的数，$N$ 是请求数。位置由从 $1$ 到 $L$ 的整数表示。接下来的 $L$ 行中的每一行都包含 $L$ 个非负整数。第 $i+1$ 行第 $j$ 个数字是成本 $C(i,j)$。最后一行包含 $N$ 个整数，为请求列表。请求由发生请求的位置的标识符标识。起初，三名服务人员分别位于位置 $1,2$ 和 $3$，并以此为三名服务人员进行标识。", "outputFormat": "第一行包含一个整数 $M$，它是为请求的列表提供服务的最小总成本。第二行正好包含 $N$ 个整数。第 $i$ 个编号是将为第 $i$ 个请求提供服务的服务人员的标识符（$1,2 $ 或 $3$）。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$3 \\leq L \\leq 200$，$1 \\leq N \\leq 1000$，$C(i,j) <2000$。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2005 的 Mobile  Service。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \nSpecial Judge 感谢 @[Cat_shao](/user/234011)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2005] Mobile Service", "background": "", "description": "一家公司为其位于不同城镇的合作伙伴提供服务。公司现有流动服务人员 $3$ 名。如果服务请求发生在某个位置，服务人员必须从他当前的位置移动到请求的位置（如果没有员工在那里）以满足请求。任何时候只有一名员工可以移动。他们只能应要求移动，并且不允许多名员工在同一位置。将员工从位置 $p$ 移动到位置 $q$ 会产生一定的成本 $C(p,q)$。成本计算不一定是对等的，但不动代价为 $0$，即 $C(p,p)=0$。公司必须以严格按照先请求先得服务的原则满足收到的要求。  \n请您编写一个程序，该程序决定服务人员中的哪位员工要为每个请求移动，以便为给定的请求列表提供服务的总成本尽可能小。", "inputFormat": "第一行包含两个整数 $L$ 和 $N$。$L$ 是表示位置的数，$N$ 是请求数。位置由从 $1$ 到 $L$ 的整数表示。接下来的 $L$ 行中的每一行都包含 $L$ 个非负整数。第 $i+1$ 行第 $j$ 个数字是成本 $C(i,j)$。最后一行包含 $N$ 个整数，为请求列表。请求由发生请求的位置的标识符标识。起初，三名服务人员分别位于位置 $1,2$ 和 $3$，并以此为三名服务人员进行标识。", "outputFormat": "第一行包含一个整数 $M$，它是为请求的列表提供服务的最小总成本。第二行正好包含 $N$ 个整数。第 $i$ 个编号是将为第 $i$ 个请求提供服务的服务人员的标识符（$1,2 $ 或 $3$）。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$3 \\leq L \\leq 200$，$1 \\leq N \\leq 1000$，$C(i,j) <2000$。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2005 的 Mobile  Service。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \nSpecial Judge 感谢 @[Cat_shao](/user/234011)。", "locale": "zh-CN"}}}
{"pid": "P7686", "type": "P", "difficulty": 2, "samples": [["4 6\n1 2 1 2 3 3", "3\n1 2 3"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240]}, "tags": ["2005", "CEOI（中欧）"], "title": "[CEOI 2005] Multi-key Sorting", "background": "", "description": "考虑一个包含行和列的表。列从 $1$ 到 $C$ 编号。为简单起见，表中的项目是由小写字母组成的字符串。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/z70sexo1.png)  \n您将获得对此类表的 Sort($k$) 操作：Sort($k$) 按照列 $k$ 中的值的顺序对表的行进行排序（而列的顺序不会改变）。排序是稳定的，即在第 $k$ 列中具有相等值的行保持其原始顺序。例如，将 Sort($2$) 应用于表 $1$ 会产生表 $2$。  \n我们对此类排序操作的序列感兴趣。这些操作依次应用于同一个表。例如，应用序列 Sort($2$)；Sort($1$) 到表 $1$ 产生表 $3$。  \n如果两个排序操作序列对于任何表具有相同的效果，则它们被称为等效。例如，Sort($2$)；Sort($2$)；Sort($1$) 等效于 Sort($2$)；Sort($1$)。但是，它不等效于 Sort($1$)；Sort($2$)，因为对表 $1$ 的影响不同。", "inputFormat": "第一行包含两个整数，$C$ 和 $N$。$C$ 是列数，$N$ 是排序操作数。第二行包含 $N$ 个整数，$k_i$。它定义了排序操作的顺序 Sort($k_1$)；$\\cdots$； Sort($k_N$)。", "outputFormat": "第一行包含一个整数 $M$，为输入的操作序列的最短等效排序操作序列的长度。第二行包含 $M$ 个整数，表示其最短操作序列。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq C \\leq 10^6$，$1 \\leq N \\leq 3×10^6$，$1 \\leq k_i \\leq C$。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2005 的 Multi-key Sorting。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2005] Multi-key Sorting", "background": "", "description": "考虑一个包含行和列的表。列从 $1$ 到 $C$ 编号。为简单起见，表中的项目是由小写字母组成的字符串。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/z70sexo1.png)  \n您将获得对此类表的 Sort($k$) 操作：Sort($k$) 按照列 $k$ 中的值的顺序对表的行进行排序（而列的顺序不会改变）。排序是稳定的，即在第 $k$ 列中具有相等值的行保持其原始顺序。例如，将 Sort($2$) 应用于表 $1$ 会产生表 $2$。  \n我们对此类排序操作的序列感兴趣。这些操作依次应用于同一个表。例如，应用序列 Sort($2$)；Sort($1$) 到表 $1$ 产生表 $3$。  \n如果两个排序操作序列对于任何表具有相同的效果，则它们被称为等效。例如，Sort($2$)；Sort($2$)；Sort($1$) 等效于 Sort($2$)；Sort($1$)。但是，它不等效于 Sort($1$)；Sort($2$)，因为对表 $1$ 的影响不同。", "inputFormat": "第一行包含两个整数，$C$ 和 $N$。$C$ 是列数，$N$ 是排序操作数。第二行包含 $N$ 个整数，$k_i$。它定义了排序操作的顺序 Sort($k_1$)；$\\cdots$； Sort($k_N$)。", "outputFormat": "第一行包含一个整数 $M$，为输入的操作序列的最短等效排序操作序列的长度。第二行包含 $M$ 个整数，表示其最短操作序列。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq C \\leq 10^6$，$1 \\leq N \\leq 3×10^6$，$1 \\leq k_i \\leq C$。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2005 的 Multi-key Sorting。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7687", "type": "P", "difficulty": 5, "samples": [["9 10 3 4\n2 4 5\n4 9 8 3\n1 2\n4 1\n2 3\n4 2\n1 5\n5 6\n6 7\n6 8\n7 9\n8 7", "3\n3 2\n5 6\n7 9"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2005", "Special Judge", "CEOI（中欧）", "Tarjan"], "title": "[CEOI 2005] Critical Network Lines", "background": "", "description": "一个通信网络包含若干个节点，以及若干条直接连接这些节点的双向**通信线路**。已知所研究的通信网络是连通的，即：任意一对节点之间都存在（若干条**通信线路**首尾相接而成的）**通信路径**。\n\n一些节点会向所有节点（包括它自己）提供 $A$ 类型服务，还有一些节点会向所有节点（包括它自己）提供 $B$ 类型服务。一个节点可能会同时提供两种类型的服务。每个节点都必须要访问这两种服务。\n\n当一条**通信线路**断开时，可能会出现某个节点不能访问某种服务的情况。（即：存在某个节点以及某种服务，使得不存在任何提供该类型服务，且与该节点连通的节点）我们称会造成这种情况的**通信线路**为**关键通信线路**。\n\n你的任务是，写一个程序计算有多少条**关键通信线路**，并求出每条**关键通信线路**所连接的两个端点。", "inputFormat": "输入第一行包含四个整数 $N,M,K,L$。其中，$N \\; (1 \\le N \\le 10^5)$ 表示通信网络的节点数，$M \\; (1 \\le M \\le 10^6)$ 表示通信网络的**通信线路**数，$K \\; (1 \\le K \\le N)$ 表示提供 $A$ 类型服务的节点数，$L \\; (1 \\le L \\le N)$ 表示提供 $B$ 类型服务的节点数。节点编号为 $1$ 到 $N$。\n\n第二行包含 $K$ 个整数，表示提供 $A$ 类型服务的节点编号。\n\n第三行包含 $L$ 个整数，表示提供 $B$ 类型服务的节点编号。\n\n接下来 $M$ 行，每行包含两个整数 $p,q \\; (1 \\le p,q \\le N,p \\neq q)$，表示一条**通信线路**的两个端点的编号。保证任意两个节点之间至多只有一条**通信线路**。", "outputFormat": "输出第一行包含一个整数 $S$，表示**关键通信线路**的数量。\n\n接下来 $S$ 行，每行包含两个整数 $p,q$，表示一条**关键通信线路**所连接的两个端点的编号。\n\n**关键通信线路**的顺序任意，每一条**关键通信线路**所连接的两个端点的顺序也任意。", "hint": "本题为 CEOI2005 D2T2，原题面请见：[Critical Network Lines](http://ceoi.inf.elte.hu/ceoi2005/download/tasks/day2/net.htm)。\n\n感谢 @[wsyhb](https://www.luogu.com.cn/user/145355) 提供的 Special Judge！", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2005] Critical Network Lines", "background": "", "description": "一个通信网络包含若干个节点，以及若干条直接连接这些节点的双向**通信线路**。已知所研究的通信网络是连通的，即：任意一对节点之间都存在（若干条**通信线路**首尾相接而成的）**通信路径**。\n\n一些节点会向所有节点（包括它自己）提供 $A$ 类型服务，还有一些节点会向所有节点（包括它自己）提供 $B$ 类型服务。一个节点可能会同时提供两种类型的服务。每个节点都必须要访问这两种服务。\n\n当一条**通信线路**断开时，可能会出现某个节点不能访问某种服务的情况。（即：存在某个节点以及某种服务，使得不存在任何提供该类型服务，且与该节点连通的节点）我们称会造成这种情况的**通信线路**为**关键通信线路**。\n\n你的任务是，写一个程序计算有多少条**关键通信线路**，并求出每条**关键通信线路**所连接的两个端点。", "inputFormat": "输入第一行包含四个整数 $N,M,K,L$。其中，$N \\; (1 \\le N \\le 10^5)$ 表示通信网络的节点数，$M \\; (1 \\le M \\le 10^6)$ 表示通信网络的**通信线路**数，$K \\; (1 \\le K \\le N)$ 表示提供 $A$ 类型服务的节点数，$L \\; (1 \\le L \\le N)$ 表示提供 $B$ 类型服务的节点数。节点编号为 $1$ 到 $N$。\n\n第二行包含 $K$ 个整数，表示提供 $A$ 类型服务的节点编号。\n\n第三行包含 $L$ 个整数，表示提供 $B$ 类型服务的节点编号。\n\n接下来 $M$ 行，每行包含两个整数 $p,q \\; (1 \\le p,q \\le N,p \\neq q)$，表示一条**通信线路**的两个端点的编号。保证任意两个节点之间至多只有一条**通信线路**。", "outputFormat": "输出第一行包含一个整数 $S$，表示**关键通信线路**的数量。\n\n接下来 $S$ 行，每行包含两个整数 $p,q$，表示一条**关键通信线路**所连接的两个端点的编号。\n\n**关键通信线路**的顺序任意，每一条**关键通信线路**所连接的两个端点的顺序也任意。", "hint": "本题为 CEOI2005 D2T2，原题面请见：[Critical Network Lines](http://ceoi.inf.elte.hu/ceoi2005/download/tasks/day2/net.htm)。\n\n感谢 @[wsyhb](https://www.luogu.com.cn/user/145355) 提供的 Special Judge！", "locale": "zh-CN"}}}
{"pid": "P7688", "type": "P", "difficulty": 5, "samples": [["20 3\n7\n4 2 10 9 16 15 17", "9\n6\n4 1\n1 4\n2 7\n3 10\n6 13\n5 16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2005", "Special Judge", "CEOI（中欧）"], "title": "[CEOI 2005] Ticket Office", "background": "", "description": "售票处在出售音乐会门票，但它不销售单个座位的门票，而是销售固定数量的连续座位的成组门票。该售票处办公室已收到大量采购订单。一组座位的采购订单指定该组座位中最低的座位号。而办公室可能无法完成所有采购订单。此外，如果它只完全按照采购订单中的要求分配座位，那么大量作位可能会保持空置。因此，办公室采用以下分配和定价策略。如果采购订单被接受并且分配的座位正是所要求的座位，那么购买者支付全价（$2$ petaks）。如果采购订单被接受，但分配的座位与请求的座位不同（至少在一个位置上），则购买者支付半价（$1$ petak）。目标是使总收入最大化。  \n请您编写一个程序来计算可以实现的最大收入，并将座位分配给选定的订单以实现该收入。", "inputFormat": "第一行包含两个整数，$M$ 和 $L$。$M$ 是座位数，$L$ 是每组中连续的座位号。座位号从 $1$ 到 $M$。第二行包含一个整数 $N$，即采购订单的数量。第三行包含 $N$ 个整数，定义采购订单，其行中的第 $i$ 个数字 $z$ 表示第 $i$ 个购买者要求从座位 $z$ 开始到座位 $z+L-1$ 结束的一组座位。", "outputFormat": "第一行包含一个整数 $S$，即最大收入。第二行包含一个整数 $Q$，即已接受订单的数量。 接下来的 $Q$ 行描述了座位分配。每行包含一对整数 $x$ $y$。一对 $x$ $y$ 表示购买者 $x$ 从座位号 $y$ 开始获得座位。这些行必须按座位号的升序排列。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据， $1 \\leq M \\leq 3×10^4$，$1 \\leq L \\leq 100$，$1 \\leq N \\leq 10^5$，$1 \\leq z \\leq M-L+1$。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2005 的 Ticket Office。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \nSpecial Judge 感谢 @[Azazеl](/user/160701)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2005] Ticket Office", "background": "", "description": "售票处在出售音乐会门票，但它不销售单个座位的门票，而是销售固定数量的连续座位的成组门票。该售票处办公室已收到大量采购订单。一组座位的采购订单指定该组座位中最低的座位号。而办公室可能无法完成所有采购订单。此外，如果它只完全按照采购订单中的要求分配座位，那么大量作位可能会保持空置。因此，办公室采用以下分配和定价策略。如果采购订单被接受并且分配的座位正是所要求的座位，那么购买者支付全价（$2$ petaks）。如果采购订单被接受，但分配的座位与请求的座位不同（至少在一个位置上），则购买者支付半价（$1$ petak）。目标是使总收入最大化。  \n请您编写一个程序来计算可以实现的最大收入，并将座位分配给选定的订单以实现该收入。", "inputFormat": "第一行包含两个整数，$M$ 和 $L$。$M$ 是座位数，$L$ 是每组中连续的座位号。座位号从 $1$ 到 $M$。第二行包含一个整数 $N$，即采购订单的数量。第三行包含 $N$ 个整数，定义采购订单，其行中的第 $i$ 个数字 $z$ 表示第 $i$ 个购买者要求从座位 $z$ 开始到座位 $z+L-1$ 结束的一组座位。", "outputFormat": "第一行包含一个整数 $S$，即最大收入。第二行包含一个整数 $Q$，即已接受订单的数量。 接下来的 $Q$ 行描述了座位分配。每行包含一对整数 $x$ $y$。一对 $x$ $y$ 表示购买者 $x$ 从座位号 $y$ 开始获得座位。这些行必须按座位号的升序排列。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据， $1 \\leq M \\leq 3×10^4$，$1 \\leq L \\leq 100$，$1 \\leq N \\leq 10^5$，$1 \\leq z \\leq M-L+1$。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2005 的 Ticket Office。  \n由 @[求学的企鹅](/user/271784) 翻译整理。  \nSpecial Judge 感谢 @[Azazеl](/user/160701)。", "locale": "zh-CN"}}}
{"pid": "P7689", "type": "P", "difficulty": 6, "samples": [["2\n6 6 5\n1 4\n4 6\n2 2\n3 6\n6 4\n6 5 4\n3 3\n6 1\n6 2\n6 4", "3\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192]}, "tags": ["2002", "CEOI（中欧）", "深度优先搜索 DFS", "状压 DP"], "title": "[CEOI 2002] Bugs Integrated,Inc.", "background": null, "description": "Bugs Integrated,Inc. 是高级存储芯片的主要制造商。他们正在开始生产新的 $6$ TB Q-RAM 芯片。每个芯片由以 $2×3$ 的矩形排列的六个方形硅片块组成。Q-RAM 芯片的制造方式是将一块长方形的大硅片分成 $N×M$ 个方形硅片块。然后仔细测试所有方形硅片块，坏的用黑色标记。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/qqjfauh0.png)  \n最后，将硅片切割成存储芯片。每个芯片由 $2×3$（或\n $3×2$）单位方形硅片块组成。当然，任何芯片都不能包含任何坏的（标记的）方形硅片块。它可能不能将硅片切割成每一个好的方形硅片块都成为某些存储芯片的一部分。该公司希望尽可能少地浪费好方形硅片块。因此他们想知道如何切割硅片以尽可能多地切出芯片。  \n现您将获得几个硅片的尺寸和其每个硅片所有坏方形硅片块的列表。你的任务是编写一个程序，计算每个硅片最多可以从其切下的芯片数量。", "inputFormat": "第一行由一个整数 $D$ 组成，表示硅片的数量。接下来 $D$ 个部分，每个部分描述一个硅片。每个部分的第一行包含三个整数 $N$，$M$，$K$，其间由单个空格分隔。$N$ 是硅片的长度，$M$ 是它的高度，$K$ 是硅片中坏方硅片块的数量。以下 $K$ 行包含一个坏方硅片块列表。每行包含两个整数 $x$ 和 $y$，表示一个坏方硅片块的坐标（左上角的坐标为（$1,1$），右下角是 （$N,M$））。", "outputFormat": "每行输出每个硅片最多可以从其切下的芯片数量。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq D \\leq 5$，$1 \\leq N \\leq 150$，$1 \\leq M \\leq 10$，$0 \\leq K \\leq M×N$，$1 \\leq x \\leq N$，$1 \\leq y \\leq M$。  \n#### 样例说明  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/v4ugwh72.png)  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2002 的 [Bugs Integrated,Inc.](https://web.ics.upjs.sk/ceoi/documents/tasks/bugs-tsk.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2002] Bugs Integrated,Inc.", "background": null, "description": "Bugs Integrated,Inc. 是高级存储芯片的主要制造商。他们正在开始生产新的 $6$ TB Q-RAM 芯片。每个芯片由以 $2×3$ 的矩形排列的六个方形硅片块组成。Q-RAM 芯片的制造方式是将一块长方形的大硅片分成 $N×M$ 个方形硅片块。然后仔细测试所有方形硅片块，坏的用黑色标记。  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/qqjfauh0.png)  \n最后，将硅片切割成存储芯片。每个芯片由 $2×3$（或\n $3×2$）单位方形硅片块组成。当然，任何芯片都不能包含任何坏的（标记的）方形硅片块。它可能不能将硅片切割成每一个好的方形硅片块都成为某些存储芯片的一部分。该公司希望尽可能少地浪费好方形硅片块。因此他们想知道如何切割硅片以尽可能多地切出芯片。  \n现您将获得几个硅片的尺寸和其每个硅片所有坏方形硅片块的列表。你的任务是编写一个程序，计算每个硅片最多可以从其切下的芯片数量。", "inputFormat": "第一行由一个整数 $D$ 组成，表示硅片的数量。接下来 $D$ 个部分，每个部分描述一个硅片。每个部分的第一行包含三个整数 $N$，$M$，$K$，其间由单个空格分隔。$N$ 是硅片的长度，$M$ 是它的高度，$K$ 是硅片中坏方硅片块的数量。以下 $K$ 行包含一个坏方硅片块列表。每行包含两个整数 $x$ 和 $y$，表示一个坏方硅片块的坐标（左上角的坐标为（$1,1$），右下角是 （$N,M$））。", "outputFormat": "每行输出每个硅片最多可以从其切下的芯片数量。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq D \\leq 5$，$1 \\leq N \\leq 150$，$1 \\leq M \\leq 10$，$0 \\leq K \\leq M×N$，$1 \\leq x \\leq N$，$1 \\leq y \\leq M$。  \n#### 样例说明  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/v4ugwh72.png)  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2002 的 [Bugs Integrated,Inc.](https://web.ics.upjs.sk/ceoi/documents/tasks/bugs-tsk.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7690", "type": "P", "difficulty": 5, "samples": [["2\n2 1\n3 3", "1 2\n2 3 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2002", "CEOI（中欧）"], "title": "[CEOI 2002] A decorative fence", "background": "", "description": "理查德刚刚盖完他的新房子。现在房子唯一缺少的是一个可爱的小木栅栏。他不知道如何制作木栅栏，所以他决定订购一个。不知何故，他拿到了 $\\texttt{ACME Fence Catalog 2002}$――可爱的小木栅栏的旗舰版资源（注：ACME 是一家什么都造的公司）。看完它的前言，他已经知道，什么使小木栅栏变得可爱。  \n一个木栅栏由 $N$ 块木板组成，每块木板垂直排成一排。除此之外，当且仅当满足以下条件时，围栏看起来很可爱：  \n- 木板有不同的长度，即 $1,2,\\cdots,N$ 为木板长度单位。  \n- 每块有两个相邻的木板，它要么比它的相邻的都大，要么比它相邻的都小。（即，这会使得围栏顶部交替上升和下降（高低起伏））。  \n\n因此，我们可以将每个用 $N$ 块木板的可爱的栅栏唯一地描述为一个排列 $a_1,\\cdots,a_N$（$\\forall i$，$1 < i < N$）$(a_i - a_{i−1}) × (a_i - a_{i+1}) > 0$。反之亦然，每个这样的排列都描述了一个可爱的围栏。  \n很明显，可能有许多不同的可爱木栅栏由 $N$ 块木板制成。ACME 的销售经理决定以下列方式排列可爱围栏并放入清单：栅栏 A（由排列 $a_1,\\cdots,a_N$ 表示）在栅栏 B 之前（由 $b_1,\\cdots,b_N$ 表示），当且仅当存在这样的 $i$，使得（$\\forall j < i$）$a_j = b_j$ 和 （$a_i < b_i$）。（也就是说，比较两个围栏中哪个在清单中更早相当于取它们对应的排列，找出它们第一个不同的地方，并比较这个地方的值。）所有 $N$ 块木板的可爱围栏都被按照它们在清单中出现的顺序编号（从 $1$ 开始）。这个号码被称为他们的清单号。 \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/9kopwi5p.png)\n仔细检查所有的可爱的小木栅栏后，理查德决定要它们中的一些。他记下木板的数量 $N$ 和清单号 $C$。后来，他遇到了他的朋友，他想向他们展示他围栏，但他失去了清单。他得到的唯一的事情是他的笔记。请帮助他查明，他的围栏将为何等样子。", "inputFormat": "第一行包含一个整数 $K$。接下来 $K$ 行，每行描述一个输入数据集，每一行都包含两个以空格分割的整数 $N$ 和 $C$，$N$ 是围栏上木板的数量，$C$ 是围栏的栅栏的清单号。", "outputFormat": "每个数据集输出一行，描述列表带有 $N$ 个木板的第 $C$ 个栅栏。更准确地说，如果栅栏排列 $a_1,\\cdots,a_N$，则输出的相应行应包含数字 $a_i$（按正确顺序），由单个空格分隔。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq K \\leq 100$，$1 \\leq N \\leq 20$。你可以认为，$20$ 块木板的可爱小木栅栏的总数适合转换为 $64$ 位有符号整数变量（C/C++ 中的 `long long`，FreePascal 中的 `int64`）。你也可以认为输入是正确的，特别是 $C$ 最小是 $1$ 并且它不超过有 $N$ 块木板的可爱围栏的数量。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2002 的 [A decorative fence](https://web.ics.upjs.sk/ceoi/documents/tasks/fence-tsk.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2002] A decorative fence", "background": "", "description": "理查德刚刚盖完他的新房子。现在房子唯一缺少的是一个可爱的小木栅栏。他不知道如何制作木栅栏，所以他决定订购一个。不知何故，他拿到了 $\\texttt{ACME Fence Catalog 2002}$――可爱的小木栅栏的旗舰版资源（注：ACME 是一家什么都造的公司）。看完它的前言，他已经知道，什么使小木栅栏变得可爱。  \n一个木栅栏由 $N$ 块木板组成，每块木板垂直排成一排。除此之外，当且仅当满足以下条件时，围栏看起来很可爱：  \n- 木板有不同的长度，即 $1,2,\\cdots,N$ 为木板长度单位。  \n- 每块有两个相邻的木板，它要么比它的相邻的都大，要么比它相邻的都小。（即，这会使得围栏顶部交替上升和下降（高低起伏））。  \n\n因此，我们可以将每个用 $N$ 块木板的可爱的栅栏唯一地描述为一个排列 $a_1,\\cdots,a_N$（$\\forall i$，$1 < i < N$）$(a_i - a_{i−1}) × (a_i - a_{i+1}) > 0$。反之亦然，每个这样的排列都描述了一个可爱的围栏。  \n很明显，可能有许多不同的可爱木栅栏由 $N$ 块木板制成。ACME 的销售经理决定以下列方式排列可爱围栏并放入清单：栅栏 A（由排列 $a_1,\\cdots,a_N$ 表示）在栅栏 B 之前（由 $b_1,\\cdots,b_N$ 表示），当且仅当存在这样的 $i$，使得（$\\forall j < i$）$a_j = b_j$ 和 （$a_i < b_i$）。（也就是说，比较两个围栏中哪个在清单中更早相当于取它们对应的排列，找出它们第一个不同的地方，并比较这个地方的值。）所有 $N$ 块木板的可爱围栏都被按照它们在清单中出现的顺序编号（从 $1$ 开始）。这个号码被称为他们的清单号。 \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/9kopwi5p.png)\n仔细检查所有的可爱的小木栅栏后，理查德决定要它们中的一些。他记下木板的数量 $N$ 和清单号 $C$。后来，他遇到了他的朋友，他想向他们展示他围栏，但他失去了清单。他得到的唯一的事情是他的笔记。请帮助他查明，他的围栏将为何等样子。", "inputFormat": "第一行包含一个整数 $K$。接下来 $K$ 行，每行描述一个输入数据集，每一行都包含两个以空格分割的整数 $N$ 和 $C$，$N$ 是围栏上木板的数量，$C$ 是围栏的栅栏的清单号。", "outputFormat": "每个数据集输出一行，描述列表带有 $N$ 个木板的第 $C$ 个栅栏。更准确地说，如果栅栏排列 $a_1,\\cdots,a_N$，则输出的相应行应包含数字 $a_i$（按正确顺序），由单个空格分隔。", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$1 \\leq K \\leq 100$，$1 \\leq N \\leq 20$。你可以认为，$20$ 块木板的可爱小木栅栏的总数适合转换为 $64$ 位有符号整数变量（C/C++ 中的 `long long`，FreePascal 中的 `int64`）。你也可以认为输入是正确的，特别是 $C$ 最小是 $1$ 并且它不超过有 $N$ 块木板的可爱围栏的数量。  \n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2002 的 [A decorative fence](https://web.ics.upjs.sk/ceoi/documents/tasks/fence-tsk.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7692", "type": "P", "difficulty": 5, "samples": [["4\n0 2\n2 1\n3 8\n6 3", "2\n3 4\n1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384]}, "tags": ["2003", "树状数组", "CEOI（中欧）"], "title": "[CEOI 2003] The Race", "background": "", "description": "在一年一度的调谐宇宙飞船星际竞赛中，$N$ 艘宇宙飞船将参赛。每艘宇宙飞船 $i$ 的调谐方式都是这样的，它可以在零时间内加速到它的最大速度 $V_i$ 并继续以那个速度巡航。由于过去的成就，每艘宇宙飞船都从一个起始位置出发，给定其飞船离起跑线的距离。  \n赛程无限长。因为宇宙飞船速度很快，比赛的路线一直都是笔直的。在直线赛道上，飞船可以很容易地相互通过，而没有互相干扰。  \n很多观众还没有意识到，比赛的胜负是可以提前预测的。你的任务是向他们展示这一点，告诉他们宇宙飞船将相互经过多少次，并通过按时间顺序预测宇宙飞船经过的前 $10000$ 次。  \n您可以假设每艘宇宙飞船都从不同的位置开始。此外，任何时候在赛道的同一位置上永远不会有超过两艘飞船。   \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/437urrvu.png)", "inputFormat": "第一行包含一个整数 $N$ 指定了正在竞争的飞船的数量。接下来的 $N$ 行中的每一行都描述了一艘宇宙飞船的特性。第 $i+1$ 行用两个整数 $X_i$ 和 $V_i$ 描述第 $i$ 艘飞船，表示第 $i$ 艘飞船的起始位置和速度。飞船按照起始位置排序，即 $X_1 < X_2 < \\cdots < X_N$。 起始位置是飞船开始的起点线后的公里数，速度以千米每秒为单位。", "outputFormat": "第一行应该包含一个整数为飞船在比赛中相互通过的次数，并对 $1000000$ 取模。接下来的每一行都应该按时间顺序表示一个经过。如果要通过 $10000$ 次以上，只输出前 $10000$ 次。如果小于 $10000$ 次，输出所有的次。每一行应该由两个整数 $i$ 和 $j$ 组成，指定飞船 $i$ 经过飞船 $j$。如果多次相互通过同时发生，它们必须按此次赛道位置排序。这意味着发生在起跑线附近的相互通过必须首先列出。路过的时间是两艘宇宙飞船在同一位置的时间", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$0 < N \\leq 250 000$，$0 \\leq X_i \\leq 1 000 000$，$0 < V_i < 100$。\n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2003 的 [The Race](https://www.ceoi2003.de/www/downloads/therace-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2003] The Race", "background": "", "description": "在一年一度的调谐宇宙飞船星际竞赛中，$N$ 艘宇宙飞船将参赛。每艘宇宙飞船 $i$ 的调谐方式都是这样的，它可以在零时间内加速到它的最大速度 $V_i$ 并继续以那个速度巡航。由于过去的成就，每艘宇宙飞船都从一个起始位置出发，给定其飞船离起跑线的距离。  \n赛程无限长。因为宇宙飞船速度很快，比赛的路线一直都是笔直的。在直线赛道上，飞船可以很容易地相互通过，而没有互相干扰。  \n很多观众还没有意识到，比赛的胜负是可以提前预测的。你的任务是向他们展示这一点，告诉他们宇宙飞船将相互经过多少次，并通过按时间顺序预测宇宙飞船经过的前 $10000$ 次。  \n您可以假设每艘宇宙飞船都从不同的位置开始。此外，任何时候在赛道的同一位置上永远不会有超过两艘飞船。   \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/437urrvu.png)", "inputFormat": "第一行包含一个整数 $N$ 指定了正在竞争的飞船的数量。接下来的 $N$ 行中的每一行都描述了一艘宇宙飞船的特性。第 $i+1$ 行用两个整数 $X_i$ 和 $V_i$ 描述第 $i$ 艘飞船，表示第 $i$ 艘飞船的起始位置和速度。飞船按照起始位置排序，即 $X_1 < X_2 < \\cdots < X_N$。 起始位置是飞船开始的起点线后的公里数，速度以千米每秒为单位。", "outputFormat": "第一行应该包含一个整数为飞船在比赛中相互通过的次数，并对 $1000000$ 取模。接下来的每一行都应该按时间顺序表示一个经过。如果要通过 $10000$ 次以上，只输出前 $10000$ 次。如果小于 $10000$ 次，输出所有的次。每一行应该由两个整数 $i$ 和 $j$ 组成，指定飞船 $i$ 经过飞船 $j$。如果多次相互通过同时发生，它们必须按此次赛道位置排序。这意味着发生在起跑线附近的相互通过必须首先列出。路过的时间是两艘宇宙飞船在同一位置的时间", "hint": "#### 数据规模与约定  \n对于 $100 \\%$ 的数据，$0 < N \\leq 250 000$，$0 \\leq X_i \\leq 1 000 000$，$0 < V_i < 100$。\n#### 题目说明  \n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2003 的 [The Race](https://www.ceoi2003.de/www/downloads/therace-en.pdf)。  \n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7693", "type": "P", "difficulty": 0, "samples": [["7\n1 0 0 1 1 0 1 0 1 1 0 0 1 1", "1 0 1 1 0 1 1"], ["3\n0 0 0 1 1 1", "-1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384]}, "tags": ["2003", "Special Judge", "CEOI（中欧）"], "title": "[CEOI 2003] Shift Register", "background": null, "description": "计算机的寄存器存储 $N$ 位用于计算。移位寄存器是一种特殊的寄存器，其位值可以很容易地移位一位。\n\n使用反馈移位寄存器，可以通过以下方式生成二进制伪随机数：\n- 大小为 $N$ 的移位寄存器最初填充位值 $a_1,a_2,\\cdots,a_N$。\n- 每次，寄存器输出其最右边位的值 $a_N$。其他位值向右移动一个位置。第一个位置被分配一个新值 $a_1^{\\prime}$，如下所示：\n  - 寄存器的每一位都通过一个开关连接到一个异或门（见下图）。对于每个位 $i$，有一个开关 $s_i$（可以是 $1$ 或 $0$），用于确定位值 $a_i$ 是否被转发到 XOR 门。\n  - 令 $k_i=s_i\\cdot a_i$。新值 $a_1^{\\prime}$ 被设置为 XOR 门的输出值 XOR（$k_1,\\cdots, k_N$）。\n- 注：如果 $k_1,\\cdots,k_N$ 中 $1$ 的个数为奇数，则 XOR（$k_1,\\cdots,k_N$）的值为 $1$，否则为 $0$）。以下是正式定义：\n$$a_1^{\\prime}=XOR(k_1,\\cdots,k_N)$$\n$$a_i^{\\prime}=a_{i−1}\\ \\text{for}\\ 2\\le i\\le N$$\n$$\\text{output}=a_N$$  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/3fqp3iwp.png)\n \n在上面的例子中，第一次的值 $a_1$ 计算如下：$\\text{XOR}(1\\cdot 1,0\\cdot 0,1\\cdot 1,1\\cdot 1,0\\cdot 0,1\\cdot 0,1\\cdot 1)=0$。\n\n您将获得此类反馈移位寄存器的前 $2N$ 个输出值。从这些值中，您将尝试确定开关值 $s_i$。", "inputFormat": "第一行包含一个整数 $N$，表示移位寄存器的大小。\n\n第二行包含 $2N$ 个数字 `0` 或 `1`，表示移位的前 $2N$ 个输出位值。", "outputFormat": "输出只包含一行。\n- 如果至少有一个开关设置产生给定的寄存器输出值，输出一行 $N$ 个整数，其中第 $i$ 个整数代表第 $i$ 个开关值 $s_i$。任何此类开关设置的开关值都会被接受。\n- 如果没有这样的开关设置，只输出 `-1`。", "hint": "#### 数据规模与约定\n对于 $100\\%$ 的数据，$1\\le N\\le 750$。  \n#### 题目说明\n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2003 的 [Shift Register](https://www.ceoi2003.de/www/downloads/register-en.ps)。\n\n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2003] Shift Register", "background": null, "description": "计算机的寄存器存储 $N$ 位用于计算。移位寄存器是一种特殊的寄存器，其位值可以很容易地移位一位。\n\n使用反馈移位寄存器，可以通过以下方式生成二进制伪随机数：\n- 大小为 $N$ 的移位寄存器最初填充位值 $a_1,a_2,\\cdots,a_N$。\n- 每次，寄存器输出其最右边位的值 $a_N$。其他位值向右移动一个位置。第一个位置被分配一个新值 $a_1^{\\prime}$，如下所示：\n  - 寄存器的每一位都通过一个开关连接到一个异或门（见下图）。对于每个位 $i$，有一个开关 $s_i$（可以是 $1$ 或 $0$），用于确定位值 $a_i$ 是否被转发到 XOR 门。\n  - 令 $k_i=s_i\\cdot a_i$。新值 $a_1^{\\prime}$ 被设置为 XOR 门的输出值 XOR（$k_1,\\cdots, k_N$）。\n- 注：如果 $k_1,\\cdots,k_N$ 中 $1$ 的个数为奇数，则 XOR（$k_1,\\cdots,k_N$）的值为 $1$，否则为 $0$）。以下是正式定义：\n$$a_1^{\\prime}=XOR(k_1,\\cdots,k_N)$$\n$$a_i^{\\prime}=a_{i−1}\\ \\text{for}\\ 2\\le i\\le N$$\n$$\\text{output}=a_N$$  \n![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/3fqp3iwp.png)\n \n在上面的例子中，第一次的值 $a_1$ 计算如下：$\\text{XOR}(1\\cdot 1,0\\cdot 0,1\\cdot 1,1\\cdot 1,0\\cdot 0,1\\cdot 0,1\\cdot 1)=0$。\n\n您将获得此类反馈移位寄存器的前 $2N$ 个输出值。从这些值中，您将尝试确定开关值 $s_i$。", "inputFormat": "第一行包含一个整数 $N$，表示移位寄存器的大小。\n\n第二行包含 $2N$ 个数字 `0` 或 `1`，表示移位的前 $2N$ 个输出位值。", "outputFormat": "输出只包含一行。\n- 如果至少有一个开关设置产生给定的寄存器输出值，输出一行 $N$ 个整数，其中第 $i$ 个整数代表第 $i$ 个开关值 $s_i$。任何此类开关设置的开关值都会被接受。\n- 如果没有这样的开关设置，只输出 `-1`。", "hint": "#### 数据规模与约定\n对于 $100\\%$ 的数据，$1\\le N\\le 750$。  \n#### 题目说明\n来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2003 的 [Shift Register](https://www.ceoi2003.de/www/downloads/register-en.ps)。\n\n由 @[求学的企鹅](/user/271784) 翻译整理。", "locale": "zh-CN"}}}
{"pid": "P7694", "type": "P", "difficulty": 1, "samples": [["Knuth-Morris-Pratt", "KMP"], ["Mirko-Slavko", "MS"], ["Pasko-Patak", "PP"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #4] AUTORI", "background": "伟大的科学发现一般是以科学家的姓氏命名，比如说，最流行的非对称密码系统 RSA 是由三位叫做 Rivest、Shamir 和 Adleman 的科学家发现的，而更为熟知的则是 Knuth-Morris-Pratt 算法，这个算法是由三位叫做 Knuth、Morris 和 Pratt 的科学家命名的。", "description": "科学论文会大量引用一些早期的著作，因此在一个论文中出现两种不同的命名约定并不少见。这两种不同的命名约定分别是：\n\n- 长变体，由每个作者姓氏的完整单词由连字符连接而成，例如 `Knuth-Morris-Pratt`。\n- 短变体，仅由每个作者姓氏的第一个字符拼接而成，例如 `KMP`。\n\n现在，你发现了一篇论文中同时使用了长变体和短变体这两种命名约定，这让你感到很不愉快，因此你想编写一个程序，将所有的长变体变为短变体。", "inputFormat": "输入仅一行，一个字符串，代表在论文中出现的长变体。\n\n每一个长变体中的单词开头**一定是大写字母**。", "outputFormat": "输出仅一行，一个字符串，代表长变体经过变换以后的短变体。", "hint": "**【数据范围】**\n\n对于所有数据，满足字符串的长度不超过 $100$，且仅包含大小写英文字母和连字符 `-`。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T1 AUTORI_**，按照原题数据配置，满分 $30$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #4] AUTORI", "background": "伟大的科学发现一般是以科学家的姓氏命名，比如说，最流行的非对称密码系统 RSA 是由三位叫做 Rivest、Shamir 和 Adleman 的科学家发现的，而更为熟知的则是 Knuth-Morris-Pratt 算法，这个算法是由三位叫做 Knuth、Morris 和 Pratt 的科学家命名的。", "description": "科学论文会大量引用一些早期的著作，因此在一个论文中出现两种不同的命名约定并不少见。这两种不同的命名约定分别是：\n\n- 长变体，由每个作者姓氏的完整单词由连字符连接而成，例如 `Knuth-Morris-Pratt`。\n- 短变体，仅由每个作者姓氏的第一个字符拼接而成，例如 `KMP`。\n\n现在，你发现了一篇论文中同时使用了长变体和短变体这两种命名约定，这让你感到很不愉快，因此你想编写一个程序，将所有的长变体变为短变体。", "inputFormat": "输入仅一行，一个字符串，代表在论文中出现的长变体。\n\n每一个长变体中的单词开头**一定是大写字母**。", "outputFormat": "输出仅一行，一个字符串，代表长变体经过变换以后的短变体。", "hint": "**【数据范围】**\n\n对于所有数据，满足字符串的长度不超过 $100$，且仅包含大小写英文字母和连字符 `-`。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T1 AUTORI_**，按照原题数据配置，满分 $30$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7695", "type": "P", "difficulty": 1, "samples": [["1", "9"], ["2", "25"], ["5", "1089"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #4] PLANINA", "background": "Mirko 和 Slavko 正在拍摄一部改编自科幻小说 _Chicks in space 13_ 的电影。剧本要求他们呈现出不同的世界，所以他们决定在绿屏幕前拍摄整部电影，之后再添加 CGI 背景。Mirko 听说生成人工地形最好的办法是使用**中点位移算法**。", "description": "为了执行这个算法，Mirko 选择了 $4$ 个点组成了一个完美正方形。然后他开始执行以下步骤：\n\n- 在每个正方形的每一条边上，Mirko 都在正中间添加一个新点。这个新点上的地形高度是他所在这条边两个点上的平均高度。\n- 在每个正方形的正中间，Mirko 也添加了一个新点。这个新点上的地形高度是所有 $4$ 个正方形定点的平均高度加上一个小的随机值。\n\nMirko 在执行完一次上面的所有操作后拥有了 $4$ 个新的方块。于是他不断地新建正方形，直到他对结果满意为止。下图说明了算法的初始状态、$1$ 次迭代和 $2$ 次迭代。\n![](https://cdn.luogu.com.cn/upload/image_hosting/p16l99h1.png)\n\nMirko 发现到有些点属于不止一个正方形，为了减少内存消耗，他只存储这些点一次，但是**一旦这个点存储进去了，它就会永远储存在内存中**。现在他想请你编写一个程序，告诉他经过 $n$ 次迭代之后，总共需要在内存中存储多少点。", "inputFormat": "输入仅一个整数 $n$，表示迭代的次数。", "outputFormat": "输出仅一个整数，表示 $n$ 次迭代后内存内需要存储的点数。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 15$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T2 PLANINA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #4] PLANINA", "background": "Mirko 和 Slavko 正在拍摄一部改编自科幻小说 _Chicks in space 13_ 的电影。剧本要求他们呈现出不同的世界，所以他们决定在绿屏幕前拍摄整部电影，之后再添加 CGI 背景。Mirko 听说生成人工地形最好的办法是使用**中点位移算法**。", "description": "为了执行这个算法，Mirko 选择了 $4$ 个点组成了一个完美正方形。然后他开始执行以下步骤：\n\n- 在每个正方形的每一条边上，Mirko 都在正中间添加一个新点。这个新点上的地形高度是他所在这条边两个点上的平均高度。\n- 在每个正方形的正中间，Mirko 也添加了一个新点。这个新点上的地形高度是所有 $4$ 个正方形定点的平均高度加上一个小的随机值。\n\nMirko 在执行完一次上面的所有操作后拥有了 $4$ 个新的方块。于是他不断地新建正方形，直到他对结果满意为止。下图说明了算法的初始状态、$1$ 次迭代和 $2$ 次迭代。\n![](https://cdn.luogu.com.cn/upload/image_hosting/p16l99h1.png)\n\nMirko 发现到有些点属于不止一个正方形，为了减少内存消耗，他只存储这些点一次，但是**一旦这个点存储进去了，它就会永远储存在内存中**。现在他想请你编写一个程序，告诉他经过 $n$ 次迭代之后，总共需要在内存中存储多少点。", "inputFormat": "输入仅一个整数 $n$，表示迭代的次数。", "outputFormat": "输出仅一个整数，表示 $n$ 次迭代后内存内需要存储的点数。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 15$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T2 PLANINA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7696", "type": "P", "difficulty": 3, "samples": [["3\n4 4 1", "2 1"], ["3\n8 24 9", "12 3"], ["5\n4 5 6 7 8", "2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #4] IKS", "background": "Mirko 的伟大的曾祖母 Katica 是一位狂热的数学家，她喜欢用数学游戏折磨她的曾孙。", "description": "这一天，她在一张纸上写下了一个 $n$ 个数字的序列，并告知 Mirko 可以做如下操作若干次：\n\n- 选取序列中的两个数字（我们不妨称之为 $A,B$），然后选取能整除 $A$ 的质数 $X$。之后，Mirko 把 $A$ 擦去并在原来的位置上写下 $\\frac AX$，然后他把 $B$ 擦去并在原来的位置上写下 $B\\times X$。\n\nMirko 希望得到最大分数，因为这样他可以从他的曾祖母那里得到糖果。一个包含 $n$ 个数字的序列的分数是**这 $n$ 个数字的最大公因数**。\n\nMirko 并不擅长这个，但又很想希望得到糖果，因此找到了你，希望你能编写一个程序计算最大的可能分数，同时他也希望你能够得出在得到最大可能的分数的前提下最少应当执行的操作数。", "inputFormat": "输入共两行。\n\n第一行一个整数 $n$，代表序列中的元素个数。  \n第二行包含 $n$ 个整数，描述 Katica 给 Mirko 的序列。", "outputFormat": "输出仅一行两个整数，第一个整数表示 Mirko 最大能够得到的分数，第二个整数表示 Mirko 在能够获得最大的分数的前提下最少应当执行的操作数。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，Mirko 可以选择序列中的 $4$ 和 $1$ 两个数，并选择 $4$ 的唯一质因子 $2$。之后 Mirko 将 $4$ 和 $1$ 擦去，并在它们原来所在的位置上都写下了 $2$，这样这个序列的分数是 $2$。可以证明这样的方案可以获得最大的分数并且在此前提下操作数最少。\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 100$，序列中的元素不超过 $10^6$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T3 IKS_**，按照原题数据配置，满分 $70$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #4] IKS", "background": "Mirko 的伟大的曾祖母 Katica 是一位狂热的数学家，她喜欢用数学游戏折磨她的曾孙。", "description": "这一天，她在一张纸上写下了一个 $n$ 个数字的序列，并告知 Mirko 可以做如下操作若干次：\n\n- 选取序列中的两个数字（我们不妨称之为 $A,B$），然后选取能整除 $A$ 的质数 $X$。之后，Mirko 把 $A$ 擦去并在原来的位置上写下 $\\frac AX$，然后他把 $B$ 擦去并在原来的位置上写下 $B\\times X$。\n\nMirko 希望得到最大分数，因为这样他可以从他的曾祖母那里得到糖果。一个包含 $n$ 个数字的序列的分数是**这 $n$ 个数字的最大公因数**。\n\nMirko 并不擅长这个，但又很想希望得到糖果，因此找到了你，希望你能编写一个程序计算最大的可能分数，同时他也希望你能够得出在得到最大可能的分数的前提下最少应当执行的操作数。", "inputFormat": "输入共两行。\n\n第一行一个整数 $n$，代表序列中的元素个数。  \n第二行包含 $n$ 个整数，描述 Katica 给 Mirko 的序列。", "outputFormat": "输出仅一行两个整数，第一个整数表示 Mirko 最大能够得到的分数，第二个整数表示 Mirko 在能够获得最大的分数的前提下最少应当执行的操作数。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，Mirko 可以选择序列中的 $4$ 和 $1$ 两个数，并选择 $4$ 的唯一质因子 $2$。之后 Mirko 将 $4$ 和 $1$ 擦去，并在它们原来所在的位置上都写下了 $2$，这样这个序列的分数是 $2$。可以证明这样的方案可以获得最大的分数并且在此前提下操作数最少。\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 100$，序列中的元素不超过 $10^6$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T3 IKS_**，按照原题数据配置，满分 $70$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7697", "type": "P", "difficulty": 4, "samples": [["5 3\n5 3 4 4 5", "3\n2"], ["10 3\n3 3 3 3 3 3 3 3 3 3", "0\n4"], ["7 4\n1 2 3 4 3 2 1", "4\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #4] OGRADA", "background": "Matjia 需要粉刷他的旧篱笆。", "description": "篱笆是由 $n$ 块木板做成的，每块木板宽 $1$ 厘米，高度不一。为了方便快捷，他给自己买了一个宽 $x$ 厘米的超级油漆辊。然而超级油漆辊来了一个陷阱——Matija 必须始终使辊子紧密地整个接触木板，否则油漆会滴到四周并污渍所有东西。此外，辊子必须始终与地面平行，以防泄漏。这意味着为了让 Matija 安全地使用压路机，他需要选择 $x$ 块木板，并从最下面的木板的底部到顶部一次涂上油漆。然后，他选择一些其他的木板，油漆它们，以此类推。\n\n这使得一些木板的部分没有上漆。Matija 必须用牙刷刷这些部分。这显然是相当乏味的，所以他请你帮他编写一个程序，求出他需要手动刷漆的最小面积。因为有不止一种方法可以做到这一点，他也想知道需要使用超级油漆辊的最少次数。", "inputFormat": "输入共两行。\n\n第一行两个整数 $n,x$，分别代表木板的个数和超级油漆辊的宽度。  \n第二行 $n$ 个正整数 $h_1,h_2,\\dots,h_n$，表示每个木板的高度。", "outputFormat": "输出共两行。\n\n第一行一个整数，表示 Matjia 需要手动刷漆的最小面积。  \n第二行一个整数，表示在手动刷漆的面积最小的前提下，需要使用超级油漆辊的最少次数。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，Matjia 需要使用两次超级油漆辊。\n\n- 第一次，用超级油漆辊粉刷第 $1,2,3$ 个木板，粉刷高度为 $3\\text{ cm}$，因此粉刷面积为 $9\\text{ cm}^2$。\n- 第二次，用超级油漆辊粉刷第 $3,4,5$ 个木板，粉刷高度为 $4\\text{ cm}$，因此粉刷面积为 $12\\text{ cm}^2$。\n\n因为两次粉刷有 $3\\text{ cm}^2$ 的面积重叠，因此剩下的需要手动粉刷的面积为 $5+3+4+4+5-9-12+3=3\\text{ cm}^2$。可以证明这样的方案需要手动粉刷的面积是最小的并且使用超级油漆辊的次数也是最少的。\n\n具体可以结合下图理解：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hrjc66u8.png)\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 10^6$，$1\\leqslant x\\leqslant 10^5$，$1\\leqslant h_i<10^6$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T4 OGRADA_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #4] OGRADA", "background": "Matjia 需要粉刷他的旧篱笆。", "description": "篱笆是由 $n$ 块木板做成的，每块木板宽 $1$ 厘米，高度不一。为了方便快捷，他给自己买了一个宽 $x$ 厘米的超级油漆辊。然而超级油漆辊来了一个陷阱——Matija 必须始终使辊子紧密地整个接触木板，否则油漆会滴到四周并污渍所有东西。此外，辊子必须始终与地面平行，以防泄漏。这意味着为了让 Matija 安全地使用压路机，他需要选择 $x$ 块木板，并从最下面的木板的底部到顶部一次涂上油漆。然后，他选择一些其他的木板，油漆它们，以此类推。\n\n这使得一些木板的部分没有上漆。Matija 必须用牙刷刷这些部分。这显然是相当乏味的，所以他请你帮他编写一个程序，求出他需要手动刷漆的最小面积。因为有不止一种方法可以做到这一点，他也想知道需要使用超级油漆辊的最少次数。", "inputFormat": "输入共两行。\n\n第一行两个整数 $n,x$，分别代表木板的个数和超级油漆辊的宽度。  \n第二行 $n$ 个正整数 $h_1,h_2,\\dots,h_n$，表示每个木板的高度。", "outputFormat": "输出共两行。\n\n第一行一个整数，表示 Matjia 需要手动刷漆的最小面积。  \n第二行一个整数，表示在手动刷漆的面积最小的前提下，需要使用超级油漆辊的最少次数。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，Matjia 需要使用两次超级油漆辊。\n\n- 第一次，用超级油漆辊粉刷第 $1,2,3$ 个木板，粉刷高度为 $3\\text{ cm}$，因此粉刷面积为 $9\\text{ cm}^2$。\n- 第二次，用超级油漆辊粉刷第 $3,4,5$ 个木板，粉刷高度为 $4\\text{ cm}$，因此粉刷面积为 $12\\text{ cm}^2$。\n\n因为两次粉刷有 $3\\text{ cm}^2$ 的面积重叠，因此剩下的需要手动粉刷的面积为 $5+3+4+4+5-9-12+3=3\\text{ cm}^2$。可以证明这样的方案需要手动粉刷的面积是最小的并且使用超级油漆辊的次数也是最少的。\n\n具体可以结合下图理解：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hrjc66u8.png)\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 10^6$，$1\\leqslant x\\leqslant 10^5$，$1\\leqslant h_i<10^6$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T4 OGRADA_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7700", "type": "P", "difficulty": 2, "samples": [["5 2\n12 12\n10 100\n8 3\n4 5\n25 15", "25\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "2014", "CCC（加拿大）"], "title": "[CCC 2014] 燃料搜集", "background": "", "description": "英勇的狐狸星小队正在执行任务。他们的任务是从莱拉星系的不同的星球上搜集尽可能多的燃料。莱拉星系里有 $n$ 个星球，第 $i$ 个星球有 $a_i$ 单位燃料，但是从任何星球去那里都要花费 $b_i$ 单位燃料。不幸的是，燃料不是一种可再生资源，所以如果你第二次到访一个星球，你在那里将搜集不到新的燃料。\n\n狐狸星小队在星球 $P$，所以他们可以立马搜集这个星球的燃料，然后他们就可以去执行任务了。只要他们的燃料足够，即完成飞行后他们剩余的燃料量是非负的，他们就可以以任意顺序访问星球。最后，他们可能会在任何星球选择停下来，甚至可能连星球 $P$ 都没离开过就停下来。他们的目标是使搜集到的燃料量最大化，如果有很多种方法可以达到这个目标，他们还想使他们访问过的不同星球的个数最大化，你能帮助他们吗？", "inputFormat": "第一行两个整数 $n,P$，以空格分隔，分别表示星球数和起始星球编号。\n\n接下来 $n$ 行每行两个整数 $a_i,b_i$。", "outputFormat": "输出包含两行，每行一个正整数。\n\n第一行表示当他们停下来时狐狸星小队能搜集到的燃料的最大值。\n\n第二行表示在搜集到第一行所述燃料量的前提下能访问到的最大的不同星球数。", "hint": "一个最优的方案是，狐狸星小队搜集完星球 $2$ 即起点的燃料后从该出发，依次访问并搜集星球 $3,1,5$ 上的燃料，途中花费分别为 $3,12,15$，从起点开始各个星球上完成搜集后剩余燃料分别为 $10,15,15,25$。他们此时不应该选择去星球 $4$ 而是应该选择停下来以使结束时搜集到的燃料量最大化。\n\n对于 $20\\%$ 的测试数据，$1\\le n\\le10$；\n\n对于 $100\\%$ 的测试数据，$1\\le P\\le n\\le10^5$，$a_i,b_i\\le10^5$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCC 2014] 燃料搜集", "background": "", "description": "英勇的狐狸星小队正在执行任务。他们的任务是从莱拉星系的不同的星球上搜集尽可能多的燃料。莱拉星系里有 $n$ 个星球，第 $i$ 个星球有 $a_i$ 单位燃料，但是从任何星球去那里都要花费 $b_i$ 单位燃料。不幸的是，燃料不是一种可再生资源，所以如果你第二次到访一个星球，你在那里将搜集不到新的燃料。\n\n狐狸星小队在星球 $P$，所以他们可以立马搜集这个星球的燃料，然后他们就可以去执行任务了。只要他们的燃料足够，即完成飞行后他们剩余的燃料量是非负的，他们就可以以任意顺序访问星球。最后，他们可能会在任何星球选择停下来，甚至可能连星球 $P$ 都没离开过就停下来。他们的目标是使搜集到的燃料量最大化，如果有很多种方法可以达到这个目标，他们还想使他们访问过的不同星球的个数最大化，你能帮助他们吗？", "inputFormat": "第一行两个整数 $n,P$，以空格分隔，分别表示星球数和起始星球编号。\n\n接下来 $n$ 行每行两个整数 $a_i,b_i$。", "outputFormat": "输出包含两行，每行一个正整数。\n\n第一行表示当他们停下来时狐狸星小队能搜集到的燃料的最大值。\n\n第二行表示在搜集到第一行所述燃料量的前提下能访问到的最大的不同星球数。", "hint": "一个最优的方案是，狐狸星小队搜集完星球 $2$ 即起点的燃料后从该出发，依次访问并搜集星球 $3,1,5$ 上的燃料，途中花费分别为 $3,12,15$，从起点开始各个星球上完成搜集后剩余燃料分别为 $10,15,15,25$。他们此时不应该选择去星球 $4$ 而是应该选择停下来以使结束时搜集到的燃料量最大化。\n\n对于 $20\\%$ 的测试数据，$1\\le n\\le10$；\n\n对于 $100\\%$ 的测试数据，$1\\le P\\le n\\le10^5$，$a_i,b_i\\le10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P7701", "type": "P", "difficulty": 4, "samples": [["5 5 3 4\n3E\n1D\n5C\n1E\n4A", "55"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "2014", "树状数组", "排序", "CCC（加拿大）"], "title": "[CCC 2014] 提前交卷", "background": "", "description": "你正在一个狭窄而又长的礼堂里考试，礼堂一共有 $n$ 排，标号从前到后分别为 $1$ 到 $n$。每排有 $6$ 个座位，左边 $3$ 个，右边 $3$ 个，中间是过道。每个座位都有一个从 A 到 F 的字母标识，其中最左的座位的标识是 A，最右的座位的标识是 F，过道在座位标识为 C 和 D 的座位之间，礼堂同时还有两个保密室，一个在最前面（第一排前面），一个在最后面（第 $n$ 排后面）。\n\n礼堂里的每个座位一开始被刚好一个考生占用。然而，在考试过程中，$m$ 个不同的考生决定完成所有他们会做的题后依次离开礼堂。第 $i$ 个考生在座位 $r_ic_i$，其中 $c_i$ 是 A 到 F 的字母之一。当考生离开礼堂时，他们必须在任意一个保密室等待到考试结束。幸运的是，保密室能容下任意多的考生。\n\n考生不仅关心试题本身，他们还关心怎么样可以最舒服的考试。因此，他们协作以最小化他们的不满度之和。一个考生的不满度的计算方式是 $Ax+By$，其中 $A,B$ 为常数，$x$ 为去往保密室时经过的考生人数，具体将在下面详述，$y$ 是在考生进入保密室之前保密室内的人数。注意如果一个考生不离开他的考位，那么他的不满度为 $0$。\n\n当一个考生从一个考位走往保密室时，他在去往过道时必须先经过同排的考生，然后走过从这行到第一行或第 $n$ 行（取决于所选的保密室）的邻近过道的考生。注意走过空的座位不影响 $x$ 值。\n\n你能帮助他们最小化他们的不满度之和吗？", "inputFormat": "第一行四个整数 $n,m,A,B$，以空格分隔，分别表示礼堂内的排数、提前离开的考生数、不满度计算参数。\n\n接下来 $m$ 行每行一个整数 $r_i$ 和一个字母 $c_i$，其中 $1\\le i\\le n$。", "outputFormat": "输出一个整数，表示最小的不满度之和。", "hint": "其中一个最优策略是，第一个提前离开的考生去最前面的保密室，经过 $6$ 个考生（分别是 `3D`、`3C`、`2D`、`2C`、`1D`、`1C`），不满度为 $3\\times6+4\\times0=18$。第二个提前离开的考生也去最前面的保密室，只经过 $1$ 个考生，即 `1C`，然后他发现保密室里有 $1$ 个考生，不满度为 $7$。第三个提前离开的考生去最后面的保密室，经过 $1$ 个考生，不满度为 $3$。第四个提前离开的考生去最前面的保密室，经过 $1$ 个考生（因为座位 `1D` 是空的），不满度为 $11$。最后，第五个提前离开的考生去最后面的保密室，经过 $4$ 个考生，发现保密室里有 $1$ 个人，不满度为 $16$。所有考生总的不满度为 $55$。\n\n对于 $60\\%$ 的数据，$1\\le m\\le5000$；\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le m\\le6n$，$1\\le A,B\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCC 2014] 提前交卷", "background": "", "description": "你正在一个狭窄而又长的礼堂里考试，礼堂一共有 $n$ 排，标号从前到后分别为 $1$ 到 $n$。每排有 $6$ 个座位，左边 $3$ 个，右边 $3$ 个，中间是过道。每个座位都有一个从 A 到 F 的字母标识，其中最左的座位的标识是 A，最右的座位的标识是 F，过道在座位标识为 C 和 D 的座位之间，礼堂同时还有两个保密室，一个在最前面（第一排前面），一个在最后面（第 $n$ 排后面）。\n\n礼堂里的每个座位一开始被刚好一个考生占用。然而，在考试过程中，$m$ 个不同的考生决定完成所有他们会做的题后依次离开礼堂。第 $i$ 个考生在座位 $r_ic_i$，其中 $c_i$ 是 A 到 F 的字母之一。当考生离开礼堂时，他们必须在任意一个保密室等待到考试结束。幸运的是，保密室能容下任意多的考生。\n\n考生不仅关心试题本身，他们还关心怎么样可以最舒服的考试。因此，他们协作以最小化他们的不满度之和。一个考生的不满度的计算方式是 $Ax+By$，其中 $A,B$ 为常数，$x$ 为去往保密室时经过的考生人数，具体将在下面详述，$y$ 是在考生进入保密室之前保密室内的人数。注意如果一个考生不离开他的考位，那么他的不满度为 $0$。\n\n当一个考生从一个考位走往保密室时，他在去往过道时必须先经过同排的考生，然后走过从这行到第一行或第 $n$ 行（取决于所选的保密室）的邻近过道的考生。注意走过空的座位不影响 $x$ 值。\n\n你能帮助他们最小化他们的不满度之和吗？", "inputFormat": "第一行四个整数 $n,m,A,B$，以空格分隔，分别表示礼堂内的排数、提前离开的考生数、不满度计算参数。\n\n接下来 $m$ 行每行一个整数 $r_i$ 和一个字母 $c_i$，其中 $1\\le i\\le n$。", "outputFormat": "输出一个整数，表示最小的不满度之和。", "hint": "其中一个最优策略是，第一个提前离开的考生去最前面的保密室，经过 $6$ 个考生（分别是 `3D`、`3C`、`2D`、`2C`、`1D`、`1C`），不满度为 $3\\times6+4\\times0=18$。第二个提前离开的考生也去最前面的保密室，只经过 $1$ 个考生，即 `1C`，然后他发现保密室里有 $1$ 个考生，不满度为 $7$。第三个提前离开的考生去最后面的保密室，经过 $1$ 个考生，不满度为 $3$。第四个提前离开的考生去最前面的保密室，经过 $1$ 个考生（因为座位 `1D` 是空的），不满度为 $11$。最后，第五个提前离开的考生去最后面的保密室，经过 $4$ 个考生，发现保密室里有 $1$ 个人，不满度为 $16$。所有考生总的不满度为 $55$。\n\n对于 $60\\%$ 的数据，$1\\le m\\le5000$；\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le m\\le6n$，$1\\le A,B\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7702", "type": "P", "difficulty": 0, "samples": [["6 10 3 4\n2 3 15\n4 2 150\n3 6 290\n3 2\n2 3\n1 4\n4 6", "10.0\n4.0\n24.0\n6.25"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2014", "Special Judge", "CCC（加拿大）"], "title": "[CCC 2014] 登机口", "background": "", "description": "你现在正在一个有 $G$ 个登机口的机场里，登机口由 $1$ 到 $G$ 编号。第 $i$ 个登机口离机场入口有 $100i$ 米远。\n\n同时机场里还有 $N$ 个水平自动扶梯，第 $i$ 个水平自动扶梯单向地以每分钟 $S_i$ 米从登机口 $A_i$ 到另外一个登机口 $B_i$。在走道的任意一个点，相同方向（朝着机场入口或者远离机场入口）的水平自动扶梯至多只有一条在移动。然而，可能有两条水平自动扶梯从同一登机口出发且同向同终点。\n\n你可以以 $W$ 米每分钟的速度沿着走道走，当你在一个水平自动扶梯的起点时，你可以选择走上去，如果你选择了，它就会把你送到它的终点。即使该自动扶梯经过某个非起点或终点的位置，你不能在该位置离开或开始乘坐该水平自动扶梯。当你在水平自动扶梯 $i$ 上时，你的速度为 $W+S_i$ 米每分钟。\n\n当你在等你晚点的飞机时，为了找乐子，你问了自己 $Q$ 个问题，第 $i$ 个问题为寻找从登机口 $X$ 到登机口 $Y$ 的最短时间。为了使问题更加有趣，你决定不正确回答问题不登机，因此你最好不要把事情搞砸了！", "inputFormat": "第一行四个整数 $G,W,N,Q$，分别表示登机口数量、走路速度、水平自动扶梯数量、询问数量。\n\n接下来 $N$ 行每行三个整数 $A_i,B_i,S_i$，表示水平自动扶梯 $i$ 的起点和终点以及水平自动扶梯的速度。其中 $A_i\\ne B_i$。\n\n接下来 $Q$ 行每行两个整数 $X,Y$，表示起始登机口和目标登机口。", "outputFormat": "输出 $Q$ 行，每行一个实数，表示从登机口 $X$ 到登机口 $Y$ 最少要多少分钟。\n\n你的结果的正确性将以如下方式进行判断：如果 $D$ 是标准答案，那么在范围 $[D\\times (1-10^{-4}),D\\times (1+10^{-4})]$ 内的结果都被认为是正确的。", "hint": "对于第一个询问，你只需要从登机口 $3$ 走到登机口 $2$ 即可，两登机口间距离为 $100$ 米，你的速度为 $10$ 米每分钟。\n\n对于第二个询问，你应该乘坐从登机口 $2$ 到登机口 $3$ 的水平自动扶梯，距离为 $100$ 米，你的速度为 $25$ 米每分钟。\n\n对于第三个询问，你应该花费 $10$ 分钟走去登机口 $2$，然后花费 $4$ 分钟乘坐询问 $2$ 所述水平自动扶梯，接着花费 $10$ 分钟走去登机口 $4$。\n\n对于第四个询问，你应该花费 $1.25$ 分钟乘坐从登机口 $4$ 到登机口 $2$ 的水平自动扶梯，然后花费 $4$ 分钟坐登机口  到登机口 $2$ 的水平自动扶梯，最后花费 $3$ 分钟坐从登机口 $1$ 到登机口 $6$ 的飞机。\n\n对于某些数据，$G,N,Q$ 中至少一个值是较小的。这个信息也许有用，也许没用。\n\n对于 $100\\%$ 的数据，$1\\le A_i,B_i,X,Y\\le G\\le 10^9$，$1\\le N,Q\\le10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCC 2014] 登机口", "background": "", "description": "你现在正在一个有 $G$ 个登机口的机场里，登机口由 $1$ 到 $G$ 编号。第 $i$ 个登机口离机场入口有 $100i$ 米远。\n\n同时机场里还有 $N$ 个水平自动扶梯，第 $i$ 个水平自动扶梯单向地以每分钟 $S_i$ 米从登机口 $A_i$ 到另外一个登机口 $B_i$。在走道的任意一个点，相同方向（朝着机场入口或者远离机场入口）的水平自动扶梯至多只有一条在移动。然而，可能有两条水平自动扶梯从同一登机口出发且同向同终点。\n\n你可以以 $W$ 米每分钟的速度沿着走道走，当你在一个水平自动扶梯的起点时，你可以选择走上去，如果你选择了，它就会把你送到它的终点。即使该自动扶梯经过某个非起点或终点的位置，你不能在该位置离开或开始乘坐该水平自动扶梯。当你在水平自动扶梯 $i$ 上时，你的速度为 $W+S_i$ 米每分钟。\n\n当你在等你晚点的飞机时，为了找乐子，你问了自己 $Q$ 个问题，第 $i$ 个问题为寻找从登机口 $X$ 到登机口 $Y$ 的最短时间。为了使问题更加有趣，你决定不正确回答问题不登机，因此你最好不要把事情搞砸了！", "inputFormat": "第一行四个整数 $G,W,N,Q$，分别表示登机口数量、走路速度、水平自动扶梯数量、询问数量。\n\n接下来 $N$ 行每行三个整数 $A_i,B_i,S_i$，表示水平自动扶梯 $i$ 的起点和终点以及水平自动扶梯的速度。其中 $A_i\\ne B_i$。\n\n接下来 $Q$ 行每行两个整数 $X,Y$，表示起始登机口和目标登机口。", "outputFormat": "输出 $Q$ 行，每行一个实数，表示从登机口 $X$ 到登机口 $Y$ 最少要多少分钟。\n\n你的结果的正确性将以如下方式进行判断：如果 $D$ 是标准答案，那么在范围 $[D\\times (1-10^{-4}),D\\times (1+10^{-4})]$ 内的结果都被认为是正确的。", "hint": "对于第一个询问，你只需要从登机口 $3$ 走到登机口 $2$ 即可，两登机口间距离为 $100$ 米，你的速度为 $10$ 米每分钟。\n\n对于第二个询问，你应该乘坐从登机口 $2$ 到登机口 $3$ 的水平自动扶梯，距离为 $100$ 米，你的速度为 $25$ 米每分钟。\n\n对于第三个询问，你应该花费 $10$ 分钟走去登机口 $2$，然后花费 $4$ 分钟乘坐询问 $2$ 所述水平自动扶梯，接着花费 $10$ 分钟走去登机口 $4$。\n\n对于第四个询问，你应该花费 $1.25$ 分钟乘坐从登机口 $4$ 到登机口 $2$ 的水平自动扶梯，然后花费 $4$ 分钟坐登机口  到登机口 $2$ 的水平自动扶梯，最后花费 $3$ 分钟坐从登机口 $1$ 到登机口 $6$ 的飞机。\n\n对于某些数据，$G,N,Q$ 中至少一个值是较小的。这个信息也许有用，也许没用。\n\n对于 $100\\%$ 的数据，$1\\le A_i,B_i,X,Y\\le G\\le 10^9$，$1\\le N,Q\\le10^5$。", "locale": "zh-CN"}}}
{"pid": "P7703", "type": "P", "difficulty": 6, "samples": [["2\n5\n1 1 2 60 60\n4\n100 101 100 102", "1 1 -1 1 -1\n1 0 -1 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化"], "title": "「MCOI-09」Dream and Strings REMATCH", "background": "", "description": "给定 $N$ 以及非负整数序列 $a_1,a_2,\\dots,a_N$。\n\n请找到 **任何** 一个整数序列 $b_1,b_2,\\dots,b_N$ 满足 $\\sum |b_i|\\neq 0$，$|b_i|\\le 1$，和 $\\sum a_ib_i=0$。", "inputFormat": "第一行一个正整数 $T$。接下来 $T$ 组数据。\n\n每一组数据两行，第一行一个正整数 $N$，接下来一行 $N$ 个正整数 $a_1,a_2,\\dots,a_N$。", "outputFormat": "输出 $T$ 行，第 $T$ 行输出对应组数据的 $b$ 序列。\n\n如果无解，输出 $-1$。", "hint": "本样例不符合题意 $5000\\le N$ 的限制。\n\n**本题采用捆绑测试。**\n\n - Subtask 1（50 pts）：$10^5\\le N$\n - Subtask 2（50 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：$1\\le T\\le 20$，$5000\\le N\\le\\frac{10^5}{T}$，$0\\le a_i\\le 10^{18}$。**数据保证随机生成。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-09」Dream and Strings REMATCH", "background": "", "description": "给定 $N$ 以及非负整数序列 $a_1,a_2,\\dots,a_N$。\n\n请找到 **任何** 一个整数序列 $b_1,b_2,\\dots,b_N$ 满足 $\\sum |b_i|\\neq 0$，$|b_i|\\le 1$，和 $\\sum a_ib_i=0$。", "inputFormat": "第一行一个正整数 $T$。接下来 $T$ 组数据。\n\n每一组数据两行，第一行一个正整数 $N$，接下来一行 $N$ 个正整数 $a_1,a_2,\\dots,a_N$。", "outputFormat": "输出 $T$ 行，第 $T$ 行输出对应组数据的 $b$ 序列。\n\n如果无解，输出 $-1$。", "hint": "本样例不符合题意 $5000\\le N$ 的限制。\n\n**本题采用捆绑测试。**\n\n - Subtask 1（50 pts）：$10^5\\le N$\n - Subtask 2（50 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：$1\\le T\\le 20$，$5000\\le N\\le\\frac{10^5}{T}$，$0\\le a_i\\le 10^{18}$。**数据保证随机生成。**", "locale": "zh-CN"}}}
{"pid": "P7704", "type": "P", "difficulty": 5, "samples": [["2 2 6\n1\n6", "0\n25"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "「MCOI-09」Greedy Deletion", "background": "", "description": "小于等于 $n$ 的正整数形成集合 $S_n=\\{1,2,\\dots,n\\}$。\n\n删除值为 $i$ 的元素代价为 $i^k$，其中每一个元素至多被删一次。\n\n给定正整数 $n$ 和 $k$，求：最小代价使 $S_n$ 乘积变为完全平方数是什么？答案对 $998244353$ 取模。\n\n**注意你需要求最小代价，模 $998244353$，而不是模 $998244353$ 后的代价的最小值。**\n\n你需要回答 $T$ 组询问，其中所有 $k$ 相同。", "inputFormat": "第一行三个正整数 $T$，$k$，$\\max n$，分别表示询问数量，给定 $k$，以及最大 $n$。\n\n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "输出 $T$ 行，第 $i$ 行输出第 $i$ 组数据的答案。", "hint": "#### 样例 1 解释\n\n对于 $n=1$，$S_1$ 乘积为完全平方数，不需要删除。\n\n对于 $n=6$，可以删除 $5$ 使得 $S_6$ 乘积变为完全平方数。\n\n#### 数据规模与约定\n\n - Subtask 1（7 pts）：$\\max n\\le 20$。\n - Subtask 2（37 pts）：$\\max n\\le 1000$。\n - Subtask 3（11 pts）：$T\\le 1000$。\n - Subtask 4（45 pts）：无额外限制。\n\n对于 $100\\%$ 的数据，$1\\le \\max n\\le 5\\times 10^6$，$1\\le T\\le 5\\times 10^5$，$1\\le k< 998244353$。\n\n**保证** $1\\le n\\le \\max n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-09」Greedy Deletion", "background": "", "description": "小于等于 $n$ 的正整数形成集合 $S_n=\\{1,2,\\dots,n\\}$。\n\n删除值为 $i$ 的元素代价为 $i^k$，其中每一个元素至多被删一次。\n\n给定正整数 $n$ 和 $k$，求：最小代价使 $S_n$ 乘积变为完全平方数是什么？答案对 $998244353$ 取模。\n\n**注意你需要求最小代价，模 $998244353$，而不是模 $998244353$ 后的代价的最小值。**\n\n你需要回答 $T$ 组询问，其中所有 $k$ 相同。", "inputFormat": "第一行三个正整数 $T$，$k$，$\\max n$，分别表示询问数量，给定 $k$，以及最大 $n$。\n\n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "输出 $T$ 行，第 $i$ 行输出第 $i$ 组数据的答案。", "hint": "#### 样例 1 解释\n\n对于 $n=1$，$S_1$ 乘积为完全平方数，不需要删除。\n\n对于 $n=6$，可以删除 $5$ 使得 $S_6$ 乘积变为完全平方数。\n\n#### 数据规模与约定\n\n - Subtask 1（7 pts）：$\\max n\\le 20$。\n - Subtask 2（37 pts）：$\\max n\\le 1000$。\n - Subtask 3（11 pts）：$T\\le 1000$。\n - Subtask 4（45 pts）：无额外限制。\n\n对于 $100\\%$ 的数据，$1\\le \\max n\\le 5\\times 10^6$，$1\\le T\\le 5\\times 10^5$，$1\\le k< 998244353$。\n\n**保证** $1\\le n\\le \\max n$。", "locale": "zh-CN"}}}
{"pid": "P7705", "type": "P", "difficulty": 5, "samples": [["5 3 2 114514\n1 1\n1 3 1 1\n2 5 1 1\n1 5 2 0", "3 2 5 4 7"], ["20 5 4 1919810\n2 5 4 3\n1 20 1 1 1 1\n5 12 7 6 1 2\n2 18 9 0 0 1\n9 11 5 4 4 1\n10 14 1 0 0 0", "1 10 1 1 22 75 221 850 3176 11706 43324 160379 586060 249707 351705 931555 619201 372869 1800119 1750063\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["递推", "O2优化", "差分"], "title": "「Wdsr-2.7」天才⑨与数学递推式", "background": "", "description": "生活在雾之湖的冰精琪露诺，向来以智慧而著称。作为寺子屋的老学员，琪露诺可是对数学递推式了如指掌。\n\n有一天，慧音老师想要考一考琪露诺。于是她写出了一个长度为 $m$ 的递推公式：\n\n$$F_t=\\sum_{i=1}^m K_i\\times F_{t-i} \\quad (t> m)$$\n\n其中 $m,\\{K_i\\}$ 都是被给定的。不过，由于这个序列 $\\{F_i\\}$ 的初始 $m$ 项并没有被确定，所以可能存在无穷个满足这个递推式，但是初始 $m$ 项并不一致的递推数列。慧音打算选择其中 $q$ 个 $F$ ，来考考琪露诺对数列知识的掌握。\n\n具体而言，慧音会依次告诉琪露诺，若干个 $\\{F_i\\}$ 的起始 $m$ 项。显然，这样就能生成无穷序列 $\\{F_i\\}$ 了。尽管如此，生成这么多序列并不好玩。于是慧音又创造了一个答案序列 $\\{A_i\\}$ ，满足初始时 $A_i=0$ 。\n\n每当给出一个新的 $\\{F_i\\}$ ，慧音都要琪露诺使 $\\{A_i\\}$ 的第 $a,a+1,\\cdots b-1,b$ 项分别加上 $F_1,F_2,F_3,\\cdots,F_{b-a+1}$ 。\n\n当然，慧音老师不想为难琪露诺，于是对于所有数字，只要输出其对 $p$ 取模的值即可。其中 $p$ 是一个被给定的常数。\n\n---\n\n形式化地讲述题面：给定 $n,q,m,p,\\{K_1,K_2,\\cdots ,K_m\\}$ 。有 $q$ 次操作，每次给定一组 $a,b,\\{G_1,G_2\\cdots G_m\\}$ ，求出无穷序列 $\\{F_i\\}$ ：\n\n$$F_t=\\begin{cases}\nG_t & t\\le m \\cr\n\\sum_{i=1}^m K_iF_{t-i} & t>m\n\\end{cases}$$\n\n然后令 $\\forall i\\in [a,b] ,A_i\\gets A_i+F_{i-a+1}$ 。最后分别输出 $\\{A_i\\}$ 的前 $n$ 项对 $p$ 取模后的结果。", "inputFormat": "- 第一行有四个正整数 $n,q,m,p$ ，含义如题面所示。\n\n- 第二行有 $m$ 个整数 $\\{K_1,K_2,\\cdots ,K_m\\}$ ，表示递推式中的系数。\n\n- 接下来 $q$ 行，每行 $2+m$ 个整数 $a,b,\\{G_1,G_2,\\cdots G_m\\}$ ，描述一次操作。", "outputFormat": "- 共一行， $n$ 个整数，输出 $A_i \\bmod p$ 的值。", "hint": "#### 样例解释\n\n对于样例 $1$ ：\n\n- 初始时， $\\{A_i\\}=\\{0,0,0,0,0\\}$。\n\n- 第一步生成了一个 $\\{F_i\\}=\\{1,1,2,3,5\\}$ ，加至 $A_1,A_2,A_3$，此时 $\\{A_i\\}=\\{1,1,2,0,0\\}$。\n\n- 第二步生成了一个 $\\{F_i\\}=\\{1,1,2,3,5\\}$ ，加至 $A_2,A_3,\\cdots ,A_5$，此时 $\\{A_i\\}=\\{1,2,3,2,3\\}$。\n\n- 第三步生成了一个 $\\{F_i\\}=\\{2,0,2,2,4\\}$ ，加至 $A_1,A_2,\\cdots ,A_5$，此时 $\\{A_i\\}=\\{3,2,5,4,7\\}$。\n\n对于样例 $2$ ，我们既没有一个绝妙的解释，又没有足够大的空间，于是我们写不下了。\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n} & \\bm{m} & \\bm{q}& \\textbf{分值}\\cr\\hline\n1 & n\\le  10^4 & m\\le 10 & q\\le 10^3 & 10 \\cr\\hline\n2 & n\\le  10^5 & m=1 & q\\le 10^5  & 20\\cr\\hline\n3 & n\\le  10^5 & m=2 & q\\le 10^5 & 20\\cr\\hline\n4 & \\text{无特殊限制} & \\text{无特殊限制} & \\text{无特殊限制}& 50 \\cr\\hline\n\\end{array}$$\n\n- 对于 $100\\%$ 的数据，满足 $ 1 \\leq n\\le 1\\times 10^6;1\\le q \\leq 1.2 \\times 10^5;1 \\leq m \\leq 15;1 \\leq K_i,G_i,p \\leq 10^8;1\\le a\\le b\\le n$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.7」天才⑨与数学递推式", "background": "", "description": "生活在雾之湖的冰精琪露诺，向来以智慧而著称。作为寺子屋的老学员，琪露诺可是对数学递推式了如指掌。\n\n有一天，慧音老师想要考一考琪露诺。于是她写出了一个长度为 $m$ 的递推公式：\n\n$$F_t=\\sum_{i=1}^m K_i\\times F_{t-i} \\quad (t> m)$$\n\n其中 $m,\\{K_i\\}$ 都是被给定的。不过，由于这个序列 $\\{F_i\\}$ 的初始 $m$ 项并没有被确定，所以可能存在无穷个满足这个递推式，但是初始 $m$ 项并不一致的递推数列。慧音打算选择其中 $q$ 个 $F$ ，来考考琪露诺对数列知识的掌握。\n\n具体而言，慧音会依次告诉琪露诺，若干个 $\\{F_i\\}$ 的起始 $m$ 项。显然，这样就能生成无穷序列 $\\{F_i\\}$ 了。尽管如此，生成这么多序列并不好玩。于是慧音又创造了一个答案序列 $\\{A_i\\}$ ，满足初始时 $A_i=0$ 。\n\n每当给出一个新的 $\\{F_i\\}$ ，慧音都要琪露诺使 $\\{A_i\\}$ 的第 $a,a+1,\\cdots b-1,b$ 项分别加上 $F_1,F_2,F_3,\\cdots,F_{b-a+1}$ 。\n\n当然，慧音老师不想为难琪露诺，于是对于所有数字，只要输出其对 $p$ 取模的值即可。其中 $p$ 是一个被给定的常数。\n\n---\n\n形式化地讲述题面：给定 $n,q,m,p,\\{K_1,K_2,\\cdots ,K_m\\}$ 。有 $q$ 次操作，每次给定一组 $a,b,\\{G_1,G_2\\cdots G_m\\}$ ，求出无穷序列 $\\{F_i\\}$ ：\n\n$$F_t=\\begin{cases}\nG_t & t\\le m \\cr\n\\sum_{i=1}^m K_iF_{t-i} & t>m\n\\end{cases}$$\n\n然后令 $\\forall i\\in [a,b] ,A_i\\gets A_i+F_{i-a+1}$ 。最后分别输出 $\\{A_i\\}$ 的前 $n$ 项对 $p$ 取模后的结果。", "inputFormat": "- 第一行有四个正整数 $n,q,m,p$ ，含义如题面所示。\n\n- 第二行有 $m$ 个整数 $\\{K_1,K_2,\\cdots ,K_m\\}$ ，表示递推式中的系数。\n\n- 接下来 $q$ 行，每行 $2+m$ 个整数 $a,b,\\{G_1,G_2,\\cdots G_m\\}$ ，描述一次操作。", "outputFormat": "- 共一行， $n$ 个整数，输出 $A_i \\bmod p$ 的值。", "hint": "#### 样例解释\n\n对于样例 $1$ ：\n\n- 初始时， $\\{A_i\\}=\\{0,0,0,0,0\\}$。\n\n- 第一步生成了一个 $\\{F_i\\}=\\{1,1,2,3,5\\}$ ，加至 $A_1,A_2,A_3$，此时 $\\{A_i\\}=\\{1,1,2,0,0\\}$。\n\n- 第二步生成了一个 $\\{F_i\\}=\\{1,1,2,3,5\\}$ ，加至 $A_2,A_3,\\cdots ,A_5$，此时 $\\{A_i\\}=\\{1,2,3,2,3\\}$。\n\n- 第三步生成了一个 $\\{F_i\\}=\\{2,0,2,2,4\\}$ ，加至 $A_1,A_2,\\cdots ,A_5$，此时 $\\{A_i\\}=\\{3,2,5,4,7\\}$。\n\n对于样例 $2$ ，我们既没有一个绝妙的解释，又没有足够大的空间，于是我们写不下了。\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n} & \\bm{m} & \\bm{q}& \\textbf{分值}\\cr\\hline\n1 & n\\le  10^4 & m\\le 10 & q\\le 10^3 & 10 \\cr\\hline\n2 & n\\le  10^5 & m=1 & q\\le 10^5  & 20\\cr\\hline\n3 & n\\le  10^5 & m=2 & q\\le 10^5 & 20\\cr\\hline\n4 & \\text{无特殊限制} & \\text{无特殊限制} & \\text{无特殊限制}& 50 \\cr\\hline\n\\end{array}$$\n\n- 对于 $100\\%$ 的数据，满足 $ 1 \\leq n\\le 1\\times 10^6;1\\le q \\leq 1.2 \\times 10^5;1 \\leq m \\leq 15;1 \\leq K_i,G_i,p \\leq 10^8;1\\le a\\le b\\le n$ 。", "locale": "zh-CN"}}}
{"pid": "P7706", "type": "P", "difficulty": 5, "samples": [["6 6\n1 4 2 3 5 6\n5 3 4 1 6 7\n3 2 5\n3 1 6\n1 2 3\n3 1 6\n2 6 1\n3 1 6", "8\n9\n8\n8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "洛谷原创", "洛谷比赛"], "title": "「Wdsr-2.7」文文的摄影布置", "background": "作为幻想乡知名的记者射命丸文，文文常常需要为文文新闻采集相关的照片素材。\n\n具体而言，文文会采集一大串的图片，用于为新的一期报纸提供图片。作为一份简短的快报，文文会从素材库中使用**三张**图片，第一张放在开头，第三张放在结尾，用于激发读者的阅读兴趣（毕竟，报纸的开头和结尾是最容易被看到的）；第二张，则是为了帮助读者理解相关内容。\n\n可是作为无双风神，文文收集的照片实在是太多了，以至于一时半会儿处理不过来。按照惯例，文文找到了在一旁吃瓜的你，希望你能帮她解决困难。", "description": "尽管图片非常多，但幸运的是，文文已经将它们排成了一列，从左到右分别编号为 $1 \\sim n$，文文选取的三张图片，**应该是一个长度为 $\\bf 3$ 的子序列**。（不妨设选取的照片的序号为 $i,j,k$ ，则必须要有 $i<j<k$ ）。\n\n此外，文文给每张照片定了一个**吸引度** $A_i$ 与**大小** $B_i$ 。\n\n因为报纸版面太大会降低读者的兴趣，于是选定两张照片 $i,k$ 后，规定必须选择最小的 $B_j$。\n\n形式化地说，规定 $\\psi(i,k) = A_i + A_k - \\min(B_j)$，其中需要满足 $i < j < k$。\n\n摸清了照片价值的计算，文文会告诉你共 $m$ 个操作，可以分为以下三种：\n\n- $\\colorbox{f0f0f0}{\\verb!1 x y!}$ ：照片的吸引度发生变化。文文要将 $A_x$ 修改为 $y$ 。\n\n- $\\colorbox{f0f0f0}{\\verb!2 x y!}$ ：照片的大小发生变化。文文要将 $B_x$ 修改为 $y$ 。\n\n- $\\colorbox{f0f0f0}{\\verb!3 l r!}$ ：文文打算利用素材库的第 $l$ 到第 $r$ 张中的图片，你要告诉她 $\\psi(x,y)$ 的**最大值**（ $l\\le x\\le x+1<y \\le r$ ）。", "inputFormat": "第一行两个整数 $n,m$，分别表示照片数量和操作次数。\n\n第二行 $n$ 个整数，表示序列 $A$，描述每张照片的吸引度。\n\n第三行 $n$ 个整数，表示序列 $B$，描述每张照片的大小。\n\n接下来 $m$ 行，每行描述一个操作，格式如上所述。", "outputFormat": "对于每个操作三，输出一行一个整数，表示答案。", "hint": "#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n,m} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 1\\le n,m\\le 300 & \\text{无} & 10\\cr\\hline\n2 & 1\\le n,m\\le 5\\times 10^3 & \\text{无} & 20\\cr\\hline\n3 & 1\\le n,m\\le 5\\times 10^5 & \\text{仅有操作 3} & 20\\cr\\hline\n4 & 1\\le n,m\\le 10^5 & \\text{无} & 20\\cr\\hline\n5 & \\text{无特殊限制} & \\text{无} & 30\\cr\\hline\n\\end{array}\n$$\n\n- 对于 $100\\%$ 的数据：\n\n   $1 \\le n,m \\le 5 \\times 10^5$。\n   \n   $1 \\leq A_i,B_i,y \\leq 10^8$，$1 \\le x \\le n$，$1 \\le l \\le r \\le n$。\n   \n   保证 $r-l+1 \\geq 3$，即询问的区间长度大于等于 $3$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.7」文文的摄影布置", "background": "作为幻想乡知名的记者射命丸文，文文常常需要为文文新闻采集相关的照片素材。\n\n具体而言，文文会采集一大串的图片，用于为新的一期报纸提供图片。作为一份简短的快报，文文会从素材库中使用**三张**图片，第一张放在开头，第三张放在结尾，用于激发读者的阅读兴趣（毕竟，报纸的开头和结尾是最容易被看到的）；第二张，则是为了帮助读者理解相关内容。\n\n可是作为无双风神，文文收集的照片实在是太多了，以至于一时半会儿处理不过来。按照惯例，文文找到了在一旁吃瓜的你，希望你能帮她解决困难。", "description": "尽管图片非常多，但幸运的是，文文已经将它们排成了一列，从左到右分别编号为 $1 \\sim n$，文文选取的三张图片，**应该是一个长度为 $\\bf 3$ 的子序列**。（不妨设选取的照片的序号为 $i,j,k$ ，则必须要有 $i<j<k$ ）。\n\n此外，文文给每张照片定了一个**吸引度** $A_i$ 与**大小** $B_i$ 。\n\n因为报纸版面太大会降低读者的兴趣，于是选定两张照片 $i,k$ 后，规定必须选择最小的 $B_j$。\n\n形式化地说，规定 $\\psi(i,k) = A_i + A_k - \\min(B_j)$，其中需要满足 $i < j < k$。\n\n摸清了照片价值的计算，文文会告诉你共 $m$ 个操作，可以分为以下三种：\n\n- $\\colorbox{f0f0f0}{\\verb!1 x y!}$ ：照片的吸引度发生变化。文文要将 $A_x$ 修改为 $y$ 。\n\n- $\\colorbox{f0f0f0}{\\verb!2 x y!}$ ：照片的大小发生变化。文文要将 $B_x$ 修改为 $y$ 。\n\n- $\\colorbox{f0f0f0}{\\verb!3 l r!}$ ：文文打算利用素材库的第 $l$ 到第 $r$ 张中的图片，你要告诉她 $\\psi(x,y)$ 的**最大值**（ $l\\le x\\le x+1<y \\le r$ ）。", "inputFormat": "第一行两个整数 $n,m$，分别表示照片数量和操作次数。\n\n第二行 $n$ 个整数，表示序列 $A$，描述每张照片的吸引度。\n\n第三行 $n$ 个整数，表示序列 $B$，描述每张照片的大小。\n\n接下来 $m$ 行，每行描述一个操作，格式如上所述。", "outputFormat": "对于每个操作三，输出一行一个整数，表示答案。", "hint": "#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n,m} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 1\\le n,m\\le 300 & \\text{无} & 10\\cr\\hline\n2 & 1\\le n,m\\le 5\\times 10^3 & \\text{无} & 20\\cr\\hline\n3 & 1\\le n,m\\le 5\\times 10^5 & \\text{仅有操作 3} & 20\\cr\\hline\n4 & 1\\le n,m\\le 10^5 & \\text{无} & 20\\cr\\hline\n5 & \\text{无特殊限制} & \\text{无} & 30\\cr\\hline\n\\end{array}\n$$\n\n- 对于 $100\\%$ 的数据：\n\n   $1 \\le n,m \\le 5 \\times 10^5$。\n   \n   $1 \\leq A_i,B_i,y \\leq 10^8$，$1 \\le x \\le n$，$1 \\le l \\le r \\le n$。\n   \n   保证 $r-l+1 \\geq 3$，即询问的区间长度大于等于 $3$", "locale": "zh-CN"}}}
{"pid": "P7707", "type": "P", "difficulty": 6, "samples": [["10 10 0\n6 8 5 9 6 10 2 4 8 9 \n2 4 3 3 4 1 2 3 3 2 \n2 2 8\n1 1 4 4\n2 1 6\n2 10 2\n1 7 9 7\n2 10 8\n2 8 4\n2 3 10\n1 5 16 5\n1 4 14 7\n", "0\n2\n5\n5\n"], ["10 20 0\n2 19 13 20 7 19 17 8 15 12 \n1 2 4 3 5 3 2 4 2 2 \n2 9 3\n2 17 3\n1 1 9 15\n1 1 12 3\n2 15 5\n1 6 13 6\n2 7 1\n2 20 3\n2 12 1\n2 10 1\n1 5 9 4\n1 1 7 15\n2 12 4\n1 12 12 14\n2 7 5\n1 3 18 6\n1 7 7 1\n2 8 5\n1 6 8 10\n1 14 18 4\n", "5\n1\n0\n0\n3\n0\n0\n0\n1\n0\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 307200, 307200, 307200, 307200, 307200]}, "tags": ["O2优化"], "title": "「Wdsr-2.7」百花齐放的太阳花田", "background": "> 春天到来，花儿盛开……只是这次开花比起以往多上许多，甚至所有季节的花都开了。\n\n$$\\kern{1pt}\\tag*{\\small\\text{——东方花映冢}}$$\n\n今年的太阳花田，因为各种各样花朵的开放而显得格外热闹。尽管这是一场有关于花的异变，但是太阳花田的主人风见幽香却格外享受由鲜花带来的五彩缤纷的花田——毕竟，向来冷清的花田因为各种妖精的活跃而变得热闹了起来。\n\n幽香非常喜欢这些花朵。每朵花都有它自己的种类，也代表了一种性格。比如向日葵，比如蒲公英，比如天人菊……\n\n奇怪的是，有些花朵可能会属于同一种类，但由于相关因素（比如年龄、营养等），使得每种花都有一个高度。\n\n幽香非常感兴趣，因为这些花朵高高低低形形色色，使得太阳花田呈现出了别样的景色。兴致之余，幽香选取了一些花朵，希望你帮助她解决一个问题。\n\n", "description": "一开始，幽香选择了太阳花田当中的 $n$ 朵花朵。每朵花有一个高度 $h_i$ ，以及它属于的类别 $t_i$ 。它们排成了一列，并且被标号为 $1,2,3\\cdots n$ 。幽香有 $m$ 次操作，分为两种：\n\n- $\\colorbox{f0f0f0}{\\verb!1 l r x!}$ ：考虑区间 $[l,r]$ 内的所有花朵。我们取出其中所有高度不超过 $x$ 的花朵（即 $h_i\\le x$ 的花朵），**依次排列**（即不改变花朵在原序列中的顺序），可以根据它们的种类划分为若干段（比如，$\\{\\underline{1,}\\ \\underline{2,2},\\underline{1,1},\\underline {3,}\\ \\underline{4,4,4}\\}$ 就能分为 $5$ 段）。幽香希望你告诉她一共有多少段。\n\n- $\\colorbox{f0f0f0}{\\verb!2 x y!}$ ：幽香挑选了一朵高度为 $x$ ，种类为 $y$ 的花朵，拼接在末尾。\n\n**强制在线。**", "inputFormat": "- 第一行三个整数 $n,m,k$ 。$n,m$ 含义如上，而 $k$ 为**强制在线参数**。\n\n- 接下来两行，第一行是 $n$ 个整数，表示 $\\{h_1,h_2\\cdots h_n\\}$ ；第三行 $n$ 个整数，表示序列 $t_1,t_2\\cdots t_n\\}$ 。含义如题所示。\n\n- 接下来 $m$ 行，每行首先一个整数 $op$ ，表示本次操作的种类。\n\n  - 如果 $op = 1$，接下来三个整数 $l',r',x'$，描述一次查询。\n\n  - 如果 $op = 2$，接下来两个整数 $x',y'$，表示一次修改。\n\n- 在所有操作中，真正的 $l,r,x,y$ 都是输入的 $l',r',x',y'$ 异或上 $k \\times last$ 后的值。其中， $last$ 表示最后一次查询的答案，初始为 $0$。", "outputFormat": "- 共有若干行。对于每个操作 $1$ ，每行输出一个整数，表示答案。", "hint": "$n'$ 表示进行所有操作后的序列长度。\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\bf{Subtask} & \\bm{n',m} & \\textsf{\\textbf{特殊性质}} & \\textsf{\\textbf{分值}} \\cr\\hline\n1 & 1\\le n',m \\le 10^3 & \\text{无} & 10 \\cr\\hline\n2 & 1\\le n',m \\le 3\\times 10^5 & k=0 & 20\\cr\\hline\n3 & 1\\le n',m \\le 3\\times 10^5 & l=1 & 25\\cr\\hline\n4 & 1\\le n',m \\le 10^5 & \\text{无} & 15\\cr\\hline\n5 & 1\\le n',m \\le 3\\times 10^5 & \\text{无} & 20\\cr\\hline\n6 & \\text{无特殊限制} & \\text{时限 3s，空限 300MB} & 10\\cr\\hline\n\\end{array}$$\n\n- 对于 $100\\%$ 的数据：\n\n   $1 \\le n',m \\le 5 \\times 10 ^ 5$。\n   \n   $1 \\le h_i,t_i,x,y \\le 10^9$，$1 \\le l \\le r \\le n'$。\n   \n   $1 \\le op \\le 2$，$0 \\le k \\le 10^3$。\n\n提示：请注意常数优化。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.7」百花齐放的太阳花田", "background": "> 春天到来，花儿盛开……只是这次开花比起以往多上许多，甚至所有季节的花都开了。\n\n$$\\kern{1pt}\\tag*{\\small\\text{——东方花映冢}}$$\n\n今年的太阳花田，因为各种各样花朵的开放而显得格外热闹。尽管这是一场有关于花的异变，但是太阳花田的主人风见幽香却格外享受由鲜花带来的五彩缤纷的花田——毕竟，向来冷清的花田因为各种妖精的活跃而变得热闹了起来。\n\n幽香非常喜欢这些花朵。每朵花都有它自己的种类，也代表了一种性格。比如向日葵，比如蒲公英，比如天人菊……\n\n奇怪的是，有些花朵可能会属于同一种类，但由于相关因素（比如年龄、营养等），使得每种花都有一个高度。\n\n幽香非常感兴趣，因为这些花朵高高低低形形色色，使得太阳花田呈现出了别样的景色。兴致之余，幽香选取了一些花朵，希望你帮助她解决一个问题。\n\n", "description": "一开始，幽香选择了太阳花田当中的 $n$ 朵花朵。每朵花有一个高度 $h_i$ ，以及它属于的类别 $t_i$ 。它们排成了一列，并且被标号为 $1,2,3\\cdots n$ 。幽香有 $m$ 次操作，分为两种：\n\n- $\\colorbox{f0f0f0}{\\verb!1 l r x!}$ ：考虑区间 $[l,r]$ 内的所有花朵。我们取出其中所有高度不超过 $x$ 的花朵（即 $h_i\\le x$ 的花朵），**依次排列**（即不改变花朵在原序列中的顺序），可以根据它们的种类划分为若干段（比如，$\\{\\underline{1,}\\ \\underline{2,2},\\underline{1,1},\\underline {3,}\\ \\underline{4,4,4}\\}$ 就能分为 $5$ 段）。幽香希望你告诉她一共有多少段。\n\n- $\\colorbox{f0f0f0}{\\verb!2 x y!}$ ：幽香挑选了一朵高度为 $x$ ，种类为 $y$ 的花朵，拼接在末尾。\n\n**强制在线。**", "inputFormat": "- 第一行三个整数 $n,m,k$ 。$n,m$ 含义如上，而 $k$ 为**强制在线参数**。\n\n- 接下来两行，第一行是 $n$ 个整数，表示 $\\{h_1,h_2\\cdots h_n\\}$ ；第三行 $n$ 个整数，表示序列 $t_1,t_2\\cdots t_n\\}$ 。含义如题所示。\n\n- 接下来 $m$ 行，每行首先一个整数 $op$ ，表示本次操作的种类。\n\n  - 如果 $op = 1$，接下来三个整数 $l',r',x'$，描述一次查询。\n\n  - 如果 $op = 2$，接下来两个整数 $x',y'$，表示一次修改。\n\n- 在所有操作中，真正的 $l,r,x,y$ 都是输入的 $l',r',x',y'$ 异或上 $k \\times last$ 后的值。其中， $last$ 表示最后一次查询的答案，初始为 $0$。", "outputFormat": "- 共有若干行。对于每个操作 $1$ ，每行输出一个整数，表示答案。", "hint": "$n'$ 表示进行所有操作后的序列长度。\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\bf{Subtask} & \\bm{n',m} & \\textsf{\\textbf{特殊性质}} & \\textsf{\\textbf{分值}} \\cr\\hline\n1 & 1\\le n',m \\le 10^3 & \\text{无} & 10 \\cr\\hline\n2 & 1\\le n',m \\le 3\\times 10^5 & k=0 & 20\\cr\\hline\n3 & 1\\le n',m \\le 3\\times 10^5 & l=1 & 25\\cr\\hline\n4 & 1\\le n',m \\le 10^5 & \\text{无} & 15\\cr\\hline\n5 & 1\\le n',m \\le 3\\times 10^5 & \\text{无} & 20\\cr\\hline\n6 & \\text{无特殊限制} & \\text{时限 3s，空限 300MB} & 10\\cr\\hline\n\\end{array}$$\n\n- 对于 $100\\%$ 的数据：\n\n   $1 \\le n',m \\le 5 \\times 10 ^ 5$。\n   \n   $1 \\le h_i,t_i,x,y \\le 10^9$，$1 \\le l \\le r \\le n'$。\n   \n   $1 \\le op \\le 2$，$0 \\le k \\le 10^3$。\n\n提示：请注意常数优化。", "locale": "zh-CN"}}}
{"pid": "P7708", "type": "P", "difficulty": 6, "samples": [["10 10\n2 3 4 8 7 4 8 4 1 2 \n3 5\n2 8 7\n1 3 6\n1 2 10\n2 2 4\n3 6\n2 8 2\n1 8 7\n3 7\n3 10\n10\n5 10\n1 7\n8 10\n1 10\n9 10\n2 9\n5 5\n8 9\n1 9\n2 7\n", "14\n11\n10\n17\n10\n8\n0\n8\n15\n4\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["莫队", "O2优化", "分块"], "title": "「Wdsr-2.7」八云蓝自动机 Ⅰ", "background": "**注意：本题题意和 八云蓝自动机Ⅱ 并不一致，请仔细阅读**。\n\n作为八云紫的式神，八云蓝有着不同于其他一般式神的强大的计算能力。也就是说，八云蓝可以用自己的心算能力模拟出一台在现世中的确定性状态自动机。\n\n而这，就是传说中的\n\n$$\\textbf{\\textsf{「八云蓝自动机」}}$$\n\n当然，尽管八云蓝的计算能力可以用于模拟一台计算机的操作，但是由于其中并没有设定任何的程序，于是可以实现的功能只能通过学习得到。而作为幻想乡的闲者，八云紫教会了蓝有关于数组的知识。一个数组由若干个存储单元组成，每个单元都可以存储一个整数。\n\n而为了检测这种「八云蓝自动机」的可靠性，紫准备了一条非常简单的模拟题，用于测试蓝的心算能力。\n\n然而，尽管蓝可以很快（ $<10^{-9961}s$ ）得出结果，但是八云紫实在是懒得去构造标准答案了。因此，你被钦定计算出这条题目的答案。", "description": "八云蓝自动机维护了一个长度为 $n$ 的序列 $A$ ，每个元素都有一个初始值。同时自动机会支持以下三种操作：\n\n- $\\colorbox{f0f0f0}{\\verb!1 x k!}$ ：将 $A_x$ 的值修改为 $k$。\n\n- $\\colorbox{f0f0f0}{\\verb!2 x y!}$ ：交换 $A_x$ 与 $A_y$ 的值。\n\n- $\\colorbox{f0f0f0}{\\verb!3 x!}$ ：查询 $A_x$ 的值。\n\n为了测试八云蓝自动机的效率，紫需要进行非常非常多次的测试。为了生成每个测试的所有操作，紫构造出了一个长度为 $m$ 的**操作序列** $B$ ， $B$ 中的元素就是八云蓝自动机可以执行的一个操作。\n\n紫会向蓝发起一共 $q$ 次测试。每次测试，紫会给出一个二元组 $(l,r)$ ，含义是让八云蓝自动机**依次**执行 $B_l,B_{l+1},\\cdots B_r$ 这一共 $(r-l+1)$ 个操作。当然，紫不希望自动机的输出会太长，于是对于每次测试，你只要告诉她这些操作中所有操作 $3$ 的结果之和即可。注意：任意两次测试并**不会互相干扰**，每次操作结束后数列 $A$ 会回到初始状态。\n\n此外，紫不希望用非常非常大的数字刁难你，于是答案对 $2^{32}$ 取模就行了（即 $\\text{unsigned int}$ 自然溢出）。", "inputFormat": "- 第一行两个整数 $n,m$ ，含义如题面所示。\n\n- 第二行 $n$ 个整数，表示序列 $A$ 的初始值。\n\n- 接下来 $m$ 行，描述操作序列 $B$ 。对于每个操作，首先是一个整数 $op$ 描述操作的种类。\n\n  - 如果 $op = 1$，接下来两个整数 $x,k$ ，描述一个操作 $1$ 。\n\n  - 如果 $op = 2$，接下来两个整数 $x,y$ ，描述一个操作 $2$ 。\n\n  - 如果 $op = 3$，接下来一个整数 $x$ ，描述一个操作 $3$ 。\n\n- 接下来一行，一个整数 $q$，表示八云紫发起的测试总数。\n\n- 接下来 $q$ 行，每行有两个整数 $l,r$，描述一次测试，具体的执行方式如题面所示。", "outputFormat": "- 共 $q$ 行，每行一个整数，表示此次测试的结果。", "hint": "#### 数据范围及约定\n\n$$\\def\\arraystretch {1.5}\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n,m,q} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 1\\le n,m,q\\le 10^3 & \\text{无} & 10 \\cr\\hline\n2 & \\text{无特殊限制} & \\text{无操作 1} & 20\\cr\\hline\n3 & \\text{无特殊限制} & \\text{无操作 2} & 20\\cr\\hline\n4 & \\text{无特殊限制} & \\text{操作 3 次数}\\le 10 & 20 \\cr\\hline\n5 & \\text{无特殊限制}& \\text{无}& 30 \\cr\\hline\n\\end{array}$$\n\n- 对于 $100\\%$ 的数据，满足：\n\n  - $1 \\le n,m,q \\le 2 \\times 10 ^ 5$ 。\n  \n  - $1 \\le a_i,k \\le 10^9;1 \\le op \\le 3;1 \\le x,y \\le n;x \\neq y $ 。\n  \n  - $1 \\le l \\le r \\le m$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.7」八云蓝自动机 Ⅰ", "background": "**注意：本题题意和 八云蓝自动机Ⅱ 并不一致，请仔细阅读**。\n\n作为八云紫的式神，八云蓝有着不同于其他一般式神的强大的计算能力。也就是说，八云蓝可以用自己的心算能力模拟出一台在现世中的确定性状态自动机。\n\n而这，就是传说中的\n\n$$\\textbf{\\textsf{「八云蓝自动机」}}$$\n\n当然，尽管八云蓝的计算能力可以用于模拟一台计算机的操作，但是由于其中并没有设定任何的程序，于是可以实现的功能只能通过学习得到。而作为幻想乡的闲者，八云紫教会了蓝有关于数组的知识。一个数组由若干个存储单元组成，每个单元都可以存储一个整数。\n\n而为了检测这种「八云蓝自动机」的可靠性，紫准备了一条非常简单的模拟题，用于测试蓝的心算能力。\n\n然而，尽管蓝可以很快（ $<10^{-9961}s$ ）得出结果，但是八云紫实在是懒得去构造标准答案了。因此，你被钦定计算出这条题目的答案。", "description": "八云蓝自动机维护了一个长度为 $n$ 的序列 $A$ ，每个元素都有一个初始值。同时自动机会支持以下三种操作：\n\n- $\\colorbox{f0f0f0}{\\verb!1 x k!}$ ：将 $A_x$ 的值修改为 $k$。\n\n- $\\colorbox{f0f0f0}{\\verb!2 x y!}$ ：交换 $A_x$ 与 $A_y$ 的值。\n\n- $\\colorbox{f0f0f0}{\\verb!3 x!}$ ：查询 $A_x$ 的值。\n\n为了测试八云蓝自动机的效率，紫需要进行非常非常多次的测试。为了生成每个测试的所有操作，紫构造出了一个长度为 $m$ 的**操作序列** $B$ ， $B$ 中的元素就是八云蓝自动机可以执行的一个操作。\n\n紫会向蓝发起一共 $q$ 次测试。每次测试，紫会给出一个二元组 $(l,r)$ ，含义是让八云蓝自动机**依次**执行 $B_l,B_{l+1},\\cdots B_r$ 这一共 $(r-l+1)$ 个操作。当然，紫不希望自动机的输出会太长，于是对于每次测试，你只要告诉她这些操作中所有操作 $3$ 的结果之和即可。注意：任意两次测试并**不会互相干扰**，每次操作结束后数列 $A$ 会回到初始状态。\n\n此外，紫不希望用非常非常大的数字刁难你，于是答案对 $2^{32}$ 取模就行了（即 $\\text{unsigned int}$ 自然溢出）。", "inputFormat": "- 第一行两个整数 $n,m$ ，含义如题面所示。\n\n- 第二行 $n$ 个整数，表示序列 $A$ 的初始值。\n\n- 接下来 $m$ 行，描述操作序列 $B$ 。对于每个操作，首先是一个整数 $op$ 描述操作的种类。\n\n  - 如果 $op = 1$，接下来两个整数 $x,k$ ，描述一个操作 $1$ 。\n\n  - 如果 $op = 2$，接下来两个整数 $x,y$ ，描述一个操作 $2$ 。\n\n  - 如果 $op = 3$，接下来一个整数 $x$ ，描述一个操作 $3$ 。\n\n- 接下来一行，一个整数 $q$，表示八云紫发起的测试总数。\n\n- 接下来 $q$ 行，每行有两个整数 $l,r$，描述一次测试，具体的执行方式如题面所示。", "outputFormat": "- 共 $q$ 行，每行一个整数，表示此次测试的结果。", "hint": "#### 数据范围及约定\n\n$$\\def\\arraystretch {1.5}\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n,m,q} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 1\\le n,m,q\\le 10^3 & \\text{无} & 10 \\cr\\hline\n2 & \\text{无特殊限制} & \\text{无操作 1} & 20\\cr\\hline\n3 & \\text{无特殊限制} & \\text{无操作 2} & 20\\cr\\hline\n4 & \\text{无特殊限制} & \\text{操作 3 次数}\\le 10 & 20 \\cr\\hline\n5 & \\text{无特殊限制}& \\text{无}& 30 \\cr\\hline\n\\end{array}$$\n\n- 对于 $100\\%$ 的数据，满足：\n\n  - $1 \\le n,m,q \\le 2 \\times 10 ^ 5$ 。\n  \n  - $1 \\le a_i,k \\le 10^9;1 \\le op \\le 3;1 \\le x,y \\le n;x \\neq y $ 。\n  \n  - $1 \\le l \\le r \\le m$ 。", "locale": "zh-CN"}}}
{"pid": "P7709", "type": "P", "difficulty": 7, "samples": [["10 10\n12 11 6 6 1 18 9 1 13 20 \n2 1 8\n1 7 7 12\n2 4 10\n2 5 10\n2 9 5\n3 7\n1 4 8 7\n1 1 9 13\n3 5\n3 6\n10\n1 4 10\n3 3 3\n2 2 7\n1 4 6\n2 2 9\n1 8 8\n2 6 8\n2 6 8\n2 5 6\n1 4 9\n", "146\n0\n12\n42\n25\n60\n48\n48\n39\n94\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000], "memory": [131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "「Wdsr-2.7」八云蓝自动机 Ⅱ", "background": "**注意：本题题意和 八云蓝自动机Ⅰ 并不一致，请仔细阅读**。\n\n作为八云紫的式神，八云蓝有着不同于其他一般式神的强大的计算能力。也就是说，八云蓝可以用自己的心算能力模拟出一台在现世中的确定性状态自动机。通过上一次的练习，八云蓝自动机变得更加强大了。\n\n而这，就是传说中的\n\n$$\\textbf{\\textsf{「八云蓝自动机$^{\\text{plus}}$」}}$$\n\n由于八云蓝自动机通过心算的方式进行运算，因此她还支持一项特异功能，就是一次对一整块数据进行操作。这加强了八云蓝自动机的优越性。\n\n当然，尽管八云蓝的计算能力可以用于模拟一台计算机的操作，但是由于其中并没有设定任何的程序，于是可以实现的功能只能通过学习得到。而作为幻想乡的闲者，八云紫教会了蓝有关于数组的知识。一个数组由若干个存储单元组成，每个单元都可以存储一个整数。\n\n而为了检测这种「八云蓝自动机」的可靠性，紫准备了一条非常简单的模拟题，用于测试蓝的心算能力。\n\n然而，尽管蓝可以很快（ $<10^{-10^{9961}}s$ ）得出结果，但是八云紫实在是懒得去构造标准答案了。因此，你被钦定计算出这条题目的答案。", "description": "八云蓝自动机维护了一个长度为 $n$ 的序列 $A$ ，每个元素都有一个初始值。同时自动机会支持以下三种操作：\n\n- $\\colorbox{f0f0f0}{\\verb!1 l r k!}$ ：将区间 $[l,r]$ 内的所有数字全都变为 $k$ ，即 $A_l\\gets k,A_{l+1}\\gets k,\\cdots ,A_r\\gets k$ 。\n\n- $\\colorbox{f0f0f0}{\\verb!2 x y!}$ ：交换 $A_x$ 与 $A_y$ 的值。\n\n- $\\colorbox{f0f0f0}{\\verb!3 x!}$ ：查询 $A_x$ 的值。\n\n为了测试八云蓝自动机的效率，紫需要进行非常非常多次的测试。为了生成每个测试的所有操作，紫构造出了一个长度为 $m$ 的**操作序列** $B$ ， $B$ 中的元素就是八云蓝自动机可以执行的一个操作。\n\n设 $\\Upsilon(l,r)$ 表示从初始状态开始，依次执行 $B_l,B_{l+1},\\cdots B_r$ 操作后，所有操作 $3$ 的结果之和。特别地，如果这些操作中没有操作 $3$ ，那么 $\\Upsilon(l,r)=0$ 。\n\n紫会向八云蓝自动机发起 $q$ 次询问，每次给出一组 $(l,r,p)$ ，八云蓝自动机需要计算出 \n\n$$\\left(\\sum_{i=l}^r \\Upsilon(i,p)\\right) \\mod 2^{32}$$", "inputFormat": "- 第一行两个整数 $n,m$ ，含义如题面所示。\n\n- 第二行 $n$ 个整数，表示序列 $A$ 的初始值。\n\n- 接下来 $m$ 行，描述操作序列 $B$ 。对于每个操作，首先是一个整数 $op$ 描述操作的种类。\n\n  - 如果 $op = 1$，接下来三个整数 $l,r,k$ ，描述一个操作 $1$ 。\n\n  - 如果 $op = 2$，接下来两个整数 $x,y$ ，描述一个操作 $2$ 。\n\n  - 如果 $op = 3$，接下来一个整数 $x$ ，描述一个操作 $3$ 。\n\n- 接下来一行，一个整数 $q$，表示八云紫发起的询问总数。\n\n- 接下来 $q$ 行，每行有三个整数 $l,r,p$，描述一次询问，具体执行方式如题面所示。\n", "outputFormat": "- 共 $q$ 行，每行一个整数，表示此次询问的结果。", "hint": "- 本题**有且仅有一个** $\\textbf{Subtask}$ 。在本 $\\text{Subtask}$ 中，前几组数据满足 $n,m,q \\le 5 \\times 10^3$，可供检验你的算法的正确性。\n\n- 对于 $100\\%$ 的数据，满足：\n\n  - $1 \\le n,m,q \\le 3 \\times 10 ^ 5$。\n\n  - $1 \\le a_i,k \\le 10^9;1 \\le op \\le 3;1 \\le x,y \\le n;x \\neq y$。\n    \n  - 对于所有操作，$1 \\le l \\le r \\le n$；对于所有查询 $1 \\le l \\le r \\le p \\le m$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.7」八云蓝自动机 Ⅱ", "background": "**注意：本题题意和 八云蓝自动机Ⅰ 并不一致，请仔细阅读**。\n\n作为八云紫的式神，八云蓝有着不同于其他一般式神的强大的计算能力。也就是说，八云蓝可以用自己的心算能力模拟出一台在现世中的确定性状态自动机。通过上一次的练习，八云蓝自动机变得更加强大了。\n\n而这，就是传说中的\n\n$$\\textbf{\\textsf{「八云蓝自动机$^{\\text{plus}}$」}}$$\n\n由于八云蓝自动机通过心算的方式进行运算，因此她还支持一项特异功能，就是一次对一整块数据进行操作。这加强了八云蓝自动机的优越性。\n\n当然，尽管八云蓝的计算能力可以用于模拟一台计算机的操作，但是由于其中并没有设定任何的程序，于是可以实现的功能只能通过学习得到。而作为幻想乡的闲者，八云紫教会了蓝有关于数组的知识。一个数组由若干个存储单元组成，每个单元都可以存储一个整数。\n\n而为了检测这种「八云蓝自动机」的可靠性，紫准备了一条非常简单的模拟题，用于测试蓝的心算能力。\n\n然而，尽管蓝可以很快（ $<10^{-10^{9961}}s$ ）得出结果，但是八云紫实在是懒得去构造标准答案了。因此，你被钦定计算出这条题目的答案。", "description": "八云蓝自动机维护了一个长度为 $n$ 的序列 $A$ ，每个元素都有一个初始值。同时自动机会支持以下三种操作：\n\n- $\\colorbox{f0f0f0}{\\verb!1 l r k!}$ ：将区间 $[l,r]$ 内的所有数字全都变为 $k$ ，即 $A_l\\gets k,A_{l+1}\\gets k,\\cdots ,A_r\\gets k$ 。\n\n- $\\colorbox{f0f0f0}{\\verb!2 x y!}$ ：交换 $A_x$ 与 $A_y$ 的值。\n\n- $\\colorbox{f0f0f0}{\\verb!3 x!}$ ：查询 $A_x$ 的值。\n\n为了测试八云蓝自动机的效率，紫需要进行非常非常多次的测试。为了生成每个测试的所有操作，紫构造出了一个长度为 $m$ 的**操作序列** $B$ ， $B$ 中的元素就是八云蓝自动机可以执行的一个操作。\n\n设 $\\Upsilon(l,r)$ 表示从初始状态开始，依次执行 $B_l,B_{l+1},\\cdots B_r$ 操作后，所有操作 $3$ 的结果之和。特别地，如果这些操作中没有操作 $3$ ，那么 $\\Upsilon(l,r)=0$ 。\n\n紫会向八云蓝自动机发起 $q$ 次询问，每次给出一组 $(l,r,p)$ ，八云蓝自动机需要计算出 \n\n$$\\left(\\sum_{i=l}^r \\Upsilon(i,p)\\right) \\mod 2^{32}$$", "inputFormat": "- 第一行两个整数 $n,m$ ，含义如题面所示。\n\n- 第二行 $n$ 个整数，表示序列 $A$ 的初始值。\n\n- 接下来 $m$ 行，描述操作序列 $B$ 。对于每个操作，首先是一个整数 $op$ 描述操作的种类。\n\n  - 如果 $op = 1$，接下来三个整数 $l,r,k$ ，描述一个操作 $1$ 。\n\n  - 如果 $op = 2$，接下来两个整数 $x,y$ ，描述一个操作 $2$ 。\n\n  - 如果 $op = 3$，接下来一个整数 $x$ ，描述一个操作 $3$ 。\n\n- 接下来一行，一个整数 $q$，表示八云紫发起的询问总数。\n\n- 接下来 $q$ 行，每行有三个整数 $l,r,p$，描述一次询问，具体执行方式如题面所示。\n", "outputFormat": "- 共 $q$ 行，每行一个整数，表示此次询问的结果。", "hint": "- 本题**有且仅有一个** $\\textbf{Subtask}$ 。在本 $\\text{Subtask}$ 中，前几组数据满足 $n,m,q \\le 5 \\times 10^3$，可供检验你的算法的正确性。\n\n- 对于 $100\\%$ 的数据，满足：\n\n  - $1 \\le n,m,q \\le 3 \\times 10 ^ 5$。\n\n  - $1 \\le a_i,k \\le 10^9;1 \\le op \\le 3;1 \\le x,y \\le n;x \\neq y$。\n    \n  - 对于所有操作，$1 \\le l \\le r \\le n$；对于所有查询 $1 \\le l \\le r \\le p \\le m$。", "locale": "zh-CN"}}}
{"pid": "P7710", "type": "P", "difficulty": 6, "samples": [["5 5\n1 1 2 1\n1 1 5 4 1\n1 1 4 1 5\n1 2 1 0 4\n2 3\n2 1", "5\n0"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "2077", "Ynoi"], "title": "[Ynoi2077] stdmxeypz", "background": "", "description": "给你一棵边权为 $1$，且以 $1$ 为根的有根树，每个点有初始为 $0$ 的点权值，定义两个点的距离为其在树上构成的简单路径的长度，需要支持两种操作：\n\n`1 a x y z`：把 $a$ 子树中所有与 $a$ 的距离模 $x$ 等于 $y$ 的节点权值加 $z$。\n\n`2 a`：查询 $a$ 节点的权值。", "inputFormat": "第一行两个整数 $n,m$ 表示树的节点数为 $n$，有 $m$ 次操作。\n\n第二行 $n-1$ 个整数，第 $i$ 个数 $f_i$ 表示树上第 $i+1$ 个节点的父亲节点。\n\n之后 $m$ 行，每行形如 `1 a x y z` 或 `2 a`，表示上述的操作。", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $1\\leq n , m\\leq 3\\times 10^5$，$1\\leq f_i\\leq i$，$1\\leq a\\leq n$，$1\\leq x\\leq n$，$0\\leq y < x$，$0 \\leq z < 514$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2077] stdmxeypz", "background": "", "description": "You are given a rooted tree with edge weight $1$ and root at node $1$. Each node has a node value initially equal to $0$. The distance between two nodes is defined as the length of the simple path between them in the tree. You need to support two types of operations:\n\n`1 a x y z`: For all nodes in the subtree of $a$ whose distance to $a$ modulo $x$ equals $y$, add $z$ to their node values.\n\n`2 a`: Query the node value of node $a$.", "inputFormat": "The first line contains two integers $n, m$, meaning the tree has $n$ nodes and there are $m$ operations.\n\nThe second line contains $n - 1$ integers. The $i$-th integer $f_i$ denotes the parent of node $i + 1$ in the tree.\n\nThen follow $m$ lines, each in the form `1 a x y z` or `2 a`, representing the operations above.", "outputFormat": "For each operation of type $2$, output one line with one integer representing the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477\n\nConstraints: For $100\\%$ of the testdata, $1\\leq n, m\\leq 3\\times 10^5$, $1\\leq f_i\\leq i$, $1\\leq a\\leq n$, $1\\leq x\\leq n$, $0\\leq y < x$, $0 \\leq z < 514$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2077] stdmxeypz", "background": "", "description": "给你一棵边权为 $1$，且以 $1$ 为根的有根树，每个点有初始为 $0$ 的点权值，定义两个点的距离为其在树上构成的简单路径的长度，需要支持两种操作：\n\n`1 a x y z`：把 $a$ 子树中所有与 $a$ 的距离模 $x$ 等于 $y$ 的节点权值加 $z$。\n\n`2 a`：查询 $a$ 节点的权值。", "inputFormat": "第一行两个整数 $n,m$ 表示树的节点数为 $n$，有 $m$ 次操作。\n\n第二行 $n-1$ 个整数，第 $i$ 个数 $f_i$ 表示树上第 $i+1$ 个节点的父亲节点。\n\n之后 $m$ 行，每行形如 `1 a x y z` 或 `2 a`，表示上述的操作。", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $1\\leq n , m\\leq 3\\times 10^5$，$1\\leq f_i\\leq i$，$1\\leq a\\leq n$，$1\\leq x\\leq n$，$0\\leq y < x$，$0 \\leq z < 514$。\n", "locale": "zh-CN"}}}
{"pid": "P7711", "type": "P", "difficulty": 7, "samples": [["10 10\n5 8 4 10\n6 9 6 1\n1 2 7 4\n7 7 3 4\n9 1 5 5\n3 4 8 10\n8 6 1 3\n2 10 2 3\n4 5 9 2\n10 3 10 4\n9 4 2 9\n10 10 4 0\n3 6 1 0\n2 9 4 0\n4 9 4 0\n7 6 8 3\n4 4 7 0\n3 4 9 0\n7 2 9 8\n7 10 2 0", "0\n0\n0\n0\n0\n0\n12\n42\n12\n0"]], "limits": {"time": [36000], "memory": [524288]}, "tags": ["Special Judge", "O2优化", "2077", "Ynoi"], "title": "[Ynoi2077] 3dmq", "background": "这道题是 2077 年的 Ynoi 题，在 2077 年 77 岁的老爷爷 Ynoi 出题人无药可救，把数据范围开大了 $10^{100}$ 倍卡掉了所有高复杂度的算法。\n\n2076 年，苏联自觉已经无法与盟军势力抗衡，末代领导人夫尔巴乔戈发动了对盟军的战争，他们幻想着像 80 年代的军事演习一样，先核弹开路，再钢铁洪流，在一周内将红旗插遍英吉利海峡，然而苏联的科技进步缓慢，在 2076 年，苏军动员兵还在使用波波沙冲锋枪，引以为傲的天启坦克也不敌盟军新开发出的光棱坦克......\n\n在战败后，夫尔巴乔戈被民众吊在了路灯上继续发光发热，很快于 2077 年红旗落地，曾经庞然大物的苏联解体了。战争的刺激导致盟军开发出了大量的新科技，为了对付苏联人的核弹，盟军一直在秘密研发超时空传送仪，盟军利用超时空传送装置进行了很多随机传送测试，在一场测试中，一位前苏联的间谍突然开枪打死了实验的工程师，牺牲自己，将这道题传送到了 2021 年。这道题的意义极其重大，因为超时空传送本质上就是对高维空间的修改查询，能理解高维空间修改查询就能实现超时空传送！\n\n2021 年的苏联科学家接收到他们在 2077 年战败后苏联解体的消息，他们的心中充满了对无名英雄的敬佩以及对未来世界的恐慌，然而当 2021 年的苏联人解密来自 2077 年的信息后，他们惊恐地发现现有的评测机不能支持如此大规模的评测，所以只能开小数据范围。欢迎大家考虑使用高复杂度的算法来通过此题，来帮助苏联人打败盟军。", "description": "给定一个三维空间上 $n$ 个点，每个点有坐标 $X,Y,Z$，权值 $a,b$，$b$ 初始为 $0$。\n\n有 $m$ 个操作：\n\n`x y z w`：求所有 $X_i\\le x,Y_i\\le y,Z_i\\le z$ 的 $i$ 的 $b_i$ 的和，求和结束后，将所有 $X_i\\le x,Y_i\\le y,Z_i\\le z$ 的点 $i$，其 $b$ 权值加上 $a_i\\times w$。", "inputFormat": "第一行两个数 $n,m$。\n\n之后 $n$ 行，每行四个数 $X,Y,Z,a$ 意义如上述。\n\n之后 $m$ 行，每行四个数 $x,y,z,w$，意义如上述。", "outputFormat": "对每个操作，输出一行一个数表示答案。\n\n由于答案可能很大，所以只需要输出答案对 $2^{64}$ 取模的结果即可。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 5\\times 10^5$，初始点集以及权值为均匀随机生成，$X,Y,Z$ 为 $1$ 到 $n$ 的排列，$0\\le a,w\\le n$，操作为均匀随机生成，每次操作有 $0.8$ 的概率其 $w$ 为 $0$。\n\n本题按照你的程序正确回答的询问个数给分，若你的程序正确回答了前 $x$ 个询问，若 $2x\\le m$，你将得到 $\\lfloor\\frac{100x}{m}\\rfloor\\%$ 的分数，否则你将得到 $\\lfloor50+50\\times(\\frac{2x-m}{m})^2\\rfloor\\%$ 的分数。spj 将会在读取到第一个错误的答案或读取到输出末尾或读取完前 $m$ 行时终止读取，之后的信息将被忽略，请勿在行末添加空格。\n\n**注意：若你的程序 TLE，你将会得到 0 分。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2077] 3dmq", "background": "这道题是 2077 年的 Ynoi 题，在 2077 年 77 岁的老爷爷 Ynoi 出题人无药可救，把数据范围开大了 $10^{100}$ 倍卡掉了所有高复杂度的算法。\n\n2076 年，苏联自觉已经无法与盟军势力抗衡，末代领导人夫尔巴乔戈发动了对盟军的战争，他们幻想着像 80 年代的军事演习一样，先核弹开路，再钢铁洪流，在一周内将红旗插遍英吉利海峡，然而苏联的科技进步缓慢，在 2076 年，苏军动员兵还在使用波波沙冲锋枪，引以为傲的天启坦克也不敌盟军新开发出的光棱坦克......\n\n在战败后，夫尔巴乔戈被民众吊在了路灯上继续发光发热，很快于 2077 年红旗落地，曾经庞然大物的苏联解体了。战争的刺激导致盟军开发出了大量的新科技，为了对付苏联人的核弹，盟军一直在秘密研发超时空传送仪，盟军利用超时空传送装置进行了很多随机传送测试，在一场测试中，一位前苏联的间谍突然开枪打死了实验的工程师，牺牲自己，将这道题传送到了 2021 年。这道题的意义极其重大，因为超时空传送本质上就是对高维空间的修改查询，能理解高维空间修改查询就能实现超时空传送！\n\n2021 年的苏联科学家接收到他们在 2077 年战败后苏联解体的消息，他们的心中充满了对无名英雄的敬佩以及对未来世界的恐慌，然而当 2021 年的苏联人解密来自 2077 年的信息后，他们惊恐地发现现有的评测机不能支持如此大规模的评测，所以只能开小数据范围。欢迎大家考虑使用高复杂度的算法来通过此题，来帮助苏联人打败盟军。", "description": "给定一个三维空间上 $n$ 个点，每个点有坐标 $X,Y,Z$，权值 $a,b$，$b$ 初始为 $0$。\n\n有 $m$ 个操作：\n\n`x y z w`：求所有 $X_i\\le x,Y_i\\le y,Z_i\\le z$ 的 $i$ 的 $b_i$ 的和，求和结束后，将所有 $X_i\\le x,Y_i\\le y,Z_i\\le z$ 的点 $i$，其 $b$ 权值加上 $a_i\\times w$。", "inputFormat": "第一行两个数 $n,m$。\n\n之后 $n$ 行，每行四个数 $X,Y,Z,a$ 意义如上述。\n\n之后 $m$ 行，每行四个数 $x,y,z,w$，意义如上述。", "outputFormat": "对每个操作，输出一行一个数表示答案。\n\n由于答案可能很大，所以只需要输出答案对 $2^{64}$ 取模的结果即可。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 5\\times 10^5$，初始点集以及权值为均匀随机生成，$X,Y,Z$ 为 $1$ 到 $n$ 的排列，$0\\le a,w\\le n$，操作为均匀随机生成，每次操作有 $0.8$ 的概率其 $w$ 为 $0$。\n\n本题按照你的程序正确回答的询问个数给分，若你的程序正确回答了前 $x$ 个询问，若 $2x\\le m$，你将得到 $\\lfloor\\frac{100x}{m}\\rfloor\\%$ 的分数，否则你将得到 $\\lfloor50+50\\times(\\frac{2x-m}{m})^2\\rfloor\\%$ 的分数。spj 将会在读取到第一个错误的答案或读取到输出末尾或读取完前 $m$ 行时终止读取，之后的信息将被忽略，请勿在行末添加空格。\n\n**注意：若你的程序 TLE，你将会得到 0 分。**", "locale": "zh-CN"}}}
{"pid": "P7712", "type": "P", "difficulty": 7, "samples": [["10\n1 4\n2 7\n1 6\n3 7\n2 4\n1 9\n1 3\n9 10\n3 5\n1 7\n1 7\n1 3\n1 3\n3 7\n1 2\n3 5\n1 7\n5 7\n3 9\n9 10", "0100010000\n1001000010"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "2077", "Ynoi"], "title": "[Ynoi2077] hlcpq", "background": "", "description": "平面上，给出 $n$ 条水平线段和 $n$ 条竖直线段，保证不同线段不在同一直线上。\n\n若两线段有交点则它们连通，若 $a, b$ 连通且 $b, c$ 连通则 $a, c$ 连通。\n\n一条线段 $a$ 是关键的，当且仅当存在另外两条线段 $b, c$，使得 $b, c$ 连通，且删去 $a$ 后 $b, c$ 不连通。\n", "inputFormat": "第一行一个整数 $n$ 。\n\n接下来 $n$ 行，第 $i$ 行有两个整数 $l, r$（$1 \\le l < r \\le n$），表示一条水平线段 $l \\le x \\le r$，$y=i$。\n\n接下来 $n$ 行，第 $i$ 行有两个整数 $d, u$（$1 \\le d < u \\le n$），表示一条竖直线段 $x = i$，$d \\le y \\le u$。", "outputFormat": "输出两行，每行是一个长度为 $n$ 的 $01$ 串。\n\n第一行第 $i$ 位为 $1$ 当且仅当第 $i$ 条水平线段是关键的。\n\n第二行第 $i$ 位为 $1$ 当且仅当第 $i$ 条竖直线段是关键的。\n", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078&nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $2 \\le n \\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2077] hlcpq", "background": "", "description": "平面上，给出 $n$ 条水平线段和 $n$ 条竖直线段，保证不同线段不在同一直线上。\n\n若两线段有交点则它们连通，若 $a, b$ 连通且 $b, c$ 连通则 $a, c$ 连通。\n\n一条线段 $a$ 是关键的，当且仅当存在另外两条线段 $b, c$，使得 $b, c$ 连通，且删去 $a$ 后 $b, c$ 不连通。\n", "inputFormat": "第一行一个整数 $n$ 。\n\n接下来 $n$ 行，第 $i$ 行有两个整数 $l, r$（$1 \\le l < r \\le n$），表示一条水平线段 $l \\le x \\le r$，$y=i$。\n\n接下来 $n$ 行，第 $i$ 行有两个整数 $d, u$（$1 \\le d < u \\le n$），表示一条竖直线段 $x = i$，$d \\le y \\le u$。", "outputFormat": "输出两行，每行是一个长度为 $n$ 的 $01$ 串。\n\n第一行第 $i$ 位为 $1$ 当且仅当第 $i$ 条水平线段是关键的。\n\n第二行第 $i$ 位为 $1$ 当且仅当第 $i$ 条竖直线段是关键的。\n", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078&nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $2 \\le n \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7713", "type": "P", "difficulty": 2, "samples": [["3 2\n1 2 3", "3"], ["4 3\n1 2 2 3", "6"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "贪心", "二分"], "title": "「EZEC-10」打分", "background": "**为防止评测机被卡，本题时限为 100 ms。**", "description": "小 A 去参加奥运会。\n\n奥运会中共有 $n$ 名裁判，分别给小 A 打分 $a_1,a_2,\\ldots,a_n$。\n\n小 A 对自己的得分不满意，于是他将某名裁判打出的分数加 $1$，称为一次操作。\n\n但是小 A 不能太贪心，他最多只能进行 $m$ 次操作。\n\n小 A 的最终得分为：所有得分中，去掉一个最高分和一个最低分后的平均值。\n\n小 A 想知道，他的最终得分最高为多少。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数 $a_1,a_2,\\ldots,a_n$。", "outputFormat": "为了方便输出，小 A 只需知道**最终得分$\\times (n-2)$** 为多少就可以了。", "hint": "**【样例 1 解释】**\n\n一种可行的方案为：$[1,2,3]\\to [3,2,3]$。\n\n**【样例 2 解释】**\n\n一种可行的方案为：$[1,2,2,3]\\to [2,3,3,3]$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：$m=0$。\n- Subtask 2（10 points）：$n=3$。\n- Subtask 3（15 points）：$n,m\\le 10^3$。\n- Subtask 4（70 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$3\\le n\\le 10^5$，$0\\le m,a_i\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-10」打分", "background": "**为防止评测机被卡，本题时限为 100 ms。**", "description": "小 A 去参加奥运会。\n\n奥运会中共有 $n$ 名裁判，分别给小 A 打分 $a_1,a_2,\\ldots,a_n$。\n\n小 A 对自己的得分不满意，于是他将某名裁判打出的分数加 $1$，称为一次操作。\n\n但是小 A 不能太贪心，他最多只能进行 $m$ 次操作。\n\n小 A 的最终得分为：所有得分中，去掉一个最高分和一个最低分后的平均值。\n\n小 A 想知道，他的最终得分最高为多少。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数 $a_1,a_2,\\ldots,a_n$。", "outputFormat": "为了方便输出，小 A 只需知道**最终得分$\\times (n-2)$** 为多少就可以了。", "hint": "**【样例 1 解释】**\n\n一种可行的方案为：$[1,2,3]\\to [3,2,3]$。\n\n**【样例 2 解释】**\n\n一种可行的方案为：$[1,2,2,3]\\to [2,3,3,3]$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：$m=0$。\n- Subtask 2（10 points）：$n=3$。\n- Subtask 3（15 points）：$n,m\\le 10^3$。\n- Subtask 4（70 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$3\\le n\\le 10^5$，$0\\le m,a_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7714", "type": "P", "difficulty": 2, "samples": [["2\n3\n1 3 2\n4\n3 2 1 4", "2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "﻿基础算法", "构造", "差分", "双指针 two-pointer"], "title": "「EZEC-10」排列排序", "background": "", "description": "给你一个长度为 $n$ 的排列 $p_1,p_2, \\cdots ,p_n$。你需要把它排序。\n\n每次可以花区间长度，即 $r-l+1$ 的代价，选择排列中的任意一段区间 $[l,r]$，并将 $[l,r]$ 从小到大排序。\n\n现在你可以让他进行若干次这个操作，直到 $p$ 中元素的值从 $1$ 到 $n$ 按升序排序，即对于 $1$ 到 $n$ 的每一个 $i$，都有 $p_i=i$。\n\n求问花的代价最少为多少？", "inputFormat": "本题有多组询问，第一行有一个数 $T$ 表示询问组数。\n\n对于每组询问：\n\n第一行给出一个整数 $n$。\n\n第二行 $n$ 个整数，由空格隔开，代表排列 $p$ 中元素的值。", "outputFormat": "$T$ 行，每行一个整数表示一组询问的答案。", "hint": "【样例 $1$ 说明】\n\n对于第一组数据，可选择区间 $[2,3]$ 进行排序。\n\n对于第二组数据，可选择区间 $[1,3]$ 进行排序。\n\n【数据规模与约定】\n\n对于 $20\\%$ 的数据，$n\\leq 4$。\n\n对于另 $30\\%$ 的数据，$\\sum n\\leq5000$。\n\n对于另 $10\\%$ 的数据，$p_1=n$。\n\n对于 $100\\%$ 的数据，$1\\le T,\\sum n\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-10」排列排序", "background": "", "description": "给你一个长度为 $n$ 的排列 $p_1,p_2, \\cdots ,p_n$。你需要把它排序。\n\n每次可以花区间长度，即 $r-l+1$ 的代价，选择排列中的任意一段区间 $[l,r]$，并将 $[l,r]$ 从小到大排序。\n\n现在你可以让他进行若干次这个操作，直到 $p$ 中元素的值从 $1$ 到 $n$ 按升序排序，即对于 $1$ 到 $n$ 的每一个 $i$，都有 $p_i=i$。\n\n求问花的代价最少为多少？", "inputFormat": "本题有多组询问，第一行有一个数 $T$ 表示询问组数。\n\n对于每组询问：\n\n第一行给出一个整数 $n$。\n\n第二行 $n$ 个整数，由空格隔开，代表排列 $p$ 中元素的值。", "outputFormat": "$T$ 行，每行一个整数表示一组询问的答案。", "hint": "【样例 $1$ 说明】\n\n对于第一组数据，可选择区间 $[2,3]$ 进行排序。\n\n对于第二组数据，可选择区间 $[1,3]$ 进行排序。\n\n【数据规模与约定】\n\n对于 $20\\%$ 的数据，$n\\leq 4$。\n\n对于另 $30\\%$ 的数据，$\\sum n\\leq5000$。\n\n对于另 $10\\%$ 的数据，$p_1=n$。\n\n对于 $100\\%$ 的数据，$1\\le T,\\sum n\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P7715", "type": "P", "difficulty": 4, "samples": [["3 4\n1 0 0 0\n1 1 0 0\n1 0 0 0", "1"], ["5 3\n0 1 0\n0 1 0\n0 0 0\n0 1 0\n0 1 0", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 500, 500, 500, 500, 500, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树状数组", "排序"], "title": "「EZEC-10」Shape", "background": "规定 $(x,y)$ 表示第 $x$ 行第 $y$ 列的格子。", "description": "小 A 有一个 $n\\times m$ 的网格，一些为白色格子，剩余为黑色格子。\n\n小 A 选择四个整数 $x_1,x_2,y_1,y_2$，满足如下条件：\n\n1. $1\\le x_1<x_2\\le n$ 且 $1\\le y_1<y_2\\le m$。\n2. $x_1+x_2$ 为偶数。\n\n若 $(x_1,y_1)\\to (x_2,y_1),(x_1,y_2)\\to (x_2,y_2),(\\frac{x_1+x_2}{2},y_1)\\to (\\frac{x_1+x_2}{2},y_2)$ 这三段中的格子均为白色，则称这三段构成的图形为 H 形。\n\n小 A 想知道，这个网格中存在多少不同的 H 形。\n\n**两个 H 形相同，当且仅当两个 H 形的 $x_1,x_2,y_1,y_2$ 均相同。**", "inputFormat": "第一行两个整数 $n,m$。\n\n后 $n$ 行每行 $m$ 个整数表示网格，其中 $0$ 代表白色，$1$ 代表黑色。", "outputFormat": "一个整数，表示不同 H 形的数量。", "hint": "**【样例 1 解释】**\n\n$(x_1,x_2,y_1,y_2)=(1,3,3,4)$ 的 H 形符合。\n\n**【样例 2 解释】**\n\n$(x_1,x_2,y_1,y_2)=(1,5,1,3),(2,4,1,3)$ 的 H 形符合。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 point）：$n=2$。\n- Subtask 2（9 points）：$ n,m\\le 50$。\n- Subtask 3（10 points）：$ n,m\\le 100$，**时限为 $500ms$**。\n- Subtask 4（30 points）：$ n,m\\le 500$。\n- Subtask 5（50 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$2\\le n,m\\le 2\\times 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-10」Shape", "background": "规定 $(x,y)$ 表示第 $x$ 行第 $y$ 列的格子。", "description": "小 A 有一个 $n\\times m$ 的网格，一些为白色格子，剩余为黑色格子。\n\n小 A 选择四个整数 $x_1,x_2,y_1,y_2$，满足如下条件：\n\n1. $1\\le x_1<x_2\\le n$ 且 $1\\le y_1<y_2\\le m$。\n2. $x_1+x_2$ 为偶数。\n\n若 $(x_1,y_1)\\to (x_2,y_1),(x_1,y_2)\\to (x_2,y_2),(\\frac{x_1+x_2}{2},y_1)\\to (\\frac{x_1+x_2}{2},y_2)$ 这三段中的格子均为白色，则称这三段构成的图形为 H 形。\n\n小 A 想知道，这个网格中存在多少不同的 H 形。\n\n**两个 H 形相同，当且仅当两个 H 形的 $x_1,x_2,y_1,y_2$ 均相同。**", "inputFormat": "第一行两个整数 $n,m$。\n\n后 $n$ 行每行 $m$ 个整数表示网格，其中 $0$ 代表白色，$1$ 代表黑色。", "outputFormat": "一个整数，表示不同 H 形的数量。", "hint": "**【样例 1 解释】**\n\n$(x_1,x_2,y_1,y_2)=(1,3,3,4)$ 的 H 形符合。\n\n**【样例 2 解释】**\n\n$(x_1,x_2,y_1,y_2)=(1,5,1,3),(2,4,1,3)$ 的 H 形符合。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 point）：$n=2$。\n- Subtask 2（9 points）：$ n,m\\le 50$。\n- Subtask 3（10 points）：$ n,m\\le 100$，**时限为 $500ms$**。\n- Subtask 4（30 points）：$ n,m\\le 500$。\n- Subtask 5（50 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$2\\le n,m\\le 2\\times 10^3$。", "locale": "zh-CN"}}}
{"pid": "P7716", "type": "P", "difficulty": 4, "samples": [["1\n2 2 4 2 4\n1 2\n3 3", "2"], ["2\n2 2 4 2 3\n0 0\n2 2\n2 2 4 2 2\n1 1\n3 3", "1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP"], "title": "「EZEC-10」Covering", "background": "", "description": "给你一个 $n\\times m$ 的棋盘和 $k$ 张 $1\\times 2$ 的纸片，编号 $1$ 到 $k$。\n\n你可以任意选择数量在 $[l,r]$ 内的纸片，并按照编号从小到大的顺序，依次横放或竖放在棋盘上。\n\n**注意：后放的纸片会覆盖在先放的纸片上。**\n\n给定最终棋盘中每个格子上的纸片编号，求满足条件的不同方案数，并对 $10^9+7$ 取模。\n\n**两种方案相同，当且仅当两方案选择的纸片数量、纸片编号及每张纸片的摆放位置均相同。**", "inputFormat": "第一行一个整数 $T$，表示测试数据组数。\n\n对于每组测试数据：\n\n- 第一行五个整数 $n,m,k,l,r$。\n- 后 $n$ 行每行 $m$ 个整数，表示最终棋盘中每个格子上的纸片编号，若某格子未被覆盖则编号记为 $0$。\n- **数据保证至少存在一种可行的方案。**", "outputFormat": "对于每组数据：\n\n- 一行一个整数，表示方案数对 $10^9+7$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n不难发现只能取编号为 $1,2,3$ 的纸片，此时共有 $2$ 种方案：\n\n$1:(1,1)\\to (1,2)$，$2:(1,2)\\to (2,2)$，$3:(2,1)\\to (2,2)$；\n\n$1:(1,1)\\to (2,1)$，$2:(1,2)\\to (2,2)$，$3:(2,1)\\to (2,2)$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n-  Subtask 1（5 points）：$r=1$。\n-  Subtask 2（10 points）：$n,m,k\\le 5$。\n-  Subtask 3（15 points）：$l=k$。\n-  Subtask 4（20 points）：$n\\times m\\le 10^3$。\n-  Subtask 5（50 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10$，$2\\le n,m,k\\le 10^3$，$1\\le l\\le r\\le k$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-10」Covering", "background": "", "description": "给你一个 $n\\times m$ 的棋盘和 $k$ 张 $1\\times 2$ 的纸片，编号 $1$ 到 $k$。\n\n你可以任意选择数量在 $[l,r]$ 内的纸片，并按照编号从小到大的顺序，依次横放或竖放在棋盘上。\n\n**注意：后放的纸片会覆盖在先放的纸片上。**\n\n给定最终棋盘中每个格子上的纸片编号，求满足条件的不同方案数，并对 $10^9+7$ 取模。\n\n**两种方案相同，当且仅当两方案选择的纸片数量、纸片编号及每张纸片的摆放位置均相同。**", "inputFormat": "第一行一个整数 $T$，表示测试数据组数。\n\n对于每组测试数据：\n\n- 第一行五个整数 $n,m,k,l,r$。\n- 后 $n$ 行每行 $m$ 个整数，表示最终棋盘中每个格子上的纸片编号，若某格子未被覆盖则编号记为 $0$。\n- **数据保证至少存在一种可行的方案。**", "outputFormat": "对于每组数据：\n\n- 一行一个整数，表示方案数对 $10^9+7$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n不难发现只能取编号为 $1,2,3$ 的纸片，此时共有 $2$ 种方案：\n\n$1:(1,1)\\to (1,2)$，$2:(1,2)\\to (2,2)$，$3:(2,1)\\to (2,2)$；\n\n$1:(1,1)\\to (2,1)$，$2:(1,2)\\to (2,2)$，$3:(2,1)\\to (2,2)$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n-  Subtask 1（5 points）：$r=1$。\n-  Subtask 2（10 points）：$n,m,k\\le 5$。\n-  Subtask 3（15 points）：$l=k$。\n-  Subtask 4（20 points）：$n\\times m\\le 10^3$。\n-  Subtask 5（50 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10$，$2\\le n,m,k\\le 10^3$，$1\\le l\\le r\\le k$。", "locale": "zh-CN"}}}
{"pid": "P7717", "type": "P", "difficulty": 5, "samples": [["3 1 2\n1 2 1", "6"], ["5 1 12\n1 2 3\n", "26364"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2021", "O2优化", "深度优先搜索 DFS", "数位 DP", "图论建模", "字典树 Trie", "位运算"], "title": "「EZEC-10」序列", "background": "> 精准的解析刻画，是应该首先尝试的突破口。\n\n——command_block 《考前小贴士》", "description": "请问有多少个不同的序列 $a$，满足：\n1. $a$ 的长度为 $n$。\n2. $a$ 中的元素均为不大于 $k$ 的非负整数。\n3. 满足 $m$ 组形如 $(x_i,y_i,z_i)$ 且 $x_i<y_i$ 的限制，每组限制的意义为 $a_{x_i} \\oplus a_{y_i} = z_i$ （$\\oplus$ 表示按位异或运算）。\n\n两个序列相同，当且仅当它们所有元素均相同。\n\n请输出答案对 $10^9+7$ []($114514\\times(114\\times5\\times14+((1+145)\\times(1+4)+(1\\times14+5-1+4)))+(114\\times514+(11\\times(451+4)+(-1+145+14)))$)取模的结果。", "inputFormat": "输入共 $m+1$ 行：\n- 第一行三个数，$n,m,k$。\n- 接下来 $m$ 行，每行 $3$ 个数，$x_i,y_i,z_i$。", "outputFormat": "输出仅一行，表示答案对 $10^9+7$ 取模的结果。", "hint": "【样例 $1$ 说明】\n\n共有 $6$ 种序列：$\\{0,1,0\\},\\{0,1,1\\},\\{0,1,2\\},\\{1,0,0\\},\\{1,0,1\\},\\{1,0,2\\}$。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 point）：$n=1$。\n- Subtask 2（5 points）：$m=0$。\n- Subtask 3（15 points）：$n,m,k\\le 5$。\n- Subtask 4（10 points）：$z_i=0$。\n- Subtask 5（20 points）：$k\\le 16$。\n- Subtask 6（2 points）：数据随机。\n- Subtask 7（47 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5 \\times 10^5$，$0 \\le m \\le 5 \\times 10^5$，$0 \\le z_i<2^{30}$，$1 \\leq k< 2^{30}$，$1\\le x_i,y_i\\le n$。\n\n【提示】\n\n如果你不知道什么是异或，请点击[这里](https://baike.baidu.com/item/%E5%BC%82%E6%88%96#:~:text=%E5%BC%82%E6%88%96%E4%B9%9F%E5%8F%AB%E5%8D%8A,%E8%AE%A4%E4%BD%9C%E4%B8%8D%E8%BF%9B%E4%BD%8D%E5%8A%A0%E6%B3%95%E3%80%82&text=%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%9C%89%E4%B8%89%E7%A7%8D%E6%BC%94%E7%AE%97%E5%AD%90%EF%BC%9AXOR%E3%80%81eor%E3%80%81%E2%8A%95%E3%80%82)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-10」序列", "background": "> 精准的解析刻画，是应该首先尝试的突破口。\n\n——command_block 《考前小贴士》", "description": "请问有多少个不同的序列 $a$，满足：\n1. $a$ 的长度为 $n$。\n2. $a$ 中的元素均为不大于 $k$ 的非负整数。\n3. 满足 $m$ 组形如 $(x_i,y_i,z_i)$ 且 $x_i<y_i$ 的限制，每组限制的意义为 $a_{x_i} \\oplus a_{y_i} = z_i$ （$\\oplus$ 表示按位异或运算）。\n\n两个序列相同，当且仅当它们所有元素均相同。\n\n请输出答案对 $10^9+7$ []($114514\\times(114\\times5\\times14+((1+145)\\times(1+4)+(1\\times14+5-1+4)))+(114\\times514+(11\\times(451+4)+(-1+145+14)))$)取模的结果。", "inputFormat": "输入共 $m+1$ 行：\n- 第一行三个数，$n,m,k$。\n- 接下来 $m$ 行，每行 $3$ 个数，$x_i,y_i,z_i$。", "outputFormat": "输出仅一行，表示答案对 $10^9+7$ 取模的结果。", "hint": "【样例 $1$ 说明】\n\n共有 $6$ 种序列：$\\{0,1,0\\},\\{0,1,1\\},\\{0,1,2\\},\\{1,0,0\\},\\{1,0,1\\},\\{1,0,2\\}$。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 point）：$n=1$。\n- Subtask 2（5 points）：$m=0$。\n- Subtask 3（15 points）：$n,m,k\\le 5$。\n- Subtask 4（10 points）：$z_i=0$。\n- Subtask 5（20 points）：$k\\le 16$。\n- Subtask 6（2 points）：数据随机。\n- Subtask 7（47 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5 \\times 10^5$，$0 \\le m \\le 5 \\times 10^5$，$0 \\le z_i<2^{30}$，$1 \\leq k< 2^{30}$，$1\\le x_i,y_i\\le n$。\n\n【提示】\n\n如果你不知道什么是异或，请点击[这里](https://baike.baidu.com/item/%E5%BC%82%E6%88%96#:~:text=%E5%BC%82%E6%88%96%E4%B9%9F%E5%8F%AB%E5%8D%8A,%E8%AE%A4%E4%BD%9C%E4%B8%8D%E8%BF%9B%E4%BD%8D%E5%8A%A0%E6%B3%95%E3%80%82&text=%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%9C%89%E4%B8%89%E7%A7%8D%E6%BC%94%E7%AE%97%E5%AD%90%EF%BC%9AXOR%E3%80%81eor%E3%80%81%E2%8A%95%E3%80%82)。", "locale": "zh-CN"}}}
{"pid": "P7718", "type": "P", "difficulty": 6, "samples": [["3\n1 2 3", "2\n16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["状压 DP"], "title": "「EZEC-10」Equalization", "background": "", "description": "给你一个长为 $n$ 的数组 $a_1,a_2,\\ldots,a_n$。\n\n你可以任选三个整数 $l,r,x\\ (1\\le l\\le r\\le n$，$x\\in \\mathbb Z)$，并将 $a_l,a_{l+1},\\ldots,a_r$ 均加上 $x$，称为一次操作。\n\n问最少进行几次操作，才能使 $a$ 中所有元素均相等？并求出能使操作次数最少的不同方案数。\n\n由于方案数可能很大，请对 $10^9+7$ 取模。\n\n**两种方案相同，当且仅当两方案每次操作选择的 $(l,r,x)$ 均相同。**\n\n**特别地，不进行任何操作也算一种方案。**", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $a_1,a_2,\\ldots,a_n$。", "outputFormat": "第一行一个整数，表示最少操作次数。\n\n第二行一个整数，表示方案数对 $10^9+7$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n一种可行的方案为：$(l,r,x)=(1,1,1),(3,3,-1)$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n-  Subtask 1（1 point）：$n=2$。\n-  Subtask 2（5 points）：$n=3$。\n-  Subtask 3（14 points）：保证 $a$ 单调不升或单调不降。\n-  Subtask 4（20 points）：$n\\le 10$。\n-  Subtask 5（20 points）：$n\\le 16$。\n-  Subtask 6（40 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 18$，$-10^9\\le a\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-10」Equalization", "background": "", "description": "给你一个长为 $n$ 的数组 $a_1,a_2,\\ldots,a_n$。\n\n你可以任选三个整数 $l,r,x\\ (1\\le l\\le r\\le n$，$x\\in \\mathbb Z)$，并将 $a_l,a_{l+1},\\ldots,a_r$ 均加上 $x$，称为一次操作。\n\n问最少进行几次操作，才能使 $a$ 中所有元素均相等？并求出能使操作次数最少的不同方案数。\n\n由于方案数可能很大，请对 $10^9+7$ 取模。\n\n**两种方案相同，当且仅当两方案每次操作选择的 $(l,r,x)$ 均相同。**\n\n**特别地，不进行任何操作也算一种方案。**", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $a_1,a_2,\\ldots,a_n$。", "outputFormat": "第一行一个整数，表示最少操作次数。\n\n第二行一个整数，表示方案数对 $10^9+7$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n一种可行的方案为：$(l,r,x)=(1,1,1),(3,3,-1)$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n-  Subtask 1（1 point）：$n=2$。\n-  Subtask 2（5 points）：$n=3$。\n-  Subtask 3（14 points）：保证 $a$ 单调不升或单调不降。\n-  Subtask 4（20 points）：$n\\le 10$。\n-  Subtask 5（20 points）：$n\\le 16$。\n-  Subtask 6（40 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 18$，$-10^9\\le a\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7719", "type": "P", "difficulty": 7, "samples": [["0 7 2 1\n1 5 3\n4 7 2\n1 7", "3"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树形数据结构", "2021", "洛谷原创", "O2优化"], "title": "「EZEC-10」多彩的线段", "background": "", "description": "```Muxii```有一个 $[1,n]$ 的数轴，$m$ 种颜色的线段。  \n```Muxii```规定，对于第 $i$ 种颜色，仅有 $[l_i,r_i]$ 部分的数轴允许覆盖线段，且每条线段的长度不能超过 $k_i$ $(k_i≤10)$。线段可以有任意多条。  \n现在```Muxii```将会询问你 $q$ 次，每次询问给出两个数字 $a$、$b$，请你回答若要覆盖 $[a,b]$ 部分的数轴最少需要几条线段。  \n数据保证数轴上不存在不能被任何线段覆盖的位置。", "inputFormat": "**本题部分数据点强制在线。**  \n第一行四个数 $o$、$n$、$m$、$q$，其中当 $o=1$ 时，该数据点强制在线，即每次给出的 $a$、$b$ 异或上次询问的答案的结果为真正的 $a$、$b$，当第一次询问时，可认为上一次询问的答案为 $0$；当 $o=0$ 时，该数据点不强制在线。  \n接下来 $m$ 行，每行三个数 $l_i$、$r_i$、$k_i$；  \n再接下来 $q$ 行，每行两个数 $a$、$b$。以上未解释的变量意义皆已在题目描述中给出。", "outputFormat": "共 $q$ 行，每行一个数表示答案。", "hint": "【样例 $1$ 说明】\n\n最少需要 $3$ 条线段。下面给出一种可行的解决方案：  \n第 $1$ 条线段为 $[1,4]$ ，颜色为 $1$；  \n第 $2$ 条线段为 $[4,6]$ ，颜色为 $2$；  \n第 $3$ 条线段为 $[6,7]$ ，颜色为 $2$。\n\n【数据范围与约定】\n\n- Subtask 1（5 points）：$n,m,q≤1000$，不强制在线。\n- Subtask 2（20 points）：$n≤2×10^5$。不强制在线。\n- Subtask 3（20 points）：$n≤10^7$。不强制在线。\n- Subtask 4（10 points）：$m≤1000$。不强制在线。\n- Subtask 5（25 points）：无特殊限制，不强制在线。\n- Subtask 6（20 points）：无特殊限制，**强制在线**。\n\n对于 $100\\%$ 的数据，保证 $1≤n≤10^9$，$1≤m≤2×10^5$，$1≤q≤10^6$，$1≤l_i<r_i≤n$，$1≤k_i≤\\min(10,r_i-l_i)$，$1≤a<b≤n$。以上变量皆为整数。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-10」多彩的线段", "background": "", "description": "```Muxii```有一个 $[1,n]$ 的数轴，$m$ 种颜色的线段。  \n```Muxii```规定，对于第 $i$ 种颜色，仅有 $[l_i,r_i]$ 部分的数轴允许覆盖线段，且每条线段的长度不能超过 $k_i$ $(k_i≤10)$。线段可以有任意多条。  \n现在```Muxii```将会询问你 $q$ 次，每次询问给出两个数字 $a$、$b$，请你回答若要覆盖 $[a,b]$ 部分的数轴最少需要几条线段。  \n数据保证数轴上不存在不能被任何线段覆盖的位置。", "inputFormat": "**本题部分数据点强制在线。**  \n第一行四个数 $o$、$n$、$m$、$q$，其中当 $o=1$ 时，该数据点强制在线，即每次给出的 $a$、$b$ 异或上次询问的答案的结果为真正的 $a$、$b$，当第一次询问时，可认为上一次询问的答案为 $0$；当 $o=0$ 时，该数据点不强制在线。  \n接下来 $m$ 行，每行三个数 $l_i$、$r_i$、$k_i$；  \n再接下来 $q$ 行，每行两个数 $a$、$b$。以上未解释的变量意义皆已在题目描述中给出。", "outputFormat": "共 $q$ 行，每行一个数表示答案。", "hint": "【样例 $1$ 说明】\n\n最少需要 $3$ 条线段。下面给出一种可行的解决方案：  \n第 $1$ 条线段为 $[1,4]$ ，颜色为 $1$；  \n第 $2$ 条线段为 $[4,6]$ ，颜色为 $2$；  \n第 $3$ 条线段为 $[6,7]$ ，颜色为 $2$。\n\n【数据范围与约定】\n\n- Subtask 1（5 points）：$n,m,q≤1000$，不强制在线。\n- Subtask 2（20 points）：$n≤2×10^5$。不强制在线。\n- Subtask 3（20 points）：$n≤10^7$。不强制在线。\n- Subtask 4（10 points）：$m≤1000$。不强制在线。\n- Subtask 5（25 points）：无特殊限制，不强制在线。\n- Subtask 6（20 points）：无特殊限制，**强制在线**。\n\n对于 $100\\%$ 的数据，保证 $1≤n≤10^9$，$1≤m≤2×10^5$，$1≤q≤10^6$，$1≤l_i<r_i≤n$，$1≤k_i≤\\min(10,r_i-l_i)$，$1≤a<b≤n$。以上变量皆为整数。  ", "locale": "zh-CN"}}}
{"pid": "P7720", "type": "P", "difficulty": 7, "samples": [["3", "0 16 6 0"], ["8", "0 8008 24388 29840 16788 4360 476 16 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 3500, 3500, 3500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "「EZEC-10」「Byakkai OI 2021」Estahv", "background": "> chrisl gjeztor Amledza  \n> prof ovelmizer  \n> dos carm ammeidha alzenghar  \n> kawy may noxial gjeztor  \n> Rupieilla vas photreywz idha", "description": "我们有排成一排的无限个格子，它们从左往右以 $1,2,\\dots$ 编号。\n\n你可以在每个格子中填入任意**正整数** $k$，则你会得到 $C_k$ 的权值。  \n其中满足 $C_0=C_1=1$，$C_i = \\sum\\limits_{j=0}^{i-1} C_j C_{i-j-1}$ $(i \\ge 2)$。  \n若干个格子的总权值定义为它们的权值之积。\n\n现在你需要从左往右依次在格子中填入数字，直到填入的数字之和等于 $n$ 或超过 $n$ 为止。  \n如此之后，你还需要为每个填入数字的格子涂上黑色或者白色。需要满足：不存在任意连续的 $2$ 个及以上白色的格子，且第一个格子必须为黑色，最后一个填入数字的格子必须为白色。  \n然后，你需要把所有相邻的均填入了数字的同色格子两两连边，并从中选出一个格子集合 $S$，满足 $S$ 内的格子两两不连通（可以为空）。\n\n一种方案的权值定义为所有格子的总权值。\n\n给定 $n$，请你对于 $s=0,1,\\dots,n$，计算所有完成以上操作，且填入的数字之和**恰好**为 $n$，且黑色的格子数为 $s$ 的所有方案的权值之和。  \n两种方案不同当且仅当填入数字的格子数不同或对应格子填入的数字不同或对应格子颜色不同或 $S$ 集合不同。  \n对 $998244353$ 取模。", "inputFormat": "第一行，一个正整数 $n$。", "outputFormat": "一行，$n+1$ 个非负整数，表示对于 $s=0,1,\\dots,n$ 的答案。", "hint": "【样例 $1$ 说明】\n\n当 $n=3$ 时，可以有 $2$ 或 $3$ 个格子。  \n若有 $2$ 个格子，则填数方案为 $[1,2]$ 或 $[2,1]$，权值共为 $2 \\times C_1 \\times C_2 = 4$；填色方案为 `BW`，必有一个黑色格子；$S$ 集合的选择是 $\\{\\},\\{1\\},\\{2\\},\\{1,2\\}$（以格子的编号表示）。  \n若有 $3$ 个格子，则填数方案为 $[1,1,1]$，权值为 $C_1^3=1$；填色方案为 `BBW`，必有两个黑色格子；$S$ 集合的选择是 $\\{\\},\\{1\\},\\{2\\},\\{3\\},\\{1,3\\},\\{2,3\\}$（以格子的编号表示）。  \n其中 `B` 表示黑色，`W` 表示白色。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\n- Subtask 1（30 points）：$n\\le10$。\n- Subtask 2（20 points）：$n\\le300$。\n- Subtask 3（20 points）：$n \\le 5000$。\n- Subtask 4（30 points）：无特殊限制，时限为 $3.5s$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$。 \n\n\n### 提示\n\n为了方便各位获得暴力分，这里给出结论：\n$$\nC_k = \\frac1k \\binom{2k}{k-1} = \\binom{2k-1}{k-1}-\\binom{2k-1}{k-2}\n$$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-10」「Byakkai OI 2021」Estahv", "background": "> chrisl gjeztor Amledza  \n> prof ovelmizer  \n> dos carm ammeidha alzenghar  \n> kawy may noxial gjeztor  \n> Rupieilla vas photreywz idha", "description": "我们有排成一排的无限个格子，它们从左往右以 $1,2,\\dots$ 编号。\n\n你可以在每个格子中填入任意**正整数** $k$，则你会得到 $C_k$ 的权值。  \n其中满足 $C_0=C_1=1$，$C_i = \\sum\\limits_{j=0}^{i-1} C_j C_{i-j-1}$ $(i \\ge 2)$。  \n若干个格子的总权值定义为它们的权值之积。\n\n现在你需要从左往右依次在格子中填入数字，直到填入的数字之和等于 $n$ 或超过 $n$ 为止。  \n如此之后，你还需要为每个填入数字的格子涂上黑色或者白色。需要满足：不存在任意连续的 $2$ 个及以上白色的格子，且第一个格子必须为黑色，最后一个填入数字的格子必须为白色。  \n然后，你需要把所有相邻的均填入了数字的同色格子两两连边，并从中选出一个格子集合 $S$，满足 $S$ 内的格子两两不连通（可以为空）。\n\n一种方案的权值定义为所有格子的总权值。\n\n给定 $n$，请你对于 $s=0,1,\\dots,n$，计算所有完成以上操作，且填入的数字之和**恰好**为 $n$，且黑色的格子数为 $s$ 的所有方案的权值之和。  \n两种方案不同当且仅当填入数字的格子数不同或对应格子填入的数字不同或对应格子颜色不同或 $S$ 集合不同。  \n对 $998244353$ 取模。", "inputFormat": "第一行，一个正整数 $n$。", "outputFormat": "一行，$n+1$ 个非负整数，表示对于 $s=0,1,\\dots,n$ 的答案。", "hint": "【样例 $1$ 说明】\n\n当 $n=3$ 时，可以有 $2$ 或 $3$ 个格子。  \n若有 $2$ 个格子，则填数方案为 $[1,2]$ 或 $[2,1]$，权值共为 $2 \\times C_1 \\times C_2 = 4$；填色方案为 `BW`，必有一个黑色格子；$S$ 集合的选择是 $\\{\\},\\{1\\},\\{2\\},\\{1,2\\}$（以格子的编号表示）。  \n若有 $3$ 个格子，则填数方案为 $[1,1,1]$，权值为 $C_1^3=1$；填色方案为 `BBW`，必有两个黑色格子；$S$ 集合的选择是 $\\{\\},\\{1\\},\\{2\\},\\{3\\},\\{1,3\\},\\{2,3\\}$（以格子的编号表示）。  \n其中 `B` 表示黑色，`W` 表示白色。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\n- Subtask 1（30 points）：$n\\le10$。\n- Subtask 2（20 points）：$n\\le300$。\n- Subtask 3（20 points）：$n \\le 5000$。\n- Subtask 4（30 points）：无特殊限制，时限为 $3.5s$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$。 \n\n\n### 提示\n\n为了方便各位获得暴力分，这里给出结论：\n$$\nC_k = \\frac1k \\binom{2k}{k-1} = \\binom{2k-1}{k-1}-\\binom{2k-1}{k-2}\n$$", "locale": "zh-CN"}}}
{"pid": "P7721", "type": "P", "difficulty": 7, "samples": [["5 33333333333333333 5\n333 33 333 33333 3\n4 5 0 100000\n2 4 0 100000\n1 3 0 100000\n1 5 0 100000\n4 4 0 100000", "99999999999776691\n30000000001494126\n99999999999997821\n332333333323322794\n33333"], ["33 33333 33\n333333333 333333333333 33333333333333 33333333333 33333 333333333333333 33 333 333 333333 3 333333333 3333333 3 333333333 33333333333333 333333333333333 33333333333333 333333 33333333333333 33333333333333 33333333 333333333333333 33333333 33333333 33333 33333333 3333333 33333333 33333333 3333333 33333333 333333333\n1 33 3 333333333333333\n13 15 333333 333333333333333\n15 18 3333333333333 33333333333333\n13 30 3 33333333333\n3 27 33333 3333333333\n25 28 333333 33333333333333\n6 30 333 33333333333333\n4 32 33333333333333 333333333333333\n4 13 33333333 33333333333333\n14 28 3333333 33333333333333\n17 31 3 33333333333333\n21 32 33333 333333333333333\n1 2 333333 3333333333333\n1 10 3333333 333333333\n6 15 33333 333333\n5 13 33333 333333333333\n4 17 3333333333333 33333333333333\n8 28 33333 33333333333333\n14 15 3333 333333333333\n15 26 333333333 333333333333333\n17 25 33333333 333333333333333\n13 25 333333 333333333333\n8 33 333333 33333333333333\n16 17 33333333333 333333333333\n24 26 3333333333 333333333333333\n23 24 3 333\n28 29 333333333 33333333333333\n17 25 33 3333\n6 7 333333 33333333333\n7 12 3333 33333\n17 28 3333333333333 3333333333333\n11 17 333333 333333\n11 17 333333 333333", "5381244831822484\n11111003322222\n33333333333333\n187453349930639529\n209467718277680736\n1111103322222\n38102950517542902\n111033333333320121\n1111100333322222\n271584825962251762\n259223255302742554\n221819973789694611\n11111000333322222\n333333333\n333333\n312336974059655685\n33333333333333\n214323286321378781\n333333333\n74099999892219735\n74099999592219735\n12336407395622288\n70337133069920353\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2007", "O2优化", "Ynoi"], "title": "[Ynoi2007] rvrewsus", "background": "", "description": "给定一个数组 $a_1,a_2,\\dots,a_n$ 以及正整数 $b$，请回答 $q$ 组 $[l,r,L,R]$ 形式的询问。\n\n$\\land$ 符号表示逻辑与。\n\n在这询问里，你需要：\n\n  1. 创建**无重**集合 $S=\\{a_i:l\\le i\\le r\\land L\\le a_i\\le R\\}$；\n  2. 定义函数 $r(k)=\\begin{cases}\\min (x:x\\in S)&k=0\\\\\\min(x:x\\in S\\land r(k-1)<x)&k\\neq0\\end{cases}$；\n\n  3. 求以下表达式值：\n\n$$\\sum_{k=0}^{|S|-1}r(k)b^k$$\n\n所有答案对 $333333333333333397$（一个质数）取模。", "inputFormat": "第一行三个整数 $n,b,q$。  \n\n接下来一行 $n$ 个整数 $a_1,a_2,\\dots,a_N$。  \n\n接下来 $q$ 行每行四个正整数 $l,r,L,R$，表示一组询问。", "outputFormat": "输出 $q$ 行，代表对应询问答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：w33z，Data：w33z\n\n - Subtask 1（2 pts）：$n,q\\le5000$；\n - Subtask 2（3 pts）：$n,q\\le5\\times10^4$；\n - Subtask 3（3 pts）：$R-L\\le 300$；\n - Subtask 4（7 pts）：$b=1$；\n - Subtask 5（7 pts）：所有 $a_i$ 互不相同；\n - Subtask 6（11 pts）：$L=0,R=333333333333333396$；\n - Subtask 7（67 pts）：无额外限制。\n\n对于所有数据，$1\\le n,q\\le2\\times10^5$，$1\\le L\\le R\\le n$，$0\\le b,a_i,L,R<333333333333333397$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] rvrewsus", "background": "", "description": "给定一个数组 $a_1,a_2,\\dots,a_n$ 以及正整数 $b$，请回答 $q$ 组 $[l,r,L,R]$ 形式的询问。\n\n$\\land$ 符号表示逻辑与。\n\n在这询问里，你需要：\n\n  1. 创建**无重**集合 $S=\\{a_i:l\\le i\\le r\\land L\\le a_i\\le R\\}$；\n  2. 定义函数 $r(k)=\\begin{cases}\\min (x:x\\in S)&k=0\\\\\\min(x:x\\in S\\land r(k-1)<x)&k\\neq0\\end{cases}$；\n\n  3. 求以下表达式值：\n\n$$\\sum_{k=0}^{|S|-1}r(k)b^k$$\n\n所有答案对 $333333333333333397$（一个质数）取模。", "inputFormat": "第一行三个整数 $n,b,q$。  \n\n接下来一行 $n$ 个整数 $a_1,a_2,\\dots,a_N$。  \n\n接下来 $q$ 行每行四个正整数 $l,r,L,R$，表示一组询问。", "outputFormat": "输出 $q$ 行，代表对应询问答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：w33z，Data：w33z\n\n - Subtask 1（2 pts）：$n,q\\le5000$；\n - Subtask 2（3 pts）：$n,q\\le5\\times10^4$；\n - Subtask 3（3 pts）：$R-L\\le 300$；\n - Subtask 4（7 pts）：$b=1$；\n - Subtask 5（7 pts）：所有 $a_i$ 互不相同；\n - Subtask 6（11 pts）：$L=0,R=333333333333333396$；\n - Subtask 7（67 pts）：无额外限制。\n\n对于所有数据，$1\\le n,q\\le2\\times10^5$，$1\\le L\\le R\\le n$，$0\\le b,a_i,L,R<333333333333333397$。", "locale": "zh-CN"}}}
{"pid": "P7722", "type": "P", "difficulty": 7, "samples": [["5 4\n1 2 3 4 5\n2 3 4 5 1\n5 1 2 3 4\n2 5\n1 2 3\n2 4\n2 5", "3\n0\n2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2007", "O2优化", "Ynoi"], "title": "[Ynoi2007] tmpq", "background": "", "description": "给定三个长为 $n$ 的数组 $a,b,c$, 满足 $1\\le a_i,b_i,c_i\\le n$ 且为整数。\n\n你需要进行 $m$ 次操作，每次操作为：\n\n`1 k x`：代表将 $a$ 序列的第 $k$ 个位置改为 $x$，即 $a_k := x$。\n\n`2 r`：代表查询有多少个三元组 $(i,j,k)$, 满足 $1\\le i<j<k\\le r$, 且 $b_{a_i}=a_j=c_{a_k}$。\n", "inputFormat": "第一行两个数 $n,m$。\n\n第二行 $n$ 个数，按顺序表示序列 $a$ 中的元素。\n\n第三行 $n$ 个数，按顺序表示序列 $b$ 中的元素。\n\n第四行 $n$ 个数，按顺序表示序列 $c$ 中的元素。\n\n之后 $m$ 行，每行形如 `1 k x` 或 `2 r`，意义如上述。", "outputFormat": "对每个 $2$ 操作，输出一行一个数表示答案。", "hint": "Idea：Forever_Pursuit&nzhtl1477&w33z8kqrqk8zzzx33，\n\nSolution：nzhtl1477&w33z8kqrqk8zzzx33，\n\nCode：w33z8kqrqk8zzzx33，\n\nData：w33z8kqrqk8zzzx33&nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 2\\times 10^5$，$1\\le m\\le 5 \\times 10^4$，$1\\le a_i,b_i,c_i,x,k,r\\le n$。\n\n对于第一个操作，满足条件的三元组为：\n\n- $ i=1 $ , $ j=2 $ , $ k=3 $\n- $ i=2 $ , $ j=3 $ , $ k=4 $\n- $ i=3 $ , $ j=4 $ , $ k=5 $\n\n对于第三个操作，没有满足条件的三元组。\n\n对于第四个操作，满足条件的三元组为：\n\n- $ i=2 $ , $ j=4 $ , $ k=5 $\n- $ i=3 $ , $ j=4 $ , $ k=5 $", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] tmpq", "background": "", "description": "给定三个长为 $n$ 的数组 $a,b,c$, 满足 $1\\le a_i,b_i,c_i\\le n$ 且为整数。\n\n你需要进行 $m$ 次操作，每次操作为：\n\n`1 k x`：代表将 $a$ 序列的第 $k$ 个位置改为 $x$，即 $a_k := x$。\n\n`2 r`：代表查询有多少个三元组 $(i,j,k)$, 满足 $1\\le i<j<k\\le r$, 且 $b_{a_i}=a_j=c_{a_k}$。\n", "inputFormat": "第一行两个数 $n,m$。\n\n第二行 $n$ 个数，按顺序表示序列 $a$ 中的元素。\n\n第三行 $n$ 个数，按顺序表示序列 $b$ 中的元素。\n\n第四行 $n$ 个数，按顺序表示序列 $c$ 中的元素。\n\n之后 $m$ 行，每行形如 `1 k x` 或 `2 r`，意义如上述。", "outputFormat": "对每个 $2$ 操作，输出一行一个数表示答案。", "hint": "Idea：Forever_Pursuit&nzhtl1477&w33z8kqrqk8zzzx33，\n\nSolution：nzhtl1477&w33z8kqrqk8zzzx33，\n\nCode：w33z8kqrqk8zzzx33，\n\nData：w33z8kqrqk8zzzx33&nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 2\\times 10^5$，$1\\le m\\le 5 \\times 10^4$，$1\\le a_i,b_i,c_i,x,k,r\\le n$。\n\n对于第一个操作，满足条件的三元组为：\n\n- $ i=1 $ , $ j=2 $ , $ k=3 $\n- $ i=2 $ , $ j=3 $ , $ k=4 $\n- $ i=3 $ , $ j=4 $ , $ k=5 $\n\n对于第三个操作，没有满足条件的三元组。\n\n对于第四个操作，满足条件的三元组为：\n\n- $ i=2 $ , $ j=4 $ , $ k=5 $\n- $ i=3 $ , $ j=4 $ , $ k=5 $", "locale": "zh-CN"}}}
{"pid": "P7723", "type": "P", "difficulty": 7, "samples": [["4\n1 1 1\n2 10 5\n0 6 9\n3 10 4\n2\n2 3 1 3 10 10 11 11 10 5 7 3 2 3 6 3 2 2 8 2 3 7 2 4 7 11 8 6 9 5 3 7 11 10 10 8 8 5 5 7\n1 2 1 2 2 3 6 11 1 1 5 11 5 2 8 6 1 6 9 2 7 11 3 6 9 10 8 2 9 2 9 8 2 11 3 9 4 11 2 5\n", "0 0\n11 6\n0 0\n\n6 9\n0 0\n0 0\n\n0 0\n0 0\n10 4\n\n\n0 0\n0 0\n15 10\n\n0 0\n0 0\n125 85\n\n30 66\n100 78\n0 0\n\n\n"], ["10\n3 5 8\n1 4 6\n6 8 10\n9 7 5\n7 6 2\n4 9 1\n8 8 5\n0 3 5\n2 6 2\n5 10 3\n10\n4 8 8 9 5 8 3 6 7 7 10 11 10 9 10 3 5 11 3 4 10 3 8 1 3 8 4 11 3 11 5 6 2 5 11 9 6 6 2 1\n4 6 5 6 1 2 1 7 10 7 9 11 11 10 10 5 3 2 2 8 2 1 6 1 9 6 6 5 9 4 6 7 2 7 5 4 3 8 1 6\n1 5 6 9 7 3 9 2 5 3 2 10 6 11 5 10 5 9 8 5 11 3 3 5 5 10 2 6 2 5 8 4 5 6 10 2 10 11 1 7\n3 4 3 9 9 7 1 3 8 4 2 10 5 8 11 3 4 2 1 7 3 9 8 5 4 4 6 6 8 11 11 1 4 7 2 3 2 2 3 10\n6 9 2 7 4 6 1 5 6 7 2 4 2 3 11 10 1 10 1 4 10 6 8 3 3 8 1 1 11 2 8 5 5 9 4 11 5 5 9 8\n5 7 5 8 10 11 9 8 10 4 1 7 7 1 5 2 10 6 4 5 4 2 1 10 1 3 5 11 1 6 2 1 6 1 6 10 11 10 1 8\n3 6 1 6 10 11 9 3 7 3 9 6 1 9 11 6 7 6 3 9 4 11 4 7 2 4 5 5 5 3 4 11 3 4 4 4 6 4 1 9\n6 8 2 6 11 5 7 6 6 5 7 5 9 10 6 11 4 4 2 7 2 11 4 9 3 8 7 9 3 3 5 10 2 9 9 4 7 9 7 11\n2 5 1 4 5 6 7 1 2 1 1 9 6 10 6 6 1 9 5 10 7 1 8 10 1 4 4 3 9 11 11 6 9 6 8 2 8 10 11 7\n6 7 3 6 11 11 11 3 6 6 9 7 6 7 2 5 3 1 8 8 1 9 4 10 9 11 6 4 2 11 10 8 3 6 6 5 11 3 11 8\n", "17 24\n0 0\n7 5\n\n18 8\n8 5\n0 0\n\n16 5\n0 0\n0 0\n\n\n157 111\n0 0\n235 169\n\n40 42\n63 68\n0 0\n\n126 60\n0 0\n147 95\n\n\n215 530\n0 0\n0 0\n\n2324 2024\n2479 1783\n0 0\n\n1578 1592\n837 509\n194 446\n\n\n0 0\n7116 10231\n7239 9388\n\n4607 8460\n0 0\n0 0\n\n6944 6628\n64844 45048\n0 0\n\n\n72300 52348\n265311 254999\n50596 23640\n\n0 0\n279180 126900\n244936 114292\n\n35348 63827\n0 0\n0 0\n\n\n172112 792956\n2447373 1106786\n929486 443832\n\n1119770 935959\n0 0\n0 0\n\n1649144 359228\n0 0\n3553200 2614140\n\n\n0 0\n6950234 5535094\n22444890 7998435\n\n0 0\n10443636 7892656\n71682584 26662760\n\n8776334 5075523\n11841632 7740868\n0 0\n\n\n0 0\n134875573 343366288\n91300520 125610782\n\n59108239 90936089\n21697728 43262120\n0 0\n\n228318480 448464600\n0 0\n128593760 97023136\n\n\n0 0\n0 0\n2054901740 1978497310\n\n0 0\n72853820 66252472\n1991063770 2020209575\n\n600177312 754769101\n3803713784 3298681920\n1004356824 1001672808\n\n\n3063260331 3299980482\n4100473464 1966207784\n3031825976 3091919392\n\n0 0\n325795536 455181888\n0 0\n\n2133373140 3095093880\n3643561634 2339855333\n576229212 1245355280\n\n\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2007", "交互题", "Special Judge", "O2优化", "Ynoi"], "title": "[Ynoi2007] TB5x", "background": null, "description": "这是一道交互题。\n\n二维平面上初始有 $n$ 个点 $(i,p_i)$，每个点有权值 $d_i$，$0\\le i<n$；\n\n共 $m$ 次操作，操作编号为 $0$ 到 $m-1$，按编号升序执行；\n\n编号为 $w$ 的操作给出 $x_1,x_2,y_1,y_2$，满足 $0<x1<x2<n$，$0<y1<y2<n$。\n\n一个点 $(x,y)$ 的网格坐标被定义为 $([x\\ge x1]+[x\\ge x2],[y\\ge y1]+[y\\ge y2])$。\n\n依次进行以下步骤： \n\n1. 查询网格坐标为 $(X,Y)$ 的点的权值之和，记录在 $ans[X][Y]$。\n2. 对每个网格坐标为 $(X,Y)$ 的点，进行修改 $o[X][Y]$。\n3. 所有点的坐标同时发生改变，对于一个网格坐标为 $(X,Y)$ 的点，它的坐标从 $(x,y)$ 变为 $(x+dx[X],y+dy[Y])$；\n    其中\n    $dx[0]=0$，$dx[1]=n-x2$，$dx[2]=x1-x2$。\n    $dy[0]=0$，$dy[1]=n-y2$，$dy[2]=y1-y2$。\n    $x1,x2,y1,y2,o,ans$ 都是数组，下标对应操作的编号。\n\n\n\n其中 $d_i$ 属于抽象的数据类型 $D$，$o[X][Y]$ 属于抽象的数据类型 $O$；\n\n$D$ 上定义了抽象的运算 $+:D\\times D\\to D$；\n\n$D,O$ 上定义了抽象的运算 $\\cdot:O\\times D\\to D$；\n\n$O$ 上定义了抽象的运算 $\\cdot:O\\times O\\to O$；\n\n$\\epsilon_D$ 是 $D$ 中的一个特殊的元素，称为单位元；\n\n$\\epsilon_O$ 是 $O$ 中的一个特殊的元素，称为单位元；\n\n这些操作满足性质：\n\n对任意 $a,b,c\\in D$，有 $a+b=b+a$，$(a+b)+c=a+(b+c)$，$a+\\epsilon_D=\\epsilon_D+a=a$；\n\n对任意 $u,v,w\\in O$，有$(u\\cdot v)\\cdot w=u\\cdot(v\\cdot w)$，$u\\cdot\\epsilon_O=\\epsilon_O\\cdot u=u$；\n\n对任意 $u,v\\in O$，$a,b\\in D$，有$(u\\cdot v)\\cdot a=u\\cdot (v\\cdot a)$，$u\\cdot (a+b)=(u\\cdot a)+(u\\cdot b)$，$\\epsilon_O\\cdot a=a$，$u\\cdot \\epsilon_D=\\epsilon_D$；\n\n执行每次 $+$ 或 $\\cdot$ 运算有一定的代价，具体地，在计算 $a+b$ 或 $a\\cdot b$ 时如果 $a,b$ 都不是 $\\epsilon_D$ 或 $\\epsilon_O$，则代价为 $1$，否则代价为 $0$。你需要保证每个答案正确，且总代价不能超过当前子任务的**代价上限**。\n\n\n### 实现细节\n\n头文件中定义了数据类型 `Data` （$D$）和 `Operation` （$O$），你可以使用以下已定义的成员函数对类型为 `Data` 和 `Operation` 的数据进行操作：\n\n```c++\nvoid Data::add_eq(const Data &a)\n```\n\n`w.add_eq(a)` 计算 $w+a$，并将结果保存在 $w$，每次调用的代价在 $w,a$ 都不是单位元时为 $1$，否则为 $0$；\n\n```c++\nvoid Data::add(const Data &a,const Data &b)\n```\n\n`w.add(a,b)` 计算 $a+b$，并将结果保存在 $w$，每次调用的代价在 $a,b$ 都不是单位元时为 $1$，否则为 $0$；\n\n```c++\nvoid Data::clr()\n```\n\n`w.clr()` 可以将 $\\epsilon_D$ 保存在 $w$，每次调用的代价为 $0$；\n\n```c++\nbool Data::empty()const\n```\n\n`w.empty()` 判断 $w$ 是否为 $\\epsilon_D$，若是则返回 $\\mathrm{true}$，否则返回 $\\mathrm{false}$，每次调用的代价为 $0$；\n\n\n\n```c++\nvoid Operation::apply(Data &a)const\n```\n\n`w.apply(a)` 计算 $w\\cdot a$，并将结果保存在 $a$，每次调用的代价在 $w,a$ 都不是单位元时为 $1$，否则为 $0$；\n\n```c++\nvoid Operation::apply(Operation &u)const\n```\n\n`w.apply(u)` 计算 $w\\cdot u$，并将结果保存在 $u$，每次调用的代价在 $w,u$ 都不是单位元时为 $1$，否则为 $0$；\n\n```c++\nvoid Operation::clr()\n```\n\n`w.clr()` 可以将 $\\epsilon_O$ 存储在 $w$，每次调用的代价为 $0$；\n\n```c++\nbool Operation::empty()const\n```\n\n`w.empty()` 判断 $w$ 是否为 $\\epsilon_O$，若是则返回 $\\mathrm{true}$，否则返回 $\\mathrm{false}$，每次调用的代价为 $0$；\n\n\n\n另外，你还可以使用 `Data` 或 `Operation` 类型的赋值运算符、拷贝构造函数或无参构造函数，以 `Data` 类型为例：\n\n`w=u` 可以将 $u$ 复制一份存储在 $w$，每次调用的代价为 $0$；\n\n`Data w(u);` 或 `Data w=u;` 可以将 $u$ 复制一份存储在新定义的 $w$，每次调用的代价为 $0$；\n\n`Data w;` 可以将 $\\epsilon_D$ 存储在新定义的 $w$，代价为 $0$；\n\n`Operation w;` 可以将 $\\epsilon_O$ 存储在新定义的 $w$，代价为 $0$；\n\n\n\n除了以上描述的对 `Data` 或 `Operation` 的操作外，其余操作根据情况可能被视为攻击评测系统。\n\n`sizeof(Data)` 和 `sizeof(Operation)` 都不超过 $64$，此外交互库还需要不超过 64MB 的空间。时间和空间限制包括交互库使用的时间和空间。仅使用赋值、构造函数、`apply` 和 `add` 就可以写出正确的程序，其它函数可能可以提供便利。\n\n\n\n你需要实现以下函数：\n\n```c++\nvoid solve(\n\tconst int n,\n\tconst int m,\n\tconst int p[],\n\tconst Data d[],\n\tconst int x1[],\n\tconst int x2[],\n\tconst int y1[],\n\tconst int y2[],\n\tconst Operation o[][3][3],\n\tData ans[][3][3])\n```\n\n- $n$：点的个数；\n- $m$：操作的个数；\n- $p$：$(i,p[i])$ 表示每个点的坐标，$0\\le i<n$；\n- $d$：$d[i]$ 表示每个点的初始权值，$0\\le i<n$；\n- $x1,x2,y1,y2,o,ans$：$x1[i],y1[i],x2[i],y2[i],o[i]$ 表示每次操作的输入，你需要将相应的答案存储到 $ans[i]$，$0\\le i<m$。\n\n为了您的方便，这里提供模板。请完善以下代码：\n\n```cpp\n/* BEGIN HEADER: */\nclass Data {\n  friend class Operation;\n  friend int main();\n\nprivate:\n  unsigned int x, sz, T, flag;\n  void read();\n  void print() const;\n\npublic:\n  Data() { clr(); }\n  void add_eq(const Data &a);\n  void add(const Data &a, const Data &b);\n  void clr();\n  bool empty() const;\n};\n\nclass Operation {\n  friend int main();\n\nprivate:\n  unsigned int a, b, L, R, flag;\n  void read();\n\npublic:\n  Operation() { clr(); }\n  void apply(Data &w) const;\n  void apply(Operation &w) const;\n  void clr();\n  bool empty() const;\n};\n\nvoid solve(const int n, const int m, const int p[], const Data d[],\n           const int x1[], const int x2[], const int y1[], const int y2[],\n           const Operation o[][3][3], Data ans[][3][3]);\n/* END HEADER. */\n\n#include <bits/stdc++.h>\n\nvoid solve(const int n, const int m, const int p[], const Data d[],\n           const int x1[], const int x2[], const int y1[], const int y2[],\n           const Operation o[][3][3], Data ans[][3][3]) {\n  // complete this\n}\n```\n\n由于洛谷的交互方法比较奇怪，所以提交的时候需要把本地的代码复制过来，放在这个 solve 函数这里，和前面的 HEADER 一起提交。提交时不引用 \"data.h\" 头文件。\n\n在本地编写程序时应使用 `#include\"data.h\"`，提交的时候再替换成题面中的模板。", "inputFormat": "下发的交互库以如下格式读取输入数据：\n\n- 第一行：$n$\n- 接下来 $n$ 行：$p_i\\;d_i$（$d_i$ 由两个整数表示）\n- 第 $n+2$ 行：$m$\n- 接下来 $m$ 行：$x1_i\\;x2_i\\;y1_i\\;y2_i\\;o_i$（$o_i$ 由 $9 \\times 4$ 个整数表示）\n\n$D$ 中的元素是 $2\\times 1$ 的矩阵，$O$ 中元素是 $2\\times 2$ 的矩阵，矩阵中的元素是对 $2^{32}$ 取模的整数；\n\n$+$ 对应矩阵加法，$\\cdot$ 对应矩阵乘法，具体可以参考下发的交互库的实现；\n\n实际评测环境中输入输出格式以及 $D,O$ 等可能有不同的定义；", "outputFormat": "下发的交互库以如下格式打印你的答案：\n\n- 对每个询问，输出 $13$ 行，其中第 $1 , 2 , 3 , 5 , 6 , 7 , 9 , 10 , 11$ 行有两个整数，依次表示这次询问对应的$ans[0][0],ans[0][1],ans[0][2],ans[1][0],ans[1][1],ans[1][2],ans[2][0],ans[2][1],ans[2][2]$，其余为空行；\n- 向 stderr 打印总代价，以及在总代价超过代价上限时进行提示。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\nSpecial thanks：w33z8kqrqk8zzzx33 修改交互库使得能在洛谷上运行。\n\n对于 $100\\%$ 的数据，满足 $n\\le 10^5,m\\le 2\\times 10^4$。\n\n共 10 组数据，满足 $n=10^5$；\n\n每组数据的 $m$ 分别为 $10,100,1000,2000,5000,10000,12500,15000,17500,20000$；\n\n所有数据的代价上限为 $10^8$。\n\n每组数据对应 $10$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] TB5x", "background": null, "description": "这是一道交互题。\n\n二维平面上初始有 $n$ 个点 $(i,p_i)$，每个点有权值 $d_i$，$0\\le i<n$；\n\n共 $m$ 次操作，操作编号为 $0$ 到 $m-1$，按编号升序执行；\n\n编号为 $w$ 的操作给出 $x_1,x_2,y_1,y_2$，满足 $0<x1<x2<n$，$0<y1<y2<n$。\n\n一个点 $(x,y)$ 的网格坐标被定义为 $([x\\ge x1]+[x\\ge x2],[y\\ge y1]+[y\\ge y2])$。\n\n依次进行以下步骤： \n\n1. 查询网格坐标为 $(X,Y)$ 的点的权值之和，记录在 $ans[X][Y]$。\n2. 对每个网格坐标为 $(X,Y)$ 的点，进行修改 $o[X][Y]$。\n3. 所有点的坐标同时发生改变，对于一个网格坐标为 $(X,Y)$ 的点，它的坐标从 $(x,y)$ 变为 $(x+dx[X],y+dy[Y])$；\n    其中\n    $dx[0]=0$，$dx[1]=n-x2$，$dx[2]=x1-x2$。\n    $dy[0]=0$，$dy[1]=n-y2$，$dy[2]=y1-y2$。\n    $x1,x2,y1,y2,o,ans$ 都是数组，下标对应操作的编号。\n\n\n\n其中 $d_i$ 属于抽象的数据类型 $D$，$o[X][Y]$ 属于抽象的数据类型 $O$；\n\n$D$ 上定义了抽象的运算 $+:D\\times D\\to D$；\n\n$D,O$ 上定义了抽象的运算 $\\cdot:O\\times D\\to D$；\n\n$O$ 上定义了抽象的运算 $\\cdot:O\\times O\\to O$；\n\n$\\epsilon_D$ 是 $D$ 中的一个特殊的元素，称为单位元；\n\n$\\epsilon_O$ 是 $O$ 中的一个特殊的元素，称为单位元；\n\n这些操作满足性质：\n\n对任意 $a,b,c\\in D$，有 $a+b=b+a$，$(a+b)+c=a+(b+c)$，$a+\\epsilon_D=\\epsilon_D+a=a$；\n\n对任意 $u,v,w\\in O$，有$(u\\cdot v)\\cdot w=u\\cdot(v\\cdot w)$，$u\\cdot\\epsilon_O=\\epsilon_O\\cdot u=u$；\n\n对任意 $u,v\\in O$，$a,b\\in D$，有$(u\\cdot v)\\cdot a=u\\cdot (v\\cdot a)$，$u\\cdot (a+b)=(u\\cdot a)+(u\\cdot b)$，$\\epsilon_O\\cdot a=a$，$u\\cdot \\epsilon_D=\\epsilon_D$；\n\n执行每次 $+$ 或 $\\cdot$ 运算有一定的代价，具体地，在计算 $a+b$ 或 $a\\cdot b$ 时如果 $a,b$ 都不是 $\\epsilon_D$ 或 $\\epsilon_O$，则代价为 $1$，否则代价为 $0$。你需要保证每个答案正确，且总代价不能超过当前子任务的**代价上限**。\n\n\n### 实现细节\n\n头文件中定义了数据类型 `Data` （$D$）和 `Operation` （$O$），你可以使用以下已定义的成员函数对类型为 `Data` 和 `Operation` 的数据进行操作：\n\n```c++\nvoid Data::add_eq(const Data &a)\n```\n\n`w.add_eq(a)` 计算 $w+a$，并将结果保存在 $w$，每次调用的代价在 $w,a$ 都不是单位元时为 $1$，否则为 $0$；\n\n```c++\nvoid Data::add(const Data &a,const Data &b)\n```\n\n`w.add(a,b)` 计算 $a+b$，并将结果保存在 $w$，每次调用的代价在 $a,b$ 都不是单位元时为 $1$，否则为 $0$；\n\n```c++\nvoid Data::clr()\n```\n\n`w.clr()` 可以将 $\\epsilon_D$ 保存在 $w$，每次调用的代价为 $0$；\n\n```c++\nbool Data::empty()const\n```\n\n`w.empty()` 判断 $w$ 是否为 $\\epsilon_D$，若是则返回 $\\mathrm{true}$，否则返回 $\\mathrm{false}$，每次调用的代价为 $0$；\n\n\n\n```c++\nvoid Operation::apply(Data &a)const\n```\n\n`w.apply(a)` 计算 $w\\cdot a$，并将结果保存在 $a$，每次调用的代价在 $w,a$ 都不是单位元时为 $1$，否则为 $0$；\n\n```c++\nvoid Operation::apply(Operation &u)const\n```\n\n`w.apply(u)` 计算 $w\\cdot u$，并将结果保存在 $u$，每次调用的代价在 $w,u$ 都不是单位元时为 $1$，否则为 $0$；\n\n```c++\nvoid Operation::clr()\n```\n\n`w.clr()` 可以将 $\\epsilon_O$ 存储在 $w$，每次调用的代价为 $0$；\n\n```c++\nbool Operation::empty()const\n```\n\n`w.empty()` 判断 $w$ 是否为 $\\epsilon_O$，若是则返回 $\\mathrm{true}$，否则返回 $\\mathrm{false}$，每次调用的代价为 $0$；\n\n\n\n另外，你还可以使用 `Data` 或 `Operation` 类型的赋值运算符、拷贝构造函数或无参构造函数，以 `Data` 类型为例：\n\n`w=u` 可以将 $u$ 复制一份存储在 $w$，每次调用的代价为 $0$；\n\n`Data w(u);` 或 `Data w=u;` 可以将 $u$ 复制一份存储在新定义的 $w$，每次调用的代价为 $0$；\n\n`Data w;` 可以将 $\\epsilon_D$ 存储在新定义的 $w$，代价为 $0$；\n\n`Operation w;` 可以将 $\\epsilon_O$ 存储在新定义的 $w$，代价为 $0$；\n\n\n\n除了以上描述的对 `Data` 或 `Operation` 的操作外，其余操作根据情况可能被视为攻击评测系统。\n\n`sizeof(Data)` 和 `sizeof(Operation)` 都不超过 $64$，此外交互库还需要不超过 64MB 的空间。时间和空间限制包括交互库使用的时间和空间。仅使用赋值、构造函数、`apply` 和 `add` 就可以写出正确的程序，其它函数可能可以提供便利。\n\n\n\n你需要实现以下函数：\n\n```c++\nvoid solve(\n\tconst int n,\n\tconst int m,\n\tconst int p[],\n\tconst Data d[],\n\tconst int x1[],\n\tconst int x2[],\n\tconst int y1[],\n\tconst int y2[],\n\tconst Operation o[][3][3],\n\tData ans[][3][3])\n```\n\n- $n$：点的个数；\n- $m$：操作的个数；\n- $p$：$(i,p[i])$ 表示每个点的坐标，$0\\le i<n$；\n- $d$：$d[i]$ 表示每个点的初始权值，$0\\le i<n$；\n- $x1,x2,y1,y2,o,ans$：$x1[i],y1[i],x2[i],y2[i],o[i]$ 表示每次操作的输入，你需要将相应的答案存储到 $ans[i]$，$0\\le i<m$。\n\n为了您的方便，这里提供模板。请完善以下代码：\n\n```cpp\n/* BEGIN HEADER: */\nclass Data {\n  friend class Operation;\n  friend int main();\n\nprivate:\n  unsigned int x, sz, T, flag;\n  void read();\n  void print() const;\n\npublic:\n  Data() { clr(); }\n  void add_eq(const Data &a);\n  void add(const Data &a, const Data &b);\n  void clr();\n  bool empty() const;\n};\n\nclass Operation {\n  friend int main();\n\nprivate:\n  unsigned int a, b, L, R, flag;\n  void read();\n\npublic:\n  Operation() { clr(); }\n  void apply(Data &w) const;\n  void apply(Operation &w) const;\n  void clr();\n  bool empty() const;\n};\n\nvoid solve(const int n, const int m, const int p[], const Data d[],\n           const int x1[], const int x2[], const int y1[], const int y2[],\n           const Operation o[][3][3], Data ans[][3][3]);\n/* END HEADER. */\n\n#include <bits/stdc++.h>\n\nvoid solve(const int n, const int m, const int p[], const Data d[],\n           const int x1[], const int x2[], const int y1[], const int y2[],\n           const Operation o[][3][3], Data ans[][3][3]) {\n  // complete this\n}\n```\n\n由于洛谷的交互方法比较奇怪，所以提交的时候需要把本地的代码复制过来，放在这个 solve 函数这里，和前面的 HEADER 一起提交。提交时不引用 \"data.h\" 头文件。\n\n在本地编写程序时应使用 `#include\"data.h\"`，提交的时候再替换成题面中的模板。", "inputFormat": "下发的交互库以如下格式读取输入数据：\n\n- 第一行：$n$\n- 接下来 $n$ 行：$p_i\\;d_i$（$d_i$ 由两个整数表示）\n- 第 $n+2$ 行：$m$\n- 接下来 $m$ 行：$x1_i\\;x2_i\\;y1_i\\;y2_i\\;o_i$（$o_i$ 由 $9 \\times 4$ 个整数表示）\n\n$D$ 中的元素是 $2\\times 1$ 的矩阵，$O$ 中元素是 $2\\times 2$ 的矩阵，矩阵中的元素是对 $2^{32}$ 取模的整数；\n\n$+$ 对应矩阵加法，$\\cdot$ 对应矩阵乘法，具体可以参考下发的交互库的实现；\n\n实际评测环境中输入输出格式以及 $D,O$ 等可能有不同的定义；", "outputFormat": "下发的交互库以如下格式打印你的答案：\n\n- 对每个询问，输出 $13$ 行，其中第 $1 , 2 , 3 , 5 , 6 , 7 , 9 , 10 , 11$ 行有两个整数，依次表示这次询问对应的$ans[0][0],ans[0][1],ans[0][2],ans[1][0],ans[1][1],ans[1][2],ans[2][0],ans[2][1],ans[2][2]$，其余为空行；\n- 向 stderr 打印总代价，以及在总代价超过代价上限时进行提示。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\nSpecial thanks：w33z8kqrqk8zzzx33 修改交互库使得能在洛谷上运行。\n\n对于 $100\\%$ 的数据，满足 $n\\le 10^5,m\\le 2\\times 10^4$。\n\n共 10 组数据，满足 $n=10^5$；\n\n每组数据的 $m$ 分别为 $10,100,1000,2000,5000,10000,12500,15000,17500,20000$；\n\n所有数据的代价上限为 $10^8$。\n\n每组数据对应 $10$ 分。", "locale": "zh-CN"}}}
{"pid": "P7724", "type": "P", "difficulty": 2, "samples": [["2 1\n3 0\n0 2\n3 1\n", "Yes\n"], ["2 1\n4 3\n3 4\n2 1\n", "No\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "远古档案馆（Ancient Archive）", "background": "为了揭开月光能量背后的秘密，你来到了地下的远古档案馆。\n\n远古一族的秘密与遗忘的知识悉数贮藏于这片被尘封的迷宫中，你能成功解谜，获知远古的知识吗？\n", "description": "远古档案馆的中心是一个解谜：\n\n- 有一个 $2\\times 2$ 的网格，每个格子中要么有一个正整数，要么是空的；\n\n- 你可以进行若干次操作：每次操作中，你选择一个**有正整数的格子**和一个**与之相邻的空格子**，将正整数移到那个空格子中；\n\n- 给定网格的初始状态和最终状态，保证初始状态和最终状态中包含的正整数个数相同（设为 $k$ 个），且它们就是前 $k$ 个不同的正整数，问是否可以通过有限次操作从初始状态到达最终状态？\n\n下图展示了一个包含三个正整数的网格经过两次操作的情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y2dnr4ss.png)\n\n只有完成解谜，才能获得遗忘的知识，因此你希望尽快解决这个问题。\n\n**注意：网格中可能没有正整数，也可能没有空格。**", "inputFormat": "输入共包括四行，每行两个整数。\n\n前两行描述了初始状态，后两行描述了最终状态，用 $0$ 表示空格子。", "outputFormat": "如果可以从初始状态到达最终状态，输出 `Yes`，否则输出 `No`。", "hint": "**【样例 1 解释】**\n\n如题目描述中图所示。\n\n---\n\n**【样例 2 解释】**\n\n没有可移动的正整数，所以无法从初始状态到达与之不相等的最终状态。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n所有数据符合题目描述所述。\n\n- Subtask 1（40 points）：不存在空格。\n- Subtask 2（60 points）：无特殊限制。\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rz2eg0ca.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "远古档案馆（Ancient Archive）", "background": "为了揭开月光能量背后的秘密，你来到了地下的远古档案馆。\n\n远古一族的秘密与遗忘的知识悉数贮藏于这片被尘封的迷宫中，你能成功解谜，获知远古的知识吗？\n", "description": "远古档案馆的中心是一个解谜：\n\n- 有一个 $2\\times 2$ 的网格，每个格子中要么有一个正整数，要么是空的；\n\n- 你可以进行若干次操作：每次操作中，你选择一个**有正整数的格子**和一个**与之相邻的空格子**，将正整数移到那个空格子中；\n\n- 给定网格的初始状态和最终状态，保证初始状态和最终状态中包含的正整数个数相同（设为 $k$ 个），且它们就是前 $k$ 个不同的正整数，问是否可以通过有限次操作从初始状态到达最终状态？\n\n下图展示了一个包含三个正整数的网格经过两次操作的情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y2dnr4ss.png)\n\n只有完成解谜，才能获得遗忘的知识，因此你希望尽快解决这个问题。\n\n**注意：网格中可能没有正整数，也可能没有空格。**", "inputFormat": "输入共包括四行，每行两个整数。\n\n前两行描述了初始状态，后两行描述了最终状态，用 $0$ 表示空格子。", "outputFormat": "如果可以从初始状态到达最终状态，输出 `Yes`，否则输出 `No`。", "hint": "**【样例 1 解释】**\n\n如题目描述中图所示。\n\n---\n\n**【样例 2 解释】**\n\n没有可移动的正整数，所以无法从初始状态到达与之不相等的最终状态。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n所有数据符合题目描述所述。\n\n- Subtask 1（40 points）：不存在空格。\n- Subtask 2（60 points）：无特殊限制。\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rz2eg0ca.png)", "locale": "zh-CN"}}}
{"pid": "P7725", "type": "P", "difficulty": 4, "samples": [["3\n+ -3\n+ 4\n* -4\n", "16\n"], ["3\n+ -3\n+ -4\n* 4\n", "998244346\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "珍珠帝王蟹（Crab King）", "background": "在一次航程中，你偶然发现了被一片礁石环绕的帝王蟹，被月岛能量侵蚀的它又与月光有着怎样的联系呢？似乎只有击败它才能见分晓。\n", "description": "帝王蟹可以通过镶嵌宝石触发战斗，不同的宝石效果不同，但奇特的是，镶嵌宝石的顺序有时也会影响它的强度。\n\n帝王蟹有一个初始为 $0$ 的强度值，每个宝石有属性 $op$ 和 $v$，表示：\n\n- 若 $op$ 为 `+`，则镶嵌后帝王蟹的强度值将会加上 $v$；\n\n- 若 $op$ 为 `*`，则镶嵌后帝王蟹的强度值将会乘上 $v$。\n\n由于宝石的效果十分奇异，所以 $v$ 可能是负数。\n\n作为一个有挑战精神的冒险者，你希望采取某种镶嵌方式，将**每个宝石**都镶嵌**恰好一遍**，且使得帝王蟹的强度值最大。\n\n你只需要输出最大的强度值对 $998244353$ 取模的结果，注意这是一个 $[0, 998244353)$ 中的数。\n\n也就是说，如果答案为 `ans`，按照 C++ 语法，你需要输出 `(ans % P + P) % P`，其中 `P = 998244353`。\n", "inputFormat": "第一行，一个整数 $n$，表示宝石数量。\n\n接下来 $n$ 行，每行有用空格隔开的一个字符 $op$ 和一个整数 $v$，描述一个宝石。", "outputFormat": "输出一行一个整数，表示最大的强度值对 $998244353$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n按照输入顺序以 $1, 2, 3$ 标记每个宝石，所有可能的镶嵌顺序如下：\n\n$1\\to 2\\to 3$：$x = ((0 + {\\color{red}{-3}}) + {\\color{red}{4}}) \\times {\\color{red}{-4}} = -4$；\n\n$1\\to 3\\to 2$：$x = ((0 + {\\color{red}{-3}}) \\times {\\color{red}{-4}}) + {\\color{red}{4}} = 16$；\n\n$2\\to 1\\to 3$：$x = ((0 + {\\color{red}{4}}) + {\\color{red}{-3}}) \\times {\\color{red}{-4}} = -4$；\n\n$2\\to 3\\to 1$：$x = ((0 + {\\color{red}{4}}) \\times {\\color{red}{-4}}) + {\\color{red}{-3}} = -19$；\n\n$3\\to 1\\to 2$：$x = ((0 \\times {\\color{red}{-4}}) + {\\color{red}{-3}}) + {\\color{red}{4}} = 1$；\n\n$3\\to 2\\to 1$：$x = ((0 \\times {\\color{red}{-4}}) + {\\color{red}{4}}) + {\\color{red}{-3}} = 1$。\n\n因此，强度值的最大值为 $16$，对 $998244353$ 取模后为 $16$。\n\n---\n\n**【样例 2 解释】**\n\n按照输入顺序以 $1, 2, 3$ 标记每个宝石，所有可能的镶嵌顺序如下：\n\n$1\\to 2\\to 3$：$x = ((0 + {\\color{red}{-3}}) + {\\color{red}{-4}}) \\times {\\color{red}{4}} = -28$；\n\n$1\\to 3\\to 2$：$x = ((0 + {\\color{red}{-3}}) \\times {\\color{red}{4}}) + {\\color{red}{-4}} = -16$；\n\n$2\\to 1\\to 3$：$x = ((0 + {\\color{red}{-4}}) + {\\color{red}{-3}}) \\times {\\color{red}{4}} = -28$；\n\n$2\\to 3\\to 1$：$x = ((0 + {\\color{red}{-4}}) \\times {\\color{red}{4}}) + {\\color{red}{-3}} = -19$；\n\n$3\\to 1\\to 2$：$x = ((0 \\times {\\color{red}{4}}) + {\\color{red}{-3}}) + {\\color{red}{-4}} = -7$；\n\n$3\\to 2\\to 1$：$x = ((0 \\times {\\color{red}{4}}) + {\\color{red}{-4}}) + {\\color{red}{-3}} = -7$。\n\n因此，强度值的最大值为 $-7$，对 $998244353$ 取模后为 $998244346$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于全部测试数据：$1 \\le n \\le {10}^5$，$2 \\le |v| \\le {10}^6$。\n\n- Subtask 1（26 points）：$n \\le 9$，$|v| \\le 5$。\n- Subtask 2（22 points）：$v > 0$。\n- Subtask 3（12 points）：保证当 $op$ 为 `*` 时 $v > 0$。\n- Subtask 4（15 points）：保证当 $op$ 为 `+` 时 $v > 0$。\n- Subtask 5（25 points）：无特殊限制。\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rwzuwu9z.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "珍珠帝王蟹（Crab King）", "background": "在一次航程中，你偶然发现了被一片礁石环绕的帝王蟹，被月岛能量侵蚀的它又与月光有着怎样的联系呢？似乎只有击败它才能见分晓。\n", "description": "帝王蟹可以通过镶嵌宝石触发战斗，不同的宝石效果不同，但奇特的是，镶嵌宝石的顺序有时也会影响它的强度。\n\n帝王蟹有一个初始为 $0$ 的强度值，每个宝石有属性 $op$ 和 $v$，表示：\n\n- 若 $op$ 为 `+`，则镶嵌后帝王蟹的强度值将会加上 $v$；\n\n- 若 $op$ 为 `*`，则镶嵌后帝王蟹的强度值将会乘上 $v$。\n\n由于宝石的效果十分奇异，所以 $v$ 可能是负数。\n\n作为一个有挑战精神的冒险者，你希望采取某种镶嵌方式，将**每个宝石**都镶嵌**恰好一遍**，且使得帝王蟹的强度值最大。\n\n你只需要输出最大的强度值对 $998244353$ 取模的结果，注意这是一个 $[0, 998244353)$ 中的数。\n\n也就是说，如果答案为 `ans`，按照 C++ 语法，你需要输出 `(ans % P + P) % P`，其中 `P = 998244353`。\n", "inputFormat": "第一行，一个整数 $n$，表示宝石数量。\n\n接下来 $n$ 行，每行有用空格隔开的一个字符 $op$ 和一个整数 $v$，描述一个宝石。", "outputFormat": "输出一行一个整数，表示最大的强度值对 $998244353$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n按照输入顺序以 $1, 2, 3$ 标记每个宝石，所有可能的镶嵌顺序如下：\n\n$1\\to 2\\to 3$：$x = ((0 + {\\color{red}{-3}}) + {\\color{red}{4}}) \\times {\\color{red}{-4}} = -4$；\n\n$1\\to 3\\to 2$：$x = ((0 + {\\color{red}{-3}}) \\times {\\color{red}{-4}}) + {\\color{red}{4}} = 16$；\n\n$2\\to 1\\to 3$：$x = ((0 + {\\color{red}{4}}) + {\\color{red}{-3}}) \\times {\\color{red}{-4}} = -4$；\n\n$2\\to 3\\to 1$：$x = ((0 + {\\color{red}{4}}) \\times {\\color{red}{-4}}) + {\\color{red}{-3}} = -19$；\n\n$3\\to 1\\to 2$：$x = ((0 \\times {\\color{red}{-4}}) + {\\color{red}{-3}}) + {\\color{red}{4}} = 1$；\n\n$3\\to 2\\to 1$：$x = ((0 \\times {\\color{red}{-4}}) + {\\color{red}{4}}) + {\\color{red}{-3}} = 1$。\n\n因此，强度值的最大值为 $16$，对 $998244353$ 取模后为 $16$。\n\n---\n\n**【样例 2 解释】**\n\n按照输入顺序以 $1, 2, 3$ 标记每个宝石，所有可能的镶嵌顺序如下：\n\n$1\\to 2\\to 3$：$x = ((0 + {\\color{red}{-3}}) + {\\color{red}{-4}}) \\times {\\color{red}{4}} = -28$；\n\n$1\\to 3\\to 2$：$x = ((0 + {\\color{red}{-3}}) \\times {\\color{red}{4}}) + {\\color{red}{-4}} = -16$；\n\n$2\\to 1\\to 3$：$x = ((0 + {\\color{red}{-4}}) + {\\color{red}{-3}}) \\times {\\color{red}{4}} = -28$；\n\n$2\\to 3\\to 1$：$x = ((0 + {\\color{red}{-4}}) \\times {\\color{red}{4}}) + {\\color{red}{-3}} = -19$；\n\n$3\\to 1\\to 2$：$x = ((0 \\times {\\color{red}{4}}) + {\\color{red}{-3}}) + {\\color{red}{-4}} = -7$；\n\n$3\\to 2\\to 1$：$x = ((0 \\times {\\color{red}{4}}) + {\\color{red}{-4}}) + {\\color{red}{-3}} = -7$。\n\n因此，强度值的最大值为 $-7$，对 $998244353$ 取模后为 $998244346$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于全部测试数据：$1 \\le n \\le {10}^5$，$2 \\le |v| \\le {10}^6$。\n\n- Subtask 1（26 points）：$n \\le 9$，$|v| \\le 5$。\n- Subtask 2（22 points）：$v > 0$。\n- Subtask 3（12 points）：保证当 $op$ 为 `*` 时 $v > 0$。\n- Subtask 4（15 points）：保证当 $op$ 为 `+` 时 $v > 0$。\n- Subtask 5（25 points）：无特殊限制。\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rwzuwu9z.png)", "locale": "zh-CN"}}}
{"pid": "P7726", "type": "P", "difficulty": 4, "samples": [["4\n4 3 2 1\n1 2 1\n1 1\n1\n", "3 1 2 4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["Special Judge"], "title": "天体探测仪（Astral Detector）", "background": "通过远古档案馆的探索，你成功制出了天体探测仪，你需要用它发现潜藏的天体科技。\n", "description": "想要找到天体科技，你需要先得到一串天体密码——它是一个 $1 \\sim n$ 的**排列**。\n\n天体探测仪允许对于给定的长度 $l$，返回密码中一个长度为 $l$ 的**区间的最小值**。\n\n不幸的是，所有长度为 $l$ 的区间最小值混在了一起，你得到的只是 $n$ 个**可重集合** $S_1, \\ldots , S_n$：\n\n- $S_i$ 表示所有长度为 $i$ 的区间最小值构成的可重集合。\n\n你需要根据这些 $S_i$，还原出一种可能的天体密码，保证至少存在一种正确的天体密码。", "inputFormat": "第一行，一个整数 $n$，表示天体密码的长度。\n\n接下来 $n$ 行，其中第 $i$ 行包含 $n - i + 1$ 个整数（长度为 $i$ 的区间共有 $n - i + 1$ 个），表示可重集 $S_i$ 中的每个元素，注意元素的顺序是**任意的**，而不一定是按照区间从左到右的顺序。", "outputFormat": "输出一行 $n$ 个整数 $p_1, p_2, \\ldots , p_n$，表示你还原出的天体密码。\n\n如有多种可行解，可以输出任意一种。", "hint": "**【样例 1 解释】**\n\n样例输出的天体密码为：$p = [3, 1, 2, 4]$。\n\n长度为 $1$ 的区间最小值构成的可重集合：$S_1 = \\{ 3, 1, 2, 4 \\} = \\{ 4, 3, 2, 1 \\}$。\n\n长度为 $2$ 的区间最小值构成的可重集合：$S_2 = \\{ \\min(3, 1), \\min(1, 2), \\min(2, 4) \\} = \\{ 1, 1, 2 \\} = \\{ 1, 2, 1 \\}$。\n\n长度为 $3$ 的区间最小值构成的可重集合：$S_3 = \\{ \\min(3, 1, 2), \\min(1, 2, 4) \\} = \\{ 1, 1 \\}$。\n\n长度为 $4$ 的区间最小值构成的可重集合：$S_4 = \\{ \\min(3, 1, 2, 4) \\} = \\{ 1 \\}$。\n\n每一个 $S_i$ 都与输入对应。\n\n其他可行答案也判为正确，如 $p = [4, 2, 1, 3]$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据：$2 \\le n \\le 800$。\n\n| 子任务编号 | 分值 | $n \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $26$ | $6$ | 无 |\n| $2$ | $24$ | $16$ | 无 |\n| $3$ | $12$ | $800$ | 对于每个 $i \\in [1, n]$，$S_i$ 中不存在两个相同元素 |\n| $4$ | $38$ | $800$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "天体探测仪（Astral Detector）", "background": "通过远古档案馆的探索，你成功制出了天体探测仪，你需要用它发现潜藏的天体科技。\n", "description": "想要找到天体科技，你需要先得到一串天体密码——它是一个 $1 \\sim n$ 的**排列**。\n\n天体探测仪允许对于给定的长度 $l$，返回密码中一个长度为 $l$ 的**区间的最小值**。\n\n不幸的是，所有长度为 $l$ 的区间最小值混在了一起，你得到的只是 $n$ 个**可重集合** $S_1, \\ldots , S_n$：\n\n- $S_i$ 表示所有长度为 $i$ 的区间最小值构成的可重集合。\n\n你需要根据这些 $S_i$，还原出一种可能的天体密码，保证至少存在一种正确的天体密码。", "inputFormat": "第一行，一个整数 $n$，表示天体密码的长度。\n\n接下来 $n$ 行，其中第 $i$ 行包含 $n - i + 1$ 个整数（长度为 $i$ 的区间共有 $n - i + 1$ 个），表示可重集 $S_i$ 中的每个元素，注意元素的顺序是**任意的**，而不一定是按照区间从左到右的顺序。", "outputFormat": "输出一行 $n$ 个整数 $p_1, p_2, \\ldots , p_n$，表示你还原出的天体密码。\n\n如有多种可行解，可以输出任意一种。", "hint": "**【样例 1 解释】**\n\n样例输出的天体密码为：$p = [3, 1, 2, 4]$。\n\n长度为 $1$ 的区间最小值构成的可重集合：$S_1 = \\{ 3, 1, 2, 4 \\} = \\{ 4, 3, 2, 1 \\}$。\n\n长度为 $2$ 的区间最小值构成的可重集合：$S_2 = \\{ \\min(3, 1), \\min(1, 2), \\min(2, 4) \\} = \\{ 1, 1, 2 \\} = \\{ 1, 2, 1 \\}$。\n\n长度为 $3$ 的区间最小值构成的可重集合：$S_3 = \\{ \\min(3, 1, 2), \\min(1, 2, 4) \\} = \\{ 1, 1 \\}$。\n\n长度为 $4$ 的区间最小值构成的可重集合：$S_4 = \\{ \\min(3, 1, 2, 4) \\} = \\{ 1 \\}$。\n\n每一个 $S_i$ 都与输入对应。\n\n其他可行答案也判为正确，如 $p = [4, 2, 1, 3]$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据：$2 \\le n \\le 800$。\n\n| 子任务编号 | 分值 | $n \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $26$ | $6$ | 无 |\n| $2$ | $24$ | $16$ | 无 |\n| $3$ | $12$ | $800$ | 对于每个 $i \\in [1, n]$，$S_i$ 中不存在两个相同元素 |\n| $4$ | $38$ | $800$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7727", "type": "P", "difficulty": 5, "samples": [["2\n0 0\n1 2\n", "6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "风暴之眼（Eye of the Storm）", "background": "通过月岛，帝王蟹和天体探测仪，你成功拼合了三个天体科技，接下来你要做的，就是来到风暴之眼的中心，准备那个神秘实验的最后一步。\n\n最终的真相近在咫尺，你能否成功通过这场考验呢？", "description": "天体风暴中的气象瞬息万变。\n\n风暴中的道路构成一棵 $n$ 个结点的**无根树**，第 $i$ 个结点有初始权值 $w_i$（$w_i$ 为 $0$ 或 $1$）和类型 $t_i$。\n\n结点的类型分为两种：$\\texttt{AND}$ 型结点和 $\\texttt{OR}$ 型结点。\n\n对于 $\\texttt{AND}$ 型结点，每一秒结束后它的权值将变为**它与它所有邻居上一秒权值的 $\\texttt{AND}$ 和**；\n\n对于 $\\texttt{OR}$ 型结点，每一秒结束后它的权值将变为**它与它所有邻居上一秒权值的 $\\texttt{OR}$ 和**。\n\n现在，已知从某一时刻起，所有结点的权值都不再发生任何变化，将此时点 $i$ 的权值称为 $a_i$。\n\n现不知每个点的初始权值和类型，只知道最终每个点的权值 $a_i$，求出有多少种可能的初始权值和类型的组合，答案对 $998244353$ 取模。", "inputFormat": "第一行，一个整数 $n$，表示树的结点数。\n\n第二行，$n$ 个整数 $a_1, a_2, \\ldots , a_n$，表示每个结点最终的权值。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，描述无根树中的一条边。", "outputFormat": "输出一行一个整数，表示可能的初始权值和类型的组合数量。", "hint": "**【样例 1 解释】**\n\n有如下六种初始权值和类型的组合：\n\n1. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{AND}), (0, \\texttt{AND}))$。\n\n2. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{AND}), (0, \\texttt{OR}))$。\n\n3. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{OR}), (0, \\texttt{AND}))$。\n\n4. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{OR}), (0, \\texttt{OR}))$。\n\n5. $((w_1, t_1), (w_2, t_2)) = ((1, \\texttt{AND}), (0, \\texttt{AND}))$。\n\n6. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{AND}), (1, \\texttt{AND}))$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$2 \\le n \\le 2 \\times {10}^5$，$1 \\le x, y \\le n$，$a_i \\in \\{ 0, 1 \\}$，保证输入构成一棵树。\n\n| 子任务编号 | 分值 | $n\\leq$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10$ | 无 |\n| $2$ | $22$ | $20$ | 无 |\n| $3$ | $22$ | $1000$ | 无 |\n| $4$ | $11$ | ${10}^5$ | $y=x+1$ |\n| $5$ | $15$ | ${10}^5$ | $a_i=0$ |\n| $6$ | $20$ | $2 \\times {10}^5$ | 无 |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j4citkld.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "风暴之眼（Eye of the Storm）", "background": "通过月岛，帝王蟹和天体探测仪，你成功拼合了三个天体科技，接下来你要做的，就是来到风暴之眼的中心，准备那个神秘实验的最后一步。\n\n最终的真相近在咫尺，你能否成功通过这场考验呢？", "description": "天体风暴中的气象瞬息万变。\n\n风暴中的道路构成一棵 $n$ 个结点的**无根树**，第 $i$ 个结点有初始权值 $w_i$（$w_i$ 为 $0$ 或 $1$）和类型 $t_i$。\n\n结点的类型分为两种：$\\texttt{AND}$ 型结点和 $\\texttt{OR}$ 型结点。\n\n对于 $\\texttt{AND}$ 型结点，每一秒结束后它的权值将变为**它与它所有邻居上一秒权值的 $\\texttt{AND}$ 和**；\n\n对于 $\\texttt{OR}$ 型结点，每一秒结束后它的权值将变为**它与它所有邻居上一秒权值的 $\\texttt{OR}$ 和**。\n\n现在，已知从某一时刻起，所有结点的权值都不再发生任何变化，将此时点 $i$ 的权值称为 $a_i$。\n\n现不知每个点的初始权值和类型，只知道最终每个点的权值 $a_i$，求出有多少种可能的初始权值和类型的组合，答案对 $998244353$ 取模。", "inputFormat": "第一行，一个整数 $n$，表示树的结点数。\n\n第二行，$n$ 个整数 $a_1, a_2, \\ldots , a_n$，表示每个结点最终的权值。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，描述无根树中的一条边。", "outputFormat": "输出一行一个整数，表示可能的初始权值和类型的组合数量。", "hint": "**【样例 1 解释】**\n\n有如下六种初始权值和类型的组合：\n\n1. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{AND}), (0, \\texttt{AND}))$。\n\n2. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{AND}), (0, \\texttt{OR}))$。\n\n3. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{OR}), (0, \\texttt{AND}))$。\n\n4. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{OR}), (0, \\texttt{OR}))$。\n\n5. $((w_1, t_1), (w_2, t_2)) = ((1, \\texttt{AND}), (0, \\texttt{AND}))$。\n\n6. $((w_1, t_1), (w_2, t_2)) = ((0, \\texttt{AND}), (1, \\texttt{AND}))$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$2 \\le n \\le 2 \\times {10}^5$，$1 \\le x, y \\le n$，$a_i \\in \\{ 0, 1 \\}$，保证输入构成一棵树。\n\n| 子任务编号 | 分值 | $n\\leq$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10$ | 无 |\n| $2$ | $22$ | $20$ | 无 |\n| $3$ | $22$ | $1000$ | 无 |\n| $4$ | $11$ | ${10}^5$ | $y=x+1$ |\n| $5$ | $15$ | ${10}^5$ | $a_i=0$ |\n| $6$ | $20$ | $2 \\times {10}^5$ | 无 |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j4citkld.png)", "locale": "zh-CN"}}}
{"pid": "P7728", "type": "P", "difficulty": 7, "samples": [["4 10\n1 2\n2 3\n1 4\n", "1\n3\n4\n7\n9\n12\n16\n24\n32\n45\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "旧神归来（Return of Them）", "background": "随着虚影与暗影的决战、月岛祭坛的完工、天体风暴的出现、天界捍卫者的到来，一切月球与远古的秘密仿佛已经行至终局。\n\n旧神即将归来！", "description": "月岛上的一棵普通的树在月光侵蚀的影响下不断生长，随着月面风暴的来临变得更加无限制。\n\n具体地，生长规则如下：\n\n- 初始有一棵包含 $n$ 个结点的以 $1$ 为根的**有根树** $T_0$；\n\n- 在第 $i$ 天，树将从 $T_{i - 1}$ 生长为 $T_i$，生长规则为：令 $v$ 是 $T_{i - 1}$ 中**深度最小的叶结点**（若有多个则任意选择一个），以 $v$ 这个点替换成 $T_{i - 1}$ 本身。\n\n本题中一个结点的深度定义为它到根结点的简单路径所经过的**边数**，注意这可能与常规定义不同。\n\n下图展示了一个从 $T_{i-1}$ 生长到 $T_i$ 的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xvm6j7po.png)\n\n除了面对天界捍卫者，对于环境效应的估计也是重要的，所以你需要计算：\n\n- 对于每个整数 $d \\in [1, m]$，求出 $S_d$ 表示最小的天数，满足 $T_{S_d}$ 中深度最小的叶结点深度**大于** $d$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行，两个整数 $n, m$，分别表示 $T_0$ 的结点数和要求答案的深度范围。\n\n接下来 $n - 1$ 行，每行两个整数 $x, y$，表示 $T_0$ 中结点 $x, y$ 间有一条边。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一个整数表示 $S_i$。", "hint": "**【样例 1 解释】**\n\n如图展示了 $T_0$ 至 $T_3$ 的形态，最浅的叶子由红色标出，上一次生长出的部分用蓝色标出。\n\n可以看到，$T_1$ 中深度最小的叶子深度大于 $1$，$T_3$ 中深度最小的叶子深度大于 $2$，而再操作一次后得到的 $T_4$ 中深度最小的叶子深度就会大于 $3$（应为 $4$），这是对样例输出前三行的一个解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n3lwnaol.png)\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据：$2 \\le n, m \\le {10}^5$。\n\n| 子任务编号 | 分值 | $n, m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $12$ | $10$ | $T_0$ 为二叉树 |\n| $2$ | $8$ | ${10}^5$ | $T_0$ 为以 $1$ 为一端的链 |\n| $3$ | $25$ | ${10}^5$ | $T_0$ 为二叉树，且每个非叶结点都有两个子结点 |\n| $4$ | $10$ | $100$ | 无 |\n| $5$ | $12$ | $1000$ | 无 |\n| $6$ | $15$ | $30000$ | 无 |\n| $7$ | $18$ | ${10}^5$ | 无 |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qqzp89ei.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "旧神归来（Return of Them）", "background": "随着虚影与暗影的决战、月岛祭坛的完工、天体风暴的出现、天界捍卫者的到来，一切月球与远古的秘密仿佛已经行至终局。\n\n旧神即将归来！", "description": "月岛上的一棵普通的树在月光侵蚀的影响下不断生长，随着月面风暴的来临变得更加无限制。\n\n具体地，生长规则如下：\n\n- 初始有一棵包含 $n$ 个结点的以 $1$ 为根的**有根树** $T_0$；\n\n- 在第 $i$ 天，树将从 $T_{i - 1}$ 生长为 $T_i$，生长规则为：令 $v$ 是 $T_{i - 1}$ 中**深度最小的叶结点**（若有多个则任意选择一个），以 $v$ 这个点替换成 $T_{i - 1}$ 本身。\n\n本题中一个结点的深度定义为它到根结点的简单路径所经过的**边数**，注意这可能与常规定义不同。\n\n下图展示了一个从 $T_{i-1}$ 生长到 $T_i$ 的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xvm6j7po.png)\n\n除了面对天界捍卫者，对于环境效应的估计也是重要的，所以你需要计算：\n\n- 对于每个整数 $d \\in [1, m]$，求出 $S_d$ 表示最小的天数，满足 $T_{S_d}$ 中深度最小的叶结点深度**大于** $d$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行，两个整数 $n, m$，分别表示 $T_0$ 的结点数和要求答案的深度范围。\n\n接下来 $n - 1$ 行，每行两个整数 $x, y$，表示 $T_0$ 中结点 $x, y$ 间有一条边。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一个整数表示 $S_i$。", "hint": "**【样例 1 解释】**\n\n如图展示了 $T_0$ 至 $T_3$ 的形态，最浅的叶子由红色标出，上一次生长出的部分用蓝色标出。\n\n可以看到，$T_1$ 中深度最小的叶子深度大于 $1$，$T_3$ 中深度最小的叶子深度大于 $2$，而再操作一次后得到的 $T_4$ 中深度最小的叶子深度就会大于 $3$（应为 $4$），这是对样例输出前三行的一个解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n3lwnaol.png)\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据：$2 \\le n, m \\le {10}^5$。\n\n| 子任务编号 | 分值 | $n, m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $12$ | $10$ | $T_0$ 为二叉树 |\n| $2$ | $8$ | ${10}^5$ | $T_0$ 为以 $1$ 为一端的链 |\n| $3$ | $25$ | ${10}^5$ | $T_0$ 为二叉树，且每个非叶结点都有两个子结点 |\n| $4$ | $10$ | $100$ | 无 |\n| $5$ | $12$ | $1000$ | 无 |\n| $6$ | $15$ | $30000$ | 无 |\n| $7$ | $18$ | ${10}^5$ | 无 |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qqzp89ei.png)", "locale": "zh-CN"}}}
{"pid": "P7729", "type": "P", "difficulty": 7, "samples": [["3 3 0\n1 2\n2 3\n3 1\n", "4\n3\n"], ["5 6 0\n1 2\n2 3\n1 4\n4 3\n1 5\n5 3\n", "8\n30\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge"], "title": "交通运输（Wormhole Transportation）", "background": "**本题数据点较多，请勿恶意提交。如发现恶意提交的，可能面临封号的处罚。**\n\n天体风暴过后，永恒大陆的交通急需重建。", "description": "永恒大陆上有 $n$ 个基地，基地编号为 $1, 2, \\ldots , n$。\n\n现在有 $m$ 条运输任务，第 $i$ 条形如：将货物从基地 $u_i$ 运输到基地 $v_i$。\n\n然而灾后交通并不发达，因此你决定使用虫洞：可以在任意两个不同基地 $x,y$ 之间建立一个虫洞：货物从虫洞的一端传输到虫洞的另一端只需要花费 $1$ 单位的时间。\n\n而且，**运输的方向是双向的**，也就是说，假设建立了一个连接了基地 $a, b$ 的虫洞，那么货物既可以从基地 $a$ 运输到基地 $b$，也可以从基地 $b$ 运输到基地 $a$。\n\n但建立虫洞的代价是昂贵的，你决定只建立**恰好** $\\boldsymbol{m - 1}$ 个虫洞，且不能有两个虫洞连接的两个基地完全相同。\n\n你想要知道，在所有的建造方案中， $m$ 条运输任务所花费的时间之和最小能是多少，此外，在花费的时间之和最小的情况下，有多少种建造虫洞的方案。\n\n由于第二个问题的答案可能很大，你只需要输出方案数对 ${10}^9 + 7$ 取模的结果。", "inputFormat": "第一行：三个整数 $n,m,t$，其中 $t$ 为子任务编号，对于样例来说 $t=0$。\n\n接下来 $m$ 行：每行两个整数 $u_i,v_i$。", "outputFormat": "第一行，一个整数，表示 $m$ 条运输任务所花费的时间之和的最小值。\n\n第二行，一个整数，表示建造虫洞的方案数对 ${10}^9 + 7$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n有三种建造方案。\n\n其中一种是在城市 $1, 2$ 之间建立虫洞，在城市 $2, 3$ 之间建立虫洞，这样，前两条任务的时间都为 $1$，最后一条的时间为 $2$。\n\n另外两种方案是：在城市 $1, 2$ 和 $1, 3$ 之间建立虫洞，或在城市 $1, 3$ 和 $2, 3$ 之间建立虫洞。\n\n---\n\n**【数据范围】**\n\n对于所有数据，$2 \\le n \\le 2000$，$2 \\le n \\cdot m \\le 2 \\times {10}^7$，$1 \\le u_i, v_i \\le n$，$u_i\\ne v_i$。\n\n保证所有无序对 $(u_i, v_i)$ 两两不同，且至少存在一种合法的建造虫洞的方案。\n\n| 子任务编号 | 分值 | $n \\le$ | 特殊限制 | 部分分 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $6$ | 无 | $0$ |\n| $2$ | $12$ | $2000$ | $m=n$，且 $u_i=i,\\ v_i=i\\bmod n+1$ | $3$ |\n| $3$ | $12$ | $2000$ | 由所有 $(u_i,v_i)$ 为无向边构成的图为仙人掌森林 | $3$ |\n| $4$ | $25$ | $2000$ | 由所有 $(u_i,v_i)$ 为无向边构成的图为杏仁 | $8$ |\n| $5$ | $27$ | $300$ | $m\\leq 1000$ | $8$ |\n| $6$ | $14$ | $2000$ | 无 | $3$ |\n\n仙人掌森林：每条边在至多一个简单环中的无向图。\n\n杏仁：恰好存在两个度数大于 $2$ 的结点，其他结点度数都等于 $2$，且所有环都经过两个度数大于 $2$ 的结点的连通无向图。\n\n当你对于某个子任务的所有测试点，**第一问都回答正确，但第二问没有都回答正确**，你将获得这个子任务的部分分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "交通运输（Wormhole Transportation）", "background": "**本题数据点较多，请勿恶意提交。如发现恶意提交的，可能面临封号的处罚。**\n\n天体风暴过后，永恒大陆的交通急需重建。", "description": "永恒大陆上有 $n$ 个基地，基地编号为 $1, 2, \\ldots , n$。\n\n现在有 $m$ 条运输任务，第 $i$ 条形如：将货物从基地 $u_i$ 运输到基地 $v_i$。\n\n然而灾后交通并不发达，因此你决定使用虫洞：可以在任意两个不同基地 $x,y$ 之间建立一个虫洞：货物从虫洞的一端传输到虫洞的另一端只需要花费 $1$ 单位的时间。\n\n而且，**运输的方向是双向的**，也就是说，假设建立了一个连接了基地 $a, b$ 的虫洞，那么货物既可以从基地 $a$ 运输到基地 $b$，也可以从基地 $b$ 运输到基地 $a$。\n\n但建立虫洞的代价是昂贵的，你决定只建立**恰好** $\\boldsymbol{m - 1}$ 个虫洞，且不能有两个虫洞连接的两个基地完全相同。\n\n你想要知道，在所有的建造方案中， $m$ 条运输任务所花费的时间之和最小能是多少，此外，在花费的时间之和最小的情况下，有多少种建造虫洞的方案。\n\n由于第二个问题的答案可能很大，你只需要输出方案数对 ${10}^9 + 7$ 取模的结果。", "inputFormat": "第一行：三个整数 $n,m,t$，其中 $t$ 为子任务编号，对于样例来说 $t=0$。\n\n接下来 $m$ 行：每行两个整数 $u_i,v_i$。", "outputFormat": "第一行，一个整数，表示 $m$ 条运输任务所花费的时间之和的最小值。\n\n第二行，一个整数，表示建造虫洞的方案数对 ${10}^9 + 7$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n有三种建造方案。\n\n其中一种是在城市 $1, 2$ 之间建立虫洞，在城市 $2, 3$ 之间建立虫洞，这样，前两条任务的时间都为 $1$，最后一条的时间为 $2$。\n\n另外两种方案是：在城市 $1, 2$ 和 $1, 3$ 之间建立虫洞，或在城市 $1, 3$ 和 $2, 3$ 之间建立虫洞。\n\n---\n\n**【数据范围】**\n\n对于所有数据，$2 \\le n \\le 2000$，$2 \\le n \\cdot m \\le 2 \\times {10}^7$，$1 \\le u_i, v_i \\le n$，$u_i\\ne v_i$。\n\n保证所有无序对 $(u_i, v_i)$ 两两不同，且至少存在一种合法的建造虫洞的方案。\n\n| 子任务编号 | 分值 | $n \\le$ | 特殊限制 | 部分分 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $6$ | 无 | $0$ |\n| $2$ | $12$ | $2000$ | $m=n$，且 $u_i=i,\\ v_i=i\\bmod n+1$ | $3$ |\n| $3$ | $12$ | $2000$ | 由所有 $(u_i,v_i)$ 为无向边构成的图为仙人掌森林 | $3$ |\n| $4$ | $25$ | $2000$ | 由所有 $(u_i,v_i)$ 为无向边构成的图为杏仁 | $8$ |\n| $5$ | $27$ | $300$ | $m\\leq 1000$ | $8$ |\n| $6$ | $14$ | $2000$ | 无 | $3$ |\n\n仙人掌森林：每条边在至多一个简单环中的无向图。\n\n杏仁：恰好存在两个度数大于 $2$ 的结点，其他结点度数都等于 $2$，且所有环都经过两个度数大于 $2$ 的结点的连通无向图。\n\n当你对于某个子任务的所有测试点，**第一问都回答正确，但第二问没有都回答正确**，你将获得这个子任务的部分分。", "locale": "zh-CN"}}}
{"pid": "P7730", "type": "P", "difficulty": 6, "samples": [["3 3\n1 3 2\n- 1 10\n- 2 3\n+ 1 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["网络流", "二分图", "费用流"], "title": "[JDWOI-1] 蜀道难", "background": "蜀道难，难于上青天…… \n\n蜀道之所以难，就是因为山路崎岖不平。", "description": "小 K 和小 M 也模拟了蜀道难。在蜀道难中，有 $n$ 座山，每座山高度为 $h_i$。小 K 和小 M 有 $m$ 种魔法，每一次魔法可以把连续 $l_i$ 座山的高度抬高或压低 $1$，同时消耗 $c_i$ 点体力。\n\n现在，小 K 和小 M 想让蜀道难的 $n$ 座山的高度不下降，这样蜀道就不难了。请问他们最少需消耗多少体力？\n\n**注**：所有时候山的高度都不能为负。", "inputFormat": "第一行两个整数 $n,m$，表示山的数量和魔法数量。\n\n第二行 $n$ 个整数 $h_i$，表示山的高度。\n\n接下来 $m$ 行，每行一个字符和两个整数 $w_i, l_i, c_i$，描述一种魔法（如果 $w_i$ 为 $+$，代表抬高；如果 $w_i$ 为 $-$，代表压低）。", "outputFormat": "一行一个整数，表示最小消耗的体力。\n\n如果无解，输出 $-1$。", "hint": "### 样例解释\n\n使用 $1$ 体力值将第三座山升高 $1$。\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据，$1\\leq n,m \\leq 10$；\n- 对于另外 $30\\%$ 的数据，$1\\leq n,m \\leq 20$；\n- 对于另外 $10\\%$ 的数据，$m=1$；\n- 对于所有的数据，$1\\leq n, m \\leq 200$，$1\\leq l_i \\leq n$，$1\\leq h_i, c_i \\leq 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JDWOI-1] 蜀道难", "background": "蜀道难，难于上青天…… \n\n蜀道之所以难，就是因为山路崎岖不平。", "description": "小 K 和小 M 也模拟了蜀道难。在蜀道难中，有 $n$ 座山，每座山高度为 $h_i$。小 K 和小 M 有 $m$ 种魔法，每一次魔法可以把连续 $l_i$ 座山的高度抬高或压低 $1$，同时消耗 $c_i$ 点体力。\n\n现在，小 K 和小 M 想让蜀道难的 $n$ 座山的高度不下降，这样蜀道就不难了。请问他们最少需消耗多少体力？\n\n**注**：所有时候山的高度都不能为负。", "inputFormat": "第一行两个整数 $n,m$，表示山的数量和魔法数量。\n\n第二行 $n$ 个整数 $h_i$，表示山的高度。\n\n接下来 $m$ 行，每行一个字符和两个整数 $w_i, l_i, c_i$，描述一种魔法（如果 $w_i$ 为 $+$，代表抬高；如果 $w_i$ 为 $-$，代表压低）。", "outputFormat": "一行一个整数，表示最小消耗的体力。\n\n如果无解，输出 $-1$。", "hint": "### 样例解释\n\n使用 $1$ 体力值将第三座山升高 $1$。\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据，$1\\leq n,m \\leq 10$；\n- 对于另外 $30\\%$ 的数据，$1\\leq n,m \\leq 20$；\n- 对于另外 $10\\%$ 的数据，$m=1$；\n- 对于所有的数据，$1\\leq n, m \\leq 200$，$1\\leq l_i \\leq n$，$1\\leq h_i, c_i \\leq 10^3$。", "locale": "zh-CN"}}}
{"pid": "P7731", "type": "P", "difficulty": 2, "samples": [["1\n1 1 1 2\n50 -30", "0"], ["2\n1 2 2 2\n1 0\n2 0", "-1"], ["2\n1 -1 2 1\n1 0\n2 0", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2021"], "title": "『PG1』[JDWOI-2] 猪猪大厦", "background": "", "description": "$ \\texttt{piggy} $ 建了一个巨大无比的 $\\texttt {PIG}$ 大厦，可以看做一个平面，在这个平面上有 $n$ 个无限长的不垂直或平行于地面的扶手电梯，可以看做一些一次函数，并且这些电梯方向均朝右即 $x$ 轴正方向。\n\n两个电梯的交汇点可以花 $1 \\ \\texttt{ZMB}$ 换乘。\n\n一个人想要给  $ \\texttt{piggy} $ 发短信让 $ \\texttt{piggy} $ 过去找他 。\n\n但是：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/m2hw7oer.png)\n\n于是只能走过去找 $ \\texttt{piggy} $。\n\n此时他站在第 $x_1$ 个电梯的横坐标为 $y_1$ 位置。\n\n$ \\texttt{piggy} $ 在第 $x_2$ 个电梯的横坐标为 $y_2$ 位置。\n\n请问他最少花多少 $\\texttt{ZMB}$ 才能过去？\n\n", "inputFormat": "第一行一个正整数 $n$。\n\n第二行四个整数 $x_1,y_1,x_2,y_2$。\n\n接下来 $n$ 行，第 $i$ 行两个数 $k_i,b_i$，表示电梯的解析式为 $y=k_ix+b_i$。", "outputFormat": "最少花多少 $\\texttt{ZMB}$？如果无法到达，输出 `-1`。", "hint": "**本题采用 Subtask。**\n\n$\\sf Subtask1(20pts)$：$1 \\le n \\le 10$；\n\n$\\sf Subtask2(30pts)$：$1 \\le n\\le 1000$；\n\n$\\sf Subtask3(50pts)$：$1 \\le x_1,x_2 \\le n\\le 10^5$，$-10^3 \\le y_1,y_2,k_i,b_i \\le 10^3$。\n\n**电梯的编号从 1 开始。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『PG1』[JDWOI-2] 猪猪大厦", "background": "", "description": "$ \\texttt{piggy} $ 建了一个巨大无比的 $\\texttt {PIG}$ 大厦，可以看做一个平面，在这个平面上有 $n$ 个无限长的不垂直或平行于地面的扶手电梯，可以看做一些一次函数，并且这些电梯方向均朝右即 $x$ 轴正方向。\n\n两个电梯的交汇点可以花 $1 \\ \\texttt{ZMB}$ 换乘。\n\n一个人想要给  $ \\texttt{piggy} $ 发短信让 $ \\texttt{piggy} $ 过去找他 。\n\n但是：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/m2hw7oer.png)\n\n于是只能走过去找 $ \\texttt{piggy} $。\n\n此时他站在第 $x_1$ 个电梯的横坐标为 $y_1$ 位置。\n\n$ \\texttt{piggy} $ 在第 $x_2$ 个电梯的横坐标为 $y_2$ 位置。\n\n请问他最少花多少 $\\texttt{ZMB}$ 才能过去？\n\n", "inputFormat": "第一行一个正整数 $n$。\n\n第二行四个整数 $x_1,y_1,x_2,y_2$。\n\n接下来 $n$ 行，第 $i$ 行两个数 $k_i,b_i$，表示电梯的解析式为 $y=k_ix+b_i$。", "outputFormat": "最少花多少 $\\texttt{ZMB}$？如果无法到达，输出 `-1`。", "hint": "**本题采用 Subtask。**\n\n$\\sf Subtask1(20pts)$：$1 \\le n \\le 10$；\n\n$\\sf Subtask2(30pts)$：$1 \\le n\\le 1000$；\n\n$\\sf Subtask3(50pts)$：$1 \\le x_1,x_2 \\le n\\le 10^5$，$-10^3 \\le y_1,y_2,k_i,b_i \\le 10^3$。\n\n**电梯的编号从 1 开始。**", "locale": "zh-CN"}}}
{"pid": "P7732", "type": "P", "difficulty": 5, "samples": [["2\n5\nRRBBR\n1 2\n1 3\n2 4\n2 5\nBRBRB\n5\nRRRRR\n1 2\n2 3\n3 4\n4 5\nBBBBB", "3\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "状压 DP"], "title": "[JDWOI-2] 红黑树", "background": "小 M 迷上了画画，所以她用红色和黑色的画笔画出了一棵红黑树。", "description": "这棵树有 $n$ 个点，从 $1$ 开始标号，其中 $1$ 号点为树根。一开始，小 M 给这 $n$ 个点分别涂上了红色或黑色，第 $i$ 号点的颜色是 $a_i$（'R' 代表红色，'B' 代表黑色）。\n\n但可惜的是，小 M 对这棵树并不是非常满意，她希望第 $i$ 号点的颜色为 $b_i$。\n\n好在她的好朋友小 K 懂得一点点膜法。小 K 可以先选定一个点，然后把这个点的颜色反转（红变黑，黑变红）。但这个膜法太强大了，所以会把膜法传递下去，即在反转的一秒之后使当前点的父节点颜色也进行反转，如此传递，直到根节点为止。特殊的，如果在同一时刻有多个膜法作用在同一个点上，这些膜法会两两抵消，如果恰好抵消完了（即膜法的个数为偶数），则当前点不会变色，并且不会有膜法继续传递下去。注意此处抵消膜法不需要耗时间。\n\n但毕竟小 K 还是个新手，所以他在一秒之内只能最多对一个节点施展上述膜法。\n\n为了尽快让小 M 开心，小 K 想知道，至少经过多少秒才能让这棵红黑树初次出现小 M 的理想颜色状态？可以证明，总可以按题目要求变成理想颜色状态。", "inputFormat": "**本题多测**。\n\n第一行一个整数 $Q$，表示数据组数。\n\n**对于每组数据：**\n\n第一行一个整数 $n$，表示红黑树的节点数。\n\n第二行一个长度为 $n$ 的字符串 $a$，表示红黑树的初始颜色状态，其中仅含有 'R' 或 'B'。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，描述一条树边。\n\n最后一行一个长度为 $n$ 的字符串 $b$，表示红黑树的理想颜色状态，其中仅含有 'R' 或 'B'。", "outputFormat": "共 $Q$ 行每行一个整数，一组数据一行，表示答案，即最小耗时。", "hint": "**【样例解释】**\n\n第一组数据中，小 K 可以在第 $1$ 秒给 $4$ 号点膜法，整个树变为 RRBRR，在第 $2$ 秒给 $5$ 号点膜法，整个树变成 RBBRB，在第 $3$ 秒给 $1$ 号点膜法，整个树变成 BRBRB。\n\n第二组数据中，小 K 可以在第 $1$ 秒给 $5$ 号点膜法，在第二秒给 $2$ 号点膜法；或者在第 $1$ 秒给 $3$ 号点膜法，在第 $2$ 秒给 $5$ 号点膜法。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，$1\\leq n\\leq 5$；\n\n对于 $30\\%$ 的数据，$1\\leq n\\leq 10$；\n\n对于另外 $20\\%$ 的数据，$\\forall a_i\\neq b_i$；\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 20$，$1\\leq Q\\leq 20$，树随机生成。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JDWOI-2] 红黑树", "background": "小 M 迷上了画画，所以她用红色和黑色的画笔画出了一棵红黑树。", "description": "这棵树有 $n$ 个点，从 $1$ 开始标号，其中 $1$ 号点为树根。一开始，小 M 给这 $n$ 个点分别涂上了红色或黑色，第 $i$ 号点的颜色是 $a_i$（'R' 代表红色，'B' 代表黑色）。\n\n但可惜的是，小 M 对这棵树并不是非常满意，她希望第 $i$ 号点的颜色为 $b_i$。\n\n好在她的好朋友小 K 懂得一点点膜法。小 K 可以先选定一个点，然后把这个点的颜色反转（红变黑，黑变红）。但这个膜法太强大了，所以会把膜法传递下去，即在反转的一秒之后使当前点的父节点颜色也进行反转，如此传递，直到根节点为止。特殊的，如果在同一时刻有多个膜法作用在同一个点上，这些膜法会两两抵消，如果恰好抵消完了（即膜法的个数为偶数），则当前点不会变色，并且不会有膜法继续传递下去。注意此处抵消膜法不需要耗时间。\n\n但毕竟小 K 还是个新手，所以他在一秒之内只能最多对一个节点施展上述膜法。\n\n为了尽快让小 M 开心，小 K 想知道，至少经过多少秒才能让这棵红黑树初次出现小 M 的理想颜色状态？可以证明，总可以按题目要求变成理想颜色状态。", "inputFormat": "**本题多测**。\n\n第一行一个整数 $Q$，表示数据组数。\n\n**对于每组数据：**\n\n第一行一个整数 $n$，表示红黑树的节点数。\n\n第二行一个长度为 $n$ 的字符串 $a$，表示红黑树的初始颜色状态，其中仅含有 'R' 或 'B'。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，描述一条树边。\n\n最后一行一个长度为 $n$ 的字符串 $b$，表示红黑树的理想颜色状态，其中仅含有 'R' 或 'B'。", "outputFormat": "共 $Q$ 行每行一个整数，一组数据一行，表示答案，即最小耗时。", "hint": "**【样例解释】**\n\n第一组数据中，小 K 可以在第 $1$ 秒给 $4$ 号点膜法，整个树变为 RRBRR，在第 $2$ 秒给 $5$ 号点膜法，整个树变成 RBBRB，在第 $3$ 秒给 $1$ 号点膜法，整个树变成 BRBRB。\n\n第二组数据中，小 K 可以在第 $1$ 秒给 $5$ 号点膜法，在第二秒给 $2$ 号点膜法；或者在第 $1$ 秒给 $3$ 号点膜法，在第 $2$ 秒给 $5$ 号点膜法。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，$1\\leq n\\leq 5$；\n\n对于 $30\\%$ 的数据，$1\\leq n\\leq 10$；\n\n对于另外 $20\\%$ 的数据，$\\forall a_i\\neq b_i$；\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 20$，$1\\leq Q\\leq 20$，树随机生成。", "locale": "zh-CN"}}}
{"pid": "P7733", "type": "P", "difficulty": 5, "samples": [["4 3\n1 2\n2 3\n3 4\n1 4", "1"], ["6 7\n1 2\n2 3\n3 1\n4 5\n5 6\n6 4\n1 4\n1 4", "2"], ["15 14\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n3 11\n11 12\n12 13\n13 14\n14 15\n1 10", "6"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "最短路"], "title": "[JDWOI-2] 抢救实验数据", "background": "某大型实验中心的一个实验室发生了毒气泄露，现在实验员想要抢救实验数据。", "description": "实验中心可以看做一个 $n$ 个点 $m$ 条边的无向联通图。  \n所有实验员每秒可以走到一个相邻的实验室并**收集**其中的数据，毒气每秒会蔓延到所有的相邻实验室。\n当一个实验员**回到了大厅 $s$**，我们称他**抢救**了数据。  \n实验员不能进入有毒气的实验室（如果他和毒气在同一秒进入实验室也不行）。  \n**大厅周围有严格的保护措施，不会被毒气蔓延。（具体可以参考样例二）**  \n现在所有实验员都在大厅 $s$，毒气泄露的实验室为点 $t$。假如有**足够多**的实验员同时出发，请问最多能抢救多少个实验室的数据？", "inputFormat": "第一行两个正整数 $n,m$，表示实验中心的点数和边数。  \n第二至 $m+1$ 行每行两个正整数 $u,v$，代表 $u,v$ 实验室之间有一条边。  \n第 $m+2$ 行两个正整数 $s,t$，表示大厅和毒气泄露点。", "outputFormat": "一行一个整数，表示最多能抢救多少个的实验室的数据。", "hint": "**请注意常数因子带来的程序效率上的影响。**\n\n【样例解释一】  \n只有 2 号实验室可以到达并回来。\n\n【样例解释二】  \n因为大厅是坚不可摧的，所以 5,6 两个实验室会被毒气蔓延到，而 2,3 两个实验室永远不会被蔓延到。\n\n【样例解释三】  \n可以被抢救的点为：2,3,4,5,11,12。\n\n【数据范围】  \n**本题采用捆绑测试**。  \n对于 $10\\%$ 的数据，$2 \\leq n,m \\leq 20$；  \n对于 $30\\%$ 的数据，$2 \\leq n \\leq 2000,1 \\leq m \\leq 10000$；  \n对于 $70\\%$ 的数据，$2 \\leq n \\leq 2 \\times 10^5$；  \n对于 $100\\%$ 的数据，$2 \\leq n,m \\leq 5 \\times 10^6$。\n\n由于读入量很大，这里提供 std 使用的快读模板（提交时需要选择 C++11 及以上)\n```cpp\nchar gc() {\n  static char now[1 << 20], *S, *T;\n  if (T == S) {\n    T = (S = now) + std::fread(now, 1, 1 << 20, stdin);\n    if (T == S) return EOF;\n  }\n  return *S++;\n}\ntemplate <typename T>\nvoid Read(T &x) {\n  x = 0;\n  char c = gc();\n  while (c < '0' || c > '9') c = gc();\n  x = c - '0';\n  while ((c = gc()) >= '0' && c <= '9') x = x * 10 + c - '0';\n}\ntemplate <typename T, typename... Args>\nvoid Read(T &x, Args &... args) {\n  Read(x);\n  Read(args...);\n}\n```\n使用方法：`Read(n, m)` 或 `Read(x, y, z)` 等，可以读入任意个数，但是不能与 `std::cin` 和 `std::scanf` 一起使用。读入完成后 Windows 系统按 Ctrl+Z，Linux 系统按 Ctrl+D 结束。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JDWOI-2] 抢救实验数据", "background": "某大型实验中心的一个实验室发生了毒气泄露，现在实验员想要抢救实验数据。", "description": "实验中心可以看做一个 $n$ 个点 $m$ 条边的无向联通图。  \n所有实验员每秒可以走到一个相邻的实验室并**收集**其中的数据，毒气每秒会蔓延到所有的相邻实验室。\n当一个实验员**回到了大厅 $s$**，我们称他**抢救**了数据。  \n实验员不能进入有毒气的实验室（如果他和毒气在同一秒进入实验室也不行）。  \n**大厅周围有严格的保护措施，不会被毒气蔓延。（具体可以参考样例二）**  \n现在所有实验员都在大厅 $s$，毒气泄露的实验室为点 $t$。假如有**足够多**的实验员同时出发，请问最多能抢救多少个实验室的数据？", "inputFormat": "第一行两个正整数 $n,m$，表示实验中心的点数和边数。  \n第二至 $m+1$ 行每行两个正整数 $u,v$，代表 $u,v$ 实验室之间有一条边。  \n第 $m+2$ 行两个正整数 $s,t$，表示大厅和毒气泄露点。", "outputFormat": "一行一个整数，表示最多能抢救多少个的实验室的数据。", "hint": "**请注意常数因子带来的程序效率上的影响。**\n\n【样例解释一】  \n只有 2 号实验室可以到达并回来。\n\n【样例解释二】  \n因为大厅是坚不可摧的，所以 5,6 两个实验室会被毒气蔓延到，而 2,3 两个实验室永远不会被蔓延到。\n\n【样例解释三】  \n可以被抢救的点为：2,3,4,5,11,12。\n\n【数据范围】  \n**本题采用捆绑测试**。  \n对于 $10\\%$ 的数据，$2 \\leq n,m \\leq 20$；  \n对于 $30\\%$ 的数据，$2 \\leq n \\leq 2000,1 \\leq m \\leq 10000$；  \n对于 $70\\%$ 的数据，$2 \\leq n \\leq 2 \\times 10^5$；  \n对于 $100\\%$ 的数据，$2 \\leq n,m \\leq 5 \\times 10^6$。\n\n由于读入量很大，这里提供 std 使用的快读模板（提交时需要选择 C++11 及以上)\n```cpp\nchar gc() {\n  static char now[1 << 20], *S, *T;\n  if (T == S) {\n    T = (S = now) + std::fread(now, 1, 1 << 20, stdin);\n    if (T == S) return EOF;\n  }\n  return *S++;\n}\ntemplate <typename T>\nvoid Read(T &x) {\n  x = 0;\n  char c = gc();\n  while (c < '0' || c > '9') c = gc();\n  x = c - '0';\n  while ((c = gc()) >= '0' && c <= '9') x = x * 10 + c - '0';\n}\ntemplate <typename T, typename... Args>\nvoid Read(T &x, Args &... args) {\n  Read(x);\n  Read(args...);\n}\n```\n使用方法：`Read(n, m)` 或 `Read(x, y, z)` 等，可以读入任意个数，但是不能与 `std::cin` 和 `std::scanf` 一起使用。读入完成后 Windows 系统按 Ctrl+Z，Linux 系统按 Ctrl+D 结束。", "locale": "zh-CN"}}}
{"pid": "P7734", "type": "P", "difficulty": 6, "samples": [["1100..", "1\n1 5\n"], ["0101..", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "构造"], "title": "[JDWOI-2] 01 串", "background": "小 K 和小 M 写了一个 01 串。", "description": "小 K 和小 M 写了一个 01 串 $S$，串的**结尾**包含 2 个连在一起的空格（用 `.` 表示）。\n\n小 M 定义一个 01 串是美观的，当且仅当串中没有逆序对，即没有 1 出现在 0 的前面。\n\n为了满足小 M 的上述要求，小 K 决定对这个 01 串进行一些修改。每一次修改，小 K 可以选择串中两个连续的非空格字符，并把他们移动到空格的位置，并且不改变相对位置。这样，被移动的字符处会变成空格，而原来的空格会被这两个字符填起来。\n\n小 K 为了尽快让字符串变美观，希望在 $10000$ 步以内完成。现在，请求出需要用多少步使得 01 串变美观，并输出方案。如果无法使串美观，或者步数必须超过 $10000$ ，请输出 `-1`。\n\n**注：你并不需要最小化修改步数，并且最终空格的位置随便。**", "inputFormat": "一行一个 01 字符串，保证输入符合题意。", "outputFormat": "第一行一个整数 $m$，表示修改的步数。  \n\n接下来 $m$ 行，每行两个整数 $x,y$，表示将 $(x,x+1)$ 位置上的两个数移动到 $(y,y+1)$。", "hint": "**本题采用 Special Judge 和子任务评测。**\n\n【样例解释 1】  \n\n$\\texttt{1100..} \\rightarrow \\texttt{..0011}$\n\n【样例解释 2】  \n\n可以发现无论如何移动都无法实现小 M 要求的 01 串。\n\n【数据范围和子任务分数】  \n\nSubtask1(20pts)：$3 \\leq |S| \\leq 10$；  \nSubtask2(30pts)：$3 \\leq |S| \\leq 100$；  \nSubtask3(50pts)：$3 \\leq |S| \\leq 2000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JDWOI-2] 01 串", "background": "小 K 和小 M 写了一个 01 串。", "description": "小 K 和小 M 写了一个 01 串 $S$，串的**结尾**包含 2 个连在一起的空格（用 `.` 表示）。\n\n小 M 定义一个 01 串是美观的，当且仅当串中没有逆序对，即没有 1 出现在 0 的前面。\n\n为了满足小 M 的上述要求，小 K 决定对这个 01 串进行一些修改。每一次修改，小 K 可以选择串中两个连续的非空格字符，并把他们移动到空格的位置，并且不改变相对位置。这样，被移动的字符处会变成空格，而原来的空格会被这两个字符填起来。\n\n小 K 为了尽快让字符串变美观，希望在 $10000$ 步以内完成。现在，请求出需要用多少步使得 01 串变美观，并输出方案。如果无法使串美观，或者步数必须超过 $10000$ ，请输出 `-1`。\n\n**注：你并不需要最小化修改步数，并且最终空格的位置随便。**", "inputFormat": "一行一个 01 字符串，保证输入符合题意。", "outputFormat": "第一行一个整数 $m$，表示修改的步数。  \n\n接下来 $m$ 行，每行两个整数 $x,y$，表示将 $(x,x+1)$ 位置上的两个数移动到 $(y,y+1)$。", "hint": "**本题采用 Special Judge 和子任务评测。**\n\n【样例解释 1】  \n\n$\\texttt{1100..} \\rightarrow \\texttt{..0011}$\n\n【样例解释 2】  \n\n可以发现无论如何移动都无法实现小 M 要求的 01 串。\n\n【数据范围和子任务分数】  \n\nSubtask1(20pts)：$3 \\leq |S| \\leq 10$；  \nSubtask2(30pts)：$3 \\leq |S| \\leq 100$；  \nSubtask3(50pts)：$3 \\leq |S| \\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P7735", "type": "P", "difficulty": 6, "samples": [["1\n7 7\n1 2\n1 3\n3 4\n3 5\n3 6\n6 7\n1 1 7\n2 1 4\n2 2 7\n1 1 5\n2 2 7\n1 2 1\n2 1 7", "1\n3\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["线段树", "2021", "NOI", "O2优化", "树链剖分", "动态树 LCT"], "title": "[NOI2021] 轻重边", "background": "", "description": "小 W 有一棵 $n$ 个结点的树，树上的每一条边可能是轻边或者重边。接下来你需要对树进行 $m$ 次操作，在所有操作开始前，树上所有边都是轻边。操作有以下两种：\n1. 给定两个点 $a$ 和 $b$，首先对于 $a$ 到 $b$ 路径上的所有点 $x$（包含 $a$ 和 $b$），你要将与 $x$ 相连的所有边变为轻边。然后再将 $a$ 到 $b$ 路径上包含的所有边变为重边。\n2. 给定两个点 $a$ 和 $b$，你需要计算当前 $a$ 到 $b$ 的路径上一共包含多少条重边。\n", "inputFormat": "本题有多组数据，输入数据第一行一个正整数 $T$，表示数据组数。对于每组数据：\n\n第一行包含两个整数 $n$ 和 $m$，其中 $n$ 表示结点数量，$m$ 表示操作数量。\n\n接下来 $n - 1$ 行，每行包含两个整数 $u\\ v$，表示树上的一条边。\n\n接下来 $m$ 行，每行包含三个整数 ${\\mathit{op}}_i\\ a_i\\ b_i$，描述一个操作，其中 ${\\mathit{op}}_i = 1$ 表示第 $1$ 类操作，${\\mathit{op}}_i = 2$ 表示第 $2$ 类操作。\n\n数据保证 $a_i \\neq b_i$。", "outputFormat": "对于每一次第 $2$ 类操作，输出一行一个整数表示答案。", "hint": "**【样例解释 #1】**\n\n第 $1$ 次操作后，重边有：$(1, 3)$，$(3, 6)$，$(6, 7)$。\n\n第 $2$ 次操作，包含的重边有：$(1, 3)$。\n\n第 $3$ 次操作，包含的重边有：$(1, 3)$，$(3, 6)$，$(6, 7)$。\n\n第 $4$ 次操作，首先 $(1, 3)$，$(3, 6)$ 变为轻边，之后 $(1, 3)$，$(3, 5)$ 变为重边。\n\n第 $5$ 次操作，包含的重边有：$(1, 3)$，$(6, 7)$。\n\n第 $6$ 次操作，首先 $(1, 3)$ 变为轻边，之后 $(1, 2)$ 变为重边。\n\n第 $7$ 次操作，包含的重边有：$(6, 7)$。\n\n**【样例 #2】**\n\n见附件 `edge/edge2.in` 与 `edge/edge2.ans`。\n\n该样例约束与测试点 $3 \\sim 6$ 一致。\n\n**【样例 #3】**\n\n见附件 `edge/edge3.in` 与 `edge/edge3.ans`。\n\n该样例约束与测试点 $9 \\sim 10$ 一致。\n\n**【样例 #4】**\n\n见附件 `edge/edge4.in` 与 `edge/edge4.ans`。\n\n该样例约束与测试点 $11 \\sim 14$ 一致。\n\n**【样例 #5】**\n\n见附件 `edge/edge5.in` 与 `edge/edge5.ans`。\n\n该样例约束与测试点 $17 \\sim 20$ 一致。\n\n**【数据范围】**\n\n对于所有测试数据：$T \\le 3$，$1 \\le n, m \\le {10}^5$。\n\n| 测试点编号 | $n, m \\le $ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 6$ | $5000$ | 无 |\n| $7 \\sim 8$ | ${10}^5$ | A，B |\n| $9 \\sim 10$ | ${10}^5$ | A |\n| $11 \\sim 14$ | ${10}^5$ | B |\n| $15 \\sim 16$ | $2\\times {10}^4$ | 无 |\n| $17 \\sim 20$ | ${10}^5$ | 无 |\n\n特殊性质 A：树的形态是一条链。\n\n特殊性质 B：第 $2$ 类操作给出的 $a_i$ 和 $b_i$ 之间有边直接相连。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 轻重边", "background": "", "description": "小 W 有一棵 $n$ 个结点的树，树上的每一条边可能是轻边或者重边。接下来你需要对树进行 $m$ 次操作，在所有操作开始前，树上所有边都是轻边。操作有以下两种：\n1. 给定两个点 $a$ 和 $b$，首先对于 $a$ 到 $b$ 路径上的所有点 $x$（包含 $a$ 和 $b$），你要将与 $x$ 相连的所有边变为轻边。然后再将 $a$ 到 $b$ 路径上包含的所有边变为重边。\n2. 给定两个点 $a$ 和 $b$，你需要计算当前 $a$ 到 $b$ 的路径上一共包含多少条重边。\n", "inputFormat": "本题有多组数据，输入数据第一行一个正整数 $T$，表示数据组数。对于每组数据：\n\n第一行包含两个整数 $n$ 和 $m$，其中 $n$ 表示结点数量，$m$ 表示操作数量。\n\n接下来 $n - 1$ 行，每行包含两个整数 $u\\ v$，表示树上的一条边。\n\n接下来 $m$ 行，每行包含三个整数 ${\\mathit{op}}_i\\ a_i\\ b_i$，描述一个操作，其中 ${\\mathit{op}}_i = 1$ 表示第 $1$ 类操作，${\\mathit{op}}_i = 2$ 表示第 $2$ 类操作。\n\n数据保证 $a_i \\neq b_i$。", "outputFormat": "对于每一次第 $2$ 类操作，输出一行一个整数表示答案。", "hint": "**【样例解释 #1】**\n\n第 $1$ 次操作后，重边有：$(1, 3)$，$(3, 6)$，$(6, 7)$。\n\n第 $2$ 次操作，包含的重边有：$(1, 3)$。\n\n第 $3$ 次操作，包含的重边有：$(1, 3)$，$(3, 6)$，$(6, 7)$。\n\n第 $4$ 次操作，首先 $(1, 3)$，$(3, 6)$ 变为轻边，之后 $(1, 3)$，$(3, 5)$ 变为重边。\n\n第 $5$ 次操作，包含的重边有：$(1, 3)$，$(6, 7)$。\n\n第 $6$ 次操作，首先 $(1, 3)$ 变为轻边，之后 $(1, 2)$ 变为重边。\n\n第 $7$ 次操作，包含的重边有：$(6, 7)$。\n\n**【样例 #2】**\n\n见附件 `edge/edge2.in` 与 `edge/edge2.ans`。\n\n该样例约束与测试点 $3 \\sim 6$ 一致。\n\n**【样例 #3】**\n\n见附件 `edge/edge3.in` 与 `edge/edge3.ans`。\n\n该样例约束与测试点 $9 \\sim 10$ 一致。\n\n**【样例 #4】**\n\n见附件 `edge/edge4.in` 与 `edge/edge4.ans`。\n\n该样例约束与测试点 $11 \\sim 14$ 一致。\n\n**【样例 #5】**\n\n见附件 `edge/edge5.in` 与 `edge/edge5.ans`。\n\n该样例约束与测试点 $17 \\sim 20$ 一致。\n\n**【数据范围】**\n\n对于所有测试数据：$T \\le 3$，$1 \\le n, m \\le {10}^5$。\n\n| 测试点编号 | $n, m \\le $ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 6$ | $5000$ | 无 |\n| $7 \\sim 8$ | ${10}^5$ | A，B |\n| $9 \\sim 10$ | ${10}^5$ | A |\n| $11 \\sim 14$ | ${10}^5$ | B |\n| $15 \\sim 16$ | $2\\times {10}^4$ | 无 |\n| $17 \\sim 20$ | ${10}^5$ | 无 |\n\n特殊性质 A：树的形态是一条链。\n\n特殊性质 B：第 $2$ 类操作给出的 $a_i$ 和 $b_i$ 之间有边直接相连。", "locale": "zh-CN"}}}
{"pid": "P7736", "type": "P", "difficulty": 6, "samples": [["1\n3\n2 3 2\n4 4\n1 1 \n1 2\n2 1\n2 3\n1 2\n2 1\n3 1\n3 2", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "LGV 引理", "NOI", "O2优化"], "title": "[NOI2021] 路径交点", "background": "", "description": "小 L 有一个有向图，图中的顶点可以分为 $k$ 层，第 $i$ 层有 $n_i$ 个顶点，第 $1$ 层与第 $k$ 层**顶点数相同**，即 $n_1 = n_k$，且对于第 $j$（$2 \\leq j \\leq k-1$）层，$n_1 \\leq n_j \\leq 2n_1$。对于第 $j$（$1 \\leq j < k$）层的顶点，以它们为起点的边只会连向第 $j + 1$ 层的顶点。没有边连向第 $1$ 层的顶点，第 $k$ 层的顶点不会向其他顶点连边。\n\n现在小 L 要从这个图中选出 $n_1$ 条路径，每条路径以第 $1$ 层顶点为起点，第 $k$ 层顶点为终点，并要求**图中的每个顶点至多出现在一条路径中**。更具体地，把每一层顶点按照 $1,2,\\ldots,n_i$ 进行编号，则每条路径可以写为一个 $k$ 元组 $(p_1,p_2,\\ldots,p_k)$，表示这条路径依次经过第 $j$ 层的 $p_j$（$1 \\leq p_j \\leq n_j$）号顶点，并且第 $j$（$1 \\leq j < k$）层的 $p_j$ 号顶点有一条边连向第 $j+1$ 层的第 $p_{j+1}$ 号顶点。\n\n小 L 把这些路径画在了纸上，发现它们会产生若干个交点。对于两条路径 $P,Q$，分别设它们在第 $j$ 层与第 $j+1$ 层之间的连边为 $(P_j,P_{j+1})$ 与 $(Q_j,Q_{j+1})$，若，\n\n$$(P_j-Q_j)\\times(P_{j+1}-Q_{j+1})<0$$\n\n则称它们在第 $j$ 层后产生了一个交点。两条路径的交点数为它们在第 $1, 2,\\ldots,k - 1$ 层后产生的交点总数。对于整个路径方案，它的交点数为**两两不同路径间交点数之和**。例如下图是一个 $3$ 条路径，共 $3$ 个交点的例子，其中红色点是交点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pvr0iwkt.png)\n\n小 L 现在想知道有偶数个交点的路径方案数比有奇数个交点的路径方案数多多少个。两个路径方案被视为相同的，当且仅当它们的 $n_1$ 条路径按第一层起点编号顺序写下的 $k$ 元组能对应相同。由于最后的结果可能很大，请你输出它对 $998244353$（一个大质数）取模后的值。", "inputFormat": "本题有多组数据，输入数据第一行一个正整数 $T$ ，表示数据组数。对于每组数据：\n\n第一行一个正整数 $k$，表示一共有 $k$ 层顶点。\n\n第二行包含 $k$ 个整数 $n_1,n_2,\\ldots,n_k$，依次表示每一层的顶点数量。保证 $n_1=n_k$，且 $n_1 \\leq n_i \\leq 2n_1$（$2 \\leq i \\leq k-1$）。\n\n第三行包含 $k-1$ 个整数 $m_1,m_2,\\ldots,m_{k-1}$，依次表示第 $j$ 层顶点到第 $j+1$ 层顶点的边数。保证 $m_j \\leq n_j \\times n_{j+1}$。\n\n接下来有 $k-1$ 段输入。第 $j$（$1 \\leq j < k$）段输入包含 $m_j$ 行，每一行两个整数 $u,v$，表示第 $j$ 层的 $u$ 号顶点有一条边连向第 $j+1$ 层的 $v$ 号顶点。\n\n数据保证图中不会出现重边。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示该组数据的答案对 $998244353$ 取模后的值。", "hint": "**【样例解释 #1】**\n\n偶数个交点的方案有 $2$ 个，奇数个交点的方案有 $1$ 个，所以答案为 $1$。\n\n将下表中路径 $1$ 和路径 $2$ 的方案交换，将会得到相同的方案，例如路径 $1$ 为 $(2, 3, 1)$ 且路径 $2$ 为 $(1, 1, 2)$ 的方案与方案 $1$ 是相同的方案，所以不会被计入答案。\n\n| 路径方案 | 路径 $1$  | 路径 $2$  | 交点总数 |\n| :------: | :-------: | :-------: | :------: |\n|   $1$    | $(1,1,2)$ | $(2,3,1)$ |   $1$    |\n|   $2$    | $(1,2,1)$ | $(2,1,2)$ |   $2$    |\n|   $3$    | $(1,2,1)$ | $(2,3,2)$ |   $0$    |\n\n**【样例 #2】**\n\n见附件 `xpath2.in` 与 `xpath2.ans`。\n\n该样例约束与测试点 $7 \\sim 8$ 一致。\n\n**【样例 #3】**\n\n见附件 `xpath3.in` 与 `xpath3.ans`。\n\n该样例约束与测试点 $9 \\sim 10$ 一致。\n\n**【样例 #4】**\n\n见附件 `xpath4.in` 与 `xpath4.ans`。\n\n该样例约束与测试点 $14 \\sim 15$ 一致。\n\n**【数据范围】**\n\n对于所有测试数据：$2 \\leq k \\leq 100$，$2 \\leq n_1 \\leq 100$，$1 \\leq T \\leq 5$。\n\n每个测试点中，保证 $n_1 > 10$ 的数据只有 $1$ 组。\n\n|  测试点编号  | $k=$  | $n_1 \\leq$ | 特殊性质 |\n| :----------: | :---: | :--------: | :------: |\n|  $1 \\sim 4$  |  $2$  |    $10$    |    无    |\n|  $5 \\sim 6$  | $10$  |    $10$    |   A，B    |\n|  $7 \\sim 8$  | $10$  |    $10$    |    A     |\n| $9 \\sim 10$  | $10$  |    $10$    |    无    |\n| $11 \\sim 13$ |  $2$  |   $100$    |    无    |\n| $14 \\sim 15$ | $100$ |   $100$    |   A，B    |\n| $16 \\sim 17$ | $100$ |   $100$    |    A     |\n| $18 \\sim 20$ | $100$ |   $100$    |    无    |\n\n特殊性质 A：对于所有 $i$（$2 \\leq i \\leq k-1$）满足 $n_i = n_1$。\n\n特殊性质 B：保证路径方案总数至多为 $1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 路径交点", "background": "", "description": "小 L 有一个有向图，图中的顶点可以分为 $k$ 层，第 $i$ 层有 $n_i$ 个顶点，第 $1$ 层与第 $k$ 层**顶点数相同**，即 $n_1 = n_k$，且对于第 $j$（$2 \\leq j \\leq k-1$）层，$n_1 \\leq n_j \\leq 2n_1$。对于第 $j$（$1 \\leq j < k$）层的顶点，以它们为起点的边只会连向第 $j + 1$ 层的顶点。没有边连向第 $1$ 层的顶点，第 $k$ 层的顶点不会向其他顶点连边。\n\n现在小 L 要从这个图中选出 $n_1$ 条路径，每条路径以第 $1$ 层顶点为起点，第 $k$ 层顶点为终点，并要求**图中的每个顶点至多出现在一条路径中**。更具体地，把每一层顶点按照 $1,2,\\ldots,n_i$ 进行编号，则每条路径可以写为一个 $k$ 元组 $(p_1,p_2,\\ldots,p_k)$，表示这条路径依次经过第 $j$ 层的 $p_j$（$1 \\leq p_j \\leq n_j$）号顶点，并且第 $j$（$1 \\leq j < k$）层的 $p_j$ 号顶点有一条边连向第 $j+1$ 层的第 $p_{j+1}$ 号顶点。\n\n小 L 把这些路径画在了纸上，发现它们会产生若干个交点。对于两条路径 $P,Q$，分别设它们在第 $j$ 层与第 $j+1$ 层之间的连边为 $(P_j,P_{j+1})$ 与 $(Q_j,Q_{j+1})$，若，\n\n$$(P_j-Q_j)\\times(P_{j+1}-Q_{j+1})<0$$\n\n则称它们在第 $j$ 层后产生了一个交点。两条路径的交点数为它们在第 $1, 2,\\ldots,k - 1$ 层后产生的交点总数。对于整个路径方案，它的交点数为**两两不同路径间交点数之和**。例如下图是一个 $3$ 条路径，共 $3$ 个交点的例子，其中红色点是交点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pvr0iwkt.png)\n\n小 L 现在想知道有偶数个交点的路径方案数比有奇数个交点的路径方案数多多少个。两个路径方案被视为相同的，当且仅当它们的 $n_1$ 条路径按第一层起点编号顺序写下的 $k$ 元组能对应相同。由于最后的结果可能很大，请你输出它对 $998244353$（一个大质数）取模后的值。", "inputFormat": "本题有多组数据，输入数据第一行一个正整数 $T$ ，表示数据组数。对于每组数据：\n\n第一行一个正整数 $k$，表示一共有 $k$ 层顶点。\n\n第二行包含 $k$ 个整数 $n_1,n_2,\\ldots,n_k$，依次表示每一层的顶点数量。保证 $n_1=n_k$，且 $n_1 \\leq n_i \\leq 2n_1$（$2 \\leq i \\leq k-1$）。\n\n第三行包含 $k-1$ 个整数 $m_1,m_2,\\ldots,m_{k-1}$，依次表示第 $j$ 层顶点到第 $j+1$ 层顶点的边数。保证 $m_j \\leq n_j \\times n_{j+1}$。\n\n接下来有 $k-1$ 段输入。第 $j$（$1 \\leq j < k$）段输入包含 $m_j$ 行，每一行两个整数 $u,v$，表示第 $j$ 层的 $u$ 号顶点有一条边连向第 $j+1$ 层的 $v$ 号顶点。\n\n数据保证图中不会出现重边。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示该组数据的答案对 $998244353$ 取模后的值。", "hint": "**【样例解释 #1】**\n\n偶数个交点的方案有 $2$ 个，奇数个交点的方案有 $1$ 个，所以答案为 $1$。\n\n将下表中路径 $1$ 和路径 $2$ 的方案交换，将会得到相同的方案，例如路径 $1$ 为 $(2, 3, 1)$ 且路径 $2$ 为 $(1, 1, 2)$ 的方案与方案 $1$ 是相同的方案，所以不会被计入答案。\n\n| 路径方案 | 路径 $1$  | 路径 $2$  | 交点总数 |\n| :------: | :-------: | :-------: | :------: |\n|   $1$    | $(1,1,2)$ | $(2,3,1)$ |   $1$    |\n|   $2$    | $(1,2,1)$ | $(2,1,2)$ |   $2$    |\n|   $3$    | $(1,2,1)$ | $(2,3,2)$ |   $0$    |\n\n**【样例 #2】**\n\n见附件 `xpath2.in` 与 `xpath2.ans`。\n\n该样例约束与测试点 $7 \\sim 8$ 一致。\n\n**【样例 #3】**\n\n见附件 `xpath3.in` 与 `xpath3.ans`。\n\n该样例约束与测试点 $9 \\sim 10$ 一致。\n\n**【样例 #4】**\n\n见附件 `xpath4.in` 与 `xpath4.ans`。\n\n该样例约束与测试点 $14 \\sim 15$ 一致。\n\n**【数据范围】**\n\n对于所有测试数据：$2 \\leq k \\leq 100$，$2 \\leq n_1 \\leq 100$，$1 \\leq T \\leq 5$。\n\n每个测试点中，保证 $n_1 > 10$ 的数据只有 $1$ 组。\n\n|  测试点编号  | $k=$  | $n_1 \\leq$ | 特殊性质 |\n| :----------: | :---: | :--------: | :------: |\n|  $1 \\sim 4$  |  $2$  |    $10$    |    无    |\n|  $5 \\sim 6$  | $10$  |    $10$    |   A，B    |\n|  $7 \\sim 8$  | $10$  |    $10$    |    A     |\n| $9 \\sim 10$  | $10$  |    $10$    |    无    |\n| $11 \\sim 13$ |  $2$  |   $100$    |    无    |\n| $14 \\sim 15$ | $100$ |   $100$    |   A，B    |\n| $16 \\sim 17$ | $100$ |   $100$    |    A     |\n| $18 \\sim 20$ | $100$ |   $100$    |    无    |\n\n特殊性质 A：对于所有 $i$（$2 \\leq i \\leq k-1$）满足 $n_i = n_1$。\n\n特殊性质 B：保证路径方案总数至多为 $1$。", "locale": "zh-CN"}}}
{"pid": "P7737", "type": "P", "difficulty": 6, "samples": [["5 6 4 1\n1 2\n1 3\n1 4\n2 5\n4 5\n5 4\n1 4 5 1\n2 3 5 3\n1 2 5 2\n3 4 5 1\n", "4\n4\n4\n0\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "NOI", "O2优化", "广度优先搜索 BFS", "拓扑排序", "Tarjan", "最近公共祖先 LCA", "虚树"], "title": "[NOI2021] 庆典", "background": "", "description": "C 国是一个繁荣昌盛的国家，它由 $n$ 座城市和 $m$ 条有向道路组成，城市从 $1$ 到 $n$ 编号。如果从 $x$ 号城市出发，经过若干条道路后能到达 $y$ 号城市，那么我们称 $x$ 号城市可到达 $y$ 号城市，记作 $x\\Rightarrow y$。C 国的道路有一个特点：对于三座城市 $x$，$y$，$z$，若 $x\\Rightarrow z$ 且 $y\\Rightarrow z$，那么有 $x\\Rightarrow y$ 或 $y\\Rightarrow x$。\n\n再过一个月就是 C 国成立的千年纪念日，所以 C 国的人民正在筹备盛大的游行庆典。目前 C 国得知接下来会有 $q$ 次游行计划，第 $i$ 次游行希望从城市 $s_i$ 出发，经过若干个城市后，在城市 $t_i$ 结束，且在游行过程中，**一个城市可以被经过多次**。为了增加游行的乐趣，每次游行还会**临时**修建出 $k$（$0 \\le k \\le 2$）条有向道路专门供本次游行使用，即其它游行计划不能通过本次游行修建的道路。\n\n现在 C 国想知道，每次游行计划可能会**经过多少座城市**。\n\n注意：临时修建出的道路**可以不满足 C 国道路原有的特点**。", "inputFormat": "第一行包含四个整数 $n,m,q,k$，分别表示城市数、道路数、游行计划数以及每次游行临时修建的道路数。\n\n接下来 $m$ 行，每行包含两个整数 $u,v$，表示一条有向道路 $u\\rightarrow v$。\n\n接下来 $q$ 行，每行前两个整数 $s_i,t_i$，表示每次游行的起点与终点；这行接下来有 $k$ 对整数 $a,b$，每对整数表示一条临时添加的有向道路 $a\\rightarrow b$。\n\n数据保证，将 C 国原有的有向道路视为无向道路后，所有城市可以互达。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。如果一次游行从起点出发无法到达终点，输出 $0$ 即可。", "hint": "**【样例解释 #1】**\n\n第 $1$ 次计划，起点为 $1$ 号点，终点为 $4$ 号点，临时修建道路为 $5\\rightarrow1$，最终可能经过的城市编号为 $\\{1,2,4,5\\}$。\n\n第 $2$ 次计划，起点为 $2$ 号点，终点为 $3$ 号点，临时修建道路为 $5\\rightarrow3$，最终可能经过的城市编号为 $\\{2,3,4,5\\}$。\n\n第 $3$ 次计划，起点为 $1$ 号点，终点为 $2$ 号点，临时修建道路为 $5\\rightarrow2$，最终可能经过的城市编号为 $\\{1,2,4,5\\}$。\n\n第 $4$ 次计划，起点为 $3$ 号点，终点为 $4$ 号点，临时修建道路为 $5\\rightarrow1$，最终从 $3$ 号点出发无法到达 $4$ 号点。\n\n**【样例 #2】**\n\n见附件 `celebration/celebration2.in` 与 `celebration/celebration2.ans`。\n\n该样例约束与测试点 $5 \\sim 7$ 一致。\n\n**【样例 #3】**\n\n见附件 `celebration/celebration3.in` 与 `celebration/celebration3.ans`。\n\n该样例约束与测试点 $10 \\sim 11$ 一致。\n\n**【样例 #4】**\n\n见附件 `celebration/celebration4.in` 与 `celebration/celebration4.ans`。\n\n该样例约束与测试点 $15 \\sim 16$ 一致。\n\n**【样例 #5】**\n\n见附件 `celebration/celebration5.in` 与 `celebration/celebration5.ans`。\n\n该样例约束与测试点 $20 \\sim 25$ 一致。\n\n**【数据范围】**\n\n对于所有测试点，$1 \\le n,q \\le 3 \\times {10}^5$，$n - 1 \\le m \\le 6 \\times {10}^5$，$0 \\le k \\le 2$。\n\n| 测试点编号 | $n, q \\le$ | $k$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 4$ | $5$ | $= 0$ | 无 |\n| $5 \\sim 7$ | $1000$ | $\\le 2$ | 无 |\n| $8 \\sim 9$ | $3 \\times {10}^5$ | $= 0$ | $m = n - 1$ |\n| $10 \\sim 11$ | $3 \\times {10}^5$ | $= 1$ | $m = n - 1$ |\n| $12 \\sim 14$ | $3 \\times {10}^5$ | $= 2$ | $m = n - 1$ |\n| $15 \\sim 16$ | $3 \\times {10}^5$ | $= 0$ | 无 |\n| $17 \\sim 19$ | $3 \\times {10}^5$ | $= 1$ | 无 |\n| $20 \\sim 25$ | $3 \\times {10}^5$ | $= 2$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 庆典", "background": "", "description": "C 国是一个繁荣昌盛的国家，它由 $n$ 座城市和 $m$ 条有向道路组成，城市从 $1$ 到 $n$ 编号。如果从 $x$ 号城市出发，经过若干条道路后能到达 $y$ 号城市，那么我们称 $x$ 号城市可到达 $y$ 号城市，记作 $x\\Rightarrow y$。C 国的道路有一个特点：对于三座城市 $x$，$y$，$z$，若 $x\\Rightarrow z$ 且 $y\\Rightarrow z$，那么有 $x\\Rightarrow y$ 或 $y\\Rightarrow x$。\n\n再过一个月就是 C 国成立的千年纪念日，所以 C 国的人民正在筹备盛大的游行庆典。目前 C 国得知接下来会有 $q$ 次游行计划，第 $i$ 次游行希望从城市 $s_i$ 出发，经过若干个城市后，在城市 $t_i$ 结束，且在游行过程中，**一个城市可以被经过多次**。为了增加游行的乐趣，每次游行还会**临时**修建出 $k$（$0 \\le k \\le 2$）条有向道路专门供本次游行使用，即其它游行计划不能通过本次游行修建的道路。\n\n现在 C 国想知道，每次游行计划可能会**经过多少座城市**。\n\n注意：临时修建出的道路**可以不满足 C 国道路原有的特点**。", "inputFormat": "第一行包含四个整数 $n,m,q,k$，分别表示城市数、道路数、游行计划数以及每次游行临时修建的道路数。\n\n接下来 $m$ 行，每行包含两个整数 $u,v$，表示一条有向道路 $u\\rightarrow v$。\n\n接下来 $q$ 行，每行前两个整数 $s_i,t_i$，表示每次游行的起点与终点；这行接下来有 $k$ 对整数 $a,b$，每对整数表示一条临时添加的有向道路 $a\\rightarrow b$。\n\n数据保证，将 C 国原有的有向道路视为无向道路后，所有城市可以互达。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。如果一次游行从起点出发无法到达终点，输出 $0$ 即可。", "hint": "**【样例解释 #1】**\n\n第 $1$ 次计划，起点为 $1$ 号点，终点为 $4$ 号点，临时修建道路为 $5\\rightarrow1$，最终可能经过的城市编号为 $\\{1,2,4,5\\}$。\n\n第 $2$ 次计划，起点为 $2$ 号点，终点为 $3$ 号点，临时修建道路为 $5\\rightarrow3$，最终可能经过的城市编号为 $\\{2,3,4,5\\}$。\n\n第 $3$ 次计划，起点为 $1$ 号点，终点为 $2$ 号点，临时修建道路为 $5\\rightarrow2$，最终可能经过的城市编号为 $\\{1,2,4,5\\}$。\n\n第 $4$ 次计划，起点为 $3$ 号点，终点为 $4$ 号点，临时修建道路为 $5\\rightarrow1$，最终从 $3$ 号点出发无法到达 $4$ 号点。\n\n**【样例 #2】**\n\n见附件 `celebration/celebration2.in` 与 `celebration/celebration2.ans`。\n\n该样例约束与测试点 $5 \\sim 7$ 一致。\n\n**【样例 #3】**\n\n见附件 `celebration/celebration3.in` 与 `celebration/celebration3.ans`。\n\n该样例约束与测试点 $10 \\sim 11$ 一致。\n\n**【样例 #4】**\n\n见附件 `celebration/celebration4.in` 与 `celebration/celebration4.ans`。\n\n该样例约束与测试点 $15 \\sim 16$ 一致。\n\n**【样例 #5】**\n\n见附件 `celebration/celebration5.in` 与 `celebration/celebration5.ans`。\n\n该样例约束与测试点 $20 \\sim 25$ 一致。\n\n**【数据范围】**\n\n对于所有测试点，$1 \\le n,q \\le 3 \\times {10}^5$，$n - 1 \\le m \\le 6 \\times {10}^5$，$0 \\le k \\le 2$。\n\n| 测试点编号 | $n, q \\le$ | $k$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 4$ | $5$ | $= 0$ | 无 |\n| $5 \\sim 7$ | $1000$ | $\\le 2$ | 无 |\n| $8 \\sim 9$ | $3 \\times {10}^5$ | $= 0$ | $m = n - 1$ |\n| $10 \\sim 11$ | $3 \\times {10}^5$ | $= 1$ | $m = n - 1$ |\n| $12 \\sim 14$ | $3 \\times {10}^5$ | $= 2$ | $m = n - 1$ |\n| $15 \\sim 16$ | $3 \\times {10}^5$ | $= 0$ | 无 |\n| $17 \\sim 19$ | $3 \\times {10}^5$ | $= 1$ | 无 |\n| $20 \\sim 25$ | $3 \\times {10}^5$ | $= 2$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7738", "type": "P", "difficulty": 6, "samples": [["见附件中的 qi/qi1.in", "见附件中的 qi/qi1.ans"], ["见附件中的 qi/qi2.in", "见附件中的 qi/qi2.ans"], ["见附件中的 qi/qi3.in", "见附件中的 qi/qi3.ans"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216]}, "tags": ["2021", "NOI", "O2优化", "鸽笼原理", "位运算", "bitset"], "title": "[NOI2021] 量子通信", "background": "由于评测性能差异，本题时限 +0.5s。", "description": "小 Z 正在自学量子计算机相关知识，最近他在研究量子通信章节，并遇到了一个有趣的问题。在该问题中，Alice 和 Bob 正在进行量子通信，它们的通信语言是一个大小为 $n$ 的字典 $S$，在该字典中，每一个单词 $s_i$（$1 \\le i \\le n$）都可以用一个 $\\boldsymbol{256}$ **位的** $\\boldsymbol{01}$ **串**来表示。在本题中 $s_i$ 可以通过调用函数 `gen` 来生成，选手可以在题目目录下的 `gen.cpp` 中查看，该函数的参数 `n`、`a1`、`a2` 将由输入数据给出。\n\nAlice 和 Bob 接下来要进行 $m$ 次通信，每次通信由 Alice 向 Bob 传输**恰好一个**字典中的单词。然而，两人使用的通信信道并不可靠，会受到噪音的干扰。更具体地，对于第 $i$ 次传输，记 Alice 传输的原单词为 $x_i$，该 $01$ 串会受噪音干扰而**翻转最多** $\\boldsymbol{k_i}$ **位**。换句话说，记 Bob 这次收到的 $01$ 串为 $y_i$，它与 $x_i$ 相比，可能有最多 $k_i$ 位是不同的，并且 $y_i$ 可能不在字典 $S$ 中出现。\n\n与此同时，Bob 得知坏人 Eve 也潜入了两人的通信信道，并准备干扰两人的通信。他的干扰方式是将 Bob 收到的 $01$ 串变为任意的 $256$ 位 $01$ 串，并且这个串可能不在字典 $S$ 中出现。Eve 非常狡猾，他**不一定**会对每次通信都进行干扰。\n\n现在 Bob 找来了你帮忙，对于接下来的每次通信，你需要根据 Bob 最终收到的 $01$ 串以及这次通信的噪音干扰阈值 $k_i$（$0 \\le k_i \\le 15$），判断这次通信是否有可能没有受到 Eve 的干扰（即 Bob 收到的 $01$ 串可以由字典中的某个单词翻转至多 $k_i$ 位后得到）。本次通信如果有可能没受到 Eve 干扰，请你输出 $1$，否则输出 $0$。Bob 很信任你的能力，所以你需要**在线地回答结果，具体要求见输入格式**。\n\n为了降低读入用时， Bob 收到的串将用**长度为** $\\boldsymbol{64}$ **的** $\\boldsymbol{16}$ **进制串**给出，$16$ 进制串中包含数字字符 $\\texttt{0} \\sim \\texttt{9}$ 与大写英文字母 $\\texttt{A} \\sim \\texttt{F}$，其中字符 $\\texttt{A} \\sim \\texttt{F}$ 依次表示数值 $10 \\sim 15$。\n\n$16$ 进制串可以逐位转化为 $01$ 串，例如：`5` 对应 `0101`，`A` 对应 `1010`，`C` 对应 `1100`。", "inputFormat": "输入数据第一行包含四个非负整数 $n, m, a_1, a_2$，分别表示字典大小，通信次数，以及 `gen` 函数中参数 `a1` 和 `a2` 的初始值。\n\n选手需要在自己的程序中调用题目描述中提到的 `gen` 函数生成单词表，选手可以复制并使用 `gen.cpp` 中的代码，程序中的布尔数组 `s[N+1][256]` 即为所有的单词。\n\n接下来 $m$ 行，每行包含一个长度为 $64$ 的 $16$ 进制串和一个非负整数 $k_i$，分别表示第 $i$ 次通信 Bob 最终收到的 $01$ 串和噪音干扰阈值。\n\n为了强制选手**在线地回答询问**，选手根据 $16$ 进制串还原出 $256$ 位 $01$ 串后，将 $01$ 串每一位异或上 ${\\mathit{lastans}}$ 才能得到这次通信中 Bob 收到的真实 $01$ 串，其中 ${\\mathit{lastans}} \\in \\{ 0, 1 \\}$ 表示上一次询问的答案，第一个询问前 ${\\mathit{lastans}}$ 初始值为 0。\n\n注意：使用 `scanf` 和 `printf` 函数读入或输出 `unsigned long long` 类型变量时，对应的占位符为 `llu`。", "outputFormat": "输出共 $m$ 行，每行一个整数 $0$ 或 $1$ 表示当前询问的答案。", "hint": "**【询问举例】**\n\n为了方便解释题意，我们使用了直接给出字典中单词、缩小单词长度为 $4$、允许离线地回答询问等方式，对简化的情况举例。\n\n考虑字典大小为 $n = 2$，单词有 `1010` 和 `0111`。\n\n对于询问 `B = 1011` 和 $k_1 = 1$，回答应该是 $1$，通过翻转 `1010` 的第 $4$ 位（从高位到低位，下同）得到。\n\n对于询问 `1 = 0001` 和 $k_2 = 2$，回答应该是 $1$，通过翻转 `0111` 的第 $2$、$3$ 位得到。\n\n对于询问 `1 = 0001` 和 $k_3 = 1$，回答应该是 $0$。\n\n- 翻转 `1010` 至多 $1$ 位可得 `1010`、`0010`、`1110`、`1000`、`1011`。\n- 翻转 `0111` 至多 $1$ 位可得 `0111`、`1111`、`0011`、`0101`、`0110`。\n- 无法得到 `1 = 0001`，它必定是由 Eve 干扰得到的。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le 4 \\times {10}^5$，$1 \\le m \\le 1.2 \\times {10}^5$，$0 \\le k_i \\le 15$，$a_1$ 和 $a_2$ 在 $[0, 2^{64} - 1]$ 之间均匀随机生成。\n\n| 测试点编号 | $n =$ | $m =$ | $k_i \\le$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10$ | $2$ | 无 |\n| $2$ | $500$ | $500$ | $15$ | 无 |\n| $3$ | $1000$ | $1000$ | $0$ | 无 |\n| $4$ | $2000$ | $2000$ | $2$ | 无 |\n| $5$ | $5000$ | $5000$ | $15$ | 无 |\n| $6$ | $10^4$ | $10^4$ | $15$ | 无 |\n| $7$ | $2\\times 10^4$ | $2\\times 10^4$ | $15$ | 无 |\n| $8$ | $10^5$ | $10^5$ | $1$ | 无 |\n| $9$ | $4\\times 10^5$ | $1.2\\times 10^5$ | $1$ | 无 |\n| $10$ | $5\\times 10^4$ | $5\\times 10^4$ | $2$ | 无 |\n| $11$ | $7\\times 10^4$ | $7\\times 10^4$ | $3$ | 无 |\n| $12$ | $10^5$ | $10^5$ | $2$ | 无 |\n| $13$ | $3\\times 10^4$ | $3\\times 10^4$ | $5$ | 无 |\n| $14$ | $6\\times 10^4$ | $6\\times 10^4$ | $4$ | 无 |\n| $15$ | $1.2\\times 10^5$ | $1.2\\times 10^5$ | $5$ | 无 |\n| $16$ | $6\\times 10^4$ | $6\\times 10^4$ | $8$ | 所有询问串随机生成 |\n| $17$ | $1.2\\times 10^5$ | $1.2\\times 10^5$ | $12$ | 所有询问串随机生成 |\n| $18$ | $4\\times 10^5$ | $10^5$ | $15$ | 所有询问串随机生成 |\n| $19$ | $3\\times 10^4$ | $3\\times 10^4$ | $7$ | 无 |\n| $20$ | $6\\times 10^4$ | $6\\times 10^4$ | $9$ | 无 |\n| $21$ | $9\\times 10^4$ | $9\\times 10^4$ | $11$ | 无 |\n| $22$ | $2\\times 10^5$ | $1.2\\times 10^5$ | $12$ | 无 |\n| $23$ | $4\\times 10^5$ | $8\\times 10^4$ | $15$ | 无 |\n| $24$ | $4\\times 10^5$ | $10^5$ | $15$ | 无 |\n| $25$ | $4\\times 10^5$ | $1.2\\times 10^5$ | $15$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 量子通信", "background": "由于评测性能差异，本题时限 +0.5s。", "description": "小 Z 正在自学量子计算机相关知识，最近他在研究量子通信章节，并遇到了一个有趣的问题。在该问题中，Alice 和 Bob 正在进行量子通信，它们的通信语言是一个大小为 $n$ 的字典 $S$，在该字典中，每一个单词 $s_i$（$1 \\le i \\le n$）都可以用一个 $\\boldsymbol{256}$ **位的** $\\boldsymbol{01}$ **串**来表示。在本题中 $s_i$ 可以通过调用函数 `gen` 来生成，选手可以在题目目录下的 `gen.cpp` 中查看，该函数的参数 `n`、`a1`、`a2` 将由输入数据给出。\n\nAlice 和 Bob 接下来要进行 $m$ 次通信，每次通信由 Alice 向 Bob 传输**恰好一个**字典中的单词。然而，两人使用的通信信道并不可靠，会受到噪音的干扰。更具体地，对于第 $i$ 次传输，记 Alice 传输的原单词为 $x_i$，该 $01$ 串会受噪音干扰而**翻转最多** $\\boldsymbol{k_i}$ **位**。换句话说，记 Bob 这次收到的 $01$ 串为 $y_i$，它与 $x_i$ 相比，可能有最多 $k_i$ 位是不同的，并且 $y_i$ 可能不在字典 $S$ 中出现。\n\n与此同时，Bob 得知坏人 Eve 也潜入了两人的通信信道，并准备干扰两人的通信。他的干扰方式是将 Bob 收到的 $01$ 串变为任意的 $256$ 位 $01$ 串，并且这个串可能不在字典 $S$ 中出现。Eve 非常狡猾，他**不一定**会对每次通信都进行干扰。\n\n现在 Bob 找来了你帮忙，对于接下来的每次通信，你需要根据 Bob 最终收到的 $01$ 串以及这次通信的噪音干扰阈值 $k_i$（$0 \\le k_i \\le 15$），判断这次通信是否有可能没有受到 Eve 的干扰（即 Bob 收到的 $01$ 串可以由字典中的某个单词翻转至多 $k_i$ 位后得到）。本次通信如果有可能没受到 Eve 干扰，请你输出 $1$，否则输出 $0$。Bob 很信任你的能力，所以你需要**在线地回答结果，具体要求见输入格式**。\n\n为了降低读入用时， Bob 收到的串将用**长度为** $\\boldsymbol{64}$ **的** $\\boldsymbol{16}$ **进制串**给出，$16$ 进制串中包含数字字符 $\\texttt{0} \\sim \\texttt{9}$ 与大写英文字母 $\\texttt{A} \\sim \\texttt{F}$，其中字符 $\\texttt{A} \\sim \\texttt{F}$ 依次表示数值 $10 \\sim 15$。\n\n$16$ 进制串可以逐位转化为 $01$ 串，例如：`5` 对应 `0101`，`A` 对应 `1010`，`C` 对应 `1100`。", "inputFormat": "输入数据第一行包含四个非负整数 $n, m, a_1, a_2$，分别表示字典大小，通信次数，以及 `gen` 函数中参数 `a1` 和 `a2` 的初始值。\n\n选手需要在自己的程序中调用题目描述中提到的 `gen` 函数生成单词表，选手可以复制并使用 `gen.cpp` 中的代码，程序中的布尔数组 `s[N+1][256]` 即为所有的单词。\n\n接下来 $m$ 行，每行包含一个长度为 $64$ 的 $16$ 进制串和一个非负整数 $k_i$，分别表示第 $i$ 次通信 Bob 最终收到的 $01$ 串和噪音干扰阈值。\n\n为了强制选手**在线地回答询问**，选手根据 $16$ 进制串还原出 $256$ 位 $01$ 串后，将 $01$ 串每一位异或上 ${\\mathit{lastans}}$ 才能得到这次通信中 Bob 收到的真实 $01$ 串，其中 ${\\mathit{lastans}} \\in \\{ 0, 1 \\}$ 表示上一次询问的答案，第一个询问前 ${\\mathit{lastans}}$ 初始值为 0。\n\n注意：使用 `scanf` 和 `printf` 函数读入或输出 `unsigned long long` 类型变量时，对应的占位符为 `llu`。", "outputFormat": "输出共 $m$ 行，每行一个整数 $0$ 或 $1$ 表示当前询问的答案。", "hint": "**【询问举例】**\n\n为了方便解释题意，我们使用了直接给出字典中单词、缩小单词长度为 $4$、允许离线地回答询问等方式，对简化的情况举例。\n\n考虑字典大小为 $n = 2$，单词有 `1010` 和 `0111`。\n\n对于询问 `B = 1011` 和 $k_1 = 1$，回答应该是 $1$，通过翻转 `1010` 的第 $4$ 位（从高位到低位，下同）得到。\n\n对于询问 `1 = 0001` 和 $k_2 = 2$，回答应该是 $1$，通过翻转 `0111` 的第 $2$、$3$ 位得到。\n\n对于询问 `1 = 0001` 和 $k_3 = 1$，回答应该是 $0$。\n\n- 翻转 `1010` 至多 $1$ 位可得 `1010`、`0010`、`1110`、`1000`、`1011`。\n- 翻转 `0111` 至多 $1$ 位可得 `0111`、`1111`、`0011`、`0101`、`0110`。\n- 无法得到 `1 = 0001`，它必定是由 Eve 干扰得到的。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le 4 \\times {10}^5$，$1 \\le m \\le 1.2 \\times {10}^5$，$0 \\le k_i \\le 15$，$a_1$ 和 $a_2$ 在 $[0, 2^{64} - 1]$ 之间均匀随机生成。\n\n| 测试点编号 | $n =$ | $m =$ | $k_i \\le$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10$ | $2$ | 无 |\n| $2$ | $500$ | $500$ | $15$ | 无 |\n| $3$ | $1000$ | $1000$ | $0$ | 无 |\n| $4$ | $2000$ | $2000$ | $2$ | 无 |\n| $5$ | $5000$ | $5000$ | $15$ | 无 |\n| $6$ | $10^4$ | $10^4$ | $15$ | 无 |\n| $7$ | $2\\times 10^4$ | $2\\times 10^4$ | $15$ | 无 |\n| $8$ | $10^5$ | $10^5$ | $1$ | 无 |\n| $9$ | $4\\times 10^5$ | $1.2\\times 10^5$ | $1$ | 无 |\n| $10$ | $5\\times 10^4$ | $5\\times 10^4$ | $2$ | 无 |\n| $11$ | $7\\times 10^4$ | $7\\times 10^4$ | $3$ | 无 |\n| $12$ | $10^5$ | $10^5$ | $2$ | 无 |\n| $13$ | $3\\times 10^4$ | $3\\times 10^4$ | $5$ | 无 |\n| $14$ | $6\\times 10^4$ | $6\\times 10^4$ | $4$ | 无 |\n| $15$ | $1.2\\times 10^5$ | $1.2\\times 10^5$ | $5$ | 无 |\n| $16$ | $6\\times 10^4$ | $6\\times 10^4$ | $8$ | 所有询问串随机生成 |\n| $17$ | $1.2\\times 10^5$ | $1.2\\times 10^5$ | $12$ | 所有询问串随机生成 |\n| $18$ | $4\\times 10^5$ | $10^5$ | $15$ | 所有询问串随机生成 |\n| $19$ | $3\\times 10^4$ | $3\\times 10^4$ | $7$ | 无 |\n| $20$ | $6\\times 10^4$ | $6\\times 10^4$ | $9$ | 无 |\n| $21$ | $9\\times 10^4$ | $9\\times 10^4$ | $11$ | 无 |\n| $22$ | $2\\times 10^5$ | $1.2\\times 10^5$ | $12$ | 无 |\n| $23$ | $4\\times 10^5$ | $8\\times 10^4$ | $15$ | 无 |\n| $24$ | $4\\times 10^5$ | $10^5$ | $15$ | 无 |\n| $25$ | $4\\times 10^5$ | $1.2\\times 10^5$ | $15$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7739", "type": "P", "difficulty": 7, "samples": [["2 3\nWE\nAPPEND E\nFLIP 1 2\nREVERSE 2 3\n", "2 3\n3 4\n5 3\n5 2\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["平衡树", "2021", "NOI", "O2优化", "矩阵乘法"], "title": "[NOI2021] 密码箱", "background": "", "description": "Yelekastee 是 U 国著名的考古学家。在最近的一次考古行动中，他发掘出了一个远古时期的密码箱。经过周密而严谨的考证，Yelekastee 得知密码箱的密码和某一个数列 $\\{ a_n \\}$ 相关。数列 $\\{ a_n \\}$ 可以用如下方式构造出来：\n\n1. 初始时数列长度为 $2$ 且有 $a_0 = 0, a_1 = 1$；\n2. 对数列依次进行若干次操作，其中每次操作是以下两种类型之一：\n  - `W` 类型：给数列的**最后一项**加 $1$。\n  - `E` 类型：若数列的**最后一项**为 $1$，则给倒数第二项加 $1$；否则先给数列的**最后一项**减 $1$，接着在数列尾再加两项，两项的值都是 $1$。\n\n受到技术限制，密码箱并没有办法完整检查整个数列，因此密码箱的密码设定为数列 $\\{ a_n \\}$ 经过函数 $f$ 作用后的值，其中 $f$ 的定义如下：\n\n$$ f(a_0, \\ldots , a_{k - 1}, a_k) = \\begin{cases} a_0, & k = 0 \\\\ f \\! \\left( a_0, a_1, \\ldots , a_{k - 2}, a_{k - 1} + \\frac{1}{a_k} \\right) \\! , & k \\ge 1 \\end{cases} $$\n\nYelekastee 并不擅长运算，因此他找到了你，希望你能根据他提供的操作序列计算出密码箱的密码。不幸的是，他的记性并不是很好，因此他会随时对提供的操作序列做出一些修改，这些修改包括以下三种：\n\n- `APPEND c`，在现有操作序列后追加一次 `c` 类型操作，其中 `c` 为字符 `W` 或 `E`。\n- `FLIP l r`，反转现有操作序列中第 $l$ 个至第 $r$ 个（下标从 $1$ 开始，修改包含端点 $l$ 和 $r$，下同）操作，即所有 `W` 变为 `E`，所有 `E` 变为 `W`。\n- `REVERSE l r`，翻转现有操作序列中第 $l$ 个至第 $r$ 个操作，也就是将这个区间中的操作逆序。", "inputFormat": "输入第一行包含两个正整数 $n, q$，分别表示初始的操作序列长度和修改的次数。\n\n第二行包含一个长为 $n$ 且仅包含大写字母 `W` 和 `E` 的字符串，表示初始操作序列。\n\n接下来 $q$ 行，每行表示一次修改。每种修改的格式如【题目描述】所述。", "outputFormat": "输出共 $q + 1$ 行，每行两个整数，其中第一行表示初始操作序列对应的密码，接下来 $q$ 行则分别输出每次修改之后的操作序列对应的密码。\n\n容易发现密码一定是正有理数。若真实的密码为 $\\frac{a}{b}$，其中 $a, b > 0$ 且 $\\gcd(a, b) = 1$，则你需要在对应的行内顺次输出 $a$ 和 $b$ 模 $998244353$ 后的余数。", "hint": "**【样例解释 #1】**\n\n| | 操作序列 | 数列 $\\{ a_n \\}$ | 密码 |\n|:-:|:-:|:-:|:-:|\n| 初始 | `WE` | $(0, 1, 1, 1)$ | $\\frac{2}{3}$ |\n| 第一次修改后 | `WEE` | $(0, 1, 2, 1)$ | $\\frac{3}{4}$ |\n| 第二次修改后 | `EWE` | $(1, 1, 1, 1)$ | $\\frac{5}{3}$ |\n| 第三次修改后 | `EEW` | $(2, 2)$ | $\\frac{5}{2}$ |\n\n**【样例 #2】**\n\n见附件 `code/code2.in` 与 `code/code2.ans`。\n\n该样例与测试数据 $1 \\sim 4$ 满足同样的约束条件。\n\n**【样例 #3】**\n\n见附件 `code/code3.in` 与 `code/code3.ans`。\n\n该样例与测试数据 $5 \\sim 7$ 满足同样的约束条件。\n\n**【样例 #4】**\n\n见附件 `code/code4.in` 与 `code/code4.ans`。\n\n该样例与测试数据 $8 \\sim 10$ 满足同样的约束条件。\n\n**【样例 #5】**\n\n见附件 `code/code5.in` 与 `code/code5.ans`。\n\n该样例与测试数据 $15 \\sim 20$ 满足同样的约束条件。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le {10}^5$，$1 \\le q \\le {10}^5$。\n\n对于 `APPEND` 修改，保证给出的 `c` 为大写英文字母 `W` 或 `E`。\n\n对于 `FLIP` 和 `REVERSE` 修改，保证 $1 \\le l \\le r \\le L$，其中 $L$ 是当前操作序列的长度。\n\n请注意由于有 `APPEND` 操作，操作序列的长度最大可能有 $2 \\times {10}^5$。\n\n| 测试点编号 | $n, q \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 4$ | $2000$ | 无 |\n| $5 \\sim 7$ | ${10}^5$ | A |\n| $8 \\sim 10$ | ${10}^5$ | B，C |\n| $11 \\sim 14$ | ${10}^5$ | C |\n| $15 \\sim 20$ | ${10}^5$ | 无 |\n\n特殊限制 A：保证在任意时刻操作序列中不会出现连续相同的两个字符。\n\n特殊限制 B：保证没有 `FLIP` 修改。\n\n特殊限制 C：保证没有 `REVERSE` 修改。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 密码箱", "background": "", "description": "Yelekastee 是 U 国著名的考古学家。在最近的一次考古行动中，他发掘出了一个远古时期的密码箱。经过周密而严谨的考证，Yelekastee 得知密码箱的密码和某一个数列 $\\{ a_n \\}$ 相关。数列 $\\{ a_n \\}$ 可以用如下方式构造出来：\n\n1. 初始时数列长度为 $2$ 且有 $a_0 = 0, a_1 = 1$；\n2. 对数列依次进行若干次操作，其中每次操作是以下两种类型之一：\n  - `W` 类型：给数列的**最后一项**加 $1$。\n  - `E` 类型：若数列的**最后一项**为 $1$，则给倒数第二项加 $1$；否则先给数列的**最后一项**减 $1$，接着在数列尾再加两项，两项的值都是 $1$。\n\n受到技术限制，密码箱并没有办法完整检查整个数列，因此密码箱的密码设定为数列 $\\{ a_n \\}$ 经过函数 $f$ 作用后的值，其中 $f$ 的定义如下：\n\n$$ f(a_0, \\ldots , a_{k - 1}, a_k) = \\begin{cases} a_0, & k = 0 \\\\ f \\! \\left( a_0, a_1, \\ldots , a_{k - 2}, a_{k - 1} + \\frac{1}{a_k} \\right) \\! , & k \\ge 1 \\end{cases} $$\n\nYelekastee 并不擅长运算，因此他找到了你，希望你能根据他提供的操作序列计算出密码箱的密码。不幸的是，他的记性并不是很好，因此他会随时对提供的操作序列做出一些修改，这些修改包括以下三种：\n\n- `APPEND c`，在现有操作序列后追加一次 `c` 类型操作，其中 `c` 为字符 `W` 或 `E`。\n- `FLIP l r`，反转现有操作序列中第 $l$ 个至第 $r$ 个（下标从 $1$ 开始，修改包含端点 $l$ 和 $r$，下同）操作，即所有 `W` 变为 `E`，所有 `E` 变为 `W`。\n- `REVERSE l r`，翻转现有操作序列中第 $l$ 个至第 $r$ 个操作，也就是将这个区间中的操作逆序。", "inputFormat": "输入第一行包含两个正整数 $n, q$，分别表示初始的操作序列长度和修改的次数。\n\n第二行包含一个长为 $n$ 且仅包含大写字母 `W` 和 `E` 的字符串，表示初始操作序列。\n\n接下来 $q$ 行，每行表示一次修改。每种修改的格式如【题目描述】所述。", "outputFormat": "输出共 $q + 1$ 行，每行两个整数，其中第一行表示初始操作序列对应的密码，接下来 $q$ 行则分别输出每次修改之后的操作序列对应的密码。\n\n容易发现密码一定是正有理数。若真实的密码为 $\\frac{a}{b}$，其中 $a, b > 0$ 且 $\\gcd(a, b) = 1$，则你需要在对应的行内顺次输出 $a$ 和 $b$ 模 $998244353$ 后的余数。", "hint": "**【样例解释 #1】**\n\n| | 操作序列 | 数列 $\\{ a_n \\}$ | 密码 |\n|:-:|:-:|:-:|:-:|\n| 初始 | `WE` | $(0, 1, 1, 1)$ | $\\frac{2}{3}$ |\n| 第一次修改后 | `WEE` | $(0, 1, 2, 1)$ | $\\frac{3}{4}$ |\n| 第二次修改后 | `EWE` | $(1, 1, 1, 1)$ | $\\frac{5}{3}$ |\n| 第三次修改后 | `EEW` | $(2, 2)$ | $\\frac{5}{2}$ |\n\n**【样例 #2】**\n\n见附件 `code/code2.in` 与 `code/code2.ans`。\n\n该样例与测试数据 $1 \\sim 4$ 满足同样的约束条件。\n\n**【样例 #3】**\n\n见附件 `code/code3.in` 与 `code/code3.ans`。\n\n该样例与测试数据 $5 \\sim 7$ 满足同样的约束条件。\n\n**【样例 #4】**\n\n见附件 `code/code4.in` 与 `code/code4.ans`。\n\n该样例与测试数据 $8 \\sim 10$ 满足同样的约束条件。\n\n**【样例 #5】**\n\n见附件 `code/code5.in` 与 `code/code5.ans`。\n\n该样例与测试数据 $15 \\sim 20$ 满足同样的约束条件。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le {10}^5$，$1 \\le q \\le {10}^5$。\n\n对于 `APPEND` 修改，保证给出的 `c` 为大写英文字母 `W` 或 `E`。\n\n对于 `FLIP` 和 `REVERSE` 修改，保证 $1 \\le l \\le r \\le L$，其中 $L$ 是当前操作序列的长度。\n\n请注意由于有 `APPEND` 操作，操作序列的长度最大可能有 $2 \\times {10}^5$。\n\n| 测试点编号 | $n, q \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 4$ | $2000$ | 无 |\n| $5 \\sim 7$ | ${10}^5$ | A |\n| $8 \\sim 10$ | ${10}^5$ | B，C |\n| $11 \\sim 14$ | ${10}^5$ | C |\n| $15 \\sim 20$ | ${10}^5$ | 无 |\n\n特殊限制 A：保证在任意时刻操作序列中不会出现连续相同的两个字符。\n\n特殊限制 B：保证没有 `FLIP` 修改。\n\n特殊限制 C：保证没有 `REVERSE` 修改。", "locale": "zh-CN"}}}
{"pid": "P7740", "type": "P", "difficulty": 7, "samples": [["2 1\n1R*\n", "9\n"], ["3 2\n1R0\n*\n", "1468\n"], ["见附件中的 robot/robot3.in", "见附件中的 robot/robot3.ans"], ["见附件中的 robot/robot4.in", "见附件中的 robot/robot4.ans"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "NOI", "O2优化"], "title": "[NOI2021] 机器人游戏", "background": "", "description": "小 R 有 $m$（$1 \\le m \\le 1000$）个机器人和 $m$ 张纸带，第 $i$（$1 \\le i \\le m$）个机器人负责对第 $i$ 张纸带进行操作。对于每张纸带，它们都被从左到右分成了 $n$（$1 \\le n \\le 32$）个格子，依次编号为 $0, 1, \\ldots , n - 1$。每个格子有 $3$ 种状态：1. 格子上写有数字 $0$；2. 格子上写有数字 $1$；3. 格子是一个空格子。\n\n在任意时刻，机器人**必须**站在纸带上的一个格子中。在设定好机器人在纸带上的初始位置后，第 $i$ 个机器人会依次执行预先设定的操作序列 $S_i$，操作由 `R`、`0`、`1`、`*` 四种字符组成，其中：\n\n1. `R` 表示机器人向右走一格，如果右边没有格子，则机器人会原地爆炸；\n2. `0` 表示如果机器人所在格子非空，则将该格子上的数字改为 $0$，否则不修改；\n3. `1` 表示如果机器人所在格子非空，则将该格子上的数字改为 $1$，否则不修改；\n4. `*` 表示如果机器人所在格子非空，则将格子上的数字 $x$ 改为 $1 - x$，否则不修改。\n\n第 $i$ 张纸带的状态可以用一个长度为 $n$ 的序列表示，每个元素为 `0`、`1` 或 `-`（空格子），依次表示其每个格子的状态。第 $i$ 张纸带的初始状态称为机器人 $i$ 的输入 $X_i$，操作执行完成后纸带的状态称为机器人 $i$ 的输出 $Y_i$。注意，如果机器人爆炸了，那么这个机器人就没有输出。\n\n可以发现，如果一个格子为空，那么机器人永远不会修改它。所以每个机器人都有如下特性：如果第 $i$ 个机器人所在的纸带上的**所有格子**都为空，那么它就不会执行任何操作，它的输出即为所有格子都为空。\n\n现在小 R 给定了每一个机器人的输入 $X_i$（即每张纸带的初始状态）以及目标输出 $Y_i$。小 R 希望小 D 找到一个位置 $p$（$0 \\le p < n$），使得**所有机器人**都能以其所在纸带的第 $p$ 个格子为初始位置，在不爆炸的情况下执行完所有操作，并且满足第 $i$ 个机器人的输出为 $Y_i$。\n\n小 D 花了几毫秒解决了问题，现在他想知道，有多少个输入和输出的组合方式使得上述问题有解，即有多少种为每个机器人设定输入 $X_0, X_1, \\ldots , X_{m - 1}$ 和目标输出 $Y_0, Y_1, \\ldots , Y_{m - 1}$ 的方式，使得至少存在一个位置 $p$（$0 \\le p < n$），使得所有机器人都能以其所在纸带的第 $p$ 个格子为起点，在不爆炸的情况下执行完所有操作，且满足第 $i$ 个机器人的输出为 $Y_i$。请你帮助小 D 解决这个问题，由于最终的答案可能很大，请你输出答案对 ${10}^9 + 7$ 取模后的余数。\n\n两个组合方式不同当且仅当，存在至少一个机器人，它的输入或是目标输出在两个方式中不同。", "inputFormat": "第一行包含两个正整数 $n, m$，分别表示每张纸带上的格子数和纸带数量。\n\n接下来 $m$ 行，第 $i$ 行输入一个仅包含 `R` `0` `1` `*` 这四种字符的字符串 $S_i$，表示第 $i$ 个机器人的操作序列。", "outputFormat": "仅一行一个正整数，表示答案模 ${10}^9 + 7$ 后的余数。", "hint": "**【样例解释 #1】**\n\n| 方案编号 | 输入 $X_0$ | 目标输出 $Y_0$ | 可行初始位置 $p$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | `--` | `--` | $0, 1$ |\n| $2$ | `0-` | `1-` | $0$ |\n| $3$ | `1-` | `1-` | $0$ |\n| $4$ | `-0` | `-1` | $0$ |\n| $5$ | `-1` | `-0` | $0$ |\n| $6$ | `00` | `11` | $0$ |\n| $7$ | `10` | `11` | $0$ |\n| $8$ | `01` | `10` | $0$ |\n| $9$ | `11` | `10` | $0$ |\n\n表中 `-` 表示空格子，注意方案 $1$ 中的输入和输出中有两个空格子。\n\n当输入全为空时，初始位置可以是 $0$ 或 $1$，因为根据题意，输入全为空时机器人不会执行任何操作。\n\n当输入不全为空时，初始位置只能为 $0$，如果初始位置为 $1$ 机器人一定会爆炸。所以此时实际执行的操作是将第一格的数字改为 $1$，并将第二格的数字 $x$ 改为 $1 - x$。\n\n**【样例解释 #2】**\n\n可以用容斥原理来计算这个样例。\n\n1. 初始位置 $p = 0$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带 $0$ 号格子要么输入输出都是空，要么目标输出是 $1$（输入无所谓），所以有 $3$ 种方案；$1$ 号格子要么输入输出都是空，要么目标输出是 $0$，也是 $3$ 种方案；$2$ 号格子要么输入输出都是空，要么输入和目标输出相同（因为没有对该格子执行任何操作），同样是 $3$ 种方案，共 $27$ 种方案。第二个机器人的 $0$ 号格子要么输入输出都是空，要么输入和目标输出不同，是 $3$ 种方案，$1$ 号和 $2$ 号格子也都是 $3$ 种方案，共 $27$ 种方案。所以总共 $27 \\times 27 = 729$ 种方案。\n2. 初始位置 $p = 1$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带三个格子都是 $3$ 种方案，其中 $0$ 号格子要么输入输出都为空，要么相同；$1$ 号格子要么输入输出都为空，要么目标输出是 $1$；$2$ 号格子的输入输出要么都为空，要么输出是 $0$，共 $27$ 种方案。第二个机器人的 $1$ 号格子要么输入输出都是空，要么输入和目标输出不同，是 $3$ 种方案；$0$ 号和 $2$ 号格子要么输入输出都为空，要么输入输出相同，也都是 $3$ 种方案，共 $27$ 种方案。总共 $27 \\times 27 = 729$ 种方案。\n3. 初始位置 $p = 2$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带必须输入输出全为空（否则爆炸），只有 $1$ 种方案。第二个机器人是 $27$ 种方案，总共 $27$ 种方案。\n4. 初始位置 $p = 0, 1$ 都满足条件。这要求第一个机器人的 $1$ 号格子输入输出都为空；$0$ 号格子的输入输出都为空或都为 $1$；$2$ 号格子的输入输出都为空或都为 $0$，所以第一个机器人的纸带有 $4$ 种方案。第二个机器人 $0$ 号格子和 $1$ 号格子都为空，$2$ 号格子有 $3$ 种方案，第二个机器人的 $0$ 号和 $1$ 号格子必须都为空，$2$ 号格子要么输入输出都为空，要么输入和输出相同，有 $3$ 种方案。总共 $12$ 种方案。\n5. 初始位置 $p = 0, 2$ 都满足条件。那么第一个机器人的纸带必须输入输出全为空（否则爆炸），只有 $1$ 种方案。第二个机器人 $0$ 号和 $2$ 号格子都为空，$1$ 号格子有 $3$ 种方案。总共 $3$ 种方案。\n6. 初始位置 $p = 1, 2$ 都满足条件。那么第一个机器人的纸带必须输入输出全为空，只有 $1$ 种方案。第二个机器人 $1$ 号和 $2$ 号格子都为空，$0$ 号格子有 $3$ 种方案。总共 $3$ 种方案。\n7. 初始位置 $p = 0, 1, 2$ 都满足条件。那么两个机器人的输入输出必须都为空，总共 $1$ 种方案。\n\n根据容斥原理，最后的答案为 $729 + 729 + 27 - 12 - 3 - 3 + 1 = 1468$。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le 32$，$1 \\le m \\le 1000$，$1 \\le \\lvert S_i \\rvert \\le 100$。\n\n| 测试点编号 | $n \\le$ | $m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 2$ | $1$ | $1$ | 无 |\n| $3$ | $8$ | $1$ | 无 |\n| $4$ | $16$ | $1$ | 无 |\n| $5 \\sim 6$ | $32$ | $1$ | 无 |\n| $7$ | $16$ | $5$ | 无 |\n| $8 \\sim 10$ | $32$ | $5$ | 无 |\n| $11 \\sim 12$ | $16$ | $1000$ | 无 |\n| $13 \\sim 15$ | $32$ | $1000$ | A |\n| $16 \\sim 21$ | $32$ | $1000$ | B |\n| $22 \\sim 25$ | $32$ | $1000$ | 无 |\n\n特殊限制 A：操作序列中不存在 `R`。\n\n特殊限制 B：每个操作序列中，`R` 的数量至多 $15$ 个。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 机器人游戏", "background": "", "description": "小 R 有 $m$（$1 \\le m \\le 1000$）个机器人和 $m$ 张纸带，第 $i$（$1 \\le i \\le m$）个机器人负责对第 $i$ 张纸带进行操作。对于每张纸带，它们都被从左到右分成了 $n$（$1 \\le n \\le 32$）个格子，依次编号为 $0, 1, \\ldots , n - 1$。每个格子有 $3$ 种状态：1. 格子上写有数字 $0$；2. 格子上写有数字 $1$；3. 格子是一个空格子。\n\n在任意时刻，机器人**必须**站在纸带上的一个格子中。在设定好机器人在纸带上的初始位置后，第 $i$ 个机器人会依次执行预先设定的操作序列 $S_i$，操作由 `R`、`0`、`1`、`*` 四种字符组成，其中：\n\n1. `R` 表示机器人向右走一格，如果右边没有格子，则机器人会原地爆炸；\n2. `0` 表示如果机器人所在格子非空，则将该格子上的数字改为 $0$，否则不修改；\n3. `1` 表示如果机器人所在格子非空，则将该格子上的数字改为 $1$，否则不修改；\n4. `*` 表示如果机器人所在格子非空，则将格子上的数字 $x$ 改为 $1 - x$，否则不修改。\n\n第 $i$ 张纸带的状态可以用一个长度为 $n$ 的序列表示，每个元素为 `0`、`1` 或 `-`（空格子），依次表示其每个格子的状态。第 $i$ 张纸带的初始状态称为机器人 $i$ 的输入 $X_i$，操作执行完成后纸带的状态称为机器人 $i$ 的输出 $Y_i$。注意，如果机器人爆炸了，那么这个机器人就没有输出。\n\n可以发现，如果一个格子为空，那么机器人永远不会修改它。所以每个机器人都有如下特性：如果第 $i$ 个机器人所在的纸带上的**所有格子**都为空，那么它就不会执行任何操作，它的输出即为所有格子都为空。\n\n现在小 R 给定了每一个机器人的输入 $X_i$（即每张纸带的初始状态）以及目标输出 $Y_i$。小 R 希望小 D 找到一个位置 $p$（$0 \\le p < n$），使得**所有机器人**都能以其所在纸带的第 $p$ 个格子为初始位置，在不爆炸的情况下执行完所有操作，并且满足第 $i$ 个机器人的输出为 $Y_i$。\n\n小 D 花了几毫秒解决了问题，现在他想知道，有多少个输入和输出的组合方式使得上述问题有解，即有多少种为每个机器人设定输入 $X_0, X_1, \\ldots , X_{m - 1}$ 和目标输出 $Y_0, Y_1, \\ldots , Y_{m - 1}$ 的方式，使得至少存在一个位置 $p$（$0 \\le p < n$），使得所有机器人都能以其所在纸带的第 $p$ 个格子为起点，在不爆炸的情况下执行完所有操作，且满足第 $i$ 个机器人的输出为 $Y_i$。请你帮助小 D 解决这个问题，由于最终的答案可能很大，请你输出答案对 ${10}^9 + 7$ 取模后的余数。\n\n两个组合方式不同当且仅当，存在至少一个机器人，它的输入或是目标输出在两个方式中不同。", "inputFormat": "第一行包含两个正整数 $n, m$，分别表示每张纸带上的格子数和纸带数量。\n\n接下来 $m$ 行，第 $i$ 行输入一个仅包含 `R` `0` `1` `*` 这四种字符的字符串 $S_i$，表示第 $i$ 个机器人的操作序列。", "outputFormat": "仅一行一个正整数，表示答案模 ${10}^9 + 7$ 后的余数。", "hint": "**【样例解释 #1】**\n\n| 方案编号 | 输入 $X_0$ | 目标输出 $Y_0$ | 可行初始位置 $p$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | `--` | `--` | $0, 1$ |\n| $2$ | `0-` | `1-` | $0$ |\n| $3$ | `1-` | `1-` | $0$ |\n| $4$ | `-0` | `-1` | $0$ |\n| $5$ | `-1` | `-0` | $0$ |\n| $6$ | `00` | `11` | $0$ |\n| $7$ | `10` | `11` | $0$ |\n| $8$ | `01` | `10` | $0$ |\n| $9$ | `11` | `10` | $0$ |\n\n表中 `-` 表示空格子，注意方案 $1$ 中的输入和输出中有两个空格子。\n\n当输入全为空时，初始位置可以是 $0$ 或 $1$，因为根据题意，输入全为空时机器人不会执行任何操作。\n\n当输入不全为空时，初始位置只能为 $0$，如果初始位置为 $1$ 机器人一定会爆炸。所以此时实际执行的操作是将第一格的数字改为 $1$，并将第二格的数字 $x$ 改为 $1 - x$。\n\n**【样例解释 #2】**\n\n可以用容斥原理来计算这个样例。\n\n1. 初始位置 $p = 0$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带 $0$ 号格子要么输入输出都是空，要么目标输出是 $1$（输入无所谓），所以有 $3$ 种方案；$1$ 号格子要么输入输出都是空，要么目标输出是 $0$，也是 $3$ 种方案；$2$ 号格子要么输入输出都是空，要么输入和目标输出相同（因为没有对该格子执行任何操作），同样是 $3$ 种方案，共 $27$ 种方案。第二个机器人的 $0$ 号格子要么输入输出都是空，要么输入和目标输出不同，是 $3$ 种方案，$1$ 号和 $2$ 号格子也都是 $3$ 种方案，共 $27$ 种方案。所以总共 $27 \\times 27 = 729$ 种方案。\n2. 初始位置 $p = 1$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带三个格子都是 $3$ 种方案，其中 $0$ 号格子要么输入输出都为空，要么相同；$1$ 号格子要么输入输出都为空，要么目标输出是 $1$；$2$ 号格子的输入输出要么都为空，要么输出是 $0$，共 $27$ 种方案。第二个机器人的 $1$ 号格子要么输入输出都是空，要么输入和目标输出不同，是 $3$ 种方案；$0$ 号和 $2$ 号格子要么输入输出都为空，要么输入输出相同，也都是 $3$ 种方案，共 $27$ 种方案。总共 $27 \\times 27 = 729$ 种方案。\n3. 初始位置 $p = 2$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带必须输入输出全为空（否则爆炸），只有 $1$ 种方案。第二个机器人是 $27$ 种方案，总共 $27$ 种方案。\n4. 初始位置 $p = 0, 1$ 都满足条件。这要求第一个机器人的 $1$ 号格子输入输出都为空；$0$ 号格子的输入输出都为空或都为 $1$；$2$ 号格子的输入输出都为空或都为 $0$，所以第一个机器人的纸带有 $4$ 种方案。第二个机器人 $0$ 号格子和 $1$ 号格子都为空，$2$ 号格子有 $3$ 种方案，第二个机器人的 $0$ 号和 $1$ 号格子必须都为空，$2$ 号格子要么输入输出都为空，要么输入和输出相同，有 $3$ 种方案。总共 $12$ 种方案。\n5. 初始位置 $p = 0, 2$ 都满足条件。那么第一个机器人的纸带必须输入输出全为空（否则爆炸），只有 $1$ 种方案。第二个机器人 $0$ 号和 $2$ 号格子都为空，$1$ 号格子有 $3$ 种方案。总共 $3$ 种方案。\n6. 初始位置 $p = 1, 2$ 都满足条件。那么第一个机器人的纸带必须输入输出全为空，只有 $1$ 种方案。第二个机器人 $1$ 号和 $2$ 号格子都为空，$0$ 号格子有 $3$ 种方案。总共 $3$ 种方案。\n7. 初始位置 $p = 0, 1, 2$ 都满足条件。那么两个机器人的输入输出必须都为空，总共 $1$ 种方案。\n\n根据容斥原理，最后的答案为 $729 + 729 + 27 - 12 - 3 - 3 + 1 = 1468$。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le 32$，$1 \\le m \\le 1000$，$1 \\le \\lvert S_i \\rvert \\le 100$。\n\n| 测试点编号 | $n \\le$ | $m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 2$ | $1$ | $1$ | 无 |\n| $3$ | $8$ | $1$ | 无 |\n| $4$ | $16$ | $1$ | 无 |\n| $5 \\sim 6$ | $32$ | $1$ | 无 |\n| $7$ | $16$ | $5$ | 无 |\n| $8 \\sim 10$ | $32$ | $5$ | 无 |\n| $11 \\sim 12$ | $16$ | $1000$ | 无 |\n| $13 \\sim 15$ | $32$ | $1000$ | A |\n| $16 \\sim 21$ | $32$ | $1000$ | B |\n| $22 \\sim 25$ | $32$ | $1000$ | 无 |\n\n特殊限制 A：操作序列中不存在 `R`。\n\n特殊限制 B：每个操作序列中，`R` 的数量至多 $15$ 个。", "locale": "zh-CN"}}}
{"pid": "P7741", "type": "P", "difficulty": 4, "samples": [["3 4\n1011\n1111\n1111", "10"], ["4 5\n10110\n01111\n11110\n10101", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2007", "各省省选", "安徽", "O2优化"], "title": "[AHOI2007] 石块地板", "background": "", "description": "小可可来到了宫殿的正厅中。大厅的地面是由一块块大小一致的正方形石块组成的，这些石块分为黑、白两色，组成了一个   $m×n$ 的矩形，在其中一个石块的下面就是通往藏宝库的通道。小可可不可能一个一个石块的尝试，因为有些石块安装了机关，一碰就会触发，整个宫殿也随之倒塌。根据藏宝图记载，通道在某一特定的区域中，这个区域是一个由数个石块组成的面积不为 $0$ 的小矩形，它的四条边与大厅地面的边平行。如果对整个大厅地面任意划分矩形，那么在所有矩形中，这个区域的黑色石块数目减去白色石块数目所得的差是最大的。\n\n小可可希望和你分工，由他来选择区域，你来计算黑、白两色石块的数目差 $S$ 。这样就能快速而准确的确认通道所在的区域。藏宝图上说这个区域中的石块都没有安装机关，只要确定了区域，就一定能找到通道。宝藏就在眼前了，加油吧！\n\n（假设用 $1$ 表示黑色石块，用 $0$ 表示白色石块）", "inputFormat": "输入文件的第一行为两个整数 $m,n$。\n\n以下 $m$ 行，每行 $n$ 个字符，每个字符都是 $0$ 或 $1$。", "outputFormat": "输出文件仅一个数，表示所有可能的区域中 $S$ 值（见前文描述）最大的一个，输出这个值即可。", "hint": "对于 $ 50\\%$ 的数据：$1 \\le m, n \\leq200$。\n\n对于 $100\\%$ 的数据：$1 \\le m, n \\leq400$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[AHOI2007] 石块地板", "background": "", "description": "小可可来到了宫殿的正厅中。大厅的地面是由一块块大小一致的正方形石块组成的，这些石块分为黑、白两色，组成了一个   $m×n$ 的矩形，在其中一个石块的下面就是通往藏宝库的通道。小可可不可能一个一个石块的尝试，因为有些石块安装了机关，一碰就会触发，整个宫殿也随之倒塌。根据藏宝图记载，通道在某一特定的区域中，这个区域是一个由数个石块组成的面积不为 $0$ 的小矩形，它的四条边与大厅地面的边平行。如果对整个大厅地面任意划分矩形，那么在所有矩形中，这个区域的黑色石块数目减去白色石块数目所得的差是最大的。\n\n小可可希望和你分工，由他来选择区域，你来计算黑、白两色石块的数目差 $S$ 。这样就能快速而准确的确认通道所在的区域。藏宝图上说这个区域中的石块都没有安装机关，只要确定了区域，就一定能找到通道。宝藏就在眼前了，加油吧！\n\n（假设用 $1$ 表示黑色石块，用 $0$ 表示白色石块）", "inputFormat": "输入文件的第一行为两个整数 $m,n$。\n\n以下 $m$ 行，每行 $n$ 个字符，每个字符都是 $0$ 或 $1$。", "outputFormat": "输出文件仅一个数，表示所有可能的区域中 $S$ 值（见前文描述）最大的一个，输出这个值即可。", "hint": "对于 $ 50\\%$ 的数据：$1 \\le m, n \\leq200$。\n\n对于 $100\\%$ 的数据：$1 \\le m, n \\leq400$。", "locale": "zh-CN"}}}
{"pid": "P7742", "type": "P", "difficulty": 2, "samples": [["3\nABC\nBLJTV1\nBLJTV2", "33"], ["4\nABC1\nABC02\nBLJTV2\nBLJTV1", "11144411144"], ["4\nABC1\nABC02\nBLJTV2\nBLJTV1", "33144413"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] DIGITALNA", "background": "由于答案不唯一，**本题使用 SPJ 评测**。", "description": "不久前，Mirko 的祖父母不得不从模拟电视接收器切换到数字电视接收器。在他们的旧模拟电视接收器上，他们只能观看两个频道——BLJTV1 和 BLJTV2。换成数字接收器后，他们获得了几十个新的频道，但他们仍然想只看以前的两个频道。他们要求 Mirko 调整频道菜单，使 BLJTV1 在第一个频道，BLJTV2 在第二个频道上。开机后，数字接收器会创建一个可用频道的列表。所有的频道都是不同的，列表中总是包含 BLJTV1 和 BLJTV2。Mirko 找到了遥控器后开始调整菜单。菜单中包含了频道列表和一个标着当前选择频道的箭头。进入菜单后，箭头标志着列表中的第一个频道。菜单中有四种操作，每种操作在操作序列中用其前面的编号表示：\n\n1. 将箭头向下移动一个位置（从频道 $i$ 到频道 $i+1$）；\n2. 将箭头向上移动一个位置（从频道 $i$ 到频道 $i-1$）；\n3. 将箭头和选定的频道向下移动一个位置（频道 $i$ 和频道 $i+1$ 交换位置，箭头在频道 $i+1$ 的位置结束）；\n4. 将箭头和选定的通道向上移动一个位置（频道 $i$ 和频道 $i-1$ 交换位置，箭头在频道 $i-1$ 的位置结束）。\n\n菜单是稳定的，所以无效的命令（如将箭头移到频道列表之外的命令）都将被忽略。\n\n编写一个程序，给定一个频道列表，输出一个任何操作的序列，使其在执行后，BLJTV1 在频道列表的第一个位置，BLJTV2 在第二个位置。此外，该序列的长度应小于 $500$。所有其他频道的排序是**任意的**。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行一个整数 $n$，表示频道个数。  \n随后 $n$ 行，每行一个字符串 $s$，表示频道的名字。\n\n输入数据保证所有频道中一定有 BLJTV1 和 BLJTV2 这两个频道，并且**一定存在至少一种**可行的操作序列。", "outputFormat": "输出仅一行，一个字符串，表示能够达到要求的操作序列。", "hint": "**【数据范围】**\n\n对于所有数据，$2\\leqslant n\\leqslant 100$，频道名字长度不超过 $10$，且仅包括大写英文字母和数字。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T1 DIGITALNA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。\n\n感谢 [yzy1](https://www.luogu.com.cn/user/207996) 提供本题的 SPJ。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] DIGITALNA", "background": "由于答案不唯一，**本题使用 SPJ 评测**。", "description": "不久前，Mirko 的祖父母不得不从模拟电视接收器切换到数字电视接收器。在他们的旧模拟电视接收器上，他们只能观看两个频道——BLJTV1 和 BLJTV2。换成数字接收器后，他们获得了几十个新的频道，但他们仍然想只看以前的两个频道。他们要求 Mirko 调整频道菜单，使 BLJTV1 在第一个频道，BLJTV2 在第二个频道上。开机后，数字接收器会创建一个可用频道的列表。所有的频道都是不同的，列表中总是包含 BLJTV1 和 BLJTV2。Mirko 找到了遥控器后开始调整菜单。菜单中包含了频道列表和一个标着当前选择频道的箭头。进入菜单后，箭头标志着列表中的第一个频道。菜单中有四种操作，每种操作在操作序列中用其前面的编号表示：\n\n1. 将箭头向下移动一个位置（从频道 $i$ 到频道 $i+1$）；\n2. 将箭头向上移动一个位置（从频道 $i$ 到频道 $i-1$）；\n3. 将箭头和选定的频道向下移动一个位置（频道 $i$ 和频道 $i+1$ 交换位置，箭头在频道 $i+1$ 的位置结束）；\n4. 将箭头和选定的通道向上移动一个位置（频道 $i$ 和频道 $i-1$ 交换位置，箭头在频道 $i-1$ 的位置结束）。\n\n菜单是稳定的，所以无效的命令（如将箭头移到频道列表之外的命令）都将被忽略。\n\n编写一个程序，给定一个频道列表，输出一个任何操作的序列，使其在执行后，BLJTV1 在频道列表的第一个位置，BLJTV2 在第二个位置。此外，该序列的长度应小于 $500$。所有其他频道的排序是**任意的**。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行一个整数 $n$，表示频道个数。  \n随后 $n$ 行，每行一个字符串 $s$，表示频道的名字。\n\n输入数据保证所有频道中一定有 BLJTV1 和 BLJTV2 这两个频道，并且**一定存在至少一种**可行的操作序列。", "outputFormat": "输出仅一行，一个字符串，表示能够达到要求的操作序列。", "hint": "**【数据范围】**\n\n对于所有数据，$2\\leqslant n\\leqslant 100$，频道名字长度不超过 $10$，且仅包括大写英文字母和数字。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T1 DIGITALNA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。\n\n感谢 [yzy1](https://www.luogu.com.cn/user/207996) 提供本题的 SPJ。", "locale": "zh-CN"}}}
{"pid": "P7743", "type": "P", "difficulty": 2, "samples": [["235217\n3\nA 107382\nC 18059\nB 43265\n", "A 9\nB 4\nC 1"], ["245143\n4\nF 14845\nA 104516\nB 52652\nC 14161", "A 8\nB 4\nC 1\nF 1"], ["206278\n5\nD 44687\nA 68188\nC 7008\nB 48377\nG 9665", "A 6\nB 4\nD 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] D’HONDT", "background": "$12$ 月初，某国举行议会选举。这个国家被分为十个选区，每个选区要选出 $14$ 名议会代表。每个选民都投票支持少数政党中的一个。投票后，选区代表用 D'Hondt 分配原理选出。", "description": "某一个选区里面有 $x$ 个选民，并有 $n$ 个政党参加议会选举。运用 D'Hondt 分配原理，我们先选出选票**至少占选民总数的 $5\\%$** 的政党。然后对于某一个政党的票数分别除以 $1,2,\\dots,14$，并将 $14$ 个除得的**实数**作为这个政党的分数分配给这个政党。然后，我们从拥有最高得分的政党中选出第一个代表，拥有第二高得分的政党中选出第二个代表，以此类推。注意，在本题中，我们默认**选举代表的方式总是唯一的，即所有分数都不相同。**\n\n现在，请你编写一个程序，给定选民的总数和每个政党得到的选票个数。请求出得到的选票至少占选民总数的 $5\\%$ 的所有政党中，每一个政党能够选出的代表数。", "inputFormat": "输入共 $n+2$ 行。\n\n第一行一个整数 $x$，表示选民的个数。  \n第二行一个整数 $n$，表示参加议会选举的政党数。  \n随后 $n$ 行，每行一个大写字母和一个整数 $g$，分别表示政党的标识符和该政党拥有的选票数。", "outputFormat": "输出若干行，每行一个大写字母和一个整数，分别代表一个得到的选票至少占选民总数的 $5\\%$ 的政党的标识符和能够选出的代表数。\n\n得到的选票至少占选民总数的 $5\\%$ 的所有政党按照标识符在字母表中的位置升序排列。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，保证输入中所有政党拥有的票数都至少占选民总数的 $5\\%$。  \n对于所有数据，$1\\leqslant x\\leqslant 2.5\\times 10^6$，$0\\leqslant n\\leqslant 10$，$1\\leqslant g\\leqslant 2.5\\times 10^5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T2 D'HONDT_**，按照原题数据配置，满分 $80$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] D’HONDT", "background": "$12$ 月初，某国举行议会选举。这个国家被分为十个选区，每个选区要选出 $14$ 名议会代表。每个选民都投票支持少数政党中的一个。投票后，选区代表用 D'Hondt 分配原理选出。", "description": "某一个选区里面有 $x$ 个选民，并有 $n$ 个政党参加议会选举。运用 D'Hondt 分配原理，我们先选出选票**至少占选民总数的 $5\\%$** 的政党。然后对于某一个政党的票数分别除以 $1,2,\\dots,14$，并将 $14$ 个除得的**实数**作为这个政党的分数分配给这个政党。然后，我们从拥有最高得分的政党中选出第一个代表，拥有第二高得分的政党中选出第二个代表，以此类推。注意，在本题中，我们默认**选举代表的方式总是唯一的，即所有分数都不相同。**\n\n现在，请你编写一个程序，给定选民的总数和每个政党得到的选票个数。请求出得到的选票至少占选民总数的 $5\\%$ 的所有政党中，每一个政党能够选出的代表数。", "inputFormat": "输入共 $n+2$ 行。\n\n第一行一个整数 $x$，表示选民的个数。  \n第二行一个整数 $n$，表示参加议会选举的政党数。  \n随后 $n$ 行，每行一个大写字母和一个整数 $g$，分别表示政党的标识符和该政党拥有的选票数。", "outputFormat": "输出若干行，每行一个大写字母和一个整数，分别代表一个得到的选票至少占选民总数的 $5\\%$ 的政党的标识符和能够选出的代表数。\n\n得到的选票至少占选民总数的 $5\\%$ 的所有政党按照标识符在字母表中的位置升序排列。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，保证输入中所有政党拥有的票数都至少占选民总数的 $5\\%$。  \n对于所有数据，$1\\leqslant x\\leqslant 2.5\\times 10^6$，$0\\leqslant n\\leqslant 10$，$1\\leqslant g\\leqslant 2.5\\times 10^5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T2 D'HONDT_**，按照原题数据配置，满分 $80$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7744", "type": "P", "difficulty": 3, "samples": [["3 2", "19"], ["3 4", "42"], ["737 296", "763532"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] POGODAK", "background": "Mirko 不喜欢拉丁文作业，所以他和 Slavko 打了个赌。输的人将在整个月内写他们两个人的作业。Mirko 想赢，所以他设计了这个问题用来打赌。", "description": "在他的桌子上，他发现了一个立方体，如图中所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/csekseld.png)\n\n在这个立方体中，两个对立面的点数之和等于 $7$。这意味着，$6$ 在 $1$ 的对面，$5$ 在 $2$ 的对面，$4$ 在 $3$ 的对面。Mirko 将立方体放在了一个 $r\\times c$ 的矩阵的左上方，最初立方体的方向是上侧显示 $1$，右侧显示 $3$。Mirko 现在依次重复以下动作：\n\n1. 向右滚动立方体，直到它到达最后一列；\n2. 向下滚动到下一行；\n3. 向左滚动立方体，直到它到达第一列；\n4. 像第二步一样，向下滚动到下一行。\n\nMirko 不停地重复这些步骤，直到立方体不能够再滚动为止。当一个立方体到达某一格时，Mirko 在这个格子中写下立方体的顶部的数字。最后他把他写的所有数字加起来。Mirko 与 Slavko 打了个赌，赌他能毫无差错地算出这个和。帮助 Slavko 算出这个和以验证 Mirko 的答案。 ", "inputFormat": "输入仅一行，两个整数 $r,c$，分别表示矩阵的行数和列数。", "outputFormat": "输出仅一行一个整数，表示最终矩阵里面填入的所有数字的和。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，最终矩阵里面填入的数字如下所示：\n\n| $1$ | $4$ |\n| :----------: | :----------: |\n| $1$ | $5$ |\n| $3$ | $5$ |\n\n因此最终的和为 $1+4+1+5+3+5=19$。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，满足 $r,c\\leqslant 100$。  \n对于所有数据，$1\\leqslant r,c\\leqslant 10^5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T3 POGODAK_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] POGODAK", "background": "Mirko 不喜欢拉丁文作业，所以他和 Slavko 打了个赌。输的人将在整个月内写他们两个人的作业。Mirko 想赢，所以他设计了这个问题用来打赌。", "description": "在他的桌子上，他发现了一个立方体，如图中所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/csekseld.png)\n\n在这个立方体中，两个对立面的点数之和等于 $7$。这意味着，$6$ 在 $1$ 的对面，$5$ 在 $2$ 的对面，$4$ 在 $3$ 的对面。Mirko 将立方体放在了一个 $r\\times c$ 的矩阵的左上方，最初立方体的方向是上侧显示 $1$，右侧显示 $3$。Mirko 现在依次重复以下动作：\n\n1. 向右滚动立方体，直到它到达最后一列；\n2. 向下滚动到下一行；\n3. 向左滚动立方体，直到它到达第一列；\n4. 像第二步一样，向下滚动到下一行。\n\nMirko 不停地重复这些步骤，直到立方体不能够再滚动为止。当一个立方体到达某一格时，Mirko 在这个格子中写下立方体的顶部的数字。最后他把他写的所有数字加起来。Mirko 与 Slavko 打了个赌，赌他能毫无差错地算出这个和。帮助 Slavko 算出这个和以验证 Mirko 的答案。 ", "inputFormat": "输入仅一行，两个整数 $r,c$，分别表示矩阵的行数和列数。", "outputFormat": "输出仅一行一个整数，表示最终矩阵里面填入的所有数字的和。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，最终矩阵里面填入的数字如下所示：\n\n| $1$ | $4$ |\n| :----------: | :----------: |\n| $1$ | $5$ |\n| $3$ | $5$ |\n\n因此最终的和为 $1+4+1+5+3+5=19$。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，满足 $r,c\\leqslant 100$。  \n对于所有数据，$1\\leqslant r,c\\leqslant 10^5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T3 POGODAK_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7745", "type": "P", "difficulty": 4, "samples": [["1 3\n0 -10\nISI", "11\n12\n13"], ["3 5\n0 0\n1 1\n1 -1\nSIJJZ", "5\n4\n3\n4\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] ROBOT", "background": "Mirko 创造了一个新的机器人，并决定在一个巨大的测试轨道上测试它。", "description": "我们不妨把测试轨道想象成一个二维坐标系。机器人从 $(0,0)$ 开始，接收一组由 `S`、`J`、`I`、`Z` 表示的指令，每一个指令都标志着机器人应该在哪个方向移动。具体地，如果机器人当前位于 $(x,y)$：\n\n- 指令 `S` 意味着它应该移动到 $(x,y+1)$。\n- 指令 `J` 意味着它应该移动到 $(x,y-1)$。\n- 指令 `I` 意味着它应该移动到 $(x+1,y)$。\n- 指令 `Z` 意味着它应该移动到 $(x-1,y)$。\n\n当机器人接受指令并在测试轨道上移动时，Mirko 以下列方式验证其位置：\n\n测试轨道上有 $n$ 个固定的控制点，每个控制点都会测量与机器人的**曼哈顿距离**，并将所有距离的和发送给 Mirko。假设机器人完全按照指令移动，请你计算执行每条指令后所有控制点距离机器人的曼哈顿距离之和。", "inputFormat": "输入共 $n+2$ 行。\n\n第一行，两个整数 $n,m$，分别表示控制点的数量和指令的数量。  \n第 $2\\sim n+1$ 行，每行两个整数 $(x_i,y_i)$，分别表示每个控制点的横坐标和纵坐标。  \n第 $n+2$ 行一个长度为 $m$ 的字符串，表示机器人将接收到的指令。", "outputFormat": "输出共 $m$ 行，每行一个整数，表示执行每条指令后所有控制点距离机器人的曼哈顿距离之和。", "hint": "**【前置知识】**\n\n- 曼哈顿距离：设有两个点 $(a,b)$ 和 $(c,d)$，则这两个点的曼哈顿距离为 $|a-c|+|b-d|$。\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 10^5$，$1\\leqslant m\\leqslant 3\\times 10^5$，$|x_i|,|y_i|\\leqslant 10^6$，指令仅包含 `S`、`I`、`J`、`Z` 四个字符中的一个。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T4 ROBOT_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] ROBOT", "background": "Mirko 创造了一个新的机器人，并决定在一个巨大的测试轨道上测试它。", "description": "我们不妨把测试轨道想象成一个二维坐标系。机器人从 $(0,0)$ 开始，接收一组由 `S`、`J`、`I`、`Z` 表示的指令，每一个指令都标志着机器人应该在哪个方向移动。具体地，如果机器人当前位于 $(x,y)$：\n\n- 指令 `S` 意味着它应该移动到 $(x,y+1)$。\n- 指令 `J` 意味着它应该移动到 $(x,y-1)$。\n- 指令 `I` 意味着它应该移动到 $(x+1,y)$。\n- 指令 `Z` 意味着它应该移动到 $(x-1,y)$。\n\n当机器人接受指令并在测试轨道上移动时，Mirko 以下列方式验证其位置：\n\n测试轨道上有 $n$ 个固定的控制点，每个控制点都会测量与机器人的**曼哈顿距离**，并将所有距离的和发送给 Mirko。假设机器人完全按照指令移动，请你计算执行每条指令后所有控制点距离机器人的曼哈顿距离之和。", "inputFormat": "输入共 $n+2$ 行。\n\n第一行，两个整数 $n,m$，分别表示控制点的数量和指令的数量。  \n第 $2\\sim n+1$ 行，每行两个整数 $(x_i,y_i)$，分别表示每个控制点的横坐标和纵坐标。  \n第 $n+2$ 行一个长度为 $m$ 的字符串，表示机器人将接收到的指令。", "outputFormat": "输出共 $m$ 行，每行一个整数，表示执行每条指令后所有控制点距离机器人的曼哈顿距离之和。", "hint": "**【前置知识】**\n\n- 曼哈顿距离：设有两个点 $(a,b)$ 和 $(c,d)$，则这两个点的曼哈顿距离为 $|a-c|+|b-d|$。\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 10^5$，$1\\leqslant m\\leqslant 3\\times 10^5$，$|x_i|,|y_i|\\leqslant 10^6$，指令仅包含 `S`、`I`、`J`、`Z` 四个字符中的一个。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T4 ROBOT_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7746", "type": "P", "difficulty": 4, "samples": [["2 3\n5\n3 1\np 1 5\nu 2\nu 1", "8\n5"], ["5 5\n4\n2 1\n6 1\n7 1\n3 4\nu 3\np 1 -1\nu 3\np 4 5\nu 5", "6\n5\n7"], ["6 7\n5\n4 1\n3 2\n7 3\n2 3\n3 5\np 3 2\np 2 4\nu 3\nu 6\np 5 -2\nu 6\nu 1", "7\n9\n7\n5"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2011", "树链剖分", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] PLAĆE", "background": "Mirko 喜欢汽车，他终于成功地开办了自己的汽车工厂。", "description": "工厂有 $n$ 个员工，每个人都有一个上司（除了 Mirko 默认为每个人的上司）。Mirko 用 $1$ 号表示，其余员工用 $2\\sim n$ 号表示。每个员工都可以提高或降低他所有下属（包括直接下属和等级树上的下属）的工资。Mirko 的职责是防止这种权力的滥用，所以他不时地想知道某个雇员的工资。他要求你写一个程序，给定一系列命令（见输入格式部分），帮助他监控工资的变化。注意：在任何时候，所有的工资都是正整数，并适合于标准的 $32$ 位整数类型（C/C++ 中的 `int`，Pascal 中的 `longint`）。", "inputFormat": "输入共 $n+m+1$ 行。\n\n第一行，两个整数 $n,m$，分别表示员工的总数和指令的个数。  \n第 $2\\sim n+1$ 行，第 $i$ 行两个整数分别表示第 $i-1$ 号员工的初始工资和他的直属上司（注意，Mirko 并没有上司，因此输入他的信息的那一行仅输入他的初始工资）。  \n第 $n+2\\sim n+m+1$ 行，每行先输入一个字符表示命令类型，接下来的输入如下所述：\n\n- 如果字符为 `p`，接下来两个整数 $a,x$，表示员工 $a$ 将它的所有下属（包括**直系下属**和**他能够间接控制到的所有下属**）的工资增加了 $x$（如果 $x$ 是负数则相当于减少工资）。\n- 如果字符为 `u`，接下来仅一个整数 $a$，表示 Mirko 想知道员工 $a$ 的工资。", "outputFormat": "对于每一个 `u` 操作，输出一行一个整数，表示被询问的员工的工资。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant n,m\\leqslant 5\\times 10^5$，$1\\leqslant a\\leqslant n$，$-10^4\\leqslant x\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T5 PLAĆE_**，按照原题数据配置，满分 $140$ 分。\n\n由 [Eason_AC](/user/112917) 翻译整理提供， [123asdf123](/user/576074) 微调。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] PLAĆE", "background": "Mirko 喜欢汽车，他终于成功地开办了自己的汽车工厂。", "description": "工厂有 $n$ 个员工，每个人都有一个上司（除了 Mirko 默认为每个人的上司）。Mirko 用 $1$ 号表示，其余员工用 $2\\sim n$ 号表示。每个员工都可以提高或降低他所有下属（包括直接下属和等级树上的下属）的工资。Mirko 的职责是防止这种权力的滥用，所以他不时地想知道某个雇员的工资。他要求你写一个程序，给定一系列命令（见输入格式部分），帮助他监控工资的变化。注意：在任何时候，所有的工资都是正整数，并适合于标准的 $32$ 位整数类型（C/C++ 中的 `int`，Pascal 中的 `longint`）。", "inputFormat": "输入共 $n+m+1$ 行。\n\n第一行，两个整数 $n,m$，分别表示员工的总数和指令的个数。  \n第 $2\\sim n+1$ 行，第 $i$ 行两个整数分别表示第 $i-1$ 号员工的初始工资和他的直属上司（注意，Mirko 并没有上司，因此输入他的信息的那一行仅输入他的初始工资）。  \n第 $n+2\\sim n+m+1$ 行，每行先输入一个字符表示命令类型，接下来的输入如下所述：\n\n- 如果字符为 `p`，接下来两个整数 $a,x$，表示员工 $a$ 将它的所有下属（包括**直系下属**和**他能够间接控制到的所有下属**）的工资增加了 $x$（如果 $x$ 是负数则相当于减少工资）。\n- 如果字符为 `u`，接下来仅一个整数 $a$，表示 Mirko 想知道员工 $a$ 的工资。", "outputFormat": "对于每一个 `u` 操作，输出一行一个整数，表示被询问的员工的工资。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant n,m\\leqslant 5\\times 10^5$，$1\\leqslant a\\leqslant n$，$-10^4\\leqslant x\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T5 PLAĆE_**，按照原题数据配置，满分 $140$ 分。\n\n由 [Eason_AC](/user/112917) 翻译整理提供， [123asdf123](/user/576074) 微调。", "locale": "zh-CN"}}}
{"pid": "P7747", "type": "P", "difficulty": 6, "samples": [["3 3\n2\n1\n1\n2\n1\n1", "11"], ["3 3\n2\n3\n3\n2\n1\n2", "29"], ["4 5\n3\n2\n2\n2\n3\n1\n2\n1\n2", "55"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "斜率优化", "凸包", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] TRAKA", "background": "", "description": "Mirko 的工厂里面有 $n$ 个工人。他们以流水线方式在传送带上制造汽车。工人从左往右编号为 $1\\sim n$，其中工人 $1$ 即为 Mirko。汽车生产从工人 $1$（Mirko）开始，在他完成所有他的工作后，工人 $2$ 接手他的任务。之后工人 $3$ 再接手工人 $2$ 的任务，以此类推。当工人 $n$ 完成他的工作后，一辆汽车就生产完成了。\n\nMirko 和他的工人们必须生产 $m$ 辆汽车，且必须按 $1\\sim m$ 的顺序生产。对于第 $i$ 个工人，他完成他的工作的时间为 $t_i$。对于第 $j$ 辆汽车，它装配的复杂度为 $f_j$。工人 $i$ 在汽车 $j$ 上完成他的工作所需时间为 $t_i\\cdot f_j$。\n\n根据公司政策，一个工人完成他的工作后，他必须立即将工作交给下一个工人，不得拖延。因此，下一个工人此时不能够在其他汽车上工作。为了满足这个条件，Mirko 必须等到一个好的时机开始制造一辆新车。为了提高效率，他将等待最少的时间，直到他确定能够满足所有条件。\n\n编写一个程序，给定每个工人完成他的工作的时间和每辆车装配的复杂度，求生产所有汽车所需的总时间。", "inputFormat": "输入共 $n+m+2$ 行。\n\n第一行，两个整数 $n,m$，分别代表工人的个数和需要生产的汽车的辆数。  \n随后 $n$ 行，每行一个整数 $t_i$，表示第 $i$ 个工人完成他的工作的时间。  \n随后 $m$ 行，每行一个整数 $f_j$，表示第 $j$ 辆车装配的复杂度。", "outputFormat": "输出仅一行一个整数，表示生产所有汽车所需的总时间。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，$4$ 个单位的时间后，工人 $1$ 完成了第一辆车的工作。他可能会立即开始在第二辆车上工作，但这违反了汽车必须在完成后立即传递给下一个工人的条件（$7$ 个单位的时间后第二个工人将完成他在第二辆车上的工作，但是第三个工人不能接手，因为他仍然在第一辆车上工作）。因此，第二辆车在 $5$ 个单位的时间后才能开始生产。$7$ 个单位的时间后开始生产第三辆汽车。第一辆车在 $8$ 个单位的时间后完成，第二辆车在 $9$ 个单位的时间后完成，第三辆车在 $11$ 个单位的时间后完成。因此总时间是 $11$。\n\n**【数据范围】**\n\n对于 $40\\%$ 的数据，满足 $n,m\\leqslant 1000$。  \n对于所有数据，$1\\leqslant n,m\\leqslant 10^5$，$1\\leqslant t_i,f_j\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T6 TRAKA_**，按照原题数据配置，满分 $160$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] TRAKA", "background": "", "description": "Mirko 的工厂里面有 $n$ 个工人。他们以流水线方式在传送带上制造汽车。工人从左往右编号为 $1\\sim n$，其中工人 $1$ 即为 Mirko。汽车生产从工人 $1$（Mirko）开始，在他完成所有他的工作后，工人 $2$ 接手他的任务。之后工人 $3$ 再接手工人 $2$ 的任务，以此类推。当工人 $n$ 完成他的工作后，一辆汽车就生产完成了。\n\nMirko 和他的工人们必须生产 $m$ 辆汽车，且必须按 $1\\sim m$ 的顺序生产。对于第 $i$ 个工人，他完成他的工作的时间为 $t_i$。对于第 $j$ 辆汽车，它装配的复杂度为 $f_j$。工人 $i$ 在汽车 $j$ 上完成他的工作所需时间为 $t_i\\cdot f_j$。\n\n根据公司政策，一个工人完成他的工作后，他必须立即将工作交给下一个工人，不得拖延。因此，下一个工人此时不能够在其他汽车上工作。为了满足这个条件，Mirko 必须等到一个好的时机开始制造一辆新车。为了提高效率，他将等待最少的时间，直到他确定能够满足所有条件。\n\n编写一个程序，给定每个工人完成他的工作的时间和每辆车装配的复杂度，求生产所有汽车所需的总时间。", "inputFormat": "输入共 $n+m+2$ 行。\n\n第一行，两个整数 $n,m$，分别代表工人的个数和需要生产的汽车的辆数。  \n随后 $n$ 行，每行一个整数 $t_i$，表示第 $i$ 个工人完成他的工作的时间。  \n随后 $m$ 行，每行一个整数 $f_j$，表示第 $j$ 辆车装配的复杂度。", "outputFormat": "输出仅一行一个整数，表示生产所有汽车所需的总时间。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，$4$ 个单位的时间后，工人 $1$ 完成了第一辆车的工作。他可能会立即开始在第二辆车上工作，但这违反了汽车必须在完成后立即传递给下一个工人的条件（$7$ 个单位的时间后第二个工人将完成他在第二辆车上的工作，但是第三个工人不能接手，因为他仍然在第一辆车上工作）。因此，第二辆车在 $5$ 个单位的时间后才能开始生产。$7$ 个单位的时间后开始生产第三辆汽车。第一辆车在 $8$ 个单位的时间后完成，第二辆车在 $9$ 个单位的时间后完成，第三辆车在 $11$ 个单位的时间后完成。因此总时间是 $11$。\n\n**【数据范围】**\n\n对于 $40\\%$ 的数据，满足 $n,m\\leqslant 1000$。  \n对于所有数据，$1\\leqslant n,m\\leqslant 10^5$，$1\\leqslant t_i,f_j\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T6 TRAKA_**，按照原题数据配置，满分 $160$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7748", "type": "P", "difficulty": 1, "samples": [["1 \n5 \n20 T \n50 T \n80 T \n50 T \n30 T", "5"], ["3 \n5 \n100 T \n100 N \n100 T \n100 T \n100 N", "4"], ["5\n6\n70 T\n50 P\n30 N\n50 T\n30 P\n80 T", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #2] VOLIM", "background": "本游戏改编自克罗地亚电视节目《我爱克罗地亚》中的游戏 _I love my country_。", "description": "有 $8$ 个人坐成一圈，如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/va2c1wan.png)\n\n他们中的某一个人会拿着一个箱子，这个箱子会在比赛开始后 $210$ 秒爆炸。\n\n主持人会问拿箱人问题，拿箱人可以选择以下方式：\n\n- 若跳过或回答错误，主持人会接着问下一个问题。\n- 若回答正确，则拿箱人把箱子传递给他**左手边**第一个人，这个人成为新的拿箱人。\n\n现在你知道对于每个问题，回答该问题的人所用的时间与回答情况。\n\n给定游戏开始时拿箱人的编号与问题的数量，求出箱子爆炸时拿箱人的编号。\n\n箱子传递时间与两个问题之间的时间**忽略不计**，数据保证箱子爆炸时箱子在某个人手上，且问题没有问完。", "inputFormat": "第一行一个整数 $K$，表示游戏开始时拿箱人的编号。\n\n第二行一个整数 $N$，表示问题的数量。\n\n接下来 $N$ 行，每行有一个整数 $T$ 与一个字符，表示回答该问题的人所用的时间与回答情况：\n\n- 该字符为 $\\tt T$，表示回答正确。\n- 该字符为 $\\tt N$，表示回答错误。\n- 该字符为 $\\tt P$，表示跳过。", "outputFormat": "仅一行一个整数，即箱子爆炸时拿箱人的编号。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，有 $1\\le K\\le 8$，$1\\le N,T\\le 100$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T1 VOLIM_。**\n\n按照原题数据配置，本题满分 $50$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #2] VOLIM", "background": "本游戏改编自克罗地亚电视节目《我爱克罗地亚》中的游戏 _I love my country_。", "description": "有 $8$ 个人坐成一圈，如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/va2c1wan.png)\n\n他们中的某一个人会拿着一个箱子，这个箱子会在比赛开始后 $210$ 秒爆炸。\n\n主持人会问拿箱人问题，拿箱人可以选择以下方式：\n\n- 若跳过或回答错误，主持人会接着问下一个问题。\n- 若回答正确，则拿箱人把箱子传递给他**左手边**第一个人，这个人成为新的拿箱人。\n\n现在你知道对于每个问题，回答该问题的人所用的时间与回答情况。\n\n给定游戏开始时拿箱人的编号与问题的数量，求出箱子爆炸时拿箱人的编号。\n\n箱子传递时间与两个问题之间的时间**忽略不计**，数据保证箱子爆炸时箱子在某个人手上，且问题没有问完。", "inputFormat": "第一行一个整数 $K$，表示游戏开始时拿箱人的编号。\n\n第二行一个整数 $N$，表示问题的数量。\n\n接下来 $N$ 行，每行有一个整数 $T$ 与一个字符，表示回答该问题的人所用的时间与回答情况：\n\n- 该字符为 $\\tt T$，表示回答正确。\n- 该字符为 $\\tt N$，表示回答错误。\n- 该字符为 $\\tt P$，表示跳过。", "outputFormat": "仅一行一个整数，即箱子爆炸时拿箱人的编号。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，有 $1\\le K\\le 8$，$1\\le N,T\\le 100$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T1 VOLIM_。**\n\n按照原题数据配置，本题满分 $50$ 分。", "locale": "zh-CN"}}}
{"pid": "P7749", "type": "P", "difficulty": 2, "samples": [["2 3 \n..o \no..", "2"], ["2 2 \noo \noo", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "枚举", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #2] MISA", "background": "", "description": "一个 $R\\times S$ 的方格，每个人坐在一个方格中，可能存在空位。\n\n每个人都会与自己周围的**八个方格**中的人握手（可能不满 $8$ 人）。\n\nMirko 是最晚到场的，他按照如下的方式就坐：\n\n- 若有空位，他会坐在一个能使他能与最多的人握手的空位上。\n- 若没有空位，他会离开。\n\n求出 Mirko 就坐后人们的握手次数。", "inputFormat": "第一行两个整数 $R,S$。\n\n接下来一个 $R$ 行 $S$ 列的字符矩阵，描述就坐情况：\n\n- `.` 表示空位。\n- `o` 表示有人入座。", "outputFormat": "仅一行一个整数，即 Mirko 就坐后人们的握手次数。", "hint": "#### 样例 1 说明\n\n```plain\n..o\noo.\n```\n\n是满足要求的一种最终就坐方式。\n\n#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，有 $R=1$。\n- 对于另外 $20\\%$ 的数据，有 $R=2$。\n- 对于另外 $20\\%$ 的数据，座位坐满了。\n- 对于 $100\\%$ 的数据，有 $1\\le R,S\\le 50$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T2 MISA_。**\n\n按照原题数据配置，本题满分 $80$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #2] MISA", "background": "", "description": "一个 $R\\times S$ 的方格，每个人坐在一个方格中，可能存在空位。\n\n每个人都会与自己周围的**八个方格**中的人握手（可能不满 $8$ 人）。\n\nMirko 是最晚到场的，他按照如下的方式就坐：\n\n- 若有空位，他会坐在一个能使他能与最多的人握手的空位上。\n- 若没有空位，他会离开。\n\n求出 Mirko 就坐后人们的握手次数。", "inputFormat": "第一行两个整数 $R,S$。\n\n接下来一个 $R$ 行 $S$ 列的字符矩阵，描述就坐情况：\n\n- `.` 表示空位。\n- `o` 表示有人入座。", "outputFormat": "仅一行一个整数，即 Mirko 就坐后人们的握手次数。", "hint": "#### 样例 1 说明\n\n```plain\n..o\noo.\n```\n\n是满足要求的一种最终就坐方式。\n\n#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，有 $R=1$。\n- 对于另外 $20\\%$ 的数据，有 $R=2$。\n- 对于另外 $20\\%$ 的数据，座位坐满了。\n- 对于 $100\\%$ 的数据，有 $1\\le R,S\\le 50$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T2 MISA_。**\n\n按照原题数据配置，本题满分 $80$ 分。", "locale": "zh-CN"}}}
{"pid": "P7750", "type": "P", "difficulty": 2, "samples": [["4 \nacefdb", "abcdef"], ["1000 \naaaaaa", "aaaaaa"], ["11 \nsrama", "sarma"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #2] SLOM", "background": "", "description": "Martin 眼睛出问题了。\n\n对于一个单词，他每次眨眼，在他眼中这个单词的字母便会发生如下的变化（下述「倒数第 $k$ 个」「第 $k$ 个」等都是对于**变化前**的单词而言的）：\n\n- 最后一个字母移动到第 $1,2$ 个字母之间。\n- 倒数第二个字母移动到第 $2,3$ 个字母之间。\n- $\\ldots\\ \\ldots$\n- 倒数第 $k$ 个字母移动到第 $k,k+1$ 个字母之间。\n\n例如，单词 $\\tt abcdef$ 在他眨眼后会变成 $\\tt afbecd$。\n\n如果 Martin 再次眨眼后，相同的事情仍会发生。\n\n给定 Martin 眨眼的次数 $X$ 和他看到的单词 $s$，求出原本的单词。", "inputFormat": "第一行一个整数 $X$，表示 Martin 眨眼的次数。\n\n第二行一个字符串 $s$，表示 Martin 看到的单词。", "outputFormat": "仅一行一个字符串，即原本的单词。", "hint": "#### 样例 1 说明\n\n变化过程为：$\\tt abcdef\\to afbecd\\to adfcbe\\to aedbfc\\to acefdb$。\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，有 $1\\le X\\le 100$。\n- 对于 $100\\%$ 的数据，有 $1\\le X\\le 10^9$，$3\\le |s|\\le 10^3$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T3 SLOM_。**\n\n按照原题数据配置，本题满分 $100$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #2] SLOM", "background": "", "description": "Martin 眼睛出问题了。\n\n对于一个单词，他每次眨眼，在他眼中这个单词的字母便会发生如下的变化（下述「倒数第 $k$ 个」「第 $k$ 个」等都是对于**变化前**的单词而言的）：\n\n- 最后一个字母移动到第 $1,2$ 个字母之间。\n- 倒数第二个字母移动到第 $2,3$ 个字母之间。\n- $\\ldots\\ \\ldots$\n- 倒数第 $k$ 个字母移动到第 $k,k+1$ 个字母之间。\n\n例如，单词 $\\tt abcdef$ 在他眨眼后会变成 $\\tt afbecd$。\n\n如果 Martin 再次眨眼后，相同的事情仍会发生。\n\n给定 Martin 眨眼的次数 $X$ 和他看到的单词 $s$，求出原本的单词。", "inputFormat": "第一行一个整数 $X$，表示 Martin 眨眼的次数。\n\n第二行一个字符串 $s$，表示 Martin 看到的单词。", "outputFormat": "仅一行一个字符串，即原本的单词。", "hint": "#### 样例 1 说明\n\n变化过程为：$\\tt abcdef\\to afbecd\\to adfcbe\\to aedbfc\\to acefdb$。\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，有 $1\\le X\\le 100$。\n- 对于 $100\\%$ 的数据，有 $1\\le X\\le 10^9$，$3\\le |s|\\le 10^3$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T3 SLOM_。**\n\n按照原题数据配置，本题满分 $100$ 分。", "locale": "zh-CN"}}}
{"pid": "P7751", "type": "P", "difficulty": 3, "samples": [["3 \n0 5 2 \n5 0 4 \n2 4 0", "7"], ["4 \n0 15 7 8 \n15 0 16 9 \n7 16 0 12 \n8 9 12 0", "31"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #2] PUTNIK", "background": "", "description": "销售员 Sept 有一个任务，即游览 $N$ 座城市（从 $1$ 到 $N$ 编号），每座城市只能游览**恰好一次**。\n\n这 $N$ 座城市中，每两座之间都有一列航班。Sept 追求效率，所以他希望在飞行上消耗的时间最少。为此，他可以调整这些城市的游览顺序。\n\n但 Sept 对这个游览顺序有一个奇怪的要求：\n\n- 对于城市 $1$ 没有要求。\n- 如果要游览城市 $K(K\\in[2,N])$，则所有编号小于 $K$ 的城市，要么都在游览城市 $K$ 前游览完，要么都在游览城市 $K$ 后游览完。\\\n  换句话说，对于两个城市 $X,Y(1\\le X,Y< K)$，不能在城市 $K$ 前游览城市 $X$ 而在城市 $K$ 后游览城市 $Y$。\n\n在这些限制下，给定每两座城市之间乘坐航班所需的时间，求出 Sept 在飞行上消耗的最少时间。", "inputFormat": "第一行一个整数 $N$，即城市的数量。\n\n接下来 $N$ 行 $N$ 列整数。我们令 $(A,B)$ 表示第 $A$ 行的第 $B$ 个数，则有\n\n- $(A,B)$ 表示城市 $A,B$ 之间乘坐航班所需的时间。\n- 若 $A=B$，$(A,B)=0$。\n- $(A,B)=(B,A)$。", "outputFormat": "仅一行一个整数，即 Sept 在飞行上消耗的最少时间。", "hint": "#### 样例 1 说明\n\n顺序 $\\tt2,1,3$ 或 $\\tt3,1,2$ 都是可以的。\n\n注意到 $\\tt1,3,2$ 用时更短，但不符合 Sept 的奇怪要求。\n\n#### 样例 2 说明\n\n顺序 $\\tt3,1,2,4$ 或 $\\tt4,2,1,3$ 都是可以的。\n\n#### 数据规模与约定\n\n**本题不采用捆绑测试，在评测中也不会体现 Subtask。**\n\n- Subtask 1 $\\tt(40pts)$：$2\\le N\\le 10$。\n- Subtask 2 $\\tt(20pts)$：$2\\le N\\le 20$。\n- Subtask 3 $\\tt(60pts)$：无特殊限制。\n\n对于 $100\\%$ 的数据，有 $2\\le N\\le 1500$，$0\\le (A,B)\\le 10^3$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T4 PUTNIK_。**\n\n按照原题数据配置，本题满分 $120$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #2] PUTNIK", "background": "", "description": "销售员 Sept 有一个任务，即游览 $N$ 座城市（从 $1$ 到 $N$ 编号），每座城市只能游览**恰好一次**。\n\n这 $N$ 座城市中，每两座之间都有一列航班。Sept 追求效率，所以他希望在飞行上消耗的时间最少。为此，他可以调整这些城市的游览顺序。\n\n但 Sept 对这个游览顺序有一个奇怪的要求：\n\n- 对于城市 $1$ 没有要求。\n- 如果要游览城市 $K(K\\in[2,N])$，则所有编号小于 $K$ 的城市，要么都在游览城市 $K$ 前游览完，要么都在游览城市 $K$ 后游览完。\\\n  换句话说，对于两个城市 $X,Y(1\\le X,Y< K)$，不能在城市 $K$ 前游览城市 $X$ 而在城市 $K$ 后游览城市 $Y$。\n\n在这些限制下，给定每两座城市之间乘坐航班所需的时间，求出 Sept 在飞行上消耗的最少时间。", "inputFormat": "第一行一个整数 $N$，即城市的数量。\n\n接下来 $N$ 行 $N$ 列整数。我们令 $(A,B)$ 表示第 $A$ 行的第 $B$ 个数，则有\n\n- $(A,B)$ 表示城市 $A,B$ 之间乘坐航班所需的时间。\n- 若 $A=B$，$(A,B)=0$。\n- $(A,B)=(B,A)$。", "outputFormat": "仅一行一个整数，即 Sept 在飞行上消耗的最少时间。", "hint": "#### 样例 1 说明\n\n顺序 $\\tt2,1,3$ 或 $\\tt3,1,2$ 都是可以的。\n\n注意到 $\\tt1,3,2$ 用时更短，但不符合 Sept 的奇怪要求。\n\n#### 样例 2 说明\n\n顺序 $\\tt3,1,2,4$ 或 $\\tt4,2,1,3$ 都是可以的。\n\n#### 数据规模与约定\n\n**本题不采用捆绑测试，在评测中也不会体现 Subtask。**\n\n- Subtask 1 $\\tt(40pts)$：$2\\le N\\le 10$。\n- Subtask 2 $\\tt(20pts)$：$2\\le N\\le 20$。\n- Subtask 3 $\\tt(60pts)$：无特殊限制。\n\n对于 $100\\%$ 的数据，有 $2\\le N\\le 1500$，$0\\le (A,B)\\le 10^3$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T4 PUTNIK_。**\n\n按照原题数据配置，本题满分 $120$ 分。", "locale": "zh-CN"}}}
{"pid": "P7752", "type": "P", "difficulty": 5, "samples": [["2 3\n2 1", "6"], ["3 4\n2 3 1", "24"], ["3 4\n2 1 1", "36"], ["3 4\n1 1 2", "36"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #2] PALETA", "background": "", "description": "Mirko 有 $k$ 种颜色和 $n$ 个图像需要上色。图像编号从 $1$ 到 $n$，他决定用 $k$ 种颜色中的一种来填充每个图像。\n\n为此，他选择了 $n$ 个数字 $f_i$，并决定按照如下方法涂色：\n\n- 若 $f_i\\ne i$，则图像 $i$ 与图像 $f_i$ 的颜色不应该相同。\n- 若 $f_i=i$，他可以在满足所有其他条件的基础上，将图像 $f_i$ 涂成任何颜色。\n\n你需要求出上色的可能方法的数量。\n\n**由于输出可能非常大，你只需要输出答案对 $\\bm{10^9+7}$ 取模后的结果。**", "inputFormat": "第一行两个整数 $n,k$，表示图像的数量与颜色的数量。\n\n接下来 $n$ 行，即 $f_i$。", "outputFormat": "仅一行一个整数，即给书着色的可能方法的数量对 $10^9+7$ 取模后的结果。", "hint": "#### 样例 1 说明\n\n共有 $3$ 种颜色，并且图像 2 的颜色不能与图像 1 相同。可能的上色方案为 $(1, 2), (1, 3), (2, 1), (2, 3), (3, 1), (3, 2)$，其中括号中两个数字分别表示两个图像的颜色。\n\n#### 样例 4 说明\n\n共有 $4$ 种颜色。\n\n- 对于图像 1，可以涂成任何颜色。\n- 对于图像 2，颜色不能与图像 1 相同。\n- 对于图像 3，颜色不能与图像 2 相同。\n\n即图像 2 可以用除了图象 1 外的 $3$ 种颜色着色，图像 3 可以用除了图象 2 外的 $3$ 种颜色着色。\n\n答案为 $4\\times 3\\times 3=36$。\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，有 $f_i\\ne f_j(1\\le i\\ne j\\le n)$。\n- 对于 $100\\%$ 的数据，有 $1\\le n,k\\le 10^6$。\n\n对于所有合法的 $f_i$，有 $1\\le f_i\\le n$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T5 PALETA_。**\n\n按照原题数据配置，本题满分 $140$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #2] PALETA", "background": "", "description": "Mirko 有 $k$ 种颜色和 $n$ 个图像需要上色。图像编号从 $1$ 到 $n$，他决定用 $k$ 种颜色中的一种来填充每个图像。\n\n为此，他选择了 $n$ 个数字 $f_i$，并决定按照如下方法涂色：\n\n- 若 $f_i\\ne i$，则图像 $i$ 与图像 $f_i$ 的颜色不应该相同。\n- 若 $f_i=i$，他可以在满足所有其他条件的基础上，将图像 $f_i$ 涂成任何颜色。\n\n你需要求出上色的可能方法的数量。\n\n**由于输出可能非常大，你只需要输出答案对 $\\bm{10^9+7}$ 取模后的结果。**", "inputFormat": "第一行两个整数 $n,k$，表示图像的数量与颜色的数量。\n\n接下来 $n$ 行，即 $f_i$。", "outputFormat": "仅一行一个整数，即给书着色的可能方法的数量对 $10^9+7$ 取模后的结果。", "hint": "#### 样例 1 说明\n\n共有 $3$ 种颜色，并且图像 2 的颜色不能与图像 1 相同。可能的上色方案为 $(1, 2), (1, 3), (2, 1), (2, 3), (3, 1), (3, 2)$，其中括号中两个数字分别表示两个图像的颜色。\n\n#### 样例 4 说明\n\n共有 $4$ 种颜色。\n\n- 对于图像 1，可以涂成任何颜色。\n- 对于图像 2，颜色不能与图像 1 相同。\n- 对于图像 3，颜色不能与图像 2 相同。\n\n即图像 2 可以用除了图象 1 外的 $3$ 种颜色着色，图像 3 可以用除了图象 2 外的 $3$ 种颜色着色。\n\n答案为 $4\\times 3\\times 3=36$。\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，有 $f_i\\ne f_j(1\\le i\\ne j\\le n)$。\n- 对于 $100\\%$ 的数据，有 $1\\le n,k\\le 10^6$。\n\n对于所有合法的 $f_i$，有 $1\\le f_i\\le n$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T5 PALETA_。**\n\n按照原题数据配置，本题满分 $140$ 分。", "locale": "zh-CN"}}}
{"pid": "P7753", "type": "P", "difficulty": 5, "samples": [["3 \n1 1 \n1 2 \n1 3", "Mirko"], ["4 \n1 1 \n1 2 \n2 1 \n2 2", "Slavko"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2013", "二分图", "COCI（克罗地亚）"], "title": "[COCI 2013/2014 #2] LINIJE", "background": "Mirko 和他忠实的朋友 Slavko 有一天真的很无聊，于是他们创造了一个新游戏。", "description": "在游戏开始时，他们在一个坐标系中绘制 $N$ 个点。\n\n玩家轮流操作，Mirko 先操作。他画一条平行于坐标系的一个轴的直线 $l_1$，并通过 $N$ 个点之一。\n\n在第 $i(i\\ge2)$ 次操作中，玩家画一条直线 $l_i$，该直线平行于坐标系的一个轴，并通过位于 $l_{i-1}$ 的 $N$ 个点之一。\n\n**不能画两条重合的直线。**\n\n失败者是不能继续操作的玩家。\n\n给定这 $N$ 个点的坐标，确定谁有必胜策略。", "inputFormat": "第一行一个整数 $N$，表示点的数量。\n\n接下来 $N$ 行，每行两个整数 $X,Y$，表示该点的坐标。", "outputFormat": "仅一行一个字符串，即有必胜策略的人的名字，$\\tt Mirko$ 或是 $\\tt Slavko$。", "hint": "#### 样例 1 说明\n\n- 如果 Mirko 画线 $y=1$ 经过点 $(1,1)$，Slavko 必须画 $x=1$ 经过 $(1,1)$，此外，该直线还同时经过 $(1,2)$。\n- 然后 Mirko 画线 $y=2$ 经过 $(1,2)$，Slavko 剩下的唯一一步是再次画 $x=1$，这是不允许的。\n- Mirko 必胜。\n\n#### 数据规模与约定\n\n**为了方便判分，本题判分方法比较特殊。**\n\n本题共 $40$ 个测试点，\n\n- 其中 $16$ 个测试点满足 $1\\le N\\le 10$。\n- 其他 $24$ 个测试点无特殊限制。\n- 前 $20$ 个测试点一个 $4$ 分。\n- 后 $20$ 个测试点一个 $8$ 分。\n\n对于 $100\\%$ 的数据，有 $1\\le N\\le 10^4$，$1\\le X,Y\\le 500$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T6 LINIJE_。**\n\n按照原题数据配置，本题满分 $160$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2013/2014 #2] LINIJE", "background": "Mirko 和他忠实的朋友 Slavko 有一天真的很无聊，于是他们创造了一个新游戏。", "description": "在游戏开始时，他们在一个坐标系中绘制 $N$ 个点。\n\n玩家轮流操作，Mirko 先操作。他画一条平行于坐标系的一个轴的直线 $l_1$，并通过 $N$ 个点之一。\n\n在第 $i(i\\ge2)$ 次操作中，玩家画一条直线 $l_i$，该直线平行于坐标系的一个轴，并通过位于 $l_{i-1}$ 的 $N$ 个点之一。\n\n**不能画两条重合的直线。**\n\n失败者是不能继续操作的玩家。\n\n给定这 $N$ 个点的坐标，确定谁有必胜策略。", "inputFormat": "第一行一个整数 $N$，表示点的数量。\n\n接下来 $N$ 行，每行两个整数 $X,Y$，表示该点的坐标。", "outputFormat": "仅一行一个字符串，即有必胜策略的人的名字，$\\tt Mirko$ 或是 $\\tt Slavko$。", "hint": "#### 样例 1 说明\n\n- 如果 Mirko 画线 $y=1$ 经过点 $(1,1)$，Slavko 必须画 $x=1$ 经过 $(1,1)$，此外，该直线还同时经过 $(1,2)$。\n- 然后 Mirko 画线 $y=2$ 经过 $(1,2)$，Slavko 剩下的唯一一步是再次画 $x=1$，这是不允许的。\n- Mirko 必胜。\n\n#### 数据规模与约定\n\n**为了方便判分，本题判分方法比较特殊。**\n\n本题共 $40$ 个测试点，\n\n- 其中 $16$ 个测试点满足 $1\\le N\\le 10$。\n- 其他 $24$ 个测试点无特殊限制。\n- 前 $20$ 个测试点一个 $4$ 分。\n- 后 $20$ 个测试点一个 $8$ 分。\n\n对于 $100\\%$ 的数据，有 $1\\le N\\le 10^4$，$1\\le X,Y\\le 500$。\n\n#### 来源\n\n**本题译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST 2](https://hsin.hr/coci/archive/2013_2014/contest2_tasks.pdf) _T6 LINIJE_。**\n\n按照原题数据配置，本题满分 $160$ 分。", "locale": "zh-CN"}}}
{"pid": "P7754", "type": "P", "difficulty": 1, "samples": [["2 4\n2 2", "XX..XX..\nXX..XX..\n..XX..XX\n..XX..XX"], ["5 5\n2 3", "XXX...XXX...XXX\nXXX...XXX...XXX\n...XXX...XXX...\n...XXX...XXX...\nXXX...XXX...XXX\nXXX...XXX...XXX\n...XXX...XXX...\n...XXX...XXX...\nXXX...XXX...XXX\nXXX...XXX...XXX"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #3] SAHOVNICA", "background": "Mirko 已经成为一个铁杆爱国者，所以他要求你给他画一个克罗地亚棋盘。", "description": "棋盘由红色格子和白色格子组成。棋盘左上角的格子是红色。其余的格子在棋盘中交替显示成白色和红色。我们在本题中用 `X` 表示红色区域，用 `.` 表示白色区域。Mirko 的棋盘应该由 $r\\times c$ 的格子组成，并且每个格子是由字符 `X` 和 `.` 组成的 $a\\times b$ 的字符矩阵。请你帮助他画出这个棋盘。", "inputFormat": "输入共两行。\n\n第一行两个整数 $r,c$，分别表示棋盘的行数和列数。  \n第二行两个整数 $a,b$，分别表示每个格子中的字符矩阵行数和列数。", "outputFormat": "输出共 $r\\times a$ 行，每行 $c\\times b$ 个字符，描述最终画出来的棋盘。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant r,c,a,b\\leqslant 10$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T1 SAHOVNICA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #3] SAHOVNICA", "background": "Mirko 已经成为一个铁杆爱国者，所以他要求你给他画一个克罗地亚棋盘。", "description": "棋盘由红色格子和白色格子组成。棋盘左上角的格子是红色。其余的格子在棋盘中交替显示成白色和红色。我们在本题中用 `X` 表示红色区域，用 `.` 表示白色区域。Mirko 的棋盘应该由 $r\\times c$ 的格子组成，并且每个格子是由字符 `X` 和 `.` 组成的 $a\\times b$ 的字符矩阵。请你帮助他画出这个棋盘。", "inputFormat": "输入共两行。\n\n第一行两个整数 $r,c$，分别表示棋盘的行数和列数。  \n第二行两个整数 $a,b$，分别表示每个格子中的字符矩阵行数和列数。", "outputFormat": "输出共 $r\\times a$ 行，每行 $c\\times b$ 个字符，描述最终画出来的棋盘。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant r,c,a,b\\leqslant 10$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T1 SAHOVNICA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7755", "type": "P", "difficulty": 2, "samples": [["3\nalpha beta gamma\nalpha gamma beta", "2/3"], ["5\nnaboo geonosis yavin hoth endor\ngeonosis yavin hoth endor naboo", "6/10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #3] POREDAK", "background": "Mirko-wan 刚刚收到历史考试的成绩。其中一个问题是把著名的历史事件按时间顺序排列。正确的顺序是：\n\n1. _Blockade of Naboo_\n2. _Battle of Geonosis_\n3. _Battle of Yavin_\n4. _Battle of Hoth_\n5. _Battle of Endor_\n\nMirko-wan 相对地用功备考，所以除了 _Blockade of Naboo_ 外，他记得所有事件的确切年份。他对于 _Blockade of Naboo_ 什么都不记得了，所以他随机把它放在最后而不是第一个，得到的顺序是：\n\n1. _Battle of Geonosis_\n2. _Battle of Yavin_\n3. _Battle of Hoth_\n4. _Battle of Endor_\n5. _Blockade of Naboo_\n\n由于 Mirko-wan 的顺序在任何指标上都不符合正确的解决方案，尽管他知道五分之四的正确顺序，但令他失望的是，他在这个问题上的得分是 $5$ 分中的 $0$ 分！这就引出了公平评分问题。", "description": "上面给出的例子表明，通过计算正确绝对位置的项目数来得分是不公平的。有更好的方法吗？一种可能是找到正确排序的项目的最长子序列（不一定是连续的）。这也不是最好的解决方案：如果一个项目从正确的顺序中只被替换了一个位置，那么尽管排序几乎正确，它的分数就会降到零。Mirko-wan 因此向他的历史老师建议以下评分方法：\n\n对于 $n$ 个条目中的每两个条目，如果两个条目的顺序相互正确，学生将得到 $1$ 分。换句话说，分数是学生正确排列的条目对的数目。当然，最大分数是条目对的总数，等于 $\\dfrac{n(n-1)}{2}$。\n\n请你通过这种方法，给定 $n$ 个条目的正确顺序和 Mirko-wan 给出的顺序，求出 Mirko-wan 可以得到的分数。", "inputFormat": "输入共三行。\n\n第一行一个整数 $n$，表示条目的个数。  \n第二行 $n$ 个字符串，表示 $n$ 个条目的正确顺序。  \n第三行 $n$ 个字符串，表示 Mirko-wan 给出的 $n$ 个条目的顺序。", "outputFormat": "输出格式为 `a/b`，其中：\n\n- $a $ 表示 Mirko-wan 按照输入给定顺序和新的计算得分的方式可以得到的分数。\n- $b$ 表示按照新的计算得分的方式最大可以得到的分数。\n\n请注意，在本题中，请**不要对答案进行约分**。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，能够使 Mirko-wan 得到分数的条目对为 $(\\texttt{alpha},\\texttt{beta})$ 和 $(\\texttt{alpha},\\texttt{gamma})$。\n\n**【数据范围】**\n\n对于所有数据，$2\\leqslant n\\leqslant 2500$。字符串的长度在 $[3,15]$ 之间，仅包含小写英文字母且所有条目是互不相同的。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T2 POREDAK_**，按照原题数据配置，满分 $80$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #3] POREDAK", "background": "Mirko-wan 刚刚收到历史考试的成绩。其中一个问题是把著名的历史事件按时间顺序排列。正确的顺序是：\n\n1. _Blockade of Naboo_\n2. _Battle of Geonosis_\n3. _Battle of Yavin_\n4. _Battle of Hoth_\n5. _Battle of Endor_\n\nMirko-wan 相对地用功备考，所以除了 _Blockade of Naboo_ 外，他记得所有事件的确切年份。他对于 _Blockade of Naboo_ 什么都不记得了，所以他随机把它放在最后而不是第一个，得到的顺序是：\n\n1. _Battle of Geonosis_\n2. _Battle of Yavin_\n3. _Battle of Hoth_\n4. _Battle of Endor_\n5. _Blockade of Naboo_\n\n由于 Mirko-wan 的顺序在任何指标上都不符合正确的解决方案，尽管他知道五分之四的正确顺序，但令他失望的是，他在这个问题上的得分是 $5$ 分中的 $0$ 分！这就引出了公平评分问题。", "description": "上面给出的例子表明，通过计算正确绝对位置的项目数来得分是不公平的。有更好的方法吗？一种可能是找到正确排序的项目的最长子序列（不一定是连续的）。这也不是最好的解决方案：如果一个项目从正确的顺序中只被替换了一个位置，那么尽管排序几乎正确，它的分数就会降到零。Mirko-wan 因此向他的历史老师建议以下评分方法：\n\n对于 $n$ 个条目中的每两个条目，如果两个条目的顺序相互正确，学生将得到 $1$ 分。换句话说，分数是学生正确排列的条目对的数目。当然，最大分数是条目对的总数，等于 $\\dfrac{n(n-1)}{2}$。\n\n请你通过这种方法，给定 $n$ 个条目的正确顺序和 Mirko-wan 给出的顺序，求出 Mirko-wan 可以得到的分数。", "inputFormat": "输入共三行。\n\n第一行一个整数 $n$，表示条目的个数。  \n第二行 $n$ 个字符串，表示 $n$ 个条目的正确顺序。  \n第三行 $n$ 个字符串，表示 Mirko-wan 给出的 $n$ 个条目的顺序。", "outputFormat": "输出格式为 `a/b`，其中：\n\n- $a $ 表示 Mirko-wan 按照输入给定顺序和新的计算得分的方式可以得到的分数。\n- $b$ 表示按照新的计算得分的方式最大可以得到的分数。\n\n请注意，在本题中，请**不要对答案进行约分**。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，能够使 Mirko-wan 得到分数的条目对为 $(\\texttt{alpha},\\texttt{beta})$ 和 $(\\texttt{alpha},\\texttt{gamma})$。\n\n**【数据范围】**\n\n对于所有数据，$2\\leqslant n\\leqslant 2500$。字符串的长度在 $[3,15]$ 之间，仅包含小写英文字母且所有条目是互不相同的。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T2 POREDAK_**，按照原题数据配置，满分 $80$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7756", "type": "P", "difficulty": 2, "samples": [["4 2\nIVA\nIVO\nANA\nTOM", "5"], ["6 3\nCYNTHIA\nLLOYD\nSTEVIE\nKEVIN\nMALCOLM\nDABNEY", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "前缀和", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #3] MALCOLM", "background": "自从 Herkabe 老师开始对他的学生进行排名以来，他班上的朋友对数急剧下降。排名靠后的学生已经开始嫉妒排名靠前的学生，而排名靠前的学生则开始看不起那些排名靠后的学生。", "description": "根据 Malcolm 的观察，班上一共有 $n$ 名学生。如果两个学生的排名**最多相差 $k$**，那么他们就是**朋友**。如果有两个学生是**朋友**并且它们的名字长度相等，那么他们就是**好朋友**。\n\n现在给定这个班上 $n$ 名学生的名字及排名，求这个班上一共有多少对**好朋友**。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行，两个整数 $n,k$，分别表示班上的学生人数和朋友的排名之间最多相差的名次。  \n随后 $n$ 行，第 $i+1$ 行一个字符串，表示在班上排第 $i$ 名的学生的名字。", "outputFormat": "输出仅一行一个整数，表示班上**好朋友**的对数。", "hint": "**【数据范围】**\n\n对于所有数据，$3\\leqslant n\\leqslant 3\\times 10^5$，$1\\leqslant k\\leqslant n$，字符串的长度在 $[2,20]$ 之间且仅包含大写英文字母。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T3 MALCOLM_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #3] MALCOLM", "background": "自从 Herkabe 老师开始对他的学生进行排名以来，他班上的朋友对数急剧下降。排名靠后的学生已经开始嫉妒排名靠前的学生，而排名靠前的学生则开始看不起那些排名靠后的学生。", "description": "根据 Malcolm 的观察，班上一共有 $n$ 名学生。如果两个学生的排名**最多相差 $k$**，那么他们就是**朋友**。如果有两个学生是**朋友**并且它们的名字长度相等，那么他们就是**好朋友**。\n\n现在给定这个班上 $n$ 名学生的名字及排名，求这个班上一共有多少对**好朋友**。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行，两个整数 $n,k$，分别表示班上的学生人数和朋友的排名之间最多相差的名次。  \n随后 $n$ 行，第 $i+1$ 行一个字符串，表示在班上排第 $i$ 名的学生的名字。", "outputFormat": "输出仅一行一个整数，表示班上**好朋友**的对数。", "hint": "**【数据范围】**\n\n对于所有数据，$3\\leqslant n\\leqslant 3\\times 10^5$，$1\\leqslant k\\leqslant n$，字符串的长度在 $[2,20]$ 之间且仅包含大写英文字母。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T3 MALCOLM_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7757", "type": "P", "difficulty": 2, "samples": [["2 6\n7\n10", "28"], ["7 10\n3\n8\n3\n6\n9\n2\n4", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #3] AERODROM", "background": "", "description": "由 $m$ 人组成的某国代表团正前往澳大利亚参加 2013 年的 IOI。他们目前正在机场排队等候办理登机手续。有 $n$ 个办理登机手续的服务台开放。一些官员的工作效率比其他官员高，所以服务台的运作速度不同。在第 $k$ 个服务台，完成一名乘客的登机手续需要 $t_k$ 秒，而我们的代表团成员恰好知道确切的数字。在开始时，所有的服务都做好接受下一名乘客的准备，而现在只允许我们的代表团成员排队。一个人只有在所有排在他前面的人都已经离开队列（**开始办理登机手续，不一定要完成**）时，才能占据一个可用的服务台开始办理登机手续。这时，这个人可以立即占据一张空闲的服务台（如果有的话），但也可以选择等待另一个办理登记手续更快的服务台变成空闲。\n\n我们的代表团成员是计算机科学怪才，他们决定让他们所有人都尽快完成签到，你的任务是找到完成签到所需要花费的最短时间。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行两个整数 $n,m$，分别表示服务台的个数和代表团的人数。  \n随后 $n$ 行，每行一个整数 $t_k$，表示第 $k$ 个服务台办理一名乘客的登记手续需要花费的时间。", "outputFormat": "输出仅一行一个整数，表示完成签到所需要花费的最短时间（单位为秒）。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，有两个服务台，处理时间分别为 $7$ 秒和 $10$ 秒。在代表团的六个人中，前两个人立即占据了这两个服务台。在第 $7$ 秒，第一张桌子变成空闲，第三个人占据了它。在第 $10$ 秒，第四个人占据了第二个服务台。在第 $14$ 秒，第五个人占据了第一个服务台。在第 $20$ 秒，第二张桌子再次变成空闲，但第六个人决定再等一秒钟（至第 $21$ 秒），让第一张桌子空出来，然后占据它。这样一来，签到只要花费 $28$ 秒就能完成了。如果第六个人没有等待更快的服务台，签到将花费 $30$ 秒。\n\n**【数据范围】**\n\n本题一共 $8$ 个测试点。各个测试点的数据范围如下表所示：\n\n| 测试点编号 | $n\\leqslant$ | $m\\leqslant$ | $t_k\\leqslant $ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1\\sim 5$ | $10^5$ | $3\\times 10^5$ | $10^9$ |\n| $6\\sim 8$ | $10^5$ | $10^9$ | $10^9$ |\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T4 AERODROM_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #3] AERODROM", "background": "", "description": "由 $m$ 人组成的某国代表团正前往澳大利亚参加 2013 年的 IOI。他们目前正在机场排队等候办理登机手续。有 $n$ 个办理登机手续的服务台开放。一些官员的工作效率比其他官员高，所以服务台的运作速度不同。在第 $k$ 个服务台，完成一名乘客的登机手续需要 $t_k$ 秒，而我们的代表团成员恰好知道确切的数字。在开始时，所有的服务都做好接受下一名乘客的准备，而现在只允许我们的代表团成员排队。一个人只有在所有排在他前面的人都已经离开队列（**开始办理登机手续，不一定要完成**）时，才能占据一个可用的服务台开始办理登机手续。这时，这个人可以立即占据一张空闲的服务台（如果有的话），但也可以选择等待另一个办理登记手续更快的服务台变成空闲。\n\n我们的代表团成员是计算机科学怪才，他们决定让他们所有人都尽快完成签到，你的任务是找到完成签到所需要花费的最短时间。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行两个整数 $n,m$，分别表示服务台的个数和代表团的人数。  \n随后 $n$ 行，每行一个整数 $t_k$，表示第 $k$ 个服务台办理一名乘客的登记手续需要花费的时间。", "outputFormat": "输出仅一行一个整数，表示完成签到所需要花费的最短时间（单位为秒）。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，有两个服务台，处理时间分别为 $7$ 秒和 $10$ 秒。在代表团的六个人中，前两个人立即占据了这两个服务台。在第 $7$ 秒，第一张桌子变成空闲，第三个人占据了它。在第 $10$ 秒，第四个人占据了第二个服务台。在第 $14$ 秒，第五个人占据了第一个服务台。在第 $20$ 秒，第二张桌子再次变成空闲，但第六个人决定再等一秒钟（至第 $21$ 秒），让第一张桌子空出来，然后占据它。这样一来，签到只要花费 $28$ 秒就能完成了。如果第六个人没有等待更快的服务台，签到将花费 $30$ 秒。\n\n**【数据范围】**\n\n本题一共 $8$ 个测试点。各个测试点的数据范围如下表所示：\n\n| 测试点编号 | $n\\leqslant$ | $m\\leqslant$ | $t_k\\leqslant $ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1\\sim 5$ | $10^5$ | $3\\times 10^5$ | $10^9$ |\n| $6\\sim 8$ | $10^5$ | $10^9$ | $10^9$ |\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T4 AERODROM_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7758", "type": "P", "difficulty": 5, "samples": [["3\nIVO\nJASNA\nJOSIPA", "4"], ["5\nMARICA\nMARTA\nMATO\nMARA\nMARTINA", "24"], ["4\nA\nAA\nAAA\nAAAA", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #3] HERKABE", "background": "Herkabe 老师决定再次对他的学生进行排名。", "description": "这一次，Herkabe 老师希望他的排行榜在审美上也是令人愉快的，所以他决定有相同前缀的名字必须在名单上彼此相邻。因此，他制定了一个规定：**对于名单上每两个有相同前缀的名字，在排行榜上他们之间的所有名字也应当有这一个前缀**。\n\n现在，给定 $n$ 个学生的名字，求 Herkabe 老师能制作出多少个不同的排行榜以满足上述规则。由于结果可能很大，你只需要输出这个答案对 $10^9+7$ 取模的结果。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行一个整数 $n$，表示学生的个数。  \n随后 $n$ 行，每行一个字符串，表示每个学生的名字。", "outputFormat": "输出仅一行，表示 Herkabe 老师能制作出不同的排行榜的个数模 $10^9+7$ 的值。", "hint": "**【数据范围】**\n\n本题一共 $7$ 个测试点，各个测试点的数据范围如下表所示：\n\n| 测试点编号 | $n\\leqslant$ |\n| :-----------: | :-----------: |\n| $1\\sim 3$ | $10$ |\n| $4\\sim 7$ | $3000$ |\n\n对于所有数据，字符串的长度在 $[1,3000]$ 之间，仅包含大写英文字母且保证互不相同。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T5 HERKABE_**，按照原题数据配置，满分 $140$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #3] HERKABE", "background": "Herkabe 老师决定再次对他的学生进行排名。", "description": "这一次，Herkabe 老师希望他的排行榜在审美上也是令人愉快的，所以他决定有相同前缀的名字必须在名单上彼此相邻。因此，他制定了一个规定：**对于名单上每两个有相同前缀的名字，在排行榜上他们之间的所有名字也应当有这一个前缀**。\n\n现在，给定 $n$ 个学生的名字，求 Herkabe 老师能制作出多少个不同的排行榜以满足上述规则。由于结果可能很大，你只需要输出这个答案对 $10^9+7$ 取模的结果。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行一个整数 $n$，表示学生的个数。  \n随后 $n$ 行，每行一个字符串，表示每个学生的名字。", "outputFormat": "输出仅一行，表示 Herkabe 老师能制作出不同的排行榜的个数模 $10^9+7$ 的值。", "hint": "**【数据范围】**\n\n本题一共 $7$ 个测试点，各个测试点的数据范围如下表所示：\n\n| 测试点编号 | $n\\leqslant$ |\n| :-----------: | :-----------: |\n| $1\\sim 3$ | $10$ |\n| $4\\sim 7$ | $3000$ |\n\n对于所有数据，字符串的长度在 $[1,3000]$ 之间，仅包含大写英文字母且保证互不相同。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T5 HERKABE_**，按照原题数据配置，满分 $140$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7759", "type": "P", "difficulty": 4, "samples": [["3 3\n2 1 2\n1\n2 1 3\n2\n2 2 3\n3", "0 1 2"], ["4 6\n2 4 2\n3\n2 4 1\n6\n1 3 1\n2 3 1\n2\n1 2 2\n2 2 3\n7\n", "5 0 14 3"], ["5 6\n2 4 2\n10\n2 5 3\n2\n2 2 3\n1\n2 1 4\n3\n1 3 1\n2 3 4\n2147483663", "15 6 7 12 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2012", "COCI（克罗地亚）"], "title": "[COCI 2012/2013 #3] PROCESOR", "background": "", "description": "Mirko 收到了一份有趣的作业：设计一个他自己的小处理器。这个处理器有编号从 $1$ 到 $n$ 的 $n$ 个寄存器，每一个寄存器上面以二进制形式保存一个无符号的 $32$ 位整数（可能的数值在 $[0,2^{32}-1]$ 之间）。\n\n除此以外，这个处理器还要求完成以下两种操作：\n\n- `1 k m`： 将寄存器 $k$ 上的数的二进制表示的后 $m$ 位整体提到最前面，然后将得到的新数字重新写入寄存器 $k$。例如：  \n$$\\begin{aligned}&00000000000000000010001111111011\\\\\\xrightarrow{m=10}&11111110110000000000000000001000\\end{aligned}$$\n- `2 k l`：计算寄存器 $k$ 上的数和寄存器 $l$ 上的数异或的结果并将结果输出到系统上。例如：  \n$$\\begin{aligned}&00000000000000000000001111000111\\\\ \\underline{\\text{XOR }} &  \\underline{00000000000001111100000000000111}\\\\ \\text{= }&00000000000001111100001111000000\\end{aligned}$$\n\nMirko 直到他建立了这个处理器模型才意识到他忘记实现一个读取寄存器内容的操作。因此，他现在唯一能做的就是大量执行操作 $1$ 和操作 $2$，并从结果中推断寄存器内容。在执行了一系列命令之后，他要求您帮助他推导出与获得的结果一致的初始寄存器内容的组合。\n\n如果初始寄存器状态组合有多种可能，则你需要求**按字典顺序排列的最小值的组合**（如果两个组合在前 $k–1$ 个寄存器中具有相等的值，而在寄存器 $k$ 中具有不同的值，则按字典顺序排列的较小组合就是在寄存器 $k$ 中具有较小值的组合）。", "inputFormat": "输入共若干行。\n\n第一行，两个整数 $n,e$，分别表示寄存器总数和操作次数。  \n接下来若干行用来描述每一个操作。对于一个操作，先输入一行三个整数 $\\textit{op},k,l$，分别表示操作类型和该操作类型的两个参数。如果 $op=2$，则接下来应再输入一行一个整数，表示上一行的操作 $2$ 得到的结果，然后再在下一行进入下一个操作的输入。否则下一行直接进入下一个操作的输入。\n\n如果您不能很好地理解输入格式，请参照样例以对这一部分有更好的理解。", "outputFormat": "如果不存在与输入一致的初始寄存器内容组合，则仅输出一行一个整数 $-1$。否则输出一行 $n$ 个整数，第 $i$ 个整数表示一开始第 $i$ 个寄存器上的数。", "hint": "**【数据范围】**\n\n对于 $40\\%$ 的数据，满足 $n,e\\leqslant 1000$。  \n对于所有数据，$2\\leqslant n\\leqslant 10^5$，$1\\leqslant e\\leqslant 10^5$。且满足：\n- $op=1$ 时，$1\\leqslant k\\leqslant n$，$0\\leqslant l\\leqslant 32$。\n- $op=2$ 时，$1\\leqslant k,l\\leqslant n$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T6 PROCESOR_**，按照原题数据配置，满分 $160$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2012/2013 #3] PROCESOR", "background": "", "description": "Mirko 收到了一份有趣的作业：设计一个他自己的小处理器。这个处理器有编号从 $1$ 到 $n$ 的 $n$ 个寄存器，每一个寄存器上面以二进制形式保存一个无符号的 $32$ 位整数（可能的数值在 $[0,2^{32}-1]$ 之间）。\n\n除此以外，这个处理器还要求完成以下两种操作：\n\n- `1 k m`： 将寄存器 $k$ 上的数的二进制表示的后 $m$ 位整体提到最前面，然后将得到的新数字重新写入寄存器 $k$。例如：  \n$$\\begin{aligned}&00000000000000000010001111111011\\\\\\xrightarrow{m=10}&11111110110000000000000000001000\\end{aligned}$$\n- `2 k l`：计算寄存器 $k$ 上的数和寄存器 $l$ 上的数异或的结果并将结果输出到系统上。例如：  \n$$\\begin{aligned}&00000000000000000000001111000111\\\\ \\underline{\\text{XOR }} &  \\underline{00000000000001111100000000000111}\\\\ \\text{= }&00000000000001111100001111000000\\end{aligned}$$\n\nMirko 直到他建立了这个处理器模型才意识到他忘记实现一个读取寄存器内容的操作。因此，他现在唯一能做的就是大量执行操作 $1$ 和操作 $2$，并从结果中推断寄存器内容。在执行了一系列命令之后，他要求您帮助他推导出与获得的结果一致的初始寄存器内容的组合。\n\n如果初始寄存器状态组合有多种可能，则你需要求**按字典顺序排列的最小值的组合**（如果两个组合在前 $k–1$ 个寄存器中具有相等的值，而在寄存器 $k$ 中具有不同的值，则按字典顺序排列的较小组合就是在寄存器 $k$ 中具有较小值的组合）。", "inputFormat": "输入共若干行。\n\n第一行，两个整数 $n,e$，分别表示寄存器总数和操作次数。  \n接下来若干行用来描述每一个操作。对于一个操作，先输入一行三个整数 $\\textit{op},k,l$，分别表示操作类型和该操作类型的两个参数。如果 $op=2$，则接下来应再输入一行一个整数，表示上一行的操作 $2$ 得到的结果，然后再在下一行进入下一个操作的输入。否则下一行直接进入下一个操作的输入。\n\n如果您不能很好地理解输入格式，请参照样例以对这一部分有更好的理解。", "outputFormat": "如果不存在与输入一致的初始寄存器内容组合，则仅输出一行一个整数 $-1$。否则输出一行 $n$ 个整数，第 $i$ 个整数表示一开始第 $i$ 个寄存器上的数。", "hint": "**【数据范围】**\n\n对于 $40\\%$ 的数据，满足 $n,e\\leqslant 1000$。  \n对于所有数据，$2\\leqslant n\\leqslant 10^5$，$1\\leqslant e\\leqslant 10^5$。且满足：\n- $op=1$ 时，$1\\leqslant k\\leqslant n$，$0\\leqslant l\\leqslant 32$。\n- $op=2$ 时，$1\\leqslant k,l\\leqslant n$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2012-2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST 3](https://hsin.hr/coci/archive/2012_2013/contest3_tasks.pdf) T6 PROCESOR_**，按照原题数据配置，满分 $160$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7760", "type": "P", "difficulty": 1, "samples": [["5\n2\n3 4\n2 1\n5 3\n4 4\n4 2", "19"], ["4\n2\n3 5\n2 8\n4\n6 5\n6 3\n7", "22"], ["3\n10\n20 50\n30\n20 40\n50\n70 20\n10", "90"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #5] TUNA", "background": "", "description": "渔夫在昨晚捕到 $N$ 条金枪鱼。他准备将这些鱼卖给一个平台。\n\n对于每一条鱼，平台会给出两个估测值 $P_1,P_2$。如果这两个值之差不超过 $X$，则取较大的值作为该条鱼的价值；否则如果差超过 $X$，则取另一个值 $P_3$。\n\n现在给定 $N$ 条鱼的值（可能会有 $2$ 个或 $3$ 个），求所有鱼的总价值。", "inputFormat": "第一行，一个整数 $N$，表示金枪鱼的数量。\n\n第二行，一个整数 $X$。\n\n接下来的若干行分为 $N$ 个部分用来表示每条鱼的信息。每部分的格式为下列二者之一：\n\n- 该部分仅有唯一一行，该行包含两个整数 $P_1,P_2$。\n- 该部分共有两行，第一行包含两个整数 $P_1,P_2$，第二行包含一个整数 $P_3$。", "outputFormat": "输出所有鱼的总价值。", "hint": "**【样例 2 解释】**\n\n渔夫捕到了 $4$ 条金枪鱼，而 $X$ 的值为 $2$：\n\n|金枪鱼编号|$p_1$|$p_2$|$p_3$|差值|最终价值|\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n|$1$|$3$|$5$|/|$2 \\le 2$|$5$|\n|$2$|$2$|$8$|$4$|$6 \\gt 2$|$4$|\n|$3$|$6$|$5$|/|$1 \\le 2$|$6$|\n|$4$|$6$|$3$|$7$|$3 \\le 7$|$7$|\n\n故价值总和为 $5+4+6+7=22$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 20$，$1 \\le X \\le 10$，$1 \\le P_1,P_2,P_3 \\le 100$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T1 Tuna_。**\n\n**本题分值按 COCI 原题设置，满分 $50$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #5] TUNA", "background": "", "description": "渔夫在昨晚捕到 $N$ 条金枪鱼。他准备将这些鱼卖给一个平台。\n\n对于每一条鱼，平台会给出两个估测值 $P_1,P_2$。如果这两个值之差不超过 $X$，则取较大的值作为该条鱼的价值；否则如果差超过 $X$，则取另一个值 $P_3$。\n\n现在给定 $N$ 条鱼的值（可能会有 $2$ 个或 $3$ 个），求所有鱼的总价值。", "inputFormat": "第一行，一个整数 $N$，表示金枪鱼的数量。\n\n第二行，一个整数 $X$。\n\n接下来的若干行分为 $N$ 个部分用来表示每条鱼的信息。每部分的格式为下列二者之一：\n\n- 该部分仅有唯一一行，该行包含两个整数 $P_1,P_2$。\n- 该部分共有两行，第一行包含两个整数 $P_1,P_2$，第二行包含一个整数 $P_3$。", "outputFormat": "输出所有鱼的总价值。", "hint": "**【样例 2 解释】**\n\n渔夫捕到了 $4$ 条金枪鱼，而 $X$ 的值为 $2$：\n\n|金枪鱼编号|$p_1$|$p_2$|$p_3$|差值|最终价值|\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n|$1$|$3$|$5$|/|$2 \\le 2$|$5$|\n|$2$|$2$|$8$|$4$|$6 \\gt 2$|$4$|\n|$3$|$6$|$5$|/|$1 \\le 2$|$6$|\n|$4$|$6$|$3$|$7$|$3 \\le 7$|$7$|\n\n故价值总和为 $5+4+6+7=22$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 20$，$1 \\le X \\le 10$，$1 \\le P_1,P_2,P_3 \\le 100$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T1 Tuna_。**\n\n**本题分值按 COCI 原题设置，满分 $50$。**", "locale": "zh-CN"}}}
{"pid": "P7761", "type": "P", "difficulty": 2, "samples": [["2\n100 200", "50.0\n66.66666666666666"], ["8\n100100 10 100 1000 1 10100\n90100 100100", "37.5\n96.28172769816027"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #5] Pareto", "background": "二八定律提出：在任何一组东西中，最重要的只占其中一小部分，而其余尽管是多数，却是次要的。\n\n例如，微软发现只需要修复 $20\\%$ 的漏洞就能够减少 $80\\%$ 的故障时间。再者，研究表明，$80\\%$ 的财富都掌握在 $20\\%$ 的人的手中。", "description": "给定 $N$ 个银行客户的存款。求两个实数 $A,B$，使得 $A\\%$ 的客户恰好拥有存款总额的 $B\\%$，且 $B-A$ 最大。", "inputFormat": "第一行，一个整数 $N$，表示银行客户的数量。\n\n接下来的一行，共 $N$ 个整数，依次表示每个客户的存款。", "outputFormat": "第一行，输出所求的 $A$ 值。\n\n第二行，输出所求的 $B$ 值。\n\n保证对于最大的 $B-A$，最终答案唯一。\n\n若输出与答案相差不超过 $0.01$，则算作答案正确。", "hint": "**【样例 1 解释】**\n\n不难发现，存款金额为 $200$ 的客户拥有存款总额的约 $66.666667\\%$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 3 \\times 10^5$，所有客户的存款金额都是不超过 $10^8$ 的非负整数。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T2 Pareto_。**\n\n**本题分值按 COCI 原题设置，满分 $80$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #5] Pareto", "background": "二八定律提出：在任何一组东西中，最重要的只占其中一小部分，而其余尽管是多数，却是次要的。\n\n例如，微软发现只需要修复 $20\\%$ 的漏洞就能够减少 $80\\%$ 的故障时间。再者，研究表明，$80\\%$ 的财富都掌握在 $20\\%$ 的人的手中。", "description": "给定 $N$ 个银行客户的存款。求两个实数 $A,B$，使得 $A\\%$ 的客户恰好拥有存款总额的 $B\\%$，且 $B-A$ 最大。", "inputFormat": "第一行，一个整数 $N$，表示银行客户的数量。\n\n接下来的一行，共 $N$ 个整数，依次表示每个客户的存款。", "outputFormat": "第一行，输出所求的 $A$ 值。\n\n第二行，输出所求的 $B$ 值。\n\n保证对于最大的 $B-A$，最终答案唯一。\n\n若输出与答案相差不超过 $0.01$，则算作答案正确。", "hint": "**【样例 1 解释】**\n\n不难发现，存款金额为 $200$ 的客户拥有存款总额的约 $66.666667\\%$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 3 \\times 10^5$，所有客户的存款金额都是不超过 $10^8$ 的非负整数。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T2 Pareto_。**\n\n**本题分值按 COCI 原题设置，满分 $80$。**", "locale": "zh-CN"}}}
{"pid": "P7762", "type": "P", "difficulty": 3, "samples": [["3\n8 2\n4 4\n2 6", "28"], ["5\n2 10\n4 4\n2 2\n8 8\n6 6", "68"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #5] Unija", "background": "", "description": "给定 $N$ 个几何中心位于平面直角坐标系原点的矩形。将这 $N$ 个矩形进行涂色，求被涂色的总面积。", "inputFormat": "第一行，一个整数 $N$。\n\n接下来的 $N$ 行，每行两个偶数 $X,Y$，分别表示矩形的宽和长（分别对应横向长度和纵向长度）。", "outputFormat": "输出被涂色的总面积。", "hint": "**【样例 1 图解】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g1w4hrf7.png?x-oss-process=image/resize,m_lfit,h_389,w_485)\n\n**【数据规模与约定】**\n\n对于 $40\\%$ 的数据，输入的整数均小于 $3333$。\n\n对于 $50\\%$ 的数据，没有具有包含关系的矩形。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^6$，$2 \\le X,Y \\le 10^7$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T3 Unija_。**\n\n**本题分值按 COCI 原题设置，满分 $100$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #5] Unija", "background": "", "description": "给定 $N$ 个几何中心位于平面直角坐标系原点的矩形。将这 $N$ 个矩形进行涂色，求被涂色的总面积。", "inputFormat": "第一行，一个整数 $N$。\n\n接下来的 $N$ 行，每行两个偶数 $X,Y$，分别表示矩形的宽和长（分别对应横向长度和纵向长度）。", "outputFormat": "输出被涂色的总面积。", "hint": "**【样例 1 图解】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g1w4hrf7.png?x-oss-process=image/resize,m_lfit,h_389,w_485)\n\n**【数据规模与约定】**\n\n对于 $40\\%$ 的数据，输入的整数均小于 $3333$。\n\n对于 $50\\%$ 的数据，没有具有包含关系的矩形。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^6$，$2 \\le X,Y \\le 10^7$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T3 Unija_。**\n\n**本题分值按 COCI 原题设置，满分 $100$。**", "locale": "zh-CN"}}}
{"pid": "P7763", "type": "P", "difficulty": 4, "samples": [["2\n0", "DA"], ["3\n2\n1 2\n2 3", "NE"], ["4\n2\n1 3\n2 4", "DA"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #5] Ronald", "background": "", "description": "一个国家的 $N$ 个城市通过双向航线相连。\n\n规定一次操作为：\n\n- 选定其中一个城市\n- 开设该城市到其它所有城市的航线，同时取消该城市的原有航线\n\n请问是否存在一种操作方式，使得每两个城市之间都存在直达航线（操作次数不限）。", "inputFormat": "第一行，一个整数 $N$，表示城市的数量。\n\n第二行，一个整数 $M$，表示初始的航线数量。\n\n接下来的 $M$ 行，每行两个不相等的整数，表示该航线连接的两个城市。", "outputFormat": "若存在符合题意的操作方式，则输出 `DA`。否则输出 `NE`。", "hint": "**【样例 1 解释】**\n\n选定城市 $1$（即开通 $1-2$ 的航线）即可。\n\n**【样例 3 解释】**\n\n原有航线为 $1-3$ 和 $2-4$。\n\n第一次选定城市 $1$。此时航线 $1-3$ 被取消，同时新开设航线 $1-1,1-2,1-4$。\n\n第二次选定城市 $3$。此时新开设航线 $3-1,3-2,3-4$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 1000$，$0 \\le M \\lt \\dfrac{N(N-1)}{2}$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T4 Ronald_。**\n\n**本题分值按 COCI 原题设置，满分 $120$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #5] Ronald", "background": "", "description": "一个国家的 $N$ 个城市通过双向航线相连。\n\n规定一次操作为：\n\n- 选定其中一个城市\n- 开设该城市到其它所有城市的航线，同时取消该城市的原有航线\n\n请问是否存在一种操作方式，使得每两个城市之间都存在直达航线（操作次数不限）。", "inputFormat": "第一行，一个整数 $N$，表示城市的数量。\n\n第二行，一个整数 $M$，表示初始的航线数量。\n\n接下来的 $M$ 行，每行两个不相等的整数，表示该航线连接的两个城市。", "outputFormat": "若存在符合题意的操作方式，则输出 `DA`。否则输出 `NE`。", "hint": "**【样例 1 解释】**\n\n选定城市 $1$（即开通 $1-2$ 的航线）即可。\n\n**【样例 3 解释】**\n\n原有航线为 $1-3$ 和 $2-4$。\n\n第一次选定城市 $1$。此时航线 $1-3$ 被取消，同时新开设航线 $1-1,1-2,1-4$。\n\n第二次选定城市 $3$。此时新开设航线 $3-1,3-2,3-4$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 1000$，$0 \\le M \\lt \\dfrac{N(N-1)}{2}$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T4 Ronald_。**\n\n**本题分值按 COCI 原题设置，满分 $120$。**", "locale": "zh-CN"}}}
{"pid": "P7764", "type": "P", "difficulty": 5, "samples": [["5 1\n1 2 1 1 1\n1 3", "1"], ["5 2\n1 1 1 1 1\n2 4\n2 3", "0\n1"], ["5 2\n1 1 2 2 3\n1 1\n1 5", "0\n2"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "莫队", "线段树", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #5] Poklon", "background": "", "description": "给定一个包含 $N$ 个自然数的数组。\n\n接着需要回答 $Q$ 次询问，每次询问输出区间 $[L,R]$ 内恰好出现两次的自然数的数量。", "inputFormat": "第一行，两个整数 $N,Q$，分别表示数组元素数量和询问次数。\n\n第二行，$N$ 个整数，表示数组中的元素。\n\n接下来的 $Q$ 行，每行两个整数 $L,R$，表示询问的区间。", "outputFormat": "共 $Q$ 行，依次对应每次询问的结果。", "hint": "**【样例 1 解释】**\n\n区间 $[1,3]$ 中只有 $1$ 恰好出现了两次。\n\n**【数据规模与约定】**\n\n对于 $40\\%$ 的数据，$N,Q \\le 5000$。\n\n对于 $100\\%$ 的数据，$1 \\le N,Q \\le 5 \\times 10^5$，$1 \\le L \\le R \\le N$，数组中的元素都是小于 $10^9$ 的自然数。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T5 Poklon_。**\n\n**本题分值按 COCI 原题设置，满分 $140$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #5] Poklon", "background": "", "description": "给定一个包含 $N$ 个自然数的数组。\n\n接着需要回答 $Q$ 次询问，每次询问输出区间 $[L,R]$ 内恰好出现两次的自然数的数量。", "inputFormat": "第一行，两个整数 $N,Q$，分别表示数组元素数量和询问次数。\n\n第二行，$N$ 个整数，表示数组中的元素。\n\n接下来的 $Q$ 行，每行两个整数 $L,R$，表示询问的区间。", "outputFormat": "共 $Q$ 行，依次对应每次询问的结果。", "hint": "**【样例 1 解释】**\n\n区间 $[1,3]$ 中只有 $1$ 恰好出现了两次。\n\n**【数据规模与约定】**\n\n对于 $40\\%$ 的数据，$N,Q \\le 5000$。\n\n对于 $100\\%$ 的数据，$1 \\le N,Q \\le 5 \\times 10^5$，$1 \\le L \\le R \\le N$，数组中的元素都是小于 $10^9$ 的自然数。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T5 Poklon_。**\n\n**本题分值按 COCI 原题设置，满分 $140$。**", "locale": "zh-CN"}}}
{"pid": "P7765", "type": "P", "difficulty": 1, "samples": [["BANANA PIDZAMA", ".P....\n.I....\n.D....\n.Z.... \nBANANA\n.M....\n.A...."], ["MAMA TATA", ".T..\nMAMA\n.T..\n.A.."], ["REPUBLIKA HRVATSKA", "H........\nREPUBLIKA\nV........\nA........\nT........\nS........\nK........\nA........"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #5] KRIŽALJKA", "background": "", "description": "有两个单词 $A,B$，将 $A$ 水平摆放，$B$ 竖直摆放，两个单词重叠部分必须为**同一字母**，且这一字母须在 $A,B$ 中第一次出现。\n\n例如，当 `A=\"ABBA\",B=\"CCBB\"` 时，输出如下所示：\n\n```\n.C..\n.C..\nABBA\n.B..\n```", "inputFormat": "一行，两个字符串，由大写字母组成，分别表示 $A$ 和 $B$。", "outputFormat": "一个矩阵，表示摆放结果。\n\n其中无字符用 `.` 表示。", "hint": "数据保证有解。\n\n字符串由大写字母构成。\n\n题目译自 [COCI 2011/2012 #5 T1](https://hsin.hr/coci/archive/2011_2012/contest5_tasks.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #5] KRIŽALJKA", "background": "", "description": "有两个单词 $A,B$，将 $A$ 水平摆放，$B$ 竖直摆放，两个单词重叠部分必须为**同一字母**，且这一字母须在 $A,B$ 中第一次出现。\n\n例如，当 `A=\"ABBA\",B=\"CCBB\"` 时，输出如下所示：\n\n```\n.C..\n.C..\nABBA\n.B..\n```", "inputFormat": "一行，两个字符串，由大写字母组成，分别表示 $A$ 和 $B$。", "outputFormat": "一个矩阵，表示摆放结果。\n\n其中无字符用 `.` 表示。", "hint": "数据保证有解。\n\n字符串由大写字母构成。\n\n题目译自 [COCI 2011/2012 #5 T1](https://hsin.hr/coci/archive/2011_2012/contest5_tasks.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7767", "type": "P", "difficulty": 3, "samples": [["4\nABBA", "2"], ["5\nBBABB", "2"], ["12\nAAABBBAAABBB", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "贪心", "2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #5] DNA", "background": "", "description": "有一个由 $A,B$ 组成的 $N$ 个字母的序列。\n\n每次操作可以有两种情况：\n\n1. 改变序列中的一个字符 （$A\\to B$ 或 $B\\to A$）；\n\n2. 改变序列的前缀，即对 $1$ 到 $K(1\\le K\\le N)$ 的字符进行操作 1。\n\n求最少进行多少次操作可以使序列全部为 $A$。", "inputFormat": "第一行一个整数，表示 $N$。\n\n第二行 $N$ 个字符，表示该序列。", "outputFormat": "一行，一个整数，表示答案。", "hint": "$1\\le N\\le 10^{6}$。\n\n序列仅由 `'A','B'` 构成。\n\n题目译自 [COCI 2011/2012 #5 T3](https://hsin.hr/coci/archive/2011_2012/contest5_tasks.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #5] DNA", "background": "", "description": "有一个由 $A,B$ 组成的 $N$ 个字母的序列。\n\n每次操作可以有两种情况：\n\n1. 改变序列中的一个字符 （$A\\to B$ 或 $B\\to A$）；\n\n2. 改变序列的前缀，即对 $1$ 到 $K(1\\le K\\le N)$ 的字符进行操作 1。\n\n求最少进行多少次操作可以使序列全部为 $A$。", "inputFormat": "第一行一个整数，表示 $N$。\n\n第二行 $N$ 个字符，表示该序列。", "outputFormat": "一行，一个整数，表示答案。", "hint": "$1\\le N\\le 10^{6}$。\n\n序列仅由 `'A','B'` 构成。\n\n题目译自 [COCI 2011/2012 #5 T3](https://hsin.hr/coci/archive/2011_2012/contest5_tasks.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7768", "type": "P", "difficulty": 5, "samples": [["6 3\n604 545 402 378 25 13\n1 2 2 3 3\n1 2\n3 0\n2 4", "0.149\n0.402\n0.733"], ["6 3\n6 5 4 3 2 1\n1 2 2 3 3\n1 2\n3 0\n2 4", "0.004\n0.004\n0.001"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["树状数组", "树上启发式合并", "Special Judge", "O2优化", "树链剖分", "可持久化线段树", "差分"], "title": "「CGOI-1」收税", "background": "~~签到题~~\n\n由于举办选丑大赛消耗了太多钱财，ac 决定派出 Push_Y 去收税。", "description": "丑国由 $n$ 座城市组成，编号 $1$ 的为首都。这 $n$ 座城市由 $n-1$ 条长度为 $1$ 的双向道路连接。从编号为 $x$ 的城市出发，往**远离**首都的方向（即往儿子节点走），距离不超过 $h$ 的就是这座城市要收税的范围。\n\n第 $i$ 座城市将要上缴 $a_i$ **元**的所得税。但由于收税官 Push_Y 很喜欢异或，因此每座城市最终上缴的所得税将是在其收税范围内每座城市**应缴税额**的异或和。\n\nPush_Y 将向你提出 $m$ 个询问，他将问你城市 $x$ 在收税距离为 $h$ 时将收到多少**千元**的所得税。\n\n**简化版题意：**\n\n给定一棵 $n$ 个点的树，根节点为 $1$ 号点，第 $i$ 个点的点权为 $a_i$，$dep_u$ 表示 $u$ 点的深度，根节点的深度为 $1$，$q$ 次询问，每次给定两个整数 $x,h$，表示询问 $\\bigoplus_{u\\in son(x)\\land dep_u-dep_x\\le h}a_i$ 除以 $1000$ 后的值。\n\n其中 $\\bigoplus_{i=1}^ni$ 表示 $1\\operatorname{xor} 2\\operatorname{xor}\\cdots\\operatorname{xor} n$。\n\n此处 $\\land$ 是“且”，$\\operatorname{xor}$ 是异或。", "inputFormat": "第一行两个正整数 $n,m$，表示城市数和询问数。\n\n第二行 $n$ 个正整数 $a_i$， 表示每座城市应缴的所得税额。\n\n第三行 $n-1$ 个正整数，其中第 $i$ 个数 $f_i$ 表示城市 $i+1$ 与城市 $f_i$ 有一条路相连。\n\n从第 $4$ 行开始 $m$ 行，每行两个正整数 $x,h$，表示一组询问。", "outputFormat": "对于每组询问，输出一行，一个实数，表示这座城市收取的税额。\n\n**答案保留三位小数。**", "hint": "对于 $30\\%$ 的数据，$1\\le n,m\\le 10^3$。\n\n对于 $70\\%$ 的数据，$1\\le n,m\\le5 \\times 10^4$。其中有 $20\\%$ 的数据是链。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^6$，$1 \\le a_i \\le 10^9$，$1\\le x \\le n$，$0 \\le h \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CGOI-1」收税", "background": "~~签到题~~\n\n由于举办选丑大赛消耗了太多钱财，ac 决定派出 Push_Y 去收税。", "description": "丑国由 $n$ 座城市组成，编号 $1$ 的为首都。这 $n$ 座城市由 $n-1$ 条长度为 $1$ 的双向道路连接。从编号为 $x$ 的城市出发，往**远离**首都的方向（即往儿子节点走），距离不超过 $h$ 的就是这座城市要收税的范围。\n\n第 $i$ 座城市将要上缴 $a_i$ **元**的所得税。但由于收税官 Push_Y 很喜欢异或，因此每座城市最终上缴的所得税将是在其收税范围内每座城市**应缴税额**的异或和。\n\nPush_Y 将向你提出 $m$ 个询问，他将问你城市 $x$ 在收税距离为 $h$ 时将收到多少**千元**的所得税。\n\n**简化版题意：**\n\n给定一棵 $n$ 个点的树，根节点为 $1$ 号点，第 $i$ 个点的点权为 $a_i$，$dep_u$ 表示 $u$ 点的深度，根节点的深度为 $1$，$q$ 次询问，每次给定两个整数 $x,h$，表示询问 $\\bigoplus_{u\\in son(x)\\land dep_u-dep_x\\le h}a_i$ 除以 $1000$ 后的值。\n\n其中 $\\bigoplus_{i=1}^ni$ 表示 $1\\operatorname{xor} 2\\operatorname{xor}\\cdots\\operatorname{xor} n$。\n\n此处 $\\land$ 是“且”，$\\operatorname{xor}$ 是异或。", "inputFormat": "第一行两个正整数 $n,m$，表示城市数和询问数。\n\n第二行 $n$ 个正整数 $a_i$， 表示每座城市应缴的所得税额。\n\n第三行 $n-1$ 个正整数，其中第 $i$ 个数 $f_i$ 表示城市 $i+1$ 与城市 $f_i$ 有一条路相连。\n\n从第 $4$ 行开始 $m$ 行，每行两个正整数 $x,h$，表示一组询问。", "outputFormat": "对于每组询问，输出一行，一个实数，表示这座城市收取的税额。\n\n**答案保留三位小数。**", "hint": "对于 $30\\%$ 的数据，$1\\le n,m\\le 10^3$。\n\n对于 $70\\%$ 的数据，$1\\le n,m\\le5 \\times 10^4$。其中有 $20\\%$ 的数据是链。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^6$，$1 \\le a_i \\le 10^9$，$1\\le x \\le n$，$0 \\le h \\le n$。", "locale": "zh-CN"}}}
{"pid": "P7769", "type": "P", "difficulty": 6, "samples": [["6 4\n1 1 3 4 2 1\n4 3 3\n1 2 2\n5 4 6\n2 1 2", "Yes\nNo\nYes\nYes"], ["6 4\n4 2 2 2 2 1\n6 1 1\n5 5 6\n4 3 5\n5 2 2", "Yes\nNo\nYes\nNo"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216]}, "tags": ["O2优化", "后缀数组 SA"], "title": "「CGOI-1」大师选徒", "background": "最近有好多人来丑国学习 bc。bc 大师 ac 和 mc 要从所有学生选出一些来传授 bc 技艺。\n\n###### 2021.8.29：添加了一组 hack", "description": "有 $n$ 个学生站成一排，每个学生有一个丑值 $a_i$。现在 ac 和 mc 要**各自**从学生中选取**连续**的一段传授 bc。\n\n由于 ac 和 mc 关系很♂好，所以两人选出的学生必须人数相同，并且**对应位置**上的学生丑值之和均为 $s$。\n\n（比方说，如果 ac 选第 $1$、$2$、$3$ 号学生，mc 选 $3$、$4$、$5$ 号学生，必须满足 $a_1+a_3=a_2+a_4=a_3+a_5=s$）\n\n但 ac 并不知道 mc 所选的学生以及 $s$ 是多少，所以他会给出若干个询问。对于每个询问，你需要回答对于特定的 $s$ 以及 mc 选出的一段学生，ac 是否可以选出另一段学生满足上述要求。\n\n**简化版题意：**\n\n给出 $n$ 及 $n$ 个整数 $a_1,\\,a_2,\\,\\dots,\\,a_n$；\n\n$q$ 次询问，每次给出 $s,l,r$，问是否存在 $b$，满足 $\\forall k \\in [0, r-l]$，$a_{l+k}+a_{b+k}=s$。", "inputFormat": "第一行输入两个整数 $n,\\,q$，分别表示学生的人数与询问的个数。\n\n第二行输入 $n$ 个整数，第 $i$ 个数 $a_i$ 表示第 $i$ 个学生的丑值。\n\n接下来 $q$ 行，每行输入三个整数 $s,\\,l,\\,r$，分别表示丑值之和，mc 所选的第一个学生的下标和最后一个学生的下标。", "outputFormat": "对于每一个询问，如果可以选出符合条件的学生，输出 `Yes`，否则输出 `No`。每个输出占一行。", "hint": "#### 样例说明：\n\n对于样例 1：\n\n第一个询问，mc 选择的是第三个学生，ac 可以选择第一个学生。\n\n第二个询问，mc 选择的第二个学生丑值为 $1$，而总和也为 $1$，但不存在丑值为 $0$ 的学生，故不能满足条件。\n\n第三个询问，mc 选择的是第四个到第六个，那么 ac 选择第二个到第四个，对应位置的学生丑值之和 $a_2+a_4=a_3+a_5=a_4+a_6=5$，满足条件。\n\n第四个询问，mc 选择第一个和第二个，那么 ac 也选择第一个和第二个，满足条件。\n\n---\n\n#### 数据范围：\n\n**本题采用捆绑测试。**\n\n对于全部数据，有 $1\\le n,\\,q\\le 4\\times10^5$，$1\\le a_i \\le n$，$1\\le s\\le 2n$，$1\\le l\\le r\\le n$。\n* Subtask 0（10 points）：$n,\\,q\\le 500$。\n* Subtask 1（20 points）：$n,\\,q\\le 8\\times10^3$。\n* Subtask 2（20 points）：保证所有 $s$ 相同。\n* Subtask 3（50 points）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CGOI-1」大师选徒", "background": "最近有好多人来丑国学习 bc。bc 大师 ac 和 mc 要从所有学生选出一些来传授 bc 技艺。\n\n###### 2021.8.29：添加了一组 hack", "description": "有 $n$ 个学生站成一排，每个学生有一个丑值 $a_i$。现在 ac 和 mc 要**各自**从学生中选取**连续**的一段传授 bc。\n\n由于 ac 和 mc 关系很♂好，所以两人选出的学生必须人数相同，并且**对应位置**上的学生丑值之和均为 $s$。\n\n（比方说，如果 ac 选第 $1$、$2$、$3$ 号学生，mc 选 $3$、$4$、$5$ 号学生，必须满足 $a_1+a_3=a_2+a_4=a_3+a_5=s$）\n\n但 ac 并不知道 mc 所选的学生以及 $s$ 是多少，所以他会给出若干个询问。对于每个询问，你需要回答对于特定的 $s$ 以及 mc 选出的一段学生，ac 是否可以选出另一段学生满足上述要求。\n\n**简化版题意：**\n\n给出 $n$ 及 $n$ 个整数 $a_1,\\,a_2,\\,\\dots,\\,a_n$；\n\n$q$ 次询问，每次给出 $s,l,r$，问是否存在 $b$，满足 $\\forall k \\in [0, r-l]$，$a_{l+k}+a_{b+k}=s$。", "inputFormat": "第一行输入两个整数 $n,\\,q$，分别表示学生的人数与询问的个数。\n\n第二行输入 $n$ 个整数，第 $i$ 个数 $a_i$ 表示第 $i$ 个学生的丑值。\n\n接下来 $q$ 行，每行输入三个整数 $s,\\,l,\\,r$，分别表示丑值之和，mc 所选的第一个学生的下标和最后一个学生的下标。", "outputFormat": "对于每一个询问，如果可以选出符合条件的学生，输出 `Yes`，否则输出 `No`。每个输出占一行。", "hint": "#### 样例说明：\n\n对于样例 1：\n\n第一个询问，mc 选择的是第三个学生，ac 可以选择第一个学生。\n\n第二个询问，mc 选择的第二个学生丑值为 $1$，而总和也为 $1$，但不存在丑值为 $0$ 的学生，故不能满足条件。\n\n第三个询问，mc 选择的是第四个到第六个，那么 ac 选择第二个到第四个，对应位置的学生丑值之和 $a_2+a_4=a_3+a_5=a_4+a_6=5$，满足条件。\n\n第四个询问，mc 选择第一个和第二个，那么 ac 也选择第一个和第二个，满足条件。\n\n---\n\n#### 数据范围：\n\n**本题采用捆绑测试。**\n\n对于全部数据，有 $1\\le n,\\,q\\le 4\\times10^5$，$1\\le a_i \\le n$，$1\\le s\\le 2n$，$1\\le l\\le r\\le n$。\n* Subtask 0（10 points）：$n,\\,q\\le 500$。\n* Subtask 1（20 points）：$n,\\,q\\le 8\\times10^3$。\n* Subtask 2（20 points）：保证所有 $s$ 相同。\n* Subtask 3（50 points）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7770", "type": "P", "difficulty": 5, "samples": [["5 2\n1 2 3 4 5\n1 1 3\n6 1 7", "2\n0"]], "limits": {"time": [1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216]}, "tags": ["O2优化", "可持久化线段树"], "title": "「CGOI-1」丑国旅游", "background": "丑国风景优美，是远近闻名的旅游胜地（并不）。来丑国旅游的人很多。", "description": "丑国的一角排列着编号从 $1$ 到 $n$ 的 $n$ 个城市。当一个人在第 $i$ 个城市时，能且仅能走到第 $i+1$ 个城市。\n\n第 $i$ 个城市中的人们最讨厌丑值为 $a_i$ 的人。当一个丑值为 $x$ 的人从第 $i$ 个城市走到第 $i+1$ 个城市时，他会获得 $|x-a_i|\\times|x-a_{i+1}|$ 的舒适值。\n\n现在有 $m$ 个人要来丑国旅游，第 $i$ 个人的丑值为 $x_i$，要从城市 $l_i$ 走到 $r_i$，问他得到的舒适值之和是多少。\n\n**由于这个数可能很大，你需要求出对 $10^9+7$ 取模后的值**。\n\n由于你不能预知到下一次旅游，我们会强制你在线。\n\n**简化版题意：**\n\n给出 $n$ 及 $n$ 个整数 $a_1,\\,a_2,\\,\\dots,\\,a_n$。\n\n$m$ 次在线询问，每次询问给出 $x,\\,l,\\,r$，求 $\\sum\\limits_{i=l}^{r-1}|x-a_i|\\times|x-a_{i+1}|$。", "inputFormat": "第一行输入两个整数 $n,m$，分别表示城市数与旅游人数。\n\n第二行输入 $n$ 个整数，第 $i$ 个数表示 $a_i$，含义如上所述。\n\n接下来 $m$ 行，每行输入三个整数 $X,\\,L,\\,R$，记上一次的旅游的总舒适值对 $10^9+7$ 取模后为 $s$（若是第一次询问，则 $s=0$），则 $x_i=X\\operatorname{xor}s,\\;l_i=L\\operatorname{xor}s,\\;r_i=R\\operatorname{xor}s$，其中 $\\operatorname{xor}$ 表示异或，而 $x_i,\\,l_i,\\,r_i$ 的含义如上所述。", "outputFormat": "输出 $m$ 行，第 $i$ 行的数表示第 $i$ 个人的总舒适值对 $10^9+7$ 取模后的值。", "hint": "#### 样例说明：\n\n对于第一次询问，从城 $1$ 走到城 $2$，获得舒适值为 $|1-1|\\times|1-2|=0$；从城 $2$ 走到城 $3$，获得舒适值为 $|1-2|\\times|1-3|=2$，故总舒适值为 $2$。\n\n对于第二次询问，解密后的 $x,\\,l,\\,r$ 分别是 $4,3,5$。从城 $3$ 走到城 $4$，获得舒适值为 $|4-3|\\times|4-4|=0$；从城 $4$ 走到城 $5$，舒适值为 $|4-4|\\times|4-5|=0$，总舒适值为 $0$。\n\n---\n\n#### 数据范围：\n\n**本题采用捆绑测试。**\n\n| 编号 | 特殊限制 | 分值 |时限|\n| :-: | :-: | :-: |:-:|\n| Subtask0 | $n,\\,m\\le 10^4$ | 20pts |1s|\n| Subtask1 | $a_i,\\,x\\le 10$ | 10pts |2s|\n| Subtask2 | $a_i$ 单调递增 | 10pts |2s|\n| Subtask3 | 无特殊限制 | 60pts |2s|\n\n对于 $100\\%$ 的数据，$1 \\le n,\\,m \\le 3 \\times 10^5$，$1 \\le a_i,\\,x_i \\le 10^9$，$1 \\le l_i < r_i \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CGOI-1」丑国旅游", "background": "丑国风景优美，是远近闻名的旅游胜地（并不）。来丑国旅游的人很多。", "description": "丑国的一角排列着编号从 $1$ 到 $n$ 的 $n$ 个城市。当一个人在第 $i$ 个城市时，能且仅能走到第 $i+1$ 个城市。\n\n第 $i$ 个城市中的人们最讨厌丑值为 $a_i$ 的人。当一个丑值为 $x$ 的人从第 $i$ 个城市走到第 $i+1$ 个城市时，他会获得 $|x-a_i|\\times|x-a_{i+1}|$ 的舒适值。\n\n现在有 $m$ 个人要来丑国旅游，第 $i$ 个人的丑值为 $x_i$，要从城市 $l_i$ 走到 $r_i$，问他得到的舒适值之和是多少。\n\n**由于这个数可能很大，你需要求出对 $10^9+7$ 取模后的值**。\n\n由于你不能预知到下一次旅游，我们会强制你在线。\n\n**简化版题意：**\n\n给出 $n$ 及 $n$ 个整数 $a_1,\\,a_2,\\,\\dots,\\,a_n$。\n\n$m$ 次在线询问，每次询问给出 $x,\\,l,\\,r$，求 $\\sum\\limits_{i=l}^{r-1}|x-a_i|\\times|x-a_{i+1}|$。", "inputFormat": "第一行输入两个整数 $n,m$，分别表示城市数与旅游人数。\n\n第二行输入 $n$ 个整数，第 $i$ 个数表示 $a_i$，含义如上所述。\n\n接下来 $m$ 行，每行输入三个整数 $X,\\,L,\\,R$，记上一次的旅游的总舒适值对 $10^9+7$ 取模后为 $s$（若是第一次询问，则 $s=0$），则 $x_i=X\\operatorname{xor}s,\\;l_i=L\\operatorname{xor}s,\\;r_i=R\\operatorname{xor}s$，其中 $\\operatorname{xor}$ 表示异或，而 $x_i,\\,l_i,\\,r_i$ 的含义如上所述。", "outputFormat": "输出 $m$ 行，第 $i$ 行的数表示第 $i$ 个人的总舒适值对 $10^9+7$ 取模后的值。", "hint": "#### 样例说明：\n\n对于第一次询问，从城 $1$ 走到城 $2$，获得舒适值为 $|1-1|\\times|1-2|=0$；从城 $2$ 走到城 $3$，获得舒适值为 $|1-2|\\times|1-3|=2$，故总舒适值为 $2$。\n\n对于第二次询问，解密后的 $x,\\,l,\\,r$ 分别是 $4,3,5$。从城 $3$ 走到城 $4$，获得舒适值为 $|4-3|\\times|4-4|=0$；从城 $4$ 走到城 $5$，舒适值为 $|4-4|\\times|4-5|=0$，总舒适值为 $0$。\n\n---\n\n#### 数据范围：\n\n**本题采用捆绑测试。**\n\n| 编号 | 特殊限制 | 分值 |时限|\n| :-: | :-: | :-: |:-:|\n| Subtask0 | $n,\\,m\\le 10^4$ | 20pts |1s|\n| Subtask1 | $a_i,\\,x\\le 10$ | 10pts |2s|\n| Subtask2 | $a_i$ 单调递增 | 10pts |2s|\n| Subtask3 | 无特殊限制 | 60pts |2s|\n\n对于 $100\\%$ 的数据，$1 \\le n,\\,m \\le 3 \\times 10^5$，$1 \\le a_i,\\,x_i \\le 10^9$，$1 \\le l_i < r_i \\le n$。", "locale": "zh-CN"}}}
{"pid": "P7771", "type": "P", "difficulty": 4, "samples": [["4 6\n1 3\n2 1\n4 2\n3 3\n1 2\n3 4", "1 2 1 3 3 4 2"], ["5 5\n1 2\n3 5\n4 3\n3 4\n2 3", "1 2 3 4 3 5"], ["4 3\n1 2\n1 3\n1 4", "No"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["欧拉回路", "模板题"], "title": "【模板】欧拉路径", "background": "", "description": "求有向图字典序最小的欧拉路径。", "inputFormat": "第一行两个整数 $n,m$ 表示有向图的点数和边数。\n\n接下来 $m$ 行每行两个整数 $u,v$ 表示存在一条 $u\\to v$ 的有向边。", "outputFormat": "如果不存在欧拉路径，输出一行 `No`。\n\n否则输出一行 $m+1$ 个数字，表示字典序最小的欧拉路径。", "hint": "对于 $50\\%$ 的数据，$n,m\\leq 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq u,v\\leq n\\leq 10^5$，$m\\leq 2\\times 10^5$。\n\n保证将有向边视为无向边后图连通。\n\n本题的数据生成器：\n\n```cpp\n#include<bits/stdc++.h>\n#include<windows.h>\nusing namespace std;\ntypedef unsigned long long ull;\n#define N 100005\n#define For(i,x,y)for(i=x;i<=(y);i++)\nbool bo[N];\nqueue<int>p,q;\null R=GetTickCount();\nint deg[N][2],dep[N],fa[N];\ninline int Rand(int _,int __)\n{\n\tR^=R<<13;\n\tR^=R>>7;\n\tR^=R<<17;\n\treturn R%(__-_+1)+_;\n}\nint find(int p)\n{\n\tif(p!=fa[p])fa[p]=find(fa[p]);\n\treturn fa[p];\n}\ninline void unite(int p,int q)\n{\n\tp=find(p),q=find(q);\n\tif(p==q)return;\n\tif(dep[p]<dep[q])fa[p]=q;\n\telse fa[q]=p;\n\tif(dep[p]==dep[q])dep[p]++;\n}\nint main()\n{\n\tfreopen(\"P7771.in\",\"w\",stdout);\n\tint n=Rand(1,100000),m=Rand(190000,200000),i,u,v;\n\tcout<<n<<' '<<m;\n\tFor(i,1,n)fa[i]=i;\n\tFor(i,1,m>>1)\n\t{\n\t\tu=Rand(1,n),v=Rand(1,n);\n\t\tcout<<endl<<u<<' '<<v;\n\t\tunite(u,v);\n\t\tdeg[u][0]++;\n\t\tdeg[v][1]++;\n\t}\n\tm-=m>>1;\n\tFor(i,1,n)\n\tif(deg[i][0]<deg[i][1])p.push(i);\n\telse if(deg[i][0]>deg[i][1])q.push(i);\n\twhile(m)\n\t{\n\t\tif(p.empty()||q.empty())break;\n\t\tu=p.front();\n\t\tv=q.front();\n\t\tp.pop();\n\t\tq.pop();\n\t\tunite(u,v);\n\t\tcout<<endl<<u<<' '<<v;\n\t\tdeg[u][0]++;\n\t\tdeg[v][1]++;\n\t\tif(deg[u][0]<deg[u][1])p.push(u);\n\t\tif(deg[v][0]>deg[v][1])q.push(v);\n\t\tm--;\n\t}\n\tFor(i,1,n-1)\n\tif(find(i)!=find(n))\n\t{\n\t\tcout<<endl<<n<<' '<<i<<endl<<i<<' '<<n;\n\t\tm-=2;\n\t\tunite(n,i);\n\t}\n\tif(m<2)\n\twhile(1);\n\twhile(m>Rand(0,1))\n\t{\n\t\tu=Rand(1,n);\n\t\tcout<<endl<<u<<' '<<u;\n\t\tm--;\n\t}\n\tif(m)cout<<endl<<Rand(1,n)<<' '<<Rand(1,n);\n\treturn 0;\n}\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】欧拉路径", "background": "", "description": "求有向图字典序最小的欧拉路径。", "inputFormat": "第一行两个整数 $n,m$ 表示有向图的点数和边数。\n\n接下来 $m$ 行每行两个整数 $u,v$ 表示存在一条 $u\\to v$ 的有向边。", "outputFormat": "如果不存在欧拉路径，输出一行 `No`。\n\n否则输出一行 $m+1$ 个数字，表示字典序最小的欧拉路径。", "hint": "对于 $50\\%$ 的数据，$n,m\\leq 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq u,v\\leq n\\leq 10^5$，$m\\leq 2\\times 10^5$。\n\n保证将有向边视为无向边后图连通。\n\n本题的数据生成器：\n\n```cpp\n#include<bits/stdc++.h>\n#include<windows.h>\nusing namespace std;\ntypedef unsigned long long ull;\n#define N 100005\n#define For(i,x,y)for(i=x;i<=(y);i++)\nbool bo[N];\nqueue<int>p,q;\null R=GetTickCount();\nint deg[N][2],dep[N],fa[N];\ninline int Rand(int _,int __)\n{\n\tR^=R<<13;\n\tR^=R>>7;\n\tR^=R<<17;\n\treturn R%(__-_+1)+_;\n}\nint find(int p)\n{\n\tif(p!=fa[p])fa[p]=find(fa[p]);\n\treturn fa[p];\n}\ninline void unite(int p,int q)\n{\n\tp=find(p),q=find(q);\n\tif(p==q)return;\n\tif(dep[p]<dep[q])fa[p]=q;\n\telse fa[q]=p;\n\tif(dep[p]==dep[q])dep[p]++;\n}\nint main()\n{\n\tfreopen(\"P7771.in\",\"w\",stdout);\n\tint n=Rand(1,100000),m=Rand(190000,200000),i,u,v;\n\tcout<<n<<' '<<m;\n\tFor(i,1,n)fa[i]=i;\n\tFor(i,1,m>>1)\n\t{\n\t\tu=Rand(1,n),v=Rand(1,n);\n\t\tcout<<endl<<u<<' '<<v;\n\t\tunite(u,v);\n\t\tdeg[u][0]++;\n\t\tdeg[v][1]++;\n\t}\n\tm-=m>>1;\n\tFor(i,1,n)\n\tif(deg[i][0]<deg[i][1])p.push(i);\n\telse if(deg[i][0]>deg[i][1])q.push(i);\n\twhile(m)\n\t{\n\t\tif(p.empty()||q.empty())break;\n\t\tu=p.front();\n\t\tv=q.front();\n\t\tp.pop();\n\t\tq.pop();\n\t\tunite(u,v);\n\t\tcout<<endl<<u<<' '<<v;\n\t\tdeg[u][0]++;\n\t\tdeg[v][1]++;\n\t\tif(deg[u][0]<deg[u][1])p.push(u);\n\t\tif(deg[v][0]>deg[v][1])q.push(v);\n\t\tm--;\n\t}\n\tFor(i,1,n-1)\n\tif(find(i)!=find(n))\n\t{\n\t\tcout<<endl<<n<<' '<<i<<endl<<i<<' '<<n;\n\t\tm-=2;\n\t\tunite(n,i);\n\t}\n\tif(m<2)\n\twhile(1);\n\twhile(m>Rand(0,1))\n\t{\n\t\tu=Rand(1,n);\n\t\tcout<<endl<<u<<' '<<u;\n\t\tm--;\n\t}\n\tif(m)cout<<endl<<Rand(1,n)<<' '<<Rand(1,n);\n\treturn 0;\n}\n```", "locale": "zh-CN"}}}
{"pid": "P7772", "type": "P", "difficulty": 1, "samples": [["38 24", "875"], ["1 100", "100"], ["10 10", "91"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "数学", "2009", "枚举", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #2] FAKTOR", "background": "本题为[$\\texttt{COCI 2009-2010}\\ 2^\\texttt{nd}\\ \\texttt{round}\\ \\text{T1 FAKTOR}$](https://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)。\n\n分值按原题设置，满分 $30$。", "description": "给定 $A,I$，求一个最小的 $N$，使得$\\lceil\\frac{N}{A}\\rceil\\geq I$。", "inputFormat": "一行两个整数 $A,I$。", "outputFormat": "一行一个整数 $N$。", "hint": "$1\\leq A,I\\leq 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #2] FAKTOR", "background": "本题为[$\\texttt{COCI 2009-2010}\\ 2^\\texttt{nd}\\ \\texttt{round}\\ \\text{T1 FAKTOR}$](https://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)。\n\n分值按原题设置，满分 $30$。", "description": "给定 $A,I$，求一个最小的 $N$，使得$\\lceil\\frac{N}{A}\\rceil\\geq I$。", "inputFormat": "一行两个整数 $A,I$。", "outputFormat": "一行一个整数 $N$。", "hint": "$1\\leq A,I\\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P7773", "type": "P", "difficulty": 3, "samples": [["VIII", "VIII"], ["VI", "IV"], ["III", "III"], ["LI", "LI"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "字符串", "2009", "枚举", "其它技巧", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #2] RIMSKI", "background": "本题为[$\\texttt{COCI 2009-2010}\\ 2^\\texttt{nd}\\ \\texttt{round}\\ \\text{T2 RIMSKI}$](https://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)。\n\n分值按原题设置，满分 $50$。", "description": "给定一个罗马数字 $B$，把 $B$ 的字符重新排列，要求让排列后的数字最小。", "inputFormat": "一行一个罗马数字 $B$。", "outputFormat": "一行一个罗马数字，为你重排后能得到的最小的数字。", "hint": "$1\\leq B< 100$。\n\n注意，在本题中`I`如果在大数字之前，它只能在`V` 、`X`之前。输入遵循同样的规则。（这就是样例 $4$ 的输出为什么是 `LI` 而不是 `IL`。）", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #2] RIMSKI", "background": "本题为[$\\texttt{COCI 2009-2010}\\ 2^\\texttt{nd}\\ \\texttt{round}\\ \\text{T2 RIMSKI}$](https://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)。\n\n分值按原题设置，满分 $50$。", "description": "给定一个罗马数字 $B$，把 $B$ 的字符重新排列，要求让排列后的数字最小。", "inputFormat": "一行一个罗马数字 $B$。", "outputFormat": "一行一个罗马数字，为你重排后能得到的最小的数字。", "hint": "$1\\leq B< 100$。\n\n注意，在本题中`I`如果在大数字之前，它只能在`V` 、`X`之前。输入遵循同样的规则。（这就是样例 $4$ 的输出为什么是 `LI` 而不是 `IL`。）", "locale": "zh-CN"}}}
{"pid": "P7774", "type": "P", "difficulty": 2, "samples": [["2 1\n30 70\n40", "YES"], ["1 1\n100\n60", "YES"], ["3 2\n10 20 30\n5 70", "NO\nYES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "动态规划 DP", "2009", "枚举", "哈希 hashing", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #2] KUTEVI", "background": "本题为[$\\texttt{COCI 2009-2010}\\ 2^\\texttt{nd}\\ \\texttt{round}\\ \\text{T3 KUTEVI}$](https://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)。\n\n分值按原题设置，满分 $70$。", "description": "给定 $N$ 个角（第 $i$ 个角记作 $a_i$），作为初始角，另给定 $M$ 个角（第 $i$ 个角记作 $b_i$），作为目标角。\n\n请求出对于每个 $b_i$，它是否能被若干个 $a_i$ 之间的加、减运算得到。\n\n注意同一个 $a_i$ 可以用多次，也可以不用。", "inputFormat": "第一行两个正整数 $N,M$。\n\n第二行 $N$ 个正整数，第 $i$ 个数为 $a_i$。\n\n第三行 $M$ 个正整数，第 $i$ 个数为 $b_i$。", "outputFormat": "共 $M$ 行，在第 $i$ 行，如果 $b_i$ 能被若干个 $a_i$ 之间的加、减运算得到，输出`YES`，否则输出`NO`。", "hint": "### 样例解释\n\n样例 $1$ 解释：\n\n$70^\\circ-30^\\circ=40^\\circ$。\n\n样例 $2$ 解释：\n\n$15\\times100^\\circ=1500^\\circ=60^\\circ$。\n\n### 数据范围与约定\n\n$1\\leq N,M\\leq10$，$0<a_i,b_i< 360$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #2] KUTEVI", "background": "本题为[$\\texttt{COCI 2009-2010}\\ 2^\\texttt{nd}\\ \\texttt{round}\\ \\text{T3 KUTEVI}$](https://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)。\n\n分值按原题设置，满分 $70$。", "description": "给定 $N$ 个角（第 $i$ 个角记作 $a_i$），作为初始角，另给定 $M$ 个角（第 $i$ 个角记作 $b_i$），作为目标角。\n\n请求出对于每个 $b_i$，它是否能被若干个 $a_i$ 之间的加、减运算得到。\n\n注意同一个 $a_i$ 可以用多次，也可以不用。", "inputFormat": "第一行两个正整数 $N,M$。\n\n第二行 $N$ 个正整数，第 $i$ 个数为 $a_i$。\n\n第三行 $M$ 个正整数，第 $i$ 个数为 $b_i$。", "outputFormat": "共 $M$ 行，在第 $i$ 行，如果 $b_i$ 能被若干个 $a_i$ 之间的加、减运算得到，输出`YES`，否则输出`NO`。", "hint": "### 样例解释\n\n样例 $1$ 解释：\n\n$70^\\circ-30^\\circ=40^\\circ$。\n\n样例 $2$ 解释：\n\n$15\\times100^\\circ=1500^\\circ=60^\\circ$。\n\n### 数据范围与约定\n\n$1\\leq N,M\\leq10$，$0<a_i,b_i< 360$。", "locale": "zh-CN"}}}
{"pid": "P7775", "type": "P", "difficulty": 4, "samples": [["4 4\n+...\n....\n....\nV..J\n", "3"], ["4 5\n.....\n.+++.\n.+.+.\nV+.J+", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["图论", "2009", "二分", "广度优先搜索 BFS", "图遍历", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #2] VUK", "background": "本题为[$\\texttt{COCI 2009-2010}\\ 2^\\texttt{nd}\\ \\texttt{round}\\ \\text{T4 VUK}$](https://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)。\n\n分值按原题设置，满分 $100$。", "description": "一匹狼 Vjekoslav 正在逃离一批残暴的猎人的追捕。\n\n这些猎人非常凶残，经常躲在树后面，但 Vjekoslav 并不知道哪棵树后有猎人。为了保险，Vjekoslav 希望在逃回它舒适的窝的过程中离树越远越好。\n\n森林可以抽象为 $N\\times M$ 的矩阵。每个格子可能是空的（用`.`表示），也有可能有一棵树在中心位置（用`+`表示）。Vjekoslav在`V`标示的地方而它的窝在`J`标示的地方。定义 Vjekoslav 与某棵树的距离为它们所在格的曼哈顿距离（即这两个格子所在行、列之差的绝对值之和）。\n\nVjekoslav 每次可以往东南西北中的任一方向移动，**即使它下一步移动到的格子有树（此题树并不会阻挡 Vjekoslav）**。帮忙找出这样一条从`V`到`J`的路径，使得 Vjekoslav 在途中离它最近的树的距离的最小值最大。\n\n**注意 Vjekoslav 的窝并不占据整块格子，因此你的路径中必须包含`J`。**", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $N$ 行每行 $M$ 个字符，描述这片森林。\n\n在这片森林的描述中，只会有一个`V`与一个`J`，且保证至少有一个`+`。", "outputFormat": "一行一个整数，Vjekoslav 在逃回窝的途中最大可能的离它最近的树的距离的最小值。", "hint": "$1\\leq N,M\\leq500$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #2] VUK", "background": "本题为[$\\texttt{COCI 2009-2010}\\ 2^\\texttt{nd}\\ \\texttt{round}\\ \\text{T4 VUK}$](https://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)。\n\n分值按原题设置，满分 $100$。", "description": "一匹狼 Vjekoslav 正在逃离一批残暴的猎人的追捕。\n\n这些猎人非常凶残，经常躲在树后面，但 Vjekoslav 并不知道哪棵树后有猎人。为了保险，Vjekoslav 希望在逃回它舒适的窝的过程中离树越远越好。\n\n森林可以抽象为 $N\\times M$ 的矩阵。每个格子可能是空的（用`.`表示），也有可能有一棵树在中心位置（用`+`表示）。Vjekoslav在`V`标示的地方而它的窝在`J`标示的地方。定义 Vjekoslav 与某棵树的距离为它们所在格的曼哈顿距离（即这两个格子所在行、列之差的绝对值之和）。\n\nVjekoslav 每次可以往东南西北中的任一方向移动，**即使它下一步移动到的格子有树（此题树并不会阻挡 Vjekoslav）**。帮忙找出这样一条从`V`到`J`的路径，使得 Vjekoslav 在途中离它最近的树的距离的最小值最大。\n\n**注意 Vjekoslav 的窝并不占据整块格子，因此你的路径中必须包含`J`。**", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $N$ 行每行 $M$ 个字符，描述这片森林。\n\n在这片森林的描述中，只会有一个`V`与一个`J`，且保证至少有一个`+`。", "outputFormat": "一行一个整数，Vjekoslav 在逃回窝的途中最大可能的离它最近的树的距离的最小值。", "hint": "$1\\leq N,M\\leq500$。", "locale": "zh-CN"}}}
{"pid": "P7776", "type": "P", "difficulty": 6, "samples": [["3\n1 2 3\n4 5 6\n7 8 9", "0 998244335 998244338 1 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线性代数", "高斯消元", "模板题"], "title": "【模板】特征多项式", "background": "这是一道模板题。", "description": "给出 $n$ 和一个 $n\\times n$ 的矩阵 $A$，在模 $998244353$ 意义下求其特征多项式。", "inputFormat": "第一行一个正整数 $n$。\\\n接下来 $n$ 行每行 $n$ 个非负整数，表示矩阵 $A$。", "outputFormat": "输出一行 $n+1$ 个正整数，表示其特征多项式 $p_A(x)$ 从低到高的系数。", "hint": "对于一个 $n\\times n$ 的矩阵 $A$，设其特征多项式为 $p_A(x)$，满足\n$$p_A(x)=\\det(xI_n-A)$$\n其中，$I_n$ 为一个 $n\\times n$ 的单位矩阵。\n\n对于 $10\\%$ 的数据，$1\\le n\\le 5$；\\\n对于 $40\\%$ 的数据，$1\\le n\\le 50$；\\\n对于另外 $10\\%$ 的数据，$\\forall1\\le i\\le n,1\\le j\\le i-1,A_{i,j}=0$，即 $A$ 为上三角矩阵；\\\n对于另外 $20\\%$ 的数据，$\\forall1\\le i\\le n,1\\le j\\le i-2,A_{i,j}=0$，即 $A$ 为上海森堡矩阵；\\\n对于 $100\\%$ 的数据，$1\\le n\\le 500$，$A_{i,j}\\in[0,998244352]$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】特征多项式", "background": "这是一道模板题。", "description": "给出 $n$ 和一个 $n\\times n$ 的矩阵 $A$，在模 $998244353$ 意义下求其特征多项式。", "inputFormat": "第一行一个正整数 $n$。\\\n接下来 $n$ 行每行 $n$ 个非负整数，表示矩阵 $A$。", "outputFormat": "输出一行 $n+1$ 个正整数，表示其特征多项式 $p_A(x)$ 从低到高的系数。", "hint": "对于一个 $n\\times n$ 的矩阵 $A$，设其特征多项式为 $p_A(x)$，满足\n$$p_A(x)=\\det(xI_n-A)$$\n其中，$I_n$ 为一个 $n\\times n$ 的单位矩阵。\n\n对于 $10\\%$ 的数据，$1\\le n\\le 5$；\\\n对于 $40\\%$ 的数据，$1\\le n\\le 50$；\\\n对于另外 $10\\%$ 的数据，$\\forall1\\le i\\le n,1\\le j\\le i-1,A_{i,j}=0$，即 $A$ 为上三角矩阵；\\\n对于另外 $20\\%$ 的数据，$\\forall1\\le i\\le n,1\\le j\\le i-2,A_{i,j}=0$，即 $A$ 为上海森堡矩阵；\\\n对于 $100\\%$ 的数据，$1\\le n\\le 500$，$A_{i,j}\\in[0,998244352]$。", "locale": "zh-CN"}}}
{"pid": "P7777", "type": "P", "difficulty": 3, "samples": [["2\n5 2 3\n4 1 5", "8\n8"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "贪心"], "title": "『JROI-2』Shelter", "background": "And it's a long way forward        \nSo trust in me       \nI'll give them shelter like you've done for me       \nAnd I know, I'm not alone         \nYou'll be watching over us       \nUntil ...        \n\n一个小女孩斜躺在一个驾驶舱的椅子上，长发从肩膀上飘落到地上。     \n她的嘴角绽放出微笑，身旁的显示屏写着 “返回 第三行星”。       \n她怀里的泰迪熊身上写着她的名字，Rin。\n\n—— [Shelter](https://www.bilibili.com/video/BV1ys41147Gv)\n\n---\n\n", "description": "Rin 和爸爸还在地球上时，他们经常玩一个石子游戏。\n\n爸爸摆出了 $n$ 堆石子，这 $n$ 堆石子编号为 $1$ 到 $n$。\n\n游戏规则是这样的，每次 Rin 可以抓取石子，有两种抓取方式：\n\n- 选择一个数 $i$，把第 $i$ 堆石子抓取走，代价为 $i \\times p$。\n- 选择两个数 $i,j$，把第 $i$ 堆和第 $j$ 堆石子抓走，代价为 $|i-j| \\times q$。\n\n其中 $p,q$ 为爸爸提前定好的常数。\n\nRin 想知道，抓取完所有石子至少需要多少代价。\n\n还剩 1919810114514 秒第三行星的灾难就要降临了，爸爸还需要 1919810114513.7 秒的时间把 Rin 安放到驾驶舱里，并启动机器让 Rin 进入 “Shelter” 里，因此，你只有 0.3 秒的时间帮助 Rin 算出这个结果哦！", "inputFormat": "**本题多测**，第一行一个整数 $T$ 代表数据组数。     \n接下来 $t$ 行，每行三个整数 $n,p,q$ 代表石子堆数，和两个常数。", "outputFormat": "$T$ 行每行一个整数代表答案。", "hint": "#### 样例 1 解释\n\n第一组数据：\n\n1. 利用第一个操作，拿走第 $1$ 堆石子，代价为 $1 \\times 2=2$。\n2. 利用第二个操作，拿走第 $2,3$ 堆石子，代价为 $|2-3| \\times 3=3$。\n3. 利用第二个操作，拿走第 $4,5$ 堆石子，代价为 $|4-5| \\times 3=3$。\n\n最小代价为 $2+3+3=8$。\n\n第二组数据：\n\n1. 利用第一个操作，拿走第 $1$ 堆石子，代价为 $1 \\times 1=1$。\n2. 利用第一个操作，拿走第 $2$ 堆石子，代价为 $2 \\times 1=2$。\n3. 利用第二个操作，拿走第 $3,4$ 堆石子，代价为 $|3-4| \\times 5=5$。\n\n最小代价为 $1+2+5=8$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 pts）：$p,q =0$。\n- Subtask 2（1 pts）：$n=1$。\n- Subtask 3（30 pts）：$T \\le 5 \\times 10^4$，$n \\le 5 \\times 10^5$。\n- Subtask 4（33 pts）：$T \\le 10^6$，$n \\le 5 \\times 10^5$。\n- Subtask 5（35 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^9$，$0 \\le p,q \\le 100$，$1 \\le T \\le 10^6$。\n\n附件中的 Extra Example 满足 $T=10^4$，可供调试使用。\n\n\n-----\nSource：[JROI-2 Summer Fun Round](https://www.luogu.com.cn/contest/30241) - T1\n\nIdea&Sol：[一只书虫仔](/user/114914)\n\nStd&Data：[Tony2](/user/171288)\n\nRetest：[Cocoly1990](/user/183026)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-2』Shelter", "background": "And it's a long way forward        \nSo trust in me       \nI'll give them shelter like you've done for me       \nAnd I know, I'm not alone         \nYou'll be watching over us       \nUntil ...        \n\n一个小女孩斜躺在一个驾驶舱的椅子上，长发从肩膀上飘落到地上。     \n她的嘴角绽放出微笑，身旁的显示屏写着 “返回 第三行星”。       \n她怀里的泰迪熊身上写着她的名字，Rin。\n\n—— [Shelter](https://www.bilibili.com/video/BV1ys41147Gv)\n\n---\n\n", "description": "Rin 和爸爸还在地球上时，他们经常玩一个石子游戏。\n\n爸爸摆出了 $n$ 堆石子，这 $n$ 堆石子编号为 $1$ 到 $n$。\n\n游戏规则是这样的，每次 Rin 可以抓取石子，有两种抓取方式：\n\n- 选择一个数 $i$，把第 $i$ 堆石子抓取走，代价为 $i \\times p$。\n- 选择两个数 $i,j$，把第 $i$ 堆和第 $j$ 堆石子抓走，代价为 $|i-j| \\times q$。\n\n其中 $p,q$ 为爸爸提前定好的常数。\n\nRin 想知道，抓取完所有石子至少需要多少代价。\n\n还剩 1919810114514 秒第三行星的灾难就要降临了，爸爸还需要 1919810114513.7 秒的时间把 Rin 安放到驾驶舱里，并启动机器让 Rin 进入 “Shelter” 里，因此，你只有 0.3 秒的时间帮助 Rin 算出这个结果哦！", "inputFormat": "**本题多测**，第一行一个整数 $T$ 代表数据组数。     \n接下来 $t$ 行，每行三个整数 $n,p,q$ 代表石子堆数，和两个常数。", "outputFormat": "$T$ 行每行一个整数代表答案。", "hint": "#### 样例 1 解释\n\n第一组数据：\n\n1. 利用第一个操作，拿走第 $1$ 堆石子，代价为 $1 \\times 2=2$。\n2. 利用第二个操作，拿走第 $2,3$ 堆石子，代价为 $|2-3| \\times 3=3$。\n3. 利用第二个操作，拿走第 $4,5$ 堆石子，代价为 $|4-5| \\times 3=3$。\n\n最小代价为 $2+3+3=8$。\n\n第二组数据：\n\n1. 利用第一个操作，拿走第 $1$ 堆石子，代价为 $1 \\times 1=1$。\n2. 利用第一个操作，拿走第 $2$ 堆石子，代价为 $2 \\times 1=2$。\n3. 利用第二个操作，拿走第 $3,4$ 堆石子，代价为 $|3-4| \\times 5=5$。\n\n最小代价为 $1+2+5=8$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 pts）：$p,q =0$。\n- Subtask 2（1 pts）：$n=1$。\n- Subtask 3（30 pts）：$T \\le 5 \\times 10^4$，$n \\le 5 \\times 10^5$。\n- Subtask 4（33 pts）：$T \\le 10^6$，$n \\le 5 \\times 10^5$。\n- Subtask 5（35 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^9$，$0 \\le p,q \\le 100$，$1 \\le T \\le 10^6$。\n\n附件中的 Extra Example 满足 $T=10^4$，可供调试使用。\n\n\n-----\nSource：[JROI-2 Summer Fun Round](https://www.luogu.com.cn/contest/30241) - T1\n\nIdea&Sol：[一只书虫仔](/user/114914)\n\nStd&Data：[Tony2](/user/171288)\n\nRetest：[Cocoly1990](/user/183026)", "locale": "zh-CN"}}}
{"pid": "P7778", "type": "P", "difficulty": 3, "samples": [["8 2\n-7 7\n-11 5\n-3 4\n-5 3\n4 0\n0 -2\n5 -2\n13 2\n15 -2\n", "249561142\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "计算几何", "2021", "O2优化"], "title": "『JROI-2』Dancing Line", "background": "> 若唤音乐随直线走动，那么你的双眸就是无穷。\n\nk 舔喜欢玩 Dancing Line。\n\nk 舔决定自己做一个 Dancing Line 关卡。", "description": "注：本题不考虑「迷宫」等线转向方式特殊，「足球」等传送线，「钢琴」等飞跃落地的情况。\n\n众所周知，Dancing Line 的路线是一条折线，每次点击会使线的前进方向**顺时针或逆时针旋转 $90^\\circ$**，且**任意相邻两次旋转方向不同**。\n\n比如下面是合法的路径（路径**不一定要随着平面直角坐标系的网格行走**）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zuh1rvxz.png)  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5gct7zuf.png)\n\n而下面是不合法的路径：\n\n旋转角度不为 $90^\\circ$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kg8d4571.png)  \n\n连续两次向左转弯：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6hfn6cxe.png)  \n\n显然不符合要求的路径：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lm76sj88.png)\n\nk 舔将路线放进了二维坐标系内，并记下了路线的**起点**、**终点**和**拐弯点**的坐标（横纵坐标**均为整数**），放进文件里就离开了。\n\n等到 k 舔回来打开电脑时，发现他文件里的数据全部乱掉了，各点的坐标不再像之前那样按顺序存储好，而是按一种奇怪的顺序排列好了。\n\nk 舔想要根据这些数据来重新复原这条路线，他还想要估计这个关卡的难度，用 $s$ 来表示：\n\n$$s=\\sum\\limits_{i=1}^{n}{t_i^2},t_i=\\dfrac{d(P_{i-1},P_i)}{v}$$\n\n其中：\n\n- $P_i(0\\leq i\\leq n)$ 表示路线**复原后**从起点开始的第 $i$ 个点（起点为 $P_0$，终点为 $P_n$）。\n- $v$ 为线的速度，是一个给定的**正整数**。\n- $d(A,B)$ 表示点 $A$ 和点 $B$ 在坐标轴内的距离。\n\n你能帮助他吗？", "inputFormat": "第一行两个正整数 $n,v$，意义如上。\n\n接下来 $n+1$ 行，每行两个整数，表示**复原前**文件内各点的坐标。", "outputFormat": "一个数 $s$，意义如上，输出其对 $998244353$ 取模的结果。\n\n具体来讲，设其用最简分数的方式表示为 $\\dfrac{x}{y}$，你需要输出满足 $ys\\equiv x\\pmod{998244353}$ 的最小非负整数，在本题中你需要输出 $x\\times y^{998244351}\\bmod 998244353$。", "hint": "**样例解释**\n\n对于样例一，路线如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1a4dp2si.png)\n\n各段长度分别为 $2\\sqrt{5},2\\sqrt{5},\\sqrt{5},3\\sqrt{5},2\\sqrt{5},\\sqrt{5},4\\sqrt{5},2\\sqrt{5}$，$s$ 值为 $53\\dfrac{3}{4}$，取模后结果为 $249561142$。\n\n------------\n\n**数据范围与约定**\n\n本题采用**捆绑测试**。\n\n- Subtask 1（5 pts）：$n\\leq 6$。\n- Subtask 2（15 pts）：$n\\leq 80$。\n- Subtask 3（30 pts）：$n\\leq 800$。\n- Subtask 4（50 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足：\n\n- $2\\leq n \\leq 10^6$。\n- $-10^9\\leq x_i,y_i\\leq 10^9$。\n- $1\\leq v\\leq 10^7$。\n- **保证所有点坐标各不相同**。\n- **保证给出的点一定能且只能复原出唯一的路径。**\n\n------------\n\n$d(A,B)=\\sqrt{(x_A-x_B)^2+(y_A-y_B)^2}$，其中 $A(x_A,y_A),B(x_B,y_B)$。\n\n-----\nSource：[JROI-2 Summer Fun Round](https://www.luogu.com.cn/contest/30241) - T3\n\nIdea&Sol&Data：[kkk的小舔狗](/user/104581)\n\nStd&Retest：[Tony2](/user/171288)\n\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-2』Dancing Line", "background": "> 若唤音乐随直线走动，那么你的双眸就是无穷。\n\nk 舔喜欢玩 Dancing Line。\n\nk 舔决定自己做一个 Dancing Line 关卡。", "description": "注：本题不考虑「迷宫」等线转向方式特殊，「足球」等传送线，「钢琴」等飞跃落地的情况。\n\n众所周知，Dancing Line 的路线是一条折线，每次点击会使线的前进方向**顺时针或逆时针旋转 $90^\\circ$**，且**任意相邻两次旋转方向不同**。\n\n比如下面是合法的路径（路径**不一定要随着平面直角坐标系的网格行走**）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zuh1rvxz.png)  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5gct7zuf.png)\n\n而下面是不合法的路径：\n\n旋转角度不为 $90^\\circ$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kg8d4571.png)  \n\n连续两次向左转弯：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6hfn6cxe.png)  \n\n显然不符合要求的路径：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lm76sj88.png)\n\nk 舔将路线放进了二维坐标系内，并记下了路线的**起点**、**终点**和**拐弯点**的坐标（横纵坐标**均为整数**），放进文件里就离开了。\n\n等到 k 舔回来打开电脑时，发现他文件里的数据全部乱掉了，各点的坐标不再像之前那样按顺序存储好，而是按一种奇怪的顺序排列好了。\n\nk 舔想要根据这些数据来重新复原这条路线，他还想要估计这个关卡的难度，用 $s$ 来表示：\n\n$$s=\\sum\\limits_{i=1}^{n}{t_i^2},t_i=\\dfrac{d(P_{i-1},P_i)}{v}$$\n\n其中：\n\n- $P_i(0\\leq i\\leq n)$ 表示路线**复原后**从起点开始的第 $i$ 个点（起点为 $P_0$，终点为 $P_n$）。\n- $v$ 为线的速度，是一个给定的**正整数**。\n- $d(A,B)$ 表示点 $A$ 和点 $B$ 在坐标轴内的距离。\n\n你能帮助他吗？", "inputFormat": "第一行两个正整数 $n,v$，意义如上。\n\n接下来 $n+1$ 行，每行两个整数，表示**复原前**文件内各点的坐标。", "outputFormat": "一个数 $s$，意义如上，输出其对 $998244353$ 取模的结果。\n\n具体来讲，设其用最简分数的方式表示为 $\\dfrac{x}{y}$，你需要输出满足 $ys\\equiv x\\pmod{998244353}$ 的最小非负整数，在本题中你需要输出 $x\\times y^{998244351}\\bmod 998244353$。", "hint": "**样例解释**\n\n对于样例一，路线如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1a4dp2si.png)\n\n各段长度分别为 $2\\sqrt{5},2\\sqrt{5},\\sqrt{5},3\\sqrt{5},2\\sqrt{5},\\sqrt{5},4\\sqrt{5},2\\sqrt{5}$，$s$ 值为 $53\\dfrac{3}{4}$，取模后结果为 $249561142$。\n\n------------\n\n**数据范围与约定**\n\n本题采用**捆绑测试**。\n\n- Subtask 1（5 pts）：$n\\leq 6$。\n- Subtask 2（15 pts）：$n\\leq 80$。\n- Subtask 3（30 pts）：$n\\leq 800$。\n- Subtask 4（50 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足：\n\n- $2\\leq n \\leq 10^6$。\n- $-10^9\\leq x_i,y_i\\leq 10^9$。\n- $1\\leq v\\leq 10^7$。\n- **保证所有点坐标各不相同**。\n- **保证给出的点一定能且只能复原出唯一的路径。**\n\n------------\n\n$d(A,B)=\\sqrt{(x_A-x_B)^2+(y_A-y_B)^2}$，其中 $A(x_A,y_A),B(x_B,y_B)$。\n\n-----\nSource：[JROI-2 Summer Fun Round](https://www.luogu.com.cn/contest/30241) - T3\n\nIdea&Sol&Data：[kkk的小舔狗](/user/104581)\n\nStd&Retest：[Tony2](/user/171288)\n\n\n", "locale": "zh-CN"}}}
{"pid": "P7779", "type": "P", "difficulty": 6, "samples": [["4\n10\n13\n16\n19\n", "1\n4\n5\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "数论", "不定方程"], "title": "『JROI-2 / Stoi2039』等你下课", "background": "![](bilibili:BV1hW411v7GC)", "description": "给定正整数 $d$，定义\n\n$$S_v=\\{(x,y):x,y \\in \\mathbb{Z_{\\ge 0}},x^2-dy^2=v\\}$$\n\n求：\n\n$$\\sum_{v=1}^{\\lfloor\\sqrt{d}\\rfloor}v[S_v \\neq \\varnothing]$$\n\n多组询问。", "inputFormat": "第一行一个正整数 $t$ 表示询问次数。\n\n接下来 $t$ 行，每行一个正整数 $d$ 表示一次询问。", "outputFormat": "对于每次询问输出一行一个整数表示答案。", "hint": "#### 样例解释\n\n- 对于 $d=10$，只有 $v=1$ 满足 $S_v \\neq \\varnothing$。\n- 对于 $d=13$，有 $v=1,3$ 满足 $S_v \\neq \\varnothing$。\n- 对于 $d=16$，有 $v=1,4$ 满足 $S_v \\neq \\varnothing$。\n- 对于 $d=19$，有 $v=1,4$ 满足 $S_v \\neq \\varnothing$。\n\n#### 数据范围\n\n- 对于 $30\\%$ 的数据，$t=1$，$1 \\le d \\le 70$。\n- 对于 $60\\%$ 的数据，$t=1$。\n- 对于 $100\\%$ 的数据，$1 \\le t \\le 4 \\times 10^3$，$1 \\le d \\le 2 \\times 10^6$。\n\n-----\nSource：[JROI-2 Summer Fun Round](https://www.luogu.com.cn/contest/30241) - T4\n\nIdea&Sol&Std&Data：[VinstaG173](/user/59388)\n\nRetest：None", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-2 / Stoi2039』等你下课", "background": "![](bilibili:BV1hW411v7GC)", "description": "给定正整数 $d$，定义\n\n$$S_v=\\{(x,y):x,y \\in \\mathbb{Z_{\\ge 0}},x^2-dy^2=v\\}$$\n\n求：\n\n$$\\sum_{v=1}^{\\lfloor\\sqrt{d}\\rfloor}v[S_v \\neq \\varnothing]$$\n\n多组询问。", "inputFormat": "第一行一个正整数 $t$ 表示询问次数。\n\n接下来 $t$ 行，每行一个正整数 $d$ 表示一次询问。", "outputFormat": "对于每次询问输出一行一个整数表示答案。", "hint": "#### 样例解释\n\n- 对于 $d=10$，只有 $v=1$ 满足 $S_v \\neq \\varnothing$。\n- 对于 $d=13$，有 $v=1,3$ 满足 $S_v \\neq \\varnothing$。\n- 对于 $d=16$，有 $v=1,4$ 满足 $S_v \\neq \\varnothing$。\n- 对于 $d=19$，有 $v=1,4$ 满足 $S_v \\neq \\varnothing$。\n\n#### 数据范围\n\n- 对于 $30\\%$ 的数据，$t=1$，$1 \\le d \\le 70$。\n- 对于 $60\\%$ 的数据，$t=1$。\n- 对于 $100\\%$ 的数据，$1 \\le t \\le 4 \\times 10^3$，$1 \\le d \\le 2 \\times 10^6$。\n\n-----\nSource：[JROI-2 Summer Fun Round](https://www.luogu.com.cn/contest/30241) - T4\n\nIdea&Sol&Std&Data：[VinstaG173](/user/59388)\n\nRetest：None", "locale": "zh-CN"}}}
{"pid": "P7780", "type": "P", "difficulty": 3, "samples": [["5 5 2\n1 1\n2 1\n3 1\n4 1\n5 1", "25\n17\n11\n7\n5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "「MCOI-Zero / AC6-M01」Invasion of Gracemeria", "background": "我们的首都 Gracemeria 正在遭受不明势力袭击！\n\n空袭造成的破坏遍布全城。\n\n全机，立刻紧急升空迎击！\n\n---\n\n「Garuda 1，你可以起飞了。」\n\n……\n\n「Garuda 1，升空。Cerberus 队，跑道已经清空，你们准备好了就起飞。」\n\n「所有飞机升空后听从 AWACS 的命令。」\n\n「这不是演习。重复一遍，这不是演习！」\n\n……\n\n「这里是 AWACS Ghost Eye。」\n\n……\n\n「Garuda 1，你没僚机。」\n\n「让我看看……   \n　Shamrock。」\n \n「你也是单机一架，对吗？」\n\n「很好。   \n　从现在起你就是 Garuda 2 了。」\n \n「你好，这里是 Garuda 2。」\n\n「没时间自我介绍了，快。   \n　Garuda 1，加速，我会跟上。」\n\n「尽管给我命令就好。」\n\n「Garuda 队，你们已经可以同 Gracemeria 上空的敌军交战。」\n\n……\n\n**「May the Golden King smiles on us！！」**\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 01} \\\\\\Large\\text{Invasion Of Gracemeria}\\\\\\tiny -\\textit{ Through the Heart Of a Nation }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nd20pe59.png)", "description": "给定一个长度为 $n$ 的序列 $a$，初始都是 $0$，和一个正整数 $k$。\n\n现有 $q$ 次操作，每次操作给定 $i,v$，表示给序列 $a$ 的后缀 $a_{[i,n]}$ 加上 $v$。\n\n每次操作后，请你输出 **所有数在序列中出现次数的 $k$ 次方和** 对 $20051131$ 取模的结果。\n\n$20051131$ 是质数。", "inputFormat": "第一行三个整数 $n,q,k$。\n\n接下来 $q$ 行，每行两个整数，表示这次操作的 $i,v$。", "outputFormat": "$q$ 行，每行一个整数，表示这次操作之后所有数在序列中出现次数的 $k$ 次方和对 $20051131$ 取模的值。", "hint": "第一次操作后，有 $5$ 个 $1$，答案为 $5^2=25$。\n\n第二次操作后，有 $1$ 个 $1$ 和 $4$ 个 $2$，答案为 $1^2+4^2=17$。\n\n类似的，答案分别为 $1^2+1^2+3^2=11,1^2+1^2+1^2+2^2=7,5\\times 1^2=5$。\n\n---\n\n- Subtask 1（20 pts）：$n,q\\leq 2\\times 10^3$。\n- Subtask 2（40 pts）：$n\\leq 2\\times 10^3$。\n- Subtask 3（40 pts）：无特殊限制。\n\n对 $100\\%$ 的数据，保证 $1\\leq n,v,k\\leq 20051130$，$1\\leq q\\leq 5\\times 10^5$，$1\\leq i\\leq n$。\n\nidea：Sol1，solution：Sol1，code：Sol1，data：Sol1 & 斜揽残箫", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-Zero / AC6-M01」Invasion of Gracemeria", "background": "我们的首都 Gracemeria 正在遭受不明势力袭击！\n\n空袭造成的破坏遍布全城。\n\n全机，立刻紧急升空迎击！\n\n---\n\n「Garuda 1，你可以起飞了。」\n\n……\n\n「Garuda 1，升空。Cerberus 队，跑道已经清空，你们准备好了就起飞。」\n\n「所有飞机升空后听从 AWACS 的命令。」\n\n「这不是演习。重复一遍，这不是演习！」\n\n……\n\n「这里是 AWACS Ghost Eye。」\n\n……\n\n「Garuda 1，你没僚机。」\n\n「让我看看……   \n　Shamrock。」\n \n「你也是单机一架，对吗？」\n\n「很好。   \n　从现在起你就是 Garuda 2 了。」\n \n「你好，这里是 Garuda 2。」\n\n「没时间自我介绍了，快。   \n　Garuda 1，加速，我会跟上。」\n\n「尽管给我命令就好。」\n\n「Garuda 队，你们已经可以同 Gracemeria 上空的敌军交战。」\n\n……\n\n**「May the Golden King smiles on us！！」**\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 01} \\\\\\Large\\text{Invasion Of Gracemeria}\\\\\\tiny -\\textit{ Through the Heart Of a Nation }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nd20pe59.png)", "description": "给定一个长度为 $n$ 的序列 $a$，初始都是 $0$，和一个正整数 $k$。\n\n现有 $q$ 次操作，每次操作给定 $i,v$，表示给序列 $a$ 的后缀 $a_{[i,n]}$ 加上 $v$。\n\n每次操作后，请你输出 **所有数在序列中出现次数的 $k$ 次方和** 对 $20051131$ 取模的结果。\n\n$20051131$ 是质数。", "inputFormat": "第一行三个整数 $n,q,k$。\n\n接下来 $q$ 行，每行两个整数，表示这次操作的 $i,v$。", "outputFormat": "$q$ 行，每行一个整数，表示这次操作之后所有数在序列中出现次数的 $k$ 次方和对 $20051131$ 取模的值。", "hint": "第一次操作后，有 $5$ 个 $1$，答案为 $5^2=25$。\n\n第二次操作后，有 $1$ 个 $1$ 和 $4$ 个 $2$，答案为 $1^2+4^2=17$。\n\n类似的，答案分别为 $1^2+1^2+3^2=11,1^2+1^2+1^2+2^2=7,5\\times 1^2=5$。\n\n---\n\n- Subtask 1（20 pts）：$n,q\\leq 2\\times 10^3$。\n- Subtask 2（40 pts）：$n\\leq 2\\times 10^3$。\n- Subtask 3（40 pts）：无特殊限制。\n\n对 $100\\%$ 的数据，保证 $1\\leq n,v,k\\leq 20051130$，$1\\leq q\\leq 5\\times 10^5$，$1\\leq i\\leq n$。\n\nidea：Sol1，solution：Sol1，code：Sol1，data：Sol1 & 斜揽残箫", "locale": "zh-CN"}}}
{"pid": "P7781", "type": "P", "difficulty": 6, "samples": [["3\n1 2 3", "0\n1\n14"], ["8\n3 2 4 1 6 8 7 5", "16\n39\n132\n476\n2842\n21137\n172002\n1427424"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["递推", "树状数组", "O2优化", "组合数学", "排列组合"], "title": "「MCOI-Zero / AC6-M07」Selumna Peak", "background": "「Now that's what I call squadron！」\n\n「Come on, it's payback time.」\n\n**「Gracemeria is dead ahead！！」**\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 07} \\\\\\Large\\text{Selumna Peak}\\\\\\tiny-\\textit{ Shimmering Death }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/owa6qtg4.png)", "description": "给定 $1\\sim n$ 的排列 $a_{[1,n]}$。\n\n请对于每一个 $i$，考虑如下操作序列：\n\n1. 首先在 $[1,i]$ 中选取一个子序列（可以为空）；\n2. 然后将这个子序列内的数重新排列。\n\n求出 **所有不同的操作序列产生的排列** 的逆序对数总和是多少，答案模 $20051131$。\n\n两个操作序列不同当且仅当选取的子序列不同或重新排列的方式不同。\n\n操作不会真正被执行到排列上。", "inputFormat": "第一行一个整数 $n$。\n\n接下来一行 $n$ 个数，表示排列 $a$。", "outputFormat": "$n$ 行，每行一个数，表示对于前缀 $[1,i]$ 所有不同的操作序列产生的排列的逆序对数总和模 $20051131$ 的值。", "hint": "样例 1 解释：\n\n- 对于 $[1,1]$，无法产生逆序对，答案为 $0$。\n- 对于 $[1,2]$，只有一种操作序列可以产生 $2,1,3$，答案为 $1$。\n- 对于 $[1,3]$：\n\t- 有 $8$ 种操作序列产生 $1,2,3$；\n   - 有 $2$ 种操作序列产生 $1,3,2$；\n   - 有 $2$ 种操作序列产生 $2,1,3$；\n   - 有 $1$ 种操作序列产生 $2,3,1$；\n   - 有 $1$ 种操作序列产生 $3,1,2$；\n   - 有 $2$ 种操作序列产生 $3,2,1$；\n- 答案为 $0\\times 8+1\\times 2+1\\times 2+2\\times 1+2\\times 1+2\\times 3=14$。\n\n样例 2 解释：\n\n- 对于 $i=1$，只有两种操作序列，产生的排列都有 $8$ 个逆序对，故答案是 $16$。\n- 对于 $i=2$，有 $4$ 种操作序列产生 $3, 2, 4, 1, 6, 8, 7, 5$，有 $1$ 种操作序列产生 $2,3,4,1,6,8,7,5$，答案为 $8\\times 4+7\\times 1=39$。\n\n数据范围：\n\n- Subtask 1（10%）：$n\\leq 8$。\n- Subtask 2（20%）：$n\\leq 50$。\n- Subtask 3（20%）：$n\\leq 300$。\n- Subtask 4（20%）：$n\\leq 3\\times 10^3$。\n- Subtask 5（30%）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 10^6$。\n\nidea：Sol1，solution：Sol1，code：Sol1，data：Sol1", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-Zero / AC6-M07」Selumna Peak", "background": "「Now that's what I call squadron！」\n\n「Come on, it's payback time.」\n\n**「Gracemeria is dead ahead！！」**\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 07} \\\\\\Large\\text{Selumna Peak}\\\\\\tiny-\\textit{ Shimmering Death }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/owa6qtg4.png)", "description": "给定 $1\\sim n$ 的排列 $a_{[1,n]}$。\n\n请对于每一个 $i$，考虑如下操作序列：\n\n1. 首先在 $[1,i]$ 中选取一个子序列（可以为空）；\n2. 然后将这个子序列内的数重新排列。\n\n求出 **所有不同的操作序列产生的排列** 的逆序对数总和是多少，答案模 $20051131$。\n\n两个操作序列不同当且仅当选取的子序列不同或重新排列的方式不同。\n\n操作不会真正被执行到排列上。", "inputFormat": "第一行一个整数 $n$。\n\n接下来一行 $n$ 个数，表示排列 $a$。", "outputFormat": "$n$ 行，每行一个数，表示对于前缀 $[1,i]$ 所有不同的操作序列产生的排列的逆序对数总和模 $20051131$ 的值。", "hint": "样例 1 解释：\n\n- 对于 $[1,1]$，无法产生逆序对，答案为 $0$。\n- 对于 $[1,2]$，只有一种操作序列可以产生 $2,1,3$，答案为 $1$。\n- 对于 $[1,3]$：\n\t- 有 $8$ 种操作序列产生 $1,2,3$；\n   - 有 $2$ 种操作序列产生 $1,3,2$；\n   - 有 $2$ 种操作序列产生 $2,1,3$；\n   - 有 $1$ 种操作序列产生 $2,3,1$；\n   - 有 $1$ 种操作序列产生 $3,1,2$；\n   - 有 $2$ 种操作序列产生 $3,2,1$；\n- 答案为 $0\\times 8+1\\times 2+1\\times 2+2\\times 1+2\\times 1+2\\times 3=14$。\n\n样例 2 解释：\n\n- 对于 $i=1$，只有两种操作序列，产生的排列都有 $8$ 个逆序对，故答案是 $16$。\n- 对于 $i=2$，有 $4$ 种操作序列产生 $3, 2, 4, 1, 6, 8, 7, 5$，有 $1$ 种操作序列产生 $2,3,4,1,6,8,7,5$，答案为 $8\\times 4+7\\times 1=39$。\n\n数据范围：\n\n- Subtask 1（10%）：$n\\leq 8$。\n- Subtask 2（20%）：$n\\leq 50$。\n- Subtask 3（20%）：$n\\leq 300$。\n- Subtask 4（20%）：$n\\leq 3\\times 10^3$。\n- Subtask 5（30%）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 10^6$。\n\nidea：Sol1，solution：Sol1，code：Sol1，data：Sol1", "locale": "zh-CN"}}}
{"pid": "P7782", "type": "P", "difficulty": 6, "samples": [["5 1 3\n1 1 2 2", "7\n9\n4\n4\n4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "「MCOI-Zero / AC6-M03」 Sipli Field", "background": "You've been ordered to start the mission now. \n\nThe interception op was a success, enemy air units around Khesed have been weakened, and the Republic of Emmeria's military has taken advantage of this prime opportunity to initiate a counterattack operation with all forces participating. \n\nEnemy forces have established a wide-scale defensive line around Sipli Field, consisting largely of tank battalions.\n\nOur ground forces are set up to cross the river and penetrate it, and eventually gain control of Khesed. \n\nGaruda Team, we need you to support our advancing ground units, and eliminate all enemy forces. Multiple units will be simultaneously carrying out various operations on the ground. \n\nPay attention to the airspace above each operation area, and provide support as needed. \n\nThis must be the first time you've ever participated in a mission of this scale. \n\nThe battle simulator is a good way to get some practical experience under your belt. \n\nGodspeed.\n\n\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 03} \\\\\\Large\\text{Sipli Field}\\\\\\tiny -\\textit{ Fortunes of War\n }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/az0t8iij.png)", "description": "给定一个 $n$ 个点的树，和两个常数 $L,R$。\n\n请对于每一个点 $u$ 求出有多少条路径过 $u$ 且长度 $d\\in [L,R]$。", "inputFormat": "第一行三个整数 $n,L,R$。\n\n接下来 $n-1$ 个整数，第 $i$ 个整数 $f_i$ 代表存在一条 $f_i\\leftrightarrow i+1$ 的双向边。", "outputFormat": "$n$ 行，每行一个整数，表示对应点的答案。", "hint": "样例 1 解释：\n\n- 过 1 的路径：1-2, 1-3, 1-4, 1-5, 2-3, 4-3, 5-3\n- 过 2 的路径：2-1, 2-3, 2-4, 2-5, 1-4, 1-5, 3-4, 3-5, 4-5\n- 过 3 的路径：3-1, 3-2, 3-4, 3-5\n- 过 4 的路径：4-1, 4-2, 4-3, 4-5\n- 过 5 的路径：5-1, 5-2, 5-3, 5-4\n\n---\n\n- Subtask 1（3 pts）：$R=1$。\n- Subtask 2（7 pts）：$R\\leq 2$。\n- Subtask 3（10 pts）：$n\\leq 100$。\n- Subtask 4（10 pts）：$n\\leq 2\\times 10^3$。\n- Subtask 5（15 pts）：$n\\leq 10^5,L=1,R=n$。\n- Subtask 6（15 pts）：$n\\leq 10^5,L=R$。\n- Subtask 7（20 pts）：$n\\leq 10^5$。\n- Subtask 8（20 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 10^6$，$1\\leq L\\leq R\\leq n$。\n\nidea：\\_Solowing\\_ClCN，solution：\\_Solowing\\_ClCN，code：\\_Solowing\\_ClCN，data：\\_Solowing\\_ClCN", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-Zero / AC6-M03」 Sipli Field", "background": "You've been ordered to start the mission now. \n\nThe interception op was a success, enemy air units around Khesed have been weakened, and the Republic of Emmeria's military has taken advantage of this prime opportunity to initiate a counterattack operation with all forces participating. \n\nEnemy forces have established a wide-scale defensive line around Sipli Field, consisting largely of tank battalions.\n\nOur ground forces are set up to cross the river and penetrate it, and eventually gain control of Khesed. \n\nGaruda Team, we need you to support our advancing ground units, and eliminate all enemy forces. Multiple units will be simultaneously carrying out various operations on the ground. \n\nPay attention to the airspace above each operation area, and provide support as needed. \n\nThis must be the first time you've ever participated in a mission of this scale. \n\nThe battle simulator is a good way to get some practical experience under your belt. \n\nGodspeed.\n\n\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 03} \\\\\\Large\\text{Sipli Field}\\\\\\tiny -\\textit{ Fortunes of War\n }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/az0t8iij.png)", "description": "给定一个 $n$ 个点的树，和两个常数 $L,R$。\n\n请对于每一个点 $u$ 求出有多少条路径过 $u$ 且长度 $d\\in [L,R]$。", "inputFormat": "第一行三个整数 $n,L,R$。\n\n接下来 $n-1$ 个整数，第 $i$ 个整数 $f_i$ 代表存在一条 $f_i\\leftrightarrow i+1$ 的双向边。", "outputFormat": "$n$ 行，每行一个整数，表示对应点的答案。", "hint": "样例 1 解释：\n\n- 过 1 的路径：1-2, 1-3, 1-4, 1-5, 2-3, 4-3, 5-3\n- 过 2 的路径：2-1, 2-3, 2-4, 2-5, 1-4, 1-5, 3-4, 3-5, 4-5\n- 过 3 的路径：3-1, 3-2, 3-4, 3-5\n- 过 4 的路径：4-1, 4-2, 4-3, 4-5\n- 过 5 的路径：5-1, 5-2, 5-3, 5-4\n\n---\n\n- Subtask 1（3 pts）：$R=1$。\n- Subtask 2（7 pts）：$R\\leq 2$。\n- Subtask 3（10 pts）：$n\\leq 100$。\n- Subtask 4（10 pts）：$n\\leq 2\\times 10^3$。\n- Subtask 5（15 pts）：$n\\leq 10^5,L=1,R=n$。\n- Subtask 6（15 pts）：$n\\leq 10^5,L=R$。\n- Subtask 7（20 pts）：$n\\leq 10^5$。\n- Subtask 8（20 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 10^6$，$1\\leq L\\leq R\\leq n$。\n\nidea：\\_Solowing\\_ClCN，solution：\\_Solowing\\_ClCN，code：\\_Solowing\\_ClCN，data：\\_Solowing\\_ClCN", "locale": "zh-CN"}}}
{"pid": "P7783", "type": "P", "difficulty": 7, "samples": [["10 4 2\n1010\n0110\n0101\n0000\n1011\n0111\n1110\n1011\n0001\n1100\n1 10 6\n2 5 3", "2\n2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "「MCOI-Zero / AC6-M14」Gracemeria Patrol", "background": "「Talisman，一会你能不能和 Avalanche 一起出去而不是我？」\n\n「我今晚想一个人静静。」\n\n「我的妻女都死了。   \n　刚刚确认的……」\n \n 「我保护了我的国家，   \n　但我却守护不了我的家庭。」\n \n  「什么样的王牌   \n　连自己的家庭都保护不了？」\n \n 「Monica……   \n　还有 Jessica……」\n \n**「How could I let this happen！！」**\n\n 「这个任务结束之后，   \n　我将离开空军。」\n \n  「我受够了。   \n　我没有继续飞行的理由了。」\n \n ……\n\n「一个不明物体正在高速飞行   \n　在东北方。」\n\n「这是战机？在这个时候？！」\n\n「在雷达上确认未知物体，   \n　这不是战机，它的速度太快了！」\n\n「未知物体在雷达上消失了。   \n　等一下……」\n\n「一些物体在相同的方向上飞行。我认为这是……」\n\n「我看到了，这些是导弹！」\n\n「Ghost Eye，   \n　我们遭到巡航导弹袭击了！」\n\n「全机，拦截那些巡航导弹！   \n　保护我们的城市！」\n\n……\n\n「资料检查……   \n　增援的隐形飞机正在接近。」\n\n「这些人不懂得放弃吗？」\n\n『我们为了你而回来了，Emmeria！』\n\n「这些人到底是怎么了？还觉得死的人不够多吗？！」\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 14} \\\\\\Large\\text{Gracemeria Patrol}\\\\\\tiny -\\textit{ City Lights }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g0d60mgz.png)", "description": "给定一个 $n\\times m$ 的 01 矩阵，每一次操作可以改变一个位置以及其上面、左边、右边的值。如果原值是 $0$，则改变之后变成 $1$；否则变成 $0$。\n\n例如下面矩阵在改变中括号表明的位置之后的形态：\n\n$$\\begin{bmatrix}0&1&0&1&1\\\\1&0&[0]&1&0\\\\0&0&0&0&1\\end{bmatrix}\\rightarrow \\begin{bmatrix}0&1&1&1&1\\\\1&1&1&0&0\\\\0&0&0&0&1\\end{bmatrix}$$\n\n**特别的，如果操作点在边界上，那么仅改变未超出边界的部分。**\n\n现给定 $q$ 组询问，每组询问一个区间 $[l,r]$ 和一个常数 $k$，请你对行号在 $l,r$ 内的 01 子矩阵求出通过选出一些位置进行一次操作使其变为全 $0$ 的方案中，第 $k$ 行被操作了几次。\n\n特别的，如果没有或者有多种选择操作位置的方法，输出 $-1$。\n\n询问之间相互独立。", "inputFormat": "第一行三个整数 $n,m,q$。\n\n接下来 $n$ 行，每行 $m$ 个字符，给出 01 矩阵。\n\n接下来 $q$ 行，每行三个整数表示询问的 $l,r,k$。", "outputFormat": "$q$ 行，每行一个整数表示对应询问的答案。", "hint": "- Subtask 1（10 pts）：$n,m\\leq 3,q\\leq 10$。\n- Subtask 2（20 pts）：$n,m,q\\leq 10$。\n- Subtask 3（20 pts）：$n,q\\leq 50,m\\leq 10$。\n- Subtask 4（20 pts）：$n,q\\leq 10^4,m\\leq 10$。\n- Subtask 5（30 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 5\\times 10^4$，$1\\leq m\\leq 50$，$1\\leq q\\leq 5\\times 10^5$，$1\\leq l\\leq k\\leq r\\leq n$。\n\nidea：Sol1，solution：Sol1 & ethan\\_zhou，code：Sol1，data：Sol1\n\n---\n\n 「Talisman……」\n\n 「一个天使不会交出它的翅膀除非   \n　跳完最后一支舞，对不对？」", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-Zero / AC6-M14」Gracemeria Patrol", "background": "「Talisman，一会你能不能和 Avalanche 一起出去而不是我？」\n\n「我今晚想一个人静静。」\n\n「我的妻女都死了。   \n　刚刚确认的……」\n \n 「我保护了我的国家，   \n　但我却守护不了我的家庭。」\n \n  「什么样的王牌   \n　连自己的家庭都保护不了？」\n \n 「Monica……   \n　还有 Jessica……」\n \n**「How could I let this happen！！」**\n\n 「这个任务结束之后，   \n　我将离开空军。」\n \n  「我受够了。   \n　我没有继续飞行的理由了。」\n \n ……\n\n「一个不明物体正在高速飞行   \n　在东北方。」\n\n「这是战机？在这个时候？！」\n\n「在雷达上确认未知物体，   \n　这不是战机，它的速度太快了！」\n\n「未知物体在雷达上消失了。   \n　等一下……」\n\n「一些物体在相同的方向上飞行。我认为这是……」\n\n「我看到了，这些是导弹！」\n\n「Ghost Eye，   \n　我们遭到巡航导弹袭击了！」\n\n「全机，拦截那些巡航导弹！   \n　保护我们的城市！」\n\n……\n\n「资料检查……   \n　增援的隐形飞机正在接近。」\n\n「这些人不懂得放弃吗？」\n\n『我们为了你而回来了，Emmeria！』\n\n「这些人到底是怎么了？还觉得死的人不够多吗？！」\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 14} \\\\\\Large\\text{Gracemeria Patrol}\\\\\\tiny -\\textit{ City Lights }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g0d60mgz.png)", "description": "给定一个 $n\\times m$ 的 01 矩阵，每一次操作可以改变一个位置以及其上面、左边、右边的值。如果原值是 $0$，则改变之后变成 $1$；否则变成 $0$。\n\n例如下面矩阵在改变中括号表明的位置之后的形态：\n\n$$\\begin{bmatrix}0&1&0&1&1\\\\1&0&[0]&1&0\\\\0&0&0&0&1\\end{bmatrix}\\rightarrow \\begin{bmatrix}0&1&1&1&1\\\\1&1&1&0&0\\\\0&0&0&0&1\\end{bmatrix}$$\n\n**特别的，如果操作点在边界上，那么仅改变未超出边界的部分。**\n\n现给定 $q$ 组询问，每组询问一个区间 $[l,r]$ 和一个常数 $k$，请你对行号在 $l,r$ 内的 01 子矩阵求出通过选出一些位置进行一次操作使其变为全 $0$ 的方案中，第 $k$ 行被操作了几次。\n\n特别的，如果没有或者有多种选择操作位置的方法，输出 $-1$。\n\n询问之间相互独立。", "inputFormat": "第一行三个整数 $n,m,q$。\n\n接下来 $n$ 行，每行 $m$ 个字符，给出 01 矩阵。\n\n接下来 $q$ 行，每行三个整数表示询问的 $l,r,k$。", "outputFormat": "$q$ 行，每行一个整数表示对应询问的答案。", "hint": "- Subtask 1（10 pts）：$n,m\\leq 3,q\\leq 10$。\n- Subtask 2（20 pts）：$n,m,q\\leq 10$。\n- Subtask 3（20 pts）：$n,q\\leq 50,m\\leq 10$。\n- Subtask 4（20 pts）：$n,q\\leq 10^4,m\\leq 10$。\n- Subtask 5（30 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 5\\times 10^4$，$1\\leq m\\leq 50$，$1\\leq q\\leq 5\\times 10^5$，$1\\leq l\\leq k\\leq r\\leq n$。\n\nidea：Sol1，solution：Sol1 & ethan\\_zhou，code：Sol1，data：Sol1\n\n---\n\n 「Talisman……」\n\n 「一个天使不会交出它的翅膀除非   \n　跳完最后一支舞，对不对？」", "locale": "zh-CN"}}}
{"pid": "P7784", "type": "P", "difficulty": 2, "samples": [["5 6", "10\n1 9 9 9 9 10\n1 2 3 4 4 10\n1 2 3 5 5 5\n1 2 6 6 6 8\n7 7 7 7 7 8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Special Judge"], "title": "「MCOI-Zero / AC6-M15」 Chandelier", "background": "「不，还没完……」\n\n「什么！？」\n\n「炮管打开了。   \n　那个丑陋的东西开始通过炮管散热了！」\n\n「它的关键区域就在炮管后面。」\n\n「Talisman……   \n　……我们可以信任你，对吗？」\n \n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 15} \\\\\\Large\\text{Chandelier}\\\\\\tiny -\\textit{ To All Things }\n-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w6wqsh2b.png)", "description": "Chandelier 的核心可以被描述为一个 $n\\times m$ 的矩阵。初始时，矩阵中的每一个格子都是一个独立的空间。\n\n如果在核心中存在两个空间使得它们在矩阵上的并是一个矩形，则这两个空间可以合并为一个空间，合并出的空间就是原先两个空间的并。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jkzu2t0u.png)\n\n如果不存在任何两个空间的并是矩形，则我们称核心达到了稳定状态。\n\n如果一个空间的长达到了 $n$ 或者宽达到了 $m$，那么核心将会短路，引发爆炸。**注意这里空间的长指的是和原矩阵的长为 $n$ 的边平行的边的长度，宽类似。也就是说如果平行于 原矩形的长为 $n$ 的边 的边长达到了 $m$ 且 $m<n$，那么这是合法的。**\n\n核心达到了稳定状态后，你才能攻击并摧毁它，需要的攻击次数就是剩下的空间数。\n\n你剩下的弹药不多了，所以只能攻击 $10$ 次。\n\n你需要合理地控制空间的合并，使得核心在不短路的情况下达到稳定状态，且需要的攻击次数 $\\leq 10$。\n\n求出一种可能合并出来的形态。如果核心无法在不短路的情况下达到稳定或者无法合并为 $\\leq 10$ 个空间，输出 $-1$。", "inputFormat": "一行用空格分割的两个整数 $n,m$。", "outputFormat": "如果无解，输出一行 `-1`。\n\n如果有解，在第一行输出一个整数 $x$，表示空间数量。\n\n然后输出一个 $n\\times m$ 的矩阵 $a$，满足 $1\\leq a_{i,j}\\leq x$。$a_{i,j}$ 表示 $(i,j)$ 属于哪一个空间。相同的数代表相同的空间，不同的数代表不同的空间。\n\n如果有多解，输出任意一个即可。", "hint": "- Subtask 1（20 pts）：$n,m\\leq 2$。\n- Subtask 2（40 pts）：$n,m\\leq 4$。\n- Subtask 3（40 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\leq n,m\\leq 10^{3}$。\n\nidea：Sol1，solution：Sol1，code：Sol1，data：Sol1\n\n---\n\n「我看见大炮终于完了……」\n\n「全机注意，   \n　战争结束了。」\n\n……\n\n「Talisman 看，太阳升起来了。」\n\n「尽管黑夜是如此漫长，但终将迎来黎明的曙光。」\n\n「我们失去的战友，都把他们的生命之火   \n　献给了破晓之光。」\n\n「我们尽最大努力存活——   \n　就是对他们的最好悼念。」\n\n「现在，来吧。」\n\n「让我们回家吧。」\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-Zero / AC6-M15」 Chandelier", "background": "「不，还没完……」\n\n「什么！？」\n\n「炮管打开了。   \n　那个丑陋的东西开始通过炮管散热了！」\n\n「它的关键区域就在炮管后面。」\n\n「Talisman……   \n　……我们可以信任你，对吗？」\n \n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 15} \\\\\\Large\\text{Chandelier}\\\\\\tiny -\\textit{ To All Things }\n-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w6wqsh2b.png)", "description": "Chandelier 的核心可以被描述为一个 $n\\times m$ 的矩阵。初始时，矩阵中的每一个格子都是一个独立的空间。\n\n如果在核心中存在两个空间使得它们在矩阵上的并是一个矩形，则这两个空间可以合并为一个空间，合并出的空间就是原先两个空间的并。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jkzu2t0u.png)\n\n如果不存在任何两个空间的并是矩形，则我们称核心达到了稳定状态。\n\n如果一个空间的长达到了 $n$ 或者宽达到了 $m$，那么核心将会短路，引发爆炸。**注意这里空间的长指的是和原矩阵的长为 $n$ 的边平行的边的长度，宽类似。也就是说如果平行于 原矩形的长为 $n$ 的边 的边长达到了 $m$ 且 $m<n$，那么这是合法的。**\n\n核心达到了稳定状态后，你才能攻击并摧毁它，需要的攻击次数就是剩下的空间数。\n\n你剩下的弹药不多了，所以只能攻击 $10$ 次。\n\n你需要合理地控制空间的合并，使得核心在不短路的情况下达到稳定状态，且需要的攻击次数 $\\leq 10$。\n\n求出一种可能合并出来的形态。如果核心无法在不短路的情况下达到稳定或者无法合并为 $\\leq 10$ 个空间，输出 $-1$。", "inputFormat": "一行用空格分割的两个整数 $n,m$。", "outputFormat": "如果无解，输出一行 `-1`。\n\n如果有解，在第一行输出一个整数 $x$，表示空间数量。\n\n然后输出一个 $n\\times m$ 的矩阵 $a$，满足 $1\\leq a_{i,j}\\leq x$。$a_{i,j}$ 表示 $(i,j)$ 属于哪一个空间。相同的数代表相同的空间，不同的数代表不同的空间。\n\n如果有多解，输出任意一个即可。", "hint": "- Subtask 1（20 pts）：$n,m\\leq 2$。\n- Subtask 2（40 pts）：$n,m\\leq 4$。\n- Subtask 3（40 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\leq n,m\\leq 10^{3}$。\n\nidea：Sol1，solution：Sol1，code：Sol1，data：Sol1\n\n---\n\n「我看见大炮终于完了……」\n\n「全机注意，   \n　战争结束了。」\n\n……\n\n「Talisman 看，太阳升起来了。」\n\n「尽管黑夜是如此漫长，但终将迎来黎明的曙光。」\n\n「我们失去的战友，都把他们的生命之火   \n　献给了破晓之光。」\n\n「我们尽最大努力存活——   \n　就是对他们的最好悼念。」\n\n「现在，来吧。」\n\n「让我们回家吧。」\n\n", "locale": "zh-CN"}}}
{"pid": "P7785", "type": "P", "difficulty": 2, "samples": [["5\n1 1 4 8 1 ", "2"], ["5\n8 5 3 4 10", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #6] Hindeks", "background": "", "description": "给出一个数列，请你求出一个最大的整数 $H$，使原数列中至少有 $H$ 个数 $\\ge H$。", "inputFormat": "第一行，一个正整数 $N$，表示数列中数的个数；\n\n第二行，$N$ 个整数 $A_i$，表示数列中的数。", "outputFormat": "一行，一个整数 $H$，表示符合条件的最大整数。", "hint": "**【样例解释 #1】**\n\n比 $2$ 大的数有 $2$ 个，分别是 $4$ 和 $8$。\n\n**【样例解释 #2】**\n\n比 $4$ 大的数有 $4$ 个，分别是 $8$，$5$，$4$ 和 $10$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 5\\times 10^5$，$0\\le A_i\\le 1\\times 10^6$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T1 HINDEKS**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #6] Hindeks", "background": "", "description": "给出一个数列，请你求出一个最大的整数 $H$，使原数列中至少有 $H$ 个数 $\\ge H$。", "inputFormat": "第一行，一个正整数 $N$，表示数列中数的个数；\n\n第二行，$N$ 个整数 $A_i$，表示数列中的数。", "outputFormat": "一行，一个整数 $H$，表示符合条件的最大整数。", "hint": "**【样例解释 #1】**\n\n比 $2$ 大的数有 $2$ 个，分别是 $4$ 和 $8$。\n\n**【样例解释 #2】**\n\n比 $4$ 大的数有 $4$ 个，分别是 $8$，$5$，$4$ 和 $10$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 5\\times 10^5$，$0\\le A_i\\le 1\\times 10^6$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T1 HINDEKS**_", "locale": "zh-CN"}}}
{"pid": "P7786", "type": "P", "difficulty": 2, "samples": [["4 1\n1 0 1 1 ", "1"], ["5 2\n1 0 0 0 1", "1"], ["8 2\n1 1 0 0 1 0 0 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #6] Telefoni", "background": null, "description": "一个办公室有 $N$ 张桌子从左至右排列，有些桌子上放了电话。\n\n当第 $j$ 个桌子上的电话响了后，第 $i$ 个桌子上的电话也会响，当且仅当 $|j-i|\\le D$。\n\n现在给出电话的摆放情况，请你求出最小需要添加几个电话，能使最后一个桌子上的电话响起。\n\n保证第一张桌子和最后一张桌子有电话放置。", "inputFormat": "第一行包含两个正整数 $N$ 和 $D$，分别表示桌子个数和最大距离。\n\n第二行包含 $N$ 个整数 $A_i$。如果 $A_i=1$，那么表示这个桌子上有电话，如果 $A_i=0$，则表示没有。", "outputFormat": "一行，一个整数，表示最小需要添加电话个数。", "hint": "**【样例解释 #1】**\n\n在 $2$ 号桌子上添加一个电话，即可使 $4$ 号桌子上的电话响起。\n\n**【样例解释 #2】**\n\n在 $3$ 号桌子上添加一个电话，即可使 $5$ 号桌子上的电话响起。\n\n**【样例解释 #3】**\n\n在 $4$ 号桌子和 $7$ 号桌子上各添加一个电话，即可使 $8$ 号桌子上的电话响起。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，$1\\le N\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le D\\le N\\le 3\\times 10^5$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T2 TELEFONI**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #6] Telefoni", "background": null, "description": "一个办公室有 $N$ 张桌子从左至右排列，有些桌子上放了电话。\n\n当第 $j$ 个桌子上的电话响了后，第 $i$ 个桌子上的电话也会响，当且仅当 $|j-i|\\le D$。\n\n现在给出电话的摆放情况，请你求出最小需要添加几个电话，能使最后一个桌子上的电话响起。\n\n保证第一张桌子和最后一张桌子有电话放置。", "inputFormat": "第一行包含两个正整数 $N$ 和 $D$，分别表示桌子个数和最大距离。\n\n第二行包含 $N$ 个整数 $A_i$。如果 $A_i=1$，那么表示这个桌子上有电话，如果 $A_i=0$，则表示没有。", "outputFormat": "一行，一个整数，表示最小需要添加电话个数。", "hint": "**【样例解释 #1】**\n\n在 $2$ 号桌子上添加一个电话，即可使 $4$ 号桌子上的电话响起。\n\n**【样例解释 #2】**\n\n在 $3$ 号桌子上添加一个电话，即可使 $5$ 号桌子上的电话响起。\n\n**【样例解释 #3】**\n\n在 $4$ 号桌子和 $7$ 号桌子上各添加一个电话，即可使 $8$ 号桌子上的电话响起。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，$1\\le N\\le 20$；\n\n对于 $100\\%$ 的数据，$1\\le D\\le N\\le 3\\times 10^5$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $80$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T2 TELEFONI**_", "locale": "zh-CN"}}}
{"pid": "P7787", "type": "P", "difficulty": 3, "samples": [["2\n1 4 3 2", "2 0 1 1"], ["4\n5 3 2 6 4 8 7 1 2 4 3 3 6 4 8 1", "1 2 2 1 1 0 1 3 2 1 2 2 1 1 0 3"], ["1\n1 1", "0 0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #6] Turnir", "background": "", "description": "给定一个由 $2^N$ 个正整数组成的数列。每一轮将这些数字按照给定的顺序进行比大小，大的数字留下，小的数字淘汰，直至只剩下最后一个数字为止。\n\n现在给你这 $2^N$ 个数字的初始排列顺序，请你求出每个数字能活到的最大的轮数。", "inputFormat": "第一行，一个整数 $N$；\n\n第二行，$2^N$ 个整数 $A_i$，表示数列中的数。", "outputFormat": "一行，$2^N$ 个整数，分别表示第 $i$ 个数能活到的轮数。", "hint": "**【样例解释 #2】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tricmynf.png)\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 20$，$0\\le A_i\\le 1\\times 10^9$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T3 TURNIR**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #6] Turnir", "background": "", "description": "给定一个由 $2^N$ 个正整数组成的数列。每一轮将这些数字按照给定的顺序进行比大小，大的数字留下，小的数字淘汰，直至只剩下最后一个数字为止。\n\n现在给你这 $2^N$ 个数字的初始排列顺序，请你求出每个数字能活到的最大的轮数。", "inputFormat": "第一行，一个整数 $N$；\n\n第二行，$2^N$ 个整数 $A_i$，表示数列中的数。", "outputFormat": "一行，$2^N$ 个整数，分别表示第 $i$ 个数能活到的轮数。", "hint": "**【样例解释 #2】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tricmynf.png)\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 20$，$0\\le A_i\\le 1\\times 10^9$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T3 TURNIR**_", "locale": "zh-CN"}}}
{"pid": "P7788", "type": "P", "difficulty": 2, "samples": [["1 9", "21"], ["24 24", "12"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #6] Savrsen", "background": "", "description": "一个数是完美的，仅当它等于它的因数中比它小的所有数之和。\n\n例如：$28=1+2+4+7+14$，所以 $28$ 是完美的。\n\n由此我们可以定义一个数的不完美值 $F(N)$，代表 $N$ 和比 $N$ 小的所有 $N$ 的因数之和的差的绝对值。\n\n例如：$F(6)=|6-1-2-3|=0$，\n\n$F(11)=|11-1|=10$，\n\n$F(24)=|24-1-2-3-4-6-8-12|=|-12|=12$。\n\n现在给出两个正整数 $A$ 和 $B$，请你求出 $F(A)+F(A+1\n)+...+F(B)$。", "inputFormat": "一行，两个整数 $A$ 和 $B$，含义如上。", "outputFormat": "一行，一个整数，表示 $F(A)+F(A+1)+...+F(B)$。", "hint": "**【样例解释 #1】**\n\n$F(1)+...+F(9)=1+1+2+1+4+0+6+1+5=21$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le A,B\\le 10^7$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T4 SAVRSEN**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #6] Savrsen", "background": "", "description": "一个数是完美的，仅当它等于它的因数中比它小的所有数之和。\n\n例如：$28=1+2+4+7+14$，所以 $28$ 是完美的。\n\n由此我们可以定义一个数的不完美值 $F(N)$，代表 $N$ 和比 $N$ 小的所有 $N$ 的因数之和的差的绝对值。\n\n例如：$F(6)=|6-1-2-3|=0$，\n\n$F(11)=|11-1|=10$，\n\n$F(24)=|24-1-2-3-4-6-8-12|=|-12|=12$。\n\n现在给出两个正整数 $A$ 和 $B$，请你求出 $F(A)+F(A+1\n)+...+F(B)$。", "inputFormat": "一行，两个整数 $A$ 和 $B$，含义如上。", "outputFormat": "一行，一个整数，表示 $F(A)+F(A+1)+...+F(B)$。", "hint": "**【样例解释 #1】**\n\n$F(1)+...+F(9)=1+1+2+1+4+0+6+1+5=21$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le A,B\\le 10^7$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $120$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T4 SAVRSEN**_", "locale": "zh-CN"}}}
{"pid": "P7789", "type": "P", "difficulty": 5, "samples": [["4\n2\n6\n3\n11 ", "1"], ["4\n1\n2\n3\n4 ", "0"], ["3\n4\n9\n15 ", "4"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200, 819200]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #6] Sirni", "background": "", "description": "有 $N$ 张卡片，每张卡片上写有一个数值 $P_i$。\n\n可以连接任意两张卡片，但需要花费 $\\min(P_a\\bmod P_b, P_b\\bmod P_a)$。\n\n请你求出连接所有卡片所需要的最小花费。", "inputFormat": "第一行，一个整数 $N$，代表有 $N$ 张卡片；\n\n接下来 $N$ 行，每行一个正整数 $P_i$，代表第 $i$ 张卡片上写的数值。", "outputFormat": "一行，一个整数，代表最小花费。", "hint": "**【样例解释 #1】**\n\n连接卡片 $1$ 和卡片 $2$，花费 $\\min(2\\bmod 6,6\\bmod 2)=0$；\n\n连接卡片 $2$ 和卡片 $3$，花费 $\\min(3\\bmod 6,6\\bmod 3)=0$；\n\n连接卡片 $1$ 和卡片 $4$，花费 $\\min(2\\bmod 11,11\\bmod 2)=1$。\n\n总共花费 $0+0+1=1$。\n\n**【数据范围】**\n\n对于 $30\\%$ 的数据，$1\\le N\\le 10^3$；\n\n对于另外 $40\\%$ 的数据，$1\\le P_i\\le 10^6$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5$，$1\\le P_i\\le 10^7$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T5 SIRNI**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #6] Sirni", "background": "", "description": "有 $N$ 张卡片，每张卡片上写有一个数值 $P_i$。\n\n可以连接任意两张卡片，但需要花费 $\\min(P_a\\bmod P_b, P_b\\bmod P_a)$。\n\n请你求出连接所有卡片所需要的最小花费。", "inputFormat": "第一行，一个整数 $N$，代表有 $N$ 张卡片；\n\n接下来 $N$ 行，每行一个正整数 $P_i$，代表第 $i$ 张卡片上写的数值。", "outputFormat": "一行，一个整数，代表最小花费。", "hint": "**【样例解释 #1】**\n\n连接卡片 $1$ 和卡片 $2$，花费 $\\min(2\\bmod 6,6\\bmod 2)=0$；\n\n连接卡片 $2$ 和卡片 $3$，花费 $\\min(3\\bmod 6,6\\bmod 3)=0$；\n\n连接卡片 $1$ 和卡片 $4$，花费 $\\min(2\\bmod 11,11\\bmod 2)=1$。\n\n总共花费 $0+0+1=1$。\n\n**【数据范围】**\n\n对于 $30\\%$ 的数据，$1\\le N\\le 10^3$；\n\n对于另外 $40\\%$ 的数据，$1\\le P_i\\le 10^6$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5$，$1\\le P_i\\le 10^7$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $140$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T5 SIRNI**_", "locale": "zh-CN"}}}
{"pid": "P7790", "type": "P", "difficulty": 6, "samples": [["4\n1 1 1 1\n2\n1 2\n2\n2 5\n4 10\n1\n4 2 ", "7"], ["3\n6 9 4\n2\n5 7\n3\n1 1\n7 8\n6 10\n2\n6 2\n70 68 ", "118\n-2"], ["3\n8 3 10\n2\n8 4\n3\n1 6\n5 1\n3 7\n2\n5 1\n3 1 ", "16\n66"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #6] Gauss", "background": "", "description": "给出 $K$ 个整数 $F(1),F(2),...,F(K)$，并定义 $i>K$ 的 $F(i)=0$；又给出 $T$ 个幸运整数 $X_i$ 和它的价格 $C(X_i)$，$M$ 个整数 $L_1,L_2,...,L_M$。\n\n一开始黑板上有一个整数 $A$，可以进行如下的两种操作：\n\n- 令当前黑板上的数是 $N$，则可以写下 $N$ 的因数中任意一个小于 $N$ 的因数 $M$，花费 $F(d(N\\div M))$。其中 $d(N\\div M)$ 表示正整数 $N\\div M$ 的因数个数（包括 $N/M$）。\n\n- 如果 $N$ 是一个幸运整数，可以将 $N$ 留在黑板上，花费 $C(N)$。\n\n定义 $G(A,B,L)$ 为以 $A$ 为起始的数，进行了 $L$ 次操作，最终留下 $B$ 的最小花费，请你根据给定的 $A$ 和 $B$，求出 $G(A,B,L_1)+G(A,B,L_2)+...+G(A,B,L_M)$。 ", "inputFormat": "第一行，一个正整数 $K$；\n\n第二行，$K$ 个正整数 $F(1),F(2),...,F(K)$；\n\n第三行，一个正整数 $M$；\n\n第四行，$M$ 个正整数 $L_1,L_2,...,L_M$；\n\n第五行，一个正整数 $T$；\n\n接下来 $T$ 行，每行两个正整数 $X_i$ 和 $C(X_i)$，代表 $X_i$ 是一个幸运数且它的价格为 $C(X_i)$；\n\n第 $T+5$ 行，一个正整数 $Q$，表示询问的个数；\n\n接下来 $Q$ 行，每行两个正整数 $A$ 和 $B$。", "outputFormat": "对于输入的每个询问，输出 $G(A,B,L_1)+G(A,B,L_2)+...+G(A,B,L_M)$。 ", "hint": "**【样例解释 #1】**\n\n因为 $L_1=1$，所以将 $4$ 替换成 $2$，花费 $G(4,2,1)=F(d(2))=1$；\n\n因为 $L_2=2$，所以有两种方法将 $4$ 变成 $2$：\n\n- 将 $4$ 替换成 $2$，又因为 $2$ 是幸运数字，所以第二轮留下 $2$。花费 $F(d(4\\div 2))+C(2)=1+5=6$；\n\n- 因为 $4$ 是幸运数字，所以第一轮留下 $4$，第二轮将 $4$ 替换成 $2$。花费 $C(4)+F(d(4\\div 2))=11+1=12$。\n\n第一种方案花费更少，所以选择第一种方案。\n\n所以答案是 $G(4,2,1)+G(4,2,2)=1+6=7$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le K\\le 10^4$，$1\\le F(i)\\le 10^3$，$1\\le M\\le 10^3$，$1\\le L_i\\le 10^4$，$1\\le T\\le 50$，$1\\le X_i\\le 10^6$，$1\\le C(X_i)\\le 10^3$，$1\\le Q\\le 5\\times 10^4$，$1\\le A,B\\le 10^6$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T6 GAUSS**_", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #6] Gauss", "background": "", "description": "给出 $K$ 个整数 $F(1),F(2),...,F(K)$，并定义 $i>K$ 的 $F(i)=0$；又给出 $T$ 个幸运整数 $X_i$ 和它的价格 $C(X_i)$，$M$ 个整数 $L_1,L_2,...,L_M$。\n\n一开始黑板上有一个整数 $A$，可以进行如下的两种操作：\n\n- 令当前黑板上的数是 $N$，则可以写下 $N$ 的因数中任意一个小于 $N$ 的因数 $M$，花费 $F(d(N\\div M))$。其中 $d(N\\div M)$ 表示正整数 $N\\div M$ 的因数个数（包括 $N/M$）。\n\n- 如果 $N$ 是一个幸运整数，可以将 $N$ 留在黑板上，花费 $C(N)$。\n\n定义 $G(A,B,L)$ 为以 $A$ 为起始的数，进行了 $L$ 次操作，最终留下 $B$ 的最小花费，请你根据给定的 $A$ 和 $B$，求出 $G(A,B,L_1)+G(A,B,L_2)+...+G(A,B,L_M)$。 ", "inputFormat": "第一行，一个正整数 $K$；\n\n第二行，$K$ 个正整数 $F(1),F(2),...,F(K)$；\n\n第三行，一个正整数 $M$；\n\n第四行，$M$ 个正整数 $L_1,L_2,...,L_M$；\n\n第五行，一个正整数 $T$；\n\n接下来 $T$ 行，每行两个正整数 $X_i$ 和 $C(X_i)$，代表 $X_i$ 是一个幸运数且它的价格为 $C(X_i)$；\n\n第 $T+5$ 行，一个正整数 $Q$，表示询问的个数；\n\n接下来 $Q$ 行，每行两个正整数 $A$ 和 $B$。", "outputFormat": "对于输入的每个询问，输出 $G(A,B,L_1)+G(A,B,L_2)+...+G(A,B,L_M)$。 ", "hint": "**【样例解释 #1】**\n\n因为 $L_1=1$，所以将 $4$ 替换成 $2$，花费 $G(4,2,1)=F(d(2))=1$；\n\n因为 $L_2=2$，所以有两种方法将 $4$ 变成 $2$：\n\n- 将 $4$ 替换成 $2$，又因为 $2$ 是幸运数字，所以第二轮留下 $2$。花费 $F(d(4\\div 2))+C(2)=1+5=6$；\n\n- 因为 $4$ 是幸运数字，所以第一轮留下 $4$，第二轮将 $4$ 替换成 $2$。花费 $C(4)+F(d(4\\div 2))=11+1=12$。\n\n第一种方案花费更少，所以选择第一种方案。\n\n所以答案是 $G(4,2,1)+G(4,2,2)=1+6=7$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le K\\le 10^4$，$1\\le F(i)\\le 10^3$，$1\\le M\\le 10^3$，$1\\le L_i\\le 10^4$，$1\\le T\\le 50$，$1\\le X_i\\le 10^6$，$1\\le C(X_i)\\le 10^3$，$1\\le Q\\le 5\\times 10^4$，$1\\le A,B\\le 10^6$。\n\n**【说明】**\n\n本题分值按 COCI 原题设置，满分 $160$。\n\n题目译自 [COCI2016_2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #6](https://hsin.hr/coci/archive/2016_2017/contest6_tasks.pdf) _**T6 GAUSS**_", "locale": "zh-CN"}}}
{"pid": "P7791", "type": "P", "difficulty": 2, "samples": [["7\n10 6 8 9 4 5 3\n14\n1 2 3 4\n5\n1 3 4 6 7", "22"], ["6\n12 5 7 8 9 3\n14\n4 3 1 2\n5\n1 2 1 6 6", "32"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #7] TETA", "background": "你发现自己扮演的是一位在食堂担任收银员的好女士。这位女士被所有学生认为是好人的多种原因之一是，她关心你在访问食堂时尽可能少花钱。", "description": "她是如何做到这一点的呢？策略其实很简单。在食堂里可以买到各种饭菜，其价格也是众所周知的。每天都会提供一份**套餐**。一份套餐包括 $4$ 份饭菜（通常是汤、主菜、配菜和甜点），但它的价格 $x$ 小于或等于其组成部分的价格总和。当这位女士注意到，如果你拿了套餐中的个别东西，并且如果按照一整个套餐的费用会花更少的钱，那么她就**一定会这样做**，而你会满载而归，口袋里剩下比原来更多的钱。\n\n你拿着托盘站在收银台前，想知道你要付多少钱。写一个方案来确定它吧!\n\n请注意：女士可以用多个套餐向你收费，这样价格会更便宜。", "inputFormat": "输入共六行。\n\n第一行输入一个整数 $k$，表示食堂今天供应的餐品总数。  \n第二行输入 $k$ 个整数，第 $i$ 个整数 $c_i$ 表示第 $i$ 个餐品的价格。   \n第三行输入一个整数 $x$，表示套餐的价格。  \n第四行输入 $4$ 个整数 $p_1,p_2,p_3,p_4$，分别表示套餐里面包含的 $4$ 种餐品。**保证 $p_i$ 互不相同**。  \n第五行输入一个整数 $t$，表示你点的餐品的个数。  \n第六行输入 $t$ 个整数，第 $i$ 个整数 $s_i$ 表示你点的餐品的编号。**不保证 $s_i$ 互不相同**。\n", "outputFormat": "输出仅一行，一个整数，表示你今天在食堂的花费。", "hint": "**【样例 1 解释】**\n\n你点了 $1,3,4$ 这三个在套餐中的餐品，这三个餐品单点的总价为 $10+8+9=27$，大于套餐的价格 $14$，因此收银的女士会将这些餐品按照 $14$ 元收费。除此之外的 $6,7$ 两个餐品不在套餐中，因此单独收费。故总花费为 $14+5+3=22$。\n\n**【样例 2 解释】**\n\n你点了 $1,2$ 这两个在套餐中的餐品，这两个餐品单点的总价为 $12+4=16$，大于套餐的价格 $14$，因此收银的女士会将这些餐品按照 $14$ 元收费。此外还剩下一个 $1$ 号餐品和两个 $6$ 号餐品。由于一个 $1$ 号餐品的价格是 $12$，小于套餐的 $14$，而另外两个 $6$ 号餐品又不在套餐里出现，因此剩下的一个 $1$ 号餐品和两个 $6$ 号餐品都只能单独收费。因此总花费为 $14+12+3\\times 2=32$。\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant k,t\\leqslant 20$，$1\\leqslant c_i\\leqslant 250$，$1\\leqslant x<1000$，$1\\leqslant p_i,s_i\\leqslant k$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T1 TETA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #7] TETA", "background": "你发现自己扮演的是一位在食堂担任收银员的好女士。这位女士被所有学生认为是好人的多种原因之一是，她关心你在访问食堂时尽可能少花钱。", "description": "她是如何做到这一点的呢？策略其实很简单。在食堂里可以买到各种饭菜，其价格也是众所周知的。每天都会提供一份**套餐**。一份套餐包括 $4$ 份饭菜（通常是汤、主菜、配菜和甜点），但它的价格 $x$ 小于或等于其组成部分的价格总和。当这位女士注意到，如果你拿了套餐中的个别东西，并且如果按照一整个套餐的费用会花更少的钱，那么她就**一定会这样做**，而你会满载而归，口袋里剩下比原来更多的钱。\n\n你拿着托盘站在收银台前，想知道你要付多少钱。写一个方案来确定它吧!\n\n请注意：女士可以用多个套餐向你收费，这样价格会更便宜。", "inputFormat": "输入共六行。\n\n第一行输入一个整数 $k$，表示食堂今天供应的餐品总数。  \n第二行输入 $k$ 个整数，第 $i$ 个整数 $c_i$ 表示第 $i$ 个餐品的价格。   \n第三行输入一个整数 $x$，表示套餐的价格。  \n第四行输入 $4$ 个整数 $p_1,p_2,p_3,p_4$，分别表示套餐里面包含的 $4$ 种餐品。**保证 $p_i$ 互不相同**。  \n第五行输入一个整数 $t$，表示你点的餐品的个数。  \n第六行输入 $t$ 个整数，第 $i$ 个整数 $s_i$ 表示你点的餐品的编号。**不保证 $s_i$ 互不相同**。\n", "outputFormat": "输出仅一行，一个整数，表示你今天在食堂的花费。", "hint": "**【样例 1 解释】**\n\n你点了 $1,3,4$ 这三个在套餐中的餐品，这三个餐品单点的总价为 $10+8+9=27$，大于套餐的价格 $14$，因此收银的女士会将这些餐品按照 $14$ 元收费。除此之外的 $6,7$ 两个餐品不在套餐中，因此单独收费。故总花费为 $14+5+3=22$。\n\n**【样例 2 解释】**\n\n你点了 $1,2$ 这两个在套餐中的餐品，这两个餐品单点的总价为 $12+4=16$，大于套餐的价格 $14$，因此收银的女士会将这些餐品按照 $14$ 元收费。此外还剩下一个 $1$ 号餐品和两个 $6$ 号餐品。由于一个 $1$ 号餐品的价格是 $12$，小于套餐的 $14$，而另外两个 $6$ 号餐品又不在套餐里出现，因此剩下的一个 $1$ 号餐品和两个 $6$ 号餐品都只能单独收费。因此总花费为 $14+12+3\\times 2=32$。\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant k,t\\leqslant 20$，$1\\leqslant c_i\\leqslant 250$，$1\\leqslant x<1000$，$1\\leqslant p_i,s_i\\leqslant k$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T1 TETA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7792", "type": "P", "difficulty": 2, "samples": [["3 5\n1\n2\n3", "4"], ["4 6\n4\n2\n1\n3", "13"], ["10 7\n1\n3\n2\n4\n5\n7\n6\n8\n9\n10", "25"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2014", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #7] KRIZA", "background": "某国的经济状况很糟糕，冰冻灾害袭击了整个国家，人们正在失去工作。然而，Sisyphus，本题的主角，已经为自己找到了一份新工作。从下周一开始，Sisyphus 将成为一家酒店的助理锁匠。当然，他首先需要向锁匠头子展示他的开锁能力。", "description": "这就是锁匠头子给了 Sisyphus $n$ 把钥匙，放在一个大圆坠子上，蒙住他的眼睛并把他带进一个大房间的原因。这个房间里恰好有 $n$ 扇锁着的门，用 $1$ 到 $n$ 的数字表示。吊坠上的每一把钥匙都正好能打开一扇门，其中第 $i$ 把钥匙能打开第 $v_i$ 扇门。Sisyphus 的工作是将每一扇门解锁并再次上锁。他这样做的方式是沿着墙壁移动，不改变方向，直到他到达一扇门。当他走到一扇门前时，他尝试用从当前左数第一把钥匙来解锁。如果钥匙没有开锁，Sisyphus 就把它丢到最右边，并再用当前最左边的那一把钥匙再试一次，重复这个过程，直到他找到正确的钥匙为止。当他所有的门解锁时，他的工作就完成了。Sisyphus 打开的第一扇门用 $1$ 表示，下一扇用 $2$ 表示，后一扇用 $3$ 表示，以此类推......\n\nSisyphus 不知道的是，锁匠头子其实是在考验他的耐力，所以把他领到了一个圆形的房间。因此，Sisyphus 在解开并锁上最后一扇门后，会再次去解开并锁上第一扇门。因为他是一个勤奋而执着的家伙，Sisyphus 一直在做这项工作，几个小时都没有说一句话。只有在第 $k$ 次成功开锁和锁门后，他才开口说话：\"如果我知道到目前为止我把一把错误的钥匙放在门锁里有多少次就好了！\" 你的任务是回答他的问题。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行输入两个整数 $n,k$，分别表示 Sisyphus 拥有的的钥匙数量和他当前为止成功开锁和锁门的次数。  \n随后 $n$ 行，每行一个整数 $v_i$，表示第 $i$ 把钥匙对应能开的门的编号。", "outputFormat": "输出仅一行，表示 Sisyphus 把一把错误的钥匙放在门锁里的次数。", "hint": "**【样例 2 解释】**\n\n以下是 Sisyphus 使用钥匙的情况，其中一个标红的数字表示他把错误的钥匙放在门锁里一次：\n\n- 对第 $1$ 扇门进行开锁和锁门操作：$\\color{Red}4~2~\\color{default}1~3$\n- 对第 $2$ 扇门进行开锁和锁门操作：$\\color{Red}1~3~4~\\color{default}2$\n- 对第 $3$ 扇门进行开锁和锁门操作：$\\color{Red}2~1~\\color{default}3~4$\n- 对第 $4$ 扇门进行开锁和锁门操作：$\\color{Red}3~\\color{default}4~2~1$\n- 对第 $1$ 扇门进行开锁和锁门操作：$\\color{Red}4~2~\\color{default}1~3$\n- 对第 $2$ 扇门进行开锁和锁门操作：$\\color{Red}1~3~4~\\color{default}2$\n\n因此他把错误的钥匙放在门锁里的次数一共是 $2+3+2+1+2+3=13$。\n\n**【数据范围】**\n\n对于 $40\\%$ 的数据，保证 $1\\leqslant n,k\\leqslant 1000$。  \n对于 $60\\%$ 的数据，保证 $1\\leqslant k\\leqslant 5\\times 10^4$。  \n对于所有数据，$1\\leqslant v_i\\leqslant n\\leqslant 10^5$，$1\\leqslant k\\leqslant 10^9$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T2 KRIZA_**，按照原题数据配置，满分 $80$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #7] KRIZA", "background": "某国的经济状况很糟糕，冰冻灾害袭击了整个国家，人们正在失去工作。然而，Sisyphus，本题的主角，已经为自己找到了一份新工作。从下周一开始，Sisyphus 将成为一家酒店的助理锁匠。当然，他首先需要向锁匠头子展示他的开锁能力。", "description": "这就是锁匠头子给了 Sisyphus $n$ 把钥匙，放在一个大圆坠子上，蒙住他的眼睛并把他带进一个大房间的原因。这个房间里恰好有 $n$ 扇锁着的门，用 $1$ 到 $n$ 的数字表示。吊坠上的每一把钥匙都正好能打开一扇门，其中第 $i$ 把钥匙能打开第 $v_i$ 扇门。Sisyphus 的工作是将每一扇门解锁并再次上锁。他这样做的方式是沿着墙壁移动，不改变方向，直到他到达一扇门。当他走到一扇门前时，他尝试用从当前左数第一把钥匙来解锁。如果钥匙没有开锁，Sisyphus 就把它丢到最右边，并再用当前最左边的那一把钥匙再试一次，重复这个过程，直到他找到正确的钥匙为止。当他所有的门解锁时，他的工作就完成了。Sisyphus 打开的第一扇门用 $1$ 表示，下一扇用 $2$ 表示，后一扇用 $3$ 表示，以此类推......\n\nSisyphus 不知道的是，锁匠头子其实是在考验他的耐力，所以把他领到了一个圆形的房间。因此，Sisyphus 在解开并锁上最后一扇门后，会再次去解开并锁上第一扇门。因为他是一个勤奋而执着的家伙，Sisyphus 一直在做这项工作，几个小时都没有说一句话。只有在第 $k$ 次成功开锁和锁门后，他才开口说话：\"如果我知道到目前为止我把一把错误的钥匙放在门锁里有多少次就好了！\" 你的任务是回答他的问题。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行输入两个整数 $n,k$，分别表示 Sisyphus 拥有的的钥匙数量和他当前为止成功开锁和锁门的次数。  \n随后 $n$ 行，每行一个整数 $v_i$，表示第 $i$ 把钥匙对应能开的门的编号。", "outputFormat": "输出仅一行，表示 Sisyphus 把一把错误的钥匙放在门锁里的次数。", "hint": "**【样例 2 解释】**\n\n以下是 Sisyphus 使用钥匙的情况，其中一个标红的数字表示他把错误的钥匙放在门锁里一次：\n\n- 对第 $1$ 扇门进行开锁和锁门操作：$\\color{Red}4~2~\\color{default}1~3$\n- 对第 $2$ 扇门进行开锁和锁门操作：$\\color{Red}1~3~4~\\color{default}2$\n- 对第 $3$ 扇门进行开锁和锁门操作：$\\color{Red}2~1~\\color{default}3~4$\n- 对第 $4$ 扇门进行开锁和锁门操作：$\\color{Red}3~\\color{default}4~2~1$\n- 对第 $1$ 扇门进行开锁和锁门操作：$\\color{Red}4~2~\\color{default}1~3$\n- 对第 $2$ 扇门进行开锁和锁门操作：$\\color{Red}1~3~4~\\color{default}2$\n\n因此他把错误的钥匙放在门锁里的次数一共是 $2+3+2+1+2+3=13$。\n\n**【数据范围】**\n\n对于 $40\\%$ 的数据，保证 $1\\leqslant n,k\\leqslant 1000$。  \n对于 $60\\%$ 的数据，保证 $1\\leqslant k\\leqslant 5\\times 10^4$。  \n对于所有数据，$1\\leqslant v_i\\leqslant n\\leqslant 10^5$，$1\\leqslant k\\leqslant 10^9$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T2 KRIZA_**，按照原题数据配置，满分 $80$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7793", "type": "P", "difficulty": 3, "samples": [["3\n1 3 3\n1 1 1\n1 2 3", "4"], ["7\n3 3 4 1 3 4 4\n4 2 5 1 5 5 4\n5 5 1 3 4 4 4", "19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536]}, "tags": ["动态规划 DP", "2014", "记忆化搜索", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #7] ACM", "background": "Zagreb 大学的团队的成员 Stjepan、Ivan 和 Gustav 正在摩洛哥参加 ACM 国际大学生程序设计竞赛的世界决赛。他们的技术指导 Goran 想出了一个无敌的策略，用于解决决赛中的题目。", "description": "在一开始，每个团队成员迅速估计 $n$ 道题目中每题的难度。这些难度用 $1$ 到 $5$ 的数字描述，数字越大，难度也就越大。\n\n在这之后，他们之间将分配任务。为了简单起见，任务阵列将被分成三部分，以便每个团队成员得到一个**非空**的连续任务序列来思考。这种分配是为了使估计的难度之和最小，而只计算被分配到该任务的团队成员的估计难度值。你的任务是计算这个最小的可能总和。", "inputFormat": "输入共四行。\n\n第一行输入一个整数 $n$，表示问题的数量。  \n第二到第四行，第 $i+1$ 行 $n$ 个整数 $d_{i,1},d_{i,2},\\dots,d_{i,n}$，表示第 $i$ 号成员对于这 $n$ 道题目估计的难度。", "outputFormat": "输出仅一行，一个整数，表示最小可能的估计难度总和。", "hint": "**【样例 1 解释】**\n\n给第 $1$ 号成员分配第 $1$ 题，给第 $2$ 号成员分配第 $3$ 道题，给第 $3$ 号成员分配第 $2$ 道题。这样分配的难度总和为 $1+1+2=4$。可以证明没有难度总和更小的分配方案。\n\n**【数据范围】**\n\n对于所有数据，$3\\leqslant n\\leqslant 1.5\\times 10^5$，$1\\leqslant d_{i,j}\\leqslant 5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T3 ACM_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #7] ACM", "background": "Zagreb 大学的团队的成员 Stjepan、Ivan 和 Gustav 正在摩洛哥参加 ACM 国际大学生程序设计竞赛的世界决赛。他们的技术指导 Goran 想出了一个无敌的策略，用于解决决赛中的题目。", "description": "在一开始，每个团队成员迅速估计 $n$ 道题目中每题的难度。这些难度用 $1$ 到 $5$ 的数字描述，数字越大，难度也就越大。\n\n在这之后，他们之间将分配任务。为了简单起见，任务阵列将被分成三部分，以便每个团队成员得到一个**非空**的连续任务序列来思考。这种分配是为了使估计的难度之和最小，而只计算被分配到该任务的团队成员的估计难度值。你的任务是计算这个最小的可能总和。", "inputFormat": "输入共四行。\n\n第一行输入一个整数 $n$，表示问题的数量。  \n第二到第四行，第 $i+1$ 行 $n$ 个整数 $d_{i,1},d_{i,2},\\dots,d_{i,n}$，表示第 $i$ 号成员对于这 $n$ 道题目估计的难度。", "outputFormat": "输出仅一行，一个整数，表示最小可能的估计难度总和。", "hint": "**【样例 1 解释】**\n\n给第 $1$ 号成员分配第 $1$ 题，给第 $2$ 号成员分配第 $3$ 道题，给第 $3$ 号成员分配第 $2$ 道题。这样分配的难度总和为 $1+1+2=4$。可以证明没有难度总和更小的分配方案。\n\n**【数据范围】**\n\n对于所有数据，$3\\leqslant n\\leqslant 1.5\\times 10^5$，$1\\leqslant d_{i,j}\\leqslant 5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T3 ACM_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7794", "type": "P", "difficulty": 4, "samples": [["2 2", "0"], ["5 3", "12"], ["7 3", "96"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["数学", "2014", "组合数学", "排列组合", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #7] JANJE", "background": "", "description": "年轻的 Bojan 现在是一名成功的电气工程专业学生，从小就喜欢涂色。想起童年时漫不经心的日子，他决定买一本涂色书和 $k$ 种颜色的颜料，然后开始工作。有趣的是，Bojan 不喜欢五颜六色的图片，所以他决定**每张图片最多使用三种不同的颜色着色**。此外，Bojan **永远不会用同一种颜色给两个相邻的区域上色**，如果两个区域的边缘至少有一个连接点，则被视为相邻。例如，下图用 $4$ 和 $3$ 表示的区域是相邻的，而区域 $1$ 和 $2$ 则不是。此外，下面这张图片的着色方式符合 Bojan 的所有要求。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bymq7g5t.png)\n\n在开始给一张图片上色之前，Bojan 会问自己有多少种方法可以给这张图上色，从而满足他的所有条件。鉴于 Bojan 是学电气工程的，可以理解的是，组合学不是他的强项，所以他向你寻求帮助。", "inputFormat": "输入仅一行两个整数 $n,k$，分别代表涂色书里面的图片编号和 Bojan 的颜料拥有的颜色数量。\n\n涂色书将会在附件中给出（即文件 `Happy coloring book.pdf`），涂色书里面的图片按照先后顺序依次编号为 $1$ 到 $8$。", "outputFormat": "输出仅一行一个整数，代表 Bojan 在满足自己所有要求的上色方式的个数。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 8$，$1\\leqslant k\\leqslant 1000$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T4 JANJE_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #7] JANJE", "background": "", "description": "年轻的 Bojan 现在是一名成功的电气工程专业学生，从小就喜欢涂色。想起童年时漫不经心的日子，他决定买一本涂色书和 $k$ 种颜色的颜料，然后开始工作。有趣的是，Bojan 不喜欢五颜六色的图片，所以他决定**每张图片最多使用三种不同的颜色着色**。此外，Bojan **永远不会用同一种颜色给两个相邻的区域上色**，如果两个区域的边缘至少有一个连接点，则被视为相邻。例如，下图用 $4$ 和 $3$ 表示的区域是相邻的，而区域 $1$ 和 $2$ 则不是。此外，下面这张图片的着色方式符合 Bojan 的所有要求。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bymq7g5t.png)\n\n在开始给一张图片上色之前，Bojan 会问自己有多少种方法可以给这张图上色，从而满足他的所有条件。鉴于 Bojan 是学电气工程的，可以理解的是，组合学不是他的强项，所以他向你寻求帮助。", "inputFormat": "输入仅一行两个整数 $n,k$，分别代表涂色书里面的图片编号和 Bojan 的颜料拥有的颜色数量。\n\n涂色书将会在附件中给出（即文件 `Happy coloring book.pdf`），涂色书里面的图片按照先后顺序依次编号为 $1$ 到 $8$。", "outputFormat": "输出仅一行一个整数，代表 Bojan 在满足自己所有要求的上色方式的个数。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 8$，$1\\leqslant k\\leqslant 1000$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T4 JANJE_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7795", "type": "P", "difficulty": 3, "samples": [["4 1\n1 2 3 4", "4.000000"], ["4 2\n2 4 3 4", "3.666666"], ["6 3\n7 1 2 1 3 6", "3.333333"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2014", "二分", "单调队列", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #7] PROSJEK", "background": "", "description": "给定一个有 $n$ 个整数的数列 $a$。请找出一个长度至少为 $k$ 的连续子序列，使这个子序列的所有数的平均值最大。", "inputFormat": "输入共 $2$ 行。\n\n第一行输入两个整数 $n,k$。  \n第二行输入 $n$ 个整数 $a_1,a_2,\\dots,a_n$，表示数列 $a$ 的所有数。", "outputFormat": "输出仅一行，一个实数，表示长度至少为 $k$ 的连续子序列的数的最大平均值。\n\n在每个测试点中，只要你的程序给出的答案和标准答案的相对误差不超过 $10^{-3}$，你的程序就可以通过该测试点。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，保证 $n\\leqslant 5000$。  \n对于所有数据，$1\\leqslant k\\leqslant n\\leqslant 3\\times 10^5$，$1\\leqslant a_i\\leqslant 10^6$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T5 PROSJEK_**，按照原题数据配置，满分 $140$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #7] PROSJEK", "background": "", "description": "给定一个有 $n$ 个整数的数列 $a$。请找出一个长度至少为 $k$ 的连续子序列，使这个子序列的所有数的平均值最大。", "inputFormat": "输入共 $2$ 行。\n\n第一行输入两个整数 $n,k$。  \n第二行输入 $n$ 个整数 $a_1,a_2,\\dots,a_n$，表示数列 $a$ 的所有数。", "outputFormat": "输出仅一行，一个实数，表示长度至少为 $k$ 的连续子序列的数的最大平均值。\n\n在每个测试点中，只要你的程序给出的答案和标准答案的相对误差不超过 $10^{-3}$，你的程序就可以通过该测试点。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，保证 $n\\leqslant 5000$。  \n对于所有数据，$1\\leqslant k\\leqslant n\\leqslant 3\\times 10^5$，$1\\leqslant a_i\\leqslant 10^6$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T5 PROSJEK_**，按照原题数据配置，满分 $140$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7796", "type": "P", "difficulty": 5, "samples": [["2 4\n1 0 2 0\n3 5 4 0\n2 1 0 0\n3 0 4 5", "2"], ["3 3\n1 2 3\n4 5 6\n7 8 0\n4 2 3\n6 5 1\n0 7 8", "4"], ["2 2\n1 2\n3 4\n2 3\n4 1", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2014", "欧拉回路", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #7] POLICE", "background": "", "description": "在图书管理员 Jurica 的图书馆里有 $n$ 个书架，每个书架有 $m$ 个位置，从左往右编号为 $1$ 到 $m$，并且每个位置上都可以放一本书。Jurica 是一个好的图书管理员，所以他决定对图书馆进行清点，如果有必要，就把不在自己位置上的书放回原来的位置。具体来说，现在第 $i$ 个书架上的第 $j$ 个位置上面摆着编号为 $a_{i,j}$ 的书（如果 $a_{i,j}=0$ 说明这个位置上面现在没有书），而原来在这个位置上摆着编号为 $b_{i,j}$ 的书（如果 $b_{i,j}=0$ 说明这个位置上面原来没有书）。他以下列操作移动书籍：\n\n- 操作 $1$：如果左边或右边有空位，可以在书架上向左或向右移动图书。\n- 操作 $2$：从书架上取下一本书，放在该书架或其他书架的空位上。\n\n细心的 Jurica 如果手中有书，就不能移动书。此外，他**不能同时拿多于一本书**。\n\n自从他不得不把维基百科印刷版的所有书卷从一楼搬到二楼后，Jurica 就一直背痛。因为他的背很疼，所以现在他想把所有的书放好，尽量少搬。请告诉他需要的执行**操作 $2$ 的次数**最少是多少，或者告诉他根本不可能把这些书搬回原来的位置。", "inputFormat": "输入共 $2n+1$ 行。\n\n第一行输入两个整数 $n,m$，分别表示书架个数和每个书架上的位置个数。  \n第 $2$ 到 $n+1$ 行，每行输入 $m$ 个整数 $a_{i,j}$，描述现在书架上摆书的情况。  \n第 $n+2$ 到 $2n+1$ 行，每行输入 $m$ 个整数 $b_{i,j}$，描述原来书架上摆书的情况。\n\n**输入保证原来和现在出现的书籍完全相同。**", "outputFormat": "如果 Jurica 根本不可能把这些书搬回原来的位置，则仅输出一个整数 $-1$。\n\n否则，输出一行一个整数，表示执行**操作 $2$ 的最少次数**。", "hint": "**【样例 1 解释】**\n\n以下是 Jurica 的操作序列：\n\n1. 操作 $1$：把 $1$ 号书籍移动到它右边的位置，也就是它所在书架上的第二个位置。\n2. 操作 $2$：把 $2$ 号书籍搬到它所在书架上的第一个位置。\n3. 操作 $2$：把 $5$ 号书籍搬到它所在书架上的第二个位置。\n\n可以证明没有更少执行操作 $2$ 的方案。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，保证每本书在初始和最终状态下都会在同一个书架上。  \n对于所有数据，$1\\leqslant n,m\\leqslant 1000$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T6 POLICE_**，按照原题数据配置，满分 $160$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2014/2015 #7] POLICE", "background": "", "description": "在图书管理员 Jurica 的图书馆里有 $n$ 个书架，每个书架有 $m$ 个位置，从左往右编号为 $1$ 到 $m$，并且每个位置上都可以放一本书。Jurica 是一个好的图书管理员，所以他决定对图书馆进行清点，如果有必要，就把不在自己位置上的书放回原来的位置。具体来说，现在第 $i$ 个书架上的第 $j$ 个位置上面摆着编号为 $a_{i,j}$ 的书（如果 $a_{i,j}=0$ 说明这个位置上面现在没有书），而原来在这个位置上摆着编号为 $b_{i,j}$ 的书（如果 $b_{i,j}=0$ 说明这个位置上面原来没有书）。他以下列操作移动书籍：\n\n- 操作 $1$：如果左边或右边有空位，可以在书架上向左或向右移动图书。\n- 操作 $2$：从书架上取下一本书，放在该书架或其他书架的空位上。\n\n细心的 Jurica 如果手中有书，就不能移动书。此外，他**不能同时拿多于一本书**。\n\n自从他不得不把维基百科印刷版的所有书卷从一楼搬到二楼后，Jurica 就一直背痛。因为他的背很疼，所以现在他想把所有的书放好，尽量少搬。请告诉他需要的执行**操作 $2$ 的次数**最少是多少，或者告诉他根本不可能把这些书搬回原来的位置。", "inputFormat": "输入共 $2n+1$ 行。\n\n第一行输入两个整数 $n,m$，分别表示书架个数和每个书架上的位置个数。  \n第 $2$ 到 $n+1$ 行，每行输入 $m$ 个整数 $a_{i,j}$，描述现在书架上摆书的情况。  \n第 $n+2$ 到 $2n+1$ 行，每行输入 $m$ 个整数 $b_{i,j}$，描述原来书架上摆书的情况。\n\n**输入保证原来和现在出现的书籍完全相同。**", "outputFormat": "如果 Jurica 根本不可能把这些书搬回原来的位置，则仅输出一个整数 $-1$。\n\n否则，输出一行一个整数，表示执行**操作 $2$ 的最少次数**。", "hint": "**【样例 1 解释】**\n\n以下是 Jurica 的操作序列：\n\n1. 操作 $1$：把 $1$ 号书籍移动到它右边的位置，也就是它所在书架上的第二个位置。\n2. 操作 $2$：把 $2$ 号书籍搬到它所在书架上的第一个位置。\n3. 操作 $2$：把 $5$ 号书籍搬到它所在书架上的第二个位置。\n\n可以证明没有更少执行操作 $2$ 的方案。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，保证每本书在初始和最终状态下都会在同一个书架上。  \n对于所有数据，$1\\leqslant n,m\\leqslant 1000$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T6 POLICE_**，按照原题数据配置，满分 $160$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7797", "type": "P", "difficulty": 1, "samples": [["2 S\nTH\n9C\nKS\nQS\nJS\nTD\nAD\nJH", "60"], ["4 H\nAH\nKH\nQH\nJH\nTH\n9H\n8H\n7H\nAS\nKS\nQS\nJS\nTS\n9S\n8S\n7S", "92"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2015", "COCI（克罗地亚）"], "title": "[COCI 2015/2016 #6] BELA", "background": "", "description": "有一个叫 $\\text{Belote}$ 的纸牌游戏，游戏只用到 `A`，`K`，`Q`，`J`，`T`，`9`，`8`，`7` 共八种纸牌。\n游戏规则就是将所有纸牌的值加起来，看看谁的值较大，谁就赢。每种纸牌的值都有两种，当其为**特殊牌**时有一个值，**非特殊牌**时也有一个值。每种卡牌的值见下表：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w1wpljth.png)\n\n现在 $\\text{Mirko}$ 有 $4\\times N$ 张纸牌，并已知特殊牌的属性为 $B$，请计算 $\\text{Mirko}$ 所有纸牌值的总和。", "inputFormat": "第一行包含整数 $N$ 和字符 $B$。\n\n接下来 $4\\times N$ 行，每行包含两个字符。第一个字符为这张纸牌的种类，第二个字符为这张纸牌的属性。若这张纸牌的属性 $=B$，则说明这张纸牌为特殊牌。", "outputFormat": "输出一个整数，为 $\\text{Mirko}$ 所有纸牌值的总和。", "hint": "**【样例 2 解释】**\n\n纸牌值总和为 $11 + 4 + 3 + 20 + 10 + 14 +\n0 + 0 + 11 + 4 + 3 + 2 + 10 + 0 + 0 + 0 = 92 $。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 100$，$B$ 和所有纸牌的属性都属于 `S`，`H`，`D`，`C` 四种字符中的一种，所有纸牌的种类都属于 `A`，`K`，`Q`，`J`，`T`，`9`，`8`，`7` 共八种纸牌中的一种。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T1 BELA**。\n\n**本题分值按 COCI 原题设置，满分 $50$**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2015/2016 #6] BELA", "background": "", "description": "有一个叫 $\\text{Belote}$ 的纸牌游戏，游戏只用到 `A`，`K`，`Q`，`J`，`T`，`9`，`8`，`7` 共八种纸牌。\n游戏规则就是将所有纸牌的值加起来，看看谁的值较大，谁就赢。每种纸牌的值都有两种，当其为**特殊牌**时有一个值，**非特殊牌**时也有一个值。每种卡牌的值见下表：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w1wpljth.png)\n\n现在 $\\text{Mirko}$ 有 $4\\times N$ 张纸牌，并已知特殊牌的属性为 $B$，请计算 $\\text{Mirko}$ 所有纸牌值的总和。", "inputFormat": "第一行包含整数 $N$ 和字符 $B$。\n\n接下来 $4\\times N$ 行，每行包含两个字符。第一个字符为这张纸牌的种类，第二个字符为这张纸牌的属性。若这张纸牌的属性 $=B$，则说明这张纸牌为特殊牌。", "outputFormat": "输出一个整数，为 $\\text{Mirko}$ 所有纸牌值的总和。", "hint": "**【样例 2 解释】**\n\n纸牌值总和为 $11 + 4 + 3 + 20 + 10 + 14 +\n0 + 0 + 11 + 4 + 3 + 2 + 10 + 0 + 0 + 0 = 92 $。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 100$，$B$ 和所有纸牌的属性都属于 `S`，`H`，`D`，`C` 四种字符中的一种，所有纸牌的种类都属于 `A`，`K`，`Q`，`J`，`T`，`9`，`8`，`7` 共八种纸牌中的一种。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T1 BELA**。\n\n**本题分值按 COCI 原题设置，满分 $50$**。", "locale": "zh-CN"}}}
{"pid": "P7798", "type": "P", "difficulty": 1, "samples": [["5 5\n3 1 2 1 1", "4"], ["7 5\n1 5 4 3 2 1 1", "3"], ["5 10\n3 2 5 4 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2015", "COCI（克罗地亚）"], "title": "[COCI 2015/2016 #6] PUTOVANJE", "background": "", "description": "$\\text{Mislav}$ 最喜欢在森林里度过时光，因为森林里有各种各样的水果，吃了每种水果都能获得一定的饱食度。但他不会使自己的总饱食度超过 $C$。\n\n现在森林里有一条小径，小径旁顺次种了 $N$ 个水果，每个水果都有一个饱食度 $w_i$。$\\text{Mislav}$ 可以选择从任意一个水果的位置开始，往第 $N$ 个水果前进。在前进的过程中，如果吃下当前位置的水果，总饱食度不会超过 $C$，他就**一定会吃下该水果**。否则，他就会**跳过该水果**，继续前进。\n\n请问 $\\text{Mislav}$ 能吃掉的水果个数最多是多少？", "inputFormat": "第一行包含两个整数 $N$ 和 $C$。\n\n第二行包含 $N$ 个整数 $w_i$，为第 $i$ 个水果的饱食度。", "outputFormat": "输出一个整数，为 $\\text{Mislav}$ 能吃掉的最多水果个数。", "hint": "**【样例 1 解释】**\n\n如果 $\\text{Mislav}$ 决定从第 $1$ 个水果开始吃，那么他可以吃到第 $1$、$2$、$4$ 个水果，一共吃了 $3$ 个。如果他从第 $2$ 种水果开始吃，那么他可以吃到第 $2$、$3$、$4$、$5$ 共 $4$ 个水果。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 1000$，$1\\le C\\le 10^6$，$1\\le w_i\\le 1000$。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T2 PUTOVANJE**。\n\n**本题分值按 COCI 原题设置，满分 $80$**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2015/2016 #6] PUTOVANJE", "background": "", "description": "$\\text{Mislav}$ 最喜欢在森林里度过时光，因为森林里有各种各样的水果，吃了每种水果都能获得一定的饱食度。但他不会使自己的总饱食度超过 $C$。\n\n现在森林里有一条小径，小径旁顺次种了 $N$ 个水果，每个水果都有一个饱食度 $w_i$。$\\text{Mislav}$ 可以选择从任意一个水果的位置开始，往第 $N$ 个水果前进。在前进的过程中，如果吃下当前位置的水果，总饱食度不会超过 $C$，他就**一定会吃下该水果**。否则，他就会**跳过该水果**，继续前进。\n\n请问 $\\text{Mislav}$ 能吃掉的水果个数最多是多少？", "inputFormat": "第一行包含两个整数 $N$ 和 $C$。\n\n第二行包含 $N$ 个整数 $w_i$，为第 $i$ 个水果的饱食度。", "outputFormat": "输出一个整数，为 $\\text{Mislav}$ 能吃掉的最多水果个数。", "hint": "**【样例 1 解释】**\n\n如果 $\\text{Mislav}$ 决定从第 $1$ 个水果开始吃，那么他可以吃到第 $1$、$2$、$4$ 个水果，一共吃了 $3$ 个。如果他从第 $2$ 种水果开始吃，那么他可以吃到第 $2$、$3$、$4$、$5$ 共 $4$ 个水果。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 1000$，$1\\le C\\le 10^6$，$1\\le w_i\\le 1000$。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T2 PUTOVANJE**。\n\n**本题分值按 COCI 原题设置，满分 $80$**。", "locale": "zh-CN"}}}
{"pid": "P7799", "type": "P", "difficulty": 3, "samples": [["5\n1 2 0 3 1", "3\n2"], ["7\n2 1 -6 -2 1 6 10", "5\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2015", "COCI（克罗地亚）"], "title": "[COCI 2015/2016 #6] PIANINO", "background": "", "description": "$\\text{Mirka}$ 是个业余钢琴家，她正在学习一首乐曲。但她不太能找准音，因此她会采用一种特殊的技巧。\n\n这首乐曲中有 $N$ 个音符，每个音符都有一个标准音 $a_i$。$\\text{Mirka}$ 能准确地弹出第一个音，接下来她会确定一个值 $K$。\n\n- 如果下一个音符的标准音大于当前音符的标准音，她就会将自己当前弹的音升高 $K$。\n- 如果下一个音符的标准音小于当前音符的标准音，她就会将自己当前弹的音降低 $K$。\n- 如果下一个音符的标准音等于当前音符的标准音，她不会改变当前弹的音。\n\n如果当前弹的音等于当前字符的标准音，就算 $\\text{Mirka}$ 弹准了一个音。请帮她确定一个非负整数 $K$，使得她弹准的音最多。", "inputFormat": "第一行包含一个整数 $N$。\n\n第二行包含 $N$ 个整数 $a_i$，其中 $a_i$ 为第 $i$ 个音符的标准音。", "outputFormat": "第一行输出一个整数，为 $\\text{Mirka}$ 最多能弹准的音。\n\n第二行输出一个非负整数，为 $K$ 的值。您只需输出**任意一种满足条件**的 $K$ 即可。", "hint": "**【样例 1 解释】**\n\n当 $K=2$ 时，她弹出的音为 **1**，3，1，**3**，**1**，共弹准了 $3$ 个音。\n\n注意 $K=1$ 也是一种可行的方案。\n\n**【样例 2 解释】**\n\n当 $K=4$ 时，她弹出的音为 **2**，-2，**-6**，**-2**，2，**6**，**10**，共弹准了 $5$ 个音。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$2\\le N\\le 10^6$，$-10^9\\le a_i\\le 10^9$。\n\n**【评分方式】**\n\n本题启用非官方的自行编写的 [Special Judge](https://www.luogu.com.cn/paste/i91dcbr2)，也可在附件中获取。欢迎大家 Hack（可私信或直接发帖）。Hack 数据作为测试点单独放在最后，对应测试点分数均为 0 分。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T3 PIANINO**。\n\n**本题分值按 COCI 原题设置，满分 $100$**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2015/2016 #6] PIANINO", "background": "", "description": "$\\text{Mirka}$ 是个业余钢琴家，她正在学习一首乐曲。但她不太能找准音，因此她会采用一种特殊的技巧。\n\n这首乐曲中有 $N$ 个音符，每个音符都有一个标准音 $a_i$。$\\text{Mirka}$ 能准确地弹出第一个音，接下来她会确定一个值 $K$。\n\n- 如果下一个音符的标准音大于当前音符的标准音，她就会将自己当前弹的音升高 $K$。\n- 如果下一个音符的标准音小于当前音符的标准音，她就会将自己当前弹的音降低 $K$。\n- 如果下一个音符的标准音等于当前音符的标准音，她不会改变当前弹的音。\n\n如果当前弹的音等于当前字符的标准音，就算 $\\text{Mirka}$ 弹准了一个音。请帮她确定一个非负整数 $K$，使得她弹准的音最多。", "inputFormat": "第一行包含一个整数 $N$。\n\n第二行包含 $N$ 个整数 $a_i$，其中 $a_i$ 为第 $i$ 个音符的标准音。", "outputFormat": "第一行输出一个整数，为 $\\text{Mirka}$ 最多能弹准的音。\n\n第二行输出一个非负整数，为 $K$ 的值。您只需输出**任意一种满足条件**的 $K$ 即可。", "hint": "**【样例 1 解释】**\n\n当 $K=2$ 时，她弹出的音为 **1**，3，1，**3**，**1**，共弹准了 $3$ 个音。\n\n注意 $K=1$ 也是一种可行的方案。\n\n**【样例 2 解释】**\n\n当 $K=4$ 时，她弹出的音为 **2**，-2，**-6**，**-2**，2，**6**，**10**，共弹准了 $5$ 个音。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$2\\le N\\le 10^6$，$-10^9\\le a_i\\le 10^9$。\n\n**【评分方式】**\n\n本题启用非官方的自行编写的 [Special Judge](https://www.luogu.com.cn/paste/i91dcbr2)，也可在附件中获取。欢迎大家 Hack（可私信或直接发帖）。Hack 数据作为测试点单独放在最后，对应测试点分数均为 0 分。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T3 PIANINO**。\n\n**本题分值按 COCI 原题设置，满分 $100$**。", "locale": "zh-CN"}}}
{"pid": "P7800", "type": "P", "difficulty": 4, "samples": [["2", "1"], ["3", "5"], ["4", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2015", "容斥原理", "COCI（克罗地亚）"], "title": "[COCI 2015/2016 #6] PAROVI", "background": null, "description": "$\\text{Mirko}$ 和 $\\text{Slavko}$ 在玩一个游戏，先由 $\\text{Mirko}$ 在 $1\\dots N$ 中选出几组互质的数（不能不选，且每组中的数不得相同）。例如当 $N=5$ 时，$\\text{Mirko}$ 可以选择 $\\big\\{\\{1,2\\},\\{3,4\\},\\{2,5\\},\\{3,5\\},\\cdots\\big\\}$ 中的几组。\n\n然后轮到 $\\text{Slavko}$。他需要找到一个 $x\\in \\big[2,N\\big]$ 使得对于每组 $\\{a,b\\}$ 都满足以下两个条件之一：\n\n- $a$，$b<x$\n\n- $a$，$b\\ge x$\n\n例如，如果 $\\text{Mirko}$ 选了 $\\big\\{\\{1,2\\},\\{3,4\\}\\big\\}$，那么 $x$ 可以等于 $3$。\n\n如果 $\\text{Slavko}$ 找不到满足条件的 $x$ 值，则表示 $\\text{Mirko}$ 获得胜利。现在请你求出 $\\text{Mirko}$ 获胜的不同情况的总数，在对 $10^9$ 取模后告诉他。", "inputFormat": "第一行包含一个整数 $N$。", "outputFormat": "第一行输出一个整数，为 $\\text{Mirko}$ 获胜的不同情况的总数对 $10^9$ 取模后的值。", "hint": "**【样例 1 解释】**\n\n$\\text{Slavko}$ 只有一种取法 $\\big\\{\\{1,2\\}\\big\\}$。\n\n**【样例 2 解释】**\n\n$\\text{Slavko}$ 的其中一种取法为 $\\big\\{\\{1,2\\},\\{1,3\\}\\big\\}$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 20$。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T4 PAROVI**。\n\n**本题分值按 COCI 原题设置，满分 $120$**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2015/2016 #6] PAROVI", "background": null, "description": "$\\text{Mirko}$ 和 $\\text{Slavko}$ 在玩一个游戏，先由 $\\text{Mirko}$ 在 $1\\dots N$ 中选出几组互质的数（不能不选，且每组中的数不得相同）。例如当 $N=5$ 时，$\\text{Mirko}$ 可以选择 $\\big\\{\\{1,2\\},\\{3,4\\},\\{2,5\\},\\{3,5\\},\\cdots\\big\\}$ 中的几组。\n\n然后轮到 $\\text{Slavko}$。他需要找到一个 $x\\in \\big[2,N\\big]$ 使得对于每组 $\\{a,b\\}$ 都满足以下两个条件之一：\n\n- $a$，$b<x$\n\n- $a$，$b\\ge x$\n\n例如，如果 $\\text{Mirko}$ 选了 $\\big\\{\\{1,2\\},\\{3,4\\}\\big\\}$，那么 $x$ 可以等于 $3$。\n\n如果 $\\text{Slavko}$ 找不到满足条件的 $x$ 值，则表示 $\\text{Mirko}$ 获得胜利。现在请你求出 $\\text{Mirko}$ 获胜的不同情况的总数，在对 $10^9$ 取模后告诉他。", "inputFormat": "第一行包含一个整数 $N$。", "outputFormat": "第一行输出一个整数，为 $\\text{Mirko}$ 获胜的不同情况的总数对 $10^9$ 取模后的值。", "hint": "**【样例 1 解释】**\n\n$\\text{Slavko}$ 只有一种取法 $\\big\\{\\{1,2\\}\\big\\}$。\n\n**【样例 2 解释】**\n\n$\\text{Slavko}$ 的其中一种取法为 $\\big\\{\\{1,2\\},\\{1,3\\}\\big\\}$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 20$。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T4 PAROVI**。\n\n**本题分值按 COCI 原题设置，满分 $120$**。", "locale": "zh-CN"}}}
{"pid": "P7801", "type": "P", "difficulty": 5, "samples": [["3 1\n3 2 1\n1 2 3", "0.556"], ["3 2\n2 2 2\n3 3 3", "2.250"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["动态规划 DP", "2015", "COCI（克罗地亚）"], "title": "[COCI 2015/2016 #6] KRUMPIRKO", "background": "", "description": "$\\text{Mr. Potato}$ 开了两家新店卖土豆。他买了 $N$ 袋土豆，其中第 $i$ 袋价值为 $c_i$，袋里有 $a_i$ 个土豆。他打算把这 $N$ 袋土豆整袋整袋地分在两个店里。\n\n在每家店中，土豆的平均价格等于这家店里**所有袋的土豆的总价比上土豆的个数**。（注意是个数而不是袋数！）\n\n设 $P_1$ 为第一家店的土豆平均价格，$P_2$ 为第二家店的土豆平均价格。$\\text{Mr. Potato}$ 希望在至少有一家店里土豆袋数**正好等于 $L$ 袋**的情况下，最小化 $P_1\\times P_2$ 的值。", "inputFormat": "第一行包含两个整数 $N$ 和 $L$。\n\n第二行包含 $N$ 个整数 $a_i$。\n\n第三行包含 $N$ 个整数 $c_i$。", "outputFormat": "第一行输出一个浮点数，为 $P_1\\times P_2$ 的最小值，保留到小数点后三位。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，$2\\le N\\le 20$。\n\n对于 $100\\%$ 的数据，$2\\le N\\le 100$，$1\\le L< N$，$1\\le a_i\\le 100$，$1\\le c_i\\le 10^6$，$\\sum\\limits_{i=1}^{N} a_i\\le 500$。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T5 KRUMPIRKO**。\n\n**本题分值按 COCI 原题设置，满分 $140$**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2015/2016 #6] KRUMPIRKO", "background": "", "description": "$\\text{Mr. Potato}$ 开了两家新店卖土豆。他买了 $N$ 袋土豆，其中第 $i$ 袋价值为 $c_i$，袋里有 $a_i$ 个土豆。他打算把这 $N$ 袋土豆整袋整袋地分在两个店里。\n\n在每家店中，土豆的平均价格等于这家店里**所有袋的土豆的总价比上土豆的个数**。（注意是个数而不是袋数！）\n\n设 $P_1$ 为第一家店的土豆平均价格，$P_2$ 为第二家店的土豆平均价格。$\\text{Mr. Potato}$ 希望在至少有一家店里土豆袋数**正好等于 $L$ 袋**的情况下，最小化 $P_1\\times P_2$ 的值。", "inputFormat": "第一行包含两个整数 $N$ 和 $L$。\n\n第二行包含 $N$ 个整数 $a_i$。\n\n第三行包含 $N$ 个整数 $c_i$。", "outputFormat": "第一行输出一个浮点数，为 $P_1\\times P_2$ 的最小值，保留到小数点后三位。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，$2\\le N\\le 20$。\n\n对于 $100\\%$ 的数据，$2\\le N\\le 100$，$1\\le L< N$，$1\\le a_i\\le 100$，$1\\le c_i\\le 10^6$，$\\sum\\limits_{i=1}^{N} a_i\\le 500$。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T5 KRUMPIRKO**。\n\n**本题分值按 COCI 原题设置，满分 $140$**。", "locale": "zh-CN"}}}
{"pid": "P7802", "type": "P", "difficulty": 6, "samples": [["2\n1 10\n5 8", "18\n8"], ["3\n17 144\n121 121\n89 98", "265\n25\n10"], ["1\n1 1000000000", "1863025563"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "COCI（克罗地亚）"], "title": "[COCI 2015/2016 #6] SAN", "background": "", "description": "$\\text{Anica}$ 有一张神秘的无限表，表里有无限行和无限列。有趣的是，表中的每个数字出现的次数是有限的。\n\n定义函数 $\\mathrm{rev}(i)$，返回 $i$ 在十进制下翻转后得到的新数字。例如 $\\mathrm{rev}(213)=312$，$\\mathrm{rev}(406800)=008604=8604$。\n\n表中第 $i$ 行第 $j$ 列的数字 $A(i,j)$ 由以下方式得到：\n\n- $A(i,1)=i$\n\n- $A(i, j) = A(i, j − 1)+\\mathrm{rev}\\big(A(i,j-1)\\big)$，$j>1$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/aqhn1qzp.png)\n\n现在 $\\text{Anica}$ 给出 $Q$ 个询问，每个询问给出两个整数 $L$ 和 $R$，请你求出无限表中有多少个数的大小在 $\\big[L,R\\big]$ 中。", "inputFormat": "第一行包含一个整数 $Q$。\n\n接下来 $Q$ 行，每行包含两个整数 $L$ 和 $R$。", "outputFormat": "输出包含 $Q$ 行，每行一个整数，其中第 $i$ 行为第 $i$ 个问题的答案。", "hint": "**【数据范围】**\n\n对于 $50\\%$ 的数据，保证 $1\\le L,R\\le 10^6$。\n\n对于 $100\\%$ 的数据，保证 $1\\le Q\\le 10^5$，$1\\le L,R\\le 10^{10}$。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T6 SAN**。\n\n**本题分值按 COCI 原题设置，满分 $160$**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2015/2016 #6] SAN", "background": "", "description": "$\\text{Anica}$ 有一张神秘的无限表，表里有无限行和无限列。有趣的是，表中的每个数字出现的次数是有限的。\n\n定义函数 $\\mathrm{rev}(i)$，返回 $i$ 在十进制下翻转后得到的新数字。例如 $\\mathrm{rev}(213)=312$，$\\mathrm{rev}(406800)=008604=8604$。\n\n表中第 $i$ 行第 $j$ 列的数字 $A(i,j)$ 由以下方式得到：\n\n- $A(i,1)=i$\n\n- $A(i, j) = A(i, j − 1)+\\mathrm{rev}\\big(A(i,j-1)\\big)$，$j>1$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/aqhn1qzp.png)\n\n现在 $\\text{Anica}$ 给出 $Q$ 个询问，每个询问给出两个整数 $L$ 和 $R$，请你求出无限表中有多少个数的大小在 $\\big[L,R\\big]$ 中。", "inputFormat": "第一行包含一个整数 $Q$。\n\n接下来 $Q$ 行，每行包含两个整数 $L$ 和 $R$。", "outputFormat": "输出包含 $Q$ 行，每行一个整数，其中第 $i$ 行为第 $i$ 个问题的答案。", "hint": "**【数据范围】**\n\n对于 $50\\%$ 的数据，保证 $1\\le L,R\\le 10^6$。\n\n对于 $100\\%$ 的数据，保证 $1\\le Q\\le 10^5$，$1\\le L,R\\le 10^{10}$。\n\n**【题目来源】**\n\n**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T6 SAN**。\n\n**本题分值按 COCI 原题设置，满分 $160$**。", "locale": "zh-CN"}}}
{"pid": "P7803", "type": "P", "difficulty": 6, "samples": [["4\nJOJO\nJJOI\nOJOO\n3\nIJOJ\n1 4 O\n2 2 J\n2 4 I", "Yes\nNo\nYes\nYes"], ["3\nJOI\nJOI\nJOI\n2\nOJI\n1 2 O\n1 1 J", "No\nNo\nYes"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "2021", "JOI（日本）"], "title": "[JOI Open 2021] 杂交 / Crossing", "background": "**警告：滥用本题评测将被封号。**", "description": "你的资源库里有 $3$ 个长度为 $N$ 的只由 `J`，`O`，`I` 组成的序列 $S_A,S_B,S_C$，你可以进行 C 操作（全名为 Cross 操作，简写为 C 操作），每一次 C 操作你可以在资源库里选择两个字符串 $C_1,C_2$，C 操作后产生的字符串为 $C_3$，则对于任意 $i \\in [1,N]$，设这三个字符串第 $i$ 个位置上的字符分别为 $c_1,c_2,c_3$，有：\n\n|$c_1$|$c_2$|$c_3$|\n|:-:|:-:|:-:|\n|J|J|J|\n|J|O|I|\n|J|I|O|\n|O|J|I|\n|O|O|O|\n|O|I|J|\n|I|J|O|\n|I|O|J|\n|I|I|I|\n\n上面这个表格的意思是 $c_1,c_2$ 为对应字符时，$c_3$ 也应该是对应的字符。\n\n进行 C 操作后将会把产生的字符串放入资源库。\n\n你被给定了一个长度为 $N$ 的只由 `J`，`O`，`I` 组成的字符串 $T_0$，和 $Q$ 个整数 $L_j,R_j$ 和 $Q$ 个字符 $C_j$，由这些形成 $Q$ 个长度为 $N$ 的字符串 $T_j$，规则为：\n\n> $T_j$ 是由 $T_{j-1}$ 的第 $L_j$ 个字符到第 $R_j$ 个字符都替换成 $C_j$ 得到的。\n\n求对于每一个字符串（包括 $T_0$），是否能由给定的资源库进行一次或多次 C 操作得来。如果该字符串与资源库的其中一个字符串一模一样，也可以称“进行 C 操作得来”，详细内容请看样例 1 的 $T_2$。\n\n第 $j$ 个字符串进行 C 操作时放入资源库的字符串将会在对第 $j+1$ 个字符串判断时清空。", "inputFormat": "第一行一个整数 $N$ 代表字符串的长度。\n\n接下来 $3$ 行 $S_A,S_B,S_C$ 代表给定的资源库里的字符串。\n\n第五行一个整数 $Q$ 代表给定的字符串个数。\n\n第六行一个字符串 $T_0$，意义如题面所述。\n\n接下来 $Q$ 行每行两个整数和一个字符 $L_j,R_j,C_j$，意义如题面所述。", "outputFormat": "$Q+1$ 行每行一个字符串 `Yes` 或 `No`，第 $j$ 行代表第 $T_{j-1}$ 个字符串是否可以由初始资源库得来。", "hint": "#### 样例 1 解释\n\n- $T_0$ 可以由 `JJOI` 和 `OJOO` 经过 C 操作而来；\n- $T_1$ 为 `OOOO`，无法从资源库经过 C 操作而来；\n- $T_2$ 为 `OJOO`，资源库中有 `OJOO`，故可以；\n- $T_3$ 为 `OIII`：\n\t1. 由 `JJOI` 和 `OJOO` 经过 C 操作产生 `IJOJ`；\n    2. 由 `JOJO` 和 `IJOJ` 经过 C 操作产生 `OIII`。\n    \n#### 样例 2 解释\n\n- $T_0$ 无法从资源库经过 C 操作而来；\n- $T_1$ 为 `OOI`，无法从资源库经过 C 操作而来；\n- $T_2$ 为 `JOI`，资源库中有 `JOI`，故可以。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（3 pts）：$S_A=S_B=S_C$，$N \\le 100$；\n- Subtask 2（23 pts）：$S_A=S_B=S_C$；\n- Subtask 3（23 pts）：$N \\le 100$；\n- Subtask 4（51 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le N \\le 2 \\times 10^5$；\n- $S_A,S_B,S_C$ 是只包含 `J`，`O`，`I` 的长度为 $N$ 的字符串；\n- $1 \\le Q \\le 2 \\times 10^5$；\n- $T_0$ 是只包含 `J`，`O`，`I` 的长度为 $N$ 的字符串；\n- $1 \\le L_j \\le R_j \\le N$；\n- $C_j \\in  \\{$`J`，`O`，`I`$\\}$。 \n\n#### 说明\n\n翻译自 [JOI 2020 / 2021 Open Contest A Crossing](http://s3-ap-northeast-1.amazonaws.com/data.cms.ioi-jp.org/open-2021/crossing/2021-open-crossing-statement-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI Open 2021] 杂交 / Crossing", "background": "**警告：滥用本题评测将被封号。**", "description": "你的资源库里有 $3$ 个长度为 $N$ 的只由 `J`，`O`，`I` 组成的序列 $S_A,S_B,S_C$，你可以进行 C 操作（全名为 Cross 操作，简写为 C 操作），每一次 C 操作你可以在资源库里选择两个字符串 $C_1,C_2$，C 操作后产生的字符串为 $C_3$，则对于任意 $i \\in [1,N]$，设这三个字符串第 $i$ 个位置上的字符分别为 $c_1,c_2,c_3$，有：\n\n|$c_1$|$c_2$|$c_3$|\n|:-:|:-:|:-:|\n|J|J|J|\n|J|O|I|\n|J|I|O|\n|O|J|I|\n|O|O|O|\n|O|I|J|\n|I|J|O|\n|I|O|J|\n|I|I|I|\n\n上面这个表格的意思是 $c_1,c_2$ 为对应字符时，$c_3$ 也应该是对应的字符。\n\n进行 C 操作后将会把产生的字符串放入资源库。\n\n你被给定了一个长度为 $N$ 的只由 `J`，`O`，`I` 组成的字符串 $T_0$，和 $Q$ 个整数 $L_j,R_j$ 和 $Q$ 个字符 $C_j$，由这些形成 $Q$ 个长度为 $N$ 的字符串 $T_j$，规则为：\n\n> $T_j$ 是由 $T_{j-1}$ 的第 $L_j$ 个字符到第 $R_j$ 个字符都替换成 $C_j$ 得到的。\n\n求对于每一个字符串（包括 $T_0$），是否能由给定的资源库进行一次或多次 C 操作得来。如果该字符串与资源库的其中一个字符串一模一样，也可以称“进行 C 操作得来”，详细内容请看样例 1 的 $T_2$。\n\n第 $j$ 个字符串进行 C 操作时放入资源库的字符串将会在对第 $j+1$ 个字符串判断时清空。", "inputFormat": "第一行一个整数 $N$ 代表字符串的长度。\n\n接下来 $3$ 行 $S_A,S_B,S_C$ 代表给定的资源库里的字符串。\n\n第五行一个整数 $Q$ 代表给定的字符串个数。\n\n第六行一个字符串 $T_0$，意义如题面所述。\n\n接下来 $Q$ 行每行两个整数和一个字符 $L_j,R_j,C_j$，意义如题面所述。", "outputFormat": "$Q+1$ 行每行一个字符串 `Yes` 或 `No`，第 $j$ 行代表第 $T_{j-1}$ 个字符串是否可以由初始资源库得来。", "hint": "#### 样例 1 解释\n\n- $T_0$ 可以由 `JJOI` 和 `OJOO` 经过 C 操作而来；\n- $T_1$ 为 `OOOO`，无法从资源库经过 C 操作而来；\n- $T_2$ 为 `OJOO`，资源库中有 `OJOO`，故可以；\n- $T_3$ 为 `OIII`：\n\t1. 由 `JJOI` 和 `OJOO` 经过 C 操作产生 `IJOJ`；\n    2. 由 `JOJO` 和 `IJOJ` 经过 C 操作产生 `OIII`。\n    \n#### 样例 2 解释\n\n- $T_0$ 无法从资源库经过 C 操作而来；\n- $T_1$ 为 `OOI`，无法从资源库经过 C 操作而来；\n- $T_2$ 为 `JOI`，资源库中有 `JOI`，故可以。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（3 pts）：$S_A=S_B=S_C$，$N \\le 100$；\n- Subtask 2（23 pts）：$S_A=S_B=S_C$；\n- Subtask 3（23 pts）：$N \\le 100$；\n- Subtask 4（51 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le N \\le 2 \\times 10^5$；\n- $S_A,S_B,S_C$ 是只包含 `J`，`O`，`I` 的长度为 $N$ 的字符串；\n- $1 \\le Q \\le 2 \\times 10^5$；\n- $T_0$ 是只包含 `J`，`O`，`I` 的长度为 $N$ 的字符串；\n- $1 \\le L_j \\le R_j \\le N$；\n- $C_j \\in  \\{$`J`，`O`，`I`$\\}$。 \n\n#### 说明\n\n翻译自 [JOI 2020 / 2021 Open Contest A Crossing](http://s3-ap-northeast-1.amazonaws.com/data.cms.ioi-jp.org/open-2021/crossing/2021-open-crossing-statement-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7804", "type": "P", "difficulty": 5, "samples": [["7 1\n100 600 600 200 300 500 500", "3"], ["6 6\n100 500 200 400 600 300", "4"], ["11 2\n1 4 4 2 2 4 9 5 7 0 3", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "JOI（日本）"], "title": "[JOI Open 2021] 决算报告 / Financial Report", "background": "**警告：滥用本题评测将被封号。**", "description": "有一个长度为 $N$ 的序列 $A_i$，定义函数 $f(m,p_1,p_2,\\cdots,p_m)$ 的值为满足：\n\n$$\\max\\limits_{j=1}^{i-1}\\{A_{p_j}\\} < A_{p_i}$$\n\n的 $p_i$ 的个数，当 $i=1$ 时，我们假设上面这个不等式是恒成立的。\n\n给定一个整数 $D$，求一个序列 $p_i$ 满足：\n\n- $1 \\le m \\le N$；\n- $p_m=N$；\n- $p_i<p_{i+1}$；\n- 如果 $m \\ge 2$，那么有 $p_{j+1}-p_j \\le D$；\n- $f(m,p_1,p_2,\\dots,p_m)$ 的值最大。\n\n求 $f$ 函数的最大值。", "inputFormat": "第一行两个整数 $N,D$，意义如题面所述。\n\n第二行 $N$ 个整数 $A_i$ 代表给定的序列。", "outputFormat": "一行一个整数代表 $f$ 函数的最大值。", "hint": "#### 样例 1 解释\n\n一共有 $7$ 种可能的情况：\n\n- $p_i=\\{1,2,3,4,5,6,7\\}$，$f(7,1,2,3,4,5,6,7)=2$；\n- $p_i=\\{2,3,4,5,6,7\\}$，$f(6,2,3,4,5,6,7)=1$；\n- $p_i=\\{3,4,5,6,7\\}$，$f(5,3,4,5,6,7)=1$；\n- $p_i=\\{4,5,6,7\\}$，$f(4,4,5,6,7)=3$；\n- $p_i=\\{5,6,7\\}$，$f(3,5,6,7)=2$；\n- $p_i=\\{6,7\\}$，$f(2,6,7)=1$；\n- $p_i=\\{7\\}$，$f(1,7)=1$。\n\n最大值为 $3$。\n\n#### 样例 2 解释\n\n最优的 $p_i=\\{1,3,4,5,6\\}$，对应的 $A_i=\\{100,200,400,600,300\\}$，$f$ 函数值为 $4$。\n\n#### 样例 3 解释\n\n最优的方式有多种，其中一种是 $p_i=\\{1,3,5,6,8,9,11\\}$，对应的 $A_i=\\{ 1, 4, 2, 4, 5, 7, 3\\}$，$f$ 函数值为 $4$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（14 pts）：$N \\le 20$；\n- Subtask 2（14 pts）：$N \\le 400$；\n- Subtask 3（20 pts）：$N \\le 7000$；\n- Subtask 4（12 pts）：$D=1$；\n- Subtask 5（5 pts）：$D=N$；\n- Subtask 6（35 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le N \\le 3 \\times 10^5$；\n- $1 \\le D \\le N$；\n- $0 \\le A_i \\le 10^9$。\n\n#### 说明\n\n翻译自 [JOI 2020 / 2021 Open Contest B Financial Report](http://s3-ap-northeast-1.amazonaws.com/data.cms.ioi-jp.org/open-2021/financial/2021-open-financial-statement-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI Open 2021] 决算报告 / Financial Report", "background": "**警告：滥用本题评测将被封号。**", "description": "有一个长度为 $N$ 的序列 $A_i$，定义函数 $f(m,p_1,p_2,\\cdots,p_m)$ 的值为满足：\n\n$$\\max\\limits_{j=1}^{i-1}\\{A_{p_j}\\} < A_{p_i}$$\n\n的 $p_i$ 的个数，当 $i=1$ 时，我们假设上面这个不等式是恒成立的。\n\n给定一个整数 $D$，求一个序列 $p_i$ 满足：\n\n- $1 \\le m \\le N$；\n- $p_m=N$；\n- $p_i<p_{i+1}$；\n- 如果 $m \\ge 2$，那么有 $p_{j+1}-p_j \\le D$；\n- $f(m,p_1,p_2,\\dots,p_m)$ 的值最大。\n\n求 $f$ 函数的最大值。", "inputFormat": "第一行两个整数 $N,D$，意义如题面所述。\n\n第二行 $N$ 个整数 $A_i$ 代表给定的序列。", "outputFormat": "一行一个整数代表 $f$ 函数的最大值。", "hint": "#### 样例 1 解释\n\n一共有 $7$ 种可能的情况：\n\n- $p_i=\\{1,2,3,4,5,6,7\\}$，$f(7,1,2,3,4,5,6,7)=2$；\n- $p_i=\\{2,3,4,5,6,7\\}$，$f(6,2,3,4,5,6,7)=1$；\n- $p_i=\\{3,4,5,6,7\\}$，$f(5,3,4,5,6,7)=1$；\n- $p_i=\\{4,5,6,7\\}$，$f(4,4,5,6,7)=3$；\n- $p_i=\\{5,6,7\\}$，$f(3,5,6,7)=2$；\n- $p_i=\\{6,7\\}$，$f(2,6,7)=1$；\n- $p_i=\\{7\\}$，$f(1,7)=1$。\n\n最大值为 $3$。\n\n#### 样例 2 解释\n\n最优的 $p_i=\\{1,3,4,5,6\\}$，对应的 $A_i=\\{100,200,400,600,300\\}$，$f$ 函数值为 $4$。\n\n#### 样例 3 解释\n\n最优的方式有多种，其中一种是 $p_i=\\{1,3,5,6,8,9,11\\}$，对应的 $A_i=\\{ 1, 4, 2, 4, 5, 7, 3\\}$，$f$ 函数值为 $4$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（14 pts）：$N \\le 20$；\n- Subtask 2（14 pts）：$N \\le 400$；\n- Subtask 3（20 pts）：$N \\le 7000$；\n- Subtask 4（12 pts）：$D=1$；\n- Subtask 5（5 pts）：$D=N$；\n- Subtask 6（35 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le N \\le 3 \\times 10^5$；\n- $1 \\le D \\le N$；\n- $0 \\le A_i \\le 10^9$。\n\n#### 说明\n\n翻译自 [JOI 2020 / 2021 Open Contest B Financial Report](http://s3-ap-northeast-1.amazonaws.com/data.cms.ioi-jp.org/open-2021/financial/2021-open-financial-statement-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7805", "type": "P", "difficulty": 6, "samples": [["5\n3 1 4 2 0", ""]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "交互题", "Special Judge", "JOI（日本）"], "title": "[JOI Open 2021] 怪兽游戏 / Monster Game", "background": "**本题为交互题。**\n\n交互库与 spj 提供者 @[Liking_Cpp_In_Luogu](https://www.luogu.com.cn/user/705620)，感谢他的贡献！\n\n请不要在代码中加入头文件 `monster.h`，在 Solve 函数前加上 `extern \"C\"`，开头加上 `extern \"C\" bool Query(int,int);` 即可。", "description": "你圈养了 $N$ 只书虫，这 $N$ 只书虫编号为 $0 \\sim N-1$，第 $i$ 只书虫的力量值为 $S_i$，满足 $S_i \\in [0,N-1]$，且没有两只书虫的力量值是相等的。\n\n你可以调用最多 $25000$ 次「打架事件」：\n\n- 选择两只编号不相同的书虫 $a,b$：\n\t- 如果 $|S_a-S_b|=1$，则力量值小的书虫获胜；\n    - 如果 $|S_a-S_b|>1$，则力量值大的书虫获胜。\n\n请最小化调用「打架事件」的次数，你可以得到每次「打架事件」的结果，求所有书虫的力量值。\n\n#### 交互格式\n\n你的程序需要实现以下函数：\n\n- `std::vector<int> Solve(int N)`\n\t- 对于每组数据，该函数只能被调用一次；\n    - $N$：书虫的个数；\n    - 该函数返回这 $N$ 只书虫的力量值数组 $T$；\n    - 应该满足 $|T|=N$，否则您的程序将会被判为 `Wrong\nAnswer [1]`；\n\t- 应该满足 $T_i\\in [0,N-1]$，否则您的程序将会被判为 `Wrong Answer [2]`；\n    - 应该满足 $T_i=S_i$，否则您的程序将会被判为 `Wrong Answer [3]`。\n\n你的程序可以调用以下函数：\n\n- `bool Query(int a, int b)`\n\t- 你可以用这个函数调用「打架事件」；\n    - $a,b$：书虫 $a$ 与书虫 $b$ 打架；\n    - 如果 $a$ 获胜了，则返回 `true` 否则返回 `false`；\n    - 应该满足 $a \\in [0,N-1]\\land b \\in [0,N-1]$，否则您的程序将会被判为 `Wrong Answer [4]`；\n    - 应该满足 $a \\ne b$，否则您的程序将会被判为 `Wrong Answer [5]`；\n    - 调用 `Query` 函数应该不超过 $25000$ 次。否则您的程序将会被判为 `Wrong Answer [6]`。\n    \n**特殊说明**\n\n1. 您的程序可以调用其他标准库里的函数，或者使用全局变量；\n2. 您的程序不得使用标准输入与标准输出。", "inputFormat": "见「交互格式」。", "outputFormat": "见「交互格式」。", "hint": "#### 样例 1 解释\n\n样例的交互过程：\n\n|调用|返回|调用|返回|\n|:-:|:-:|:-:|:-:|\n|`Solve(5)`||||\n|||`Query(1, 0)`|`false`|\n|||`Query(4, 0)`|`false`|\n|||`Query(1, 3)`|`true`|\n||`[3, 1, 4, 2, 0]`||\n\n#### 评测程序示例（样例）\n\n评测程序示例以如下格式读取输⼊数据：\n\n第一行：$N$       \n第二行：$S_0\\ S_1\\ \\cdots\\ S_{N-1}$\n\n评测程序示例以如下格式读取输出数据：\n\n当程序成功结束运行后，样例交互器会在标准输出中输出以下内容：\n\n- 如果你的程序被判为正确，样例交互器会输出类似 `Accepted: 100` 的信息，其中 $100$ 为你的程序调用 `Query` 函数的次数；\n- 如果你的程序被判为错误，样例交互器的输出内容已在「交互格式」中描述。\n\n如果你的程序有多数错误，样例交互器只会判断其中的一种。\n\n注意，交互器在某些数据中是自适应性的，也就是实际的交互器刚开始并没有一个确定的答案，而是会随着之前 `Query` 函数的调用逐渐做出响应，能保证至少有一组答案满足交互库做出的响应。\n\n（本来原题有一个工具可以用来检测，但是找不到检测文件了，所以就咕掉了）\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：$N \\le 200$；\n- Subtask 2（15 pts）：实际使用的交互库并不是自适应性的；\n- Subtask 3（75 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：\n\n- $4 \\le N \\le 1000$；\n- $0 \\le S_i \\le N-1$；\n- $S_i$ 保证互不相同。\n\n对于 Subtask 3，特有一套评分标准：\n\n如果你的程序通过了所有测试数据，那：\n\n- 设 $X$ 为 Subtask 3 中你的程序对每个测试点调用的 `Query` 函数的次数的最大值；\n- 你的分数将按照下面的过程计算：\t\n\t- 如果 $10^4<X \\le 2.5 \\times 10^4$，你将得到 $\\left\\lfloor75 \\times \\dfrac{2.5 \\times 10^4-X}{1.5 \\times 10^4}\\right\\rfloor$ 分；\n    - 如果 $X \\le 10^4$，你将得到 $75$ 分。\n    \n#### 说明\n\n翻译自 [JOI 2020 / 2021 Open Contest C Monster Game](http://s3-ap-northeast-1.amazonaws.com/data.cms.ioi-jp.org/open-2021/monster/2021-open-monster-statement-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI Open 2021] 怪兽游戏 / Monster Game", "background": "**本题为交互题。**\n\n交互库与 spj 提供者 @[Liking_Cpp_In_Luogu](https://www.luogu.com.cn/user/705620)，感谢他的贡献！\n\n请不要在代码中加入头文件 `monster.h`，在 Solve 函数前加上 `extern \"C\"`，开头加上 `extern \"C\" bool Query(int,int);` 即可。", "description": "你圈养了 $N$ 只书虫，这 $N$ 只书虫编号为 $0 \\sim N-1$，第 $i$ 只书虫的力量值为 $S_i$，满足 $S_i \\in [0,N-1]$，且没有两只书虫的力量值是相等的。\n\n你可以调用最多 $25000$ 次「打架事件」：\n\n- 选择两只编号不相同的书虫 $a,b$：\n\t- 如果 $|S_a-S_b|=1$，则力量值小的书虫获胜；\n    - 如果 $|S_a-S_b|>1$，则力量值大的书虫获胜。\n\n请最小化调用「打架事件」的次数，你可以得到每次「打架事件」的结果，求所有书虫的力量值。\n\n#### 交互格式\n\n你的程序需要实现以下函数：\n\n- `std::vector<int> Solve(int N)`\n\t- 对于每组数据，该函数只能被调用一次；\n    - $N$：书虫的个数；\n    - 该函数返回这 $N$ 只书虫的力量值数组 $T$；\n    - 应该满足 $|T|=N$，否则您的程序将会被判为 `Wrong\nAnswer [1]`；\n\t- 应该满足 $T_i\\in [0,N-1]$，否则您的程序将会被判为 `Wrong Answer [2]`；\n    - 应该满足 $T_i=S_i$，否则您的程序将会被判为 `Wrong Answer [3]`。\n\n你的程序可以调用以下函数：\n\n- `bool Query(int a, int b)`\n\t- 你可以用这个函数调用「打架事件」；\n    - $a,b$：书虫 $a$ 与书虫 $b$ 打架；\n    - 如果 $a$ 获胜了，则返回 `true` 否则返回 `false`；\n    - 应该满足 $a \\in [0,N-1]\\land b \\in [0,N-1]$，否则您的程序将会被判为 `Wrong Answer [4]`；\n    - 应该满足 $a \\ne b$，否则您的程序将会被判为 `Wrong Answer [5]`；\n    - 调用 `Query` 函数应该不超过 $25000$ 次。否则您的程序将会被判为 `Wrong Answer [6]`。\n    \n**特殊说明**\n\n1. 您的程序可以调用其他标准库里的函数，或者使用全局变量；\n2. 您的程序不得使用标准输入与标准输出。", "inputFormat": "见「交互格式」。", "outputFormat": "见「交互格式」。", "hint": "#### 样例 1 解释\n\n样例的交互过程：\n\n|调用|返回|调用|返回|\n|:-:|:-:|:-:|:-:|\n|`Solve(5)`||||\n|||`Query(1, 0)`|`false`|\n|||`Query(4, 0)`|`false`|\n|||`Query(1, 3)`|`true`|\n||`[3, 1, 4, 2, 0]`||\n\n#### 评测程序示例（样例）\n\n评测程序示例以如下格式读取输⼊数据：\n\n第一行：$N$       \n第二行：$S_0\\ S_1\\ \\cdots\\ S_{N-1}$\n\n评测程序示例以如下格式读取输出数据：\n\n当程序成功结束运行后，样例交互器会在标准输出中输出以下内容：\n\n- 如果你的程序被判为正确，样例交互器会输出类似 `Accepted: 100` 的信息，其中 $100$ 为你的程序调用 `Query` 函数的次数；\n- 如果你的程序被判为错误，样例交互器的输出内容已在「交互格式」中描述。\n\n如果你的程序有多数错误，样例交互器只会判断其中的一种。\n\n注意，交互器在某些数据中是自适应性的，也就是实际的交互器刚开始并没有一个确定的答案，而是会随着之前 `Query` 函数的调用逐渐做出响应，能保证至少有一组答案满足交互库做出的响应。\n\n（本来原题有一个工具可以用来检测，但是找不到检测文件了，所以就咕掉了）\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：$N \\le 200$；\n- Subtask 2（15 pts）：实际使用的交互库并不是自适应性的；\n- Subtask 3（75 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：\n\n- $4 \\le N \\le 1000$；\n- $0 \\le S_i \\le N-1$；\n- $S_i$ 保证互不相同。\n\n对于 Subtask 3，特有一套评分标准：\n\n如果你的程序通过了所有测试数据，那：\n\n- 设 $X$ 为 Subtask 3 中你的程序对每个测试点调用的 `Query` 函数的次数的最大值；\n- 你的分数将按照下面的过程计算：\t\n\t- 如果 $10^4<X \\le 2.5 \\times 10^4$，你将得到 $\\left\\lfloor75 \\times \\dfrac{2.5 \\times 10^4-X}{1.5 \\times 10^4}\\right\\rfloor$ 分；\n    - 如果 $X \\le 10^4$，你将得到 $75$ 分。\n    \n#### 说明\n\n翻译自 [JOI 2020 / 2021 Open Contest C Monster Game](http://s3-ap-northeast-1.amazonaws.com/data.cms.ioi-jp.org/open-2021/monster/2021-open-monster-statement-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7806", "type": "P", "difficulty": 5, "samples": [["2 1\n2 3\n6 3", "1.20"], ["4 3\n1 6\n4 6\n4 2\n4 0", "0.97"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "洛谷原创", "O2优化"], "title": "冰魄吐息", "background": "[$\\text{加强版}\\Leftarrow$](/problem/U174529)", "description": "$N$ 个点，第 $i$ 个点坐标为 $(x_i,y_i)$。\n\n定义一束激光：$y=kx$，若点 $i$ 满足到该条直线距离 $\\le d$，认为被激光击中。\n\n求使用至多 $K$ 束激光，击毁图中所有点的最小代价 $d$。", "inputFormat": "第一行输入两个正整数 $N,K$。\n\n第 $2 \\sim N+1$ 行，每行两个非负整数 $x_i,y_i$，表示第 $i$ 个点的坐标。", "outputFormat": "第一行输出最小代价 $d$，保留到小数点后 $2$ 位。", "hint": "#### 样例说明\n\n| ![](https://cdn.luogu.com.cn/upload/image_hosting/3a8bw1ub.png) | ![](https://cdn.luogu.com.cn/upload/image_hosting/3oih7er9.png) |\n| :----------- | :----------- |\n| 样例 $\\#1$ 中两蓝色点坐标分别为 $(2,3)$ 和 $(6,3)$，到直线 $y=\\frac{3}{4}x$ 的距离均为 $\\frac{6}{5}=1.2$，因此输出 `1.20`。 | 样例 $\\#2$ 中坐标为 $(4,0),(4,2)$ 的点与斜率为 $\\frac{1}{4}$ 的直线之间距离为 $\\frac{4}{17}\\sqrt{17}\\approx0.97014\\dots$，因此输出 `0.97`。 |\n\n可以证明两个样例中的方案是最优的，因此所求的 $d$ 是最小的。\n\n#### 提示\n\n1. 可能会用到的公式：点 $(x_0,y_0)$ 到直线 $y=kx$ 的距离是 $\\dfrac{|y_0-kx_0|}{\\sqrt{k^2+1}}$。\n2. 对于 C++ 选手，**建议使用** 变量类型 `long double` 进行数值计算。  \n输出时请用形如 `printf(\"%.2Lf\",ans)` 的形式输出答案，注意 `%.2Lf` 中的 L 是大写。\n3. 本题中存在的浮点数运算可能较多，虽然已经增大时限，但仍然请注意常数因子对程序效率的影响。\n\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n记 $M$ 为所有 $x_i,y_i$ 的最大值。\n\n| Subtask | Score | $M\\le$ | $K\\le$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $30$ | $10$ | $1$ |\n| $2$ | $30$ | $1.5\\times10^4$ | $1$ |\n| $3$ | $40$ | |  |\n\n对于 $100\\%$ 的数据：$1\\le N,M,K\\le2.5\\times10^4$。\n\n所有数据均保证不存在相同的 $(x_i,y_i)$ 出现多次。\n\n---\n\n### 后记\n\n冰魄战龙我吹爆 $\\sim$\n\n如果您也热爱 ddt，请在比赛结束后找到出题人，并把他虐一顿。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/65wu5o0v.png)\n\n出题人推荐阅读题解：（优点：显然）https://www.luogu.com.cn/blog/_post/362493", "locale": "zh-CN", "translations": {"zh-CN": {"title": "冰魄吐息", "background": "[$\\text{加强版}\\Leftarrow$](/problem/U174529)", "description": "$N$ 个点，第 $i$ 个点坐标为 $(x_i,y_i)$。\n\n定义一束激光：$y=kx$，若点 $i$ 满足到该条直线距离 $\\le d$，认为被激光击中。\n\n求使用至多 $K$ 束激光，击毁图中所有点的最小代价 $d$。", "inputFormat": "第一行输入两个正整数 $N,K$。\n\n第 $2 \\sim N+1$ 行，每行两个非负整数 $x_i,y_i$，表示第 $i$ 个点的坐标。", "outputFormat": "第一行输出最小代价 $d$，保留到小数点后 $2$ 位。", "hint": "#### 样例说明\n\n| ![](https://cdn.luogu.com.cn/upload/image_hosting/3a8bw1ub.png) | ![](https://cdn.luogu.com.cn/upload/image_hosting/3oih7er9.png) |\n| :----------- | :----------- |\n| 样例 $\\#1$ 中两蓝色点坐标分别为 $(2,3)$ 和 $(6,3)$，到直线 $y=\\frac{3}{4}x$ 的距离均为 $\\frac{6}{5}=1.2$，因此输出 `1.20`。 | 样例 $\\#2$ 中坐标为 $(4,0),(4,2)$ 的点与斜率为 $\\frac{1}{4}$ 的直线之间距离为 $\\frac{4}{17}\\sqrt{17}\\approx0.97014\\dots$，因此输出 `0.97`。 |\n\n可以证明两个样例中的方案是最优的，因此所求的 $d$ 是最小的。\n\n#### 提示\n\n1. 可能会用到的公式：点 $(x_0,y_0)$ 到直线 $y=kx$ 的距离是 $\\dfrac{|y_0-kx_0|}{\\sqrt{k^2+1}}$。\n2. 对于 C++ 选手，**建议使用** 变量类型 `long double` 进行数值计算。  \n输出时请用形如 `printf(\"%.2Lf\",ans)` 的形式输出答案，注意 `%.2Lf` 中的 L 是大写。\n3. 本题中存在的浮点数运算可能较多，虽然已经增大时限，但仍然请注意常数因子对程序效率的影响。\n\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n记 $M$ 为所有 $x_i,y_i$ 的最大值。\n\n| Subtask | Score | $M\\le$ | $K\\le$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $30$ | $10$ | $1$ |\n| $2$ | $30$ | $1.5\\times10^4$ | $1$ |\n| $3$ | $40$ | |  |\n\n对于 $100\\%$ 的数据：$1\\le N,M,K\\le2.5\\times10^4$。\n\n所有数据均保证不存在相同的 $(x_i,y_i)$ 出现多次。\n\n---\n\n### 后记\n\n冰魄战龙我吹爆 $\\sim$\n\n如果您也热爱 ddt，请在比赛结束后找到出题人，并把他虐一顿。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/65wu5o0v.png)\n\n出题人推荐阅读题解：（优点：显然）https://www.luogu.com.cn/blog/_post/362493", "locale": "zh-CN"}}}
{"pid": "P7807", "type": "P", "difficulty": 4, "samples": [["5 1\n1 2\n1 3\n1 4\n1 5", "1"], ["7 0\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7", "3\n1 2\n1 3"], ["9 1\n1 2\n2 3\n1 4\n1 5\n2 6\n2 7\n3 8\n3 9", "3\n1 2\n2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "洛谷原创", "Special Judge", "O2优化"], "title": "魔力滋生", "background": "Source：[八仙敬酒](/paste/78f1vlm0)，这是可以点的。\n\n- 吕洞宾——醉酒提壶力千钧；\n- 铁拐李——旋肘膝撞醉还真；\n- 汉钟离——跌步抱坛兜心顶；\n- **蓝采和——单提敬酒拦腰破**；\n- 张果老——醉酒抛杯踢连环；\n- 曹国舅——仙人敬酒锁喉扣；\n- 韩湘子——擒腕击胸醉吹箫；\n- 何仙姑——弹腰献酒醉荡步。", "description": "现有一个 $n$ 个点的树 $T$，满足任意一个结点的所连接的结点个数不超过 $2$。\n\n现在依次对结点 $u=1\\sim n$ 进行操作：\n\n- 随机一个整数 $x(\\ge k)$；\n- 新建 $x$ 个结点，每个结点与 $u$ 之间连一条边。\n\n显然操作完成后仍是一棵树 $T'$，其结点数为 $m=n+\\sum x$。\n\n已知操作后的树 $T'$ 及其结点数 $m$，请还原原树 $T$，若有多种方案，输出 **任意一组** 使得 $\\color{black}n$ **最大** 的。\n\n值得注意的是，我们进行还原和输出时，只关心树的形状，而不关心结点的相对编号。", "inputFormat": "第一行输入两个正整数 $m,k$，表示树 $T'$ 的结点数、随机数 $x$ 的下限。\n\n第 $2\\sim m$ 行，每行输入两个正整数 $u,v$，表示树 $T'$ 中的一条边。", "outputFormat": "第一行输出一个正整数 $n$，表示构造出树 $T$ 的结点数。\n\n第 $2\\sim n$ 行，每行输出两个正整数 $u,v$，表示树 $T$ 中的一条边。\n\n输出的 $u,v$ 必须满足：$1\\le u,v\\le n$。", "hint": "#### 样例说明\n\n样例 $\\#1$ 中，只有结点 $1$ 可能在树 $T$ 中：它对应的 $x$ 是 $4$。\n\n样例 $\\#2$ 中，结点 $1,2,3$ 在树 $T$ 中：结点 $1$ 对应的 $x$ 是 $4$，结点 $2,3$ 对应的 $x$ 是 $0$。\n\n样例 $\\#3$ 中，结点 $1,2,3$ 在树 $T$ 中：它们随机的 $x$ 均为 $2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4mug6pzd.png)\n\n样例 $\\#3$ 给出一张示意图，图中红色结点表示树 $T$ 中的结点，图中所有结点都在树 $T'$ 上。\n\n#### 数据范围\n\n| Subtask | Score | $x=$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $30$ | $0$ |\n| $2$ | $30$ | $1$ |\n| $3$ | $40$ |  |\n| $4$ | $0$ | Hack |\n\n说明：Subtask4 为不计分 Hack 数据，只有通过全部的 Subtask $1\\sim4$ 才算 AC。\n\n对于 $100\\%$ 的数据：$1\\le m\\le10^5,k\\in[0,m)$，数据输入保证有解。\n\n---\n\n### 后记\n\n极光魔花好可爱 $\\sim$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o0gdk38a.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "魔力滋生", "background": "Source：[八仙敬酒](/paste/78f1vlm0)，这是可以点的。\n\n- 吕洞宾——醉酒提壶力千钧；\n- 铁拐李——旋肘膝撞醉还真；\n- 汉钟离——跌步抱坛兜心顶；\n- **蓝采和——单提敬酒拦腰破**；\n- 张果老——醉酒抛杯踢连环；\n- 曹国舅——仙人敬酒锁喉扣；\n- 韩湘子——擒腕击胸醉吹箫；\n- 何仙姑——弹腰献酒醉荡步。", "description": "现有一个 $n$ 个点的树 $T$，满足任意一个结点的所连接的结点个数不超过 $2$。\n\n现在依次对结点 $u=1\\sim n$ 进行操作：\n\n- 随机一个整数 $x(\\ge k)$；\n- 新建 $x$ 个结点，每个结点与 $u$ 之间连一条边。\n\n显然操作完成后仍是一棵树 $T'$，其结点数为 $m=n+\\sum x$。\n\n已知操作后的树 $T'$ 及其结点数 $m$，请还原原树 $T$，若有多种方案，输出 **任意一组** 使得 $\\color{black}n$ **最大** 的。\n\n值得注意的是，我们进行还原和输出时，只关心树的形状，而不关心结点的相对编号。", "inputFormat": "第一行输入两个正整数 $m,k$，表示树 $T'$ 的结点数、随机数 $x$ 的下限。\n\n第 $2\\sim m$ 行，每行输入两个正整数 $u,v$，表示树 $T'$ 中的一条边。", "outputFormat": "第一行输出一个正整数 $n$，表示构造出树 $T$ 的结点数。\n\n第 $2\\sim n$ 行，每行输出两个正整数 $u,v$，表示树 $T$ 中的一条边。\n\n输出的 $u,v$ 必须满足：$1\\le u,v\\le n$。", "hint": "#### 样例说明\n\n样例 $\\#1$ 中，只有结点 $1$ 可能在树 $T$ 中：它对应的 $x$ 是 $4$。\n\n样例 $\\#2$ 中，结点 $1,2,3$ 在树 $T$ 中：结点 $1$ 对应的 $x$ 是 $4$，结点 $2,3$ 对应的 $x$ 是 $0$。\n\n样例 $\\#3$ 中，结点 $1,2,3$ 在树 $T$ 中：它们随机的 $x$ 均为 $2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4mug6pzd.png)\n\n样例 $\\#3$ 给出一张示意图，图中红色结点表示树 $T$ 中的结点，图中所有结点都在树 $T'$ 上。\n\n#### 数据范围\n\n| Subtask | Score | $x=$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $30$ | $0$ |\n| $2$ | $30$ | $1$ |\n| $3$ | $40$ |  |\n| $4$ | $0$ | Hack |\n\n说明：Subtask4 为不计分 Hack 数据，只有通过全部的 Subtask $1\\sim4$ 才算 AC。\n\n对于 $100\\%$ 的数据：$1\\le m\\le10^5,k\\in[0,m)$，数据输入保证有解。\n\n---\n\n### 后记\n\n极光魔花好可爱 $\\sim$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o0gdk38a.png)", "locale": "zh-CN"}}}
{"pid": "P7809", "type": "P", "difficulty": 4, "samples": [["8 4\n0 1 1 0 1 0 0 1\n1 1 8\n2 1 8\n1 3 6\n2 5 6", "5\n2\n2\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "洛谷原创", "O2优化", "ST 表"], "title": "[JRKSJ R2] 01 序列", "background": "", "description": "给你一个长度为 $n$ 的 $01$ 序列 $a_{1\\sim n}$，接下来有两种询问共 $m$ 次：\n\n- `1 l r`，表示询问 $l$ 到 $r$ 区间的最长不下降子序列的长度。\n- `2 l r`，表示询问 $l$ 到 $r$ 区间的最长上升子序列的长度。", "inputFormat": "输入 $m+2$ 行。\\\n第 $1$ 行两个正整数 $n,m$。\\\n第 $2$ 行 $n$ 个数字 $0$ 或 $1$ 代表序列 $a_{1\\sim n}$。\\\n接下来 $m$ 行每行三个正整数表示一次询问，格式如上。", "outputFormat": "输出 $m$ 行。\\\n对于每一次询问求出答案并输出。", "hint": "本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n\\le$ | $m\\le$ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{1}$ | $10^6$ | $10^6$ | 所有 $a_i$ 均相等 | $5$ |\n| $\\text{2}$ | $10^3$ | $10^3$ | 无 | $10$ |\n| $\\text{3}$ | $10^4$ | $10^4$ | 无 | $15$ |\n| $\\text{4}$ | $10^5$ | $10^5$ | 无 | $30$ |\n| $\\text{5}$ | $10^6$ | $5\\times10^6$ | 无 | $40$ |\n| $\\text{6}$ | $10^6$ | $5\\times10^6$ | hack 数据 | $0$ |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le m\\le 5\\times10^6$，$0\\le a_i\\le 1$。\n\n本题输入输出量极大，请使用较为快速的输入输出方法。\n\n#### 样例解释:\n对于第一个询问，满足的序列有：$\\{0,1,1,1,1\\},\\{0,0,0,0,1\\}$。\\\n对于第二个询问，满足的序列有：$\\{0,1\\}$。\\\n对于第三个询问，满足的序列有：$\\{0,0\\},\\{0,1\\},\\{1,1\\}$。\\\n对于第四个询问，满足的序列有：$\\{0\\},\\{1\\}$。\n\n$\\text{Upd 2021.8.16}$：增加两组 Hack 数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R2] 01 序列", "background": "", "description": "给你一个长度为 $n$ 的 $01$ 序列 $a_{1\\sim n}$，接下来有两种询问共 $m$ 次：\n\n- `1 l r`，表示询问 $l$ 到 $r$ 区间的最长不下降子序列的长度。\n- `2 l r`，表示询问 $l$ 到 $r$ 区间的最长上升子序列的长度。", "inputFormat": "输入 $m+2$ 行。\\\n第 $1$ 行两个正整数 $n,m$。\\\n第 $2$ 行 $n$ 个数字 $0$ 或 $1$ 代表序列 $a_{1\\sim n}$。\\\n接下来 $m$ 行每行三个正整数表示一次询问，格式如上。", "outputFormat": "输出 $m$ 行。\\\n对于每一次询问求出答案并输出。", "hint": "本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n\\le$ | $m\\le$ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{1}$ | $10^6$ | $10^6$ | 所有 $a_i$ 均相等 | $5$ |\n| $\\text{2}$ | $10^3$ | $10^3$ | 无 | $10$ |\n| $\\text{3}$ | $10^4$ | $10^4$ | 无 | $15$ |\n| $\\text{4}$ | $10^5$ | $10^5$ | 无 | $30$ |\n| $\\text{5}$ | $10^6$ | $5\\times10^6$ | 无 | $40$ |\n| $\\text{6}$ | $10^6$ | $5\\times10^6$ | hack 数据 | $0$ |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le m\\le 5\\times10^6$，$0\\le a_i\\le 1$。\n\n本题输入输出量极大，请使用较为快速的输入输出方法。\n\n#### 样例解释:\n对于第一个询问，满足的序列有：$\\{0,1,1,1,1\\},\\{0,0,0,0,1\\}$。\\\n对于第二个询问，满足的序列有：$\\{0,1\\}$。\\\n对于第三个询问，满足的序列有：$\\{0,0\\},\\{0,1\\},\\{1,1\\}$。\\\n对于第四个询问，满足的序列有：$\\{0\\},\\{1\\}$。\n\n$\\text{Upd 2021.8.16}$：增加两组 Hack 数据。", "locale": "zh-CN"}}}
{"pid": "P7810", "type": "P", "difficulty": 5, "samples": [["5\n2 1 8 3 9", "2"], ["5\n5 4 3 2 1", "-1"], ["20\n20 9 36 36 40 8 3 10 9 20 18 12 30 20 30 15 8 9 27 45", "7"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "线段树", "2021", "洛谷原创", "O2优化", "素数判断,质数,筛法"], "title": "[JRKSJ R2] Upper", "background": "", "description": "有 $n$ 张扑克，第 $i$ 张扑克上写有一个正整数 $a_i$。\n\n现在要把扑克划分成若干个合法的连续子段，其中，一个连续子段 $[l,r]$ “合法”当且仅当这个子段同时满足两个条件： \n\n* $a_l< a_r$\n* $\\gcd(a_l,a_r)>1$ \n\n请问最多能划分多少段。如果没有合法的划分方案，输出 $-1$ 即可。\n\n如果您不知道 $\\gcd$ 是什么意思，请看“提示”部分。", "inputFormat": "第一行一个整数 $n$。\\\n第二行 $n$ 个整数表示序列 $a$。", "outputFormat": "一个整数，如题目描述所示。", "hint": "### 数据范围\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$1\\le a_i\\le 10^9$。\n\n| $\\text{Subtask}$ | $n\\le$ | $a_i\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $5$ | $10^9$ | 无 | $5$ |\n| $2$ | $3\\times10^3$ | $10^9$ | 无 | $15$ |\n| $3$ | $2\\times10^4$ | $10^6$ | 无 | $20$ |\n| $4$ | $2\\times 10^4$ | $10^9$ | 无 | $10$ |\n| $5$ | $10^5$ | $10^9$ | 数据随机 | $10$ |\n| $6$ | $10^5$ | $10^9$ | 无 | $40$ |\n\n### 样例解释\n对于样例 $1$，有且仅有一种划分方案 $\\{2,1,8\\},\\{3,9\\}$。\\\n对于样例 $2$，无合法的划分方案。\n\n### 提示\n对于两个正整数 $a,b$，$\\gcd(a,b)$ 为它们的最大公因数，即满足既是 $a$ 的因数又是 $b$ 的因数的数中最大的数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R2] Upper", "background": "", "description": "有 $n$ 张扑克，第 $i$ 张扑克上写有一个正整数 $a_i$。\n\n现在要把扑克划分成若干个合法的连续子段，其中，一个连续子段 $[l,r]$ “合法”当且仅当这个子段同时满足两个条件： \n\n* $a_l< a_r$\n* $\\gcd(a_l,a_r)>1$ \n\n请问最多能划分多少段。如果没有合法的划分方案，输出 $-1$ 即可。\n\n如果您不知道 $\\gcd$ 是什么意思，请看“提示”部分。", "inputFormat": "第一行一个整数 $n$。\\\n第二行 $n$ 个整数表示序列 $a$。", "outputFormat": "一个整数，如题目描述所示。", "hint": "### 数据范围\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$1\\le a_i\\le 10^9$。\n\n| $\\text{Subtask}$ | $n\\le$ | $a_i\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $5$ | $10^9$ | 无 | $5$ |\n| $2$ | $3\\times10^3$ | $10^9$ | 无 | $15$ |\n| $3$ | $2\\times10^4$ | $10^6$ | 无 | $20$ |\n| $4$ | $2\\times 10^4$ | $10^9$ | 无 | $10$ |\n| $5$ | $10^5$ | $10^9$ | 数据随机 | $10$ |\n| $6$ | $10^5$ | $10^9$ | 无 | $40$ |\n\n### 样例解释\n对于样例 $1$，有且仅有一种划分方案 $\\{2,1,8\\},\\{3,9\\}$。\\\n对于样例 $2$，无合法的划分方案。\n\n### 提示\n对于两个正整数 $a,b$，$\\gcd(a,b)$ 为它们的最大公因数，即满足既是 $a$ 的因数又是 $b$ 的因数的数中最大的数。", "locale": "zh-CN"}}}
{"pid": "P7811", "type": "P", "difficulty": 6, "samples": [["10 10\n15 14 14 4 8 10 18 14 10 9 \n2 10 8\n2 4 7\n3 9 6\n1 7 5\n3 4 6\n6 6 12\n4 8 20\n1 6 18\n7 8 8\n2 6 6", "0\n0\n0\n0\n2\n10\n4\n4\n2\n2"], ["5 5\n77 24 80 90 92 \n2 3 84\n4 5 37\n1 1 4\n3 5 85\n1 4 46", "24\n16\n1\n5\n24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 131072, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 262144, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 262144]}, "tags": ["2021", "洛谷原创", "O2优化", "分治", "分块", "ST 表"], "title": "[JRKSJ R2] 你的名字。", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/73iq08qk.png)", "description": "给你一个长为 $n$ 的序列 $a$，有 $m$ 次查询，每次查询区间 $[l,r]$ 模 $k$ 意义下的最小值。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示 $a$。\n\n下面 $m$ 行，每行三个整数 $l,r,k$ 表示一次询问。", "outputFormat": "对于每个查询操作，每行输出一个答案。", "hint": "Idea：mcyl35，Solution：mcyl35，Code：mcyl35，Data：cyffff&mcyl35\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n,m\\le$ | $k,a_i\\le$ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{1}$ | $10^4$ | $10^5$ | 无 | $3$ | $1$ |\n| $\\text{2}$ | $10^5$ | $300$ | 无 | $6$ | $1$ |\n| $\\text{3}$ | $10^5$ | $10^5$ | $k\\ge 10^3$ | $10$ | $1\\to2$ |\n| $\\text{4}$ | $10^5$ | $10^5$ | 无 | $19$ |$2\\to4$ |\n| $\\text{5}$ | $3\\times10^5$ | $10^5$ | 数据随机 | $14$ |$1$ |\n| $\\text{6}$ | $3\\times10^5$ | $10^5$ | $k\\ge 10^3$ | $2$ |$2\\to3$ |\n| $\\text{7}$ | $3\\times10^5$ | $10^5$ | 无 | $46$ |$2\\to5$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le3\\times10^5$，$1\\le a_i,k\\le 10^5$。\n\n前 $6$ 个 $\\text{Subtask}$ 的空间限制为 $256\\text{MB}$，第 $7$ 个 $\\text{Subtask}$ 的空间限制为 $128\\text{MB}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R2] 你的名字。", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/73iq08qk.png)", "description": "给你一个长为 $n$ 的序列 $a$，有 $m$ 次查询，每次查询区间 $[l,r]$ 模 $k$ 意义下的最小值。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示 $a$。\n\n下面 $m$ 行，每行三个整数 $l,r,k$ 表示一次询问。", "outputFormat": "对于每个查询操作，每行输出一个答案。", "hint": "Idea：mcyl35，Solution：mcyl35，Code：mcyl35，Data：cyffff&mcyl35\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n,m\\le$ | $k,a_i\\le$ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{1}$ | $10^4$ | $10^5$ | 无 | $3$ | $1$ |\n| $\\text{2}$ | $10^5$ | $300$ | 无 | $6$ | $1$ |\n| $\\text{3}$ | $10^5$ | $10^5$ | $k\\ge 10^3$ | $10$ | $1\\to2$ |\n| $\\text{4}$ | $10^5$ | $10^5$ | 无 | $19$ |$2\\to4$ |\n| $\\text{5}$ | $3\\times10^5$ | $10^5$ | 数据随机 | $14$ |$1$ |\n| $\\text{6}$ | $3\\times10^5$ | $10^5$ | $k\\ge 10^3$ | $2$ |$2\\to3$ |\n| $\\text{7}$ | $3\\times10^5$ | $10^5$ | 无 | $46$ |$2\\to5$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le3\\times10^5$，$1\\le a_i,k\\le 10^5$。\n\n前 $6$ 个 $\\text{Subtask}$ 的空间限制为 $256\\text{MB}$，第 $7$ 个 $\\text{Subtask}$ 的空间限制为 $128\\text{MB}$。", "locale": "zh-CN"}}}
{"pid": "P7812", "type": "P", "difficulty": 6, "samples": [["5\n1 4 3 2 5", "1 3 5 2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "洛谷原创", "提交答案", "Special Judge", "模拟退火", "遗传算法", "随机化"], "title": "[JRKSJ R2] Dark Forest", "background": "**本题为提交答案题。**", "description": "给你一个长为 $n$ 的序列 $a$，定义 $1\\dots n$ 的排列 $p$ 的权值为\n\n$$\\sum_{i=1}^n p_i a_{p_{i-1}} a_{p_i}a_{p_{i+1}}$$\n\n你可以理解为这个排列是一个环，即 $p_{0}=p_n,p_{n+1}=p_1$。\n\n请构造一个权值**尽量大**的 $1\\dots n$ 的排列。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示序列 $a$。", "outputFormat": "一行 $n$ 个整数表示排列。", "hint": "注意是 `a[p[i-1]] a[p[i+1]]`，数据有一定梯度。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1\\le n,a_i\\le 10^3$。\n\n### 样例解释\n\n该排列的权值为 $1\\times2\\times1\\times3+3\\times1\\times3\\times5+5\\times3\\times5\\times4+2\\times5\\times4\\times2+4\\times4\\times2\\times1=463$，可以证明这是最优的排列之一。\n\n### 评分方式\n\n**本题使用 Special Judge**，每个测试点都有 $10$ 个参数 $v_1,v_2,\\dots v_{10}$。如果你的输出的权值 $V\\ge v_i$，则该测试点您至少会获得 $i$ 分。\n\n特别的，如果您的输出不是一个 $1\\dots n$ 的排列，您会在该测试点获得 $0$ 分。\n\n评分参数已经放至附件。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R2] Dark Forest", "background": "**本题为提交答案题。**", "description": "给你一个长为 $n$ 的序列 $a$，定义 $1\\dots n$ 的排列 $p$ 的权值为\n\n$$\\sum_{i=1}^n p_i a_{p_{i-1}} a_{p_i}a_{p_{i+1}}$$\n\n你可以理解为这个排列是一个环，即 $p_{0}=p_n,p_{n+1}=p_1$。\n\n请构造一个权值**尽量大**的 $1\\dots n$ 的排列。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示序列 $a$。", "outputFormat": "一行 $n$ 个整数表示排列。", "hint": "注意是 `a[p[i-1]] a[p[i+1]]`，数据有一定梯度。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1\\le n,a_i\\le 10^3$。\n\n### 样例解释\n\n该排列的权值为 $1\\times2\\times1\\times3+3\\times1\\times3\\times5+5\\times3\\times5\\times4+2\\times5\\times4\\times2+4\\times4\\times2\\times1=463$，可以证明这是最优的排列之一。\n\n### 评分方式\n\n**本题使用 Special Judge**，每个测试点都有 $10$ 个参数 $v_1,v_2,\\dots v_{10}$。如果你的输出的权值 $V\\ge v_i$，则该测试点您至少会获得 $i$ 分。\n\n特别的，如果您的输出不是一个 $1\\dots n$ 的排列，您会在该测试点获得 $0$ 分。\n\n评分参数已经放至附件。", "locale": "zh-CN"}}}
{"pid": "P7813", "type": "P", "difficulty": 3, "samples": [["1\n5 5", "61"], ["5\n2676 1930\n5148 3667\n5453 4764\n16734806 16332913\n26943973 33293903 ", "909411538\n587883333\n823595806\n727601062\n965648555"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "O2优化", "洛谷月赛"], "title": "谜", "background": "$\\text{我需要你给我方向}$\n\n$\\text{哪怕要我独自穿过人海茫茫}$\n\n$\\text{为了你尝风霜}$\n\n$\\text{我流浪远方}$\n\n$\\text{需要你给我力量}$\n\n$\\text{无论如何我会坚强}$\n\n$\\text{只要你给我希望}$\n\n[Source](https://www.kugou.com/song-36/1y5t3b.html)", "description": "在一个大小为 $N$ 的数字三角形中：\n\n- 第 $1$ 行为 $1$；\n- 第 $2$ 行为 $2\\sim3$；\n- 第 $3$ 行为 $4\\sim6$；\n- 第 $4$ 行为 $7\\sim10$；\n- $\\cdots~\\cdots$\n- 第 $N$ 行包含 $N$ 个数字，为 $\\frac{N(N-1)}{2}+1\\sim\\frac{N(N+1)}{2}$。\n\n下图展示了一个 $N=5$ 的数字三角形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fpx5rw7l.png)\n\n---\n\n记 $(i,j)$ 表示第 $i$ 行第 $j$ 个数字。\n\n已知 $(i,j)$ 能直接到达 $(i+1,j)$ 或 $(i+1,j+1)$，反之，$(i+1,j)$ 或 $(i+1,j+1)$ 也能直接到达 $(i,j)$。\n\n现在任选一个数字作为起点，求 **连续** 地经过 $K$ 个 **不同** 的数字时，这 $K$ 个数的和的最大值，对 $10^9+7$ 取模。", "inputFormat": "**本题包含多组数据测试。**\n\n第一行，输入一个正整数 $T$，表示询问组数。\n\n接下来 $T$ 行，每行输入两个正整数 $N,K$。", "outputFormat": "共 $T$ 行，每行输出一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "#### 样例说明\n\n对于样例 #1，如题面中的图所示，一种可行的方案是：以 $13$ 为起点，$13\\rightarrow9\\rightarrow14\\rightarrow10\\rightarrow15$，和为 $13+9+14+10+15=61$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| Subtask | 分值 | $N\\le$ | $K\\le$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $30$ | $10^3$  |  |\n| $2$ | $30$ | $10^6$ |  |\n| $3$ | $30$ | $10^9$ | $1$ |\n| $4$ | $10$ | $10^9$ |  |\n\n对于 $100\\%$ 的数据：$1\\le T\\le 10^5$，$1\\le\\color{red}\\dfrac{K+1}{2}\\le N\\color{black}\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "谜", "background": "$\\text{我需要你给我方向}$\n\n$\\text{哪怕要我独自穿过人海茫茫}$\n\n$\\text{为了你尝风霜}$\n\n$\\text{我流浪远方}$\n\n$\\text{需要你给我力量}$\n\n$\\text{无论如何我会坚强}$\n\n$\\text{只要你给我希望}$\n\n[Source](https://www.kugou.com/song-36/1y5t3b.html)", "description": "在一个大小为 $N$ 的数字三角形中：\n\n- 第 $1$ 行为 $1$；\n- 第 $2$ 行为 $2\\sim3$；\n- 第 $3$ 行为 $4\\sim6$；\n- 第 $4$ 行为 $7\\sim10$；\n- $\\cdots~\\cdots$\n- 第 $N$ 行包含 $N$ 个数字，为 $\\frac{N(N-1)}{2}+1\\sim\\frac{N(N+1)}{2}$。\n\n下图展示了一个 $N=5$ 的数字三角形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fpx5rw7l.png)\n\n---\n\n记 $(i,j)$ 表示第 $i$ 行第 $j$ 个数字。\n\n已知 $(i,j)$ 能直接到达 $(i+1,j)$ 或 $(i+1,j+1)$，反之，$(i+1,j)$ 或 $(i+1,j+1)$ 也能直接到达 $(i,j)$。\n\n现在任选一个数字作为起点，求 **连续** 地经过 $K$ 个 **不同** 的数字时，这 $K$ 个数的和的最大值，对 $10^9+7$ 取模。", "inputFormat": "**本题包含多组数据测试。**\n\n第一行，输入一个正整数 $T$，表示询问组数。\n\n接下来 $T$ 行，每行输入两个正整数 $N,K$。", "outputFormat": "共 $T$ 行，每行输出一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "#### 样例说明\n\n对于样例 #1，如题面中的图所示，一种可行的方案是：以 $13$ 为起点，$13\\rightarrow9\\rightarrow14\\rightarrow10\\rightarrow15$，和为 $13+9+14+10+15=61$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| Subtask | 分值 | $N\\le$ | $K\\le$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $30$ | $10^3$  |  |\n| $2$ | $30$ | $10^6$ |  |\n| $3$ | $30$ | $10^9$ | $1$ |\n| $4$ | $10$ | $10^9$ |  |\n\n对于 $100\\%$ 的数据：$1\\le T\\le 10^5$，$1\\le\\color{red}\\dfrac{K+1}{2}\\le N\\color{black}\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P7814", "type": "P", "difficulty": 3, "samples": [["4\n1 1\n1\n3 5\n010\n4 8\n1101\n5 6\n11111", "-1\n01110\n10100101\n111101"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "贪心", "Special Judge", "O2优化"], "title": "「小窝 R3」心の記憶", "background": "> 淡い夕暮れ飲み込まれて  \n「君」の消えかけて姿を  \n忘れさせるように走ってた   \n新しい平和の世界に  \n——[《心の記憶》](https://music.163.com/song?id=1847928316)", "description": "- 本题中「**子串**」的定义如下：\n\n字符串 $S$ 的子串是 $S$ 中**连续**的任意个字符组成的字符串。$S$ 的子串可用起始位置 $l$ 与终止位置 $r$ 来表示，记为 $S(l,r)$（$1 \\leq l \\leq r \\leq |S |,|S|$ 表示 $S$ 的长度）。\n\n- 本题中「**子序列**」的定义如下：\n\n对于字符串 $S$ 和一个长度为 $n$ 的严格单调递增数列 $k_1,k_2,\\cdots,k_n(\\forall 1\\le i\\le n,1\\le k_i\\le |S|)$，$S_{k_1},S_{k_2},\\cdots,S_{k_n}$ 所组成的字符串即为 $S$ 的子序列。\n\n---------------\n\n现有 $T$ 次询问。\n每次询问给定一个长度为 $n$ 的 01 串，记为 $A$。回答应是一个字符串 $B$，满足：\n\n- $B$ 是长度为 $m$ 的 01 串。\n- $B$ 中不存在任意一个**子串**与 $A$ 相同。\n- $B$ 中存在**至少**一个**子序列**与 $A$ 相同。\n\n输出任意一个满足要求的字符串 $B$ 即可。", "inputFormat": "第一行，一个正整数：$T$，表示询问次数。\n\n对于每一次询问，第一行两个正整数： $n,m(n\\le m)$，分别表示 01 串 $A,B$ 的长度。\n\n第二行，一个长度为 $n$ 的 01 串 $A$。", "outputFormat": "共 $T$ 行，每行一个长度为 $m$ 的 01 串 $B$。无解则输出 `-1`。", "hint": "### 样例解释\n\n在第二次询问中，`01101` 和 `10110` 是另外合法的方案。\n\n### 数据范围\n\n| Subtask | 分值 | $\\sum m\\le$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$  | $10$ | $2\\times10^6$ | $A$ 只由 `0` 组成 |\n| $2$ | $10$ | $15$ | 无 |\n| $3$ | $20$ | $2000$ | 无 |\n| $4$  | $30$ | $10^6$ | $A$ 随机生成 |\n| $5$ | $30$ | $2\\times 10^6$ | 无 |\n\n对于 $100\\%$ 的数据，$1\\le n\\le m$，$1\\le \\sum m\\le 2\\times 10^6$。保证 $A$ 只由 `0` 和 `1` 组成。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「小窝 R3」心の記憶", "background": "> 淡い夕暮れ飲み込まれて  \n「君」の消えかけて姿を  \n忘れさせるように走ってた   \n新しい平和の世界に  \n——[《心の記憶》](https://music.163.com/song?id=1847928316)", "description": "- 本题中「**子串**」的定义如下：\n\n字符串 $S$ 的子串是 $S$ 中**连续**的任意个字符组成的字符串。$S$ 的子串可用起始位置 $l$ 与终止位置 $r$ 来表示，记为 $S(l,r)$（$1 \\leq l \\leq r \\leq |S |,|S|$ 表示 $S$ 的长度）。\n\n- 本题中「**子序列**」的定义如下：\n\n对于字符串 $S$ 和一个长度为 $n$ 的严格单调递增数列 $k_1,k_2,\\cdots,k_n(\\forall 1\\le i\\le n,1\\le k_i\\le |S|)$，$S_{k_1},S_{k_2},\\cdots,S_{k_n}$ 所组成的字符串即为 $S$ 的子序列。\n\n---------------\n\n现有 $T$ 次询问。\n每次询问给定一个长度为 $n$ 的 01 串，记为 $A$。回答应是一个字符串 $B$，满足：\n\n- $B$ 是长度为 $m$ 的 01 串。\n- $B$ 中不存在任意一个**子串**与 $A$ 相同。\n- $B$ 中存在**至少**一个**子序列**与 $A$ 相同。\n\n输出任意一个满足要求的字符串 $B$ 即可。", "inputFormat": "第一行，一个正整数：$T$，表示询问次数。\n\n对于每一次询问，第一行两个正整数： $n,m(n\\le m)$，分别表示 01 串 $A,B$ 的长度。\n\n第二行，一个长度为 $n$ 的 01 串 $A$。", "outputFormat": "共 $T$ 行，每行一个长度为 $m$ 的 01 串 $B$。无解则输出 `-1`。", "hint": "### 样例解释\n\n在第二次询问中，`01101` 和 `10110` 是另外合法的方案。\n\n### 数据范围\n\n| Subtask | 分值 | $\\sum m\\le$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$  | $10$ | $2\\times10^6$ | $A$ 只由 `0` 组成 |\n| $2$ | $10$ | $15$ | 无 |\n| $3$ | $20$ | $2000$ | 无 |\n| $4$  | $30$ | $10^6$ | $A$ 随机生成 |\n| $5$ | $30$ | $2\\times 10^6$ | 无 |\n\n对于 $100\\%$ 的数据，$1\\le n\\le m$，$1\\le \\sum m\\le 2\\times 10^6$。保证 $A$ 只由 `0` 和 `1` 组成。", "locale": "zh-CN"}}}
{"pid": "P7815", "type": "P", "difficulty": 6, "samples": [["5\n1 2 2\n1 3 3\n2 4 1\n2 5 2", "214285725"], ["9\n1 2 9\n1 3 3\n2 4 5\n2 5 7\n2 6 2\n1 7 1\n3 8 6\n3 9 4", "662721928"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "O2优化", "树论"], "title": "「小窝 R3」自傷無色", "background": "> こんな僕が生きてるだけで    \n何万人のひとが悲しんで  \n誰も僕を望まない  \nそんな世界だったらいいのにな  \n——[《自傷無色》](https://music.163.com/song?id=29124091)", "description": "给定一棵 $n$ 个节点的树，根节点为 $1$，有边权。约定树上 $u,v$ 两点间路径长度 $d(u,v)$ 为 $u,v$ 间路径上的边权和。\n\n对于一个无序二元组 $(u,v)$，定义一个「树三角」当且仅当同时满足：\n\n- $u,v$ 的最近公共祖先 $w\\neq u$ 且 $w\\neq v$。\n- 以 $d(u,w),d(v,w)$ 和某个正整数 $x$ 为边长，能构成一个三角形。$x$ 是任意选取的，因此一对 $(u,v)$ 可能会产生多个树三角。\n\n此时 $d(u,w)+d(v,w)+x$ 即为这个树三角的大小。具体例子参考样例解释。\n\n定义两个树三角不同，只需满足下列条件中的**一条**：\n\n- 无序二元组 $(u,v)$ 不同。\n- 树三角的大小不同。\n\n对于一个带边权的树 $T$，定义其正弦值 $\\sin T$ 为 $T$ 中所有树三角大小的和与 $T$ 中不同树三角总数量的比值。\n\n小 H 给出了 $T$，希望你能求出 $\\sin T$。为了避免误差，结果对 $10^9+7$ 取模。特别地，若 $T$ 中不存在树三角，则 $\\sin T=0$。", "inputFormat": "第一行，一个正整数 $n$：表示树的节点数。\n\n接下来 $n-1$ 行，每行三个正整数 $u,v,w$：表示节点 $u,v$ 之间有一条权值为 $w$ 的边。", "outputFormat": "共一行，为 $\\sin T$ 的值对 $10^9+7$ 取模。数据保证 $T$ 中不同树三角总数量不是 $10^9+7$ 的倍数。", "hint": "### 样例解释\n\n对于样例 1，$T$ 如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/35edha17.png)\n\n节点 $1,2,3$ 构成的三角环有：$\\underline{2,3},2;~\\underline{2,3},3;~\\underline{2,3},4$。\n\n节点 $1,3,4$ 构成的三角环有：$\\underline{3,3},1;~\\underline{3,3},2;~\\underline{3,3},3;~\\underline{3,3},4;~\\underline{3,3},5$。\n\n节点 $1,3,5$ 构成的三角环有：$\\underline{3,4},2;~\\underline{3,4},3;~\\underline{3,4},4;~\\underline{3,4},5;~\\underline{3,4},6$。\n\n节点 $2,4,5$ 构成的三角环有：$\\underline{1,2},2$。\n\n所有三角环大小之和：$(7+8+9)+(7+8+\\dots+11)+(9+10+\\dots+13)+5=129$。\n\n所有三角环的总个数：$3+5+5+1=14$。\n\n$\\sin T=\\dfrac{129}{14}$，对 $10^9+7$ 取模后的结果为 $214285725$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n- 特殊性质 A：保证 $T$ 中存在度为 $n-1$ 的节点。\n- 特殊性质 B：保证 $T$ 中除了叶子节点，每个节点的度均为 $2$。\n- 特殊性质 C：保证 $T$ 为满二叉树。\n\n| Subtask | 分值 | $1\\le n\\le $ |  特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $5$  | $3$ | 无 |\n| $2$ | $13$ | $10^3$ |  无 |\n| $3$ | $11$ | $7\\times10^3$ | 无 |\n| $4$ | $17$ | $10^5$ | A |\n| $5$ | $17$ | $10^5$ | B |\n| $6$ | $17$ | $10^5$ | C |\n| $7$ | $20$ | $10^5$ |  无 |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le w\\le 10^9$。\n\n### 提示\n\n在题目附件 `depression_sample.zip` 中：\n\n- `depression_sample1.in` 即为样例 #1。\n- `depression_sample2.in` 满足特殊性质 A。\n- `depression_sample3.in` 满足特殊性质 B。\n- `depression_sample4.in` 满足特殊性质 C。\n- `depression_sample5.in` 不满足特殊性质。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「小窝 R3」自傷無色", "background": "> こんな僕が生きてるだけで    \n何万人のひとが悲しんで  \n誰も僕を望まない  \nそんな世界だったらいいのにな  \n——[《自傷無色》](https://music.163.com/song?id=29124091)", "description": "给定一棵 $n$ 个节点的树，根节点为 $1$，有边权。约定树上 $u,v$ 两点间路径长度 $d(u,v)$ 为 $u,v$ 间路径上的边权和。\n\n对于一个无序二元组 $(u,v)$，定义一个「树三角」当且仅当同时满足：\n\n- $u,v$ 的最近公共祖先 $w\\neq u$ 且 $w\\neq v$。\n- 以 $d(u,w),d(v,w)$ 和某个正整数 $x$ 为边长，能构成一个三角形。$x$ 是任意选取的，因此一对 $(u,v)$ 可能会产生多个树三角。\n\n此时 $d(u,w)+d(v,w)+x$ 即为这个树三角的大小。具体例子参考样例解释。\n\n定义两个树三角不同，只需满足下列条件中的**一条**：\n\n- 无序二元组 $(u,v)$ 不同。\n- 树三角的大小不同。\n\n对于一个带边权的树 $T$，定义其正弦值 $\\sin T$ 为 $T$ 中所有树三角大小的和与 $T$ 中不同树三角总数量的比值。\n\n小 H 给出了 $T$，希望你能求出 $\\sin T$。为了避免误差，结果对 $10^9+7$ 取模。特别地，若 $T$ 中不存在树三角，则 $\\sin T=0$。", "inputFormat": "第一行，一个正整数 $n$：表示树的节点数。\n\n接下来 $n-1$ 行，每行三个正整数 $u,v,w$：表示节点 $u,v$ 之间有一条权值为 $w$ 的边。", "outputFormat": "共一行，为 $\\sin T$ 的值对 $10^9+7$ 取模。数据保证 $T$ 中不同树三角总数量不是 $10^9+7$ 的倍数。", "hint": "### 样例解释\n\n对于样例 1，$T$ 如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/35edha17.png)\n\n节点 $1,2,3$ 构成的三角环有：$\\underline{2,3},2;~\\underline{2,3},3;~\\underline{2,3},4$。\n\n节点 $1,3,4$ 构成的三角环有：$\\underline{3,3},1;~\\underline{3,3},2;~\\underline{3,3},3;~\\underline{3,3},4;~\\underline{3,3},5$。\n\n节点 $1,3,5$ 构成的三角环有：$\\underline{3,4},2;~\\underline{3,4},3;~\\underline{3,4},4;~\\underline{3,4},5;~\\underline{3,4},6$。\n\n节点 $2,4,5$ 构成的三角环有：$\\underline{1,2},2$。\n\n所有三角环大小之和：$(7+8+9)+(7+8+\\dots+11)+(9+10+\\dots+13)+5=129$。\n\n所有三角环的总个数：$3+5+5+1=14$。\n\n$\\sin T=\\dfrac{129}{14}$，对 $10^9+7$ 取模后的结果为 $214285725$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n- 特殊性质 A：保证 $T$ 中存在度为 $n-1$ 的节点。\n- 特殊性质 B：保证 $T$ 中除了叶子节点，每个节点的度均为 $2$。\n- 特殊性质 C：保证 $T$ 为满二叉树。\n\n| Subtask | 分值 | $1\\le n\\le $ |  特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $5$  | $3$ | 无 |\n| $2$ | $13$ | $10^3$ |  无 |\n| $3$ | $11$ | $7\\times10^3$ | 无 |\n| $4$ | $17$ | $10^5$ | A |\n| $5$ | $17$ | $10^5$ | B |\n| $6$ | $17$ | $10^5$ | C |\n| $7$ | $20$ | $10^5$ |  无 |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le w\\le 10^9$。\n\n### 提示\n\n在题目附件 `depression_sample.zip` 中：\n\n- `depression_sample1.in` 即为样例 #1。\n- `depression_sample2.in` 满足特殊性质 A。\n- `depression_sample3.in` 满足特殊性质 B。\n- `depression_sample4.in` 满足特殊性质 C。\n- `depression_sample5.in` 不满足特殊性质。", "locale": "zh-CN"}}}
{"pid": "P7816", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2 1\n1 3 2\n2 3 1\n2 4 1\n4 1 2\n", "00100\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["搜索", "图论", "Special Judge", "O2优化", "深度优先搜索 DFS", "图遍历", "欧拉回路", "构造", "2029"], "title": "「Stoi2029」以父之名", "background": "> 以父之名判决  \n> 那感觉没有适合字汇  \n> 就像边笑边掉泪  \n> 凝视着完全的黑  \n> 阻挡悲剧蔓延的悲剧会让我沉醉  \n> ——《[以父之名](https://www.bilibili.com/video/BV1fx411N7bU?p=36)》", "description": "地狱里有 $n$ 个罪人在等待判决，编号为 $1$ 至 $n$。罪人们之间有 $m$ 条罪的联系，编号为 $1$ 至 $m$，每条联系 的值为 $1$ 或 $2$ 且恰好连接两个罪人。\n\n称一个罪人的自负度为他和其他所有罪人之间联系的值之和。两个罪人之间可能不止有一条联系，此时这些联系的值都应该被计算。由于这些罪人承受了太多的罪恶，他们变得不和谐。具体地，每个罪人的自负度都是奇数。\n\n现在，神明将要对他们进行判决。判决的具体方式为：将每条联系都进行定向，使得这条联系所连接的两个罪人中的一个受到惩罚，另一个受到救赎，它们的值均为这条联系的值。\n\n由于神明秉承父的仁慈，希望罪人们更加均等地接受惩罚和救赎，于是他规定判决后每个罪人所受到的惩罚和救赎值总和之差的绝对值必须恰好为 $1$。\n\n由于神明工作繁忙，因此他以父之名要求你为他找到一种判决的方法。由于父的指示不会有错，所以一定存在一种这样的方法。\n\n---\n\n#### 题意简述\n\n给定一个 $n$ 个点 $m$ 条边的无向图，边权均为 $1$ 或 $2$。保证每个点所相连的边权值之和均为奇数。你需要将这些边定向，使每个点的入边权值和与出边权值和之差的绝对值恰为 $1$。保证有解。输出任意一种方案。", "inputFormat": "第一行两个正整数：$n,m$，表示有 $n$ 个罪人和 $m$ 条罪的联系。\n\n接下来 $m$ 行，第 $i+1$ 行为三个正整数：$u_i,v_i,w_i$，表示第 $i$ 条联系连接 $u_i$ 与 $v_i$ 且值为 $w_i$。", "outputFormat": "共一行 $m$ 个数字，第 $i$ 个数字为 $0$ 表示使 $u_i$ 受到惩罚，使 $v_i$ 受到救赎；为 $1$ 表示使 $v_i$ 受到惩罚，使 $u_i$ 受到救赎。", "hint": "#### 样例解释\n\n定向后的图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uhz96nbm.png)\n\n更多样例详见题目附件 `trial_sample.zip`。\n\n------\n\n#### 数据范围\n\n**本题采用捆绑测试。**\n\n- 特殊性质 A：边权均为 $1$，且任意两点之间只存在一条简单路径，且没有重边。\n- 特殊性质 B：同一个点至多只有一条边权为 $1$ 和一条边权为 $2$ 的边相连。\n\n| Subtask | 分值 | $1\\le n \\le$ | $1\\le m \\le$ | 特殊性质 | \n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $7$ | $10$ | $15$ | 无 | \n| $2$ |  $20$ |$10^3$ | $3\\times10^3$ | 无 |\n| $3$ |  $20$ |$3 \\times 10^5$ | $3 \\times 10^5$ | A |\n| $4$ | $20$ |$3 \\times 10^5$ | $3 \\times 10^5$ | B | \n| $5$ |  $33$ |$10^6$ | $3 \\times 10^6$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le u_i,v_i \\le n \\le 10^6$，$1 \\le m \\le 3 \\times 10^6$，$w_i \\in \\{1,2\\}$。\n\n在题目附件 `trial_sample.zip` 中：\n\n- `trial_sample1.in` 即为样例 #1。\n- `trial_sample2.in` 满足特殊性质 A。\n- `trial_sample3.in` 满足特殊性质 B。\n- `trial_sample4.in` 不满足特殊性质。\n\n另外该目录下还有 `checker.exe`。\n\n------\n\n#### 提示\n\n**本题输入输出量较大，请使用较快的输入输出方式。**\n\n本题提供 [Special Judge 源码](https://www.luogu.com.cn/paste/7albhubs)和 `checker.exe`，供选手调试。Windows 下使用方法为:  \n命令行在目标文件夹输入指令：\n```\nchecker.exe data.in data.out data.out\n```\n其中 `data.in` 是输入数据文件，`data.out` 是程序运行结果文件。观察评判结果即可。\n\n- `Perfect answer.` 表示答案正确。\n-  `Wrong answer on node x, and the difference is d.` 表示答案错误，其中节点 $x$ 的入边权值和与出边权值和之差的绝对值为 $d$ 而不为 $1$。\n- `Invalid answer.` 表示输出的字符串长度不正确或输出非法字符。\n\n请务必保证**输出格式正确**，否则 Special Judge 可能会返回 Unknown Error 等不可预估的结果。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2029」以父之名", "background": "> 以父之名判决  \n> 那感觉没有适合字汇  \n> 就像边笑边掉泪  \n> 凝视着完全的黑  \n> 阻挡悲剧蔓延的悲剧会让我沉醉  \n> ——《[以父之名](https://www.bilibili.com/video/BV1fx411N7bU?p=36)》", "description": "地狱里有 $n$ 个罪人在等待判决，编号为 $1$ 至 $n$。罪人们之间有 $m$ 条罪的联系，编号为 $1$ 至 $m$，每条联系 的值为 $1$ 或 $2$ 且恰好连接两个罪人。\n\n称一个罪人的自负度为他和其他所有罪人之间联系的值之和。两个罪人之间可能不止有一条联系，此时这些联系的值都应该被计算。由于这些罪人承受了太多的罪恶，他们变得不和谐。具体地，每个罪人的自负度都是奇数。\n\n现在，神明将要对他们进行判决。判决的具体方式为：将每条联系都进行定向，使得这条联系所连接的两个罪人中的一个受到惩罚，另一个受到救赎，它们的值均为这条联系的值。\n\n由于神明秉承父的仁慈，希望罪人们更加均等地接受惩罚和救赎，于是他规定判决后每个罪人所受到的惩罚和救赎值总和之差的绝对值必须恰好为 $1$。\n\n由于神明工作繁忙，因此他以父之名要求你为他找到一种判决的方法。由于父的指示不会有错，所以一定存在一种这样的方法。\n\n---\n\n#### 题意简述\n\n给定一个 $n$ 个点 $m$ 条边的无向图，边权均为 $1$ 或 $2$。保证每个点所相连的边权值之和均为奇数。你需要将这些边定向，使每个点的入边权值和与出边权值和之差的绝对值恰为 $1$。保证有解。输出任意一种方案。", "inputFormat": "第一行两个正整数：$n,m$，表示有 $n$ 个罪人和 $m$ 条罪的联系。\n\n接下来 $m$ 行，第 $i+1$ 行为三个正整数：$u_i,v_i,w_i$，表示第 $i$ 条联系连接 $u_i$ 与 $v_i$ 且值为 $w_i$。", "outputFormat": "共一行 $m$ 个数字，第 $i$ 个数字为 $0$ 表示使 $u_i$ 受到惩罚，使 $v_i$ 受到救赎；为 $1$ 表示使 $v_i$ 受到惩罚，使 $u_i$ 受到救赎。", "hint": "#### 样例解释\n\n定向后的图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uhz96nbm.png)\n\n更多样例详见题目附件 `trial_sample.zip`。\n\n------\n\n#### 数据范围\n\n**本题采用捆绑测试。**\n\n- 特殊性质 A：边权均为 $1$，且任意两点之间只存在一条简单路径，且没有重边。\n- 特殊性质 B：同一个点至多只有一条边权为 $1$ 和一条边权为 $2$ 的边相连。\n\n| Subtask | 分值 | $1\\le n \\le$ | $1\\le m \\le$ | 特殊性质 | \n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $7$ | $10$ | $15$ | 无 | \n| $2$ |  $20$ |$10^3$ | $3\\times10^3$ | 无 |\n| $3$ |  $20$ |$3 \\times 10^5$ | $3 \\times 10^5$ | A |\n| $4$ | $20$ |$3 \\times 10^5$ | $3 \\times 10^5$ | B | \n| $5$ |  $33$ |$10^6$ | $3 \\times 10^6$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le u_i,v_i \\le n \\le 10^6$，$1 \\le m \\le 3 \\times 10^6$，$w_i \\in \\{1,2\\}$。\n\n在题目附件 `trial_sample.zip` 中：\n\n- `trial_sample1.in` 即为样例 #1。\n- `trial_sample2.in` 满足特殊性质 A。\n- `trial_sample3.in` 满足特殊性质 B。\n- `trial_sample4.in` 不满足特殊性质。\n\n另外该目录下还有 `checker.exe`。\n\n------\n\n#### 提示\n\n**本题输入输出量较大，请使用较快的输入输出方式。**\n\n本题提供 [Special Judge 源码](https://www.luogu.com.cn/paste/7albhubs)和 `checker.exe`，供选手调试。Windows 下使用方法为:  \n命令行在目标文件夹输入指令：\n```\nchecker.exe data.in data.out data.out\n```\n其中 `data.in` 是输入数据文件，`data.out` 是程序运行结果文件。观察评判结果即可。\n\n- `Perfect answer.` 表示答案正确。\n-  `Wrong answer on node x, and the difference is d.` 表示答案错误，其中节点 $x$ 的入边权值和与出边权值和之差的绝对值为 $d$ 而不为 $1$。\n- `Invalid answer.` 表示输出的字符串长度不正确或输出非法字符。\n\n请务必保证**输出格式正确**，否则 Special Judge 可能会返回 Unknown Error 等不可预估的结果。", "locale": "zh-CN"}}}
{"pid": "P7817", "type": "P", "difficulty": 3, "samples": [["1\n1", "1"]], "limits": {"time": [1000, 1000], "memory": [524288, 524288]}, "tags": ["数学"], "title": "[RC-05] 迷失自我", "background": "[广告](http://119.27.163.117/problem/86)", "description": "对于两个只包含 $7,9$ 的数字串 $S,T$，如果：\n\n- $S,T$ 长度均为 $n$；\n- $S$ 的字典序小于 $T$；\n- 对于任意 $[l_1,r_1]$ 和 $[l_2,r_2]$（$1\\le l_1\\le r_1\\le n$，$1\\le l_2\\le r_2\\le n$，$l_1,r_1,l_2,r_2$ 为整数，两个区间不相同），设 $A_S$ 为将 $S$ 的第 $l_1\\sim r_1$ 个字符顺次排列得到的十进制数，$A_T$ 为将 $T$ 的第 $l_1\\sim r_1$ 个字符顺次排列得到的十进制数，$B_S$ 为将 $S$ 的第 $l_2\\sim r_2$ 个字符顺次排列得到的十进制数，$B_T$ 为将 $T$ 的第 $l_2\\sim r_2$ 个字符顺次排列得到的十进制数，有 $\\gcd(A_S,B_S)=\\gcd(A_T,B_T)$。\n\n那么，就称 $(S,T)$ 是无法辨识的一对。比如，$S=7977$ 和 $T=7979$ 不是无法辨识的，因为取 $[l_1,r_1]=[1,4]$，$[l_2,r_2]=[2,2]$，则 $\\gcd(A_S,B_S)=\\gcd(7977,9)=3$，$\\gcd(A_T,B_T)=\\gcd(7979,9)=1$，有 $3\\ne 1$。\n\n求长度为 $n$ 的只含 $7,9$ 的数字串中有几对无法辨识。你只需求出答案对 $998244353$ 取模的值。", "inputFormat": "**本题单个测试点内有多组数据。**\n\n第一行是一个整数，为数据组数 $T$。\n\n接下来一行，每行一个整数，为询问的 $n$。", "outputFormat": "$T$ 行，每行一个整数，为这组数据的答案对 $998244353$ 取模的值。", "hint": "对于所有数据，$1\\le T\\le 10^4$，$1\\le n\\le 10^{18}$。\n\n详细数据范围如下表：\n\n| 测试点编号 | $n$ | $T$ | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 10$ | $\\le 10$ | $2$ |\n| $2$ | $\\le 10^{18}$ | $\\le 10^4$ | $98$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RC-05] 迷失自我", "background": "[广告](http://119.27.163.117/problem/86)", "description": "对于两个只包含 $7,9$ 的数字串 $S,T$，如果：\n\n- $S,T$ 长度均为 $n$；\n- $S$ 的字典序小于 $T$；\n- 对于任意 $[l_1,r_1]$ 和 $[l_2,r_2]$（$1\\le l_1\\le r_1\\le n$，$1\\le l_2\\le r_2\\le n$，$l_1,r_1,l_2,r_2$ 为整数，两个区间不相同），设 $A_S$ 为将 $S$ 的第 $l_1\\sim r_1$ 个字符顺次排列得到的十进制数，$A_T$ 为将 $T$ 的第 $l_1\\sim r_1$ 个字符顺次排列得到的十进制数，$B_S$ 为将 $S$ 的第 $l_2\\sim r_2$ 个字符顺次排列得到的十进制数，$B_T$ 为将 $T$ 的第 $l_2\\sim r_2$ 个字符顺次排列得到的十进制数，有 $\\gcd(A_S,B_S)=\\gcd(A_T,B_T)$。\n\n那么，就称 $(S,T)$ 是无法辨识的一对。比如，$S=7977$ 和 $T=7979$ 不是无法辨识的，因为取 $[l_1,r_1]=[1,4]$，$[l_2,r_2]=[2,2]$，则 $\\gcd(A_S,B_S)=\\gcd(7977,9)=3$，$\\gcd(A_T,B_T)=\\gcd(7979,9)=1$，有 $3\\ne 1$。\n\n求长度为 $n$ 的只含 $7,9$ 的数字串中有几对无法辨识。你只需求出答案对 $998244353$ 取模的值。", "inputFormat": "**本题单个测试点内有多组数据。**\n\n第一行是一个整数，为数据组数 $T$。\n\n接下来一行，每行一个整数，为询问的 $n$。", "outputFormat": "$T$ 行，每行一个整数，为这组数据的答案对 $998244353$ 取模的值。", "hint": "对于所有数据，$1\\le T\\le 10^4$，$1\\le n\\le 10^{18}$。\n\n详细数据范围如下表：\n\n| 测试点编号 | $n$ | $T$ | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 10$ | $\\le 10$ | $2$ |\n| $2$ | $\\le 10^{18}$ | $\\le 10^4$ | $98$ |", "locale": "zh-CN"}}}
{"pid": "P7818", "type": "P", "difficulty": 5, "samples": [["5 2\n2 1 4 3 5", "1 2 3 4 5"], ["5 3\n5 4 3 2 1", "2 5 4 3 1"], ["5 6\n5 4 3 2 1", "1 3 5 4 2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "线段树", "树状数组", "O2优化"], "title": "[RC-05] 排列", "background": "[广告](http://119.27.163.117/problem/97)", "description": "给出 $1\\sim n$ 的排列 $p$，下标从 $1$ 开始。\n\n**恰好** $K$ 次任意选择 $1\\le i<n$ 并交换 $p_i,p_{i+1}$。问交换完毕后，字典序最小的排列 $p$ 是什么？", "inputFormat": "第一行两个非负整数 $n,K$，分别表示排列中数的个数和交换次数。\n\n接下来一行 $n$ 个整数，描述排列 $p$。", "outputFormat": "一行以空格隔开的 $n$ 个正整数，描述交换完成之后的排列。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le n\\le 5\\times 10^5$，$0\\le K\\le 10^{12}$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $n$ | $K$ | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 8$ | |$30$ |\n| $2$ | $\\le 10^3$ |  |$30$ |\n| $3$ | $\\le 10^3$ | $=10^{12}$ | $15$ |\n| $4$ | $\\le 5\\times 10^5$ | | $25$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RC-05] 排列", "background": "[广告](http://119.27.163.117/problem/97)", "description": "给出 $1\\sim n$ 的排列 $p$，下标从 $1$ 开始。\n\n**恰好** $K$ 次任意选择 $1\\le i<n$ 并交换 $p_i,p_{i+1}$。问交换完毕后，字典序最小的排列 $p$ 是什么？", "inputFormat": "第一行两个非负整数 $n,K$，分别表示排列中数的个数和交换次数。\n\n接下来一行 $n$ 个整数，描述排列 $p$。", "outputFormat": "一行以空格隔开的 $n$ 个正整数，描述交换完成之后的排列。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le n\\le 5\\times 10^5$，$0\\le K\\le 10^{12}$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $n$ | $K$ | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 8$ | |$30$ |\n| $2$ | $\\le 10^3$ |  |$30$ |\n| $3$ | $\\le 10^3$ | $=10^{12}$ | $15$ |\n| $4$ | $\\le 5\\times 10^5$ | | $25$ |", "locale": "zh-CN"}}}
{"pid": "P7819", "type": "P", "difficulty": 7, "samples": [["15 233\n2\n1 1 3 3 2\n4 8 14 200 24", "319\n7032"], ["939 943 10\n94 618 848 927 92\n421 16 525 45 99\n77 524 662 779 82\n316 630 910 669 51\n857 241 890 447 9\n44 30 95 409 83\n408 302 804 331 73\n571 42 761 334 70\n419 220 704 855 54\n432 80 669 799 52", "33786429\n97803\n41147634\n6638925\n738\n96232\n19796958\n14611599\n6717042\n6402992"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "类欧几里得算法"], "title": "[RC-05] Xor Matrix", "background": "", "description": "给出一个 $n\\times m$ 的矩阵，第 $i$ 行第 $j$ 列填着 $(i-1)m+j$。\n\n求以 $(x,y)$ 为左上角，$(z,w)$ 为右下角的子矩阵的 $k$ 进制下异或和（即不进位加法，比如九进制下 $(45)_9\\ \\mathrm{xor}\\ (87)_9=(33)_9$）。", "inputFormat": "**为了减小测试点个数，本题单个测试点内有多个询问。时间限制已经根据询问组数作了相应调整。**\n\n第一行两个正整数 $n,m$。\n\n接下来一行一个整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行五个正整数 $x,y,z,w,k$，表示一次询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示询问的答案。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le n,m\\le nm\\le 10^{10}$，$1\\le q\\le 10$，$1\\le x\\le z\\le n$，$1\\le y\\le w\\le m$，$2\\le k\\le 10^9$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $nm$ | 特殊性质 | 分数 | \n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 10^{10}$ | $n\\le 10^5$ | $18$ | \n| $2$ | $\\le 2\\times 10^{9}$ | 无 | $61$ | \n| $3$ | $\\le 10^{10}$ | 无 | $21$ |\n\n\n### 子任务依赖\n\n在洛谷上，本题没有设置子任务依赖。在 InfOJ 上，子任务 $3$ 依赖于子任务 $1$。最终评分时，按照存在子任务依赖的版本评分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RC-05] Xor Matrix", "background": "", "description": "给出一个 $n\\times m$ 的矩阵，第 $i$ 行第 $j$ 列填着 $(i-1)m+j$。\n\n求以 $(x,y)$ 为左上角，$(z,w)$ 为右下角的子矩阵的 $k$ 进制下异或和（即不进位加法，比如九进制下 $(45)_9\\ \\mathrm{xor}\\ (87)_9=(33)_9$）。", "inputFormat": "**为了减小测试点个数，本题单个测试点内有多个询问。时间限制已经根据询问组数作了相应调整。**\n\n第一行两个正整数 $n,m$。\n\n接下来一行一个整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行五个正整数 $x,y,z,w,k$，表示一次询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示询问的答案。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le n,m\\le nm\\le 10^{10}$，$1\\le q\\le 10$，$1\\le x\\le z\\le n$，$1\\le y\\le w\\le m$，$2\\le k\\le 10^9$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $nm$ | 特殊性质 | 分数 | \n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 10^{10}$ | $n\\le 10^5$ | $18$ | \n| $2$ | $\\le 2\\times 10^{9}$ | 无 | $61$ | \n| $3$ | $\\le 10^{10}$ | 无 | $21$ |\n\n\n### 子任务依赖\n\n在洛谷上，本题没有设置子任务依赖。在 InfOJ 上，子任务 $3$ 依赖于子任务 $1$。最终评分时，按照存在子任务依赖的版本评分。", "locale": "zh-CN"}}}
{"pid": "P7820", "type": "P", "difficulty": 7, "samples": [["3\n4 3 1\n5 3 1\n15 7 2", "10\n16\n1586"], ["5\n999999999 14 7\n233333333 14 8\n333333333 14 9\n114514191 14 10\n981011451 14 11", "278944053\n533032251\n736989868\n589364996\n572821890"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "线性递推", "快速数论变换 NTT", "Berlekamp-Massey(BM) 算法"], "title": "[RC-05] 01 序列", "background": "", "description": "有一个长度为 $n$ 的 $01$ 序列，它的任意一个长为 $k$ 的连续子串中都有 $a$ 个 $0$ 或 $a+1$ 个 $0$。\n\n求可能的序列数。答案很大，请输出其模 $998244353$ 的值。", "inputFormat": "**为了减小测试点个数，本题单个测试点内有多组数据。时间限制已经根据数据组数作了相应调整。**\n\n输入第一行是数据组数 $T$。\n\n每组数据中，输入一行三个整数：$n,k,a$。", "outputFormat": "对于每组数据，输出一个非负整数，为可能的序列数模 $998244353$ 的值。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le T\\le 5$，$1\\le k\\le n\\le 10^9$，$1\\le k\\le 14$，$0\\le a<k$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $n$ | $k$ | 特殊性质 | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le 18$ | $\\le 14$ | 无 | $1$ |\n| $2$ | $\\le 2000$ | $\\le 10$ | 无 | $8$ |\n| $3$ | $\\le 10^9$ | $\\le 14$ | $a=0$ | $7$ |\n| $4$ | $\\le 10^9$ | $\\le 7$ | 无 | $12$ |\n| $5$ | $\\le 10^9$ | $\\le 8$ | 无 | $12$ |\n| $6$ | $\\le 10^9$ | $\\le 9$ | 无 | $12$ |\n| $7$ | $\\le 10^9$ | $\\le 11$ | 无 | $12$ |\n| $8$ | $\\le 10^9$ | $\\le 12$ | 无 | $12$ |\n| $9$ | $\\le 10^9$ | $\\le 13$ | 无 | $12$ |\n| $10$ | $\\le 10^9$ | $\\le 14$ | 无 | $12$ |", "locale": "zh-CN", "translations": {"en": {"title": "[RC-05] 01 Sequence", "background": "", "description": "There is a $01$ sequence of length $n$. In any consecutive substring of length $k$, there are either $a$ zeros or $a+1$ zeros.\n\nFind the number of possible sequences. The answer can be very large, so output it modulo $998244353$.", "inputFormat": "**To reduce the number of test points, this problem contains multiple test cases within a single test point. The time limit has been adjusted accordingly based on the number of test cases.**\n\nThe first line contains the number of test cases $T$.\n\nFor each test case, one line contains three integers: $n, k, a$.", "outputFormat": "For each test case, output a non-negative integer, which is the number of possible sequences modulo $998244353$.", "hint": "**This problem uses bundled judging.**\n\nFor all data, $1\\le T\\le 5$, $1\\le k\\le n\\le 10^9$, $1\\le k\\le 14$, $0\\le a<k$.\n\nThe detailed Constraints are shown in the table below:\n\n| Subtask ID | $n$ | $k$ | Special Property | Score |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le 18$ | $\\le 14$ | None | $1$ |\n| $2$ | $\\le 2000$ | $\\le 10$ | None | $8$ |\n| $3$ | $\\le 10^9$ | $\\le 14$ | $a=0$ | $7$ |\n| $4$ | $\\le 10^9$ | $\\le 7$ | None | $12$ |\n| $5$ | $\\le 10^9$ | $\\le 8$ | None | $12$ |\n| $6$ | $\\le 10^9$ | $\\le 9$ | None | $12$ |\n| $7$ | $\\le 10^9$ | $\\le 11$ | None | $12$ |\n| $8$ | $\\le 10^9$ | $\\le 12$ | None | $12$ |\n| $9$ | $\\le 10^9$ | $\\le 13$ | None | $12$ |\n| $10$ | $\\le 10^9$ | $\\le 14$ | None | $12$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[RC-05] 01 序列", "background": "", "description": "有一个长度为 $n$ 的 $01$ 序列，它的任意一个长为 $k$ 的连续子串中都有 $a$ 个 $0$ 或 $a+1$ 个 $0$。\n\n求可能的序列数。答案很大，请输出其模 $998244353$ 的值。", "inputFormat": "**为了减小测试点个数，本题单个测试点内有多组数据。时间限制已经根据数据组数作了相应调整。**\n\n输入第一行是数据组数 $T$。\n\n每组数据中，输入一行三个整数：$n,k,a$。", "outputFormat": "对于每组数据，输出一个非负整数，为可能的序列数模 $998244353$ 的值。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le T\\le 5$，$1\\le k\\le n\\le 10^9$，$1\\le k\\le 14$，$0\\le a<k$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $n$ | $k$ | 特殊性质 | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le 18$ | $\\le 14$ | 无 | $1$ |\n| $2$ | $\\le 2000$ | $\\le 10$ | 无 | $8$ |\n| $3$ | $\\le 10^9$ | $\\le 14$ | $a=0$ | $7$ |\n| $4$ | $\\le 10^9$ | $\\le 7$ | 无 | $12$ |\n| $5$ | $\\le 10^9$ | $\\le 8$ | 无 | $12$ |\n| $6$ | $\\le 10^9$ | $\\le 9$ | 无 | $12$ |\n| $7$ | $\\le 10^9$ | $\\le 11$ | 无 | $12$ |\n| $8$ | $\\le 10^9$ | $\\le 12$ | 无 | $12$ |\n| $9$ | $\\le 10^9$ | $\\le 13$ | 无 | $12$ |\n| $10$ | $\\le 10^9$ | $\\le 14$ | 无 | $12$ |", "locale": "zh-CN"}}}
{"pid": "P7821", "type": "P", "difficulty": 3, "samples": [["5\n5 3 0 2 5 2\n5 5 2 3 0 5\n3 100 1 2 6 6\n5 9 0 2 3 9\n4 5 0 5 1 3", "13 7\n14 10\n201 6\n29 0\n15 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "O2优化"], "title": "「RdOI R3」race", "background": "", "description": "某足球赛事上，A 国队和 B 国队共进行了 $n$ 场比赛。比赛采用积分赛制，胜者队伍得 $a$ 分，败者队伍得 $b$ 分，若打平则双方各得 $c$ 分。现已知 A 国队总进球数 $d$ 球，B 国队总进球数 $e$ 球，求 A 国队的最大可能得分和最小可能得分。", "inputFormat": "**本题含有多组数据。**\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据，输入一行六个整数 $n,a,b,c,d,e$。", "outputFormat": "对于每组数据，输出一行两个整数，用空格分隔，表示最大可能得分和最小可能得分。", "hint": "### 样例解释\n\n为便于理解样例，现给出前三组数据的样例解释：\n\n| 数据编号 | 最大得分方案                    | 最小得分方案                    |\n| -------- | ------------------------------- | ------------------------------- |\n| $1$      | $(1,0),(0,0),(2,1),(0,0),(2,1)$ | $(0,0),(5,0),(0,1),(0,0),(0,1)$ |\n| $2$      | $(0,0),(0,5),(0,0),(0,0),(0,0)$ | $(0,1),(0,1),(0,1),(0,1),(0,1)$ |\n| $3$      | $(3,2),(0,2),(3,2)$             | $(6,6),(0,0),(0,0)$             |\n\n表格中的 $(x_1,y_1),(x_2,y_2),\\cdots,(x_n,y_n)$ 表示第 $1$ 场比分为 $x_1:y_1$，第 $2$ 场比分为 $x_2:y_2$，以此类推。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le T\\le 10^5$，$1\\le n \\le 10^9$\n，$0\\le d,e\\le10^9$，$0\\le b\\le c \\le a\\le10^9$。\n\n| subtask | 分值 | 特殊限制             | subtask 依赖 |\n| ------- | ---- | -------------------- | ------------ |\n| $1$     | $10$ | $e=0$                | 无           |\n| $2$     | $20$ | $n,d,e\\le 5,T\\le100$ | 无           |\n| $3$     | $20$ | $n\\le 5$             | $2$          |\n| $4$     | $50$ | 无                   | $1,3$        |\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」race", "background": "", "description": "某足球赛事上，A 国队和 B 国队共进行了 $n$ 场比赛。比赛采用积分赛制，胜者队伍得 $a$ 分，败者队伍得 $b$ 分，若打平则双方各得 $c$ 分。现已知 A 国队总进球数 $d$ 球，B 国队总进球数 $e$ 球，求 A 国队的最大可能得分和最小可能得分。", "inputFormat": "**本题含有多组数据。**\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据，输入一行六个整数 $n,a,b,c,d,e$。", "outputFormat": "对于每组数据，输出一行两个整数，用空格分隔，表示最大可能得分和最小可能得分。", "hint": "### 样例解释\n\n为便于理解样例，现给出前三组数据的样例解释：\n\n| 数据编号 | 最大得分方案                    | 最小得分方案                    |\n| -------- | ------------------------------- | ------------------------------- |\n| $1$      | $(1,0),(0,0),(2,1),(0,0),(2,1)$ | $(0,0),(5,0),(0,1),(0,0),(0,1)$ |\n| $2$      | $(0,0),(0,5),(0,0),(0,0),(0,0)$ | $(0,1),(0,1),(0,1),(0,1),(0,1)$ |\n| $3$      | $(3,2),(0,2),(3,2)$             | $(6,6),(0,0),(0,0)$             |\n\n表格中的 $(x_1,y_1),(x_2,y_2),\\cdots,(x_n,y_n)$ 表示第 $1$ 场比分为 $x_1:y_1$，第 $2$ 场比分为 $x_2:y_2$，以此类推。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le T\\le 10^5$，$1\\le n \\le 10^9$\n，$0\\le d,e\\le10^9$，$0\\le b\\le c \\le a\\le10^9$。\n\n| subtask | 分值 | 特殊限制             | subtask 依赖 |\n| ------- | ---- | -------------------- | ------------ |\n| $1$     | $10$ | $e=0$                | 无           |\n| $2$     | $20$ | $n,d,e\\le 5,T\\le100$ | 无           |\n| $3$     | $20$ | $n\\le 5$             | $2$          |\n| $4$     | $50$ | 无                   | $1,3$        |\n\n", "locale": "zh-CN"}}}
{"pid": "P7822", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2", "4"], ["2 1\n1", "0"], ["8 5\n4 2 3 4 2", "356314"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "O2优化"], "title": "「RdOI R3」学习算法", "background": "暑假中，MLE 决定学习一下 OI 算法。\n", "description": "暑假一共有 $n$ 天，我们假设 MLE 每天都有足够的时间学 OI。MLE 列出了可供选择的 $m$ 个算法。MLE 每天只能且必须学习一个算法。\n\n而且，MLE 长时间学同一种算法会厌倦，所以每一种算法不能连续学习太多天，第 $i$ 种算法最多可以连续学习 $a_i$ 天。**MLE 没有必要学习全部的算法。**\n\nMLE 想知道，自己有多少种不同的学习安排来度过这 $n$ 天。两种学习安排不同仅当这两种安排中有至少一天学习的算法不同。因为方法可能过多，你只需要输出方案数对 $10^9+7$ 取模即可。", "inputFormat": "第一行为两个整数 $n,m$。  \n第二行 $m$ 个整数 $a_1,a_2,\\cdots,a_m$。", "outputFormat": "输出一行一个整数，方案数对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n#### 样例 \\#1\n\n第一种算法最多连续学习一天，第二种最多连续学习两天。故共有如下四种学习方式：\n\n- $1,2,2$。\n- $2,1,2$。\n- $2,2,1$。\n- $1,2,1$。\n\n#### 样例 \\#2\n\n由于唯一的一种算法最多只能连续学习一天，所以没有合法的方案可以度过 $2$ 天。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试，若无特殊说明，测试点的内存限制为 256MB。**\n\n对于所有数据，$1\\le a_i \\le n\\le 7 \\times 10^3$，$1\\le m \\le 7\\times 10^3$。\n\n| subtask | 分值 | $n,m\\le$ | 特殊限制            |\n| ------- | ---- | -------- | ------------------- |\n| $1$     | $5$  | $5$      | 无                 |\n| $2$     | $10$ | $100$    | 无                 |\n| $3$     | $15$ | $500$    | 无                 |\n| $4$     | $20$ | $7\\times 10^3$   | $a_i=1$             |\n| $5$     | $20$ | $7\\times 10^3$   | 内存限制为 $500$ MB |\n| $6$     | $30$ | $7\\times 10^3$   | 无                 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」学习算法", "background": "暑假中，MLE 决定学习一下 OI 算法。\n", "description": "暑假一共有 $n$ 天，我们假设 MLE 每天都有足够的时间学 OI。MLE 列出了可供选择的 $m$ 个算法。MLE 每天只能且必须学习一个算法。\n\n而且，MLE 长时间学同一种算法会厌倦，所以每一种算法不能连续学习太多天，第 $i$ 种算法最多可以连续学习 $a_i$ 天。**MLE 没有必要学习全部的算法。**\n\nMLE 想知道，自己有多少种不同的学习安排来度过这 $n$ 天。两种学习安排不同仅当这两种安排中有至少一天学习的算法不同。因为方法可能过多，你只需要输出方案数对 $10^9+7$ 取模即可。", "inputFormat": "第一行为两个整数 $n,m$。  \n第二行 $m$ 个整数 $a_1,a_2,\\cdots,a_m$。", "outputFormat": "输出一行一个整数，方案数对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n#### 样例 \\#1\n\n第一种算法最多连续学习一天，第二种最多连续学习两天。故共有如下四种学习方式：\n\n- $1,2,2$。\n- $2,1,2$。\n- $2,2,1$。\n- $1,2,1$。\n\n#### 样例 \\#2\n\n由于唯一的一种算法最多只能连续学习一天，所以没有合法的方案可以度过 $2$ 天。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试，若无特殊说明，测试点的内存限制为 256MB。**\n\n对于所有数据，$1\\le a_i \\le n\\le 7 \\times 10^3$，$1\\le m \\le 7\\times 10^3$。\n\n| subtask | 分值 | $n,m\\le$ | 特殊限制            |\n| ------- | ---- | -------- | ------------------- |\n| $1$     | $5$  | $5$      | 无                 |\n| $2$     | $10$ | $100$    | 无                 |\n| $3$     | $15$ | $500$    | 无                 |\n| $4$     | $20$ | $7\\times 10^3$   | $a_i=1$             |\n| $5$     | $20$ | $7\\times 10^3$   | 内存限制为 $500$ MB |\n| $6$     | $30$ | $7\\times 10^3$   | 无                 |", "locale": "zh-CN"}}}
{"pid": "P7823", "type": "P", "difficulty": 6, "samples": [["6\n1 1 4 5 1 4", "7"], ["5\n4 1 9 2 3", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化"], "title": "「RdOI R3」闹钟", "background": "", "description": "你有一个闹钟，闹钟的定时可以用两个变量 $a_1,a_2$ 表示，变量的初始值皆为 $0$。把一个变量从 $x$ 调整至 $y$ 需要 $|x-y|$ 的代价。\n\n接下来给出 $n$ 个数 $k_1,k_2,\\cdots,k_n$。对于第 $i$ 天，你都需要通过调整变量的值，使得两个变量中**至少**有一个等于 $k_i$。求最小代价。", "inputFormat": "第一行一个整数 $n$。  \n第二行 $n$ 个整数 $k_1,k_2,\\cdots,k_n$。", "outputFormat": "一行一个整数，表示最小代价。", "hint": "### 样例解释\n\n样例解释一：  \n第一天：$a=\\{1,0\\}$。  \n第二天：$a=\\{1,0\\}$。  \n第三天：$a=\\{4,0\\}$。  \n第四天：$a=\\{5,0\\}$。  \n第五天：$a=\\{5,1\\}$。  \n第六天：$a=\\{4,1\\}$。  \n\n样例解释二：  \n第一天：$a=\\{4,0\\}$。  \n第二天：$a=\\{4,1\\}$。  \n第三天：$a=\\{9,1\\}$。  \n第四天：$a=\\{9,2\\}$。  \n第五天：$a=\\{9,3\\}$。 \n\n---\n\n### 数据范围\n\n|数据编号|$n\\le$|特殊性质|\n|:-:|:-:|:-:|\n|$1$|$10$|无|\n|$2$|$10^3$|$k_i\\le100$|\n|$3\\sim4$|$10^3$|无|\n|$5\\sim7$|$10^5$|$k_i\\le100$|\n|$8\\sim10$|$10^5$|无|\n\n另外，为了卡掉一些错误做法，本题添加了若干 hack 测试点。hack 测试点的数据满足 $n\\le10$ 且 $k_i\\le 100$。若你的程序没有通过至少一个 hack 测试点，则此题分数记为 $0$ 分。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5,1\\le k_i\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」闹钟", "background": "", "description": "你有一个闹钟，闹钟的定时可以用两个变量 $a_1,a_2$ 表示，变量的初始值皆为 $0$。把一个变量从 $x$ 调整至 $y$ 需要 $|x-y|$ 的代价。\n\n接下来给出 $n$ 个数 $k_1,k_2,\\cdots,k_n$。对于第 $i$ 天，你都需要通过调整变量的值，使得两个变量中**至少**有一个等于 $k_i$。求最小代价。", "inputFormat": "第一行一个整数 $n$。  \n第二行 $n$ 个整数 $k_1,k_2,\\cdots,k_n$。", "outputFormat": "一行一个整数，表示最小代价。", "hint": "### 样例解释\n\n样例解释一：  \n第一天：$a=\\{1,0\\}$。  \n第二天：$a=\\{1,0\\}$。  \n第三天：$a=\\{4,0\\}$。  \n第四天：$a=\\{5,0\\}$。  \n第五天：$a=\\{5,1\\}$。  \n第六天：$a=\\{4,1\\}$。  \n\n样例解释二：  \n第一天：$a=\\{4,0\\}$。  \n第二天：$a=\\{4,1\\}$。  \n第三天：$a=\\{9,1\\}$。  \n第四天：$a=\\{9,2\\}$。  \n第五天：$a=\\{9,3\\}$。 \n\n---\n\n### 数据范围\n\n|数据编号|$n\\le$|特殊性质|\n|:-:|:-:|:-:|\n|$1$|$10$|无|\n|$2$|$10^3$|$k_i\\le100$|\n|$3\\sim4$|$10^3$|无|\n|$5\\sim7$|$10^5$|$k_i\\le100$|\n|$8\\sim10$|$10^5$|无|\n\n另外，为了卡掉一些错误做法，本题添加了若干 hack 测试点。hack 测试点的数据满足 $n\\le10$ 且 $k_i\\le 100$。若你的程序没有通过至少一个 hack 测试点，则此题分数记为 $0$ 分。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5,1\\le k_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P7824", "type": "P", "difficulty": 6, "samples": [["4 12\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 0 1 1 1 1 1 1 1 0 1 1\n", "\n1 1 1\n1 1 2\n1 1 3\n1 1 4\n1 1 1\n1 1 2\n1 1 3\n1 1 4\n1 1 1\n1 1 2\n1 1 3\n1 1 4\n2\n\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["交互题", "Special Judge", "O2优化"], "title": "「RdOI R3」毒水", "background": "", "description": "**这是一道 IO 交互题。**\n\n现在你面前有 $n$ 瓶水，从 $1\\sim n$ 编号，其中有 $1$ 瓶水有毒，你可以用一些小白鼠来进行判断。\n\n但是你找的小白鼠中**有且仅有**一只**变异鼠**，**如果它喝的水中有毒水，那么它不会死亡。否则它会在 $59$ 秒内死亡。其它小白鼠如果喝了毒水将在 $59$ 秒内死亡，否则不会死亡**。\n\n你需要在一分钟内找出这瓶毒水，因为测试已经花了 $59$ 秒，所以你的代码只能运行 $1$ 秒。\n\n### 交互方式\n\n首先你需要从标准输入读取两个整数 $n$，$maxk$，表示水的数量，以及你最多能找到的小白鼠个数。\n\n若你需要 $k$ 只小白鼠，你需要向标准输出打印 $k+1$ 行，除了最后一行，每一行的格式为：`1 m B1 B2 ... Bm`，表示你找到一只小白鼠并让它喝 $B_1$ 号，$B_2$ 号，$\\cdots$，$B_m$ 号这 $m$ 瓶中的水。你需要在最后写上一行：`2`，随后清空缓冲区，表示你不需要更多的小白鼠了。\n\n下面是一些语言的刷新缓冲区操作：\n\n- C++：`fflush(stdout)` 或 `cout.flush()`。\n- C: `fflush(stdout)`。\n- Java: `System.out.flush()`。\n- Python: `stdout.flush()`。\n- Pascal: `flush(output)`。\n- 其他语言：请参考对应语言的帮助文档。\n\n当然，如果 $k>maxk$，交互库会返回 `WA`、`RE`、`UKE` 或 `TLE`，同时该测试点不得分。\n\n然后你需要从标准输入读取 $k$ 个整数 $R_1,R_2,\\cdots,R_k;R_i\\in\\{0,1\\}$。若 $R_i=0$ 代表第 $i$ 号小白鼠已死亡，否则代表第 $i$ 号小白鼠仍存活。\n\n最后你需要从标准输出打印一个整数，表示毒水的编号。", "inputFormat": "见**交互方式**。", "outputFormat": "见**交互方式**。", "hint": "### 样例说明\n\n毒水的编号为 $2$，且第 $2$ 次和第 $10$ 次均为让小白鼠喝下 $2$ 号毒水，故这两次操作返回的结果为 $0$。其他操作由于让小白鼠喝的不是毒水，返回的结果为 $1$。\n\n**样例仅为理解交互方式使用，可能不符合逻辑。**\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**  \n\n**注意：本题不存在一个 subtask 包含其他所有 subtask**。\n\n| subtask | 分值 | $n$             | $maxk\\ge$ |\n| ------- | ---- | --------------- | ------- |\n| $1$     | $1$  | $=1$            | $0$     |\n| $2$     | $9$  | $\\le 1000$      | $3000$  |\n| $3$     | $20$ | $\\le 1000$      | $30$    |\n| $4$     | $30$ | $8\\le n \\le 16$ | $7$     |\n| $5$     | $40$ | $\\le 1000$      | $15$    |\n\n---\n\n### 注意\n\n只有你向交互器发送 $2$ 操作时，交互器才会将你先前的 $1$ 操作的答案告诉你。也就是说，你不能在执行一次 $1$ 操作后立刻得到这次操作的返回结果。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」毒水", "background": "", "description": "**这是一道 IO 交互题。**\n\n现在你面前有 $n$ 瓶水，从 $1\\sim n$ 编号，其中有 $1$ 瓶水有毒，你可以用一些小白鼠来进行判断。\n\n但是你找的小白鼠中**有且仅有**一只**变异鼠**，**如果它喝的水中有毒水，那么它不会死亡。否则它会在 $59$ 秒内死亡。其它小白鼠如果喝了毒水将在 $59$ 秒内死亡，否则不会死亡**。\n\n你需要在一分钟内找出这瓶毒水，因为测试已经花了 $59$ 秒，所以你的代码只能运行 $1$ 秒。\n\n### 交互方式\n\n首先你需要从标准输入读取两个整数 $n$，$maxk$，表示水的数量，以及你最多能找到的小白鼠个数。\n\n若你需要 $k$ 只小白鼠，你需要向标准输出打印 $k+1$ 行，除了最后一行，每一行的格式为：`1 m B1 B2 ... Bm`，表示你找到一只小白鼠并让它喝 $B_1$ 号，$B_2$ 号，$\\cdots$，$B_m$ 号这 $m$ 瓶中的水。你需要在最后写上一行：`2`，随后清空缓冲区，表示你不需要更多的小白鼠了。\n\n下面是一些语言的刷新缓冲区操作：\n\n- C++：`fflush(stdout)` 或 `cout.flush()`。\n- C: `fflush(stdout)`。\n- Java: `System.out.flush()`。\n- Python: `stdout.flush()`。\n- Pascal: `flush(output)`。\n- 其他语言：请参考对应语言的帮助文档。\n\n当然，如果 $k>maxk$，交互库会返回 `WA`、`RE`、`UKE` 或 `TLE`，同时该测试点不得分。\n\n然后你需要从标准输入读取 $k$ 个整数 $R_1,R_2,\\cdots,R_k;R_i\\in\\{0,1\\}$。若 $R_i=0$ 代表第 $i$ 号小白鼠已死亡，否则代表第 $i$ 号小白鼠仍存活。\n\n最后你需要从标准输出打印一个整数，表示毒水的编号。", "inputFormat": "见**交互方式**。", "outputFormat": "见**交互方式**。", "hint": "### 样例说明\n\n毒水的编号为 $2$，且第 $2$ 次和第 $10$ 次均为让小白鼠喝下 $2$ 号毒水，故这两次操作返回的结果为 $0$。其他操作由于让小白鼠喝的不是毒水，返回的结果为 $1$。\n\n**样例仅为理解交互方式使用，可能不符合逻辑。**\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**  \n\n**注意：本题不存在一个 subtask 包含其他所有 subtask**。\n\n| subtask | 分值 | $n$             | $maxk\\ge$ |\n| ------- | ---- | --------------- | ------- |\n| $1$     | $1$  | $=1$            | $0$     |\n| $2$     | $9$  | $\\le 1000$      | $3000$  |\n| $3$     | $20$ | $\\le 1000$      | $30$    |\n| $4$     | $30$ | $8\\le n \\le 16$ | $7$     |\n| $5$     | $40$ | $\\le 1000$      | $15$    |\n\n---\n\n### 注意\n\n只有你向交互器发送 $2$ 操作时，交互器才会将你先前的 $1$ 操作的答案告诉你。也就是说，你不能在执行一次 $1$ 操作后立刻得到这次操作的返回结果。", "locale": "zh-CN"}}}
{"pid": "P7825", "type": "P", "difficulty": 6, "samples": [["5 7\n0 1 1 0 1\n0 1 2\n2 1 5\n3 1 5 3\n2 1 3\n2 2 3\n3 1 5 3\n4 1 5", "2\n3\n5"], ["10 9\n0 1 1 0 1 1 0 1 1 0\n3 1 5 3\n4 2 9\n4 1 4\n3 4 10 4\n3 4 10 3\n4 1 5\n4 9 10\n4 4 6\n4 5 9", "1\n3\n2\n0\n1\n3\n2\n2\n3"], ["10 10\n0 0 0 1 0 0 0 1 0 0\n2 7 10\n4 6 9\n3 2 9 7\n1 6 7\n4 10 10\n1 1 3\n3 4 7 3\n4 2 8\n1 6 9\n4 5 6", "4\n0\n1\n1\n3\n2"]], "limits": {"time": [300, 300, 300, 300, 300, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "树套树"], "title": "「RdOI R3」VSQ", "background": "", "description": "设 $x$ 为一个长度不小于 $2$ 的 $01$ 串，如果 $x$ 的所有长度为 $2$ 的子串的异或和均为 $1$，则 $x$ 为一个「VS 串」。\n\n你需要维护一个长度为 $n$ 的 $01$ 串 $a$，支持以下操作：\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|} \\hline\n\\textbf{格式} & \\textbf{说明} \\cr\\hline\n\\texttt{0 l r} & \\text{将区间 }[l,r]\\text{ 填充为 }0 \\cr\\hline\n\\texttt{1 l r}& \\text{将区间 }[l,r]\\text{ 填充为 }1 \\cr\\hline\n\\texttt{2 l r}& \\text{将区间 }[l,r]\\text{ 中的每个数取反，即 }1\\text{ 变 } 0\\text{，}0\\text{ 变 }1 \\cr\\hline\n\\texttt{3 l r k} & \\text{查询}[l,r]\\text{ 区间中有多少个长度为 }k\\text{ 的子串是「VS 串」} \\cr\\hline\n\\texttt{4 l r} & {\\def\\arraystretch{1}\\begin{array}{c}\n\\text{查询 }[l,r]\\text{ 区间内最长的「VS 串」的长度，}\\\\\\text{如果区间内不存在这样的子串则输出 }1 \\end{array}} \\cr\\hline\n\\end{array}\n$$\n", "inputFormat": "第一行两个整数 $n,m$，表示 $01$ 串长度与操作个数。  \n第二行 $n$ 个整数，表示 $a_1,a_2,\\cdots,a_n$。  \n接下来 $m$ 行，每行三或四个整数 $op, l, r(,k)$，表示一次操作。", "outputFormat": "对于每个查询操作，输出一行一个整数，表示其对应的答案。", "hint": "### 样例解释\n\n#### 样例 #1\n\n|操作次数|输入内容|零一串|答案|\n|-|-|-|-|\n|$0$|$/$|$01101$|$/$|\n|$1$|`0 1 2`|$00101$|$/$|\n|$2$|`2 1 5`|$11010$|$/$|\n|$3$|`3 1 5 3`|$11010$|$2$|\n|$4$|`2 1 3`|$00110$|$/$|\n|$5$|`2 2 3`|$01010$|$/$|\n|$6$|`3 1 5 3`|$01010$|$3$|\n|$7$|`4 1 5`|$01010$|$5$|\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，有 $0\\le op \\le 4$，$1 \\le l \\le r \\le n\\le3\\times10^5$，$3 \\le k \\le n$，$1\\le m \\le 5 \\times 10^5$。\n\n| subtask | 分值 | $4\\le n,m \\le$ |时间限制| 特殊性质                    |\n| ------- | ---- | -------------- |-------| --------------------------- |\n| $1$     | $10$ | $10^3$         |$300$ ms| 无                          |\n| $2$     | $15$ | $10^5$         |$1000$ ms| 没有 $0,1,2$ 操作           |\n| $3$     | $15$ | $10^5$         |$2000$ ms| 没有 $3$ 操作               |\n| $4$     | $15$ | $10^5$         |$2000$ ms| $op,l,r,a_i$ 在其数据范围内等概率随机生成 |\n| $5$     | $15$ | $10^5$         |$3000$ ms| $k=3$                       |\n| $6$     | $10$ | $10^5$         |$3000$ ms| 无                          |\n| $7$     | $20$ | $5\\times10^5$         |$2000$ ms| $n\\le3\\times10^5$                          |   \n\n本题可能略微卡常。  \n这样设计时间限制是为了让测试点总时间限制在 120s 以内并且卡掉错误算法。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」VSQ", "background": "", "description": "设 $x$ 为一个长度不小于 $2$ 的 $01$ 串，如果 $x$ 的所有长度为 $2$ 的子串的异或和均为 $1$，则 $x$ 为一个「VS 串」。\n\n你需要维护一个长度为 $n$ 的 $01$ 串 $a$，支持以下操作：\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|} \\hline\n\\textbf{格式} & \\textbf{说明} \\cr\\hline\n\\texttt{0 l r} & \\text{将区间 }[l,r]\\text{ 填充为 }0 \\cr\\hline\n\\texttt{1 l r}& \\text{将区间 }[l,r]\\text{ 填充为 }1 \\cr\\hline\n\\texttt{2 l r}& \\text{将区间 }[l,r]\\text{ 中的每个数取反，即 }1\\text{ 变 } 0\\text{，}0\\text{ 变 }1 \\cr\\hline\n\\texttt{3 l r k} & \\text{查询}[l,r]\\text{ 区间中有多少个长度为 }k\\text{ 的子串是「VS 串」} \\cr\\hline\n\\texttt{4 l r} & {\\def\\arraystretch{1}\\begin{array}{c}\n\\text{查询 }[l,r]\\text{ 区间内最长的「VS 串」的长度，}\\\\\\text{如果区间内不存在这样的子串则输出 }1 \\end{array}} \\cr\\hline\n\\end{array}\n$$\n", "inputFormat": "第一行两个整数 $n,m$，表示 $01$ 串长度与操作个数。  \n第二行 $n$ 个整数，表示 $a_1,a_2,\\cdots,a_n$。  \n接下来 $m$ 行，每行三或四个整数 $op, l, r(,k)$，表示一次操作。", "outputFormat": "对于每个查询操作，输出一行一个整数，表示其对应的答案。", "hint": "### 样例解释\n\n#### 样例 #1\n\n|操作次数|输入内容|零一串|答案|\n|-|-|-|-|\n|$0$|$/$|$01101$|$/$|\n|$1$|`0 1 2`|$00101$|$/$|\n|$2$|`2 1 5`|$11010$|$/$|\n|$3$|`3 1 5 3`|$11010$|$2$|\n|$4$|`2 1 3`|$00110$|$/$|\n|$5$|`2 2 3`|$01010$|$/$|\n|$6$|`3 1 5 3`|$01010$|$3$|\n|$7$|`4 1 5`|$01010$|$5$|\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，有 $0\\le op \\le 4$，$1 \\le l \\le r \\le n\\le3\\times10^5$，$3 \\le k \\le n$，$1\\le m \\le 5 \\times 10^5$。\n\n| subtask | 分值 | $4\\le n,m \\le$ |时间限制| 特殊性质                    |\n| ------- | ---- | -------------- |-------| --------------------------- |\n| $1$     | $10$ | $10^3$         |$300$ ms| 无                          |\n| $2$     | $15$ | $10^5$         |$1000$ ms| 没有 $0,1,2$ 操作           |\n| $3$     | $15$ | $10^5$         |$2000$ ms| 没有 $3$ 操作               |\n| $4$     | $15$ | $10^5$         |$2000$ ms| $op,l,r,a_i$ 在其数据范围内等概率随机生成 |\n| $5$     | $15$ | $10^5$         |$3000$ ms| $k=3$                       |\n| $6$     | $10$ | $10^5$         |$3000$ ms| 无                          |\n| $7$     | $20$ | $5\\times10^5$         |$2000$ ms| $n\\le3\\times10^5$                          |   \n\n本题可能略微卡常。  \n这样设计时间限制是为了让测试点总时间限制在 120s 以内并且卡掉错误算法。", "locale": "zh-CN"}}}
{"pid": "P7826", "type": "P", "difficulty": 6, "samples": [["10 10 500 1\n3 2 1 2 1 3 2 1 3 4\n1 4\n7 8\n3 6\n8 10\n2 3\n2 5\n8 9\n7 2\n2 1\n4 1\n1 3 1\n2 1 2\n4 1\n4 3\n4 6\n1 4 1\n3 7\n1 5 1\n4 5\n", "10\n5\n6\n4\n12\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["树形数据结构", "线段树", "O2优化", "分块", "位运算"], "title": "「RdOI R3」RBT", "background": "", "description": "你有一棵以 $1$ 为根，编号为 $1\\sim n$ 的有根树，第 $i$ 号节点上有一个整数权值 $a_i$。同时每一个点都被染上了红色或蓝色。初始所有点全是红色点。你需要维护这棵树，进行 $q$ 次操作。操作分若干种，具体格式如下：\n\n- `1 x v` ：使 $x$ 节点的子树中的每个节点的权值增加 $v$ 并对 $p$ 取模。\n- `2 x v`：将 $a_x$ 赋值为 $v$。**注意不是赋值整棵子树。**\n- `3 x`：将 $x$ 号点染成蓝色，设 $j$ 节点为 $x$ 号节点在它的**红色**兄弟节点中**编号**（不是权值）排名的前驱，将 $x$ 节点连接父亲的边删除。然后将 $x$ 节点作为儿子节点接到 $j$ 节点上，如果 $x$ 节点没有红色兄弟节点或 $x$ 节点的红色兄弟节点的编号均比 $x$ 大则什么都不做。\n- `4 x`：设 $S$ 为 $x$ 的子树中的节点的权值中出现次数为奇数的数组成的集合。输出集合中的每个数的 $k$ 次方之和，对 $998244353$ 取模。即 $(\\sum_{z\\in S}z^k)\\bmod 998244353$。\n\n特别的，数据保证每个点只能被执行 $3$ 操作至多 $1$ 次。也就是说不会出现对一个蓝色点进行 $3$ 操作的情况。", "inputFormat": "第一行四个整数 $n,q,p,k$。  \n第二行 $n$ 个整数，代表初始的 $a_1,a_2,\\cdots,a_n$。  \n接下来 $n-1$ 行，每行两个整数 $f,t$。表示一条连接 $f \\leftrightarrow t$ 的双向树边。  \n接下来 $q$ 行，每行两个或三个整数 $op,x(,v)$。", "outputFormat": "对于每个询问操作，输出一行一个整数表示答案。", "hint": "### 样例解释\n\n#### 样例 \\#1\n\n- 询问 `4 1`，子树中点的权值分别为 $3,2,1,2,1,3,2,1,3,4$，$S$ 集合为 $\\{1,2,3,4\\}$，故答案为 $10$。\n- 修改 `1 3 1`，树中各点权值变为 $3,2,2,2,1,4,2,1,3,4$。\n- 修改 `2 1 2`，树中各点权值变为 $2,2,2,2,1,4,2,1,3,4$。\n- 询问 `4 1`，子树中点的权值分别为 $2,2,2,2,1,4,2,1,3,4$，$S$ 集合为 $\\{2,3\\}$，故答案为 $5$。\n- 询问 `4 3`，子树中点的编号为 $3,6$，权值分别为 $2,4$，$S$ 集合为 $\\{2,4\\}$，故答案为 $6$。\n- 询问 `4 6`，由于这是一个叶子节点，子树中点的权值为它本身的权值 $4$，$S$ 集合为 $\\{4\\}$，故答案为 $4$。\n- 修改 `1 4 1`，树中各点权值变为 $2,2,2,3,1,4,2,1,3,4$。\n- 修改 `3 7`，将 $7$ 涂成蓝色，删除树中的边 $2\\leftrightarrow 7$，并将 $7$ 作为儿子节点接到 $5$ 上。\n- 修改  `1 5 1`，树中各点权值变为 $2,2,2,3,2,4,3,2,4,5$。\n- 询问 `4 5`，子树中各点编号为 $5,7,8,9,10$，权值分别为 $2,3,2,4,5$，$S$ 集合为 $\\{3,4,5\\}$，故答案为 $12$。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le x\\le n\\le 10^5$，$1\\le q \\le 10^5$，$0 \\le a_i, v < p \\le 500$，$p\\ne 0$，$0\\le k \\le 10^9$。\n\n| subtask | 分值 | 特殊限制                                    |\n| ------- | ---- | ------------------------------------------- |\n| $1$     | $10$ | $op,a_i,x,v$ 和初始树的形态均等概率随机生成 |\n| $2$     | $90$ | 无                                          |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」RBT", "background": "", "description": "你有一棵以 $1$ 为根，编号为 $1\\sim n$ 的有根树，第 $i$ 号节点上有一个整数权值 $a_i$。同时每一个点都被染上了红色或蓝色。初始所有点全是红色点。你需要维护这棵树，进行 $q$ 次操作。操作分若干种，具体格式如下：\n\n- `1 x v` ：使 $x$ 节点的子树中的每个节点的权值增加 $v$ 并对 $p$ 取模。\n- `2 x v`：将 $a_x$ 赋值为 $v$。**注意不是赋值整棵子树。**\n- `3 x`：将 $x$ 号点染成蓝色，设 $j$ 节点为 $x$ 号节点在它的**红色**兄弟节点中**编号**（不是权值）排名的前驱，将 $x$ 节点连接父亲的边删除。然后将 $x$ 节点作为儿子节点接到 $j$ 节点上，如果 $x$ 节点没有红色兄弟节点或 $x$ 节点的红色兄弟节点的编号均比 $x$ 大则什么都不做。\n- `4 x`：设 $S$ 为 $x$ 的子树中的节点的权值中出现次数为奇数的数组成的集合。输出集合中的每个数的 $k$ 次方之和，对 $998244353$ 取模。即 $(\\sum_{z\\in S}z^k)\\bmod 998244353$。\n\n特别的，数据保证每个点只能被执行 $3$ 操作至多 $1$ 次。也就是说不会出现对一个蓝色点进行 $3$ 操作的情况。", "inputFormat": "第一行四个整数 $n,q,p,k$。  \n第二行 $n$ 个整数，代表初始的 $a_1,a_2,\\cdots,a_n$。  \n接下来 $n-1$ 行，每行两个整数 $f,t$。表示一条连接 $f \\leftrightarrow t$ 的双向树边。  \n接下来 $q$ 行，每行两个或三个整数 $op,x(,v)$。", "outputFormat": "对于每个询问操作，输出一行一个整数表示答案。", "hint": "### 样例解释\n\n#### 样例 \\#1\n\n- 询问 `4 1`，子树中点的权值分别为 $3,2,1,2,1,3,2,1,3,4$，$S$ 集合为 $\\{1,2,3,4\\}$，故答案为 $10$。\n- 修改 `1 3 1`，树中各点权值变为 $3,2,2,2,1,4,2,1,3,4$。\n- 修改 `2 1 2`，树中各点权值变为 $2,2,2,2,1,4,2,1,3,4$。\n- 询问 `4 1`，子树中点的权值分别为 $2,2,2,2,1,4,2,1,3,4$，$S$ 集合为 $\\{2,3\\}$，故答案为 $5$。\n- 询问 `4 3`，子树中点的编号为 $3,6$，权值分别为 $2,4$，$S$ 集合为 $\\{2,4\\}$，故答案为 $6$。\n- 询问 `4 6`，由于这是一个叶子节点，子树中点的权值为它本身的权值 $4$，$S$ 集合为 $\\{4\\}$，故答案为 $4$。\n- 修改 `1 4 1`，树中各点权值变为 $2,2,2,3,1,4,2,1,3,4$。\n- 修改 `3 7`，将 $7$ 涂成蓝色，删除树中的边 $2\\leftrightarrow 7$，并将 $7$ 作为儿子节点接到 $5$ 上。\n- 修改  `1 5 1`，树中各点权值变为 $2,2,2,3,2,4,3,2,4,5$。\n- 询问 `4 5`，子树中各点编号为 $5,7,8,9,10$，权值分别为 $2,3,2,4,5$，$S$ 集合为 $\\{3,4,5\\}$，故答案为 $12$。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le x\\le n\\le 10^5$，$1\\le q \\le 10^5$，$0 \\le a_i, v < p \\le 500$，$p\\ne 0$，$0\\le k \\le 10^9$。\n\n| subtask | 分值 | 特殊限制                                    |\n| ------- | ---- | ------------------------------------------- |\n| $1$     | $10$ | $op,a_i,x,v$ 和初始树的形态均等概率随机生成 |\n| $2$     | $90$ | 无                                          |", "locale": "zh-CN"}}}
{"pid": "P7827", "type": "P", "difficulty": 7, "samples": [["123456789\n2147483648", "2147483648\n123456789"], ["2147483647998244353\n9982443532147483647", "10611784189560312322"], ["51\n53\n51\n52\n52\n50\n56\n57\n57", "998244353"], ["233456", "1"], ["2147483647998244353\n9223372036854775808", "2147483647998244353"], ["2147483647998244353\n9982443532147483647\n9223372036854775808\n", "7806477557104029183"], ["4611686018427387904\n", "2147483648"], ["24 32", "8"], ["输入 a，b。输出 a 按位异或 b 的结果。", "mov 0\nxor 1"], ["没有输入，输出数字 6。", "not 1\nlsh 1 62\nrsh 1 61"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["提交答案", "Special Judge", "位运算"], "title": "「RdOI R3 附加」ACP-I", "background": "**注意：这不是一道模拟题，请先完整地读完一遍题面后再开始做题。**\n\n---\n\n### 排行榜\n\n| task | 最短行数 | 达成者      |\n| ---- | -------- | ----------- |\n| 1    | 5        | std         |\n| 2    | 191     | \\_\\_Ultimium\\_\\_      |\n| 3    | 845      | dead_X      |\n| 4    | 24       | 囧仙        |\n| 5    | 77       | dqstz  |\n| 6    | 15078    | 寻逍遥2006       |\n| 7    | 211      | liqingyang        |\n| 8    | 6796     | liqingyang |\n\n如有你的解法行数**严格小于**榜中行数，请联系 @[yzy1](/user/207996) 把你的成绩放到排行榜上。\n\n---\n\n题目 ACP 有两层意思：**A**ncient **C**omputer **P**rogram 和 **A**nother **C**onstruct **P**roblem。\n\n在 1951 年，第 -32 届全国青少年信息学奥林匹克冬令营前夕，小 A 借助时空传输接口（**T**ime **T**ransport **I**nterface）连接了一台 2015 年的计算机，获取到了第 32 届冬令营的题目来练习。\n\n他打开了第三题「未来程序」这道题目：\n\n> 本题是一道提交答案题，一共 10 个测试点。  \n> 对于每个测试点，你会得到一段程序的源代码和这段程序的输入。你要运行这个程序，并保存这个程序的输出。  \n> 遗憾的是这些程序都效率极其低下，无法在比赛的 5 个小时内得到输出。\n\n小 A 想了一下，决定用 1951 年的计算机来试着运行这个题目。但是因为 1951 年的电脑存储空间过小，导致他无法传输题目附件和数据，请你帮助小 A 写 std 造数据。\n", "description": "**这是一道提交答案题。**\n\n小 A 的古董计算机使用两个 $64$ 位无符号整数的栈 $S_0$ 和 $S_1$ 来存储数据。每个栈中初始存储着 $10^{10^{10}}$ 个 $0$。\n\n为了表述方便，下文中记「$T_x$」表示栈 $S_x$ 的栈顶元素。记符号 「$\\And$」「$\\mid$」「$\\oplus$」分别为按位与、按位或、按位异或运算。\n\n这台计算机支持 $8$ 种汇编指令，若没有特殊说明，以下指令的参数均为整数。\n\n| 名称                 | 参数                     | 说明                                                         | 伪代码                                                       |\n| -------------------- | ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| $\\textbf{and}\\ i$ | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位与的结果。         | $T_i \\gets T_i \\operatorname{\\And} T_{i \\oplus 1}$           |\n| $\\textbf{or}\\ i$  | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位或的结果。         | $T_i \\gets T_i \\mid T_{i \\oplus 1}$                          |\n| $\\textbf{xor}\\ i$    | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位异或的结果。       | $T_i \\gets T_i \\oplus T_{i \\oplus 1}$                        |\n| $\\textbf{lsh}\\ i\\ j$ | $i \\in [0,1],j\\in[0,64]$ | 令 $T_i$ 为 $T_i$ 左移 $j$ 位的结果，自然溢出。   | $T_i \\gets T_i \\times 2^j \\bmod 2^{64}$                      |\n| $\\textbf{rsh}\\ i\\ j$ | $i \\in [0,1],j\\in[0,64]$ | 令 $T_i$ 为 $T_i$ 右移 $j$ 位的结果，自然溢出。   | $T_i \\gets \\lfloor \\dfrac{T_i}{2^j} \\rfloor$                 |\n| $\\textbf{not}\\ i$    | $i\\in[0,1]$              | 令 $T_i$ 为 $T_i$ 按位取反的结果。                           | $T_i \\gets (2^{64}-1)-T_i$                            |\n| $\\textbf{pop}\\ i$    | $i\\in[0,1]$              | 将栈 $S_i$ 的栈顶元素出栈。                                  | $\\text{Remove top element of }S_i$                           |\n| $\\textbf{mov}\\ i$    | $i\\in[0,1]$              | 将 $T_i$ 出 $S_i$ 栈，然后将其入另一个栈。即移动 $T_i$ 至 $S_{i \\oplus 1}$。 | $\\text{Push}\\ T_i\\text{ to }S_{i\\oplus 1};\\ \\textbf{pop}\\ i$ |\n\n你需要使用这些汇编指令实现若干计算任务，每个测试点对应一个单独的计算任务。下文中「输入 $a_1, a_2, \\cdots$」表示将 $a_1,a_2,\\cdots$ 这几个整数**依次**压入 $S_0$ 栈，而两栈栈底的 $0$ 不做变动。**若无特殊说明，输入的数均为 $\\mathbf{[0,2^{64}-1]}$ 范围内的整数。**「输出 $x_1, x_2, \\cdots$」表示指令运行结束后会从 $S_1$ 中**依次**取出若干个整数作为 $x_1,x_2,\\cdots$ 来检验结果是否正确。除此之外，对于 $S_0$ 栈中所有的数和 $S_1$ 栈中**没有**被取出的数在指令运行结束后可以为任意值。\n\n1. 输入 $a, b$，输出 $b,a$。即将两数交换。\n1. 输入 $a,b$，输出 $(a-b+2^{64}) \\bmod 2^{64}$。即求两数之差，自然溢出。\n1. 输入 $a_1, a_2,\\cdots,a_9;a_i\\in[48,57]$，即 $a_i\\in[\\mathtt{'0'}, \\mathtt{'9'}]$。将 $a_1\\sim a_9$ 视为一个 ASCII 编码下的长度为 $9$ 的字符串，你需要将这个字符串**前后翻转后**转化为一个对应的十进制整数并输出。即实现一个快读。特别的，字符串中可能会有前导零。\n1. 输入 $a$，输出 $(\\operatorname{popcnt}a) \\bmod 2$。其中 $\\operatorname{popcnt} x$ 代表 $x$ 的二进制表示法中 $1$ 的个数。\n1. 输入 $a,b$，输出 $\\min\\{a,b\\}$。\n1. 输入 $a,b,p$，满足 $p$ 为 $2$ 的非负整数次幂或零。输出 $(a\\times b) \\bmod p$。特别地，当 $p=0$ 时输出 $0$。\n1. 输入 $a$，满足 $a$ 和答案都是 $2$ 的非负整数次幂或零，输出 $\\sqrt a$。\n1. 输入 $a,b;1\\le a,b \\le 63$，输出 $\\gcd(a,b)$，即 $a,b$ 的最大公因数。", "inputFormat": "由于出题人不想把这道题出成一道大模拟，所以附件中提供了汇编模拟部分。\n\n在下发文件下有 `checker.cpp` 和 `1.ans ~ 8.ans`。其中 `checker.cpp` 给出了几种汇编指令的简单实现。你可以使用 `checker.cpp` 测试你的程序。使用 `g++ checker.cpp -o checker -std=c++11` 将 `checker.cpp` 编译为可执行文件后运行 `checker *.in *.out *.ans`，`checker` 就会给出你的输出结果和该测试点的得分。其中 `*.in` 中为提供给指令的输入数据，每行一个，以 EOF 结束；`*.out` 中存放你的指令；`*.ans` 指下发文件中的 `.ans` 文件。\n\n**注意：此 checker 仅作示例使用，不具备验证正确性功能。**", "outputFormat": "请将每个任务对应的指令写入 `1.out ~ 8.out`，并打包成 zip 后提交。", "hint": "### 样例说明\n\n上述「样例组 $1\\sim 8$」代表 $1\\sim8$ 子任务的样例输入输出。「样例组 $9\\sim10$」为示例问题的一种最短的程序实现。\n\n---\n\n### 评分方法\n\n下面用 `*` 代表测试点编号。如果你提交的指令（`*.out`）没有正确完成计算得零分，否则设你使用的指令个数为 $cnt$，若 `*.ans` 中有 $x$ 个 $\\ge cnt$ 的数，你该测试点得 $x$ 分。\n\n---\n\n### 注意\n\n虽然我们允许你提交最多 $999999$ 行的指令，但是由于洛谷对于 checker 的运行时间有限制，你的指令长度被强行加上了一个奇怪的上限：约是 $2\\times 10^5$，超过这个长度的指令可能会因为 checker 超时而导致 UKE。\n\n由于洛谷提交答案题的特性，如果你不会做一些 task，请在压缩包内放一个空的 `*.out` 文件占位，其中 `*` 代表 task 编号。否则你的整道题可能会出现答案错位（比如 `2.out` 交到了 $1$ 号测试点）的情况，导致后面的测试点变成零分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3 附加」ACP-I", "background": "**注意：这不是一道模拟题，请先完整地读完一遍题面后再开始做题。**\n\n---\n\n### 排行榜\n\n| task | 最短行数 | 达成者      |\n| ---- | -------- | ----------- |\n| 1    | 5        | std         |\n| 2    | 191     | \\_\\_Ultimium\\_\\_      |\n| 3    | 845      | dead_X      |\n| 4    | 24       | 囧仙        |\n| 5    | 77       | dqstz  |\n| 6    | 15078    | 寻逍遥2006       |\n| 7    | 211      | liqingyang        |\n| 8    | 6796     | liqingyang |\n\n如有你的解法行数**严格小于**榜中行数，请联系 @[yzy1](/user/207996) 把你的成绩放到排行榜上。\n\n---\n\n题目 ACP 有两层意思：**A**ncient **C**omputer **P**rogram 和 **A**nother **C**onstruct **P**roblem。\n\n在 1951 年，第 -32 届全国青少年信息学奥林匹克冬令营前夕，小 A 借助时空传输接口（**T**ime **T**ransport **I**nterface）连接了一台 2015 年的计算机，获取到了第 32 届冬令营的题目来练习。\n\n他打开了第三题「未来程序」这道题目：\n\n> 本题是一道提交答案题，一共 10 个测试点。  \n> 对于每个测试点，你会得到一段程序的源代码和这段程序的输入。你要运行这个程序，并保存这个程序的输出。  \n> 遗憾的是这些程序都效率极其低下，无法在比赛的 5 个小时内得到输出。\n\n小 A 想了一下，决定用 1951 年的计算机来试着运行这个题目。但是因为 1951 年的电脑存储空间过小，导致他无法传输题目附件和数据，请你帮助小 A 写 std 造数据。\n", "description": "**这是一道提交答案题。**\n\n小 A 的古董计算机使用两个 $64$ 位无符号整数的栈 $S_0$ 和 $S_1$ 来存储数据。每个栈中初始存储着 $10^{10^{10}}$ 个 $0$。\n\n为了表述方便，下文中记「$T_x$」表示栈 $S_x$ 的栈顶元素。记符号 「$\\And$」「$\\mid$」「$\\oplus$」分别为按位与、按位或、按位异或运算。\n\n这台计算机支持 $8$ 种汇编指令，若没有特殊说明，以下指令的参数均为整数。\n\n| 名称                 | 参数                     | 说明                                                         | 伪代码                                                       |\n| -------------------- | ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| $\\textbf{and}\\ i$ | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位与的结果。         | $T_i \\gets T_i \\operatorname{\\And} T_{i \\oplus 1}$           |\n| $\\textbf{or}\\ i$  | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位或的结果。         | $T_i \\gets T_i \\mid T_{i \\oplus 1}$                          |\n| $\\textbf{xor}\\ i$    | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位异或的结果。       | $T_i \\gets T_i \\oplus T_{i \\oplus 1}$                        |\n| $\\textbf{lsh}\\ i\\ j$ | $i \\in [0,1],j\\in[0,64]$ | 令 $T_i$ 为 $T_i$ 左移 $j$ 位的结果，自然溢出。   | $T_i \\gets T_i \\times 2^j \\bmod 2^{64}$                      |\n| $\\textbf{rsh}\\ i\\ j$ | $i \\in [0,1],j\\in[0,64]$ | 令 $T_i$ 为 $T_i$ 右移 $j$ 位的结果，自然溢出。   | $T_i \\gets \\lfloor \\dfrac{T_i}{2^j} \\rfloor$                 |\n| $\\textbf{not}\\ i$    | $i\\in[0,1]$              | 令 $T_i$ 为 $T_i$ 按位取反的结果。                           | $T_i \\gets (2^{64}-1)-T_i$                            |\n| $\\textbf{pop}\\ i$    | $i\\in[0,1]$              | 将栈 $S_i$ 的栈顶元素出栈。                                  | $\\text{Remove top element of }S_i$                           |\n| $\\textbf{mov}\\ i$    | $i\\in[0,1]$              | 将 $T_i$ 出 $S_i$ 栈，然后将其入另一个栈。即移动 $T_i$ 至 $S_{i \\oplus 1}$。 | $\\text{Push}\\ T_i\\text{ to }S_{i\\oplus 1};\\ \\textbf{pop}\\ i$ |\n\n你需要使用这些汇编指令实现若干计算任务，每个测试点对应一个单独的计算任务。下文中「输入 $a_1, a_2, \\cdots$」表示将 $a_1,a_2,\\cdots$ 这几个整数**依次**压入 $S_0$ 栈，而两栈栈底的 $0$ 不做变动。**若无特殊说明，输入的数均为 $\\mathbf{[0,2^{64}-1]}$ 范围内的整数。**「输出 $x_1, x_2, \\cdots$」表示指令运行结束后会从 $S_1$ 中**依次**取出若干个整数作为 $x_1,x_2,\\cdots$ 来检验结果是否正确。除此之外，对于 $S_0$ 栈中所有的数和 $S_1$ 栈中**没有**被取出的数在指令运行结束后可以为任意值。\n\n1. 输入 $a, b$，输出 $b,a$。即将两数交换。\n1. 输入 $a,b$，输出 $(a-b+2^{64}) \\bmod 2^{64}$。即求两数之差，自然溢出。\n1. 输入 $a_1, a_2,\\cdots,a_9;a_i\\in[48,57]$，即 $a_i\\in[\\mathtt{'0'}, \\mathtt{'9'}]$。将 $a_1\\sim a_9$ 视为一个 ASCII 编码下的长度为 $9$ 的字符串，你需要将这个字符串**前后翻转后**转化为一个对应的十进制整数并输出。即实现一个快读。特别的，字符串中可能会有前导零。\n1. 输入 $a$，输出 $(\\operatorname{popcnt}a) \\bmod 2$。其中 $\\operatorname{popcnt} x$ 代表 $x$ 的二进制表示法中 $1$ 的个数。\n1. 输入 $a,b$，输出 $\\min\\{a,b\\}$。\n1. 输入 $a,b,p$，满足 $p$ 为 $2$ 的非负整数次幂或零。输出 $(a\\times b) \\bmod p$。特别地，当 $p=0$ 时输出 $0$。\n1. 输入 $a$，满足 $a$ 和答案都是 $2$ 的非负整数次幂或零，输出 $\\sqrt a$。\n1. 输入 $a,b;1\\le a,b \\le 63$，输出 $\\gcd(a,b)$，即 $a,b$ 的最大公因数。", "inputFormat": "由于出题人不想把这道题出成一道大模拟，所以附件中提供了汇编模拟部分。\n\n在下发文件下有 `checker.cpp` 和 `1.ans ~ 8.ans`。其中 `checker.cpp` 给出了几种汇编指令的简单实现。你可以使用 `checker.cpp` 测试你的程序。使用 `g++ checker.cpp -o checker -std=c++11` 将 `checker.cpp` 编译为可执行文件后运行 `checker *.in *.out *.ans`，`checker` 就会给出你的输出结果和该测试点的得分。其中 `*.in` 中为提供给指令的输入数据，每行一个，以 EOF 结束；`*.out` 中存放你的指令；`*.ans` 指下发文件中的 `.ans` 文件。\n\n**注意：此 checker 仅作示例使用，不具备验证正确性功能。**", "outputFormat": "请将每个任务对应的指令写入 `1.out ~ 8.out`，并打包成 zip 后提交。", "hint": "### 样例说明\n\n上述「样例组 $1\\sim 8$」代表 $1\\sim8$ 子任务的样例输入输出。「样例组 $9\\sim10$」为示例问题的一种最短的程序实现。\n\n---\n\n### 评分方法\n\n下面用 `*` 代表测试点编号。如果你提交的指令（`*.out`）没有正确完成计算得零分，否则设你使用的指令个数为 $cnt$，若 `*.ans` 中有 $x$ 个 $\\ge cnt$ 的数，你该测试点得 $x$ 分。\n\n---\n\n### 注意\n\n虽然我们允许你提交最多 $999999$ 行的指令，但是由于洛谷对于 checker 的运行时间有限制，你的指令长度被强行加上了一个奇怪的上限：约是 $2\\times 10^5$，超过这个长度的指令可能会因为 checker 超时而导致 UKE。\n\n由于洛谷提交答案题的特性，如果你不会做一些 task，请在压缩包内放一个空的 `*.out` 文件占位，其中 `*` 代表 task 编号。否则你的整道题可能会出现答案错位（比如 `2.out` 交到了 $1$ 号测试点）的情况，导致后面的测试点变成零分。", "locale": "zh-CN"}}}
{"pid": "P7828", "type": "P", "difficulty": 6, "samples": [["5 4 3\n1 4 2 1 2\n3\n2\n1", "4\n2\n2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树状数组", "2021", "CCO（加拿大）", "根号分治"], "title": "[CCO 2021] Swap Swap Sort", "background": "", "description": "你有一个长度为 $n$ 的序列，每项都是不超过 $k$ 的正整数。\n\n你的朋友发明了一个排序算法，可以根据一个 $1 \\sim k$ 的排列对序列进行排序，排序后序列中任意两个不相等的数的相对位置与排列中的相对位置相同。他的算法只使用了邻项交换的操作，且总是保证操作次数最少。为了方便描述，他将这个 $1 \\sim k$ 的排列称为目标排列。\n\n例如，序列为 $[1, 4, 2, 1, 2]$，目标排列为 $[4, 1, 2, 3]$，排序后为 $[4, 1, 1, 2, 2]$。\n\n你对你朋友的排序算法在目标排列不同时执行 swap 的次数很感兴趣。为了研究其中的规律，你一开始将目标排列设置为 $1 \\sim k$，并以此进行 $q$ 次操作，每次操作交换目标排列中相邻的两个数的位置。每次交换后，你想知道如果用他的排序算法对原序列进行排序会执行 swap 的次数。", "inputFormat": "第一行，三个整数 $n, k, q$。\n\n第二行，$n$ 个正整数 $a_1, a_2, \\cdots, a_n$，表示原序列。\n\n接下来 $q$ 行，每行一个正整数 $b$，表示交换目标排列中的第 $b$ 和第 $b + 1$ 个数。", "outputFormat": "对于每次询问，输出一个整数，表示所求的值。", "hint": "#### 数据范围\n**由于官方数据包过大，本题只节选了官方数据的 $\\frac{20}{27}$。**\n\n对于 $\\frac{4}{27}$ 的数据，$1 \\leq n, q \\leq 5 \\times 10^3$；\n\n对于另外 $\\frac{4}{27}$ 的数据，$1 \\leq q \\leq 100$；\n\n对于另外 $\\frac{7}{54}$ 的数据，$1 \\leq k \\leq 500$；\n\n对于 $100\\%$ 的数据，$1 \\leq n, k \\leq 10^5$，$1 \\leq q \\leq 10^6$，$1 \\leq a_i \\leq k$，$1 \\leq b < k$。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T1", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Swap Swap Sort", "background": "", "description": "你有一个长度为 $n$ 的序列，每项都是不超过 $k$ 的正整数。\n\n你的朋友发明了一个排序算法，可以根据一个 $1 \\sim k$ 的排列对序列进行排序，排序后序列中任意两个不相等的数的相对位置与排列中的相对位置相同。他的算法只使用了邻项交换的操作，且总是保证操作次数最少。为了方便描述，他将这个 $1 \\sim k$ 的排列称为目标排列。\n\n例如，序列为 $[1, 4, 2, 1, 2]$，目标排列为 $[4, 1, 2, 3]$，排序后为 $[4, 1, 1, 2, 2]$。\n\n你对你朋友的排序算法在目标排列不同时执行 swap 的次数很感兴趣。为了研究其中的规律，你一开始将目标排列设置为 $1 \\sim k$，并以此进行 $q$ 次操作，每次操作交换目标排列中相邻的两个数的位置。每次交换后，你想知道如果用他的排序算法对原序列进行排序会执行 swap 的次数。", "inputFormat": "第一行，三个整数 $n, k, q$。\n\n第二行，$n$ 个正整数 $a_1, a_2, \\cdots, a_n$，表示原序列。\n\n接下来 $q$ 行，每行一个正整数 $b$，表示交换目标排列中的第 $b$ 和第 $b + 1$ 个数。", "outputFormat": "对于每次询问，输出一个整数，表示所求的值。", "hint": "#### 数据范围\n**由于官方数据包过大，本题只节选了官方数据的 $\\frac{20}{27}$。**\n\n对于 $\\frac{4}{27}$ 的数据，$1 \\leq n, q \\leq 5 \\times 10^3$；\n\n对于另外 $\\frac{4}{27}$ 的数据，$1 \\leq q \\leq 100$；\n\n对于另外 $\\frac{7}{54}$ 的数据，$1 \\leq k \\leq 500$；\n\n对于 $100\\%$ 的数据，$1 \\leq n, k \\leq 10^5$，$1 \\leq q \\leq 10^6$，$1 \\leq a_i \\leq k$，$1 \\leq b < k$。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T1", "locale": "zh-CN"}}}
{"pid": "P7829", "type": "P", "difficulty": 6, "samples": [["3 3 3 1\n-1 0 1\n15\n8\n-5", "1 -1 -1 0\n1 0 -1\n-1 1 1"], ["10 1 3 2\n0 2 -2\n17", "IMPOSSIBLE"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "Special Judge", "CCO（加拿大）", "记忆化搜索", "数位 DP", "进制"], "title": "[CCO 2021] Weird Numeral System", "background": "", "description": "Alice 正在思考一个关于 $k$ 进制整数的问题。\n\n普通的 $k$ 进制可以将整数 $n$ 表示为 $d_{m - 1} d_{m - 2} \\cdots d_0$，且满足：\n\n1. $0 \\leq d_i < k$；\n2. $n = \\displaystyle\\sum_{i = 0}^{m - 1} d_i k^i$。\n\n然而，普通的 $k$ 进制整数对于 Alice 来说太简单了，Alice 更喜欢奇怪的 $k$ 进制整数。它与普通 $k$ 进制整数的差别仅仅在于将 $0 \\leq d_i < k$ 换成了 $d_i \\in a$，其中 $a$ 为一个长为 $D$ 的数列。\n\n现在有一组固定的 $a_1, a_2, \\cdots, a_D$，Alice 想要将 $q$ 个十进制整数 $n_1, n_2, \\cdots, n_q$ 全部转化为奇怪的 $k$ 进制整数，这种问题显然更适合写程序来解决。", "inputFormat": "第一行，四个整数 $k, q, D, M$；\n\n第二行，$D$ 个整数 $a_1, a_2, \\cdots, a_D$；\n\n接下来 $q$ 行，每行一个整数 $n_i$。", "outputFormat": "$q$ 行，第 $i$ 行表示 $n_i$ 转化后的结果，按幂次从高到低的顺序输出每一位，两个位之间用单个空格间隔。当 $a_i$ 中包含 $0$ 时，你转化的结果可以包含前导零，但最好不要太多；当 $n_i = 0$ 时，你转化的结果也不能为空。如果有多种方案可以随便输出一种，如果无法转化输出 `IMPOSSIBLE`。", "hint": "**本题由 @[Leasier](https://www.luogu.com.cn/user/201007) 提供 SPJ。**\n#### 数据范围\n对于 $100\\%$ 的数据，$2 \\leq k \\leq 10^6$，$1 \\leq q \\leq 5$，$1 \\leq D \\leq 801$，$1 \\leq M \\leq 400$，$-M \\leq a_i \\leq M$，$-10^{18} \\leq n_i \\leq 10^{18}$。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T2", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Weird Numeral System", "background": "", "description": "Alice 正在思考一个关于 $k$ 进制整数的问题。\n\n普通的 $k$ 进制可以将整数 $n$ 表示为 $d_{m - 1} d_{m - 2} \\cdots d_0$，且满足：\n\n1. $0 \\leq d_i < k$；\n2. $n = \\displaystyle\\sum_{i = 0}^{m - 1} d_i k^i$。\n\n然而，普通的 $k$ 进制整数对于 Alice 来说太简单了，Alice 更喜欢奇怪的 $k$ 进制整数。它与普通 $k$ 进制整数的差别仅仅在于将 $0 \\leq d_i < k$ 换成了 $d_i \\in a$，其中 $a$ 为一个长为 $D$ 的数列。\n\n现在有一组固定的 $a_1, a_2, \\cdots, a_D$，Alice 想要将 $q$ 个十进制整数 $n_1, n_2, \\cdots, n_q$ 全部转化为奇怪的 $k$ 进制整数，这种问题显然更适合写程序来解决。", "inputFormat": "第一行，四个整数 $k, q, D, M$；\n\n第二行，$D$ 个整数 $a_1, a_2, \\cdots, a_D$；\n\n接下来 $q$ 行，每行一个整数 $n_i$。", "outputFormat": "$q$ 行，第 $i$ 行表示 $n_i$ 转化后的结果，按幂次从高到低的顺序输出每一位，两个位之间用单个空格间隔。当 $a_i$ 中包含 $0$ 时，你转化的结果可以包含前导零，但最好不要太多；当 $n_i = 0$ 时，你转化的结果也不能为空。如果有多种方案可以随便输出一种，如果无法转化输出 `IMPOSSIBLE`。", "hint": "**本题由 @[Leasier](https://www.luogu.com.cn/user/201007) 提供 SPJ。**\n#### 数据范围\n对于 $100\\%$ 的数据，$2 \\leq k \\leq 10^6$，$1 \\leq q \\leq 5$，$1 \\leq D \\leq 801$，$1 \\leq M \\leq 400$，$-M \\leq a_i \\leq M$，$-10^{18} \\leq n_i \\leq 10^{18}$。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T2", "locale": "zh-CN"}}}
{"pid": "P7830", "type": "P", "difficulty": 6, "samples": [["5 6\n1 2\n3 3 1 4\n1 2\n2 5 2\n1 4\n1\n2\n3\n4\n5\n6", "2\n1\n2\n4\n2\n3"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "CCO（加拿大）", "深度优先搜索 DFS", "可持久化线段树"], "title": "[CCO 2021] Through Another Maze Darkly", "background": "**警告：滥用本题评测将被封号！**", "description": "黑暗迷宫是一个树形结构，有 $n$ 个房间和 $n - 1$ 个走廊，房间编号 $1, 2, \\cdots, n$。\n\n黑暗迷宫里面漆黑一片，你看不见自己在哪里。为了辨别方向，每个房间有一个激光指示器，初始指向连接这个房间的某一个走廊。你重复执行如下策略行动：\n\n- 将当前房间的激光指示器按顺时针方向旋转到下一个走廊\n- 沿着激光指示器指向的走廊走到另一个房间\n\n你打算从编号为 $1$ 的房间开始，将这个策略重复执行 $k$ 次，想知道自己会到达哪个房间。你觉得这个问题太简单了，于是进行了 $q$ 次询问。每次询问是相互独立的，即激光指示器每次都会回到初始状态。", "inputFormat": "第一行，两个整数 $n, q$；\n\n接下来 $n$ 行，第 $i$ 行描述第 $i$ 个房间。首先，一个整数 $k$ 表示房间 $i$ 连接的走廊数量，接下来 $k$ 个整数 $c_1, c_2, \\cdots, c_k$，表示按顺时针顺序每个走廊另一头的房间编号。第 $i$ 个房间的激光指示器初始指向通往房间 $c_1$ 的走廊。\n\n接下来 $q$ 行，每行一个正整数 $k$。", "outputFormat": "对于每组询问，输出一行，表示所求的值。", "hint": "#### 样例 #1 解释\n初始激光指示器的指向如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2k48xyl0.png)\n#### 数据范围\n对于 $\\frac{7}{45}$ 的数据，第 $i$ 个房间连接第 $i - 1$ 和第 $i + 1$ 个房间（如果这两个房间存在）；\n\n对于另 $\\frac{14}{45}$ 的数据，$2 \\leq n \\leq 2 \\times 10^3$，$1 \\leq q \\leq 2 \\times 10^3$；\n\n对于另 $\\frac{4}{15}$ 的数据，$q = 1$；\n\n对于 $100\\%$ 的数据，$2 \\leq n \\leq 8 \\times 10^5$，$1 \\leq q \\leq 8 \\times 10^5$，$1 \\leq k \\leq 10^{15}$，保证数据给出的是**一棵树**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T3", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Through Another Maze Darkly", "background": "**警告：滥用本题评测将被封号！**", "description": "黑暗迷宫是一个树形结构，有 $n$ 个房间和 $n - 1$ 个走廊，房间编号 $1, 2, \\cdots, n$。\n\n黑暗迷宫里面漆黑一片，你看不见自己在哪里。为了辨别方向，每个房间有一个激光指示器，初始指向连接这个房间的某一个走廊。你重复执行如下策略行动：\n\n- 将当前房间的激光指示器按顺时针方向旋转到下一个走廊\n- 沿着激光指示器指向的走廊走到另一个房间\n\n你打算从编号为 $1$ 的房间开始，将这个策略重复执行 $k$ 次，想知道自己会到达哪个房间。你觉得这个问题太简单了，于是进行了 $q$ 次询问。每次询问是相互独立的，即激光指示器每次都会回到初始状态。", "inputFormat": "第一行，两个整数 $n, q$；\n\n接下来 $n$ 行，第 $i$ 行描述第 $i$ 个房间。首先，一个整数 $k$ 表示房间 $i$ 连接的走廊数量，接下来 $k$ 个整数 $c_1, c_2, \\cdots, c_k$，表示按顺时针顺序每个走廊另一头的房间编号。第 $i$ 个房间的激光指示器初始指向通往房间 $c_1$ 的走廊。\n\n接下来 $q$ 行，每行一个正整数 $k$。", "outputFormat": "对于每组询问，输出一行，表示所求的值。", "hint": "#### 样例 #1 解释\n初始激光指示器的指向如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2k48xyl0.png)\n#### 数据范围\n对于 $\\frac{7}{45}$ 的数据，第 $i$ 个房间连接第 $i - 1$ 和第 $i + 1$ 个房间（如果这两个房间存在）；\n\n对于另 $\\frac{14}{45}$ 的数据，$2 \\leq n \\leq 2 \\times 10^3$，$1 \\leq q \\leq 2 \\times 10^3$；\n\n对于另 $\\frac{4}{15}$ 的数据，$q = 1$；\n\n对于 $100\\%$ 的数据，$2 \\leq n \\leq 8 \\times 10^5$，$1 \\leq q \\leq 8 \\times 10^5$，$1 \\leq k \\leq 10^{15}$，保证数据给出的是**一棵树**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T3", "locale": "zh-CN"}}}
{"pid": "P7831", "type": "P", "difficulty": 6, "samples": [["5 5\n3 1 4 0\n2 1 3 0\n1 3 1 1\n3 2 3 1\n4 2 0 2", "2 3 3 1 -1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "图论", "贪心", "2021", "CCO（加拿大）", "拓扑排序"], "title": "[CCO 2021] Travelling Merchant", "background": "", "description": "一个国家有 $n$ 个城市和 $m$ 条单向道路，一个旅行商在这些城市之间旅行。\n\n第 $i$ 条道路从城市 $a_i$ 到城市 $b_i$，只有当他的资产不少于 $r_i$ 元才可以走这条道路，走过这条道路之后他的资产会增加 $p_i$ 元。\n\n他希望自己可以永远不停的游走下去，于是他想知道从任意一个城市出发至少需要多少元初始资产。", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $m$ 行，第 $i$ 行有四个整数 $a_i, b_i, r_i, p_i$。", "outputFormat": "一行，$n$ 个整数，若第 $i$ 个城市无解，第 $i$ 个整数为 $-1$；否则，为至少需要的初始资产（单位为元）。", "hint": "#### 样例 #1 解释\n以第 $2$ 座城市为例：从第 $2$ 座城市出发，初始资产 $3$ 元，则可以在第 $2, 1, 3$ 三座城市无限绕圈。\n#### 数据范围\n对于 $\\frac{2}{7}$ 的数据，$2 \\leq n, m \\leq 2 \\times 10^3$；\n\n对于另 $\\frac{15}{49}$ 的数据，$p_i = 0$；\n\n对于 $100\\%$ 的数据，$2 \\leq n, m \\leq 2 \\times 10^5$，$1 \\leq a_i, b_i \\leq n$，$a_i \\neq b_i$，$0 \\leq r_i, p_i \\leq 10^9$，**保证没有自环但可能有重边**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T1", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Travelling Merchant", "background": "", "description": "一个国家有 $n$ 个城市和 $m$ 条单向道路，一个旅行商在这些城市之间旅行。\n\n第 $i$ 条道路从城市 $a_i$ 到城市 $b_i$，只有当他的资产不少于 $r_i$ 元才可以走这条道路，走过这条道路之后他的资产会增加 $p_i$ 元。\n\n他希望自己可以永远不停的游走下去，于是他想知道从任意一个城市出发至少需要多少元初始资产。", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $m$ 行，第 $i$ 行有四个整数 $a_i, b_i, r_i, p_i$。", "outputFormat": "一行，$n$ 个整数，若第 $i$ 个城市无解，第 $i$ 个整数为 $-1$；否则，为至少需要的初始资产（单位为元）。", "hint": "#### 样例 #1 解释\n以第 $2$ 座城市为例：从第 $2$ 座城市出发，初始资产 $3$ 元，则可以在第 $2, 1, 3$ 三座城市无限绕圈。\n#### 数据范围\n对于 $\\frac{2}{7}$ 的数据，$2 \\leq n, m \\leq 2 \\times 10^3$；\n\n对于另 $\\frac{15}{49}$ 的数据，$p_i = 0$；\n\n对于 $100\\%$ 的数据，$2 \\leq n, m \\leq 2 \\times 10^5$，$1 \\leq a_i, b_i \\leq n$，$a_i \\neq b_i$，$0 \\leq r_i, p_i \\leq 10^9$，**保证没有自环但可能有重边**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T1", "locale": "zh-CN"}}}
{"pid": "P7832", "type": "P", "difficulty": 6, "samples": [["2 0", "1"], ["6 3\n1 3\n2 6\n4 5", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "线段树", "2021", "CCO（加拿大）", "广度优先搜索 BFS"], "title": "[CCO 2021] Bread First Search", "background": "", "description": "这个国家有 $n$ 个城市和 $m$ 条双向道路。\n\n有一个人要游览这个国家，但他很讲究。他要求游览线路必须是一个 BFS（Bread First Search，面包优先搜索）序，必须访问每个城市各一次，且满足以下条件：\n\n- 首个城市可以任选；\n- 除了首个城市外，每个城市被访问前至少有一个相邻城市已经被访问过；\n- 每个城市与首个城市的距离单调不降。其中两个城市的距离定义为它们路径边数的最小值。\n\n这个人还有强迫症，一定要按照编号 $1 \\sim n$ 的顺序将每个城市访问一次。为了使这条游览线路符合上述所有要求，政府需要新修若干条道路。请问最少需要新修多少条道路？", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $m$ 行，每行两个整数 $a, b$，表示这个国家的一条双向道路。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "#### 样例 #2 解释\n一种符合要求的方式是，在城市 $1, 2$ 之间修一条路，在城市 $1, 4$ 之间修一条路。此时城市 $1$ 与城市 $1 \\sim 6$ 的距离分别是 $0, 1, 1, 1, 2, 2$。\n#### 数据范围\n对于 $\\frac{11}{32}$ 的数据，$1 \\leq n \\leq 200$；\n\n对于 $\\frac{5}{8}$ 的数据，$1 \\leq n \\leq 5 \\times 10^3$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 2 \\times 10^5$，$0 \\leq m \\leq \\min(2 \\times 10^5, \\frac{n(n - 1)}{2})$，$1 \\leq a, b \\leq n$，**保证没有重边和自环**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T2", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Bread First Search", "background": "", "description": "这个国家有 $n$ 个城市和 $m$ 条双向道路。\n\n有一个人要游览这个国家，但他很讲究。他要求游览线路必须是一个 BFS（Bread First Search，面包优先搜索）序，必须访问每个城市各一次，且满足以下条件：\n\n- 首个城市可以任选；\n- 除了首个城市外，每个城市被访问前至少有一个相邻城市已经被访问过；\n- 每个城市与首个城市的距离单调不降。其中两个城市的距离定义为它们路径边数的最小值。\n\n这个人还有强迫症，一定要按照编号 $1 \\sim n$ 的顺序将每个城市访问一次。为了使这条游览线路符合上述所有要求，政府需要新修若干条道路。请问最少需要新修多少条道路？", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $m$ 行，每行两个整数 $a, b$，表示这个国家的一条双向道路。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "#### 样例 #2 解释\n一种符合要求的方式是，在城市 $1, 2$ 之间修一条路，在城市 $1, 4$ 之间修一条路。此时城市 $1$ 与城市 $1 \\sim 6$ 的距离分别是 $0, 1, 1, 1, 2, 2$。\n#### 数据范围\n对于 $\\frac{11}{32}$ 的数据，$1 \\leq n \\leq 200$；\n\n对于 $\\frac{5}{8}$ 的数据，$1 \\leq n \\leq 5 \\times 10^3$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 2 \\times 10^5$，$0 \\leq m \\leq \\min(2 \\times 10^5, \\frac{n(n - 1)}{2})$，$1 \\leq a, b \\leq n$，**保证没有重边和自环**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T2", "locale": "zh-CN"}}}
{"pid": "P7833", "type": "P", "difficulty": 7, "samples": [["3 100\n10 50\n30 20\n60 40", "0"], ["4 100\n30 70\n10 12\n60 75\n90 50", "1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["树状数组", "2021", "离散化", "CCO（加拿大）"], "title": "[CCO 2021] Loop Town", "background": "", "description": "循环镇有 $n$ 个公民、$n$ 座房子、$n$ 个办公室。每个公民住在一座房子中，并在一个办公室工作。没有两个公民住在同一座房子，也没有两个公民在同一个办公室工作。\n\n循环镇是一个环形城市，绕城一圈路程为 $l$。循环镇的 $2n$ 栋建筑（房子和办公室）都在环上的整点上，其位置可以用 $[0, l - 1]$ 范围内的整数来描述，且这 $2n$ 栋建筑位置是互不相同的。\n\n每天早上，每个公民同时从自己的房子出发，沿着环路走到自己的办公室。公民到达办公室之后不会立刻进去工作，而是要等到所有公民都到达办公室之后才会同时进入办公室开始工作。\n\n一场疫情的到来打破了常规，领导人要求每个公民保持社交距离。围绕城市的环状道路很窄，两个公民的线路存在相互交叉时会很不方便（必须一个人暂时离开道路才能使另一个人通过），而三个人或以上禁止同时走到同一个地方。\n\n领导人可以给每个公民规定上班路线，即走城市环路的哪一边。领导人的目标是任意两个公民线路交叉的总次数最小，求这个最小值。", "inputFormat": "第一行，两个整数 $n, l$；\n\n接下来 $n$ 行，每行两个整数 $a_i, b_i$，表示第 $i$ 个公民的房子和办公室的位置。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "#### 数据范围\n对于 $\\frac{4}{13}$ 的数据，$1 \\leq n \\leq 5 \\times 10^3$；\n\n对于 $\\frac{8}{13}$ 的数据，$1 \\leq n \\leq 10^5$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$，$1 \\leq l \\leq 10^9$，$0 \\leq a_i, b_i < l$，**保证 $a_i, b_i$ 互不相同**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T3", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Loop Town", "background": "", "description": "循环镇有 $n$ 个公民、$n$ 座房子、$n$ 个办公室。每个公民住在一座房子中，并在一个办公室工作。没有两个公民住在同一座房子，也没有两个公民在同一个办公室工作。\n\n循环镇是一个环形城市，绕城一圈路程为 $l$。循环镇的 $2n$ 栋建筑（房子和办公室）都在环上的整点上，其位置可以用 $[0, l - 1]$ 范围内的整数来描述，且这 $2n$ 栋建筑位置是互不相同的。\n\n每天早上，每个公民同时从自己的房子出发，沿着环路走到自己的办公室。公民到达办公室之后不会立刻进去工作，而是要等到所有公民都到达办公室之后才会同时进入办公室开始工作。\n\n一场疫情的到来打破了常规，领导人要求每个公民保持社交距离。围绕城市的环状道路很窄，两个公民的线路存在相互交叉时会很不方便（必须一个人暂时离开道路才能使另一个人通过），而三个人或以上禁止同时走到同一个地方。\n\n领导人可以给每个公民规定上班路线，即走城市环路的哪一边。领导人的目标是任意两个公民线路交叉的总次数最小，求这个最小值。", "inputFormat": "第一行，两个整数 $n, l$；\n\n接下来 $n$ 行，每行两个整数 $a_i, b_i$，表示第 $i$ 个公民的房子和办公室的位置。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "#### 数据范围\n对于 $\\frac{4}{13}$ 的数据，$1 \\leq n \\leq 5 \\times 10^3$；\n\n对于 $\\frac{8}{13}$ 的数据，$1 \\leq n \\leq 10^5$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$，$1 \\leq l \\leq 10^9$，$0 \\leq a_i, b_i < l$，**保证 $a_i, b_i$ 互不相同**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T3", "locale": "zh-CN"}}}
{"pid": "P7834", "type": "P", "difficulty": 6, "samples": [["10 11 3\n1 2 3 4 5 6 7 8 9 10\n1 4 4\n2 5 3\n9 8 2\n7 8 10\n7 1 4\n6 7 1\n6 4 8\n2 1 5\n10 8 10\n3 4 7\n3 4 6\n0 5 5\n1 6 8\n7 8 1", "1\n-1\n8"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "倍增", "Kruskal 重构树", "深度优先搜索 DFS", "可持久化线段树"], "title": "[ONTAK2010] Peaks 加强版", "background": "原题链接：[P4197 Peaks](https://www.luogu.com.cn/problem/P4197)", "description": "给定一张 $n$ 个点、$m$ 条边的无向图，第 $i$ 个点的权值为 $a_i$，边有边权。\n\n有 $q$ 组询问，每组询问给定三个整数 $u, x, k$，求从 $u$ 开始只经过权值 $\\leq x$ 的边所能到达的权值第 $k$ 大的点的权值，如果不存在输出 $-1$。\n\n**本题强制在线。即：每次查询输入的是 $u', x', k'$，则 $u = (u' \\operatorname{xor} \\text{lastans}) \\bmod n + 1$，$k$ 的解密方式与之相同，$x = x' \\operatorname{xor} \\text{lastans}$**。", "inputFormat": "第一行，三个整数 $n, m, q$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$；\n\n接下来 $m$ 行，每行三个整数 $s, t, w$，表示一条边的两个端点和权值；\n\n接下来 $q$ 行，每行三个整数 $u', x', k'$。\n\n**注意：处理第一组数据和无解时的 $\\text{lastans} = 0$。**", "outputFormat": "对于每组询问，输出一行，一个整数，表示所求的值。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$1 \\leq m, q \\leq 5 \\times 10^5$，$1 \\leq s, t \\leq n$，$1 \\leq a_i, w \\leq 10^9$，$0 \\leq u', x', k' < 2^{31}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ONTAK2010] Peaks 加强版", "background": "原题链接：[P4197 Peaks](https://www.luogu.com.cn/problem/P4197)", "description": "给定一张 $n$ 个点、$m$ 条边的无向图，第 $i$ 个点的权值为 $a_i$，边有边权。\n\n有 $q$ 组询问，每组询问给定三个整数 $u, x, k$，求从 $u$ 开始只经过权值 $\\leq x$ 的边所能到达的权值第 $k$ 大的点的权值，如果不存在输出 $-1$。\n\n**本题强制在线。即：每次查询输入的是 $u', x', k'$，则 $u = (u' \\operatorname{xor} \\text{lastans}) \\bmod n + 1$，$k$ 的解密方式与之相同，$x = x' \\operatorname{xor} \\text{lastans}$**。", "inputFormat": "第一行，三个整数 $n, m, q$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$；\n\n接下来 $m$ 行，每行三个整数 $s, t, w$，表示一条边的两个端点和权值；\n\n接下来 $q$ 行，每行三个整数 $u', x', k'$。\n\n**注意：处理第一组数据和无解时的 $\\text{lastans} = 0$。**", "outputFormat": "对于每组询问，输出一行，一个整数，表示所求的值。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$1 \\leq m, q \\leq 5 \\times 10^5$，$1 \\leq s, t \\leq n$，$1 \\leq a_i, w \\leq 10^9$，$0 \\leq u', x', k' < 2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P7835", "type": "P", "difficulty": 2, "samples": [["4 3\n2 1 2\n3 1 1\n4 2 1", "3"], ["2 2\n2 1 2\n3 0 1", "Mystia will cook forever..."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["最大公约数 gcd"], "title": "「Wdoi-3」夜雀 dreaming", "background": "作为幻想乡食物链顶端的幽幽子，一直都是老板娘米斯蒂娅的噩梦！\n\n尽管幽幽子一般而言是不会选择吃她的，但奈何日有所思夜有所梦，米斯蒂娅做了一个梦，一个交杂着幻想与现实的梦，或者说，那就是幻想中的现实……\n\n尽管米斯蒂娅不知道这天什么时候会到来，但她不敢放松警惕，于是老板娘向你求助了……", "description": "作为一道签到题，为了能让选手更好的发挥手速，米斯蒂娅决定提供这题的题意简述：[隙间传送](https://www.luogu.com.cn/paste/2dwm3f7z)。\n\n---\n\n在梦中，幽幽子来到了夜雀餐厅。似乎是由于异变的影响，本来就贪吃的幽幽子此刻变得更加可怕。\n\n米斯蒂娅一共会做 $n$ 道菜，用来满足所有顾客的需求，并试图增加自己存活的概率。这些菜的编号为 $0,1,2$ 直到 $n-1$。同时，幽幽子会进行 $k$ 次点餐。\n\n- 本题中，我们记**点菜事件**为 $\\operatorname{order}(t,x)$ ，表示顾客向米斯蒂娅发起一份请求，希望她在 $t$ 时刻制作并端上菜品 $x$ 。\n- 我们用一个三元组 $(t_i,x_i,y_i)$ 描述幽幽子发起第 $i$ 次点餐。在每次点餐中，幽幽子会发起 $\\operatorname{order}(t_i,x_i)$ 。然而幽幽子的欲望是不能被满足的。因此，当幽幽子在 $t_i$ 时刻收到菜品时，会再次发起 $\\operatorname{order}(2\\cdot t_i,(x_i+y_i)\\bmod n)$ ！更加不幸地，此过程会不断累加，接着她会发起 $\\operatorname{order}(3\\cdot t_i,(x_i+2\\cdot y_i)\\bmod n)$ 乃至更多……\n- 总而言之，幽幽子的第 $i$ 次点餐 $(t_i,x_i,y_i)$ 会执行这样的操作：\n\n$$\\operatorname{order}(j\\cdot t_i,(x_i+(j-1)\\cdot y_i)\\bmod n)(j=1,2,3,\\cdots)$$\n\n由于幽幽子会发起无数次点餐请求，所以米斯蒂娅是不可能使她满足的。但为了不辜负大家的期望，米斯蒂娅决定竭尽全力拖延时间。作为老板娘，她有着超凡的厨艺：\n\n- 每一个时刻，米斯蒂娅都能做出**无限**份菜，**但菜只能是同一种类**。\n\n如果一个时刻幽幽子点的菜没能被立即做好（幽幽子并不愿意吃上一个时刻做好的菜哦），那么她就会大发雷霆，在这一时刻**立即**摧毁夜雀餐厅。米斯蒂娅想知道她能坚持多久（坚持多久指的是最多能坚持多少个时刻使得这些时刻内幽幽子不会摧毁餐厅，时刻**从 $1$ 开始计数**）。如果她能坚持 $9961^{9961}$ 时刻或以上的话（在此题中，你可以认为 $9961^{9961}$ 是无穷大），请输出 `Mystia will cook forever...`。\n", "inputFormat": "第一行有两个整数 $n,k$ ，含义如题面所示。\n\n接下来 $k$ 行，每行给定三个整数 $(t_i,x_i,y_i)$ ，描述一组询问。", "outputFormat": "共一行。输出米斯蒂娅最多能支撑多久，或者输出 `Mystia will cook forever...`。", "hint": "#### 样例 1 解释\n\n在时刻 $4$，幽幽子同时点了菜品 $3$ 和菜品 $2$，于是夜雀餐厅会被摧毁，答案为 $4-1=3$。\n\n---\n\n#### 数据范围及约定\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{k} & \\bm{\\max\\{t_i\\}} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n\\textsf1 & =1 & \\text{无特殊限制} & \\text{无} & 10 \\cr\\hline\n\\textsf2 & \\leq 10 & \\leq 10 & \\text{无} & 20 \\cr\\hline\n\\textsf3 & \\text{无特殊限制} & \\text{无特殊限制} & \\text{A} & 30\\cr\\hline\n\\textsf4 & \\text{无特殊限制} & \\text{无特殊限制}& \\text{无}& 40 \\cr\\hline\n\\end{array}$$\n\n特殊性质 $\\text{A}$ ：保证对于所有的 $i$ ，满足 $y_i = 0$ 。\n\n对于 $100\\%$ 的数据，满足：\n- $1 \\le t_i,n \\leq 10 ^ 9$。\n- $0 \\le x_i,y_i  \\leq 10 ^ 9$。\n- $1 \\le k \\leq 1000 $。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 dreaming", "background": "作为幻想乡食物链顶端的幽幽子，一直都是老板娘米斯蒂娅的噩梦！\n\n尽管幽幽子一般而言是不会选择吃她的，但奈何日有所思夜有所梦，米斯蒂娅做了一个梦，一个交杂着幻想与现实的梦，或者说，那就是幻想中的现实……\n\n尽管米斯蒂娅不知道这天什么时候会到来，但她不敢放松警惕，于是老板娘向你求助了……", "description": "作为一道签到题，为了能让选手更好的发挥手速，米斯蒂娅决定提供这题的题意简述：[隙间传送](https://www.luogu.com.cn/paste/2dwm3f7z)。\n\n---\n\n在梦中，幽幽子来到了夜雀餐厅。似乎是由于异变的影响，本来就贪吃的幽幽子此刻变得更加可怕。\n\n米斯蒂娅一共会做 $n$ 道菜，用来满足所有顾客的需求，并试图增加自己存活的概率。这些菜的编号为 $0,1,2$ 直到 $n-1$。同时，幽幽子会进行 $k$ 次点餐。\n\n- 本题中，我们记**点菜事件**为 $\\operatorname{order}(t,x)$ ，表示顾客向米斯蒂娅发起一份请求，希望她在 $t$ 时刻制作并端上菜品 $x$ 。\n- 我们用一个三元组 $(t_i,x_i,y_i)$ 描述幽幽子发起第 $i$ 次点餐。在每次点餐中，幽幽子会发起 $\\operatorname{order}(t_i,x_i)$ 。然而幽幽子的欲望是不能被满足的。因此，当幽幽子在 $t_i$ 时刻收到菜品时，会再次发起 $\\operatorname{order}(2\\cdot t_i,(x_i+y_i)\\bmod n)$ ！更加不幸地，此过程会不断累加，接着她会发起 $\\operatorname{order}(3\\cdot t_i,(x_i+2\\cdot y_i)\\bmod n)$ 乃至更多……\n- 总而言之，幽幽子的第 $i$ 次点餐 $(t_i,x_i,y_i)$ 会执行这样的操作：\n\n$$\\operatorname{order}(j\\cdot t_i,(x_i+(j-1)\\cdot y_i)\\bmod n)(j=1,2,3,\\cdots)$$\n\n由于幽幽子会发起无数次点餐请求，所以米斯蒂娅是不可能使她满足的。但为了不辜负大家的期望，米斯蒂娅决定竭尽全力拖延时间。作为老板娘，她有着超凡的厨艺：\n\n- 每一个时刻，米斯蒂娅都能做出**无限**份菜，**但菜只能是同一种类**。\n\n如果一个时刻幽幽子点的菜没能被立即做好（幽幽子并不愿意吃上一个时刻做好的菜哦），那么她就会大发雷霆，在这一时刻**立即**摧毁夜雀餐厅。米斯蒂娅想知道她能坚持多久（坚持多久指的是最多能坚持多少个时刻使得这些时刻内幽幽子不会摧毁餐厅，时刻**从 $1$ 开始计数**）。如果她能坚持 $9961^{9961}$ 时刻或以上的话（在此题中，你可以认为 $9961^{9961}$ 是无穷大），请输出 `Mystia will cook forever...`。\n", "inputFormat": "第一行有两个整数 $n,k$ ，含义如题面所示。\n\n接下来 $k$ 行，每行给定三个整数 $(t_i,x_i,y_i)$ ，描述一组询问。", "outputFormat": "共一行。输出米斯蒂娅最多能支撑多久，或者输出 `Mystia will cook forever...`。", "hint": "#### 样例 1 解释\n\n在时刻 $4$，幽幽子同时点了菜品 $3$ 和菜品 $2$，于是夜雀餐厅会被摧毁，答案为 $4-1=3$。\n\n---\n\n#### 数据范围及约定\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{k} & \\bm{\\max\\{t_i\\}} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n\\textsf1 & =1 & \\text{无特殊限制} & \\text{无} & 10 \\cr\\hline\n\\textsf2 & \\leq 10 & \\leq 10 & \\text{无} & 20 \\cr\\hline\n\\textsf3 & \\text{无特殊限制} & \\text{无特殊限制} & \\text{A} & 30\\cr\\hline\n\\textsf4 & \\text{无特殊限制} & \\text{无特殊限制}& \\text{无}& 40 \\cr\\hline\n\\end{array}$$\n\n特殊性质 $\\text{A}$ ：保证对于所有的 $i$ ，满足 $y_i = 0$ 。\n\n对于 $100\\%$ 的数据，满足：\n- $1 \\le t_i,n \\leq 10 ^ 9$。\n- $0 \\le x_i,y_i  \\leq 10 ^ 9$。\n- $1 \\le k \\leq 1000 $。", "locale": "zh-CN"}}}
{"pid": "P7836", "type": "P", "difficulty": 6, "samples": [["5 3 4\n7 11 7 11 \n1 0 0 1 \n2 1 0 0 \n1 1 0 0 \n1 0 2 0 \n1 0 0 2 \n", "29\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "贪心", "O2优化"], "title": "「Wdoi-3」夜雀 collecting", "background": "巧妇难为无米之炊。在制作菜品之前，米斯蒂娅必然要四处收集食材了。\n\n然而幻想乡实在是太大，四处散落着各种各样的食材。米斯蒂娅的背包却非常有限，以至于四处采集时不得不考虑取舍的问题了。米斯蒂娅的时间非常有限，因为她必须要在夜晚摆摊之前准备好所有的食材。\n\n于是她来向你求助，希望精通计算的你帮助她收集食材。", "description": "米斯蒂娅有一个容量为 $v$ 的背包，而食材有 $x$ 种。当背包被塞满后，米斯蒂娅就不能够采集更多的食材了。\n\n为了尽可能地收集到更多食材，又要节省更多时间，她会**依次**经过 $n$ 个采集点。每个采集点都会有一定量的食材可供采集。\n\n具体来说，对于第 $i$ 个采集点，每种食材的个数分别为 $C_{i,1},C_{i,2}\\cdots C_{i,x}$ ，其中 $C_{i,j}$ 代表该采集点有多少个第 $j$ 种食材。保证对于所有 $i$ ，都有 $\\displaystyle C_{i,1}+C_{i,2}+\\cdots+C_{i,x}=\\sum_{j=1}^{x}C_{i,j} \\leq v$ 。\n\n每到一个采集点，米斯蒂娅都会决定是否开始采集食材。因为她非常享受采集新食材带来的愉悦感，一旦开始采集，她会将这个采集点的食材**全部采集完**。因此，如果此时她背包不足以塞下这里所有的食物，她将**不能进行**采集。尽管如此，米斯蒂娅也可以选择在采集前丢弃背包里的一些食材。\n\n不同的食材在烹饪中的泛用性是不同的，一些食材会经常使用，而一些食材则只会出现于少数菜品。因此，每种食材在米斯蒂亚心中有着不同的价值，第 $i$ 种的价值为 $A_i$。\n\n为了菜品的多样性，米斯蒂娅会尽可能采集更多种类的食材。于是她想知道，在经过了这 $n$ 个采集点后，她的背包中至少有 $1$ 个的食材的价值和最大是多少（也就是说，如果一种食材有多个，那么只计算一次）。", "inputFormat": "第一行三个整数 $n,v,x$。  \n第二行 $x$ 个整数，表示每种食材的价值。  \n接下来 $n$ 行，每行 $x$ 个整数，第 $i$ 行的第 $j$ 个整数表示 $C_{i,j}$。", "outputFormat": "一行一个整数，表示价值和。", "hint": "#### 样例 1 解释\n\n在第一个和第三个采集点收集食材。要注意的是，在采集第三个采集点前，丢弃一个第一种食材。最终，四个食材的数量分别是 $\\{1,1,0,1\\}$，于是获得的价值和为 $7+11+11=29$。可以证明，没有更优的方案。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm x & \\bm n & \\textbf{分值}\\cr \\hline\n1 & 1\\le x \\le 10 & 1\\le n\\le 2\\times 10^3 & 20 \\cr\\hline\n2 & 1\\le x \\le 14 & 1\\le n\\le 10^6 & 40 \\cr\\hline\n3 & 1\\le x \\le 18 & 1\\le n\\le 1000 & 40 \\cr\\hline\n\\end{array}\n$$\n\n对于 $100\\%$ 的数据，有 $1 \\le n \\le 10^6$，$1 \\le x \\le 18$，$1 \\le v \\le 2000$，$0 \\le C_{i,j}$，$\\sum_{j=1}^x C_{i,j} \\le v$，$0 \\le A_i \\le 1000$。\n\nSubtask 4 为不计分的 Hack 数据， 保证满足 Subtask 2 或 Subtask 3 的限制。\n\n特别感谢 chenxinyang2006 对本题解法的巨大贡献。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 collecting", "background": "巧妇难为无米之炊。在制作菜品之前，米斯蒂娅必然要四处收集食材了。\n\n然而幻想乡实在是太大，四处散落着各种各样的食材。米斯蒂娅的背包却非常有限，以至于四处采集时不得不考虑取舍的问题了。米斯蒂娅的时间非常有限，因为她必须要在夜晚摆摊之前准备好所有的食材。\n\n于是她来向你求助，希望精通计算的你帮助她收集食材。", "description": "米斯蒂娅有一个容量为 $v$ 的背包，而食材有 $x$ 种。当背包被塞满后，米斯蒂娅就不能够采集更多的食材了。\n\n为了尽可能地收集到更多食材，又要节省更多时间，她会**依次**经过 $n$ 个采集点。每个采集点都会有一定量的食材可供采集。\n\n具体来说，对于第 $i$ 个采集点，每种食材的个数分别为 $C_{i,1},C_{i,2}\\cdots C_{i,x}$ ，其中 $C_{i,j}$ 代表该采集点有多少个第 $j$ 种食材。保证对于所有 $i$ ，都有 $\\displaystyle C_{i,1}+C_{i,2}+\\cdots+C_{i,x}=\\sum_{j=1}^{x}C_{i,j} \\leq v$ 。\n\n每到一个采集点，米斯蒂娅都会决定是否开始采集食材。因为她非常享受采集新食材带来的愉悦感，一旦开始采集，她会将这个采集点的食材**全部采集完**。因此，如果此时她背包不足以塞下这里所有的食物，她将**不能进行**采集。尽管如此，米斯蒂娅也可以选择在采集前丢弃背包里的一些食材。\n\n不同的食材在烹饪中的泛用性是不同的，一些食材会经常使用，而一些食材则只会出现于少数菜品。因此，每种食材在米斯蒂亚心中有着不同的价值，第 $i$ 种的价值为 $A_i$。\n\n为了菜品的多样性，米斯蒂娅会尽可能采集更多种类的食材。于是她想知道，在经过了这 $n$ 个采集点后，她的背包中至少有 $1$ 个的食材的价值和最大是多少（也就是说，如果一种食材有多个，那么只计算一次）。", "inputFormat": "第一行三个整数 $n,v,x$。  \n第二行 $x$ 个整数，表示每种食材的价值。  \n接下来 $n$ 行，每行 $x$ 个整数，第 $i$ 行的第 $j$ 个整数表示 $C_{i,j}$。", "outputFormat": "一行一个整数，表示价值和。", "hint": "#### 样例 1 解释\n\n在第一个和第三个采集点收集食材。要注意的是，在采集第三个采集点前，丢弃一个第一种食材。最终，四个食材的数量分别是 $\\{1,1,0,1\\}$，于是获得的价值和为 $7+11+11=29$。可以证明，没有更优的方案。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm x & \\bm n & \\textbf{分值}\\cr \\hline\n1 & 1\\le x \\le 10 & 1\\le n\\le 2\\times 10^3 & 20 \\cr\\hline\n2 & 1\\le x \\le 14 & 1\\le n\\le 10^6 & 40 \\cr\\hline\n3 & 1\\le x \\le 18 & 1\\le n\\le 1000 & 40 \\cr\\hline\n\\end{array}\n$$\n\n对于 $100\\%$ 的数据，有 $1 \\le n \\le 10^6$，$1 \\le x \\le 18$，$1 \\le v \\le 2000$，$0 \\le C_{i,j}$，$\\sum_{j=1}^x C_{i,j} \\le v$，$0 \\le A_i \\le 1000$。\n\nSubtask 4 为不计分的 Hack 数据， 保证满足 Subtask 2 或 Subtask 3 的限制。\n\n特别感谢 chenxinyang2006 对本题解法的巨大贡献。", "locale": "zh-CN"}}}
{"pid": "P7837", "type": "P", "difficulty": 5, "samples": [["1\n12 4 2 1\n\n13\n\n20\n\n22", "\n\n10 12\n\n2 7\n\n4 8\n\n-1 4 7 10 11"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["二分", "交互题", "Special Judge", "O2优化", "分块"], "title": "「Wdoi-3」夜雀 cooking", "background": "作为幻想乡的大厨，米斯蒂娅当然能用准备的食材制作出各色各样的饭菜。晚上，就是夜雀餐厅营业的时间，凭着这些料理，餐厅总是生意兴隆——甚至一些「特殊顾客」也会前来！\n\n特殊顾客就是一些幻想乡里大家再熟悉不过的角色啦，顾名思义，她们会提出特殊要求，不过如果满足了她们的要求，她们也会好好地奖励小夜雀。\n\n不幸的是，紫决定做一个恶作剧，她悄悄使用能力清除了米斯蒂娅的部分记忆，现在她分不清哪些顾客是特殊顾客，哪些顾客是普通顾客了！看着米斯蒂娅快要哭了，于心不忍的紫决定和米斯蒂娅做一个数学游戏，她将特殊顾客的编号隐藏在了数字之中。米斯蒂娅对数学一窍不通，于是她只能向你求助了......", "description": "**本题为交互题。**\n\n紫给出了一个长度为 $n$ 的数列，其第 $i$ 项就对应了编号为 $i$ 的顾客。她将所有普通顾客对应的位置染上蓝色，把特殊顾客对应的位置染上紫色。紫告诉了米斯蒂娅特殊顾客一共有 $m$ 位。并且，由于特殊顾客非常的特殊，所以紫色位置数量很少，而且**基本均匀随机**。\n\n接下来，她给数列的每一项赋上了值。第 $i$ 项的值 $a_i$ 可以用如下的式子推出：（$s$ 和 $k$ 紫都会给出）\n  $$a_i=\\begin{cases} s & i=1\\cr a_{i-1}+k & i>1\\end{cases}$$\n\n米斯蒂娅可以向紫提出形如 `l r` 的问题，然后紫就会迅速算出区间 $[l,r]$ 内所有被染成蓝色位置的 $a_i$ 的和。当然啦，你需要输出 `l r` 来告诉米斯蒂娅她该如何提问，如果你成功找出了所有特殊顾客的编号（即所有紫色点的位置），那么你需要输出 `-1 p1 p2 ... pm` 来告诉米斯蒂娅所有特殊顾客的编号，注意要保证 $p_i\\le p_{i+1}(1\\le i<m)$。\n\n**注意：在进行这两种操作后，需要刷新缓存区，下面是一些常见语言的刷新缓存区方式：**\n\n- C++：`fflush(stdout)` 或 `cout.flush()`。\n- C: `fflush(stdout)`。\n- Java: `System.out.flush()`。\n- Python: `stdout.flush()`。\n- Pascal: `flush(output)`。\n- 其他语言：请参考对应语言的帮助文档。", "inputFormat": "**本题有多组数据。**\n\n第一行是一个正整数 $T$，表示数据组数。\n\n接下来进行每组数据。首先夜雀会传达紫所说的信息，也就是 $n,m,s,k$ 的值，接着你可以发起若干次询问，直到你告诉了米斯蒂娅所有特殊顾客的编号。此时该组数据结束，进入到下一组。", "outputFormat": "输出若干行。你可以向标准输出中发起询问来得到米斯蒂娅的回答。\n\n**注意：** 如果你在询问过程中出了问题（包括但不限于询问次数过多，询问越界等），此时米斯蒂娅会告诉你 $-1$（代表紫不想理她了）。此时你应立即停止，否则可能会出现奇怪的状况。", "hint": "#### 样例解释\n\n神秘顾客的编号为 $\\{4,7,10,11\\}$ 。这个样例象征性地抽取了 $3$ 个询问，以便选手理解交互的过程。\n\n- 对于第一次询问 $[10,12]$ ，结果为 $13=13$。\n- 对于第二次询问 $[2,7]$ ，结果为 $3+4+6+7=20$。\n- 对于第三次询问 $[4,8]$ ，结果为 $6+7+9=22$。\n\n---\n\n#### 数据范围及约定\n\n$$\\def\\arraystretch{1.8}\n\\begin{array}{|c|c|c|}\\hline\n\\textbf{Subtask} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & m=1 & 5 \\cr\\hline\n2 & - & 95 \\cr\\hline\n\\end{array}$$\n\n- 对于所有数据，满足 $1\\le T\\le 500$，$1 \\leq \\sum n_i \\leq 10^5$，$1 \\leq \\sum m_i \\leq \\min\\{ n,100\\}$，$1\\le s,k\\le 10^9$。\n\n每一个 Subtask 的得分为当前 Subtask 所有测试点的最低分。\n\n#### 判分方式\n\n令 $q_i$ 为对于第 $i$ 组数据你所用的询问次数，你需要满足 $\\sum q_i \\leq 200 \\times T$ ，并且每组询问的结果都是正确的，你才能获得该测试点的满分。\n\n- 如果询问次数满足 $1000 \\times T<\\sum q_i \\leq 2000 \\times T$，可以拿到 $20\\%$ 的分数。\n- 如果询问次数满足 $600 \\times T<\\sum q_i \\leq 1000 \\times T$，可以拿到 $40\\%$ 的分数。  \n- 如果询问次数满足 $400 \\times T<\\sum q_i \\leq 600 \\times T$，可以拿到 $50\\%$ 的分数。\n- 如果询问次数满足 $300 \\times T<\\sum q_i \\leq 400 \\times T$，可以拿到 $60\\%$ 的分数。\n- 如果询问次数满足 $200 \\times T<\\sum q_i \\leq 300 \\times T$，可以拿到 $80\\%$ 的分数。\n\n#### 说明\n\n选择 $m$ 个点染为紫色的生成方式是对一个 $1 \\sim n$ 的排列调用 `random_shuffle`，然后取前 $m$ 项的数值作为特殊顾客的编号。一个可被参考的代码如下：\n\n```cpp\nnamespace Gen{\n\ttypedef unsigned int       u32;\n\ttypedef unsigned long long u64;\n\tu32 MT[624],idx;\n\tvoid iit(u32 seed){\n    \tMT[0]=seed; idx=0; for(u32 i = 1;i < 624;++ i)\n    \tMT[i]=(0x6c078965U * (MT[i - 1] ^ ((MT[i - 1]) >> 30)) + i);\n\t}\n\tvoid gen(){\n\t\tu32 x; for(u32 i = 0;i < 624; ++ i){\n\t\t\tx = (MT[i] & 0x80000000U) +\n\t\t\t\t(MT[(i + 1) % 624] & 0x7fffffffU );\n\t\t\tMT[i] = MT[(i + 397) % 624] ^ (x >> 1);\n\t\t\tif(x & 1) MT[i] ^= 0x9908b0dfU;\n\t\t}\n\t}\n\tu32  clc(){\n\t\tif(!idx) gen(); u32 x = MT[idx];\n\t\tx ^= x >> 11, x ^= (x << 7) & 0x9d2c5680U;\n\t\tx ^= (x << 15) & 0xefc60000U,x ^= x >> 18;\n\t\tidx = (idx + 1) % 624; return x;\n\t}\n\tu32  clc(u32 n){\t//均匀随机地返回 [0,n) 内的整数\n\t\treturn 1ull * n * clc() >> 32;\n\t}\n\tvoid sfl(int n, int *A) {\n\t\tfor(int i = n;i >= 1; --i) swap(A[clc(i) + 1], A[i]);\n\t}\n\tvoid gen(u32 seed,int n, int *A) {\n\t\tiit(seed); for(int i = 1;i <= n; ++i) A[i] = i; sfl(n, A);\n\t}\n}\n```\n\n**注**：该代码片段会使用符合标准的梅森旋转算法生成随机数。其生成随机数的周期为 $2^{19937}-1$ ，生成的随机数是均匀随机的。因此你大可不必担心我们在里面做了任何手脚。\n\n调用 `gen(seed,n,A)` 可以生成一个长度为 $n$ 的**基本均匀随机**序列，我们将会取其前 $m$ 项作为特殊顾客的编号。例如，对于样例，我们调用了 `gen(9961U,12,A)` ，并选取了 $A$ 的前 $4$ 项 $\\{4,7,10,11\\}$ 作为神秘顾客的编号。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 cooking", "background": "作为幻想乡的大厨，米斯蒂娅当然能用准备的食材制作出各色各样的饭菜。晚上，就是夜雀餐厅营业的时间，凭着这些料理，餐厅总是生意兴隆——甚至一些「特殊顾客」也会前来！\n\n特殊顾客就是一些幻想乡里大家再熟悉不过的角色啦，顾名思义，她们会提出特殊要求，不过如果满足了她们的要求，她们也会好好地奖励小夜雀。\n\n不幸的是，紫决定做一个恶作剧，她悄悄使用能力清除了米斯蒂娅的部分记忆，现在她分不清哪些顾客是特殊顾客，哪些顾客是普通顾客了！看着米斯蒂娅快要哭了，于心不忍的紫决定和米斯蒂娅做一个数学游戏，她将特殊顾客的编号隐藏在了数字之中。米斯蒂娅对数学一窍不通，于是她只能向你求助了......", "description": "**本题为交互题。**\n\n紫给出了一个长度为 $n$ 的数列，其第 $i$ 项就对应了编号为 $i$ 的顾客。她将所有普通顾客对应的位置染上蓝色，把特殊顾客对应的位置染上紫色。紫告诉了米斯蒂娅特殊顾客一共有 $m$ 位。并且，由于特殊顾客非常的特殊，所以紫色位置数量很少，而且**基本均匀随机**。\n\n接下来，她给数列的每一项赋上了值。第 $i$ 项的值 $a_i$ 可以用如下的式子推出：（$s$ 和 $k$ 紫都会给出）\n  $$a_i=\\begin{cases} s & i=1\\cr a_{i-1}+k & i>1\\end{cases}$$\n\n米斯蒂娅可以向紫提出形如 `l r` 的问题，然后紫就会迅速算出区间 $[l,r]$ 内所有被染成蓝色位置的 $a_i$ 的和。当然啦，你需要输出 `l r` 来告诉米斯蒂娅她该如何提问，如果你成功找出了所有特殊顾客的编号（即所有紫色点的位置），那么你需要输出 `-1 p1 p2 ... pm` 来告诉米斯蒂娅所有特殊顾客的编号，注意要保证 $p_i\\le p_{i+1}(1\\le i<m)$。\n\n**注意：在进行这两种操作后，需要刷新缓存区，下面是一些常见语言的刷新缓存区方式：**\n\n- C++：`fflush(stdout)` 或 `cout.flush()`。\n- C: `fflush(stdout)`。\n- Java: `System.out.flush()`。\n- Python: `stdout.flush()`。\n- Pascal: `flush(output)`。\n- 其他语言：请参考对应语言的帮助文档。", "inputFormat": "**本题有多组数据。**\n\n第一行是一个正整数 $T$，表示数据组数。\n\n接下来进行每组数据。首先夜雀会传达紫所说的信息，也就是 $n,m,s,k$ 的值，接着你可以发起若干次询问，直到你告诉了米斯蒂娅所有特殊顾客的编号。此时该组数据结束，进入到下一组。", "outputFormat": "输出若干行。你可以向标准输出中发起询问来得到米斯蒂娅的回答。\n\n**注意：** 如果你在询问过程中出了问题（包括但不限于询问次数过多，询问越界等），此时米斯蒂娅会告诉你 $-1$（代表紫不想理她了）。此时你应立即停止，否则可能会出现奇怪的状况。", "hint": "#### 样例解释\n\n神秘顾客的编号为 $\\{4,7,10,11\\}$ 。这个样例象征性地抽取了 $3$ 个询问，以便选手理解交互的过程。\n\n- 对于第一次询问 $[10,12]$ ，结果为 $13=13$。\n- 对于第二次询问 $[2,7]$ ，结果为 $3+4+6+7=20$。\n- 对于第三次询问 $[4,8]$ ，结果为 $6+7+9=22$。\n\n---\n\n#### 数据范围及约定\n\n$$\\def\\arraystretch{1.8}\n\\begin{array}{|c|c|c|}\\hline\n\\textbf{Subtask} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & m=1 & 5 \\cr\\hline\n2 & - & 95 \\cr\\hline\n\\end{array}$$\n\n- 对于所有数据，满足 $1\\le T\\le 500$，$1 \\leq \\sum n_i \\leq 10^5$，$1 \\leq \\sum m_i \\leq \\min\\{ n,100\\}$，$1\\le s,k\\le 10^9$。\n\n每一个 Subtask 的得分为当前 Subtask 所有测试点的最低分。\n\n#### 判分方式\n\n令 $q_i$ 为对于第 $i$ 组数据你所用的询问次数，你需要满足 $\\sum q_i \\leq 200 \\times T$ ，并且每组询问的结果都是正确的，你才能获得该测试点的满分。\n\n- 如果询问次数满足 $1000 \\times T<\\sum q_i \\leq 2000 \\times T$，可以拿到 $20\\%$ 的分数。\n- 如果询问次数满足 $600 \\times T<\\sum q_i \\leq 1000 \\times T$，可以拿到 $40\\%$ 的分数。  \n- 如果询问次数满足 $400 \\times T<\\sum q_i \\leq 600 \\times T$，可以拿到 $50\\%$ 的分数。\n- 如果询问次数满足 $300 \\times T<\\sum q_i \\leq 400 \\times T$，可以拿到 $60\\%$ 的分数。\n- 如果询问次数满足 $200 \\times T<\\sum q_i \\leq 300 \\times T$，可以拿到 $80\\%$ 的分数。\n\n#### 说明\n\n选择 $m$ 个点染为紫色的生成方式是对一个 $1 \\sim n$ 的排列调用 `random_shuffle`，然后取前 $m$ 项的数值作为特殊顾客的编号。一个可被参考的代码如下：\n\n```cpp\nnamespace Gen{\n\ttypedef unsigned int       u32;\n\ttypedef unsigned long long u64;\n\tu32 MT[624],idx;\n\tvoid iit(u32 seed){\n    \tMT[0]=seed; idx=0; for(u32 i = 1;i < 624;++ i)\n    \tMT[i]=(0x6c078965U * (MT[i - 1] ^ ((MT[i - 1]) >> 30)) + i);\n\t}\n\tvoid gen(){\n\t\tu32 x; for(u32 i = 0;i < 624; ++ i){\n\t\t\tx = (MT[i] & 0x80000000U) +\n\t\t\t\t(MT[(i + 1) % 624] & 0x7fffffffU );\n\t\t\tMT[i] = MT[(i + 397) % 624] ^ (x >> 1);\n\t\t\tif(x & 1) MT[i] ^= 0x9908b0dfU;\n\t\t}\n\t}\n\tu32  clc(){\n\t\tif(!idx) gen(); u32 x = MT[idx];\n\t\tx ^= x >> 11, x ^= (x << 7) & 0x9d2c5680U;\n\t\tx ^= (x << 15) & 0xefc60000U,x ^= x >> 18;\n\t\tidx = (idx + 1) % 624; return x;\n\t}\n\tu32  clc(u32 n){\t//均匀随机地返回 [0,n) 内的整数\n\t\treturn 1ull * n * clc() >> 32;\n\t}\n\tvoid sfl(int n, int *A) {\n\t\tfor(int i = n;i >= 1; --i) swap(A[clc(i) + 1], A[i]);\n\t}\n\tvoid gen(u32 seed,int n, int *A) {\n\t\tiit(seed); for(int i = 1;i <= n; ++i) A[i] = i; sfl(n, A);\n\t}\n}\n```\n\n**注**：该代码片段会使用符合标准的梅森旋转算法生成随机数。其生成随机数的周期为 $2^{19937}-1$ ，生成的随机数是均匀随机的。因此你大可不必担心我们在里面做了任何手脚。\n\n调用 `gen(seed,n,A)` 可以生成一个长度为 $n$ 的**基本均匀随机**序列，我们将会取其前 $m$ 项作为特殊顾客的编号。例如，对于样例，我们调用了 `gen(9961U,12,A)` ，并选取了 $A$ 的前 $4$ 项 $\\{4,7,10,11\\}$ 作为神秘顾客的编号。", "locale": "zh-CN"}}}
{"pid": "P7838", "type": "P", "difficulty": 6, "samples": [["3\n4 7 3 6 1 2 5", "3"], ["7\n1 15 2 14 3 13 4 12 5 11 6 10 7 9 8", "8"], ["1\n1 2 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "线段树", "O2优化"], "title": "「Wdoi-3」夜雀 treating", "background": "经历了一整天的磨难，米斯蒂娅终于迎来了这一天最后一位客人——蓬莱山辉夜。\n\n作为永远亭的大小姐、月之都的公主，辉夜对于经营着平凡小吃摊的米斯蒂娅，向来是一个巨大的挑战。辉夜的口味极其挑剔，以至于米斯蒂娅常常难以满足她的需求。更棘手的是，如果辉夜认为米斯蒂娅招待不周，那么夜雀食堂的后果可能并不会比被幽幽子摧毁好多少。\n\n于是可怜的小夜雀只能向你求助了。", "description": "为了伺候这位主客，米斯蒂娅事先准备好了 $2n+1$ 种食材，并排成了一排，第 $i$ 种食材在左起第 $i$ 位，作为**预选食材**。\n\n接着，辉夜对所有食材进行了打分，每个食材被给予了一个在 $[1,2n+1]$ 当中的**互不相等**的分数。其中第 $i$ 种食材的评分为 $A_i$。\n\n由于月之民的奇怪癖好，辉夜喜欢一组连续的数字。因此，她对最终选出来的食材（不妨称为**最终食材**）的满意度，定义为将这些食材**按照其评分从小到大排序后**，其中**最长**的**评分连续**的食材的**长度**。评分连续，也就是这些食材的评分形成了公差为 $1$ 的等差数列。例如，$\\{1,4,5,6,8,10,11\\}$ 当中，能挑选出来的最长的评分连续的序列是 $\\{4,5,6\\}$，因此对于这套方案，辉夜的满意度是 $3$。\n\n然而喜欢看乐子的辉夜，决定使用一种诡异的选择方式来折磨米斯蒂娅——\n\n1. 设当前一共有 $2k+1$ 种食材。这些食材被依次排开，米斯蒂娅将这些食材从左到右依次编号为 $1,2,3\\cdots (2k+1)$。\n2. 米斯蒂娅选择当前处于**中间位置**的材料（也就是编号为 $k+1$ 的材料），并加入最终食材。注意，加入最终食材的食材会被**移出**候选食材。\n3. 米斯蒂娅**任选**候选食材中的一种食材，**并移除**。保持剩余食材的相对位置不变。特别的，如果候选食材已空，那么米斯蒂娅不做任何操作。\n\n米斯蒂娅将会不断进行 $1\\sim3$ 操作，直到最终食材当中已经有了恰好 $n+1$ 种食材。她想知道，如果按照最优的操作方案，辉夜能获得的最大的满意度是多少。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $2n + 1$ 个整数，表示每种食材的评分。", "outputFormat": "一行一个整数，表示按照最优操作方案能得到的最大满意度。", "hint": "#### 样例 1 解释\n\n$$\n\\def\\arraystretch{1.7}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{候选食材} & \\textbf{选择} & \\textbf{删除} & \\textbf{最终食材} \\cr\\hline\n4,7,3,6,1,2,5 & 6 & 1 & 6\\cr \\hline\n4,7,3,2,5 & 3 & 7 & 3,6\\cr \\hline\n4,2,5 & 2 & 5 & 2,3,6\\cr \\hline\n4 & 4 & - & 2,3,4,6\\cr \\hline\n\\end{array}$$\n\n此时最终食材中最长连续食材编号为 $\\{2,3,4\\}$ ，长度为 $3$ 。可以证明，没有更优方案。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.7}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 5 & - & 10\\cr\\hline\n2 & 200 & - & 15\\cr\\hline\n3 & 800 & - & 15\\cr\\hline\n4 & 5\\times 10^3& - & 20\\cr\\hline\n5 & 2\\times 10^5& \\text{A} & 5\\cr\\hline\n6 & 2\\times 10^5& - & 35\\cr\\hline\n\\end{array}\n$$\n\n- 特殊性质 A ：保证 $\\forall i\\in[1,2n+1]$ 有 $A_i=i$ 。样例 3 即满足该性质。\n- 对于 $100\\%$ 的数据，有 $1 \\leq n \\leq 2 \\times 10^5$，并且 $A$ 是一个 $1 \\sim 2n+1$ 的排列。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 treating", "background": "经历了一整天的磨难，米斯蒂娅终于迎来了这一天最后一位客人——蓬莱山辉夜。\n\n作为永远亭的大小姐、月之都的公主，辉夜对于经营着平凡小吃摊的米斯蒂娅，向来是一个巨大的挑战。辉夜的口味极其挑剔，以至于米斯蒂娅常常难以满足她的需求。更棘手的是，如果辉夜认为米斯蒂娅招待不周，那么夜雀食堂的后果可能并不会比被幽幽子摧毁好多少。\n\n于是可怜的小夜雀只能向你求助了。", "description": "为了伺候这位主客，米斯蒂娅事先准备好了 $2n+1$ 种食材，并排成了一排，第 $i$ 种食材在左起第 $i$ 位，作为**预选食材**。\n\n接着，辉夜对所有食材进行了打分，每个食材被给予了一个在 $[1,2n+1]$ 当中的**互不相等**的分数。其中第 $i$ 种食材的评分为 $A_i$。\n\n由于月之民的奇怪癖好，辉夜喜欢一组连续的数字。因此，她对最终选出来的食材（不妨称为**最终食材**）的满意度，定义为将这些食材**按照其评分从小到大排序后**，其中**最长**的**评分连续**的食材的**长度**。评分连续，也就是这些食材的评分形成了公差为 $1$ 的等差数列。例如，$\\{1,4,5,6,8,10,11\\}$ 当中，能挑选出来的最长的评分连续的序列是 $\\{4,5,6\\}$，因此对于这套方案，辉夜的满意度是 $3$。\n\n然而喜欢看乐子的辉夜，决定使用一种诡异的选择方式来折磨米斯蒂娅——\n\n1. 设当前一共有 $2k+1$ 种食材。这些食材被依次排开，米斯蒂娅将这些食材从左到右依次编号为 $1,2,3\\cdots (2k+1)$。\n2. 米斯蒂娅选择当前处于**中间位置**的材料（也就是编号为 $k+1$ 的材料），并加入最终食材。注意，加入最终食材的食材会被**移出**候选食材。\n3. 米斯蒂娅**任选**候选食材中的一种食材，**并移除**。保持剩余食材的相对位置不变。特别的，如果候选食材已空，那么米斯蒂娅不做任何操作。\n\n米斯蒂娅将会不断进行 $1\\sim3$ 操作，直到最终食材当中已经有了恰好 $n+1$ 种食材。她想知道，如果按照最优的操作方案，辉夜能获得的最大的满意度是多少。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $2n + 1$ 个整数，表示每种食材的评分。", "outputFormat": "一行一个整数，表示按照最优操作方案能得到的最大满意度。", "hint": "#### 样例 1 解释\n\n$$\n\\def\\arraystretch{1.7}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{候选食材} & \\textbf{选择} & \\textbf{删除} & \\textbf{最终食材} \\cr\\hline\n4,7,3,6,1,2,5 & 6 & 1 & 6\\cr \\hline\n4,7,3,2,5 & 3 & 7 & 3,6\\cr \\hline\n4,2,5 & 2 & 5 & 2,3,6\\cr \\hline\n4 & 4 & - & 2,3,4,6\\cr \\hline\n\\end{array}$$\n\n此时最终食材中最长连续食材编号为 $\\{2,3,4\\}$ ，长度为 $3$ 。可以证明，没有更优方案。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.7}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 5 & - & 10\\cr\\hline\n2 & 200 & - & 15\\cr\\hline\n3 & 800 & - & 15\\cr\\hline\n4 & 5\\times 10^3& - & 20\\cr\\hline\n5 & 2\\times 10^5& \\text{A} & 5\\cr\\hline\n6 & 2\\times 10^5& - & 35\\cr\\hline\n\\end{array}\n$$\n\n- 特殊性质 A ：保证 $\\forall i\\in[1,2n+1]$ 有 $A_i=i$ 。样例 3 即满足该性质。\n- 对于 $100\\%$ 的数据，有 $1 \\leq n \\leq 2 \\times 10^5$，并且 $A$ 是一个 $1 \\sim 2n+1$ 的排列。", "locale": "zh-CN"}}}
{"pid": "P7839", "type": "P", "difficulty": 4, "samples": [["5 3 4\n1 2 1 4 5\n5 3 2 \n", "2\n"], ["10 7 9\n8 1 1 5 13 10 1 1 6 3 \n2 4 7 10 6 8 9 \n", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "O2优化"], "title": "「Wdoi-3」夜雀 singing", "background": "“唉，今天可真是多事的一天呢。不过一晚的忙碌结束了，接下来就是我尽展歌喉的时刻啦！”\n\n作为幻想乡妖精中的一份子，米斯蒂娅在闲暇之余（也就是夜雀食堂闭店之后）也会去参加由夜雀们自发组织而成的夜雀歌会。夜雀们会按照一种约定好的方式进行歌唱。在今夜的歌会中，米斯蒂娅成为了歌会的组织者。\n\n然而因为大家都是夜雀，因此所谓的“舞台”其实是由若干个高度不一的树组成的。夜雀都会飞（显然），因此它们可以不断地变换自己的位置。\n\n然而，由于夜雀的数目实在是太多，以至于作为组织者的米斯蒂娅搞不清楚活动的组织方案了。你能帮帮她吗？", "description": "我们可以将这 $n$ 棵树从 $1$ 到 $n$ 编号。其中，在 $m$ 个点上分布着参加舞会的夜雀。第 $i$ 棵树的高度为 $h_i$ 。\n\n夜雀们的歌会一共会进行 $t$ 时刻。第 $i$ 个时刻，夜雀们**只能**在高度严格大于 $i$ 的树上唱歌。因为这些树木都是事先被选择好的，因此总是有 $\\max\\{h_i\\}>t$。夜雀们每个时刻，**可以选择站着不动**，或移动到**编号相邻**的一棵树上（例如，原先在编号为 $i$ 的树上的夜雀，下个时刻可以移动到编号为 $i-1$ 或者 $i+1$ 的树上。不过，她们不能移动到编号为 $0$ 或 $n+1$ 的树上）。初始时为第 $0$ 时刻。也就是说，假使一个夜雀初始时在高度为 $1$ 的树上，那么她下一时刻不得不去高度大于 $1$ 的树上。\n\n但这样一些夜雀可能无法顺利完成歌会，会遇到“无处可走”的情况，于是夜雀们决定选择若干个大树作为飞行点。如果一个夜雀到达了某个飞行点，那么下一时刻她除了能移动到编号相邻的树上，还能**到达其他的飞行点**。\n\n然而，飞行点太多容易使得歌会变得非常混乱。因此，米斯蒂娅希望最小化飞行点的数目。你能帮帮她吗？", "inputFormat": "第一行三个整数 $n,m,t$。含义如题面所示。  \n第二行 $n$ 个整数，第 $i$ 个整数表示 $h_i$。  \n第三行 $m$ 个整数，第 $i$ 个整数表示第 $i$ 只夜雀的位置 $p_i$。", "outputFormat": "输出一行，一个整数，表示最少的飞行点数量。", "hint": "#### 样例 1 解释\n\n一个最优方案是，分别在第 $2,5$ 棵树建立飞行点，下表为各夜雀的一个可行移动方案：\n\n$$\\def\\arraystretch{1.8}\n\\begin{array}{|c|c|c|c|} \\hline\n\\textsf{\\textbf{夜雀编号}} & \\textsf{\\textbf{时刻 $0$ 所在位置}} & \\textsf{\\textbf{时刻 $1$ 所在位置}} & \\textsf{\\textbf{时刻 $2 \\sim 4$ 所在位置}} \\cr\\hline\n\\textsf1 & 5 & 5 & 5 \\cr\\hline\n\\textsf2 & 3 & 2 & 5 \\cr\\hline\n\\textsf3 & 2 & 5 & 5 \\cr\\hline\n\\end{array}$$  \n\n可以证明不存在更优解。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.6}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 16 & - & 15 \\cr\\hline\n2 & 5\\times 10^5 & \\text{A} & 5 \\cr\\hline\n3 & 5\\times 10^5 & \\text{B} & 15 \\cr\\hline\n4 & 10^3 & - & 25 \\cr\\hline\n5 & 5\\times 10^5 & - & 20 \\cr\\hline\n6 & 5\\times 10^6 & - & 20 \\cr\\hline\n\\end{array}$$\n\n- 特殊性质 A：$\\min(h_i) > t$。\n- 特殊性质 B：$t > n$ 且 $h_i \\in \\{1,t-1,t+1\\}$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le n,m \\le 5 \\times 10^6$，$1 \\le h_i,t \\le 10^9$，$1 \\le p_i \\le n$。保证 $p$ 互不相同，且 $\\max(h_i) > t$。\n\n---\n    \n#### 提示\n\n显然你可以将所有位置都作为飞行点，然后在第 1 时刻让所有夜雀都飞到一棵 $h_i > t$ 的树来得到一组答案为 $n$ 的合法解。因此本题不会存在无解情况。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 singing", "background": "“唉，今天可真是多事的一天呢。不过一晚的忙碌结束了，接下来就是我尽展歌喉的时刻啦！”\n\n作为幻想乡妖精中的一份子，米斯蒂娅在闲暇之余（也就是夜雀食堂闭店之后）也会去参加由夜雀们自发组织而成的夜雀歌会。夜雀们会按照一种约定好的方式进行歌唱。在今夜的歌会中，米斯蒂娅成为了歌会的组织者。\n\n然而因为大家都是夜雀，因此所谓的“舞台”其实是由若干个高度不一的树组成的。夜雀都会飞（显然），因此它们可以不断地变换自己的位置。\n\n然而，由于夜雀的数目实在是太多，以至于作为组织者的米斯蒂娅搞不清楚活动的组织方案了。你能帮帮她吗？", "description": "我们可以将这 $n$ 棵树从 $1$ 到 $n$ 编号。其中，在 $m$ 个点上分布着参加舞会的夜雀。第 $i$ 棵树的高度为 $h_i$ 。\n\n夜雀们的歌会一共会进行 $t$ 时刻。第 $i$ 个时刻，夜雀们**只能**在高度严格大于 $i$ 的树上唱歌。因为这些树木都是事先被选择好的，因此总是有 $\\max\\{h_i\\}>t$。夜雀们每个时刻，**可以选择站着不动**，或移动到**编号相邻**的一棵树上（例如，原先在编号为 $i$ 的树上的夜雀，下个时刻可以移动到编号为 $i-1$ 或者 $i+1$ 的树上。不过，她们不能移动到编号为 $0$ 或 $n+1$ 的树上）。初始时为第 $0$ 时刻。也就是说，假使一个夜雀初始时在高度为 $1$ 的树上，那么她下一时刻不得不去高度大于 $1$ 的树上。\n\n但这样一些夜雀可能无法顺利完成歌会，会遇到“无处可走”的情况，于是夜雀们决定选择若干个大树作为飞行点。如果一个夜雀到达了某个飞行点，那么下一时刻她除了能移动到编号相邻的树上，还能**到达其他的飞行点**。\n\n然而，飞行点太多容易使得歌会变得非常混乱。因此，米斯蒂娅希望最小化飞行点的数目。你能帮帮她吗？", "inputFormat": "第一行三个整数 $n,m,t$。含义如题面所示。  \n第二行 $n$ 个整数，第 $i$ 个整数表示 $h_i$。  \n第三行 $m$ 个整数，第 $i$ 个整数表示第 $i$ 只夜雀的位置 $p_i$。", "outputFormat": "输出一行，一个整数，表示最少的飞行点数量。", "hint": "#### 样例 1 解释\n\n一个最优方案是，分别在第 $2,5$ 棵树建立飞行点，下表为各夜雀的一个可行移动方案：\n\n$$\\def\\arraystretch{1.8}\n\\begin{array}{|c|c|c|c|} \\hline\n\\textsf{\\textbf{夜雀编号}} & \\textsf{\\textbf{时刻 $0$ 所在位置}} & \\textsf{\\textbf{时刻 $1$ 所在位置}} & \\textsf{\\textbf{时刻 $2 \\sim 4$ 所在位置}} \\cr\\hline\n\\textsf1 & 5 & 5 & 5 \\cr\\hline\n\\textsf2 & 3 & 2 & 5 \\cr\\hline\n\\textsf3 & 2 & 5 & 5 \\cr\\hline\n\\end{array}$$  \n\n可以证明不存在更优解。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.6}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 16 & - & 15 \\cr\\hline\n2 & 5\\times 10^5 & \\text{A} & 5 \\cr\\hline\n3 & 5\\times 10^5 & \\text{B} & 15 \\cr\\hline\n4 & 10^3 & - & 25 \\cr\\hline\n5 & 5\\times 10^5 & - & 20 \\cr\\hline\n6 & 5\\times 10^6 & - & 20 \\cr\\hline\n\\end{array}$$\n\n- 特殊性质 A：$\\min(h_i) > t$。\n- 特殊性质 B：$t > n$ 且 $h_i \\in \\{1,t-1,t+1\\}$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le n,m \\le 5 \\times 10^6$，$1 \\le h_i,t \\le 10^9$，$1 \\le p_i \\le n$。保证 $p$ 互不相同，且 $\\max(h_i) > t$。\n\n---\n    \n#### 提示\n\n显然你可以将所有位置都作为飞行点，然后在第 1 时刻让所有夜雀都飞到一棵 $h_i > t$ 的树来得到一组答案为 $n$ 的合法解。因此本题不会存在无解情况。", "locale": "zh-CN"}}}
