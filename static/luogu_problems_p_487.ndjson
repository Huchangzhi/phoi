{"pid": "P10877", "type": "P", "difficulty": 3, "samples": [["2\n2\n01\n30\n101001001010100110101101011110\n", "1\n75497471\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "数学", "2024", "洛谷原创", "O2优化"], "title": "「KDOI-07」n1gr tS0i", "background": "众所周知，小 T 不喜欢 01 串问题，于是小 R 出了另一个有关 01 串的题目：", "description": "有一个长度为 $n$ 的 $\\tt 01$ 串 $S$，你要对 $S$ 进行 **恰好** $n$ 次操作。每次操作选择 $1 \\leq l \\color{red}< \\color{normal} r \\leq n$，然后你按位翻转 $S_{l\\dots r}$。这里的按位翻转指，$S_{l\\dots r}$ 内所有 $\\tt 0$ 同时变为 $\\tt 1$，且所有 $\\tt 1$ 同时变为 $\\tt 0$。\n\n求 $n$ 次操作后，所有可能不同的 $S$ 的个数。因为答案可能很大，所以请对 $998244353$ 取模。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$ 描述数据组数。对于每组数据：\n\n- 第一行一个整数 $n$。\n- 接下来一行，一个长度为 $n$ 的 $\\tt 01$ 串 $S$。", "outputFormat": "对于每组数据，一行一个整数，表示答案，对 $998244353$ 取模后的结果。", "hint": "### 样例解释\n\n- 对于 $n = 2$，$S = \\tt 01$，我们会发现每次操作只能选择 $l = 1, r = 2$ 即反转整串，因此 $2$ 次操作后只能得到 $\\tt 01$，故答案为 $1$；\n- 对于第二组数据，暂时不能给你一个明确的答复。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\text{Subtask}$ | $n\\le$ | 分数 |\n| :----------: | :----------: | :----------: |\n| $1$ | $4$ | $30$ |\n| $2$ | $10^5$ | $70$ |\n\n对于所有数据，保证 $2 \\leq n \\leq 10^5$，$\\sum n \\leq 10^6$，$1 \\leq T \\leq 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KDOI-07」n1gr tS0i", "background": "众所周知，小 T 不喜欢 01 串问题，于是小 R 出了另一个有关 01 串的题目：", "description": "有一个长度为 $n$ 的 $\\tt 01$ 串 $S$，你要对 $S$ 进行 **恰好** $n$ 次操作。每次操作选择 $1 \\leq l \\color{red}< \\color{normal} r \\leq n$，然后你按位翻转 $S_{l\\dots r}$。这里的按位翻转指，$S_{l\\dots r}$ 内所有 $\\tt 0$ 同时变为 $\\tt 1$，且所有 $\\tt 1$ 同时变为 $\\tt 0$。\n\n求 $n$ 次操作后，所有可能不同的 $S$ 的个数。因为答案可能很大，所以请对 $998244353$ 取模。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$ 描述数据组数。对于每组数据：\n\n- 第一行一个整数 $n$。\n- 接下来一行，一个长度为 $n$ 的 $\\tt 01$ 串 $S$。", "outputFormat": "对于每组数据，一行一个整数，表示答案，对 $998244353$ 取模后的结果。", "hint": "### 样例解释\n\n- 对于 $n = 2$，$S = \\tt 01$，我们会发现每次操作只能选择 $l = 1, r = 2$ 即反转整串，因此 $2$ 次操作后只能得到 $\\tt 01$，故答案为 $1$；\n- 对于第二组数据，暂时不能给你一个明确的答复。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\text{Subtask}$ | $n\\le$ | 分数 |\n| :----------: | :----------: | :----------: |\n| $1$ | $4$ | $30$ |\n| $2$ | $10^5$ | $70$ |\n\n对于所有数据，保证 $2 \\leq n \\leq 10^5$，$\\sum n \\leq 10^6$，$1 \\leq T \\leq 10^4$。", "locale": "zh-CN"}}}
{"pid": "P10878", "type": "P", "difficulty": 4, "samples": [["4 2\n1 2 3 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "洛谷原创", "O2优化"], "title": "[JRKSJ R9] 在相思树下 III", "background": ">我知 \n>\n>再迷恋他也非我能私有\n>\n>就当神爱世人遥远温柔 \n>\n>未必要牵手\n>\n>隔千万光年宇宙献吻 \n>\n>亦真切感受\n>\n>不用 \n>\n>强求 \n>\n>对号入座那虚构", "description": "给你一个长为 $n$ 的序列 $a_{1\\dots n}$，你需要对它进行两种操作共 $n-1$ 次。\n\n对一个长度为 $l$ 的序列 $b_{1\\dots l}$ 进行一次操作将会把序列变为一个长为 $l-1$ 的序列 $c_{1\\dots l-1}$：\n\n- 操作一中，$\\forall i\\in[1,l),c_i=\\max(b_i,b_{i+1})$；\n- 操作二中，$\\forall i\\in[1,l),c_i=\\min(b_i,b_{i+1})$。\n\n给定整数 $m$，你只能进行**至多** $m$ 次操作一。进行 $n-1$ 次操作后序列 $a$ 的长度变为 $1$。你可以任意安排操作的顺序，求最终剩余的数 $a_1$ 的最大值。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数 $a_i$ 表示初始序列。", "outputFormat": "一个整数，代表最终剩余的数的最大可能值。", "hint": "### 样例解释\n\n一种可能的操作顺序是：\n- 进行一次操作一，序列变为 $2,3,3$；\n- 进行一次操作二，序列变为 $2,3$；\n- 进行一次操作一，序列变为 $3$。\n\n显然最终剩余的数不可能大于 $3$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask}$ | $n\\le$ | 特殊性质 | 分数 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ |  | $10$ |  \n| $2$ | $5000$ |  | $30$ |  \n| $3$ | $10^6$ | $\\checkmark$ | $20$ |  \n| $4$ | $10^6$ |  | $40$ |  \n\n特殊性质：保证 $\\forall i\\in[1,n],a_i\\le10$。\n\n对于所有数据，保证 $1\\leq m < n \\leq 10^6$，$1 \\leq a_i \\leq 10^{9}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R9] 在相思树下 III", "background": ">我知 \n>\n>再迷恋他也非我能私有\n>\n>就当神爱世人遥远温柔 \n>\n>未必要牵手\n>\n>隔千万光年宇宙献吻 \n>\n>亦真切感受\n>\n>不用 \n>\n>强求 \n>\n>对号入座那虚构", "description": "给你一个长为 $n$ 的序列 $a_{1\\dots n}$，你需要对它进行两种操作共 $n-1$ 次。\n\n对一个长度为 $l$ 的序列 $b_{1\\dots l}$ 进行一次操作将会把序列变为一个长为 $l-1$ 的序列 $c_{1\\dots l-1}$：\n\n- 操作一中，$\\forall i\\in[1,l),c_i=\\max(b_i,b_{i+1})$；\n- 操作二中，$\\forall i\\in[1,l),c_i=\\min(b_i,b_{i+1})$。\n\n给定整数 $m$，你只能进行**至多** $m$ 次操作一。进行 $n-1$ 次操作后序列 $a$ 的长度变为 $1$。你可以任意安排操作的顺序，求最终剩余的数 $a_1$ 的最大值。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数 $a_i$ 表示初始序列。", "outputFormat": "一个整数，代表最终剩余的数的最大可能值。", "hint": "### 样例解释\n\n一种可能的操作顺序是：\n- 进行一次操作一，序列变为 $2,3,3$；\n- 进行一次操作二，序列变为 $2,3$；\n- 进行一次操作一，序列变为 $3$。\n\n显然最终剩余的数不可能大于 $3$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask}$ | $n\\le$ | 特殊性质 | 分数 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ |  | $10$ |  \n| $2$ | $5000$ |  | $30$ |  \n| $3$ | $10^6$ | $\\checkmark$ | $20$ |  \n| $4$ | $10^6$ |  | $40$ |  \n\n特殊性质：保证 $\\forall i\\in[1,n],a_i\\le10$。\n\n对于所有数据，保证 $1\\leq m < n \\leq 10^6$，$1 \\leq a_i \\leq 10^{9}$。", "locale": "zh-CN"}}}
{"pid": "P10879", "type": "P", "difficulty": 6, "samples": [["3\n1 1\n1 2\n1\n1 3 2", "1 2"], ["5\n1 1\n1 2\n3 3\n2 4\n9\n2 5 497855355\n1 5 840823564\n3 1 295265328\n2 3 457999227\n4 4 235621825\n2 1 86836399\n5 2 800390742\n5 3 869167938\n2 4 269250165", "405260353 409046983 606499796 13504540"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "图论", "2024", "洛谷原创", "O2优化", "动态规划优化", "组合数学", "容斥原理", "期望"], "title": "「KDOI-07」对树链剖分的爱", "background": "楼下说得对，但是 sszcdjr 在 NOI 2024 D2T2 用巧妙做法把我的暴力树剖爆掉了。\n\n楼上说得对，但是树链剖分把我送上 10√ 了，所以我出了这道题以表示我对树链剖分的爱喵。", "description": "给出一棵 $n$ 个节点以 $1$ 为根的有根树。对于第 $2\\leq i\\leq n$ 个节点，其父亲 $f_i$ 在 $[l_i,r_i]$ 中均匀随机。每个树的边有边权，初始为 $0$。\n\n现在有 $m$ 次操作，第 $i$ 次操作表示将 $(u_i,v_i)$ 的路径上所有的边的权值统一加上 $w_i$。$m$ 次操作结束后，对于所有 $i=2\\sim n$，求 $(i,f_i)$ 边上权值的期望，对 $998244353$ 取模。", "inputFormat": "第一行一个正整数表示 $n$。\n\n接下来 $n-1$ 行，其中第 $i$ 行两个正整数表示 $l_{i+1},r_{i+1}$。\n\n接下来一行一个正整数表示 $m$。\n\n接下来 $m$ 行，第 $i$ 行三个正整数表示 $u_i,v_i,w_i$。", "outputFormat": "一行 $n-1$ 个正整数，其中第 $i$ 个表示边 $(i+1,f_{i+1})$ 边权的期望，对 $998244353$ 取模。", "hint": "### 样例解释 1\n\n所有节点的父亲共有 $2$ 种可能的情况：\n\n- $f_2=1,f_3=1$，此时 $(f_2,2),(f_3,3)$ 边上的权值分别是 $0,2$。\n\n- $f_2=1,f_3=2$，此时 $(f_2,2),(f_3,3)$ 边上的权值分别是 $2,2$。\n\n于是边 $(f_2,2)$ 边权的期望为 $\\dfrac{0+2}{2}=1$，边 $(f_3,3)$ 边权的期望为 $\\dfrac{2+2}{2}=2$。\n\n\n---\n### 数据规模与约定\n**本题采用捆绑测试。**\n\n| $\\text{Subtask}$ | $n\\leq$ | $m\\leq$ | 分数 |\n| :-----------: | :-----------: |  :-----------: | :-----------: |\n| $1$ | $10$ | $10$ | $20$ |\n| $2$ | $50$ | $50$ | $20$ |\n| $3$ | $500$ | $500$ | $20$ |\n| $4$ | $5000$ | $1$ | $20$ |\n| $5$ | $5000$ | $5000$ | $20$|\n\n\n对于所有数据，保证 $1\\leq n,m\\leq5000$，$1\\leq l_i\\leq r_i<i$，$1\\leq u_i,v_i\\leq n$，$1\\leq w_i\\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KDOI-07」对树链剖分的爱", "background": "楼下说得对，但是 sszcdjr 在 NOI 2024 D2T2 用巧妙做法把我的暴力树剖爆掉了。\n\n楼上说得对，但是树链剖分把我送上 10√ 了，所以我出了这道题以表示我对树链剖分的爱喵。", "description": "给出一棵 $n$ 个节点以 $1$ 为根的有根树。对于第 $2\\leq i\\leq n$ 个节点，其父亲 $f_i$ 在 $[l_i,r_i]$ 中均匀随机。每个树的边有边权，初始为 $0$。\n\n现在有 $m$ 次操作，第 $i$ 次操作表示将 $(u_i,v_i)$ 的路径上所有的边的权值统一加上 $w_i$。$m$ 次操作结束后，对于所有 $i=2\\sim n$，求 $(i,f_i)$ 边上权值的期望，对 $998244353$ 取模。", "inputFormat": "第一行一个正整数表示 $n$。\n\n接下来 $n-1$ 行，其中第 $i$ 行两个正整数表示 $l_{i+1},r_{i+1}$。\n\n接下来一行一个正整数表示 $m$。\n\n接下来 $m$ 行，第 $i$ 行三个正整数表示 $u_i,v_i,w_i$。", "outputFormat": "一行 $n-1$ 个正整数，其中第 $i$ 个表示边 $(i+1,f_{i+1})$ 边权的期望，对 $998244353$ 取模。", "hint": "### 样例解释 1\n\n所有节点的父亲共有 $2$ 种可能的情况：\n\n- $f_2=1,f_3=1$，此时 $(f_2,2),(f_3,3)$ 边上的权值分别是 $0,2$。\n\n- $f_2=1,f_3=2$，此时 $(f_2,2),(f_3,3)$ 边上的权值分别是 $2,2$。\n\n于是边 $(f_2,2)$ 边权的期望为 $\\dfrac{0+2}{2}=1$，边 $(f_3,3)$ 边权的期望为 $\\dfrac{2+2}{2}=2$。\n\n\n---\n### 数据规模与约定\n**本题采用捆绑测试。**\n\n| $\\text{Subtask}$ | $n\\leq$ | $m\\leq$ | 分数 |\n| :-----------: | :-----------: |  :-----------: | :-----------: |\n| $1$ | $10$ | $10$ | $20$ |\n| $2$ | $50$ | $50$ | $20$ |\n| $3$ | $500$ | $500$ | $20$ |\n| $4$ | $5000$ | $1$ | $20$ |\n| $5$ | $5000$ | $5000$ | $20$|\n\n\n对于所有数据，保证 $1\\leq n,m\\leq5000$，$1\\leq l_i\\leq r_i<i$，$1\\leq u_i,v_i\\leq n$，$1\\leq w_i\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P10880", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 3\n1 2\n1 3\n2 3", "3"], ["10 10\n7 9 4 5 8 3 2 1 6 10 \n3 7\n2 6\n1 2\n3 4\n8 9\n1 2\n2 6\n5 8\n6 9\n4 5", "12"], ["60 30\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 \n34 57\n2 17\n3 16\n18 50\n18 54\n8 45\n8 56\n14 39\n22 33\n12 33\n27 49\n33 33\n9 11\n12 52\n11 17\n23 31\n14 39\n19 57\n25 32\n15 22\n2 48\n14 21\n51 59\n28 48\n26 31\n31 60\n41 58\n36 46\n49 53\n44 48", "328034228"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2024", "洛谷原创", "O2优化", "排序"], "title": "[JRKSJ R9] 莫队的 1.5 近似构造", "background": "二维莫队构造可以看作 $i,j$ 之间有权值为 $|l_i-l_j|+|r_i-r_j|$ 的完全图上的 TSP 问题。显然，任何莫队的边权都满足三角不等式。\n\n求出最小生成树，然后把所有度数为奇数的点拿出来，对这个导出子图跑最小权匹配得到 $E$，将 $E$ 加到最小生成树上，然后跑欧拉路径即可。\n\n 注意到 $\\text{MST}(S)\\le \\text{TSP}(S)$，$2E\\le \\text{TSP}(S)$（$E$ 的 $\\text{TSP}$ 方案可以给出两组匹配，考虑其中的较小值）且欧拉路径的边权和不小于欧拉路径给出的方案的权值，就给出了 $\\le 1.5\\text{TSP}(S)$ 的结果。", "description": "给你一个 $1\\sim n$ 的排列 $a$ 和 $m$ 个该排列上的区间 $[l_i,r_i]$。\n\n对于一个值域区间 $[L,R]$：\n- 称「选取 $i$ 时该值域区间的价值」为 $a_{l_i},a_{l_i+1},\\dots,a_{r_i}$ 中有多少个数属于值域区间 $[L,R]$；\n- 定义值域区间 $[L,R]$ 的价值为 $\\forall i\\in[1,m]$，「选取 $i$ 时该值域区间的价值」的最大值。\n\n即，值域区间 $[L,R]$ 的价值为 $\\displaystyle\\max_{i=1}^m \\sum_{j=l_i}^{r_i} [L\\le a_j\\le R]$。\n\n定义两个区间相交当且仅当至少有一个整数被这两个区间共同包含。请你选出若干个**互不相交**的值域区间，使得它们的价值的乘积最大。将该答案对 $998244353$ 取模后输出。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示 $a_{1\\dots n}$。\n\n下面 $m$ 行，每行两个整数 $l_i,r_i$。", "outputFormat": "一个整数表示答案。输出答案时对 $998244353$ 取模。", "hint": "### 样例解释 1\n\n选择值域区间 $[1,3]$。\n\n### 样例解释 2\n\n可以选择值域区间 $[1,3],[4,5],[8,10]$。\n\n### 样例解释 3\n\n样例 3 满足特殊性质。\n\n### 数据规模与约定\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask}$ | $n,m\\le$ | 特殊性质 | 分数 |\n| :-----: | :-----: | :-----: | :-----: |\n| $1$ | $20$ |  | $10$ |\n| $2$ | $5\\times 10^3$ |  | $15$ |\n| $3$ | $3\\times 10^5$ | $\\checkmark$ | $10$ |\n| $4$ | $5\\times 10^4$ |  | $25$ |\n| $5$ | $3\\times 10^5$ |  | $40$ |\n\n特殊性质：保证 $\\forall i\\in[1,n],a_i=i$。\n\n对于所有数据，保证 $1\\le n,m\\le 3\\times 10^5$，$1\\le l_i\\le r_i\\le n$，$a$ 是一个 $1\\sim n$ 的排列。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R9] 莫队的 1.5 近似构造", "background": "二维莫队构造可以看作 $i,j$ 之间有权值为 $|l_i-l_j|+|r_i-r_j|$ 的完全图上的 TSP 问题。显然，任何莫队的边权都满足三角不等式。\n\n求出最小生成树，然后把所有度数为奇数的点拿出来，对这个导出子图跑最小权匹配得到 $E$，将 $E$ 加到最小生成树上，然后跑欧拉路径即可。\n\n 注意到 $\\text{MST}(S)\\le \\text{TSP}(S)$，$2E\\le \\text{TSP}(S)$（$E$ 的 $\\text{TSP}$ 方案可以给出两组匹配，考虑其中的较小值）且欧拉路径的边权和不小于欧拉路径给出的方案的权值，就给出了 $\\le 1.5\\text{TSP}(S)$ 的结果。", "description": "给你一个 $1\\sim n$ 的排列 $a$ 和 $m$ 个该排列上的区间 $[l_i,r_i]$。\n\n对于一个值域区间 $[L,R]$：\n- 称「选取 $i$ 时该值域区间的价值」为 $a_{l_i},a_{l_i+1},\\dots,a_{r_i}$ 中有多少个数属于值域区间 $[L,R]$；\n- 定义值域区间 $[L,R]$ 的价值为 $\\forall i\\in[1,m]$，「选取 $i$ 时该值域区间的价值」的最大值。\n\n即，值域区间 $[L,R]$ 的价值为 $\\displaystyle\\max_{i=1}^m \\sum_{j=l_i}^{r_i} [L\\le a_j\\le R]$。\n\n定义两个区间相交当且仅当至少有一个整数被这两个区间共同包含。请你选出若干个**互不相交**的值域区间，使得它们的价值的乘积最大。将该答案对 $998244353$ 取模后输出。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示 $a_{1\\dots n}$。\n\n下面 $m$ 行，每行两个整数 $l_i,r_i$。", "outputFormat": "一个整数表示答案。输出答案时对 $998244353$ 取模。", "hint": "### 样例解释 1\n\n选择值域区间 $[1,3]$。\n\n### 样例解释 2\n\n可以选择值域区间 $[1,3],[4,5],[8,10]$。\n\n### 样例解释 3\n\n样例 3 满足特殊性质。\n\n### 数据规模与约定\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask}$ | $n,m\\le$ | 特殊性质 | 分数 |\n| :-----: | :-----: | :-----: | :-----: |\n| $1$ | $20$ |  | $10$ |\n| $2$ | $5\\times 10^3$ |  | $15$ |\n| $3$ | $3\\times 10^5$ | $\\checkmark$ | $10$ |\n| $4$ | $5\\times 10^4$ |  | $25$ |\n| $5$ | $3\\times 10^5$ |  | $40$ |\n\n特殊性质：保证 $\\forall i\\in[1,n],a_i=i$。\n\n对于所有数据，保证 $1\\le n,m\\le 3\\times 10^5$，$1\\le l_i\\le r_i\\le n$，$a$ 是一个 $1\\sim n$ 的排列。", "locale": "zh-CN"}}}
{"pid": "P10881", "type": "P", "difficulty": 7, "samples": [["3\n1 2 3", "60"], ["4\n1 2 3 4", "8629"], ["7\n1 9 1 9 8 1 0", "311816897"], ["16\n2 0 0 9 0 2 2 8 2 0 0 9 0 8 1 5", "871736512"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["动态规划 DP", "2024", "洛谷原创", "O2优化", "组合数学", "线性代数"], "title": "「KDOI-07」能量场", "background": "4202 年，小 K 作为一名已经工作了 3143 天的 gaLaxy enGineer Master，在 XS41 星系的 OIPA115 星球上建立了据点，帮助人类探索未知。在这里，他建起了一些能量场。原本他决定使用一些卒来运输能量，然而在他操控的两个红色卒碰撞并损失所有能量后决定还是应该使用能量管道连接他们，~~并使能量管道呈 $(180+\\mathrm{eps})^\\circ$ 角~~。", "description": "小 K 有 $n$ 个能量场，第 $i$ 个能量场存储 $a_i$ 点能量。\n\n小 K 在能量场之间建立了 $n$ 条不同的双向能量管道，使得能量场两两连通。\n\n对于一条能量管道，它的能量级为两端能量场能量之和。\n\n小 K 对一组 $n$ 个不同能量管道集合的满意度是所有能量管道能量级的乘积。\n\n现在小 K 想知道，对于所有不同的合法的搭建能量管道的方式，满意度的总和是多少。由于小 K 的满意度是一个 $[0,998244353)$ 之间的整数，所以你只需要输出满意度总和对 $998244353$ 取模后的值即可。\n\n两种搭建管道的方式是不同的当且仅当存在至少一条管道连接能量场 $i,j$，且恰好在其中一种搭建管道的方式中出现。\n\n---\n\n**【形式化题意】**\n\n有一个 $n$ 个点的完全图 $G(V,E)$。每个点有点权 $a_i$。$i,j$ 两点之间的边权 $w_{i,j}=a_i+a_j$。\n\n定义一个连通子图 $G'(V,E')$ 使得 $E'\\in E$ 的权值为 $\\prod_{e\\in E'}w_e$。注意，子图的点集是全集。\n\n求 $G(V,E)$ 的连通子图中所有基环树的权值和，对 $998244353$ 取模。\n\n基环树要求无重边无自环。", "inputFormat": "第一行一个正整数 $n$，表示能量场数量。\n\n第二行 $n$ 个非负整数 $a_i$，表示第 $i$ 个能量场存储的能量。", "outputFormat": "一行，一个非负整数，表示对于所有不同搭建能量管道的方式，满意度的总和，对 $998244353$ 取模。", "hint": "### 样例解释 1\n\n可能的基环树形态只有包含三个点的环，环边 $(1,2),(1,3),(2,3)$ 的边权分别是 $3,4,5$，乘积为 $60$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask}$ | $n\\leq$ | 特殊性质 | 分数 |\n|:--:|:--:|:--:|:--:|\n| $1$ | $3$ |  | $1$ |\n| $2$ | $7$ |  | $4$ |\n| $3$ | $24$ | $\\checkmark$ | $5$ |\n| $4$ | $12$ |  | $10$ |\n| $5$ | $18$ |  | $10$ |\n| $6$ | $20$ |  | $5$ |\n| $7$ | $23$ |  | $5$ |\n| $8$ | $24$ |  | $30$ |\n| $9$ | $50$ |  | $15$ |\n| $10$ | $200$ |  | $5$ |\n| $11$ | $500$ |  | $5$ |\n| $12$ | $1000$ |  | $5$ |\n\n特殊性质：保证 $\\forall i\\in[1,n],a_i=499122177$。\n\n对于所有数据，保证 $3\\leq n\\leq 1000$，$0\\leq a_i<998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KDOI-07」能量场", "background": "4202 年，小 K 作为一名已经工作了 3143 天的 gaLaxy enGineer Master，在 XS41 星系的 OIPA115 星球上建立了据点，帮助人类探索未知。在这里，他建起了一些能量场。原本他决定使用一些卒来运输能量，然而在他操控的两个红色卒碰撞并损失所有能量后决定还是应该使用能量管道连接他们，~~并使能量管道呈 $(180+\\mathrm{eps})^\\circ$ 角~~。", "description": "小 K 有 $n$ 个能量场，第 $i$ 个能量场存储 $a_i$ 点能量。\n\n小 K 在能量场之间建立了 $n$ 条不同的双向能量管道，使得能量场两两连通。\n\n对于一条能量管道，它的能量级为两端能量场能量之和。\n\n小 K 对一组 $n$ 个不同能量管道集合的满意度是所有能量管道能量级的乘积。\n\n现在小 K 想知道，对于所有不同的合法的搭建能量管道的方式，满意度的总和是多少。由于小 K 的满意度是一个 $[0,998244353)$ 之间的整数，所以你只需要输出满意度总和对 $998244353$ 取模后的值即可。\n\n两种搭建管道的方式是不同的当且仅当存在至少一条管道连接能量场 $i,j$，且恰好在其中一种搭建管道的方式中出现。\n\n---\n\n**【形式化题意】**\n\n有一个 $n$ 个点的完全图 $G(V,E)$。每个点有点权 $a_i$。$i,j$ 两点之间的边权 $w_{i,j}=a_i+a_j$。\n\n定义一个连通子图 $G'(V,E')$ 使得 $E'\\in E$ 的权值为 $\\prod_{e\\in E'}w_e$。注意，子图的点集是全集。\n\n求 $G(V,E)$ 的连通子图中所有基环树的权值和，对 $998244353$ 取模。\n\n基环树要求无重边无自环。", "inputFormat": "第一行一个正整数 $n$，表示能量场数量。\n\n第二行 $n$ 个非负整数 $a_i$，表示第 $i$ 个能量场存储的能量。", "outputFormat": "一行，一个非负整数，表示对于所有不同搭建能量管道的方式，满意度的总和，对 $998244353$ 取模。", "hint": "### 样例解释 1\n\n可能的基环树形态只有包含三个点的环，环边 $(1,2),(1,3),(2,3)$ 的边权分别是 $3,4,5$，乘积为 $60$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask}$ | $n\\leq$ | 特殊性质 | 分数 |\n|:--:|:--:|:--:|:--:|\n| $1$ | $3$ |  | $1$ |\n| $2$ | $7$ |  | $4$ |\n| $3$ | $24$ | $\\checkmark$ | $5$ |\n| $4$ | $12$ |  | $10$ |\n| $5$ | $18$ |  | $10$ |\n| $6$ | $20$ |  | $5$ |\n| $7$ | $23$ |  | $5$ |\n| $8$ | $24$ |  | $30$ |\n| $9$ | $50$ |  | $15$ |\n| $10$ | $200$ |  | $5$ |\n| $11$ | $500$ |  | $5$ |\n| $12$ | $1000$ |  | $5$ |\n\n特殊性质：保证 $\\forall i\\in[1,n],a_i=499122177$。\n\n对于所有数据，保证 $3\\leq n\\leq 1000$，$0\\leq a_i<998244353$。", "locale": "zh-CN"}}}
{"pid": "P10882", "type": "P", "difficulty": 7, "samples": [["7 6\n3 11 1 5 12 19 10\n1 1\n3 5\n2 5\n1 7\n2 6\n1 4", "yumi!\nyumi!\n28\n24\n28\nyumi!"], ["20 20\n26 17 11 89 56 33 72 73 43 77 80 87 97 17 43 74 72 91 49 69\n10 19\n2 4\n3 5\n2 11\n1 12\n10 19\n3 5\n8 15\n8 12\n14 20\n5 11\n13 18\n2 18\n17 19\n1 9\n5 8\n9 12\n1 11\n4 13\n3 18", "109\nyumi!\nyumi!\n87\n54\n109\nyumi!\n103\n193\n109\n132\n163\n45\n212\n54\n161\n200\n54\n132\n87"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2024", "洛谷原创", "O2优化"], "title": "[JRKSJ R9] ZYPRESSEN", "background": "大气层越发清澈澄明\\\n无声的丝柏冲天而立\n\n![](https://s41.ax1x.com/2026/01/26/pZ2z24J.png)\n\n耀眼的大气下\\\n哀怨依然青深\\\n柏木静静摇曳\\\n鸟儿再次划破青空\\\n此处已无真心话语\\\n阿修罗泪如雨落土", "description": "已经完全是秋季了。\n\n即使如此，丝柏（ZYPRESSEN）也是一如既往的黢黑吧。\n\n给你一个长度为 $n$ 的序列 $a$，共有 $q$ 次询问，每次询问如下：\n\n* 给你一个区间 $[l,r]$，对于所有的 $i,j,k$ 满足 $l\\le i<j<k\\le r$ 且三边长度分别为 $a_i,a_j,a_k$ 的三角形存在，你需要求出 $a_i+a_j+a_k$ 的最小值。\n\n三边长度分别为 $a,b,c(a\\le b\\le c)$ 时，能构成三角形当且仅当 $a+b>c$。", "inputFormat": "第一行两个整数 $n,q$。\n\n第二行 $n$ 个整数 $a_{1\\dots n}$。\n\n接下来 $q$ 行，每行两个整数 $l,r$ 表示询问。", "outputFormat": "$q$ 行，每行一个整数表示答案。如果不存在符合条件的 $i,j,k$，输出 `yumi!`。", "hint": "### 样例解释 1\n\n对于区间 $[3,5]$，因为 $1+5<12$，所以不存在合法的三角形。\n\n对于区间 $[2,5]$ 和 $[2,6]$，选取 $a_i=11,a_j=5,a_k=12$。\n\n对于区间 $[1,7]$，选取 $a_i=3,a_j=11,a_k=10$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask}$ | $n\\le$ | $q\\le$ | 特殊性质 |分数 | \n| :-----: | :-----: | :-----: | :-----: | :-----: | \n| $1$ | $5\\times 10^3$ | $5\\times 10^3$ | |$10$ | \n| $2$ | $5\\times 10^4$ | $5\\times 10^4$ | |$25$ | \n| $3$ | $2.5\\times 10^5$ | $5\\times 10^5$ | $\\checkmark$|$10$ | \n| $4$ | $2.5\\times 10^5$ | $5\\times 10^5$ | |$55$ | \n\n特殊性质：保证 $a_i$ 在范围内等概率随机生成。\n\n对于所有数据，保证 $1\\le n\\le 2.5\\times 10^5$，$1\\le q\\le 5\\times 10^5$，$1\\le a_i\\le 10^7$，$1\\le l\\le r\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R9] ZYPRESSEN", "background": "大气层越发清澈澄明\\\n无声的丝柏冲天而立\n\n![](https://s41.ax1x.com/2026/01/26/pZ2z24J.png)\n\n耀眼的大气下\\\n哀怨依然青深\\\n柏木静静摇曳\\\n鸟儿再次划破青空\\\n此处已无真心话语\\\n阿修罗泪如雨落土", "description": "已经完全是秋季了。\n\n即使如此，丝柏（ZYPRESSEN）也是一如既往的黢黑吧。\n\n给你一个长度为 $n$ 的序列 $a$，共有 $q$ 次询问，每次询问如下：\n\n* 给你一个区间 $[l,r]$，对于所有的 $i,j,k$ 满足 $l\\le i<j<k\\le r$ 且三边长度分别为 $a_i,a_j,a_k$ 的三角形存在，你需要求出 $a_i+a_j+a_k$ 的最小值。\n\n三边长度分别为 $a,b,c(a\\le b\\le c)$ 时，能构成三角形当且仅当 $a+b>c$。", "inputFormat": "第一行两个整数 $n,q$。\n\n第二行 $n$ 个整数 $a_{1\\dots n}$。\n\n接下来 $q$ 行，每行两个整数 $l,r$ 表示询问。", "outputFormat": "$q$ 行，每行一个整数表示答案。如果不存在符合条件的 $i,j,k$，输出 `yumi!`。", "hint": "### 样例解释 1\n\n对于区间 $[3,5]$，因为 $1+5<12$，所以不存在合法的三角形。\n\n对于区间 $[2,5]$ 和 $[2,6]$，选取 $a_i=11,a_j=5,a_k=12$。\n\n对于区间 $[1,7]$，选取 $a_i=3,a_j=11,a_k=10$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n| $\\mathrm{Subtask}$ | $n\\le$ | $q\\le$ | 特殊性质 |分数 | \n| :-----: | :-----: | :-----: | :-----: | :-----: | \n| $1$ | $5\\times 10^3$ | $5\\times 10^3$ | |$10$ | \n| $2$ | $5\\times 10^4$ | $5\\times 10^4$ | |$25$ | \n| $3$ | $2.5\\times 10^5$ | $5\\times 10^5$ | $\\checkmark$|$10$ | \n| $4$ | $2.5\\times 10^5$ | $5\\times 10^5$ | |$55$ | \n\n特殊性质：保证 $a_i$ 在范围内等概率随机生成。\n\n对于所有数据，保证 $1\\le n\\le 2.5\\times 10^5$，$1\\le q\\le 5\\times 10^5$，$1\\le a_i\\le 10^7$，$1\\le l\\le r\\le n$。", "locale": "zh-CN"}}}
{"pid": "P10883", "type": "P", "difficulty": 4, "samples": [["4\n3 2 1 4", "3 1"], ["2\n1 2", "1 1"], ["7\n3 6 5 7 4 1 2 ", "3 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #2] Doktor", "background": "搬运自 [COCI 2017/2018 Contest #2](https://hsin.hr/coci/archive/2017_2018/) T3「Doktor」，[原题题面](https://hsin.hr/coci/archive/2017_2018/contest2_tasks.pdf)。\n\nSpecial Judge 由搬题人提供，如果有锅请私信，谢谢。", "description": "> And the Mrs, Ms, says:\n>\n>\"I've been riding horses for fifteen years, and it is impossible to shoe a horse upside down!\"\n>\n> (…)\n\n\"Yes, that's upside down\" - whispers Domagoj, looking at Mate's hand while playing, for the purposes of this task, a heavily modified version of the card game Hanabi. For the sake of simplicity, Mate is holding $N$ cards in his hands, numbered from $1,2,\\dots,N$\n in a certain order. (Each number from $1$ to $N$\nappears exactly once.) As when playing the real game, he cannot voluntarily change the card order.\n\nJust so the task is at least somewhat related to the story, Domagoj will point for Mate to a contiguous subarray of cards. (He can point to a single card too, but he will point to at least one card.) Mate will then \"rotate\" that contiguous subarray and put it back.\n\n(The rotating can be thought of as taking all the cards in the given subarray and rotating all of them for 180 degrees. This means that the first and last card swap places, as well as the second and the second to last card, and so on.)\n\nLike all of us, Domagoj is very fond of fixed points. In other words, cards whose numbers match their position in hand, counting from Domagoj's left side. Therefore, he'd like the number of fixed points to be as great as possible after rotating the given subarray.\n\nHelp Domagoj find out which contiguous subarray he needs to point out so that the number of fixed points in Mate's hand after rotating that subarray is maximal.", "inputFormat": " The first line of input contains the positive integer $N (1 \\leq N \\leq 500000)$, the number of cards in Mate's hand.\n \n The following line contains the numbers on the cards in Mate's hand in the order that Domagoj sees them.", "outputFormat": " You must output a single line containing $A$ and \n$B$, the numbers on the cards that are the beginning and the end of the required contiguous subarray, in that order. If there are multiple options, output any of them.", "hint": "In the first test case, after rotating the contiguous subarray that starts with 3 and ends with 1, the cards will be ordered 1 2 3 4, and now all the cards are fixed points. In this example, the given output is the only correct output.\n\n In the second test case, rotating any subarray consisting of only one card results with the same card order, the one that produces the maximal number of fixed points.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #2] Doktor", "background": "搬运自 [COCI 2017/2018 Contest #2](https://hsin.hr/coci/archive/2017_2018/) T3「Doktor」，[原题题面](https://hsin.hr/coci/archive/2017_2018/contest2_tasks.pdf)。\n\nSpecial Judge 由搬题人提供，如果有锅请私信，谢谢。", "description": "> And the Mrs, Ms, says:\n>\n>\"I've been riding horses for fifteen years, and it is impossible to shoe a horse upside down!\"\n>\n> (…)\n\n\"Yes, that's upside down\" - whispers Domagoj, looking at Mate's hand while playing, for the purposes of this task, a heavily modified version of the card game Hanabi. For the sake of simplicity, Mate is holding $N$ cards in his hands, numbered from $1,2,\\dots,N$\n in a certain order. (Each number from $1$ to $N$\nappears exactly once.) As when playing the real game, he cannot voluntarily change the card order.\n\nJust so the task is at least somewhat related to the story, Domagoj will point for Mate to a contiguous subarray of cards. (He can point to a single card too, but he will point to at least one card.) Mate will then \"rotate\" that contiguous subarray and put it back.\n\n(The rotating can be thought of as taking all the cards in the given subarray and rotating all of them for 180 degrees. This means that the first and last card swap places, as well as the second and the second to last card, and so on.)\n\nLike all of us, Domagoj is very fond of fixed points. In other words, cards whose numbers match their position in hand, counting from Domagoj's left side. Therefore, he'd like the number of fixed points to be as great as possible after rotating the given subarray.\n\nHelp Domagoj find out which contiguous subarray he needs to point out so that the number of fixed points in Mate's hand after rotating that subarray is maximal.", "inputFormat": " The first line of input contains the positive integer $N (1 \\leq N \\leq 500000)$, the number of cards in Mate's hand.\n \n The following line contains the numbers on the cards in Mate's hand in the order that Domagoj sees them.", "outputFormat": " You must output a single line containing $A$ and \n$B$, the numbers on the cards that are the beginning and the end of the required contiguous subarray, in that order. If there are multiple options, output any of them.", "hint": "In the first test case, after rotating the contiguous subarray that starts with 3 and ends with 1, the cards will be ordered 1 2 3 4, and now all the cards are fixed points. In this example, the given output is the only correct output.\n\n In the second test case, rotating any subarray consisting of only one card results with the same card order, the one that produces the maximal number of fixed points.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #2] Doktor", "background": "", "description": "> 夫人说：\n>\n>「我已经骑马十五年了，不可能把马倒着钉蹄铁！」\n>\n> （……）\n\n「是的，那是倒着的。」——多马戈伊低声说道，看着马特的手，正在玩一个经过大幅修改的纸牌游戏 Hanabi。为了简单起见，马特手中有 $N$ 张牌，按顺序编号为 $1, 2, \\dots, N$。\n每个数字从 $1$ 到 $N$ 恰好出现一次。就像玩真正的游戏一样，他不能主动改变牌的顺序。\n\n为了让任务至少与故事有些关联，多马戈伊会指向马特手中一段连续的牌子序列。（他也可以指向单张牌，但至少会指向一张牌。）然后马特将「旋转」该连续子数组并放回去。\n\n（旋转可以被认为是将给定子数组中的所有牌旋转 180 度。这意味着第一张和最后一张牌交换位置，第二张和倒数第二张牌交换位置，依此类推。）\n\n和我们所有人一样，多马戈伊非常喜欢不动点。换句话说，就是牌的数字与它们在手中的位置相匹配的牌，从多马戈伊的左侧开始计数。因此，他希望在旋转给定子数组后，不动点的数量尽可能多。\n\n帮助多马戈伊找出他需要指出哪一段连续子数组，以便在旋转该子数组后，马特手中的不动点数量达到最大。", "inputFormat": "输入的第一行包含正整数 $N (1 \\leq N \\leq 500000)$，表示马特手中的牌数。\n\n接下来的行包含多马戈伊看到的马特手中牌的顺序。", "outputFormat": "你必须输出一行，包含 $A$ 和 $B$，即所需连续子数组的起始和结束牌上的数字，按此顺序。如果有多个选项，输出其中任意一个。", "hint": "在第一个测试用例中，旋转从 3 开始到 1 结束的连续子数组后，牌的顺序将变为 1 2 3 4，现在所有的牌都是不动点。在这个例子中，给定的输出是唯一正确的输出。\n\n在第二个测试用例中，旋转任何仅包含一张牌的子数组会导致相同的牌顺序，这种顺序产生最大数量的不动点。（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P10884", "type": "P", "difficulty": 5, "samples": [["4 6\n2 1\n6 3\n7 2\n5 6", "3"], ["2 7\n4 6\n3 5", "0"], ["4 15\n5 5\n5 12\n6 10\n2 1", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #2] San", "background": "搬运自 [COCI 2017/2018 Contest #2](https://hsin.hr/coci/archive/2017_2018/) T4「San」，[原题题面](https://hsin.hr/coci/archive/2017_2018/contest2_tasks.pdf)。\n\n根据原题，时间限制 1 秒，空间限制 64 MB，满分 120 分。", "description": "Have you ever dreamt that you were the main character in a computer game? The protagonist of this story, Branimir, is having that dream right now.\n\nThe world in Branimir's dream consists of $N$ skyscrapers ordered from left to right. For the $i^{th}$ skyscraper, we know the height $H_i$ and the number of gold coins $G_i$ on the roof of the skyscraper. The game begins with a jump on any of the skyscrapers and consists of several steps. In each step, Branimir can jump on a skyscraper to the right from the one he's currently on (it is possible for him to jump over a couple of them too) and if it is not lower than the current one. On each skyscraper roof he's on, Branimir will collect all the gold coins. Branimir can end the game after any number of steps (zero as well), but he must collect at least $K$ gold coins in order to advance to the next level.\n\nBranimir wants to know the number of different ways for him to play the game in order to advance to the next level. Two games are played in different ways if there is a skyscraper that was visited in one game, and not in the other.", "inputFormat": "The first line of input contains positive integers $N(1\\leq N \\leq 40)$ and $K(1\\leq K\\leq 4\\times 10^{10}$), the numbers from the task.\n\nThe $i^{th}$ of the following \n$N$ lines contains two positive integers, $H_i$ and $G_i(1\\leq H_i,G_i \\leq 10^9$), the numbers from the task.", "outputFormat": "You must output the number of different ways to play the game from the task.", "hint": "#### Explanation for Sample Output 1\n\nThe following three games will take Branimir to the next level (the numbers represent the labels of the skyscrapers he visited): {1, 2, 3}, {1, 4} and {4}.\n\n#### Scoring\n\nIn test cases worth 40% of total points, it will hold \n$N\\leq 20$.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #2] San", "background": "搬运自 [COCI 2017/2018 Contest #2](https://hsin.hr/coci/archive/2017_2018/) T4「San」，[原题题面](https://hsin.hr/coci/archive/2017_2018/contest2_tasks.pdf)。\n\n根据原题，时间限制 1 秒，空间限制 64 MB，满分 120 分。", "description": "Have you ever dreamt that you were the main character in a computer game? The protagonist of this story, Branimir, is having that dream right now.\n\nThe world in Branimir's dream consists of $N$ skyscrapers ordered from left to right. For the $i^{th}$ skyscraper, we know the height $H_i$ and the number of gold coins $G_i$ on the roof of the skyscraper. The game begins with a jump on any of the skyscrapers and consists of several steps. In each step, Branimir can jump on a skyscraper to the right from the one he's currently on (it is possible for him to jump over a couple of them too) and if it is not lower than the current one. On each skyscraper roof he's on, Branimir will collect all the gold coins. Branimir can end the game after any number of steps (zero as well), but he must collect at least $K$ gold coins in order to advance to the next level.\n\nBranimir wants to know the number of different ways for him to play the game in order to advance to the next level. Two games are played in different ways if there is a skyscraper that was visited in one game, and not in the other.", "inputFormat": "The first line of input contains positive integers $N(1\\leq N \\leq 40)$ and $K(1\\leq K\\leq 4\\times 10^{10}$), the numbers from the task.\n\nThe $i^{th}$ of the following \n$N$ lines contains two positive integers, $H_i$ and $G_i(1\\leq H_i,G_i \\leq 10^9$), the numbers from the task.", "outputFormat": "You must output the number of different ways to play the game from the task.", "hint": "#### Explanation for Sample Output 1\n\nThe following three games will take Branimir to the next level (the numbers represent the labels of the skyscrapers he visited): {1, 2, 3}, {1, 4} and {4}.\n\n#### Scoring\n\nIn test cases worth 40% of total points, it will hold \n$N\\leq 20$.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #2] San", "background": "", "description": "你是否曾经梦见自己是电脑游戏中的主角？这个故事的主角 Branimir 正在做这样的梦。\n\n在 Branimir 的梦中，世界由 $N$ 座从左到右排列的摩天大楼组成。对于第 $i$ 座摩天大楼，我们知道其高度 $H_i$ 和屋顶上的金币数量 $G_i$。游戏开始时，可以跳到任意一座摩天大楼上，并由此开始多个步骤。在每一步中，Branimir 可以跳到右边的一座摩天大楼上（也可以跳过几座），但前提是它的高度不低于当前所在的摩天大楼。在每座摩天大楼的屋顶上，Branimir 将收集所有的金币。Branimir 可以在任意步数后结束游戏（包括零步），但他必须至少收集 $K$ 个金币才能晋级到下一个关卡。\n\nBranimir 想知道有多少种不同的方式可以玩这个游戏以晋级到下一个关卡。如果在一个游戏中访问了某座摩天大楼，而在另一个游戏中没有访问，则这两个游戏的玩法不同。", "inputFormat": "输入的第一行包含正整数 $N(1\\leq N \\leq 40)$ 和 $K(1\\leq K\\leq 4\\times 10^{10})$，这些是题目中的数字。\n\n接下来的 $N$ 行中的第 $i$ 行包含两个正整数 $H_i$ 和 $G_i(1\\leq H_i,G_i \\leq 10^9)$，这些是题目中的数字。", "outputFormat": "你必须输出完成题目所述游戏的不同方式的数量。", "hint": "#### 示例输出 1 的解释\n\n以下三种游戏方式可以让 Branimir 晋级到下一个关卡（数字表示他访问的摩天大楼的编号）：{1, 2, 3}，{1, 4} 和 {4}。\n\n#### 评分\n\n在总分的 40% 的测试用例中，将满足 $N\\leq 20$。（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P10885", "type": "P", "difficulty": 3, "samples": [["2\n4\n1 3 2 4\n5\n1 5 3 2 4", "3\n3"], ["4\n6\n2 1 4 3 6 5\n6\n1 2 3 4 5 6\n3\n1 3 2\n1\n1", "2\n5\n2\n0"], ["6\n2\n1 2\n20\n16 2 10 18 4 6 8 20 14 12 3 9 17 13 1 15 7 11 19 5\n9\n3 4 1 5 2 6 7 8 9\n10\n1 3 2 4 7 6 5 8 10 9\n13\n5 7 3 11 1 9 13 6 10 4 2 8 12\n5\n1 2 3 4 5", "1\n1\n4\n5\n1\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["梦熊比赛"], "title": "【MX-S3-T1】「FeOI Round 1」野心", "background": "原题链接：<https://oier.team/problems/S3A>。\n\n---\n\n![](bilibili:BV1eZ4y1w7n1)", "description": "给出一个 $1 \\sim n$ 的排列 $p$，询问存在多少个数 $i$（$1 \\le i <n$）满足 $[p_1,p_2,\\cdots,p_i]$ 和 $[p_{i+1},p_{i+2},\\cdots,p_n]$ 排序后都是等差数列。", "inputFormat": "**本题单个测试点内包含多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。\n\n接下来，对于每组数据，格式如下：\n\n第一行一个数 $n$ 表示排列长度。\n\n接下来一行 $n$ 个数表示排列 $p$。", "outputFormat": "对于每组测试数据，输出一行一个数表示询问的答案。", "hint": "**【样例解释 #1】**\n\n第一组：三种拆分为 $[1,3,2][4]$，$[1,3][2,4]$，$[1][3,2,4]$。\n\n第二组：三种拆分为 $[1][5,3,2,4]$，$[1,5][3,2,4]$，$[1,5,3][2,4]$。\n\n**【样例解释 #2】**\n\n第一组：两种拆分为 $[2,1][4,3,6,5]$，$[2,1,4,3][6,5]$。\n\n第二组：每种拆分都是合法的。\n\n第三组：每种拆分都是合法的。\n\n第四组：不存在拆分方案，故没有方案合法。\n\n**【数据范围】**\n\n**本题开启捆绑测试。**\n\n设 $\\sum n$ 为单个测试点内所有的 $n$ 之和。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 10^5$，$1 \\le n \\le 10^6$，$1 \\le \\sum n \\le 2 \\times 10^6$，保证 $p$ 是排列且 $1 \\le p_i \\le n$。\n\n| 子任务编号 | $n $ | $\\sum n $ | 分数 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $\\le 10^3$ | $\\le 5\\times 10^3$ | $30$ |\n| $2$ | $\\le 10^5$ | $\\le 5\\times 10^5$ | $30$ |\n| $3$ | $\\le 10^6$ | $\\le 2\\times 10^6$ | $40$ |\n\n**请使用较快的输入输出方式。**\n\n**新增子任务 4 为 hack 数据，分值为 $\\boldsymbol{0}$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-S3-T1】「FeOI Round 1」野心", "background": "原题链接：<https://oier.team/problems/S3A>。\n\n---\n\n![](bilibili:BV1eZ4y1w7n1)", "description": "给出一个 $1 \\sim n$ 的排列 $p$，询问存在多少个数 $i$（$1 \\le i <n$）满足 $[p_1,p_2,\\cdots,p_i]$ 和 $[p_{i+1},p_{i+2},\\cdots,p_n]$ 排序后都是等差数列。", "inputFormat": "**本题单个测试点内包含多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。\n\n接下来，对于每组数据，格式如下：\n\n第一行一个数 $n$ 表示排列长度。\n\n接下来一行 $n$ 个数表示排列 $p$。", "outputFormat": "对于每组测试数据，输出一行一个数表示询问的答案。", "hint": "**【样例解释 #1】**\n\n第一组：三种拆分为 $[1,3,2][4]$，$[1,3][2,4]$，$[1][3,2,4]$。\n\n第二组：三种拆分为 $[1][5,3,2,4]$，$[1,5][3,2,4]$，$[1,5,3][2,4]$。\n\n**【样例解释 #2】**\n\n第一组：两种拆分为 $[2,1][4,3,6,5]$，$[2,1,4,3][6,5]$。\n\n第二组：每种拆分都是合法的。\n\n第三组：每种拆分都是合法的。\n\n第四组：不存在拆分方案，故没有方案合法。\n\n**【数据范围】**\n\n**本题开启捆绑测试。**\n\n设 $\\sum n$ 为单个测试点内所有的 $n$ 之和。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 10^5$，$1 \\le n \\le 10^6$，$1 \\le \\sum n \\le 2 \\times 10^6$，保证 $p$ 是排列且 $1 \\le p_i \\le n$。\n\n| 子任务编号 | $n $ | $\\sum n $ | 分数 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $\\le 10^3$ | $\\le 5\\times 10^3$ | $30$ |\n| $2$ | $\\le 10^5$ | $\\le 5\\times 10^5$ | $30$ |\n| $3$ | $\\le 10^6$ | $\\le 2\\times 10^6$ | $40$ |\n\n**请使用较快的输入输出方式。**\n\n**新增子任务 4 为 hack 数据，分值为 $\\boldsymbol{0}$。**", "locale": "zh-CN"}}}
{"pid": "P10886", "type": "P", "difficulty": 4, "samples": [["2 0 1 1 1", "11"], ["9 0 1 0 663", "422994"], ["20 1 0 0 998244353", "560706529"], ["114514 17723 134 1045 233337", "442762986"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数论", "素数判断,质数,筛法", "梦熊比赛"], "title": "【MX-S3-T2】「FeOI Round 1」Journey", "background": "原题链接：<https://oier.team/problems/S3B>。\n\n---\n\n![](bilibili:BV1pv411C7ti)", "description": "小 W 最近正在学习某编程语言。\n\n这个编程语言有个语句如下：\n\n```\nrange(a,b,c)\n```\n\n这个语句表示一个序列，这个序列是这样的：\n\n$$\n[a,a+c,a+2c,\\cdots,a+kc]\n$$\n\n其中，$k$ 是最大的满足 $a+kc<b$ 的非负整数 $k$。例如 `range(1,7,2)` 表示的序列为 $[1,3,5]$。\n\n小 W 想问你一个问题：给你一个长为 $n$ 的序列 $g$（下标从 $1$ 开始），求出下列式子的值，答案模 $10^9 +7$。\n\n$$\n\\sum_{a=1}^{n}\\sum_{b=a+1}^{n+1}\\sum_{c=1}^{n}\\sum\\limits_{i\\in \\mathrm{range}(a,b,c)} g_i\n$$\n\n", "inputFormat": "为了加快读入速度，我们采用以下读入方法。\n\n读入共一行五个非负整数 $n,A,B,C,g_n$。\n\n其中 $n$ 为序列 $g$ 的长度，$A,B,C$ 为生成数据的参数，$g_n$ 为序列 $g$ 的第 $n$ 项。\n\n对于序列 $g$ 的第 $i$（$1\\leq i < n$）项，满足 $g_i \\equiv Ag_{i+1}^2+Bg_{i+1}+C \\pmod {10^9 + 7}$。", "outputFormat": "共一行一个非负整数，为题目中所求的答案。", "hint": "**【样例解释 #1】**\n\n$g=[2,1]$（下标从 $1$ 开始）\n\n令 $ans=\\sum\\limits_{i\\in \\mathrm{range}(a,b,c)} g_i$。\n\n当 $a=1,b=2,c=1$ 时，$ans=2$。\n\n当 $a=1,b=2,c=2$ 时，$ans=2$。\n\n当 $a=1,b=3,c=1$ 时，$ans=2+1=3$。\n\n当 $a=1,b=3,c=2$ 时，$ans=2$。\n\n当 $a=2,b=3,c=1$ 时，$ans=1$。\n\n当 $a=2,b=3,c=2$ 时，$ans=1$。\n\n答案为 $\\sum ans=2+2+3+2+1+1=11$。\n\n**【样例解释 #2】**\n\n该样例满足特殊性质 A。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据：$1\\leq n\\leq 2\\times 10^7$，$0\\leq A,B,C,g_n<10^9 +7$。\n\n| 测试点编号 |       $n=$       | 特殊性质 |\n| :--------: | :--------------: | :------: |\n|    $1$     |       $1$        |    AB    |\n|    $2$     |      $1000$      |    无    |\n|    $3$     |      $1000$      |    无    |\n|    $4$     |      $5000$      |    无    |\n|    $5$     |      $5000$      |    无    |\n|    $6$     |      $10^4$      |    A     |\n|    $7$     |      $10^5$      |    A     |\n|    $8$     |      $10^5$      |    B     |\n|    $9$     |      $10^5$      |    无    |\n|    $10$    |  $2\\times 10^5$  |    A     |\n|    $11$    |  $2\\times 10^5$  |    B     |\n|    $12$    |  $5\\times 10^5$  |    无    |\n|    $13$    |      $10^6$      |    A     |\n|    $14$    |      $10^6$      |    B     |\n|    $15$    |  $2\\times 10^6$  |    无    |\n|    $16$    |  $3\\times 10^6$  |    无    |\n|    $17$    |  $5\\times 10^6$  |    A     |\n|    $18$    |      $10^7$      |    A     |\n|    $19$    |      $10^7$      |    B     |\n|    $20$    | $1.3\\times 10^7$ |    无    |\n|    $21$    | $1.6\\times 10^7$ |    无    |\n|    $22$    |  $2\\times 10^7$  |    A     |\n|    $23$    |  $2\\times 10^7$  |    B     |\n|    $24$    |  $2\\times 10^7$  |    无    |\n|    $25$    |  $2\\times 10^7$  |    无    |\n\n特殊性质 A：保证所有 $g_i$ 相等。\n\n特殊性质 B：保证只有 $g_n\\neq 0$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-S3-T2】「FeOI Round 1」Journey", "background": "原题链接：<https://oier.team/problems/S3B>。\n\n---\n\n![](bilibili:BV1pv411C7ti)", "description": "小 W 最近正在学习某编程语言。\n\n这个编程语言有个语句如下：\n\n```\nrange(a,b,c)\n```\n\n这个语句表示一个序列，这个序列是这样的：\n\n$$\n[a,a+c,a+2c,\\cdots,a+kc]\n$$\n\n其中，$k$ 是最大的满足 $a+kc<b$ 的非负整数 $k$。例如 `range(1,7,2)` 表示的序列为 $[1,3,5]$。\n\n小 W 想问你一个问题：给你一个长为 $n$ 的序列 $g$（下标从 $1$ 开始），求出下列式子的值，答案模 $10^9 +7$。\n\n$$\n\\sum_{a=1}^{n}\\sum_{b=a+1}^{n+1}\\sum_{c=1}^{n}\\sum\\limits_{i\\in \\mathrm{range}(a,b,c)} g_i\n$$\n\n", "inputFormat": "为了加快读入速度，我们采用以下读入方法。\n\n读入共一行五个非负整数 $n,A,B,C,g_n$。\n\n其中 $n$ 为序列 $g$ 的长度，$A,B,C$ 为生成数据的参数，$g_n$ 为序列 $g$ 的第 $n$ 项。\n\n对于序列 $g$ 的第 $i$（$1\\leq i < n$）项，满足 $g_i \\equiv Ag_{i+1}^2+Bg_{i+1}+C \\pmod {10^9 + 7}$。", "outputFormat": "共一行一个非负整数，为题目中所求的答案。", "hint": "**【样例解释 #1】**\n\n$g=[2,1]$（下标从 $1$ 开始）\n\n令 $ans=\\sum\\limits_{i\\in \\mathrm{range}(a,b,c)} g_i$。\n\n当 $a=1,b=2,c=1$ 时，$ans=2$。\n\n当 $a=1,b=2,c=2$ 时，$ans=2$。\n\n当 $a=1,b=3,c=1$ 时，$ans=2+1=3$。\n\n当 $a=1,b=3,c=2$ 时，$ans=2$。\n\n当 $a=2,b=3,c=1$ 时，$ans=1$。\n\n当 $a=2,b=3,c=2$ 时，$ans=1$。\n\n答案为 $\\sum ans=2+2+3+2+1+1=11$。\n\n**【样例解释 #2】**\n\n该样例满足特殊性质 A。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据：$1\\leq n\\leq 2\\times 10^7$，$0\\leq A,B,C,g_n<10^9 +7$。\n\n| 测试点编号 |       $n=$       | 特殊性质 |\n| :--------: | :--------------: | :------: |\n|    $1$     |       $1$        |    AB    |\n|    $2$     |      $1000$      |    无    |\n|    $3$     |      $1000$      |    无    |\n|    $4$     |      $5000$      |    无    |\n|    $5$     |      $5000$      |    无    |\n|    $6$     |      $10^4$      |    A     |\n|    $7$     |      $10^5$      |    A     |\n|    $8$     |      $10^5$      |    B     |\n|    $9$     |      $10^5$      |    无    |\n|    $10$    |  $2\\times 10^5$  |    A     |\n|    $11$    |  $2\\times 10^5$  |    B     |\n|    $12$    |  $5\\times 10^5$  |    无    |\n|    $13$    |      $10^6$      |    A     |\n|    $14$    |      $10^6$      |    B     |\n|    $15$    |  $2\\times 10^6$  |    无    |\n|    $16$    |  $3\\times 10^6$  |    无    |\n|    $17$    |  $5\\times 10^6$  |    A     |\n|    $18$    |      $10^7$      |    A     |\n|    $19$    |      $10^7$      |    B     |\n|    $20$    | $1.3\\times 10^7$ |    无    |\n|    $21$    | $1.6\\times 10^7$ |    无    |\n|    $22$    |  $2\\times 10^7$  |    A     |\n|    $23$    |  $2\\times 10^7$  |    B     |\n|    $24$    |  $2\\times 10^7$  |    无    |\n|    $25$    |  $2\\times 10^7$  |    无    |\n\n特殊性质 A：保证所有 $g_i$ 相等。\n\n特殊性质 B：保证只有 $g_n\\neq 0$。", "locale": "zh-CN"}}}
{"pid": "P10887", "type": "P", "difficulty": 5, "samples": [["2\n3 100\n3\n\n3\n\n4\n\n2\n\n\n\n\n1 0\n2", "\n\n\n^ 1 2\n\n^ 3 6\n\n^ 6 2\n\n!\n5 1\n6 4\n2 3\n\n\n!\n1 2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["交互题", "Special Judge", "O2优化", "梦熊比赛"], "title": "【MX-S3-T3】「FeOI Round 1」再演", "background": "原题链接：<https://oier.team/problems/S3C>。\n\n---\n\n![](bilibili:BV1rx411E7WH)", "description": "**这是一道交互题。**\n\njt 有一个大小为 $n$ 的集合 $S$，集合中每个元素都是一个无序二元整数对 $(x, y)$，保证集合中 $1 \\sim 2n$ 共 $2n$ 个整数每个恰好出现一次。\n\n比如当 $n = 3$ 时，合法的集合 $S$ 可能是 $\\{(1, 5), (2, 3), (4, 6)\\}$。\n\n开始时你只知道 $n$ 而不知道 $S$ 具体是什么。\n\n现在支持一种操作：你可以给出 $i, j$（$1 \\le i, j \\le 2n$），然后 jt 会交换 $i, j$ 在 $S$ 中的位置（如 $i, j$ 在同一个二元组内，或 $i = j$，则什么也不会发生）。\n\n比如，当 $S = \\{(1, 5), (2, 3), (4, 6)\\}$ 时，执行 $i = 2, j = 6$ 后 $S = \\{(1, 5), (6, 3), (4, 2)\\} = \\{(1, 5), (2, 4), (3, 6)\\}$。\n\n在最开始时以及每次操作过后，对于当前的集合 $S$，jt 会告诉你 $res = \\min\\limits_{(x, y) \\in S} \\max(x, y)$。\n\n比如，当 $S = \\{(1, 5), (2, 3), (4, 6)\\}$ 时，$res$ 为 $\\min(\\max(1, 5), \\max(2, 3), \\max(4, 6)) = \\min(5, 3, 6) = 3$。\n\n注意，每次 jt 告诉你 $res$ 之后**不会撤销**你做的操作，即你的操作是持续有效的。\n\n你需要在 $lim$ 次操作内猜出**初始的**集合 $S$，即进行所有交换操作之前的版本。\n\n保证初始的 $S$ 是提前确定的，即**交互库不自适应**。\n\n### 交互方式\n\n**本题单个测试点内包含多组数据。**\n\n首先读入数据组数 $T$。\n\n接下来有 $T$ 组数据，对于每组数据进行以下过程：\n\n输入 $S$ 的大小 $n$ 以及 $lim$ 以开始交互。\n\n每次操作，首先读入 $res$，接下来输出一行 `^ i j` 表示你要执行操作 $i, j$。\n\n在你确定答案后，请先输出一行一个 `!`，然后接下来 $n$ 行每行输出两个整数 `x y` 代表 $S$ 中的一个二元组，然后准备读入下一组数据。你可以以任意顺序输出这些二元组，且二元组内元素顺序可以任意。\n\n每次在你输出一行后，请清空缓冲区：\n\n- 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n- 在 Pascal 中，使用 `flush(output)`。\n- 在 Python 中，使用 `stdout.flush()`。\n- 其它语言请自行查阅文档。\n\n**当你在单个测试点所有测试数据的总操作次数不超过 $\\boldsymbol{2.5 \\times 10^5}$ 次时**，保证交互库占用时间不超过 $1\\operatorname s$，空间不超过 $128\\operatorname{MB}$，也就是你至少能使用 $1 \\operatorname{s}$ 的时间以及 $384\\operatorname{MB}$ 的空间。", "inputFormat": "见「交互方式」。", "outputFormat": "见「交互方式」。", "hint": "**【样例解释】**\n\n注意，样例只是描述了一个可能发生的交互过程，**并不一定存在逻辑**（就是说答案可能是乱猜猜对的）。\n\n对于第一组测试数据，$S$ 最开始为 $\\{(1, 5), (2, 3), (4, 6)\\}$，jt 告诉你 $res = 3$。\n\n接下来你交换 $1, 2$，$S$ 变为 $\\{(2, 5), (1, 3), (4, 6)\\}$，jt 告诉你 $res = 3$。\n\n接下来你交换 $3, 6$，$S$ 变为 $\\{(2, 5), (1, 6), (3, 4)\\}$，jt 告诉你 $res = 4$。\n\n接下来你交换 $6, 2$，$S$ 变为 $\\{(5, 6), (1, 2), (3, 4)\\}$，jt 告诉你 $res = 2$。\n\n你输出 $\\{(5, 1), (6, 4), (2, 3)\\}$，用了 $3$ 次操作，不超过 $lim = 100$ 次，回答正确。\n\n对于第二组测试数据，$S$ 初始为 $\\{(1, 2)\\}$，你直接输出 $\\{(1, 2)\\}$，用了 $0$ 次操作，不超过 $lim = 0$ 次，回答正确。\n\n**【数据范围】**\n\n**本题开启捆绑测试。**\n\n记 $\\sum n$ 为单个测试点内所有的 $n$ 之和。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 10^5$，$ 1 \\le n \\le 5 \\times 10^4$，$ \\sum n \\le 10^5$。\n\n| 子任务编号 | $T$ | $n$ | $lim$ | 分数 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $=1$ | $=1$ | $=0$ | $1$ |\n| $i$（$2 \\le i \\le 6$） | $=(2i-1)!!$ | $=i$ | $=10^9$ | $8$ |\n| $7$ | $\\le 5$ | $\\le 100$ | $=5n^2$ | $14$ |\n| $8$ | $\\le 25$| $\\le 10^3$ | $=10n$ | $15$ |\n| $9$ | $\\le 10^5$ | $\\le 5 \\times 10^4$ | $=\\max(0, 2n - 3)$ | $30$ |\n\n$!!$ 代表[双阶乘](https://baike.baidu.com/item/%E5%8F%8C%E9%98%B6%E4%B9%98/9500461)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-S3-T3】「FeOI Round 1」再演", "background": "原题链接：<https://oier.team/problems/S3C>。\n\n---\n\n![](bilibili:BV1rx411E7WH)", "description": "**这是一道交互题。**\n\njt 有一个大小为 $n$ 的集合 $S$，集合中每个元素都是一个无序二元整数对 $(x, y)$，保证集合中 $1 \\sim 2n$ 共 $2n$ 个整数每个恰好出现一次。\n\n比如当 $n = 3$ 时，合法的集合 $S$ 可能是 $\\{(1, 5), (2, 3), (4, 6)\\}$。\n\n开始时你只知道 $n$ 而不知道 $S$ 具体是什么。\n\n现在支持一种操作：你可以给出 $i, j$（$1 \\le i, j \\le 2n$），然后 jt 会交换 $i, j$ 在 $S$ 中的位置（如 $i, j$ 在同一个二元组内，或 $i = j$，则什么也不会发生）。\n\n比如，当 $S = \\{(1, 5), (2, 3), (4, 6)\\}$ 时，执行 $i = 2, j = 6$ 后 $S = \\{(1, 5), (6, 3), (4, 2)\\} = \\{(1, 5), (2, 4), (3, 6)\\}$。\n\n在最开始时以及每次操作过后，对于当前的集合 $S$，jt 会告诉你 $res = \\min\\limits_{(x, y) \\in S} \\max(x, y)$。\n\n比如，当 $S = \\{(1, 5), (2, 3), (4, 6)\\}$ 时，$res$ 为 $\\min(\\max(1, 5), \\max(2, 3), \\max(4, 6)) = \\min(5, 3, 6) = 3$。\n\n注意，每次 jt 告诉你 $res$ 之后**不会撤销**你做的操作，即你的操作是持续有效的。\n\n你需要在 $lim$ 次操作内猜出**初始的**集合 $S$，即进行所有交换操作之前的版本。\n\n保证初始的 $S$ 是提前确定的，即**交互库不自适应**。\n\n### 交互方式\n\n**本题单个测试点内包含多组数据。**\n\n首先读入数据组数 $T$。\n\n接下来有 $T$ 组数据，对于每组数据进行以下过程：\n\n输入 $S$ 的大小 $n$ 以及 $lim$ 以开始交互。\n\n每次操作，首先读入 $res$，接下来输出一行 `^ i j` 表示你要执行操作 $i, j$。\n\n在你确定答案后，请先输出一行一个 `!`，然后接下来 $n$ 行每行输出两个整数 `x y` 代表 $S$ 中的一个二元组，然后准备读入下一组数据。你可以以任意顺序输出这些二元组，且二元组内元素顺序可以任意。\n\n每次在你输出一行后，请清空缓冲区：\n\n- 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n- 在 Pascal 中，使用 `flush(output)`。\n- 在 Python 中，使用 `stdout.flush()`。\n- 其它语言请自行查阅文档。\n\n**当你在单个测试点所有测试数据的总操作次数不超过 $\\boldsymbol{2.5 \\times 10^5}$ 次时**，保证交互库占用时间不超过 $1\\operatorname s$，空间不超过 $128\\operatorname{MB}$，也就是你至少能使用 $1 \\operatorname{s}$ 的时间以及 $384\\operatorname{MB}$ 的空间。", "inputFormat": "见「交互方式」。", "outputFormat": "见「交互方式」。", "hint": "**【样例解释】**\n\n注意，样例只是描述了一个可能发生的交互过程，**并不一定存在逻辑**（就是说答案可能是乱猜猜对的）。\n\n对于第一组测试数据，$S$ 最开始为 $\\{(1, 5), (2, 3), (4, 6)\\}$，jt 告诉你 $res = 3$。\n\n接下来你交换 $1, 2$，$S$ 变为 $\\{(2, 5), (1, 3), (4, 6)\\}$，jt 告诉你 $res = 3$。\n\n接下来你交换 $3, 6$，$S$ 变为 $\\{(2, 5), (1, 6), (3, 4)\\}$，jt 告诉你 $res = 4$。\n\n接下来你交换 $6, 2$，$S$ 变为 $\\{(5, 6), (1, 2), (3, 4)\\}$，jt 告诉你 $res = 2$。\n\n你输出 $\\{(5, 1), (6, 4), (2, 3)\\}$，用了 $3$ 次操作，不超过 $lim = 100$ 次，回答正确。\n\n对于第二组测试数据，$S$ 初始为 $\\{(1, 2)\\}$，你直接输出 $\\{(1, 2)\\}$，用了 $0$ 次操作，不超过 $lim = 0$ 次，回答正确。\n\n**【数据范围】**\n\n**本题开启捆绑测试。**\n\n记 $\\sum n$ 为单个测试点内所有的 $n$ 之和。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 10^5$，$ 1 \\le n \\le 5 \\times 10^4$，$ \\sum n \\le 10^5$。\n\n| 子任务编号 | $T$ | $n$ | $lim$ | 分数 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $=1$ | $=1$ | $=0$ | $1$ |\n| $i$（$2 \\le i \\le 6$） | $=(2i-1)!!$ | $=i$ | $=10^9$ | $8$ |\n| $7$ | $\\le 5$ | $\\le 100$ | $=5n^2$ | $14$ |\n| $8$ | $\\le 25$| $\\le 10^3$ | $=10n$ | $15$ |\n| $9$ | $\\le 10^5$ | $\\le 5 \\times 10^4$ | $=\\max(0, 2n - 3)$ | $30$ |\n\n$!!$ 代表[双阶乘](https://baike.baidu.com/item/%E5%8F%8C%E9%98%B6%E4%B9%98/9500461)。", "locale": "zh-CN"}}}
{"pid": "P10888", "type": "P", "difficulty": 6, "samples": [["4\n4 4\n4 2 4 3\n1 3 1 2\n1 2 4 2\n4 2 4 3\n10 2\n1 2\n4 0\n3 1\n2 4\n0 5\n2 3\n3 2\n1 1\n2 2\n4 4\n4 4\n0 0 0 0\n0 0 0 0\n1 0 1 0\n0 0 0 0\n2 10\n92603107 17358677 20869254 22085089 68529385 51524980 47064864 17692636 31121387 37022044\n25517267 69562538 61254114 54886162 15087981 27505611 76082026 59892091 54661294 59475460", "748683265\n249561089\n748683265\n499122177\n399297742\n399297742\n0\n0\n0\n0\n892513752\n105730602\n366911811\n374997189\n954012663\n897963459\n891479524\n220357565\n706471693\n519276178\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["梦熊比赛"], "title": "【MX-S3-T4】「FeOI Round 1」醒餞の鳥 (feat. Feryquitous)", "background": "原题链接：<https://oier.team/problems/S3D>。\n\n---\n\n![](bilibili:BV16h411Y7YB)", "description": "有 $n$ 个学生（编号为 $1 \\sim n$）参加了一场有 $m$ 门学科（编号为 $1 \\sim m$）的考试，现在你知道，学生 $i$ 的第 $j$ 门学科考试的成绩为 $a_{i, j}$。\n\n现在你想要给这些学生排名。由于成绩不形成偏序关系的两个学生实力难以比较，所以你打算设置 $m$ 个实数 $p_{1 \\sim m}$（要求满足 $\\sum_{i = 1}^m p_i = 1$，且 $p_i \\ge 0$）作为权值。定义学生 $i$ 的加权总分为 $\\sum_{j = 1}^m a_{i, j} \\times p_j$，则按照加权总分降序排名，加权总分相等的则排名并列。\n\n现在这 $m$ 个学科的老师都向你提出了要求，第 $k$ 个学科的老师想让你所设置的 $p$ 满足：\n\n- 以这个 $p$ 得到的排名结果中，不存在一对学生 $(x, y)$（$x \\ne y$），使得 $x$ 排名更靠前（并列不算），但是 $a_{x, k} < a_{y, k}$；\n\n因为你想要尽量自由的分配权值，所以你需要对于每个 $k$（$1 \\le k \\le m$），都**分别**求出：\n\n- $p_k$ 至少要为多少，才能保证**无论如何分配其他 $\\boldsymbol{p_i}$ 的权值，都能满足**第 $k$ 个学科的老师的要求？请输出答案对 $998244353$ 取模的结果。", "inputFormat": "**本题单个测试点内包含多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。\n\n接下来，对于每组数据，格式如下：\n\n第一行两个整数，分别为 $n, m$。\n\n第二行到第 $n + 1$ 行每行 $m$ 个整数，第 $i + 1$ 行第 $j$ 列的整数表示 $a_{i, j}$。", "outputFormat": "对于每组测试数据，输出 $m$ 行，每行一个非负整数，第 $i$ 行表示 $k = i$ 时，$p_k$ 的最小值对 $998244353$ 取模的结果。\n\n即设答案化为最简分式后的形式为 $\\frac{a}\n{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx \\equiv a \\pmod{998244353}$ 且 $0 \\le x < 998244353$。可以证明这样的整数 $x$ 是唯一的。", "hint": "**【样例解释】**\n\n对于第一组数据，询问的答案取模之前分别为 $\\frac{1}{4}, \\frac{3}{4}, \\frac{1}{4}, \\frac{1}{2}$。\n\n对于第二组数据，询问的答案取模之前分别为 $\\frac{4}{5}, \\frac{4}{5}$。\n\n对于第三组数据，询问的答案取模之前分别为 $0, 0, 0, 0$。\n\n对于第一组数据的 $k = 2$ 的询问，假设 $p = [0.1, 0.75, 0.1, 0.05]$：\n\n- 第 $1$ 个学生的加权总分是 $4 \\times 0.1 + 2 \\times 0.75 + 4 \\times 0.1 + 3 \\times 0.05 = 2.45$；\n- 第 $2$ 个学生的加权总分是 $1 \\times 0.1 + 3 \\times 0.75 + 1 \\times 0.1 + 2 \\times 0.05 = 2.55$；\n- 第 $3$ 个学生的加权总分是 $1 \\times 0.1 + 2 \\times 0.75 + 4 \\times 0.1 + 2 \\times 0.05 = 2.1$；\n- 第 $4$ 个学生的加权总分是 $4 \\times 0.1 + 2 \\times 0.75 + 4 \\times 0.1 + 3 \\times 0.05 = 2.45$；\n\n则你令按加权总分降序排名的学生编号为 $[2, 4, 1, 3]$（当然也可以令其为 $[2, 1, 4, 3]$），且 $a_{2, 2} = 3, a_{4, 2} = 2, a_{1, 2} = 2, a_{3, 2} = 2$，不存在排名更靠后但是第 $2$ 个学科成绩更高的情况。\n\n可以证明，在 $p_2 \\ge 0.75$ 的情况下，无论其他 $p_i$ 如何分布，都可以满足要求；而 $p_2 < 0.75$ 的情况下，一定存在一种其他 $p_i$ 的分布使得无法满足要求。\n\n**【数据范围】**\n\n**本题开启捆绑测试。**\n\n设 $\\sum nm$ 为单个测试点内所有的 $nm$ 之和。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 5 \\times 10^4$，$ 2 \\le n, m \\le 10^5$，$ \\sum nm \\le 2 \\times 10^5$，$ 0 \\le a_{i, j} \\leq 10^8$。\n\n| 子任务编号 | $n$ | $m$ | $\\sum nm$ | 特殊性质 | 分数 |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $\\leq 10$ | $\\leq 10$ | $\\leq 100$ | 无 | $5$ |\n| $2$ | $\\leq 100$ | $\\leq 100$ | $\\leq 10^4$ | 无 | $10$ |\n| $3$ | $\\leq 5 \\times 10^3$ | $\\leq 5 \\times 10^3$ | $\\leq 10^4$ | 无 | $15$ |\n| $4$ | $\\leq 100$ | $\\le 10^5$ | $\\le 2 \\times 10^5$ | 无 | $20$ |\n| $5$ | $\\le 10^5$ | $\\leq 100$ | $\\le 2 \\times 10^5$ | 无 | $10$ |\n| $6$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 2 \\times 10^5$ | $a_{i, j} \\in \\{0, 1\\}$ | $20$ |\n| $7$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 2 \\times 10^5$ | 无 | $20$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-S3-T4】「FeOI Round 1」醒餞の鳥 (feat. Feryquitous)", "background": "原题链接：<https://oier.team/problems/S3D>。\n\n---\n\n![](bilibili:BV16h411Y7YB)", "description": "有 $n$ 个学生（编号为 $1 \\sim n$）参加了一场有 $m$ 门学科（编号为 $1 \\sim m$）的考试，现在你知道，学生 $i$ 的第 $j$ 门学科考试的成绩为 $a_{i, j}$。\n\n现在你想要给这些学生排名。由于成绩不形成偏序关系的两个学生实力难以比较，所以你打算设置 $m$ 个实数 $p_{1 \\sim m}$（要求满足 $\\sum_{i = 1}^m p_i = 1$，且 $p_i \\ge 0$）作为权值。定义学生 $i$ 的加权总分为 $\\sum_{j = 1}^m a_{i, j} \\times p_j$，则按照加权总分降序排名，加权总分相等的则排名并列。\n\n现在这 $m$ 个学科的老师都向你提出了要求，第 $k$ 个学科的老师想让你所设置的 $p$ 满足：\n\n- 以这个 $p$ 得到的排名结果中，不存在一对学生 $(x, y)$（$x \\ne y$），使得 $x$ 排名更靠前（并列不算），但是 $a_{x, k} < a_{y, k}$；\n\n因为你想要尽量自由的分配权值，所以你需要对于每个 $k$（$1 \\le k \\le m$），都**分别**求出：\n\n- $p_k$ 至少要为多少，才能保证**无论如何分配其他 $\\boldsymbol{p_i}$ 的权值，都能满足**第 $k$ 个学科的老师的要求？请输出答案对 $998244353$ 取模的结果。", "inputFormat": "**本题单个测试点内包含多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。\n\n接下来，对于每组数据，格式如下：\n\n第一行两个整数，分别为 $n, m$。\n\n第二行到第 $n + 1$ 行每行 $m$ 个整数，第 $i + 1$ 行第 $j$ 列的整数表示 $a_{i, j}$。", "outputFormat": "对于每组测试数据，输出 $m$ 行，每行一个非负整数，第 $i$ 行表示 $k = i$ 时，$p_k$ 的最小值对 $998244353$ 取模的结果。\n\n即设答案化为最简分式后的形式为 $\\frac{a}\n{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx \\equiv a \\pmod{998244353}$ 且 $0 \\le x < 998244353$。可以证明这样的整数 $x$ 是唯一的。", "hint": "**【样例解释】**\n\n对于第一组数据，询问的答案取模之前分别为 $\\frac{1}{4}, \\frac{3}{4}, \\frac{1}{4}, \\frac{1}{2}$。\n\n对于第二组数据，询问的答案取模之前分别为 $\\frac{4}{5}, \\frac{4}{5}$。\n\n对于第三组数据，询问的答案取模之前分别为 $0, 0, 0, 0$。\n\n对于第一组数据的 $k = 2$ 的询问，假设 $p = [0.1, 0.75, 0.1, 0.05]$：\n\n- 第 $1$ 个学生的加权总分是 $4 \\times 0.1 + 2 \\times 0.75 + 4 \\times 0.1 + 3 \\times 0.05 = 2.45$；\n- 第 $2$ 个学生的加权总分是 $1 \\times 0.1 + 3 \\times 0.75 + 1 \\times 0.1 + 2 \\times 0.05 = 2.55$；\n- 第 $3$ 个学生的加权总分是 $1 \\times 0.1 + 2 \\times 0.75 + 4 \\times 0.1 + 2 \\times 0.05 = 2.1$；\n- 第 $4$ 个学生的加权总分是 $4 \\times 0.1 + 2 \\times 0.75 + 4 \\times 0.1 + 3 \\times 0.05 = 2.45$；\n\n则你令按加权总分降序排名的学生编号为 $[2, 4, 1, 3]$（当然也可以令其为 $[2, 1, 4, 3]$），且 $a_{2, 2} = 3, a_{4, 2} = 2, a_{1, 2} = 2, a_{3, 2} = 2$，不存在排名更靠后但是第 $2$ 个学科成绩更高的情况。\n\n可以证明，在 $p_2 \\ge 0.75$ 的情况下，无论其他 $p_i$ 如何分布，都可以满足要求；而 $p_2 < 0.75$ 的情况下，一定存在一种其他 $p_i$ 的分布使得无法满足要求。\n\n**【数据范围】**\n\n**本题开启捆绑测试。**\n\n设 $\\sum nm$ 为单个测试点内所有的 $nm$ 之和。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 5 \\times 10^4$，$ 2 \\le n, m \\le 10^5$，$ \\sum nm \\le 2 \\times 10^5$，$ 0 \\le a_{i, j} \\leq 10^8$。\n\n| 子任务编号 | $n$ | $m$ | $\\sum nm$ | 特殊性质 | 分数 |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $\\leq 10$ | $\\leq 10$ | $\\leq 100$ | 无 | $5$ |\n| $2$ | $\\leq 100$ | $\\leq 100$ | $\\leq 10^4$ | 无 | $10$ |\n| $3$ | $\\leq 5 \\times 10^3$ | $\\leq 5 \\times 10^3$ | $\\leq 10^4$ | 无 | $15$ |\n| $4$ | $\\leq 100$ | $\\le 10^5$ | $\\le 2 \\times 10^5$ | 无 | $20$ |\n| $5$ | $\\le 10^5$ | $\\leq 100$ | $\\le 2 \\times 10^5$ | 无 | $10$ |\n| $6$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 2 \\times 10^5$ | $a_{i, j} \\in \\{0, 1\\}$ | $20$ |\n| $7$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 2 \\times 10^5$ | 无 | $20$ |\n", "locale": "zh-CN"}}}
{"pid": "P10889", "type": "P", "difficulty": 6, "samples": [["4 2\n1 1\n1 2 3 4", "6"], ["10 5\n1 3\n1 1 4 5 1 4 1 9 19 81", "124"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240, 10240]}, "tags": ["网络流", "O2优化", "费用流", "线性规划"], "title": "【烂题杯 Round 1】糖果色的梦", "background": "", "description": "小 A 做了一个糖果色的梦，于是他打算买一些糖果送给他的 $n$ 个小朋友。\n\n小 A 可以零售地购买糖果，也可以批发地购买糖果，他还可以批发地回收糖果。\n\n- 零售地购买糖果：每次小 A 可以给一个小朋友购买一个糖果，这将会花费 $1$ 元；\n\n- 批发地购买糖果：每次小 A 可以给连续且不少于 $k$ 个小朋友分别购买一个糖果，设小朋友的个数为 $l$，这将会花费 $l-B$ 元；\n\n- 批发地回收糖果：每次小 A 可以给连续且不少于 $k$ 个小朋友分别收回一个糖果，这将会获得 $C$ 元；\n\n第 $i$ 个小朋友都希望自己得到不少于 $a_i$ 个糖果。求小 A 满足所有小朋友的希望的最小代价。", "inputFormat": "第一行输入两个正整数 $n$、$k$，表示小朋友数量、批发最少需要的小朋友数量。\n\n接下来输入两个整数 $B$、$C$。\n\n接下来一行 $n$ 个非负整数 $a_1,a_2,\\cdots,a_n$，表示每个小朋友希望的糖果个数。", "outputFormat": "输出一行一个整数，表示最小代价。", "hint": "**样例 1 解释：**\n\n我们给 $[1,2]$ 小朋友批发分别购买 $1$ 个糖果，代价为 $1$；给 $[3,4]$ 小朋友批发分别购买 $3$ 个糖果，代价为 $3$；给 $2$ 小朋友单独购买糖果，代价为 $1$；给 $4$ 小朋友单独购买糖果，代价为 $1$。总共代价为 $6$。\n\n**数据范围：**\n\n对于 $20\\%$ 数据，满足 $1\\le k\\le n\\le 10$。\n\n对于 $40\\%$ 数据，满足内存限制至少为 512 MB。\n\n对于 $100\\%$ 数据，满足 $1\\le k\\le n\\le 1000$，$0\\le B\\le k$，$0\\le C\\le k-B$，$0\\le a_i\\le 10^9$。满足内存限制至少为 10 MB。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【烂题杯 Round 1】糖果色的梦", "background": "", "description": "小 A 做了一个糖果色的梦，于是他打算买一些糖果送给他的 $n$ 个小朋友。\n\n小 A 可以零售地购买糖果，也可以批发地购买糖果，他还可以批发地回收糖果。\n\n- 零售地购买糖果：每次小 A 可以给一个小朋友购买一个糖果，这将会花费 $1$ 元；\n\n- 批发地购买糖果：每次小 A 可以给连续且不少于 $k$ 个小朋友分别购买一个糖果，设小朋友的个数为 $l$，这将会花费 $l-B$ 元；\n\n- 批发地回收糖果：每次小 A 可以给连续且不少于 $k$ 个小朋友分别收回一个糖果，这将会获得 $C$ 元；\n\n第 $i$ 个小朋友都希望自己得到不少于 $a_i$ 个糖果。求小 A 满足所有小朋友的希望的最小代价。", "inputFormat": "第一行输入两个正整数 $n$、$k$，表示小朋友数量、批发最少需要的小朋友数量。\n\n接下来输入两个整数 $B$、$C$。\n\n接下来一行 $n$ 个非负整数 $a_1,a_2,\\cdots,a_n$，表示每个小朋友希望的糖果个数。", "outputFormat": "输出一行一个整数，表示最小代价。", "hint": "**样例 1 解释：**\n\n我们给 $[1,2]$ 小朋友批发分别购买 $1$ 个糖果，代价为 $1$；给 $[3,4]$ 小朋友批发分别购买 $3$ 个糖果，代价为 $3$；给 $2$ 小朋友单独购买糖果，代价为 $1$；给 $4$ 小朋友单独购买糖果，代价为 $1$。总共代价为 $6$。\n\n**数据范围：**\n\n对于 $20\\%$ 数据，满足 $1\\le k\\le n\\le 10$。\n\n对于 $40\\%$ 数据，满足内存限制至少为 512 MB。\n\n对于 $100\\%$ 数据，满足 $1\\le k\\le n\\le 1000$，$0\\le B\\le k$，$0\\le C\\le k-B$，$0\\le a_i\\le 10^9$。满足内存限制至少为 10 MB。", "locale": "zh-CN"}}}
{"pid": "P10890", "type": "P", "difficulty": 7, "samples": [["2 2 3\n1 2 3 4 5 6\n7 8 9 10 11 12\n5\n0 1 13\n0 2 14\n1 2 15\n1 3 16\n2 3 17", "2\n2\n0\n0\n2\n0"], ["10 1 2\n568508003 500481779\n296073373 42467215\n878878423 182698953\n810051825 300278778\n506619835 300576052\n878109763 816209514\n722729481 557555287\n810227870 524124026\n693592304 92818139\n971977946 139368888\n3\n0 1 524124026\n0 1 500481779\n0 2 816209514", "1\n6\n6\n2"]], "limits": {"time": [3000], "memory": [524288]}, "tags": ["多项式", "O2优化", "容斥原理", "快速沃尔什变换 FWT", "单位根反演"], "title": "【烂题杯 Round 1】可持久化糖果树", "background": "", "description": "小 A 有一棵糖果树，树上有 $n$ 个节点，编号为 $1,2,\\cdots,n$。每个节点里有 $m$ 位小朋友，编号为 $1,2,\\cdots,m$。每个小朋友可以进行 $k$ 次祈愿，编号为 $1,2,\\cdots,k$。节点 $i$ 中的第 $j$ 位小朋友的第 $x$ 次祈愿可以获得 $a_{i,j,x}$ 个糖果。我们称未被修改的糖果树为第 $0$ 个版本树。\n\n一个小朋友被称为开心的，当且仅当她经过 $k$ 轮祈愿后可以获得的糖果数量可以被 $3$ 整除，这样就可以把糖果平均地分给她和她的父母。也就是说，第 $i$ 个节点的第 $j$ 个小朋友是开心的当且仅当 $\\sum_{x=1}^k a_{i,j,x}\\bmod 3=0$。\n\n一个节点被称为是快乐的，当且仅当上面的 $m$ 位小朋友都是开心的。\n\n小 A 可以施加魔法：他将会有 $q$ 次修改，下标从 $1$ 开始的第 $i$ 次修改可以描述为 $(x,y,z)$，表示将第 $x$ 个版本树上所有节点中的所有小朋友的第 $y$ 次祈愿获得的糖果数量乘上 $z$，得到第 $i$ 个版本树。要求你求出每个版本树中有多少个点是快乐的。", "inputFormat": "第一行有 $3$ 个整数 $n$、$m$、$k$，分别表示节点个数、每个节点上的小朋友个数、每个小朋友的祈愿次数。\n\n接下来读入 $n$ 行，每行 $m\\times k$ 个整数，表示 $a_{i,j,x}$，从 $1$ 开始标号。\n\n接下来一行一个正整数 $q$，表示修改次数。\n\n接下来读入 $q$ 行，第 $i$ 行三个正整数 $x,y,z$，表示将第 $x$ 个版本树上所有节点中的所有小朋友的第 $y$ 次祈愿获得的糖果数量乘上 $z$，得到第 $i$ 个版本树，从 $1$ 开始标号。", "outputFormat": "输出 $q+1$ 行，每行一个正整数，第 $i$ 行表示第 $i-1$ 个版本树中快乐的节点数。", "hint": "**数据范围：**\n\n对于 $0\\%$ 的数据，满足 $n\\le 10^3$，$q\\le 10^3$。\n\n对于 $0\\%$ 的数据，满足 $n\\le 10^3$，$q\\le 10^6$。\n\n对于另外 $0\\%$ 的数据，满足 $m=1$。\n\n对于另外 $0\\%$ 的数据，满足 $k=1$。\n\n对于另外 $0\\%$ 的数据，满足 $q=0$。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^5$，$1\\le m\\le 4$，$1\\le k\\le 12$，$0\\le q\\le 10^6$，$0\\le a_{i,j,x}\\le 10^9$。对于第 $i$ 次修改，$0\\le x<i$，$1\\le y\\le k$，$0\\le z\\le 10^9$。\n\n输入输出量较大，需要快速输入输出算法。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【烂题杯 Round 1】可持久化糖果树", "background": "", "description": "小 A 有一棵糖果树，树上有 $n$ 个节点，编号为 $1,2,\\cdots,n$。每个节点里有 $m$ 位小朋友，编号为 $1,2,\\cdots,m$。每个小朋友可以进行 $k$ 次祈愿，编号为 $1,2,\\cdots,k$。节点 $i$ 中的第 $j$ 位小朋友的第 $x$ 次祈愿可以获得 $a_{i,j,x}$ 个糖果。我们称未被修改的糖果树为第 $0$ 个版本树。\n\n一个小朋友被称为开心的，当且仅当她经过 $k$ 轮祈愿后可以获得的糖果数量可以被 $3$ 整除，这样就可以把糖果平均地分给她和她的父母。也就是说，第 $i$ 个节点的第 $j$ 个小朋友是开心的当且仅当 $\\sum_{x=1}^k a_{i,j,x}\\bmod 3=0$。\n\n一个节点被称为是快乐的，当且仅当上面的 $m$ 位小朋友都是开心的。\n\n小 A 可以施加魔法：他将会有 $q$ 次修改，下标从 $1$ 开始的第 $i$ 次修改可以描述为 $(x,y,z)$，表示将第 $x$ 个版本树上所有节点中的所有小朋友的第 $y$ 次祈愿获得的糖果数量乘上 $z$，得到第 $i$ 个版本树。要求你求出每个版本树中有多少个点是快乐的。", "inputFormat": "第一行有 $3$ 个整数 $n$、$m$、$k$，分别表示节点个数、每个节点上的小朋友个数、每个小朋友的祈愿次数。\n\n接下来读入 $n$ 行，每行 $m\\times k$ 个整数，表示 $a_{i,j,x}$，从 $1$ 开始标号。\n\n接下来一行一个正整数 $q$，表示修改次数。\n\n接下来读入 $q$ 行，第 $i$ 行三个正整数 $x,y,z$，表示将第 $x$ 个版本树上所有节点中的所有小朋友的第 $y$ 次祈愿获得的糖果数量乘上 $z$，得到第 $i$ 个版本树，从 $1$ 开始标号。", "outputFormat": "输出 $q+1$ 行，每行一个正整数，第 $i$ 行表示第 $i-1$ 个版本树中快乐的节点数。", "hint": "**数据范围：**\n\n对于 $0\\%$ 的数据，满足 $n\\le 10^3$，$q\\le 10^3$。\n\n对于 $0\\%$ 的数据，满足 $n\\le 10^3$，$q\\le 10^6$。\n\n对于另外 $0\\%$ 的数据，满足 $m=1$。\n\n对于另外 $0\\%$ 的数据，满足 $k=1$。\n\n对于另外 $0\\%$ 的数据，满足 $q=0$。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^5$，$1\\le m\\le 4$，$1\\le k\\le 12$，$0\\le q\\le 10^6$，$0\\le a_{i,j,x}\\le 10^9$。对于第 $i$ 次修改，$0\\le x<i$，$1\\le y\\le k$，$0\\le z\\le 10^9$。\n\n输入输出量较大，需要快速输入输出算法。", "locale": "zh-CN"}}}
{"pid": "P10891", "type": "P", "difficulty": 6, "samples": [["5 3\n4\n5", "998244304"], ["10 114514\n191981\n3", "998244191"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "容斥原理", "单调栈"], "title": "【烂题杯 Round 1】消灭劳嗝", "background": "", "description": "你需要消灭劳嗝。\n\n给定一个长度为 $n$ 的排列 $A=a_1,a_2,\\cdots,a_n$，定义 $S_i=\\{x|x\\ge i\\land \\max_{i\\le k\\le x}a_k\\le a_x\\}$，您可以把它理解为以 $i$ 开头的后缀的前缀最大值的下标集合。例如对于 $A=\\{3,5,2,1,4\\}$，$S_1=\\{1,2\\}$，$S_3=\\{3,5\\}$。\n\n有 $q$ 次询问，每次询问给出 $l,r$，求：\n\n$$\n\\left(\\left(\\sum_{l\\le x\\le y\\le r} |S_x\\cup S_y|-\\sum_{\\substack{{1\\le x<l}\\\\{r<y\\le n}}} |S_x\\cup S_y|\\right)\\bmod P+P\\right)\\bmod P\n$$\n\n其中，$P=998244353$。", "inputFormat": "由于输入文件过大无法上传，接下来我们将会以一种诡异的方式读入数据。\n\n第一行输入两个非负整数 $n$、$X$。表示排列长度、随机种子。\n\n初始令 $a_i=i$，接下来输入一行一个整数 $c$，表示对排列的操作次数。\n\n接下来我们将会对排列 $A$ 进行 $c$ 次操作，对于下标从 $1$ 开始的第 $i$ 次操作，令 $l=(X\\times (X\\oplus i))\\bmod n+1,r=(X\\oplus(i\\times i))\\bmod n+1$，你需要交换 $a_l$ 与 $a_r$。$\\oplus$ 表示按位异或。\n\n对于 C++，代码实现如下：\n\n```cpp\nl = (1ll * X * (X ^ i)) % n + 1;\nr = (X ^ (1ll * i * i)) % n + 1;\n```\n\n接下来输入一行一个整数 $q$，表示询问组数。\n\n对于下标从 $1$ 开始的第 $i$ 次询问，我们令 $l=\\min((X\\times i+(X\\oplus (X\\times i)))\\bmod n,(X-i+(X\\oplus (X+i)))\\bmod n)+1,r=\\max((X\\times i+(X\\oplus (X\\times i)))\\bmod n,(X-i+(X\\oplus (X+i)))\\bmod n)+1$。表示询问的参数。\n\n对于 C++，代码实现如下：\n\n```cpp\nl = min((1ll * X * i + (X ^ (1ll * X * i))) % n, (X - i + (X ^ (X + i))) % n) + 1;\nr = max((1ll * X * i + (X ^ (1ll * X * i))) % n, (X - i + (X ^ (X + i))) % n) + 1;\n```", "outputFormat": "由于输出文件过大无法上传，接下来我们将会以一种诡异的方式输出数据。\n\n输出一行一个整数，表示 $q$ 次询问中所有答案的异或和。", "hint": "**样例 1 解释：**\n\n操作后 $A=\\{1,5,4,2,3\\}$。\n\n对询问解密后真实询问如下：\n\n```\n4 5\n2 3\n1 5\n3 4\n3 5\n```\n\n对输出解密后真实输出如下：\n\n```\n5\n998244350\n33\n1\n11\n```\n\n对于第一个询问，$S_4=\\{4,5\\}$，$S_5=\\{5\\}$，$|S_4\\cup S_4|+|S_4\\cup S_5|+|S_5\\cup S_5|=5$。\n\n对于倒数第二个询问，不要忘了 $1\\le x<l,r<y\\le n$ 的项。\n\n**数据范围：**\n\n对于 $20\\%$ 的数据，满足 $1\\le n\\le 100$、$1\\le q\\le 100$。\n\n对于 $40\\%$ 的数据，满足 $1\\le n\\le 100$、$1\\le q\\le 10^5$。\n\n对于 $60\\%$ 的数据，满足 $1\\le n\\le 10^5$、$1\\le q\\le 10^5$。\n\n对于 $80\\%$ 的数据，满足 $1\\le n\\le 3\\times10^6$、$1\\le q\\le 3\\times10^6$。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^7$，$1\\le q\\le 10^7$，$0\\le c\\le 10^7$，$0\\le X\\le 10^9$，$a_i$ 互不相同。\n\n**请各位选手注意常数因子的影响。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【烂题杯 Round 1】消灭劳嗝", "background": "", "description": "你需要消灭劳嗝。\n\n给定一个长度为 $n$ 的排列 $A=a_1,a_2,\\cdots,a_n$，定义 $S_i=\\{x|x\\ge i\\land \\max_{i\\le k\\le x}a_k\\le a_x\\}$，您可以把它理解为以 $i$ 开头的后缀的前缀最大值的下标集合。例如对于 $A=\\{3,5,2,1,4\\}$，$S_1=\\{1,2\\}$，$S_3=\\{3,5\\}$。\n\n有 $q$ 次询问，每次询问给出 $l,r$，求：\n\n$$\n\\left(\\left(\\sum_{l\\le x\\le y\\le r} |S_x\\cup S_y|-\\sum_{\\substack{{1\\le x<l}\\\\{r<y\\le n}}} |S_x\\cup S_y|\\right)\\bmod P+P\\right)\\bmod P\n$$\n\n其中，$P=998244353$。", "inputFormat": "由于输入文件过大无法上传，接下来我们将会以一种诡异的方式读入数据。\n\n第一行输入两个非负整数 $n$、$X$。表示排列长度、随机种子。\n\n初始令 $a_i=i$，接下来输入一行一个整数 $c$，表示对排列的操作次数。\n\n接下来我们将会对排列 $A$ 进行 $c$ 次操作，对于下标从 $1$ 开始的第 $i$ 次操作，令 $l=(X\\times (X\\oplus i))\\bmod n+1,r=(X\\oplus(i\\times i))\\bmod n+1$，你需要交换 $a_l$ 与 $a_r$。$\\oplus$ 表示按位异或。\n\n对于 C++，代码实现如下：\n\n```cpp\nl = (1ll * X * (X ^ i)) % n + 1;\nr = (X ^ (1ll * i * i)) % n + 1;\n```\n\n接下来输入一行一个整数 $q$，表示询问组数。\n\n对于下标从 $1$ 开始的第 $i$ 次询问，我们令 $l=\\min((X\\times i+(X\\oplus (X\\times i)))\\bmod n,(X-i+(X\\oplus (X+i)))\\bmod n)+1,r=\\max((X\\times i+(X\\oplus (X\\times i)))\\bmod n,(X-i+(X\\oplus (X+i)))\\bmod n)+1$。表示询问的参数。\n\n对于 C++，代码实现如下：\n\n```cpp\nl = min((1ll * X * i + (X ^ (1ll * X * i))) % n, (X - i + (X ^ (X + i))) % n) + 1;\nr = max((1ll * X * i + (X ^ (1ll * X * i))) % n, (X - i + (X ^ (X + i))) % n) + 1;\n```", "outputFormat": "由于输出文件过大无法上传，接下来我们将会以一种诡异的方式输出数据。\n\n输出一行一个整数，表示 $q$ 次询问中所有答案的异或和。", "hint": "**样例 1 解释：**\n\n操作后 $A=\\{1,5,4,2,3\\}$。\n\n对询问解密后真实询问如下：\n\n```\n4 5\n2 3\n1 5\n3 4\n3 5\n```\n\n对输出解密后真实输出如下：\n\n```\n5\n998244350\n33\n1\n11\n```\n\n对于第一个询问，$S_4=\\{4,5\\}$，$S_5=\\{5\\}$，$|S_4\\cup S_4|+|S_4\\cup S_5|+|S_5\\cup S_5|=5$。\n\n对于倒数第二个询问，不要忘了 $1\\le x<l,r<y\\le n$ 的项。\n\n**数据范围：**\n\n对于 $20\\%$ 的数据，满足 $1\\le n\\le 100$、$1\\le q\\le 100$。\n\n对于 $40\\%$ 的数据，满足 $1\\le n\\le 100$、$1\\le q\\le 10^5$。\n\n对于 $60\\%$ 的数据，满足 $1\\le n\\le 10^5$、$1\\le q\\le 10^5$。\n\n对于 $80\\%$ 的数据，满足 $1\\le n\\le 3\\times10^6$、$1\\le q\\le 3\\times10^6$。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^7$，$1\\le q\\le 10^7$，$0\\le c\\le 10^7$，$0\\le X\\le 10^9$，$a_i$ 互不相同。\n\n**请各位选手注意常数因子的影响。**", "locale": "zh-CN"}}}
{"pid": "P10892", "type": "P", "difficulty": 2, "samples": [["2\n13\n7", "3\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "SDOI2024", "background": "AzureHair 在 NOIP 2022 中被喵了个喵创死，于是患上了不治之症——T2 恐惧症，于是他在 NOIP 2023 中果断跳过了 T2 并杠 T3 两小时无果，遗憾离场，他的同学决定帮他治疗这种不治之症。\n\n在他的同学给他治愈了 T2 恐惧症后，他自信的开始了他的 SDOI，遂分讨写了 $2$ 个小时没写出来，遗憾离场……", "description": "AzureHair 的同学把 AzureHair 和 $n$ 只猫猫关在一个房间里，并且要求 AzureHair 每过一天就交出 $\\frac{n}{2}$ 只猫猫，但是如果 $n$ 是奇数时，AzureHair 就会纠结于要交出 $\\frac{n+1}{2}$ 只猫猫还是交出 $\\frac{n-1}{2}$ 只猫猫。AzureHair 不想让自己纠结，所以请你计算出直到所有猫猫都被拿出房间时，AzureHair 的最小纠结次数是多少。", "inputFormat": "本题有多组测试数据。\n\n第一行一个整数 $T$。\n\n接下来 $T$ 行，每行一个整数 $n$。", "outputFormat": "$T$ 行，每行一个整数表示最小纠结次数。", "hint": "**【样例解释】**\n\n对于 $13$ 只猫猫，只纠结 $3$ 次的过程如下：\n\n选择交出 $7$ 只猫猫，剩余 $6$ 只；\n\n不纠结，交出 $3$ 只猫猫，剩余 $3$ 只；\n\n选择交出 $2$ 只猫猫，剩余 $1$ 只；\n\n选择交出 $1$ 只猫猫，所有猫猫均被取走。\n\n容易证明不存在少于 $3$ 次纠结的方案。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，保证 $1\\le n \\le 10$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n \\le 10^{5}$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n \\le 2^{60}$，$1 \\le T \\le 5\\times 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "SDOI2024", "background": "AzureHair 在 NOIP 2022 中被喵了个喵创死，于是患上了不治之症——T2 恐惧症，于是他在 NOIP 2023 中果断跳过了 T2 并杠 T3 两小时无果，遗憾离场，他的同学决定帮他治疗这种不治之症。\n\n在他的同学给他治愈了 T2 恐惧症后，他自信的开始了他的 SDOI，遂分讨写了 $2$ 个小时没写出来，遗憾离场……", "description": "AzureHair 的同学把 AzureHair 和 $n$ 只猫猫关在一个房间里，并且要求 AzureHair 每过一天就交出 $\\frac{n}{2}$ 只猫猫，但是如果 $n$ 是奇数时，AzureHair 就会纠结于要交出 $\\frac{n+1}{2}$ 只猫猫还是交出 $\\frac{n-1}{2}$ 只猫猫。AzureHair 不想让自己纠结，所以请你计算出直到所有猫猫都被拿出房间时，AzureHair 的最小纠结次数是多少。", "inputFormat": "本题有多组测试数据。\n\n第一行一个整数 $T$。\n\n接下来 $T$ 行，每行一个整数 $n$。", "outputFormat": "$T$ 行，每行一个整数表示最小纠结次数。", "hint": "**【样例解释】**\n\n对于 $13$ 只猫猫，只纠结 $3$ 次的过程如下：\n\n选择交出 $7$ 只猫猫，剩余 $6$ 只；\n\n不纠结，交出 $3$ 只猫猫，剩余 $3$ 只；\n\n选择交出 $2$ 只猫猫，剩余 $1$ 只；\n\n选择交出 $1$ 只猫猫，所有猫猫均被取走。\n\n容易证明不存在少于 $3$ 次纠结的方案。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，保证 $1\\le n \\le 10$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n \\le 10^{5}$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n \\le 2^{60}$，$1 \\le T \\le 5\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P10893", "type": "P", "difficulty": 4, "samples": [["8 0\n1 1 -2 1 1 -1 0 1", "2"], ["6 0\n1 1 -4 -5 1 -4", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "城市化发展委员会", "background": "MLE 大帝曾说过：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kce8kpx3.png)\n\n所以为了应对这种情况我们设立了**城市化发展委员会**。", "description": "在高中的校园里我们常常能看到随机刷新的小情侣，对于他们之间的情感，对于 OIer 来说还是太过于高深了，即使是退役的 AzureHair 也无法理解这一行为，但是作为自命的城市化发展委员会的常委，他有自己的一套理解方法。\n\n他认为，女生往往对男生十分的严格。一天开始时男生在女生的心里的积分会加 $1$，而如果当天惹女生生气了 $x$ 次，积分就会在此基础上减 $x$。积分会不断累计，一旦小于等于 $0$ 就可能导致去城市化的严重后果。\n\n现在 **威廉** 在和 **珂朵莉** 进行一种城市化行为，**威廉** 在~~纳西妲~~的帮助之下获得了超能力：一是他可以预知到接下来一个周期的积分变化情况，初始的周期长度为 $n$；二是他可以选择从任意一天开始，开始前的日子将会被拼接到最后一天之后。\n\n他从每一天开始都尝试过一次后，发现了 $a$ 个能使得他不被去城市化的起始日期。随后他会将这若干种情况下的序列按照起始日期的先后拼在一起，变成一个长度为原先 $a$ 倍的周期。他如此重复操作 $k$ 次，由于一天天地试太累了，**威廉** 只想知道最后一次操作后有多少个起始日期能让自己不被去城市化，对 $998244353$ 取模。\n\n---\n\n形式化地说，我们称满足前缀和始终大于 $0$ 的数列为 “安全的”。\n\n对于一个长为 $n$ 的数列 $A_i$，根据以下算法构造出数列 $A_{i+1}$，初始时 $A_{i+1}$ 为空。\n\n- 重复执行 $n$ 次：\n\n1. 若 $A_i$ 是安全的，将其整个接到 $A_{i+1}$ 末尾。\n\n2. 将 $A_i$ 循环左移一位，即令 $A_{i_j} ← A_{i_{j+1 \\bmod n}}$。\n\n现在给定 $A_0$，**满足其各项均不大于 1**。\n\n从 $A_0$ 开始按上述规则生成数列 $A_1$ 到 $A_{k+1}$，请求出 $A_{k+1}$ 与 $A_k$ 的长度比，这个值只要存在就一定是整数，请输出它对 $998244353$ 取模的值。特别地，如果 $A_k$ 为空，请输出 ```0```。", "inputFormat": "普通题意：\n\n共两行，第一行两个整数 $n$ 和 $k$，表示初始的周期长度和操作次数。\n\n第二行 $n$ 个小于等于 1 的整数，表示每天的积分变化。\n\n形式化题意：\n\n共两行，第一行两个整数为 $A_0$ 的长度 $n$ 以及 $k$。\n\n第二行是 $A_0$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "**【样例解释1】**\n\n对于样例 #1 的数据，初始周期为 ```1 1 -2 1 1 -1 0 1```。从每一天开始得到的序列分别是：\n\n```text\n1 1 -2 1 1 -1 0 1\n1 -2 1 1 -1 0 1 1\n-2 1 1 -1 0 1 1 1\n1 1 -1 0 1 1 1 -2\n1 -1 0 1 1 1 -2 1\n-1 0 1 1 1 -2 1 1 \n0 1 1 1 -2 1 1 -1\n1 1 1 -2 1 1 -1 0\n```\n\n只有从第 4 天和第 8 天开始的序列是满足条件的。\n\n形式化题意：\n\n$A_1=\\{1,1,-1,0,1,1,1,-2,1,1,1,-2,1,1,-1,0\\}$，长度为 16，因此应输出 2。\n\n**【样例解释2】**\n\n可以证明不存在合法的方案。\n\n喂！样例全都 $k=0$ 是不是太过分了？！\n\n**数据范围：**\n\n对于 $15\\%$ 的数据，保证 $1\\le n \\le 10$，$1\\le k \\le 5$。\n\n对于另外 $25\\%$ 的数据，保证 $k=0$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^6$，$0 \\le k \\le 10^6$，$-10^9 \\le {A_0}_i \\le 1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "城市化发展委员会", "background": "MLE 大帝曾说过：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kce8kpx3.png)\n\n所以为了应对这种情况我们设立了**城市化发展委员会**。", "description": "在高中的校园里我们常常能看到随机刷新的小情侣，对于他们之间的情感，对于 OIer 来说还是太过于高深了，即使是退役的 AzureHair 也无法理解这一行为，但是作为自命的城市化发展委员会的常委，他有自己的一套理解方法。\n\n他认为，女生往往对男生十分的严格。一天开始时男生在女生的心里的积分会加 $1$，而如果当天惹女生生气了 $x$ 次，积分就会在此基础上减 $x$。积分会不断累计，一旦小于等于 $0$ 就可能导致去城市化的严重后果。\n\n现在 **威廉** 在和 **珂朵莉** 进行一种城市化行为，**威廉** 在~~纳西妲~~的帮助之下获得了超能力：一是他可以预知到接下来一个周期的积分变化情况，初始的周期长度为 $n$；二是他可以选择从任意一天开始，开始前的日子将会被拼接到最后一天之后。\n\n他从每一天开始都尝试过一次后，发现了 $a$ 个能使得他不被去城市化的起始日期。随后他会将这若干种情况下的序列按照起始日期的先后拼在一起，变成一个长度为原先 $a$ 倍的周期。他如此重复操作 $k$ 次，由于一天天地试太累了，**威廉** 只想知道最后一次操作后有多少个起始日期能让自己不被去城市化，对 $998244353$ 取模。\n\n---\n\n形式化地说，我们称满足前缀和始终大于 $0$ 的数列为 “安全的”。\n\n对于一个长为 $n$ 的数列 $A_i$，根据以下算法构造出数列 $A_{i+1}$，初始时 $A_{i+1}$ 为空。\n\n- 重复执行 $n$ 次：\n\n1. 若 $A_i$ 是安全的，将其整个接到 $A_{i+1}$ 末尾。\n\n2. 将 $A_i$ 循环左移一位，即令 $A_{i_j} ← A_{i_{j+1 \\bmod n}}$。\n\n现在给定 $A_0$，**满足其各项均不大于 1**。\n\n从 $A_0$ 开始按上述规则生成数列 $A_1$ 到 $A_{k+1}$，请求出 $A_{k+1}$ 与 $A_k$ 的长度比，这个值只要存在就一定是整数，请输出它对 $998244353$ 取模的值。特别地，如果 $A_k$ 为空，请输出 ```0```。", "inputFormat": "普通题意：\n\n共两行，第一行两个整数 $n$ 和 $k$，表示初始的周期长度和操作次数。\n\n第二行 $n$ 个小于等于 1 的整数，表示每天的积分变化。\n\n形式化题意：\n\n共两行，第一行两个整数为 $A_0$ 的长度 $n$ 以及 $k$。\n\n第二行是 $A_0$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "**【样例解释1】**\n\n对于样例 #1 的数据，初始周期为 ```1 1 -2 1 1 -1 0 1```。从每一天开始得到的序列分别是：\n\n```text\n1 1 -2 1 1 -1 0 1\n1 -2 1 1 -1 0 1 1\n-2 1 1 -1 0 1 1 1\n1 1 -1 0 1 1 1 -2\n1 -1 0 1 1 1 -2 1\n-1 0 1 1 1 -2 1 1 \n0 1 1 1 -2 1 1 -1\n1 1 1 -2 1 1 -1 0\n```\n\n只有从第 4 天和第 8 天开始的序列是满足条件的。\n\n形式化题意：\n\n$A_1=\\{1,1,-1,0,1,1,1,-2,1,1,1,-2,1,1,-1,0\\}$，长度为 16，因此应输出 2。\n\n**【样例解释2】**\n\n可以证明不存在合法的方案。\n\n喂！样例全都 $k=0$ 是不是太过分了？！\n\n**数据范围：**\n\n对于 $15\\%$ 的数据，保证 $1\\le n \\le 10$，$1\\le k \\le 5$。\n\n对于另外 $25\\%$ 的数据，保证 $k=0$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 10^6$，$0 \\le k \\le 10^6$，$-10^9 \\le {A_0}_i \\le 1$。", "locale": "zh-CN"}}}
{"pid": "P10894", "type": "P", "difficulty": 5, "samples": [["5\n1 2\n2 3\n2 4\n1 5\n2\n2 5", "3\n13"], ["10\n1 2\n2 3\n2 4\n1 5\n5 6\n5 7\n7 8\n7 10\n1 9\n3\n5 2 8", "21\n66\n201"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "虚树", "background": "首先，做这道题不需要用到任何虚树有关知识。\n\n——尽管这是主题库里第一个名字含“虚树”的题（", "description": "jq 姐姐有一棵以结点 $1$ 为根的树。定义一棵树的点集 $S$ 的非空子集 $s$ 是好的，当且仅当它满足 $\\forall i,j \\in s, \\text{LCA}(i,j) \\in s$。[什么是 $\\text{LCA}$？](https://oi-wiki.org/graph/lca/)\n\n为了让树的形态更加可爱，jq 姐姐打算修剪掉某个以节点 $i$ 为根的子树（也就是在原树里将节点 $i$ 及其子树内节点及其相连的边均删除）。\n\n她有若干个修剪方案但从未实施，你需要求出每种方案实施后这棵树的好的非空子集数量。由于答案可能会很大，请输出其对 $998244353$ 取模的结果。", "inputFormat": "第一行读入一个整数 $n$ ($n \\leq 5 \\times 10^5$)，表示树的节点数。\n\n第 $2$ 到 $n$ 行，每行读入两个整数 $u_i,v_i$，表示一条从 $u_i$ 连向 $v_i$ 的边。\n\n第 $n+1$ 行读入一个整数 $m$ ($m \\leq 5 \\times 10^5$)，表示修剪方案数。\n\n接下来一行每行读入 $m$ 个整数 $q_i$，表示将以 $q_i$ 为根的子树修剪掉。", "outputFormat": "共 $m$ 行，第 $i$ 行一个整数 $k$ 表示删除以 $q_i$ 为根的子树后原树的好的非空子集数量。", "hint": "样例 1 解释：删去以 $2$ 为根的子树后，原树点集的 $3$ 个非空子集均满足性质，删去以 $5$ 为根的子树后，原树点集的 $15$ 个非空子集中有 $\\{3,4\\}$、$\\{1,3,4\\}$ 不满足性质。\n\n对于前 $10\\%$  的数据，$n,m \\leq 20$。\n\n对于前 $30\\%$ 的数据，$n,m \\leq 3000$。\n\n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 5 \\times 10^5$，$q \\in [1,n]$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "虚树", "background": "首先，做这道题不需要用到任何虚树有关知识。\n\n——尽管这是主题库里第一个名字含“虚树”的题（", "description": "jq 姐姐有一棵以结点 $1$ 为根的树。定义一棵树的点集 $S$ 的非空子集 $s$ 是好的，当且仅当它满足 $\\forall i,j \\in s, \\text{LCA}(i,j) \\in s$。[什么是 $\\text{LCA}$？](https://oi-wiki.org/graph/lca/)\n\n为了让树的形态更加可爱，jq 姐姐打算修剪掉某个以节点 $i$ 为根的子树（也就是在原树里将节点 $i$ 及其子树内节点及其相连的边均删除）。\n\n她有若干个修剪方案但从未实施，你需要求出每种方案实施后这棵树的好的非空子集数量。由于答案可能会很大，请输出其对 $998244353$ 取模的结果。", "inputFormat": "第一行读入一个整数 $n$ ($n \\leq 5 \\times 10^5$)，表示树的节点数。\n\n第 $2$ 到 $n$ 行，每行读入两个整数 $u_i,v_i$，表示一条从 $u_i$ 连向 $v_i$ 的边。\n\n第 $n+1$ 行读入一个整数 $m$ ($m \\leq 5 \\times 10^5$)，表示修剪方案数。\n\n接下来一行每行读入 $m$ 个整数 $q_i$，表示将以 $q_i$ 为根的子树修剪掉。", "outputFormat": "共 $m$ 行，第 $i$ 行一个整数 $k$ 表示删除以 $q_i$ 为根的子树后原树的好的非空子集数量。", "hint": "样例 1 解释：删去以 $2$ 为根的子树后，原树点集的 $3$ 个非空子集均满足性质，删去以 $5$ 为根的子树后，原树点集的 $15$ 个非空子集中有 $\\{3,4\\}$、$\\{1,3,4\\}$ 不满足性质。\n\n对于前 $10\\%$  的数据，$n,m \\leq 20$。\n\n对于前 $30\\%$ 的数据，$n,m \\leq 3000$。\n\n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 5 \\times 10^5$，$q \\in [1,n]$。", "locale": "zh-CN"}}}
{"pid": "P10895", "type": "P", "difficulty": 6, "samples": [["3\n3\n4\n5", "4\n3\n6"], ["5\n13860108\n13850709\n220000633\n693439571\n1004535809", "188051653\n724253523\n444803502\n370347248\n425186012"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "数论", "洛谷原创", "O2优化"], "title": "选择困难症", "background": "Parviz 认为，如果一道题有一个可以显著优化复杂度的方法而不去使用，那这题就是有遗憾的。\n\nAlice 认为，任何算法难度大于思维难度的题，出在正式比赛中都是没有意义的。\n\n猫猫认为，ta 是学数学学的。\n\n$\\textsf{linyue}$ 认为……啊？你们在说啥？\n\n很有喜剧效果的是这四个名字你可能都没法一下子对上号（", "description": "Alice 与 Bob 在下棋之余，也需要一些娱乐活动来放松身心，比如去小吃街吃饭。作为一名绅士，Bob 每次都让 Alice 选择要去吃哪家。这却让 Alice 犯了难——她有选择困难症。\n\n小吃街有 $n$ 家饭店，在第 $i$ 家就餐需要 $i$ 元钱。如果预算为 $a$ 元，则可以选择前 $a$ 家餐厅。\n\n在长期的纠结后，Alice 想到一种方法：她提前在心里想好一个非负整数 $k< \\text{lcm}_{i=1}^{n} i$ ，在得知预算 $a$ 之后，选择在第 $(k$ $\\text{mod}$ $a)+1$ 家餐厅就餐。\n\n由于买棋盘与棋子的市场价格浮动，每次就餐的预算未必相同，但都是 $[2,n]$ 之间的整数。Alice 想每次都换换口味，希望对于不同的 $a$，最后选定的餐厅各不相同。她想要知道满足要求的 $k$ 的个数，但又忙于与 Bob 下棋没有时间算，于是只好求助于你啦。\n\n形式化地说，对于给定的 $n$，你需要求有多少个整数 $k \\in [0, \\text{lcm}_{i=1}^{n}i)$ ，满足 $k\\bmod 2,k\\bmod3 ,..., k\\bmod n$ 各不相同。答案对 $998244353$ 取模。", "inputFormat": "第一行一个整数 $T$，表示共有 $T$ 组数据。\n\n接下来 $T$ 行，每行一个整数 $n$ ，含义见题面。", "outputFormat": "共 $T$ 行，每行一个整数，表示满足要求的 $k$ 的数量。", "hint": "**【样例解释1】**\n\n$n=3,4$ 时，$k$ 的取值集合分别为 $\\{2, 3, 4, 5\\}$ 、 $\\{3, 10, 11\\}$。\n\n$n=5$ 时：\n\n| $k$ | $k \\bmod 2$ | $k \\bmod 3$ | $k \\bmod 4$ | $k \\bmod 5$ |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $27$ | $1$ | $0$ | $3$ | $2$ |\n| $34$ | $0$ | $1$ | $2$ | $4$ |\n| $35$ | $1$ | $2$ | $3$ | $0$ |\n| $39$ | $1$ | $0$ | $3$ | $4$ |\n| $58$ | $0$ | $1$ | $2$ | $3$ |\n| $59$ | $1$ | $2$ | $3$ | $4$ |\n\n$\\text{lcm}_{i=1}^{n}i=60$，可以验证在 $[0,60)$ 内不存在其他的 $k$ 满足条件，故答案为 $6$。\n\n| 测试点编号 | $T \\leq$ | $n \\leq$ |\n| -----------: | -----------: | -----------: |\n| $1-2$ | $15$ | $15$ |\n| $3-6$ | $1000$ | $1000$ |\n| $7-12$ | $1000$ | $2 \\times 10^7$ |\n| $13-20$ | $15$ | $2 \\times 10^9$ |\n\n对于 $100\\%$ 的数据，满足 $3 \\leq n \\leq 2 \\times 10^9$，$ T \\leq 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "选择困难症", "background": "Parviz 认为，如果一道题有一个可以显著优化复杂度的方法而不去使用，那这题就是有遗憾的。\n\nAlice 认为，任何算法难度大于思维难度的题，出在正式比赛中都是没有意义的。\n\n猫猫认为，ta 是学数学学的。\n\n$\\textsf{linyue}$ 认为……啊？你们在说啥？\n\n很有喜剧效果的是这四个名字你可能都没法一下子对上号（", "description": "Alice 与 Bob 在下棋之余，也需要一些娱乐活动来放松身心，比如去小吃街吃饭。作为一名绅士，Bob 每次都让 Alice 选择要去吃哪家。这却让 Alice 犯了难——她有选择困难症。\n\n小吃街有 $n$ 家饭店，在第 $i$ 家就餐需要 $i$ 元钱。如果预算为 $a$ 元，则可以选择前 $a$ 家餐厅。\n\n在长期的纠结后，Alice 想到一种方法：她提前在心里想好一个非负整数 $k< \\text{lcm}_{i=1}^{n} i$ ，在得知预算 $a$ 之后，选择在第 $(k$ $\\text{mod}$ $a)+1$ 家餐厅就餐。\n\n由于买棋盘与棋子的市场价格浮动，每次就餐的预算未必相同，但都是 $[2,n]$ 之间的整数。Alice 想每次都换换口味，希望对于不同的 $a$，最后选定的餐厅各不相同。她想要知道满足要求的 $k$ 的个数，但又忙于与 Bob 下棋没有时间算，于是只好求助于你啦。\n\n形式化地说，对于给定的 $n$，你需要求有多少个整数 $k \\in [0, \\text{lcm}_{i=1}^{n}i)$ ，满足 $k\\bmod 2,k\\bmod3 ,..., k\\bmod n$ 各不相同。答案对 $998244353$ 取模。", "inputFormat": "第一行一个整数 $T$，表示共有 $T$ 组数据。\n\n接下来 $T$ 行，每行一个整数 $n$ ，含义见题面。", "outputFormat": "共 $T$ 行，每行一个整数，表示满足要求的 $k$ 的数量。", "hint": "**【样例解释1】**\n\n$n=3,4$ 时，$k$ 的取值集合分别为 $\\{2, 3, 4, 5\\}$ 、 $\\{3, 10, 11\\}$。\n\n$n=5$ 时：\n\n| $k$ | $k \\bmod 2$ | $k \\bmod 3$ | $k \\bmod 4$ | $k \\bmod 5$ |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $27$ | $1$ | $0$ | $3$ | $2$ |\n| $34$ | $0$ | $1$ | $2$ | $4$ |\n| $35$ | $1$ | $2$ | $3$ | $0$ |\n| $39$ | $1$ | $0$ | $3$ | $4$ |\n| $58$ | $0$ | $1$ | $2$ | $3$ |\n| $59$ | $1$ | $2$ | $3$ | $4$ |\n\n$\\text{lcm}_{i=1}^{n}i=60$，可以验证在 $[0,60)$ 内不存在其他的 $k$ 满足条件，故答案为 $6$。\n\n| 测试点编号 | $T \\leq$ | $n \\leq$ |\n| -----------: | -----------: | -----------: |\n| $1-2$ | $15$ | $15$ |\n| $3-6$ | $1000$ | $1000$ |\n| $7-12$ | $1000$ | $2 \\times 10^7$ |\n| $13-20$ | $15$ | $2 \\times 10^9$ |\n\n对于 $100\\%$ 的数据，满足 $3 \\leq n \\leq 2 \\times 10^9$，$ T \\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P10896", "type": "P", "difficulty": 7, "samples": [["2\n2 2", "62500001"], ["5\n1 2 3 4 5", "762695321"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "组合数学", "Catalan 数"], "title": "移言丁真：Unavoided linyue", "background": "**注：你不需要阅读此题题目背景。**\n\n\"$\\textsf{linyue}$\" 是我起过的唯一一个人名，所以 $\\textsf{linyue}$ 成了唯一一个由我想象出来的角色。她是我脑海中所有故事的主角，对我而言非常地重要，以至于不知道为什么，每次我看到她的名字被写出来或是被读出来都会感到无所适从，所以我总是会想办法避免这样，比如说这个题的题面里我就用的是拼音作代替。\n\n“跑团”这种游戏我最初了解的时候简直是“绝望地想要跟不管是谁玩随便什么”。可是疫情却让我的好多和同学玩的计划纷纷泡汤，所以我甚至走投无路到把它也纳入了计划的考虑范畴，不过由于它实在是太复杂了，没过多久我就把它抛诸脑后了（\n\n“黑影杀”是一款在泞之翼官方交流群里兴起的游戏，玩家将会探索《泞之翼》原作的旅馆，躲避黑影以求逃出生天——对我而言没有比这更完美的事了！它完全实现了我上一段里的愿望，只要一有空，我便可以在群里“开鲨”！我给这个游戏准备了便于主持的程序，写了许多特殊规则，甚至还以它为背景出了题——尽管这题投到的比赛咕了（\n\n《怪商一克拉》是一部我很喜欢的漫画。它的特点就是主角好像在每段故事里都只会最小程度地完成任务，然后哪怕这个故事还有好多未解之谜都只会跳到下一段故事。尽管这看起来像是没写好，但我相信这种效果作者是刻意为之。所以我期待着在未来看到这些故事的伏笔被精妙地解决，带来一个震撼的结局。可是有一天，我没有在漫画派对上看到这部漫画。这意味着以上就都不会发生了……我当时心态崩了好长时间，甚至都到泞之翼群里发癫了，不过事实上作者只是请了一个月假，接下来这漫画还会照常更新（\n\n前两天，我终于又找到机会和同学出去玩了！这一次我们打算上一个主营镜土 TRPG 的店里试试跑团。要知道，这对我而言还是很有吸引力的，因为之前不管是玩什么，都是\"我\"在玩，跟 $\\textsf{linyue}$ 没有什么关系。但要是玩跑团做角色卡的话，是不是就能填补这个遗憾了呢？所以这次我是有备而来！我提前十分费力地给 $\\textsf{linyue}$ 画了一张简单的画，然后输入名字的时候，我决定不再回避——用她那两个汉字的真名，而非六个字母的替代。\n\n然而，尽管我这一天听到和看到她名字的次数前所未有，但最后却并没什么很好的效果。我在游戏里确实是主打一个不入戏，对话内容有种全人类取平均的美，没推理出什么剧情的关键，也没想到什么新奇的点子。相信把我换成 Kimi AI 游戏绝对会更有趣……\n\n——不过当然啦，这倒也在我意料之中，因为我知道我本来就非常非常不擅长这种角色扮演……看来对我而言，创造 $\\textsf{linyue}$ 的故事会比别人更加困难。\n\n所以我不会太受这个问题的困扰，一是因为习惯了，二是因为——我们出题组的比赛没过审。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7qwdep44.png)\n\n“移言丁真”是这场比赛的原定 E 题之一，可是它被鉴定为了典……显然这最主要是我的锅。所以我现在的当务之急是要想一个新的 idea……", "description": "定义一个括号串的权值为其中可配对的括号组数。也就是你重复地在里面删除掉某个为 ```()``` 的子串，最多可以删除的次数。\n\n你会遇到 $m$ 个括号串，第 $i$ 个的长度是 $l_i$。你可以将它们按照任意顺序连接起来，然后连成一个长的括号串，而你的目标就是让最终的串的权值最小。\n\n如果这 $m$ 个串是等概率随机生成的，而你的操作是最优的，请你求出最终权值的期望。也就是说你要对于初始括号串的所有可能性求出最小权值的和再除以 $2^n$，$n$ 为这些字符串的总长。对 $10^9+7$ 取模。", "inputFormat": "第一行一个整数 $m$。\n\n第二行 $m$ 个整数，表示 $l_1$ 到 $l_m$。", "outputFormat": "一行一个整数表示答案，对 $10^9+7$ 取模。", "hint": "**【样例解释1】**\n\n这里 $\\{S_1,S_2\\}$ 表示两个括号串构成的无序可重集合，$P$ 表示取到这样集合的概率。\n\n| $\\{S_1,S_2\\}$ | $P$ | 最优方案 | 权值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\{$```((```$,$```((```$\\}$ | $\\frac{1}{16}$ | ```((((``` | $0$\n| $\\{$```((```$,$```()```$\\}$ | $\\frac{1}{8}$ | 任意 | $1$\n| $\\{$```((```$,$```)(```$\\}$ | $\\frac{1}{8}$ | ```)(((``` | $0$\n| $\\{$```((```$,$```))```$\\}$ | $\\frac{1}{8}$ | ```))((``` | $0$\n| $\\{$```()```$,$```()```$\\}$ | $\\frac{1}{16}$ | ```()()``` | $2$\n| $\\{$```()```$,$```)(```$\\}$ | $\\frac{1}{8}$ | 任意 | $1$\n| $\\{$```()```$,$```))```$\\}$ | $\\frac{1}{8}$ | 任意 | $1$\n| $\\{$```)(```$,$```)(```$\\}$ | $\\frac{1}{16}$ | ```)()(``` | $1$\n| $\\{$```)(```$,$```))```$\\}$ | $\\frac{1}{8}$ | ```)))(``` | $0$\n| $\\{$```))```$,$```))```$\\}$ | $\\frac{1}{16}$ | ```))))``` | $0$\n\n最终答案为 $\\dfrac{9}{16}$。\n\n**【数据范围】**\n\n令 $n$ 为 $l_i$ 的总和。\n\n子任务 $1$（$20$ 分）: $n \\le 20$。\n\n子任务 $2$（$30$ 分）: $n \\le 5000$。\n\n子任务 $3$（$50$ 分）: $n \\le 4000000$。\n\n保证 $l_i \\ge 1$。\n\n**【后记】**\n\n左括号和右括号可以是 $\\textsf{linyue}$ 名字的第一个字和第二个字，也可以是一段故事的萌芽和结果。\n\n下一次跑团遥遥无期，黑影杀渐渐无人问津，我们团的三个原定 E 题和其他好多好多的 idea 不知道何去何从，那些和 $\\textsf{linyue}$ 有关的故事和设想更是也难以被呈现。有时我感觉自己就像是在《怪商一克拉》里一样，好多段经历都没等到自己的右括号，有种被最小化了权值的美。所以，我总是期待这些故事的伏笔被精妙地解决，带来最大的幸福。不过在这之前，我只好继续回避 “$\\textsf{linyue}$” 了。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "移言丁真：Unavoided linyue", "background": "**注：你不需要阅读此题题目背景。**\n\n\"$\\textsf{linyue}$\" 是我起过的唯一一个人名，所以 $\\textsf{linyue}$ 成了唯一一个由我想象出来的角色。她是我脑海中所有故事的主角，对我而言非常地重要，以至于不知道为什么，每次我看到她的名字被写出来或是被读出来都会感到无所适从，所以我总是会想办法避免这样，比如说这个题的题面里我就用的是拼音作代替。\n\n“跑团”这种游戏我最初了解的时候简直是“绝望地想要跟不管是谁玩随便什么”。可是疫情却让我的好多和同学玩的计划纷纷泡汤，所以我甚至走投无路到把它也纳入了计划的考虑范畴，不过由于它实在是太复杂了，没过多久我就把它抛诸脑后了（\n\n“黑影杀”是一款在泞之翼官方交流群里兴起的游戏，玩家将会探索《泞之翼》原作的旅馆，躲避黑影以求逃出生天——对我而言没有比这更完美的事了！它完全实现了我上一段里的愿望，只要一有空，我便可以在群里“开鲨”！我给这个游戏准备了便于主持的程序，写了许多特殊规则，甚至还以它为背景出了题——尽管这题投到的比赛咕了（\n\n《怪商一克拉》是一部我很喜欢的漫画。它的特点就是主角好像在每段故事里都只会最小程度地完成任务，然后哪怕这个故事还有好多未解之谜都只会跳到下一段故事。尽管这看起来像是没写好，但我相信这种效果作者是刻意为之。所以我期待着在未来看到这些故事的伏笔被精妙地解决，带来一个震撼的结局。可是有一天，我没有在漫画派对上看到这部漫画。这意味着以上就都不会发生了……我当时心态崩了好长时间，甚至都到泞之翼群里发癫了，不过事实上作者只是请了一个月假，接下来这漫画还会照常更新（\n\n前两天，我终于又找到机会和同学出去玩了！这一次我们打算上一个主营镜土 TRPG 的店里试试跑团。要知道，这对我而言还是很有吸引力的，因为之前不管是玩什么，都是\"我\"在玩，跟 $\\textsf{linyue}$ 没有什么关系。但要是玩跑团做角色卡的话，是不是就能填补这个遗憾了呢？所以这次我是有备而来！我提前十分费力地给 $\\textsf{linyue}$ 画了一张简单的画，然后输入名字的时候，我决定不再回避——用她那两个汉字的真名，而非六个字母的替代。\n\n然而，尽管我这一天听到和看到她名字的次数前所未有，但最后却并没什么很好的效果。我在游戏里确实是主打一个不入戏，对话内容有种全人类取平均的美，没推理出什么剧情的关键，也没想到什么新奇的点子。相信把我换成 Kimi AI 游戏绝对会更有趣……\n\n——不过当然啦，这倒也在我意料之中，因为我知道我本来就非常非常不擅长这种角色扮演……看来对我而言，创造 $\\textsf{linyue}$ 的故事会比别人更加困难。\n\n所以我不会太受这个问题的困扰，一是因为习惯了，二是因为——我们出题组的比赛没过审。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7qwdep44.png)\n\n“移言丁真”是这场比赛的原定 E 题之一，可是它被鉴定为了典……显然这最主要是我的锅。所以我现在的当务之急是要想一个新的 idea……", "description": "定义一个括号串的权值为其中可配对的括号组数。也就是你重复地在里面删除掉某个为 ```()``` 的子串，最多可以删除的次数。\n\n你会遇到 $m$ 个括号串，第 $i$ 个的长度是 $l_i$。你可以将它们按照任意顺序连接起来，然后连成一个长的括号串，而你的目标就是让最终的串的权值最小。\n\n如果这 $m$ 个串是等概率随机生成的，而你的操作是最优的，请你求出最终权值的期望。也就是说你要对于初始括号串的所有可能性求出最小权值的和再除以 $2^n$，$n$ 为这些字符串的总长。对 $10^9+7$ 取模。", "inputFormat": "第一行一个整数 $m$。\n\n第二行 $m$ 个整数，表示 $l_1$ 到 $l_m$。", "outputFormat": "一行一个整数表示答案，对 $10^9+7$ 取模。", "hint": "**【样例解释1】**\n\n这里 $\\{S_1,S_2\\}$ 表示两个括号串构成的无序可重集合，$P$ 表示取到这样集合的概率。\n\n| $\\{S_1,S_2\\}$ | $P$ | 最优方案 | 权值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\{$```((```$,$```((```$\\}$ | $\\frac{1}{16}$ | ```((((``` | $0$\n| $\\{$```((```$,$```()```$\\}$ | $\\frac{1}{8}$ | 任意 | $1$\n| $\\{$```((```$,$```)(```$\\}$ | $\\frac{1}{8}$ | ```)(((``` | $0$\n| $\\{$```((```$,$```))```$\\}$ | $\\frac{1}{8}$ | ```))((``` | $0$\n| $\\{$```()```$,$```()```$\\}$ | $\\frac{1}{16}$ | ```()()``` | $2$\n| $\\{$```()```$,$```)(```$\\}$ | $\\frac{1}{8}$ | 任意 | $1$\n| $\\{$```()```$,$```))```$\\}$ | $\\frac{1}{8}$ | 任意 | $1$\n| $\\{$```)(```$,$```)(```$\\}$ | $\\frac{1}{16}$ | ```)()(``` | $1$\n| $\\{$```)(```$,$```))```$\\}$ | $\\frac{1}{8}$ | ```)))(``` | $0$\n| $\\{$```))```$,$```))```$\\}$ | $\\frac{1}{16}$ | ```))))``` | $0$\n\n最终答案为 $\\dfrac{9}{16}$。\n\n**【数据范围】**\n\n令 $n$ 为 $l_i$ 的总和。\n\n子任务 $1$（$20$ 分）: $n \\le 20$。\n\n子任务 $2$（$30$ 分）: $n \\le 5000$。\n\n子任务 $3$（$50$ 分）: $n \\le 4000000$。\n\n保证 $l_i \\ge 1$。\n\n**【后记】**\n\n左括号和右括号可以是 $\\textsf{linyue}$ 名字的第一个字和第二个字，也可以是一段故事的萌芽和结果。\n\n下一次跑团遥遥无期，黑影杀渐渐无人问津，我们团的三个原定 E 题和其他好多好多的 idea 不知道何去何从，那些和 $\\textsf{linyue}$ 有关的故事和设想更是也难以被呈现。有时我感觉自己就像是在《怪商一克拉》里一样，好多段经历都没等到自己的右括号，有种被最小化了权值的美。所以，我总是期待这些故事的伏笔被精妙地解决，带来最大的幸福。不过在这之前，我只好继续回避 “$\\textsf{linyue}$” 了。", "locale": "zh-CN"}}}
