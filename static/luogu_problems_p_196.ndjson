{"pid": "P4964", "type": "P", "difficulty": 6, "samples": [["3 3 2\n19720918 0 1 2 0", "700"], ["10 10 8\n2102036 0 1 4 1\n5 2", "760521825"], ["1000 1000 126\n114321251 1 2 2 0", "91977056"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "枚举", "排序", "深度优先搜索 DFS", "栈"], "title": "绫小路的特别考试", "background": ">  这世界上「胜利」便是一切。无关乎过程。\n要付出多少牺牲都无所谓。只要最后我「胜出」那就行了。\n\n![](https://i.loli.net/2018/10/06/5bb879f4ac370.jpg)", "description": "一场新的特别考试来临了，这次的考试内容是（wan e de）文化课，但有所不同的是，考试中允许学生使用对讲机。然而，对讲机的接收范围是有限的（每个对讲机都能发送无限远，但是只能接收到接收范围内的信号），所以不是所有学生都能接收到其他同学的广播。\n\n考试时，共有 $n$ 名学生坐成一排（从左至右依次编号为 $1$ ~ $n$），绫小路自己坐在第 $c$ 号位置。每名学生都有一个能力值 $w_i$。绫小路已经给每名学生安排了一个接收范围为 $d_i$ 的对讲机。\n\n每名学生可以直接做出难度**不超过**自身能力值的**所有**题目，一旦一名学生凭能力做出某道题，他就会把这道题的做法进行广播。一名坐在位置 $i$，有接收范围为 $d_i$ 的对讲机的学生，可以接收到 $[i-d_i,\\ i+d_i]$ 范围内所有学生的广播，若这个范围内有人公布了做法，则他将会做这道题，并也会把这道题的做法进行广播。\n\n绫小路会问你一些问题：当一道题目难度为 $x$ 时，有多少学生会做这道题？由于绫小路想隐藏实力，他可能会修改自己的能力值。这两种操作分别用以下两种方式表示：\n\n- $1\\ x$，表示询问当一道题目难度为 $x$ 时，有多少学生会做这道题。\n\n- $2\\ x$，将绫小路的能力值修改为 $x$，即将 $w_c$ 修改为 $x$。\n\n---\n\n形式化描述（与上文同义）：\n\n> 给你两个长为 $n$ 的数列 $w_{1..n}$ 和 $d_{1..n}$，以及一个 $w_c$ 可修改的位置 $c$。现在有两种操作（共 $m$ 次）：\n- $1\\ x$ 表示一次询问：设 $f_i=\\begin{cases}1\\quad(w_i\\ge x)\\\\1\\quad(\\exists\\ j \\in [i - d_i,\\ i + d_i],\\ f_j=1)\\\\ 0\\quad(otherwise)\\end{cases}$，这里的 $f_i$ 定义中引用了 $f_j$，$\\ \\ \\ \\ $所以 $f_{1..n}$ 是会不断更新的，直到无法继续更新时，计算这次询问的答案为 $\\sum\\limits_{i=1}^nf_i$。\n- $2\\ x$ 表示一次修改：把 $w_c$ 修改为 $x$。", "inputFormat": "由于数据量太大，为了避免读入耗时过长，使用**伪随机数生成器**的方式输入，并**强制在线**。\n\n**建议你忽略输入格式，直接使用下面提供的数据生成器模板，了解具体的生成过程对你来说是不必要的。**\n\n第一行，三个正整数 $n,\\ m,\\ c$，分别代表学生的总人数，操作总数和绫小路所在的位置。\n\n第二行，五个整数 $\\mathrm{seed},\\ \\mathrm{mind},\\ \\mathrm{maxd},\\ \\mathrm{mfq},\\ k$。\n\n> 此处的 $\\mathrm{mind},\\ \\mathrm{maxd}$ 仅用于生成初始的 $d_{1..n}$，下文中调整 $d_p$ 所用的 $t$ 可能不在 $[\\mathrm{mind},\\ \\mathrm{maxd}]$ 范围内。\n\n接下来的 $k$ 行，每行两个整数 $p,\\ t$，表示调整第 $p$ 号同学的对讲机接收范围（即 $d_p$）为 $t$。\n\n> 若一名同学的对讲机接收范围被调整多次，以**最后一次**为准。\n\n---\n\n** 数据生成器模板：**\n\n```cpp\n#include <cstdio>\n\nunsigned long long seed;\nint n, m, c, mfq, mind, maxd, k, w[2000001], d[2000001];\n\ninline int randInt() { seed = 99999989 * seed + 1000000007; return seed >> 33; } \n\nvoid generate()\n{\n\t// 在读入种子后生成初始的 w 数组和 d 数组.\n    for (int i = 1; i <= n; i++) { w[i] = randInt() % n; }\n    for (int i = 1; i <= n; i++) { d[i] = randInt() % (maxd - mind + 1) + mind; }\n}\n\nvoid getOperation(int lastans, int &opt, int &x)\n{\n    // 生成一次操作的参数 opt 和 x, lastans 表示上一次询问的答案, 初始值为 0.\n    if ((0ll + randInt() + lastans) % mfq) { opt = 1; } else { opt = 2; }\n    x = (0ll + randInt() + lastans) % n;\n}\n\nint main()\n{\n    scanf(\"%d %d %d\", &n, &m, &c);\n    scanf(\"%llu %d %d %d %d\", &seed, &mind, &maxd, &mfq, &k);\n    generate();\n    for (int i = 1; i <= k; i++)\n    {\n        int p, t;\n        scanf(\"%d %d\", &p, &t);\n        d[p] = t;\n    }\n    // 从这里开始，你可以使用生成的 w 数组和 d 数组.\n    int lastans = 0, finalans = 0;\n    for (int i = 1; i <= m; i++)\n    {\n        int opt, x;\n        getOperation(lastans, opt, x);\n        if (opt == 1)\n        {\n            // 在这里执行询问操作，并用答案的表达式替代下面的 ___.      \n            finalans = (finalans * 233ll + ___) % 998244353;\n            lastans = ___;\n        }\n        else\n        {\n            // 在这里执行修改操作.\n        }\n    }\n    printf(\"%d\\n\", finalans);\n    return 0;\n}\n```", "outputFormat": "令 $ans_i$ 表示第 $i$ 次询问（操作 $1$）的答案，$T_i=\\begin{cases}(T_{i-1}\\times 233+ans_i)\\mod 998244353\\quad(i\\ge 1)\\\\0\\quad(i=0)\\end{cases}$\n\n设 $q$ 表示询问（操作 $1$）的个数，你只需要输出一个整数 $T_q$。", "hint": "### 你需要用到的变量：\n\n$1\\le c\\le n\\le 2\\times 10^6$，$1\\le m\\le 2\\times 10^6$，$0\\le w_i,\\ d_i,\\ x<n$。\n\n### 其它用于生成数据的变量：\n\n$1\\le \\mathrm{seed},\\ \\mathrm{mfq}\\le 10^9$，$0\\le \\mathrm{mind}\\le \\mathrm{maxd}<n$，$0\\le k\\le 2\\times 10^5$，$1\\le p\\le n$，$0\\le t<n$。\n\n## 样例解释\n\n### 样例一：\n\n生成得到三名同学的能力值 $w_{1..3} = \\{0,\\ 1,\\ 2\\}$，对讲机接收范围 $d_{1..3} = \\{1,\\ 0,\\ 1\\}$。\n\n第一个操作是 `1 1`，询问有多少同学会做难度为 $1$ 的题。\n\n绫小路（第 $2$ 名同学）和第 $3$ 名同学能够独立做出这道题（$w_2 \\ge 1$ ，$w_3 \\ge 1$），第 $1$ 名同学虽然能力不足，但通过对讲机能接收到绫小路广播的做法（$2 \\in [1 - d_1,\\ 1 + d_1]$），所以他也会做。故 $ans_1 = 3$。\n\n第二个操作是 `2 0`，修改绫小路（第 $2$ 名同学）的能力值为 $0$。此时 $w_{1..3} = \\{0,\\ 0,\\ 2\\}$。\n\n第三个操作是 `1 1`，再次询问有多少同学会做难度为 $1$ 的题。\n\n只有第 $3$ 名同学能够独立做出（$w_3 \\ge 1$），然而第 $1$ 名同学和绫小路（第 $2$ 名同学）都无法接收到他广播的做法（$3 \\notin [1 - d_1,\\ 1 + d_1]$，$3 \\notin [2 - d_2,\\ 2 + d_2]$），做不出来。故 $ans_2 = 1$。\n\n综上所述，$T_1 = ans_1 = 3$，$T_2 = 3 \\times T_1+ ans_2 = 3 \\times 233 + 1 = 700$，仅输出 $700$ 即可。\n\n### 样例二：\n\n生成得到 $w_{1..10} = \\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 7,\\ 9,\\ 5\\}$，$d_{1..10} =\\{1,\\ 1,\\ 1,\\ 1,\\ 2,\\ 0,\\ 1,\\ 0,\\ 1,\\ 1\\}$。\n\n十次操作及对应结果如下所示：\n\n`1 6`，查询操作，$ans_1 = 9$，$T_1 = 9$。\n\n`2 2`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$。\n\n`1 7`，查询操作，$ans_2 = 2$，$T_2 = 2099$。\n\n`1 3`，查询操作，$ans_3 = 9$，$T_3 = 489076$。\n\n`2 4`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 4,\\ 9,\\ 5\\}$。\n\n`1 3`，查询操作，$ans_4 = 10$，$T_4 = 113954718$。\n  \n`2 2`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$。\n  \n`1 9`，查询操作，$ans_5 = 2$，$T_5 = 597096118$。  \n\n`1 0`，查询操作，$ans_6 = 10$，$T_6 = 367430437$。    \n\n`1 3`，查询操作，$ans_7 = 9$，$T_7 = 760521825$。\n\n仅输出 $760521825$ 即可。\n\n### 样例三：\n\n~~出题人有足够的良心写出这个样例的解释，可惜版面太小，写不下。~~", "locale": "zh-CN", "translations": {"en": {"title": "Ayanokoji's Special Exam.", "background": "> In this world, “victory” is everything. The process does not matter.  \nNo matter how many sacrifices it takes. As long as I “win” in the end, that is enough.\n\n![](https://i.loli.net/2018/10/06/5bb879f4ac370.jpg)", "description": "A new special exam is coming. This time the exam content is cultural courses (wan e de), but the difference is that students are allowed to use walkie-talkies during the exam. However, the receiving range of a walkie-talkie is limited (each walkie-talkie can transmit infinitely far, but can only receive signals within its receiving range), so not all students can receive broadcasts from other students.\n\nDuring the exam, there are $n$ students sitting in a row (numbered from left to right as $1$ to $n$). Ayanokoji sits at position $c$. Each student has an ability value $w_i$. Ayanokoji has assigned each student a walkie-talkie with receiving range $d_i$.\n\nEach student can directly solve **all** problems whose difficulty is **not greater than** their own ability value. Once a student solves a problem by their own ability, they will broadcast the solution to that problem. A student sitting at position $i$ with a walkie-talkie of receiving range $d_i$ can receive broadcasts from all students in the range $[i-d_i,\\ i+d_i]$. If someone within this range has published the solution, then they will solve the problem too, and will also broadcast the solution.\n\nAyanokoji will ask you some questions: when a problem has difficulty $x$, how many students will solve it? Since Ayanokoji wants to hide his true strength, he may modify his own ability value. These two types of operations are represented as follows:\n\n- $1\\ x$: query how many students will solve a problem with difficulty $x$.\n- $2\\ x$: modify Ayanokoji's ability value to $x$, i.e., set $w_c$ to $x$.\n\n---\n\nFormal description (equivalent to the above):\n\n> You are given two sequences $w_{1..n}$ and $d_{1..n}$ of length $n$, and a position $c$ where $w_c$ can be modified. There are two types of operations (a total of $m$ times):\n- $1\\ x$ indicates a query: let $f_i=\\begin{cases}1\\quad(w_i\\ge x)\\\\1\\quad(\\exists\\ j \\in [i - d_i,\\ i + d_i],\\ f_j=1)\\\\ 0\\quad(otherwise)\\end{cases}$. Here the definition of $f_i$ refers to $f_j$, so $f_{1..n}$ will keep updating until it can no longer be updated. The answer to this query is $\\sum\\limits_{i=1}^nf_i$.\n- $2\\ x$ indicates a modification: set $w_c$ to $x$.", "inputFormat": "Because the data size is too large, to avoid slow input reading, the input is given using a **pseudorandom number generator** and is **forced online**.\n\n**It is recommended that you ignore the input format and directly use the data generator template provided below. Understanding the specific generation process is not necessary for you.**\n\nThe first line contains three positive integers $n,\\ m,\\ c$, representing the total number of students, the total number of operations, and Ayanokoji's position.\n\nThe second line contains five integers $\\mathrm{seed},\\ \\mathrm{mind},\\ \\mathrm{maxd},\\ \\mathrm{mfq},\\ k$.\n\n> Here $\\mathrm{mind},\\ \\mathrm{maxd}$ are only used to generate the initial $d_{1..n}$. The $t$ used later to adjust $d_p$ may not be within the range $[\\mathrm{mind},\\ \\mathrm{maxd}]$.\n\nIn the next $k$ lines, each line contains two integers $p,\\ t$, indicating that the receiving range of student $p$'s walkie-talkie (i.e., $d_p$) is adjusted to $t$.\n\n> If a student's walkie-talkie receiving range is adjusted multiple times, the **last** adjustment takes effect.\n\n---\n\n**Data generator template:**\n\n```cpp\n#include <cstdio>\n\nunsigned long long seed;\nint n, m, c, mfq, mind, maxd, k, w[2000001], d[2000001];\n\ninline int randInt() { seed = 99999989 * seed + 1000000007; return seed >> 33; } \n\nvoid generate()\n{\n\t// 在读入种子后生成初始的 w 数组和 d 数组.\n    for (int i = 1; i <= n; i++) { w[i] = randInt() % n; }\n    for (int i = 1; i <= n; i++) { d[i] = randInt() % (maxd - mind + 1) + mind; }\n}\n\nvoid getOperation(int lastans, int &opt, int &x)\n{\n    // 生成一次操作的参数 opt 和 x, lastans 表示上一次询问的答案, 初始值为 0.\n    if ((0ll + randInt() + lastans) % mfq) { opt = 1; } else { opt = 2; }\n    x = (0ll + randInt() + lastans) % n;\n}\n\nint main()\n{\n    scanf(\"%d %d %d\", &n, &m, &c);\n    scanf(\"%llu %d %d %d %d\", &seed, &mind, &maxd, &mfq, &k);\n    generate();\n    for (int i = 1; i <= k; i++)\n    {\n        int p, t;\n        scanf(\"%d %d\", &p, &t);\n        d[p] = t;\n    }\n    // 从这里开始，你可以使用生成的 w 数组和 d 数组.\n    int lastans = 0, finalans = 0;\n    for (int i = 1; i <= m; i++)\n    {\n        int opt, x;\n        getOperation(lastans, opt, x);\n        if (opt == 1)\n        {\n            // 在这里执行询问操作，并用答案的表达式替代下面的 ___.      \n            finalans = (finalans * 233ll + ___) % 998244353;\n            lastans = ___;\n        }\n        else\n        {\n            // 在这里执行修改操作.\n        }\n    }\n    printf(\"%d\\n\", finalans);\n    return 0;\n}\n```", "outputFormat": "Let $ans_i$ denote the answer to the $i$-th query (operation $1$), and let $T_i=\\begin{cases}(T_{i-1}\\times 233+ans_i)\\mod 998244353\\quad(i\\ge 1)\\\\0\\quad(i=0)\\end{cases}$.\n\nLet $q$ be the number of queries (operation $1$). You only need to output one integer $T_q$.", "hint": "### Variables you will need:\n\n$1\\le c\\le n\\le 2\\times 10^6$, $1\\le m\\le 2\\times 10^6$, $0\\le w_i,\\ d_i,\\ x<n$.\n\n### Other variables used to generate the testdata:\n\n$1\\le \\mathrm{seed},\\ \\mathrm{mfq}\\le 10^9$, $0\\le \\mathrm{mind}\\le \\mathrm{maxd}<n$, $0\\le k\\le 2\\times 10^5$, $1\\le p\\le n$, $0\\le t<n$.\n\n## Sample Explanation\n\n### Sample 1:\n\nGenerated ability values for the three students are $w_{1..3} = \\{0,\\ 1,\\ 2\\}$, and the walkie-talkie receiving ranges are $d_{1..3} = \\{1,\\ 0,\\ 1\\}$.\n\nThe first operation is `1 1`, asking how many students can solve a problem of difficulty $1$.\n\nAyanokoji (student $2$) and student $3$ can solve it independently ($w_2 \\ge 1$, $w_3 \\ge 1$). Although student $1$ does not have enough ability, he can receive the solution broadcast by Ayanokoji through the walkie-talkie ($2 \\in [1 - d_1,\\ 1 + d_1]$), so he can solve it as well. Therefore $ans_1 = 3$.\n\nThe second operation is `2 0`, modifying Ayanokoji's (student $2$) ability value to $0$. Now $w_{1..3} = \\{0,\\ 0,\\ 2\\}$.\n\nThe third operation is `1 1`, asking again how many students can solve a problem of difficulty $1$.\n\nOnly student $3$ can solve it independently ($w_3 \\ge 1$). However, neither student $1$ nor Ayanokoji (student $2$) can receive his broadcast solution ($3 \\notin [1 - d_1,\\ 1 + d_1]$, $3 \\notin [2 - d_2,\\ 2 + d_2]$), so they cannot solve it. Therefore $ans_2 = 1$.\n\nIn summary, $T_1 = ans_1 = 3$, $T_2 = 3 \\times T_1+ ans_2 = 3 \\times 233 + 1 = 700$. You only need to output $700$.\n\n### Sample 2:\n\nGenerated $w_{1..10} = \\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 7,\\ 9,\\ 5\\}$, $d_{1..10} =\\{1,\\ 1,\\ 1,\\ 1,\\ 2,\\ 0,\\ 1,\\ 0,\\ 1,\\ 1\\}$.\n\nThe ten operations and their corresponding results are as follows:\n\n`1 6`, query, $ans_1 = 9$, $T_1 = 9$.\n\n`2 2`, modification, $w_{1..10}$ becomes $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$.\n\n`1 7`, query, $ans_2 = 2$, $T_2 = 2099$.\n\n`1 3`, query, $ans_3 = 9$, $T_3 = 489076$.\n\n`2 4`, modification, $w_{1..10}$ becomes $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 4,\\ 9,\\ 5\\}$.\n\n`1 3`, query, $ans_4 = 10$, $T_4 = 113954718$.\n\n`2 2`, modification, $w_{1..10}$ becomes $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$.\n\n`1 9`, query, $ans_5 = 2$, $T_5 = 597096118$.\n\n`1 0`, query, $ans_6 = 10$, $T_6 = 367430437$.\n\n`1 3`, query, $ans_7 = 9$, $T_7 = 760521825$.\n\nYou only need to output $760521825$.\n\n### Sample 3:\n\n~~The problem setter had enough conscience to write an explanation for this sample, but unfortunately the space is too small, so it cannot be written down.~~\n\n# Input Format\n\n# Output Format\n\n# Hint\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "绫小路的特别考试", "background": ">  这世界上「胜利」便是一切。无关乎过程。\n要付出多少牺牲都无所谓。只要最后我「胜出」那就行了。\n\n![](https://i.loli.net/2018/10/06/5bb879f4ac370.jpg)", "description": "一场新的特别考试来临了，这次的考试内容是（wan e de）文化课，但有所不同的是，考试中允许学生使用对讲机。然而，对讲机的接收范围是有限的（每个对讲机都能发送无限远，但是只能接收到接收范围内的信号），所以不是所有学生都能接收到其他同学的广播。\n\n考试时，共有 $n$ 名学生坐成一排（从左至右依次编号为 $1$ ~ $n$），绫小路自己坐在第 $c$ 号位置。每名学生都有一个能力值 $w_i$。绫小路已经给每名学生安排了一个接收范围为 $d_i$ 的对讲机。\n\n每名学生可以直接做出难度**不超过**自身能力值的**所有**题目，一旦一名学生凭能力做出某道题，他就会把这道题的做法进行广播。一名坐在位置 $i$，有接收范围为 $d_i$ 的对讲机的学生，可以接收到 $[i-d_i,\\ i+d_i]$ 范围内所有学生的广播，若这个范围内有人公布了做法，则他将会做这道题，并也会把这道题的做法进行广播。\n\n绫小路会问你一些问题：当一道题目难度为 $x$ 时，有多少学生会做这道题？由于绫小路想隐藏实力，他可能会修改自己的能力值。这两种操作分别用以下两种方式表示：\n\n- $1\\ x$，表示询问当一道题目难度为 $x$ 时，有多少学生会做这道题。\n\n- $2\\ x$，将绫小路的能力值修改为 $x$，即将 $w_c$ 修改为 $x$。\n\n---\n\n形式化描述（与上文同义）：\n\n> 给你两个长为 $n$ 的数列 $w_{1..n}$ 和 $d_{1..n}$，以及一个 $w_c$ 可修改的位置 $c$。现在有两种操作（共 $m$ 次）：\n- $1\\ x$ 表示一次询问：设 $f_i=\\begin{cases}1\\quad(w_i\\ge x)\\\\1\\quad(\\exists\\ j \\in [i - d_i,\\ i + d_i],\\ f_j=1)\\\\ 0\\quad(otherwise)\\end{cases}$，这里的 $f_i$ 定义中引用了 $f_j$，$\\ \\ \\ \\ $所以 $f_{1..n}$ 是会不断更新的，直到无法继续更新时，计算这次询问的答案为 $\\sum\\limits_{i=1}^nf_i$。\n- $2\\ x$ 表示一次修改：把 $w_c$ 修改为 $x$。", "inputFormat": "由于数据量太大，为了避免读入耗时过长，使用**伪随机数生成器**的方式输入，并**强制在线**。\n\n**建议你忽略输入格式，直接使用下面提供的数据生成器模板，了解具体的生成过程对你来说是不必要的。**\n\n第一行，三个正整数 $n,\\ m,\\ c$，分别代表学生的总人数，操作总数和绫小路所在的位置。\n\n第二行，五个整数 $\\mathrm{seed},\\ \\mathrm{mind},\\ \\mathrm{maxd},\\ \\mathrm{mfq},\\ k$。\n\n> 此处的 $\\mathrm{mind},\\ \\mathrm{maxd}$ 仅用于生成初始的 $d_{1..n}$，下文中调整 $d_p$ 所用的 $t$ 可能不在 $[\\mathrm{mind},\\ \\mathrm{maxd}]$ 范围内。\n\n接下来的 $k$ 行，每行两个整数 $p,\\ t$，表示调整第 $p$ 号同学的对讲机接收范围（即 $d_p$）为 $t$。\n\n> 若一名同学的对讲机接收范围被调整多次，以**最后一次**为准。\n\n---\n\n** 数据生成器模板：**\n\n```cpp\n#include <cstdio>\n\nunsigned long long seed;\nint n, m, c, mfq, mind, maxd, k, w[2000001], d[2000001];\n\ninline int randInt() { seed = 99999989 * seed + 1000000007; return seed >> 33; } \n\nvoid generate()\n{\n\t// 在读入种子后生成初始的 w 数组和 d 数组.\n    for (int i = 1; i <= n; i++) { w[i] = randInt() % n; }\n    for (int i = 1; i <= n; i++) { d[i] = randInt() % (maxd - mind + 1) + mind; }\n}\n\nvoid getOperation(int lastans, int &opt, int &x)\n{\n    // 生成一次操作的参数 opt 和 x, lastans 表示上一次询问的答案, 初始值为 0.\n    if ((0ll + randInt() + lastans) % mfq) { opt = 1; } else { opt = 2; }\n    x = (0ll + randInt() + lastans) % n;\n}\n\nint main()\n{\n    scanf(\"%d %d %d\", &n, &m, &c);\n    scanf(\"%llu %d %d %d %d\", &seed, &mind, &maxd, &mfq, &k);\n    generate();\n    for (int i = 1; i <= k; i++)\n    {\n        int p, t;\n        scanf(\"%d %d\", &p, &t);\n        d[p] = t;\n    }\n    // 从这里开始，你可以使用生成的 w 数组和 d 数组.\n    int lastans = 0, finalans = 0;\n    for (int i = 1; i <= m; i++)\n    {\n        int opt, x;\n        getOperation(lastans, opt, x);\n        if (opt == 1)\n        {\n            // 在这里执行询问操作，并用答案的表达式替代下面的 ___.      \n            finalans = (finalans * 233ll + ___) % 998244353;\n            lastans = ___;\n        }\n        else\n        {\n            // 在这里执行修改操作.\n        }\n    }\n    printf(\"%d\\n\", finalans);\n    return 0;\n}\n```", "outputFormat": "令 $ans_i$ 表示第 $i$ 次询问（操作 $1$）的答案，$T_i=\\begin{cases}(T_{i-1}\\times 233+ans_i)\\mod 998244353\\quad(i\\ge 1)\\\\0\\quad(i=0)\\end{cases}$\n\n设 $q$ 表示询问（操作 $1$）的个数，你只需要输出一个整数 $T_q$。", "hint": "### 你需要用到的变量：\n\n$1\\le c\\le n\\le 2\\times 10^6$，$1\\le m\\le 2\\times 10^6$，$0\\le w_i,\\ d_i,\\ x<n$。\n\n### 其它用于生成数据的变量：\n\n$1\\le \\mathrm{seed},\\ \\mathrm{mfq}\\le 10^9$，$0\\le \\mathrm{mind}\\le \\mathrm{maxd}<n$，$0\\le k\\le 2\\times 10^5$，$1\\le p\\le n$，$0\\le t<n$。\n\n## 样例解释\n\n### 样例一：\n\n生成得到三名同学的能力值 $w_{1..3} = \\{0,\\ 1,\\ 2\\}$，对讲机接收范围 $d_{1..3} = \\{1,\\ 0,\\ 1\\}$。\n\n第一个操作是 `1 1`，询问有多少同学会做难度为 $1$ 的题。\n\n绫小路（第 $2$ 名同学）和第 $3$ 名同学能够独立做出这道题（$w_2 \\ge 1$ ，$w_3 \\ge 1$），第 $1$ 名同学虽然能力不足，但通过对讲机能接收到绫小路广播的做法（$2 \\in [1 - d_1,\\ 1 + d_1]$），所以他也会做。故 $ans_1 = 3$。\n\n第二个操作是 `2 0`，修改绫小路（第 $2$ 名同学）的能力值为 $0$。此时 $w_{1..3} = \\{0,\\ 0,\\ 2\\}$。\n\n第三个操作是 `1 1`，再次询问有多少同学会做难度为 $1$ 的题。\n\n只有第 $3$ 名同学能够独立做出（$w_3 \\ge 1$），然而第 $1$ 名同学和绫小路（第 $2$ 名同学）都无法接收到他广播的做法（$3 \\notin [1 - d_1,\\ 1 + d_1]$，$3 \\notin [2 - d_2,\\ 2 + d_2]$），做不出来。故 $ans_2 = 1$。\n\n综上所述，$T_1 = ans_1 = 3$，$T_2 = 3 \\times T_1+ ans_2 = 3 \\times 233 + 1 = 700$，仅输出 $700$ 即可。\n\n### 样例二：\n\n生成得到 $w_{1..10} = \\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 7,\\ 9,\\ 5\\}$，$d_{1..10} =\\{1,\\ 1,\\ 1,\\ 1,\\ 2,\\ 0,\\ 1,\\ 0,\\ 1,\\ 1\\}$。\n\n十次操作及对应结果如下所示：\n\n`1 6`，查询操作，$ans_1 = 9$，$T_1 = 9$。\n\n`2 2`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$。\n\n`1 7`，查询操作，$ans_2 = 2$，$T_2 = 2099$。\n\n`1 3`，查询操作，$ans_3 = 9$，$T_3 = 489076$。\n\n`2 4`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 4,\\ 9,\\ 5\\}$。\n\n`1 3`，查询操作，$ans_4 = 10$，$T_4 = 113954718$。\n  \n`2 2`，修改操作，$w_{1..10}$ 变为 $\\{1,\\ 6,\\ 6,\\ 5,\\ 3,\\ 5,\\ 2,\\ 2,\\ 9,\\ 5\\}$。\n  \n`1 9`，查询操作，$ans_5 = 2$，$T_5 = 597096118$。  \n\n`1 0`，查询操作，$ans_6 = 10$，$T_6 = 367430437$。    \n\n`1 3`，查询操作，$ans_7 = 9$，$T_7 = 760521825$。\n\n仅输出 $760521825$ 即可。\n\n### 样例三：\n\n~~出题人有足够的良心写出这个样例的解释，可惜版面太小，写不下。~~", "locale": "zh-CN"}}}
{"pid": "P4965", "type": "P", "difficulty": 6, "samples": [["2 4\nAB\nAuAB", "9"], ["10 5\nAABBAACBAC\nABAAC", "20"], ["1 3\nU\nuUu", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "递推"], "title": "薇尔莉特的打字机", "background": "> 只要客人有意向，不论身在何处，都能上门服务。我是自动手记人偶服务——薇尔莉特·伊芙加登。\n\n![](http://wx3.sinaimg.cn/large/dcec95dfgy1fme08p9eopj20xv0hyq5q.jpg)", "description": "薇尔莉特的打字机用了太久，按键已经开始老化了，因此有时候按键会没有反应。而薇尔莉特总是盲打，因此按键没反应她也不会注意到。一天，她用这台打字机继续完成一封还没写完的信。\n\n现在告诉你这封信已经写好的部分以及薇尔莉特想进行的操作，薇尔莉特想进行的操作有两种：\n1. 在信的末尾输入一个大写字母\n2. 进行一次退格\n\n退格用小写字母 $\\mathrm{u}$ 表示，即删除当前信中的最后一个字符，当然，在信为空时退格没有任何作用。\n\n薇尔莉特会按顺序按下她想按的按键，而每次薇尔莉特按下一个键（输入一个大写字母或进行一次退格），都有可能没有反应（即这次操作无效）。请问，最后打出来的信有多少种可能呢？（空信也算信）\n\n当然薇尔莉特只想知道可能数对 `0x125E591`（十六进制） 取模的结果。", "inputFormat": "第一行两个正整数 $n,\\ m$ 分别表示已经写好的信的长度和薇尔莉特想进行的操作数（字符个数+退格个数）。\n\n第二行一个长度为 $n$ 的字符串表示已经写好的信，保证该串中的每个字符都为大写字母。\n\n第三行一个长度为 $m$ 的字符串表示薇尔莉特想进行的操作，保证该串中的每个字符都为大写字母或 $\\mathrm{u}$。", "outputFormat": "一个整数表示答案对 `0x125E591` 取模的结果。", "hint": "$1\\le n,\\ m\\le 5\\times 10^6$\n\n## 样例解释\n\n样例一：可能的 $9$ 种信为：`A`,`AA`,`AB`,`AAB`,`ABA`,`ABB`,`ABAA`,`ABAB`,`ABAAB`。\n\n样例二：~~太多了，略~~。\n\n样例三：可能的 $3$ 种信为：`空`,`U`,`UU`。", "locale": "zh-CN", "translations": {"en": {"title": "Violet Evergarden's Typewriter.", "background": "> As long as the client has the intention, no matter where they are, I can provide door-to-door service. I am the Auto Memory Doll service—Violet Evergarden.\n\n![](http://wx3.sinaimg.cn/large/dcec95dfgy1fme08p9eopj20xv0hyq5q.jpg)", "description": "Violet's typewriter has been used for too long, and the keys have started to wear out, so sometimes a key press does not respond. Violet always touch-types, so she would not notice when a key press fails. One day, she continues using this typewriter to finish a letter that is not yet complete.\n\nYou are given the already written part of the letter and the operations Violet wants to perform. There are two kinds of operations Violet may want to do:\n1. Type an uppercase letter at the end of the letter.\n2. Perform a backspace.\n\nBackspace is represented by the lowercase letter $\\mathrm{u}$, meaning deleting the last character of the current letter. Of course, if the letter is empty, backspace has no effect.\n\nViolet will press the keys in the order she intends, but each time she presses a key (typing an uppercase letter or performing a backspace), it may fail to respond (i.e., this operation becomes invalid). How many different final letters are possible? (The empty letter also counts as a letter.)\n\nYou only need the result modulo `0x125E591` (hexadecimal).", "inputFormat": "The first line contains two positive integers $n, m$, representing the length of the already written part of the letter and the number of operations Violet wants to perform (number of typed characters + number of backspaces).\n\nThe second line contains a string of length $n$ representing the already written part of the letter. It is guaranteed that every character in the string is an uppercase letter.\n\nThe third line contains a string of length $m$ representing the operations Violet wants to perform. It is guaranteed that every character in the string is either an uppercase letter or $\\mathrm{u}$.", "outputFormat": "Output one integer: the answer modulo `0x125E591`.", "hint": "$1\\le n,\\ m\\le 5\\times 10^6$\n\n# Constraints\n\n# Sample Explanation\n\nSample 1: The $9$ possible letters are: `A`, `AA`, `AB`, `AAB`, `ABA`, `ABB`, `ABAA`, `ABAB`, `ABAAB`.\n\nSample 2: ~~There are too many, omitted~~.\n\nSample 3: The $3$ possible letters are: `empty`, `U`, `UU`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "薇尔莉特的打字机", "background": "> 只要客人有意向，不论身在何处，都能上门服务。我是自动手记人偶服务——薇尔莉特·伊芙加登。\n\n![](http://wx3.sinaimg.cn/large/dcec95dfgy1fme08p9eopj20xv0hyq5q.jpg)", "description": "薇尔莉特的打字机用了太久，按键已经开始老化了，因此有时候按键会没有反应。而薇尔莉特总是盲打，因此按键没反应她也不会注意到。一天，她用这台打字机继续完成一封还没写完的信。\n\n现在告诉你这封信已经写好的部分以及薇尔莉特想进行的操作，薇尔莉特想进行的操作有两种：\n1. 在信的末尾输入一个大写字母\n2. 进行一次退格\n\n退格用小写字母 $\\mathrm{u}$ 表示，即删除当前信中的最后一个字符，当然，在信为空时退格没有任何作用。\n\n薇尔莉特会按顺序按下她想按的按键，而每次薇尔莉特按下一个键（输入一个大写字母或进行一次退格），都有可能没有反应（即这次操作无效）。请问，最后打出来的信有多少种可能呢？（空信也算信）\n\n当然薇尔莉特只想知道可能数对 `0x125E591`（十六进制） 取模的结果。", "inputFormat": "第一行两个正整数 $n,\\ m$ 分别表示已经写好的信的长度和薇尔莉特想进行的操作数（字符个数+退格个数）。\n\n第二行一个长度为 $n$ 的字符串表示已经写好的信，保证该串中的每个字符都为大写字母。\n\n第三行一个长度为 $m$ 的字符串表示薇尔莉特想进行的操作，保证该串中的每个字符都为大写字母或 $\\mathrm{u}$。", "outputFormat": "一个整数表示答案对 `0x125E591` 取模的结果。", "hint": "$1\\le n,\\ m\\le 5\\times 10^6$\n\n## 样例解释\n\n样例一：可能的 $9$ 种信为：`A`,`AA`,`AB`,`AAB`,`ABA`,`ABB`,`ABAA`,`ABAB`,`ABAAB`。\n\n样例二：~~太多了，略~~。\n\n样例三：可能的 $3$ 种信为：`空`,`U`,`UU`。", "locale": "zh-CN"}}}
{"pid": "P4966", "type": "P", "difficulty": 6, "samples": [["3 5 2\n1 2 3 4 5\n", "1\n5\n4\n2\n3\n1\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "Special Judge", "O2优化", "模拟退火", "生成树"], "title": "基地建设", "background": "在茫茫宇宙中……", "description": "有一群生物 ccj，他们发现了一个超星系群。其中有 $n$ 个恒星，$m$ 条双向星际航线，每条星际航线都需要消耗 $val_i$ 的燃料值。两个恒星不属于同一个星系当且仅当他们之间没有任何航线，且没有任何路径可以到达。只有每个恒星才可以为飞船补充燃料。每次航行的路线都是一条简单路径。由于燃料系统过于简陋，每个燃料罐只能用于一次航行。他们的首长 ccj 想在其中一个恒星上建立基地。但是 ccj 花了太多钱购买高速飞船，没有太多钱购买燃料罐，所以他对于两个恒星之间的航行一定选择最经济的航行方式，购买最小的燃料罐。他想问你，在基地要备多少的燃料总量，使得在任意一个恒星上建立基地都能从那个基地分别到达那个星系的其他所有恒星。\n\n但是，这个超星系群发生了战争，一些黑洞改变了这里的空间结构。这群生物只知道每条航线花费的燃料值，找不到连接的两个恒星。但是他们的科学家发现了一个性质：每个战争有一个标志值 $q$，航线有不同的排列方式，对于其中一种排列，第 $i$ 条航线连接着 $((q^{i} \\bmod 2^{32}+i \\times val_i) \\bmod n+n) \\bmod n+1$ 和 $((q^{i} \\bmod 2^{32}-i \\times val_i) \\bmod n+n) \\bmod n+1$ 两个恒星。**运算方式为无符号整型运算**。如果连接的两个恒星一样，说明科学家计算有误，忽略这条航线。ccj 的目标改变了。他想知道对于所有星系的构成情况，最少需要准备多少的燃料总量，使得在这种结构中，在任意一个恒星上建立基地都能分别到达该结构下那个恒星所处星系的其他所有恒星。\n\n你需要输出航线排列顺序。\n", "inputFormat": "第一行三个正整数 $n$，$m$ 和 $q$，表示有 $n$ 个恒星，$m$ 条航线，战争标志值 $q$。\n\n第二行 $m$ 个正整数 $val_i$，表示第 $i$ 条航线消耗 $val_i$ 的燃料值。", "outputFormat": "第一行一个正整数 $ans$，表示 ccj 需要你求的数值。\n\n从第二行到第 $m+1$ 行，每行输出一个整数，第 $i$ 行输出这个排列下的 $val_{i-1}$。", "hint": "**样例解释：**\n\n这 $5$ 条航线分别是：\n\n$2$ 与 $2$ 往返，花费燃料 $5$\n\n$1$ 与 $1$ 往返，花费燃料 $4$\n\n$3$ 与 $3$ 往返，花费燃料 $2$\n\n$2$ 与 $2$ 往返，花费燃料 $3$\n\n$1$ 与 $2$ 往返，花费燃料 $1$\n\n前四条航线被忽略，故有四个恒星系，$\\{1,2\\},\\{3\\},\\{4\\},\\{5\\}$\n\n基地建在 $1$ 时，从 $1$ 到 $2$ 需要购买燃料量为 $1$ 的燃料罐，可以发现，没有其他比这个更优的答案。\n\n$2 \\le n \\le 100\\quad 1 \\le m \\le 40\\quad 0 \\le q \\le 10^9\\quad 0 \\le val_i \\le 1000$\n\n你的答案只需要比std优秀或者和std一样且方案正确即可\n\n1~4数据都为最优答案，5~10数据都为次优答案\n\n~~此题会给出第10个数据的输入~~\n[输入数据](https://www.luogu.org/paste/3xkq6bar)\n\n详细范围参见”标程“\n\n数据均为随机构造，请注意常数！", "locale": "zh-CN", "translations": {"en": {"title": "Base Construction", "background": "In the vast universe...", "description": "There is a group of creatures called ccj who discovered a supercluster. There are $n$ stars and $m$ bidirectional interstellar routes, and traveling along the $i$-th route consumes a fuel cost of $val_i$. Two stars are not in the same galaxy if and only if there is no route between them, and there is no path that can reach one from the other. Only stars can refuel spaceships. Each trip uses a simple path. Because the fuel system is too crude, each fuel tank can only be used for one trip. Their leader ccj wants to build a base on one of the stars. However, ccj spent too much money on high-speed ships and does not have much money to buy fuel tanks, so for any trip between two stars he will always choose the most economical way, buying the smallest possible fuel tank. He wants to ask you: how much total fuel should be prepared for the base, so that no matter which star the base is built on, it can reach all other stars in the same galaxy from that base.\n\nHowever, the supercluster has gone to war, and some black holes changed the spatial structure here. The creatures only know the fuel cost of each route, but cannot find which two stars it connects. Their scientists discovered a property: each war has a marker value $q$. The routes can be arranged in different orders, and for one such arrangement, the $i$-th route connects star $((q^{i} \\bmod 2^{32}+i \\times val_i) \\bmod n+n) \\bmod n+1$ and star $((q^{i} \\bmod 2^{32}-i \\times val_i) \\bmod n+n) \\bmod n+1$. **All operations are performed as unsigned integer operations**. If the two connected stars are the same, it means the scientists made a mistake, and this route should be ignored. ccj’s goal changed. He wants to know: over all possible galaxy structures, what is the minimum total fuel that must be prepared, so that in such a structure, no matter which star the base is built on, it can reach all other stars in the same galaxy (the connected component of that star) under that structure.\n\nYou need to output the route arrangement order.", "inputFormat": "The first line contains three positive integers $n$, $m$, and $q$, meaning there are $n$ stars, $m$ routes, and the war marker value $q$.\n\nThe second line contains $m$ positive integers $val_i$, where $val_i$ is the fuel cost of the $i$-th route.", "outputFormat": "The first line contains one positive integer $ans$, which is the value ccj asks you to compute.\n\nFrom the second line to the $(m+1)$-th line, output one integer per line. On the $i$-th line, output $val_{i-1}$ under this arrangement.", "hint": "**Sample Explanation:**\n\nThese $5$ routes are:\n\nRound trip between $2$ and $2$, fuel cost $5$.\n\nRound trip between $1$ and $1$, fuel cost $4$.\n\nRound trip between $3$ and $3$, fuel cost $2$.\n\nRound trip between $2$ and $2$, fuel cost $3$.\n\nRound trip between $1$ and $2$, fuel cost $1$.\n\nThe first four routes are ignored, so there are four galaxies: $\\{1,2\\},\\{3\\},\\{4\\},\\{5\\}$.\n\nWhen the base is built on $1$, traveling from $1$ to $2$ requires buying a fuel tank of size $1$. It can be seen that there is no better answer than this.\n\nConstraints: $2 \\le n \\le 100\\quad 1 \\le m \\le 40\\quad 0 \\le q \\le 10^9\\quad 0 \\le val_i \\le 1000$.\n\nYour answer only needs to be better than the std, or equal to the std and the construction is correct.\n\nFor testdata $1 \\sim 4$, the optimal answer is required; for testdata $5 \\sim 10$, a suboptimal answer is accepted.\n\n~~This problem will provide the input of testdata 10~~  \n[Input Data](https://www.luogu.org/paste/3xkq6bar)\n\nFor detailed ranges, see “standard solution”.\n\nAll testdata are randomly generated. Please pay attention to constants.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基地建设", "background": "在茫茫宇宙中……", "description": "有一群生物 ccj，他们发现了一个超星系群。其中有 $n$ 个恒星，$m$ 条双向星际航线，每条星际航线都需要消耗 $val_i$ 的燃料值。两个恒星不属于同一个星系当且仅当他们之间没有任何航线，且没有任何路径可以到达。只有每个恒星才可以为飞船补充燃料。每次航行的路线都是一条简单路径。由于燃料系统过于简陋，每个燃料罐只能用于一次航行。他们的首长 ccj 想在其中一个恒星上建立基地。但是 ccj 花了太多钱购买高速飞船，没有太多钱购买燃料罐，所以他对于两个恒星之间的航行一定选择最经济的航行方式，购买最小的燃料罐。他想问你，在基地要备多少的燃料总量，使得在任意一个恒星上建立基地都能从那个基地分别到达那个星系的其他所有恒星。\n\n但是，这个超星系群发生了战争，一些黑洞改变了这里的空间结构。这群生物只知道每条航线花费的燃料值，找不到连接的两个恒星。但是他们的科学家发现了一个性质：每个战争有一个标志值 $q$，航线有不同的排列方式，对于其中一种排列，第 $i$ 条航线连接着 $((q^{i} \\bmod 2^{32}+i \\times val_i) \\bmod n+n) \\bmod n+1$ 和 $((q^{i} \\bmod 2^{32}-i \\times val_i) \\bmod n+n) \\bmod n+1$ 两个恒星。**运算方式为无符号整型运算**。如果连接的两个恒星一样，说明科学家计算有误，忽略这条航线。ccj 的目标改变了。他想知道对于所有星系的构成情况，最少需要准备多少的燃料总量，使得在这种结构中，在任意一个恒星上建立基地都能分别到达该结构下那个恒星所处星系的其他所有恒星。\n\n你需要输出航线排列顺序。\n", "inputFormat": "第一行三个正整数 $n$，$m$ 和 $q$，表示有 $n$ 个恒星，$m$ 条航线，战争标志值 $q$。\n\n第二行 $m$ 个正整数 $val_i$，表示第 $i$ 条航线消耗 $val_i$ 的燃料值。", "outputFormat": "第一行一个正整数 $ans$，表示 ccj 需要你求的数值。\n\n从第二行到第 $m+1$ 行，每行输出一个整数，第 $i$ 行输出这个排列下的 $val_{i-1}$。", "hint": "**样例解释：**\n\n这 $5$ 条航线分别是：\n\n$2$ 与 $2$ 往返，花费燃料 $5$\n\n$1$ 与 $1$ 往返，花费燃料 $4$\n\n$3$ 与 $3$ 往返，花费燃料 $2$\n\n$2$ 与 $2$ 往返，花费燃料 $3$\n\n$1$ 与 $2$ 往返，花费燃料 $1$\n\n前四条航线被忽略，故有四个恒星系，$\\{1,2\\},\\{3\\},\\{4\\},\\{5\\}$\n\n基地建在 $1$ 时，从 $1$ 到 $2$ 需要购买燃料量为 $1$ 的燃料罐，可以发现，没有其他比这个更优的答案。\n\n$2 \\le n \\le 100\\quad 1 \\le m \\le 40\\quad 0 \\le q \\le 10^9\\quad 0 \\le val_i \\le 1000$\n\n你的答案只需要比std优秀或者和std一样且方案正确即可\n\n1~4数据都为最优答案，5~10数据都为次优答案\n\n~~此题会给出第10个数据的输入~~\n[输入数据](https://www.luogu.org/paste/3xkq6bar)\n\n详细范围参见”标程“\n\n数据均为随机构造，请注意常数！", "locale": "zh-CN"}}}
{"pid": "P4967", "type": "P", "difficulty": 6, "samples": [["3\n", "26\n"], ["4\n", "100\n"], ["12", "2137408"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "O2优化", "矩阵加速", "线性递推", "构造"], "title": "黑暗打击", "background": "注，此题和 CQOI 的鼹鼠不一样，请仔细看题！本题只是借用背景！\n\n在茫茫宇宙中……", "description": "有一群生物 ccj，他们在上次的星系中，发现了一群低等生物，于是想进行一波黑暗森林打击。这群低等生物即是 $\\mathsf{Hilbert}$ 鼹鼠，生活在 $\\mathsf{Hilbert}$ 星球，住在 $\\mathsf{Hilbert}$ 曲线土壤内。  \n这群生物决定用最傻的办法——灌水，来淹死他们。现在“高等”生物想知道，对于 $n$ 阶的 $\\mathsf{Hilbert}$ 曲线，从上往下灌水，能淹没几个单位面积？\n\n这是 $1 \\sim 4$ 阶的 $\\mathsf{Hilbert}$ 曲线：  \n\n![](https://cdn.luogu.com.cn/upload/pic/28912.png)\n\n$h_1$，如最左图所示，是一个缺上口的正方形，这个正方形的边长为 $1$。 从$h_2$ 开始，按照以下方法构造曲线 $h_i$： 将 $h_{i-1}$ 复制四份，按 $2\\times2$ 摆放。  \n把左上一份逆时针转 $90^{\\circ }$，右上一份顺时针转 $90^{\\circ }$，然后用三条单位线段将四分曲线按照左上-左下-右下-右上的顺序连接起来。如图所示，分别展示的是 $h_2$，$h_3$，$h_4$。加粗的线段是额外用于连接的线段。\n\n灌水方式：\n\n（显然这个是 $h_3$ 的灌水面积）绿色即为无法被灌到的地方，红色为可以灌到的地方，灰色为墙，所以答案是 $26$，即为样例1。\n\n![](https://cdn.luogu.com.cn/upload/pic/40229.png)\n\n一个方格有水当且仅当在它的上，左，右方格中有至少一个方格有水，最上面一层的空格都有水。\n\n注，此题要求对 $9223372036854775783$ 取模", "inputFormat": "一个整数 $n$，表示这个洞穴是 $n$ 阶的 $\\mathsf{Hilbert}$ 曲线。", "outputFormat": "一个整数 $ans$，表示有 $ans$ 个单位面积被淹没。", "hint": "**样例解释：**\n\n自己数一数嘛……\n\n$n \\le 10^{10000}$\n\n详细范围参见“标程”\n\n数据均为手动构造，请注意常数！", "locale": "zh-CN", "translations": {"en": {"title": "Dark Strike", "background": "Note: This problem is not the same as CQOI’s “Mole”. Please read the problem carefully. This problem only borrows the background.\n\nIn the vast universe...", "description": "There is a group of creatures called ccj. In the last galaxy, they discovered a group of low-level creatures, so they want to launch a “Dark Forest strike”. These low-level creatures are $\\mathsf{Hilbert}$ moles. They live on the $\\mathsf{Hilbert}$ planet and stay inside the soil of the $\\mathsf{Hilbert}$ curve.\n\nThese creatures decide to use the dumbest method—flooding—to drown them. Now the “advanced” creatures want to know: for an $n$-order $\\mathsf{Hilbert}$ curve, if water is poured from top to bottom, how many unit areas can be flooded?\n\nThese are the $\\mathsf{Hilbert}$ curves of order $1 \\sim 4$:\n\n![](https://cdn.luogu.com.cn/upload/pic/28912.png)\n\n$h_1$, as shown in the leftmost figure, is a square missing an opening at the top, and the side length of this square is $1$. Starting from $h_2$, construct the curve $h_i$ in the following way: copy $h_{i-1}$ four times and place them in a $2 \\times 2$ layout. Rotate the top-left copy $90^\\circ$ counterclockwise, rotate the top-right copy $90^\\circ$ clockwise, then use three unit segments to connect the four sub-curves in the order top-left → bottom-left → bottom-right → top-right. As shown in the figures, they are $h_2$, $h_3$, and $h_4$ respectively. The bold segments are the extra segments used for connection.\n\nFlooding rules:\n\n(Obviously, this is the flooded area of $h_3$.) Green areas are places that cannot be reached by water, red areas are places that can be reached by water, and gray areas are walls. So the answer is $26$, which is Sample 1.\n\n![](https://cdn.luogu.com.cn/upload/pic/40229.png)\n\nA cell has water if and only if at least one of the cells above it, to its left, or to its right has water. All empty cells in the topmost row have water.\n\nNote: this problem requires taking modulo $9223372036854775783$.", "inputFormat": "An integer $n$, meaning this cave is an $n$-order $\\mathsf{Hilbert}$ curve.", "outputFormat": "An integer $ans$, meaning there are $ans$ unit areas flooded.", "hint": "**Sample explanation:**\n\nCount it yourself...\n\nConstraints: $n \\le 10^{10000}$.\n\nFor detailed constraints, see the “standard solution”.\n\nAll testdata are manually constructed. Please pay attention to constants.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "黑暗打击", "background": "注，此题和 CQOI 的鼹鼠不一样，请仔细看题！本题只是借用背景！\n\n在茫茫宇宙中……", "description": "有一群生物 ccj，他们在上次的星系中，发现了一群低等生物，于是想进行一波黑暗森林打击。这群低等生物即是 $\\mathsf{Hilbert}$ 鼹鼠，生活在 $\\mathsf{Hilbert}$ 星球，住在 $\\mathsf{Hilbert}$ 曲线土壤内。  \n这群生物决定用最傻的办法——灌水，来淹死他们。现在“高等”生物想知道，对于 $n$ 阶的 $\\mathsf{Hilbert}$ 曲线，从上往下灌水，能淹没几个单位面积？\n\n这是 $1 \\sim 4$ 阶的 $\\mathsf{Hilbert}$ 曲线：  \n\n![](https://cdn.luogu.com.cn/upload/pic/28912.png)\n\n$h_1$，如最左图所示，是一个缺上口的正方形，这个正方形的边长为 $1$。 从$h_2$ 开始，按照以下方法构造曲线 $h_i$： 将 $h_{i-1}$ 复制四份，按 $2\\times2$ 摆放。  \n把左上一份逆时针转 $90^{\\circ }$，右上一份顺时针转 $90^{\\circ }$，然后用三条单位线段将四分曲线按照左上-左下-右下-右上的顺序连接起来。如图所示，分别展示的是 $h_2$，$h_3$，$h_4$。加粗的线段是额外用于连接的线段。\n\n灌水方式：\n\n（显然这个是 $h_3$ 的灌水面积）绿色即为无法被灌到的地方，红色为可以灌到的地方，灰色为墙，所以答案是 $26$，即为样例1。\n\n![](https://cdn.luogu.com.cn/upload/pic/40229.png)\n\n一个方格有水当且仅当在它的上，左，右方格中有至少一个方格有水，最上面一层的空格都有水。\n\n注，此题要求对 $9223372036854775783$ 取模", "inputFormat": "一个整数 $n$，表示这个洞穴是 $n$ 阶的 $\\mathsf{Hilbert}$ 曲线。", "outputFormat": "一个整数 $ans$，表示有 $ans$ 个单位面积被淹没。", "hint": "**样例解释：**\n\n自己数一数嘛……\n\n$n \\le 10^{10000}$\n\n详细范围参见“标程”\n\n数据均为手动构造，请注意常数！", "locale": "zh-CN"}}}
{"pid": "P4968", "type": "P", "difficulty": 6, "samples": [["3 1\n5 2 0\n2 30 17 28\n5 1 1\n2 47 56 -60", "422\n"], ["3 1\n1 1 0\n1 1 1\n1 1 0\n1 1 1", "die"], ["10 3\n23 16 1\n3 25 15 -27 47\n43 38 0\n3 19 35 40 -11\n43 37 0\n3 70 22 8 -28\n41 36 0\n3 86 -8 21 -59\n39 33 1\n3 83 37 -26 56\n18 12 0\n3 3 96 -75 43\n50 43 0\n3 85 -2 47 -36\n48 41 1\n3 36 -4 83 -61\n14 8 1\n3 33 13 35 -24\n", "21071866\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "网络流", "O2优化", "费用流"], "title": "逃生之路", "background": "还在茫茫宇宙中……", "description": "还是这群生物 ccj，因为上次的打击太草率了，同时被他人侦测到了。在得知自己即将受到黑暗森林打击之后，选择逃离自己的家园。\n\n他们的旅程计划在一条线上，其中，我们约定，一号点是他们的家园，有无限多个生物。每一个星球，都可以向之后连续的 $p$ 个星球进行转移。但由于每个星球的”体质“不同，每个星球所能接受的生物数量限定在一个范围 $[b,a]$ 之间。而且，由于星球本身资源匮乏，到达每一个星球都需要消耗星球一定的能源，补充飞船能源。并且又因为宇宙空间的复杂，所以这个能源是关于星球所接受生物数量的一个多项式。飞船年久失修，所以遇到任何星球必定前往去补充能源。\n\n可惜这群生物有一个睿智的头领，他希望最终能有生物到达可以生存的星球，而且消耗的总能源要尽量少。那群生物对这个头领很失望，于是把任务丢给你。\n\n请求出有生物到达可生存星球的情况下，最少的能源消耗是多少？\n", "inputFormat": "第一行两个整数$n$和$p$，表示有$n$个星球（包括他们的家园和目的地），每次向后跳$p$个，保证 $p\\le n-1$。\n\n接下来有 $2\\times n-2$ 行，偶数行有三个数字，$a_i$、$b_i$ 和 $f_i$，$i$ 从 $2$ 开始，表示第 $i$ 个星球能承载的生物数范围和这个星球是否能够生存，$f_i$ 为 $1$ 即能生存，$0$ 即为不能生存。\n\n奇数行先有一个数字 $k$，表示这个多项式是  $k$ 次，接下来 $k+1$ 个整数，表示从高到低每一项的系数 $wi$。", "outputFormat": "一个整数 $ans$ 表示花费最少的能源是多少，如果没有一个生物能到达，输出**\"die\"**（不包括引号）。", "hint": "**样例解释**\n\n样例一中从 $1\\to 2$ 两个ccj，$2\\to 3$ 两个 ccj，$2\\times 2\\times 30+2\\times 17+28+2\\times 2\\times 47+2\\times 56-60=422$\n\n样例二由于没有任何一个星球可以生存，故 die。\n\n$2\\le n\\le 100\\quad |w|\\le 100\\quad 1\\le b\\le a\\le 100\\quad 1\\le k\\le 5\\quad 0\\le p\\le 10$。\n\n保证多项式函数二阶导函数在 $x∈[1,100]$ 时恒大于 $0$。", "locale": "zh-CN", "translations": {"en": {"title": "Escape Route", "background": "Still in the vast universe...", "description": "It is still this group of creatures, ccj. Because the last strike was too hasty, they were detected by others. After learning that they are about to be hit by the Dark Forest strike, they choose to leave their homeland.\n\nTheir trip is planned along a straight line. We define planet $1$ as their homeland, which has infinitely many creatures. From each planet, they can move to the next consecutive $p$ planets. However, due to different “constitutions” of planets, each planet can accept only a number of creatures within the range $[b,a]$. Also, because each planet itself lacks resources, arriving at each planet requires consuming a certain amount of the planet’s energy to replenish the ship’s energy. Because space is complex, this energy cost is a polynomial in the number of creatures accepted by the planet. The ship is old and poorly maintained, so whenever they encounter any planet, they must go to it to replenish energy.\n\nUnfortunately, these creatures have a “wise” leader. He hopes that in the end, there will be creatures that reach a planet where they can survive, and the total energy consumed should be as small as possible. The creatures are very disappointed with this leader, so they throw the task to you.\n\nPlease compute: under the condition that some creatures can reach a survivable planet, what is the minimum total energy consumption?", "inputFormat": "The first line contains two integers $n$ and $p$, meaning there are $n$ planets (including their homeland and the destination). Each move can jump forward up to $p$ planets, and it is guaranteed that $p\\le n-1$.\n\nNext there are $2\\times n-2$ lines.\n\nOn even-numbered lines, there are three numbers $a_i$, $b_i$, and $f_i$, with $i$ starting from $2$, meaning the acceptable range of creature counts on planet $i$ and whether this planet is survivable. If $f_i=1$, it is survivable; if $f_i=0$, it is not.\n\nOn odd-numbered lines, there is first a number $k$, meaning this polynomial is of degree $k$. Then there are $k+1$ integers, giving the coefficients $wi$ of each term from highest degree to lowest degree.", "outputFormat": "Output one integer $ans$, the minimum energy cost. If no creature can reach any survivable planet, output **\"die\"** (without quotes).", "hint": "**Sample explanation**\n\nIn sample 1, move $1\\to 2$ with $2$ ccj, and $2\\to 3$ with $2$ ccj. The cost is $2\\times 2\\times 30+2\\times 17+28+2\\times 2\\times 47+2\\times 56-60=422$.\n\nIn sample 2, since no planet is survivable, output die.\n\nConstraints: $2\\le n\\le 100\\quad |w|\\le 100\\quad 1\\le b\\le a\\le 100\\quad 1\\le k\\le 5\\quad 0\\le p\\le 10$。\n\nIt is guaranteed that the second derivative of the polynomial function is always greater than $0$ when $x∈[1,100]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "逃生之路", "background": "还在茫茫宇宙中……", "description": "还是这群生物 ccj，因为上次的打击太草率了，同时被他人侦测到了。在得知自己即将受到黑暗森林打击之后，选择逃离自己的家园。\n\n他们的旅程计划在一条线上，其中，我们约定，一号点是他们的家园，有无限多个生物。每一个星球，都可以向之后连续的 $p$ 个星球进行转移。但由于每个星球的”体质“不同，每个星球所能接受的生物数量限定在一个范围 $[b,a]$ 之间。而且，由于星球本身资源匮乏，到达每一个星球都需要消耗星球一定的能源，补充飞船能源。并且又因为宇宙空间的复杂，所以这个能源是关于星球所接受生物数量的一个多项式。飞船年久失修，所以遇到任何星球必定前往去补充能源。\n\n可惜这群生物有一个睿智的头领，他希望最终能有生物到达可以生存的星球，而且消耗的总能源要尽量少。那群生物对这个头领很失望，于是把任务丢给你。\n\n请求出有生物到达可生存星球的情况下，最少的能源消耗是多少？\n", "inputFormat": "第一行两个整数$n$和$p$，表示有$n$个星球（包括他们的家园和目的地），每次向后跳$p$个，保证 $p\\le n-1$。\n\n接下来有 $2\\times n-2$ 行，偶数行有三个数字，$a_i$、$b_i$ 和 $f_i$，$i$ 从 $2$ 开始，表示第 $i$ 个星球能承载的生物数范围和这个星球是否能够生存，$f_i$ 为 $1$ 即能生存，$0$ 即为不能生存。\n\n奇数行先有一个数字 $k$，表示这个多项式是  $k$ 次，接下来 $k+1$ 个整数，表示从高到低每一项的系数 $wi$。", "outputFormat": "一个整数 $ans$ 表示花费最少的能源是多少，如果没有一个生物能到达，输出**\"die\"**（不包括引号）。", "hint": "**样例解释**\n\n样例一中从 $1\\to 2$ 两个ccj，$2\\to 3$ 两个 ccj，$2\\times 2\\times 30+2\\times 17+28+2\\times 2\\times 47+2\\times 56-60=422$\n\n样例二由于没有任何一个星球可以生存，故 die。\n\n$2\\le n\\le 100\\quad |w|\\le 100\\quad 1\\le b\\le a\\le 100\\quad 1\\le k\\le 5\\quad 0\\le p\\le 10$。\n\n保证多项式函数二阶导函数在 $x∈[1,100]$ 时恒大于 $0$。", "locale": "zh-CN"}}}
{"pid": "P4969", "type": "P", "difficulty": 5, "samples": [["5 5\n2 3 4 5 9\n5 \nBookCity 1 1\nGuy 2 5\nZero 1 5\ntingtime 5 1\nZero 1 5\n", "1800\n2400"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "树状数组"], "title": "神秘的703", "background": "**出题人：各位 Oier 一定要细心啊啊啊！！！注意看说明**\n\n**出题人：Chen_Xi.Naoh**\n\nZero 和 Mike是一对热爱旅行的好朋友，一天在经历了 ZXG 大神的历练后，心力交瘁，于是决定**重阳节**回宾馆刷题，找回自信，于是，我们的故事开始了……", "description": "Zero 所在宾馆的房间号是 $703$ ，而 Mike 所在宾馆的房间好却是 $704$ ，所以当 Zero 和 Mike 想凑在一起刷题的时候，Zero 需要从 $703$ 前往 $704$ 或者 Mike 从 $704$ 前往 $703$ ，当 Zero 和 Mike 凑在一起时，Mike 便会从[ luogu ](https://www.luogu.com.cn/)上随机选择 $n$ 道题，每一道题分值为 $300$ ，由于 Mike 身经百战，所以每当 Mike 看到某道题目的时候，大脑里面就会自动给该到题目定义一个难度值 $hard$ (要相信 Mike 的判断都是正确的)，而 Zero 和 Mike 两个人都有一个共同的天赋值 $Talent$ ,每个人都只能 AC $Talent$ 范围内难度的题目（即满足 $hard\\le Talent$ 的题目），当然 Zero 和 Mike 的天赋值不会很低；\n\n在 Zero 的房间 $703$ 里面有一位热爱学习的小学弟 BookCity ，在 Zero 和 Mike 刷题的同时，BookCity 会在一旁研究两位学长的做题习惯，并给两位学长加油助威，由于 BookCity 的加油，某道题目的难度就会自动下降 $d$（**若 $hard - d \\le 0$，则默认该题的 $hard$ 为** $1$）；然而，在宾馆的 \n $123$ 号房间住着一个拥有魔法但心地邪恶的人 Guy，能够看到 Zero 和 Mike 的动静，并且能够施展魔法（因为是在**重阳节**），在 Zero 和 Mike 做到某一题的时候，直接将该题的难度 $hard$ 暴增至 $s$ 倍！！！！！幸运的是，Zero 和 Mike 的老师 tingtime 会帮助他们两个，在困境的时候为 Zero 和 Mike 指点迷津，将某一题的难度直接调为一个很低的值 $x$。\n\nZero 和 Mike 每刷完一道题能获得对应分值的自信值（Zero 和 Mike 都是追求完美的人，每一道题要么对，要么干脆不写），现在，你就是 Zero ，你想知道如果和 Mike 从第 $a$ 到题刷到第 $b$ 到题能回复多少自信值 $Confidence$（**自信值计算方法：$Confidence=600\\times$ AC 题目个数 $\\Longrightarrow$ 一道题 $300$ 分，$2$ 个人一共恢复 $600$ 自信值**）。", "inputFormat": "第一行输入两个数，分别表示题目个数 $n$ 和天赋值 $Talent$。  \n\n第二行将输入 $n$ 个数，第 $i$ 个数表示第 $i$ 题的 $hard$ 值。  \n\n第三行，输入一个数表示事件个数 $m$。 \n\n接下来的 $m$ 行中，每行一个字符串 $S$ 和 $2$ 个整数 ，表示一个合题意事件：\n- 若 $S=\\texttt{BookCity}$，则表示这是一个 `BookCity` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $\\max(hard_i-d,1)$；\n- 若 $S=\\texttt{Guy}$，则表示这是一个 `Guy` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $hard_i\\times d$；\n- 若 $S=\\texttt{tingtime}$，则表示这是一个 `tingtime` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $d$；\n- 若 $S=\\texttt{Zero}$，则表示这是一个 `Zero` 事件，接下来两个数 $a,b$ 表示查询从第 $a$ 到题刷到第 $b$ 到题能回复自信值的数量 $Confidence$。\n\n严格保证所有事件按顺序发生。", "outputFormat": "对于每个 `Zero` 事件，输出一行一个数表示该事件的答案 $Confidence$。", "hint": "保证所有题目初始的难度值 $hard$ 在 $ [0,2^{31}-1] $ 范围内；\n\n保证 Zero 和 Mike 的天赋值 $Talent$ 在 $  [0,2^{31}-1] $ 范围内；\n\n保证 Zero 事件中 $a,b$ 的范围都在 $ [0,2^{31}-1] $ 范围内，但不保证 $a$ 一定会小于 $b$；\n\n保证 Guy 事件中 $d$ 的范围都在 $ [0,2^{31}-1] $ 范围内；\n\n保证 BookCity 事件中 $d$ 的范围都在 $ [0,2^{31}-1] $ 范围内；\n\n保证所有的输入数据都在 $  [0,2^{31}-1] $ 范围内；\n\nMike 身经百战，所以其判断的 $hard$ 都在 $  [0,2^{31}-1] $ 范围内，且不存在难度为负数或者为 $0$ 的送分题；\n\n保证 $n$ 和$m$ 都在 $  [0,2^{31}-1] $ 范围内；\n\n对于 $30\\%$ 的数据：$0\\leqslant n \\leqslant 5\\times 10^3$,$m \\leqslant 5\\times 10^3$；\n\n对于 $50\\%$ 的数据：$0\\leqslant n \\leqslant 5\\times 10^4$,$m \\leqslant 5\\times 10^4$；\n\n对于 $100\\%$ 的数据：$0\\leqslant n\\leqslant 5\\times 10^5$，$m\\leqslant 5\\times 10^5$。\n\n\n**总之保证所有输入数据在$ [0,2^{31}-1] $范围内，但不保证运算在$ [0,2^{63}-1] $范围内！！**", "locale": "zh-CN", "translations": {"en": {"title": "Mysterious 703", "background": "**Problem Setter: All OIers must be careful!!! Read the notes carefully.**\n\n**Problem Setter: Chen_Xi.Naoh**\n\nZero and Mike are two good friends who love traveling. One day, after going through the training of the great ZXG, they were exhausted, so they decided to go back to the hotel on the Double Ninth Festival to do problems and regain their confidence. Thus, our story begins.", "description": "Zero’s hotel room number is $703$, and Mike’s hotel room number is $704$. So when Zero and Mike want to get together to do problems, Zero needs to go from $703$ to $704$, or Mike goes from $704$ to $703$. When they are together, Mike will randomly choose $n$ problems from [ luogu ](https://www.luogu.com.cn/). Each problem is worth $300$ points. Since Mike is very experienced, whenever he sees a problem, his brain will automatically assign it a difficulty value $hard$ (trust that Mike’s judgment is always correct). Both Zero and Mike share a common talent value $Talent$. Each person can only AC problems whose difficulty is within $Talent$ (that is, problems satisfying $hard \\le Talent$). Of course, Zero and Mike’s talent value will not be very low.\n\nIn Zero’s room $703$, there is a junior student BookCity who loves studying. While Zero and Mike are doing problems, BookCity will study their habits and cheer for them. Because of BookCity’s cheering, the difficulty of a certain problem will automatically decrease by $d$ (**if $hard - d \\le 0$, then the $hard$ of this problem is set to** $1$ by default). However, in room $123$ of the hotel lives a magical but evil person Guy, who can observe Zero and Mike and cast magic (because it is the Double Ninth Festival). When Zero and Mike are solving a certain problem, he can directly increase that problem’s difficulty $hard$ to $s$ times its original value!!!!! Fortunately, Zero and Mike’s teacher tingtime will help them: in difficult situations, he will guide them and directly set the difficulty of a certain problem to a very low value $x$.\n\nFor each problem they finish, Zero and Mike gain confidence corresponding to its score (they both pursue perfection: each problem is either solved correctly, or not written at all). Now you are Zero. You want to know how much confidence $Confidence$ can be recovered if you and Mike solve problems from problem $a$ to problem $b$ (**confidence calculation: $Confidence = 600 \\times$ number of AC problems $\\Longrightarrow$ one problem is $300$ points, and with $2$ people, they recover $600$ confidence in total**).", "inputFormat": "The first line contains two integers, representing the number of problems $n$ and the talent value $Talent$.\n\nThe second line contains $n$ integers. The $i$-th integer denotes the $hard$ value of problem $i$.\n\nThe third line contains one integer, representing the number of events $m$.\n\nIn the next $m$ lines, each line contains a string $S$ and $2$ integers, describing a valid event:\n- If $S=\\texttt{BookCity}$, it is a `BookCity` event. The next two numbers $i,d$ mean setting the difficulty $hard_i$ of problem $i$ to $\\max(hard_i-d,1)$.\n- If $S=\\texttt{Guy}$, it is a `Guy` event. The next two numbers $i,d$ mean setting the difficulty $hard_i$ of problem $i$ to $hard_i \\times d$.\n- If $S=\\texttt{tingtime}$, it is a `tingtime` event. The next two numbers $i,d$ mean setting the difficulty $hard_i$ of problem $i$ to $d$.\n- If $S=\\texttt{Zero}$, it is a `Zero` event. The next two numbers $a,b$ represent a query: the amount of confidence $Confidence$ recovered by solving problems from problem $a$ to problem $b$.\n\nIt is strictly guaranteed that all events happen in order.", "outputFormat": "For each `Zero` event, output one line with one number: the answer $Confidence$ for that event.", "hint": "Constraints:\n\n- All initial difficulty values $hard$ are in the range $[0,2^{31}-1]$.\n- Zero and Mike’s talent value $Talent$ is in the range $[0,2^{31}-1]$.\n- In `Zero` events, $a,b$ are in the range $[0,2^{31}-1]$, but it is not guaranteed that $a<b$.\n- In `Guy` events, $d$ is in the range $[0,2^{31}-1]$.\n- In `BookCity` events, $d$ is in the range $[0,2^{31}-1]$.\n- All input data are in the range $[0,2^{31}-1]$.\n- Since Mike is very experienced, the $hard$ values he assigns are in the range $[0,2^{31}-1]$, and there are no problems with negative difficulty or difficulty $0$ (free points).\n- Both $n$ and $m$ are in the range $[0,2^{31}-1]$.\n\nFor $30\\%$ of the testdata: $0 \\leqslant n \\leqslant 5\\times 10^3$, $m \\leqslant 5\\times 10^3$.\n\nFor $50\\%$ of the testdata: $0 \\leqslant n \\leqslant 5\\times 10^4$, $m \\leqslant 5\\times 10^4$.\n\nFor $100\\%$ of the testdata: $0 \\leqslant n \\leqslant 5\\times 10^5$, $m \\leqslant 5\\times 10^5$.\n\n**In short, all input data are guaranteed to be in the range $[0,2^{31}-1]$, but intermediate computations are not guaranteed to stay within the range $[0,2^{63}-1]$!!**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "神秘的703", "background": "**出题人：各位 Oier 一定要细心啊啊啊！！！注意看说明**\n\n**出题人：Chen_Xi.Naoh**\n\nZero 和 Mike是一对热爱旅行的好朋友，一天在经历了 ZXG 大神的历练后，心力交瘁，于是决定**重阳节**回宾馆刷题，找回自信，于是，我们的故事开始了……", "description": "Zero 所在宾馆的房间号是 $703$ ，而 Mike 所在宾馆的房间好却是 $704$ ，所以当 Zero 和 Mike 想凑在一起刷题的时候，Zero 需要从 $703$ 前往 $704$ 或者 Mike 从 $704$ 前往 $703$ ，当 Zero 和 Mike 凑在一起时，Mike 便会从[ luogu ](https://www.luogu.com.cn/)上随机选择 $n$ 道题，每一道题分值为 $300$ ，由于 Mike 身经百战，所以每当 Mike 看到某道题目的时候，大脑里面就会自动给该到题目定义一个难度值 $hard$ (要相信 Mike 的判断都是正确的)，而 Zero 和 Mike 两个人都有一个共同的天赋值 $Talent$ ,每个人都只能 AC $Talent$ 范围内难度的题目（即满足 $hard\\le Talent$ 的题目），当然 Zero 和 Mike 的天赋值不会很低；\n\n在 Zero 的房间 $703$ 里面有一位热爱学习的小学弟 BookCity ，在 Zero 和 Mike 刷题的同时，BookCity 会在一旁研究两位学长的做题习惯，并给两位学长加油助威，由于 BookCity 的加油，某道题目的难度就会自动下降 $d$（**若 $hard - d \\le 0$，则默认该题的 $hard$ 为** $1$）；然而，在宾馆的 \n $123$ 号房间住着一个拥有魔法但心地邪恶的人 Guy，能够看到 Zero 和 Mike 的动静，并且能够施展魔法（因为是在**重阳节**），在 Zero 和 Mike 做到某一题的时候，直接将该题的难度 $hard$ 暴增至 $s$ 倍！！！！！幸运的是，Zero 和 Mike 的老师 tingtime 会帮助他们两个，在困境的时候为 Zero 和 Mike 指点迷津，将某一题的难度直接调为一个很低的值 $x$。\n\nZero 和 Mike 每刷完一道题能获得对应分值的自信值（Zero 和 Mike 都是追求完美的人，每一道题要么对，要么干脆不写），现在，你就是 Zero ，你想知道如果和 Mike 从第 $a$ 到题刷到第 $b$ 到题能回复多少自信值 $Confidence$（**自信值计算方法：$Confidence=600\\times$ AC 题目个数 $\\Longrightarrow$ 一道题 $300$ 分，$2$ 个人一共恢复 $600$ 自信值**）。", "inputFormat": "第一行输入两个数，分别表示题目个数 $n$ 和天赋值 $Talent$。  \n\n第二行将输入 $n$ 个数，第 $i$ 个数表示第 $i$ 题的 $hard$ 值。  \n\n第三行，输入一个数表示事件个数 $m$。 \n\n接下来的 $m$ 行中，每行一个字符串 $S$ 和 $2$ 个整数 ，表示一个合题意事件：\n- 若 $S=\\texttt{BookCity}$，则表示这是一个 `BookCity` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $\\max(hard_i-d,1)$；\n- 若 $S=\\texttt{Guy}$，则表示这是一个 `Guy` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $hard_i\\times d$；\n- 若 $S=\\texttt{tingtime}$，则表示这是一个 `tingtime` 事件，接下来两个数 $i,d$ 表示将第 $i$ 题的难度 $hard_i$ 设为 $d$；\n- 若 $S=\\texttt{Zero}$，则表示这是一个 `Zero` 事件，接下来两个数 $a,b$ 表示查询从第 $a$ 到题刷到第 $b$ 到题能回复自信值的数量 $Confidence$。\n\n严格保证所有事件按顺序发生。", "outputFormat": "对于每个 `Zero` 事件，输出一行一个数表示该事件的答案 $Confidence$。", "hint": "保证所有题目初始的难度值 $hard$ 在 $ [0,2^{31}-1] $ 范围内；\n\n保证 Zero 和 Mike 的天赋值 $Talent$ 在 $  [0,2^{31}-1] $ 范围内；\n\n保证 Zero 事件中 $a,b$ 的范围都在 $ [0,2^{31}-1] $ 范围内，但不保证 $a$ 一定会小于 $b$；\n\n保证 Guy 事件中 $d$ 的范围都在 $ [0,2^{31}-1] $ 范围内；\n\n保证 BookCity 事件中 $d$ 的范围都在 $ [0,2^{31}-1] $ 范围内；\n\n保证所有的输入数据都在 $  [0,2^{31}-1] $ 范围内；\n\nMike 身经百战，所以其判断的 $hard$ 都在 $  [0,2^{31}-1] $ 范围内，且不存在难度为负数或者为 $0$ 的送分题；\n\n保证 $n$ 和$m$ 都在 $  [0,2^{31}-1] $ 范围内；\n\n对于 $30\\%$ 的数据：$0\\leqslant n \\leqslant 5\\times 10^3$,$m \\leqslant 5\\times 10^3$；\n\n对于 $50\\%$ 的数据：$0\\leqslant n \\leqslant 5\\times 10^4$,$m \\leqslant 5\\times 10^4$；\n\n对于 $100\\%$ 的数据：$0\\leqslant n\\leqslant 5\\times 10^5$，$m\\leqslant 5\\times 10^5$。\n\n\n**总之保证所有输入数据在$ [0,2^{31}-1] $范围内，但不保证运算在$ [0,2^{63}-1] $范围内！！**", "locale": "zh-CN"}}}
{"pid": "P4970", "type": "P", "difficulty": 4, "samples": [["10 10\n1 2 3 4 5 6 7 8 9 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n2 1 10\n", "10\n9\n8\n7\n6\n5\n4\n3\n2\n1\nQAQ"], ["10 11\n0 0 0 0 0 0 0 0 0 0\n3 1 10 1\n3 2 10 1\n3 3 10 1\n3 4 10 1\n3 5 10 1\n3 6 10 1\n3 7 10 1\n3 8 10 1\n3 9 10 1\n3 10 10 1\n2 1 10\n", "10\nQAQ"], ["10 13\n0 0 0 0 0 0 0 0 0 0\n1 10 10000\n1 9 9000\n1 8 8000\n1 7 7000\n1 6 6000\n1 5 5000\n1 4 4000\n1 3 3000\n1 2 2000\n1 1 1000\n2 10 10\n2 8 8\n2 8 10\n", "10000\n8000\n9000\nSakura"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "线段树"], "title": "全村最好的嘤嘤刀", "background": "**重阳节**到了，我们最好的八重樱拥有全村最好的嘤嘤刀……", "description": "在绯玉丸力量的影响下，八重村成了一条长度为 $n$ 的八重街，并且绯玉丸可以带着八重樱出现在街上的任意地点。而我们的八重樱则会在街上任意穿梭来获取某一地点上的嘤嘤嘤能量，用以升级她的嘤嘤刀。\n\n**出题人：March_H**\n\n在每个时刻，都会发生以下 $3$ 个事件：\n\n$1$ $x$ $val$ 表示在 $x$ 地点出现了携带着 $val$ 点嘤嘤嘤能量的绯狱丸，并且绯狱丸会吞噬该点的嘤嘤嘤能量，使得该点的嘤嘤嘤能量变为 $ val - a_i$ 点，$a_i$ 为出现绯狱丸的前一刻，该点所存在的嘤嘤嘤能量。\n\n$2$ $l$ $r$ 表示绯玉丸会带着八重樱出现在 $[l,r]$ 间的任意一点。八重樱为了尽快升级她的嘤嘤刀，会获取该区间上最大的嘤嘤嘤能量。特殊的，为了保卫八重村，当 $[l,r]$ 之间存在绯狱丸时，八重樱会优先用她的嘤嘤刀对付绯狱丸，并获得绯狱丸所在点此时拥有的 $a_i$ 点嘤嘤嘤能量。\n\n$3$ $l$ $r$ $val$ 绯玉丸会嘤嘤嘤，使得 $[l,r]$ 上的每一个地点的嘤嘤嘤能量增加 $val$ 点(包括绯狱丸所在点)。", "inputFormat": "第一行为 $2$ 个数 $n$,$m$。\n\n第二行为 $n$ 个数，分别表示八重街上每个地点的初始嘤嘤嘤能量。\n\n接下来 $m$ 行，每行会发生 $3$ 个事件中的一个，输入格式为题目描述中的格式。", "outputFormat": "对于每一个事件 $2$，你应当输出八重樱在该事件中获取的嘤嘤嘤能量并换行。\n\n当所有事件结束时，如果嘤嘤刀积累的能量小于 $10^4$ 你应当输出 ```QAQ```。\n\n如果在 $[10^4,10^7)$ 间，你应当输出 ```Sakura```。\n\n如果都不符合，请输出 ```ice```。", "hint": "对于所有的数据：\n\n最终答案都会在 $[0,2^{31}-1]$ 范围内；\n\n$1\\le n,m \\le 10^5$。\n\n值得注意的是，无论八重樱是获取了某一地点的嘤嘤嘤能量还是击败了某一地点的绯狱丸，该地点的嘤嘤嘤值都应当清零而不是保留原来的数值。\n\n对于事件 $2$ ，题目保证每个事件中最多出现 $1$ 只绯狱丸。如果出现多个最大值，在每次比较时，请选择靠右的(std默认的)。", "locale": "zh-CN", "translations": {"en": {"title": "The Best “Yingying Blade” in the Whole Village", "background": "The Double Ninth Festival is coming, and our best Yae Sakura has the best “yingying blade” in the whole village.", "description": "Under the influence of Higokumaru’s power, Yae Village becomes a Yae Street of length $n$, and Higokumaru can bring Yae Sakura to appear at any position on the street. Yae Sakura can move freely on the street to obtain the “yingyingying” energy at some position, in order to upgrade her “yingying blade”.\n\n**Problem setter: March_H**\n\nAt each moment, the following $3$ types of events may happen:\n\n$1$ $x$ $val$ means that a Higokumaru carrying $val$ points of “yingyingying” energy appears at position $x$, and it will devour the “yingyingying” energy at that position, making the energy at that position become $val - a_i$, where $a_i$ is the amount of “yingyingying” energy at that position at the moment right before Higokumaru appears.\n\n$2$ $l$ $r$ means that Higokumaru will bring Yae Sakura to appear at any position within $[l, r]$. In order to upgrade her “yingying blade” as fast as possible, Yae Sakura will obtain the maximum “yingyingying” energy in this interval. Specially, in order to protect Yae Village, when there exists a Higokumaru between $l$ and $r$, Yae Sakura will prioritize using her “yingying blade” to deal with Higokumaru, and obtain $a_i$ points of “yingyingying” energy that the position where Higokumaru is located currently has.\n\n$3$ $l$ $r$ $val$ means that Higokumaru will “yingyingying”, causing the “yingyingying” energy at every position in $[l, r]$ to increase by $val$ points (including the position where Higokumaru is located).", "inputFormat": "The first line contains $2$ integers $n$ and $m$.\n\nThe second line contains $n$ integers, representing the initial “yingyingying” energy at each position on Yae Street.\n\nThe next $m$ lines each describe one of the $3$ events, with the input format as specified in the description.", "outputFormat": "For each event of type $2$, output the amount of “yingyingying” energy obtained by Yae Sakura in that event, followed by a newline.\n\nAfter all events end, if the energy accumulated in the “yingying blade” is less than $10000$, output $QAQ$.\n\nIf it is in $[10000, 10000000)$, output $Sakura$.\n\nIf neither condition is satisfied, output $ice$.", "hint": "For all testdata:\n\nThe final answer will be within $[0, 2^{31}-1]$.\n\n$n$ and $m$ $\\leqslant$ $100000$.\n\nNote that whether Yae Sakura obtains the “yingyingying” energy at a position or defeats the Higokumaru at a position, the “yingyingying” value at that position should be cleared to $0$ instead of keeping the original value.\n\nFor event $2$, the problem guarantees that at most $1$ Higokumaru appears in each event. If there are multiple maximum values, when comparing each time, choose the rightmost one (the default behavior of std).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "全村最好的嘤嘤刀", "background": "**重阳节**到了，我们最好的八重樱拥有全村最好的嘤嘤刀……", "description": "在绯玉丸力量的影响下，八重村成了一条长度为 $n$ 的八重街，并且绯玉丸可以带着八重樱出现在街上的任意地点。而我们的八重樱则会在街上任意穿梭来获取某一地点上的嘤嘤嘤能量，用以升级她的嘤嘤刀。\n\n**出题人：March_H**\n\n在每个时刻，都会发生以下 $3$ 个事件：\n\n$1$ $x$ $val$ 表示在 $x$ 地点出现了携带着 $val$ 点嘤嘤嘤能量的绯狱丸，并且绯狱丸会吞噬该点的嘤嘤嘤能量，使得该点的嘤嘤嘤能量变为 $ val - a_i$ 点，$a_i$ 为出现绯狱丸的前一刻，该点所存在的嘤嘤嘤能量。\n\n$2$ $l$ $r$ 表示绯玉丸会带着八重樱出现在 $[l,r]$ 间的任意一点。八重樱为了尽快升级她的嘤嘤刀，会获取该区间上最大的嘤嘤嘤能量。特殊的，为了保卫八重村，当 $[l,r]$ 之间存在绯狱丸时，八重樱会优先用她的嘤嘤刀对付绯狱丸，并获得绯狱丸所在点此时拥有的 $a_i$ 点嘤嘤嘤能量。\n\n$3$ $l$ $r$ $val$ 绯玉丸会嘤嘤嘤，使得 $[l,r]$ 上的每一个地点的嘤嘤嘤能量增加 $val$ 点(包括绯狱丸所在点)。", "inputFormat": "第一行为 $2$ 个数 $n$,$m$。\n\n第二行为 $n$ 个数，分别表示八重街上每个地点的初始嘤嘤嘤能量。\n\n接下来 $m$ 行，每行会发生 $3$ 个事件中的一个，输入格式为题目描述中的格式。", "outputFormat": "对于每一个事件 $2$，你应当输出八重樱在该事件中获取的嘤嘤嘤能量并换行。\n\n当所有事件结束时，如果嘤嘤刀积累的能量小于 $10^4$ 你应当输出 ```QAQ```。\n\n如果在 $[10^4,10^7)$ 间，你应当输出 ```Sakura```。\n\n如果都不符合，请输出 ```ice```。", "hint": "对于所有的数据：\n\n最终答案都会在 $[0,2^{31}-1]$ 范围内；\n\n$1\\le n,m \\le 10^5$。\n\n值得注意的是，无论八重樱是获取了某一地点的嘤嘤嘤能量还是击败了某一地点的绯狱丸，该地点的嘤嘤嘤值都应当清零而不是保留原来的数值。\n\n对于事件 $2$ ，题目保证每个事件中最多出现 $1$ 只绯狱丸。如果出现多个最大值，在每次比较时，请选择靠右的(std默认的)。", "locale": "zh-CN"}}}
{"pid": "P4971", "type": "P", "difficulty": 6, "samples": [["1 1 10\n5 2\n1 2 3 4 5\n2 3\n4 2 4", "Heaven 10"], ["2 2 8\n5 4\n4 8 7 5 6\n4 2 4\n2 2\n4 2 3\n3 3 2\n3 2\n5 1 2\n2 2\n3 3 2", "Hell 9\nGensokyo 0"], ["2 1 15\n5 4\n1 2 3 4 5\n4 2 3\n3 2 100\n4 1 4\n4 4 1\n5 4\n1 2 3 4 5\n3 2 15\n4 2 3\n4 1 4\n4 3 4", "Heaven 11\nHeaven 9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["并查集", "优先队列", "可并堆"], "title": "断罪者", "background": "**重阳节**的地狱……\n\n四季映姬·亚玛萨那度（以下简称四季大人）是地狱的最高裁判长，她平时负责给死者定罪，判断让死者去地狱还是天界，或者别的什么地方。\n\n四季大人当然可以轻松地给死者断罪，但是死者太多了，四季大人需要你帮她断罪，以便腾出时间让她对别人进行说教。", "description": "人们的罪恶值$E$由人们**生前所做过的事**和他的**死亡方式**来决定。他们做过的**坏事**都会有一个罪恶值，这些坏事有可能会并入同一个集合，一个集合的罪恶值为该集合中罪恶值最大的坏事的罪恶值，而他们一生做过的事会**互相影响**，我们将他们生前做过的事分为4种，而最后的罪恶值$E$由其中**所有集合的罪恶值的和**决定。\n\n1. 做坏事——有罪恶值，单独为一集合。  \n2. 做好事——将一件坏事的罪恶值清零。\n3. 忏悔——将指定集合中，最大罪恶值的事罪恶值减少。\n4. 认清自己——将两个坏事集合合并。\n\n而死亡方式可分为 *自然死亡* 、*事故死亡* 和 *自杀* 。\n\n1. 自然死亡，没什么影响。\n2. 事故死亡，可以免除最大罪恶的坏事集合。\n3. 自杀，最大的坏事集合罪恶值翻倍。\n", "inputFormat": "第一行三个输入 $T,W,K$，代表有 $T$ 个人等待断罪，$W$ 为死亡方式，与描述序号对应，$K$ 含义见输出格式。\n\n接下来的 $T$ 组数据，每组数据第一行两个输入 $n,m$，代表他做过的坏事数量和其他事的数量。\n\n第二行 $n$ 个输入，代表每件坏事的罪恶值。\n\n第 $3$ 到第 $m+2$ 行，每行有三种输入可能。（请联系题目描述进行理解）\n\n- $\\verb!2 A!$：表示做好事，将坏事 $A$ 罪恶值**清零**。\n- $\\verb!3 A B!$：表示忏悔，指定集合为 $A$ 所在的集合，最大罪恶值的事减少 $B$，若最大罪恶值比 $B$ 小，则最大罪恶值的事罪恶值**清零**。**对于罪恶值相等的坏事，认为编号更小的更坏**。\n- $\\verb!4 A B!$： 表示认清自己，将 $B$ 所在集合与 $A$ 所在的集合合并。", "outputFormat": "对于每一个人，一行输出一个字符串和一个整数。\n\n若他的罪恶值为 $0$ 则输出 `Gensokyo`，若他的罪恶值大于 $K$ 则输出 `Hell`，否则输出 `Heaven`。再输出它的罪恶值。\n", "hint": "### 样例 1 解释\n\n一开始有五件坏事，罪恶值分别为 $1.2.3.4.5$，做好事之后，罪恶值分别为 $1.2.0.4.5$，认清自我后，只剩下四个集合，罪恶值分别是 $1.4.0.5$，由于是自然死亡，所以最后的罪恶值 $E=1+4+5=10 \\le K \\&\\& E!=0$，因此输出 $Heaven$\n\n### 样例 2 解释\n\n对于样例2的第一组输入如下图，黑色椭圆代表一个集合，红色为罪恶值，下面为点的编号，由于是事故死亡，可以免去标号5的最大值，故罪恶值为$E=4+5$  \n![](https://cdn.luogu.com.cn/upload/pic/72405.png)\n\n### 说明\n\n所有数据均在长整型范围内，对于所有数据，均有$m\\le n$,$1\\le K$，保证输入不存在负数。  \n由于读入数据可能会很大，建议使用较快的读入。\n\n> 约定 ① 对于合并两个集合的操作，至少有一个集合只有一件坏事；\n> 约定 ② 这群人不会做好事。\n\n| 测试点编号 |    T    |      n       |  时限  | 约定 |\n|:-:|:-:|:-:|:-:|:-:|\n|\t\t  1   | $\\le10$ |   $\\le100$   | $1s$ | ①② |\n|\t\t  2   | $\\le10$ |   $\\le300$   | $1s$ | ①  |\n|\t\t  3   | $\\le10$ |   $\\le500$   | $1s$ |    |\n|\t\t  4   | $\\le20$ |  $\\le1000$   | $1s$ | ①② |\n|\t\t  5   | $\\le20$ |  $\\le3000$   | $1s$ | ①  |\n|\t\t  6   | $\\le20$ |  $\\le7000$   | $1s$ |    |\n|\t\t  7   | $\\le30$ |  $\\le10000$  | $1s$ | ①② |\n|\t\t  8   | $\\le30$ |  $\\le30000$  | $1s$ | ①  |\n|\t\t  9   | $\\le30$ |  $\\le50000$  | $1s$ |    |\n|\t\t 10   | $\\le30$ |  $\\le70000$  | $1s$ | ①② |\n|\t\t 11   | $\\le10$ | $\\le100000$  | $1s$ | ①  |\n|\t\t 12   | $\\le10$ | $\\le150000$  | $1s$ |    |\n|\t\t 13   | $\\le10$ | $\\le200000$  | $1s$ | ①② |\n|\t\t 14   | $\\le10$ | $\\le500000$  | $1s$ | ①  |\n|\t\t 15   | $\\le10$ | $\\le1000000$ | $2s$ |    |\n|\t\t 16   | $\\le10$ | $\\le1000000$ | $2s$ | ①② |\n|\t\t 17   | $\\le10$ | $\\le1000000$ | $2s$ | ①  |\n|\t\t 18   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 19   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 20   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 21   | $1$ | $\\le2000000$ | $2s$ |  路径压缩  |\n\n", "locale": "zh-CN", "translations": {"en": {"title": "Judge of Sin", "background": "Hell on the Double Ninth Festival……\n\nShikieiki Yamaxanadu (hereinafter referred to as Lady Shiki) is the Chief Judge of Hell. She is usually responsible for judging the dead, deciding whether they go to Hell, Heaven, or somewhere else.\n\nOf course, Lady Shiki can easily judge the dead, but there are too many dead people. She needs your help to judge them, so that she can spare time to preach to others.", "description": "A person’s sin value $E$ is determined by **what they did while alive** and their **cause of death**. Every **bad deed** has a sin value. Bad deeds may be merged into the same set. The sin value of a set is the maximum sin value among the bad deeds in that set. The things a person did in their life **affect each other**. We classify what they did while alive into 4 types, and the final sin value $E$ is determined by the **sum of the sin values of all sets**.\n\n1. Do a bad deed: has a sin value, and forms its own set.\n2. Do a good deed: sets the sin value of one bad deed to zero.\n3. Repent: for a specified set, decrease the bad deed with the maximum sin value by some amount.\n4. Know yourself: merge two sets of bad deeds.\n\nThe cause of death can be *natural death*, *accidental death*, or *suicide*.\n\n1. Natural death: no effect.\n2. Accidental death: the set with the maximum sin value can be forgiven (removed).\n3. Suicide: the maximum set’s sin value is doubled.", "inputFormat": "The first line contains three integers $T, W, K$, where there are $T$ people to be judged, $W$ is the cause of death (corresponding to the numbering in the description), and $K$ is defined in the output format.\n\nThe next $T$ groups of data describe each person. In each group, the first line contains two integers $n, m$, representing the number of bad deeds and the number of other actions.\n\nThe second line contains $n$ integers, representing the sin value of each bad deed.\n\nLines $3$ to $m + 2$ each contain one of the following three types of inputs. (Please refer to the description to understand them.)\n\n- $\\verb!2 A!$: do a good deed, setting the sin value of bad deed $A$ to **zero**.\n- $\\verb!3 A B!$: repent. The specified set is the set containing $A$. Decrease the bad deed with the maximum sin value in that set by $B$. If the maximum sin value is smaller than $B$, then set that bad deed’s sin value to **zero**. **If multiple bad deeds have the same sin value, the one with the smaller index is considered worse**.\n- $\\verb!4 A B!$: know yourself, merging the set containing $B$ into the set containing $A$.", "outputFormat": "For each person, output one string and one integer on one line.\n\nIf their sin value is $0$, output `Gensokyo`. If their sin value is greater than $K$, output `Hell`. Otherwise, output `Heaven`. Then output their sin value.", "hint": "### Sample 1 Explanation\n\nAt the beginning there are five bad deeds, with sin values $1.2.3.4.5$. After doing a good deed, the sin values become $1.2.0.4.5$. After knowing oneself, only four sets remain, with sin values $1.4.0.5$. Since it is natural death, the final sin value is $E=1+4+5=10 \\le K \\&\\& E!=0$, so output $Heaven$.\n\n### Sample 2 Explanation\n\nFor the first test case of Sample 2, it is shown in the figure below. Black ovals represent sets, red numbers are sin values, and the numbers below are node indices. Since it is accidental death, the maximum set with index $5$ can be forgiven, so the sin value is $E=4+5$.  \n![](https://cdn.luogu.com.cn/upload/pic/72405.png)\n\n### Notes\n\nAll data fit in 64-bit signed integers. For all testdata, $m\\le n$, $1\\le K$, and the input contains no negative numbers.  \nSince the input may be very large, faster input methods are recommended.\n\n> Convention ①: For the operation of merging two sets, at least one set contains only one bad deed.  \n> Convention ②: These people will not do good deeds.\n\n| Test Point ID |    T    |      n       | Time Limit | Conventions |\n|:-:|:-:|:-:|:-:|:-:|\n| 1 | $\\le10$ | $\\le100$ | $1s$ | ①② |\n| 2 | $\\le10$ | $\\le300$ | $1s$ | ① |\n| 3 | $\\le10$ | $\\le500$ | $1s$ |  |\n| 4 | $\\le20$ | $\\le1000$ | $1s$ | ①② |\n| 5 | $\\le20$ | $\\le3000$ | $1s$ | ① |\n| 6 | $\\le20$ | $\\le7000$ | $1s$ |  |\n| 7 | $\\le30$ | $\\le10000$ | $1s$ | ①② |\n| 8 | $\\le30$ | $\\le30000$ | $1s$ | ① |\n| 9 | $\\le30$ | $\\le50000$ | $1s$ |  |\n| 10 | $\\le30$ | $\\le70000$ | $1s$ | ①② |\n| 11 | $\\le10$ | $\\le100000$ | $1s$ | ① |\n| 12 | $\\le10$ | $\\le150000$ | $1s$ |  |\n| 13 | $\\le10$ | $\\le200000$ | $1s$ | ①② |\n| 14 | $\\le10$ | $\\le500000$ | $1s$ | ① |\n| 15 | $\\le10$ | $\\le1000000$ | $2s$ |  |\n| 16 | $\\le10$ | $\\le1000000$ | $2s$ | ①② |\n| 17 | $\\le10$ | $\\le1000000$ | $2s$ | ① |\n| 18 | $\\le10$ | $\\le2000000$ | $2s$ |  |\n| 19 | $\\le10$ | $\\le2000000$ | $2s$ |  |\n| 20 | $\\le10$ | $\\le2000000$ | $2s$ |  |\n| 21 | $1$ | $\\le2000000$ | $2s$ | Path Compression |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "断罪者", "background": "**重阳节**的地狱……\n\n四季映姬·亚玛萨那度（以下简称四季大人）是地狱的最高裁判长，她平时负责给死者定罪，判断让死者去地狱还是天界，或者别的什么地方。\n\n四季大人当然可以轻松地给死者断罪，但是死者太多了，四季大人需要你帮她断罪，以便腾出时间让她对别人进行说教。", "description": "人们的罪恶值$E$由人们**生前所做过的事**和他的**死亡方式**来决定。他们做过的**坏事**都会有一个罪恶值，这些坏事有可能会并入同一个集合，一个集合的罪恶值为该集合中罪恶值最大的坏事的罪恶值，而他们一生做过的事会**互相影响**，我们将他们生前做过的事分为4种，而最后的罪恶值$E$由其中**所有集合的罪恶值的和**决定。\n\n1. 做坏事——有罪恶值，单独为一集合。  \n2. 做好事——将一件坏事的罪恶值清零。\n3. 忏悔——将指定集合中，最大罪恶值的事罪恶值减少。\n4. 认清自己——将两个坏事集合合并。\n\n而死亡方式可分为 *自然死亡* 、*事故死亡* 和 *自杀* 。\n\n1. 自然死亡，没什么影响。\n2. 事故死亡，可以免除最大罪恶的坏事集合。\n3. 自杀，最大的坏事集合罪恶值翻倍。\n", "inputFormat": "第一行三个输入 $T,W,K$，代表有 $T$ 个人等待断罪，$W$ 为死亡方式，与描述序号对应，$K$ 含义见输出格式。\n\n接下来的 $T$ 组数据，每组数据第一行两个输入 $n,m$，代表他做过的坏事数量和其他事的数量。\n\n第二行 $n$ 个输入，代表每件坏事的罪恶值。\n\n第 $3$ 到第 $m+2$ 行，每行有三种输入可能。（请联系题目描述进行理解）\n\n- $\\verb!2 A!$：表示做好事，将坏事 $A$ 罪恶值**清零**。\n- $\\verb!3 A B!$：表示忏悔，指定集合为 $A$ 所在的集合，最大罪恶值的事减少 $B$，若最大罪恶值比 $B$ 小，则最大罪恶值的事罪恶值**清零**。**对于罪恶值相等的坏事，认为编号更小的更坏**。\n- $\\verb!4 A B!$： 表示认清自己，将 $B$ 所在集合与 $A$ 所在的集合合并。", "outputFormat": "对于每一个人，一行输出一个字符串和一个整数。\n\n若他的罪恶值为 $0$ 则输出 `Gensokyo`，若他的罪恶值大于 $K$ 则输出 `Hell`，否则输出 `Heaven`。再输出它的罪恶值。\n", "hint": "### 样例 1 解释\n\n一开始有五件坏事，罪恶值分别为 $1.2.3.4.5$，做好事之后，罪恶值分别为 $1.2.0.4.5$，认清自我后，只剩下四个集合，罪恶值分别是 $1.4.0.5$，由于是自然死亡，所以最后的罪恶值 $E=1+4+5=10 \\le K \\&\\& E!=0$，因此输出 $Heaven$\n\n### 样例 2 解释\n\n对于样例2的第一组输入如下图，黑色椭圆代表一个集合，红色为罪恶值，下面为点的编号，由于是事故死亡，可以免去标号5的最大值，故罪恶值为$E=4+5$  \n![](https://cdn.luogu.com.cn/upload/pic/72405.png)\n\n### 说明\n\n所有数据均在长整型范围内，对于所有数据，均有$m\\le n$,$1\\le K$，保证输入不存在负数。  \n由于读入数据可能会很大，建议使用较快的读入。\n\n> 约定 ① 对于合并两个集合的操作，至少有一个集合只有一件坏事；\n> 约定 ② 这群人不会做好事。\n\n| 测试点编号 |    T    |      n       |  时限  | 约定 |\n|:-:|:-:|:-:|:-:|:-:|\n|\t\t  1   | $\\le10$ |   $\\le100$   | $1s$ | ①② |\n|\t\t  2   | $\\le10$ |   $\\le300$   | $1s$ | ①  |\n|\t\t  3   | $\\le10$ |   $\\le500$   | $1s$ |    |\n|\t\t  4   | $\\le20$ |  $\\le1000$   | $1s$ | ①② |\n|\t\t  5   | $\\le20$ |  $\\le3000$   | $1s$ | ①  |\n|\t\t  6   | $\\le20$ |  $\\le7000$   | $1s$ |    |\n|\t\t  7   | $\\le30$ |  $\\le10000$  | $1s$ | ①② |\n|\t\t  8   | $\\le30$ |  $\\le30000$  | $1s$ | ①  |\n|\t\t  9   | $\\le30$ |  $\\le50000$  | $1s$ |    |\n|\t\t 10   | $\\le30$ |  $\\le70000$  | $1s$ | ①② |\n|\t\t 11   | $\\le10$ | $\\le100000$  | $1s$ | ①  |\n|\t\t 12   | $\\le10$ | $\\le150000$  | $1s$ |    |\n|\t\t 13   | $\\le10$ | $\\le200000$  | $1s$ | ①② |\n|\t\t 14   | $\\le10$ | $\\le500000$  | $1s$ | ①  |\n|\t\t 15   | $\\le10$ | $\\le1000000$ | $2s$ |    |\n|\t\t 16   | $\\le10$ | $\\le1000000$ | $2s$ | ①② |\n|\t\t 17   | $\\le10$ | $\\le1000000$ | $2s$ | ①  |\n|\t\t 18   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 19   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 20   | $\\le10$ | $\\le2000000$ | $2s$ |    |\n|\t\t 21   | $1$ | $\\le2000000$ | $2s$ |  路径压缩  |\n\n", "locale": "zh-CN"}}}
{"pid": "P4973", "type": "P", "difficulty": 5, "samples": [["1\n1 11", "1"], ["1\n2 a45", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学"], "title": "毒瘤之神奇进制", "background": "hsl2363 正在造计算机。", "description": "hsl2363 发现计算机非常好玩，他打算自己造一台，造好之后 zrz_orz 来了，hsl2363 告诉他：\n\n“我的计算机是‘**$X$-\\* 进制**’的，我很想知道你到底有多菜，所以问问你这几个数换算成十进制之后是多少。”\n\n“**$X$-\\* 进制**”表示的数字可以由 ASCII 可见字符（不包括 ASCII 代码小于等于 $48$ 的字符）组成。令“**$X$-\\* 进制**”$s$ 长度为 $n$，位数从右到左为 $0$ 到 $n - 1$，则它表示这个数第 $i$ 位的 ASCII 代码减去 `0` 的 ASCII 代码（即 $48$），再乘以 $X$ 的 $i$ 次方的总乘积。也就是说，\n\n$$s=\\prod \\limits_{i=0} \\limits^{n-1} (X^i\\cdot (f(s_i)-f('0')))$$\n\n其中 $f('x')$ 表示字符 `x` 的 ASCII 代码值。\n\n下面是一个例子：\n\n若 $X=3$，$s=$`2363`，\n\n则有\n\n$\\begin{aligned}\n\ts&= f('2') \\times 3^3 \\times f('3') \\times 3 ^ 2 \\times f('6') \\times 3 ^ 1 \\times f('3') \\times 3 ^ 0 \\\\\n\t&= 2 \\times 3^3 \\times 3 \\times 3 ^ 2 \\times 6 \\times 3 ^ 1 \\times 3 \\times 3 ^ 0\\\\\n  &= 78732\n\\end{aligned}\n$\n\nzrz_orz 觉得太难了，把问题抛给了你。现在有 $Q$ 个用“$X$-\\* 进制”表示的数字（不同数字的 $X$ 可能不同），你需要求出它们的十进制表示。\n\n因为答案可能很大，请输出答案的长度。", "inputFormat": "第一行一个整数 $Q$。\n\n接下来 $Q$ 行，第 $i$ 行一个整数 $X_i$ 和一个字符串 $s_i$，表示第 $i$ 个数字为“$X_i$-\\* 进制”，在该进制下的表示为 $s_i$。", "outputFormat": "共 $Q$ 行。\n\n第 $i$ 行一个整数，代表第 $i$ 个数字在十进制表示下的长度。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1 \\le Q \\le 100, 1\\le X_i=|s_i|-1 \\le 10^5$。\n\nASCII 可见字符（不包括 ASCII 代码小于等于 $48$ 的字符）包含以下字符（按 ASCII 代码升序排序）：\n\n```text\n123456789:;<=>?\n@ABCDEFGHIJKLMNO\nPQRSTUVWXYZ[\\]^_\n`abcdefghijklmno\npqrstuvwxyz{|}~\n```\n\n**【提示】**\n\n如果想要暴力，没有高精度是不可能的。", "locale": "zh-CN", "translations": {"en": {"title": "Magic Base of the “Poison Tumor”", "background": "hsl2363 is building a computer.", "description": "hsl2363 found computers very fun, so he plans to build one himself. After he finishes it, zrz_orz comes. hsl2363 tells him:\n\n“My computer uses the ‘**$X$-\\* base**’. I really want to know how weak you are, so I’m asking you what these numbers become after converting to decimal.”\n\nA number written in “**$X$-\\* base**” can be made of ASCII visible characters (excluding characters whose ASCII code is $\\le 48$). Let an “**$X$-\\* base**” string $s$ have length $n$, with digit positions numbered from right to left as $0$ to $n - 1$. The value it represents is the product over all positions: take the ASCII code of the character at position $i$, subtract the ASCII code of `0` (i.e., $48$), and multiply by $X^i$, then multiply all these terms together. That is,\n\n$$s=\\prod \\limits_{i=0} \\limits^{n-1} (X^i\\cdot (f(s_i)-f('0')))$$\n\nwhere $f('x')$ denotes the ASCII code value of character `x`.\n\nHere is an example:\n\nIf $X=3$ and $s=$`2363`,\n\nthen\n\n$\\begin{aligned}\n\ts&= f('2') \\times 3^3 \\times f('3') \\times 3 ^ 2 \\times f('6') \\times 3 ^ 1 \\times f('3') \\times 3 ^ 0 \\\\\n\t&= 2 \\times 3^3 \\times 3 \\times 3 ^ 2 \\times 6 \\times 3 ^ 1 \\times 3 \\times 3 ^ 0\\\\\n  &= 78732\n\\end{aligned}\n$\n\nzrz_orz thinks it is too hard, so he throws the problem to you. Now there are $Q$ numbers written in “$X$-\\* base” (different numbers may have different $X$). You need to find their decimal representations.\n\nBecause the answer may be very large, output the length of the answer.", "inputFormat": "The first line contains an integer $Q$.\n\nThe next $Q$ lines: the $i$-th line contains an integer $X_i$ and a string $s_i$, meaning the $i$-th number is in “$X_i$-\\* base”, and its representation in that base is $s_i$.", "outputFormat": "Output $Q$ lines.\n\nThe $i$-th line contains one integer, the length of the $i$-th number’s decimal representation.", "hint": "**【Constraints】**\n\nFor $100\\%$ of the testdata, $1 \\le Q \\le 100, 1\\le X_i=|s_i|-1 \\le 10^5$.\n\nASCII visible characters (excluding characters whose ASCII code is $\\le 48$) include the following characters (sorted in increasing ASCII code):\n\n```text\n123456789:;<=>?\n@ABCDEFGHIJKLMNO\nPQRSTUVWXYZ[\\]^_\n`abcdefghijklmno\npqrstuvwxyz{|}~\n```\n\n**【Hint】**\n\nIf you want to brute force it, it is impossible without big integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神奇进制", "background": "hsl2363 正在造计算机。", "description": "hsl2363 发现计算机非常好玩，他打算自己造一台，造好之后 zrz_orz 来了，hsl2363 告诉他：\n\n“我的计算机是‘**$X$-\\* 进制**’的，我很想知道你到底有多菜，所以问问你这几个数换算成十进制之后是多少。”\n\n“**$X$-\\* 进制**”表示的数字可以由 ASCII 可见字符（不包括 ASCII 代码小于等于 $48$ 的字符）组成。令“**$X$-\\* 进制**”$s$ 长度为 $n$，位数从右到左为 $0$ 到 $n - 1$，则它表示这个数第 $i$ 位的 ASCII 代码减去 `0` 的 ASCII 代码（即 $48$），再乘以 $X$ 的 $i$ 次方的总乘积。也就是说，\n\n$$s=\\prod \\limits_{i=0} \\limits^{n-1} (X^i\\cdot (f(s_i)-f('0')))$$\n\n其中 $f('x')$ 表示字符 `x` 的 ASCII 代码值。\n\n下面是一个例子：\n\n若 $X=3$，$s=$`2363`，\n\n则有\n\n$\\begin{aligned}\n\ts&= f('2') \\times 3^3 \\times f('3') \\times 3 ^ 2 \\times f('6') \\times 3 ^ 1 \\times f('3') \\times 3 ^ 0 \\\\\n\t&= 2 \\times 3^3 \\times 3 \\times 3 ^ 2 \\times 6 \\times 3 ^ 1 \\times 3 \\times 3 ^ 0\\\\\n  &= 78732\n\\end{aligned}\n$\n\nzrz_orz 觉得太难了，把问题抛给了你。现在有 $Q$ 个用“$X$-\\* 进制”表示的数字（不同数字的 $X$ 可能不同），你需要求出它们的十进制表示。\n\n因为答案可能很大，请输出答案的长度。", "inputFormat": "第一行一个整数 $Q$。\n\n接下来 $Q$ 行，第 $i$ 行一个整数 $X_i$ 和一个字符串 $s_i$，表示第 $i$ 个数字为“$X_i$-\\* 进制”，在该进制下的表示为 $s_i$。", "outputFormat": "共 $Q$ 行。\n\n第 $i$ 行一个整数，代表第 $i$ 个数字在十进制表示下的长度。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1 \\le Q \\le 100, 1\\le X_i=|s_i|-1 \\le 10^5$。\n\nASCII 可见字符（不包括 ASCII 代码小于等于 $48$ 的字符）包含以下字符（按 ASCII 代码升序排序）：\n\n```text\n123456789:;<=>?\n@ABCDEFGHIJKLMNO\nPQRSTUVWXYZ[\\]^_\n`abcdefghijklmno\npqrstuvwxyz{|}~\n```\n\n**【提示】**\n\n如果想要暴力，没有高精度是不可能的。", "locale": "zh-CN"}}}
{"pid": "P4974", "type": "P", "difficulty": 4, "samples": [["5 2\n0\n1\n2\n2\n4\n5 10\n3 10\n", "3 50"]], "limits": {"time": [888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888, 888], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "枚举"], "title": "毒瘤之神秘通道", "background": "~~Viston就是一个小蒟蒻 By CYJian（自己YY出来的）~~         \nViston最喜欢冒险了。", "description": "~~（假的算法标签）~~\nViston发现了一个巨大的城堡，他走了进去，城堡里有一个巨大的房间，Viston进去打算参观参观，然后.......他就被困在里面了。   Viston发现了在房间里有很多同样冒险者和一个个通道，冒险者们一个个冲向了不同的**通道**，而Viston一脸懵逼。    \n\nViston动用他莫大的蒟蒻之力摸清了这些**通道**是什么东东~~厉害吧~~，他们是一些单向**通道**，而这些**通道**会把你传送到另一些房间里，一个房间里有一个传送到另一个房间里的传送门。     \n\n已知所有的房间最后都通向一个地方，那就是出口。但传送门把你传送到另一个房间也是需要时间的，这个时间取决于之前有多少人使用过这个传送门，计算公式是\n$$T=M$$,其中$M$表示传送门的使用人数。 ~~（你前面发啥呆啊，其他人早走光了。）~~\n\nViston记得每个通道有多少人进入，也探测出了每个房间里的传送门通向哪里，他想知道他从哪个通道进入初始房间才能最快的到达出口，~~毕竟Viston还想着颓金拱门呢。~~\n\n### 注意:只有使用传送门消耗时间,而通道（即到达初始房间）不消耗时间!!!", "inputFormat": "第一行输入两个整数$M$,$N$,其中$M$表示有多少个房间(编号为$1-M$),$N$表示有多少个初始的通道。    \n接下来的$2-------M+1$行,每行输入一个整数$P$,表示第$i$个房间通过一个传送门通向哪个房间,其中$0$号节点表示出口。数据保证是一棵树。       \n第$M+2-------M+N+1$行,每行输入两个整数$A,B$,表示这个**通道**通向房间$A$,之前有$B$个人进入其中。\n### 不同**通道**可能通向相同房间。", "outputFormat": "输出只有一行，$c,d$其中$c$表示Viston选择通过通道到达**哪个**初始房间所需时间最短,$d$表示需要多少时间。\n\n当然,如果有多个初始房间时间最短,就输出编号最大的**通道**通向的初始房间..", "hint": "## 样例解释\n（用的WindowsXP画图画的不好请见谅）               \n![](https://i.loli.net/2018/10/05/5bb7632fb40f4.jpg)\n \n对于1-5号测试点(10 pts): $1 \\leq N, M \\leq 50$\n\n对于6-10号测试点(20 pts): $1 \\leq N, M \\leq 5000$\n\n对于11-15号测试点(30 pts): $1 \\leq N, M \\leq 100000$\n\n对于16-20号测试点(40 pts): $1 \\leq N, M \\leq 1000000$\n\n对于5，10，15，20号测试点，给定的树为随机生成。\n\n保证答案都在long long范围内..\n\n\n$\\color{white}\\text{这样你才能看出来随机树强度有多低}$   \n\n@[Viston](https://www.luogu.org/space/show?uid=107101)\n\n$\\color{white}\\text{（还想卡树剖的）}$\n", "locale": "zh-CN", "translations": {"en": {"title": "Mystery Passage of the “Poison Tumor”", "background": "~~Viston is just a newbie (xiaojuruo) By CYJian (made up by myself)~~.  \nViston likes adventures the most.", "description": "~~(Fake algorithm tags)~~.  \nViston found a huge castle. He walked in, and there was a huge room inside. Viston went in to look around, and then... he got trapped inside. Viston found that there were many other adventurers in the room and many **passages**. The adventurers rushed into different **passages** one by one, while Viston was totally confused.\n\nUsing his great “newbie power”, Viston figured out what these **passages** are ~~awesome, right~~. They are one-way **passages**, and these **passages** will teleport you to other rooms. In each room, there is exactly one portal that teleports you to another room.\n\nIt is known that all rooms eventually lead to one place: the exit. However, being teleported by a portal also takes time. This time depends on how many people have used this portal before, and the formula is\n$$T=M$$, where $M$ is the number of people who have used the portal. ~~(Why are you spacing out? Everyone else has already left.)~~\n\nViston remembers how many people entered each passage, and he also detected where the portal in each room leads to. He wants to know: entering the initial room through which passage will let him reach the exit the fastest, ~~because Viston still wants to slack off at McDonald’s~~.\n\n### Note: Only using portals costs time. Passages (i.e., reaching the initial room) cost no time!!!", "inputFormat": "The first line contains two integers $M$, $N$, where $M$ is the number of rooms (numbered $1-M$), and $N$ is the number of initial passages.  \nIn lines $2-------M+1$, each line contains an integer $P$, meaning that room $i$ goes through a portal to room $P$, where node $0$ represents the exit. The testdata guarantees it is a tree.  \nIn lines $M+2-------M+N+1$, each line contains two integers $A, B$, meaning this **passage** leads to room $A$, and $B$ people have entered it before.  \n### Different **passages** may lead to the same room.", "outputFormat": "Output only one line, $c, d$, where $c$ is the **which** initial room Viston should choose to reach via a passage so that the required time is minimal, and $d$ is the required time.\n\nOf course, if multiple initial rooms have the same minimal time, output the initial room that is reached by the passage with the largest index.", "hint": "## Sample Explanation\n\n(Drawn in WindowsXP, sorry if it looks bad.)  \n![](https://i.loli.net/2018/10/05/5bb7632fb40f4.jpg)\n\nFor test points 1-5 (10 pts): $1 \\leq N, M \\leq 50$.  \n\nFor test points 6-10 (20 pts): $1 \\leq N, M \\leq 5000$.  \n\nFor test points 11-15 (30 pts): $1 \\leq N, M \\leq 100000$.  \n\nFor test points 16-20 (40 pts): $1 \\leq N, M \\leq 1000000$.  \n\nFor test points 5, 10, 15, 20, the given tree is generated randomly.\n\nIt is guaranteed that the answer fits in the range of long long.\n\n$\\color{white}\\text{This way you can see how weak random trees are}$.\n\n@[Viston](https://www.luogu.org/space/show?uid=107101)\n\n$\\color{white}\\text{(Still trying to hack tree decomposition.)}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神秘通道", "background": "~~Viston就是一个小蒟蒻 By CYJian（自己YY出来的）~~         \nViston最喜欢冒险了。", "description": "~~（假的算法标签）~~\nViston发现了一个巨大的城堡，他走了进去，城堡里有一个巨大的房间，Viston进去打算参观参观，然后.......他就被困在里面了。   Viston发现了在房间里有很多同样冒险者和一个个通道，冒险者们一个个冲向了不同的**通道**，而Viston一脸懵逼。    \n\nViston动用他莫大的蒟蒻之力摸清了这些**通道**是什么东东~~厉害吧~~，他们是一些单向**通道**，而这些**通道**会把你传送到另一些房间里，一个房间里有一个传送到另一个房间里的传送门。     \n\n已知所有的房间最后都通向一个地方，那就是出口。但传送门把你传送到另一个房间也是需要时间的，这个时间取决于之前有多少人使用过这个传送门，计算公式是\n$$T=M$$,其中$M$表示传送门的使用人数。 ~~（你前面发啥呆啊，其他人早走光了。）~~\n\nViston记得每个通道有多少人进入，也探测出了每个房间里的传送门通向哪里，他想知道他从哪个通道进入初始房间才能最快的到达出口，~~毕竟Viston还想着颓金拱门呢。~~\n\n### 注意:只有使用传送门消耗时间,而通道（即到达初始房间）不消耗时间!!!", "inputFormat": "第一行输入两个整数$M$,$N$,其中$M$表示有多少个房间(编号为$1-M$),$N$表示有多少个初始的通道。    \n接下来的$2-------M+1$行,每行输入一个整数$P$,表示第$i$个房间通过一个传送门通向哪个房间,其中$0$号节点表示出口。数据保证是一棵树。       \n第$M+2-------M+N+1$行,每行输入两个整数$A,B$,表示这个**通道**通向房间$A$,之前有$B$个人进入其中。\n### 不同**通道**可能通向相同房间。", "outputFormat": "输出只有一行，$c,d$其中$c$表示Viston选择通过通道到达**哪个**初始房间所需时间最短,$d$表示需要多少时间。\n\n当然,如果有多个初始房间时间最短,就输出编号最大的**通道**通向的初始房间..", "hint": "## 样例解释\n（用的WindowsXP画图画的不好请见谅）               \n![](https://i.loli.net/2018/10/05/5bb7632fb40f4.jpg)\n \n对于1-5号测试点(10 pts): $1 \\leq N, M \\leq 50$\n\n对于6-10号测试点(20 pts): $1 \\leq N, M \\leq 5000$\n\n对于11-15号测试点(30 pts): $1 \\leq N, M \\leq 100000$\n\n对于16-20号测试点(40 pts): $1 \\leq N, M \\leq 1000000$\n\n对于5，10，15，20号测试点，给定的树为随机生成。\n\n保证答案都在long long范围内..\n\n\n$\\color{white}\\text{这样你才能看出来随机树强度有多低}$   \n\n@[Viston](https://www.luogu.org/space/show?uid=107101)\n\n$\\color{white}\\text{（还想卡树剖的）}$\n", "locale": "zh-CN"}}}
{"pid": "P4975", "type": "P", "difficulty": 6, "samples": [["3\n1 1\n5 10\n6 7\n", "0\n7\n9\n"]], "limits": {"time": [666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": [], "title": "毒瘤之神TM菱树-①", "background": "本题图片可能较大请耐心加载\n\n什么?菱树是什么??\n\n好吧这个是蒟蒻自己搞事搞的一个非常简单的不是树但很像树的图..\n\n就像这样..\n\n![菱树](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(好吧图有点大(空旷)..)", "description": "现在给你一棵无限大的菱树(就是下面不止上面的图那么点大..)\n\n然后有$T$组询问,每一组询问都是给出$u$和$v$,求出这两个点的最短路径的长度..", "inputFormat": "第一行一个正整数$T$\n\n接下来$T$行每一行两个正整数表示询问的两个点..", "outputFormat": "$T$行,每行一个整数表示询问的答案.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 100$\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^3$\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^5$\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^{18}$", "locale": "zh-CN", "translations": {"en": {"title": "God of Nasty Problems TM Diamond Tree - ①", "background": "The image for this problem may be large, so please wait patiently for it to load.\n\nWhat? What is a diamond tree?\n\nAlright, this is a very simple graph (not actually a tree, but it looks a lot like one) that a newbie made for fun.\n\nIt looks like this.\n\n![Diamond Tree](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(Alright, the picture is a bit large (and empty).)", "description": "Now you are given an infinitely large diamond tree (it is not only as big as the picture above; it continues downward).\n\nThen there are $T$ queries. Each query gives $u$ and $v$. Find the length of the shortest path between these two nodes.", "inputFormat": "The first line contains a positive integer $T$.\n\nThe next $T$ lines each contain two positive integers, representing the two nodes in the query.", "outputFormat": "Output $T$ lines. Each line contains an integer representing the answer to the corresponding query.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 100$.\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^3$.\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^5$.\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神TM菱树-①", "background": "本题图片可能较大请耐心加载\n\n什么?菱树是什么??\n\n好吧这个是蒟蒻自己搞事搞的一个非常简单的不是树但很像树的图..\n\n就像这样..\n\n![菱树](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(好吧图有点大(空旷)..)", "description": "现在给你一棵无限大的菱树(就是下面不止上面的图那么点大..)\n\n然后有$T$组询问,每一组询问都是给出$u$和$v$,求出这两个点的最短路径的长度..", "inputFormat": "第一行一个正整数$T$\n\n接下来$T$行每一行两个正整数表示询问的两个点..", "outputFormat": "$T$行,每行一个整数表示询问的答案.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 100$\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^3$\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^5$\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq u_i, v_i \\leq 10^{18}$", "locale": "zh-CN"}}}
{"pid": "P4976", "type": "P", "difficulty": 6, "samples": [["5\n1\n2\n3\n4\n5", "0\n4\n43\n225\n812\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["O2优化"], "title": "毒瘤之神TM菱树-②", "background": "什么?菱树是什么??\n\n好吧这个是蒟蒻自己搞事搞的一个非常简单的不是树但很像树的图..\n\n就像这样..\n\n![菱树](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(好吧图有点大(空旷)..)", "description": "现在给你$T$棵菱树,每一颗菱树的层数为$n_i$,请求出菱树中所有点对的最短路径的和..", "inputFormat": "第一行一个正整数$T$\n\n接下来$T$行每一行一个正整数$n_i$表示菱树的大小..", "outputFormat": "$T$行,每行一个整数表示对于当前这颗菱树的所有点对的最短路径的和模$998244853$的结果.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 10$\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 100$\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 1000$\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 5*10^6$\n\n为了防止打表，所以空间限制缩小至64MB。", "locale": "zh-CN", "translations": {"en": {"title": "God of “Duliu” TM Rhombus Tree - ②", "background": "What? What is a rhombus tree??\n\nAlright, this is a very simple graph made by a newbie (pinyin: juruo) messing around. It is not a tree, but it looks a lot like a tree.\n\nLike this.\n\n![Rhombus Tree](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(Alright, the picture is a bit large (and empty).)", "description": "You are given $T$ rhombus trees. For the $i$-th rhombus tree, the number of levels is $n_i$. Please compute the sum of the shortest path lengths over all pairs of points in the rhombus tree.", "inputFormat": "The first line contains a positive integer $T$.\n\nThe next $T$ lines each contain a positive integer $n_i$, representing the size of the rhombus tree.", "outputFormat": "Output $T$ lines. Each line contains one integer, representing the sum of the shortest path lengths over all pairs of points in the current rhombus tree, modulo $998244853$.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 10$.\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 100$.\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 1000$.\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 5*10^6$.\n\nTo prevent precomputation with a lookup table, the memory limit is reduced to 64 MB.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神TM菱树-②", "background": "什么?菱树是什么??\n\n好吧这个是蒟蒻自己搞事搞的一个非常简单的不是树但很像树的图..\n\n就像这样..\n\n![菱树](https://i.loli.net/2018/10/07/5bba0e85cbc10.png)\n\n(好吧图有点大(空旷)..)", "description": "现在给你$T$棵菱树,每一颗菱树的层数为$n_i$,请求出菱树中所有点对的最短路径的和..", "inputFormat": "第一行一个正整数$T$\n\n接下来$T$行每一行一个正整数$n_i$表示菱树的大小..", "outputFormat": "$T$行,每行一个整数表示对于当前这颗菱树的所有点对的最短路径的和模$998244853$的结果.", "hint": "${\\rm Subtask\\ 1(10\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 10$\n\n${\\rm Subtask\\ 2(20\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 100$\n\n${\\rm Subtask\\ 3(30\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 1000$\n\n${\\rm Subtask\\ 4(40\\ pts)}: 1 \\leq T \\leq 10000 \\qquad 1 \\leq n_i \\leq 5*10^6$\n\n为了防止打表，所以空间限制缩小至64MB。", "locale": "zh-CN"}}}
{"pid": "P4977", "type": "P", "difficulty": 5, "samples": [["5 2 3", "100\n"], ["7 3 1", "28"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "O2优化"], "title": "毒瘤之神异之旅", "background": "题目名称是吸引你点进来的……\n\n我们的出题人 CYJian 由于出了过多毒瘤题被 D 死之后，OIer 们将他埋葬在地狱十八层之下……", "description": "已知地狱有 $K$ 个守护者，每个守护者有一个能力值 $a_i$。但是我们并不知道他们确切的能力值。只知道这些人的能力值的和为 $N$。但是在地狱中守护者的威力会得到加强，具体来说每一个守护者的威力为 $a_i^M$。\n\n现在给出 $N, M, K$，请求出所有可能的方案的威力值之和。", "inputFormat": "一行三个整数 $N, K$ 和 $M$。", "outputFormat": "一行一个整数，表示所有守护者能够发出的可能的威力值之和模 $10 ^ 9+7$。", "hint": "- Subtask 1 (20 pts): $1 \\leq N,M \\leq 10$，$1 \\leq K \\leq N$；\n- Subtask 2 (40 pts): $1 \\leq N,M \\leq 4096$，$1 \\leq K \\leq N$；\n- Subtask 3 (40 pts): $1 \\leq N,M \\leq 10000$，$1 \\leq K \\leq N$。\n\n其中所有的 $a_i$ 均需要是正整数。\n\n不要喷出题人毒瘤卡常，每一档部分分的时间和空间都至少开了标程的两倍。\n\n由于数据只有一组，可能强度较弱，所以需要每 5 个点捆绑测试。", "locale": "zh-CN", "translations": {"en": {"title": "A Strange Journey of the God of “Poison Problems”", "background": "The problem title is meant to lure you into clicking...\n\nAfter the problem setter CYJian created too many “poison problems” and was D-ed to death, the OIers buried him under the 18th layer of hell...", "description": "It is known that there are $K$ guardians in hell. Each guardian has an ability value $a_i$. However, we do not know their exact ability values. We only know that the sum of their ability values is $N$. In hell, a guardian’s power is enhanced. Specifically, the power of each guardian is $a_i^M$.\n\nNow given $N, M, K$, find the sum of the total power over all possible valid assignments.", "inputFormat": "One line with three integers $N, K$ and $M$.", "outputFormat": "One line with one integer, representing the sum of all possible power values that the guardians can produce, modulo $10 ^ 9+7$.", "hint": "- Subtask 1 (20 pts): $1 \\leq N,M \\leq 10$, $1 \\leq K \\leq N$.\n- Subtask 2 (40 pts): $1 \\leq N,M \\leq 4096$, $1 \\leq K \\leq N$.\n- Subtask 3 (40 pts): $1 \\leq N,M \\leq 10000$, $1 \\leq K \\leq N$.\n\nAll $a_i$ must be positive integers.\n\nPlease do not complain that the setter’s “poison problem” is designed to be tight on time limits. For each subtask, the time and memory limits are at least twice those of the official solution.\n\nSince there is only one test case, it may be relatively weak, so the judging will use bundled tests every 5 points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "毒瘤之神异之旅", "background": "题目名称是吸引你点进来的……\n\n我们的出题人 CYJian 由于出了过多毒瘤题被 D 死之后，OIer 们将他埋葬在地狱十八层之下……", "description": "已知地狱有 $K$ 个守护者，每个守护者有一个能力值 $a_i$。但是我们并不知道他们确切的能力值。只知道这些人的能力值的和为 $N$。但是在地狱中守护者的威力会得到加强，具体来说每一个守护者的威力为 $a_i^M$。\n\n现在给出 $N, M, K$，请求出所有可能的方案的威力值之和。", "inputFormat": "一行三个整数 $N, K$ 和 $M$。", "outputFormat": "一行一个整数，表示所有守护者能够发出的可能的威力值之和模 $10 ^ 9+7$。", "hint": "- Subtask 1 (20 pts): $1 \\leq N,M \\leq 10$，$1 \\leq K \\leq N$；\n- Subtask 2 (40 pts): $1 \\leq N,M \\leq 4096$，$1 \\leq K \\leq N$；\n- Subtask 3 (40 pts): $1 \\leq N,M \\leq 10000$，$1 \\leq K \\leq N$。\n\n其中所有的 $a_i$ 均需要是正整数。\n\n不要喷出题人毒瘤卡常，每一档部分分的时间和空间都至少开了标程的两倍。\n\n由于数据只有一组，可能强度较弱，所以需要每 5 个点捆绑测试。", "locale": "zh-CN"}}}
{"pid": "P4978", "type": "P", "difficulty": 4, "samples": [["5 5\n1 2 3 4 5\n1 3 5 7 9", "754229067"], ["10 15\n7 8 5 1 2 3 6 5 4 1 \n52 10 5 6 3 2 1 4 5 8 7 4 5 6 3", "181952721"], ["1 1\n5\n5", "0"], ["5 5\n1254125 36521421 25362142 12514221 25362142\n857412252 36322411 2236232 1254112 36224125", "261761853"], ["2 2\n2 4\n2 5", "332748118"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["二分", "枚举", "前缀和", "概率论"], "title": "赌神：决斗", "background": "**赌神 $\\mathcal{CYJian}$，他回来了！**\n", "description": "**$\\mathcal{tomoo}$** 决定与 **$\\mathcal{CYJian}$** 进行决斗！\n\n已知 **$\\mathcal{tomoo}$** 有 $\\mathcal{N}$ 张扑克牌，每张扑克牌有一个$\\mathcal{RP}$值$\\mathcal{A_i}$， **$\\mathcal{CYJian}$** 有$\\mathcal{M}$张扑克牌，每张扑克牌有一个$\\mathcal{RP}$值$\\mathcal{B_i}$。\n\n**$\\mathcal{CYJian}$** 与 **$\\mathcal{tomoo}$** 将会各自从他们的牌里任意取一段**连续区间**的牌决斗，谁的区间内的牌的$\\mathcal{RP}$值的和更大，谁就赢了，请你帮忙求出 **$\\mathcal{tomoo}$** 赢的概率。", "inputFormat": "- 第一行 $2$ 个正整数 $\\mathcal{N,M}$\n- 第二行 $N$ 个正整数 $\\mathcal{A_i}$\n- 第三行 $M$ 个正整数 $\\mathcal{B_i}$", "outputFormat": "一个数表示 **$\\mathcal{tomoo}$** 获胜的概率，如果答案可以表示成 $\\frac{P}{Q}$ 的形式,则输出 $\\frac{P}{Q}\\%998244353$（不懂的左转[P3811](https://www.luogu.org/problemnew/show/P3811)）", "hint": "### 样例解释\n- 样例 $3$：不管怎么抽都是平均，胜率为 $0$\n- 样例 $5$：共有 $9$ 种方案，其中 $3$ 次 **tomoo** 会赢，胜率为 $1/3$\n\n### 数据范围\n- 对于 $20\\%$ 的数据，$0<N,M\\le50$\n- 对于另外 $20\\%$ 的数据，$\\sum_{i=1}^NA_i\\le10^6,\\sum_{j=1}^MB_j\\le10^6$\n- 对于$100\\%$的数据，$0<N,M\\le2000,0<A_i,B_i\\le10^9$", "locale": "zh-CN", "translations": {"en": {"title": "God of Gambling: Duel", "background": "**God of Gambling $\\mathcal{CYJian}$ is back!**", "description": "**$\\mathcal{tomoo}$** decides to duel with **$\\mathcal{CYJian}$**!\n\nIt is known that **$\\mathcal{tomoo}$** has $\\mathcal{N}$ playing cards, and each card has an $\\mathcal{RP}$ value $\\mathcal{A_i}$. **$\\mathcal{CYJian}$** has $\\mathcal{M}$ playing cards, and each card has an $\\mathcal{RP}$ value $\\mathcal{B_i}$.\n\n**$\\mathcal{CYJian}$** and **$\\mathcal{tomoo}$** will each choose an arbitrary **contiguous interval** of cards from their own decks to duel. Whoever has the larger sum of $\\mathcal{RP}$ values within their chosen interval wins. Please help compute the probability that **$\\mathcal{tomoo}$** wins.", "inputFormat": "- The first line contains two positive integers $\\mathcal{N,M}$.\n- The second line contains $N$ positive integers $\\mathcal{A_i}$.\n- The third line contains $M$ positive integers $\\mathcal{B_i}$.", "outputFormat": "Output one number representing the probability that **$\\mathcal{tomoo}$** wins. If the answer can be written in the form $\\frac{P}{Q}$, then output $\\frac{P}{Q}\\%998244353$ (if you do not understand, see [P3811](https://www.luogu.org/problemnew/show/P3811)).", "hint": "### Sample Explanation\n\n- Sample $3$: No matter how you choose, the result is always a tie on average, so the win rate is $0$.\n- Sample $5$: There are $9$ possible ways in total, and **tomoo** wins $3$ times, so the win rate is $1/3$.\n\n### Constraints\n\n- For $20\\%$ of the testdata, $0<N,M\\le50$.\n- For another $20\\%$ of the testdata, $\\sum_{i=1}^NA_i\\le10^6,\\sum_{j=1}^MB_j\\le10^6$.\n- For $100\\%$ of the testdata, $0<N,M\\le2000,0<A_i,B_i\\le10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "赌神：决斗", "background": "**赌神 $\\mathcal{CYJian}$，他回来了！**\n", "description": "**$\\mathcal{tomoo}$** 决定与 **$\\mathcal{CYJian}$** 进行决斗！\n\n已知 **$\\mathcal{tomoo}$** 有 $\\mathcal{N}$ 张扑克牌，每张扑克牌有一个$\\mathcal{RP}$值$\\mathcal{A_i}$， **$\\mathcal{CYJian}$** 有$\\mathcal{M}$张扑克牌，每张扑克牌有一个$\\mathcal{RP}$值$\\mathcal{B_i}$。\n\n**$\\mathcal{CYJian}$** 与 **$\\mathcal{tomoo}$** 将会各自从他们的牌里任意取一段**连续区间**的牌决斗，谁的区间内的牌的$\\mathcal{RP}$值的和更大，谁就赢了，请你帮忙求出 **$\\mathcal{tomoo}$** 赢的概率。", "inputFormat": "- 第一行 $2$ 个正整数 $\\mathcal{N,M}$\n- 第二行 $N$ 个正整数 $\\mathcal{A_i}$\n- 第三行 $M$ 个正整数 $\\mathcal{B_i}$", "outputFormat": "一个数表示 **$\\mathcal{tomoo}$** 获胜的概率，如果答案可以表示成 $\\frac{P}{Q}$ 的形式,则输出 $\\frac{P}{Q}\\%998244353$（不懂的左转[P3811](https://www.luogu.org/problemnew/show/P3811)）", "hint": "### 样例解释\n- 样例 $3$：不管怎么抽都是平均，胜率为 $0$\n- 样例 $5$：共有 $9$ 种方案，其中 $3$ 次 **tomoo** 会赢，胜率为 $1/3$\n\n### 数据范围\n- 对于 $20\\%$ 的数据，$0<N,M\\le50$\n- 对于另外 $20\\%$ 的数据，$\\sum_{i=1}^NA_i\\le10^6,\\sum_{j=1}^MB_j\\le10^6$\n- 对于$100\\%$的数据，$0<N,M\\le2000,0<A_i,B_i\\le10^9$", "locale": "zh-CN"}}}
{"pid": "P4979", "type": "P", "difficulty": 5, "samples": [["15\nAACBBABBBCCCBBB\n3\nB 4 5\nB 5 5\nB 10 12", "Yes\nYes\nNo"], ["5\nABBBB\n2\nB 1 4\nB 2 5", "No\nYes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "颜色段均摊（珂朵莉树 ODT）", "位运算"], "title": "矿洞：坍塌", "background": "- Made By tomoo\n\nCYJian 家里为什么那么有钱？因为他家$&@$%#开了矿！！\n\nCYJian 家虽然有矿，但是有矿也不能任性。这不，CYJian 家的矿塌了......\n\n**change:出题人仁慈地放大了空间限制**", "description": "CYJian 家的矿塌了之后，就没有经济来源了（不要问我怎么没有存款）。\n\n于是，CYJian 迫切地想要修复他家的矿。\n\nCYJian 家的矿共出产 $A,B,C$ 三种矿石，所以我们也只能用 $A,B,C$ 三种材料来修复他们家的矿。我们已知共有 $N$ 吨材料，每吨材料均为 $A,B,C$ 三种材料中的一种，它们连成了一个串，如：\n$$ABCBCABCBACBCBAA$$\nCYJian 家对材料的要求非常严格，他每次会选择一段连续区间的材料作为修复的材料。因为不合要求的材料会使得矿再次塌陷，砸死 CYJian，所以这个连续区间的材料必须满足以下 $2$ 个要求：\n- 这段连续区间必须是同一种材料\n- 这段连续区间的前一个材料与后一个材料必须不相同。\n\n例如，有一段材料为 $AACBBABBBCCCBBB$ ，则 $(4 \\sim 5)$ 区间的 $BB$ 和 $(5 \\sim 5)$ 区间的 $B$ 均符合要求，而 $(10 \\sim 12)$ 区间的 $CCC$ 不符合要求。\n\n材料有灵性，所以材料会有变化。\n\n现在有 $N$ 吨材料，$K$ 个询问。每个询问是以下的 $2$ 种形式之一：\n\n- `A x y op` 表示替换材料，将 $x$ 到 $y (1\\leq x \\leq y \\leq N)$ 区间内的材料替换为 $op$，$op$ 为 $A,B,C$ 三种材料字符中的一个。\n- `B x y` 表示是否询问，即询问 $x$ 到 $y(1\\leq x \\leq y \\leq N)$ 区间内的材料是否合法，合法输出 `Yes`，不合法输出 `No`。\n\n注意:当 $x=1$ 或 $y=N$ 时,你的程序不需要判断前后的情况,而只需要判断区间内的情况。", "inputFormat": "- 第一行一个正整数 $N$。\n- 接下来 $N$ 个字符，表示材料。\n- 接下来 $K$ 个询问，格式为上述的一种。", "outputFormat": "对于每个 `B x y` 的询问，输出一行 `Yes` 或 `No`。", "hint": "- 对于 $30\\%$ 的数据，$N\\le1000,K\\le2000$\n- 对于 $70\\%$ 的数据，$N\\le5000,K\\le5000$\n- 对于 $100\\%$ 的数据，$N\\le5\\cdot10^5,K\\le5\\cdot10^5, 1\\leq x \\leq y \\leq N$", "locale": "zh-CN", "translations": {"en": {"title": "Mine Cave: Collapse", "background": "- Made By tomoo\n\nWhy is CYJian’s family so rich? Because his family$&@$%# runs a mine!!\n\nEven if you have a mine, you cannot be reckless. Well, CYJian’s mine collapsed......\n\n**change: The setter kindly increased the memory limit.**", "description": "After CYJian’s mine collapsed, he no longer has any source of income (do not ask me why he has no savings).\n\nSo CYJian urgently wants to repair his mine.\n\nCYJian’s mine produces three kinds of ores: $A,B,C$. Therefore, we can only use the three kinds of materials $A,B,C$ to repair the mine. We know there are a total of $N$ tons of materials. Each ton is one of $A,B,C$, and they are connected into a string, for example:\n$$ABCBCABCBACBCBAA$$\n\nCYJian has very strict requirements for the materials. Each time, he will choose a continuous interval of materials as the repair materials. Because unqualified materials may cause the mine to collapse again and kill CYJian, this continuous interval must satisfy the following $2$ requirements:\n\n- This continuous interval must consist of only one kind of material.\n- The material immediately before this interval and the material immediately after this interval must be different.\n\nFor example, given a segment $AACBBABBBCCCBBB$, the interval $(4 \\sim 5)$ which is $BB$ and the interval $(5 \\sim 5)$ which is $B$ both satisfy the requirements, but the interval $(10 \\sim 12)$ which is $CCC$ does not.\n\nThe materials are “alive”, so they can change.\n\nNow there are $N$ tons of materials and $K$ queries. Each query is one of the following two types:\n\n- `A x y op` means a replacement operation: replace the materials in the interval from $x$ to $y (1\\leq x \\leq y \\leq N)$ with $op$, where $op$ is one of the characters $A,B,C$.\n- `B x y` means a check query: ask whether the materials in the interval from $x$ to $y(1\\leq x \\leq y \\leq N)$ are valid. Output `Yes` if valid, otherwise output `No`.\n\nNote: When $x=1$ or $y=N$, your program does not need to check the outside neighbors, and only needs to check the interval itself.", "inputFormat": "- The first line contains a positive integer $N$.\n- The next line contains $N$ characters, representing the materials.\n- Then follow $K$ queries, each in one of the formats above.", "outputFormat": "For each query `B x y`, output one line `Yes` or `No`.", "hint": "- For $30\\%$ of the testdata, $N\\le1000,K\\le2000$.\n- For $70\\%$ of the testdata, $N\\le5000,K\\le5000$.\n- For $100\\%$ of the testdata, $N\\le5\\cdot10^5,K\\le5\\cdot10^5, 1\\leq x \\leq y \\leq N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "矿洞：坍塌", "background": "- Made By tomoo\n\nCYJian 家里为什么那么有钱？因为他家$&@$%#开了矿！！\n\nCYJian 家虽然有矿，但是有矿也不能任性。这不，CYJian 家的矿塌了......\n\n**change:出题人仁慈地放大了空间限制**", "description": "CYJian 家的矿塌了之后，就没有经济来源了（不要问我怎么没有存款）。\n\n于是，CYJian 迫切地想要修复他家的矿。\n\nCYJian 家的矿共出产 $A,B,C$ 三种矿石，所以我们也只能用 $A,B,C$ 三种材料来修复他们家的矿。我们已知共有 $N$ 吨材料，每吨材料均为 $A,B,C$ 三种材料中的一种，它们连成了一个串，如：\n$$ABCBCABCBACBCBAA$$\nCYJian 家对材料的要求非常严格，他每次会选择一段连续区间的材料作为修复的材料。因为不合要求的材料会使得矿再次塌陷，砸死 CYJian，所以这个连续区间的材料必须满足以下 $2$ 个要求：\n- 这段连续区间必须是同一种材料\n- 这段连续区间的前一个材料与后一个材料必须不相同。\n\n例如，有一段材料为 $AACBBABBBCCCBBB$ ，则 $(4 \\sim 5)$ 区间的 $BB$ 和 $(5 \\sim 5)$ 区间的 $B$ 均符合要求，而 $(10 \\sim 12)$ 区间的 $CCC$ 不符合要求。\n\n材料有灵性，所以材料会有变化。\n\n现在有 $N$ 吨材料，$K$ 个询问。每个询问是以下的 $2$ 种形式之一：\n\n- `A x y op` 表示替换材料，将 $x$ 到 $y (1\\leq x \\leq y \\leq N)$ 区间内的材料替换为 $op$，$op$ 为 $A,B,C$ 三种材料字符中的一个。\n- `B x y` 表示是否询问，即询问 $x$ 到 $y(1\\leq x \\leq y \\leq N)$ 区间内的材料是否合法，合法输出 `Yes`，不合法输出 `No`。\n\n注意:当 $x=1$ 或 $y=N$ 时,你的程序不需要判断前后的情况,而只需要判断区间内的情况。", "inputFormat": "- 第一行一个正整数 $N$。\n- 接下来 $N$ 个字符，表示材料。\n- 接下来 $K$ 个询问，格式为上述的一种。", "outputFormat": "对于每个 `B x y` 的询问，输出一行 `Yes` 或 `No`。", "hint": "- 对于 $30\\%$ 的数据，$N\\le1000,K\\le2000$\n- 对于 $70\\%$ 的数据，$N\\le5000,K\\le5000$\n- 对于 $100\\%$ 的数据，$N\\le5\\cdot10^5,K\\le5\\cdot10^5, 1\\leq x \\leq y \\leq N$", "locale": "zh-CN"}}}
{"pid": "P4980", "type": "P", "difficulty": 6, "samples": [["5\n1 \n2 \n3 \n4 \n5 ", "1\n3\n11\n70\n629"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "群论", "Pólya 定理", "模板题"], "title": "【模板】Pólya 定理", "background": "", "description": "给定一个 $n$ 个点，$n$ 条边的环，有 $n$ 种颜色，给每个顶点染色，问有多少种**本质不同**的染色方案，答案对 $10^9+7$ 取模。\n\n注意本题的本质不同，定义为：**只需要不能通过旋转与别的染色方案相同**。", "inputFormat": "第一行输入一个 $t$，表示有 $t$ 组数据\n\n第二行开始，一共 $t$ 行，每行一个整数 $n$，意思如题所示。", "outputFormat": "共$t$行，每行一个数字，表示染色方案数对 $10^9+7$ 取模后的结果", "hint": "$$n \\leq 10^9$$\n$$t \\leq 10^3$$", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Pólya Theorem", "background": "", "description": "Given a cycle with $n$ vertices and $n$ edges, there are $n$ colors. Color each vertex, and ask how many **essentially different** coloring schemes there are. Output the answer modulo $10^9+7$.\n\nNote that in this problem, “essentially different” is defined as: it **only needs to be different up to rotation**, i.e., two colorings are considered the same if one can be obtained from the other by rotation.", "inputFormat": "The first line contains an integer $t$, meaning there are $t$ test cases.\n\nStarting from the second line, there are $t$ lines in total. Each line contains an integer $n$, with the meaning as described above.", "outputFormat": "There are $t$ lines in total. Each line contains one number, representing the number of coloring schemes modulo $10^9+7$.", "hint": "$$n \\leq 10^9$$\n$$t \\leq 10^3$$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】Pólya 定理", "background": "", "description": "给定一个 $n$ 个点，$n$ 条边的环，有 $n$ 种颜色，给每个顶点染色，问有多少种**本质不同**的染色方案，答案对 $10^9+7$ 取模。\n\n注意本题的本质不同，定义为：**只需要不能通过旋转与别的染色方案相同**。", "inputFormat": "第一行输入一个 $t$，表示有 $t$ 组数据\n\n第二行开始，一共 $t$ 行，每行一个整数 $n$，意思如题所示。", "outputFormat": "共$t$行，每行一个数字，表示染色方案数对 $10^9+7$ 取模后的结果", "hint": "$$n \\leq 10^9$$\n$$t \\leq 10^3$$", "locale": "zh-CN"}}}
{"pid": "P4981", "type": "P", "difficulty": 3, "samples": [["1\n3\n", "9"], ["1\n323\n", "283888610"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["组合数学", "Prüfer 序列"], "title": "父子", "background": "上演在各大学男生寝室的日常 $:$\n\n$A :$ “我没带纸，快来厕所救我！”\n\n$B :$ “叫爸爸。”\n\n$A :$ “爸爸！”\n\n$............................................$\n\n$A :$ “我没钱了，能借我点吗。”\n\n$B :$ “叫爸爸。”\n\n$A :$ “爸爸！”\n\n一个月后、\n\n$B :$ “能把钱还给我吗。”\n\n$A :$ “叫爸爸。”\n\n$B :$ “爸爸！”", "description": "对于全国各大大学的男生寝室，总是有各种混乱的父子关系。\n\n那么假设现在我们一个男生寝室有不同的 $n$ 个人，每个人都至多有一个“爸爸”，可以有多个“儿子”，且有且只有一个人没有“爸爸”(毕竟是室长，还是要给点面子，当然了，室长人人当嘛)。\n\n那么现在问题来了，对于一个有 $n$ 个人的寝室，最多可能存在多少种父子关系，当然每个人之间都必须要有直接或间接的父子关系。", "inputFormat": "第一行一个非负整数 $t$，表示有 $t$ 组数据。\n\n接下来 $t$ 行，每行一个整数 $n$，表示有 $n$ 个人。", "outputFormat": "共 $t$ 行，每行一个整数，求关系个数。\n\n由于答案可能较大，则我们需要输出答案对 $10^9+9$ 取模的值。", "hint": "- 对于 $10\\%$ 的数据，保证 $t=0$；\n\n- 另有 $30\\%$ 的数据，保证 $n≤5$；\n\n- 对于 $100\\%$ 的数据，$t≤10^4$，$1\\le n\\le10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Father and Son", "background": "A daily scene often seen in male dorms at universities:\n\n$A:$ “I didn’t bring tissues. Hurry and save me in the restroom!”\n\n$B:$ “Call me dad.”\n\n$A:$ “Dad!”\n\n$............................................$\n\n$A:$ “I’m out of money. Can you lend me some?”\n\n$B:$ “Call me dad.”\n\n$A:$ “Dad!”\n\nOne month later,\n\n$B:$ “Can you pay me back?”\n\n$A:$ “Call me dad.”\n\n$B:$ “Dad!”", "description": "In male dorms across the country, there are always all kinds of messy “father-son” relationships.\n\nNow suppose a dorm has $n$ different people. Each person has at most one “dad”, can have multiple “sons”, and there is exactly one person who has no “dad” (after all, they are the dorm leader, so give them some respect; of course, anyone can be the leader).\n\nNow the question is: for a dorm with $n$ people, what is the maximum possible number of different father-son relationships? Also, between any two people, there must be a direct or indirect father-son relationship.", "inputFormat": "The first line contains a non-negative integer $t$, meaning there are $t$ test cases.\n\nThe next $t$ lines each contain an integer $n$, meaning there are $n$ people.", "outputFormat": "Output $t$ lines. Each line contains one integer, the number of possible relationships.\n\nSince the answer may be large, output the result modulo $10^9+9$.", "hint": "- For $10\\%$ of the testdata, it is guaranteed that $t=0$.\n\n- For another $30\\%$ of the testdata, it is guaranteed that $n \\le 5$.\n\n- For $100\\%$ of the testdata, $t \\le 10^4$, $1 \\le n \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "父子", "background": "上演在各大学男生寝室的日常 $:$\n\n$A :$ “我没带纸，快来厕所救我！”\n\n$B :$ “叫爸爸。”\n\n$A :$ “爸爸！”\n\n$............................................$\n\n$A :$ “我没钱了，能借我点吗。”\n\n$B :$ “叫爸爸。”\n\n$A :$ “爸爸！”\n\n一个月后、\n\n$B :$ “能把钱还给我吗。”\n\n$A :$ “叫爸爸。”\n\n$B :$ “爸爸！”", "description": "对于全国各大大学的男生寝室，总是有各种混乱的父子关系。\n\n那么假设现在我们一个男生寝室有不同的 $n$ 个人，每个人都至多有一个“爸爸”，可以有多个“儿子”，且有且只有一个人没有“爸爸”(毕竟是室长，还是要给点面子，当然了，室长人人当嘛)。\n\n那么现在问题来了，对于一个有 $n$ 个人的寝室，最多可能存在多少种父子关系，当然每个人之间都必须要有直接或间接的父子关系。", "inputFormat": "第一行一个非负整数 $t$，表示有 $t$ 组数据。\n\n接下来 $t$ 行，每行一个整数 $n$，表示有 $n$ 个人。", "outputFormat": "共 $t$ 行，每行一个整数，求关系个数。\n\n由于答案可能较大，则我们需要输出答案对 $10^9+9$ 取模的值。", "hint": "- 对于 $10\\%$ 的数据，保证 $t=0$；\n\n- 另有 $30\\%$ 的数据，保证 $n≤5$；\n\n- 对于 $100\\%$ 的数据，$t≤10^4$，$1\\le n\\le10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P4982", "type": "P", "difficulty": 6, "samples": [["3 3 2\n2 1 3\n2 2 3\n", "11"], ["10 7 3\n5 1 2 3 4 5\n3 1 3 7\n4 1 2 6 7\n", "730285459"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000]}, "tags": ["动态规划 DP", "O2优化", "期望", "构造"], "title": "规划", "background": "经过长期的艰苦奋斗，${\\rm TimeTraveller\\ }$终于成功进入了理想的学校。", "description": "作为吃货的${\\rm \\ TimeTraveller}$，入学的第一件事不是去报到，而是去食堂调查菜品。但是由于各种原因，本学期食堂的菜品很少，而且食堂制定了几天的菜谱，那么这个学期里，以后每天提供的菜品都会**按照菜谱轮流循环进行**。听到这件事，${\\rm TimeTraveller\\ }$的内心当然是崩溃的，但是他还是希望每天能吃的不那么重复，于是${\\rm \\  TimeTraveller\\ }$决定只要**和前一天吃的菜不重复**就行了，但是身为吃货的${\\rm \\ TimeTraveller\\ }$当然也不想饿肚子，所以**每天至少都要吃一道菜**。\n\n${\\rm TimeTraveller\\ }$想要知道他有多少种合法的规划方案，但是他发现这实在是太多了，于是他来求助你，希望你能编写一个程序帮他计算。\n", "inputFormat": "第一行三个正整数$n,m,k$，分别表示这个学期有$n$天，总共有$m$种菜品，学校制定了$k$天的菜谱（所有菜品从$1$到$m$编号，保证$n ≥ k$）。\n\n接下来$k$行，每行第一个数$p$表示这一天学校准备了$p$道菜，紧接着有$p$个数，表示这一天的$p$道菜分别是哪几道（保证$p$不会超过$m$，且这$p$个数都是不重复的）。\n", "outputFormat": "输出合法方案的数量，由于答案可能过大，你只需要输出答案对$1e9+7$取模后的值。", "hint": "#### 样例$1$解释：\n\n方案$1$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$2$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$3$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品；\n\n方案$4$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$5$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$6$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品；\n\n方案$7$：第一天吃$1$号菜品，第二天吃$2,3$号菜品，第三天吃$1$号菜品；\n\n方案$8$：第一天吃$1$号菜品，第二天吃$3$号菜品，第三天吃$1$号菜品；\n\n方案$9$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$10$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$11$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品。\n\n#### 数据范围：\n\n- 对于$20\\%$的数据，$n≤ 5,m≤ 7,k≤ 5$；\n\n- 对于$45\\%$的数据，$n≤ 50000,m≤ 7,k≤ 7$；\n\n- 另有$10\\%$的数据，$n≤ 10^7,m≤ 2,k= 1$；\n\n- 对于$70\\%$的数据，$n≤ 10^7,m≤ 7,k≤ 7$；\n\n- 对于$100\\%$的数据，$n≤ 10^7,m≤ 7,k≤ 300$。", "locale": "zh-CN", "translations": {"en": {"title": "Planning", "background": "After a long period of hard work, ${\\rm TimeTraveller\\ }$ finally got into his dream school.", "description": "As a foodie, ${\\rm \\ TimeTraveller}$ did not go to register on his first day after enrollment. Instead, he went to the cafeteria to check the dishes. However, for various reasons, there are very few dishes in the cafeteria this semester, and the cafeteria has made a menu for several days. Therefore, during this semester, the dishes provided each day in the future will **cycle in turn according to the menu**.\n\nAfter hearing this, ${\\rm TimeTraveller\\ }$ was of course devastated, but he still hopes that what he eats every day will not be too repetitive. So ${\\rm \\  TimeTraveller\\ }$ decides that it is enough as long as **the dishes he eats do not overlap with the previous day**. But as a foodie, ${\\rm \\ TimeTraveller\\ }$ also does not want to go hungry, so **he must eat at least one dish every day**.\n\n${\\rm TimeTraveller\\ }$ wants to know how many legal planning schemes he has, but he finds there are simply too many. So he asks you for help and hopes you can write a program to compute it for him.", "inputFormat": "The first line contains three positive integers $n,m,k$, meaning this semester has $n$ days, there are $m$ kinds of dishes in total, and the school has made a $k$-day menu (all dishes are numbered from $1$ to $m$, and it is guaranteed that $n \\ge k$).\n\nThe next $k$ lines describe the menu. In each line, the first number is $p$, meaning the school prepared $p$ dishes on that day, followed by $p$ numbers indicating which dishes they are (it is guaranteed that $p$ does not exceed $m$, and these $p$ numbers are all distinct).", "outputFormat": "Output the number of legal schemes. Since the answer may be too large, you only need to output the value modulo $1e9+7$.", "hint": "#### Sample $1$ Explanation:\n\nScheme $1$: On day $1$, eat dishes $1,3$; on day $2$, eat dish $2$; on day $3$, eat dishes $1,3$.\n\nScheme $2$: On day $1$, eat dishes $1,3$; on day $2$, eat dish $2$; on day $3$, eat dish $3$.\n\nScheme $3$: On day $1$, eat dishes $1,3$; on day $2$, eat dish $2$; on day $3$, eat dish $1$.\n\nScheme $4$: On day $1$, eat dish $3$; on day $2$, eat dish $2$; on day $3$, eat dishes $1,3$.\n\nScheme $5$: On day $1$, eat dish $3$; on day $2$, eat dish $2$; on day $3$, eat dish $3$.\n\nScheme $6$: On day $1$, eat dish $3$; on day $2$, eat dish $2$; on day $3$, eat dish $1$.\n\nScheme $7$: On day $1$, eat dish $1$; on day $2$, eat dishes $2,3$; on day $3$, eat dish $1$.\n\nScheme $8$: On day $1$, eat dish $1$; on day $2$, eat dish $3$; on day $3$, eat dish $1$.\n\nScheme $9$: On day $1$, eat dish $1$; on day $2$, eat dish $2$; on day $3$, eat dishes $1,3$.\n\nScheme $10$: On day $1$, eat dish $1$; on day $2$, eat dish $2$; on day $3$, eat dish $3$.\n\nScheme $11$: On day $1$, eat dish $1$; on day $2$, eat dish $2$; on day $3$, eat dish $1$.\n\n#### Constraints:\n\n- For $20\\%$ of the testdata, $n \\le 5, m \\le 7, k \\le 5$.\n\n- For $45\\%$ of the testdata, $n \\le 50000, m \\le 7, k \\le 7$.\n\n- For another $10\\%$ of the testdata, $n \\le 10^7, m \\le 2, k = 1$.\n\n- For $70\\%$ of the testdata, $n \\le 10^7, m \\le 7, k \\le 7$.\n\n- For $100\\%$ of the testdata, $n \\le 10^7, m \\le 7, k \\le 300$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "规划", "background": "经过长期的艰苦奋斗，${\\rm TimeTraveller\\ }$终于成功进入了理想的学校。", "description": "作为吃货的${\\rm \\ TimeTraveller}$，入学的第一件事不是去报到，而是去食堂调查菜品。但是由于各种原因，本学期食堂的菜品很少，而且食堂制定了几天的菜谱，那么这个学期里，以后每天提供的菜品都会**按照菜谱轮流循环进行**。听到这件事，${\\rm TimeTraveller\\ }$的内心当然是崩溃的，但是他还是希望每天能吃的不那么重复，于是${\\rm \\  TimeTraveller\\ }$决定只要**和前一天吃的菜不重复**就行了，但是身为吃货的${\\rm \\ TimeTraveller\\ }$当然也不想饿肚子，所以**每天至少都要吃一道菜**。\n\n${\\rm TimeTraveller\\ }$想要知道他有多少种合法的规划方案，但是他发现这实在是太多了，于是他来求助你，希望你能编写一个程序帮他计算。\n", "inputFormat": "第一行三个正整数$n,m,k$，分别表示这个学期有$n$天，总共有$m$种菜品，学校制定了$k$天的菜谱（所有菜品从$1$到$m$编号，保证$n ≥ k$）。\n\n接下来$k$行，每行第一个数$p$表示这一天学校准备了$p$道菜，紧接着有$p$个数，表示这一天的$p$道菜分别是哪几道（保证$p$不会超过$m$，且这$p$个数都是不重复的）。\n", "outputFormat": "输出合法方案的数量，由于答案可能过大，你只需要输出答案对$1e9+7$取模后的值。", "hint": "#### 样例$1$解释：\n\n方案$1$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$2$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$3$：第一天吃$1,3$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品；\n\n方案$4$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$5$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$6$：第一天吃$3$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品；\n\n方案$7$：第一天吃$1$号菜品，第二天吃$2,3$号菜品，第三天吃$1$号菜品；\n\n方案$8$：第一天吃$1$号菜品，第二天吃$3$号菜品，第三天吃$1$号菜品；\n\n方案$9$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$1,3$号菜品；\n\n方案$10$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$3$号菜品；\n\n方案$11$：第一天吃$1$号菜品，第二天吃$2$号菜品，第三天吃$1$号菜品。\n\n#### 数据范围：\n\n- 对于$20\\%$的数据，$n≤ 5,m≤ 7,k≤ 5$；\n\n- 对于$45\\%$的数据，$n≤ 50000,m≤ 7,k≤ 7$；\n\n- 另有$10\\%$的数据，$n≤ 10^7,m≤ 2,k= 1$；\n\n- 对于$70\\%$的数据，$n≤ 10^7,m≤ 7,k≤ 7$；\n\n- 对于$100\\%$的数据，$n≤ 10^7,m≤ 7,k≤ 300$。", "locale": "zh-CN"}}}
{"pid": "P4983", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2 3\n", "32"], ["10 3\n1 2 3 4 5 6 7 8 9 10\n", "1140"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["斜率优化", "凸完全单调性（wqs 二分）", "凸包"], "title": "忘情", "background": " “为什么要离开我！”\n\n “因为你没玩儿转！”\n\n “我玩儿转了！”\n\n “那好，你现在就给我维护这么一个式子！”\n\n “为什么要出这么毒瘤的东西。”\n\n “为了恶心你。”\n\n “......”\n\n$…………………………….$\n", "description": "你的 $npy$ 为了恶心你，特地请了四位大神和一个辣鸡！\n\n $\\rm hdxrie$ 说：“我们得求和。”于是有了 $\\sum\\limits_{i=1}^{n}x_i $ 。\n\n $\\rm Imagine$ 说：“我们得有平均数。”于是有了 $\\bar x $ 。\n\n $\\rm TimeTraveller$ 说：“我们得有加减乘除。”于是有了一些恶心的组合。\n\n $\\rm Althen·Way·Satan$ 说：“我们还得有平方。”于是我们将它平方。\n\n最垃圾的 $\\rm ZredXNy$ 说：“那我帮你们整合一下。”\n\n于是，我们得到了这么一个式子 $:$\n\n$$\\frac{\\left((\\sum\\limits_{i=1}^{n}x_i×\\bar x)+\\bar x\\right)^2}{\\bar x^2}$$\n\n\n我们定义一段序列的值为这个，其中  $n$为此序列的元素个数。\n\n我们给定一段长度为 $n$ 的序列,现在要求将它分成 $m$ 段，要求每一段的值的总和最小，求出这个最小值。\n", "inputFormat": "第一行两个正整数，分别为 $n$，$m$，定义见题面。\n\n接下来一行为 $n$ 个正整数，依次给出这个序列的每个元素的值 $x_i$ 。", "outputFormat": "一个整数，求出这个最小值。", "hint": "- 对于 $30 \\%$ 的数据，$m≤n≤500$；\n\n- 另有 $20 \\%$ 的数据，保证 $m=2$；\n\n- 对于 $100 \\%$ 的数据，$m≤n≤100000$，$1≤x_i≤1000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Forgetfulness", "background": "\"Why are you leaving me!\"\n\n\"Because you can't handle it!\"\n\n\"I can handle it!\"\n\n\"Fine, then maintain such a formula for me right now!\"\n\n\"Why would you give such a nasty thing.\"\n\n\"To annoy you.\"\n\n\"......\"\n\n$…………………………….$", "description": "Your $npy$, in order to annoy you, specially invited four gurus and one noob!\n\n$\\rm hdxrie$ said: \"We need a sum.\" So we have $\\sum\\limits_{i=1}^{n} x_i$.\n\n$\\rm Imagine$ said: \"We need an average.\" So we have $\\bar x$.\n\n$\\rm TimeTraveller$ said: \"We need addition, subtraction, multiplication, and division.\" So we have some nasty combinations.\n\n$\\rm Althen·Way·Satan$ said: \"We also need squaring.\" So we square it.\n\nThe worst $\\rm ZredXNy$ said: \"Then I'll help you merge them.\"\n\nSo we get the following expression:\n\n$$\\frac{\\left((\\sum\\limits_{i=1}^{n}x_i×\\bar x)+\\bar x\\right)^2}{\\bar x^2}$$\n\nWe define the value of a sequence as this expression, where $n$ is the number of elements in the sequence.\n\nGiven a sequence of length $n$, you now need to split it into $m$ segments. The sum of the values of all segments should be as small as possible. Output this minimum value.", "inputFormat": "The first line contains two positive integers $n$ and $m$, as defined in the statement.\n\nThe next line contains $n$ positive integers, giving the value of each element $x_i$ in order.", "outputFormat": "Output one integer, the minimum value.", "hint": "- For $30\\%$ of the data, $m \\le n \\le 500$.\n- For another $20\\%$ of the data, it is guaranteed that $m = 2$.\n- For $100\\%$ of the data, $m \\le n \\le 100000$, $1 \\le x_i \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "忘情", "background": " “为什么要离开我！”\n\n “因为你没玩儿转！”\n\n “我玩儿转了！”\n\n “那好，你现在就给我维护这么一个式子！”\n\n “为什么要出这么毒瘤的东西。”\n\n “为了恶心你。”\n\n “......”\n\n$…………………………….$\n", "description": "你的 $npy$ 为了恶心你，特地请了四位大神和一个辣鸡！\n\n $\\rm hdxrie$ 说：“我们得求和。”于是有了 $\\sum\\limits_{i=1}^{n}x_i $ 。\n\n $\\rm Imagine$ 说：“我们得有平均数。”于是有了 $\\bar x $ 。\n\n $\\rm TimeTraveller$ 说：“我们得有加减乘除。”于是有了一些恶心的组合。\n\n $\\rm Althen·Way·Satan$ 说：“我们还得有平方。”于是我们将它平方。\n\n最垃圾的 $\\rm ZredXNy$ 说：“那我帮你们整合一下。”\n\n于是，我们得到了这么一个式子 $:$\n\n$$\\frac{\\left((\\sum\\limits_{i=1}^{n}x_i×\\bar x)+\\bar x\\right)^2}{\\bar x^2}$$\n\n\n我们定义一段序列的值为这个，其中  $n$为此序列的元素个数。\n\n我们给定一段长度为 $n$ 的序列,现在要求将它分成 $m$ 段，要求每一段的值的总和最小，求出这个最小值。\n", "inputFormat": "第一行两个正整数，分别为 $n$，$m$，定义见题面。\n\n接下来一行为 $n$ 个正整数，依次给出这个序列的每个元素的值 $x_i$ 。", "outputFormat": "一个整数，求出这个最小值。", "hint": "- 对于 $30 \\%$ 的数据，$m≤n≤500$；\n\n- 另有 $20 \\%$ 的数据，保证 $m=2$；\n\n- 对于 $100 \\%$ 的数据，$m≤n≤100000$，$1≤x_i≤1000$。\n", "locale": "zh-CN"}}}
{"pid": "P4984", "type": "P", "difficulty": 6, "samples": [["2\n10 2 4 72451\n-3 -4 2 123456\n", "10001101100000011\n10200101101\n101230003\n2021\n122000\n10001001\n-10000111"], ["2\n8 2 2 176336030760401.6\n30 35 36 HQA9MBFD3SEC.<GAR85DJ2LO>\n", "1111110011011110000011000111110000100000001.11\n39SAWRJ5CPP7.<J36CPFVSM9>\n2EMEUXKKZHA0.<JMWQ6>"], ["1\n-26 -6 -6 1PMMK.<L15>\n", "1213400.<511>"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000]}, "tags": ["进制", "期望"], "title": "转换", "background": "$\\rm hdxrie\\ $最近在为新建的宇宙购物中心编写价格系统。", "description": "购物中心汇聚了来自各个星球的商品，但是由于不同的星球采用的进制各不相同，导致商品价格计算起来比较困难，因此价格系统是必不可少的。\n\n由于甲方所给的期限太短，$\\rm hdxrie\\ $便找到你来做他的助手，他只需要你帮忙编写一个进制转换的程序就行，其它的各个系统版块全部由他自己负责，你能在规定期限内写出转换程序吗？", "inputFormat": "第一行一个数$n$，$n$表示有多少个物品的价格需要转换。\n\n接下来$n$行，每行三个数字$a,l,r$和一个价格串$S$。\n\n$a$表示这个价格串为$a$进制数（保证$a$不为$-1,0,1$），你需要把它转化为$l$到$r$的所有进制（请自动跳过输出为$-1,0,1$这些进制的情况）。\n\n由于价格为实数，所以难免会出现小数，并且若一个小数为循环小数，我们会将小数的循环节使用 <,> 括起来。\n\n如果不是循环小数则没有尖括号，如果没有小数部分则没有小数点，保证不会出现尖括号之间没有数字情况。\n\n保证循环节以及循环节前面的小数部分都是最短的，例如$10$进制下的$0.123123\\cdots$，那么所给的读入形式为$0.$<$123$>，保证不会出现类似于$0.1$<$231$>或$0.$<$123123$>这些情况。\n\n对于正进制$a$，保证不会出现循环节为$a-1$的情况，例如$10$进制不会出现$0.$<$9$>这样的输入，但是负进制没有这样的要求。\n\n为了方便转换，当用正进制表示负数的时候，规定在价格前加上负号，但是由于负进制既可表示正数也可表示负数，所以规定负进制前不允许出现负号。\n\n规定任意进制的每一位不能为负，规定大于$9$的值按照大写字母从小到大编写。", "outputFormat": "对于每一个需要转换的价格，在给定范围内按进制从小到大的顺序输出转换为该进制后的价格串（请自动跳过输出为$-1,0,1$这些进制的情况）。\n\n对于输出格式你也应该严格按照上面输入格式的要求输出每一个价格串。", "hint": "- 对于$5\\%$的数据，保证没有小数部分，$1≤n≤20,2≤a≤36,2≤l≤r≤36$；\n\n- 对于$15\\%$的数据，保证没有小数部分，$1≤n≤100,2≤|a|≤36,-36≤l≤r≤36$；\n\n- 另有$15\\%$的数据，保证转换前和转换后都是有限小数，$1≤n≤550,2≤a≤36,2≤l≤r≤36$；\n\n- 另有$20\\%$的数据，$1≤n≤550,2≤a≤36,2≤l≤r≤36$；\n\n- 对于$100\\%$的数据，$1≤n≤550,2≤|a|≤36,-36≤l≤r≤36$；\n\n保证所有数据中，价格的绝对值都不会超过$2^{63}-1$，且转换前和转换后的小数部分的字符串长度均不超过$\\left\\lfloor\\log_{|a|}2^{62}\\right\\rfloor$（$a$表示进制，括号不计入长度）。", "locale": "zh-CN", "translations": {"en": {"title": "Conversion", "background": "$\\rm hdxrie\\ $ has recently been writing a pricing system for a newly built interstellar shopping mall.", "description": "The shopping mall gathers goods from many planets. However, different planets use different numeral bases, which makes price calculation difficult, so a pricing system is necessary.\n\nBecause the deadline given by the client is too tight, $\\rm hdxrie\\ $ asks you to be his assistant. He only needs you to help write a base conversion program; all other system modules will be handled by himself. Can you finish the conversion program within the time limit?", "inputFormat": "The first line contains an integer $n$, where $n$ is the number of item prices that need to be converted.\n\nThe next $n$ lines each contain three integers $a, l, r$ and a price string $S$.\n\n$a$ means the price string is a base-$a$ number (it is guaranteed that $a$ is not $-1, 0, 1$). You need to convert it into all bases from $l$ to $r$ (please automatically skip the cases where the base is $-1, 0, 1$).\n\nSince prices are real numbers, there may be fractional parts. If a fractional part is repeating, we will enclose the repeating cycle in `<,>`.\n\nIf it is not a repeating decimal, there will be no angle brackets. If there is no fractional part, there will be no decimal point. It is guaranteed that there will not be a case where there are no digits between the angle brackets.\n\nIt is guaranteed that both the repeating cycle and the non-repeating part before it are the shortest possible. For example, in base $10$, $0.123123\\cdots$ will be given as $0.$<$123$>. Inputs like $0.1$<$231$> or $0.$<$123123$> will not appear.\n\nFor positive base $a$, it is guaranteed that the repeating cycle will not be $a-1$. For example, in base $10$, an input like $0.$<$9$> will not appear. But for negative bases, there is no such restriction.\n\nTo make conversion easier, when using a positive base to represent a negative number, a minus sign is added before the price. But since a negative base can represent both positive and negative numbers, a minus sign is not allowed for negative bases.\n\nIt is required that every digit in any base is non-negative. Values greater than $9$ are written using uppercase letters in increasing order.", "outputFormat": "For each price that needs to be converted, output the price string converted to each base in the given range, in increasing order of the base (please automatically skip the cases where the base is $-1, 0, 1$).\n\nYou must also strictly follow the requirements described above for the input format when outputting each price string.", "hint": "- For $5\\%$ of the testdata, there is no fractional part, and $1≤n≤20,2≤a≤36,2≤l≤r≤36$.\n\n- For $15\\%$ of the testdata, there is no fractional part, and $1≤n≤100,2≤|a|≤36,-36≤l≤r≤36$.\n\n- For another $15\\%$ of the testdata, both before and after conversion are terminating decimals, and $1≤n≤550,2≤a≤36,2≤l≤r≤36$.\n\n- For another $20\\%$ of the testdata, $1≤n≤550,2≤a≤36,2≤l≤r≤36$.\n\n- For $100\\%$ of the testdata, $1≤n≤550,2≤|a|≤36,-36≤l≤r≤36$.\n\nIt is guaranteed that in all testdata, the absolute value of the price will not exceed $2^{63}-1$, and the length of the fractional-part string (before and after conversion) will not exceed $\\left\\lfloor\\log_{|a|}2^{62}\\right\\rfloor$ ($a$ is the base; the parentheses are not counted in the length).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "转换", "background": "$\\rm hdxrie\\ $最近在为新建的宇宙购物中心编写价格系统。", "description": "购物中心汇聚了来自各个星球的商品，但是由于不同的星球采用的进制各不相同，导致商品价格计算起来比较困难，因此价格系统是必不可少的。\n\n由于甲方所给的期限太短，$\\rm hdxrie\\ $便找到你来做他的助手，他只需要你帮忙编写一个进制转换的程序就行，其它的各个系统版块全部由他自己负责，你能在规定期限内写出转换程序吗？", "inputFormat": "第一行一个数$n$，$n$表示有多少个物品的价格需要转换。\n\n接下来$n$行，每行三个数字$a,l,r$和一个价格串$S$。\n\n$a$表示这个价格串为$a$进制数（保证$a$不为$-1,0,1$），你需要把它转化为$l$到$r$的所有进制（请自动跳过输出为$-1,0,1$这些进制的情况）。\n\n由于价格为实数，所以难免会出现小数，并且若一个小数为循环小数，我们会将小数的循环节使用 <,> 括起来。\n\n如果不是循环小数则没有尖括号，如果没有小数部分则没有小数点，保证不会出现尖括号之间没有数字情况。\n\n保证循环节以及循环节前面的小数部分都是最短的，例如$10$进制下的$0.123123\\cdots$，那么所给的读入形式为$0.$<$123$>，保证不会出现类似于$0.1$<$231$>或$0.$<$123123$>这些情况。\n\n对于正进制$a$，保证不会出现循环节为$a-1$的情况，例如$10$进制不会出现$0.$<$9$>这样的输入，但是负进制没有这样的要求。\n\n为了方便转换，当用正进制表示负数的时候，规定在价格前加上负号，但是由于负进制既可表示正数也可表示负数，所以规定负进制前不允许出现负号。\n\n规定任意进制的每一位不能为负，规定大于$9$的值按照大写字母从小到大编写。", "outputFormat": "对于每一个需要转换的价格，在给定范围内按进制从小到大的顺序输出转换为该进制后的价格串（请自动跳过输出为$-1,0,1$这些进制的情况）。\n\n对于输出格式你也应该严格按照上面输入格式的要求输出每一个价格串。", "hint": "- 对于$5\\%$的数据，保证没有小数部分，$1≤n≤20,2≤a≤36,2≤l≤r≤36$；\n\n- 对于$15\\%$的数据，保证没有小数部分，$1≤n≤100,2≤|a|≤36,-36≤l≤r≤36$；\n\n- 另有$15\\%$的数据，保证转换前和转换后都是有限小数，$1≤n≤550,2≤a≤36,2≤l≤r≤36$；\n\n- 另有$20\\%$的数据，$1≤n≤550,2≤a≤36,2≤l≤r≤36$；\n\n- 对于$100\\%$的数据，$1≤n≤550,2≤|a|≤36,-36≤l≤r≤36$；\n\n保证所有数据中，价格的绝对值都不会超过$2^{63}-1$，且转换前和转换后的小数部分的字符串长度均不超过$\\left\\lfloor\\log_{|a|}2^{62}\\right\\rfloor$（$a$表示进制，括号不计入长度）。", "locale": "zh-CN"}}}
