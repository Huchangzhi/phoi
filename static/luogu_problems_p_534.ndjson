{"pid": "P11841", "type": "P", "difficulty": 3, "samples": [["4\n5 3 5 2\n5 3 8 19\n5 3 19 8\n5 3 5 3", "-1\n3\n-1\n0"], ["1\n1 1 1 1000000000000000000", "999999999999999999"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "USACO", "2025", "数论"], "title": "[USACO25FEB] Transforming Pairs S", "background": "", "description": "聪明奶牛 Bessie 发现了一种新的迷恋——数学魔法！一天，当她在 Farmer John 牧场的草地上小跑时，她偶然发现了两堆有魔法的干草。第一堆包含 $a$ 捆干草，第二堆包含 $b$ 捆干草（$1\\le a,b\\le 10^{18}$）。\n\n在干草堆边上，半埋在泥土里，她发现了一卷古老的卷轴。当她展开卷轴时，发光的字母揭示了一个预言：\n\n奉大草原之令，被选中者需令此平凡之干草堆转为恰好 $c$ 捆及 $d$ 捆——不可多，亦不可少。\n\nBessie 意识到她只能施展以下两种魔法：\n\n- 她可以施法召唤新的干草捆以增加第一堆的大小，增加的数量等于当前第二堆的数量。\n- 她可以施法召唤新的干草捆以增加第二堆的大小，增加的数量等于当前第一堆的数量。\n\n她必须逐次执行这些操作，但可以任意顺序执行任意多次。她必须恰好使第一堆达到 $c$ 捆，第二堆达到 $d$ 捆（$1\\le c,d\\le 10^{18}$）。\n\n对于 $T$（$1\\le T\\le 10^4$）个独立的测试用例中的每一个，输出实现预言所需的最小操作次数，或者如果不可能实现时输出 -1。", "inputFormat": "输入的第一行包含 $T$。\n\n以下 $T$ 行，每行包含四个整数 $a$，$b$，$c$，$d$。", "outputFormat": "输出 $T$ 行，为每一个测试用例的答案。\n", "hint": "样例 1 解释：\n\n在第一个测试用例中，由于 $b>d$，但操作只可能增加 $b$，因此不可能实现。\n\n在第二个测试用例中，最初两堆有 $(5, 3)$ 捆。Bessie 可以将第一堆增加第二堆的数量，得到 $(8, 3)$ 捆。然后 Bessie 可以将第二堆增加第一堆的新数量，并执行该操作两次，得到 $(8, 11)$ 并最后得到 $(8, 19)$ 捆。这与 $c$ 和 $d$ 一致，且是达到目标的最小操作次数。\n\n注意，第三个测试用例的答案与第二个不同，因为 $c$ 和 $d$ 的值交换了（堆的顺序有影响）。\n\n在第四个测试用例中，不需要任何操作。\n\n- 测试点 $3\\sim 4$：$\\max(c, d) \\le 20 \\cdot\\min(a, b)$。\n- 测试点 $5\\sim 7$：$T \\le 10$ 且 $a,b,c,d\\le 10^6$。\n- 测试点 $8\\sim 12$：没有额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25FEB] Transforming Pairs S", "background": null, "description": "Bessie the brilliant bovine has discovered a new fascination—mathematical magic! One day, while trotting through the fields of Farmer John's ranch, she stumbles upon two enchanted piles of hay. The first pile contains $a$ bales, and the second pile contains $b$ bales ($1\\le a,b\\le 10^{18}$).  \n\nNext to the hay, half-buried in the dirt, she discovers an ancient scroll. As she unfurls it, glowing letters reveal a prophecy:  \n\n_To fulfill the decree of the Great Grasslands, the chosen one must transform these two humble hay piles into exactly $c$ and $d$ bales—no more, no less._  \n\nBessie realizes she can only perform the following two spells: \n- She can magically conjure new bales to increase the first pile's size by the amount currently in the second pile.\n- She can magically conjure new bales to increase the second pile's size by the amount currently in the first pile.\n\nShe must perform these operations sequentially, but she can perform them any number of times and in any order. She must reach exactly $c$ bales in the first pile and $d$ bales in the second pile ($1\\le c,d\\le 10^{18}$).  \n\nFor each of $T$ ($1\\le T\\le 10^4$) independent test cases, output the minimum  number of operations needed to fulfill the prophecy, or if it is impossible to do so, output -1.", "inputFormat": "The first line contains $T$.  \n\nThe next $T$ lines each contain four integers $a,b,c,d$.", "outputFormat": "Output $T$ lines, the answer to each test case.", "hint": "##### For Sample 1:\n\nIn the first test case, it is impossible since $b>d$ initially, but operations can only increase $b$.  \n\nIn the second test case, initially the two piles have $(5, 3)$ bales.  Bessie can first increase the first pile by the amount in the second pile, resulting in $(8, 3)$ bales.  Bessie can then increase the second pile by the new amount in the first pile, and do this operation twice, resulting in $(8, 11)$ and finally $(8, 19)$ bales.  This matches $c$ and $d$ and is the minimum number of operations to get there.  \n\nNote that the third test case has a different answer than the second because $c$ and $d$ are swapped (the order of the piles matters).  \n\nIn the fourth test case, no operations are necessary.  \n\n\n\n#### SCORING:\n\n- Inputs 3-4: $\\max(c, d) \\le 20 \\cdot\\min(a, b)$ \n- Inputs 5-7: $T \\le 10$ and $a,b,c,d\\le 10^6$ \n- Inputs 8-12: No additional constraints", "locale": "en"}, "zh-CN": {"title": "[USACO25FEB] Transforming Pairs S", "background": "", "description": "聪明奶牛 Bessie 发现了一种新的迷恋——数学魔法！一天，当她在 Farmer John 牧场的草地上小跑时，她偶然发现了两堆有魔法的干草。第一堆包含 $a$ 捆干草，第二堆包含 $b$ 捆干草（$1\\le a,b\\le 10^{18}$）。\n\n在干草堆边上，半埋在泥土里，她发现了一卷古老的卷轴。当她展开卷轴时，发光的字母揭示了一个预言：\n\n奉大草原之令，被选中者需令此平凡之干草堆转为恰好 $c$ 捆及 $d$ 捆——不可多，亦不可少。\n\nBessie 意识到她只能施展以下两种魔法：\n\n- 她可以施法召唤新的干草捆以增加第一堆的大小，增加的数量等于当前第二堆的数量。\n- 她可以施法召唤新的干草捆以增加第二堆的大小，增加的数量等于当前第一堆的数量。\n\n她必须逐次执行这些操作，但可以任意顺序执行任意多次。她必须恰好使第一堆达到 $c$ 捆，第二堆达到 $d$ 捆（$1\\le c,d\\le 10^{18}$）。\n\n对于 $T$（$1\\le T\\le 10^4$）个独立的测试用例中的每一个，输出实现预言所需的最小操作次数，或者如果不可能实现时输出 -1。", "inputFormat": "输入的第一行包含 $T$。\n\n以下 $T$ 行，每行包含四个整数 $a$，$b$，$c$，$d$。", "outputFormat": "输出 $T$ 行，为每一个测试用例的答案。\n", "hint": "样例 1 解释：\n\n在第一个测试用例中，由于 $b>d$，但操作只可能增加 $b$，因此不可能实现。\n\n在第二个测试用例中，最初两堆有 $(5, 3)$ 捆。Bessie 可以将第一堆增加第二堆的数量，得到 $(8, 3)$ 捆。然后 Bessie 可以将第二堆增加第一堆的新数量，并执行该操作两次，得到 $(8, 11)$ 并最后得到 $(8, 19)$ 捆。这与 $c$ 和 $d$ 一致，且是达到目标的最小操作次数。\n\n注意，第三个测试用例的答案与第二个不同，因为 $c$ 和 $d$ 的值交换了（堆的顺序有影响）。\n\n在第四个测试用例中，不需要任何操作。\n\n- 测试点 $3\\sim 4$：$\\max(c, d) \\le 20 \\cdot\\min(a, b)$。\n- 测试点 $5\\sim 7$：$T \\le 10$ 且 $a,b,c,d\\le 10^6$。\n- 测试点 $8\\sim 12$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P11842", "type": "P", "difficulty": 5, "samples": [["5\n2 4 4 5 3\n1 1 1 1 1", "3"], ["8\n1 2 5 5 3 3 4 4\n9 9 2 5 9 9 9 9", "7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025", "树形 DP", "基环树"], "title": "[USACO25FEB] Bessie's Function G", "background": "", "description": "Bessie 有一个特别的函数 $f(x)$，接收一个 $[1, N]$ 内的整数作为输入，并返回一个 $[1, N]$ 内的整数（$1 \\le N \\le 2 \\cdot 10^5$）。她的函数 $f(x)$ 由 $N$ 个整数 $a_1 \\ldots a_N$ 定义，其中 $f(x) = a_x$（$1 \\le a_i \\le N$）。\n\nBessie 希望这个函数是幂等的。换句话说，它应当对于所有整数 $x \\in [1, N]$ 满足 $f(f(x)) = f(x)$。\n\nBessie 可以以代价 $c_i$ 将 $a_i$ 的值修改为 $[1, N]$ 内的任意整数（$1 \\le c_i \\le 10^9$）。求 Bessie 使 $f(x)$ 变为幂等所需要的最小总代价。", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个空格分隔的整数 $a_1,a_2,\\dots,a_N$。\n\n第三行包含 $N$ 个空格分隔的整数 $c_1,c_2,\\dots,c_N$。", "outputFormat": "输出 Bessie 使 $f(x)$ 变为幂等所需要的最小总代价。\n", "hint": "样例 1 解释：\n\n我们可以修改 $a_1 = 4$，$a_4 = 4$，$a_5 = 4$。由于所有 $c_i$ 均等于 $1$，所以总代价等于 $3$，即修改的数量。可以证明，不存在仅进行 $2$ 次或更少修改的解。\n\n样例 2 解释：\n\n我们修改 $a_3 = 3$ 以及 $a_4 = 4$。总代价为 $2+5=7$。\n\n- 测试点 $3$: $N \\le 20$。\n- 测试点 $4\\sim 9$: $a_i \\ge i$。\n- 测试点 $10\\sim 15$: 所有 $a_i$ 各不相同。\n- 测试点 $16\\sim 21$: 没有额外限制。\n\n除此之外，在后三个子任务中，前一半的测试点将满足对于所有 $i$ 有 $c_i=1$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25FEB] Bessie's Function G", "background": null, "description": "Bessie has a special function $f(x)$ that takes as input an integer in $[1, N]$ and  returns an integer in $[1, N]$ ($1 \\le N \\le 2 \\cdot 10^5$). Her function $f(x)$ is defined by  $N$ integers $a_1 \\ldots a_N$ where $f(x) = a_x$ ($1 \\le a_i \\le N$).    \n\nBessie wants this function to be idempotent. In other words, it should satisfy $f(f(x)) = f(x)$  for all integers $x \\in [1, N]$.   \n\nFor a cost of $c_i$, Bessie can change the value of $a_i$ to any integer in $[1, N]$ ($1 \\le c_i \\le 10^9$). Determine the minimum total cost Bessie needs  to make $f(x)$ idempotent.", "inputFormat": "The first line contains $N$.  \n\nThe second line contains $N$ space-separated integers $a_1,a_2,\\dots,a_N$.  \n\nThe third line contains $N$ space-separated integers $c_1,c_2,\\dots,c_N$.", "outputFormat": "Output the minimum total cost Bessie needs to make $f(x)$ idempotent.", "hint": "##### For Sample 1:\nWe can change $a_1 = 4$, $a_4 = 4$, $a_5 = 4$. Since all $c_i$ equal one, the total cost is equal to $3$, the number of changes. It can be shown that there is no solution with only $2$ or fewer changes.  \n\n##### For Sample 2:\nWe change $a_3 = 3$ and $a_4 = 4$. The total cost is $2+5=7$.  \n\n\n#### SCORING:\nSubtasks: \n- Input 3: $N\\le 20$\n- Inputs 4-9: $a_i\\ge i$\n- Inputs 10-15: All $a_i$ are distinct.\n- Inputs 16-21: No additional constraints.  \n\nAdditionally, in each of the last three subtasks, the first half of tests  will satisfy $c_i=1$ for all $i$.", "locale": "en"}, "zh-CN": {"title": "[USACO25FEB] Bessie's Function G", "background": "", "description": "Bessie 有一个特别的函数 $f(x)$，接收一个 $[1, N]$ 内的整数作为输入，并返回一个 $[1, N]$ 内的整数（$1 \\le N \\le 2 \\cdot 10^5$）。她的函数 $f(x)$ 由 $N$ 个整数 $a_1 \\ldots a_N$ 定义，其中 $f(x) = a_x$（$1 \\le a_i \\le N$）。\n\nBessie 希望这个函数是幂等的。换句话说，它应当对于所有整数 $x \\in [1, N]$ 满足 $f(f(x)) = f(x)$。\n\nBessie 可以以代价 $c_i$ 将 $a_i$ 的值修改为 $[1, N]$ 内的任意整数（$1 \\le c_i \\le 10^9$）。求 Bessie 使 $f(x)$ 变为幂等所需要的最小总代价。", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个空格分隔的整数 $a_1,a_2,\\dots,a_N$。\n\n第三行包含 $N$ 个空格分隔的整数 $c_1,c_2,\\dots,c_N$。", "outputFormat": "输出 Bessie 使 $f(x)$ 变为幂等所需要的最小总代价。\n", "hint": "样例 1 解释：\n\n我们可以修改 $a_1 = 4$，$a_4 = 4$，$a_5 = 4$。由于所有 $c_i$ 均等于 $1$，所以总代价等于 $3$，即修改的数量。可以证明，不存在仅进行 $2$ 次或更少修改的解。\n\n样例 2 解释：\n\n我们修改 $a_3 = 3$ 以及 $a_4 = 4$。总代价为 $2+5=7$。\n\n- 测试点 $3$: $N \\le 20$。\n- 测试点 $4\\sim 9$: $a_i \\ge i$。\n- 测试点 $10\\sim 15$: 所有 $a_i$ 各不相同。\n- 测试点 $16\\sim 21$: 没有额外限制。\n\n除此之外，在后三个子任务中，前一半的测试点将满足对于所有 $i$ 有 $c_i=1$。\n", "locale": "zh-CN"}}}
{"pid": "P11843", "type": "P", "difficulty": 5, "samples": [["5 3 9\n1 5\n2 4\n3 3\n1 5 5\n1 5 4\n1 5 3\n1 5 2\n1 5 1\n2 5 4\n2 5 3\n2 5 2\n2 5 1", "21\n13\n7\n3\n1\n5\n5\n3\n1"], ["9 1 1\n7 9\n1 8 8\n", "3"], ["30 1 1\n1 30\n1 30 30", "73741816"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025"], "title": "[USACO25FEB] The Best Subsequence G", "background": "", "description": "Farmer John 有一个长为 $N$ 的位串（$1 \\leq N \\leq 10^9$），初始时全部为零。\n\n他将首先按顺序对字符串执行 $M$ 次更新（$1 \\leq M \\leq 2 \\cdot 10^5$）。每次更新会翻转从 $l$ 到 $r$ 的每个字符。具体地说，翻转一个字符会将其从 $0$ 变为 $1$，或反之。\n\n然后，他会进行 $Q$ 次查询（$1 \\leq Q \\leq 2 \\cdot 10^5$）。对于每个查询，他要求你输出由从 $l$ 到 $r$ 的子串中的字符组成的长为 $k$ 的字典序最大子序列。如果你的答案是一个位串 $s_1s_2 \\dots s_k$，则输出 $\\sum_{i=0}^{k-1} 2^i \\cdot s_{k-i}$（即将其解释为二进制数时的值）模 $10^9+7$ 的余数。\n\n一个字符串的子序列是可以从中通过删除一些或不删除字符而不改变余下字符的顺序得到的字符串。\n\n我们知道，字符串 $A$ 的字典序大于长度相等的字符串 $B$，当且仅当在第一个 $A_i \\neq B_i$ 的位置 $i$ 上（如果存在），我们有 $A_i > B_i$。", "inputFormat": "输入的第一行包含 $N$，$M$ 和 $Q$。\n\n以下 $M$ 行，每行包含两个整数 $l$ 和 $r$（$1 \\leq l \\leq r \\leq N$），为每次更新的端点。\n\n以下 $Q$ 行，每行包含三个整数 $l$，$r$ 和 $k$（$1 \\leq l \\leq r \\leq N$，$1 \\leq k \\leq r - l + 1$），为每个查询的端点和子序列的长度。", "outputFormat": "输出 $Q$ 行。第 $i$ 行包含第 $i$ 个查询的答案。\n\n", "hint": "样例 1 解释：\n\n在执行 $M$ 次操作后，位串为 $10101$。\n\n对于第一个查询，长度为 $5$ 的子序列仅有一个，$10101$，其解释为 $1 \\cdot 2^4 + 0 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 1 \\cdot 2^0 = 21$。\n\n对于第二个查询，长度为 $4$ 的不同的子序列有 $5$ 个：$0101$，$1101$，$1001$，$1011$，$1010$。字典序最大的子序列为 $1101$，其解释为 $1 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 1\\cdot 2^0 = 13$。\n\n对于第三个查询，字典序最大的序列是 $111$，其解释为 $7$。\n\n样例 3 解释：\n\n确保输出答案对 $10^9+7$ 取模。\n\n\n- 测试点 $4$：$N \\leq 10, Q \\leq 1000$。\n- 测试点 $5$：$M \\leq 10$。\n- 测试点 $6\\sim 7$：$N, Q \\leq 1000$。\n- 测试点 $8\\sim 12$：$N \\leq 2 \\cdot 10^5$。\n- 测试点 $13\\sim 20$：没有额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25FEB] The Best Subsequence G", "background": null, "description": "Farmer John has a binary string of length $N$ $(1 \\leq N \\leq 10^9)$, initially all zeros.  \n\nHe will first perform $M$ ($1 \\leq M \\leq 2 \\cdot 10^5$) updates on the string, in order.  Each update flips every character from $l$ to $r$. Specifically, flipping a character changes it from $0$ to $1$, or vice versa.  \n\nThen, he asks you $Q$ ($1 \\leq Q \\leq 2 \\cdot 10^5$) queries. For each query, he asks you to output the lexicographically greatest subsequence of length $k$ comprised of characters from the substring from $l$ to $r$. If your answer is a binary string $s_1s_2 \\dots s_k$, then output $\\sum_{i=0}^{k-1} 2^i \\cdot s_{k-i}$ (that is, its value when interpreted as a binary number) modulo $10^9+7$.  \n\nA subsequence is a string that can be derived from another string by deleting some or no characters without changing the order of the remaining characters.   \n\nRecall that string $A$ is lexicographically greater than string $B$ of equal length if and only if at the first position $i$, if it exists, where $A_i \\neq B_i$, we have $A_i > B_i$.", "inputFormat": "The first line contains $N$, $M$, and $Q$.\n\nThe next $M$ lines contain two integers, $l$ and $r$ ($1 \\leq l \\leq r \\leq N$) — the endpoints of each update.  \n\nThe next $Q$ lines contain three integers, $l$, $r$, and $k$ ($1 \\leq l \\leq r \\leq N, 1 \\leq k \\leq r - l + 1$) — the endpoints of each query and the length of the subsequence.", "outputFormat": "Output $Q$ lines. The $i$th line should contain the answer for the $i$th query.", "hint": "##### For Sample 1:\nAfter performing the $M$ operations, the string is $10101$.  \n\nFor the first query, there is only one subsequence of length $5$, $10101$, which is interpreted as $1 \\cdot 2^4 + 0 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 1 \\cdot 2^0 = 21$.  \n\nFor the second query, there are $5$ unique subsequences of length $4$: $0101$, $1101$, $1001$, $1011$, $1010$. The lexicographically largest subsequence is $1101$, which is interpreted as $1 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 1\\cdot 2^0 = 13$.  \n\nFor the third query, the lexicographically largest sequence is $111$, which is interpreted as $7$.  \n\n##### For Sample 3:\nMake sure to output the answer modulo $10^9+7$.  \n\n\n#### SCORING:\n\n-  Input 4: $N \\leq 10, Q \\leq 1000$ \n-  Input 5: $M \\leq 10$ \n-  Inputs 6-7: $N, Q \\leq 1000$ \n-  Inputs 8-12: $N \\leq 2 \\cdot 10^5$ \n-  Inputs 13-20: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25FEB] The Best Subsequence G", "background": "", "description": "Farmer John 有一个长为 $N$ 的位串（$1 \\leq N \\leq 10^9$），初始时全部为零。\n\n他将首先按顺序对字符串执行 $M$ 次更新（$1 \\leq M \\leq 2 \\cdot 10^5$）。每次更新会翻转从 $l$ 到 $r$ 的每个字符。具体地说，翻转一个字符会将其从 $0$ 变为 $1$，或反之。\n\n然后，他会进行 $Q$ 次查询（$1 \\leq Q \\leq 2 \\cdot 10^5$）。对于每个查询，他要求你输出由从 $l$ 到 $r$ 的子串中的字符组成的长为 $k$ 的字典序最大子序列。如果你的答案是一个位串 $s_1s_2 \\dots s_k$，则输出 $\\sum_{i=0}^{k-1} 2^i \\cdot s_{k-i}$（即将其解释为二进制数时的值）模 $10^9+7$ 的余数。\n\n一个字符串的子序列是可以从中通过删除一些或不删除字符而不改变余下字符的顺序得到的字符串。\n\n我们知道，字符串 $A$ 的字典序大于长度相等的字符串 $B$，当且仅当在第一个 $A_i \\neq B_i$ 的位置 $i$ 上（如果存在），我们有 $A_i > B_i$。", "inputFormat": "输入的第一行包含 $N$，$M$ 和 $Q$。\n\n以下 $M$ 行，每行包含两个整数 $l$ 和 $r$（$1 \\leq l \\leq r \\leq N$），为每次更新的端点。\n\n以下 $Q$ 行，每行包含三个整数 $l$，$r$ 和 $k$（$1 \\leq l \\leq r \\leq N$，$1 \\leq k \\leq r - l + 1$），为每个查询的端点和子序列的长度。", "outputFormat": "输出 $Q$ 行。第 $i$ 行包含第 $i$ 个查询的答案。\n\n", "hint": "样例 1 解释：\n\n在执行 $M$ 次操作后，位串为 $10101$。\n\n对于第一个查询，长度为 $5$ 的子序列仅有一个，$10101$，其解释为 $1 \\cdot 2^4 + 0 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 1 \\cdot 2^0 = 21$。\n\n对于第二个查询，长度为 $4$ 的不同的子序列有 $5$ 个：$0101$，$1101$，$1001$，$1011$，$1010$。字典序最大的子序列为 $1101$，其解释为 $1 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 1\\cdot 2^0 = 13$。\n\n对于第三个查询，字典序最大的序列是 $111$，其解释为 $7$。\n\n样例 3 解释：\n\n确保输出答案对 $10^9+7$ 取模。\n\n\n- 测试点 $4$：$N \\leq 10, Q \\leq 1000$。\n- 测试点 $5$：$M \\leq 10$。\n- 测试点 $6\\sim 7$：$N, Q \\leq 1000$。\n- 测试点 $8\\sim 12$：$N \\leq 2 \\cdot 10^5$。\n- 测试点 $13\\sim 20$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P11844", "type": "P", "difficulty": 6, "samples": [["3 1\n1 2", "1"], ["3 2\n1 2\n2 3", "0"], ["4 4\n1 2\n1 3\n1 4\n2 3", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025", "状压 DP"], "title": "[USACO25FEB] Friendship Editing G", "background": "", "description": "Farmer John 的 $N$ 头奶牛编号为 $1$ 到 $N$（$2\\le N\\le 16$）。奶牛之间的朋友关系可以建模为一个有 $M$（$0\\le M\\le N(N-1)/2$）条边的无向图。两头奶牛为朋友当且仅当图中她们之间存在一条边。\n\n在一次操作中，你可以添加或删除图中的一条边。计算确保以下性质成立所需的最小操作次数：如果奶牛 $a$ 和 $b$ 是朋友，则对于每头其他奶牛 $c$，$a$ 和 $b$ 中至少之一与 $c$ 是朋友。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。\n\n以下 $M$ 行，每行包含一对朋友 $a$ 和 $b$（$1\\le a<b\\le N$）。每对朋友出现至多一次。", "outputFormat": "输出你需要增加或删除的边的数量。\n", "hint": "样例 1 解释：\n\n该网络不符合性质。我们可以添加边 $(2,3)$ 或 $(1,3)$，或删除边 $(1,2)$ 进行修复。\n\n样例 2 解释：\n\n不需要进行任何修改。\n\n- 测试点 $4\\sim 13$：对于每一个 $N\\in [6, 15]$ 依次有一个测试点。\n- 测试点 $14\\sim 18$：$N=16$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25FEB] Friendship Editing G", "background": null, "description": "Farmer John's $N$ cows are labeled $1$ to $N$ ($2\\le N\\le 16$). The friendship relationships between the cows can be modeled as an undirected graph with $M$ ($0\\le M\\le N(N-1)/2$) edges. Two cows are friends if and only if there is an edge between them in the graph.  \n\nIn one operation, you can add or remove a single edge from the graph. Count the minimum number of operations required to ensure that the following property holds: If cows $a$ and $b$ are friends, then for every other cow $c$, at least one of $a$ and $b$ is friends with $c$.", "inputFormat": "The first line contains $N$ and $M$.  \n\nThe next $M$ lines each contain a pair of friends $a$ and $b$ ($1\\le a<b\\le N$). No pair of friends appears more than once.", "outputFormat": "The number of edges you need to add or remove.", "hint": "##### For Sample 1:\nThe network violates the property. We can add one of edges $(2,3)$ or $(1,3)$,  or remove edge $(1,2)$ to fix this.  \n\n##### For Sample 2:\nNo changes are necessary.  \n\n#### SCORING:\n- Inputs 4-13: One input for each $N\\in [6, 15]$ in increasing order.\n- Inputs 14-18: $N=16$", "locale": "en"}, "zh-CN": {"title": "[USACO25FEB] Friendship Editing G", "background": "", "description": "Farmer John 的 $N$ 头奶牛编号为 $1$ 到 $N$（$2\\le N\\le 16$）。奶牛之间的朋友关系可以建模为一个有 $M$（$0\\le M\\le N(N-1)/2$）条边的无向图。两头奶牛为朋友当且仅当图中她们之间存在一条边。\n\n在一次操作中，你可以添加或删除图中的一条边。计算确保以下性质成立所需的最小操作次数：如果奶牛 $a$ 和 $b$ 是朋友，则对于每头其他奶牛 $c$，$a$ 和 $b$ 中至少之一与 $c$ 是朋友。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。\n\n以下 $M$ 行，每行包含一对朋友 $a$ 和 $b$（$1\\le a<b\\le N$）。每对朋友出现至多一次。", "outputFormat": "输出你需要增加或删除的边的数量。\n", "hint": "样例 1 解释：\n\n该网络不符合性质。我们可以添加边 $(2,3)$ 或 $(1,3)$，或删除边 $(1,2)$ 进行修复。\n\n样例 2 解释：\n\n不需要进行任何修改。\n\n- 测试点 $4\\sim 13$：对于每一个 $N\\in [6, 15]$ 依次有一个测试点。\n- 测试点 $14\\sim 18$：$N=16$。", "locale": "zh-CN"}}}
{"pid": "P11845", "type": "P", "difficulty": 6, "samples": [["2\n2 1", "4"], ["3\n3 1 3", "12"], ["4\n2 4 1 3", "22"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "USACO", "2025", "分类讨论", "单调栈"], "title": "[USACO25FEB] Min Max Subarrays P", "background": "", "description": "**注意：本题的时间限制为 3 秒，通常限制的 1.5 倍。**\n\n给定一个长为 $N$ 的整数数组 $a_1,a_2,\\dots,a_N$（$2\\le N \\le 10^6$，$1\\le a_i\\le N$)。输出所有 $N(N+1)/2$ 个 $a$ 的连续子数组的以下子问题的答案之和。\n\n给定一个非空整数列表，交替执行以下操作（从第一个操作开始）直到列表大小恰好为一。\n\n1. 将列表内的两个相邻整数替换为它们的较小值。\n1. 将列表内的两个相邻整数替换为它们的较大值。\n\n求最终余下的整数的最大可能值。\n\n例如，\n\n$[4, 10, 3] \\to [4, 3] \\to [4]$\n\n$[3, 4, 10] \\to [3, 10] \\to [10]$\n\n在第一个数组中，$(10, 3)$ 被替换为 $\\min(10, 3)=3$，随后 $(4, 3)$ 被替换为 $\\max(4, 3)=4$。\n", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $a_1,a_2,\\dots,a_N$。", "outputFormat": "输出所有连续子数组的子问题的答案之和。\n", "hint": "样例 1 解释：\n\n对于 $[2]$ 答案为 $2$，对于 $[1]$ 答案为 $1$，对于 $[2, 1]$ 答案为 $1$。\n\n因此，我们的输出应当为 $2+1+1 = 4$。\n\n样例 3 解释：\n\n考虑子数组 $[2, 4, 1, 3]$。\n\n\n1. 在 $(1, 3)$ 上应用第一次操作，我们的新数组是 $[2, 4, 1]$。\n1. 在 $(4, 1)$ 上应用第二次操作，我们的新数组是 $[2, 4]$。\n1. 在 $(2, 4)$ 上应用第三次操作，我们最终的数是 $2$。\n\n可以证明 $2$ 是最终的数的最大可能值。\n\n- 测试点 $4\\sim 5$：$N\\le 100$。\n- 测试点 $6\\sim 7$：$N\\le 5000$。\n- 测试点 $8\\sim 9$：$\\max(a)\\le 10$。\n- 测试点 $10\\sim 13$：没有额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25FEB] Min Max Subarrays P", "background": null, "description": "****Note: The time limit for this problem is 3s, 1.5x the default.****  \n\nYou are given a length-$N$ integer array $a_1,a_2,\\dots,a_N$ ($2\\le N\\le 10^6, 1\\le a_i\\le N$). Output the sum of the answers for the subproblem below over all $N(N+1)/2$ contiguous subarrays of $a$.  \n\nGiven a nonempty list of integers, alternate the following operations (starting with the first operation) until the list has size exactly one.  \n\n\n1. Replace two consecutive integers in the list with their minimum.\n2. Replace two consecutive integers in the list with their maximum.  \n\nDetermine the maximum possible value of the final remaining integer.  \n\nFor example,  \n\n```\n[4, 10, 3] -> [4, 3] -> [4]\n[3, 4, 10] -> [3, 10] -> [10]\n```\n  \n\nIn the first array, $(10, 3)$ is replaced by $\\min(10, 3)=3$ and $(4, 3)$ is replaced by $\\max(4, 3)=4$.", "inputFormat": "The first line contains $N$.  \n\nThe second line contains $a_1,a_2,\\dots,a_N$.", "outputFormat": "The sum of the answer to the subproblem over all subarrays.", "hint": "##### For Sample 1:\nThe answer for $[2]$ is $2$, the answer for $[1]$ is $1$, and the answer for $[2, 1]$ is $1$.   \n\nThus, our output should be $2+1+1 = 4$.   \n\n##### For Sample 3:\nConsider the subarray $[2, 4, 1, 3]$.   \n\n1.  Applying the first operation on (1, 3), our new array is $[2, 4, 1]$. \n2.  Applying the second operation on (4, 1), our new array is $[2, 4]$. \n3.  Applying the third operation on (2, 4), our final number is $2$.   \n\nIt can be proven that $2$ is the maximum possible value of the final number.   \n\n\n#### SCORING:\n- Inputs 4-5: $N\\le 100$\n- Inputs 6-7: $N\\le 5000$\n- Inputs 8-9: $\\max(a)\\le 10$\n- Inputs 10-13: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25FEB] Min Max Subarrays P", "background": "", "description": "**注意：本题的时间限制为 3 秒，通常限制的 1.5 倍。**\n\n给定一个长为 $N$ 的整数数组 $a_1,a_2,\\dots,a_N$（$2\\le N \\le 10^6$，$1\\le a_i\\le N$)。输出所有 $N(N+1)/2$ 个 $a$ 的连续子数组的以下子问题的答案之和。\n\n给定一个非空整数列表，交替执行以下操作（从第一个操作开始）直到列表大小恰好为一。\n\n1. 将列表内的两个相邻整数替换为它们的较小值。\n1. 将列表内的两个相邻整数替换为它们的较大值。\n\n求最终余下的整数的最大可能值。\n\n例如，\n\n$[4, 10, 3] \\to [4, 3] \\to [4]$\n\n$[3, 4, 10] \\to [3, 10] \\to [10]$\n\n在第一个数组中，$(10, 3)$ 被替换为 $\\min(10, 3)=3$，随后 $(4, 3)$ 被替换为 $\\max(4, 3)=4$。\n", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $a_1,a_2,\\dots,a_N$。", "outputFormat": "输出所有连续子数组的子问题的答案之和。\n", "hint": "样例 1 解释：\n\n对于 $[2]$ 答案为 $2$，对于 $[1]$ 答案为 $1$，对于 $[2, 1]$ 答案为 $1$。\n\n因此，我们的输出应当为 $2+1+1 = 4$。\n\n样例 3 解释：\n\n考虑子数组 $[2, 4, 1, 3]$。\n\n\n1. 在 $(1, 3)$ 上应用第一次操作，我们的新数组是 $[2, 4, 1]$。\n1. 在 $(4, 1)$ 上应用第二次操作，我们的新数组是 $[2, 4]$。\n1. 在 $(2, 4)$ 上应用第三次操作，我们最终的数是 $2$。\n\n可以证明 $2$ 是最终的数的最大可能值。\n\n- 测试点 $4\\sim 5$：$N\\le 100$。\n- 测试点 $6\\sim 7$：$N\\le 5000$。\n- 测试点 $8\\sim 9$：$\\max(a)\\le 10$。\n- 测试点 $10\\sim 13$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P11846", "type": "P", "difficulty": 7, "samples": [["4\n5 -3 -1 -3\n5 3 5 2\n5 3 8 19\n5 3 5 3", "2\n-1\n3\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "USACO", "2025", "最大公约数 gcd", "分类讨论"], "title": "[USACO25FEB] Transforming Pairs P", "background": "", "description": "回答 $Q$（$1\\le Q\\le 10^5$）个独立查询，每个查询的形式如下：\n\n给定四个整数 $a$，$b$，$c$，$d$（$-10^{18}\\le a,b,c,d\\le 10^{18}$）。在一次操作中，你可以执行 $a\\mathrel{+}=b$，或 $b\\mathrel{+}=a$。求将 $(a,b)$ 转变为 $(c,d)$ 所需要的最小操作次数，或者如果不可能完成，输出 $-1$。", "inputFormat": "输入的第一行包含 $Q$。\n\n以下 $Q$ 行，每行包含四个整数 $a$，$b$，$c$，$d$。", "outputFormat": "每行输出一个查询的答案。\n", "hint": "样例 1 解释：\n\n第一个查询：$(5,-3)\\to (2,-3)\\to (-1,-3)$。\n\n第二个查询：不可能。\n\n第三个查询：$(5,3) \\to (8, 3) \\to (8, 11) \\to (8, 19)$。\n\n第四个查询：不需要任何操作。\n\n\n- 测试点 $2$：$|a|, |b|, |c|,|d|\\le 10$。\n- 测试点 $3$：$a,b\\ge 0$。\n- 测试点 $4$：$a \\geq 0 \\geq b$。\n- 测试点 $5$：$a \\leq 0 \\leq b$。\n- 测试点 $6$：$a,b\\le 0$。\n- 测试点 $7$：$c,d\\ge 0$。\n- 测试点 $8$：$c \\geq 0 \\geq d$。\n- 测试点 $9$：$c \\leq 0 \\leq d$。\n- 测试点 $10$：$c,d\\le 0$。\n- 测试点 $11\\sim 14$：$Q \\leq 10^3$。\n- 测试点 $15\\sim 19$：没有额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25FEB] Transforming Pairs P", "background": null, "description": "Answer $Q$ ($1\\le Q\\le 10^5$) independent queries each of the following form:  \n\nYou are given four integers $a,b,c,d$ ($-10^{18}\\le a,b,c,d\\le 10^{18}$). In one operation you can either do $a\\mathrel{+}=b$,  or $b\\mathrel{+}=a$. Determine the minimum number of operations to transform $(a,b)$ into $(c,d)$, or if it is impossible to do so, output $-1$.", "inputFormat": "The first line contains $Q$.  \n\nThe next $Q$ lines each contain four integers $a,b,c,d$.", "outputFormat": "The answer for each query on a separate line.", "hint": "First query: $(5,-3)\\to (2,-3)\\to (-1,-3)$  \n\nSecond query: Impossible.  \n\nThird query: $(5,3) \\to (8, 3) \\to (8, 11) \\to (8, 19)$  \n\nFourth query: No operations necessary.  \n\n\n#### SCORING:\n- Input 2: $|a|, |b|, |c|,|d|\\le 10$\n- Input 3: $a,b\\ge 0$\n- Input 4: $a \\geq 0 \\geq b$\n- Input 5: $a \\leq 0 \\leq b$\n- Input 6: $a,b\\le 0$\n- Input 7: $c,d\\ge 0$\n- Input 8: $c \\geq 0 \\geq d$\n- Input 9: $c \\leq 0 \\leq d$\n- Input 10: $c,d\\le 0$\n- Inputs 11-14: $Q \\leq 10^3$\n- Inputs 15-19: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25FEB] Transforming Pairs P", "background": "", "description": "回答 $Q$（$1\\le Q\\le 10^5$）个独立查询，每个查询的形式如下：\n\n给定四个整数 $a$，$b$，$c$，$d$（$-10^{18}\\le a,b,c,d\\le 10^{18}$）。在一次操作中，你可以执行 $a\\mathrel{+}=b$，或 $b\\mathrel{+}=a$。求将 $(a,b)$ 转变为 $(c,d)$ 所需要的最小操作次数，或者如果不可能完成，输出 $-1$。", "inputFormat": "输入的第一行包含 $Q$。\n\n以下 $Q$ 行，每行包含四个整数 $a$，$b$，$c$，$d$。", "outputFormat": "每行输出一个查询的答案。\n", "hint": "样例 1 解释：\n\n第一个查询：$(5,-3)\\to (2,-3)\\to (-1,-3)$。\n\n第二个查询：不可能。\n\n第三个查询：$(5,3) \\to (8, 3) \\to (8, 11) \\to (8, 19)$。\n\n第四个查询：不需要任何操作。\n\n\n- 测试点 $2$：$|a|, |b|, |c|,|d|\\le 10$。\n- 测试点 $3$：$a,b\\ge 0$。\n- 测试点 $4$：$a \\geq 0 \\geq b$。\n- 测试点 $5$：$a \\leq 0 \\leq b$。\n- 测试点 $6$：$a,b\\le 0$。\n- 测试点 $7$：$c,d\\ge 0$。\n- 测试点 $8$：$c \\geq 0 \\geq d$。\n- 测试点 $9$：$c \\leq 0 \\leq d$。\n- 测试点 $10$：$c,d\\le 0$。\n- 测试点 $11\\sim 14$：$Q \\leq 10^3$。\n- 测试点 $15\\sim 19$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P11847", "type": "P", "difficulty": 6, "samples": [["2 3\n3 1\n4 2\n2\n1\n0", "-3\n1\n7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "USACO", "2025", "决策单调性"], "title": "[USACO25FEB] True or False Test P", "background": "", "description": "**注意：本题的时间限制为 3 秒，通常限制的 1.5 倍。本题的内存限制为 512MB，通常限制的 2 倍。**\n\nBessie 正在参加一场 $N$ 道判断题的考试（$1\\le N\\le 2\\cdot 10^5$）。对于第 $i$ 道题目，如果她答对了将获得 $a_i$ 分，如果答错了将失去 $b_i$ 分，如果不回答则分数不变（$0<a_i,b_i\\le 10^9$）。\n\n因为 Bessie 是一头聪明的牛，她知道所有的答案，但她担心 Elsie（主考官）会在测试后追溯性地更改至多 $k$ 道题目，使得 Bessie 无法答对这些题目。\n\n给定 $Q$（$1\\le Q\\le N+1$）个 $k$ 的候选值（$0\\le k\\le N$），求对于每一个 $k$，Bessie 在回答至少 $k$ 道题目的前提下可以保证的分数。", "inputFormat": "输入的第一行包含 $N$ 和 $Q$。\n\n以下 $N$ 行每行包含 $a_i$ 和 $b_i$。\n\n以下 $Q$ 行每行包含一个 $k$ 的值。每个 $k$ 的值出现至多一次。", "outputFormat": "对于每一个 $k$ 输出一行，包含对于该值的答案。\n", "hint": "样例 1 解释：\n\n对于每一个 $k$ 的值，Bessie 的最优策略都是回答所有的题目。\n\n- 测试点 $2\\sim 4$：$N\\le 100$。\n- 测试点 $5\\sim 7$：$Q\\le 10$，$N\\le 2\\cdot 10^5$。\n- 测试点 $7\\sim 20$：没有额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25FEB] True or False Test P", "background": null, "description": "****Note: The time limit for this problem is 3s, 1.5x the default. The memory limit for this problem is 512MB, twice the default.****\n\nBessie is taking an $N$-question true or false test ($1\\le N\\le 2\\cdot 10^5$). For the $i$-th question, she will gain $a_i$ points if she gets it correct, lose $b_i$ points if she gets it incorrect, or remain even if she does not answer it ($0<a_i,b_i\\le 10^9$).  \n\nBessie knows all the answers because she is a smart cow, but worries that Elsie (who is administering the test) will retroactively change up to $k$ of the questions after the test such that Bessie does not get those questions correct.  \n\nGiven $Q$ ($1\\le Q\\le N+1$) candidate values of $k$ ($0\\le k\\le N$), determine the number of points Bessie can guarantee for each $k$, given that she must answer at least $k$ questions.", "inputFormat": "The first line contains $N$ and $Q$.  \n\nThe next $N$ lines each contain $a_i$ and $b_i$.  \n\nThe next $Q$ lines each contain a value of $k$. No value of $k$ appears more than once.", "outputFormat": "The answer for each $k$ on a separate line.", "hint": "For each value of $k$, it is optimal for Bessie to answer all of the questions.  \n\n#### SCORING:\n- Inputs 2-4: $N\\le 100$\n- Inputs 5-7: $Q\\le 10$, $N\\le 2\\cdot 10^5$\n- Inputs 7-20: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25FEB] True or False Test P", "background": "", "description": "**注意：本题的时间限制为 3 秒，通常限制的 1.5 倍。本题的内存限制为 512MB，通常限制的 2 倍。**\n\nBessie 正在参加一场 $N$ 道判断题的考试（$1\\le N\\le 2\\cdot 10^5$）。对于第 $i$ 道题目，如果她答对了将获得 $a_i$ 分，如果答错了将失去 $b_i$ 分，如果不回答则分数不变（$0<a_i,b_i\\le 10^9$）。\n\n因为 Bessie 是一头聪明的牛，她知道所有的答案，但她担心 Elsie（主考官）会在测试后追溯性地更改至多 $k$ 道题目，使得 Bessie 无法答对这些题目。\n\n给定 $Q$（$1\\le Q\\le N+1$）个 $k$ 的候选值（$0\\le k\\le N$），求对于每一个 $k$，Bessie 在回答至少 $k$ 道题目的前提下可以保证的分数。", "inputFormat": "输入的第一行包含 $N$ 和 $Q$。\n\n以下 $N$ 行每行包含 $a_i$ 和 $b_i$。\n\n以下 $Q$ 行每行包含一个 $k$ 的值。每个 $k$ 的值出现至多一次。", "outputFormat": "对于每一个 $k$ 输出一行，包含对于该值的答案。\n", "hint": "样例 1 解释：\n\n对于每一个 $k$ 的值，Bessie 的最优策略都是回答所有的题目。\n\n- 测试点 $2\\sim 4$：$N\\le 100$。\n- 测试点 $5\\sim 7$：$Q\\le 10$，$N\\le 2\\cdot 10^5$。\n- 测试点 $7\\sim 20$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P11848", "type": "P", "difficulty": 2, "samples": [["3 3\n2 0 11000\n5 0 12000\n3 3 10000\n1 3\n3 0\n5 3", "1\n3\n2"], ["4 2\n2 -2 10000\n-2 1 12000\n1 -3 12000\n4 5 19000\n1 5\n4 1", "4\n1\n2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "排序", "台湾"], "title": "[TOIP 2023] 房屋推薦", "background": "", "description": "房屋仲介小潮負責高談市的租房業務。小潮手上有編號為 $1, 2, \\cdots, n$ 的 $n$ 間待租的房屋，房屋 $i$ 的位置可以用二維座標 $(a_i, b_i)$ 表示，並且此房屋的月租金為 $r_i$ 元。\n\n高談市有 $m$ 座捷運站，捷運站的編號為 $1, 2, \\cdots, m$，捷運站 $j$ 的位置在二維平面以座標 $(c_j, d_j)$ 表示。定義房屋 $i$ 與捷運站 $j$ 的距離為 $\\sqrt{(a_i - c_j)^2 + (b_i - d_j)^2}$ 單位。\n\n小潮發現租客的喜好如下：\n\n1. 房屋與最近的捷運站的距離越短越好。\n2. 如果兩間房屋和彼此最近的捷運站距離一樣近，月租金越小的房屋越好。\n3. 如果兩間房屋和彼此最近的捷運站距離一樣近，而且月租金相同，房屋編號越小的越好。\n\n請幫忙小潮開發一個房屋推薦系統，對房屋們進行排序，使得越是得到租客喜愛的房屋排在越前面。\n\n如下圖為一 $n=3$ 且 $m=3$ 的例子，其中正方形的點 $H_1, H_2, H_3$ 分別代表房屋 $1, 2, 3$，圓點 $S_1, S_2, S_3$ 則分別代表捷運站 $1, 2, 3$ 的位置。並且：\n\n- 第 $1$ 間房屋位在 $(2, 0)$，月租金為 $11000$ 元。\n- 第 $2$ 間房屋位在 $(5, 0)$，月租金為 $12000$ 元。\n- 第 $3$ 間房屋位在 $(3, 3)$，月租金為 $10000$ 元。\n- 第 $1$ 座捷運站位在 $(1, 3)$。\n- 第 $2$ 座捷運站位在 $(3, 0)$。\n- 第 $3$ 座捷運站位在 $(5, 3)$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5j17sbyi.png)\n\n可以算出：\n\n- 和第 $1$ 間房屋距離最短的捷運站為第 $2$ 座捷運站，距離為 $1$ 單位。\n- 和第 $2$ 間房屋距離最短的捷運站為第 $2$ 座捷運站，距離為 $2$ 單位。\n- 和第 $3$ 間房屋距離最短的捷運站為第 $1$ 座捷運站與第 $3$ 座捷運站，距離為 $2$ 單位。\n\n第 $2$ 間房屋和第 $3$ 間房屋和捷運站的距離都是 $2$ 單位，但是因為第 $3$ 間房屋的月租金較為便宜，所以排在第 $2$ 間房屋前面。因此租客喜好的房屋順序為：$1, 3, 2$。", "inputFormat": "> $n$ $m$  \n> $a_1$ $b_1$ $r_1$  \n> $a_2$ $b_2$ $r_2$  \n> $\\vdots$  \n> $a_n$ $b_n$ $r_n$  \n> $c_1$ $d_1$  \n> $c_2$ $d_2$  \n> $\\vdots$  \n> $c_m$ $d_m$\n\n* $n$, $m$ 分別代表房屋與捷運站的數量。\n* 房屋 $i$ 的座標在 $(a_i, b_i)$，且租金為 $r_i$。\n* 捷運站 $j$ 的座標為 $(c_j, d_j)$。", "outputFormat": "> $p_1$  \n> $p_2$  \n> $\\vdots$  \n> $p_n$\n\n* $p_i$ 為一整數，代表排名第 $i$ 名的房屋編號。", "hint": "### 測資限制\n\n* $1 \\le n \\le 10^5$。\n* $1 \\le m \\le 10^3$。\n* $-10^9 \\le a_i, b_i, c_i, d_i \\le 10^9$。\n* $0 \\le r_i \\le 10^9$\n* 上述變數皆為整數。\n* 任意一個座標最多只有一間房屋或一座捷運站，且不會有房屋和捷運站在同一座標。\n\n### 評分說明\n\n本題共有三組子任務，條件限制如下所示。\n每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----: | ------------ |\n| 1 | $20$ | $n \\le 2$ |\n| 2 | $30$ | $n \\le 100$ |\n| 3 | $50$ | 無額外限制 |", "locale": "zh-Hant", "translations": {"zh-CN": {"title": "[TOIP 2023] 房屋推荐", "background": "", "description": "房屋中介小潮负责高谈市的租房业务。小潮手中有编号为 $1, 2, \\cdots, n$ 的 $n$ 间待租房屋，房屋 $i$ 的位置用二维坐标 $(a_i, b_i)$ 表示，且该房屋的月租金为 $r_i$ 元。\n\n高谈市有 $m$ 座地铁站，地铁站编号为 $1, 2, \\cdots, m$，地铁站 $j$ 的位置用二维坐标 $(c_j, d_j)$ 表示。定义房屋 $i$ 与地铁站 $j$ 的距离为 $\\sqrt{(a_i - c_j)^2 + (b_i - d_j)^2}$ 单位。\n\n小潮发现租客的偏好如下：\n1. 房屋与最近地铁站的距离越短越好。\n2. 若两间房屋离各自最近地铁站的距离相同，则月租金较低的房屋更优。\n3. 若两间房屋离各自最近地铁站的距离相同且月租金相同，则编号较小的房屋更优。\n\n请帮助小潮开发一个房屋推荐系统，对房屋进行排序，使得越受租客偏好的房屋排名越靠前。\n\n下图为一个 $n=3$ 且 $m=3$ 的示例：\n- 方点 $H_1, H_2, H_3$ 分别代表房屋 $1, 2, 3$\n- 圆点 $S_1, S_2, S_3$ 分别代表地铁站 $1, 2, 3$\n- 房屋坐标与租金：\n  - 房屋 1：$(2, 0)$，租金 $11000$ 元\n  - 房屋 2：$(5, 0)$，租金 $12000$ 元  \n  - 房屋 3：$(3, 3)$，租金 $10000$ 元\n- 地铁站坐标：\n  - 地铁站 1：$(1, 3)$\n  - 地铁站 2：$(3, 0)$\n  - 地铁站 3：$(5, 3)$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5j17sbyi.png)\n\n计算得出：\n- 房屋 $1$ 最近地铁站为 $2$ 号站（距离 $1$ 单位）\n- 房屋 $2$ 最近地铁站为 $2$ 号站（距离 $2$ 单位）\n- 房屋 $3$ 最近地铁站为 $1$ 号站和 $3$ 号站（距离 $2$ 单位）\n\n第 $2$ 间房屋和第 $3$ 间房屋与地铁站的距离均为 $2$ 单位，但由于第 $3$ 间房屋的月租金更便宜，因此排在第 $2$ 间房屋前面。最终租客偏好的房屋顺序为：$1, 3, 2$。", "inputFormat": "> $n$ $m$  \n> $a_1$ $b_1$ $r_1$  \n> $a_2$ $b_2$ $r_2$  \n> $\\vdots$  \n> $a_n$ $b_n$ $r_n$  \n> $c_1$ $d_1$  \n> $c_2$ $d_2$  \n> $\\vdots$  \n> $c_m$ $d_m$\n\n* $n, m$ 分别表示房屋与地铁站的数量\n* 房屋 $i$ 的坐标为 $(a_i, b_i)$，租金为 $r_i$\n* 地铁站 $j$ 的坐标为 $(c_j, d_j)$", "outputFormat": "> $p_1$  \n> $p_2$  \n> $\\vdots$  \n> $p_n$\n\n* 输出按排名顺序的房屋编号", "hint": "### 测试数据限制\n\n- $1 \\le n \\le 10^5$\n- $1 \\le m \\le 10^3$\n- $-10^9 \\le a_i, b_i, c_i, d_i \\le 10^9$\n- $0 \\le r_i \\le 10^9$\n- 所有坐标为整数且互不重叠\n- 保证房屋与地铁站不在同一坐标\n\n### 评分规则\n\n| 子任务 | 分数 | 条件          |\n| :----: | :--: | ------------- |\n| 1      | 20   | $n \\le 2$     |\n| 2      | 30   | $n \\le 100$   |\n| 3      | 50   | 无额外限制    |", "locale": "zh-CN"}, "zh-Hant": {"title": "[TOIP 2023] 房屋推薦", "background": "", "description": "房屋仲介小潮負責高談市的租房業務。小潮手上有編號為 $1, 2, \\cdots, n$ 的 $n$ 間待租的房屋，房屋 $i$ 的位置可以用二維座標 $(a_i, b_i)$ 表示，並且此房屋的月租金為 $r_i$ 元。\n\n高談市有 $m$ 座捷運站，捷運站的編號為 $1, 2, \\cdots, m$，捷運站 $j$ 的位置在二維平面以座標 $(c_j, d_j)$ 表示。定義房屋 $i$ 與捷運站 $j$ 的距離為 $\\sqrt{(a_i - c_j)^2 + (b_i - d_j)^2}$ 單位。\n\n小潮發現租客的喜好如下：\n\n1. 房屋與最近的捷運站的距離越短越好。\n2. 如果兩間房屋和彼此最近的捷運站距離一樣近，月租金越小的房屋越好。\n3. 如果兩間房屋和彼此最近的捷運站距離一樣近，而且月租金相同，房屋編號越小的越好。\n\n請幫忙小潮開發一個房屋推薦系統，對房屋們進行排序，使得越是得到租客喜愛的房屋排在越前面。\n\n如下圖為一 $n=3$ 且 $m=3$ 的例子，其中正方形的點 $H_1, H_2, H_3$ 分別代表房屋 $1, 2, 3$，圓點 $S_1, S_2, S_3$ 則分別代表捷運站 $1, 2, 3$ 的位置。並且：\n\n- 第 $1$ 間房屋位在 $(2, 0)$，月租金為 $11000$ 元。\n- 第 $2$ 間房屋位在 $(5, 0)$，月租金為 $12000$ 元。\n- 第 $3$ 間房屋位在 $(3, 3)$，月租金為 $10000$ 元。\n- 第 $1$ 座捷運站位在 $(1, 3)$。\n- 第 $2$ 座捷運站位在 $(3, 0)$。\n- 第 $3$ 座捷運站位在 $(5, 3)$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5j17sbyi.png)\n\n可以算出：\n\n- 和第 $1$ 間房屋距離最短的捷運站為第 $2$ 座捷運站，距離為 $1$ 單位。\n- 和第 $2$ 間房屋距離最短的捷運站為第 $2$ 座捷運站，距離為 $2$ 單位。\n- 和第 $3$ 間房屋距離最短的捷運站為第 $1$ 座捷運站與第 $3$ 座捷運站，距離為 $2$ 單位。\n\n第 $2$ 間房屋和第 $3$ 間房屋和捷運站的距離都是 $2$ 單位，但是因為第 $3$ 間房屋的月租金較為便宜，所以排在第 $2$ 間房屋前面。因此租客喜好的房屋順序為：$1, 3, 2$。", "inputFormat": "> $n$ $m$  \n> $a_1$ $b_1$ $r_1$  \n> $a_2$ $b_2$ $r_2$  \n> $\\vdots$  \n> $a_n$ $b_n$ $r_n$  \n> $c_1$ $d_1$  \n> $c_2$ $d_2$  \n> $\\vdots$  \n> $c_m$ $d_m$\n\n* $n$, $m$ 分別代表房屋與捷運站的數量。\n* 房屋 $i$ 的座標在 $(a_i, b_i)$，且租金為 $r_i$。\n* 捷運站 $j$ 的座標為 $(c_j, d_j)$。", "outputFormat": "> $p_1$  \n> $p_2$  \n> $\\vdots$  \n> $p_n$\n\n* $p_i$ 為一整數，代表排名第 $i$ 名的房屋編號。", "hint": "### 測資限制\n\n* $1 \\le n \\le 10^5$。\n* $1 \\le m \\le 10^3$。\n* $-10^9 \\le a_i, b_i, c_i, d_i \\le 10^9$。\n* $0 \\le r_i \\le 10^9$\n* 上述變數皆為整數。\n* 任意一個座標最多只有一間房屋或一座捷運站，且不會有房屋和捷運站在同一座標。\n\n### 評分說明\n\n本題共有三組子任務，條件限制如下所示。\n每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----: | ------------ |\n| 1 | $20$ | $n \\le 2$ |\n| 2 | $30$ | $n \\le 100$ |\n| 3 | $50$ | 無額外限制 |", "locale": "zh-Hant"}}}
{"pid": "P11849", "type": "P", "difficulty": 4, "samples": [["3 4\n5 -2 3", "3\n2"], ["3 3\n5 -2 3", "3\n1"], ["9 45\n5 -1 2 -3 6 -9 7 3 2", "-9\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["二分", "2023", "双指针 two-pointer", "台湾"], "title": "[TOIP 2023] 裁員風暴", "background": "", "description": "孫執行長任職於美味蛋糕股份有限公司，因為今年財報不如預期股東寄了公開信呼應公司能刪減成本，孫執行長決定要讓公司一些夥伴走自己的路。\n\n孫執行長列出 $n$ 個公司目標，並請員工們各自從 $n$ 個公司目標挑 $1$ 個或 $2$ 個他們認為最重要的目標，做出相同選擇的員工會被分類到同一個**小組**。已知每種可能的目標組合都至少有一位員工選擇，可以計算出恰選擇 $1$ 個目標的小組有 $n$ 組，恰選擇 $2$ 個目標的小組有 $\\frac{n(n-1)}{2}$ 組，合計共有 $n + \\frac{n(n-1)}{2} = \\frac{n(n+1)}{2}$ 個小組。\n\n透過 AI 大數據分析，每個公司目標都被 AI 賦予一個權重，這裡用 $w_i$ 來表示第 $i$ 的公司目標的權重。並且我們可以用一個 $01$-序列 $y$ 序列：$y_1, y_2, \\cdots, y_n$ 來表示一個小組所選擇的目標，有選擇第 $i$ 個公司目標則 $y_i = 1$，否則 $y_i = 0$。AI 定義**裁指數**為：\n\n$$\\left( \\dfrac{\\displaystyle \\sum_{i=1}^{n}w_i\\times y_i}{\\displaystyle \\sum_{j=1}^{n} y_j} \\right)$$\n\n孫執行長決定把所有小組的裁指數排名，如果一個人所屬於**裁指數前 $k$ 大的小組**就予以開除。\n\n想請你幫忙孫執行長找出排序後第 $k$ 大的裁指數。\n\n例如：$n=3$ 而 $k=4$，$w_1=5, w_2=-2, w_3=3$，會有 $\\dfrac{3(3+1)}{2} = 6$ 個小組，每個小組的裁指數如下表 :\n\n|$y_1$|$y_2$|$y_3$|裁指數                 |\n|:---:|:---:|:---:|:------------------------------|\n| $0$ | $0$ | $1$ |$(0+0+3)/(0+0+1) =           3$|\n| $0$ | $1$ | $0$ |$(0-2+0)/(0+1+0) =          -2$|\n| $0$ | $1$ | $1$ |$(0-2+3)/(0+1+1) = \\frac{1}{2}$|\n| $1$ | $0$ | $0$ |$(5+0+0)/(1+0+0) =           5$|\n| $1$ | $0$ | $1$ |$(5+0+3)/(1+0+1) =           4$|\n| $1$ | $1$ | $0$ |$(5-2+0)/(1+1+0) = \\frac{3}{2}$|\n\n裁指數排序後為 $-2, \\frac{1}{2}, \\frac{3}{2}, 3, 4, 5$，並且第 $4$ 大為 $\\frac{3}{2}$。（備註：如果裁指數排名第 $k$ 大和第 $k+1$ 大的裁指數相等，那孫執行長會另外想方法決定裁員名單，不需替他擔心）", "inputFormat": "> $n$ $k$  \n> $w_1$ $w_2$ $\\cdots$ $w_n$\n\n* $n$ 代表公司目標數量。\n* $k$ 代表孫執行長的想知道的排名。\n* $w_i$ 代表第 $i$ 個公司目標的權重。", "outputFormat": "> $p$  \n> $q$\n\n* $\\dfrac{p}{q}$ 代表排序後第 $k$ 大的裁指數。\n* $p$ 必須為整數。\n* $q$ 必須為正整數。\n* $|p|$ 跟 $q$ 必須互質。", "hint": "### 測資限制\n\n* $1 \\le n \\le 2\\times 10^5$。\n* $1 \\le k \\le \\dfrac{n(n+1)}{2}$。\n* $-{10}^9 \\le w_i \\le {10}^9$。\n* $n, k, w_i$ 都是整數。\n\n### 評分說明\n\n本題共有六組子任務，條件限制如下所示。\n每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----------------: | ------------------------------------ |\n| 1        | $5$ | $n \\le 20$                           |\n| 2        | $5$ | $n \\le 10^4$ 且 $k \\le 2\\times 10^5$ |\n| 3        | $5$ | $n \\le 10^4$                         |\n| 4        | $40$ | $k \\le 2\\times 10^5$                 |\n| 5        | $14$ | $-100 \\le w_i \\le 100$               |\n| 6        | $31$ | 無額外限制                            |", "locale": "zh-Hant", "translations": {"zh-CN": {"title": "[TOIP 2023] 裁员风暴", "background": "", "description": "孙执行官任职于美味蛋糕股份有限公司，由于今年财报未达预期，股东寄了公开信呼吁公司削减成本，孙执行官决定让公司部分伙伴\"走自己的路\"。\n\n孙执行官列出 $n$ 个公司目标，并请员工们各自从 $n$ 个公司目标挑选 $1$ 个或 $2$ 个他们认为最重要的目标。做出相同选择的员工会被分类到同一个**小组**。已知每种可能的目标组合都至少有一位员工选择，可以计算出恰好选择 $1$ 个目标的小组有 $n$ 组，恰好选择 $2$ 个目标的小组有 $\\frac{n(n-1)}{2}$ 组，合计共有 $n + \\frac{n(n-1)}{2} = \\frac{n(n+1)}{2}$ 个小组。\n\n通过 AI 大数据分析，每个公司目标都被 AI 赋予一个权重，这里用 $w_i$ 表示第 $i$ 个公司目标的权重。我们可以用一个 $01$-序列 $y$：$y_1, y_2, \\cdots, y_n$ 来表示一个小组所选择的目标（选择第 $i$ 个目标则 $y_i = 1$，否则 $y_i = 0$）。AI 定义**裁减指数**为：\n\n$$\\left( \\dfrac{\\displaystyle \\sum_{i=1}^{n}w_i\\times y_i}{\\displaystyle \\sum_{j=1}^{n} y_j} \\right)$$\n\n孙执行官决定将所有小组的裁减指数排名，属于**裁减指数前 $k$ 大小组**的员工将被开除。\n\n请你帮助孙执行官找出排序后第 $k$ 大的裁减指数。\n\n例如：当 $n=3$，$k=4$，$w_1=5, w_2=-2, w_3=3$ 时，共有 $\\dfrac{3(3+1)}{2} = 6$ 个小组，各小组裁减指数如下表：\n\n|$y_1$|$y_2$|$y_3$|裁减指数               |\n|:---:|:---:|:---:|:---------------------|\n| $0$ | $0$ | $1$ |$(0+0+3)/(0+0+1) = 3$|\n| $0$ | $1$ | $0$ |$(0-2+0)/(0+1+0) =-2$|\n| $0$ | $1$ | $1$ |$(0-2+3)/(0+1+1)=0.5$|\n| $1$ | $0$ | $0$ |$(5+0+0)/(1+0+0) = 5$|\n| $1$ | $0$ | $1$ |$(5+0+3)/(1+0+1) = 4$|\n| $1$ | $1$ | $0$ |$(5-2+0)/(1+1+0)=1.5$|\n\n裁减指数排序后为 $-2, 0.5, 1.5, 3, 4, 5$，第 $4$ 大的值为 $1.5$。（备注：若第 $k$ 大与第 $k+1$ 大的裁减指数相同，孙执行官会另行决定裁员名单，不需要替他担心）", "inputFormat": "> $n$ $k$  \n> $w_1$ $w_2$ $\\cdots$ $w_n$\n\n* $n$ 表示公司目标数量\n* $k$ 表示需要查询的排名\n* $w_i$ 表示第 $i$ 个目标的权重", "outputFormat": "> $p$  \n> $q$\n\n* $\\dfrac{p}{q}$ 表示第 $k$ 大的裁减指数\n* $p$ 必须为整数\n* $q$ 必须为正整数\n* $|p|$ 与 $q$ 必须互质", "hint": "### 测试数据限制\n\n* $1 \\le n \\le 2\\times 10^5$\n* $1 \\le k \\le \\dfrac{n(n+1)}{2}$\n* $-{10}^9 \\le w_i \\le {10}^9$\n* 所有输入均为整数\n\n### 评分说明\n\n本题共有六个子任务，限制条件如下。每个子任务需通过全部测试数据方可得分。\n\n| 子任务 | 分数 | 额外限制                     |\n| :----: | :--: | --------------------------- |\n| 1      | 5    | $n \\le 20$                  |\n| 2      | 5    | $n \\le 10^4$ 且 $k \\le 2\\times 10^5$ |\n| 3      | 5    | $n \\le 10^4$                |\n| 4      | 40   | $k \\le 2\\times 10^5$        |\n| 5      | 14   | $-100 \\le w_i \\le 100$      |\n| 6      | 31   | 无额外限制                  |", "locale": "zh-CN"}, "zh-Hant": {"title": "[TOIP 2023] 裁員風暴", "background": "", "description": "孫執行長任職於美味蛋糕股份有限公司，因為今年財報不如預期股東寄了公開信呼應公司能刪減成本，孫執行長決定要讓公司一些夥伴走自己的路。\n\n孫執行長列出 $n$ 個公司目標，並請員工們各自從 $n$ 個公司目標挑 $1$ 個或 $2$ 個他們認為最重要的目標，做出相同選擇的員工會被分類到同一個**小組**。已知每種可能的目標組合都至少有一位員工選擇，可以計算出恰選擇 $1$ 個目標的小組有 $n$ 組，恰選擇 $2$ 個目標的小組有 $\\frac{n(n-1)}{2}$ 組，合計共有 $n + \\frac{n(n-1)}{2} = \\frac{n(n+1)}{2}$ 個小組。\n\n透過 AI 大數據分析，每個公司目標都被 AI 賦予一個權重，這裡用 $w_i$ 來表示第 $i$ 的公司目標的權重。並且我們可以用一個 $01$-序列 $y$ 序列：$y_1, y_2, \\cdots, y_n$ 來表示一個小組所選擇的目標，有選擇第 $i$ 個公司目標則 $y_i = 1$，否則 $y_i = 0$。AI 定義**裁指數**為：\n\n$$\\left( \\dfrac{\\displaystyle \\sum_{i=1}^{n}w_i\\times y_i}{\\displaystyle \\sum_{j=1}^{n} y_j} \\right)$$\n\n孫執行長決定把所有小組的裁指數排名，如果一個人所屬於**裁指數前 $k$ 大的小組**就予以開除。\n\n想請你幫忙孫執行長找出排序後第 $k$ 大的裁指數。\n\n例如：$n=3$ 而 $k=4$，$w_1=5, w_2=-2, w_3=3$，會有 $\\dfrac{3(3+1)}{2} = 6$ 個小組，每個小組的裁指數如下表 :\n\n|$y_1$|$y_2$|$y_3$|裁指數                 |\n|:---:|:---:|:---:|:------------------------------|\n| $0$ | $0$ | $1$ |$(0+0+3)/(0+0+1) =           3$|\n| $0$ | $1$ | $0$ |$(0-2+0)/(0+1+0) =          -2$|\n| $0$ | $1$ | $1$ |$(0-2+3)/(0+1+1) = \\frac{1}{2}$|\n| $1$ | $0$ | $0$ |$(5+0+0)/(1+0+0) =           5$|\n| $1$ | $0$ | $1$ |$(5+0+3)/(1+0+1) =           4$|\n| $1$ | $1$ | $0$ |$(5-2+0)/(1+1+0) = \\frac{3}{2}$|\n\n裁指數排序後為 $-2, \\frac{1}{2}, \\frac{3}{2}, 3, 4, 5$，並且第 $4$ 大為 $\\frac{3}{2}$。（備註：如果裁指數排名第 $k$ 大和第 $k+1$ 大的裁指數相等，那孫執行長會另外想方法決定裁員名單，不需替他擔心）", "inputFormat": "> $n$ $k$  \n> $w_1$ $w_2$ $\\cdots$ $w_n$\n\n* $n$ 代表公司目標數量。\n* $k$ 代表孫執行長的想知道的排名。\n* $w_i$ 代表第 $i$ 個公司目標的權重。", "outputFormat": "> $p$  \n> $q$\n\n* $\\dfrac{p}{q}$ 代表排序後第 $k$ 大的裁指數。\n* $p$ 必須為整數。\n* $q$ 必須為正整數。\n* $|p|$ 跟 $q$ 必須互質。", "hint": "### 測資限制\n\n* $1 \\le n \\le 2\\times 10^5$。\n* $1 \\le k \\le \\dfrac{n(n+1)}{2}$。\n* $-{10}^9 \\le w_i \\le {10}^9$。\n* $n, k, w_i$ 都是整數。\n\n### 評分說明\n\n本題共有六組子任務，條件限制如下所示。\n每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----------------: | ------------------------------------ |\n| 1        | $5$ | $n \\le 20$                           |\n| 2        | $5$ | $n \\le 10^4$ 且 $k \\le 2\\times 10^5$ |\n| 3        | $5$ | $n \\le 10^4$                         |\n| 4        | $40$ | $k \\le 2\\times 10^5$                 |\n| 5        | $14$ | $-100 \\le w_i \\le 100$               |\n| 6        | $31$ | 無額外限制                            |", "locale": "zh-Hant"}}}
{"pid": "P11850", "type": "P", "difficulty": 5, "samples": [["8 8\n6 8\n3 6\n2 6\n1 3\n1 2\n1 4\n1 5\n5 7\n-1 2 3 -10 -3 0 4 2", "6"], ["2 1\n1 2\n-1 -10", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "树形 DP", "树的直径", "基环树", "台湾"], "title": "[TOIP 2023] 關卡地圖", "background": "", "description": "許多遊戲的設計是以關卡為單位，玩家通過一個關卡後才能挑戰下一個關卡。這些關卡的解鎖關係有時並不是線性的，也就是玩家通過一個關卡後可能一次開放多個可以挑戰的新關卡，也可能不會開放任何新關卡。\n\n經典的 A 遊戲就屬於這種非線性的關卡結構。關卡的狀態分為三種：「尚未解鎖」、「已解鎖但未通過」以及「已通過」。A 遊戲有 $n$ 個關卡，被呈現在一張地圖上，其中有 $m$ 對關卡存在相互解鎖關係，以 $(u_i, v_i)$ 表示。當玩家通過關卡 $u_i$ 時，關卡 $v_i$ 將被解鎖；反過來說，當玩家通過關卡 $v_i$ 時，關卡 $u_i$ 也會被解鎖。玩家可以從任意關卡開始遊戲，且保證在非線性的玩法下，可以通過其他所有關卡。另，為了避免破關流程過於簡單，A 遊戲滿足 $m \\le n$。\n\n凱特決定把 A 遊戲當作線性解鎖關卡來玩：選擇一個起始關卡，接著一旦通過了某個關卡 $c$ 後，下一關**只能是與關卡 $c$ 有相互解鎖關係的關卡**，且**一關最多只能通過一次**。已知凱特通過關卡 $i$ 時，得到的成就感為 $a_i$，請幫他找出最適合的破關路徑以最大化成就感總和。\n\n舉例來說，假設 A 遊戲的關卡地圖如下圖所示，圖中圓點中的數字代表關卡編號，圓點旁邊的數字代表該關卡破關所得到的成就感；兩個關卡的連線代表一個相互解鎖關係。若凱特選擇從關卡 $7$ 開始破關，則關卡 $5$ 將被解鎖，接著依序通過關卡 $5, 1, 3, 6, 2$，得到的成就感總和為 $4+(-3)+(-1)+3+0+2 = 5$。另一方面，若凱特選擇從關卡 $8$ 開始破關，並依序通過關卡 $6, 3, 1, 2$，得到的成就感總合為 $2+0+3+(-1)+2 = 6$，此時成就感總和為最大值。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5eyx6ogx.png)\n", "inputFormat": "> $n$ $m$   \n> $u_1$ $v_1$   \n> $u_2$ $v_2$   \n> $\\vdots$   \n> $u_m$ $v_m$  \n> $a_1$ $a_2$ $\\ldots$ $a_n$\n\n* $n$ 代表關卡數。\n* $m$ 代表解鎖關係數。\n* $u_i, v_i$ 代表通過關卡 $u_i$ 或 $v_i$ 的其中一個後，另一個關卡將被解鎖。\n* $a_i$ 代表凱特通過關卡 $i$ 時的成就感。", "outputFormat": "> $s$\n\n* $s$ 為一整數，代表凱特能獲得的最大成就感總和。", "hint": "* $1 \\le n \\le 10^5$。\n* $m = n-1$ 或 $m = n$。\n* $1 \\le u_i < v_i \\le n$，且若 $i \\ne j$，保證 $(u_i, v_i) \\ne (u_j, v_j)$。\n* $-10^9 \\le a_i \\le 10^9$。\n* 遊戲設計保證正常遊玩（非線性）時從任何一關做為起始關卡皆能解鎖所有關卡。\n* 上述變數都是整數。\n\n### 評分說明\n\n本題共有四組子任務，條件限制如下所示。\n每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----: | ------------ |\n| 1 | $17$ | $n \\le 100$ |\n| 2 | $23$ | $m = n-1$ |\n| 3 | $34$ | $a_i \\ge 0$ |\n| 4 | $26$ | 無額外限制 |", "locale": "zh-Hant", "translations": {"zh-CN": {"title": "[TOIP 2023] 关卡地图", "background": "", "description": "许多游戏的设计是以关卡为单位，玩家通过一个关卡后才能挑战下一个关卡。这些关卡的解锁关系有时并不是线性的，也就是玩家通过一个关卡后可能一次开放多个可以挑战的新关卡，也可能不会开放任何新关卡。\n\n经典的 A 游戏就属于这种非线性的关卡结构。关卡的状态分为三种：「尚未解锁」、「已解锁但未通过」以及「已通过」。A 游戏有 $n$ 个关卡，被呈现在一张地图上，其中有 $m$ 对关卡存在相互解锁关系，以 $(u_i, v_i)$ 表示。当玩家通过关卡 $u_i$ 时，关卡 $v_i$ 将被解锁；反过来，当玩家通过关卡 $v_i$ 时，关卡 $u_i$ 也会被解锁。玩家可以从任意关卡开始游戏，且保证在非线性的玩法下，可以通过其他所有关卡。另外，为了避免通关流程过于简单，A 游戏满足 $m \\le n$。\n\n凯特决定把 A 游戏当作线性解锁关卡来玩：选择一个起始关卡，接着一旦通过了某个关卡 $c$ 后，下一关**只能是与关卡 $c$ 有相互解锁关系的关卡**，且**一关最多只能通过一次**。已知凯特通过关卡 $i$ 时，得到的成就感为 $a_i$，请帮他找出最适合的通关路径以最大化成就感总和。\n\n举例来说，假设 A 游戏的关卡地图如下图所示，图中圆点中的数字代表关卡编号，圆点旁边的数字代表该关卡通关所得到的成就感；两个关卡的连线代表一个相互解锁关系。若凯特选择从关卡 $7$ 开始通关，则关卡 $5$ 将被解锁，接着依序通过关卡 $5, 1, 3, 6, 2$，得到的成就感总和为 $4+(-3)+(-1)+3+0+2 = 5$。另一方面，若凯特选择从关卡 $8$ 开始通关，并依序通过关卡 $6, 3, 1, 2$，得到的成就感总和为 $2+0+3+(-1)+2 = 6$，此时成就感总和为最大值。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5eyx6ogx.png)", "inputFormat": "> $n$ $m$   \n> $u_1$ $v_1$   \n> $u_2$ $v_2$   \n> $\\vdots$   \n> $u_m$ $v_m$  \n> $a_1$ $a_2$ $\\ldots$ $a_n$\n\n* $n$ 代表关卡数。\n* $m$ 代表解锁关系数。\n* $u_i, v_i$ 代表通过关卡 $u_i$ 或 $v_i$ 的其中一个后，另一个关卡将被解锁。\n* $a_i$ 代表凯特通过关卡 $i$ 时的成就感。", "outputFormat": "> $s$\n\n* $s$ 为一整数，代表凯特能获得的最大成就感总和。", "hint": "### 测试数据限制\n\n* $1 \\le n \\le 10^5$。\n* $m = n-1$ 或 $m = n$。\n* $1 \\le u_i < v_i \\le n$，且若 $i \\ne j$，保证 $(u_i, v_i) \\ne (u_j, v_j)$。\n* $-10^9 \\le a_i \\le 10^9$。\n* 游戏设计保证正常游玩（非线性）时从任何一关作为起始关卡皆能解锁所有关卡。\n* 上述变量均为整数。\n\n### 评分说明\n\n本题共有四组子任务，条件限制如下所示。\n每一组可有一或多组测试数据，该组所有测试数据皆需答对才会获得该组分数。\n\n|  子任务  |  分数  | 额外输入限制 |\n| :------: | :----: | ------------ |\n| 1 | $17$ | $n \\le 100$ |\n| 2 | $23$ | $m = n-1$ |\n| 3 | $34$ | $a_i \\ge 0$ |\n| 4 | $26$ | 无额外限制 |", "locale": "zh-CN"}, "zh-Hant": {"title": "[TOIP 2023] 關卡地圖", "background": "", "description": "許多遊戲的設計是以關卡為單位，玩家通過一個關卡後才能挑戰下一個關卡。這些關卡的解鎖關係有時並不是線性的，也就是玩家通過一個關卡後可能一次開放多個可以挑戰的新關卡，也可能不會開放任何新關卡。\n\n經典的 A 遊戲就屬於這種非線性的關卡結構。關卡的狀態分為三種：「尚未解鎖」、「已解鎖但未通過」以及「已通過」。A 遊戲有 $n$ 個關卡，被呈現在一張地圖上，其中有 $m$ 對關卡存在相互解鎖關係，以 $(u_i, v_i)$ 表示。當玩家通過關卡 $u_i$ 時，關卡 $v_i$ 將被解鎖；反過來說，當玩家通過關卡 $v_i$ 時，關卡 $u_i$ 也會被解鎖。玩家可以從任意關卡開始遊戲，且保證在非線性的玩法下，可以通過其他所有關卡。另，為了避免破關流程過於簡單，A 遊戲滿足 $m \\le n$。\n\n凱特決定把 A 遊戲當作線性解鎖關卡來玩：選擇一個起始關卡，接著一旦通過了某個關卡 $c$ 後，下一關**只能是與關卡 $c$ 有相互解鎖關係的關卡**，且**一關最多只能通過一次**。已知凱特通過關卡 $i$ 時，得到的成就感為 $a_i$，請幫他找出最適合的破關路徑以最大化成就感總和。\n\n舉例來說，假設 A 遊戲的關卡地圖如下圖所示，圖中圓點中的數字代表關卡編號，圓點旁邊的數字代表該關卡破關所得到的成就感；兩個關卡的連線代表一個相互解鎖關係。若凱特選擇從關卡 $7$ 開始破關，則關卡 $5$ 將被解鎖，接著依序通過關卡 $5, 1, 3, 6, 2$，得到的成就感總和為 $4+(-3)+(-1)+3+0+2 = 5$。另一方面，若凱特選擇從關卡 $8$ 開始破關，並依序通過關卡 $6, 3, 1, 2$，得到的成就感總合為 $2+0+3+(-1)+2 = 6$，此時成就感總和為最大值。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5eyx6ogx.png)\n", "inputFormat": "> $n$ $m$   \n> $u_1$ $v_1$   \n> $u_2$ $v_2$   \n> $\\vdots$   \n> $u_m$ $v_m$  \n> $a_1$ $a_2$ $\\ldots$ $a_n$\n\n* $n$ 代表關卡數。\n* $m$ 代表解鎖關係數。\n* $u_i, v_i$ 代表通過關卡 $u_i$ 或 $v_i$ 的其中一個後，另一個關卡將被解鎖。\n* $a_i$ 代表凱特通過關卡 $i$ 時的成就感。", "outputFormat": "> $s$\n\n* $s$ 為一整數，代表凱特能獲得的最大成就感總和。", "hint": "* $1 \\le n \\le 10^5$。\n* $m = n-1$ 或 $m = n$。\n* $1 \\le u_i < v_i \\le n$，且若 $i \\ne j$，保證 $(u_i, v_i) \\ne (u_j, v_j)$。\n* $-10^9 \\le a_i \\le 10^9$。\n* 遊戲設計保證正常遊玩（非線性）時從任何一關做為起始關卡皆能解鎖所有關卡。\n* 上述變數都是整數。\n\n### 評分說明\n\n本題共有四組子任務，條件限制如下所示。\n每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----: | ------------ |\n| 1 | $17$ | $n \\le 100$ |\n| 2 | $23$ | $m = n-1$ |\n| 3 | $34$ | $a_i \\ge 0$ |\n| 4 | $26$ | 無額外限制 |", "locale": "zh-Hant"}}}
{"pid": "P11851", "type": "P", "difficulty": 6, "samples": [["2 1 1", "-1"], ["2 1 2", "2\nXXYXY"], ["0 0 4", "2\nXXYY"], ["4 4 0", "1\nXYXYXYXY"], ["5 3 10", "3\nXYYYXYYXYXXXYXXYXX"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "2023", "Special Judge", "构造", "台湾"], "title": "[TOIP 2023] 分子環", "background": "$\\textcolor{red}{\\textbf{本題有 Special Judge，會依照解的好壞程度動態給分。}}$", "description": "A 博士是學界研究外星球物質的最高權威，他因為發現外星球中的 `X` 與 `Y` 兩種地球不存在的分子以及其形成的特殊化合物結構而被提名諾貝爾獎。在博士研究中，這兩種分子不論是與自己或另一種分子間都可以形成化學鍵，並且更進一步地發現，任意大於等於 $3$ 個 `X` 與 `Y` 分子都可以以任意順序形成一個環狀的化合物；環狀化合物中每一個分子與其前一個（逆時針方向）和後一個（順時針方向）分子分別形成鍵結，並廣泛分布在外星球上。A 博士將這種環狀的化合物結構命名為**分子環**，為了方便表示這種分子環，A博士決定以任意一個分子做為起點順時針依序寫下各個分子形成的字串作為此分子環的表示。例如 `XYY` 與 `YYX` 與 `YXY` 都是指同一種分子環的構造。\n\nA 博士也發現了當分子環形成時，這個分子環的不穩定程度與**最多連續相同分子**的數量為正比，因此他決定稱這個數字為**分子環的不穩定度**。舉例來說分子環 `YXY` 中因為最多有 $2$ 個連續的 `Y`（第一和第三個分子在環狀中相鄰），不穩定度為 $2$；同理， `XXYXXYXX` 分子環中因為可以找到 $4$ 個連續的 `X`（分子環表示中第 $1, 2, 7, 8$ 個分子），因此不穩定度為 $4$。\n\n在研究完分子環的性質後，A博士希望能合成出多種不同的分子環來證明他的理論。具體來說，他希望合成的分子環滿足下列的性質：\n\n* 有 $a$ 個分子前後都是 `X` 分子\n* 有 $b$ 個分子前後都是 `Y` 分子\n* 以及有 $c$ 個分子前後分別是一個 `X` 分子和一個 `Y` 分子，前後順序可以顛倒\n\n為了讓博士繼續進行他的研究，A博士決定請你幫忙寫個程式計算滿足條件的分子環。並且他希望你的程式能輸出**不穩定度較低的分子環**來降低合成的難度。由於分子環的表示有很多種，也不一定只有一種分子環滿足博士要求，你只需要輸出任意一種滿足條件的分子環結構即可。\n\n此題的得分會由你輸出的分子環不穩定度決定，請見《評分說明》一節。", "inputFormat": "> $a$ $b$ $c$\n\n* $a$ 代表分子環中有多少個分子前後都是 `X` 分子\n* $b$ 代表分子環中有多少個分子前後都是 `Y` 分子\n* $c$ 代表分子環中有多少個分子前後有一個 `X` 及一個 `Y` 分子（可以前後順序顛倒）", "outputFormat": "若找得到分子環滿足要求，請輸出：\n\n> $K$  \n> $M$\n\n* $K$ 為輸出分子環的不穩定度。\n* $M$ 為一長度 $a+b+c$ 且只包含 `X, Y` 字元的字串，表示分子環的結構。\n\n若沒有分子環能滿足博士的要求，那請輸出：\n\n> $-1$", "hint": "### 測資限制\n\n* $0 \\le a, b, c \\le 10^5$。\n* $a+b+c \\ge 3$。\n* 以上變數皆為整數。\n\n### 評分說明\n\n對每筆有解的輸入檔，評分程式會計算一個 $K^{*}$ 值代表滿足博士要求的最小穩定度。若你的程式輸出的分子環正確且滿足博士要求，則該筆測試資料得分為：\n\n$$\\textbf{round}(\\frac{1000}{1 + \\min\\{19, K - K^{*}\\}}) \\div 1000$$\n\n乘以該筆子任務配分，其中 `round(x)` 代表對 $x$ 四捨五入取至整數位。該子任務的得分為所有輸入檔最小的得分，並請注意若有以下情況則該筆輸入以 $0$ 分計：\n\n* 不滿足題目要求，包括\n  * 與 `XX`, `YY`, `XY` 相鄰的分子數並非規定的 $a$, $b$, $c$ 個\n  * 有解卻輸出 `-1`\n  * 無解但輸出有解\n* 輸出的 $K$ 值並非 $M$ 的不穩定度。\n\n### 子任務\n\n本題共有四組子任務，條件限制如下所示。每一組可有一或多筆測試資料，取該組所有測試資料中最低分為該子任務得分。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----: | ------------ |\n| 1 | $8$ | $a + b + c \\le 15$ |\n| 2 | $29$ | $a, b, c \\le 20$ |\n| 3 | $21$ | $b=0$ 且 $2a \\ge c$ |\n| 4 | $42$ | 無額外限制 |", "locale": "zh-Hant", "translations": {"zh-CN": {"title": "[TOIP 2023] 分子环", "background": "$\\textcolor{red}{\\textbf{本题有 Special Judge，会依照解的好坏程度动态给分。}}$", "description": "A 博士是学界研究外星球物质的最高权威，他因为发现外星球中的 `X` 与 `Y` 两种地球不存在的分子以及其形成的特殊化合物结构而被提名诺贝尔奖。在博士研究中，这两种分子不论是与自己或另一种分子间都可以形成化学键，并且更进一步地发现，任意大于等于 $3$ 个 `X` 与 `Y` 分子都可以以任意顺序形成一个环状的化合物；环状化合物中每一个分子与其前一个（逆时针方向）和后一个（顺时针方向）分子分别形成键结，并广泛分布在外星球上。A 博士将这种环状的化合物结构命名为**分子环**，为了方便表示这种分子环，A博士决定以任意一个分子做为起点顺时针依序写下各个分子形成的字串作为此分子环的表示。例如 `XYY` 与 `YYX` 与 `YXY` 都是指同一种分子环的构造。\n\nA 博士也发现了当分子环形成时，这个分子环的不稳定程度与**最多连续相同分子**的数量为正比，因此他决定称这个数字为**分子环的不稳定度**。举例来说分子环 `YXY` 中因为最多有 $2$ 个连续的 `Y`（第一和第三个分子在环状中相邻），不稳定度为 $2$；同理， `XXYXXYXX` 分子环中因为可以找到 $4$ 个连续的 `X`（分子环表示中第 $1, 2, 7, 8$ 个分子），因此不稳定度为 $4$。\n\n在研究完分子环的性质后，A博士希望能合成出多种不同的分子环来证明他的理论。具体来说，他希望合成的分子环满足下列的性质：\n\n* 有 $a$ 个分子前后都是 `X` 分子\n* 有 $b$ 个分子前后都是 `Y` 分子\n* 以及有 $c$ 个分子前后分别是一个 `X` 分子和一个 `Y` 分子，前后顺序可以颠倒\n\n为了让博士继续进行他的研究，A博士决定请你帮忙写个程序计算满足条件的分子环。并且他希望你的程序能输出**不稳定度较低的分子环**来降低合成的难度。由于分子环的表示有很多种，也不一定只有一种分子环满足博士要求，你只需要输出任意一种满足条件的分子环结构即可。\n\n此题的得分会由你输出的分子环不稳定度决定，请见《评分说明》一节。", "inputFormat": "> $a$ $b$ $c$\n\n* $a$ 代表分子环中有多少个分子前后都是 `X` 分子\n* $b$ 代表分子环中有多少个分子前后都是 `Y` 分子\n* $c$ 代表分子环中有多少个分子前后有一个 `X` 及一个 `Y` 分子（可以前后顺序颠倒）\n", "outputFormat": "若找得到分子环满足要求，请输出：\n\n> $K$  \n> $M$\n\n* $K$ 为输出分子环的不稳定度。\n* $M$ 为一长度 $a+b+c$ 且只包含 `X, Y` 字元的字符串，表示分子环的结构。\n\n若没有分子环能满足博士的要求，那请输出：\n\n> $-1$", "hint": "### 测试数据限制\n\n* $0 \\le a, b, c \\le 10^5$。\n* $a+b+c \\ge 3$。\n* 以上变量皆为整数。\n\n### 评分说明\n\n对每个有解的输入，评分程序会计算一个 $K^{*}$ 值代表满足博士要求的最小稳定度。若你的程序输出的分子环正确且满足博士要求，则该笔测试数据得分为：\n\n$$\\textbf{round}(\\frac{1000}{1 + \\min\\{19, K - K^{*}\\}}) \\div 1000$$\n\n乘以该子任务配分，其中 `round(x)` 代表对 $x$ 四舍五入取至整数位。该子任务的得分为所有输入档最小的得分，并请注意若有以下情况则该输入以 $0$ 分计：\n\n* 不满足题目要求，包括\n  * 与 `XX`, `YY`, `XY` 相邻的分子数并非规定的 $a$, $b$, $c$ 个\n  * 有解却输出 `-1`\n  * 无解但输出有解\n* 输出的 $K$ 值并非 $M$ 的不稳定度。\n\n### 子任务\n\n本题共有四组子任务，条件限制如下所示。每一组可有一或多笔测试数据，取该组所有测试数据中最低分为该子任务得分。\n\n|  子任务  |  分数  | 额外输入限制 |\n| :------: | :----: | ------------ |\n| 1 | $8$ | $a + b + c \\le 15$ |\n| 2 | $29$ | $a, b, c \\le 20$ |\n| 3 | $21$ | $b=0$ 且 $2a \\ge c$ |\n| 4 | $42$ | 无额外限制 |", "locale": "zh-CN"}, "zh-Hant": {"title": "[TOIP 2023] 分子環", "background": "$\\textcolor{red}{\\textbf{本題有 Special Judge，會依照解的好壞程度動態給分。}}$", "description": "A 博士是學界研究外星球物質的最高權威，他因為發現外星球中的 `X` 與 `Y` 兩種地球不存在的分子以及其形成的特殊化合物結構而被提名諾貝爾獎。在博士研究中，這兩種分子不論是與自己或另一種分子間都可以形成化學鍵，並且更進一步地發現，任意大於等於 $3$ 個 `X` 與 `Y` 分子都可以以任意順序形成一個環狀的化合物；環狀化合物中每一個分子與其前一個（逆時針方向）和後一個（順時針方向）分子分別形成鍵結，並廣泛分布在外星球上。A 博士將這種環狀的化合物結構命名為**分子環**，為了方便表示這種分子環，A博士決定以任意一個分子做為起點順時針依序寫下各個分子形成的字串作為此分子環的表示。例如 `XYY` 與 `YYX` 與 `YXY` 都是指同一種分子環的構造。\n\nA 博士也發現了當分子環形成時，這個分子環的不穩定程度與**最多連續相同分子**的數量為正比，因此他決定稱這個數字為**分子環的不穩定度**。舉例來說分子環 `YXY` 中因為最多有 $2$ 個連續的 `Y`（第一和第三個分子在環狀中相鄰），不穩定度為 $2$；同理， `XXYXXYXX` 分子環中因為可以找到 $4$ 個連續的 `X`（分子環表示中第 $1, 2, 7, 8$ 個分子），因此不穩定度為 $4$。\n\n在研究完分子環的性質後，A博士希望能合成出多種不同的分子環來證明他的理論。具體來說，他希望合成的分子環滿足下列的性質：\n\n* 有 $a$ 個分子前後都是 `X` 分子\n* 有 $b$ 個分子前後都是 `Y` 分子\n* 以及有 $c$ 個分子前後分別是一個 `X` 分子和一個 `Y` 分子，前後順序可以顛倒\n\n為了讓博士繼續進行他的研究，A博士決定請你幫忙寫個程式計算滿足條件的分子環。並且他希望你的程式能輸出**不穩定度較低的分子環**來降低合成的難度。由於分子環的表示有很多種，也不一定只有一種分子環滿足博士要求，你只需要輸出任意一種滿足條件的分子環結構即可。\n\n此題的得分會由你輸出的分子環不穩定度決定，請見《評分說明》一節。", "inputFormat": "> $a$ $b$ $c$\n\n* $a$ 代表分子環中有多少個分子前後都是 `X` 分子\n* $b$ 代表分子環中有多少個分子前後都是 `Y` 分子\n* $c$ 代表分子環中有多少個分子前後有一個 `X` 及一個 `Y` 分子（可以前後順序顛倒）", "outputFormat": "若找得到分子環滿足要求，請輸出：\n\n> $K$  \n> $M$\n\n* $K$ 為輸出分子環的不穩定度。\n* $M$ 為一長度 $a+b+c$ 且只包含 `X, Y` 字元的字串，表示分子環的結構。\n\n若沒有分子環能滿足博士的要求，那請輸出：\n\n> $-1$", "hint": "### 測資限制\n\n* $0 \\le a, b, c \\le 10^5$。\n* $a+b+c \\ge 3$。\n* 以上變數皆為整數。\n\n### 評分說明\n\n對每筆有解的輸入檔，評分程式會計算一個 $K^{*}$ 值代表滿足博士要求的最小穩定度。若你的程式輸出的分子環正確且滿足博士要求，則該筆測試資料得分為：\n\n$$\\textbf{round}(\\frac{1000}{1 + \\min\\{19, K - K^{*}\\}}) \\div 1000$$\n\n乘以該筆子任務配分，其中 `round(x)` 代表對 $x$ 四捨五入取至整數位。該子任務的得分為所有輸入檔最小的得分，並請注意若有以下情況則該筆輸入以 $0$ 分計：\n\n* 不滿足題目要求，包括\n  * 與 `XX`, `YY`, `XY` 相鄰的分子數並非規定的 $a$, $b$, $c$ 個\n  * 有解卻輸出 `-1`\n  * 無解但輸出有解\n* 輸出的 $K$ 值並非 $M$ 的不穩定度。\n\n### 子任務\n\n本題共有四組子任務，條件限制如下所示。每一組可有一或多筆測試資料，取該組所有測試資料中最低分為該子任務得分。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----: | ------------ |\n| 1 | $8$ | $a + b + c \\le 15$ |\n| 2 | $29$ | $a, b, c \\le 20$ |\n| 3 | $21$ | $b=0$ 且 $2a \\ge c$ |\n| 4 | $42$ | 無額外限制 |", "locale": "zh-Hant"}}}
{"pid": "P11852", "type": "P", "difficulty": 6, "samples": [["7 9\n1 2 5\n1 3 3\n2 3 8\n2 5 3\n3 4 3\n3 5 4\n3 6 2\n4 6 7\n6 7 6\n3\n1 2\n1 6\n3 7", "5\n7\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "双连通分量", "台湾"], "title": "[TOIP 2023] 公路", "background": "", "description": "某國的公路網由 $n$ 個城鎮（編號 $1\\sim n$）和 $m$ 條連接兩個相異城鎮的雙向公路組成，每條公路有其長度，以公里表示。最近該國流行起電動車，但是公路之間都沒有充電站，電動車只能在城鎮充電。該國交通部門官員十分擔心有些被觀光局規劃好的旅程會使電動車的續航力沒辦法走完一條公路，也因此，官員希望旅程中使用到的最長公路長度要盡量短，否則若有些電動車的實際續航力低於一段公路的長度，它們一定會在公路中間沒電。\n\n對於一趟被規劃好的旅程，觀光局會為其決定好一個起點 $u$ 和終點 $v$，並找出 $\\textbf{兩條}$ 由 $u$ 到 $v$ $\\textbf{公路相互不重複}$ 的路徑，來做為一個完整的旅程規劃。例如下圖是一個 $n=7$、$m=9$ 的例子，點上標示城鎮的編號，邊上標示公路的長度。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cugaijat.png)\n\n若要規劃城鎮 $1$ 到城鎮 $2$ 的旅程，可以採用以下兩條路徑：\n\n- $1\\to 2$ 以及 $1\\to 3\\to 2$\n\n這兩條路徑中，所使用的到的最長公路長度是 $8$ 公里，但若採用以下兩條路徑：\n\n- $1\\to 2$ 以及 $1\\to 3\\to 5\\to 2$\n\n就可以將使用的最長公路長度降低至 $5$，也是使最長公路最短的選擇方式。而若要規劃城鎮 $1$ 到城鎮 $6$ 的旅程，可以採用以下兩條路徑：\n\n- $1\\to 3\\to 6$ 以及 $1\\to 2\\to 5\\to 3\\to 4\\to 6$\n\n使用的最長公路長度是 $7$，同時也是使最長公路最短的選擇方式，注意到雖然這兩條路徑共用了同一個城鎮 $3$，但條件只要求「使用的公路不重複」，因此為一種滿足條件的路徑選擇方式。\n\n一個旅程的兩條路徑所使用的最長公路愈短，則該旅程愈佳。今給定 $q$ 對起終點，請寫程式計算每對起終點之最佳旅程使用到的最長公路長度，或者回報不存在任何一種路徑的選擇方式。", "inputFormat": "> $n$ $m$  \n> $a_1$ $b_1$ $l_1$  \n> $a_2$ $b_2$ $l_2$  \n> $\\vdots$  \n> $a_m$ $b_m$ $l_m$  \n> $q$  \n> $u_1$ $v_1$  \n> $u_2$ $v_2$  \n> $\\vdots$  \n> $u_q$ $v_q$  \n\n* $n$, $m$ 分別代表城鎮和公路的數量。\n* 第 $i$ 條公路連接著城鎮 $a_i$ 和 $b_i$，且長度為 $l_i$ 公里。\n* $q$ 代表預計規劃的旅程數量。\n* 第 $i$ 個旅程預計選擇 $u_i$ 作為起點、$v_i$ 作為終點。", "outputFormat": "> $p_1$  \n> $p_2$  \n> $\\vdots$  \n> $p_q$  \n\n* $p_i$ 為一整數\n    * 若 $p_i = -1$，則表示不存在路徑的選擇方法可以完整的規劃第 $i$ 個旅程。\n    * 否則，$p_i$ 代表在最佳的路徑選擇方式下，第 $i$ 個旅程所使用到的最長公路長度最小值。", "hint": "### 測資限制\n\n* $2 \\le n \\le 1000$。\n* $n - 1 \\le m \\le \\displaystyle\\frac{n\\times (n-1)}{2}$。\n* $1 \\le a_i, b_i \\le n$，$a_i \\ne b_i$。\n* $1 \\le l_i \\le 10^9$。\n* 不會有兩條公路連接著相同的一組城鎮。\n* $1 \\le q \\le 5\\times 10^5$。\n* $1 \\le u_i, v_i \\le n$，$u_i \\ne v_i$。\n* 輸入的數皆為整數。\n* 保證任兩個城鎮可以透過若干條公路直接或間接抵達。\n\n### 評分說明\n\n本題共有四組子任務，條件限制如下所示。\n每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----: | ------------ |\n| 1 | $18$ | $n \\le 100$，$m, q \\le 300$，$l_i = 1$ |\n| 2 | $31$ | $n \\le 500$，$m, q \\le 1000$ |\n| 3 | $22$ | $m\\le 3000$ |\n| 4 | $29$ | 無額外限制 |", "locale": "zh-Hant", "translations": {"zh-CN": {"title": "[TOIP 2023] 公路", "background": "", "description": "某国的公路网由 $n$ 个城镇（编号 $1\\sim n$）和 $m$ 条连接两个相异城镇的双向公路组成，每条公路有其长度，以公里表示。最近该国流行起电动车，但是公路之间都没有充电站，电动车只能在城镇充电。该国交通部门官员十分担心有些被观光局规划好的旅程会使电动车的续航力没办法走完一条公路，也因此，官员希望旅程中使用到的最长公路长度要尽量短，否则若有些电动车的实际续航力低于一段公路的长度，它们一定会在公路中间没电。\n\n对于一趟被规划好的旅程，观光局会为其决定好一个起点 $u$ 和终点 $v$，并找出 $\\textbf{两条}$ 由 $u$ 到 $v$ $\\textbf{公路相互不重复}$ 的路径，来作为一个完整的旅程规划。例如下图是一个 $n=7$、$m=9$ 的例子，点上标示城镇的编号，边上标示公路的长度。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cugaijat.png)\n\n若要规划城镇 $1$ 到城镇 $2$ 的旅程，可以采用以下两条路径：\n\n- $1\\to 2$ 以及 $1\\to 3\\to 2$\n\n这两条路径中，所使用到的最长公路长度是 $8$ 公里，但若采用以下两条路径：\n\n- $1\\to 2$ 以及 $1\\to 3\\to 5\\to 2$\n\n就可以将使用的最长公路长度降低至 $5$，也是使最长公路最短的选择方式。而若要规划城镇 $1$ 到城镇 $6$ 的旅程，可以采用以下两条路径：\n\n- $1\\to 3\\to 6$ 以及 $1\\to 2\\to 5\\to 3\\to 4\\to 6$\n\n使用的最长公路长度是 $7$，同时也是使最长公路最短的选择方式，注意到虽然这两条路径共用了同一个城镇 $3$，但条件只要求“使用的公路不重复”，因此为一种满足条件的路径选择方式。\n\n一个旅程的两条路径所使用的最长公路愈短，则该旅程愈佳。今给定 $q$ 对起终点，请写程序计算每对起终点之最佳旅程使用到的最长公路长度，或者回报不存在任何一种路径的选择方式。\n", "inputFormat": "> $n$ $m$  \n> $a_1$ $b_1$ $l_1$  \n> $a_2$ $b_2$ $l_2$  \n> $\\vdots$  \n> $a_m$ $b_m$ $l_m$  \n> $q$  \n> $u_1$ $v_1$  \n> $u_2$ $v_2$  \n> $\\vdots$  \n> $u_q$ $v_q$  \n\n* $n$, $m$ 分别代表城镇和公路的数量。\n* 第 $i$ 条公路连接着城镇 $a_i$ 和 $b_i$，且长度为 $l_i$ 公里。\n* $q$ 代表预计规划的旅程数量。\n* 第 $i$ 个旅程预计选择 $u_i$ 作为起点、$v_i$ 作为终点。", "outputFormat": "> $p_1$  \n> $p_2$  \n> $\\vdots$  \n> $p_q$  \n\n* $p_i$ 为一整数\n    * 若 $p_i = -1$，则表示不存在路径的选择方法可以完整的规划第 $i$ 个旅程。\n    * 否则，$p_i$ 代表在最佳的路径选择方式下，第 $i$ 个旅程所使用到的最长公路长度最小值。", "hint": "### 数据限制\n\n* $2 \\le n \\le 1000$。\n* $n - 1 \\le m \\le \\displaystyle\\frac{n\\times (n-1)}{2}$。\n* $1 \\le a_i, b_i \\le n$，$a_i \\ne b_i$。\n* $1 \\le l_i \\le 10^9$。\n* 不会有两条公路连接着相同的一组城镇。\n* $1 \\le q \\le 5\\times 10^5$。\n* $1 \\le u_i, v_i \\le n$，$u_i \\ne v_i$。\n* 输入的数皆为整数。\n* 保证任两个城镇可以通过若干条公路直接或间接抵达。\n\n### 评分说明\n\n本题共有四组子任务，条件限制如下所示。每一组可有一或多个测试数据，该组所有测试数据皆需答对才会获得该组分数。\n\n|  子任务  |  分数  | 额外输入限制 |\n| :------: | :----: | ------------ |\n| 1 | $18$ | $n \\le 100$，$m, q \\le 300$，$l_i = 1$ |\n| 2 | $31$ | $n \\le 500$，$m, q \\le 1000$ |\n| 3 | $22$ | $m\\le 3000$ |\n| 4 | $29$ | 无额外限制 |", "locale": "zh-CN"}, "zh-Hant": {"title": "[TOIP 2023] 公路", "background": "", "description": "某國的公路網由 $n$ 個城鎮（編號 $1\\sim n$）和 $m$ 條連接兩個相異城鎮的雙向公路組成，每條公路有其長度，以公里表示。最近該國流行起電動車，但是公路之間都沒有充電站，電動車只能在城鎮充電。該國交通部門官員十分擔心有些被觀光局規劃好的旅程會使電動車的續航力沒辦法走完一條公路，也因此，官員希望旅程中使用到的最長公路長度要盡量短，否則若有些電動車的實際續航力低於一段公路的長度，它們一定會在公路中間沒電。\n\n對於一趟被規劃好的旅程，觀光局會為其決定好一個起點 $u$ 和終點 $v$，並找出 $\\textbf{兩條}$ 由 $u$ 到 $v$ $\\textbf{公路相互不重複}$ 的路徑，來做為一個完整的旅程規劃。例如下圖是一個 $n=7$、$m=9$ 的例子，點上標示城鎮的編號，邊上標示公路的長度。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cugaijat.png)\n\n若要規劃城鎮 $1$ 到城鎮 $2$ 的旅程，可以採用以下兩條路徑：\n\n- $1\\to 2$ 以及 $1\\to 3\\to 2$\n\n這兩條路徑中，所使用的到的最長公路長度是 $8$ 公里，但若採用以下兩條路徑：\n\n- $1\\to 2$ 以及 $1\\to 3\\to 5\\to 2$\n\n就可以將使用的最長公路長度降低至 $5$，也是使最長公路最短的選擇方式。而若要規劃城鎮 $1$ 到城鎮 $6$ 的旅程，可以採用以下兩條路徑：\n\n- $1\\to 3\\to 6$ 以及 $1\\to 2\\to 5\\to 3\\to 4\\to 6$\n\n使用的最長公路長度是 $7$，同時也是使最長公路最短的選擇方式，注意到雖然這兩條路徑共用了同一個城鎮 $3$，但條件只要求「使用的公路不重複」，因此為一種滿足條件的路徑選擇方式。\n\n一個旅程的兩條路徑所使用的最長公路愈短，則該旅程愈佳。今給定 $q$ 對起終點，請寫程式計算每對起終點之最佳旅程使用到的最長公路長度，或者回報不存在任何一種路徑的選擇方式。", "inputFormat": "> $n$ $m$  \n> $a_1$ $b_1$ $l_1$  \n> $a_2$ $b_2$ $l_2$  \n> $\\vdots$  \n> $a_m$ $b_m$ $l_m$  \n> $q$  \n> $u_1$ $v_1$  \n> $u_2$ $v_2$  \n> $\\vdots$  \n> $u_q$ $v_q$  \n\n* $n$, $m$ 分別代表城鎮和公路的數量。\n* 第 $i$ 條公路連接著城鎮 $a_i$ 和 $b_i$，且長度為 $l_i$ 公里。\n* $q$ 代表預計規劃的旅程數量。\n* 第 $i$ 個旅程預計選擇 $u_i$ 作為起點、$v_i$ 作為終點。", "outputFormat": "> $p_1$  \n> $p_2$  \n> $\\vdots$  \n> $p_q$  \n\n* $p_i$ 為一整數\n    * 若 $p_i = -1$，則表示不存在路徑的選擇方法可以完整的規劃第 $i$ 個旅程。\n    * 否則，$p_i$ 代表在最佳的路徑選擇方式下，第 $i$ 個旅程所使用到的最長公路長度最小值。", "hint": "### 測資限制\n\n* $2 \\le n \\le 1000$。\n* $n - 1 \\le m \\le \\displaystyle\\frac{n\\times (n-1)}{2}$。\n* $1 \\le a_i, b_i \\le n$，$a_i \\ne b_i$。\n* $1 \\le l_i \\le 10^9$。\n* 不會有兩條公路連接著相同的一組城鎮。\n* $1 \\le q \\le 5\\times 10^5$。\n* $1 \\le u_i, v_i \\le n$，$u_i \\ne v_i$。\n* 輸入的數皆為整數。\n* 保證任兩個城鎮可以透過若干條公路直接或間接抵達。\n\n### 評分說明\n\n本題共有四組子任務，條件限制如下所示。\n每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。\n\n|  子任務  |  分數  | 額外輸入限制 |\n| :------: | :----: | ------------ |\n| 1 | $18$ | $n \\le 100$，$m, q \\le 300$，$l_i = 1$ |\n| 2 | $31$ | $n \\le 500$，$m, q \\le 1000$ |\n| 3 | $22$ | $m\\le 3000$ |\n| 4 | $29$ | 無額外限制 |", "locale": "zh-Hant"}}}
{"pid": "P11853", "type": "P", "difficulty": 2, "samples": [["4\n0 2\n2 4\n1 4\n6 7", "3"], ["4\n1000000 1000000\n1000000 1000000\n0 1000000\n1 1000000", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "山东", "差分", "CSP-J 入门级"], "title": "[CSP-J 2022 山东] 植树节", "background": "受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。", "description": "植树节快要到了，学校要组织志愿者去给树苗浇水。\n\n有一排树苗，编号依次是 $0,1,2,\\dots$。\n\n现有 $n$ 个志愿者去给树苗浇水，第 $i$ 个志愿者选定了一个区间 $\\left[a_{i},b_{i}\\right]$ ，表示第 $i$ 个志愿者将 $\\left[a_{i},b_{i}\\right]$ 这一区间内的每一棵树都浇一次水。\n\n如某个志愿者选择的浇水区间为 $\\left[4,9\\right]$ ，表示他将给编号为 $4,5,6,7,8,9$ 的树各浇水一次。\n\n当所有的志愿者完成各自所选区间的浇水后，可能有些树苗被不同的志愿者浇水多次，也可能有的树苗一次也没被浇过水。\n\n请你求出浇水最多的树苗被浇了多少次。", "inputFormat": "第 $1$ 行，一个整数 $n$ ，表示志愿者的人数。\n\n第 $2$ 行到第 $n+1$ 行，每行两个整数 $a_{i},b_{i} $（$i=0,1,2,\\dots n-1$），表示志愿者 $i$ 选择的浇水区间。", "outputFormat": "输出 $1$ 行， $1$ 个整数，表示浇水最多的树苗被浇水的次数。", "hint": "### 数据范围\n* 对于所有的数据： $n \\le 10^{5}$；$0\\le a_{i}\\le b_{i}\\le 10^{6}$。  \n\n::cute-table{tuack}\n\n|测试点编号|$a_{i}\\le$|$b_{i}\\le$|$n\\le$|特殊性质|\n|:-:|:-:|:-:|:-:|:-:|\n|$1,2,3$|$10^{3}$|$10^{3}$|$10^{3}$|无|\n|$4,5,6,7$|$10^{6}$|$10^{6}$|$10^{5}$|无|\n|$8$|$10^{6}$|$10^{6}$|$10^{5}$|$a_{i}=b_{i}$|\n|$9$|$10^{6}$|$10^{6}$|$10^{5}$|$a_{i}=1,b_{i}=10^{3}$|\n|$10$|$10^{6}$|$10^{6}$|$10^{5}$|无|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CSP-J 2022 山东] 植树节", "background": "受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。", "description": "植树节快要到了，学校要组织志愿者去给树苗浇水。\n\n有一排树苗，编号依次是 $0,1,2,\\dots$。\n\n现有 $n$ 个志愿者去给树苗浇水，第 $i$ 个志愿者选定了一个区间 $\\left[a_{i},b_{i}\\right]$ ，表示第 $i$ 个志愿者将 $\\left[a_{i},b_{i}\\right]$ 这一区间内的每一棵树都浇一次水。\n\n如某个志愿者选择的浇水区间为 $\\left[4,9\\right]$ ，表示他将给编号为 $4,5,6,7,8,9$ 的树各浇水一次。\n\n当所有的志愿者完成各自所选区间的浇水后，可能有些树苗被不同的志愿者浇水多次，也可能有的树苗一次也没被浇过水。\n\n请你求出浇水最多的树苗被浇了多少次。", "inputFormat": "第 $1$ 行，一个整数 $n$ ，表示志愿者的人数。\n\n第 $2$ 行到第 $n+1$ 行，每行两个整数 $a_{i},b_{i} $（$i=0,1,2,\\dots n-1$），表示志愿者 $i$ 选择的浇水区间。", "outputFormat": "输出 $1$ 行， $1$ 个整数，表示浇水最多的树苗被浇水的次数。", "hint": "### 数据范围\n* 对于所有的数据： $n \\le 10^{5}$；$0\\le a_{i}\\le b_{i}\\le 10^{6}$。  \n\n::cute-table{tuack}\n\n|测试点编号|$a_{i}\\le$|$b_{i}\\le$|$n\\le$|特殊性质|\n|:-:|:-:|:-:|:-:|:-:|\n|$1,2,3$|$10^{3}$|$10^{3}$|$10^{3}$|无|\n|$4,5,6,7$|$10^{6}$|$10^{6}$|$10^{5}$|无|\n|$8$|$10^{6}$|$10^{6}$|$10^{5}$|$a_{i}=b_{i}$|\n|$9$|$10^{6}$|$10^{6}$|$10^{5}$|$a_{i}=1,b_{i}=10^{3}$|\n|$10$|$10^{6}$|$10^{6}$|$10^{5}$|无|", "locale": "zh-CN"}}}
{"pid": "P11854", "type": "P", "difficulty": 3, "samples": [["7\n1\n0\n3\n2\n3 1\n0 0\n2\n1 4\n0 0\n3\n1 2 3\n0 0 0\n3\n1 2 3\n4 1 2\n3\n3 3 3\n5 3 3\n6\n5 4 7 2 10 4\n3 2 5 1 4 6", "0\n2\n2.5\n2\n1\n3\n6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "贪心", "二分", "2022", "三分", "山东", "CSP-J 入门级"], "title": "[CSP-J 2022 山东] 宴会", "background": "受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。", "description": "今人不见古时月，今月曾经照古人。梦回长安，大唐风华，十里长安花，一日看尽。\n\n唐长安城是当时世界上规模最大、建筑最宏伟、规划布局最为规范化的一座都城。其营建制度规划布局的特点是规模空前、创设皇城、三城层环、六坡利用、布局对称、街衢宽阔、坊\n里齐整、形制划一、渠水纵横、绿荫蔽城、郊环祀坛。而所谓的十里长安街，位于长安城的中轴线上，即唐长安城的朱雀大街，又称承天门大街。唐朝官员们住在各个“坊”里，上朝下朝都需要通过朱雀大街。\n\n为了保持各大家族的联系和友谊，各官员往往会每月办一次宴会。为了方便描述，我们把朱雀大街看成一个数轴，各官员所居住的“坊”缩略为数轴上的一个坐标点。大家决定选一处地点（该地点是数轴上的某一个点，不一定坐标点）办宴会。由于唐朝宵禁严格，大家又都希望交流时间尽可能长，因此想要使宴会开始时间尽可能早。又因为大唐注重礼仪，因此，参加宴会的官员会花一定时间盛装打扮过后才前往宴会地点（不一定是坐标点）。\n\n更具体地，一条纵向的街道上（相当于一维坐标）有 $n$ 个人居住，其中第 $i$ 个人居住在 $x_{i}$ （非负整数）位置（坐标点）上。每月他们会选择在 $x_{0}$（数轴上的某一个点，不一定坐标点）处举办宴会。\n\n已知第 $i$ 个人从 $x_{i}$ 出发前往宴会地点 $x_{0}$ 处需要花费 $\\left|x_{i}-x_{0}\\right|$ 的时间，另外，他还需要花费 $t_{i}$ 的时间进行打扮，换言之，他共需要花费 $\\left|x_{i}-x_{0}\\right|+t_{i}$ 的时间到达宴会举办处。\n\n假设**初始时刻为 $0$**。这 $n$ 个人开始打扮和出发前往宴会处，他们想要使得宴会的开始时间尽可能早，于是向你求助，请你帮助他们确定好最优的宴会举办地点 $x_{0}$。\n\n注：$\\left|x_{i}-x_{0}\\right|$ 表示 $x_{i}$ 与 $x_{0}$ 之差的绝对值，且题目中 $n$ 个人的居住地点坐标均为整数。", "inputFormat": "第一行一个正整数 $T$，表示测试数据的组数。\n\n接下来对于每组测试数据（注意：每组测试数据有 $3$ 行数据，以下共 $3\\times T$ 行数据）：\n\n第一行一个正整数 $n$，表示总官员人数。\n\n第二行共 $n$ 个非负整数 $x_{1},x_{2},\\dots,x_{n}$ 分别表示这 $n$ 个人在数轴上的坐标。\n\n第三行共 $n$ 个非负整数 $t_{1},t_{2},\\dots,t_{n}$  分别表示这 $n$ 个人出发前的打扮时间。", "outputFormat": "共输出 $T$ 行数据，对于每组测试数据，输出一行一个**实数**（如果是整数按整数输出，如果有小数，保留 $1$ 位小数输出），表示使宴会开始时间最早的最优举办地点坐标 $x_{0}$。（很显然，$x_{0}$ 都是唯一的）", "hint": "### 样例说明\n\n初始时刻为 $0$。\n\n对于第一组测试数据只有 $1$ 个人，坐标为 $0$，打扮时间为 $3$，很显然 $x_{0}$ 就定在坐标 $0$ 处，使得宴会开始时间为 $3$ 且最早。\n\n对于第二组测试数据有 $2$ 个人，坐标分别为 $3$、$1$，打扮时间均为 $0$，很显然 $x_{0}$ 定在坐标 $2$ 处，使得宴会开始时间为 $1$ 且最早。\n\n对于第三组测试数据有 $2$ 个人，坐标分别为 $1$、$4$，打扮时间均为 $0$，很显然 $x_{0}$ 定在坐标 $2.5$ 处，使得宴会开始时间为 $1.5$ 且最早。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$T=1,n\\le100,0\\le x_{i},t_{i}\\le1000$；\n\n对于 $60\\%$ 的数据，$n\\le10^{4},0\\le x_{i},t_{i}\\le10^{5}$；\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^{3},n\\le10^{5},0\\le x_{i},t_{i}\\le10^{8}$，且保证所有测试数据的 $n$ 加起来不超过 $2\\times10^{5}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CSP-J 2022 山东] 宴会", "background": "受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。", "description": "今人不见古时月，今月曾经照古人。梦回长安，大唐风华，十里长安花，一日看尽。\n\n唐长安城是当时世界上规模最大、建筑最宏伟、规划布局最为规范化的一座都城。其营建制度规划布局的特点是规模空前、创设皇城、三城层环、六坡利用、布局对称、街衢宽阔、坊\n里齐整、形制划一、渠水纵横、绿荫蔽城、郊环祀坛。而所谓的十里长安街，位于长安城的中轴线上，即唐长安城的朱雀大街，又称承天门大街。唐朝官员们住在各个“坊”里，上朝下朝都需要通过朱雀大街。\n\n为了保持各大家族的联系和友谊，各官员往往会每月办一次宴会。为了方便描述，我们把朱雀大街看成一个数轴，各官员所居住的“坊”缩略为数轴上的一个坐标点。大家决定选一处地点（该地点是数轴上的某一个点，不一定坐标点）办宴会。由于唐朝宵禁严格，大家又都希望交流时间尽可能长，因此想要使宴会开始时间尽可能早。又因为大唐注重礼仪，因此，参加宴会的官员会花一定时间盛装打扮过后才前往宴会地点（不一定是坐标点）。\n\n更具体地，一条纵向的街道上（相当于一维坐标）有 $n$ 个人居住，其中第 $i$ 个人居住在 $x_{i}$ （非负整数）位置（坐标点）上。每月他们会选择在 $x_{0}$（数轴上的某一个点，不一定坐标点）处举办宴会。\n\n已知第 $i$ 个人从 $x_{i}$ 出发前往宴会地点 $x_{0}$ 处需要花费 $\\left|x_{i}-x_{0}\\right|$ 的时间，另外，他还需要花费 $t_{i}$ 的时间进行打扮，换言之，他共需要花费 $\\left|x_{i}-x_{0}\\right|+t_{i}$ 的时间到达宴会举办处。\n\n假设**初始时刻为 $0$**。这 $n$ 个人开始打扮和出发前往宴会处，他们想要使得宴会的开始时间尽可能早，于是向你求助，请你帮助他们确定好最优的宴会举办地点 $x_{0}$。\n\n注：$\\left|x_{i}-x_{0}\\right|$ 表示 $x_{i}$ 与 $x_{0}$ 之差的绝对值，且题目中 $n$ 个人的居住地点坐标均为整数。", "inputFormat": "第一行一个正整数 $T$，表示测试数据的组数。\n\n接下来对于每组测试数据（注意：每组测试数据有 $3$ 行数据，以下共 $3\\times T$ 行数据）：\n\n第一行一个正整数 $n$，表示总官员人数。\n\n第二行共 $n$ 个非负整数 $x_{1},x_{2},\\dots,x_{n}$ 分别表示这 $n$ 个人在数轴上的坐标。\n\n第三行共 $n$ 个非负整数 $t_{1},t_{2},\\dots,t_{n}$  分别表示这 $n$ 个人出发前的打扮时间。", "outputFormat": "共输出 $T$ 行数据，对于每组测试数据，输出一行一个**实数**（如果是整数按整数输出，如果有小数，保留 $1$ 位小数输出），表示使宴会开始时间最早的最优举办地点坐标 $x_{0}$。（很显然，$x_{0}$ 都是唯一的）", "hint": "### 样例说明\n\n初始时刻为 $0$。\n\n对于第一组测试数据只有 $1$ 个人，坐标为 $0$，打扮时间为 $3$，很显然 $x_{0}$ 就定在坐标 $0$ 处，使得宴会开始时间为 $3$ 且最早。\n\n对于第二组测试数据有 $2$ 个人，坐标分别为 $3$、$1$，打扮时间均为 $0$，很显然 $x_{0}$ 定在坐标 $2$ 处，使得宴会开始时间为 $1$ 且最早。\n\n对于第三组测试数据有 $2$ 个人，坐标分别为 $1$、$4$，打扮时间均为 $0$，很显然 $x_{0}$ 定在坐标 $2.5$ 处，使得宴会开始时间为 $1.5$ 且最早。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$T=1,n\\le100,0\\le x_{i},t_{i}\\le1000$；\n\n对于 $60\\%$ 的数据，$n\\le10^{4},0\\le x_{i},t_{i}\\le10^{5}$；\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^{3},n\\le10^{5},0\\le x_{i},t_{i}\\le10^{8}$，且保证所有测试数据的 $n$ 加起来不超过 $2\\times10^{5}$。", "locale": "zh-CN"}}}
{"pid": "P11855", "type": "P", "difficulty": 4, "samples": [["5\n1 2 3 4 5\n1 2\n1 3\n2 4\n3 5\n4\n1 1 2\n2 2 3\n1 3 3\n2 5 1\n4\n1\n2\n3\n4", "6\n7\n9\n9"], ["4\n1 1 1 1\n1 2\n1 3\n1 4\n1\n1 1 1\n2\n1\n2", "2\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "山东", "树的遍历", "树链剖分", "前缀和", "差分", "CSP-J 入门级", "离线处理"], "title": "[CSP-J 2022 山东] 部署", "background": "受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。", "description": "“万里羽书来未绝，五关烽火昼仍传。” \n\n古时候没有现代信息化战争的技术，只能靠烽火传信和将军运筹帷幄的调兵遣将来取得战争的优势。\n\n为了使消耗最低，现在 A 国已经在 $n$ 个城市之间建好了道路和行军部署渠道，使得这 $n$ 个城市都能互相到达且不存在环（即构成以 $1$ 号城市为根节点的树型结构）。每个城市都驻扎了一定数量的兵力。\n\n为了清晰的描述问题，我们给这 $n$ 个城市进行 $1$ 到 $n$ 的编号，且 $1$ 号城市为树的根节点（数据保证：构成以 $1$ 号城市为根节点的一棵树）。初始时，第 $i$ 座城市拥有初始兵力 $a_{i}$。\n\n现在为测试战争部署速度，将军进行了 $m$ 次测试，每次测试可能为以下两种命令的某一种：\n\n`1 x y`（三个数间均用 1 个空格分开）：向 $x$ 号城市**和**以它为根的子树中的所有城市全部增兵 $y$ 的数量。\n\n`2 x y`（三个数间均用 1 个空格分开）：向 $x$ 号城市**和**与它直接相连（含父结点和子结点）的城市全部增兵 $y$ 的数量。\n\n$m$ 条命令发布出去后，将军喊来参谋，进行了 $q$ 次询问，每次询问第 $x$ 座城市的最终兵力情况。\n该参谋就是小虾米，他又向你求助了，请你帮助他解决问题（$q$ 次询问的结果）。", "inputFormat": "第一行一个正整数 $n$ 表示城市数量。\n\n第二行一共 $n$ 个正整数 $a_{1},a_{2},\\dots a_{n}$ 表示每座城市的初始兵力。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，表示 $x$ 和 $y$ 城市之间有直接相连的道路。\n\n接下来一行一个正整数 $m$，表示 $m$ 次命令。\n\n接下来 $m$ 行，每行三个正整数 $p,x,y$ 表示两种命令其中一种，其中 $p=1$ 时表示第一种命令，$p=2$ 时表示第二种命令。\n\n接下来一行一个正整数 $q$，表示 $q$ 次询问。\n\n接下来 $q$ 行，每行一个正整数 $x$ ，表示询问编号为 $x$ 的城市最后的兵力值。", "outputFormat": "一共 $q$ 行，每行一个正整数分别对应于每次询问的答案。", "hint": "### 数据范围\n对于 $30\\%$ 的数据，$1\\le n\\le1000,1\\le m\\le1000$；\n\n对于 $60\\%$ 的数据，$1\\le n\\le10^{5},1\\le m\\le10^{5},1\\le q\\le10^{5}$；\n\n其中 $10\\%$ 的数据树是一条链，另外 $10\\%$ 的数据只有 $1$ 操作，另外 $10\\%$ 的数据只有 $2$ 操作。\n\n对于 $100\\%$ 的数据，数据保证给定的城市和道路能形成树，且 $1$ 号城市为根节点。$1\\le n\\le10^{6},1\\le m\\le10^{6},1\\le q\\le10^{6},1\\le a_{i}\\le10^{9},1\\le x\\le n,1\\le y\\le10$。\n\n2025-06-26 增加 Hack 一组", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CSP-J 2022 山东] 部署", "background": "受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。", "description": "“万里羽书来未绝，五关烽火昼仍传。” \n\n古时候没有现代信息化战争的技术，只能靠烽火传信和将军运筹帷幄的调兵遣将来取得战争的优势。\n\n为了使消耗最低，现在 A 国已经在 $n$ 个城市之间建好了道路和行军部署渠道，使得这 $n$ 个城市都能互相到达且不存在环（即构成以 $1$ 号城市为根节点的树型结构）。每个城市都驻扎了一定数量的兵力。\n\n为了清晰的描述问题，我们给这 $n$ 个城市进行 $1$ 到 $n$ 的编号，且 $1$ 号城市为树的根节点（数据保证：构成以 $1$ 号城市为根节点的一棵树）。初始时，第 $i$ 座城市拥有初始兵力 $a_{i}$。\n\n现在为测试战争部署速度，将军进行了 $m$ 次测试，每次测试可能为以下两种命令的某一种：\n\n`1 x y`（三个数间均用 1 个空格分开）：向 $x$ 号城市**和**以它为根的子树中的所有城市全部增兵 $y$ 的数量。\n\n`2 x y`（三个数间均用 1 个空格分开）：向 $x$ 号城市**和**与它直接相连（含父结点和子结点）的城市全部增兵 $y$ 的数量。\n\n$m$ 条命令发布出去后，将军喊来参谋，进行了 $q$ 次询问，每次询问第 $x$ 座城市的最终兵力情况。\n该参谋就是小虾米，他又向你求助了，请你帮助他解决问题（$q$ 次询问的结果）。", "inputFormat": "第一行一个正整数 $n$ 表示城市数量。\n\n第二行一共 $n$ 个正整数 $a_{1},a_{2},\\dots a_{n}$ 表示每座城市的初始兵力。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，表示 $x$ 和 $y$ 城市之间有直接相连的道路。\n\n接下来一行一个正整数 $m$，表示 $m$ 次命令。\n\n接下来 $m$ 行，每行三个正整数 $p,x,y$ 表示两种命令其中一种，其中 $p=1$ 时表示第一种命令，$p=2$ 时表示第二种命令。\n\n接下来一行一个正整数 $q$，表示 $q$ 次询问。\n\n接下来 $q$ 行，每行一个正整数 $x$ ，表示询问编号为 $x$ 的城市最后的兵力值。", "outputFormat": "一共 $q$ 行，每行一个正整数分别对应于每次询问的答案。", "hint": "### 数据范围\n对于 $30\\%$ 的数据，$1\\le n\\le1000,1\\le m\\le1000$；\n\n对于 $60\\%$ 的数据，$1\\le n\\le10^{5},1\\le m\\le10^{5},1\\le q\\le10^{5}$；\n\n其中 $10\\%$ 的数据树是一条链，另外 $10\\%$ 的数据只有 $1$ 操作，另外 $10\\%$ 的数据只有 $2$ 操作。\n\n对于 $100\\%$ 的数据，数据保证给定的城市和道路能形成树，且 $1$ 号城市为根节点。$1\\le n\\le10^{6},1\\le m\\le10^{6},1\\le q\\le10^{6},1\\le a_{i}\\le10^{9},1\\le x\\le n,1\\le y\\le10$。\n\n2025-06-26 增加 Hack 一组", "locale": "zh-CN"}}}
{"pid": "P11856", "type": "P", "difficulty": 5, "samples": [["3 2 3 3", "1"], ["4 7 5 5", "34"], ["23 7 3 5", "824896638"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2022", "山东", "枚举", "状态合并", "进制", "CSP-J 入门级", "状压 DP"], "title": "[CSP-J 2022 山东] 吟诗", "background": "受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。", "description": "\"文章本天成，妙手偶得之。\"\n\n吟诗是表达情怀的常用手段，战争落下了帷幕，常年的军旅生活使得小虾米喜欢上了豪放派的诗歌。\n\n这一天，小虾米突然想吟诗了。著名的豪放派诗人苏轼有“老夫聊发少年狂，左牵黄，右擎苍。”的豪放，又有“十年生死两茫茫，不思量，自难忘。”的悲怆。小虾米心向往之，于是也想用《江城子》词牌名作诗。\n\n小虾米想作出能流传千古的诗，根据经验，如果一首诗存在妙手就能流传千古。\n\n具体来说，一首 $N$ 个字的诗，每个字可以用 **$1$ 到 $10$** 之间的某个正整数来表示。同时存在三个正整数 $X,Y,Z\\left(1\\le X\\le7,1\\le Y\\le5,1\\le Z\\le5\\right)$，如果诗中出现了三个连续的片段使得第一个片段之和为 $X$，第二个片段之和为 $Y$，第三个片段之和为 $Z$，则小虾米认为这首诗出现了**妙手**。\n\n即长度为 $n$ 的序列 $a_{1},a_{2},\\dots a_{n} \\left(1\\le a_{i}\\le10\\right)$，如果存在 $i,j,k,l\\left(1\\le i<j<k\\le l\\le n\\right)$ 使得$a_{i}+a_{i+1}+\\dots a_{j-1}=X$ 且 $a_{j}+a_{j+1}+\\dots a_{k-1}=Y$ 且 $a_{k}+a_{k+1}+\\dots a_{l}=Z$ 同时成立，则认为序列出现了妙手（注：第二个片段紧接第一个片段，第三个片段紧接第二个片段）。\n\n举例来说，如果 $N=7$，$X=7$，$Y=3$，$Z=3$，则所有长度为 $7$ 的序列中，很显然共有 $10^{7}$ 种序列，其中一种序列 $\\left[1,5,2,2,1,3,4\\right]$ 出现了**妙手**，因为**存在**三个连续的区间 $\\left[2,3\\right]$、$\\left[4,5\\right]$、$\\left[6,6\\right]$ 满足它们的和分别为 $X=7$，$Y=3$，$Z=3$。\n\n小虾米想知道在给定 $N,X,Y,Z$ 的前提下（共计 $10^{n}$ 种序列，即共 $10^{n}$ 种诗），计算有多少种存在妙手的诗，请你帮他计算出答案。\n\n由于答案可能很大，请你将结果对 **$998244353$** 取模。", "inputFormat": "一行，以空格隔开的 4 个正整数 $N,X,Y,Z$，分别表示序列长度和题目中 $X,Y,Z$ 的值。", "outputFormat": "一行，一个整数，表示答案对 **$998244353$** 取模的结果。", "hint": "### 样例一说明\n在所有可能的序列中，只能构造出一种序列 $\\left[2,3,3\\right]$ 满足题意，因此答案为 $1$。\n### 数据范围\n对于 $30\\%$ 的数据，$3\\le N\\le5$；\n\n对于 $60\\%$ 的数据，$3\\le N\\le20$；\n\n对于 $100\\%$ 的数据，$3\\le N\\le40,1\\le X\\le7,1\\le Y\\le5,1\\le Z\\le5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CSP-J 2022 山东] 吟诗", "background": "受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。", "description": "\"文章本天成，妙手偶得之。\"\n\n吟诗是表达情怀的常用手段，战争落下了帷幕，常年的军旅生活使得小虾米喜欢上了豪放派的诗歌。\n\n这一天，小虾米突然想吟诗了。著名的豪放派诗人苏轼有“老夫聊发少年狂，左牵黄，右擎苍。”的豪放，又有“十年生死两茫茫，不思量，自难忘。”的悲怆。小虾米心向往之，于是也想用《江城子》词牌名作诗。\n\n小虾米想作出能流传千古的诗，根据经验，如果一首诗存在妙手就能流传千古。\n\n具体来说，一首 $N$ 个字的诗，每个字可以用 **$1$ 到 $10$** 之间的某个正整数来表示。同时存在三个正整数 $X,Y,Z\\left(1\\le X\\le7,1\\le Y\\le5,1\\le Z\\le5\\right)$，如果诗中出现了三个连续的片段使得第一个片段之和为 $X$，第二个片段之和为 $Y$，第三个片段之和为 $Z$，则小虾米认为这首诗出现了**妙手**。\n\n即长度为 $n$ 的序列 $a_{1},a_{2},\\dots a_{n} \\left(1\\le a_{i}\\le10\\right)$，如果存在 $i,j,k,l\\left(1\\le i<j<k\\le l\\le n\\right)$ 使得$a_{i}+a_{i+1}+\\dots a_{j-1}=X$ 且 $a_{j}+a_{j+1}+\\dots a_{k-1}=Y$ 且 $a_{k}+a_{k+1}+\\dots a_{l}=Z$ 同时成立，则认为序列出现了妙手（注：第二个片段紧接第一个片段，第三个片段紧接第二个片段）。\n\n举例来说，如果 $N=7$，$X=7$，$Y=3$，$Z=3$，则所有长度为 $7$ 的序列中，很显然共有 $10^{7}$ 种序列，其中一种序列 $\\left[1,5,2,2,1,3,4\\right]$ 出现了**妙手**，因为**存在**三个连续的区间 $\\left[2,3\\right]$、$\\left[4,5\\right]$、$\\left[6,6\\right]$ 满足它们的和分别为 $X=7$，$Y=3$，$Z=3$。\n\n小虾米想知道在给定 $N,X,Y,Z$ 的前提下（共计 $10^{n}$ 种序列，即共 $10^{n}$ 种诗），计算有多少种存在妙手的诗，请你帮他计算出答案。\n\n由于答案可能很大，请你将结果对 **$998244353$** 取模。", "inputFormat": "一行，以空格隔开的 4 个正整数 $N,X,Y,Z$，分别表示序列长度和题目中 $X,Y,Z$ 的值。", "outputFormat": "一行，一个整数，表示答案对 **$998244353$** 取模的结果。", "hint": "### 样例一说明\n在所有可能的序列中，只能构造出一种序列 $\\left[2,3,3\\right]$ 满足题意，因此答案为 $1$。\n### 数据范围\n对于 $30\\%$ 的数据，$3\\le N\\le5$；\n\n对于 $60\\%$ 的数据，$3\\le N\\le20$；\n\n对于 $100\\%$ 的数据，$3\\le N\\le40,1\\le X\\le7,1\\le Y\\le5,1\\le Z\\le5$。", "locale": "zh-CN"}}}
{"pid": "P11857", "type": "P", "difficulty": 1, "samples": [["3 3 3 3", "18"], ["2 2 4 4", "20"], ["1 2 3 1", "12"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2025", "CCC（加拿大）"], "title": "[CCC 2025 Senior] 挂画 / Positioning Peter's Paintings", "background": "译自 CCC 2025 Senior T1。本题满分为 $15$。", "description": "有两幅矩形画，一幅长为 $A$，宽为 $B$；另一幅长为 $X$，宽为 $Y$。\n\n要把这两幅画用一个矩形画框裱起来挂在墙上，但是要满足：\n\n- 这两幅画必须全部在画框中；\n- 这两幅画不能重叠（但是允许边缘触碰）；\n- 这两幅画不能旋转；\n- 这两幅画边缘必须与地面平行，或者垂直于地面。\n\n求出符合条件的画框周长的最小值。", "inputFormat": "一行四个正整数 $A,B,X,Y$。", "outputFormat": "一行一个正整数，表示答案。", "hint": "#### 样例解释\n\n- 样例 $1$ 解释：如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pe6qu57s.png?x-oss-process=image/resize,m_lfit,h_300)\n\n该样例满足子任务 $1\\sim 3$。\n\n- 样例 $2$ 解释：如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x3l3rp1y.png?x-oss-process=image/resize,m_lfit,h_300)\n\n\n该样例满足子任务 $2, 3$。\n\n- 样例 $3$ 解释：如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b4ds4bth.png?x-oss-process=image/resize,m_lfit,h_300)\n\n该样例满足子任务 $3$。\n\n#### 子任务\n\n对于 $100\\%$ 的数据，保证 $1\\le A,B,X,Y\\le 10^8$。\n\n\n- $\\text{Subtask 0(0 points})$：样例。\n- $\\text{Subtask 1(5 points})$：两幅画的形状都是全等的正方形。\n- $\\text{Subtask 2(5 points})$：两幅画的形状都是正方形。\n- $\\text{Subtask 3(5 points})$：无特殊限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCC 2025 Senior] 挂画 / Positioning Peter's Paintings", "background": "译自 CCC 2025 Senior T1。本题满分为 $15$。", "description": "有两幅矩形画，一幅长为 $A$，宽为 $B$；另一幅长为 $X$，宽为 $Y$。\n\n要把这两幅画用一个矩形画框裱起来挂在墙上，但是要满足：\n\n- 这两幅画必须全部在画框中；\n- 这两幅画不能重叠（但是允许边缘触碰）；\n- 这两幅画不能旋转；\n- 这两幅画边缘必须与地面平行，或者垂直于地面。\n\n求出符合条件的画框周长的最小值。", "inputFormat": "一行四个正整数 $A,B,X,Y$。", "outputFormat": "一行一个正整数，表示答案。", "hint": "#### 样例解释\n\n- 样例 $1$ 解释：如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pe6qu57s.png?x-oss-process=image/resize,m_lfit,h_300)\n\n该样例满足子任务 $1\\sim 3$。\n\n- 样例 $2$ 解释：如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x3l3rp1y.png?x-oss-process=image/resize,m_lfit,h_300)\n\n\n该样例满足子任务 $2, 3$。\n\n- 样例 $3$ 解释：如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b4ds4bth.png?x-oss-process=image/resize,m_lfit,h_300)\n\n该样例满足子任务 $3$。\n\n#### 子任务\n\n对于 $100\\%$ 的数据，保证 $1\\le A,B,X,Y\\le 10^8$。\n\n\n- $\\text{Subtask 0(0 points})$：样例。\n- $\\text{Subtask 1(5 points})$：两幅画的形状都是全等的正方形。\n- $\\text{Subtask 2(5 points})$：两幅画的形状都是正方形。\n- $\\text{Subtask 3(5 points})$：无特殊限制。\n", "locale": "zh-CN"}}}
{"pid": "P11858", "type": "P", "difficulty": 3, "samples": [["r2d2\n8", "r"], ["a4b1c2d10\n100", "d"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2025", "CCC（加拿大）"], "title": "[CCC 2025 Senior] 破译 / Cryptogram Cracking Club", "background": "译自 CCC 2025 Senior T2。本题满分为 $15$。", "description": "给定一个小写字母组成的字符串 $s$ 和一个非负整数 $c$。你需要求出，将这个字符串无限重复后，第 $c$ 个位置上的字符是什么。注意字符串是 $\\text{0}-\\text{indexed}$ 的，也就是 $s_0$ 是第一个字符。\n\n为了减少输入量，我们将字符串做了压缩：具体地，我们将一段连续的相同字母 $\\underbrace{\\texttt{aa}\\cdots\\texttt{aa}}_{k\\text{ 个}}$ 压缩成字母+出现次数 $\\texttt{a}k$ 的形式。例如，$\\texttt{aaaabccdddd}$ 被压缩成 $\\texttt{a4b1c2d4}$。\n", "inputFormat": "第一行，一个只含小写字母和数字的压缩后的字符串 $s'$。\n\n第二行，一个非负整数 $c$。", "outputFormat": "一个小写字母，表示答案。", "hint": "\n#### 样例解释\n\n- 样例 $1$ 解释：$\\texttt{r2d2}$ 压缩前是 $\\texttt{rrdd}$。\n\n重复无数多次即为 $\\texttt{rrddrrdd\\textcolor{red}{r}rdd}\\cdots$。\n\n- 样例 $2$ 解释：$\\texttt{a4b1c2d10}$ 压缩前是 $\\texttt{aaaabccdddddddddd}$。\n\n\n\n\n#### 子任务\n\n对于 $100\\%$ 的数据，保证：\n\n- $2\\le |s'|\\le 2\\times10^5$；\n- $s'$ 中出现的整数的范围是 $[1,10^{12}]$；\n- $0\\le c\\le 10^{12}$。\n\n---\n\n- $\\text{Subtask 0(0 points})$：样例。\n- $\\text{Subtask 1(6 points})$：\n\t- $0\\le c\\le 2\\times 10^3$；\n\t- $s'$ 中出现的整数的范围是 $[1,9]$；\n    - 压缩前，$s$ 的长度不超过 $2000$。\n- $\\text{Subtask 2(3 points})$：\n\t- $0\\le c\\le 10^6$；\n    - 压缩前，$s$ 的长度不超过 $10^6$。\n- $\\text{Subtask 3(3 points})$：\n    - 压缩前，$s$ 的长度不超过 $10^6$。\n- $\\text{Subtask 4(3 points})$：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCC 2025 Senior] 破译 / Cryptogram Cracking Club", "background": "译自 CCC 2025 Senior T2。本题满分为 $15$。", "description": "给定一个小写字母组成的字符串 $s$ 和一个非负整数 $c$。你需要求出，将这个字符串无限重复后，第 $c$ 个位置上的字符是什么。注意字符串是 $\\text{0}-\\text{indexed}$ 的，也就是 $s_0$ 是第一个字符。\n\n为了减少输入量，我们将字符串做了压缩：具体地，我们将一段连续的相同字母 $\\underbrace{\\texttt{aa}\\cdots\\texttt{aa}}_{k\\text{ 个}}$ 压缩成字母+出现次数 $\\texttt{a}k$ 的形式。例如，$\\texttt{aaaabccdddd}$ 被压缩成 $\\texttt{a4b1c2d4}$。\n", "inputFormat": "第一行，一个只含小写字母和数字的压缩后的字符串 $s'$。\n\n第二行，一个非负整数 $c$。", "outputFormat": "一个小写字母，表示答案。", "hint": "\n#### 样例解释\n\n- 样例 $1$ 解释：$\\texttt{r2d2}$ 压缩前是 $\\texttt{rrdd}$。\n\n重复无数多次即为 $\\texttt{rrddrrdd\\textcolor{red}{r}rdd}\\cdots$。\n\n- 样例 $2$ 解释：$\\texttt{a4b1c2d10}$ 压缩前是 $\\texttt{aaaabccdddddddddd}$。\n\n\n\n\n#### 子任务\n\n对于 $100\\%$ 的数据，保证：\n\n- $2\\le |s'|\\le 2\\times10^5$；\n- $s'$ 中出现的整数的范围是 $[1,10^{12}]$；\n- $0\\le c\\le 10^{12}$。\n\n---\n\n- $\\text{Subtask 0(0 points})$：样例。\n- $\\text{Subtask 1(6 points})$：\n\t- $0\\le c\\le 2\\times 10^3$；\n\t- $s'$ 中出现的整数的范围是 $[1,9]$；\n    - 压缩前，$s$ 的长度不超过 $2000$。\n- $\\text{Subtask 2(3 points})$：\n\t- $0\\le c\\le 10^6$；\n    - 压缩前，$s$ 的长度不超过 $10^6$。\n- $\\text{Subtask 3(3 points})$：\n    - 压缩前，$s$ 的长度不超过 $10^6$。\n- $\\text{Subtask 4(3 points})$：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P11859", "type": "P", "difficulty": 4, "samples": [["6 3 0\n1 6\n2 9\n3 4\n2 7\n3 9\n1 3", "25"], ["3 2 2\n1 20\n2 30\n1 10\n1 3 2\n2 3 25", "50\n50\n55"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "2025", "CCC（加拿大）"], "title": "[CCC 2025 Senior] 画画 / Pretty Pens", "background": "译自 CCC 2025 Senior T3。本题满分为 $15$。\n", "description": "\n有 $n$ 支笔，$m$ 种颜色。第 $i$ 支笔的**颜色**为 $c_i$，**美丽度**为 $p_i$。\n\n现在要用这些笔来画画。画会用到 $m$ 种颜色，所以要从每种颜色的笔中各选出一支，画的**美丽度**就是选出的笔的美丽度之和。\n\n在下笔前，你可以选择**至多一支**笔，将这支笔的颜色改成 $[1,m]$ 中的任意一种。**画完后，这支笔的颜色将恢复为原本的颜色。**\n\n有 $q$ 次操作：\n\n- $\\texttt{1}$ $i$ $x$：令 $c_i\\gets x$。\n- $\\texttt{2}$ $i$ $y$：令 $p_i\\gets y$。\n\n对于 $i=1,2,\\ldots,q+1$，求出：在完成前 $(i-1)$ 次操作后，用这些笔画出画的美丽度最大值。\n\n再次强调，**画完一幅画后，这支笔的颜色将恢复为原本的颜色。**\n", "inputFormat": "\n第一行，三个非负整数 $n,m,q$。\n\n接下来 $n$ 行，每行两个正整数 $c_i,p_i$。\n\n接下来 $q$ 行，每行三个正整数，描述一个操作。\n\n数据保证，在任意时刻，每种颜色都至少有一支笔。", "outputFormat": "输出 $(q+1)$ 行，第 $i$ 行的正整数表示完成前 $(i-1)$ 次操作后，用这些笔画出画的美丽度最大值。\n", "hint": "\n#### 样例解释\n\n- 样例 $1$ 解释：\n\n起初，有三种颜色的笔：\n\n- 颜色 $1$ 的笔的美丽度为 $3,6$。\n- 颜色 $2$ 的笔的美丽度为 $7,9$。\n- 颜色 $3$ 的笔的美丽度为 $4,9$。\n\n如果不改变笔的颜色，画的最大美丽度为 $6+9+9=24$。\n\n然而，将第 $4$ 支笔的颜色从 $2$ 改成 $1$ 可以获得 $7+9+9=25$ 的美丽度，这也是最优方案。\n\n- 样例 $2$ 解释：\n\n在第一次修改前和第二次修改前，选择第 $1,2$ 支笔是最优的。\n\n在第二次修改后，选择第 $2,3$ 支笔是最优的。\n\n#### 子任务\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le m\\le n\\le 2\\times 10^5$；\n- $0\\le q\\le 2\\times 10^5$；\n- $1\\le c_i,x\\le m$；\n- $1\\le p_i,y\\le 10^9$；\n- $1\\le i\\le n$；\n- 在任意时刻，每种颜色都至少有一支笔。\n\n---\n\n子任务 $0$ 为样例。\n\n| $\\text{Subtask}$ | $n\\le$ |$ m$ | $q\\le $ | 特殊性质 | 得分 |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $2\\times 10^5$ | $\\le 2\\times 10^5$ | $0$ | / | $5$ |\n| $2$ | $2\\times 10^5$ | $=1$ | $\\le 2\\times 10^5$ | / | $2$ |\n| $3$ | $2\\times 10^5$ | $=2$ | $\\le 2\\times 10^5$ | / | $2$ |\n| $4$ | $2\\times 10^5$ | $\\le 10$ | $\\le 2\\times 10^5$ | / | $2$ |\n| $5$ | $2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\text{A}$ | $2$ |\n| $6$ | $2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | / | $2$ |\n\n- 特殊性质 $\\text{A}$：数据保证在任意时刻，$n$ 支笔的美丽度都是两两不同的。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCC 2025 Senior] 画画 / Pretty Pens", "background": "译自 CCC 2025 Senior T3。本题满分为 $15$。\n", "description": "\n有 $n$ 支笔，$m$ 种颜色。第 $i$ 支笔的**颜色**为 $c_i$，**美丽度**为 $p_i$。\n\n现在要用这些笔来画画。画会用到 $m$ 种颜色，所以要从每种颜色的笔中各选出一支，画的**美丽度**就是选出的笔的美丽度之和。\n\n在下笔前，你可以选择**至多一支**笔，将这支笔的颜色改成 $[1,m]$ 中的任意一种。**画完后，这支笔的颜色将恢复为原本的颜色。**\n\n有 $q$ 次操作：\n\n- $\\texttt{1}$ $i$ $x$：令 $c_i\\gets x$。\n- $\\texttt{2}$ $i$ $y$：令 $p_i\\gets y$。\n\n对于 $i=1,2,\\ldots,q+1$，求出：在完成前 $(i-1)$ 次操作后，用这些笔画出画的美丽度最大值。\n\n再次强调，**画完一幅画后，这支笔的颜色将恢复为原本的颜色。**\n", "inputFormat": "\n第一行，三个非负整数 $n,m,q$。\n\n接下来 $n$ 行，每行两个正整数 $c_i,p_i$。\n\n接下来 $q$ 行，每行三个正整数，描述一个操作。\n\n数据保证，在任意时刻，每种颜色都至少有一支笔。", "outputFormat": "输出 $(q+1)$ 行，第 $i$ 行的正整数表示完成前 $(i-1)$ 次操作后，用这些笔画出画的美丽度最大值。\n", "hint": "\n#### 样例解释\n\n- 样例 $1$ 解释：\n\n起初，有三种颜色的笔：\n\n- 颜色 $1$ 的笔的美丽度为 $3,6$。\n- 颜色 $2$ 的笔的美丽度为 $7,9$。\n- 颜色 $3$ 的笔的美丽度为 $4,9$。\n\n如果不改变笔的颜色，画的最大美丽度为 $6+9+9=24$。\n\n然而，将第 $4$ 支笔的颜色从 $2$ 改成 $1$ 可以获得 $7+9+9=25$ 的美丽度，这也是最优方案。\n\n- 样例 $2$ 解释：\n\n在第一次修改前和第二次修改前，选择第 $1,2$ 支笔是最优的。\n\n在第二次修改后，选择第 $2,3$ 支笔是最优的。\n\n#### 子任务\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le m\\le n\\le 2\\times 10^5$；\n- $0\\le q\\le 2\\times 10^5$；\n- $1\\le c_i,x\\le m$；\n- $1\\le p_i,y\\le 10^9$；\n- $1\\le i\\le n$；\n- 在任意时刻，每种颜色都至少有一支笔。\n\n---\n\n子任务 $0$ 为样例。\n\n| $\\text{Subtask}$ | $n\\le$ |$ m$ | $q\\le $ | 特殊性质 | 得分 |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $2\\times 10^5$ | $\\le 2\\times 10^5$ | $0$ | / | $5$ |\n| $2$ | $2\\times 10^5$ | $=1$ | $\\le 2\\times 10^5$ | / | $2$ |\n| $3$ | $2\\times 10^5$ | $=2$ | $\\le 2\\times 10^5$ | / | $2$ |\n| $4$ | $2\\times 10^5$ | $\\le 10$ | $\\le 2\\times 10^5$ | / | $2$ |\n| $5$ | $2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\text{A}$ | $2$ |\n| $6$ | $2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | / | $2$ |\n\n- 特殊性质 $\\text{A}$：数据保证在任意时刻，$n$ 支笔的美丽度都是两两不同的。", "locale": "zh-CN"}}}
{"pid": "P11860", "type": "P", "difficulty": 5, "samples": [["5 7\n1 2 3\n2 3 2\n1 3 6\n3 4 3\n4 5 7\n2 4 1\n2 5 10", "9"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2025", "CCC（加拿大）", "最短路"], "title": "[CCC 2025 Senior] 熔岩路 / Floor is Lava", "background": "译自 CCC 2025 Senior T4。本题满分为 $15$。", "description": "你被困在一个炽热的地牢中。\n\n地牢由 $n$ 个房间组成，房间编号 $1\\sim n$。这些房间通过 $m$ 条**双向**隧道相连，第 $i$ 条**双向**隧道连接房间 $a_i$ 和 $b_i$，且地板被温度为 $c_i$ 的熔岩覆盖。  \n\n为了穿越熔岩隧道，你穿着一双耐热靴子，初始**冷却等级**为 $0$。当你经过温度为 $c$ 的熔岩时，靴子的冷却等级必须**恰好**为 $c$，否则会被烫伤/冻伤。\n\n幸运的是，当你站在一个房间里时，你可以调整靴子的冷却等级，每次增加或减少 $d$ 需要支付 $d$ 枚金币。  \n\n你从房间 $1$ 出发，目标是到达房间 $n$。到出口所需的最小金币花费是多少？", "inputFormat": "第一行，两个正整数 $n,m$。\n\n接下来 $m$ 行，每行三个正整数 $a_i,b_i,c_i$。\n\n数据保证：任意一对房间之间只有至多一条隧道，从房间 $1$ 可以到达任意一个其他的房间。", "outputFormat": "输出一行一个非负整数，表示答案。", "hint": "#### 样例解释\n\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mpdmjywj.png)\n\n地牢的构造如上图所示。\n\n按照 $1\\to 2\\to 3\\to 4\\to 5$ 的路线花费为 $|3-0|+|2-3|+|3-2|+|7-3|=9$，可以证明是最优的。\n\n#### 子任务\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le n,m\\le 2\\times 10^5$；\n- $1\\le a_i,b_i\\le n$；\n- $a_i\\neq b_i$；\n- $1\\le c_i\\le 10^9$；\n- 任意一对房间之间只有至多一条隧道;\n- 从房间 $1$ 可以到达任意一个其他的房间。\n\n---\n\n- $\\text{Subtask 0(0 points)}$：样例。\n- $\\text{Subtask 1(2 points)}$：$m=n-1$。\n- $\\text{Subtask 2(4 points)}$：$1\\le c_i\\le 10$。\n- $\\text{Subtask 3(4 points)}$：每个房间至多连着 $5$ 条隧道。\n- $\\text{Subtask 4(5 points)}$：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCC 2025 Senior] 熔岩路 / Floor is Lava", "background": "译自 CCC 2025 Senior T4。本题满分为 $15$。", "description": "你被困在一个炽热的地牢中。\n\n地牢由 $n$ 个房间组成，房间编号 $1\\sim n$。这些房间通过 $m$ 条**双向**隧道相连，第 $i$ 条**双向**隧道连接房间 $a_i$ 和 $b_i$，且地板被温度为 $c_i$ 的熔岩覆盖。  \n\n为了穿越熔岩隧道，你穿着一双耐热靴子，初始**冷却等级**为 $0$。当你经过温度为 $c$ 的熔岩时，靴子的冷却等级必须**恰好**为 $c$，否则会被烫伤/冻伤。\n\n幸运的是，当你站在一个房间里时，你可以调整靴子的冷却等级，每次增加或减少 $d$ 需要支付 $d$ 枚金币。  \n\n你从房间 $1$ 出发，目标是到达房间 $n$。到出口所需的最小金币花费是多少？", "inputFormat": "第一行，两个正整数 $n,m$。\n\n接下来 $m$ 行，每行三个正整数 $a_i,b_i,c_i$。\n\n数据保证：任意一对房间之间只有至多一条隧道，从房间 $1$ 可以到达任意一个其他的房间。", "outputFormat": "输出一行一个非负整数，表示答案。", "hint": "#### 样例解释\n\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mpdmjywj.png)\n\n地牢的构造如上图所示。\n\n按照 $1\\to 2\\to 3\\to 4\\to 5$ 的路线花费为 $|3-0|+|2-3|+|3-2|+|7-3|=9$，可以证明是最优的。\n\n#### 子任务\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le n,m\\le 2\\times 10^5$；\n- $1\\le a_i,b_i\\le n$；\n- $a_i\\neq b_i$；\n- $1\\le c_i\\le 10^9$；\n- 任意一对房间之间只有至多一条隧道;\n- 从房间 $1$ 可以到达任意一个其他的房间。\n\n---\n\n- $\\text{Subtask 0(0 points)}$：样例。\n- $\\text{Subtask 1(2 points)}$：$m=n-1$。\n- $\\text{Subtask 2(4 points)}$：$1\\le c_i\\le 10$。\n- $\\text{Subtask 3(4 points)}$：每个房间至多连着 $5$ 条隧道。\n- $\\text{Subtask 4(5 points)}$：无特殊限制。", "locale": "zh-CN"}}}
