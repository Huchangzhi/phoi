{"pid": "P9619", "type": "P", "difficulty": 4, "samples": [["3\n1 2 3", "12"], ["6\n1 1 4 5 1 4", "19008"], ["10\n1 1 4 5 1 4 1 9 1 9", "567022588"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "生成树", "Prüfer 序列"], "title": "生成树", "background": "> 我们是未成熟的斗士 现在绝不认输\n>\n> 我们是未成熟的梦想家 现在绝不哭泣", "description": "现给定一个无向完全图 $G(V,E)$ 和一个长度为 $|V|$ 的权值数组 $a$．$a_i$ 表示编号为 $i$ 的节点的权值．\n\n定义一条边 $e(u,v)$ 的边值为 $val(e)$，满足 $val(e)=a_u\\oplus a_v$，也就是边连接的两个节点的权值的异或和；定义 $G$ 的一个生成树 $T(V,E_t)$ 的权值为 $Val(T)$，满足 $Val(T)=\\sum_{e\\in E_t}val(e)$，也就是树上边的边权和．\n\n您需要求出 $\\sum_{T}Val(T)$．即 $G$ 中所有不同生成树的权值的和．\n\n我们认为两棵生成树是不同的，当且仅当两棵树的边集 $E_t$ 不完全相同，即至少存在一条边，满足其仅属于两棵生成树中的其中一棵．", "inputFormat": "包括两行．\n\n第一行是一个整数 $n$，表示 $|V|$，即节点个数．\n\n第二行是 $n$ 个整数，依次为 $a_1\\sim a_n$．", "outputFormat": "一行一个整数．表示你的答案对 $998244353$ 取模．", "hint": "### 样例 #1 说明：\n考虑一共存在三个生成树 $\\{1-2-3\\},\\{1-3-2\\},\\{3-1-2\\}$．\n\n它们的权值分别为 $(1\\oplus 2)+(2\\oplus 3)=4,(1\\oplus 3)+(3\\oplus 2)=3,(3\\oplus 1)+(1\\oplus 2)=5$．\n\n有 $4+3+5=12$．\n\n### 数据点约束\n保证对于所有数据，$1\\le n\\le 10^6$，$0\\le a_i\\le 10^9$．\n|测试点编号|数据范围|特殊性质|\n|:-:|:-:|:-:|\n|$1$||所有 $a_i$ 相等|\n|$2\\sim 5$|$n\\le 4$||\n|$6\\sim 10$|$n\\le 300$||\n|$11\\sim 12$|$n\\le 5\\times 10^4$|$a_i=[i=1]$|\n|$11\\sim 15$|$n\\le 5\\times 10^4$||\n|$16\\sim 20$|||", "locale": "zh-CN", "translations": {"zh-CN": {"title": "生成树", "background": "> 我们是未成熟的斗士 现在绝不认输\n>\n> 我们是未成熟的梦想家 现在绝不哭泣", "description": "现给定一个无向完全图 $G(V,E)$ 和一个长度为 $|V|$ 的权值数组 $a$．$a_i$ 表示编号为 $i$ 的节点的权值．\n\n定义一条边 $e(u,v)$ 的边值为 $val(e)$，满足 $val(e)=a_u\\oplus a_v$，也就是边连接的两个节点的权值的异或和；定义 $G$ 的一个生成树 $T(V,E_t)$ 的权值为 $Val(T)$，满足 $Val(T)=\\sum_{e\\in E_t}val(e)$，也就是树上边的边权和．\n\n您需要求出 $\\sum_{T}Val(T)$．即 $G$ 中所有不同生成树的权值的和．\n\n我们认为两棵生成树是不同的，当且仅当两棵树的边集 $E_t$ 不完全相同，即至少存在一条边，满足其仅属于两棵生成树中的其中一棵．", "inputFormat": "包括两行．\n\n第一行是一个整数 $n$，表示 $|V|$，即节点个数．\n\n第二行是 $n$ 个整数，依次为 $a_1\\sim a_n$．", "outputFormat": "一行一个整数．表示你的答案对 $998244353$ 取模．", "hint": "### 样例 #1 说明：\n考虑一共存在三个生成树 $\\{1-2-3\\},\\{1-3-2\\},\\{3-1-2\\}$．\n\n它们的权值分别为 $(1\\oplus 2)+(2\\oplus 3)=4,(1\\oplus 3)+(3\\oplus 2)=3,(3\\oplus 1)+(1\\oplus 2)=5$．\n\n有 $4+3+5=12$．\n\n### 数据点约束\n保证对于所有数据，$1\\le n\\le 10^6$，$0\\le a_i\\le 10^9$．\n|测试点编号|数据范围|特殊性质|\n|:-:|:-:|:-:|\n|$1$||所有 $a_i$ 相等|\n|$2\\sim 5$|$n\\le 4$||\n|$6\\sim 10$|$n\\le 300$||\n|$11\\sim 12$|$n\\le 5\\times 10^4$|$a_i=[i=1]$|\n|$11\\sim 15$|$n\\le 5\\times 10^4$||\n|$16\\sim 20$|||", "locale": "zh-CN"}}}
{"pid": "P9620", "type": "P", "difficulty": 6, "samples": [["7 8\n1 2\n1 5\n2 3\n2 4\n5 6\n5 7\nReal 3\nReal 4\nReal 6\nReal 7\nWant 7\nReal 2\nReal 5\nWant 3\n", "1\n1\n1\n2\n1\n1\n2\n2\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "歌姬", "background": "> 你如此一来就满足了吗？\n>\n> 没有想过去实现它吗?\n>\n> 为你而设的 为你而设的\n>\n> 可怜的制度化作温柔的义务", "description": "现在 \\*26 的头脑中想着 $n$ 件事情，它们形成一棵树．事情有现实和妄想两种状态．初始时所有事情都是妄想．不妨将事情 $1$ 假设成头脑中这棵树的根．那么一个事情 $u$ 的深度指从事情 $1$ 到事情 $u$ 的简单路径上的事情数（包含端点）．\n\n我们称一个事情的集合 $S$ 为现实联通体，当其满足对于树上任意两个现实事情，其在树上简单路径（包括端点）中的事情都属于 $S$．极小现实连通体，即包含事情数最少的现实连通体．\n\n随着时间推移，事情的状态可能发生一些变动．下面 \\*26 和您提及了 $m$ 次事情的变动．变动分为以下两种不同的情况：\n\n1. `Real u` 第 $u$ 件事情变成现实．\n2. `Want u` 第 $u$ 件事情变成妄想．\n\n每次变动后，\\*26 会向您询问：目前至少还需要额外让几个事情变成妄想，才能使最小现实联通体中深度最小的事情的位置发生改变，或使当前头脑中不存在现实事情．", "inputFormat": "第一行是两个整数 $n, m$ 表示事情个数和变动个数．\n\n接下来 $n - 1$ 行每行两个整数表示树上的一条边．\n\n接下来 $m$ 行形如：`Real u` 或 `Want u`．表示一次思考．其中 $1\\le u\\le n$．", "outputFormat": "共 $m$ 行，每行一个整数，表示第 $i$ 次变动后，您向 \\*26 提供的答案．", "hint": "### 样例 #1 说明\n举例最后一次变动结束后的情况．\n\n此时树上除了事情 $1,3,7$ 是妄想，其余是现实．那么此时的最小现实联通体就是 $\\{1,2,4,5,6\\}$．\n\n$\\{2,4,5,6\\}$ 不是最小现实连通体，因为存在两个现实事件如 $2,6$，其简单路径经过 $1$，而 $1$ 不在 $\\{2,4,5,6\\}$ 这个集合里；$\\{1,2,3,4,5,6\\}$ 同样不是最小现实联通体，因为存在一个现实联通体 $\\{1,2,4,5,6\\}$ 的大小小于它．\n\n当我们令事情 $2,4$ 变成妄想后，现实事情仅剩下 $5,6$，这时最小现实连通体为 $\\{5,6\\}$．其中深度最小的事情由原来的 $1$ 变成了现在的 $5$．可以证明这个策略是最优策略之一．\n\n### 数据点约束\n|数据点编号|数据范围|\n|:-:|:-:|\n|$1,2$|$1\\le n,m \\le 20$|\n|$3,4,5$|$1\\le n,m \\le 300$|\n|$6,7,8$|$1\\le n,m \\le 3000$|\n|$9,10,11,12$|$1\\le n, m \\le 39393$|\n|$13 \\sim 20$|$1\\le n, m \\le 2 \\times 10^5$|\n\n对于所有数据，保证在任意一次操作时，变动之前和变动之后事情的状态不一样．", "locale": "zh-CN", "translations": {"zh-CN": {"title": "歌姬", "background": "> 你如此一来就满足了吗？\n>\n> 没有想过去实现它吗?\n>\n> 为你而设的 为你而设的\n>\n> 可怜的制度化作温柔的义务", "description": "现在 \\*26 的头脑中想着 $n$ 件事情，它们形成一棵树．事情有现实和妄想两种状态．初始时所有事情都是妄想．不妨将事情 $1$ 假设成头脑中这棵树的根．那么一个事情 $u$ 的深度指从事情 $1$ 到事情 $u$ 的简单路径上的事情数（包含端点）．\n\n我们称一个事情的集合 $S$ 为现实联通体，当其满足对于树上任意两个现实事情，其在树上简单路径（包括端点）中的事情都属于 $S$．极小现实连通体，即包含事情数最少的现实连通体．\n\n随着时间推移，事情的状态可能发生一些变动．下面 \\*26 和您提及了 $m$ 次事情的变动．变动分为以下两种不同的情况：\n\n1. `Real u` 第 $u$ 件事情变成现实．\n2. `Want u` 第 $u$ 件事情变成妄想．\n\n每次变动后，\\*26 会向您询问：目前至少还需要额外让几个事情变成妄想，才能使最小现实联通体中深度最小的事情的位置发生改变，或使当前头脑中不存在现实事情．", "inputFormat": "第一行是两个整数 $n, m$ 表示事情个数和变动个数．\n\n接下来 $n - 1$ 行每行两个整数表示树上的一条边．\n\n接下来 $m$ 行形如：`Real u` 或 `Want u`．表示一次思考．其中 $1\\le u\\le n$．", "outputFormat": "共 $m$ 行，每行一个整数，表示第 $i$ 次变动后，您向 \\*26 提供的答案．", "hint": "### 样例 #1 说明\n举例最后一次变动结束后的情况．\n\n此时树上除了事情 $1,3,7$ 是妄想，其余是现实．那么此时的最小现实联通体就是 $\\{1,2,4,5,6\\}$．\n\n$\\{2,4,5,6\\}$ 不是最小现实连通体，因为存在两个现实事件如 $2,6$，其简单路径经过 $1$，而 $1$ 不在 $\\{2,4,5,6\\}$ 这个集合里；$\\{1,2,3,4,5,6\\}$ 同样不是最小现实联通体，因为存在一个现实联通体 $\\{1,2,4,5,6\\}$ 的大小小于它．\n\n当我们令事情 $2,4$ 变成妄想后，现实事情仅剩下 $5,6$，这时最小现实连通体为 $\\{5,6\\}$．其中深度最小的事情由原来的 $1$ 变成了现在的 $5$．可以证明这个策略是最优策略之一．\n\n### 数据点约束\n|数据点编号|数据范围|\n|:-:|:-:|\n|$1,2$|$1\\le n,m \\le 20$|\n|$3,4,5$|$1\\le n,m \\le 300$|\n|$6,7,8$|$1\\le n,m \\le 3000$|\n|$9,10,11,12$|$1\\le n, m \\le 39393$|\n|$13 \\sim 20$|$1\\le n, m \\le 2 \\times 10^5$|\n\n对于所有数据，保证在任意一次操作时，变动之前和变动之后事情的状态不一样．", "locale": "zh-CN"}}}
{"pid": "P9621", "type": "P", "difficulty": 6, "samples": [["0 0\n4 2\n10 20 20 50\n20 10 20 50\n20 20 10 50\n20 50 10 20\n", "530317523"], ["0 280114129\n5 5\n36 23 30 11\n0 52 25 23\n14 61 23 2\n10 41 37 12\n0 12 78 10\n", "898420164"], ["1 114\n5141 919\n", "800181066"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": [], "title": "下次再见", "background": "> 在逝去的季节中 遗失的宝藏\n>\n> 是缺失一角的 珍贵拼图\n>\n> 就像白雪在街道上 温柔地堆积的样子\n>\n> 也将回忆相簿的空白 全部填满吧", "description": "有一首由 $n$ 个圆圈组成的乐曲．玩家会 **等概率随机选定** $1 \\sim n$ 中的一个位置开始游玩，顺序点击那个位置和之后的所有圆圈来完成乐曲的演奏．\n\n对于每个圆圈的点击精准度存在四种判定，分别是 $\\texttt{GREAT,OK,MEH,MISS}$．\n\n存在一种机制：当连续 $K$ 次 $\\texttt{MISS}$ 后，玩家会强制退出游戏；否则玩家会一直游玩直到点击完所有圆圈．\n\n现在给出对于每个圆圈，玩家达成每一种判定的概率：对于第 $i$ 个圆圈，判定 $\\texttt{GREAT},\\texttt{OK},\\texttt{MEH},\\texttt{MISS}$ 的概率分别为 $P_{i,0}/100,\\ P_{i,1}/100,\\ P_{i,2}/100,\\ P_{i,3}/100$．保证 $P_{i,0}+P_{i,1}+P_{i,2}+P_{i,3}=100$．\n\n得分是衡量整段演奏的指标，它的计算方式是，假设整段演奏中出现了 $a$ 次 $\\texttt{GREAT}$，$b$ 次 $\\texttt{OK}$，$c$ 次 $\\texttt{MEH}$，$d$ 次 $\\texttt{MISS}$，那么演奏的得分为 $300a+100b+50c$．\n\n你需要回答玩家得分的期望．\n\n说明：如果强制退出游戏，那么计算得分时，整段演奏包括从开始的点击到最后一次判定 $\\texttt{MISS}$ 的点击为止所有的点击．\n\n在部分数据大小范围较大的测试点上，为了减小输入输出的交互量，我们采用了不同的输入方式．您需要在您的 c++ 代码中加入题目附件中提供的数据生成器．建议在阅读接下来的内容前先浏览一下生成器中提供的函数名称，这可以帮助您更好地理解输入格式．", "inputFormat": "第一行包含两个整数 $Type,seed$．\n\n当 $Type=1$ 的时候，您需要在读入 $seed$ 之后调用 `Ge.init(seed)` 来设置数据生成器的种子．否则您可以忽视 $seed$．\n\n第二行包括两个整数 $n,K$．\n\n接下来分两种情况：\n\n- $Type=0$．接下来 $n$ 行，每行包括 $4$ 个整数，表示 $P_{i,0}\\ P_{i,1}\\ P_{i,2}\\ P_{i,3}$．\n\n- $Type=1$．接下来没有任何输入．您第 $i$ 次调用 ``Ge.get(a,b,c,d)`` 之后，$a,b,c,d$ 的值分别为 $P_{i,0}\\ P_{i,1}\\ P_{i,2}\\ P_{i,3}$．", "outputFormat": "一行一个整数，表示答案 $\\bmod\\ 998244353$．\n\n说明：可以证明，答案能够表示为 $p/q$．您需要输出 $q$ 在 $\\bmod\\ 998244353$ 意义下的逆元和 $p$ 的乘积对 $998244353$ 取模后的结果．", "hint": "|测试点编号|数据范围|特殊性质|\n|:-:|:-:|:-:|\n|$1\\sim 2$|$n\\le 5$||\n|$3\\sim 4$|$n\\le 50$||\n|$5\\sim 6$|$n\\le 10^3$||\n|$7\\sim 8$|$n\\le 10^5,K\\le 10^3$||\n|$9\\sim 10$||$A$|\n|$11\\sim 12$||$B$|\n|$13\\sim 15$|$n,K\\le 5\\times 10^5$||\n|$16\\sim 20$||\n\n$A$：保证所有位置的 $P_{i,3}$ 相等．\n\n$B$：保证对于所有位置，$P_{i,3}$ 等于 $0$ 或等于 $100$．\n\n---\n对于编号在 $1\\sim 15$ 的测试点，$Type=0$；对于编号在 $16\\sim 20$ 的测试点，$Type=1$．\n\n保证，对于全部数据，$0\\le P_{i,0/1/2/3}\\le 100$，$1\\le K\\le n\\le 5\\times 10^6$，$Type=0/1$，$1\\le seed\\le 10^9$．", "locale": "zh-CN", "translations": {"zh-CN": {"title": "下次再见", "background": "> 在逝去的季节中 遗失的宝藏\n>\n> 是缺失一角的 珍贵拼图\n>\n> 就像白雪在街道上 温柔地堆积的样子\n>\n> 也将回忆相簿的空白 全部填满吧", "description": "有一首由 $n$ 个圆圈组成的乐曲．玩家会 **等概率随机选定** $1 \\sim n$ 中的一个位置开始游玩，顺序点击那个位置和之后的所有圆圈来完成乐曲的演奏．\n\n对于每个圆圈的点击精准度存在四种判定，分别是 $\\texttt{GREAT,OK,MEH,MISS}$．\n\n存在一种机制：当连续 $K$ 次 $\\texttt{MISS}$ 后，玩家会强制退出游戏；否则玩家会一直游玩直到点击完所有圆圈．\n\n现在给出对于每个圆圈，玩家达成每一种判定的概率：对于第 $i$ 个圆圈，判定 $\\texttt{GREAT},\\texttt{OK},\\texttt{MEH},\\texttt{MISS}$ 的概率分别为 $P_{i,0}/100,\\ P_{i,1}/100,\\ P_{i,2}/100,\\ P_{i,3}/100$．保证 $P_{i,0}+P_{i,1}+P_{i,2}+P_{i,3}=100$．\n\n得分是衡量整段演奏的指标，它的计算方式是，假设整段演奏中出现了 $a$ 次 $\\texttt{GREAT}$，$b$ 次 $\\texttt{OK}$，$c$ 次 $\\texttt{MEH}$，$d$ 次 $\\texttt{MISS}$，那么演奏的得分为 $300a+100b+50c$．\n\n你需要回答玩家得分的期望．\n\n说明：如果强制退出游戏，那么计算得分时，整段演奏包括从开始的点击到最后一次判定 $\\texttt{MISS}$ 的点击为止所有的点击．\n\n在部分数据大小范围较大的测试点上，为了减小输入输出的交互量，我们采用了不同的输入方式．您需要在您的 c++ 代码中加入题目附件中提供的数据生成器．建议在阅读接下来的内容前先浏览一下生成器中提供的函数名称，这可以帮助您更好地理解输入格式．", "inputFormat": "第一行包含两个整数 $Type,seed$．\n\n当 $Type=1$ 的时候，您需要在读入 $seed$ 之后调用 `Ge.init(seed)` 来设置数据生成器的种子．否则您可以忽视 $seed$．\n\n第二行包括两个整数 $n,K$．\n\n接下来分两种情况：\n\n- $Type=0$．接下来 $n$ 行，每行包括 $4$ 个整数，表示 $P_{i,0}\\ P_{i,1}\\ P_{i,2}\\ P_{i,3}$．\n\n- $Type=1$．接下来没有任何输入．您第 $i$ 次调用 ``Ge.get(a,b,c,d)`` 之后，$a,b,c,d$ 的值分别为 $P_{i,0}\\ P_{i,1}\\ P_{i,2}\\ P_{i,3}$．", "outputFormat": "一行一个整数，表示答案 $\\bmod\\ 998244353$．\n\n说明：可以证明，答案能够表示为 $p/q$．您需要输出 $q$ 在 $\\bmod\\ 998244353$ 意义下的逆元和 $p$ 的乘积对 $998244353$ 取模后的结果．", "hint": "|测试点编号|数据范围|特殊性质|\n|:-:|:-:|:-:|\n|$1\\sim 2$|$n\\le 5$||\n|$3\\sim 4$|$n\\le 50$||\n|$5\\sim 6$|$n\\le 10^3$||\n|$7\\sim 8$|$n\\le 10^5,K\\le 10^3$||\n|$9\\sim 10$||$A$|\n|$11\\sim 12$||$B$|\n|$13\\sim 15$|$n,K\\le 5\\times 10^5$||\n|$16\\sim 20$||\n\n$A$：保证所有位置的 $P_{i,3}$ 相等．\n\n$B$：保证对于所有位置，$P_{i,3}$ 等于 $0$ 或等于 $100$．\n\n---\n对于编号在 $1\\sim 15$ 的测试点，$Type=0$；对于编号在 $16\\sim 20$ 的测试点，$Type=1$．\n\n保证，对于全部数据，$0\\le P_{i,0/1/2/3}\\le 100$，$1\\le K\\le n\\le 5\\times 10^6$，$Type=0/1$，$1\\le seed\\le 10^9$．", "locale": "zh-CN"}}}
{"pid": "P9622", "type": "P", "difficulty": 6, "samples": [["(No input)", "3 4\n1111\n1010\n1100\n"]], "limits": {"time": [1000], "memory": [524288]}, "tags": ["2020", "Special Judge", "O2优化", "构造", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Ah, It's Yesterday Once More", "background": "", "description": "In 2018, hosted by Nanjing University of Aeronautics and Astronautics (NUAA), the $\\textit{International Collegiate Programming Contest}$ (ICPC) regional was held in Nanjing again after a few years' gap. There were over $400$ teams in the contest and team $\\textit{Power of Two}$ from Tsinghua University won the champion.\n\nTwo years have passed and after the great success in 2018 and 2019, NUAA continues to hold the ICPC Nanjing Regional in 2020. Although we can't gather in Nanjing this time due to the pandemic, we should still be grateful for the hard work done by all staff and volunteers for this contest. Thank you all for your great contribution to this contest!\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/z82ge8hi.png)\n\nIn the 2018 contest, problem K, $\\textit{Kangaroo Puzzle}$, requires the contestants to construct an operation sequence for the game. Let's first recall the content of that problem:\n\n> The puzzle is a grid with $n$ rows and $m$ columns ($1 \\le n, m \\le 20$) and there are some (at least $2$) kangaroos standing in the puzzle. The player's goal is to control them to get together. There are some walls in some cells and the kangaroos cannot enter the cells with walls. The other cells are empty. The kangaroos can move from an empty cell to an adjacent empty cell in four directions: up, down, left, and right. It's guaranteed that kangaroos can reach from any empty cell to any other empty cells by going through adjacent empty cells. It is also guaranteed that there is no cycle in the puzzle -- that is, it's impossible that one kangaroo can move from an empty cell, pass by several distinct empty cells, and then back to the original cell.\n>\n> There is exactly one kangaroo in every empty cell in the beginning and the player can control the kangaroos by pressing the button U, D, L, R on the keyboard. The kangaroos will move simultaneously according to the button you press. For instance, if you press the button R, a kangaroo would move one cell to the right if it exists and is empty, and will stay still if it does not exist or is not empty.\n>\n> In this problem, the contestant needs to construct an operating sequence of at most $5 \\times 10^4$ steps consisting of U, D, L, R only. If after operating these steps in order there are still two kangaroos standing in different cells, the contestant will be given a `Wrong Answer` verdict.\n\nOur dear friend, Kotori, also took part in the contest and submitted a code of randomized algorithm. To her surprise, this simple solution is judged as a correct answer. We now present her solution as follows:\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nstring s = \"UDLR\";\nint main()\n{\n  srand(time(NULL));\n  for (int i = 1; i <= 50000; i++) putchar(s[rand() % 4]);\n  return 0;\n}\n```\n\nFor contestants who are not familiar with C and C++: the above code will output a random string of length $5 \\times 10^4$ consisting only of characters `U`, `D`, `L` and `R`, where each character has equal probability to appear in each position in the string.\n\nKotori suspects that things might not be that simple for this problem, so right now, in this $\\textit{2020 ICPC Nanjing Regional}$ contest, you need to construct an input data to hack her solution. Due to the randomness, your input data only needs to satisfy a successful hacking rate of at least $25\\%$. \n\nFormally speaking, we've prepared $500$ randomly generated strings that each character has equal probability to appear in each position and will use them as the controlling sequence against your answer. For your answer to be accepted, there should be at least $125$ times that after using your answer as the map of cells and the whole controlling sequence is executed, there are still kangaroos in different cells.\n\nNote that your input data should be completely legal. That is to say:\n\n- The map in your answer should not be larger than $20 \\times 20$;\n- Your answer should contain at least two empty cells;\n- All empty cells in your answer should be reachable starting from any empty cell;\n- No cycles consisting of empty cells are allowed.", "inputFormat": "There is no input for this problem. You're on your own!", "outputFormat": "You should first output one line containing two integers $n$ and $m$ ($1 \\le n, m \\le 20$) separated by a space, indicating the number of rows and columns of the map in your answer.\n\nYou should then output $n$ lines where the $i$-th line contains a binary string $s_{i,1}s_{i,2}\\cdots s_{i,m}$ ($s_{i,j} \\in \\{\\text{`0'}, \\text{`1'}\\}$) of length $m$. If $s_{i,j} = \\text{`1'}$ then the cell in the $i$-th row and the $j$-th column is empty; Otherwise that corresponding cell contains a wall and cannot be entered.\n\nNote again that your answer only need to achieve a successful hacking rate of at least $25\\%$. Not that hard isn't it?", "hint": "### Note\nThe sample output we provide you is (obviously) incorrect. It only serves the purpose of showing you the output format. This is a $3 \\times 4$ map with $4$ walls, so there will be $8$ kangaroos in the empty cells at the beginning.", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Ah, It's Yesterday Once More", "background": "", "description": "In 2018, hosted by Nanjing University of Aeronautics and Astronautics (NUAA), the $\\textit{International Collegiate Programming Contest}$ (ICPC) regional was held in Nanjing again after a few years' gap. There were over $400$ teams in the contest and team $\\textit{Power of Two}$ from Tsinghua University won the champion.\n\nTwo years have passed and after the great success in 2018 and 2019, NUAA continues to hold the ICPC Nanjing Regional in 2020. Although we can't gather in Nanjing this time due to the pandemic, we should still be grateful for the hard work done by all staff and volunteers for this contest. Thank you all for your great contribution to this contest!\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/z82ge8hi.png)\n\nIn the 2018 contest, problem K, $\\textit{Kangaroo Puzzle}$, requires the contestants to construct an operation sequence for the game. Let's first recall the content of that problem:\n\n> The puzzle is a grid with $n$ rows and $m$ columns ($1 \\le n, m \\le 20$) and there are some (at least $2$) kangaroos standing in the puzzle. The player's goal is to control them to get together. There are some walls in some cells and the kangaroos cannot enter the cells with walls. The other cells are empty. The kangaroos can move from an empty cell to an adjacent empty cell in four directions: up, down, left, and right. It's guaranteed that kangaroos can reach from any empty cell to any other empty cells by going through adjacent empty cells. It is also guaranteed that there is no cycle in the puzzle -- that is, it's impossible that one kangaroo can move from an empty cell, pass by several distinct empty cells, and then back to the original cell.\n>\n> There is exactly one kangaroo in every empty cell in the beginning and the player can control the kangaroos by pressing the button U, D, L, R on the keyboard. The kangaroos will move simultaneously according to the button you press. For instance, if you press the button R, a kangaroo would move one cell to the right if it exists and is empty, and will stay still if it does not exist or is not empty.\n>\n> In this problem, the contestant needs to construct an operating sequence of at most $5 \\times 10^4$ steps consisting of U, D, L, R only. If after operating these steps in order there are still two kangaroos standing in different cells, the contestant will be given a `Wrong Answer` verdict.\n\nOur dear friend, Kotori, also took part in the contest and submitted a code of randomized algorithm. To her surprise, this simple solution is judged as a correct answer. We now present her solution as follows:\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nstring s = \"UDLR\";\nint main()\n{\n  srand(time(NULL));\n  for (int i = 1; i <= 50000; i++) putchar(s[rand() % 4]);\n  return 0;\n}\n```\n\nFor contestants who are not familiar with C and C++: the above code will output a random string of length $5 \\times 10^4$ consisting only of characters `U`, `D`, `L` and `R`, where each character has equal probability to appear in each position in the string.\n\nKotori suspects that things might not be that simple for this problem, so right now, in this $\\textit{2020 ICPC Nanjing Regional}$ contest, you need to construct an input data to hack her solution. Due to the randomness, your input data only needs to satisfy a successful hacking rate of at least $25\\%$. \n\nFormally speaking, we've prepared $500$ randomly generated strings that each character has equal probability to appear in each position and will use them as the controlling sequence against your answer. For your answer to be accepted, there should be at least $125$ times that after using your answer as the map of cells and the whole controlling sequence is executed, there are still kangaroos in different cells.\n\nNote that your input data should be completely legal. That is to say:\n\n- The map in your answer should not be larger than $20 \\times 20$;\n- Your answer should contain at least two empty cells;\n- All empty cells in your answer should be reachable starting from any empty cell;\n- No cycles consisting of empty cells are allowed.", "inputFormat": "There is no input for this problem. You're on your own!", "outputFormat": "You should first output one line containing two integers $n$ and $m$ ($1 \\le n, m \\le 20$) separated by a space, indicating the number of rows and columns of the map in your answer.\n\nYou should then output $n$ lines where the $i$-th line contains a binary string $s_{i,1}s_{i,2}\\cdots s_{i,m}$ ($s_{i,j} \\in \\{\\text{`0'}, \\text{`1'}\\}$) of length $m$. If $s_{i,j} = \\text{`1'}$ then the cell in the $i$-th row and the $j$-th column is empty; Otherwise that corresponding cell contains a wall and cannot be entered.\n\nNote again that your answer only need to achieve a successful hacking rate of at least $25\\%$. Not that hard isn't it?", "hint": "### Note\nThe sample output we provide you is (obviously) incorrect. It only serves the purpose of showing you the output format. This is a $3 \\times 4$ map with $4$ walls, so there will be $8$ kangaroos in the empty cells at the beginning.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Ah, It's Yesterday Once More", "background": "", "description": "2018 年，由南京航空航天大学（NUAA）主办的 $\\textit{国际大学生程序设计竞赛}$（ICPC）区域赛在南京再次举行，这是在经过几年的间隔后再次举办。比赛中有超过 $400$ 支队伍参加，清华大学的队伍 $\\textit{Power of Two}$ 获得了冠军。\n\n两年过去了，在 2018 年和 2019 年取得巨大成功后，NUAA 继续在 2020 年举办 ICPC 南京区域赛。尽管由于疫情我们这次无法在南京聚集，但我们仍应感谢所有工作人员和志愿者为这次比赛所做的辛勤工作。感谢你们为这次比赛做出的巨大贡献！\n\n在 2018 年的比赛中，问题 K，$\\textit{袋鼠拼图}$，要求参赛者为游戏构建一个操作序列。让我们先回顾一下该问题的内容：\n\n> 这个拼图是一个有 $n$ 行 $m$ 列的网格（$1 \\le n, m \\le 20$），其中有一些（至少 $2$ 只）袋鼠站在拼图中。玩家的目标是控制它们聚集在一起。某些单元格中有墙，袋鼠不能进入有墙的单元格。其他单元格是空的。袋鼠可以从一个空单元格移动到相邻的空单元格，方向有四个：上、下、左、右。保证袋鼠可以通过相邻的空单元格从任何空单元格到达任何其他空单元格。还保证拼图中没有循环——也就是说，不可能有袋鼠从一个空单元格出发，经过几个不同的空单元格，然后回到原来的单元格。\n\n> 每个空单元格开始时恰好有一只袋鼠，玩家可以通过按键盘上的 U、D、L、R 按钮来控制袋鼠。袋鼠将根据您按下的按钮同时移动。例如，如果您按下按钮 R，袋鼠会向右移动一个单元格，如果存在且为空，否则将保持不动。\n\n> 在这个问题中，参赛者需要构建一个最多包含 $5 \\times 10^4$ 步的操作序列，只能由 U、D、L、R 组成。如果按顺序操作这些步骤后，仍然有两只袋鼠站在不同的单元格中，参赛者将得到一个 `Wrong Answer` 判定。\n\n我们的亲爱朋友 Kotori 也参加了比赛，并提交了一段随机算法的代码。令她惊讶的是，这个简单的解决方案被判定为正确答案。我们现在展示她的解决方案如下：\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nstring s = \"UDLR\";\nint main()\n{\n  srand(time(NULL));\n  for (int i = 1; i <= 50000; i++) putchar(s[rand() % 4]);\n  return 0;\n}\n```\n\n对于不熟悉 C 和 C++ 的参赛者：上述代码将输出一个长度为 $5 \\times 10^4$ 的随机字符串，仅由字符 `U`、`D`、`L` 和 `R` 组成，其中每个字符在字符串中的每个位置出现的概率相等。\n\nKotori 怀疑这个问题可能没有那么简单，所以现在，在这次 $\\textit{2020 ICPC 南京区域赛}$ 中，你需要构造一个输入数据来破解她的解决方案。由于随机性，您的输入数据只需满足至少 $25\\%$ 的成功破解率。\n\n正式地说，我们准备了 $500$ 个随机生成的字符串，每个字符在每个位置出现的概率相等，并将它们用作控制序列来对抗您的答案。为了使您的答案被接受，在使用您的答案作为单元格地图并执行整个控制序列后，至少有 $125$ 次袋鼠仍在不同的单元格中。\n\n请注意，您的输入数据必须完全合法。也就是说：\n\n- 您答案中的地图不应大于 $20 \\times 20$；\n- 您的答案应至少包含两个空单元格；\n- 您答案中的所有空单元格应从任何空单元格开始是可达的；\n- 不允许存在由空单元格组成的循环。", "inputFormat": "本题没有输入。你需要自己解决！", "outputFormat": "您应首先输出一行，包含两个整数 $n$ 和 $m$（$1 \\le n, m \\le 20$），用空格分隔，表示您答案中的地图的行数和列数。\n\n然后您应输出 $n$ 行，其中第 $i$ 行包含一个长度为 $m$ 的二进制字符串 $s_{i,1}s_{i,2}\\cdots s_{i,m}$（$s_{i,j} \\in \\{\\text{`0'}, \\text{`1'}\\}$）。如果 $s_{i,j} = \\text{`1'}`，则第 $i$ 行第 $j$ 列的单元格是空的；否则，该对应单元格包含墙壁，无法进入。\n\n再次注意，您的答案只需达到至少 $25\\%$ 的成功破解率。不是很难，对吧？", "hint": "### 注意\n\n我们提供的示例输出（显然）是错误的。它仅用于向您展示输出格式。这是一个 $3 \\times 4$ 的地图，开始时有 $4$ 墙，因此在空单元格中将有 $8$ 只袋鼠。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9623", "type": "P", "difficulty": 7, "samples": [["2\n10 4\nbaaabbabba\n2 8 3\n1 1 1\n2 3 2\n2 5 4\n20 3\ncccbccbadaacbbbcccab\n14 17 16\n3 20 17\n17 20 18\n", "2\n1\n2\n3\n4\n15\n3\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "2020", "O2优化", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Baby's First Suffix Array Problem", "background": "", "description": "\nA suffix array for string $s$ of length $n$ is a permutation $sa$ of integers from $1$ to $n$ such that $s[sa_1.. n], s[sa_2..n], \\dots, s[sa_n..n]$ is the list of non-empty suffixes of $s$ sorted in lexicographical order. The rank table for suffixex of $s$ is a permutation $rank$ of integers from $1$ to $n$ such that $rank_{sa_i} = i$.\n\nKotori has a string $s=s_1s_2\\dots s_n$. She would like to ask $m$ queries. And in the $i$-th query, a substring $x=s[l_i..r_i]$ of $s$ is given, Kotori would like to know the rank of suffix $s[k_i..r_i]$ of $x$.\n\nNote $s[l..r]$ means the substring of $s$ which starts from the $l$-th position and ends at the $r$-th position, both inclusive.\n", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $m$ ($1 \\le n, m \\le 5 \\times 10^4$) -- the length of the string and the number of queries.\n\nThe second line contains a string $s$ of length $n$ consisting only of lowercase English letters.\n\nEach of the next $m$ lines contains three integers $l_i$, $r_i$ and $k_i$ ($1 \\le l_i \\le r_i \\le n, l_i \\le k_i \\le r_i$) denoting a query.\n\nIt is guaranteed that neither the sum of $n$ or the sum of $m$ of all test cases will exceed $5 \\times 10^4$.", "outputFormat": "For each query output one line containing one integer denoting the answer.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Baby's First Suffix Array Problem", "background": "", "description": "\nA suffix array for string $s$ of length $n$ is a permutation $sa$ of integers from $1$ to $n$ such that $s[sa_1.. n], s[sa_2..n], \\dots, s[sa_n..n]$ is the list of non-empty suffixes of $s$ sorted in lexicographical order. The rank table for suffixex of $s$ is a permutation $rank$ of integers from $1$ to $n$ such that $rank_{sa_i} = i$.\n\nKotori has a string $s=s_1s_2\\dots s_n$. She would like to ask $m$ queries. And in the $i$-th query, a substring $x=s[l_i..r_i]$ of $s$ is given, Kotori would like to know the rank of suffix $s[k_i..r_i]$ of $x$.\n\nNote $s[l..r]$ means the substring of $s$ which starts from the $l$-th position and ends at the $r$-th position, both inclusive.\n", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $m$ ($1 \\le n, m \\le 5 \\times 10^4$) -- the length of the string and the number of queries.\n\nThe second line contains a string $s$ of length $n$ consisting only of lowercase English letters.\n\nEach of the next $m$ lines contains three integers $l_i$, $r_i$ and $k_i$ ($1 \\le l_i \\le r_i \\le n, l_i \\le k_i \\le r_i$) denoting a query.\n\nIt is guaranteed that neither the sum of $n$ or the sum of $m$ of all test cases will exceed $5 \\times 10^4$.", "outputFormat": "For each query output one line containing one integer denoting the answer.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Baby's First Suffix Array Problem", "background": "", "description": "对于长度为 $n$ 的字符串 $s$ ，它的后缀数组是一个由 $1$ 到 $n$ 的整数组成的排列 $sa$ ，使得 $s[sa_1.. n], s[sa_2..n], \\dots, s[sa_n..n]$ 是按照字典序排序的 $s$ 的非空后缀列表。字符串 $s$ 的后缀的排名表是一个由 $1$ 到 $n$ 的整数组成的排列 $rank$ ，使得 $rank_{sa_i} = i$ 。\n\n小鸟 Kotori 有一个字符串 $s = s_1s_2\\dots s_n$ 。她想要进行 $m$ 次询问。在第 $i$ 次询问中，会给出 $s$ 的一个子串 $x = s[l_i..r_i]$ ，Kotori 想要知道 $x$ 的后缀 $s[k_i..r_i]$ 的排名。\n\n注意，$s[l..r]$ 表示 $s$ 的从第 $l$ 个位置开始到第 $r$ 个位置结束的子串（包括第 $l$ 个和第 $r$ 个位置）。", "inputFormat": "有多组测试数据。输入的第一行包含一个整数 $T$ ，表示测试数据的组数。对于每组测试数据：\n\n第一行包含两个整数 $n$ 和 $m$（$1 \\le n, m \\le 5 \\times 10^4$）—— 字符串的长度和询问的次数。\n\n第二行包含一个长度为 $n$ 且仅由小写英文字母组成的字符串 $s$ 。\n\n接下来 $m$ 行中的每一行都包含三个整数 $l_i$ 、$r_i$ 和 $k_i$（$1 \\le l_i \\le r_i \\le n, l_i \\le k_i \\le r_i$），表示一次询问。\n\n保证所有测试数据的 $n$ 的总和以及 $m$ 的总和都不会超过 $5 \\times 10^4$ 。", "outputFormat": "对于每次询问，输出一行，包含一个整数，表示答案。", "hint": "### 注意\n\n题面翻译由 Doubao 提供。", "locale": "zh-CN"}}}
{"pid": "P9624", "type": "P", "difficulty": 6, "samples": [["3\n2\n0 1\n1 0\n4\n1 1\n-3 -3\n4 -4\n-2 2\n4\n1 100\n3 100\n-100 1\n3 -100\n", "0\n8\n4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "线段树", "二分", "O2优化", "ICPC", "吉司机线段树 segment tree beats", "南京"], "title": "[ICPC 2020 Nanjing R] Certain Scientific Railgun", "background": "", "description": "Misaka Mikoto is the third-ranked Level 5 esper in $\\textit{Academy City}$ and has been nicknamed $\\textit{Railgun}$ due to her signature move. One day, several evil robots invade Academy City and Misaka is planning to terminate all of them.\n\nConsider Academy City as a 2-dimensional plane. There are $n$ robots in total and the position of the $i$-th robot is $(x_i, y_i)$. Misaka will start moving from $(0, 0)$ and her railgun ability will terminate all robots sharing the same $x$- or $y$-coordinate with her. More formally, if Misaka is now located at $(x_m, y_m)$, all robots whose $x_i = x_m$ or $y_i = y_m$ will be terminated.\n\nAs Misaka hates decimals and Euclidean geometry, she will only move from one integer point to another integer point and can only move horizontally (parallel to the $x$-axis) or vertically (parallel to the $y$-axis). As moving among the city is quite tiresome, Misaka asks you to calculate the minimum distance she has to move to terminate all robots.\n\nRecall that an integer point is a point whose $x$-coordinate and $y$-coordinate are both integers.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains an integer $n$ ($1 \\leq n \\leq 10^5)$ indicating the number of robots.\n\nFor the following $n$ lines, the $i$-th line contains two integers $x_i$ and $y_i$ ($-10^9 \\le x_i, y_i \\le 10^9$) indicating the position of the $i$-th robot.\n\nIt is guaranteed that the sum of $n$ of all test cases will not exceed $10^5$.", "outputFormat": "For each test case output one line containing one integer indicating the minimum distance Misaka needs to move to terminate all robots.", "hint": "### Note\n\nFor the second sample test case, Misaka should first go to $(0, 1)$, then to $(0, 2)$, then to $(0, -3)$, then to $(0, -4)$.\n\nFor the third sample test case, Misaka should first go to $(1, 0)$, then to $(1, 1)$, then to $(3, 1)$.", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Certain Scientific Railgun", "background": "", "description": "Misaka Mikoto is the third-ranked Level 5 esper in $\\textit{Academy City}$ and has been nicknamed $\\textit{Railgun}$ due to her signature move. One day, several evil robots invade Academy City and Misaka is planning to terminate all of them.\n\nConsider Academy City as a 2-dimensional plane. There are $n$ robots in total and the position of the $i$-th robot is $(x_i, y_i)$. Misaka will start moving from $(0, 0)$ and her railgun ability will terminate all robots sharing the same $x$- or $y$-coordinate with her. More formally, if Misaka is now located at $(x_m, y_m)$, all robots whose $x_i = x_m$ or $y_i = y_m$ will be terminated.\n\nAs Misaka hates decimals and Euclidean geometry, she will only move from one integer point to another integer point and can only move horizontally (parallel to the $x$-axis) or vertically (parallel to the $y$-axis). As moving among the city is quite tiresome, Misaka asks you to calculate the minimum distance she has to move to terminate all robots.\n\nRecall that an integer point is a point whose $x$-coordinate and $y$-coordinate are both integers.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains an integer $n$ ($1 \\leq n \\leq 10^5)$ indicating the number of robots.\n\nFor the following $n$ lines, the $i$-th line contains two integers $x_i$ and $y_i$ ($-10^9 \\le x_i, y_i \\le 10^9$) indicating the position of the $i$-th robot.\n\nIt is guaranteed that the sum of $n$ of all test cases will not exceed $10^5$.", "outputFormat": "For each test case output one line containing one integer indicating the minimum distance Misaka needs to move to terminate all robots.", "hint": "### Note\n\nFor the second sample test case, Misaka should first go to $(0, 1)$, then to $(0, 2)$, then to $(0, -3)$, then to $(0, -4)$.\n\nFor the third sample test case, Misaka should first go to $(1, 0)$, then to $(1, 1)$, then to $(3, 1)$.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Certain Scientific Railgun", "background": "", "description": "御坂美琴是“学园都市”中排名第三的 Level 5 超能力者，由于她的标志性招式而被昵称为“Railgun”。一天，几个邪恶的机器人入侵了学园都市，御坂计划消灭它们。  \n\n将学园都市视为一个二维平面。总共有 $n$ 个机器人，第 $i$ 个机器人的位置是 $(x_i, y_i)$。御坂将从 $(0, 0)$ 开始移动，她的 Railgun 能力将消灭所有与她共享相同 $x$ 或 $y$ 坐标的机器人。更正式地说，如果御坂现在位于 $(x_m, y_m)$，则所有 $x_i = x_m$ 或 $y_i = y_m$ 的机器人将被消灭。\n\n由于御坂讨厌小数和欧几里得几何，她只会从一个整数点移动到另一个整数点，并且只能水平（平行于 $x$ 轴）或垂直（平行于 $y$ 轴）移动。由于在城市中移动相当累人，御坂请你计算她需要移动的最小距离以消灭所有机器人。\n\n请记住，整数点是指 $x$ 坐标和 $y$ 坐标都是整数的点。", "inputFormat": "有多个测试用例。输入的第一行包含一个整数 $T$，表示测试用例的数量。对于每个测试用例：\n\n第一行包含一个整数 $n$ ($1 \\leq n \\leq 10^5$)，表示机器人的数量。\n\n接下来的 $n$ 行中，第 $i$ 行包含两个整数 $x_i$ 和 $y_i$ ($-10^9 \\le x_i, y_i \\le 10^9$)，表示第 $i$ 个机器人的位置。\n\n保证所有测试用例的 $n$ 之和不超过 $10^5$。", "outputFormat": "对于每个测试用例，输出一行，包含一个整数，表示御坂需要移动的最小距离以消灭所有机器人。", "hint": "### 提示\n\n对于第二个样例测试用例，御坂应该先到 $(0, 1)$，然后到 $(0, 2)$，再到 $(0, -3)$，最后到 $(0, -4)$。\n\n对于第三个样例测试用例，御坂应该先到 $(1, 0)$，然后到 $(1, 1)$，再到 $(3, 1)$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9625", "type": "P", "difficulty": 6, "samples": [["2\n6 9\n1 2\n1 3\n1 4\n2 3\n2 4\n3 4\n4 5\n4 6\n4 6\n3 4\n1 3\n2 3\n3 3\n1 2\n", "Yes\n1 2\n1 3\n1 4\n4 5\n4 6\nNo\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["图论", "2020", "Special Judge", "O2优化", "构造", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Degree of Spanning Tree", "background": "", "description": "Given an undirected connected graph with $n$ vertices and $m$ edges, your task is to find a spanning tree of the graph such that for every vertex in the spanning tree its degree is not larger than $\\frac{n}{2}$.\n\nRecall that the degree of a vertex is the number of edges it is connected to.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $m$ ($2 \\le n \\le 10^5$, $n-1 \\le m \\le 2 \\times 10^5$) indicating the number of vertices and edges in the graph.\n\nFor the following $m$ lines, the $i$-th line contains two integers $u_i$ and $v_i$ ($1 \\le u_i, v_i \\le n$) indicating that there is an edge connecting vertex $u_i$ and $v_i$. Please note that there might be self loops or multiple edges.\n\nIt's guaranteed that the given graph is connected. It's also guaranteed that the sum of $n$ of all test cases will not exceed $5 \\times 10^5$, also the sum of $m$ of all test cases will not exceed $10^6$.\n", "outputFormat": "For each test case, if such spanning tree exists first output ``Yes`` in one line, then for the following $(n-1)$ lines print two integers $p_i$ and $q_i$ on the $i$-th line separated by one space, indicating that there is an edge connecting vertex $p_i$ and $q_i$ in the spanning tree. If no valid spanning tree exists just output ``No`` in one line.\n", "hint": "### Note\n\nFor the first sample test case, the maximum degree among all vertices in the spanning tree is 3 (both vertex 1 and vertex 4 has a degree of 3). As $3 \\le \\frac{6}{2}$ this is a valid answer.\n\nFor the second sample test case, it's obvious that any spanning tree will have a vertex with degree of 2, as $2 > \\frac{3}{2}$ no valid answer exists.\n", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Degree of Spanning Tree", "background": "", "description": "Given an undirected connected graph with $n$ vertices and $m$ edges, your task is to find a spanning tree of the graph such that for every vertex in the spanning tree its degree is not larger than $\\frac{n}{2}$.\n\nRecall that the degree of a vertex is the number of edges it is connected to.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $m$ ($2 \\le n \\le 10^5$, $n-1 \\le m \\le 2 \\times 10^5$) indicating the number of vertices and edges in the graph.\n\nFor the following $m$ lines, the $i$-th line contains two integers $u_i$ and $v_i$ ($1 \\le u_i, v_i \\le n$) indicating that there is an edge connecting vertex $u_i$ and $v_i$. Please note that there might be self loops or multiple edges.\n\nIt's guaranteed that the given graph is connected. It's also guaranteed that the sum of $n$ of all test cases will not exceed $5 \\times 10^5$, also the sum of $m$ of all test cases will not exceed $10^6$.\n", "outputFormat": "For each test case, if such spanning tree exists first output ``Yes`` in one line, then for the following $(n-1)$ lines print two integers $p_i$ and $q_i$ on the $i$-th line separated by one space, indicating that there is an edge connecting vertex $p_i$ and $q_i$ in the spanning tree. If no valid spanning tree exists just output ``No`` in one line.\n", "hint": "### Note\n\nFor the first sample test case, the maximum degree among all vertices in the spanning tree is 3 (both vertex 1 and vertex 4 has a degree of 3). As $3 \\le \\frac{6}{2}$ this is a valid answer.\n\nFor the second sample test case, it's obvious that any spanning tree will have a vertex with degree of 2, as $2 > \\frac{3}{2}$ no valid answer exists.\n", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Degree of Spanning Tree", "background": "", "description": "给定一张 $n$ 个点 $m$ 条边的无向图，求一个生成树满足每个点的度数都不大于 $\\frac{n}{2}$。", "inputFormat": "多组数据，第一行，一个整数 $t$ 代表数据组数。\n\n对于每组数据：\n\n- 第一行两个整数 $n$, $m$，代表边数和点数；\n- 接下来 $m$ 行，输入 $u_i,v_i$ 代表一条边（可能有重边和自环）。", "outputFormat": "对于每组数据：\n\n第一行输出 `Yes` 或 `No` 代表是否可行。\n\n若可行，接下来 $n - 1$ 行输出每条生成树的边，顺序随意。", "hint": "$2 \\leq n \\leq 10^5$，$n - 1\\leq m \\leq 2\\times10^5$，$\\sum n\\leq5\\times10^5$，$\\sum m\\leq10^6$。\n\n保证图连通。", "locale": "zh-CN"}}}
{"pid": "P9626", "type": "P", "difficulty": 3, "samples": [["5\n1 1\nRURULLD\n0 5\nUUU\n0 3\nUUU\n0 2\nUUU\n0 0\nUUU\n", "LDLRUUR\nUUU\nImpossible\nImpossible\nImpossible\n"]], "limits": {"time": [1000, 1000, 1000], "memory": [262144, 262144, 262144]}, "tags": ["2020", "Special Judge", "O2优化", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Evil Coordinate", "background": "", "description": "A robot is standing on an infinite 2-dimensional plane. Programmed with a string $s_1s_2\\cdots s_n$ of length $n$, where $s_i \\in \\{\\text{`U'}, \\text{`D'}, \\text{`L'}, \\text{`R'}\\}$, the robot will start moving from $(0, 0)$ and will follow the instructions represented by the characters in the string.\n\nMore formally, let $(x, y)$ be the current coordinate of the robot. Starting from $(0, 0)$, the robot repeats the following procedure $n$ times. During the $i$-th time:\n\n- If $s_i = \\text{`U'}$ the robot moves from $(x, y)$ to $(x, y+1)$;\n- If $s_i = \\text{`D'}$ the robot moves from $(x, y)$ to $(x, y-1)$;\n- If $s_i = \\text{`L'}$ the robot moves from $(x, y)$ to $(x-1, y)$;\n- If $s_i = \\text{`R'}$ the robot moves from $(x, y)$ to $(x+1, y)$.-\n\nHowever, there is a mine buried under the coordinate $(m_x, m_y)$. If the robot steps onto $(m_x, m_y)$ during its movement, it will be blown up into pieces. Poor robot!\n\nYour task is to rearrange the characters in the string in any order, so that the robot will not step onto $(m_x, m_y)$.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $m_x$ and $m_y$ ($-10^9 \\le m_x, m_y \\le 10^9$) indicating the coordinate of the mine.\n\nThe second line contains a string $s_1s_2\\cdots s_n$ of length $n$ ($1 \\le n \\le 10^5$, $s_i \\in \\{\\text{`U'}, \\text{`D'}, \\text{`L'}, \\text{`R'}\\}$) indicating the string programmed into the robot.\n\nIt's guaranteed that the sum of $n$ of all test cases will not exceed $10^6$.", "outputFormat": "For each test case output one line. If a valid answer exists print the rearranged string, otherwise print ``Impossible`` instead. If there are multiple valid answers you can print any of them.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Evil Coordinate", "background": "", "description": "A robot is standing on an infinite 2-dimensional plane. Programmed with a string $s_1s_2\\cdots s_n$ of length $n$, where $s_i \\in \\{\\text{`U'}, \\text{`D'}, \\text{`L'}, \\text{`R'}\\}$, the robot will start moving from $(0, 0)$ and will follow the instructions represented by the characters in the string.\n\nMore formally, let $(x, y)$ be the current coordinate of the robot. Starting from $(0, 0)$, the robot repeats the following procedure $n$ times. During the $i$-th time:\n\n- If $s_i = \\text{`U'}$ the robot moves from $(x, y)$ to $(x, y+1)$;\n- If $s_i = \\text{`D'}$ the robot moves from $(x, y)$ to $(x, y-1)$;\n- If $s_i = \\text{`L'}$ the robot moves from $(x, y)$ to $(x-1, y)$;\n- If $s_i = \\text{`R'}$ the robot moves from $(x, y)$ to $(x+1, y)$.-\n\nHowever, there is a mine buried under the coordinate $(m_x, m_y)$. If the robot steps onto $(m_x, m_y)$ during its movement, it will be blown up into pieces. Poor robot!\n\nYour task is to rearrange the characters in the string in any order, so that the robot will not step onto $(m_x, m_y)$.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $m_x$ and $m_y$ ($-10^9 \\le m_x, m_y \\le 10^9$) indicating the coordinate of the mine.\n\nThe second line contains a string $s_1s_2\\cdots s_n$ of length $n$ ($1 \\le n \\le 10^5$, $s_i \\in \\{\\text{`U'}, \\text{`D'}, \\text{`L'}, \\text{`R'}\\}$) indicating the string programmed into the robot.\n\nIt's guaranteed that the sum of $n$ of all test cases will not exceed $10^6$.", "outputFormat": "For each test case output one line. If a valid answer exists print the rearranged string, otherwise print ``Impossible`` instead. If there are multiple valid answers you can print any of them.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Evil Coordinate", "background": "", "description": "一个机器人站在一个无限的二维平面上。它被编程为一个长度为 $n$ 的字符串 $s_1s_2\\cdots s_n$，其中 $s_i \\in \\{\\text{`U'}, \\text{`D'}, \\text{`L'}, \\text{`R'}\\}$，机器人将从 $(0, 0)$ 开始移动，并按照字符串中的字符指令进行移动。\n\n更正式地说，设 $(x, y)$ 为机器人的当前位置。机器人从 $(0, 0)$ 开始，重复以下过程 $n$ 次。在第 $i$ 次时：\n\n- 如果 $s_i = \\text{U}$，机器人从 $(x, y)$ 移动到 $(x, y+1)$；\n- 如果 $s_i = \\text{D}$，机器人从 $(x, y)$ 移动到 $(x, y-1)$；\n- 如果 $s_i = \\text{L}$，机器人从 $(x, y)$ 移动到 $(x-1, y)$；\n- 如果 $s_i = \\text{R}$，机器人从 $(x, y)$ 移动到 $(x+1, y)$。\n\n然而，在坐标 $(m_x, m_y)$ 下埋有一个地雷。如果机器人在移动过程中踩到 $(m_x, m_y)$，它将被炸成碎片。可怜的机器人！\n\n你的任务是重新排列字符串中的字符，使得机器人不会踩到 $(m_x, m_y)$。", "inputFormat": "有多个测试用例。输入的第一行包含一个整数 $T$，表示测试用例的数量。对于每个测试用例：\n\n第一行包含两个整数 $m_x$ 和 $m_y$ ($-10^9 \\le m_x, m_y \\le 10^9$)，表示地雷的坐标。\n\n第二行包含一个字符串 $s_1s_2\\cdots s_n$，长度为 $n$ ($1 \\le n \\le 10^5$, $s_i \\in \\{\\text{`U'}, \\text{`D'}, \\text{`L'}, \\text{`R'}\\}$)，表示编程到机器人中的字符串。\n\n保证所有测试用例的 $n$ 的总和不超过 $10^6$。", "outputFormat": "对于每个测试用例输出一行。如果存在有效答案，打印重新排列后的字符串，否则打印 \"Impossible\"。如果有多个有效答案，可以打印其中任意一个。", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9627", "type": "P", "difficulty": 4, "samples": [["3\n1 1 5000\n1 1 1\n1 2 10000", "4.0000000000\n10141.5852891136\n3.0000000000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "Special Judge", "O2优化", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Fireworks", "background": "", "description": "Kotori is practicing making fireworks for the upcoming hanabi taikai$^1$. It takes her $n$ minutes to make a single firework, and as she is not really proficient in making fireworks, each firework only has a probability of $p \\times 10^{-4}$ to be perfect.\n\nAfter she finishes making a firework, she can just start making the next firework, or take $m$ minutes to light all the remaining fireworks finished before. If there is at least one perfect firework among the lit ones, she will be happy and go to rest. Otherwise, she will continue practicing. Can you tell her the minimum expected practicing time before she goes to rest if she takes the optimal strategy?\n\nNotice that no matter how many fireworks remain, it always takes $m$ minutes to light them all.\n\n$^1$ Hanabi taikai: Romaji of the Japanese word ``花火大會``, which means the firework... err... party?", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ ($1 \\le T \\le 10^4$) indicating the number of test cases. For each test case:\n\nThe first and only line contains three integers $n$, $m$ and $p$ ($1 \\le n, m \\le 10^9$, $1 \\le p \\le 10^4$).", "outputFormat": "For each test case, output one line containing one number indicating the minimum expected practicing time.\n\nYour answer will be considered correct if and only if the absolute or relative error does not exceed $10^{-4}$.", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ICPC 2020 Nanjing R] Fireworks", "background": "", "description": "Kotori is practicing making fireworks for the upcoming hanabi taikai$^1$. It takes her $n$ minutes to make a single firework, and as she is not really proficient in making fireworks, each firework only has a probability of $p \\times 10^{-4}$ to be perfect.\n\nAfter she finishes making a firework, she can just start making the next firework, or take $m$ minutes to light all the remaining fireworks finished before. If there is at least one perfect firework among the lit ones, she will be happy and go to rest. Otherwise, she will continue practicing. Can you tell her the minimum expected practicing time before she goes to rest if she takes the optimal strategy?\n\nNotice that no matter how many fireworks remain, it always takes $m$ minutes to light them all.\n\n$^1$ Hanabi taikai: Romaji of the Japanese word ``花火大會``, which means the firework... err... party?", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ ($1 \\le T \\le 10^4$) indicating the number of test cases. For each test case:\n\nThe first and only line contains three integers $n$, $m$ and $p$ ($1 \\le n, m \\le 10^9$, $1 \\le p \\le 10^4$).", "outputFormat": "For each test case, output one line containing one number indicating the minimum expected practicing time.\n\nYour answer will be considered correct if and only if the absolute or relative error does not exceed $10^{-4}$.", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9628", "type": "P", "difficulty": 6, "samples": [["3\n2\n.o\n..\n3\n.x.\nxoo\nox.\n2\noo\noo", "0\n870527216\n485539347"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "图论", "2020", "O2优化", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Go", "background": "", "description": "$\\textit{Go}$ is an adversarial game with the objective of surrounding a larger total area of the board with one's stones than the opponent's. The core idea of the game is the concept of $\\textit{liberty}$, which is an open point, or rather, an intersection of vertical and horizontal lines on the chessboard with no stones on it, bordering the group.\n\nA stone, white or black, is called $\\textit{alive}$ if it has at least one liberty directly orthogonally adjacent (up, down, left, or right), or must be in the same connected group with a stone of the same color which is alive. We say two stones of the same color are directly connected if they're orthogonally adjacent. We say two stones $s_1$ and $s_k$ of the same color are in the same connected group if there exists a sequence of stones $s_1, s_2,\\cdots, s_k$ such that for all $1 \\le i < k$, $s_{i-1}$ and $s_i$ are of the same color and are directly connected.\n\nFor example, in the left part of the below figure, neither of the two white stones is alive, as they're captured by the surrounding black stones; While in the right part, the rightmost white stone is also not alive, even if the leftmost black stone is also not alive.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zjm3icu0.png)\n\nGiven a chessboard with $n$ vertical and $n$ horizontal lines where some stones might be lying on, please calculate the number of white stones captured by the black ones (that is to say, calcaulate the number of white stones not alive). The results for the above examples are $2$ and $1$, respectively.\n\nHowever, our dear friend Kotori thinks that this problem is too simple for our clever contestants to solve, so she would like to heat things up by instead asking you to flip the color of each stone (that is to say, change a black stone to a white one, or vice versa$^1$) independently and find out the corresponding answer after each flip.\n\nBy flipping independently we mean that before flipping the color of a stone, the other stones should change back to their original color. Also note that the data in this problem is not from the real world, which means that the size of the chessboard is not necesssarily $19 \\times 19$, and the number of white and black stones can be any integer.\n\n$^1$ Vice versa: The reverse is also true. Here it can be replaced with ``change a white stone to a black one``. This is a very common phrase in modern English especially in academic writing, so please bear it in mind.\n", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains one integer $n$ ($2\\le n \\le 10^3$) indicating the length of the board side.\n\nFor the next $n$ lines, the $i$-th line contains a string $s_{i,1},s_{i,2},\\cdots,s_{i,n}$ ($s_{i,j}$ $\\in$ $\\{\\text{`x' (ascii: 120)}$, $\\text{`o' (ascii: 111)}$, $\\text{`.' (ascii: 46)}\\}$), where $s_{i,j} = \\text{`x'}$ indicates that the intersection on the $i$-th row and the $j$-th column contains a black stone. Similarly $s_{i, j} = \\text{`o'}$ for a white stone and $s_{i,j} = \\text{`.'}$ for an empty intersection.\n\nIt's guaranteed that the sum of $n$ over all test cases does not exceed $5 \\times 10^3$.", "outputFormat": "For each test case output an integer $E$ modulo $(10^9 + 7)$ which is the answer encoded as follows:\n- Sort all the stones with their row number (from top to bottom) as the primary sort key and their column number (from left to right) as the secondary sort key;\n- $E=\\sum \\limits_{i=1}^m (10^6 + 7)^{m-i}a_i$, where $m$ is the number of stones and $a_i$ is the number of white stones not alive after flipping the color of the $i$-th stone.\n\n$\\underline{\\text{NOTE that the MODULUS and the BASE are} \\textbf{ DIFFERENT}}$. (We're begging you to notice this sentence. If this is not a pdf file I would rather it flashes and twinkles like crazy.)\n", "hint": "For the second sample test case, after flipping the stones in the order of $(1,2)$, $(2,1)$, $(2,2)$, $(2,3)$, $(3,1)$, $(3,2)$, the number of dead white stones are $1$, $0$, $1$, $2$, $0$, $0$, repectively.\n\nFor the third sample test case all stones on the chessboard, black or white, are not alive.", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Go", "background": "", "description": "$\\textit{Go}$ is an adversarial game with the objective of surrounding a larger total area of the board with one's stones than the opponent's. The core idea of the game is the concept of $\\textit{liberty}$, which is an open point, or rather, an intersection of vertical and horizontal lines on the chessboard with no stones on it, bordering the group.\n\nA stone, white or black, is called $\\textit{alive}$ if it has at least one liberty directly orthogonally adjacent (up, down, left, or right), or must be in the same connected group with a stone of the same color which is alive. We say two stones of the same color are directly connected if they're orthogonally adjacent. We say two stones $s_1$ and $s_k$ of the same color are in the same connected group if there exists a sequence of stones $s_1, s_2,\\cdots, s_k$ such that for all $1 \\le i < k$, $s_{i-1}$ and $s_i$ are of the same color and are directly connected.\n\nFor example, in the left part of the below figure, neither of the two white stones is alive, as they're captured by the surrounding black stones; While in the right part, the rightmost white stone is also not alive, even if the leftmost black stone is also not alive.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zjm3icu0.png)\n\nGiven a chessboard with $n$ vertical and $n$ horizontal lines where some stones might be lying on, please calculate the number of white stones captured by the black ones (that is to say, calcaulate the number of white stones not alive). The results for the above examples are $2$ and $1$, respectively.\n\nHowever, our dear friend Kotori thinks that this problem is too simple for our clever contestants to solve, so she would like to heat things up by instead asking you to flip the color of each stone (that is to say, change a black stone to a white one, or vice versa$^1$) independently and find out the corresponding answer after each flip.\n\nBy flipping independently we mean that before flipping the color of a stone, the other stones should change back to their original color. Also note that the data in this problem is not from the real world, which means that the size of the chessboard is not necesssarily $19 \\times 19$, and the number of white and black stones can be any integer.\n\n$^1$ Vice versa: The reverse is also true. Here it can be replaced with ``change a white stone to a black one``. This is a very common phrase in modern English especially in academic writing, so please bear it in mind.\n", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains one integer $n$ ($2\\le n \\le 10^3$) indicating the length of the board side.\n\nFor the next $n$ lines, the $i$-th line contains a string $s_{i,1},s_{i,2},\\cdots,s_{i,n}$ ($s_{i,j}$ $\\in$ $\\{\\text{`x' (ascii: 120)}$, $\\text{`o' (ascii: 111)}$, $\\text{`.' (ascii: 46)}\\}$), where $s_{i,j} = \\text{`x'}$ indicates that the intersection on the $i$-th row and the $j$-th column contains a black stone. Similarly $s_{i, j} = \\text{`o'}$ for a white stone and $s_{i,j} = \\text{`.'}$ for an empty intersection.\n\nIt's guaranteed that the sum of $n$ over all test cases does not exceed $5 \\times 10^3$.", "outputFormat": "For each test case output an integer $E$ modulo $(10^9 + 7)$ which is the answer encoded as follows:\n- Sort all the stones with their row number (from top to bottom) as the primary sort key and their column number (from left to right) as the secondary sort key;\n- $E=\\sum \\limits_{i=1}^m (10^6 + 7)^{m-i}a_i$, where $m$ is the number of stones and $a_i$ is the number of white stones not alive after flipping the color of the $i$-th stone.\n\n$\\underline{\\text{NOTE that the MODULUS and the BASE are} \\textbf{ DIFFERENT}}$. (We're begging you to notice this sentence. If this is not a pdf file I would rather it flashes and twinkles like crazy.)\n", "hint": "For the second sample test case, after flipping the stones in the order of $(1,2)$, $(2,1)$, $(2,2)$, $(2,3)$, $(3,1)$, $(3,2)$, the number of dead white stones are $1$, $0$, $1$, $2$, $0$, $0$, repectively.\n\nFor the third sample test case all stones on the chessboard, black or white, are not alive.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Go", "background": "", "description": "**围棋**是一种对抗性游戏，目的是用自己的石头比对手的石头包围更大的棋盘总面积。游戏的核心理念是**自由**，即一个开放点，或者更确切地说，是棋盘上垂直线和水平线的交叉点，上面没有石头，与群体接壤。\n\n一个白色或黑色的石头，如果它至少有一个直接正交相邻的自由（上、下、左或右），或者必须与一块有生命的相同颜色的石头在同一个连接组中，那么它是有生命的，被称为**活着**。我们说，如果两块颜色相同的石头正交相邻，它们就直接相连。如果存在一系列石头 $s_1,s_2,…,s_k$ ，对于所有 $1\\leq i<k$ ， $s_{i-1}$ 和 $s_i$ 颜色相同且正交相邻，则相同颜色的两块石头 $s_1$ 和 $s_k$ 属于同一连通组。\n\n例如，在下图的左侧，两块白色的石头都没有活着，因为它们被周围的黑色石头捕获了；而在右边的部分，最右边的白色石头也没有生命，即使最左边的黑色石头也没有。\n\n![Go](https://cdn.luogu.com.cn/upload/image_hosting/zjm3icu0.png)\n\n给定一个有 $n$ 条垂直线和 $n$ 条水平线的棋盘，其中可能有一些石头躺在上面，请计算黑色石头捕获的白色石头的数量（也就是说，计算没有生命的白色石头数量）。上述例子的结果分别为 $2$ 和 $1$ 。\n\n然而，我们亲爱的朋友 Kotori 认为这个问题让我们聪明的参赛者解决太简单了，所以她想让你独立翻转每块石头的颜色（也就是说，把黑色的石头变成白色的石头，反之亦然$^1$），并在每次翻转后找到相应的答案。\n\n独立翻转的意思是，在翻转石头的颜色之前，其他石头应该变回原来的颜色。还要注意，这个问题中的数据不是来自真实世界，这意味着棋盘的大小不一定是 $19×19$ ，黑白石头的数量可以是任意整数。\n\n$^1$反之亦然：在这里，它可以用 ```把白色的石头变成黑色的石头``` 来代替。这是现代英语中非常常见的短语，尤其是在学术写作中，所以请记住。", "inputFormat": "有多个测试样例。输入的第一行包含一个整数 $T$ 表示测试样例的数量。对于每个测试样例：\n\n第一行包含一个整数 $n$ ($2\\leq n\\leq 10^3$)，表示棋盘的边长。\n\n对于接下来 $n$ 行，第 $i$ 行包含一个字符串 $s_{i,1},s_{i,2},…,s_{i,n}$ 。其中 $s_{i,j}=‘x’$ 表示第 $i$ 行第 $j$ 列有一个黑石头，$s_{i,j}=‘o’$ 表示第 $i$ 行第 $j$ 列有一个白石头，$s_{i,j}=‘.’$ 表示第 $i$ 行第 $j$ 列是空的。\n\n保证所有测试样例的 $n$ 之和不超过 $5×10^3$ 。", "outputFormat": "对于每个测试用例输出一个整数 $E\\bmod10^9+7$ 作为如下编码的答案：\n\n- 对所有石头进行排序，以其行号（从上到下）为第一关键字，以其列号（从左到右）为第二关键字；\n- $E=\\sum\\limits_{i=1}^m(10^6+7)^{m-i}a_i$ ，其中 $m$ 是石头的数量， $a_i$ 是翻转第 $i$ 次颜色后没有生命的白色石头的数量。\n\n$\\underline{\\textbf{注意}\\text{：\\textsf{模数}和\\textsf{基数}是}\\textbf{不同}{的}}$ 。（我们恳求你注意这句话。如果这不是 pdf 文件，我宁愿它像疯了一样闪烁。）", "hint": "对于第二个测试样例，按照 $(1,2),(2,1),(2,2),(2,3),(3,1),(3,2)$ 的顺序翻转石头后，死亡的白色石头数量分别为 $1,0,1,2,0,0$ 。\n\n对于第三个测试样例，棋盘上的所有石头，无论是黑色还是白色，都不是活着的。", "locale": "zh-CN"}}}
{"pid": "P9629", "type": "P", "difficulty": 5, "samples": [["3\n1 4\n2 2\n3 3", "0\n15\n16485"]], "limits": {"time": [1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144]}, "tags": ["2020", "O2优化", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Harmonious Rectangle", "background": "", "description": "A vertex-colored rectangle is a rectangle whose four vertices are all painted with colors. For a vertex-colored rectangle, it's harmonious if and only if we can find two adjacent vertices with the same color, while the other two vertices also have the same color with each other.\n\nFor example, $\\begin{bmatrix} 1 & 0\\\\ 1 & 0 \\end{bmatrix}$, $\\begin{bmatrix} 0 & 0\\\\ 1 & 1 \\end{bmatrix}$ and $\\begin{bmatrix} 1 & 1\\\\ 1 & 1 \\end{bmatrix}$ are harmonious, while $\\begin{bmatrix} 1 & 0\\\\ 0 & 1 \\end{bmatrix}$ is not (same number for same color, and different numbers for different colors).\n\nFor each point in $\\{(x,y) | 1 \\le x \\le n, 1 \\le y \\le m, x,y \\in \\mathbb{Z}\\}$, where $\\mathbb{Z}$ is the set of all integers, Kotori wants to paint it into one of the three colors: red, blue, yellow. She wonders the number of different ways to color them so that there exists at least one harmonious rectangle formed by the points, whose edges are all parallel to the $x$- or $y$-axis. That is to say, there exists $1 \\le x_1 < x_2 \\le n$ and $1 \\le y_1 < y_2 \\le m$ such that\n\n$$\\begin{cases}\n\\text{color}(x_1, y_1) = \\text{color}(x_1, y_2)\\\\\n\\text{color}(x_2, y_1) = \\text{color}(x_2, y_2)\\\\\n\\end{cases}\n$$ \nor\n$$\\begin{cases}\n\\text{color}(x_1, y_1) = \\text{color}(x_2, y_1)\\\\\n\\text{color}(x_1, y_2) = \\text{color}(x_2, y_2)\\\\\n\\end{cases}\n$$\n\nwhere $\\text{color}(x, y)$ is the color of point $(x, y)$.\n\nTwo coloring plans are considered different if there exists a point having different colors in the two coloring plans.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ ($1 \\le T \\le 10^4$) indicating the number of test cases. For each test case:\n\nThe first and only line contains three integers $n$, $m$($1 \\le n, m \\le 2 \\times 10^3$).", "outputFormat": "For each test case output one line containing one integer indicating the number of different ways of coloring modulo $(10^9 + 7)$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Harmonious Rectangle", "background": "", "description": "A vertex-colored rectangle is a rectangle whose four vertices are all painted with colors. For a vertex-colored rectangle, it's harmonious if and only if we can find two adjacent vertices with the same color, while the other two vertices also have the same color with each other.\n\nFor example, $\\begin{bmatrix} 1 & 0\\\\ 1 & 0 \\end{bmatrix}$, $\\begin{bmatrix} 0 & 0\\\\ 1 & 1 \\end{bmatrix}$ and $\\begin{bmatrix} 1 & 1\\\\ 1 & 1 \\end{bmatrix}$ are harmonious, while $\\begin{bmatrix} 1 & 0\\\\ 0 & 1 \\end{bmatrix}$ is not (same number for same color, and different numbers for different colors).\n\nFor each point in $\\{(x,y) | 1 \\le x \\le n, 1 \\le y \\le m, x,y \\in \\mathbb{Z}\\}$, where $\\mathbb{Z}$ is the set of all integers, Kotori wants to paint it into one of the three colors: red, blue, yellow. She wonders the number of different ways to color them so that there exists at least one harmonious rectangle formed by the points, whose edges are all parallel to the $x$- or $y$-axis. That is to say, there exists $1 \\le x_1 < x_2 \\le n$ and $1 \\le y_1 < y_2 \\le m$ such that\n\n$$\\begin{cases}\n\\text{color}(x_1, y_1) = \\text{color}(x_1, y_2)\\\\\n\\text{color}(x_2, y_1) = \\text{color}(x_2, y_2)\\\\\n\\end{cases}\n$$ \nor\n$$\\begin{cases}\n\\text{color}(x_1, y_1) = \\text{color}(x_2, y_1)\\\\\n\\text{color}(x_1, y_2) = \\text{color}(x_2, y_2)\\\\\n\\end{cases}\n$$\n\nwhere $\\text{color}(x, y)$ is the color of point $(x, y)$.\n\nTwo coloring plans are considered different if there exists a point having different colors in the two coloring plans.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ ($1 \\le T \\le 10^4$) indicating the number of test cases. For each test case:\n\nThe first and only line contains three integers $n$, $m$($1 \\le n, m \\le 2 \\times 10^3$).", "outputFormat": "For each test case output one line containing one integer indicating the number of different ways of coloring modulo $(10^9 + 7)$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Harmonious Rectangle", "background": "", "description": "一个顶点着色的矩形是指四个顶点都被涂上颜色的矩形。对于一个顶点着色的矩形来说，如果我们可以找到两个相邻顶点的颜色相同，而另外两个顶点也互相颜色相同，则称这个矩形是和谐的。\n\n例如，矩阵 \n$\\begin{bmatrix} 1 & 0\\\\ 1 & 0 \\end{bmatrix}$，$\\begin{bmatrix} 0 & 0\\\\ 1 & 1 \\end{bmatrix}$ 和 $\\begin{bmatrix} 1 & 1\\\\ 1 & 1 \\end{bmatrix}$ 都是和谐的，而 $\\begin{bmatrix} 1 & 0\\\\ 0 & 1 \\end{bmatrix}$ 不是（相同的颜色有相同的数字，不同的颜色有不同的数字）。\n\n对于集合中的每个点 $\\{(x,y) |\t1 \\le x \\le n, 1 \\le y \\le m, x,y \\in \\mathbb{Z}\\}$，其中 $\\mathbb{Z}$ 是所有整数的集合，Kotori 想将其涂成三种颜色之一：红色、蓝色或黄色。她想知道有多少种不同的着色方案，使得至少存在一个由这些点形成的边都平行于 $x$ 或 $y$ 轴的和谐矩形。也就是说，存在 $1 \\le x_1 < x_2 \\le n$ 和 $1 \\le y_1 < y_2 \\le m $，满足以下条件之一：\n\n$\\begin{cases} \\text{color}(x_1, y_1) = \\text{color}(x_1, y_2)\\\\ \\text{color}(x_2, y_1) = \\text{color}(x_2, y_2)\\\\ \\end{cases}$\n\n或者\n\n$\\begin{cases} \\text{color}(x_1, y_1) = \\text{color}(x_2, y_1)\\\\ \\text{color}(x_1, y_2) = \\text{color}(x_2, y_2)\\\\ \\end{cases}$\n\n其中 $\\text{color}(x, y)$ 表示点 $(x, y)$ 的颜色。\n\n如果两个着色计划中存在一个点在两个着色计划中颜色不同，那么认为这两个着色计划是不同的。", "inputFormat": "输入包含多个测试用例。第一行输入一个整数 $T$ $(1 \\le T \\le 10^4)$，表示测试用例的数量。对于每个测试用例：\n\n第一行输入三个整数 $n, m$ $(1 \\le n, m \\le 2 \\times 10^3)$，表示边界的大小。", "outputFormat": "对于每个测试用例，输出一行，包含一个整数，表示着色的不同方案数量模 $(10^9 + 7)$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9630", "type": "P", "difficulty": 6, "samples": [["3 2 1\n-2 0 1 0\n-1 4 2 4\n0 1 0 3", "1.000000000000000"], ["2 1 2\n-1 0 1 0\n1 1 0 1", "-1"], ["2 3 7\n-3 0 2 2\n3 1 -2 17", "1.866666666666666"], ["1 100 1\n-100 0 99 0\n", "0.000000000000000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["计算几何", "2020", "Special Judge", "O2优化", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Interested in Skiing", "background": "", "description": "Kotori is interested in skiing. The skiing field is an infinite strip going along $y$-axis on the 2-dimensional plane where all points $(x, y)$ in the field satisfies $-m \\le x \\le m$. When skiing, Kotori cannot move out of the field, which means that the absolute value of his $x$-coordinate should always be no more than $m$. There are also $n$ segments on the ground which are the obstacles and Kotori cannot move across the obstacles either.\n\nKotori will start skiing from $(0, -10^{10^{10^{10^{10}}}})$ (you can regard this $y$-coordinate as a negative infinity) and moves towards the positive direction of the $y$-axis. Her vertical (parallel to the $y$-axis) speed is always $v_y$ which cannot be changed, however she can control her horizontal (parallel to the $x$-axis) speed in the interval of $[-v_x, v_x]$. The time that Kotori changes her velocity can be neglected.\n\nYour task is to help Kotori calculate the minimum value of $v_x^*$ that once $v_x>v_x^*$ she can safely ski through the skiing field without running into the obstacles.", "inputFormat": "There is only one test case in each test file.\n\nThe first line of the input contains three positive integers $n$, $m$ and $v_y$ ($1 \\le n \\le 100$, $1 \\le m \\le 10^4$, $1 \\le v_y \\le 10$), indicating the number of obstacles, the half width of the skiing field and the vertical speed.\n\nFor the following $n$ lines, the $i$-th line contains four integers $x_1$, $y_1$, $x_2$ and $y_2$ ($-m \\le x_1, x_2 \\le m$, $-10^4 \\le y_1, y_2 \\le 10^4$, $x_1 \\ne x_2$ or $y_1 \\ne y_2$) indicating the $i$-th obstacle which is a segment connecting point $(x_1, y_1)$ and $(x_2, y_2)$, both inclusive (that is to say, these two points are also parts of the obstacle and cannot be touched). It's guaranteed that no two obstacles intersect with each other.", "outputFormat": "Output one line containing one number indicating the minimum value of $v_x^*$. If it is impossible for Kotori to pass through the skiing field, output ``-1`` (without quotes) instead.\n\nYour answer will be considered correct if and only if its absolute or relative error does not exceed $10^{-6}$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Interested in Skiing", "background": "", "description": "Kotori is interested in skiing. The skiing field is an infinite strip going along $y$-axis on the 2-dimensional plane where all points $(x, y)$ in the field satisfies $-m \\le x \\le m$. When skiing, Kotori cannot move out of the field, which means that the absolute value of his $x$-coordinate should always be no more than $m$. There are also $n$ segments on the ground which are the obstacles and Kotori cannot move across the obstacles either.\n\nKotori will start skiing from $(0, -10^{10^{10^{10^{10}}}})$ (you can regard this $y$-coordinate as a negative infinity) and moves towards the positive direction of the $y$-axis. Her vertical (parallel to the $y$-axis) speed is always $v_y$ which cannot be changed, however she can control her horizontal (parallel to the $x$-axis) speed in the interval of $[-v_x, v_x]$. The time that Kotori changes her velocity can be neglected.\n\nYour task is to help Kotori calculate the minimum value of $v_x^*$ that once $v_x>v_x^*$ she can safely ski through the skiing field without running into the obstacles.", "inputFormat": "There is only one test case in each test file.\n\nThe first line of the input contains three positive integers $n$, $m$ and $v_y$ ($1 \\le n \\le 100$, $1 \\le m \\le 10^4$, $1 \\le v_y \\le 10$), indicating the number of obstacles, the half width of the skiing field and the vertical speed.\n\nFor the following $n$ lines, the $i$-th line contains four integers $x_1$, $y_1$, $x_2$ and $y_2$ ($-m \\le x_1, x_2 \\le m$, $-10^4 \\le y_1, y_2 \\le 10^4$, $x_1 \\ne x_2$ or $y_1 \\ne y_2$) indicating the $i$-th obstacle which is a segment connecting point $(x_1, y_1)$ and $(x_2, y_2)$, both inclusive (that is to say, these two points are also parts of the obstacle and cannot be touched). It's guaranteed that no two obstacles intersect with each other.", "outputFormat": "Output one line containing one number indicating the minimum value of $v_x^*$. If it is impossible for Kotori to pass through the skiing field, output ``-1`` (without quotes) instead.\n\nYour answer will be considered correct if and only if its absolute or relative error does not exceed $10^{-6}$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Interested in Skiing", "background": null, "description": "Kotori 对滑雪很感兴趣。滑雪场是在二维平面上沿着 $y$ 轴无限延伸的直线，其中场中的所有点 $(x,y)$ 满足 $-m\\le x\\le m$。滑雪时，Kotori 不能离开场地，这意味着他的 $x$ 坐标的绝对值应该始终不超过 $m$。地面上也有 $n$ 个路段是障碍，Kotori 无法越过障碍。\n\nKotori 将从 $(0, -10^{10^{10^{10^{10}}}})$  开始滑雪（你可以将此 $y$ 坐标视为负无穷大），并朝着 $y$ 轴的正方向移动。她的垂直（平行于 $y$ 轴）速度始终是 $v_y$，此值不变，但是她可以在 $[-v_x, v_x]$ 的间隔内控制她的水平（平行于 $x$ 轴的）速度。Kotori 改变速度的时间可以忽略不计。\n\n你的任务是帮助 Kotori 计算 $v_x^*$ 的最小值，即一旦 $v_x>v_x^*$，她就可以安全地穿过滑雪场而不会遇到障碍物。", "inputFormat": "每个测试文件中只有一个测试用例。\n\n输入的第一行包含三个正整数 $n, m$ 和 $v_y$（$1\\le n\\le 100$，$1\\le m\\le 10^4$，$1\\le v_y\\le 10$），分别表示障碍物的数量、滑雪场的半宽和垂直速度。\n\n对于下面的 $n$ 行，第 $i$ 行包含四个整数 $x_1, y_1, x_2$ 和 $y_2$（$-m\\le x_1, x_2\\le m$，$-10^4\\le y_1, y_2\\le 10^4$，$x_1\\ne x_2$ 或 $y_1\\ne y_2$），这四个整数表示第 $i$ 个障碍物，该障碍物是连接点 $(x_1, y_1)$ 和 $(x_2, y_2)$ 的线段，两者都包括在内（也就是说，这两个点也是障碍物的一部分，不能触摸）。保证没有两个障碍物相互交叉。", "outputFormat": "输出一行，其中包含一个数字，表示 $v_x^*$ 的最小值。如果 Kotori 无法通过滑雪场，请输出 `-1`。\n\n当且仅当其绝对或相对误差不超过 $10^{-6}$ 时，您的答案才会被认为是正确的。\n\n------------\n\n翻译来自 [fire_wolf](https://www.luogu.com.cn/user/690669)。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P9631", "type": "P", "difficulty": 6, "samples": [["5 4\n1 2 1 4 1\n2 1 3 1\n1 2 4 3\n2 2 4 4\n2 1 4 4", "1\n0\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "线段树", "O2优化", "ICPC", "吉司机线段树 segment tree beats", "南京"], "title": "[ICPC 2020 Nanjing R] Just Another Game of Stones", "background": "", "description": "Kotori and Umi are playing games of stones, which is hosted by Honoka. The rule is the same as the classic one: There are some piles of stones and the players take turns to remove any positive number of stones from one pile. The one who can't make a legal move loses the game.\n\nThis time however, things will be a little different. As the host, Honoka will prepare the games from $n$ candidate piles of stones, where the $i$-th pile initially has $a_i$ stones. Honoka will perform $q$ operations of the following two types:\n\n- Given three integers $l$, $r$ and $x$, for all $l \\le i \\le r$ change the number of stones in the $i$-th candidate pile to $\\max(b_i, x)$, where $b_i$ is the current number of stones in the $i$-th candidate pile.\n- Given three integers $l$, $r$ and $x$, start a game of stones consisting of $(r-l+2)$ piles where the $i$-th pile contains $b_{l-1+i}$ stones for all $1 \\le i < (r-l+2)$, and the $(r-l+2)$-th pile contains $x$ stones. Note that this operation is only querying for answer and will not affect the state of the $n$ candidate piles of stones.\n\nKotori is always the first to move. As a big fan of Kotori, you would like to know, for each game of stones, the number of ways Kotori can play in the first step to ensure her victory if both players use the best strategy. We consider two ways different if Kotori is taking stones from different piles, or from the same pile but is taking different number of stones.", "inputFormat": "There is only one test case in each test file.\n\nThe first line of the input contains two integers $n$ and $q$ ($1 \\le n, q \\le 2 \\times 10^5$) indicating the number of candidate piles and the number of operations.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$ ($0 \\le a_i \\le 2^{30}-1$) where $a_i$ indicates the initial number of stones in the $i$-th pile.\n\nFor the following $q$ lines, the $i$-th line contains four integers $op_i$, $l_i$, $r_i$ and $x_i$ ($op_i \\in \\{1, 2\\}$, $1 \\le l_i \\le r_i \\le n$, $0 \\le x_i \\le 2^{30}-1$) indicating the $i$-th operation, where $op_i$ is the type of operation and the others are the parameters of the operation. Operations are given in the order they're performed.", "outputFormat": "For each operation of the second type output one line containing one integer indicating the answer.\n", "hint": "For the first operation the players will play a game of stones consisting of $1$, $2$, $1$ and $1$ stone(s) in each pile respectively. The only winning play for Kotori is reduce the pile with $2$ stones to $1$ stone.\n\nAfter the second operation, number of stones in the candidate piles changes to $1$, $3$, $3$, $4$ and $1$ respectively.\n\nFor the fourth operation the players will play a game of stones consisting of $1$, $3$, $3$, $4$ and $4$ stone(s) in each pile respectively. The winning plays for Kotori is to reduce the pile with $1$ stone to $0$ stone, or to reduce any pile with $3$ stones to $2$ stones.", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Just Another Game of Stones", "background": "", "description": "Kotori and Umi are playing games of stones, which is hosted by Honoka. The rule is the same as the classic one: There are some piles of stones and the players take turns to remove any positive number of stones from one pile. The one who can't make a legal move loses the game.\n\nThis time however, things will be a little different. As the host, Honoka will prepare the games from $n$ candidate piles of stones, where the $i$-th pile initially has $a_i$ stones. Honoka will perform $q$ operations of the following two types:\n\n- Given three integers $l$, $r$ and $x$, for all $l \\le i \\le r$ change the number of stones in the $i$-th candidate pile to $\\max(b_i, x)$, where $b_i$ is the current number of stones in the $i$-th candidate pile.\n- Given three integers $l$, $r$ and $x$, start a game of stones consisting of $(r-l+2)$ piles where the $i$-th pile contains $b_{l-1+i}$ stones for all $1 \\le i < (r-l+2)$, and the $(r-l+2)$-th pile contains $x$ stones. Note that this operation is only querying for answer and will not affect the state of the $n$ candidate piles of stones.\n\nKotori is always the first to move. As a big fan of Kotori, you would like to know, for each game of stones, the number of ways Kotori can play in the first step to ensure her victory if both players use the best strategy. We consider two ways different if Kotori is taking stones from different piles, or from the same pile but is taking different number of stones.", "inputFormat": "There is only one test case in each test file.\n\nThe first line of the input contains two integers $n$ and $q$ ($1 \\le n, q \\le 2 \\times 10^5$) indicating the number of candidate piles and the number of operations.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$ ($0 \\le a_i \\le 2^{30}-1$) where $a_i$ indicates the initial number of stones in the $i$-th pile.\n\nFor the following $q$ lines, the $i$-th line contains four integers $op_i$, $l_i$, $r_i$ and $x_i$ ($op_i \\in \\{1, 2\\}$, $1 \\le l_i \\le r_i \\le n$, $0 \\le x_i \\le 2^{30}-1$) indicating the $i$-th operation, where $op_i$ is the type of operation and the others are the parameters of the operation. Operations are given in the order they're performed.", "outputFormat": "For each operation of the second type output one line containing one integer indicating the answer.\n", "hint": "For the first operation the players will play a game of stones consisting of $1$, $2$, $1$ and $1$ stone(s) in each pile respectively. The only winning play for Kotori is reduce the pile with $2$ stones to $1$ stone.\n\nAfter the second operation, number of stones in the candidate piles changes to $1$, $3$, $3$, $4$ and $1$ respectively.\n\nFor the fourth operation the players will play a game of stones consisting of $1$, $3$, $3$, $4$ and $4$ stone(s) in each pile respectively. The winning plays for Kotori is to reduce the pile with $1$ stone to $0$ stone, or to reduce any pile with $3$ stones to $2$ stones.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Just Another Game of Stones", "background": "", "description": "Kotori 和 Umi 正在玩由 Honoka 主持的石子游戏。规则与经典游戏相同：有若干堆石子，玩家轮流从一堆中移走任意数量的石子。不能进行合法移动的玩家输掉游戏。\n\n然而这次情况会有些不同。作为主持人，Honoka 将从 $n$ 个候选石子堆中准备游戏，其中第 $i$ 堆最初有 $a_i$ 个石子。Honoka 将执行 $q$ 次以下两种类型的操作：\n\n- 给定三个整数 $l$、$r$ 和 $x$，对于所有 $l \\le i \\le r$，将第 $i$ 个候选石子堆中的石子数量更改为 $\\max(b_i, x)$，其中 $b_i$ 是当前第 $i$ 个候选石子堆中的石子数量。\n- 给定三个整数 $l$、$r$ 和 $x$，开始一个由 $(r-l+2)$ 堆组成的石子游戏，其中第 $i$ 堆包含 $b_{l-1+i}$ 个石子，$1 \\le i < (r-l+2)$，并且第 $(r-l+2)$ 堆包含 $x$ 个石子。注意，此操作仅查询答案，不会影响 $n$ 个候选石子堆的状态。\n\nKotori 总是第一个行动。作为 Kotori 的忠实粉丝，你想知道对于每个石子游戏，如果双方都使用最佳策略，Kotori 在第一步中确保胜利的方法数。我们认为两种方法不同，如果 Kotori 从不同的堆中取石子，或者从同一堆中取不同数量的石子。", "inputFormat": "每个测试文件中只有一个测试用例。\n\n输入的第一行包含两个整数 $n$ 和 $q$ ($1 \\le n, q \\le 2 \\times 10^5$)，表示候选石子堆的数量和操作的数量。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\cdots, a_n$ ($0 \\le a_i \\le 2^{30}-1$)，其中 $a_i$ 表示第 $i$ 堆的初始石子数量。\n\n接下来的 $q$ 行中，第 $i$ 行包含四个整数 $op_i$, $l_i$, $r_i$ 和 $x_i$ ($op_i \\in \\{1, 2\\}$, $1 \\le l_i \\le r_i \\le n$, $0 \\le x_i \\le 2^{30}-1$)，表示第 $i$ 个操作，其中 $op_i$ 是操作类型，其他是操作的参数。操作按执行顺序给出。", "outputFormat": "对于每个第二种类型的操作，输出一行包含一个整数表示答案。", "hint": "对于第一个操作，玩家将进行一个由 $1$、$2$、$1$ 和 $1$ 个石子组成的石子游戏。Kotori 唯一的获胜方式是将有 $2$ 个石子的堆减少到 $1$ 个石子。\n\n在第二个操作之后，候选石子堆中的石子数量变为 $1$、$3$、$3$、$4$ 和 $1$。\n\n对于第四个操作，玩家将进行一个由 $1$、$3$、$3$、$4$ 和 $4$ 个石子组成的石子游戏。Kotori 的获胜方式是将有 $1$ 个石子的堆减少到 $0$ 个石子，或者将任何有 $3$ 个石子的堆减少到 $2$ 个石子。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9632", "type": "P", "difficulty": 2, "samples": [["5 3", "1 4 5 2 3"], ["1 0", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "Special Judge", "O2优化", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] K Co-prime Permutation", "background": "", "description": "Kotori is very good at math (really?) and she loves playing with permutations and primes.\n\nOne day, she thinks of a special kind of permutation named $\\textit{k co-prime permutation}$. A permutation $p_1,p_2,\\cdots,p_n$ of $n$ is called a $k$ co-prime permutation of $n$ if there exists exactly $k$ integers $i$ such that $1 \\le i \\le n$ and $\\text{gcd}(p_i,i)=1$, where $\\text{gcd}(x,y)$ indicates the greatest common divisor of $x$ and $y$.\n\nGiven $n$ and $k$, please help Kotori construct a $k$ co-prime permutation of $n$ or just report that there is no such permutation.\n\nRecall that a permutation of $n$ is a sequence of length $n$ containing all integers from $1$ to $n$.", "inputFormat": "There is only one test case in each test file.\n\nThe first and only line contains two integers $n$ and $k$ ($1 \\le n \\le 10^6$, $0 \\le k \\le n$).", "outputFormat": "Output one line containing $n$ integers $p_1, p_2, \\cdots, p_n$ separated by one space, indicating the permutation satisfying the given constraints. If no such permutation exists output ``-1`` (without quotes) instead. If there are multiple valid answers you can print any of them.\n\nPlease, DO NOT output extra spaces at the end of each line, otherwise your answer may be considered incorrect!", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] K Co-prime Permutation", "background": "", "description": "Kotori is very good at math (really?) and she loves playing with permutations and primes.\n\nOne day, she thinks of a special kind of permutation named $\\textit{k co-prime permutation}$. A permutation $p_1,p_2,\\cdots,p_n$ of $n$ is called a $k$ co-prime permutation of $n$ if there exists exactly $k$ integers $i$ such that $1 \\le i \\le n$ and $\\text{gcd}(p_i,i)=1$, where $\\text{gcd}(x,y)$ indicates the greatest common divisor of $x$ and $y$.\n\nGiven $n$ and $k$, please help Kotori construct a $k$ co-prime permutation of $n$ or just report that there is no such permutation.\n\nRecall that a permutation of $n$ is a sequence of length $n$ containing all integers from $1$ to $n$.", "inputFormat": "There is only one test case in each test file.\n\nThe first and only line contains two integers $n$ and $k$ ($1 \\le n \\le 10^6$, $0 \\le k \\le n$).", "outputFormat": "Output one line containing $n$ integers $p_1, p_2, \\cdots, p_n$ separated by one space, indicating the permutation satisfying the given constraints. If no such permutation exists output ``-1`` (without quotes) instead. If there are multiple valid answers you can print any of them.\n\nPlease, DO NOT output extra spaces at the end of each line, otherwise your answer may be considered incorrect!", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] K Co-prime Permutation", "background": "", "description": "给定两个整数 $n$ 和 $k$，构造一个 $1 \\sim n$ 的排列 $p_1,p_2,\\cdots,p_n$，使得存在 $k$ 个整数 $i$ 满足 $1 \\le i \\le n$ 且 $\\text{gcd}(p_i,i)=1$。\n\n$\\text{gcd}(x,y)$ 表示 $x$ 和 $y$ 的最大公约数。", "inputFormat": "只有一组测试数据。\n\n第一行输入两个整数 $n$ 和 $k$ $(1 \\le n \\le 10^6, 0 \\le k \\le n)$。", "outputFormat": "输出一行 $n$ 个整数 $p_1, p_2, \\cdots, p_n$，用空格分隔，表示一个满足给定的约束的排列。如果没有存在的排列则输出 ``-1``。如果有多个有效的答案，输出任意一个均可。\n\n请不要在行末输出多余的空格，否则你的答案可能会被认为是错误的。\n\n### 样例 #1\n\n#### 样例输入 #1\n\n```\n5 3\n```\n\n#### 样例输出 #1\n\n```\n1 4 5 2 3\n```\n\n### 样例 #2\n\n#### 样例输入 #2\n\n```\n1 0\n```\n\n#### 样例输出 #2\n\n```\n-1\n```", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9633", "type": "P", "difficulty": 3, "samples": [["3\n2 2\n2 3\n1 4\n6 5\n2 5 3 7 1 7\n3 4 3 1 10\n1 1\n7\n7", "2\n3\nImpossible"]], "limits": {"time": [1000, 1000], "memory": [262144, 262144]}, "tags": ["2020", "O2优化", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Let's Play Curling", "background": "", "description": "Curling is a sport in which players slide stones on a sheet of ice toward a target area. The team with the nearest stone to the center of the target area wins the game.\n\nTwo teams, Red and Blue, are competing on the number axis. After the game there are $(n+m)$ stones remaining on the axis, $n$ of them for the Red team and the other $m$ of them for the Blue. The $i$-th stone of the Red team is positioned at $a_i$ and the $i$-th stone of the Blue team is positioned at $b_i$.\n\nLet $c$ be the position of the center of the target area. From the description above we know that if there exists some $i$ such that $1 \\le i \\le n$ and for all $1 \\le j \\le m$ we have $|c - a_i| < |c - b_j|$ then Red wins the game. What's more, Red is declared to win $p$ points if the number of $i$ satisfying the constraint is exactly $p$.\n\nGiven the positions of the stones for team Red and Blue, your task is to determine the position $c$ of the center of the target area so that Red wins the game and scores as much as possible. Note that $c$ can be any real number, not necessarily an integer.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $m$ ($1 \\le n, m \\le 10^5$) indicating the number of stones for Red and the number of stones for Blue.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$ ($1 \\le a_i \\le 10^9$) indicating the positions of the stones for Red.\n\nThe third line contains $m$ integers $b_1, b_2, \\cdots, b_m$ ($1 \\le b_i \\le 10^9$) indicating the positions of the stones for Blue.\n\nIt's guaranteed that neither the sum of $n$ nor the sum of $m$ will exceed $5 \\times 10^5$.", "outputFormat": "For each test case output one line. If there exists some $c$ so that Red wins and scores as much as possible, output one integer indicating the maximum possible $\\textbf{score}$ of Red (NOT $c$). Otherwise output ``Impossible`` (without quotes) instead.", "hint": "For the first sample test case we can assign $c = 2.5$ so that the stones at position 2 and 3 for Red will score.\n\nFor the second sample test case we can assign $c = 7$ so that the stones at position 5 and 7 for Red will score.", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Let's Play Curling", "background": "", "description": "Curling is a sport in which players slide stones on a sheet of ice toward a target area. The team with the nearest stone to the center of the target area wins the game.\n\nTwo teams, Red and Blue, are competing on the number axis. After the game there are $(n+m)$ stones remaining on the axis, $n$ of them for the Red team and the other $m$ of them for the Blue. The $i$-th stone of the Red team is positioned at $a_i$ and the $i$-th stone of the Blue team is positioned at $b_i$.\n\nLet $c$ be the position of the center of the target area. From the description above we know that if there exists some $i$ such that $1 \\le i \\le n$ and for all $1 \\le j \\le m$ we have $|c - a_i| < |c - b_j|$ then Red wins the game. What's more, Red is declared to win $p$ points if the number of $i$ satisfying the constraint is exactly $p$.\n\nGiven the positions of the stones for team Red and Blue, your task is to determine the position $c$ of the center of the target area so that Red wins the game and scores as much as possible. Note that $c$ can be any real number, not necessarily an integer.", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $m$ ($1 \\le n, m \\le 10^5$) indicating the number of stones for Red and the number of stones for Blue.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$ ($1 \\le a_i \\le 10^9$) indicating the positions of the stones for Red.\n\nThe third line contains $m$ integers $b_1, b_2, \\cdots, b_m$ ($1 \\le b_i \\le 10^9$) indicating the positions of the stones for Blue.\n\nIt's guaranteed that neither the sum of $n$ nor the sum of $m$ will exceed $5 \\times 10^5$.", "outputFormat": "For each test case output one line. If there exists some $c$ so that Red wins and scores as much as possible, output one integer indicating the maximum possible $\\textbf{score}$ of Red (NOT $c$). Otherwise output ``Impossible`` (without quotes) instead.", "hint": "For the first sample test case we can assign $c = 2.5$ so that the stones at position 2 and 3 for Red will score.\n\nFor the second sample test case we can assign $c = 7$ so that the stones at position 5 and 7 for Red will score.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Let's Play Curling", "background": null, "description": "# [ICPC2020 Nanjing R] Let's Play Curling\n\n\n红队和蓝队在冰面上向目标区域滑动冰壶，距离目标区域中心最近的队伍获胜。\n\n两支队伍在一条直线上竞争。比赛结束后，有   $(n+m)$ 个冰壶在直线上, $n$ 个是红队的，剩下 $m$ 个是蓝队的。 红队的第 $i$ 个冰壶被放在 $a_i$ ，蓝队的第 $i$ 个冰壶被放在 $b_i$ 。\n\n设 $c$ 是中心。如果存在一些 $i$ 使得 $1 \\le i \\le n$ 并且对于所有 $1 \\le j \\le m$ 都有 $|c - a_i| < |c - b_j|$ 红队就赢得比赛。另外，如果满足条件的 $i$ 的数目是 $p$ ，则认为红队赢得 $p$ 分。\n\n给你红蓝两队的冰壶的位置，请你确定中心 $c$ 的值，使红队得分最多。注意， $c$ 是任意实数，不一定是整数。", "inputFormat": "有很多测试样例。第一行输入一个整数 $T$ ，表示样例数量。对于每个测试样列：\n\n第一行包括两个整数 $n$ 和 $m$ ($1 \\le n, m \\le 10^5$) 分别表示红队和蓝队的冰壶数量。\n\n第二行包括 $n$ 个整数 $a_1, a_2, \\cdots, a_n$ ($1 \\le a_i \\le 10^9$) 表示红队的冰壶的位置。\n\n第三行包括 $m$ 个整数 $b_1, b_2, \\cdots, b_m$ ($1 \\le b_i \\le 10^9$)表示蓝队的冰壶的位置。\n\n数据保证 $n$ 的总和以及 $m$ 的总和都不会超过 $5 \\times 10^5$ 。", "outputFormat": "每一个测试样列输出一行。如果存在 $c$ 使得红队获胜且得分最多, 输出一个整数表示红队最大 $\\textbf{ 得分 }$ (不是 $c$) 。否则输出 ``Impossible`` ( 不带引号 ) 。\n\n## 样例 #1\n\n### 样例输入 #1\n\n```\n3\n2 2\n2 3\n1 4\n6 5\n2 5 3 7 1 7\n3 4 3 1 10\n1 1\n7\n7\n```\n\n### 样例输出 #1\n\n```\n2\n3\nImpossible\n```", "hint": "对于第一个样例，当 $c = 2.5$ 时，红队的位于 2 和 3 的冰壶可以得分。\n\n对于第二个样例，当 $c = 7$ 时，红队的位于 5 和 7 的冰壶可以得分。", "locale": "zh-CN"}}}
{"pid": "P9634", "type": "P", "difficulty": 5, "samples": [["3\n5\n1 2 3 4\n1 2 3 4 5\n9\n1 2 3 4 3 4 6 6\n8 4 9 4 4 5 2 4 1\n12\n1 2 2 4 5 3 4 3 8 10 11\n9 1 3 5 10 10 7 3 7 9 4 9", "29 16 9 4 1 0\n74 47 35 25 15 11 7 3 1 0\n145 115 93 73 55 42 32 22 14 8 4 1 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2020", "Special Judge", "O2优化", "树形 DP", "ICPC", "南京"], "title": "[ICPC 2020 Nanjing R] Monster Hunter", "background": "", "description": "There is a rooted tree with $n$ vertices and the root vertex is $1$. In each vertex, there is a monster. The hit points of the monster in the $i$-th vertex is $hp_i$.\n\nKotori would like to kill all the monsters. The monster in the $i$-th vertex could be killed if the monster in the direct parent of the $i$-th vertex has been killed. The power needed to kill the $i$-th monster is the sum of $hp_i$ and the hit points of all other living monsters who lives in a vertex $j$ whose direct parent is $i$. Formally, the power equals to \n$$\nhp_i + \\sum_{\\begin{array}{c}\\text{the monster in vertex } j \\text{ is \\bf{alive}} \\\\ \\text{and } i \\text{ is the direct parent of } j \\end{array}} hp_j\n$$\n\nIn addition, Kotori can use some magic spells. If she uses one magic spell, she can kill any monster using $0$ power without any restriction. That is, she can choose a monster even if the monster in the direct parent is alive.\n\nFor each $m=0,1,2,\\cdots,n$, Kotori would like to know, respectively, the minimum total power needed to kill all the monsters if she can use $m$ magic spells.", "inputFormat": "There are multiple test cases. The first line of input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains an integer $n$ ($2 \\le n \\le 2 \\times 10^3$), indicating the number of vertices.\n\nThe second line contains $(n-1)$ integers $p_2,p_3,\\cdots,p_n$ ($1 \\le p_i < i$), where $p_i$ means the direct parent of vertex $i$.\n\nThe third line contains $n$ integers $hp_1,hp_2,\\cdots,hp_n$ ($1 \\le hp_i \\le 10^9$) indicating the hit points of each monster.\n\nIt's guaranteed that the sum of $n$ of all test cases will not exceed $2 \\times 10^3$.", "outputFormat": "For each test case output one line containing $(n+1)$ integers $a_0, a_1, \\cdots, a_n$ separated by a space, where $a_m$ indicates the minimum total power needed to kill all the monsters if Kotori can use $m$ magic spells.\n\nPlease, DO NOT output extra spaces at the end of each line, otherwise your answer may be considered incorrect!", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Nanjing R] Monster Hunter", "background": "", "description": "There is a rooted tree with $n$ vertices and the root vertex is $1$. In each vertex, there is a monster. The hit points of the monster in the $i$-th vertex is $hp_i$.\n\nKotori would like to kill all the monsters. The monster in the $i$-th vertex could be killed if the monster in the direct parent of the $i$-th vertex has been killed. The power needed to kill the $i$-th monster is the sum of $hp_i$ and the hit points of all other living monsters who lives in a vertex $j$ whose direct parent is $i$. Formally, the power equals to \n$$\nhp_i + \\sum_{\\begin{array}{c}\\text{the monster in vertex } j \\text{ is \\bf{alive}} \\\\ \\text{and } i \\text{ is the direct parent of } j \\end{array}} hp_j\n$$\n\nIn addition, Kotori can use some magic spells. If she uses one magic spell, she can kill any monster using $0$ power without any restriction. That is, she can choose a monster even if the monster in the direct parent is alive.\n\nFor each $m=0,1,2,\\cdots,n$, Kotori would like to know, respectively, the minimum total power needed to kill all the monsters if she can use $m$ magic spells.", "inputFormat": "There are multiple test cases. The first line of input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains an integer $n$ ($2 \\le n \\le 2 \\times 10^3$), indicating the number of vertices.\n\nThe second line contains $(n-1)$ integers $p_2,p_3,\\cdots,p_n$ ($1 \\le p_i < i$), where $p_i$ means the direct parent of vertex $i$.\n\nThe third line contains $n$ integers $hp_1,hp_2,\\cdots,hp_n$ ($1 \\le hp_i \\le 10^9$) indicating the hit points of each monster.\n\nIt's guaranteed that the sum of $n$ of all test cases will not exceed $2 \\times 10^3$.", "outputFormat": "For each test case output one line containing $(n+1)$ integers $a_0, a_1, \\cdots, a_n$ separated by a space, where $a_m$ indicates the minimum total power needed to kill all the monsters if Kotori can use $m$ magic spells.\n\nPlease, DO NOT output extra spaces at the end of each line, otherwise your answer may be considered incorrect!", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Nanjing R] Monster Hunter", "background": "", "description": "有一棵有根树，包含 $n$ 个顶点，根顶点是 $1$。每个顶点上都有一个怪物。第 $i$ 个顶点上的怪物的生命值为 $hp_i$。\n\nKotori 想要消灭所有的怪物。第 $i$ 个顶点上的怪物可以被消灭，当且仅当其直接父节点上的怪物已经被消灭。消灭第 $i$ 个怪物所需的力量是 $hp_i$ 加上所有其他活着的怪物的生命值，这些怪物位于以 $i$ 为直接父节点的顶点 $j$ 上。形式化地，所需的力量等于\n$$\nhp_i + \\sum_{\\begin{array}{c}\\text{顶点 } j \\text{ 上的怪物是\\textbf{活着的}} \\\\ \\text{且 } i \\text{ 是 } j \\text{ 的直接父节点} \\end{array}} hp_j\n$$\n\n此外，Kotori 可以使用一些魔法咒语。如果她使用一个魔法咒语，她可以在没有任何限制的情况下使用 $0$ 力量消灭任何怪物。也就是说，她可以选择一个怪物，即使其直接父节点上的怪物还活着。\n\n对于每一个 $m=0,1,2,\\cdots,n$，Kotori 想要分别知道如果她可以使用 $m$ 个魔法咒语，消灭所有怪物所需的最小总力量。", "inputFormat": "有多个测试用例。输入的第一行包含一个整数 $T$，表示测试用例的数量。对于每个测试用例：\n\n第一行包含一个整数 $n$ ($2 \\le n \\le 2 \\times 10^3$)，表示顶点的数量。\n\n第二行包含 $(n-1)$ 个整数 $p_2,p_3,\\cdots,p_n$ ($1 \\le p_i < i$)，其中 $p_i$ 表示顶点 $i$ 的直接父节点。\n\n第三行包含 $n$ 个整数 $hp_1,hp_2,\\cdots,hp_n$ ($1 \\le hp_i \\le 10^9$)，表示每个怪物的生命值。\n\n保证所有测试用例的 $n$ 的总和不超过 $2 \\times 10^3$。", "outputFormat": "对于每个测试用例，输出一行包含 $(n+1)$ 个整数 $a_0, a_1, \\cdots, a_n$，用空格分隔，其中 $a_m$ 表示如果 Kotori 可以使用 $m$ 个魔法咒语，消灭所有怪物所需的最小总力量。\n\n请不要在每行的末尾输出多余的空格，否则你的答案可能会被判为不正确！", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9635", "type": "P", "difficulty": 3, "samples": [["3\n1\n2\n5", "1\n3 1\n1 4 5 3 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化", "位运算", "构造", "Ad-hoc"], "title": "「yyOI R1」youyou 的异或", "background": "youyou 非常菜，但是他很喜欢构造奇奇怪怪的数列。", "description": "本题评测方式为 **Special Judge**。\n\nyouyou 很喜欢数列，所以他想让你构造一个长度为 $n$ 的**正整数**序列 $\\{a_i\\}$。\n\nyouyou 很喜欢[异或](https://oi-wiki.org/math/bit/#%E4%B8%8E%E6%88%96%E5%BC%82%E6%88%96)，所以他要求构造出的序列满足 $a_1 \\oplus a_2 \\oplus a_3 \\oplus \\cdots \\oplus a_{n-1} \\oplus a_n = n$（记 $\\oplus$ 表示异或）。\n\nyouyou 非常讨厌相同的数，所以他要求序列中所有数**互不相同**。\n\n但 youyou 不想让这个序列的数太大，所以他要求序列中所有数的总和不超过 $n^2$，即 $\\displaystyle\\sum_{i=1}^n a_i \\le n^2$。\n\n现在你需要构造出一个序列从而满足 youyou 的所有要求。如果无解，输出 `-1` 。如果有多种答案，输出任意一个序列即可。\n\n你需要回答 $T$ 组数据。", "inputFormat": "第一行，一个正整数 $T$。\n\n接下来 $T$ 行，每行一个整数 $n$，表示你需要构造出一个长度为 $n$ 的满足要求的序列。", "outputFormat": "共 $T$ 行。\n\n若第 $i$ 行需要构造长度为 $n$ 的序列，则第 $i$ 行输出恰好 $n$ 个数，表示你所构造出的序列，注意序列中每个数为**正整数**。若无法构造出这样的序列，请在这一行输出 `-1` 。", "hint": "### 样例解释\n对于 $n = 1$ 时，一种可行的解为 $\\{1\\}$。\n\n对于 $n = 2$ 时，一种可行的解为 $\\{3,1\\}$。\n\n对于 $n = 5$ 时，一种可行的解为 $\\{1,4,5,3,6\\}$，因为 $1 ⊕  4 ⊕ 5  ⊕ 3 ⊕ 6 = 5$，且 $1+4+5+3+6 =19\\le 5^2$，序列中每个数也互不相同。\n\n\n### 数据范围\n对于 $5\\%$ 的数据，$n \\le 5$。\n\n对于 $15\\%$ 的数据，$n \\le 10$。\n\n对于 $40\\%$ 的数据，$n \\le 1000$。\n\n对于 $70\\%$ 的数据， $n \\le 10^5$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 × 10^5$，$1 \\le T \\le 10$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「yyOI R1」youyou 的异或", "background": "youyou 非常菜，但是他很喜欢构造奇奇怪怪的数列。", "description": "本题评测方式为 **Special Judge**。\n\nyouyou 很喜欢数列，所以他想让你构造一个长度为 $n$ 的**正整数**序列 $\\{a_i\\}$。\n\nyouyou 很喜欢[异或](https://oi-wiki.org/math/bit/#%E4%B8%8E%E6%88%96%E5%BC%82%E6%88%96)，所以他要求构造出的序列满足 $a_1 \\oplus a_2 \\oplus a_3 \\oplus \\cdots \\oplus a_{n-1} \\oplus a_n = n$（记 $\\oplus$ 表示异或）。\n\nyouyou 非常讨厌相同的数，所以他要求序列中所有数**互不相同**。\n\n但 youyou 不想让这个序列的数太大，所以他要求序列中所有数的总和不超过 $n^2$，即 $\\displaystyle\\sum_{i=1}^n a_i \\le n^2$。\n\n现在你需要构造出一个序列从而满足 youyou 的所有要求。如果无解，输出 `-1` 。如果有多种答案，输出任意一个序列即可。\n\n你需要回答 $T$ 组数据。", "inputFormat": "第一行，一个正整数 $T$。\n\n接下来 $T$ 行，每行一个整数 $n$，表示你需要构造出一个长度为 $n$ 的满足要求的序列。", "outputFormat": "共 $T$ 行。\n\n若第 $i$ 行需要构造长度为 $n$ 的序列，则第 $i$ 行输出恰好 $n$ 个数，表示你所构造出的序列，注意序列中每个数为**正整数**。若无法构造出这样的序列，请在这一行输出 `-1` 。", "hint": "### 样例解释\n对于 $n = 1$ 时，一种可行的解为 $\\{1\\}$。\n\n对于 $n = 2$ 时，一种可行的解为 $\\{3,1\\}$。\n\n对于 $n = 5$ 时，一种可行的解为 $\\{1,4,5,3,6\\}$，因为 $1 ⊕  4 ⊕ 5  ⊕ 3 ⊕ 6 = 5$，且 $1+4+5+3+6 =19\\le 5^2$，序列中每个数也互不相同。\n\n\n### 数据范围\n对于 $5\\%$ 的数据，$n \\le 5$。\n\n对于 $15\\%$ 的数据，$n \\le 10$。\n\n对于 $40\\%$ 的数据，$n \\le 1000$。\n\n对于 $70\\%$ 的数据， $n \\le 10^5$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 × 10^5$，$1 \\le T \\le 10$。\n", "locale": "zh-CN"}}}
{"pid": "P9636", "type": "P", "difficulty": 3, "samples": [["5 1 1 5 10\n1 2 2 2 2", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "「yyOI R1」youyou 的篡改（Easy Ver.）", "background": "**Easy Version 与 Hard Version 仅最后所求内容不同，其他描述均一致。**", "description": "youyou 准备举办一场比赛，这场比赛有 $n$ 道题，每一道题都有一个难度值 $v_i$。\n\nyouyou 给出一个计数分量 $k(k\\le n)$，他认为，第 $x(x \\geq k)$ 道题的可做性 $a_x$ 应当是第 $1\\sim x$ 题所有题目中将难度值从小到大排序后难度较大的 $k$ 道题目难度值之和。\n\n由于第 $1 \\sim k-1$ 题难度过于简单，youyou 不想考虑这些题目的可做性。\n\n那么这场比赛的总可做性即为第 $k$ 道题至第 $n$ 道题可做性之和，即 $\\sum^{n}_{i=k}a_i$\n 的值。\n\nyouyou 可以篡改题目 $m$ 的难度为任意正整数，但是他并不希望这场比赛过难或者过简单，所以他要求总可做性必须介于 $[l,r]$ 之间。\n\nyouyou 想知道，他通过篡改题目 $m$ 的难度，可以将总可做性最大篡改为多少？\n\n特别的，如不存在一组解请输出 $-1$。", "inputFormat": "第一行输入五个正整数，分别为 $n,m,k,l,r$。\n\n第二行输入 $n$ 个整数，第 $i$ 个数 $v_i$ 为第 $i$ 道题难度值。", "outputFormat": "仅一行，输出一个数，表示在满足条件的前提下，总可做性可改为的最大值。", "hint": "### 样例解释#1\n\n因为 $m=1$，因此 $a_1$ 是可以被篡改的，当 $a_1=2$ 时，总可做性为 $2+2+2+2+2=10$，因为 $10 \\in [5,10]$，因此可以将总可做性最大篡改为 $10$。\n\n## 数据范围\n\n本题启用 **Subtask**，对于每一个 **Subtask**，你需要通过全部测试点才能得到该部分的分数。\n\n| 子任务编号 | $n$ | 分数 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le10$ | $15$ |\n| $2$ | $\\le10^3$ | $15$ |\n| $3$ | $\\le10^5$ | $70$ |\n\n\n对于 $100\\%$ 的数据，$1\\le k,t \\le n \\le 10^5$，$1 \\le l \\le r \\le 10^{9}$，$0\\le v_i\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「yyOI R1」youyou 的篡改（Easy Ver.）", "background": "**Easy Version 与 Hard Version 仅最后所求内容不同，其他描述均一致。**", "description": "youyou 准备举办一场比赛，这场比赛有 $n$ 道题，每一道题都有一个难度值 $v_i$。\n\nyouyou 给出一个计数分量 $k(k\\le n)$，他认为，第 $x(x \\geq k)$ 道题的可做性 $a_x$ 应当是第 $1\\sim x$ 题所有题目中将难度值从小到大排序后难度较大的 $k$ 道题目难度值之和。\n\n由于第 $1 \\sim k-1$ 题难度过于简单，youyou 不想考虑这些题目的可做性。\n\n那么这场比赛的总可做性即为第 $k$ 道题至第 $n$ 道题可做性之和，即 $\\sum^{n}_{i=k}a_i$\n 的值。\n\nyouyou 可以篡改题目 $m$ 的难度为任意正整数，但是他并不希望这场比赛过难或者过简单，所以他要求总可做性必须介于 $[l,r]$ 之间。\n\nyouyou 想知道，他通过篡改题目 $m$ 的难度，可以将总可做性最大篡改为多少？\n\n特别的，如不存在一组解请输出 $-1$。", "inputFormat": "第一行输入五个正整数，分别为 $n,m,k,l,r$。\n\n第二行输入 $n$ 个整数，第 $i$ 个数 $v_i$ 为第 $i$ 道题难度值。", "outputFormat": "仅一行，输出一个数，表示在满足条件的前提下，总可做性可改为的最大值。", "hint": "### 样例解释#1\n\n因为 $m=1$，因此 $a_1$ 是可以被篡改的，当 $a_1=2$ 时，总可做性为 $2+2+2+2+2=10$，因为 $10 \\in [5,10]$，因此可以将总可做性最大篡改为 $10$。\n\n## 数据范围\n\n本题启用 **Subtask**，对于每一个 **Subtask**，你需要通过全部测试点才能得到该部分的分数。\n\n| 子任务编号 | $n$ | 分数 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le10$ | $15$ |\n| $2$ | $\\le10^3$ | $15$ |\n| $3$ | $\\le10^5$ | $70$ |\n\n\n对于 $100\\%$ 的数据，$1\\le k,t \\le n \\le 10^5$，$1 \\le l \\le r \\le 10^{9}$，$0\\le v_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P9637", "type": "P", "difficulty": 4, "samples": [["5 1 1 5 10\n1 2 2 2 2", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "「yyOI R1」youyou 的篡改（Hard Ver.）", "background": "**Easy Version 与 Hard Version 仅最后所求内容不同，其他描述均一致。**", "description": "youyou 准备举办一场比赛，这场比赛有 $n$ 道题，每一道题都有一个难度值 $v_i$。\n\nyouyou 给出一个计数分量 $k(k\\le n)$，他认为，第 $x(x \\geq k)$ 道题的可做性 $a_x$ 应当是第 $1\\sim x$ 题所有题目中将难度值从小到大排序后难度较大的 $k$ 道题目难度值之和。\n\n由于第 $1 \\sim k-1$ 题难度过于简单，youyou 不想考虑这些题目的可做性。\n\n那么这场比赛的总可做性即为第 $k$ 道题至第 $n$ 道题可做性之和，即 $\\sum^{n}_{i=k}a_i$\n 的值。\n\n他可以篡改题目 $m$ 的难度为任意正整数。\n\n问：总可做性必须满足在区间 $[l,r]$ 的范围内，那么总可做性有几种取值？", "inputFormat": "第一行输入五个正整数，分别为 $n,m,k,l,r$。\n\n第二行输入 $n$ 个整数，第 $i$ 个数 $v_i$ 为第 $i$ 道题难度值。", "outputFormat": "仅一行，输出一个数，表示在满足条件的前提下，总可做性的取值数。", "hint": "### 样例解释#1\n\n你可以改动 $v_1$，$k=1$。\n\n当第一个数改动为 $1$ 时，总难度 $1+2+2+2+2=9$。\n\n当第一个数改动为 $2$ 时，总难度 $2+2+2+2+2=10$。\n\n仅有以上两种取值符合题意，即总难度值等于 $9$ 或 $10$。因此答案为 $2$。\n\n## 数据范围\n\n本题启用 **Subtask**，对于每一个 **Subtask**，你需要通过全部测试点才能得到该部分的分数。\n\n| 子任务编号 | $n$ | 分数 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le10$ | $15$ |\n| $2$ | $\\le10^3$ | $15$ |\n| $3$ | $\\le10^5$ | $70$ |\n\n\n对于 $100\\%$ 的数据，$1\\le k,t \\le n \\le 10^5$，$1 \\le l \\le r \\le 10^{9}$，$1\\le v_i\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「yyOI R1」youyou 的篡改（Hard Ver.）", "background": "**Easy Version 与 Hard Version 仅最后所求内容不同，其他描述均一致。**", "description": "youyou 准备举办一场比赛，这场比赛有 $n$ 道题，每一道题都有一个难度值 $v_i$。\n\nyouyou 给出一个计数分量 $k(k\\le n)$，他认为，第 $x(x \\geq k)$ 道题的可做性 $a_x$ 应当是第 $1\\sim x$ 题所有题目中将难度值从小到大排序后难度较大的 $k$ 道题目难度值之和。\n\n由于第 $1 \\sim k-1$ 题难度过于简单，youyou 不想考虑这些题目的可做性。\n\n那么这场比赛的总可做性即为第 $k$ 道题至第 $n$ 道题可做性之和，即 $\\sum^{n}_{i=k}a_i$\n 的值。\n\n他可以篡改题目 $m$ 的难度为任意正整数。\n\n问：总可做性必须满足在区间 $[l,r]$ 的范围内，那么总可做性有几种取值？", "inputFormat": "第一行输入五个正整数，分别为 $n,m,k,l,r$。\n\n第二行输入 $n$ 个整数，第 $i$ 个数 $v_i$ 为第 $i$ 道题难度值。", "outputFormat": "仅一行，输出一个数，表示在满足条件的前提下，总可做性的取值数。", "hint": "### 样例解释#1\n\n你可以改动 $v_1$，$k=1$。\n\n当第一个数改动为 $1$ 时，总难度 $1+2+2+2+2=9$。\n\n当第一个数改动为 $2$ 时，总难度 $2+2+2+2+2=10$。\n\n仅有以上两种取值符合题意，即总难度值等于 $9$ 或 $10$。因此答案为 $2$。\n\n## 数据范围\n\n本题启用 **Subtask**，对于每一个 **Subtask**，你需要通过全部测试点才能得到该部分的分数。\n\n| 子任务编号 | $n$ | 分数 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le10$ | $15$ |\n| $2$ | $\\le10^3$ | $15$ |\n| $3$ | $\\le10^5$ | $70$ |\n\n\n对于 $100\\%$ 的数据，$1\\le k,t \\le n \\le 10^5$，$1 \\le l \\le r \\le 10^{9}$，$1\\le v_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P9638", "type": "P", "difficulty": 5, "samples": [["4 3 3\n1 2 156\n1 4 42\n2 3 1\n1 26963\n3 3 40\n2 4", "1"], ["7 6 7\n1 2 292\n1 3 274\n1 4 221\n1 5 156\n3 4 42\n3 6 40\n1 30\n3 4 50\n2 6\n3 3 250\n3 1 298\n1 280\n2 1", "6\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["并查集", "Kruskal 重构树", "O2优化", "生成树"], "title": "「yyOI R1」youyou 的军训", "background": "在 youyou 的班上，身高可能是一个敏感的话题。", "description": "youyou 的班上一共有 $n$ 位同学，$m$ 对朋友，第 $i$ 对朋友关系对于身高有一个敏感值 $k_i$，敏感值可能会改变。\n\n我们定义两位同学如果互为**朋友**，那么必然存在某对关系，将两位同学**直接**相连。\n\n我们定义两位同学如果互为**好友**，那么必然存在直接或间接的关系，将两位同学相连。\n\n例如存在关系 $(1,2)$ 和 $(2,3)$，那么，$1$ 与 $2$ 是朋友，但 $1$ 与 $3$ 就是好友。\n\n现在，马上就要军训了，同学们要去领军训的服装，如果一位同学领到了尺码为 $p$ 的服装，所有同学会与朋友关系敏感值小于 $p$ 的朋友断交。即对于所有的朋友关系，若其敏感值小于 $p$，那么该朋友关系就会断开。不过在下一位同学领到服装时，所有**之前**的断开的朋友关系会恢复。\n\n由于军训领服装是一个复杂的过程，而 youyou 对此十分感兴趣，所以给出 $q$ 次操作，且一共有三种操作:\n\n- 操作 $1$，形如 `1 x`，表示有一位同学领到尺码为 $x$ 的服装。\n\n- 操作 $2$，形如 `2 x`，表示询问第 $x$ 位同学还有多少位好友（包括自己）。\n\n- 操作 $3$，形如 `3 x y`，表示第 $x$ 对朋友的敏感值变为 $y$，特别地，**敏感值的相对大小不会变化$^*$**（详情见下方），同时原来已经断开的关系不会恢复。\n\n**注意：好友跟朋友是两个概念，朋友一定是好友，但好友不一定是朋友。**\n\n$^*$：相对大小不会变化，指对于当前所有的敏感值而言，修改后的敏感值与原来的敏感值**排名相同**。\n\n例如，若原来所有对朋友之间敏感值是 $\\{1,2,3,5,6\\}$，$3$ 的排名为 $3$，因此 $3$ 只能修改为 $3,4$ 中的一个，这样才能保证排名不变，即相对大小位置不会变换。", "inputFormat": "第一行，输入三个正整数 $n,m,q$。\n\n后面 $m$ 行，给定 $m$ 对朋友关系，对于第 $i$ 行给定三个正整数 $x_i,y_i,k_i$。\n\n最后 $q$ 行，给定 $q$ 次操作。对于每次操作，给定一个正整数为 $op$，即操作类型。\n\n当 $op=1$ 时，再给定一个正整数 $x$，表示有一位同学领到尺码为 $x$ 的服装；\n\n当 $op=2$ 时，再给定一个正整数 $x$，表示一次询问；\n\n当 $op=3$ 时，再给定两个正整数 $x,y$，表示一次修改。", "outputFormat": "对于每次询问操作，输出一个 $x$ 表示询问的同学还有几位**好友**（**包括自己**）。保证对于每一个测试点，都会有一个询问操作。", "hint": "## 样例解释 #1\n\n如图所示，这是初始的关系图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/68hzm5mr.png)\n\n第一次操作为：有一位同学领到尺码为 $26963$ 的服装，这样，图中所有的边都会断开。\n\n下一次操作：第三对朋友即边 $(2,3)$ 的权变为 $40$。\n\n下一次操作：询问同学 $4$ 的好友数量，因为没有任何存在的边，因此答案为 $1$。\n \n## 数据范围\n| 测试点编号 | $n$ | $q$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1,2$ | $\\le 10$ | $\\le 4 \\times 10^5$ | 无 |\n| $3$ | $\\le 10^3$ | $\\le 10^3$ | 无 |\n| $4$ | $\\le 10^5$ | $\\le 4 \\times 10^5$ | 没有操作 $3$ |\n| $5,6$ | $\\le 10^5$ | $\\le 10^3$ | 无 |\n| $7$ | $\\le 10^5$ | $\\le 4 \\times 10^5$ | 没有操作 $1$ |\n| $8,9,10$ | $\\le 4 \\times 10^5$ | $\\le 4 \\times 10^5$ | 无 |\n\n用 $c_i$ 表示询问中同学领到服装尺码的大小，$e_i$ 表示修改后敏感值的大小。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,q,x_i,y_i \\le 4  \\times  10^5$，$1 \\le k_i,c_i,e_i \\le 1 \\times 10^9$，$m\\le \\min\\{\\frac{n(n-1)}{2},4 \\times 10^5\\}$。\n\n同时数据保证在任何时刻，所有对朋友关系之间的敏感值**互不相同**。\n\n**请注意常数因子对时间和空间产生的影响。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「yyOI R1」youyou 的军训", "background": "在 youyou 的班上，身高可能是一个敏感的话题。", "description": "youyou 的班上一共有 $n$ 位同学，$m$ 对朋友，第 $i$ 对朋友关系对于身高有一个敏感值 $k_i$，敏感值可能会改变。\n\n我们定义两位同学如果互为**朋友**，那么必然存在某对关系，将两位同学**直接**相连。\n\n我们定义两位同学如果互为**好友**，那么必然存在直接或间接的关系，将两位同学相连。\n\n例如存在关系 $(1,2)$ 和 $(2,3)$，那么，$1$ 与 $2$ 是朋友，但 $1$ 与 $3$ 就是好友。\n\n现在，马上就要军训了，同学们要去领军训的服装，如果一位同学领到了尺码为 $p$ 的服装，所有同学会与朋友关系敏感值小于 $p$ 的朋友断交。即对于所有的朋友关系，若其敏感值小于 $p$，那么该朋友关系就会断开。不过在下一位同学领到服装时，所有**之前**的断开的朋友关系会恢复。\n\n由于军训领服装是一个复杂的过程，而 youyou 对此十分感兴趣，所以给出 $q$ 次操作，且一共有三种操作:\n\n- 操作 $1$，形如 `1 x`，表示有一位同学领到尺码为 $x$ 的服装。\n\n- 操作 $2$，形如 `2 x`，表示询问第 $x$ 位同学还有多少位好友（包括自己）。\n\n- 操作 $3$，形如 `3 x y`，表示第 $x$ 对朋友的敏感值变为 $y$，特别地，**敏感值的相对大小不会变化$^*$**（详情见下方），同时原来已经断开的关系不会恢复。\n\n**注意：好友跟朋友是两个概念，朋友一定是好友，但好友不一定是朋友。**\n\n$^*$：相对大小不会变化，指对于当前所有的敏感值而言，修改后的敏感值与原来的敏感值**排名相同**。\n\n例如，若原来所有对朋友之间敏感值是 $\\{1,2,3,5,6\\}$，$3$ 的排名为 $3$，因此 $3$ 只能修改为 $3,4$ 中的一个，这样才能保证排名不变，即相对大小位置不会变换。", "inputFormat": "第一行，输入三个正整数 $n,m,q$。\n\n后面 $m$ 行，给定 $m$ 对朋友关系，对于第 $i$ 行给定三个正整数 $x_i,y_i,k_i$。\n\n最后 $q$ 行，给定 $q$ 次操作。对于每次操作，给定一个正整数为 $op$，即操作类型。\n\n当 $op=1$ 时，再给定一个正整数 $x$，表示有一位同学领到尺码为 $x$ 的服装；\n\n当 $op=2$ 时，再给定一个正整数 $x$，表示一次询问；\n\n当 $op=3$ 时，再给定两个正整数 $x,y$，表示一次修改。", "outputFormat": "对于每次询问操作，输出一个 $x$ 表示询问的同学还有几位**好友**（**包括自己**）。保证对于每一个测试点，都会有一个询问操作。", "hint": "## 样例解释 #1\n\n如图所示，这是初始的关系图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/68hzm5mr.png)\n\n第一次操作为：有一位同学领到尺码为 $26963$ 的服装，这样，图中所有的边都会断开。\n\n下一次操作：第三对朋友即边 $(2,3)$ 的权变为 $40$。\n\n下一次操作：询问同学 $4$ 的好友数量，因为没有任何存在的边，因此答案为 $1$。\n \n## 数据范围\n| 测试点编号 | $n$ | $q$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1,2$ | $\\le 10$ | $\\le 4 \\times 10^5$ | 无 |\n| $3$ | $\\le 10^3$ | $\\le 10^3$ | 无 |\n| $4$ | $\\le 10^5$ | $\\le 4 \\times 10^5$ | 没有操作 $3$ |\n| $5,6$ | $\\le 10^5$ | $\\le 10^3$ | 无 |\n| $7$ | $\\le 10^5$ | $\\le 4 \\times 10^5$ | 没有操作 $1$ |\n| $8,9,10$ | $\\le 4 \\times 10^5$ | $\\le 4 \\times 10^5$ | 无 |\n\n用 $c_i$ 表示询问中同学领到服装尺码的大小，$e_i$ 表示修改后敏感值的大小。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,q,x_i,y_i \\le 4  \\times  10^5$，$1 \\le k_i,c_i,e_i \\le 1 \\times 10^9$，$m\\le \\min\\{\\frac{n(n-1)}{2},4 \\times 10^5\\}$。\n\n同时数据保证在任何时刻，所有对朋友关系之间的敏感值**互不相同**。\n\n**请注意常数因子对时间和空间产生的影响。**", "locale": "zh-CN"}}}
