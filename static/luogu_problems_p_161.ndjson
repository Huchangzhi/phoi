{"pid": "P4259", "type": "P", "difficulty": 6, "samples": [["5 4 10\n1 1 1 0\n1 1 1 1\n1 1 0 1\n1 0 1 0\n1 1 0 0\n1 1 1 5 4\n1 3 1 3 1\n1 3 3 3 3\n1 2 3 5 3\n0 2 2\n1 1 4 2 4\n1 1 3 3 3\n0 5 1\n1 2 3 2 4\n1 1 2 2 4\n", "2\n1\n0\n1\n1\n1\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["线段树", "单调队列", "枚举", "Code+"], "title": "[Code+#3] 寻找车位", "background": null, "description": "access_globe 有一个巨大的停车场，这个停车场有 $n$ 行，每行有 $m$ 个车位。为了美观，access_globe 在建立这个停车场时，规定这个停车场必须是长条形的，即 $n\\ge m$。每个车位都是一个正方形的区域。\n\n最近，access_globe 正在为抽不到 Missing Poster 而苦恼，因此他请你帮他维护这个停车场。你需要支持两个个事件：\n\n- 一辆车停到某一个车位中，或一辆车从某个车位开走\n- 查询一个矩形区域内最大的只包含空车位的正方形区域\n\n如果你能帮 access_globe 高效地解决这个问题，access_globe 一定会好好奖励你的。", "inputFormat": "第一行包含三个正整数 $n$、$m$、$q$，表示停车场的大小和事件的个数；\n\n接下来 $n$ 行，每行 $m$ 个 0 或 1 的数，如果第 $i$ 行第 $j$ 的数**为 $1$**，则表示第 $i$ 行第 $j$ 列的车位**为空**，否则表示这个车位**非空**；\n\n接下来 $q$ 行，每行表示一个事件，有以下两种形式：\n\n- $0$ $x$ $y$ ：第 $x$ 行第 $y$ 列的车位的停车情况改变，即若此事件发生前这个车位为空，则此事件后这个车位非空，否则此事件后这个车位为空，保证 $1\\le x\\le n$，$1\\le y\\le m$\n- $1$ $l$ $s$ $r$ $t$：询问以 $(l, s)$ 和 $(r,t)$ 为对角的矩形区域中，最大的全空正方形区域的边长，保证 $1\\le l\\le r\\le n$，$1\\le s\\le t\\le m$", "outputFormat": "对每个询问输出一行一个整数，表示该询问的全空正方形的边长。", "hint": "| 子任务编号 | $n,m$ 的额外限制 | $q$ 的额外限制 | 修改操作 | 是否保证 $s=1,t=m$ |\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n,m \\le 500$|$q \\le 500$|存在|否|\n|$2$|$m \\le 10$|无|保证不存在|是|\n|$3$|^|^|存在|^|\n|$4$|$n \\le 400000$|^|保证不存在|^|\n|$5$|^|^|存在|^|\n|$6$|$m \\le 10$|^|保证不存在|否|\n|$7$|^|^|存在|^|\n|$8$|$n \\le 400000$|^|保证不存在|^|\n|$9$|^|^|存在|^|\n|$10$|无|^|^|^|\n\n所有子任务的分值均等分布。\n\n对于所有数据，保证 $n\\times m\\le4\\times 10^6$，$q\\le 2000$。\n\nCredit：https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#3] Finding Parking Spaces", "background": "", "description": "access_globe has a huge parking lot with $n$ rows and $m$ spaces per row. For aesthetics, when building this parking lot, access_globe stipulated that it must be strip-shaped, i.e., $n\\ge m$. Each parking space is a square area.\n\nRecently, access_globe has been distressed about not being able to draw \"Missing Poster\", so he asks you to help maintain this parking lot. You need to support two types of events:\n- A car parks in a certain space, or a car leaves a certain space.\n- Query, within a rectangular region, the largest square region consisting only of empty spaces.\n\nIf you can help access_globe solve this efficiently, access_globe will reward you well.", "inputFormat": "The first line contains three positive integers $n$, $m$, and $q$, denoting the size of the parking lot and the number of events.\n\nThe next $n$ lines each contain $m$ numbers, either $0$ or $1$. If the number at row $i$, column $j$ is $1$, then the space at row $i$, column $j$ is empty; otherwise, that space is non-empty.\n\nThe next $q$ lines each describe an event in one of the following two forms:\n- $0$ $x$ $y$: The occupancy status of the space at row $x$, column $y$ toggles. That is, if this space was empty before this event, it becomes non-empty after the event; otherwise, it becomes empty. It is guaranteed that $1\\le x\\le n$, $1\\le y\\le m$.\n- $1$ $l$ $s$ $r$ $t$: Query the side length of the largest all-empty square region within the rectangle with opposite corners $(l, s)$ and $(r, t)$. It is guaranteed that $1\\le l\\le r\\le n$, $1\\le s\\le t\\le m$.", "outputFormat": "For each query, output one integer on its own line, representing the side length of the largest all-empty square for that query.", "hint": "| Subtask ID | Extra constraints on $n, m$ | Extra constraints on $q$ | Update operations | Whether guaranteed that $s=1, t=m$ |\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n,m \\le 500$|$q \\le 500$|Present|No|\n|$2$|$m \\le 10$|None|Guaranteed absent|Yes|\n|$3$|^|^|Present|^|\n|$4$|$n \\le 400000$|^|Guaranteed absent|^|\n|$5$|^|^|Present|^|\n|$6$|$m \\le 10$|^|Guaranteed absent|No|\n|$7$|^|^|Present|^|\n|$8$|$n \\le 400000$|^|Guaranteed absent|^|\n|$9$|^|^|Present|^|\n|$10$|None|^|^|^|\n\nAll subtasks are evenly weighted.\n\nFor all testdata, it is guaranteed that $n\\times m\\le 4\\times 10^6$, $q\\le 2000$.\n\nCredit: https://www.luogu.org/discuss/show?postid=35727\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#3] 寻找车位", "background": null, "description": "access_globe 有一个巨大的停车场，这个停车场有 $n$ 行，每行有 $m$ 个车位。为了美观，access_globe 在建立这个停车场时，规定这个停车场必须是长条形的，即 $n\\ge m$。每个车位都是一个正方形的区域。\n\n最近，access_globe 正在为抽不到 Missing Poster 而苦恼，因此他请你帮他维护这个停车场。你需要支持两个个事件：\n\n- 一辆车停到某一个车位中，或一辆车从某个车位开走\n- 查询一个矩形区域内最大的只包含空车位的正方形区域\n\n如果你能帮 access_globe 高效地解决这个问题，access_globe 一定会好好奖励你的。", "inputFormat": "第一行包含三个正整数 $n$、$m$、$q$，表示停车场的大小和事件的个数；\n\n接下来 $n$ 行，每行 $m$ 个 0 或 1 的数，如果第 $i$ 行第 $j$ 的数**为 $1$**，则表示第 $i$ 行第 $j$ 列的车位**为空**，否则表示这个车位**非空**；\n\n接下来 $q$ 行，每行表示一个事件，有以下两种形式：\n\n- $0$ $x$ $y$ ：第 $x$ 行第 $y$ 列的车位的停车情况改变，即若此事件发生前这个车位为空，则此事件后这个车位非空，否则此事件后这个车位为空，保证 $1\\le x\\le n$，$1\\le y\\le m$\n- $1$ $l$ $s$ $r$ $t$：询问以 $(l, s)$ 和 $(r,t)$ 为对角的矩形区域中，最大的全空正方形区域的边长，保证 $1\\le l\\le r\\le n$，$1\\le s\\le t\\le m$", "outputFormat": "对每个询问输出一行一个整数，表示该询问的全空正方形的边长。", "hint": "| 子任务编号 | $n,m$ 的额外限制 | $q$ 的额外限制 | 修改操作 | 是否保证 $s=1,t=m$ |\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n,m \\le 500$|$q \\le 500$|存在|否|\n|$2$|$m \\le 10$|无|保证不存在|是|\n|$3$|^|^|存在|^|\n|$4$|$n \\le 400000$|^|保证不存在|^|\n|$5$|^|^|存在|^|\n|$6$|$m \\le 10$|^|保证不存在|否|\n|$7$|^|^|存在|^|\n|$8$|$n \\le 400000$|^|保证不存在|^|\n|$9$|^|^|存在|^|\n|$10$|无|^|^|^|\n\n所有子任务的分值均等分布。\n\n对于所有数据，保证 $n\\times m\\le4\\times 10^6$，$q\\le 2000$。\n\nCredit：https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN"}}}
{"pid": "P4260", "type": "P", "difficulty": 7, "samples": [["3 500\n1 1\n2 3\n4 4", "500000004\n200000002\n728571435"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Code+"], "title": "[Code+#3] 博弈论与概率统计", "background": "", "description": "Alice 和 Bob 在玩一个双人游戏。每一轮中，Alice 有 $p$ 的概率胜利，$1-p$ 的概率失败，不会出现平局。\n\n双方初始时各有 $0$ 分，当一个人胜利的时候，他会获得一分，失败则扣掉一分。遗憾的是，博弈论世界的人目前是无法理解负数的，因此，如果某个人输掉一轮比赛的时候他只有 $0$ 分，那么他就不会被扣分（对方会照常加一分）。游戏一共要进行 $N+M$ 轮，Alice 想请你帮她算算在游戏结束时她的得分的数学期望。\n\n“这算啥，我小 L 分分钟搞定！”。比小 L 更熟练的你当然也是随手就算出来了，但就在你打算告诉 Alice 答案之前，博弈论世界之神——temporaryDO 出现了，他给大家带来了一个重要信息：这 $N+M$ 轮游戏中， Alice 恰好赢了 $N$ 轮！\n\n熟知条件概率那套理论的你**立刻**注意到，你需要修改自己的计算方法来得到正确的答案了。\n\n为了避免精度问题，请将结果对 $10^9+7$ 取模。即，我们的数据保证答案是一个有理数 $\\frac{p}{q}$，且有 $10^9+7\\nmid q$，你只需要找到一个整数 $x\\in [0, 10^9+7)$ 使得 $qx\\equiv p\\pmod{10^9+7}$ 即可。\n\n", "inputFormat": "输入的第一行包含两个正整数 $T$, $P'$，其中 $T$ 表示数据组数，$\\frac{P'}{1000}$ 表示 $p$ ，即 Alice 在每轮游戏中的获胜概率。\n\n接下来 $T$ 行，每行两个非负整数 $N,M$，表示一组数据。\n", "outputFormat": "输出 $T$ 行，每行一个整数，表示对应数据的答案。", "hint": "每一轮游戏 Alice 均有 $\\frac{1}{2}$ 的概率胜利。\n\n* 对于第一组数据，Alice 的胜利可能在第一轮或第二轮，并且概率相等。若她在第一轮胜利，则最终得分为 $0$，否则她的得分为 $1$。故期望为 $\\frac{1}{2}$，验证发现 $2\\times 500000004\\equiv 1\\pmod{10^9+7}$。\n* 对于第二组数据，所求期望为 $\\frac{3}{5}$。\n* 对于第三组数据，所求期望为 $\\frac{93}{70}$。\n\n【数据范围与约定】\n1. 对于 10% 的数据，$N,M,T\\le 50$ 。\n2. 对于另外 20% 的数据，$N,M,T\\le 2000$ 。\n3. 对于另外 20% 的数据，$N,M\\le 10^5$，$|N-M|\\le 200$，$T\\le 2\\times 10^5$ 。\n4. 对于另外 20% 的数据，$N,M,T\\le 5\\times 10^4$ 。\n5. 对于 100% 的数据，$N+M,T\\le 2.5\\times 10^5$， $0 < P' < 1000$ 。\n\nCredit：https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#3] Game Theory and Probability", "background": "", "description": "Alice and Bob are playing a two-player game. In each round, Alice wins with probability $p$ and loses with probability $1-p$, and no tie occurs.\n\nBoth players start with $0$ points. When a player wins, they gain $1$ point; when a player loses, they lose $1$ point. Unfortunately, people in the world of game theory cannot comprehend negative numbers. Therefore, if someone loses a round while they have $0$ points, they will not be deducted any points (the opponent still gains $1$ point as usual). The game consists of $N+M$ rounds in total. Alice asks you to compute the expected value of her score at the end of the game.\n\n“This is nothing. I, little L, can do it in a minute!” You, being even more skilled than little L, also get the answer easily. But just as you are about to tell Alice the answer, the god of the game theory world—temporaryDO—appears and brings an important piece of information: among these $N+M$ rounds, Alice wins exactly $N$ rounds!\n\nBeing familiar with conditional probability, you immediately realize that you need to adjust your computation to obtain the correct answer.\n\nTo avoid precision issues, please output the result modulo $10^9+7$. That is, our testdata guarantees that the answer is a rational number $\\frac{p}{q}$ with $10^9+7 \\nmid q$. You only need to find an integer $x \\in [0, 10^9+7)$ such that $q x \\equiv p \\pmod{10^9+7}$.", "inputFormat": "The first line contains two positive integers $T$, $P'$, where $T$ is the number of test cases, and $\\frac{P'}{1000}$ equals $p$, i.e., Alice’s probability of winning each round.\n\nThen follow $T$ lines. Each line contains two nonnegative integers $N, M$, representing one test case.", "outputFormat": "Output $T$ lines, each containing one integer, which is the answer for the corresponding test case.", "hint": "In each round, Alice has probability $\\frac{1}{2}$ to win.\n\n- For the first test case, Alice’s win may occur in the first or second round, with equal probability. If she wins in the first round, her final score is $0$; otherwise, her score is $1$. Hence the expectation is $\\frac{1}{2}$. Verification: $2 \\times 500000004 \\equiv 1 \\pmod{10^9+7}$.\n- For the second test case, the expected value is $\\frac{3}{5}$.\n- For the third test case, the expected value is $\\frac{93}{70}$.\n\nConstraints and Conventions\n1. For 10% of the testdata, $N, M, T \\le 50$.\n2. For an additional 20% of the testdata, $N, M, T \\le 2000$.\n3. For an additional 20% of the testdata, $N, M \\le 10^5$, $|N-M| \\le 200$, $T \\le 2 \\times 10^5$.\n4. For an additional 20% of the testdata, $N, M, T \\le 5 \\times 10^4$.\n5. For 100% of the testdata, $N+M, T \\le 2.5 \\times 10^5$, $0 < P' < 1000$.\n\nCredit: https://www.luogu.org/discuss/show?postid=35727\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#3] 博弈论与概率统计", "background": "", "description": "Alice 和 Bob 在玩一个双人游戏。每一轮中，Alice 有 $p$ 的概率胜利，$1-p$ 的概率失败，不会出现平局。\n\n双方初始时各有 $0$ 分，当一个人胜利的时候，他会获得一分，失败则扣掉一分。遗憾的是，博弈论世界的人目前是无法理解负数的，因此，如果某个人输掉一轮比赛的时候他只有 $0$ 分，那么他就不会被扣分（对方会照常加一分）。游戏一共要进行 $N+M$ 轮，Alice 想请你帮她算算在游戏结束时她的得分的数学期望。\n\n“这算啥，我小 L 分分钟搞定！”。比小 L 更熟练的你当然也是随手就算出来了，但就在你打算告诉 Alice 答案之前，博弈论世界之神——temporaryDO 出现了，他给大家带来了一个重要信息：这 $N+M$ 轮游戏中， Alice 恰好赢了 $N$ 轮！\n\n熟知条件概率那套理论的你**立刻**注意到，你需要修改自己的计算方法来得到正确的答案了。\n\n为了避免精度问题，请将结果对 $10^9+7$ 取模。即，我们的数据保证答案是一个有理数 $\\frac{p}{q}$，且有 $10^9+7\\nmid q$，你只需要找到一个整数 $x\\in [0, 10^9+7)$ 使得 $qx\\equiv p\\pmod{10^9+7}$ 即可。\n\n", "inputFormat": "输入的第一行包含两个正整数 $T$, $P'$，其中 $T$ 表示数据组数，$\\frac{P'}{1000}$ 表示 $p$ ，即 Alice 在每轮游戏中的获胜概率。\n\n接下来 $T$ 行，每行两个非负整数 $N,M$，表示一组数据。\n", "outputFormat": "输出 $T$ 行，每行一个整数，表示对应数据的答案。", "hint": "每一轮游戏 Alice 均有 $\\frac{1}{2}$ 的概率胜利。\n\n* 对于第一组数据，Alice 的胜利可能在第一轮或第二轮，并且概率相等。若她在第一轮胜利，则最终得分为 $0$，否则她的得分为 $1$。故期望为 $\\frac{1}{2}$，验证发现 $2\\times 500000004\\equiv 1\\pmod{10^9+7}$。\n* 对于第二组数据，所求期望为 $\\frac{3}{5}$。\n* 对于第三组数据，所求期望为 $\\frac{93}{70}$。\n\n【数据范围与约定】\n1. 对于 10% 的数据，$N,M,T\\le 50$ 。\n2. 对于另外 20% 的数据，$N,M,T\\le 2000$ 。\n3. 对于另外 20% 的数据，$N,M\\le 10^5$，$|N-M|\\le 200$，$T\\le 2\\times 10^5$ 。\n4. 对于另外 20% 的数据，$N,M,T\\le 5\\times 10^4$ 。\n5. 对于 100% 的数据，$N+M,T\\le 2.5\\times 10^5$， $0 < P' < 1000$ 。\n\nCredit：https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN"}}}
{"pid": "P4261", "type": "P", "difficulty": 6, "samples": [["3\n1\n0 0 1 1 0\n3\n0 -10 10 10 1\n10 0 10 10 1\n-10 0 10 10 0\n3\n0 10 10 10 1\n10 20 10 10 1\n10 0 10 10 0\n", "1\n2\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["离散化", "枚举", "线段相交", "Code+"], "title": "[Code+#3] 白金元首与克劳德斯", "background": "> 千里白金雪满天　烽火江山起狼烟　分手竟兵刃相见\n\n1941.7.\n\n苏联军队出乎意料的反抗力量、前线德军的补给困难 —— 元首 Adolf 望着天空的云层陷入沉思……", "description": "在 $xy$-直角坐标平面的天空中，有 $n$ 片四边平行于坐标轴的矩形云朵。每一片云由一个五元组 $(x_i, y_i, w_i, h_i, d_i)$ 表示，其中 $(x_i, y_i)$ 为云左下角顶点的坐标，$w_i$ 表示云在 $x$ 轴方向的宽度，$h_i$ 表示云在 $y$ 轴方向的长度，$d_i \\in \\{0, 1\\}$ 为云的移动方向（$0$ 为横向，$1$ 为纵向）。具体来说，满足 $d_i = 0$ 的云沿 $x$ 轴正方向以每秒 $1$ 长度单位的速率不断移动，而满足 $d_i = 1$ 的云沿 $y$ 轴正方向以每秒 $1$ 长度单位的速率不断移动。\n\n元首发现，**所有的云在此时没有重叠的面积**。他将这个时刻记作时刻 $0$。他想知道，对于 $(-\\infty, +\\infty)$ 中的**任意时刻**和平面上的**任意一个点**，最多可以同时被多少片云覆盖。一个点在某时刻被一朵云覆盖当且仅当这个点位于该时刻云朵所处矩形的**内部（不含边界）**。\n\n你需要编写程序帮助元首满足他的好奇心。\n", "inputFormat": "输入的第一行包含一个正整数 $T$ —— 数据的组数。接下来包含 $T$ 组数据，格式如下，数据间没有空行。\n\n* 第 $1$ 行：一个正整数 $n$ —— 云朵的数量。\n* 接下来 $n$ 行：每行五个空格分隔的整数 $x_i$、$y_i$、$w_i$、$h_i$ 和 $d_i$ —— 描述一朵云在时刻 $0$ 的状态。\n", "outputFormat": "对于每组数据输出一行 —— 在任意时刻，覆盖平面上任意一个点的云朵数目的最大值。", "hint": "第 $1$ 组数据中，任意时刻的任意一个点至多被惟一的一片云覆盖。\n\n第 $2$ 组数据中，下图从左至右分别示意时刻 $0$、时刻 $4$、时刻 $11$ 的情形。\n\n![](https://cdn.luogu.com.cn/upload/pic/15106.png)\n\n第 $3$ 组数据中，时刻 $0$ 对应第 $2$ 组数据时刻 $20$ 的情形。在该组数据中，$(-20, 0)$ 内的时刻均有 $2$ 片云覆盖同一个点。请注意考察范围 $(-\\infty, +\\infty)$ 包含时刻 $0$ 之前的时间段。\n\n对于所有数据，有 $1 \\leq T \\leq 15$，$-5\\times 10^8 \\leq x_i, y_i \\leq 5\\times 10^8$，$1 \\leq w_i, h_i \\leq 5\\times 10^8$，$d_i \\in {0, 1}$。\n\n![](https://cdn.luogu.com.cn/upload/pic/15108.png)\n\nCredit：https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#3] The Platinum Führer and Claudius", "background": "> For a thousand li, platinum snow fills the sky; beacon fires rise over the realm; parted, we meet again with blades drawn.\n\n1941.7.\n\nThe unexpected resistance of the Soviet army and the supply difficulties of the German forces at the front — the Führer, Adolf, gazed at the clouds in the sky and fell into deep thought...", "description": "On the $xy$-Cartesian coordinate plane, there are $n$ axis-aligned rectangular clouds. Each cloud is represented by a 5-tuple $(x_i, y_i, w_i, h_i, d_i)$, where $(x_i, y_i)$ is the coordinate of the lower-left corner, $w_i$ is the width along the $x$-axis, $h_i$ is the length along the $y$-axis, and $d_i \\in \\{0, 1\\}$ is the moving direction ($0$ for horizontal, $1$ for vertical). Specifically, a cloud with $d_i = 0$ moves continuously along the positive $x$-axis at a speed of 1 unit length per second, and a cloud with $d_i = 1$ moves continuously along the positive $y$-axis at a speed of 1 unit length per second.\n\nThe Führer observes that all clouds have no overlapping area at this moment. He marks this moment as time $0$. He wants to know, for any moment in $(-\\infty, +\\infty)$ and any single point on the plane, what is the maximum number of clouds that can simultaneously cover it. A point is covered by a cloud at some moment if and only if it lies strictly inside the rectangle occupied by the cloud at that moment (excluding the boundary).\n\nYou need to write a program to satisfy his curiosity.", "inputFormat": "The first line contains a positive integer $T$ — the number of test cases. Then follow $T$ test cases in the format below, with no blank lines between them.\n\n- Line 1: a positive integer $n$ — the number of clouds.\n- Then $n$ lines follow: each line contains five space-separated integers $x_i$, $y_i$, $w_i$, $h_i$, and $d_i$ — describing the state of one cloud at time $0$.", "outputFormat": "For each test case, output one line — the maximum number of clouds that can cover some point at any time.", "hint": "In the 1st test group, at any time, any point is covered by at most one cloud.\n\nIn the 2nd test group, the following figure from left to right illustrates the situations at time 0, time 4, and time 11.\n\n![](https://cdn.luogu.com.cn/upload/pic/15106.png)\n\nIn the 3rd test group, time 0 corresponds to the situation at time 20 in the 2nd test group. In this group, during times in $(-20, 0)$, there are always 2 clouds covering the same point. Please note that the range $(-\\infty, +\\infty)$ includes times before time $0$.\n\nConstraints:\n\nFor all testdata, $1 \\leq T \\leq 15$, $-5\\times 10^8 \\leq x_i, y_i \\leq 5\\times 10^8$, $1 \\leq w_i, h_i \\leq 5\\times 10^8$, $d_i \\in \\{0, 1\\}$.\n\n![](https://cdn.luogu.com.cn/upload/pic/15108.png)\n\nCredit: https://www.luogu.org/discuss/show?postid=35727\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#3] 白金元首与克劳德斯", "background": "> 千里白金雪满天　烽火江山起狼烟　分手竟兵刃相见\n\n1941.7.\n\n苏联军队出乎意料的反抗力量、前线德军的补给困难 —— 元首 Adolf 望着天空的云层陷入沉思……", "description": "在 $xy$-直角坐标平面的天空中，有 $n$ 片四边平行于坐标轴的矩形云朵。每一片云由一个五元组 $(x_i, y_i, w_i, h_i, d_i)$ 表示，其中 $(x_i, y_i)$ 为云左下角顶点的坐标，$w_i$ 表示云在 $x$ 轴方向的宽度，$h_i$ 表示云在 $y$ 轴方向的长度，$d_i \\in \\{0, 1\\}$ 为云的移动方向（$0$ 为横向，$1$ 为纵向）。具体来说，满足 $d_i = 0$ 的云沿 $x$ 轴正方向以每秒 $1$ 长度单位的速率不断移动，而满足 $d_i = 1$ 的云沿 $y$ 轴正方向以每秒 $1$ 长度单位的速率不断移动。\n\n元首发现，**所有的云在此时没有重叠的面积**。他将这个时刻记作时刻 $0$。他想知道，对于 $(-\\infty, +\\infty)$ 中的**任意时刻**和平面上的**任意一个点**，最多可以同时被多少片云覆盖。一个点在某时刻被一朵云覆盖当且仅当这个点位于该时刻云朵所处矩形的**内部（不含边界）**。\n\n你需要编写程序帮助元首满足他的好奇心。\n", "inputFormat": "输入的第一行包含一个正整数 $T$ —— 数据的组数。接下来包含 $T$ 组数据，格式如下，数据间没有空行。\n\n* 第 $1$ 行：一个正整数 $n$ —— 云朵的数量。\n* 接下来 $n$ 行：每行五个空格分隔的整数 $x_i$、$y_i$、$w_i$、$h_i$ 和 $d_i$ —— 描述一朵云在时刻 $0$ 的状态。\n", "outputFormat": "对于每组数据输出一行 —— 在任意时刻，覆盖平面上任意一个点的云朵数目的最大值。", "hint": "第 $1$ 组数据中，任意时刻的任意一个点至多被惟一的一片云覆盖。\n\n第 $2$ 组数据中，下图从左至右分别示意时刻 $0$、时刻 $4$、时刻 $11$ 的情形。\n\n![](https://cdn.luogu.com.cn/upload/pic/15106.png)\n\n第 $3$ 组数据中，时刻 $0$ 对应第 $2$ 组数据时刻 $20$ 的情形。在该组数据中，$(-20, 0)$ 内的时刻均有 $2$ 片云覆盖同一个点。请注意考察范围 $(-\\infty, +\\infty)$ 包含时刻 $0$ 之前的时间段。\n\n对于所有数据，有 $1 \\leq T \\leq 15$，$-5\\times 10^8 \\leq x_i, y_i \\leq 5\\times 10^8$，$1 \\leq w_i, h_i \\leq 5\\times 10^8$，$d_i \\in {0, 1}$。\n\n![](https://cdn.luogu.com.cn/upload/pic/15108.png)\n\nCredit：https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN"}}}
{"pid": "P4262", "type": "P", "difficulty": 6, "samples": [["2 4\n0 0 0 0\n0 0 0 1", "14 13 10 22\n15 11 17 0\n"], ["4 5\n0 0 0 1 1\n1 0 0 0 1\n1 0 0 0 0\n0 0 0 0 0\n", "1882 827 1523 0 0\n0 1189 791 1529 0\n0 1106 979 823 1315\n1810 899 1136 1075 1189"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["O2优化", "轮廓线 DP", "Code+"], "title": "[Code+#3] 白金元首与莫斯科", "background": "> 莫斯科吹的寒风 / 仿佛昨日那场梦 / 啊 你还会记得我吗\n\n1941.12.\n\n寒冷刺骨的天气、疲惫不堪的军队…… 包围首都的作战计划陷入了困境。空军或许是拯救战况的最后希望了，元首 Adolf 想道。", "description": "在一个 $n \\times m$ 的网格区域中存在一个陆军单位需要补给，区域中的每个格子为空地或障碍物中的一种。航空舰队需要派遣若干运输机前往此区域，每一架运输机可以向两个相邻（有一条公共边）的空地投放物资。为防止不必要的损坏，一个标记为空地的格子至多只能得到一次投放。\n\n由于天气原因，陆军单位所在的确切位置并不能确定。因此元首想知道，对于每个空地格子，当陆军单位在其中（视作障碍物）时，用若干（可以为 $0$）架运输机向其余空地投放任意数量的物资的不同方案数。两个投放方案不同，当且仅当存在一个格子在一个方案中被投放而另一方案中未被投放，或存在两个被投放的格子，在一个方案中被同一架运输机投放而在另一方案中非然。若仍有疑问，请参考【样例 1 解释】。\n\n你需要编写程序帮助元首计算这些值。", "inputFormat": "第 $1$ 行：两个空格分隔的正整数 $n, m$ —— 网格区域的行数和列数。\n接下来 $n$ 行：其中第 $i$ 行包含 $m$ 个空格分隔的整数 $A_{i1}, A_{i2}, \\ldots, A_{im}$ —— 其中 $A_{ij} = 0$ 表示第 $i$ 行第 $j$ 列的格子为空地；$A_{ij} = 1$ 表示该格为障碍物。", "outputFormat": "输出 $n$ 行，第 $i$ 行包含 $m$ 个空格分隔的整数 $B_{i1}, B_{i2}, \\ldots, B_{im}$ —— 若第 $i$ 行第 $j$ 列的格子为空地，$B_{ij}$ 为该格变为障碍物后投放的方案数；否则 $B_{ij} = 0$。每个答案对 $10^9+7$ 取模。", "hint": "#### 输入输出样例 1 解释\n\n以第 $2$ 行第 $1$ 列的**空地**格为例，其变为**障碍物**后的网格如下图，其中o格子代表**空地**，x格子代表**障碍物**。\n\n```\nｏｏｏｏ\nｘｏｏｘ\n```\n\n$15$ 种方案如下图所示，不同颜色代表不同运输机的投放位置。\n\n![](https://cdn.luogu.com.cn/upload/pic/15113.png)\n\n#### 数据规模与约定\n\n**本题采用捆绑测试，各测试点信息如下**：\n| 子任务编号 | 分值 | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $\\le 2$ | $\\le 17$ |\n| $2$ | $8$ | $\\le 5$ | $\\le 5$ |\n| $3$ | $6$ | $\\le 9$ | $\\le 9$ |\n| $4$ | $9$ | $\\le 12$ | $\\le 12$ |\n| $5$ | $17$ | $\\le 15$ | $\\le 15$ |\n| $6$ | $17$ | $\\le 16$ | $\\le 16$ |\n| $7$ | $33$ | $\\le 17$ | $\\le 17$ |\n\n对于所有数据，有 $1 \\leq n, m \\leq 17$，$A_{ij} \\in {0, 1}$。\n\n#### 说明\n\n*Von allem Anfang an bin ich nur verraten und betrogen worden!*\n\n题面与史实不尽相符。\n\n\nCredit：https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#3] Platinum Führer and Moscow", "background": "> The cold wind blowing in Moscow / as if yesterday’s dream / Ah, will you still remember me?\n\n1941.12.\n\nThe weather was freezing cold, the army exhausted... The plan to encircle the capital had run into trouble. The air force might be the last hope to salvage the situation, thought Führer Adolf.", "description": "In an $n \\times m$ grid, there is an army unit that needs resupply. Each cell in the area is either an empty cell or an obstacle. The air fleet needs to dispatch several transport planes to this area. Each transport plane can drop supplies to two adjacent (sharing a common edge) empty cells. To prevent unnecessary damage, a cell marked as empty can receive at most one drop.\n\nDue to the weather, the exact location of the army unit cannot be determined. Therefore, for every empty cell, when the army unit is in that cell (treat it as an obstacle), the Führer wants to know the number of different schemes to drop any amount of supplies to the remaining empty cells using any number (possibly $0$) of transport planes. Two schemes are different if and only if there exists a cell that is supplied in one scheme but not in the other, or there exist two supplied cells that are supplied by the same plane in one scheme but not so in the other. If you are still unsure, please refer to the explanation for Sample 1.\n\nYou need to write a program to compute these values.", "inputFormat": "Line 1: two space-separated positive integers $n, m$ — the number of rows and columns of the grid region.\nNext $n$ lines: line $i$ contains $m$ space-separated integers $A_{i1}, A_{i2}, \\ldots, A_{im}$ — $A_{ij} = 0$ means the cell in row $i$, column $j$ is an empty cell; $A_{ij} = 1$ means the cell is an obstacle.", "outputFormat": "Output $n$ lines. Line $i$ contains $m$ space-separated integers $B_{i1}, B_{i2}, \\ldots, B_{im}$ — if the cell in row $i$, column $j$ is an empty cell, then $B_{ij}$ is the number of schemes after turning that cell into an obstacle; otherwise $B_{ij} = 0$. Each answer is taken modulo $10^9+7$.", "hint": "#### Explanation for Sample 1\n\nTake the empty cell in row $2$, column $1$ as an example. After it is changed into an obstacle, the grid is as follows. Cells marked with o are empty, and cells marked with x are obstacles.\n\n```\nｏｏｏｏ\nｘｏｏｘ\n```\n\nThere are $15$ schemes as shown below. Different colors represent the drop positions of different transport planes.\n\n![](https://cdn.luogu.com.cn/upload/pic/15113.png)\n\n#### Constraints\n\nThis problem uses bundled tests. The information for each test point is as follows:\n| Subtask ID | Points | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $\\le 2$ | $\\le 17$ |\n| $2$ | $8$ | $\\le 5$ | $\\le 5$ |\n| $3$ | $6$ | $\\le 9$ | $\\le 9$ |\n| $4$ | $9$ | $\\le 12$ | $\\le 12$ |\n| $5$ | $17$ | $\\le 15$ | $\\le 15$ |\n| $6$ | $17$ | $\\le 16$ | $\\le 16$ |\n| $7$ | $33$ | $\\le 17$ | $\\le 17$ |\n\nFor all testdata, $1 \\leq n, m \\leq 17$, $A_{ij} \\in \\{0, 1\\}$.\n\n#### Notes\n\n*Von allem Anfang an bin ich nur verraten und betrogen worden!*\n\nThe statement does not fully agree with historical facts.\n\nCredit: https://www.luogu.org/discuss/show?postid=35727\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#3] 白金元首与莫斯科", "background": "> 莫斯科吹的寒风 / 仿佛昨日那场梦 / 啊 你还会记得我吗\n\n1941.12.\n\n寒冷刺骨的天气、疲惫不堪的军队…… 包围首都的作战计划陷入了困境。空军或许是拯救战况的最后希望了，元首 Adolf 想道。", "description": "在一个 $n \\times m$ 的网格区域中存在一个陆军单位需要补给，区域中的每个格子为空地或障碍物中的一种。航空舰队需要派遣若干运输机前往此区域，每一架运输机可以向两个相邻（有一条公共边）的空地投放物资。为防止不必要的损坏，一个标记为空地的格子至多只能得到一次投放。\n\n由于天气原因，陆军单位所在的确切位置并不能确定。因此元首想知道，对于每个空地格子，当陆军单位在其中（视作障碍物）时，用若干（可以为 $0$）架运输机向其余空地投放任意数量的物资的不同方案数。两个投放方案不同，当且仅当存在一个格子在一个方案中被投放而另一方案中未被投放，或存在两个被投放的格子，在一个方案中被同一架运输机投放而在另一方案中非然。若仍有疑问，请参考【样例 1 解释】。\n\n你需要编写程序帮助元首计算这些值。", "inputFormat": "第 $1$ 行：两个空格分隔的正整数 $n, m$ —— 网格区域的行数和列数。\n接下来 $n$ 行：其中第 $i$ 行包含 $m$ 个空格分隔的整数 $A_{i1}, A_{i2}, \\ldots, A_{im}$ —— 其中 $A_{ij} = 0$ 表示第 $i$ 行第 $j$ 列的格子为空地；$A_{ij} = 1$ 表示该格为障碍物。", "outputFormat": "输出 $n$ 行，第 $i$ 行包含 $m$ 个空格分隔的整数 $B_{i1}, B_{i2}, \\ldots, B_{im}$ —— 若第 $i$ 行第 $j$ 列的格子为空地，$B_{ij}$ 为该格变为障碍物后投放的方案数；否则 $B_{ij} = 0$。每个答案对 $10^9+7$ 取模。", "hint": "#### 输入输出样例 1 解释\n\n以第 $2$ 行第 $1$ 列的**空地**格为例，其变为**障碍物**后的网格如下图，其中o格子代表**空地**，x格子代表**障碍物**。\n\n```\nｏｏｏｏ\nｘｏｏｘ\n```\n\n$15$ 种方案如下图所示，不同颜色代表不同运输机的投放位置。\n\n![](https://cdn.luogu.com.cn/upload/pic/15113.png)\n\n#### 数据规模与约定\n\n**本题采用捆绑测试，各测试点信息如下**：\n| 子任务编号 | 分值 | $n$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $\\le 2$ | $\\le 17$ |\n| $2$ | $8$ | $\\le 5$ | $\\le 5$ |\n| $3$ | $6$ | $\\le 9$ | $\\le 9$ |\n| $4$ | $9$ | $\\le 12$ | $\\le 12$ |\n| $5$ | $17$ | $\\le 15$ | $\\le 15$ |\n| $6$ | $17$ | $\\le 16$ | $\\le 16$ |\n| $7$ | $33$ | $\\le 17$ | $\\le 17$ |\n\n对于所有数据，有 $1 \\leq n, m \\leq 17$，$A_{ij} \\in {0, 1}$。\n\n#### 说明\n\n*Von allem Anfang an bin ich nur verraten und betrogen worden!*\n\n题面与史实不尽相符。\n\n\nCredit：https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN"}}}
{"pid": "P4263", "type": "P", "difficulty": 3, "samples": [["3\n10\n2 6 1 2 1 1 2 6 7 1\n10\n10 3 6 6 3 10 6 6 6 2\n10\n8 8 10 10 10 10 8 5 8 8", "1\n1\n1\n6\n1\n8"], ["3\n10\n1 4 3 1 8 8 7 2 8 7\n10\n1 10 9 1 3 2 9 9 2 1\n10\n4 1 5 4 1 9 5 5 4 1", "1\n8\n2\n1 9\n3\n1 4 5"], ["3\n10\n3 3 10 8 8 3 10 8 10 3\n10\n2 2 8 6 8 4 2 4 4 8\n10\n6 2 5 6 7 5 7 10 2 10", "1\n3\n3\n2 4 8\n-1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Code+"], "title": "[Code+#3] 投票统计", "background": "", "description": "为了总结过去一段时间的命题工作，王队长组织了“我最喜欢的题目”评选活动，并邀请各位选手给题目进行投票。\n\n具体来说，每道题目有一个正整数作为它的编号，一共有 $n$ 名选手给它们进行投票，每位选手投且仅投给一道题，其中第 $i$ 位选手所投票的题目编号为 $a_i$。\n\n由于投票的选手众多，所以王队长请你来帮忙统计得票数。你需要找出收获选手投票最多的**题目数量**与**他们的编号**，并按**从小到大**的顺序列出这些编号。但这里有一个**例外情况**：如果所有被投票的题目得票数都相同，则王队长认为这次活动比较失败，你应该**输出-1**。\n\n", "inputFormat": "输入数据第一行包含一个正整数 $T$，表示测试数据的组数，各组数据之间没有空行。\n\n接下来 $2T$ 行，依次描述每组数据：\n\n每组数据包含两行，其中第一行包含一个正整数 $n$，表示参与这次活动的选手人数。第二行包含 $n$ 个由空格隔开的正整数 $a_1\\sim a_n$，其中第 $i$ 个数 $a_i$ 表示第 $i$ 位选手所投票的题目编号。\n\n", "outputFormat": "输出应由 $T$ 组数据组成，各组数据之间没有空行。对于每一组数据：\n\n若没有出现题面所述的例外情况，则这组测试数据输出两行，其中第一行输出一个正整数 $m$，表示收获选手投票最多的题目数量，第二行按**从小到大**的顺序输出 $m$ 个正整数，表示这些题目的编号。\n\n若出现题面所述的例外情况，则这组测试数据输出一行，请**输出-1**。\n", "hint": "测试点编号|$n$的范围|$a_i$的范围|特殊约定\n-|-|-|-\n1|$=2000$|$\\leq n$|得票数最多的题目唯一\n2|同上|同上|同上\n3|同上|$\\leq 10^9$|同上\n4|同上|$\\leq n$|不会出现例外情况\n5|同上|同上|同上\n6|同上|$\\leq 10^9$|同上\n7|同上|$\\leq n$|无\n8|同上|同上|同上\n9|同上|$\\leq 10^9$|同上\n10|同上|同上|同上\n11|$=100000$|$\\leq n$|得票数最多的题目唯一\n12|同上|同上|同上\n13|同上|$\\leq 10^9$|同上\n14|同上|$\\leq n$|不会出现例外情况\n15|同上|同上|同上\n16|同上|$\\leq 10^9$|同上\n17|同上|$\\leq n$|无\n18|同上|同上|同上\n19|同上|$\\leq 10^9$|同上\n20|同上|同上|同上\n\nCredit： https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#3] Vote Counting", "background": "", "description": "To review the problem-setting work over the past period, Captain Wang organized a \"My Favorite Problem\" selection and invited all contestants to vote for the problems.\n\nSpecifically, each problem has a positive integer as its ID. There are $n$ contestants voting; each contestant votes for exactly one problem, and the $i$-th contestant votes for the problem with ID $a_i$.\n\nSince there are many voters, Captain Wang asks you to help tally the votes. You need to find the number of problems that received the most votes and their IDs, and list these IDs in ascending order. However, there is one exception: if all problems that received at least one vote have the same number of votes, then Captain Wang considers the event unsuccessful, and you should output -1.", "inputFormat": "The first line contains a positive integer $T$, the number of testdata groups. There is no blank line between groups.\n\nThe next $2T$ lines describe each group in order:\n\nEach group contains two lines. The first line contains a positive integer $n$, the number of contestants participating. The second line contains $n$ space-separated positive integers $a_1\\sim a_n$, where the $i$-th number $a_i$ is the ID of the problem voted for by the $i$-th contestant.", "outputFormat": "The output consists of $T$ groups, with no blank lines between groups. For each group:\n\nIf the exception described in the statement does not occur, output two lines for this group. On the first line, output a positive integer $m$, the number of problems that received the most votes. On the second line, output $m$ positive integers in ascending order, which are the IDs of these problems.\n\nIf the exception occurs, output one line for this group: output -1.", "hint": "Test point ID|Range of $n$|Range of $a_i$|Special notes\n-|-|-|-\n1|$=2000$|$\\leq n$|The problem with the most votes is unique\n2|Same as above|Same as above|Same as above\n3|Same as above|$\\leq 10^9$|Same as above\n4|Same as above|$\\leq n$|The exception will not occur\n5|Same as above|Same as above|Same as above\n6|Same as above|$\\leq 10^9$|Same as above\n7|Same as above|$\\leq n$|None\n8|Same as above|Same as above|Same as above\n9|Same as above|$\\leq 10^9$|Same as above\n10|Same as above|Same as above|Same as above\n11|$=100000$|$\\leq n$|The problem with the most votes is unique\n12|Same as above|Same as above|Same as above\n13|Same as above|$\\leq 10^9$|Same as above\n14|Same as above|$\\leq n$|The exception will not occur\n15|Same as above|Same as above|Same as above\n16|Same as above|$\\leq 10^9$|Same as above\n17|Same as above|$\\leq n$|None\n18|Same as above|Same as above|Same as above\n19|Same as above|$\\leq 10^9$|Same as above\n20|Same as above|Same as above|Same as above\n\nCredit: https://www.luogu.org/discuss/show?postid=35727.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#3] 投票统计", "background": "", "description": "为了总结过去一段时间的命题工作，王队长组织了“我最喜欢的题目”评选活动，并邀请各位选手给题目进行投票。\n\n具体来说，每道题目有一个正整数作为它的编号，一共有 $n$ 名选手给它们进行投票，每位选手投且仅投给一道题，其中第 $i$ 位选手所投票的题目编号为 $a_i$。\n\n由于投票的选手众多，所以王队长请你来帮忙统计得票数。你需要找出收获选手投票最多的**题目数量**与**他们的编号**，并按**从小到大**的顺序列出这些编号。但这里有一个**例外情况**：如果所有被投票的题目得票数都相同，则王队长认为这次活动比较失败，你应该**输出-1**。\n\n", "inputFormat": "输入数据第一行包含一个正整数 $T$，表示测试数据的组数，各组数据之间没有空行。\n\n接下来 $2T$ 行，依次描述每组数据：\n\n每组数据包含两行，其中第一行包含一个正整数 $n$，表示参与这次活动的选手人数。第二行包含 $n$ 个由空格隔开的正整数 $a_1\\sim a_n$，其中第 $i$ 个数 $a_i$ 表示第 $i$ 位选手所投票的题目编号。\n\n", "outputFormat": "输出应由 $T$ 组数据组成，各组数据之间没有空行。对于每一组数据：\n\n若没有出现题面所述的例外情况，则这组测试数据输出两行，其中第一行输出一个正整数 $m$，表示收获选手投票最多的题目数量，第二行按**从小到大**的顺序输出 $m$ 个正整数，表示这些题目的编号。\n\n若出现题面所述的例外情况，则这组测试数据输出一行，请**输出-1**。\n", "hint": "测试点编号|$n$的范围|$a_i$的范围|特殊约定\n-|-|-|-\n1|$=2000$|$\\leq n$|得票数最多的题目唯一\n2|同上|同上|同上\n3|同上|$\\leq 10^9$|同上\n4|同上|$\\leq n$|不会出现例外情况\n5|同上|同上|同上\n6|同上|$\\leq 10^9$|同上\n7|同上|$\\leq n$|无\n8|同上|同上|同上\n9|同上|$\\leq 10^9$|同上\n10|同上|同上|同上\n11|$=100000$|$\\leq n$|得票数最多的题目唯一\n12|同上|同上|同上\n13|同上|$\\leq 10^9$|同上\n14|同上|$\\leq n$|不会出现例外情况\n15|同上|同上|同上\n16|同上|$\\leq 10^9$|同上\n17|同上|$\\leq n$|无\n18|同上|同上|同上\n19|同上|$\\leq 10^9$|同上\n20|同上|同上|同上\n\nCredit： https://www.luogu.org/discuss/show?postid=35727", "locale": "zh-CN"}}}
{"pid": "P4264", "type": "P", "difficulty": 5, "samples": [["3\n-5 -7\n-3 10\n-2 7", "10\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2018", "USACO", "枚举", "差分"], "title": "[USACO18FEB] Teleportation S", "background": "", "description": "One of the farming chores Farmer John dislikes the most is hauling around lots of cow manure. In order to streamline this process, he comes up with a brilliant invention: the manure teleporter! Instead of hauling manure between two points in a cart behind his tractor, he can use the manure teleporter to instantly transport manure from one location to another.\nFarmer John's farm is built along a single long straight road, so any location on his farm can be described simply using its position along this road (effectively a point on the number line). A teleporter is described by two numbers $x$ and $y$, where manure brought to location $x$ can be instantly transported to location $y$.\n\nFarmer John decides to build a teleporter with the first endpoint located at $x=0$; your task is to help him determine the best choice for the other endpoint $y$. In particular, there are $N$ piles of manure on his farm ($1 \\leq N \\leq 100,000$). The $i$th pile needs to moved from position $a_i$ to position $b_i$, and Farmer John transports each pile separately from the others. If we let $d_i$ denote the amount of distance FJ drives with manure in his tractor hauling the $i$th pile, then it is possible that $d_i = |a_i-b_i|$ if he hauls the $i$th pile directly with the tractor, or that $d_i$ could potentially be less if he uses the teleporter (e.g., by hauling with his tractor from $a_i$ to $x$, then from $y$ to $b_i$).\n\nPlease help FJ determine the minimum possible sum of the $d_i$'s he can achieve by building the other endpoint $y$ of the teleporter in a carefully-chosen optimal position. The same position $y$ is used during transport of every pile.", "inputFormat": "The first line of input contains $N$. In the $N$ lines that follow, the $i$th line contains $a_i$ and $b_i$, each an integer in the range $-10^8 \\ldots 10^8$. These values are not necessarily all distinct.", "outputFormat": "Print a single number giving the minimum sum of $d_i$'s FJ can achieve. Note that this number might be too large to fit into a standard 32-bit integer, so you may need to use large integer data types like a \"long long\" in C/C++. Also you may want to consider whether the answer is necessarily an integer or not...", "hint": "In this example, by setting $y = 8$ FJ can achieve $d_1 = 2$, $d_2 = 5$, and $d_3 = 3$. Note that any value of $y$ in the range $[7,10]$ would also yield an optimal solution.\n\nProblem credits: Brian Dean", "locale": "en", "translations": {"en": {"title": "[USACO18FEB] Teleportation S", "background": "", "description": "One of the farming chores Farmer John dislikes the most is hauling around lots of cow manure. In order to streamline this process, he comes up with a brilliant invention: the manure teleporter! Instead of hauling manure between two points in a cart behind his tractor, he can use the manure teleporter to instantly transport manure from one location to another.\nFarmer John's farm is built along a single long straight road, so any location on his farm can be described simply using its position along this road (effectively a point on the number line). A teleporter is described by two numbers $x$ and $y$, where manure brought to location $x$ can be instantly transported to location $y$.\n\nFarmer John decides to build a teleporter with the first endpoint located at $x=0$; your task is to help him determine the best choice for the other endpoint $y$. In particular, there are $N$ piles of manure on his farm ($1 \\leq N \\leq 100,000$). The $i$th pile needs to moved from position $a_i$ to position $b_i$, and Farmer John transports each pile separately from the others. If we let $d_i$ denote the amount of distance FJ drives with manure in his tractor hauling the $i$th pile, then it is possible that $d_i = |a_i-b_i|$ if he hauls the $i$th pile directly with the tractor, or that $d_i$ could potentially be less if he uses the teleporter (e.g., by hauling with his tractor from $a_i$ to $x$, then from $y$ to $b_i$).\n\nPlease help FJ determine the minimum possible sum of the $d_i$'s he can achieve by building the other endpoint $y$ of the teleporter in a carefully-chosen optimal position. The same position $y$ is used during transport of every pile.", "inputFormat": "The first line of input contains $N$. In the $N$ lines that follow, the $i$th line contains $a_i$ and $b_i$, each an integer in the range $-10^8 \\ldots 10^8$. These values are not necessarily all distinct.", "outputFormat": "Print a single number giving the minimum sum of $d_i$'s FJ can achieve. Note that this number might be too large to fit into a standard 32-bit integer, so you may need to use large integer data types like a \"long long\" in C/C++. Also you may want to consider whether the answer is necessarily an integer or not...", "hint": "In this example, by setting $y = 8$ FJ can achieve $d_1 = 2$, $d_2 = 5$, and $d_3 = 3$. Note that any value of $y$ in the range $[7,10]$ would also yield an optimal solution.\n\nProblem credits: Brian Dean", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] Teleportation S", "background": "", "description": "Farmer John 最不喜欢的农活之一就是到处搬运牛粪。为了简化这一过程，他发明了一个绝妙的装置：牛粪传送器！与其用拖拉机后面的拖车搬运牛粪，他可以使用牛粪传送器将牛粪从一个位置瞬间传送到另一个位置。\n\nFarmer John 的农场建在一条笔直的长路上，因此农场上的任何位置都可以简单地用其在这条路上的位置来描述（实际上就是数轴上的一个点）。传送器由两个数字 $x$ 和 $y$ 描述，其中被带到位置 $x$ 的牛粪可以瞬间传送到位置 $y$。\n\nFarmer John 决定建造一个传送器，其第一个端点位于 $x = 0$；你的任务是帮助他确定另一个端点 $y$ 的最佳选择。特别地，农场上有 $N$ 堆牛粪（$1 \\leq N \\leq 100,000$）。第 $i$ 堆牛粪需要从位置 $a_i$ 搬运到位置 $b_i$，Farmer John 会分别搬运每一堆牛粪。如果我们用 $d_i$ 表示 Farmer John 搬运第 $i$ 堆牛粪时拖拉机行驶的距离，那么如果他直接用拖拉机搬运第 $i$ 堆牛粪，则 $d_i = |a_i - b_i|$；如果他使用传送器，则 $d_i$ 可能会更小（例如，通过用拖拉机从 $a_i$ 运到 $x$，然后从 $y$ 运到 $b_i$）。\n\n请帮助 Farmer John 确定通过将传送器的另一个端点 $y$ 建在一个精心选择的最优位置，可以实现的最小 $d_i$ 总和。搬运每堆牛粪时使用相同的 $y$ 位置。", "inputFormat": "输入的第一行包含 $N$。接下来的 $N$ 行中，第 $i$ 行包含 $a_i$ 和 $b_i$，每个整数的范围在 $-10^8 \\ldots 10^8$ 之间。这些值不一定全部不同。", "outputFormat": "输出一个数字，表示 Farmer John 可以实现的最小 $d_i$ 总和。请注意，这个数字可能超过标准 32 位整数的范围，因此可能需要使用更大的整数类型，例如 C/C++ 中的 `long long`。此外，你可能需要考虑答案是否一定是整数……", "hint": "在这个例子中，通过设置 $y = 8$，Farmer John 可以实现 $d_1 = 2$、$d_2 = 5$ 和 $d_3 = 3$。请注意，$y$ 在范围 $[7,10]$ 内的任何值也会产生最优解。\n\n题目来源：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P4265", "type": "P", "difficulty": 4, "samples": [["10 4\n0 2 8 3 6 7 5 1 4 0\n2 3\n4 2\n3 4\n7 1", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2018", "USACO", "枚举"], "title": "[USACO18FEB] Snow Boots S", "background": "", "description": "It's winter on the farm, and that means snow! There are $N$ tiles on the path from the farmhouse to the barn, conveniently numbered $1 \\dots N$, and tile $i$ is covered in $f_i$ feet of snow.\nFarmer John starts off on tile $1$ and must reach tile $N$ to wake up the cows. Tile $1$ is sheltered by the farmhouse roof, and tile $N$ is sheltered by the barn roof, so neither of these tiles has any snow. But to step on the other tiles, Farmer John needs to wear boots!\n\nIn his foul-weather backpack, Farmer John has $B$ pairs of boots, numbered $1 \\dots B$. Some pairs are more heavy-duty than others, and some pairs are more agile than others. In particular, pair $i$ lets FJ step in snow at most $s_i$ feet deep, and lets FJ move at most $d_i$ forward in each step.\n\nUnfortunately, the boots are packed in such a way that Farmer John can only access the topmost pair at any given time. So at any time, Farmer John can either put on the topmost pair of boots (discarding his old pair) or discard the topmost pair of boots (making a new pair of boots accessible).\n\nFarmer John can only change boots while standing on a tile. If that tile has $f$ feet of snow, both the boots he takes off AND the boots he puts on must be able to withstand at least $f$ feet of snow. Intermediate pairs of boots which he discards without wearing do not need to satisfy this restriction.\n\nHelp Farmer John minimize waste, by determining the minimum number of pairs of boots he needs to discard in order to reach the barn. You may assume that Farmer John is initially not wearing any boots.", "inputFormat": "The first line contains two space-separated integers $N$ and $B$ ($2 \\leq N,B \\leq 250$).\nThe second line contains $N$ space-separated integers. The $i$th integer is $f_i$, giving the depth of snow on tile $i$ ($0 \\leq f_i \\leq 10^9$). It's guaranteed that $f_1 = f_N = 0$.\n\nThe next $B$ lines contain two space-separated integers each. The first integer on line $i+2$ is $s_i$, the maximum depth of snow in which pair $i$ can step. The second integer on line $i+2$ is $d_i$, the maximum step size for pair $i$. It's guaranteed that $0 \\leq s_i \\leq 10^9$ and $1 \\leq d_i \\leq N-1$.\n\nThe boots are described in top-to-bottom order, so pair $1$ is the topmost pair in FJ's backpack, and so forth.", "outputFormat": "The output should consist of a single integer, giving the minimum number of boots Farmer John needs to discard. It's guaranteed that it will be possible for FJ to make it to the barn.", "hint": "Problem credits: Brian Dean and Dhruv Rohatgi", "locale": "en", "translations": {"en": {"title": "[USACO18FEB] Snow Boots S", "background": "", "description": "It's winter on the farm, and that means snow! There are $N$ tiles on the path from the farmhouse to the barn, conveniently numbered $1 \\dots N$, and tile $i$ is covered in $f_i$ feet of snow.\nFarmer John starts off on tile $1$ and must reach tile $N$ to wake up the cows. Tile $1$ is sheltered by the farmhouse roof, and tile $N$ is sheltered by the barn roof, so neither of these tiles has any snow. But to step on the other tiles, Farmer John needs to wear boots!\n\nIn his foul-weather backpack, Farmer John has $B$ pairs of boots, numbered $1 \\dots B$. Some pairs are more heavy-duty than others, and some pairs are more agile than others. In particular, pair $i$ lets FJ step in snow at most $s_i$ feet deep, and lets FJ move at most $d_i$ forward in each step.\n\nUnfortunately, the boots are packed in such a way that Farmer John can only access the topmost pair at any given time. So at any time, Farmer John can either put on the topmost pair of boots (discarding his old pair) or discard the topmost pair of boots (making a new pair of boots accessible).\n\nFarmer John can only change boots while standing on a tile. If that tile has $f$ feet of snow, both the boots he takes off AND the boots he puts on must be able to withstand at least $f$ feet of snow. Intermediate pairs of boots which he discards without wearing do not need to satisfy this restriction.\n\nHelp Farmer John minimize waste, by determining the minimum number of pairs of boots he needs to discard in order to reach the barn. You may assume that Farmer John is initially not wearing any boots.", "inputFormat": "The first line contains two space-separated integers $N$ and $B$ ($2 \\leq N,B \\leq 250$).\nThe second line contains $N$ space-separated integers. The $i$th integer is $f_i$, giving the depth of snow on tile $i$ ($0 \\leq f_i \\leq 10^9$). It's guaranteed that $f_1 = f_N = 0$.\n\nThe next $B$ lines contain two space-separated integers each. The first integer on line $i+2$ is $s_i$, the maximum depth of snow in which pair $i$ can step. The second integer on line $i+2$ is $d_i$, the maximum step size for pair $i$. It's guaranteed that $0 \\leq s_i \\leq 10^9$ and $1 \\leq d_i \\leq N-1$.\n\nThe boots are described in top-to-bottom order, so pair $1$ is the topmost pair in FJ's backpack, and so forth.", "outputFormat": "The output should consist of a single integer, giving the minimum number of boots Farmer John needs to discard. It's guaranteed that it will be possible for FJ to make it to the barn.", "hint": "Problem credits: Brian Dean and Dhruv Rohatgi", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] Snow Boots S", "background": "", "description": "农场的冬天到了，这意味着下雪了！从农舍到谷仓的路上有 $N$ 块地砖，方便地编号为 $1 \\dots N$，第 $i$ 块地砖上覆盖了 $f_i$ 英尺的雪。\n\nFarmer John 从第 $1$ 块地砖出发，必须到达第 $N$ 块地砖去叫醒奶牛。第 $1$ 块地砖被农舍的屋顶遮蔽，第 $N$ 块地砖被谷仓的屋顶遮蔽，因此这两块地砖上没有雪。但要踩在其他地砖上，Farmer John 需要穿靴子！\n\n在他的恶劣天气背包中，Farmer John 有 $B$ 双靴子，编号为 $1 \\dots B$。有些靴子比其他靴子更耐用，有些靴子比其他靴子更灵活。具体来说，第 $i$ 双靴子允许 Farmer John 在最多 $s_i$ 英尺深的雪中行走，并且每步最多可以移动 $d_i$ 块地砖。\n\n不幸的是，靴子的打包方式使得 Farmer John 在任何时候只能访问最上面的一双靴子。因此，Farmer John 可以随时穿上最上面的一双靴子（丢弃旧靴子）或丢弃最上面的一双靴子（使下一双靴子可访问）。\n\nFarmer John 只能在地砖上更换靴子。如果该地砖上有 $f$ 英尺的雪，那么他脱下的靴子和穿上的靴子都必须能够承受至少 $f$ 英尺的雪。他丢弃但未穿过的中间靴子不需要满足此限制。\n\n请帮助 Farmer John 最小化浪费，确定他到达谷仓需要丢弃的最少靴子对数。假设 Farmer John 最初没有穿任何靴子。", "inputFormat": "第一行包含两个以空格分隔的整数 $N$ 和 $B$（$2 \\leq N, B \\leq 250$）。\n\n第二行包含 $N$ 个以空格分隔的整数。第 $i$ 个整数是 $f_i$，表示第 $i$ 块地砖上的雪的深度（$0 \\leq f_i \\leq 10^9$）。保证 $f_1 = f_N = 0$。\n\n接下来的 $B$ 行每行包含两个以空格分隔的整数。第 $i+2$ 行的第一个整数是 $s_i$，表示第 $i$ 双靴子可以承受的最大雪深。第二个整数是 $d_i$，表示第 $i$ 双靴子的最大步长。保证 $0 \\leq s_i \\leq 10^9$ 且 $1 \\leq d_i \\leq N-1$。\n\n靴子按从上到下的顺序描述，因此第 $1$ 双靴子是背包中最上面的一双，依此类推。", "outputFormat": "输出应包含一个整数，表示 Farmer John 需要丢弃的最少靴子对数。保证 Farmer John 能够到达谷仓。", "hint": "题目来源：Brian Dean 和 Dhruv Rohatgi", "locale": "zh-CN"}}}
{"pid": "P4266", "type": "P", "difficulty": 3, "samples": [["10 2 4 3\n7 2\n8 1", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2018", "USACO", "排序"], "title": "[USACO18FEB] Rest Stops S", "background": "", "description": "Farmer John and his personal trainer Bessie are hiking up Mount Vancowver. For their purposes (and yours), the mountain can be represented as a long straight trail of length $L$ meters ($1 \\leq L \\leq 10^6$). Farmer John will hike the trail at a constant travel rate of $r_F$ seconds per meter ($1 \\leq r_F \\leq 10^6$). Since he is working on his stamina, he will not take any rest stops along the way.\nBessie, however, is allowed to take rest stops, where she might find some tasty grass. Of course, she cannot stop just anywhere! There are $N$ rest stops along the trail ($1 \\leq N \\leq 10^5$); the $i$-th stop is $x_i$ meters from the start of the trail ($0 < x_i < L$) and has a tastiness value $c_i$ ($1 \\leq c_i \\leq 10^6$). If Bessie rests at stop $i$ for $t$ seconds, she receives $c_i \\cdot t$ tastiness units.\n\nWhen not at a rest stop, Bessie will be hiking at a fixed travel rate of $r_B$ seconds per meter ($1 \\leq r_B \\leq 10^6$). Since Bessie is young and fit, $r_B$ is strictly less than $r_F$.\n\nBessie would like to maximize her consumption of tasty grass. But she is worried about Farmer John; she thinks that if at any point along the hike she is behind Farmer John on the trail, he might lose all motivation to continue!\n\nHelp Bessie find the maximum total tastiness units she can obtain while making sure that Farmer John completes the hike.", "inputFormat": "The first line of input contains four integers: $L$, $N$, $r_F$, and $r_B$. The next $N$ lines describe the rest stops. For each $i$ between $1$ and $N$, the $i+1$-st line contains two integers $x_i$ and $c_i$, describing the position of the $i$-th rest stop and the tastiness of the grass there.\nIt is guaranteed that $r_F > r_B$, and $0 < x_1 < \\dots < x_N < L $. **Note that $r_F$ and $r_B$ are given in seconds per meter!**", "outputFormat": "A single integer: the maximum total tastiness units Bessie can obtain.", "hint": "In this example, it is optimal for Bessie to stop for $7$ seconds at the $x=7$ rest stop (acquiring $14$ tastiness units) and then stop for an additional $1$ second at the $x=8$ rest stop (acquiring $1$ more tastiness unit, for a total of $15$ tastiness units).\n\nProblem credits: Dhruv Rohatgi", "locale": "en", "translations": {"en": {"title": "[USACO18FEB] Rest Stops S", "background": "", "description": "Farmer John and his personal trainer Bessie are hiking up Mount Vancowver. For their purposes (and yours), the mountain can be represented as a long straight trail of length $L$ meters ($1 \\leq L \\leq 10^6$). Farmer John will hike the trail at a constant travel rate of $r_F$ seconds per meter ($1 \\leq r_F \\leq 10^6$). Since he is working on his stamina, he will not take any rest stops along the way.\nBessie, however, is allowed to take rest stops, where she might find some tasty grass. Of course, she cannot stop just anywhere! There are $N$ rest stops along the trail ($1 \\leq N \\leq 10^5$); the $i$-th stop is $x_i$ meters from the start of the trail ($0 < x_i < L$) and has a tastiness value $c_i$ ($1 \\leq c_i \\leq 10^6$). If Bessie rests at stop $i$ for $t$ seconds, she receives $c_i \\cdot t$ tastiness units.\n\nWhen not at a rest stop, Bessie will be hiking at a fixed travel rate of $r_B$ seconds per meter ($1 \\leq r_B \\leq 10^6$). Since Bessie is young and fit, $r_B$ is strictly less than $r_F$.\n\nBessie would like to maximize her consumption of tasty grass. But she is worried about Farmer John; she thinks that if at any point along the hike she is behind Farmer John on the trail, he might lose all motivation to continue!\n\nHelp Bessie find the maximum total tastiness units she can obtain while making sure that Farmer John completes the hike.", "inputFormat": "The first line of input contains four integers: $L$, $N$, $r_F$, and $r_B$. The next $N$ lines describe the rest stops. For each $i$ between $1$ and $N$, the $i+1$-st line contains two integers $x_i$ and $c_i$, describing the position of the $i$-th rest stop and the tastiness of the grass there.\nIt is guaranteed that $r_F > r_B$, and $0 < x_1 < \\dots < x_N < L $. **Note that $r_F$ and $r_B$ are given in seconds per meter!**", "outputFormat": "A single integer: the maximum total tastiness units Bessie can obtain.", "hint": "In this example, it is optimal for Bessie to stop for $7$ seconds at the $x=7$ rest stop (acquiring $14$ tastiness units) and then stop for an additional $1$ second at the $x=8$ rest stop (acquiring $1$ more tastiness unit, for a total of $15$ tastiness units).\n\nProblem credits: Dhruv Rohatgi", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] Rest Stops S", "background": "", "description": "Farmer John 和他的私人教练 Bessie 正在攀登温哥华山。为了他们的目的（以及你的目的），这座山可以表示为一条长度为 $L$ 米的长直步道（$1 \\leq L \\leq 10^6$）。Farmer John 将以每米 $r_F$ 秒的恒定速度徒步（$1 \\leq r_F \\leq 10^6$）。由于他正在锻炼耐力，他不会在途中休息。\n\n然而，Bessie 被允许在休息站休息，她可能会在那里找到一些美味的草。当然，她不能随便停下来！步道上有 $N$ 个休息站（$1 \\leq N \\leq 10^5$）；第 $i$ 个休息站距离步道起点 $x_i$ 米（$0 < x_i < L$），并且有一个美味值 $c_i$（$1 \\leq c_i \\leq 10^6$）。如果 Bessie 在第 $i$ 个休息站休息 $t$ 秒，她会获得 $c_i \\cdot t$ 的美味单位。\n\n当不在休息站时，Bessie 将以每米 $r_B$ 秒的固定速度徒步（$1 \\leq r_B \\leq 10^6$）。由于 Bessie 年轻且健康，$r_B$ 严格小于 $r_F$。\n\nBessie 希望最大化她摄入的美味草量。但她担心 Farmer John；她认为如果在徒步的任何时刻她在步道上落后于 Farmer John，他可能会失去继续前进的动力！\n\n请帮助 Bessie 找到在确保 Farmer John 完成徒步的情况下，她能获得的最大总美味单位。", "inputFormat": "输入的第一行包含四个整数：$L$、$N$、$r_F$ 和 $r_B$。接下来的 $N$ 行描述了休息站。对于每个 $i$ 从 $1$ 到 $N$，第 $i+1$ 行包含两个整数 $x_i$ 和 $c_i$，分别描述第 $i$ 个休息站的位置和草的美味值。\n保证 $r_F > r_B$，且 $0 < x_1 < \\dots < x_N < L$。**注意，$r_F$ 和 $r_B$ 的单位是秒每米！**", "outputFormat": "输出一个整数：Bessie 能获得的最大总美味单位。", "hint": "在这个例子中，Bessie 最优的策略是在 $x=7$ 的休息站休息 $7$ 秒（获得 $14$ 个美味单位），然后在 $x=8$ 的休息站再休息 $1$ 秒（获得 $1$ 个美味单位，总共 $15$ 个美味单位）。", "locale": "zh-CN"}}}
{"pid": "P4267", "type": "P", "difficulty": 4, "samples": [["6\n1 1 2 0 0 1", "4\n2\n1\n2\n3\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2018", "USACO", "枚举"], "title": "[USACO18FEB] Taming the Herd G", "background": "", "description": "Early in the morning, Farmer John woke up to the sound of splintering wood. It was the cows, and they were breaking out of the barn again!\nFarmer John was sick and tired of the cows' morning breakouts, and he decided enough was enough: it was time to get tough. He nailed to the barn wall a counter tracking the number of days since the last breakout. So if a breakout occurred in the morning, the counter would be $0$ that day; if the most recent breakout was $3$ days ago, the counter would read $3$. Farmer John meticulously logged the counter every day.\n\nThe end of the year has come, and Farmer John is ready to do some accounting. The cows will pay, he says! But something about his log doesn't look quite right...\n\nFarmer John wants to find out how many breakouts have occurred since he started his log. However, he suspects that the cows have tampered with his log, and all he knows for sure is that he started his log on the day of a breakout. Please help him determine, for each number of breakouts that might have occurred since he started the log, the minimum number of log entries that must have been tampered with.", "inputFormat": "The first line contains a single integer $N$ ($1 \\leq N \\leq 100$), denoting the number of days since Farmer John started logging the cow breakout counter.\nThe second line contains $N$ space-separated integers. The $i$th integer is a non-negative integer $a_i$ (at most $100$), indicating that on day $i$ the counter was at $a_i$, unless the cows tampered with that day's log entry.", "outputFormat": "The output should consist of $N$ integers, one per line. The $i$th integer should be the minimum over all possible breakout sequences with $i$ breakouts, of the number of log entries that are inconsistent with that sequence.", "hint": "If there was only 1 breakout, then the correct log would look like 0 1 2 3 4 5, which is 4 entries different from the given log.\n\nIf there were 2 breakouts, then the correct log might look like 0 1 2 3 0 1, which is 2 entries different from the given log. In this case, the breakouts occurred on the first and fifth days.\n\nIf there were 3 breakouts, then the correct log might look like 0 1 2 0 0 1, which is just 1 entry different from the given log. In this case, the breakouts occurred on the first, fourth, and fifth days.\n\nAnd so on.\n\nProblem credits: Brian Dean and Dhruv Rohatgi", "locale": "en", "translations": {"en": {"title": "[USACO18FEB] Taming the Herd G", "background": "", "description": "Early in the morning, Farmer John woke up to the sound of splintering wood. It was the cows, and they were breaking out of the barn again!\nFarmer John was sick and tired of the cows' morning breakouts, and he decided enough was enough: it was time to get tough. He nailed to the barn wall a counter tracking the number of days since the last breakout. So if a breakout occurred in the morning, the counter would be $0$ that day; if the most recent breakout was $3$ days ago, the counter would read $3$. Farmer John meticulously logged the counter every day.\n\nThe end of the year has come, and Farmer John is ready to do some accounting. The cows will pay, he says! But something about his log doesn't look quite right...\n\nFarmer John wants to find out how many breakouts have occurred since he started his log. However, he suspects that the cows have tampered with his log, and all he knows for sure is that he started his log on the day of a breakout. Please help him determine, for each number of breakouts that might have occurred since he started the log, the minimum number of log entries that must have been tampered with.", "inputFormat": "The first line contains a single integer $N$ ($1 \\leq N \\leq 100$), denoting the number of days since Farmer John started logging the cow breakout counter.\nThe second line contains $N$ space-separated integers. The $i$th integer is a non-negative integer $a_i$ (at most $100$), indicating that on day $i$ the counter was at $a_i$, unless the cows tampered with that day's log entry.", "outputFormat": "The output should consist of $N$ integers, one per line. The $i$th integer should be the minimum over all possible breakout sequences with $i$ breakouts, of the number of log entries that are inconsistent with that sequence.", "hint": "If there was only 1 breakout, then the correct log would look like 0 1 2 3 4 5, which is 4 entries different from the given log.\n\nIf there were 2 breakouts, then the correct log might look like 0 1 2 3 0 1, which is 2 entries different from the given log. In this case, the breakouts occurred on the first and fifth days.\n\nIf there were 3 breakouts, then the correct log might look like 0 1 2 0 0 1, which is just 1 entry different from the given log. In this case, the breakouts occurred on the first, fourth, and fifth days.\n\nAnd so on.\n\nProblem credits: Brian Dean and Dhruv Rohatgi", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] Taming the Herd G", "background": "", "description": "清晨，Farmer John 被木头碎裂的声音吵醒。原来是奶牛们又一次从谷仓里逃出来了！\nFarmer John 对奶牛们的清晨逃跑行为感到厌烦，他决定受够了：是时候采取强硬措施了。他在谷仓的墙上钉了一个计数器，用于记录自上次逃跑以来的天数。因此，如果某天早上发生了逃跑，计数器当天会显示 $0$；如果最近一次逃跑发生在 $3$ 天前，计数器会显示 $3$。Farmer John 每天都会仔细记录计数器的值。\n\n年末到了，Farmer John 准备进行一些统计。他说，奶牛们要为此付出代价！但他发现他的记录似乎有些不对劲……\n\nFarmer John 想知道自从他开始记录以来发生了多少次逃跑。然而，他怀疑奶牛们篡改了他的记录，他唯一能确定的是他开始记录的那天发生了一次逃跑。请帮助他确定，对于可能发生的逃跑次数，记录中必须被篡改的最小条目数。", "inputFormat": "第一行包含一个整数 $N$（$1 \\leq N \\leq 100$），表示 Farmer John 开始记录奶牛逃跑计数器以来的天数。\n第二行包含 $N$ 个以空格分隔的整数。第 $i$ 个整数是一个非负整数 $a_i$（最多 $100$），表示第 $i$ 天计数器的值为 $a_i$，除非奶牛篡改了那天的记录。", "outputFormat": "输出应包含 $N$ 个整数，每行一个。第 $i$ 个整数应表示在所有可能的逃跑序列中，发生 $i$ 次逃跑时，与序列不一致的记录条目的最小数量。", "hint": "如果只有 $1$ 次逃跑，那么正确的记录应该是 `0 1 2 3 4 5`，这与给定的记录有 $4$ 个条目不同。\n\n如果有 $2$ 次逃跑，那么正确的记录可能是 `0 1 2 3 0 1`，这与给定的记录有 $2$ 个条目不同。在这种情况下，逃跑发生在第 $1$ 天和第 $5$ 天。\n\n如果有 $3$ 次逃跑，那么正确的记录可能是 `0 1 2 0 0 1`，这与给定的记录只有 $1$ 个条目不同。在这种情况下，逃跑发生在第 $1$ 天、第 $4$ 天和第 $5$ 天。\n\n以此类推。\n\n题目来源：Brian Dean 和 Dhruv Rohatgi", "locale": "zh-CN"}}}
{"pid": "P4268", "type": "P", "difficulty": 5, "samples": [["8\nbessie 3 2 6 8\nfolder1 2 3 4\nfile1 0\nfolder2 1 5\nfile2 0\nfolder3 1 7\nfile3 0\nfile4 0", "42"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "USACO", "树形 DP"], "title": "[USACO18FEB] Directory Traversal G", "background": "", "description": "Bessie the cow is surprisingly computer savvy. On her computer in the barn, she stores all of her precious files in a collection of directories; for example:\n\n```\nbessie/\n  folder1/\n    file1\n    folder2/\n      file2\n  folder3/\n    file3\n  file4\n```\n\nThere is a single \"top level\" directory, called bessie.\n\nBessie can navigate to be inside any directory she wants. From a given directory, any file can be referenced by a \"relative path\". In a relative path, the symbol \"..\" refers to the parent directory. If Bessie were in folder2, she could refer to the four files as follows:\n\n```\n../file1\nfile2\n../../folder3/file3\n../../file4\n```\n\nBessie would like to choose a directory from which the sum of the lengths of the relative paths to all the files is minimized.", "inputFormat": "The first line contains an integer N ($2 \\leq N \\leq 100,000$), giving the total number of files and directories. For the purposes of input, each object (file or directory) is assigned a unique integer ID between 1 and $N$, where ID 1 refers to the top level directory.\nNext, there will be $N$ lines. Each line starts with the name of a file or directory. The name will have only lower case characters a-z and digits 0-9, and will be at most 16 characters long. Following the name is an integer, $m$. If $m$ is 0, then this entity is a file. If $m > 0$, then this entity is a directory, and it has a total of $m$ files or directories inside it. Following $m$ there will be $m$ integers giving the IDs of the entities in this directory.", "outputFormat": "Output the minimal possible total length of all relative paths to files. Note that this value may be too large to fit into a 32-bit integer.", "hint": "This input describes the example directory structure given above.\n\nThe best solution is to be in folder1. From this directory, the relative paths are:\n\n```\nfile1\nfolder2/file2\n../folder3/file3\n../file4\n```\n\nProblem credits: Mark Gordon", "locale": "en", "translations": {"en": {"title": "[USACO18FEB] Directory Traversal G", "background": "", "description": "Bessie the cow is surprisingly computer savvy. On her computer in the barn, she stores all of her precious files in a collection of directories; for example:\n\n```\nbessie/\n  folder1/\n    file1\n    folder2/\n      file2\n  folder3/\n    file3\n  file4\n```\n\nThere is a single \"top level\" directory, called bessie.\n\nBessie can navigate to be inside any directory she wants. From a given directory, any file can be referenced by a \"relative path\". In a relative path, the symbol \"..\" refers to the parent directory. If Bessie were in folder2, she could refer to the four files as follows:\n\n```\n../file1\nfile2\n../../folder3/file3\n../../file4\n```\n\nBessie would like to choose a directory from which the sum of the lengths of the relative paths to all the files is minimized.", "inputFormat": "The first line contains an integer N ($2 \\leq N \\leq 100,000$), giving the total number of files and directories. For the purposes of input, each object (file or directory) is assigned a unique integer ID between 1 and $N$, where ID 1 refers to the top level directory.\nNext, there will be $N$ lines. Each line starts with the name of a file or directory. The name will have only lower case characters a-z and digits 0-9, and will be at most 16 characters long. Following the name is an integer, $m$. If $m$ is 0, then this entity is a file. If $m > 0$, then this entity is a directory, and it has a total of $m$ files or directories inside it. Following $m$ there will be $m$ integers giving the IDs of the entities in this directory.", "outputFormat": "Output the minimal possible total length of all relative paths to files. Note that this value may be too large to fit into a 32-bit integer.", "hint": "This input describes the example directory structure given above.\n\nThe best solution is to be in folder1. From this directory, the relative paths are:\n\n```\nfile1\nfolder2/file2\n../folder3/file3\n../file4\n```\n\nProblem credits: Mark Gordon", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] Directory Traversal G", "background": "", "description": "奶牛 Bessie 出人意料地精通计算机。她在谷仓的电脑上将所有珍贵文件存储在一系列目录中；例如：\n\n```\nbessie/\n  folder1/\n    file1\n    folder2/\n      file2\n  folder3/\n    file3\n  file4\n```\n\n有一个单一的“顶级”目录，名为 `bessie`。\n\nBessie 可以导航到她想要的任何目录。从给定目录中，任何文件都可以通过“相对路径”引用。在相对路径中，符号 `..` 表示父目录。如果 Bessie 在 `folder2` 中，她可以通过以下方式引用四个文件：\n\n```\n../file1\nfile2\n../../folder3/file3\n../../file4\n```\n\nBessie 希望选择一个目录，使得从该目录到所有文件的相对路径长度之和最小。", "inputFormat": "第一行包含一个整数 $N$（$2 \\leq N \\leq 100,000$），表示文件和目录的总数。为了输入方便，每个对象（文件或目录）被分配一个唯一的整数 ID，范围在 $1$ 到 $N$ 之间，其中 ID $1$ 表示顶级目录。\n\n接下来是 $N$ 行。每行以文件或目录的名称开头。名称仅包含小写字母 `a-z` 和数字 `0-9`，且长度最多为 $16$ 个字符。名称后是一个整数 $m$。如果 $m$ 为 $0$，则该实体是一个文件。如果 $m > 0$，则该实体是一个目录，并且它内部共有 $m$ 个文件或目录。在 $m$ 之后是 $m$ 个整数，表示该目录中实体的 ID。", "outputFormat": "输出所有文件的相对路径长度的最小可能总和。请注意，此值可能超过 32 位整数的范围。", "hint": "此输入描述了上面给出的示例目录结构。\n\n最佳解决方案是位于 `folder1` 中。从该目录中，相对路径为：\n\n```\nfile1\nfolder2/file2\n../folder3/file3\n../file4\n```\n\n题目来源：Mark Gordon", "locale": "zh-CN"}}}
{"pid": "P4269", "type": "P", "difficulty": 5, "samples": [["8 7\n0 3 8 5 6 9 0 0\n0 5\n0 6\n6 2\n8 1\n10 1\n5 3\n150 7", "0\n1\n1\n0\n1\n1\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2018", "线段树", "USACO", "并查集", "单调队列", "排序"], "title": "[USACO18FEB] Snow Boots G", "background": "", "description": "It's winter on the farm, and that means snow! There are $N$ tiles on the path from the farmhouse to the barn, conveniently numbered $1 \\dots N$, and tile $i$ is covered in $f_i$ feet of snow.\nIn his farmhouse cellar, Farmer John has $B$ pairs of boots, numbered $1 \\dots B$. Some pairs are more heavy-duty than others, and some pairs are more agile than others. In particular, pair $i$ lets FJ step in snow at most $s_i$ feet deep, and lets FJ move at most $d_i$ forward in each step.\n\nFarmer John starts off on tile $1$ and must reach tile $N$ to wake up the cows. Tile $1$ is sheltered by the farmhouse roof, and tile $N$ is sheltered by the barn roof, so neither of these tiles has any snow. Help Farmer John determine which pairs of snow boots will allow him to make the trek.", "inputFormat": "The first line contains two space-separated integers $N$ and $B$ ($1 \\leq N,B \\leq 10^5$).\nThe second line contains $N$ space-separated integers; the $i$th integer is $f_i$, the depth of snow on tile $i$ ($0 \\leq f_i \\leq 10^9$). It's guaranteed that $f_1 = f_N = 0$.\n\nThe next $B$ lines contain two space-separated integers each. The first integer on line $i+2$ is $s_i$, the maximum depth of snow in which pair $i$ can step. The second integer on line $i+2$ is $d_i$, the maximum step size for pair $i$. It's guaranteed that $0 \\leq s_i \\leq 10^9$ and $1 \\leq d_i \\leq N-1$.", "outputFormat": "The output should consist of $B$ lines. Line $i$ should contain a single integer: $1$ if Farmer John can trek from tile $1$ to tile $N$ wearing the $i$th pair of boots, and $0$ otherwise.", "hint": "Problem credits: Dhruv Rohatgi", "locale": "en", "translations": {"en": {"title": "[USACO18FEB] Snow Boots G", "background": "", "description": "It's winter on the farm, and that means snow! There are $N$ tiles on the path from the farmhouse to the barn, conveniently numbered $1 \\dots N$, and tile $i$ is covered in $f_i$ feet of snow.\nIn his farmhouse cellar, Farmer John has $B$ pairs of boots, numbered $1 \\dots B$. Some pairs are more heavy-duty than others, and some pairs are more agile than others. In particular, pair $i$ lets FJ step in snow at most $s_i$ feet deep, and lets FJ move at most $d_i$ forward in each step.\n\nFarmer John starts off on tile $1$ and must reach tile $N$ to wake up the cows. Tile $1$ is sheltered by the farmhouse roof, and tile $N$ is sheltered by the barn roof, so neither of these tiles has any snow. Help Farmer John determine which pairs of snow boots will allow him to make the trek.", "inputFormat": "The first line contains two space-separated integers $N$ and $B$ ($1 \\leq N,B \\leq 10^5$).\nThe second line contains $N$ space-separated integers; the $i$th integer is $f_i$, the depth of snow on tile $i$ ($0 \\leq f_i \\leq 10^9$). It's guaranteed that $f_1 = f_N = 0$.\n\nThe next $B$ lines contain two space-separated integers each. The first integer on line $i+2$ is $s_i$, the maximum depth of snow in which pair $i$ can step. The second integer on line $i+2$ is $d_i$, the maximum step size for pair $i$. It's guaranteed that $0 \\leq s_i \\leq 10^9$ and $1 \\leq d_i \\leq N-1$.", "outputFormat": "The output should consist of $B$ lines. Line $i$ should contain a single integer: $1$ if Farmer John can trek from tile $1$ to tile $N$ wearing the $i$th pair of boots, and $0$ otherwise.", "hint": "Problem credits: Dhruv Rohatgi", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] Snow Boots G", "background": "", "description": "到冬天了，这意味着下雪了！从农舍到牛棚的路上有 $N$ 块地砖，方便起见编号为 $1 \\dots N$，第 $i$ 块地砖上积了 $f_i$ 英尺的雪。\n在 Farmer John 的农舍的地窖中，总共有 $B$ 双靴子，编号为 $1 \\dots B$。其中某些比另一些结实，某些比另一些轻便。具体地说，第 $i$ 双靴子能够让 FJ 在至多 $s_i$ 英尺深的积雪中行走，能够让 FJ 每步至多前进 $d_i$。\n\nFarmer John 从 $1$ 号地砖出发，他必须到达 $N$ 号地砖才能叫醒奶牛们。$1$ 号地砖在农舍的屋檐下，$N$ 号地砖在牛棚的屋檐下，所以这两块地砖都没有积雪。帮助 Farmer John 求出哪些靴子可以帮助他走完这段艰辛的路程。", "inputFormat": "第一行包含两个空格分隔的整数 $N$ 和 $B$（$1 \\leq N,B \\leq 10^5$）。  \n第二行包含$N$个空格分隔的整数；第 $i$ 个整数为 $f_i$，即 $i$ 号地砖的积雪深度（$0 \\leq f_i \\leq 10^9$）。输入保证 $f_1 = f_N = 0$。\n\n下面 $B$ 行，每行包含两个空格分隔的整数。第 $i+2$ 行的第一个数为 $s_i$，表示第 $i$ 双靴子能够承受的最大积雪深度。第 $i+2$ 行的第二个数为 $d_i$，表示第 $i$ 双靴子的最大步长。输入保证 $0 \\leq s_i \\leq 10^9$ 以及 $1 \\leq d_i \\leq N-1$。", "outputFormat": "输出包含 $B$ 行。第 $i$ 行包含一个整数：如果 Farmer John 能够穿着第 $i$ 双靴子从 $1$ 号地砖走到 $N$ 号地砖，为 $1$，否则为 $0$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4270", "type": "P", "difficulty": 6, "samples": [["4", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "USACO", "数论", "欧拉函数"], "title": "[USACO18FEB] Cow Gymnasts P", "background": "", "description": "Bored of farm life, the cows have sold all their earthly possessions and joined the crew of a traveling circus. So far, the cows had been given easy acts: juggling torches, walking tightropes, riding unicycles -- nothing a handy-hoofed cow couldn't handle. However, the ringmaster wants to create a much more dramatic act for their next show.\nThe stage layout for the new act involves $N$ platforms arranged in a circle. On each platform, between $1$ and $N$ cows must form a stack, cow upon cow upon cow. When the ringmaster gives the signal, all stacks must simultaneously fall clockwise, so that the bottom cow in a stack doesn't move, the cow above her moves one platform clockwise, the next cow moves two platforms clockwise, and so forth. Being accomplished gymnasts, the cows know they will have no trouble with the technical aspect of this act. The various stacks of cows will not \"interfere\" with each other as they fall, so every cow will land on the intended platform. All of the cows landing on a platform form a new stack, which does not fall over.\n\nThe ringmaster thinks the act will be particularly dramatic if after the stacks fall, the new stack on each platform contains the same number of cows as the original stack on that platform. We call a configuration of stack sizes \"magical\" if it satisfies this condition. Please help the cows by computing the number of magical configurations. Since this number may be very large, compute its remainder modulo $10^9 + 7$.\n\nTwo configurations are considered distinct if there is any platform for which the configurations assign a different number of cows.", "inputFormat": "The input is a single integer, $N$ ($1 \\leq N \\leq 10^{12}$).", "outputFormat": "A single integer giving the number of magical configurations modulo $10^9 + 7$.", "hint": "For $N = 4$, the valid configurations are $(1,1,1,1)$, $(2,2,2,2)$, $(3,3,3,3)$, $(4,4,4,4)$, $(2,3,2,3)$, and $(3,2,3,2)$.\n\nProblem credits: Dhruv Rohatgi", "locale": "en", "translations": {"en": {"title": "[USACO18FEB] Cow Gymnasts P", "background": "", "description": "Bored of farm life, the cows have sold all their earthly possessions and joined the crew of a traveling circus. So far, the cows had been given easy acts: juggling torches, walking tightropes, riding unicycles -- nothing a handy-hoofed cow couldn't handle. However, the ringmaster wants to create a much more dramatic act for their next show.\nThe stage layout for the new act involves $N$ platforms arranged in a circle. On each platform, between $1$ and $N$ cows must form a stack, cow upon cow upon cow. When the ringmaster gives the signal, all stacks must simultaneously fall clockwise, so that the bottom cow in a stack doesn't move, the cow above her moves one platform clockwise, the next cow moves two platforms clockwise, and so forth. Being accomplished gymnasts, the cows know they will have no trouble with the technical aspect of this act. The various stacks of cows will not \"interfere\" with each other as they fall, so every cow will land on the intended platform. All of the cows landing on a platform form a new stack, which does not fall over.\n\nThe ringmaster thinks the act will be particularly dramatic if after the stacks fall, the new stack on each platform contains the same number of cows as the original stack on that platform. We call a configuration of stack sizes \"magical\" if it satisfies this condition. Please help the cows by computing the number of magical configurations. Since this number may be very large, compute its remainder modulo $10^9 + 7$.\n\nTwo configurations are considered distinct if there is any platform for which the configurations assign a different number of cows.", "inputFormat": "The input is a single integer, $N$ ($1 \\leq N \\leq 10^{12}$).", "outputFormat": "A single integer giving the number of magical configurations modulo $10^9 + 7$.", "hint": "For $N = 4$, the valid configurations are $(1,1,1,1)$, $(2,2,2,2)$, $(3,3,3,3)$, $(4,4,4,4)$, $(2,3,2,3)$, and $(3,2,3,2)$.\n\nProblem credits: Dhruv Rohatgi", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] Cow Gymnasts P", "background": "", "description": "厌倦了农场生活的奶牛们卖掉了所有的财产，加入了一个巡回马戏团。到目前为止，奶牛们被分配了一些简单的表演：杂耍火炬、走钢丝、骑独轮车——没有什么是一头灵巧的奶牛无法应付的。然而，马戏团团长希望为他们的下一场演出创造一个更加戏剧性的表演。\n\n新表演的舞台布局包括 $N$ 个平台，排列成一个圆圈。在每个平台上，必须有 $1$ 到 $N$ 头奶牛堆叠成一摞，奶牛一头叠在另一头上面。当团长发出信号时，所有的堆叠必须同时顺时针倒下，使得堆叠底部的奶牛不动，她上面的奶牛移动一个平台顺时针，再上面的奶牛移动两个平台顺时针，依此类推。作为技艺高超的体操运动员，奶牛们知道她们在技术方面不会有任何问题。各个奶牛堆叠在倒下时不会相互“干扰”，因此每头奶牛都会落在目标平台上。所有落在平台上的奶牛会形成一个新的堆叠，这个堆叠不会倒下。\n\n团长认为，如果堆叠倒下后，每个平台上的新堆叠包含的奶牛数量与原始堆叠相同，那么这个表演将特别戏剧化。我们称满足这一条件的堆叠大小为“魔法”配置。请帮助奶牛们计算魔法配置的数量。由于这个数字可能非常大，请计算其对 $10^9 + 7$ 取模的结果。\n\n如果两个配置在任何平台上分配的奶牛数量不同，则认为它们是不同的配置。", "inputFormat": "输入是一个整数 $N$（$1 \\leq N \\leq 10^{12}$）。", "outputFormat": "输出一个整数，表示魔法配置的数量对 $10^9 + 7$ 取模的结果。", "hint": "对于 $N = 4$，有效的配置是 $(1,1,1,1)$、$(2,2,2,2)$、$(3,3,3,3)$、$(4,4,4,4)$、$(2,3,2,3)$ 和 $(3,2,3,2)$。\n\n题目来源：Dhruv Rohatgi", "locale": "zh-CN"}}}
{"pid": "P4271", "type": "P", "difficulty": 6, "samples": [["7\nB -1\nQ 1\nB 1\nB 2\nQ 3\nB 2\nQ 2", "0\n2\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "USACO", "并查集", "连通块", "最近公共祖先 LCA", "树的直径", "动态树 LCT"], "title": "[USACO18FEB] New Barns P", "background": null, "description": "给你一棵树，初始没有节点。你需要支持两种操作：  \n\n- `B p` 表示新建一个节点，将它与 $p$  节点连接；若 $p=-1$，则表示不与其它节点相连  \n\n- `Q k` 表示查询在 $k$ 节点所在的连通块中，距它最远的点的距离。这里距离的定义是两点间经过的边数。", "inputFormat": "第一行一个正整数 $q$，表示操作个数。  \n接下来 $q$ 行，每行表示一个操作。", "outputFormat": "对于每个询问操作，输出一行一个整数表示答案。", "hint": "【数据范围】  \n\n对于 $100\\%$ 的数据，$1 \\le q \\le 10^5$。  \n保证操作合法。\n\nThe example input corresponds to this network of barns:\n```\n  (1) \n    \\   \n     (2)---(4)\n    /\n  (3)\n```\nIn query 1, we build barn number 1. In query 2, we ask for the distance of 1 to the farthest connected barn. Since barn 1 is connected to no other barns, the answer is 0. In query 3, we build barn number 2 and connect it to barn 1. In query 4, we build barn number 3 and connect it to barn 2. In query 5, we ask for the distance of 3 to the farthest connected barn. In this case, the farthest is barn 1, which is 2 units away. In query 6, we build barn number 4 and connect it to barn 2. In query 7, we ask for the distance of 2 to the farthest connected barn. All three barns 1, 3, 4 are the same distance away, which is 1, so this is our answer.\n\nProblem credits: Anson Hu", "locale": "zh-CN", "translations": {"en": {"title": "[USACO18FEB] New Barns P", "background": "", "description": "You need to maintain a forest that initially has no nodes. Support two types of operations:\n- `B p` builds a new node and connects it to node $p$. If $p = -1$, it is not connected to any other node.\n- `Q k` asks, within the connected component containing node $k$, for the distance to the farthest node from it. The distance is defined as the number of edges on the path between two nodes.", "inputFormat": "The first line contains a positive integer $q$, the number of operations.  \nThe next $q$ lines each describe one operation.", "outputFormat": "For each query operation, output one integer per line representing the answer.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\le q \\le 10^5$. The operations are guaranteed to be valid.\n\nThe example input corresponds to this network of barns:\n```\n  (1) \n    \\   \n     (2)---(4)\n    /\n  (3)\n```\nIn query 1, we build barn number 1. In query 2, we ask for the distance of 1 to the farthest connected barn. Since barn 1 is connected to no other barns, the answer is 0. In query 3, we build barn number 2 and connect it to barn 1. In query 4, we build barn number 3 and connect it to barn 2. In query 5, we ask for the distance of 3 to the farthest connected barn. In this case, the farthest is barn 1, which is 2 units away. In query 6, we build barn number 4 and connect it to barn 2. In query 7, we ask for the distance of 2 to the farthest connected barn. All three barns 1, 3, 4 are the same distance away, which is 1, so this is our answer.\n\nProblem credits: Anson Hu.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] New Barns P", "background": null, "description": "给你一棵树，初始没有节点。你需要支持两种操作：  \n\n- `B p` 表示新建一个节点，将它与 $p$  节点连接；若 $p=-1$，则表示不与其它节点相连  \n\n- `Q k` 表示查询在 $k$ 节点所在的连通块中，距它最远的点的距离。这里距离的定义是两点间经过的边数。", "inputFormat": "第一行一个正整数 $q$，表示操作个数。  \n接下来 $q$ 行，每行表示一个操作。", "outputFormat": "对于每个询问操作，输出一行一个整数表示答案。", "hint": "【数据范围】  \n\n对于 $100\\%$ 的数据，$1 \\le q \\le 10^5$。  \n保证操作合法。\n\nThe example input corresponds to this network of barns:\n```\n  (1) \n    \\   \n     (2)---(4)\n    /\n  (3)\n```\nIn query 1, we build barn number 1. In query 2, we ask for the distance of 1 to the farthest connected barn. Since barn 1 is connected to no other barns, the answer is 0. In query 3, we build barn number 2 and connect it to barn 1. In query 4, we build barn number 3 and connect it to barn 2. In query 5, we ask for the distance of 3 to the farthest connected barn. In this case, the farthest is barn 1, which is 2 units away. In query 6, we build barn number 4 and connect it to barn 2. In query 7, we ask for the distance of 2 to the farthest connected barn. All three barns 1, 3, 4 are the same distance away, which is 1, so this is our answer.\n\nProblem credits: Anson Hu", "locale": "zh-CN"}}}
{"pid": "P4272", "type": "P", "difficulty": 6, "samples": [["3 6 2 2\n1 4 6", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2009", "CTSC/CTS"], "title": "[CTSC2009] 序列变换", "background": "", "description": "给定一个整数序列 $X_1, X_2, X_3, ... ,X_n$ 和三个正整数 $Q, A, B$ 满足：\n\n- $1 \\leq X_i \\leq Q$ 对于任意 $1 \\leq i \\leq n$；\n\n- $X_i \\leq X_{i+1}$ 对于任意 $1 \\leq i < n$；\n\n- $A \\leq \\frac{Q-1}{n-1}$ 且 $A \\leq B$。\n\n对于任意 $1 \\leq i \\leq n$，做如下变换：$Y_i = X_i + \\delta_i$，其中 $\\delta_i$ 是一个整数。使得新序列 $Y$ 满足如下性质：\n\n- $1 \\leq Y_i \\leq Q$ 对于任意 $1 \\leq i \\leq n$；\n\n- $Y_{i+1} - Y_i \\in [A, B]$ 对于任意 $1 \\leq i < n$。\n\n对于这样一个变换，所需代价定义为 $\\operatorname{TransformCost}(X, Y) = \\sum_{i = 1}^{n}{\\left\\lvert\\delta_i\\right\\rvert}$。\n\n本题的任务即为寻找一个变换，使得 $\\operatorname{TransformCost}(X, Y)$ 最小化。\n", "inputFormat": "输入文件 sequence.in 包含两行。第一行 $4$ 个整数，$N, Q, A, B$。接下来一行包含 $N$ 个整数，分别为 $X_1, X_2, X_3, ... , X_n$。", "outputFormat": "输出文件 sequence.out 仅包含一行，为最小的 $\\operatorname{TransformCost}(X, Y)$。", "hint": "### 样例说明\n\n可以将序列变换为 $2\\ 4\\ 6$ 或者 $1\\ 3\\ 5$。前者变换代价为 $1$，后者为 $2$。因此最小 $\\operatorname{TransformCost}$ 为 $1$。\n\n### 数据规模\n\n对于 $10\\%$ 的数据 , $N \\leq 100, Q \\leq 10000, 1\\leq A, B \\leq 100$。\n\n对于 $30\\%$ 的数据 , $N \\leq 10000, Q \\leq 10000, 1\\leq A, B \\leq 100$。\n\n对于 $60\\%$ 的数据 , $N \\leq 10000, Q \\leq 10^9, 1\\leq A, B \\leq Q$。\n\n对于 $100\\%$ 的数据, $N \\leq 500000, Q \\leq 10^9, 1\\leq A, B \\leq Q$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2009] Sequence Transformation", "background": "", "description": "Given an integer sequence $X_1, X_2, X_3, \\dots, X_N$ and three positive integers $Q, A, B$ that satisfy:\n\n- $1 \\leq X_i \\leq Q$ for any $1 \\leq i \\leq N$;\n- $X_i \\leq X_{i+1}$ for any $1 \\leq i < N$;\n- $A \\leq \\frac{Q - 1}{N - 1}$ and $A \\leq B$.\n\nFor any $1 \\leq i \\leq N$, perform the transformation $Y_i = X_i + \\delta_i$, where $\\delta_i$ is an integer, such that the new sequence $Y$ satisfies:\n\n- $1 \\leq Y_i \\leq Q$ for any $1 \\leq i \\leq N$;\n- $Y_{i+1} - Y_i \\in [A, B]$ for any $1 \\leq i < N$.\n\nFor such a transformation, the required cost is defined as $\\operatorname{TransformCost}(X, Y) = \\sum_{i = 1}^{N}{\\left\\lvert\\delta_i\\right\\rvert}$.\n\nThe task is to find a transformation that minimizes $\\operatorname{TransformCost}(X, Y)$.", "inputFormat": "The first line contains $4$ integers $N, Q, A, B$.  \nThe second line contains $N$ integers, namely $X_1, X_2, \\dots, X_N$.", "outputFormat": "Output a single line with the minimal $\\operatorname{TransformCost}(X, Y)$.", "hint": "Sample Explanation.\n\nYou can transform the sequence to $2\\ 4\\ 6$ or $1\\ 3\\ 5$. The former has a cost of $1$, and the latter has a cost of $2$. Therefore, the minimal $\\operatorname{TransformCost}$ is $1$.\n\nConstraints.\n\nFor $10\\%$ of the testdata, $N \\leq 100$, $Q \\leq 10000$, $1 \\leq A, B \\leq 100$.  \nFor $30\\%$ of the testdata, $N \\leq 10000$, $Q \\leq 10000$, $1 \\leq A, B \\leq 100$.  \nFor $60\\%$ of the testdata, $N \\leq 10000$, $Q \\leq 10^9$, $1 \\leq A, B \\leq Q$.  \nFor $100\\%$ of the testdata, $N \\leq 500000$, $Q \\leq 10^9$, $1 \\leq A, B \\leq Q$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2009] 序列变换", "background": "", "description": "给定一个整数序列 $X_1, X_2, X_3, ... ,X_n$ 和三个正整数 $Q, A, B$ 满足：\n\n- $1 \\leq X_i \\leq Q$ 对于任意 $1 \\leq i \\leq n$；\n\n- $X_i \\leq X_{i+1}$ 对于任意 $1 \\leq i < n$；\n\n- $A \\leq \\frac{Q-1}{n-1}$ 且 $A \\leq B$。\n\n对于任意 $1 \\leq i \\leq n$，做如下变换：$Y_i = X_i + \\delta_i$，其中 $\\delta_i$ 是一个整数。使得新序列 $Y$ 满足如下性质：\n\n- $1 \\leq Y_i \\leq Q$ 对于任意 $1 \\leq i \\leq n$；\n\n- $Y_{i+1} - Y_i \\in [A, B]$ 对于任意 $1 \\leq i < n$。\n\n对于这样一个变换，所需代价定义为 $\\operatorname{TransformCost}(X, Y) = \\sum_{i = 1}^{n}{\\left\\lvert\\delta_i\\right\\rvert}$。\n\n本题的任务即为寻找一个变换，使得 $\\operatorname{TransformCost}(X, Y)$ 最小化。\n", "inputFormat": "输入文件 sequence.in 包含两行。第一行 $4$ 个整数，$N, Q, A, B$。接下来一行包含 $N$ 个整数，分别为 $X_1, X_2, X_3, ... , X_n$。", "outputFormat": "输出文件 sequence.out 仅包含一行，为最小的 $\\operatorname{TransformCost}(X, Y)$。", "hint": "### 样例说明\n\n可以将序列变换为 $2\\ 4\\ 6$ 或者 $1\\ 3\\ 5$。前者变换代价为 $1$，后者为 $2$。因此最小 $\\operatorname{TransformCost}$ 为 $1$。\n\n### 数据规模\n\n对于 $10\\%$ 的数据 , $N \\leq 100, Q \\leq 10000, 1\\leq A, B \\leq 100$。\n\n对于 $30\\%$ 的数据 , $N \\leq 10000, Q \\leq 10000, 1\\leq A, B \\leq 100$。\n\n对于 $60\\%$ 的数据 , $N \\leq 10000, Q \\leq 10^9, 1\\leq A, B \\leq Q$。\n\n对于 $100\\%$ 的数据, $N \\leq 500000, Q \\leq 10^9, 1\\leq A, B \\leq Q$。", "locale": "zh-CN"}}}
{"pid": "P4273", "type": "P", "difficulty": 5, "samples": [["2 4 3 10\n0 1 1\n3 1 -1", "65.00"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2004", "NOI"], "title": "[NOI2004] 降雨量", "background": null, "description": "M 国是个多雨的国家，尤其是 P 城，频繁的降雨给人们的出行带来了不少麻烦。为了方便行人雨天过马路，有关部门在每处人行横道的上空都安装了一种名为“自动伞”的装置。（如图 $1$ 所示）\n![](https://cdn.luogu.com.cn/upload/image_hosting/109hsm74.png)\n每把自动伞都可以近似地看作一块长方形的板，厚度不计。这种伞有相当出色的吸水能力，落到上面的雨水都会完全被伞顶的小孔吸入，并通过管道运走。不下雨时，这些伞闲置着。一旦下雨，它们便立刻开始作匀速率直线往返运动：从马路的一边以固定的速率移动到另一边，再从另一边以相同的速率返回，如此往复，直到雨停为止。任何时刻自动伞都不会越过马路的边界。有了自动伞，下雨天没带伞的行人只要躲在伞下行走，就不会被雨淋着了。\n\n由于自动伞的大小有限，当需要使用自动伞过马路的人比较多时，一把自动伞显然是不够的，所以有关部门在几处主要的人行横道上空安装了多把自动伞。每把自动伞的宽度都等于人行横道的宽度，高度各不相同，长度不一定相同，移动速率也不一定相同。\n\n现在已知一处人行横道的详细情况，请你计算从开始下雨到 $T$ 秒钟后的这段时间内，一共有多少体积的雨水降落到人行横道上。", "inputFormat": "第一行有四个整数 $N$，$W$，$T$，$V$。$N$ 表示自动伞的数目，$W$ 表示马路的宽度，$T$ 表示需要统计从开始下雨到多长时间后的降雨情况，$V$ 表示单位面积单位时间内的降雨体积。\n\n为了描述方便，我们画出了一个如图 $2$ 所示的天空中五把伞的剖面图，取马路左边界为原点，取向右为 $x$ 轴正方向，取向上为 $y$ 轴正方向，建立平面直角坐标系。这样，每把自动伞都可以看作平面上的一条线段。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5z9mrtlz.png)\n\n接下来的 $N$ 行，每行用三个整数描述一把自动伞。第一个数 $x$ 是伞的初始位置，用它左端点的横坐标表示。第二个数 $l$ 是伞的长度，即 $x$ 方向上的尺寸。第三个数 $v$ 是伞的速度，$v$ 的大小表示移动的速率。如果 $v > 0$，表示开始时伞向右移动；如果 $v < 0$，表示开始时伞向左移动；如果 $v = 0$，表示伞不动。", "outputFormat": "输出文件只包含一个实数，表示从开始下雨到 $T$ 秒钟后，一共有多少体积的水降落到人行横道上。输出结果精确到小数点后第二位。", "hint": "【约定】\n\n- 雨点均匀地匀速竖直下落\n\n- 自动伞和马路两者都是水平的\n\n- 自动伞的宽度和人行横道的宽度相等，都等于 $1$\n\n- $N \\leq 10$\n\n- $W \\leq 100$\n\n- $T \\leq 100$\n\n- $V \\leq 50$\n\n- 所有自动伞的往返次数之和不超过 $250$，一来一回算一个往返。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2004] Rainfall", "background": "", "description": "Country M is very rainy, especially City P, where frequent rainfall causes trouble for people traveling. To help pedestrians cross the street on rainy days, the authorities have installed a device called the \"automatic umbrella\" above every crosswalk (see Figure 1).\n![](https://cdn.luogu.com.cn/upload/image_hosting/109hsm74.png)\nEach automatic umbrella can be approximated as a rectangular board with negligible thickness. These umbrellas have excellent water absorption: any raindrops falling on them are completely absorbed by small holes on the top and carried away through pipes. When it is not raining, the umbrellas are idle. Once it starts raining, they immediately begin uniform linear back-and-forth motion: moving from one side of the road to the other at a fixed speed, then returning at the same speed, and repeating this cycle until the rain stops. At no time does an automatic umbrella cross the boundaries of the road. With these automatic umbrellas, pedestrians without umbrellas can walk under them in the rain without getting wet.\n\nSince the umbrellas are of limited size, one umbrella is obviously not enough when many people need to use them to cross the road. Therefore, multiple automatic umbrellas are installed above several main crosswalks. The width of each umbrella equals the width of the crosswalk, their heights differ, their lengths may differ, and their speeds may also differ.\n\nGiven the detailed setup of a particular crosswalk, compute the total volume of rainwater that falls onto the crosswalk during the time interval from the start of the rain to $T$ seconds.", "inputFormat": "The first line contains four integers $N$, $W$, $T$, $V$. Here, $N$ is the number of automatic umbrellas, $W$ is the width of the road, $T$ is the time duration (in seconds) from the start of the rain over which the rainfall is to be counted, and $V$ is the rainfall volume per unit area per unit time.\n\nFor clarity, consider the cross-section view of five umbrellas in the sky as shown in Figure 2. Take the left boundary of the road as the origin, the positive $x$-axis to the right, and the positive $y$-axis upward to set up a Cartesian coordinate system. In this way, each automatic umbrella can be viewed as a line segment in the plane.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5z9mrtlz.png)\n\nEach of the next $N$ lines describes one automatic umbrella with three integers. The first number $x$ is the initial position, given by the $x$-coordinate of its left endpoint. The second number $l$ is the length of the umbrella, i.e., its size in the $x$ direction. The third number $v$ is the umbrella’s velocity; the magnitude of $v$ is its speed. If $v > 0$, the umbrella initially moves to the right; if $v < 0$, it initially moves to the left; if $v = 0$, the umbrella is stationary.", "outputFormat": "Output a single real number: the total volume of rainwater that falls onto the crosswalk from the start of the rain to time $T$ seconds. The answer should be rounded to two decimal places.", "hint": "Conventions\n- Raindrops fall uniformly, straight down at a constant speed.\n- Both the automatic umbrellas and the road are horizontal.\n- The width of each automatic umbrella and the crosswalk are both equal to $1$.\n\nConstraints\n- $N \\leq 10$.\n- $W \\leq 100$.\n- $T \\leq 100$.\n- $V \\leq 50$.\n- The total number of round trips among all umbrellas does not exceed $250$; one round trip is counted as going there and back.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2004] 降雨量", "background": null, "description": "M 国是个多雨的国家，尤其是 P 城，频繁的降雨给人们的出行带来了不少麻烦。为了方便行人雨天过马路，有关部门在每处人行横道的上空都安装了一种名为“自动伞”的装置。（如图 $1$ 所示）\n![](https://cdn.luogu.com.cn/upload/image_hosting/109hsm74.png)\n每把自动伞都可以近似地看作一块长方形的板，厚度不计。这种伞有相当出色的吸水能力，落到上面的雨水都会完全被伞顶的小孔吸入，并通过管道运走。不下雨时，这些伞闲置着。一旦下雨，它们便立刻开始作匀速率直线往返运动：从马路的一边以固定的速率移动到另一边，再从另一边以相同的速率返回，如此往复，直到雨停为止。任何时刻自动伞都不会越过马路的边界。有了自动伞，下雨天没带伞的行人只要躲在伞下行走，就不会被雨淋着了。\n\n由于自动伞的大小有限，当需要使用自动伞过马路的人比较多时，一把自动伞显然是不够的，所以有关部门在几处主要的人行横道上空安装了多把自动伞。每把自动伞的宽度都等于人行横道的宽度，高度各不相同，长度不一定相同，移动速率也不一定相同。\n\n现在已知一处人行横道的详细情况，请你计算从开始下雨到 $T$ 秒钟后的这段时间内，一共有多少体积的雨水降落到人行横道上。", "inputFormat": "第一行有四个整数 $N$，$W$，$T$，$V$。$N$ 表示自动伞的数目，$W$ 表示马路的宽度，$T$ 表示需要统计从开始下雨到多长时间后的降雨情况，$V$ 表示单位面积单位时间内的降雨体积。\n\n为了描述方便，我们画出了一个如图 $2$ 所示的天空中五把伞的剖面图，取马路左边界为原点，取向右为 $x$ 轴正方向，取向上为 $y$ 轴正方向，建立平面直角坐标系。这样，每把自动伞都可以看作平面上的一条线段。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5z9mrtlz.png)\n\n接下来的 $N$ 行，每行用三个整数描述一把自动伞。第一个数 $x$ 是伞的初始位置，用它左端点的横坐标表示。第二个数 $l$ 是伞的长度，即 $x$ 方向上的尺寸。第三个数 $v$ 是伞的速度，$v$ 的大小表示移动的速率。如果 $v > 0$，表示开始时伞向右移动；如果 $v < 0$，表示开始时伞向左移动；如果 $v = 0$，表示伞不动。", "outputFormat": "输出文件只包含一个实数，表示从开始下雨到 $T$ 秒钟后，一共有多少体积的水降落到人行横道上。输出结果精确到小数点后第二位。", "hint": "【约定】\n\n- 雨点均匀地匀速竖直下落\n\n- 自动伞和马路两者都是水平的\n\n- 自动伞的宽度和人行横道的宽度相等，都等于 $1$\n\n- $N \\leq 10$\n\n- $W \\leq 100$\n\n- $T \\leq 100$\n\n- $V \\leq 50$\n\n- 所有自动伞的往返次数之和不超过 $250$，一来一回算一个往返。", "locale": "zh-CN"}}}
{"pid": "P4274", "type": "P", "difficulty": 6, "samples": [["0.5 0.2 2 4", "3000.0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "贪心", "2004", "NOI", "模拟退火"], "title": "[NOI2004] 小H的小屋", "background": "", "description": "小 H 发誓要做 $21$ 世纪最伟大的数学家。他认为，做数学家与做歌星一样，第一步要作好包装，不然本事再大也推不出去。为此他决定先在自己的住所上下功夫，让人一看就知道里面住着一个“未来的大数学家”。\n\n为了描述方便，我们以向东为 $x$ 轴正方向，向北为 $y$ 轴正方向，建立平面直角坐标系。小 H 的小屋东西长为 $100$  Hil（Hil 是小 H 自己使用的长度单位，至于怎样折合成“m”，谁也不知道）。东墙和西墙均平行于 $y$ 轴，北墙和南墙分别是斜率为 $k_1$ 和 $k_2$ 的直线，$k_1$ 和 $k_2$ 为正实数。北墙和南墙的墙角处有很多块草坪，每块草坪都是一个矩形，矩形的每条边都平行于坐标轴。相邻两块草坪的接触点恰好在墙上，接触点的横坐标被称为它所在墙的“分点”，这些分点必须是 $1$ 到 $99$ 的整数。\n\n小 H 认为，对称与不对称性的结合才能充分体现“数学美”。因此，在北墙角要有 $m$ 块草坪，在南墙角要有 $n$ 块草坪，并约定 $m \\leq n$。如果记北墙和南墙的分点集合分别为 $X_1$，$X_2$，则应满足 $X_1 \\subseteq X_2$，即北墙的任何一个分点一定是南墙的分点。\n\n由于小 H 目前还没有丰厚的收入，他必须把草坪的造价降到最低，即草坪\n的占地总面积最小。你能编程帮他解决这个难题吗？", "inputFormat": "仅一行，包含 $4$ 个数 $k_1$，$k_2$，$m$，$n$。$k_1$ 和 $k_2$ 为正实数，分别表示北墙和南墙的斜率，精确到小数点后第一位。$m$ 和 $n$ 为正整数，分别表示北墙角和南墙角的草坪的块数。", "outputFormat": "一个实数，表示草坪的最小占地总面积。精确到小数点后第一位。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/y83es0b9.png)\n【约定】\n\n○ $2 \\leq m \\leq n \\leq 100$\n\n○ 南北墙距离很远，不会出现南墙草坪和北墙草坪重叠的情况", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2004] Little H's Little House", "background": "", "description": "Little H swears to become the greatest mathematician of the 21st century. He believes that, just like singers, mathematicians need good packaging; otherwise, no matter how capable you are, you cannot get noticed. Therefore, he decides to start with his residence so that at a glance people know a \"future great mathematician\" lives inside.\n\nFor convenience, we set the positive direction of the $x$-axis to the east and the positive direction of the $y$-axis to the north, establishing a Cartesian coordinate system. Little H's house is $100$ Hil long from east to west (Hil is Little H's own unit of length; as for how it converts to \"m\", nobody knows). The east and west walls are both parallel to the $y$-axis, and the north and south walls are lines with slopes $k_1$ and $k_2$, where $k_1$ and $k_2$ are positive real numbers. There are many lawns at the corners along the north wall and the south wall; each lawn is a rectangle whose sides are parallel to the coordinate axes. The contact points of adjacent lawns lie exactly on the wall, and the $x$-coordinates of these contact points are called the wall's \"division points\". These division points must be integers from $1$ to $99$.\n\nLittle H believes that the combination of symmetry and asymmetry best reflects \"mathematical beauty\". Therefore, there must be $m$ lawns along the north wall corners and $n$ lawns along the south wall corners, with $m \\leq n$. If we denote the sets of division points on the north and south walls by $X_1$ and $X_2$ respectively, then they must satisfy $X_1 \\subseteq X_2$, that is, every division point on the north wall must also be a division point on the south wall.\n\nSince Little H does not yet have a large income, he must minimize the construction cost of the lawns, i.e., minimize the total area occupied by the lawns. Can you write a program to help him solve this problem?", "inputFormat": "A single line containing $4$ numbers $k_1$, $k_2$, $m$, $n$. The numbers $k_1$ and $k_2$ are positive real numbers representing the slopes of the north and south walls, accurate to one decimal place. The numbers $m$ and $n$ are positive integers representing the number of lawns along the north wall corners and the south wall corners, respectively.", "outputFormat": "A real number, the minimal total area occupied by the lawns, to one decimal place.", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/y83es0b9.png)\nConventions\n\n○ $2 \\leq m \\leq n \\leq 100$.\n\n○ The distance between the north and south walls is very large; there will be no overlap between lawns near the south wall and those near the north wall.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2004] 小H的小屋", "background": "", "description": "小 H 发誓要做 $21$ 世纪最伟大的数学家。他认为，做数学家与做歌星一样，第一步要作好包装，不然本事再大也推不出去。为此他决定先在自己的住所上下功夫，让人一看就知道里面住着一个“未来的大数学家”。\n\n为了描述方便，我们以向东为 $x$ 轴正方向，向北为 $y$ 轴正方向，建立平面直角坐标系。小 H 的小屋东西长为 $100$  Hil（Hil 是小 H 自己使用的长度单位，至于怎样折合成“m”，谁也不知道）。东墙和西墙均平行于 $y$ 轴，北墙和南墙分别是斜率为 $k_1$ 和 $k_2$ 的直线，$k_1$ 和 $k_2$ 为正实数。北墙和南墙的墙角处有很多块草坪，每块草坪都是一个矩形，矩形的每条边都平行于坐标轴。相邻两块草坪的接触点恰好在墙上，接触点的横坐标被称为它所在墙的“分点”，这些分点必须是 $1$ 到 $99$ 的整数。\n\n小 H 认为，对称与不对称性的结合才能充分体现“数学美”。因此，在北墙角要有 $m$ 块草坪，在南墙角要有 $n$ 块草坪，并约定 $m \\leq n$。如果记北墙和南墙的分点集合分别为 $X_1$，$X_2$，则应满足 $X_1 \\subseteq X_2$，即北墙的任何一个分点一定是南墙的分点。\n\n由于小 H 目前还没有丰厚的收入，他必须把草坪的造价降到最低，即草坪\n的占地总面积最小。你能编程帮他解决这个难题吗？", "inputFormat": "仅一行，包含 $4$ 个数 $k_1$，$k_2$，$m$，$n$。$k_1$ 和 $k_2$ 为正实数，分别表示北墙和南墙的斜率，精确到小数点后第一位。$m$ 和 $n$ 为正整数，分别表示北墙角和南墙角的草坪的块数。", "outputFormat": "一个实数，表示草坪的最小占地总面积。精确到小数点后第一位。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/y83es0b9.png)\n【约定】\n\n○ $2 \\leq m \\leq n \\leq 100$\n\n○ 南北墙距离很远，不会出现南墙草坪和北墙草坪重叠的情况", "locale": "zh-CN"}}}
{"pid": "P4275", "type": "P", "difficulty": 4, "samples": [["B\n2\n2 3\n1 5", "1\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "Fibonacci 数列"], "title": "萃香的请柬", "background": "**管理员提示：数据中存在 $l=0$，请等同于 $l=1$ 处理。**\n\n现在是宴会开始前一天\n\n![](https://cdn.luogu.com.cn/upload/pic/15052.png)", "description": "萃香在小时候就一直有一个梦想，就是邀请全乡居民一起参加宴会，在上次发动异变被灵梦退治之后她仍旧没有放弃，而是在元宵节前早早准备好了难以计数的请柬。\n\n现在，宴会即将开始，萃香却还是有一大堆请柬没有送出。经过大数学家琪露诺的严谨推算，到2018年时幻想乡的居民数目已经远远超过了外界，而这就使得宴会的邀请变得极为困难。\n\n但是，拥有\"操纵密度程度的能力\"的萃香可以分成大大小小的萃香一起去送请柬。由于小萃香的移动速度过慢，因此她决定只让大萃香曲去送请柬。\n\n开始时有S只萃香，之后每过一秒每一个大萃香会分成一大一小两个萃香，与此同时上一次分出的小萃香会积聚能量变大为大萃香。\n\n直观的说，下面是开始只有一个大萃香时前四秒的变化情况(大萃香用\"B\"表示，小萃香用\"L\"表示)\n![](https://cdn.luogu.com.cn/upload/pic/15043.png)\n\n(很容易看出，第一次的大萃香经过一秒后分成了一大一小两只萃香，之后一秒刚才分出的大萃香继续分裂，而刚才的小萃香长大为大萃香)\n\n可是，我们这位\"小小的百鬼夜行\"发现了一个严重的问题:在**经过无限长的时间**后，萃香的数目太多了。于是她决定每一次只让一段区间内的大萃香去送请柬，而她现在想要知道每一次能够送出的请柬个数。\n\n如果你能帮她完成这个任务，她就会送给你两个奖励——100分和宴会的请柬!", "inputFormat": "第一行 $S$ 个大写字母 $\\verb!B!$ 或 $\\verb!L!$，表示开始时萃香的状态。\n\n之后是一个整数 $n$ 表示询问的个数。\n\n接下来 $n$ 行每行两个整数 $l,r$ 表示询问的区间。\n", "outputFormat": "共 $n$ 行，每行一个整数 $k$，表示区间 $[l,r]$ 中大萃香的个数。", "hint": "【数据范围】:\n\n![](https://cdn.luogu.com.cn/upload/pic/15239.png)", "locale": "zh-CN", "translations": {"en": {"title": "Suika's Invitation", "background": "Admin tip: There exists $l=0$ in the testdata; please handle it the same as $l=1$.\n\nIt is now the day before the banquet begins.\n\n![](https://cdn.luogu.com.cn/upload/pic/15052.png)", "description": "Since childhood, Suika has had a dream: to invite all the residents of the village to a banquet. Even after being defeated by Reimu (Língmèng) when she caused an incident last time, she did not give up and prepared a countless number of invitations well before the Lantern Festival.\n\nNow, with the banquet about to begin, Suika still has a huge pile of invitations left to deliver. According to rigorous calculations by the great mathematician Cirno (Qílùnuò), by 2018 the population of Gensokyo has far exceeded that of the outside world, making the invitation task extremely difficult.\n\nHowever, with her \"ability to manipulate density,\" Suika can split into many Suikas of different sizes to deliver the invitations. Because the small Suikas move too slowly, she decides to let only the big Suikas go deliver the invitations.\n\nInitially, there are $S$ Suikas. Then, every second, each big Suika splits into two Suikas: one big and one small. At the same time, the small Suikas produced in the previous second accumulate energy and grow into big Suikas.\n\nIntuitively, here is what happens during the first four seconds when starting with only one big Suika (big Suika is denoted by \"B\", small Suika by \"L\"):\n![](https://cdn.luogu.com.cn/upload/pic/15043.png)\n\n(It is easy to see that the initial big Suika splits into one big and one small after one second; in the next second, the newly produced big Suika splits again, while the small Suika from the previous second grows into a big Suika.)\n\nHowever, our \"Little Pandemonium\" realized a serious problem: after an infinite amount of time, the number of Suikas becomes too large. So she decides that each time only the big Suikas within an interval will go deliver the invitations, and now she wants to know for each query how many invitations can be delivered.\n\nIf you can help her accomplish this task, she will give you two rewards — 100 points and an invitation to the banquet!", "inputFormat": "The first line contains $S$ uppercase letters $\\verb!B!$ or $\\verb!L!$, representing the initial states of the Suikas.\n\nThen an integer $n$, the number of queries.\n\nEach of the next $n$ lines contains two integers $l, r$, representing the query interval.", "outputFormat": "Output $n$ lines. Each line contains an integer $k$, the number of big Suikas in the interval $[l,r]$.", "hint": "Constraints:\n\n![](https://cdn.luogu.com.cn/upload/pic/15239.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "萃香的请柬", "background": "**管理员提示：数据中存在 $l=0$，请等同于 $l=1$ 处理。**\n\n现在是宴会开始前一天\n\n![](https://cdn.luogu.com.cn/upload/pic/15052.png)", "description": "萃香在小时候就一直有一个梦想，就是邀请全乡居民一起参加宴会，在上次发动异变被灵梦退治之后她仍旧没有放弃，而是在元宵节前早早准备好了难以计数的请柬。\n\n现在，宴会即将开始，萃香却还是有一大堆请柬没有送出。经过大数学家琪露诺的严谨推算，到2018年时幻想乡的居民数目已经远远超过了外界，而这就使得宴会的邀请变得极为困难。\n\n但是，拥有\"操纵密度程度的能力\"的萃香可以分成大大小小的萃香一起去送请柬。由于小萃香的移动速度过慢，因此她决定只让大萃香曲去送请柬。\n\n开始时有S只萃香，之后每过一秒每一个大萃香会分成一大一小两个萃香，与此同时上一次分出的小萃香会积聚能量变大为大萃香。\n\n直观的说，下面是开始只有一个大萃香时前四秒的变化情况(大萃香用\"B\"表示，小萃香用\"L\"表示)\n![](https://cdn.luogu.com.cn/upload/pic/15043.png)\n\n(很容易看出，第一次的大萃香经过一秒后分成了一大一小两只萃香，之后一秒刚才分出的大萃香继续分裂，而刚才的小萃香长大为大萃香)\n\n可是，我们这位\"小小的百鬼夜行\"发现了一个严重的问题:在**经过无限长的时间**后，萃香的数目太多了。于是她决定每一次只让一段区间内的大萃香去送请柬，而她现在想要知道每一次能够送出的请柬个数。\n\n如果你能帮她完成这个任务，她就会送给你两个奖励——100分和宴会的请柬!", "inputFormat": "第一行 $S$ 个大写字母 $\\verb!B!$ 或 $\\verb!L!$，表示开始时萃香的状态。\n\n之后是一个整数 $n$ 表示询问的个数。\n\n接下来 $n$ 行每行两个整数 $l,r$ 表示询问的区间。\n", "outputFormat": "共 $n$ 行，每行一个整数 $k$，表示区间 $[l,r]$ 中大萃香的个数。", "hint": "【数据范围】:\n\n![](https://cdn.luogu.com.cn/upload/pic/15239.png)", "locale": "zh-CN"}}}
{"pid": "P4276", "type": "P", "difficulty": 6, "samples": [["2\n4 0 0 0 4 4 4 4 0\n3 8 0 12 4 12 0\n0 \n0\n1 2\n5 5", "300.97"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "计算几何", "枚举"], "title": "封兽鵺的激光游戏", "background": "#盛大的宴会已经开始\n![](https://cdn.luogu.com.cn/upload/pic/15071.png)", "description": "在你的帮助下，萃香终于在一天内送出了所有的请柬。\n\n夜幕低垂，随着由河城荷取提供的烟花\"嗖\"的一声蹿上天际，这场盛大的宴会终于如期开始。\n\n顷刻之间，偌大的会场就已经被大家的欢声笑语充满：萃香和勇仪把酒言欢，散发着醉醺醺的酒香；帕秋莉和爱丽丝拽着魔理沙的两只胳膊争论着先逛哪边；琪露诺和大妖精在地上写写画画钻研着数学难题......一切都显得和谐而美满。\n\n可是，随着会场愈发热闹，宴会的举办者萃香总感觉还是少了些什么，转念一想，她方才发觉自己没有准备游戏活动。没有游戏的宴会又怎能叫做宴会？为了解决这个严重的问题，萃香放下了酒葫芦，找到了路边的封兽鵺请她帮忙。\n\n这可愁死封兽鵺啦！只擅长搞事情和打马赛克的她苦思冥想，终于想出了一个好主意，于是她将自己的UFO翻出来一些，再找圣白莲借几束激光，而下面就是封兽鵺制定的游戏规则：\n\n封兽鵺在平面上放置了一些实心的质量均匀的UFO(可视为凸多边形)，由于她的能力有限，所以这些UFO最多只有五条边。现在你可以从一给定点向任意方向发射一束激光(x轴正方向为0°，y轴正方形为90°，保证发射角度为两位小数，即激光从0°开始旋转，每次旋转0.01°)，激光碰到UFO的边界便会发生反射，且激光每反射一次能量便会增加w(初始能量为0)，这里要注意的是，每当一条边被激光打中过一次后便会失去反射的能力变成一条可以直接透过的边，这时候你的激光可以直接穿进UFO的内部从内部进行反射。\n\n如果你还没有理解，封兽鵺已经贴心的为你准备了下面这张图：\n![](https://cdn.luogu.com.cn/upload/pic/15112.png)\n\n本来唯恐天下不乱的封兽鵺想让激光射出时能量最大，但是萃香担心会场被破坏而将\"能量最大\"改为\"能量最接近一整数E\"。同时为了保证游戏的难度，封兽鵺会在游戏开始前将每个UFO绕重心顺时针旋转k*90°。\n\n现在，轮到了你参加这个游戏，如果你射出激光的角度与封兽鵺的答案相符，那么你就会获得两份奖励——100分和封兽鵺的写真集！\n\n当然，拥有电脑的你当然不会一次一次去试，而是通过编程预先解决这个问题，然后真正实践的时候直接用最优解拔得头筹。", "inputFormat": "第一行一个整数n，为UFO的数量。\n\n之后n行每行一个整数m，随后有m个实数对x[i],y[i]表示按顺时针顺序给出的UFO的m个顶点。\n\n之后n行每行一个整数k，表示将该UFO顺时针旋转k*90°。\n\n第2n+2行两个整数w和E，分别为每次反射激光的能量增量及规定的接近量。\n\n最后一行两个实数x0，y0表示激光的射出点。", "outputFormat": "一个实数d，保留到两位小数，表示使激光出射能量最接近E的出射角度。(如果有多个解符合题意，请输出角度最小的那个)", "hint": "【样例解释】：\n\n如图所示，当激光射出偏角为300.97度时恰好能反射两次，E1-2*w=2=E，符合题意\n![](https://cdn.luogu.com.cn/upload/pic/15105.png)\n\n#你需要特别注意的一些事:\n1. 当一束激光碰到UFO顶点的时候不认为它们相撞\n2. 多边形不会重叠，初始激光射出点不会在UFO上或UFO内\n3. 不要在这里讲科学，所以激光可以射到UFO内部进行反射\n\n\n【数据范围】：\n\n![](https://cdn.luogu.com.cn/upload/pic/15115.png)\n\n奖励：\n\n![](https://cdn.luogu.com.cn/upload/pic/15074.png)\n\n(没错就是zun绘写真集，如果你AC了此题就可以获得)\n", "locale": "zh-CN", "translations": {"en": {"title": "Houjuu Nue's Laser Game", "background": "The grand banquet has begun.\n![](https://cdn.luogu.com.cn/upload/pic/15071.png)", "description": "With your help, Suika finally delivered all the invitations in a single day.\n\nNight falls. As the fireworks provided by Nitori Kawashiro shoot into the sky with a “whoosh,” the grand banquet begins right on time.\n\nIn an instant, the huge venue fills with laughter and joy: Suika and Yuugi drink and chat, the smell of alcohol wafting around; Patchouli and Alice each pull one of Marisa’s arms, arguing about which side to explore first; Cirno and Daiyousei are scribbling on the ground, working on math problems... Everything feels harmonious and perfect.\n\nHowever, as the party gets livelier, Suika, the host, still feels like something is missing. After a moment, she realizes she forgot to prepare a game. What is a party without games? To fix this serious problem, Suika puts down her gourd and asks Houjuu Nue for help.\n\nThis gives Nue a headache! Only good at causing chaos and pixelating things, she ponders hard and finally comes up with a good idea. She takes out some of her UFOs, then borrows a few laser beams from Byakuren Hijiri. The game rules set by Houjuu Nue are as follows:\n\nHoujuu Nue places some solid, uniformly dense UFOs on the plane (each can be regarded as a convex polygon). Due to her limited ability, each UFO has at most five edges. You can fire a laser from a given point in any direction (0° along the positive x-axis, 90° along the positive y-axis; the launch angle is guaranteed to have two decimal places, i.e., the laser rotates from 0° in steps of 0.01°). When the laser hits the boundary of a UFO, it reflects. Each time it reflects, the energy increases by w (initial energy is 0). Note that once an edge is hit by the laser once, it loses its reflective ability and becomes a transparent edge. After that, your laser can pass directly into the interior of a UFO and reflect from the inside.\n\nIf you still don’t understand, Houjuu Nue has thoughtfully prepared the following diagram:\n![](https://cdn.luogu.com.cn/upload/pic/15112.png)\n\nOriginally, chaos-loving Nue wanted the laser’s energy to be as large as possible at exit, but Suika worried about damage to the venue and changed the goal to “energy closest to an integer E.” To ensure difficulty, before the game starts, Nue will rotate each UFO clockwise about its centroid by k * 90°.\n\nNow it’s your turn to play. If the angle you choose matches Nue’s answer, you will receive two prizes—100 points and Houjuu Nue’s photo book!\n\nOf course, since you have a computer, you won’t try angles one by one. You will solve the problem by programming in advance, and when it’s time to play, you will use the optimal angle to win.", "inputFormat": "- The first line contains an integer n, the number of UFOs.\n- The next n lines: each line starts with an integer m, followed by m pairs of real numbers x[i], y[i], giving the m vertices of that UFO in clockwise order.\n- The next n lines: each contains an integer k, meaning this UFO is rotated clockwise by k * 90° about its centroid.\n- The next line contains two integers w and E, the energy increment per reflection and the target integer to approach.\n- The last line contains two real numbers x0, y0, the laser’s emission point.", "outputFormat": "Output a real number d, rounded to two decimal places, the emission angle that makes the laser’s exit energy closest to E. If multiple angles satisfy the requirement, output the smallest angle.", "hint": "Sample explanation:\nAs shown in the figure, when the emission angle is 300.97°, the laser reflects exactly twice. The energy is 2 * w, which equals E, so it meets the requirement.\n![](https://cdn.luogu.com.cn/upload/pic/15105.png)\n\nThings you must pay special attention to:\n1. When a laser hits a UFO’s vertex, it is not considered a collision.\n2. Polygons do not overlap. The initial emission point is not on or inside any UFO.\n3. Don’t talk science here: the laser can enter the interior of a UFO and reflect inside.\n\nConstraints:\n![](https://cdn.luogu.com.cn/upload/pic/15115.png)\n\nRewards:\n![](https://cdn.luogu.com.cn/upload/pic/15074.png)\n\n(Yes, it’s a ZUN illustration photo book. If you AC this problem, you can get it.)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "封兽鵺的激光游戏", "background": "#盛大的宴会已经开始\n![](https://cdn.luogu.com.cn/upload/pic/15071.png)", "description": "在你的帮助下，萃香终于在一天内送出了所有的请柬。\n\n夜幕低垂，随着由河城荷取提供的烟花\"嗖\"的一声蹿上天际，这场盛大的宴会终于如期开始。\n\n顷刻之间，偌大的会场就已经被大家的欢声笑语充满：萃香和勇仪把酒言欢，散发着醉醺醺的酒香；帕秋莉和爱丽丝拽着魔理沙的两只胳膊争论着先逛哪边；琪露诺和大妖精在地上写写画画钻研着数学难题......一切都显得和谐而美满。\n\n可是，随着会场愈发热闹，宴会的举办者萃香总感觉还是少了些什么，转念一想，她方才发觉自己没有准备游戏活动。没有游戏的宴会又怎能叫做宴会？为了解决这个严重的问题，萃香放下了酒葫芦，找到了路边的封兽鵺请她帮忙。\n\n这可愁死封兽鵺啦！只擅长搞事情和打马赛克的她苦思冥想，终于想出了一个好主意，于是她将自己的UFO翻出来一些，再找圣白莲借几束激光，而下面就是封兽鵺制定的游戏规则：\n\n封兽鵺在平面上放置了一些实心的质量均匀的UFO(可视为凸多边形)，由于她的能力有限，所以这些UFO最多只有五条边。现在你可以从一给定点向任意方向发射一束激光(x轴正方向为0°，y轴正方形为90°，保证发射角度为两位小数，即激光从0°开始旋转，每次旋转0.01°)，激光碰到UFO的边界便会发生反射，且激光每反射一次能量便会增加w(初始能量为0)，这里要注意的是，每当一条边被激光打中过一次后便会失去反射的能力变成一条可以直接透过的边，这时候你的激光可以直接穿进UFO的内部从内部进行反射。\n\n如果你还没有理解，封兽鵺已经贴心的为你准备了下面这张图：\n![](https://cdn.luogu.com.cn/upload/pic/15112.png)\n\n本来唯恐天下不乱的封兽鵺想让激光射出时能量最大，但是萃香担心会场被破坏而将\"能量最大\"改为\"能量最接近一整数E\"。同时为了保证游戏的难度，封兽鵺会在游戏开始前将每个UFO绕重心顺时针旋转k*90°。\n\n现在，轮到了你参加这个游戏，如果你射出激光的角度与封兽鵺的答案相符，那么你就会获得两份奖励——100分和封兽鵺的写真集！\n\n当然，拥有电脑的你当然不会一次一次去试，而是通过编程预先解决这个问题，然后真正实践的时候直接用最优解拔得头筹。", "inputFormat": "第一行一个整数n，为UFO的数量。\n\n之后n行每行一个整数m，随后有m个实数对x[i],y[i]表示按顺时针顺序给出的UFO的m个顶点。\n\n之后n行每行一个整数k，表示将该UFO顺时针旋转k*90°。\n\n第2n+2行两个整数w和E，分别为每次反射激光的能量增量及规定的接近量。\n\n最后一行两个实数x0，y0表示激光的射出点。", "outputFormat": "一个实数d，保留到两位小数，表示使激光出射能量最接近E的出射角度。(如果有多个解符合题意，请输出角度最小的那个)", "hint": "【样例解释】：\n\n如图所示，当激光射出偏角为300.97度时恰好能反射两次，E1-2*w=2=E，符合题意\n![](https://cdn.luogu.com.cn/upload/pic/15105.png)\n\n#你需要特别注意的一些事:\n1. 当一束激光碰到UFO顶点的时候不认为它们相撞\n2. 多边形不会重叠，初始激光射出点不会在UFO上或UFO内\n3. 不要在这里讲科学，所以激光可以射到UFO内部进行反射\n\n\n【数据范围】：\n\n![](https://cdn.luogu.com.cn/upload/pic/15115.png)\n\n奖励：\n\n![](https://cdn.luogu.com.cn/upload/pic/15074.png)\n\n(没错就是zun绘写真集，如果你AC了此题就可以获得)\n", "locale": "zh-CN"}}}
{"pid": "P4277", "type": "P", "difficulty": 5, "samples": [["1\n0 0 1 1 1", "1.0000"], ["5\n0 0 0 1 1\n1 0 0 1 10\n0 0 1 0 1\n0 0 1 1 1\n2 2 1 1 1", "3.2500"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "图论", "枚举", "最短路"], "title": "河城荷取的烟花", "background": "#宴会已经接近尾声\n![](https://cdn.luogu.com.cn/upload/pic/15119.png)", "description": "快乐的时光总是这么短暂，这场宴会终究将要闭幕。\n\n为了给大家留下一个深刻而美好的印象，萃香拜托掌握着顶尖科技的河城荷取用她刚刚研制出的装置来点燃烟花。\n\n这个装置由3部分构成——一些长度为1的绳子，一些长度为$\\sqrt{ 2 }$的绳子，还有一块不能燃烧的木板。河城荷取将木板划分成长度为 1 的单元格，并标上坐标，之后将这些绳子摆在木板上连接成一个连通图(即绳子上的任意两点均可互相到达)。注意，这些绳子的两端必须放在单元格的顶点上，即长度为 1 的绳子只能放在单元格的某一边上，长度为$\\sqrt{ 2 }$的绳子只能放在单元格的某一对角线上。\n\n现在，河城荷取会在木板上任意一根绳子的端点处点火(不能从绳子的中间处点火)，点火后，火会沿着绳子向前燃烧（每根绳子都有自己的燃烧速度），并能点燃与它相接的其它绳子。\n\n比如说下面这张图，河城荷取不能在 A 点点火，但在 C 点或 B点点火都是充许的。\n\n![](https://cdn.luogu.com.cn/upload/pic/15120.png)\n\n为了演出效果，河城荷取必须保证所有绳子都燃烧完的总时间最短，可是由于绳子的条数过多，所以河城荷取找到了你来帮忙，让你帮她求出最短的总时间是多少。\n\n如果你能完成这个任务，你就会获得两个奖励——100分和观赏一场盛大的烟花盛宴！\n", "inputFormat": "第一行为一个正整数n，表示绳子的条数\n\n接下来n行每行 5 个数： X1 Y1 X2 Y2 T,其中（X1, Y1）和（X2, Y2）分别表示绳子两端的坐标，T表示这根绳子的燃烧时间，是指从绳子的某一端点火燃烧到另一端，燃完所需的时间。\n\n", "outputFormat": "第一行一个实数t，保留 4 位小数，表示所有绳子完全燃烧的最少时间。", "hint": "【样例一解释】:从任一端点火都行，燃烧时间都是 1\n\n【样例二解释】:\n\n在 (0,0)位置点火，绳子 1, 3 和 4 将被点燃，燃烧 0.5 分钟后，绳子 2 将被从中间点燃向两端燃烧，再过 0.5 分钟，绳子 1, 3, 4 将被完全燃烧，绳子5将被点燃并在 1分钟后燃烧完 (比绳子 2 早燃完)。\n\n绳子 2 从中间向两端燃烧 0.5 分钟以后，变成两小段，每段的燃烧时间是 4.5\n分钟。但因为此时两小段绳子的另一端也同时被点燃，燃烧速度变成原来的\n两倍，还需 2.25 分钟的燃烧时间， 所以总时间： 1 + 2.25 = 3.25\n\n【数据范围】:\n\n![](https://cdn.luogu.com.cn/upload/pic/15213.png)", "locale": "zh-CN", "translations": {"en": {"title": "Kawashiro Nitori's Fireworks", "background": "The banquet is nearing its end.\n![](https://cdn.luogu.com.cn/upload/pic/15119.png)", "description": "Happy times are always short; this banquet will eventually come to a close.\n\nTo leave everyone with a deep and beautiful impression, Suika asked Kawashiro Nitori, who masters cutting-edge technology, to use her newly developed device to light the fireworks.\n\nThis device consists of three parts: some ropes of length 1, some ropes of length $\\sqrt{ 2 }$, and a nonflammable wooden board. Kawashiro Nitori divides the board into unit cells of side length 1 and marks coordinates. She then lays the ropes on the board to form a connected graph (that is, any two points on the ropes can reach each other). Note that both ends of every rope must be placed on grid vertices: a rope of length 1 can only lie along an edge of a cell, and a rope of length $\\sqrt{ 2 }$ can only lie along a diagonal of a cell.\n\nNow, Kawashiro Nitori will ignite the fire at an endpoint of any rope on the board (you cannot light from the middle of a rope). After ignition, the fire propagates along the rope (each rope has its own burning time), and it can ignite any ropes connected to it.\n\nFor example, in the figure below, Kawashiro Nitori cannot light at point A, but lighting at point C or point B is allowed.\n\n![](https://cdn.luogu.com.cn/upload/pic/15120.png)\n\nFor the best performance effect, Kawashiro Nitori must minimize the total time until all ropes are completely burned. Because there are too many ropes, she asks you to help compute the minimum total time.\n\nIf you can complete this task, you will receive two rewards: 100 points and a grand fireworks show!\n\n# Description", "inputFormat": "The first line contains a positive integer n, the number of ropes.\n\nEach of the next n lines contains 5 numbers: X1 Y1 X2 Y2 T, where (X1, Y1) and (X2, Y2) are the coordinates of the two endpoints of a rope, and T is the burning time for this rope when lit from one endpoint until the fire reaches the other endpoint.", "outputFormat": "Output one real number t on the first line, with 4 decimal places, representing the minimum time for all ropes to be completely burned.", "hint": "[Sample 1 Explanation]: Igniting from either endpoint is fine; the burning time is 1.\n\n[Sample 2 Explanation]:\n\nIgnite at (0, 0). Ropes 1, 3, and 4 will be lit. After 0.5 minutes of burning, rope 2 will be ignited from its midpoint and burn toward both ends. Another 0.5 minutes later, ropes 1, 3, and 4 will be fully burned; rope 5 will be ignited and will finish burning after 1 minute (earlier than rope 2).\n\nAfter burning from the middle for 0.5 minutes, rope 2 becomes two shorter segments, each with a remaining burning time of 4.5 minutes. But since the other ends of these two segments are also lit at the same time, the burning speed doubles, so they need only 2.25 more minutes. Therefore, the total time is 1 + 2.25 = 3.25.\n\nConstraints:\n\n![](https://cdn.luogu.com.cn/upload/pic/15213.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "河城荷取的烟花", "background": "#宴会已经接近尾声\n![](https://cdn.luogu.com.cn/upload/pic/15119.png)", "description": "快乐的时光总是这么短暂，这场宴会终究将要闭幕。\n\n为了给大家留下一个深刻而美好的印象，萃香拜托掌握着顶尖科技的河城荷取用她刚刚研制出的装置来点燃烟花。\n\n这个装置由3部分构成——一些长度为1的绳子，一些长度为$\\sqrt{ 2 }$的绳子，还有一块不能燃烧的木板。河城荷取将木板划分成长度为 1 的单元格，并标上坐标，之后将这些绳子摆在木板上连接成一个连通图(即绳子上的任意两点均可互相到达)。注意，这些绳子的两端必须放在单元格的顶点上，即长度为 1 的绳子只能放在单元格的某一边上，长度为$\\sqrt{ 2 }$的绳子只能放在单元格的某一对角线上。\n\n现在，河城荷取会在木板上任意一根绳子的端点处点火(不能从绳子的中间处点火)，点火后，火会沿着绳子向前燃烧（每根绳子都有自己的燃烧速度），并能点燃与它相接的其它绳子。\n\n比如说下面这张图，河城荷取不能在 A 点点火，但在 C 点或 B点点火都是充许的。\n\n![](https://cdn.luogu.com.cn/upload/pic/15120.png)\n\n为了演出效果，河城荷取必须保证所有绳子都燃烧完的总时间最短，可是由于绳子的条数过多，所以河城荷取找到了你来帮忙，让你帮她求出最短的总时间是多少。\n\n如果你能完成这个任务，你就会获得两个奖励——100分和观赏一场盛大的烟花盛宴！\n", "inputFormat": "第一行为一个正整数n，表示绳子的条数\n\n接下来n行每行 5 个数： X1 Y1 X2 Y2 T,其中（X1, Y1）和（X2, Y2）分别表示绳子两端的坐标，T表示这根绳子的燃烧时间，是指从绳子的某一端点火燃烧到另一端，燃完所需的时间。\n\n", "outputFormat": "第一行一个实数t，保留 4 位小数，表示所有绳子完全燃烧的最少时间。", "hint": "【样例一解释】:从任一端点火都行，燃烧时间都是 1\n\n【样例二解释】:\n\n在 (0,0)位置点火，绳子 1, 3 和 4 将被点燃，燃烧 0.5 分钟后，绳子 2 将被从中间点燃向两端燃烧，再过 0.5 分钟，绳子 1, 3, 4 将被完全燃烧，绳子5将被点燃并在 1分钟后燃烧完 (比绳子 2 早燃完)。\n\n绳子 2 从中间向两端燃烧 0.5 分钟以后，变成两小段，每段的燃烧时间是 4.5\n分钟。但因为此时两小段绳子的另一端也同时被点燃，燃烧速度变成原来的\n两倍，还需 2.25 分钟的燃烧时间， 所以总时间： 1 + 2.25 = 3.25\n\n【数据范围】:\n\n![](https://cdn.luogu.com.cn/upload/pic/15213.png)", "locale": "zh-CN"}}}
{"pid": "P4278", "type": "P", "difficulty": 7, "samples": [["10\n10 5 8 28 0 19 2 31 1 22\n30\nI 6 9\nM 1 11\nI 8 17\nM 1 31\nM 6 26\nQ 2 7 6\nI 23 30\nM 31 7\nI 22 27\nM 26 18\nQ 26 17 31\nI 5 2\nI 18 13\nQ 3 3 3\nI 27 19\nQ 23 23 30\nQ 5 13 5\nI 3 0\nM 15 27\nQ 0 28 13\nQ 3 29 11\nM 2 8\nQ 12 5 7\nI 30 19\nM 11 19\nQ 17 8 29\nM 29 4\nQ 3 0 12\nI 7 18\nM 29 27", "28\n2\n31\n0\n14\n15\n14\n27\n15\n14"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["分块"], "title": "带插入区间K小值", "background": "**本题时限已经修改为 $\\text{2s}$**。\n\n**请使用常数较小的写法或者比较好的科技去过本题**。", "description": "从前有 $n$ 只跳蚤排成一行做早操，每只跳蚤都有自己的一个弹跳力 $a_i$ 。跳蚤国王看着这些跳蚤国欣欣向荣的情景，感到非常高兴。这时跳蚤国王决定理性愉悦一下，查询区间 $k$ 小值。他每次向它的随从伏特提出这样的问题：从左往右第 $x$ 个到第 $y$ 个跳蚤中，$a_i$ 第 $k$ 小的值是多少。  \n\n这可难不倒伏特，他在脑袋里使用函数式线段树前缀和的方法水掉了跳蚤国王的询问。\n\n这时伏特发现有些跳蚤跳久了弹跳力会有变化，有的会增大，有的会减少。\n\n这可难不倒伏特，他在脑袋里使用树状数组套线段树的方法水掉了跳蚤国王的询问。（orz 主席树）\n\n这时伏特发现有些迟到的跳蚤会插入到这一行的某个位置上，他感到非常生气，因为……他不会做了。\n\n请你帮一帮伏特吧。\n\n**快捷版题意：带插入、修改的区间第 $k$ 小值在线查询**。", "inputFormat": "第一行一个正整数 $n$ ，表示原来有 $n$ 只跳蚤排成一行做早操。 \n\n第二行有 $n$ 个用空格隔开的非负整数，从左至右代表每只跳蚤的弹跳力。\n\n第三行一个正整数 $q$，表示下面有多少个操作。\n\n下面一共 $q$ 行，一共三种操作对原序列的操作：（假设此时一共 $m$ 只跳蚤）\n\n1. `Q x y k`: 询问从左至右第 $x$ 只跳蚤到从左至右第 $y$ 只跳蚤中，弹跳力第 $k$ 小的跳蚤的弹跳力是多少。($1 \\le x \\le y \\le m, 1 \\le k \\le y - x + 1$)\n\n2. `M x val`: 将从左至右第 $x$ 只跳蚤的弹跳力改为 $\\textit{val}$。($1 \\le x \\le m$)\n\n3. `I x val`: 在从左至右第 $x$ 只跳蚤的前面插入一只弹跳力为 $\\textit{val}$ 的跳蚤。即插入后从左至右第 $x$ 只跳蚤是我刚插入的跳蚤。($1 \\le x \\le m + 1$)\n\n为了体现在线操作，设 $\\textit{lastans}$ 为上一次查询的时候程序输出的结果，如果之前没有查询过，则 $\\textit{lastans} = 0$。\n\n则输入的时候实际是：\n\n- `Q _x _y _k`：表示 `Q _x^lastans _y^lastans _k^lastans`\n- `M _x _val`：表示 `M _x^lastans _val^lastans`\n- `I _x _val`：表示 `I _x^lastans _val^lastans`\n\n简单来说就是操作中输入的整数都要异或上一次询问的结果进行解码。\n\n(祝 `Pascal` 的同学早日转 `C++`，就不提供 `Pascal` 版的描述了。)", "outputFormat": "对于每个询问输出回答，每行一个回答。", "hint": "$n \\le 35000$；\n插入个数 $\\le 35000$，修改个数 $\\le 70000$，查询个数 $\\le 70000$  ,$0 \\le$ 每时每刻的权值 $\\le 70000$。\n\n数据无梯度。", "locale": "zh-CN", "translations": {"en": {"title": "Range K-th Smallest with Insertions", "background": "The time limit of this problem has been changed to $\\text{2s}$.\n\nPlease use an implementation with small constants or better techniques to pass.", "description": "Once there were $n$ fleas standing in a line doing morning exercises. Each flea has its own jumping power $a_i$. The Flea King was very pleased to see their prosperity. He then decided to have some rational fun by querying the range $k$-th smallest. Each time, he asked his servant Volter the following: among the fleas from the $x$-th to the $y$-th from left to right, what is the $k$-th smallest value of $a_i$?\n\nThis did not stump Volter. He used a persistent segment tree with prefix sums in his head to deal with the king’s queries.\n\nThen Volter noticed that some fleas’ jumping power would change over time, some increasing and some decreasing.\n\nThis still did not stump Volter. He used a Binary Indexed Tree wrapped around segment trees in his head to handle the king’s queries. (orz “Chairman Tree”)\n\nHowever, Volter then found that some late fleas would be inserted at some position in the line. He became very upset because... he could not do it.\n\nPlease help Volter.\n\nQuick version of the statement: online queries for the range $k$-th smallest with insertions and modifications.", "inputFormat": "The first line contains a positive integer $n$, the initial number of fleas in a line.\n\nThe second line contains $n$ non-negative integers separated by spaces, representing each flea’s jumping power from left to right.\n\nThe third line contains a positive integer $q$, the number of operations.\n\nThen follow $q$ lines, each being one of three operations on the current sequence (suppose there are currently $m$ fleas):\n\n1. `Q x y k`: Query the $k$-th smallest jumping power among the fleas from the $x$-th to the $y$-th from left to right. ($1 \\le x \\le y \\le m, 1 \\le k \\le y - x + 1$)\n2. `M x val`: Set the jumping power of the $x$-th flea from left to right to $\\textit{val}$. ($1 \\le x \\le m$)\n3. `I x val`: Insert a flea with jumping power $\\textit{val}$ in front of the $x$-th flea from left to right. After insertion, the $x$-th flea from left to right is the newly inserted one. ($1 \\le x \\le m + 1$)\n\nTo enforce online operations, let $\\textit{lastans}$ be the result output by the program in the most recent query; if there has been no query yet, then $\\textit{lastans} = 0$.\n\nThen the actual inputs are:\n\n- `Q _x _y _k`: represents `Q _x^lastans _y^lastans _k^lastans`\n- `M _x _val`: represents `M _x^lastans _val^lastans`\n- `I _x _val`: represents `I _x^lastans _val^lastans`\n\nIn short, every integer in the operations must be XORed with the previous query’s result to decode.\n\n(Wish the classmates using `Pascal` switch to `C++` soon, so no `Pascal` version of the statement is provided.)", "outputFormat": "For each query, output the answer, one per line.", "hint": "Constraints:\n- $n \\le 35000$.\n- Number of insertions $\\le 35000$, number of modifications $\\le 70000$, number of queries $\\le 70000$, and $0 \\le$ every value at any time $\\le 70000$.\n\nThe testdata has no gradient.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "带插入区间K小值", "background": "**本题时限已经修改为 $\\text{2s}$**。\n\n**请使用常数较小的写法或者比较好的科技去过本题**。", "description": "从前有 $n$ 只跳蚤排成一行做早操，每只跳蚤都有自己的一个弹跳力 $a_i$ 。跳蚤国王看着这些跳蚤国欣欣向荣的情景，感到非常高兴。这时跳蚤国王决定理性愉悦一下，查询区间 $k$ 小值。他每次向它的随从伏特提出这样的问题：从左往右第 $x$ 个到第 $y$ 个跳蚤中，$a_i$ 第 $k$ 小的值是多少。  \n\n这可难不倒伏特，他在脑袋里使用函数式线段树前缀和的方法水掉了跳蚤国王的询问。\n\n这时伏特发现有些跳蚤跳久了弹跳力会有变化，有的会增大，有的会减少。\n\n这可难不倒伏特，他在脑袋里使用树状数组套线段树的方法水掉了跳蚤国王的询问。（orz 主席树）\n\n这时伏特发现有些迟到的跳蚤会插入到这一行的某个位置上，他感到非常生气，因为……他不会做了。\n\n请你帮一帮伏特吧。\n\n**快捷版题意：带插入、修改的区间第 $k$ 小值在线查询**。", "inputFormat": "第一行一个正整数 $n$ ，表示原来有 $n$ 只跳蚤排成一行做早操。 \n\n第二行有 $n$ 个用空格隔开的非负整数，从左至右代表每只跳蚤的弹跳力。\n\n第三行一个正整数 $q$，表示下面有多少个操作。\n\n下面一共 $q$ 行，一共三种操作对原序列的操作：（假设此时一共 $m$ 只跳蚤）\n\n1. `Q x y k`: 询问从左至右第 $x$ 只跳蚤到从左至右第 $y$ 只跳蚤中，弹跳力第 $k$ 小的跳蚤的弹跳力是多少。($1 \\le x \\le y \\le m, 1 \\le k \\le y - x + 1$)\n\n2. `M x val`: 将从左至右第 $x$ 只跳蚤的弹跳力改为 $\\textit{val}$。($1 \\le x \\le m$)\n\n3. `I x val`: 在从左至右第 $x$ 只跳蚤的前面插入一只弹跳力为 $\\textit{val}$ 的跳蚤。即插入后从左至右第 $x$ 只跳蚤是我刚插入的跳蚤。($1 \\le x \\le m + 1$)\n\n为了体现在线操作，设 $\\textit{lastans}$ 为上一次查询的时候程序输出的结果，如果之前没有查询过，则 $\\textit{lastans} = 0$。\n\n则输入的时候实际是：\n\n- `Q _x _y _k`：表示 `Q _x^lastans _y^lastans _k^lastans`\n- `M _x _val`：表示 `M _x^lastans _val^lastans`\n- `I _x _val`：表示 `I _x^lastans _val^lastans`\n\n简单来说就是操作中输入的整数都要异或上一次询问的结果进行解码。\n\n(祝 `Pascal` 的同学早日转 `C++`，就不提供 `Pascal` 版的描述了。)", "outputFormat": "对于每个询问输出回答，每行一个回答。", "hint": "$n \\le 35000$；\n插入个数 $\\le 35000$，修改个数 $\\le 70000$，查询个数 $\\le 70000$  ,$0 \\le$ 每时每刻的权值 $\\le 70000$。\n\n数据无梯度。", "locale": "zh-CN"}}}
