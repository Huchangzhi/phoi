{"pid": "P11881", "type": "P", "difficulty": 7, "samples": [["1 0 1 0 1 0 1 0", "1"], ["1 1 1 1 1 1 1 1", "19"], ["2 2 2 2 2 2 2 2", "228"], ["1 2 3 4 4 3 2 1", "135"], ["100 100 100 100 100 100 100 100", "636061137"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2024", "拉格朗日插值法", "RMI（罗马尼亚）"], "title": "[RMI 2024] 八边形 / Octagon", "background": "", "description": "\n定义满足以下条件的多边形为**好的**：\n\n- 多边形是凸的；\n- 多边形的面积非零；\n- 多边形中**至多**有 $8$ 条边；\n- 多边形中，每条边要么平行于坐标轴，要么与坐标轴成 $45^{\\circ}$ 角。\n- 平行于坐标轴的边的长度为正整数；\n- 与坐标轴成 $45^{\\circ}$ 角的边的长度为 $\\sqrt 2$ 的正整数倍。\n\n下图给出了好的多边形的示例。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yf7lyjtv.png?x-oss-process=image/resize,m_lfit,h_300)\n\n设想沿**逆时针**方向环绕整个多边形一圈，会发现多边形由若干条长度为 $1$ 或 $\\sqrt 2$ 的线段拼成。根据遍历的方向我们将线段分成八类：北/东北/东/东南/南/西南/西/西北。\n\n给定这八类线段最多能使用的数量，求出能够构造出多少种**本质不同**的好的多边形。只需要求出答案对 $(10^9+7)$ 取模后的结果。\n\n**本质不同**定义为：如果不能通过**平移**让两个多边形重合，那么这两个多边形本质不同。换句话说，两个好的多边形相同，当且仅当它们使用的八类线段数量完全相同。", "inputFormat": "一行八个非负整数，分别表示 北/东北/东/东南/南/西南/西/西北 这八类线段最多能使用的数量。\n", "outputFormat": "输出一行一个非负整数，表示答案对 $(10^9+7)$ 取模后的结果。\n", "hint": "\n#### 样例解释\n\n\n- 样例 $1$ 解释：只有 $1\\times 1$ 的方形是好的。\n- 样例 $2$ 解释：有 $19$ 种好的多边形。\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，保证输入的数是 $[0,10^9]$ 间的整数。\n\n子任务 $0$ 为样例。\n\n下表中，记 $N$ 为输入数的最大值。\n\n| 子任务编号 | $N\\le$ | 特殊性质 | 得分 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $10^9$ | $\\text{A}$ | $9$ |\n| $2$ | $100$ |  | $17$ | \n| $3$ | $2\\times 10^3$ |  | $29$ |\n| $4$ | $2\\times 10^5$ |  | $29$ |\n| $5$ | $10^9$ |  | $16$ |\n\n- 特殊性质 $\\text{A}$：没有与坐标轴成 $45^{\\circ}$ 角的线段。\n\n**请注意本题对于「本质不同」的定义。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RMI 2024] 八边形 / Octagon", "background": "", "description": "\n定义满足以下条件的多边形为**好的**：\n\n- 多边形是凸的；\n- 多边形的面积非零；\n- 多边形中**至多**有 $8$ 条边；\n- 多边形中，每条边要么平行于坐标轴，要么与坐标轴成 $45^{\\circ}$ 角。\n- 平行于坐标轴的边的长度为正整数；\n- 与坐标轴成 $45^{\\circ}$ 角的边的长度为 $\\sqrt 2$ 的正整数倍。\n\n下图给出了好的多边形的示例。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yf7lyjtv.png?x-oss-process=image/resize,m_lfit,h_300)\n\n设想沿**逆时针**方向环绕整个多边形一圈，会发现多边形由若干条长度为 $1$ 或 $\\sqrt 2$ 的线段拼成。根据遍历的方向我们将线段分成八类：北/东北/东/东南/南/西南/西/西北。\n\n给定这八类线段最多能使用的数量，求出能够构造出多少种**本质不同**的好的多边形。只需要求出答案对 $(10^9+7)$ 取模后的结果。\n\n**本质不同**定义为：如果不能通过**平移**让两个多边形重合，那么这两个多边形本质不同。换句话说，两个好的多边形相同，当且仅当它们使用的八类线段数量完全相同。", "inputFormat": "一行八个非负整数，分别表示 北/东北/东/东南/南/西南/西/西北 这八类线段最多能使用的数量。\n", "outputFormat": "输出一行一个非负整数，表示答案对 $(10^9+7)$ 取模后的结果。\n", "hint": "\n#### 样例解释\n\n\n- 样例 $1$ 解释：只有 $1\\times 1$ 的方形是好的。\n- 样例 $2$ 解释：有 $19$ 种好的多边形。\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，保证输入的数是 $[0,10^9]$ 间的整数。\n\n子任务 $0$ 为样例。\n\n下表中，记 $N$ 为输入数的最大值。\n\n| 子任务编号 | $N\\le$ | 特殊性质 | 得分 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $10^9$ | $\\text{A}$ | $9$ |\n| $2$ | $100$ |  | $17$ | \n| $3$ | $2\\times 10^3$ |  | $29$ |\n| $4$ | $2\\times 10^5$ |  | $29$ |\n| $5$ | $10^9$ |  | $16$ |\n\n- 特殊性质 $\\text{A}$：没有与坐标轴成 $45^{\\circ}$ 角的线段。\n\n**请注意本题对于「本质不同」的定义。**", "locale": "zh-CN"}}}
{"pid": "P11882", "type": "P", "difficulty": 6, "samples": [["5 3\n1 3 5 5 3 3\n2 2 4 4 1 5\n1 1 3 5 1 3", "1 1 -1 -1 -1 \n1 1 1 1 -1 \n1 1 1 1 -1 \n-1 1 1 1 3 \n-1 -1 3 3 3 "], ["10 10\n1 6 6 10 2 4\n5 4 9 8 2 5\n2 7 6 9 2 3\n6 3 10 9 6 4\n1 2 2 10 1 3\n5 1 7 6 1 3\n9 1 9 2 2 4\n4 6 8 7 2 3\n2 5 3 7 2 4\n1 8 6 10 2 3", "-1 1 1 1 1 2 2 2 2 2 \n-1 1 1 1 2 2 2 2 2 2 \n-1 -1 -1 -1 2 2 2 2 2 2 \n-1 -1 -1 -1 -1 2 2 2 2 2 \n1 1 1 2 2 2 2 2 2 2 \n1 1 6 -1 -1 2 2 2 2 2 \n1 1 6 -1 -1 2 2 2 6 -1 \n-1 -1 6 2 2 2 2 2 6 -1 \n2 2 6 2 2 2 2 2 6 -1 \n-1 -1 6 6 6 6 6 6 6 -1 "]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "2024", "分治", "RMI（罗马尼亚）"], "title": "[RMI 2024] 彩虹糖 / Skittlez", "background": "$\\text{\\underline{Taste} the rainbow, \\underline{solve} the rainbow.}$\n", "description": "\n彩虹糖包装机上有 $n$ 行 $n$ 列共 $n\\times n$ 个袋子。我们记第 $i$ 行第 $j$ 列的袋子为 $(i,j)$。\n\n有 $q$ 个操作：每个操作用六元组 $(x_1,y_1,x_2,y_2,c,k)$ 描述，意思是：\n\n- $\\forall x_1\\le i\\le x_2$，$y_1\\le j\\le y_2$，在 $(i,j)$ 中放入 $k$ 颗颜色为 $c$ 的彩虹糖。\n\n在所有操作完后，求出每一袋中，彩虹糖颜色的**绝对众数**。\n\n定义一种颜色是绝对众数，当且仅当，它出现次数**严格大于**其他颜色出现次数之和。", "inputFormat": "\n第一行，两个正整数 $n,q$。\n\n接下来 $q$ 行，每行六个正整数 $x_1,y_1,x_2,y_2,c,k$。\n", "outputFormat": "\n输出 $n$ 行，每行 $n$ 个整数，第 $i$ 行第 $j$ 个数表示 $(i,j)$ 的绝对众数。\n\n特别地，若绝对众数不存在，定义为 $-1$。", "hint": "\n#### 样例解释\n\n方便人类阅读的样例输出为\n\n```plain\n 1  1 -1 -1 -1\n 1  1  1  1 -1\n 1  1  1  1 -1\n-1  1  1  1  3\n-1 -1  3  3  3\n```\n\n```plain\n-1  1  1  1  1  2  2  2  2  2\n-1  1  1  1  2  2  2  2  2  2\n-1 -1 -1 -1  2  2  2  2  2  2\n-1 -1 -1 -1 -1  2  2  2  2  2\n 1  1  1  2  2  2  2  2  2  2\n 1  1  6 -1 -1  2  2  2  2  2\n 1  1  6 -1 -1  2  2  2  6 -1\n-1 -1  6  2  2  2  2  2  6 -1\n 2  2  6  2  2  2  2  2  6 -1\n-1 -1  6  6  6  6  6  6  6 -1\n```\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le n\\le 10^3$；\n- $1\\le q\\le 5\\times 10^5$；\n- $1\\le x_1\\le x_2\\le n$；\n- $1\\le y_1\\le y_2\\le n$；\n- $1\\le c\\le q$；\n- $1\\le k\\le 10^9$。\n\n---\n\n- $\\text{Subtask 0 (0 pts)}$：样例。\n- $\\text{Subtask 1 (7 pts)}$：$n,q\\le 20$，$k\\le 5$。\n- $\\text{Subtask 2 (21 pts)}$：至多有 $20$ 种颜色。\n- $\\text{Subtask 3 (44 pts)}$：$n\\le 300$，$q\\le 10^5$。\n- $\\text{Subtask 4 (28 pts)}$：无额外限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RMI 2024] 彩虹糖 / Skittlez", "background": "$\\text{\\underline{Taste} the rainbow, \\underline{solve} the rainbow.}$\n", "description": "\n彩虹糖包装机上有 $n$ 行 $n$ 列共 $n\\times n$ 个袋子。我们记第 $i$ 行第 $j$ 列的袋子为 $(i,j)$。\n\n有 $q$ 个操作：每个操作用六元组 $(x_1,y_1,x_2,y_2,c,k)$ 描述，意思是：\n\n- $\\forall x_1\\le i\\le x_2$，$y_1\\le j\\le y_2$，在 $(i,j)$ 中放入 $k$ 颗颜色为 $c$ 的彩虹糖。\n\n在所有操作完后，求出每一袋中，彩虹糖颜色的**绝对众数**。\n\n定义一种颜色是绝对众数，当且仅当，它出现次数**严格大于**其他颜色出现次数之和。", "inputFormat": "\n第一行，两个正整数 $n,q$。\n\n接下来 $q$ 行，每行六个正整数 $x_1,y_1,x_2,y_2,c,k$。\n", "outputFormat": "\n输出 $n$ 行，每行 $n$ 个整数，第 $i$ 行第 $j$ 个数表示 $(i,j)$ 的绝对众数。\n\n特别地，若绝对众数不存在，定义为 $-1$。", "hint": "\n#### 样例解释\n\n方便人类阅读的样例输出为\n\n```plain\n 1  1 -1 -1 -1\n 1  1  1  1 -1\n 1  1  1  1 -1\n-1  1  1  1  3\n-1 -1  3  3  3\n```\n\n```plain\n-1  1  1  1  1  2  2  2  2  2\n-1  1  1  1  2  2  2  2  2  2\n-1 -1 -1 -1  2  2  2  2  2  2\n-1 -1 -1 -1 -1  2  2  2  2  2\n 1  1  1  2  2  2  2  2  2  2\n 1  1  6 -1 -1  2  2  2  2  2\n 1  1  6 -1 -1  2  2  2  6 -1\n-1 -1  6  2  2  2  2  2  6 -1\n 2  2  6  2  2  2  2  2  6 -1\n-1 -1  6  6  6  6  6  6  6 -1\n```\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le n\\le 10^3$；\n- $1\\le q\\le 5\\times 10^5$；\n- $1\\le x_1\\le x_2\\le n$；\n- $1\\le y_1\\le y_2\\le n$；\n- $1\\le c\\le q$；\n- $1\\le k\\le 10^9$。\n\n---\n\n- $\\text{Subtask 0 (0 pts)}$：样例。\n- $\\text{Subtask 1 (7 pts)}$：$n,q\\le 20$，$k\\le 5$。\n- $\\text{Subtask 2 (21 pts)}$：至多有 $20$ 种颜色。\n- $\\text{Subtask 3 (44 pts)}$：$n\\le 300$，$q\\le 10^5$。\n- $\\text{Subtask 4 (28 pts)}$：无额外限制。\n", "locale": "zh-CN"}}}
{"pid": "P11883", "type": "P", "difficulty": 6, "samples": [["3\n5 3\n2 1 3 0 2\n10 6\n3 2 1 4 3 2 1 3 2 1\n2 3\n2 1", "YES\n000\n110\n010\n101\n101\nYES\n000000\n111000\n111110\n111111\n000011\n111011\n011111\n111111\n000111\n000001\nNO"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "Special Judge", "RMI（罗马尼亚）"], "title": "[RMI 2024] 信号 / Signals", "background": "2025/04/16：加入一份 hack 数据（#34）（[source](https://www.luogu.com.cn/ticket/XQRX670885)）。", "description": "\n给定长度为 $n$ 的非负整数序列 $a_1,a_2,\\ldots,a_n$ 和正整数 $k$。\n\n你需要构造一个长度为 $n$ 的非负整数序列 $b_1,b_2,\\ldots,b_n$，满足：\n\n- $\\forall 1\\le i\\le n$，$b_i\\in [0, 2^k)$；\n- $\\forall 1\\le i\\le n$，$\\operatorname{popcount}(b_i \\oplus b_{i\\bmod n+1})=a_i$。\n\n或者报告不存在合法解。\n\n\n这里，$\\oplus$ 代表按位异或运算，$\\operatorname{popcount}(n)$ 表示非负整数 $n$ 二进制表示下 $1$ 的个数。\n\n特别地，如果你正确地判断了解的存在性，也可以得到部分分，见【计分方式】。\n", "inputFormat": "**本题单个测试点内含有多组测试数据。**\n\n第一行，正整数 $T$，表示测试数据组数。\n\n接下来描述 $T$ 组测试数据：\n\n每组数据第一行，两个正整数 $n,k$。\n\n每组数据第二行，$n$ 个非负整数 $a_1,a_2,\\ldots,a_n$。", "outputFormat": "对于每组数据，如果无解，输出一行一个 $\\texttt{NO}$；\n\n否则输出 $(n+1)$ 行，第一行输出 $\\texttt{YES}$，接下来 $n$ 行，第 $i$ 行一个长度为 $k$ 的 $\\texttt{01}$ 串，表示 $b_i$ 二进制表示下的低 $k$ 位。", "hint": "\n### 数据范围\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le T\\le 10^5$；\n- $2\\le n$；\n- $1\\le k$；\n- $2\\le nk,\\sum nk\\le 5\\times 10^6$；\n- $0\\le a_i\\le k$。\n\n\n---\n\n- $\\text{Subtask 0 (0 pts)}$：样例。\n- $\\text{Subtask 1 (5 pts)}$：$T,n,k\\le 5$。\n- $\\text{Subtask 2 (2 pts)}$：$k=1$。\n- $\\text{Subtask 3 (8 pts)}$：$k=2$。\n- $\\text{Subtask 4 (32 pts)}$：$a_i\\le k/2$。\n- $\\text{Subtask 5 (24 pts)}$：$n\\le 5\\times 10^4$，$k\\le 20$。\n- $\\text{Subtask 6 (29 pts)}$：无额外约束。\n\n\n\n### 计分方式\n\n如果你正确地判断了解的存在性，但是构造的解不正确，你可以获得 $50\\%$ 的分数。\n\n如果你只想获得 $50\\%$ 的分数，也要保证输出格式正确，否则将无法得分。\n\n每个子任务的分数为其中每个测试点分数的最小值。\n\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RMI 2024] 信号 / Signals", "background": "2025/04/16：加入一份 hack 数据（#34）（[source](https://www.luogu.com.cn/ticket/XQRX670885)）。", "description": "\n给定长度为 $n$ 的非负整数序列 $a_1,a_2,\\ldots,a_n$ 和正整数 $k$。\n\n你需要构造一个长度为 $n$ 的非负整数序列 $b_1,b_2,\\ldots,b_n$，满足：\n\n- $\\forall 1\\le i\\le n$，$b_i\\in [0, 2^k)$；\n- $\\forall 1\\le i\\le n$，$\\operatorname{popcount}(b_i \\oplus b_{i\\bmod n+1})=a_i$。\n\n或者报告不存在合法解。\n\n\n这里，$\\oplus$ 代表按位异或运算，$\\operatorname{popcount}(n)$ 表示非负整数 $n$ 二进制表示下 $1$ 的个数。\n\n特别地，如果你正确地判断了解的存在性，也可以得到部分分，见【计分方式】。\n", "inputFormat": "**本题单个测试点内含有多组测试数据。**\n\n第一行，正整数 $T$，表示测试数据组数。\n\n接下来描述 $T$ 组测试数据：\n\n每组数据第一行，两个正整数 $n,k$。\n\n每组数据第二行，$n$ 个非负整数 $a_1,a_2,\\ldots,a_n$。", "outputFormat": "对于每组数据，如果无解，输出一行一个 $\\texttt{NO}$；\n\n否则输出 $(n+1)$ 行，第一行输出 $\\texttt{YES}$，接下来 $n$ 行，第 $i$ 行一个长度为 $k$ 的 $\\texttt{01}$ 串，表示 $b_i$ 二进制表示下的低 $k$ 位。", "hint": "\n### 数据范围\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le T\\le 10^5$；\n- $2\\le n$；\n- $1\\le k$；\n- $2\\le nk,\\sum nk\\le 5\\times 10^6$；\n- $0\\le a_i\\le k$。\n\n\n---\n\n- $\\text{Subtask 0 (0 pts)}$：样例。\n- $\\text{Subtask 1 (5 pts)}$：$T,n,k\\le 5$。\n- $\\text{Subtask 2 (2 pts)}$：$k=1$。\n- $\\text{Subtask 3 (8 pts)}$：$k=2$。\n- $\\text{Subtask 4 (32 pts)}$：$a_i\\le k/2$。\n- $\\text{Subtask 5 (24 pts)}$：$n\\le 5\\times 10^4$，$k\\le 20$。\n- $\\text{Subtask 6 (29 pts)}$：无额外约束。\n\n\n\n### 计分方式\n\n如果你正确地判断了解的存在性，但是构造的解不正确，你可以获得 $50\\%$ 的分数。\n\n如果你只想获得 $50\\%$ 的分数，也要保证输出格式正确，否则将无法得分。\n\n每个子任务的分数为其中每个测试点分数的最小值。\n\n\n", "locale": "zh-CN"}}}
{"pid": "P11884", "type": "P", "difficulty": 6, "samples": [], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2024", "交互题", "Special Judge", "RMI（罗马尼亚）"], "title": "[RMI 2024] 拉面 / Ramen", "background": "在洛谷上评测时，将如下内容粘贴至文件头：\n\n```cpp\nstd::vector<int> find_order(int N);\n\nstd::vector<std::pair<int, int>> query(const std::vector<int>& order);\n```\n\n我们在附件中提供了模板文件，你可以在该文件的基础上开始编辑。\n", "description": "\n**这是一道函数式交互题。**\n\n有 $n$ 人，编号 $0\\sim n-1$。有 $n$ 种拉面，编号 $0\\sim n-1$。\n\n第 $i$ 个人对第 $j$ 种拉面的**喜爱度**为整数 $A_{i,j}$。$A_{i,j}$ 越大，她对拉面 $j$ 越喜欢。**保证 $\\forall 0\\le p\\lt q\\le n-1$，都有 $A_{i,p}\\neq A_{i,q}$。** 注意 $A_{i,j}$ 可以 $\\lt 0$。\n\n由于拉面存量不够，每种拉面仅供一人享用。设想这 $n$ 个人以 $\\pi_0,\\pi_1,\\ldots,\\pi_{n-1}$（显然 $\\pi$ 是一个排列）的顺序点餐，首先第 $\\pi_0$ 个人会点她最喜欢的拉面，然后 $\\pi_1$ 会选择没被 $\\pi_0$ 点过的拉面中，她最喜欢的拉面，以此类推。\n\n换句话说，第 $\\pi_i$ 个人会选择第 $\\pi_0,\\pi_1,\\ldots,\\pi_{i-1}$ 个人没点过的拉面中，她最喜欢的拉面。\n\n对于排列 $\\pi$，设 $\\sigma(i)$ 为第 $i$ 个人点的拉面，定义排列 $\\pi$ 的**愉悦度**为 $\\displaystyle \\sum_{0\\le i\\lt n} A_{i,\\sigma(i)}$。\n\n你可以进行至多 $750$ 次询问：每次询问给定排列 $\\pi$，交互库会返回 $n$ 个二元组，第 $i$ 个二元组为 $(\\sigma(i),A_{i,\\sigma(i)})$。目标是找到一个排列 $\\pi$，最大化其愉悦度。\n\n### 实现细节\n\n你不需要，也不应该实现 `main` 函数。\n\n你需要实现以下的函数：\n\n```cpp \nstd::vector<int> find_order(int n);\n```\n\n- 参数 $n$：人数和拉面种类数。\n- 返回一个排列 $\\pi_0,\\pi_1,\\ldots,\\pi_{n-1}$。\n\n你可以调用以下的函数：\n\n\n```cpp \nstd::vector<std::pair<int, int>> query(const std::vector<int>& order);\n```\n\n- 参数 $\\mathrm{order}$：一个排列 $\\pi_0,\\pi_1,\\ldots,\\pi_{n-1}$。\n- 返回 $n$ 个二元组，第 $i$ 个二元组为 $(\\sigma(i),A_{i,\\sigma(i)})$，表示在给定排列下，第 $i$ 个人会吃第 $\\sigma(i)$ 种拉面，以及她对第 $\\sigma(i)$ 种拉面的喜爱度。\n\n在洛谷上评测时，将如下内容粘贴至文件头：\n\n```cpp\nstd::vector<int> find_order(int N);\n\nstd::vector<std::pair<int, int>> query(const std::vector<int>& order);\n```", "inputFormat": "见【实现细节】。\n", "outputFormat": "见【实现细节】。\n", "hint": "\n### 样例交互\n\n| 交互库 | 选手程序 |\n| - | - |\n| 调用 `find_order(2)` | |\n|  | `query({0,1})` |\n| `{{0, 9}, {1, 0}}` |  |\n|  | `query({1, 0})` |\n| `{{1, 5}, {0, 5}}` |  |\n| | 返回 `{1,0}` |\n\n在该样例中，$A_{0}=[9,5]$，$A_1=[5,0]$。显然 $\\pi=[1,0]$ 可以达成最大的愉悦度 $5+5=10$。\n\n\n### 数据范围\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le n\\le 75$；\n- $|A_{i,j}|\\le 2\\times 10^6$。\n\nstd 至多会询问 $c\\cdot n^k$ 次，其中 $c,k$ 是某个不小于 $1$ 的常数。\n\n---\n\n| 子任务 | $n=$ | 得分 |\n| :-: | :-: | :-: |\n| $1$ | $5$ | $5$ |\n| $2$ | $15$ | $15$ |\n| $3$ | $30$ | $20$ |\n| $4$ | $45$ | $20$ |\n| $5$ | $60$ | $20$ |\n| $6$ | $75$ | $20$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RMI 2024] 拉面 / Ramen", "background": "在洛谷上评测时，将如下内容粘贴至文件头：\n\n```cpp\nstd::vector<int> find_order(int N);\n\nstd::vector<std::pair<int, int>> query(const std::vector<int>& order);\n```\n\n我们在附件中提供了模板文件，你可以在该文件的基础上开始编辑。\n", "description": "\n**这是一道函数式交互题。**\n\n有 $n$ 人，编号 $0\\sim n-1$。有 $n$ 种拉面，编号 $0\\sim n-1$。\n\n第 $i$ 个人对第 $j$ 种拉面的**喜爱度**为整数 $A_{i,j}$。$A_{i,j}$ 越大，她对拉面 $j$ 越喜欢。**保证 $\\forall 0\\le p\\lt q\\le n-1$，都有 $A_{i,p}\\neq A_{i,q}$。** 注意 $A_{i,j}$ 可以 $\\lt 0$。\n\n由于拉面存量不够，每种拉面仅供一人享用。设想这 $n$ 个人以 $\\pi_0,\\pi_1,\\ldots,\\pi_{n-1}$（显然 $\\pi$ 是一个排列）的顺序点餐，首先第 $\\pi_0$ 个人会点她最喜欢的拉面，然后 $\\pi_1$ 会选择没被 $\\pi_0$ 点过的拉面中，她最喜欢的拉面，以此类推。\n\n换句话说，第 $\\pi_i$ 个人会选择第 $\\pi_0,\\pi_1,\\ldots,\\pi_{i-1}$ 个人没点过的拉面中，她最喜欢的拉面。\n\n对于排列 $\\pi$，设 $\\sigma(i)$ 为第 $i$ 个人点的拉面，定义排列 $\\pi$ 的**愉悦度**为 $\\displaystyle \\sum_{0\\le i\\lt n} A_{i,\\sigma(i)}$。\n\n你可以进行至多 $750$ 次询问：每次询问给定排列 $\\pi$，交互库会返回 $n$ 个二元组，第 $i$ 个二元组为 $(\\sigma(i),A_{i,\\sigma(i)})$。目标是找到一个排列 $\\pi$，最大化其愉悦度。\n\n### 实现细节\n\n你不需要，也不应该实现 `main` 函数。\n\n你需要实现以下的函数：\n\n```cpp \nstd::vector<int> find_order(int n);\n```\n\n- 参数 $n$：人数和拉面种类数。\n- 返回一个排列 $\\pi_0,\\pi_1,\\ldots,\\pi_{n-1}$。\n\n你可以调用以下的函数：\n\n\n```cpp \nstd::vector<std::pair<int, int>> query(const std::vector<int>& order);\n```\n\n- 参数 $\\mathrm{order}$：一个排列 $\\pi_0,\\pi_1,\\ldots,\\pi_{n-1}$。\n- 返回 $n$ 个二元组，第 $i$ 个二元组为 $(\\sigma(i),A_{i,\\sigma(i)})$，表示在给定排列下，第 $i$ 个人会吃第 $\\sigma(i)$ 种拉面，以及她对第 $\\sigma(i)$ 种拉面的喜爱度。\n\n在洛谷上评测时，将如下内容粘贴至文件头：\n\n```cpp\nstd::vector<int> find_order(int N);\n\nstd::vector<std::pair<int, int>> query(const std::vector<int>& order);\n```", "inputFormat": "见【实现细节】。\n", "outputFormat": "见【实现细节】。\n", "hint": "\n### 样例交互\n\n| 交互库 | 选手程序 |\n| - | - |\n| 调用 `find_order(2)` | |\n|  | `query({0,1})` |\n| `{{0, 9}, {1, 0}}` |  |\n|  | `query({1, 0})` |\n| `{{1, 5}, {0, 5}}` |  |\n| | 返回 `{1,0}` |\n\n在该样例中，$A_{0}=[9,5]$，$A_1=[5,0]$。显然 $\\pi=[1,0]$ 可以达成最大的愉悦度 $5+5=10$。\n\n\n### 数据范围\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le n\\le 75$；\n- $|A_{i,j}|\\le 2\\times 10^6$。\n\nstd 至多会询问 $c\\cdot n^k$ 次，其中 $c,k$ 是某个不小于 $1$ 的常数。\n\n---\n\n| 子任务 | $n=$ | 得分 |\n| :-: | :-: | :-: |\n| $1$ | $5$ | $5$ |\n| $2$ | $15$ | $15$ |\n| $3$ | $30$ | $20$ |\n| $4$ | $45$ | $20$ |\n| $5$ | $60$ | $20$ |\n| $6$ | $75$ | $20$ |", "locale": "zh-CN"}}}
{"pid": "P11885", "type": "P", "difficulty": 6, "samples": [["5 1\n4 3 4 5", "3 2 2 2 1"], ["6 2\n2 3 5 5 6", "3 4 4 3 2 1"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树上启发式合并", "2024", "分块", "RMI（罗马尼亚）"], "title": "[RMI 2024] 跑酷 / Jump Civilization", "background": "", "description": "\n有 $n$ 个岛，编号 $1\\sim n$。给定长度为 $(n-1)$ 的正整数数列 $v_1,v_2,\\ldots,v_{n-1}$。\n\n当你在岛 $i$（$1\\le i\\lt n$）上时，可以跳到岛 $(i+1)$ 上或者岛 $v_i$ 上。这里，$i\\lt v_i$。\n\n给定正整数 $k$。对于岛 $i$，定义 $f(i,k)$ 表示从它出发跳**至多** $k$ 步能够跳到的岛有多少个（包括自身）。\n\n此外，$v_i$ 还满足**特殊性质**：**对于任意 $1\\le i\\lt j\\lt n$，要么 $v_i\\le j$，要么 $v_j\\le v_i$。**\n\n对于 $i=1,2,\\ldots,n$，求出 $f(i,k)$。\n\n补充说明：即使岛 $i$ 有多种在 $k$ 步内跳到岛 $j$ 的方式，岛 $j$ 也只算一次。\n", "inputFormat": "\n第一行，两个正整数 $n,k$。\n\n第二行，$(n-1)$ 个正整数 $v_1,v_2,\\ldots,v_{n-1}$。", "outputFormat": "输出一行 $n$ 个正整数，第 $i$ 个数表示 $f(i,k)$。\n", "hint": "\n### 样例解释\n\n- 样例 $1$ 解释：以岛 $1$ 为例，跳 $0$ 步可以到达岛 $1$，跳 $1$ 步可以到达岛 $\\{2,4\\}$。所以 $f(1,1)=3$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le n\\le 3\\times 10^5$；\n- $1\\le k\\lt n$；\n- $i\\lt v_i\\le n$；\n- **对于任意 $1\\le i\\lt j\\lt n$，要么 $v_i\\le j$，要么 $v_j\\le v_i$。**\n\n\n---\n\n| 子任务 | $n\\le$ | 特殊性质 | 得分 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $2\\, 000$  |   | $6$ |\n| $2$ | $10^5$ | $\\text{A}$ | $27$ |\n| $3$ | $3\\times 10^5$ | $\\text{B}$ | $11$ |\n| $4$ | $10^5$ |  | $37$ |\n| $5$ | $3\\times 10^5$ |  | $19$ |\n\n- 特殊性质 $\\text{A}$：$k\\le 50$。\n- 特殊性质 $\\text{B}$：$v_i\\le i+2$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RMI 2024] 跑酷 / Jump Civilization", "background": "", "description": "\n有 $n$ 个岛，编号 $1\\sim n$。给定长度为 $(n-1)$ 的正整数数列 $v_1,v_2,\\ldots,v_{n-1}$。\n\n当你在岛 $i$（$1\\le i\\lt n$）上时，可以跳到岛 $(i+1)$ 上或者岛 $v_i$ 上。这里，$i\\lt v_i$。\n\n给定正整数 $k$。对于岛 $i$，定义 $f(i,k)$ 表示从它出发跳**至多** $k$ 步能够跳到的岛有多少个（包括自身）。\n\n此外，$v_i$ 还满足**特殊性质**：**对于任意 $1\\le i\\lt j\\lt n$，要么 $v_i\\le j$，要么 $v_j\\le v_i$。**\n\n对于 $i=1,2,\\ldots,n$，求出 $f(i,k)$。\n\n补充说明：即使岛 $i$ 有多种在 $k$ 步内跳到岛 $j$ 的方式，岛 $j$ 也只算一次。\n", "inputFormat": "\n第一行，两个正整数 $n,k$。\n\n第二行，$(n-1)$ 个正整数 $v_1,v_2,\\ldots,v_{n-1}$。", "outputFormat": "输出一行 $n$ 个正整数，第 $i$ 个数表示 $f(i,k)$。\n", "hint": "\n### 样例解释\n\n- 样例 $1$ 解释：以岛 $1$ 为例，跳 $0$ 步可以到达岛 $1$，跳 $1$ 步可以到达岛 $\\{2,4\\}$。所以 $f(1,1)=3$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，保证：\n\n- $1\\le n\\le 3\\times 10^5$；\n- $1\\le k\\lt n$；\n- $i\\lt v_i\\le n$；\n- **对于任意 $1\\le i\\lt j\\lt n$，要么 $v_i\\le j$，要么 $v_j\\le v_i$。**\n\n\n---\n\n| 子任务 | $n\\le$ | 特殊性质 | 得分 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $2\\, 000$  |   | $6$ |\n| $2$ | $10^5$ | $\\text{A}$ | $27$ |\n| $3$ | $3\\times 10^5$ | $\\text{B}$ | $11$ |\n| $4$ | $10^5$ |  | $37$ |\n| $5$ | $3\\times 10^5$ |  | $19$ |\n\n- 特殊性质 $\\text{A}$：$k\\le 50$。\n- 特殊性质 $\\text{B}$：$v_i\\le i+2$。\n", "locale": "zh-CN"}}}
{"pid": "P11886", "type": "P", "difficulty": 3, "samples": [["3 2\n1 2 3\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "堆", "2025", "O2优化", "洛谷比赛"], "title": "「Stoi2025」爱你没差", "background": "![](bilibili:BV1fx411N7bU?page=147)", "description": "给定正整数 $n,m$ 和一个非负整数序列 $a_1,a_2,\\dots,a_n$，每次可以选取其中两个数 $x,y$，去掉它们并往序列中加入 $x+y$，若有 $m \\cdot x \\ge y$ 且 $m \\cdot y \\ge x$，则得一分。求将全部数合并成一个数得分的最大可能值。", "inputFormat": "第一行输入两个正整数表示 $n,m$。\n\n第二行输入 $n$ 个非负整数，表示序列 $a_i$。", "outputFormat": "输出一行一个整数表示得分的最大可能值。", "hint": "#### 样例解释\n\n先选择 $1,2$，序列变为 $3,3$，再选择 $3,3$，序列变为 $6$，此时得分为 $2$。\n\n若先选择 $2,3$，则得分为 $1$。\n\n#### 数据范围与限制\n\n对于 $20\\%$ 的数据，满足 $n\\le10$。\n\n对于 $60\\%$ 的数据，满足 $n\\le10^3$。\n\n对于所有数据，满足 $1\\le n\\le10^6$，$2\\le m\\le10$，$0\\le a_i<2^{64}$，$\\sum a_i<2^{64}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2025」爱你没差", "background": "![](bilibili:BV1fx411N7bU?page=147)", "description": "给定正整数 $n,m$ 和一个非负整数序列 $a_1,a_2,\\dots,a_n$，每次可以选取其中两个数 $x,y$，去掉它们并往序列中加入 $x+y$，若有 $m \\cdot x \\ge y$ 且 $m \\cdot y \\ge x$，则得一分。求将全部数合并成一个数得分的最大可能值。", "inputFormat": "第一行输入两个正整数表示 $n,m$。\n\n第二行输入 $n$ 个非负整数，表示序列 $a_i$。", "outputFormat": "输出一行一个整数表示得分的最大可能值。", "hint": "#### 样例解释\n\n先选择 $1,2$，序列变为 $3,3$，再选择 $3,3$，序列变为 $6$，此时得分为 $2$。\n\n若先选择 $2,3$，则得分为 $1$。\n\n#### 数据范围与限制\n\n对于 $20\\%$ 的数据，满足 $n\\le10$。\n\n对于 $60\\%$ 的数据，满足 $n\\le10^3$。\n\n对于所有数据，满足 $1\\le n\\le10^6$，$2\\le m\\le10$，$0\\le a_i<2^{64}$，$\\sum a_i<2^{64}$。", "locale": "zh-CN"}}}
{"pid": "P11887", "type": "P", "difficulty": 6, "samples": [["2\n4\n1 2 3 4\n1 4\n2 4\n3 4\n10\n3 2 7 -2 4 -1 10 0 5 1\n1 7\n2 3\n3 7\n3 4\n5 6\n5 7\n7 9\n8 10\n9 10\n", "4\n7\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2025", "O2优化", "树形 DP", "洛谷比赛"], "title": "「Stoi2025」爱在西元前", "background": "![](bilibili:BV1fx411N7bU?page=12)", "description": "给定一棵树，点有整数点权。现在可以修改其中一个点的权值为任意整数，请找到一种修改方案，使得修改前的任意一个最大权独立集与修改后的任意一个最大权独立集间相差的点数的最少可能值尽可能大。你只需要求出这个最大可能值。\n\n---\n\n#### 形式化题意\n\n记树为 $T(V,E)$，其中 $V=\\{1,2,\\dots,n\\}$ 为树的点集，$E\\subset V\\times V$ 为树的边集。定义点权为一个函数 $v:V\\to\\Z$，表示点 $i$ 的权值为 $v(i)$。修改后的权值应为一个函数 $v':V\\to\\Z$，满足 $\\exists u\\in V,\\forall i\\in V-\\{u\\},v'(i)=v(i)$，即除了某个 $u$ 以外其他点的权值均不变。\n\n定义一个独立集 $S\\subset V$ 为点集的一个子集，满足 $\\forall i,j\\in S,(i,j)\\notin E$。定义独立集 $S$ 的权值 $\\mathfrak{v}_ v(S):=\\sum_{i\\in S}v(i)$。权值函数 $v$ 对应的最大权独立集为使得 $\\mathfrak{v}_ v(S)$ 最大的独立集，即其权值为 $\\mathfrak{V}_ v(T):=\\max_{S\\subset V, S 为独立集}\\{\\mathfrak{v}_ v(S)\\}$，有可能有多个。所有最大权独立集构成的集合族为 $\\mathfrak{S}_ v(T)=\\left\\{S\\subset V:\\mathfrak{v}_ v(S)=\\mathfrak{V}_ v(T)\\right\\}$。\n\n定义 $f_T(v,v')=\\min_{S\\in\\mathfrak{S}_ v(T),S'\\in\\mathfrak{S}_ {v'}(T)}\\left\\lvert S\\Delta S'\\right\\rvert$，其中 $|S|$ 表示集合 $S$ 的大小，$\\Delta$ 表示[对称差](https://baike.baidu.com/item/%E5%AF%B9%E7%A7%B0%E5%B7%AE/704850)运算。请求出 $\\max_{v'}f_T(v,v')$ 的值。", "inputFormat": "第一行输入一个正整数 $t$ 表示数据组数。\n\n每组数据第一行输入一个正整数 $n$ 表示树的结点数。\n\n第二行输入 $n$ 个整数 $v(1).\\dots,v(n)$，表示点的权值。\n\n接下来 $n-1$ 行，每行输入两个整数 $x,y$ 表示 $x,y$ 之间有一条树的边。", "outputFormat": "对于每组数据，输出一行，一个整数表示答案。", "hint": "#### 样例解释\n\n对于第一组数据，修改前的最大权独立集只能为 $\\{1,2,3\\}$。若只修改点 $1$ 的权值，则修改后仍存在一个最大权独立集包含 $2,3$ 且不包含 $4$；若只修改点 $2$ 的权值，则修改后仍存在一个最大权独立集包含 $1,3$ 但不包含 $4$。故相差点数的最少可能值不超过 $1$。\n\n若将点 $3$ 的权值修改为 $0$，则修改后的最大权独立集只有 $\\{4\\}$；若将点 $4$ 的权值修改为 $7$，则修改后的最大权独立集同样只有 $\\{4\\}$。此时相差点数必定为 $4$，即为所求的最大可能值。\n\n对于第二组数据，将结点 $7$ 的权值修改为 $17$，则修改前的最大权独立集可能为 $\\{1,3,5,9\\}$ 或 $\\{1,3,5,8,9\\}$，修改后的最大权独立集只有 $\\{2,7,10\\}$，最少相差点数为 $7$。可以证明这是最大可能值。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $\\sum n\\le$ | 特殊性质 | 分值 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $10$ | 无 | $1$ |\n| $2$ | $10^3$ | A | $12$ |\n| $3$ | $10^3$ | B | $12$ |\n| $4$ | $10^3$ | 无 | $12$ |\n| $5$ | $10^6$ | A | $18$ |\n| $6$ | $10^6$ | B | $18$ |\n| $7$ | $10^6$ | 无 | $27$ |\n\n特殊性质 A：存在一个 $1$ 到 $n$ 的排列 $p$，对于 $1\\le i<n$，结点 $p_i$ 与 $p_{i+1}$ 间有一条边；\n\n特殊性质 B：存在一个结点与所有其他结点间均有边。\n\n对于所有数据，满足 $1\\le t\\le10$，$1\\le n\\le10^6$，$-10^9\\le v(i)\\le10^9$，$\\sum n\\le10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2025」爱在西元前", "background": "![](bilibili:BV1fx411N7bU?page=12)", "description": "给定一棵树，点有整数点权。现在可以修改其中一个点的权值为任意整数，请找到一种修改方案，使得修改前的任意一个最大权独立集与修改后的任意一个最大权独立集间相差的点数的最少可能值尽可能大。你只需要求出这个最大可能值。\n\n---\n\n#### 形式化题意\n\n记树为 $T(V,E)$，其中 $V=\\{1,2,\\dots,n\\}$ 为树的点集，$E\\subset V\\times V$ 为树的边集。定义点权为一个函数 $v:V\\to\\Z$，表示点 $i$ 的权值为 $v(i)$。修改后的权值应为一个函数 $v':V\\to\\Z$，满足 $\\exists u\\in V,\\forall i\\in V-\\{u\\},v'(i)=v(i)$，即除了某个 $u$ 以外其他点的权值均不变。\n\n定义一个独立集 $S\\subset V$ 为点集的一个子集，满足 $\\forall i,j\\in S,(i,j)\\notin E$。定义独立集 $S$ 的权值 $\\mathfrak{v}_ v(S):=\\sum_{i\\in S}v(i)$。权值函数 $v$ 对应的最大权独立集为使得 $\\mathfrak{v}_ v(S)$ 最大的独立集，即其权值为 $\\mathfrak{V}_ v(T):=\\max_{S\\subset V, S 为独立集}\\{\\mathfrak{v}_ v(S)\\}$，有可能有多个。所有最大权独立集构成的集合族为 $\\mathfrak{S}_ v(T)=\\left\\{S\\subset V:\\mathfrak{v}_ v(S)=\\mathfrak{V}_ v(T)\\right\\}$。\n\n定义 $f_T(v,v')=\\min_{S\\in\\mathfrak{S}_ v(T),S'\\in\\mathfrak{S}_ {v'}(T)}\\left\\lvert S\\Delta S'\\right\\rvert$，其中 $|S|$ 表示集合 $S$ 的大小，$\\Delta$ 表示[对称差](https://baike.baidu.com/item/%E5%AF%B9%E7%A7%B0%E5%B7%AE/704850)运算。请求出 $\\max_{v'}f_T(v,v')$ 的值。", "inputFormat": "第一行输入一个正整数 $t$ 表示数据组数。\n\n每组数据第一行输入一个正整数 $n$ 表示树的结点数。\n\n第二行输入 $n$ 个整数 $v(1).\\dots,v(n)$，表示点的权值。\n\n接下来 $n-1$ 行，每行输入两个整数 $x,y$ 表示 $x,y$ 之间有一条树的边。", "outputFormat": "对于每组数据，输出一行，一个整数表示答案。", "hint": "#### 样例解释\n\n对于第一组数据，修改前的最大权独立集只能为 $\\{1,2,3\\}$。若只修改点 $1$ 的权值，则修改后仍存在一个最大权独立集包含 $2,3$ 且不包含 $4$；若只修改点 $2$ 的权值，则修改后仍存在一个最大权独立集包含 $1,3$ 但不包含 $4$。故相差点数的最少可能值不超过 $1$。\n\n若将点 $3$ 的权值修改为 $0$，则修改后的最大权独立集只有 $\\{4\\}$；若将点 $4$ 的权值修改为 $7$，则修改后的最大权独立集同样只有 $\\{4\\}$。此时相差点数必定为 $4$，即为所求的最大可能值。\n\n对于第二组数据，将结点 $7$ 的权值修改为 $17$，则修改前的最大权独立集可能为 $\\{1,3,5,9\\}$ 或 $\\{1,3,5,8,9\\}$，修改后的最大权独立集只有 $\\{2,7,10\\}$，最少相差点数为 $7$。可以证明这是最大可能值。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $\\sum n\\le$ | 特殊性质 | 分值 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $10$ | 无 | $1$ |\n| $2$ | $10^3$ | A | $12$ |\n| $3$ | $10^3$ | B | $12$ |\n| $4$ | $10^3$ | 无 | $12$ |\n| $5$ | $10^6$ | A | $18$ |\n| $6$ | $10^6$ | B | $18$ |\n| $7$ | $10^6$ | 无 | $27$ |\n\n特殊性质 A：存在一个 $1$ 到 $n$ 的排列 $p$，对于 $1\\le i<n$，结点 $p_i$ 与 $p_{i+1}$ 间有一条边；\n\n特殊性质 B：存在一个结点与所有其他结点间均有边。\n\n对于所有数据，满足 $1\\le t\\le10$，$1\\le n\\le10^6$，$-10^9\\le v(i)\\le10^9$，$\\sum n\\le10^6$。", "locale": "zh-CN"}}}
{"pid": "P11888", "type": "P", "difficulty": 6, "samples": [["2\n1 3\n2 3\n", "2\n32\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "数论", "O2优化", "莫比乌斯反演", "容斥原理", "逆元", "洛谷比赛", "整除分块", "Dirichlet 卷积", "筛法"], "title": "「Stoi2025」爱的飞行日记", "background": "![](bilibili:BV1fx411N7bU?page=125)", "description": "$t$ 组询问，每次询问给定正整数 $n,m$，计算\n\n$$\\prod_{a_1=1}^{m}\\prod_{a_2=1}^{m}\\cdots\\prod_{a_n=1}^{m}\\operatorname{lcm}(f_{a_1},f_{a_2},\\dots,f_{a_n})\\bmod{37426667}$$\n\n的值。其中 $f_i$ 是斐波那契数，满足 $f_1=f_2=1$，且 $f_i=f_{i-1}+f_{i-2},\\forall i\\ge3$。", "inputFormat": "第一行输入一个正整数 $t$ 表示询问组数。\n\n接下来 $t$ 行，每行两个正整数 $n,m$ 表示一次询问。", "outputFormat": "每次询问输出一行一个整数表示答案。", "hint": "#### 样例解释\n\n对于第一组询问，有答案为 $f_1f_2f_3=1\\times1\\times2=2$。\n\n对于第二组询问，当 $a_1,a_2\\in\\{1,2\\}$ 时 $\\operatorname{lcm}(f_{a_1},f_{a_2})=1$，否则 $\\operatorname{lcm}(f_{a_1},f_{a_2})=2$。故答案为 $2^5=32$。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $t\\le$ | $n\\le$ | $m\\le$ | 分值 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $1$ | $2$ | $2 \\times 10^3$ | $13$ |\n| $2$ | $5$ | $2 \\times 10^5$ | $2 \\times 10^5$ | $24$ |\n| $3$ | $5$ | $2 \\times 10^7$ | $2 \\times 10^7$ | $36$ |\n| $4$ | $300$ | $2 \\times 10^{17}$ | $2 \\times 10^7$ | $27$ |\n\n对于所有数据，满足 $1 \\le t \\le 300, 1 \\le n \\le 2 \\times 10^{17}, 1 \\le m \\le 2 \\times 10^7$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2025」爱的飞行日记", "background": "![](bilibili:BV1fx411N7bU?page=125)", "description": "$t$ 组询问，每次询问给定正整数 $n,m$，计算\n\n$$\\prod_{a_1=1}^{m}\\prod_{a_2=1}^{m}\\cdots\\prod_{a_n=1}^{m}\\operatorname{lcm}(f_{a_1},f_{a_2},\\dots,f_{a_n})\\bmod{37426667}$$\n\n的值。其中 $f_i$ 是斐波那契数，满足 $f_1=f_2=1$，且 $f_i=f_{i-1}+f_{i-2},\\forall i\\ge3$。", "inputFormat": "第一行输入一个正整数 $t$ 表示询问组数。\n\n接下来 $t$ 行，每行两个正整数 $n,m$ 表示一次询问。", "outputFormat": "每次询问输出一行一个整数表示答案。", "hint": "#### 样例解释\n\n对于第一组询问，有答案为 $f_1f_2f_3=1\\times1\\times2=2$。\n\n对于第二组询问，当 $a_1,a_2\\in\\{1,2\\}$ 时 $\\operatorname{lcm}(f_{a_1},f_{a_2})=1$，否则 $\\operatorname{lcm}(f_{a_1},f_{a_2})=2$。故答案为 $2^5=32$。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $t\\le$ | $n\\le$ | $m\\le$ | 分值 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $1$ | $2$ | $2 \\times 10^3$ | $13$ |\n| $2$ | $5$ | $2 \\times 10^5$ | $2 \\times 10^5$ | $24$ |\n| $3$ | $5$ | $2 \\times 10^7$ | $2 \\times 10^7$ | $36$ |\n| $4$ | $300$ | $2 \\times 10^{17}$ | $2 \\times 10^7$ | $27$ |\n\n对于所有数据，满足 $1 \\le t \\le 300, 1 \\le n \\le 2 \\times 10^{17}, 1 \\le m \\le 2 \\times 10^7$。", "locale": "zh-CN"}}}
{"pid": "P11890", "type": "P", "difficulty": 3, "samples": [["4\n1 1\n3 1\n2 3\n4 1", "6\n0 1 1 1 2 3 "], ["4\n1 1\n3 0\n2 3\n4 1", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化", "分类讨论"], "title": "[XRCOI Round 1] A. 相聚相逢本无意", "background": "> 花开花落终有时，相聚相逢本无意。", "description": "初见时，她给了小 S 一个可以为空的序列 $A$，长度为 $n$。\n\n她定义了序列的**前缀 MEX 序列** $B$，满足 $B$ 的第 $i$ 项为 $\\text{MEX}\\{A_1,A_2,\\dots,A_i\\}$，对于一个由有限个非负整数组成的数列 $X$，我们定义 $\\text{MEX}$ 为数列中**不包含的最小非负整数**。比如 $\\text{MEX}\\{1,2,3\\}=0,\\text{MEX}\\{0,1,2,4\\}=3$。\n\n作为初见时的考验，小 S 需要构造一个**单调不降**的 $A$ 数组，使得其前缀 $\\text{MEX}$ 数组 $B$ 满足一些约束。或者判定没有任何一种符合要求的 $A$ 存在。\n\n具体的，$B$ 数组需要满足的限制形如 $k$ 个二元组 $(x,y)$，表示数 $x$ 在 $B$ 中**恰好**出现了 $y$ 次。\n\n不需要最小化构造的 $A$ 数组的大小或者使构造满足其它没有给定的额外条件。\n\n小 S 不会这个问题，所以他请你来帮忙了。", "inputFormat": "第一行一个非负整数 $k$，表示构造的 $A$ 需要满足的二元组的个数。\n\n接下来 $k$ 行，每行 $2$ 个非负整数，表示一个二元组 $(x,y)$。", "outputFormat": "如果不存在合法情况，输出一行一个数 $-1$。\n\n否则输出两行：\n\n第一行一个整数 $n$，为你构造的序列 $A$ 的长度，需满足 $0\\le n\\le 2\\times 10^5$。\n\n第二行 $n$ 个正整数，为你构造的序列 $A$ 的元素，需满足 $0\\le A_i\\le 10^9$ 且 $\\forall i\\in[1,n-1],A_i\\le A_{i+1}$。\n", "hint": "#### 样例解释\n\n第一个样例中，构造出来的 $B=(1,2,2,2,3,4)$， 符合以上 $k$ 个二元组的要求。\n\n更详细的，有：\n\n$B_1=\\text{MEX}\\{A_1\\}=\\text{MEX}\\{0\\}=1$；\n\n$B_2=\\text{MEX}\\{A_1,A_2\\}=\\text{MEX}\\{0,1\\}=2$；\n\n$B_3=\\text{MEX}\\{A_1,A_2,A_3\\}=\\text{MEX}\\{0,1\\}=2$；\n\n$B_4=\\text{MEX}\\{A_1,A_2,A_3,A_4\\}=\\text{MEX}\\{0,1\\}=2$；\n\n$B_5=\\text{MEX}\\{A_1,A_2,A_3,A_4,A_5\\}=\\text{MEX}\\{0,1,2\\}=3$；\n\n$B_6=\\text{MEX}\\{A_1,A_2,A_3,A_4,A_5,A_6\\}=\\text{MEX}\\{0,1,2,3\\}=4$。\n\n第二个样例中，可以证明没有任何一个 $A$ 满足要求。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试和子任务依赖并开启 Special Judge。**\n\n你可以输出任意一组满足条件的情况，如果不存在合法情况输出 $-1$。\n\n其中子任务 $0$ 为样例，记 $0$ 分。\n\n| 子任务编号 | 分值 |     特殊性质      | 子任务依赖 |\n| :--------: | :--: | :---------------: | :--------: |\n|    $1$     | $30$ | $x\\not=0,y\\not=0$ |     无     |\n|    $2$     | $30$ |     $x\\not=0$     |     $1$      |\n|    $3$     | $30$ |     $y\\not=0$     |     $1$      |\n|    $4$     | $10$ |    无特殊性质     |  $1,2,3$   |\n\n\n对于 $100 \\%$ 的数据，保证 $0\\le k,x,y\\le 100$，且给出的二元组中 $x$ 两两不同。\n\n**不保证 $x$ 单调递增。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[XRCOI Round 1] A. 相聚相逢本无意", "background": "> 花开花落终有时，相聚相逢本无意。", "description": "初见时，她给了小 S 一个可以为空的序列 $A$，长度为 $n$。\n\n她定义了序列的**前缀 MEX 序列** $B$，满足 $B$ 的第 $i$ 项为 $\\text{MEX}\\{A_1,A_2,\\dots,A_i\\}$，对于一个由有限个非负整数组成的数列 $X$，我们定义 $\\text{MEX}$ 为数列中**不包含的最小非负整数**。比如 $\\text{MEX}\\{1,2,3\\}=0,\\text{MEX}\\{0,1,2,4\\}=3$。\n\n作为初见时的考验，小 S 需要构造一个**单调不降**的 $A$ 数组，使得其前缀 $\\text{MEX}$ 数组 $B$ 满足一些约束。或者判定没有任何一种符合要求的 $A$ 存在。\n\n具体的，$B$ 数组需要满足的限制形如 $k$ 个二元组 $(x,y)$，表示数 $x$ 在 $B$ 中**恰好**出现了 $y$ 次。\n\n不需要最小化构造的 $A$ 数组的大小或者使构造满足其它没有给定的额外条件。\n\n小 S 不会这个问题，所以他请你来帮忙了。", "inputFormat": "第一行一个非负整数 $k$，表示构造的 $A$ 需要满足的二元组的个数。\n\n接下来 $k$ 行，每行 $2$ 个非负整数，表示一个二元组 $(x,y)$。", "outputFormat": "如果不存在合法情况，输出一行一个数 $-1$。\n\n否则输出两行：\n\n第一行一个整数 $n$，为你构造的序列 $A$ 的长度，需满足 $0\\le n\\le 2\\times 10^5$。\n\n第二行 $n$ 个正整数，为你构造的序列 $A$ 的元素，需满足 $0\\le A_i\\le 10^9$ 且 $\\forall i\\in[1,n-1],A_i\\le A_{i+1}$。\n", "hint": "#### 样例解释\n\n第一个样例中，构造出来的 $B=(1,2,2,2,3,4)$， 符合以上 $k$ 个二元组的要求。\n\n更详细的，有：\n\n$B_1=\\text{MEX}\\{A_1\\}=\\text{MEX}\\{0\\}=1$；\n\n$B_2=\\text{MEX}\\{A_1,A_2\\}=\\text{MEX}\\{0,1\\}=2$；\n\n$B_3=\\text{MEX}\\{A_1,A_2,A_3\\}=\\text{MEX}\\{0,1\\}=2$；\n\n$B_4=\\text{MEX}\\{A_1,A_2,A_3,A_4\\}=\\text{MEX}\\{0,1\\}=2$；\n\n$B_5=\\text{MEX}\\{A_1,A_2,A_3,A_4,A_5\\}=\\text{MEX}\\{0,1,2\\}=3$；\n\n$B_6=\\text{MEX}\\{A_1,A_2,A_3,A_4,A_5,A_6\\}=\\text{MEX}\\{0,1,2,3\\}=4$。\n\n第二个样例中，可以证明没有任何一个 $A$ 满足要求。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试和子任务依赖并开启 Special Judge。**\n\n你可以输出任意一组满足条件的情况，如果不存在合法情况输出 $-1$。\n\n其中子任务 $0$ 为样例，记 $0$ 分。\n\n| 子任务编号 | 分值 |     特殊性质      | 子任务依赖 |\n| :--------: | :--: | :---------------: | :--------: |\n|    $1$     | $30$ | $x\\not=0,y\\not=0$ |     无     |\n|    $2$     | $30$ |     $x\\not=0$     |     $1$      |\n|    $3$     | $30$ |     $y\\not=0$     |     $1$      |\n|    $4$     | $10$ |    无特殊性质     |  $1,2,3$   |\n\n\n对于 $100 \\%$ 的数据，保证 $0\\le k,x,y\\le 100$，且给出的二元组中 $x$ 两两不同。\n\n**不保证 $x$ 单调递增。**", "locale": "zh-CN"}}}
{"pid": "P11891", "type": "P", "difficulty": 5, "samples": [["3 0\n1 0\n1 1\n0 0\n", "1\n"], ["5 0\n0 1\n1 0\n0 1\n1 1\n1 1\n", "70\n"], ["4 0\n0 1\n1 0\n0 1\n1 0\n", "52\n"], ["5 1\n1 1 0 1 1\n1 1 1 1 1\n", "22\n"], ["10000 1\n1 1 0 1 1\n1 1 1 1 1\n", "559297012"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "[XRCOI Round 1] B. 稻花香里说丰年", "background": "**增加形式化题意。**\n> 稻花香里说丰年，听取蛙声一片。", "description": "稻田里有 $0$, $1$ 两种类型的青蛙。他们排成了 $a,b$ 两列。\n\nGenius_Star 发现了这些青蛙，所以他决定将这两个青蛙队列分别划分为**起止点相同的**任意段，定义某一段的整齐度 $T$ 为：\n\n$$\nT(l,r) = \\sum_{i=l}^r [a_i \\ne b_i]\n$$\n其中 ：$[A]$ 表示若 $A$ 命题为真则为 $1$，否则为 $0$。\n\n\n则对于段 $[l,r]$ 的带给 Genius_Star 的开心值为\n\n$$\nW(l,r) = T(l,r) \\times \\Big(A(l,r) + B(l,r) \\Big)\n$$\n\n其中：\n\n$A(l,r)$ 表示在 $a$ 序列的 $[l,r]$ 区间中包含的 $01$ 类型的子序列数量。\n\n$B(l,r)$ 表示在 $b$ 序列的 $[l,r]$ 区间中包含的 $10$ 类型的子序列数量。\n\n一个分段方案带给 Genius_Star 的开心值是所有小段带给他的开心值之和，你需要求出所有的分段方案带给他的开心值之和 $s$。\n\n设分为了 $k$ 段，第 $i$ 段为 $[l_i, r_i](l_i \\le r_i)$，需要满足：\n\n- $l_1 = 1, r_k = n$。\n\n- $\\forall i \\in[1, k), r_i + 1 = l_{i + 1}$。\n\n则若两个分段的方案不同，当且仅当两个方案分的段数不同或者存在一个 $i$ 使得 $[l_i, r_i] \\ne[l'_i, r'_i]$。\n\n由于 Genius_Star 不能过于开心，你还需要将答案对 $10^9+7$ 取模。\n\n### 形式化题意\n\n给定一个两个序列 $a,b$ 。定义\n\n-  $T(l,r)$ 为在区间 $[l,r]$ 中 $a_i\\neq b_i$ 的个数。\n\n-  $A(l,r)$ 表示 $a$ 序列在 $[l,r]$ 区间中的 $01$ 类型子序列个数。\n\n-  $B(l,r)$ 表示 $b$ 序列在 $[l,r]$ 区间中的 $10$ 类型子序列个数。\n\n-  $\n   W(l,r) = T(l,r) \\times \\Big(A(l,r) + B(l,r) \\Big)\n   $。\n\n其中：$xy$ 类型子序列表示从区间左端点开始向右顺次选择两个元素（**不要求连续**），其中，第一个数是 $x$ ，第二个数是 $y$。两个子序列不同当且仅当 $x$ 或 $y$ 所在位置不同。\n\n现在你需要将两个序列划分成**起止点相同的**任意段，求所有划分方式的每段的 $W$ 之和。\n\n由于答案可能很大，你需要将答案对 $10^9+7$ 取模。", "inputFormat": "第一行，两个正整数 $n,op$。\n\n当 $op=0$ 时，则该测试点的 $a_i,b_i$ **直接给出**：\n\n- 接下来 $n$ 行，每行两个整数 $a_i,b_i$。\n\n当 $op=1$ 时，则该测试点的 $a_i,b_i$ 将**特殊生成**：\n\n- 第二行共五个整数 $x_1, y_1, z_1, f_1, f_2$。\n\n- 第三行共五个整数 $x_2, y_2, z_2, g_1, g_2$。\n\n则 $f_i,g_i(i \\ge 3)$ 满足：\n\n$$f_i = (f_{i-2} \\times x_1 + f_{i-1} \\times y_1 + z_1) \\bmod 2^{64}$$\n\n$$g_i = (g_{i-2} \\times x_2 + g_{i-1} \\times y_2 + z_2) \\bmod 2^{64}$$\n\n那么：\n\n- $a_i$ 的值就是 $f_{\\lfloor \\frac{i-1}{64} \\rfloor+3}$ 转化为二进制后从低位到高位第 $(i-1 \\bmod 64)+1$ 位。\n\n- $b_i$ 的值就是 $g_{\\lfloor \\frac{i-1}{64} \\rfloor+3}$ 转化为二进制后从低位到高位第 $(i-1 \\bmod 64)+1$ 位。\n\n**上述数据生成方式仅是为了减少输入量大小，标准算法不依赖于该生成方式。**", "outputFormat": "输出共一行。一个整数 $s$，表示所有的分段方案带给 Genius_Star 的开心值之和。", "hint": "### 样例解释 #1：\n\n只有按照 $[1,3]$ 分段时，$W(1,3)=1$。\n\n### 样例解释 #4：\n\n可以得到：\n\n$$f_1=1,f_2=1,f_3=2$$\n\n$$g_1=1,g_2=1,g_3=3$$\n\n得到：\n\n$$(f_3)_2 = (00010)_2$$\n\n$$(g_3)_2 = (00011)_2$$\n\n则：\n\n$$a = \\{0,1,0,0,0\\}$$\n\n$$b = \\{1,1,0,0,0\\}$$\n\n故答案为 $22$。\n\n### 数据范围：\n\n**本题采用捆绑测试。**\n\n其中子任务 $0$ 为样例，记 $0$ 分。\n\n\n| Subtask 编号 |         $n$         | $op$ | 特殊性质 | 得分 |\n| :----------: | :-----------------: | :--: | :------: | :--: |\n|     $1$      |     $\\leq 100$      | $=0$ |    无    | $5$  |\n|     $2$      |     $\\leq 10^4$     | $=0$ |    无    | $10$ |\n|     $3$      |     $\\leq 10^6$     | $=0$ |   $A$    | $10$ |\n|     $4$      |     $\\leq 10^6$     | $=0$ |   $B$    | $10$ |\n|     $5$      |     $\\leq 10^6$     | $=1$ |    无    | $25$ |\n|     $6$      | $\\leq 5\\times 10^7$ | $=1$ |    无    | $40$ |\n\n特殊性质 $A$： $T(l,r) = r-l+1$。\n\n特殊性质 $B$：有且仅有一个 $x$ 满足 $a_x \\ne b_x$。\n\n对于 $100 \\%$ 的数据，保证 $1 \\le n \\le 5\\times 10^7,1 \\le x_1,x_2,y_1,y_2,z_1,z_2,f_1,f_2,g_1,g_2 \\le 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[XRCOI Round 1] B. 稻花香里说丰年", "background": "**增加形式化题意。**\n> 稻花香里说丰年，听取蛙声一片。", "description": "稻田里有 $0$, $1$ 两种类型的青蛙。他们排成了 $a,b$ 两列。\n\nGenius_Star 发现了这些青蛙，所以他决定将这两个青蛙队列分别划分为**起止点相同的**任意段，定义某一段的整齐度 $T$ 为：\n\n$$\nT(l,r) = \\sum_{i=l}^r [a_i \\ne b_i]\n$$\n其中 ：$[A]$ 表示若 $A$ 命题为真则为 $1$，否则为 $0$。\n\n\n则对于段 $[l,r]$ 的带给 Genius_Star 的开心值为\n\n$$\nW(l,r) = T(l,r) \\times \\Big(A(l,r) + B(l,r) \\Big)\n$$\n\n其中：\n\n$A(l,r)$ 表示在 $a$ 序列的 $[l,r]$ 区间中包含的 $01$ 类型的子序列数量。\n\n$B(l,r)$ 表示在 $b$ 序列的 $[l,r]$ 区间中包含的 $10$ 类型的子序列数量。\n\n一个分段方案带给 Genius_Star 的开心值是所有小段带给他的开心值之和，你需要求出所有的分段方案带给他的开心值之和 $s$。\n\n设分为了 $k$ 段，第 $i$ 段为 $[l_i, r_i](l_i \\le r_i)$，需要满足：\n\n- $l_1 = 1, r_k = n$。\n\n- $\\forall i \\in[1, k), r_i + 1 = l_{i + 1}$。\n\n则若两个分段的方案不同，当且仅当两个方案分的段数不同或者存在一个 $i$ 使得 $[l_i, r_i] \\ne[l'_i, r'_i]$。\n\n由于 Genius_Star 不能过于开心，你还需要将答案对 $10^9+7$ 取模。\n\n### 形式化题意\n\n给定一个两个序列 $a,b$ 。定义\n\n-  $T(l,r)$ 为在区间 $[l,r]$ 中 $a_i\\neq b_i$ 的个数。\n\n-  $A(l,r)$ 表示 $a$ 序列在 $[l,r]$ 区间中的 $01$ 类型子序列个数。\n\n-  $B(l,r)$ 表示 $b$ 序列在 $[l,r]$ 区间中的 $10$ 类型子序列个数。\n\n-  $\n   W(l,r) = T(l,r) \\times \\Big(A(l,r) + B(l,r) \\Big)\n   $。\n\n其中：$xy$ 类型子序列表示从区间左端点开始向右顺次选择两个元素（**不要求连续**），其中，第一个数是 $x$ ，第二个数是 $y$。两个子序列不同当且仅当 $x$ 或 $y$ 所在位置不同。\n\n现在你需要将两个序列划分成**起止点相同的**任意段，求所有划分方式的每段的 $W$ 之和。\n\n由于答案可能很大，你需要将答案对 $10^9+7$ 取模。", "inputFormat": "第一行，两个正整数 $n,op$。\n\n当 $op=0$ 时，则该测试点的 $a_i,b_i$ **直接给出**：\n\n- 接下来 $n$ 行，每行两个整数 $a_i,b_i$。\n\n当 $op=1$ 时，则该测试点的 $a_i,b_i$ 将**特殊生成**：\n\n- 第二行共五个整数 $x_1, y_1, z_1, f_1, f_2$。\n\n- 第三行共五个整数 $x_2, y_2, z_2, g_1, g_2$。\n\n则 $f_i,g_i(i \\ge 3)$ 满足：\n\n$$f_i = (f_{i-2} \\times x_1 + f_{i-1} \\times y_1 + z_1) \\bmod 2^{64}$$\n\n$$g_i = (g_{i-2} \\times x_2 + g_{i-1} \\times y_2 + z_2) \\bmod 2^{64}$$\n\n那么：\n\n- $a_i$ 的值就是 $f_{\\lfloor \\frac{i-1}{64} \\rfloor+3}$ 转化为二进制后从低位到高位第 $(i-1 \\bmod 64)+1$ 位。\n\n- $b_i$ 的值就是 $g_{\\lfloor \\frac{i-1}{64} \\rfloor+3}$ 转化为二进制后从低位到高位第 $(i-1 \\bmod 64)+1$ 位。\n\n**上述数据生成方式仅是为了减少输入量大小，标准算法不依赖于该生成方式。**", "outputFormat": "输出共一行。一个整数 $s$，表示所有的分段方案带给 Genius_Star 的开心值之和。", "hint": "### 样例解释 #1：\n\n只有按照 $[1,3]$ 分段时，$W(1,3)=1$。\n\n### 样例解释 #4：\n\n可以得到：\n\n$$f_1=1,f_2=1,f_3=2$$\n\n$$g_1=1,g_2=1,g_3=3$$\n\n得到：\n\n$$(f_3)_2 = (00010)_2$$\n\n$$(g_3)_2 = (00011)_2$$\n\n则：\n\n$$a = \\{0,1,0,0,0\\}$$\n\n$$b = \\{1,1,0,0,0\\}$$\n\n故答案为 $22$。\n\n### 数据范围：\n\n**本题采用捆绑测试。**\n\n其中子任务 $0$ 为样例，记 $0$ 分。\n\n\n| Subtask 编号 |         $n$         | $op$ | 特殊性质 | 得分 |\n| :----------: | :-----------------: | :--: | :------: | :--: |\n|     $1$      |     $\\leq 100$      | $=0$ |    无    | $5$  |\n|     $2$      |     $\\leq 10^4$     | $=0$ |    无    | $10$ |\n|     $3$      |     $\\leq 10^6$     | $=0$ |   $A$    | $10$ |\n|     $4$      |     $\\leq 10^6$     | $=0$ |   $B$    | $10$ |\n|     $5$      |     $\\leq 10^6$     | $=1$ |    无    | $25$ |\n|     $6$      | $\\leq 5\\times 10^7$ | $=1$ |    无    | $40$ |\n\n特殊性质 $A$： $T(l,r) = r-l+1$。\n\n特殊性质 $B$：有且仅有一个 $x$ 满足 $a_x \\ne b_x$。\n\n对于 $100 \\%$ 的数据，保证 $1 \\le n \\le 5\\times 10^7,1 \\le x_1,x_2,y_1,y_2,z_1,z_2,f_1,f_2,g_1,g_2 \\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P11892", "type": "P", "difficulty": 5, "samples": [["1\n5 5 7\n3 1\n2 2\n5 4\n4 4\n3 4\n1 4\n3 5", "4"], ["1\n5 5 7\n1 1\n3 1\n3 3\n2 3\n4 3\n2 5\n4 5", "5"], ["1\n5 5 3\n1 1 \n1 3\n1 5", "2"], ["1\n5 5 4\n1 1\n1 3\n2 2\n5 5", "-1"], ["1\n3 1 4\n1 1\n2 1\n1 1\n2 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "O2优化", "广度优先搜索 BFS", "图论建模", "最短路"], "title": "[XRCOI Round 1] C. 草萤有耀终非火", "background": "> 草萤有耀终非火，荷露虽团岂是珠？", "description": "小 G 和小 Z 在一个  $n$ 行 $m$ 列的网格图上摆满了熄灭的灯，并在其中 $k$ 盏灯中放置了燃料。但是它们均没有被点燃。我们用 $(i,j)$ 表示**从下往上**第 $i$ 行**从左往右**第 $j$ 列的格子。\n\n\n这些灯在点亮时会出现某些奇怪的现象：假设 $a,b,x,y$ 均为正整数，当 $(x,y),(x+a,y),(x,y+b),(x+a,y+b)$ 四个格子中有三个格子中的灯都**已点亮**且 $1 \\le x < x+a \\le n,1 \\le y < y+b \\le m$，那么剩下的那一个格子的灯就会自动被点亮。\n\n因此，一盏灯既可以在一开始时通过点燃燃料的方式点亮，又可以通过这种现象点亮。\n\n现在他们想要把放有火炬台的格子 $(1,1)$ 和 $(1,m)$ 中的灯点亮。而你需要求出把格子 $(1,1)$ 和 $(1,m)$ 中的灯都点亮时，**一开始**最少要点燃几盏灯中的燃料（不含过程中通过这种现象点亮的），或者报告无法把格子 $(1,1)$ 或 $(1,m)$ 中的灯点亮。\n\n注意：同一盏灯中可能放置多个燃料，但只要点燃一个燃料这盏灯就可以被点亮。", "inputFormat": "**本题有多组测试数据。**\n\n第一行包含一个正整数 $t$，表示数据的组数。\n\n对于每一组测试数据： \n\n- 第一行包含三个整数 $n,m,k$，意义如上文所示。\n- 接下来的 $k$ 行，每行两个正整数 $x,y$，表示第 $x$ 行第 $y$ 列的灯上放有一个燃料。", "outputFormat": "对于每一组测试数据，一行输出一个整数，表示把格子 $(1,1),(1,m)$ 中的灯点亮时，一开始最少要点燃的燃料数。\n\n若格子 $(1,1)$ 或 $(1,m)$ 中的灯无法点亮，则输出 $-1$。\n", "hint": "#### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6f5xt1sd.png)\n\n对于第一组样例：可以选择格子 $(3,1),(3,4),(1,4),(3,5)$ 中的燃料点燃，如图 $1$ 所示。\n\n对于第二组样例：可以选择格子 $(1,1),(3,1),(3,3),(2,3),(2,5)$ 中的燃料点燃，如图 $2$ 所示。\n\n对于第三组样例：可以选择格子 $(1,1),(1,5)$ 中的燃料点燃。\n\n对于第四组样例：显然没有合法的方案。\n\n对于第五组样例：此时格子 $(1,1)$ 与 $(1,m)$ 是同一个格子，因此只要选择格子 $(1,1)$ 中的一个燃料点燃即可。并且注意数据中可能出现同一盏灯中有多个燃料的情况。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n其中子任务 $0$ 为样例，记 $0$ 分。\n\n\n| Subtask 编号 | $t\\le $ | $n,m \\le $ | $\\sum n,\\sum m \\le$ | $k \\le $ | $\\sum k \\le$ | 特殊性质 | 得分 |\n| :-------: | :-----------: | :--------: | :--------: | :--------: | :--------: | :--------: | :-----: |\n| $1$ | $10$ | $10$ | $100$ | $10$ | $100$ | 无 | $20$ |\n| $2$ | $10$ | $10^3$ | $10^4$ | $5\\times 10^3$ | $2\\times10^4$ | $A$ | $2$ |\n| $3$ | $5\\times 10^3$ | $10^5$ | $10^6$ | $5\\times10^5$ | $2\\times10^6$ | $B$ | $2$ |\n| $4$ | $5\\times 10^3$ | $10^5$ | $10^6$ | $5\\times 10^5$ | $2\\times10^6$ | $C$ | $15$ |\n| $5$ | $10^3$ | $10^3$ | $10^4$ | $5\\times 10^3$ | $2\\times 10^4$ | 无 | $26$ |\n| $6$ | $5\\times 10^3$ | $10^5$ | $10^6$ | $5\\times 10^5$ | $2\\times 10^6$ | 无 | $35$ |\n\n特殊性质 $A$：保证格子 $(1,1),(1,m)$ 放有燃料。  \n特殊性质 $B$：保证放置的燃料中没有两个燃料是同一行或者同一列的。  \n特殊性质 $C$：保证一定存在某一列摆满了燃料。  \n\n对于 $100\\%$ 的数据：保证 $1 \\le t \\le 5\\times10^3,1 \\le n,m \\le  10^5,0 \\le k \\le 2\\times10^6,1 \\le \\sum n,\\sum m \\le 10^6,0 \\le \\sum k \\le 2\\times 10^6,1\\le x \\le n,1 \\le y \\le m$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[XRCOI Round 1] C. 草萤有耀终非火", "background": "> 草萤有耀终非火，荷露虽团岂是珠？", "description": "小 G 和小 Z 在一个  $n$ 行 $m$ 列的网格图上摆满了熄灭的灯，并在其中 $k$ 盏灯中放置了燃料。但是它们均没有被点燃。我们用 $(i,j)$ 表示**从下往上**第 $i$ 行**从左往右**第 $j$ 列的格子。\n\n\n这些灯在点亮时会出现某些奇怪的现象：假设 $a,b,x,y$ 均为正整数，当 $(x,y),(x+a,y),(x,y+b),(x+a,y+b)$ 四个格子中有三个格子中的灯都**已点亮**且 $1 \\le x < x+a \\le n,1 \\le y < y+b \\le m$，那么剩下的那一个格子的灯就会自动被点亮。\n\n因此，一盏灯既可以在一开始时通过点燃燃料的方式点亮，又可以通过这种现象点亮。\n\n现在他们想要把放有火炬台的格子 $(1,1)$ 和 $(1,m)$ 中的灯点亮。而你需要求出把格子 $(1,1)$ 和 $(1,m)$ 中的灯都点亮时，**一开始**最少要点燃几盏灯中的燃料（不含过程中通过这种现象点亮的），或者报告无法把格子 $(1,1)$ 或 $(1,m)$ 中的灯点亮。\n\n注意：同一盏灯中可能放置多个燃料，但只要点燃一个燃料这盏灯就可以被点亮。", "inputFormat": "**本题有多组测试数据。**\n\n第一行包含一个正整数 $t$，表示数据的组数。\n\n对于每一组测试数据： \n\n- 第一行包含三个整数 $n,m,k$，意义如上文所示。\n- 接下来的 $k$ 行，每行两个正整数 $x,y$，表示第 $x$ 行第 $y$ 列的灯上放有一个燃料。", "outputFormat": "对于每一组测试数据，一行输出一个整数，表示把格子 $(1,1),(1,m)$ 中的灯点亮时，一开始最少要点燃的燃料数。\n\n若格子 $(1,1)$ 或 $(1,m)$ 中的灯无法点亮，则输出 $-1$。\n", "hint": "#### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6f5xt1sd.png)\n\n对于第一组样例：可以选择格子 $(3,1),(3,4),(1,4),(3,5)$ 中的燃料点燃，如图 $1$ 所示。\n\n对于第二组样例：可以选择格子 $(1,1),(3,1),(3,3),(2,3),(2,5)$ 中的燃料点燃，如图 $2$ 所示。\n\n对于第三组样例：可以选择格子 $(1,1),(1,5)$ 中的燃料点燃。\n\n对于第四组样例：显然没有合法的方案。\n\n对于第五组样例：此时格子 $(1,1)$ 与 $(1,m)$ 是同一个格子，因此只要选择格子 $(1,1)$ 中的一个燃料点燃即可。并且注意数据中可能出现同一盏灯中有多个燃料的情况。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n其中子任务 $0$ 为样例，记 $0$ 分。\n\n\n| Subtask 编号 | $t\\le $ | $n,m \\le $ | $\\sum n,\\sum m \\le$ | $k \\le $ | $\\sum k \\le$ | 特殊性质 | 得分 |\n| :-------: | :-----------: | :--------: | :--------: | :--------: | :--------: | :--------: | :-----: |\n| $1$ | $10$ | $10$ | $100$ | $10$ | $100$ | 无 | $20$ |\n| $2$ | $10$ | $10^3$ | $10^4$ | $5\\times 10^3$ | $2\\times10^4$ | $A$ | $2$ |\n| $3$ | $5\\times 10^3$ | $10^5$ | $10^6$ | $5\\times10^5$ | $2\\times10^6$ | $B$ | $2$ |\n| $4$ | $5\\times 10^3$ | $10^5$ | $10^6$ | $5\\times 10^5$ | $2\\times10^6$ | $C$ | $15$ |\n| $5$ | $10^3$ | $10^3$ | $10^4$ | $5\\times 10^3$ | $2\\times 10^4$ | 无 | $26$ |\n| $6$ | $5\\times 10^3$ | $10^5$ | $10^6$ | $5\\times 10^5$ | $2\\times 10^6$ | 无 | $35$ |\n\n特殊性质 $A$：保证格子 $(1,1),(1,m)$ 放有燃料。  \n特殊性质 $B$：保证放置的燃料中没有两个燃料是同一行或者同一列的。  \n特殊性质 $C$：保证一定存在某一列摆满了燃料。  \n\n对于 $100\\%$ 的数据：保证 $1 \\le t \\le 5\\times10^3,1 \\le n,m \\le  10^5,0 \\le k \\le 2\\times10^6,1 \\le \\sum n,\\sum m \\le 10^6,0 \\le \\sum k \\le 2\\times 10^6,1\\le x \\le n,1 \\le y \\le m$。\n\n", "locale": "zh-CN"}}}
{"pid": "P11893", "type": "P", "difficulty": 6, "samples": [["1\n5\n", "18\n"], ["1\n6\n", "200\n"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "O2优化", "组合数学"], "title": "[XRCOI Round 1] D. 似此星辰非昨夜", "background": "> 似此星辰非昨夜，却道故人心易变。", "description": "璀璨星空下，白果给 Genius_Star 出了一些数学题。\n\n我们把一个数称为符合条件的，当且仅当它满足以下所有条件：\n\n- 它的数字只包含 $0,1,2,3,4$，且这五个数字都出现过至少一次。\n- 所有的 $0$ 都出现在所有的 $1$ 之前，且所有的 $3$ 都出现在所有的 $4$ 之前。\n\n- 最高位数字不为 $0$。\n\nGenius_Star 需要求出恰好有 $n$ 位的符合条件的数的个数。当然，这个数可能很大，而白果不想让他太累，所以答案还需要对 $10^9+7$ 取模。\n\n他不会这个问题，所以交给你了。", "inputFormat": "输入共 $2$ 行。\n\n第一行输入一个正整数 $l$，表示 $n$ 的位数。\n\n第二行输入一个正整数 $n$。", "outputFormat": "输出共 $1$ 行。\n\n一个正整数，表示答案。", "hint": "#### 样例解释 #1：\n符合条件的 $5$ 位数为：\n\n$$\n20134,20314,20341,23014,23041,23401,30124,30142,30214,\\\\30241,30412,30421,32014,32041,32401,34012,34021,34201$$\n\n### 数据范围与约定：\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 分值 |     $n \\leq$     |\n| :--------: | :--: | :---------------: |\n| $1$ | $10$ | $10^3$ |\n| $2$ | $20$ | $10^7$ |\n| $3$ | $30$ | $2^{10^4}$ |\n| $4$ | $40$ |$10^{10^7}$ |\n\n对于 $100 \\%$ 的数据，保证 $1 \\le n \\le 10^{10^7}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[XRCOI Round 1] D. 似此星辰非昨夜", "background": "> 似此星辰非昨夜，却道故人心易变。", "description": "璀璨星空下，白果给 Genius_Star 出了一些数学题。\n\n我们把一个数称为符合条件的，当且仅当它满足以下所有条件：\n\n- 它的数字只包含 $0,1,2,3,4$，且这五个数字都出现过至少一次。\n- 所有的 $0$ 都出现在所有的 $1$ 之前，且所有的 $3$ 都出现在所有的 $4$ 之前。\n\n- 最高位数字不为 $0$。\n\nGenius_Star 需要求出恰好有 $n$ 位的符合条件的数的个数。当然，这个数可能很大，而白果不想让他太累，所以答案还需要对 $10^9+7$ 取模。\n\n他不会这个问题，所以交给你了。", "inputFormat": "输入共 $2$ 行。\n\n第一行输入一个正整数 $l$，表示 $n$ 的位数。\n\n第二行输入一个正整数 $n$。", "outputFormat": "输出共 $1$ 行。\n\n一个正整数，表示答案。", "hint": "#### 样例解释 #1：\n符合条件的 $5$ 位数为：\n\n$$\n20134,20314,20341,23014,23041,23401,30124,30142,30214,\\\\30241,30412,30421,32014,32041,32401,34012,34021,34201$$\n\n### 数据范围与约定：\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 分值 |     $n \\leq$     |\n| :--------: | :--: | :---------------: |\n| $1$ | $10$ | $10^3$ |\n| $2$ | $20$ | $10^7$ |\n| $3$ | $30$ | $2^{10^4}$ |\n| $4$ | $40$ |$10^{10^7}$ |\n\n对于 $100 \\%$ 的数据，保证 $1 \\le n \\le 10^{10^7}$。", "locale": "zh-CN"}}}
{"pid": "P11894", "type": "P", "difficulty": 4, "samples": [["5 2\n2 3 4 5 6\n2 3\n1 1", "3 4 6 5 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["倍增", "O2优化", "差分"], "title": "「LAOI-9」Update", "background": "", "description": "给定长度为 $n$ 的序列 $a$，接下来 $m$ 次操作，每次操作形如：\n\n- 给定 $l,r$，对于 $i \\in [l,r]$，令 $a_i \\leftarrow a_i + \\lfloor \\log_2 a_i \\rfloor $。\n\n$m$ 次操作后，输出 $a$ 序列。", "inputFormat": "第一行两个正整数 $n$ 和 $m$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个表示 $a_i$。\n\n接下来 $m$ 行，每行两个正整数 $l$ 和 $r$。", "outputFormat": "一行 $n$ 个正整数，第 $i$ 个表示 $a_i$。相邻正整数间用空格分隔。", "hint": "**本题目采用捆绑测试**。\n\n| 子任务编号 | $n,m \\le$ | 特殊性质 | 分值 |\n| :-----: | :------: | :------: | :------: |\n| $1$ | $10^3$ | 无 | $30$ |\n| $2$ | $10^5$ | A | $20$ |\n| $3$ | $10^5$ | 无 | $50$ |\n\n特殊性质 A：$a_i \\le 100$。 \n\n对于 $100 \\%$ 的数据，满足 $1 \\le n,m \\le 10^5$，$1 \\le a_i \\le 10^5$，$1 \\le l \\le r \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「LAOI-9」Update", "background": "", "description": "给定长度为 $n$ 的序列 $a$，接下来 $m$ 次操作，每次操作形如：\n\n- 给定 $l,r$，对于 $i \\in [l,r]$，令 $a_i \\leftarrow a_i + \\lfloor \\log_2 a_i \\rfloor $。\n\n$m$ 次操作后，输出 $a$ 序列。", "inputFormat": "第一行两个正整数 $n$ 和 $m$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个表示 $a_i$。\n\n接下来 $m$ 行，每行两个正整数 $l$ 和 $r$。", "outputFormat": "一行 $n$ 个正整数，第 $i$ 个表示 $a_i$。相邻正整数间用空格分隔。", "hint": "**本题目采用捆绑测试**。\n\n| 子任务编号 | $n,m \\le$ | 特殊性质 | 分值 |\n| :-----: | :------: | :------: | :------: |\n| $1$ | $10^3$ | 无 | $30$ |\n| $2$ | $10^5$ | A | $20$ |\n| $3$ | $10^5$ | 无 | $50$ |\n\n特殊性质 A：$a_i \\le 100$。 \n\n对于 $100 \\%$ 的数据，满足 $1 \\le n,m \\le 10^5$，$1 \\le a_i \\le 10^5$，$1 \\le l \\le r \\le n$。", "locale": "zh-CN"}}}
{"pid": "P11895", "type": "P", "difficulty": 5, "samples": [["1\n6 12", "1 5 -1 -1 -2 1"], ["2\n6 114514\n6 1", "0 0 0 0 0 0\n0 0 0 0 0 21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化", "构造"], "title": "「LAOI-9」Sequence", "background": "赛后本题添加多测及一些 hack。", "description": "若区间 $[l,r]$ 对任意 $l \\le t\\le r$ 都满足 $\\sum\\limits_{i=l}^ta_i>0$，则称其为**好的区间**，注意 $l$ 可以等于 $r$。\n\n现在你需要构造一个长度为 $n$ 的数列，使得其满足：\n\n- 恰好存在 $k$ 个好的区间；\n- $\\sum\\limits_{i=1}^n(n-i+1)\\times a_i=\\frac{n\\times(n+1)}{2}$；\n- $-10^{12}\\le a_i<10^{12}$，且均为整数。\n\n若不存在方案，则输出一个全为 $0$ 的数列 $a$。", "inputFormat": "本题采用多组测试数据。\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行两个正整数，分别表示 $n,k$。", "outputFormat": "共 $T$ 行，对于每组测试数据，输出 $n$ 个整数，表示构造的数列 $a$。", "hint": "### 样例解释\n\n对于样例 $1$ 中输出的序列共有以下 $12$ 个区间是好的：\n\n1. $[1,1]$；\n2. $[1,2]$；\n3. $[1,3]$；\n4. $[1,4]$；\n5. $[1,5]$；\n6. $[1,6]$；\n7. $[2,2]$；\n8. $[2,3]$；\n9. $[2,4]$；\n10. $[2,5]$；\n11. $[2,6]$；\n12. $[6,6]$。\n### 数据范围\n\n**本题目采用捆绑测试**。\n\n|子任务编号|$\\sum n\\le$|特殊性质|分值|\n|:-:|:-:|:-:|:-:|\n|$1$|$10$|无|$10$|\n|$2$|$10^2$|无|$15$|\n|$3$|$2\\times10^3$|无|$20$|\n|$4$|$2\\times 10^5$|$k<n$|$15$|\n|$5$|$2\\times10^5$|无|$40$|\n\n对于 $100\\%$ 的数据，满足 $1\\le T\\le 100$，$1\\le n,\\sum n \\le 2\\times10^5$，$1\\le k < 2^{63}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「LAOI-9」Sequence", "background": "赛后本题添加多测及一些 hack。", "description": "若区间 $[l,r]$ 对任意 $l \\le t\\le r$ 都满足 $\\sum\\limits_{i=l}^ta_i>0$，则称其为**好的区间**，注意 $l$ 可以等于 $r$。\n\n现在你需要构造一个长度为 $n$ 的数列，使得其满足：\n\n- 恰好存在 $k$ 个好的区间；\n- $\\sum\\limits_{i=1}^n(n-i+1)\\times a_i=\\frac{n\\times(n+1)}{2}$；\n- $-10^{12}\\le a_i<10^{12}$，且均为整数。\n\n若不存在方案，则输出一个全为 $0$ 的数列 $a$。", "inputFormat": "本题采用多组测试数据。\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行两个正整数，分别表示 $n,k$。", "outputFormat": "共 $T$ 行，对于每组测试数据，输出 $n$ 个整数，表示构造的数列 $a$。", "hint": "### 样例解释\n\n对于样例 $1$ 中输出的序列共有以下 $12$ 个区间是好的：\n\n1. $[1,1]$；\n2. $[1,2]$；\n3. $[1,3]$；\n4. $[1,4]$；\n5. $[1,5]$；\n6. $[1,6]$；\n7. $[2,2]$；\n8. $[2,3]$；\n9. $[2,4]$；\n10. $[2,5]$；\n11. $[2,6]$；\n12. $[6,6]$。\n### 数据范围\n\n**本题目采用捆绑测试**。\n\n|子任务编号|$\\sum n\\le$|特殊性质|分值|\n|:-:|:-:|:-:|:-:|\n|$1$|$10$|无|$10$|\n|$2$|$10^2$|无|$15$|\n|$3$|$2\\times10^3$|无|$20$|\n|$4$|$2\\times 10^5$|$k<n$|$15$|\n|$5$|$2\\times10^5$|无|$40$|\n\n对于 $100\\%$ 的数据，满足 $1\\le T\\le 100$，$1\\le n,\\sum n \\le 2\\times10^5$，$1\\le k < 2^{63}$。", "locale": "zh-CN"}}}
{"pid": "P11896", "type": "P", "difficulty": 6, "samples": [["3 2\n1 1 1\n0 0 0\n1 1 5\n2 3", "3"], ["5 5\n1 2 3 4 1\n1 1 0 0 1\n1 1 6\n1 2 8\n3 1\n1 1 10\n2 5", "6"], ["8 5\n1 2 2 1 1 2 3 1\n0 0 0 0 0 0 0 0\n1 1 3\n2 3\n3 2\n1 2 4\n2 5", "1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "O2优化", "李超线段树"], "title": "「LAOI-9」此方的座位", "background": "", "description": "此方在餐厅吃饭，他发现旁边的人发出了很大的噪声。\n\n对于每个座位 $k$ 发出的噪声，$i$ 位置接收到的噪声为 $\\max(0,j-a_k\\times\\operatorname{abs}(i-k))$，$a_k$ 为噪声的衰退系数，$j$ 为初始噪声，具体定义见下文。\n\n对于每个位置受到的噪声，为所有位置发出噪声到达这个位置后的**最大值**。\n\n但是，管理人员为了减少噪声，在一些地方修建了降噪设备，如果一个位置 $i$ 满足 $b_i=1$，那么这个位置初始有一个降噪设备。而对于降噪设备，在噪声**到达**其**左边第一个和右边第一个**遇见的降噪设备后，衰退系数会变为原来的 $2$ 倍。形式化地，设对于位置 $k$ 传达到位置 $i$ 接触到的**第一个**降噪设备位置为 $x$，那么位置 $i$ 接收到的噪声为 $\\max(0,j-a_k\\times\\operatorname{abs}(k-x)-2a_k\\times\\operatorname{abs}(i-x))$。\n\n**注意：一个降噪设备只会影响到它修建后产生的噪声**。\n\n降噪设备有一个不足，就是如果降噪设备的位置发出了噪声，那么该位置的降噪设备会被**立刻摧毁**，即不会对这次和以后发出的噪声产生效果。\n\n所以，在某些时刻，管理人员会在一些位置上新增修建降噪设备。\n\n现在在 $m$ 个单位时间内，每个时间可能发生三种事件。\n\n+ 输入格式为 `1 i j`，代表 $i$ 座位的人发出了响度 $j$ 的声音。\n\n+ 输入格式为 `2 i`，代表求 $i$ 座位的人受到的噪声。\n\n+ 输入格式为 `3 i`，代表管理人员在位置 $i$ 上新增修建了一个降噪设备，如果这个位置原来就有降噪设备，则本次操作无效。当然，因为一个降噪设备只会影响到它修建后产生的噪声，所以在一个曾发出噪声的位置新增修建降噪设备，不会使得这个降噪设备被立即摧毁。", "inputFormat": "第一行，座位数 $n$ 和事件数 $m$。\n\n第二行，共 $n$ 个数，为 $a_i$，代表第 $i$ 个座位的人发出的噪声的衰退系数。\n\n第三行，共 $n$ 个数，为 $b_i$，其为 $1$ 代表这个位置有降噪设备，否则没有。\n\n接下来 $m$ 行，每行一个事件。\n\n在事件中，先输入事件编号。然后 $i$（记 $las$ 为上一次输出的答案，初始为 $0$）要进行变换得到真实的输入。$i$ 应变成 $((i+las-1)\\bmod n)+1$。", "outputFormat": "对于操作 $2$ 进行输出，输出后换行。", "hint": "### 样例解释\n\n对于前 $2$ 个样例，变化后的输入与原输入相同。\n\n对于第 $1$ 个样例，唯一的贡献来自于位置 $1$ 产生的 $5$ 点噪音，到达位置 $3$ 时的噪音为 $\\max(0,5-(3-1)\\times 1)=3$。\n\n**本题目采用捆绑测试**。\n\n| 子任务编号 | $n\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $0$ | $2\\times 10^3$ | 无 | $15$ |\n| $1$ | $10^5$ | 任何时刻没有降噪设备 | $20$ |\n| $2$ | $10^5$ | 没有操作 $3$ | $10$ |\n| $3$ | $10^5$ | 所有 $a_i$ 均相同 | $15$ |\n| $4$ | $10^5$ | 无 | $40$ |\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 10^5,1\\le a_i\\le 10^9,b_i\\in\\{0,1\\},1\\le i\\le n,1\\le j\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「LAOI-9」此方的座位", "background": "", "description": "此方在餐厅吃饭，他发现旁边的人发出了很大的噪声。\n\n对于每个座位 $k$ 发出的噪声，$i$ 位置接收到的噪声为 $\\max(0,j-a_k\\times\\operatorname{abs}(i-k))$，$a_k$ 为噪声的衰退系数，$j$ 为初始噪声，具体定义见下文。\n\n对于每个位置受到的噪声，为所有位置发出噪声到达这个位置后的**最大值**。\n\n但是，管理人员为了减少噪声，在一些地方修建了降噪设备，如果一个位置 $i$ 满足 $b_i=1$，那么这个位置初始有一个降噪设备。而对于降噪设备，在噪声**到达**其**左边第一个和右边第一个**遇见的降噪设备后，衰退系数会变为原来的 $2$ 倍。形式化地，设对于位置 $k$ 传达到位置 $i$ 接触到的**第一个**降噪设备位置为 $x$，那么位置 $i$ 接收到的噪声为 $\\max(0,j-a_k\\times\\operatorname{abs}(k-x)-2a_k\\times\\operatorname{abs}(i-x))$。\n\n**注意：一个降噪设备只会影响到它修建后产生的噪声**。\n\n降噪设备有一个不足，就是如果降噪设备的位置发出了噪声，那么该位置的降噪设备会被**立刻摧毁**，即不会对这次和以后发出的噪声产生效果。\n\n所以，在某些时刻，管理人员会在一些位置上新增修建降噪设备。\n\n现在在 $m$ 个单位时间内，每个时间可能发生三种事件。\n\n+ 输入格式为 `1 i j`，代表 $i$ 座位的人发出了响度 $j$ 的声音。\n\n+ 输入格式为 `2 i`，代表求 $i$ 座位的人受到的噪声。\n\n+ 输入格式为 `3 i`，代表管理人员在位置 $i$ 上新增修建了一个降噪设备，如果这个位置原来就有降噪设备，则本次操作无效。当然，因为一个降噪设备只会影响到它修建后产生的噪声，所以在一个曾发出噪声的位置新增修建降噪设备，不会使得这个降噪设备被立即摧毁。", "inputFormat": "第一行，座位数 $n$ 和事件数 $m$。\n\n第二行，共 $n$ 个数，为 $a_i$，代表第 $i$ 个座位的人发出的噪声的衰退系数。\n\n第三行，共 $n$ 个数，为 $b_i$，其为 $1$ 代表这个位置有降噪设备，否则没有。\n\n接下来 $m$ 行，每行一个事件。\n\n在事件中，先输入事件编号。然后 $i$（记 $las$ 为上一次输出的答案，初始为 $0$）要进行变换得到真实的输入。$i$ 应变成 $((i+las-1)\\bmod n)+1$。", "outputFormat": "对于操作 $2$ 进行输出，输出后换行。", "hint": "### 样例解释\n\n对于前 $2$ 个样例，变化后的输入与原输入相同。\n\n对于第 $1$ 个样例，唯一的贡献来自于位置 $1$ 产生的 $5$ 点噪音，到达位置 $3$ 时的噪音为 $\\max(0,5-(3-1)\\times 1)=3$。\n\n**本题目采用捆绑测试**。\n\n| 子任务编号 | $n\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $0$ | $2\\times 10^3$ | 无 | $15$ |\n| $1$ | $10^5$ | 任何时刻没有降噪设备 | $20$ |\n| $2$ | $10^5$ | 没有操作 $3$ | $10$ |\n| $3$ | $10^5$ | 所有 $a_i$ 均相同 | $15$ |\n| $4$ | $10^5$ | 无 | $40$ |\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 10^5,1\\le a_i\\le 10^9,b_i\\in\\{0,1\\},1\\le i\\le n,1\\le j\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P11897", "type": "P", "difficulty": 6, "samples": [["0\n0\n2\n0 1 998244351 2\n2\n1 2 3\n2\n2 0 1\n2 3", "3\n1 1"], ["0\n1\n50007\n3\n1 2 3 4 5 6 7 998244326\n1\n2 0 7", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["多项式", "O2优化", "快速沃尔什变换 FWT", "单位根反演"], "title": "「LAOI-9」多维空间中的游戏", "background": "", "description": "小 $\\mathbf A$ 和小 $\\mathbf B$ 正在玩一个有趣的游戏。\n\n游戏将在一个 $\\underbrace{2\\times2\\times2\\times\\cdots\\times2}_{k 个 2}$ 的 $k$ 维空间中进行。最小的节点的坐标为 $(\\underbrace{0,0,0,\\cdots,0}_{k个0})$，最大的节点的坐标为 $(\\underbrace{1,1,1,\\cdots,1}_{k个1})$。\n\n下面是 $k=3$ 时的情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2khrowsw.png)\n\n小 $\\mathbf A$ 和小 $\\mathbf B$ 各执一枚 $k$ 维空间中的点。\n\n小 $\\mathbf A$ 和小 $\\mathbf B$ 轮流操作，小 $\\mathbf A$ 先手。\n\n定义一个维度为可操作的，当且仅当两个点中存在至少一个点在这个维度上的坐标不为 $0$。然后，操作方可以将两个点的某个可操作的维度的坐标置为 $0$。\n\n如图，这是一个合法的操作：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8ajfdwcm.png)\n\n这也是一个合法的操作：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/65f0tcaa.png)\n\n但是这不是一个合法的操作，因为两个点在这个维度上的坐标均为 $0$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f00hqo6l.png)\n\n无法操作者输。\n\n相信大家一定发现了，我们可以将任意一个坐标编码为一个二进制数。例如对于坐标 $(0,1,1,1,0,0,1,0)$，可以编码为 $\\tt 01110010$，对应十进制数 $114$。\n\n小 $\\mathbf A$ 和 $\\mathbf B$ 将进行 $q$ 轮游戏。两人绝顶聪明，都想要自己赢。每一轮双方点的位置将会随机生成，进一步地，生成到编码为 $x$ 的坐标的概率为 $p_x$。\n\n由于小 $\\mathbf A$ 先手，所以每轮她们将会划定一个可落子区域 $[l,r]$，其他区域则为不可落子区域。如果小 $\\mathbf A$ **初始**的点坐标编码后的值在区间 $[l,r]$ 外，则将会判为小 $\\mathbf B$ 胜。（此规则对小 $\\mathbf B$ 不生效，也就是即使小 $\\mathbf B$ 初始的点坐标编码后的值在区间 $[l,r]$ 外，也不会直接判为小 $\\mathbf A$ 胜）\n\n现在对于第 $i$ 轮，可落子区域为 $[l_i,r_i]$，小 $\\mathbf B$ 会有 $a_i$ 个询问，每个询问为当她的点被随机到编号为 $x$ 的坐标，且小 $\\mathbf A$ 的点按照 $p$ 的概率随机生成时，她的胜率为多少。答案对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $c$ 表示子任务编号，特殊地，样例的编号为 $0$。\n\n接下来一行一个正整数 $t$ 表示数据读入输出方法。当 $t=1$ 时，你需要在下一行接着读入一个整数 $seed$ 表示随机种子。\n\n接下来一行一个正整数 $k$ 表示维度数。\n\n接下来一行 $2^k$ 个非负整数 $p_0,p_1,\\cdots,p_{2^{k}-1}$ 表示生成到编码为 $x$ 的坐标的概率为 $p_x$。\n\n接下来一行一个正整数 $q$ 表示游戏轮数。\n\n接下来 $q$ 组询问，对于第 $i$ 组询问（下标从 $1$ 开始）：\n\n每组询问第一行三个整数，表示 $a_i,l_i,r_i$。\n\n当 $t=0$ 时，接下来一行 $a_i$ 个整数 $x_{i,1},x_{i,2},\\cdots,x_{i,a_i}$，表示每次小 $\\mathbf B$ 的询问。\n\n当 $t=1$ 时，接下来小 $\\mathbf B$ 的第 $j$ 个询问（下标从 $1$ 开始）$x_{i,j}$ 为 $seed\\times i\\times j\\times 50007\\bmod (2^k)$。\n\n对于 C++ 选手，我们下发了一份数据读入模板 `down.cpp`，您只需要完善其中的代码部分即可。", "outputFormat": "当 $t=0$ 时，对于第 $i$ 组询问输出一行 $a_i$ 个整数，表示这组询问所有答案模 $998244353$ 后的值。\n\n当 $t=1$ 时，对于每组询问输出一行一个整数，表示这组询问所有答案模 $998244353$ 后的异或和。", "hint": "### 样例 1 解释\n\n对于第一组询问，当小 $\\mathbf A$ 的点在编号为 $1$ 的坐标时，由于超出了可落子区域，小 $\\mathbf B$ 胜；当小 $\\mathbf A$ 的点在编号为 $2$ 的坐标时，小 $\\mathbf A$ 胜；当小 $\\mathbf A$ 的点在编号为 $3$ 的坐标时，小 $\\mathbf B$ 胜。\n\n故在模意义下，小 $\\mathbf B$ 的胜率：$1+2=3$。\n\n### 样例 2 解释\n\n解码后，$x_{1,1}=1,x_{1,2}=2$，答案分别为 $18,18$，异或和为 $0$。\n\n**本题目采用捆绑测试**。\n\n| 子任务编号 | $k\\le$ | $q\\le$ | $a_i\\le$ | 时间限制 | 特殊性质 | 分值 |\n| :--------: | :----: | :----: | :------: | :------: | :------: | :--: |\n|    $0$     |  $5$   |  $30$  |   $30$   |   1 秒   |   样例    | $0$  |\n|    $1$     |  $1$   |  $30$  |   $30$   |   1 秒   |          | $5$  |\n|    $2$     |  $2$   |  $30$  |   $30$   |   1 秒   |          | $5$  |\n|    $3$     |  $10$  | $300$  |  $100$   |   1 秒   |          | $20$ |\n|    $4$     |  $15$  | $100$  | $2^{15}$ |   1 秒   |  $t=1$   | $20$ |\n|    $5$     |  $16$  | $1000$ |  $100$   |   1 秒   |          | $10$ |\n|    $6$     |  $16$  | $2000$ |  $3000$  |   1 秒   |  $t=1$   | $10$ |\n|    $7$     |  $16$  | $3000$ | $2^{15}$ |   2 秒   |  $t=1$   | $30$ |\n\n对于 $100\\%$ 数据，满足 $1\\le k\\le 16,1\\le q\\le 3000,0\\le p_i<998244353,1\\le a_i\\le 2^{15},0\\le l_i\\le r_i< 2^k,0\\le x_{i,j}< 2^k,t\\in\\{0,1\\},0\\le seed\\le 50007$。保证 $\\sum_{i=0}^{2^k-1}p_i\\equiv1\\pmod{998244353}$。\n\n本题输入输出量大，请使用较快的输入输出方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「LAOI-9」多维空间中的游戏", "background": "", "description": "小 $\\mathbf A$ 和小 $\\mathbf B$ 正在玩一个有趣的游戏。\n\n游戏将在一个 $\\underbrace{2\\times2\\times2\\times\\cdots\\times2}_{k 个 2}$ 的 $k$ 维空间中进行。最小的节点的坐标为 $(\\underbrace{0,0,0,\\cdots,0}_{k个0})$，最大的节点的坐标为 $(\\underbrace{1,1,1,\\cdots,1}_{k个1})$。\n\n下面是 $k=3$ 时的情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2khrowsw.png)\n\n小 $\\mathbf A$ 和小 $\\mathbf B$ 各执一枚 $k$ 维空间中的点。\n\n小 $\\mathbf A$ 和小 $\\mathbf B$ 轮流操作，小 $\\mathbf A$ 先手。\n\n定义一个维度为可操作的，当且仅当两个点中存在至少一个点在这个维度上的坐标不为 $0$。然后，操作方可以将两个点的某个可操作的维度的坐标置为 $0$。\n\n如图，这是一个合法的操作：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8ajfdwcm.png)\n\n这也是一个合法的操作：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/65f0tcaa.png)\n\n但是这不是一个合法的操作，因为两个点在这个维度上的坐标均为 $0$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f00hqo6l.png)\n\n无法操作者输。\n\n相信大家一定发现了，我们可以将任意一个坐标编码为一个二进制数。例如对于坐标 $(0,1,1,1,0,0,1,0)$，可以编码为 $\\tt 01110010$，对应十进制数 $114$。\n\n小 $\\mathbf A$ 和 $\\mathbf B$ 将进行 $q$ 轮游戏。两人绝顶聪明，都想要自己赢。每一轮双方点的位置将会随机生成，进一步地，生成到编码为 $x$ 的坐标的概率为 $p_x$。\n\n由于小 $\\mathbf A$ 先手，所以每轮她们将会划定一个可落子区域 $[l,r]$，其他区域则为不可落子区域。如果小 $\\mathbf A$ **初始**的点坐标编码后的值在区间 $[l,r]$ 外，则将会判为小 $\\mathbf B$ 胜。（此规则对小 $\\mathbf B$ 不生效，也就是即使小 $\\mathbf B$ 初始的点坐标编码后的值在区间 $[l,r]$ 外，也不会直接判为小 $\\mathbf A$ 胜）\n\n现在对于第 $i$ 轮，可落子区域为 $[l_i,r_i]$，小 $\\mathbf B$ 会有 $a_i$ 个询问，每个询问为当她的点被随机到编号为 $x$ 的坐标，且小 $\\mathbf A$ 的点按照 $p$ 的概率随机生成时，她的胜率为多少。答案对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $c$ 表示子任务编号，特殊地，样例的编号为 $0$。\n\n接下来一行一个正整数 $t$ 表示数据读入输出方法。当 $t=1$ 时，你需要在下一行接着读入一个整数 $seed$ 表示随机种子。\n\n接下来一行一个正整数 $k$ 表示维度数。\n\n接下来一行 $2^k$ 个非负整数 $p_0,p_1,\\cdots,p_{2^{k}-1}$ 表示生成到编码为 $x$ 的坐标的概率为 $p_x$。\n\n接下来一行一个正整数 $q$ 表示游戏轮数。\n\n接下来 $q$ 组询问，对于第 $i$ 组询问（下标从 $1$ 开始）：\n\n每组询问第一行三个整数，表示 $a_i,l_i,r_i$。\n\n当 $t=0$ 时，接下来一行 $a_i$ 个整数 $x_{i,1},x_{i,2},\\cdots,x_{i,a_i}$，表示每次小 $\\mathbf B$ 的询问。\n\n当 $t=1$ 时，接下来小 $\\mathbf B$ 的第 $j$ 个询问（下标从 $1$ 开始）$x_{i,j}$ 为 $seed\\times i\\times j\\times 50007\\bmod (2^k)$。\n\n对于 C++ 选手，我们下发了一份数据读入模板 `down.cpp`，您只需要完善其中的代码部分即可。", "outputFormat": "当 $t=0$ 时，对于第 $i$ 组询问输出一行 $a_i$ 个整数，表示这组询问所有答案模 $998244353$ 后的值。\n\n当 $t=1$ 时，对于每组询问输出一行一个整数，表示这组询问所有答案模 $998244353$ 后的异或和。", "hint": "### 样例 1 解释\n\n对于第一组询问，当小 $\\mathbf A$ 的点在编号为 $1$ 的坐标时，由于超出了可落子区域，小 $\\mathbf B$ 胜；当小 $\\mathbf A$ 的点在编号为 $2$ 的坐标时，小 $\\mathbf A$ 胜；当小 $\\mathbf A$ 的点在编号为 $3$ 的坐标时，小 $\\mathbf B$ 胜。\n\n故在模意义下，小 $\\mathbf B$ 的胜率：$1+2=3$。\n\n### 样例 2 解释\n\n解码后，$x_{1,1}=1,x_{1,2}=2$，答案分别为 $18,18$，异或和为 $0$。\n\n**本题目采用捆绑测试**。\n\n| 子任务编号 | $k\\le$ | $q\\le$ | $a_i\\le$ | 时间限制 | 特殊性质 | 分值 |\n| :--------: | :----: | :----: | :------: | :------: | :------: | :--: |\n|    $0$     |  $5$   |  $30$  |   $30$   |   1 秒   |   样例    | $0$  |\n|    $1$     |  $1$   |  $30$  |   $30$   |   1 秒   |          | $5$  |\n|    $2$     |  $2$   |  $30$  |   $30$   |   1 秒   |          | $5$  |\n|    $3$     |  $10$  | $300$  |  $100$   |   1 秒   |          | $20$ |\n|    $4$     |  $15$  | $100$  | $2^{15}$ |   1 秒   |  $t=1$   | $20$ |\n|    $5$     |  $16$  | $1000$ |  $100$   |   1 秒   |          | $10$ |\n|    $6$     |  $16$  | $2000$ |  $3000$  |   1 秒   |  $t=1$   | $10$ |\n|    $7$     |  $16$  | $3000$ | $2^{15}$ |   2 秒   |  $t=1$   | $30$ |\n\n对于 $100\\%$ 数据，满足 $1\\le k\\le 16,1\\le q\\le 3000,0\\le p_i<998244353,1\\le a_i\\le 2^{15},0\\le l_i\\le r_i< 2^k,0\\le x_{i,j}< 2^k,t\\in\\{0,1\\},0\\le seed\\le 50007$。保证 $\\sum_{i=0}^{2^k-1}p_i\\equiv1\\pmod{998244353}$。\n\n本题输入输出量大，请使用较快的输入输出方式。", "locale": "zh-CN"}}}
{"pid": "P11898", "type": "P", "difficulty": 4, "samples": [["5 7\n1 2 3\n2 3 8\n3 5 1000\n2 4 100\n4 5 6\n1 4 78888\n1 3 114514", "151073832"], ["6 8\n1 3 100000000\n1 5 200000000\n2 5 300000000\n2 6 400000000\n3 4 500000000\n5 6 600000000\n4 5 700000000\n3 6 303063652\n", "403063652"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["最短路"], "title": "移动迷宫", "background": "花生在电线杆的小广告上看到大侦探福尔魔斯正在招募助手帮助他抓住穷凶极恶的杀人魔：不知道。\n\n花生出于某种原因来到了福尔魔斯的住处接受面试。但福尔魔斯住在一个...移动迷宫里？", "description": "这个迷宫一共有 $n$ 个房间和 $m$ 条双向道路。第 $i$ 条道路连接 $u_i$ 和 $v_i$ 这两个房间，长度为 $w_i$。\n\n福尔魔斯的迷宫是是会变化的：每通过一条道路（到达一个房间），所有道路都会伸缩，如果原本长度是 $t$，伸缩后长度会变化为 $\\dfrac{1}{1-t}\\bmod 754974721$。（如果你不知道分数如何取模，可移步 [P2613](https://www.luogu.com.cn/problem/P2613)；同时注意有可能涉及负数取模）\n\n花生位于 $1$ 号房间。根据花生的测算，福尔魔斯就住在 $n$ 号房间。\n\n请你帮帮花生最快到达 $n$ 号房间找到福尔魔斯。\n\n------\n负数取模：$x<0,p>0$，$x$ 对 $p$ 取模的结果等于 $x+p$ 对 $p$ 取模的结果。\n\n$754974721$ 是一个质数。", "inputFormat": "第一行，两个正整数 $n,m$。\n\n之后 $m$ 行，每行三个正整数 $u_i,v_i,w_i$，表示一条边。", "outputFormat": "输出一个正整数，表示到达 $n$ 号房间的最短距离。", "hint": "### 样例 #1 解释：\n沿路径 $1\\rightarrow 4\\rightarrow5$，路径长度为 $78888+150994944 = 151073832$。\n\n---\n对于 $30\\%$ 的数据，$n\\le 10$。\n\n对于另外 $30\\%$ 的数据，所有边边权相等。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^5$，保证是一张连通图，$1\\le u_i,v_i\\le n$，$1<w_i<754974721$，保证无论任何时刻不会出现边权为 $1$ 的边。\n\n所有输入的数都是整数。\n\n---\n后记：  \n花生到达福尔魔斯住的房间后，看见福尔魔斯正盯着显示屏目不转睛：“你在看什么？”   \n福尔魔斯：“不知道。”\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "移动迷宫", "background": "花生在电线杆的小广告上看到大侦探福尔魔斯正在招募助手帮助他抓住穷凶极恶的杀人魔：不知道。\n\n花生出于某种原因来到了福尔魔斯的住处接受面试。但福尔魔斯住在一个...移动迷宫里？", "description": "这个迷宫一共有 $n$ 个房间和 $m$ 条双向道路。第 $i$ 条道路连接 $u_i$ 和 $v_i$ 这两个房间，长度为 $w_i$。\n\n福尔魔斯的迷宫是是会变化的：每通过一条道路（到达一个房间），所有道路都会伸缩，如果原本长度是 $t$，伸缩后长度会变化为 $\\dfrac{1}{1-t}\\bmod 754974721$。（如果你不知道分数如何取模，可移步 [P2613](https://www.luogu.com.cn/problem/P2613)；同时注意有可能涉及负数取模）\n\n花生位于 $1$ 号房间。根据花生的测算，福尔魔斯就住在 $n$ 号房间。\n\n请你帮帮花生最快到达 $n$ 号房间找到福尔魔斯。\n\n------\n负数取模：$x<0,p>0$，$x$ 对 $p$ 取模的结果等于 $x+p$ 对 $p$ 取模的结果。\n\n$754974721$ 是一个质数。", "inputFormat": "第一行，两个正整数 $n,m$。\n\n之后 $m$ 行，每行三个正整数 $u_i,v_i,w_i$，表示一条边。", "outputFormat": "输出一个正整数，表示到达 $n$ 号房间的最短距离。", "hint": "### 样例 #1 解释：\n沿路径 $1\\rightarrow 4\\rightarrow5$，路径长度为 $78888+150994944 = 151073832$。\n\n---\n对于 $30\\%$ 的数据，$n\\le 10$。\n\n对于另外 $30\\%$ 的数据，所有边边权相等。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^5$，保证是一张连通图，$1\\le u_i,v_i\\le n$，$1<w_i<754974721$，保证无论任何时刻不会出现边权为 $1$ 的边。\n\n所有输入的数都是整数。\n\n---\n后记：  \n花生到达福尔魔斯住的房间后，看见福尔魔斯正盯着显示屏目不转睛：“你在看什么？”   \n福尔魔斯：“不知道。”\n", "locale": "zh-CN"}}}
{"pid": "P11899", "type": "P", "difficulty": 3, "samples": [["3\n1\n2\n2\n2 2\n1\n4", "Lucky_Holmes\nDraw\nAngry_Waston"], ["4\n3\n9 10 15\n3\n9 10 30\n2\n11 14\n4\n11 4 5 14", "Angry_Waston\nLucky_Holmes\nLucky_Holmes\nAngry_Waston"], ["3\n8\n7 12 15 17 21 23 30 31\n10\n10 11 12 13 14 15 16 17 18 19\n6\n16 17 18 16 17 18", "Angry_Waston\nAngry_Waston\nAngry_Waston"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "博弈论", "素数判断,质数,筛法"], "title": "必胜", "background": "福尔魔斯和花生在玩游戏。但福尔魔斯总是赢。\n\n花生什么时候才能发现福尔魔斯生成的初始局面总是有必胜策略呢？", "description": "福尔魔斯和花生在玩一个和数学有关的游戏。  \n\n初始场上有 $n$ 个整数 $a_1\\sim a_n$ 。  \n两人轮流行动，某人行动时需从下面两种操作中选择一种执行：  \n- 选择场上的一个数 $a_i$ ，将其除以其最大的质因子。\n- 选择场上的一个数 $a_i$ ，将其改为它自身的平方。任意时刻，该玩家使用该操作的总次数不能超过其总分值。\n\n若某名玩家操作结束后，场上有数等于 $1$ ，将其移除，令这名玩家获得 $1$ 分。  \n初始双方分数都为 $0$ ，若场上没有剩余的数，结束游戏，分数较多的一方获胜。  \n福尔魔斯先手。求双方都采取最优策略的前提下，哪方能获胜，或是返回平局。\n\n", "inputFormat": "**此题多测。**  \n第一行一个整数 $T$ ，代表数据组数。  \n每一组数据中：  \n第一行是一个整数 $n$ ，代表场上数字个数。  \n第二行是 $n$ 个整数 $a_1\\sim a_n$ ，代表场上的 $n$ 个整数。", "outputFormat": "共 $T$ 行，每行一个字符串，若会平局，输出 ```Draw``` ；否则若是 福尔魔斯 能赢，输出 ```Lucky_Holmes``` ；否则输出 ```Angry_Waston``` 。\n", "hint": "#### 样例一解释：\n一共有 3 组数据。\n\n第一组数据有一个二，福尔魔斯可以进行一次操作一，使 2 变成 1。花生无法进行操作。故答案为福尔魔斯赢。\n\n第二组数据有两个 2，无论福尔魔斯怎么操作，他都只能消掉一个 2，获得一分；而花生总可以拿到 1 分，所以结果为平局。\n\n第三组数据只有一个 4，福尔魔斯进行操作一之后花生再操作，花生得分，故为花生获胜。\n\n#### 样例二解释\n\n第一组数据中，$9 = 3\\times 3, 10 = 2\\times 5, 15 = 3\\times 5$，无论福尔魔斯怎么选择对哪个数进行操作，花生都可以再进行一次操作得分，故花生胜。\n\n---\n对于所有数据，满足 $1\\le T\\le10^4$ ，$1\\le\\sum{n}\\le2\\times10^6$ ， $2\\le a_i\\le10^7$ 。  \n\n|  #   |       特殊性质        | 分值 |\n| :--: | :-------------------: | :--: |\n|  0   | $n=1$ |  5  |\n|  1   | $\\sum{n}\\le 6 , a_i\\le10$ |  10  |\n|  2   | $\\sum{n}\\le4\\times10^2,a_i\\le4\\times10^3$ |  13  |\n|  3   | $\\sum{n}\\le10^4$ |  17  |\n|  4   | $a_i$ 为质数 |  10  |\n|  5   | $a_i$ 不为质数 |  20  |\n|  6   | 无特殊限制 |  25  |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "必胜", "background": "福尔魔斯和花生在玩游戏。但福尔魔斯总是赢。\n\n花生什么时候才能发现福尔魔斯生成的初始局面总是有必胜策略呢？", "description": "福尔魔斯和花生在玩一个和数学有关的游戏。  \n\n初始场上有 $n$ 个整数 $a_1\\sim a_n$ 。  \n两人轮流行动，某人行动时需从下面两种操作中选择一种执行：  \n- 选择场上的一个数 $a_i$ ，将其除以其最大的质因子。\n- 选择场上的一个数 $a_i$ ，将其改为它自身的平方。任意时刻，该玩家使用该操作的总次数不能超过其总分值。\n\n若某名玩家操作结束后，场上有数等于 $1$ ，将其移除，令这名玩家获得 $1$ 分。  \n初始双方分数都为 $0$ ，若场上没有剩余的数，结束游戏，分数较多的一方获胜。  \n福尔魔斯先手。求双方都采取最优策略的前提下，哪方能获胜，或是返回平局。\n\n", "inputFormat": "**此题多测。**  \n第一行一个整数 $T$ ，代表数据组数。  \n每一组数据中：  \n第一行是一个整数 $n$ ，代表场上数字个数。  \n第二行是 $n$ 个整数 $a_1\\sim a_n$ ，代表场上的 $n$ 个整数。", "outputFormat": "共 $T$ 行，每行一个字符串，若会平局，输出 ```Draw``` ；否则若是 福尔魔斯 能赢，输出 ```Lucky_Holmes``` ；否则输出 ```Angry_Waston``` 。\n", "hint": "#### 样例一解释：\n一共有 3 组数据。\n\n第一组数据有一个二，福尔魔斯可以进行一次操作一，使 2 变成 1。花生无法进行操作。故答案为福尔魔斯赢。\n\n第二组数据有两个 2，无论福尔魔斯怎么操作，他都只能消掉一个 2，获得一分；而花生总可以拿到 1 分，所以结果为平局。\n\n第三组数据只有一个 4，福尔魔斯进行操作一之后花生再操作，花生得分，故为花生获胜。\n\n#### 样例二解释\n\n第一组数据中，$9 = 3\\times 3, 10 = 2\\times 5, 15 = 3\\times 5$，无论福尔魔斯怎么选择对哪个数进行操作，花生都可以再进行一次操作得分，故花生胜。\n\n---\n对于所有数据，满足 $1\\le T\\le10^4$ ，$1\\le\\sum{n}\\le2\\times10^6$ ， $2\\le a_i\\le10^7$ 。  \n\n|  #   |       特殊性质        | 分值 |\n| :--: | :-------------------: | :--: |\n|  0   | $n=1$ |  5  |\n|  1   | $\\sum{n}\\le 6 , a_i\\le10$ |  10  |\n|  2   | $\\sum{n}\\le4\\times10^2,a_i\\le4\\times10^3$ |  13  |\n|  3   | $\\sum{n}\\le10^4$ |  17  |\n|  4   | $a_i$ 为质数 |  10  |\n|  5   | $a_i$ 不为质数 |  20  |\n|  6   | 无特殊限制 |  25  |", "locale": "zh-CN"}}}
{"pid": "P11900", "type": "P", "difficulty": 6, "samples": [["2 0\n", "0 1 \n"], ["4 1 \n3 \n", "0 748683265 748683265 499122177 \n"], ["8 3 \n3 6 8 \n", "0 291154603 291154603 582309206 166374059 166374059 748683265 748683265 \n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "概率论"], "title": "不知道", "background": "不知道，令人闻风丧胆的猫猫魔，福尔魔斯的宿敌。\n\n某一天，她在网上看到了一道小学奥数问题：约瑟夫问题。", "description": "不知道又要作案了。她让 $n$ 只猫猫站成一行，从左到右初始编号为 $1,2,\\dots,n$。同时，它们初始站在与自己编号相同的格子上。\n\n不知道有 $k+1$ 个喜欢的数字 $t_0,t_1,\\dots,t_k$ 。它们满足：  \n- $t_0=1$ \n- 对于 $1\\le i\\le k$ , $t_{i-1}<t_i$ \n- $t_k\\le n$\n\n不知道会摸 $n-1$ 轮猫猫，每一轮她都会摸正好一只猫猫。一次摸猫猫遵循以下规则：  \n1. 从 $0$ 到 $k$ 中随机选择一个数 $i$ 。\n1. 若有猫猫现在待在第 $t_i$ 格上，不知道会摸摸这个猫猫，随后这个猫猫将会跑出格子，不再参与后续的任何流程，然后进行第三步；否则回到第一步。\n1. 让所有猫猫跑到新的格子上。若此时有 $p$ 只猫猫，它们会在保证相对顺序不变的情况下排到 $[1,p]$ 的格子上。\n\n但是虽然猫猫很可爱，猫猫和不知道都是会厌烦的，所以当只剩一只猫猫时，不知道会停止摸猫猫。请求出每只猫猫最终没被摸的概率。\n \n最终答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n$ 和 $k$ ，代表总共有 $n$ 个猫猫，不知道共有 $k+1$ 个喜欢的数字。  \n第二行 $k$ 个整数，分别代表 $t_1$ 至 $t_k$ 共 $k$ 个数，中间用空格隔开。", "outputFormat": "一行 $n$ 个整数，第 $i$ 个数表示初始编号为 $i$ 的猫猫没被摸的概率，空格隔开；对 $998244353$ 取模。", "hint": "#### 样例解释：\n在第一组样例中，不知道只喜欢 $1$ 这个数字，因此她每次一定会摸当前的第一只猫猫，那么第一只猫猫一定会被摸，第二只猫猫一定不会被摸。  \n\n第二组样例中，四只猫猫从左到右不被摸的概率分别为 $0,\\frac{1}{4},\\frac{1}{4},\\frac{1}{2}$ 。\n\n#### 数据范围：\n\n**本题采用捆绑测试。**\n\n对所有数据，保证 $1\\le n,k\\le10^6$ ； $t_i$ 范围见上。\n\n|  #   |       特殊性质        | 分值 |\n| :--: | :-------------------: | :--: |\n|  0   | $n\\le 8$ |  10  |\n|  1   | $k=0$ |  5  |\n|  2   | $k=1$ |  10  |\n|  3   | $n\\le5\\times10^3$ |  15  |\n|  4   | $k\\le 10$ |  15  |\n|  5   | $n\\le2\\times10^5$ |  20  |\n|  6   | 无特殊限制 |  25  |\n\n后记：  \n花生：话说不知道本名叫什么   \n福尔魔斯：不知道，所以叫不知道  \n花生：？", "locale": "zh-CN", "translations": {"zh-CN": {"title": "不知道", "background": "不知道，令人闻风丧胆的猫猫魔，福尔魔斯的宿敌。\n\n某一天，她在网上看到了一道小学奥数问题：约瑟夫问题。", "description": "不知道又要作案了。她让 $n$ 只猫猫站成一行，从左到右初始编号为 $1,2,\\dots,n$。同时，它们初始站在与自己编号相同的格子上。\n\n不知道有 $k+1$ 个喜欢的数字 $t_0,t_1,\\dots,t_k$ 。它们满足：  \n- $t_0=1$ \n- 对于 $1\\le i\\le k$ , $t_{i-1}<t_i$ \n- $t_k\\le n$\n\n不知道会摸 $n-1$ 轮猫猫，每一轮她都会摸正好一只猫猫。一次摸猫猫遵循以下规则：  \n1. 从 $0$ 到 $k$ 中随机选择一个数 $i$ 。\n1. 若有猫猫现在待在第 $t_i$ 格上，不知道会摸摸这个猫猫，随后这个猫猫将会跑出格子，不再参与后续的任何流程，然后进行第三步；否则回到第一步。\n1. 让所有猫猫跑到新的格子上。若此时有 $p$ 只猫猫，它们会在保证相对顺序不变的情况下排到 $[1,p]$ 的格子上。\n\n但是虽然猫猫很可爱，猫猫和不知道都是会厌烦的，所以当只剩一只猫猫时，不知道会停止摸猫猫。请求出每只猫猫最终没被摸的概率。\n \n最终答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n$ 和 $k$ ，代表总共有 $n$ 个猫猫，不知道共有 $k+1$ 个喜欢的数字。  \n第二行 $k$ 个整数，分别代表 $t_1$ 至 $t_k$ 共 $k$ 个数，中间用空格隔开。", "outputFormat": "一行 $n$ 个整数，第 $i$ 个数表示初始编号为 $i$ 的猫猫没被摸的概率，空格隔开；对 $998244353$ 取模。", "hint": "#### 样例解释：\n在第一组样例中，不知道只喜欢 $1$ 这个数字，因此她每次一定会摸当前的第一只猫猫，那么第一只猫猫一定会被摸，第二只猫猫一定不会被摸。  \n\n第二组样例中，四只猫猫从左到右不被摸的概率分别为 $0,\\frac{1}{4},\\frac{1}{4},\\frac{1}{2}$ 。\n\n#### 数据范围：\n\n**本题采用捆绑测试。**\n\n对所有数据，保证 $1\\le n,k\\le10^6$ ； $t_i$ 范围见上。\n\n|  #   |       特殊性质        | 分值 |\n| :--: | :-------------------: | :--: |\n|  0   | $n\\le 8$ |  10  |\n|  1   | $k=0$ |  5  |\n|  2   | $k=1$ |  10  |\n|  3   | $n\\le5\\times10^3$ |  15  |\n|  4   | $k\\le 10$ |  15  |\n|  5   | $n\\le2\\times10^5$ |  20  |\n|  6   | 无特殊限制 |  25  |\n\n后记：  \n花生：话说不知道本名叫什么   \n福尔魔斯：不知道，所以叫不知道  \n花生：？", "locale": "zh-CN"}}}
{"pid": "P11901", "type": "P", "difficulty": 6, "samples": [["5 3 7 0\n3 1 2 3 \n4 3 2 2 2 \n3 3 2 2 \n2 3 3 2 1 \n3 1 5\n1 3\n3 1 5\n2 2 4 1 3 2\n3 1 5\n1 3\n3 1 5", "3\n4\n5\n4"], ["10 5 20 0\n3 1 2 3 \n5 3 3 1 1 3 \n10 1 2 1 1 2 3 2 1 1 3 \n2 1 1 \n2 1 3 \n1 3 2 3 3 1 3 3 2 3 \n1 4\n2 7 7 3 \n3 3 9\n1 4\n1 2\n2 5 5 2 \n1 2\n2 7 7 2 \n1 1\n3 5 8\n2 4 4 1 \n3 3 8\n1 1\n1 3\n2 6 6 1 \n2 1 1 1 \n2 4 4 2 \n1 7\n3 1 5\n3 1 9", "4\n2\n3\n4\n6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "后缀自动机 SAM", "动态树 LCT", "哈希 hashing", "分块"], "title": "数组的划分", "background": "本来这里应该有一段一脉相承的背景故事。但是因为福尔魔斯验题的时候写吐了，所以背景故事没了。", "description": "给出 $m$ 个数组 $s_1, s_2, \\cdots s_m$ 和一个长为 $n$ 的数组 $t$。\n\n定义 $f(l,r)$ 表示在所有 \"把 $t_l...t_r$ 分成若干段，要求每一段都是 $s$ 中某个数组的子段\" 的方式中，划分段数的最小值。\n\n有以下操作：\n\n1. 强制限定 $p,p+1$ 处必须划分，如果已经有了则取消。\n\n2. 将 $t$ 的区间 $[l, r]$ 改成数组 $a$，会给出 $a$，每次的 $a$ 可能不一样。\n\n3. 询问 $f(l,r)$，保证有解。\n\n请你完成这些操作。\n", "inputFormat": "第一行四个数，$n,m,q,id$，表示 $t$ 的长度，总共有多少个文本数组 $s$，操作数，以及数据类型（参见说明）。\n\n接下来 $m$ 行，每行先给出一个数 $k$，代表 $s_i$ 的长度，然后 $k$ 个数给出 $s_i$ 这个数组的元素。\n\n下一行，给出 $n$ 个数，表示 $t$ 中的元素。\n\n接下来 $q$ 行，每行表示一个操作，分别如下：\n\n1. $1\\ x$，表示若 $x,x+1$ 处不必须划分，则标为必须划分，否则取消。\n\n2. $2\\ l\\ r\\ a_1\\ a_2 \\cdots a_{r-l+1}$，表示令 $\\forall l \\le i \\le r，t_i = a_{i-l+1}$。\n\n3. $3\\ l\\ r$，表示询问 $f(l,r)$。", "outputFormat": "对于每次询问，输出一个数表示答案。每个答案占一行。", "hint": "## 样例解释\n\n对于第一组样例，初始数组为 $[2,3,3,2,1]$ ，段数最小分割的方式为 $[2,3|3,2|1]$ ，故输出 $3$ 。然后限制了 $3,4$ 之间必须分割，故最小的分割方式为 $[2,3|3|2|1]$ ，输出为 $4$ 。之后数组被修改为 $[2,1,3,2,1]$ ，段数最小的分割方式为 $[2|1|3|2|1]$ ，故输出 $5$ 。最后取消了 $3,4$ 之间必须分割的限制，最小分割方式为 $[2|1|3,2|1]$ ，输出 $4$ 。\n\n-----\n\n## 数据范围\n\n记 $\\sum\\limits_{i=1}^m |s_i|= M$ ，对于所有操作 2， $\\sum\\limits_{i=1}^t |r_i-l_i+1| = T$ ，其中 $t$ 是操作 2 的出现次数， $V$ 为数组中和修改后的数组中的元素的最大值，则各数据点的限制如下：\n\n| 测试点 | $n, M, q \\leq$ | $T\\leq$ | $V\\leq$ | $id=$ | 特殊性质|\n| :-----------: | :-----------: |  :-----------: | :-----------: | :-----------: | :-----------: |\n| $1\\sim3$ | $50$ | $10^5$ | $10^9$ | $1$ | 无 |\n| $4$ | $1000$ | $1000$ | $10^9$ | $2$ | 无 |\n| $5$ | $1000$ | $0$ | $4$ | $3$ | 保证没有操作 1, 2 |\n| $6\\sim7$ | $1000$ | $0$ | $4$ | $4$ | 保证没有操作 2 |\n| $8\\sim11$ | $1000$ | $1000$ | $4$| $5$ | 无 |\n| $12$ | $10^5$ | $10^5$ | $10^9$| $6$ | 无 |\n| $13\\sim14$ | $10^5$ | $0$ | $4$| $7$ | 保证没有操作 1, 2 |\n| $15\\sim17$ | $10^5$ | $0$ | $4$| $8$ | 保证没有操作 2 |\n| $18\\sim25$ | $10^5$ | $10^5$ | $4$| $9$ | 无 |\n\n对于所有数据，保证 $1\\le n,M,q\\le10^5, 0\\le T\\le 10^5,1\\le V\\le10^9, 1\\le id\\le9, l\\le r$ 。$a,t$ 中的所有数都在 $s$ 中出现。\n\n**保证给出的数组随机，但是询问的区间与询问的操作并不随机**。具体而言，初始给出的 $s,t$ 以及询问时可能给出的 $a$ 在符合上文所述限制之下的所有可能情况中等概率选取。而其他数据则不是随机的。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "数组的划分", "background": "本来这里应该有一段一脉相承的背景故事。但是因为福尔魔斯验题的时候写吐了，所以背景故事没了。", "description": "给出 $m$ 个数组 $s_1, s_2, \\cdots s_m$ 和一个长为 $n$ 的数组 $t$。\n\n定义 $f(l,r)$ 表示在所有 \"把 $t_l...t_r$ 分成若干段，要求每一段都是 $s$ 中某个数组的子段\" 的方式中，划分段数的最小值。\n\n有以下操作：\n\n1. 强制限定 $p,p+1$ 处必须划分，如果已经有了则取消。\n\n2. 将 $t$ 的区间 $[l, r]$ 改成数组 $a$，会给出 $a$，每次的 $a$ 可能不一样。\n\n3. 询问 $f(l,r)$，保证有解。\n\n请你完成这些操作。\n", "inputFormat": "第一行四个数，$n,m,q,id$，表示 $t$ 的长度，总共有多少个文本数组 $s$，操作数，以及数据类型（参见说明）。\n\n接下来 $m$ 行，每行先给出一个数 $k$，代表 $s_i$ 的长度，然后 $k$ 个数给出 $s_i$ 这个数组的元素。\n\n下一行，给出 $n$ 个数，表示 $t$ 中的元素。\n\n接下来 $q$ 行，每行表示一个操作，分别如下：\n\n1. $1\\ x$，表示若 $x,x+1$ 处不必须划分，则标为必须划分，否则取消。\n\n2. $2\\ l\\ r\\ a_1\\ a_2 \\cdots a_{r-l+1}$，表示令 $\\forall l \\le i \\le r，t_i = a_{i-l+1}$。\n\n3. $3\\ l\\ r$，表示询问 $f(l,r)$。", "outputFormat": "对于每次询问，输出一个数表示答案。每个答案占一行。", "hint": "## 样例解释\n\n对于第一组样例，初始数组为 $[2,3,3,2,1]$ ，段数最小分割的方式为 $[2,3|3,2|1]$ ，故输出 $3$ 。然后限制了 $3,4$ 之间必须分割，故最小的分割方式为 $[2,3|3|2|1]$ ，输出为 $4$ 。之后数组被修改为 $[2,1,3,2,1]$ ，段数最小的分割方式为 $[2|1|3|2|1]$ ，故输出 $5$ 。最后取消了 $3,4$ 之间必须分割的限制，最小分割方式为 $[2|1|3,2|1]$ ，输出 $4$ 。\n\n-----\n\n## 数据范围\n\n记 $\\sum\\limits_{i=1}^m |s_i|= M$ ，对于所有操作 2， $\\sum\\limits_{i=1}^t |r_i-l_i+1| = T$ ，其中 $t$ 是操作 2 的出现次数， $V$ 为数组中和修改后的数组中的元素的最大值，则各数据点的限制如下：\n\n| 测试点 | $n, M, q \\leq$ | $T\\leq$ | $V\\leq$ | $id=$ | 特殊性质|\n| :-----------: | :-----------: |  :-----------: | :-----------: | :-----------: | :-----------: |\n| $1\\sim3$ | $50$ | $10^5$ | $10^9$ | $1$ | 无 |\n| $4$ | $1000$ | $1000$ | $10^9$ | $2$ | 无 |\n| $5$ | $1000$ | $0$ | $4$ | $3$ | 保证没有操作 1, 2 |\n| $6\\sim7$ | $1000$ | $0$ | $4$ | $4$ | 保证没有操作 2 |\n| $8\\sim11$ | $1000$ | $1000$ | $4$| $5$ | 无 |\n| $12$ | $10^5$ | $10^5$ | $10^9$| $6$ | 无 |\n| $13\\sim14$ | $10^5$ | $0$ | $4$| $7$ | 保证没有操作 1, 2 |\n| $15\\sim17$ | $10^5$ | $0$ | $4$| $8$ | 保证没有操作 2 |\n| $18\\sim25$ | $10^5$ | $10^5$ | $4$| $9$ | 无 |\n\n对于所有数据，保证 $1\\le n,M,q\\le10^5, 0\\le T\\le 10^5,1\\le V\\le10^9, 1\\le id\\le9, l\\le r$ 。$a,t$ 中的所有数都在 $s$ 中出现。\n\n**保证给出的数组随机，但是询问的区间与询问的操作并不随机**。具体而言，初始给出的 $s,t$ 以及询问时可能给出的 $a$ 在符合上文所述限制之下的所有可能情况中等概率选取。而其他数据则不是随机的。", "locale": "zh-CN"}}}
