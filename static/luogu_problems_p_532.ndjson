{"pid": "P11801", "type": "P", "difficulty": 5, "samples": [["8 10 4\n1 8\n2 5\n3 6\n2 6\n3 8\n1 6\n2 1\n4 8\n3 4\n6 7\n2 7\n4 3\n5 4\n3 8\n", "2\n1\n2\n2\n"], ["20 20 20\n8 19\n19 11\n11 18\n11 20\n20 9\n18 13\n19 1\n11 16\n19 5\n1 2\n2 15\n18 6\n16 7\n8 10\n5 4\n18 14\n11 17\n10 12\n7 3\n1 9\n13 14\n11 18\n13 16\n13 16\n3 14\n20 20\n16 18\n14 19\n8 19\n5 20\n7 17\n14 15\n16 18\n7 18\n6 10\n16 17\n14 19\n3 16\n20 20\n20 20\n", "2\n2\n2\n2\n4\n1\n2\n3\n2\n3\n3\n3\n2\n3\n3\n2\n3\n3\n1\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Kruskal 重构树", "O2优化", "笛卡尔树", "梦熊比赛"], "title": "【MX-X9-T5】『GROI-R3』Star Trip", "background": "", "description": "对于整数序列 $p_1,\\ldots,p_n$，我们称 $p_i$ 是一个**前缀最大值**当且仅当不存在 $1\\le j<i$ 使得 $p_j\\ge p_i$。\n\n对于整数序列 $p_1,\\ldots,p_n$，定义其**权值**为其前缀最大值个数。\n\n小巡有一个包含 $n$ 个点和 $m$ 条无向边的连通图，点的编号为 $1 \\sim n$。**保证图连通，不保证图是简单图。**\n\n音理有 $q$ 个询问，每次给定两个点 $s,t$，请你找出从点 $s$ 出发、在点 $t$ 结束的路径 $p_1, \\dots, p_k$（$p_1 = s$，$p_k = t$，且存在连接点 $p_i, p_{i + 1}$ 的边），使得序列 $p_1, \\ldots, p_k$ 的权值最小。你只需要求出最小权值。\n\n特别地，我们不要求你找到的路径是简单路径。也就是说，**可以经过重复的边或者点**。", "inputFormat": "第一行，三个正整数 $n,m,q$。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条连接点 $u, v$ 的边。\n\n接下来 $q$ 行，每行两个正整数 $s,t$，表示一组询问。", "outputFormat": "$q$ 行，每行一个正整数，表示对应询问的答案。", "hint": "**【样例解释 #1】**\n\n样例的图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/04v1mwxe.png)\n\n- 对于询问 $2,7$，其中一条权值最小的路径是 $(2,1,8,3,6,7)$，权值为 $2$。\n- 对于询问 $4,3$，其中一条权值最小的路径是 $(4,3)$，权值为 $1$。\n- 对于询问 $5,4$，其中一条权值最小的路径是 $(5,2,6,3,4)$，权值为 $2$。\n- 对于询问 $3,8$，其中一条权值最小的路径是 $(3,8)$，权值为 $2$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n,m\\le$ | $q\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $8$ | $8$ |  | $5$ |\n| 2 | $300$ | $300$ |  | $15$ |\n| 3 | $3000$ | $3000$ |  | $10$ |\n| 4 | $3000$ | $2\\times 10^5$ |  | $5$ |\n| 5 | $2\\times 10^5$ | $2\\times 10^5$ | A | $20$ |\n| 6 | $2\\times 10^5$ | $2\\times 10^5$ | B | $20$ |\n| 7 | $2\\times 10^5$ | $2\\times 10^5$ |  | $25$ |\n\n- 特殊性质 A：保证 $m=n-1$。\n- 特殊性质 B：保证对于任意 $i\\in[1,n]$ 满足 $V'=\\{1,2,\\ldots,i\\}$ 的导出子图是连通图。\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m,q\\leq 2\\times 10^5$，$1\\le u,v,s,t\\le n$，保证图连通，不保证图不存在重边或自环。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-X9-T5】『GROI-R3』Star Trip", "background": "", "description": "对于整数序列 $p_1,\\ldots,p_n$，我们称 $p_i$ 是一个**前缀最大值**当且仅当不存在 $1\\le j<i$ 使得 $p_j\\ge p_i$。\n\n对于整数序列 $p_1,\\ldots,p_n$，定义其**权值**为其前缀最大值个数。\n\n小巡有一个包含 $n$ 个点和 $m$ 条无向边的连通图，点的编号为 $1 \\sim n$。**保证图连通，不保证图是简单图。**\n\n音理有 $q$ 个询问，每次给定两个点 $s,t$，请你找出从点 $s$ 出发、在点 $t$ 结束的路径 $p_1, \\dots, p_k$（$p_1 = s$，$p_k = t$，且存在连接点 $p_i, p_{i + 1}$ 的边），使得序列 $p_1, \\ldots, p_k$ 的权值最小。你只需要求出最小权值。\n\n特别地，我们不要求你找到的路径是简单路径。也就是说，**可以经过重复的边或者点**。", "inputFormat": "第一行，三个正整数 $n,m,q$。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条连接点 $u, v$ 的边。\n\n接下来 $q$ 行，每行两个正整数 $s,t$，表示一组询问。", "outputFormat": "$q$ 行，每行一个正整数，表示对应询问的答案。", "hint": "**【样例解释 #1】**\n\n样例的图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/04v1mwxe.png)\n\n- 对于询问 $2,7$，其中一条权值最小的路径是 $(2,1,8,3,6,7)$，权值为 $2$。\n- 对于询问 $4,3$，其中一条权值最小的路径是 $(4,3)$，权值为 $1$。\n- 对于询问 $5,4$，其中一条权值最小的路径是 $(5,2,6,3,4)$，权值为 $2$。\n- 对于询问 $3,8$，其中一条权值最小的路径是 $(3,8)$，权值为 $2$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n,m\\le$ | $q\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $8$ | $8$ |  | $5$ |\n| 2 | $300$ | $300$ |  | $15$ |\n| 3 | $3000$ | $3000$ |  | $10$ |\n| 4 | $3000$ | $2\\times 10^5$ |  | $5$ |\n| 5 | $2\\times 10^5$ | $2\\times 10^5$ | A | $20$ |\n| 6 | $2\\times 10^5$ | $2\\times 10^5$ | B | $20$ |\n| 7 | $2\\times 10^5$ | $2\\times 10^5$ |  | $25$ |\n\n- 特殊性质 A：保证 $m=n-1$。\n- 特殊性质 B：保证对于任意 $i\\in[1,n]$ 满足 $V'=\\{1,2,\\ldots,i\\}$ 的导出子图是连通图。\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m,q\\leq 2\\times 10^5$，$1\\le u,v,s,t\\le n$，保证图连通，不保证图不存在重边或自环。", "locale": "zh-CN"}}}
{"pid": "P11802", "type": "P", "difficulty": 6, "samples": [["5 4\n2 5 -1 -1 -1\n", "3\n"], ["9 7\n7 -1 -1 -1 8 1 -1 -1 5\n", "60\n"], ["8 10\n-1 -1 4 -1 -1 -1 -1 -1\n", "1266\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "梦熊比赛"], "title": "【MX-X9-T6】『GROI-R3』Graph", "background": "", "description": "给定一张 $n$ 个点的有向图 $G=(V,E)$，点的编号为 $1 \\sim n$，其每个点都入度、出度均不大于 $1$。\n\n在出度不大于 $1$ 的有向图中，我们记 $f^k(x)$ 表示点 $x$ 在图上沿着出边走 $k$ 步走到的点（如果走到一个不存在出边的点，则停在该点上）。\n\n进一步定义 $G^k=(V,E')$，其中 $E'=\\{(x,f^k(x))\\mid x\\in V\\}$。我们称 $G$ 为 $G^k$ 的 $k$ 次方根。\n\n若一个点入度出度均为 $0$ 则称其为孤立点。\n\n又给定一个正整数 $c$，你需要给 $G$ 增加若干条边得到图 $G'$，使得：\n\n1. 每个节点的入度出度均为 $1$。\n2. 若两个非孤立点在 $G'$ 上位于同一连通块$^{\\dagger}$，则在 $G$ 上也要位于同一连通块。\n3. 图 $G'$ 存在 $c$ 次方根。\n\n求加边的方案总数，答案对 $998244353$ 取模。\n\n$^{\\dagger}$：本题中定义有向图连通块为：将所有边视作无向边得到的连通块。", "inputFormat": "第一行，两个正整数 $n,c$。\n\n第二行，$n$ 个整数，第 $i$ 个表示点 $i$ 的出边指向的点的编号，若为 $-1$ 则表示无出边。", "outputFormat": "仅一行，一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "令 $a_i$ 表示点 $i$ 的出边指向点的编号。\n\n**【样例解释 #1】**\n\n合法的序列 $a_1,\\ldots,a_n$ 有：\n\n- $2,5,1,3,4$。\n- $2,5,3,4,1$。\n- $2,5,4,1,3$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\le$ | $c\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $5$ | $5$ |  | $2$ |\n| 2 | $1000$ | $2\\times10^9$ | A | $3$ |\n| 3 | $10$ | $2\\times10^9$ |  | $15$ |\n| 4 | $20$ | $2\\times10^9$ |  | $10$ |\n| 5 | $100$ | $2\\times10^9$ |  | $25$ |\n| 6 | $500$ | $2\\times10^9$ | B | $10$ |\n| 7 | $500$ | $2\\times10^9$ |  | $20$ |\n| 8 | $1000$ | $2\\times10^9$ |  | $15$ |\n\n- 特殊性质 A：保证不存在 $a_i=-1$。\n- 特殊性质 B：保证所有 $a_i=-1$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 1000$，$1\\le c\\le 2\\times10^9$，$1\\le a_i\\le n$ 或 $a_i=-1$，不存在 $i\\ne j$ 使得 $a_i=a_j$ 且 $a_i \\ne -1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-X9-T6】『GROI-R3』Graph", "background": "", "description": "给定一张 $n$ 个点的有向图 $G=(V,E)$，点的编号为 $1 \\sim n$，其每个点都入度、出度均不大于 $1$。\n\n在出度不大于 $1$ 的有向图中，我们记 $f^k(x)$ 表示点 $x$ 在图上沿着出边走 $k$ 步走到的点（如果走到一个不存在出边的点，则停在该点上）。\n\n进一步定义 $G^k=(V,E')$，其中 $E'=\\{(x,f^k(x))\\mid x\\in V\\}$。我们称 $G$ 为 $G^k$ 的 $k$ 次方根。\n\n若一个点入度出度均为 $0$ 则称其为孤立点。\n\n又给定一个正整数 $c$，你需要给 $G$ 增加若干条边得到图 $G'$，使得：\n\n1. 每个节点的入度出度均为 $1$。\n2. 若两个非孤立点在 $G'$ 上位于同一连通块$^{\\dagger}$，则在 $G$ 上也要位于同一连通块。\n3. 图 $G'$ 存在 $c$ 次方根。\n\n求加边的方案总数，答案对 $998244353$ 取模。\n\n$^{\\dagger}$：本题中定义有向图连通块为：将所有边视作无向边得到的连通块。", "inputFormat": "第一行，两个正整数 $n,c$。\n\n第二行，$n$ 个整数，第 $i$ 个表示点 $i$ 的出边指向的点的编号，若为 $-1$ 则表示无出边。", "outputFormat": "仅一行，一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "令 $a_i$ 表示点 $i$ 的出边指向点的编号。\n\n**【样例解释 #1】**\n\n合法的序列 $a_1,\\ldots,a_n$ 有：\n\n- $2,5,1,3,4$。\n- $2,5,3,4,1$。\n- $2,5,4,1,3$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\le$ | $c\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $5$ | $5$ |  | $2$ |\n| 2 | $1000$ | $2\\times10^9$ | A | $3$ |\n| 3 | $10$ | $2\\times10^9$ |  | $15$ |\n| 4 | $20$ | $2\\times10^9$ |  | $10$ |\n| 5 | $100$ | $2\\times10^9$ |  | $25$ |\n| 6 | $500$ | $2\\times10^9$ | B | $10$ |\n| 7 | $500$ | $2\\times10^9$ |  | $20$ |\n| 8 | $1000$ | $2\\times10^9$ |  | $15$ |\n\n- 特殊性质 A：保证不存在 $a_i=-1$。\n- 特殊性质 B：保证所有 $a_i=-1$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 1000$，$1\\le c\\le 2\\times10^9$，$1\\le a_i\\le n$ 或 $a_i=-1$，不存在 $i\\ne j$ 使得 $a_i=a_j$ 且 $a_i \\ne -1$。", "locale": "zh-CN"}}}
{"pid": "P11803", "type": "P", "difficulty": 7, "samples": [["5 7\n1 1 1 1 1\n1 2 2 1\n3 1\n2 1 1\n3 2\n1 3 5 2\n2 1 2\n3 1\n3 4\n", "0\n1\n3\n1\n"], ["10 20\n1 1 1 1 1 1 1 1 1 1\n1 1 1 2 1 5 2 1 2\n2 8 614463136\n1 8 2 6\n2 1 694700038\n2 10 835675175\n1 2 6 1\n2 1 890463929\n2 3 371010342\n3 8\n1 6 5 7\n3 10\n2 5 933771207\n1 6 4 7\n3 2\n3 8\n3 7\n3 10\n3 10\n3 7\n3 2\n3 7", "614463136\n2711612582\n2809708614\n614463136\n1875937407\n2711612582\n2711612582\n1875937407\n2809708614\n1875937407\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["O2优化", "梦熊比赛"], "title": "【MX-X9-T7】『GROI-R3』此花绽放之时", "background": "在盛开的樱花树下，\n\n属于我们的最后一场演奏会开始了。", "description": "樱乃给你一棵 $n$ 个点的树，点的编号为 $1\\sim n$。每个点初始有点权 $a_i=0$ 和颜色 $c_i$。你需要维护三种操作：\n\n- `1 x y c`：把点 $x\\sim y$ 最短路径上所有点颜色改为 $c$。\n- `2 x w`：把点 $x$ 所属极大相同颜色连通块中的所有点的点权增加 $w$。\n- `3 x`：查询点 $x$ 点权。", "inputFormat": "第一行，两个正整数表示 $n, q$，其中 $q$ 表示操作总数。\n\n第二行，$n$ 个正整数 $c_1,\\ldots,c_n$。\n\n第三行，$n-1$ 个正整数 $f_2,\\ldots,f_n$，表示存在边 $(f_i,i)$。保证 $f_i \\le i - 1$。\n\n接下来 $q$ 行，每行若干个正整数，表示一次操作，格式见题目描述。", "outputFormat": "对每个查询操作，输出一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jkwu7bmq.png)\n\n样例的树如图。\n\n一开始所有点颜色均为 $1$。\n\n- 第 $1$ 次操作：询问 $1$ 的点权。答案为 $0$；\n- 第 $2$ 次操作：把 $1$ 所处极大连通块所有点点权加 $1$。当前点权序列为 $[1,1,1,1,1]$；\n- 第 $3$ 次操作：查询 $2$ 的点权。答案为 $1$；\n- 第 $4$ 次操作：把 $3\\sim 5$ 最短路径所有点颜色改为 $2$。当前颜色序列为 $[2,2,2,1,2]$；\n- 第 $5$ 次操作：把 $1$ 所处极大连通块所有点点权加 $2$。当前点权序列为 $[3,3,3,1,3]$；\n- 第 $6$ 次操作：查询 $1$ 的点权。答案为 $3$；\n- 第 $7$ 次操作：查询 $4$ 的点权。答案为 $1$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |   $n,q\\leq$    | 特殊性质 | 分值 |\n| :----------: | :--: | :------------: | :------: |\n|     1      |     $5000$     |        | $10$ |\n|     2      | $2\\times 10^5$ |    A     | $20$ |\n|     3      | $2\\times 10^5$ |    B     | $10$ |\n|     4      | $5\\times 10^4$ |        | $30$ |\n|     5      | $2\\times 10^5$ |        | $30$ |\n\n- 特殊性质 A：保证 $f_i=i-1$。\n- 特殊性质 B：保证没有 1 操作。\n\n对于 $100\\%$ 的数据，保证 $2\\leq n,q\\leq 2\\times 10^5$，$1\\leq c_i\\leq n$，$1\\leq f_i\\leq i-1$，$1 \\le x, y, c \\le n$，$1 \\le w \\le 10^9$，保证至少有一次 3 操作。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-X9-T7】『GROI-R3』此花绽放之时", "background": "在盛开的樱花树下，\n\n属于我们的最后一场演奏会开始了。", "description": "樱乃给你一棵 $n$ 个点的树，点的编号为 $1\\sim n$。每个点初始有点权 $a_i=0$ 和颜色 $c_i$。你需要维护三种操作：\n\n- `1 x y c`：把点 $x\\sim y$ 最短路径上所有点颜色改为 $c$。\n- `2 x w`：把点 $x$ 所属极大相同颜色连通块中的所有点的点权增加 $w$。\n- `3 x`：查询点 $x$ 点权。", "inputFormat": "第一行，两个正整数表示 $n, q$，其中 $q$ 表示操作总数。\n\n第二行，$n$ 个正整数 $c_1,\\ldots,c_n$。\n\n第三行，$n-1$ 个正整数 $f_2,\\ldots,f_n$，表示存在边 $(f_i,i)$。保证 $f_i \\le i - 1$。\n\n接下来 $q$ 行，每行若干个正整数，表示一次操作，格式见题目描述。", "outputFormat": "对每个查询操作，输出一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jkwu7bmq.png)\n\n样例的树如图。\n\n一开始所有点颜色均为 $1$。\n\n- 第 $1$ 次操作：询问 $1$ 的点权。答案为 $0$；\n- 第 $2$ 次操作：把 $1$ 所处极大连通块所有点点权加 $1$。当前点权序列为 $[1,1,1,1,1]$；\n- 第 $3$ 次操作：查询 $2$ 的点权。答案为 $1$；\n- 第 $4$ 次操作：把 $3\\sim 5$ 最短路径所有点颜色改为 $2$。当前颜色序列为 $[2,2,2,1,2]$；\n- 第 $5$ 次操作：把 $1$ 所处极大连通块所有点点权加 $2$。当前点权序列为 $[3,3,3,1,3]$；\n- 第 $6$ 次操作：查询 $1$ 的点权。答案为 $3$；\n- 第 $7$ 次操作：查询 $4$ 的点权。答案为 $1$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |   $n,q\\leq$    | 特殊性质 | 分值 |\n| :----------: | :--: | :------------: | :------: |\n|     1      |     $5000$     |        | $10$ |\n|     2      | $2\\times 10^5$ |    A     | $20$ |\n|     3      | $2\\times 10^5$ |    B     | $10$ |\n|     4      | $5\\times 10^4$ |        | $30$ |\n|     5      | $2\\times 10^5$ |        | $30$ |\n\n- 特殊性质 A：保证 $f_i=i-1$。\n- 特殊性质 B：保证没有 1 操作。\n\n对于 $100\\%$ 的数据，保证 $2\\leq n,q\\leq 2\\times 10^5$，$1\\leq c_i\\leq n$，$1\\leq f_i\\leq i-1$，$1 \\le x, y, c \\le n$，$1 \\le w \\le 10^9$，保证至少有一次 3 操作。", "locale": "zh-CN"}}}
{"pid": "P11804", "type": "P", "difficulty": 1, "samples": [["5\n3 4 1 3 3", "5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "PA（波兰）"], "title": "[PA 2017] 换钱", "background": "译自 [PA 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/) R1T1。\n\n", "description": "有 $n$ 枚硬币，第 $i$ 枚硬币面额为 $2^{a_i}$。\n\n可以将两枚面额均为 $2^j$ 的硬币合成一枚面额 $2^{j+1}$ 的硬币。求出**可能得到**的最大的金币面额。\n", "inputFormat": "第一行，正整数 $n$。\n\n第二行，$n$ 个非负整数 $a_1,\\cdots,a_n$。", "outputFormat": "令答案为 $2^k$，输出一行一个非负整数 $k$。", "hint": "- $1\\le n\\le 10^6$；\n- $0\\le a_i\\le 201\\, 718$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2017] 换钱", "background": "译自 [PA 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/) R1T1。\n\n", "description": "有 $n$ 枚硬币，第 $i$ 枚硬币面额为 $2^{a_i}$。\n\n可以将两枚面额均为 $2^j$ 的硬币合成一枚面额 $2^{j+1}$ 的硬币。求出**可能得到**的最大的金币面额。\n", "inputFormat": "第一行，正整数 $n$。\n\n第二行，$n$ 个非负整数 $a_1,\\cdots,a_n$。", "outputFormat": "令答案为 $2^k$，输出一行一个非负整数 $k$。", "hint": "- $1\\le n\\le 10^6$；\n- $0\\le a_i\\le 201\\, 718$。", "locale": "zh-CN"}}}
{"pid": "P11805", "type": "P", "difficulty": 5, "samples": [["4 3\n3 10 11 23\n4 2 5", "4\n1\n6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "线段树", "PA（波兰）"], "title": "[PA 2017] 烧饼 2", "background": "\n译自 [PA 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/) R2T1。\n\n", "description": "有 $n$ 个人买烧饼。第 $i$ 个人会在时刻 $t_i$ 到达。\n\n顾客只会买新鲜出炉的烧饼。也就是说，第 $i$ 个人拿到的烧饼必须在时刻 $t_i$ 或者之后**出炉**。\n\n有 $m$ 种烤箱，第 $i$ 种烤箱需要 $d_i$ 单位时间来烤烧饼。也就是说，如果从时刻 $a$ 开始烤烧饼，那么出炉时间为时刻 $(a+d_i)$。\n\n对于每一种烤箱，计算：如果用**一台**这种烤箱，从 $0$ 时刻起烤烧饼，计算最优策略下顾客等待时间和的最小值。\n", "inputFormat": "第一行，两个正整数 $n,m$。\n\n第二行，$n$ 个非负整数 $t_1,t_2,\\cdots,t_n$。\n\n第三行，$m$ 个正整数 $d_1,d_2,\\cdots,d_m$。", "outputFormat": "输出 $m$ 行，第 $i$ 行一个非负整数，表示选择第 $i$ 种烤箱的答案。", "hint": "- $1\\le n,m\\le 2\\times 10^5$；\n- $0\\le t_1\\le t_2\\le \\cdots\\le t_n\\le 10^{12}$；\n- $1\\le d_i\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2017] 烧饼 2", "background": "\n译自 [PA 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/) R2T1。\n\n", "description": "有 $n$ 个人买烧饼。第 $i$ 个人会在时刻 $t_i$ 到达。\n\n顾客只会买新鲜出炉的烧饼。也就是说，第 $i$ 个人拿到的烧饼必须在时刻 $t_i$ 或者之后**出炉**。\n\n有 $m$ 种烤箱，第 $i$ 种烤箱需要 $d_i$ 单位时间来烤烧饼。也就是说，如果从时刻 $a$ 开始烤烧饼，那么出炉时间为时刻 $(a+d_i)$。\n\n对于每一种烤箱，计算：如果用**一台**这种烤箱，从 $0$ 时刻起烤烧饼，计算最优策略下顾客等待时间和的最小值。\n", "inputFormat": "第一行，两个正整数 $n,m$。\n\n第二行，$n$ 个非负整数 $t_1,t_2,\\cdots,t_n$。\n\n第三行，$m$ 个正整数 $d_1,d_2,\\cdots,d_m$。", "outputFormat": "输出 $m$ 行，第 $i$ 行一个非负整数，表示选择第 $i$ 种烤箱的答案。", "hint": "- $1\\le n,m\\le 2\\times 10^5$；\n- $0\\le t_1\\le t_2\\le \\cdots\\le t_n\\le 10^{12}$；\n- $1\\le d_i\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P11806", "type": "P", "difficulty": 6, "samples": [["3\n2\n0 0\n0 1\n2\n3 2\n2 3\n4\n1 1\n2 1\n3 1\n1 2", "TAK 1 1\nNIE\nTAK 1 1 3 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "Special Judge", "构造", "PA（波兰）"], "title": "[PA 2017] 马赛克", "background": "\n译自 [PA 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/) R3T1。\n", "description": "给定二维平面上的 $n$ 个整点。第 $i$ 个点的坐标是 $(x_i,y_i)$。\n\n构造 $n$ 个正方形，其中第 $i$ 个正方形的左下角顶点是 $(x_i,y_i)$，满足以下条件：\n\n- 这 $n$ 个正方形的并是一个矩形；\n- 任取 $1\\le i\\lt j\\le n$，正方形 $i,j$ 的交面积为 $0$。（也就是说，正方形的边缘可以重合，但正方形不能相交。）", "inputFormat": "**本题单个测试点内有多组测试数据。**\n\n第一行，正整数 $T$，表示测试数据组数。接下来依次描述 $T$ 组测试数据。\n\n每组测试数据中，第一行一个正整数 $n$。\n\n接下来 $n$ 行，每行两个非负整数 $x_i,y_i$。", "outputFormat": "对于每组测试数据输出一行：\n\n如果不可能，输出一行一个 $\\texttt{NIE}$。\n\n否则输出 $\\texttt{TAK}$ $l_1$ $l_2$ $\\ldots$ $l_n$，其中正整数 $l_i$ 表示正方形 $i$ 的边长。\n\n你需要保证 $1\\le l_i\\le 2\\times 10^9$。保证如果存在解，则存在一组 $1\\le l_i\\le 2\\times 10^9$ 的合法解。", "hint": "- $1\\le T\\le 50$；\n- $1\\le n\\le 2\\times 10^3$，$1\\le \\sum n\\le 5\\times 10^3$；\n- $0\\le x_i,y_i\\le 10^9$；\n- 如果存在解，则存在 $1\\le l_i\\le 2\\times 10^9$ 的合法解。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2017] 马赛克", "background": "\n译自 [PA 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/) R3T1。\n", "description": "给定二维平面上的 $n$ 个整点。第 $i$ 个点的坐标是 $(x_i,y_i)$。\n\n构造 $n$ 个正方形，其中第 $i$ 个正方形的左下角顶点是 $(x_i,y_i)$，满足以下条件：\n\n- 这 $n$ 个正方形的并是一个矩形；\n- 任取 $1\\le i\\lt j\\le n$，正方形 $i,j$ 的交面积为 $0$。（也就是说，正方形的边缘可以重合，但正方形不能相交。）", "inputFormat": "**本题单个测试点内有多组测试数据。**\n\n第一行，正整数 $T$，表示测试数据组数。接下来依次描述 $T$ 组测试数据。\n\n每组测试数据中，第一行一个正整数 $n$。\n\n接下来 $n$ 行，每行两个非负整数 $x_i,y_i$。", "outputFormat": "对于每组测试数据输出一行：\n\n如果不可能，输出一行一个 $\\texttt{NIE}$。\n\n否则输出 $\\texttt{TAK}$ $l_1$ $l_2$ $\\ldots$ $l_n$，其中正整数 $l_i$ 表示正方形 $i$ 的边长。\n\n你需要保证 $1\\le l_i\\le 2\\times 10^9$。保证如果存在解，则存在一组 $1\\le l_i\\le 2\\times 10^9$ 的合法解。", "hint": "- $1\\le T\\le 50$；\n- $1\\le n\\le 2\\times 10^3$，$1\\le \\sum n\\le 5\\times 10^3$；\n- $0\\le x_i,y_i\\le 10^9$；\n- 如果存在解，则存在 $1\\le l_i\\le 2\\times 10^9$ 的合法解。", "locale": "zh-CN"}}}
{"pid": "P11807", "type": "P", "difficulty": 6, "samples": [["5 8\n4 2 1 7 3\n3 6\n1 2\n2 5\n5 5\n1 5\n1 4\n1 5", "3 4 5 1 2 7 6 8"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2017", "二分", "可持久化线段树", "哈希 hashing", "PA（波兰）"], "title": "[PA 2017] 抄作业", "background": "\n译自 [PA 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/) R3T2。\n\nTL=5~10s，ML=512MB。\n\n「你抄就抄吧，但是稍微改改，别和我的一模一样就行。」\n", "description": "有 $m$ 个长度为 $n$ 的非负整数序列。第 $i$ 个序列的第 $j$ 项为 $a_{i,j}$。\n\n给定 $a_{1,1},a_{1,2},\\cdots,a_{1,n}$。\n\n对于 $2\\le i\\le m$，给定 $p_i,x_i$，表示：\n\n- $\\forall 1\\le j\\le n$ 满足 $j\\neq p_i$，有 $a_{i,j}=a_{i-1,j}$；\n- $a_{i,p_i}=x_i$。\n\n将这 $m$ 个序列以字典序为第一关键字，编号为第二关键字排序，输出排序后的序列编号。\n", "inputFormat": "第一行，两个正整数 $n,m$。\n\n第二行，$n$ 个非负整数 $a_{1,1},a_{1,2},\\cdots,a_{1,n}$。\n\n接下来 $(m-1)$ 行，第 $i$ 行两个整数 $p_{i+1},x_{i+1}$。", "outputFormat": "输出一行 $m$ 个正整数，第 $i$ 个数表示排名为 $i$ 的序列的编号。", "hint": "- $1\\le n\\le 5\\times 10^5$；\n- $2\\le m\\le 5\\times 10^5$；\n- $0\\le a_{1,i},x_i\\le 10^9$；\n- $1\\le p_i\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2017] 抄作业", "background": "\n译自 [PA 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/) R3T2。\n\nTL=5~10s，ML=512MB。\n\n「你抄就抄吧，但是稍微改改，别和我的一模一样就行。」\n", "description": "有 $m$ 个长度为 $n$ 的非负整数序列。第 $i$ 个序列的第 $j$ 项为 $a_{i,j}$。\n\n给定 $a_{1,1},a_{1,2},\\cdots,a_{1,n}$。\n\n对于 $2\\le i\\le m$，给定 $p_i,x_i$，表示：\n\n- $\\forall 1\\le j\\le n$ 满足 $j\\neq p_i$，有 $a_{i,j}=a_{i-1,j}$；\n- $a_{i,p_i}=x_i$。\n\n将这 $m$ 个序列以字典序为第一关键字，编号为第二关键字排序，输出排序后的序列编号。\n", "inputFormat": "第一行，两个正整数 $n,m$。\n\n第二行，$n$ 个非负整数 $a_{1,1},a_{1,2},\\cdots,a_{1,n}$。\n\n接下来 $(m-1)$ 行，第 $i$ 行两个整数 $p_{i+1},x_{i+1}$。", "outputFormat": "输出一行 $m$ 个正整数，第 $i$ 个数表示排名为 $i$ 的序列的编号。", "hint": "- $1\\le n\\le 5\\times 10^5$；\n- $2\\le m\\le 5\\times 10^5$；\n- $0\\le a_{1,i},x_i\\le 10^9$；\n- $1\\le p_i\\le n$。", "locale": "zh-CN"}}}
{"pid": "P11808", "type": "P", "difficulty": 7, "samples": [["3 2\n.#.\n##.\n#..", "8"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "PA（波兰）"], "title": "[PA 2017] 摆砖 / Carcassonne", "background": "译自 [Potyczki Algorytmiczne 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/p/) R5 Carcassonne [B] (CAR)。$\\texttt{5s,256M}$。\n", "description": "\n给定一块 $n\\times n$ 的棋盘，上面可能已经放了若干块 $1\\times 1$ 的砖。\n\n现在要再放置 $k$ 块 $1\\times 1$ 砖。如果放置的砖不是这个棋盘上的第一块砖，则要求放置的这块砖必须和之前棋盘上有的砖至少有一条公共边。\n\n求方案数对 $(10^9+7)$ 取模后的结果。\n\n称两个方案是不同的，当且仅当存在一个格子，仅在一个方案中放了砖。", "inputFormat": "\n第一行两个正整数 $n,k$。\n\n接下来 $n$ 行，第 $i$ 行一个长度为 $n$ 的字符串 $s_i$。\n\n$s_{i,j}=\\texttt{\\#}$，代表 $(i,j)$ 上放了砖；否则 $s_{i,j}=\\texttt{.}$，代表没有放砖。", "outputFormat": "输出一行一个整数，即方案数对 $(10^9+7)$ 取模后的结果。\n", "hint": "\n- $2\\le n\\le 3\\times 10^3$；\n- $1\\le k\\le 4$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2017] 摆砖 / Carcassonne", "background": "译自 [Potyczki Algorytmiczne 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/p/) R5 Carcassonne [B] (CAR)。$\\texttt{5s,256M}$。\n", "description": "\n给定一块 $n\\times n$ 的棋盘，上面可能已经放了若干块 $1\\times 1$ 的砖。\n\n现在要再放置 $k$ 块 $1\\times 1$ 砖。如果放置的砖不是这个棋盘上的第一块砖，则要求放置的这块砖必须和之前棋盘上有的砖至少有一条公共边。\n\n求方案数对 $(10^9+7)$ 取模后的结果。\n\n称两个方案是不同的，当且仅当存在一个格子，仅在一个方案中放了砖。", "inputFormat": "\n第一行两个正整数 $n,k$。\n\n接下来 $n$ 行，第 $i$ 行一个长度为 $n$ 的字符串 $s_i$。\n\n$s_{i,j}=\\texttt{\\#}$，代表 $(i,j)$ 上放了砖；否则 $s_{i,j}=\\texttt{.}$，代表没有放砖。", "outputFormat": "输出一行一个整数，即方案数对 $(10^9+7)$ 取模后的结果。\n", "hint": "\n- $2\\le n\\le 3\\times 10^3$；\n- $1\\le k\\le 4$。\n", "locale": "zh-CN"}}}
{"pid": "P11809", "type": "P", "difficulty": 7, "samples": [["6\n4 3 5 6 8\n8 7 4 9 5 8 6 9 7\n4 13 5 14 6\n10 8 1 17 12 8 11 0 2 4 0\n4 11 4 15 8\n4 10 10 13 11", "5"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "PA（波兰）"], "title": "[PA 2017] 等高线 / Giewont", "background": "译自 [Potyczki Algorytmiczne 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/p/) R5 Giewont [A] (GIE)。$\\texttt{15s,512M}$。\n", "description": "\n定义好的多边形为各边平行于一条坐标轴，各个顶点都在整点上的简单多边形。\n\n给定 $n$ 个好的多边形，这些多边形的边缘两两不交，也不接触。\n\n多边形之间可能相互包含。存在一个多边形包含其他所有的多边形，我们称它为**边界**。\n\n定义这张图的**分数**为：选出一个序列 $a_1,a_2,\\cdots,a_k$，使得 $\\forall 1\\le i\\lt k$，都有多边形 $a_i$ 包含多边形 $a_{i+1}$，$k$ 可能的最大值。\n\n在边界内添加若干个**好的**多边形，使得添加后，这些多边形仍然边缘两两不交，也不接触。最大化添加多边形后的分数，你只需要输出这个分数即可。\n\n可参阅样例解释图片。\n", "inputFormat": "\n第一行一个正整数 $n$。\n\n接下来 $n$ 行描述 $n$ 个好的多边形：\n\n每行显示一个正偶数 $k$，然后是 $k$ 个整数 $x_1,x_2,\\ldots,x_k$，表示第 $i$ 个多边形的顶点为 $(x_1,x_2),\\textcolor{red}{(x_3,x_2)},(x_3,x_4),\\textcolor{red}{(x_5,x_4)},\\ldots,(x_{k-1},x_k),\\textcolor{red}{(x_1,x_k)}$。\n\n按照给定顺序经过多边形的边时，**保证多边形的内部在左侧**。\n\n给出多边形的顺序是任意的。", "outputFormat": "输出一行一个正整数，表示答案。\n", "hint": "\n\n#### 样例解释\n\n如下图，实线代表原图中的多边形，虚线代表添加的多边形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4rheoevm.png)\n\n#### 数据范围\n\n- $2\\mid k$，$\\sum k\\le 5\\times 10^4$；\n- $|x_i|\\le 10^8$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2017] 等高线 / Giewont", "background": "译自 [Potyczki Algorytmiczne 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/p/) R5 Giewont [A] (GIE)。$\\texttt{15s,512M}$。\n", "description": "\n定义好的多边形为各边平行于一条坐标轴，各个顶点都在整点上的简单多边形。\n\n给定 $n$ 个好的多边形，这些多边形的边缘两两不交，也不接触。\n\n多边形之间可能相互包含。存在一个多边形包含其他所有的多边形，我们称它为**边界**。\n\n定义这张图的**分数**为：选出一个序列 $a_1,a_2,\\cdots,a_k$，使得 $\\forall 1\\le i\\lt k$，都有多边形 $a_i$ 包含多边形 $a_{i+1}$，$k$ 可能的最大值。\n\n在边界内添加若干个**好的**多边形，使得添加后，这些多边形仍然边缘两两不交，也不接触。最大化添加多边形后的分数，你只需要输出这个分数即可。\n\n可参阅样例解释图片。\n", "inputFormat": "\n第一行一个正整数 $n$。\n\n接下来 $n$ 行描述 $n$ 个好的多边形：\n\n每行显示一个正偶数 $k$，然后是 $k$ 个整数 $x_1,x_2,\\ldots,x_k$，表示第 $i$ 个多边形的顶点为 $(x_1,x_2),\\textcolor{red}{(x_3,x_2)},(x_3,x_4),\\textcolor{red}{(x_5,x_4)},\\ldots,(x_{k-1},x_k),\\textcolor{red}{(x_1,x_k)}$。\n\n按照给定顺序经过多边形的边时，**保证多边形的内部在左侧**。\n\n给出多边形的顺序是任意的。", "outputFormat": "输出一行一个正整数，表示答案。\n", "hint": "\n\n#### 样例解释\n\n如下图，实线代表原图中的多边形，虚线代表添加的多边形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4rheoevm.png)\n\n#### 数据范围\n\n- $2\\mid k$，$\\sum k\\le 5\\times 10^4$；\n- $|x_i|\\le 10^8$。", "locale": "zh-CN"}}}
{"pid": "P11810", "type": "P", "difficulty": 7, "samples": [["3 4\n..WK\nWK..\n...K\n5\n1 3 2\n1 3 2\n2 3 3 3 2\n2 3 2 2 2\n1 3 2\n", "101\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "PA（波兰）"], "title": "[PA 2017] 商旅 / Osady i warownie", "background": "\n译自 [Potyczki Algorytmiczne 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/p/) R5 Osady i warownie [A] (OSA)。$\\texttt{3s,512M}$。\n\n原题为函数式交互题，此处改为**强制在线**的传统题。\n", "description": "\n一个长为 $n$，宽为 $m$ 的长方形被划分为 $n\\times m$ 个 $1\\times 1$ 的方格。我们记第 $i$ 行第 $j$ 列的方格为 $(i,j)$。\n\n每个方格可能是城镇，堡垒或者空地。商人在城镇间来往贸易，可以从一个方格移动到四连通的方格，但是**不能经过堡垒**。\n\n有 $q$ 次**在线**操作：\n\n- $\\texttt{1}$ $r$ $c$：在 $(r,c)$ 上尝试建立一座堡垒，保证 $(r,c)$ 是空地。\n    - 如果建立堡垒后，商人仍能从一个城镇到达任意一个城镇，则建立成功，$(r,c)$ 变为堡垒，输出 $1$；\n    - 否则忽略本次操作，$(r,c)$ 仍为空地，输出 $0$。\n- $\\texttt{2}$ $r_1$ $c_1$ $r_2$ $c_2$：\n    - 将 $(r_1,c_1)$ 上的城镇移动到相邻的 $(r_2,c_2)$。\n    - 保证 $(r_1,c_1)$ 是城镇，$(r_2,c_2)$ 是空地。\n    - 保证 $|r_1-r_2|+|c_1-c_2|=1$。\n", "inputFormat": "**注意，本题的输入量可能很大。**\n\n第一行两个正整数 $n,m$。\n\n接下来 $n$ 行，第 $i$ 行一个长度为 $m$ 的字符串 $s_i$：\n- $s_{i,j}=\\texttt{.}$，表示 $(i,j)$ 是空地；\n- $s_{i,j}=\\texttt{W}$，表示 $(i,j)$ 是堡垒；\n- 否则 $s_{i,j}=\\texttt{K}$，表示 $(i,j)$ 是城镇。\n\n第 $(n+2)$ 行，一个整数 $q$。\n\n接下来 $q$ 行，每行若干个整数，表示一次**加密的**操作：\n- $\\texttt{1}$ $r'$ $c'$，表示一次 $\\texttt{1}$ 操作，其中 $r=r'\\oplus k$，$c=c'\\oplus k$。\n- $\\texttt{2}$ $r_1'$ $c_1'$ $r_2'$ $c_2'$：表示一次 $\\texttt{2}$ 操作，其中 $r_1=r_1'\\oplus k$，$r_2=r_2'\\oplus k$，$c_1=c_1'\\oplus k$，$c_2=c_2'\\oplus k$。\n\n这里，$k$ 表示这次操作**前**，操作 $\\texttt{1}$ 输出 $1$ 的个数，$\\oplus$ 表示按位异或运算。", "outputFormat": "输出一行一个 $\\texttt{01}$ 串：对于每个 $\\texttt{1}$ 操作，输出一行一个整数，表示答案。\n", "hint": "#### 样例解释\n\n加密前的样例：\n\n```plain\n3 4\n..WK\nWK..\n...K\n5\n1 3 2\n1 2 3\n2 2 2 2 3\n2 2 3 3 3\n1 2 3\n```\n\n####\n\n- $1\\le n,m\\le 10^3$；\n- $0\\le q\\le 10^6$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2017] 商旅 / Osady i warownie", "background": "\n译自 [Potyczki Algorytmiczne 2017](https://sio2.mimuw.edu.pl/c/pa-2017-1/p/) R5 Osady i warownie [A] (OSA)。$\\texttt{3s,512M}$。\n\n原题为函数式交互题，此处改为**强制在线**的传统题。\n", "description": "\n一个长为 $n$，宽为 $m$ 的长方形被划分为 $n\\times m$ 个 $1\\times 1$ 的方格。我们记第 $i$ 行第 $j$ 列的方格为 $(i,j)$。\n\n每个方格可能是城镇，堡垒或者空地。商人在城镇间来往贸易，可以从一个方格移动到四连通的方格，但是**不能经过堡垒**。\n\n有 $q$ 次**在线**操作：\n\n- $\\texttt{1}$ $r$ $c$：在 $(r,c)$ 上尝试建立一座堡垒，保证 $(r,c)$ 是空地。\n    - 如果建立堡垒后，商人仍能从一个城镇到达任意一个城镇，则建立成功，$(r,c)$ 变为堡垒，输出 $1$；\n    - 否则忽略本次操作，$(r,c)$ 仍为空地，输出 $0$。\n- $\\texttt{2}$ $r_1$ $c_1$ $r_2$ $c_2$：\n    - 将 $(r_1,c_1)$ 上的城镇移动到相邻的 $(r_2,c_2)$。\n    - 保证 $(r_1,c_1)$ 是城镇，$(r_2,c_2)$ 是空地。\n    - 保证 $|r_1-r_2|+|c_1-c_2|=1$。\n", "inputFormat": "**注意，本题的输入量可能很大。**\n\n第一行两个正整数 $n,m$。\n\n接下来 $n$ 行，第 $i$ 行一个长度为 $m$ 的字符串 $s_i$：\n- $s_{i,j}=\\texttt{.}$，表示 $(i,j)$ 是空地；\n- $s_{i,j}=\\texttt{W}$，表示 $(i,j)$ 是堡垒；\n- 否则 $s_{i,j}=\\texttt{K}$，表示 $(i,j)$ 是城镇。\n\n第 $(n+2)$ 行，一个整数 $q$。\n\n接下来 $q$ 行，每行若干个整数，表示一次**加密的**操作：\n- $\\texttt{1}$ $r'$ $c'$，表示一次 $\\texttt{1}$ 操作，其中 $r=r'\\oplus k$，$c=c'\\oplus k$。\n- $\\texttt{2}$ $r_1'$ $c_1'$ $r_2'$ $c_2'$：表示一次 $\\texttt{2}$ 操作，其中 $r_1=r_1'\\oplus k$，$r_2=r_2'\\oplus k$，$c_1=c_1'\\oplus k$，$c_2=c_2'\\oplus k$。\n\n这里，$k$ 表示这次操作**前**，操作 $\\texttt{1}$ 输出 $1$ 的个数，$\\oplus$ 表示按位异或运算。", "outputFormat": "输出一行一个 $\\texttt{01}$ 串：对于每个 $\\texttt{1}$ 操作，输出一行一个整数，表示答案。\n", "hint": "#### 样例解释\n\n加密前的样例：\n\n```plain\n3 4\n..WK\nWK..\n...K\n5\n1 3 2\n1 2 3\n2 2 2 2 3\n2 2 3 3 3\n1 2 3\n```\n\n####\n\n- $1\\le n,m\\le 10^3$；\n- $0\\le q\\le 10^6$。\n", "locale": "zh-CN"}}}
{"pid": "P11811", "type": "P", "difficulty": 3, "samples": [["4 4 2\n1 2\n2 3\n3 4\n4 2", "3\n2 3 4"], ["3 2 2\n1 2\n2 3", "NIE"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "2015", "并查集", "Special Judge", "PA（波兰）"], "title": "[PA 2015] 人赢 / Mistrzostwa", "background": "译自 [PA 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R2.", "description": "给定一张 $n$ 个点 $m$ 条边的**简单**（无重边自环的）无向图 $G=(V,E)$。其中节点编号 $1\\sim n$。\n\n给定正整数 $d$。选出一个最大的点集 $S\\subseteq V$，满足：\n\n- $\\forall u\\in S$，$\\displaystyle \\sum_{v\\in S} [(u,v)\\in E]\\ge d$。换句话说，$u$ 向 $S$ 内点至少连了 $d$ 条边。\n- $S$ 的导出子图（induced subgraph）是连通的。\n\n你需要构造一个 $S$ 使得 $|S|$ 取到最大值，或者报告无解。\n\n点集 $V'\\subseteq V$ 的导出子图定义为 $G'=(V',E')$，其中 $E'=\\{(u,v)\\in E: u\\in V'\\land v\\in V'\\}$。\n", "inputFormat": "第一行，三个正整数 $n,m,d$。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，表示 $(u,v)\\in E$。", "outputFormat": "如果符合条件的 $S$ 不存在，输出一行一个 $\\texttt{NIE}$。\n\n否则，第一行输出 $|S|$，第二行**升序**输出 $S$ 中节点的编号。", "hint": "- $1\\le d\\lt n\\le 2\\times 10^5$；\n- $1\\le m\\le 2\\times 10^5$。\n- 给定的图无重边自环。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] 人赢 / Mistrzostwa", "background": "译自 [PA 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R2.", "description": "给定一张 $n$ 个点 $m$ 条边的**简单**（无重边自环的）无向图 $G=(V,E)$。其中节点编号 $1\\sim n$。\n\n给定正整数 $d$。选出一个最大的点集 $S\\subseteq V$，满足：\n\n- $\\forall u\\in S$，$\\displaystyle \\sum_{v\\in S} [(u,v)\\in E]\\ge d$。换句话说，$u$ 向 $S$ 内点至少连了 $d$ 条边。\n- $S$ 的导出子图（induced subgraph）是连通的。\n\n你需要构造一个 $S$ 使得 $|S|$ 取到最大值，或者报告无解。\n\n点集 $V'\\subseteq V$ 的导出子图定义为 $G'=(V',E')$，其中 $E'=\\{(u,v)\\in E: u\\in V'\\land v\\in V'\\}$。\n", "inputFormat": "第一行，三个正整数 $n,m,d$。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，表示 $(u,v)\\in E$。", "outputFormat": "如果符合条件的 $S$ 不存在，输出一行一个 $\\texttt{NIE}$。\n\n否则，第一行输出 $|S|$，第二行**升序**输出 $S$ 中节点的编号。", "hint": "- $1\\le d\\lt n\\le 2\\times 10^5$；\n- $1\\le m\\le 2\\times 10^5$。\n- 给定的图无重边自环。\n", "locale": "zh-CN"}}}
{"pid": "P11812", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2\n2 3\n3 1\n3 4\n4 2", "2\n2 3"], ["3 2\n1 2\n2 3", "NIE"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "2015", "强连通分量", "PA（波兰）"], "title": "[PA 2015] 精确打击 / Kontrmanifestacja", "background": "\n译自 [PA 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R5.\n", "description": "给定一张 $n$ 个点 $m$ 条边的**有向图**。有向图无重边自环。\n\n对于这张图的经过边数量 $\\ge 1$ 的回路，求回路上点集的交。\n", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $u,v$，表示一条有向边 $u\\to v$。", "outputFormat": "如果不存在经过边数 $\\ge 1$ 的回路，输出一行一个 $\\texttt{NIE}$。\n\n否则第一行输出一个非负整数 $k$，表示点集交的大小。\n\n第二行**升序**输出交中的节点。特别地，若 $k=0$，应输出一行空行。\n", "hint": "- $2\\le n\\le 5\\times 10^5$；\n- $1\\le m\\le 10^6$；\n- 图无重边自环。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] 精确打击 / Kontrmanifestacja", "background": "\n译自 [PA 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R5.\n", "description": "给定一张 $n$ 个点 $m$ 条边的**有向图**。有向图无重边自环。\n\n对于这张图的经过边数量 $\\ge 1$ 的回路，求回路上点集的交。\n", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $u,v$，表示一条有向边 $u\\to v$。", "outputFormat": "如果不存在经过边数 $\\ge 1$ 的回路，输出一行一个 $\\texttt{NIE}$。\n\n否则第一行输出一个非负整数 $k$，表示点集交的大小。\n\n第二行**升序**输出交中的节点。特别地，若 $k=0$，应输出一行空行。\n", "hint": "- $2\\le n\\le 5\\times 10^5$；\n- $1\\le m\\le 10^6$；\n- 图无重边自环。", "locale": "zh-CN"}}}
{"pid": "P11813", "type": "P", "difficulty": 7, "samples": [["4 2 2\n0100\n0010\n1001\n1000\n3 4", "2"], ["4 2 2\n0100\n0010\n1001\n1000\n2 3", "-1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "Special Judge", "PA（波兰）"], "title": "[PA 2015] 机器人 / Roboty", "background": "译自 [Potyczki Algorytmiczne 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R5 Roboty [A] (ROB)。$\\texttt{1s,256M}$。\n", "description": "\n有 $n$ 个区域，编号 $1\\sim n$。编号 $1\\sim b$ 的区域是**基地**。\n\n给定 $n$ 个非空集合 $A_1,A_2,\\cdots,A_n$。\n\n有 $r$ 个机器人在区域里。第 $i$ 个机器人的初始位置为 $s_i$。\n\n你可以下达任意次移动指令。每次指令下达后，设第 $i$ 个机器人的位置为 $x_i$，则第 $i$ 个机器人会**等概率独立随机**地移动到 $A_{x_i}$ 中的任意一个地点。\n\n是否存在一个非负整数 $k$，使得下达 $k$ 次指令后，每个机器人都**一定**回到基地（即位于编号 $1\\sim b$ 的基地中）？找到满足条件的**任意一个** $k$。\n\n保证如果存在 $k$，则 $k$ 的最小值严格小于 $10^{200}$。\n\n", "inputFormat": "\n第一行三个正整数 $n,b,r$。\n\n接下来 $n$ 行，第 $i$ 行一个长度为 $n$ 的 $\\texttt{01}$ 串 $a_{i,j}$。$a_{i,j}=1 \\iff j\\in A_i$。\n\n第 $(n+2)$ 行，$r$ 个递增的正整数 $s_1,\\ldots,s_r$。", "outputFormat": "\n如果存在这样的 $k$，输出一行一个非负整数 $k$；否则输出一行一个 $\\texttt{-1}$。\n\n评测时将忽略多余的前导零。**你应当保证**你输出的 $k$ 不大于 $10^{10000}$，否则可能导致 UKE。\n\n保证如果存在 $k$，则 $k$ 的最小值严格小于 $10^{200}$。\n\n", "hint": "\n- $2\\le n\\le 200$；\n- $1\\le b,r\\le n$；\n- $1\\le s_1\\lt s_2\\lt \\ldots \\lt s_r \\le n$。\n\n保证如果存在 $k$，则 $k$ 的最小值严格小于 $10^{200}$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] 机器人 / Roboty", "background": "译自 [Potyczki Algorytmiczne 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R5 Roboty [A] (ROB)。$\\texttt{1s,256M}$。\n", "description": "\n有 $n$ 个区域，编号 $1\\sim n$。编号 $1\\sim b$ 的区域是**基地**。\n\n给定 $n$ 个非空集合 $A_1,A_2,\\cdots,A_n$。\n\n有 $r$ 个机器人在区域里。第 $i$ 个机器人的初始位置为 $s_i$。\n\n你可以下达任意次移动指令。每次指令下达后，设第 $i$ 个机器人的位置为 $x_i$，则第 $i$ 个机器人会**等概率独立随机**地移动到 $A_{x_i}$ 中的任意一个地点。\n\n是否存在一个非负整数 $k$，使得下达 $k$ 次指令后，每个机器人都**一定**回到基地（即位于编号 $1\\sim b$ 的基地中）？找到满足条件的**任意一个** $k$。\n\n保证如果存在 $k$，则 $k$ 的最小值严格小于 $10^{200}$。\n\n", "inputFormat": "\n第一行三个正整数 $n,b,r$。\n\n接下来 $n$ 行，第 $i$ 行一个长度为 $n$ 的 $\\texttt{01}$ 串 $a_{i,j}$。$a_{i,j}=1 \\iff j\\in A_i$。\n\n第 $(n+2)$ 行，$r$ 个递增的正整数 $s_1,\\ldots,s_r$。", "outputFormat": "\n如果存在这样的 $k$，输出一行一个非负整数 $k$；否则输出一行一个 $\\texttt{-1}$。\n\n评测时将忽略多余的前导零。**你应当保证**你输出的 $k$ 不大于 $10^{10000}$，否则可能导致 UKE。\n\n保证如果存在 $k$，则 $k$ 的最小值严格小于 $10^{200}$。\n\n", "hint": "\n- $2\\le n\\le 200$；\n- $1\\le b,r\\le n$；\n- $1\\le s_1\\lt s_2\\lt \\ldots \\lt s_r \\le n$。\n\n保证如果存在 $k$，则 $k$ 的最小值严格小于 $10^{200}$。\n\n", "locale": "zh-CN"}}}
{"pid": "P11814", "type": "P", "difficulty": 7, "samples": [["5 3\n1 -1 2 -1 2\n1 2 2 1 2\n2 2 -1 1 1", "1 2 2 1 2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2014", "Special Judge", "PA（波兰）"], "title": "[PA 2014] 串串 / Ciągi", "background": "译自 [PA 2014](https://sio2.mimuw.edu.pl/c/pa-2014-1/p/) R5。\n", "description": "给定 $k$ 个长度为 $n$ 的序列 $A_1,A_2,\\cdots,A_k$。\n\n定义两个长度为 $n$ 的序列 $a,b$ 的**距离** $\\operatorname{dist}(a,b)$ 为：\n\n$$\\operatorname{dist}(a,b)=\\sum_{1\\le i\\le n} |a_i-b_i|$$\n\n你需要构造一个长度为 $n$ 的序列 $B$，最小化 $\\displaystyle \\max_{1\\le i\\le k} \\operatorname{dist}(A_i,B)$ 的值。\n", "inputFormat": "第一行，两个正整数 $n,k$。\n\n接下来 $k$ 行，第 $i$ 行 $n$ 个整数 $A_{i,1},A_{i,2},\\cdots,A_{i,n}$。", "outputFormat": "输出 $n$ 个整数，表示你构造的 $B$ 序列。\n\n**你需要保证**你输出的数在 $[-2^{31},2^{31})$ 内。\n", "hint": "- $2\\le n\\le 10^5$；\n- $2\\le k\\le 5$；\n- $|A_{i,j}|\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2014] 串串 / Ciągi", "background": "译自 [PA 2014](https://sio2.mimuw.edu.pl/c/pa-2014-1/p/) R5。\n", "description": "给定 $k$ 个长度为 $n$ 的序列 $A_1,A_2,\\cdots,A_k$。\n\n定义两个长度为 $n$ 的序列 $a,b$ 的**距离** $\\operatorname{dist}(a,b)$ 为：\n\n$$\\operatorname{dist}(a,b)=\\sum_{1\\le i\\le n} |a_i-b_i|$$\n\n你需要构造一个长度为 $n$ 的序列 $B$，最小化 $\\displaystyle \\max_{1\\le i\\le k} \\operatorname{dist}(A_i,B)$ 的值。\n", "inputFormat": "第一行，两个正整数 $n,k$。\n\n接下来 $k$ 行，第 $i$ 行 $n$ 个整数 $A_{i,1},A_{i,2},\\cdots,A_{i,n}$。", "outputFormat": "输出 $n$ 个整数，表示你构造的 $B$ 序列。\n\n**你需要保证**你输出的数在 $[-2^{31},2^{31})$ 内。\n", "hint": "- $2\\le n\\le 10^5$；\n- $2\\le k\\le 5$；\n- $|A_{i,j}|\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P11815", "type": "P", "difficulty": 6, "samples": [["2 1 2\n1 1 1 1 3\n1 2 1 2 4", "9"], ["3 7 3\n1 1 3 3 1\n5 1 7 3 1\n3 2 5 3 1", "3"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2019", "PA（波兰）"], "title": "[PA 2019 Final] 领地 / Terytoria", "background": "译自 PA 2019 Final。$\\texttt{3s,512M}$。\n\n本题数据为自造。\n\nstd：zimpha，validator：Starrykiller，generator：KanameMadoka。", "description": "一个长为 $X$ 宽为 $Y$ 的矩形被分为 $X\\times Y$ 个方格。我们记第 $i$ 行第 $j$ 列的方格为 $(i,j)$。\n\n有 $n$ 种动物。第 $i$ 种动物**不喜欢**待在以 $(x_i,y_i)$ 和 $(x_i',y_i')$ 为对角顶点确定的矩形内。我们保证这个矩形**严格包含于** $X\\times Y$ 的矩形。\n\n第 $i$ 种动物有 $c_i$ 只。那么，一共有 $S=c_1+c_2+\\cdots+c_n$ 只动物。\n\n现在要将每只动物放在一个方格里面。**一个方格里面可以放多只动物，但是一只动物不能待在它不喜欢的区域**。\n\n记 $(i,j)$ 内有 $p_{i,j}$ 只动物，那么这种分配方式的得分为 $\\displaystyle \\sum_{1\\le i\\le X}\\sum_{1\\le j\\le Y} {p_{i,j}\\choose 2}$。这里，$\\displaystyle {a\\choose 2}=\\frac{a(a-1)}{2}$。\n\n找到合法的分配方式中得分最大的那个分配方式。只需要输出最大的得分。\n\n\n", "inputFormat": "第一行，三个正整数 $n,X,Y$。\n\n接下来 $n$ 行，每行五个正整数 $x_i,y_i,x'_i,y'_i,c_i$。", "outputFormat": "输出一行一个正整数，表示答案。", "hint": "- $1\\le n\\le 10^5$；\n- $1\\le X,Y\\le 10^3$；\n- $\\textcolor{red}{1\\le x_i\\le x'_i\\le X},\\textcolor{red}{1\\le y_i\\le y'_i\\le Y}$；\n- 以下条件中，**至少有一个**成立：${x_i\\neq 1},{y_i\\neq 1},{x'_i\\neq X},{y'_i\\neq Y}$；\n- $1\\le c_i\\le 10^3$。\n\n样例解释：\n\n对于第一个样例，只能把第一种动物全部放在 $(1,2)$，第二种动物全部放在 $(1,1)$，得分为 $\\binom{4}{2}+\\binom{3}{2}=9$。\n\n对于第二个样例，最优方案为把三种动物都全部放在 $(4,1)$，得分为 $\\binom{3}{2}=3$。容易证明没有比其更优的答案。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2019 Final] 领地 / Terytoria", "background": "译自 PA 2019 Final。$\\texttt{3s,512M}$。\n\n本题数据为自造。\n\nstd：zimpha，validator：Starrykiller，generator：KanameMadoka。", "description": "一个长为 $X$ 宽为 $Y$ 的矩形被分为 $X\\times Y$ 个方格。我们记第 $i$ 行第 $j$ 列的方格为 $(i,j)$。\n\n有 $n$ 种动物。第 $i$ 种动物**不喜欢**待在以 $(x_i,y_i)$ 和 $(x_i',y_i')$ 为对角顶点确定的矩形内。我们保证这个矩形**严格包含于** $X\\times Y$ 的矩形。\n\n第 $i$ 种动物有 $c_i$ 只。那么，一共有 $S=c_1+c_2+\\cdots+c_n$ 只动物。\n\n现在要将每只动物放在一个方格里面。**一个方格里面可以放多只动物，但是一只动物不能待在它不喜欢的区域**。\n\n记 $(i,j)$ 内有 $p_{i,j}$ 只动物，那么这种分配方式的得分为 $\\displaystyle \\sum_{1\\le i\\le X}\\sum_{1\\le j\\le Y} {p_{i,j}\\choose 2}$。这里，$\\displaystyle {a\\choose 2}=\\frac{a(a-1)}{2}$。\n\n找到合法的分配方式中得分最大的那个分配方式。只需要输出最大的得分。\n\n\n", "inputFormat": "第一行，三个正整数 $n,X,Y$。\n\n接下来 $n$ 行，每行五个正整数 $x_i,y_i,x'_i,y'_i,c_i$。", "outputFormat": "输出一行一个正整数，表示答案。", "hint": "- $1\\le n\\le 10^5$；\n- $1\\le X,Y\\le 10^3$；\n- $\\textcolor{red}{1\\le x_i\\le x'_i\\le X},\\textcolor{red}{1\\le y_i\\le y'_i\\le Y}$；\n- 以下条件中，**至少有一个**成立：${x_i\\neq 1},{y_i\\neq 1},{x'_i\\neq X},{y'_i\\neq Y}$；\n- $1\\le c_i\\le 10^3$。\n\n样例解释：\n\n对于第一个样例，只能把第一种动物全部放在 $(1,2)$，第二种动物全部放在 $(1,1)$，得分为 $\\binom{4}{2}+\\binom{3}{2}=9$。\n\n对于第二个样例，最优方案为把三种动物都全部放在 $(4,1)$，得分为 $\\binom{3}{2}=3$。容易证明没有比其更优的答案。\n\n", "locale": "zh-CN"}}}
{"pid": "P11816", "type": "P", "difficulty": 6, "samples": [["2\n2 3 4\n2 0 0 1\n0 0 1 0\n1 0 0 0\n\n0 1 0 0\n1 0 0 0\n0 0 0 0\n\n0 0 1 0\n0 1 0 0\n0 0 0 0\n\n1 0 0 0\n0 0 0 0\n0 0 0 4\n2 2 2\n2 2\n2 1\n\n2 1\n1 1\n\n1 1\n1 2\n\n1 2\n2 2", "NIE\nTAK"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2019", "图论建模", "PA（波兰）", "最大流最小割定理"], "title": "[PA 2019 Final] 摆棋 / Pionki", "background": "译自 PA 2019 Final。\n\n\n本题数据为自造。\n\nstd：zimpha，validator：Starrykiller，generator：Wuyanru & Starrykiller。", "description": "给定一个 $A\\times B\\times C$ 的立体棋盘。每个格子可以用三元组 $(i,j,k)$ 描述，其中 $1\\le i\\le A$，$1\\le j\\le B$，$1\\le k\\le C$。\n\n起初，$(i,j,k)$ 上有 $a_{i,j,k}$ 个棋子。\n\n每次操作，可以选择一个格子 $(i,j,k)$，满足 $(i,j,k)$ 上至少有一个棋子，然后将这枚棋子移动到 $(i+1,j,k)$ 或 $(i,j+1,k)$ 或 $(i,j,k+1)$ 中的一个。棋子不能移出棋盘边界。\n\n目标是让 $(i,j,k)$ 上有 $b_{i,j,k}$ 个棋子。判断是否能够达成目标。\n\n\n", "inputFormat": "**本题单个测试点内有多组测试数据。**\n\n第一行，一个正整数 $T$，表示测试数据组数。接下来依次描述 $T$ 组数据。\n\n每组数据第一行，三个正整数 $A,B,C$。\n\n接下来 $A$ 块，每块包含 $B$ 行，每行 $C$ 个非负整数。第 $i$ 块第 $j$ 行第 $k$ 个数即为 $a_{i,j,k}$。\n\n\n接下来 $A$ 块，每块包含 $B$ 行，每行 $C$ 个非负整数。第 $i$ 块第 $j$ 行第 $k$ 个数即为 $b_{i,j,k}$。\n\n对于这 $2A$ 块，每两个块之间由一个空行隔开（所以每组测试数据有 $(2A-1)$ 行空行）。", "outputFormat": "对于每组测试数据输出一行：\n\n如果可以达成目标，输出 $\\texttt{TAK}$；否则输出 $\\texttt{NIE}$。", "hint": "- $1\\le T\\le 10^4$；\n- $1\\le A,\\sum A\\le 10^4$；\n- $1\\le B,C\\le 6$；\n- $0\\le a_{i,j,k},b_{i,j,k}\\le 10^{12}$；\n- $\\sum a_{i,j,k}=\\sum b_{i,j,k}$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2019 Final] 摆棋 / Pionki", "background": "译自 PA 2019 Final。\n\n\n本题数据为自造。\n\nstd：zimpha，validator：Starrykiller，generator：Wuyanru & Starrykiller。", "description": "给定一个 $A\\times B\\times C$ 的立体棋盘。每个格子可以用三元组 $(i,j,k)$ 描述，其中 $1\\le i\\le A$，$1\\le j\\le B$，$1\\le k\\le C$。\n\n起初，$(i,j,k)$ 上有 $a_{i,j,k}$ 个棋子。\n\n每次操作，可以选择一个格子 $(i,j,k)$，满足 $(i,j,k)$ 上至少有一个棋子，然后将这枚棋子移动到 $(i+1,j,k)$ 或 $(i,j+1,k)$ 或 $(i,j,k+1)$ 中的一个。棋子不能移出棋盘边界。\n\n目标是让 $(i,j,k)$ 上有 $b_{i,j,k}$ 个棋子。判断是否能够达成目标。\n\n\n", "inputFormat": "**本题单个测试点内有多组测试数据。**\n\n第一行，一个正整数 $T$，表示测试数据组数。接下来依次描述 $T$ 组数据。\n\n每组数据第一行，三个正整数 $A,B,C$。\n\n接下来 $A$ 块，每块包含 $B$ 行，每行 $C$ 个非负整数。第 $i$ 块第 $j$ 行第 $k$ 个数即为 $a_{i,j,k}$。\n\n\n接下来 $A$ 块，每块包含 $B$ 行，每行 $C$ 个非负整数。第 $i$ 块第 $j$ 行第 $k$ 个数即为 $b_{i,j,k}$。\n\n对于这 $2A$ 块，每两个块之间由一个空行隔开（所以每组测试数据有 $(2A-1)$ 行空行）。", "outputFormat": "对于每组测试数据输出一行：\n\n如果可以达成目标，输出 $\\texttt{TAK}$；否则输出 $\\texttt{NIE}$。", "hint": "- $1\\le T\\le 10^4$；\n- $1\\le A,\\sum A\\le 10^4$；\n- $1\\le B,C\\le 6$；\n- $0\\le a_{i,j,k},b_{i,j,k}\\le 10^{12}$；\n- $\\sum a_{i,j,k}=\\sum b_{i,j,k}$。\n\n", "locale": "zh-CN"}}}
{"pid": "P11817", "type": "P", "difficulty": 6, "samples": [["4 1000000007", "9"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["递推", "2019", "组合数学", "容斥原理", "生成函数", "高斯消元", "PA（波兰）"], "title": "[PA 2019 Final] 数图 / Grafy", "background": "译自 PA 2019 Final。$\\texttt{5s,256M}$。\n\n\n本题数据为自造。\n\nstd: joke3579，validator & generator: Starrykiller。\n\n加强版：P11821。**请勿提交 OEIS 题解。**", "description": "求出 $n$ 个节点的满足以下条件的**有标号有向简单图**的数量：\n\n- $\\forall 1\\le i\\le n$，$\\operatorname{deg_{out}}(i)=\\operatorname{deg_{in}}(i)=2$。\n\n这里，$\\operatorname{deg_{out}}(u)$ 指节点 $u$ 的出度，$\\operatorname{deg_{in}}(u)$ 指节点 $u$ 的入度。\n\n你只需要输出答案对给定大素数 $p$ 取模后的结果。\n\n\n注意我们是对**有标号**的「有向简单图」计数。也就是说，这张图中无重边自环。注意 $u\\to v$ 和 $v\\to u$ 同时出现是允许的。\n\n\n", "inputFormat": "一行两个正整数 $n,p$。", "outputFormat": "一行一个非负整数，表示答案。", "hint": "- $3\\le n\\le 500$；\n- $10^8+7\\le p\\le 10^9+7$，$p$ 为素数。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2019 Final] 数图 / Grafy", "background": "译自 PA 2019 Final。$\\texttt{5s,256M}$。\n\n\n本题数据为自造。\n\nstd: joke3579，validator & generator: Starrykiller。\n\n加强版：P11821。**请勿提交 OEIS 题解。**", "description": "求出 $n$ 个节点的满足以下条件的**有标号有向简单图**的数量：\n\n- $\\forall 1\\le i\\le n$，$\\operatorname{deg_{out}}(i)=\\operatorname{deg_{in}}(i)=2$。\n\n这里，$\\operatorname{deg_{out}}(u)$ 指节点 $u$ 的出度，$\\operatorname{deg_{in}}(u)$ 指节点 $u$ 的入度。\n\n你只需要输出答案对给定大素数 $p$ 取模后的结果。\n\n\n注意我们是对**有标号**的「有向简单图」计数。也就是说，这张图中无重边自环。注意 $u\\to v$ 和 $v\\to u$ 同时出现是允许的。\n\n\n", "inputFormat": "一行两个正整数 $n,p$。", "outputFormat": "一行一个非负整数，表示答案。", "hint": "- $3\\le n\\le 500$；\n- $10^8+7\\le p\\le 10^9+7$，$p$ 为素数。\n\n", "locale": "zh-CN"}}}
{"pid": "P11818", "type": "P", "difficulty": 5, "samples": [["1\n5\n\n1\n\n2\n\n3", "\n\n? 1 4\n\n? 1 0\n\n? 2 3\n\n! 3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "交互题", "Special Judge", "最大公约数 gcd", "Ad-hoc", "PA（波兰）"], "title": "[PA 2019 Final] 一安在？ / Gdzie jest jedynka? 2", "background": "**请使用 C++14 或者更高的版本提交，否则不保证可以编译成功。**\n\n\n\n本题数据为自造。交互库疑似有点弱，欢迎加强。\n\n- std: KanameMadoka & Wuyanru；\n- interactor：KanameMadoka & Starrykiller；\n- validator & generator：Starrykiller；\n- special thanks to FFTotoro。\n\n**本题 $\\texttt{\\#2}\\sim\\texttt{\\#7}$ 为长度为 $3\\sim 8$ 的全排列，在这几个测试点中交互库是不自适应的。**\n", "description": "**这是一道交互题。** 本题中，**交互库是自适应的**。\n\n有一个**隐藏的** $0\\sim n-1$ 的排列 $p_0,p_1,\\cdots,p_{n-1}$。\n\n你可以询问至多 $\\lceil\\frac{5n}{2}\\rceil$ 次：每次询问给定 $i,j$（$i\\neq j$），交互库会返回 $\\gcd(p_{i},p_j)$ 的值。特别地，定义 $\\gcd(0,a)=\\gcd(a,0)=a$。\n\n找到这个排列中 $1$ 的位置。也就是，找到 $j$，使得 $p_j=1$。\n\n### 实现细节\n\n**本题单个测试点内有多组测试数据。**\n\n\n你不需要，也不应该实现 `main` 函数。\n\n你需要在文件头加入以下内容：\n\n```cpp\nint ask(int, int);\n```\n\n你应该实现以下的函数：\n\n- `int solve(int n)`：处理一组排列长度为 $n$ 的数据。\n    - 返回一个非负整数 $j$ 满足 $p_j=1$。你需要保证 $0\\le j\\lt n$，且 $p_j=1$。\n\n实际测评时将会多次调用 `solve` 函数。\n\n你可以调用以下的函数：\n\n- `int ask(int i, int j)`：询问 $\\gcd(p_i,p_j)$。\n\t- 你需要保证 $0\\le i,j\\lt n$，且 $i\\neq j$。\n\n需要注意的是，**交互库是自适应的**，也就是，交互库会根据你的询问（在不矛盾的前提下）动态调整答案。\n", "inputFormat": "见【实现细节】。\n", "outputFormat": "见【实现细节】。\n", "hint": "\n\n### 样例交互\n\n设原序列为 $[4,2,0,3,1]$。\n\n| 交互库 | 选手程序 |\n| :--: | :--: |\n| 调用 $\\operatorname{solve}(5)$ | |\n| 返回 $\\gcd(p_1,p_4)=1$ | 调用 $\\operatorname{ask}(1,4)$ |\n| 返回 $\\gcd(p_1,p_0)=2$ | 调用 $\\operatorname{ask}(1,0)$ |\n| 返回 $\\gcd(p_2,p_3)=3$ | 调用 $\\operatorname{ask}(2,3)$ |\n| $p_4=1$，判定为 Accepted | 返回 $4$ |\n\n需要注意的是，**样例交互仅为交互格式示意，不代表根据这些信息能唯一确定答案。** 交互库是自适应的。\n\n---\n\n### 数据范围\n\n- $3\\le n,\\sum n\\le 5\\times 10^5$。\n\n再次提醒，**交互库是自适应的**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2019 Final] 一安在？ / Gdzie jest jedynka? 2", "background": "**请使用 C++14 或者更高的版本提交，否则不保证可以编译成功。**\n\n\n\n本题数据为自造。交互库疑似有点弱，欢迎加强。\n\n- std: KanameMadoka & Wuyanru；\n- interactor：KanameMadoka & Starrykiller；\n- validator & generator：Starrykiller；\n- special thanks to FFTotoro。\n\n**本题 $\\texttt{\\#2}\\sim\\texttt{\\#7}$ 为长度为 $3\\sim 8$ 的全排列，在这几个测试点中交互库是不自适应的。**\n", "description": "**这是一道交互题。** 本题中，**交互库是自适应的**。\n\n有一个**隐藏的** $0\\sim n-1$ 的排列 $p_0,p_1,\\cdots,p_{n-1}$。\n\n你可以询问至多 $\\lceil\\frac{5n}{2}\\rceil$ 次：每次询问给定 $i,j$（$i\\neq j$），交互库会返回 $\\gcd(p_{i},p_j)$ 的值。特别地，定义 $\\gcd(0,a)=\\gcd(a,0)=a$。\n\n找到这个排列中 $1$ 的位置。也就是，找到 $j$，使得 $p_j=1$。\n\n### 实现细节\n\n**本题单个测试点内有多组测试数据。**\n\n\n你不需要，也不应该实现 `main` 函数。\n\n你需要在文件头加入以下内容：\n\n```cpp\nint ask(int, int);\n```\n\n你应该实现以下的函数：\n\n- `int solve(int n)`：处理一组排列长度为 $n$ 的数据。\n    - 返回一个非负整数 $j$ 满足 $p_j=1$。你需要保证 $0\\le j\\lt n$，且 $p_j=1$。\n\n实际测评时将会多次调用 `solve` 函数。\n\n你可以调用以下的函数：\n\n- `int ask(int i, int j)`：询问 $\\gcd(p_i,p_j)$。\n\t- 你需要保证 $0\\le i,j\\lt n$，且 $i\\neq j$。\n\n需要注意的是，**交互库是自适应的**，也就是，交互库会根据你的询问（在不矛盾的前提下）动态调整答案。\n", "inputFormat": "见【实现细节】。\n", "outputFormat": "见【实现细节】。\n", "hint": "\n\n### 样例交互\n\n设原序列为 $[4,2,0,3,1]$。\n\n| 交互库 | 选手程序 |\n| :--: | :--: |\n| 调用 $\\operatorname{solve}(5)$ | |\n| 返回 $\\gcd(p_1,p_4)=1$ | 调用 $\\operatorname{ask}(1,4)$ |\n| 返回 $\\gcd(p_1,p_0)=2$ | 调用 $\\operatorname{ask}(1,0)$ |\n| 返回 $\\gcd(p_2,p_3)=3$ | 调用 $\\operatorname{ask}(2,3)$ |\n| $p_4=1$，判定为 Accepted | 返回 $4$ |\n\n需要注意的是，**样例交互仅为交互格式示意，不代表根据这些信息能唯一确定答案。** 交互库是自适应的。\n\n---\n\n### 数据范围\n\n- $3\\le n,\\sum n\\le 5\\times 10^5$。\n\n再次提醒，**交互库是自适应的**。", "locale": "zh-CN"}}}
{"pid": "P11819", "type": "P", "difficulty": 6, "samples": [["4 5\n2 3 4\n3 4 3\n4 2 2\n1 3 1\n1 2 9", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "最短路", "PA（波兰）", "bitset"], "title": "[PA 2019 Final] Floyd-Warshall", "background": "译自 PA 2019 Final。\n\n\n本题数据为自造。\n\nstd: zimpha，validator: Starrykiller，generator：KanameMadoka&Starrykiller。Special Thanks to @N_z_。", "description": "\n\n有一个 $n$ 个节点的简单有向带权图。Radewoosh 想要求出这张图的全源最短路。他决定写个 Floyd-Warshall：\n\n$$\n\\def\\arraystretch{1.2}\n    \\begin{array}{ll}\n    \\hline\n    \\textbf{算法 1} & \\text{\\textbf{正确的} Floyd-Warshall 算法} \\\\\n    \\hline\n    1&\\textbf{Require: } n\\times n \\text{ 的矩阵 }M，满足：\\\\\n    & M_{i,j}=\\begin{cases}\n                  0, & \\text{当 } i=j \\\\\n                  w_{i,j}, & \\text{当存在一条 } u\\to v \\text{ 的有向边，边权为 } w_{i,j} \\\\\n                  \\infty, & \\text{其他情况}\n               \\end{cases}\n    \\\\\n    2&\\ \\textbf{for } x=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    3&\\ \\qquad\\textbf{for } y=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    4&\\ \\qquad\\qquad\\textbf{for } z=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    5&\\ \\qquad\\qquad\\qquad M_{y,z}\\gets \\min(M_{y,z},M_{y,x}+M_{x,z}) \\\\\n    \\hline\n    \\end{array} \n$$\n\n然而他搞错了循环顺序，于是代码变成了这样：\n\n$$\n\\def\\arraystretch{1.2}\n    \\begin{array}{ll}\n    \\hline\n    \\textbf{算法 2} & \\text{\\textbf{不正确的} Floyd-Warshall 算法} \\\\\n    \\hline\n    1&\\textbf{Require: } n\\times n \\text{ 的矩阵 }M，满足：\\\\\n    & M_{i,j}=\\begin{cases}\n                  0, & \\text{当 } i=j \\\\\n                  w_{i,j}, & \\text{当存在一条 } u\\to v \\text{ 的有向边，边权为 } w_{i,j} \\\\\n                  \\infty, & \\text{其他情况}\n               \\end{cases}\n    \\\\\n    2&\\ \\textbf{for } y=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    3&\\ \\qquad\\textbf{for } z=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    4&\\ \\qquad\\qquad\\textbf{for } x=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    5&\\ \\qquad\\qquad\\qquad M_{y,z}\\gets \\min(M_{y,z},M_{y,x}+M_{x,z}) \\\\\n    \\hline\n    \\end{array} \n$$\n\n令这张图中，$x\\to y$ 正确的距离为 $\\operatorname{dist}(x,y)$，Radewoosh 求出的为 $\\operatorname{dist}'(x,y)$。\n\n求出满足 $\\operatorname{dist}(x,y)\\neq \\operatorname{dist}'(x,y)$ 的 $(x,y)$ 对数。\n\n\n", "inputFormat": "第一行，两个正整数 $n,m$。\n\n接下来 $m$ 行，每行三个正整数 $u,v,w$，表示一条边权为 $w$ 的 $u\\to v$ 的有向边。", "outputFormat": "输出一行一个非负整数，表示答案。\n", "hint": "- $2\\le n\\le 2\\times 10^3$；\n- $1\\le m\\le 3\\times 10^3$；\n- $1\\le u,v\\le n$，$u\\neq v$；\n- $1\\le w\\le 10^5$；\n- 给定的图是简单图（无重边自环）。\n\n样例解释：\n\n以下左边的矩阵是正确的 $\\operatorname{dist}$ 矩阵，右边是错误的 $\\operatorname{dist'}$ 矩阵。\n\n$$\\begin{bmatrix}0&6&1&4\\\\\\infin&0&4&7\\\\\\infin&5&0&3\\\\\\infin&2&6&0\\end{bmatrix}\\qquad\\begin{bmatrix}0&9&1&4\\\\\\infin&0&4&7\\\\\\infin&5&0&3\\\\\\infin&2&6&0\\end{bmatrix}$$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2019 Final] Floyd-Warshall", "background": "译自 PA 2019 Final。\n\n\n本题数据为自造。\n\nstd: zimpha，validator: Starrykiller，generator：KanameMadoka&Starrykiller。Special Thanks to @N_z_。", "description": "\n\n有一个 $n$ 个节点的简单有向带权图。Radewoosh 想要求出这张图的全源最短路。他决定写个 Floyd-Warshall：\n\n$$\n\\def\\arraystretch{1.2}\n    \\begin{array}{ll}\n    \\hline\n    \\textbf{算法 1} & \\text{\\textbf{正确的} Floyd-Warshall 算法} \\\\\n    \\hline\n    1&\\textbf{Require: } n\\times n \\text{ 的矩阵 }M，满足：\\\\\n    & M_{i,j}=\\begin{cases}\n                  0, & \\text{当 } i=j \\\\\n                  w_{i,j}, & \\text{当存在一条 } u\\to v \\text{ 的有向边，边权为 } w_{i,j} \\\\\n                  \\infty, & \\text{其他情况}\n               \\end{cases}\n    \\\\\n    2&\\ \\textbf{for } x=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    3&\\ \\qquad\\textbf{for } y=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    4&\\ \\qquad\\qquad\\textbf{for } z=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    5&\\ \\qquad\\qquad\\qquad M_{y,z}\\gets \\min(M_{y,z},M_{y,x}+M_{x,z}) \\\\\n    \\hline\n    \\end{array} \n$$\n\n然而他搞错了循环顺序，于是代码变成了这样：\n\n$$\n\\def\\arraystretch{1.2}\n    \\begin{array}{ll}\n    \\hline\n    \\textbf{算法 2} & \\text{\\textbf{不正确的} Floyd-Warshall 算法} \\\\\n    \\hline\n    1&\\textbf{Require: } n\\times n \\text{ 的矩阵 }M，满足：\\\\\n    & M_{i,j}=\\begin{cases}\n                  0, & \\text{当 } i=j \\\\\n                  w_{i,j}, & \\text{当存在一条 } u\\to v \\text{ 的有向边，边权为 } w_{i,j} \\\\\n                  \\infty, & \\text{其他情况}\n               \\end{cases}\n    \\\\\n    2&\\ \\textbf{for } y=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    3&\\ \\qquad\\textbf{for } z=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    4&\\ \\qquad\\qquad\\textbf{for } x=1,2,3,\\ldots,n \\textbf{ do} \\\\\n    5&\\ \\qquad\\qquad\\qquad M_{y,z}\\gets \\min(M_{y,z},M_{y,x}+M_{x,z}) \\\\\n    \\hline\n    \\end{array} \n$$\n\n令这张图中，$x\\to y$ 正确的距离为 $\\operatorname{dist}(x,y)$，Radewoosh 求出的为 $\\operatorname{dist}'(x,y)$。\n\n求出满足 $\\operatorname{dist}(x,y)\\neq \\operatorname{dist}'(x,y)$ 的 $(x,y)$ 对数。\n\n\n", "inputFormat": "第一行，两个正整数 $n,m$。\n\n接下来 $m$ 行，每行三个正整数 $u,v,w$，表示一条边权为 $w$ 的 $u\\to v$ 的有向边。", "outputFormat": "输出一行一个非负整数，表示答案。\n", "hint": "- $2\\le n\\le 2\\times 10^3$；\n- $1\\le m\\le 3\\times 10^3$；\n- $1\\le u,v\\le n$，$u\\neq v$；\n- $1\\le w\\le 10^5$；\n- 给定的图是简单图（无重边自环）。\n\n样例解释：\n\n以下左边的矩阵是正确的 $\\operatorname{dist}$ 矩阵，右边是错误的 $\\operatorname{dist'}$ 矩阵。\n\n$$\\begin{bmatrix}0&6&1&4\\\\\\infin&0&4&7\\\\\\infin&5&0&3\\\\\\infin&2&6&0\\end{bmatrix}\\qquad\\begin{bmatrix}0&9&1&4\\\\\\infin&0&4&7\\\\\\infin&5&0&3\\\\\\infin&2&6&0\\end{bmatrix}$$", "locale": "zh-CN"}}}
{"pid": "P11820", "type": "P", "difficulty": 6, "samples": [["4 2\n1 3 1\n1 1 1\n1 3 2\n3 3 2", "2\n3\n1\n1\n3"], ["3 1\n1 2 1\n1 2 1\n1 2 1", "NIE"]], "limits": {"time": [8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100, 8100], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2015", "线段树", "Special Judge", "O2优化", "PA（波兰）"], "title": "[PA 2015] 健身房 / Siłownia", "background": "\n译自 [PA 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R5.\n", "description": "健身房里有 $k$ 个器材。\n\n有 $n$ 个人预约了健身。第 $i$ 个人预约给定了 $l_i,r_i,p_i$，意思是要分配给他 $l_i,l_{i}+1,\\cdots,r_i$ 中的一个（记为 $x$），他在第 $x$ 个小时中用器材 $p_i$ 健身。\n\n同一时间不能有两个人用同一个健身器材。此外，老板还希望让健身房里没人的时刻尽量多，这样可以节约电费。\n\n构造一组最优解。\n", "inputFormat": "第一行，两个正整数 $n,k$。\n\n接下来 $n$ 行，第 $i$ 行三个正整数 $l_i,r_i,p_i$。", "outputFormat": "如果无解，输出一行一个 $\\texttt{NIE}$。\n\n否则输出 $(n+1)$ 行：第一行一个整数，表示在最优策略下，有多少个时刻健身房至少有一个人。接下来 $n$ 行，第 $i$ 行的整数表示第 $i$ 个人分配的 $x$。", "hint": "- $1\\le n\\le 10^6$；\n- $1\\le k\\le 10^9$；\n- $1\\le l_i\\le r_i\\le 10^9$；\n- $1\\le p_i\\le k$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] 健身房 / Siłownia", "background": "\n译自 [PA 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R5.\n", "description": "健身房里有 $k$ 个器材。\n\n有 $n$ 个人预约了健身。第 $i$ 个人预约给定了 $l_i,r_i,p_i$，意思是要分配给他 $l_i,l_{i}+1,\\cdots,r_i$ 中的一个（记为 $x$），他在第 $x$ 个小时中用器材 $p_i$ 健身。\n\n同一时间不能有两个人用同一个健身器材。此外，老板还希望让健身房里没人的时刻尽量多，这样可以节约电费。\n\n构造一组最优解。\n", "inputFormat": "第一行，两个正整数 $n,k$。\n\n接下来 $n$ 行，第 $i$ 行三个正整数 $l_i,r_i,p_i$。", "outputFormat": "如果无解，输出一行一个 $\\texttt{NIE}$。\n\n否则输出 $(n+1)$ 行：第一行一个整数，表示在最优策略下，有多少个时刻健身房至少有一个人。接下来 $n$ 行，第 $i$ 行的整数表示第 $i$ 个人分配的 $x$。", "hint": "- $1\\le n\\le 10^6$；\n- $1\\le k\\le 10^9$；\n- $1\\le l_i\\le r_i\\le 10^9$；\n- $1\\le p_i\\le k$。", "locale": "zh-CN"}}}
