{"pid": "P6649", "type": "P", "difficulty": 4, "samples": [["3 3\n-1 -3 2\n5 -1 -6\n-3 7 -6", "-17"], ["3 3\n1 2 3\n4 5 -6\n-7 8 9", "-2"], ["4 4\n-1 2 -3 3\n-7 -8 -9 -10\n-7 20 -3 15\n-8 7 0 -1", "-32"], ["17 17\n536854 594409 871941 -388369 465282 -638502 -121382 -481711 -648747 583148 -407200 -756103 225750 685372 -952316 -115958 688880\n-248927 927601 -41187 -729045 -902796 -714842 537911 -972691 646275 -968170 811593 -288461 -492905 954416 455549 839671 927565\n317945 317920 -182592 -477 239886 747388 -323625 132984 -147642 637483 948110 750134 450272 -689049 862925 -327794 5865\n196810 600825 -547716 873435 -389664 882011 -708186 504812 955352 -657431 -963785 -899423 671938 -770932 -428505 204660 -235382\n592361 -686010 805643 -168792 871936 -334335 402655 783215 -315411 480760 371553 -87790 -111152 142452 918172 968088 364749\n200836 914812 962142 -276470 757612 -369974 955746 -740349 -218873 976129 94337 -853562 69100 -479860 865764 -865684 -782689\n-977548 -226536 197351 516125 137800 -391378 -392070 -954935 -399763 284345 -752733 195962 268045 800832 916405 578799 782717\n-111876 -384522 785558 -663839 -346670 317823 -902413 -138975 794147 -377010 -370134 925156 333264 -827840 859848 773995 -335011\n495949 -158831 446359 962836 -861756 936842 533809 -58318 -462176 561405 -127056 -497496 -636673 -312588 -354065 -489258 926614\n603167 -154853 601062 951736 758952 -290610 838384 -455373 -823858 293098 782955 -711867 739231 -835281 -940599 938774 389756\n-762794 -788479 -122327 -608246 998569 -70814 -198006 -361373 658973 -811815 -26348 240052 251877 -660298 -390790 558411 -90995\n213545 492431 847902 -681087 -721770 -482897 -577178 -400679 712628 -943805 -613025 927604 867612 -753902 -235086 -60571 445511\n901422 -769346 -655924 638444 188703 964292 865767 -298677 -245870 643123 -87216 -18374 -115040 -954311 -220506 919822 -183816\n-576494 -481376 139875 360147 411997 437956 755645 874372 130352 -770235 -708813 850918 -835413 -426540 62763 722776 767682\n-237305 -121638 -273740 518922 -423961 690214 -253799 571892 915095 586784 670083 -764317 14014 -103481 -750401 325979 70672\n323842 988625 859616 920791 -749116 -660548 302396 408853 -944605 732263 -38368 223609 -484449 712951 831842 -200066 -965163\n-659884 172567 -482821 -666287 42438 -113937 -539200 -57775 -558423 116068 532754 -440321 456398 -216316 293270 771477 583186\n", "-28761600"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "O2优化"], "title": "「SWTR-5」Grid", "background": "**赛时提醒：格子可以重复经过，但分数只算一次。**", "description": "小 A 有一个 $n\\times m$ 的网格，每个格子上都写着一个数字。为方便描述，令左上角的网格为 $(1,1)$，右下角的网格为 $(n,m)$。\n\n小 A 可以进入最下方第 $n$ 行的任意一个网格，并按照以下规则进行游戏：\n\n- 设小 A **第一次进入第 $i$ 行**的位置为 $(i,r_i)$：  \n如果小 A 在 $(i,r_i)$，则他只能向左或向上跳。否则他可以向左，向右或向上跳。\n- 小 A 不能跳出网格，除非他在第 $1$ 行，这代表结束整场游戏。\n\n定义一局游戏的得分为所有小 A 经过的格子上的数字之和。小 A 想请你帮他求出得分的最小值。", "inputFormat": "第一行两个整数 $n,m$，分别表示网格的行数和列数。\n\n第二至 $n+1$ 行每行 $m$ 个整数 $a_{i,j}$，表示 $(i,j)$ 上的数。", "outputFormat": "一行一个整数，表示最小值。", "hint": "「样例说明」\n\n样例 $1$ 的解释如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1l4pl5s2.png)\n\n「数据范围与约定」\n\n**本题采用捆绑测试。**\n\n- Subtask 1（3 points）：$a_{i,j}\\leq 0$。\n- Subtask 2（12 points）：$n,m\\leq 5$。\n- Subtask 3（15 points）：$n=2$。\n- Subtask 4（18 points）：$n,m\\leq 90$。\n- Subtask 5（22 points）：$n,m\\leq 400$。\n- Subtask 6（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$1\\leq n,m\\leq 10^3$，$-10^6 \\leq a_{i,j}\\leq 10^6$。\n\n---\n\n「题目来源」\n\n[Sweet Round 05](https://www.luogu.com.cn/contest/28195) A。  \nidea & solution：[Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-5」Grid", "background": "**赛时提醒：格子可以重复经过，但分数只算一次。**", "description": "小 A 有一个 $n\\times m$ 的网格，每个格子上都写着一个数字。为方便描述，令左上角的网格为 $(1,1)$，右下角的网格为 $(n,m)$。\n\n小 A 可以进入最下方第 $n$ 行的任意一个网格，并按照以下规则进行游戏：\n\n- 设小 A **第一次进入第 $i$ 行**的位置为 $(i,r_i)$：  \n如果小 A 在 $(i,r_i)$，则他只能向左或向上跳。否则他可以向左，向右或向上跳。\n- 小 A 不能跳出网格，除非他在第 $1$ 行，这代表结束整场游戏。\n\n定义一局游戏的得分为所有小 A 经过的格子上的数字之和。小 A 想请你帮他求出得分的最小值。", "inputFormat": "第一行两个整数 $n,m$，分别表示网格的行数和列数。\n\n第二至 $n+1$ 行每行 $m$ 个整数 $a_{i,j}$，表示 $(i,j)$ 上的数。", "outputFormat": "一行一个整数，表示最小值。", "hint": "「样例说明」\n\n样例 $1$ 的解释如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1l4pl5s2.png)\n\n「数据范围与约定」\n\n**本题采用捆绑测试。**\n\n- Subtask 1（3 points）：$a_{i,j}\\leq 0$。\n- Subtask 2（12 points）：$n,m\\leq 5$。\n- Subtask 3（15 points）：$n=2$。\n- Subtask 4（18 points）：$n,m\\leq 90$。\n- Subtask 5（22 points）：$n,m\\leq 400$。\n- Subtask 6（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$1\\leq n,m\\leq 10^3$，$-10^6 \\leq a_{i,j}\\leq 10^6$。\n\n---\n\n「题目来源」\n\n[Sweet Round 05](https://www.luogu.com.cn/contest/28195) A。  \nidea & solution：[Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN"}}}
{"pid": "P6650", "type": "P", "difficulty": 4, "samples": [["4 2\n6 4 2 3", "7"], ["5 3\n8 6 9 6 4", "13"], ["17 17\n29 38 9 10 16 5 1 10 27 20 11 9 15 11 2 3 10 \n", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化"], "title": "「SWTR-5」Sequence", "background": "", "description": "小 A 有一个长度为 $n$ 的序列 $a_1,a_2,\\cdots,a_n$。他可以选择一个区间 $[l,r]$ 满足其最大值与最小值的差不超过 $k$。\n\n他还需找出 $m$ 个**互不相同的整数** $p_1,p_2,\\cdots,p_m$，满足：\n\n- $m$ 为正整数。\n- $\\prod\\limits_{i=l}^ra_i=\\prod\\limits_{i=1}^mp_i$。即选择区间的乘积等于这 $m$ 个数的乘积。\n- $p_i$ 为一个质数的正整数次幂。\n\n这 $m$ 个数的约数个数之和就是小 A 的得分。帮他求出得分的最大值。", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$ 表示这个序列。", "outputFormat": "一行一个整数表示答案。", "hint": "「样例说明」\n\n样例 $1$：选择区间 $[1,2]$，再选择 $p_1=2$，$p_2=3$，$p_3=4$，可以达到最大值 $7$，方案不唯一。\n\n样例 $2$：选择区间 $[1,4]$，再选择 $p_1=4$，$p_2=8$，$p_3=3$，$p_4=27$，可以达到最大值 $13$。\n\n「数据范围与约定」\n\n**本题采用捆绑测试**。\n\n- Subtask 1（1 points）：$n=1$ 且 $a_1$ 为质数。\n- Subtask 2（9 points）：$n=1$。\n- Subtask 3（20 points）：$n\\leq 10$，$a_i \\leq 20$。\n- Subtask 4（13 points）：$n\\leq 200$，$a_i \\leq 200$。\n- Subtask 5（17 points）：$n\\leq 2\\times 10^3$。\n- Subtask 6（15 points）：$a_i$ 为质数。\n- Subtask 7（25 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$1 \\leq n \\leq 10^5$，$2 \\leq a_i \\leq 10^5$，$0 \\leq k \\leq 10^5$。\n\n---\n\n「题目来源」\n\n[Sweet Round 05](https://www.luogu.com.cn/contest/28195) B。    \nidea & solution：[ET2006](https://www.luogu.com.cn/user/115194)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-5」Sequence", "background": "", "description": "小 A 有一个长度为 $n$ 的序列 $a_1,a_2,\\cdots,a_n$。他可以选择一个区间 $[l,r]$ 满足其最大值与最小值的差不超过 $k$。\n\n他还需找出 $m$ 个**互不相同的整数** $p_1,p_2,\\cdots,p_m$，满足：\n\n- $m$ 为正整数。\n- $\\prod\\limits_{i=l}^ra_i=\\prod\\limits_{i=1}^mp_i$。即选择区间的乘积等于这 $m$ 个数的乘积。\n- $p_i$ 为一个质数的正整数次幂。\n\n这 $m$ 个数的约数个数之和就是小 A 的得分。帮他求出得分的最大值。", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$ 表示这个序列。", "outputFormat": "一行一个整数表示答案。", "hint": "「样例说明」\n\n样例 $1$：选择区间 $[1,2]$，再选择 $p_1=2$，$p_2=3$，$p_3=4$，可以达到最大值 $7$，方案不唯一。\n\n样例 $2$：选择区间 $[1,4]$，再选择 $p_1=4$，$p_2=8$，$p_3=3$，$p_4=27$，可以达到最大值 $13$。\n\n「数据范围与约定」\n\n**本题采用捆绑测试**。\n\n- Subtask 1（1 points）：$n=1$ 且 $a_1$ 为质数。\n- Subtask 2（9 points）：$n=1$。\n- Subtask 3（20 points）：$n\\leq 10$，$a_i \\leq 20$。\n- Subtask 4（13 points）：$n\\leq 200$，$a_i \\leq 200$。\n- Subtask 5（17 points）：$n\\leq 2\\times 10^3$。\n- Subtask 6（15 points）：$a_i$ 为质数。\n- Subtask 7（25 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$1 \\leq n \\leq 10^5$，$2 \\leq a_i \\leq 10^5$，$0 \\leq k \\leq 10^5$。\n\n---\n\n「题目来源」\n\n[Sweet Round 05](https://www.luogu.com.cn/contest/28195) B。    \nidea & solution：[ET2006](https://www.luogu.com.cn/user/115194)。", "locale": "zh-CN"}}}
{"pid": "P6651", "type": "P", "difficulty": 5, "samples": [["7 14\n3 2\n4 5\n2 5\n2 6\n3 1\n3 5\n3 7\n3 6\n6 4\n1 4\n6 5\n1 6\n7 2\n7 4\n7\n3 2 4 6\n2 4 6\n2 2 5\n2 1 4\n0\n1 4\n1 6", "1\n3\n0\n6\n13\n7\n5"], ["233 1\n1 2\n6\n0\n1 10\n2 10 40\n1 1\n1 2\n2 1 2", "232\n231\n230\n231\n231\n231"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "O2优化", "拓扑排序", "容斥原理"], "title": "「SWTR-5」Chain", "background": "", "description": "给定 $n$ 个点，$m$ 条边的有向无环图。不保证图连通。\n\n$q$ 次询问，每次给出 $k$ 和 $k$ 个互不相同的数 $c_i$，求出如果去掉这 $k$ 个点，整个有向无环图将剩余多少条链。答案对 $10^9+7$ 取模。**每次询问独立。**\n\n- “链”的定义是：我们设一条长度为 $p$ 的链的路径为 $w_0\\to w_1\\to\\cdots\\to w_{p-1}\\to w_p$，则应满足 $w_0$ 入度为 $0$，$w_p$ 出度为 $0$。你可以将其理解为一条食物链。\n\n- 两条链是“不同的”，当且仅当它们的长度不同，或者经过的点集不同。\n\n- **需要特别注意的是，删去某些点后新产生的链不计入答案。** 例如 $1\\to 2\\to 3\\to 4$ 一图中，有 $1$ 条链 $1\\to 2\\to 3\\to 4$。如果去掉 $2$ 号点，则剩余 $0$ 条链。", "inputFormat": "第一行两个整数 $n,m$，分别表示点的个数和边的条数。\n\n接下来 $m$ 行，每行两个整数 $u,v(u\\neq v)$，表示 $u\\to v$ 有一条有向边。\n\n第 $m+2$ 行一个整数 $q$，表示询问个数。\n\n接下来 $q$ 行：  \n- 每行先是一个整数 $k$，表示去掉的点的个数。\n- 接下来 $k$ 个整数 $c_i$，表示去掉的点的编号。", "outputFormat": "共 $q$ 行，每行表示该次询问答案对 $10^9+7$ 取模后的值。", "hint": "「样例 $1$ 说明」\n\nDAG 如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2gbdoemh.png)\n\n询问 $1$：如果去掉 $2,4,6$，则剩余 $1$ 条链：$3\\to 5$。\n\n询问 $2$：如果去掉 $4,6$，则剩余 $3$ 条链：$3\\to 5$，$3\\to 2\\to 5$，$3\\to 7\\to 2\\to 5$。\n\n询问 $7$：如果去掉 $6$，则剩余 $5$ 条链：$3\\to 5$，$3\\to 2\\to 5$，$3\\to 7\\to 2\\to 5$，$3\\to 1\\to 4\\to 5$，$3\\to 7\\to 4\\to 5$。\n\n「数据范围与约定」\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 point）：给定的图是一条链。\n- Subtask 2（14 points）：$n,q\\leq 10$。\n- Subtask 3（20 points）：$q\\leq 10^3$。\n- Subtask 4（17 points）：$k=1$。\n- Subtask 5（18 points）：$k=2$。\n- Subtask 6（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$2\\leq n\\leq 2\\times 10^3$，$1\\leq m\\leq \\min(\\frac{n\\times(n-1)}{2},2\\times 10^4)$，$1\\leq q\\leq 5\\times 10^5$。  \n所有询问满足：$1\\leq \\sum k\\leq 2\\times 10^6$，$0\\leq k\\leq \\min(n,15)$，$1\\leq c_i\\leq n$。保证 $c_i$ 互不相同。\n\n**本题轻微卡常，请注意 IO 优化。**\n\n---\n\n「题目来源」\n\n[Sweet Round 05](https://www.luogu.com.cn/contest/28195) D。  \nidea & solution：[Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-5」Chain", "background": "", "description": "给定 $n$ 个点，$m$ 条边的有向无环图。不保证图连通。\n\n$q$ 次询问，每次给出 $k$ 和 $k$ 个互不相同的数 $c_i$，求出如果去掉这 $k$ 个点，整个有向无环图将剩余多少条链。答案对 $10^9+7$ 取模。**每次询问独立。**\n\n- “链”的定义是：我们设一条长度为 $p$ 的链的路径为 $w_0\\to w_1\\to\\cdots\\to w_{p-1}\\to w_p$，则应满足 $w_0$ 入度为 $0$，$w_p$ 出度为 $0$。你可以将其理解为一条食物链。\n\n- 两条链是“不同的”，当且仅当它们的长度不同，或者经过的点集不同。\n\n- **需要特别注意的是，删去某些点后新产生的链不计入答案。** 例如 $1\\to 2\\to 3\\to 4$ 一图中，有 $1$ 条链 $1\\to 2\\to 3\\to 4$。如果去掉 $2$ 号点，则剩余 $0$ 条链。", "inputFormat": "第一行两个整数 $n,m$，分别表示点的个数和边的条数。\n\n接下来 $m$ 行，每行两个整数 $u,v(u\\neq v)$，表示 $u\\to v$ 有一条有向边。\n\n第 $m+2$ 行一个整数 $q$，表示询问个数。\n\n接下来 $q$ 行：  \n- 每行先是一个整数 $k$，表示去掉的点的个数。\n- 接下来 $k$ 个整数 $c_i$，表示去掉的点的编号。", "outputFormat": "共 $q$ 行，每行表示该次询问答案对 $10^9+7$ 取模后的值。", "hint": "「样例 $1$ 说明」\n\nDAG 如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2gbdoemh.png)\n\n询问 $1$：如果去掉 $2,4,6$，则剩余 $1$ 条链：$3\\to 5$。\n\n询问 $2$：如果去掉 $4,6$，则剩余 $3$ 条链：$3\\to 5$，$3\\to 2\\to 5$，$3\\to 7\\to 2\\to 5$。\n\n询问 $7$：如果去掉 $6$，则剩余 $5$ 条链：$3\\to 5$，$3\\to 2\\to 5$，$3\\to 7\\to 2\\to 5$，$3\\to 1\\to 4\\to 5$，$3\\to 7\\to 4\\to 5$。\n\n「数据范围与约定」\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 point）：给定的图是一条链。\n- Subtask 2（14 points）：$n,q\\leq 10$。\n- Subtask 3（20 points）：$q\\leq 10^3$。\n- Subtask 4（17 points）：$k=1$。\n- Subtask 5（18 points）：$k=2$。\n- Subtask 6（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$2\\leq n\\leq 2\\times 10^3$，$1\\leq m\\leq \\min(\\frac{n\\times(n-1)}{2},2\\times 10^4)$，$1\\leq q\\leq 5\\times 10^5$。  \n所有询问满足：$1\\leq \\sum k\\leq 2\\times 10^6$，$0\\leq k\\leq \\min(n,15)$，$1\\leq c_i\\leq n$。保证 $c_i$ 互不相同。\n\n**本题轻微卡常，请注意 IO 优化。**\n\n---\n\n「题目来源」\n\n[Sweet Round 05](https://www.luogu.com.cn/contest/28195) D。  \nidea & solution：[Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN"}}}
{"pid": "P6652", "type": "P", "difficulty": 5, "samples": [["abbabb\nba", "3"], ["fxofoxxooffoxooo\nfox", "8"], ["abcdefghijklmnopq\nrstuvwxyzz", "-1"], ["ycxcy\ncxy", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "广度优先搜索 BFS", "哈希 hashing"], "title": "「SWTR-5」String", "background": "", "description": "小 A 有一个字符串 $t$。他可以进行以下操作：切掉 $t$ 的一个前/后缀，满足切掉的前/后缀为**切割后** $t$ 的子串。小 A 想得到字符串 $s$，请问他最少需要进行多少次操作。无解输出 $-1$。", "inputFormat": "两行字符串分别表示 $t,s$。", "outputFormat": "一行一个整数，表示答案。", "hint": "「样例说明」\n\n样例 $1$：$\\texttt{abbabb}\\to \\texttt{abba}\\to \\texttt{bba}\\to \\texttt{ba}$。方案不唯一。\n\n样例 $2$：$\\texttt{fxofoxxooffoxooo}\\to\\texttt{xofoxxooffoxooo}\\to\\texttt{foxxooffoxooo}\\to\\texttt{xooffoxooo}\\to\\texttt{ffoxooo}\\to\\texttt{ffoxoo}\\to\\texttt{ffoxo}\\to\\texttt{ffox}\\to\\texttt{fox}$。方案不唯一。\n\n「数据范围与约定」\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 points）：$s=t$。\n- Subtask 2（9 points）：$s$ 仅包含字母 $\\texttt{a}$。\n- Subtask 3（15 points）：$|t|\\leq 100$。\n- Subtask 4（17 points）：$|t|\\leq 500$。\n- Subtask 5（18 points）：$|t|\\leq 1.5\\times 10^3$。\n- Subtask 6（15 points）：$|s|=4$，*数据随机。\n- Subtask 7（25 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$1 \\leq |s| \\leq |t| \\leq 5\\times 10^3$，字符集 $\\in[\\texttt{a,z}]$。\n\n*数据随机：$s,t$ 字符均随机，字符集 $\\in[\\texttt{a,c}]$。\n\n**请注意常数优化。**\n\n---\n\n「题目来源」\n\n[Sweet Round 05](https://www.luogu.com.cn/contest/28195) E。    \nidea & solution：[Isaunoya](https://www.luogu.com.cn/user/96580) & [Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-5」String", "background": "", "description": "小 A 有一个字符串 $t$。他可以进行以下操作：切掉 $t$ 的一个前/后缀，满足切掉的前/后缀为**切割后** $t$ 的子串。小 A 想得到字符串 $s$，请问他最少需要进行多少次操作。无解输出 $-1$。", "inputFormat": "两行字符串分别表示 $t,s$。", "outputFormat": "一行一个整数，表示答案。", "hint": "「样例说明」\n\n样例 $1$：$\\texttt{abbabb}\\to \\texttt{abba}\\to \\texttt{bba}\\to \\texttt{ba}$。方案不唯一。\n\n样例 $2$：$\\texttt{fxofoxxooffoxooo}\\to\\texttt{xofoxxooffoxooo}\\to\\texttt{foxxooffoxooo}\\to\\texttt{xooffoxooo}\\to\\texttt{ffoxooo}\\to\\texttt{ffoxoo}\\to\\texttt{ffoxo}\\to\\texttt{ffox}\\to\\texttt{fox}$。方案不唯一。\n\n「数据范围与约定」\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 points）：$s=t$。\n- Subtask 2（9 points）：$s$ 仅包含字母 $\\texttt{a}$。\n- Subtask 3（15 points）：$|t|\\leq 100$。\n- Subtask 4（17 points）：$|t|\\leq 500$。\n- Subtask 5（18 points）：$|t|\\leq 1.5\\times 10^3$。\n- Subtask 6（15 points）：$|s|=4$，*数据随机。\n- Subtask 7（25 points）：无特殊限制。\n\n对于 $100\\%$ 的数据：$1 \\leq |s| \\leq |t| \\leq 5\\times 10^3$，字符集 $\\in[\\texttt{a,z}]$。\n\n*数据随机：$s,t$ 字符均随机，字符集 $\\in[\\texttt{a,c}]$。\n\n**请注意常数优化。**\n\n---\n\n「题目来源」\n\n[Sweet Round 05](https://www.luogu.com.cn/contest/28195) E。    \nidea & solution：[Isaunoya](https://www.luogu.com.cn/user/96580) & [Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN"}}}
{"pid": "P6653", "type": "P", "difficulty": 6, "samples": [["5\n1 2\n2 3\n3 4\n4 5\n", "3\n1\n2\n2\n"], ["7\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n", "3\n1\n2\n4\n"], ["25\n15 9\n22 15\n23 22\n25 15\n13 23\n6 22\n12 15\n1 23\n19 13\n18 9\n11 15\n17 1\n4 25\n3 1\n8 9\n20 1\n10 18\n21 20\n16 8\n2 22\n24 1\n7 19\n5 16\n14 7\n", "17\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n2\n2\n2\n2\n2\n2\n3\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 4000, 4000, 4000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["树形数据结构", "O2优化", "树形 DP", "哈希 hashing"], "title": "[YsOI2020] 造林", "background": "「承前」\n\nYsuperman 响应号召，决定在幼儿园外造林。\n\n呐呐，如果这样的话，Ysuperman 便能在这炎热的夏天与小朋友们玩游戏了呢。", "description": "为了落实环保工作，Ysuperman 购进了一批树，它们都长一个样。由于树还没有种下去，所以这些树还没有根，可以认为是**无根树**。\n\nYsuperman 觉得全都种长得一样的树太无聊了，于是 TA 请到了园艺公司帮 TA 规划。园艺公司提供给了 TA 一个方法——「嫁接」。\n\n下面给出「嫁接」操作的定义：\n\n定义「叶子节点」为树上度数为 $1$ 的节点。\n \n「嫁接」操作指：在一棵**无根树**上接入一个新的「叶子节点」。\n\n例如：  \n![](https://cdn.luogu.com.cn/upload/image_hosting/jfaksqwy.png)\n\n图 2 是由图 1 的树进行一次合法的嫁接操作后得到的树，图 3 也是由图 1 的树进行一次合法的嫁接操作后得到的树。\n\n那么，我们还知道，树有一个基本属性：「品种」。\n\n一棵树的「品种」是指**每个点的最大子树大小所构成的可重集**。\n\n两棵树的「品种」不同，当且仅当**每个点的最大子树大小所构成的可重集不同**。\n\n这里的一个点的**最大子树大小**指将这个点删掉后**最大的联通块所包含的点数**。\n\n例如：  \n![](https://cdn.luogu.com.cn/upload/image_hosting/zzyznfl7.png)\n\n图 4 的树的每个点的最大子树大小所构成的可重集为：$ \\{ 2,2,3,3 \\} $  \n图 5 的树的每个点的最大子树大小所构成的可重集为：$ \\{ 2,2,3,3 \\} $  \n图 6 的树的每个点的最大子树大小所构成的可重集为：$ \\{ 1,3,3,3 \\} $  \n所以说，图 4 的树与图 5 的树「品种」相同，与图 6 的树「品种」不同。\n\nYsuperman 想知道，通过一次「嫁接」操作，可以构造出的树包含多少不同的「品种」，以及对于每个「品种」，有多少不同的「嫁接」方法可以构造。请**从小到大**输出每个「品种」的「嫁接」方法数。\n\n两个「嫁接」方案不同，当且仅当在「嫁接」操作中与新接入的「叶子节点」直接相连的点不同。\n", "inputFormat": "第一行一个数 $n$ 。  \n接下来 $n-1$ 行，每行两个数 $u,v$ 表示 $u,v$ 之间有一条**无向边**。", "outputFormat": "第一行一个数 $cnt$，表示可以构造出的树包含多少不同的「品种」。  \n第二行到第 $cnt+1$ 行，**从小到大**输出每个「品种」的「嫁接」方法数。", "hint": "**本题采用捆绑测试。**\n### 样例解释 1\n可以构造出 1 种「品种」为 $\\{2,4,4,5,5,5\\}$ 的树。  \n可以构造出 2 种「品种」为 $\\{3,3,4,5,5,5\\}$ 的树。  \n可以构造出 2 种「品种」为 $\\{3,3,4,4,5,5\\}$ 的树。\n### 样例解释 2\n可以构造出 1 种「品种」为 $\\{3,5,5,7,7,7,7,7\\}$ 的树。  \n可以构造出 2 种「品种」为 $\\{4,4,5,7,7,7,7,7\\}$ 的树。  \n可以构造出 4 种「品种」为 $\\{4,4,5,6,7,7,7,7\\}$ 的树。\n\n\n对于 100% 的数据，满足 $1 \\le n\\le2\\cdot 10^6$。\n\n定义「链」为所有节点度数不超过 $2$ 的树。  \n定义「菊花」为包含 $n-1$ 个「叶子节点」的树。\n\n特殊性质 1：保证树的形态为一条「链」。  \n特殊性质 2：保证树的形态为一朵「菊花」。  \n特殊性质 3：保证树的形态为一棵完全二叉树。\n\n| subtask | $n$ | 特殊性质 | 分值 | 时间限制 |\n| :-----------: | :-----------: | :-----------: | :--------:| :---------:|\n| 1 | $\\le 2\\cdot 10^6$ | 2 | 2 | 4s |\n| 2 | $\\le 2\\cdot 10^6$ | 1 | 3 | 4s |\n| 3 | $\\le 300$ | 无 | 5 | 1s |\n| 4 | $\\le 2\\cdot10^6$ | 3 | 7 | 4s |\n| 5 | $\\le 5000$ | 无 | 23 | 1s |\n| 6 | $\\le 5\\cdot10^4$ | 无 | 29 | 2s |\n| 7 | $\\le 2\\cdot10^6$ | 无 | 31 | 4s |\n\n### 提示：\n\n如果你不知道完全二叉树是什么意思，Ysuperman 提供了一个链接：[Link](https://zh.wikipedia.org/zh/%E4%BA%8C%E5%8F%89%E6%A0%91#%E5%AE%8C%E5%85%A8%E4%BA%8C%E5%8F%89%E6%A0%91)。\n\n输入输出较大，请使用较快的输入输出方式。\n\n如果您使用了所需栈空间较大的递归算法，可以在本地（NOI linux 下）先使用 ```sudo su``` 获取权限，再使用 ```ulimit -s unlimited ``` 命令开启无限栈。\n\n题目并不难。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[YsOI2020] 造林", "background": "「承前」\n\nYsuperman 响应号召，决定在幼儿园外造林。\n\n呐呐，如果这样的话，Ysuperman 便能在这炎热的夏天与小朋友们玩游戏了呢。", "description": "为了落实环保工作，Ysuperman 购进了一批树，它们都长一个样。由于树还没有种下去，所以这些树还没有根，可以认为是**无根树**。\n\nYsuperman 觉得全都种长得一样的树太无聊了，于是 TA 请到了园艺公司帮 TA 规划。园艺公司提供给了 TA 一个方法——「嫁接」。\n\n下面给出「嫁接」操作的定义：\n\n定义「叶子节点」为树上度数为 $1$ 的节点。\n \n「嫁接」操作指：在一棵**无根树**上接入一个新的「叶子节点」。\n\n例如：  \n![](https://cdn.luogu.com.cn/upload/image_hosting/jfaksqwy.png)\n\n图 2 是由图 1 的树进行一次合法的嫁接操作后得到的树，图 3 也是由图 1 的树进行一次合法的嫁接操作后得到的树。\n\n那么，我们还知道，树有一个基本属性：「品种」。\n\n一棵树的「品种」是指**每个点的最大子树大小所构成的可重集**。\n\n两棵树的「品种」不同，当且仅当**每个点的最大子树大小所构成的可重集不同**。\n\n这里的一个点的**最大子树大小**指将这个点删掉后**最大的联通块所包含的点数**。\n\n例如：  \n![](https://cdn.luogu.com.cn/upload/image_hosting/zzyznfl7.png)\n\n图 4 的树的每个点的最大子树大小所构成的可重集为：$ \\{ 2,2,3,3 \\} $  \n图 5 的树的每个点的最大子树大小所构成的可重集为：$ \\{ 2,2,3,3 \\} $  \n图 6 的树的每个点的最大子树大小所构成的可重集为：$ \\{ 1,3,3,3 \\} $  \n所以说，图 4 的树与图 5 的树「品种」相同，与图 6 的树「品种」不同。\n\nYsuperman 想知道，通过一次「嫁接」操作，可以构造出的树包含多少不同的「品种」，以及对于每个「品种」，有多少不同的「嫁接」方法可以构造。请**从小到大**输出每个「品种」的「嫁接」方法数。\n\n两个「嫁接」方案不同，当且仅当在「嫁接」操作中与新接入的「叶子节点」直接相连的点不同。\n", "inputFormat": "第一行一个数 $n$ 。  \n接下来 $n-1$ 行，每行两个数 $u,v$ 表示 $u,v$ 之间有一条**无向边**。", "outputFormat": "第一行一个数 $cnt$，表示可以构造出的树包含多少不同的「品种」。  \n第二行到第 $cnt+1$ 行，**从小到大**输出每个「品种」的「嫁接」方法数。", "hint": "**本题采用捆绑测试。**\n### 样例解释 1\n可以构造出 1 种「品种」为 $\\{2,4,4,5,5,5\\}$ 的树。  \n可以构造出 2 种「品种」为 $\\{3,3,4,5,5,5\\}$ 的树。  \n可以构造出 2 种「品种」为 $\\{3,3,4,4,5,5\\}$ 的树。\n### 样例解释 2\n可以构造出 1 种「品种」为 $\\{3,5,5,7,7,7,7,7\\}$ 的树。  \n可以构造出 2 种「品种」为 $\\{4,4,5,7,7,7,7,7\\}$ 的树。  \n可以构造出 4 种「品种」为 $\\{4,4,5,6,7,7,7,7\\}$ 的树。\n\n\n对于 100% 的数据，满足 $1 \\le n\\le2\\cdot 10^6$。\n\n定义「链」为所有节点度数不超过 $2$ 的树。  \n定义「菊花」为包含 $n-1$ 个「叶子节点」的树。\n\n特殊性质 1：保证树的形态为一条「链」。  \n特殊性质 2：保证树的形态为一朵「菊花」。  \n特殊性质 3：保证树的形态为一棵完全二叉树。\n\n| subtask | $n$ | 特殊性质 | 分值 | 时间限制 |\n| :-----------: | :-----------: | :-----------: | :--------:| :---------:|\n| 1 | $\\le 2\\cdot 10^6$ | 2 | 2 | 4s |\n| 2 | $\\le 2\\cdot 10^6$ | 1 | 3 | 4s |\n| 3 | $\\le 300$ | 无 | 5 | 1s |\n| 4 | $\\le 2\\cdot10^6$ | 3 | 7 | 4s |\n| 5 | $\\le 5000$ | 无 | 23 | 1s |\n| 6 | $\\le 5\\cdot10^4$ | 无 | 29 | 2s |\n| 7 | $\\le 2\\cdot10^6$ | 无 | 31 | 4s |\n\n### 提示：\n\n如果你不知道完全二叉树是什么意思，Ysuperman 提供了一个链接：[Link](https://zh.wikipedia.org/zh/%E4%BA%8C%E5%8F%89%E6%A0%91#%E5%AE%8C%E5%85%A8%E4%BA%8C%E5%8F%89%E6%A0%91)。\n\n输入输出较大，请使用较快的输入输出方式。\n\n如果您使用了所需栈空间较大的递归算法，可以在本地（NOI linux 下）先使用 ```sudo su``` 获取权限，再使用 ```ulimit -s unlimited ``` 命令开启无限栈。\n\n题目并不难。", "locale": "zh-CN"}}}
{"pid": "P6654", "type": "P", "difficulty": 6, "samples": [["5\n", "1\n"], ["45\n", "2\n"], ["55\n", "4\n"], ["3333\n", "24\n"], ["999999\n", "16336\n"], ["1919810\n", "3461\n"], ["11451419\n", "210000\n"]], "limits": {"time": [1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145, 1145], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP"], "title": "[YsOI2020] 归零", "background": "Ysuperman 特别喜欢玩数数游戏。\n\n~~其实本来这题想叫“亦旧亦久罢以龄”的，但是我见到其他的题目名称都是两个字，取这么长名称也不好。~~", "description": "闲暇时光，Ysuerpman 选择用计算器打发时间。他输入了一个很长的十进制数 $S$。具体有多长呢？共 $n$ 位。为了方便解释，设从低到高第 $i$ 位上的数字是 $S_i$（下标从 $1$ 开始）。\n\nYsuerpman 每次会选择一个**非零**数字位进行「四舍五入」。具体来说，假设「四舍五入」的是第 $i$ 位：\n\n- 如果 $S_i<5$，则让 $S$ 减去 $S_i \\cdot 10^{i-1}$。\n- 如果它 $S_i\\ge5$，则让 $S$ 加上 $10^i$ 再减去 $S_i \\cdot 10^{i-1}$。\n\n经过若干次操作后，$S$ 总会变成 $0$。现在问题来了，请问有多少种使得 $S$ 变成 $0$ 的不同的方案？两个方案不同当且仅当某一次选择的操作位置不同。\n\n", "inputFormat": "一个高精度数 $S$。", "outputFormat": "使得 $S$ 变成 $0$ 的不同的方案数量，对 $998244353$ 取模。", "hint": "### 样例解释\n\n#### 样例解释 $1$\n\n$\\underline5\\to \\underline10 \\to 0$\n\n共 $1$ 种。\n\n#### 样例解释 $2$\n\n$\\underline{4}5\\to\\underline{5}\\to\\underline10\\to 0$\n\n$4\\underline{5}\\to\\underline{5}0\\to \\underline100 \\to 0$\n\n共 $2$ 种。\n\n#### 样例解释 $3$\n\n$\\underline{5}5\\to\\underline{1}05\\to\\underline{5}\\to\\underline{1}0 \\to 0$\n\n$\\underline{5}5\\to10\\underline{5}\\to\\underline{1}10\\to \\underline10 \\to 0$\n\n$\\underline{5}5\\to10\\underline{5}\\to1\\underline{1}0\\to \\underline100 \\to 0$\n\n$5\\underline{5}\\to\\underline{6}0\\to \\underline100 \\to 0$\n\n共 $4$ 种。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| $\\rm{subtask}$ |    $n$    | $S_i\\in$ | 分数 |\n| :------------: | :-------: | :------: | :--: |\n|      $0$       |  $\\le 6$  | $[0,9]$  | $5$  |\n|      $1$       | $\\le 15$ | $[0,9]$  | $13$ |\n|      $2$       |  $\\le40$  | $[0,4]$  | $5$  |\n|      $3$       | $\\le 40$  | $\\{9\\}$  | $12$ |\n|      $4$       |  $\\le40$  | $[5,8]$  | $15$ |\n|      $5$       | $\\le 40$  | $[0,9]$  | $30$ |\n|      $6$       | $\\le 64$  | $[0,9]$  | $20$ |\n\n对于 $100\\%$ 的数据，满足 $1\\le n \\le 64$，$S$ 不含前导零。\n\n### 提示\n\n本题时间限制为 $1145ms$。\n\n题目并不难。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[YsOI2020] 归零", "background": "Ysuperman 特别喜欢玩数数游戏。\n\n~~其实本来这题想叫“亦旧亦久罢以龄”的，但是我见到其他的题目名称都是两个字，取这么长名称也不好。~~", "description": "闲暇时光，Ysuerpman 选择用计算器打发时间。他输入了一个很长的十进制数 $S$。具体有多长呢？共 $n$ 位。为了方便解释，设从低到高第 $i$ 位上的数字是 $S_i$（下标从 $1$ 开始）。\n\nYsuerpman 每次会选择一个**非零**数字位进行「四舍五入」。具体来说，假设「四舍五入」的是第 $i$ 位：\n\n- 如果 $S_i<5$，则让 $S$ 减去 $S_i \\cdot 10^{i-1}$。\n- 如果它 $S_i\\ge5$，则让 $S$ 加上 $10^i$ 再减去 $S_i \\cdot 10^{i-1}$。\n\n经过若干次操作后，$S$ 总会变成 $0$。现在问题来了，请问有多少种使得 $S$ 变成 $0$ 的不同的方案？两个方案不同当且仅当某一次选择的操作位置不同。\n\n", "inputFormat": "一个高精度数 $S$。", "outputFormat": "使得 $S$ 变成 $0$ 的不同的方案数量，对 $998244353$ 取模。", "hint": "### 样例解释\n\n#### 样例解释 $1$\n\n$\\underline5\\to \\underline10 \\to 0$\n\n共 $1$ 种。\n\n#### 样例解释 $2$\n\n$\\underline{4}5\\to\\underline{5}\\to\\underline10\\to 0$\n\n$4\\underline{5}\\to\\underline{5}0\\to \\underline100 \\to 0$\n\n共 $2$ 种。\n\n#### 样例解释 $3$\n\n$\\underline{5}5\\to\\underline{1}05\\to\\underline{5}\\to\\underline{1}0 \\to 0$\n\n$\\underline{5}5\\to10\\underline{5}\\to\\underline{1}10\\to \\underline10 \\to 0$\n\n$\\underline{5}5\\to10\\underline{5}\\to1\\underline{1}0\\to \\underline100 \\to 0$\n\n$5\\underline{5}\\to\\underline{6}0\\to \\underline100 \\to 0$\n\n共 $4$ 种。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| $\\rm{subtask}$ |    $n$    | $S_i\\in$ | 分数 |\n| :------------: | :-------: | :------: | :--: |\n|      $0$       |  $\\le 6$  | $[0,9]$  | $5$  |\n|      $1$       | $\\le 15$ | $[0,9]$  | $13$ |\n|      $2$       |  $\\le40$  | $[0,4]$  | $5$  |\n|      $3$       | $\\le 40$  | $\\{9\\}$  | $12$ |\n|      $4$       |  $\\le40$  | $[5,8]$  | $15$ |\n|      $5$       | $\\le 40$  | $[0,9]$  | $30$ |\n|      $6$       | $\\le 64$  | $[0,9]$  | $20$ |\n\n对于 $100\\%$ 的数据，满足 $1\\le n \\le 64$，$S$ 不含前导零。\n\n### 提示\n\n本题时间限制为 $1145ms$。\n\n题目并不难。", "locale": "zh-CN"}}}
{"pid": "P6655", "type": "P", "difficulty": 5, "samples": [["3\n1 3 2\n1 1\n1 2\n", "5\n"], ["10\n1 1 1 0 5 2 11 12 17 7\n1 1\n1 2\n2 2\n1 3\n1 1\n1 4\n1 2\n6 7\n1 5\n", "4044\n"], ["50\n1 0 0 6 2 5 0 2 16 15 14 8 20 22 23 21 7 24 27 17 1 13 39 40 31 38 40 16 25 48 2 0 15 7 0 47 58 11 22 54 11 78 30 32 31 35 44 56 59 85\n1 1\n2 2\n1 2\n2 3\n3 3\n1 6\n2 6\n3 5\n5 9\n3 4\n1 4\n3 12\n1 12\n5 7\n5 13\n1 10\n7 9\n4 11\n12 12\n16 17\n3 9\n8 15\n15 16\n1 19\n9 10\n10 12\n8 10\n4 10\n6 13\n10 13\n11 30\n11 21\n2 30\n13 23\n4 24\n32 34\n8 29\n4 22\n2 26\n29 33\n28 38\n18 31\n19 36\n15 32\n8 14\n15 32\n4 33\n30 45\n8 25\n", "904672069\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "树状数组", "可持久化线段树"], "title": "[YsOI2020] 制高", "background": "Ysuperman 特别喜欢玩战略游戏。", "description": "游戏地图是一棵 $n$ 个点的有根树，根节点是 $1$ ，除节点 $1$ 外其他节点都有唯一的父亲节点。\n\n每个节点有一个高度，第 $i$ 个节点的高度为 $h_i$ ，我们认为一个节点 $v$ 是“制高点”，当且仅当 $v$ 是根节点或者其父亲节点 $u$ 是“制高点”并且 $h_v\\ge h_u$ 。\n\n但是， Ysuperman 并不知道每个节点的父亲具体是哪个，只知道它的父亲编号可能在的区间，其中，节点 $i$ 的父亲可能在的编号范围为 $[l_i,r_i]$ ，保证 $1\\le l_i\\le r_i<i$ 。\n\n现在， Ysuperman 想知道对于**所有可能的情况**，“制高点”的数量之和是多少。\n\n因为这个结果可能会很大，所以你只需要输出结果 $\\bmod \\ {998244353}$ 的值即可。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行一个正整数 $n$ 。\n\n接下来一行 $n$ 个非负整数，第 $i$ 个整数描述 $h_i$ 。\n\n接下来 $n-1$ 行，每行两个正整数，分别描述 $l_2,r_2,\\cdots,l_n,r_n$ 。\n\n保证 $1\\le l_i\\le r_i<i$ 。", "outputFormat": "一行一个整数，即答案。", "hint": "样例一解释：\n\n共有两种情况，情况一： $2$ 的父亲节点是 $1$ ， $3$ 的父亲节点是 $1$ ，此时 $1,2,3$ 均是“制高点”；情况二： $2$ 的父亲节点是 $1$ ， $3$ 的父亲节点是 $2$ ，由于 $h_2>h_3$ ，所以 $3$ 不是“制高点”，此时 $1,2$ 均是“制高点”。\n\n所以所有情况“制高点”数量的和为 $5$ 。\n\n| $\\text{测试点编号}$ |   $n$    | $\\prod_{i=2}^n(r_i-l_i+1)$ | $\\text{特殊性质}$ |\n| :-----------------: | :------: | :------------------------: | :---------------: |\n|      $1\\sim 2$      |  $=10$   |         $\\le 10^6$         |    $\\text{无}$    |\n|         $3$         | $= 10^5$ |         $\\le 10^6$         |    $\\text{无}$    |\n|         $4$         | $= 10^5$ |             \\\\             | $h_i\\le h_{i+1}$  |\n|         $5$         | $= 10^5$ |             \\\\             |   $h_i>h_{i+1}$   |\n|     $6\\sim 12$      | $= 10^3$ |             \\\\             |    $\\text{无}$    |\n|     $13\\sim 20$     | $=10^5$  |             \\\\             |    $\\text{无}$    |\n\n题目数据保证 $h_i$ 在 `int` 能表示的最大范围内， $1\\le l_i\\le r_i<i$ 。\n\n题目并不难。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[YsOI2020] 制高", "background": "Ysuperman 特别喜欢玩战略游戏。", "description": "游戏地图是一棵 $n$ 个点的有根树，根节点是 $1$ ，除节点 $1$ 外其他节点都有唯一的父亲节点。\n\n每个节点有一个高度，第 $i$ 个节点的高度为 $h_i$ ，我们认为一个节点 $v$ 是“制高点”，当且仅当 $v$ 是根节点或者其父亲节点 $u$ 是“制高点”并且 $h_v\\ge h_u$ 。\n\n但是， Ysuperman 并不知道每个节点的父亲具体是哪个，只知道它的父亲编号可能在的区间，其中，节点 $i$ 的父亲可能在的编号范围为 $[l_i,r_i]$ ，保证 $1\\le l_i\\le r_i<i$ 。\n\n现在， Ysuperman 想知道对于**所有可能的情况**，“制高点”的数量之和是多少。\n\n因为这个结果可能会很大，所以你只需要输出结果 $\\bmod \\ {998244353}$ 的值即可。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行一个正整数 $n$ 。\n\n接下来一行 $n$ 个非负整数，第 $i$ 个整数描述 $h_i$ 。\n\n接下来 $n-1$ 行，每行两个正整数，分别描述 $l_2,r_2,\\cdots,l_n,r_n$ 。\n\n保证 $1\\le l_i\\le r_i<i$ 。", "outputFormat": "一行一个整数，即答案。", "hint": "样例一解释：\n\n共有两种情况，情况一： $2$ 的父亲节点是 $1$ ， $3$ 的父亲节点是 $1$ ，此时 $1,2,3$ 均是“制高点”；情况二： $2$ 的父亲节点是 $1$ ， $3$ 的父亲节点是 $2$ ，由于 $h_2>h_3$ ，所以 $3$ 不是“制高点”，此时 $1,2$ 均是“制高点”。\n\n所以所有情况“制高点”数量的和为 $5$ 。\n\n| $\\text{测试点编号}$ |   $n$    | $\\prod_{i=2}^n(r_i-l_i+1)$ | $\\text{特殊性质}$ |\n| :-----------------: | :------: | :------------------------: | :---------------: |\n|      $1\\sim 2$      |  $=10$   |         $\\le 10^6$         |    $\\text{无}$    |\n|         $3$         | $= 10^5$ |         $\\le 10^6$         |    $\\text{无}$    |\n|         $4$         | $= 10^5$ |             \\\\             | $h_i\\le h_{i+1}$  |\n|         $5$         | $= 10^5$ |             \\\\             |   $h_i>h_{i+1}$   |\n|     $6\\sim 12$      | $= 10^3$ |             \\\\             |    $\\text{无}$    |\n|     $13\\sim 20$     | $=10^5$  |             \\\\             |    $\\text{无}$    |\n\n题目数据保证 $h_i$ 在 `int` 能表示的最大范围内， $1\\le l_i\\le r_i<i$ 。\n\n题目并不难。", "locale": "zh-CN"}}}
{"pid": "P6656", "type": "P", "difficulty": 7, "samples": [["aababaababb", "7\n1 2 1\n1 10 5\n2 6 2\n4 9 3\n6 7 1\n7 10 2\n10 11 1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "模板题"], "title": "【模板】Runs", "background": "", "description": "定义一个字符串 $|S|$ 里的一个 run，指其内部一段两侧都不能扩展的**周期子串**，且周期至少完整出现两次。\n\n严格地说，一个 run 是一个 三元组 $(i,j,p)$，满足 $p$ 是 $S[i..j]$ 的最小周期，$j-i+1 \\ge 2p$，且满足如下两个条件：\n\n+ 要么 $i=1$，要么 $S[i-1]\\ne S[i-1+p]$；\n+ 要么 $j=n$，要么 $S[j+1] \\ne S[j+1-p]$。\n\n给定字符串 $S$，求他的所有 runs。\n\n", "inputFormat": "一行一个字符串 $S$，保证其只由小写字母构成。", "outputFormat": "第一行一个整数 $m$，表示 runs 的数量。\n\n接下来 $m$ 行，每行三个整数描述一个 runs：\n\n+ 这个 runs 的第一个字符的位置\n+ 最后一个字符的位置\n+ 这个 runs 的最小循环的长度\n\n你应该以第一个字符的位置为第一关键词，最后一个字符的位置为第二关键词对所有的 runs 进行排序。", "hint": "对于 $60\\%$ 的数据，$|S| \\le 2 \\times 10^5$。\n\n对于 $100\\%$ 的数据，$|S| \\le 10^6$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】Runs", "background": "", "description": "定义一个字符串 $|S|$ 里的一个 run，指其内部一段两侧都不能扩展的**周期子串**，且周期至少完整出现两次。\n\n严格地说，一个 run 是一个 三元组 $(i,j,p)$，满足 $p$ 是 $S[i..j]$ 的最小周期，$j-i+1 \\ge 2p$，且满足如下两个条件：\n\n+ 要么 $i=1$，要么 $S[i-1]\\ne S[i-1+p]$；\n+ 要么 $j=n$，要么 $S[j+1] \\ne S[j+1-p]$。\n\n给定字符串 $S$，求他的所有 runs。\n\n", "inputFormat": "一行一个字符串 $S$，保证其只由小写字母构成。", "outputFormat": "第一行一个整数 $m$，表示 runs 的数量。\n\n接下来 $m$ 行，每行三个整数描述一个 runs：\n\n+ 这个 runs 的第一个字符的位置\n+ 最后一个字符的位置\n+ 这个 runs 的最小循环的长度\n\n你应该以第一个字符的位置为第一关键词，最后一个字符的位置为第二关键词对所有的 runs 进行排序。", "hint": "对于 $60\\%$ 的数据，$|S| \\le 2 \\times 10^5$。\n\n对于 $100\\%$ 的数据，$|S| \\le 10^6$。\n", "locale": "zh-CN"}}}
{"pid": "P6657", "type": "P", "difficulty": 6, "samples": [["3\n3 2\n1 2\n2 3\n5 2\n1 3\n3 5\n10 5\n3 5\n4 7\n5 8\n7 9\n9 10", "3\n155\n2047320"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["LGV 引理", "容斥原理", "高斯消元", "模板题"], "title": "【模板】LGV 引理", "background": "", "description": "这是一道模板题。\n\n有一个 $n\\times n$ 的棋盘，左下角为 $(1,1)$，右上角为 $(n,n)$，若一个棋子在点 $(x,y)$，那么走一步只能走到 $(x+1,y)$ 或 $(x,y+1)$。\n\n现在有 $m$ 个棋子，第 $i$ 个棋子一开始放在 $(a_i,1)$，最终要走到 $(b_i,n)$。问有多少种方案，使得每个棋子都能从起点走到终点，且对于所有棋子，走过路径上的点互不相交。输出方案数 $\\bmod\\ 998244353$ 的值。\n\n两种方案不同当且仅当存在至少一个棋子所经过的点不同。", "inputFormat": "**本题有多组数据**\n\n第一行一个整数 $T$，表示该测试点的数据组数。\n\n对于每组数据：\n\n第一行两个整数 $n,m$，分别表示棋盘的大小和起点终点的数量。\n\n接下来 $m$ 行，每行 $2$ 个整数 $a_i,b_i$，其意义已在题目描述中说明。", "outputFormat": "对于每一组数据，输出一行一个整数表示方案数 $\\bmod\\ 998244353$ 的值。", "hint": "- 对于 $30\\%$ 的数据，$n\\leq 100$，$m\\leq 8$。 \n\n- 对于 $100\\%$ 的数据，$T\\leq5$，$2\\leq n\\leq10^6$，$1\\leq m\\leq100$，$1\\leq a_1\\leq a_2\\leq \\dots\\leq a_m\\leq n$，$1\\leq b_1\\leq b_2\\leq \\dots\\leq b_m\\leq n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】LGV 引理", "background": "", "description": "这是一道模板题。\n\n有一个 $n\\times n$ 的棋盘，左下角为 $(1,1)$，右上角为 $(n,n)$，若一个棋子在点 $(x,y)$，那么走一步只能走到 $(x+1,y)$ 或 $(x,y+1)$。\n\n现在有 $m$ 个棋子，第 $i$ 个棋子一开始放在 $(a_i,1)$，最终要走到 $(b_i,n)$。问有多少种方案，使得每个棋子都能从起点走到终点，且对于所有棋子，走过路径上的点互不相交。输出方案数 $\\bmod\\ 998244353$ 的值。\n\n两种方案不同当且仅当存在至少一个棋子所经过的点不同。", "inputFormat": "**本题有多组数据**\n\n第一行一个整数 $T$，表示该测试点的数据组数。\n\n对于每组数据：\n\n第一行两个整数 $n,m$，分别表示棋盘的大小和起点终点的数量。\n\n接下来 $m$ 行，每行 $2$ 个整数 $a_i,b_i$，其意义已在题目描述中说明。", "outputFormat": "对于每一组数据，输出一行一个整数表示方案数 $\\bmod\\ 998244353$ 的值。", "hint": "- 对于 $30\\%$ 的数据，$n\\leq 100$，$m\\leq 8$。 \n\n- 对于 $100\\%$ 的数据，$T\\leq5$，$2\\leq n\\leq10^6$，$1\\leq m\\leq100$，$1\\leq a_1\\leq a_2\\leq \\dots\\leq a_m\\leq n$，$1\\leq b_1\\leq b_2\\leq \\dots\\leq b_m\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P6658", "type": "P", "difficulty": 6, "samples": [["4 5\n1 3\n1 2\n4 1\n3 2\n3 4", "3\n1 3\n2\n4"], ["17 29\n1 2\n1 10\n1 10\n2 3\n2 8\n3 4\n3 5\n4 6\n4 6\n5 6\n5 6\n5 7\n7 8\n7 11\n7 12\n7 17\n7 17\n8 9\n9 10\n11 12\n11 17\n12 13\n12 16\n13 14\n13 15\n13 16\n14 15\n14 16\n15 16", "7\n1 10\n2 8\n3 4 5 6\n7 11 17\n9\n12\n13 14 15 16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["图论", "深度优先搜索 DFS", "Tarjan"], "title": "边三连通分量", "background": "对于一张无向图 $G = (V, E)$。\n\n- 我们称两个点 $u, v ~ (u, v \\in V, u \\neq v)$ 是边三连通的，当且仅当存在三条从 $u$ 出发到达 $v$ 的，相互没有公共边的路径。\n- 我们称一个点集 $U ~ (U \\subseteq V)$ 是边三连通分量，当且仅当对于任意两个点 $u', v' ~ (u', v' \\in U, u' \\neq v')$ 都是边三连通的。\n- 我们称一个边三连通分量 $S$ 是极大边三连通分量，当且仅当不存在 $u \\not \\in S$ 且 $u \\in V$，使得 $S \\cup \\{u\\}$ 也是边三连通分量。", "description": "给出一个 $n$ 个点，$m$ 条边的无向图 $G = (V, E)$，$V = \\{1, 2, \\ldots, n\\}$，请求出其所有的极大边三连通分量。", "inputFormat": "第一行输入两个整数 $n, m$，表示点数、边数。\n\n接下来 $m$ 行，每行输入两个数 $u, v$，表示图上的一条边。", "outputFormat": "第一行输出一个整数 $s$，表示极大边三连通分量个数。\n\n接下来输出 $s$ 行，每行若干整数，表示一个极大边三连通分量内所有点。\n\n对于单个极大边三连通分量，请将点按照标号升序输出。对于所有极大边三连通分量，请按照点集内编号最小的点升序输出。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eqpng8sy.png)\n\n如图，$1 \\to 3$ 共有 $(1, 2, 3)$，$(1, 3)$，$(1, 4, 3)$ 三条路径，它们互相都没有相交的边。因此 $1$ 与 $3$ 在同一个边三连通分量中。\n\n由于 $2$，$4$ 点度都只有 $2$，不可能有三条边不相交的到其它点的路径，因此它们自己形成边三联通分量。\n\n---\n\n#### 数据范围\n\n- 对于 $30\\%$ 的数据，$n \\le 100$，$m \\le 200$。\n- 对于 $50\\%$ 的数据，$n \\le 1000$，$m \\le 2000$。\n- 对于 $80\\%$ 的数据，$n \\le 10 ^ 5$，$m \\le 2 \\times 10 ^ 5$。\n- 对于 $100\\%$ 的数据，$1 \\le n, m \\le 5 \\times 10 ^ 5$，$1 \\le u, v \\le n$。可能有重边和自环。\n\n---\n\n#### 来源\n\n题目搬运自 [Three-Edge-Connected Components](https://judge.yosupo.jp/problem/three_edge_connected_components)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "边三连通分量", "background": "对于一张无向图 $G = (V, E)$。\n\n- 我们称两个点 $u, v ~ (u, v \\in V, u \\neq v)$ 是边三连通的，当且仅当存在三条从 $u$ 出发到达 $v$ 的，相互没有公共边的路径。\n- 我们称一个点集 $U ~ (U \\subseteq V)$ 是边三连通分量，当且仅当对于任意两个点 $u', v' ~ (u', v' \\in U, u' \\neq v')$ 都是边三连通的。\n- 我们称一个边三连通分量 $S$ 是极大边三连通分量，当且仅当不存在 $u \\not \\in S$ 且 $u \\in V$，使得 $S \\cup \\{u\\}$ 也是边三连通分量。", "description": "给出一个 $n$ 个点，$m$ 条边的无向图 $G = (V, E)$，$V = \\{1, 2, \\ldots, n\\}$，请求出其所有的极大边三连通分量。", "inputFormat": "第一行输入两个整数 $n, m$，表示点数、边数。\n\n接下来 $m$ 行，每行输入两个数 $u, v$，表示图上的一条边。", "outputFormat": "第一行输出一个整数 $s$，表示极大边三连通分量个数。\n\n接下来输出 $s$ 行，每行若干整数，表示一个极大边三连通分量内所有点。\n\n对于单个极大边三连通分量，请将点按照标号升序输出。对于所有极大边三连通分量，请按照点集内编号最小的点升序输出。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eqpng8sy.png)\n\n如图，$1 \\to 3$ 共有 $(1, 2, 3)$，$(1, 3)$，$(1, 4, 3)$ 三条路径，它们互相都没有相交的边。因此 $1$ 与 $3$ 在同一个边三连通分量中。\n\n由于 $2$，$4$ 点度都只有 $2$，不可能有三条边不相交的到其它点的路径，因此它们自己形成边三联通分量。\n\n---\n\n#### 数据范围\n\n- 对于 $30\\%$ 的数据，$n \\le 100$，$m \\le 200$。\n- 对于 $50\\%$ 的数据，$n \\le 1000$，$m \\le 2000$。\n- 对于 $80\\%$ 的数据，$n \\le 10 ^ 5$，$m \\le 2 \\times 10 ^ 5$。\n- 对于 $100\\%$ 的数据，$1 \\le n, m \\le 5 \\times 10 ^ 5$，$1 \\le u, v \\le n$。可能有重边和自环。\n\n---\n\n#### 来源\n\n题目搬运自 [Three-Edge-Connected Components](https://judge.yosupo.jp/problem/three_edge_connected_components)。", "locale": "zh-CN"}}}
{"pid": "P6659", "type": "P", "difficulty": 4, "samples": [["3\n12\n504\n17", "1 4\n6 9\nNIE"], ["5\n5\n6\n7\n8\n9", "NIE\n1 3\nNIE\nNIE\nNIE"], ["1\n1000000", "NIE"], ["1\n99999990000000", "9999999 10000000"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2019", "二分", "POI（波兰）", "最大公约数 gcd"], "title": "[POI 2019/2020 R1] Najmniejsza wspólna wielokrotność / 最小公倍数", "background": "Byteasar 正在准备他的数学考试。", "description": "老师跟他说考试题目中有关于最小公倍数 $\\rm lcm$ 的题目，于是他找到了一道题练练手。\n\n给定一个整数 $M$，求一个区间 $[a,b]$ 使得 $M$ 为这个区间所有数的最小公倍数。\n\n因为您很强，所以 Byteasar 在解出来这道题的同时也想问问您这题的答案。\n\n因为 Byteasar 非常爱问问题，所以他要问您 $z$ 组问题。", "inputFormat": "第一行一个整数 $z$ 代表询问个数。    \n接下来 $z$ 行每行一个整数 $M$ 代表一个询问。", "outputFormat": "$z$ 行每行两个整数 $a,b$ 代表一个询问的答案。    \n\n如果有多组解：\n\n- 输出 $a$ 最小的。\n- 如果还有多组解，输出 $b$ 最小的。\n\n如果无解，则输出 `NIE`。", "hint": "#### 样例说明\n\n对于样例 $1$ 的第一组数据，$12$ 为区间 $[1,4]$ 的最小公倍数。\n\n另一组附加样例见附加文件的 sample.in 和 sample.out。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（18 pts）：$z \\le 10$，$M \\le 1000$。\n- Subtask 2（20 pts）：$z\\le 100$，$M \\le 10^9$。\n- Subtask 3（20 pts）：$z \\le 100$，$M \\le 10^{18}$。\n- Subtask 4（42 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le z\\le 10^4$，$1 \\le M \\le 10^{18}$。\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) A [Najmniejsza wspólna wielokrotność](https://sio2.mimuw.edu.pl/c/oi27-1/p/nww/)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2019/2020 R1] Najmniejsza wspólna wielokrotność / 最小公倍数", "background": "Byteasar 正在准备他的数学考试。", "description": "老师跟他说考试题目中有关于最小公倍数 $\\rm lcm$ 的题目，于是他找到了一道题练练手。\n\n给定一个整数 $M$，求一个区间 $[a,b]$ 使得 $M$ 为这个区间所有数的最小公倍数。\n\n因为您很强，所以 Byteasar 在解出来这道题的同时也想问问您这题的答案。\n\n因为 Byteasar 非常爱问问题，所以他要问您 $z$ 组问题。", "inputFormat": "第一行一个整数 $z$ 代表询问个数。    \n接下来 $z$ 行每行一个整数 $M$ 代表一个询问。", "outputFormat": "$z$ 行每行两个整数 $a,b$ 代表一个询问的答案。    \n\n如果有多组解：\n\n- 输出 $a$ 最小的。\n- 如果还有多组解，输出 $b$ 最小的。\n\n如果无解，则输出 `NIE`。", "hint": "#### 样例说明\n\n对于样例 $1$ 的第一组数据，$12$ 为区间 $[1,4]$ 的最小公倍数。\n\n另一组附加样例见附加文件的 sample.in 和 sample.out。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（18 pts）：$z \\le 10$，$M \\le 1000$。\n- Subtask 2（20 pts）：$z\\le 100$，$M \\le 10^9$。\n- Subtask 3（20 pts）：$z \\le 100$，$M \\le 10^{18}$。\n- Subtask 4（42 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le z\\le 10^4$，$1 \\le M \\le 10^{18}$。\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) A [Najmniejsza wspólna wielokrotność](https://sio2.mimuw.edu.pl/c/oi27-1/p/nww/)。", "locale": "zh-CN"}}}
{"pid": "P6660", "type": "P", "difficulty": 7, "samples": [["3\nPetroniusz obudzil sie zaledwie kolo...\nLitwo! Ojczyzno moja! ty jestes jak...\nW poczatkach roku 1878, kiedy swiat...", "Sienkiewicz\nMickiewicz\nPrus"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "POI（波兰）", "Special Judge"], "title": "[POI 2019/2020 R1] Pisarze / 作家", "background": "Bajtek 拿到了一些波兰文的句段，他想知道这个这个句段从哪本书来的。\n\n**本题为数据分析题。**", "description": "他找到了 $t$ 个句段，并且确定这些句段来自以下三本书\n\n- Adama Mickiewicza 的 Pan Tadeusz  \n- Henryka Sienkiewicza 的 Quo Vadis\n- Bolesława Prusa 的 Lalka\n\n求具体来自哪一本书。", "inputFormat": "第一行一个整数 $t$ 代表句段数。       \n接下来 $t$ 行每行一个字符串 $s_i$ 代表一个句段。", "outputFormat": "$t$ 行每行一个字符串代表答案，输出该文章的作者 Mickiewicz，Prus 或 Sienkiewicz。", "hint": "#### 样例说明\n\n样例只截取了一部分，真正的样例见附加文件中的 sample.in 与 sample.out。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$t \\le 100$，$500 \\le |s_i| \\le 2000$。\n- Subtask 2（20 pts）：每行一定为完整的句子。\n- Subtask 3（30 pts）：$30 \\le |s_i| \\le 80$。\n- Subtask 4（30 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le t \\le 1000$，$10 \\le |s_i| \\le 2000$，$\\sum|s_i| \\le 2 \\times 10^6$。\n\n**本题为数据分析题。**\n\n**本题采用 Special Judge**，您不需要准确识别每一组数据，SPJ 机制如下：\n\n- 假设 $t$ 为句段数，$p$ 为您答对的句段数。\n- 如果 $p \\ge 0.9 \\times t$，那么您就会得到 $100\\%$ 的分数。\n- 如果 $p \\le \\dfrac{t}{3}$，很遗憾，您不会得到任何分数。\n- 其他情况，您会得到 $100\\times \\dfrac{p-\\frac{t}{3}}{0.9\\times t-\\frac{t}{3}}\\%$ 的分数。\n\n附加文件中的 Mickiewicz.txt，Prus.txt 和 Sienkiewicz.txt 代表三段句段。\n\n数据生成器见附加文件中的 pistestgen.py，使用 `python3 pistestgen.py subtask name directory [seed]` 来生成一组数据，其中：\n\n- grupa 代表子任务的编号，从 $1$ 到 $4$\n- nazma 为数据名，将会生成在 nazma.in 与 nazma.out 中\n- katalog 为这三本书的文件夹\n- ziarno 用于生成同一组数据\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) B [Pisarze](https://sio2.mimuw.edu.pl/c/oi27-1/p/pis/)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2019/2020 R1] Pisarze / 作家", "background": "Bajtek 拿到了一些波兰文的句段，他想知道这个这个句段从哪本书来的。\n\n**本题为数据分析题。**", "description": "他找到了 $t$ 个句段，并且确定这些句段来自以下三本书\n\n- Adama Mickiewicza 的 Pan Tadeusz  \n- Henryka Sienkiewicza 的 Quo Vadis\n- Bolesława Prusa 的 Lalka\n\n求具体来自哪一本书。", "inputFormat": "第一行一个整数 $t$ 代表句段数。       \n接下来 $t$ 行每行一个字符串 $s_i$ 代表一个句段。", "outputFormat": "$t$ 行每行一个字符串代表答案，输出该文章的作者 Mickiewicz，Prus 或 Sienkiewicz。", "hint": "#### 样例说明\n\n样例只截取了一部分，真正的样例见附加文件中的 sample.in 与 sample.out。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$t \\le 100$，$500 \\le |s_i| \\le 2000$。\n- Subtask 2（20 pts）：每行一定为完整的句子。\n- Subtask 3（30 pts）：$30 \\le |s_i| \\le 80$。\n- Subtask 4（30 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le t \\le 1000$，$10 \\le |s_i| \\le 2000$，$\\sum|s_i| \\le 2 \\times 10^6$。\n\n**本题为数据分析题。**\n\n**本题采用 Special Judge**，您不需要准确识别每一组数据，SPJ 机制如下：\n\n- 假设 $t$ 为句段数，$p$ 为您答对的句段数。\n- 如果 $p \\ge 0.9 \\times t$，那么您就会得到 $100\\%$ 的分数。\n- 如果 $p \\le \\dfrac{t}{3}$，很遗憾，您不会得到任何分数。\n- 其他情况，您会得到 $100\\times \\dfrac{p-\\frac{t}{3}}{0.9\\times t-\\frac{t}{3}}\\%$ 的分数。\n\n附加文件中的 Mickiewicz.txt，Prus.txt 和 Sienkiewicz.txt 代表三段句段。\n\n数据生成器见附加文件中的 pistestgen.py，使用 `python3 pistestgen.py subtask name directory [seed]` 来生成一组数据，其中：\n\n- grupa 代表子任务的编号，从 $1$ 到 $4$\n- nazma 为数据名，将会生成在 nazma.in 与 nazma.out 中\n- katalog 为这三本书的文件夹\n- ziarno 用于生成同一组数据\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) B [Pisarze](https://sio2.mimuw.edu.pl/c/oi27-1/p/pis/)。", "locale": "zh-CN"}}}
{"pid": "P6661", "type": "P", "difficulty": 4, "samples": [["4\n555 333 1\n0555 0551 3\n0555 0333 4\n9 9 1", "255\n0499\n-1\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2019", "POI（波兰）"], "title": "[POI 2019/2020 R1] Pomniejszenie / 削减", "background": "Bajtek 和 Bitek 是兄弟俩（Bajtek 是哥哥），他们要玩一个游戏。", "description": "游戏规则为：写下较大数的人获胜。\n\n假设 Bajtek 写的是 $A$，Bitek 写的是 $B$。$A$ 和 $B$ 的长度相等，且可能有前导零。\n\n但是每次比赛都是 Bajtek 赢（即总是 $A \\ge B$），所以 Bajtek 想输一次。\n\n他现在可以修改 $A$ 上的 **恰好** $k$ 位，使得 $A$ 比 $B$ 小。\n\n求 $A$ 修改后比 $B$ 小的最大值。\n\n如果无法使得 $A$ 比 $B$ 小，输出 `-1`。\n\n因为兄弟俩很喜欢玩这个游戏，所以他们要玩 $t$ 局，即要进行 $t$ 次修改与判断。", "inputFormat": "第一行一个整数 $t$ 代表局数。    \n接下来 $t$ 行每行三个整数 $A,B,k$ 代表 Bajtek 写的数，Bitek 写的数，和允许的修改次数。", "outputFormat": "$t$ 行每行一个整数代表 $A$ 经过修改后比 $B$ 小的最大值。    \n如果 $A$ 怎样修改都不能使得 $A$ 比 $B$ 小，输出 `-1`。", "hint": "#### 样例说明\n\n前两组附加样例分别对应附加文件中的 sample1/2.in 和 sample1/2.out。\n\n第三组附加样例为 sample3.zip。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n假设这里的 $n$ 为 $A,B$ 的长度：\n\n- Subtask 1（18 pts）：$1 \\le n \\le 5$。\n- Subtask 2（20 pts）：$1 \\le n \\le 5000$。\n- Subtask 3（20 pts）：$1 \\le n \\le 10^5$，$k=1$。\n- Subtask 4（42 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le t \\le 100$，$1 \\le k \\le n \\le 10^5$，$A \\ge B$。\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) C [Pomniejszenie](https://sio2.mimuw.edu.pl/c/oi27-1/p/pom/)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2019/2020 R1] Pomniejszenie / 削减", "background": "Bajtek 和 Bitek 是兄弟俩（Bajtek 是哥哥），他们要玩一个游戏。", "description": "游戏规则为：写下较大数的人获胜。\n\n假设 Bajtek 写的是 $A$，Bitek 写的是 $B$。$A$ 和 $B$ 的长度相等，且可能有前导零。\n\n但是每次比赛都是 Bajtek 赢（即总是 $A \\ge B$），所以 Bajtek 想输一次。\n\n他现在可以修改 $A$ 上的 **恰好** $k$ 位，使得 $A$ 比 $B$ 小。\n\n求 $A$ 修改后比 $B$ 小的最大值。\n\n如果无法使得 $A$ 比 $B$ 小，输出 `-1`。\n\n因为兄弟俩很喜欢玩这个游戏，所以他们要玩 $t$ 局，即要进行 $t$ 次修改与判断。", "inputFormat": "第一行一个整数 $t$ 代表局数。    \n接下来 $t$ 行每行三个整数 $A,B,k$ 代表 Bajtek 写的数，Bitek 写的数，和允许的修改次数。", "outputFormat": "$t$ 行每行一个整数代表 $A$ 经过修改后比 $B$ 小的最大值。    \n如果 $A$ 怎样修改都不能使得 $A$ 比 $B$ 小，输出 `-1`。", "hint": "#### 样例说明\n\n前两组附加样例分别对应附加文件中的 sample1/2.in 和 sample1/2.out。\n\n第三组附加样例为 sample3.zip。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n假设这里的 $n$ 为 $A,B$ 的长度：\n\n- Subtask 1（18 pts）：$1 \\le n \\le 5$。\n- Subtask 2（20 pts）：$1 \\le n \\le 5000$。\n- Subtask 3（20 pts）：$1 \\le n \\le 10^5$，$k=1$。\n- Subtask 4（42 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le t \\le 100$，$1 \\le k \\le n \\le 10^5$，$A \\ge B$。\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) C [Pomniejszenie](https://sio2.mimuw.edu.pl/c/oi27-1/p/pom/)。", "locale": "zh-CN"}}}
{"pid": "P6662", "type": "P", "difficulty": 6, "samples": [["4 4 1\n1 2\n2 3\n1 3\n3 4\n3", "12"], ["5 10 2\n1 2\n1 3\n1 4\n1 5\n2 3\n2 4\n2 5\n3 4\n3 5\n4 5\n5\n6", "120\n720"], ["11 40 1\n8 1\n4 1\n3 8\n2 6\n9 8\n11 5\n2 5\n2 1\n11 4\n10 6\n11 10\n9 7\n10 4\n6 9\n9 10\n2 11\n6 7\n8 2\n10 8\n3 6\n11 9\n1 10\n4 3\n6 11\n3 11\n4 5\n8 7\n10 3\n11 7\n9 2\n8 6\n2 3\n3 7\n8 4\n9 5\n4 9\n7 2\n5 10\n10 2\n6 4\n15", "142679253"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2019", "POI（波兰）", "容斥原理"], "title": "[POI 2019/2020 R1] Przedszkole / 幼儿园", "background": "幼儿园的早上，老师们要给小孩子发玩具。", "description": "有些小孩子玩玩具是自己一个人玩，有些小孩子是成对玩耍。\n\n现在有 $n$ 个小孩子，这 $n$ 个小孩子可以分为 $m$ 对。\n\n有 $k$ 种玩具，要发放给这些小孩子，必须保证在一对内的小孩子拿到的玩具不同。\n\n求一共有多少种发放方案。\n\n因为要发放的天数很多，所以给定 $z$ 组询问，这 $z$ 组询问中 $n,m$ 和对应的对是不变的，变的是 $k$。", "inputFormat": "第一行三个整数 $n,m,z$ 代表小孩子数，成对数和询问数。   \n这 $n$ 个小朋友编号为 $1$ 到 $n$。   \n接下来 $m$ 行每行两个整数代表一对小朋友。   \n接下来 $z$ 行每行一个整数 $k$ 代表一组询问。", "outputFormat": "$z$ 行每行一个整数代表发放方案数。        \n答案对 $10^9+7$ 取模。", "hint": "#### 样例说明\n\n两个附加样例请见附加文件中的 sample 1/2.in 和 sample 1/2.out。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（8 pts）：$n,k \\le 8$，$z \\le 50$。\n- Subtask 2（26 pts）：$n \\le 15$。\n- Subtask 3（33 pts）：$m \\le 24$。\n- Subtask 4（33 pts）：一个小朋友恰好在两对小朋友。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$0 \\le m \\le \\min(10^5,\\dfrac{n^2-n}{2})$，$1 \\le z \\le 1000$，$1 \\le k \\le 10^9$。\n\n对于其中 $50\\%$ 的数据，$z=1$。\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) D [Przedszkole](https://sio2.mimuw.edu.pl/c/oi27-1/p/prz/)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2019/2020 R1] Przedszkole / 幼儿园", "background": "幼儿园的早上，老师们要给小孩子发玩具。", "description": "有些小孩子玩玩具是自己一个人玩，有些小孩子是成对玩耍。\n\n现在有 $n$ 个小孩子，这 $n$ 个小孩子可以分为 $m$ 对。\n\n有 $k$ 种玩具，要发放给这些小孩子，必须保证在一对内的小孩子拿到的玩具不同。\n\n求一共有多少种发放方案。\n\n因为要发放的天数很多，所以给定 $z$ 组询问，这 $z$ 组询问中 $n,m$ 和对应的对是不变的，变的是 $k$。", "inputFormat": "第一行三个整数 $n,m,z$ 代表小孩子数，成对数和询问数。   \n这 $n$ 个小朋友编号为 $1$ 到 $n$。   \n接下来 $m$ 行每行两个整数代表一对小朋友。   \n接下来 $z$ 行每行一个整数 $k$ 代表一组询问。", "outputFormat": "$z$ 行每行一个整数代表发放方案数。        \n答案对 $10^9+7$ 取模。", "hint": "#### 样例说明\n\n两个附加样例请见附加文件中的 sample 1/2.in 和 sample 1/2.out。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（8 pts）：$n,k \\le 8$，$z \\le 50$。\n- Subtask 2（26 pts）：$n \\le 15$。\n- Subtask 3（33 pts）：$m \\le 24$。\n- Subtask 4（33 pts）：一个小朋友恰好在两对小朋友。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$0 \\le m \\le \\min(10^5,\\dfrac{n^2-n}{2})$，$1 \\le z \\le 1000$，$1 \\le k \\le 10^9$。\n\n对于其中 $50\\%$ 的数据，$z=1$。\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) D [Przedszkole](https://sio2.mimuw.edu.pl/c/oi27-1/p/prz/)。", "locale": "zh-CN"}}}
{"pid": "P6663", "type": "P", "difficulty": 6, "samples": [["2 3 4", "TAK\n1 1 1 2\n1 1 2 1\n1 2 2 2\n2 3 2 2\n1 2 1 3"], ["2 3 1", "NIE"], ["2 3 3 ", "TAK\n1 2 2 2\n1 1 1 2\n2 2 2 3\n1 2 1 3\n2 2 2 1"], ["1 10 10", "NIE"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["图论", "2019", "POI（波兰）", "Special Judge", "构造"], "title": "[POI 2019/2020 R1] Układ scalony / 集成电路", "background": "Bajtel 公司专门生产集成电路板。", "description": "Bajtel 公司生产的集合电路板的大小为 $n \\times m$，现在通电的格子为 $(1,1)$。\n\n我们可以在两个相邻的格子连上电路让一个格子的电通向另一个格子，若干个电路组成集合电路。\n\n现在我们要连 $n \\times m-1$ 条电路，并且要求最长的集合电路 **恰好** 长度为 $k$，并且要求 **让所有格子通电**。\n\n求一种连接电路的方式。", "inputFormat": "一行三个整数 $n,m,k$ 代表电路板的大小和最长的集合电路必须满足的长度。", "outputFormat": "如果没有满足题意的连接方式，输出一个字符串 `NIE` 并结束程序。            \n如果有满足题意的连接方式：    \n第一行一个字符串 `TAK`。       \n接下来 $n \\times m-1$ 行每行四个整数 $u_1,v_1,u_2,v_2$ 代表一个电路连接 $(u_1,v_1)$，$(u_2,v_2)$。           \n如果有多组满足题意的解，输出一组即可。", "hint": "#### 样例说明\n\n对于样例 $1$，如下图\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ly5swltx.png)\n\n另一组附加样例请见附加文件中的 sample.zip。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$n,m \\le 6$。\n- Subtask 2（20 pts）：$n \\le 3$。\n- Subtask 3（30 pts）：$n \\times m$ 为奇数。\n- Subtask 4（30 pts）：$n \\times m$ 为偶数。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 1000$，$0 \\le k \\le 10^6$。\n\n如果您输出了 `TAK`（并且这个数据点的确有解），但是您在后面电路连接的描述中出错（但必须保证是合法的输出），您可以获得 $20\\%$ 的分数。\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) E [Układ scalony](https://sio2.mimuw.edu.pl/c/oi27-1/p/ukl/)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2019/2020 R1] Układ scalony / 集成电路", "background": "Bajtel 公司专门生产集成电路板。", "description": "Bajtel 公司生产的集合电路板的大小为 $n \\times m$，现在通电的格子为 $(1,1)$。\n\n我们可以在两个相邻的格子连上电路让一个格子的电通向另一个格子，若干个电路组成集合电路。\n\n现在我们要连 $n \\times m-1$ 条电路，并且要求最长的集合电路 **恰好** 长度为 $k$，并且要求 **让所有格子通电**。\n\n求一种连接电路的方式。", "inputFormat": "一行三个整数 $n,m,k$ 代表电路板的大小和最长的集合电路必须满足的长度。", "outputFormat": "如果没有满足题意的连接方式，输出一个字符串 `NIE` 并结束程序。            \n如果有满足题意的连接方式：    \n第一行一个字符串 `TAK`。       \n接下来 $n \\times m-1$ 行每行四个整数 $u_1,v_1,u_2,v_2$ 代表一个电路连接 $(u_1,v_1)$，$(u_2,v_2)$。           \n如果有多组满足题意的解，输出一组即可。", "hint": "#### 样例说明\n\n对于样例 $1$，如下图\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ly5swltx.png)\n\n另一组附加样例请见附加文件中的 sample.zip。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$n,m \\le 6$。\n- Subtask 2（20 pts）：$n \\le 3$。\n- Subtask 3（30 pts）：$n \\times m$ 为奇数。\n- Subtask 4（30 pts）：$n \\times m$ 为偶数。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 1000$，$0 \\le k \\le 10^6$。\n\n如果您输出了 `TAK`（并且这个数据点的确有解），但是您在后面电路连接的描述中出错（但必须保证是合法的输出），您可以获得 $20\\%$ 的分数。\n\n#### 说明\n\n翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) E [Układ scalony](https://sio2.mimuw.edu.pl/c/oi27-1/p/ukl/)。", "locale": "zh-CN"}}}
{"pid": "P6664", "type": "P", "difficulty": 6, "samples": [["8 19\nfind 0 0 2 7 2\nfind 1 2 4 4 4\nfind 2 4 6 10 1\nfind 3 6 7 8 6\nmove 2 7\nmove 1 6\nfind 4 2 5 3 4\nmove 0 5\nchange 0 12\nfind 5 4 5 5 10\nfind 6 2 3 6 9\nmove 3 5\nfind 7 0 1 12 1\nmove 1 6\nfind 8 1 7 11 100\nmove 1 6\nmove 3 7\nmove 5 6\nmove 2 2\n", "11\n-1\n6\n23\n18\n106\n122\n11\n0"], ["15 45\nfind 0 1 0 8 5987\nfind 1 2 0 14 5455\nfind 2 3 0 27 8830\nfind 3 4 3 42 7688\nfind 4 5 0 25 1756\nfind 5 6 5 35 1550\nfind 6 7 4 43 9440\nmove 3 9\nchange 2 9113\nmove 10 13\nmove 3 3\nmove 11 10\nfind 7 8 7 6 7347\nfind 8 9 8 26 8935\nmove 8 4\nchange 3 4466\nfind 9 10 9 28 8560\nmove 6 5\nfind 10 11 10 31 6205\nchange 9 9228\nfind 11 12 10 23 948\nfind 12 13 12 45 5945\nmove 0 9\nmove 2 5\nchange 2 6118\nfind 13 14 13 12 6906\nmove 4 1\nchange 2 504\nfind 14 4 2 22 9796\nmove 10 7\nmove 1 14\nmove 13 3\nfind 15 12 9 39 8985\nfind 16 9 8 17 3710\nchange 1 5370\nfind 17 1 0 36 4669\nfind 18 7 6 37 8087\nmove 9 0\nfind 19 14 9 33 8234\nfind 20 0 4 24 5209\nchange 1 4883\nfind 21 6 3 9 2461\nfind 22 5 2 19 4291\nchange 1 7219\nchange 6 4846", "-1\n-1\n0\n-1\n16787\n1550\n39301\n7211\n16571\n25510\n59706\n46309\n30692"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "CTT（清华集训/北大集训）"], "title": "[清华集训 2016] 温暖会指引我们前行", "background": "寒冬又一次肆虐了北国大地\n\n无情的北风穿透了人们御寒的衣物\n\n可怜虫们在冬夜中发出无助的哀嚎\n\n“冻死宝宝了！”\n\n这时\n\n远处的天边出现了一位火焰之神\n\n“我将赐予你们温暖和希望！”\n\n只见他的身体中喷射出火焰之力\n\n通过坚固的钢铁，传遍了千家万户\n\n这时，只听见人们欢呼\n\n“暖气来啦！”", "description": "虽然小 R 住的宿舍楼早已来了暖气，但是由于某些原因，宿舍楼中的某些窗户仍然开着（例如厕所的窗户），这就使得宿舍楼中有一些路上的温度还是很低。\n\n小 R 的宿舍楼中有 $n$ 个地点和一些路，一条路连接了两个地点，小 R 可以通过这条路从其中任意一个地点到达另外一个地点。但在刚开始，小 R 还不熟悉宿舍楼中的任何一条路，所以他会慢慢地发现这些路，他在发现一条路时还会知道这条路的温度和长度。每条路的温度都是互不相同的。\n\n小 R 需要在宿舍楼中活动，每次他都需要从一个地点到达另一个地点。小 R 希望每次活动时经过一条最温暖的路径，最温暖的路径的定义为，将路径上各条路的温度从小到大排序后字典序最大。即温度最低的路温度尽量高，在满足该条件的情况下，温度第二低的路温度尽量高，以此类推。小 R 不会经过重复的路。由于每条路的温度互不相同，因此只存在一条最温暖的路径。\n\n对于小 R 的每次活动，你需要求出小 R 需要走过的路径总长度。如果小 R 通过当前发现的路不能完成这次活动，则输出  `−1`。\n\n注意本题中的字典序与传统意义上的字典序定义有所不同，对于两个序列 $a,b(a≠b)$，若 $a$ 是 $b$ 的前缀则 $a$ 的字典序较大，同时可以推出空串的字典序最大。", "inputFormat": "第一行两个正整数 $n,m$。表示小 R 的宿舍楼中有 $n$ 个地点，共发生了 $m$ 个事件。\n\n接下来 $m$ 行，每行描述一个事件，事件分为三类。\n\n- `find id u v t l` 表示小 R 发现了一条连接 $u$ 和 $v$ 之间的路，编号为id。相同id的边只会出现一次。\n- `move u v` 表示小 R 要从 $u$ 到达 $v$，你需要计算出最温暖的路径的长度 ，若不能从 $u$ 到达 $v$，则输出 `−1`。\n- `change id l` 表示从 $u$ 到 $v$ 这条边的长度变为了 $l$（保证在当前时间点这条边存在）。\n\n", "outputFormat": "对于每个询问，输出一行整数，表示最温暖的路径长度。", "hint": "对于 `find` 操作：$0≤id<m$，$0≤u,v<n$，$u≠v$，$0≤t≤1000000000$，$0≤l≤10000$；\n\n对于 `move` 操作：$0≤u,v<n$；\n\n对于 `change` 操作：$0≤l≤10000$。\n\n对于 $100\\%$ 的数据，$1≤n≤100000$，$1≤m≤300000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[清华集训 2016] 温暖会指引我们前行", "background": "寒冬又一次肆虐了北国大地\n\n无情的北风穿透了人们御寒的衣物\n\n可怜虫们在冬夜中发出无助的哀嚎\n\n“冻死宝宝了！”\n\n这时\n\n远处的天边出现了一位火焰之神\n\n“我将赐予你们温暖和希望！”\n\n只见他的身体中喷射出火焰之力\n\n通过坚固的钢铁，传遍了千家万户\n\n这时，只听见人们欢呼\n\n“暖气来啦！”", "description": "虽然小 R 住的宿舍楼早已来了暖气，但是由于某些原因，宿舍楼中的某些窗户仍然开着（例如厕所的窗户），这就使得宿舍楼中有一些路上的温度还是很低。\n\n小 R 的宿舍楼中有 $n$ 个地点和一些路，一条路连接了两个地点，小 R 可以通过这条路从其中任意一个地点到达另外一个地点。但在刚开始，小 R 还不熟悉宿舍楼中的任何一条路，所以他会慢慢地发现这些路，他在发现一条路时还会知道这条路的温度和长度。每条路的温度都是互不相同的。\n\n小 R 需要在宿舍楼中活动，每次他都需要从一个地点到达另一个地点。小 R 希望每次活动时经过一条最温暖的路径，最温暖的路径的定义为，将路径上各条路的温度从小到大排序后字典序最大。即温度最低的路温度尽量高，在满足该条件的情况下，温度第二低的路温度尽量高，以此类推。小 R 不会经过重复的路。由于每条路的温度互不相同，因此只存在一条最温暖的路径。\n\n对于小 R 的每次活动，你需要求出小 R 需要走过的路径总长度。如果小 R 通过当前发现的路不能完成这次活动，则输出  `−1`。\n\n注意本题中的字典序与传统意义上的字典序定义有所不同，对于两个序列 $a,b(a≠b)$，若 $a$ 是 $b$ 的前缀则 $a$ 的字典序较大，同时可以推出空串的字典序最大。", "inputFormat": "第一行两个正整数 $n,m$。表示小 R 的宿舍楼中有 $n$ 个地点，共发生了 $m$ 个事件。\n\n接下来 $m$ 行，每行描述一个事件，事件分为三类。\n\n- `find id u v t l` 表示小 R 发现了一条连接 $u$ 和 $v$ 之间的路，编号为id。相同id的边只会出现一次。\n- `move u v` 表示小 R 要从 $u$ 到达 $v$，你需要计算出最温暖的路径的长度 ，若不能从 $u$ 到达 $v$，则输出 `−1`。\n- `change id l` 表示从 $u$ 到 $v$ 这条边的长度变为了 $l$（保证在当前时间点这条边存在）。\n\n", "outputFormat": "对于每个询问，输出一行整数，表示最温暖的路径长度。", "hint": "对于 `find` 操作：$0≤id<m$，$0≤u,v<n$，$u≠v$，$0≤t≤1000000000$，$0≤l≤10000$；\n\n对于 `move` 操作：$0≤u,v<n$；\n\n对于 `change` 操作：$0≤l≤10000$。\n\n对于 $100\\%$ 的数据，$1≤n≤100000$，$1≤m≤300000$。", "locale": "zh-CN"}}}
{"pid": "P6665", "type": "P", "difficulty": 6, "samples": [["4\n2 1\n1 2\n3 2\n1 2\n1 3\n2 0\n3 1\n1 2", "Alice\nAlice\nBob\nAlice\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["博弈论", "2016", "字典树 Trie", "CTT（清华集训/北大集训）"], "title": "[清华集训 2016] Alice 和 Bob 又在玩游戏", "background": "", "description": "Alice 和 Bob 在玩游戏。\n\n有 $n$ 个节点，$m$ 条边 $(0\\le m\\le n-1)$ ，构成若干棵有根树，每棵树的根节点是该连通块内编号最小的点。Alice 和 Bob 轮流操作，每回合选择一个没有被删除的节点 $x$，将 $x$ 及其所有祖先全部删除，不能操作的人输。\n\n注：树的形态是在一开始就确定好的，删除节点不会影响剩余节点父亲和儿子的关系。比如：$1-3-2$ 这样一条链\n，$1$ 号点是根节点，删除 $1$ 号点之后，$3$ 号点还是 $2$ 号点的父节点。\n\n问有没有先手必胜策略。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示该测试点有 $T$ 组数据；接下来 $T$ 组数据。\n\n对于每组数据：\n\n输入第一行两个整数 $n, m$，分别表示点数和边数（节点从 $1$ 开始编号）。\n\n接下来 $m$ 行，每行两个正整数 $a, b$，表示节点 $a$ 和节点 $b$ 之间有一条边，输入数据中没有重边。", "outputFormat": "输出 $T$ 行，每行输出 Alice 先手并且 Alice 和 Bob 都足够聪明的情况下谁获胜。", "hint": "#### 样例解释\n\n第一组数据输入是一条链，Alice 可以一次性把所有节点都删掉。\n\n第二组数据，Alice 先手第一步删除 $1$ 号点即可胜利。\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$1≤T≤10$，$1≤n≤10^5$，$∑n≤2×10^5$，$0≤m≤n−1$，输入数据保证不会形成环，且每棵树的大小 $≤5×10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[清华集训 2016] Alice 和 Bob 又在玩游戏", "background": "", "description": "Alice 和 Bob 在玩游戏。\n\n有 $n$ 个节点，$m$ 条边 $(0\\le m\\le n-1)$ ，构成若干棵有根树，每棵树的根节点是该连通块内编号最小的点。Alice 和 Bob 轮流操作，每回合选择一个没有被删除的节点 $x$，将 $x$ 及其所有祖先全部删除，不能操作的人输。\n\n注：树的形态是在一开始就确定好的，删除节点不会影响剩余节点父亲和儿子的关系。比如：$1-3-2$ 这样一条链\n，$1$ 号点是根节点，删除 $1$ 号点之后，$3$ 号点还是 $2$ 号点的父节点。\n\n问有没有先手必胜策略。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示该测试点有 $T$ 组数据；接下来 $T$ 组数据。\n\n对于每组数据：\n\n输入第一行两个整数 $n, m$，分别表示点数和边数（节点从 $1$ 开始编号）。\n\n接下来 $m$ 行，每行两个正整数 $a, b$，表示节点 $a$ 和节点 $b$ 之间有一条边，输入数据中没有重边。", "outputFormat": "输出 $T$ 行，每行输出 Alice 先手并且 Alice 和 Bob 都足够聪明的情况下谁获胜。", "hint": "#### 样例解释\n\n第一组数据输入是一条链，Alice 可以一次性把所有节点都删掉。\n\n第二组数据，Alice 先手第一步删除 $1$ 号点即可胜利。\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$1≤T≤10$，$1≤n≤10^5$，$∑n≤2×10^5$，$0≤m≤n−1$，输入数据保证不会形成环，且每棵树的大小 $≤5×10^4$。", "locale": "zh-CN"}}}
{"pid": "P6666", "type": "P", "difficulty": 7, "samples": [["5 6\n1 2\n2 4\n4 3\n2 5\n+ 1 4 7\n+ 5 5 4\n- 1\n+ 3 4 3\n+ 1 1 6\n- 2", "7\n11\n4\n7\n10\n9"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "CTT（清华集训/北大集训）", "动态 DP"], "title": "[清华集训 2016] 数据交互", "background": "", "description": "一个简单的网络系统可以被描述成一棵无根树。每个节点为一个服务器。连接服务器与服务器的数据线则看做一条树边。两个服务器进行数据交互时，数据会经过连接这两个服务器的路径上的所有服务器（包括这两个服务器自身）。每个数据交互请求都有一个非负的重要度，越重要的请求显然需要得到越高的优先处理权。此外，如果在某一个时刻存在一条非常重要（可以看作重要度无穷大）、且数据量巨大的交互请求，则所有被该交互经过的服务器都会优先处理这条交互并阻塞，从而导致其他通过这些服务器的交互出现延迟。\n\n现在，你作为一个网络系统的管理员，要监控整个系统的运行状态。系统的运行也很简单，在每一个时刻，只有可能出现下列二种事件中的一种：\n\n- 在某两个服务器之间出现一条新的数据交互请求；\n- 某个数据交互请求结束。\n\n我们假设这些事件中的交互请求的数据量都足够小。你的任务是在每一个时刻的事件结束后，求出：如果突然出现一条非常重要、且数据量巨大的交互请求，那么因其造成延迟的数据交互请求的重要度之和最大可能是多少？\n\n", "inputFormat": "输入的第一行包含二个正整数 $n,m$，分别表示服务器的个数、事件（时刻）的个数。\n\n接下来 $n−1$ 行，每行两个整数 $u,v$，描述一条树边。$u$ 和 $v$ 是服务器的编号，服务器编号为 $1,…,n$。\n\n接下来 $m$ 行，按发生时刻依次描述每一个事件；即第 $i$ 行（$i=1,2,3,…,m$）描述时刻 $i$ 发生的事件。事件的描述有两种：\n\n- `+ u v w`：服务器 $u$ 和 $v$ 之间出现了一条重要度为 $w$ 的数据交互请求；\n- `- t`：时刻 $t$ 出现的数据交互请求结束。\n", "outputFormat": "输出 $m$ 行，每行一个整数，依次描述在每个事件后，如果突然出现一条非常重要、且数据量巨大的交互请求，那么因其造成延迟的数据交互请求的重要度之和的最大值。如果此时没有任何数据交互请求，输出 $0$。\n", "hint": "对于 $30\\%$ 的数据，有 $1≤n,m≤100$。\n\n另有 $30\\%$ 的数据，没有第二类事件，即所有请求都不会结束。\n\n对于 $100\\%$ 的数据，有 $1≤n,m≤10^5$，所有的输入数据均为 `int` 范围内的非负整数。\n\n保证输入合法。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[清华集训 2016] 数据交互", "background": "", "description": "一个简单的网络系统可以被描述成一棵无根树。每个节点为一个服务器。连接服务器与服务器的数据线则看做一条树边。两个服务器进行数据交互时，数据会经过连接这两个服务器的路径上的所有服务器（包括这两个服务器自身）。每个数据交互请求都有一个非负的重要度，越重要的请求显然需要得到越高的优先处理权。此外，如果在某一个时刻存在一条非常重要（可以看作重要度无穷大）、且数据量巨大的交互请求，则所有被该交互经过的服务器都会优先处理这条交互并阻塞，从而导致其他通过这些服务器的交互出现延迟。\n\n现在，你作为一个网络系统的管理员，要监控整个系统的运行状态。系统的运行也很简单，在每一个时刻，只有可能出现下列二种事件中的一种：\n\n- 在某两个服务器之间出现一条新的数据交互请求；\n- 某个数据交互请求结束。\n\n我们假设这些事件中的交互请求的数据量都足够小。你的任务是在每一个时刻的事件结束后，求出：如果突然出现一条非常重要、且数据量巨大的交互请求，那么因其造成延迟的数据交互请求的重要度之和最大可能是多少？\n\n", "inputFormat": "输入的第一行包含二个正整数 $n,m$，分别表示服务器的个数、事件（时刻）的个数。\n\n接下来 $n−1$ 行，每行两个整数 $u,v$，描述一条树边。$u$ 和 $v$ 是服务器的编号，服务器编号为 $1,…,n$。\n\n接下来 $m$ 行，按发生时刻依次描述每一个事件；即第 $i$ 行（$i=1,2,3,…,m$）描述时刻 $i$ 发生的事件。事件的描述有两种：\n\n- `+ u v w`：服务器 $u$ 和 $v$ 之间出现了一条重要度为 $w$ 的数据交互请求；\n- `- t`：时刻 $t$ 出现的数据交互请求结束。\n", "outputFormat": "输出 $m$ 行，每行一个整数，依次描述在每个事件后，如果突然出现一条非常重要、且数据量巨大的交互请求，那么因其造成延迟的数据交互请求的重要度之和的最大值。如果此时没有任何数据交互请求，输出 $0$。\n", "hint": "对于 $30\\%$ 的数据，有 $1≤n,m≤100$。\n\n另有 $30\\%$ 的数据，没有第二类事件，即所有请求都不会结束。\n\n对于 $100\\%$ 的数据，有 $1≤n,m≤10^5$，所有的输入数据均为 `int` 范围内的非负整数。\n\n保证输入合法。", "locale": "zh-CN"}}}
{"pid": "P6667", "type": "P", "difficulty": 7, "samples": [["4 1 332748118\n0 1", "332748119"], ["4 3 12\n0 1 8 27", "46704"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "CTT（清华集训/北大集训）"], "title": "[清华集训 2016] 如何优雅地求和", "background": "", "description": "有一个多项式函数 $f(x)$，最高次幂为 $x^m$，定义变换 $Q$：\n\n$$Q(f,n,x)=∑_{k=0}^{n}f(k)\\binom nkx^k(1−x)^{n−k}$$\n\n现在给定函数 $f$ 和 $n,x$，求 $Q(f,n,x)\\bmod998244353$。\n\n出于某种原因，函数 $f$ 由点值形式给出，即给定 $a_0,a_1,⋯,a_m$ 共 $m+1$ 个数，$f(x)=a_x$。可以证明该函数唯一。", "inputFormat": "第一行三个整数 $n,m,x$，意义如前所述。\n\n第二行共 $m+1$ 个整数，表示 $a_0,a_1,⋯,a_m$。", "outputFormat": "输出一行一个数表示答案，请对 $998,244,353$ 取模。", "hint": "#### 样例 $2$ 解释\n\n经计算得 $f(x)=x^3$。\n\n#### 数据范围\n\n对于所有的测试点，保证 $1≤n≤10^9$，$1≤m≤2×10^4$，$0≤a_i,x<998,244,353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[清华集训 2016] 如何优雅地求和", "background": "", "description": "有一个多项式函数 $f(x)$，最高次幂为 $x^m$，定义变换 $Q$：\n\n$$Q(f,n,x)=∑_{k=0}^{n}f(k)\\binom nkx^k(1−x)^{n−k}$$\n\n现在给定函数 $f$ 和 $n,x$，求 $Q(f,n,x)\\bmod998244353$。\n\n出于某种原因，函数 $f$ 由点值形式给出，即给定 $a_0,a_1,⋯,a_m$ 共 $m+1$ 个数，$f(x)=a_x$。可以证明该函数唯一。", "inputFormat": "第一行三个整数 $n,m,x$，意义如前所述。\n\n第二行共 $m+1$ 个整数，表示 $a_0,a_1,⋯,a_m$。", "outputFormat": "输出一行一个数表示答案，请对 $998,244,353$ 取模。", "hint": "#### 样例 $2$ 解释\n\n经计算得 $f(x)=x^3$。\n\n#### 数据范围\n\n对于所有的测试点，保证 $1≤n≤10^9$，$1≤m≤2×10^4$，$0≤a_i,x<998,244,353$。", "locale": "zh-CN"}}}
{"pid": "P6668", "type": "P", "difficulty": 7, "samples": [["5 3\n1 2 3 1 2\n1 2\n2 3\n3 4\n4 5\n1 1 2 1 3 1\n1 0 2 1 3 1\n1 1 2 1 3 0", "3\n1\n2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "CTT（清华集训/北大集训）"], "title": "[清华集训 2016] 连通子树", "background": "", "description": "小 M 至上主义者小 D 今天心情很好，准备给小 M 准备一个圣诞礼物。\n\n他购买了一个圣诞树，这个圣诞树是一个有 $n$ 个点的树，点 $i$ 有一个颜色 $c_i$。小 D 觉得如果某种颜色太多就不好看了，所以最多会有 $5$ 个点有相同的颜色。\n\n小 M 收到了礼物很高兴，但是她最近对计数问题很感兴趣，于是她有一些问题想要小 D 解决。每次小 M 会关心三种不同的颜色 $a,b,c$，她想要知道这个圣诞树有多少个不同的非空联通子图满足里面颜色为 $a,b,c$ 的点的个数分别为 $na,nb,nc$。由于数可能很大，输出关于对 $10^9+7$ 取模的余数就可以了。\n\n小 D 当然轻松解决了这个问题，你虽然被喂了狗粮，但你也想锻炼你的实力，你能解决这个问题吗？\n\n", "inputFormat": "第一行两个数 $n$ 和 $Q$，表示树的大小和询问的个数。 \n\n第二行 $n$ 个数，其中第 $i$ 个表示 $c_i$，为第 $i$ 个节点的颜色。 \n\n接下来 $n-1$ 行，每行两个数 $a$ 和 $b$，表示点 $a$ 和点 $b$ 之间有一条边。\n\n接下来 $Q$ 行，其中每行有 $6$ 个数 $a,na,b,nb,c,nc$，表示如题目中所述的询问。", "outputFormat": "对每个询问输出一行表示答案。\n", "hint": "#### 限制与约定\n\n$1≤i≤n$，$1≤c_i≤n$。\n\n对于每个询问我们有：$0≤na,nb,nc≤5$，$1≤a,b,c≤n$ 以及 $a,b,c$ 两两不同。\n\n对于 $10\\%$ 的询问，$n,Q≤10$。\n\n对于另 $10\\%$ 的询问，$n≤15$，$Q≤50$。\n\n对于另 $10\\%$ 的询问，$n,Q≤1000$。\n\n对于另 $5\\%$ 的询问，$n,Q≤50000$，并且输入的树如果以点 $1$ 为根，最大深度不超过 $35$（点 $1$ 的深度为 $0$）。\n\n对于另 $5\\%$ 的询问，$n,Q≤100000$，并且输入的树如果以点 $1$ 为根，最大深度不超过 $35$（点 $1$ 的深度为 $0$）。\n\n对于另 $20\\%$ 的询问，$n,Q≤100000$，并且保证所有询问 $(na+1)^2(nb+1)^2(nc+1)^2$ 的和小于等于 $10^8$。\n\n对于另 $40\\%$ 的询问，$n,Q≤100000$，并且保证所有询问 $(na+1)(nb+1)(nc+1)$ 的和小于等于 $8\\times 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[清华集训 2016] 连通子树", "background": "", "description": "小 M 至上主义者小 D 今天心情很好，准备给小 M 准备一个圣诞礼物。\n\n他购买了一个圣诞树，这个圣诞树是一个有 $n$ 个点的树，点 $i$ 有一个颜色 $c_i$。小 D 觉得如果某种颜色太多就不好看了，所以最多会有 $5$ 个点有相同的颜色。\n\n小 M 收到了礼物很高兴，但是她最近对计数问题很感兴趣，于是她有一些问题想要小 D 解决。每次小 M 会关心三种不同的颜色 $a,b,c$，她想要知道这个圣诞树有多少个不同的非空联通子图满足里面颜色为 $a,b,c$ 的点的个数分别为 $na,nb,nc$。由于数可能很大，输出关于对 $10^9+7$ 取模的余数就可以了。\n\n小 D 当然轻松解决了这个问题，你虽然被喂了狗粮，但你也想锻炼你的实力，你能解决这个问题吗？\n\n", "inputFormat": "第一行两个数 $n$ 和 $Q$，表示树的大小和询问的个数。 \n\n第二行 $n$ 个数，其中第 $i$ 个表示 $c_i$，为第 $i$ 个节点的颜色。 \n\n接下来 $n-1$ 行，每行两个数 $a$ 和 $b$，表示点 $a$ 和点 $b$ 之间有一条边。\n\n接下来 $Q$ 行，其中每行有 $6$ 个数 $a,na,b,nb,c,nc$，表示如题目中所述的询问。", "outputFormat": "对每个询问输出一行表示答案。\n", "hint": "#### 限制与约定\n\n$1≤i≤n$，$1≤c_i≤n$。\n\n对于每个询问我们有：$0≤na,nb,nc≤5$，$1≤a,b,c≤n$ 以及 $a,b,c$ 两两不同。\n\n对于 $10\\%$ 的询问，$n,Q≤10$。\n\n对于另 $10\\%$ 的询问，$n≤15$，$Q≤50$。\n\n对于另 $10\\%$ 的询问，$n,Q≤1000$。\n\n对于另 $5\\%$ 的询问，$n,Q≤50000$，并且输入的树如果以点 $1$ 为根，最大深度不超过 $35$（点 $1$ 的深度为 $0$）。\n\n对于另 $5\\%$ 的询问，$n,Q≤100000$，并且输入的树如果以点 $1$ 为根，最大深度不超过 $35$（点 $1$ 的深度为 $0$）。\n\n对于另 $20\\%$ 的询问，$n,Q≤100000$，并且保证所有询问 $(na+1)^2(nb+1)^2(nc+1)^2$ 的和小于等于 $10^8$。\n\n对于另 $40\\%$ 的询问，$n,Q≤100000$，并且保证所有询问 $(na+1)(nb+1)(nc+1)$ 的和小于等于 $8\\times 10^6$。", "locale": "zh-CN"}}}
